function fae(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const a=Object.getOwnPropertyDescriptor(r,i);a&&Object.defineProperty(t,i,a.get?a:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(i){if(i.ep)return;i.ep=!0;const a=n(i);fetch(i.href,a)}})();var vf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function sl(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function jB(t){if(Object.prototype.hasOwnProperty.call(t,"__esModule"))return t;var e=t.default;if(typeof e=="function"){var n=function r(){var i=!1;try{i=this instanceof r}catch{}return i?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var i=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return t[r]}})}),n}var mT={exports:{}},W1={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mP;function dae(){if(mP)return W1;mP=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function n(r,i,a){var o=null;if(a!==void 0&&(o=""+a),i.key!==void 0&&(o=""+i.key),"key"in i){a={};for(var s in i)s!=="key"&&(a[s]=i[s])}else a=i;return i=a.ref,{$$typeof:t,type:r,key:o,ref:i!==void 0?i:null,props:a}}return W1.Fragment=e,W1.jsx=n,W1.jsxs=n,W1}var vP;function hae(){return vP||(vP=1,mT.exports=dae()),mT.exports}var j=hae(),vT={exports:{}},Bn={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yP;function pae(){if(yP)return Bn;yP=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),o=Symbol.for("react.context"),s=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),c=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),u=Symbol.iterator;function d(F){return F===null||typeof F!="object"?null:(F=u&&F[u]||F["@@iterator"],typeof F=="function"?F:null)}var h={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},p=Object.assign,g={};function m(F,J,Q){this.props=F,this.context=J,this.refs=g,this.updater=Q||h}m.prototype.isReactComponent={},m.prototype.setState=function(F,J){if(typeof F!="object"&&typeof F!="function"&&F!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,F,J,"setState")},m.prototype.forceUpdate=function(F){this.updater.enqueueForceUpdate(this,F,"forceUpdate")};function y(){}y.prototype=m.prototype;function v(F,J,Q){this.props=F,this.context=J,this.refs=g,this.updater=Q||h}var x=v.prototype=new y;x.constructor=v,p(x,m.prototype),x.isPureReactComponent=!0;var w=Array.isArray,S={H:null,A:null,T:null,S:null,V:null},T=Object.prototype.hasOwnProperty;function _(F,J,Q,ne,ye,ve){return Q=ve.ref,{$$typeof:t,type:F,key:J,ref:Q!==void 0?Q:null,props:ve}}function D(F,J){return _(F.type,J,void 0,void 0,void 0,F.props)}function I(F){return typeof F=="object"&&F!==null&&F.$$typeof===t}function R(F){var J={"=":"=0",":":"=2"};return"$"+F.replace(/[=:]/g,function(Q){return J[Q]})}var O=/\/+/g;function P(F,J){return typeof F=="object"&&F!==null&&F.key!=null?R(""+F.key):J.toString(36)}function N(){}function A(F){switch(F.status){case"fulfilled":return F.value;case"rejected":throw F.reason;default:switch(typeof F.status=="string"?F.then(N,N):(F.status="pending",F.then(function(J){F.status==="pending"&&(F.status="fulfilled",F.value=J)},function(J){F.status==="pending"&&(F.status="rejected",F.reason=J)})),F.status){case"fulfilled":return F.value;case"rejected":throw F.reason}}throw F}function B(F,J,Q,ne,ye){var ve=typeof F;(ve==="undefined"||ve==="boolean")&&(F=null);var Ce=!1;if(F===null)Ce=!0;else switch(ve){case"bigint":case"string":case"number":Ce=!0;break;case"object":switch(F.$$typeof){case t:case e:Ce=!0;break;case f:return Ce=F._init,B(Ce(F._payload),J,Q,ne,ye)}}if(Ce)return ye=ye(F),Ce=ne===""?"."+P(F,0):ne,w(ye)?(Q="",Ce!=null&&(Q=Ce.replace(O,"$&/")+"/"),B(ye,J,Q,"",function(Me){return Me})):ye!=null&&(I(ye)&&(ye=D(ye,Q+(ye.key==null||F&&F.key===ye.key?"":(""+ye.key).replace(O,"$&/")+"/")+Ce)),J.push(ye)),1;Ce=0;var we=ne===""?".":ne+":";if(w(F))for(var Ae=0;Ae<F.length;Ae++)ne=F[Ae],ve=we+P(ne,Ae),Ce+=B(ne,J,Q,ve,ye);else if(Ae=d(F),typeof Ae=="function")for(F=Ae.call(F),Ae=0;!(ne=F.next()).done;)ne=ne.value,ve=we+P(ne,Ae++),Ce+=B(ne,J,Q,ve,ye);else if(ve==="object"){if(typeof F.then=="function")return B(A(F),J,Q,ne,ye);throw J=String(F),Error("Objects are not valid as a React child (found: "+(J==="[object Object]"?"object with keys {"+Object.keys(F).join(", ")+"}":J)+"). If you meant to render a collection of children, use an array instead.")}return Ce}function V(F,J,Q){if(F==null)return F;var ne=[],ye=0;return B(F,ne,"","",function(ve){return J.call(Q,ve,ye++)}),ne}function $(F){if(F._status===-1){var J=F._result;J=J(),J.then(function(Q){(F._status===0||F._status===-1)&&(F._status=1,F._result=Q)},function(Q){(F._status===0||F._status===-1)&&(F._status=2,F._result=Q)}),F._status===-1&&(F._status=0,F._result=J)}if(F._status===1)return F._result.default;throw F._result}var U=typeof reportError=="function"?reportError:function(F){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var J=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof F=="object"&&F!==null&&typeof F.message=="string"?String(F.message):String(F),error:F});if(!window.dispatchEvent(J))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",F);return}console.error(F)};function G(){}return Bn.Children={map:V,forEach:function(F,J,Q){V(F,function(){J.apply(this,arguments)},Q)},count:function(F){var J=0;return V(F,function(){J++}),J},toArray:function(F){return V(F,function(J){return J})||[]},only:function(F){if(!I(F))throw Error("React.Children.only expected to receive a single React element child.");return F}},Bn.Component=m,Bn.Fragment=n,Bn.Profiler=i,Bn.PureComponent=v,Bn.StrictMode=r,Bn.Suspense=l,Bn.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=S,Bn.__COMPILER_RUNTIME={__proto__:null,c:function(F){return S.H.useMemoCache(F)}},Bn.cache=function(F){return function(){return F.apply(null,arguments)}},Bn.cloneElement=function(F,J,Q){if(F==null)throw Error("The argument must be a React element, but you passed "+F+".");var ne=p({},F.props),ye=F.key,ve=void 0;if(J!=null)for(Ce in J.ref!==void 0&&(ve=void 0),J.key!==void 0&&(ye=""+J.key),J)!T.call(J,Ce)||Ce==="key"||Ce==="__self"||Ce==="__source"||Ce==="ref"&&J.ref===void 0||(ne[Ce]=J[Ce]);var Ce=arguments.length-2;if(Ce===1)ne.children=Q;else if(1<Ce){for(var we=Array(Ce),Ae=0;Ae<Ce;Ae++)we[Ae]=arguments[Ae+2];ne.children=we}return _(F.type,ye,void 0,void 0,ve,ne)},Bn.createContext=function(F){return F={$$typeof:o,_currentValue:F,_currentValue2:F,_threadCount:0,Provider:null,Consumer:null},F.Provider=F,F.Consumer={$$typeof:a,_context:F},F},Bn.createElement=function(F,J,Q){var ne,ye={},ve=null;if(J!=null)for(ne in J.key!==void 0&&(ve=""+J.key),J)T.call(J,ne)&&ne!=="key"&&ne!=="__self"&&ne!=="__source"&&(ye[ne]=J[ne]);var Ce=arguments.length-2;if(Ce===1)ye.children=Q;else if(1<Ce){for(var we=Array(Ce),Ae=0;Ae<Ce;Ae++)we[Ae]=arguments[Ae+2];ye.children=we}if(F&&F.defaultProps)for(ne in Ce=F.defaultProps,Ce)ye[ne]===void 0&&(ye[ne]=Ce[ne]);return _(F,ve,void 0,void 0,null,ye)},Bn.createRef=function(){return{current:null}},Bn.forwardRef=function(F){return{$$typeof:s,render:F}},Bn.isValidElement=I,Bn.lazy=function(F){return{$$typeof:f,_payload:{_status:-1,_result:F},_init:$}},Bn.memo=function(F,J){return{$$typeof:c,type:F,compare:J===void 0?null:J}},Bn.startTransition=function(F){var J=S.T,Q={};S.T=Q;try{var ne=F(),ye=S.S;ye!==null&&ye(Q,ne),typeof ne=="object"&&ne!==null&&typeof ne.then=="function"&&ne.then(G,U)}catch(ve){U(ve)}finally{S.T=J}},Bn.unstable_useCacheRefresh=function(){return S.H.useCacheRefresh()},Bn.use=function(F){return S.H.use(F)},Bn.useActionState=function(F,J,Q){return S.H.useActionState(F,J,Q)},Bn.useCallback=function(F,J){return S.H.useCallback(F,J)},Bn.useContext=function(F){return S.H.useContext(F)},Bn.useDebugValue=function(){},Bn.useDeferredValue=function(F,J){return S.H.useDeferredValue(F,J)},Bn.useEffect=function(F,J,Q){var ne=S.H;if(typeof Q=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return ne.useEffect(F,J)},Bn.useId=function(){return S.H.useId()},Bn.useImperativeHandle=function(F,J,Q){return S.H.useImperativeHandle(F,J,Q)},Bn.useInsertionEffect=function(F,J){return S.H.useInsertionEffect(F,J)},Bn.useLayoutEffect=function(F,J){return S.H.useLayoutEffect(F,J)},Bn.useMemo=function(F,J){return S.H.useMemo(F,J)},Bn.useOptimistic=function(F,J){return S.H.useOptimistic(F,J)},Bn.useReducer=function(F,J,Q){return S.H.useReducer(F,J,Q)},Bn.useRef=function(F){return S.H.useRef(F)},Bn.useState=function(F){return S.H.useState(F)},Bn.useSyncExternalStore=function(F,J,Q){return S.H.useSyncExternalStore(F,J,Q)},Bn.useTransition=function(){return S.H.useTransition()},Bn.version="19.1.1",Bn}var xP;function J3(){return xP||(xP=1,vT.exports=pae()),vT.exports}var H=J3();const un=sl(H);var yT={exports:{}},H1={},xT={exports:{}},bT={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bP;function gae(){return bP||(bP=1,(function(t){function e(V,$){var U=V.length;V.push($);e:for(;0<U;){var G=U-1>>>1,F=V[G];if(0<i(F,$))V[G]=$,V[U]=F,U=G;else break e}}function n(V){return V.length===0?null:V[0]}function r(V){if(V.length===0)return null;var $=V[0],U=V.pop();if(U!==$){V[0]=U;e:for(var G=0,F=V.length,J=F>>>1;G<J;){var Q=2*(G+1)-1,ne=V[Q],ye=Q+1,ve=V[ye];if(0>i(ne,U))ye<F&&0>i(ve,ne)?(V[G]=ve,V[ye]=U,G=ye):(V[G]=ne,V[Q]=U,G=Q);else if(ye<F&&0>i(ve,U))V[G]=ve,V[ye]=U,G=ye;else break e}}return $}function i(V,$){var U=V.sortIndex-$.sortIndex;return U!==0?U:V.id-$.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;t.unstable_now=function(){return a.now()}}else{var o=Date,s=o.now();t.unstable_now=function(){return o.now()-s}}var l=[],c=[],f=1,u=null,d=3,h=!1,p=!1,g=!1,m=!1,y=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;function w(V){for(var $=n(c);$!==null;){if($.callback===null)r(c);else if($.startTime<=V)r(c),$.sortIndex=$.expirationTime,e(l,$);else break;$=n(c)}}function S(V){if(g=!1,w(V),!p)if(n(l)!==null)p=!0,T||(T=!0,P());else{var $=n(c);$!==null&&B(S,$.startTime-V)}}var T=!1,_=-1,D=5,I=-1;function R(){return m?!0:!(t.unstable_now()-I<D)}function O(){if(m=!1,T){var V=t.unstable_now();I=V;var $=!0;try{e:{p=!1,g&&(g=!1,v(_),_=-1),h=!0;var U=d;try{t:{for(w(V),u=n(l);u!==null&&!(u.expirationTime>V&&R());){var G=u.callback;if(typeof G=="function"){u.callback=null,d=u.priorityLevel;var F=G(u.expirationTime<=V);if(V=t.unstable_now(),typeof F=="function"){u.callback=F,w(V),$=!0;break t}u===n(l)&&r(l),w(V)}else r(l);u=n(l)}if(u!==null)$=!0;else{var J=n(c);J!==null&&B(S,J.startTime-V),$=!1}}break e}finally{u=null,d=U,h=!1}$=void 0}}finally{$?P():T=!1}}}var P;if(typeof x=="function")P=function(){x(O)};else if(typeof MessageChannel<"u"){var N=new MessageChannel,A=N.port2;N.port1.onmessage=O,P=function(){A.postMessage(null)}}else P=function(){y(O,0)};function B(V,$){_=y(function(){V(t.unstable_now())},$)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(V){V.callback=null},t.unstable_forceFrameRate=function(V){0>V||125<V?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<V?Math.floor(1e3/V):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_next=function(V){switch(d){case 1:case 2:case 3:var $=3;break;default:$=d}var U=d;d=$;try{return V()}finally{d=U}},t.unstable_requestPaint=function(){m=!0},t.unstable_runWithPriority=function(V,$){switch(V){case 1:case 2:case 3:case 4:case 5:break;default:V=3}var U=d;d=V;try{return $()}finally{d=U}},t.unstable_scheduleCallback=function(V,$,U){var G=t.unstable_now();switch(typeof U=="object"&&U!==null?(U=U.delay,U=typeof U=="number"&&0<U?G+U:G):U=G,V){case 1:var F=-1;break;case 2:F=250;break;case 5:F=1073741823;break;case 4:F=1e4;break;default:F=5e3}return F=U+F,V={id:f++,callback:$,priorityLevel:V,startTime:U,expirationTime:F,sortIndex:-1},U>G?(V.sortIndex=U,e(c,V),n(l)===null&&V===n(c)&&(g?(v(_),_=-1):g=!0,B(S,U-G))):(V.sortIndex=F,e(l,V),p||h||(p=!0,T||(T=!0,P()))),V},t.unstable_shouldYield=R,t.unstable_wrapCallback=function(V){var $=d;return function(){var U=d;d=$;try{return V.apply(this,arguments)}finally{d=U}}}})(bT)),bT}var wP;function mae(){return wP||(wP=1,xT.exports=gae()),xT.exports}var wT={exports:{}},_o={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var CP;function vae(){if(CP)return _o;CP=1;var t=J3();function e(l){var c="https://react.dev/errors/"+l;if(1<arguments.length){c+="?args[]="+encodeURIComponent(arguments[1]);for(var f=2;f<arguments.length;f++)c+="&args[]="+encodeURIComponent(arguments[f])}return"Minified React error #"+l+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var r={d:{f:n,r:function(){throw Error(e(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},i=Symbol.for("react.portal");function a(l,c,f){var u=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:u==null?null:""+u,children:l,containerInfo:c,implementation:f}}var o=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function s(l,c){if(l==="font")return"";if(typeof c=="string")return c==="use-credentials"?c:""}return _o.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,_o.createPortal=function(l,c){var f=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11)throw Error(e(299));return a(l,c,null,f)},_o.flushSync=function(l){var c=o.T,f=r.p;try{if(o.T=null,r.p=2,l)return l()}finally{o.T=c,r.p=f,r.d.f()}},_o.preconnect=function(l,c){typeof l=="string"&&(c?(c=c.crossOrigin,c=typeof c=="string"?c==="use-credentials"?c:"":void 0):c=null,r.d.C(l,c))},_o.prefetchDNS=function(l){typeof l=="string"&&r.d.D(l)},_o.preinit=function(l,c){if(typeof l=="string"&&c&&typeof c.as=="string"){var f=c.as,u=s(f,c.crossOrigin),d=typeof c.integrity=="string"?c.integrity:void 0,h=typeof c.fetchPriority=="string"?c.fetchPriority:void 0;f==="style"?r.d.S(l,typeof c.precedence=="string"?c.precedence:void 0,{crossOrigin:u,integrity:d,fetchPriority:h}):f==="script"&&r.d.X(l,{crossOrigin:u,integrity:d,fetchPriority:h,nonce:typeof c.nonce=="string"?c.nonce:void 0})}},_o.preinitModule=function(l,c){if(typeof l=="string")if(typeof c=="object"&&c!==null){if(c.as==null||c.as==="script"){var f=s(c.as,c.crossOrigin);r.d.M(l,{crossOrigin:f,integrity:typeof c.integrity=="string"?c.integrity:void 0,nonce:typeof c.nonce=="string"?c.nonce:void 0})}}else c==null&&r.d.M(l)},_o.preload=function(l,c){if(typeof l=="string"&&typeof c=="object"&&c!==null&&typeof c.as=="string"){var f=c.as,u=s(f,c.crossOrigin);r.d.L(l,f,{crossOrigin:u,integrity:typeof c.integrity=="string"?c.integrity:void 0,nonce:typeof c.nonce=="string"?c.nonce:void 0,type:typeof c.type=="string"?c.type:void 0,fetchPriority:typeof c.fetchPriority=="string"?c.fetchPriority:void 0,referrerPolicy:typeof c.referrerPolicy=="string"?c.referrerPolicy:void 0,imageSrcSet:typeof c.imageSrcSet=="string"?c.imageSrcSet:void 0,imageSizes:typeof c.imageSizes=="string"?c.imageSizes:void 0,media:typeof c.media=="string"?c.media:void 0})}},_o.preloadModule=function(l,c){if(typeof l=="string")if(c){var f=s(c.as,c.crossOrigin);r.d.m(l,{as:typeof c.as=="string"&&c.as!=="script"?c.as:void 0,crossOrigin:f,integrity:typeof c.integrity=="string"?c.integrity:void 0})}else r.d.m(l)},_o.requestFormReset=function(l){r.d.r(l)},_o.unstable_batchedUpdates=function(l,c){return l(c)},_o.useFormState=function(l,c,f){return o.H.useFormState(l,c,f)},_o.useFormStatus=function(){return o.H.useHostTransitionStatus()},_o.version="19.1.1",_o}var SP;function zB(){if(SP)return wT.exports;SP=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),wT.exports=vae(),wT.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var TP;function yae(){if(TP)return H1;TP=1;var t=mae(),e=J3(),n=zB();function r(b){var C="https://react.dev/errors/"+b;if(1<arguments.length){C+="?args[]="+encodeURIComponent(arguments[1]);for(var E=2;E<arguments.length;E++)C+="&args[]="+encodeURIComponent(arguments[E])}return"Minified React error #"+b+"; visit "+C+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(b){return!(!b||b.nodeType!==1&&b.nodeType!==9&&b.nodeType!==11)}function a(b){var C=b,E=b;if(b.alternate)for(;C.return;)C=C.return;else{b=C;do C=b,(C.flags&4098)!==0&&(E=C.return),b=C.return;while(b)}return C.tag===3?E:null}function o(b){if(b.tag===13){var C=b.memoizedState;if(C===null&&(b=b.alternate,b!==null&&(C=b.memoizedState)),C!==null)return C.dehydrated}return null}function s(b){if(a(b)!==b)throw Error(r(188))}function l(b){var C=b.alternate;if(!C){if(C=a(b),C===null)throw Error(r(188));return C!==b?null:b}for(var E=b,M=C;;){var L=E.return;if(L===null)break;var z=L.alternate;if(z===null){if(M=L.return,M!==null){E=M;continue}break}if(L.child===z.child){for(z=L.child;z;){if(z===E)return s(L),b;if(z===M)return s(L),C;z=z.sibling}throw Error(r(188))}if(E.return!==M.return)E=L,M=z;else{for(var fe=!1,xe=L.child;xe;){if(xe===E){fe=!0,E=L,M=z;break}if(xe===M){fe=!0,M=L,E=z;break}xe=xe.sibling}if(!fe){for(xe=z.child;xe;){if(xe===E){fe=!0,E=z,M=L;break}if(xe===M){fe=!0,M=z,E=L;break}xe=xe.sibling}if(!fe)throw Error(r(189))}}if(E.alternate!==M)throw Error(r(190))}if(E.tag!==3)throw Error(r(188));return E.stateNode.current===E?b:C}function c(b){var C=b.tag;if(C===5||C===26||C===27||C===6)return b;for(b=b.child;b!==null;){if(C=c(b),C!==null)return C;b=b.sibling}return null}var f=Object.assign,u=Symbol.for("react.element"),d=Symbol.for("react.transitional.element"),h=Symbol.for("react.portal"),p=Symbol.for("react.fragment"),g=Symbol.for("react.strict_mode"),m=Symbol.for("react.profiler"),y=Symbol.for("react.provider"),v=Symbol.for("react.consumer"),x=Symbol.for("react.context"),w=Symbol.for("react.forward_ref"),S=Symbol.for("react.suspense"),T=Symbol.for("react.suspense_list"),_=Symbol.for("react.memo"),D=Symbol.for("react.lazy"),I=Symbol.for("react.activity"),R=Symbol.for("react.memo_cache_sentinel"),O=Symbol.iterator;function P(b){return b===null||typeof b!="object"?null:(b=O&&b[O]||b["@@iterator"],typeof b=="function"?b:null)}var N=Symbol.for("react.client.reference");function A(b){if(b==null)return null;if(typeof b=="function")return b.$$typeof===N?null:b.displayName||b.name||null;if(typeof b=="string")return b;switch(b){case p:return"Fragment";case m:return"Profiler";case g:return"StrictMode";case S:return"Suspense";case T:return"SuspenseList";case I:return"Activity"}if(typeof b=="object")switch(b.$$typeof){case h:return"Portal";case x:return(b.displayName||"Context")+".Provider";case v:return(b._context.displayName||"Context")+".Consumer";case w:var C=b.render;return b=b.displayName,b||(b=C.displayName||C.name||"",b=b!==""?"ForwardRef("+b+")":"ForwardRef"),b;case _:return C=b.displayName||null,C!==null?C:A(b.type)||"Memo";case D:C=b._payload,b=b._init;try{return A(b(C))}catch{}}return null}var B=Array.isArray,V=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,$=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,U={pending:!1,data:null,method:null,action:null},G=[],F=-1;function J(b){return{current:b}}function Q(b){0>F||(b.current=G[F],G[F]=null,F--)}function ne(b,C){F++,G[F]=b.current,b.current=C}var ye=J(null),ve=J(null),Ce=J(null),we=J(null);function Ae(b,C){switch(ne(Ce,C),ne(ve,b),ne(ye,null),C.nodeType){case 9:case 11:b=(b=C.documentElement)&&(b=b.namespaceURI)?zR(b):0;break;default:if(b=C.tagName,C=C.namespaceURI)C=zR(C),b=WR(C,b);else switch(b){case"svg":b=1;break;case"math":b=2;break;default:b=0}}Q(ye),ne(ye,b)}function Me(){Q(ye),Q(ve),Q(Ce)}function q(b){b.memoizedState!==null&&ne(we,b);var C=ye.current,E=WR(C,b.type);C!==E&&(ne(ve,b),ne(ye,E))}function k(b){ve.current===b&&(Q(ye),Q(ve)),we.current===b&&(Q(we),B1._currentValue=U)}var Y=Object.prototype.hasOwnProperty,X=t.unstable_scheduleCallback,re=t.unstable_cancelCallback,de=t.unstable_shouldYield,he=t.unstable_requestPaint,Ee=t.unstable_now,Oe=t.unstable_getCurrentPriorityLevel,Pe=t.unstable_ImmediatePriority,Ne=t.unstable_UserBlockingPriority,ie=t.unstable_NormalPriority,ae=t.unstable_LowPriority,Te=t.unstable_IdlePriority,me=t.log,Se=t.unstable_setDisableYieldValue,Ve=null,ue=null;function ut(b){if(typeof me=="function"&&Se(b),ue&&typeof ue.setStrictMode=="function")try{ue.setStrictMode(Ve,b)}catch{}}var ht=Math.clz32?Math.clz32:Qe,Ot=Math.log,Fe=Math.LN2;function Qe(b){return b>>>=0,b===0?32:31-(Ot(b)/Fe|0)|0}var st=256,ot=4194304;function Mt(b){var C=b&42;if(C!==0)return C;switch(b&-b){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return b&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return b&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return b}}function Ue(b,C,E){var M=b.pendingLanes;if(M===0)return 0;var L=0,z=b.suspendedLanes,fe=b.pingedLanes;b=b.warmLanes;var xe=M&134217727;return xe!==0?(M=xe&~z,M!==0?L=Mt(M):(fe&=xe,fe!==0?L=Mt(fe):E||(E=xe&~b,E!==0&&(L=Mt(E))))):(xe=M&~z,xe!==0?L=Mt(xe):fe!==0?L=Mt(fe):E||(E=M&~b,E!==0&&(L=Mt(E)))),L===0?0:C!==0&&C!==L&&(C&z)===0&&(z=L&-L,E=C&-C,z>=E||z===32&&(E&4194048)!==0)?C:L}function He(b,C){return(b.pendingLanes&~(b.suspendedLanes&~b.pingedLanes)&C)===0}function Ct(b,C){switch(b){case 1:case 2:case 4:case 8:case 64:return C+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return C+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function $t(){var b=st;return st<<=1,(st&4194048)===0&&(st=256),b}function bn(){var b=ot;return ot<<=1,(ot&62914560)===0&&(ot=4194304),b}function Tn(b){for(var C=[],E=0;31>E;E++)C.push(b);return C}function en(b,C){b.pendingLanes|=C,C!==268435456&&(b.suspendedLanes=0,b.pingedLanes=0,b.warmLanes=0)}function Pn(b,C,E,M,L,z){var fe=b.pendingLanes;b.pendingLanes=E,b.suspendedLanes=0,b.pingedLanes=0,b.warmLanes=0,b.expiredLanes&=E,b.entangledLanes&=E,b.errorRecoveryDisabledLanes&=E,b.shellSuspendCounter=0;var xe=b.entanglements,ke=b.expirationTimes,Je=b.hiddenUpdates;for(E=fe&~E;0<E;){var bt=31-ht(E),_t=1<<bt;xe[bt]=0,ke[bt]=-1;var et=Je[bt];if(et!==null)for(Je[bt]=null,bt=0;bt<et.length;bt++){var nt=et[bt];nt!==null&&(nt.lane&=-536870913)}E&=~_t}M!==0&&mi(b,M,0),z!==0&&L===0&&b.tag!==0&&(b.suspendedLanes|=z&~(fe&~C))}function mi(b,C,E){b.pendingLanes|=C,b.suspendedLanes&=~C;var M=31-ht(C);b.entangledLanes|=C,b.entanglements[M]=b.entanglements[M]|1073741824|E&4194090}function hr(b,C){var E=b.entangledLanes|=C;for(b=b.entanglements;E;){var M=31-ht(E),L=1<<M;L&C|b[M]&C&&(b[M]|=C),E&=~L}}function Ke(b){switch(b){case 2:b=1;break;case 8:b=4;break;case 32:b=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:b=128;break;case 268435456:b=134217728;break;default:b=0}return b}function Et(b){return b&=-b,2<b?8<b?(b&134217727)!==0?32:268435456:8:2}function Rt(){var b=$.p;return b!==0?b:(b=window.event,b===void 0?32:uP(b.type))}function Ft(b,C){var E=$.p;try{return $.p=b,C()}finally{$.p=E}}var Dn=Math.random().toString(36).slice(2),Bt="__reactFiber$"+Dn,qt="__reactProps$"+Dn,kt="__reactContainer$"+Dn,Zt="__reactEvents$"+Dn,wr="__reactListeners$"+Dn,$r="__reactHandles$"+Dn,oi="__reactResources$"+Dn,Li="__reactMarker$"+Dn;function vi(b){delete b[Bt],delete b[qt],delete b[Zt],delete b[wr],delete b[$r]}function ki(b){var C=b[Bt];if(C)return C;for(var E=b.parentNode;E;){if(C=E[kt]||E[Bt]){if(E=C.alternate,C.child!==null||E!==null&&E.child!==null)for(b=XR(b);b!==null;){if(E=b[Bt])return E;b=XR(b)}return C}b=E,E=b.parentNode}return null}function nn(b){if(b=b[Bt]||b[kt]){var C=b.tag;if(C===5||C===6||C===13||C===26||C===27||C===3)return b}return null}function Yn(b){var C=b.tag;if(C===5||C===26||C===27||C===6)return b.stateNode;throw Error(r(33))}function Si(b){var C=b[oi];return C||(C=b[oi]={hoistableStyles:new Map,hoistableScripts:new Map}),C}function rn(b){b[Li]=!0}var si=new Set,os={};function li(b,C){Vi(b,C),Vi(b+"Capture",C)}function Vi(b,C){for(os[b]=C,b=0;b<C.length;b++)si.add(C[b])}var _a=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Fi={},As={};function Uo(b){return Y.call(As,b)?!0:Y.call(Fi,b)?!1:_a.test(b)?As[b]=!0:(Fi[b]=!0,!1)}function Ui(b,C,E){if(Uo(C))if(E===null)b.removeAttribute(C);else{switch(typeof E){case"undefined":case"function":case"symbol":b.removeAttribute(C);return;case"boolean":var M=C.toLowerCase().slice(0,5);if(M!=="data-"&&M!=="aria-"){b.removeAttribute(C);return}}b.setAttribute(C,""+E)}}function Bo(b,C,E){if(E===null)b.removeAttribute(C);else{switch(typeof E){case"undefined":case"function":case"symbol":case"boolean":b.removeAttribute(C);return}b.setAttribute(C,""+E)}}function Pt(b,C,E,M){if(M===null)b.removeAttribute(E);else{switch(typeof M){case"undefined":case"function":case"symbol":case"boolean":b.removeAttribute(E);return}b.setAttributeNS(C,E,""+M)}}var Bi,no;function yi(b){if(Bi===void 0)try{throw Error()}catch(E){var C=E.stack.trim().match(/\n( *(at )?)/);Bi=C&&C[1]||"",no=-1<E.stack.indexOf(`
    at`)?" (<anonymous>)":-1<E.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Bi+b+no}var Ns=!1;function $o(b,C){if(!b||Ns)return"";Ns=!0;var E=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var M={DetermineComponentFrameRoot:function(){try{if(C){var _t=function(){throw Error()};if(Object.defineProperty(_t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(_t,[])}catch(nt){var et=nt}Reflect.construct(b,[],_t)}else{try{_t.call()}catch(nt){et=nt}b.call(_t.prototype)}}else{try{throw Error()}catch(nt){et=nt}(_t=b())&&typeof _t.catch=="function"&&_t.catch(function(){})}}catch(nt){if(nt&&et&&typeof nt.stack=="string")return[nt.stack,et.stack]}return[null,null]}};M.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var L=Object.getOwnPropertyDescriptor(M.DetermineComponentFrameRoot,"name");L&&L.configurable&&Object.defineProperty(M.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var z=M.DetermineComponentFrameRoot(),fe=z[0],xe=z[1];if(fe&&xe){var ke=fe.split(`
`),Je=xe.split(`
`);for(L=M=0;M<ke.length&&!ke[M].includes("DetermineComponentFrameRoot");)M++;for(;L<Je.length&&!Je[L].includes("DetermineComponentFrameRoot");)L++;if(M===ke.length||L===Je.length)for(M=ke.length-1,L=Je.length-1;1<=M&&0<=L&&ke[M]!==Je[L];)L--;for(;1<=M&&0<=L;M--,L--)if(ke[M]!==Je[L]){if(M!==1||L!==1)do if(M--,L--,0>L||ke[M]!==Je[L]){var bt=`
`+ke[M].replace(" at new "," at ");return b.displayName&&bt.includes("<anonymous>")&&(bt=bt.replace("<anonymous>",b.displayName)),bt}while(1<=M&&0<=L);break}}}finally{Ns=!1,Error.prepareStackTrace=E}return(E=b?b.displayName||b.name:"")?yi(E):""}function Co(b){switch(b.tag){case 26:case 27:case 5:return yi(b.type);case 16:return yi("Lazy");case 13:return yi("Suspense");case 19:return yi("SuspenseList");case 0:case 15:return $o(b.type,!1);case 11:return $o(b.type.render,!1);case 1:return $o(b.type,!0);case 31:return yi("Activity");default:return""}}function Hl(b){try{var C="";do C+=Co(b),b=b.return;while(b);return C}catch(E){return`
Error generating stack: `+E.message+`
`+E.stack}}function vr(b){switch(typeof b){case"bigint":case"boolean":case"number":case"string":case"undefined":return b;case"object":return b;default:return""}}function Ga(b){var C=b.type;return(b=b.nodeName)&&b.toLowerCase()==="input"&&(C==="checkbox"||C==="radio")}function ul(b){var C=Ga(b)?"checked":"value",E=Object.getOwnPropertyDescriptor(b.constructor.prototype,C),M=""+b[C];if(!b.hasOwnProperty(C)&&typeof E<"u"&&typeof E.get=="function"&&typeof E.set=="function"){var L=E.get,z=E.set;return Object.defineProperty(b,C,{configurable:!0,get:function(){return L.call(this)},set:function(fe){M=""+fe,z.call(this,fe)}}),Object.defineProperty(b,C,{enumerable:E.enumerable}),{getValue:function(){return M},setValue:function(fe){M=""+fe},stopTracking:function(){b._valueTracker=null,delete b[C]}}}}function Go(b){b._valueTracker||(b._valueTracker=ul(b))}function fl(b){if(!b)return!1;var C=b._valueTracker;if(!C)return!0;var E=C.getValue(),M="";return b&&(M=Ga(b)?b.checked?"true":"false":b.value),b=M,b!==E?(C.setValue(b),!0):!1}function ja(b){if(b=b||(typeof document<"u"?document:void 0),typeof b>"u")return null;try{return b.activeElement||b.body}catch{return b.body}}var Ru=/[\n"\\]/g;function pa(b){return b.replace(Ru,function(C){return"\\"+C.charCodeAt(0).toString(16)+" "})}function Kl(b,C,E,M,L,z,fe,xe){b.name="",fe!=null&&typeof fe!="function"&&typeof fe!="symbol"&&typeof fe!="boolean"?b.type=fe:b.removeAttribute("type"),C!=null?fe==="number"?(C===0&&b.value===""||b.value!=C)&&(b.value=""+vr(C)):b.value!==""+vr(C)&&(b.value=""+vr(C)):fe!=="submit"&&fe!=="reset"||b.removeAttribute("value"),C!=null?Da(b,fe,vr(C)):E!=null?Da(b,fe,vr(E)):M!=null&&b.removeAttribute("value"),L==null&&z!=null&&(b.defaultChecked=!!z),L!=null&&(b.checked=L&&typeof L!="function"&&typeof L!="symbol"),xe!=null&&typeof xe!="function"&&typeof xe!="symbol"&&typeof xe!="boolean"?b.name=""+vr(xe):b.removeAttribute("name")}function Oc(b,C,E,M,L,z,fe,xe){if(z!=null&&typeof z!="function"&&typeof z!="symbol"&&typeof z!="boolean"&&(b.type=z),C!=null||E!=null){if(!(z!=="submit"&&z!=="reset"||C!=null))return;E=E!=null?""+vr(E):"",C=C!=null?""+vr(C):E,xe||C===b.value||(b.value=C),b.defaultValue=C}M=M??L,M=typeof M!="function"&&typeof M!="symbol"&&!!M,b.checked=xe?b.checked:!!M,b.defaultChecked=!!M,fe!=null&&typeof fe!="function"&&typeof fe!="symbol"&&typeof fe!="boolean"&&(b.name=fe)}function Da(b,C,E){C==="number"&&ja(b.ownerDocument)===b||b.defaultValue===""+E||(b.defaultValue=""+E)}function $i(b,C,E,M){if(b=b.options,C){C={};for(var L=0;L<E.length;L++)C["$"+E[L]]=!0;for(E=0;E<b.length;E++)L=C.hasOwnProperty("$"+b[E].value),b[E].selected!==L&&(b[E].selected=L),L&&M&&(b[E].defaultSelected=!0)}else{for(E=""+vr(E),C=null,L=0;L<b.length;L++){if(b[L].value===E){b[L].selected=!0,M&&(b[L].defaultSelected=!0);return}C!==null||b[L].disabled||(C=b[L])}C!==null&&(C.selected=!0)}}function Oa(b,C,E){if(C!=null&&(C=""+vr(C),C!==b.value&&(b.value=C),E==null)){b.defaultValue!==C&&(b.defaultValue=C);return}b.defaultValue=E!=null?""+vr(E):""}function Gi(b,C,E,M){if(C==null){if(M!=null){if(E!=null)throw Error(r(92));if(B(M)){if(1<M.length)throw Error(r(93));M=M[0]}E=M}E==null&&(E=""),C=E}E=vr(C),b.defaultValue=E,M=b.textContent,M===E&&M!==""&&M!==null&&(b.value=M)}function jo(b,C){if(C){var E=b.firstChild;if(E&&E===b.lastChild&&E.nodeType===3){E.nodeValue=C;return}}b.textContent=C}var ss=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function ls(b,C,E){var M=C.indexOf("--")===0;E==null||typeof E=="boolean"||E===""?M?b.setProperty(C,""):C==="float"?b.cssFloat="":b[C]="":M?b.setProperty(C,E):typeof E!="number"||E===0||ss.has(C)?C==="float"?b.cssFloat=E:b[C]=(""+E).trim():b[C]=E+"px"}function Jr(b,C,E){if(C!=null&&typeof C!="object")throw Error(r(62));if(b=b.style,E!=null){for(var M in E)!E.hasOwnProperty(M)||C!=null&&C.hasOwnProperty(M)||(M.indexOf("--")===0?b.setProperty(M,""):M==="float"?b.cssFloat="":b[M]="");for(var L in C)M=C[L],C.hasOwnProperty(L)&&E[L]!==M&&ls(b,L,M)}else for(var z in C)C.hasOwnProperty(z)&&ls(b,z,C[z])}function dl(b){if(b.indexOf("-")===-1)return!1;switch(b){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ma=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),ji=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function cs(b){return ji.test(""+b)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":b}var So=null;function ta(b){return b=b.target||b.srcElement||window,b.correspondingUseElement&&(b=b.correspondingUseElement),b.nodeType===3?b.parentNode:b}var za=null,zo=null;function ql(b){var C=nn(b);if(C&&(b=C.stateNode)){var E=b[qt]||null;e:switch(b=C.stateNode,C.type){case"input":if(Kl(b,E.value,E.defaultValue,E.defaultValue,E.checked,E.defaultChecked,E.type,E.name),C=E.name,E.type==="radio"&&C!=null){for(E=b;E.parentNode;)E=E.parentNode;for(E=E.querySelectorAll('input[name="'+pa(""+C)+'"][type="radio"]'),C=0;C<E.length;C++){var M=E[C];if(M!==b&&M.form===b.form){var L=M[qt]||null;if(!L)throw Error(r(90));Kl(M,L.value,L.defaultValue,L.defaultValue,L.checked,L.defaultChecked,L.type,L.name)}}for(C=0;C<E.length;C++)M=E[C],M.form===b.form&&fl(M)}break e;case"textarea":Oa(b,E.value,E.defaultValue);break e;case"select":C=E.value,C!=null&&$i(b,!!E.multiple,C,!1)}}}var us=!1;function Dr(b,C,E){if(us)return b(C,E);us=!0;try{var M=b(C);return M}finally{if(us=!1,(za!==null||zo!==null)&&(I5(),za&&(C=za,b=zo,zo=za=null,ql(C),b)))for(C=0;C<b.length;C++)ql(b[C])}}function ro(b,C){var E=b.stateNode;if(E===null)return null;var M=E[qt]||null;if(M===null)return null;E=M[C];e:switch(C){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(M=!M.disabled)||(b=b.type,M=!(b==="button"||b==="input"||b==="select"||b==="textarea")),b=!M;break e;default:b=!1}if(b)return null;if(E&&typeof E!="function")throw Error(r(231,C,typeof E));return E}var Or=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ci=!1;if(Or)try{var fs={};Object.defineProperty(fs,"passive",{get:function(){ci=!0}}),window.addEventListener("test",fs,fs),window.removeEventListener("test",fs,fs)}catch{ci=!1}var ui=null,Xl=null,Ti=null;function io(){if(Ti)return Ti;var b,C=Xl,E=C.length,M,L="value"in ui?ui.value:ui.textContent,z=L.length;for(b=0;b<E&&C[b]===L[b];b++);var fe=E-b;for(M=1;M<=fe&&C[E-M]===L[z-M];M++);return Ti=L.slice(b,1<M?1-M:void 0)}function ds(b){var C=b.keyCode;return"charCode"in b?(b=b.charCode,b===0&&C===13&&(b=13)):b=C,b===10&&(b=13),32<=b||b===13?b:0}function To(){return!0}function ga(){return!1}function Ei(b){function C(E,M,L,z,fe){this._reactName=E,this._targetInst=L,this.type=M,this.nativeEvent=z,this.target=fe,this.currentTarget=null;for(var xe in b)b.hasOwnProperty(xe)&&(E=b[xe],this[xe]=E?E(z):z[xe]);return this.isDefaultPrevented=(z.defaultPrevented!=null?z.defaultPrevented:z.returnValue===!1)?To:ga,this.isPropagationStopped=ga,this}return f(C.prototype,{preventDefault:function(){this.defaultPrevented=!0;var E=this.nativeEvent;E&&(E.preventDefault?E.preventDefault():typeof E.returnValue!="unknown"&&(E.returnValue=!1),this.isDefaultPrevented=To)},stopPropagation:function(){var E=this.nativeEvent;E&&(E.stopPropagation?E.stopPropagation():typeof E.cancelBubble!="unknown"&&(E.cancelBubble=!0),this.isPropagationStopped=To)},persist:function(){},isPersistent:To}),C}var Wo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(b){return b.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},hl=Ei(Wo),hs=f({},Wo,{view:0,detail:0}),Ls=Ei(hs),pl,ks,Vs,gl=f({},hs,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:vl,button:0,buttons:0,relatedTarget:function(b){return b.relatedTarget===void 0?b.fromElement===b.srcElement?b.toElement:b.fromElement:b.relatedTarget},movementX:function(b){return"movementX"in b?b.movementX:(b!==Vs&&(Vs&&b.type==="mousemove"?(pl=b.screenX-Vs.screenX,ks=b.screenY-Vs.screenY):ks=pl=0,Vs=b),pl)},movementY:function(b){return"movementY"in b?b.movementY:ks}}),Mc=Ei(gl),Pu=f({},gl,{dataTransfer:0}),Au=Ei(Pu),Nu=f({},hs,{relatedTarget:0}),Yl=Ei(Nu),Ic=f({},Wo,{animationName:0,elapsedTime:0,pseudoElement:0}),Lu=Ei(Ic),Rc=f({},Wo,{clipboardData:function(b){return"clipboardData"in b?b.clipboardData:window.clipboardData}}),Pc=Ei(Rc),ku=f({},Wo,{data:0}),ml=Ei(ku),Ac={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Nc={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Jl={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Vu(b){var C=this.nativeEvent;return C.getModifierState?C.getModifierState(b):(b=Jl[b])?!!C[b]:!1}function vl(){return Vu}var Fu=f({},hs,{key:function(b){if(b.key){var C=Ac[b.key]||b.key;if(C!=="Unidentified")return C}return b.type==="keypress"?(b=ds(b),b===13?"Enter":String.fromCharCode(b)):b.type==="keydown"||b.type==="keyup"?Nc[b.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:vl,charCode:function(b){return b.type==="keypress"?ds(b):0},keyCode:function(b){return b.type==="keydown"||b.type==="keyup"?b.keyCode:0},which:function(b){return b.type==="keypress"?ds(b):b.type==="keydown"||b.type==="keyup"?b.keyCode:0}}),Lc=Ei(Fu),Uu=f({},gl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),kc=Ei(Uu),Bu=f({},hs,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:vl}),$u=Ei(Bu),Zl=f({},Wo,{propertyName:0,elapsedTime:0,pseudoElement:0}),Ql=Ei(Zl),Ho=f({},gl,{deltaX:function(b){return"deltaX"in b?b.deltaX:"wheelDeltaX"in b?-b.wheelDeltaX:0},deltaY:function(b){return"deltaY"in b?b.deltaY:"wheelDeltaY"in b?-b.wheelDeltaY:"wheelDelta"in b?-b.wheelDelta:0},deltaZ:0,deltaMode:0}),ps=Ei(Ho),ao=f({},Wo,{newState:0,oldState:0}),Vc=Ei(ao),Fc=[9,13,27,32],Fs=Or&&"CompositionEvent"in window,gs=null;Or&&"documentMode"in document&&(gs=document.documentMode);var yl=Or&&"TextEvent"in window&&!gs,ec=Or&&(!Fs||gs&&8<gs&&11>=gs),pe=" ",ge=!1;function Ie(b,C){switch(b){case"keyup":return Fc.indexOf(C.keyCode)!==-1;case"keydown":return C.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function We(b){return b=b.detail,typeof b=="object"&&"data"in b?b.data:null}var tt=!1;function pt(b,C){switch(b){case"compositionend":return We(C);case"keypress":return C.which!==32?null:(ge=!0,pe);case"textInput":return b=C.data,b===pe&&ge?null:b;default:return null}}function gt(b,C){if(tt)return b==="compositionend"||!Fs&&Ie(b,C)?(b=io(),Ti=Xl=ui=null,tt=!1,b):null;switch(b){case"paste":return null;case"keypress":if(!(C.ctrlKey||C.altKey||C.metaKey)||C.ctrlKey&&C.altKey){if(C.char&&1<C.char.length)return C.char;if(C.which)return String.fromCharCode(C.which)}return null;case"compositionend":return ec&&C.locale!=="ko"?null:C.data;default:return null}}var rt={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function xt(b){var C=b&&b.nodeName&&b.nodeName.toLowerCase();return C==="input"?!!rt[b.type]:C==="textarea"}function Vt(b,C,E,M){za?zo?zo.push(M):zo=[M]:za=M,C=k5(C,"onChange"),0<C.length&&(E=new hl("onChange","change",null,E,M),b.push({event:E,listeners:C}))}var Ht=null,Qt=null;function cn(b){UR(b,0)}function le(b){var C=Yn(b);if(fl(C))return b}function se(b,C){if(b==="change")return C}var _e=!1;if(Or){var Ge;if(Or){var Ze="oninput"in document;if(!Ze){var St=document.createElement("div");St.setAttribute("oninput","return;"),Ze=typeof St.oninput=="function"}Ge=Ze}else Ge=!1;_e=Ge&&(!document.documentMode||9<document.documentMode)}function dt(){Ht&&(Ht.detachEvent("onpropertychange",ct),Qt=Ht=null)}function ct(b){if(b.propertyName==="value"&&le(Qt)){var C=[];Vt(C,Qt,b,ta(b)),Dr(cn,C)}}function Z(b,C,E){b==="focusin"?(dt(),Ht=C,Qt=E,Ht.attachEvent("onpropertychange",ct)):b==="focusout"&&dt()}function te(b){if(b==="selectionchange"||b==="keyup"||b==="keydown")return le(Qt)}function W(b,C){if(b==="click")return le(C)}function K(b,C){if(b==="input"||b==="change")return le(C)}function oe(b,C){return b===C&&(b!==0||1/b===1/C)||b!==b&&C!==C}var be=typeof Object.is=="function"?Object.is:oe;function De(b,C){if(be(b,C))return!0;if(typeof b!="object"||b===null||typeof C!="object"||C===null)return!1;var E=Object.keys(b),M=Object.keys(C);if(E.length!==M.length)return!1;for(M=0;M<E.length;M++){var L=E[M];if(!Y.call(C,L)||!be(b[L],C[L]))return!1}return!0}function Re(b){for(;b&&b.firstChild;)b=b.firstChild;return b}function Le(b,C){var E=Re(b);b=0;for(var M;E;){if(E.nodeType===3){if(M=b+E.textContent.length,b<=C&&M>=C)return{node:E,offset:C-b};b=M}e:{for(;E;){if(E.nextSibling){E=E.nextSibling;break e}E=E.parentNode}E=void 0}E=Re(E)}}function Be(b,C){return b&&C?b===C?!0:b&&b.nodeType===3?!1:C&&C.nodeType===3?Be(b,C.parentNode):"contains"in b?b.contains(C):b.compareDocumentPosition?!!(b.compareDocumentPosition(C)&16):!1:!1}function qe(b){b=b!=null&&b.ownerDocument!=null&&b.ownerDocument.defaultView!=null?b.ownerDocument.defaultView:window;for(var C=ja(b.document);C instanceof b.HTMLIFrameElement;){try{var E=typeof C.contentWindow.location.href=="string"}catch{E=!1}if(E)b=C.contentWindow;else break;C=ja(b.document)}return C}function ft(b){var C=b&&b.nodeName&&b.nodeName.toLowerCase();return C&&(C==="input"&&(b.type==="text"||b.type==="search"||b.type==="tel"||b.type==="url"||b.type==="password")||C==="textarea"||b.contentEditable==="true")}var At=Or&&"documentMode"in document&&11>=document.documentMode,Wt=null,Gt=null,dn=null,pn=!1;function er(b,C,E){var M=E.window===E?E.document:E.nodeType===9?E:E.ownerDocument;pn||Wt==null||Wt!==ja(M)||(M=Wt,"selectionStart"in M&&ft(M)?M={start:M.selectionStart,end:M.selectionEnd}:(M=(M.ownerDocument&&M.ownerDocument.defaultView||window).getSelection(),M={anchorNode:M.anchorNode,anchorOffset:M.anchorOffset,focusNode:M.focusNode,focusOffset:M.focusOffset}),dn&&De(dn,M)||(dn=M,M=k5(Gt,"onSelect"),0<M.length&&(C=new hl("onSelect","select",null,C,E),b.push({event:C,listeners:M}),C.target=Wt)))}function Vr(b,C){var E={};return E[b.toLowerCase()]=C.toLowerCase(),E["Webkit"+b]="webkit"+C,E["Moz"+b]="moz"+C,E}var Hr={animationend:Vr("Animation","AnimationEnd"),animationiteration:Vr("Animation","AnimationIteration"),animationstart:Vr("Animation","AnimationStart"),transitionrun:Vr("Transition","TransitionRun"),transitionstart:Vr("Transition","TransitionStart"),transitioncancel:Vr("Transition","TransitionCancel"),transitionend:Vr("Transition","TransitionEnd")},tc={},Ko={};Or&&(Ko=document.createElement("div").style,"AnimationEvent"in window||(delete Hr.animationend.animation,delete Hr.animationiteration.animation,delete Hr.animationstart.animation),"TransitionEvent"in window||delete Hr.transitionend.transition);function xl(b){if(tc[b])return tc[b];if(!Hr[b])return b;var C=Hr[b],E;for(E in C)if(C.hasOwnProperty(E)&&E in Ko)return tc[b]=C[E];return b}var Hf=xl("animationend"),o1=xl("animationiteration"),s1=xl("animationstart"),Kre=xl("transitionrun"),qre=xl("transitionstart"),Xre=xl("transitioncancel"),bM=xl("transitionend"),wM=new Map,PS="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");PS.push("scrollEnd");function nc(b,C){wM.set(b,C),li(C,[b])}var CM=new WeakMap;function bl(b,C){if(typeof b=="object"&&b!==null){var E=CM.get(b);return E!==void 0?E:(C={value:b,source:C,stack:Hl(C)},CM.set(b,C),C)}return{value:b,source:C,stack:Hl(C)}}var wl=[],rp=0,AS=0;function Zy(){for(var b=rp,C=AS=rp=0;C<b;){var E=wl[C];wl[C++]=null;var M=wl[C];wl[C++]=null;var L=wl[C];wl[C++]=null;var z=wl[C];if(wl[C++]=null,M!==null&&L!==null){var fe=M.pending;fe===null?L.next=L:(L.next=fe.next,fe.next=L),M.pending=L}z!==0&&SM(E,L,z)}}function Qy(b,C,E,M){wl[rp++]=b,wl[rp++]=C,wl[rp++]=E,wl[rp++]=M,AS|=M,b.lanes|=M,b=b.alternate,b!==null&&(b.lanes|=M)}function NS(b,C,E,M){return Qy(b,C,E,M),e5(b)}function ip(b,C){return Qy(b,null,null,C),e5(b)}function SM(b,C,E){b.lanes|=E;var M=b.alternate;M!==null&&(M.lanes|=E);for(var L=!1,z=b.return;z!==null;)z.childLanes|=E,M=z.alternate,M!==null&&(M.childLanes|=E),z.tag===22&&(b=z.stateNode,b===null||b._visibility&1||(L=!0)),b=z,z=z.return;return b.tag===3?(z=b.stateNode,L&&C!==null&&(L=31-ht(E),b=z.hiddenUpdates,M=b[L],M===null?b[L]=[C]:M.push(C),C.lane=E|536870912),z):null}function e5(b){if(50<P1)throw P1=0,B4=null,Error(r(185));for(var C=b.return;C!==null;)b=C,C=b.return;return b.tag===3?b.stateNode:null}var ap={};function Yre(b,C,E,M){this.tag=b,this.key=E,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=C,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=M,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Us(b,C,E,M){return new Yre(b,C,E,M)}function LS(b){return b=b.prototype,!(!b||!b.isReactComponent)}function Gu(b,C){var E=b.alternate;return E===null?(E=Us(b.tag,C,b.key,b.mode),E.elementType=b.elementType,E.type=b.type,E.stateNode=b.stateNode,E.alternate=b,b.alternate=E):(E.pendingProps=C,E.type=b.type,E.flags=0,E.subtreeFlags=0,E.deletions=null),E.flags=b.flags&65011712,E.childLanes=b.childLanes,E.lanes=b.lanes,E.child=b.child,E.memoizedProps=b.memoizedProps,E.memoizedState=b.memoizedState,E.updateQueue=b.updateQueue,C=b.dependencies,E.dependencies=C===null?null:{lanes:C.lanes,firstContext:C.firstContext},E.sibling=b.sibling,E.index=b.index,E.ref=b.ref,E.refCleanup=b.refCleanup,E}function TM(b,C){b.flags&=65011714;var E=b.alternate;return E===null?(b.childLanes=0,b.lanes=C,b.child=null,b.subtreeFlags=0,b.memoizedProps=null,b.memoizedState=null,b.updateQueue=null,b.dependencies=null,b.stateNode=null):(b.childLanes=E.childLanes,b.lanes=E.lanes,b.child=E.child,b.subtreeFlags=0,b.deletions=null,b.memoizedProps=E.memoizedProps,b.memoizedState=E.memoizedState,b.updateQueue=E.updateQueue,b.type=E.type,C=E.dependencies,b.dependencies=C===null?null:{lanes:C.lanes,firstContext:C.firstContext}),b}function t5(b,C,E,M,L,z){var fe=0;if(M=b,typeof b=="function")LS(b)&&(fe=1);else if(typeof b=="string")fe=Zie(b,E,ye.current)?26:b==="html"||b==="head"||b==="body"?27:5;else e:switch(b){case I:return b=Us(31,E,C,L),b.elementType=I,b.lanes=z,b;case p:return y0(E.children,L,z,C);case g:fe=8,L|=24;break;case m:return b=Us(12,E,C,L|2),b.elementType=m,b.lanes=z,b;case S:return b=Us(13,E,C,L),b.elementType=S,b.lanes=z,b;case T:return b=Us(19,E,C,L),b.elementType=T,b.lanes=z,b;default:if(typeof b=="object"&&b!==null)switch(b.$$typeof){case y:case x:fe=10;break e;case v:fe=9;break e;case w:fe=11;break e;case _:fe=14;break e;case D:fe=16,M=null;break e}fe=29,E=Error(r(130,b===null?"null":typeof b,"")),M=null}return C=Us(fe,E,C,L),C.elementType=b,C.type=M,C.lanes=z,C}function y0(b,C,E,M){return b=Us(7,b,M,C),b.lanes=E,b}function kS(b,C,E){return b=Us(6,b,null,C),b.lanes=E,b}function VS(b,C,E){return C=Us(4,b.children!==null?b.children:[],b.key,C),C.lanes=E,C.stateNode={containerInfo:b.containerInfo,pendingChildren:null,implementation:b.implementation},C}var op=[],sp=0,n5=null,r5=0,Cl=[],Sl=0,x0=null,ju=1,zu="";function b0(b,C){op[sp++]=r5,op[sp++]=n5,n5=b,r5=C}function EM(b,C,E){Cl[Sl++]=ju,Cl[Sl++]=zu,Cl[Sl++]=x0,x0=b;var M=ju;b=zu;var L=32-ht(M)-1;M&=~(1<<L),E+=1;var z=32-ht(C)+L;if(30<z){var fe=L-L%5;z=(M&(1<<fe)-1).toString(32),M>>=fe,L-=fe,ju=1<<32-ht(C)+L|E<<L|M,zu=z+b}else ju=1<<z|E<<L|M,zu=b}function FS(b){b.return!==null&&(b0(b,1),EM(b,1,0))}function US(b){for(;b===n5;)n5=op[--sp],op[sp]=null,r5=op[--sp],op[sp]=null;for(;b===x0;)x0=Cl[--Sl],Cl[Sl]=null,zu=Cl[--Sl],Cl[Sl]=null,ju=Cl[--Sl],Cl[Sl]=null}var qo=null,zi=null,Cr=!1,w0=null,Uc=!1,BS=Error(r(519));function C0(b){var C=Error(r(418,""));throw u1(bl(C,b)),BS}function _M(b){var C=b.stateNode,E=b.type,M=b.memoizedProps;switch(C[Bt]=b,C[qt]=M,E){case"dialog":Zn("cancel",C),Zn("close",C);break;case"iframe":case"object":case"embed":Zn("load",C);break;case"video":case"audio":for(E=0;E<N1.length;E++)Zn(N1[E],C);break;case"source":Zn("error",C);break;case"img":case"image":case"link":Zn("error",C),Zn("load",C);break;case"details":Zn("toggle",C);break;case"input":Zn("invalid",C),Oc(C,M.value,M.defaultValue,M.checked,M.defaultChecked,M.type,M.name,!0),Go(C);break;case"select":Zn("invalid",C);break;case"textarea":Zn("invalid",C),Gi(C,M.value,M.defaultValue,M.children),Go(C)}E=M.children,typeof E!="string"&&typeof E!="number"&&typeof E!="bigint"||C.textContent===""+E||M.suppressHydrationWarning===!0||jR(C.textContent,E)?(M.popover!=null&&(Zn("beforetoggle",C),Zn("toggle",C)),M.onScroll!=null&&Zn("scroll",C),M.onScrollEnd!=null&&Zn("scrollend",C),M.onClick!=null&&(C.onclick=V5),C=!0):C=!1,C||C0(b)}function DM(b){for(qo=b.return;qo;)switch(qo.tag){case 5:case 13:Uc=!1;return;case 27:case 3:Uc=!0;return;default:qo=qo.return}}function l1(b){if(b!==qo)return!1;if(!Cr)return DM(b),Cr=!0,!1;var C=b.tag,E;if((E=C!==3&&C!==27)&&((E=C===5)&&(E=b.type,E=!(E!=="form"&&E!=="button")||nT(b.type,b.memoizedProps)),E=!E),E&&zi&&C0(b),DM(b),C===13){if(b=b.memoizedState,b=b!==null?b.dehydrated:null,!b)throw Error(r(317));e:{for(b=b.nextSibling,C=0;b;){if(b.nodeType===8)if(E=b.data,E==="/$"){if(C===0){zi=ic(b.nextSibling);break e}C--}else E!=="$"&&E!=="$!"&&E!=="$?"||C++;b=b.nextSibling}zi=null}}else C===27?(C=zi,ld(b.type)?(b=oT,oT=null,zi=b):zi=C):zi=qo?ic(b.stateNode.nextSibling):null;return!0}function c1(){zi=qo=null,Cr=!1}function OM(){var b=w0;return b!==null&&(ys===null?ys=b:ys.push.apply(ys,b),w0=null),b}function u1(b){w0===null?w0=[b]:w0.push(b)}var $S=J(null),S0=null,Wu=null;function Kf(b,C,E){ne($S,C._currentValue),C._currentValue=E}function Hu(b){b._currentValue=$S.current,Q($S)}function GS(b,C,E){for(;b!==null;){var M=b.alternate;if((b.childLanes&C)!==C?(b.childLanes|=C,M!==null&&(M.childLanes|=C)):M!==null&&(M.childLanes&C)!==C&&(M.childLanes|=C),b===E)break;b=b.return}}function jS(b,C,E,M){var L=b.child;for(L!==null&&(L.return=b);L!==null;){var z=L.dependencies;if(z!==null){var fe=L.child;z=z.firstContext;e:for(;z!==null;){var xe=z;z=L;for(var ke=0;ke<C.length;ke++)if(xe.context===C[ke]){z.lanes|=E,xe=z.alternate,xe!==null&&(xe.lanes|=E),GS(z.return,E,b),M||(fe=null);break e}z=xe.next}}else if(L.tag===18){if(fe=L.return,fe===null)throw Error(r(341));fe.lanes|=E,z=fe.alternate,z!==null&&(z.lanes|=E),GS(fe,E,b),fe=null}else fe=L.child;if(fe!==null)fe.return=L;else for(fe=L;fe!==null;){if(fe===b){fe=null;break}if(L=fe.sibling,L!==null){L.return=fe.return,fe=L;break}fe=fe.return}L=fe}}function f1(b,C,E,M){b=null;for(var L=C,z=!1;L!==null;){if(!z){if((L.flags&524288)!==0)z=!0;else if((L.flags&262144)!==0)break}if(L.tag===10){var fe=L.alternate;if(fe===null)throw Error(r(387));if(fe=fe.memoizedProps,fe!==null){var xe=L.type;be(L.pendingProps.value,fe.value)||(b!==null?b.push(xe):b=[xe])}}else if(L===we.current){if(fe=L.alternate,fe===null)throw Error(r(387));fe.memoizedState.memoizedState!==L.memoizedState.memoizedState&&(b!==null?b.push(B1):b=[B1])}L=L.return}b!==null&&jS(C,b,E,M),C.flags|=262144}function i5(b){for(b=b.firstContext;b!==null;){if(!be(b.context._currentValue,b.memoizedValue))return!0;b=b.next}return!1}function T0(b){S0=b,Wu=null,b=b.dependencies,b!==null&&(b.firstContext=null)}function Eo(b){return MM(S0,b)}function a5(b,C){return S0===null&&T0(b),MM(b,C)}function MM(b,C){var E=C._currentValue;if(C={context:C,memoizedValue:E,next:null},Wu===null){if(b===null)throw Error(r(308));Wu=C,b.dependencies={lanes:0,firstContext:C},b.flags|=524288}else Wu=Wu.next=C;return E}var Jre=typeof AbortController<"u"?AbortController:function(){var b=[],C=this.signal={aborted:!1,addEventListener:function(E,M){b.push(M)}};this.abort=function(){C.aborted=!0,b.forEach(function(E){return E()})}},Zre=t.unstable_scheduleCallback,Qre=t.unstable_NormalPriority,Ia={$$typeof:x,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function zS(){return{controller:new Jre,data:new Map,refCount:0}}function d1(b){b.refCount--,b.refCount===0&&Zre(Qre,function(){b.controller.abort()})}var h1=null,WS=0,lp=0,cp=null;function eie(b,C){if(h1===null){var E=h1=[];WS=0,lp=K4(),cp={status:"pending",value:void 0,then:function(M){E.push(M)}}}return WS++,C.then(IM,IM),C}function IM(){if(--WS===0&&h1!==null){cp!==null&&(cp.status="fulfilled");var b=h1;h1=null,lp=0,cp=null;for(var C=0;C<b.length;C++)(0,b[C])()}}function tie(b,C){var E=[],M={status:"pending",value:null,reason:null,then:function(L){E.push(L)}};return b.then(function(){M.status="fulfilled",M.value=C;for(var L=0;L<E.length;L++)(0,E[L])(C)},function(L){for(M.status="rejected",M.reason=L,L=0;L<E.length;L++)(0,E[L])(void 0)}),M}var RM=V.S;V.S=function(b,C){typeof C=="object"&&C!==null&&typeof C.then=="function"&&eie(b,C),RM!==null&&RM(b,C)};var E0=J(null);function HS(){var b=E0.current;return b!==null?b:Zr.pooledCache}function o5(b,C){C===null?ne(E0,E0.current):ne(E0,C.pool)}function PM(){var b=HS();return b===null?null:{parent:Ia._currentValue,pool:b}}var p1=Error(r(460)),AM=Error(r(474)),s5=Error(r(542)),KS={then:function(){}};function NM(b){return b=b.status,b==="fulfilled"||b==="rejected"}function l5(){}function LM(b,C,E){switch(E=b[E],E===void 0?b.push(C):E!==C&&(C.then(l5,l5),C=E),C.status){case"fulfilled":return C.value;case"rejected":throw b=C.reason,VM(b),b;default:if(typeof C.status=="string")C.then(l5,l5);else{if(b=Zr,b!==null&&100<b.shellSuspendCounter)throw Error(r(482));b=C,b.status="pending",b.then(function(M){if(C.status==="pending"){var L=C;L.status="fulfilled",L.value=M}},function(M){if(C.status==="pending"){var L=C;L.status="rejected",L.reason=M}})}switch(C.status){case"fulfilled":return C.value;case"rejected":throw b=C.reason,VM(b),b}throw g1=C,p1}}var g1=null;function kM(){if(g1===null)throw Error(r(459));var b=g1;return g1=null,b}function VM(b){if(b===p1||b===s5)throw Error(r(483))}var qf=!1;function qS(b){b.updateQueue={baseState:b.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function XS(b,C){b=b.updateQueue,C.updateQueue===b&&(C.updateQueue={baseState:b.baseState,firstBaseUpdate:b.firstBaseUpdate,lastBaseUpdate:b.lastBaseUpdate,shared:b.shared,callbacks:null})}function Xf(b){return{lane:b,tag:0,payload:null,callback:null,next:null}}function Yf(b,C,E){var M=b.updateQueue;if(M===null)return null;if(M=M.shared,(Fr&2)!==0){var L=M.pending;return L===null?C.next=C:(C.next=L.next,L.next=C),M.pending=C,C=e5(b),SM(b,null,E),C}return Qy(b,M,C,E),e5(b)}function m1(b,C,E){if(C=C.updateQueue,C!==null&&(C=C.shared,(E&4194048)!==0)){var M=C.lanes;M&=b.pendingLanes,E|=M,C.lanes=E,hr(b,E)}}function YS(b,C){var E=b.updateQueue,M=b.alternate;if(M!==null&&(M=M.updateQueue,E===M)){var L=null,z=null;if(E=E.firstBaseUpdate,E!==null){do{var fe={lane:E.lane,tag:E.tag,payload:E.payload,callback:null,next:null};z===null?L=z=fe:z=z.next=fe,E=E.next}while(E!==null);z===null?L=z=C:z=z.next=C}else L=z=C;E={baseState:M.baseState,firstBaseUpdate:L,lastBaseUpdate:z,shared:M.shared,callbacks:M.callbacks},b.updateQueue=E;return}b=E.lastBaseUpdate,b===null?E.firstBaseUpdate=C:b.next=C,E.lastBaseUpdate=C}var JS=!1;function v1(){if(JS){var b=cp;if(b!==null)throw b}}function y1(b,C,E,M){JS=!1;var L=b.updateQueue;qf=!1;var z=L.firstBaseUpdate,fe=L.lastBaseUpdate,xe=L.shared.pending;if(xe!==null){L.shared.pending=null;var ke=xe,Je=ke.next;ke.next=null,fe===null?z=Je:fe.next=Je,fe=ke;var bt=b.alternate;bt!==null&&(bt=bt.updateQueue,xe=bt.lastBaseUpdate,xe!==fe&&(xe===null?bt.firstBaseUpdate=Je:xe.next=Je,bt.lastBaseUpdate=ke))}if(z!==null){var _t=L.baseState;fe=0,bt=Je=ke=null,xe=z;do{var et=xe.lane&-536870913,nt=et!==xe.lane;if(nt?(ur&et)===et:(M&et)===et){et!==0&&et===lp&&(JS=!0),bt!==null&&(bt=bt.next={lane:0,tag:xe.tag,payload:xe.payload,callback:null,next:null});e:{var wn=b,gn=xe;et=C;var zr=E;switch(gn.tag){case 1:if(wn=gn.payload,typeof wn=="function"){_t=wn.call(zr,_t,et);break e}_t=wn;break e;case 3:wn.flags=wn.flags&-65537|128;case 0:if(wn=gn.payload,et=typeof wn=="function"?wn.call(zr,_t,et):wn,et==null)break e;_t=f({},_t,et);break e;case 2:qf=!0}}et=xe.callback,et!==null&&(b.flags|=64,nt&&(b.flags|=8192),nt=L.callbacks,nt===null?L.callbacks=[et]:nt.push(et))}else nt={lane:et,tag:xe.tag,payload:xe.payload,callback:xe.callback,next:null},bt===null?(Je=bt=nt,ke=_t):bt=bt.next=nt,fe|=et;if(xe=xe.next,xe===null){if(xe=L.shared.pending,xe===null)break;nt=xe,xe=nt.next,nt.next=null,L.lastBaseUpdate=nt,L.shared.pending=null}}while(!0);bt===null&&(ke=_t),L.baseState=ke,L.firstBaseUpdate=Je,L.lastBaseUpdate=bt,z===null&&(L.shared.lanes=0),id|=fe,b.lanes=fe,b.memoizedState=_t}}function FM(b,C){if(typeof b!="function")throw Error(r(191,b));b.call(C)}function UM(b,C){var E=b.callbacks;if(E!==null)for(b.callbacks=null,b=0;b<E.length;b++)FM(E[b],C)}var up=J(null),c5=J(0);function BM(b,C){b=Qu,ne(c5,b),ne(up,C),Qu=b|C.baseLanes}function ZS(){ne(c5,Qu),ne(up,up.current)}function QS(){Qu=c5.current,Q(up),Q(c5)}var Jf=0,Wn=null,Gr=null,ma=null,u5=!1,fp=!1,_0=!1,f5=0,x1=0,dp=null,nie=0;function na(){throw Error(r(321))}function e4(b,C){if(C===null)return!1;for(var E=0;E<C.length&&E<b.length;E++)if(!be(b[E],C[E]))return!1;return!0}function t4(b,C,E,M,L,z){return Jf=z,Wn=C,C.memoizedState=null,C.updateQueue=null,C.lanes=0,V.H=b===null||b.memoizedState===null?SI:TI,_0=!1,z=E(M,L),_0=!1,fp&&(z=GM(C,E,M,L)),$M(b),z}function $M(b){V.H=v5;var C=Gr!==null&&Gr.next!==null;if(Jf=0,ma=Gr=Wn=null,u5=!1,x1=0,dp=null,C)throw Error(r(300));b===null||Wa||(b=b.dependencies,b!==null&&i5(b)&&(Wa=!0))}function GM(b,C,E,M){Wn=b;var L=0;do{if(fp&&(dp=null),x1=0,fp=!1,25<=L)throw Error(r(301));if(L+=1,ma=Gr=null,b.updateQueue!=null){var z=b.updateQueue;z.lastEffect=null,z.events=null,z.stores=null,z.memoCache!=null&&(z.memoCache.index=0)}V.H=cie,z=C(E,M)}while(fp);return z}function rie(){var b=V.H,C=b.useState()[0];return C=typeof C.then=="function"?b1(C):C,b=b.useState()[0],(Gr!==null?Gr.memoizedState:null)!==b&&(Wn.flags|=1024),C}function n4(){var b=f5!==0;return f5=0,b}function r4(b,C,E){C.updateQueue=b.updateQueue,C.flags&=-2053,b.lanes&=~E}function i4(b){if(u5){for(b=b.memoizedState;b!==null;){var C=b.queue;C!==null&&(C.pending=null),b=b.next}u5=!1}Jf=0,ma=Gr=Wn=null,fp=!1,x1=f5=0,dp=null}function ms(){var b={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ma===null?Wn.memoizedState=ma=b:ma=ma.next=b,ma}function va(){if(Gr===null){var b=Wn.alternate;b=b!==null?b.memoizedState:null}else b=Gr.next;var C=ma===null?Wn.memoizedState:ma.next;if(C!==null)ma=C,Gr=b;else{if(b===null)throw Wn.alternate===null?Error(r(467)):Error(r(310));Gr=b,b={memoizedState:Gr.memoizedState,baseState:Gr.baseState,baseQueue:Gr.baseQueue,queue:Gr.queue,next:null},ma===null?Wn.memoizedState=ma=b:ma=ma.next=b}return ma}function a4(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function b1(b){var C=x1;return x1+=1,dp===null&&(dp=[]),b=LM(dp,b,C),C=Wn,(ma===null?C.memoizedState:ma.next)===null&&(C=C.alternate,V.H=C===null||C.memoizedState===null?SI:TI),b}function d5(b){if(b!==null&&typeof b=="object"){if(typeof b.then=="function")return b1(b);if(b.$$typeof===x)return Eo(b)}throw Error(r(438,String(b)))}function o4(b){var C=null,E=Wn.updateQueue;if(E!==null&&(C=E.memoCache),C==null){var M=Wn.alternate;M!==null&&(M=M.updateQueue,M!==null&&(M=M.memoCache,M!=null&&(C={data:M.data.map(function(L){return L.slice()}),index:0})))}if(C==null&&(C={data:[],index:0}),E===null&&(E=a4(),Wn.updateQueue=E),E.memoCache=C,E=C.data[C.index],E===void 0)for(E=C.data[C.index]=Array(b),M=0;M<b;M++)E[M]=R;return C.index++,E}function Ku(b,C){return typeof C=="function"?C(b):C}function h5(b){var C=va();return s4(C,Gr,b)}function s4(b,C,E){var M=b.queue;if(M===null)throw Error(r(311));M.lastRenderedReducer=E;var L=b.baseQueue,z=M.pending;if(z!==null){if(L!==null){var fe=L.next;L.next=z.next,z.next=fe}C.baseQueue=L=z,M.pending=null}if(z=b.baseState,L===null)b.memoizedState=z;else{C=L.next;var xe=fe=null,ke=null,Je=C,bt=!1;do{var _t=Je.lane&-536870913;if(_t!==Je.lane?(ur&_t)===_t:(Jf&_t)===_t){var et=Je.revertLane;if(et===0)ke!==null&&(ke=ke.next={lane:0,revertLane:0,action:Je.action,hasEagerState:Je.hasEagerState,eagerState:Je.eagerState,next:null}),_t===lp&&(bt=!0);else if((Jf&et)===et){Je=Je.next,et===lp&&(bt=!0);continue}else _t={lane:0,revertLane:Je.revertLane,action:Je.action,hasEagerState:Je.hasEagerState,eagerState:Je.eagerState,next:null},ke===null?(xe=ke=_t,fe=z):ke=ke.next=_t,Wn.lanes|=et,id|=et;_t=Je.action,_0&&E(z,_t),z=Je.hasEagerState?Je.eagerState:E(z,_t)}else et={lane:_t,revertLane:Je.revertLane,action:Je.action,hasEagerState:Je.hasEagerState,eagerState:Je.eagerState,next:null},ke===null?(xe=ke=et,fe=z):ke=ke.next=et,Wn.lanes|=_t,id|=_t;Je=Je.next}while(Je!==null&&Je!==C);if(ke===null?fe=z:ke.next=xe,!be(z,b.memoizedState)&&(Wa=!0,bt&&(E=cp,E!==null)))throw E;b.memoizedState=z,b.baseState=fe,b.baseQueue=ke,M.lastRenderedState=z}return L===null&&(M.lanes=0),[b.memoizedState,M.dispatch]}function l4(b){var C=va(),E=C.queue;if(E===null)throw Error(r(311));E.lastRenderedReducer=b;var M=E.dispatch,L=E.pending,z=C.memoizedState;if(L!==null){E.pending=null;var fe=L=L.next;do z=b(z,fe.action),fe=fe.next;while(fe!==L);be(z,C.memoizedState)||(Wa=!0),C.memoizedState=z,C.baseQueue===null&&(C.baseState=z),E.lastRenderedState=z}return[z,M]}function jM(b,C,E){var M=Wn,L=va(),z=Cr;if(z){if(E===void 0)throw Error(r(407));E=E()}else E=C();var fe=!be((Gr||L).memoizedState,E);fe&&(L.memoizedState=E,Wa=!0),L=L.queue;var xe=HM.bind(null,M,L,b);if(w1(2048,8,xe,[b]),L.getSnapshot!==C||fe||ma!==null&&ma.memoizedState.tag&1){if(M.flags|=2048,hp(9,p5(),WM.bind(null,M,L,E,C),null),Zr===null)throw Error(r(349));z||(Jf&124)!==0||zM(M,C,E)}return E}function zM(b,C,E){b.flags|=16384,b={getSnapshot:C,value:E},C=Wn.updateQueue,C===null?(C=a4(),Wn.updateQueue=C,C.stores=[b]):(E=C.stores,E===null?C.stores=[b]:E.push(b))}function WM(b,C,E,M){C.value=E,C.getSnapshot=M,KM(C)&&qM(b)}function HM(b,C,E){return E(function(){KM(C)&&qM(b)})}function KM(b){var C=b.getSnapshot;b=b.value;try{var E=C();return!be(b,E)}catch{return!0}}function qM(b){var C=ip(b,2);C!==null&&zs(C,b,2)}function c4(b){var C=ms();if(typeof b=="function"){var E=b;if(b=E(),_0){ut(!0);try{E()}finally{ut(!1)}}}return C.memoizedState=C.baseState=b,C.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ku,lastRenderedState:b},C}function XM(b,C,E,M){return b.baseState=E,s4(b,Gr,typeof M=="function"?M:Ku)}function iie(b,C,E,M,L){if(m5(b))throw Error(r(485));if(b=C.action,b!==null){var z={payload:L,action:b,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(fe){z.listeners.push(fe)}};V.T!==null?E(!0):z.isTransition=!1,M(z),E=C.pending,E===null?(z.next=C.pending=z,YM(C,z)):(z.next=E.next,C.pending=E.next=z)}}function YM(b,C){var E=C.action,M=C.payload,L=b.state;if(C.isTransition){var z=V.T,fe={};V.T=fe;try{var xe=E(L,M),ke=V.S;ke!==null&&ke(fe,xe),JM(b,C,xe)}catch(Je){u4(b,C,Je)}finally{V.T=z}}else try{z=E(L,M),JM(b,C,z)}catch(Je){u4(b,C,Je)}}function JM(b,C,E){E!==null&&typeof E=="object"&&typeof E.then=="function"?E.then(function(M){ZM(b,C,M)},function(M){return u4(b,C,M)}):ZM(b,C,E)}function ZM(b,C,E){C.status="fulfilled",C.value=E,QM(C),b.state=E,C=b.pending,C!==null&&(E=C.next,E===C?b.pending=null:(E=E.next,C.next=E,YM(b,E)))}function u4(b,C,E){var M=b.pending;if(b.pending=null,M!==null){M=M.next;do C.status="rejected",C.reason=E,QM(C),C=C.next;while(C!==M)}b.action=null}function QM(b){b=b.listeners;for(var C=0;C<b.length;C++)(0,b[C])()}function eI(b,C){return C}function tI(b,C){if(Cr){var E=Zr.formState;if(E!==null){e:{var M=Wn;if(Cr){if(zi){t:{for(var L=zi,z=Uc;L.nodeType!==8;){if(!z){L=null;break t}if(L=ic(L.nextSibling),L===null){L=null;break t}}z=L.data,L=z==="F!"||z==="F"?L:null}if(L){zi=ic(L.nextSibling),M=L.data==="F!";break e}}C0(M)}M=!1}M&&(C=E[0])}}return E=ms(),E.memoizedState=E.baseState=C,M={pending:null,lanes:0,dispatch:null,lastRenderedReducer:eI,lastRenderedState:C},E.queue=M,E=bI.bind(null,Wn,M),M.dispatch=E,M=c4(!1),z=g4.bind(null,Wn,!1,M.queue),M=ms(),L={state:C,dispatch:null,action:b,pending:null},M.queue=L,E=iie.bind(null,Wn,L,z,E),L.dispatch=E,M.memoizedState=b,[C,E,!1]}function nI(b){var C=va();return rI(C,Gr,b)}function rI(b,C,E){if(C=s4(b,C,eI)[0],b=h5(Ku)[0],typeof C=="object"&&C!==null&&typeof C.then=="function")try{var M=b1(C)}catch(fe){throw fe===p1?s5:fe}else M=C;C=va();var L=C.queue,z=L.dispatch;return E!==C.memoizedState&&(Wn.flags|=2048,hp(9,p5(),aie.bind(null,L,E),null)),[M,z,b]}function aie(b,C){b.action=C}function iI(b){var C=va(),E=Gr;if(E!==null)return rI(C,E,b);va(),C=C.memoizedState,E=va();var M=E.queue.dispatch;return E.memoizedState=b,[C,M,!1]}function hp(b,C,E,M){return b={tag:b,create:E,deps:M,inst:C,next:null},C=Wn.updateQueue,C===null&&(C=a4(),Wn.updateQueue=C),E=C.lastEffect,E===null?C.lastEffect=b.next=b:(M=E.next,E.next=b,b.next=M,C.lastEffect=b),b}function p5(){return{destroy:void 0,resource:void 0}}function aI(){return va().memoizedState}function g5(b,C,E,M){var L=ms();M=M===void 0?null:M,Wn.flags|=b,L.memoizedState=hp(1|C,p5(),E,M)}function w1(b,C,E,M){var L=va();M=M===void 0?null:M;var z=L.memoizedState.inst;Gr!==null&&M!==null&&e4(M,Gr.memoizedState.deps)?L.memoizedState=hp(C,z,E,M):(Wn.flags|=b,L.memoizedState=hp(1|C,z,E,M))}function oI(b,C){g5(8390656,8,b,C)}function sI(b,C){w1(2048,8,b,C)}function lI(b,C){return w1(4,2,b,C)}function cI(b,C){return w1(4,4,b,C)}function uI(b,C){if(typeof C=="function"){b=b();var E=C(b);return function(){typeof E=="function"?E():C(null)}}if(C!=null)return b=b(),C.current=b,function(){C.current=null}}function fI(b,C,E){E=E!=null?E.concat([b]):null,w1(4,4,uI.bind(null,C,b),E)}function f4(){}function dI(b,C){var E=va();C=C===void 0?null:C;var M=E.memoizedState;return C!==null&&e4(C,M[1])?M[0]:(E.memoizedState=[b,C],b)}function hI(b,C){var E=va();C=C===void 0?null:C;var M=E.memoizedState;if(C!==null&&e4(C,M[1]))return M[0];if(M=b(),_0){ut(!0);try{b()}finally{ut(!1)}}return E.memoizedState=[M,C],M}function d4(b,C,E){return E===void 0||(Jf&1073741824)!==0?b.memoizedState=C:(b.memoizedState=E,b=mR(),Wn.lanes|=b,id|=b,E)}function pI(b,C,E,M){return be(E,C)?E:up.current!==null?(b=d4(b,E,M),be(b,C)||(Wa=!0),b):(Jf&42)===0?(Wa=!0,b.memoizedState=E):(b=mR(),Wn.lanes|=b,id|=b,C)}function gI(b,C,E,M,L){var z=$.p;$.p=z!==0&&8>z?z:8;var fe=V.T,xe={};V.T=xe,g4(b,!1,C,E);try{var ke=L(),Je=V.S;if(Je!==null&&Je(xe,ke),ke!==null&&typeof ke=="object"&&typeof ke.then=="function"){var bt=tie(ke,M);C1(b,C,bt,js(b))}else C1(b,C,M,js(b))}catch(_t){C1(b,C,{then:function(){},status:"rejected",reason:_t},js())}finally{$.p=z,V.T=fe}}function oie(){}function h4(b,C,E,M){if(b.tag!==5)throw Error(r(476));var L=mI(b).queue;gI(b,L,C,U,E===null?oie:function(){return vI(b),E(M)})}function mI(b){var C=b.memoizedState;if(C!==null)return C;C={memoizedState:U,baseState:U,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ku,lastRenderedState:U},next:null};var E={};return C.next={memoizedState:E,baseState:E,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ku,lastRenderedState:E},next:null},b.memoizedState=C,b=b.alternate,b!==null&&(b.memoizedState=C),C}function vI(b){var C=mI(b).next.queue;C1(b,C,{},js())}function p4(){return Eo(B1)}function yI(){return va().memoizedState}function xI(){return va().memoizedState}function sie(b){for(var C=b.return;C!==null;){switch(C.tag){case 24:case 3:var E=js();b=Xf(E);var M=Yf(C,b,E);M!==null&&(zs(M,C,E),m1(M,C,E)),C={cache:zS()},b.payload=C;return}C=C.return}}function lie(b,C,E){var M=js();E={lane:M,revertLane:0,action:E,hasEagerState:!1,eagerState:null,next:null},m5(b)?wI(C,E):(E=NS(b,C,E,M),E!==null&&(zs(E,b,M),CI(E,C,M)))}function bI(b,C,E){var M=js();C1(b,C,E,M)}function C1(b,C,E,M){var L={lane:M,revertLane:0,action:E,hasEagerState:!1,eagerState:null,next:null};if(m5(b))wI(C,L);else{var z=b.alternate;if(b.lanes===0&&(z===null||z.lanes===0)&&(z=C.lastRenderedReducer,z!==null))try{var fe=C.lastRenderedState,xe=z(fe,E);if(L.hasEagerState=!0,L.eagerState=xe,be(xe,fe))return Qy(b,C,L,0),Zr===null&&Zy(),!1}catch{}finally{}if(E=NS(b,C,L,M),E!==null)return zs(E,b,M),CI(E,C,M),!0}return!1}function g4(b,C,E,M){if(M={lane:2,revertLane:K4(),action:M,hasEagerState:!1,eagerState:null,next:null},m5(b)){if(C)throw Error(r(479))}else C=NS(b,E,M,2),C!==null&&zs(C,b,2)}function m5(b){var C=b.alternate;return b===Wn||C!==null&&C===Wn}function wI(b,C){fp=u5=!0;var E=b.pending;E===null?C.next=C:(C.next=E.next,E.next=C),b.pending=C}function CI(b,C,E){if((E&4194048)!==0){var M=C.lanes;M&=b.pendingLanes,E|=M,C.lanes=E,hr(b,E)}}var v5={readContext:Eo,use:d5,useCallback:na,useContext:na,useEffect:na,useImperativeHandle:na,useLayoutEffect:na,useInsertionEffect:na,useMemo:na,useReducer:na,useRef:na,useState:na,useDebugValue:na,useDeferredValue:na,useTransition:na,useSyncExternalStore:na,useId:na,useHostTransitionStatus:na,useFormState:na,useActionState:na,useOptimistic:na,useMemoCache:na,useCacheRefresh:na},SI={readContext:Eo,use:d5,useCallback:function(b,C){return ms().memoizedState=[b,C===void 0?null:C],b},useContext:Eo,useEffect:oI,useImperativeHandle:function(b,C,E){E=E!=null?E.concat([b]):null,g5(4194308,4,uI.bind(null,C,b),E)},useLayoutEffect:function(b,C){return g5(4194308,4,b,C)},useInsertionEffect:function(b,C){g5(4,2,b,C)},useMemo:function(b,C){var E=ms();C=C===void 0?null:C;var M=b();if(_0){ut(!0);try{b()}finally{ut(!1)}}return E.memoizedState=[M,C],M},useReducer:function(b,C,E){var M=ms();if(E!==void 0){var L=E(C);if(_0){ut(!0);try{E(C)}finally{ut(!1)}}}else L=C;return M.memoizedState=M.baseState=L,b={pending:null,lanes:0,dispatch:null,lastRenderedReducer:b,lastRenderedState:L},M.queue=b,b=b.dispatch=lie.bind(null,Wn,b),[M.memoizedState,b]},useRef:function(b){var C=ms();return b={current:b},C.memoizedState=b},useState:function(b){b=c4(b);var C=b.queue,E=bI.bind(null,Wn,C);return C.dispatch=E,[b.memoizedState,E]},useDebugValue:f4,useDeferredValue:function(b,C){var E=ms();return d4(E,b,C)},useTransition:function(){var b=c4(!1);return b=gI.bind(null,Wn,b.queue,!0,!1),ms().memoizedState=b,[!1,b]},useSyncExternalStore:function(b,C,E){var M=Wn,L=ms();if(Cr){if(E===void 0)throw Error(r(407));E=E()}else{if(E=C(),Zr===null)throw Error(r(349));(ur&124)!==0||zM(M,C,E)}L.memoizedState=E;var z={value:E,getSnapshot:C};return L.queue=z,oI(HM.bind(null,M,z,b),[b]),M.flags|=2048,hp(9,p5(),WM.bind(null,M,z,E,C),null),E},useId:function(){var b=ms(),C=Zr.identifierPrefix;if(Cr){var E=zu,M=ju;E=(M&~(1<<32-ht(M)-1)).toString(32)+E,C="«"+C+"R"+E,E=f5++,0<E&&(C+="H"+E.toString(32)),C+="»"}else E=nie++,C="«"+C+"r"+E.toString(32)+"»";return b.memoizedState=C},useHostTransitionStatus:p4,useFormState:tI,useActionState:tI,useOptimistic:function(b){var C=ms();C.memoizedState=C.baseState=b;var E={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return C.queue=E,C=g4.bind(null,Wn,!0,E),E.dispatch=C,[b,C]},useMemoCache:o4,useCacheRefresh:function(){return ms().memoizedState=sie.bind(null,Wn)}},TI={readContext:Eo,use:d5,useCallback:dI,useContext:Eo,useEffect:sI,useImperativeHandle:fI,useInsertionEffect:lI,useLayoutEffect:cI,useMemo:hI,useReducer:h5,useRef:aI,useState:function(){return h5(Ku)},useDebugValue:f4,useDeferredValue:function(b,C){var E=va();return pI(E,Gr.memoizedState,b,C)},useTransition:function(){var b=h5(Ku)[0],C=va().memoizedState;return[typeof b=="boolean"?b:b1(b),C]},useSyncExternalStore:jM,useId:yI,useHostTransitionStatus:p4,useFormState:nI,useActionState:nI,useOptimistic:function(b,C){var E=va();return XM(E,Gr,b,C)},useMemoCache:o4,useCacheRefresh:xI},cie={readContext:Eo,use:d5,useCallback:dI,useContext:Eo,useEffect:sI,useImperativeHandle:fI,useInsertionEffect:lI,useLayoutEffect:cI,useMemo:hI,useReducer:l4,useRef:aI,useState:function(){return l4(Ku)},useDebugValue:f4,useDeferredValue:function(b,C){var E=va();return Gr===null?d4(E,b,C):pI(E,Gr.memoizedState,b,C)},useTransition:function(){var b=l4(Ku)[0],C=va().memoizedState;return[typeof b=="boolean"?b:b1(b),C]},useSyncExternalStore:jM,useId:yI,useHostTransitionStatus:p4,useFormState:iI,useActionState:iI,useOptimistic:function(b,C){var E=va();return Gr!==null?XM(E,Gr,b,C):(E.baseState=b,[b,E.queue.dispatch])},useMemoCache:o4,useCacheRefresh:xI},pp=null,S1=0;function y5(b){var C=S1;return S1+=1,pp===null&&(pp=[]),LM(pp,b,C)}function T1(b,C){C=C.props.ref,b.ref=C!==void 0?C:null}function x5(b,C){throw C.$$typeof===u?Error(r(525)):(b=Object.prototype.toString.call(C),Error(r(31,b==="[object Object]"?"object with keys {"+Object.keys(C).join(", ")+"}":b)))}function EI(b){var C=b._init;return C(b._payload)}function _I(b){function C(ze,je){if(b){var Ye=ze.deletions;Ye===null?(ze.deletions=[je],ze.flags|=16):Ye.push(je)}}function E(ze,je){if(!b)return null;for(;je!==null;)C(ze,je),je=je.sibling;return null}function M(ze){for(var je=new Map;ze!==null;)ze.key!==null?je.set(ze.key,ze):je.set(ze.index,ze),ze=ze.sibling;return je}function L(ze,je){return ze=Gu(ze,je),ze.index=0,ze.sibling=null,ze}function z(ze,je,Ye){return ze.index=Ye,b?(Ye=ze.alternate,Ye!==null?(Ye=Ye.index,Ye<je?(ze.flags|=67108866,je):Ye):(ze.flags|=67108866,je)):(ze.flags|=1048576,je)}function fe(ze){return b&&ze.alternate===null&&(ze.flags|=67108866),ze}function xe(ze,je,Ye,Tt){return je===null||je.tag!==6?(je=kS(Ye,ze.mode,Tt),je.return=ze,je):(je=L(je,Ye),je.return=ze,je)}function ke(ze,je,Ye,Tt){var Xt=Ye.type;return Xt===p?bt(ze,je,Ye.props.children,Tt,Ye.key):je!==null&&(je.elementType===Xt||typeof Xt=="object"&&Xt!==null&&Xt.$$typeof===D&&EI(Xt)===je.type)?(je=L(je,Ye.props),T1(je,Ye),je.return=ze,je):(je=t5(Ye.type,Ye.key,Ye.props,null,ze.mode,Tt),T1(je,Ye),je.return=ze,je)}function Je(ze,je,Ye,Tt){return je===null||je.tag!==4||je.stateNode.containerInfo!==Ye.containerInfo||je.stateNode.implementation!==Ye.implementation?(je=VS(Ye,ze.mode,Tt),je.return=ze,je):(je=L(je,Ye.children||[]),je.return=ze,je)}function bt(ze,je,Ye,Tt,Xt){return je===null||je.tag!==7?(je=y0(Ye,ze.mode,Tt,Xt),je.return=ze,je):(je=L(je,Ye),je.return=ze,je)}function _t(ze,je,Ye){if(typeof je=="string"&&je!==""||typeof je=="number"||typeof je=="bigint")return je=kS(""+je,ze.mode,Ye),je.return=ze,je;if(typeof je=="object"&&je!==null){switch(je.$$typeof){case d:return Ye=t5(je.type,je.key,je.props,null,ze.mode,Ye),T1(Ye,je),Ye.return=ze,Ye;case h:return je=VS(je,ze.mode,Ye),je.return=ze,je;case D:var Tt=je._init;return je=Tt(je._payload),_t(ze,je,Ye)}if(B(je)||P(je))return je=y0(je,ze.mode,Ye,null),je.return=ze,je;if(typeof je.then=="function")return _t(ze,y5(je),Ye);if(je.$$typeof===x)return _t(ze,a5(ze,je),Ye);x5(ze,je)}return null}function et(ze,je,Ye,Tt){var Xt=je!==null?je.key:null;if(typeof Ye=="string"&&Ye!==""||typeof Ye=="number"||typeof Ye=="bigint")return Xt!==null?null:xe(ze,je,""+Ye,Tt);if(typeof Ye=="object"&&Ye!==null){switch(Ye.$$typeof){case d:return Ye.key===Xt?ke(ze,je,Ye,Tt):null;case h:return Ye.key===Xt?Je(ze,je,Ye,Tt):null;case D:return Xt=Ye._init,Ye=Xt(Ye._payload),et(ze,je,Ye,Tt)}if(B(Ye)||P(Ye))return Xt!==null?null:bt(ze,je,Ye,Tt,null);if(typeof Ye.then=="function")return et(ze,je,y5(Ye),Tt);if(Ye.$$typeof===x)return et(ze,je,a5(ze,Ye),Tt);x5(ze,Ye)}return null}function nt(ze,je,Ye,Tt,Xt){if(typeof Tt=="string"&&Tt!==""||typeof Tt=="number"||typeof Tt=="bigint")return ze=ze.get(Ye)||null,xe(je,ze,""+Tt,Xt);if(typeof Tt=="object"&&Tt!==null){switch(Tt.$$typeof){case d:return ze=ze.get(Tt.key===null?Ye:Tt.key)||null,ke(je,ze,Tt,Xt);case h:return ze=ze.get(Tt.key===null?Ye:Tt.key)||null,Je(je,ze,Tt,Xt);case D:var Xn=Tt._init;return Tt=Xn(Tt._payload),nt(ze,je,Ye,Tt,Xt)}if(B(Tt)||P(Tt))return ze=ze.get(Ye)||null,bt(je,ze,Tt,Xt,null);if(typeof Tt.then=="function")return nt(ze,je,Ye,y5(Tt),Xt);if(Tt.$$typeof===x)return nt(ze,je,Ye,a5(je,Tt),Xt);x5(je,Tt)}return null}function wn(ze,je,Ye,Tt){for(var Xt=null,Xn=null,ln=je,vn=je=0,Ka=null;ln!==null&&vn<Ye.length;vn++){ln.index>vn?(Ka=ln,ln=null):Ka=ln.sibling;var yr=et(ze,ln,Ye[vn],Tt);if(yr===null){ln===null&&(ln=Ka);break}b&&ln&&yr.alternate===null&&C(ze,ln),je=z(yr,je,vn),Xn===null?Xt=yr:Xn.sibling=yr,Xn=yr,ln=Ka}if(vn===Ye.length)return E(ze,ln),Cr&&b0(ze,vn),Xt;if(ln===null){for(;vn<Ye.length;vn++)ln=_t(ze,Ye[vn],Tt),ln!==null&&(je=z(ln,je,vn),Xn===null?Xt=ln:Xn.sibling=ln,Xn=ln);return Cr&&b0(ze,vn),Xt}for(ln=M(ln);vn<Ye.length;vn++)Ka=nt(ln,ze,vn,Ye[vn],Tt),Ka!==null&&(b&&Ka.alternate!==null&&ln.delete(Ka.key===null?vn:Ka.key),je=z(Ka,je,vn),Xn===null?Xt=Ka:Xn.sibling=Ka,Xn=Ka);return b&&ln.forEach(function(hd){return C(ze,hd)}),Cr&&b0(ze,vn),Xt}function gn(ze,je,Ye,Tt){if(Ye==null)throw Error(r(151));for(var Xt=null,Xn=null,ln=je,vn=je=0,Ka=null,yr=Ye.next();ln!==null&&!yr.done;vn++,yr=Ye.next()){ln.index>vn?(Ka=ln,ln=null):Ka=ln.sibling;var hd=et(ze,ln,yr.value,Tt);if(hd===null){ln===null&&(ln=Ka);break}b&&ln&&hd.alternate===null&&C(ze,ln),je=z(hd,je,vn),Xn===null?Xt=hd:Xn.sibling=hd,Xn=hd,ln=Ka}if(yr.done)return E(ze,ln),Cr&&b0(ze,vn),Xt;if(ln===null){for(;!yr.done;vn++,yr=Ye.next())yr=_t(ze,yr.value,Tt),yr!==null&&(je=z(yr,je,vn),Xn===null?Xt=yr:Xn.sibling=yr,Xn=yr);return Cr&&b0(ze,vn),Xt}for(ln=M(ln);!yr.done;vn++,yr=Ye.next())yr=nt(ln,ze,vn,yr.value,Tt),yr!==null&&(b&&yr.alternate!==null&&ln.delete(yr.key===null?vn:yr.key),je=z(yr,je,vn),Xn===null?Xt=yr:Xn.sibling=yr,Xn=yr);return b&&ln.forEach(function(uae){return C(ze,uae)}),Cr&&b0(ze,vn),Xt}function zr(ze,je,Ye,Tt){if(typeof Ye=="object"&&Ye!==null&&Ye.type===p&&Ye.key===null&&(Ye=Ye.props.children),typeof Ye=="object"&&Ye!==null){switch(Ye.$$typeof){case d:e:{for(var Xt=Ye.key;je!==null;){if(je.key===Xt){if(Xt=Ye.type,Xt===p){if(je.tag===7){E(ze,je.sibling),Tt=L(je,Ye.props.children),Tt.return=ze,ze=Tt;break e}}else if(je.elementType===Xt||typeof Xt=="object"&&Xt!==null&&Xt.$$typeof===D&&EI(Xt)===je.type){E(ze,je.sibling),Tt=L(je,Ye.props),T1(Tt,Ye),Tt.return=ze,ze=Tt;break e}E(ze,je);break}else C(ze,je);je=je.sibling}Ye.type===p?(Tt=y0(Ye.props.children,ze.mode,Tt,Ye.key),Tt.return=ze,ze=Tt):(Tt=t5(Ye.type,Ye.key,Ye.props,null,ze.mode,Tt),T1(Tt,Ye),Tt.return=ze,ze=Tt)}return fe(ze);case h:e:{for(Xt=Ye.key;je!==null;){if(je.key===Xt)if(je.tag===4&&je.stateNode.containerInfo===Ye.containerInfo&&je.stateNode.implementation===Ye.implementation){E(ze,je.sibling),Tt=L(je,Ye.children||[]),Tt.return=ze,ze=Tt;break e}else{E(ze,je);break}else C(ze,je);je=je.sibling}Tt=VS(Ye,ze.mode,Tt),Tt.return=ze,ze=Tt}return fe(ze);case D:return Xt=Ye._init,Ye=Xt(Ye._payload),zr(ze,je,Ye,Tt)}if(B(Ye))return wn(ze,je,Ye,Tt);if(P(Ye)){if(Xt=P(Ye),typeof Xt!="function")throw Error(r(150));return Ye=Xt.call(Ye),gn(ze,je,Ye,Tt)}if(typeof Ye.then=="function")return zr(ze,je,y5(Ye),Tt);if(Ye.$$typeof===x)return zr(ze,je,a5(ze,Ye),Tt);x5(ze,Ye)}return typeof Ye=="string"&&Ye!==""||typeof Ye=="number"||typeof Ye=="bigint"?(Ye=""+Ye,je!==null&&je.tag===6?(E(ze,je.sibling),Tt=L(je,Ye),Tt.return=ze,ze=Tt):(E(ze,je),Tt=kS(Ye,ze.mode,Tt),Tt.return=ze,ze=Tt),fe(ze)):E(ze,je)}return function(ze,je,Ye,Tt){try{S1=0;var Xt=zr(ze,je,Ye,Tt);return pp=null,Xt}catch(ln){if(ln===p1||ln===s5)throw ln;var Xn=Us(29,ln,null,ze.mode);return Xn.lanes=Tt,Xn.return=ze,Xn}finally{}}}var gp=_I(!0),DI=_I(!1),Tl=J(null),Bc=null;function Zf(b){var C=b.alternate;ne(Ra,Ra.current&1),ne(Tl,b),Bc===null&&(C===null||up.current!==null||C.memoizedState!==null)&&(Bc=b)}function OI(b){if(b.tag===22){if(ne(Ra,Ra.current),ne(Tl,b),Bc===null){var C=b.alternate;C!==null&&C.memoizedState!==null&&(Bc=b)}}else Qf()}function Qf(){ne(Ra,Ra.current),ne(Tl,Tl.current)}function qu(b){Q(Tl),Bc===b&&(Bc=null),Q(Ra)}var Ra=J(0);function b5(b){for(var C=b;C!==null;){if(C.tag===13){var E=C.memoizedState;if(E!==null&&(E=E.dehydrated,E===null||E.data==="$?"||aT(E)))return C}else if(C.tag===19&&C.memoizedProps.revealOrder!==void 0){if((C.flags&128)!==0)return C}else if(C.child!==null){C.child.return=C,C=C.child;continue}if(C===b)break;for(;C.sibling===null;){if(C.return===null||C.return===b)return null;C=C.return}C.sibling.return=C.return,C=C.sibling}return null}function m4(b,C,E,M){C=b.memoizedState,E=E(M,C),E=E==null?C:f({},C,E),b.memoizedState=E,b.lanes===0&&(b.updateQueue.baseState=E)}var v4={enqueueSetState:function(b,C,E){b=b._reactInternals;var M=js(),L=Xf(M);L.payload=C,E!=null&&(L.callback=E),C=Yf(b,L,M),C!==null&&(zs(C,b,M),m1(C,b,M))},enqueueReplaceState:function(b,C,E){b=b._reactInternals;var M=js(),L=Xf(M);L.tag=1,L.payload=C,E!=null&&(L.callback=E),C=Yf(b,L,M),C!==null&&(zs(C,b,M),m1(C,b,M))},enqueueForceUpdate:function(b,C){b=b._reactInternals;var E=js(),M=Xf(E);M.tag=2,C!=null&&(M.callback=C),C=Yf(b,M,E),C!==null&&(zs(C,b,E),m1(C,b,E))}};function MI(b,C,E,M,L,z,fe){return b=b.stateNode,typeof b.shouldComponentUpdate=="function"?b.shouldComponentUpdate(M,z,fe):C.prototype&&C.prototype.isPureReactComponent?!De(E,M)||!De(L,z):!0}function II(b,C,E,M){b=C.state,typeof C.componentWillReceiveProps=="function"&&C.componentWillReceiveProps(E,M),typeof C.UNSAFE_componentWillReceiveProps=="function"&&C.UNSAFE_componentWillReceiveProps(E,M),C.state!==b&&v4.enqueueReplaceState(C,C.state,null)}function D0(b,C){var E=C;if("ref"in C){E={};for(var M in C)M!=="ref"&&(E[M]=C[M])}if(b=b.defaultProps){E===C&&(E=f({},E));for(var L in b)E[L]===void 0&&(E[L]=b[L])}return E}var w5=typeof reportError=="function"?reportError:function(b){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var C=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof b=="object"&&b!==null&&typeof b.message=="string"?String(b.message):String(b),error:b});if(!window.dispatchEvent(C))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",b);return}console.error(b)};function RI(b){w5(b)}function PI(b){console.error(b)}function AI(b){w5(b)}function C5(b,C){try{var E=b.onUncaughtError;E(C.value,{componentStack:C.stack})}catch(M){setTimeout(function(){throw M})}}function NI(b,C,E){try{var M=b.onCaughtError;M(E.value,{componentStack:E.stack,errorBoundary:C.tag===1?C.stateNode:null})}catch(L){setTimeout(function(){throw L})}}function y4(b,C,E){return E=Xf(E),E.tag=3,E.payload={element:null},E.callback=function(){C5(b,C)},E}function LI(b){return b=Xf(b),b.tag=3,b}function kI(b,C,E,M){var L=E.type.getDerivedStateFromError;if(typeof L=="function"){var z=M.value;b.payload=function(){return L(z)},b.callback=function(){NI(C,E,M)}}var fe=E.stateNode;fe!==null&&typeof fe.componentDidCatch=="function"&&(b.callback=function(){NI(C,E,M),typeof L!="function"&&(ad===null?ad=new Set([this]):ad.add(this));var xe=M.stack;this.componentDidCatch(M.value,{componentStack:xe!==null?xe:""})})}function uie(b,C,E,M,L){if(E.flags|=32768,M!==null&&typeof M=="object"&&typeof M.then=="function"){if(C=E.alternate,C!==null&&f1(C,E,L,!0),E=Tl.current,E!==null){switch(E.tag){case 13:return Bc===null?G4():E.alternate===null&&Wi===0&&(Wi=3),E.flags&=-257,E.flags|=65536,E.lanes=L,M===KS?E.flags|=16384:(C=E.updateQueue,C===null?E.updateQueue=new Set([M]):C.add(M),z4(b,M,L)),!1;case 22:return E.flags|=65536,M===KS?E.flags|=16384:(C=E.updateQueue,C===null?(C={transitions:null,markerInstances:null,retryQueue:new Set([M])},E.updateQueue=C):(E=C.retryQueue,E===null?C.retryQueue=new Set([M]):E.add(M)),z4(b,M,L)),!1}throw Error(r(435,E.tag))}return z4(b,M,L),G4(),!1}if(Cr)return C=Tl.current,C!==null?((C.flags&65536)===0&&(C.flags|=256),C.flags|=65536,C.lanes=L,M!==BS&&(b=Error(r(422),{cause:M}),u1(bl(b,E)))):(M!==BS&&(C=Error(r(423),{cause:M}),u1(bl(C,E))),b=b.current.alternate,b.flags|=65536,L&=-L,b.lanes|=L,M=bl(M,E),L=y4(b.stateNode,M,L),YS(b,L),Wi!==4&&(Wi=2)),!1;var z=Error(r(520),{cause:M});if(z=bl(z,E),R1===null?R1=[z]:R1.push(z),Wi!==4&&(Wi=2),C===null)return!0;M=bl(M,E),E=C;do{switch(E.tag){case 3:return E.flags|=65536,b=L&-L,E.lanes|=b,b=y4(E.stateNode,M,b),YS(E,b),!1;case 1:if(C=E.type,z=E.stateNode,(E.flags&128)===0&&(typeof C.getDerivedStateFromError=="function"||z!==null&&typeof z.componentDidCatch=="function"&&(ad===null||!ad.has(z))))return E.flags|=65536,L&=-L,E.lanes|=L,L=LI(L),kI(L,b,E,M),YS(E,L),!1}E=E.return}while(E!==null);return!1}var VI=Error(r(461)),Wa=!1;function oo(b,C,E,M){C.child=b===null?DI(C,null,E,M):gp(C,b.child,E,M)}function FI(b,C,E,M,L){E=E.render;var z=C.ref;if("ref"in M){var fe={};for(var xe in M)xe!=="ref"&&(fe[xe]=M[xe])}else fe=M;return T0(C),M=t4(b,C,E,fe,z,L),xe=n4(),b!==null&&!Wa?(r4(b,C,L),Xu(b,C,L)):(Cr&&xe&&FS(C),C.flags|=1,oo(b,C,M,L),C.child)}function UI(b,C,E,M,L){if(b===null){var z=E.type;return typeof z=="function"&&!LS(z)&&z.defaultProps===void 0&&E.compare===null?(C.tag=15,C.type=z,BI(b,C,z,M,L)):(b=t5(E.type,null,M,C,C.mode,L),b.ref=C.ref,b.return=C,C.child=b)}if(z=b.child,!_4(b,L)){var fe=z.memoizedProps;if(E=E.compare,E=E!==null?E:De,E(fe,M)&&b.ref===C.ref)return Xu(b,C,L)}return C.flags|=1,b=Gu(z,M),b.ref=C.ref,b.return=C,C.child=b}function BI(b,C,E,M,L){if(b!==null){var z=b.memoizedProps;if(De(z,M)&&b.ref===C.ref)if(Wa=!1,C.pendingProps=M=z,_4(b,L))(b.flags&131072)!==0&&(Wa=!0);else return C.lanes=b.lanes,Xu(b,C,L)}return x4(b,C,E,M,L)}function $I(b,C,E){var M=C.pendingProps,L=M.children,z=b!==null?b.memoizedState:null;if(M.mode==="hidden"){if((C.flags&128)!==0){if(M=z!==null?z.baseLanes|E:E,b!==null){for(L=C.child=b.child,z=0;L!==null;)z=z|L.lanes|L.childLanes,L=L.sibling;C.childLanes=z&~M}else C.childLanes=0,C.child=null;return GI(b,C,M,E)}if((E&536870912)!==0)C.memoizedState={baseLanes:0,cachePool:null},b!==null&&o5(C,z!==null?z.cachePool:null),z!==null?BM(C,z):ZS(),OI(C);else return C.lanes=C.childLanes=536870912,GI(b,C,z!==null?z.baseLanes|E:E,E)}else z!==null?(o5(C,z.cachePool),BM(C,z),Qf(),C.memoizedState=null):(b!==null&&o5(C,null),ZS(),Qf());return oo(b,C,L,E),C.child}function GI(b,C,E,M){var L=HS();return L=L===null?null:{parent:Ia._currentValue,pool:L},C.memoizedState={baseLanes:E,cachePool:L},b!==null&&o5(C,null),ZS(),OI(C),b!==null&&f1(b,C,M,!0),null}function S5(b,C){var E=C.ref;if(E===null)b!==null&&b.ref!==null&&(C.flags|=4194816);else{if(typeof E!="function"&&typeof E!="object")throw Error(r(284));(b===null||b.ref!==E)&&(C.flags|=4194816)}}function x4(b,C,E,M,L){return T0(C),E=t4(b,C,E,M,void 0,L),M=n4(),b!==null&&!Wa?(r4(b,C,L),Xu(b,C,L)):(Cr&&M&&FS(C),C.flags|=1,oo(b,C,E,L),C.child)}function jI(b,C,E,M,L,z){return T0(C),C.updateQueue=null,E=GM(C,M,E,L),$M(b),M=n4(),b!==null&&!Wa?(r4(b,C,z),Xu(b,C,z)):(Cr&&M&&FS(C),C.flags|=1,oo(b,C,E,z),C.child)}function zI(b,C,E,M,L){if(T0(C),C.stateNode===null){var z=ap,fe=E.contextType;typeof fe=="object"&&fe!==null&&(z=Eo(fe)),z=new E(M,z),C.memoizedState=z.state!==null&&z.state!==void 0?z.state:null,z.updater=v4,C.stateNode=z,z._reactInternals=C,z=C.stateNode,z.props=M,z.state=C.memoizedState,z.refs={},qS(C),fe=E.contextType,z.context=typeof fe=="object"&&fe!==null?Eo(fe):ap,z.state=C.memoizedState,fe=E.getDerivedStateFromProps,typeof fe=="function"&&(m4(C,E,fe,M),z.state=C.memoizedState),typeof E.getDerivedStateFromProps=="function"||typeof z.getSnapshotBeforeUpdate=="function"||typeof z.UNSAFE_componentWillMount!="function"&&typeof z.componentWillMount!="function"||(fe=z.state,typeof z.componentWillMount=="function"&&z.componentWillMount(),typeof z.UNSAFE_componentWillMount=="function"&&z.UNSAFE_componentWillMount(),fe!==z.state&&v4.enqueueReplaceState(z,z.state,null),y1(C,M,z,L),v1(),z.state=C.memoizedState),typeof z.componentDidMount=="function"&&(C.flags|=4194308),M=!0}else if(b===null){z=C.stateNode;var xe=C.memoizedProps,ke=D0(E,xe);z.props=ke;var Je=z.context,bt=E.contextType;fe=ap,typeof bt=="object"&&bt!==null&&(fe=Eo(bt));var _t=E.getDerivedStateFromProps;bt=typeof _t=="function"||typeof z.getSnapshotBeforeUpdate=="function",xe=C.pendingProps!==xe,bt||typeof z.UNSAFE_componentWillReceiveProps!="function"&&typeof z.componentWillReceiveProps!="function"||(xe||Je!==fe)&&II(C,z,M,fe),qf=!1;var et=C.memoizedState;z.state=et,y1(C,M,z,L),v1(),Je=C.memoizedState,xe||et!==Je||qf?(typeof _t=="function"&&(m4(C,E,_t,M),Je=C.memoizedState),(ke=qf||MI(C,E,ke,M,et,Je,fe))?(bt||typeof z.UNSAFE_componentWillMount!="function"&&typeof z.componentWillMount!="function"||(typeof z.componentWillMount=="function"&&z.componentWillMount(),typeof z.UNSAFE_componentWillMount=="function"&&z.UNSAFE_componentWillMount()),typeof z.componentDidMount=="function"&&(C.flags|=4194308)):(typeof z.componentDidMount=="function"&&(C.flags|=4194308),C.memoizedProps=M,C.memoizedState=Je),z.props=M,z.state=Je,z.context=fe,M=ke):(typeof z.componentDidMount=="function"&&(C.flags|=4194308),M=!1)}else{z=C.stateNode,XS(b,C),fe=C.memoizedProps,bt=D0(E,fe),z.props=bt,_t=C.pendingProps,et=z.context,Je=E.contextType,ke=ap,typeof Je=="object"&&Je!==null&&(ke=Eo(Je)),xe=E.getDerivedStateFromProps,(Je=typeof xe=="function"||typeof z.getSnapshotBeforeUpdate=="function")||typeof z.UNSAFE_componentWillReceiveProps!="function"&&typeof z.componentWillReceiveProps!="function"||(fe!==_t||et!==ke)&&II(C,z,M,ke),qf=!1,et=C.memoizedState,z.state=et,y1(C,M,z,L),v1();var nt=C.memoizedState;fe!==_t||et!==nt||qf||b!==null&&b.dependencies!==null&&i5(b.dependencies)?(typeof xe=="function"&&(m4(C,E,xe,M),nt=C.memoizedState),(bt=qf||MI(C,E,bt,M,et,nt,ke)||b!==null&&b.dependencies!==null&&i5(b.dependencies))?(Je||typeof z.UNSAFE_componentWillUpdate!="function"&&typeof z.componentWillUpdate!="function"||(typeof z.componentWillUpdate=="function"&&z.componentWillUpdate(M,nt,ke),typeof z.UNSAFE_componentWillUpdate=="function"&&z.UNSAFE_componentWillUpdate(M,nt,ke)),typeof z.componentDidUpdate=="function"&&(C.flags|=4),typeof z.getSnapshotBeforeUpdate=="function"&&(C.flags|=1024)):(typeof z.componentDidUpdate!="function"||fe===b.memoizedProps&&et===b.memoizedState||(C.flags|=4),typeof z.getSnapshotBeforeUpdate!="function"||fe===b.memoizedProps&&et===b.memoizedState||(C.flags|=1024),C.memoizedProps=M,C.memoizedState=nt),z.props=M,z.state=nt,z.context=ke,M=bt):(typeof z.componentDidUpdate!="function"||fe===b.memoizedProps&&et===b.memoizedState||(C.flags|=4),typeof z.getSnapshotBeforeUpdate!="function"||fe===b.memoizedProps&&et===b.memoizedState||(C.flags|=1024),M=!1)}return z=M,S5(b,C),M=(C.flags&128)!==0,z||M?(z=C.stateNode,E=M&&typeof E.getDerivedStateFromError!="function"?null:z.render(),C.flags|=1,b!==null&&M?(C.child=gp(C,b.child,null,L),C.child=gp(C,null,E,L)):oo(b,C,E,L),C.memoizedState=z.state,b=C.child):b=Xu(b,C,L),b}function WI(b,C,E,M){return c1(),C.flags|=256,oo(b,C,E,M),C.child}var b4={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function w4(b){return{baseLanes:b,cachePool:PM()}}function C4(b,C,E){return b=b!==null?b.childLanes&~E:0,C&&(b|=El),b}function HI(b,C,E){var M=C.pendingProps,L=!1,z=(C.flags&128)!==0,fe;if((fe=z)||(fe=b!==null&&b.memoizedState===null?!1:(Ra.current&2)!==0),fe&&(L=!0,C.flags&=-129),fe=(C.flags&32)!==0,C.flags&=-33,b===null){if(Cr){if(L?Zf(C):Qf(),Cr){var xe=zi,ke;if(ke=xe){e:{for(ke=xe,xe=Uc;ke.nodeType!==8;){if(!xe){xe=null;break e}if(ke=ic(ke.nextSibling),ke===null){xe=null;break e}}xe=ke}xe!==null?(C.memoizedState={dehydrated:xe,treeContext:x0!==null?{id:ju,overflow:zu}:null,retryLane:536870912,hydrationErrors:null},ke=Us(18,null,null,0),ke.stateNode=xe,ke.return=C,C.child=ke,qo=C,zi=null,ke=!0):ke=!1}ke||C0(C)}if(xe=C.memoizedState,xe!==null&&(xe=xe.dehydrated,xe!==null))return aT(xe)?C.lanes=32:C.lanes=536870912,null;qu(C)}return xe=M.children,M=M.fallback,L?(Qf(),L=C.mode,xe=T5({mode:"hidden",children:xe},L),M=y0(M,L,E,null),xe.return=C,M.return=C,xe.sibling=M,C.child=xe,L=C.child,L.memoizedState=w4(E),L.childLanes=C4(b,fe,E),C.memoizedState=b4,M):(Zf(C),S4(C,xe))}if(ke=b.memoizedState,ke!==null&&(xe=ke.dehydrated,xe!==null)){if(z)C.flags&256?(Zf(C),C.flags&=-257,C=T4(b,C,E)):C.memoizedState!==null?(Qf(),C.child=b.child,C.flags|=128,C=null):(Qf(),L=M.fallback,xe=C.mode,M=T5({mode:"visible",children:M.children},xe),L=y0(L,xe,E,null),L.flags|=2,M.return=C,L.return=C,M.sibling=L,C.child=M,gp(C,b.child,null,E),M=C.child,M.memoizedState=w4(E),M.childLanes=C4(b,fe,E),C.memoizedState=b4,C=L);else if(Zf(C),aT(xe)){if(fe=xe.nextSibling&&xe.nextSibling.dataset,fe)var Je=fe.dgst;fe=Je,M=Error(r(419)),M.stack="",M.digest=fe,u1({value:M,source:null,stack:null}),C=T4(b,C,E)}else if(Wa||f1(b,C,E,!1),fe=(E&b.childLanes)!==0,Wa||fe){if(fe=Zr,fe!==null&&(M=E&-E,M=(M&42)!==0?1:Ke(M),M=(M&(fe.suspendedLanes|E))!==0?0:M,M!==0&&M!==ke.retryLane))throw ke.retryLane=M,ip(b,M),zs(fe,b,M),VI;xe.data==="$?"||G4(),C=T4(b,C,E)}else xe.data==="$?"?(C.flags|=192,C.child=b.child,C=null):(b=ke.treeContext,zi=ic(xe.nextSibling),qo=C,Cr=!0,w0=null,Uc=!1,b!==null&&(Cl[Sl++]=ju,Cl[Sl++]=zu,Cl[Sl++]=x0,ju=b.id,zu=b.overflow,x0=C),C=S4(C,M.children),C.flags|=4096);return C}return L?(Qf(),L=M.fallback,xe=C.mode,ke=b.child,Je=ke.sibling,M=Gu(ke,{mode:"hidden",children:M.children}),M.subtreeFlags=ke.subtreeFlags&65011712,Je!==null?L=Gu(Je,L):(L=y0(L,xe,E,null),L.flags|=2),L.return=C,M.return=C,M.sibling=L,C.child=M,M=L,L=C.child,xe=b.child.memoizedState,xe===null?xe=w4(E):(ke=xe.cachePool,ke!==null?(Je=Ia._currentValue,ke=ke.parent!==Je?{parent:Je,pool:Je}:ke):ke=PM(),xe={baseLanes:xe.baseLanes|E,cachePool:ke}),L.memoizedState=xe,L.childLanes=C4(b,fe,E),C.memoizedState=b4,M):(Zf(C),E=b.child,b=E.sibling,E=Gu(E,{mode:"visible",children:M.children}),E.return=C,E.sibling=null,b!==null&&(fe=C.deletions,fe===null?(C.deletions=[b],C.flags|=16):fe.push(b)),C.child=E,C.memoizedState=null,E)}function S4(b,C){return C=T5({mode:"visible",children:C},b.mode),C.return=b,b.child=C}function T5(b,C){return b=Us(22,b,null,C),b.lanes=0,b.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},b}function T4(b,C,E){return gp(C,b.child,null,E),b=S4(C,C.pendingProps.children),b.flags|=2,C.memoizedState=null,b}function KI(b,C,E){b.lanes|=C;var M=b.alternate;M!==null&&(M.lanes|=C),GS(b.return,C,E)}function E4(b,C,E,M,L){var z=b.memoizedState;z===null?b.memoizedState={isBackwards:C,rendering:null,renderingStartTime:0,last:M,tail:E,tailMode:L}:(z.isBackwards=C,z.rendering=null,z.renderingStartTime=0,z.last=M,z.tail=E,z.tailMode=L)}function qI(b,C,E){var M=C.pendingProps,L=M.revealOrder,z=M.tail;if(oo(b,C,M.children,E),M=Ra.current,(M&2)!==0)M=M&1|2,C.flags|=128;else{if(b!==null&&(b.flags&128)!==0)e:for(b=C.child;b!==null;){if(b.tag===13)b.memoizedState!==null&&KI(b,E,C);else if(b.tag===19)KI(b,E,C);else if(b.child!==null){b.child.return=b,b=b.child;continue}if(b===C)break e;for(;b.sibling===null;){if(b.return===null||b.return===C)break e;b=b.return}b.sibling.return=b.return,b=b.sibling}M&=1}switch(ne(Ra,M),L){case"forwards":for(E=C.child,L=null;E!==null;)b=E.alternate,b!==null&&b5(b)===null&&(L=E),E=E.sibling;E=L,E===null?(L=C.child,C.child=null):(L=E.sibling,E.sibling=null),E4(C,!1,L,E,z);break;case"backwards":for(E=null,L=C.child,C.child=null;L!==null;){if(b=L.alternate,b!==null&&b5(b)===null){C.child=L;break}b=L.sibling,L.sibling=E,E=L,L=b}E4(C,!0,E,null,z);break;case"together":E4(C,!1,null,null,void 0);break;default:C.memoizedState=null}return C.child}function Xu(b,C,E){if(b!==null&&(C.dependencies=b.dependencies),id|=C.lanes,(E&C.childLanes)===0)if(b!==null){if(f1(b,C,E,!1),(E&C.childLanes)===0)return null}else return null;if(b!==null&&C.child!==b.child)throw Error(r(153));if(C.child!==null){for(b=C.child,E=Gu(b,b.pendingProps),C.child=E,E.return=C;b.sibling!==null;)b=b.sibling,E=E.sibling=Gu(b,b.pendingProps),E.return=C;E.sibling=null}return C.child}function _4(b,C){return(b.lanes&C)!==0?!0:(b=b.dependencies,!!(b!==null&&i5(b)))}function fie(b,C,E){switch(C.tag){case 3:Ae(C,C.stateNode.containerInfo),Kf(C,Ia,b.memoizedState.cache),c1();break;case 27:case 5:q(C);break;case 4:Ae(C,C.stateNode.containerInfo);break;case 10:Kf(C,C.type,C.memoizedProps.value);break;case 13:var M=C.memoizedState;if(M!==null)return M.dehydrated!==null?(Zf(C),C.flags|=128,null):(E&C.child.childLanes)!==0?HI(b,C,E):(Zf(C),b=Xu(b,C,E),b!==null?b.sibling:null);Zf(C);break;case 19:var L=(b.flags&128)!==0;if(M=(E&C.childLanes)!==0,M||(f1(b,C,E,!1),M=(E&C.childLanes)!==0),L){if(M)return qI(b,C,E);C.flags|=128}if(L=C.memoizedState,L!==null&&(L.rendering=null,L.tail=null,L.lastEffect=null),ne(Ra,Ra.current),M)break;return null;case 22:case 23:return C.lanes=0,$I(b,C,E);case 24:Kf(C,Ia,b.memoizedState.cache)}return Xu(b,C,E)}function XI(b,C,E){if(b!==null)if(b.memoizedProps!==C.pendingProps)Wa=!0;else{if(!_4(b,E)&&(C.flags&128)===0)return Wa=!1,fie(b,C,E);Wa=(b.flags&131072)!==0}else Wa=!1,Cr&&(C.flags&1048576)!==0&&EM(C,r5,C.index);switch(C.lanes=0,C.tag){case 16:e:{b=C.pendingProps;var M=C.elementType,L=M._init;if(M=L(M._payload),C.type=M,typeof M=="function")LS(M)?(b=D0(M,b),C.tag=1,C=zI(null,C,M,b,E)):(C.tag=0,C=x4(null,C,M,b,E));else{if(M!=null){if(L=M.$$typeof,L===w){C.tag=11,C=FI(null,C,M,b,E);break e}else if(L===_){C.tag=14,C=UI(null,C,M,b,E);break e}}throw C=A(M)||M,Error(r(306,C,""))}}return C;case 0:return x4(b,C,C.type,C.pendingProps,E);case 1:return M=C.type,L=D0(M,C.pendingProps),zI(b,C,M,L,E);case 3:e:{if(Ae(C,C.stateNode.containerInfo),b===null)throw Error(r(387));M=C.pendingProps;var z=C.memoizedState;L=z.element,XS(b,C),y1(C,M,null,E);var fe=C.memoizedState;if(M=fe.cache,Kf(C,Ia,M),M!==z.cache&&jS(C,[Ia],E,!0),v1(),M=fe.element,z.isDehydrated)if(z={element:M,isDehydrated:!1,cache:fe.cache},C.updateQueue.baseState=z,C.memoizedState=z,C.flags&256){C=WI(b,C,M,E);break e}else if(M!==L){L=bl(Error(r(424)),C),u1(L),C=WI(b,C,M,E);break e}else{switch(b=C.stateNode.containerInfo,b.nodeType){case 9:b=b.body;break;default:b=b.nodeName==="HTML"?b.ownerDocument.body:b}for(zi=ic(b.firstChild),qo=C,Cr=!0,w0=null,Uc=!0,E=DI(C,null,M,E),C.child=E;E;)E.flags=E.flags&-3|4096,E=E.sibling}else{if(c1(),M===L){C=Xu(b,C,E);break e}oo(b,C,M,E)}C=C.child}return C;case 26:return S5(b,C),b===null?(E=QR(C.type,null,C.pendingProps,null))?C.memoizedState=E:Cr||(E=C.type,b=C.pendingProps,M=F5(Ce.current).createElement(E),M[Bt]=C,M[qt]=b,lo(M,E,b),rn(M),C.stateNode=M):C.memoizedState=QR(C.type,b.memoizedProps,C.pendingProps,b.memoizedState),null;case 27:return q(C),b===null&&Cr&&(M=C.stateNode=YR(C.type,C.pendingProps,Ce.current),qo=C,Uc=!0,L=zi,ld(C.type)?(oT=L,zi=ic(M.firstChild)):zi=L),oo(b,C,C.pendingProps.children,E),S5(b,C),b===null&&(C.flags|=4194304),C.child;case 5:return b===null&&Cr&&((L=M=zi)&&(M=Uie(M,C.type,C.pendingProps,Uc),M!==null?(C.stateNode=M,qo=C,zi=ic(M.firstChild),Uc=!1,L=!0):L=!1),L||C0(C)),q(C),L=C.type,z=C.pendingProps,fe=b!==null?b.memoizedProps:null,M=z.children,nT(L,z)?M=null:fe!==null&&nT(L,fe)&&(C.flags|=32),C.memoizedState!==null&&(L=t4(b,C,rie,null,null,E),B1._currentValue=L),S5(b,C),oo(b,C,M,E),C.child;case 6:return b===null&&Cr&&((b=E=zi)&&(E=Bie(E,C.pendingProps,Uc),E!==null?(C.stateNode=E,qo=C,zi=null,b=!0):b=!1),b||C0(C)),null;case 13:return HI(b,C,E);case 4:return Ae(C,C.stateNode.containerInfo),M=C.pendingProps,b===null?C.child=gp(C,null,M,E):oo(b,C,M,E),C.child;case 11:return FI(b,C,C.type,C.pendingProps,E);case 7:return oo(b,C,C.pendingProps,E),C.child;case 8:return oo(b,C,C.pendingProps.children,E),C.child;case 12:return oo(b,C,C.pendingProps.children,E),C.child;case 10:return M=C.pendingProps,Kf(C,C.type,M.value),oo(b,C,M.children,E),C.child;case 9:return L=C.type._context,M=C.pendingProps.children,T0(C),L=Eo(L),M=M(L),C.flags|=1,oo(b,C,M,E),C.child;case 14:return UI(b,C,C.type,C.pendingProps,E);case 15:return BI(b,C,C.type,C.pendingProps,E);case 19:return qI(b,C,E);case 31:return M=C.pendingProps,E=C.mode,M={mode:M.mode,children:M.children},b===null?(E=T5(M,E),E.ref=C.ref,C.child=E,E.return=C,C=E):(E=Gu(b.child,M),E.ref=C.ref,C.child=E,E.return=C,C=E),C;case 22:return $I(b,C,E);case 24:return T0(C),M=Eo(Ia),b===null?(L=HS(),L===null&&(L=Zr,z=zS(),L.pooledCache=z,z.refCount++,z!==null&&(L.pooledCacheLanes|=E),L=z),C.memoizedState={parent:M,cache:L},qS(C),Kf(C,Ia,L)):((b.lanes&E)!==0&&(XS(b,C),y1(C,null,null,E),v1()),L=b.memoizedState,z=C.memoizedState,L.parent!==M?(L={parent:M,cache:M},C.memoizedState=L,C.lanes===0&&(C.memoizedState=C.updateQueue.baseState=L),Kf(C,Ia,M)):(M=z.cache,Kf(C,Ia,M),M!==L.cache&&jS(C,[Ia],E,!0))),oo(b,C,C.pendingProps.children,E),C.child;case 29:throw C.pendingProps}throw Error(r(156,C.tag))}function Yu(b){b.flags|=4}function YI(b,C){if(C.type!=="stylesheet"||(C.state.loading&4)!==0)b.flags&=-16777217;else if(b.flags|=16777216,!iP(C)){if(C=Tl.current,C!==null&&((ur&4194048)===ur?Bc!==null:(ur&62914560)!==ur&&(ur&536870912)===0||C!==Bc))throw g1=KS,AM;b.flags|=8192}}function E5(b,C){C!==null&&(b.flags|=4),b.flags&16384&&(C=b.tag!==22?bn():536870912,b.lanes|=C,xp|=C)}function E1(b,C){if(!Cr)switch(b.tailMode){case"hidden":C=b.tail;for(var E=null;C!==null;)C.alternate!==null&&(E=C),C=C.sibling;E===null?b.tail=null:E.sibling=null;break;case"collapsed":E=b.tail;for(var M=null;E!==null;)E.alternate!==null&&(M=E),E=E.sibling;M===null?C||b.tail===null?b.tail=null:b.tail.sibling=null:M.sibling=null}}function _i(b){var C=b.alternate!==null&&b.alternate.child===b.child,E=0,M=0;if(C)for(var L=b.child;L!==null;)E|=L.lanes|L.childLanes,M|=L.subtreeFlags&65011712,M|=L.flags&65011712,L.return=b,L=L.sibling;else for(L=b.child;L!==null;)E|=L.lanes|L.childLanes,M|=L.subtreeFlags,M|=L.flags,L.return=b,L=L.sibling;return b.subtreeFlags|=M,b.childLanes=E,C}function die(b,C,E){var M=C.pendingProps;switch(US(C),C.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return _i(C),null;case 1:return _i(C),null;case 3:return E=C.stateNode,M=null,b!==null&&(M=b.memoizedState.cache),C.memoizedState.cache!==M&&(C.flags|=2048),Hu(Ia),Me(),E.pendingContext&&(E.context=E.pendingContext,E.pendingContext=null),(b===null||b.child===null)&&(l1(C)?Yu(C):b===null||b.memoizedState.isDehydrated&&(C.flags&256)===0||(C.flags|=1024,OM())),_i(C),null;case 26:return E=C.memoizedState,b===null?(Yu(C),E!==null?(_i(C),YI(C,E)):(_i(C),C.flags&=-16777217)):E?E!==b.memoizedState?(Yu(C),_i(C),YI(C,E)):(_i(C),C.flags&=-16777217):(b.memoizedProps!==M&&Yu(C),_i(C),C.flags&=-16777217),null;case 27:k(C),E=Ce.current;var L=C.type;if(b!==null&&C.stateNode!=null)b.memoizedProps!==M&&Yu(C);else{if(!M){if(C.stateNode===null)throw Error(r(166));return _i(C),null}b=ye.current,l1(C)?_M(C):(b=YR(L,M,E),C.stateNode=b,Yu(C))}return _i(C),null;case 5:if(k(C),E=C.type,b!==null&&C.stateNode!=null)b.memoizedProps!==M&&Yu(C);else{if(!M){if(C.stateNode===null)throw Error(r(166));return _i(C),null}if(b=ye.current,l1(C))_M(C);else{switch(L=F5(Ce.current),b){case 1:b=L.createElementNS("http://www.w3.org/2000/svg",E);break;case 2:b=L.createElementNS("http://www.w3.org/1998/Math/MathML",E);break;default:switch(E){case"svg":b=L.createElementNS("http://www.w3.org/2000/svg",E);break;case"math":b=L.createElementNS("http://www.w3.org/1998/Math/MathML",E);break;case"script":b=L.createElement("div"),b.innerHTML="<script><\/script>",b=b.removeChild(b.firstChild);break;case"select":b=typeof M.is=="string"?L.createElement("select",{is:M.is}):L.createElement("select"),M.multiple?b.multiple=!0:M.size&&(b.size=M.size);break;default:b=typeof M.is=="string"?L.createElement(E,{is:M.is}):L.createElement(E)}}b[Bt]=C,b[qt]=M;e:for(L=C.child;L!==null;){if(L.tag===5||L.tag===6)b.appendChild(L.stateNode);else if(L.tag!==4&&L.tag!==27&&L.child!==null){L.child.return=L,L=L.child;continue}if(L===C)break e;for(;L.sibling===null;){if(L.return===null||L.return===C)break e;L=L.return}L.sibling.return=L.return,L=L.sibling}C.stateNode=b;e:switch(lo(b,E,M),E){case"button":case"input":case"select":case"textarea":b=!!M.autoFocus;break e;case"img":b=!0;break e;default:b=!1}b&&Yu(C)}}return _i(C),C.flags&=-16777217,null;case 6:if(b&&C.stateNode!=null)b.memoizedProps!==M&&Yu(C);else{if(typeof M!="string"&&C.stateNode===null)throw Error(r(166));if(b=Ce.current,l1(C)){if(b=C.stateNode,E=C.memoizedProps,M=null,L=qo,L!==null)switch(L.tag){case 27:case 5:M=L.memoizedProps}b[Bt]=C,b=!!(b.nodeValue===E||M!==null&&M.suppressHydrationWarning===!0||jR(b.nodeValue,E)),b||C0(C)}else b=F5(b).createTextNode(M),b[Bt]=C,C.stateNode=b}return _i(C),null;case 13:if(M=C.memoizedState,b===null||b.memoizedState!==null&&b.memoizedState.dehydrated!==null){if(L=l1(C),M!==null&&M.dehydrated!==null){if(b===null){if(!L)throw Error(r(318));if(L=C.memoizedState,L=L!==null?L.dehydrated:null,!L)throw Error(r(317));L[Bt]=C}else c1(),(C.flags&128)===0&&(C.memoizedState=null),C.flags|=4;_i(C),L=!1}else L=OM(),b!==null&&b.memoizedState!==null&&(b.memoizedState.hydrationErrors=L),L=!0;if(!L)return C.flags&256?(qu(C),C):(qu(C),null)}if(qu(C),(C.flags&128)!==0)return C.lanes=E,C;if(E=M!==null,b=b!==null&&b.memoizedState!==null,E){M=C.child,L=null,M.alternate!==null&&M.alternate.memoizedState!==null&&M.alternate.memoizedState.cachePool!==null&&(L=M.alternate.memoizedState.cachePool.pool);var z=null;M.memoizedState!==null&&M.memoizedState.cachePool!==null&&(z=M.memoizedState.cachePool.pool),z!==L&&(M.flags|=2048)}return E!==b&&E&&(C.child.flags|=8192),E5(C,C.updateQueue),_i(C),null;case 4:return Me(),b===null&&J4(C.stateNode.containerInfo),_i(C),null;case 10:return Hu(C.type),_i(C),null;case 19:if(Q(Ra),L=C.memoizedState,L===null)return _i(C),null;if(M=(C.flags&128)!==0,z=L.rendering,z===null)if(M)E1(L,!1);else{if(Wi!==0||b!==null&&(b.flags&128)!==0)for(b=C.child;b!==null;){if(z=b5(b),z!==null){for(C.flags|=128,E1(L,!1),b=z.updateQueue,C.updateQueue=b,E5(C,b),C.subtreeFlags=0,b=E,E=C.child;E!==null;)TM(E,b),E=E.sibling;return ne(Ra,Ra.current&1|2),C.child}b=b.sibling}L.tail!==null&&Ee()>O5&&(C.flags|=128,M=!0,E1(L,!1),C.lanes=4194304)}else{if(!M)if(b=b5(z),b!==null){if(C.flags|=128,M=!0,b=b.updateQueue,C.updateQueue=b,E5(C,b),E1(L,!0),L.tail===null&&L.tailMode==="hidden"&&!z.alternate&&!Cr)return _i(C),null}else 2*Ee()-L.renderingStartTime>O5&&E!==536870912&&(C.flags|=128,M=!0,E1(L,!1),C.lanes=4194304);L.isBackwards?(z.sibling=C.child,C.child=z):(b=L.last,b!==null?b.sibling=z:C.child=z,L.last=z)}return L.tail!==null?(C=L.tail,L.rendering=C,L.tail=C.sibling,L.renderingStartTime=Ee(),C.sibling=null,b=Ra.current,ne(Ra,M?b&1|2:b&1),C):(_i(C),null);case 22:case 23:return qu(C),QS(),M=C.memoizedState!==null,b!==null?b.memoizedState!==null!==M&&(C.flags|=8192):M&&(C.flags|=8192),M?(E&536870912)!==0&&(C.flags&128)===0&&(_i(C),C.subtreeFlags&6&&(C.flags|=8192)):_i(C),E=C.updateQueue,E!==null&&E5(C,E.retryQueue),E=null,b!==null&&b.memoizedState!==null&&b.memoizedState.cachePool!==null&&(E=b.memoizedState.cachePool.pool),M=null,C.memoizedState!==null&&C.memoizedState.cachePool!==null&&(M=C.memoizedState.cachePool.pool),M!==E&&(C.flags|=2048),b!==null&&Q(E0),null;case 24:return E=null,b!==null&&(E=b.memoizedState.cache),C.memoizedState.cache!==E&&(C.flags|=2048),Hu(Ia),_i(C),null;case 25:return null;case 30:return null}throw Error(r(156,C.tag))}function hie(b,C){switch(US(C),C.tag){case 1:return b=C.flags,b&65536?(C.flags=b&-65537|128,C):null;case 3:return Hu(Ia),Me(),b=C.flags,(b&65536)!==0&&(b&128)===0?(C.flags=b&-65537|128,C):null;case 26:case 27:case 5:return k(C),null;case 13:if(qu(C),b=C.memoizedState,b!==null&&b.dehydrated!==null){if(C.alternate===null)throw Error(r(340));c1()}return b=C.flags,b&65536?(C.flags=b&-65537|128,C):null;case 19:return Q(Ra),null;case 4:return Me(),null;case 10:return Hu(C.type),null;case 22:case 23:return qu(C),QS(),b!==null&&Q(E0),b=C.flags,b&65536?(C.flags=b&-65537|128,C):null;case 24:return Hu(Ia),null;case 25:return null;default:return null}}function JI(b,C){switch(US(C),C.tag){case 3:Hu(Ia),Me();break;case 26:case 27:case 5:k(C);break;case 4:Me();break;case 13:qu(C);break;case 19:Q(Ra);break;case 10:Hu(C.type);break;case 22:case 23:qu(C),QS(),b!==null&&Q(E0);break;case 24:Hu(Ia)}}function _1(b,C){try{var E=C.updateQueue,M=E!==null?E.lastEffect:null;if(M!==null){var L=M.next;E=L;do{if((E.tag&b)===b){M=void 0;var z=E.create,fe=E.inst;M=z(),fe.destroy=M}E=E.next}while(E!==L)}}catch(xe){Kr(C,C.return,xe)}}function ed(b,C,E){try{var M=C.updateQueue,L=M!==null?M.lastEffect:null;if(L!==null){var z=L.next;M=z;do{if((M.tag&b)===b){var fe=M.inst,xe=fe.destroy;if(xe!==void 0){fe.destroy=void 0,L=C;var ke=E,Je=xe;try{Je()}catch(bt){Kr(L,ke,bt)}}}M=M.next}while(M!==z)}}catch(bt){Kr(C,C.return,bt)}}function ZI(b){var C=b.updateQueue;if(C!==null){var E=b.stateNode;try{UM(C,E)}catch(M){Kr(b,b.return,M)}}}function QI(b,C,E){E.props=D0(b.type,b.memoizedProps),E.state=b.memoizedState;try{E.componentWillUnmount()}catch(M){Kr(b,C,M)}}function D1(b,C){try{var E=b.ref;if(E!==null){switch(b.tag){case 26:case 27:case 5:var M=b.stateNode;break;case 30:M=b.stateNode;break;default:M=b.stateNode}typeof E=="function"?b.refCleanup=E(M):E.current=M}}catch(L){Kr(b,C,L)}}function $c(b,C){var E=b.ref,M=b.refCleanup;if(E!==null)if(typeof M=="function")try{M()}catch(L){Kr(b,C,L)}finally{b.refCleanup=null,b=b.alternate,b!=null&&(b.refCleanup=null)}else if(typeof E=="function")try{E(null)}catch(L){Kr(b,C,L)}else E.current=null}function eR(b){var C=b.type,E=b.memoizedProps,M=b.stateNode;try{e:switch(C){case"button":case"input":case"select":case"textarea":E.autoFocus&&M.focus();break e;case"img":E.src?M.src=E.src:E.srcSet&&(M.srcset=E.srcSet)}}catch(L){Kr(b,b.return,L)}}function D4(b,C,E){try{var M=b.stateNode;Nie(M,b.type,E,C),M[qt]=C}catch(L){Kr(b,b.return,L)}}function tR(b){return b.tag===5||b.tag===3||b.tag===26||b.tag===27&&ld(b.type)||b.tag===4}function O4(b){e:for(;;){for(;b.sibling===null;){if(b.return===null||tR(b.return))return null;b=b.return}for(b.sibling.return=b.return,b=b.sibling;b.tag!==5&&b.tag!==6&&b.tag!==18;){if(b.tag===27&&ld(b.type)||b.flags&2||b.child===null||b.tag===4)continue e;b.child.return=b,b=b.child}if(!(b.flags&2))return b.stateNode}}function M4(b,C,E){var M=b.tag;if(M===5||M===6)b=b.stateNode,C?(E.nodeType===9?E.body:E.nodeName==="HTML"?E.ownerDocument.body:E).insertBefore(b,C):(C=E.nodeType===9?E.body:E.nodeName==="HTML"?E.ownerDocument.body:E,C.appendChild(b),E=E._reactRootContainer,E!=null||C.onclick!==null||(C.onclick=V5));else if(M!==4&&(M===27&&ld(b.type)&&(E=b.stateNode,C=null),b=b.child,b!==null))for(M4(b,C,E),b=b.sibling;b!==null;)M4(b,C,E),b=b.sibling}function _5(b,C,E){var M=b.tag;if(M===5||M===6)b=b.stateNode,C?E.insertBefore(b,C):E.appendChild(b);else if(M!==4&&(M===27&&ld(b.type)&&(E=b.stateNode),b=b.child,b!==null))for(_5(b,C,E),b=b.sibling;b!==null;)_5(b,C,E),b=b.sibling}function nR(b){var C=b.stateNode,E=b.memoizedProps;try{for(var M=b.type,L=C.attributes;L.length;)C.removeAttributeNode(L[0]);lo(C,M,E),C[Bt]=b,C[qt]=E}catch(z){Kr(b,b.return,z)}}var Ju=!1,ra=!1,I4=!1,rR=typeof WeakSet=="function"?WeakSet:Set,Ha=null;function pie(b,C){if(b=b.containerInfo,eT=z5,b=qe(b),ft(b)){if("selectionStart"in b)var E={start:b.selectionStart,end:b.selectionEnd};else e:{E=(E=b.ownerDocument)&&E.defaultView||window;var M=E.getSelection&&E.getSelection();if(M&&M.rangeCount!==0){E=M.anchorNode;var L=M.anchorOffset,z=M.focusNode;M=M.focusOffset;try{E.nodeType,z.nodeType}catch{E=null;break e}var fe=0,xe=-1,ke=-1,Je=0,bt=0,_t=b,et=null;t:for(;;){for(var nt;_t!==E||L!==0&&_t.nodeType!==3||(xe=fe+L),_t!==z||M!==0&&_t.nodeType!==3||(ke=fe+M),_t.nodeType===3&&(fe+=_t.nodeValue.length),(nt=_t.firstChild)!==null;)et=_t,_t=nt;for(;;){if(_t===b)break t;if(et===E&&++Je===L&&(xe=fe),et===z&&++bt===M&&(ke=fe),(nt=_t.nextSibling)!==null)break;_t=et,et=_t.parentNode}_t=nt}E=xe===-1||ke===-1?null:{start:xe,end:ke}}else E=null}E=E||{start:0,end:0}}else E=null;for(tT={focusedElem:b,selectionRange:E},z5=!1,Ha=C;Ha!==null;)if(C=Ha,b=C.child,(C.subtreeFlags&1024)!==0&&b!==null)b.return=C,Ha=b;else for(;Ha!==null;){switch(C=Ha,z=C.alternate,b=C.flags,C.tag){case 0:break;case 11:case 15:break;case 1:if((b&1024)!==0&&z!==null){b=void 0,E=C,L=z.memoizedProps,z=z.memoizedState,M=E.stateNode;try{var wn=D0(E.type,L,E.elementType===E.type);b=M.getSnapshotBeforeUpdate(wn,z),M.__reactInternalSnapshotBeforeUpdate=b}catch(gn){Kr(E,E.return,gn)}}break;case 3:if((b&1024)!==0){if(b=C.stateNode.containerInfo,E=b.nodeType,E===9)iT(b);else if(E===1)switch(b.nodeName){case"HEAD":case"HTML":case"BODY":iT(b);break;default:b.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((b&1024)!==0)throw Error(r(163))}if(b=C.sibling,b!==null){b.return=C.return,Ha=b;break}Ha=C.return}}function iR(b,C,E){var M=E.flags;switch(E.tag){case 0:case 11:case 15:td(b,E),M&4&&_1(5,E);break;case 1:if(td(b,E),M&4)if(b=E.stateNode,C===null)try{b.componentDidMount()}catch(fe){Kr(E,E.return,fe)}else{var L=D0(E.type,C.memoizedProps);C=C.memoizedState;try{b.componentDidUpdate(L,C,b.__reactInternalSnapshotBeforeUpdate)}catch(fe){Kr(E,E.return,fe)}}M&64&&ZI(E),M&512&&D1(E,E.return);break;case 3:if(td(b,E),M&64&&(b=E.updateQueue,b!==null)){if(C=null,E.child!==null)switch(E.child.tag){case 27:case 5:C=E.child.stateNode;break;case 1:C=E.child.stateNode}try{UM(b,C)}catch(fe){Kr(E,E.return,fe)}}break;case 27:C===null&&M&4&&nR(E);case 26:case 5:td(b,E),C===null&&M&4&&eR(E),M&512&&D1(E,E.return);break;case 12:td(b,E);break;case 13:td(b,E),M&4&&sR(b,E),M&64&&(b=E.memoizedState,b!==null&&(b=b.dehydrated,b!==null&&(E=Sie.bind(null,E),$ie(b,E))));break;case 22:if(M=E.memoizedState!==null||Ju,!M){C=C!==null&&C.memoizedState!==null||ra,L=Ju;var z=ra;Ju=M,(ra=C)&&!z?nd(b,E,(E.subtreeFlags&8772)!==0):td(b,E),Ju=L,ra=z}break;case 30:break;default:td(b,E)}}function aR(b){var C=b.alternate;C!==null&&(b.alternate=null,aR(C)),b.child=null,b.deletions=null,b.sibling=null,b.tag===5&&(C=b.stateNode,C!==null&&vi(C)),b.stateNode=null,b.return=null,b.dependencies=null,b.memoizedProps=null,b.memoizedState=null,b.pendingProps=null,b.stateNode=null,b.updateQueue=null}var xi=null,vs=!1;function Zu(b,C,E){for(E=E.child;E!==null;)oR(b,C,E),E=E.sibling}function oR(b,C,E){if(ue&&typeof ue.onCommitFiberUnmount=="function")try{ue.onCommitFiberUnmount(Ve,E)}catch{}switch(E.tag){case 26:ra||$c(E,C),Zu(b,C,E),E.memoizedState?E.memoizedState.count--:E.stateNode&&(E=E.stateNode,E.parentNode.removeChild(E));break;case 27:ra||$c(E,C);var M=xi,L=vs;ld(E.type)&&(xi=E.stateNode,vs=!1),Zu(b,C,E),k1(E.stateNode),xi=M,vs=L;break;case 5:ra||$c(E,C);case 6:if(M=xi,L=vs,xi=null,Zu(b,C,E),xi=M,vs=L,xi!==null)if(vs)try{(xi.nodeType===9?xi.body:xi.nodeName==="HTML"?xi.ownerDocument.body:xi).removeChild(E.stateNode)}catch(z){Kr(E,C,z)}else try{xi.removeChild(E.stateNode)}catch(z){Kr(E,C,z)}break;case 18:xi!==null&&(vs?(b=xi,qR(b.nodeType===9?b.body:b.nodeName==="HTML"?b.ownerDocument.body:b,E.stateNode),z1(b)):qR(xi,E.stateNode));break;case 4:M=xi,L=vs,xi=E.stateNode.containerInfo,vs=!0,Zu(b,C,E),xi=M,vs=L;break;case 0:case 11:case 14:case 15:ra||ed(2,E,C),ra||ed(4,E,C),Zu(b,C,E);break;case 1:ra||($c(E,C),M=E.stateNode,typeof M.componentWillUnmount=="function"&&QI(E,C,M)),Zu(b,C,E);break;case 21:Zu(b,C,E);break;case 22:ra=(M=ra)||E.memoizedState!==null,Zu(b,C,E),ra=M;break;default:Zu(b,C,E)}}function sR(b,C){if(C.memoizedState===null&&(b=C.alternate,b!==null&&(b=b.memoizedState,b!==null&&(b=b.dehydrated,b!==null))))try{z1(b)}catch(E){Kr(C,C.return,E)}}function gie(b){switch(b.tag){case 13:case 19:var C=b.stateNode;return C===null&&(C=b.stateNode=new rR),C;case 22:return b=b.stateNode,C=b._retryCache,C===null&&(C=b._retryCache=new rR),C;default:throw Error(r(435,b.tag))}}function R4(b,C){var E=gie(b);C.forEach(function(M){var L=Tie.bind(null,b,M);E.has(M)||(E.add(M),M.then(L,L))})}function Bs(b,C){var E=C.deletions;if(E!==null)for(var M=0;M<E.length;M++){var L=E[M],z=b,fe=C,xe=fe;e:for(;xe!==null;){switch(xe.tag){case 27:if(ld(xe.type)){xi=xe.stateNode,vs=!1;break e}break;case 5:xi=xe.stateNode,vs=!1;break e;case 3:case 4:xi=xe.stateNode.containerInfo,vs=!0;break e}xe=xe.return}if(xi===null)throw Error(r(160));oR(z,fe,L),xi=null,vs=!1,z=L.alternate,z!==null&&(z.return=null),L.return=null}if(C.subtreeFlags&13878)for(C=C.child;C!==null;)lR(C,b),C=C.sibling}var rc=null;function lR(b,C){var E=b.alternate,M=b.flags;switch(b.tag){case 0:case 11:case 14:case 15:Bs(C,b),$s(b),M&4&&(ed(3,b,b.return),_1(3,b),ed(5,b,b.return));break;case 1:Bs(C,b),$s(b),M&512&&(ra||E===null||$c(E,E.return)),M&64&&Ju&&(b=b.updateQueue,b!==null&&(M=b.callbacks,M!==null&&(E=b.shared.hiddenCallbacks,b.shared.hiddenCallbacks=E===null?M:E.concat(M))));break;case 26:var L=rc;if(Bs(C,b),$s(b),M&512&&(ra||E===null||$c(E,E.return)),M&4){var z=E!==null?E.memoizedState:null;if(M=b.memoizedState,E===null)if(M===null)if(b.stateNode===null){e:{M=b.type,E=b.memoizedProps,L=L.ownerDocument||L;t:switch(M){case"title":z=L.getElementsByTagName("title")[0],(!z||z[Li]||z[Bt]||z.namespaceURI==="http://www.w3.org/2000/svg"||z.hasAttribute("itemprop"))&&(z=L.createElement(M),L.head.insertBefore(z,L.querySelector("head > title"))),lo(z,M,E),z[Bt]=b,rn(z),M=z;break e;case"link":var fe=nP("link","href",L).get(M+(E.href||""));if(fe){for(var xe=0;xe<fe.length;xe++)if(z=fe[xe],z.getAttribute("href")===(E.href==null||E.href===""?null:E.href)&&z.getAttribute("rel")===(E.rel==null?null:E.rel)&&z.getAttribute("title")===(E.title==null?null:E.title)&&z.getAttribute("crossorigin")===(E.crossOrigin==null?null:E.crossOrigin)){fe.splice(xe,1);break t}}z=L.createElement(M),lo(z,M,E),L.head.appendChild(z);break;case"meta":if(fe=nP("meta","content",L).get(M+(E.content||""))){for(xe=0;xe<fe.length;xe++)if(z=fe[xe],z.getAttribute("content")===(E.content==null?null:""+E.content)&&z.getAttribute("name")===(E.name==null?null:E.name)&&z.getAttribute("property")===(E.property==null?null:E.property)&&z.getAttribute("http-equiv")===(E.httpEquiv==null?null:E.httpEquiv)&&z.getAttribute("charset")===(E.charSet==null?null:E.charSet)){fe.splice(xe,1);break t}}z=L.createElement(M),lo(z,M,E),L.head.appendChild(z);break;default:throw Error(r(468,M))}z[Bt]=b,rn(z),M=z}b.stateNode=M}else rP(L,b.type,b.stateNode);else b.stateNode=tP(L,M,b.memoizedProps);else z!==M?(z===null?E.stateNode!==null&&(E=E.stateNode,E.parentNode.removeChild(E)):z.count--,M===null?rP(L,b.type,b.stateNode):tP(L,M,b.memoizedProps)):M===null&&b.stateNode!==null&&D4(b,b.memoizedProps,E.memoizedProps)}break;case 27:Bs(C,b),$s(b),M&512&&(ra||E===null||$c(E,E.return)),E!==null&&M&4&&D4(b,b.memoizedProps,E.memoizedProps);break;case 5:if(Bs(C,b),$s(b),M&512&&(ra||E===null||$c(E,E.return)),b.flags&32){L=b.stateNode;try{jo(L,"")}catch(nt){Kr(b,b.return,nt)}}M&4&&b.stateNode!=null&&(L=b.memoizedProps,D4(b,L,E!==null?E.memoizedProps:L)),M&1024&&(I4=!0);break;case 6:if(Bs(C,b),$s(b),M&4){if(b.stateNode===null)throw Error(r(162));M=b.memoizedProps,E=b.stateNode;try{E.nodeValue=M}catch(nt){Kr(b,b.return,nt)}}break;case 3:if($5=null,L=rc,rc=U5(C.containerInfo),Bs(C,b),rc=L,$s(b),M&4&&E!==null&&E.memoizedState.isDehydrated)try{z1(C.containerInfo)}catch(nt){Kr(b,b.return,nt)}I4&&(I4=!1,cR(b));break;case 4:M=rc,rc=U5(b.stateNode.containerInfo),Bs(C,b),$s(b),rc=M;break;case 12:Bs(C,b),$s(b);break;case 13:Bs(C,b),$s(b),b.child.flags&8192&&b.memoizedState!==null!=(E!==null&&E.memoizedState!==null)&&(V4=Ee()),M&4&&(M=b.updateQueue,M!==null&&(b.updateQueue=null,R4(b,M)));break;case 22:L=b.memoizedState!==null;var ke=E!==null&&E.memoizedState!==null,Je=Ju,bt=ra;if(Ju=Je||L,ra=bt||ke,Bs(C,b),ra=bt,Ju=Je,$s(b),M&8192)e:for(C=b.stateNode,C._visibility=L?C._visibility&-2:C._visibility|1,L&&(E===null||ke||Ju||ra||O0(b)),E=null,C=b;;){if(C.tag===5||C.tag===26){if(E===null){ke=E=C;try{if(z=ke.stateNode,L)fe=z.style,typeof fe.setProperty=="function"?fe.setProperty("display","none","important"):fe.display="none";else{xe=ke.stateNode;var _t=ke.memoizedProps.style,et=_t!=null&&_t.hasOwnProperty("display")?_t.display:null;xe.style.display=et==null||typeof et=="boolean"?"":(""+et).trim()}}catch(nt){Kr(ke,ke.return,nt)}}}else if(C.tag===6){if(E===null){ke=C;try{ke.stateNode.nodeValue=L?"":ke.memoizedProps}catch(nt){Kr(ke,ke.return,nt)}}}else if((C.tag!==22&&C.tag!==23||C.memoizedState===null||C===b)&&C.child!==null){C.child.return=C,C=C.child;continue}if(C===b)break e;for(;C.sibling===null;){if(C.return===null||C.return===b)break e;E===C&&(E=null),C=C.return}E===C&&(E=null),C.sibling.return=C.return,C=C.sibling}M&4&&(M=b.updateQueue,M!==null&&(E=M.retryQueue,E!==null&&(M.retryQueue=null,R4(b,E))));break;case 19:Bs(C,b),$s(b),M&4&&(M=b.updateQueue,M!==null&&(b.updateQueue=null,R4(b,M)));break;case 30:break;case 21:break;default:Bs(C,b),$s(b)}}function $s(b){var C=b.flags;if(C&2){try{for(var E,M=b.return;M!==null;){if(tR(M)){E=M;break}M=M.return}if(E==null)throw Error(r(160));switch(E.tag){case 27:var L=E.stateNode,z=O4(b);_5(b,z,L);break;case 5:var fe=E.stateNode;E.flags&32&&(jo(fe,""),E.flags&=-33);var xe=O4(b);_5(b,xe,fe);break;case 3:case 4:var ke=E.stateNode.containerInfo,Je=O4(b);M4(b,Je,ke);break;default:throw Error(r(161))}}catch(bt){Kr(b,b.return,bt)}b.flags&=-3}C&4096&&(b.flags&=-4097)}function cR(b){if(b.subtreeFlags&1024)for(b=b.child;b!==null;){var C=b;cR(C),C.tag===5&&C.flags&1024&&C.stateNode.reset(),b=b.sibling}}function td(b,C){if(C.subtreeFlags&8772)for(C=C.child;C!==null;)iR(b,C.alternate,C),C=C.sibling}function O0(b){for(b=b.child;b!==null;){var C=b;switch(C.tag){case 0:case 11:case 14:case 15:ed(4,C,C.return),O0(C);break;case 1:$c(C,C.return);var E=C.stateNode;typeof E.componentWillUnmount=="function"&&QI(C,C.return,E),O0(C);break;case 27:k1(C.stateNode);case 26:case 5:$c(C,C.return),O0(C);break;case 22:C.memoizedState===null&&O0(C);break;case 30:O0(C);break;default:O0(C)}b=b.sibling}}function nd(b,C,E){for(E=E&&(C.subtreeFlags&8772)!==0,C=C.child;C!==null;){var M=C.alternate,L=b,z=C,fe=z.flags;switch(z.tag){case 0:case 11:case 15:nd(L,z,E),_1(4,z);break;case 1:if(nd(L,z,E),M=z,L=M.stateNode,typeof L.componentDidMount=="function")try{L.componentDidMount()}catch(Je){Kr(M,M.return,Je)}if(M=z,L=M.updateQueue,L!==null){var xe=M.stateNode;try{var ke=L.shared.hiddenCallbacks;if(ke!==null)for(L.shared.hiddenCallbacks=null,L=0;L<ke.length;L++)FM(ke[L],xe)}catch(Je){Kr(M,M.return,Je)}}E&&fe&64&&ZI(z),D1(z,z.return);break;case 27:nR(z);case 26:case 5:nd(L,z,E),E&&M===null&&fe&4&&eR(z),D1(z,z.return);break;case 12:nd(L,z,E);break;case 13:nd(L,z,E),E&&fe&4&&sR(L,z);break;case 22:z.memoizedState===null&&nd(L,z,E),D1(z,z.return);break;case 30:break;default:nd(L,z,E)}C=C.sibling}}function P4(b,C){var E=null;b!==null&&b.memoizedState!==null&&b.memoizedState.cachePool!==null&&(E=b.memoizedState.cachePool.pool),b=null,C.memoizedState!==null&&C.memoizedState.cachePool!==null&&(b=C.memoizedState.cachePool.pool),b!==E&&(b!=null&&b.refCount++,E!=null&&d1(E))}function A4(b,C){b=null,C.alternate!==null&&(b=C.alternate.memoizedState.cache),C=C.memoizedState.cache,C!==b&&(C.refCount++,b!=null&&d1(b))}function Gc(b,C,E,M){if(C.subtreeFlags&10256)for(C=C.child;C!==null;)uR(b,C,E,M),C=C.sibling}function uR(b,C,E,M){var L=C.flags;switch(C.tag){case 0:case 11:case 15:Gc(b,C,E,M),L&2048&&_1(9,C);break;case 1:Gc(b,C,E,M);break;case 3:Gc(b,C,E,M),L&2048&&(b=null,C.alternate!==null&&(b=C.alternate.memoizedState.cache),C=C.memoizedState.cache,C!==b&&(C.refCount++,b!=null&&d1(b)));break;case 12:if(L&2048){Gc(b,C,E,M),b=C.stateNode;try{var z=C.memoizedProps,fe=z.id,xe=z.onPostCommit;typeof xe=="function"&&xe(fe,C.alternate===null?"mount":"update",b.passiveEffectDuration,-0)}catch(ke){Kr(C,C.return,ke)}}else Gc(b,C,E,M);break;case 13:Gc(b,C,E,M);break;case 23:break;case 22:z=C.stateNode,fe=C.alternate,C.memoizedState!==null?z._visibility&2?Gc(b,C,E,M):O1(b,C):z._visibility&2?Gc(b,C,E,M):(z._visibility|=2,mp(b,C,E,M,(C.subtreeFlags&10256)!==0)),L&2048&&P4(fe,C);break;case 24:Gc(b,C,E,M),L&2048&&A4(C.alternate,C);break;default:Gc(b,C,E,M)}}function mp(b,C,E,M,L){for(L=L&&(C.subtreeFlags&10256)!==0,C=C.child;C!==null;){var z=b,fe=C,xe=E,ke=M,Je=fe.flags;switch(fe.tag){case 0:case 11:case 15:mp(z,fe,xe,ke,L),_1(8,fe);break;case 23:break;case 22:var bt=fe.stateNode;fe.memoizedState!==null?bt._visibility&2?mp(z,fe,xe,ke,L):O1(z,fe):(bt._visibility|=2,mp(z,fe,xe,ke,L)),L&&Je&2048&&P4(fe.alternate,fe);break;case 24:mp(z,fe,xe,ke,L),L&&Je&2048&&A4(fe.alternate,fe);break;default:mp(z,fe,xe,ke,L)}C=C.sibling}}function O1(b,C){if(C.subtreeFlags&10256)for(C=C.child;C!==null;){var E=b,M=C,L=M.flags;switch(M.tag){case 22:O1(E,M),L&2048&&P4(M.alternate,M);break;case 24:O1(E,M),L&2048&&A4(M.alternate,M);break;default:O1(E,M)}C=C.sibling}}var M1=8192;function vp(b){if(b.subtreeFlags&M1)for(b=b.child;b!==null;)fR(b),b=b.sibling}function fR(b){switch(b.tag){case 26:vp(b),b.flags&M1&&b.memoizedState!==null&&eae(rc,b.memoizedState,b.memoizedProps);break;case 5:vp(b);break;case 3:case 4:var C=rc;rc=U5(b.stateNode.containerInfo),vp(b),rc=C;break;case 22:b.memoizedState===null&&(C=b.alternate,C!==null&&C.memoizedState!==null?(C=M1,M1=16777216,vp(b),M1=C):vp(b));break;default:vp(b)}}function dR(b){var C=b.alternate;if(C!==null&&(b=C.child,b!==null)){C.child=null;do C=b.sibling,b.sibling=null,b=C;while(b!==null)}}function I1(b){var C=b.deletions;if((b.flags&16)!==0){if(C!==null)for(var E=0;E<C.length;E++){var M=C[E];Ha=M,pR(M,b)}dR(b)}if(b.subtreeFlags&10256)for(b=b.child;b!==null;)hR(b),b=b.sibling}function hR(b){switch(b.tag){case 0:case 11:case 15:I1(b),b.flags&2048&&ed(9,b,b.return);break;case 3:I1(b);break;case 12:I1(b);break;case 22:var C=b.stateNode;b.memoizedState!==null&&C._visibility&2&&(b.return===null||b.return.tag!==13)?(C._visibility&=-3,D5(b)):I1(b);break;default:I1(b)}}function D5(b){var C=b.deletions;if((b.flags&16)!==0){if(C!==null)for(var E=0;E<C.length;E++){var M=C[E];Ha=M,pR(M,b)}dR(b)}for(b=b.child;b!==null;){switch(C=b,C.tag){case 0:case 11:case 15:ed(8,C,C.return),D5(C);break;case 22:E=C.stateNode,E._visibility&2&&(E._visibility&=-3,D5(C));break;default:D5(C)}b=b.sibling}}function pR(b,C){for(;Ha!==null;){var E=Ha;switch(E.tag){case 0:case 11:case 15:ed(8,E,C);break;case 23:case 22:if(E.memoizedState!==null&&E.memoizedState.cachePool!==null){var M=E.memoizedState.cachePool.pool;M!=null&&M.refCount++}break;case 24:d1(E.memoizedState.cache)}if(M=E.child,M!==null)M.return=E,Ha=M;else e:for(E=b;Ha!==null;){M=Ha;var L=M.sibling,z=M.return;if(aR(M),M===E){Ha=null;break e}if(L!==null){L.return=z,Ha=L;break e}Ha=z}}}var mie={getCacheForType:function(b){var C=Eo(Ia),E=C.data.get(b);return E===void 0&&(E=b(),C.data.set(b,E)),E}},vie=typeof WeakMap=="function"?WeakMap:Map,Fr=0,Zr=null,Jn=null,ur=0,Ur=0,Gs=null,rd=!1,yp=!1,N4=!1,Qu=0,Wi=0,id=0,M0=0,L4=0,El=0,xp=0,R1=null,ys=null,k4=!1,V4=0,O5=1/0,M5=null,ad=null,so=0,od=null,bp=null,wp=0,F4=0,U4=null,gR=null,P1=0,B4=null;function js(){if((Fr&2)!==0&&ur!==0)return ur&-ur;if(V.T!==null){var b=lp;return b!==0?b:K4()}return Rt()}function mR(){El===0&&(El=(ur&536870912)===0||Cr?$t():536870912);var b=Tl.current;return b!==null&&(b.flags|=32),El}function zs(b,C,E){(b===Zr&&(Ur===2||Ur===9)||b.cancelPendingCommit!==null)&&(Cp(b,0),sd(b,ur,El,!1)),en(b,E),((Fr&2)===0||b!==Zr)&&(b===Zr&&((Fr&2)===0&&(M0|=E),Wi===4&&sd(b,ur,El,!1)),jc(b))}function vR(b,C,E){if((Fr&6)!==0)throw Error(r(327));var M=!E&&(C&124)===0&&(C&b.expiredLanes)===0||He(b,C),L=M?bie(b,C):j4(b,C,!0),z=M;do{if(L===0){yp&&!M&&sd(b,C,0,!1);break}else{if(E=b.current.alternate,z&&!yie(E)){L=j4(b,C,!1),z=!1;continue}if(L===2){if(z=C,b.errorRecoveryDisabledLanes&z)var fe=0;else fe=b.pendingLanes&-536870913,fe=fe!==0?fe:fe&536870912?536870912:0;if(fe!==0){C=fe;e:{var xe=b;L=R1;var ke=xe.current.memoizedState.isDehydrated;if(ke&&(Cp(xe,fe).flags|=256),fe=j4(xe,fe,!1),fe!==2){if(N4&&!ke){xe.errorRecoveryDisabledLanes|=z,M0|=z,L=4;break e}z=ys,ys=L,z!==null&&(ys===null?ys=z:ys.push.apply(ys,z))}L=fe}if(z=!1,L!==2)continue}}if(L===1){Cp(b,0),sd(b,C,0,!0);break}e:{switch(M=b,z=L,z){case 0:case 1:throw Error(r(345));case 4:if((C&4194048)!==C)break;case 6:sd(M,C,El,!rd);break e;case 2:ys=null;break;case 3:case 5:break;default:throw Error(r(329))}if((C&62914560)===C&&(L=V4+300-Ee(),10<L)){if(sd(M,C,El,!rd),Ue(M,0,!0)!==0)break e;M.timeoutHandle=HR(yR.bind(null,M,E,ys,M5,k4,C,El,M0,xp,rd,z,2,-0,0),L);break e}yR(M,E,ys,M5,k4,C,El,M0,xp,rd,z,0,-0,0)}}break}while(!0);jc(b)}function yR(b,C,E,M,L,z,fe,xe,ke,Je,bt,_t,et,nt){if(b.timeoutHandle=-1,_t=C.subtreeFlags,(_t&8192||(_t&16785408)===16785408)&&(U1={stylesheets:null,count:0,unsuspend:Qie},fR(C),_t=tae(),_t!==null)){b.cancelPendingCommit=_t(ER.bind(null,b,C,z,E,M,L,fe,xe,ke,bt,1,et,nt)),sd(b,z,fe,!Je);return}ER(b,C,z,E,M,L,fe,xe,ke)}function yie(b){for(var C=b;;){var E=C.tag;if((E===0||E===11||E===15)&&C.flags&16384&&(E=C.updateQueue,E!==null&&(E=E.stores,E!==null)))for(var M=0;M<E.length;M++){var L=E[M],z=L.getSnapshot;L=L.value;try{if(!be(z(),L))return!1}catch{return!1}}if(E=C.child,C.subtreeFlags&16384&&E!==null)E.return=C,C=E;else{if(C===b)break;for(;C.sibling===null;){if(C.return===null||C.return===b)return!0;C=C.return}C.sibling.return=C.return,C=C.sibling}}return!0}function sd(b,C,E,M){C&=~L4,C&=~M0,b.suspendedLanes|=C,b.pingedLanes&=~C,M&&(b.warmLanes|=C),M=b.expirationTimes;for(var L=C;0<L;){var z=31-ht(L),fe=1<<z;M[z]=-1,L&=~fe}E!==0&&mi(b,E,C)}function I5(){return(Fr&6)===0?(A1(0),!1):!0}function $4(){if(Jn!==null){if(Ur===0)var b=Jn.return;else b=Jn,Wu=S0=null,i4(b),pp=null,S1=0,b=Jn;for(;b!==null;)JI(b.alternate,b),b=b.return;Jn=null}}function Cp(b,C){var E=b.timeoutHandle;E!==-1&&(b.timeoutHandle=-1,kie(E)),E=b.cancelPendingCommit,E!==null&&(b.cancelPendingCommit=null,E()),$4(),Zr=b,Jn=E=Gu(b.current,null),ur=C,Ur=0,Gs=null,rd=!1,yp=He(b,C),N4=!1,xp=El=L4=M0=id=Wi=0,ys=R1=null,k4=!1,(C&8)!==0&&(C|=C&32);var M=b.entangledLanes;if(M!==0)for(b=b.entanglements,M&=C;0<M;){var L=31-ht(M),z=1<<L;C|=b[L],M&=~z}return Qu=C,Zy(),E}function xR(b,C){Wn=null,V.H=v5,C===p1||C===s5?(C=kM(),Ur=3):C===AM?(C=kM(),Ur=4):Ur=C===VI?8:C!==null&&typeof C=="object"&&typeof C.then=="function"?6:1,Gs=C,Jn===null&&(Wi=1,C5(b,bl(C,b.current)))}function bR(){var b=V.H;return V.H=v5,b===null?v5:b}function wR(){var b=V.A;return V.A=mie,b}function G4(){Wi=4,rd||(ur&4194048)!==ur&&Tl.current!==null||(yp=!0),(id&134217727)===0&&(M0&134217727)===0||Zr===null||sd(Zr,ur,El,!1)}function j4(b,C,E){var M=Fr;Fr|=2;var L=bR(),z=wR();(Zr!==b||ur!==C)&&(M5=null,Cp(b,C)),C=!1;var fe=Wi;e:do try{if(Ur!==0&&Jn!==null){var xe=Jn,ke=Gs;switch(Ur){case 8:$4(),fe=6;break e;case 3:case 2:case 9:case 6:Tl.current===null&&(C=!0);var Je=Ur;if(Ur=0,Gs=null,Sp(b,xe,ke,Je),E&&yp){fe=0;break e}break;default:Je=Ur,Ur=0,Gs=null,Sp(b,xe,ke,Je)}}xie(),fe=Wi;break}catch(bt){xR(b,bt)}while(!0);return C&&b.shellSuspendCounter++,Wu=S0=null,Fr=M,V.H=L,V.A=z,Jn===null&&(Zr=null,ur=0,Zy()),fe}function xie(){for(;Jn!==null;)CR(Jn)}function bie(b,C){var E=Fr;Fr|=2;var M=bR(),L=wR();Zr!==b||ur!==C?(M5=null,O5=Ee()+500,Cp(b,C)):yp=He(b,C);e:do try{if(Ur!==0&&Jn!==null){C=Jn;var z=Gs;t:switch(Ur){case 1:Ur=0,Gs=null,Sp(b,C,z,1);break;case 2:case 9:if(NM(z)){Ur=0,Gs=null,SR(C);break}C=function(){Ur!==2&&Ur!==9||Zr!==b||(Ur=7),jc(b)},z.then(C,C);break e;case 3:Ur=7;break e;case 4:Ur=5;break e;case 7:NM(z)?(Ur=0,Gs=null,SR(C)):(Ur=0,Gs=null,Sp(b,C,z,7));break;case 5:var fe=null;switch(Jn.tag){case 26:fe=Jn.memoizedState;case 5:case 27:var xe=Jn;if(!fe||iP(fe)){Ur=0,Gs=null;var ke=xe.sibling;if(ke!==null)Jn=ke;else{var Je=xe.return;Je!==null?(Jn=Je,R5(Je)):Jn=null}break t}}Ur=0,Gs=null,Sp(b,C,z,5);break;case 6:Ur=0,Gs=null,Sp(b,C,z,6);break;case 8:$4(),Wi=6;break e;default:throw Error(r(462))}}wie();break}catch(bt){xR(b,bt)}while(!0);return Wu=S0=null,V.H=M,V.A=L,Fr=E,Jn!==null?0:(Zr=null,ur=0,Zy(),Wi)}function wie(){for(;Jn!==null&&!de();)CR(Jn)}function CR(b){var C=XI(b.alternate,b,Qu);b.memoizedProps=b.pendingProps,C===null?R5(b):Jn=C}function SR(b){var C=b,E=C.alternate;switch(C.tag){case 15:case 0:C=jI(E,C,C.pendingProps,C.type,void 0,ur);break;case 11:C=jI(E,C,C.pendingProps,C.type.render,C.ref,ur);break;case 5:i4(C);default:JI(E,C),C=Jn=TM(C,Qu),C=XI(E,C,Qu)}b.memoizedProps=b.pendingProps,C===null?R5(b):Jn=C}function Sp(b,C,E,M){Wu=S0=null,i4(C),pp=null,S1=0;var L=C.return;try{if(uie(b,L,C,E,ur)){Wi=1,C5(b,bl(E,b.current)),Jn=null;return}}catch(z){if(L!==null)throw Jn=L,z;Wi=1,C5(b,bl(E,b.current)),Jn=null;return}C.flags&32768?(Cr||M===1?b=!0:yp||(ur&536870912)!==0?b=!1:(rd=b=!0,(M===2||M===9||M===3||M===6)&&(M=Tl.current,M!==null&&M.tag===13&&(M.flags|=16384))),TR(C,b)):R5(C)}function R5(b){var C=b;do{if((C.flags&32768)!==0){TR(C,rd);return}b=C.return;var E=die(C.alternate,C,Qu);if(E!==null){Jn=E;return}if(C=C.sibling,C!==null){Jn=C;return}Jn=C=b}while(C!==null);Wi===0&&(Wi=5)}function TR(b,C){do{var E=hie(b.alternate,b);if(E!==null){E.flags&=32767,Jn=E;return}if(E=b.return,E!==null&&(E.flags|=32768,E.subtreeFlags=0,E.deletions=null),!C&&(b=b.sibling,b!==null)){Jn=b;return}Jn=b=E}while(b!==null);Wi=6,Jn=null}function ER(b,C,E,M,L,z,fe,xe,ke){b.cancelPendingCommit=null;do P5();while(so!==0);if((Fr&6)!==0)throw Error(r(327));if(C!==null){if(C===b.current)throw Error(r(177));if(z=C.lanes|C.childLanes,z|=AS,Pn(b,E,z,fe,xe,ke),b===Zr&&(Jn=Zr=null,ur=0),bp=C,od=b,wp=E,F4=z,U4=L,gR=M,(C.subtreeFlags&10256)!==0||(C.flags&10256)!==0?(b.callbackNode=null,b.callbackPriority=0,Eie(ie,function(){return IR(),null})):(b.callbackNode=null,b.callbackPriority=0),M=(C.flags&13878)!==0,(C.subtreeFlags&13878)!==0||M){M=V.T,V.T=null,L=$.p,$.p=2,fe=Fr,Fr|=4;try{pie(b,C,E)}finally{Fr=fe,$.p=L,V.T=M}}so=1,_R(),DR(),OR()}}function _R(){if(so===1){so=0;var b=od,C=bp,E=(C.flags&13878)!==0;if((C.subtreeFlags&13878)!==0||E){E=V.T,V.T=null;var M=$.p;$.p=2;var L=Fr;Fr|=4;try{lR(C,b);var z=tT,fe=qe(b.containerInfo),xe=z.focusedElem,ke=z.selectionRange;if(fe!==xe&&xe&&xe.ownerDocument&&Be(xe.ownerDocument.documentElement,xe)){if(ke!==null&&ft(xe)){var Je=ke.start,bt=ke.end;if(bt===void 0&&(bt=Je),"selectionStart"in xe)xe.selectionStart=Je,xe.selectionEnd=Math.min(bt,xe.value.length);else{var _t=xe.ownerDocument||document,et=_t&&_t.defaultView||window;if(et.getSelection){var nt=et.getSelection(),wn=xe.textContent.length,gn=Math.min(ke.start,wn),zr=ke.end===void 0?gn:Math.min(ke.end,wn);!nt.extend&&gn>zr&&(fe=zr,zr=gn,gn=fe);var ze=Le(xe,gn),je=Le(xe,zr);if(ze&&je&&(nt.rangeCount!==1||nt.anchorNode!==ze.node||nt.anchorOffset!==ze.offset||nt.focusNode!==je.node||nt.focusOffset!==je.offset)){var Ye=_t.createRange();Ye.setStart(ze.node,ze.offset),nt.removeAllRanges(),gn>zr?(nt.addRange(Ye),nt.extend(je.node,je.offset)):(Ye.setEnd(je.node,je.offset),nt.addRange(Ye))}}}}for(_t=[],nt=xe;nt=nt.parentNode;)nt.nodeType===1&&_t.push({element:nt,left:nt.scrollLeft,top:nt.scrollTop});for(typeof xe.focus=="function"&&xe.focus(),xe=0;xe<_t.length;xe++){var Tt=_t[xe];Tt.element.scrollLeft=Tt.left,Tt.element.scrollTop=Tt.top}}z5=!!eT,tT=eT=null}finally{Fr=L,$.p=M,V.T=E}}b.current=C,so=2}}function DR(){if(so===2){so=0;var b=od,C=bp,E=(C.flags&8772)!==0;if((C.subtreeFlags&8772)!==0||E){E=V.T,V.T=null;var M=$.p;$.p=2;var L=Fr;Fr|=4;try{iR(b,C.alternate,C)}finally{Fr=L,$.p=M,V.T=E}}so=3}}function OR(){if(so===4||so===3){so=0,he();var b=od,C=bp,E=wp,M=gR;(C.subtreeFlags&10256)!==0||(C.flags&10256)!==0?so=5:(so=0,bp=od=null,MR(b,b.pendingLanes));var L=b.pendingLanes;if(L===0&&(ad=null),Et(E),C=C.stateNode,ue&&typeof ue.onCommitFiberRoot=="function")try{ue.onCommitFiberRoot(Ve,C,void 0,(C.current.flags&128)===128)}catch{}if(M!==null){C=V.T,L=$.p,$.p=2,V.T=null;try{for(var z=b.onRecoverableError,fe=0;fe<M.length;fe++){var xe=M[fe];z(xe.value,{componentStack:xe.stack})}}finally{V.T=C,$.p=L}}(wp&3)!==0&&P5(),jc(b),L=b.pendingLanes,(E&4194090)!==0&&(L&42)!==0?b===B4?P1++:(P1=0,B4=b):P1=0,A1(0)}}function MR(b,C){(b.pooledCacheLanes&=C)===0&&(C=b.pooledCache,C!=null&&(b.pooledCache=null,d1(C)))}function P5(b){return _R(),DR(),OR(),IR()}function IR(){if(so!==5)return!1;var b=od,C=F4;F4=0;var E=Et(wp),M=V.T,L=$.p;try{$.p=32>E?32:E,V.T=null,E=U4,U4=null;var z=od,fe=wp;if(so=0,bp=od=null,wp=0,(Fr&6)!==0)throw Error(r(331));var xe=Fr;if(Fr|=4,hR(z.current),uR(z,z.current,fe,E),Fr=xe,A1(0,!1),ue&&typeof ue.onPostCommitFiberRoot=="function")try{ue.onPostCommitFiberRoot(Ve,z)}catch{}return!0}finally{$.p=L,V.T=M,MR(b,C)}}function RR(b,C,E){C=bl(E,C),C=y4(b.stateNode,C,2),b=Yf(b,C,2),b!==null&&(en(b,2),jc(b))}function Kr(b,C,E){if(b.tag===3)RR(b,b,E);else for(;C!==null;){if(C.tag===3){RR(C,b,E);break}else if(C.tag===1){var M=C.stateNode;if(typeof C.type.getDerivedStateFromError=="function"||typeof M.componentDidCatch=="function"&&(ad===null||!ad.has(M))){b=bl(E,b),E=LI(2),M=Yf(C,E,2),M!==null&&(kI(E,M,C,b),en(M,2),jc(M));break}}C=C.return}}function z4(b,C,E){var M=b.pingCache;if(M===null){M=b.pingCache=new vie;var L=new Set;M.set(C,L)}else L=M.get(C),L===void 0&&(L=new Set,M.set(C,L));L.has(E)||(N4=!0,L.add(E),b=Cie.bind(null,b,C,E),C.then(b,b))}function Cie(b,C,E){var M=b.pingCache;M!==null&&M.delete(C),b.pingedLanes|=b.suspendedLanes&E,b.warmLanes&=~E,Zr===b&&(ur&E)===E&&(Wi===4||Wi===3&&(ur&62914560)===ur&&300>Ee()-V4?(Fr&2)===0&&Cp(b,0):L4|=E,xp===ur&&(xp=0)),jc(b)}function PR(b,C){C===0&&(C=bn()),b=ip(b,C),b!==null&&(en(b,C),jc(b))}function Sie(b){var C=b.memoizedState,E=0;C!==null&&(E=C.retryLane),PR(b,E)}function Tie(b,C){var E=0;switch(b.tag){case 13:var M=b.stateNode,L=b.memoizedState;L!==null&&(E=L.retryLane);break;case 19:M=b.stateNode;break;case 22:M=b.stateNode._retryCache;break;default:throw Error(r(314))}M!==null&&M.delete(C),PR(b,E)}function Eie(b,C){return X(b,C)}var A5=null,Tp=null,W4=!1,N5=!1,H4=!1,I0=0;function jc(b){b!==Tp&&b.next===null&&(Tp===null?A5=Tp=b:Tp=Tp.next=b),N5=!0,W4||(W4=!0,Die())}function A1(b,C){if(!H4&&N5){H4=!0;do for(var E=!1,M=A5;M!==null;){if(b!==0){var L=M.pendingLanes;if(L===0)var z=0;else{var fe=M.suspendedLanes,xe=M.pingedLanes;z=(1<<31-ht(42|b)+1)-1,z&=L&~(fe&~xe),z=z&201326741?z&201326741|1:z?z|2:0}z!==0&&(E=!0,kR(M,z))}else z=ur,z=Ue(M,M===Zr?z:0,M.cancelPendingCommit!==null||M.timeoutHandle!==-1),(z&3)===0||He(M,z)||(E=!0,kR(M,z));M=M.next}while(E);H4=!1}}function _ie(){AR()}function AR(){N5=W4=!1;var b=0;I0!==0&&(Lie()&&(b=I0),I0=0);for(var C=Ee(),E=null,M=A5;M!==null;){var L=M.next,z=NR(M,C);z===0?(M.next=null,E===null?A5=L:E.next=L,L===null&&(Tp=E)):(E=M,(b!==0||(z&3)!==0)&&(N5=!0)),M=L}A1(b)}function NR(b,C){for(var E=b.suspendedLanes,M=b.pingedLanes,L=b.expirationTimes,z=b.pendingLanes&-62914561;0<z;){var fe=31-ht(z),xe=1<<fe,ke=L[fe];ke===-1?((xe&E)===0||(xe&M)!==0)&&(L[fe]=Ct(xe,C)):ke<=C&&(b.expiredLanes|=xe),z&=~xe}if(C=Zr,E=ur,E=Ue(b,b===C?E:0,b.cancelPendingCommit!==null||b.timeoutHandle!==-1),M=b.callbackNode,E===0||b===C&&(Ur===2||Ur===9)||b.cancelPendingCommit!==null)return M!==null&&M!==null&&re(M),b.callbackNode=null,b.callbackPriority=0;if((E&3)===0||He(b,E)){if(C=E&-E,C===b.callbackPriority)return C;switch(M!==null&&re(M),Et(E)){case 2:case 8:E=Ne;break;case 32:E=ie;break;case 268435456:E=Te;break;default:E=ie}return M=LR.bind(null,b),E=X(E,M),b.callbackPriority=C,b.callbackNode=E,C}return M!==null&&M!==null&&re(M),b.callbackPriority=2,b.callbackNode=null,2}function LR(b,C){if(so!==0&&so!==5)return b.callbackNode=null,b.callbackPriority=0,null;var E=b.callbackNode;if(P5()&&b.callbackNode!==E)return null;var M=ur;return M=Ue(b,b===Zr?M:0,b.cancelPendingCommit!==null||b.timeoutHandle!==-1),M===0?null:(vR(b,M,C),NR(b,Ee()),b.callbackNode!=null&&b.callbackNode===E?LR.bind(null,b):null)}function kR(b,C){if(P5())return null;vR(b,C,!0)}function Die(){Vie(function(){(Fr&6)!==0?X(Pe,_ie):AR()})}function K4(){return I0===0&&(I0=$t()),I0}function VR(b){return b==null||typeof b=="symbol"||typeof b=="boolean"?null:typeof b=="function"?b:cs(""+b)}function FR(b,C){var E=C.ownerDocument.createElement("input");return E.name=C.name,E.value=C.value,b.id&&E.setAttribute("form",b.id),C.parentNode.insertBefore(E,C),b=new FormData(b),E.parentNode.removeChild(E),b}function Oie(b,C,E,M,L){if(C==="submit"&&E&&E.stateNode===L){var z=VR((L[qt]||null).action),fe=M.submitter;fe&&(C=(C=fe[qt]||null)?VR(C.formAction):fe.getAttribute("formAction"),C!==null&&(z=C,fe=null));var xe=new hl("action","action",null,M,L);b.push({event:xe,listeners:[{instance:null,listener:function(){if(M.defaultPrevented){if(I0!==0){var ke=fe?FR(L,fe):new FormData(L);h4(E,{pending:!0,data:ke,method:L.method,action:z},null,ke)}}else typeof z=="function"&&(xe.preventDefault(),ke=fe?FR(L,fe):new FormData(L),h4(E,{pending:!0,data:ke,method:L.method,action:z},z,ke))},currentTarget:L}]})}}for(var q4=0;q4<PS.length;q4++){var X4=PS[q4],Mie=X4.toLowerCase(),Iie=X4[0].toUpperCase()+X4.slice(1);nc(Mie,"on"+Iie)}nc(Hf,"onAnimationEnd"),nc(o1,"onAnimationIteration"),nc(s1,"onAnimationStart"),nc("dblclick","onDoubleClick"),nc("focusin","onFocus"),nc("focusout","onBlur"),nc(Kre,"onTransitionRun"),nc(qre,"onTransitionStart"),nc(Xre,"onTransitionCancel"),nc(bM,"onTransitionEnd"),Vi("onMouseEnter",["mouseout","mouseover"]),Vi("onMouseLeave",["mouseout","mouseover"]),Vi("onPointerEnter",["pointerout","pointerover"]),Vi("onPointerLeave",["pointerout","pointerover"]),li("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),li("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),li("onBeforeInput",["compositionend","keypress","textInput","paste"]),li("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),li("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),li("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var N1="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Rie=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(N1));function UR(b,C){C=(C&4)!==0;for(var E=0;E<b.length;E++){var M=b[E],L=M.event;M=M.listeners;e:{var z=void 0;if(C)for(var fe=M.length-1;0<=fe;fe--){var xe=M[fe],ke=xe.instance,Je=xe.currentTarget;if(xe=xe.listener,ke!==z&&L.isPropagationStopped())break e;z=xe,L.currentTarget=Je;try{z(L)}catch(bt){w5(bt)}L.currentTarget=null,z=ke}else for(fe=0;fe<M.length;fe++){if(xe=M[fe],ke=xe.instance,Je=xe.currentTarget,xe=xe.listener,ke!==z&&L.isPropagationStopped())break e;z=xe,L.currentTarget=Je;try{z(L)}catch(bt){w5(bt)}L.currentTarget=null,z=ke}}}}function Zn(b,C){var E=C[Zt];E===void 0&&(E=C[Zt]=new Set);var M=b+"__bubble";E.has(M)||(BR(C,b,2,!1),E.add(M))}function Y4(b,C,E){var M=0;C&&(M|=4),BR(E,b,M,C)}var L5="_reactListening"+Math.random().toString(36).slice(2);function J4(b){if(!b[L5]){b[L5]=!0,si.forEach(function(E){E!=="selectionchange"&&(Rie.has(E)||Y4(E,!1,b),Y4(E,!0,b))});var C=b.nodeType===9?b:b.ownerDocument;C===null||C[L5]||(C[L5]=!0,Y4("selectionchange",!1,C))}}function BR(b,C,E,M){switch(uP(C)){case 2:var L=iae;break;case 8:L=aae;break;default:L=fT}E=L.bind(null,C,E,b),L=void 0,!ci||C!=="touchstart"&&C!=="touchmove"&&C!=="wheel"||(L=!0),M?L!==void 0?b.addEventListener(C,E,{capture:!0,passive:L}):b.addEventListener(C,E,!0):L!==void 0?b.addEventListener(C,E,{passive:L}):b.addEventListener(C,E,!1)}function Z4(b,C,E,M,L){var z=M;if((C&1)===0&&(C&2)===0&&M!==null)e:for(;;){if(M===null)return;var fe=M.tag;if(fe===3||fe===4){var xe=M.stateNode.containerInfo;if(xe===L)break;if(fe===4)for(fe=M.return;fe!==null;){var ke=fe.tag;if((ke===3||ke===4)&&fe.stateNode.containerInfo===L)return;fe=fe.return}for(;xe!==null;){if(fe=ki(xe),fe===null)return;if(ke=fe.tag,ke===5||ke===6||ke===26||ke===27){M=z=fe;continue e}xe=xe.parentNode}}M=M.return}Dr(function(){var Je=z,bt=ta(E),_t=[];e:{var et=wM.get(b);if(et!==void 0){var nt=hl,wn=b;switch(b){case"keypress":if(ds(E)===0)break e;case"keydown":case"keyup":nt=Lc;break;case"focusin":wn="focus",nt=Yl;break;case"focusout":wn="blur",nt=Yl;break;case"beforeblur":case"afterblur":nt=Yl;break;case"click":if(E.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":nt=Mc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":nt=Au;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":nt=$u;break;case Hf:case o1:case s1:nt=Lu;break;case bM:nt=Ql;break;case"scroll":case"scrollend":nt=Ls;break;case"wheel":nt=ps;break;case"copy":case"cut":case"paste":nt=Pc;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":nt=kc;break;case"toggle":case"beforetoggle":nt=Vc}var gn=(C&4)!==0,zr=!gn&&(b==="scroll"||b==="scrollend"),ze=gn?et!==null?et+"Capture":null:et;gn=[];for(var je=Je,Ye;je!==null;){var Tt=je;if(Ye=Tt.stateNode,Tt=Tt.tag,Tt!==5&&Tt!==26&&Tt!==27||Ye===null||ze===null||(Tt=ro(je,ze),Tt!=null&&gn.push(L1(je,Tt,Ye))),zr)break;je=je.return}0<gn.length&&(et=new nt(et,wn,null,E,bt),_t.push({event:et,listeners:gn}))}}if((C&7)===0){e:{if(et=b==="mouseover"||b==="pointerover",nt=b==="mouseout"||b==="pointerout",et&&E!==So&&(wn=E.relatedTarget||E.fromElement)&&(ki(wn)||wn[kt]))break e;if((nt||et)&&(et=bt.window===bt?bt:(et=bt.ownerDocument)?et.defaultView||et.parentWindow:window,nt?(wn=E.relatedTarget||E.toElement,nt=Je,wn=wn?ki(wn):null,wn!==null&&(zr=a(wn),gn=wn.tag,wn!==zr||gn!==5&&gn!==27&&gn!==6)&&(wn=null)):(nt=null,wn=Je),nt!==wn)){if(gn=Mc,Tt="onMouseLeave",ze="onMouseEnter",je="mouse",(b==="pointerout"||b==="pointerover")&&(gn=kc,Tt="onPointerLeave",ze="onPointerEnter",je="pointer"),zr=nt==null?et:Yn(nt),Ye=wn==null?et:Yn(wn),et=new gn(Tt,je+"leave",nt,E,bt),et.target=zr,et.relatedTarget=Ye,Tt=null,ki(bt)===Je&&(gn=new gn(ze,je+"enter",wn,E,bt),gn.target=Ye,gn.relatedTarget=zr,Tt=gn),zr=Tt,nt&&wn)t:{for(gn=nt,ze=wn,je=0,Ye=gn;Ye;Ye=Ep(Ye))je++;for(Ye=0,Tt=ze;Tt;Tt=Ep(Tt))Ye++;for(;0<je-Ye;)gn=Ep(gn),je--;for(;0<Ye-je;)ze=Ep(ze),Ye--;for(;je--;){if(gn===ze||ze!==null&&gn===ze.alternate)break t;gn=Ep(gn),ze=Ep(ze)}gn=null}else gn=null;nt!==null&&$R(_t,et,nt,gn,!1),wn!==null&&zr!==null&&$R(_t,zr,wn,gn,!0)}}e:{if(et=Je?Yn(Je):window,nt=et.nodeName&&et.nodeName.toLowerCase(),nt==="select"||nt==="input"&&et.type==="file")var Xt=se;else if(xt(et))if(_e)Xt=K;else{Xt=te;var Xn=Z}else nt=et.nodeName,!nt||nt.toLowerCase()!=="input"||et.type!=="checkbox"&&et.type!=="radio"?Je&&dl(Je.elementType)&&(Xt=se):Xt=W;if(Xt&&(Xt=Xt(b,Je))){Vt(_t,Xt,E,bt);break e}Xn&&Xn(b,et,Je),b==="focusout"&&Je&&et.type==="number"&&Je.memoizedProps.value!=null&&Da(et,"number",et.value)}switch(Xn=Je?Yn(Je):window,b){case"focusin":(xt(Xn)||Xn.contentEditable==="true")&&(Wt=Xn,Gt=Je,dn=null);break;case"focusout":dn=Gt=Wt=null;break;case"mousedown":pn=!0;break;case"contextmenu":case"mouseup":case"dragend":pn=!1,er(_t,E,bt);break;case"selectionchange":if(At)break;case"keydown":case"keyup":er(_t,E,bt)}var ln;if(Fs)e:{switch(b){case"compositionstart":var vn="onCompositionStart";break e;case"compositionend":vn="onCompositionEnd";break e;case"compositionupdate":vn="onCompositionUpdate";break e}vn=void 0}else tt?Ie(b,E)&&(vn="onCompositionEnd"):b==="keydown"&&E.keyCode===229&&(vn="onCompositionStart");vn&&(ec&&E.locale!=="ko"&&(tt||vn!=="onCompositionStart"?vn==="onCompositionEnd"&&tt&&(ln=io()):(ui=bt,Xl="value"in ui?ui.value:ui.textContent,tt=!0)),Xn=k5(Je,vn),0<Xn.length&&(vn=new ml(vn,b,null,E,bt),_t.push({event:vn,listeners:Xn}),ln?vn.data=ln:(ln=We(E),ln!==null&&(vn.data=ln)))),(ln=yl?pt(b,E):gt(b,E))&&(vn=k5(Je,"onBeforeInput"),0<vn.length&&(Xn=new ml("onBeforeInput","beforeinput",null,E,bt),_t.push({event:Xn,listeners:vn}),Xn.data=ln)),Oie(_t,b,Je,E,bt)}UR(_t,C)})}function L1(b,C,E){return{instance:b,listener:C,currentTarget:E}}function k5(b,C){for(var E=C+"Capture",M=[];b!==null;){var L=b,z=L.stateNode;if(L=L.tag,L!==5&&L!==26&&L!==27||z===null||(L=ro(b,E),L!=null&&M.unshift(L1(b,L,z)),L=ro(b,C),L!=null&&M.push(L1(b,L,z))),b.tag===3)return M;b=b.return}return[]}function Ep(b){if(b===null)return null;do b=b.return;while(b&&b.tag!==5&&b.tag!==27);return b||null}function $R(b,C,E,M,L){for(var z=C._reactName,fe=[];E!==null&&E!==M;){var xe=E,ke=xe.alternate,Je=xe.stateNode;if(xe=xe.tag,ke!==null&&ke===M)break;xe!==5&&xe!==26&&xe!==27||Je===null||(ke=Je,L?(Je=ro(E,z),Je!=null&&fe.unshift(L1(E,Je,ke))):L||(Je=ro(E,z),Je!=null&&fe.push(L1(E,Je,ke)))),E=E.return}fe.length!==0&&b.push({event:C,listeners:fe})}var Pie=/\r\n?/g,Aie=/\u0000|\uFFFD/g;function GR(b){return(typeof b=="string"?b:""+b).replace(Pie,`
`).replace(Aie,"")}function jR(b,C){return C=GR(C),GR(b)===C}function V5(){}function jr(b,C,E,M,L,z){switch(E){case"children":typeof M=="string"?C==="body"||C==="textarea"&&M===""||jo(b,M):(typeof M=="number"||typeof M=="bigint")&&C!=="body"&&jo(b,""+M);break;case"className":Bo(b,"class",M);break;case"tabIndex":Bo(b,"tabindex",M);break;case"dir":case"role":case"viewBox":case"width":case"height":Bo(b,E,M);break;case"style":Jr(b,M,z);break;case"data":if(C!=="object"){Bo(b,"data",M);break}case"src":case"href":if(M===""&&(C!=="a"||E!=="href")){b.removeAttribute(E);break}if(M==null||typeof M=="function"||typeof M=="symbol"||typeof M=="boolean"){b.removeAttribute(E);break}M=cs(""+M),b.setAttribute(E,M);break;case"action":case"formAction":if(typeof M=="function"){b.setAttribute(E,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof z=="function"&&(E==="formAction"?(C!=="input"&&jr(b,C,"name",L.name,L,null),jr(b,C,"formEncType",L.formEncType,L,null),jr(b,C,"formMethod",L.formMethod,L,null),jr(b,C,"formTarget",L.formTarget,L,null)):(jr(b,C,"encType",L.encType,L,null),jr(b,C,"method",L.method,L,null),jr(b,C,"target",L.target,L,null)));if(M==null||typeof M=="symbol"||typeof M=="boolean"){b.removeAttribute(E);break}M=cs(""+M),b.setAttribute(E,M);break;case"onClick":M!=null&&(b.onclick=V5);break;case"onScroll":M!=null&&Zn("scroll",b);break;case"onScrollEnd":M!=null&&Zn("scrollend",b);break;case"dangerouslySetInnerHTML":if(M!=null){if(typeof M!="object"||!("__html"in M))throw Error(r(61));if(E=M.__html,E!=null){if(L.children!=null)throw Error(r(60));b.innerHTML=E}}break;case"multiple":b.multiple=M&&typeof M!="function"&&typeof M!="symbol";break;case"muted":b.muted=M&&typeof M!="function"&&typeof M!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(M==null||typeof M=="function"||typeof M=="boolean"||typeof M=="symbol"){b.removeAttribute("xlink:href");break}E=cs(""+M),b.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",E);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":M!=null&&typeof M!="function"&&typeof M!="symbol"?b.setAttribute(E,""+M):b.removeAttribute(E);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":M&&typeof M!="function"&&typeof M!="symbol"?b.setAttribute(E,""):b.removeAttribute(E);break;case"capture":case"download":M===!0?b.setAttribute(E,""):M!==!1&&M!=null&&typeof M!="function"&&typeof M!="symbol"?b.setAttribute(E,M):b.removeAttribute(E);break;case"cols":case"rows":case"size":case"span":M!=null&&typeof M!="function"&&typeof M!="symbol"&&!isNaN(M)&&1<=M?b.setAttribute(E,M):b.removeAttribute(E);break;case"rowSpan":case"start":M==null||typeof M=="function"||typeof M=="symbol"||isNaN(M)?b.removeAttribute(E):b.setAttribute(E,M);break;case"popover":Zn("beforetoggle",b),Zn("toggle",b),Ui(b,"popover",M);break;case"xlinkActuate":Pt(b,"http://www.w3.org/1999/xlink","xlink:actuate",M);break;case"xlinkArcrole":Pt(b,"http://www.w3.org/1999/xlink","xlink:arcrole",M);break;case"xlinkRole":Pt(b,"http://www.w3.org/1999/xlink","xlink:role",M);break;case"xlinkShow":Pt(b,"http://www.w3.org/1999/xlink","xlink:show",M);break;case"xlinkTitle":Pt(b,"http://www.w3.org/1999/xlink","xlink:title",M);break;case"xlinkType":Pt(b,"http://www.w3.org/1999/xlink","xlink:type",M);break;case"xmlBase":Pt(b,"http://www.w3.org/XML/1998/namespace","xml:base",M);break;case"xmlLang":Pt(b,"http://www.w3.org/XML/1998/namespace","xml:lang",M);break;case"xmlSpace":Pt(b,"http://www.w3.org/XML/1998/namespace","xml:space",M);break;case"is":Ui(b,"is",M);break;case"innerText":case"textContent":break;default:(!(2<E.length)||E[0]!=="o"&&E[0]!=="O"||E[1]!=="n"&&E[1]!=="N")&&(E=Ma.get(E)||E,Ui(b,E,M))}}function Q4(b,C,E,M,L,z){switch(E){case"style":Jr(b,M,z);break;case"dangerouslySetInnerHTML":if(M!=null){if(typeof M!="object"||!("__html"in M))throw Error(r(61));if(E=M.__html,E!=null){if(L.children!=null)throw Error(r(60));b.innerHTML=E}}break;case"children":typeof M=="string"?jo(b,M):(typeof M=="number"||typeof M=="bigint")&&jo(b,""+M);break;case"onScroll":M!=null&&Zn("scroll",b);break;case"onScrollEnd":M!=null&&Zn("scrollend",b);break;case"onClick":M!=null&&(b.onclick=V5);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!os.hasOwnProperty(E))e:{if(E[0]==="o"&&E[1]==="n"&&(L=E.endsWith("Capture"),C=E.slice(2,L?E.length-7:void 0),z=b[qt]||null,z=z!=null?z[E]:null,typeof z=="function"&&b.removeEventListener(C,z,L),typeof M=="function")){typeof z!="function"&&z!==null&&(E in b?b[E]=null:b.hasAttribute(E)&&b.removeAttribute(E)),b.addEventListener(C,M,L);break e}E in b?b[E]=M:M===!0?b.setAttribute(E,""):Ui(b,E,M)}}}function lo(b,C,E){switch(C){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Zn("error",b),Zn("load",b);var M=!1,L=!1,z;for(z in E)if(E.hasOwnProperty(z)){var fe=E[z];if(fe!=null)switch(z){case"src":M=!0;break;case"srcSet":L=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,C));default:jr(b,C,z,fe,E,null)}}L&&jr(b,C,"srcSet",E.srcSet,E,null),M&&jr(b,C,"src",E.src,E,null);return;case"input":Zn("invalid",b);var xe=z=fe=L=null,ke=null,Je=null;for(M in E)if(E.hasOwnProperty(M)){var bt=E[M];if(bt!=null)switch(M){case"name":L=bt;break;case"type":fe=bt;break;case"checked":ke=bt;break;case"defaultChecked":Je=bt;break;case"value":z=bt;break;case"defaultValue":xe=bt;break;case"children":case"dangerouslySetInnerHTML":if(bt!=null)throw Error(r(137,C));break;default:jr(b,C,M,bt,E,null)}}Oc(b,z,xe,ke,Je,fe,L,!1),Go(b);return;case"select":Zn("invalid",b),M=fe=z=null;for(L in E)if(E.hasOwnProperty(L)&&(xe=E[L],xe!=null))switch(L){case"value":z=xe;break;case"defaultValue":fe=xe;break;case"multiple":M=xe;default:jr(b,C,L,xe,E,null)}C=z,E=fe,b.multiple=!!M,C!=null?$i(b,!!M,C,!1):E!=null&&$i(b,!!M,E,!0);return;case"textarea":Zn("invalid",b),z=L=M=null;for(fe in E)if(E.hasOwnProperty(fe)&&(xe=E[fe],xe!=null))switch(fe){case"value":M=xe;break;case"defaultValue":L=xe;break;case"children":z=xe;break;case"dangerouslySetInnerHTML":if(xe!=null)throw Error(r(91));break;default:jr(b,C,fe,xe,E,null)}Gi(b,M,L,z),Go(b);return;case"option":for(ke in E)if(E.hasOwnProperty(ke)&&(M=E[ke],M!=null))switch(ke){case"selected":b.selected=M&&typeof M!="function"&&typeof M!="symbol";break;default:jr(b,C,ke,M,E,null)}return;case"dialog":Zn("beforetoggle",b),Zn("toggle",b),Zn("cancel",b),Zn("close",b);break;case"iframe":case"object":Zn("load",b);break;case"video":case"audio":for(M=0;M<N1.length;M++)Zn(N1[M],b);break;case"image":Zn("error",b),Zn("load",b);break;case"details":Zn("toggle",b);break;case"embed":case"source":case"link":Zn("error",b),Zn("load",b);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Je in E)if(E.hasOwnProperty(Je)&&(M=E[Je],M!=null))switch(Je){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,C));default:jr(b,C,Je,M,E,null)}return;default:if(dl(C)){for(bt in E)E.hasOwnProperty(bt)&&(M=E[bt],M!==void 0&&Q4(b,C,bt,M,E,void 0));return}}for(xe in E)E.hasOwnProperty(xe)&&(M=E[xe],M!=null&&jr(b,C,xe,M,E,null))}function Nie(b,C,E,M){switch(C){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var L=null,z=null,fe=null,xe=null,ke=null,Je=null,bt=null;for(nt in E){var _t=E[nt];if(E.hasOwnProperty(nt)&&_t!=null)switch(nt){case"checked":break;case"value":break;case"defaultValue":ke=_t;default:M.hasOwnProperty(nt)||jr(b,C,nt,null,M,_t)}}for(var et in M){var nt=M[et];if(_t=E[et],M.hasOwnProperty(et)&&(nt!=null||_t!=null))switch(et){case"type":z=nt;break;case"name":L=nt;break;case"checked":Je=nt;break;case"defaultChecked":bt=nt;break;case"value":fe=nt;break;case"defaultValue":xe=nt;break;case"children":case"dangerouslySetInnerHTML":if(nt!=null)throw Error(r(137,C));break;default:nt!==_t&&jr(b,C,et,nt,M,_t)}}Kl(b,fe,xe,ke,Je,bt,z,L);return;case"select":nt=fe=xe=et=null;for(z in E)if(ke=E[z],E.hasOwnProperty(z)&&ke!=null)switch(z){case"value":break;case"multiple":nt=ke;default:M.hasOwnProperty(z)||jr(b,C,z,null,M,ke)}for(L in M)if(z=M[L],ke=E[L],M.hasOwnProperty(L)&&(z!=null||ke!=null))switch(L){case"value":et=z;break;case"defaultValue":xe=z;break;case"multiple":fe=z;default:z!==ke&&jr(b,C,L,z,M,ke)}C=xe,E=fe,M=nt,et!=null?$i(b,!!E,et,!1):!!M!=!!E&&(C!=null?$i(b,!!E,C,!0):$i(b,!!E,E?[]:"",!1));return;case"textarea":nt=et=null;for(xe in E)if(L=E[xe],E.hasOwnProperty(xe)&&L!=null&&!M.hasOwnProperty(xe))switch(xe){case"value":break;case"children":break;default:jr(b,C,xe,null,M,L)}for(fe in M)if(L=M[fe],z=E[fe],M.hasOwnProperty(fe)&&(L!=null||z!=null))switch(fe){case"value":et=L;break;case"defaultValue":nt=L;break;case"children":break;case"dangerouslySetInnerHTML":if(L!=null)throw Error(r(91));break;default:L!==z&&jr(b,C,fe,L,M,z)}Oa(b,et,nt);return;case"option":for(var wn in E)if(et=E[wn],E.hasOwnProperty(wn)&&et!=null&&!M.hasOwnProperty(wn))switch(wn){case"selected":b.selected=!1;break;default:jr(b,C,wn,null,M,et)}for(ke in M)if(et=M[ke],nt=E[ke],M.hasOwnProperty(ke)&&et!==nt&&(et!=null||nt!=null))switch(ke){case"selected":b.selected=et&&typeof et!="function"&&typeof et!="symbol";break;default:jr(b,C,ke,et,M,nt)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var gn in E)et=E[gn],E.hasOwnProperty(gn)&&et!=null&&!M.hasOwnProperty(gn)&&jr(b,C,gn,null,M,et);for(Je in M)if(et=M[Je],nt=E[Je],M.hasOwnProperty(Je)&&et!==nt&&(et!=null||nt!=null))switch(Je){case"children":case"dangerouslySetInnerHTML":if(et!=null)throw Error(r(137,C));break;default:jr(b,C,Je,et,M,nt)}return;default:if(dl(C)){for(var zr in E)et=E[zr],E.hasOwnProperty(zr)&&et!==void 0&&!M.hasOwnProperty(zr)&&Q4(b,C,zr,void 0,M,et);for(bt in M)et=M[bt],nt=E[bt],!M.hasOwnProperty(bt)||et===nt||et===void 0&&nt===void 0||Q4(b,C,bt,et,M,nt);return}}for(var ze in E)et=E[ze],E.hasOwnProperty(ze)&&et!=null&&!M.hasOwnProperty(ze)&&jr(b,C,ze,null,M,et);for(_t in M)et=M[_t],nt=E[_t],!M.hasOwnProperty(_t)||et===nt||et==null&&nt==null||jr(b,C,_t,et,M,nt)}var eT=null,tT=null;function F5(b){return b.nodeType===9?b:b.ownerDocument}function zR(b){switch(b){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function WR(b,C){if(b===0)switch(C){case"svg":return 1;case"math":return 2;default:return 0}return b===1&&C==="foreignObject"?0:b}function nT(b,C){return b==="textarea"||b==="noscript"||typeof C.children=="string"||typeof C.children=="number"||typeof C.children=="bigint"||typeof C.dangerouslySetInnerHTML=="object"&&C.dangerouslySetInnerHTML!==null&&C.dangerouslySetInnerHTML.__html!=null}var rT=null;function Lie(){var b=window.event;return b&&b.type==="popstate"?b===rT?!1:(rT=b,!0):(rT=null,!1)}var HR=typeof setTimeout=="function"?setTimeout:void 0,kie=typeof clearTimeout=="function"?clearTimeout:void 0,KR=typeof Promise=="function"?Promise:void 0,Vie=typeof queueMicrotask=="function"?queueMicrotask:typeof KR<"u"?function(b){return KR.resolve(null).then(b).catch(Fie)}:HR;function Fie(b){setTimeout(function(){throw b})}function ld(b){return b==="head"}function qR(b,C){var E=C,M=0,L=0;do{var z=E.nextSibling;if(b.removeChild(E),z&&z.nodeType===8)if(E=z.data,E==="/$"){if(0<M&&8>M){E=M;var fe=b.ownerDocument;if(E&1&&k1(fe.documentElement),E&2&&k1(fe.body),E&4)for(E=fe.head,k1(E),fe=E.firstChild;fe;){var xe=fe.nextSibling,ke=fe.nodeName;fe[Li]||ke==="SCRIPT"||ke==="STYLE"||ke==="LINK"&&fe.rel.toLowerCase()==="stylesheet"||E.removeChild(fe),fe=xe}}if(L===0){b.removeChild(z),z1(C);return}L--}else E==="$"||E==="$?"||E==="$!"?L++:M=E.charCodeAt(0)-48;else M=0;E=z}while(E);z1(C)}function iT(b){var C=b.firstChild;for(C&&C.nodeType===10&&(C=C.nextSibling);C;){var E=C;switch(C=C.nextSibling,E.nodeName){case"HTML":case"HEAD":case"BODY":iT(E),vi(E);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(E.rel.toLowerCase()==="stylesheet")continue}b.removeChild(E)}}function Uie(b,C,E,M){for(;b.nodeType===1;){var L=E;if(b.nodeName.toLowerCase()!==C.toLowerCase()){if(!M&&(b.nodeName!=="INPUT"||b.type!=="hidden"))break}else if(M){if(!b[Li])switch(C){case"meta":if(!b.hasAttribute("itemprop"))break;return b;case"link":if(z=b.getAttribute("rel"),z==="stylesheet"&&b.hasAttribute("data-precedence"))break;if(z!==L.rel||b.getAttribute("href")!==(L.href==null||L.href===""?null:L.href)||b.getAttribute("crossorigin")!==(L.crossOrigin==null?null:L.crossOrigin)||b.getAttribute("title")!==(L.title==null?null:L.title))break;return b;case"style":if(b.hasAttribute("data-precedence"))break;return b;case"script":if(z=b.getAttribute("src"),(z!==(L.src==null?null:L.src)||b.getAttribute("type")!==(L.type==null?null:L.type)||b.getAttribute("crossorigin")!==(L.crossOrigin==null?null:L.crossOrigin))&&z&&b.hasAttribute("async")&&!b.hasAttribute("itemprop"))break;return b;default:return b}}else if(C==="input"&&b.type==="hidden"){var z=L.name==null?null:""+L.name;if(L.type==="hidden"&&b.getAttribute("name")===z)return b}else return b;if(b=ic(b.nextSibling),b===null)break}return null}function Bie(b,C,E){if(C==="")return null;for(;b.nodeType!==3;)if((b.nodeType!==1||b.nodeName!=="INPUT"||b.type!=="hidden")&&!E||(b=ic(b.nextSibling),b===null))return null;return b}function aT(b){return b.data==="$!"||b.data==="$?"&&b.ownerDocument.readyState==="complete"}function $ie(b,C){var E=b.ownerDocument;if(b.data!=="$?"||E.readyState==="complete")C();else{var M=function(){C(),E.removeEventListener("DOMContentLoaded",M)};E.addEventListener("DOMContentLoaded",M),b._reactRetry=M}}function ic(b){for(;b!=null;b=b.nextSibling){var C=b.nodeType;if(C===1||C===3)break;if(C===8){if(C=b.data,C==="$"||C==="$!"||C==="$?"||C==="F!"||C==="F")break;if(C==="/$")return null}}return b}var oT=null;function XR(b){b=b.previousSibling;for(var C=0;b;){if(b.nodeType===8){var E=b.data;if(E==="$"||E==="$!"||E==="$?"){if(C===0)return b;C--}else E==="/$"&&C++}b=b.previousSibling}return null}function YR(b,C,E){switch(C=F5(E),b){case"html":if(b=C.documentElement,!b)throw Error(r(452));return b;case"head":if(b=C.head,!b)throw Error(r(453));return b;case"body":if(b=C.body,!b)throw Error(r(454));return b;default:throw Error(r(451))}}function k1(b){for(var C=b.attributes;C.length;)b.removeAttributeNode(C[0]);vi(b)}var _l=new Map,JR=new Set;function U5(b){return typeof b.getRootNode=="function"?b.getRootNode():b.nodeType===9?b:b.ownerDocument}var ef=$.d;$.d={f:Gie,r:jie,D:zie,C:Wie,L:Hie,m:Kie,X:Xie,S:qie,M:Yie};function Gie(){var b=ef.f(),C=I5();return b||C}function jie(b){var C=nn(b);C!==null&&C.tag===5&&C.type==="form"?vI(C):ef.r(b)}var _p=typeof document>"u"?null:document;function ZR(b,C,E){var M=_p;if(M&&typeof C=="string"&&C){var L=pa(C);L='link[rel="'+b+'"][href="'+L+'"]',typeof E=="string"&&(L+='[crossorigin="'+E+'"]'),JR.has(L)||(JR.add(L),b={rel:b,crossOrigin:E,href:C},M.querySelector(L)===null&&(C=M.createElement("link"),lo(C,"link",b),rn(C),M.head.appendChild(C)))}}function zie(b){ef.D(b),ZR("dns-prefetch",b,null)}function Wie(b,C){ef.C(b,C),ZR("preconnect",b,C)}function Hie(b,C,E){ef.L(b,C,E);var M=_p;if(M&&b&&C){var L='link[rel="preload"][as="'+pa(C)+'"]';C==="image"&&E&&E.imageSrcSet?(L+='[imagesrcset="'+pa(E.imageSrcSet)+'"]',typeof E.imageSizes=="string"&&(L+='[imagesizes="'+pa(E.imageSizes)+'"]')):L+='[href="'+pa(b)+'"]';var z=L;switch(C){case"style":z=Dp(b);break;case"script":z=Op(b)}_l.has(z)||(b=f({rel:"preload",href:C==="image"&&E&&E.imageSrcSet?void 0:b,as:C},E),_l.set(z,b),M.querySelector(L)!==null||C==="style"&&M.querySelector(V1(z))||C==="script"&&M.querySelector(F1(z))||(C=M.createElement("link"),lo(C,"link",b),rn(C),M.head.appendChild(C)))}}function Kie(b,C){ef.m(b,C);var E=_p;if(E&&b){var M=C&&typeof C.as=="string"?C.as:"script",L='link[rel="modulepreload"][as="'+pa(M)+'"][href="'+pa(b)+'"]',z=L;switch(M){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":z=Op(b)}if(!_l.has(z)&&(b=f({rel:"modulepreload",href:b},C),_l.set(z,b),E.querySelector(L)===null)){switch(M){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(E.querySelector(F1(z)))return}M=E.createElement("link"),lo(M,"link",b),rn(M),E.head.appendChild(M)}}}function qie(b,C,E){ef.S(b,C,E);var M=_p;if(M&&b){var L=Si(M).hoistableStyles,z=Dp(b);C=C||"default";var fe=L.get(z);if(!fe){var xe={loading:0,preload:null};if(fe=M.querySelector(V1(z)))xe.loading=5;else{b=f({rel:"stylesheet",href:b,"data-precedence":C},E),(E=_l.get(z))&&sT(b,E);var ke=fe=M.createElement("link");rn(ke),lo(ke,"link",b),ke._p=new Promise(function(Je,bt){ke.onload=Je,ke.onerror=bt}),ke.addEventListener("load",function(){xe.loading|=1}),ke.addEventListener("error",function(){xe.loading|=2}),xe.loading|=4,B5(fe,C,M)}fe={type:"stylesheet",instance:fe,count:1,state:xe},L.set(z,fe)}}}function Xie(b,C){ef.X(b,C);var E=_p;if(E&&b){var M=Si(E).hoistableScripts,L=Op(b),z=M.get(L);z||(z=E.querySelector(F1(L)),z||(b=f({src:b,async:!0},C),(C=_l.get(L))&&lT(b,C),z=E.createElement("script"),rn(z),lo(z,"link",b),E.head.appendChild(z)),z={type:"script",instance:z,count:1,state:null},M.set(L,z))}}function Yie(b,C){ef.M(b,C);var E=_p;if(E&&b){var M=Si(E).hoistableScripts,L=Op(b),z=M.get(L);z||(z=E.querySelector(F1(L)),z||(b=f({src:b,async:!0,type:"module"},C),(C=_l.get(L))&&lT(b,C),z=E.createElement("script"),rn(z),lo(z,"link",b),E.head.appendChild(z)),z={type:"script",instance:z,count:1,state:null},M.set(L,z))}}function QR(b,C,E,M){var L=(L=Ce.current)?U5(L):null;if(!L)throw Error(r(446));switch(b){case"meta":case"title":return null;case"style":return typeof E.precedence=="string"&&typeof E.href=="string"?(C=Dp(E.href),E=Si(L).hoistableStyles,M=E.get(C),M||(M={type:"style",instance:null,count:0,state:null},E.set(C,M)),M):{type:"void",instance:null,count:0,state:null};case"link":if(E.rel==="stylesheet"&&typeof E.href=="string"&&typeof E.precedence=="string"){b=Dp(E.href);var z=Si(L).hoistableStyles,fe=z.get(b);if(fe||(L=L.ownerDocument||L,fe={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},z.set(b,fe),(z=L.querySelector(V1(b)))&&!z._p&&(fe.instance=z,fe.state.loading=5),_l.has(b)||(E={rel:"preload",as:"style",href:E.href,crossOrigin:E.crossOrigin,integrity:E.integrity,media:E.media,hrefLang:E.hrefLang,referrerPolicy:E.referrerPolicy},_l.set(b,E),z||Jie(L,b,E,fe.state))),C&&M===null)throw Error(r(528,""));return fe}if(C&&M!==null)throw Error(r(529,""));return null;case"script":return C=E.async,E=E.src,typeof E=="string"&&C&&typeof C!="function"&&typeof C!="symbol"?(C=Op(E),E=Si(L).hoistableScripts,M=E.get(C),M||(M={type:"script",instance:null,count:0,state:null},E.set(C,M)),M):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,b))}}function Dp(b){return'href="'+pa(b)+'"'}function V1(b){return'link[rel="stylesheet"]['+b+"]"}function eP(b){return f({},b,{"data-precedence":b.precedence,precedence:null})}function Jie(b,C,E,M){b.querySelector('link[rel="preload"][as="style"]['+C+"]")?M.loading=1:(C=b.createElement("link"),M.preload=C,C.addEventListener("load",function(){return M.loading|=1}),C.addEventListener("error",function(){return M.loading|=2}),lo(C,"link",E),rn(C),b.head.appendChild(C))}function Op(b){return'[src="'+pa(b)+'"]'}function F1(b){return"script[async]"+b}function tP(b,C,E){if(C.count++,C.instance===null)switch(C.type){case"style":var M=b.querySelector('style[data-href~="'+pa(E.href)+'"]');if(M)return C.instance=M,rn(M),M;var L=f({},E,{"data-href":E.href,"data-precedence":E.precedence,href:null,precedence:null});return M=(b.ownerDocument||b).createElement("style"),rn(M),lo(M,"style",L),B5(M,E.precedence,b),C.instance=M;case"stylesheet":L=Dp(E.href);var z=b.querySelector(V1(L));if(z)return C.state.loading|=4,C.instance=z,rn(z),z;M=eP(E),(L=_l.get(L))&&sT(M,L),z=(b.ownerDocument||b).createElement("link"),rn(z);var fe=z;return fe._p=new Promise(function(xe,ke){fe.onload=xe,fe.onerror=ke}),lo(z,"link",M),C.state.loading|=4,B5(z,E.precedence,b),C.instance=z;case"script":return z=Op(E.src),(L=b.querySelector(F1(z)))?(C.instance=L,rn(L),L):(M=E,(L=_l.get(z))&&(M=f({},E),lT(M,L)),b=b.ownerDocument||b,L=b.createElement("script"),rn(L),lo(L,"link",M),b.head.appendChild(L),C.instance=L);case"void":return null;default:throw Error(r(443,C.type))}else C.type==="stylesheet"&&(C.state.loading&4)===0&&(M=C.instance,C.state.loading|=4,B5(M,E.precedence,b));return C.instance}function B5(b,C,E){for(var M=E.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),L=M.length?M[M.length-1]:null,z=L,fe=0;fe<M.length;fe++){var xe=M[fe];if(xe.dataset.precedence===C)z=xe;else if(z!==L)break}z?z.parentNode.insertBefore(b,z.nextSibling):(C=E.nodeType===9?E.head:E,C.insertBefore(b,C.firstChild))}function sT(b,C){b.crossOrigin==null&&(b.crossOrigin=C.crossOrigin),b.referrerPolicy==null&&(b.referrerPolicy=C.referrerPolicy),b.title==null&&(b.title=C.title)}function lT(b,C){b.crossOrigin==null&&(b.crossOrigin=C.crossOrigin),b.referrerPolicy==null&&(b.referrerPolicy=C.referrerPolicy),b.integrity==null&&(b.integrity=C.integrity)}var $5=null;function nP(b,C,E){if($5===null){var M=new Map,L=$5=new Map;L.set(E,M)}else L=$5,M=L.get(E),M||(M=new Map,L.set(E,M));if(M.has(b))return M;for(M.set(b,null),E=E.getElementsByTagName(b),L=0;L<E.length;L++){var z=E[L];if(!(z[Li]||z[Bt]||b==="link"&&z.getAttribute("rel")==="stylesheet")&&z.namespaceURI!=="http://www.w3.org/2000/svg"){var fe=z.getAttribute(C)||"";fe=b+fe;var xe=M.get(fe);xe?xe.push(z):M.set(fe,[z])}}return M}function rP(b,C,E){b=b.ownerDocument||b,b.head.insertBefore(E,C==="title"?b.querySelector("head > title"):null)}function Zie(b,C,E){if(E===1||C.itemProp!=null)return!1;switch(b){case"meta":case"title":return!0;case"style":if(typeof C.precedence!="string"||typeof C.href!="string"||C.href==="")break;return!0;case"link":if(typeof C.rel!="string"||typeof C.href!="string"||C.href===""||C.onLoad||C.onError)break;switch(C.rel){case"stylesheet":return b=C.disabled,typeof C.precedence=="string"&&b==null;default:return!0}case"script":if(C.async&&typeof C.async!="function"&&typeof C.async!="symbol"&&!C.onLoad&&!C.onError&&C.src&&typeof C.src=="string")return!0}return!1}function iP(b){return!(b.type==="stylesheet"&&(b.state.loading&3)===0)}var U1=null;function Qie(){}function eae(b,C,E){if(U1===null)throw Error(r(475));var M=U1;if(C.type==="stylesheet"&&(typeof E.media!="string"||matchMedia(E.media).matches!==!1)&&(C.state.loading&4)===0){if(C.instance===null){var L=Dp(E.href),z=b.querySelector(V1(L));if(z){b=z._p,b!==null&&typeof b=="object"&&typeof b.then=="function"&&(M.count++,M=G5.bind(M),b.then(M,M)),C.state.loading|=4,C.instance=z,rn(z);return}z=b.ownerDocument||b,E=eP(E),(L=_l.get(L))&&sT(E,L),z=z.createElement("link"),rn(z);var fe=z;fe._p=new Promise(function(xe,ke){fe.onload=xe,fe.onerror=ke}),lo(z,"link",E),C.instance=z}M.stylesheets===null&&(M.stylesheets=new Map),M.stylesheets.set(C,b),(b=C.state.preload)&&(C.state.loading&3)===0&&(M.count++,C=G5.bind(M),b.addEventListener("load",C),b.addEventListener("error",C))}}function tae(){if(U1===null)throw Error(r(475));var b=U1;return b.stylesheets&&b.count===0&&cT(b,b.stylesheets),0<b.count?function(C){var E=setTimeout(function(){if(b.stylesheets&&cT(b,b.stylesheets),b.unsuspend){var M=b.unsuspend;b.unsuspend=null,M()}},6e4);return b.unsuspend=C,function(){b.unsuspend=null,clearTimeout(E)}}:null}function G5(){if(this.count--,this.count===0){if(this.stylesheets)cT(this,this.stylesheets);else if(this.unsuspend){var b=this.unsuspend;this.unsuspend=null,b()}}}var j5=null;function cT(b,C){b.stylesheets=null,b.unsuspend!==null&&(b.count++,j5=new Map,C.forEach(nae,b),j5=null,G5.call(b))}function nae(b,C){if(!(C.state.loading&4)){var E=j5.get(b);if(E)var M=E.get(null);else{E=new Map,j5.set(b,E);for(var L=b.querySelectorAll("link[data-precedence],style[data-precedence]"),z=0;z<L.length;z++){var fe=L[z];(fe.nodeName==="LINK"||fe.getAttribute("media")!=="not all")&&(E.set(fe.dataset.precedence,fe),M=fe)}M&&E.set(null,M)}L=C.instance,fe=L.getAttribute("data-precedence"),z=E.get(fe)||M,z===M&&E.set(null,L),E.set(fe,L),this.count++,M=G5.bind(this),L.addEventListener("load",M),L.addEventListener("error",M),z?z.parentNode.insertBefore(L,z.nextSibling):(b=b.nodeType===9?b.head:b,b.insertBefore(L,b.firstChild)),C.state.loading|=4}}var B1={$$typeof:x,Provider:null,Consumer:null,_currentValue:U,_currentValue2:U,_threadCount:0};function rae(b,C,E,M,L,z,fe,xe){this.tag=1,this.containerInfo=b,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Tn(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Tn(0),this.hiddenUpdates=Tn(null),this.identifierPrefix=M,this.onUncaughtError=L,this.onCaughtError=z,this.onRecoverableError=fe,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=xe,this.incompleteTransitions=new Map}function aP(b,C,E,M,L,z,fe,xe,ke,Je,bt,_t){return b=new rae(b,C,E,fe,xe,ke,Je,_t),C=1,z===!0&&(C|=24),z=Us(3,null,null,C),b.current=z,z.stateNode=b,C=zS(),C.refCount++,b.pooledCache=C,C.refCount++,z.memoizedState={element:M,isDehydrated:E,cache:C},qS(z),b}function oP(b){return b?(b=ap,b):ap}function sP(b,C,E,M,L,z){L=oP(L),M.context===null?M.context=L:M.pendingContext=L,M=Xf(C),M.payload={element:E},z=z===void 0?null:z,z!==null&&(M.callback=z),E=Yf(b,M,C),E!==null&&(zs(E,b,C),m1(E,b,C))}function lP(b,C){if(b=b.memoizedState,b!==null&&b.dehydrated!==null){var E=b.retryLane;b.retryLane=E!==0&&E<C?E:C}}function uT(b,C){lP(b,C),(b=b.alternate)&&lP(b,C)}function cP(b){if(b.tag===13){var C=ip(b,67108864);C!==null&&zs(C,b,67108864),uT(b,67108864)}}var z5=!0;function iae(b,C,E,M){var L=V.T;V.T=null;var z=$.p;try{$.p=2,fT(b,C,E,M)}finally{$.p=z,V.T=L}}function aae(b,C,E,M){var L=V.T;V.T=null;var z=$.p;try{$.p=8,fT(b,C,E,M)}finally{$.p=z,V.T=L}}function fT(b,C,E,M){if(z5){var L=dT(M);if(L===null)Z4(b,C,M,W5,E),fP(b,M);else if(sae(L,b,C,E,M))M.stopPropagation();else if(fP(b,M),C&4&&-1<oae.indexOf(b)){for(;L!==null;){var z=nn(L);if(z!==null)switch(z.tag){case 3:if(z=z.stateNode,z.current.memoizedState.isDehydrated){var fe=Mt(z.pendingLanes);if(fe!==0){var xe=z;for(xe.pendingLanes|=2,xe.entangledLanes|=2;fe;){var ke=1<<31-ht(fe);xe.entanglements[1]|=ke,fe&=~ke}jc(z),(Fr&6)===0&&(O5=Ee()+500,A1(0))}}break;case 13:xe=ip(z,2),xe!==null&&zs(xe,z,2),I5(),uT(z,2)}if(z=dT(M),z===null&&Z4(b,C,M,W5,E),z===L)break;L=z}L!==null&&M.stopPropagation()}else Z4(b,C,M,null,E)}}function dT(b){return b=ta(b),hT(b)}var W5=null;function hT(b){if(W5=null,b=ki(b),b!==null){var C=a(b);if(C===null)b=null;else{var E=C.tag;if(E===13){if(b=o(C),b!==null)return b;b=null}else if(E===3){if(C.stateNode.current.memoizedState.isDehydrated)return C.tag===3?C.stateNode.containerInfo:null;b=null}else C!==b&&(b=null)}}return W5=b,null}function uP(b){switch(b){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Oe()){case Pe:return 2;case Ne:return 8;case ie:case ae:return 32;case Te:return 268435456;default:return 32}default:return 32}}var pT=!1,cd=null,ud=null,fd=null,$1=new Map,G1=new Map,dd=[],oae="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function fP(b,C){switch(b){case"focusin":case"focusout":cd=null;break;case"dragenter":case"dragleave":ud=null;break;case"mouseover":case"mouseout":fd=null;break;case"pointerover":case"pointerout":$1.delete(C.pointerId);break;case"gotpointercapture":case"lostpointercapture":G1.delete(C.pointerId)}}function j1(b,C,E,M,L,z){return b===null||b.nativeEvent!==z?(b={blockedOn:C,domEventName:E,eventSystemFlags:M,nativeEvent:z,targetContainers:[L]},C!==null&&(C=nn(C),C!==null&&cP(C)),b):(b.eventSystemFlags|=M,C=b.targetContainers,L!==null&&C.indexOf(L)===-1&&C.push(L),b)}function sae(b,C,E,M,L){switch(C){case"focusin":return cd=j1(cd,b,C,E,M,L),!0;case"dragenter":return ud=j1(ud,b,C,E,M,L),!0;case"mouseover":return fd=j1(fd,b,C,E,M,L),!0;case"pointerover":var z=L.pointerId;return $1.set(z,j1($1.get(z)||null,b,C,E,M,L)),!0;case"gotpointercapture":return z=L.pointerId,G1.set(z,j1(G1.get(z)||null,b,C,E,M,L)),!0}return!1}function dP(b){var C=ki(b.target);if(C!==null){var E=a(C);if(E!==null){if(C=E.tag,C===13){if(C=o(E),C!==null){b.blockedOn=C,Ft(b.priority,function(){if(E.tag===13){var M=js();M=Ke(M);var L=ip(E,M);L!==null&&zs(L,E,M),uT(E,M)}});return}}else if(C===3&&E.stateNode.current.memoizedState.isDehydrated){b.blockedOn=E.tag===3?E.stateNode.containerInfo:null;return}}}b.blockedOn=null}function H5(b){if(b.blockedOn!==null)return!1;for(var C=b.targetContainers;0<C.length;){var E=dT(b.nativeEvent);if(E===null){E=b.nativeEvent;var M=new E.constructor(E.type,E);So=M,E.target.dispatchEvent(M),So=null}else return C=nn(E),C!==null&&cP(C),b.blockedOn=E,!1;C.shift()}return!0}function hP(b,C,E){H5(b)&&E.delete(C)}function lae(){pT=!1,cd!==null&&H5(cd)&&(cd=null),ud!==null&&H5(ud)&&(ud=null),fd!==null&&H5(fd)&&(fd=null),$1.forEach(hP),G1.forEach(hP)}function K5(b,C){b.blockedOn===C&&(b.blockedOn=null,pT||(pT=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,lae)))}var q5=null;function pP(b){q5!==b&&(q5=b,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){q5===b&&(q5=null);for(var C=0;C<b.length;C+=3){var E=b[C],M=b[C+1],L=b[C+2];if(typeof M!="function"){if(hT(M||E)===null)continue;break}var z=nn(E);z!==null&&(b.splice(C,3),C-=3,h4(z,{pending:!0,data:L,method:E.method,action:M},M,L))}}))}function z1(b){function C(ke){return K5(ke,b)}cd!==null&&K5(cd,b),ud!==null&&K5(ud,b),fd!==null&&K5(fd,b),$1.forEach(C),G1.forEach(C);for(var E=0;E<dd.length;E++){var M=dd[E];M.blockedOn===b&&(M.blockedOn=null)}for(;0<dd.length&&(E=dd[0],E.blockedOn===null);)dP(E),E.blockedOn===null&&dd.shift();if(E=(b.ownerDocument||b).$$reactFormReplay,E!=null)for(M=0;M<E.length;M+=3){var L=E[M],z=E[M+1],fe=L[qt]||null;if(typeof z=="function")fe||pP(E);else if(fe){var xe=null;if(z&&z.hasAttribute("formAction")){if(L=z,fe=z[qt]||null)xe=fe.formAction;else if(hT(L)!==null)continue}else xe=fe.action;typeof xe=="function"?E[M+1]=xe:(E.splice(M,3),M-=3),pP(E)}}}function gT(b){this._internalRoot=b}X5.prototype.render=gT.prototype.render=function(b){var C=this._internalRoot;if(C===null)throw Error(r(409));var E=C.current,M=js();sP(E,M,b,C,null,null)},X5.prototype.unmount=gT.prototype.unmount=function(){var b=this._internalRoot;if(b!==null){this._internalRoot=null;var C=b.containerInfo;sP(b.current,2,null,b,null,null),I5(),C[kt]=null}};function X5(b){this._internalRoot=b}X5.prototype.unstable_scheduleHydration=function(b){if(b){var C=Rt();b={blockedOn:null,target:b,priority:C};for(var E=0;E<dd.length&&C!==0&&C<dd[E].priority;E++);dd.splice(E,0,b),E===0&&dP(b)}};var gP=e.version;if(gP!=="19.1.1")throw Error(r(527,gP,"19.1.1"));$.findDOMNode=function(b){var C=b._reactInternals;if(C===void 0)throw typeof b.render=="function"?Error(r(188)):(b=Object.keys(b).join(","),Error(r(268,b)));return b=l(C),b=b!==null?c(b):null,b=b===null?null:b.stateNode,b};var cae={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:V,reconcilerVersion:"19.1.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Y5=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Y5.isDisabled&&Y5.supportsFiber)try{Ve=Y5.inject(cae),ue=Y5}catch{}}return H1.createRoot=function(b,C){if(!i(b))throw Error(r(299));var E=!1,M="",L=RI,z=PI,fe=AI,xe=null;return C!=null&&(C.unstable_strictMode===!0&&(E=!0),C.identifierPrefix!==void 0&&(M=C.identifierPrefix),C.onUncaughtError!==void 0&&(L=C.onUncaughtError),C.onCaughtError!==void 0&&(z=C.onCaughtError),C.onRecoverableError!==void 0&&(fe=C.onRecoverableError),C.unstable_transitionCallbacks!==void 0&&(xe=C.unstable_transitionCallbacks)),C=aP(b,1,!1,null,null,E,M,L,z,fe,xe,null),b[kt]=C.current,J4(b),new gT(C)},H1.hydrateRoot=function(b,C,E){if(!i(b))throw Error(r(299));var M=!1,L="",z=RI,fe=PI,xe=AI,ke=null,Je=null;return E!=null&&(E.unstable_strictMode===!0&&(M=!0),E.identifierPrefix!==void 0&&(L=E.identifierPrefix),E.onUncaughtError!==void 0&&(z=E.onUncaughtError),E.onCaughtError!==void 0&&(fe=E.onCaughtError),E.onRecoverableError!==void 0&&(xe=E.onRecoverableError),E.unstable_transitionCallbacks!==void 0&&(ke=E.unstable_transitionCallbacks),E.formState!==void 0&&(Je=E.formState)),C=aP(b,1,!0,C,E??null,M,L,z,fe,xe,ke,Je),C.context=oP(null),E=C.current,M=js(),M=Ke(M),L=Xf(M),L.callback=null,Yf(E,L,M),E=M,C.current.lanes=E,en(C,E),jc(C),b[kt]=C.current,J4(b),new X5(C)},H1.version="19.1.1",H1}var EP;function xae(){if(EP)return yT.exports;EP=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),yT.exports=yae(),yT.exports}var bae=xae();/**
 * react-router v7.8.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var _P="popstate";function wae(t={}){function e(r,i){let{pathname:a,search:o,hash:s}=r.location;return Z8("",{pathname:a,search:o,hash:s},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(r,i){return typeof i=="string"?i:w2(i)}return Sae(e,n,null,t)}function Ua(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function pu(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function Cae(){return Math.random().toString(36).substring(2,10)}function DP(t,e){return{usr:t.state,key:t.key,idx:e}}function Z8(t,e,n=null,r){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?fy(e):e,state:n,key:e&&e.key||r||Cae()}}function w2({pathname:t="/",search:e="",hash:n=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function fy(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substring(n),t=t.substring(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substring(r),t=t.substring(0,r)),t&&(e.pathname=t)}return e}function Sae(t,e,n,r={}){let{window:i=document.defaultView,v5Compat:a=!1}=r,o=i.history,s="POP",l=null,c=f();c==null&&(c=0,o.replaceState({...o.state,idx:c},""));function f(){return(o.state||{idx:null}).idx}function u(){s="POP";let m=f(),y=m==null?null:m-c;c=m,l&&l({action:s,location:g.location,delta:y})}function d(m,y){s="PUSH";let v=Z8(g.location,m,y);c=f()+1;let x=DP(v,c),w=g.createHref(v);try{o.pushState(x,"",w)}catch(S){if(S instanceof DOMException&&S.name==="DataCloneError")throw S;i.location.assign(w)}a&&l&&l({action:s,location:g.location,delta:1})}function h(m,y){s="REPLACE";let v=Z8(g.location,m,y);c=f();let x=DP(v,c),w=g.createHref(v);o.replaceState(x,"",w),a&&l&&l({action:s,location:g.location,delta:0})}function p(m){return Tae(m)}let g={get action(){return s},get location(){return t(i,o)},listen(m){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(_P,u),l=m,()=>{i.removeEventListener(_P,u),l=null}},createHref(m){return e(i,m)},createURL:p,encodeLocation(m){let y=p(m);return{pathname:y.pathname,search:y.search,hash:y.hash}},push:d,replace:h,go(m){return o.go(m)}};return g}function Tae(t,e=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),Ua(n,"No window.location.(origin|href) available to create URL");let r=typeof t=="string"?t:w2(t);return r=r.replace(/ $/,"%20"),!e&&r.startsWith("//")&&(r=n+r),new URL(r,n)}function WB(t,e,n="/"){return Eae(t,e,n,!1)}function Eae(t,e,n,r){let i=typeof e=="string"?fy(e):e,a=Af(i.pathname||"/",n);if(a==null)return null;let o=HB(t);_ae(o);let s=null;for(let l=0;s==null&&l<o.length;++l){let c=Vae(a);s=Lae(o[l],c,r)}return s}function HB(t,e=[],n=[],r="",i=!1){let a=(o,s,l=i,c)=>{let f={relativePath:c===void 0?o.path||"":c,caseSensitive:o.caseSensitive===!0,childrenIndex:s,route:o};if(f.relativePath.startsWith("/")){if(!f.relativePath.startsWith(r)&&l)return;Ua(f.relativePath.startsWith(r),`Absolute route path "${f.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),f.relativePath=f.relativePath.slice(r.length)}let u=_f([r,f.relativePath]),d=n.concat(f);o.children&&o.children.length>0&&(Ua(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${u}".`),HB(o.children,e,d,u,l)),!(o.path==null&&!o.index)&&e.push({path:u,score:Aae(u,o.index),routesMeta:d})};return t.forEach((o,s)=>{if(o.path===""||!o.path?.includes("?"))a(o,s);else for(let l of KB(o.path))a(o,s,!0,l)}),e}function KB(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,i=n.endsWith("?"),a=n.replace(/\?$/,"");if(r.length===0)return i?[a,""]:[a];let o=KB(r.join("/")),s=[];return s.push(...o.map(l=>l===""?a:[a,l].join("/"))),i&&s.push(...o),s.map(l=>t.startsWith("/")&&l===""?"/":l)}function _ae(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:Nae(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}var Dae=/^:[\w-]+$/,Oae=3,Mae=2,Iae=1,Rae=10,Pae=-2,OP=t=>t==="*";function Aae(t,e){let n=t.split("/"),r=n.length;return n.some(OP)&&(r+=Pae),e&&(r+=Mae),n.filter(i=>!OP(i)).reduce((i,a)=>i+(Dae.test(a)?Oae:a===""?Iae:Rae),r)}function Nae(t,e){return t.length===e.length&&t.slice(0,-1).every((r,i)=>r===e[i])?t[t.length-1]-e[e.length-1]:0}function Lae(t,e,n=!1){let{routesMeta:r}=t,i={},a="/",o=[];for(let s=0;s<r.length;++s){let l=r[s],c=s===r.length-1,f=a==="/"?e:e.slice(a.length)||"/",u=ww({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},f),d=l.route;if(!u&&c&&n&&!r[r.length-1].route.index&&(u=ww({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},f)),!u)return null;Object.assign(i,u.params),o.push({params:i,pathname:_f([a,u.pathname]),pathnameBase:$ae(_f([a,u.pathnameBase])),route:d}),u.pathnameBase!=="/"&&(a=_f([a,u.pathnameBase]))}return o}function ww(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=kae(t.path,t.caseSensitive,t.end),i=e.match(n);if(!i)return null;let a=i[0],o=a.replace(/(.)\/+$/,"$1"),s=i.slice(1);return{params:r.reduce((c,{paramName:f,isOptional:u},d)=>{if(f==="*"){let p=s[d]||"";o=a.slice(0,a.length-p.length).replace(/(.)\/+$/,"$1")}const h=s[d];return u&&!h?c[f]=void 0:c[f]=(h||"").replace(/%2F/g,"/"),c},{}),pathname:a,pathnameBase:o,pattern:t}}function kae(t,e=!1,n=!0){pu(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let r=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,s,l)=>(r.push({paramName:s,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(r.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function Vae(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return pu(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function Af(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function Fae(t,e="/"){let{pathname:n,search:r="",hash:i=""}=typeof t=="string"?fy(t):t;return{pathname:n?n.startsWith("/")?n:Uae(n,e):e,search:Gae(r),hash:jae(i)}}function Uae(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function CT(t,e,n,r){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function Bae(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function qB(t){let e=Bae(t);return e.map((n,r)=>r===e.length-1?n.pathname:n.pathnameBase)}function XB(t,e,n,r=!1){let i;typeof t=="string"?i=fy(t):(i={...t},Ua(!i.pathname||!i.pathname.includes("?"),CT("?","pathname","search",i)),Ua(!i.pathname||!i.pathname.includes("#"),CT("#","pathname","hash",i)),Ua(!i.search||!i.search.includes("#"),CT("#","search","hash",i)));let a=t===""||i.pathname==="",o=a?"/":i.pathname,s;if(o==null)s=n;else{let u=e.length-1;if(!r&&o.startsWith("..")){let d=o.split("/");for(;d[0]==="..";)d.shift(),u-=1;i.pathname=d.join("/")}s=u>=0?e[u]:"/"}let l=Fae(i,s),c=o&&o!=="/"&&o.endsWith("/"),f=(a||o===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(c||f)&&(l.pathname+="/"),l}var _f=t=>t.join("/").replace(/\/\/+/g,"/"),$ae=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),Gae=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,jae=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function zae(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}var YB=["POST","PUT","PATCH","DELETE"];new Set(YB);var Wae=["GET",...YB];new Set(Wae);var Tm=H.createContext(null);Tm.displayName="DataRouter";var Z3=H.createContext(null);Z3.displayName="DataRouterState";H.createContext(!1);var JB=H.createContext({isTransitioning:!1});JB.displayName="ViewTransition";var Hae=H.createContext(new Map);Hae.displayName="Fetchers";var Kae=H.createContext(null);Kae.displayName="Await";var Tu=H.createContext(null);Tu.displayName="Navigation";var Q3=H.createContext(null);Q3.displayName="Location";var Eu=H.createContext({outlet:null,matches:[],isDataRoute:!1});Eu.displayName="Route";var b9=H.createContext(null);b9.displayName="RouteError";function qae(t,{relative:e}={}){Ua(dy(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=H.useContext(Tu),{hash:i,pathname:a,search:o}=hy(t,{relative:e}),s=a;return n!=="/"&&(s=a==="/"?n:_f([n,a])),r.createHref({pathname:s,search:o,hash:i})}function dy(){return H.useContext(Q3)!=null}function _u(){return Ua(dy(),"useLocation() may be used only in the context of a <Router> component."),H.useContext(Q3).location}var ZB="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function QB(t){H.useContext(Tu).static||H.useLayoutEffect(t)}function Ec(){let{isDataRoute:t}=H.useContext(Eu);return t?soe():Xae()}function Xae(){Ua(dy(),"useNavigate() may be used only in the context of a <Router> component.");let t=H.useContext(Tm),{basename:e,navigator:n}=H.useContext(Tu),{matches:r}=H.useContext(Eu),{pathname:i}=_u(),a=JSON.stringify(qB(r)),o=H.useRef(!1);return QB(()=>{o.current=!0}),H.useCallback((l,c={})=>{if(pu(o.current,ZB),!o.current)return;if(typeof l=="number"){n.go(l);return}let f=XB(l,JSON.parse(a),i,c.relative==="path");t==null&&e!=="/"&&(f.pathname=f.pathname==="/"?e:_f([e,f.pathname])),(c.replace?n.replace:n.push)(f,c.state,c)},[e,n,a,i,t])}H.createContext(null);function e$(){let{matches:t}=H.useContext(Eu),e=t[t.length-1];return e?e.params:{}}function hy(t,{relative:e}={}){let{matches:n}=H.useContext(Eu),{pathname:r}=_u(),i=JSON.stringify(qB(n));return H.useMemo(()=>XB(t,JSON.parse(i),r,e==="path"),[t,i,r,e])}function Yae(t,e){return t$(t)}function t$(t,e,n,r,i){Ua(dy(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=H.useContext(Tu),{matches:o}=H.useContext(Eu),s=o[o.length-1],l=s?s.params:{},c=s?s.pathname:"/",f=s?s.pathnameBase:"/",u=s&&s.route;{let v=u&&u.path||"";n$(c,!u||v.endsWith("*")||v.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${c}" (under <Route path="${v}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${v}"> to <Route path="${v==="/"?"*":`${v}/*`}">.`)}let d=_u(),h;h=d;let p=h.pathname||"/",g=p;if(f!=="/"){let v=f.replace(/^\//,"").split("/");g="/"+p.replace(/^\//,"").split("/").slice(v.length).join("/")}let m=WB(t,{pathname:g});return pu(u||m!=null,`No routes matched location "${h.pathname}${h.search}${h.hash}" `),pu(m==null||m[m.length-1].route.element!==void 0||m[m.length-1].route.Component!==void 0||m[m.length-1].route.lazy!==void 0,`Matched leaf route at location "${h.pathname}${h.search}${h.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`),toe(m&&m.map(v=>Object.assign({},v,{params:Object.assign({},l,v.params),pathname:_f([f,a.encodeLocation?a.encodeLocation(v.pathname).pathname:v.pathname]),pathnameBase:v.pathnameBase==="/"?f:_f([f,a.encodeLocation?a.encodeLocation(v.pathnameBase).pathname:v.pathnameBase])})),o,n,r,i)}function Jae(){let t=ooe(),e=zae(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:r},a={padding:"2px 4px",backgroundColor:r},o=null;return console.error("Error handled by React Router default ErrorBoundary:",t),o=H.createElement(H.Fragment,null,H.createElement("p",null,"💿 Hey developer 👋"),H.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",H.createElement("code",{style:a},"ErrorBoundary")," or"," ",H.createElement("code",{style:a},"errorElement")," prop on your route.")),H.createElement(H.Fragment,null,H.createElement("h2",null,"Unexpected Application Error!"),H.createElement("h3",{style:{fontStyle:"italic"}},e),n?H.createElement("pre",{style:i},n):null,o)}var Zae=H.createElement(Jae,null),Qae=class extends H.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){this.props.unstable_onError?this.props.unstable_onError(t,e):console.error("React Router caught the following error during render",t)}render(){return this.state.error!==void 0?H.createElement(Eu.Provider,{value:this.props.routeContext},H.createElement(b9.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function eoe({routeContext:t,match:e,children:n}){let r=H.useContext(Tm);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),H.createElement(Eu.Provider,{value:t},n)}function toe(t,e=[],n=null,r=null,i=null){if(t==null){if(!n)return null;if(n.errors)t=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let a=t,o=n?.errors;if(o!=null){let c=a.findIndex(f=>f.route.id&&o?.[f.route.id]!==void 0);Ua(c>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),a=a.slice(0,Math.min(a.length,c+1))}let s=!1,l=-1;if(n)for(let c=0;c<a.length;c++){let f=a[c];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(l=c),f.route.id){let{loaderData:u,errors:d}=n,h=f.route.loader&&!u.hasOwnProperty(f.route.id)&&(!d||d[f.route.id]===void 0);if(f.route.lazy||h){s=!0,l>=0?a=a.slice(0,l+1):a=[a[0]];break}}}return a.reduceRight((c,f,u)=>{let d,h=!1,p=null,g=null;n&&(d=o&&f.route.id?o[f.route.id]:void 0,p=f.route.errorElement||Zae,s&&(l<0&&u===0?(n$("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),h=!0,g=null):l===u&&(h=!0,g=f.route.hydrateFallbackElement||null)));let m=e.concat(a.slice(0,u+1)),y=()=>{let v;return d?v=p:h?v=g:f.route.Component?v=H.createElement(f.route.Component,null):f.route.element?v=f.route.element:v=c,H.createElement(eoe,{match:f,routeContext:{outlet:c,matches:m,isDataRoute:n!=null},children:v})};return n&&(f.route.ErrorBoundary||f.route.errorElement||u===0)?H.createElement(Qae,{location:n.location,revalidation:n.revalidation,component:p,error:d,children:y(),routeContext:{outlet:null,matches:m,isDataRoute:!0},unstable_onError:r}):y()},null)}function w9(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function noe(t){let e=H.useContext(Tm);return Ua(e,w9(t)),e}function roe(t){let e=H.useContext(Z3);return Ua(e,w9(t)),e}function ioe(t){let e=H.useContext(Eu);return Ua(e,w9(t)),e}function C9(t){let e=ioe(t),n=e.matches[e.matches.length-1];return Ua(n.route.id,`${t} can only be used on routes that contain a unique "id"`),n.route.id}function aoe(){return C9("useRouteId")}function ooe(){let t=H.useContext(b9),e=roe("useRouteError"),n=C9("useRouteError");return t!==void 0?t:e.errors?.[n]}function soe(){let{router:t}=noe("useNavigate"),e=C9("useNavigate"),n=H.useRef(!1);return QB(()=>{n.current=!0}),H.useCallback(async(i,a={})=>{pu(n.current,ZB),n.current&&(typeof i=="number"?t.navigate(i):await t.navigate(i,{fromRouteId:e,...a}))},[t,e])}var MP={};function n$(t,e,n){!e&&!MP[t]&&(MP[t]=!0,pu(!1,n))}H.memo(loe);function loe({routes:t,future:e,state:n,unstable_onError:r}){return t$(t,void 0,n,r,e)}function coe({basename:t="/",children:e=null,location:n,navigationType:r="POP",navigator:i,static:a=!1}){Ua(!dy(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=t.replace(/^\/*/,"/"),s=H.useMemo(()=>({basename:o,navigator:i,static:a,future:{}}),[o,i,a]);typeof n=="string"&&(n=fy(n));let{pathname:l="/",search:c="",hash:f="",state:u=null,key:d="default"}=n,h=H.useMemo(()=>{let p=Af(l,o);return p==null?null:{location:{pathname:p,search:c,hash:f,state:u,key:d},navigationType:r}},[o,l,c,f,u,d,r]);return pu(h!=null,`<Router basename="${o}"> is not able to match the URL "${l}${c}${f}" because it does not start with the basename, so the <Router> won't render anything.`),h==null?null:H.createElement(Tu.Provider,{value:s},H.createElement(Q3.Provider,{children:e,value:h}))}var Eb="get",_b="application/x-www-form-urlencoded";function eC(t){return t!=null&&typeof t.tagName=="string"}function uoe(t){return eC(t)&&t.tagName.toLowerCase()==="button"}function foe(t){return eC(t)&&t.tagName.toLowerCase()==="form"}function doe(t){return eC(t)&&t.tagName.toLowerCase()==="input"}function hoe(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function poe(t,e){return t.button===0&&(!e||e==="_self")&&!hoe(t)}var J5=null;function goe(){if(J5===null)try{new FormData(document.createElement("form"),0),J5=!1}catch{J5=!0}return J5}var moe=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function ST(t){return t!=null&&!moe.has(t)?(pu(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${_b}"`),null):t}function voe(t,e){let n,r,i,a,o;if(foe(t)){let s=t.getAttribute("action");r=s?Af(s,e):null,n=t.getAttribute("method")||Eb,i=ST(t.getAttribute("enctype"))||_b,a=new FormData(t)}else if(uoe(t)||doe(t)&&(t.type==="submit"||t.type==="image")){let s=t.form;if(s==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let l=t.getAttribute("formaction")||s.getAttribute("action");if(r=l?Af(l,e):null,n=t.getAttribute("formmethod")||s.getAttribute("method")||Eb,i=ST(t.getAttribute("formenctype"))||ST(s.getAttribute("enctype"))||_b,a=new FormData(s,t),!goe()){let{name:c,type:f,value:u}=t;if(f==="image"){let d=c?`${c}.`:"";a.append(`${d}x`,"0"),a.append(`${d}y`,"0")}else c&&a.append(c,u)}}else{if(eC(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=Eb,r=null,i=_b,o=t}return a&&i==="text/plain"&&(o=a,a=void 0),{action:r,method:n.toLowerCase(),encType:i,formData:a,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function S9(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function yoe(t,e,n){let r=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return r.pathname==="/"?r.pathname=`_root.${n}`:e&&Af(r.pathname,e)==="/"?r.pathname=`${e.replace(/\/$/,"")}/_root.${n}`:r.pathname=`${r.pathname.replace(/\/$/,"")}.${n}`,r}async function xoe(t,e){if(t.id in e)return e[t.id];try{let n=await import(t.module);return e[t.id]=n,n}catch(n){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function boe(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function woe(t,e,n){let r=await Promise.all(t.map(async i=>{let a=e.routes[i.route.id];if(a){let o=await xoe(a,n);return o.links?o.links():[]}return[]}));return Eoe(r.flat(1).filter(boe).filter(i=>i.rel==="stylesheet"||i.rel==="preload").map(i=>i.rel==="stylesheet"?{...i,rel:"prefetch",as:"style"}:{...i,rel:"prefetch"}))}function IP(t,e,n,r,i,a){let o=(l,c)=>n[c]?l.route.id!==n[c].route.id:!0,s=(l,c)=>n[c].pathname!==l.pathname||n[c].route.path?.endsWith("*")&&n[c].params["*"]!==l.params["*"];return a==="assets"?e.filter((l,c)=>o(l,c)||s(l,c)):a==="data"?e.filter((l,c)=>{let f=r.routes[l.route.id];if(!f||!f.hasLoader)return!1;if(o(l,c)||s(l,c))return!0;if(l.route.shouldRevalidate){let u=l.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:n[0]?.params||{},nextUrl:new URL(t,window.origin),nextParams:l.params,defaultShouldRevalidate:!0});if(typeof u=="boolean")return u}return!0}):[]}function Coe(t,e,{includeHydrateFallback:n}={}){return Soe(t.map(r=>{let i=e.routes[r.route.id];if(!i)return[];let a=[i.module];return i.clientActionModule&&(a=a.concat(i.clientActionModule)),i.clientLoaderModule&&(a=a.concat(i.clientLoaderModule)),n&&i.hydrateFallbackModule&&(a=a.concat(i.hydrateFallbackModule)),i.imports&&(a=a.concat(i.imports)),a}).flat(1))}function Soe(t){return[...new Set(t)]}function Toe(t){let e={},n=Object.keys(t).sort();for(let r of n)e[r]=t[r];return e}function Eoe(t,e){let n=new Set;return new Set(e),t.reduce((r,i)=>{let a=JSON.stringify(Toe(i));return n.has(a)||(n.add(a),r.push({key:a,link:i})),r},[])}function r$(){let t=H.useContext(Tm);return S9(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function _oe(){let t=H.useContext(Z3);return S9(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var T9=H.createContext(void 0);T9.displayName="FrameworkContext";function i$(){let t=H.useContext(T9);return S9(t,"You must render this element inside a <HydratedRouter> element"),t}function Doe(t,e){let n=H.useContext(T9),[r,i]=H.useState(!1),[a,o]=H.useState(!1),{onFocus:s,onBlur:l,onMouseEnter:c,onMouseLeave:f,onTouchStart:u}=e,d=H.useRef(null);H.useEffect(()=>{if(t==="render"&&o(!0),t==="viewport"){let g=y=>{y.forEach(v=>{o(v.isIntersecting)})},m=new IntersectionObserver(g,{threshold:.5});return d.current&&m.observe(d.current),()=>{m.disconnect()}}},[t]),H.useEffect(()=>{if(r){let g=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(g)}}},[r]);let h=()=>{i(!0)},p=()=>{i(!1),o(!1)};return n?t!=="intent"?[a,d,{}]:[a,d,{onFocus:K1(s,h),onBlur:K1(l,p),onMouseEnter:K1(c,h),onMouseLeave:K1(f,p),onTouchStart:K1(u,h)}]:[!1,d,{}]}function K1(t,e){return n=>{t&&t(n),n.defaultPrevented||e(n)}}function Ooe({page:t,...e}){let{router:n}=r$(),r=H.useMemo(()=>WB(n.routes,t,n.basename),[n.routes,t,n.basename]);return r?H.createElement(Ioe,{page:t,matches:r,...e}):null}function Moe(t){let{manifest:e,routeModules:n}=i$(),[r,i]=H.useState([]);return H.useEffect(()=>{let a=!1;return woe(t,e,n).then(o=>{a||i(o)}),()=>{a=!0}},[t,e,n]),r}function Ioe({page:t,matches:e,...n}){let r=_u(),{manifest:i,routeModules:a}=i$(),{basename:o}=r$(),{loaderData:s,matches:l}=_oe(),c=H.useMemo(()=>IP(t,e,l,i,r,"data"),[t,e,l,i,r]),f=H.useMemo(()=>IP(t,e,l,i,r,"assets"),[t,e,l,i,r]),u=H.useMemo(()=>{if(t===r.pathname+r.search+r.hash)return[];let p=new Set,g=!1;if(e.forEach(y=>{let v=i.routes[y.route.id];!v||!v.hasLoader||(!c.some(x=>x.route.id===y.route.id)&&y.route.id in s&&a[y.route.id]?.shouldRevalidate||v.hasClientLoader?g=!0:p.add(y.route.id))}),p.size===0)return[];let m=yoe(t,o,"data");return g&&p.size>0&&m.searchParams.set("_routes",e.filter(y=>p.has(y.route.id)).map(y=>y.route.id).join(",")),[m.pathname+m.search]},[o,s,r,i,c,e,t,a]),d=H.useMemo(()=>Coe(f,i),[f,i]),h=Moe(f);return H.createElement(H.Fragment,null,u.map(p=>H.createElement("link",{key:p,rel:"prefetch",as:"fetch",href:p,...n})),d.map(p=>H.createElement("link",{key:p,rel:"modulepreload",href:p,...n})),h.map(({key:p,link:g})=>H.createElement("link",{key:p,nonce:n.nonce,...g})))}function Roe(...t){return e=>{t.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var a$=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{a$&&(window.__reactRouterVersion="7.8.2")}catch{}function Poe({basename:t,children:e,window:n}){let r=H.useRef();r.current==null&&(r.current=wae({window:n,v5Compat:!0}));let i=r.current,[a,o]=H.useState({action:i.action,location:i.location}),s=H.useCallback(l=>{H.startTransition(()=>o(l))},[o]);return H.useLayoutEffect(()=>i.listen(s),[i,s]),H.createElement(coe,{basename:t,children:e,location:a.location,navigationType:a.action,navigator:i})}var o$=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,s$=H.forwardRef(function({onClick:e,discover:n="render",prefetch:r="none",relative:i,reloadDocument:a,replace:o,state:s,target:l,to:c,preventScrollReset:f,viewTransition:u,...d},h){let{basename:p}=H.useContext(Tu),g=typeof c=="string"&&o$.test(c),m,y=!1;if(typeof c=="string"&&g&&(m=c,a$))try{let I=new URL(window.location.href),R=c.startsWith("//")?new URL(I.protocol+c):new URL(c),O=Af(R.pathname,p);R.origin===I.origin&&O!=null?c=O+R.search+R.hash:y=!0}catch{pu(!1,`<Link to="${c}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let v=qae(c,{relative:i}),[x,w,S]=Doe(r,d),T=koe(c,{replace:o,state:s,target:l,preventScrollReset:f,relative:i,viewTransition:u});function _(I){e&&e(I),I.defaultPrevented||T(I)}let D=H.createElement("a",{...d,...S,href:m||v,onClick:y||a?e:_,ref:Roe(h,w),target:l,"data-discover":!g&&n==="render"?"true":void 0});return x&&!g?H.createElement(H.Fragment,null,D,H.createElement(Ooe,{page:v})):D});s$.displayName="Link";var Aoe=H.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:r="",end:i=!1,style:a,to:o,viewTransition:s,children:l,...c},f){let u=hy(o,{relative:c.relative}),d=_u(),h=H.useContext(Z3),{navigator:p,basename:g}=H.useContext(Tu),m=h!=null&&$oe(u)&&s===!0,y=p.encodeLocation?p.encodeLocation(u).pathname:u.pathname,v=d.pathname,x=h&&h.navigation&&h.navigation.location?h.navigation.location.pathname:null;n||(v=v.toLowerCase(),x=x?x.toLowerCase():null,y=y.toLowerCase()),x&&g&&(x=Af(x,g)||x);const w=y!=="/"&&y.endsWith("/")?y.length-1:y.length;let S=v===y||!i&&v.startsWith(y)&&v.charAt(w)==="/",T=x!=null&&(x===y||!i&&x.startsWith(y)&&x.charAt(y.length)==="/"),_={isActive:S,isPending:T,isTransitioning:m},D=S?e:void 0,I;typeof r=="function"?I=r(_):I=[r,S?"active":null,T?"pending":null,m?"transitioning":null].filter(Boolean).join(" ");let R=typeof a=="function"?a(_):a;return H.createElement(s$,{...c,"aria-current":D,className:I,ref:f,style:R,to:o,viewTransition:s},typeof l=="function"?l(_):l)});Aoe.displayName="NavLink";var Noe=H.forwardRef(({discover:t="render",fetcherKey:e,navigate:n,reloadDocument:r,replace:i,state:a,method:o=Eb,action:s,onSubmit:l,relative:c,preventScrollReset:f,viewTransition:u,...d},h)=>{let p=Uoe(),g=Boe(s,{relative:c}),m=o.toLowerCase()==="get"?"get":"post",y=typeof s=="string"&&o$.test(s),v=x=>{if(l&&l(x),x.defaultPrevented)return;x.preventDefault();let w=x.nativeEvent.submitter,S=w?.getAttribute("formmethod")||o;p(w||x.currentTarget,{fetcherKey:e,method:S,navigate:n,replace:i,state:a,relative:c,preventScrollReset:f,viewTransition:u})};return H.createElement("form",{ref:h,method:m,action:g,onSubmit:r?l:v,...d,"data-discover":!y&&t==="render"?"true":void 0})});Noe.displayName="Form";function Loe(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function l$(t){let e=H.useContext(Tm);return Ua(e,Loe(t)),e}function koe(t,{target:e,replace:n,state:r,preventScrollReset:i,relative:a,viewTransition:o}={}){let s=Ec(),l=_u(),c=hy(t,{relative:a});return H.useCallback(f=>{if(poe(f,e)){f.preventDefault();let u=n!==void 0?n:w2(l)===w2(c);s(t,{replace:u,state:r,preventScrollReset:i,relative:a,viewTransition:o})}},[l,s,c,n,r,e,t,i,a,o])}var Voe=0,Foe=()=>`__${String(++Voe)}__`;function Uoe(){let{router:t}=l$("useSubmit"),{basename:e}=H.useContext(Tu),n=aoe();return H.useCallback(async(r,i={})=>{let{action:a,method:o,encType:s,formData:l,body:c}=voe(r,e);if(i.navigate===!1){let f=i.fetcherKey||Foe();await t.fetch(f,n,i.action||a,{preventScrollReset:i.preventScrollReset,formData:l,body:c,formMethod:i.method||o,formEncType:i.encType||s,flushSync:i.flushSync})}else await t.navigate(i.action||a,{preventScrollReset:i.preventScrollReset,formData:l,body:c,formMethod:i.method||o,formEncType:i.encType||s,replace:i.replace,state:i.state,fromRouteId:n,flushSync:i.flushSync,viewTransition:i.viewTransition})},[t,e,n])}function Boe(t,{relative:e}={}){let{basename:n}=H.useContext(Tu),r=H.useContext(Eu);Ua(r,"useFormAction must be used inside a RouteContext");let[i]=r.matches.slice(-1),a={...hy(t||".",{relative:e})},o=_u();if(t==null){a.search=o.search;let s=new URLSearchParams(a.search),l=s.getAll("index");if(l.some(f=>f==="")){s.delete("index"),l.filter(u=>u).forEach(u=>s.append("index",u));let f=s.toString();a.search=f?`?${f}`:""}}return(!t||t===".")&&i.route.index&&(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(a.pathname=a.pathname==="/"?n:_f([n,a.pathname])),w2(a)}function $oe(t,{relative:e}={}){let n=H.useContext(JB);Ua(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=l$("useViewTransitionState"),i=hy(t,{relative:e});if(!n.isTransitioning)return!1;let a=Af(n.currentLocation.pathname,r)||n.currentLocation.pathname,o=Af(n.nextLocation.pathname,r)||n.nextLocation.pathname;return ww(i.pathname,o)!=null||ww(i.pathname,a)!=null}var E9=zB();const Goe=sl(E9),joe="modulepreload",zoe=function(t){return"/"+t},RP={},Em=function(e,n,r){let i=Promise.resolve();if(n&&n.length>0){let l=function(c){return Promise.all(c.map(f=>Promise.resolve(f).then(u=>({status:"fulfilled",value:u}),u=>({status:"rejected",reason:u}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),s=o?.nonce||o?.getAttribute("nonce");i=l(n.map(c=>{if(c=zoe(c),c in RP)return;RP[c]=!0;const f=c.endsWith(".css"),u=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${u}`))return;const d=document.createElement("link");if(d.rel=f?"stylesheet":joe,f||(d.as="script"),d.crossOrigin="",d.href=c,s&&d.setAttribute("nonce",s),document.head.appendChild(d),f)return new Promise((h,p)=>{d.addEventListener("load",h),d.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${c}`)))})}))}function a(o){const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=o,window.dispatchEvent(s),!s.defaultPrevented)throw o}return i.then(o=>{for(const s of o||[])s.status==="rejected"&&a(s.reason);return e().catch(a)})};function tC(t={}){const{strict:e=!0,errorMessage:n="useContext: `context` is undefined. Seems you forgot to wrap component within the Provider",name:r}=t,i=H.createContext(void 0);i.displayName=r;function a(){var o;const s=H.useContext(i);if(!s&&e){const l=new Error(n);throw l.name="ContextError",(o=Error.captureStackTrace)==null||o.call(Error,l,a),l}return s}return[i.Provider,a,i]}function Ai(t){const e=H.useRef(null);return H.useImperativeHandle(t,()=>e.current),e}var Woe=t=>t?"":void 0;function _9(t){return Array.isArray(t)}function Hoe(t){return _9(t)&&t.length===0}function c$(t){const e=typeof t;return t!=null&&(e==="object"||e==="function")&&!_9(t)}function Koe(t){return c$(t)&&Object.keys(t).length===0}function Cw(t){return _9(t)?Hoe(t):c$(t)?Koe(t):t==null||t===""}function qoe(t){return typeof t=="function"}var Lt=t=>t?"true":void 0;function u$(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t))for(e=0;e<t.length;e++)t[e]&&(n=u$(t[e]))&&(r&&(r+=" "),r+=n);else for(e in t)t[e]&&(r&&(r+=" "),r+=e);return r}function sn(...t){for(var e=0,n,r,i="";e<t.length;)(n=t[e++])&&(r=u$(n))&&(i&&(i+=" "),i+=r);return i}var Xoe=(...t)=>{let e=" ";for(const n of t)if(typeof n=="string"&&n.length>0){e=n;break}return e},f$=t=>t?t.charAt(0).toUpperCase()+t.slice(1).toLowerCase():"";function d$(t){return`${t}-${Math.floor(Math.random()*1e6)}`}function Yoe(t){for(const e in t)e.startsWith("on")&&delete t[e];return t}function $l(t){if(!t||typeof t!="object")return"";try{return JSON.stringify(t)}catch{return""}}function pd(t,e){const n=e-t+1;return Array.from({length:n},(r,i)=>i+t)}function h$(t,e,n){return Math.min(Math.max(t,e),n)}function Nf(...t){return(...e)=>{for(let n of t)typeof n=="function"&&n(...e)}}var PP=new Map;function Joe(t,e){if(t===e)return t;let n=PP.get(t);if(n)return n.forEach(i=>i.current=e),e;let r=PP.get(e);return r?(r.forEach(i=>i.current=t),t):e}function Nn(...t){let e={...t[0]};for(let n=1;n<t.length;n++){let r=t[n];for(let i in r){let a=e[i],o=r[i];typeof a=="function"&&typeof o=="function"&&i[0]==="o"&&i[1]==="n"&&i.charCodeAt(2)>=65&&i.charCodeAt(2)<=90?e[i]=Nf(a,o):(i==="className"||i==="UNSAFE_className")&&typeof a=="string"&&typeof o=="string"?e[i]=sn(a,o):i==="id"&&a&&o?e.id=Joe(a,o):e[i]=o!==void 0?o:a}}return e}function p$(...t){return t.length===1&&t[0]?t[0]:e=>{let n=!1;const r=t.map(i=>{const a=AP(i,e);return n||(n=typeof a=="function"),a});if(n)return()=>{r.forEach((i,a)=>{typeof i=="function"?i?.():AP(t[a],null)})}}}function AP(t,e){if(typeof t=="function")return()=>t(e);t!=null&&"current"in t&&(t.current=e)}function Zoe(t,e){if(t!=null){if(qoe(t)){t(e);return}try{t.current=e}catch{throw new Error(`Cannot assign value '${e}' to ref '${t}'`)}}}function Qoe(...t){return e=>{t.forEach(n=>Zoe(n,e))}}var ese=new Set(["id","type","style","title","role","tabIndex","htmlFor","width","height","abbr","accept","acceptCharset","accessKey","action","allowFullScreen","allowTransparency","alt","async","autoComplete","autoFocus","autoPlay","cellPadding","cellSpacing","challenge","charset","checked","cite","class","className","cols","colSpan","command","content","contentEditable","contextMenu","controls","coords","crossOrigin","data","dateTime","default","defer","dir","disabled","download","draggable","dropzone","encType","enterKeyHint","for","form","formAction","formEncType","formMethod","formNoValidate","formTarget","frameBorder","headers","hidden","high","href","hrefLang","httpEquiv","icon","inputMode","isMap","itemId","itemProp","itemRef","itemScope","itemType","kind","label","lang","list","loop","manifest","max","maxLength","media","mediaGroup","method","min","minLength","multiple","muted","name","noValidate","open","optimum","pattern","ping","placeholder","poster","preload","radioGroup","referrerPolicy","readOnly","rel","required","rows","rowSpan","sandbox","scope","scoped","scrolling","seamless","selected","shape","size","sizes","slot","sortable","span","spellCheck","src","srcDoc","srcSet","start","step","target","translate","typeMustMatch","useMap","value","wmode","wrap"]),tse=new Set(["onCopy","onCut","onPaste","onLoad","onError","onWheel","onScroll","onCompositionEnd","onCompositionStart","onCompositionUpdate","onKeyDown","onKeyPress","onKeyUp","onFocus","onBlur","onChange","onInput","onSubmit","onClick","onContextMenu","onDoubleClick","onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onPointerDown","onPointerEnter","onPointerLeave","onPointerUp","onSelect","onTouchCancel","onTouchEnd","onTouchMove","onTouchStart","onAnimationStart","onAnimationEnd","onAnimationIteration","onTransitionEnd"]),NP=/^(data-.*)$/,nse=/^(aria-.*)$/,Z5=/^(on[A-Z].*)$/;function Lo(t,e={}){let{labelable:n=!0,enabled:r=!0,propNames:i,omitPropNames:a,omitEventNames:o,omitDataProps:s,omitEventProps:l}=e,c={};if(!r)return t;for(const f in t)a?.has(f)||o?.has(f)&&Z5.test(f)||Z5.test(f)&&!tse.has(f)||s&&NP.test(f)||l&&Z5.test(f)||(Object.prototype.hasOwnProperty.call(t,f)&&(ese.has(f)||n&&nse.test(f)||i?.has(f)||NP.test(f))||Z5.test(f))&&(c[f]=t[f]);return c}var[rse,as]=tC({name:"ProviderContext",strict:!1});const ise=new Set(["Arab","Syrc","Samr","Mand","Thaa","Mend","Nkoo","Adlm","Rohg","Hebr"]),ase=new Set(["ae","ar","arc","bcc","bqi","ckb","dv","fa","glk","he","ku","mzn","nqo","pnb","ps","sd","ug","ur","yi"]);function g$(t){if(Intl.Locale){let n=new Intl.Locale(t).maximize(),r=typeof n.getTextInfo=="function"?n.getTextInfo():n.textInfo;if(r)return r.direction==="rtl";if(n.script)return ise.has(n.script)}let e=t.split("-")[0];return ase.has(e)}const m$={prefix:String(Math.round(Math.random()*1e10)),current:0},v$=un.createContext(m$),ose=un.createContext(!1);let TT=new WeakMap;function sse(t=!1){let e=H.useContext(v$),n=H.useRef(null);if(n.current===null&&!t){var r,i;let a=(i=un.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED)===null||i===void 0||(r=i.ReactCurrentOwner)===null||r===void 0?void 0:r.current;if(a){let o=TT.get(a);o==null?TT.set(a,{id:e.current,state:a.memoizedState}):a.memoizedState!==o.state&&(e.current=o.id,TT.delete(a))}n.current=++e.current}return n.current}function lse(t){let e=H.useContext(v$),n=sse(!!t),r=`react-aria${e.prefix}`;return t||`${r}-${n}`}function cse(t){let e=un.useId(),[n]=H.useState(py()),r=n?"react-aria":`react-aria${m$.prefix}`;return t||`${r}-${e}`}const y$=typeof un.useId=="function"?cse:lse;function use(){return!1}function fse(){return!0}function dse(t){return()=>{}}function py(){return typeof un.useSyncExternalStore=="function"?un.useSyncExternalStore(dse,use,fse):H.useContext(ose)}const hse=Symbol.for("react-aria.i18n.locale");function x$(){let t=typeof window<"u"&&window[hse]||typeof navigator<"u"&&(navigator.language||navigator.userLanguage)||"en-US";try{Intl.DateTimeFormat.supportedLocalesOf([t])}catch{t="en-US"}return{locale:t,direction:g$(t)?"rtl":"ltr"}}let Q8=x$(),vv=new Set;function LP(){Q8=x$();for(let t of vv)t(Q8)}function b$(){let t=py(),[e,n]=H.useState(Q8);return H.useEffect(()=>(vv.size===0&&window.addEventListener("languagechange",LP),vv.add(n),()=>{vv.delete(n),vv.size===0&&window.removeEventListener("languagechange",LP)}),[]),t?{locale:"en-US",direction:"ltr"}:e}const w$=un.createContext(null);function pse(t){let{locale:e,children:n}=t,r=b$(),i=un.useMemo(()=>e?{locale:e,direction:g$(e)?"rtl":"ltr"}:r,[r,e]);return un.createElement(w$.Provider,{value:i},n)}function D9(){let t=b$();return H.useContext(w$)||t}const gse=Symbol.for("react-aria.i18n.locale"),mse=Symbol.for("react-aria.i18n.strings");let Mp;class nC{getStringForLocale(e,n){let i=this.getStringsForLocale(n)[e];if(!i)throw new Error(`Could not find intl message ${e} in ${n} locale`);return i}getStringsForLocale(e){let n=this.strings[e];return n||(n=vse(e,this.strings,this.defaultLocale),this.strings[e]=n),n}static getGlobalDictionaryForPackage(e){if(typeof window>"u")return null;let n=window[gse];if(Mp===void 0){let i=window[mse];if(!i)return null;Mp={};for(let a in i)Mp[a]=new nC({[n]:i[a]},n)}let r=Mp?.[e];if(!r)throw new Error(`Strings for package "${e}" were not included by LocalizedStringProvider. Please add it to the list passed to createLocalizedStringDictionary.`);return r}constructor(e,n="en-US"){this.strings=Object.fromEntries(Object.entries(e).filter(([,r])=>r)),this.defaultLocale=n}}function vse(t,e,n="en-US"){if(e[t])return e[t];let r=yse(t);if(e[r])return e[r];for(let i in e)if(i.startsWith(r+"-"))return e[i];return e[n]}function yse(t){return Intl.Locale?new Intl.Locale(t).language:t.split("-")[0]}const kP=new Map,VP=new Map;class xse{format(e,n){let r=this.strings.getStringForLocale(e,this.locale);return typeof r=="function"?r(n,this):r}plural(e,n,r="cardinal"){let i=n["="+e];if(i)return typeof i=="function"?i():i;let a=this.locale+":"+r,o=kP.get(a);o||(o=new Intl.PluralRules(this.locale,{type:r}),kP.set(a,o));let s=o.select(e);return i=n[s]||n.other,typeof i=="function"?i():i}number(e){let n=VP.get(this.locale);return n||(n=new Intl.NumberFormat(this.locale),VP.set(this.locale,n)),n.format(e)}select(e,n){let r=e[n]||e.other;return typeof r=="function"?r():r}constructor(e,n){this.locale=e,this.strings=n}}function bse(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function C$(t,e,n){bse(t,e),e.set(t,n)}const Nr=typeof document<"u"?un.useLayoutEffect:()=>{};var ET;const wse=(ET=un.useInsertionEffect)!==null&&ET!==void 0?ET:Nr;function Sr(t){const e=H.useRef(null);return wse(()=>{e.current=t},[t]),H.useCallback((...n)=>{const r=e.current;return r?.(...n)},[])}function Cse(t){let[e,n]=H.useState(t),r=H.useRef(null),i=Sr(()=>{if(!r.current)return;let o=r.current.next();if(o.done){r.current=null;return}e===o.value?i():n(o.value)});Nr(()=>{r.current&&i()});let a=Sr(o=>{r.current=o(e),i()});return[e,a]}let Sse=!!(typeof window<"u"&&window.document&&window.document.createElement),kg=new Map,yv;typeof FinalizationRegistry<"u"&&(yv=new FinalizationRegistry(t=>{kg.delete(t)}));function rl(t){let[e,n]=H.useState(t),r=H.useRef(null),i=y$(e),a=H.useRef(null);if(yv&&yv.register(a,i),Sse){const o=kg.get(i);o&&!o.includes(r)?o.push(r):kg.set(i,[r])}return Nr(()=>{let o=i;return()=>{yv&&yv.unregister(a),kg.delete(o)}},[i]),H.useEffect(()=>{let o=r.current;return o&&n(o),()=>{o&&(r.current=null)}}),i}function Tse(t,e){if(t===e)return t;let n=kg.get(t);if(n)return n.forEach(i=>i.current=e),e;let r=kg.get(e);return r?(r.forEach(i=>i.current=t),t):e}function sm(t=[]){let e=rl(),[n,r]=Cse(e),i=H.useCallback(()=>{r(function*(){yield e,yield document.getElementById(e)?e:void 0})},[e,r]);return Nr(i,[e,i,...t]),n}function Zd(...t){return(...e)=>{for(let n of t)typeof n=="function"&&n(...e)}}const In=t=>{var e;return(e=t?.ownerDocument)!==null&&e!==void 0?e:document},Za=t=>t&&"window"in t&&t.window===t?t:In(t).defaultView||window;function Ese(t){return t!==null&&typeof t=="object"&&"nodeType"in t&&typeof t.nodeType=="number"}function _se(t){return Ese(t)&&t.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&"host"in t}let Dse=!1;function rC(){return Dse}function fi(t,e){if(!rC())return e&&t?t.contains(e):!1;if(!t||!e)return!1;let n=e;for(;n!==null;){if(n===t)return!0;n.tagName==="SLOT"&&n.assignedSlot?n=n.assignedSlot.parentNode:_se(n)?n=n.host:n=n.parentNode}return!1}const Ba=(t=document)=>{var e;if(!rC())return t.activeElement;let n=t.activeElement;for(;n&&"shadowRoot"in n&&(!((e=n.shadowRoot)===null||e===void 0)&&e.activeElement);)n=n.shadowRoot.activeElement;return n};function sr(t){return rC()&&t.target.shadowRoot&&t.composedPath?t.composedPath()[0]:t.target}class Ose{get currentNode(){return this._currentNode}set currentNode(e){if(!fi(this.root,e))throw new Error("Cannot set currentNode to a node that is not contained by the root node.");const n=[];let r=e,i=e;for(this._currentNode=e;r&&r!==this.root;)if(r.nodeType===Node.DOCUMENT_FRAGMENT_NODE){const o=r,s=this._doc.createTreeWalker(o,this.whatToShow,{acceptNode:this._acceptNode});n.push(s),s.currentNode=i,this._currentSetFor.add(s),r=i=o.host}else r=r.parentNode;const a=this._doc.createTreeWalker(this.root,this.whatToShow,{acceptNode:this._acceptNode});n.push(a),a.currentNode=i,this._currentSetFor.add(a),this._walkerStack=n}get doc(){return this._doc}firstChild(){let e=this.currentNode,n=this.nextNode();return fi(e,n)?(n&&(this.currentNode=n),n):(this.currentNode=e,null)}lastChild(){let n=this._walkerStack[0].lastChild();return n&&(this.currentNode=n),n}nextNode(){const e=this._walkerStack[0].nextNode();if(e){if(e.shadowRoot){var n;let i;if(typeof this.filter=="function"?i=this.filter(e):!((n=this.filter)===null||n===void 0)&&n.acceptNode&&(i=this.filter.acceptNode(e)),i===NodeFilter.FILTER_ACCEPT)return this.currentNode=e,e;let a=this.nextNode();return a&&(this.currentNode=a),a}return e&&(this.currentNode=e),e}else if(this._walkerStack.length>1){this._walkerStack.shift();let r=this.nextNode();return r&&(this.currentNode=r),r}else return null}previousNode(){const e=this._walkerStack[0];if(e.currentNode===e.root){if(this._currentSetFor.has(e))if(this._currentSetFor.delete(e),this._walkerStack.length>1){this._walkerStack.shift();let i=this.previousNode();return i&&(this.currentNode=i),i}else return null;return null}const n=e.previousNode();if(n){if(n.shadowRoot){var r;let a;if(typeof this.filter=="function"?a=this.filter(n):!((r=this.filter)===null||r===void 0)&&r.acceptNode&&(a=this.filter.acceptNode(n)),a===NodeFilter.FILTER_ACCEPT)return n&&(this.currentNode=n),n;let o=this.lastChild();return o&&(this.currentNode=o),o}return n&&(this.currentNode=n),n}else if(this._walkerStack.length>1){this._walkerStack.shift();let i=this.previousNode();return i&&(this.currentNode=i),i}else return null}nextSibling(){return null}previousSibling(){return null}parentNode(){return null}constructor(e,n,r,i){this._walkerStack=[],this._currentSetFor=new Set,this._acceptNode=o=>{if(o.nodeType===Node.ELEMENT_NODE){const l=o.shadowRoot;if(l){const c=this._doc.createTreeWalker(l,this.whatToShow,{acceptNode:this._acceptNode});return this._walkerStack.unshift(c),NodeFilter.FILTER_ACCEPT}else{var s;if(typeof this.filter=="function")return this.filter(o);if(!((s=this.filter)===null||s===void 0)&&s.acceptNode)return this.filter.acceptNode(o);if(this.filter===null)return NodeFilter.FILTER_ACCEPT}}return NodeFilter.FILTER_SKIP},this._doc=e,this.root=n,this.filter=i??null,this.whatToShow=r??NodeFilter.SHOW_ALL,this._currentNode=n,this._walkerStack.unshift(e.createTreeWalker(n,r,this._acceptNode));const a=n.shadowRoot;if(a){const o=this._doc.createTreeWalker(a,this.whatToShow,{acceptNode:this._acceptNode});this._walkerStack.unshift(o)}}}function S$(t,e,n,r){return rC()?new Ose(t,e,n,r):t.createTreeWalker(e,n,r)}function T$(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(e=0;e<i;e++)t[e]&&(n=T$(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function E$(){for(var t,e,n=0,r="",i=arguments.length;n<i;n++)(t=arguments[n])&&(e=T$(t))&&(r&&(r+=" "),r+=e);return r}function Ji(...t){let e={...t[0]};for(let n=1;n<t.length;n++){let r=t[n];for(let i in r){let a=e[i],o=r[i];typeof a=="function"&&typeof o=="function"&&i[0]==="o"&&i[1]==="n"&&i.charCodeAt(2)>=65&&i.charCodeAt(2)<=90?e[i]=Zd(a,o):(i==="className"||i==="UNSAFE_className")&&typeof a=="string"&&typeof o=="string"?e[i]=E$(a,o):i==="id"&&a&&o?e.id=Tse(a,o):e[i]=o!==void 0?o:a}}return e}const Mse=new Set(["id"]),Ise=new Set(["aria-label","aria-labelledby","aria-describedby","aria-details"]),Rse=new Set(["href","hrefLang","target","rel","download","ping","referrerPolicy"]),Pse=new Set(["dir","lang","hidden","inert","translate"]),FP=new Set(["onClick","onAuxClick","onContextMenu","onDoubleClick","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onTouchCancel","onTouchEnd","onTouchMove","onTouchStart","onPointerDown","onPointerMove","onPointerUp","onPointerCancel","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut","onGotPointerCapture","onLostPointerCapture","onScroll","onWheel","onAnimationStart","onAnimationEnd","onAnimationIteration","onTransitionCancel","onTransitionEnd","onTransitionRun","onTransitionStart"]),Ase=/^(data-.*)$/;function _m(t,e={}){let{labelable:n,isLink:r,global:i,events:a=i,propNames:o}=e,s={};for(const l in t)Object.prototype.hasOwnProperty.call(t,l)&&(Mse.has(l)||n&&Ise.has(l)||r&&Rse.has(l)||i&&Pse.has(l)||a&&FP.has(l)||l.endsWith("Capture")&&FP.has(l.slice(0,-7))||o?.has(l)||Ase.test(l))&&(s[l]=t[l]);return s}function Xi(t){if(Nse())t.focus({preventScroll:!0});else{let e=Lse(t);t.focus(),kse(e)}}let Q5=null;function Nse(){if(Q5==null){Q5=!1;try{document.createElement("div").focus({get preventScroll(){return Q5=!0,!0}})}catch{}}return Q5}function Lse(t){let e=t.parentNode,n=[],r=document.scrollingElement||document.documentElement;for(;e instanceof HTMLElement&&e!==r;)(e.offsetHeight<e.scrollHeight||e.offsetWidth<e.scrollWidth)&&n.push({element:e,scrollTop:e.scrollTop,scrollLeft:e.scrollLeft}),e=e.parentNode;return r instanceof HTMLElement&&n.push({element:r,scrollTop:r.scrollTop,scrollLeft:r.scrollLeft}),n}function kse(t){for(let{element:e,scrollTop:n,scrollLeft:r}of t)e.scrollTop=n,e.scrollLeft=r}function iC(t){var e;if(typeof window>"u"||window.navigator==null)return!1;let n=(e=window.navigator.userAgentData)===null||e===void 0?void 0:e.brands;return Array.isArray(n)&&n.some(r=>t.test(r.brand))||t.test(window.navigator.userAgent)}function O9(t){var e;return typeof window<"u"&&window.navigator!=null?t.test(((e=window.navigator.userAgentData)===null||e===void 0?void 0:e.platform)||window.navigator.platform):!1}function Gf(t){let e=null;return()=>(e==null&&(e=t()),e)}const gu=Gf(function(){return O9(/^Mac/i)}),Vse=Gf(function(){return O9(/^iPhone/i)}),_$=Gf(function(){return O9(/^iPad/i)||gu()&&navigator.maxTouchPoints>1}),Dm=Gf(function(){return Vse()||_$()}),Fse=Gf(function(){return gu()||Dm()}),M9=Gf(function(){return iC(/AppleWebKit/i)&&!D$()}),D$=Gf(function(){return iC(/Chrome/i)}),I9=Gf(function(){return iC(/Android/i)}),Use=Gf(function(){return iC(/Firefox/i)}),Bse=H.createContext({isNative:!0,open:Gse,useHref:t=>t});function R9(){return H.useContext(Bse)}function Lf(t,e,n=!0){var r,i;let{metaKey:a,ctrlKey:o,altKey:s,shiftKey:l}=e;Use()&&(!((i=window.event)===null||i===void 0||(r=i.type)===null||r===void 0)&&r.startsWith("key"))&&t.target==="_blank"&&(gu()?a=!0:o=!0);let c=M9()&&gu()&&!_$()?new KeyboardEvent("keydown",{keyIdentifier:"Enter",metaKey:a,ctrlKey:o,altKey:s,shiftKey:l}):new MouseEvent("click",{metaKey:a,ctrlKey:o,altKey:s,shiftKey:l,bubbles:!0,cancelable:!0});Lf.isOpening=n,Xi(t),t.dispatchEvent(c),Lf.isOpening=!1}Lf.isOpening=!1;function $se(t,e){if(t instanceof HTMLAnchorElement)e(t);else if(t.hasAttribute("data-href")){let n=document.createElement("a");n.href=t.getAttribute("data-href"),t.hasAttribute("data-target")&&(n.target=t.getAttribute("data-target")),t.hasAttribute("data-rel")&&(n.rel=t.getAttribute("data-rel")),t.hasAttribute("data-download")&&(n.download=t.getAttribute("data-download")),t.hasAttribute("data-ping")&&(n.ping=t.getAttribute("data-ping")),t.hasAttribute("data-referrer-policy")&&(n.referrerPolicy=t.getAttribute("data-referrer-policy")),t.appendChild(n),e(n),t.removeChild(n)}}function Gse(t,e){$se(t,n=>Lf(n,e))}function O$(t){let e=R9();var n;const r=e.useHref((n=t?.href)!==null&&n!==void 0?n:"");return{href:t?.href?r:void 0,target:t?.target,rel:t?.rel,download:t?.download,ping:t?.ping,referrerPolicy:t?.referrerPolicy}}let Ad=new Map,e6=new Set;function UP(){if(typeof window>"u")return;function t(r){return"propertyName"in r}let e=r=>{if(!t(r)||!r.target)return;let i=Ad.get(r.target);i||(i=new Set,Ad.set(r.target,i),r.target.addEventListener("transitioncancel",n,{once:!0})),i.add(r.propertyName)},n=r=>{if(!t(r)||!r.target)return;let i=Ad.get(r.target);if(i&&(i.delete(r.propertyName),i.size===0&&(r.target.removeEventListener("transitioncancel",n),Ad.delete(r.target)),Ad.size===0)){for(let a of e6)a();e6.clear()}};document.body.addEventListener("transitionrun",e),document.body.addEventListener("transitionend",n)}typeof document<"u"&&(document.readyState!=="loading"?UP():document.addEventListener("DOMContentLoaded",UP));function jse(){for(const[t]of Ad)"isConnected"in t&&!t.isConnected&&Ad.delete(t)}function aC(t){requestAnimationFrame(()=>{jse(),Ad.size===0?t():e6.add(t)})}function Hh(){let t=H.useRef(new Map),e=H.useCallback((i,a,o,s)=>{let l=s?.once?(...c)=>{t.current.delete(o),o(...c)}:o;t.current.set(o,{type:a,eventTarget:i,fn:l,options:s}),i.addEventListener(a,l,s)},[]),n=H.useCallback((i,a,o,s)=>{var l;let c=((l=t.current.get(o))===null||l===void 0?void 0:l.fn)||o;i.removeEventListener(a,c,s),t.current.delete(o)},[]),r=H.useCallback(()=>{t.current.forEach((i,a)=>{n(i.eventTarget,i.type,a,i.options)})},[n]);return H.useEffect(()=>r,[r]),{addGlobalListener:e,removeGlobalListener:n,removeAllGlobalListeners:r}}function oC(t,e){let{id:n,"aria-label":r,"aria-labelledby":i}=t;return n=rl(n),i&&r?i=[...new Set([n,...i.trim().split(/\s+/)])].join(" "):i&&(i=i.trim().split(/\s+/).join(" ")),!r&&!i&&e&&(r=e),{id:n,"aria-label":r,"aria-labelledby":i}}function BP(t,e){const n=H.useRef(!0),r=H.useRef(null);Nr(()=>(n.current=!0,()=>{n.current=!1}),[]),Nr(()=>{n.current?n.current=!1:(!r.current||e.some((i,a)=>!Object.is(i,r[a])))&&t(),r.current=e},e)}function zse(){return typeof window.ResizeObserver<"u"}function $P(t){const{ref:e,box:n,onResize:r}=t;H.useEffect(()=>{let i=e?.current;if(i)if(zse()){const a=new window.ResizeObserver(o=>{o.length&&r()});return a.observe(i,{box:n}),()=>{i&&a.unobserve(i)}}else return window.addEventListener("resize",r,!1),()=>{window.removeEventListener("resize",r,!1)}},[r,e,n])}function P9(t,e){Nr(()=>{if(t&&t.ref&&e)return t.ref.current=e.current,()=>{t.ref&&(t.ref.current=null)}})}function C2(t,e){if(!t)return!1;let n=window.getComputedStyle(t),r=/(auto|scroll)/.test(n.overflow+n.overflowX+n.overflowY);return r&&e&&(r=t.scrollHeight!==t.clientHeight||t.scrollWidth!==t.clientWidth),r}function M$(t,e){let n=t;for(C2(n,e)&&(n=n.parentElement);n&&!C2(n,e);)n=n.parentElement;return n||document.scrollingElement||document.documentElement}function Wse(t,e){const n=[];for(;t&&t!==document.documentElement;)C2(t,e)&&n.push(t),t=t.parentElement;return n}let Hse=0;const _T=new Map;function I$(t){let[e,n]=H.useState();return Nr(()=>{if(!t)return;let r=_T.get(t);if(r)n(r.element.id);else{let i=`react-aria-description-${Hse++}`;n(i);let a=document.createElement("div");a.id=i,a.style.display="none",a.textContent=t,document.body.appendChild(a),r={refCount:0,element:a},_T.set(t,r)}return r.refCount++,()=>{r&&--r.refCount===0&&(r.element.remove(),_T.delete(t))}},[t]),{"aria-describedby":t?e:void 0}}function ex(t,e,n,r){let i=Sr(n),a=n==null;H.useEffect(()=>{if(a||!t.current)return;let o=t.current;return o.addEventListener(e,i,r),()=>{o.removeEventListener(e,i,r)}},[t,e,r,a,i])}function R$(t,e){let n=GP(t,e,"left"),r=GP(t,e,"top"),i=e.offsetWidth,a=e.offsetHeight,o=t.scrollLeft,s=t.scrollTop,{borderTopWidth:l,borderLeftWidth:c,scrollPaddingTop:f,scrollPaddingRight:u,scrollPaddingBottom:d,scrollPaddingLeft:h}=getComputedStyle(t),p=o+parseInt(c,10),g=s+parseInt(l,10),m=p+t.clientWidth,y=g+t.clientHeight,v=parseInt(f,10)||0,x=parseInt(d,10)||0,w=parseInt(u,10)||0,S=parseInt(h,10)||0;n<=o+S?o=n-parseInt(c,10)-S:n+i>m-w&&(o+=n+i-m+w),r<=g+v?s=r-parseInt(l,10)-v:r+a>y-x&&(s+=r+a-y+x),t.scrollLeft=o,t.scrollTop=s}function GP(t,e,n){const r=n==="left"?"offsetLeft":"offsetTop";let i=0;for(;e.offsetParent&&(i+=e[r],e.offsetParent!==t);){if(e.offsetParent.contains(t)){i-=t[r];break}e=e.offsetParent}return i}function jP(t,e){if(t&&document.contains(t)){let o=document.scrollingElement||document.documentElement;if(window.getComputedStyle(o).overflow==="hidden"){let l=Wse(t);for(let c of l)R$(c,t)}else{var n;let{left:l,top:c}=t.getBoundingClientRect();t==null||(n=t.scrollIntoView)===null||n===void 0||n.call(t,{block:"nearest"});let{left:f,top:u}=t.getBoundingClientRect();if(Math.abs(l-f)>1||Math.abs(c-u)>1){var r,i,a;e==null||(i=e.containingElement)===null||i===void 0||(r=i.scrollIntoView)===null||r===void 0||r.call(i,{block:"center",inline:"center"}),(a=t.scrollIntoView)===null||a===void 0||a.call(t,{block:"nearest"})}}}}function sC(t){return t.pointerType===""&&t.isTrusted?!0:I9()&&t.pointerType?t.type==="click"&&t.buttons===1:t.detail===0&&!t.pointerType}function P$(t){return!I9()&&t.width===0&&t.height===0||t.width===1&&t.height===1&&t.pressure===0&&t.detail===0&&t.pointerType==="mouse"}function Kse(t,e,n){let r=Sr(()=>{n&&n(e)});H.useEffect(()=>{var i;let a=t==null||(i=t.current)===null||i===void 0?void 0:i.form;return a?.addEventListener("reset",r),()=>{a?.removeEventListener("reset",r)}},[t,r])}const qse="react-aria-clear-focus",Xse="react-aria-focus";function Yp(t){return gu()?t.metaKey:t.ctrlKey}const Yse=typeof Element<"u"&&"checkVisibility"in Element.prototype;function Jse(t){const e=Za(t);if(!(t instanceof e.HTMLElement)&&!(t instanceof e.SVGElement))return!1;let{display:n,visibility:r}=t.style,i=n!=="none"&&r!=="hidden"&&r!=="collapse";if(i){const{getComputedStyle:a}=t.ownerDocument.defaultView;let{display:o,visibility:s}=a(t);i=o!=="none"&&s!=="hidden"&&s!=="collapse"}return i}function Zse(t,e){return!t.hasAttribute("hidden")&&!t.hasAttribute("data-react-aria-prevent-focus")&&(t.nodeName==="DETAILS"&&e&&e.nodeName!=="SUMMARY"?t.hasAttribute("open"):!0)}function A9(t,e){return Yse?t.checkVisibility()&&!t.closest("[data-react-aria-prevent-focus]"):t.nodeName!=="#comment"&&Jse(t)&&Zse(t,e)&&(!t.parentElement||A9(t.parentElement,t))}const N9=["input:not([disabled]):not([type=hidden])","select:not([disabled])","textarea:not([disabled])","button:not([disabled])","a[href]","area[href]","summary","iframe","object","embed","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable^="false"])',"permission"],Qse=N9.join(":not([hidden]),")+",[tabindex]:not([disabled]):not([hidden])";N9.push('[tabindex]:not([tabindex="-1"]):not([disabled])');const ele=N9.join(':not([hidden]):not([tabindex="-1"]),');function lC(t){return t.matches(Qse)&&A9(t)&&!N$(t)}function A$(t){return t.matches(ele)&&A9(t)&&!N$(t)}function N$(t){let e=t;for(;e!=null;){if(e instanceof e.ownerDocument.defaultView.HTMLElement&&e.inert)return!0;e=e.parentElement}return!1}function Om(t,e,n){let[r,i]=H.useState(t||e),a=H.useRef(t!==void 0),o=t!==void 0;H.useEffect(()=>{a.current,a.current=o},[o]);let s=o?t:r,l=H.useCallback((c,...f)=>{let u=(d,...h)=>{n&&(Object.is(s,d)||n(d,...h)),o||(s=d)};typeof c=="function"?i((h,...p)=>{let g=c(o?s:h,...p);return u(g,...f),o?h:g}):(o||i(c),u(c,...f))},[o,s,n]);return[s,l]}function t6(t,e=-1/0,n=1/0){return Math.min(Math.max(t,e),n)}let DT=new Map;function tle(t){let{locale:e}=D9(),n=e+(t?Object.entries(t).sort((i,a)=>i[0]<a[0]?-1:1).join():"");if(DT.has(n))return DT.get(n);let r=new Intl.Collator(e,t);return DT.set(n,r),r}const S2=H.createContext({});function cC(t){const e=H.useRef(null);return e.current===null&&(e.current=t()),e.current}const L9=typeof window<"u",k9=L9?H.useLayoutEffect:H.useEffect,gy=H.createContext(null);function V9(t,e){t.indexOf(e)===-1&&t.push(e)}function F9(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}function GHe([...t],e,n){const r=e<0?t.length+e:e;if(r>=0&&r<t.length){const i=n<0?t.length+n:n,[a]=t.splice(e,1);t.splice(i,0,a)}return t}const kf=(t,e,n)=>n>e?e:n<t?t:n;let jHe=()=>{},U9=()=>{};const mu={},L$=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t);function k$(t){return typeof t=="object"&&t!==null}const V$=t=>/^0[^.\s]+$/u.test(t);function B9(t){let e;return()=>(e===void 0&&(e=t()),e)}const kl=t=>t,nle=(t,e)=>n=>e(t(n)),my=(...t)=>t.reduce(nle),T2=(t,e,n)=>{const r=e-t;return r===0?1:(n-t)/r};class $9{constructor(){this.subscriptions=[]}add(e){return V9(this.subscriptions,e),()=>F9(this.subscriptions,e)}notify(e,n,r){const i=this.subscriptions.length;if(i)if(i===1)this.subscriptions[0](e,n,r);else for(let a=0;a<i;a++){const o=this.subscriptions[a];o&&o(e,n,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const au=t=>t*1e3,ou=t=>t/1e3;function F$(t,e){return e?t*(1e3/e):0}const U$=(t,e,n)=>(((1-3*n+3*e)*t+(3*n-6*e))*t+3*e)*t,rle=1e-7,ile=12;function ale(t,e,n,r,i){let a,o,s=0;do o=e+(n-e)/2,a=U$(o,r,i)-t,a>0?n=o:e=o;while(Math.abs(a)>rle&&++s<ile);return o}function vy(t,e,n,r){if(t===e&&n===r)return kl;const i=a=>ale(a,0,1,t,n);return a=>a===0||a===1?a:U$(i(a),e,r)}const B$=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,$$=t=>e=>1-t(1-e),G$=vy(.33,1.53,.69,.99),G9=$$(G$),j$=B$(G9),z$=t=>(t*=2)<1?.5*G9(t):.5*(2-Math.pow(2,-10*(t-1))),j9=t=>1-Math.sin(Math.acos(t)),W$=$$(j9),H$=B$(j9),ole=vy(.42,0,1,1),sle=vy(0,0,.58,1),K$=vy(.42,0,.58,1),lle=t=>Array.isArray(t)&&typeof t[0]!="number",q$=t=>Array.isArray(t)&&typeof t[0]=="number",cle={linear:kl,easeIn:ole,easeInOut:K$,easeOut:sle,circIn:j9,circInOut:H$,circOut:W$,backIn:G9,backInOut:j$,backOut:G$,anticipate:z$},ule=t=>typeof t=="string",zP=t=>{if(q$(t)){U9(t.length===4);const[e,n,r,i]=t;return vy(e,n,r,i)}else if(ule(t))return cle[t];return t},tx=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"],Qc={value:null,addProjectionMetrics:null};function fle(t,e){let n=new Set,r=new Set,i=!1,a=!1;const o=new WeakSet;let s={delta:0,timestamp:0,isProcessing:!1},l=0;function c(u){o.has(u)&&(f.schedule(u),t()),l++,u(s)}const f={schedule:(u,d=!1,h=!1)=>{const g=h&&i?n:r;return d&&o.add(u),g.has(u)||g.add(u),u},cancel:u=>{r.delete(u),o.delete(u)},process:u=>{if(s=u,i){a=!0;return}i=!0,[n,r]=[r,n],n.forEach(c),e&&Qc.value&&Qc.value.frameloop[e].push(l),l=0,n.clear(),i=!1,a&&(a=!1,f.process(u))}};return f}const dle=40;function X$(t,e){let n=!1,r=!0;const i={delta:0,timestamp:0,isProcessing:!1},a=()=>n=!0,o=tx.reduce((x,w)=>(x[w]=fle(a,e?w:void 0),x),{}),{setup:s,read:l,resolveKeyframes:c,preUpdate:f,update:u,preRender:d,render:h,postRender:p}=o,g=()=>{const x=mu.useManualTiming?i.timestamp:performance.now();n=!1,mu.useManualTiming||(i.delta=r?1e3/60:Math.max(Math.min(x-i.timestamp,dle),1)),i.timestamp=x,i.isProcessing=!0,s.process(i),l.process(i),c.process(i),f.process(i),u.process(i),d.process(i),h.process(i),p.process(i),i.isProcessing=!1,n&&e&&(r=!1,t(g))},m=()=>{n=!0,r=!0,i.isProcessing||t(g)};return{schedule:tx.reduce((x,w)=>{const S=o[w];return x[w]=(T,_=!1,D=!1)=>(n||m(),S.schedule(T,_,D)),x},{}),cancel:x=>{for(let w=0;w<tx.length;w++)o[tx[w]].cancel(x)},state:i,steps:o}}const{schedule:gi,cancel:Qd,state:uo,steps:OT}=X$(typeof requestAnimationFrame<"u"?requestAnimationFrame:kl,!0);let Db;function hle(){Db=void 0}const Es={now:()=>(Db===void 0&&Es.set(uo.isProcessing||mu.useManualTiming?uo.timestamp:performance.now()),Db),set:t=>{Db=t,queueMicrotask(hle)}},xh={layout:0,mainThread:0,waapi:0},Y$=t=>e=>typeof e=="string"&&e.startsWith(t),z9=Y$("--"),ple=Y$("var(--"),W9=t=>ple(t)?gle.test(t.split("/*")[0].trim()):!1,gle=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,Mm={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},E2={...Mm,transform:t=>kf(0,1,t)},nx={...Mm,default:1},Hv=t=>Math.round(t*1e5)/1e5,H9=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function mle(t){return t==null}const vle=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,K9=(t,e)=>n=>!!(typeof n=="string"&&vle.test(n)&&n.startsWith(t)||e&&!mle(n)&&Object.prototype.hasOwnProperty.call(n,e)),J$=(t,e,n)=>r=>{if(typeof r!="string")return r;const[i,a,o,s]=r.match(H9);return{[t]:parseFloat(i),[e]:parseFloat(a),[n]:parseFloat(o),alpha:s!==void 0?parseFloat(s):1}},yle=t=>kf(0,255,t),MT={...Mm,transform:t=>Math.round(yle(t))},oh={test:K9("rgb","red"),parse:J$("red","green","blue"),transform:({red:t,green:e,blue:n,alpha:r=1})=>"rgba("+MT.transform(t)+", "+MT.transform(e)+", "+MT.transform(n)+", "+Hv(E2.transform(r))+")"};function xle(t){let e="",n="",r="",i="";return t.length>5?(e=t.substring(1,3),n=t.substring(3,5),r=t.substring(5,7),i=t.substring(7,9)):(e=t.substring(1,2),n=t.substring(2,3),r=t.substring(3,4),i=t.substring(4,5),e+=e,n+=n,r+=r,i+=i),{red:parseInt(e,16),green:parseInt(n,16),blue:parseInt(r,16),alpha:i?parseInt(i,16)/255:1}}const n6={test:K9("#"),parse:xle,transform:oh.transform},yy=t=>({test:e=>typeof e=="string"&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),Td=yy("deg"),su=yy("%"),Cn=yy("px"),ble=yy("vh"),wle=yy("vw"),WP={...su,parse:t=>su.parse(t)/100,transform:t=>su.transform(t*100)},tg={test:K9("hsl","hue"),parse:J$("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:n,alpha:r=1})=>"hsla("+Math.round(t)+", "+su.transform(Hv(e))+", "+su.transform(Hv(n))+", "+Hv(E2.transform(r))+")"},ba={test:t=>oh.test(t)||n6.test(t)||tg.test(t),parse:t=>oh.test(t)?oh.parse(t):tg.test(t)?tg.parse(t):n6.parse(t),transform:t=>typeof t=="string"?t:t.hasOwnProperty("red")?oh.transform(t):tg.transform(t),getAnimatableNone:t=>{const e=ba.parse(t);return e.alpha=0,ba.transform(e)}},Cle=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function Sle(t){return isNaN(t)&&typeof t=="string"&&(t.match(H9)?.length||0)+(t.match(Cle)?.length||0)>0}const Z$="number",Q$="color",Tle="var",Ele="var(",HP="${}",_le=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function _2(t){const e=t.toString(),n=[],r={color:[],number:[],var:[]},i=[];let a=0;const s=e.replace(_le,l=>(ba.test(l)?(r.color.push(a),i.push(Q$),n.push(ba.parse(l))):l.startsWith(Ele)?(r.var.push(a),i.push(Tle),n.push(l)):(r.number.push(a),i.push(Z$),n.push(parseFloat(l))),++a,HP)).split(HP);return{values:n,split:s,indexes:r,types:i}}function eG(t){return _2(t).values}function tG(t){const{split:e,types:n}=_2(t),r=e.length;return i=>{let a="";for(let o=0;o<r;o++)if(a+=e[o],i[o]!==void 0){const s=n[o];s===Z$?a+=Hv(i[o]):s===Q$?a+=ba.transform(i[o]):a+=i[o]}return a}}const Dle=t=>typeof t=="number"?0:ba.test(t)?ba.getAnimatableNone(t):t;function Ole(t){const e=eG(t);return tG(t)(e.map(Dle))}const e0={test:Sle,parse:eG,createTransformer:tG,getAnimatableNone:Ole};function IT(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function Mle({hue:t,saturation:e,lightness:n,alpha:r}){t/=360,e/=100,n/=100;let i=0,a=0,o=0;if(!e)i=a=o=n;else{const s=n<.5?n*(1+e):n+e-n*e,l=2*n-s;i=IT(l,s,t+1/3),a=IT(l,s,t),o=IT(l,s,t-1/3)}return{red:Math.round(i*255),green:Math.round(a*255),blue:Math.round(o*255),alpha:r}}function Sw(t,e){return n=>n>0?e:t}const Pi=(t,e,n)=>t+(e-t)*n,RT=(t,e,n)=>{const r=t*t,i=n*(e*e-r)+r;return i<0?0:Math.sqrt(i)},Ile=[n6,oh,tg],Rle=t=>Ile.find(e=>e.test(t));function KP(t){const e=Rle(t);if(!e)return!1;let n=e.parse(t);return e===tg&&(n=Mle(n)),n}const qP=(t,e)=>{const n=KP(t),r=KP(e);if(!n||!r)return Sw(t,e);const i={...n};return a=>(i.red=RT(n.red,r.red,a),i.green=RT(n.green,r.green,a),i.blue=RT(n.blue,r.blue,a),i.alpha=Pi(n.alpha,r.alpha,a),oh.transform(i))},r6=new Set(["none","hidden"]);function Ple(t,e){return r6.has(t)?n=>n<=0?t:e:n=>n>=1?e:t}function Ale(t,e){return n=>Pi(t,e,n)}function q9(t){return typeof t=="number"?Ale:typeof t=="string"?W9(t)?Sw:ba.test(t)?qP:kle:Array.isArray(t)?nG:typeof t=="object"?ba.test(t)?qP:Nle:Sw}function nG(t,e){const n=[...t],r=n.length,i=t.map((a,o)=>q9(a)(a,e[o]));return a=>{for(let o=0;o<r;o++)n[o]=i[o](a);return n}}function Nle(t,e){const n={...t,...e},r={};for(const i in n)t[i]!==void 0&&e[i]!==void 0&&(r[i]=q9(t[i])(t[i],e[i]));return i=>{for(const a in r)n[a]=r[a](i);return n}}function Lle(t,e){const n=[],r={color:0,var:0,number:0};for(let i=0;i<e.values.length;i++){const a=e.types[i],o=t.indexes[a][r[a]],s=t.values[o]??0;n[i]=s,r[a]++}return n}const kle=(t,e)=>{const n=e0.createTransformer(e),r=_2(t),i=_2(e);return r.indexes.var.length===i.indexes.var.length&&r.indexes.color.length===i.indexes.color.length&&r.indexes.number.length>=i.indexes.number.length?r6.has(t)&&!i.values.length||r6.has(e)&&!r.values.length?Ple(t,e):my(nG(Lle(r,i),i.values),n):Sw(t,e)};function rG(t,e,n){return typeof t=="number"&&typeof e=="number"&&typeof n=="number"?Pi(t,e,n):q9(t)(t,e)}const Vle=t=>{const e=({timestamp:n})=>t(n);return{start:(n=!0)=>gi.update(e,n),stop:()=>Qd(e),now:()=>uo.isProcessing?uo.timestamp:Es.now()}},iG=(t,e,n=10)=>{let r="";const i=Math.max(Math.round(e/n),2);for(let a=0;a<i;a++)r+=Math.round(t(a/(i-1))*1e4)/1e4+", ";return`linear(${r.substring(0,r.length-2)})`},Tw=2e4;function X9(t){let e=0;const n=50;let r=t.next(e);for(;!r.done&&e<Tw;)e+=n,r=t.next(e);return e>=Tw?1/0:e}function Fle(t,e=100,n){const r=n({...t,keyframes:[0,e]}),i=Math.min(X9(r),Tw);return{type:"keyframes",ease:a=>r.next(i*a).value/e,duration:ou(i)}}const Ule=5;function aG(t,e,n){const r=Math.max(e-Ule,0);return F$(n-t(r),e-r)}const qi={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},PT=.001;function Ble({duration:t=qi.duration,bounce:e=qi.bounce,velocity:n=qi.velocity,mass:r=qi.mass}){let i,a,o=1-e;o=kf(qi.minDamping,qi.maxDamping,o),t=kf(qi.minDuration,qi.maxDuration,ou(t)),o<1?(i=c=>{const f=c*o,u=f*t,d=f-n,h=i6(c,o),p=Math.exp(-u);return PT-d/h*p},a=c=>{const u=c*o*t,d=u*n+n,h=Math.pow(o,2)*Math.pow(c,2)*t,p=Math.exp(-u),g=i6(Math.pow(c,2),o);return(-i(c)+PT>0?-1:1)*((d-h)*p)/g}):(i=c=>{const f=Math.exp(-c*t),u=(c-n)*t+1;return-PT+f*u},a=c=>{const f=Math.exp(-c*t),u=(n-c)*(t*t);return f*u});const s=5/t,l=Gle(i,a,s);if(t=au(t),isNaN(l))return{stiffness:qi.stiffness,damping:qi.damping,duration:t};{const c=Math.pow(l,2)*r;return{stiffness:c,damping:o*2*Math.sqrt(r*c),duration:t}}}const $le=12;function Gle(t,e,n){let r=n;for(let i=1;i<$le;i++)r=r-t(r)/e(r);return r}function i6(t,e){return t*Math.sqrt(1-e*e)}const jle=["duration","bounce"],zle=["stiffness","damping","mass"];function XP(t,e){return e.some(n=>t[n]!==void 0)}function Wle(t){let e={velocity:qi.velocity,stiffness:qi.stiffness,damping:qi.damping,mass:qi.mass,isResolvedFromDuration:!1,...t};if(!XP(t,zle)&&XP(t,jle))if(t.visualDuration){const n=t.visualDuration,r=2*Math.PI/(n*1.2),i=r*r,a=2*kf(.05,1,1-(t.bounce||0))*Math.sqrt(i);e={...e,mass:qi.mass,stiffness:i,damping:a}}else{const n=Ble(t);e={...e,...n,mass:qi.mass},e.isResolvedFromDuration=!0}return e}function Ew(t=qi.visualDuration,e=qi.bounce){const n=typeof t!="object"?{visualDuration:t,keyframes:[0,1],bounce:e}:t;let{restSpeed:r,restDelta:i}=n;const a=n.keyframes[0],o=n.keyframes[n.keyframes.length-1],s={done:!1,value:a},{stiffness:l,damping:c,mass:f,duration:u,velocity:d,isResolvedFromDuration:h}=Wle({...n,velocity:-ou(n.velocity||0)}),p=d||0,g=c/(2*Math.sqrt(l*f)),m=o-a,y=ou(Math.sqrt(l/f)),v=Math.abs(m)<5;r||(r=v?qi.restSpeed.granular:qi.restSpeed.default),i||(i=v?qi.restDelta.granular:qi.restDelta.default);let x;if(g<1){const S=i6(y,g);x=T=>{const _=Math.exp(-g*y*T);return o-_*((p+g*y*m)/S*Math.sin(S*T)+m*Math.cos(S*T))}}else if(g===1)x=S=>o-Math.exp(-y*S)*(m+(p+y*m)*S);else{const S=y*Math.sqrt(g*g-1);x=T=>{const _=Math.exp(-g*y*T),D=Math.min(S*T,300);return o-_*((p+g*y*m)*Math.sinh(D)+S*m*Math.cosh(D))/S}}const w={calculatedDuration:h&&u||null,next:S=>{const T=x(S);if(h)s.done=S>=u;else{let _=S===0?p:0;g<1&&(_=S===0?au(p):aG(x,S,T));const D=Math.abs(_)<=r,I=Math.abs(o-T)<=i;s.done=D&&I}return s.value=s.done?o:T,s},toString:()=>{const S=Math.min(X9(w),Tw),T=iG(_=>w.next(S*_).value,S,30);return S+"ms "+T},toTransition:()=>{}};return w}Ew.applyToOptions=t=>{const e=Fle(t,100,Ew);return t.ease=e.ease,t.duration=au(e.duration),t.type="keyframes",t};function a6({keyframes:t,velocity:e=0,power:n=.8,timeConstant:r=325,bounceDamping:i=10,bounceStiffness:a=500,modifyTarget:o,min:s,max:l,restDelta:c=.5,restSpeed:f}){const u=t[0],d={done:!1,value:u},h=D=>s!==void 0&&D<s||l!==void 0&&D>l,p=D=>s===void 0?l:l===void 0||Math.abs(s-D)<Math.abs(l-D)?s:l;let g=n*e;const m=u+g,y=o===void 0?m:o(m);y!==m&&(g=y-u);const v=D=>-g*Math.exp(-D/r),x=D=>y+v(D),w=D=>{const I=v(D),R=x(D);d.done=Math.abs(I)<=c,d.value=d.done?y:R};let S,T;const _=D=>{h(d.value)&&(S=D,T=Ew({keyframes:[d.value,p(d.value)],velocity:aG(x,D,d.value),damping:i,stiffness:a,restDelta:c,restSpeed:f}))};return _(0),{calculatedDuration:null,next:D=>{let I=!1;return!T&&S===void 0&&(I=!0,w(D),_(D)),S!==void 0&&D>=S?T.next(D-S):(!I&&w(D),d)}}}function Hle(t,e,n){const r=[],i=n||mu.mix||rG,a=t.length-1;for(let o=0;o<a;o++){let s=i(t[o],t[o+1]);if(e){const l=Array.isArray(e)?e[o]||kl:e;s=my(l,s)}r.push(s)}return r}function Kle(t,e,{clamp:n=!0,ease:r,mixer:i}={}){const a=t.length;if(U9(a===e.length),a===1)return()=>e[0];if(a===2&&e[0]===e[1])return()=>e[1];const o=t[0]===t[1];t[0]>t[a-1]&&(t=[...t].reverse(),e=[...e].reverse());const s=Hle(e,r,i),l=s.length,c=f=>{if(o&&f<t[0])return e[0];let u=0;if(l>1)for(;u<t.length-2&&!(f<t[u+1]);u++);const d=T2(t[u],t[u+1],f);return s[u](d)};return n?f=>c(kf(t[0],t[a-1],f)):c}function qle(t,e){const n=t[t.length-1];for(let r=1;r<=e;r++){const i=T2(0,e,r);t.push(Pi(n,1,i))}}function Xle(t){const e=[0];return qle(e,t.length-1),e}function Yle(t,e){return t.map(n=>n*e)}function Jle(t,e){return t.map(()=>e||K$).splice(0,t.length-1)}function Kv({duration:t=300,keyframes:e,times:n,ease:r="easeInOut"}){const i=lle(r)?r.map(zP):zP(r),a={done:!1,value:e[0]},o=Yle(n&&n.length===e.length?n:Xle(e),t),s=Kle(o,e,{ease:Array.isArray(i)?i:Jle(e,i)});return{calculatedDuration:t,next:l=>(a.value=s(l),a.done=l>=t,a)}}const Zle=t=>t!==null;function Y9(t,{repeat:e,repeatType:n="loop"},r,i=1){const a=t.filter(Zle),s=i<0||e&&n!=="loop"&&e%2===1?0:a.length-1;return!s||r===void 0?a[s]:r}const Qle={decay:a6,inertia:a6,tween:Kv,keyframes:Kv,spring:Ew};function oG(t){typeof t.type=="string"&&(t.type=Qle[t.type])}class J9{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(e=>{this.resolve=e})}notifyFinished(){this.resolve()}then(e,n){return this.finished.then(e,n)}}const ece=t=>t/100;class uC extends J9{constructor(e){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:n}=this.options;n&&n.updatedAt!==Es.now()&&this.tick(Es.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),this.options.onStop?.())},xh.mainThread++,this.options=e,this.initAnimation(),this.play(),e.autoplay===!1&&this.pause()}initAnimation(){const{options:e}=this;oG(e);const{type:n=Kv,repeat:r=0,repeatDelay:i=0,repeatType:a,velocity:o=0}=e;let{keyframes:s}=e;const l=n||Kv;l!==Kv&&typeof s[0]!="number"&&(this.mixKeyframes=my(ece,rG(s[0],s[1])),s=[0,100]);const c=l({...e,keyframes:s});a==="mirror"&&(this.mirroredGenerator=l({...e,keyframes:[...s].reverse(),velocity:-o})),c.calculatedDuration===null&&(c.calculatedDuration=X9(c));const{calculatedDuration:f}=c;this.calculatedDuration=f,this.resolvedDuration=f+i,this.totalDuration=this.resolvedDuration*(r+1)-i,this.generator=c}updateTime(e){const n=Math.round(e-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=n}tick(e,n=!1){const{generator:r,totalDuration:i,mixKeyframes:a,mirroredGenerator:o,resolvedDuration:s,calculatedDuration:l}=this;if(this.startTime===null)return r.next(0);const{delay:c=0,keyframes:f,repeat:u,repeatType:d,repeatDelay:h,type:p,onUpdate:g,finalKeyframe:m}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-i/this.speed,this.startTime)),n?this.currentTime=e:this.updateTime(e);const y=this.currentTime-c*(this.playbackSpeed>=0?1:-1),v=this.playbackSpeed>=0?y<0:y>i;this.currentTime=Math.max(y,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=i);let x=this.currentTime,w=r;if(u){const D=Math.min(this.currentTime,i)/s;let I=Math.floor(D),R=D%1;!R&&D>=1&&(R=1),R===1&&I--,I=Math.min(I,u+1),!!(I%2)&&(d==="reverse"?(R=1-R,h&&(R-=h/s)):d==="mirror"&&(w=o)),x=kf(0,1,R)*s}const S=v?{done:!1,value:f[0]}:w.next(x);a&&(S.value=a(S.value));let{done:T}=S;!v&&l!==null&&(T=this.playbackSpeed>=0?this.currentTime>=i:this.currentTime<=0);const _=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&T);return _&&p!==a6&&(S.value=Y9(f,this.options,m,this.speed)),g&&g(S.value),_&&this.finish(),S}then(e,n){return this.finished.then(e,n)}get duration(){return ou(this.calculatedDuration)}get time(){return ou(this.currentTime)}set time(e){e=au(e),this.currentTime=e,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.playbackSpeed),this.driver?.start(!1)}get speed(){return this.playbackSpeed}set speed(e){this.updateTime(Es.now());const n=this.playbackSpeed!==e;this.playbackSpeed=e,n&&(this.time=ou(this.currentTime))}play(){if(this.isStopped)return;const{driver:e=Vle,startTime:n}=this.options;this.driver||(this.driver=e(i=>this.tick(i))),this.options.onPlay?.();const r=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=r):this.holdTime!==null?this.startTime=r-this.holdTime:this.startTime||(this.startTime=n??r),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(Es.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished",this.options.onComplete?.()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),this.options.onCancel?.()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null,xh.mainThread--}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}attachTimeline(e){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),this.driver?.stop(),e.observe(this)}}function zHe(t){return new uC(t)}function tce(t){for(let e=1;e<t.length;e++)t[e]??(t[e]=t[e-1])}const sh=t=>t*180/Math.PI,o6=t=>{const e=sh(Math.atan2(t[1],t[0]));return s6(e)},nce={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:t=>(Math.abs(t[0])+Math.abs(t[3]))/2,rotate:o6,rotateZ:o6,skewX:t=>sh(Math.atan(t[1])),skewY:t=>sh(Math.atan(t[2])),skew:t=>(Math.abs(t[1])+Math.abs(t[2]))/2},s6=t=>(t=t%360,t<0&&(t+=360),t),YP=o6,JP=t=>Math.sqrt(t[0]*t[0]+t[1]*t[1]),ZP=t=>Math.sqrt(t[4]*t[4]+t[5]*t[5]),rce={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:JP,scaleY:ZP,scale:t=>(JP(t)+ZP(t))/2,rotateX:t=>s6(sh(Math.atan2(t[6],t[5]))),rotateY:t=>s6(sh(Math.atan2(-t[2],t[0]))),rotateZ:YP,rotate:YP,skewX:t=>sh(Math.atan(t[4])),skewY:t=>sh(Math.atan(t[1])),skew:t=>(Math.abs(t[1])+Math.abs(t[4]))/2};function l6(t){return t.includes("scale")?1:0}function c6(t,e){if(!t||t==="none")return l6(e);const n=t.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let r,i;if(n)r=rce,i=n;else{const s=t.match(/^matrix\(([-\d.e\s,]+)\)$/u);r=nce,i=s}if(!i)return l6(e);const a=r[e],o=i[1].split(",").map(ace);return typeof a=="function"?a(o):o[a]}const ice=(t,e)=>{const{transform:n="none"}=getComputedStyle(t);return c6(n,e)};function ace(t){return parseFloat(t.trim())}const Im=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Rm=new Set(Im),QP=t=>t===Mm||t===Cn,oce=new Set(["x","y","z"]),sce=Im.filter(t=>!oce.has(t));function lce(t){const e=[];return sce.forEach(n=>{const r=t.getValue(n);r!==void 0&&(e.push([n,r.get()]),r.set(n.startsWith("scale")?1:0))}),e}const bh={width:({x:t},{paddingLeft:e="0",paddingRight:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),height:({y:t},{paddingTop:e="0",paddingBottom:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:(t,{transform:e})=>c6(e,"x"),y:(t,{transform:e})=>c6(e,"y")};bh.translateX=bh.x;bh.translateY=bh.y;const wh=new Set;let u6=!1,f6=!1,d6=!1;function sG(){if(f6){const t=Array.from(wh).filter(r=>r.needsMeasurement),e=new Set(t.map(r=>r.element)),n=new Map;e.forEach(r=>{const i=lce(r);i.length&&(n.set(r,i),r.render())}),t.forEach(r=>r.measureInitialState()),e.forEach(r=>{r.render();const i=n.get(r);i&&i.forEach(([a,o])=>{r.getValue(a)?.set(o)})}),t.forEach(r=>r.measureEndState()),t.forEach(r=>{r.suspendedScrollY!==void 0&&window.scrollTo(0,r.suspendedScrollY)})}f6=!1,u6=!1,wh.forEach(t=>t.complete(d6)),wh.clear()}function lG(){wh.forEach(t=>{t.readKeyframes(),t.needsMeasurement&&(f6=!0)})}function cce(){d6=!0,lG(),sG(),d6=!1}class Z9{constructor(e,n,r,i,a,o=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...e],this.onComplete=n,this.name=r,this.motionValue=i,this.element=a,this.isAsync=o}scheduleResolve(){this.state="scheduled",this.isAsync?(wh.add(this),u6||(u6=!0,gi.read(lG),gi.resolveKeyframes(sG))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:n,element:r,motionValue:i}=this;if(e[0]===null){const a=i?.get(),o=e[e.length-1];if(a!==void 0)e[0]=a;else if(r&&n){const s=r.readValue(n,o);s!=null&&(e[0]=s)}e[0]===void 0&&(e[0]=o),i&&a===void 0&&i.set(e[0])}tce(e)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(e=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,e),wh.delete(this)}cancel(){this.state==="scheduled"&&(wh.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const uce=t=>t.startsWith("--");function fce(t,e,n){uce(e)?t.style.setProperty(e,n):t.style[e]=n}const dce=B9(()=>window.ScrollTimeline!==void 0),hce={};function pce(t,e){const n=B9(t);return()=>hce[e]??n()}const cG=pce(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),xv=([t,e,n,r])=>`cubic-bezier(${t}, ${e}, ${n}, ${r})`,eA={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:xv([0,.65,.55,1]),circOut:xv([.55,0,1,.45]),backIn:xv([.31,.01,.66,-.59]),backOut:xv([.33,1.53,.69,.99])};function uG(t,e){if(t)return typeof t=="function"?cG()?iG(t,e):"ease-out":q$(t)?xv(t):Array.isArray(t)?t.map(n=>uG(n,e)||eA.easeOut):eA[t]}function gce(t,e,n,{delay:r=0,duration:i=300,repeat:a=0,repeatType:o="loop",ease:s="easeOut",times:l}={},c=void 0){const f={[e]:n};l&&(f.offset=l);const u=uG(s,i);Array.isArray(u)&&(f.easing=u),Qc.value&&xh.waapi++;const d={delay:r,duration:i,easing:Array.isArray(u)?"linear":u,fill:"both",iterations:a+1,direction:o==="reverse"?"alternate":"normal"};c&&(d.pseudoElement=c);const h=t.animate(f,d);return Qc.value&&h.finished.finally(()=>{xh.waapi--}),h}function fG(t){return typeof t=="function"&&"applyToOptions"in t}function mce({type:t,...e}){return fG(t)&&cG()?t.applyToOptions(e):(e.duration??(e.duration=300),e.ease??(e.ease="easeOut"),e)}class vce extends J9{constructor(e){if(super(),this.finishedTime=null,this.isStopped=!1,!e)return;const{element:n,name:r,keyframes:i,pseudoElement:a,allowFlatten:o=!1,finalKeyframe:s,onComplete:l}=e;this.isPseudoElement=!!a,this.allowFlatten=o,this.options=e,U9(typeof e.type!="string");const c=mce(e);this.animation=gce(n,r,i,c,a),c.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!a){const f=Y9(i,this.options,s,this.speed);this.updateMotionValue?this.updateMotionValue(f):fce(n,r,f),this.animation.cancel()}l?.(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){this.animation.finish?.()}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:e}=this;e==="idle"||e==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){this.isPseudoElement||this.animation.commitStyles?.()}get duration(){const e=this.animation.effect?.getComputedTiming?.().duration||0;return ou(Number(e))}get time(){return ou(Number(this.animation.currentTime)||0)}set time(e){this.finishedTime=null,this.animation.currentTime=au(e)}get speed(){return this.animation.playbackRate}set speed(e){e<0&&(this.finishedTime=null),this.animation.playbackRate=e}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(e){this.animation.startTime=e}attachTimeline({timeline:e,observe:n}){return this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"}),this.animation.onfinish=null,e&&dce()?(this.animation.timeline=e,kl):n(this)}}const dG={anticipate:z$,backInOut:j$,circInOut:H$};function yce(t){return t in dG}function xce(t){typeof t.ease=="string"&&yce(t.ease)&&(t.ease=dG[t.ease])}const tA=10;class bce extends vce{constructor(e){xce(e),oG(e),super(e),e.startTime&&(this.startTime=e.startTime),this.options=e}updateMotionValue(e){const{motionValue:n,onUpdate:r,onComplete:i,element:a,...o}=this.options;if(!n)return;if(e!==void 0){n.set(e);return}const s=new uC({...o,autoplay:!1}),l=au(this.finishedTime??this.time);n.setWithVelocity(s.sample(l-tA).value,s.sample(l).value,tA),s.stop()}}const nA=(t,e)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(e0.test(t)||t==="0")&&!t.startsWith("url("));function wce(t){const e=t[0];if(t.length===1)return!0;for(let n=0;n<t.length;n++)if(t[n]!==e)return!0}function Cce(t,e,n,r){const i=t[0];if(i===null)return!1;if(e==="display"||e==="visibility")return!0;const a=t[t.length-1],o=nA(i,e),s=nA(a,e);return!o||!s?!1:wce(t)||(n==="spring"||fG(n))&&r}function h6(t){t.duration=0,t.type}const Sce=new Set(["opacity","clipPath","filter","transform"]),Tce=B9(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function Ece(t){const{motionValue:e,name:n,repeatDelay:r,repeatType:i,damping:a,type:o}=t;if(!(e?.owner?.current instanceof HTMLElement))return!1;const{onUpdate:l,transformTemplate:c}=e.owner.getProps();return Tce()&&n&&Sce.has(n)&&(n!=="transform"||!c)&&!l&&!r&&i!=="mirror"&&a!==0&&o!=="inertia"}const _ce=40;class Dce extends J9{constructor({autoplay:e=!0,delay:n=0,type:r="keyframes",repeat:i=0,repeatDelay:a=0,repeatType:o="loop",keyframes:s,name:l,motionValue:c,element:f,...u}){super(),this.stop=()=>{this._animation&&(this._animation.stop(),this.stopTimeline?.()),this.keyframeResolver?.cancel()},this.createdAt=Es.now();const d={autoplay:e,delay:n,type:r,repeat:i,repeatDelay:a,repeatType:o,name:l,motionValue:c,element:f,...u},h=f?.KeyframeResolver||Z9;this.keyframeResolver=new h(s,(p,g,m)=>this.onKeyframesResolved(p,g,d,!m),l,c,f),this.keyframeResolver?.scheduleResolve()}onKeyframesResolved(e,n,r,i){this.keyframeResolver=void 0;const{name:a,type:o,velocity:s,delay:l,isHandoff:c,onUpdate:f}=r;this.resolvedAt=Es.now(),Cce(e,a,o,s)||((mu.instantAnimations||!l)&&f?.(Y9(e,r,n)),e[0]=e[e.length-1],h6(r),r.repeat=0);const d={startTime:i?this.resolvedAt?this.resolvedAt-this.createdAt>_ce?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:n,...r,keyframes:e},h=!c&&Ece(d)?new bce({...d,element:d.motionValue.owner.current}):new uC(d);h.finished.then(()=>this.notifyFinished()).catch(kl),this.pendingTimeline&&(this.stopTimeline=h.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=h}get finished(){return this._animation?this.animation.finished:this._finished}then(e,n){return this.finished.finally(e).then(()=>{})}get animation(){return this._animation||(this.keyframeResolver?.resume(),cce()),this._animation}get duration(){return this.animation.duration}get time(){return this.animation.time}set time(e){this.animation.time=e}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(e){this.animation.speed=e}get startTime(){return this.animation.startTime}attachTimeline(e){return this._animation?this.stopTimeline=this.animation.attachTimeline(e):this.pendingTimeline=e,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this._animation&&this.animation.cancel(),this.keyframeResolver?.cancel()}}const Oce=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function Mce(t){const e=Oce.exec(t);if(!e)return[,];const[,n,r,i]=e;return[`--${n??r}`,i]}function hG(t,e,n=1){const[r,i]=Mce(t);if(!r)return;const a=window.getComputedStyle(e).getPropertyValue(r);if(a){const o=a.trim();return L$(o)?parseFloat(o):o}return W9(i)?hG(i,e,n+1):i}function Q9(t,e){return t?.[e]??t?.default??t}const pG=new Set(["width","height","top","left","right","bottom",...Im]),Ice={test:t=>t==="auto",parse:t=>t},gG=t=>e=>e.test(t),mG=[Mm,Cn,su,Td,wle,ble,Ice],rA=t=>mG.find(gG(t));function Rce(t){return typeof t=="number"?t===0:t!==null?t==="none"||t==="0"||V$(t):!0}const Pce=new Set(["brightness","contrast","saturate","opacity"]);function Ace(t){const[e,n]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[r]=n.match(H9)||[];if(!r)return t;const i=n.replace(r,"");let a=Pce.has(e)?1:0;return r!==n&&(a*=100),e+"("+a+i+")"}const Nce=/\b([a-z-]*)\(.*?\)/gu,p6={...e0,getAnimatableNone:t=>{const e=t.match(Nce);return e?e.map(Ace).join(" "):t}},iA={...Mm,transform:Math.round},Lce={rotate:Td,rotateX:Td,rotateY:Td,rotateZ:Td,scale:nx,scaleX:nx,scaleY:nx,scaleZ:nx,skew:Td,skewX:Td,skewY:Td,distance:Cn,translateX:Cn,translateY:Cn,translateZ:Cn,x:Cn,y:Cn,z:Cn,perspective:Cn,transformPerspective:Cn,opacity:E2,originX:WP,originY:WP,originZ:Cn},eD={borderWidth:Cn,borderTopWidth:Cn,borderRightWidth:Cn,borderBottomWidth:Cn,borderLeftWidth:Cn,borderRadius:Cn,radius:Cn,borderTopLeftRadius:Cn,borderTopRightRadius:Cn,borderBottomRightRadius:Cn,borderBottomLeftRadius:Cn,width:Cn,maxWidth:Cn,height:Cn,maxHeight:Cn,top:Cn,right:Cn,bottom:Cn,left:Cn,padding:Cn,paddingTop:Cn,paddingRight:Cn,paddingBottom:Cn,paddingLeft:Cn,margin:Cn,marginTop:Cn,marginRight:Cn,marginBottom:Cn,marginLeft:Cn,backgroundPositionX:Cn,backgroundPositionY:Cn,...Lce,zIndex:iA,fillOpacity:E2,strokeOpacity:E2,numOctaves:iA},kce={...eD,color:ba,backgroundColor:ba,outlineColor:ba,fill:ba,stroke:ba,borderColor:ba,borderTopColor:ba,borderRightColor:ba,borderBottomColor:ba,borderLeftColor:ba,filter:p6,WebkitFilter:p6},vG=t=>kce[t];function yG(t,e){let n=vG(t);return n!==p6&&(n=e0),n.getAnimatableNone?n.getAnimatableNone(e):void 0}const Vce=new Set(["auto","none","0"]);function Fce(t,e,n){let r=0,i;for(;r<t.length&&!i;){const a=t[r];typeof a=="string"&&!Vce.has(a)&&_2(a).values.length&&(i=t[r]),r++}if(i&&n)for(const a of e)t[a]=yG(n,i)}class Uce extends Z9{constructor(e,n,r,i,a){super(e,n,r,i,a,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:n,name:r}=this;if(!n||!n.current)return;super.readKeyframes();for(let l=0;l<e.length;l++){let c=e[l];if(typeof c=="string"&&(c=c.trim(),W9(c))){const f=hG(c,n.current);f!==void 0&&(e[l]=f),l===e.length-1&&(this.finalKeyframe=c)}}if(this.resolveNoneKeyframes(),!pG.has(r)||e.length!==2)return;const[i,a]=e,o=rA(i),s=rA(a);if(o!==s)if(QP(o)&&QP(s))for(let l=0;l<e.length;l++){const c=e[l];typeof c=="string"&&(e[l]=parseFloat(c))}else bh[r]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:n}=this,r=[];for(let i=0;i<e.length;i++)(e[i]===null||Rce(e[i]))&&r.push(i);r.length&&Fce(e,r,n)}measureInitialState(){const{element:e,unresolvedKeyframes:n,name:r}=this;if(!e||!e.current)return;r==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=bh[r](e.measureViewportBox(),window.getComputedStyle(e.current)),n[0]=this.measuredOrigin;const i=n[n.length-1];i!==void 0&&e.getValue(r,i).jump(i,!1)}measureEndState(){const{element:e,name:n,unresolvedKeyframes:r}=this;if(!e||!e.current)return;const i=e.getValue(n);i&&i.jump(this.measuredOrigin,!1);const a=r.length-1,o=r[a];r[a]=bh[n](e.measureViewportBox(),window.getComputedStyle(e.current)),o!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=o),this.removedTransforms?.length&&this.removedTransforms.forEach(([s,l])=>{e.getValue(s).set(l)}),this.resolveNoneKeyframes()}}function Bce(t,e,n){if(t instanceof EventTarget)return[t];if(typeof t=="string"){let r=document;e&&(r=e.current);const i=n?.[t]??r.querySelectorAll(t);return i?Array.from(i):[]}return Array.from(t)}const xG=(t,e)=>e&&typeof t=="number"?e.transform(t):t;function bG(t){return k$(t)&&"offsetHeight"in t}const aA=30,$ce=t=>!isNaN(parseFloat(t)),oA={current:void 0};class Gce{constructor(e,n={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=r=>{const i=Es.now();if(this.updatedAt!==i&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(r),this.current!==this.prev&&(this.events.change?.notify(this.current),this.dependents))for(const a of this.dependents)a.dirty()},this.hasAnimated=!1,this.setCurrent(e),this.owner=n.owner}setCurrent(e){this.current=e,this.updatedAt=Es.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=$ce(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,n){this.events[e]||(this.events[e]=new $9);const r=this.events[e].add(n);return e==="change"?()=>{r(),gi.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,n){this.passiveEffect=e,this.stopPassiveEffect=n}set(e){this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e)}setWithVelocity(e,n,r){this.set(n),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-r}jump(e,n=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,n&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){this.events.change?.notify(this.current)}addDependent(e){this.dependents||(this.dependents=new Set),this.dependents.add(e)}removeDependent(e){this.dependents&&this.dependents.delete(e)}get(){return oA.current&&oA.current.push(this),this.current}getPrevious(){return this.prev}getVelocity(){const e=Es.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>aA)return 0;const n=Math.min(this.updatedAt-this.prevUpdatedAt,aA);return F$(parseFloat(this.current)-parseFloat(this.prevFrameValue),n)}start(e){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=e(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.dependents?.clear(),this.events.destroy?.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function lm(t,e){return new Gce(t,e)}const{schedule:tD,cancel:WHe}=X$(queueMicrotask,!1),sc={x:!1,y:!1};function wG(){return sc.x||sc.y}function jce(t){return t==="x"||t==="y"?sc[t]?null:(sc[t]=!0,()=>{sc[t]=!1}):sc.x||sc.y?null:(sc.x=sc.y=!0,()=>{sc.x=sc.y=!1})}function CG(t,e){const n=Bce(t),r=new AbortController,i={passive:!0,...e,signal:r.signal};return[n,i,()=>r.abort()]}function sA(t){return!(t.pointerType==="touch"||wG())}function zce(t,e,n={}){const[r,i,a]=CG(t,n),o=s=>{if(!sA(s))return;const{target:l}=s,c=e(l,s);if(typeof c!="function"||!l)return;const f=u=>{sA(u)&&(c(u),l.removeEventListener("pointerleave",f))};l.addEventListener("pointerleave",f,i)};return r.forEach(s=>{s.addEventListener("pointerenter",o,i)}),a}const SG=(t,e)=>e?t===e?!0:SG(t,e.parentElement):!1,nD=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1,Wce=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function Hce(t){return Wce.has(t.tagName)||t.tabIndex!==-1}const Ob=new WeakSet;function lA(t){return e=>{e.key==="Enter"&&t(e)}}function AT(t,e){t.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const Kce=(t,e)=>{const n=t.currentTarget;if(!n)return;const r=lA(()=>{if(Ob.has(n))return;AT(n,"down");const i=lA(()=>{AT(n,"up")}),a=()=>AT(n,"cancel");n.addEventListener("keyup",i,e),n.addEventListener("blur",a,e)});n.addEventListener("keydown",r,e),n.addEventListener("blur",()=>n.removeEventListener("keydown",r),e)};function cA(t){return nD(t)&&!wG()}function qce(t,e,n={}){const[r,i,a]=CG(t,n),o=s=>{const l=s.currentTarget;if(!cA(s))return;Ob.add(l);const c=e(l,s),f=(h,p)=>{window.removeEventListener("pointerup",u),window.removeEventListener("pointercancel",d),Ob.has(l)&&Ob.delete(l),cA(h)&&typeof c=="function"&&c(h,{success:p})},u=h=>{f(h,l===window||l===document||n.useGlobalTarget||SG(l,h.target))},d=h=>{f(h,!1)};window.addEventListener("pointerup",u,i),window.addEventListener("pointercancel",d,i)};return r.forEach(s=>{(n.useGlobalTarget?window:s).addEventListener("pointerdown",o,i),bG(s)&&(s.addEventListener("focus",c=>Kce(c,i)),!Hce(s)&&!s.hasAttribute("tabindex")&&(s.tabIndex=0))}),a}function TG(t){return k$(t)&&"ownerSVGElement"in t}function Xce(t){return TG(t)&&t.tagName==="svg"}const Po=t=>!!(t&&t.getVelocity),Yce=[...mG,ba,e0],Jce=t=>Yce.find(gG(t)),D2=H.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"});class Zce extends H.Component{getSnapshotBeforeUpdate(e){const n=this.props.childRef.current;if(n&&e.isPresent&&!this.props.isPresent){const r=n.offsetParent,i=bG(r)&&r.offsetWidth||0,a=this.props.sizeRef.current;a.height=n.offsetHeight||0,a.width=n.offsetWidth||0,a.top=n.offsetTop,a.left=n.offsetLeft,a.right=i-a.width-a.left}return null}componentDidUpdate(){}render(){return this.props.children}}function Qce({children:t,isPresent:e,anchorX:n,root:r}){const i=H.useId(),a=H.useRef(null),o=H.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:s}=H.useContext(D2);return H.useInsertionEffect(()=>{const{width:l,height:c,top:f,left:u,right:d}=o.current;if(e||!a.current||!l||!c)return;const h=n==="left"?`left: ${u}`:`right: ${d}`;a.current.dataset.motionPopId=i;const p=document.createElement("style");s&&(p.nonce=s);const g=r??document.head;return g.appendChild(p),p.sheet&&p.sheet.insertRule(`
          [data-motion-pop-id="${i}"] {
            position: absolute !important;
            width: ${l}px !important;
            height: ${c}px !important;
            ${h}px !important;
            top: ${f}px !important;
          }
        `),()=>{g.contains(p)&&g.removeChild(p)}},[e]),j.jsx(Zce,{isPresent:e,childRef:a,sizeRef:o,children:H.cloneElement(t,{ref:a})})}const eue=({children:t,initial:e,isPresent:n,onExitComplete:r,custom:i,presenceAffectsLayout:a,mode:o,anchorX:s,root:l})=>{const c=cC(tue),f=H.useId();let u=!0,d=H.useMemo(()=>(u=!1,{id:f,initial:e,isPresent:n,custom:i,onExitComplete:h=>{c.set(h,!0);for(const p of c.values())if(!p)return;r&&r()},register:h=>(c.set(h,!1),()=>c.delete(h))}),[n,c,r]);return a&&u&&(d={...d}),H.useMemo(()=>{c.forEach((h,p)=>c.set(p,!1))},[n]),H.useEffect(()=>{!n&&!c.size&&r&&r()},[n]),o==="popLayout"&&(t=j.jsx(Qce,{isPresent:n,anchorX:s,root:l,children:t})),j.jsx(gy.Provider,{value:d,children:t})};function tue(){return new Map}function EG(t=!0){const e=H.useContext(gy);if(e===null)return[!0,null];const{isPresent:n,onExitComplete:r,register:i}=e,a=H.useId();H.useEffect(()=>{if(t)return i(a)},[t]);const o=H.useCallback(()=>t&&r&&r(a),[a,r,t]);return!n&&r?[!1,o]:[!0]}function HHe(){return nue(H.useContext(gy))}function nue(t){return t===null?!0:t.isPresent}const rx=t=>t.key||"";function uA(t){const e=[];return H.Children.forEach(t,n=>{H.isValidElement(n)&&e.push(n)}),e}const fC=({children:t,custom:e,initial:n=!0,onExitComplete:r,presenceAffectsLayout:i=!0,mode:a="sync",propagate:o=!1,anchorX:s="left",root:l})=>{const[c,f]=EG(o),u=H.useMemo(()=>uA(t),[t]),d=o&&!c?[]:u.map(rx),h=H.useRef(!0),p=H.useRef(u),g=cC(()=>new Map),[m,y]=H.useState(u),[v,x]=H.useState(u);k9(()=>{h.current=!1,p.current=u;for(let T=0;T<v.length;T++){const _=rx(v[T]);d.includes(_)?g.delete(_):g.get(_)!==!0&&g.set(_,!1)}},[v,d.length,d.join("-")]);const w=[];if(u!==m){let T=[...u];for(let _=0;_<v.length;_++){const D=v[_],I=rx(D);d.includes(I)||(T.splice(_,0,D),w.push(D))}return a==="wait"&&w.length&&(T=w),x(uA(T)),y(u),null}const{forceRender:S}=H.useContext(S2);return j.jsx(j.Fragment,{children:v.map(T=>{const _=rx(T),D=o&&!c?!1:u===v||d.includes(_),I=()=>{if(g.has(_))g.set(_,!0);else return;let R=!0;g.forEach(O=>{O||(R=!1)}),R&&(S?.(),x(p.current),o&&f?.(),r&&r())};return j.jsx(eue,{isPresent:D,initial:!h.current||n?void 0:!1,custom:e,presenceAffectsLayout:i,mode:a,root:l,onExitComplete:D?void 0:I,anchorX:s,children:T},_)})})},rue=H.createContext(null);function iue(){const t=H.useRef(!1);return k9(()=>(t.current=!0,()=>{t.current=!1}),[]),t}function aue(){const t=iue(),[e,n]=H.useState(0),r=H.useCallback(()=>{t.current&&n(e+1)},[e]);return[H.useCallback(()=>gi.postRender(r),[r]),e]}const oue=t=>!t.isLayoutDirty&&t.willUpdate(!1);function fA(){const t=new Set,e=new WeakMap,n=()=>t.forEach(oue);return{add:r=>{t.add(r),e.set(r,r.addEventListener("willUpdate",n))},remove:r=>{t.delete(r);const i=e.get(r);i&&(i(),e.delete(r)),n()},dirty:n}}const _G=t=>t===!0,sue=t=>_G(t===!0)||t==="id",lue=({children:t,id:e,inherit:n=!0})=>{const r=H.useContext(S2),i=H.useContext(rue),[a,o]=aue(),s=H.useRef(null),l=r.id||i;s.current===null&&(sue(n)&&l&&(e=e?l+"-"+e:l),s.current={id:e,group:_G(n)&&r.group||fA()});const c=H.useMemo(()=>({...s.current,forceRender:a}),[o]);return j.jsx(S2.Provider,{value:c,children:t})},rD=H.createContext({strict:!1}),dA={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},cm={};for(const t in dA)cm[t]={isEnabled:e=>dA[t].some(n=>!!e[n])};function g6(t){for(const e in t)cm[e]={...cm[e],...t[e]}}function Pm({children:t,features:e,strict:n=!1}){const[,r]=H.useState(!NT(e)),i=H.useRef(void 0);if(!NT(e)){const{renderer:a,...o}=e;i.current=a,g6(o)}return H.useEffect(()=>{NT(e)&&e().then(({renderer:a,...o})=>{g6(o),i.current=a,r(!0)})},[]),j.jsx(rD.Provider,{value:{renderer:i.current,strict:n},children:t})}function NT(t){return typeof t=="function"}const cue=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function _w(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||cue.has(t)}let DG=t=>!_w(t);function OG(t){typeof t=="function"&&(DG=e=>e.startsWith("on")?!_w(e):t(e))}try{OG(require("@emotion/is-prop-valid").default)}catch{}function uue(t,e,n){const r={};for(const i in t)i==="values"&&typeof t.values=="object"||(DG(i)||n===!0&&_w(i)||!e&&!_w(i)||t.draggable&&i.startsWith("onDrag"))&&(r[i]=t[i]);return r}function fue({children:t,isValidProp:e,...n}){e&&OG(e),n={...H.useContext(D2),...n},n.isStatic=cC(()=>n.isStatic);const r=H.useMemo(()=>n,[JSON.stringify(n.transition),n.transformPagePoint,n.reducedMotion]);return j.jsx(D2.Provider,{value:r,children:t})}const dC=H.createContext({});function hC(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}function O2(t){return typeof t=="string"||Array.isArray(t)}const iD=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],aD=["initial",...iD];function pC(t){return hC(t.animate)||aD.some(e=>O2(t[e]))}function MG(t){return!!(pC(t)||t.variants)}function due(t,e){if(pC(t)){const{initial:n,animate:r}=t;return{initial:n===!1||O2(n)?n:void 0,animate:O2(r)?r:void 0}}return t.inherit!==!1?e:{}}function hue(t){const{initial:e,animate:n}=due(t,H.useContext(dC));return H.useMemo(()=>({initial:e,animate:n}),[hA(e),hA(n)])}function hA(t){return Array.isArray(t)?t.join(" "):t}const M2={};function pue(t){for(const e in t)M2[e]=t[e],z9(e)&&(M2[e].isCSSVariable=!0)}function IG(t,{layout:e,layoutId:n}){return Rm.has(t)||t.startsWith("origin")||(e||n!==void 0)&&(!!M2[t]||t==="opacity")}const gue={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},mue=Im.length;function vue(t,e,n){let r="",i=!0;for(let a=0;a<mue;a++){const o=Im[a],s=t[o];if(s===void 0)continue;let l=!0;if(typeof s=="number"?l=s===(o.startsWith("scale")?1:0):l=parseFloat(s)===0,!l||n){const c=xG(s,eD[o]);if(!l){i=!1;const f=gue[o]||o;r+=`${f}(${c}) `}n&&(e[o]=c)}}return r=r.trim(),n?r=n(e,i?"":r):i&&(r="none"),r}function oD(t,e,n){const{style:r,vars:i,transformOrigin:a}=t;let o=!1,s=!1;for(const l in e){const c=e[l];if(Rm.has(l)){o=!0;continue}else if(z9(l)){i[l]=c;continue}else{const f=xG(c,eD[l]);l.startsWith("origin")?(s=!0,a[l]=f):r[l]=f}}if(e.transform||(o||n?r.transform=vue(e,t.transform,n):r.transform&&(r.transform="none")),s){const{originX:l="50%",originY:c="50%",originZ:f=0}=a;r.transformOrigin=`${l} ${c} ${f}`}}const sD=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function RG(t,e,n){for(const r in e)!Po(e[r])&&!IG(r,n)&&(t[r]=e[r])}function yue({transformTemplate:t},e){return H.useMemo(()=>{const n=sD();return oD(n,e,t),Object.assign({},n.vars,n.style)},[e])}function xue(t,e){const n=t.style||{},r={};return RG(r,n,t),Object.assign(r,yue(t,e)),r}function bue(t,e){const n={},r=xue(t,e);return t.drag&&t.dragListener!==!1&&(n.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(n.tabIndex=0),n.style=r,n}const wue={offset:"stroke-dashoffset",array:"stroke-dasharray"},Cue={offset:"strokeDashoffset",array:"strokeDasharray"};function Sue(t,e,n=1,r=0,i=!0){t.pathLength=1;const a=i?wue:Cue;t[a.offset]=Cn.transform(-r);const o=Cn.transform(e),s=Cn.transform(n);t[a.array]=`${o} ${s}`}function PG(t,{attrX:e,attrY:n,attrScale:r,pathLength:i,pathSpacing:a=1,pathOffset:o=0,...s},l,c,f){if(oD(t,s,c),l){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:u,style:d}=t;u.transform&&(d.transform=u.transform,delete u.transform),(d.transform||u.transformOrigin)&&(d.transformOrigin=u.transformOrigin??"50% 50%",delete u.transformOrigin),d.transform&&(d.transformBox=f?.transformBox??"fill-box",delete u.transformBox),e!==void 0&&(u.x=e),n!==void 0&&(u.y=n),r!==void 0&&(u.scale=r),i!==void 0&&Sue(u,i,a,o,!1)}const AG=()=>({...sD(),attrs:{}}),NG=t=>typeof t=="string"&&t.toLowerCase()==="svg";function Tue(t,e,n,r){const i=H.useMemo(()=>{const a=AG();return PG(a,e,NG(r),t.transformTemplate,t.style),{...a.attrs,style:{...a.style}}},[e]);if(t.style){const a={};RG(a,t.style,t),i.style={...a,...i.style}}return i}const Eue=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function lD(t){return typeof t!="string"||t.includes("-")?!1:!!(Eue.indexOf(t)>-1||/[A-Z]/u.test(t))}function _ue(t,e,n,{latestValues:r},i,a=!1){const s=(lD(t)?Tue:bue)(e,r,i,t),l=uue(e,typeof t=="string",a),c=t!==H.Fragment?{...l,...s,ref:n}:{},{children:f}=e,u=H.useMemo(()=>Po(f)?f.get():f,[f]);return H.createElement(t,{...c,children:u})}function pA(t){const e=[{},{}];return t?.values.forEach((n,r)=>{e[0][r]=n.get(),e[1][r]=n.getVelocity()}),e}function cD(t,e,n,r){if(typeof e=="function"){const[i,a]=pA(r);e=e(n!==void 0?n:t.custom,i,a)}if(typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"){const[i,a]=pA(r);e=e(n!==void 0?n:t.custom,i,a)}return e}function Mb(t){return Po(t)?t.get():t}function Due({scrapeMotionValuesFromProps:t,createRenderState:e},n,r,i){return{latestValues:Oue(n,r,i,t),renderState:e()}}function Oue(t,e,n,r){const i={},a=r(t,{});for(const d in a)i[d]=Mb(a[d]);let{initial:o,animate:s}=t;const l=pC(t),c=MG(t);e&&c&&!l&&t.inherit!==!1&&(o===void 0&&(o=e.initial),s===void 0&&(s=e.animate));let f=n?n.initial===!1:!1;f=f||o===!1;const u=f?s:o;if(u&&typeof u!="boolean"&&!hC(u)){const d=Array.isArray(u)?u:[u];for(let h=0;h<d.length;h++){const p=cD(t,d[h]);if(p){const{transitionEnd:g,transition:m,...y}=p;for(const v in y){let x=y[v];if(Array.isArray(x)){const w=f?x.length-1:0;x=x[w]}x!==null&&(i[v]=x)}for(const v in g)i[v]=g[v]}}}return i}const LG=t=>(e,n)=>{const r=H.useContext(dC),i=H.useContext(gy),a=()=>Due(t,e,r,i);return n?a():cC(a)};function uD(t,e,n){const{style:r}=t,i={};for(const a in r)(Po(r[a])||e.style&&Po(e.style[a])||IG(a,t)||n?.getValue(a)?.liveStyle!==void 0)&&(i[a]=r[a]);return i}const Mue=LG({scrapeMotionValuesFromProps:uD,createRenderState:sD});function kG(t,e,n){const r=uD(t,e,n);for(const i in t)if(Po(t[i])||Po(e[i])){const a=Im.indexOf(i)!==-1?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i;r[a]=t[i]}return r}const Iue=LG({scrapeMotionValuesFromProps:kG,createRenderState:AG}),Rue=Symbol.for("motionComponentSymbol");function ng(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function Pue(t,e,n){return H.useCallback(r=>{r&&t.onMount&&t.onMount(r),e&&(r?e.mount(r):e.unmount()),n&&(typeof n=="function"?n(r):ng(n)&&(n.current=r))},[e])}const fD=t=>t.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),Aue="framerAppearId",VG="data-"+fD(Aue),FG=H.createContext({});function Nue(t,e,n,r,i){const{visualElement:a}=H.useContext(dC),o=H.useContext(rD),s=H.useContext(gy),l=H.useContext(D2).reducedMotion,c=H.useRef(null);r=r||o.renderer,!c.current&&r&&(c.current=r(t,{visualState:e,parent:a,props:n,presenceContext:s,blockInitialAnimation:s?s.initial===!1:!1,reducedMotionConfig:l}));const f=c.current,u=H.useContext(FG);f&&!f.projection&&i&&(f.type==="html"||f.type==="svg")&&Lue(c.current,n,i,u);const d=H.useRef(!1);H.useInsertionEffect(()=>{f&&d.current&&f.update(n,s)});const h=n[VG],p=H.useRef(!!h&&!window.MotionHandoffIsComplete?.(h)&&window.MotionHasOptimisedAnimation?.(h));return k9(()=>{f&&(d.current=!0,window.MotionIsMounted=!0,f.updateFeatures(),f.scheduleRenderMicrotask(),p.current&&f.animationState&&f.animationState.animateChanges())}),H.useEffect(()=>{f&&(!p.current&&f.animationState&&f.animationState.animateChanges(),p.current&&(queueMicrotask(()=>{window.MotionHandoffMarkAsComplete?.(h)}),p.current=!1),f.enteringChildren=void 0)}),f}function Lue(t,e,n,r){const{layoutId:i,layout:a,drag:o,dragConstraints:s,layoutScroll:l,layoutRoot:c,layoutCrossfade:f}=e;t.projection=new n(t.latestValues,e["data-framer-portal-id"]?void 0:UG(t.parent)),t.projection.setOptions({layoutId:i,layout:a,alwaysMeasureLayout:!!o||s&&ng(s),visualElement:t,animationType:typeof a=="string"?a:"both",initialPromotionConfig:r,crossfade:f,layoutScroll:l,layoutRoot:c})}function UG(t){if(t)return t.options.allowProjection!==!1?t.projection:UG(t.parent)}function LT(t,{forwardMotionProps:e=!1}={},n,r){n&&g6(n);const i=lD(t)?Iue:Mue;function a(s,l){let c;const f={...H.useContext(D2),...s,layoutId:kue(s)},{isStatic:u}=f,d=hue(s),h=i(s,u);if(!u&&L9){Vue();const p=Fue(f);c=p.MeasureLayout,d.visualElement=Nue(t,h,f,r,p.ProjectionNode)}return j.jsxs(dC.Provider,{value:d,children:[c&&d.visualElement?j.jsx(c,{visualElement:d.visualElement,...f}):null,_ue(t,s,Pue(h,d.visualElement,l),h,u,e)]})}a.displayName=`motion.${typeof t=="string"?t:`create(${t.displayName??t.name??""})`}`;const o=H.forwardRef(a);return o[Rue]=t,o}function kue({layoutId:t}){const e=H.useContext(S2).id;return e&&t!==void 0?e+"-"+t:t}function Vue(t,e){H.useContext(rD).strict}function Fue(t){const{drag:e,layout:n}=cm;if(!e&&!n)return{};const r={...e,...n};return{MeasureLayout:e?.isEnabled(t)||n?.isEnabled(t)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}function Uue(t,e){if(typeof Proxy>"u")return LT;const n=new Map,r=(a,o)=>LT(a,o,t,e),i=(a,o)=>r(a,o);return new Proxy(i,{get:(a,o)=>o==="create"?r:(n.has(o)||n.set(o,LT(o,void 0,t,e)),n.get(o))})}const Oh=Uue();function BG({top:t,left:e,right:n,bottom:r}){return{x:{min:e,max:n},y:{min:t,max:r}}}function Bue({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}function $ue(t,e){if(!e)return t;const n=e({x:t.left,y:t.top}),r=e({x:t.right,y:t.bottom});return{top:n.y,left:n.x,bottom:r.y,right:r.x}}function kT(t){return t===void 0||t===1}function m6({scale:t,scaleX:e,scaleY:n}){return!kT(t)||!kT(e)||!kT(n)}function q0(t){return m6(t)||$G(t)||t.z||t.rotate||t.rotateX||t.rotateY||t.skewX||t.skewY}function $G(t){return gA(t.x)||gA(t.y)}function gA(t){return t&&t!=="0%"}function Dw(t,e,n){const r=t-n,i=e*r;return n+i}function mA(t,e,n,r,i){return i!==void 0&&(t=Dw(t,i,r)),Dw(t,n,r)+e}function v6(t,e=0,n=1,r,i){t.min=mA(t.min,e,n,r,i),t.max=mA(t.max,e,n,r,i)}function GG(t,{x:e,y:n}){v6(t.x,e.translate,e.scale,e.originPoint),v6(t.y,n.translate,n.scale,n.originPoint)}const vA=.999999999999,yA=1.0000000000001;function Gue(t,e,n,r=!1){const i=n.length;if(!i)return;e.x=e.y=1;let a,o;for(let s=0;s<i;s++){a=n[s],o=a.projectionDelta;const{visualElement:l}=a.options;l&&l.props.style&&l.props.style.display==="contents"||(r&&a.options.layoutScroll&&a.scroll&&a!==a.root&&ig(t,{x:-a.scroll.offset.x,y:-a.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,GG(t,o)),r&&q0(a.latestValues)&&ig(t,a.latestValues))}e.x<yA&&e.x>vA&&(e.x=1),e.y<yA&&e.y>vA&&(e.y=1)}function rg(t,e){t.min=t.min+e,t.max=t.max+e}function xA(t,e,n,r,i=.5){const a=Pi(t.min,t.max,i);v6(t,e,n,a,r)}function ig(t,e){xA(t.x,e.x,e.scaleX,e.scale,e.originX),xA(t.y,e.y,e.scaleY,e.scale,e.originY)}function jG(t,e){return BG($ue(t.getBoundingClientRect(),e))}function jue(t,e,n){const r=jG(t,n),{scroll:i}=e;return i&&(rg(r.x,i.offset.x),rg(r.y,i.offset.y)),r}const bA=()=>({translate:0,scale:1,origin:0,originPoint:0}),ag=()=>({x:bA(),y:bA()}),wA=()=>({min:0,max:0}),aa=()=>({x:wA(),y:wA()}),y6={current:null},zG={current:!1};function zue(){if(zG.current=!0,!!L9)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>y6.current=t.matches;t.addEventListener("change",e),e()}else y6.current=!1}const Wue=new WeakMap;function Hue(t,e,n){for(const r in e){const i=e[r],a=n[r];if(Po(i))t.addValue(r,i);else if(Po(a))t.addValue(r,lm(i,{owner:t}));else if(a!==i)if(t.hasValue(r)){const o=t.getValue(r);o.liveStyle===!0?o.jump(i):o.hasAnimated||o.set(i)}else{const o=t.getStaticValue(r);t.addValue(r,lm(o!==void 0?o:i,{owner:t}))}}for(const r in n)e[r]===void 0&&t.removeValue(r);return e}const CA=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class Kue{scrapeMotionValuesFromProps(e,n,r){return{}}constructor({parent:e,props:n,presenceContext:r,reducedMotionConfig:i,blockInitialAnimation:a,visualState:o},s={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=Z9,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const d=Es.now();this.renderScheduledAt<d&&(this.renderScheduledAt=d,gi.render(this.render,!1,!0))};const{latestValues:l,renderState:c}=o;this.latestValues=l,this.baseTarget={...l},this.initialValues=n.initial?{...l}:{},this.renderState=c,this.parent=e,this.props=n,this.presenceContext=r,this.depth=e?e.depth+1:0,this.reducedMotionConfig=i,this.options=s,this.blockInitialAnimation=!!a,this.isControllingVariants=pC(n),this.isVariantNode=MG(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:f,...u}=this.scrapeMotionValuesFromProps(n,{},this);for(const d in u){const h=u[d];l[d]!==void 0&&Po(h)&&h.set(l[d])}}mount(e){this.current=e,Wue.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,r)=>this.bindToMotionValue(r,n)),zG.current||zue(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:y6.current,this.parent?.addChild(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),Qd(this.notifyUpdate),Qd(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent?.removeChild(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const n=this.features[e];n&&(n.unmount(),n.isMounted=!1)}this.current=null}addChild(e){this.children.add(e),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(e)}removeChild(e){this.children.delete(e),this.enteringChildren&&this.enteringChildren.delete(e)}bindToMotionValue(e,n){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const r=Rm.has(e);r&&this.onBindTransform&&this.onBindTransform();const i=n.on("change",o=>{this.latestValues[e]=o,this.props.onUpdate&&gi.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,e,n)),this.valueSubscriptions.set(e,()=>{i(),a&&a(),n.owner&&n.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in cm){const n=cm[e];if(!n)continue;const{isEnabled:r,Feature:i}=n;if(!this.features[e]&&i&&r(this.props)&&(this.features[e]=new i(this)),this.features[e]){const a=this.features[e];a.isMounted?a.update():(a.mount(),a.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):aa()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,n){this.latestValues[e]=n}update(e,n){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let r=0;r<CA.length;r++){const i=CA[r];this.propEventSubscriptions[i]&&(this.propEventSubscriptions[i](),delete this.propEventSubscriptions[i]);const a="on"+i,o=e[a];o&&(this.propEventSubscriptions[i]=this.on(i,o))}this.prevMotionValues=Hue(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(e),()=>n.variantChildren.delete(e)}addValue(e,n){const r=this.values.get(e);n!==r&&(r&&this.removeValue(e),this.bindToMotionValue(e,n),this.values.set(e,n),this.latestValues[e]=n.get())}removeValue(e){this.values.delete(e);const n=this.valueSubscriptions.get(e);n&&(n(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,n){if(this.props.values&&this.props.values[e])return this.props.values[e];let r=this.values.get(e);return r===void 0&&n!==void 0&&(r=lm(n===null?void 0:n,{owner:this}),this.addValue(e,r)),r}readValue(e,n){let r=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:this.getBaseTargetFromProps(this.props,e)??this.readValueFromInstance(this.current,e,this.options);return r!=null&&(typeof r=="string"&&(L$(r)||V$(r))?r=parseFloat(r):!Jce(r)&&e0.test(n)&&(r=yG(e,n)),this.setBaseTarget(e,Po(r)?r.get():r)),Po(r)?r.get():r}setBaseTarget(e,n){this.baseTarget[e]=n}getBaseTarget(e){const{initial:n}=this.props;let r;if(typeof n=="string"||typeof n=="object"){const a=cD(this.props,n,this.presenceContext?.custom);a&&(r=a[e])}if(n&&r!==void 0)return r;const i=this.getBaseTargetFromProps(this.props,e);return i!==void 0&&!Po(i)?i:this.initialValues[e]!==void 0&&r===void 0?void 0:this.baseTarget[e]}on(e,n){return this.events[e]||(this.events[e]=new $9),this.events[e].add(n)}notify(e,...n){this.events[e]&&this.events[e].notify(...n)}scheduleRenderMicrotask(){tD.render(this.render)}}class WG extends Kue{constructor(){super(...arguments),this.KeyframeResolver=Uce}sortInstanceNodePosition(e,n){return e.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(e,n){return e.style?e.style[n]:void 0}removeValueFromRenderState(e,{vars:n,style:r}){delete n[e],delete r[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;Po(e)&&(this.childSubscription=e.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}}function HG(t,{style:e,vars:n},r,i){const a=t.style;let o;for(o in e)a[o]=e[o];i?.applyProjectionStyles(a,r);for(o in n)a.setProperty(o,n[o])}function que(t){return window.getComputedStyle(t)}class Xue extends WG{constructor(){super(...arguments),this.type="html",this.renderInstance=HG}readValueFromInstance(e,n){if(Rm.has(n))return this.projection?.isProjecting?l6(n):ice(e,n);{const r=que(e),i=(z9(n)?r.getPropertyValue(n):r[n])||0;return typeof i=="string"?i.trim():i}}measureInstanceViewportBox(e,{transformPagePoint:n}){return jG(e,n)}build(e,n,r){oD(e,n,r.transformTemplate)}scrapeMotionValuesFromProps(e,n,r){return uD(e,n,r)}}const KG=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function Yue(t,e,n,r){HG(t,e,void 0,r);for(const i in e.attrs)t.setAttribute(KG.has(i)?i:fD(i),e.attrs[i])}class Jue extends WG{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=aa}getBaseTargetFromProps(e,n){return e[n]}readValueFromInstance(e,n){if(Rm.has(n)){const r=vG(n);return r&&r.default||0}return n=KG.has(n)?n:fD(n),e.getAttribute(n)}scrapeMotionValuesFromProps(e,n,r){return kG(e,n,r)}build(e,n,r){PG(e,n,this.isSVGTag,r.transformTemplate,r.style)}renderInstance(e,n,r,i){Yue(e,n,r,i)}mount(e){this.isSVGTag=NG(e.tagName),super.mount(e)}}const Zue=(t,e)=>lD(t)?new Jue(e):new Xue(e,{allowProjection:t!==H.Fragment});function Vg(t,e,n){const r=t.getProps();return cD(r,e,n!==void 0?n:r.custom,t)}const x6=t=>Array.isArray(t);function Que(t,e,n){t.hasValue(e)?t.getValue(e).set(n):t.addValue(e,lm(n))}function efe(t){return x6(t)?t[t.length-1]||0:t}function tfe(t,e){const n=Vg(t,e);let{transitionEnd:r={},transition:i={},...a}=n||{};a={...a,...r};for(const o in a){const s=efe(a[o]);Que(t,o,s)}}function nfe(t){return!!(Po(t)&&t.add)}function b6(t,e){const n=t.getValue("willChange");if(nfe(n))return n.add(e);if(!n&&mu.WillChange){const r=new mu.WillChange("auto");t.addValue("willChange",r),r.add(e)}}function qG(t){return t.props[VG]}const rfe=t=>t!==null;function ife(t,{repeat:e,repeatType:n="loop"},r){const i=t.filter(rfe),a=e&&n!=="loop"&&e%2===1?0:i.length-1;return i[a]}const afe={type:"spring",stiffness:500,damping:25,restSpeed:10},ofe=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),sfe={type:"keyframes",duration:.8},lfe={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},cfe=(t,{keyframes:e})=>e.length>2?sfe:Rm.has(t)?t.startsWith("scale")?ofe(e[1]):afe:lfe;function ufe({when:t,delay:e,delayChildren:n,staggerChildren:r,staggerDirection:i,repeat:a,repeatType:o,repeatDelay:s,from:l,elapsed:c,...f}){return!!Object.keys(f).length}const dD=(t,e,n,r={},i,a)=>o=>{const s=Q9(r,t)||{},l=s.delay||r.delay||0;let{elapsed:c=0}=r;c=c-au(l);const f={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:e.getVelocity(),...s,delay:-c,onUpdate:d=>{e.set(d),s.onUpdate&&s.onUpdate(d)},onComplete:()=>{o(),s.onComplete&&s.onComplete()},name:t,motionValue:e,element:a?void 0:i};ufe(s)||Object.assign(f,cfe(t,f)),f.duration&&(f.duration=au(f.duration)),f.repeatDelay&&(f.repeatDelay=au(f.repeatDelay)),f.from!==void 0&&(f.keyframes[0]=f.from);let u=!1;if((f.type===!1||f.duration===0&&!f.repeatDelay)&&(h6(f),f.delay===0&&(u=!0)),(mu.instantAnimations||mu.skipAnimations)&&(u=!0,h6(f),f.delay=0),f.allowFlatten=!s.type&&!s.ease,u&&!a&&e.get()!==void 0){const d=ife(f.keyframes,s);if(d!==void 0){gi.update(()=>{f.onUpdate(d),f.onComplete()});return}}return s.isSync?new uC(f):new Dce(f)};function ffe({protectedKeys:t,needsAnimating:e},n){const r=t.hasOwnProperty(n)&&e[n]!==!0;return e[n]=!1,r}function XG(t,e,{delay:n=0,transitionOverride:r,type:i}={}){let{transition:a=t.getDefaultTransition(),transitionEnd:o,...s}=e;r&&(a=r);const l=[],c=i&&t.animationState&&t.animationState.getState()[i];for(const f in s){const u=t.getValue(f,t.latestValues[f]??null),d=s[f];if(d===void 0||c&&ffe(c,f))continue;const h={delay:n,...Q9(a||{},f)},p=u.get();if(p!==void 0&&!u.isAnimating&&!Array.isArray(d)&&d===p&&!h.velocity)continue;let g=!1;if(window.MotionHandoffAnimation){const y=qG(t);if(y){const v=window.MotionHandoffAnimation(y,f,gi);v!==null&&(h.startTime=v,g=!0)}}b6(t,f),u.start(dD(f,u,d,t.shouldReduceMotion&&pG.has(f)?{type:!1}:h,t,g));const m=u.animation;m&&l.push(m)}return o&&Promise.all(l).then(()=>{gi.update(()=>{o&&tfe(t,o)})}),l}function YG(t,e,n,r=0,i=1){const a=Array.from(t).sort((c,f)=>c.sortNodePosition(f)).indexOf(e),o=t.size,s=(o-1)*r;return typeof n=="function"?n(a,o):i===1?a*r:s-a*r}function w6(t,e,n={}){const r=Vg(t,e,n.type==="exit"?t.presenceContext?.custom:void 0);let{transition:i=t.getDefaultTransition()||{}}=r||{};n.transitionOverride&&(i=n.transitionOverride);const a=r?()=>Promise.all(XG(t,r,n)):()=>Promise.resolve(),o=t.variantChildren&&t.variantChildren.size?(l=0)=>{const{delayChildren:c=0,staggerChildren:f,staggerDirection:u}=i;return dfe(t,e,l,c,f,u,n)}:()=>Promise.resolve(),{when:s}=i;if(s){const[l,c]=s==="beforeChildren"?[a,o]:[o,a];return l().then(()=>c())}else return Promise.all([a(),o(n.delay)])}function dfe(t,e,n=0,r=0,i=0,a=1,o){const s=[];for(const l of t.variantChildren)l.notify("AnimationStart",e),s.push(w6(l,e,{...o,delay:n+(typeof r=="function"?0:r)+YG(t.variantChildren,l,r,i,a)}).then(()=>l.notify("AnimationComplete",e)));return Promise.all(s)}function hfe(t,e,n={}){t.notify("AnimationStart",e);let r;if(Array.isArray(e)){const i=e.map(a=>w6(t,a,n));r=Promise.all(i)}else if(typeof e=="string")r=w6(t,e,n);else{const i=typeof e=="function"?Vg(t,e,n.custom):e;r=Promise.all(XG(t,i,n))}return r.then(()=>{t.notify("AnimationComplete",e)})}function JG(t,e){if(!Array.isArray(e))return!1;const n=e.length;if(n!==t.length)return!1;for(let r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}const pfe=aD.length;function ZG(t){if(!t)return;if(!t.isControllingVariants){const n=t.parent?ZG(t.parent)||{}:{};return t.props.initial!==void 0&&(n.initial=t.props.initial),n}const e={};for(let n=0;n<pfe;n++){const r=aD[n],i=t.props[r];(O2(i)||i===!1)&&(e[r]=i)}return e}const gfe=[...iD].reverse(),mfe=iD.length;function vfe(t){return e=>Promise.all(e.map(({animation:n,options:r})=>hfe(t,n,r)))}function yfe(t){let e=vfe(t),n=SA(),r=!0;const i=l=>(c,f)=>{const u=Vg(t,f,l==="exit"?t.presenceContext?.custom:void 0);if(u){const{transition:d,transitionEnd:h,...p}=u;c={...c,...p,...h}}return c};function a(l){e=l(t)}function o(l){const{props:c}=t,f=ZG(t.parent)||{},u=[],d=new Set;let h={},p=1/0;for(let m=0;m<mfe;m++){const y=gfe[m],v=n[y],x=c[y]!==void 0?c[y]:f[y],w=O2(x),S=y===l?v.isActive:null;S===!1&&(p=m);let T=x===f[y]&&x!==c[y]&&w;if(T&&r&&t.manuallyAnimateOnMount&&(T=!1),v.protectedKeys={...h},!v.isActive&&S===null||!x&&!v.prevProp||hC(x)||typeof x=="boolean")continue;const _=xfe(v.prevProp,x);let D=_||y===l&&v.isActive&&!T&&w||m>p&&w,I=!1;const R=Array.isArray(x)?x:[x];let O=R.reduce(i(y),{});S===!1&&(O={});const{prevResolvedValues:P={}}=v,N={...P,...O},A=$=>{D=!0,d.has($)&&(I=!0,d.delete($)),v.needsAnimating[$]=!0;const U=t.getValue($);U&&(U.liveStyle=!1)};for(const $ in N){const U=O[$],G=P[$];if(h.hasOwnProperty($))continue;let F=!1;x6(U)&&x6(G)?F=!JG(U,G):F=U!==G,F?U!=null?A($):d.add($):U!==void 0&&d.has($)?A($):v.protectedKeys[$]=!0}v.prevProp=x,v.prevResolvedValues=O,v.isActive&&(h={...h,...O}),r&&t.blockInitialAnimation&&(D=!1);const B=T&&_;D&&(!B||I)&&u.push(...R.map($=>{const U={type:y};if(typeof $=="string"&&r&&!B&&t.manuallyAnimateOnMount&&t.parent){const{parent:G}=t,F=Vg(G,$);if(G.enteringChildren&&F){const{delayChildren:J}=F.transition||{};U.delay=YG(G.enteringChildren,t,J)}}return{animation:$,options:U}}))}if(d.size){const m={};if(typeof c.initial!="boolean"){const y=Vg(t,Array.isArray(c.initial)?c.initial[0]:c.initial);y&&y.transition&&(m.transition=y.transition)}d.forEach(y=>{const v=t.getBaseTarget(y),x=t.getValue(y);x&&(x.liveStyle=!0),m[y]=v??null}),u.push({animation:m})}let g=!!u.length;return r&&(c.initial===!1||c.initial===c.animate)&&!t.manuallyAnimateOnMount&&(g=!1),r=!1,g?e(u):Promise.resolve()}function s(l,c){if(n[l].isActive===c)return Promise.resolve();t.variantChildren?.forEach(u=>u.animationState?.setActive(l,c)),n[l].isActive=c;const f=o(l);for(const u in n)n[u].protectedKeys={};return f}return{animateChanges:o,setActive:s,setAnimateFunction:a,getState:()=>n,reset:()=>{n=SA(),r=!0}}}function xfe(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!JG(e,t):!1}function R0(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function SA(){return{animate:R0(!0),whileInView:R0(),whileHover:R0(),whileTap:R0(),whileDrag:R0(),whileFocus:R0(),exit:R0()}}class p0{constructor(e){this.isMounted=!1,this.node=e}update(){}}class bfe extends p0{constructor(e){super(e),e.animationState||(e.animationState=yfe(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();hC(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:n}=this.node.prevProps||{};e!==n&&this.updateAnimationControlsSubscription()}unmount(){this.node.animationState.reset(),this.unmountControls?.()}}let wfe=0;class Cfe extends p0{constructor(){super(...arguments),this.id=wfe++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:n}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===r)return;const i=this.node.animationState.setActive("exit",!e);n&&!e&&i.then(()=>{n(this.id)})}mount(){const{register:e,onExitComplete:n}=this.node.presenceContext||{};n&&n(this.id),e&&(this.unmount=e(this.id))}unmount(){}}const Sfe={animation:{Feature:bfe},exit:{Feature:Cfe}};function I2(t,e,n,r={passive:!0}){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n)}function xy(t){return{point:{x:t.pageX,y:t.pageY}}}const Tfe=t=>e=>nD(e)&&t(e,xy(e));function qv(t,e,n,r){return I2(t,e,Tfe(n),r)}const QG=1e-4,Efe=1-QG,_fe=1+QG,ej=.01,Dfe=0-ej,Ofe=0+ej;function es(t){return t.max-t.min}function Mfe(t,e,n){return Math.abs(t-e)<=n}function TA(t,e,n,r=.5){t.origin=r,t.originPoint=Pi(e.min,e.max,t.origin),t.scale=es(n)/es(e),t.translate=Pi(n.min,n.max,t.origin)-t.originPoint,(t.scale>=Efe&&t.scale<=_fe||isNaN(t.scale))&&(t.scale=1),(t.translate>=Dfe&&t.translate<=Ofe||isNaN(t.translate))&&(t.translate=0)}function Xv(t,e,n,r){TA(t.x,e.x,n.x,r?r.originX:void 0),TA(t.y,e.y,n.y,r?r.originY:void 0)}function EA(t,e,n){t.min=n.min+e.min,t.max=t.min+es(e)}function Ife(t,e,n){EA(t.x,e.x,n.x),EA(t.y,e.y,n.y)}function _A(t,e,n){t.min=e.min-n.min,t.max=t.min+es(e)}function Yv(t,e,n){_A(t.x,e.x,n.x),_A(t.y,e.y,n.y)}function Ml(t){return[t("x"),t("y")]}const tj=({current:t})=>t?t.ownerDocument.defaultView:null,DA=(t,e)=>Math.abs(t-e);function Rfe(t,e){const n=DA(t.x,e.x),r=DA(t.y,e.y);return Math.sqrt(n**2+r**2)}class nj{constructor(e,n,{transformPagePoint:r,contextWindow:i=window,dragSnapToOrigin:a=!1,distanceThreshold:o=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const d=FT(this.lastMoveEventInfo,this.history),h=this.startEvent!==null,p=Rfe(d.offset,{x:0,y:0})>=this.distanceThreshold;if(!h&&!p)return;const{point:g}=d,{timestamp:m}=uo;this.history.push({...g,timestamp:m});const{onStart:y,onMove:v}=this.handlers;h||(y&&y(this.lastMoveEvent,d),this.startEvent=this.lastMoveEvent),v&&v(this.lastMoveEvent,d)},this.handlePointerMove=(d,h)=>{this.lastMoveEvent=d,this.lastMoveEventInfo=VT(h,this.transformPagePoint),gi.update(this.updatePoint,!0)},this.handlePointerUp=(d,h)=>{this.end();const{onEnd:p,onSessionEnd:g,resumeAnimation:m}=this.handlers;if(this.dragSnapToOrigin&&m&&m(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const y=FT(d.type==="pointercancel"?this.lastMoveEventInfo:VT(h,this.transformPagePoint),this.history);this.startEvent&&p&&p(d,y),g&&g(d,y)},!nD(e))return;this.dragSnapToOrigin=a,this.handlers=n,this.transformPagePoint=r,this.distanceThreshold=o,this.contextWindow=i||window;const s=xy(e),l=VT(s,this.transformPagePoint),{point:c}=l,{timestamp:f}=uo;this.history=[{...c,timestamp:f}];const{onSessionStart:u}=n;u&&u(e,FT(l,this.history)),this.removeListeners=my(qv(this.contextWindow,"pointermove",this.handlePointerMove),qv(this.contextWindow,"pointerup",this.handlePointerUp),qv(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),Qd(this.updatePoint)}}function VT(t,e){return e?{point:e(t.point)}:t}function OA(t,e){return{x:t.x-e.x,y:t.y-e.y}}function FT({point:t},e){return{point:t,delta:OA(t,rj(e)),offset:OA(t,Pfe(e)),velocity:Afe(e,.1)}}function Pfe(t){return t[0]}function rj(t){return t[t.length-1]}function Afe(t,e){if(t.length<2)return{x:0,y:0};let n=t.length-1,r=null;const i=rj(t);for(;n>=0&&(r=t[n],!(i.timestamp-r.timestamp>au(e)));)n--;if(!r)return{x:0,y:0};const a=ou(i.timestamp-r.timestamp);if(a===0)return{x:0,y:0};const o={x:(i.x-r.x)/a,y:(i.y-r.y)/a};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function Nfe(t,{min:e,max:n},r){return e!==void 0&&t<e?t=r?Pi(e,t,r.min):Math.max(t,e):n!==void 0&&t>n&&(t=r?Pi(n,t,r.max):Math.min(t,n)),t}function MA(t,e,n){return{min:e!==void 0?t.min+e:void 0,max:n!==void 0?t.max+n-(t.max-t.min):void 0}}function Lfe(t,{top:e,left:n,bottom:r,right:i}){return{x:MA(t.x,n,i),y:MA(t.y,e,r)}}function IA(t,e){let n=e.min-t.min,r=e.max-t.max;return e.max-e.min<t.max-t.min&&([n,r]=[r,n]),{min:n,max:r}}function kfe(t,e){return{x:IA(t.x,e.x),y:IA(t.y,e.y)}}function Vfe(t,e){let n=.5;const r=es(t),i=es(e);return i>r?n=T2(e.min,e.max-r,t.min):r>i&&(n=T2(t.min,t.max-i,e.min)),kf(0,1,n)}function Ffe(t,e){const n={};return e.min!==void 0&&(n.min=e.min-t.min),e.max!==void 0&&(n.max=e.max-t.min),n}const C6=.35;function Ufe(t=C6){return t===!1?t=0:t===!0&&(t=C6),{x:RA(t,"left","right"),y:RA(t,"top","bottom")}}function RA(t,e,n){return{min:PA(t,e),max:PA(t,n)}}function PA(t,e){return typeof t=="number"?t:t[e]||0}const Bfe=new WeakMap;class $fe{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=aa(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=e}start(e,{snapToCursor:n=!1,distanceThreshold:r}={}){const{presenceContext:i}=this.visualElement;if(i&&i.isPresent===!1)return;const a=u=>{const{dragSnapToOrigin:d}=this.getProps();d?this.pauseAnimation():this.stopAnimation(),n&&this.snapToCursor(xy(u).point)},o=(u,d)=>{const{drag:h,dragPropagation:p,onDragStart:g}=this.getProps();if(h&&!p&&(this.openDragLock&&this.openDragLock(),this.openDragLock=jce(h),!this.openDragLock))return;this.latestPointerEvent=u,this.latestPanInfo=d,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Ml(y=>{let v=this.getAxisMotionValue(y).get()||0;if(su.test(v)){const{projection:x}=this.visualElement;if(x&&x.layout){const w=x.layout.layoutBox[y];w&&(v=es(w)*(parseFloat(v)/100))}}this.originPoint[y]=v}),g&&gi.postRender(()=>g(u,d)),b6(this.visualElement,"transform");const{animationState:m}=this.visualElement;m&&m.setActive("whileDrag",!0)},s=(u,d)=>{this.latestPointerEvent=u,this.latestPanInfo=d;const{dragPropagation:h,dragDirectionLock:p,onDirectionLock:g,onDrag:m}=this.getProps();if(!h&&!this.openDragLock)return;const{offset:y}=d;if(p&&this.currentDirection===null){this.currentDirection=Gfe(y),this.currentDirection!==null&&g&&g(this.currentDirection);return}this.updateAxis("x",d.point,y),this.updateAxis("y",d.point,y),this.visualElement.render(),m&&m(u,d)},l=(u,d)=>{this.latestPointerEvent=u,this.latestPanInfo=d,this.stop(u,d),this.latestPointerEvent=null,this.latestPanInfo=null},c=()=>Ml(u=>this.getAnimationState(u)==="paused"&&this.getAxisMotionValue(u).animation?.play()),{dragSnapToOrigin:f}=this.getProps();this.panSession=new nj(e,{onSessionStart:a,onStart:o,onMove:s,onSessionEnd:l,resumeAnimation:c},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:f,distanceThreshold:r,contextWindow:tj(this.visualElement)})}stop(e,n){const r=e||this.latestPointerEvent,i=n||this.latestPanInfo,a=this.isDragging;if(this.cancel(),!a||!i||!r)return;const{velocity:o}=i;this.startAnimation(o);const{onDragEnd:s}=this.getProps();s&&gi.postRender(()=>s(r,i))}cancel(){this.isDragging=!1;const{projection:e,animationState:n}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(e,n,r){const{drag:i}=this.getProps();if(!r||!ix(e,i,this.currentDirection))return;const a=this.getAxisMotionValue(e);let o=this.originPoint[e]+r[e];this.constraints&&this.constraints[e]&&(o=Nfe(o,this.constraints[e],this.elastic[e])),a.set(o)}resolveConstraints(){const{dragConstraints:e,dragElastic:n}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):this.visualElement.projection?.layout,i=this.constraints;e&&ng(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):e&&r?this.constraints=Lfe(r.layoutBox,e):this.constraints=!1,this.elastic=Ufe(n),i!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&Ml(a=>{this.constraints!==!1&&this.getAxisMotionValue(a)&&(this.constraints[a]=Ffe(r.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:n}=this.getProps();if(!e||!ng(e))return!1;const r=e.current,{projection:i}=this.visualElement;if(!i||!i.layout)return!1;const a=jue(r,i.root,this.visualElement.getTransformPagePoint());let o=kfe(i.layout.layoutBox,a);if(n){const s=n(Bue(o));this.hasMutatedConstraints=!!s,s&&(o=BG(s))}return o}startAnimation(e){const{drag:n,dragMomentum:r,dragElastic:i,dragTransition:a,dragSnapToOrigin:o,onDragTransitionEnd:s}=this.getProps(),l=this.constraints||{},c=Ml(f=>{if(!ix(f,n,this.currentDirection))return;let u=l&&l[f]||{};o&&(u={min:0,max:0});const d=i?200:1e6,h=i?40:1e7,p={type:"inertia",velocity:r?e[f]:0,bounceStiffness:d,bounceDamping:h,timeConstant:750,restDelta:1,restSpeed:10,...a,...u};return this.startAxisValueAnimation(f,p)});return Promise.all(c).then(s)}startAxisValueAnimation(e,n){const r=this.getAxisMotionValue(e);return b6(this.visualElement,e),r.start(dD(e,r,0,n,this.visualElement,!1))}stopAnimation(){Ml(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){Ml(e=>this.getAxisMotionValue(e).animation?.pause())}getAnimationState(e){return this.getAxisMotionValue(e).animation?.state}getAxisMotionValue(e){const n=`_drag${e.toUpperCase()}`,r=this.visualElement.getProps(),i=r[n];return i||this.visualElement.getValue(e,(r.initial?r.initial[e]:void 0)||0)}snapToCursor(e){Ml(n=>{const{drag:r}=this.getProps();if(!ix(n,r,this.currentDirection))return;const{projection:i}=this.visualElement,a=this.getAxisMotionValue(n);if(i&&i.layout){const{min:o,max:s}=i.layout.layoutBox[n];a.set(e[n]-Pi(o,s,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:n}=this.getProps(),{projection:r}=this.visualElement;if(!ng(n)||!r||!this.constraints)return;this.stopAnimation();const i={x:0,y:0};Ml(o=>{const s=this.getAxisMotionValue(o);if(s&&this.constraints!==!1){const l=s.get();i[o]=Vfe({min:l,max:l},this.constraints[o])}});const{transformTemplate:a}=this.visualElement.getProps();this.visualElement.current.style.transform=a?a({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),Ml(o=>{if(!ix(o,e,null))return;const s=this.getAxisMotionValue(o),{min:l,max:c}=this.constraints[o];s.set(Pi(l,c,i[o]))})}addListeners(){if(!this.visualElement.current)return;Bfe.set(this.visualElement,this);const e=this.visualElement.current,n=qv(e,"pointerdown",l=>{const{drag:c,dragListener:f=!0}=this.getProps();c&&f&&this.start(l)}),r=()=>{const{dragConstraints:l}=this.getProps();ng(l)&&l.current&&(this.constraints=this.resolveRefConstraints())},{projection:i}=this.visualElement,a=i.addEventListener("measure",r);i&&!i.layout&&(i.root&&i.root.updateScroll(),i.updateLayout()),gi.read(r);const o=I2(window,"resize",()=>this.scalePositionWithinConstraints()),s=i.addEventListener("didUpdate",(({delta:l,hasLayoutChanged:c})=>{this.isDragging&&c&&(Ml(f=>{const u=this.getAxisMotionValue(f);u&&(this.originPoint[f]+=l[f].translate,u.set(u.get()+l[f].translate))}),this.visualElement.render())}));return()=>{o(),n(),a(),s&&s()}}getProps(){const e=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:r=!1,dragPropagation:i=!1,dragConstraints:a=!1,dragElastic:o=C6,dragMomentum:s=!0}=e;return{...e,drag:n,dragDirectionLock:r,dragPropagation:i,dragConstraints:a,dragElastic:o,dragMomentum:s}}}function ix(t,e,n){return(e===!0||e===t)&&(n===null||n===t)}function Gfe(t,e=10){let n=null;return Math.abs(t.y)>e?n="y":Math.abs(t.x)>e&&(n="x"),n}class jfe extends p0{constructor(e){super(e),this.removeGroupControls=kl,this.removeListeners=kl,this.controls=new $fe(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||kl}unmount(){this.removeGroupControls(),this.removeListeners()}}const AA=t=>(e,n)=>{t&&gi.postRender(()=>t(e,n))};class zfe extends p0{constructor(){super(...arguments),this.removePointerDownListener=kl}onPointerDown(e){this.session=new nj(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:tj(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:n,onPan:r,onPanEnd:i}=this.node.getProps();return{onSessionStart:AA(e),onStart:AA(n),onMove:r,onEnd:(a,o)=>{delete this.session,i&&gi.postRender(()=>i(a,o))}}}mount(){this.removePointerDownListener=qv(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const Ib={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function NA(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const q1={correct:(t,e)=>{if(!e.target)return t;if(typeof t=="string")if(Cn.test(t))t=parseFloat(t);else return t;const n=NA(t,e.target.x),r=NA(t,e.target.y);return`${n}% ${r}%`}},Wfe={correct:(t,{treeScale:e,projectionDelta:n})=>{const r=t,i=e0.parse(t);if(i.length>5)return r;const a=e0.createTransformer(t),o=typeof i[0]!="number"?1:0,s=n.x.scale*e.x,l=n.y.scale*e.y;i[0+o]/=s,i[1+o]/=l;const c=Pi(s,l,.5);return typeof i[2+o]=="number"&&(i[2+o]/=c),typeof i[3+o]=="number"&&(i[3+o]/=c),a(i)}};let UT=!1;class Hfe extends H.Component{componentDidMount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:r,layoutId:i}=this.props,{projection:a}=e;pue(Kfe),a&&(n.group&&n.group.add(a),r&&r.register&&i&&r.register(a),UT&&a.root.didUpdate(),a.addEventListener("animationComplete",()=>{this.safeToRemove()}),a.setOptions({...a.options,onExitComplete:()=>this.safeToRemove()})),Ib.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:n,visualElement:r,drag:i,isPresent:a}=this.props,{projection:o}=r;return o&&(o.isPresent=a,UT=!0,i||e.layoutDependency!==n||n===void 0||e.isPresent!==a?o.willUpdate():this.safeToRemove(),e.isPresent!==a&&(a?o.promote():o.relegate()||gi.postRender(()=>{const s=o.getStack();(!s||!s.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),tD.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:r}=this.props,{projection:i}=e;UT=!0,i&&(i.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(i),r&&r.deregister&&r.deregister(i))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function ij(t){const[e,n]=EG(),r=H.useContext(S2);return j.jsx(Hfe,{...t,layoutGroup:r,switchLayoutGroup:H.useContext(FG),isPresent:e,safeToRemove:n})}const Kfe={borderRadius:{...q1,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:q1,borderTopRightRadius:q1,borderBottomLeftRadius:q1,borderBottomRightRadius:q1,boxShadow:Wfe};function qfe(t,e,n){const r=Po(t)?t:lm(t);return r.start(dD("",r,e,n)),r.animation}const Xfe=(t,e)=>t.depth-e.depth;class Yfe{constructor(){this.children=[],this.isDirty=!1}add(e){V9(this.children,e),this.isDirty=!0}remove(e){F9(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(Xfe),this.isDirty=!1,this.children.forEach(e)}}function Jfe(t,e){const n=Es.now(),r=({timestamp:i})=>{const a=i-n;a>=e&&(Qd(r),t(a-e))};return gi.setup(r,!0),()=>Qd(r)}const aj=["TopLeft","TopRight","BottomLeft","BottomRight"],Zfe=aj.length,LA=t=>typeof t=="string"?parseFloat(t):t,kA=t=>typeof t=="number"||Cn.test(t);function Qfe(t,e,n,r,i,a){i?(t.opacity=Pi(0,n.opacity??1,ede(r)),t.opacityExit=Pi(e.opacity??1,0,tde(r))):a&&(t.opacity=Pi(e.opacity??1,n.opacity??1,r));for(let o=0;o<Zfe;o++){const s=`border${aj[o]}Radius`;let l=VA(e,s),c=VA(n,s);if(l===void 0&&c===void 0)continue;l||(l=0),c||(c=0),l===0||c===0||kA(l)===kA(c)?(t[s]=Math.max(Pi(LA(l),LA(c),r),0),(su.test(c)||su.test(l))&&(t[s]+="%")):t[s]=c}(e.rotate||n.rotate)&&(t.rotate=Pi(e.rotate||0,n.rotate||0,r))}function VA(t,e){return t[e]!==void 0?t[e]:t.borderRadius}const ede=oj(0,.5,W$),tde=oj(.5,.95,kl);function oj(t,e,n){return r=>r<t?0:r>e?1:n(T2(t,e,r))}function FA(t,e){t.min=e.min,t.max=e.max}function Dl(t,e){FA(t.x,e.x),FA(t.y,e.y)}function UA(t,e){t.translate=e.translate,t.scale=e.scale,t.originPoint=e.originPoint,t.origin=e.origin}function BA(t,e,n,r,i){return t-=e,t=Dw(t,1/n,r),i!==void 0&&(t=Dw(t,1/i,r)),t}function nde(t,e=0,n=1,r=.5,i,a=t,o=t){if(su.test(e)&&(e=parseFloat(e),e=Pi(o.min,o.max,e/100)-o.min),typeof e!="number")return;let s=Pi(a.min,a.max,r);t===a&&(s-=e),t.min=BA(t.min,e,n,s,i),t.max=BA(t.max,e,n,s,i)}function $A(t,e,[n,r,i],a,o){nde(t,e[n],e[r],e[i],e.scale,a,o)}const rde=["x","scaleX","originX"],ide=["y","scaleY","originY"];function GA(t,e,n,r){$A(t.x,e,rde,n?n.x:void 0,r?r.x:void 0),$A(t.y,e,ide,n?n.y:void 0,r?r.y:void 0)}function jA(t){return t.translate===0&&t.scale===1}function sj(t){return jA(t.x)&&jA(t.y)}function zA(t,e){return t.min===e.min&&t.max===e.max}function ade(t,e){return zA(t.x,e.x)&&zA(t.y,e.y)}function WA(t,e){return Math.round(t.min)===Math.round(e.min)&&Math.round(t.max)===Math.round(e.max)}function lj(t,e){return WA(t.x,e.x)&&WA(t.y,e.y)}function HA(t){return es(t.x)/es(t.y)}function KA(t,e){return t.translate===e.translate&&t.scale===e.scale&&t.originPoint===e.originPoint}class ode{constructor(){this.members=[]}add(e){V9(this.members,e),e.scheduleRender()}remove(e){if(F9(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(e){const n=this.members.findIndex(i=>e===i);if(n===0)return!1;let r;for(let i=n;i>=0;i--){const a=this.members[i];if(a.isPresent!==!1){r=a;break}}return r?(this.promote(r),!0):!1}promote(e,n){const r=this.lead;if(e!==r&&(this.prevLead=r,this.lead=e,e.show(),r)){r.instance&&r.scheduleRender(),e.scheduleRender(),e.resumeFrom=r,n&&(e.resumeFrom.preserveOpacity=!0),r.snapshot&&(e.snapshot=r.snapshot,e.snapshot.latestValues=r.animationValues||r.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:i}=e.options;i===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:n,resumingFrom:r}=e;n.onExitComplete&&n.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function sde(t,e,n){let r="";const i=t.x.translate/e.x,a=t.y.translate/e.y,o=n?.z||0;if((i||a||o)&&(r=`translate3d(${i}px, ${a}px, ${o}px) `),(e.x!==1||e.y!==1)&&(r+=`scale(${1/e.x}, ${1/e.y}) `),n){const{transformPerspective:c,rotate:f,rotateX:u,rotateY:d,skewX:h,skewY:p}=n;c&&(r=`perspective(${c}px) ${r}`),f&&(r+=`rotate(${f}deg) `),u&&(r+=`rotateX(${u}deg) `),d&&(r+=`rotateY(${d}deg) `),h&&(r+=`skewX(${h}deg) `),p&&(r+=`skewY(${p}deg) `)}const s=t.x.scale*e.x,l=t.y.scale*e.y;return(s!==1||l!==1)&&(r+=`scale(${s}, ${l})`),r||"none"}const X0={nodes:0,calculatedTargetDeltas:0,calculatedProjections:0},BT=["","X","Y","Z"],lde=1e3;let cde=0;function $T(t,e,n,r){const{latestValues:i}=e;i[t]&&(n[t]=i[t],e.setStaticValue(t,0),r&&(r[t]=0))}function cj(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return;const{visualElement:e}=t.options;if(!e)return;const n=qG(e);if(window.MotionHasOptimisedAnimation(n,"transform")){const{layout:i,layoutId:a}=t.options;window.MotionCancelOptimisedAnimation(n,"transform",gi,!(i||a))}const{parent:r}=t;r&&!r.hasCheckedOptimisedAppear&&cj(r)}function uj({attachResizeListener:t,defaultParent:e,measureScroll:n,checkIsScrollRoot:r,resetTransform:i}){return class{constructor(o={},s=e?.()){this.id=cde++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,Qc.value&&(X0.nodes=X0.calculatedTargetDeltas=X0.calculatedProjections=0),this.nodes.forEach(dde),this.nodes.forEach(mde),this.nodes.forEach(vde),this.nodes.forEach(hde),Qc.addProjectionMetrics&&Qc.addProjectionMetrics(X0)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=s?s.root||s:this,this.path=s?[...s.path,s]:[],this.parent=s,this.depth=s?s.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new Yfe)}addEventListener(o,s){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new $9),this.eventHandlers.get(o).add(s)}notifyListeners(o,...s){const l=this.eventHandlers.get(o);l&&l.notify(...s)}hasListeners(o){return this.eventHandlers.has(o)}mount(o){if(this.instance)return;this.isSVG=TG(o)&&!Xce(o),this.instance=o;const{layoutId:s,layout:l,visualElement:c}=this.options;if(c&&!c.current&&c.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(l||s)&&(this.isLayoutDirty=!0),t){let f,u=0;const d=()=>this.root.updateBlockedByResize=!1;gi.read(()=>{u=window.innerWidth}),t(o,()=>{const h=window.innerWidth;h!==u&&(u=h,this.root.updateBlockedByResize=!0,f&&f(),f=Jfe(d,250),Ib.hasAnimatedSinceResize&&(Ib.hasAnimatedSinceResize=!1,this.nodes.forEach(YA)))})}s&&this.root.registerSharedNode(s,this),this.options.animate!==!1&&c&&(s||l)&&this.addEventListener("didUpdate",({delta:f,hasLayoutChanged:u,hasRelativeLayoutChanged:d,layout:h})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const p=this.options.transition||c.getDefaultTransition()||Cde,{onLayoutAnimationStart:g,onLayoutAnimationComplete:m}=c.getProps(),y=!this.targetLayout||!lj(this.targetLayout,h),v=!u&&d;if(this.options.layoutRoot||this.resumeFrom||v||u&&(y||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const x={...Q9(p,"layout"),onPlay:g,onComplete:m};(c.shouldReduceMotion||this.options.layoutRoot)&&(x.delay=0,x.type=!1),this.startAnimation(x),this.setAnimationOrigin(f,v)}else u||YA(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=h})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),Qd(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(yde),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&cj(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let f=0;f<this.path.length;f++){const u=this.path[f];u.shouldResetTransform=!0,u.updateScroll("snapshot"),u.options.layoutRoot&&u.willUpdate(!1)}const{layoutId:s,layout:l}=this.options;if(s===void 0&&!l)return;const c=this.getTransformTemplate();this.prevTransformTemplateValue=c?c(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(qA);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(XA);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(gde),this.nodes.forEach(ude),this.nodes.forEach(fde)):this.nodes.forEach(XA),this.clearAllSnapshots();const s=Es.now();uo.delta=kf(0,1e3/60,s-uo.timestamp),uo.timestamp=s,uo.isProcessing=!0,OT.update.process(uo),OT.preRender.process(uo),OT.render.process(uo),uo.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,tD.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(pde),this.sharedNodes.forEach(xde)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,gi.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){gi.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!es(this.snapshot.measuredBox.x)&&!es(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=aa(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:s}=this.options;s&&s.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let s=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(s=!1),s&&this.instance){const l=r(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:l,offset:n(this.instance),wasRoot:this.scroll?this.scroll.isRoot:l}}}resetTransform(){if(!i)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,s=this.projectionDelta&&!sj(this.projectionDelta),l=this.getTransformTemplate(),c=l?l(this.latestValues,""):void 0,f=c!==this.prevTransformTemplateValue;o&&this.instance&&(s||q0(this.latestValues)||f)&&(i(this.instance,c),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const s=this.measurePageBox();let l=this.removeElementScroll(s);return o&&(l=this.removeTransform(l)),Sde(l),{animationId:this.root.animationId,measuredBox:s,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:o}=this.options;if(!o)return aa();const s=o.measureViewportBox();if(!(this.scroll?.wasRoot||this.path.some(Tde))){const{scroll:c}=this.root;c&&(rg(s.x,c.offset.x),rg(s.y,c.offset.y))}return s}removeElementScroll(o){const s=aa();if(Dl(s,o),this.scroll?.wasRoot)return s;for(let l=0;l<this.path.length;l++){const c=this.path[l],{scroll:f,options:u}=c;c!==this.root&&f&&u.layoutScroll&&(f.wasRoot&&Dl(s,o),rg(s.x,f.offset.x),rg(s.y,f.offset.y))}return s}applyTransform(o,s=!1){const l=aa();Dl(l,o);for(let c=0;c<this.path.length;c++){const f=this.path[c];!s&&f.options.layoutScroll&&f.scroll&&f!==f.root&&ig(l,{x:-f.scroll.offset.x,y:-f.scroll.offset.y}),q0(f.latestValues)&&ig(l,f.latestValues)}return q0(this.latestValues)&&ig(l,this.latestValues),l}removeTransform(o){const s=aa();Dl(s,o);for(let l=0;l<this.path.length;l++){const c=this.path[l];if(!c.instance||!q0(c.latestValues))continue;m6(c.latestValues)&&c.updateSnapshot();const f=aa(),u=c.measurePageBox();Dl(f,u),GA(s,c.latestValues,c.snapshot?c.snapshot.layoutBox:void 0,f)}return q0(this.latestValues)&&GA(s,this.latestValues),s}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==uo.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){const s=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=s.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=s.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=s.isSharedProjectionDirty);const l=!!this.resumingFrom||this!==s;if(!(o||l&&this.isSharedProjectionDirty||this.isProjectionDirty||this.parent?.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:f,layoutId:u}=this.options;if(!(!this.layout||!(f||u))){if(this.resolvedRelativeTargetAt=uo.timestamp,!this.targetDelta&&!this.relativeTarget){const d=this.getClosestProjectingParent();d&&d.layout&&this.animationProgress!==1?(this.relativeParent=d,this.forceRelativeParentToResolveTarget(),this.relativeTarget=aa(),this.relativeTargetOrigin=aa(),Yv(this.relativeTargetOrigin,this.layout.layoutBox,d.layout.layoutBox),Dl(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=aa(),this.targetWithTransforms=aa()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),Ife(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Dl(this.target,this.layout.layoutBox),GG(this.target,this.targetDelta)):Dl(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const d=this.getClosestProjectingParent();d&&!!d.resumingFrom==!!this.resumingFrom&&!d.options.layoutScroll&&d.target&&this.animationProgress!==1?(this.relativeParent=d,this.forceRelativeParentToResolveTarget(),this.relativeTarget=aa(),this.relativeTargetOrigin=aa(),Yv(this.relativeTargetOrigin,this.target,d.target),Dl(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}Qc.value&&X0.calculatedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||m6(this.parent.latestValues)||$G(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){const o=this.getLead(),s=!!this.resumingFrom||this!==o;let l=!0;if((this.isProjectionDirty||this.parent?.isProjectionDirty)&&(l=!1),s&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(l=!1),this.resolvedRelativeTargetAt===uo.timestamp&&(l=!1),l)return;const{layout:c,layoutId:f}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(c||f))return;Dl(this.layoutCorrected,this.layout.layoutBox);const u=this.treeScale.x,d=this.treeScale.y;Gue(this.layoutCorrected,this.treeScale,this.path,s),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox,o.targetWithTransforms=aa());const{target:h}=o;if(!h){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(UA(this.prevProjectionDelta.x,this.projectionDelta.x),UA(this.prevProjectionDelta.y,this.projectionDelta.y)),Xv(this.projectionDelta,this.layoutCorrected,h,this.latestValues),(this.treeScale.x!==u||this.treeScale.y!==d||!KA(this.projectionDelta.x,this.prevProjectionDelta.x)||!KA(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",h)),Qc.value&&X0.calculatedProjections++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){if(this.options.visualElement?.scheduleRender(),o){const s=this.getStack();s&&s.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=ag(),this.projectionDelta=ag(),this.projectionDeltaWithTransform=ag()}setAnimationOrigin(o,s=!1){const l=this.snapshot,c=l?l.latestValues:{},f={...this.latestValues},u=ag();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!s;const d=aa(),h=l?l.source:void 0,p=this.layout?this.layout.source:void 0,g=h!==p,m=this.getStack(),y=!m||m.members.length<=1,v=!!(g&&!y&&this.options.crossfade===!0&&!this.path.some(wde));this.animationProgress=0;let x;this.mixTargetDelta=w=>{const S=w/1e3;JA(u.x,o.x,S),JA(u.y,o.y,S),this.setTargetDelta(u),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Yv(d,this.layout.layoutBox,this.relativeParent.layout.layoutBox),bde(this.relativeTarget,this.relativeTargetOrigin,d,S),x&&ade(this.relativeTarget,x)&&(this.isProjectionDirty=!1),x||(x=aa()),Dl(x,this.relativeTarget)),g&&(this.animationValues=f,Qfe(f,c,this.latestValues,S,v,y)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=S},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation?.stop(),this.resumingFrom?.currentAnimation?.stop(),this.pendingAnimation&&(Qd(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=gi.update(()=>{Ib.hasAnimatedSinceResize=!0,xh.layout++,this.motionValue||(this.motionValue=lm(0)),this.currentAnimation=qfe(this.motionValue,[0,1e3],{...o,velocity:0,isSync:!0,onUpdate:s=>{this.mixTargetDelta(s),o.onUpdate&&o.onUpdate(s)},onStop:()=>{xh.layout--},onComplete:()=>{xh.layout--,o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(lde),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:s,target:l,layout:c,latestValues:f}=o;if(!(!s||!l||!c)){if(this!==o&&this.layout&&c&&fj(this.options.animationType,this.layout.layoutBox,c.layoutBox)){l=this.target||aa();const u=es(this.layout.layoutBox.x);l.x.min=o.target.x.min,l.x.max=l.x.min+u;const d=es(this.layout.layoutBox.y);l.y.min=o.target.y.min,l.y.max=l.y.min+d}Dl(s,l),ig(s,f),Xv(this.projectionDeltaWithTransform,this.layoutCorrected,s,f)}}registerSharedNode(o,s){this.sharedNodes.has(o)||this.sharedNodes.set(o,new ode),this.sharedNodes.get(o).add(s);const c=s.options.initialPromotionConfig;s.promote({transition:c?c.transition:void 0,preserveFollowOpacity:c&&c.shouldPreserveFollowOpacity?c.shouldPreserveFollowOpacity(s):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){const{layoutId:o}=this.options;return o?this.getStack()?.lead||this:this}getPrevLead(){const{layoutId:o}=this.options;return o?this.getStack()?.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:s,preserveFollowOpacity:l}={}){const c=this.getStack();c&&c.promote(this,l),o&&(this.projectionDelta=void 0,this.needsReset=!0),s&&this.setOptions({transition:s})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let s=!1;const{latestValues:l}=o;if((l.z||l.rotate||l.rotateX||l.rotateY||l.rotateZ||l.skewX||l.skewY)&&(s=!0),!s)return;const c={};l.z&&$T("z",o,c,this.animationValues);for(let f=0;f<BT.length;f++)$T(`rotate${BT[f]}`,o,c,this.animationValues),$T(`skew${BT[f]}`,o,c,this.animationValues);o.render();for(const f in c)o.setStaticValue(f,c[f]),this.animationValues&&(this.animationValues[f]=c[f]);o.scheduleRender()}applyProjectionStyles(o,s){if(!this.instance||this.isSVG)return;if(!this.isVisible){o.visibility="hidden";return}const l=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,o.visibility="",o.opacity="",o.pointerEvents=Mb(s?.pointerEvents)||"",o.transform=l?l(this.latestValues,""):"none";return}const c=this.getLead();if(!this.projectionDelta||!this.layout||!c.target){this.options.layoutId&&(o.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,o.pointerEvents=Mb(s?.pointerEvents)||""),this.hasProjected&&!q0(this.latestValues)&&(o.transform=l?l({},""):"none",this.hasProjected=!1);return}o.visibility="";const f=c.animationValues||c.latestValues;this.applyTransformsToTarget();let u=sde(this.projectionDeltaWithTransform,this.treeScale,f);l&&(u=l(f,u)),o.transform=u;const{x:d,y:h}=this.projectionDelta;o.transformOrigin=`${d.origin*100}% ${h.origin*100}% 0`,c.animationValues?o.opacity=c===this?f.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:f.opacityExit:o.opacity=c===this?f.opacity!==void 0?f.opacity:"":f.opacityExit!==void 0?f.opacityExit:0;for(const p in M2){if(f[p]===void 0)continue;const{correct:g,applyTo:m,isCSSVariable:y}=M2[p],v=u==="none"?f[p]:g(f[p],c);if(m){const x=m.length;for(let w=0;w<x;w++)o[m[w]]=v}else y?this.options.visualElement.renderState.vars[p]=v:o[p]=v}this.options.layoutId&&(o.pointerEvents=c===this?Mb(s?.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>o.currentAnimation?.stop()),this.root.nodes.forEach(qA),this.root.sharedNodes.clear()}}}function ude(t){t.updateLayout()}function fde(t){const e=t.resumeFrom?.snapshot||t.snapshot;if(t.isLead()&&t.layout&&e&&t.hasListeners("didUpdate")){const{layoutBox:n,measuredBox:r}=t.layout,{animationType:i}=t.options,a=e.source!==t.layout.source;i==="size"?Ml(f=>{const u=a?e.measuredBox[f]:e.layoutBox[f],d=es(u);u.min=n[f].min,u.max=u.min+d}):fj(i,e.layoutBox,n)&&Ml(f=>{const u=a?e.measuredBox[f]:e.layoutBox[f],d=es(n[f]);u.max=u.min+d,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[f].max=t.relativeTarget[f].min+d)});const o=ag();Xv(o,n,e.layoutBox);const s=ag();a?Xv(s,t.applyTransform(r,!0),e.measuredBox):Xv(s,n,e.layoutBox);const l=!sj(o);let c=!1;if(!t.resumeFrom){const f=t.getClosestProjectingParent();if(f&&!f.resumeFrom){const{snapshot:u,layout:d}=f;if(u&&d){const h=aa();Yv(h,e.layoutBox,u.layoutBox);const p=aa();Yv(p,n,d.layoutBox),lj(h,p)||(c=!0),f.options.layoutRoot&&(t.relativeTarget=p,t.relativeTargetOrigin=h,t.relativeParent=f)}}}t.notifyListeners("didUpdate",{layout:n,snapshot:e,delta:s,layoutDelta:o,hasLayoutChanged:l,hasRelativeLayoutChanged:c})}else if(t.isLead()){const{onExitComplete:n}=t.options;n&&n()}t.options.transition=void 0}function dde(t){Qc.value&&X0.nodes++,t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function hde(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function pde(t){t.clearSnapshot()}function qA(t){t.clearMeasurements()}function XA(t){t.isLayoutDirty=!1}function gde(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function YA(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function mde(t){t.resolveTargetDelta()}function vde(t){t.calcProjection()}function yde(t){t.resetSkewAndRotation()}function xde(t){t.removeLeadSnapshot()}function JA(t,e,n){t.translate=Pi(e.translate,0,n),t.scale=Pi(e.scale,1,n),t.origin=e.origin,t.originPoint=e.originPoint}function ZA(t,e,n,r){t.min=Pi(e.min,n.min,r),t.max=Pi(e.max,n.max,r)}function bde(t,e,n,r){ZA(t.x,e.x,n.x,r),ZA(t.y,e.y,n.y,r)}function wde(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const Cde={duration:.45,ease:[.4,0,.1,1]},QA=t=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(t),eN=QA("applewebkit/")&&!QA("chrome/")?Math.round:kl;function tN(t){t.min=eN(t.min),t.max=eN(t.max)}function Sde(t){tN(t.x),tN(t.y)}function fj(t,e,n){return t==="position"||t==="preserve-aspect"&&!Mfe(HA(e),HA(n),.2)}function Tde(t){return t!==t.root&&t.scroll?.wasRoot}const Ede=uj({attachResizeListener:(t,e)=>I2(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),GT={current:void 0},dj=uj({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!GT.current){const t=new Ede({});t.mount(window),t.setOptions({layoutScroll:!0}),GT.current=t}return GT.current},resetTransform:(t,e)=>{t.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),_de={pan:{Feature:zfe},drag:{Feature:jfe,ProjectionNode:dj,MeasureLayout:ij}};function nN(t,e,n){const{props:r}=t;t.animationState&&r.whileHover&&t.animationState.setActive("whileHover",n==="Start");const i="onHover"+n,a=r[i];a&&gi.postRender(()=>a(e,xy(e)))}class Dde extends p0{mount(){const{current:e}=this.node;e&&(this.unmount=zce(e,(n,r)=>(nN(this.node,r,"Start"),i=>nN(this.node,i,"End"))))}unmount(){}}class Ode extends p0{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=my(I2(this.node.current,"focus",()=>this.onFocus()),I2(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function rN(t,e,n){const{props:r}=t;if(t.current instanceof HTMLButtonElement&&t.current.disabled)return;t.animationState&&r.whileTap&&t.animationState.setActive("whileTap",n==="Start");const i="onTap"+(n==="End"?"":n),a=r[i];a&&gi.postRender(()=>a(e,xy(e)))}class Mde extends p0{mount(){const{current:e}=this.node;e&&(this.unmount=qce(e,(n,r)=>(rN(this.node,r,"Start"),(i,{success:a})=>rN(this.node,i,a?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const S6=new WeakMap,jT=new WeakMap,Ide=t=>{const e=S6.get(t.target);e&&e(t)},Rde=t=>{t.forEach(Ide)};function Pde({root:t,...e}){const n=t||document;jT.has(n)||jT.set(n,{});const r=jT.get(n),i=JSON.stringify(e);return r[i]||(r[i]=new IntersectionObserver(Rde,{root:t,...e})),r[i]}function Ade(t,e,n){const r=Pde(e);return S6.set(t,n),r.observe(t),()=>{S6.delete(t),r.unobserve(t)}}const Nde={some:0,all:1};class Lde extends p0{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:n,margin:r,amount:i="some",once:a}=e,o={root:n?n.current:void 0,rootMargin:r,threshold:typeof i=="number"?i:Nde[i]},s=l=>{const{isIntersecting:c}=l;if(this.isInView===c||(this.isInView=c,a&&!c&&this.hasEnteredView))return;c&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",c);const{onViewportEnter:f,onViewportLeave:u}=this.node.getProps(),d=c?f:u;d&&d(l)};return Ade(this.node.current,o,s)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:n}=this.node;["amount","margin","root"].some(kde(e,n))&&this.startObserver()}unmount(){}}function kde({viewport:t={}},{viewport:e={}}={}){return n=>t[n]!==e[n]}const Vde={inView:{Feature:Lde},tap:{Feature:Mde},focus:{Feature:Ode},hover:{Feature:Dde}},Fde={layout:{ProjectionNode:dj,MeasureLayout:ij}},Ude={renderer:Zue,...Sfe,...Vde},Bde={...Ude,..._de,...Fde},gC=typeof document<"u"?un.useLayoutEffect:()=>{};var zT;const $de=(zT=un.useInsertionEffect)!==null&&zT!==void 0?zT:gC;function iN(t){const e=H.useRef(null);return $de(()=>{e.current=t},[t]),H.useCallback((...n)=>{const r=e.current;return r?.(...n)},[])}function Gde(t){let[e,n]=H.useState(t),r=H.useRef(null),i=iN(()=>{if(!r.current)return;let o=r.current.next();if(o.done){r.current=null;return}e===o.value?i():n(o.value)});gC(()=>{r.current&&i()});let a=iN(o=>{r.current=o(e),i()});return[e,a]}let jde=!!(typeof window<"u"&&window.document&&window.document.createElement),Fg=new Map,bv;typeof FinalizationRegistry<"u"&&(bv=new FinalizationRegistry(t=>{Fg.delete(t)}));function R2(t){let[e,n]=H.useState(t),r=H.useRef(null),i=y$(e),a=H.useRef(null);if(bv&&bv.register(a,i),jde){const o=Fg.get(i);o&&!o.includes(r)?o.push(r):Fg.set(i,[r])}return gC(()=>{let o=i;return()=>{bv&&bv.unregister(a),Fg.delete(o)}},[i]),H.useEffect(()=>{let o=r.current;return o&&n(o),()=>{o&&(r.current=null)}}),i}function zde(t,e){if(t===e)return t;let n=Fg.get(t);if(n)return n.forEach(i=>i.current=e),e;let r=Fg.get(e);return r?(r.forEach(i=>i.current=t),t):e}function aN(t=[]){let e=R2(),[n,r]=Gde(e),i=H.useCallback(()=>{r(function*(){yield e,yield document.getElementById(e)?e:void 0})},[e,r]);return gC(i,[e,i,...t]),n}function hj(...t){return(...e)=>{for(let n of t)typeof n=="function"&&n(...e)}}function P2(...t){let e={...t[0]};for(let n=1;n<t.length;n++){let r=t[n];for(let i in r){let a=e[i],o=r[i];typeof a=="function"&&typeof o=="function"&&i[0]==="o"&&i[1]==="n"&&i.charCodeAt(2)>=65&&i.charCodeAt(2)<=90?e[i]=hj(a,o):(i==="className"||i==="UNSAFE_className")&&typeof a=="string"&&typeof o=="string"?e[i]=E$(a,o):i==="id"&&a&&o?e.id=zde(a,o):e[i]=o!==void 0?o:a}}return e}const Wde=new Set(["id"]),Hde=new Set(["aria-label","aria-labelledby","aria-describedby","aria-details"]),Kde=new Set(["href","hrefLang","target","rel","download","ping","referrerPolicy"]),qde=new Set(["dir","lang","hidden","inert","translate"]),oN=new Set(["onClick","onAuxClick","onContextMenu","onDoubleClick","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onTouchCancel","onTouchEnd","onTouchMove","onTouchStart","onPointerDown","onPointerMove","onPointerUp","onPointerCancel","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut","onGotPointerCapture","onLostPointerCapture","onScroll","onWheel","onAnimationStart","onAnimationEnd","onAnimationIteration","onTransitionCancel","onTransitionEnd","onTransitionRun","onTransitionStart"]),Xde=/^(data-.*)$/;function pj(t,e={}){let{labelable:n,isLink:r,global:i,events:a=i,propNames:o}=e,s={};for(const l in t)Object.prototype.hasOwnProperty.call(t,l)&&(Wde.has(l)||n&&Hde.has(l)||r&&Kde.has(l)||i&&qde.has(l)||a&&oN.has(l)||l.endsWith("Capture")&&oN.has(l.slice(0,-7))||o?.has(l)||Xde.test(l))&&(s[l]=t[l]);return s}function Yde(t){if(Jde())t.focus({preventScroll:!0});else{let e=Zde(t);t.focus(),Qde(e)}}let ax=null;function Jde(){if(ax==null){ax=!1;try{document.createElement("div").focus({get preventScroll(){return ax=!0,!0}})}catch{}}return ax}function Zde(t){let e=t.parentNode,n=[],r=document.scrollingElement||document.documentElement;for(;e instanceof HTMLElement&&e!==r;)(e.offsetHeight<e.scrollHeight||e.offsetWidth<e.scrollWidth)&&n.push({element:e,scrollTop:e.scrollTop,scrollLeft:e.scrollLeft}),e=e.parentNode;return r instanceof HTMLElement&&n.push({element:r,scrollTop:r.scrollTop,scrollLeft:r.scrollLeft}),n}function Qde(t){for(let{element:e,scrollTop:n,scrollLeft:r}of t)e.scrollTop=n,e.scrollLeft=r}function hD(t){var e;if(typeof window>"u"||window.navigator==null)return!1;let n=(e=window.navigator.userAgentData)===null||e===void 0?void 0:e.brands;return Array.isArray(n)&&n.some(r=>t.test(r.brand))||t.test(window.navigator.userAgent)}function gj(t){var e;return typeof window<"u"&&window.navigator!=null?t.test(((e=window.navigator.userAgentData)===null||e===void 0?void 0:e.platform)||window.navigator.platform):!1}function by(t){let e=null;return()=>(e==null&&(e=t()),e)}const T6=by(function(){return gj(/^Mac/i)}),e0e=by(function(){return gj(/^iPad/i)||T6()&&navigator.maxTouchPoints>1}),t0e=by(function(){return hD(/AppleWebKit/i)&&!n0e()}),n0e=by(function(){return hD(/Chrome/i)}),r0e=by(function(){return hD(/Firefox/i)}),mj=H.createContext({isNative:!0,open:o0e,useHref:t=>t});function i0e(t){let{children:e,navigate:n,useHref:r}=t,i=H.useMemo(()=>({isNative:!1,open:(a,o,s,l)=>{yj(a,c=>{vj(c,o)?n(s,l):A2(c,o)})},useHref:r||(a=>a)}),[n,r]);return un.createElement(mj.Provider,{value:i},e)}function a0e(){return H.useContext(mj)}function vj(t,e){let n=t.getAttribute("target");return(!n||n==="_self")&&t.origin===location.origin&&!t.hasAttribute("download")&&!e.metaKey&&!e.ctrlKey&&!e.altKey&&!e.shiftKey}function A2(t,e,n=!0){var r,i;let{metaKey:a,ctrlKey:o,altKey:s,shiftKey:l}=e;r0e()&&(!((i=window.event)===null||i===void 0||(r=i.type)===null||r===void 0)&&r.startsWith("key"))&&t.target==="_blank"&&(T6()?a=!0:o=!0);let c=t0e()&&T6()&&!e0e()?new KeyboardEvent("keydown",{keyIdentifier:"Enter",metaKey:a,ctrlKey:o,altKey:s,shiftKey:l}):new MouseEvent("click",{metaKey:a,ctrlKey:o,altKey:s,shiftKey:l,bubbles:!0,cancelable:!0});A2.isOpening=n,Yde(t),t.dispatchEvent(c),A2.isOpening=!1}A2.isOpening=!1;function yj(t,e){if(t instanceof HTMLAnchorElement)e(t);else if(t.hasAttribute("data-href")){let n=document.createElement("a");n.href=t.getAttribute("data-href"),t.hasAttribute("data-target")&&(n.target=t.getAttribute("data-target")),t.hasAttribute("data-rel")&&(n.rel=t.getAttribute("data-rel")),t.hasAttribute("data-download")&&(n.download=t.getAttribute("data-download")),t.hasAttribute("data-ping")&&(n.ping=t.getAttribute("data-ping")),t.hasAttribute("data-referrer-policy")&&(n.referrerPolicy=t.getAttribute("data-referrer-policy")),t.appendChild(n),e(n),t.removeChild(n)}}function o0e(t,e){yj(t,n=>A2(n,e))}function s0e(t,e){let{id:n,"aria-label":r,"aria-labelledby":i}=t;return n=R2(n),i&&r?i=[...new Set([n,...i.trim().split(/\s+/)])].join(" "):i&&(i=i.trim().split(/\s+/).join(" ")),!r&&!i&&e&&(r=e),{id:n,"aria-label":r,"aria-labelledby":i}}function sN(t,e){if(!t)return!1;let n=window.getComputedStyle(t),r=/(auto|scroll)/.test(n.overflow+n.overflowX+n.overflowY);return r&&e&&(r=t.scrollHeight!==t.clientHeight||t.scrollWidth!==t.clientWidth),r}const ru={top:"top",bottom:"top",left:"left",right:"left"},Ow={top:"bottom",bottom:"top",left:"right",right:"left"},l0e={top:"left",left:"top"},E6={top:"height",left:"width"},xj={width:"totalWidth",height:"totalHeight"},ox={};let qa=typeof document<"u"?window.visualViewport:null;function lN(t){let e=0,n=0,r=0,i=0,a=0,o=0,s={};var l;let c=((l=qa?.scale)!==null&&l!==void 0?l:1)>1;if(t.tagName==="BODY"){let p=document.documentElement;r=p.clientWidth,i=p.clientHeight;var f;e=(f=qa?.width)!==null&&f!==void 0?f:r;var u;n=(u=qa?.height)!==null&&u!==void 0?u:i,s.top=p.scrollTop||t.scrollTop,s.left=p.scrollLeft||t.scrollLeft,qa&&(a=qa.offsetTop,o=qa.offsetLeft)}else({width:e,height:n,top:a,left:o}=Ug(t)),s.top=t.scrollTop,s.left=t.scrollLeft,r=e,i=n;if(M9()&&(t.tagName==="BODY"||t.tagName==="HTML")&&c){s.top=0,s.left=0;var d;a=(d=qa?.pageTop)!==null&&d!==void 0?d:0;var h;o=(h=qa?.pageLeft)!==null&&h!==void 0?h:0}return{width:e,height:n,totalWidth:r,totalHeight:i,scroll:s,top:a,left:o}}function c0e(t){return{top:t.scrollTop,left:t.scrollLeft,width:t.scrollWidth,height:t.scrollHeight}}function cN(t,e,n,r,i,a,o){var s;let l=(s=i.scroll[t])!==null&&s!==void 0?s:0,c=r[E6[t]],f=r.scroll[ru[t]]+a,u=c+r.scroll[ru[t]]-a,d=e-l+o[t]-r[ru[t]],h=e-l+n+o[t]-r[ru[t]];return d<f?f-d:h>u?Math.max(u-h,f-d):0}function u0e(t){let e=window.getComputedStyle(t);return{top:parseInt(e.marginTop,10)||0,bottom:parseInt(e.marginBottom,10)||0,left:parseInt(e.marginLeft,10)||0,right:parseInt(e.marginRight,10)||0}}function uN(t){if(ox[t])return ox[t];let[e,n]=t.split(" "),r=ru[e]||"right",i=l0e[r];ru[n]||(n="center");let a=E6[r],o=E6[i];return ox[t]={placement:e,crossPlacement:n,axis:r,crossAxis:i,size:a,crossSize:o},ox[t]}function WT(t,e,n,r,i,a,o,s,l,c){let{placement:f,crossPlacement:u,axis:d,crossAxis:h,size:p,crossSize:g}=r,m={};var y;m[h]=(y=t[h])!==null&&y!==void 0?y:0;var v,x,w,S;u==="center"?m[h]+=(((v=t[g])!==null&&v!==void 0?v:0)-((x=n[g])!==null&&x!==void 0?x:0))/2:u!==h&&(m[h]+=((w=t[g])!==null&&w!==void 0?w:0)-((S=n[g])!==null&&S!==void 0?S:0)),m[h]+=a;const T=t[h]-n[g]+l+c,_=t[h]+t[g]-l-c;if(m[h]=t6(m[h],T,_),f===d){const D=s?o[p]:e[xj[p]];m[Ow[d]]=Math.floor(D-t[d]+i)}else m[d]=Math.floor(t[d]+t[p]+i);return m}function f0e(t,e,n,r,i,a,o,s){const l=r?n.height:e[xj.height];var c;let f=t.top!=null?n.top+t.top:n.top+(l-((c=t.bottom)!==null&&c!==void 0?c:0)-o);var u,d,h,p,g,m;let y=s!=="top"?Math.max(0,e.height+e.top+((u=e.scroll.top)!==null&&u!==void 0?u:0)-f-(((d=i.top)!==null&&d!==void 0?d:0)+((h=i.bottom)!==null&&h!==void 0?h:0)+a)):Math.max(0,f+o-(e.top+((p=e.scroll.top)!==null&&p!==void 0?p:0))-(((g=i.top)!==null&&g!==void 0?g:0)+((m=i.bottom)!==null&&m!==void 0?m:0)+a));return Math.min(e.height-a*2,y)}function fN(t,e,n,r,i,a){let{placement:o,axis:s,size:l}=a;var c,f;if(o===s)return Math.max(0,n[s]-t[s]-((c=t.scroll[s])!==null&&c!==void 0?c:0)+e[s]-((f=r[s])!==null&&f!==void 0?f:0)-r[Ow[s]]-i);var u;return Math.max(0,t[l]+t[s]+t.scroll[s]-e[s]-n[s]-n[l]-((u=r[s])!==null&&u!==void 0?u:0)-r[Ow[s]]-i)}function d0e(t,e,n,r,i,a,o,s,l,c,f,u,d,h,p,g){let m=uN(t),{size:y,crossAxis:v,crossSize:x,placement:w,crossPlacement:S}=m,T=WT(e,s,n,m,f,u,c,d,p,g),_=f,D=fN(s,c,e,i,a+f,m);if(o&&r[y]>D){let ye=uN(`${Ow[w]} ${S}`),ve=WT(e,s,n,ye,f,u,c,d,p,g);fN(s,c,e,i,a+f,ye)>D&&(m=ye,T=ve,_=f)}let I="bottom";m.axis==="top"?m.placement==="top"?I="top":m.placement==="bottom"&&(I="bottom"):m.crossAxis==="top"&&(m.crossPlacement==="top"?I="bottom":m.crossPlacement==="bottom"&&(I="top"));let R=cN(v,T[v],n[x],s,l,a,c);T[v]+=R;let O=f0e(T,s,c,d,i,a,n.height,I);h&&h<O&&(O=h),n.height=Math.min(n.height,O),T=WT(e,s,n,m,_,u,c,d,p,g),R=cN(v,T[v],n[x],s,l,a,c),T[v]+=R;let P={},N=e[v]+.5*e[x]-T[v]-i[ru[v]];const A=p/2+g;var B,V,$,U;const G=ru[v]==="left"?((B=i.left)!==null&&B!==void 0?B:0)+((V=i.right)!==null&&V!==void 0?V:0):(($=i.top)!==null&&$!==void 0?$:0)+((U=i.bottom)!==null&&U!==void 0?U:0),F=n[x]-G-p/2-g,J=e[v]+p/2-(T[v]+i[ru[v]]),Q=e[v]+e[x]-p/2-(T[v]+i[ru[v]]),ne=t6(N,J,Q);return P[v]=t6(ne,A,F),{position:T,maxHeight:O,arrowOffsetLeft:P.left,arrowOffsetTop:P.top,placement:m.placement}}function h0e(t){let{placement:e,targetNode:n,overlayNode:r,scrollNode:i,padding:a,shouldFlip:o,boundaryElement:s,offset:l,crossOffset:c,maxHeight:f,arrowSize:u=0,arrowBoundaryOffset:d=0}=t,h=r instanceof HTMLElement?p0e(r):document.documentElement,p=h===document.documentElement;const g=window.getComputedStyle(h).position;let m=!!g&&g!=="static",y=p?Ug(n):dN(n,h);if(!p){let{marginTop:P,marginLeft:N}=window.getComputedStyle(n);y.top+=parseInt(P,10)||0,y.left+=parseInt(N,10)||0}let v=Ug(r),x=u0e(r);var w,S;v.width+=((w=x.left)!==null&&w!==void 0?w:0)+((S=x.right)!==null&&S!==void 0?S:0);var T,_;v.height+=((T=x.top)!==null&&T!==void 0?T:0)+((_=x.bottom)!==null&&_!==void 0?_:0);let D=c0e(i),I=lN(s),R=lN(h),O=s.tagName==="BODY"?Ug(h):dN(h,s);return h.tagName==="HTML"&&s.tagName==="BODY"&&(R.scroll.top=0,R.scroll.left=0),d0e(e,y,v,D,x,a,o,I,R,O,l,c,m,f,u,d)}function Ug(t){let{top:e,left:n,width:r,height:i}=t.getBoundingClientRect(),{scrollTop:a,scrollLeft:o,clientTop:s,clientLeft:l}=document.documentElement;return{top:e+a-s,left:n+o-l,width:r,height:i}}function dN(t,e){let n=window.getComputedStyle(t),r;if(n.position==="fixed"){let{top:i,left:a,width:o,height:s}=t.getBoundingClientRect();r={top:i,left:a,width:o,height:s}}else{r=Ug(t);let i=Ug(e),a=window.getComputedStyle(e);i.top+=(parseInt(a.borderTopWidth,10)||0)-e.scrollTop,i.left+=(parseInt(a.borderLeftWidth,10)||0)-e.scrollLeft,r.top-=i.top,r.left-=i.left}return r.top-=parseInt(n.marginTop,10)||0,r.left-=parseInt(n.marginLeft,10)||0,r}function p0e(t){let e=t.offsetParent;if(e&&e===document.body&&window.getComputedStyle(e).position==="static"&&!hN(e)&&(e=document.documentElement),e==null)for(e=t.parentElement;e&&!hN(e);)e=e.parentElement;return e||document.documentElement}function hN(t){let e=window.getComputedStyle(t);return e.transform!=="none"||/transform|perspective/.test(e.willChange)||e.filter!=="none"||e.contain==="paint"||"backdropFilter"in e&&e.backdropFilter!=="none"||"WebkitBackdropFilter"in e&&e.WebkitBackdropFilter!=="none"}const bj=new WeakMap;function g0e(t){let{triggerRef:e,isOpen:n,onClose:r}=t;H.useEffect(()=>{if(!n||r===null)return;let i=a=>{let o=a.target;if(!e.current||o instanceof Node&&!o.contains(e.current)||a.target instanceof HTMLInputElement||a.target instanceof HTMLTextAreaElement)return;let s=r||bj.get(e.current);s&&s()};return window.addEventListener("scroll",i,!0),()=>{window.removeEventListener("scroll",i,!0)}},[n,r,e])}const m0e=new Set(["Arab","Syrc","Samr","Mand","Thaa","Mend","Nkoo","Adlm","Rohg","Hebr"]),v0e=new Set(["ae","ar","arc","bcc","bqi","ckb","dv","fa","glk","he","ku","mzn","nqo","pnb","ps","sd","ug","ur","yi"]);function y0e(t){if(Intl.Locale){let n=new Intl.Locale(t).maximize(),r=typeof n.getTextInfo=="function"?n.getTextInfo():n.textInfo;if(r)return r.direction==="rtl";if(n.script)return m0e.has(n.script)}let e=t.split("-")[0];return v0e.has(e)}const x0e=Symbol.for("react-aria.i18n.locale");function wj(){let t=typeof window<"u"&&window[x0e]||typeof navigator<"u"&&(navigator.language||navigator.userLanguage)||"en-US";try{Intl.DateTimeFormat.supportedLocalesOf([t])}catch{t="en-US"}return{locale:t,direction:y0e(t)?"rtl":"ltr"}}let _6=wj(),wv=new Set;function pN(){_6=wj();for(let t of wv)t(_6)}function b0e(){let t=py(),[e,n]=H.useState(_6);return H.useEffect(()=>(wv.size===0&&window.addEventListener("languagechange",pN),wv.add(n),()=>{wv.delete(n),wv.size===0&&window.removeEventListener("languagechange",pN)}),[]),t?{locale:"en-US",direction:"ltr"}:e}const w0e=un.createContext(null);function wy(){let t=b0e();return H.useContext(w0e)||t}const gN=new WeakMap;function C0e(t){let e=gN.get(t);return e||(e=new nC(t),gN.set(t,e)),e}function S0e(t,e){return e&&nC.getGlobalDictionaryForPackage(e)||C0e(t)}function mC(t,e){let{locale:n}=wy(),r=S0e(t,e);return H.useMemo(()=>new xse(n,r),[n,r])}let HT=new Map;function T0e(t){let{locale:e}=wy(),n=e+(t?Object.entries(t).sort((i,a)=>i[0]<a[0]?-1:1).join():"");if(HT.has(n))return HT.get(n);let r=new Intl.Collator(e,t);return HT.set(n,r),r}let ia=typeof document<"u"?window.visualViewport:null;function E0e(t){let{direction:e}=wy(),{arrowSize:n=0,targetRef:r,overlayRef:i,scrollRef:a=i,placement:o="bottom",containerPadding:s=12,shouldFlip:l=!0,boundaryElement:c=typeof document<"u"?document.body:null,offset:f=0,crossOffset:u=0,shouldUpdatePosition:d=!0,isOpen:h=!0,onClose:p,maxHeight:g,arrowBoundaryOffset:m=0}=t,[y,v]=H.useState(null),x=[d,o,i.current,r.current,a.current,s,l,c,f,u,h,e,g,m,n],w=H.useRef(ia?.scale);H.useEffect(()=>{h&&(w.current=ia?.scale)},[h]);let S=H.useCallback(()=>{if(d===!1||!h||!i.current||!r.current||!c||ia?.scale!==w.current)return;let R=null;if(a.current&&a.current.contains(document.activeElement)){var O;let U=(O=document.activeElement)===null||O===void 0?void 0:O.getBoundingClientRect(),G=a.current.getBoundingClientRect();var P;if(R={type:"top",offset:((P=U?.top)!==null&&P!==void 0?P:0)-G.top},R.offset>G.height/2){R.type="bottom";var N;R.offset=((N=U?.bottom)!==null&&N!==void 0?N:0)-G.bottom}}let A=i.current;if(!g&&i.current){var B;A.style.top="0px",A.style.bottom="";var V;A.style.maxHeight=((V=(B=window.visualViewport)===null||B===void 0?void 0:B.height)!==null&&V!==void 0?V:window.innerHeight)+"px"}let $=h0e({placement:D0e(o,e),overlayNode:i.current,targetNode:r.current,scrollNode:a.current||i.current,padding:s,shouldFlip:l,boundaryElement:c,offset:f,crossOffset:u,maxHeight:g,arrowSize:n,arrowBoundaryOffset:m});if($.position){if(A.style.top="",A.style.bottom="",A.style.left="",A.style.right="",Object.keys($.position).forEach(U=>A.style[U]=$.position[U]+"px"),A.style.maxHeight=$.maxHeight!=null?$.maxHeight+"px":"",R&&document.activeElement&&a.current){let U=document.activeElement.getBoundingClientRect(),G=a.current.getBoundingClientRect(),F=U[R.type]-G[R.type];a.current.scrollTop+=F-R.offset}v($)}},x);Nr(S,x),_0e(S),$P({ref:i,onResize:S}),$P({ref:r,onResize:S});let T=H.useRef(!1);Nr(()=>{let R,O=()=>{T.current=!0,clearTimeout(R),R=setTimeout(()=>{T.current=!1},500),S()},P=()=>{T.current&&O()};return ia?.addEventListener("resize",O),ia?.addEventListener("scroll",P),()=>{ia?.removeEventListener("resize",O),ia?.removeEventListener("scroll",P)}},[S]);let _=H.useCallback(()=>{T.current||p?.()},[p,T]);g0e({triggerRef:r,isOpen:h,onClose:p&&_});var D,I;return{overlayProps:{style:{position:"absolute",zIndex:1e5,...y?.position,maxHeight:(D=y?.maxHeight)!==null&&D!==void 0?D:"100vh"}},placement:(I=y?.placement)!==null&&I!==void 0?I:null,arrowProps:{"aria-hidden":"true",role:"presentation",style:{left:y?.arrowOffsetLeft,top:y?.arrowOffsetTop}},updatePosition:S}}function _0e(t){Nr(()=>(window.addEventListener("resize",t,!1),()=>{window.removeEventListener("resize",t,!1)}),[t])}function D0e(t,e){return e==="rtl"?t.replace("start","right").replace("end","left"):t.replace("start","left").replace("end","right")}function pD(t){let e=t;return e.nativeEvent=t,e.isDefaultPrevented=()=>e.defaultPrevented,e.isPropagationStopped=()=>e.cancelBubble,e.persist=()=>{},e}function Cj(t,e){Object.defineProperty(t,"target",{value:e}),Object.defineProperty(t,"currentTarget",{value:e})}function Sj(t){let e=H.useRef({isFocused:!1,observer:null});Nr(()=>{const r=e.current;return()=>{r.observer&&(r.observer.disconnect(),r.observer=null)}},[]);let n=Sr(r=>{t?.(r)});return H.useCallback(r=>{if(r.target instanceof HTMLButtonElement||r.target instanceof HTMLInputElement||r.target instanceof HTMLTextAreaElement||r.target instanceof HTMLSelectElement){e.current.isFocused=!0;let i=r.target,a=o=>{if(e.current.isFocused=!1,i.disabled){let s=pD(o);n(s)}e.current.observer&&(e.current.observer.disconnect(),e.current.observer=null)};i.addEventListener("focusout",a,{once:!0}),e.current.observer=new MutationObserver(()=>{if(e.current.isFocused&&i.disabled){var o;(o=e.current.observer)===null||o===void 0||o.disconnect();let s=i===document.activeElement?null:document.activeElement;i.dispatchEvent(new FocusEvent("blur",{relatedTarget:s})),i.dispatchEvent(new FocusEvent("focusout",{bubbles:!0,relatedTarget:s}))}}),e.current.observer.observe(i,{attributes:!0,attributeFilter:["disabled"]})}},[n])}let Mw=!1;function O0e(t){for(;t&&!lC(t);)t=t.parentElement;let e=Za(t),n=e.document.activeElement;if(!n||n===t)return;Mw=!0;let r=!1,i=f=>{(f.target===n||r)&&f.stopImmediatePropagation()},a=f=>{(f.target===n||r)&&(f.stopImmediatePropagation(),!t&&!r&&(r=!0,Xi(n),l()))},o=f=>{(f.target===t||r)&&f.stopImmediatePropagation()},s=f=>{(f.target===t||r)&&(f.stopImmediatePropagation(),r||(r=!0,Xi(n),l()))};e.addEventListener("blur",i,!0),e.addEventListener("focusout",a,!0),e.addEventListener("focusin",s,!0),e.addEventListener("focus",o,!0);let l=()=>{cancelAnimationFrame(c),e.removeEventListener("blur",i,!0),e.removeEventListener("focusout",a,!0),e.removeEventListener("focusin",s,!0),e.removeEventListener("focus",o,!0),Mw=!1,r=!1},c=requestAnimationFrame(l);return l}let og="default",D6="",Rb=new WeakMap;function M0e(t){if(Dm()){if(og==="default"){const e=In(t);D6=e.documentElement.style.webkitUserSelect,e.documentElement.style.webkitUserSelect="none"}og="disabled"}else if(t instanceof HTMLElement||t instanceof SVGElement){let e="userSelect"in t.style?"userSelect":"webkitUserSelect";Rb.set(t,t.style[e]),t.style[e]="none"}}function mN(t){if(Dm()){if(og!=="disabled")return;og="restoring",setTimeout(()=>{aC(()=>{if(og==="restoring"){const e=In(t);e.documentElement.style.webkitUserSelect==="none"&&(e.documentElement.style.webkitUserSelect=D6||""),D6="",og="default"}})},300)}else if((t instanceof HTMLElement||t instanceof SVGElement)&&t&&Rb.has(t)){let e=Rb.get(t),n="userSelect"in t.style?"userSelect":"webkitUserSelect";t.style[n]==="none"&&(t.style[n]=e),t.getAttribute("style")===""&&t.removeAttribute("style"),Rb.delete(t)}}const Tj=un.createContext({register:()=>{}});Tj.displayName="PressResponderContext";function I0e(t,e){return e.get?e.get.call(t):e.value}function Ej(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function _j(t,e){var n=Ej(t,e,"get");return I0e(t,n)}function R0e(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Iw(t,e,n){var r=Ej(t,e,"set");return R0e(t,r,n),n}function P0e(t){let e=H.useContext(Tj);if(e){let{register:n,...r}=e;t=Ji(r,t),n()}return P9(e,t.ref),t}var sx=new WeakMap;let lx=class{continuePropagation(){Iw(this,sx,!1)}get shouldStopPropagation(){return _j(this,sx)}constructor(e,n,r,i){C$(this,sx,{writable:!0,value:void 0}),Iw(this,sx,!0);var a;let o=(a=i?.target)!==null&&a!==void 0?a:r.currentTarget;const s=o?.getBoundingClientRect();let l,c=0,f,u=null;r.clientX!=null&&r.clientY!=null&&(f=r.clientX,u=r.clientY),s&&(f!=null&&u!=null?(l=f-s.left,c=u-s.top):(l=s.width/2,c=s.height/2)),this.type=e,this.pointerType=n,this.target=r.currentTarget,this.shiftKey=r.shiftKey,this.metaKey=r.metaKey,this.ctrlKey=r.ctrlKey,this.altKey=r.altKey,this.x=l,this.y=c}};const vN=Symbol("linkClicked"),yN="react-aria-pressable-style",xN="data-react-aria-pressable";function g0(t){let{onPress:e,onPressChange:n,onPressStart:r,onPressEnd:i,onPressUp:a,onClick:o,isDisabled:s,isPressed:l,preventFocusOnPress:c,shouldCancelOnPointerExit:f,allowTextSelectionOnPress:u,ref:d,...h}=P0e(t),[p,g]=H.useState(!1),m=H.useRef({isPressed:!1,ignoreEmulatedMouseEvents:!1,didFirePressStart:!1,isTriggeringEvent:!1,activePointerId:null,target:null,isOverTarget:!1,pointerType:null,disposables:[]}),{addGlobalListener:y,removeAllGlobalListeners:v}=Hh(),x=Sr((O,P)=>{let N=m.current;if(s||N.didFirePressStart)return!1;let A=!0;if(N.isTriggeringEvent=!0,r){let B=new lx("pressstart",P,O);r(B),A=B.shouldStopPropagation}return n&&n(!0),N.isTriggeringEvent=!1,N.didFirePressStart=!0,g(!0),A}),w=Sr((O,P,N=!0)=>{let A=m.current;if(!A.didFirePressStart)return!1;A.didFirePressStart=!1,A.isTriggeringEvent=!0;let B=!0;if(i){let V=new lx("pressend",P,O);i(V),B=V.shouldStopPropagation}if(n&&n(!1),g(!1),e&&N&&!s){let V=new lx("press",P,O);e(V),B&&(B=V.shouldStopPropagation)}return A.isTriggeringEvent=!1,B}),S=Sr((O,P)=>{let N=m.current;if(s)return!1;if(a){N.isTriggeringEvent=!0;let A=new lx("pressup",P,O);return a(A),N.isTriggeringEvent=!1,A.shouldStopPropagation}return!0}),T=Sr(O=>{let P=m.current;if(P.isPressed&&P.target){P.didFirePressStart&&P.pointerType!=null&&w(P0(P.target,O),P.pointerType,!1),P.isPressed=!1,P.isOverTarget=!1,P.activePointerId=null,P.pointerType=null,v(),u||mN(P.target);for(let N of P.disposables)N();P.disposables=[]}}),_=Sr(O=>{f&&T(O)}),D=Sr(O=>{o?.(O)}),I=Sr((O,P)=>{if(o){let N=new MouseEvent("click",O);Cj(N,P),o(pD(N))}}),R=H.useMemo(()=>{let O=m.current,P={onKeyDown(A){if(KT(A.nativeEvent,A.currentTarget)&&fi(A.currentTarget,sr(A.nativeEvent))){var B;bN(sr(A.nativeEvent),A.key)&&A.preventDefault();let V=!0;if(!O.isPressed&&!A.repeat){O.target=A.currentTarget,O.isPressed=!0,O.pointerType="keyboard",V=x(A,"keyboard");let $=A.currentTarget,U=G=>{KT(G,$)&&!G.repeat&&fi($,sr(G))&&O.target&&S(P0(O.target,G),"keyboard")};y(In(A.currentTarget),"keyup",Zd(U,N),!0)}V&&A.stopPropagation(),A.metaKey&&gu()&&((B=O.metaKeyEvents)===null||B===void 0||B.set(A.key,A.nativeEvent))}else A.key==="Meta"&&(O.metaKeyEvents=new Map)},onClick(A){if(!(A&&!fi(A.currentTarget,sr(A.nativeEvent)))&&A&&A.button===0&&!O.isTriggeringEvent&&!Lf.isOpening){let B=!0;if(s&&A.preventDefault(),!O.ignoreEmulatedMouseEvents&&!O.isPressed&&(O.pointerType==="virtual"||sC(A.nativeEvent))){let V=x(A,"virtual"),$=S(A,"virtual"),U=w(A,"virtual");D(A),B=V&&$&&U}else if(O.isPressed&&O.pointerType!=="keyboard"){let V=O.pointerType||A.nativeEvent.pointerType||"virtual",$=S(P0(A.currentTarget,A),V),U=w(P0(A.currentTarget,A),V,!0);B=$&&U,O.isOverTarget=!1,D(A),T(A)}O.ignoreEmulatedMouseEvents=!1,B&&A.stopPropagation()}}},N=A=>{var B;if(O.isPressed&&O.target&&KT(A,O.target)){var V;bN(sr(A),A.key)&&A.preventDefault();let U=sr(A),G=fi(O.target,sr(A));w(P0(O.target,A),"keyboard",G),G&&I(A,O.target),v(),A.key!=="Enter"&&gD(O.target)&&fi(O.target,U)&&!A[vN]&&(A[vN]=!0,Lf(O.target,A,!1)),O.isPressed=!1,(V=O.metaKeyEvents)===null||V===void 0||V.delete(A.key)}else if(A.key==="Meta"&&(!((B=O.metaKeyEvents)===null||B===void 0)&&B.size)){var $;let U=O.metaKeyEvents;O.metaKeyEvents=void 0;for(let G of U.values())($=O.target)===null||$===void 0||$.dispatchEvent(new KeyboardEvent("keyup",G))}};if(typeof PointerEvent<"u"){P.onPointerDown=V=>{if(V.button!==0||!fi(V.currentTarget,sr(V.nativeEvent)))return;if(P$(V.nativeEvent)){O.pointerType="virtual";return}O.pointerType=V.pointerType;let $=!0;if(!O.isPressed){O.isPressed=!0,O.isOverTarget=!0,O.activePointerId=V.pointerId,O.target=V.currentTarget,u||M0e(O.target),$=x(V,O.pointerType);let U=sr(V.nativeEvent);"releasePointerCapture"in U&&U.releasePointerCapture(V.pointerId),y(In(V.currentTarget),"pointerup",A,!1),y(In(V.currentTarget),"pointercancel",B,!1)}$&&V.stopPropagation()},P.onMouseDown=V=>{if(fi(V.currentTarget,sr(V.nativeEvent))&&V.button===0){if(c){let $=O0e(V.target);$&&O.disposables.push($)}V.stopPropagation()}},P.onPointerUp=V=>{!fi(V.currentTarget,sr(V.nativeEvent))||O.pointerType==="virtual"||V.button===0&&!O.isPressed&&S(V,O.pointerType||V.pointerType)},P.onPointerEnter=V=>{V.pointerId===O.activePointerId&&O.target&&!O.isOverTarget&&O.pointerType!=null&&(O.isOverTarget=!0,x(P0(O.target,V),O.pointerType))},P.onPointerLeave=V=>{V.pointerId===O.activePointerId&&O.target&&O.isOverTarget&&O.pointerType!=null&&(O.isOverTarget=!1,w(P0(O.target,V),O.pointerType,!1),_(V))};let A=V=>{if(V.pointerId===O.activePointerId&&O.isPressed&&V.button===0&&O.target){if(fi(O.target,sr(V))&&O.pointerType!=null){let $=!1,U=setTimeout(()=>{O.isPressed&&O.target instanceof HTMLElement&&($?T(V):(Xi(O.target),O.target.click()))},80);y(V.currentTarget,"click",()=>$=!0,!0),O.disposables.push(()=>clearTimeout(U))}else T(V);O.isOverTarget=!1}},B=V=>{T(V)};P.onDragStart=V=>{fi(V.currentTarget,sr(V.nativeEvent))&&T(V)}}return P},[y,s,c,v,u,T,_,w,x,S,D,I]);return H.useEffect(()=>{if(!d)return;const O=In(d.current);if(!O||!O.head||O.getElementById(yN))return;const P=O.createElement("style");P.id=yN,P.textContent=`
@layer {
  [${xN}] {
    touch-action: pan-x pan-y pinch-zoom;
  }
}
    `.trim(),O.head.prepend(P)},[d]),H.useEffect(()=>{let O=m.current;return()=>{var P;u||mN((P=O.target)!==null&&P!==void 0?P:void 0);for(let N of O.disposables)N();O.disposables=[]}},[u]),{isPressed:l||p,pressProps:Ji(h,R,{[xN]:!0})}}function gD(t){return t.tagName==="A"&&t.hasAttribute("href")}function KT(t,e){const{key:n,code:r}=t,i=e,a=i.getAttribute("role");return(n==="Enter"||n===" "||n==="Spacebar"||r==="Space")&&!(i instanceof Za(i).HTMLInputElement&&!Dj(i,n)||i instanceof Za(i).HTMLTextAreaElement||i.isContentEditable)&&!((a==="link"||!a&&gD(i))&&n!=="Enter")}function P0(t,e){let n=e.clientX,r=e.clientY;return{currentTarget:t,shiftKey:e.shiftKey,ctrlKey:e.ctrlKey,metaKey:e.metaKey,altKey:e.altKey,clientX:n,clientY:r}}function A0e(t){return t instanceof HTMLInputElement?!1:t instanceof HTMLButtonElement?t.type!=="submit"&&t.type!=="reset":!gD(t)}function bN(t,e){return t instanceof HTMLInputElement?!Dj(t,e):A0e(t)}const N0e=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);function Dj(t,e){return t.type==="checkbox"||t.type==="radio"?e===" ":N0e.has(t.type)}let Kh=null,O6=new Set,Jv=new Map,Mh=!1,M6=!1;const L0e={Tab:!0,Escape:!0};function vC(t,e){for(let n of O6)n(t,e)}function k0e(t){return!(t.metaKey||!gu()&&t.altKey||t.ctrlKey||t.key==="Control"||t.key==="Shift"||t.key==="Meta")}function Rw(t){Mh=!0,k0e(t)&&(Kh="keyboard",vC("keyboard",t))}function Bg(t){Kh="pointer",(t.type==="mousedown"||t.type==="pointerdown")&&(Mh=!0,vC("pointer",t))}function Oj(t){sC(t)&&(Mh=!0,Kh="virtual")}function Mj(t){t.target===window||t.target===document||Mw||!t.isTrusted||(!Mh&&!M6&&(Kh="virtual",vC("virtual",t)),Mh=!1,M6=!1)}function Ij(){Mw||(Mh=!1,M6=!0)}function I6(t){if(typeof window>"u"||typeof document>"u"||Jv.get(Za(t)))return;const e=Za(t),n=In(t);let r=e.HTMLElement.prototype.focus;e.HTMLElement.prototype.focus=function(){Mh=!0,r.apply(this,arguments)},n.addEventListener("keydown",Rw,!0),n.addEventListener("keyup",Rw,!0),n.addEventListener("click",Oj,!0),e.addEventListener("focus",Mj,!0),e.addEventListener("blur",Ij,!1),typeof PointerEvent<"u"&&(n.addEventListener("pointerdown",Bg,!0),n.addEventListener("pointermove",Bg,!0),n.addEventListener("pointerup",Bg,!0)),e.addEventListener("beforeunload",()=>{Rj(t)},{once:!0}),Jv.set(e,{focus:r})}const Rj=(t,e)=>{const n=Za(t),r=In(t);e&&r.removeEventListener("DOMContentLoaded",e),Jv.has(n)&&(n.HTMLElement.prototype.focus=Jv.get(n).focus,r.removeEventListener("keydown",Rw,!0),r.removeEventListener("keyup",Rw,!0),r.removeEventListener("click",Oj,!0),n.removeEventListener("focus",Mj,!0),n.removeEventListener("blur",Ij,!1),typeof PointerEvent<"u"&&(r.removeEventListener("pointerdown",Bg,!0),r.removeEventListener("pointermove",Bg,!0),r.removeEventListener("pointerup",Bg,!0)),Jv.delete(n))};function V0e(t){const e=In(t);let n;return e.readyState!=="loading"?I6(t):(n=()=>{I6(t)},e.addEventListener("DOMContentLoaded",n)),()=>Rj(t,n)}typeof document<"u"&&V0e();function N2(){return Kh!=="pointer"}function Zv(){return Kh}function Pj(t){Kh=t,vC(t,null)}const F0e=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);function U0e(t,e,n){let r=In(n?.target);const i=typeof window<"u"?Za(n?.target).HTMLInputElement:HTMLInputElement,a=typeof window<"u"?Za(n?.target).HTMLTextAreaElement:HTMLTextAreaElement,o=typeof window<"u"?Za(n?.target).HTMLElement:HTMLElement,s=typeof window<"u"?Za(n?.target).KeyboardEvent:KeyboardEvent;return t=t||r.activeElement instanceof i&&!F0e.has(r.activeElement.type)||r.activeElement instanceof a||r.activeElement instanceof o&&r.activeElement.isContentEditable,!(t&&e==="keyboard"&&n instanceof s&&!L0e[n.key])}function Aj(t,e,n){I6(),H.useEffect(()=>{let r=(i,a)=>{U0e(!!n?.isTextInput,i,a)&&t(N2())};return O6.add(r),()=>{O6.delete(r)}},e)}function Nj(t){const e=In(t),n=Ba(e);if(Zv()==="virtual"){let r=n;aC(()=>{Ba(e)===r&&t.isConnected&&Xi(t)})}else Xi(t)}function mD(t){let{isDisabled:e,onFocus:n,onBlur:r,onFocusChange:i}=t;const a=H.useCallback(l=>{if(l.target===l.currentTarget)return r&&r(l),i&&i(!1),!0},[r,i]),o=Sj(a),s=H.useCallback(l=>{const c=In(l.target),f=c?Ba(c):Ba();l.target===l.currentTarget&&f===sr(l.nativeEvent)&&(n&&n(l),i&&i(!0),o(l))},[i,n,o]);return{focusProps:{onFocus:!e&&(n||i||r)?s:void 0,onBlur:!e&&(r||i)?a:void 0}}}function wN(t){if(!t)return;let e=!0;return n=>{let r={...n,preventDefault(){n.preventDefault()},isDefaultPrevented(){return n.isDefaultPrevented()},stopPropagation(){e=!0},continuePropagation(){e=!1},isPropagationStopped(){return e}};t(r),e&&n.stopPropagation()}}function B0e(t){return{keyboardProps:t.isDisabled?{}:{onKeyDown:wN(t.onKeyDown),onKeyUp:wN(t.onKeyUp)}}}let $0e=un.createContext(null);function G0e(t){let e=H.useContext($0e)||{};P9(e,t);let{ref:n,...r}=e;return r}function yC(t,e){let{focusProps:n}=mD(t),{keyboardProps:r}=B0e(t),i=Ji(n,r),a=G0e(e),o=t.isDisabled?{}:a,s=H.useRef(t.autoFocus);H.useEffect(()=>{s.current&&e.current&&Nj(e.current),s.current=!1},[e]);let l=t.excludeFromTabOrder?-1:0;return t.isDisabled&&(l=void 0),{focusableProps:Ji({...i,tabIndex:l},o)}}function Am(t){let{isDisabled:e,onBlurWithin:n,onFocusWithin:r,onFocusWithinChange:i}=t,a=H.useRef({isFocusWithin:!1}),{addGlobalListener:o,removeAllGlobalListeners:s}=Hh(),l=H.useCallback(u=>{u.currentTarget.contains(u.target)&&a.current.isFocusWithin&&!u.currentTarget.contains(u.relatedTarget)&&(a.current.isFocusWithin=!1,s(),n&&n(u),i&&i(!1))},[n,i,a,s]),c=Sj(l),f=H.useCallback(u=>{if(!u.currentTarget.contains(u.target))return;const d=In(u.target),h=Ba(d);if(!a.current.isFocusWithin&&h===sr(u.nativeEvent)){r&&r(u),i&&i(!0),a.current.isFocusWithin=!0,c(u);let p=u.currentTarget;o(d,"focus",g=>{if(a.current.isFocusWithin&&!fi(p,g.target)){let m=new d.defaultView.FocusEvent("blur",{relatedTarget:g.target});Cj(m,p);let y=pD(m);l(y)}},{capture:!0})}},[r,i,c,o,l]);return e?{focusWithinProps:{onFocus:void 0,onBlur:void 0}}:{focusWithinProps:{onFocus:f,onBlur:l}}}let R6=!1,cx=0;function j0e(){R6=!0,setTimeout(()=>{R6=!1},50)}function CN(t){t.pointerType==="touch"&&j0e()}function z0e(){if(!(typeof document>"u"))return cx===0&&typeof PointerEvent<"u"&&document.addEventListener("pointerup",CN),cx++,()=>{cx--,!(cx>0)&&typeof PointerEvent<"u"&&document.removeEventListener("pointerup",CN)}}function il(t){let{onHoverStart:e,onHoverChange:n,onHoverEnd:r,isDisabled:i}=t,[a,o]=H.useState(!1),s=H.useRef({isHovered:!1,ignoreEmulatedMouseEvents:!1,pointerType:"",target:null}).current;H.useEffect(z0e,[]);let{addGlobalListener:l,removeAllGlobalListeners:c}=Hh(),{hoverProps:f,triggerHoverEnd:u}=H.useMemo(()=>{let d=(g,m)=>{if(s.pointerType=m,i||m==="touch"||s.isHovered||!g.currentTarget.contains(g.target))return;s.isHovered=!0;let y=g.currentTarget;s.target=y,l(In(g.target),"pointerover",v=>{s.isHovered&&s.target&&!fi(s.target,v.target)&&h(v,v.pointerType)},{capture:!0}),e&&e({type:"hoverstart",target:y,pointerType:m}),n&&n(!0),o(!0)},h=(g,m)=>{let y=s.target;s.pointerType="",s.target=null,!(m==="touch"||!s.isHovered||!y)&&(s.isHovered=!1,c(),r&&r({type:"hoverend",target:y,pointerType:m}),n&&n(!1),o(!1))},p={};return typeof PointerEvent<"u"&&(p.onPointerEnter=g=>{R6&&g.pointerType==="mouse"||d(g,g.pointerType)},p.onPointerLeave=g=>{!i&&g.currentTarget.contains(g.target)&&h(g,g.pointerType)}),{hoverProps:p,triggerHoverEnd:h}},[e,n,r,i,s,l,c]);return H.useEffect(()=>{i&&u({currentTarget:s.target},s.pointerType)},[i]),{hoverProps:f,isHovered:a}}function W0e(t){let{ref:e,onInteractOutside:n,isDisabled:r,onInteractOutsideStart:i}=t,a=H.useRef({isPointerDown:!1,ignoreEmulatedMouseEvents:!1}),o=Sr(l=>{n&&SN(l,e)&&(i&&i(l),a.current.isPointerDown=!0)}),s=Sr(l=>{n&&n(l)});H.useEffect(()=>{let l=a.current;if(r)return;const c=e.current,f=In(c);if(typeof PointerEvent<"u"){let u=d=>{l.isPointerDown&&SN(d,e)&&s(d),l.isPointerDown=!1};return f.addEventListener("pointerdown",o,!0),f.addEventListener("click",u,!0),()=>{f.removeEventListener("pointerdown",o,!0),f.removeEventListener("click",u,!0)}}},[e,r,o,s])}function SN(t,e){if(t.button>0)return!1;if(t.target){const n=t.target.ownerDocument;if(!n||!n.documentElement.contains(t.target)||t.target.closest("[data-react-aria-top-layer]"))return!1}return e.current?!t.composedPath().includes(e.current):!1}const H0e=500;function K0e(t){let{isDisabled:e,onLongPressStart:n,onLongPressEnd:r,onLongPress:i,threshold:a=H0e,accessibilityDescription:o}=t;const s=H.useRef(void 0);let{addGlobalListener:l,removeGlobalListener:c}=Hh(),{pressProps:f}=g0({isDisabled:e,onPressStart(d){if(d.continuePropagation(),(d.pointerType==="mouse"||d.pointerType==="touch")&&(n&&n({...d,type:"longpressstart"}),s.current=setTimeout(()=>{d.target.dispatchEvent(new PointerEvent("pointercancel",{bubbles:!0})),In(d.target).activeElement!==d.target&&Xi(d.target),i&&i({...d,type:"longpress"}),s.current=void 0},a),d.pointerType==="touch")){let h=p=>{p.preventDefault()};l(d.target,"contextmenu",h,{once:!0}),l(window,"pointerup",()=>{setTimeout(()=>{c(d.target,"contextmenu",h)},30)},{once:!0})}},onPressEnd(d){s.current&&clearTimeout(s.current),r&&(d.pointerType==="mouse"||d.pointerType==="touch")&&r({...d,type:"longpressend"})}}),u=I$(i&&!e?o:void 0);return{longPressProps:Ji(f,u)}}const TN=un.createContext(null),P6="react-aria-focus-scope-restore";let ni=null;function q0e(t){let{children:e,contain:n,restoreFocus:r,autoFocus:i}=t,a=H.useRef(null),o=H.useRef(null),s=H.useRef([]),{parentNode:l}=H.useContext(TN)||{},c=H.useMemo(()=>new N6({scopeRef:s}),[s]);Nr(()=>{let d=l||wa.root;if(wa.getTreeNode(d.scopeRef)&&ni&&!Pw(ni,d.scopeRef)){let h=wa.getTreeNode(ni);h&&(d=h)}d.addChild(c),wa.addNode(c)},[c,l]),Nr(()=>{let d=wa.getTreeNode(s);d&&(d.contain=!!n)},[n]),Nr(()=>{var d;let h=(d=a.current)===null||d===void 0?void 0:d.nextSibling,p=[],g=m=>m.stopPropagation();for(;h&&h!==o.current;)p.push(h),h.addEventListener(P6,g),h=h.nextSibling;return s.current=p,()=>{for(let m of p)m.removeEventListener(P6,g)}},[e]),ehe(s,r,n),J0e(s,n),the(s,r,n),Q0e(s,i),H.useEffect(()=>{const d=Ba(In(s.current?s.current[0]:void 0));let h=null;if(Vl(d,s.current)){for(let p of wa.traverse())p.scopeRef&&Vl(d,p.scopeRef.current)&&(h=p);h===wa.getTreeNode(s)&&(ni=h.scopeRef)}},[s]),Nr(()=>()=>{var d,h,p;let g=(p=(h=wa.getTreeNode(s))===null||h===void 0||(d=h.parent)===null||d===void 0?void 0:d.scopeRef)!==null&&p!==void 0?p:null;(s===ni||Pw(s,ni))&&(!g||wa.getTreeNode(g))&&(ni=g),wa.removeTreeNode(s)},[s]);let f=H.useMemo(()=>X0e(s),[]),u=H.useMemo(()=>({focusManager:f,parentNode:c}),[c,f]);return un.createElement(TN.Provider,{value:u},un.createElement("span",{"data-focus-scope-start":!0,hidden:!0,ref:a}),e,un.createElement("span",{"data-focus-scope-end":!0,hidden:!0,ref:o}))}function X0e(t){return{focusNext(e={}){let n=t.current,{from:r,tabbable:i,wrap:a,accept:o}=e;var s;let l=r||Ba(In((s=n[0])!==null&&s!==void 0?s:void 0)),c=n[0].previousElementSibling,f=lh(n),u=Cf(f,{tabbable:i,accept:o},n);u.currentNode=Vl(l,n)?l:c;let d=u.nextNode();return!d&&a&&(u.currentNode=c,d=u.nextNode()),d&&wf(d,!0),d},focusPrevious(e={}){let n=t.current,{from:r,tabbable:i,wrap:a,accept:o}=e;var s;let l=r||Ba(In((s=n[0])!==null&&s!==void 0?s:void 0)),c=n[n.length-1].nextElementSibling,f=lh(n),u=Cf(f,{tabbable:i,accept:o},n);u.currentNode=Vl(l,n)?l:c;let d=u.previousNode();return!d&&a&&(u.currentNode=c,d=u.previousNode()),d&&wf(d,!0),d},focusFirst(e={}){let n=t.current,{tabbable:r,accept:i}=e,a=lh(n),o=Cf(a,{tabbable:r,accept:i},n);o.currentNode=n[0].previousElementSibling;let s=o.nextNode();return s&&wf(s,!0),s},focusLast(e={}){let n=t.current,{tabbable:r,accept:i}=e,a=lh(n),o=Cf(a,{tabbable:r,accept:i},n);o.currentNode=n[n.length-1].nextElementSibling;let s=o.previousNode();return s&&wf(s,!0),s}}}function lh(t){return t[0].parentElement}function Cv(t){let e=wa.getTreeNode(ni);for(;e&&e.scopeRef!==t;){if(e.contain)return!1;e=e.parent}return!0}function Y0e(t){if(t.checked)return!0;let e=[];if(!t.form)e=[...In(t).querySelectorAll(`input[type="radio"][name="${CSS.escape(t.name)}"]`)].filter(a=>!a.form);else{var n,r;let a=(r=t.form)===null||r===void 0||(n=r.elements)===null||n===void 0?void 0:n.namedItem(t.name);e=[...a??[]]}return e?!e.some(a=>a.checked):!1}function J0e(t,e){let n=H.useRef(void 0),r=H.useRef(void 0);Nr(()=>{let i=t.current;if(!e){r.current&&(cancelAnimationFrame(r.current),r.current=void 0);return}const a=In(i?i[0]:void 0);let o=c=>{if(c.key!=="Tab"||c.altKey||c.ctrlKey||c.metaKey||!Cv(t)||c.isComposing)return;let f=Ba(a),u=t.current;if(!u||!Vl(f,u))return;let d=lh(u),h=Cf(d,{tabbable:!0},u);if(!f)return;h.currentNode=f;let p=c.shiftKey?h.previousNode():h.nextNode();p||(h.currentNode=c.shiftKey?u[u.length-1].nextElementSibling:u[0].previousElementSibling,p=c.shiftKey?h.previousNode():h.nextNode()),c.preventDefault(),p&&wf(p,!0)},s=c=>{(!ni||Pw(ni,t))&&Vl(sr(c),t.current)?(ni=t,n.current=sr(c)):Cv(t)&&!kd(sr(c),t)?n.current?n.current.focus():ni&&ni.current&&A6(ni.current):Cv(t)&&(n.current=sr(c))},l=c=>{r.current&&cancelAnimationFrame(r.current),r.current=requestAnimationFrame(()=>{let f=Zv(),u=(f==="virtual"||f===null)&&I9()&&D$(),d=Ba(a);if(!u&&d&&Cv(t)&&!kd(d,t)){ni=t;let p=sr(c);if(p&&p.isConnected){var h;n.current=p,(h=n.current)===null||h===void 0||h.focus()}else ni.current&&A6(ni.current)}})};return a.addEventListener("keydown",o,!1),a.addEventListener("focusin",s,!1),i?.forEach(c=>c.addEventListener("focusin",s,!1)),i?.forEach(c=>c.addEventListener("focusout",l,!1)),()=>{a.removeEventListener("keydown",o,!1),a.removeEventListener("focusin",s,!1),i?.forEach(c=>c.removeEventListener("focusin",s,!1)),i?.forEach(c=>c.removeEventListener("focusout",l,!1))}},[t,e]),Nr(()=>()=>{r.current&&cancelAnimationFrame(r.current)},[r])}function Lj(t){return kd(t)}function Vl(t,e){return!t||!e?!1:e.some(n=>n.contains(t))}function kd(t,e=null){if(t instanceof Element&&t.closest("[data-react-aria-top-layer]"))return!0;for(let{scopeRef:n}of wa.traverse(wa.getTreeNode(e)))if(n&&Vl(t,n.current))return!0;return!1}function Z0e(t){return kd(t,ni)}function Pw(t,e){var n;let r=(n=wa.getTreeNode(e))===null||n===void 0?void 0:n.parent;for(;r;){if(r.scopeRef===t)return!0;r=r.parent}return!1}function wf(t,e=!1){if(t!=null&&!e)try{Nj(t)}catch{}else if(t!=null)try{t.focus()}catch{}}function kj(t,e=!0){let n=t[0].previousElementSibling,r=lh(t),i=Cf(r,{tabbable:e},t);i.currentNode=n;let a=i.nextNode();return e&&!a&&(r=lh(t),i=Cf(r,{tabbable:!1},t),i.currentNode=n,a=i.nextNode()),a}function A6(t,e=!0){wf(kj(t,e))}function Q0e(t,e){const n=un.useRef(e);H.useEffect(()=>{if(n.current){ni=t;const r=In(t.current?t.current[0]:void 0);!Vl(Ba(r),ni.current)&&t.current&&A6(t.current)}n.current=!1},[t])}function ehe(t,e,n){Nr(()=>{if(e||n)return;let r=t.current;const i=In(r?r[0]:void 0);let a=o=>{let s=sr(o);Vl(s,t.current)?ni=t:Lj(s)||(ni=null)};return i.addEventListener("focusin",a,!1),r?.forEach(o=>o.addEventListener("focusin",a,!1)),()=>{i.removeEventListener("focusin",a,!1),r?.forEach(o=>o.removeEventListener("focusin",a,!1))}},[t,e,n])}function EN(t){let e=wa.getTreeNode(ni);for(;e&&e.scopeRef!==t;){if(e.nodeToRestore)return!1;e=e.parent}return e?.scopeRef===t}function the(t,e,n){const r=H.useRef(typeof document<"u"?Ba(In(t.current?t.current[0]:void 0)):null);Nr(()=>{let i=t.current;const a=In(i?i[0]:void 0);if(!e||n)return;let o=()=>{(!ni||Pw(ni,t))&&Vl(Ba(a),t.current)&&(ni=t)};return a.addEventListener("focusin",o,!1),i?.forEach(s=>s.addEventListener("focusin",o,!1)),()=>{a.removeEventListener("focusin",o,!1),i?.forEach(s=>s.removeEventListener("focusin",o,!1))}},[t,n]),Nr(()=>{const i=In(t.current?t.current[0]:void 0);if(!e)return;let a=o=>{if(o.key!=="Tab"||o.altKey||o.ctrlKey||o.metaKey||!Cv(t)||o.isComposing)return;let s=i.activeElement;if(!kd(s,t)||!EN(t))return;let l=wa.getTreeNode(t);if(!l)return;let c=l.nodeToRestore,f=Cf(i.body,{tabbable:!0});f.currentNode=s;let u=o.shiftKey?f.previousNode():f.nextNode();if((!c||!c.isConnected||c===i.body)&&(c=void 0,l.nodeToRestore=void 0),(!u||!kd(u,t))&&c){f.currentNode=c;do u=o.shiftKey?f.previousNode():f.nextNode();while(kd(u,t));o.preventDefault(),o.stopPropagation(),u?wf(u,!0):Lj(c)?wf(c,!0):s.blur()}};return n||i.addEventListener("keydown",a,!0),()=>{n||i.removeEventListener("keydown",a,!0)}},[t,e,n]),Nr(()=>{const i=In(t.current?t.current[0]:void 0);if(!e)return;let a=wa.getTreeNode(t);if(a){var o;return a.nodeToRestore=(o=r.current)!==null&&o!==void 0?o:void 0,()=>{let s=wa.getTreeNode(t);if(!s)return;let l=s.nodeToRestore,c=Ba(i);if(e&&l&&(c&&kd(c,t)||c===i.body&&EN(t))){let f=wa.clone();requestAnimationFrame(()=>{if(i.activeElement===i.body){let u=f.getTreeNode(t);for(;u;){if(u.nodeToRestore&&u.nodeToRestore.isConnected){_N(u.nodeToRestore);return}u=u.parent}for(u=f.getTreeNode(t);u;){if(u.scopeRef&&u.scopeRef.current&&wa.getTreeNode(u.scopeRef)){let d=kj(u.scopeRef.current,!0);_N(d);return}u=u.parent}}})}}}},[t,e])}function _N(t){t.dispatchEvent(new CustomEvent(P6,{bubbles:!0,cancelable:!0}))&&wf(t)}function Cf(t,e,n){let r=e?.tabbable?A$:lC,i=t?.nodeType===Node.ELEMENT_NODE?t:null,a=In(i),o=S$(a,t||a,NodeFilter.SHOW_ELEMENT,{acceptNode(s){var l;return!(e==null||(l=e.from)===null||l===void 0)&&l.contains(s)||e?.tabbable&&s.tagName==="INPUT"&&s.getAttribute("type")==="radio"&&(!Y0e(s)||o.currentNode.tagName==="INPUT"&&o.currentNode.type==="radio"&&o.currentNode.name===s.name)?NodeFilter.FILTER_REJECT:r(s)&&(!n||Vl(s,n))&&(!e?.accept||e.accept(s))?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});return e?.from&&(o.currentNode=e.from),o}let nhe=class Vj{get size(){return this.fastMap.size}getTreeNode(e){return this.fastMap.get(e)}addTreeNode(e,n,r){let i=this.fastMap.get(n??null);if(!i)return;let a=new N6({scopeRef:e});i.addChild(a),a.parent=i,this.fastMap.set(e,a),r&&(a.nodeToRestore=r)}addNode(e){this.fastMap.set(e.scopeRef,e)}removeTreeNode(e){if(e===null)return;let n=this.fastMap.get(e);if(!n)return;let r=n.parent;for(let a of this.traverse())a!==n&&n.nodeToRestore&&a.nodeToRestore&&n.scopeRef&&n.scopeRef.current&&Vl(a.nodeToRestore,n.scopeRef.current)&&(a.nodeToRestore=n.nodeToRestore);let i=n.children;r&&(r.removeChild(n),i.size>0&&i.forEach(a=>r&&r.addChild(a))),this.fastMap.delete(n.scopeRef)}*traverse(e=this.root){if(e.scopeRef!=null&&(yield e),e.children.size>0)for(let n of e.children)yield*this.traverse(n)}clone(){var e;let n=new Vj;var r;for(let i of this.traverse())n.addTreeNode(i.scopeRef,(r=(e=i.parent)===null||e===void 0?void 0:e.scopeRef)!==null&&r!==void 0?r:null,i.nodeToRestore);return n}constructor(){this.fastMap=new Map,this.root=new N6({scopeRef:null}),this.fastMap.set(null,this.root)}},N6=class{addChild(e){this.children.add(e),e.parent=this}removeChild(e){this.children.delete(e),e.parent=void 0}constructor(e){this.children=new Set,this.contain=!1,this.scopeRef=e.scopeRef}},wa=new nhe;function Fl(t={}){let{autoFocus:e=!1,isTextInput:n,within:r}=t,i=H.useRef({isFocused:!1,isFocusVisible:e||N2()}),[a,o]=H.useState(!1),[s,l]=H.useState(()=>i.current.isFocused&&i.current.isFocusVisible),c=H.useCallback(()=>l(i.current.isFocused&&i.current.isFocusVisible),[]),f=H.useCallback(h=>{i.current.isFocused=h,o(h),c()},[c]);Aj(h=>{i.current.isFocusVisible=h,c()},[],{isTextInput:n});let{focusProps:u}=mD({isDisabled:r,onFocusChange:f}),{focusWithinProps:d}=Am({isDisabled:!r,onFocusWithinChange:f});return{isFocused:a,isFocusVisible:s,focusProps:r?d:u}}function rhe(t,e){let n=e?.isDisabled,[r,i]=H.useState(!1);return Nr(()=>{if(t?.current&&!n){let a=()=>{if(t.current){let s=Cf(t.current,{tabbable:!0});i(!!s.nextNode())}};a();let o=new MutationObserver(a);return o.observe(t.current,{subtree:!0,childList:!0,attributes:!0,attributeFilter:["tabIndex","disabled"]}),()=>{o.disconnect()}}}),n?!1:r}function vD(t){let e=t;return e.nativeEvent=t,e.isDefaultPrevented=()=>e.defaultPrevented,e.isPropagationStopped=()=>e.cancelBubble,e.persist=()=>{},e}function Fj(t,e){Object.defineProperty(t,"target",{value:e}),Object.defineProperty(t,"currentTarget",{value:e})}function ihe(t){let e=H.useRef({isFocused:!1,observer:null});Nr(()=>{const r=e.current;return()=>{r.observer&&(r.observer.disconnect(),r.observer=null)}},[]);let n=Sr(r=>{t?.(r)});return H.useCallback(r=>{if(r.target instanceof HTMLButtonElement||r.target instanceof HTMLInputElement||r.target instanceof HTMLTextAreaElement||r.target instanceof HTMLSelectElement){e.current.isFocused=!0;let i=r.target,a=o=>{if(e.current.isFocused=!1,i.disabled){let s=vD(o);n(s)}e.current.observer&&(e.current.observer.disconnect(),e.current.observer=null)};i.addEventListener("focusout",a,{once:!0}),e.current.observer=new MutationObserver(()=>{if(e.current.isFocused&&i.disabled){var o;(o=e.current.observer)===null||o===void 0||o.disconnect();let s=i===document.activeElement?null:document.activeElement;i.dispatchEvent(new FocusEvent("blur",{relatedTarget:s})),i.dispatchEvent(new FocusEvent("focusout",{bubbles:!0,relatedTarget:s}))}}),e.current.observer.observe(i,{attributes:!0,attributeFilter:["disabled"]})}},[n])}let Aw=!1;function ahe(t){for(;t&&!lC(t);)t=t.parentElement;let e=Za(t),n=e.document.activeElement;if(!n||n===t)return;Aw=!0;let r=!1,i=f=>{(f.target===n||r)&&f.stopImmediatePropagation()},a=f=>{(f.target===n||r)&&(f.stopImmediatePropagation(),!t&&!r&&(r=!0,Xi(n),l()))},o=f=>{(f.target===t||r)&&f.stopImmediatePropagation()},s=f=>{(f.target===t||r)&&(f.stopImmediatePropagation(),r||(r=!0,Xi(n),l()))};e.addEventListener("blur",i,!0),e.addEventListener("focusout",a,!0),e.addEventListener("focusin",s,!0),e.addEventListener("focus",o,!0);let l=()=>{cancelAnimationFrame(c),e.removeEventListener("blur",i,!0),e.removeEventListener("focusout",a,!0),e.removeEventListener("focusin",s,!0),e.removeEventListener("focus",o,!0),Aw=!1,r=!1},c=requestAnimationFrame(l);return l}let sg="default",L6="",Pb=new WeakMap;function ohe(t){if(Dm()){if(sg==="default"){const e=In(t);L6=e.documentElement.style.webkitUserSelect,e.documentElement.style.webkitUserSelect="none"}sg="disabled"}else if(t instanceof HTMLElement||t instanceof SVGElement){let e="userSelect"in t.style?"userSelect":"webkitUserSelect";Pb.set(t,t.style[e]),t.style[e]="none"}}function DN(t){if(Dm()){if(sg!=="disabled")return;sg="restoring",setTimeout(()=>{aC(()=>{if(sg==="restoring"){const e=In(t);e.documentElement.style.webkitUserSelect==="none"&&(e.documentElement.style.webkitUserSelect=L6||""),L6="",sg="default"}})},300)}else if((t instanceof HTMLElement||t instanceof SVGElement)&&t&&Pb.has(t)){let e=Pb.get(t),n="userSelect"in t.style?"userSelect":"webkitUserSelect";t.style[n]==="none"&&(t.style[n]=e),t.getAttribute("style")===""&&t.removeAttribute("style"),Pb.delete(t)}}const yD=un.createContext({register:()=>{}});yD.displayName="PressResponderContext";function she(t){let e=H.useContext(yD);if(e){let{register:n,...r}=e;t=Ji(r,t),n()}return P9(e,t.ref),t}var ux=new WeakMap;class fx{continuePropagation(){Iw(this,ux,!1)}get shouldStopPropagation(){return _j(this,ux)}constructor(e,n,r,i){C$(this,ux,{writable:!0,value:void 0}),Iw(this,ux,!0);var a;let o=(a=i?.target)!==null&&a!==void 0?a:r.currentTarget;const s=o?.getBoundingClientRect();let l,c=0,f,u=null;r.clientX!=null&&r.clientY!=null&&(f=r.clientX,u=r.clientY),s&&(f!=null&&u!=null?(l=f-s.left,c=u-s.top):(l=s.width/2,c=s.height/2)),this.type=e,this.pointerType=n,this.target=r.currentTarget,this.shiftKey=r.shiftKey,this.metaKey=r.metaKey,this.ctrlKey=r.ctrlKey,this.altKey=r.altKey,this.x=l,this.y=c}}const ON=Symbol("linkClicked"),MN="react-aria-pressable-style",IN="data-react-aria-pressable";function Uj(t){let{onPress:e,onPressChange:n,onPressStart:r,onPressEnd:i,onPressUp:a,onClick:o,isDisabled:s,isPressed:l,preventFocusOnPress:c,shouldCancelOnPointerExit:f,allowTextSelectionOnPress:u,ref:d,...h}=she(t),[p,g]=H.useState(!1),m=H.useRef({isPressed:!1,ignoreEmulatedMouseEvents:!1,didFirePressStart:!1,isTriggeringEvent:!1,activePointerId:null,target:null,isOverTarget:!1,pointerType:null,disposables:[]}),{addGlobalListener:y,removeAllGlobalListeners:v}=Hh(),x=Sr((O,P)=>{let N=m.current;if(s||N.didFirePressStart)return!1;let A=!0;if(N.isTriggeringEvent=!0,r){let B=new fx("pressstart",P,O);r(B),A=B.shouldStopPropagation}return n&&n(!0),N.isTriggeringEvent=!1,N.didFirePressStart=!0,g(!0),A}),w=Sr((O,P,N=!0)=>{let A=m.current;if(!A.didFirePressStart)return!1;A.didFirePressStart=!1,A.isTriggeringEvent=!0;let B=!0;if(i){let V=new fx("pressend",P,O);i(V),B=V.shouldStopPropagation}if(n&&n(!1),g(!1),e&&N&&!s){let V=new fx("press",P,O);e(V),B&&(B=V.shouldStopPropagation)}return A.isTriggeringEvent=!1,B}),S=Sr((O,P)=>{let N=m.current;if(s)return!1;if(a){N.isTriggeringEvent=!0;let A=new fx("pressup",P,O);return a(A),N.isTriggeringEvent=!1,A.shouldStopPropagation}return!0}),T=Sr(O=>{let P=m.current;if(P.isPressed&&P.target){P.didFirePressStart&&P.pointerType!=null&&w(A0(P.target,O),P.pointerType,!1),P.isPressed=!1,P.isOverTarget=!1,P.activePointerId=null,P.pointerType=null,v(),u||DN(P.target);for(let N of P.disposables)N();P.disposables=[]}}),_=Sr(O=>{f&&T(O)}),D=Sr(O=>{o?.(O)}),I=Sr((O,P)=>{if(o){let N=new MouseEvent("click",O);Fj(N,P),o(vD(N))}}),R=H.useMemo(()=>{let O=m.current,P={onKeyDown(A){if(qT(A.nativeEvent,A.currentTarget)&&fi(A.currentTarget,sr(A.nativeEvent))){var B;RN(sr(A.nativeEvent),A.key)&&A.preventDefault();let V=!0;if(!O.isPressed&&!A.repeat){O.target=A.currentTarget,O.isPressed=!0,O.pointerType="keyboard",V=x(A,"keyboard");let $=A.currentTarget,U=G=>{qT(G,$)&&!G.repeat&&fi($,sr(G))&&O.target&&S(A0(O.target,G),"keyboard")};y(In(A.currentTarget),"keyup",Zd(U,N),!0)}V&&A.stopPropagation(),A.metaKey&&gu()&&((B=O.metaKeyEvents)===null||B===void 0||B.set(A.key,A.nativeEvent))}else A.key==="Meta"&&(O.metaKeyEvents=new Map)},onClick(A){if(!(A&&!fi(A.currentTarget,sr(A.nativeEvent)))&&A&&A.button===0&&!O.isTriggeringEvent&&!Lf.isOpening){let B=!0;if(s&&A.preventDefault(),!O.ignoreEmulatedMouseEvents&&!O.isPressed&&(O.pointerType==="virtual"||sC(A.nativeEvent))){let V=x(A,"virtual"),$=S(A,"virtual"),U=w(A,"virtual");D(A),B=V&&$&&U}else if(O.isPressed&&O.pointerType!=="keyboard"){let V=O.pointerType||A.nativeEvent.pointerType||"virtual",$=S(A0(A.currentTarget,A),V),U=w(A0(A.currentTarget,A),V,!0);B=$&&U,O.isOverTarget=!1,D(A),T(A)}O.ignoreEmulatedMouseEvents=!1,B&&A.stopPropagation()}}},N=A=>{var B;if(O.isPressed&&O.target&&qT(A,O.target)){var V;RN(sr(A),A.key)&&A.preventDefault();let U=sr(A),G=fi(O.target,sr(A));w(A0(O.target,A),"keyboard",G),G&&I(A,O.target),v(),A.key!=="Enter"&&xD(O.target)&&fi(O.target,U)&&!A[ON]&&(A[ON]=!0,Lf(O.target,A,!1)),O.isPressed=!1,(V=O.metaKeyEvents)===null||V===void 0||V.delete(A.key)}else if(A.key==="Meta"&&(!((B=O.metaKeyEvents)===null||B===void 0)&&B.size)){var $;let U=O.metaKeyEvents;O.metaKeyEvents=void 0;for(let G of U.values())($=O.target)===null||$===void 0||$.dispatchEvent(new KeyboardEvent("keyup",G))}};if(typeof PointerEvent<"u"){P.onPointerDown=V=>{if(V.button!==0||!fi(V.currentTarget,sr(V.nativeEvent)))return;if(P$(V.nativeEvent)){O.pointerType="virtual";return}O.pointerType=V.pointerType;let $=!0;if(!O.isPressed){O.isPressed=!0,O.isOverTarget=!0,O.activePointerId=V.pointerId,O.target=V.currentTarget,u||ohe(O.target),$=x(V,O.pointerType);let U=sr(V.nativeEvent);"releasePointerCapture"in U&&U.releasePointerCapture(V.pointerId),y(In(V.currentTarget),"pointerup",A,!1),y(In(V.currentTarget),"pointercancel",B,!1)}$&&V.stopPropagation()},P.onMouseDown=V=>{if(fi(V.currentTarget,sr(V.nativeEvent))&&V.button===0){if(c){let $=ahe(V.target);$&&O.disposables.push($)}V.stopPropagation()}},P.onPointerUp=V=>{!fi(V.currentTarget,sr(V.nativeEvent))||O.pointerType==="virtual"||V.button===0&&!O.isPressed&&S(V,O.pointerType||V.pointerType)},P.onPointerEnter=V=>{V.pointerId===O.activePointerId&&O.target&&!O.isOverTarget&&O.pointerType!=null&&(O.isOverTarget=!0,x(A0(O.target,V),O.pointerType))},P.onPointerLeave=V=>{V.pointerId===O.activePointerId&&O.target&&O.isOverTarget&&O.pointerType!=null&&(O.isOverTarget=!1,w(A0(O.target,V),O.pointerType,!1),_(V))};let A=V=>{if(V.pointerId===O.activePointerId&&O.isPressed&&V.button===0&&O.target){if(fi(O.target,sr(V))&&O.pointerType!=null){let $=!1,U=setTimeout(()=>{O.isPressed&&O.target instanceof HTMLElement&&($?T(V):(Xi(O.target),O.target.click()))},80);y(V.currentTarget,"click",()=>$=!0,!0),O.disposables.push(()=>clearTimeout(U))}else T(V);O.isOverTarget=!1}},B=V=>{T(V)};P.onDragStart=V=>{fi(V.currentTarget,sr(V.nativeEvent))&&T(V)}}return P},[y,s,c,v,u,T,_,w,x,S,D,I]);return H.useEffect(()=>{if(!d)return;const O=In(d.current);if(!O||!O.head||O.getElementById(MN))return;const P=O.createElement("style");P.id=MN,P.textContent=`
@layer {
  [${IN}] {
    touch-action: pan-x pan-y pinch-zoom;
  }
}
    `.trim(),O.head.prepend(P)},[d]),H.useEffect(()=>{let O=m.current;return()=>{var P;u||DN((P=O.target)!==null&&P!==void 0?P:void 0);for(let N of O.disposables)N();O.disposables=[]}},[u]),{isPressed:l||p,pressProps:Ji(h,R,{[IN]:!0})}}function xD(t){return t.tagName==="A"&&t.hasAttribute("href")}function qT(t,e){const{key:n,code:r}=t,i=e,a=i.getAttribute("role");return(n==="Enter"||n===" "||n==="Spacebar"||r==="Space")&&!(i instanceof Za(i).HTMLInputElement&&!Bj(i,n)||i instanceof Za(i).HTMLTextAreaElement||i.isContentEditable)&&!((a==="link"||!a&&xD(i))&&n!=="Enter")}function A0(t,e){let n=e.clientX,r=e.clientY;return{currentTarget:t,shiftKey:e.shiftKey,ctrlKey:e.ctrlKey,metaKey:e.metaKey,altKey:e.altKey,clientX:n,clientY:r}}function lhe(t){return t instanceof HTMLInputElement?!1:t instanceof HTMLButtonElement?t.type!=="submit"&&t.type!=="reset":!xD(t)}function RN(t,e){return t instanceof HTMLInputElement?!Bj(t,e):lhe(t)}const che=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);function Bj(t,e){return t.type==="checkbox"||t.type==="radio"?e===" ":che.has(t.type)}let Nm=null,uhe=new Set,Qv=new Map,Ih=!1,k6=!1;function xC(t,e){for(let n of uhe)n(t,e)}function fhe(t){return!(t.metaKey||!gu()&&t.altKey||t.ctrlKey||t.key==="Control"||t.key==="Shift"||t.key==="Meta")}function Nw(t){Ih=!0,fhe(t)&&(Nm="keyboard",xC("keyboard",t))}function $g(t){Nm="pointer",(t.type==="mousedown"||t.type==="pointerdown")&&(Ih=!0,xC("pointer",t))}function $j(t){sC(t)&&(Ih=!0,Nm="virtual")}function Gj(t){t.target===window||t.target===document||Aw||!t.isTrusted||(!Ih&&!k6&&(Nm="virtual",xC("virtual",t)),Ih=!1,k6=!1)}function jj(){Aw||(Ih=!1,k6=!0)}function PN(t){if(typeof window>"u"||typeof document>"u"||Qv.get(Za(t)))return;const e=Za(t),n=In(t);let r=e.HTMLElement.prototype.focus;e.HTMLElement.prototype.focus=function(){Ih=!0,r.apply(this,arguments)},n.addEventListener("keydown",Nw,!0),n.addEventListener("keyup",Nw,!0),n.addEventListener("click",$j,!0),e.addEventListener("focus",Gj,!0),e.addEventListener("blur",jj,!1),typeof PointerEvent<"u"&&(n.addEventListener("pointerdown",$g,!0),n.addEventListener("pointermove",$g,!0),n.addEventListener("pointerup",$g,!0)),e.addEventListener("beforeunload",()=>{zj(t)},{once:!0}),Qv.set(e,{focus:r})}const zj=(t,e)=>{const n=Za(t),r=In(t);e&&r.removeEventListener("DOMContentLoaded",e),Qv.has(n)&&(n.HTMLElement.prototype.focus=Qv.get(n).focus,r.removeEventListener("keydown",Nw,!0),r.removeEventListener("keyup",Nw,!0),r.removeEventListener("click",$j,!0),n.removeEventListener("focus",Gj,!0),n.removeEventListener("blur",jj,!1),typeof PointerEvent<"u"&&(r.removeEventListener("pointerdown",$g,!0),r.removeEventListener("pointermove",$g,!0),r.removeEventListener("pointerup",$g,!0)),Qv.delete(n))};function dhe(t){const e=In(t);let n;return e.readyState!=="loading"?PN(t):(n=()=>{PN(t)},e.addEventListener("DOMContentLoaded",n)),()=>zj(t,n)}typeof document<"u"&&dhe();function V6(){return Nm}function hhe(t){Nm=t,xC(t,null)}function L2(t){const e=In(t),n=Ba(e);if(V6()==="virtual"){let r=n;aC(()=>{Ba(e)===r&&t.isConnected&&Xi(t)})}else Xi(t)}function phe({children:t}){let e=H.useMemo(()=>({register:()=>{}}),[]);return un.createElement(yD.Provider,{value:e},t)}function ghe(t){let{isDisabled:e,onBlurWithin:n,onFocusWithin:r,onFocusWithinChange:i}=t,a=H.useRef({isFocusWithin:!1}),{addGlobalListener:o,removeAllGlobalListeners:s}=Hh(),l=H.useCallback(u=>{u.currentTarget.contains(u.target)&&a.current.isFocusWithin&&!u.currentTarget.contains(u.relatedTarget)&&(a.current.isFocusWithin=!1,s(),n&&n(u),i&&i(!1))},[n,i,a,s]),c=ihe(l),f=H.useCallback(u=>{if(!u.currentTarget.contains(u.target))return;const d=In(u.target),h=Ba(d);if(!a.current.isFocusWithin&&h===sr(u.nativeEvent)){r&&r(u),i&&i(!0),a.current.isFocusWithin=!0,c(u);let p=u.currentTarget;o(d,"focus",g=>{if(a.current.isFocusWithin&&!fi(p,g.target)){let m=new d.defaultView.FocusEvent("blur",{relatedTarget:g.target});Fj(m,p);let y=vD(m);l(y)}},{capture:!0})}},[r,i,c,o,l]);return e?{focusWithinProps:{onFocus:void 0,onBlur:void 0}}:{focusWithinProps:{onFocus:f,onBlur:l}}}const mhe=500;function vhe(t){let{isDisabled:e,onLongPressStart:n,onLongPressEnd:r,onLongPress:i,threshold:a=mhe,accessibilityDescription:o}=t;const s=H.useRef(void 0);let{addGlobalListener:l,removeGlobalListener:c}=Hh(),{pressProps:f}=Uj({isDisabled:e,onPressStart(d){if(d.continuePropagation(),(d.pointerType==="mouse"||d.pointerType==="touch")&&(n&&n({...d,type:"longpressstart"}),s.current=setTimeout(()=>{d.target.dispatchEvent(new PointerEvent("pointercancel",{bubbles:!0})),In(d.target).activeElement!==d.target&&Xi(d.target),i&&i({...d,type:"longpress"}),s.current=void 0},a),d.pointerType==="touch")){let h=p=>{p.preventDefault()};l(d.target,"contextmenu",h,{once:!0}),l(window,"pointerup",()=>{setTimeout(()=>{c(d.target,"contextmenu",h)},30)},{once:!0})}},onPressEnd(d){s.current&&clearTimeout(s.current),r&&(d.pointerType==="mouse"||d.pointerType==="touch")&&r({...d,type:"longpressend"})}}),u=I$(i&&!e?o:void 0);return{longPressProps:Ji(f,u)}}function yhe(t,e,n){let{type:r}=t,{isOpen:i}=e;H.useEffect(()=>{n&&n.current&&bj.set(n.current,e.close)});let a;r==="menu"?a=!0:r==="listbox"&&(a="listbox");let o=rl();return{triggerProps:{"aria-haspopup":a,"aria-expanded":i,"aria-controls":i?o:void 0,onPress:e.toggle},overlayProps:{id:o}}}const XT=typeof document<"u"&&window.visualViewport,xhe=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);let dx=0,YT;function Wj(t={}){let{isDisabled:e}=t;Nr(()=>{if(!e)return dx++,dx===1&&(Dm()?YT=whe():YT=bhe()),()=>{dx--,dx===0&&YT()}},[e])}function bhe(){let t=window.innerWidth-document.documentElement.clientWidth;return Zd(t>0&&("scrollbarGutter"in document.documentElement.style?ch(document.documentElement,"scrollbarGutter","stable"):ch(document.documentElement,"paddingRight",`${t}px`)),ch(document.documentElement,"overflow","hidden"))}function whe(){let t,e,n=c=>{t=M$(c.target,!0),!(t===document.documentElement&&t===document.body)&&t instanceof HTMLElement&&window.getComputedStyle(t).overscrollBehavior==="auto"&&(e=ch(t,"overscrollBehavior","contain"))},r=c=>{if(!t||t===document.documentElement||t===document.body){c.preventDefault();return}t.scrollHeight===t.clientHeight&&t.scrollWidth===t.clientWidth&&c.preventDefault()},i=()=>{e&&e()},a=c=>{let f=c.target;Che(f)&&(s(),f.style.transform="translateY(-2000px)",requestAnimationFrame(()=>{f.style.transform="",XT&&(XT.height<window.innerHeight?requestAnimationFrame(()=>{AN(f)}):XT.addEventListener("resize",()=>AN(f),{once:!0}))}))},o=null,s=()=>{if(o)return;let c=()=>{window.scrollTo(0,0)},f=window.pageXOffset,u=window.pageYOffset;o=Zd(X1(window,"scroll",c),ch(document.documentElement,"paddingRight",`${window.innerWidth-document.documentElement.clientWidth}px`),ch(document.documentElement,"overflow","hidden"),ch(document.body,"marginTop",`-${u}px`),()=>{window.scrollTo(f,u)}),window.scrollTo(0,0)},l=Zd(X1(document,"touchstart",n,{passive:!1,capture:!0}),X1(document,"touchmove",r,{passive:!1,capture:!0}),X1(document,"touchend",i,{passive:!1,capture:!0}),X1(document,"focus",a,!0));return()=>{e?.(),o?.(),l()}}function ch(t,e,n){let r=t.style[e];return t.style[e]=n,()=>{t.style[e]=r}}function X1(t,e,n,r){return t.addEventListener(e,n,r),()=>{t.removeEventListener(e,n,r)}}function AN(t){let e=document.scrollingElement||document.documentElement,n=t;for(;n&&n!==e;){let r=M$(n);if(r!==document.documentElement&&r!==document.body&&r!==n){let i=r.getBoundingClientRect().top,a=n.getBoundingClientRect().top;a>i+n.clientHeight&&(r.scrollTop+=a-i)}n=r.parentElement}}function Che(t){return t instanceof HTMLInputElement&&!xhe.has(t.type)||t instanceof HTMLTextAreaElement||t instanceof HTMLElement&&t.isContentEditable}const She=H.createContext({});function The(){var t;return(t=H.useContext(She))!==null&&t!==void 0?t:{}}const F6=un.createContext(null);function Ehe(t){let{children:e}=t,n=H.useContext(F6),[r,i]=H.useState(0),a=H.useMemo(()=>({parent:n,modalCount:r,addModal(){i(o=>o+1),n&&n.addModal()},removeModal(){i(o=>o-1),n&&n.removeModal()}}),[n,r]);return un.createElement(F6.Provider,{value:a},e)}function _he(){let t=H.useContext(F6);return{modalProviderProps:{"aria-hidden":t&&t.modalCount>0?!0:void 0}}}function Dhe(t){let{modalProviderProps:e}=_he();return un.createElement("div",{"data-overlay-container":!0,...t,...e})}function Ohe(t){return un.createElement(Ehe,null,un.createElement(Dhe,t))}var Hj={};Hj={dismiss:"تجاهل"};var Kj={};Kj={dismiss:"Отхвърляне"};var qj={};qj={dismiss:"Odstranit"};var Xj={};Xj={dismiss:"Luk"};var Yj={};Yj={dismiss:"Schließen"};var Jj={};Jj={dismiss:"Απόρριψη"};var Zj={};Zj={dismiss:"Dismiss"};var Qj={};Qj={dismiss:"Descartar"};var ez={};ez={dismiss:"Lõpeta"};var tz={};tz={dismiss:"Hylkää"};var nz={};nz={dismiss:"Rejeter"};var rz={};rz={dismiss:"התעלם"};var iz={};iz={dismiss:"Odbaci"};var az={};az={dismiss:"Elutasítás"};var oz={};oz={dismiss:"Ignora"};var sz={};sz={dismiss:"閉じる"};var lz={};lz={dismiss:"무시"};var cz={};cz={dismiss:"Atmesti"};var uz={};uz={dismiss:"Nerādīt"};var fz={};fz={dismiss:"Lukk"};var dz={};dz={dismiss:"Negeren"};var hz={};hz={dismiss:"Zignoruj"};var pz={};pz={dismiss:"Descartar"};var gz={};gz={dismiss:"Dispensar"};var mz={};mz={dismiss:"Revocare"};var vz={};vz={dismiss:"Пропустить"};var yz={};yz={dismiss:"Zrušiť"};var xz={};xz={dismiss:"Opusti"};var bz={};bz={dismiss:"Odbaci"};var wz={};wz={dismiss:"Avvisa"};var Cz={};Cz={dismiss:"Kapat"};var Sz={};Sz={dismiss:"Скасувати"};var Tz={};Tz={dismiss:"取消"};var Ez={};Ez={dismiss:"關閉"};var _z={};_z={"ar-AE":Hj,"bg-BG":Kj,"cs-CZ":qj,"da-DK":Xj,"de-DE":Yj,"el-GR":Jj,"en-US":Zj,"es-ES":Qj,"et-EE":ez,"fi-FI":tz,"fr-FR":nz,"he-IL":rz,"hr-HR":iz,"hu-HU":az,"it-IT":oz,"ja-JP":sz,"ko-KR":lz,"lt-LT":cz,"lv-LV":uz,"nb-NO":fz,"nl-NL":dz,"pl-PL":hz,"pt-BR":pz,"pt-PT":gz,"ro-RO":mz,"ru-RU":vz,"sk-SK":yz,"sl-SI":xz,"sr-SP":bz,"sv-SE":wz,"tr-TR":Cz,"uk-UA":Sz,"zh-CN":Tz,"zh-TW":Ez};const NN={border:0,clip:"rect(0 0 0 0)",clipPath:"inset(50%)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap"};function Dz(t={}){let{style:e,isFocusable:n}=t,[r,i]=H.useState(!1),{focusWithinProps:a}=ghe({isDisabled:!n,onFocusWithinChange:s=>i(s)}),o=H.useMemo(()=>r?e:e?{...NN,...e}:NN,[r]);return{visuallyHiddenProps:{...a,style:o}}}function Oz(t){let{children:e,elementType:n="div",isFocusable:r,style:i,...a}=t,{visuallyHiddenProps:o}=Dz(t);return un.createElement(n,Ji(a,o),e)}function Mhe(t){return t&&t.__esModule?t.default:t}function LN(t){let{onDismiss:e,...n}=t,r=mC(Mhe(_z),"@react-aria/overlays"),i=oC(n,r.format("dismiss")),a=()=>{e&&e()};return un.createElement(Oz,null,un.createElement("button",{...i,tabIndex:-1,onClick:a,style:{width:1,height:1}}))}const Mz=un.createContext(null);function Ihe(t){let e=py(),{portalContainer:n=e?null:document.body,isExiting:r}=t,[i,a]=H.useState(!1),o=H.useMemo(()=>({contain:i,setContain:a}),[i,a]),{getContainer:s}=The();if(!t.portalContainer&&s&&(n=s()),!n)return null;let l=t.children;return t.disableFocusManagement||(l=un.createElement(q0e,{restoreFocus:!0,contain:(t.shouldContainFocus||i)&&!r},l)),l=un.createElement(Mz.Provider,{value:o},un.createElement(phe,null,l)),Goe.createPortal(l,n)}function Rhe(){let t=H.useContext(Mz),e=t?.setContain;Nr(()=>{e?.(!0)},[e])}var Phe=({children:t,navigate:e,disableAnimation:n,useHref:r,disableRipple:i=!1,skipFramerMotionAnimations:a=n,reducedMotion:o="never",validationBehavior:s,locale:l="en-US",labelPlacement:c,defaultDates:f,createCalendar:u,spinnerVariant:d,...h})=>{let p=t;e&&(p=j.jsx(i0e,{navigate:e,useHref:r,children:p}));const g=H.useMemo(()=>(n&&a&&(mu.skipAnimations=!0),{createCalendar:u,defaultDates:f,disableAnimation:n,disableRipple:i,validationBehavior:s,labelPlacement:c,spinnerVariant:d}),[u,f?.maxDate,f?.minDate,n,i,s,c,d]);return j.jsx(rse,{value:g,children:j.jsx(pse,{locale:l,children:j.jsx(fue,{reducedMotion:o,children:j.jsx(Ohe,{...h,children:p})})})})};function Ahe(t){const e=as(),n=e?.labelPlacement;return H.useMemo(()=>{var r,i;const a=(i=(r=t.labelPlacement)!=null?r:n)!=null?i:"inside";return a==="inside"&&!t.label?"outside":a},[t.labelPlacement,n,t.label])}function Nhe(t){const e=as(),n=e?.labelPlacement;return H.useMemo(()=>{var r,i;const a=(i=(r=t.labelPlacement)!=null?r:n)!=null?i:"inside";return a==="inside"&&!t.label?"outside":a},[t.labelPlacement,n,t.label])}function Qi(t){return H.forwardRef(t)}var Gl=(t,e,n=!0)=>{if(!e)return[t,{}];const r=e.reduce((i,a)=>a in t?{...i,[a]:t[a]}:i,{});return n?[Object.keys(t).filter(a=>!e.includes(a)).reduce((a,o)=>({...a,[o]:t[o]}),{}),r]:[t,r]},Lhe={default:"bg-default text-default-foreground",primary:"bg-primary text-primary-foreground",secondary:"bg-secondary text-secondary-foreground",success:"bg-success text-success-foreground",warning:"bg-warning text-warning-foreground",danger:"bg-danger text-danger-foreground",foreground:"bg-foreground text-background"},khe={default:"shadow-lg shadow-default/50 bg-default text-default-foreground",primary:"shadow-lg shadow-primary/40 bg-primary text-primary-foreground",secondary:"shadow-lg shadow-secondary/40 bg-secondary text-secondary-foreground",success:"shadow-lg shadow-success/40 bg-success text-success-foreground",warning:"shadow-lg shadow-warning/40 bg-warning text-warning-foreground",danger:"shadow-lg shadow-danger/40 bg-danger text-danger-foreground"},Vhe={default:"bg-transparent border-default text-foreground",primary:"bg-transparent border-primary text-primary",secondary:"bg-transparent border-secondary text-secondary",success:"bg-transparent border-success text-success",warning:"bg-transparent border-warning text-warning",danger:"bg-transparent border-danger text-danger"},Fhe={default:"bg-default/40 text-default-700",primary:"bg-primary/20 text-primary-600",secondary:"bg-secondary/20 text-secondary-600",success:"bg-success/20 text-success-700 dark:text-success",warning:"bg-warning/20 text-warning-700 dark:text-warning",danger:"bg-danger/20 text-danger-600 dark:text-danger-500"},Uhe={default:"border-default bg-default-100 text-default-foreground",primary:"border-default bg-default-100 text-primary",secondary:"border-default bg-default-100 text-secondary",success:"border-default bg-default-100 text-success",warning:"border-default bg-default-100 text-warning",danger:"border-default bg-default-100 text-danger"},Bhe={default:"bg-transparent text-default-foreground",primary:"bg-transparent text-primary",secondary:"bg-transparent text-secondary",success:"bg-transparent text-success",warning:"bg-transparent text-warning",danger:"bg-transparent text-danger"},$he={default:"border-default text-default-foreground",primary:"border-primary text-primary",secondary:"border-secondary text-secondary",success:"border-success text-success",warning:"border-warning text-warning",danger:"border-danger text-danger"},It={solid:Lhe,shadow:khe,bordered:Vhe,flat:Fhe,faded:Uhe,light:Bhe,ghost:$he},Ghe={".spinner-bar-animation":{"animation-delay":"calc(-1.2s + (0.1s * var(--bar-index)))",transform:"rotate(calc(30deg * var(--bar-index)))translate(140%)"},".spinner-dot-animation":{"animation-delay":"calc(250ms * var(--dot-index))"},".spinner-dot-blink-animation":{"animation-delay":"calc(200ms * var(--dot-index))"}},jhe={".leading-inherit":{"line-height":"inherit"},".bg-img-inherit":{"background-image":"inherit"},".bg-clip-inherit":{"background-clip":"inherit"},".text-fill-inherit":{"-webkit-text-fill-color":"inherit"},".tap-highlight-transparent":{"-webkit-tap-highlight-color":"transparent"},".input-search-cancel-button-none":{"&::-webkit-search-cancel-button":{"-webkit-appearance":"none"}}},zhe={".scrollbar-hide":{"-ms-overflow-style":"none","scrollbar-width":"none","&::-webkit-scrollbar":{display:"none"}},".scrollbar-default":{"-ms-overflow-style":"auto","scrollbar-width":"auto","&::-webkit-scrollbar":{display:"block"}}},Whe={".text-tiny":{"font-size":"var(--heroui-font-size-tiny)","line-height":"var(--heroui-line-height-tiny)"},".text-small":{"font-size":"var(--heroui-font-size-small)","line-height":"var(--heroui-line-height-small)"},".text-medium":{"font-size":"var(--heroui-font-size-medium)","line-height":"var(--heroui-line-height-medium)"},".text-large":{"font-size":"var(--heroui-font-size-large)","line-height":"var(--heroui-line-height-large)"}},zc="250ms",Hhe={".transition-background":{"transition-property":"background","transition-timing-function":"ease","transition-duration":zc},".transition-colors-opacity":{"transition-property":"color, background-color, border-color, text-decoration-color, fill, stroke, opacity","transition-timing-function":"ease","transition-duration":zc},".transition-width":{"transition-property":"width","transition-timing-function":"ease","transition-duration":zc},".transition-height":{"transition-property":"height","transition-timing-function":"ease","transition-duration":zc},".transition-size":{"transition-property":"width, height","transition-timing-function":"ease","transition-duration":zc},".transition-left":{"transition-property":"left","transition-timing-function":"ease","transition-duration":zc},".transition-transform-opacity":{"transition-property":"transform, scale, opacity rotate","transition-timing-function":"ease","transition-duration":zc},".transition-transform-background":{"transition-property":"transform, scale, background","transition-timing-function":"ease","transition-duration":zc},".transition-transform-colors":{"transition-property":"transform, scale, color, background, background-color, border-color, text-decoration-color, fill, stroke","transition-timing-function":"ease","transition-duration":zc},".transition-transform-colors-opacity":{"transition-property":"transform, scale, color, background, background-color, border-color, text-decoration-color, fill, stroke, opacity","transition-timing-function":"ease","transition-duration":zc}},Khe={...jhe,...Hhe,...zhe,...Whe,...Ghe},hx=["small","medium","large"],kN={theme:{spacing:["divider"],radius:hx},classGroups:{shadow:[{shadow:hx}],opacity:[{opacity:["disabled"]}],"font-size":[{text:["tiny",...hx]}],"border-w":[{border:hx}],"bg-image":["bg-stripe-gradient-default","bg-stripe-gradient-primary","bg-stripe-gradient-secondary","bg-stripe-gradient-success","bg-stripe-gradient-warning","bg-stripe-gradient-danger"],transition:Object.keys(Khe).filter(t=>t.includes(".transition")).map(t=>t.replace(".",""))}},VN=t=>t===!1?"false":t===!0?"true":t===0?"0":t,Cs=t=>{if(!t||typeof t!="object")return!0;for(let e in t)return!1;return!0},qhe=(t,e)=>{if(t===e)return!0;if(!t||!e)return!1;let n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++){let a=n[i];if(!r.includes(a)||t[a]!==e[a])return!1}return!0};function Iz(t,e){for(let n=0;n<t.length;n++){let r=t[n];Array.isArray(r)?Iz(r,e):e.push(r)}}var Rz=(...t)=>{let e=[];Iz(t,e);let n=[];for(let r=0;r<e.length;r++)e[r]&&n.push(e[r]);return n},Pz=(t,e)=>{let n={};for(let r in t){let i=t[r];if(r in e){let a=e[r];Array.isArray(i)||Array.isArray(a)?n[r]=Rz(a,i):typeof i=="object"&&typeof a=="object"&&i&&a?n[r]=Pz(i,a):n[r]=a+" "+i}else n[r]=i}for(let r in e)r in t||(n[r]=e[r]);return n},Xhe=/\s+/g,FN=t=>!t||typeof t!="string"?t:t.replace(Xhe," ").trim();const bD="-",Yhe=t=>{const e=Zhe(t),{conflictingClassGroups:n,conflictingClassGroupModifiers:r}=t;return{getClassGroupId:o=>{const s=o.split(bD);return s[0]===""&&s.length!==1&&s.shift(),Az(s,e)||Jhe(o)},getConflictingClassGroupIds:(o,s)=>{const l=n[o]||[];return s&&r[o]?[...l,...r[o]]:l}}},Az=(t,e)=>{if(t.length===0)return e.classGroupId;const n=t[0],r=e.nextPart.get(n),i=r?Az(t.slice(1),r):void 0;if(i)return i;if(e.validators.length===0)return;const a=t.join(bD);return e.validators.find(({validator:o})=>o(a))?.classGroupId},UN=/^\[(.+)\]$/,Jhe=t=>{if(UN.test(t)){const e=UN.exec(t)[1],n=e?.substring(0,e.indexOf(":"));if(n)return"arbitrary.."+n}},Zhe=t=>{const{theme:e,classGroups:n}=t,r={nextPart:new Map,validators:[]};for(const i in n)U6(n[i],r,i,e);return r},U6=(t,e,n,r)=>{t.forEach(i=>{if(typeof i=="string"){const a=i===""?e:BN(e,i);a.classGroupId=n;return}if(typeof i=="function"){if(Qhe(i)){U6(i(r),e,n,r);return}e.validators.push({validator:i,classGroupId:n});return}Object.entries(i).forEach(([a,o])=>{U6(o,BN(e,a),n,r)})})},BN=(t,e)=>{let n=t;return e.split(bD).forEach(r=>{n.nextPart.has(r)||n.nextPart.set(r,{nextPart:new Map,validators:[]}),n=n.nextPart.get(r)}),n},Qhe=t=>t.isThemeGetter,epe=t=>{if(t<1)return{get:()=>{},set:()=>{}};let e=0,n=new Map,r=new Map;const i=(a,o)=>{n.set(a,o),e++,e>t&&(e=0,r=n,n=new Map)};return{get(a){let o=n.get(a);if(o!==void 0)return o;if((o=r.get(a))!==void 0)return i(a,o),o},set(a,o){n.has(a)?n.set(a,o):i(a,o)}}},B6="!",$6=":",tpe=$6.length,npe=t=>{const{prefix:e,experimentalParseClassName:n}=t;let r=i=>{const a=[];let o=0,s=0,l=0,c;for(let p=0;p<i.length;p++){let g=i[p];if(o===0&&s===0){if(g===$6){a.push(i.slice(l,p)),l=p+tpe;continue}if(g==="/"){c=p;continue}}g==="["?o++:g==="]"?o--:g==="("?s++:g===")"&&s--}const f=a.length===0?i:i.substring(l),u=rpe(f),d=u!==f,h=c&&c>l?c-l:void 0;return{modifiers:a,hasImportantModifier:d,baseClassName:u,maybePostfixModifierPosition:h}};if(e){const i=e+$6,a=r;r=o=>o.startsWith(i)?a(o.substring(i.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:o,maybePostfixModifierPosition:void 0}}if(n){const i=r;r=a=>n({className:a,parseClassName:i})}return r},rpe=t=>t.endsWith(B6)?t.substring(0,t.length-1):t.startsWith(B6)?t.substring(1):t,ipe=t=>{const e=Object.fromEntries(t.orderSensitiveModifiers.map(r=>[r,!0]));return r=>{if(r.length<=1)return r;const i=[];let a=[];return r.forEach(o=>{o[0]==="["||e[o]?(i.push(...a.sort(),o),a=[]):a.push(o)}),i.push(...a.sort()),i}},ape=t=>({cache:epe(t.cacheSize),parseClassName:npe(t),sortModifiers:ipe(t),...Yhe(t)}),ope=/\s+/,spe=(t,e)=>{const{parseClassName:n,getClassGroupId:r,getConflictingClassGroupIds:i,sortModifiers:a}=e,o=[],s=t.trim().split(ope);let l="";for(let c=s.length-1;c>=0;c-=1){const f=s[c],{isExternal:u,modifiers:d,hasImportantModifier:h,baseClassName:p,maybePostfixModifierPosition:g}=n(f);if(u){l=f+(l.length>0?" "+l:l);continue}let m=!!g,y=r(m?p.substring(0,g):p);if(!y){if(!m){l=f+(l.length>0?" "+l:l);continue}if(y=r(p),!y){l=f+(l.length>0?" "+l:l);continue}m=!1}const v=a(d).join(":"),x=h?v+B6:v,w=x+y;if(o.includes(w))continue;o.push(w);const S=i(y,m);for(let T=0;T<S.length;++T){const _=S[T];o.push(x+_)}l=f+(l.length>0?" "+l:l)}return l};function lpe(){let t=0,e,n,r="";for(;t<arguments.length;)(e=arguments[t++])&&(n=Nz(e))&&(r&&(r+=" "),r+=n);return r}const Nz=t=>{if(typeof t=="string")return t;let e,n="";for(let r=0;r<t.length;r++)t[r]&&(e=Nz(t[r]))&&(n&&(n+=" "),n+=e);return n};function G6(t,...e){let n,r,i,a=o;function o(l){const c=e.reduce((f,u)=>u(f),t());return n=ape(c),r=n.cache.get,i=n.cache.set,a=s,s(l)}function s(l){const c=r(l);if(c)return c;const f=spe(l,n);return i(l,f),f}return function(){return a(lpe.apply(null,arguments))}}const Pa=t=>{const e=n=>n[t]||[];return e.isThemeGetter=!0,e},Lz=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,kz=/^\((?:(\w[\w-]*):)?(.+)\)$/i,cpe=/^\d+\/\d+$/,upe=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,fpe=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,dpe=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,hpe=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,ppe=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Ip=t=>cpe.test(t),Hn=t=>!!t&&!Number.isNaN(Number(t)),gd=t=>!!t&&Number.isInteger(Number(t)),JT=t=>t.endsWith("%")&&Hn(t.slice(0,-1)),tf=t=>upe.test(t),gpe=()=>!0,mpe=t=>fpe.test(t)&&!dpe.test(t),Vz=()=>!1,vpe=t=>hpe.test(t),ype=t=>ppe.test(t),xpe=t=>!Yt(t)&&!Jt(t),bpe=t=>Lm(t,Bz,Vz),Yt=t=>Lz.test(t),N0=t=>Lm(t,$z,mpe),ZT=t=>Lm(t,Epe,Hn),$N=t=>Lm(t,Fz,Vz),wpe=t=>Lm(t,Uz,ype),px=t=>Lm(t,Gz,vpe),Jt=t=>kz.test(t),Y1=t=>km(t,$z),Cpe=t=>km(t,_pe),GN=t=>km(t,Fz),Spe=t=>km(t,Bz),Tpe=t=>km(t,Uz),gx=t=>km(t,Gz,!0),Lm=(t,e,n)=>{const r=Lz.exec(t);return r?r[1]?e(r[1]):n(r[2]):!1},km=(t,e,n=!1)=>{const r=kz.exec(t);return r?r[1]?e(r[1]):n:!1},Fz=t=>t==="position"||t==="percentage",Uz=t=>t==="image"||t==="url",Bz=t=>t==="length"||t==="size"||t==="bg-size",$z=t=>t==="length",Epe=t=>t==="number",_pe=t=>t==="family-name",Gz=t=>t==="shadow",j6=()=>{const t=Pa("color"),e=Pa("font"),n=Pa("text"),r=Pa("font-weight"),i=Pa("tracking"),a=Pa("leading"),o=Pa("breakpoint"),s=Pa("container"),l=Pa("spacing"),c=Pa("radius"),f=Pa("shadow"),u=Pa("inset-shadow"),d=Pa("text-shadow"),h=Pa("drop-shadow"),p=Pa("blur"),g=Pa("perspective"),m=Pa("aspect"),y=Pa("ease"),v=Pa("animate"),x=()=>["auto","avoid","all","avoid-page","page","left","right","column"],w=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],S=()=>[...w(),Jt,Yt],T=()=>["auto","hidden","clip","visible","scroll"],_=()=>["auto","contain","none"],D=()=>[Jt,Yt,l],I=()=>[Ip,"full","auto",...D()],R=()=>[gd,"none","subgrid",Jt,Yt],O=()=>["auto",{span:["full",gd,Jt,Yt]},gd,Jt,Yt],P=()=>[gd,"auto",Jt,Yt],N=()=>["auto","min","max","fr",Jt,Yt],A=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],B=()=>["start","end","center","stretch","center-safe","end-safe"],V=()=>["auto",...D()],$=()=>[Ip,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...D()],U=()=>[t,Jt,Yt],G=()=>[...w(),GN,$N,{position:[Jt,Yt]}],F=()=>["no-repeat",{repeat:["","x","y","space","round"]}],J=()=>["auto","cover","contain",Spe,bpe,{size:[Jt,Yt]}],Q=()=>[JT,Y1,N0],ne=()=>["","none","full",c,Jt,Yt],ye=()=>["",Hn,Y1,N0],ve=()=>["solid","dashed","dotted","double"],Ce=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],we=()=>[Hn,JT,GN,$N],Ae=()=>["","none",p,Jt,Yt],Me=()=>["none",Hn,Jt,Yt],q=()=>["none",Hn,Jt,Yt],k=()=>[Hn,Jt,Yt],Y=()=>[Ip,"full",...D()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[tf],breakpoint:[tf],color:[gpe],container:[tf],"drop-shadow":[tf],ease:["in","out","in-out"],font:[xpe],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[tf],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[tf],shadow:[tf],spacing:["px",Hn],text:[tf],"text-shadow":[tf],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",Ip,Yt,Jt,m]}],container:["container"],columns:[{columns:[Hn,Yt,Jt,s]}],"break-after":[{"break-after":x()}],"break-before":[{"break-before":x()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:S()}],overflow:[{overflow:T()}],"overflow-x":[{"overflow-x":T()}],"overflow-y":[{"overflow-y":T()}],overscroll:[{overscroll:_()}],"overscroll-x":[{"overscroll-x":_()}],"overscroll-y":[{"overscroll-y":_()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:I()}],"inset-x":[{"inset-x":I()}],"inset-y":[{"inset-y":I()}],start:[{start:I()}],end:[{end:I()}],top:[{top:I()}],right:[{right:I()}],bottom:[{bottom:I()}],left:[{left:I()}],visibility:["visible","invisible","collapse"],z:[{z:[gd,"auto",Jt,Yt]}],basis:[{basis:[Ip,"full","auto",s,...D()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[Hn,Ip,"auto","initial","none",Yt]}],grow:[{grow:["",Hn,Jt,Yt]}],shrink:[{shrink:["",Hn,Jt,Yt]}],order:[{order:[gd,"first","last","none",Jt,Yt]}],"grid-cols":[{"grid-cols":R()}],"col-start-end":[{col:O()}],"col-start":[{"col-start":P()}],"col-end":[{"col-end":P()}],"grid-rows":[{"grid-rows":R()}],"row-start-end":[{row:O()}],"row-start":[{"row-start":P()}],"row-end":[{"row-end":P()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":N()}],"auto-rows":[{"auto-rows":N()}],gap:[{gap:D()}],"gap-x":[{"gap-x":D()}],"gap-y":[{"gap-y":D()}],"justify-content":[{justify:[...A(),"normal"]}],"justify-items":[{"justify-items":[...B(),"normal"]}],"justify-self":[{"justify-self":["auto",...B()]}],"align-content":[{content:["normal",...A()]}],"align-items":[{items:[...B(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...B(),{baseline:["","last"]}]}],"place-content":[{"place-content":A()}],"place-items":[{"place-items":[...B(),"baseline"]}],"place-self":[{"place-self":["auto",...B()]}],p:[{p:D()}],px:[{px:D()}],py:[{py:D()}],ps:[{ps:D()}],pe:[{pe:D()}],pt:[{pt:D()}],pr:[{pr:D()}],pb:[{pb:D()}],pl:[{pl:D()}],m:[{m:V()}],mx:[{mx:V()}],my:[{my:V()}],ms:[{ms:V()}],me:[{me:V()}],mt:[{mt:V()}],mr:[{mr:V()}],mb:[{mb:V()}],ml:[{ml:V()}],"space-x":[{"space-x":D()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":D()}],"space-y-reverse":["space-y-reverse"],size:[{size:$()}],w:[{w:[s,"screen",...$()]}],"min-w":[{"min-w":[s,"screen","none",...$()]}],"max-w":[{"max-w":[s,"screen","none","prose",{screen:[o]},...$()]}],h:[{h:["screen","lh",...$()]}],"min-h":[{"min-h":["screen","lh","none",...$()]}],"max-h":[{"max-h":["screen","lh",...$()]}],"font-size":[{text:["base",n,Y1,N0]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[r,Jt,ZT]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",JT,Yt]}],"font-family":[{font:[Cpe,Yt,e]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[i,Jt,Yt]}],"line-clamp":[{"line-clamp":[Hn,"none",Jt,ZT]}],leading:[{leading:[a,...D()]}],"list-image":[{"list-image":["none",Jt,Yt]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",Jt,Yt]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:U()}],"text-color":[{text:U()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...ve(),"wavy"]}],"text-decoration-thickness":[{decoration:[Hn,"from-font","auto",Jt,N0]}],"text-decoration-color":[{decoration:U()}],"underline-offset":[{"underline-offset":[Hn,"auto",Jt,Yt]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:D()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Jt,Yt]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Jt,Yt]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:G()}],"bg-repeat":[{bg:F()}],"bg-size":[{bg:J()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},gd,Jt,Yt],radial:["",Jt,Yt],conic:[gd,Jt,Yt]},Tpe,wpe]}],"bg-color":[{bg:U()}],"gradient-from-pos":[{from:Q()}],"gradient-via-pos":[{via:Q()}],"gradient-to-pos":[{to:Q()}],"gradient-from":[{from:U()}],"gradient-via":[{via:U()}],"gradient-to":[{to:U()}],rounded:[{rounded:ne()}],"rounded-s":[{"rounded-s":ne()}],"rounded-e":[{"rounded-e":ne()}],"rounded-t":[{"rounded-t":ne()}],"rounded-r":[{"rounded-r":ne()}],"rounded-b":[{"rounded-b":ne()}],"rounded-l":[{"rounded-l":ne()}],"rounded-ss":[{"rounded-ss":ne()}],"rounded-se":[{"rounded-se":ne()}],"rounded-ee":[{"rounded-ee":ne()}],"rounded-es":[{"rounded-es":ne()}],"rounded-tl":[{"rounded-tl":ne()}],"rounded-tr":[{"rounded-tr":ne()}],"rounded-br":[{"rounded-br":ne()}],"rounded-bl":[{"rounded-bl":ne()}],"border-w":[{border:ye()}],"border-w-x":[{"border-x":ye()}],"border-w-y":[{"border-y":ye()}],"border-w-s":[{"border-s":ye()}],"border-w-e":[{"border-e":ye()}],"border-w-t":[{"border-t":ye()}],"border-w-r":[{"border-r":ye()}],"border-w-b":[{"border-b":ye()}],"border-w-l":[{"border-l":ye()}],"divide-x":[{"divide-x":ye()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":ye()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...ve(),"hidden","none"]}],"divide-style":[{divide:[...ve(),"hidden","none"]}],"border-color":[{border:U()}],"border-color-x":[{"border-x":U()}],"border-color-y":[{"border-y":U()}],"border-color-s":[{"border-s":U()}],"border-color-e":[{"border-e":U()}],"border-color-t":[{"border-t":U()}],"border-color-r":[{"border-r":U()}],"border-color-b":[{"border-b":U()}],"border-color-l":[{"border-l":U()}],"divide-color":[{divide:U()}],"outline-style":[{outline:[...ve(),"none","hidden"]}],"outline-offset":[{"outline-offset":[Hn,Jt,Yt]}],"outline-w":[{outline:["",Hn,Y1,N0]}],"outline-color":[{outline:U()}],shadow:[{shadow:["","none",f,gx,px]}],"shadow-color":[{shadow:U()}],"inset-shadow":[{"inset-shadow":["none",u,gx,px]}],"inset-shadow-color":[{"inset-shadow":U()}],"ring-w":[{ring:ye()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:U()}],"ring-offset-w":[{"ring-offset":[Hn,N0]}],"ring-offset-color":[{"ring-offset":U()}],"inset-ring-w":[{"inset-ring":ye()}],"inset-ring-color":[{"inset-ring":U()}],"text-shadow":[{"text-shadow":["none",d,gx,px]}],"text-shadow-color":[{"text-shadow":U()}],opacity:[{opacity:[Hn,Jt,Yt]}],"mix-blend":[{"mix-blend":[...Ce(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":Ce()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[Hn]}],"mask-image-linear-from-pos":[{"mask-linear-from":we()}],"mask-image-linear-to-pos":[{"mask-linear-to":we()}],"mask-image-linear-from-color":[{"mask-linear-from":U()}],"mask-image-linear-to-color":[{"mask-linear-to":U()}],"mask-image-t-from-pos":[{"mask-t-from":we()}],"mask-image-t-to-pos":[{"mask-t-to":we()}],"mask-image-t-from-color":[{"mask-t-from":U()}],"mask-image-t-to-color":[{"mask-t-to":U()}],"mask-image-r-from-pos":[{"mask-r-from":we()}],"mask-image-r-to-pos":[{"mask-r-to":we()}],"mask-image-r-from-color":[{"mask-r-from":U()}],"mask-image-r-to-color":[{"mask-r-to":U()}],"mask-image-b-from-pos":[{"mask-b-from":we()}],"mask-image-b-to-pos":[{"mask-b-to":we()}],"mask-image-b-from-color":[{"mask-b-from":U()}],"mask-image-b-to-color":[{"mask-b-to":U()}],"mask-image-l-from-pos":[{"mask-l-from":we()}],"mask-image-l-to-pos":[{"mask-l-to":we()}],"mask-image-l-from-color":[{"mask-l-from":U()}],"mask-image-l-to-color":[{"mask-l-to":U()}],"mask-image-x-from-pos":[{"mask-x-from":we()}],"mask-image-x-to-pos":[{"mask-x-to":we()}],"mask-image-x-from-color":[{"mask-x-from":U()}],"mask-image-x-to-color":[{"mask-x-to":U()}],"mask-image-y-from-pos":[{"mask-y-from":we()}],"mask-image-y-to-pos":[{"mask-y-to":we()}],"mask-image-y-from-color":[{"mask-y-from":U()}],"mask-image-y-to-color":[{"mask-y-to":U()}],"mask-image-radial":[{"mask-radial":[Jt,Yt]}],"mask-image-radial-from-pos":[{"mask-radial-from":we()}],"mask-image-radial-to-pos":[{"mask-radial-to":we()}],"mask-image-radial-from-color":[{"mask-radial-from":U()}],"mask-image-radial-to-color":[{"mask-radial-to":U()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":w()}],"mask-image-conic-pos":[{"mask-conic":[Hn]}],"mask-image-conic-from-pos":[{"mask-conic-from":we()}],"mask-image-conic-to-pos":[{"mask-conic-to":we()}],"mask-image-conic-from-color":[{"mask-conic-from":U()}],"mask-image-conic-to-color":[{"mask-conic-to":U()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:G()}],"mask-repeat":[{mask:F()}],"mask-size":[{mask:J()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",Jt,Yt]}],filter:[{filter:["","none",Jt,Yt]}],blur:[{blur:Ae()}],brightness:[{brightness:[Hn,Jt,Yt]}],contrast:[{contrast:[Hn,Jt,Yt]}],"drop-shadow":[{"drop-shadow":["","none",h,gx,px]}],"drop-shadow-color":[{"drop-shadow":U()}],grayscale:[{grayscale:["",Hn,Jt,Yt]}],"hue-rotate":[{"hue-rotate":[Hn,Jt,Yt]}],invert:[{invert:["",Hn,Jt,Yt]}],saturate:[{saturate:[Hn,Jt,Yt]}],sepia:[{sepia:["",Hn,Jt,Yt]}],"backdrop-filter":[{"backdrop-filter":["","none",Jt,Yt]}],"backdrop-blur":[{"backdrop-blur":Ae()}],"backdrop-brightness":[{"backdrop-brightness":[Hn,Jt,Yt]}],"backdrop-contrast":[{"backdrop-contrast":[Hn,Jt,Yt]}],"backdrop-grayscale":[{"backdrop-grayscale":["",Hn,Jt,Yt]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[Hn,Jt,Yt]}],"backdrop-invert":[{"backdrop-invert":["",Hn,Jt,Yt]}],"backdrop-opacity":[{"backdrop-opacity":[Hn,Jt,Yt]}],"backdrop-saturate":[{"backdrop-saturate":[Hn,Jt,Yt]}],"backdrop-sepia":[{"backdrop-sepia":["",Hn,Jt,Yt]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":D()}],"border-spacing-x":[{"border-spacing-x":D()}],"border-spacing-y":[{"border-spacing-y":D()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",Jt,Yt]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[Hn,"initial",Jt,Yt]}],ease:[{ease:["linear","initial",y,Jt,Yt]}],delay:[{delay:[Hn,Jt,Yt]}],animate:[{animate:["none",v,Jt,Yt]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[g,Jt,Yt]}],"perspective-origin":[{"perspective-origin":S()}],rotate:[{rotate:Me()}],"rotate-x":[{"rotate-x":Me()}],"rotate-y":[{"rotate-y":Me()}],"rotate-z":[{"rotate-z":Me()}],scale:[{scale:q()}],"scale-x":[{"scale-x":q()}],"scale-y":[{"scale-y":q()}],"scale-z":[{"scale-z":q()}],"scale-3d":["scale-3d"],skew:[{skew:k()}],"skew-x":[{"skew-x":k()}],"skew-y":[{"skew-y":k()}],transform:[{transform:[Jt,Yt,"","none","gpu","cpu"]}],"transform-origin":[{origin:S()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:Y()}],"translate-x":[{"translate-x":Y()}],"translate-y":[{"translate-y":Y()}],"translate-z":[{"translate-z":Y()}],"translate-none":["translate-none"],accent:[{accent:U()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:U()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Jt,Yt]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":D()}],"scroll-mx":[{"scroll-mx":D()}],"scroll-my":[{"scroll-my":D()}],"scroll-ms":[{"scroll-ms":D()}],"scroll-me":[{"scroll-me":D()}],"scroll-mt":[{"scroll-mt":D()}],"scroll-mr":[{"scroll-mr":D()}],"scroll-mb":[{"scroll-mb":D()}],"scroll-ml":[{"scroll-ml":D()}],"scroll-p":[{"scroll-p":D()}],"scroll-px":[{"scroll-px":D()}],"scroll-py":[{"scroll-py":D()}],"scroll-ps":[{"scroll-ps":D()}],"scroll-pe":[{"scroll-pe":D()}],"scroll-pt":[{"scroll-pt":D()}],"scroll-pr":[{"scroll-pr":D()}],"scroll-pb":[{"scroll-pb":D()}],"scroll-pl":[{"scroll-pl":D()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Jt,Yt]}],fill:[{fill:["none",...U()]}],"stroke-w":[{stroke:[Hn,Y1,N0,ZT]}],stroke:[{stroke:["none",...U()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},Dpe=(t,{cacheSize:e,prefix:n,experimentalParseClassName:r,extend:i={},override:a={}})=>(Sv(t,"cacheSize",e),Sv(t,"prefix",n),Sv(t,"experimentalParseClassName",r),mx(t.theme,a.theme),mx(t.classGroups,a.classGroups),mx(t.conflictingClassGroups,a.conflictingClassGroups),mx(t.conflictingClassGroupModifiers,a.conflictingClassGroupModifiers),Sv(t,"orderSensitiveModifiers",a.orderSensitiveModifiers),vx(t.theme,i.theme),vx(t.classGroups,i.classGroups),vx(t.conflictingClassGroups,i.conflictingClassGroups),vx(t.conflictingClassGroupModifiers,i.conflictingClassGroupModifiers),jz(t,i,"orderSensitiveModifiers"),t),Sv=(t,e,n)=>{n!==void 0&&(t[e]=n)},mx=(t,e)=>{if(e)for(const n in e)Sv(t,n,e[n])},vx=(t,e)=>{if(e)for(const n in e)jz(t,e,n)},jz=(t,e,n)=>{const r=e[n];r!==void 0&&(t[n]=t[n]?t[n].concat(r):r)},Ope=(t,...e)=>typeof t=="function"?G6(j6,t,...e):G6(()=>Dpe(j6(),t),...e),Mpe=G6(j6);var Ipe=t=>Cs(t)?Mpe:Ope({...t,extend:{theme:t.theme,classGroups:t.classGroups,conflictingClassGroupModifiers:t.conflictingClassGroupModifiers,conflictingClassGroups:t.conflictingClassGroups,...t.extend}}),Rpe={twMerge:!0,twMergeConfig:{},responsiveVariants:!1},Lw=(...t)=>{let e=[];zz(t,e);let n="";for(let r=0;r<e.length;r++)e[r]&&(n&&(n+=" "),n+=e[r]);return n||void 0};function zz(t,e){for(let n=0;n<t.length;n++){let r=t[n];Array.isArray(r)?zz(r,e):r&&e.push(r)}}var QT=null,z6={},W6=!1,yx=(...t)=>e=>{let n=Lw(t);return!n||!e.twMerge?n:((!QT||W6)&&(W6=!1,QT=Ipe(z6)),QT(n)||void 0)},jN=(t,e)=>{for(let n in e)n in t?t[n]=Lw(t[n],e[n]):t[n]=e[n];return t},Ppe=(t,e)=>{let{extend:n=null,slots:r={},variants:i={},compoundVariants:a=[],compoundSlots:o=[],defaultVariants:s={}}=t,l={...Rpe,...e},c=n?.base?Lw(n.base,t?.base):t?.base,f=n?.variants&&!Cs(n.variants)?Pz(i,n.variants):i,u=n?.defaultVariants&&!Cs(n.defaultVariants)?{...n.defaultVariants,...s}:s;!Cs(l.twMergeConfig)&&!qhe(l.twMergeConfig,z6)&&(W6=!0,z6=l.twMergeConfig);let d=Cs(n?.slots),h=Cs(r)?{}:{base:Lw(t?.base,d&&n?.base),...r},p=d?h:jN({...n?.slots},Cs(h)?{base:t?.base}:h),g=Cs(n?.compoundVariants)?a:Rz(n?.compoundVariants,a),m=v=>{if(Cs(f)&&Cs(r)&&d)return yx(c,v?.class,v?.className)(l);if(g&&!Array.isArray(g))throw new TypeError(`The "compoundVariants" prop must be an array. Received: ${typeof g}`);if(o&&!Array.isArray(o))throw new TypeError(`The "compoundSlots" prop must be an array. Received: ${typeof o}`);let x=(P,N,A=[],B)=>{let V=A;if(typeof N=="string"){let $=FN(N).split(" ");for(let U=0;U<$.length;U++)V.push(`${P}:${$[U]}`)}else if(Array.isArray(N))for(let $=0;$<N.length;$++)V.push(`${P}:${N[$]}`);else if(typeof N=="object"&&typeof B=="string"&&B in N){let $=N[B];if($&&typeof $=="string"){let U=FN($).split(" "),G=[];for(let F=0;F<U.length;F++)G.push(`${P}:${U[F]}`);V[B]=V[B]?V[B].concat(G):G}else if(Array.isArray($)&&$.length>0){let U=[];for(let G=0;G<$.length;G++)U.push(`${P}:${$[G]}`);V[B]=U}}return V},w=(P,N=f,A=null,B=null)=>{let V=N[P];if(!V||Cs(V))return null;let $=B?.[P]??v?.[P];if($===null)return null;let U=VN($),G=Array.isArray(l.responsiveVariants)&&l.responsiveVariants.length>0||l.responsiveVariants===!0,F=u?.[P],J=[];if(typeof U=="object"&&G)for(let[ye,ve]of Object.entries(U)){let Ce=V[ve];if(ye==="initial"){F=ve;continue}Array.isArray(l.responsiveVariants)&&!l.responsiveVariants.includes(ye)||(J=x(ye,Ce,J,A))}let Q=U!=null&&typeof U!="object"?U:VN(F),ne=V[Q||"false"];return typeof J=="object"&&typeof A=="string"&&J[A]?jN(J,ne):J.length>0?(J.push(ne),A==="base"?J.join(" "):J):ne},S=()=>{if(!f)return null;let P=Object.keys(f),N=[];for(let A=0;A<P.length;A++){let B=w(P[A],f);B&&N.push(B)}return N},T=(P,N)=>{if(!f||typeof f!="object")return null;let A=[];for(let B in f){let V=w(B,f,P,N),$=P==="base"&&typeof V=="string"?V:V&&V[P];$&&A.push($)}return A},_={};for(let P in v){let N=v[P];N!==void 0&&(_[P]=N)}let D=(P,N)=>{let A=typeof v?.[P]=="object"?{[P]:v[P]?.initial}:{};return{...u,..._,...A,...N}},I=(P=[],N)=>{let A=[],B=P.length;for(let V=0;V<B;V++){let{class:$,className:U,...G}=P[V],F=!0,J=D(null,N);for(let Q in G){let ne=G[Q],ye=J[Q];if(Array.isArray(ne)){if(!ne.includes(ye)){F=!1;break}}else{if((ne==null||ne===!1)&&(ye==null||ye===!1))continue;if(ye!==ne){F=!1;break}}}F&&($&&A.push($),U&&A.push(U))}return A},R=P=>{let N=I(g,P);if(!Array.isArray(N))return N;let A={},B=yx;for(let V=0;V<N.length;V++){let $=N[V];if(typeof $=="string")A.base=B(A.base,$)(l);else if(typeof $=="object")for(let U in $)A[U]=B(A[U],$[U])(l)}return A},O=P=>{if(o.length<1)return null;let N={},A=D(null,P);for(let B=0;B<o.length;B++){let{slots:V=[],class:$,className:U,...G}=o[B];if(!Cs(G)){let F=!0;for(let J in G){let Q=A[J],ne=G[J];if(Q===void 0||(Array.isArray(ne)?!ne.includes(Q):ne!==Q)){F=!1;break}}if(!F)continue}for(let F=0;F<V.length;F++){let J=V[F];N[J]||(N[J]=[]),N[J].push([$,U])}}return N};if(!Cs(r)||!d){let P={};if(typeof p=="object"&&!Cs(p)){let N=yx;for(let A in p)P[A]=B=>{let V=R(B),$=O(B);return N(p[A],T(A,B),V?V[A]:void 0,$?$[A]:void 0,B?.class,B?.className)(l)}}return P}return yx(c,S(),I(g),v?.class,v?.className)(l)},y=()=>{if(!(!f||typeof f!="object"))return Object.keys(f)};return m.variantKeys=y(),m.extend=n,m.base=c,m.slots=p,m.variants=f,m.defaultVariants=u,m.compoundSlots=o,m.compoundVariants=g,m},eo=(t,e)=>{var n,r,i;return Ppe(t,{...e,twMerge:(n=void 0)!=null?n:!0,twMergeConfig:{theme:{...(r=void 0)==null?void 0:r.theme,...kN.theme},classGroups:{...(i=void 0)==null?void 0:i.classGroups,...kN.classGroups}}})},zN=eo({slots:{base:"relative inline-flex flex-col gap-2 items-center justify-center",wrapper:"relative flex",label:"text-foreground dark:text-foreground-dark font-regular",circle1:"absolute w-full h-full rounded-full",circle2:"absolute w-full h-full rounded-full",dots:"relative rounded-full mx-auto",spinnerBars:["absolute","animate-fade-out","rounded-full","w-[25%]","h-[8%]","left-[calc(37.5%)]","top-[calc(46%)]","spinner-bar-animation"]},variants:{size:{sm:{wrapper:"w-5 h-5",circle1:"border-2",circle2:"border-2",dots:"size-1",label:"text-small"},md:{wrapper:"w-8 h-8",circle1:"border-3",circle2:"border-3",dots:"size-1.5",label:"text-medium"},lg:{wrapper:"w-10 h-10",circle1:"border-3",circle2:"border-3",dots:"size-2",label:"text-large"}},color:{current:{circle1:"border-b-current",circle2:"border-b-current",dots:"bg-current",spinnerBars:"bg-current"},white:{circle1:"border-b-white",circle2:"border-b-white",dots:"bg-white",spinnerBars:"bg-white"},default:{circle1:"border-b-default",circle2:"border-b-default",dots:"bg-default",spinnerBars:"bg-default"},primary:{circle1:"border-b-primary",circle2:"border-b-primary",dots:"bg-primary",spinnerBars:"bg-primary"},secondary:{circle1:"border-b-secondary",circle2:"border-b-secondary",dots:"bg-secondary",spinnerBars:"bg-secondary"},success:{circle1:"border-b-success",circle2:"border-b-success",dots:"bg-success",spinnerBars:"bg-success"},warning:{circle1:"border-b-warning",circle2:"border-b-warning",dots:"bg-warning",spinnerBars:"bg-warning"},danger:{circle1:"border-b-danger",circle2:"border-b-danger",dots:"bg-danger",spinnerBars:"bg-danger"}},labelColor:{foreground:{label:"text-foreground"},primary:{label:"text-primary"},secondary:{label:"text-secondary"},success:{label:"text-success"},warning:{label:"text-warning"},danger:{label:"text-danger"}},variant:{default:{circle1:["animate-spinner-ease-spin","border-solid","border-t-transparent","border-l-transparent","border-r-transparent"],circle2:["opacity-75","animate-spinner-linear-spin","border-dotted","border-t-transparent","border-l-transparent","border-r-transparent"]},gradient:{circle1:["border-0","bg-gradient-to-b","from-transparent","via-transparent","to-primary","animate-spinner-linear-spin","[animation-duration:1s]","[-webkit-mask:radial-gradient(closest-side,rgba(0,0,0,0.0)calc(100%-3px),rgba(0,0,0,1)calc(100%-3px))]"],circle2:["hidden"]},wave:{wrapper:"translate-y-3/4",dots:["animate-sway","spinner-dot-animation"]},dots:{wrapper:"translate-y-2/4",dots:["animate-blink","spinner-dot-blink-animation"]},spinner:{},simple:{wrapper:"text-foreground h-5 w-5 animate-spin",circle1:"opacity-25",circle2:"opacity-75"}}},defaultVariants:{size:"md",color:"primary",labelColor:"foreground",variant:"default"},compoundVariants:[{variant:"gradient",color:"current",class:{circle1:"to-current"}},{variant:"gradient",color:"white",class:{circle1:"to-white"}},{variant:"gradient",color:"default",class:{circle1:"to-default"}},{variant:"gradient",color:"primary",class:{circle1:"to-primary"}},{variant:"gradient",color:"secondary",class:{circle1:"to-secondary"}},{variant:"gradient",color:"success",class:{circle1:"to-success"}},{variant:"gradient",color:"warning",class:{circle1:"to-warning"}},{variant:"gradient",color:"danger",class:{circle1:"to-danger"}},{variant:"wave",size:"sm",class:{wrapper:"w-5 h-5"}},{variant:"wave",size:"md",class:{wrapper:"w-8 h-8"}},{variant:"wave",size:"lg",class:{wrapper:"w-12 h-12"}},{variant:"dots",size:"sm",class:{wrapper:"w-5 h-5"}},{variant:"dots",size:"md",class:{wrapper:"w-8 h-8"}},{variant:"dots",size:"lg",class:{wrapper:"w-12 h-12"}},{variant:"simple",size:"sm",class:{wrapper:"w-5 h-5"}},{variant:"simple",size:"md",class:{wrapper:"w-8 h-8"}},{variant:"simple",size:"lg",class:{wrapper:"w-12 h-12"}},{variant:"simple",color:"current",class:{wrapper:"text-current"}},{variant:"simple",color:"white",class:{wrapper:"text-white"}},{variant:"simple",color:"default",class:{wrapper:"text-default"}},{variant:"simple",color:"primary",class:{wrapper:"text-primary"}},{variant:"simple",color:"secondary",class:{wrapper:"text-secondary"}},{variant:"simple",color:"success",class:{wrapper:"text-success"}},{variant:"simple",color:"warning",class:{wrapper:"text-warning"}},{variant:"simple",color:"danger",class:{wrapper:"text-danger"}}]}),vu=["outline-solid outline-transparent","data-[focus-visible=true]:z-10","data-[focus-visible=true]:outline-2","data-[focus-visible=true]:outline-focus","data-[focus-visible=true]:outline-offset-2"],Ape=["outline-solid outline-transparent","group-data-[focus-visible=true]:z-10","group-data-[focus-visible=true]:ring-2","group-data-[focus-visible=true]:ring-focus","group-data-[focus-visible=true]:ring-offset-2","group-data-[focus-visible=true]:ring-offset-background"],Npe=["outline-solid outline-transparent","ring-2","ring-focus","ring-offset-2","ring-offset-background"],Rp={default:["[&+.border-medium.border-default]:ms-[calc(var(--heroui-border-width-medium)*-1)]"],primary:["[&+.border-medium.border-primary]:ms-[calc(var(--heroui-border-width-medium)*-1)]"],secondary:["[&+.border-medium.border-secondary]:ms-[calc(var(--heroui-border-width-medium)*-1)]"],success:["[&+.border-medium.border-success]:ms-[calc(var(--heroui-border-width-medium)*-1)]"],warning:["[&+.border-medium.border-warning]:ms-[calc(var(--heroui-border-width-medium)*-1)]"],danger:["[&+.border-medium.border-danger]:ms-[calc(var(--heroui-border-width-medium)*-1)]"]},WN=eo({slots:{base:"inline-flex",tabList:["flex","p-1","h-fit","gap-2","items-center","flex-nowrap","overflow-x-scroll","scrollbar-hide","bg-default-100"],tab:["z-0","w-full","px-3","py-1","flex","group","relative","justify-center","items-center","outline-solid outline-transparent","cursor-pointer","transition-opacity","tap-highlight-transparent","data-[disabled=true]:cursor-not-allowed","data-[disabled=true]:opacity-30","data-[hover-unselected=true]:opacity-disabled",...vu],tabContent:["relative","z-10","text-inherit","whitespace-nowrap","transition-colors","text-default-500","group-data-[selected=true]:text-foreground"],cursor:["absolute","z-0","bg-white"],panel:["py-3","px-1","outline-solid outline-transparent","data-[inert=true]:hidden",...vu],tabWrapper:[]},variants:{variant:{solid:{cursor:"inset-0"},light:{tabList:"bg-transparent dark:bg-transparent",cursor:"inset-0"},underlined:{tabList:"bg-transparent dark:bg-transparent",cursor:"h-[2px] w-[80%] bottom-0 shadow-[0_1px_0px_0_rgba(0,0,0,0.05)]"},bordered:{tabList:"bg-transparent dark:bg-transparent border-medium border-default-200 shadow-xs",cursor:"inset-0"}},color:{default:{},primary:{},secondary:{},success:{},warning:{},danger:{}},size:{sm:{tabList:"rounded-medium",tab:"h-7 text-tiny rounded-small",cursor:"rounded-small"},md:{tabList:"rounded-medium",tab:"h-8 text-small rounded-small",cursor:"rounded-small"},lg:{tabList:"rounded-large",tab:"h-9 text-medium rounded-medium",cursor:"rounded-medium"}},radius:{none:{tabList:"rounded-none",tab:"rounded-none",cursor:"rounded-none"},sm:{tabList:"rounded-medium",tab:"rounded-small",cursor:"rounded-small"},md:{tabList:"rounded-medium",tab:"rounded-small",cursor:"rounded-small"},lg:{tabList:"rounded-large",tab:"rounded-medium",cursor:"rounded-medium"},full:{tabList:"rounded-full",tab:"rounded-full",cursor:"rounded-full"}},fullWidth:{true:{base:"w-full",tabList:"w-full"}},isDisabled:{true:{tabList:"opacity-disabled pointer-events-none"}},disableAnimation:{true:{tab:"transition-none",tabContent:"transition-none"}},placement:{top:{},start:{tabList:"flex-col",panel:"py-0 px-3",tabWrapper:"flex"},end:{tabList:"flex-col",panel:"py-0 px-3",tabWrapper:"flex flex-row-reverse"},bottom:{tabWrapper:"flex flex-col-reverse"}}},defaultVariants:{color:"default",variant:"solid",size:"md",fullWidth:!1,isDisabled:!1},compoundVariants:[{variant:["solid","bordered","light"],color:"default",class:{cursor:["bg-background","dark:bg-default","shadow-small"],tabContent:"group-data-[selected=true]:text-default-foreground"}},{variant:["solid","bordered","light"],color:"primary",class:{cursor:It.solid.primary,tabContent:"group-data-[selected=true]:text-primary-foreground"}},{variant:["solid","bordered","light"],color:"secondary",class:{cursor:It.solid.secondary,tabContent:"group-data-[selected=true]:text-secondary-foreground"}},{variant:["solid","bordered","light"],color:"success",class:{cursor:It.solid.success,tabContent:"group-data-[selected=true]:text-success-foreground"}},{variant:["solid","bordered","light"],color:"warning",class:{cursor:It.solid.warning,tabContent:"group-data-[selected=true]:text-warning-foreground"}},{variant:["solid","bordered","light"],color:"danger",class:{cursor:It.solid.danger,tabContent:"group-data-[selected=true]:text-danger-foreground"}},{variant:"underlined",color:"default",class:{cursor:"bg-foreground",tabContent:"group-data-[selected=true]:text-foreground"}},{variant:"underlined",color:"primary",class:{cursor:"bg-primary",tabContent:"group-data-[selected=true]:text-primary"}},{variant:"underlined",color:"secondary",class:{cursor:"bg-secondary",tabContent:"group-data-[selected=true]:text-secondary"}},{variant:"underlined",color:"success",class:{cursor:"bg-success",tabContent:"group-data-[selected=true]:text-success"}},{variant:"underlined",color:"warning",class:{cursor:"bg-warning",tabContent:"group-data-[selected=true]:text-warning"}},{variant:"underlined",color:"danger",class:{cursor:"bg-danger",tabContent:"group-data-[selected=true]:text-danger"}},{disableAnimation:!0,variant:"underlined",class:{tab:["after:content-['']","after:absolute","after:bottom-0","after:h-[2px]","after:w-[80%]","after:opacity-0","after:shadow-[0_1px_0px_0_rgba(0,0,0,0.05)]","data-[selected=true]:after:opacity-100"]}},{disableAnimation:!0,color:"default",variant:["solid","bordered","light"],class:{tab:"data-[selected=true]:bg-default data-[selected=true]:text-default-foreground"}},{disableAnimation:!0,color:"primary",variant:["solid","bordered","light"],class:{tab:"data-[selected=true]:bg-primary data-[selected=true]:text-primary-foreground"}},{disableAnimation:!0,color:"secondary",variant:["solid","bordered","light"],class:{tab:"data-[selected=true]:bg-secondary data-[selected=true]:text-secondary-foreground"}},{disableAnimation:!0,color:"success",variant:["solid","bordered","light"],class:{tab:"data-[selected=true]:bg-success data-[selected=true]:text-success-foreground"}},{disableAnimation:!0,color:"warning",variant:["solid","bordered","light"],class:{tab:"data-[selected=true]:bg-warning data-[selected=true]:text-warning-foreground"}},{disableAnimation:!0,color:"danger",variant:["solid","bordered","light"],class:{tab:"data-[selected=true]:bg-danger data-[selected=true]:text-danger-foreground"}},{disableAnimation:!0,color:"default",variant:"underlined",class:{tab:"data-[selected=true]:after:bg-foreground"}},{disableAnimation:!0,color:"primary",variant:"underlined",class:{tab:"data-[selected=true]:after:bg-primary"}},{disableAnimation:!0,color:"secondary",variant:"underlined",class:{tab:"data-[selected=true]:after:bg-secondary"}},{disableAnimation:!0,color:"success",variant:"underlined",class:{tab:"data-[selected=true]:after:bg-success"}},{disableAnimation:!0,color:"warning",variant:"underlined",class:{tab:"data-[selected=true]:after:bg-warning"}},{disableAnimation:!0,color:"danger",variant:"underlined",class:{tab:"data-[selected=true]:after:bg-danger"}}],compoundSlots:[{variant:"underlined",slots:["tab","tabList","cursor"],class:["rounded-none"]}]}),Lpe=eo({slots:{base:"relative z-[100]"},variants:{disableAnimation:{false:{base:""},true:{base:["data-[placement=bottom-right]:bottom-0 data-[placement=bottom-right]:right-0 w-full px-2 sm:w-auto sm:px-0 data-[placement=bottom-right]:fixed data-[placement=bottom-right]:flex data-[placement=bottom-right]:flex-col","data-[placement=bottom-left]:bottom-0 data-[placement=bottom-left]:left-0 w-full px-2 sm:w-auto sm:px-0 data-[placement=bottom-left]:fixed data-[placement=bottom-left]:flex data-[placement=bottom-left]:flex-col","data-[placement=bottom-center]:bottom-0 data-[placement=bottom-center]:fixed w-full px-2 sm:w-auto sm:px-0 data-[placement=bottom-center]:flex data-[placement=bottom-center]:flex-col data-[placement=bottom-center]:left-1/2 data-[placement=bottom-center]:-translate-x-1/2","data-[placement=top-right]:top-0 data-[placement=top-right]:right-0 w-full px-2 sm:w-auto sm:px-0 data-[placement=top-right]:fixed data-[placement=top-right]:flex data-[placement=top-right]:flex-col","data-[placement=top-left]:top-0 data-[placement=top-left]:left-0 w-full px-2 sm:w-auto sm:px-0 data-[placement=top-left]:fixed data-[placement=top-left]:flex data-[placement=top-left]:flex-col","data-[placement=top-center]:top-0 data-[placement=top-center]:fixed w-full px-2 sm:w-auto sm:px-0 data-[placement=top-center]:flex data-[placement=top-center]:flex-col data-[placement=top-center]:left-1/2 data-[placement=top-center]:-translate-x-1/2"]}}},defaultVariants:{disableAnimation:!1}}),HN=eo({slots:{base:["flex gap-x-4 items-center","group","cursor-pointer","relative","z-50","box-border","outline-solid outline-transparent","p-3 sm:mx-1","my-1","w-full sm:w-[356px]","min-h-4","before:content-['']","before:absolute","before:left-0","before:right-0","data-[placement=bottom-right]:before:h-[var(--top-extension,16px)]","data-[placement=bottom-left]:before:h-[var(--top-extension,16px)]","data-[placement=bottom-center]:before:h-[var(--top-extension,16px)]","data-[placement=bottom-right]:before:top-[calc(-1*var(--top-extension,16px))]","data-[placement=bottom-left]:before:top-[calc(-1*var(--top-extension,16px))]","data-[placement=bottom-center]:before:top-[calc(-1*var(--top-extension,16px))]","before:z-[-1]","before:pointer-events-auto","before:bg-transparent","after:content-['']","after:absolute","after:left-0","after:right-0","data-[placement=bottom-right]:after:h-[var(--bottom-extension,16px)]","data-[placement=bottom-left]:after:h-[var(--bottom-extension,16px)]","data-[placement=bottom-center]:after:h-[var(--bottom-extension,16px)]","data-[placement=bottom-right]:after:bottom-[calc(-1*var(--bottom-extension,16px))]","data-[placement=bottom-left]:after:bottom-[calc(-1*var(--bottom-extension,16px))]","data-[placement=bottom-center]:after:bottom-[calc(-1*var(--bottom-extension,16px))]","after:z-[-1]","after:pointer-events-auto","after:bg-transparent","transform-gpu","will-change-transform","backface-visibility-hidden"],wrapper:["flex flex-col gap-y-0"],title:["text-sm","me-4","font-medium","text-foreground"],description:["text-sm","me-4","text-default-500"],icon:["w-6 h-6 flex-none fill-current"],loadingComponent:["w-6 h-6 flex-none fill-current"],content:["flex flex-grow flex-row gap-x-4 items-center relative"],progressTrack:["absolute inset-0 pointer-events-none bg-transparent overflow-hidden"],progressIndicator:["h-full bg-default-400 opacity-20"],motionDiv:["fixed","px-4 sm:px-0","data-[placement=bottom-right]:bottom-0 data-[placement=bottom-right]:right-0 data-[placement=bottom-right]:mx-auto w-full sm:data-[placement=bottom-right]:w-max mb-1 sm:data-[placement=bottom-right]:mr-2","data-[placement=bottom-left]:bottom-0 data-[placement=bottom-left]:left-0 data-[placement=bottom-left]:mx-auto w-full sm:data-[placement=bottom-left]:w-max mb-1 sm:data-[placement=bottom-left]:ml-2","data-[placement=bottom-center]:bottom-0 data-[placement=bottom-center]:left-0 data-[placement=bottom-center]:right-0 w-full sm:data-[placement=bottom-center]:w-max sm:data-[placement=bottom-center]:mx-auto","data-[placement=top-right]:top-0 data-[placement=top-right]:right-0 data-[placement=top-right]:mx-auto w-full sm:data-[placement=top-right]:w-max sm:data-[placement=top-right]:mr-2","data-[placement=top-left]:top-0 data-[placement=top-left]:left-0 data-[placement=top-left]:mx-auto w-full sm:data-[placement=top-left]:w-max sm:data-[placement=top-left]:ml-2","data-[placement=top-center]:top-0 data-[placement=top-center]:left-0 data-[placement=top-center]:right-0 w-full sm:data-[placement=top-center]:w-max sm:data-[placement=top-center]:mx-auto"],closeButton:["opacity-0 group-hover:opacity-100","transform-gpu","transition-all duration-200 ease-out","will-change-opacity will-change-transform","p-0 group-hover:pointer-events-auto w-6 h-6 min-w-4 absolute -right-2 -top-2 items-center justify-center bg-transparent text-default-400 hover:text-default-600 border border-3 border-transparent","data-[hidden=true]:hidden"],closeIcon:["rounded-full w-full h-full p-0.5 border border-default-400 bg-default-100"]},variants:{size:{sm:{icon:"w-5 h-5",loadingComponent:"w-5 h-5"},md:{},lg:{}},variant:{flat:"bg-content1 border border-default-100",solid:It.solid.default,bordered:"bg-background border border-default-200"},color:{default:"",foreground:{progressIndicator:"h-full opacity-20 bg-foreground-400"},primary:{progressIndicator:"h-full opacity-20 bg-primary-400"},secondary:{progressIndicator:"h-full opacity-20 bg-secondary-400"},success:{progressIndicator:"h-full opacity-20 bg-success-400"},warning:{progressIndicator:"h-full opacity-20 bg-warning-400"},danger:{progressIndicator:"h-full opacity-20 bg-danger-400"}},radius:{none:{base:"rounded-none",progressTrack:"rounded-none"},sm:{base:"rounded-small",progressTrack:"rounded-small"},md:{base:"rounded-medium",progressTrack:"rounded-medium"},lg:{base:"rounded-large",progressTrack:"rounded-large"},full:{base:"rounded-full",closeButton:"-top-px -right-px",progressTrack:"rounded-full"}},disableAnimation:{true:{closeButton:"transition-none",base:"data-[animation=exiting]:opacity-0 transition-none"},false:{closeButton:"transition-all ease-out duration-200",base:["data-[toast-exiting=true]:transform-gpu","data-[toast-exiting=true]:will-change-transform","data-[toast-exiting=true]:transition-all","data-[toast-exiting=true]:ease-out","data-[toast-exiting=true]:data-[placement=bottom-right]:translate-x-full","data-[toast-exiting=true]:data-[placement=bottom-left]:-translate-x-full","data-[toast-exiting=true]:data-[placement=bottom-center]:translate-y-full","data-[toast-exiting=true]:data-[placement=top-right]:translate-x-full","data-[toast-exiting=true]:data-[placement=top-left]:-translate-x-full","data-[toast-exiting=true]:data-[placement=top-center]:-translate-y-full","data-[toast-exiting=true]:opacity-0","data-[toast-exiting=true]:duration-300","data-[toast-exiting=true]:ease-out"]}},shadow:{none:{base:"shadow-none"},sm:{base:"shadow-small"},md:{base:"shadow-medium"},lg:{base:"shadow-large"}}},defaultVariants:{size:"md",variant:"flat",radius:"md",shadow:"sm"},compoundVariants:[{variant:"flat",color:"foreground",class:{base:"bg-foreground text-background",closeButton:"text-foreground-400 hover:text-foreground-600",closeIcon:"border border-foreground-400 bg-foreground-100",title:"text-background-600",description:"text-background-500"}},{variant:"flat",color:"primary",class:{base:"bg-primary-50 text-primary-600 border-primary-100",closeButton:"text-primary-400 hover:text-primary-600",closeIcon:"border border-primary-400 bg-primary-100",title:"text-primary-600",description:"text-primary-500"}},{variant:"flat",color:"secondary",class:{base:"bg-secondary-50 text-secondary-600 border-secondary-100",closeButton:"text-secondary-400 hover:text-secondary-600",closeIcon:"border border-secondary-400 bg-secondary-100",title:"text-secondary-600",description:"text-secondary-500"}},{variant:"flat",color:"success",class:{base:"bg-success-50 text-success-600 border-success-100",closeButton:"text-success-400 hover:text-success-600",closeIcon:"border border-success-400 bg-success-100",title:"text-success-600",description:"text-success-500"}},{variant:"flat",color:"warning",class:{base:"bg-warning-50 text-warning-600 border-warning-100",closeButton:"text-warning-400 hover:text-warning-600",closeIcon:"border border-warning-400 bg-warning-100",title:"text-warning-600",description:"text-warning-500"}},{variant:"flat",color:"danger",class:{base:"bg-danger-50 text-danger-600 border-danger-100",closeButton:"text-danger-400 hover:text-danger-600",closeIcon:"border border-danger-400 bg-danger-100",title:"text-danger-600",description:"text-danger-500"}},{variant:"bordered",color:"foreground",class:{base:"bg-foreground border-foreground-400 text-background",closeButton:"text-foreground-400 hover:text-foreground-600",closeIcon:"border border-foreground-400 bg-foreground-100",title:"text-background-600",description:"text-background-500"}},{variant:"bordered",color:"primary",class:{base:"border-primary-400 text-primary-600",closeButton:"text-primary-400 hover:text-primary-600",closeIcon:"border border-primary-400 bg-primary-100",title:"text-primary-600",description:"text-primary-500"}},{variant:"bordered",color:"secondary",class:{base:"border-secondary-400 text-secondary-600",closeButton:"text-secondary-400 hover:text-secondary-600",closeIcon:"border border-secondary-400 bg-secondary-100",title:"text-secondary-600",description:"text-secondary-500"}},{variant:"bordered",color:"success",class:{base:"border-success-400 text-success-600",closeButton:"text-success-400 hover:text-success-600",closeIcon:"border border-success-400 bg-success-100",title:"text-success-600",description:"text-success-500"}},{variant:"bordered",color:"warning",class:{base:"border-warning-400 text-warning-600",closeButton:"text-warning-400 hover:text-warning-600",closeIcon:"border border-warning-400 bg-warning-100",title:"text-warning-600",description:"text-warning-500"}},{variant:"bordered",color:"danger",class:{base:"border-danger-400 text-danger-600",closeButton:"text-danger-400 hover:text-danger-600",closeIcon:"border border-danger-400 bg-danger-100",title:"text-danger-600",description:"text-danger-500"}},{variant:"solid",color:"foreground",class:{base:It.solid.foreground,closeButton:"text-foreground-400 hover:text-foreground-600",closeIcon:"border border-foreground-400 bg-foreground-100",title:"text-background",description:"text-background"}},{variant:"solid",color:"primary",class:{base:It.solid.primary,closeButton:"text-primary-400 hover:text-primary-600",closeIcon:"border border-primary-400 bg-primary-100",title:"text-primary-foreground",description:"text-primary-foreground"}},{variant:"solid",color:"secondary",class:{base:It.solid.secondary,closeButton:"text-secondary-400 hover:text-secondary-600",closeIcon:"border border-secondary-400 bg-secondary-100",title:"text-secondary-foreground",description:"text-secondary-foreground"}},{variant:"solid",color:"success",class:{base:It.solid.success,closeButton:"text-success-400 hover:text-success-600",closeIcon:"border border-success-400 bg-success-100",title:"text-success-foreground",description:"text-success-foreground"}},{variant:"solid",color:"warning",class:{base:It.solid.warning,closeButton:"text-warning-400 hover:text-warning-600",closeIcon:"border border-warning-400 bg-warning-100",title:"text-warning-foreground",description:"text-warning-foreground"}},{variant:"solid",color:"danger",class:{base:It.solid.danger,closeButton:"text-danger-400 hover:text-danger-600",closeIcon:"border border-danger-400 bg-danger-100",title:"text-danger-foreground",description:"text-danger-foreground"}}]}),KN=eo({slots:{base:["p-2.5","-m-2.5","overflow-x-scroll","scrollbar-hide"],wrapper:["flex","flex-nowrap","h-fit","max-w-fit","relative","gap-1","items-center","overflow-visible"],item:["tap-highlight-transparent","select-none","touch-none"],prev:"",next:"",cursor:["absolute","flex","overflow-visible","items-center","justify-center","origin-center","left-0","select-none","touch-none","pointer-events-none","z-20"],forwardIcon:["hidden","group-hover:block","group-data-[focus-visible=true]:block","data-[before=true]:rotate-180"],ellipsis:"group-hover:hidden group-data-[focus-visible=true]:hidden",chevronNext:"rotate-180"},variants:{variant:{bordered:{item:["border-medium","border-default","bg-transparent","data-[hover=true]:bg-default-100"]},light:{item:"bg-transparent"},flat:{},faded:{item:["border-medium","border-default"]}},color:{default:{cursor:It.solid.default},primary:{cursor:It.solid.primary},secondary:{cursor:It.solid.secondary},success:{cursor:It.solid.success},warning:{cursor:It.solid.warning},danger:{cursor:It.solid.danger}},size:{sm:{},md:{},lg:{}},radius:{none:{},sm:{},md:{},lg:{},full:{}},isCompact:{true:{wrapper:"gap-0 shadow-xs",item:["shadow-none","first-of-type:rounded-e-none","last-of-type:rounded-s-none","[&:not(:first-of-type):not(:last-of-type)]:rounded-none"],prev:"!rounded-e-none",next:"!rounded-s-none"}},isDisabled:{true:{base:"opacity-disabled pointer-events-none"}},showShadow:{true:{}},disableCursorAnimation:{true:{cursor:"hidden"}},disableAnimation:{true:{item:"transition-none",cursor:"transition-none"},false:{item:["data-[pressed=true]:scale-[0.97]","transition-transform-background"],cursor:["data-[moving=true]:transition-transform","!data-[moving=true]:duration-300","opacity-0","data-[moving]:opacity-100"]}}},defaultVariants:{variant:"flat",color:"primary",size:"md",radius:"md",isCompact:!1,isDisabled:!1,showShadow:!1,disableCursorAnimation:!1},compoundVariants:[{showShadow:!0,color:"default",class:{cursor:[It.shadow.default,"shadow-md"]}},{showShadow:!0,color:"primary",class:{cursor:[It.shadow.primary,"shadow-md"]}},{showShadow:!0,color:"secondary",class:{cursor:[It.shadow.secondary,"shadow-md"]}},{showShadow:!0,color:"success",class:{cursor:[It.shadow.success,"shadow-md"]}},{showShadow:!0,color:"warning",class:{cursor:[It.shadow.warning,"shadow-md"]}},{showShadow:!0,color:"danger",class:{cursor:[It.shadow.danger,"shadow-md"]}},{isCompact:!0,variant:"bordered",class:{item:"[&:not(:first-of-type)]:ms-[calc(theme(borderWidth.2)*-1)]"}},{disableCursorAnimation:!0,color:"default",class:{item:["data-[active=true]:bg-default-400","data-[active=true]:border-default-400","data-[active=true]:text-default-foreground"]}},{disableCursorAnimation:!0,color:"primary",class:{item:["data-[active=true]:bg-primary","data-[active=true]:border-primary","data-[active=true]:text-primary-foreground"]}},{disableCursorAnimation:!0,color:"secondary",class:{item:["data-[active=true]:bg-secondary","data-[active=true]:border-secondary","data-[active=true]:text-secondary-foreground"]}},{disableCursorAnimation:!0,color:"success",class:{item:["data-[active=true]:bg-success","data-[active=true]:border-success","data-[active=true]:text-success-foreground"]}},{disableCursorAnimation:!0,color:"warning",class:{item:["data-[active=true]:bg-warning","data-[active=true]:border-warning","data-[active=true]:text-warning-foreground"]}},{disableCursorAnimation:!0,color:"danger",class:{item:["data-[active=true]:bg-danger","data-[active=true]:border-danger","data-[active=true]:text-danger-foreground"]}},{disableCursorAnimation:!0,showShadow:!0,color:"default",class:{item:["data-[active=true]:shadow-md","data-[active=true]:shadow-default/50"]}},{disableCursorAnimation:!0,showShadow:!0,color:"primary",class:{item:["data-[active=true]:shadow-md","data-[active=true]:shadow-primary/40"]}},{disableCursorAnimation:!0,showShadow:!0,color:"secondary",class:{item:["data-[active=true]:shadow-md","data-[active=true]:shadow-secondary/40"]}},{disableCursorAnimation:!0,showShadow:!0,color:"success",class:{item:["data-[active=true]:shadow-md","data-[active=true]:shadow-success/40"]}},{disableCursorAnimation:!0,showShadow:!0,color:"warning",class:{item:["data-[active=true]:shadow-md","data-[active=true]:shadow-warning/40"]}},{disableCursorAnimation:!0,showShadow:!0,color:"danger",class:{item:["data-[active=true]:shadow-md","data-[active=true]:shadow-danger/40"]}}],compoundSlots:[{slots:["item","prev","next"],class:["flex","flex-wrap","truncate","box-border","outline-solid outline-transparent","items-center","justify-center","text-default-foreground",...vu,"data-[disabled=true]:text-default-300","data-[disabled=true]:pointer-events-none"]},{slots:["item","prev","next"],variant:["flat","bordered","faded"],class:["shadow-xs"]},{slots:["item","prev","next"],variant:"flat",class:["bg-default-100","[&[data-hover=true]:not([data-active=true])]:bg-default-200","active:bg-default-300"]},{slots:["item","prev","next"],variant:"faded",class:["bg-default-50","[&[data-hover=true]:not([data-active=true])]:bg-default-100","active:bg-default-200"]},{slots:["item","prev","next"],variant:"light",class:["[&[data-hover=true]:not([data-active=true])]:bg-default-100","active:bg-default-200"]},{slots:["item","cursor","prev","next"],size:"sm",class:"min-w-8 w-8 h-8 text-tiny"},{slots:["item","cursor","prev","next"],size:"md",class:"min-w-9 w-9 h-9 text-small"},{slots:["item","cursor","prev","next"],size:"lg",class:"min-w-10 w-10 h-10 text-medium"},{slots:["wrapper","item","cursor","prev","next"],radius:"none",class:"rounded-none"},{slots:["wrapper","item","cursor","prev","next"],radius:"sm",class:"rounded-small"},{slots:["wrapper","item","cursor","prev","next"],radius:"md",class:"rounded-medium"},{slots:["wrapper","item","cursor","prev","next"],radius:"lg",class:"rounded-large"},{slots:["wrapper","item","cursor","prev","next"],radius:"full",class:"rounded-full"}]}),qN=eo({slots:{base:["z-0","relative","bg-transparent","before:content-['']","before:hidden","before:z-[-1]","before:absolute","before:rotate-45","before:w-2.5","before:h-2.5","before:rounded-sm","data-[arrow=true]:before:block","data-[placement=top]:before:-bottom-[calc(theme(spacing.5)/4_-_1.5px)]","data-[placement=top]:before:left-1/2","data-[placement=top]:before:-translate-x-1/2","data-[placement=top-start]:before:-bottom-[calc(theme(spacing.5)/4_-_1.5px)]","data-[placement=top-start]:before:left-3","data-[placement=top-end]:before:-bottom-[calc(theme(spacing.5)/4_-_1.5px)]","data-[placement=top-end]:before:right-3","data-[placement=bottom]:before:-top-[calc(theme(spacing.5)/4_-_1.5px)]","data-[placement=bottom]:before:left-1/2","data-[placement=bottom]:before:-translate-x-1/2","data-[placement=bottom-start]:before:-top-[calc(theme(spacing.5)/4_-_1.5px)]","data-[placement=bottom-start]:before:left-3","data-[placement=bottom-end]:before:-top-[calc(theme(spacing.5)/4_-_1.5px)]","data-[placement=bottom-end]:before:right-3","data-[placement=left]:before:-right-[calc(theme(spacing.5)/4_-_2px)]","data-[placement=left]:before:top-1/2","data-[placement=left]:before:-translate-y-1/2","data-[placement=left-start]:before:-right-[calc(theme(spacing.5)/4_-_3px)]","data-[placement=left-start]:before:top-1/4","data-[placement=left-end]:before:-right-[calc(theme(spacing.5)/4_-_3px)]","data-[placement=left-end]:before:bottom-1/4","data-[placement=right]:before:-left-[calc(theme(spacing.5)/4_-_2px)]","data-[placement=right]:before:top-1/2","data-[placement=right]:before:-translate-y-1/2","data-[placement=right-start]:before:-left-[calc(theme(spacing.5)/4_-_3px)]","data-[placement=right-start]:before:top-1/4","data-[placement=right-end]:before:-left-[calc(theme(spacing.5)/4_-_3px)]","data-[placement=right-end]:before:bottom-1/4",...vu],content:["z-10","px-2.5","py-1","w-full","inline-flex","flex-col","items-center","justify-center","box-border","subpixel-antialiased","outline-solid outline-transparent","box-border"],trigger:["z-10"],backdrop:["hidden"],arrow:[]},variants:{size:{sm:{content:"text-tiny"},md:{content:"text-small"},lg:{content:"text-medium"}},color:{default:{base:"before:bg-content1 before:shadow-small",content:"bg-content1"},foreground:{base:"before:bg-foreground",content:It.solid.foreground},primary:{base:"before:bg-primary",content:It.solid.primary},secondary:{base:"before:bg-secondary",content:It.solid.secondary},success:{base:"before:bg-success",content:It.solid.success},warning:{base:"before:bg-warning",content:It.solid.warning},danger:{base:"before:bg-danger",content:It.solid.danger}},radius:{none:{content:"rounded-none"},sm:{content:"rounded-small"},md:{content:"rounded-medium"},lg:{content:"rounded-large"},full:{content:"rounded-full"}},shadow:{none:{content:"shadow-none"},sm:{content:"shadow-small"},md:{content:"shadow-medium"},lg:{content:"shadow-large"}},backdrop:{transparent:{},opaque:{backdrop:"bg-overlay/50 backdrop-opacity-disabled"},blur:{backdrop:"backdrop-blur-sm backdrop-saturate-150 bg-overlay/30"}},triggerScaleOnOpen:{true:{trigger:["aria-expanded:scale-[0.97]","aria-expanded:opacity-70","subpixel-antialiased"]},false:{}},disableAnimation:{true:{base:"animate-none"}},isTriggerDisabled:{true:{trigger:"opacity-disabled pointer-events-none"},false:{}}},defaultVariants:{color:"default",radius:"lg",size:"md",shadow:"md",backdrop:"transparent",triggerScaleOnOpen:!0},compoundVariants:[{backdrop:["opaque","blur"],class:{backdrop:"block w-full h-full fixed inset-0 -z-30"}}]}),kpe=["data-[top-scroll=true]:[mask-image:linear-gradient(0deg,#000_calc(100%_-_var(--scroll-shadow-size)),transparent)]","data-[bottom-scroll=true]:[mask-image:linear-gradient(180deg,#000_calc(100%_-_var(--scroll-shadow-size)),transparent)]","data-[top-bottom-scroll=true]:[mask-image:linear-gradient(#000,#000,transparent_0,#000_var(--scroll-shadow-size),#000_calc(100%_-_var(--scroll-shadow-size)),transparent)]"],Vpe=["data-[left-scroll=true]:[mask-image:linear-gradient(270deg,#000_calc(100%_-_var(--scroll-shadow-size)),transparent)]","data-[right-scroll=true]:[mask-image:linear-gradient(90deg,#000_calc(100%_-_var(--scroll-shadow-size)),transparent)]","data-[left-right-scroll=true]:[mask-image:linear-gradient(to_right,#000,#000,transparent_0,#000_var(--scroll-shadow-size),#000_calc(100%_-_var(--scroll-shadow-size)),transparent)]"],kw=eo({base:[],variants:{orientation:{vertical:["overflow-y-auto",...kpe],horizontal:["overflow-x-auto",...Vpe]},hideScrollBar:{true:"scrollbar-hide",false:""}},defaultVariants:{orientation:"vertical",hideScrollBar:!1}}),XN=eo({slots:{base:["group inline-flex flex-col relative"],label:["block","absolute","z-10","origin-top-left","flex-shrink-0","rtl:origin-top-right","subpixel-antialiased","text-small","text-foreground-500","pointer-events-none","group-data-[has-label-outside=true]:pointer-events-auto"],mainWrapper:"w-full flex flex-col",trigger:"relative px-3 gap-3 w-full inline-flex flex-row items-center shadow-xs outline-solid outline-transparent tap-highlight-transparent",innerWrapper:"inline-flex h-fit w-[calc(100%_-theme(spacing.6))] min-h-4 items-center gap-1.5 box-border",selectorIcon:"absolute end-3 w-4 h-4",spinner:"absolute end-3",value:["text-foreground-500","font-normal","w-full","text-start"],listboxWrapper:"scroll-py-6 w-full",listbox:"",popoverContent:"w-full p-1 overflow-hidden",clearButton:["w-4","h-4","z-10","mb-4","relative","start-auto","appearance-none","outline-none","select-none","opacity-70","hover:!opacity-100","cursor-pointer","active:!opacity-70","rounded-full",...vu],helperWrapper:"p-1 flex relative flex-col gap-1.5 group-data-[has-helper=true]:flex",description:"text-tiny text-foreground-400",errorMessage:"text-tiny text-danger",endWrapper:"flex end-18",endContent:"mb-4"},variants:{variant:{flat:{trigger:["bg-default-100","data-[hover=true]:bg-default-200","group-data-[focus=true]:bg-default-200"],clearButton:"mb-4"},faded:{trigger:["bg-default-100","border-medium","border-default-200","data-[hover=true]:border-default-400 data-[focus=true]:border-default-400 data-[open=true]:border-default-400"],value:"group-data-[has-value=true]:text-default-foreground",clearButton:"mb-4"},bordered:{trigger:["border-medium","border-default-200","data-[hover=true]:border-default-400","data-[open=true]:border-default-foreground","data-[focus=true]:border-default-foreground"],value:"group-data-[has-value=true]:text-default-foreground",clearButton:"mb-4"},underlined:{trigger:["!px-1","!pb-0","!gap-0","relative","box-border","border-b-medium","shadow-[0_1px_0px_0_rgba(0,0,0,0.05)]","border-default-200","!rounded-none","hover:border-default-300","after:content-['']","after:w-0","after:origin-center","after:bg-default-foreground","after:absolute","after:left-1/2","after:-translate-x-1/2","after:-bottom-[2px]","after:h-[2px]","data-[open=true]:after:w-full","data-[focus=true]:after:w-full"],value:"group-data-[has-value=true]:text-default-foreground",clearButton:"mb-4 me-2"}},color:{default:{},primary:{selectorIcon:"text-primary"},secondary:{selectorIcon:"text-secondary"},success:{selectorIcon:"text-success"},warning:{selectorIcon:"text-warning"},danger:{selectorIcon:"text-danger"}},size:{sm:{label:"text-tiny",trigger:"h-8 min-h-8 px-2 rounded-small",value:"text-small",clearButton:"text-medium"},md:{trigger:"h-10 min-h-10 rounded-medium",value:"text-small",clearButton:"text-large"},lg:{trigger:"h-12 min-h-12 rounded-large",value:"text-medium",clearButton:"mb-5 text-large"}},radius:{none:{trigger:"rounded-none"},sm:{trigger:"rounded-small"},md:{trigger:"rounded-medium"},lg:{trigger:"rounded-large"},full:{trigger:"rounded-full"}},labelPlacement:{outside:{base:"flex flex-col",clearButton:"mb-0"},"outside-left":{base:"flex-row items-center flex-nowrap data-[has-helper=true]:items-start",label:"relative pe-2 text-foreground",clearButton:"mb-0"},inside:{label:"text-tiny cursor-pointer",trigger:"flex-col items-start justify-center gap-0"}},fullWidth:{true:{base:"w-full"},false:{base:"min-w-40"}},isClearable:{true:{clearButton:"peer-data-[filled=true]:opacity-70 peer-data-[filled=true]:block",endContent:"ms-3"}},isDisabled:{true:{base:"opacity-disabled pointer-events-none",trigger:"pointer-events-none"}},isInvalid:{true:{label:"!text-danger",value:"!text-danger",selectorIcon:"text-danger"}},isRequired:{true:{label:"after:content-['*'] after:text-danger after:ms-0.5"}},isMultiline:{true:{label:"relative",trigger:"!h-auto"},false:{value:"truncate"}},disableAnimation:{true:{trigger:"after:transition-none",base:"transition-none",label:"transition-none",selectorIcon:"transition-none"},false:{base:"transition-background motion-reduce:transition-none !duration-150",label:["will-change-auto","origin-top-left","rtl:origin-top-right","!duration-200","!ease-out","transition-[transform,color,left,opacity,translate,scale]","motion-reduce:transition-none"],selectorIcon:"transition-transform duration-150 ease motion-reduce:transition-none",clearButton:["transition-opacity","motion-reduce:transition-none"]}},disableSelectorIconRotation:{true:{},false:{selectorIcon:"data-[open=true]:rotate-180"}}},defaultVariants:{variant:"flat",color:"default",size:"md",fullWidth:!0,isDisabled:!1,isMultiline:!1,disableSelectorIconRotation:!1},compoundVariants:[{variant:"flat",color:"default",class:{value:"group-data-[has-value=true]:text-default-foreground",trigger:["bg-default-100","data-[hover=true]:bg-default-200"]}},{variant:"flat",color:"primary",class:{trigger:["bg-primary-100","text-primary","data-[hover=true]:bg-primary-50","group-data-[focus=true]:bg-primary-50"],value:"text-primary",label:"text-primary"}},{variant:"flat",color:"secondary",class:{trigger:["bg-secondary-100","text-secondary","data-[hover=true]:bg-secondary-50","group-data-[focus=true]:bg-secondary-50"],value:"text-secondary",label:"text-secondary"}},{variant:"flat",color:"success",class:{trigger:["bg-success-100","text-success-600","dark:text-success","data-[hover=true]:bg-success-50","group-data-[focus=true]:bg-success-50"],value:"text-success-600 dark:text-success",label:"text-success-600 dark:text-success"}},{variant:"flat",color:"warning",class:{trigger:["bg-warning-100","text-warning-600","dark:text-warning","data-[hover=true]:bg-warning-50","group-data-[focus=true]:bg-warning-50"],value:"text-warning-600 dark:text-warning",label:"text-warning-600 dark:text-warning"}},{variant:"flat",color:"danger",class:{trigger:["bg-danger-100","text-danger","dark:text-danger-500","data-[hover=true]:bg-danger-50","group-data-[focus=true]:bg-danger-50"],value:"text-danger dark:text-danger-500",label:"text-danger dark:text-danger-500"}},{variant:"faded",color:"primary",class:{trigger:"data-[hover=true]:border-primary data-[focus=true]:border-primary data-[open=true]:border-primary",label:"text-primary"}},{variant:"faded",color:"secondary",class:{trigger:"data-[hover=true]:border-secondary data-[focus=true]:border-secondary data-[open=true]:border-secondary",label:"text-secondary"}},{variant:"faded",color:"success",class:{trigger:"data-[hover=true]:border-success data-[focus=true]:border-success data-[open=true]:border-success",label:"text-success"}},{variant:"faded",color:"warning",class:{trigger:"data-[hover=true]:border-warning data-[focus=true]:border-warning data-[open=true]:border-warning",label:"text-warning"}},{variant:"faded",color:"danger",class:{trigger:"data-[hover=true]:border-danger data-[focus=true]:border-danger data-[open=true]:border-danger",label:"text-danger"}},{variant:"underlined",color:"default",class:{value:"group-data-[has-value=true]:text-foreground"}},{variant:"underlined",color:"primary",class:{trigger:"after:bg-primary",label:"text-primary"}},{variant:"underlined",color:"secondary",class:{trigger:"after:bg-secondary",label:"text-secondary"}},{variant:"underlined",color:"success",class:{trigger:"after:bg-success",label:"text-success"}},{variant:"underlined",color:"warning",class:{trigger:"after:bg-warning",label:"text-warning"}},{variant:"underlined",color:"danger",class:{trigger:"after:bg-danger",label:"text-danger"}},{variant:"bordered",color:"primary",class:{trigger:["data-[open=true]:border-primary","data-[focus=true]:border-primary"],label:"text-primary"}},{variant:"bordered",color:"secondary",class:{trigger:["data-[open=true]:border-secondary","data-[focus=true]:border-secondary"],label:"text-secondary"}},{variant:"bordered",color:"success",class:{trigger:["data-[open=true]:border-success","data-[focus=true]:border-success"],label:"text-success"}},{variant:"bordered",color:"warning",class:{trigger:["data-[open=true]:border-warning","data-[focus=true]:border-warning"],label:"text-warning"}},{variant:"bordered",color:"danger",class:{trigger:["data-[open=true]:border-danger","data-[focus=true]:border-danger"],label:"text-danger"}},{labelPlacement:"inside",color:"default",class:{label:"group-data-[filled=true]:text-default-600"}},{labelPlacement:"outside",color:"default",class:{label:"group-data-[filled=true]:text-foreground"}},{radius:"full",size:["sm"],class:{trigger:"px-3"}},{radius:"full",size:"md",class:{trigger:"px-4"}},{radius:"full",size:"lg",class:{trigger:"px-5"}},{disableAnimation:!1,variant:["faded","bordered"],class:{trigger:"transition-colors motion-reduce:transition-none"}},{disableAnimation:!1,variant:"underlined",class:{trigger:"after:transition-width motion-reduce:after:transition-none"}},{variant:["flat","faded"],class:{trigger:[...vu]}},{isInvalid:!0,variant:"flat",class:{trigger:["bg-danger-50","data-[hover=true]:bg-danger-100","group-data-[focus=true]:bg-danger-50"]}},{isInvalid:!0,variant:"bordered",class:{trigger:"!border-danger group-data-[focus=true]:border-danger"}},{isInvalid:!0,variant:"underlined",class:{trigger:"after:bg-danger"}},{labelPlacement:"inside",size:"sm",class:{trigger:"h-12 min-h-12 py-1.5 px-3"}},{labelPlacement:"inside",size:"md",class:{trigger:"h-14 min-h-14 py-2"}},{labelPlacement:"inside",size:"lg",class:{label:"text-medium",trigger:"h-16 min-h-16 py-2.5 gap-0"}},{labelPlacement:"outside",isMultiline:!1,class:{base:"group relative justify-end",label:["pb-0","z-20","top-1/2","-translate-y-1/2","group-data-[filled=true]:start-0"]}},{labelPlacement:["inside"],class:{label:"group-data-[filled=true]:scale-85"}},{labelPlacement:"inside",size:["sm","md"],class:{label:"text-small"}},{labelPlacement:"inside",isMultiline:!1,size:"sm",class:{label:["group-data-[filled=true]:-translate-y-[calc(50%_+_var(--heroui-font-size-tiny)/2_-_8px)]"],innerWrapper:"group-data-[has-label=true]:pt-4"}},{labelPlacement:"inside",isMultiline:!1,size:"md",class:{label:["group-data-[filled=true]:-translate-y-[calc(50%_+_var(--heroui-font-size-small)/2_-_6px)]"],innerWrapper:"group-data-[has-label=true]:pt-4"}},{labelPlacement:"inside",isMultiline:!1,size:"lg",class:{label:["text-medium","group-data-[filled=true]:-translate-y-[calc(50%_+_var(--heroui-font-size-small)/2_-_8px)]"],innerWrapper:"group-data-[has-label=true]:pt-5"}},{labelPlacement:"inside",variant:["faded","bordered"],isMultiline:!1,size:"sm",class:{label:["group-data-[filled=true]:-translate-y-[calc(50%_+_var(--heroui-font-size-tiny)/2_-_8px_-_var(--heroui-border-width-medium))]"]}},{labelPlacement:"inside",variant:["faded","bordered"],isMultiline:!1,size:"md",class:{label:["group-data-[filled=true]:-translate-y-[calc(50%_+_var(--heroui-font-size-small)/2_-_6px_-_var(--heroui-border-width-medium))]"]}},{labelPlacement:"inside",variant:["faded","bordered"],isMultiline:!1,size:"lg",class:{label:["text-medium","group-data-[filled=true]:-translate-y-[calc(50%_+_var(--heroui-font-size-small)/2_-_8px_-_var(--heroui-border-width-medium))]"]}},{labelPlacement:"inside",variant:"underlined",isMultiline:!1,size:"sm",class:{label:["group-data-[filled=true]:-translate-y-[calc(50%_+_var(--heroui-font-size-tiny)/2_-_5px)]"]}},{labelPlacement:"inside",variant:"underlined",isMultiline:!1,size:"md",class:{label:["group-data-[filled=true]:-translate-y-[calc(50%_+_var(--heroui-font-size-small)/2_-_3.5px)]"]}},{labelPlacement:"inside",variant:"underlined",isMultiline:!1,size:"lg",class:{label:["text-medium","group-data-[filled=true]:-translate-y-[calc(50%_+_var(--heroui-font-size-small)/2_-_4px)]"]}},{labelPlacement:"outside",size:"sm",isMultiline:!1,class:{label:["start-2","text-tiny","group-data-[filled=true]:-translate-y-[calc(100%_+var(--heroui-font-size-tiny)/2_+_16px)]","group-data-[has-helper=true]:-translate-y-[calc(100%_+_var(--heroui-font-size-small)/2_+_26px)]"],base:"data-[has-label=true]:mt-[calc(var(--heroui-font-size-small)_+_8px)]"}},{labelPlacement:"outside",isMultiline:!1,size:"md",class:{label:["start-3","text-small","group-data-[filled=true]:-translate-y-[calc(100%_+_var(--heroui-font-size-small)/2_+_20px)]","group-data-[has-helper=true]:-translate-y-[calc(100%_+_var(--heroui-font-size-small)/2_+_30px)]"],base:"data-[has-label=true]:mt-[calc(var(--heroui-font-size-small)_+_10px)]"}},{labelPlacement:"outside",isMultiline:!1,size:"lg",class:{label:["start-3","text-medium","group-data-[filled=true]:-translate-y-[calc(100%_+_var(--heroui-font-size-small)/2_+_24px)]","group-data-[has-helper=true]:-translate-y-[calc(100%_+_var(--heroui-font-size-small)/2_+_34px)]"],base:"data-[has-label=true]:mt-[calc(var(--heroui-font-size-small)_+_12px)]"}},{labelPlacement:"outside-left",size:"sm",class:{label:"group-data-[has-helper=true]:pt-2"}},{labelPlacement:"outside-left",size:"md",class:{label:"group-data-[has-helper=true]:pt-3"}},{labelPlacement:"outside-left",size:"lg",class:{label:"group-data-[has-helper=true]:pt-4"}},{labelPlacement:"outside",isMultiline:!0,class:{label:"pb-1.5"}},{labelPlacement:["inside","outside"],class:{label:["pe-2","max-w-full","text-ellipsis","overflow-hidden"]}},{labelPlacement:["outside","outside-left"],isClearable:!0,class:{endContent:["mt-4"],clearButton:["group-data-[has-end-content=true]:mt-4"]}},{isClearable:!1,labelPlacement:["outside","outside-left"],class:{endContent:["mt-4"]}},{isClearable:!0,variant:["underlined"],class:{clearButton:["relative group-data-[has-end-content=true]:left-2"],endContent:["me-2"]}},{isClearable:!1,variant:["underlined"],class:{endContent:["me-2"]}},{isClearable:!0,size:"sm",class:{endContent:"ms-2"}}]}),YN=eo({slots:{base:"group flex flex-col data-[hidden=true]:hidden",label:["absolute","z-10","pointer-events-none","origin-top-left","shrink-0","rtl:origin-top-right","subpixel-antialiased","block","text-small","text-foreground-500"],mainWrapper:"h-full",inputWrapper:"relative w-full inline-flex tap-highlight-transparent flex-row items-center shadow-xs px-3 gap-3",innerWrapper:"inline-flex w-full items-center h-full box-border",input:["w-full font-normal bg-transparent !outline-solid outline-transparent placeholder:text-foreground-500 focus-visible:outline-solid outline-transparent","data-[has-start-content=true]:ps-1.5","data-[has-end-content=true]:pe-1.5","data-[type=color]:rounded-none","file:cursor-pointer file:bg-transparent file:border-0","autofill:bg-transparent bg-clip-text"],clearButton:["p-2","-m-2","z-10","absolute","end-3","start-auto","pointer-events-none","appearance-none","outline-solid outline-transparent","select-none","opacity-0","cursor-pointer","active:!opacity-70","rounded-full",...vu],helperWrapper:"hidden group-data-[has-helper=true]:flex p-1 relative flex-col gap-1.5",description:"text-tiny text-foreground-400",errorMessage:"text-tiny text-danger"},variants:{variant:{flat:{inputWrapper:["bg-default-100","data-[hover=true]:bg-default-200","group-data-[focus=true]:bg-default-100"]},faded:{inputWrapper:["bg-default-100","border-medium","border-default-200","data-[hover=true]:border-default-400 focus-within:border-default-400"],value:"group-data-[has-value=true]:text-default-foreground"},bordered:{inputWrapper:["border-medium","border-default-200","data-[hover=true]:border-default-400","group-data-[focus=true]:border-default-foreground"]},underlined:{inputWrapper:["!px-1","!pb-0","!gap-0","relative","box-border","border-b-medium","shadow-[0_1px_0px_0_rgba(0,0,0,0.05)]","border-default-200","!rounded-none","hover:border-default-300","after:content-['']","after:w-0","after:origin-center","after:bg-default-foreground","after:absolute","after:left-1/2","after:-translate-x-1/2","after:-bottom-[2px]","after:h-[2px]","group-data-[focus=true]:after:w-full"],innerWrapper:"pb-1",label:"group-data-[filled-within=true]:text-foreground"}},color:{default:{},primary:{},secondary:{},success:{},warning:{},danger:{}},size:{sm:{label:"text-tiny",inputWrapper:"h-8 min-h-8 px-2 rounded-small",input:"text-small",clearButton:"text-medium"},md:{inputWrapper:"h-10 min-h-10 rounded-medium",input:"text-small",clearButton:"text-large hover:!opacity-100"},lg:{label:"text-medium",inputWrapper:"h-12 min-h-12 rounded-large",input:"text-medium",clearButton:"text-large hover:!opacity-100"}},radius:{none:{inputWrapper:"rounded-none"},sm:{inputWrapper:"rounded-small"},md:{inputWrapper:"rounded-medium"},lg:{inputWrapper:"rounded-large"},full:{inputWrapper:"rounded-full"}},labelPlacement:{outside:{mainWrapper:"flex flex-col"},"outside-left":{base:"flex-row items-center flex-nowrap data-[has-helper=true]:items-start",inputWrapper:"flex-1",mainWrapper:"flex flex-col",label:"relative text-foreground pe-2 ps-2 pointer-events-auto"},"outside-top":{mainWrapper:"flex flex-col",label:"relative text-foreground pb-2 pointer-events-auto"},inside:{label:"cursor-text",inputWrapper:"flex-col items-start justify-center gap-0",innerWrapper:"group-data-[has-label=true]:items-end"}},fullWidth:{true:{base:"w-full"},false:{}},isClearable:{true:{input:"peer pe-6 input-search-cancel-button-none",clearButton:["peer-data-[filled=true]:pointer-events-auto","peer-data-[filled=true]:opacity-70 peer-data-[filled=true]:block","peer-data-[filled=true]:scale-100"]}},isDisabled:{true:{base:"opacity-disabled pointer-events-none",inputWrapper:"pointer-events-none",label:"pointer-events-none"}},isInvalid:{true:{label:"!text-danger",input:"!placeholder:text-danger !text-danger"}},isRequired:{true:{label:"after:content-['*'] after:text-danger after:ms-0.5"}},isMultiline:{true:{label:"relative",inputWrapper:"!h-auto",innerWrapper:"items-start group-data-[has-label=true]:items-start",input:"resize-none data-[hide-scroll=true]:scrollbar-hide",clearButton:"absolute top-2 right-2 rtl:right-auto rtl:left-2 z-10"}},disableAnimation:{true:{input:"transition-none",inputWrapper:"transition-none",label:"transition-none"},false:{inputWrapper:"transition-background motion-reduce:transition-none !duration-150",label:["will-change-auto","!duration-200","!ease-out","motion-reduce:transition-none","transition-[transform,color,left,opacity,translate,scale]"],clearButton:["scale-90","ease-out","duration-150","transition-[opacity,transform]","motion-reduce:transition-none","motion-reduce:scale-100"]}}},defaultVariants:{variant:"flat",color:"default",size:"md",fullWidth:!0,isDisabled:!1,isMultiline:!1},compoundVariants:[{variant:"flat",color:"default",class:{input:"group-data-[has-value=true]:text-default-foreground"}},{variant:"flat",color:"primary",class:{inputWrapper:["bg-primary-100","data-[hover=true]:bg-primary-50","text-primary","group-data-[focus=true]:bg-primary-50","placeholder:text-primary"],input:"placeholder:text-primary",label:"text-primary"}},{variant:"flat",color:"secondary",class:{inputWrapper:["bg-secondary-100","text-secondary","data-[hover=true]:bg-secondary-50","group-data-[focus=true]:bg-secondary-50","placeholder:text-secondary"],input:"placeholder:text-secondary",label:"text-secondary"}},{variant:"flat",color:"success",class:{inputWrapper:["bg-success-100","text-success-600","dark:text-success","placeholder:text-success-600","dark:placeholder:text-success","data-[hover=true]:bg-success-50","group-data-[focus=true]:bg-success-50"],input:"placeholder:text-success-600 dark:placeholder:text-success",label:"text-success-600 dark:text-success"}},{variant:"flat",color:"warning",class:{inputWrapper:["bg-warning-100","text-warning-600","dark:text-warning","placeholder:text-warning-600","dark:placeholder:text-warning","data-[hover=true]:bg-warning-50","group-data-[focus=true]:bg-warning-50"],input:"placeholder:text-warning-600 dark:placeholder:text-warning",label:"text-warning-600 dark:text-warning"}},{variant:"flat",color:"danger",class:{inputWrapper:["bg-danger-100","text-danger","dark:text-danger-500","placeholder:text-danger","dark:placeholder:text-danger-500","data-[hover=true]:bg-danger-50","group-data-[focus=true]:bg-danger-50"],input:"placeholder:text-danger dark:placeholder:text-danger-500",label:"text-danger dark:text-danger-500"}},{variant:"faded",color:"primary",class:{label:"text-primary",inputWrapper:"data-[hover=true]:border-primary focus-within:border-primary"}},{variant:"faded",color:"secondary",class:{label:"text-secondary",inputWrapper:"data-[hover=true]:border-secondary focus-within:border-secondary"}},{variant:"faded",color:"success",class:{label:"text-success",inputWrapper:"data-[hover=true]:border-success focus-within:border-success"}},{variant:"faded",color:"warning",class:{label:"text-warning",inputWrapper:"data-[hover=true]:border-warning focus-within:border-warning"}},{variant:"faded",color:"danger",class:{label:"text-danger",inputWrapper:"data-[hover=true]:border-danger focus-within:border-danger"}},{variant:"underlined",color:"default",class:{input:"group-data-[has-value=true]:text-foreground"}},{variant:"underlined",color:"primary",class:{inputWrapper:"after:bg-primary",label:"text-primary"}},{variant:"underlined",color:"secondary",class:{inputWrapper:"after:bg-secondary",label:"text-secondary"}},{variant:"underlined",color:"success",class:{inputWrapper:"after:bg-success",label:"text-success"}},{variant:"underlined",color:"warning",class:{inputWrapper:"after:bg-warning",label:"text-warning"}},{variant:"underlined",color:"danger",class:{inputWrapper:"after:bg-danger",label:"text-danger"}},{variant:"bordered",color:"primary",class:{inputWrapper:"group-data-[focus=true]:border-primary",label:"text-primary"}},{variant:"bordered",color:"secondary",class:{inputWrapper:"group-data-[focus=true]:border-secondary",label:"text-secondary"}},{variant:"bordered",color:"success",class:{inputWrapper:"group-data-[focus=true]:border-success",label:"text-success"}},{variant:"bordered",color:"warning",class:{inputWrapper:"group-data-[focus=true]:border-warning",label:"text-warning"}},{variant:"bordered",color:"danger",class:{inputWrapper:"group-data-[focus=true]:border-danger",label:"text-danger"}},{labelPlacement:"inside",color:"default",class:{label:"group-data-[filled-within=true]:text-default-600"}},{labelPlacement:"outside",color:"default",class:{label:"group-data-[filled-within=true]:text-foreground"}},{radius:"full",size:["sm"],class:{inputWrapper:"px-3"}},{radius:"full",size:"md",class:{inputWrapper:"px-4"}},{radius:"full",size:"lg",class:{inputWrapper:"px-5"}},{disableAnimation:!1,variant:["faded","bordered"],class:{inputWrapper:"transition-colors motion-reduce:transition-none"}},{disableAnimation:!1,variant:"underlined",class:{inputWrapper:"after:transition-width motion-reduce:after:transition-none"}},{variant:["flat","faded"],class:{inputWrapper:[...Ape]}},{isInvalid:!0,variant:"flat",class:{inputWrapper:["!bg-danger-50","data-[hover=true]:!bg-danger-100","group-data-[focus=true]:!bg-danger-50"]}},{isInvalid:!0,variant:"bordered",class:{inputWrapper:"!border-danger group-data-[focus=true]:!border-danger"}},{isInvalid:!0,variant:"underlined",class:{inputWrapper:"after:!bg-danger"}},{labelPlacement:"inside",size:"sm",class:{inputWrapper:"h-12 py-1.5 px-3"}},{labelPlacement:"inside",size:"md",class:{inputWrapper:"h-14 py-2"}},{labelPlacement:"inside",size:"lg",class:{inputWrapper:"h-16 py-2.5 gap-0"}},{labelPlacement:"inside",size:"sm",variant:["bordered","faded"],class:{inputWrapper:"py-1"}},{labelPlacement:["inside","outside"],class:{label:["group-data-[filled-within=true]:pointer-events-auto"]}},{labelPlacement:"outside",isMultiline:!1,class:{base:"relative justify-end",label:["pb-0","z-20","top-1/2","-translate-y-1/2","group-data-[filled-within=true]:start-0"]}},{labelPlacement:["inside"],class:{label:["group-data-[filled-within=true]:scale-85"]}},{labelPlacement:["inside"],variant:"flat",class:{innerWrapper:"pb-0.5"}},{variant:"underlined",size:"sm",class:{innerWrapper:"pb-1"}},{variant:"underlined",size:["md","lg"],class:{innerWrapper:"pb-1.5"}},{labelPlacement:"inside",size:["sm","md"],class:{label:"text-small"}},{labelPlacement:"inside",isMultiline:!1,size:"sm",class:{label:["group-data-[filled-within=true]:-translate-y-[calc(50%_+_var(--heroui-font-size-tiny)/2_-_8px)]"]}},{labelPlacement:"inside",isMultiline:!1,size:"md",class:{label:["group-data-[filled-within=true]:-translate-y-[calc(50%_+_var(--heroui-font-size-small)/2_-_6px)]"]}},{labelPlacement:"inside",isMultiline:!1,size:"lg",class:{label:["text-medium","group-data-[filled-within=true]:-translate-y-[calc(50%_+_var(--heroui-font-size-small)/2_-_8px)]"]}},{labelPlacement:"inside",variant:["faded","bordered"],isMultiline:!1,size:"sm",class:{label:["group-data-[filled-within=true]:-translate-y-[calc(50%_+_var(--heroui-font-size-tiny)/2_-_8px_-_var(--heroui-border-width-medium))]"]}},{labelPlacement:"inside",variant:["faded","bordered"],isMultiline:!1,size:"md",class:{label:["group-data-[filled-within=true]:-translate-y-[calc(50%_+_var(--heroui-font-size-small)/2_-_6px_-_var(--heroui-border-width-medium))]"]}},{labelPlacement:"inside",variant:["faded","bordered"],isMultiline:!1,size:"lg",class:{label:["text-medium","group-data-[filled-within=true]:-translate-y-[calc(50%_+_var(--heroui-font-size-small)/2_-_8px_-_var(--heroui-border-width-medium))]"]}},{labelPlacement:"inside",variant:"underlined",isMultiline:!1,size:"sm",class:{label:["group-data-[filled-within=true]:-translate-y-[calc(50%_+_var(--heroui-font-size-tiny)/2_-_5px)]"]}},{labelPlacement:"inside",variant:"underlined",isMultiline:!1,size:"md",class:{label:["group-data-[filled-within=true]:-translate-y-[calc(50%_+_var(--heroui-font-size-small)/2_-_3.5px)]"]}},{labelPlacement:"inside",variant:"underlined",size:"lg",isMultiline:!1,class:{label:["text-medium","group-data-[filled-within=true]:-translate-y-[calc(50%_+_var(--heroui-font-size-small)/2_-_4px)]"]}},{labelPlacement:"outside",size:"sm",isMultiline:!1,class:{label:["start-2","text-tiny","group-data-[filled-within=true]:-translate-y-[calc(100%_+_var(--heroui-font-size-tiny)/2_+_16px)]"],base:"data-[has-label=true]:mt-[calc(var(--heroui-font-size-small)_+_8px)]"}},{labelPlacement:"outside",size:"md",isMultiline:!1,class:{label:["start-3","end-auto","text-small","group-data-[filled-within=true]:-translate-y-[calc(100%_+_var(--heroui-font-size-small)/2_+_20px)]"],base:"data-[has-label=true]:mt-[calc(var(--heroui-font-size-small)_+_10px)]"}},{labelPlacement:"outside",size:"lg",isMultiline:!1,class:{label:["start-3","end-auto","text-medium","group-data-[filled-within=true]:-translate-y-[calc(100%_+_var(--heroui-font-size-small)/2_+_24px)]"],base:"data-[has-label=true]:mt-[calc(var(--heroui-font-size-small)_+_12px)]"}},{labelPlacement:"outside-left",size:"sm",class:{label:"group-data-[has-helper=true]:pt-2"}},{labelPlacement:"outside-left",size:"md",class:{label:"group-data-[has-helper=true]:pt-3"}},{labelPlacement:"outside-left",size:"lg",class:{label:"group-data-[has-helper=true]:pt-4"}},{labelPlacement:["outside","outside-left"],isMultiline:!0,class:{inputWrapper:"py-2"}},{labelPlacement:"outside",isMultiline:!0,class:{label:"pb-1.5"}},{labelPlacement:"inside",isMultiline:!0,class:{label:"pb-0.5",input:"pt-0"}},{isMultiline:!0,disableAnimation:!1,class:{input:"transition-height !duration-100 motion-reduce:transition-none"}},{labelPlacement:["inside","outside"],class:{label:["pe-2","max-w-full","text-ellipsis","overflow-hidden"]}},{isMultiline:!0,radius:"full",class:{inputWrapper:"data-[has-multiple-rows=true]:rounded-large"}},{isClearable:!0,isMultiline:!0,class:{clearButton:["group-data-[has-value=true]:opacity-70 group-data-[has-value=true]:block","group-data-[has-value=true]:scale-100","group-data-[has-value=true]:pointer-events-auto"]}}]}),Fpe=eo({slots:{base:"w-full relative flex flex-col gap-1 p-1 overflow-clip",list:"w-full flex flex-col gap-0.5 outline-solid outline-transparent",emptyContent:["h-10","px-2","py-1.5","w-full","h-full","text-foreground-400","text-start"]}}),JN=eo({slots:{base:["flex","group","gap-2","items-center","justify-between","relative","px-2","py-1.5","w-full","h-full","box-border","rounded-small","subpixel-antialiased","outline-solid outline-transparent","cursor-pointer","tap-highlight-transparent",...vu,"data-[focus-visible=true]:dark:ring-offset-background-content1"],wrapper:"w-full flex flex-col items-start justify-center",title:"flex-1 text-small font-normal",description:["w-full","text-tiny","text-foreground-500","group-hover:text-current"],selectedIcon:["text-inherit","w-3","h-3","shrink-0"],shortcut:["px-1","py-0.5","rounded-sm","font-sans","text-foreground-500","text-tiny","border-small","border-default-300","group-hover:border-current"]},variants:{variant:{solid:{base:""},bordered:{base:"border-medium border-transparent bg-transparent"},light:{base:"bg-transparent"},faded:{base:["border-small border-transparent hover:border-default data-[hover=true]:bg-default-100","data-[selectable=true]:focus:border-default data-[selectable=true]:focus:bg-default-100"]},flat:{base:""},shadow:{base:"data-[hover=true]:shadow-lg"}},color:{default:{},primary:{},secondary:{},success:{},warning:{},danger:{}},showDivider:{true:{base:["mb-1.5","after:content-['']","after:absolute","after:-bottom-1","after:left-0","after:right-0","after:h-divider","after:bg-divider"]},false:{}},isDisabled:{true:{base:"opacity-disabled pointer-events-none"}},disableAnimation:{true:{},false:{base:"data-[hover=true]:transition-colors"}},hasTitleTextChild:{true:{title:"truncate"}},hasDescriptionTextChild:{true:{description:"truncate"}}},defaultVariants:{variant:"solid",color:"default",showDivider:!1},compoundVariants:[{variant:"solid",color:"default",class:{base:["data-[hover=true]:bg-default","data-[hover=true]:text-default-foreground","data-[selectable=true]:focus:bg-default","data-[selectable=true]:focus:text-default-foreground"]}},{variant:"solid",color:"primary",class:{base:["data-[hover=true]:bg-primary data-[hover=true]:text-primary-foreground","data-[selectable=true]:focus:bg-primary data-[selectable=true]:focus:text-primary-foreground"]}},{variant:"solid",color:"secondary",class:{base:["data-[hover=true]:bg-secondary data-[hover=true]:text-secondary-foreground","data-[selectable=true]:focus:bg-secondary data-[selectable=true]:focus:text-secondary-foreground"]}},{variant:"solid",color:"success",class:{base:["data-[hover=true]:bg-success data-[hover=true]:text-success-foreground","data-[selectable=true]:focus:bg-success data-[selectable=true]:focus:text-success-foreground"]}},{variant:"solid",color:"warning",class:{base:["data-[hover=true]:bg-warning data-[hover=true]:text-warning-foreground","data-[selectable=true]:focus:bg-warning data-[selectable=true]:focus:text-warning-foreground"]}},{variant:"solid",color:"danger",class:{base:["data-[hover=true]:bg-danger data-[hover=true]:text-danger-foreground","data-[selectable=true]:focus:bg-danger data-[selectable=true]:focus:text-danger-foreground"]}},{variant:"shadow",color:"default",class:{base:["data-[hover=true]:shadow-default/50 data-[hover=true]:bg-default data-[hover=true]:text-default-foreground","data-[selectable=true]:focus:shadow-default/50 data-[selectable=true]:focus:bg-default data-[selectable=true]:focus:text-default-foreground"]}},{variant:"shadow",color:"primary",class:{base:["data-[hover=true]:shadow-primary/30 data-[hover=true]:bg-primary data-[hover=true]:text-primary-foreground","data-[selectable=true]:focus:shadow-primary/30 data-[selectable=true]:focus:bg-primary data-[selectable=true]:focus:text-primary-foreground"]}},{variant:"shadow",color:"secondary",class:{base:["data-[hover=true]:shadow-secondary/30 data-[hover=true]:bg-secondary data-[hover=true]:text-secondary-foreground","data-[selectable=true]:focus:shadow-secondary/30 data-[selectable=true]:focus:bg-secondary data-[selectable=true]:focus:text-secondary-foreground"]}},{variant:"shadow",color:"success",class:{base:["data-[hover=true]:shadow-success/30 data-[hover=true]:bg-success data-[hover=true]:text-success-foreground","data-[selectable=true]:focus:shadow-success/30 data-[selectable=true]:focus:bg-success data-[selectable=true]:focus:text-success-foreground"]}},{variant:"shadow",color:"warning",class:{base:["data-[hover=true]:shadow-warning/30 data-[hover=true]:bg-warning data-[hover=true]:text-warning-foreground","data-[selectable=true]:focus:shadow-warning/30 data-[selectable=true]:focus:bg-warning data-[selectable=true]:focus:text-warning-foreground"]}},{variant:"shadow",color:"danger",class:{base:["data-[hover=true]:shadow-danger/30 data-[hover=true]:bg-danger data-[hover=true]:text-danger-foreground","data-[selectable=true]:focus:shadow-danger/30 data-[selectable=true]:focus:bg-danger data-[selectable=true]:focus:text-danger-foreground"]}},{variant:"bordered",color:"default",class:{base:["data-[hover=true]:border-default","data-[selectable=true]:focus:border-default"]}},{variant:"bordered",color:"primary",class:{base:["data-[hover=true]:border-primary data-[hover=true]:text-primary","data-[selectable=true]:focus:border-primary data-[selectable=true]:focus:text-primary"]}},{variant:"bordered",color:"secondary",class:{base:["data-[hover=true]:border-secondary data-[hover=true]:text-secondary","data-[selectable=true]:focus:border-secondary data-[selectable=true]:focus:text-secondary"]}},{variant:"bordered",color:"success",class:{base:["data-[hover=true]:border-success data-[hover=true]:text-success","data-[selectable=true]:focus:border-success data-[selectable=true]:focus:text-success"]}},{variant:"bordered",color:"warning",class:{base:["data-[hover=true]:border-warning data-[hover=true]:text-warning","data-[selectable=true]:focus:border-warning data-[selectable=true]:focus:text-warning"]}},{variant:"bordered",color:"danger",class:{base:["data-[hover=true]:border-danger data-[hover=true]:text-danger","data-[selectable=true]:focus:border-danger data-[selectable=true]:focus:text-danger"]}},{variant:"flat",color:"default",class:{base:["data-[hover=true]:bg-default/40","data-[hover=true]:text-default-foreground","data-[selectable=true]:focus:bg-default/40","data-[selectable=true]:focus:text-default-foreground"]}},{variant:"flat",color:"primary",class:{base:["data-[hover=true]:bg-primary/20 data-[hover=true]:text-primary","data-[selectable=true]:focus:bg-primary/20 data-[selectable=true]:focus:text-primary"]}},{variant:"flat",color:"secondary",class:{base:["data-[hover=true]:bg-secondary/20 data-[hover=true]:text-secondary","data-[selectable=true]:focus:bg-secondary/20 data-[selectable=true]:focus:text-secondary"]}},{variant:"flat",color:"success",class:{base:["data-[hover=true]:bg-success/20 data-[hover=true]:text-success","data-[selectable=true]:focus:bg-success/20 data-[selectable=true]:focus:text-success"]}},{variant:"flat",color:"warning",class:{base:["data-[hover=true]:bg-warning/20 data-[hover=true]:text-warning","data-[selectable=true]:focus:bg-warning/20 data-[selectable=true]:focus:text-warning"]}},{variant:"flat",color:"danger",class:{base:["data-[hover=true]:bg-danger/20 data-[hover=true]:text-danger","data-[selectable=true]:focus:bg-danger/20 data-[selectable=true]:focus:text-danger"]}},{variant:"faded",color:"default",class:{base:["data-[hover=true]:text-default-foreground","data-[selectable=true]:focus:text-default-foreground"]}},{variant:"faded",color:"primary",class:{base:["data-[hover=true]:text-primary","data-[selectable=true]:focus:text-primary"]}},{variant:"faded",color:"secondary",class:{base:["data-[hover=true]:text-secondary","data-[selectable=true]:focus:text-secondary"]}},{variant:"faded",color:"success",class:{base:["data-[hover=true]:text-success","data-[selectable=true]:focus:text-success"]}},{variant:"faded",color:"warning",class:{base:["data-[hover=true]:text-warning","data-[selectable=true]:focus:text-warning"]}},{variant:"faded",color:"danger",class:{base:["data-[hover=true]:text-danger","data-[selectable=true]:focus:text-danger"]}},{variant:"light",color:"default",class:{base:["data-[hover=true]:text-default-500","data-[selectable=true]:focus:text-default-500"]}},{variant:"light",color:"primary",class:{base:["data-[hover=true]:text-primary","data-[selectable=true]:focus:text-primary"]}},{variant:"light",color:"secondary",class:{base:["data-[hover=true]:text-secondary","data-[selectable=true]:focus:text-secondary"]}},{variant:"light",color:"success",class:{base:["data-[hover=true]:text-success","data-[selectable=true]:focus:text-success"]}},{variant:"light",color:"warning",class:{base:["data-[hover=true]:text-warning","data-[selectable=true]:focus:text-warning"]}},{variant:"light",color:"danger",class:{base:["data-[hover=true]:text-danger","data-[selectable=true]:focus:text-danger"]}}]}),Upe=eo({slots:{base:"relative mb-2",heading:"pl-1 text-tiny text-foreground-500",group:"data-[has-title=true]:pt-1",divider:"mt-2"}}),Bpe=eo({base:"shrink-0 bg-divider border-none",variants:{orientation:{horizontal:"w-full h-divider",vertical:"h-full w-divider"}},defaultVariants:{orientation:"horizontal"}}),$pe=eo({base:"flex flex-col gap-2 items-start"}),Wz=eo({base:["z-0","group","relative","inline-flex","items-center","justify-center","box-border","appearance-none","outline-solid outline-transparent","select-none","whitespace-nowrap","min-w-max","font-normal","subpixel-antialiased","overflow-hidden","tap-highlight-transparent","transform-gpu data-[pressed=true]:scale-[0.97]","cursor-pointer",...vu],variants:{variant:{solid:"",bordered:"border-medium bg-transparent",light:"bg-transparent",flat:"",faded:"border-medium",shadow:"",ghost:"border-medium bg-transparent"},size:{sm:"px-3 min-w-16 h-8 text-tiny gap-2 rounded-small",md:"px-4 min-w-20 h-10 text-small gap-2 rounded-medium",lg:"px-6 min-w-24 h-12 text-medium gap-3 rounded-large"},color:{default:"",primary:"",secondary:"",success:"",warning:"",danger:""},radius:{none:"rounded-none",sm:"rounded-small",md:"rounded-medium",lg:"rounded-large",full:"rounded-full"},fullWidth:{true:"w-full"},isDisabled:{true:"opacity-disabled pointer-events-none"},isInGroup:{true:"[&:not(:first-child):not(:last-child)]:rounded-none"},isIconOnly:{true:"px-0 !gap-0",false:"[&>svg]:max-w-[theme(spacing.8)]"},disableAnimation:{true:"!transition-none data-[pressed=true]:scale-100",false:"transition-transform-colors-opacity motion-reduce:transition-none"}},defaultVariants:{size:"md",variant:"solid",color:"default",fullWidth:!1,isDisabled:!1,isInGroup:!1},compoundVariants:[{variant:"solid",color:"default",class:It.solid.default},{variant:"solid",color:"primary",class:It.solid.primary},{variant:"solid",color:"secondary",class:It.solid.secondary},{variant:"solid",color:"success",class:It.solid.success},{variant:"solid",color:"warning",class:It.solid.warning},{variant:"solid",color:"danger",class:It.solid.danger},{variant:"shadow",color:"default",class:It.shadow.default},{variant:"shadow",color:"primary",class:It.shadow.primary},{variant:"shadow",color:"secondary",class:It.shadow.secondary},{variant:"shadow",color:"success",class:It.shadow.success},{variant:"shadow",color:"warning",class:It.shadow.warning},{variant:"shadow",color:"danger",class:It.shadow.danger},{variant:"bordered",color:"default",class:It.bordered.default},{variant:"bordered",color:"primary",class:It.bordered.primary},{variant:"bordered",color:"secondary",class:It.bordered.secondary},{variant:"bordered",color:"success",class:It.bordered.success},{variant:"bordered",color:"warning",class:It.bordered.warning},{variant:"bordered",color:"danger",class:It.bordered.danger},{variant:"flat",color:"default",class:It.flat.default},{variant:"flat",color:"primary",class:It.flat.primary},{variant:"flat",color:"secondary",class:It.flat.secondary},{variant:"flat",color:"success",class:It.flat.success},{variant:"flat",color:"warning",class:It.flat.warning},{variant:"flat",color:"danger",class:It.flat.danger},{variant:"faded",color:"default",class:It.faded.default},{variant:"faded",color:"primary",class:It.faded.primary},{variant:"faded",color:"secondary",class:It.faded.secondary},{variant:"faded",color:"success",class:It.faded.success},{variant:"faded",color:"warning",class:It.faded.warning},{variant:"faded",color:"danger",class:It.faded.danger},{variant:"light",color:"default",class:[It.light.default,"data-[hover=true]:bg-default/40"]},{variant:"light",color:"primary",class:[It.light.primary,"data-[hover=true]:bg-primary/20"]},{variant:"light",color:"secondary",class:[It.light.secondary,"data-[hover=true]:bg-secondary/20"]},{variant:"light",color:"success",class:[It.light.success,"data-[hover=true]:bg-success/20"]},{variant:"light",color:"warning",class:[It.light.warning,"data-[hover=true]:bg-warning/20"]},{variant:"light",color:"danger",class:[It.light.danger,"data-[hover=true]:bg-danger/20"]},{variant:"ghost",color:"default",class:[It.ghost.default,"data-[hover=true]:!bg-default"]},{variant:"ghost",color:"primary",class:[It.ghost.primary,"data-[hover=true]:!bg-primary data-[hover=true]:!text-primary-foreground"]},{variant:"ghost",color:"secondary",class:[It.ghost.secondary,"data-[hover=true]:!bg-secondary data-[hover=true]:!text-secondary-foreground"]},{variant:"ghost",color:"success",class:[It.ghost.success,"data-[hover=true]:!bg-success data-[hover=true]:!text-success-foreground"]},{variant:"ghost",color:"warning",class:[It.ghost.warning,"data-[hover=true]:!bg-warning data-[hover=true]:!text-warning-foreground"]},{variant:"ghost",color:"danger",class:[It.ghost.danger,"data-[hover=true]:!bg-danger data-[hover=true]:!text-danger-foreground"]},{isInGroup:!0,class:"rounded-none first:rounded-s-medium last:rounded-e-medium"},{isInGroup:!0,size:"sm",class:"rounded-none first:rounded-s-small last:rounded-e-small"},{isInGroup:!0,size:"md",class:"rounded-none first:rounded-s-medium last:rounded-e-medium"},{isInGroup:!0,size:"lg",class:"rounded-none first:rounded-s-large last:rounded-e-large"},{isInGroup:!0,isRounded:!0,class:"rounded-none first:rounded-s-full last:rounded-e-full"},{isInGroup:!0,radius:"none",class:"rounded-none first:rounded-s-none last:rounded-e-none"},{isInGroup:!0,radius:"sm",class:"rounded-none first:rounded-s-small last:rounded-e-small"},{isInGroup:!0,radius:"md",class:"rounded-none first:rounded-s-medium last:rounded-e-medium"},{isInGroup:!0,radius:"lg",class:"rounded-none first:rounded-s-large last:rounded-e-large"},{isInGroup:!0,radius:"full",class:"rounded-none first:rounded-s-full last:rounded-e-full"},{isInGroup:!0,variant:["ghost","bordered"],color:"default",className:Rp.default},{isInGroup:!0,variant:["ghost","bordered"],color:"primary",className:Rp.primary},{isInGroup:!0,variant:["ghost","bordered"],color:"secondary",className:Rp.secondary},{isInGroup:!0,variant:["ghost","bordered"],color:"success",className:Rp.success},{isInGroup:!0,variant:["ghost","bordered"],color:"warning",className:Rp.warning},{isInGroup:!0,variant:["ghost","bordered"],color:"danger",className:Rp.danger},{isIconOnly:!0,size:"sm",class:"min-w-8 w-8 h-8"},{isIconOnly:!0,size:"md",class:"min-w-10 w-10 h-10"},{isIconOnly:!0,size:"lg",class:"min-w-12 w-12 h-12"},{variant:["solid","faded","flat","bordered","shadow"],class:"data-[hover=true]:opacity-hover"}]});eo({base:"inline-flex items-center justify-center h-auto",variants:{fullWidth:{true:"w-full"}},defaultVariants:{fullWidth:!1}});var ZN=eo({slots:{base:["flex","flex-col","relative","overflow-hidden","h-auto","outline-solid outline-transparent","text-foreground","box-border","bg-content1",...vu],header:["flex","p-3","z-10","w-full","justify-start","items-center","shrink-0","overflow-inherit","color-inherit","subpixel-antialiased"],body:["relative","flex","flex-1","w-full","p-3","flex-auto","flex-col","place-content-inherit","align-items-inherit","h-auto","break-words","text-left","overflow-y-auto","subpixel-antialiased"],footer:["p-3","h-auto","flex","w-full","items-center","overflow-hidden","color-inherit","subpixel-antialiased"]},variants:{shadow:{none:{base:"shadow-none"},sm:{base:"shadow-small"},md:{base:"shadow-medium"},lg:{base:"shadow-large"}},radius:{none:{base:"rounded-none",header:"rounded-none",footer:"rounded-none"},sm:{base:"rounded-small",header:"rounded-t-small",footer:"rounded-b-small"},md:{base:"rounded-medium",header:"rounded-t-medium",footer:"rounded-b-medium"},lg:{base:"rounded-large",header:"rounded-t-large",footer:"rounded-b-large"}},fullWidth:{true:{base:"w-full"}},isHoverable:{true:{base:"data-[hover=true]:bg-content2 dark:data-[hover=true]:bg-content2"}},isPressable:{true:{base:"cursor-pointer"}},isBlurred:{true:{base:["bg-background/80","dark:bg-background/20","backdrop-blur-md","backdrop-saturate-150"]}},isFooterBlurred:{true:{footer:["bg-background/10","backdrop-blur","backdrop-saturate-150"]}},isDisabled:{true:{base:"opacity-disabled cursor-not-allowed"}},disableAnimation:{true:"",false:{base:"transition-transform-background motion-reduce:transition-none"}}},compoundVariants:[{isPressable:!0,class:"data-[pressed=true]:scale-[0.97] tap-highlight-transparent"}],defaultVariants:{radius:"lg",shadow:"md",fullWidth:!1,isHoverable:!1,isPressable:!1,isDisabled:!1,isFooterBlurred:!1}}),QN=eo({slots:{base:["relative","max-w-fit","min-w-min","inline-flex","items-center","justify-between","box-border","whitespace-nowrap"],content:"flex-1 text-inherit font-normal",dot:["w-2","h-2","ml-1","rounded-full"],avatar:"shrink-0",closeButton:["z-10","appearance-none","outline-solid outline-transparent","select-none","transition-opacity","opacity-70","hover:opacity-100","cursor-pointer","active:opacity-disabled","tap-highlight-transparent"]},variants:{variant:{solid:{},bordered:{base:"border-medium bg-transparent"},light:{base:"bg-transparent"},flat:{},faded:{base:"border-medium"},shadow:{},dot:{base:"border-medium border-default text-foreground bg-transparent"}},color:{default:{dot:"bg-default-400"},primary:{dot:"bg-primary"},secondary:{dot:"bg-secondary"},success:{dot:"bg-success"},warning:{dot:"bg-warning"},danger:{dot:"bg-danger"}},size:{sm:{base:"px-1 h-6 text-tiny",content:"px-1",closeButton:"text-medium",avatar:"w-4 h-4"},md:{base:"px-1 h-7 text-small",content:"px-2",closeButton:"text-large",avatar:"w-5 h-5"},lg:{base:"px-2 h-8 text-medium",content:"px-2",closeButton:"text-xl",avatar:"w-6 h-6"}},radius:{none:{base:"rounded-none"},sm:{base:"rounded-small"},md:{base:"rounded-medium"},lg:{base:"rounded-large"},full:{base:"rounded-full"}},isOneChar:{true:{},false:{}},isCloseable:{true:{},false:{}},hasStartContent:{true:{}},hasEndContent:{true:{}},isDisabled:{true:{base:"opacity-disabled pointer-events-none"}},isCloseButtonFocusVisible:{true:{closeButton:[...Npe,"ring-1","rounded-full"]}}},defaultVariants:{variant:"solid",color:"default",size:"md",radius:"full",isDisabled:!1},compoundVariants:[{variant:"solid",color:"default",class:{base:It.solid.default}},{variant:"solid",color:"primary",class:{base:It.solid.primary}},{variant:"solid",color:"secondary",class:{base:It.solid.secondary}},{variant:"solid",color:"success",class:{base:It.solid.success}},{variant:"solid",color:"warning",class:{base:It.solid.warning}},{variant:"solid",color:"danger",class:{base:It.solid.danger}},{variant:"shadow",color:"default",class:{base:It.shadow.default}},{variant:"shadow",color:"primary",class:{base:It.shadow.primary}},{variant:"shadow",color:"secondary",class:{base:It.shadow.secondary}},{variant:"shadow",color:"success",class:{base:It.shadow.success}},{variant:"shadow",color:"warning",class:{base:It.shadow.warning}},{variant:"shadow",color:"danger",class:{base:It.shadow.danger}},{variant:"bordered",color:"default",class:{base:It.bordered.default}},{variant:"bordered",color:"primary",class:{base:It.bordered.primary}},{variant:"bordered",color:"secondary",class:{base:It.bordered.secondary}},{variant:"bordered",color:"success",class:{base:It.bordered.success}},{variant:"bordered",color:"warning",class:{base:It.bordered.warning}},{variant:"bordered",color:"danger",class:{base:It.bordered.danger}},{variant:"flat",color:"default",class:{base:It.flat.default}},{variant:"flat",color:"primary",class:{base:It.flat.primary}},{variant:"flat",color:"secondary",class:{base:It.flat.secondary}},{variant:"flat",color:"success",class:{base:It.flat.success}},{variant:"flat",color:"warning",class:{base:It.flat.warning}},{variant:"flat",color:"danger",class:{base:It.flat.danger}},{variant:"faded",color:"default",class:{base:It.faded.default}},{variant:"faded",color:"primary",class:{base:It.faded.primary}},{variant:"faded",color:"secondary",class:{base:It.faded.secondary}},{variant:"faded",color:"success",class:{base:It.faded.success}},{variant:"faded",color:"warning",class:{base:It.faded.warning}},{variant:"faded",color:"danger",class:{base:It.faded.danger}},{variant:"light",color:"default",class:{base:It.light.default}},{variant:"light",color:"primary",class:{base:It.light.primary}},{variant:"light",color:"secondary",class:{base:It.light.secondary}},{variant:"light",color:"success",class:{base:It.light.success}},{variant:"light",color:"warning",class:{base:It.light.warning}},{variant:"light",color:"danger",class:{base:It.light.danger}},{isOneChar:!0,hasStartContent:!1,hasEndContent:!1,size:"sm",class:{base:"w-5 h-5 min-w-5 min-h-5"}},{isOneChar:!0,hasStartContent:!1,hasEndContent:!1,size:"md",class:{base:"w-6 h-6 min-w-6 min-h-6"}},{isOneChar:!0,hasStartContent:!1,hasEndContent:!1,size:"lg",class:{base:"w-7 h-7 min-w-7 min-h-7"}},{isOneChar:!0,isCloseable:!1,hasStartContent:!1,hasEndContent:!1,class:{base:"px-0 justify-center",content:"px-0 flex-none"}},{isOneChar:!0,isCloseable:!0,hasStartContent:!1,hasEndContent:!1,class:{base:"w-auto"}},{isOneChar:!0,variant:"dot",class:{base:"w-auto h-7 px-1 items-center",content:"px-2"}},{hasStartContent:!0,size:"sm",class:{content:"pl-0.5"}},{hasStartContent:!0,size:["md","lg"],class:{content:"pl-1"}},{hasEndContent:!0,size:"sm",class:{content:"pr-0.5"}},{hasEndContent:!0,size:["md","lg"],class:{content:"pr-1"}}]}),Hz={};Hz={close:"إغلاق",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} إشعار`,other:()=>`${e.number(t.count)} إشعارات`})}.`};var Kz={};Kz={close:"Затвори",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} известие`,other:()=>`${e.number(t.count)} известия`})}.`};var qz={};qz={close:"Zavřít",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} oznámení`,other:()=>`${e.number(t.count)} oznámení`})}.`};var Xz={};Xz={close:"Luk",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} besked`,other:()=>`${e.number(t.count)} beskeder`})}.`};var Yz={};Yz={close:"Schließen",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} Benachrichtigung`,other:()=>`${e.number(t.count)} Benachrichtigungen`})}.`};var Jz={};Jz={close:"Κλείσιμο",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} ειδοποίηση`,other:()=>`${e.number(t.count)} ειδοποιήσεις`})}.`};var Zz={};Zz={close:"Close",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} notification`,other:()=>`${e.number(t.count)} notifications`})}.`};var Qz={};Qz={close:"Cerrar",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} notificación`,other:()=>`${e.number(t.count)} notificaciones`})}.`};var eW={};eW={close:"Sule",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} teatis`,other:()=>`${e.number(t.count)} teatist`})}.`};var tW={};tW={close:"Sulje",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} ilmoitus`,other:()=>`${e.number(t.count)} ilmoitusta`})}.`};var nW={};nW={close:"Fermer",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} notification`,other:()=>`${e.number(t.count)} notifications`})}.`};var rW={};rW={close:"סגור",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} התראה`,other:()=>`${e.number(t.count)} התראות`})}.`};var iW={};iW={close:"Zatvori",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} obavijest`,other:()=>`${e.number(t.count)} obavijesti`})}.`};var aW={};aW={close:"Bezárás",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} értesítés`,other:()=>`${e.number(t.count)} értesítés`})}.`};var oW={};oW={close:"Chiudi",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} notifica`,other:()=>`${e.number(t.count)} notifiche`})}.`};var sW={};sW={close:"閉じる",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} 個の通知`,other:()=>`${e.number(t.count)} 個の通知`})}。`};var lW={};lW={close:"닫기",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)}개 알림`,other:()=>`${e.number(t.count)}개 알림`})}.`};var cW={};cW={close:"Uždaryti",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} pranešimas`,other:()=>`${e.number(t.count)} pranešimai`})}.`};var uW={};uW={close:"Aizvērt",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} paziņojums`,other:()=>`${e.number(t.count)} paziņojumi`})}.`};var fW={};fW={close:"Lukk",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} varsling`,other:()=>`${e.number(t.count)} varsler`})}.`};var dW={};dW={close:"Sluiten",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} melding`,other:()=>`${e.number(t.count)} meldingen`})}.`};var hW={};hW={close:"Zamknij",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} powiadomienie`,few:()=>`${e.number(t.count)} powiadomienia`,many:()=>`${e.number(t.count)} powiadomień`,other:()=>`${e.number(t.count)} powiadomienia`})}.`};var pW={};pW={close:"Fechar",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} notificação`,other:()=>`${e.number(t.count)} notificações`})}.`};var gW={};gW={close:"Fechar",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} notificação`,other:()=>`${e.number(t.count)} notificações`})}.`};var mW={};mW={close:"Închideţi",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} notificare`,other:()=>`${e.number(t.count)} notificări`})}.`};var vW={};vW={close:"Закрыть",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} уведомление`,other:()=>`${e.number(t.count)} уведомления`})}.`};var yW={};yW={close:"Zatvoriť",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} oznámenie`,few:()=>`${e.number(t.count)} oznámenia`,other:()=>`${e.number(t.count)} oznámení`})}.`};var xW={};xW={close:"Zapri",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} obvestilo`,two:()=>`${e.number(t.count)} obvestili`,few:()=>`${e.number(t.count)} obvestila`,other:()=>`${e.number(t.count)} obvestil`})}.`};var bW={};bW={close:"Zatvori",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} obaveštenje`,other:()=>`${e.number(t.count)} obaveštenja`})}.`};var wW={};wW={close:"Stäng",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} meddelande`,other:()=>`${e.number(t.count)} meddelanden`})}.`};var CW={};CW={close:"Kapat",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} bildirim`,other:()=>`${e.number(t.count)} bildirim`})}.`};var SW={};SW={close:"Закрити",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} сповіщення`,other:()=>`${e.number(t.count)} сповіщення`})}.`};var TW={};TW={close:"关闭",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} 个通知`,other:()=>`${e.number(t.count)} 个通知`})}。`};var EW={};EW={close:"關閉",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} 個通知`,other:()=>`${e.number(t.count)} 個通知`})}。`};var wD={};wD={"ar-AE":Hz,"bg-BG":Kz,"cs-CZ":qz,"da-DK":Xz,"de-DE":Yz,"el-GR":Jz,"en-US":Zz,"es-ES":Qz,"et-EE":eW,"fi-FI":tW,"fr-FR":nW,"he-IL":rW,"hr-HR":iW,"hu-HU":aW,"it-IT":oW,"ja-JP":sW,"ko-KR":lW,"lt-LT":cW,"lv-LV":uW,"nb-NO":fW,"nl-NL":dW,"pl-PL":hW,"pt-BR":pW,"pt-PT":gW,"ro-RO":mW,"ru-RU":vW,"sk-SK":yW,"sl-SI":xW,"sr-SP":bW,"sv-SE":wW,"tr-TR":CW,"uk-UA":SW,"zh-CN":TW,"zh-TW":EW};function Gpe(t){return t&&t.__esModule?t.default:t}function jpe(t,e,n){let{key:r,timer:i,timeout:a}=t.toast;H.useEffect(()=>{if(!(i==null||a==null))return i.reset(a),()=>{i.pause()}},[i,a]);let o=rl(),s=sm(),l=mC(Gpe(wD),"@react-aria/toast"),[c,f]=H.useState(!1);return H.useEffect(()=>{f(!0)},[]),{toastProps:{..._m(t,{labelable:!0}),role:"alertdialog","aria-modal":"false","aria-labelledby":t["aria-labelledby"]||o,"aria-describedby":t["aria-describedby"]||s,tabIndex:0},contentProps:{role:"alert","aria-atomic":"true","aria-hidden":c?void 0:"true"},titleProps:{id:o},descriptionProps:{id:s},closeButtonProps:{"aria-label":l.format("close"),onPress:()=>e.close(r)}}}var eE={exports:{}},tE={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var eL;function zpe(){if(eL)return tE;eL=1;var t=J3();function e(u,d){return u===d&&(u!==0||1/u===1/d)||u!==u&&d!==d}var n=typeof Object.is=="function"?Object.is:e,r=t.useState,i=t.useEffect,a=t.useLayoutEffect,o=t.useDebugValue;function s(u,d){var h=d(),p=r({inst:{value:h,getSnapshot:d}}),g=p[0].inst,m=p[1];return a(function(){g.value=h,g.getSnapshot=d,l(g)&&m({inst:g})},[u,h,d]),i(function(){return l(g)&&m({inst:g}),u(function(){l(g)&&m({inst:g})})},[u]),o(h),h}function l(u){var d=u.getSnapshot;u=u.value;try{var h=d();return!n(u,h)}catch{return!0}}function c(u,d){return d()}var f=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?c:s;return tE.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:f,tE}var tL;function Wpe(){return tL||(tL=1,eE.exports=zpe()),eE.exports}var _W=Wpe();const DW=1,nE=Symbol.for("react-aria-landmark-manager");function Hpe(t){return document.addEventListener("react-aria-landmark-manager-change",t),()=>document.removeEventListener("react-aria-landmark-manager-change",t)}function nL(){if(typeof document>"u")return null;let t=document[nE];return t&&t.version>=DW?t:(document[nE]=new qpe,document.dispatchEvent(new CustomEvent("react-aria-landmark-manager-change")),document[nE])}function Kpe(){return _W.useSyncExternalStore(Hpe,nL,nL)}class qpe{setupIfNeeded(){this.isListening||(document.addEventListener("keydown",this.f6Handler,{capture:!0}),document.addEventListener("focusin",this.focusinHandler,{capture:!0}),document.addEventListener("focusout",this.focusoutHandler,{capture:!0}),this.isListening=!0)}teardownIfNeeded(){!this.isListening||this.landmarks.length>0||this.refCount>0||(document.removeEventListener("keydown",this.f6Handler,{capture:!0}),document.removeEventListener("focusin",this.focusinHandler,{capture:!0}),document.removeEventListener("focusout",this.focusoutHandler,{capture:!0}),this.isListening=!1)}focusLandmark(e,n){var r,i;(i=this.landmarks.find(a=>a.ref.current===e))===null||i===void 0||(r=i.focus)===null||r===void 0||r.call(i,n)}getLandmarksByRole(e){return new Set(this.landmarks.filter(n=>n.role===e))}getLandmarkByRole(e){return this.landmarks.find(n=>n.role===e)}addLandmark(e){if(this.setupIfNeeded(),this.landmarks.find(i=>i.ref===e.ref)||!e.ref.current)return;if(this.landmarks.filter(i=>i.role==="main").length>1,this.landmarks.length===0){this.landmarks=[e],this.checkLabels(e.role);return}let n=0,r=this.landmarks.length-1;for(;n<=r;){let i=Math.floor((n+r)/2),a=e.ref.current.compareDocumentPosition(this.landmarks[i].ref.current);!!(a&Node.DOCUMENT_POSITION_PRECEDING||a&Node.DOCUMENT_POSITION_CONTAINS)?n=i+1:r=i-1}this.landmarks.splice(n,0,e),this.checkLabels(e.role)}updateLandmark(e){let n=this.landmarks.findIndex(r=>r.ref===e.ref);n>=0&&(this.landmarks[n]={...this.landmarks[n],...e},this.checkLabels(this.landmarks[n].role))}removeLandmark(e){this.landmarks=this.landmarks.filter(n=>n.ref!==e),this.teardownIfNeeded()}checkLabels(e){let n=this.getLandmarksByRole(e);n.size>1&&[...n].filter(r=>!r.label)}closestLandmark(e){let n=new Map(this.landmarks.map(i=>[i.ref.current,i])),r=e;for(;r&&!n.has(r)&&r!==document.body&&r.parentElement;)r=r.parentElement;return n.get(r)}getNextLandmark(e,{backward:n}){var r;let i=this.closestLandmark(e),a=n?this.landmarks.length-1:0;i&&(a=this.landmarks.indexOf(i)+(n?-1:1));let o=()=>{if(a<0){if(!e.dispatchEvent(new CustomEvent("react-aria-landmark-navigation",{detail:{direction:"backward"},bubbles:!0,cancelable:!0})))return!0;a=this.landmarks.length-1}else if(a>=this.landmarks.length){if(!e.dispatchEvent(new CustomEvent("react-aria-landmark-navigation",{detail:{direction:"forward"},bubbles:!0,cancelable:!0})))return!0;a=0}return a<0||a>=this.landmarks.length};if(o())return;let s=a;for(;!((r=this.landmarks[a].ref.current)===null||r===void 0)&&r.closest("[aria-hidden=true]");){if(a+=n?-1:1,o())return;if(a===s)break}return this.landmarks[a]}f6Handler(e){e.key==="F6"&&(e.altKey?this.focusMain():this.navigate(e.target,e.shiftKey))&&(e.preventDefault(),e.stopPropagation())}focusMain(){let e=this.getLandmarkByRole("main");return e&&e.ref.current&&document.contains(e.ref.current)?(this.focusLandmark(e.ref.current,"forward"),!0):!1}navigate(e,n){let r=this.getNextLandmark(e,{backward:n});if(!r)return!1;if(r.lastFocused){let i=r.lastFocused;if(document.body.contains(i))return i.focus(),!0}return r.ref.current&&document.contains(r.ref.current)?(this.focusLandmark(r.ref.current,n?"backward":"forward"),!0):!1}focusinHandler(e){let n=this.closestLandmark(e.target);n&&n.ref.current!==e.target&&this.updateLandmark({ref:n.ref,lastFocused:e.target});let r=e.relatedTarget;if(r){let i=this.closestLandmark(r);i&&i.ref.current===r&&i.blur()}}focusoutHandler(e){let n=e.target,r=e.relatedTarget;if(!r||r===document){let i=this.closestLandmark(n);i&&i.ref.current===n&&i.blur()}}createLandmarkController(){let e=this;return e.refCount++,e.setupIfNeeded(),{navigate(n,r){let i=r?.from||document.activeElement;return e.navigate(i,n==="backward")},focusNext(n){let r=n?.from||document.activeElement;return e.navigate(r,!1)},focusPrevious(n){let r=n?.from||document.activeElement;return e.navigate(r,!0)},focusMain(){return e.focusMain()},dispose(){e&&(e.refCount--,e.teardownIfNeeded(),e=null)}}}registerLandmark(e){return this.landmarks.find(n=>n.ref===e.ref)?this.updateLandmark(e):this.addLandmark(e),()=>this.removeLandmark(e.ref)}constructor(){this.landmarks=[],this.isListening=!1,this.refCount=0,this.version=DW,this.f6Handler=this.f6Handler.bind(this),this.focusinHandler=this.focusinHandler.bind(this),this.focusoutHandler=this.focusoutHandler.bind(this)}}function Xpe(t,e){const{role:n,"aria-label":r,"aria-labelledby":i,focus:a}=t;let o=Kpe(),s=r||i,[l,c]=H.useState(!1),f=H.useCallback(()=>{c(!0)},[c]),u=H.useCallback(()=>{c(!1)},[c]);return Nr(()=>{if(o)return o.registerLandmark({ref:e,label:s,role:n,focus:a||f,blur:u})},[o,s,e,n,a,f,u]),H.useEffect(()=>{var d;l&&((d=e.current)===null||d===void 0||d.focus())},[l,e]),{landmarkProps:{role:n,tabIndex:l?-1:void 0,"aria-label":r,"aria-labelledby":i}}}function Ype(t){return t&&t.__esModule?t.default:t}function Jpe(t,e,n){let r=mC(Ype(wD),"@react-aria/toast"),{landmarkProps:i}=Xpe({role:"region","aria-label":t["aria-label"]||r.format("notifications",{count:e.visibleToasts.length})},n),a=H.useRef(!1),o=H.useRef(!1),s=Sr(()=>{a.current||o.current?e.pauseAll():e.resumeAll()}),{hoverProps:l}=il({onHoverStart:()=>{a.current=!0,s()},onHoverEnd:()=>{a.current=!1,s()}}),c=H.useRef([]),f=H.useRef(e.visibleToasts),u=H.useRef(null);Nr(()=>{if(u.current===-1||e.visibleToasts.length===0||!n.current){c.current=[],f.current=e.visibleToasts;return}if(c.current=[...n.current.querySelectorAll('[role="alertdialog"]')],f.current.length===e.visibleToasts.length&&e.visibleToasts.every((y,v)=>y.key===f.current[v].key)){f.current=e.visibleToasts;return}let p=f.current.map((y,v)=>({...y,i:v,isRemoved:!e.visibleToasts.some(x=>y.key===x.key)})),g=p.findIndex(y=>y.i===u.current&&y.isRemoved);if(g>-1){var m;if(Zv()==="pointer"&&(!((m=d.current)===null||m===void 0)&&m.isConnected))Xi(d.current);else{let y=0,v,x;for(;y<=g;)p[y].isRemoved||(x=Math.max(0,y-1)),y++;for(;y<p.length;){if(!p[y].isRemoved){v=y-1;break}y++}x===void 0&&v===void 0&&(x=0),x>=0&&x<c.current.length?Xi(c.current[x]):v>=0&&v<c.current.length&&Xi(c.current[v])}}f.current=e.visibleToasts},[e.visibleToasts,n,s]);let d=H.useRef(null),{focusWithinProps:h}=Am({onFocusWithin:p=>{o.current=!0,d.current=p.relatedTarget,s()},onBlurWithin:()=>{o.current=!1,d.current=null,s()}});return H.useEffect(()=>{var p;e.visibleToasts.length===0&&(!((p=d.current)===null||p===void 0)&&p.isConnected)&&(Zv()==="pointer"?Xi(d.current):d.current.focus(),d.current=null)},[n,e.visibleToasts.length]),H.useEffect(()=>()=>{var p;!((p=d.current)===null||p===void 0)&&p.isConnected&&(Zv()==="pointer"?Xi(d.current):d.current.focus(),d.current=null)},[n]),{regionProps:Ji(i,l,h,{tabIndex:-1,"data-react-aria-top-layer":!0,onFocus:p=>{let g=p.target.closest('[role="alertdialog"]');u.current=c.current.findIndex(m=>m===g)},onBlur:()=>{u.current=-1}})}}var Zpe=700;function OW(){return py()||typeof window>"u"?!1:window.screen.width<=Zpe}var rE=100,iE=20;function Qpe(t){var e,n;const[r,i]=Gl(t,HN.variantKeys),{ref:a,as:o,title:s,description:l,className:c,classNames:f,toast:u,endContent:d,closeIcon:h,hideIcon:p=!1,placement:g="bottom-right",isRegionExpanded:m,hideCloseButton:y=!1,state:v,total:x=1,index:w=0,heights:S,promise:T,setHeights:_,toastOffset:D=0,motionProps:I,timeout:R=6e3,shouldShowTimeoutProgress:O=!1,icon:P,onClose:N,severity:A,maxVisibleToasts:B,loadingComponent:V,...$}=r,{isHovered:U,hoverProps:G}=il({isDisabled:!1}),F=as(),J=(n=(e=t?.disableAnimation)!=null?e:F?.disableAnimation)!=null?n:!1,Q=OW();let ne=g;Q&&(g.includes("top")?ne="top-center":ne="bottom-center");const ye=H.useRef(null),ve=H.useRef(null),Ce=H.useRef(0),we=H.useRef(null),Ae=H.useRef(0),Me=H.useRef(0);H.useEffect(()=>{we.current&&(we.current.style.width="0%")},[]);const[q,k]=H.useState(!!T),[Y,X]=H.useState(!1);H.useEffect(()=>{T&&T.finally(()=>{k(!1)})},[T]),H.useEffect(()=>{const Rt=Ft=>{if(!R||q)return;if(ve.current===null&&(ve.current=Ft),U||m){Ae.current+=Ft-ve.current,ve.current=null,ye.current=requestAnimationFrame(Rt);return}const Dn=Ft-ve.current+Ae.current;Me.current=Dn,Me.current>=R&&X(!0),Ce.current=Math.min(Dn/R*100,100),we.current&&(we.current.style.width=`${O?Ce.current:0}%`),Ce.current<100&&(ye.current=requestAnimationFrame(Rt))};return ye.current=requestAnimationFrame(Rt),()=>{ye.current!==null&&cancelAnimationFrame(ye.current)}},[R,O,v,U,w,x,m,q,X]);const re=o||"div",de=Ai(a),he=sn(c,f?.base),{toastProps:Ee,contentProps:Oe,titleProps:Pe,descriptionProps:Ne}=jpe(r,v),[ie,ae]=H.useState(!1);H.useEffect(()=>{ae(!0)},[]);const[Te,me]=H.useState(0);H.useLayoutEffect(()=>{if(!de.current||!ie||Y)return;const Rt=de.current,Ft=Rt.style.height;Rt.style.height="auto";const Dn=getComputedStyle(Rt),Bt=parseFloat(Dn.marginTop),qt=parseFloat(Dn.marginBottom),kt=Rt.getBoundingClientRect().height+Bt+qt;Rt.style.height=Ft,me(wr=>wr!==kt?kt:wr);const Zt=[...S];Zt.length>w?Zt[w]=kt:Zt.push(kt),_(Zt)},[ie,x,_,w,Y]);let Se=4;for(let Rt=w+1;Rt<x;Rt++)Se+=S[Rt];const Ve=S[S.length-1],ue=H.useMemo(()=>HN({...i,disableAnimation:J}),[$l(i)]),ut=ne.includes("top")?1:-1,ht={hidden:{opacity:0,y:-50*ut},visible:{opacity:1,y:0},exit:{opacity:0,y:-50*ut}},[Ot,Fe]=H.useState(!1),[Qe,st]=H.useState(0),ot=(Rt,Ft)=>{const Dn=ne.includes("right"),Bt=ne.includes("left"),qt=ne==="top-center",kt=ne==="bottom-center";if(Dn&&Rt>=rE||Bt&&Rt<=-rE||qt&&Ft<=-iE||kt&&Ft>=iE)return!0},Mt=Rt=>{const Ft={top:0,bottom:0,right:0,left:0};return Rt==="bottom-center"?(Ft.bottom=1,Ft):Rt==="top-center"?(Ft.top=1,Ft):Rt.includes("right")?(Ft.right=1,Ft):Rt.includes("left")?(Ft.left=1,Ft):(Ft.left=1,Ft.right=1,Ft)};let Ue;Ot&&ne==="bottom-center"||ne==="top-center"?Ue=Math.max(0,1-Qe/(iE+5)):Ot&&(Ue=Math.max(0,1-Qe/(rE+20)));const He=H.useCallback((Rt={})=>{const Bt={"--top-extension":"16px","--bottom-extension":"16px"};return{ref:de,className:ue.base({class:sn(he,f?.base)}),"data-has-title":Lt(!Cw(s)),"data-has-description":Lt(!Cw(l)),"data-placement":ne,"data-drag-value":Qe,"data-toast":!0,"aria-label":"toast","data-toast-exiting":Lt(Y),onTransitionEnd:()=>{if(Y){const qt=S;qt.splice(w,1),_([...qt]),v.close(u.key)}},style:{opacity:Ue,...Bt},...Nn(Rt,$,Ee,G)}},[ue,f,Ee,G,u,u.key,Ue,Y,v,u.key]),Ct=H.useCallback((Rt={})=>({className:ue.wrapper({class:f?.wrapper}),...Rt}),[]),$t=H.useCallback((Rt={})=>({"aria-label":"descriptionIcon",className:ue.icon({class:f?.icon}),...Rt}),[]),bn=H.useCallback((Rt={})=>({className:ue.loadingComponent({class:f?.loadingComponent}),"aria-label":"loadingIcon",color:"current",...Rt}),[]),Tn=H.useCallback((Rt={})=>({classNames:{wrapper:ue.loadingComponent({class:f?.loadingComponent})},"aria-label":"loadingIcon",color:"current",...Rt}),[]),en=H.useCallback((Rt={})=>({className:ue.content({class:f?.content}),...Nn(Rt,$,Oe)}),[Oe]),Pn=H.useCallback((Rt={})=>({className:ue.title({class:f?.title}),...Nn(Rt,$,Pe)}),[Pe]),mi=H.useCallback((Rt={})=>({className:ue.description({class:f?.description}),...Nn(Rt,$,Ne)}),[Ne]),hr=H.useCallback((Rt={})=>({className:ue.closeButton({class:f?.closeButton}),"aria-label":"closeButton","data-hidden":Lt(y),...Nn(Rt,{onPress:Nf(()=>{X(!0),setTimeout(()=>document.body.focus(),0)},N)})}),[X,N,v,u]),Ke=H.useCallback((Rt={})=>({className:ue.closeIcon({class:f?.closeIcon}),"aria-label":"closeIcon",...Rt}),[]),Et=H.useCallback((Rt={})=>{const Ft=m?B-1:Math.min(2,B-1),Dn=x-w-1<=Ft,Bt=ne==="bottom-center"||ne==="top-center"?"y":"x",qt={left:0,right:0,top:0,bottom:0},kt=Mt(ne),Zt=ne.includes("top")?{top:m||Ot?Se+D:(x-1-w)*8+D,bottom:"auto"}:ne.includes("bottom")?{bottom:m||Ot?Se+D:(x-1-w)*8+D,top:"auto"}:{};return{animate:{opacity:Dn?1:0,pointerEvents:Dn?"all":"none",scaleX:m||Ot?1:1-(x-1-w)*.1,height:m||Ot?Te:Ve,y:0,...Zt},drag:Bt,dragConstraints:qt,exit:{opacity:0},initial:{opacity:0,scale:1,y:-40*ut},transition:{duration:.3,ease:"easeOut"},variants:ht,dragElastic:kt,onDragEnd:(wr,$r)=>{const{x:oi,y:Li}=$r.offset;if(Fe(!1),ot(oi,Li)){const vi=S;vi.splice(w,1),_([...vi]),v.close(u.key);return}st(0)},onDrag:(wr,$r)=>{let oi=0;ne==="top-center"?oi=-$r.offset.y:ne==="bottom-center"?oi=$r.offset.y:ne.includes("right")?oi=$r.offset.x:ne.includes("left")&&(oi=-$r.offset.x),oi>=0&&st(oi)},onDragStart:()=>{Fe(!0)},"data-drag":Lt(Ot),"data-placement":ne,"data-drag-value":Qe,className:ue.motionDiv({class:f?.motionDiv}),...Rt,...I}},[x,w,ne,m,Y,Se,ut,Te,Ve,ht,f,Ot,Lt,Fe,ot,ue,D,B]);return{Component:re,title:s,description:l,icon:P,loadingComponent:V,domRef:de,severity:A,closeIcon:h,classNames:f,color:i.color,hideIcon:p,placement:ne,state:v,toast:u,disableAnimation:J,isProgressBarVisible:!!R,total:x,index:w,getWrapperProps:Ct,getToastProps:He,getTitleProps:Pn,getContentProps:en,getDescriptionProps:mi,getCloseButtonProps:hr,getIconProps:$t,getMotionDivProps:Et,getCloseIconProps:Ke,getLoadingComponentProps:bn,getSpinnerComponentProps:Tn,progressBarRef:we,endContent:d,slots:ue,isRegionExpanded:m,liftHeight:Se,frontHeight:Ve,initialHeight:Te,isLoading:q}}function ege(t){var e,n;const[r,i]=Gl(t,zN.variantKeys),a=as(),o=(n=(e=t?.variant)!=null?e:a?.spinnerVariant)!=null?n:"default",{children:s,className:l,classNames:c,label:f,...u}=r,d=H.useMemo(()=>zN({...i}),[$l(i)]),h=sn(c?.base,l),p=f||s,g=H.useMemo(()=>p&&typeof p=="string"?p:u["aria-label"]?"":"Loading",[s,p,u["aria-label"]]),m=H.useCallback(()=>({"aria-label":g,className:d.base({class:h}),...u}),[g,d,h,u]);return{label:p,slots:d,classNames:c,variant:o,getSpinnerProps:m}}var MW=Qi((t,e)=>{const{slots:n,classNames:r,label:i,variant:a,getSpinnerProps:o}=ege({...t});return a==="wave"||a==="dots"?j.jsxs("div",{ref:e,...o(),children:[j.jsx("div",{className:n.wrapper({class:r?.wrapper}),children:[...new Array(3)].map((s,l)=>j.jsx("i",{className:n.dots({class:r?.dots}),style:{"--dot-index":l}},`dot-${l}`))}),i&&j.jsx("span",{className:n.label({class:r?.label}),children:i})]}):a==="simple"?j.jsxs("div",{ref:e,...o(),children:[j.jsxs("svg",{className:n.wrapper({class:r?.wrapper}),fill:"none",viewBox:"0 0 24 24",children:[j.jsx("circle",{className:n.circle1({class:r?.circle1}),cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),j.jsx("path",{className:n.circle2({class:r?.circle2}),d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",fill:"currentColor"})]}),i&&j.jsx("span",{className:n.label({class:r?.label}),children:i})]}):a==="spinner"?j.jsxs("div",{ref:e,...o(),children:[j.jsx("div",{className:n.wrapper({class:r?.wrapper}),children:[...new Array(12)].map((s,l)=>j.jsx("i",{className:n.spinnerBars({class:r?.spinnerBars}),style:{"--bar-index":l}},`star-${l}`))}),i&&j.jsx("span",{className:n.label({class:r?.label}),children:i})]}):j.jsxs("div",{ref:e,...o(),children:[j.jsxs("div",{className:n.wrapper({class:r?.wrapper}),children:[j.jsx("i",{className:n.circle1({class:r?.circle1})}),j.jsx("i",{className:n.circle2({class:r?.circle2})})]}),i&&j.jsx("span",{className:n.label({class:r?.label}),children:i})]})});MW.displayName="HeroUI.Spinner";var bC=MW,tge=t=>j.jsx("svg",{fill:"none",height:"24",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg",...t,children:j.jsx("path",{d:`
          M12 2C6.49 2 2 6.49 2 12C2 17.51 6.49 22 12 22C17.51 22 22 17.51 22 12C22 6.49 17.51 2 12 2Z
          M16.78 9.7L11.11 15.37C10.97 15.51 10.78 15.59 10.58 15.59C10.38 15.59 10.19 15.51 10.05 15.37L7.22 12.54
          C6.93 12.25 6.93 11.77 7.22 11.48C7.51 11.19 7.99 11.19 8.28 11.48L10.58 13.78L15.72 8.64
          C16.01 8.35 16.49 8.35 16.78 8.64C17.07 8.93 17.07 9.4 16.78 9.7Z
        `})}),nge=t=>j.jsx("svg",{className:"fill-current",fill:"none",height:"24",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg",...t,children:j.jsx("path",{clipRule:"evenodd",d:"M3 10.417C3 7.219 3 5.62 3.378 5.082C3.755 4.545 5.258 4.03 8.265 3.001L8.838 2.805C10.405 2.268 11.188 2 12 2C12.812 2 13.595 2.268 15.162 2.805L15.735 3.001C18.742 4.03 20.245 4.545 20.622 5.082C21 5.62 21 7.22 21 10.417V11.991C21 17.629 16.761 20.366 14.101 21.527C13.38 21.842 13.02 22 12 22C10.98 22 10.62 21.842 9.899 21.527C7.239 20.365 3 17.63 3 11.991V10.417ZM12 7.25C12.1989 7.25 12.3897 7.32902 12.5303 7.46967C12.671 7.61032 12.75 7.80109 12.75 8V12C12.75 12.1989 12.671 12.3897 12.5303 12.5303C12.3897 12.671 12.1989 12.75 12 12.75C11.8011 12.75 11.6103 12.671 11.4697 12.5303C11.329 12.3897 11.25 12.1989 11.25 12V8C11.25 7.80109 11.329 7.61032 11.4697 7.46967C11.6103 7.32902 11.8011 7.25 12 7.25ZM12 16C12.2652 16 12.5196 15.8946 12.7071 15.7071C12.8946 15.5196 13 15.2652 13 15C13 14.7348 12.8946 14.4804 12.7071 14.2929C12.5196 14.1054 12.2652 14 12 14C11.7348 14 11.4804 14.1054 11.2929 14.2929C11.1054 14.4804 11 14.7348 11 15C11 15.2652 11.1054 15.5196 11.2929 15.7071C11.4804 15.8946 11.7348 16 12 16Z",fill:"currentColor",fillRule:"evenodd"})}),aE=t=>j.jsx("svg",{fill:"none",height:"24",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg",...t,children:j.jsx("path",{d:"M12 22C17.51 22 22 17.51 22 12C22 6.49 17.51 2 12 2C6.49 2 2 6.49 2 12C2 17.51 6.49 22 12 22ZM12.75 16C12.75 16.41 12.41 16.75 12 16.75C11.59 16.75 11.25 16.41 11.25 16L11.25 11C11.25 10.59 11.59 10.25 12 10.25C12.41 10.25 12.75 10.59 12.75 11L12.75 16ZM11.08 7.62C11.13 7.49 11.2 7.39 11.29 7.29C11.39 7.2 11.5 7.13 11.62 7.08C11.74 7.03 11.87 7 12 7C12.13 7 12.26 7.03 12.38 7.08C12.5 7.13 12.61 7.2 12.71 7.29C12.8 7.39 12.87 7.49 12.92 7.62C12.97 7.74 13 7.87 13 8C13 8.13 12.97 8.26 12.92 8.38C12.87 8.5 12.8 8.61 12.71 8.71C12.61 8.8 12.5 8.87 12.38 8.92C12.14 9.02 11.86 9.02 11.62 8.92C11.5 8.87 11.39 8.8 11.29 8.71C11.2 8.61 11.13 8.5 11.08 8.38C11.03 8.26 11 8.13 11 8C11 7.87 11.03 7.74 11.08 7.62Z"})}),rL=t=>j.jsxs("svg",{"aria-hidden":"true",fill:"none",height:"1em",shapeRendering:"geometricPrecision",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",viewBox:"0 0 24 24",width:"1em",...t,children:[j.jsx("circle",{cx:"12",cy:"12",fill:"currentColor",r:"1"}),j.jsx("circle",{cx:"19",cy:"12",fill:"currentColor",r:"1"}),j.jsx("circle",{cx:"5",cy:"12",fill:"currentColor",r:"1"})]}),iL=t=>j.jsxs("svg",{"aria-hidden":"true",fill:"none",focusable:"false",height:"1em",role:"presentation",shapeRendering:"geometricPrecision",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",viewBox:"0 0 24 24",width:"1em",...t,children:[j.jsx("path",{d:"M13 17l5-5-5-5"}),j.jsx("path",{d:"M6 17l5-5-5-5"})]}),aL=t=>j.jsx("svg",{"aria-hidden":"true",fill:"none",focusable:"false",height:"1em",role:"presentation",viewBox:"0 0 24 24",width:"1em",...t,children:j.jsx("path",{d:"M15.5 19l-7-7 7-7",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5"})}),CD=t=>j.jsx("svg",{"aria-hidden":"true",focusable:"false",height:"1em",role:"presentation",viewBox:"0 0 24 24",width:"1em",...t,children:j.jsx("path",{d:"M12 2a10 10 0 1010 10A10.016 10.016 0 0012 2zm3.36 12.3a.754.754 0 010 1.06.748.748 0 01-1.06 0l-2.3-2.3-2.3 2.3a.748.748 0 01-1.06 0 .754.754 0 010-1.06l2.3-2.3-2.3-2.3A.75.75 0 019.7 8.64l2.3 2.3 2.3-2.3a.75.75 0 011.06 1.06l-2.3 2.3z",fill:"currentColor"})}),rge=t=>{const{isSelected:e,isIndeterminate:n,disableAnimation:r,...i}=t;return j.jsx("svg",{"aria-hidden":"true",className:"fill-current",fill:"none",focusable:"false",height:"1em",role:"presentation",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,viewBox:"0 0 24 24",width:"1em",...i,children:j.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})},ige=t=>j.jsx("svg",{className:"fill-current",fill:"none",height:"20",viewBox:"0 0 20 20",width:"20",xmlns:"http://www.w3.org/2000/svg",...t,children:j.jsx("path",{d:"M17.51 3.85L11.57 0.42C10.6 -0.14 9.4 -0.14 8.42 0.42L2.49 3.85C1.52 4.41 0.919998 5.45 0.919998 6.58V13.42C0.919998 14.54 1.52 15.58 2.49 16.15L8.43 19.58C9.4 20.14 10.6 20.14 11.58 19.58L17.52 16.15C18.49 15.59 19.09 14.55 19.09 13.42V6.58C19.08 5.45 18.48 4.42 17.51 3.85ZM9.25 5.75C9.25 5.34 9.59 5 10 5C10.41 5 10.75 5.34 10.75 5.75V11C10.75 11.41 10.41 11.75 10 11.75C9.59 11.75 9.25 11.41 9.25 11V5.75ZM10.92 14.63C10.87 14.75 10.8 14.86 10.71 14.96C10.52 15.15 10.27 15.25 10 15.25C9.87 15.25 9.74 15.22 9.62 15.17C9.49 15.12 9.39 15.05 9.29 14.96C9.2 14.86 9.13 14.75 9.07 14.63C9.02 14.51 9 14.38 9 14.25C9 13.99 9.1 13.73 9.29 13.54C9.39 13.45 9.49 13.38 9.62 13.33C9.99 13.17 10.43 13.26 10.71 13.54C10.8 13.64 10.87 13.74 10.92 13.87C10.97 13.99 11 14.12 11 14.25C11 14.38 10.97 14.51 10.92 14.63Z"})}),age=({strokeWidth:t=1.5,...e})=>j.jsx("svg",{"aria-hidden":"true",fill:"none",focusable:"false",height:"1em",role:"presentation",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:t,viewBox:"0 0 24 24",width:"1em",...e,children:j.jsx("path",{d:"m6 9 6 6 6-6"})}),oge=()=>Em(()=>import("./src-UW24ZMRV-B2HjryY0.js"),[]).then(t=>t.default),IW=t=>{const{ripples:e=[],motionProps:n,color:r="currentColor",style:i,onClear:a}=t;return j.jsx(j.Fragment,{children:e.map(o=>{const s=h$(.01*o.size,.2,o.size>100?.75:.5);return j.jsx(Pm,{features:oge,children:j.jsx(fC,{mode:"popLayout",children:j.jsx(Oh.span,{animate:{transform:"scale(2)",opacity:0},className:"heroui-ripple",exit:{opacity:0},initial:{transform:"scale(0)",opacity:.35},style:{position:"absolute",backgroundColor:r,borderRadius:"100%",transformOrigin:"center",pointerEvents:"none",overflow:"hidden",inset:0,zIndex:0,top:o.y,left:o.x,width:`${o.size}px`,height:`${o.size}px`,...i},transition:{duration:s},onAnimationComplete:()=>{a(o.key)},...n})})},o.key)})})};IW.displayName="HeroUI.Ripple";var sge=IW;function lge(t={}){const[e,n]=H.useState([]),r=H.useCallback(a=>{const o=a.target,s=Math.max(o.clientWidth,o.clientHeight);n(l=>[...l,{key:d$(l.length.toString()),size:s,x:a.x-s/2,y:a.y-s/2}])},[]),i=H.useCallback(a=>{n(o=>o.filter(s=>s.key!==a))},[]);return{ripples:e,onClear:i,onPress:r,...t}}var H6=new Map;typeof FinalizationRegistry<"u"&&new FinalizationRegistry(t=>{H6.delete(t)});function cge(t,e){if(t===e)return t;let n=H6.get(t);if(n)return n.forEach(i=>i.current=e),e;let r=H6.get(e);return r?(r.forEach(i=>i.current=t),t):e}function uge(...t){return(...e)=>{for(let n of t)typeof n=="function"&&n(...e)}}function RW(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(e=0;e<i;e++)t[e]&&(n=RW(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function fge(){for(var t,e,n=0,r="",i=arguments.length;n<i;n++)(t=arguments[n])&&(e=RW(t))&&(r&&(r+=" "),r+=e);return r}var dge=fge;function oL(...t){let e={...t[0]};for(let n=1;n<t.length;n++){let r=t[n];for(let i in r){let a=e[i],o=r[i];typeof a=="function"&&typeof o=="function"&&i[0]==="o"&&i[1]==="n"&&i.charCodeAt(2)>=65&&i.charCodeAt(2)<=90?e[i]=uge(a,o):(i==="className"||i==="UNSAFE_className")&&typeof a=="string"&&typeof o=="string"?e[i]=dge(a,o):i==="id"&&a&&o?e.id=cge(a,o):e[i]=o!==void 0?o:a}}return e}var hge=new Set(["id"]),pge=new Set(["aria-label","aria-labelledby","aria-describedby","aria-details"]),gge=new Set(["href","hrefLang","target","rel","download","ping","referrerPolicy"]),mge=new Set(["dir","lang","hidden","inert","translate"]),sL=new Set(["onClick","onAuxClick","onContextMenu","onDoubleClick","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onTouchCancel","onTouchEnd","onTouchMove","onTouchStart","onPointerDown","onPointerMove","onPointerUp","onPointerCancel","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut","onGotPointerCapture","onLostPointerCapture","onScroll","onWheel","onAnimationStart","onAnimationEnd","onAnimationIteration","onTransitionCancel","onTransitionEnd","onTransitionRun","onTransitionStart"]),vge=/^(data-.*)$/;function yge(t,e={}){let{labelable:n,isLink:r,global:i,events:a=i,propNames:o}=e,s={};for(const l in t)Object.prototype.hasOwnProperty.call(t,l)&&(hge.has(l)||n&&pge.has(l)||r&&gge.has(l)||i&&mge.has(l)||a&&sL.has(l)||l.endsWith("Capture")&&sL.has(l.slice(0,-7))||o?.has(l)||vge.test(l))&&(s[l]=t[l]);return s}function xge(t={}){let{autoFocus:e=!1,isTextInput:n,within:r}=t,i=H.useRef({isFocused:!1,isFocusVisible:e||N2()}),[a,o]=H.useState(!1),[s,l]=H.useState(()=>i.current.isFocused&&i.current.isFocusVisible),c=H.useCallback(()=>l(i.current.isFocused&&i.current.isFocusVisible),[]),f=H.useCallback(h=>{i.current.isFocused=h,o(h),c()},[c]);Aj(h=>{i.current.isFocusVisible=h,c()},[],{isTextInput:n});let{focusProps:u}=mD({isDisabled:r,onFocusChange:f}),{focusWithinProps:d}=Am({isDisabled:!r,onFocusWithinChange:f});return{isFocused:a,isFocusVisible:s,focusProps:r?d:u}}function bge(t,e){let{elementType:n="button",isDisabled:r,onPress:i,onPressStart:a,onPressEnd:o,onPressUp:s,onPressChange:l,preventFocusOnPress:c,allowFocusWhenDisabled:f,onClick:u,href:d,target:h,rel:p,type:g="button",allowTextSelectionOnPress:m}=t,y;n==="button"?y={type:g,disabled:r}:y={role:"button",href:n==="a"&&!r?d:void 0,target:n==="a"?h:void 0,type:n==="input"?g:void 0,disabled:n==="input"?r:void 0,"aria-disabled":!r||n==="input"?void 0:r,rel:n==="a"?p:void 0};let{pressProps:v,isPressed:x}=g0({onClick:u,onPressStart:a,onPressEnd:o,onPressUp:s,onPressChange:l,onPress:i,isDisabled:r,preventFocusOnPress:c,allowTextSelectionOnPress:m,ref:e}),{focusableProps:w}=yC(t,e);f&&(w.tabIndex=r?-1:w.tabIndex);let S=oL(w,v,yge(t,{labelable:!0}));return{isPressed:x,buttonProps:oL(y,S,{"aria-haspopup":t["aria-haspopup"],"aria-expanded":t["aria-expanded"],"aria-controls":t["aria-controls"],"aria-pressed":t["aria-pressed"],"aria-current":t["aria-current"]})}}var[YHe,wge]=tC({name:"ButtonGroupContext",strict:!1});function Cge(t){var e,n,r,i,a,o,s,l,c;const f=wge(),u=as(),d=!!f,{ref:h,as:p,children:g,startContent:m,endContent:y,autoFocus:v,className:x,spinner:w,isLoading:S=!1,disableRipple:T=!1,fullWidth:_=(e=f?.fullWidth)!=null?e:!1,radius:D=f?.radius,size:I=(n=f?.size)!=null?n:"md",color:R=(r=f?.color)!=null?r:"default",variant:O=(i=f?.variant)!=null?i:"solid",disableAnimation:P=(o=(a=f?.disableAnimation)!=null?a:u?.disableAnimation)!=null?o:!1,isDisabled:N=(s=f?.isDisabled)!=null?s:!1,isIconOnly:A=(l=f?.isIconOnly)!=null?l:!1,spinnerPlacement:B="start",onPress:V,onClick:$,...U}=t,G=p||"button",F=typeof G=="string",J=Ai(h),Q=(c=T||u?.disableRipple)!=null?c:P,{isFocusVisible:ne,isFocused:ye,focusProps:ve}=xge({autoFocus:v}),Ce=N||S,we=H.useMemo(()=>Wz({size:I,color:R,variant:O,radius:D,fullWidth:_,isDisabled:Ce,isInGroup:d,disableAnimation:P,isIconOnly:A,className:x}),[I,R,O,D,_,Ce,d,A,P,x]),{onPress:Ae,onClear:Me,ripples:q}=lge(),k=H.useCallback(ae=>{Q||Ce||P||J.current&&Ae(ae)},[Q,Ce,P,J,Ae]),{buttonProps:Y,isPressed:X}=bge({elementType:p,isDisabled:Ce,onPress:Nf(V,k),onClick:$,...U},J),{isHovered:re,hoverProps:de}=il({isDisabled:Ce}),he=H.useCallback((ae={})=>({"data-disabled":Lt(Ce),"data-focus":Lt(ye),"data-pressed":Lt(X),"data-focus-visible":Lt(ne),"data-hover":Lt(re),"data-loading":Lt(S),...Nn(Y,ve,de,Lo(U,{enabled:F}),Lo(ae)),className:we}),[S,Ce,ye,X,F,ne,re,Y,ve,de,U,we]),Ee=ae=>H.isValidElement(ae)?H.cloneElement(ae,{"aria-hidden":!0,focusable:!1}):null,Oe=Ee(m),Pe=Ee(y),Ne=H.useMemo(()=>({sm:"sm",md:"sm",lg:"md"})[I],[I]),ie=H.useCallback(()=>({ripples:q,onClear:Me}),[q,Me]);return{Component:G,children:g,domRef:J,spinner:w,styles:we,startContent:Oe,endContent:Pe,isLoading:S,spinnerPlacement:B,spinnerSize:Ne,disableRipple:Q,getButtonProps:he,getRippleProps:ie,isIconOnly:A}}var PW=Qi((t,e)=>{const{Component:n,domRef:r,children:i,spinnerSize:a,spinner:o=j.jsx(bC,{color:"current",size:a}),spinnerPlacement:s,startContent:l,endContent:c,isLoading:f,disableRipple:u,getButtonProps:d,getRippleProps:h,isIconOnly:p}=Cge({...t,ref:e});return j.jsxs(n,{ref:r,...d(),children:[l,f&&s==="start"&&o,f&&p?null:i,f&&s==="end"&&o,c,!u&&j.jsx(sge,{...h()})]})});PW.displayName="HeroUI.Button";var Sge=PW,oE={default:aE,primary:aE,secondary:aE,success:tge,warning:nge,danger:ige},AW=Qi((t,e)=>{const{severity:n,Component:r,icon:i,loadingComponent:a,domRef:o,endContent:s,color:l,hideIcon:c,closeIcon:f,disableAnimation:u,progressBarRef:d,classNames:h,slots:p,getWrapperProps:g,isProgressBarVisible:m,getToastProps:y,getContentProps:v,getTitleProps:x,getDescriptionProps:w,getCloseButtonProps:S,getIconProps:T,getMotionDivProps:_,getCloseIconProps:D,getLoadingComponentProps:I,getSpinnerComponentProps:R,isLoading:O}=Qpe({...t,ref:e}),P=typeof i=="function"?i(T()):H.isValidElement(i)&&H.cloneElement(i,T()),N=n?oE[n]:oE[l]||oE.default,A=a&&H.isValidElement(a)?H.cloneElement(a,I()):null,B=O?A||j.jsx(bC,{...R()}):null,V=typeof f=="function"?f({}):H.isValidElement(f)&&H.cloneElement(f,{}),$=j.jsxs(r,{ref:o,...y(),children:[j.jsxs("div",{...v(),children:[c&&!O?null:B||P||j.jsx(N,{...T()}),j.jsxs("div",{...g(),children:[j.jsx("div",{...x(),children:t.toast.content.title}),j.jsx("div",{...w(),children:t.toast.content.description})]})]}),m&&j.jsx("div",{className:p.progressTrack({class:h?.progressTrack}),children:j.jsx("div",{ref:d,className:p.progressIndicator({class:h?.progressIndicator})})}),j.jsx(Sge,{isIconOnly:!0,...S(),children:V||j.jsx(rge,{...D()})}),s]});return j.jsx(j.Fragment,{children:u?$:j.jsx(Oh.div,{..._(),children:j.jsx(Oh.div,{animate:{opacity:1},exit:{opacity:0},initial:{opacity:0},transition:{duration:.25,ease:"easeOut",delay:.1},children:$},"inner-div")})})});AW.displayName="HeroUI.Toast";var Tge=AW;function Ege({toastQueue:t,placement:e,disableAnimation:n,maxVisibleToasts:r,toastOffset:i,toastProps:a={},className:o,classNames:s,...l}){var c,f;const u=H.useRef(null),{regionProps:d}=Jpe(l,t,u),{hoverProps:h,isHovered:p}=il({isDisabled:!1}),[g,m]=H.useState(!1),y=H.useMemo(()=>Lpe({disableAnimation:n}),[n]),v=sn(s?.base,o);H.useEffect(()=>{function _(D){u.current&&!u.current.contains(D.target)&&m(!1)}return document.addEventListener("touchstart",_),()=>{document.removeEventListener("touchstart",_)}},[]);const[x,w]=H.useState([]),S=(f=(c=t.visibleToasts)==null?void 0:c.length)!=null?f:0,T=H.useCallback(()=>{m(!0)},[]);return j.jsx("div",{...Nn(d,h),ref:u,className:y.base({class:v}),"data-placement":e,onTouchStart:T,children:j.jsx(fC,{children:[...t.visibleToasts].reverse().map((_,D)=>n&&S-D>r?null:n||S-D<=4||p&&S-D<=r+1?j.jsx(Tge,{state:t,toast:_,...Nn(a,_.content),disableAnimation:n,heights:x,index:D,isRegionExpanded:p||g,maxVisibleToasts:r,placement:e,setHeights:w,toastOffset:i,total:S},_.key):null)})})}function _ge(t){let e=H.useCallback(i=>t.subscribe(i),[t]),n=H.useCallback(()=>t.visibleToasts,[t]);return{visibleToasts:_W.useSyncExternalStore(e,n,n),add:(i,a)=>t.add(i,a),close:i=>t.close(i),pauseAll:()=>t.pauseAll(),resumeAll:()=>t.resumeAll()}}class Dge{runWithWrapUpdate(e,n){this.wrapUpdate?this.wrapUpdate(e,n):e()}subscribe(e){return this.subscriptions.add(e),()=>this.subscriptions.delete(e)}add(e,n={}){let r="_"+Math.random().toString(36).slice(2),i={...n,content:e,key:r,timer:n.timeout?new Oge(()=>this.close(r),n.timeout):void 0};return this.queue.unshift(i),this.updateVisibleToasts("add"),r}close(e){let n=this.queue.findIndex(a=>a.key===e);if(n>=0){var r,i;(r=(i=this.queue[n]).onClose)===null||r===void 0||r.call(i),this.queue.splice(n,1)}this.updateVisibleToasts("remove")}updateVisibleToasts(e){this.visibleToasts=this.queue.slice(0,this.maxVisibleToasts),this.runWithWrapUpdate(()=>{for(let n of this.subscriptions)n()},e)}pauseAll(){for(let e of this.visibleToasts)e.timer&&e.timer.pause()}resumeAll(){for(let e of this.visibleToasts)e.timer&&e.timer.resume()}clear(){this.queue=[],this.updateVisibleToasts("clear")}constructor(e){this.queue=[],this.subscriptions=new Set,this.visibleToasts=[];var n;this.maxVisibleToasts=(n=e?.maxVisibleToasts)!==null&&n!==void 0?n:1/0,this.wrapUpdate=e?.wrapUpdate}}class Oge{reset(e){this.remaining=e,this.resume()}pause(){this.timerId!=null&&(clearTimeout(this.timerId),this.timerId=null,this.remaining-=Date.now()-this.startTime)}resume(){this.remaining<=0||(this.startTime=Date.now(),this.timerId=setTimeout(()=>{this.timerId=null,this.remaining=0,this.callback()},this.remaining))}constructor(e,n){this.startTime=null,this.remaining=n,this.callback=e}}var Mge=()=>Em(()=>import("./index-EA6AH5SQ.js"),[]).then(t=>t.domMax),e2=null,Ige=()=>(e2||(e2=new Dge({maxVisibleToasts:1/0})),e2),Rge=({placement:t="bottom-right",disableAnimation:e=!1,maxVisibleToasts:n=3,toastOffset:r=0,toastProps:i={},regionProps:a})=>{var o;const s=_ge(Ige()),l=as(),c=(o=e??l?.disableAnimation)!=null?o:!1;return j.jsx(Pm,{features:Mge,children:s.visibleToasts.length>0&&j.jsx(Ege,{disableAnimation:c,maxVisibleToasts:n,placement:t,toastOffset:r,toastProps:i,toastQueue:s,...a})})},Nt=({...t})=>e2?e2.add(t):null;const lL=t=>{let e;const n=new Set,r=(c,f)=>{const u=typeof c=="function"?c(e):c;if(!Object.is(u,e)){const d=e;e=f??(typeof u!="object"||u===null)?u:Object.assign({},e,u),n.forEach(h=>h(e,d))}},i=()=>e,s={setState:r,getState:i,getInitialState:()=>l,subscribe:c=>(n.add(c),()=>n.delete(c))},l=e=t(r,i,s);return s},Pge=(t=>t?lL(t):lL),Age=t=>t;function Nge(t,e=Age){const n=un.useSyncExternalStore(t.subscribe,un.useCallback(()=>e(t.getState()),[t,e]),un.useCallback(()=>e(t.getInitialState()),[t,e]));return un.useDebugValue(n),n}const Lge=t=>{const e=Pge(t),n=r=>Nge(e,r);return Object.assign(n,e),n},kge=(t=>Lge),cL={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1},k2=new Map,xx=t=>{const e=k2.get(t);return e?Object.fromEntries(Object.entries(e.stores).map(([n,r])=>[n,r.getState()])):{}},Vge=(t,e,n)=>{if(t===void 0)return{type:"untracked",connection:e.connect(n)};const r=k2.get(n.name);if(r)return{type:"tracked",store:t,...r};const i={connection:e.connect(n),stores:{}};return k2.set(n.name,i),{type:"tracked",store:t,...i}},Fge=(t,e)=>{if(e===void 0)return;const n=k2.get(t);n&&(delete n.stores[e],Object.keys(n.stores).length===0&&k2.delete(t))},Uge=t=>{var e,n;if(!t)return;const r=t.split(`
`),i=r.findIndex(o=>o.includes("api.setState"));if(i<0)return;const a=((e=r[i+1])==null?void 0:e.trim())||"";return(n=/.+ (.+) .+/.exec(a))==null?void 0:n[1]},Bge=(t,e={})=>(n,r,i)=>{const{enabled:a,anonymousActionType:o,store:s,...l}=e;let c;try{c=(a??(cL?"production":void 0)!=="production")&&window.__REDUX_DEVTOOLS_EXTENSION__}catch{}if(!c)return t(n,r,i);const{connection:f,...u}=Vge(s,c,l);let d=!0;i.setState=((g,m,y)=>{const v=n(g,m);if(!d)return v;const x=y===void 0?{type:o||Uge(new Error().stack)||"anonymous"}:typeof y=="string"?{type:y}:y;return s===void 0?(f?.send(x,r()),v):(f?.send({...x,type:`${s}/${x.type}`},{...xx(l.name),[s]:i.getState()}),v)}),i.devtools={cleanup:()=>{f&&typeof f.unsubscribe=="function"&&f.unsubscribe(),Fge(l.name,s)}};const h=(...g)=>{const m=d;d=!1,n(...g),d=m},p=t(i.setState,r,i);if(u.type==="untracked"?f?.init(p):(u.stores[u.store]=i,f?.init(Object.fromEntries(Object.entries(u.stores).map(([g,m])=>[g,g===u.store?p:m.getState()])))),i.dispatchFromDevtools&&typeof i.dispatch=="function"){let g=!1;const m=i.dispatch;i.dispatch=(...y)=>{(cL?"production":void 0)!=="production"&&y[0].type==="__setState"&&!g&&(console.warn('[zustand devtools middleware] "__setState" action type is reserved to set state from the devtools. Avoid using it.'),g=!0),m(...y)}}return f.subscribe(g=>{var m;switch(g.type){case"ACTION":if(typeof g.payload!="string"){console.error("[zustand devtools middleware] Unsupported action format");return}return sE(g.payload,y=>{if(y.type==="__setState"){if(s===void 0){h(y.state);return}Object.keys(y.state).length!==1&&console.error(`
                    [zustand devtools middleware] Unsupported __setState action format.
                    When using 'store' option in devtools(), the 'state' should have only one key, which is a value of 'store' that was passed in devtools(),
                    and value of this only key should be a state object. Example: { "type": "__setState", "state": { "abc123Store": { "foo": "bar" } } }
                    `);const v=y.state[s];if(v==null)return;JSON.stringify(i.getState())!==JSON.stringify(v)&&h(v);return}i.dispatchFromDevtools&&typeof i.dispatch=="function"&&i.dispatch(y)});case"DISPATCH":switch(g.payload.type){case"RESET":return h(p),s===void 0?f?.init(i.getState()):f?.init(xx(l.name));case"COMMIT":if(s===void 0){f?.init(i.getState());return}return f?.init(xx(l.name));case"ROLLBACK":return sE(g.state,y=>{if(s===void 0){h(y),f?.init(i.getState());return}h(y[s]),f?.init(xx(l.name))});case"JUMP_TO_STATE":case"JUMP_TO_ACTION":return sE(g.state,y=>{if(s===void 0){h(y);return}JSON.stringify(i.getState())!==JSON.stringify(y[s])&&h(y[s])});case"IMPORT_STATE":{const{nextLiftedState:y}=g.payload,v=(m=y.computedStates.slice(-1)[0])==null?void 0:m.state;if(!v)return;h(s===void 0?v:v[s]),f?.send(null,y);return}case"PAUSE_RECORDING":return d=!d}return}}),p},$ge=Bge,sE=(t,e)=>{let n;try{n=JSON.parse(t)}catch(r){console.error("[zustand devtools middleware] Could not parse the received json",r)}n!==void 0&&e(n)};function Gge(t,e){let n;try{n=t()}catch{return}return{getItem:i=>{var a;const o=l=>l===null?null:JSON.parse(l,void 0),s=(a=n.getItem(i))!=null?a:null;return s instanceof Promise?s.then(o):o(s)},setItem:(i,a)=>n.setItem(i,JSON.stringify(a,void 0)),removeItem:i=>n.removeItem(i)}}const K6=t=>e=>{try{const n=t(e);return n instanceof Promise?n:{then(r){return K6(r)(n)},catch(r){return this}}}catch(n){return{then(r){return this},catch(r){return K6(r)(n)}}}},jge=(t,e)=>(n,r,i)=>{let a={storage:Gge(()=>localStorage),partialize:g=>g,version:0,merge:(g,m)=>({...m,...g}),...e},o=!1;const s=new Set,l=new Set;let c=a.storage;if(!c)return t((...g)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),n(...g)},r,i);const f=()=>{const g=a.partialize({...r()});return c.setItem(a.name,{state:g,version:a.version})},u=i.setState;i.setState=(g,m)=>(u(g,m),f());const d=t((...g)=>(n(...g),f()),r,i);i.getInitialState=()=>d;let h;const p=()=>{var g,m;if(!c)return;o=!1,s.forEach(v=>{var x;return v((x=r())!=null?x:d)});const y=((m=a.onRehydrateStorage)==null?void 0:m.call(a,(g=r())!=null?g:d))||void 0;return K6(c.getItem.bind(c))(a.name).then(v=>{if(v)if(typeof v.version=="number"&&v.version!==a.version){if(a.migrate){const x=a.migrate(v.state,v.version);return x instanceof Promise?x.then(w=>[!0,w]):[!0,x]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,v.state];return[!1,void 0]}).then(v=>{var x;const[w,S]=v;if(h=a.merge(S,(x=r())!=null?x:d),n(h,!0),w)return f()}).then(()=>{y?.(h,void 0),h=r(),o=!0,l.forEach(v=>v(h))}).catch(v=>{y?.(void 0,v)})};return i.persist={setOptions:g=>{a={...a,...g},g.storage&&(c=g.storage)},clearStorage:()=>{c?.removeItem(a.name)},getOptions:()=>a,rehydrate:()=>p(),hasHydrated:()=>o,onHydrate:g=>(s.add(g),()=>{s.delete(g)}),onFinishHydration:g=>(l.add(g),()=>{l.delete(g)})},a.skipHydration||p(),h||d},zge=jge;function NW(t,e){return function(){return t.apply(e,arguments)}}const{toString:Wge}=Object.prototype,{getPrototypeOf:SD}=Object,{iterator:wC,toStringTag:LW}=Symbol,CC=(t=>e=>{const n=Wge.call(e);return t[n]||(t[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),_c=t=>(t=t.toLowerCase(),e=>CC(e)===t),SC=t=>e=>typeof e===t,{isArray:Vm}=Array,V2=SC("undefined");function Cy(t){return t!==null&&!V2(t)&&t.constructor!==null&&!V2(t.constructor)&&Ms(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const kW=_c("ArrayBuffer");function Hge(t){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&kW(t.buffer),e}const Kge=SC("string"),Ms=SC("function"),VW=SC("number"),Sy=t=>t!==null&&typeof t=="object",qge=t=>t===!0||t===!1,Ab=t=>{if(CC(t)!=="object")return!1;const e=SD(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(LW in t)&&!(wC in t)},Xge=t=>{if(!Sy(t)||Cy(t))return!1;try{return Object.keys(t).length===0&&Object.getPrototypeOf(t)===Object.prototype}catch{return!1}},Yge=_c("Date"),Jge=_c("File"),Zge=_c("Blob"),Qge=_c("FileList"),eme=t=>Sy(t)&&Ms(t.pipe),tme=t=>{let e;return t&&(typeof FormData=="function"&&t instanceof FormData||Ms(t.append)&&((e=CC(t))==="formdata"||e==="object"&&Ms(t.toString)&&t.toString()==="[object FormData]"))},nme=_c("URLSearchParams"),[rme,ime,ame,ome]=["ReadableStream","Request","Response","Headers"].map(_c),sme=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Ty(t,e,{allOwnKeys:n=!1}={}){if(t===null||typeof t>"u")return;let r,i;if(typeof t!="object"&&(t=[t]),Vm(t))for(r=0,i=t.length;r<i;r++)e.call(null,t[r],r,t);else{if(Cy(t))return;const a=n?Object.getOwnPropertyNames(t):Object.keys(t),o=a.length;let s;for(r=0;r<o;r++)s=a[r],e.call(null,t[s],s,t)}}function FW(t,e){if(Cy(t))return null;e=e.toLowerCase();const n=Object.keys(t);let r=n.length,i;for(;r-- >0;)if(i=n[r],e===i.toLowerCase())return i;return null}const uh=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,UW=t=>!V2(t)&&t!==uh;function q6(){const{caseless:t}=UW(this)&&this||{},e={},n=(r,i)=>{const a=t&&FW(e,i)||i;Ab(e[a])&&Ab(r)?e[a]=q6(e[a],r):Ab(r)?e[a]=q6({},r):Vm(r)?e[a]=r.slice():e[a]=r};for(let r=0,i=arguments.length;r<i;r++)arguments[r]&&Ty(arguments[r],n);return e}const lme=(t,e,n,{allOwnKeys:r}={})=>(Ty(e,(i,a)=>{n&&Ms(i)?t[a]=NW(i,n):t[a]=i},{allOwnKeys:r}),t),cme=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),ume=(t,e,n,r)=>{t.prototype=Object.create(e.prototype,r),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),n&&Object.assign(t.prototype,n)},fme=(t,e,n,r)=>{let i,a,o;const s={};if(e=e||{},t==null)return e;do{for(i=Object.getOwnPropertyNames(t),a=i.length;a-- >0;)o=i[a],(!r||r(o,t,e))&&!s[o]&&(e[o]=t[o],s[o]=!0);t=n!==!1&&SD(t)}while(t&&(!n||n(t,e))&&t!==Object.prototype);return e},dme=(t,e,n)=>{t=String(t),(n===void 0||n>t.length)&&(n=t.length),n-=e.length;const r=t.indexOf(e,n);return r!==-1&&r===n},hme=t=>{if(!t)return null;if(Vm(t))return t;let e=t.length;if(!VW(e))return null;const n=new Array(e);for(;e-- >0;)n[e]=t[e];return n},pme=(t=>e=>t&&e instanceof t)(typeof Uint8Array<"u"&&SD(Uint8Array)),gme=(t,e)=>{const r=(t&&t[wC]).call(t);let i;for(;(i=r.next())&&!i.done;){const a=i.value;e.call(t,a[0],a[1])}},mme=(t,e)=>{let n;const r=[];for(;(n=t.exec(e))!==null;)r.push(n);return r},vme=_c("HTMLFormElement"),yme=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,r,i){return r.toUpperCase()+i}),uL=(({hasOwnProperty:t})=>(e,n)=>t.call(e,n))(Object.prototype),xme=_c("RegExp"),BW=(t,e)=>{const n=Object.getOwnPropertyDescriptors(t),r={};Ty(n,(i,a)=>{let o;(o=e(i,a,t))!==!1&&(r[a]=o||i)}),Object.defineProperties(t,r)},bme=t=>{BW(t,(e,n)=>{if(Ms(t)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const r=t[n];if(Ms(r)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},wme=(t,e)=>{const n={},r=i=>{i.forEach(a=>{n[a]=!0})};return Vm(t)?r(t):r(String(t).split(e)),n},Cme=()=>{},Sme=(t,e)=>t!=null&&Number.isFinite(t=+t)?t:e;function Tme(t){return!!(t&&Ms(t.append)&&t[LW]==="FormData"&&t[wC])}const Eme=t=>{const e=new Array(10),n=(r,i)=>{if(Sy(r)){if(e.indexOf(r)>=0)return;if(Cy(r))return r;if(!("toJSON"in r)){e[i]=r;const a=Vm(r)?[]:{};return Ty(r,(o,s)=>{const l=n(o,i+1);!V2(l)&&(a[s]=l)}),e[i]=void 0,a}}return r};return n(t,0)},_me=_c("AsyncFunction"),Dme=t=>t&&(Sy(t)||Ms(t))&&Ms(t.then)&&Ms(t.catch),$W=((t,e)=>t?setImmediate:e?((n,r)=>(uh.addEventListener("message",({source:i,data:a})=>{i===uh&&a===n&&r.length&&r.shift()()},!1),i=>{r.push(i),uh.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",Ms(uh.postMessage)),Ome=typeof queueMicrotask<"u"?queueMicrotask.bind(uh):typeof process<"u"&&process.nextTick||$W,Mme=t=>t!=null&&Ms(t[wC]),lt={isArray:Vm,isArrayBuffer:kW,isBuffer:Cy,isFormData:tme,isArrayBufferView:Hge,isString:Kge,isNumber:VW,isBoolean:qge,isObject:Sy,isPlainObject:Ab,isEmptyObject:Xge,isReadableStream:rme,isRequest:ime,isResponse:ame,isHeaders:ome,isUndefined:V2,isDate:Yge,isFile:Jge,isBlob:Zge,isRegExp:xme,isFunction:Ms,isStream:eme,isURLSearchParams:nme,isTypedArray:pme,isFileList:Qge,forEach:Ty,merge:q6,extend:lme,trim:sme,stripBOM:cme,inherits:ume,toFlatObject:fme,kindOf:CC,kindOfTest:_c,endsWith:dme,toArray:hme,forEachEntry:gme,matchAll:mme,isHTMLForm:vme,hasOwnProperty:uL,hasOwnProp:uL,reduceDescriptors:BW,freezeMethods:bme,toObjectSet:wme,toCamelCase:yme,noop:Cme,toFiniteNumber:Sme,findKey:FW,global:uh,isContextDefined:UW,isSpecCompliantForm:Tme,toJSONObject:Eme,isAsyncFn:_me,isThenable:Dme,setImmediate:$W,asap:Ome,isIterable:Mme};function kn(t,e,n,r,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",e&&(this.code=e),n&&(this.config=n),r&&(this.request=r),i&&(this.response=i,this.status=i.status?i.status:null)}lt.inherits(kn,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:lt.toJSONObject(this.config),code:this.code,status:this.status}}});const GW=kn.prototype,jW={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{jW[t]={value:t}});Object.defineProperties(kn,jW);Object.defineProperty(GW,"isAxiosError",{value:!0});kn.from=(t,e,n,r,i,a)=>{const o=Object.create(GW);return lt.toFlatObject(t,o,function(l){return l!==Error.prototype},s=>s!=="isAxiosError"),kn.call(o,t.message,e,n,r,i),o.cause=t,o.name=t.name,a&&Object.assign(o,a),o};const Ime=null;function X6(t){return lt.isPlainObject(t)||lt.isArray(t)}function zW(t){return lt.endsWith(t,"[]")?t.slice(0,-2):t}function fL(t,e,n){return t?t.concat(e).map(function(i,a){return i=zW(i),!n&&a?"["+i+"]":i}).join(n?".":""):e}function Rme(t){return lt.isArray(t)&&!t.some(X6)}const Pme=lt.toFlatObject(lt,{},null,function(e){return/^is[A-Z]/.test(e)});function TC(t,e,n){if(!lt.isObject(t))throw new TypeError("target must be an object");e=e||new FormData,n=lt.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(g,m){return!lt.isUndefined(m[g])});const r=n.metaTokens,i=n.visitor||f,a=n.dots,o=n.indexes,l=(n.Blob||typeof Blob<"u"&&Blob)&&lt.isSpecCompliantForm(e);if(!lt.isFunction(i))throw new TypeError("visitor must be a function");function c(p){if(p===null)return"";if(lt.isDate(p))return p.toISOString();if(lt.isBoolean(p))return p.toString();if(!l&&lt.isBlob(p))throw new kn("Blob is not supported. Use a Buffer instead.");return lt.isArrayBuffer(p)||lt.isTypedArray(p)?l&&typeof Blob=="function"?new Blob([p]):Buffer.from(p):p}function f(p,g,m){let y=p;if(p&&!m&&typeof p=="object"){if(lt.endsWith(g,"{}"))g=r?g:g.slice(0,-2),p=JSON.stringify(p);else if(lt.isArray(p)&&Rme(p)||(lt.isFileList(p)||lt.endsWith(g,"[]"))&&(y=lt.toArray(p)))return g=zW(g),y.forEach(function(x,w){!(lt.isUndefined(x)||x===null)&&e.append(o===!0?fL([g],w,a):o===null?g:g+"[]",c(x))}),!1}return X6(p)?!0:(e.append(fL(m,g,a),c(p)),!1)}const u=[],d=Object.assign(Pme,{defaultVisitor:f,convertValue:c,isVisitable:X6});function h(p,g){if(!lt.isUndefined(p)){if(u.indexOf(p)!==-1)throw Error("Circular reference detected in "+g.join("."));u.push(p),lt.forEach(p,function(y,v){(!(lt.isUndefined(y)||y===null)&&i.call(e,y,lt.isString(v)?v.trim():v,g,d))===!0&&h(y,g?g.concat(v):[v])}),u.pop()}}if(!lt.isObject(t))throw new TypeError("data must be an object");return h(t),e}function dL(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(r){return e[r]})}function TD(t,e){this._pairs=[],t&&TC(t,this,e)}const WW=TD.prototype;WW.append=function(e,n){this._pairs.push([e,n])};WW.toString=function(e){const n=e?function(r){return e.call(this,r,dL)}:dL;return this._pairs.map(function(i){return n(i[0])+"="+n(i[1])},"").join("&")};function Ame(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function HW(t,e,n){if(!e)return t;const r=n&&n.encode||Ame;lt.isFunction(n)&&(n={serialize:n});const i=n&&n.serialize;let a;if(i?a=i(e,n):a=lt.isURLSearchParams(e)?e.toString():new TD(e,n).toString(r),a){const o=t.indexOf("#");o!==-1&&(t=t.slice(0,o)),t+=(t.indexOf("?")===-1?"?":"&")+a}return t}class hL{constructor(){this.handlers=[]}use(e,n,r){return this.handlers.push({fulfilled:e,rejected:n,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){lt.forEach(this.handlers,function(r){r!==null&&e(r)})}}const KW={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Nme=typeof URLSearchParams<"u"?URLSearchParams:TD,Lme=typeof FormData<"u"?FormData:null,kme=typeof Blob<"u"?Blob:null,Vme={isBrowser:!0,classes:{URLSearchParams:Nme,FormData:Lme,Blob:kme},protocols:["http","https","file","blob","url","data"]},ED=typeof window<"u"&&typeof document<"u",Y6=typeof navigator=="object"&&navigator||void 0,Fme=ED&&(!Y6||["ReactNative","NativeScript","NS"].indexOf(Y6.product)<0),Ume=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",Bme=ED&&window.location.href||"http://localhost",$me=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:ED,hasStandardBrowserEnv:Fme,hasStandardBrowserWebWorkerEnv:Ume,navigator:Y6,origin:Bme},Symbol.toStringTag,{value:"Module"})),Ro={...$me,...Vme};function Gme(t,e){return TC(t,new Ro.classes.URLSearchParams,{visitor:function(n,r,i,a){return Ro.isNode&&lt.isBuffer(n)?(this.append(r,n.toString("base64")),!1):a.defaultVisitor.apply(this,arguments)},...e})}function jme(t){return lt.matchAll(/\w+|\[(\w*)]/g,t).map(e=>e[0]==="[]"?"":e[1]||e[0])}function zme(t){const e={},n=Object.keys(t);let r;const i=n.length;let a;for(r=0;r<i;r++)a=n[r],e[a]=t[a];return e}function qW(t){function e(n,r,i,a){let o=n[a++];if(o==="__proto__")return!0;const s=Number.isFinite(+o),l=a>=n.length;return o=!o&&lt.isArray(i)?i.length:o,l?(lt.hasOwnProp(i,o)?i[o]=[i[o],r]:i[o]=r,!s):((!i[o]||!lt.isObject(i[o]))&&(i[o]=[]),e(n,r,i[o],a)&&lt.isArray(i[o])&&(i[o]=zme(i[o])),!s)}if(lt.isFormData(t)&&lt.isFunction(t.entries)){const n={};return lt.forEachEntry(t,(r,i)=>{e(jme(r),i,n,0)}),n}return null}function Wme(t,e,n){if(lt.isString(t))try{return(e||JSON.parse)(t),lt.trim(t)}catch(r){if(r.name!=="SyntaxError")throw r}return(n||JSON.stringify)(t)}const Ey={transitional:KW,adapter:["xhr","http","fetch"],transformRequest:[function(e,n){const r=n.getContentType()||"",i=r.indexOf("application/json")>-1,a=lt.isObject(e);if(a&&lt.isHTMLForm(e)&&(e=new FormData(e)),lt.isFormData(e))return i?JSON.stringify(qW(e)):e;if(lt.isArrayBuffer(e)||lt.isBuffer(e)||lt.isStream(e)||lt.isFile(e)||lt.isBlob(e)||lt.isReadableStream(e))return e;if(lt.isArrayBufferView(e))return e.buffer;if(lt.isURLSearchParams(e))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let s;if(a){if(r.indexOf("application/x-www-form-urlencoded")>-1)return Gme(e,this.formSerializer).toString();if((s=lt.isFileList(e))||r.indexOf("multipart/form-data")>-1){const l=this.env&&this.env.FormData;return TC(s?{"files[]":e}:e,l&&new l,this.formSerializer)}}return a||i?(n.setContentType("application/json",!1),Wme(e)):e}],transformResponse:[function(e){const n=this.transitional||Ey.transitional,r=n&&n.forcedJSONParsing,i=this.responseType==="json";if(lt.isResponse(e)||lt.isReadableStream(e))return e;if(e&&lt.isString(e)&&(r&&!this.responseType||i)){const o=!(n&&n.silentJSONParsing)&&i;try{return JSON.parse(e)}catch(s){if(o)throw s.name==="SyntaxError"?kn.from(s,kn.ERR_BAD_RESPONSE,this,null,this.response):s}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Ro.classes.FormData,Blob:Ro.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};lt.forEach(["delete","get","head","post","put","patch"],t=>{Ey.headers[t]={}});const Hme=lt.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Kme=t=>{const e={};let n,r,i;return t&&t.split(`
`).forEach(function(o){i=o.indexOf(":"),n=o.substring(0,i).trim().toLowerCase(),r=o.substring(i+1).trim(),!(!n||e[n]&&Hme[n])&&(n==="set-cookie"?e[n]?e[n].push(r):e[n]=[r]:e[n]=e[n]?e[n]+", "+r:r)}),e},pL=Symbol("internals");function J1(t){return t&&String(t).trim().toLowerCase()}function Nb(t){return t===!1||t==null?t:lt.isArray(t)?t.map(Nb):String(t)}function qme(t){const e=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(t);)e[r[1]]=r[2];return e}const Xme=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function lE(t,e,n,r,i){if(lt.isFunction(r))return r.call(this,e,n);if(i&&(e=n),!!lt.isString(e)){if(lt.isString(r))return e.indexOf(r)!==-1;if(lt.isRegExp(r))return r.test(e)}}function Yme(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,n,r)=>n.toUpperCase()+r)}function Jme(t,e){const n=lt.toCamelCase(" "+e);["get","set","has"].forEach(r=>{Object.defineProperty(t,r+n,{value:function(i,a,o){return this[r].call(this,e,i,a,o)},configurable:!0})})}let Is=class{constructor(e){e&&this.set(e)}set(e,n,r){const i=this;function a(s,l,c){const f=J1(l);if(!f)throw new Error("header name must be a non-empty string");const u=lt.findKey(i,f);(!u||i[u]===void 0||c===!0||c===void 0&&i[u]!==!1)&&(i[u||l]=Nb(s))}const o=(s,l)=>lt.forEach(s,(c,f)=>a(c,f,l));if(lt.isPlainObject(e)||e instanceof this.constructor)o(e,n);else if(lt.isString(e)&&(e=e.trim())&&!Xme(e))o(Kme(e),n);else if(lt.isObject(e)&&lt.isIterable(e)){let s={},l,c;for(const f of e){if(!lt.isArray(f))throw TypeError("Object iterator must return a key-value pair");s[c=f[0]]=(l=s[c])?lt.isArray(l)?[...l,f[1]]:[l,f[1]]:f[1]}o(s,n)}else e!=null&&a(n,e,r);return this}get(e,n){if(e=J1(e),e){const r=lt.findKey(this,e);if(r){const i=this[r];if(!n)return i;if(n===!0)return qme(i);if(lt.isFunction(n))return n.call(this,i,r);if(lt.isRegExp(n))return n.exec(i);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,n){if(e=J1(e),e){const r=lt.findKey(this,e);return!!(r&&this[r]!==void 0&&(!n||lE(this,this[r],r,n)))}return!1}delete(e,n){const r=this;let i=!1;function a(o){if(o=J1(o),o){const s=lt.findKey(r,o);s&&(!n||lE(r,r[s],s,n))&&(delete r[s],i=!0)}}return lt.isArray(e)?e.forEach(a):a(e),i}clear(e){const n=Object.keys(this);let r=n.length,i=!1;for(;r--;){const a=n[r];(!e||lE(this,this[a],a,e,!0))&&(delete this[a],i=!0)}return i}normalize(e){const n=this,r={};return lt.forEach(this,(i,a)=>{const o=lt.findKey(r,a);if(o){n[o]=Nb(i),delete n[a];return}const s=e?Yme(a):String(a).trim();s!==a&&delete n[a],n[s]=Nb(i),r[s]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const n=Object.create(null);return lt.forEach(this,(r,i)=>{r!=null&&r!==!1&&(n[i]=e&&lt.isArray(r)?r.join(", "):r)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,n])=>e+": "+n).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...n){const r=new this(e);return n.forEach(i=>r.set(i)),r}static accessor(e){const r=(this[pL]=this[pL]={accessors:{}}).accessors,i=this.prototype;function a(o){const s=J1(o);r[s]||(Jme(i,o),r[s]=!0)}return lt.isArray(e)?e.forEach(a):a(e),this}};Is.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);lt.reduceDescriptors(Is.prototype,({value:t},e)=>{let n=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(r){this[n]=r}}});lt.freezeMethods(Is);function cE(t,e){const n=this||Ey,r=e||n,i=Is.from(r.headers);let a=r.data;return lt.forEach(t,function(s){a=s.call(n,a,i.normalize(),e?e.status:void 0)}),i.normalize(),a}function XW(t){return!!(t&&t.__CANCEL__)}function Fm(t,e,n){kn.call(this,t??"canceled",kn.ERR_CANCELED,e,n),this.name="CanceledError"}lt.inherits(Fm,kn,{__CANCEL__:!0});function YW(t,e,n){const r=n.config.validateStatus;!n.status||!r||r(n.status)?t(n):e(new kn("Request failed with status code "+n.status,[kn.ERR_BAD_REQUEST,kn.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function Zme(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}function Qme(t,e){t=t||10;const n=new Array(t),r=new Array(t);let i=0,a=0,o;return e=e!==void 0?e:1e3,function(l){const c=Date.now(),f=r[a];o||(o=c),n[i]=l,r[i]=c;let u=a,d=0;for(;u!==i;)d+=n[u++],u=u%t;if(i=(i+1)%t,i===a&&(a=(a+1)%t),c-o<e)return;const h=f&&c-f;return h?Math.round(d*1e3/h):void 0}}function e1e(t,e){let n=0,r=1e3/e,i,a;const o=(c,f=Date.now())=>{n=f,i=null,a&&(clearTimeout(a),a=null),t(...c)};return[(...c)=>{const f=Date.now(),u=f-n;u>=r?o(c,f):(i=c,a||(a=setTimeout(()=>{a=null,o(i)},r-u)))},()=>i&&o(i)]}const Vw=(t,e,n=3)=>{let r=0;const i=Qme(50,250);return e1e(a=>{const o=a.loaded,s=a.lengthComputable?a.total:void 0,l=o-r,c=i(l),f=o<=s;r=o;const u={loaded:o,total:s,progress:s?o/s:void 0,bytes:l,rate:c||void 0,estimated:c&&s&&f?(s-o)/c:void 0,event:a,lengthComputable:s!=null,[e?"download":"upload"]:!0};t(u)},n)},gL=(t,e)=>{const n=t!=null;return[r=>e[0]({lengthComputable:n,total:t,loaded:r}),e[1]]},mL=t=>(...e)=>lt.asap(()=>t(...e)),t1e=Ro.hasStandardBrowserEnv?((t,e)=>n=>(n=new URL(n,Ro.origin),t.protocol===n.protocol&&t.host===n.host&&(e||t.port===n.port)))(new URL(Ro.origin),Ro.navigator&&/(msie|trident)/i.test(Ro.navigator.userAgent)):()=>!0,n1e=Ro.hasStandardBrowserEnv?{write(t,e,n,r,i,a){const o=[t+"="+encodeURIComponent(e)];lt.isNumber(n)&&o.push("expires="+new Date(n).toGMTString()),lt.isString(r)&&o.push("path="+r),lt.isString(i)&&o.push("domain="+i),a===!0&&o.push("secure"),document.cookie=o.join("; ")},read(t){const e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function r1e(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function i1e(t,e){return e?t.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):t}function JW(t,e,n){let r=!r1e(e);return t&&(r||n==!1)?i1e(t,e):e}const vL=t=>t instanceof Is?{...t}:t;function Rh(t,e){e=e||{};const n={};function r(c,f,u,d){return lt.isPlainObject(c)&&lt.isPlainObject(f)?lt.merge.call({caseless:d},c,f):lt.isPlainObject(f)?lt.merge({},f):lt.isArray(f)?f.slice():f}function i(c,f,u,d){if(lt.isUndefined(f)){if(!lt.isUndefined(c))return r(void 0,c,u,d)}else return r(c,f,u,d)}function a(c,f){if(!lt.isUndefined(f))return r(void 0,f)}function o(c,f){if(lt.isUndefined(f)){if(!lt.isUndefined(c))return r(void 0,c)}else return r(void 0,f)}function s(c,f,u){if(u in e)return r(c,f);if(u in t)return r(void 0,c)}const l={url:a,method:a,data:a,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:s,headers:(c,f,u)=>i(vL(c),vL(f),u,!0)};return lt.forEach(Object.keys({...t,...e}),function(f){const u=l[f]||i,d=u(t[f],e[f],f);lt.isUndefined(d)&&u!==s||(n[f]=d)}),n}const ZW=t=>{const e=Rh({},t);let{data:n,withXSRFToken:r,xsrfHeaderName:i,xsrfCookieName:a,headers:o,auth:s}=e;e.headers=o=Is.from(o),e.url=HW(JW(e.baseURL,e.url,e.allowAbsoluteUrls),t.params,t.paramsSerializer),s&&o.set("Authorization","Basic "+btoa((s.username||"")+":"+(s.password?unescape(encodeURIComponent(s.password)):"")));let l;if(lt.isFormData(n)){if(Ro.hasStandardBrowserEnv||Ro.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if((l=o.getContentType())!==!1){const[c,...f]=l?l.split(";").map(u=>u.trim()).filter(Boolean):[];o.setContentType([c||"multipart/form-data",...f].join("; "))}}if(Ro.hasStandardBrowserEnv&&(r&&lt.isFunction(r)&&(r=r(e)),r||r!==!1&&t1e(e.url))){const c=i&&a&&n1e.read(a);c&&o.set(i,c)}return e},a1e=typeof XMLHttpRequest<"u",o1e=a1e&&function(t){return new Promise(function(n,r){const i=ZW(t);let a=i.data;const o=Is.from(i.headers).normalize();let{responseType:s,onUploadProgress:l,onDownloadProgress:c}=i,f,u,d,h,p;function g(){h&&h(),p&&p(),i.cancelToken&&i.cancelToken.unsubscribe(f),i.signal&&i.signal.removeEventListener("abort",f)}let m=new XMLHttpRequest;m.open(i.method.toUpperCase(),i.url,!0),m.timeout=i.timeout;function y(){if(!m)return;const x=Is.from("getAllResponseHeaders"in m&&m.getAllResponseHeaders()),S={data:!s||s==="text"||s==="json"?m.responseText:m.response,status:m.status,statusText:m.statusText,headers:x,config:t,request:m};YW(function(_){n(_),g()},function(_){r(_),g()},S),m=null}"onloadend"in m?m.onloadend=y:m.onreadystatechange=function(){!m||m.readyState!==4||m.status===0&&!(m.responseURL&&m.responseURL.indexOf("file:")===0)||setTimeout(y)},m.onabort=function(){m&&(r(new kn("Request aborted",kn.ECONNABORTED,t,m)),m=null)},m.onerror=function(){r(new kn("Network Error",kn.ERR_NETWORK,t,m)),m=null},m.ontimeout=function(){let w=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const S=i.transitional||KW;i.timeoutErrorMessage&&(w=i.timeoutErrorMessage),r(new kn(w,S.clarifyTimeoutError?kn.ETIMEDOUT:kn.ECONNABORTED,t,m)),m=null},a===void 0&&o.setContentType(null),"setRequestHeader"in m&&lt.forEach(o.toJSON(),function(w,S){m.setRequestHeader(S,w)}),lt.isUndefined(i.withCredentials)||(m.withCredentials=!!i.withCredentials),s&&s!=="json"&&(m.responseType=i.responseType),c&&([d,p]=Vw(c,!0),m.addEventListener("progress",d)),l&&m.upload&&([u,h]=Vw(l),m.upload.addEventListener("progress",u),m.upload.addEventListener("loadend",h)),(i.cancelToken||i.signal)&&(f=x=>{m&&(r(!x||x.type?new Fm(null,t,m):x),m.abort(),m=null)},i.cancelToken&&i.cancelToken.subscribe(f),i.signal&&(i.signal.aborted?f():i.signal.addEventListener("abort",f)));const v=Zme(i.url);if(v&&Ro.protocols.indexOf(v)===-1){r(new kn("Unsupported protocol "+v+":",kn.ERR_BAD_REQUEST,t));return}m.send(a||null)})},s1e=(t,e)=>{const{length:n}=t=t?t.filter(Boolean):[];if(e||n){let r=new AbortController,i;const a=function(c){if(!i){i=!0,s();const f=c instanceof Error?c:this.reason;r.abort(f instanceof kn?f:new Fm(f instanceof Error?f.message:f))}};let o=e&&setTimeout(()=>{o=null,a(new kn(`timeout ${e} of ms exceeded`,kn.ETIMEDOUT))},e);const s=()=>{t&&(o&&clearTimeout(o),o=null,t.forEach(c=>{c.unsubscribe?c.unsubscribe(a):c.removeEventListener("abort",a)}),t=null)};t.forEach(c=>c.addEventListener("abort",a));const{signal:l}=r;return l.unsubscribe=()=>lt.asap(s),l}},l1e=function*(t,e){let n=t.byteLength;if(n<e){yield t;return}let r=0,i;for(;r<n;)i=r+e,yield t.slice(r,i),r=i},c1e=async function*(t,e){for await(const n of u1e(t))yield*l1e(n,e)},u1e=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const e=t.getReader();try{for(;;){const{done:n,value:r}=await e.read();if(n)break;yield r}}finally{await e.cancel()}},yL=(t,e,n,r)=>{const i=c1e(t,e);let a=0,o,s=l=>{o||(o=!0,r&&r(l))};return new ReadableStream({async pull(l){try{const{done:c,value:f}=await i.next();if(c){s(),l.close();return}let u=f.byteLength;if(n){let d=a+=u;n(d)}l.enqueue(new Uint8Array(f))}catch(c){throw s(c),c}},cancel(l){return s(l),i.return()}},{highWaterMark:2})},EC=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",QW=EC&&typeof ReadableStream=="function",f1e=EC&&(typeof TextEncoder=="function"?(t=>e=>t.encode(e))(new TextEncoder):async t=>new Uint8Array(await new Response(t).arrayBuffer())),eH=(t,...e)=>{try{return!!t(...e)}catch{return!1}},d1e=QW&&eH(()=>{let t=!1;const e=new Request(Ro.origin,{body:new ReadableStream,method:"POST",get duplex(){return t=!0,"half"}}).headers.has("Content-Type");return t&&!e}),xL=64*1024,J6=QW&&eH(()=>lt.isReadableStream(new Response("").body)),Fw={stream:J6&&(t=>t.body)};EC&&(t=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!Fw[e]&&(Fw[e]=lt.isFunction(t[e])?n=>n[e]():(n,r)=>{throw new kn(`Response type '${e}' is not supported`,kn.ERR_NOT_SUPPORT,r)})})})(new Response);const h1e=async t=>{if(t==null)return 0;if(lt.isBlob(t))return t.size;if(lt.isSpecCompliantForm(t))return(await new Request(Ro.origin,{method:"POST",body:t}).arrayBuffer()).byteLength;if(lt.isArrayBufferView(t)||lt.isArrayBuffer(t))return t.byteLength;if(lt.isURLSearchParams(t)&&(t=t+""),lt.isString(t))return(await f1e(t)).byteLength},p1e=async(t,e)=>{const n=lt.toFiniteNumber(t.getContentLength());return n??h1e(e)},g1e=EC&&(async t=>{let{url:e,method:n,data:r,signal:i,cancelToken:a,timeout:o,onDownloadProgress:s,onUploadProgress:l,responseType:c,headers:f,withCredentials:u="same-origin",fetchOptions:d}=ZW(t);c=c?(c+"").toLowerCase():"text";let h=s1e([i,a&&a.toAbortSignal()],o),p;const g=h&&h.unsubscribe&&(()=>{h.unsubscribe()});let m;try{if(l&&d1e&&n!=="get"&&n!=="head"&&(m=await p1e(f,r))!==0){let S=new Request(e,{method:"POST",body:r,duplex:"half"}),T;if(lt.isFormData(r)&&(T=S.headers.get("content-type"))&&f.setContentType(T),S.body){const[_,D]=gL(m,Vw(mL(l)));r=yL(S.body,xL,_,D)}}lt.isString(u)||(u=u?"include":"omit");const y="credentials"in Request.prototype;p=new Request(e,{...d,signal:h,method:n.toUpperCase(),headers:f.normalize().toJSON(),body:r,duplex:"half",credentials:y?u:void 0});let v=await fetch(p,d);const x=J6&&(c==="stream"||c==="response");if(J6&&(s||x&&g)){const S={};["status","statusText","headers"].forEach(I=>{S[I]=v[I]});const T=lt.toFiniteNumber(v.headers.get("content-length")),[_,D]=s&&gL(T,Vw(mL(s),!0))||[];v=new Response(yL(v.body,xL,_,()=>{D&&D(),g&&g()}),S)}c=c||"text";let w=await Fw[lt.findKey(Fw,c)||"text"](v,t);return!x&&g&&g(),await new Promise((S,T)=>{YW(S,T,{data:w,headers:Is.from(v.headers),status:v.status,statusText:v.statusText,config:t,request:p})})}catch(y){throw g&&g(),y&&y.name==="TypeError"&&/Load failed|fetch/i.test(y.message)?Object.assign(new kn("Network Error",kn.ERR_NETWORK,t,p),{cause:y.cause||y}):kn.from(y,y&&y.code,t,p)}}),Z6={http:Ime,xhr:o1e,fetch:g1e};lt.forEach(Z6,(t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch{}Object.defineProperty(t,"adapterName",{value:e})}});const bL=t=>`- ${t}`,m1e=t=>lt.isFunction(t)||t===null||t===!1,tH={getAdapter:t=>{t=lt.isArray(t)?t:[t];const{length:e}=t;let n,r;const i={};for(let a=0;a<e;a++){n=t[a];let o;if(r=n,!m1e(n)&&(r=Z6[(o=String(n)).toLowerCase()],r===void 0))throw new kn(`Unknown adapter '${o}'`);if(r)break;i[o||"#"+a]=r}if(!r){const a=Object.entries(i).map(([s,l])=>`adapter ${s} `+(l===!1?"is not supported by the environment":"is not available in the build"));let o=e?a.length>1?`since :
`+a.map(bL).join(`
`):" "+bL(a[0]):"as no adapter specified";throw new kn("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return r},adapters:Z6};function uE(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new Fm(null,t)}function wL(t){return uE(t),t.headers=Is.from(t.headers),t.data=cE.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),tH.getAdapter(t.adapter||Ey.adapter)(t).then(function(r){return uE(t),r.data=cE.call(t,t.transformResponse,r),r.headers=Is.from(r.headers),r},function(r){return XW(r)||(uE(t),r&&r.response&&(r.response.data=cE.call(t,t.transformResponse,r.response),r.response.headers=Is.from(r.response.headers))),Promise.reject(r)})}const nH="1.11.0",_C={};["object","boolean","number","function","string","symbol"].forEach((t,e)=>{_C[t]=function(r){return typeof r===t||"a"+(e<1?"n ":" ")+t}});const CL={};_C.transitional=function(e,n,r){function i(a,o){return"[Axios v"+nH+"] Transitional option '"+a+"'"+o+(r?". "+r:"")}return(a,o,s)=>{if(e===!1)throw new kn(i(o," has been removed"+(n?" in "+n:"")),kn.ERR_DEPRECATED);return n&&!CL[o]&&(CL[o]=!0,console.warn(i(o," has been deprecated since v"+n+" and will be removed in the near future"))),e?e(a,o,s):!0}};_C.spelling=function(e){return(n,r)=>(console.warn(`${r} is likely a misspelling of ${e}`),!0)};function v1e(t,e,n){if(typeof t!="object")throw new kn("options must be an object",kn.ERR_BAD_OPTION_VALUE);const r=Object.keys(t);let i=r.length;for(;i-- >0;){const a=r[i],o=e[a];if(o){const s=t[a],l=s===void 0||o(s,a,t);if(l!==!0)throw new kn("option "+a+" must be "+l,kn.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new kn("Unknown option "+a,kn.ERR_BAD_OPTION)}}const Lb={assertOptions:v1e,validators:_C},Wc=Lb.validators;let Ch=class{constructor(e){this.defaults=e||{},this.interceptors={request:new hL,response:new hL}}async request(e,n){try{return await this._request(e,n)}catch(r){if(r instanceof Error){let i={};Error.captureStackTrace?Error.captureStackTrace(i):i=new Error;const a=i.stack?i.stack.replace(/^.+\n/,""):"";try{r.stack?a&&!String(r.stack).endsWith(a.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+a):r.stack=a}catch{}}throw r}}_request(e,n){typeof e=="string"?(n=n||{},n.url=e):n=e||{},n=Rh(this.defaults,n);const{transitional:r,paramsSerializer:i,headers:a}=n;r!==void 0&&Lb.assertOptions(r,{silentJSONParsing:Wc.transitional(Wc.boolean),forcedJSONParsing:Wc.transitional(Wc.boolean),clarifyTimeoutError:Wc.transitional(Wc.boolean)},!1),i!=null&&(lt.isFunction(i)?n.paramsSerializer={serialize:i}:Lb.assertOptions(i,{encode:Wc.function,serialize:Wc.function},!0)),n.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?n.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:n.allowAbsoluteUrls=!0),Lb.assertOptions(n,{baseUrl:Wc.spelling("baseURL"),withXsrfToken:Wc.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let o=a&&lt.merge(a.common,a[n.method]);a&&lt.forEach(["delete","get","head","post","put","patch","common"],p=>{delete a[p]}),n.headers=Is.concat(o,a);const s=[];let l=!0;this.interceptors.request.forEach(function(g){typeof g.runWhen=="function"&&g.runWhen(n)===!1||(l=l&&g.synchronous,s.unshift(g.fulfilled,g.rejected))});const c=[];this.interceptors.response.forEach(function(g){c.push(g.fulfilled,g.rejected)});let f,u=0,d;if(!l){const p=[wL.bind(this),void 0];for(p.unshift(...s),p.push(...c),d=p.length,f=Promise.resolve(n);u<d;)f=f.then(p[u++],p[u++]);return f}d=s.length;let h=n;for(u=0;u<d;){const p=s[u++],g=s[u++];try{h=p(h)}catch(m){g.call(this,m);break}}try{f=wL.call(this,h)}catch(p){return Promise.reject(p)}for(u=0,d=c.length;u<d;)f=f.then(c[u++],c[u++]);return f}getUri(e){e=Rh(this.defaults,e);const n=JW(e.baseURL,e.url,e.allowAbsoluteUrls);return HW(n,e.params,e.paramsSerializer)}};lt.forEach(["delete","get","head","options"],function(e){Ch.prototype[e]=function(n,r){return this.request(Rh(r||{},{method:e,url:n,data:(r||{}).data}))}});lt.forEach(["post","put","patch"],function(e){function n(r){return function(a,o,s){return this.request(Rh(s||{},{method:e,headers:r?{"Content-Type":"multipart/form-data"}:{},url:a,data:o}))}}Ch.prototype[e]=n(),Ch.prototype[e+"Form"]=n(!0)});let y1e=class rH{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(a){n=a});const r=this;this.promise.then(i=>{if(!r._listeners)return;let a=r._listeners.length;for(;a-- >0;)r._listeners[a](i);r._listeners=null}),this.promise.then=i=>{let a;const o=new Promise(s=>{r.subscribe(s),a=s}).then(i);return o.cancel=function(){r.unsubscribe(a)},o},e(function(a,o,s){r.reason||(r.reason=new Fm(a,o,s),n(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const n=this._listeners.indexOf(e);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const e=new AbortController,n=r=>{e.abort(r)};return this.subscribe(n),e.signal.unsubscribe=()=>this.unsubscribe(n),e.signal}static source(){let e;return{token:new rH(function(i){e=i}),cancel:e}}};function x1e(t){return function(n){return t.apply(null,n)}}function b1e(t){return lt.isObject(t)&&t.isAxiosError===!0}const Q6={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Q6).forEach(([t,e])=>{Q6[e]=t});function iH(t){const e=new Ch(t),n=NW(Ch.prototype.request,e);return lt.extend(n,Ch.prototype,e,{allOwnKeys:!0}),lt.extend(n,e,null,{allOwnKeys:!0}),n.create=function(i){return iH(Rh(t,i))},n}const ua=iH(Ey);ua.Axios=Ch;ua.CanceledError=Fm;ua.CancelToken=y1e;ua.isCancel=XW;ua.VERSION=nH;ua.toFormData=TC;ua.AxiosError=kn;ua.Cancel=ua.CanceledError;ua.all=function(e){return Promise.all(e)};ua.spread=x1e;ua.isAxiosError=b1e;ua.mergeConfig=Rh;ua.AxiosHeaders=Is;ua.formToJSON=t=>qW(lt.isHTMLForm(t)?new FormData(t):t);ua.getAdapter=tH.getAdapter;ua.HttpStatusCode=Q6;ua.default=ua;const{Axios:QHe,AxiosError:eKe,CanceledError:tKe,isCancel:nKe,CancelToken:rKe,VERSION:iKe,all:aKe,Cancel:oKe,isAxiosError:sKe,spread:lKe,toFormData:cKe,AxiosHeaders:uKe,HttpStatusCode:fKe,formToJSON:dKe,getAdapter:hKe,mergeConfig:pKe}=ua,Zo=ua.create({baseURL:"/api",timeout:1e4,headers:{"Content-Type":"application/json"}});Zo.interceptors.request.use(t=>{const e=localStorage.getItem("access_token");return e&&(t.headers.Authorization=`Bearer ${e}`),t},t=>Promise.reject(t));Zo.interceptors.response.use(t=>t,t=>(t.response?.status===401&&(localStorage.removeItem("access_token"),window.location.href="/"),Promise.reject(t)));const $a={get:(t,e)=>Zo.get(t,{params:e}).then(n=>n.data),post:(t,e,n)=>Zo.post(t,e,n).then(r=>r.data),put:(t,e)=>Zo.put(t,e).then(n=>n.data),delete:t=>Zo.delete(t).then(e=>e.data),upload:(t,e)=>{const n=new FormData;return n.append("file",e),Zo.post(t,n,{headers:{"Content-Type":"multipart/form-data"}}).then(r=>r.data)}},w1e=async t=>{const e=await $a.post("/auth/login",t);return e.success&&e.data?.access_token&&localStorage.setItem("access_token",e.data.access_token),e},C1e=async()=>$a.get("/auth/me"),S1e=async()=>{const t=await $a.post("/auth/logout");return localStorage.removeItem("access_token"),t},T1e=async t=>$a.post("/user/change-password",t),E1e=!1,_1e="AuthStore",jf=kge()($ge(zge((t,e)=>({accessToken:"",userInfo:void 0,isGettingUserInfo:!1,isAuthenticated:()=>{const{accessToken:n,userInfo:r}=e();return!!(n||localStorage.getItem("access_token"))&&!!r},setAccessToken:n=>{const{getUserInfo:r}=e();t({accessToken:n}),n?(localStorage.setItem("access_token",n),r()):localStorage.removeItem("access_token")},setUserInfo:n=>{t({userInfo:n})},getUserInfo:async()=>{const{accessToken:n,logout:r,isGettingUserInfo:i}=e();if(!i&&!(!n&&!localStorage.getItem("access_token"))){t({isGettingUserInfo:!0});try{const a=await C1e();if(!a.success){Nt({color:"danger",description:a.message}),await r();return}a.data?.user&&t({userInfo:a.data.user})}catch(a){console.error("Get user info failed:",a),await r()}finally{t({isGettingUserInfo:!1})}}},logout:async()=>{try{await S1e()}catch(n){console.error("Logout API failed:",n)}finally{e().clearAuth()}},clearAuth:()=>{t({accessToken:"",userInfo:void 0,isGettingUserInfo:!1}),localStorage.removeItem("access_token")}}),{name:_1e,partialize:t=>({accessToken:t.accessToken})}),{enabled:E1e,name:"AuthStore"})),D1e=()=>{const{logout:t,userInfo:e}=jf(),n=_u(),r=Ec(),[i,a]=H.useState(!1),[o,s]=H.useState(""),[l,c]=H.useState(""),[f,u]=H.useState(""),[d,h]=H.useState(!1),p=n.pathname.startsWith("/detail/"),g=n.pathname==="/admin",m=n.pathname==="/upload",y=n.pathname.startsWith("/edit/"),v=e?.role===1,x=e?.role===2;e?.role;const w=v||x,S=!!e?.user_id,T=()=>{Nt({color:"success",description:"已退出登录"}),t(),r("/")},_=()=>{r(-1)},D=()=>{r("/admin")},I=()=>{r("/upload")},R=()=>{r("/list")},O=async()=>{if(!o||!l||!f){Nt({color:"danger",description:"请填写所有密码字段"});return}if(l!==f){Nt({color:"danger",description:"新密码与确认密码不一致"});return}if(l.length<6){Nt({color:"danger",description:"新密码长度至少6位"});return}h(!0);try{const P=await T1e({current_password:o,new_password:l,new_password_confirmation:f});P.success?(Nt({color:"success",description:"密码修改成功"}),a(!1),s(""),c(""),u("")):Nt({color:"danger",description:P.message||"密码修改失败"})}catch{Nt({color:"danger",description:"网络错误，请重试"})}finally{h(!1)}};return j.jsxs("header",{className:"bg-gray-800 shadow-lg fixed top-0 left-0 right-0 z-50",children:[j.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-6",children:j.jsxs("div",{className:"flex justify-between items-center h-16",children:[j.jsxs("div",{className:"flex items-center space-x-3",children:[(p||g||m||y)&&j.jsx("button",{onClick:p?_:R,className:"group flex cursor-pointer items-center justify-center w-9 h-9 bg-gray-700 hover:bg-gray-600 text-gray-300 hover:text-white rounded-lg transition-all duration-200",children:j.jsx("svg",{className:"w-5 h-5 transition-transform duration-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p?j.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"}):j.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})})}),j.jsxs("div",{className:"flex items-center space-x-2 cursor-pointer",onClick:R,children:[j.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-blue-500 to-purple-600 rounded-lg flex items-center justify-center",children:j.jsx("span",{className:"text-white text-sm font-bold",children:"智"})}),j.jsx("h1",{className:"text-xl font-bold text-white",children:"医学图像信息管理与标注系统"})]})]}),j.jsxs("div",{className:"flex items-center space-x-6",children:[S?j.jsxs("div",{className:"flex items-center space-x-3",children:[j.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center",children:j.jsx("span",{className:"text-white text-sm font-semibold",children:e?.username?.charAt(0)||"U"})}),j.jsxs("div",{className:"flex flex-col",children:[j.jsx("span",{className:"text-white font-medium text-sm",children:e?.username||"用户"}),j.jsx("span",{className:"text-gray-400 text-xs",children:e?.role_name||""})]})]}):j.jsxs("div",{className:"flex items-center space-x-3",children:[j.jsx("div",{className:"w-8 h-8 bg-gray-600 rounded-full flex items-center justify-center",children:j.jsx("span",{className:"text-white text-sm font-semibold",children:"?"})}),j.jsxs("div",{className:"flex flex-col",children:[j.jsx("span",{className:"text-gray-300 font-medium text-sm",children:"未登录"}),j.jsx("span",{className:"text-gray-500 text-xs",children:"请先登录"})]})]}),S&&j.jsxs("div",{className:"flex items-center space-x-2",children:[w&&!m&&j.jsxs("button",{onClick:I,className:"group cursor-pointer flex items-center space-x-2 px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-all duration-200 ease-in-out transform hover:scale-105",children:[j.jsx("svg",{className:"w-4 h-4 transition-transform duration-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:j.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),j.jsx("span",{className:"text-sm font-medium",children:"上传"})]}),v&&!g&&j.jsxs("button",{onClick:D,className:"group cursor-pointer flex items-center space-x-2 px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg transition-all duration-200 ease-in-out transform hover:scale-105",children:[j.jsx("svg",{className:"w-4 h-4 transition-transform duration-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:j.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"})}),j.jsx("span",{className:"text-sm font-medium",children:"管理端"})]}),j.jsxs("button",{onClick:()=>a(!0),className:"group relative flex items-center space-x-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-all duration-200 ease-in-out transform hover:scale-105",children:[j.jsx("svg",{className:"w-4 h-4 transition-transform duration-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:j.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"})}),j.jsx("span",{className:"text-sm font-medium",children:"修改密码"})]}),j.jsxs("button",{onClick:T,className:"group relative flex items-center space-x-2 px-4 py-2 bg-gray-700 hover:bg-red-600 text-gray-300 hover:text-white rounded-lg transition-all duration-200 ease-in-out transform hover:scale-105",children:[j.jsx("svg",{className:"w-4 h-4 transition-transform duration-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:j.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),j.jsx("span",{className:"text-sm font-medium",children:"退出"})]})]})]})]})}),i&&j.jsx("div",{className:"fixed inset-0 bg-black/70 bg-opacity-50 flex items-center justify-center z-50",children:j.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[j.jsxs("div",{className:"flex justify-between items-center mb-4",children:[j.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"修改密码"}),j.jsx("button",{onClick:()=>a(!1),className:"text-gray-400 hover:text-gray-600",children:j.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:j.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),j.jsxs("div",{className:"space-y-4",children:[j.jsxs("div",{children:[j.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"当前密码"}),j.jsx("input",{type:"password",value:o,onChange:P=>s(P.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"请输入当前密码"})]}),j.jsxs("div",{children:[j.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"新密码"}),j.jsx("input",{type:"password",value:l,onChange:P=>c(P.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"请输入新密码"})]}),j.jsxs("div",{children:[j.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"确认新密码"}),j.jsx("input",{type:"password",value:f,onChange:P=>u(P.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"请再次输入新密码"})]})]}),j.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[j.jsx("button",{onClick:()=>a(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800 transition-colors",disabled:d,children:"取消"}),j.jsx("button",{onClick:O,disabled:d,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:d?"修改中...":"确认修改"})]})]})})]})},O1e=()=>j.jsx(j.Fragment,{});function Pp({children:t}){return j.jsxs("div",{className:"min-h-screen flex w-full flex-col",children:[j.jsx(D1e,{}),j.jsx("main",{className:"flex-1 pt-16",children:t}),j.jsx(O1e,{})]})}function M1e(t,e){var n,r;let i=`[data-key="${CSS.escape(String(e))}"]`,a=(n=t.current)===null||n===void 0?void 0:n.dataset.collection;return a&&(i=`[data-collection="${CSS.escape(a)}"]${i}`),(r=t.current)===null||r===void 0?void 0:r.querySelector(i)}const I1e=1e3;function R1e(t){let{keyboardDelegate:e,selectionManager:n,onTypeSelect:r}=t,i=H.useRef({search:"",timeout:void 0}).current,a=o=>{let s=P1e(o.key);if(!(!s||o.ctrlKey||o.metaKey||!o.currentTarget.contains(o.target)||i.search.length===0&&s===" ")){if(s===" "&&i.search.trim().length>0&&(o.preventDefault(),"continuePropagation"in o||o.stopPropagation()),i.search+=s,e.getKeyForSearch!=null){let l=e.getKeyForSearch(i.search,n.focusedKey);l==null&&(l=e.getKeyForSearch(i.search)),l!=null&&(n.setFocusedKey(l),r&&r(l))}clearTimeout(i.timeout),i.timeout=setTimeout(()=>{i.search=""},I1e)}};return{typeSelectProps:{onKeyDownCapture:e.getKeyForSearch?a:void 0}}}function P1e(t){return t.length===1||!/^[A-Z]/i.test(t)?t:""}let SL=class{getItemRect(e){let n=this.ref.current;if(!n)return null;let r=e!=null?M1e(this.ref,e):null;if(!r)return null;let i=n.getBoundingClientRect(),a=r.getBoundingClientRect();return{x:a.left-i.left+n.scrollLeft,y:a.top-i.top+n.scrollTop,width:a.width,height:a.height}}getContentSize(){let e=this.ref.current;var n,r;return{width:(n=e?.scrollWidth)!==null&&n!==void 0?n:0,height:(r=e?.scrollHeight)!==null&&r!==void 0?r:0}}getVisibleRect(){let e=this.ref.current;var n,r,i,a;return{x:(n=e?.scrollLeft)!==null&&n!==void 0?n:0,y:(r=e?.scrollTop)!==null&&r!==void 0?r:0,width:(i=e?.offsetWidth)!==null&&i!==void 0?i:0,height:(a=e?.offsetHeight)!==null&&a!==void 0?a:0}}constructor(e){this.ref=e}},A1e=class{isDisabled(e){var n;return this.disabledBehavior==="all"&&(((n=e.props)===null||n===void 0?void 0:n.isDisabled)||this.disabledKeys.has(e.key))}findNextNonDisabled(e,n){let r=e;for(;r!=null;){let i=this.collection.getItem(r);if(i?.type==="item"&&!this.isDisabled(i))return r;r=n(r)}return null}getNextKey(e){let n=e;return n=this.collection.getKeyAfter(n),this.findNextNonDisabled(n,r=>this.collection.getKeyAfter(r))}getPreviousKey(e){let n=e;return n=this.collection.getKeyBefore(n),this.findNextNonDisabled(n,r=>this.collection.getKeyBefore(r))}findKey(e,n,r){let i=e,a=this.layoutDelegate.getItemRect(i);if(!a||i==null)return null;let o=a;do{if(i=n(i),i==null)break;a=this.layoutDelegate.getItemRect(i)}while(a&&r(o,a)&&i!=null);return i}isSameRow(e,n){return e.y===n.y||e.x!==n.x}isSameColumn(e,n){return e.x===n.x||e.y!==n.y}getKeyBelow(e){return this.layout==="grid"&&this.orientation==="vertical"?this.findKey(e,n=>this.getNextKey(n),this.isSameRow):this.getNextKey(e)}getKeyAbove(e){return this.layout==="grid"&&this.orientation==="vertical"?this.findKey(e,n=>this.getPreviousKey(n),this.isSameRow):this.getPreviousKey(e)}getNextColumn(e,n){return n?this.getPreviousKey(e):this.getNextKey(e)}getKeyRightOf(e){let n=this.direction==="ltr"?"getKeyRightOf":"getKeyLeftOf";return this.layoutDelegate[n]?(e=this.layoutDelegate[n](e),this.findNextNonDisabled(e,r=>this.layoutDelegate[n](r))):this.layout==="grid"?this.orientation==="vertical"?this.getNextColumn(e,this.direction==="rtl"):this.findKey(e,r=>this.getNextColumn(r,this.direction==="rtl"),this.isSameColumn):this.orientation==="horizontal"?this.getNextColumn(e,this.direction==="rtl"):null}getKeyLeftOf(e){let n=this.direction==="ltr"?"getKeyLeftOf":"getKeyRightOf";return this.layoutDelegate[n]?(e=this.layoutDelegate[n](e),this.findNextNonDisabled(e,r=>this.layoutDelegate[n](r))):this.layout==="grid"?this.orientation==="vertical"?this.getNextColumn(e,this.direction==="ltr"):this.findKey(e,r=>this.getNextColumn(r,this.direction==="ltr"),this.isSameColumn):this.orientation==="horizontal"?this.getNextColumn(e,this.direction==="ltr"):null}getFirstKey(){let e=this.collection.getFirstKey();return this.findNextNonDisabled(e,n=>this.collection.getKeyAfter(n))}getLastKey(){let e=this.collection.getLastKey();return this.findNextNonDisabled(e,n=>this.collection.getKeyBefore(n))}getKeyPageAbove(e){let n=this.ref.current,r=this.layoutDelegate.getItemRect(e);if(!r)return null;if(n&&!sN(n))return this.getFirstKey();let i=e;if(this.orientation==="horizontal"){let a=Math.max(0,r.x+r.width-this.layoutDelegate.getVisibleRect().width);for(;r&&r.x>a&&i!=null;)i=this.getKeyAbove(i),r=i==null?null:this.layoutDelegate.getItemRect(i)}else{let a=Math.max(0,r.y+r.height-this.layoutDelegate.getVisibleRect().height);for(;r&&r.y>a&&i!=null;)i=this.getKeyAbove(i),r=i==null?null:this.layoutDelegate.getItemRect(i)}return i??this.getFirstKey()}getKeyPageBelow(e){let n=this.ref.current,r=this.layoutDelegate.getItemRect(e);if(!r)return null;if(n&&!sN(n))return this.getLastKey();let i=e;if(this.orientation==="horizontal"){let a=Math.min(this.layoutDelegate.getContentSize().width,r.y-r.width+this.layoutDelegate.getVisibleRect().width);for(;r&&r.x<a&&i!=null;)i=this.getKeyBelow(i),r=i==null?null:this.layoutDelegate.getItemRect(i)}else{let a=Math.min(this.layoutDelegate.getContentSize().height,r.y-r.height+this.layoutDelegate.getVisibleRect().height);for(;r&&r.y<a&&i!=null;)i=this.getKeyBelow(i),r=i==null?null:this.layoutDelegate.getItemRect(i)}return i??this.getLastKey()}getKeyForSearch(e,n){if(!this.collator)return null;let r=this.collection,i=n||this.getFirstKey();for(;i!=null;){let a=r.getItem(i);if(!a)return null;let o=a.textValue.slice(0,e.length);if(a.textValue&&this.collator.compare(o,e)===0)return i;i=this.getNextKey(i)}return null}constructor(...e){if(e.length===1){let n=e[0];this.collection=n.collection,this.ref=n.ref,this.collator=n.collator,this.disabledKeys=n.disabledKeys||new Set,this.disabledBehavior=n.disabledBehavior||"all",this.orientation=n.orientation||"vertical",this.direction=n.direction,this.layout=n.layout||"stack",this.layoutDelegate=n.layoutDelegate||new SL(n.ref)}else this.collection=e[0],this.disabledKeys=e[1],this.ref=e[2],this.collator=e[3],this.layout="stack",this.orientation="vertical",this.disabledBehavior="all",this.layoutDelegate=new SL(this.ref);this.layout==="stack"&&this.orientation==="vertical"&&(this.getKeyLeftOf=void 0,this.getKeyRightOf=void 0)}};var TL={ease:[.36,.66,.4,1]},aH={scaleSpringOpacity:{initial:{opacity:0,transform:"scale(0.8)"},enter:{opacity:1,transform:"scale(1)",transition:{type:"spring",bounce:0,duration:.3}},exit:{opacity:0,transform:"scale(0.96)",transition:{type:"easeOut",bounce:0,duration:.15}}},fade:{enter:{opacity:1,transition:{duration:.4,ease:TL.ease}},exit:{opacity:0,transition:{duration:.3,ease:TL.ease}}}};class dc extends Set{constructor(e,n,r){super(e),e instanceof dc?(this.anchorKey=n??e.anchorKey,this.currentKey=r??e.currentKey):(this.anchorKey=n??null,this.currentKey=r??null)}}function N1e(t,e){if(t.size!==e.size)return!1;for(let n of t)if(!e.has(n))return!1;return!0}function oH(t){let{selectionMode:e="none",disallowEmptySelection:n=!1,allowDuplicateSelectionEvents:r,selectionBehavior:i="toggle",disabledBehavior:a="all"}=t,o=H.useRef(!1),[,s]=H.useState(!1),l=H.useRef(null),c=H.useRef(null),[,f]=H.useState(null),u=H.useMemo(()=>EL(t.selectedKeys),[t.selectedKeys]),d=H.useMemo(()=>EL(t.defaultSelectedKeys,new dc),[t.defaultSelectedKeys]),[h,p]=Om(u,d,t.onSelectionChange),g=H.useMemo(()=>t.disabledKeys?new Set(t.disabledKeys):new Set,[t.disabledKeys]),[m,y]=H.useState(i);i==="replace"&&m==="toggle"&&typeof h=="object"&&h.size===0&&y("replace");let v=H.useRef(i);return H.useEffect(()=>{i!==v.current&&(y(i),v.current=i)},[i]),{selectionMode:e,disallowEmptySelection:n,selectionBehavior:m,setSelectionBehavior:y,get isFocused(){return o.current},setFocused(x){o.current=x,s(x)},get focusedKey(){return l.current},get childFocusStrategy(){return c.current},setFocusedKey(x,w="first"){l.current=x,c.current=w,f(x)},selectedKeys:h,setSelectedKeys(x){(r||!N1e(x,h))&&p(x)},disabledKeys:g,disabledBehavior:a}}function EL(t,e){return t?t==="all"?"all":new dc(t):e}class L1e{build(e,n){return this.context=n,_L(()=>this.iterateCollection(e))}*iterateCollection(e){let{children:n,items:r}=e;if(un.isValidElement(n)&&n.type===un.Fragment)yield*this.iterateCollection({children:n.props.children,items:r});else if(typeof n=="function"){if(!r)throw new Error("props.children was a function but props.items is missing");let i=0;for(let a of r)yield*this.getFullNode({value:a,index:i},{renderer:n}),i++}else{let i=[];un.Children.forEach(n,o=>{o&&i.push(o)});let a=0;for(let o of i){let s=this.getFullNode({element:o,index:a},{});for(let l of s)a++,yield l}}}getKey(e,n,r,i){if(e.key!=null)return e.key;if(n.type==="cell"&&n.key!=null)return`${i}${n.key}`;let a=n.value;if(a!=null){var o;let s=(o=a.key)!==null&&o!==void 0?o:a.id;if(s==null)throw new Error("No key found for item");return s}return i?`${i}.${n.index}`:`$.${n.index}`}getChildState(e,n){return{renderer:n.renderer||e.renderer}}*getFullNode(e,n,r,i){if(un.isValidElement(e.element)&&e.element.type===un.Fragment){let m=[];un.Children.forEach(e.element.props.children,v=>{m.push(v)});var a;let y=(a=e.index)!==null&&a!==void 0?a:0;for(const v of m)yield*this.getFullNode({element:v,index:y++},n,r,i);return}let o=e.element;if(!o&&e.value&&n&&n.renderer){let m=this.cache.get(e.value);if(m&&(!m.shouldInvalidate||!m.shouldInvalidate(this.context))){m.index=e.index,m.parentKey=i?i.key:null,yield m;return}o=n.renderer(e.value)}if(un.isValidElement(o)){let m=o.type;if(typeof m!="function"&&typeof m.getCollectionNode!="function"){let w=o.type;throw new Error(`Unknown element <${w}> in collection.`)}let y=m.getCollectionNode(o.props,this.context);var s;let v=(s=e.index)!==null&&s!==void 0?s:0,x=y.next();for(;!x.done&&x.value;){let w=x.value;e.index=v;var l;let S=(l=w.key)!==null&&l!==void 0?l:null;S==null&&(S=w.element?null:this.getKey(o,e,n,r));let _=[...this.getFullNode({...w,key:S,index:v,wrapper:k1e(e.wrapper,w.wrapper)},this.getChildState(n,w),r?`${r}${o.key}`:o.key,i)];for(let D of _){var c,f;D.value=(f=(c=w.value)!==null&&c!==void 0?c:e.value)!==null&&f!==void 0?f:null,D.value&&this.cache.set(D.value,D);var u;if(e.type&&D.type!==e.type)throw new Error(`Unsupported type <${fE(D.type)}> in <${fE((u=i?.type)!==null&&u!==void 0?u:"unknown parent type")}>. Only <${fE(e.type)}> is supported.`);v++,yield D}x=y.next(_)}return}if(e.key==null||e.type==null)return;let d=this;var h,p;let g={type:e.type,props:e.props,key:e.key,parentKey:i?i.key:null,value:(h=e.value)!==null&&h!==void 0?h:null,level:i?i.level+1:0,index:e.index,rendered:e.rendered,textValue:(p=e.textValue)!==null&&p!==void 0?p:"","aria-label":e["aria-label"],wrapper:e.wrapper,shouldInvalidate:e.shouldInvalidate,hasChildNodes:e.hasChildNodes||!1,childNodes:_L(function*(){if(!e.hasChildNodes||!e.childNodes)return;let m=0;for(let y of e.childNodes()){y.key!=null&&(y.key=`${g.key}${y.key}`);let v=d.getFullNode({...y,index:m},d.getChildState(n,y),g.key,g);for(let x of v)m++,yield x}})};yield g}constructor(){this.cache=new WeakMap}}function _L(t){let e=[],n=null;return{*[Symbol.iterator](){for(let r of e)yield r;n||(n=t());for(let r of n)e.push(r),yield r}}}function k1e(t,e){if(t&&e)return n=>t(e(n));if(t)return t;if(e)return e}function fE(t){return t[0].toUpperCase()+t.slice(1)}function sH(t,e,n){let r=H.useMemo(()=>new L1e,[]),{children:i,items:a,collection:o}=t;return H.useMemo(()=>{if(o)return o;let l=r.build({children:i,items:a},n);return e(l)},[r,i,a,o,n,e])}function lH(t,e){return typeof e.getChildren=="function"?e.getChildren(t.key):t.childNodes}function V1e(t){return F1e(t)}function F1e(t,e){for(let n of t)return n}function dE(t,e,n){if(e.parentKey===n.parentKey)return e.index-n.index;let r=[...DL(t,e),e],i=[...DL(t,n),n],a=r.slice(0,i.length).findIndex((o,s)=>o!==i[s]);return a!==-1?(e=r[a],n=i[a],e.index-n.index):r.findIndex(o=>o===n)>=0?1:(i.findIndex(o=>o===e)>=0,-1)}function DL(t,e){let n=[],r=e;for(;r?.parentKey!=null;)r=t.getItem(r.parentKey),r&&n.unshift(r);return n}const OL=new WeakMap;function U1e(t){let e=OL.get(t);if(e!=null)return e;let n=0,r=i=>{for(let a of i)a.type==="section"?r(lH(a,t)):a.type==="item"&&n++};return r(t),OL.set(t,n),n}class DC{get selectionMode(){return this.state.selectionMode}get disallowEmptySelection(){return this.state.disallowEmptySelection}get selectionBehavior(){return this.state.selectionBehavior}setSelectionBehavior(e){this.state.setSelectionBehavior(e)}get isFocused(){return this.state.isFocused}setFocused(e){this.state.setFocused(e)}get focusedKey(){return this.state.focusedKey}get childFocusStrategy(){return this.state.childFocusStrategy}setFocusedKey(e,n){(e==null||this.collection.getItem(e))&&this.state.setFocusedKey(e,n)}get selectedKeys(){return this.state.selectedKeys==="all"?new Set(this.getSelectAllKeys()):this.state.selectedKeys}get rawSelection(){return this.state.selectedKeys}isSelected(e){if(this.state.selectionMode==="none")return!1;let n=this.getKey(e);return n==null?!1:this.state.selectedKeys==="all"?this.canSelectItem(n):this.state.selectedKeys.has(n)}get isEmpty(){return this.state.selectedKeys!=="all"&&this.state.selectedKeys.size===0}get isSelectAll(){if(this.isEmpty)return!1;if(this.state.selectedKeys==="all")return!0;if(this._isSelectAll!=null)return this._isSelectAll;let e=this.getSelectAllKeys(),n=this.state.selectedKeys;return this._isSelectAll=e.every(r=>n.has(r)),this._isSelectAll}get firstSelectedKey(){let e=null;for(let r of this.state.selectedKeys){let i=this.collection.getItem(r);(!e||i&&dE(this.collection,i,e)<0)&&(e=i)}var n;return(n=e?.key)!==null&&n!==void 0?n:null}get lastSelectedKey(){let e=null;for(let r of this.state.selectedKeys){let i=this.collection.getItem(r);(!e||i&&dE(this.collection,i,e)>0)&&(e=i)}var n;return(n=e?.key)!==null&&n!==void 0?n:null}get disabledKeys(){return this.state.disabledKeys}get disabledBehavior(){return this.state.disabledBehavior}extendSelection(e){if(this.selectionMode==="none")return;if(this.selectionMode==="single"){this.replaceSelection(e);return}let n=this.getKey(e);if(n==null)return;let r;if(this.state.selectedKeys==="all")r=new dc([n],n,n);else{let o=this.state.selectedKeys;var i;let s=(i=o.anchorKey)!==null&&i!==void 0?i:n;r=new dc(o,s,n);var a;for(let l of this.getKeyRange(s,(a=o.currentKey)!==null&&a!==void 0?a:n))r.delete(l);for(let l of this.getKeyRange(n,s))this.canSelectItem(l)&&r.add(l)}this.state.setSelectedKeys(r)}getKeyRange(e,n){let r=this.collection.getItem(e),i=this.collection.getItem(n);return r&&i?dE(this.collection,r,i)<=0?this.getKeyRangeInternal(e,n):this.getKeyRangeInternal(n,e):[]}getKeyRangeInternal(e,n){var r;if(!((r=this.layoutDelegate)===null||r===void 0)&&r.getKeyRange)return this.layoutDelegate.getKeyRange(e,n);let i=[],a=e;for(;a!=null;){let o=this.collection.getItem(a);if(o&&(o.type==="item"||o.type==="cell"&&this.allowsCellSelection)&&i.push(a),a===n)return i;a=this.collection.getKeyAfter(a)}return[]}getKey(e){let n=this.collection.getItem(e);if(!n||n.type==="cell"&&this.allowsCellSelection)return e;for(;n&&n.type!=="item"&&n.parentKey!=null;)n=this.collection.getItem(n.parentKey);return!n||n.type!=="item"?null:n.key}toggleSelection(e){if(this.selectionMode==="none")return;if(this.selectionMode==="single"&&!this.isSelected(e)){this.replaceSelection(e);return}let n=this.getKey(e);if(n==null)return;let r=new dc(this.state.selectedKeys==="all"?this.getSelectAllKeys():this.state.selectedKeys);r.has(n)?r.delete(n):this.canSelectItem(n)&&(r.add(n),r.anchorKey=n,r.currentKey=n),!(this.disallowEmptySelection&&r.size===0)&&this.state.setSelectedKeys(r)}replaceSelection(e){if(this.selectionMode==="none")return;let n=this.getKey(e);if(n==null)return;let r=this.canSelectItem(n)?new dc([n],n,n):new dc;this.state.setSelectedKeys(r)}setSelectedKeys(e){if(this.selectionMode==="none")return;let n=new dc;for(let r of e){let i=this.getKey(r);if(i!=null&&(n.add(i),this.selectionMode==="single"))break}this.state.setSelectedKeys(n)}getSelectAllKeys(){let e=[],n=r=>{for(;r!=null;){if(this.canSelectItem(r)){var i;let o=this.collection.getItem(r);o?.type==="item"&&e.push(r);var a;o?.hasChildNodes&&(this.allowsCellSelection||o.type!=="item")&&n((a=(i=V1e(lH(o,this.collection)))===null||i===void 0?void 0:i.key)!==null&&a!==void 0?a:null)}r=this.collection.getKeyAfter(r)}};return n(this.collection.getFirstKey()),e}selectAll(){!this.isSelectAll&&this.selectionMode==="multiple"&&this.state.setSelectedKeys("all")}clearSelection(){!this.disallowEmptySelection&&(this.state.selectedKeys==="all"||this.state.selectedKeys.size>0)&&this.state.setSelectedKeys(new dc)}toggleSelectAll(){this.isSelectAll?this.clearSelection():this.selectAll()}select(e,n){this.selectionMode!=="none"&&(this.selectionMode==="single"?this.isSelected(e)&&!this.disallowEmptySelection?this.toggleSelection(e):this.replaceSelection(e):this.selectionBehavior==="toggle"||n&&(n.pointerType==="touch"||n.pointerType==="virtual")?this.toggleSelection(e):this.replaceSelection(e))}isSelectionEqual(e){if(e===this.state.selectedKeys)return!0;let n=this.selectedKeys;if(e.size!==n.size)return!1;for(let r of e)if(!n.has(r))return!1;for(let r of n)if(!e.has(r))return!1;return!0}canSelectItem(e){var n;if(this.state.selectionMode==="none"||this.state.disabledKeys.has(e))return!1;let r=this.collection.getItem(e);return!(!r||!(r==null||(n=r.props)===null||n===void 0)&&n.isDisabled||r.type==="cell"&&!this.allowsCellSelection)}isDisabled(e){var n,r;return this.state.disabledBehavior==="all"&&(this.state.disabledKeys.has(e)||!!(!((r=this.collection.getItem(e))===null||r===void 0||(n=r.props)===null||n===void 0)&&n.isDisabled))}isLink(e){var n,r;return!!(!((r=this.collection.getItem(e))===null||r===void 0||(n=r.props)===null||n===void 0)&&n.href)}getItemProps(e){var n;return(n=this.collection.getItem(e))===null||n===void 0?void 0:n.props}withCollection(e){return new DC(e,this.state,{allowsCellSelection:this.allowsCellSelection,layoutDelegate:this.layoutDelegate||void 0})}constructor(e,n,r){this.collection=e,this.state=n;var i;this.allowsCellSelection=(i=r?.allowsCellSelection)!==null&&i!==void 0?i:!1,this._isSelectAll=null,this.layoutDelegate=r?.layoutDelegate||null}}function B1e(t){let e=Lo(t,{enabled:typeof t.elementType=="string"}),n;return t.orientation==="vertical"&&(n="vertical"),t.elementType!=="hr"?{separatorProps:{...e,role:"separator","aria-orientation":n}}:{separatorProps:e}}function $1e(t){const{as:e,className:n,orientation:r,...i}=t;let a=e||"hr";a==="hr"&&r==="vertical"&&(a="div");const{separatorProps:o}=B1e({elementType:typeof a=="string"?a:"hr",orientation:r}),s=H.useMemo(()=>Bpe({orientation:r,className:n}),[r,n]),l=H.useCallback((c={})=>({className:s,role:"separator","data-orientation":r,...o,...i,...c}),[s,r,o,i]);return{Component:a,getDividerProps:l}}var cH=Qi((t,e)=>{const{Component:n,getDividerProps:r}=$1e({...t});return j.jsx(n,{ref:e,...r()})});cH.displayName="HeroUI.Divider";var G1e=cH;function uH(t){return null}uH.getCollectionNode=function*(e,n){let{childItems:r,title:i,children:a}=e,o=e.title||e.children,s=e.textValue||(typeof o=="string"?o:"")||e["aria-label"]||"";!s&&n?.suppressTextValueWarning,yield{type:"item",props:e,rendered:o,textValue:s,"aria-label":e["aria-label"],hasChildNodes:j1e(e),*childNodes(){if(r)for(let l of r)yield{type:"item",value:l};else if(i){let l=[];un.Children.forEach(a,c=>{l.push({type:"item",element:c})}),yield*l}}}};function j1e(t){return t.hasChildItems!=null?t.hasChildItems:!!(t.childItems||t.title&&un.Children.count(t.children)>0)}let fH=uH;var z1e=t=>{const e={top:{originY:1},bottom:{originY:0},left:{originX:1},right:{originX:0},"top-start":{originX:0,originY:1},"top-end":{originX:1,originY:1},"bottom-start":{originX:0,originY:0},"bottom-end":{originX:1,originY:0},"right-start":{originX:0,originY:0},"right-end":{originX:0,originY:1},"left-start":{originX:1,originY:0},"left-end":{originX:1,originY:1}};return e?.[t]||{}},W1e=t=>({top:"top",bottom:"bottom",left:"left",right:"right","top-start":"top start","top-end":"top end","bottom-start":"bottom start","bottom-end":"bottom end","left-start":"left top","left-end":"left bottom","right-start":"right top","right-end":"right bottom"})[t],H1e=(t,e)=>{if(e.includes("-")){const[n]=e.split("-");if(n.includes(t))return!1}return!0},ML=(t,e)=>{if(e.includes("-")){const[,n]=e.split("-");return`${t}-${n}`}return t},Z1=new WeakMap,Ss=[];function K1e(t,e=document.body){let n=new Set(t),r=new Set,i=l=>{for(let d of l.querySelectorAll("[data-live-announcer], [data-react-aria-top-layer]"))n.add(d);let c=d=>{if(n.has(d)||d.parentElement&&r.has(d.parentElement)&&d.parentElement.getAttribute("role")!=="row")return NodeFilter.FILTER_REJECT;for(let h of n)if(d.contains(h))return NodeFilter.FILTER_SKIP;return NodeFilter.FILTER_ACCEPT},f=document.createTreeWalker(l,NodeFilter.SHOW_ELEMENT,{acceptNode:c}),u=c(l);if(u===NodeFilter.FILTER_ACCEPT&&a(l),u!==NodeFilter.FILTER_REJECT){let d=f.nextNode();for(;d!=null;)a(d),d=f.nextNode()}},a=l=>{var c;let f=(c=Z1.get(l))!=null?c:0;l.getAttribute("aria-hidden")==="true"&&f===0||(f===0&&l.setAttribute("aria-hidden","true"),r.add(l),Z1.set(l,f+1))};Ss.length&&Ss[Ss.length-1].disconnect(),i(e);let o=new MutationObserver(l=>{for(let c of l)if(!(c.type!=="childList"||c.addedNodes.length===0)&&![...n,...r].some(f=>f.contains(c.target))){for(let f of c.removedNodes)f instanceof Element&&(n.delete(f),r.delete(f));for(let f of c.addedNodes)(f instanceof HTMLElement||f instanceof SVGElement)&&(f.dataset.liveAnnouncer==="true"||f.dataset.reactAriaTopLayer==="true")?n.add(f):f instanceof Element&&i(f)}});o.observe(e,{childList:!0,subtree:!0});let s={visibleNodes:n,hiddenNodes:r,observe(){o.observe(e,{childList:!0,subtree:!0})},disconnect(){o.disconnect()}};return Ss.push(s),()=>{o.disconnect();for(let l of r){let c=Z1.get(l);c!=null&&(c===1?(l.removeAttribute("aria-hidden"),Z1.delete(l)):Z1.set(l,c-1))}s===Ss[Ss.length-1]?(Ss.pop(),Ss.length&&Ss[Ss.length-1].observe()):Ss.splice(Ss.indexOf(s),1)}}function q1e(t){let e=Ss[Ss.length-1];if(e&&!e.visibleNodes.has(t))return e.visibleNodes.add(t),()=>{e.visibleNodes.delete(t)}}var _D=globalThis?.document?H.useLayoutEffect:H.useEffect,[vKe,X1e]=tC({name:"ButtonGroupContext",strict:!1});function DD(t,e){let{elementType:n="button",isDisabled:r,onPress:i,onPressStart:a,onPressEnd:o,onPressUp:s,onPressChange:l,preventFocusOnPress:c,allowFocusWhenDisabled:f,onClick:u,href:d,target:h,rel:p,type:g="button",allowTextSelectionOnPress:m}=t,y;n==="button"?y={type:g,disabled:r}:y={role:"button",href:n==="a"&&!r?d:void 0,target:n==="a"?h:void 0,type:n==="input"?g:void 0,disabled:n==="input"?r:void 0,"aria-disabled":!r||n==="input"?void 0:r,rel:n==="a"?p:void 0};let{pressProps:v,isPressed:x}=g0({onClick:u,onPressStart:a,onPressEnd:o,onPressUp:s,onPressChange:l,onPress:i,isDisabled:r,preventFocusOnPress:c,allowTextSelectionOnPress:m,ref:e}),{focusableProps:w}=yC(t,e);f&&(w.tabIndex=r?-1:w.tabIndex);let S=P2(w,v,pj(t,{labelable:!0}));return{isPressed:x,buttonProps:P2(y,S,{"aria-haspopup":t["aria-haspopup"],"aria-expanded":t["aria-expanded"],"aria-controls":t["aria-controls"],"aria-pressed":t["aria-pressed"],"aria-current":t["aria-current"]})}}var Y1e=()=>Em(()=>import("./index-5oE8Zryh.js"),[]).then(t=>t.default),dH=t=>{const{ripples:e=[],motionProps:n,color:r="currentColor",style:i,onClear:a}=t;return j.jsx(j.Fragment,{children:e.map(o=>{const s=h$(.01*o.size,.2,o.size>100?.75:.5);return j.jsx(Pm,{features:Y1e,children:j.jsx(fC,{mode:"popLayout",children:j.jsx(Oh.span,{animate:{transform:"scale(2)",opacity:0},className:"heroui-ripple",exit:{opacity:0},initial:{transform:"scale(0)",opacity:.35},style:{position:"absolute",backgroundColor:r,borderRadius:"100%",transformOrigin:"center",pointerEvents:"none",overflow:"hidden",inset:0,zIndex:0,top:o.y,left:o.x,width:`${o.size}px`,height:`${o.size}px`,...i},transition:{duration:s},onAnimationComplete:()=>{a(o.key)},...n})})},o.key)})})};dH.displayName="HeroUI.Ripple";var hH=dH;function pH(t={}){const[e,n]=H.useState([]),r=H.useCallback(a=>{const o=a.target,s=Math.max(o.clientWidth,o.clientHeight);n(l=>[...l,{key:d$(l.length.toString()),size:s,x:a.x-s/2,y:a.y-s/2}])},[]),i=H.useCallback(a=>{n(o=>o.filter(s=>s.key!==a))},[]);return{ripples:e,onClear:i,onPress:r,...t}}function J1e(t){var e,n,r,i,a,o,s,l,c;const f=X1e(),u=as(),d=!!f,{ref:h,as:p,children:g,startContent:m,endContent:y,autoFocus:v,className:x,spinner:w,isLoading:S=!1,disableRipple:T=!1,fullWidth:_=(e=f?.fullWidth)!=null?e:!1,radius:D=f?.radius,size:I=(n=f?.size)!=null?n:"md",color:R=(r=f?.color)!=null?r:"default",variant:O=(i=f?.variant)!=null?i:"solid",disableAnimation:P=(o=(a=f?.disableAnimation)!=null?a:u?.disableAnimation)!=null?o:!1,isDisabled:N=(s=f?.isDisabled)!=null?s:!1,isIconOnly:A=(l=f?.isIconOnly)!=null?l:!1,spinnerPlacement:B="start",onPress:V,onClick:$,...U}=t,G=p||"button",F=typeof G=="string",J=Ai(h),Q=(c=T||u?.disableRipple)!=null?c:P,{isFocusVisible:ne,isFocused:ye,focusProps:ve}=Fl({autoFocus:v}),Ce=N||S,we=H.useMemo(()=>Wz({size:I,color:R,variant:O,radius:D,fullWidth:_,isDisabled:Ce,isInGroup:d,disableAnimation:P,isIconOnly:A,className:x}),[I,R,O,D,_,Ce,d,A,P,x]),{onPress:Ae,onClear:Me,ripples:q}=pH(),k=H.useCallback(ae=>{Q||Ce||P||J.current&&Ae(ae)},[Q,Ce,P,J,Ae]),{buttonProps:Y,isPressed:X}=DD({elementType:p,isDisabled:Ce,onPress:Nf(V,k),onClick:$,...U},J),{isHovered:re,hoverProps:de}=il({isDisabled:Ce}),he=H.useCallback((ae={})=>({"data-disabled":Lt(Ce),"data-focus":Lt(ye),"data-pressed":Lt(X),"data-focus-visible":Lt(ne),"data-hover":Lt(re),"data-loading":Lt(S),...Nn(Y,ve,de,Lo(U,{enabled:F}),Lo(ae)),className:we}),[S,Ce,ye,X,F,ne,re,Y,ve,de,U,we]),Ee=ae=>H.isValidElement(ae)?H.cloneElement(ae,{"aria-hidden":!0,focusable:!1}):null,Oe=Ee(m),Pe=Ee(y),Ne=H.useMemo(()=>({sm:"sm",md:"sm",lg:"md"})[I],[I]),ie=H.useCallback(()=>({ripples:q,onClear:Me}),[q,Me]);return{Component:G,children:g,domRef:J,spinner:w,styles:we,startContent:Oe,endContent:Pe,isLoading:S,spinnerPlacement:B,spinnerSize:Ne,disableRipple:Q,getButtonProps:he,getRippleProps:ie,isIconOnly:A}}var gH=Qi((t,e)=>{const{Component:n,domRef:r,children:i,spinnerSize:a,spinner:o=j.jsx(bC,{color:"current",size:a}),spinnerPlacement:s,startContent:l,endContent:c,isLoading:f,disableRipple:u,getButtonProps:d,getRippleProps:h,isIconOnly:p}=J1e({...t,ref:e});return j.jsxs(n,{ref:r,...d(),children:[l,f&&s==="start"&&o,f&&p?null:i,f&&s==="end"&&o,c,!u&&j.jsx(hH,{...h()})]})});gH.displayName="HeroUI.Button";var qr=gH,[Z1e,mH]=tC({name:"CardContext",strict:!0,errorMessage:"useCardContext: `context` is undefined. Seems you forgot to wrap component within <Card />"}),vH=Qi((t,e)=>{var n;const{as:r,className:i,children:a,...o}=t,s=r||"div",l=Ai(e),{slots:c,classNames:f}=mH(),u=sn(f?.body,i);return j.jsx(s,{ref:l,className:(n=c.body)==null?void 0:n.call(c,{class:u}),...o,children:a})});vH.displayName="HeroUI.CardBody";var eu=vH,yH=Qi((t,e)=>{var n;const{as:r,className:i,children:a,...o}=t,s=r||"div",l=Ai(e),{slots:c,classNames:f}=mH(),u=sn(f?.header,i);return j.jsx(s,{ref:l,className:(n=c.header)==null?void 0:n.call(c,{class:u}),...o,children:a})});yH.displayName="HeroUI.CardHeader";var e_=yH;function Q1e(t){var e,n,r,i;const a=as(),[o,s]=Gl(t,ZN.variantKeys),{ref:l,as:c,children:f,onClick:u,onPress:d,autoFocus:h,className:p,classNames:g,allowTextSelectionOnPress:m=!0,...y}=o,v=Ai(l),x=c||(t.isPressable?"button":"div"),w=typeof x=="string",S=(n=(e=t.disableAnimation)!=null?e:a?.disableAnimation)!=null?n:!1,T=(i=(r=t.disableRipple)!=null?r:a?.disableRipple)!=null?i:!1,_=sn(g?.base,p),{onClear:D,onPress:I,ripples:R}=pH(),O=H.useCallback(ne=>{T||S||v.current&&I(ne)},[T,S,v,I]),{buttonProps:P,isPressed:N}=DD({onPress:Nf(d,O),elementType:c,isDisabled:!t.isPressable,onClick:u,allowTextSelectionOnPress:m,...y},v),{hoverProps:A,isHovered:B}=il({isDisabled:!t.isHoverable,...y}),{isFocusVisible:V,isFocused:$,focusProps:U}=Fl({autoFocus:h}),G=H.useMemo(()=>ZN({...s,disableAnimation:S}),[$l(s),S]),F=H.useMemo(()=>({slots:G,classNames:g,disableAnimation:S,isDisabled:t.isDisabled,isFooterBlurred:t.isFooterBlurred,fullWidth:t.fullWidth}),[G,g,t.isDisabled,t.isFooterBlurred,S,t.fullWidth]),J=H.useCallback((ne={})=>({ref:v,className:G.base({class:_}),tabIndex:t.isPressable?0:-1,"data-hover":Lt(B),"data-pressed":Lt(N),"data-focus":Lt($),"data-focus-visible":Lt(V),"data-disabled":Lt(t.isDisabled),...Nn(t.isPressable?{...P,...U,role:"button"}:{},t.isHoverable?A:{},Lo(y,{enabled:w}),Lo(ne))}),[v,G,_,w,t.isPressable,t.isHoverable,t.isDisabled,B,N,V,P,U,A,y]),Q=H.useCallback(()=>({ripples:R,onClear:D}),[R,D]);return{context:F,domRef:v,Component:x,classNames:g,children:f,isHovered:B,isPressed:N,disableAnimation:S,isPressable:t.isPressable,isHoverable:t.isHoverable,disableRipple:T,handlePress:O,isFocusVisible:V,getCardProps:J,getRippleProps:Q}}var xH=Qi((t,e)=>{const{children:n,context:r,Component:i,isPressable:a,disableAnimation:o,disableRipple:s,getCardProps:l,getRippleProps:c}=Q1e({...t,ref:e});return j.jsxs(i,{...l(),children:[j.jsx(Z1e,{value:r,children:n}),a&&!o&&!s&&j.jsx(hH,{...c()})]})});xH.displayName="HeroUI.Card";var tu=xH;function eve(t){const[e,n]=Gl(t,QN.variantKeys),{ref:r,as:i,children:a,avatar:o,startContent:s,endContent:l,onClose:c,classNames:f,className:u,...d}=e,h=i||"div",p=Ai(r),g=sn(f?.base,u),m=!!c,y=t.variant==="dot",{focusProps:v,isFocusVisible:x}=Fl(),w=H.useMemo(()=>typeof a=="string"&&a?.length===1,[a]),S=H.useMemo(()=>!!o||!!s,[o,s]),T=H.useMemo(()=>!!l||m,[l,m]),_=H.useMemo(()=>QN({...n,hasStartContent:S,hasEndContent:T,isOneChar:w,isCloseable:m,isCloseButtonFocusVisible:x}),[$l(n),x,S,T,w,m]),{pressProps:D}=g0({isDisabled:!!t?.isDisabled,onPress:c}),I=()=>({ref:p,className:_.base({class:g}),...d}),R=()=>({role:"button",tabIndex:0,className:_.closeButton({class:f?.closeButton}),"aria-label":"close chip",...Nn(D,v)}),O=N=>H.isValidElement(N)?H.cloneElement(N,{className:_.avatar({class:f?.avatar})}):null,P=N=>H.isValidElement(N)?H.cloneElement(N,{className:sn("max-h-[80%]",N.props.className)}):null;return{Component:h,children:a,slots:_,classNames:f,isDot:y,isCloseable:m,startContent:O(o)||P(s),endContent:P(l),getCloseButtonProps:R,getChipProps:I}}var bH=Qi((t,e)=>{const{Component:n,children:r,slots:i,classNames:a,isDot:o,isCloseable:s,startContent:l,endContent:c,getCloseButtonProps:f,getChipProps:u}=eve({...t,ref:e}),d=H.useMemo(()=>o&&!l?j.jsx("span",{className:i.dot({class:a?.dot})}):l,[i,l,o]),h=H.useMemo(()=>s?j.jsx("span",{...f(),children:c||j.jsx(CD,{})}):c,[c,s,f]);return j.jsxs(n,{...u(),children:[d,j.jsx("span",{className:i.content({class:a?.content}),children:r}),h]})});bH.displayName="HeroUI.Chip";var F2=bH;const wH={badInput:!1,customError:!1,patternMismatch:!1,rangeOverflow:!1,rangeUnderflow:!1,stepMismatch:!1,tooLong:!1,tooShort:!1,typeMismatch:!1,valueMissing:!1,valid:!0},CH={...wH,customError:!0,valid:!1},Q1={isInvalid:!1,validationDetails:wH,validationErrors:[]},tve=H.createContext({}),IL="__formValidationState"+Date.now();function nve(t){if(t[IL]){let{realtimeValidation:e,displayValidation:n,updateValidation:r,resetValidation:i,commitValidation:a}=t[IL];return{realtimeValidation:e,displayValidation:n,updateValidation:r,resetValidation:i,commitValidation:a}}return rve(t)}function rve(t){let{isInvalid:e,validationState:n,name:r,value:i,builtinValidation:a,validate:o,validationBehavior:s="aria"}=t;n&&(e||(e=n==="invalid"));let l=e!==void 0?{isInvalid:e,validationErrors:[],validationDetails:CH}:null,c=H.useMemo(()=>{if(!o||i==null)return null;let R=ive(o,i);return RL(R)},[o,i]);a?.validationDetails.valid&&(a=void 0);let f=H.useContext(tve),u=H.useMemo(()=>r?Array.isArray(r)?r.flatMap(R=>t_(f[R])):t_(f[r]):[],[f,r]),[d,h]=H.useState(f),[p,g]=H.useState(!1);f!==d&&(h(f),g(!1));let m=H.useMemo(()=>RL(p?[]:u),[p,u]),y=H.useRef(Q1),[v,x]=H.useState(Q1),w=H.useRef(Q1),S=()=>{if(!T)return;_(!1);let R=c||a||y.current;hE(R,w.current)||(w.current=R,x(R))},[T,_]=H.useState(!1);return H.useEffect(S),{realtimeValidation:l||m||c||a||Q1,displayValidation:s==="native"?l||m||v:l||m||c||a||v,updateValidation(R){s==="aria"&&!hE(v,R)?x(R):y.current=R},resetValidation(){let R=Q1;hE(R,w.current)||(w.current=R,x(R)),s==="native"&&_(!1),g(!0)},commitValidation(){s==="native"&&_(!0),g(!0)}}}function t_(t){return t?Array.isArray(t)?t:[t]:[]}function ive(t,e){if(typeof t=="function"){let n=t(e);if(n&&typeof n!="boolean")return t_(n)}return[]}function RL(t){return t.length?{isInvalid:!0,validationErrors:t,validationDetails:CH}:null}function hE(t,e){return t===e?!0:!!t&&!!e&&t.isInvalid===e.isInvalid&&t.validationErrors.length===e.validationErrors.length&&t.validationErrors.every((n,r)=>n===e.validationErrors[r])&&Object.entries(t.validationDetails).every(([n,r])=>e.validationDetails[n]===r)}function ave(t,e,n){let{validationBehavior:r,focus:i}=t;Nr(()=>{if(r==="native"&&n?.current&&!n.current.disabled){let c=e.realtimeValidation.isInvalid?e.realtimeValidation.validationErrors.join(" ")||"Invalid value.":"";n.current.setCustomValidity(c),n.current.hasAttribute("title")||(n.current.title=""),e.realtimeValidation.isInvalid||e.updateValidation(sve(n.current))}});let a=H.useRef(!1),o=Sr(()=>{a.current||e.resetValidation()}),s=Sr(c=>{var f;e.displayValidation.isInvalid||e.commitValidation();let u=n==null||(f=n.current)===null||f===void 0?void 0:f.form;if(!c.defaultPrevented&&n&&u&&lve(u)===n.current){var d;i?i():(d=n.current)===null||d===void 0||d.focus(),hhe("keyboard")}c.preventDefault()}),l=Sr(()=>{e.commitValidation()});H.useEffect(()=>{let c=n?.current;if(!c)return;let f=c.form,u=f?.reset;return f&&(f.reset=()=>{a.current=!window.event||window.event.type==="message"&&window.event.target instanceof MessagePort,u?.call(f),a.current=!1}),c.addEventListener("invalid",s),c.addEventListener("change",l),f?.addEventListener("reset",o),()=>{c.removeEventListener("invalid",s),c.removeEventListener("change",l),f?.removeEventListener("reset",o),f&&(f.reset=u)}},[n,s,l,o,r])}function ove(t){let e=t.validity;return{badInput:e.badInput,customError:e.customError,patternMismatch:e.patternMismatch,rangeOverflow:e.rangeOverflow,rangeUnderflow:e.rangeUnderflow,stepMismatch:e.stepMismatch,tooLong:e.tooLong,tooShort:e.tooShort,typeMismatch:e.typeMismatch,valueMissing:e.valueMissing,valid:e.valid}}function sve(t){return{isInvalid:!t.validity.valid,validationDetails:ove(t),validationErrors:t.validationMessage?[t.validationMessage]:[]}}function lve(t){for(let e=0;e<t.elements.length;e++){let n=t.elements[e];if(!n.validity.valid)return n}return null}function SH(t){let{id:e,label:n,"aria-labelledby":r,"aria-label":i,labelElementType:a="label"}=t;e=rl(e);let o=rl(),s={};n&&(r=r?`${o} ${r}`:o,s={id:o,htmlFor:a==="label"?e:void 0});let l=oC({id:e,"aria-label":i,"aria-labelledby":r});return{labelProps:s,fieldProps:l}}function cve(t){let{description:e,errorMessage:n,isInvalid:r,validationState:i}=t,{labelProps:a,fieldProps:o}=SH(t),s=sm([!!e,!!n,r,i]),l=sm([!!e,!!n,r,i]);return o=Ji(o,{"aria-describedby":[s,l,t["aria-describedby"]].filter(Boolean).join(" ")||void 0}),{labelProps:a,fieldProps:o,descriptionProps:{id:s},errorMessageProps:{id:l}}}var PL=Symbol("default");function uve(t){const e=H.useRef(null),n=H.useRef(void 0),r=H.useCallback(i=>{if(typeof t=="function"){const a=t,o=a(i);return()=>{typeof o=="function"?o():a(null)}}else if(t)return t.current=i,()=>{t.current=null}},[t]);return H.useMemo(()=>({get current(){return e.current},set current(i){e.current=i,n.current&&(n.current(),n.current=void 0),i!=null&&(n.current=r(i))}}),[r])}function OD(t,e){let n=H.useContext(t);if(e===null)return null;if(n&&typeof n=="object"&&"slots"in n&&n.slots){let r=new Intl.ListFormat().format(Object.keys(n.slots).map(a=>`"${a}"`));if(!e&&!n.slots[PL])throw new Error(`A slot prop is required. Valid slot names are ${r}.`);let i=e||PL;if(!n.slots[i])throw new Error(`Invalid slot "${e}". Valid slot names are ${r}.`);return n.slots[i]}return n}function fve(t,e,n){let r=OD(n,t.slot)||{},{ref:i,...a}=r,o=uve(H.useMemo(()=>p$(e,i),[e,i])),s=Nn(a,t);return"style"in a&&a.style&&"style"in t&&t.style&&(typeof a.style=="function"||typeof t.style=="function"?s.style=l=>{let c=typeof a.style=="function"?a.style(l):a.style,f={...l.defaultStyle,...c},u=typeof t.style=="function"?t.style({...l,defaultStyle:f}):t.style;return{...f,...u}}:s.style={...a.style,...t.style}),[s,o]}const TH={badInput:!1,customError:!1,patternMismatch:!1,rangeOverflow:!1,rangeUnderflow:!1,stepMismatch:!1,tooLong:!1,tooShort:!1,typeMismatch:!1,valueMissing:!1,valid:!0},EH={...TH,customError:!0,valid:!1},ev={isInvalid:!1,validationDetails:TH,validationErrors:[]},_H=H.createContext({}),AL="__formValidationState"+Date.now();function dve(t){if(t[AL]){let{realtimeValidation:e,displayValidation:n,updateValidation:r,resetValidation:i,commitValidation:a}=t[AL];return{realtimeValidation:e,displayValidation:n,updateValidation:r,resetValidation:i,commitValidation:a}}return hve(t)}function hve(t){let{isInvalid:e,validationState:n,name:r,value:i,builtinValidation:a,validate:o,validationBehavior:s="aria"}=t;n&&(e||(e=n==="invalid"));let l=e!==void 0?{isInvalid:e,validationErrors:[],validationDetails:EH}:null,c=H.useMemo(()=>{if(!o||i==null)return null;let R=pve(o,i);return NL(R)},[o,i]);a?.validationDetails.valid&&(a=void 0);let f=H.useContext(_H),u=H.useMemo(()=>r?Array.isArray(r)?r.flatMap(R=>n_(f[R])):n_(f[r]):[],[f,r]),[d,h]=H.useState(f),[p,g]=H.useState(!1);f!==d&&(h(f),g(!1));let m=H.useMemo(()=>NL(p?[]:u),[p,u]),y=H.useRef(ev),[v,x]=H.useState(ev),w=H.useRef(ev),S=()=>{if(!T)return;_(!1);let R=c||a||y.current;pE(R,w.current)||(w.current=R,x(R))},[T,_]=H.useState(!1);return H.useEffect(S),{realtimeValidation:l||m||c||a||ev,displayValidation:s==="native"?l||m||v:l||m||c||a||v,updateValidation(R){s==="aria"&&!pE(v,R)?x(R):y.current=R},resetValidation(){let R=ev;pE(R,w.current)||(w.current=R,x(R)),s==="native"&&_(!1),g(!0)},commitValidation(){s==="native"&&_(!0),g(!0)}}}function n_(t){return t?Array.isArray(t)?t:[t]:[]}function pve(t,e){if(typeof t=="function"){let n=t(e);if(n&&typeof n!="boolean")return n_(n)}return[]}function NL(t){return t.length?{isInvalid:!0,validationErrors:t,validationDetails:EH}:null}function pE(t,e){return t===e?!0:!!t&&!!e&&t.isInvalid===e.isInvalid&&t.validationErrors.length===e.validationErrors.length&&t.validationErrors.every((n,r)=>n===e.validationErrors[r])&&Object.entries(t.validationDetails).every(([n,r])=>e.validationDetails[n]===r)}var Uw=H.createContext(null);H.forwardRef(function(e,n){[e,n]=fve(e,n,Uw);let{validationErrors:r,validationBehavior:i="native",children:a,className:o,...s}=e;const l=H.useMemo(()=>$pe({className:o}),[o]);return j.jsx("form",{noValidate:i!=="native",...s,ref:n,className:l,children:j.jsx(Uw.Provider,{value:{...e,validationBehavior:i},children:j.jsx(_H.Provider,{value:r??{},children:a})})})});var DH=Qi((t,e)=>{const{as:n,activePage:r,...i}=t,a=n||"span",o=Ai(e);return j.jsx(a,{ref:o,"aria-hidden":!0,...i,children:r})});DH.displayName="HeroUI.PaginationCursor";var gve=DH;function mve(t){const{as:e,ref:n,value:r,children:i,isActive:a,isDisabled:o,onPress:s,onClick:l,getAriaLabel:c,className:f,...u}=t,d=!!t?.href,h=e||d?"a":"li",p=typeof h=="string",g=Ai(n),m=a0e(),y=H.useMemo(()=>a?`${c?.(r)} active`:c?.(r),[r,a]),{isPressed:v,pressProps:x}=g0({isDisabled:o,onPress:s}),{focusProps:w,isFocused:S,isFocusVisible:T}=Fl({}),{isHovered:_,hoverProps:D}=il({isDisabled:o});return{Component:h,children:i,ariaLabel:y,isFocused:S,isFocusVisible:T,getItemProps:(R={})=>({ref:g,role:"button",tabIndex:o?-1:0,"aria-label":y,"aria-current":Lt(a),"aria-disabled":Lt(o),"data-disabled":Lt(o),"data-active":Lt(a),"data-focus":Lt(S),"data-hover":Lt(_),"data-pressed":Lt(v),"data-focus-visible":Lt(T),...Nn(R,x,w,D,Lo(u,{enabled:p})),className:sn(f,R.className),onClick:O=>{Nf(x?.onClick,l)(O),!m.isNative&&O.currentTarget instanceof HTMLAnchorElement&&O.currentTarget.href&&!O.isDefaultPrevented()&&vj(O.currentTarget,O)&&R.href&&(O.preventDefault(),m.open(O.currentTarget,O,R.href,R.routerOptions))}})}}var OH=Qi((t,e)=>{const{Component:n,children:r,getItemProps:i}=mve({...t,ref:e});return j.jsx(n,{...i(),children:r})});OH.displayName="HeroUI.PaginationItem";var bx=OH,Ki=(t=>(t.DOTS="dots",t.PREV="prev",t.NEXT="next",t))(Ki||{});function vve(t){const{page:e,total:n,siblings:r=1,boundaries:i=1,initialPage:a=1,showControls:o=!1,onChange:s}=t,[l,c]=H.useState(e||a),{direction:f}=D9(),u=f==="rtl",d=w=>{c(w),s&&s(w)};H.useEffect(()=>{e&&e!==l&&c(e)},[e]);const h=H.useCallback(w=>{w<=0?d(1):w>n?d(n):d(w)},[n,l,d]),p=()=>h(l+1),g=()=>h(l-1),m=()=>h(1),y=()=>h(n),v=H.useCallback(w=>o?["prev",...w,"next"]:w,[u,o]);return{range:H.useMemo(()=>{if(r*2+3+i*2>=n)return v(pd(1,n));const S=Math.max(l-r,i),T=Math.min(l+r,n-i),_=S>i+2,D=T<n-(i+1);if(!_&&D){const I=r*2+i+2;return v([...pd(1,I),"dots",...pd(n-(i-1),n)])}if(_&&!D){const I=i+1+2*r;return v([...pd(1,i),"dots",...pd(n-I,n)])}return v([...pd(1,i),"dots",...pd(S,T),"dots",...pd(n-i+1,n)])},[n,l,r,i,v]),activePage:l,setPage:h,next:p,previous:g,first:m,last:y}}const LL=t=>typeof t=="object"&&t!=null&&t.nodeType===1,kL=(t,e)=>(!e||t!=="hidden")&&t!=="visible"&&t!=="clip",wx=(t,e)=>{if(t.clientHeight<t.scrollHeight||t.clientWidth<t.scrollWidth){const n=getComputedStyle(t,null);return kL(n.overflowY,e)||kL(n.overflowX,e)||(r=>{const i=(a=>{if(!a.ownerDocument||!a.ownerDocument.defaultView)return null;try{return a.ownerDocument.defaultView.frameElement}catch{return null}})(r);return!!i&&(i.clientHeight<r.scrollHeight||i.clientWidth<r.scrollWidth)})(t)}return!1},Cx=(t,e,n,r,i,a,o,s)=>a<t&&o>e||a>t&&o<e?0:a<=t&&s<=n||o>=e&&s>=n?a-t-r:o>e&&s<n||a<t&&s>n?o-e+i:0,yve=t=>{const e=t.parentElement;return e??(t.getRootNode().host||null)},VL=(t,e)=>{var n,r,i,a;if(typeof document>"u")return[];const{scrollMode:o,block:s,inline:l,boundary:c,skipOverflowHiddenElements:f}=e,u=typeof c=="function"?c:V=>V!==c;if(!LL(t))throw new TypeError("Invalid target");const d=document.scrollingElement||document.documentElement,h=[];let p=t;for(;LL(p)&&u(p);){if(p=yve(p),p===d){h.push(p);break}p!=null&&p===document.body&&wx(p)&&!wx(document.documentElement)||p!=null&&wx(p,f)&&h.push(p)}const g=(r=(n=window.visualViewport)==null?void 0:n.width)!=null?r:innerWidth,m=(a=(i=window.visualViewport)==null?void 0:i.height)!=null?a:innerHeight,{scrollX:y,scrollY:v}=window,{height:x,width:w,top:S,right:T,bottom:_,left:D}=t.getBoundingClientRect(),{top:I,right:R,bottom:O,left:P}=(V=>{const $=window.getComputedStyle(V);return{top:parseFloat($.scrollMarginTop)||0,right:parseFloat($.scrollMarginRight)||0,bottom:parseFloat($.scrollMarginBottom)||0,left:parseFloat($.scrollMarginLeft)||0}})(t);let N=s==="start"||s==="nearest"?S-I:s==="end"?_+O:S+x/2-I+O,A=l==="center"?D+w/2-P+R:l==="end"?T+R:D-P;const B=[];for(let V=0;V<h.length;V++){const $=h[V],{height:U,width:G,top:F,right:J,bottom:Q,left:ne}=$.getBoundingClientRect();if(o==="if-needed"&&S>=0&&D>=0&&_<=m&&T<=g&&($===d&&!wx($)||S>=F&&_<=Q&&D>=ne&&T<=J))return B;const ye=getComputedStyle($),ve=parseInt(ye.borderLeftWidth,10),Ce=parseInt(ye.borderTopWidth,10),we=parseInt(ye.borderRightWidth,10),Ae=parseInt(ye.borderBottomWidth,10);let Me=0,q=0;const k="offsetWidth"in $?$.offsetWidth-$.clientWidth-ve-we:0,Y="offsetHeight"in $?$.offsetHeight-$.clientHeight-Ce-Ae:0,X="offsetWidth"in $?$.offsetWidth===0?0:G/$.offsetWidth:0,re="offsetHeight"in $?$.offsetHeight===0?0:U/$.offsetHeight:0;if(d===$)Me=s==="start"?N:s==="end"?N-m:s==="nearest"?Cx(v,v+m,m,Ce,Ae,v+N,v+N+x,x):N-m/2,q=l==="start"?A:l==="center"?A-g/2:l==="end"?A-g:Cx(y,y+g,g,ve,we,y+A,y+A+w,w),Me=Math.max(0,Me+v),q=Math.max(0,q+y);else{Me=s==="start"?N-F-Ce:s==="end"?N-Q+Ae+Y:s==="nearest"?Cx(F,Q,U,Ce,Ae+Y,N,N+x,x):N-(F+U/2)+Y/2,q=l==="start"?A-ne-ve:l==="center"?A-(ne+G/2)+k/2:l==="end"?A-J+we+k:Cx(ne,J,G,ve,we+k,A,A+w,w);const{scrollLeft:de,scrollTop:he}=$;Me=re===0?0:Math.max(0,Math.min(he+Me/re,$.scrollHeight-U/re+Y)),q=X===0?0:Math.max(0,Math.min(de+q/X,$.scrollWidth-G/X+k)),N+=he-Me,A+=de-q}B.push({el:$,top:Me,left:q})}return B},xve=t=>t===!1?{block:"end",inline:"nearest"}:(e=>e===Object(e)&&Object.keys(e).length!==0)(t)?t:{block:"start",inline:"nearest"};function MH(t,e){if(!t.isConnected||!(r=>{let i=r;for(;i&&i.parentNode;){if(i.parentNode===document)return!0;i=i.parentNode instanceof ShadowRoot?i.parentNode.host:i.parentNode}return!1})(t))return;if((r=>typeof r=="object"&&typeof r.behavior=="function")(e))return e.behavior(VL(t,e));const n=typeof e=="boolean"||e==null?void 0:e.behavior;for(const{el:r,top:i,left:a}of VL(t,xve(e)))r.scroll({top:i,left:a,behavior:n})}function bve({threshold:t=0,root:e=null,rootMargin:n="0%",isEnabled:r=!0,freezeOnceVisible:i=!1,initialIsIntersecting:a=!1,onChange:o}={}){var s;const[l,c]=H.useState(null),[f,u]=H.useState(()=>({isIntersecting:a,entry:void 0})),d=H.useRef();d.current=o;const h=((s=f.entry)==null?void 0:s.isIntersecting)&&i;H.useEffect(()=>{if(!r||!l||!("IntersectionObserver"in window)||h)return;const m=new IntersectionObserver(y=>{const v=Array.isArray(m.thresholds)?m.thresholds:[m.thresholds];y.forEach(x=>{const w=x.isIntersecting&&v.some(S=>x.intersectionRatio>=S);u({isIntersecting:w,entry:x}),d.current&&d.current(w,x)})},{threshold:t,root:e,rootMargin:n});return m.observe(l),()=>{m.disconnect()}},[l,r,JSON.stringify(t),e,n,h,i]);const p=H.useRef(null);H.useEffect(()=>{var m;!l&&((m=f.entry)!=null&&m.target)&&!i&&!h&&p.current!==f.entry.target&&(p.current=f.entry.target,u({isIntersecting:a,entry:void 0}))},[l,f.entry,i,h,a]);const g=[c,!!f.isIntersecting,f.entry];return g.ref=g[0],g.isIntersecting=g[1],g.entry=g[2],g}var FL=300;function wve(t){var e,n,r,i;const a=as(),[o,s]=Gl(t,KN.variantKeys),{as:l,ref:c,classNames:f,dotsJump:u=5,loop:d=!1,showControls:h=!1,total:p=1,initialPage:g=1,page:m,siblings:y,boundaries:v,onChange:x,className:w,renderItem:S,getItemAriaLabel:T,..._}=o,D=l||"nav",I=Ai(c),R=H.useRef(null),O=H.useRef(),P=H.useRef(),N=(n=(e=t?.disableAnimation)!=null?e:a?.disableAnimation)!=null?n:!1,A=(i=(r=t?.disableCursorAnimation)!=null?r:N)!=null?i:!1;function B(){return O.current||(O.current=new Map),O.current}function V(Ee,Oe){const Pe=B();Ee?Pe.set(Oe,Ee):Pe.delete(Oe)}function $(Ee,Oe){const Ne=B().get(Ee);if(!Ne||!R.current)return;P.current&&clearTimeout(P.current),MH(Ne,{scrollMode:"always",behavior:"smooth",block:"start",inline:"start",boundary:I.current});const{offsetLeft:ie}=Ne;if(Oe){R.current.setAttribute("data-moving","false"),R.current.style.transform=`translateX(${ie}px) scale(1)`;return}R.current.setAttribute("data-moving","true"),R.current.style.transform=`translateX(${ie}px) scale(1.1)`,P.current=setTimeout(()=>{R.current&&(R.current.style.transform=`translateX(${ie}px) scale(1)`),P.current=setTimeout(()=>{var ae;(ae=R.current)==null||ae.setAttribute("data-moving","false"),P.current&&clearTimeout(P.current)},FL)},FL)}const{range:U,activePage:G,setPage:F,previous:J,next:Q,first:ne,last:ye}=vve({page:m,total:p,initialPage:g,siblings:y,boundaries:v,showControls:h,onChange:x}),[ve,Ce]=bve();H.useEffect(()=>{I.current&&ve(I.current)},[I.current]);const we=H.useRef(G);H.useEffect(()=>{G&&!N&&Ce&&$(G,G===we.current),we.current=G},[m,G,N,A,Ce,t.dotsJump,t.isCompact,t.showControls]);const Ae=H.useMemo(()=>KN({...s,disableAnimation:N,disableCursorAnimation:A}),[$l(s),A,N]),Me=sn(f?.base,w);return{Component:D,showControls:h,dotsJump:u,slots:Ae,classNames:f,loop:d,total:p,range:U,activePage:G,getItemRef:V,disableAnimation:N,disableCursorAnimation:A,setPage:F,onPrevious:()=>d&&G===1?ye():J(),onNext:()=>d&&G===p?ne():Q(),renderItem:S,getBaseProps:(Ee={})=>({...Ee,ref:I,role:"navigation","aria-label":Ee["aria-label"]||"pagination navigation","data-slot":"base","data-controls":Lt(h),"data-loop":Lt(d),"data-dots-jump":u,"data-total":p,"data-active-page":G,className:Ae.base({class:sn(Me,Ee?.className)}),..._}),getWrapperProps:(Ee={})=>({...Ee,"data-slot":"wrapper",className:Ae.wrapper({class:sn(f?.wrapper,Ee?.className)})}),getItemProps:(Ee={})=>({...Ee,ref:Oe=>V(Oe,Ee.value),"data-slot":"item",isActive:Ee.value===G,className:Ae.item({class:sn(f?.item,Ee?.className)}),onPress:()=>{Ee.value!==G&&F(Ee.value)}}),getCursorProps:(Ee={})=>({...Ee,ref:R,activePage:G,"data-slot":"cursor",className:Ae.cursor({class:sn(f?.cursor,Ee?.className)})}),getItemAriaLabel:Ee=>{if(Ee){if(T)return T(Ee);switch(Ee){case Ki.DOTS:return"dots element";case Ki.PREV:return"previous page button";case Ki.NEXT:return"next page button";case"first":return"first page button";case"last":return"last page button";default:return`pagination item ${Ee}`}}}}}var IH=Qi((t,e)=>{const{Component:n,dotsJump:r,slots:i,classNames:a,total:o,range:s,loop:l,activePage:c,disableCursorAnimation:f,disableAnimation:u,renderItem:d,onNext:h,onPrevious:p,setPage:g,getItemAriaLabel:m,getItemRef:y,getBaseProps:v,getWrapperProps:x,getItemProps:w,getCursorProps:S}=wve({...t,ref:e}),{direction:T}=D9(),_=T==="rtl",D=H.useCallback(P=>P===Ki.PREV&&!_||P===Ki.NEXT&&_?j.jsx(aL,{}):j.jsx(aL,{className:i.chevronNext({class:a?.chevronNext})}),[i,_]),I=H.useCallback(P=>j.jsx(bx,{className:i.prev({class:a?.prev}),"data-slot":"prev",getAriaLabel:m,isDisabled:!l&&c===1,value:P,onPress:p,children:D(Ki.PREV)},Ki.PREV),[i,a,l,c,_,o,m,p]),R=H.useCallback(P=>j.jsx(bx,{className:i.next({class:sn(a?.next)}),"data-slot":"next",getAriaLabel:m,isDisabled:!l&&c===o,value:P,onPress:h,children:D(Ki.NEXT)},Ki.NEXT),[i,a,l,c,_,o,m,h]),O=H.useCallback((P,N)=>{const A=N<s.indexOf(c);if(d&&typeof d=="function"){let B=typeof P=="number"?P:N;P===Ki.NEXT&&(B=c+1),P===Ki.PREV&&(B=c-1),P===Ki.DOTS&&(B=A?c-r>=1?c-r:1:c+r<=o?c+r:o);const V={[Ki.PREV]:D(Ki.PREV),[Ki.NEXT]:D(Ki.NEXT),[Ki.DOTS]:j.jsxs(j.Fragment,{children:[j.jsx(rL,{className:i?.ellipsis({class:a?.ellipsis})}),j.jsx(iL,{className:i?.forwardIcon({class:a?.forwardIcon}),"data-before":Lt(A)})]})};return d({value:P,index:N,key:`${P}-${N}`,page:B,total:o,children:typeof P=="number"?P:V[P],activePage:c,dotsJump:r,isBefore:A,isActive:P===c,isPrevious:P===c-1,isNext:P===c+1,isFirst:P===1,isLast:P===o,onNext:h,onPrevious:p,setPage:g,onPress:()=>g(B),ref:typeof P=="number"?$=>y($,P):void 0,className:i.item({class:a?.item}),getAriaLabel:m})}return P===Ki.PREV?I(P):P===Ki.NEXT?R(P):P===Ki.DOTS?j.jsxs(bx,{className:i.item({class:sn(a?.item,"group")}),"data-slot":"item",getAriaLabel:m,value:P,onPress:()=>g(A?c-r>=1?c-r:1:c+r<=o?c+r:o),children:[j.jsx(rL,{className:i?.ellipsis({class:a?.ellipsis})}),j.jsx(iL,{className:i?.forwardIcon({class:a?.forwardIcon}),"data-before":Lt(_?!A:A)})]},Ki.DOTS+A):H.createElement(bx,{...w({value:P}),key:P,getAriaLabel:m},P)},[_,c,r,w,l,s,d,i,a,o,m,h,p,g,I,R]);return j.jsx(n,{...v(),children:j.jsxs("ul",{...x(),children:[!f&&!u&&j.jsx(gve,{...S()}),s.map(O)]})})});IH.displayName="HeroUI.Pagination";var OC=IH;function Cve(t){let[e,n]=Om(t.isOpen,t.defaultOpen||!1,t.onOpenChange);const r=H.useCallback(()=>{n(!0)},[n]),i=H.useCallback(()=>{n(!1)},[n]),a=H.useCallback(()=>{n(!e)},[n,e]);return{isOpen:e,setOpen:n,open:r,close:i,toggle:a}}var Hc=[];function Sve(t,e){const{disableOutsideEvents:n=!0,isDismissable:r=!1,isKeyboardDismissDisabled:i=!1,isOpen:a,onClose:o,shouldCloseOnBlur:s,shouldCloseOnInteractOutside:l}=t;H.useEffect(()=>{if(a&&!Hc.includes(e))return Hc.push(e),()=>{let g=Hc.indexOf(e);g>=0&&Hc.splice(g,1)}},[a,e]);const c=()=>{Hc[Hc.length-1]===e&&o&&o()},f=g=>{(!l||l(g.target))&&(Hc[Hc.length-1]===e&&n&&(g.stopPropagation(),g.preventDefault()),c())},u=g=>{(!l||l(g.target))&&(Hc[Hc.length-1]===e&&n&&(g.stopPropagation(),g.preventDefault()),c())},d=g=>{g.key==="Escape"&&!i&&!g.nativeEvent.isComposing&&(g.stopPropagation(),g.preventDefault(),c())};W0e({isDisabled:!(r&&a),onInteractOutside:r&&a?u:void 0,onInteractOutsideStart:f,ref:e});const{focusWithinProps:h}=Am({isDisabled:!s,onBlurWithin:g=>{!g.relatedTarget||Z0e(g.relatedTarget)||(!l||l(g.relatedTarget))&&c()}}),p=g=>{g.target===g.currentTarget&&g.preventDefault()};return{overlayProps:{onKeyDown:d,...h},underlayProps:{onPointerDown:p}}}function Tve(t={}){const{rerender:e=!1,delay:n=0}=t,r=H.useRef(!1),[i,a]=H.useState(!1);return H.useEffect(()=>{r.current=!0;let o=null;return e&&(n>0?o=setTimeout(()=>{a(!0)},n):a(!0)),()=>{r.current=!1,e&&a(!1),o&&clearTimeout(o)}},[e]),[H.useCallback(()=>r.current,[]),i]}function Eve(t,e){let{inputElementType:n="input",isDisabled:r=!1,isRequired:i=!1,isReadOnly:a=!1,type:o="text",validationBehavior:s="aria"}=t,[l,c]=Om(t.value,t.defaultValue||"",t.onChange),{focusableProps:f}=yC(t,e),u=nve({...t,value:l}),{isInvalid:d,validationErrors:h,validationDetails:p}=u.displayValidation,{labelProps:g,fieldProps:m,descriptionProps:y,errorMessageProps:v}=cve({...t,isInvalid:d,errorMessage:t.errorMessage||h}),x=_m(t,{labelable:!0});const w={type:o,pattern:t.pattern};let[S]=H.useState(l);var T;return Kse(e,(T=t.defaultValue)!==null&&T!==void 0?T:S,c),ave(t,u,e),H.useEffect(()=>{if(e.current instanceof Za(e.current).HTMLTextAreaElement){let _=e.current;Object.defineProperty(_,"defaultValue",{get:()=>_.value,set:()=>{},configurable:!0})}},[e]),{labelProps:g,inputProps:Ji(x,n==="input"?w:void 0,{disabled:r,readOnly:a,required:i&&s==="native","aria-required":i&&s==="aria"||void 0,"aria-invalid":d||void 0,"aria-errormessage":t["aria-errormessage"],"aria-activedescendant":t["aria-activedescendant"],"aria-autocomplete":t["aria-autocomplete"],"aria-haspopup":t["aria-haspopup"],"aria-controls":t["aria-controls"],value:l,onChange:_=>c(_.target.value),autoComplete:t.autoComplete,autoCapitalize:t.autoCapitalize,maxLength:t.maxLength,minLength:t.minLength,name:t.name,form:t.form,placeholder:t.placeholder,inputMode:t.inputMode,autoCorrect:t.autoCorrect,spellCheck:t.spellCheck,[parseInt(un.version,10)>=17?"enterKeyHint":"enterkeyhint"]:t.enterKeyHint,onCopy:t.onCopy,onCut:t.onCut,onPaste:t.onPaste,onCompositionEnd:t.onCompositionEnd,onCompositionStart:t.onCompositionStart,onCompositionUpdate:t.onCompositionUpdate,onSelect:t.onSelect,onBeforeInput:t.onBeforeInput,onInput:t.onInput,...f,...m}),descriptionProps:y,errorMessageProps:v,isInvalid:d,validationErrors:h,validationDetails:p}}function _ve(t){var e,n,r,i,a,o,s;const l=as(),{validationBehavior:c}=OD(Uw)||{},[f,u]=Gl(t,YN.variantKeys),{ref:d,as:h,type:p,label:g,baseRef:m,wrapperRef:y,description:v,className:x,classNames:w,autoFocus:S,startContent:T,endContent:_,onClear:D,onChange:I,validationState:R,validationBehavior:O=(e=c??l?.validationBehavior)!=null?e:"native",innerWrapperRef:P,onValueChange:N=()=>{},...A}=f,B=H.useCallback(nn=>{N(nn??"")},[N]),[V,$]=H.useState(!1),U=h||"div",G=(r=(n=t.disableAnimation)!=null?n:l?.disableAnimation)!=null?r:!1,F=Ai(d),J=Ai(m),Q=Ai(y),ne=Ai(P),[ye,ve]=Om(f.value,(i=f.defaultValue)!=null?i:"",B),Ce=p==="file",we=((s=(o=(a=F?.current)==null?void 0:a.files)==null?void 0:o.length)!=null?s:0)>0,Ae=["date","time","month","week","range"].includes(p),Me=!Cw(ye)||Ae||we,q=Me||V,k=p==="hidden",Y=t.isMultiline,X=sn(w?.base,x,Me?"is-filled":""),re=H.useCallback(()=>{var nn;Ce?F.current.value="":ve(""),D?.(),(nn=F.current)==null||nn.focus()},[ve,D,Ce]);_D(()=>{F.current&&ve(F.current.value)},[F.current]);const{labelProps:de,inputProps:he,isInvalid:Ee,validationErrors:Oe,validationDetails:Pe,descriptionProps:Ne,errorMessageProps:ie}=Eve({...t,validationBehavior:O,autoCapitalize:t.autoCapitalize,value:ye,"aria-label":t.label?t["aria-label"]:Xoe(t["aria-label"],t.placeholder),inputElementType:Y?"textarea":"input",onChange:ve},F);Ce&&(delete he.value,delete he.onChange);const{isFocusVisible:ae,isFocused:Te,focusProps:me}=Fl({autoFocus:S,isTextInput:!0}),{isHovered:Se,hoverProps:Ve}=il({isDisabled:!!t?.isDisabled}),{isHovered:ue,hoverProps:ut}=il({isDisabled:!!t?.isDisabled}),{focusProps:ht,isFocusVisible:Ot}=Fl(),{focusWithinProps:Fe}=Am({onFocusWithinChange:$}),{pressProps:Qe}=g0({isDisabled:!!t?.isDisabled||!!t?.isReadOnly,onPress:re}),st=R==="invalid"||Ee,ot=Nhe({labelPlacement:t.labelPlacement,label:g}),Mt=typeof f.errorMessage=="function"?f.errorMessage({isInvalid:st,validationErrors:Oe,validationDetails:Pe}):f.errorMessage||Oe?.join(" "),Ue=!!D||t.isClearable,He=!!g||!!v||!!Mt,Ct=!!f.placeholder,$t=!!g,bn=!!v||!!Mt,Tn=ot==="outside-left",en=ot==="outside-top",Pn=ot==="outside"||Tn||en,mi=ot==="inside",hr=F.current?(!F.current.value||F.current.value===""||!ye||ye==="")&&Ct:!1,Ke=!!T,Et=Pn?Tn||en||Ct||ot==="outside"&&Ke:!1,Rt=ot==="outside"&&!Ct&&!Ke,Ft=H.useMemo(()=>YN({...u,isInvalid:st,labelPlacement:ot,isClearable:Ue,disableAnimation:G}),[$l(u),st,ot,Ue,Ke,G]),Dn=H.useCallback((nn={})=>({ref:J,className:Ft.base({class:X}),"data-slot":"base","data-filled":Lt(Me||Ct||Ke||hr||Ce),"data-filled-within":Lt(q||Ct||Ke||hr||Ce),"data-focus-within":Lt(V),"data-focus-visible":Lt(ae),"data-readonly":Lt(t.isReadOnly),"data-focus":Lt(Te),"data-hover":Lt(Se||ue),"data-required":Lt(t.isRequired),"data-invalid":Lt(st),"data-disabled":Lt(t.isDisabled),"data-has-elements":Lt(He),"data-has-helper":Lt(bn),"data-has-label":Lt($t),"data-has-value":Lt(!hr),"data-hidden":Lt(k),...Fe,...nn}),[Ft,X,Me,Te,Se,ue,st,bn,$t,He,hr,Ke,V,ae,q,Ct,Fe,k,t.isReadOnly,t.isRequired,t.isDisabled]),Bt=H.useCallback((nn={})=>({"data-slot":"label",className:Ft.label({class:w?.label}),...Nn(de,ut,nn)}),[Ft,ue,de,w?.label]),qt=H.useCallback(nn=>{nn.key==="Escape"&&ye&&(Ue||D)&&!t.isReadOnly&&(ve(""),D?.())},[ye,ve,D,Ue,t.isReadOnly]),kt=H.useCallback((nn={})=>({"data-slot":"input","data-filled":Lt(Me),"data-filled-within":Lt(q),"data-has-start-content":Lt(Ke),"data-has-end-content":Lt(!!_),"data-type":p,className:Ft.input({class:sn(w?.input,Me?"is-filled":"",Y?"pe-0":"",p==="password"?"[&::-ms-reveal]:hidden":"")}),...Nn(me,he,Lo(A,{enabled:!0,labelable:!0,omitEventNames:new Set(Object.keys(he))}),nn),"aria-readonly":Lt(t.isReadOnly),onChange:Nf(he.onChange,I),onKeyDown:Nf(he.onKeyDown,nn.onKeyDown,qt),ref:F}),[Ft,ye,me,he,A,Me,q,Ke,_,w?.input,t.isReadOnly,t.isRequired,I,qt]),Zt=H.useCallback((nn={})=>({ref:Q,"data-slot":"input-wrapper","data-hover":Lt(Se||ue),"data-focus-visible":Lt(ae),"data-focus":Lt(Te),className:Ft.inputWrapper({class:sn(w?.inputWrapper,Me?"is-filled":"")}),...Nn(nn,Ve),onClick:Yn=>{F.current&&Yn.currentTarget===Yn.target&&F.current.focus()},style:{cursor:"text",...nn.style}}),[Ft,Se,ue,ae,Te,ye,w?.inputWrapper]),wr=H.useCallback((nn={})=>({...nn,ref:ne,"data-slot":"inner-wrapper",onClick:Yn=>{F.current&&Yn.currentTarget===Yn.target&&F.current.focus()},className:Ft.innerWrapper({class:sn(w?.innerWrapper,nn?.className)})}),[Ft,w?.innerWrapper]),$r=H.useCallback((nn={})=>({...nn,"data-slot":"main-wrapper",className:Ft.mainWrapper({class:sn(w?.mainWrapper,nn?.className)})}),[Ft,w?.mainWrapper]),oi=H.useCallback((nn={})=>({...nn,"data-slot":"helper-wrapper",className:Ft.helperWrapper({class:sn(w?.helperWrapper,nn?.className)})}),[Ft,w?.helperWrapper]),Li=H.useCallback((nn={})=>({...nn,...Ne,"data-slot":"description",className:Ft.description({class:sn(w?.description,nn?.className)})}),[Ft,w?.description]),vi=H.useCallback((nn={})=>({...nn,...ie,"data-slot":"error-message",className:Ft.errorMessage({class:sn(w?.errorMessage,nn?.className)})}),[Ft,ie,w?.errorMessage]),ki=H.useCallback((nn={})=>({...nn,type:"button",tabIndex:-1,disabled:t.isDisabled,"aria-label":"clear input","data-slot":"clear-button","data-focus-visible":Lt(Ot),className:Ft.clearButton({class:sn(w?.clearButton,nn?.className)}),...Nn(Qe,ht)}),[Ft,Ot,Qe,ht,w?.clearButton]);return{Component:U,classNames:w,domRef:F,label:g,description:v,startContent:T,endContent:_,labelPlacement:ot,isClearable:Ue,hasHelper:bn,hasStartContent:Ke,isLabelOutside:Et,isOutsideLeft:Tn,isOutsideTop:en,isLabelOutsideAsPlaceholder:Rt,shouldLabelBeOutside:Pn,shouldLabelBeInside:mi,hasPlaceholder:Ct,isInvalid:st,errorMessage:Mt,getBaseProps:Dn,getLabelProps:Bt,getInputProps:kt,getMainWrapperProps:$r,getInputWrapperProps:Zt,getInnerWrapperProps:wr,getHelperWrapperProps:oi,getDescriptionProps:Li,getErrorMessageProps:vi,getClearButtonProps:ki}}var RH=Qi((t,e)=>{const{Component:n,label:r,description:i,isClearable:a,startContent:o,endContent:s,labelPlacement:l,hasHelper:c,isOutsideLeft:f,isOutsideTop:u,shouldLabelBeOutside:d,errorMessage:h,isInvalid:p,getBaseProps:g,getLabelProps:m,getInputProps:y,getInnerWrapperProps:v,getInputWrapperProps:x,getMainWrapperProps:w,getHelperWrapperProps:S,getDescriptionProps:T,getErrorMessageProps:_,getClearButtonProps:D}=_ve({...t,ref:e}),I=r?j.jsx("label",{...m(),children:r}):null,R=H.useMemo(()=>a?j.jsx("button",{...D(),children:s||j.jsx(CD,{})}):s,[a,D]),O=H.useMemo(()=>{const A=p&&h;return!c||!(A||i)?null:j.jsx("div",{...S(),children:A?j.jsx("div",{..._(),children:h}):j.jsx("div",{...T(),children:i})})},[c,p,h,i,S,_,T]),P=H.useMemo(()=>j.jsxs("div",{...v(),children:[o,j.jsx("input",{...y()}),R]}),[o,R,y,v]),N=H.useMemo(()=>d?j.jsxs("div",{...w(),children:[j.jsxs("div",{...x(),children:[!f&&!u?I:null,P]}),O]}):j.jsxs(j.Fragment,{children:[j.jsxs("div",{...x(),children:[I,P]}),O]}),[l,O,d,I,P,h,i,w,x,_,T]);return j.jsxs(n,{...g(),children:[f||u?I:null,N]})});RH.displayName="HeroUI.Input";var U2=RH;function Dve(t,e){const{groupRef:n,triggerRef:r,popoverRef:i,showArrow:a,offset:o=7,crossOffset:s=0,scrollRef:l,shouldFlip:c,boundaryElement:f,isDismissable:u=!0,shouldCloseOnBlur:d=!0,shouldCloseOnScroll:h=!0,placement:p="top",containerPadding:g,shouldCloseOnInteractOutside:m,isNonModal:y,isKeyboardDismissDisabled:v,updatePositionDeps:x=[],...w}=t,S=y??!0,T=w.trigger==="SubmenuTrigger",{overlayProps:_,underlayProps:D}=Sve({isOpen:e.isOpen,onClose:e.close,shouldCloseOnBlur:d,isDismissable:u||T,isKeyboardDismissDisabled:v,shouldCloseOnInteractOutside:m||(N=>{var A;return!((A=r.current)!=null&&A.contains(N))}),disableOutsideEvents:!S},i),{overlayProps:I,arrowProps:R,placement:O,updatePosition:P}=E0e({...w,shouldFlip:c,crossOffset:s,targetRef:r,overlayRef:i,isOpen:e.isOpen,scrollRef:l,boundaryElement:f,containerPadding:g,placement:W1e(p),offset:a?o+3:o,onClose:S&&!T&&h?e.close:()=>{}});return _D(()=>{x.length&&P()},x),H.useEffect(()=>{var N,A;if(e.isOpen&&i.current)return S?q1e((N=n?.current)!=null?N:i.current):K1e([(A=n?.current)!=null?A:i.current])},[S,e.isOpen,i,n]),{popoverProps:Nn(_,I),arrowProps:R,underlayProps:D,placement:O}}function Ove(t){let[e,n]=Om(t.isOpen,t.defaultOpen||!1,t.onOpenChange);const r=H.useCallback(()=>{n(!0)},[n]),i=H.useCallback(()=>{n(!1)},[n]),a=H.useCallback(()=>{n(!e)},[n,e]);return{isOpen:e,setOpen:n,open:r,close:i,toggle:a}}var Mve="top";function Ive(t){var e,n,r;const i=as(),[a,o]=Gl(t,qN.variantKeys),{as:s,ref:l,children:c,state:f,triggerRef:u,scrollRef:d,defaultOpen:h,onOpenChange:p,isOpen:g,isNonModal:m=!0,shouldFlip:y=!0,containerPadding:v=12,shouldBlockScroll:x=!1,isDismissable:w=!0,shouldCloseOnBlur:S,portalContainer:T,updatePositionDeps:_,dialogProps:D,placement:I=Mve,triggerType:R="dialog",showArrow:O=!1,offset:P=7,crossOffset:N=0,boundaryElement:A,isKeyboardDismissDisabled:B,shouldCloseOnInteractOutside:V,shouldCloseOnScroll:$,motionProps:U,className:G,classNames:F,onClose:J,...Q}=a,ne=s||"div",ye=Ai(l),ve=H.useRef(null),Ce=H.useRef(!1),we=u||ve,Ae=(n=(e=t.disableAnimation)!=null?e:i?.disableAnimation)!=null?n:!1,Me=Ove({isOpen:g,defaultOpen:h,onOpenChange:ue=>{p?.(ue),ue||J?.()}}),q=f||Me,{popoverProps:k,underlayProps:Y,placement:X}=Dve({triggerRef:we,isNonModal:m,popoverRef:ye,placement:I,offset:P,scrollRef:d,isDismissable:w,shouldCloseOnBlur:S,boundaryElement:A,crossOffset:N,shouldFlip:y,containerPadding:v,updatePositionDeps:_,isKeyboardDismissDisabled:B,shouldCloseOnScroll:$,shouldCloseOnInteractOutside:V},q),re=H.useMemo(()=>X?H1e(X,I)?X:I:null,[X,I]),{triggerProps:de}=yhe({type:R},q,we),{isFocusVisible:he,isFocused:Ee,focusProps:Oe}=Fl(),Pe=H.useMemo(()=>qN({...o}),[$l(o)]),Ne=sn(F?.base,G);Wj({isDisabled:!(x&&q.isOpen)});const ie=(ue={})=>({ref:ye,...Nn(k,Q,ue),style:Nn(k.style,Q.style,ue.style)}),ae=(ue={})=>({"data-slot":"base","data-open":Lt(q.isOpen),"data-focus":Lt(Ee),"data-arrow":Lt(O),"data-focus-visible":Lt(he),"data-placement":X?ML(X,I):void 0,...Nn(Oe,D,ue),className:Pe.base({class:sn(Ne)}),style:{outline:"none"}}),Te=H.useCallback((ue={})=>({"data-slot":"content","data-open":Lt(q.isOpen),"data-arrow":Lt(O),"data-placement":X?ML(X,I):void 0,className:Pe.content({class:sn(F?.content,ue.className)})}),[Pe,q.isOpen,O,re,I,F,X]),me=H.useCallback(ue=>{var ut;let ht;return ue.pointerType==="touch"&&(t?.backdrop==="blur"||t?.backdrop==="opaque")?ht=setTimeout(()=>{Ce.current=!0},100):Ce.current=!0,(ut=de.onPress)==null||ut.call(de,ue),()=>{clearTimeout(ht)}},[de?.onPress]),Se=H.useCallback((ue={},ut=null)=>{const{isDisabled:ht,...Ot}=ue;return{"data-slot":"trigger",...Nn({"aria-haspopup":"dialog"},de,Ot),onPress:me,isDisabled:ht,className:Pe.trigger({class:sn(F?.trigger,ue.className),isTriggerDisabled:ht}),ref:p$(ut,we)}},[q,de,me,we]),Ve=H.useCallback((ue={})=>({"data-slot":"backdrop",className:Pe.backdrop({class:F?.backdrop}),onClick:ut=>{if(!Ce.current){ut.preventDefault();return}q.close(),Ce.current=!1},...Y,...ue}),[Pe,q.isOpen,F,Y]);return{state:q,Component:ne,children:c,classNames:F,showArrow:O,triggerRef:we,placement:re,isNonModal:m,popoverRef:ye,portalContainer:T,isOpen:q.isOpen,onClose:q.close,disableAnimation:Ae,shouldBlockScroll:x,backdrop:(r=t.backdrop)!=null?r:"transparent",motionProps:U,getBackdropProps:Ve,getPopoverProps:ie,getTriggerProps:Se,getDialogProps:ae,getContentProps:Te}}function Rve(t,e){let{role:n="dialog"}=t,r=sm();r=t["aria-label"]?void 0:r;let i=H.useRef(!1);return H.useEffect(()=>{if(e.current&&!e.current.contains(document.activeElement)){L2(e.current);let a=setTimeout(()=>{(document.activeElement===e.current||document.activeElement===document.body)&&(i.current=!0,e.current&&(e.current.blur(),L2(e.current)),i.current=!1)},500);return()=>{clearTimeout(a)}}},[e]),Rhe(),{dialogProps:{..._m(t,{labelable:!0}),role:n,tabIndex:-1,"aria-labelledby":t["aria-labelledby"]||r,onBlur:a=>{i.current&&a.stopPropagation()}},titleProps:{id:r}}}var PH=()=>Em(()=>import("./index-5oE8Zryh.js"),[]).then(t=>t.default),AH=Qi(({children:t,motionProps:e,placement:n,disableAnimation:r,style:i={},transformOrigin:a={},...o},s)=>{let l=i;return a.originX!==void 0||a.originY!==void 0?l={...l,transformOrigin:a}:n&&(l={...l,...z1e(n==="center"?"top":n)}),r?j.jsx("div",{...o,ref:s,children:t}):j.jsx(Pm,{features:PH,children:j.jsx(Oh.div,{ref:s,animate:"enter",exit:"exit",initial:"initial",style:l,variants:aH.scaleSpringOpacity,...Nn(o,e),children:t})})});AH.displayName="HeroUI.FreeSoloPopoverWrapper";var NH=Qi(({children:t,transformOrigin:e,disableDialogFocus:n=!1,...r},i)=>{const{Component:a,state:o,placement:s,backdrop:l,portalContainer:c,disableAnimation:f,motionProps:u,isNonModal:d,getPopoverProps:h,getBackdropProps:p,getDialogProps:g,getContentProps:m}=Ive({...r,ref:i}),y=H.useRef(null),{dialogProps:v,titleProps:x}=Rve({},y),w=g({...!n&&{ref:y},...v}),S=H.useMemo(()=>l==="transparent"?null:f?j.jsx("div",{...p()}):j.jsx(Pm,{features:PH,children:j.jsx(Oh.div,{animate:"enter",exit:"exit",initial:"exit",variants:aH.fade,...p()})}),[l,f,p]);return j.jsxs(Ihe,{portalContainer:c,children:[!d&&S,j.jsx(a,{...h(),children:j.jsxs(AH,{disableAnimation:f,motionProps:u,placement:s,tabIndex:-1,transformOrigin:e,...w,children:[!d&&j.jsx(LN,{onDismiss:o.close}),j.jsx("div",{...m(),children:typeof t=="function"?t(x):t}),j.jsx(LN,{onDismiss:o.close})]})})]})});NH.displayName="HeroUI.FreeSoloPopover";var Pve=NH,LH={};LH={longPressMessage:"اضغط مطولاً أو اضغط على Alt + السهم لأسفل لفتح القائمة"};var kH={};kH={longPressMessage:"Натиснете продължително или натиснете Alt+ стрелка надолу, за да отворите менюто"};var VH={};VH={longPressMessage:"Dlouhým stiskem nebo stisknutím kláves Alt + šipka dolů otevřete nabídku"};var FH={};FH={longPressMessage:"Langt tryk eller tryk på Alt + pil ned for at åbne menuen"};var UH={};UH={longPressMessage:"Drücken Sie lange oder drücken Sie Alt + Nach-unten, um das Menü zu öffnen"};var BH={};BH={longPressMessage:"Πιέστε παρατεταμένα ή πατήστε Alt + κάτω βέλος για να ανοίξετε το μενού"};var $H={};$H={longPressMessage:"Long press or press Alt + ArrowDown to open menu"};var GH={};GH={longPressMessage:"Mantenga pulsado o pulse Alt + flecha abajo para abrir el menú"};var jH={};jH={longPressMessage:"Menüü avamiseks vajutage pikalt või vajutage klahve Alt + allanool"};var zH={};zH={longPressMessage:"Avaa valikko painamalla pohjassa tai näppäinyhdistelmällä Alt + Alanuoli"};var WH={};WH={longPressMessage:"Appuyez de manière prolongée ou appuyez sur Alt + Flèche vers le bas pour ouvrir le menu."};var HH={};HH={longPressMessage:"לחץ לחיצה ארוכה או הקש Alt + ArrowDown כדי לפתוח את התפריט"};var KH={};KH={longPressMessage:"Dugo pritisnite ili pritisnite Alt + strelicu prema dolje za otvaranje izbornika"};var qH={};qH={longPressMessage:"Nyomja meg hosszan, vagy nyomja meg az Alt + lefele nyíl gombot a menü megnyitásához"};var XH={};XH={longPressMessage:"Premere a lungo o premere Alt + Freccia giù per aprire il menu"};var YH={};YH={longPressMessage:"長押しまたは Alt+下矢印キーでメニューを開く"};var JH={};JH={longPressMessage:"길게 누르거나 Alt + 아래쪽 화살표를 눌러 메뉴 열기"};var ZH={};ZH={longPressMessage:"Norėdami atidaryti meniu, nuspaudę palaikykite arba paspauskite „Alt + ArrowDown“."};var QH={};QH={longPressMessage:"Lai atvērtu izvēlni, turiet nospiestu vai nospiediet taustiņu kombināciju Alt + lejupvērstā bultiņa"};var eK={};eK={longPressMessage:"Langt trykk eller trykk Alt + PilNed for å åpne menyen"};var tK={};tK={longPressMessage:"Druk lang op Alt + pijl-omlaag of druk op Alt om het menu te openen"};var nK={};nK={longPressMessage:"Naciśnij i przytrzymaj lub naciśnij klawisze Alt + Strzałka w dół, aby otworzyć menu"};var rK={};rK={longPressMessage:"Pressione e segure ou pressione Alt + Seta para baixo para abrir o menu"};var iK={};iK={longPressMessage:"Prima continuamente ou prima Alt + Seta Para Baixo para abrir o menu"};var aK={};aK={longPressMessage:"Apăsați lung sau apăsați pe Alt + săgeată în jos pentru a deschide meniul"};var oK={};oK={longPressMessage:"Нажмите и удерживайте или нажмите Alt + Стрелка вниз, чтобы открыть меню"};var sK={};sK={longPressMessage:"Ponuku otvoríte dlhým stlačením alebo stlačením klávesu Alt + klávesu so šípkou nadol"};var lK={};lK={longPressMessage:"Za odprtje menija pritisnite in držite gumb ali pritisnite Alt+puščica navzdol"};var cK={};cK={longPressMessage:"Dugo pritisnite ili pritisnite Alt + strelicu prema dole da otvorite meni"};var uK={};uK={longPressMessage:"Håll nedtryckt eller tryck på Alt + pil nedåt för att öppna menyn"};var fK={};fK={longPressMessage:"Menüyü açmak için uzun basın veya Alt + Aşağı Ok tuşuna basın"};var dK={};dK={longPressMessage:"Довго або звичайно натисніть комбінацію клавіш Alt і стрілка вниз, щоб відкрити меню"};var hK={};hK={longPressMessage:"长按或按 Alt + 向下方向键以打开菜单"};var pK={};pK={longPressMessage:"長按或按 Alt+向下鍵以開啟功能表"};var gK={};gK={"ar-AE":LH,"bg-BG":kH,"cs-CZ":VH,"da-DK":FH,"de-DE":UH,"el-GR":BH,"en-US":$H,"es-ES":GH,"et-EE":jH,"fi-FI":zH,"fr-FR":WH,"he-IL":HH,"hr-HR":KH,"hu-HU":qH,"it-IT":XH,"ja-JP":YH,"ko-KR":JH,"lt-LT":ZH,"lv-LV":QH,"nb-NO":eK,"nl-NL":tK,"pl-PL":nK,"pt-BR":rK,"pt-PT":iK,"ro-RO":aK,"ru-RU":oK,"sk-SK":sK,"sl-SI":lK,"sr-SP":cK,"sv-SE":uK,"tr-TR":fK,"uk-UA":dK,"zh-CN":hK,"zh-TW":pK};const Ave=new WeakMap;function Nve(t){if(t.checked)return!0;let e=[];if(!t.form)e=[...In(t).querySelectorAll(`input[type="radio"][name="${CSS.escape(t.name)}"]`)].filter(a=>!a.form);else{var n,r;let a=(r=t.form)===null||r===void 0||(n=r.elements)===null||n===void 0?void 0:n.namedItem(t.name);e=[...a??[]]}return e?!e.some(a=>a.checked):!1}function mK(t,e){return!t||!e?!1:e.some(n=>n.contains(t))}function Lve(t,e,n){let r=e?.tabbable?A$:lC,i=t?.nodeType===Node.ELEMENT_NODE?t:null,a=In(i),o=S$(a,t||a,NodeFilter.SHOW_ELEMENT,{acceptNode(s){var l;return!(e==null||(l=e.from)===null||l===void 0)&&l.contains(s)||e?.tabbable&&s.tagName==="INPUT"&&s.getAttribute("type")==="radio"&&(!Nve(s)||o.currentNode.tagName==="INPUT"&&o.currentNode.type==="radio"&&o.currentNode.name===s.name)?NodeFilter.FILTER_REJECT:r(s)&&(!n||mK(s,n))&&(!e?.accept||e.accept(s))?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});return e?.from&&(o.currentNode=e.from),o}class MD{get size(){return this.fastMap.size}getTreeNode(e){return this.fastMap.get(e)}addTreeNode(e,n,r){let i=this.fastMap.get(n??null);if(!i)return;let a=new UL({scopeRef:e});i.addChild(a),a.parent=i,this.fastMap.set(e,a),r&&(a.nodeToRestore=r)}addNode(e){this.fastMap.set(e.scopeRef,e)}removeTreeNode(e){if(e===null)return;let n=this.fastMap.get(e);if(!n)return;let r=n.parent;for(let a of this.traverse())a!==n&&n.nodeToRestore&&a.nodeToRestore&&n.scopeRef&&n.scopeRef.current&&mK(a.nodeToRestore,n.scopeRef.current)&&(a.nodeToRestore=n.nodeToRestore);let i=n.children;r&&(r.removeChild(n),i.size>0&&i.forEach(a=>r&&r.addChild(a))),this.fastMap.delete(n.scopeRef)}*traverse(e=this.root){if(e.scopeRef!=null&&(yield e),e.children.size>0)for(let n of e.children)yield*this.traverse(n)}clone(){var e;let n=new MD;var r;for(let i of this.traverse())n.addTreeNode(i.scopeRef,(r=(e=i.parent)===null||e===void 0?void 0:e.scopeRef)!==null&&r!==void 0?r:null,i.nodeToRestore);return n}constructor(){this.fastMap=new Map,this.root=new UL({scopeRef:null}),this.fastMap.set(null,this.root)}}class UL{addChild(e){this.children.add(e),e.parent=this}removeChild(e){this.children.delete(e),e.parent=void 0}constructor(e){this.children=new Set,this.contain=!1,this.scopeRef=e.scopeRef}}new MD;function vK(t){let e=Vve(In(t));e!==t&&(e&&kve(e,t),t&&yK(t,e))}function kve(t,e){t.dispatchEvent(new FocusEvent("blur",{relatedTarget:e})),t.dispatchEvent(new FocusEvent("focusout",{bubbles:!0,relatedTarget:e}))}function yK(t,e){t.dispatchEvent(new FocusEvent("focus",{relatedTarget:e})),t.dispatchEvent(new FocusEvent("focusin",{bubbles:!0,relatedTarget:e}))}function Vve(t){let e=Ba(t),n=e?.getAttribute("aria-activedescendant");return n&&t.getElementById(n)||e}function Fve(t,e,n){let{type:r}=t,{isOpen:i}=e;H.useEffect(()=>{n&&n.current&&Ave.set(n.current,e.close)});let a;r==="menu"?a=!0:r==="listbox"&&(a="listbox");let o=rl();return{triggerProps:{"aria-haspopup":a,"aria-expanded":i,"aria-controls":i?o:void 0,onPress:e.toggle},overlayProps:{id:o}}}function Uve(t){return t&&t.__esModule?t.default:t}function Bve(t,e,n){let{type:r="menu",isDisabled:i,trigger:a="press"}=t,o=rl(),{triggerProps:s,overlayProps:l}=Fve({type:r},e,n),c=h=>{if(!i&&!(a==="longPress"&&!h.altKey)&&n&&n.current)switch(h.key){case"Enter":case" ":if(a==="longPress"||h.isDefaultPrevented())return;case"ArrowDown":"continuePropagation"in h||h.stopPropagation(),h.preventDefault(),e.toggle("first");break;case"ArrowUp":"continuePropagation"in h||h.stopPropagation(),h.preventDefault(),e.toggle("last");break;default:"continuePropagation"in h&&h.continuePropagation()}},f=mC(Uve(gK),"@react-aria/menu"),{longPressProps:u}=K0e({isDisabled:i||a!=="longPress",accessibilityDescription:f.format("longPressMessage"),onLongPressStart(){e.close()},onLongPress(){e.open("first")}}),d={preventFocusOnPress:!0,onPressStart(h){h.pointerType!=="touch"&&h.pointerType!=="keyboard"&&!i&&(Xi(h.target),e.open(h.pointerType==="virtual"?"first":null))},onPress(h){h.pointerType==="touch"&&!i&&(Xi(h.target),e.toggle())}};return delete s.onPress,{menuTriggerProps:{...s,...a==="press"?d:u,id:o,onKeyDown:c},menuProps:{...l,"aria-labelledby":o,autoFocus:e.focusStrategy||!0,onClose:e.close}}}function r_(t){return Fse()?t.altKey:t.ctrlKey}function kb(t,e){var n,r;let i=`[data-key="${CSS.escape(String(e))}"]`,a=(n=t.current)===null||n===void 0?void 0:n.dataset.collection;return a&&(i=`[data-collection="${CSS.escape(a)}"]${i}`),(r=t.current)===null||r===void 0?void 0:r.querySelector(i)}const xK=new WeakMap;function $ve(t){let e=rl();return xK.set(t,e),e}function Gve(t){return xK.get(t)}const jve=1e3;function zve(t){let{keyboardDelegate:e,selectionManager:n,onTypeSelect:r}=t,i=H.useRef({search:"",timeout:void 0}).current,a=o=>{let s=Wve(o.key);if(!(!s||o.ctrlKey||o.metaKey||!o.currentTarget.contains(o.target)||i.search.length===0&&s===" ")){if(s===" "&&i.search.trim().length>0&&(o.preventDefault(),"continuePropagation"in o||o.stopPropagation()),i.search+=s,e.getKeyForSearch!=null){let l=e.getKeyForSearch(i.search,n.focusedKey);l==null&&(l=e.getKeyForSearch(i.search)),l!=null&&(n.setFocusedKey(l),r&&r(l))}clearTimeout(i.timeout),i.timeout=setTimeout(()=>{i.search=""},jve)}};return{typeSelectProps:{onKeyDownCapture:e.getKeyForSearch?a:void 0}}}function Wve(t){return t.length===1||!/^[A-Z]/i.test(t)?t:""}function bK(t){let{selectionManager:e,keyboardDelegate:n,ref:r,autoFocus:i=!1,shouldFocusWrap:a=!1,disallowEmptySelection:o=!1,disallowSelectAll:s=!1,escapeKeyBehavior:l="clearSelection",selectOnFocus:c=e.selectionBehavior==="replace",disallowTypeAhead:f=!1,shouldUseVirtualFocus:u,allowsTabNavigation:d=!1,isVirtualized:h,scrollRef:p=r,linkBehavior:g="action"}=t,{direction:m}=wy(),y=R9(),v=$=>{var U;if($.altKey&&$.key==="Tab"&&$.preventDefault(),!(!((U=r.current)===null||U===void 0)&&U.contains($.target)))return;const G=(Y,X)=>{if(Y!=null){if(e.isLink(Y)&&g==="selection"&&c&&!r_($)){E9.flushSync(()=>{e.setFocusedKey(Y,X)});let re=kb(r,Y),de=e.getItemProps(Y);re&&y.open(re,$,de.href,de.routerOptions);return}if(e.setFocusedKey(Y,X),e.isLink(Y)&&g==="override")return;$.shiftKey&&e.selectionMode==="multiple"?e.extendSelection(Y):c&&!r_($)&&e.replaceSelection(Y)}};switch($.key){case"ArrowDown":if(n.getKeyBelow){var F,J,Q;let Y=e.focusedKey!=null?(F=n.getKeyBelow)===null||F===void 0?void 0:F.call(n,e.focusedKey):(J=n.getFirstKey)===null||J===void 0?void 0:J.call(n);Y==null&&a&&(Y=(Q=n.getFirstKey)===null||Q===void 0?void 0:Q.call(n,e.focusedKey)),Y!=null&&($.preventDefault(),G(Y))}break;case"ArrowUp":if(n.getKeyAbove){var ne,ye,ve;let Y=e.focusedKey!=null?(ne=n.getKeyAbove)===null||ne===void 0?void 0:ne.call(n,e.focusedKey):(ye=n.getLastKey)===null||ye===void 0?void 0:ye.call(n);Y==null&&a&&(Y=(ve=n.getLastKey)===null||ve===void 0?void 0:ve.call(n,e.focusedKey)),Y!=null&&($.preventDefault(),G(Y))}break;case"ArrowLeft":if(n.getKeyLeftOf){var Ce,we,Ae;let Y=e.focusedKey!=null?(Ce=n.getKeyLeftOf)===null||Ce===void 0?void 0:Ce.call(n,e.focusedKey):null;Y==null&&a&&(Y=m==="rtl"?(we=n.getFirstKey)===null||we===void 0?void 0:we.call(n,e.focusedKey):(Ae=n.getLastKey)===null||Ae===void 0?void 0:Ae.call(n,e.focusedKey)),Y!=null&&($.preventDefault(),G(Y,m==="rtl"?"first":"last"))}break;case"ArrowRight":if(n.getKeyRightOf){var Me,q,k;let Y=e.focusedKey!=null?(Me=n.getKeyRightOf)===null||Me===void 0?void 0:Me.call(n,e.focusedKey):null;Y==null&&a&&(Y=m==="rtl"?(q=n.getLastKey)===null||q===void 0?void 0:q.call(n,e.focusedKey):(k=n.getFirstKey)===null||k===void 0?void 0:k.call(n,e.focusedKey)),Y!=null&&($.preventDefault(),G(Y,m==="rtl"?"last":"first"))}break;case"Home":if(n.getFirstKey){if(e.focusedKey===null&&$.shiftKey)return;$.preventDefault();let Y=n.getFirstKey(e.focusedKey,Yp($));e.setFocusedKey(Y),Y!=null&&(Yp($)&&$.shiftKey&&e.selectionMode==="multiple"?e.extendSelection(Y):c&&e.replaceSelection(Y))}break;case"End":if(n.getLastKey){if(e.focusedKey===null&&$.shiftKey)return;$.preventDefault();let Y=n.getLastKey(e.focusedKey,Yp($));e.setFocusedKey(Y),Y!=null&&(Yp($)&&$.shiftKey&&e.selectionMode==="multiple"?e.extendSelection(Y):c&&e.replaceSelection(Y))}break;case"PageDown":if(n.getKeyPageBelow&&e.focusedKey!=null){let Y=n.getKeyPageBelow(e.focusedKey);Y!=null&&($.preventDefault(),G(Y))}break;case"PageUp":if(n.getKeyPageAbove&&e.focusedKey!=null){let Y=n.getKeyPageAbove(e.focusedKey);Y!=null&&($.preventDefault(),G(Y))}break;case"a":Yp($)&&e.selectionMode==="multiple"&&s!==!0&&($.preventDefault(),e.selectAll());break;case"Escape":l==="clearSelection"&&!o&&e.selectedKeys.size!==0&&($.stopPropagation(),$.preventDefault(),e.clearSelection());break;case"Tab":if(!d){if($.shiftKey)r.current.focus();else{let Y=Lve(r.current,{tabbable:!0}),X,re;do re=Y.lastChild(),re&&(X=re);while(re);X&&!X.contains(document.activeElement)&&Xi(X)}break}}},x=H.useRef({top:0,left:0});ex(p,"scroll",h?void 0:()=>{var $,U,G,F;x.current={top:(G=($=p.current)===null||$===void 0?void 0:$.scrollTop)!==null&&G!==void 0?G:0,left:(F=(U=p.current)===null||U===void 0?void 0:U.scrollLeft)!==null&&F!==void 0?F:0}});let w=$=>{if(e.isFocused){$.currentTarget.contains($.target)||e.setFocused(!1);return}if($.currentTarget.contains($.target)){if(e.setFocused(!0),e.focusedKey==null){var U,G;let Q=ye=>{ye!=null&&(e.setFocusedKey(ye),c&&!e.isSelected(ye)&&e.replaceSelection(ye))},ne=$.relatedTarget;var F,J;ne&&$.currentTarget.compareDocumentPosition(ne)&Node.DOCUMENT_POSITION_FOLLOWING?Q((F=e.lastSelectedKey)!==null&&F!==void 0?F:(U=n.getLastKey)===null||U===void 0?void 0:U.call(n)):Q((J=e.firstSelectedKey)!==null&&J!==void 0?J:(G=n.getFirstKey)===null||G===void 0?void 0:G.call(n))}else!h&&p.current&&(p.current.scrollTop=x.current.top,p.current.scrollLeft=x.current.left);if(e.focusedKey!=null&&p.current){let Q=kb(r,e.focusedKey);Q instanceof HTMLElement&&(!Q.contains(document.activeElement)&&!u&&Xi(Q),V6()==="keyboard"&&jP(Q,{containingElement:r.current}))}}},S=$=>{$.currentTarget.contains($.relatedTarget)||e.setFocused(!1)},T=H.useRef(!1);ex(r,Xse,u?$=>{let{detail:U}=$;$.stopPropagation(),e.setFocused(!0),U?.focusStrategy==="first"&&(T.current=!0)}:void 0);let _=Sr(()=>{var $,U;let G=(U=($=n.getFirstKey)===null||$===void 0?void 0:$.call(n))!==null&&U!==void 0?U:null;if(G==null){let F=Ba();vK(r.current),yK(F,null),e.collection.size>0&&(T.current=!1)}else e.setFocusedKey(G),T.current=!1});BP(()=>{T.current&&_()},[e.collection,_]);let D=Sr(()=>{e.collection.size>0&&(T.current=!1)});BP(()=>{D()},[e.focusedKey,D]),ex(r,qse,u?$=>{var U;$.stopPropagation(),e.setFocused(!1),!((U=$.detail)===null||U===void 0)&&U.clearFocusKey&&e.setFocusedKey(null)}:void 0);const I=H.useRef(i),R=H.useRef(!1);H.useEffect(()=>{if(I.current){var $,U;let J=null;var G;i==="first"&&(J=(G=($=n.getFirstKey)===null||$===void 0?void 0:$.call(n))!==null&&G!==void 0?G:null);var F;i==="last"&&(J=(F=(U=n.getLastKey)===null||U===void 0?void 0:U.call(n))!==null&&F!==void 0?F:null);let Q=e.selectedKeys;if(Q.size){for(let ne of Q)if(e.canSelectItem(ne)){J=ne;break}}e.setFocused(!0),e.setFocusedKey(J),J==null&&!u&&r.current&&L2(r.current),e.collection.size>0&&(I.current=!1,R.current=!0)}});let O=H.useRef(e.focusedKey),P=H.useRef(null);H.useEffect(()=>{if(e.isFocused&&e.focusedKey!=null&&(e.focusedKey!==O.current||R.current)&&p.current&&r.current){let $=V6(),U=kb(r,e.focusedKey);if(!(U instanceof HTMLElement))return;($==="keyboard"||R.current)&&(P.current&&cancelAnimationFrame(P.current),P.current=requestAnimationFrame(()=>{p.current&&(R$(p.current,U),$!=="virtual"&&jP(U,{containingElement:r.current}))}))}!u&&e.isFocused&&e.focusedKey==null&&O.current!=null&&r.current&&L2(r.current),O.current=e.focusedKey,R.current=!1}),H.useEffect(()=>()=>{P.current&&cancelAnimationFrame(P.current)},[]),ex(r,"react-aria-focus-scope-restore",$=>{$.preventDefault(),e.setFocused(!0)});let N={onKeyDown:v,onFocus:w,onBlur:S,onMouseDown($){p.current===$.target&&$.preventDefault()}},{typeSelectProps:A}=zve({keyboardDelegate:n,selectionManager:e});f||(N=Ji(A,N));let B;u||(B=e.focusedKey==null?0:-1);let V=$ve(e.collection);return{collectionProps:Ji(N,{tabIndex:B,"data-collection":V})}}function wK(t){let{id:e,selectionManager:n,key:r,ref:i,shouldSelectOnPressUp:a,shouldUseVirtualFocus:o,focus:s,isDisabled:l,onAction:c,allowsDifferentPressOrigin:f,linkBehavior:u="action"}=t,d=R9();e=rl(e);let h=G=>{if(G.pointerType==="keyboard"&&r_(G))n.toggleSelection(r);else{if(n.selectionMode==="none")return;if(n.isLink(r)){if(u==="selection"&&i.current){let F=n.getItemProps(r);d.open(i.current,G,F.href,F.routerOptions),n.setSelectedKeys(n.selectedKeys);return}else if(u==="override"||u==="none")return}n.selectionMode==="single"?n.isSelected(r)&&!n.disallowEmptySelection?n.toggleSelection(r):n.replaceSelection(r):G&&G.shiftKey?n.extendSelection(r):n.selectionBehavior==="toggle"||G&&(Yp(G)||G.pointerType==="touch"||G.pointerType==="virtual")?n.toggleSelection(r):n.replaceSelection(r)}};H.useEffect(()=>{r===n.focusedKey&&n.isFocused&&(o?vK(i.current):s?s():document.activeElement!==i.current&&i.current&&L2(i.current))},[i,r,n.focusedKey,n.childFocusStrategy,n.isFocused,o]),l=l||n.isDisabled(r);let p={};!o&&!l?p={tabIndex:r===n.focusedKey?0:-1,onFocus(G){G.target===i.current&&n.setFocusedKey(r)}}:l&&(p.onMouseDown=G=>{G.preventDefault()});let g=n.isLink(r)&&u==="override",m=n.isLink(r)&&u!=="selection"&&u!=="none",y=!l&&n.canSelectItem(r)&&!g,v=(c||m)&&!l,x=v&&(n.selectionBehavior==="replace"?!y:!y||n.isEmpty),w=v&&y&&n.selectionBehavior==="replace",S=x||w,T=H.useRef(null),_=S&&y,D=H.useRef(!1),I=H.useRef(!1),R=n.getItemProps(r),O=G=>{c&&c(),m&&i.current&&d.open(i.current,G,R.href,R.routerOptions)},P={ref:i};if(a?(P.onPressStart=G=>{T.current=G.pointerType,D.current=_,G.pointerType==="keyboard"&&(!S||$L())&&h(G)},f?(P.onPressUp=x?void 0:G=>{G.pointerType==="mouse"&&y&&h(G)},P.onPress=x?O:G=>{G.pointerType!=="keyboard"&&G.pointerType!=="mouse"&&y&&h(G)}):P.onPress=G=>{if(x||w&&G.pointerType!=="mouse"){if(G.pointerType==="keyboard"&&!BL())return;O(G)}else G.pointerType!=="keyboard"&&y&&h(G)}):(P.onPressStart=G=>{T.current=G.pointerType,D.current=_,I.current=x,y&&(G.pointerType==="mouse"&&!x||G.pointerType==="keyboard"&&(!v||$L()))&&h(G)},P.onPress=G=>{(G.pointerType==="touch"||G.pointerType==="pen"||G.pointerType==="virtual"||G.pointerType==="keyboard"&&S&&BL()||G.pointerType==="mouse"&&I.current)&&(S?O(G):y&&h(G))}),p["data-collection"]=Gve(n.collection),p["data-key"]=r,P.preventFocusOnPress=o,o&&(P=Ji(P,{onPressStart(G){G.pointerType!=="touch"&&(n.setFocused(!0),n.setFocusedKey(r))},onPress(G){G.pointerType==="touch"&&(n.setFocused(!0),n.setFocusedKey(r))}})),R)for(let G of["onPressStart","onPressEnd","onPressChange","onPress","onPressUp","onClick"])R[G]&&(P[G]=Zd(P[G],R[G]));let{pressProps:N,isPressed:A}=Uj(P),B=w?G=>{T.current==="mouse"&&(G.stopPropagation(),G.preventDefault(),O(G))}:void 0,{longPressProps:V}=vhe({isDisabled:!_,onLongPress(G){G.pointerType==="touch"&&(h(G),n.setSelectionBehavior("toggle"))}}),$=G=>{T.current==="touch"&&D.current&&G.preventDefault()},U=u!=="none"&&n.isLink(r)?G=>{Lf.isOpening||G.preventDefault()}:void 0;return{itemProps:Ji(p,y||x||o&&!l?N:{},_?V:{},{onDoubleClick:B,onDragStartCapture:$,onClick:U,id:e},o?{onMouseDown:G=>G.preventDefault()}:void 0),isPressed:A,isSelected:n.isSelected(r),isFocused:n.isFocused&&n.focusedKey===r,isDisabled:l,allowsSelection:y,hasAction:S}}function BL(){let t=window.event;return t?.key==="Enter"}function $L(){let t=window.event;return t?.key===" "||t?.code==="Space"}class GL{getItemRect(e){let n=this.ref.current;if(!n)return null;let r=e!=null?kb(this.ref,e):null;if(!r)return null;let i=n.getBoundingClientRect(),a=r.getBoundingClientRect();return{x:a.left-i.left+n.scrollLeft,y:a.top-i.top+n.scrollTop,width:a.width,height:a.height}}getContentSize(){let e=this.ref.current;var n,r;return{width:(n=e?.scrollWidth)!==null&&n!==void 0?n:0,height:(r=e?.scrollHeight)!==null&&r!==void 0?r:0}}getVisibleRect(){let e=this.ref.current;var n,r,i,a;return{x:(n=e?.scrollLeft)!==null&&n!==void 0?n:0,y:(r=e?.scrollTop)!==null&&r!==void 0?r:0,width:(i=e?.offsetWidth)!==null&&i!==void 0?i:0,height:(a=e?.offsetHeight)!==null&&a!==void 0?a:0}}constructor(e){this.ref=e}}class Hve{isDisabled(e){var n;return this.disabledBehavior==="all"&&(((n=e.props)===null||n===void 0?void 0:n.isDisabled)||this.disabledKeys.has(e.key))}findNextNonDisabled(e,n){let r=e;for(;r!=null;){let i=this.collection.getItem(r);if(i?.type==="item"&&!this.isDisabled(i))return r;r=n(r)}return null}getNextKey(e){let n=e;return n=this.collection.getKeyAfter(n),this.findNextNonDisabled(n,r=>this.collection.getKeyAfter(r))}getPreviousKey(e){let n=e;return n=this.collection.getKeyBefore(n),this.findNextNonDisabled(n,r=>this.collection.getKeyBefore(r))}findKey(e,n,r){let i=e,a=this.layoutDelegate.getItemRect(i);if(!a||i==null)return null;let o=a;do{if(i=n(i),i==null)break;a=this.layoutDelegate.getItemRect(i)}while(a&&r(o,a)&&i!=null);return i}isSameRow(e,n){return e.y===n.y||e.x!==n.x}isSameColumn(e,n){return e.x===n.x||e.y!==n.y}getKeyBelow(e){return this.layout==="grid"&&this.orientation==="vertical"?this.findKey(e,n=>this.getNextKey(n),this.isSameRow):this.getNextKey(e)}getKeyAbove(e){return this.layout==="grid"&&this.orientation==="vertical"?this.findKey(e,n=>this.getPreviousKey(n),this.isSameRow):this.getPreviousKey(e)}getNextColumn(e,n){return n?this.getPreviousKey(e):this.getNextKey(e)}getKeyRightOf(e){let n=this.direction==="ltr"?"getKeyRightOf":"getKeyLeftOf";return this.layoutDelegate[n]?(e=this.layoutDelegate[n](e),this.findNextNonDisabled(e,r=>this.layoutDelegate[n](r))):this.layout==="grid"?this.orientation==="vertical"?this.getNextColumn(e,this.direction==="rtl"):this.findKey(e,r=>this.getNextColumn(r,this.direction==="rtl"),this.isSameColumn):this.orientation==="horizontal"?this.getNextColumn(e,this.direction==="rtl"):null}getKeyLeftOf(e){let n=this.direction==="ltr"?"getKeyLeftOf":"getKeyRightOf";return this.layoutDelegate[n]?(e=this.layoutDelegate[n](e),this.findNextNonDisabled(e,r=>this.layoutDelegate[n](r))):this.layout==="grid"?this.orientation==="vertical"?this.getNextColumn(e,this.direction==="ltr"):this.findKey(e,r=>this.getNextColumn(r,this.direction==="ltr"),this.isSameColumn):this.orientation==="horizontal"?this.getNextColumn(e,this.direction==="ltr"):null}getFirstKey(){let e=this.collection.getFirstKey();return this.findNextNonDisabled(e,n=>this.collection.getKeyAfter(n))}getLastKey(){let e=this.collection.getLastKey();return this.findNextNonDisabled(e,n=>this.collection.getKeyBefore(n))}getKeyPageAbove(e){let n=this.ref.current,r=this.layoutDelegate.getItemRect(e);if(!r)return null;if(n&&!C2(n))return this.getFirstKey();let i=e;if(this.orientation==="horizontal"){let a=Math.max(0,r.x+r.width-this.layoutDelegate.getVisibleRect().width);for(;r&&r.x>a&&i!=null;)i=this.getKeyAbove(i),r=i==null?null:this.layoutDelegate.getItemRect(i)}else{let a=Math.max(0,r.y+r.height-this.layoutDelegate.getVisibleRect().height);for(;r&&r.y>a&&i!=null;)i=this.getKeyAbove(i),r=i==null?null:this.layoutDelegate.getItemRect(i)}return i??this.getFirstKey()}getKeyPageBelow(e){let n=this.ref.current,r=this.layoutDelegate.getItemRect(e);if(!r)return null;if(n&&!C2(n))return this.getLastKey();let i=e;if(this.orientation==="horizontal"){let a=Math.min(this.layoutDelegate.getContentSize().width,r.y-r.width+this.layoutDelegate.getVisibleRect().width);for(;r&&r.x<a&&i!=null;)i=this.getKeyBelow(i),r=i==null?null:this.layoutDelegate.getItemRect(i)}else{let a=Math.min(this.layoutDelegate.getContentSize().height,r.y-r.height+this.layoutDelegate.getVisibleRect().height);for(;r&&r.y<a&&i!=null;)i=this.getKeyBelow(i),r=i==null?null:this.layoutDelegate.getItemRect(i)}return i??this.getLastKey()}getKeyForSearch(e,n){if(!this.collator)return null;let r=this.collection,i=n||this.getFirstKey();for(;i!=null;){let a=r.getItem(i);if(!a)return null;let o=a.textValue.slice(0,e.length);if(a.textValue&&this.collator.compare(o,e)===0)return i;i=this.getNextKey(i)}return null}constructor(...e){if(e.length===1){let n=e[0];this.collection=n.collection,this.ref=n.ref,this.collator=n.collator,this.disabledKeys=n.disabledKeys||new Set,this.disabledBehavior=n.disabledBehavior||"all",this.orientation=n.orientation||"vertical",this.direction=n.direction,this.layout=n.layout||"stack",this.layoutDelegate=n.layoutDelegate||new GL(n.ref)}else this.collection=e[0],this.disabledKeys=e[1],this.ref=e[2],this.collator=e[3],this.layout="stack",this.orientation="vertical",this.disabledBehavior="all",this.layoutDelegate=new GL(this.ref);this.layout==="stack"&&this.orientation==="vertical"&&(this.getKeyLeftOf=void 0,this.getKeyRightOf=void 0)}}function Kve(t){let{selectionManager:e,collection:n,disabledKeys:r,ref:i,keyboardDelegate:a,layoutDelegate:o}=t,s=T0e({usage:"search",sensitivity:"base"}),l=e.disabledBehavior,c=H.useMemo(()=>a||new Hve({collection:n,disabledKeys:r,disabledBehavior:l,ref:i,collator:s,layoutDelegate:o}),[a,o,n,r,i,s,l]),{collectionProps:f}=bK({...t,ref:i,selectionManager:e,keyboardDelegate:c});return{listProps:f}}function qve(t){let e=Cve(t),[n,r]=H.useState(null),[i,a]=H.useState([]),o=()=>{a([]),e.close()};return{focusStrategy:n,...e,open(c=null){r(c),e.open()},toggle(c=null){r(c),e.toggle()},close(){o()},expandedKeysStack:i,openSubmenu:(c,f)=>{a(u=>f>u.length?u:[...u.slice(0,f),c])},closeSubmenu:(c,f)=>{a(u=>u[f]===c?u.slice(0,f):u)}}}function Ap(t,e,n){let r=n.initialDeps??[],i;return()=>{var a,o,s,l;let c;n.key&&((a=n.debug)!=null&&a.call(n))&&(c=Date.now());const f=t();if(!(f.length!==r.length||f.some((h,p)=>r[p]!==h)))return i;r=f;let d;if(n.key&&((o=n.debug)!=null&&o.call(n))&&(d=Date.now()),i=e(...f),n.key&&((s=n.debug)!=null&&s.call(n))){const h=Math.round((Date.now()-c)*100)/100,p=Math.round((Date.now()-d)*100)/100,g=p/16,m=(y,v)=>{for(y=String(y);y.length<v;)y=" "+y;return y};console.info(`%c⏱ ${m(p,5)} /${m(h,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*g,120))}deg 100% 31%);`,n?.key)}return(l=n?.onChange)==null||l.call(n,i),i}}function gE(t,e){if(t===void 0)throw new Error("Unexpected undefined");return t}const Xve=(t,e)=>Math.abs(t-e)<1,Yve=(t,e,n)=>{let r;return function(...i){t.clearTimeout(r),r=t.setTimeout(()=>e.apply(this,i),n)}},Jve=t=>t,Zve=t=>{const e=Math.max(t.startIndex-t.overscan,0),n=Math.min(t.endIndex+t.overscan,t.count-1),r=[];for(let i=e;i<=n;i++)r.push(i);return r},Qve=(t,e)=>{const n=t.scrollElement;if(!n)return;const r=t.targetWindow;if(!r)return;const i=o=>{const{width:s,height:l}=o;e({width:Math.round(s),height:Math.round(l)})};if(i(n.getBoundingClientRect()),!r.ResizeObserver)return()=>{};const a=new r.ResizeObserver(o=>{const s=o[0];if(s?.borderBoxSize){const l=s.borderBoxSize[0];if(l){i({width:l.inlineSize,height:l.blockSize});return}}i(n.getBoundingClientRect())});return a.observe(n,{box:"border-box"}),()=>{a.unobserve(n)}},jL={passive:!0},e2e=typeof window>"u"?!0:"onscrollend"in window,t2e=(t,e)=>{const n=t.scrollElement;if(!n)return;const r=t.targetWindow;if(!r)return;let i=0;const a=t.options.useScrollendEvent&&e2e?()=>{}:Yve(r,()=>{e(i,!1)},t.options.isScrollingResetDelay),o=c=>()=>{const{horizontal:f,isRtl:u}=t.options;i=f?n.scrollLeft*(u&&-1||1):n.scrollTop,a(),e(i,c)},s=o(!0),l=o(!1);return l(),n.addEventListener("scroll",s,jL),n.addEventListener("scrollend",l,jL),()=>{n.removeEventListener("scroll",s),n.removeEventListener("scrollend",l)}},n2e=(t,e,n)=>{if(e?.borderBoxSize){const r=e.borderBoxSize[0];if(r)return Math.round(r[n.options.horizontal?"inlineSize":"blockSize"])}return Math.round(t.getBoundingClientRect()[n.options.horizontal?"width":"height"])},r2e=(t,{adjustments:e=0,behavior:n},r)=>{var i,a;const o=t+e;(a=(i=r.scrollElement)==null?void 0:i.scrollTo)==null||a.call(i,{[r.options.horizontal?"left":"top"]:o,behavior:n})};class i2e{constructor(e){this.unsubs=[],this.scrollElement=null,this.targetWindow=null,this.isScrolling=!1,this.scrollToIndexTimeoutId=null,this.measurementsCache=[],this.itemSizeCache=new Map,this.pendingMeasuredCacheIndexes=[],this.scrollRect=null,this.scrollOffset=null,this.scrollDirection=null,this.scrollAdjustments=0,this.elementsCache=new Map,this.observer=(()=>{let n=null;const r=()=>n||(!this.targetWindow||!this.targetWindow.ResizeObserver?null:n=new this.targetWindow.ResizeObserver(i=>{i.forEach(a=>{this._measureElement(a.target,a)})}));return{disconnect:()=>{var i;(i=r())==null||i.disconnect(),n=null},observe:i=>{var a;return(a=r())==null?void 0:a.observe(i,{box:"border-box"})},unobserve:i=>{var a;return(a=r())==null?void 0:a.unobserve(i)}}})(),this.range=null,this.setOptions=n=>{Object.entries(n).forEach(([r,i])=>{typeof i>"u"&&delete n[r]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:Jve,rangeExtractor:Zve,onChange:()=>{},measureElement:n2e,initialRect:{width:0,height:0},scrollMargin:0,gap:0,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,isScrollingResetDelay:150,enabled:!0,isRtl:!1,useScrollendEvent:!0,...n}},this.notify=n=>{var r,i;(i=(r=this.options).onChange)==null||i.call(r,this,n)},this.maybeNotify=Ap(()=>(this.calculateRange(),[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]),n=>{this.notify(n)},{key:!1,debug:()=>this.options.debug,initialDeps:[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]}),this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(n=>n()),this.unsubs=[],this.observer.disconnect(),this.scrollElement=null,this.targetWindow=null},this._didMount=()=>()=>{this.cleanup()},this._willUpdate=()=>{var n;const r=this.options.enabled?this.options.getScrollElement():null;if(this.scrollElement!==r){if(this.cleanup(),!r){this.maybeNotify();return}this.scrollElement=r,this.scrollElement&&"ownerDocument"in this.scrollElement?this.targetWindow=this.scrollElement.ownerDocument.defaultView:this.targetWindow=((n=this.scrollElement)==null?void 0:n.window)??null,this.elementsCache.forEach(i=>{this.observer.observe(i)}),this._scrollToOffset(this.getScrollOffset(),{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,i=>{this.scrollRect=i,this.maybeNotify()})),this.unsubs.push(this.options.observeElementOffset(this,(i,a)=>{this.scrollAdjustments=0,this.scrollDirection=a?this.getScrollOffset()<i?"forward":"backward":null,this.scrollOffset=i,this.isScrolling=a,this.maybeNotify()}))}},this.getSize=()=>this.options.enabled?(this.scrollRect=this.scrollRect??this.options.initialRect,this.scrollRect[this.options.horizontal?"width":"height"]):(this.scrollRect=null,0),this.getScrollOffset=()=>this.options.enabled?(this.scrollOffset=this.scrollOffset??(typeof this.options.initialOffset=="function"?this.options.initialOffset():this.options.initialOffset),this.scrollOffset):(this.scrollOffset=null,0),this.getFurthestMeasurement=(n,r)=>{const i=new Map,a=new Map;for(let o=r-1;o>=0;o--){const s=n[o];if(i.has(s.lane))continue;const l=a.get(s.lane);if(l==null||s.end>l.end?a.set(s.lane,s):s.end<l.end&&i.set(s.lane,!0),i.size===this.options.lanes)break}return a.size===this.options.lanes?Array.from(a.values()).sort((o,s)=>o.end===s.end?o.index-s.index:o.end-s.end)[0]:void 0},this.getMeasurementOptions=Ap(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey,this.options.enabled],(n,r,i,a,o)=>(this.pendingMeasuredCacheIndexes=[],{count:n,paddingStart:r,scrollMargin:i,getItemKey:a,enabled:o}),{key:!1}),this.getMeasurements=Ap(()=>[this.getMeasurementOptions(),this.itemSizeCache],({count:n,paddingStart:r,scrollMargin:i,getItemKey:a,enabled:o},s)=>{if(!o)return this.measurementsCache=[],this.itemSizeCache.clear(),[];this.measurementsCache.length===0&&(this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(f=>{this.itemSizeCache.set(f.key,f.size)}));const l=this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[];const c=this.measurementsCache.slice(0,l);for(let f=l;f<n;f++){const u=a(f),d=this.options.lanes===1?c[f-1]:this.getFurthestMeasurement(c,f),h=d?d.end+this.options.gap:r+i,p=s.get(u),g=typeof p=="number"?p:this.options.estimateSize(f),m=h+g,y=d?d.lane:f%this.options.lanes;c[f]={index:f,start:h,size:g,end:m,key:u,lane:y}}return this.measurementsCache=c,c},{key:!1,debug:()=>this.options.debug}),this.calculateRange=Ap(()=>[this.getMeasurements(),this.getSize(),this.getScrollOffset()],(n,r,i)=>this.range=n.length>0&&r>0?a2e({measurements:n,outerSize:r,scrollOffset:i}):null,{key:!1,debug:()=>this.options.debug}),this.getIndexes=Ap(()=>{let n=null,r=null;const i=this.calculateRange();return i&&(n=i.startIndex,r=i.endIndex),[this.options.rangeExtractor,this.options.overscan,this.options.count,n,r]},(n,r,i,a,o)=>a===null||o===null?[]:n({startIndex:a,endIndex:o,overscan:r,count:i}),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=n=>{const r=this.options.indexAttribute,i=n.getAttribute(r);return i?parseInt(i,10):(console.warn(`Missing attribute name '${r}={index}' on measured element.`),-1)},this._measureElement=(n,r)=>{const i=this.indexFromElement(n),a=this.measurementsCache[i];if(!a)return;const o=a.key,s=this.elementsCache.get(o);s!==n&&(s&&this.observer.unobserve(s),this.observer.observe(n),this.elementsCache.set(o,n)),n.isConnected&&this.resizeItem(i,this.options.measureElement(n,r,this))},this.resizeItem=(n,r)=>{const i=this.measurementsCache[n];if(!i)return;const a=this.itemSizeCache.get(i.key)??i.size,o=r-a;o!==0&&((this.shouldAdjustScrollPositionOnItemSizeChange!==void 0?this.shouldAdjustScrollPositionOnItemSizeChange(i,o,this):i.start<this.getScrollOffset()+this.scrollAdjustments)&&this._scrollToOffset(this.getScrollOffset(),{adjustments:this.scrollAdjustments+=o,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(i.index),this.itemSizeCache=new Map(this.itemSizeCache.set(i.key,r)),this.notify(!1))},this.measureElement=n=>{if(!n){this.elementsCache.forEach((r,i)=>{r.isConnected||(this.observer.unobserve(r),this.elementsCache.delete(i))});return}this._measureElement(n,void 0)},this.getVirtualItems=Ap(()=>[this.getIndexes(),this.getMeasurements()],(n,r)=>{const i=[];for(let a=0,o=n.length;a<o;a++){const s=n[a],l=r[s];i.push(l)}return i},{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=n=>{const r=this.getMeasurements();if(r.length!==0)return gE(r[CK(0,r.length-1,i=>gE(r[i]).start,n)])},this.getOffsetForAlignment=(n,r)=>{const i=this.getSize(),a=this.getScrollOffset();r==="auto"&&n>=a+i&&(r="end"),r==="end"&&(n-=i);const o=this.options.horizontal?"scrollWidth":"scrollHeight",l=(this.scrollElement?"document"in this.scrollElement?this.scrollElement.document.documentElement[o]:this.scrollElement[o]:0)-i;return Math.max(Math.min(l,n),0)},this.getOffsetForIndex=(n,r="auto")=>{n=Math.max(0,Math.min(n,this.options.count-1));const i=this.measurementsCache[n];if(!i)return;const a=this.getSize(),o=this.getScrollOffset();if(r==="auto")if(i.end>=o+a-this.options.scrollPaddingEnd)r="end";else if(i.start<=o+this.options.scrollPaddingStart)r="start";else return[o,r];const s=i.start-this.options.scrollPaddingStart+(i.size-a)/2;switch(r){case"center":return[this.getOffsetForAlignment(s,r),r];case"end":return[this.getOffsetForAlignment(i.end+this.options.scrollPaddingEnd,r),r];default:return[this.getOffsetForAlignment(i.start-this.options.scrollPaddingStart,r),r]}},this.isDynamicMode=()=>this.elementsCache.size>0,this.cancelScrollToIndex=()=>{this.scrollToIndexTimeoutId!==null&&this.targetWindow&&(this.targetWindow.clearTimeout(this.scrollToIndexTimeoutId),this.scrollToIndexTimeoutId=null)},this.scrollToOffset=(n,{align:r="start",behavior:i}={})=>{this.cancelScrollToIndex(),i==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(n,r),{adjustments:void 0,behavior:i})},this.scrollToIndex=(n,{align:r="auto",behavior:i}={})=>{n=Math.max(0,Math.min(n,this.options.count-1)),this.cancelScrollToIndex(),i==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size.");const a=this.getOffsetForIndex(n,r);if(!a)return;const[o,s]=a;this._scrollToOffset(o,{adjustments:void 0,behavior:i}),i!=="smooth"&&this.isDynamicMode()&&this.targetWindow&&(this.scrollToIndexTimeoutId=this.targetWindow.setTimeout(()=>{if(this.scrollToIndexTimeoutId=null,this.elementsCache.has(this.options.getItemKey(n))){const[c]=gE(this.getOffsetForIndex(n,s));Xve(c,this.getScrollOffset())||this.scrollToIndex(n,{align:s,behavior:i})}else this.scrollToIndex(n,{align:s,behavior:i})}))},this.scrollBy=(n,{behavior:r}={})=>{this.cancelScrollToIndex(),r==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getScrollOffset()+n,{adjustments:void 0,behavior:r})},this.getTotalSize=()=>{var n;const r=this.getMeasurements();let i;return r.length===0?i=this.options.paddingStart:i=this.options.lanes===1?((n=r[r.length-1])==null?void 0:n.end)??0:Math.max(...r.slice(-this.options.lanes).map(a=>a.end)),Math.max(i-this.options.scrollMargin+this.options.paddingEnd,0)},this._scrollToOffset=(n,{adjustments:r,behavior:i})=>{this.options.scrollToFn(n,{behavior:i,adjustments:r},this)},this.measure=()=>{this.itemSizeCache=new Map,this.notify(!1)},this.setOptions(e)}}const CK=(t,e,n,r)=>{for(;t<=e;){const i=(t+e)/2|0,a=n(i);if(a<r)t=i+1;else if(a>r)e=i-1;else return i}return t>0?t-1:0};function a2e({measurements:t,outerSize:e,scrollOffset:n}){const r=t.length-1,a=CK(0,r,s=>t[s].start,n);let o=a;for(;o<r&&t[o].end<n+e;)o++;return{startIndex:a,endIndex:o}}const zL=typeof document<"u"?H.useLayoutEffect:H.useEffect;function o2e(t){const e=H.useReducer(()=>({}),{})[1],n={...t,onChange:(i,a)=>{var o;a?E9.flushSync(e):e(),(o=t.onChange)==null||o.call(t,i,a)}},[r]=H.useState(()=>new i2e(n));return r.setOptions(n),zL(()=>r._didMount(),[]),zL(()=>r._willUpdate()),r}function s2e(t){return o2e({observeElementRect:Qve,observeElementOffset:t2e,scrollToFn:r2e,...t})}const SK=new WeakMap;function Bw(t,e,n){return t?(typeof e=="string"&&(e=e.replace(/\s+/g,"")),`${SK.get(t)}-${n}-${e}`):""}function l2e(t,e,n){let{key:r,isDisabled:i,shouldSelectOnPressUp:a}=t,{selectionManager:o,selectedKey:s}=e,l=r===s,c=i||e.isDisabled||e.selectionManager.isDisabled(r),{itemProps:f,isPressed:u}=wK({selectionManager:o,key:r,ref:n,isDisabled:c,shouldSelectOnPressUp:a,linkBehavior:"selection"}),d=Bw(e,r,"tab"),h=Bw(e,r,"tabpanel"),{tabIndex:p}=f,g=e.collection.getItem(r),m=_m(g?.props,{labelable:!0});delete m.id;let y=O$(g?.props),{focusableProps:v}=yC({isDisabled:c},n);return{tabProps:Ji(m,v,y,f,{id:d,"aria-selected":l,"aria-disabled":c||void 0,"aria-controls":l?h:void 0,tabIndex:c?void 0:p,role:"tab"}),isSelected:l,isDisabled:c,isPressed:u}}function c2e(t,e,n){let r=rhe(n)?void 0:0;var i;const a=Bw(e,(i=t.id)!==null&&i!==void 0?i:e?.selectedKey,"tabpanel"),o=oC({...t,id:a,"aria-labelledby":Bw(e,e?.selectedKey,"tab")});return{tabPanelProps:Ji(o,{tabIndex:r,role:"tabpanel","aria-describedby":t["aria-describedby"],"aria-details":t["aria-details"]})}}class u2e{getKeyLeftOf(e){return this.flipDirection?this.getNextKey(e):this.getPreviousKey(e)}getKeyRightOf(e){return this.flipDirection?this.getPreviousKey(e):this.getNextKey(e)}isDisabled(e){var n,r;return this.disabledKeys.has(e)||!!(!((r=this.collection.getItem(e))===null||r===void 0||(n=r.props)===null||n===void 0)&&n.isDisabled)}getFirstKey(){let e=this.collection.getFirstKey();return e!=null&&this.isDisabled(e)&&(e=this.getNextKey(e)),e}getLastKey(){let e=this.collection.getLastKey();return e!=null&&this.isDisabled(e)&&(e=this.getPreviousKey(e)),e}getKeyAbove(e){return this.tabDirection?null:this.getPreviousKey(e)}getKeyBelow(e){return this.tabDirection?null:this.getNextKey(e)}getNextKey(e){let n=e;do n=this.collection.getKeyAfter(n),n==null&&(n=this.collection.getFirstKey());while(n!=null&&this.isDisabled(n));return n}getPreviousKey(e){let n=e;do n=this.collection.getKeyBefore(n),n==null&&(n=this.collection.getLastKey());while(n!=null&&this.isDisabled(n));return n}constructor(e,n,r,i=new Set){this.collection=e,this.flipDirection=n==="rtl"&&r==="horizontal",this.disabledKeys=i,this.tabDirection=r==="horizontal"}}function f2e(t,e,n){let{orientation:r="horizontal",keyboardActivation:i="automatic"}=t,{collection:a,selectionManager:o,disabledKeys:s}=e,{direction:l}=wy(),c=H.useMemo(()=>new u2e(a,l,r,s),[a,s,r,l]),{collectionProps:f}=bK({ref:n,selectionManager:o,keyboardDelegate:c,selectOnFocus:i==="automatic",disallowEmptySelection:!0,scrollRef:n,linkBehavior:"selection"}),u=rl();SK.set(e,u);let d=oC({...t,id:u});return{tabListProps:{...Ji(f,d),role:"tablist","aria-orientation":r,tabIndex:void 0}}}var TK=Qi((t,e)=>{var n,r;const{as:i,tabKey:a,destroyInactiveTabPanel:o,state:s,className:l,slots:c,classNames:f,...u}=t,d=i||"div",h=Ai(e),{tabPanelProps:p}=c2e({...t,id:String(a)},s,h),{focusProps:g,isFocused:m,isFocusVisible:y}=Fl(),v=s.selectedItem,x=s.collection.getItem(a).props.children,w=sn(f?.panel,l,(n=v?.props)==null?void 0:n.className),S=a===v?.key;return!x||!S&&o?null:j.jsx(d,{ref:h,"data-focus":m,"data-focus-visible":y,"data-inert":S?void 0:"true",inert:Woe(!S),...S&&Nn(p,g,u),className:(r=c.panel)==null?void 0:r.call(c,{class:w}),"data-slot":"panel",children:x})});TK.displayName="HeroUI.TabPanel";var d2e=TK,EK=Qi((t,e)=>{var n;const{className:r,as:i,item:a,state:o,classNames:s,isDisabled:l,listRef:c,slots:f,motionProps:u,disableAnimation:d,disableCursorAnimation:h,shouldSelectOnPressUp:p,tabRef:g,...m}=t,{key:y}=a,v=Ai(e),x=i||(t.href?"a":"button"),w=typeof x=="string",{tabProps:S,isSelected:T,isDisabled:_,isPressed:D}=l2e({key:y,isDisabled:l,shouldSelectOnPressUp:p},o,v);t.children==null&&delete S["aria-controls"];const I=l||_,{focusProps:R,isFocused:O,isFocusVisible:P}=Fl(),{hoverProps:N,isHovered:A}=il({isDisabled:I}),B=sn(s?.tab,r),[,V]=Tve({rerender:!0}),$=()=>{!v?.current||!c?.current||MH(v.current,{scrollMode:"if-needed",behavior:"smooth",block:"end",inline:"end",boundary:c?.current})};return j.jsxs(x,{ref:Qoe(v,g),"data-disabled":Lt(_),"data-focus":Lt(O),"data-focus-visible":Lt(P),"data-hover":Lt(A),"data-hover-unselected":Lt((A||D)&&!T),"data-pressed":Lt(D),"data-selected":Lt(T),"data-slot":"tab",...Nn(S,I?{}:{...R,...N},Lo(m,{enabled:w,omitPropNames:new Set(["title"]),omitEventNames:new Set(["onClick"])}),{onClick:Nf($,S.onClick)}),className:(n=f.tab)==null?void 0:n.call(f,{class:B}),title:m?.titleValue,type:x==="button"?"button":void 0,children:[T&&!d&&!h&&V?j.jsx(Pm,{features:Bde,children:j.jsx(Oh.span,{className:f.cursor({class:s?.cursor}),"data-slot":"cursor",layoutDependency:!1,layoutId:"cursor",transition:{type:"spring",bounce:.15,duration:.5},...u})}):null,j.jsx("div",{className:f.tabContent({class:s?.tabContent}),"data-slot":"tabContent",children:a.rendered})]})});EK.displayName="HeroUI.Tab";var h2e=EK;let WL=class{*[Symbol.iterator](){yield*this.iterable}get size(){return this._size}getKeys(){return this.keyMap.keys()}getKeyBefore(e){let n=this.keyMap.get(e);var r;return n&&(r=n.prevKey)!==null&&r!==void 0?r:null}getKeyAfter(e){let n=this.keyMap.get(e);var r;return n&&(r=n.nextKey)!==null&&r!==void 0?r:null}getFirstKey(){return this.firstKey}getLastKey(){return this.lastKey}getItem(e){var n;return(n=this.keyMap.get(e))!==null&&n!==void 0?n:null}at(e){const n=[...this.getKeys()];return this.getItem(n[e])}getChildren(e){let n=this.keyMap.get(e);return n?.childNodes||[]}constructor(e){this.keyMap=new Map,this.firstKey=null,this.lastKey=null,this.iterable=e;let n=s=>{if(this.keyMap.set(s.key,s),s.childNodes&&s.type==="section")for(let l of s.childNodes)n(l)};for(let s of e)n(s);let r=null,i=0,a=0;for(let[s,l]of this.keyMap)r?(r.nextKey=s,l.prevKey=r.key):(this.firstKey=s,l.prevKey=void 0),l.type==="item"&&(l.index=i++),(l.type==="section"||l.type==="item")&&a++,r=l,r.nextKey=void 0;this._size=a;var o;this.lastKey=(o=r?.key)!==null&&o!==void 0?o:null}};function p2e(t){let{filter:e,layoutDelegate:n}=t,r=oH(t),i=H.useMemo(()=>t.disabledKeys?new Set(t.disabledKeys):new Set,[t.disabledKeys]),a=H.useCallback(c=>e?new WL(e(c)):new WL(c),[e]),o=H.useMemo(()=>({suppressTextValueWarning:t.suppressTextValueWarning}),[t.suppressTextValueWarning]),s=sH(t,a,o),l=H.useMemo(()=>new DC(s,r,{layoutDelegate:n}),[s,r,n]);return g2e(s,l),{collection:s,disabledKeys:i,selectionManager:l}}function g2e(t,e){const n=H.useRef(null);H.useEffect(()=>{if(e.focusedKey!=null&&!t.getItem(e.focusedKey)&&n.current){const f=n.current.getItem(e.focusedKey),u=[...n.current.getKeys()].map(y=>{const v=n.current.getItem(y);return v?.type==="item"?v:null}).filter(y=>y!==null),d=[...t.getKeys()].map(y=>{const v=t.getItem(y);return v?.type==="item"?v:null}).filter(y=>y!==null);var r,i;const h=((r=u?.length)!==null&&r!==void 0?r:0)-((i=d?.length)!==null&&i!==void 0?i:0);var a,o,s;let p=Math.min(h>1?Math.max(((a=f?.index)!==null&&a!==void 0?a:0)-h+1,0):(o=f?.index)!==null&&o!==void 0?o:0,((s=d?.length)!==null&&s!==void 0?s:0)-1),g=null,m=!1;for(;p>=0;){if(!e.isDisabled(d[p].key)){g=d[p];break}if(p<d.length-1&&!m)p++;else{m=!0;var l,c;p>((l=f?.index)!==null&&l!==void 0?l:0)&&(p=(c=f?.index)!==null&&c!==void 0?c:0),p--}}e.setFocusedKey(g?g.key:null)}n.current=t},[t,e])}function m2e(t){var e;let[n,r]=Om(t.selectedKey,(e=t.defaultSelectedKey)!==null&&e!==void 0?e:null,t.onSelectionChange),i=H.useMemo(()=>n!=null?[n]:[],[n]),{collection:a,disabledKeys:o,selectionManager:s}=p2e({...t,selectionMode:"single",disallowEmptySelection:!0,allowDuplicateSelectionEvents:!0,selectedKeys:i,onSelectionChange:c=>{if(c==="all")return;var f;let u=(f=c.values().next().value)!==null&&f!==void 0?f:null;u===n&&t.onSelectionChange&&t.onSelectionChange(u),r(u)}}),l=n!=null?a.getItem(n):null;return{collection:a,disabledKeys:o,selectionManager:s,selectedKey:n,setSelectedKey:r,selectedItem:l}}function v2e(t){var e,n;let r=m2e({...t,onSelectionChange:t.onSelectionChange?l=>{var c;l!=null&&((c=t.onSelectionChange)===null||c===void 0||c.call(t,l))}:void 0,suppressTextValueWarning:!0,defaultSelectedKey:(n=(e=t.defaultSelectedKey)!==null&&e!==void 0?e:HL(t.collection,t.disabledKeys?new Set(t.disabledKeys):new Set))!==null&&n!==void 0?n:void 0}),{selectionManager:i,collection:a,selectedKey:o}=r,s=H.useRef(o);return H.useEffect(()=>{let l=o;t.selectedKey==null&&(i.isEmpty||l==null||!a.getItem(l))&&(l=HL(a,r.disabledKeys),l!=null&&i.setSelectedKeys([l])),(l!=null&&i.focusedKey==null||!i.isFocused&&l!==s.current)&&i.setFocusedKey(l),s.current=l}),{...r,isDisabled:t.isDisabled||!1}}function HL(t,e){let n=null;if(t){var r,i,a,o;for(n=t.getFirstKey();n!=null&&(e.has(n)||!((i=t.getItem(n))===null||i===void 0||(r=i.props)===null||r===void 0)&&r.isDisabled)&&n!==t.getLastKey();)n=t.getKeyAfter(n);n!=null&&(e.has(n)||!((o=t.getItem(n))===null||o===void 0||(a=o.props)===null||a===void 0)&&a.isDisabled)&&n===t.getLastKey()&&(n=t.getFirstKey())}return n}function y2e(t){var e,n,r;const i=as(),[a,o]=Gl(t,WN.variantKeys),{ref:s,as:l,className:c,classNames:f,children:u,disableCursorAnimation:d,motionProps:h,isVertical:p=!1,shouldSelectOnPressUp:g=!0,destroyInactiveTabPanel:m=!0,...y}=a,v=l||"div",x=typeof v=="string",w=Ai(s),S=(n=(e=t?.disableAnimation)!=null?e:i?.disableAnimation)!=null?n:!1,T=v2e({children:u,...y}),{tabListProps:_}=f2e(y,T,w),D=H.useMemo(()=>WN({...o,disableAnimation:S,...p?{placement:"start"}:{}}),[$l(o),S,p]),I=sn(f?.base,c),R=H.useMemo(()=>({state:T,slots:D,classNames:f,motionProps:h,disableAnimation:S,listRef:w,shouldSelectOnPressUp:g,disableCursorAnimation:d,isDisabled:t?.isDisabled}),[T,D,w,h,S,d,g,t?.isDisabled,f]),O=H.useCallback(B=>({"data-slot":"base",className:D.base({class:sn(I,B?.className)}),...Nn(Lo(y,{enabled:x}),B)}),[I,y,D]),P=(r=o.placement)!=null?r:p?"start":"top",N=H.useCallback(B=>({"data-slot":"tabWrapper",className:D.tabWrapper({class:sn(f?.tabWrapper,B?.className)}),"data-placement":P,"data-vertical":p||P==="start"||P==="end"?"vertical":"horizontal"}),[f,D,P,p]),A=H.useCallback(B=>({ref:w,"data-slot":"tabList",className:D.tabList({class:sn(f?.tabList,B?.className)}),...Nn(_,B)}),[w,_,f,D]);return{Component:v,domRef:w,state:T,values:R,destroyInactiveTabPanel:m,getBaseProps:O,getTabListProps:A,getWrapperProps:N}}var x2e=Qi(function(e,n){const{Component:r,values:i,state:a,destroyInactiveTabPanel:o,getBaseProps:s,getTabListProps:l,getWrapperProps:c}=y2e({...e,ref:n}),f=H.useId(),u=!e.disableAnimation&&!e.disableCursorAnimation,d={state:a,listRef:i.listRef,slots:i.slots,classNames:i.classNames,isDisabled:i.isDisabled,motionProps:i.motionProps,disableAnimation:i.disableAnimation,shouldSelectOnPressUp:i.shouldSelectOnPressUp,disableCursorAnimation:i.disableCursorAnimation},h=[...a.collection].map(g=>j.jsx(h2e,{item:g,...d,...g.props},g.key)),p=j.jsxs(j.Fragment,{children:[j.jsx("div",{...s(),children:j.jsx(r,{...l(),children:u?j.jsx(lue,{id:f,children:h}):h})}),[...a.collection].map(g=>j.jsx(d2e,{classNames:i.classNames,destroyInactiveTabPanel:o,slots:i.slots,state:i.state,tabKey:g.key},g.key))]});return"placement"in e||"isVertical"in e?j.jsx("div",{...c(),children:p}):p}),b2e=x2e,w2e=fH,mE=w2e;function C2e(t={}){const{domRef:e,isEnabled:n=!0,overflowCheck:r="vertical",visibility:i="auto",offset:a=0,onVisibilityChange:o,updateDeps:s=[]}=t,l=H.useRef(i);H.useEffect(()=>{const c=e?.current;if(!c||!n)return;const f=(h,p,g,m,y)=>{if(i==="auto"){const v=`${m}${f$(y)}Scroll`;p&&g?(c.dataset[v]="true",c.removeAttribute(`data-${m}-scroll`),c.removeAttribute(`data-${y}-scroll`)):(c.dataset[`${m}Scroll`]=p.toString(),c.dataset[`${y}Scroll`]=g.toString(),c.removeAttribute(`data-${m}-${y}-scroll`))}else{const v=p&&g?"both":p?m:g?y:"none";v!==l.current&&(o?.(v),l.current=v)}},u=()=>{var h,p;const g=[{type:"vertical",prefix:"top",suffix:"bottom"},{type:"horizontal",prefix:"left",suffix:"right"}],m=c.querySelector('ul[data-slot="list"]'),y=+((h=m?.getAttribute("data-virtual-scroll-height"))!=null?h:c.scrollHeight),v=+((p=m?.getAttribute("data-virtual-scroll-top"))!=null?p:c.scrollTop);for(const{type:x,prefix:w,suffix:S}of g)if(r===x||r==="both"){const T=x==="vertical"?v>a:c.scrollLeft>a,_=x==="vertical"?v+c.clientHeight+a<y:c.scrollLeft+c.clientWidth+a<c.scrollWidth;f(x,T,_,w,S)}},d=()=>{["top","bottom","top-bottom","left","right","left-right"].forEach(h=>{c.removeAttribute(`data-${h}-scroll`)})};return u(),c.addEventListener("scroll",u,!0),i!=="auto"&&(d(),i==="both"?(c.dataset.topBottomScroll=String(r==="vertical"),c.dataset.leftRightScroll=String(r==="horizontal")):(c.dataset.topBottomScroll="false",c.dataset.leftRightScroll="false",["top","bottom","left","right"].forEach(h=>{c.dataset[`${h}Scroll`]=String(i===h)}))),()=>{c.removeEventListener("scroll",u,!0),d()}},[...s,n,i,r,o,e])}function S2e(t){var e;const[n,r]=Gl(t,kw.variantKeys),{ref:i,as:a,children:o,className:s,style:l,size:c=40,offset:f=0,visibility:u="auto",isEnabled:d=!0,onVisibilityChange:h,...p}=n,g=a||"div",m=Ai(i);C2e({domRef:m,offset:f,visibility:u,isEnabled:d,onVisibilityChange:h,updateDeps:[o],overflowCheck:(e=t.orientation)!=null?e:"vertical"});const y=H.useMemo(()=>kw({...r,className:s}),[$l(r),s]);return{Component:g,styles:y,domRef:m,children:o,getBaseProps:(x={})=>{var w;return{ref:m,className:y,"data-orientation":(w=t.orientation)!=null?w:"vertical",style:{"--scroll-shadow-size":`${c}px`,...l,...x.style},...p,...x}}}}var _K=Qi((t,e)=>{const{Component:n,children:r,getBaseProps:i}=S2e({...t,ref:e});return j.jsx(n,{...i(),children:r})});_K.displayName="HeroUI.ScrollShadow";var T2e=_K;class KL{*[Symbol.iterator](){yield*this.iterable}get size(){return this.keyMap.size}getKeys(){return this.keyMap.keys()}getKeyBefore(e){let n=this.keyMap.get(e);var r;return n&&(r=n.prevKey)!==null&&r!==void 0?r:null}getKeyAfter(e){let n=this.keyMap.get(e);var r;return n&&(r=n.nextKey)!==null&&r!==void 0?r:null}getFirstKey(){return this.firstKey}getLastKey(){return this.lastKey}getItem(e){var n;return(n=this.keyMap.get(e))!==null&&n!==void 0?n:null}at(e){const n=[...this.getKeys()];return this.getItem(n[e])}getChildren(e){let n=this.keyMap.get(e);return n?.childNodes||[]}constructor(e){this.keyMap=new Map,this.firstKey=null,this.lastKey=null,this.iterable=e;let n=o=>{if(this.keyMap.set(o.key,o),o.childNodes&&o.type==="section")for(let s of o.childNodes)n(s)};for(let o of e)n(o);let r=null,i=0;for(let[o,s]of this.keyMap)r?(r.nextKey=o,s.prevKey=r.key):(this.firstKey=o,s.prevKey=void 0),s.type==="item"&&(s.index=i++),r=s,r.nextKey=void 0;var a;this.lastKey=(a=r?.key)!==null&&a!==void 0?a:null}}function DK(t){let{filter:e,layoutDelegate:n}=t,r=oH(t),i=H.useMemo(()=>t.disabledKeys?new Set(t.disabledKeys):new Set,[t.disabledKeys]),a=H.useCallback(c=>e?new KL(e(c)):new KL(c),[e]),o=H.useMemo(()=>({suppressTextValueWarning:t.suppressTextValueWarning}),[t.suppressTextValueWarning]),s=sH(t,a,o),l=H.useMemo(()=>new DC(s,r,{layoutDelegate:n}),[s,r,n]);return E2e(s,l),{collection:s,disabledKeys:i,selectionManager:l}}function E2e(t,e){const n=H.useRef(null);H.useEffect(()=>{if(e.focusedKey!=null&&!t.getItem(e.focusedKey)&&n.current){const f=n.current.getItem(e.focusedKey),u=[...n.current.getKeys()].map(y=>{const v=n.current.getItem(y);return v?.type==="item"?v:null}).filter(y=>y!==null),d=[...t.getKeys()].map(y=>{const v=t.getItem(y);return v?.type==="item"?v:null}).filter(y=>y!==null);var r,i;const h=((r=u?.length)!==null&&r!==void 0?r:0)-((i=d?.length)!==null&&i!==void 0?i:0);var a,o,s;let p=Math.min(h>1?Math.max(((a=f?.index)!==null&&a!==void 0?a:0)-h+1,0):(o=f?.index)!==null&&o!==void 0?o:0,((s=d?.length)!==null&&s!==void 0?s:0)-1),g=null,m=!1;for(;p>=0;){if(!e.isDisabled(d[p].key)){g=d[p];break}if(p<d.length-1&&!m)p++;else{m=!0;var l,c;p>((l=f?.index)!==null&&l!==void 0?l:0)&&(p=(c=f?.index)!==null&&c!==void 0?c:0),p--}}e.setFocusedKey(g?g.key:null)}n.current=t},[t,e])}function _2e(t){const{collection:e,disabledKeys:n,selectionManager:r,selectionManager:{setSelectedKeys:i,selectedKeys:a,selectionMode:o}}=DK(t),s=H.useMemo(()=>!t.isLoading&&a.size!==0?Array.from(a).filter(Boolean).filter(c=>!e.getItem(c)):[],[a,e]),l=a.size!==0?Array.from(a).map(c=>e.getItem(c)).filter(Boolean):null;return s.length&&console.warn(`Select: Keys "${s.join(", ")}" passed to "selectedKeys" are not present in the collection.`),{collection:e,disabledKeys:n,selectionManager:r,selectionMode:o,selectedKeys:a,setSelectedKeys:i.bind(r),selectedItems:l}}function D2e({validate:t,validationBehavior:e,...n}){const[r,i]=H.useState(!1),[a,o]=H.useState(null),s=qve(n),l=_2e({...n,onSelectionChange:u=>{n.onSelectionChange!=null&&(u==="all"?n.onSelectionChange(new Set(l.collection.getKeys())):n.onSelectionChange(u)),n.selectionMode==="single"&&s.close()}}),c=dve({...n,validationBehavior:e,validate:u=>{if(!t)return;const d=Array.from(u);return t(n.selectionMode==="single"?d[0]:d)},value:l.selectedKeys}),f=l.collection.size===0&&n.hideEmptyContent;return{...c,...l,...s,focusStrategy:a,close(){s.close()},open(u=null){f||(o(u),s.open())},toggle(u=null){f||(o(u),s.toggle())},isFocused:r,setFocused:i}}function O2e(t){let{id:e,label:n,"aria-labelledby":r,"aria-label":i,labelElementType:a="label"}=t;e=R2(e);let o=R2(),s={};n&&(r=r?`${o} ${r}`:o,s={id:o,htmlFor:a==="label"?e:void 0});let l=s0e({id:e,"aria-label":i,"aria-labelledby":r});return{labelProps:s,fieldProps:l}}function M2e(t){let{description:e,errorMessage:n,isInvalid:r,validationState:i}=t,{labelProps:a,fieldProps:o}=O2e(t),s=aN([!!e,!!n,r,i]),l=aN([!!e,!!n,r,i]);return o=P2(o,{"aria-describedby":[s,l,t["aria-describedby"]].filter(Boolean).join(" ")||void 0}),{labelProps:a,fieldProps:o,descriptionProps:{id:s},errorMessageProps:{id:l}}}function I2e(t,e,n){const{disallowEmptySelection:r,isDisabled:i}=t,a=tle({usage:"search",sensitivity:"base"}),o=H.useMemo(()=>new A1e(e.collection,e.disabledKeys,null,a),[e.collection,e.disabledKeys,a]),{menuTriggerProps:s,menuProps:l}=Bve({isDisabled:i,type:"listbox"},e,n),c=S=>{if(e.selectionMode==="single")switch(S.key){case"ArrowLeft":{S.preventDefault();const T=e.selectedKeys.size>0?o.getKeyAbove(e.selectedKeys.values().next().value):o.getFirstKey();T&&e.setSelectedKeys([T]);break}case"ArrowRight":{S.preventDefault();const T=e.selectedKeys.size>0?o.getKeyBelow(e.selectedKeys.values().next().value):o.getFirstKey();T&&e.setSelectedKeys([T]);break}}},{typeSelectProps:f}=R1e({keyboardDelegate:o,selectionManager:e.selectionManager,onTypeSelect(S){e.setSelectedKeys([S])}}),{isInvalid:u,validationErrors:d,validationDetails:h}=e.displayValidation,{labelProps:p,fieldProps:g,descriptionProps:m,errorMessageProps:y}=M2e({...t,labelElementType:"span",isInvalid:u,errorMessage:t.errorMessage||d});f.onKeyDown=f.onKeyDownCapture,delete f.onKeyDownCapture,s.onPressStart=S=>{S.pointerType!=="touch"&&S.pointerType!=="keyboard"&&!i&&e.toggle(S.pointerType==="virtual"?"first":null)};const v=pj(t,{labelable:!0}),x=P2(f,s,g),w=R2();return{labelProps:{...p,onClick:()=>{var S;t.isDisabled||((S=n.current)==null||S.focus(),Pj("keyboard"))}},triggerProps:P2(v,{...x,onKeyDown:hj(x.onKeyDown,c,t.onKeyDown),onKeyUp:t.onKeyUp,"aria-labelledby":[w,x["aria-labelledby"],x["aria-label"]&&!x["aria-labelledby"]?x.id:null].join(","),onFocus(S){e.isFocused||(t.onFocus&&t.onFocus(S),e.setFocused(!0))},onBlur(S){e.isOpen||(t.onBlur&&t.onBlur(S),e.setFocused(!1))}}),valueProps:{id:w},menuProps:{...l,disallowEmptySelection:r,autoFocus:e.focusStrategy||!0,shouldSelectOnPressUp:!0,shouldFocusOnHover:!0,onBlur:S=>{S.currentTarget.contains(S.relatedTarget)||(t.onBlur&&t.onBlur(S),e.setFocused(!1))},onFocus:l?.onFocus,"aria-labelledby":[g["aria-labelledby"],x["aria-label"]&&!g["aria-labelledby"]?x.id:null].filter(Boolean).join(" ")},descriptionProps:m,errorMessageProps:y,isInvalid:u,validationErrors:d,validationDetails:h}}var OK=new WeakMap;function R2e(t){var e,n,r,i,a,o;const s=as(),{validationBehavior:l}=OD(Uw)||{},[c,f]=Gl(t,XN.variantKeys),u=(n=(e=t.disableAnimation)!=null?e:s?.disableAnimation)!=null?n:!1,{ref:d,as:h,label:p,name:g,isLoading:m,selectorIcon:y,isOpen:v,defaultOpen:x,onOpenChange:w,startContent:S,endContent:T,description:_,renderValue:D,onSelectionChange:I,placeholder:R,isVirtualized:O,itemHeight:P=36,maxListboxHeight:N=256,children:A,disallowEmptySelection:B=!1,selectionMode:V="single",spinnerRef:$,scrollRef:U,popoverProps:G={},scrollShadowProps:F={},listboxProps:J={},spinnerProps:Q={},validationState:ne,onChange:ye,onClose:ve,className:Ce,classNames:we,validationBehavior:Ae=(r=l??s?.validationBehavior)!=null?r:"native",hideEmptyContent:Me=!1,onClear:q,...k}=c,Y=Ai(U),X={popoverProps:Nn({placement:"bottom",triggerScaleOnOpen:!1,offset:5,disableAnimation:u},G),scrollShadowProps:Nn({ref:Y,isEnabled:(i=t.showScrollIndicators)!=null?i:!0,hideScrollBar:!0,offset:15},F),listboxProps:Nn({disableAnimation:u},J)},re=h||"button",de=typeof re=="string",he=Ai(d),Ee=H.useRef(null),Oe=H.useRef(null),Pe=H.useRef(null);let Ne=D2e({...c,isOpen:v,selectionMode:V,disallowEmptySelection:B,validationBehavior:Ae,children:A,isRequired:t.isRequired,isDisabled:t.isDisabled,isInvalid:t.isInvalid,defaultOpen:x,hideEmptyContent:Me,onOpenChange:Pt=>{w?.(Pt),Pt||ve?.()},onSelectionChange:Pt=>{I?.(Pt),ye&&typeof ye=="function"&&ye({target:{...he.current&&{...he.current,name:he.current.name},value:Array.from(Pt).join(",")}}),Ne.commitValidation()}});Ne={...Ne,...t.isDisabled&&{disabledKeys:new Set([...Ne.collection.getKeys()])}},_D(()=>{var Pt;(Pt=he.current)!=null&&Pt.value&&Ne.setSelectedKeys(new Set([...Ne.selectedKeys,he.current.value]))},[he.current]);const{labelProps:ie,triggerProps:ae,valueProps:Te,menuProps:me,descriptionProps:Se,errorMessageProps:Ve,isInvalid:ue,validationErrors:ut,validationDetails:ht}=I2e({...c,disallowEmptySelection:B,isDisabled:t.isDisabled},Ne,Ee),Ot=H.useCallback(()=>{var Pt;Ne.setSelectedKeys(new Set([])),q?.(),(Pt=Ee.current)==null||Pt.focus()},[q,Ne]),{pressProps:Fe}=g0({isDisabled:!!t?.isDisabled,onPress:Ot}),Qe=t.isInvalid||ne==="invalid"||ue,{isPressed:st,buttonProps:ot}=DD(ae,Ee),{focusProps:Mt,isFocused:Ue,isFocusVisible:He}=Fl(),{focusProps:Ct,isFocusVisible:$t}=Fl(),{isHovered:bn,hoverProps:Tn}=il({isDisabled:t.isDisabled}),en=Ahe({labelPlacement:t.labelPlacement,label:p}),Pn=!!R,mi=en==="outside-left"||en==="outside",hr=en==="inside",Ke=en==="outside-left",Et=t.isClearable,Rt=Ne.isOpen||Pn||!!((a=Ne.selectedItems)!=null&&a.length)||!!S||!!T||!!t.isMultiline,Ft=!!((o=Ne.selectedItems)!=null&&o.length),Dn=!!p,Bt=Dn&&(Ke||mi&&Pn),qt=sn(we?.base,Ce),kt=H.useMemo(()=>XN({...f,isInvalid:Qe,isClearable:Et,labelPlacement:en,disableAnimation:u}),[$l(f),Qe,en,u]);Wj({isDisabled:!Ne.isOpen});const Zt=typeof c.errorMessage=="function"?c.errorMessage({isInvalid:Qe,validationErrors:ut,validationDetails:ht}):c.errorMessage||ut?.join(" "),wr=!!_||!!Zt,$r=!!T;H.useEffect(()=>{if(Ne.isOpen&&Pe.current&&Ee.current){let Pt=Ee.current.getBoundingClientRect(),Bi=Pe.current;Bi.style.width=Pt.width+"px"}},[Ne.isOpen]);const oi=H.useCallback((Pt={})=>({"data-slot":"base","data-filled":Lt(Rt),"data-has-value":Lt(Ft),"data-has-label":Lt(Dn),"data-has-helper":Lt(wr),"data-has-end-content":Lt($r),"data-invalid":Lt(Qe),"data-has-label-outside":Lt(Bt),className:kt.base({class:sn(qt,Pt.className)}),...Pt}),[kt,wr,Ft,Dn,Bt,Rt,qt]),Li=H.useCallback((Pt={})=>({ref:Ee,"data-slot":"trigger","data-open":Lt(Ne.isOpen),"data-disabled":Lt(t?.isDisabled),"data-focus":Lt(Ue),"data-pressed":Lt(st),"data-focus-visible":Lt(He),"data-hover":Lt(bn),className:kt.trigger({class:we?.trigger}),...Nn(ot,Mt,Tn,Lo(k,{enabled:de}),Lo(Pt))}),[kt,Ee,Ne.isOpen,we?.trigger,t?.isDisabled,Ue,st,He,bn,ot,Mt,Tn,k,de]),vi=H.useCallback((Pt={})=>({state:Ne,triggerRef:Ee,selectRef:he,selectionMode:V,label:t?.label,name:t?.name,isRequired:t?.isRequired,autoComplete:t?.autoComplete,isDisabled:t?.isDisabled,form:t?.form,onChange:ye,...Pt}),[Ne,V,t?.label,t?.autoComplete,t?.name,t?.isDisabled,Ee]),ki=H.useCallback((Pt={})=>({"data-slot":"label",className:kt.label({class:sn(we?.label,Pt.className)}),...ie,...Pt}),[kt,we?.label,ie]),nn=H.useCallback((Pt={})=>({"data-slot":"value",className:kt.value({class:sn(we?.value,Pt.className)}),...Te,...Pt}),[kt,we?.value,Te]),Yn=H.useCallback((Pt={})=>({"data-slot":"listboxWrapper",className:kt.listboxWrapper({class:sn(we?.listboxWrapper,Pt?.className)}),style:{maxHeight:N??256,...Pt.style},...Nn(X.scrollShadowProps,Pt)}),[kt.listboxWrapper,we?.listboxWrapper,X.scrollShadowProps,N]),Si=(Pt={})=>{const Bi=O??Ne.collection.size>50;return{state:Ne,ref:Oe,isVirtualized:Bi,virtualization:Bi?{maxListboxHeight:N,itemHeight:P}:void 0,"data-slot":"listbox",className:kt.listbox({class:sn(we?.listbox,Pt?.className)}),scrollShadowProps:X.scrollShadowProps,...Nn(X.listboxProps,Pt,me)}},rn=H.useCallback((Pt={})=>{var Bi,no;const yi=Nn(X.popoverProps,Pt);return{state:Ne,triggerRef:Ee,ref:Pe,"data-slot":"popover",scrollRef:Oe,triggerType:"listbox",classNames:{content:kt.popoverContent({class:sn(we?.popoverContent,Pt.className)})},...yi,offset:Ne.selectedItems&&Ne.selectedItems.length>0?Ne.selectedItems.length*1e-8+(((Bi=X.popoverProps)==null?void 0:Bi.offset)||0):(no=X.popoverProps)==null?void 0:no.offset}},[kt,we?.popoverContent,X.popoverProps,Ee,Ne,Ne.selectedItems]),si=H.useCallback(()=>({"data-slot":"selectorIcon","aria-hidden":Lt(!0),"data-open":Lt(Ne.isOpen),className:kt.selectorIcon({class:we?.selectorIcon})}),[kt,we?.selectorIcon,Ne.isOpen]),os=H.useCallback((Pt={})=>({...Pt,"data-slot":"innerWrapper",className:kt.innerWrapper({class:sn(we?.innerWrapper,Pt?.className)})}),[kt,we?.innerWrapper]),li=H.useCallback((Pt={})=>({...Pt,"data-slot":"helperWrapper",className:kt.helperWrapper({class:sn(we?.helperWrapper,Pt?.className)})}),[kt,we?.helperWrapper]),Vi=H.useCallback((Pt={})=>({...Pt,...Se,"data-slot":"description",className:kt.description({class:sn(we?.description,Pt?.className)})}),[kt,we?.description]),_a=H.useCallback((Pt={})=>({...Pt,"data-slot":"mainWrapper",className:kt.mainWrapper({class:sn(we?.mainWrapper,Pt?.className)})}),[kt,we?.mainWrapper]),Fi=H.useCallback((Pt={})=>({...Pt,"data-slot":"end-wrapper",className:kt.endWrapper({class:sn(we?.endWrapper,Pt?.className)})}),[kt,we?.endWrapper]),As=H.useCallback((Pt={})=>({...Pt,"data-slot":"end-content",className:kt.endContent({class:sn(we?.endContent,Pt?.className)})}),[kt,we?.endContent]),Uo=H.useCallback((Pt={})=>({...Pt,...Ve,"data-slot":"error-message",className:kt.errorMessage({class:sn(we?.errorMessage,Pt?.className)})}),[kt,Ve,we?.errorMessage]),Ui=H.useCallback((Pt={})=>({"aria-hidden":Lt(!0),"data-slot":"spinner",color:"current",size:"sm",...Q,...Pt,ref:$,className:kt.spinner({class:sn(we?.spinner,Pt?.className)})}),[kt,$,Q,we?.spinner]),Bo=H.useCallback((Pt={})=>({...Pt,type:"button",tabIndex:-1,"aria-label":"clear selection","data-slot":"clear-button","data-focus-visible":Lt($t),className:kt.clearButton({class:sn(we?.clearButton,Pt?.className)}),...Nn(Fe,Ct)}),[kt,$t,Fe,Ct,we?.clearButton]);return OK.set(Ne,{isDisabled:t?.isDisabled,isRequired:t?.isRequired,name:t?.name,isInvalid:Qe,validationBehavior:Ae}),{Component:re,domRef:he,state:Ne,label:p,name:g,triggerRef:Ee,isLoading:m,placeholder:R,startContent:S,endContent:T,description:_,selectorIcon:y,hasHelper:wr,labelPlacement:en,hasPlaceholder:Pn,renderValue:D,selectionMode:V,disableAnimation:u,isOutsideLeft:Ke,shouldLabelBeOutside:mi,shouldLabelBeInside:hr,isInvalid:Qe,errorMessage:Zt,isClearable:Et,getClearButtonProps:Bo,getBaseProps:oi,getTriggerProps:Li,getLabelProps:ki,getValueProps:nn,getListboxProps:Si,getPopoverProps:rn,getSpinnerProps:Ui,getMainWrapperProps:_a,getListboxWrapperProps:Yn,getHiddenSelectProps:vi,getInnerWrapperProps:os,getHelperWrapperProps:li,getDescriptionProps:Vi,getErrorMessageProps:Uo,getSelectorIconProps:si,getEndWrapperProps:Fi,getEndContentProps:As}}var P2e=typeof document<"u"?un.useLayoutEffect:()=>{};function A2e(t){const e=H.useRef(null);return P2e(()=>{e.current=t},[t]),H.useCallback((...n)=>{const r=e.current;return r?.(...n)},[])}function N2e(t,e,n){let r=H.useRef(e),i=A2e(()=>{n&&n(r.current)});H.useEffect(()=>{var a;let o=(a=t?.current)==null?void 0:a.form;return o?.addEventListener("reset",i),()=>{o?.removeEventListener("reset",i)}},[t,i])}function L2e(t,e,n){let{validationBehavior:r,focus:i}=t;Nr(()=>{if(r==="native"&&n?.current&&!n.current.disabled){let c=e.realtimeValidation.isInvalid?e.realtimeValidation.validationErrors.join(" ")||"Invalid value.":"";n.current.setCustomValidity(c),n.current.hasAttribute("title")||(n.current.title=""),e.realtimeValidation.isInvalid||e.updateValidation(V2e(n.current))}});let a=H.useRef(!1),o=Sr(()=>{a.current||e.resetValidation()}),s=Sr(c=>{var f;e.displayValidation.isInvalid||e.commitValidation();let u=n==null||(f=n.current)===null||f===void 0?void 0:f.form;if(!c.defaultPrevented&&n&&u&&F2e(u)===n.current){var d;i?i():(d=n.current)===null||d===void 0||d.focus(),Pj("keyboard")}c.preventDefault()}),l=Sr(()=>{e.commitValidation()});H.useEffect(()=>{let c=n?.current;if(!c)return;let f=c.form,u=f?.reset;return f&&(f.reset=()=>{a.current=!window.event||window.event.type==="message"&&window.event.target instanceof MessagePort,u?.call(f),a.current=!1}),c.addEventListener("invalid",s),c.addEventListener("change",l),f?.addEventListener("reset",o),()=>{c.removeEventListener("invalid",s),c.removeEventListener("change",l),f?.removeEventListener("reset",o),f&&(f.reset=u)}},[n,s,l,o,r])}function k2e(t){let e=t.validity;return{badInput:e.badInput,customError:e.customError,patternMismatch:e.patternMismatch,rangeOverflow:e.rangeOverflow,rangeUnderflow:e.rangeUnderflow,stepMismatch:e.stepMismatch,tooLong:e.tooLong,tooShort:e.tooShort,typeMismatch:e.typeMismatch,valueMissing:e.valueMissing,valid:e.valid}}function V2e(t){return{isInvalid:!t.validity.valid,validationDetails:k2e(t),validationErrors:t.validationMessage?[t.validationMessage]:[]}}function F2e(t){for(let e=0;e<t.elements.length;e++){let n=t.elements[e];if(!n.validity.valid)return n}return null}function U2e(t,e,n){var r;let i=OK.get(e)||{},{autoComplete:a,name:o=i.name,isDisabled:s=i.isDisabled,selectionMode:l,onChange:c,form:f}=t,{validationBehavior:u,isRequired:d,isInvalid:h}=i,{visuallyHiddenProps:p}=Dz();return N2e(t.selectRef,e.selectedKeys,e.setSelectedKeys),L2e({validationBehavior:u,focus:()=>{var g;return(g=n.current)==null?void 0:g.focus()}},e,t.selectRef),{containerProps:{...p,"aria-hidden":!0,"data-a11y-ignore":"aria-hidden-focus"},inputProps:{style:{display:"none"}},selectProps:{form:f,autoComplete:a,disabled:s,"aria-invalid":h||void 0,"aria-required":d&&u==="aria"||void 0,required:d&&u==="native",name:o,tabIndex:-1,value:l==="multiple"?[...e.selectedKeys].map(g=>String(g)):(r=[...e.selectedKeys][0])!=null?r:"",multiple:l==="multiple",onChange:g=>{e.setSelectedKeys(g.target.value),c?.(g)}}}}function B2e(t){var e;let{state:n,triggerRef:r,selectRef:i,label:a,name:o,isDisabled:s,form:l}=t,{containerProps:c,selectProps:f}=U2e({...t,selectRef:i},n,r);return n.collection.size<=300?j.jsx("div",{...c,"data-testid":"hidden-select-container",children:j.jsxs("label",{children:[a,j.jsxs("select",{...f,ref:i,children:[j.jsx("option",{}),[...n.collection.getKeys()].map(u=>{let d=n.collection.getItem(u);if(d?.type==="item")return j.jsx("option",{value:d.key,children:d.textValue},d.key)})]})]})}):o?j.jsx("input",{autoComplete:f.autoComplete,disabled:s,form:l,name:o,type:"hidden",value:(e=[...n.selectedKeys].join(","))!=null?e:""}):null}var $2e=fH,MK=$2e;const ID=new WeakMap;function G2e(t){return typeof t=="string"?t.replace(/\s*/g,""):""+t}function j2e(t,e){let n=ID.get(t);if(!n)throw new Error("Unknown list");return`${n.id}-option-${G2e(e)}`}function z2e(t,e,n){let r=_m(t,{labelable:!0}),i=t.selectionBehavior||"toggle",a=t.linkBehavior||(i==="replace"?"action":"override");i==="toggle"&&a==="action"&&(a="override");let{listProps:o}=Kve({...t,ref:n,selectionManager:e.selectionManager,collection:e.collection,disabledKeys:e.disabledKeys,linkBehavior:a}),{focusWithinProps:s}=Am({onFocusWithin:t.onFocus,onBlurWithin:t.onBlur,onFocusWithinChange:t.onFocusChange}),l=rl(t.id);ID.set(e,{id:l,shouldUseVirtualFocus:t.shouldUseVirtualFocus,shouldSelectOnPressUp:t.shouldSelectOnPressUp,shouldFocusOnHover:t.shouldFocusOnHover,isVirtualized:t.isVirtualized,onAction:t.onAction,linkBehavior:a});let{labelProps:c,fieldProps:f}=SH({...t,id:l,labelElementType:"span"});return{labelProps:c,listBoxProps:Ji(r,s,e.selectionManager.selectionMode==="multiple"?{"aria-multiselectable":"true"}:{},{role:"listbox",...Ji(f,o)})}}function W2e(t,e,n){var r,i;let{key:a}=t,o=ID.get(e);var s;let l=(s=t.isDisabled)!==null&&s!==void 0?s:e.selectionManager.isDisabled(a);var c;let f=(c=t.isSelected)!==null&&c!==void 0?c:e.selectionManager.isSelected(a);var u;let d=(u=t.shouldSelectOnPressUp)!==null&&u!==void 0?u:o?.shouldSelectOnPressUp;var h;let p=(h=t.shouldFocusOnHover)!==null&&h!==void 0?h:o?.shouldFocusOnHover;var g;let m=(g=t.shouldUseVirtualFocus)!==null&&g!==void 0?g:o?.shouldUseVirtualFocus;var y;let v=(y=t.isVirtualized)!==null&&y!==void 0?y:o?.isVirtualized,x=sm(),w=sm(),S={role:"option","aria-disabled":l||void 0,"aria-selected":e.selectionManager.selectionMode!=="none"?f:void 0};gu()&&M9()||(S["aria-label"]=t["aria-label"],S["aria-labelledby"]=x,S["aria-describedby"]=w);let T=e.collection.getItem(a);if(v){let $=Number(T?.index);S["aria-posinset"]=Number.isNaN($)?void 0:$+1,S["aria-setsize"]=U1e(e.collection)}let _=o?.onAction?()=>{var $;return o==null||($=o.onAction)===null||$===void 0?void 0:$.call(o,a)}:void 0,D=j2e(e,a),{itemProps:I,isPressed:R,isFocused:O,hasAction:P,allowsSelection:N}=wK({selectionManager:e.selectionManager,key:a,ref:n,shouldSelectOnPressUp:d,allowsDifferentPressOrigin:d&&p,isVirtualized:v,shouldUseVirtualFocus:m,isDisabled:l,onAction:_||!(T==null||(r=T.props)===null||r===void 0)&&r.onAction?Zd(T==null||(i=T.props)===null||i===void 0?void 0:i.onAction,_):void 0,linkBehavior:o?.linkBehavior,id:D}),{hoverProps:A}=il({isDisabled:l||!p,onHoverStart(){N2()||(e.selectionManager.setFocused(!0),e.selectionManager.setFocusedKey(a))}}),B=_m(T?.props);delete B.id;let V=O$(T?.props);return{optionProps:{...S,...Ji(B,I,A,V),id:D},labelProps:{id:x},descriptionProps:{id:w},isFocused:O,isFocusVisible:O&&e.selectionManager.isFocused&&N2(),isSelected:f,isDisabled:l,isPressed:R,allowsSelection:N,hasAction:P}}function H2e(t){let{heading:e,"aria-label":n}=t,r=rl();return{itemProps:{role:"presentation"},headingProps:e?{id:r,role:"presentation"}:{},groupProps:{role:"group","aria-label":n,"aria-labelledby":e?r:void 0}}}function K2e(t){var e;const n=as(),{ref:r,as:i,state:a,variant:o,color:s,onAction:l,children:c,onSelectionChange:f,disableAnimation:u=(e=n?.disableAnimation)!=null?e:!1,itemClasses:d,className:h,topContent:p,bottomContent:g,emptyContent:m="No items.",hideSelectedIcon:y=!1,hideEmptyContent:v=!1,shouldHighlightOnFocus:x=!1,classNames:w,...S}=t,T=i||"ul",_=typeof T=="string",D=Ai(r),I=DK({...t,children:c,onSelectionChange:f}),R=a||I,{listBoxProps:O}=z2e({...t,onAction:l},R,D),P=H.useMemo(()=>Fpe(),[]),N=sn(w?.base,h);return{Component:T,state:R,variant:o,color:s,slots:P,classNames:w,topContent:p,bottomContent:g,emptyContent:m,hideEmptyContent:v,shouldHighlightOnFocus:x,hideSelectedIcon:y,disableAnimation:u,className:h,itemClasses:d,getBaseProps:($={})=>({ref:D,"data-slot":"base",className:P.base({class:N}),...Lo(S,{enabled:_}),...$}),getListProps:($={})=>({"data-slot":"list",className:P.list({class:w?.list}),...O,...$}),getEmptyContentProps:($={})=>({"data-slot":"empty-content",children:m,className:P.emptyContent({class:w?.emptyContent}),...$})}}function q2e(t){const{isSelected:e,disableAnimation:n,...r}=t;return j.jsx("svg",{"aria-hidden":"true","data-selected":e,role:"presentation",viewBox:"0 0 17 18",...r,children:j.jsx("polyline",{fill:"none",points:"1 9 7 14 15 4",stroke:"currentColor",strokeDasharray:22,strokeDashoffset:e?44:66,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,style:n?{}:{transition:"stroke-dashoffset 200ms ease"}})})}function X2e(t){var e,n;const r=as(),[i,a]=Gl(t,JN.variantKeys),{as:o,item:s,state:l,description:c,startContent:f,endContent:u,isVirtualized:d,selectedIcon:h,className:p,classNames:g,autoFocus:m,onPress:y,onPressUp:v,onPressStart:x,onPressEnd:w,onPressChange:S,onClick:T,shouldHighlightOnFocus:_,hideSelectedIcon:D=!1,isReadOnly:I=!1,...R}=i,O=(n=(e=t.disableAnimation)!=null?e:r?.disableAnimation)!=null?n:!1,P=H.useRef(null),N=o||(t.href?"a":"li"),A=typeof N=="string",{rendered:B,key:V}=s,$=l.disabledKeys.has(V)||t.isDisabled,U=l.selectionManager.selectionMode!=="none",G=OW(),{pressProps:F,isPressed:J}=g0({ref:P,isDisabled:$,onClick:T,onPress:y,onPressUp:v,onPressStart:x,onPressEnd:w,onPressChange:S}),{isHovered:Q,hoverProps:ne}=il({isDisabled:$}),{isFocusVisible:ye,focusProps:ve}=Fl({autoFocus:m}),{isFocused:Ce,isSelected:we,optionProps:Ae,labelProps:Me,descriptionProps:q}=W2e({key:V,isDisabled:$,"aria-label":i["aria-label"],isVirtualized:d},l,P);let k=Ae;const Y=H.useMemo(()=>JN({...a,isDisabled:$,disableAnimation:O,hasTitleTextChild:typeof B=="string",hasDescriptionTextChild:typeof c=="string"}),[$l(a),$,O,B,c]),X=sn(g?.base,p);I&&(k=Yoe(k));const re=_&&Ce||(G?Q||J:Q||Ce&&!ye),de=(Ne={})=>({ref:P,...Nn(k,I?{}:Nn(ve,F),ne,Lo(R,{enabled:A}),Ne),"data-selectable":Lt(U),"data-focus":Lt(Ce),"data-hover":Lt(re),"data-disabled":Lt($),"data-selected":Lt(we),"data-pressed":Lt(J),"data-focus-visible":Lt(ye),className:Y.base({class:sn(X,Ne.className)})}),he=(Ne={})=>({...Nn(Me,Ne),"data-label":Lt(!0),className:Y.title({class:g?.title})}),Ee=(Ne={})=>({...Nn(q,Ne),className:Y.description({class:g?.description})}),Oe=(Ne={})=>({...Nn(Ne),className:Y.wrapper({class:g?.wrapper})}),Pe=H.useCallback((Ne={})=>({"aria-hidden":Lt(!0),"data-disabled":Lt($),className:Y.selectedIcon({class:g?.selectedIcon}),...Ne}),[$,Y,g]);return{Component:N,domRef:P,slots:Y,classNames:g,isSelectable:U,isSelected:we,isDisabled:$,rendered:B,description:c,startContent:f,endContent:u,selectedIcon:h,hideSelectedIcon:D,disableAnimation:O,getItemProps:de,getLabelProps:he,getWrapperProps:Oe,getDescriptionProps:Ee,getSelectedIconProps:Pe}}var IK=t=>{const{Component:e,rendered:n,description:r,isSelectable:i,isSelected:a,isDisabled:o,selectedIcon:s,startContent:l,endContent:c,hideSelectedIcon:f,disableAnimation:u,getItemProps:d,getLabelProps:h,getWrapperProps:p,getDescriptionProps:g,getSelectedIconProps:m}=X2e(t),y=H.useMemo(()=>{const v=j.jsx(q2e,{disableAnimation:u,isSelected:a});return typeof s=="function"?s({icon:v,isSelected:a,isDisabled:o}):s||v},[s,a,o,u]);return j.jsxs(e,{...d(),children:[l,r?j.jsxs("div",{...p(),children:[j.jsx("span",{...h(),children:n}),j.jsx("span",{...g(),children:r})]}):j.jsx("span",{...h(),children:n}),i&&!f&&j.jsx("span",{...m(),children:y}),c]})};IK.displayName="HeroUI.ListboxItem";var RD=IK,RK=Qi(({item:t,state:e,as:n,variant:r,color:i,disableAnimation:a,className:o,classNames:s,hideSelectedIcon:l,showDivider:c=!1,dividerProps:f={},itemClasses:u,title:d,items:h,...p},g)=>{const m=n||"li",y=H.useMemo(()=>Upe(),[]),v=sn(s?.base,o),x=sn(s?.divider,f?.className),{itemProps:w,headingProps:S,groupProps:T}=H2e({heading:t.rendered,"aria-label":t["aria-label"]});return j.jsxs(m,{"data-slot":"base",...Nn(w,p),className:y.base({class:v}),children:[t.rendered&&j.jsx("span",{...S,className:y.heading({class:s?.heading}),"data-slot":"heading",children:t.rendered}),j.jsxs("ul",{...T,className:y.group({class:s?.group}),"data-has-title":!!t.rendered,"data-slot":"group",children:[[...t.childNodes].map(_=>{const{key:D,props:I}=_;let R=j.jsx(RD,{classNames:u,color:i,disableAnimation:a,hideSelectedIcon:l,item:_,state:e,variant:r,...I},D);return _.wrapper&&(R=_.wrapper(R)),R}),c&&j.jsx(G1e,{as:"li",className:y.divider({class:x}),...f})]})]},t.key)});RK.displayName="HeroUI.ListboxSection";var PK=RK;function Y2e(t={}){const{domRef:e,isEnabled:n=!0,overflowCheck:r="vertical",visibility:i="auto",offset:a=0,onVisibilityChange:o,updateDeps:s=[]}=t,l=H.useRef(i);H.useEffect(()=>{const c=e?.current;if(!c||!n)return;const f=(h,p,g,m,y)=>{if(i==="auto"){const v=`${m}${f$(y)}Scroll`;p&&g?(c.dataset[v]="true",c.removeAttribute(`data-${m}-scroll`),c.removeAttribute(`data-${y}-scroll`)):(c.dataset[`${m}Scroll`]=p.toString(),c.dataset[`${y}Scroll`]=g.toString(),c.removeAttribute(`data-${m}-${y}-scroll`))}else{const v=p&&g?"both":p?m:g?y:"none";v!==l.current&&(o?.(v),l.current=v)}},u=()=>{var h,p;const g=[{type:"vertical",prefix:"top",suffix:"bottom"},{type:"horizontal",prefix:"left",suffix:"right"}],m=c.querySelector('ul[data-slot="list"]'),y=+((h=m?.getAttribute("data-virtual-scroll-height"))!=null?h:c.scrollHeight),v=+((p=m?.getAttribute("data-virtual-scroll-top"))!=null?p:c.scrollTop);for(const{type:x,prefix:w,suffix:S}of g)if(r===x||r==="both"){const T=x==="vertical"?v>a:c.scrollLeft>a,_=x==="vertical"?v+c.clientHeight+a<y:c.scrollLeft+c.clientWidth+a<c.scrollWidth;f(x,T,_,w,S)}},d=()=>{["top","bottom","top-bottom","left","right","left-right"].forEach(h=>{c.removeAttribute(`data-${h}-scroll`)})};return u(),c.addEventListener("scroll",u,!0),i!=="auto"&&(d(),i==="both"?(c.dataset.topBottomScroll=String(r==="vertical"),c.dataset.leftRightScroll=String(r==="horizontal")):(c.dataset.topBottomScroll="false",c.dataset.leftRightScroll="false",["top","bottom","left","right"].forEach(h=>{c.dataset[`${h}Scroll`]=String(i===h)}))),()=>{c.removeEventListener("scroll",u,!0),d()}},[...s,n,i,r,o,e])}function J2e(t){var e;const[n,r]=Gl(t,kw.variantKeys),{ref:i,as:a,children:o,className:s,style:l,size:c=40,offset:f=0,visibility:u="auto",isEnabled:d=!0,onVisibilityChange:h,...p}=n,g=a||"div",m=Ai(i);Y2e({domRef:m,offset:f,visibility:u,isEnabled:d,onVisibilityChange:h,updateDeps:[o],overflowCheck:(e=t.orientation)!=null?e:"vertical"});const y=H.useMemo(()=>kw({...r,className:s}),[$l(r),s]);return{Component:g,styles:y,domRef:m,children:o,getBaseProps:(x={})=>{var w;return{ref:m,className:y,"data-orientation":(w=t.orientation)!=null?w:"vertical",style:{"--scroll-shadow-size":`${c}px`,...l,...x.style},...p,...x}}}}var Z2e=(t,e)=>{const n=[];for(const r of t)r.type==="section"?n.push(([...r.childNodes].length+1)*e):n.push(e);return n},Q2e=t=>{if(!t||t.scrollTop===void 0||t.clientHeight===void 0||t.scrollHeight===void 0)return{isTop:!1,isBottom:!1,isMiddle:!1};const e=t.scrollTop===0,n=Math.ceil(t.scrollTop+t.clientHeight)>=t.scrollHeight;return{isTop:e,isBottom:n,isMiddle:!e&&!n}},eye=t=>{var e;const{Component:n,state:r,color:i,variant:a,itemClasses:o,getBaseProps:s,topContent:l,bottomContent:c,hideEmptyContent:f,hideSelectedIcon:u,shouldHighlightOnFocus:d,disableAnimation:h,getEmptyContentProps:p,getListProps:g,scrollShadowProps:m}=t,{virtualization:y}=t;if(!y||!Cw(y)&&!y.maxListboxHeight&&!y.itemHeight)throw new Error("You are using a virtualized listbox. VirtualizedListbox requires 'virtualization' props with 'maxListboxHeight' and 'itemHeight' properties. This error might have originated from autocomplete components that use VirtualizedListbox. Please provide these props to use the virtualized listbox.");const{maxListboxHeight:v,itemHeight:x}=y,w=Math.min(v,x*r.collection.size),S=H.useRef(null),T=H.useMemo(()=>Z2e([...r.collection],x),[r.collection,x]),_=s2e({count:[...r.collection].length,getScrollElement:()=>S.current,estimateSize:B=>T[B]}),D=_.getVirtualItems(),I=_.getTotalSize(),{getBaseProps:R}=J2e({...m}),O=B=>{var V;const $=[...r.collection][B.index];if(!$)return null;const U={color:i,item:$,state:r,variant:a,disableAnimation:h,hideSelectedIcon:u,...$.props},G={position:"absolute",top:0,left:0,width:"100%",height:`${B.size}px`,transform:`translateY(${B.start}px)`};if($.type==="section")return j.jsx(PK,{...U,itemClasses:o,style:{...G,...U.style}},$.key);let F=j.jsx(RD,{...U,classNames:Nn(o,(V=$.props)==null?void 0:V.classNames),shouldHighlightOnFocus:d,style:{...G,...U.style}},$.key);return $.wrapper&&(F=$.wrapper(F)),F},[P,N]=H.useState({isTop:!1,isBottom:!0,isMiddle:!1}),A=j.jsxs(n,{...g(),"data-virtual-scroll-height":I,"data-virtual-scroll-top":(e=S?.current)==null?void 0:e.scrollTop,children:[!r.collection.size&&!f&&j.jsx("li",{children:j.jsx("div",{...p()})}),j.jsx("div",{...Lo(R()),ref:S,style:{height:v,overflow:"auto"},onScroll:B=>{N(Q2e(B.target))},children:w>0&&x>0&&j.jsx("div",{style:{height:`${I}px`,width:"100%",position:"relative"},children:D.map(B=>O(B))})})]});return j.jsxs("div",{...s(),children:[l,A,c]})},tye=eye,nye=Qi(function(e,n){const{isVirtualized:r,...i}=e,a=K2e({...i,ref:n}),{Component:o,state:s,color:l,variant:c,itemClasses:f,getBaseProps:u,topContent:d,bottomContent:h,hideEmptyContent:p,hideSelectedIcon:g,shouldHighlightOnFocus:m,disableAnimation:y,getEmptyContentProps:v,getListProps:x}=a;if(r)return j.jsx(tye,{...e,...a});const w=j.jsxs(o,{...x(),children:[!s.collection.size&&!p&&j.jsx("li",{children:j.jsx("div",{...v()})}),[...s.collection].map(S=>{var T;const _={color:l,item:S,state:s,variant:c,disableAnimation:y,hideSelectedIcon:g,...S.props};if(S.type==="section")return j.jsx(PK,{..._,itemClasses:f},S.key);let D=j.jsx(RD,{..._,classNames:Nn(f,(T=S.props)==null?void 0:T.classNames),shouldHighlightOnFocus:m},S.key);return S.wrapper&&(D=S.wrapper(D)),D})]});return j.jsxs("div",{...u(),children:[d,w,h]})}),rye=nye,iye=Qi(function(e,n){var r;const{Component:i,state:a,label:o,hasHelper:s,isLoading:l,triggerRef:c,selectorIcon:f=j.jsx(age,{}),description:u,errorMessage:d,isInvalid:h,startContent:p,endContent:g,placeholder:m,renderValue:y,shouldLabelBeOutside:v,disableAnimation:x,getBaseProps:w,getLabelProps:S,getTriggerProps:T,getValueProps:_,getListboxProps:D,getPopoverProps:I,getSpinnerProps:R,getMainWrapperProps:O,getInnerWrapperProps:P,getHiddenSelectProps:N,getHelperWrapperProps:A,getListboxWrapperProps:B,getDescriptionProps:V,getErrorMessageProps:$,getSelectorIconProps:U,isClearable:G,getClearButtonProps:F,getEndWrapperProps:J,getEndContentProps:Q}=R2e({...e,ref:n}),ne=o?j.jsx("label",{...S(),children:o}):null,ye=H.cloneElement(f,U()),ve=H.useMemo(()=>{var k;return G&&((k=a.selectedItems)!=null&&k.length)?j.jsx("span",{...F(),children:j.jsx(CD,{})}):null},[G,F,(r=a.selectedItems)==null?void 0:r.length]),Ce=H.useMemo(()=>ve?j.jsxs("div",{...J(),children:[ve,g&&j.jsx("span",{...Q(),children:g})]}):g&&j.jsx("span",{...Q(),children:g}),[ve,g,J,Q]),we=H.useMemo(()=>{const k=h&&d;return!s||!(k||u)?null:j.jsx("div",{...A(),children:k?j.jsx("div",{...$(),children:d}):j.jsx("div",{...V(),children:u})})},[s,h,d,u,A,$,V]),Ae=H.useMemo(()=>{var k;if(!((k=a.selectedItems)!=null&&k.length))return m;if(y&&typeof y=="function"){const Y=[...a.selectedItems].map(X=>({key:X.key,data:X.value,type:X.type,props:X.props,textValue:X.textValue,rendered:X.rendered,"aria-label":X["aria-label"]}));return y(Y)}return a.selectedItems.map(Y=>Y.textValue).join(", ")},[a.selectedItems,y,m]),Me=H.useMemo(()=>l?j.jsx(bC,{...R()}):ye,[l,ye,R]),q=H.useMemo(()=>a.isOpen?j.jsx(Pve,{...I(),children:j.jsx(T2e,{...B(),children:j.jsx(rye,{...D()})})}):null,[a.isOpen,I,a,c,B,D]);return j.jsxs("div",{...w(),children:[j.jsx(B2e,{...N()}),v?ne:null,j.jsxs("div",{...O(),children:[j.jsxs(i,{...T(),children:[v?null:ne,j.jsxs("div",{...P(),children:[p,j.jsx("span",{..._(),children:Ae}),g&&a.selectedItems&&j.jsx(Oz,{elementType:"span",children:","}),Ce]}),Me]}),we]}),x?q:j.jsx(fC,{children:q})]})}),AK=iye;const qh=()=>{const{userInfo:t,isAuthenticated:e}=jf(),n=t?.role===1,r=t?.role===2,i=t?.role===3,a=n,o=n||r,s=e(),l=o,c=o,f=i,u=i;return{userInfo:t,role:t?.role,isAuthenticated:e(),isAdmin:n,isTeacher:r,isStudent:i,hasAdminPermission:a,hasTeacherPermission:o,hasStudentPermission:s,canUpload:l,canViewAllStudentData:c,canCopyData:f,canEditOwnData:u}},aye=async(t=1,e=10,n,r,i)=>{const a={page:t,per_page:e};return r&&(a.category=r),$a.get("/admin/original-data",a)},oye=async t=>$a.get(`/admin/original-data/detail?original_id=${t}`),sye=async(t,e)=>$a.post("/admin/original-data/update",{original_id:t,...e}),lye=async t=>$a.post("/student/copy",t),cye=async t=>$a.post("/student/del",{user_copy_id:t}),uye=async(t,e)=>$a.post("/student/update-copy-name",{user_copy_id:t,copy_name:e}),fye=async(t,e)=>$a.post("/admin/original-data/updateOriginalAnnotation",{original_id:t,annotation:e}),dye=async(t,e)=>$a.post("/student/updateAnnotation",{user_copy_id:t,annotation:e});class qL extends Error{constructor(e,n,r){super(e),this.name="AppError",this.status=n,this.code=r}}const Od={handleApiError:(t,e="操作失败，请重试")=>{console.error("API Error:",t);let n=e;return t instanceof qL?n=t.message:t?.response?.data?.message?n=t.response.data.message:t?.message&&(n=t.message),Nt({color:"danger",description:n}),n},handleNetworkError:t=>{console.error("Network Error:",t);const e="网络连接失败，请检查网络设置";return Nt({color:"danger",description:e}),e},handleValidationError:t=>{const n=Object.values(t).flat().join(", ");return Nt({color:"warning",description:n}),n},createApiError:(t,e,n)=>new qL(t,e,n),isNetworkError:t=>!t.response||t.code==="NETWORK_ERROR",isAuthError:t=>t.response?.status===401||t.response?.status===403},hye=({dcm:t,showOwnerInfo:e=!1})=>{const n=o=>"name"in o?o.name:o.copy_name||o.original_data.name,r=o=>"category"in o?o.category:o.original_data.category,i=o=>"remark"in o?o.remark:o.original_data.remark,a=o=>o&&{1:"X光影像",2:"CT",3:"MRI",4:"超声",5:"PET",6:"病理图像"}[o]||"未分类";return j.jsxs("div",{className:"flex-1 min-h-[120px] flex flex-col",onClick:()=>{},children:[j.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2 line-clamp-2",children:n(t)}),j.jsxs("div",{className:"space-y-2 text-sm text-gray-600 flex-1",children:[j.jsxs("p",{className:"text-xs",children:["创建时间: ",new Date(t.created_at).toLocaleDateString("zh-CN")," | 更新时间: ",new Date(t.updated_at).toLocaleDateString("zh-CN")]}),e&&t.original_id&&j.jsxs("p",{className:"text-blue-600 text-xs",children:["数据ID: ",t.original_id]}),r(t)&&j.jsxs("div",{className:"flex items-center space-x-2",children:[j.jsx("span",{className:"text-gray-500 text-xs",children:"分类:"}),j.jsx(F2,{size:"sm",color:"primary",variant:"flat",className:"text-xs h-[20px]",children:a(r(t))})]}),i(t)&&i(t).trim()&&j.jsxs("div",{className:"flex items-center w-full space-x-2 h-[20px] overflow-hidden",children:[j.jsx("span",{className:"text-gray-500 text-xs flex-shrink-0",children:"标签:"}),j.jsx("div",{className:"flex flex-wrap gap-1 h-[20px]",children:i(t).split(",").filter(o=>o.trim()).map((o,s)=>j.jsx(F2,{size:"sm",color:"secondary",variant:"flat",className:"text-xs h-full max-w-[120px] truncate",children:o.trim()},s))})]})]})]})},pye=({dcm:t,loading:e,isPublicData:n=!1,isStudentData:r=!1,showCopyButton:i=!0,showEditButton:a=!1,onCopy:o,onDelete:s,onEditName:l})=>{const c=Ec(),{isAdmin:f,isTeacher:u,isStudent:d}=qh(),h=p=>{p.stopPropagation(),n?c(`/edit/${t.original_id}`):"user_copy_id"in t&&l()};return j.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[n&&j.jsxs(j.Fragment,{children:[d&&i&&j.jsx(qr,{size:"sm",color:"primary",variant:"flat",isLoading:e.copy,onClick:p=>{p.stopPropagation(),o()},children:"拷贝"}),a&&(u||f)&&j.jsx(qr,{size:"sm",color:"secondary",variant:"flat",onClick:h,children:"编辑"})]}),r&&d&&j.jsxs(j.Fragment,{children:[j.jsx(qr,{size:"sm",color:"secondary",variant:"flat",onClick:h,children:"修改名称"}),j.jsx(qr,{size:"sm",color:"danger",variant:"flat",isLoading:e.delete,onClick:p=>{p.stopPropagation(),s()},children:"删除"})]})]})},gye=({isOpen:t,currentName:e,onClose:n,onSave:r,title:i="修改名称",placeholder:a="请输入新的名称"})=>{const[o,s]=H.useState(e),[l,c]=H.useState(!1),f=async()=>{if(o.trim()){c(!0);try{await r(o.trim()),n()}finally{c(!1)}}},u=()=>{s(e),n()};return t?j.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50",children:j.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[j.jsxs("div",{className:"flex justify-between items-center mb-4",children:[j.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:i}),j.jsx("button",{onClick:u,className:"text-gray-400 hover:text-gray-600",children:j.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:j.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),j.jsx("div",{className:"space-y-4",children:j.jsxs("div",{children:[j.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"新的名称"}),j.jsx("input",{type:"text",value:o,onChange:d=>s(d.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:a})]})}),j.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[j.jsx("button",{onClick:u,className:"px-4 py-2 text-gray-600 hover:text-gray-800 transition-colors",disabled:l,children:"取消"}),j.jsx("button",{onClick:f,disabled:l||!o.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:l?"保存中...":"确认保存"})]})]})}):null},mye=({isOpen:t,title:e,message:n,confirmText:r="确认",cancelText:i="取消",confirmColor:a="primary",onConfirm:o,onCancel:s,isLoading:l=!1})=>t?j.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:j.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[j.jsxs("div",{className:"mb-4",children:[j.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:e}),j.jsx("p",{className:"text-gray-600 mt-2",children:n})]}),j.jsxs("div",{className:"flex justify-end space-x-3",children:[j.jsx(qr,{color:"default",variant:"flat",onClick:s,disabled:l,children:i}),j.jsx(qr,{color:a,onClick:o,isLoading:l,children:r})]})]})}):null;function vye({currentImageIndex:t,totalImages:e,frameRate:n=0,zoom:r=1,renderTime:i=0,isVisible:a=!0}){return a?j.jsx("div",{className:"fixed bottom-4 right-4 z-50 bg-black bg-opacity-80 text-white p-3 rounded-lg shadow-lg border border-gray-600 min-w-[200px]",children:j.jsxs("div",{className:"space-y-2 text-sm",children:[j.jsxs("div",{className:"flex justify-between items-center",children:[j.jsx("span",{className:"text-gray-300",children:"Img:"}),j.jsxs("em",{className:"text-white font-mono",children:[t||1,"/",e]})]}),j.jsxs("div",{className:"flex justify-between items-center",children:[j.jsx("span",{className:"text-gray-300",children:"FPS:"}),j.jsx("em",{className:"text-white font-mono",children:n?n.toFixed(1):"0.0"})]}),j.jsxs("div",{className:"flex justify-between items-center",children:[j.jsx("span",{className:"text-gray-300",children:"Zoom:"}),j.jsx("em",{className:"text-white font-mono",children:r?r.toFixed(2):"1.00"})]}),j.jsxs("div",{className:"flex justify-between items-center",children:[j.jsx("span",{className:"text-gray-300",children:"Render:"}),j.jsxs("em",{className:"text-white font-mono",children:[i?i.toFixed(1):"0.0","ms"]})]})]})}):null}function PD({dcm:t,onFileClick:e,onDataChange:n,onCopySuccess:r,showOwnerInfo:i=!1,isPublicData:a=!1,isStudentData:o=!1,showCopyButton:s=!0,showEditButton:l=!1}){const{userInfo:c}=qh(),[f,u]=H.useState({copy:!1,delete:!1}),[d,h]=H.useState(!1),[p,g]=H.useState(!1),m=w=>"name"in w?w.name:w.copy_name||w.original_data.name,y=async()=>{if(!c?.user_id){Nt({color:"danger",description:"用户信息错误，请重新登录"});return}u(w=>({...w,copy:!0}));try{const w=await lye({original_id:t.original_id,copy_name:`${m(t)} - 复制`});w.success?(Nt({color:"success",description:"复制成功！数据已添加到您的账户"}),n?.(),r?.()):Od.handleApiError(new Error(w.message),"复制失败")}catch(w){Od.handleApiError(w,"复制失败")}finally{u(w=>({...w,copy:!1}))}},v=async w=>{if(!("user_copy_id"in t)){Nt({color:"danger",description:"只能修改复制的数据名称"});return}try{const S=await uye(t.user_copy_id,w);S.success?(Nt({color:"success",description:"复制名称修改成功"}),n?.()):Od.handleApiError(new Error(S.message),"修改失败")}catch(S){Od.handleApiError(S,"修改失败")}},x=async()=>{if(!c?.user_id){Nt({color:"danger",description:"用户信息错误，请重新登录"});return}if(!("user_copy_id"in t)){Nt({color:"danger",description:"只能删除复制的数据"});return}u(w=>({...w,delete:!0}));try{const w=await cye(t.user_copy_id);w.success?(Nt({color:"success",description:"删除成功"}),n?.()):Od.handleApiError(new Error(w.message),"删除失败")}catch(w){Od.handleApiError(w,"删除失败")}finally{u(w=>({...w,delete:!1})),g(!1)}};return j.jsxs(j.Fragment,{children:[j.jsx(tu,{className:"hover:shadow-md transition-shadow cursor-pointer",children:j.jsx(eu,{className:"p-4",children:j.jsxs("div",{className:"flex items-center justify-between",children:[j.jsx("div",{className:"flex flex-1",onClick:()=>{e(t?.user_copy_id?t?.user_copy_id.toString():t.original_id.toString())},children:j.jsx(hye,{dcm:t,showOwnerInfo:i})}),j.jsx(pye,{dcm:t,loading:f,isPublicData:a,isStudentData:o,showCopyButton:s,showEditButton:l,onCopy:y,onDelete:()=>g(!0),onEditName:()=>h(!0)})]})})}),j.jsx(gye,{isOpen:d,currentName:m(t),onClose:()=>h(!1),onSave:v,title:"修改复制名称",placeholder:"请输入新的复制名称"}),j.jsx(mye,{isOpen:p,title:"确认删除",message:`确定要删除数据集 "${m(t)}" 吗？此操作不可撤销。`,confirmText:"删除",cancelText:"取消",confirmColor:"danger",onConfirm:x,onCancel:()=>g(!1),isLoading:f.delete})]})}const yye=async(t={})=>{const{page:e=1,per_page:n=10,keyword:r,...i}=t,a={page:e,per_page:n,...i};return r&&(a.keyword=r),$a.get("/admin/users/students",a)},xye=async(t,e)=>$a.post("/admin/users/change-role",{user_id:t,new_role:e}),bye=async t=>$a.post("/admin/users/reset-password",{user_id:t}),wye=async()=>$a.get("/admin/original-data/test-oss/connection"),Cye=async t=>$a.upload("/admin/oss/upload",t);function Sye({onFileClick:t,onCopySuccess:e}){const{isStudent:n,hasTeacherPermission:r}=qh(),[i,a]=H.useState([]),[o,s]=H.useState(!0),[l,c]=H.useState(1),[f,u]=H.useState(0),[d,h]=H.useState(0),[p,g]=H.useState(10),[m,y]=H.useState(void 0),v=async(w=l,S)=>{s(!0);try{const _=await aye(w,p,void 0,(S===null?void 0:S??m)||void 0);_.success&&_.data?(a(_.data.list||[]),u(_.data.pagination.total||0),h(_.data.pagination.last_page||0),c(_.data.pagination.current_page||w),g(_.data.pagination.per_page||p)):Nt({color:"danger",description:_.message||"获取数据失败"})}catch(T){console.error("获取公共数据失败:",T),Nt({color:"danger",description:"网络错误，请稍后重试"})}finally{s(!1)}};H.useEffect(()=>{v()},[]);const x=w=>{c(w),v(w)};return o?j.jsx("div",{className:"flex items-center justify-center h-64",children:j.jsxs("div",{className:"flex items-center space-x-2",children:[j.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),j.jsx("div",{className:"text-gray-500",children:"加载中..."})]})}):j.jsxs("div",{className:"pb-6",children:[j.jsxs("div",{className:"flex justify-between items-center mb-6 gap-4 flex-wrap",children:[j.jsxs("h2",{className:"text-lg font-semibold text-gray-800",children:["公共数据列表 (",f,")"]}),j.jsxs("div",{className:"flex gap-x-2",children:[j.jsxs("div",{className:"flex items-center gap-2",children:[j.jsx("label",{className:"text-sm text-gray-600",children:"按分类筛选:"}),j.jsxs("select",{value:m??"",onChange:w=>{const S=w.target.value;if(!S){y(void 0),c(1),v(1,null);return}y(S),c(1),v(1,S)},className:"px-2 py-1 border rounded text-sm bg-white",children:[j.jsx("option",{value:"",children:"所有"}),j.jsx("option",{value:"1",children:"X光影像"}),j.jsx("option",{value:"2",children:"CT"}),j.jsx("option",{value:"3",children:"MRI"}),j.jsx("option",{value:"4",children:"超声"}),j.jsx("option",{value:"5",children:"PET"}),j.jsx("option",{value:"6",children:"病理图像"})]})]}),j.jsx("button",{onClick:()=>v(1,m??void 0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"刷新"})]})]}),j.jsx(tu,{children:j.jsxs(eu,{className:"p-6",children:[i.length===0?j.jsx("div",{className:"text-center py-16 text-gray-500",children:"暂无数据，试试更改筛选条件"}):j.jsx("div",{className:"space-y-4",children:i.map(w=>j.jsx(PD,{dcm:w,onFileClick:t,onDataChange:v,onCopySuccess:e,isPublicData:!0,showCopyButton:n,showEditButton:r},`PublicDataList${w.original_id}`))}),d>1&&j.jsx("div",{className:"flex flex-col sm:flex-row justify-center items-center px-6 py-5",children:j.jsx(OC,{total:d,page:l,onChange:x,showControls:!0,size:"md",color:"primary",variant:"flat",radius:"md",classNames:{wrapper:"gap-4 overflow-visible h-12",item:"w-12 h-12 text-base cursor-pointer",cursor:"w-12 h-12 text-base cursor-pointer",prev:"w-12 h-12 text-base cursor-pointer",next:"w-12 h-12 text-base cursor-pointer",ellipsis:"w-12 h-12 text-base cursor-pointer"}})})]})})]})}const NK=H.forwardRef(({userId:t,onFileClick:e},n)=>{qh();const[r,i]=H.useState([]),[a,o]=H.useState(!1),[s,l]=H.useState(1),[c,f]=H.useState(0),[u,d]=H.useState(0),h=10,p=async()=>{o(!0);try{const m=await $a.get("/student/userCopyList",{user_id:Number(t),page:s,per_page:h});m.success&&m.data?(i(m.data.list||[]),f(m.data.pagination.total||0),d(m.data.pagination.last_page||0),l(m.data.pagination.current_page||s)):Nt({color:"danger",description:m.message||"获取数据失败"})}catch(m){console.error("获取学生数据失败:",m),Nt({color:"danger",description:"网络错误，请稍后重试"})}finally{o(!1)}};H.useEffect(()=>{t&&p()},[t]);const g=m=>{l(m),p()};return H.useImperativeHandle(n,()=>({refresh:()=>p()}),[t]),a?j.jsx("div",{className:"flex items-center justify-center h-64",children:j.jsxs("div",{className:"flex items-center space-x-2",children:[j.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),j.jsx("div",{className:"text-gray-500",children:"加载中..."})]})}):j.jsxs("div",{className:"pb-6",children:[j.jsx("div",{className:"mb-6",children:j.jsxs("div",{className:"flex justify-between items-center",children:[j.jsxs("div",{children:[j.jsxs("h2",{className:"text-lg font-semibold text-gray-800",children:["我的数据列表 (",c,")"]}),j.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"您复制的数据，可以编辑名称"})]}),j.jsx("button",{onClick:()=>p(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"刷新"})]})}),j.jsx(tu,{children:j.jsx(eu,{className:"p-6",children:r.length===0?j.jsx("div",{className:"text-center py-8 text-gray-500",children:"暂无数据"}):j.jsxs(j.Fragment,{children:[j.jsx("div",{className:"space-y-4",children:r.map(m=>j.jsx(PD,{dcm:m,onFileClick:e,onDataChange:p,isPublicData:!1,isStudentData:!0,showCopyButton:!1,showEditButton:!1},`StudentDataList${m.user_copy_id}`))}),j.jsx("div",{className:"flex justify-center mt-6 w-full",children:j.jsx(OC,{total:u,page:s,onChange:g,showControls:!0,size:"md",color:"primary",classNames:{wrapper:"gap-4 overflow-visible h-12",item:"w-12 h-12 text-base cursor-pointer",cursor:"w-12 h-12 text-base cursor-pointer",prev:"w-12 h-12 text-base cursor-pointer",next:"w-12 h-12 text-base cursor-pointer",ellipsis:"w-12 h-12 text-base cursor-pointer"}})})]})})})]})});NK.displayName="StudentDataList";function Tye({onFileClick:t}){const[e,n]=H.useState([]),[r,i]=H.useState(!1),[a,o]=H.useState(1),[s,l]=H.useState(0),[c,f]=H.useState(0),[u,d]=H.useState(""),h=10,p=async(y=a,v=u)=>{i(!0);try{const x=await $a.get("/student/userCopyList",{keyword:v,per_page:h,page:y});x.success&&x.data?(n(x.data.list||[]),l(x.data.pagination.total||0),f(x.data.pagination.last_page||0),o(x.data.pagination.current_page||y)):Nt({color:"danger",description:x.message||"获取数据失败"})}catch(x){console.error("获取学生数据失败:",x),Nt({color:"danger",description:"网络错误，请稍后重试"})}finally{i(!1)}},g=()=>{o(1),p(1,u)},m=y=>{o(y),p(y,u)};return H.useEffect(()=>{p()},[]),r?j.jsx("div",{className:"flex items-center justify-center h-64",children:j.jsx("div",{className:"text-gray-500",children:"加载中..."})}):j.jsxs("div",{children:[j.jsx("div",{className:"mb-6",children:j.jsxs("h2",{className:"text-lg font-semibold text-gray-800",children:["所有学生数据 (",s,")"]})}),j.jsx("div",{className:"mb-6",children:j.jsx(U2,{placeholder:"搜索数据名称、拥有者、分类、标签",value:u,onValueChange:d,className:"max-w-md",endContent:j.jsx(qr,{size:"sm",color:"primary",variant:"flat",onClick:g,children:"搜索"}),onKeyDown:y=>{y.key==="Enter"&&g()}})}),j.jsx(tu,{children:j.jsx(eu,{className:"p-6",children:e.length===0?j.jsx("div",{className:"text-center py-8 text-gray-500",children:"暂无数据"}):j.jsxs(j.Fragment,{children:[j.jsx("div",{className:"space-y-4",children:e.map(y=>j.jsx(PD,{dcm:y,onFileClick:t,onDataChange:p,showOwnerInfo:!0,isStudentData:!0,showCopyButton:!1,showEditButton:!1},`AllStudentDataList${y.user_copy_id}`))}),j.jsx("div",{className:"flex justify-center mt-6 w-full",children:j.jsx(OC,{total:c,page:a,onChange:m,showControls:!0,size:"md",color:"primary",classNames:{wrapper:"gap-4 overflow-visible h-12",item:"w-12 h-12 text-base cursor-pointer",cursor:"w-12 h-12 text-base cursor-pointer",prev:"w-12 h-12 text-base cursor-pointer",next:"w-12 h-12 text-base cursor-pointer",ellipsis:"w-12 h-12 text-base cursor-pointer"}})})]})})})]})}function Eye(){const t=Ec(),{userInfo:e,isStudent:n,canViewAllStudentData:r}=qh(),[i,a]=H.useState("public"),o=H.useRef(null),s=()=>{n&&(a("student"),o.current&&o.current.refresh())},l=c=>{t(i==="public"?`/original/${c}`:`/detail/${c}`)};return j.jsx("div",{className:"min-h-screen bg-gray-50",children:j.jsx("div",{className:"max-w-7xl mx-auto p-6 pt-3",children:j.jsxs(b2e,{selectedKey:i,onSelectionChange:c=>a(c),variant:"underlined",classNames:{tabList:"gap-6 w-full relative rounded-none p-0 border-b border-divider",cursor:"w-full bg-primary-500",tab:"max-w-fit px-0 h-12"},children:[j.jsx(mE,{title:"公共数据",children:j.jsx(Sye,{onFileClick:l,onCopySuccess:s})},"public"),n&&j.jsx(mE,{title:"我的数据",children:j.jsx(NK,{ref:o,userId:e?.user_id?.toString()||"",onFileClick:l})},"student"),r&&j.jsx(mE,{title:"所有学生数据",children:j.jsx(Tye,{onFileClick:l})},"allStudent")]})})})}var nf={},Sx={},Tx={},Ex={},XL;function LK(){if(XL)return Ex;XL=1,Object.defineProperty(Ex,"__esModule",{value:!0});function t(n,r){if(!(n instanceof r))throw new TypeError("Cannot call a class as a function")}var e=function n(r,i){t(this,n),this.x=r,this.y=i};return Ex.default=e,Ex}var YL;function kK(){if(YL)return Tx;YL=1,Object.defineProperty(Tx,"__esModule",{value:!0});var t=(function(){function l(c,f){for(var u=0;u<f.length;u++){var d=f[u];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(c,d.key,d)}}return function(c,f,u){return f&&l(c.prototype,f),u&&l(c,u),c}})(),e=LK(),n=r(e);function r(l){return l&&l.__esModule?l:{default:l}}function i(l,c){if(!(l instanceof c))throw new TypeError("Cannot call a class as a function")}function a(l,c){if(!l)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return c&&(typeof c=="object"||typeof c=="function")?c:l}function o(l,c){if(typeof c!="function"&&c!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof c);l.prototype=Object.create(c&&c.prototype,{constructor:{value:l,enumerable:!1,writable:!0,configurable:!0}}),c&&(Object.setPrototypeOf?Object.setPrototypeOf(l,c):l.__proto__=c)}var s=(function(l){o(c,l);function c(){return i(this,c),a(this,(c.__proto__||Object.getPrototypeOf(c)).apply(this,arguments))}return t(c,[{key:"update",value:function(u){this.x=u.x,this.y=u.y}},{key:"moveByAngle",value:function(u,d){var h=u+Math.PI/2;this.x=this.x+Math.sin(h)*d,this.y=this.y-Math.cos(h)*d}},{key:"equalsTo",value:function(u){return this.x===u.x&&this.y===u.y}},{key:"getDifferenceTo",value:function(u){return new n.default(this.x-u.x,this.y-u.y)}},{key:"getDistanceTo",value:function(u){var d=this.getDifferenceTo(u);return Math.sqrt(Math.pow(d.x,2)+Math.pow(d.y,2))}},{key:"getAngleTo",value:function(u){var d=this.getDifferenceTo(u);return Math.atan2(d.y,d.x)}},{key:"toObject",value:function(){return{x:this.x,y:this.y}}}]),c})(n.default);return Tx.default=s,Tx}var JL;function _ye(){if(JL)return Sx;JL=1,Object.defineProperty(Sx,"__esModule",{value:!0});var t=(function(){function s(l,c){for(var f=0;f<c.length;f++){var u=c[f];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(l,u.key,u)}}return function(l,c,f){return c&&s(l.prototype,c),f&&s(l,f),l}})(),e=kK(),n=r(e);function r(s){return s&&s.__esModule?s:{default:s}}function i(s,l){if(!(s instanceof l))throw new TypeError("Cannot call a class as a function")}var a=30,o=(function(){function s(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},c=l.radius,f=c===void 0?a:c,u=l.enabled,d=u===void 0?!0:u,h=l.initialPoint,p=h===void 0?{x:0,y:0}:h;i(this,s),this.radius=f,this._isEnabled=d,this.pointer=new n.default(p.x,p.y),this.brush=new n.default(p.x,p.y),this.angle=0,this.distance=0,this._hasMoved=!1}return t(s,[{key:"enable",value:function(){this._isEnabled=!0}},{key:"disable",value:function(){this._isEnabled=!1}},{key:"isEnabled",value:function(){return this._isEnabled}},{key:"setRadius",value:function(c){this.radius=c}},{key:"getRadius",value:function(){return this.radius}},{key:"getBrushCoordinates",value:function(){return this.brush.toObject()}},{key:"getPointerCoordinates",value:function(){return this.pointer.toObject()}},{key:"getBrush",value:function(){return this.brush}},{key:"getPointer",value:function(){return this.pointer}},{key:"getAngle",value:function(){return this.angle}},{key:"getDistance",value:function(){return this.distance}},{key:"brushHasMoved",value:function(){return this._hasMoved}},{key:"update",value:function(c){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},u=f.both,d=u===void 0?!1:u;return this._hasMoved=!1,this.pointer.equalsTo(c)&&!d?!1:(this.pointer.update(c),d?(this._hasMoved=!0,this.brush.update(c),!0):(this._isEnabled?(this.distance=this.pointer.getDistanceTo(this.brush),this.angle=this.pointer.getAngleTo(this.brush),this.distance>this.radius&&(this.brush.moveByAngle(this.angle,this.distance-this.radius),this._hasMoved=!0)):(this.distance=0,this.angle=0,this.brush.update(c),this._hasMoved=!0),!0))}}]),s})();return Sx.default=o,Sx}var ZL;function Dye(){if(ZL)return nf;ZL=1,Object.defineProperty(nf,"__esModule",{value:!0}),nf.LazyPoint=nf.Point=nf.LazyBrush=void 0;var t=_ye(),e=o(t),n=LK(),r=o(n),i=kK(),a=o(i);function o(s){return s&&s.__esModule?s:{default:s}}return nf.LazyBrush=e.default,nf.Point=r.default,nf.LazyPoint=a.default,nf}var Oye=Dye(),L0={},_x={},Dx={},QL;function VK(){if(QL)return Dx;QL=1,Object.defineProperty(Dx,"__esModule",{value:!0});var t=(function(){function r(i,a){for(var o=0;o<a.length;o++){var s=a[o];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(i,s.key,s)}}return function(i,a,o){return a&&r(i.prototype,a),o&&r(i,o),i}})();function e(r,i){if(!(r instanceof i))throw new TypeError("Cannot call a class as a function")}var n=(function(){function r(i,a){e(this,r),this.x=i,this.y=a}return t(r,[{key:"update",value:function(a){this.x=a.x,this.y=a.y}},{key:"getDifferenceTo",value:function(a){return new r(this.x-a.x,this.y-a.y)}},{key:"getDistanceTo",value:function(a){var o=this.getDifferenceTo(a);return Math.sqrt(Math.pow(o.x,2)+Math.pow(o.y,2))}}]),r})();return Dx.default=n,Dx}var ek;function Mye(){if(ek)return _x;ek=1,Object.defineProperty(_x,"__esModule",{value:!0});var t=(function(){function s(l,c){for(var f=0;f<c.length;f++){var u=c[f];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(l,u.key,u)}}return function(l,c,f){return c&&s(l.prototype,c),f&&s(l,f),l}})(),e=VK(),n=r(e);function r(s){return s&&s.__esModule?s:{default:s}}function i(s,l){if(!(s instanceof l))throw new TypeError("Cannot call a class as a function")}var a=1e-6,o=(function(){function s(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},c=l.segments,f=c===void 0?50:c,u=l.iterationLimit,d=u===void 0?100:u;i(this,s),this.p1=new n.default,this.p2=new n.default,this.segments=f,this.iterationLimit=d}return t(s,[{key:"drawToCanvas",value:function(c,f,u,d){this.p1.update(f),this.p2.update(u);var h=this.p1.x>this.p2.x,p=h?this.p2:this.p1,g=h?this.p1:this.p2,m=p.getDistanceTo(g),y=[],v=!0;if(m<d){var x=g.x-p.x;if(x>.01){var w=g.x-p.x,S=g.y-p.y,T=-this.getCatenaryParameter(w,S,d,this.iterationLimit),_=(T*Math.log((d+S)/(d-S))-w)*.5,D=T*Math.cosh(_/T),I=p.x-_,R=p.y-D;y=this.getCurve(T,p,g,I,R,this.segments),v=!1}else{var O=(p.x+g.x)*.5,P=(p.y+g.y+d)*.5;y=[[p.x,p.y],[O,P],[g.x,g.y]]}}else y=[[p.x,p.y],[g.x,g.y]];return v?this.drawLine(y,c):this.drawCurve(y,c),y}},{key:"getCatenaryParameter",value:function(c,f,u,d){for(var h=Math.sqrt(u*u-f*f)/c,p=Math.acosh(h)+1,g=-1,m=0;Math.abs(p-g)>a&&m<d;)g=p,p=p-(Math.sinh(p)-h*p)/(Math.cosh(p)-h),m++;return c/(2*p)}},{key:"getCurve",value:function(c,f,u,d,h,p){for(var g=[f.x,c*Math.cosh((f.x-d)/c)+h],m=u.x-f.x,y=p-1,v=0;v<y;v++){var x=f.x+m*(v+.5)/y,w=c*Math.cosh((x-d)/c)+h;g.push(x,w)}return g.push(u.x,c*Math.cosh((u.x-d)/c)+h),g}},{key:"drawLine",value:function(c,f){f.moveTo(c[0][0],c[0][1]),f.lineTo(c[1][0],c[1][1])}},{key:"drawCurve",value:function(c,f){var u=c.length*.5-1,d=c[2],h=c[3],p=[];f.moveTo(c[0],c[1]);for(var g=2;g<u;g++){var m=c[g*2],y=c[g*2+1],v=(m+d)*.5,x=(y+h)*.5;p.push([d,h,v,x]),f.quadraticCurveTo(d,h,v,x),d=m,h=y}return u=c.length,f.quadraticCurveTo(c[u-4],c[u-3],c[u-2],c[u-1]),p}}]),s})();return _x.default=o,_x}var tk;function Iye(){if(tk)return L0;tk=1,Object.defineProperty(L0,"__esModule",{value:!0}),L0.Point=L0.Catenary=void 0;var t=Mye(),e=i(t),n=VK(),r=i(n);function i(a){return a&&a.__esModule?a:{default:a}}return L0.Catenary=e.default,L0.Point=r.default,L0}var Rye=Iye(),FK=(function(){if(typeof Map<"u")return Map;function t(e,n){var r=-1;return e.some(function(i,a){return i[0]===n?(r=a,!0):!1}),r}return(function(){function e(){this.__entries__=[]}return Object.defineProperty(e.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),e.prototype.get=function(n){var r=t(this.__entries__,n),i=this.__entries__[r];return i&&i[1]},e.prototype.set=function(n,r){var i=t(this.__entries__,n);~i?this.__entries__[i][1]=r:this.__entries__.push([n,r])},e.prototype.delete=function(n){var r=this.__entries__,i=t(r,n);~i&&r.splice(i,1)},e.prototype.has=function(n){return!!~t(this.__entries__,n)},e.prototype.clear=function(){this.__entries__.splice(0)},e.prototype.forEach=function(n,r){r===void 0&&(r=null);for(var i=0,a=this.__entries__;i<a.length;i++){var o=a[i];n.call(r,o[1],o[0])}},e})()})(),i_=typeof window<"u"&&typeof document<"u"&&window.document===document,$w=(function(){return typeof global<"u"&&global.Math===Math?global:typeof self<"u"&&self.Math===Math?self:typeof window<"u"&&window.Math===Math?window:Function("return this")()})(),Pye=(function(){return typeof requestAnimationFrame=="function"?requestAnimationFrame.bind($w):function(t){return setTimeout(function(){return t(Date.now())},1e3/60)}})(),Aye=2;function Nye(t,e){var n=!1,r=!1,i=0;function a(){n&&(n=!1,t()),r&&s()}function o(){Pye(a)}function s(){var l=Date.now();if(n){if(l-i<Aye)return;r=!0}else n=!0,r=!1,setTimeout(o,e);i=l}return s}var Lye=20,kye=["top","right","bottom","left","width","height","size","weight"],Vye=typeof MutationObserver<"u",Fye=(function(){function t(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=Nye(this.refresh.bind(this),Lye)}return t.prototype.addObserver=function(e){~this.observers_.indexOf(e)||this.observers_.push(e),this.connected_||this.connect_()},t.prototype.removeObserver=function(e){var n=this.observers_,r=n.indexOf(e);~r&&n.splice(r,1),!n.length&&this.connected_&&this.disconnect_()},t.prototype.refresh=function(){var e=this.updateObservers_();e&&this.refresh()},t.prototype.updateObservers_=function(){var e=this.observers_.filter(function(n){return n.gatherActive(),n.hasActive()});return e.forEach(function(n){return n.broadcastActive()}),e.length>0},t.prototype.connect_=function(){!i_||this.connected_||(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),Vye?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},t.prototype.disconnect_=function(){!i_||!this.connected_||(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},t.prototype.onTransitionEnd_=function(e){var n=e.propertyName,r=n===void 0?"":n,i=kye.some(function(a){return!!~r.indexOf(a)});i&&this.refresh()},t.getInstance=function(){return this.instance_||(this.instance_=new t),this.instance_},t.instance_=null,t})(),UK=(function(t,e){for(var n=0,r=Object.keys(e);n<r.length;n++){var i=r[n];Object.defineProperty(t,i,{value:e[i],enumerable:!1,writable:!1,configurable:!0})}return t}),um=(function(t){var e=t&&t.ownerDocument&&t.ownerDocument.defaultView;return e||$w}),BK=MC(0,0,0,0);function Gw(t){return parseFloat(t)||0}function nk(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return e.reduce(function(r,i){var a=t["border-"+i+"-width"];return r+Gw(a)},0)}function Uye(t){for(var e=["top","right","bottom","left"],n={},r=0,i=e;r<i.length;r++){var a=i[r],o=t["padding-"+a];n[a]=Gw(o)}return n}function Bye(t){var e=t.getBBox();return MC(0,0,e.width,e.height)}function $ye(t){var e=t.clientWidth,n=t.clientHeight;if(!e&&!n)return BK;var r=um(t).getComputedStyle(t),i=Uye(r),a=i.left+i.right,o=i.top+i.bottom,s=Gw(r.width),l=Gw(r.height);if(r.boxSizing==="border-box"&&(Math.round(s+a)!==e&&(s-=nk(r,"left","right")+a),Math.round(l+o)!==n&&(l-=nk(r,"top","bottom")+o)),!jye(t)){var c=Math.round(s+a)-e,f=Math.round(l+o)-n;Math.abs(c)!==1&&(s-=c),Math.abs(f)!==1&&(l-=f)}return MC(i.left,i.top,s,l)}var Gye=(function(){return typeof SVGGraphicsElement<"u"?function(t){return t instanceof um(t).SVGGraphicsElement}:function(t){return t instanceof um(t).SVGElement&&typeof t.getBBox=="function"}})();function jye(t){return t===um(t).document.documentElement}function zye(t){return i_?Gye(t)?Bye(t):$ye(t):BK}function Wye(t){var e=t.x,n=t.y,r=t.width,i=t.height,a=typeof DOMRectReadOnly<"u"?DOMRectReadOnly:Object,o=Object.create(a.prototype);return UK(o,{x:e,y:n,width:r,height:i,top:n,right:e+r,bottom:i+n,left:e}),o}function MC(t,e,n,r){return{x:t,y:e,width:n,height:r}}var Hye=(function(){function t(e){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=MC(0,0,0,0),this.target=e}return t.prototype.isActive=function(){var e=zye(this.target);return this.contentRect_=e,e.width!==this.broadcastWidth||e.height!==this.broadcastHeight},t.prototype.broadcastRect=function(){var e=this.contentRect_;return this.broadcastWidth=e.width,this.broadcastHeight=e.height,e},t})(),Kye=(function(){function t(e,n){var r=Wye(n);UK(this,{target:e,contentRect:r})}return t})(),qye=(function(){function t(e,n,r){if(this.activeObservations_=[],this.observations_=new FK,typeof e!="function")throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=e,this.controller_=n,this.callbackCtx_=r}return t.prototype.observe=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(e instanceof um(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var n=this.observations_;n.has(e)||(n.set(e,new Hye(e)),this.controller_.addObserver(this),this.controller_.refresh())}},t.prototype.unobserve=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(e instanceof um(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var n=this.observations_;n.has(e)&&(n.delete(e),n.size||this.controller_.removeObserver(this))}},t.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},t.prototype.gatherActive=function(){var e=this;this.clearActive(),this.observations_.forEach(function(n){n.isActive()&&e.activeObservations_.push(n)})},t.prototype.broadcastActive=function(){if(this.hasActive()){var e=this.callbackCtx_,n=this.activeObservations_.map(function(r){return new Kye(r.target,r.broadcastRect())});this.callback_.call(e,n,e),this.clearActive()}},t.prototype.clearActive=function(){this.activeObservations_.splice(0)},t.prototype.hasActive=function(){return this.activeObservations_.length>0},t})(),$K=typeof WeakMap<"u"?new WeakMap:new FK,GK=(function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var n=Fye.getInstance(),r=new qye(e,n,this);$K.set(this,r)}return t})();["observe","unobserve","disconnect"].forEach(function(t){GK.prototype[t]=function(){var e;return(e=$K.get(this))[t].apply(e,arguments)}});var Xye=(function(){return typeof $w.ResizeObserver<"u"?$w.ResizeObserver:GK})();function Md(){return Md=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Md.apply(this,arguments)}function Yye(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Jye(t,e,n){return e&&Yye(t.prototype,e),t}function Ws(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var rk=Object.freeze({x:0,y:0,untransformedX:0,untransformedY:0}),vE=Object.freeze({canvasWidth:0,canvasHeight:0,left:0,top:0,right:0,bottom:0,viewMin:rk,viewMax:rk}),Np=Object.freeze({a:1,b:0,c:0,d:1,e:0,f:0}),Zye=(function(){function t(e){var n=this,r=e.scaleExtents,i=e.documentSize;Ws(this,"_scaleExtents",void 0),Ws(this,"_documentSize",void 0),Ws(this,"_canvas",null),Ws(this,"_view",{scale:1,x:0,y:0}),Ws(this,"_viewChangeListeners",new Set),Ws(this,"setScale",function(a){n.setView({scale:a})}),Ws(this,"clampView",function(a){var o=a.scale,s=a.x,l=a.y,c=n.scaleExtents,f=c.min,u=c.max,d=n.documentSize,h=d.width,p=d.height,g=n.canvasRect||vE,m=g.left,y=g.top,v=g.right,x=g.bottom,w=v-m,S=x-y,T=w/2,_=-(h*n._view.scale-w/2),D=S/2,I=-(p*n._view.scale-S/2);return{scale:Math.min(Math.max(o,f),u),x:Math.min(Math.max(s,_),T),y:Math.min(Math.max(l,I),D)}}),Ws(this,"resetView",function(){n.setView({scale:1,x:0,y:0})}),Ws(this,"setView",function(a){var o=n.clampView(Md({},n._view,a||{})),s=n._view,l=s.scale,c=s.x,f=s.y;return(o.scale!==l||o.x!==c||o.y!==f)&&(n._view=o,n._viewChangeListeners.forEach(function(u){return u&&u(o)})),Md({},n._view)}),Ws(this,"scaleAtClientPoint",function(a,o){var s=n.clientPointToViewPoint(o),l=n.clampView(Md({},n._view,{scale:n._view.scale+a})),c=n.viewPointToClientPoint(s,l);return l.x=n._view.x-(c.clientX-o.clientX),l.y=n._view.y-(c.clientY-o.clientY),n.setView(l)}),Ws(this,"clientPointToViewPoint",function(a,o){var s=a.clientX,l=a.clientY;o===void 0&&(o=n._view);var c=n.canvasRect||vE,f=c.left,u=c.top,d=s-f,h=l-u;return{x:(d-o.x)/o.scale,y:(h-o.y)/o.scale,relativeClientX:d,relativeClientY:h}}),Ws(this,"viewPointToClientPoint",function(a,o){var s=a.x,l=a.y;o===void 0&&(o=n._view);var c=n.canvasRect||vE,f=c.left,u=c.top,d=s*o.scale+o.x,h=l*o.scale+o.y,p=d+f,g=h+u;return{clientX:p,clientY:g,relativeX:d,relativeY:h,x:p,y:g}}),Ws(this,"attachViewChangeListener",function(a){n._viewChangeListeners.add(a)}),this._scaleExtents=r,this._documentSize=i}return Jye(t,[{key:"canvas",get:function(){return this._canvas},set:function(n){this._canvas=n,this.setView()}},{key:"scale",get:function(){return this._view.scale}},{key:"x",get:function(){return this._view.x},set:function(n){this.setView({x:n})}},{key:"y",get:function(){return this._view.y},set:function(n){this.setView({y:n})}},{key:"view",get:function(){return Md({},this._view)}},{key:"scaleExtents",get:function(){return Md({},this._scaleExtents)},set:function(n){var r=n.min,i=n.max;this._scaleExtents={min:r,max:i},this.setView()}},{key:"documentSize",get:function(){return Md({},this._documentSize)},set:function(n){var r=n.width,i=n.height;this._documentSize={width:r,height:i},this.setView()}},{key:"transformMatrix",get:function(){return{a:this._view.scale,b:0,c:0,d:this._view.scale,e:this._view.x,f:this._view.y}}},{key:"canvasBounds",get:function(){if(this._canvas){var n=this._canvas.getBoundingClientRect(),r=n.left,i=n.top,a=n.right,o=n.bottom;return{viewMin:this.clientPointToViewPoint({clientX:r,clientY:i}),viewMax:this.clientPointToViewPoint({clientX:a,clientY:o}),left:r,top:i,right:a,bottom:o,canvasWidth:this._canvas.width,canvasHeight:this._canvas.height}}else return}},{key:"canvasRect",get:function(){if(this.canvas)return this.canvas.getBoundingClientRect()}}]),t})();function Qye(t){var e=t===void 0?{}:t,n=e.ctx,r=e.img,i=e.x,a=e.y,o=e.w,s=e.h,l=e.offsetX,c=e.offsetY;typeof i!="number"&&(i=0),typeof a!="number"&&(a=0),typeof o!="number"&&(o=n.canvas.width),typeof s!="number"&&(s=n.canvas.height),typeof l!="number"&&(l=.5),typeof c!="number"&&(c=.5),l<0&&(l=0),c<0&&(c=0),l>1&&(l=1),c>1&&(c=1);var f=r.width,u=r.height,d=Math.min(o/f,s/u),h=f*d,p=u*d,g,m,y,v,x=1;h<o&&(x=o/h),Math.abs(x-1)<1e-14&&p<s&&(x=s/p),h*=x,p*=x,y=f/(h/o),v=u/(p/s),g=(f-y)*l,m=(u-v)*c,g<0&&(g=0),m<0&&(m=0),y>f&&(y=f),v>u&&(v=u),n.drawImage(r,g,m,y,v,i,a,o,s)}var e5e=void 0;function lr(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var a_=10,t5e=250,Um=function(e){return e.preventDefault(),e5e},_s=function(){var e=this;lr(this,"handleMouseWheel",function(n,r){var i=r.props,a=i.disabled,o=i.enablePanAndZoom,s=i.mouseZoomFactor;return a?new Ox:(o&&n.ctrlKey&&(n.preventDefault(),r.coordSystem.scaleAtClientPoint(s*n.deltaY,Ph(n))),e)}),lr(this,"handleDrawStart",function(n,r){return r.props.disabled?new Ox:n.ctrlKey&&r.props.enablePanAndZoom?new n5e().handleDrawStart(n,r):new r5e().handleDrawStart(n,r)}),lr(this,"handleDrawMove",function(n,r){if(r.props.disabled)return new Ox;var i=o_(r.coordSystem,n),a=i.x,o=i.y;return r.lazy.update({x:a,y:o}),e}),lr(this,"handleDrawEnd",function(n,r){return r.props.disabled?new Ox:e})},Ox=function(){var e=this;lr(this,"handleMouseWheel",function(n,r){return r.props.disabled?e:new _s().handleMouseWheel(n,r)}),lr(this,"handleDrawStart",function(n,r){return r.props.disabled?e:new _s().handleDrawStart(n,r)}),lr(this,"handleDrawMove",function(n,r){return r.props.disabled?e:new _s().handleDrawMove(n,r)}),lr(this,"handleDrawEnd",function(n,r){return r.props.disabled?e:new _s().handleDrawEnd(n,r)})},n5e=function(){var e=this;lr(this,"handleMouseWheel",Um.bind(this)),lr(this,"handleDrawStart",function(n,r){return n.preventDefault(),e.dragStart=Ph(n),e.panStart={x:r.coordSystem.x,y:r.coordSystem.y},e}),lr(this,"handleDrawMove",function(n,r){n.preventDefault();var i=Ph(n),a=i.clientX,o=i.clientY,s=a-e.dragStart.clientX,l=o-e.dragStart.clientY;return r.coordSystem.setView({x:e.panStart.x+s,y:e.panStart.y+l}),e}),lr(this,"handleDrawEnd",function(){return new _s})},r5e=function(){var e=this;lr(this,"handleMouseWheel",Um.bind(this)),lr(this,"handleDrawStart",function(n,r){var i=r.props.enablePanAndZoom;return n.preventDefault(),!n.touches||!n.touches.length||!i?new ak().handleDrawStart(n,r):i&&n.touches&&n.touches.length>=2?new ik().handleDrawStart(n,r):e.handleDrawMove(n,r)}),lr(this,"handleDrawMove",function(n,r){if(n.preventDefault(),n.touches&&n.touches.length>=2)return new ik().handleDrawStart(n,r);var i=Ph(n);if(e.deferredPoints.push(i),new Date().valueOf()-e.startTimestamp<t5e){e.startClientPoint===null&&(e.startClientPoint=i);var a=Math.abs(i.clientX-e.startClientPoint.clientX)+Math.abs(i.clientY-e.startClientPoint.clientY);if(a<a_)return e}return e.issueDeferredPoints(r)}),lr(this,"handleDrawEnd",function(n,r){return e.issueDeferredPoints(r).handleDrawEnd(n,r)}),lr(this,"issueDeferredPoints",function(n){for(var r=new ak,i=0;i<e.deferredPoints.length;i++){var a=e.deferredPoints[i],o=new o5e(a),s=i===0?r.handleDrawStart:r.handleDrawMove;r=s(o,n)}return r}),this.startClientPoint=null,this.startTimestamp=new Date().valueOf(),this.deferredPoints=[]},ik=function(){var e=this;lr(this,"handleMouseWheel",Um.bind(this)),lr(this,"handleDrawStart",function(n,r){return n.preventDefault(),!n.touches||n.touches.length<2?new _s:(e.start=e.getTouchMetrics(n),e.panStart={x:r.coordSystem.x,y:r.coordSystem.y},e.scaleStart=r.coordSystem.scale,e)}),lr(this,"handleDrawMove",function(n,r){if(n.preventDefault(),!n.touches||n.touches.length<2)return new _s;var i=e.recentMetrics=e.getTouchMetrics(n),a=i.centroid,o=i.distance,s=Math.abs(o-e.start.distance);if(s>=a_)return new a5e(e).handleDrawMove(n,r);var l=a.clientX-e.start.centroid.clientX,c=a.clientY-e.start.centroid.clientY,f=Math.abs(l)+Math.abs(c);return f>=a_?new i5e(e).handleDrawMove(n,r):e}),lr(this,"handleDrawEnd",function(){return new _s}),lr(this,"getTouchMetrics",function(n){var r=Ph(n.touches[0]),i=r.clientX,a=r.clientY,o=Ph(n.touches[1]),s=o.clientX,l=o.clientY,c=s-i,f=l-a;return{t1:{clientX:i,clientY:a},t2:{clientX:s,clientY:l},distance:Math.sqrt(c*c+f*f),centroid:{clientX:(i+s)/2,clientY:(a+l)/2}}})},i5e=function(e){var n=this;lr(this,"handleMouseWheel",Um.bind(this)),lr(this,"handleDrawStart",function(){return n}),lr(this,"handleDrawMove",function(r,i){if(r.preventDefault(),!r.touches||r.touches.length<2)return new _s;var a=n.scaleOrPanState,o=a.recentMetrics=a.getTouchMetrics(r),s=o.centroid;o.distance;var l=s.clientX-a.start.centroid.clientX,c=s.clientY-a.start.centroid.clientY;return i.setView({x:a.panStart.x+l,y:a.panStart.y+c}),n}),lr(this,"handleDrawEnd",function(){return new _s}),this.scaleOrPanState=e},a5e=function(e){var n=this;lr(this,"handleMouseWheel",Um.bind(this)),lr(this,"handleDrawStart",function(){return n}),lr(this,"handleDrawMove",function(r,i){if(r.preventDefault(),!r.touches||r.touches.length<2)return new _s;var a=n.scaleOrPanState,o=a.recentMetrics=a.getTouchMetrics(r),s=o.centroid,l=o.distance,c=a.scaleStart*(l/a.start.distance),f=c-i.coordSystem.scale;return i.coordSystem.scaleAtClientPoint(f,s),n}),lr(this,"handleDrawEnd",function(){return new _s}),this.scaleOrPanState=e},ak=function(){var e=this;lr(this,"handleMouseWheel",Um.bind(this)),lr(this,"handleDrawStart",function(n,r){if(n.preventDefault(),n.touches&&n.touches.length){var i=o_(r.coordSystem,n),a=i.x,o=i.y;r.lazy.update({x:a,y:o},{both:!0})}return e.handleDrawMove(n,r)}),lr(this,"handleDrawMove",function(n,r){n.preventDefault();var i=o_(r.coordSystem,n),a=i.x,o=i.y;r.lazy.update({x:a,y:o});var s=!r.lazy.isEnabled();return(!e.isDrawing||s)&&(r.points.push(r.clampPointToDocument(r.lazy.brush.toObject())),e.isDrawing=!0),r.points.push(r.clampPointToDocument(r.lazy.brush.toObject())),r.drawPoints({points:r.points,brushColor:r.props.brushColor,brushRadius:r.props.brushRadius}),e}),lr(this,"handleDrawEnd",function(n,r){return n.preventDefault(),e.handleDrawMove(n,r),r.saveLine(),new _s}),this.isDrawing=!1},o5e=function(e){var n=e.clientX,r=e.clientY;lr(this,"preventDefault",function(){}),this.clientX=n,this.clientY=r,this.touches=[{clientX:n,clientY:r}]};function Ph(t){var e=t.clientX,n=t.clientY;return t.changedTouches&&t.changedTouches.length>0&&(e=t.changedTouches[0].clientX,n=t.changedTouches[0].clientY),{clientX:e,clientY:n}}function o_(t,e){return t.clientPointToViewPoint(Ph(e))}var s_=!1;try{var Mx={get passive(){return s_=!0,!1}};window.addEventListener("test",Mx,Mx),window.removeEventListener("test",Mx,Mx)}catch{s_=!1}function s5e(t){return s_?{passive:t}:t}function l5e(t,e){var n;if(typeof Symbol>"u"||t[Symbol.iterator]==null){if(Array.isArray(t)||(n=c5e(t))||e){n&&(t=n);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}return n=t[Symbol.iterator](),n.next.bind(n)}function c5e(t,e){if(t){if(typeof t=="string")return ok(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ok(t,e)}}function ok(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function t2(){return t2=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},t2.apply(this,arguments)}function ir(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u5e(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}function Mr(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function f5e(t,e){return{x:t.x+(e.x-t.x)/2,y:t.y+(e.y-t.y)/2}}var d5e={display:"block",position:"absolute"},sk=["grid","drawing","temp","interface"],AD=(function(t){u5e(e,t);function e(r){var i;return i=t.call(this,r)||this,Mr(ir(i),"undo",function(){var a=[];i.lines.length?a=i.lines.slice(0,-1):i.erasedLines.length&&(a=i.erasedLines.pop()),i.clearExceptErasedLines(),i.simulateDrawingLines({lines:a,immediate:!0}),i.triggerOnChange()}),Mr(ir(i),"eraseAll",function(){i.erasedLines.push([].concat(i.lines)),i.clearExceptErasedLines(),i.triggerOnChange()}),Mr(ir(i),"clear",function(){i.erasedLines=[],i.clearExceptErasedLines(),i.resetView()}),Mr(ir(i),"resetView",function(){return i.coordSystem.resetView()}),Mr(ir(i),"setView",function(a){return i.coordSystem.setView(a)}),Mr(ir(i),"getSaveData",function(){return JSON.stringify({lines:i.lines,width:i.props.canvasWidth,height:i.props.canvasHeight})}),Mr(ir(i),"getDataURL",function(a,o,s){var l=i.canvas.drawing,c=l.getContext("2d"),f=l.width,u=l.height,d=c.getImageData(0,0,f,u),h=c.globalCompositeOperation;if(c.globalCompositeOperation="destination-over",o){if(!i.props.imgSrc)return"Background image source not set";i.drawImage()}else s!=null&&(c.fillStyle=s,c.fillRect(0,0,f,u));a||(a="png");var p=l.toDataURL("image/"+a);return c.clearRect(0,0,f,u),c.putImageData(d,0,0),c.globalCompositeOperation=h,p}),Mr(ir(i),"loadSaveData",function(a,o){if(o===void 0&&(o=i.props.immediateLoading),typeof a!="string")throw new Error("saveData needs to be of type string!");var s=JSON.parse(a),l=s.lines,c=s.width,f=s.height;if(!l||typeof l.push!="function")throw new Error("saveData.lines needs to be an array!");if(i.clear(),c===i.props.canvasWidth&&f===i.props.canvasHeight)i.simulateDrawingLines({lines:l,immediate:o});else{var u=i.props.canvasWidth/c,d=i.props.canvasHeight/f,h=(u+d)/2;i.simulateDrawingLines({lines:l.map(function(p){return t2({},p,{points:p.points.map(function(g){return{x:g.x*u,y:g.y*d}}),brushRadius:p.brushRadius*h})}),immediate:o})}}),Mr(ir(i),"componentWillUnmount",function(){i.canvasObserver.unobserve(i.canvasContainer),i.canvas.interface&&i.canvas.interface.removeEventListener("wheel",i.handleWheel)}),Mr(ir(i),"handleWheel",function(a){i.interactionSM=i.interactionSM.handleMouseWheel(a,ir(i))}),Mr(ir(i),"handleDrawStart",function(a){i.interactionSM=i.interactionSM.handleDrawStart(a,ir(i)),i.mouseHasMoved=!0}),Mr(ir(i),"handleDrawMove",function(a){i.interactionSM=i.interactionSM.handleDrawMove(a,ir(i)),i.mouseHasMoved=!0}),Mr(ir(i),"handleDrawEnd",function(a){i.interactionSM=i.interactionSM.handleDrawEnd(a,ir(i)),i.mouseHasMoved=!0}),Mr(ir(i),"applyView",function(){if(i.ctx.drawing&&(sk.map(function(o){return i.ctx[o]}).forEach(function(o){i.clearWindow(o);var s=i.coordSystem.transformMatrix;o.setTransform(s.a,s.b,s.c,s.d,s.e,s.f)}),!i.deferRedrawOnViewChange)){i.drawGrid(i.ctx.grid),i.redrawImage(),i.loop({once:!0});var a=i.lines;i.lines=[],i.simulateDrawingLines({lines:a,immediate:!0})}}),Mr(ir(i),"handleCanvasResize",function(a){var o=i.getSaveData();i.deferRedrawOnViewChange=!0;try{for(var s=l5e(a),l;!(l=s()).done;){var c=l.value,f=c.contentRect,u=f.width,d=f.height;i.setCanvasSize(i.canvas.interface,u,d),i.setCanvasSize(i.canvas.drawing,u,d),i.setCanvasSize(i.canvas.temp,u,d),i.setCanvasSize(i.canvas.grid,u,d),i.coordSystem.documentSize={width:u,height:d},i.drawGrid(i.ctx.grid),i.drawImage(),i.loop({once:!0})}i.loadSaveData(o,!0)}finally{i.deferRedrawOnViewChange=!1}}),Mr(ir(i),"clampPointToDocument",function(a){return i.props.clampLinesToDocument?{x:Math.max(Math.min(a.x,i.props.canvasWidth),0),y:Math.max(Math.min(a.y,i.props.canvasHeight),0)}:a}),Mr(ir(i),"redrawImage",function(){i.image&&i.image.complete&&Qye({ctx:i.ctx.grid,img:i.image})}),Mr(ir(i),"simulateDrawingLines",function(a){var o=a.lines,s=a.immediate,l=0,c=s?0:i.props.loadTimeOffset;o.forEach(function(f){var u=f.points,d=f.brushColor,h=f.brushRadius;if(s){i.drawPoints({points:u,brushColor:d,brushRadius:h}),i.points=u,i.saveLine({brushColor:d,brushRadius:h});return}for(var p=function(y){l+=c,window.setTimeout(function(){i.drawPoints({points:u.slice(0,y+1),brushColor:d,brushRadius:h})},l)},g=1;g<u.length;g++)p(g);l+=c,window.setTimeout(function(){i.points=u,i.saveLine({brushColor:d,brushRadius:h})},l)})}),Mr(ir(i),"setCanvasSize",function(a,o,s){a.width=o,a.height=s,a.style.width=o,a.style.height=s}),Mr(ir(i),"drawPoints",function(a){var o=a.points,s=a.brushColor,l=a.brushRadius;i.ctx.temp.lineJoin="round",i.ctx.temp.lineCap="round",i.ctx.temp.strokeStyle=s,i.clearWindow(i.ctx.temp),i.ctx.temp.lineWidth=l*2;var c=o[0],f=o[1];i.ctx.temp.moveTo(f.x,f.y),i.ctx.temp.beginPath();for(var u=1,d=o.length;u<d;u++){var h=f5e(c,f);i.ctx.temp.quadraticCurveTo(c.x,c.y,h.x,h.y),c=o[u],f=o[u+1]}i.ctx.temp.lineTo(c.x,c.y),i.ctx.temp.stroke()}),Mr(ir(i),"saveLine",function(a){var o=a===void 0?{}:a,s=o.brushColor,l=o.brushRadius;i.points.length<2||(i.lines.push({points:[].concat(i.points),brushColor:s||i.props.brushColor,brushRadius:l||i.props.brushRadius}),i.points.length=0,i.inClientSpace([i.ctx.drawing,i.ctx.temp],function(){i.ctx.drawing.drawImage(i.canvas.temp,0,0,i.canvas.drawing.width,i.canvas.drawing.height)}),i.clearWindow(i.ctx.temp),i.triggerOnChange())}),Mr(ir(i),"triggerOnChange",function(){i.props.onChange&&i.props.onChange(ir(i))}),Mr(ir(i),"clearWindow",function(a){i.inClientSpace([a],function(){return a.clearRect(0,0,a.canvas.width,a.canvas.height)})}),Mr(ir(i),"clearExceptErasedLines",function(){i.lines=[],i.valuesChanged=!0,i.clearWindow(i.ctx.drawing),i.clearWindow(i.ctx.temp)}),Mr(ir(i),"loop",function(a){var o=a===void 0?{}:a,s=o.once,l=s===void 0?!1:s;if(i.mouseHasMoved||i.valuesChanged){var c=i.lazy.getPointerCoordinates(),f=i.lazy.getBrushCoordinates();i.drawInterface(i.ctx.interface,c,f),i.mouseHasMoved=!1,i.valuesChanged=!1}l||window.requestAnimationFrame(function(){i.loop()})}),Mr(ir(i),"inClientSpace",function(a,o){a.forEach(function(s){s.save(),s.setTransform(Np.a,Np.b,Np.c,Np.d,Np.e,Np.f)});try{o()}finally{a.forEach(function(s){return s.restore()})}}),Mr(ir(i),"drawImage",function(){i.props.imgSrc&&(i.image=new Image,i.image.crossOrigin="anonymous",i.image.onload=i.redrawImage,i.image.src=i.props.imgSrc)}),Mr(ir(i),"drawGrid",function(a){if(!i.props.hideGrid){i.clearWindow(a);var o=25,s=i.coordSystem.canvasBounds,l=s.viewMin,c=s.viewMax,f=Math.floor(l.x/o-1)*o,u=Math.floor(l.y/o-1)*o,d=c.x+o,h=c.y+o;if(a.beginPath(),a.setLineDash([5,1]),a.setLineDash([]),a.strokeStyle=i.props.gridColor,a.lineWidth=i.props.gridLineWidth,!i.props.hideGridX){for(var p=f,g=i.props.gridSizeX;p<d;)p+=g,a.moveTo(p,u),a.lineTo(p,h);a.stroke()}if(!i.props.hideGridY){for(var m=u,y=i.props.gridSizeY;m<h;)m+=y,a.moveTo(f,m),a.lineTo(d,m);a.stroke()}}}),Mr(ir(i),"drawInterface",function(a,o,s){i.props.hideInterface||(i.clearWindow(a),a.beginPath(),a.fillStyle=i.props.brushColor,a.arc(s.x,s.y,i.props.brushRadius,0,Math.PI*2,!0),a.fill(),a.beginPath(),a.fillStyle=i.props.catenaryColor,a.arc(o.x,o.y,4,0,Math.PI*2,!0),a.fill(),i.lazy.isEnabled()&&(a.beginPath(),a.lineWidth=2,a.lineCap="round",a.setLineDash([2,4]),a.strokeStyle=i.props.catenaryColor,i.catenary.drawToCanvas(i.ctx.interface,s,o,i.chainLength),a.stroke()),a.beginPath(),a.fillStyle=i.props.catenaryColor,a.arc(s.x,s.y,2,0,Math.PI*2,!0),a.fill())}),i.canvas={},i.ctx={},i.catenary=new Rye.Catenary,i.points=[],i.lines=[],i.erasedLines=[],i.mouseHasMoved=!0,i.valuesChanged=!0,i.isDrawing=!1,i.isPressing=!1,i.deferRedrawOnViewChange=!1,i.interactionSM=new _s,i.coordSystem=new Zye({scaleExtents:r.zoomExtents,documentSize:{width:r.canvasWidth,height:r.canvasHeight}}),i.coordSystem.attachViewChangeListener(i.applyView.bind(ir(i))),i}var n=e.prototype;return n.componentDidMount=function(){var i=this;this.lazy=new Oye.LazyBrush({radius:this.props.lazyRadius*window.devicePixelRatio,enabled:!0,initialPoint:{x:window.innerWidth/2,y:window.innerHeight/2}}),this.chainLength=this.props.lazyRadius*window.devicePixelRatio,this.canvasObserver=new Xye(function(a,o){return i.handleCanvasResize(a,o)}),this.canvasObserver.observe(this.canvasContainer),this.drawImage(),this.loop(),window.setTimeout(function(){var a=window.innerWidth/2,o=window.innerHeight/2;i.lazy.update({x:a-i.chainLength/4,y:o},{both:!0}),i.lazy.update({x:a+i.chainLength/4,y:o},{both:!1}),i.mouseHasMoved=!0,i.valuesChanged=!0,i.clearExceptErasedLines(),i.props.saveData&&i.loadSaveData(i.props.saveData)},100),this.canvas.interface&&this.canvas.interface.addEventListener("wheel",this.handleWheel,s5e())},n.componentDidUpdate=function(i){i.lazyRadius!==this.props.lazyRadius&&(this.chainLength=this.props.lazyRadius*window.devicePixelRatio,this.lazy.setRadius(this.props.lazyRadius*window.devicePixelRatio)),i.saveData!==this.props.saveData&&this.loadSaveData(this.props.saveData),JSON.stringify(i)!==JSON.stringify(this.props)&&(this.valuesChanged=!0),this.coordSystem.scaleExtents=this.props.zoomExtents,this.props.enablePanAndZoom||this.coordSystem.resetView(),i.imgSrc!==this.props.imgSrc&&this.drawImage()},n.render=function(){var i=this;return un.createElement("div",{className:this.props.className,style:t2({display:"block",background:this.props.backgroundColor,touchAction:"none",width:this.props.canvasWidth,height:this.props.canvasHeight},this.props.style),ref:function(o){o&&(i.canvasContainer=o)}},sk.map(function(a){var o=a==="interface";return un.createElement("canvas",{key:a,ref:function(l){l&&(i.canvas[a]=l,i.ctx[a]=l.getContext("2d"),o&&(i.coordSystem.canvas=l))},style:t2({},d5e),onMouseDown:o?i.handleDrawStart:void 0,onMouseMove:o?i.handleDrawMove:void 0,onMouseUp:o?i.handleDrawEnd:void 0,onMouseOut:o?i.handleDrawEnd:void 0,onTouchStart:o?i.handleDrawStart:void 0,onTouchMove:o?i.handleDrawMove:void 0,onTouchEnd:o?i.handleDrawEnd:void 0,onTouchCancel:o?i.handleDrawEnd:void 0})}))},e})(H.PureComponent);Mr(AD,"defaultProps",{onChange:null,loadTimeOffset:5,lazyRadius:12,brushRadius:10,brushColor:"#444",catenaryColor:"#0a0302",gridColor:"rgba(150,150,150,0.17)",backgroundColor:"#FFF",hideGrid:!1,canvasWidth:400,canvasHeight:400,disabled:!1,imgSrc:"",saveData:"",immediateLoading:!1,hideInterface:!1,gridSizeX:25,gridSizeY:25,gridLineWidth:.5,hideGridX:!1,hideGridY:!1,enablePanAndZoom:!1,mouseZoomFactor:.01,zoomExtents:{min:.33,max:3},clampLinesToDocument:!1});AD.propTypes={};function h5e({open:t,title:e,imageIndex:n,onClose:r}){const i=H.useRef(null),[a,o]=H.useState("red"),[s,l]=H.useState(10),[c,f]=H.useState(1),[u,d]=H.useState({width:0,height:0});if(H.useEffect(()=>{if(!t)return;const g=()=>{try{d({width:Math.round(window.innerWidth*c),height:Math.round(window.innerHeight*c)})}catch{}};return g(),window.addEventListener("resize",g),()=>window.removeEventListener("resize",g)},[t,c]),!t)return null;const h=String(e||"DICOM").replace(/[\\/:*?"<>|]/g,"_").replace(/\s+/g,"_"),p=(n||0)+1;return j.jsxs("div",{className:"w-full h-full fixed top-0 z-[99999] left-0",children:[u.width>0&&u.height>0&&j.jsx(AD,{ref:i,canvasWidth:u.width,canvasHeight:u.height,brushRadius:s,brushColor:a,backgroundColor:"transparent",lazyRadius:0,hideGrid:!0}),j.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 p-3 bg-white/90 border border-gray-200 rounded-lg shadow-md",children:j.jsxs("div",{className:"flex items-center gap-1 flex-wrap",children:[j.jsx("span",{className:"text-sm text-gray-700",children:"画笔颜色"}),j.jsx("input",{type:"color",value:a,onChange:g=>o(g.target.value),className:"w-8 h-8 rounded border border-gray-300 cursor-pointer bg-white",title:"选择标注颜色"}),j.jsx("button",{onClick:()=>o("#ff0000"),className:"px-2 py-1 text-xs rounded bg-red-600 text-white cursor-pointer",children:"红"}),j.jsx("button",{onClick:()=>o("#00aa00"),className:"px-2 py-1 text-xs rounded bg-green-600 text-white cursor-pointer",children:"绿"}),j.jsx("button",{onClick:()=>o("#0077ff"),className:"px-2 py-1 text-xs rounded bg-blue-600 text-white cursor-pointer",children:"蓝"}),j.jsx("span",{className:"mx-2 h-5 w-px bg-gray-300"}),j.jsx("span",{className:"text-sm text-gray-700",children:"画笔粗细"}),j.jsx("button",{onClick:()=>l(g=>Math.max(1,g-1)),className:"px-2 py-1 text-xs rounded bg-gray-700 text-white cursor-pointer",children:"-"}),j.jsx("span",{className:"text-sm text-gray-800 min-w-[2ch] text-center",children:s}),j.jsx("button",{onClick:()=>l(g=>Math.min(100,g+1)),className:"px-2 py-1 text-xs rounded bg-gray-700 text-white cursor-pointer",children:"+"}),j.jsx("span",{className:"mx-2 h-5 w-px bg-gray-300"}),j.jsx("button",{onClick:()=>i.current?.undo?.(),className:"px-3 py-1 text-xs rounded bg-yellow-600 text-white cursor-pointer",children:"撤销"}),j.jsx("button",{onClick:()=>i.current?.clear?.(),className:"px-3 py-1 text-xs rounded bg-red-500 text-white cursor-pointer",children:"清空"}),j.jsx("button",{onClick:()=>{try{const g=i.current?.getDataURL?.("image/png");if(!g)return;const m=Date.now(),y=`${h}-图像${p}-${m}.png`,v=document.createElement("a");v.href=g,v.download=y,document.body.appendChild(v),v.click(),document.body.removeChild(v)}catch(g){console.warn("保存图片失败",g)}},className:"px-3 py-1 text-xs rounded bg-blue-700 text-white cursor-pointer",children:"保存图片"}),j.jsx("span",{className:"mx-2 h-5 w-px bg-gray-300"}),j.jsx("button",{onClick:()=>{try{r?.()}catch{}},className:"px-3 py-1 text-xs rounded bg-red-500 text-white cursor-pointer",title:"退出画笔",children:"退出画笔"})]})})]})}var mt;(function(t){t.ERROR_EVENT="CORNERSTONE_ERROR",t.CACHE_SIZE_EXCEEDED="CACHE_SIZE_EXCEEDED",t.IMAGE_LOAD_ERROR="IMAGE_LOAD_ERROR",t.CAMERA_MODIFIED="CORNERSTONE_CAMERA_MODIFIED",t.CAMERA_RESET="CORNERSTONE_CAMERA_RESET",t.VOI_MODIFIED="CORNERSTONE_VOI_MODIFIED",t.PRESET_MODIFIED="CORNERSTONE_VIEWPORT_RENDERING_PRESET_MODIFIED",t.DISPLAY_AREA_MODIFIED="CORNERSTONE_DISPLAY_AREA_MODIFIED",t.ELEMENT_DISABLED="CORNERSTONE_ELEMENT_DISABLED",t.ELEMENT_ENABLED="CORNERSTONE_ELEMENT_ENABLED",t.IMAGE_RENDERED="CORNERSTONE_IMAGE_RENDERED",t.IMAGE_VOLUME_MODIFIED="CORNERSTONE_IMAGE_VOLUME_MODIFIED",t.IMAGE_VOLUME_LOADING_COMPLETED="CORNERSTONE_IMAGE_VOLUME_LOADING_COMPLETED",t.IMAGE_LOADED="CORNERSTONE_IMAGE_LOADED",t.IMAGE_RETRIEVAL_STAGE="CORNERSTONE_IMAGE_RETRIEVAL_STAGE",t.IMAGE_LOAD_FAILED="CORNERSTONE_IMAGE_LOAD_FAILED",t.VOLUME_VIEWPORT_NEW_VOLUME="CORNERSTONE_VOLUME_VIEWPORT_NEW_VOLUME",t.VOLUME_LOADED="CORNERSTONE_VOLUME_LOADED",t.VOLUME_LOADED_FAILED="CORNERSTONE_VOLUME_LOADED_FAILED",t.IMAGE_CACHE_IMAGE_ADDED="CORNERSTONE_IMAGE_CACHE_IMAGE_ADDED",t.IMAGE_CACHE_IMAGE_REMOVED="CORNERSTONE_IMAGE_CACHE_IMAGE_REMOVED",t.VOLUME_CACHE_VOLUME_ADDED="CORNERSTONE_VOLUME_CACHE_VOLUME_ADDED",t.VOLUME_CACHE_VOLUME_REMOVED="CORNERSTONE_VOLUME_CACHE_VOLUME_REMOVED",t.STACK_NEW_IMAGE="CORNERSTONE_STACK_NEW_IMAGE",t.VOLUME_NEW_IMAGE="CORNERSTONE_VOLUME_NEW_IMAGE",t.PRE_STACK_NEW_IMAGE="CORNERSTONE_PRE_STACK_NEW_IMAGE",t.IMAGE_SPACING_CALIBRATED="CORNERSTONE_IMAGE_SPACING_CALIBRATED",t.VIEWPORT_NEW_IMAGE_SET="CORNERSTONE_VIEWPORT_NEW_IMAGE_SET",t.STACK_VIEWPORT_SCROLL="CORNERSTONE_STACK_VIEWPORT_SCROLL",t.STACK_SCROLL_OUT_OF_BOUNDS="STACK_SCROLL_OUT_OF_BOUNDS",t.GEOMETRY_CACHE_GEOMETRY_ADDED="CORNERSTONE_GEOMETRY_CACHE_GEOMETRY_ADDED",t.GEOMETRY_CACHE_GEOMETRY_REMOVED="CORNERSTONE_GEOMETRY_CACHE_GEOMETRY_REMOVED",t.VOLUME_VIEWPORT_SCROLL_OUT_OF_BOUNDS="VOLUME_VIEWPORT_SCROLL_OUT_OF_BOUNDS",t.VOLUME_VIEWPORT_SCROLL="VOLUME_VIEWPORT_SCROLL",t.CLIPPING_PLANES_UPDATED="CORNERSTONE_CLIPPING_PLANES_UPDATED",t.WEB_WORKER_PROGRESS="CORNERSTONE_WEB_WORKER_PROGRESS",t.COLORMAP_MODIFIED="CORNERSTONE_COLORMAP_MODIFIED",t.DYNAMIC_VOLUME_DIMENSION_GROUP_CHANGED="DYNAMIC_VOLUME_DIMENSION_GROUP_CHANGED",t.DYNAMIC_VOLUME_TIME_POINT_INDEX_CHANGED="DYNAMIC_VOLUME_TIME_POINT_INDEX_CHANGED",t.DYNAMIC_VOLUME_DIMENSION_GROUP_LOADED="DYNAMIC_VOLUME_DIMENSION_GROUP_LOADED",t.DYNAMIC_VOLUME_TIME_POINT_LOADED="DYNAMIC_VOLUME_TIME_POINT_LOADED",t.GEOMETRY_LOADED="GEOMETRY_LOADED",t.GEOMETRY_LOAD_PROGRESS="GEOMETRY_LOAD_PROGRESS",t.GEOMETRY_LOADED_FAILED="GEOMETRY_LOADED_FAILED",t.ACTORS_CHANGED="CORNERSTONE_ACTORS_CHANGED"})(mt||(mt={}));var _n;(function(t){t.Interaction="interaction",t.Thumbnail="thumbnail",t.Prefetch="prefetch",t.Compute="compute"})(_n||(_n={}));var Tr;(function(t){t.STACK="stack",t.ORTHOGRAPHIC="orthographic",t.PERSPECTIVE="perspective",t.VOLUME_3D="volume3d",t.VIDEO="video",t.WHOLE_SLIDE="wholeSlide"})(Tr||(Tr={}));var Sf;(function(t){t[t.NEAREST=0]="NEAREST",t[t.LINEAR=1]="LINEAR",t[t.FAST_LINEAR=2]="FAST_LINEAR"})(Sf||(Sf={}));const Vb={COMPOSITE_BLEND:0,MAXIMUM_INTENSITY_BLEND:1,MINIMUM_INTENSITY_BLEND:2,AVERAGE_INTENSITY_BLEND:3,ADDITIVE_INTENSITY_BLEND:4,RADON_TRANSFORM_BLEND:5,LABELMAP_EDGE_PROJECTION_BLEND:6},p5e={OFF:0,NORMALIZED:1,RAW:2};var jK={BlendMode:Vb,FilterMode:p5e};const{BlendMode:tv}=jK;var Kd;(function(t){t[t.COMPOSITE=tv.COMPOSITE_BLEND]="COMPOSITE",t[t.MAXIMUM_INTENSITY_BLEND=tv.MAXIMUM_INTENSITY_BLEND]="MAXIMUM_INTENSITY_BLEND",t[t.MINIMUM_INTENSITY_BLEND=tv.MINIMUM_INTENSITY_BLEND]="MINIMUM_INTENSITY_BLEND",t[t.AVERAGE_INTENSITY_BLEND=tv.AVERAGE_INTENSITY_BLEND]="AVERAGE_INTENSITY_BLEND",t[t.LABELMAP_EDGE_PROJECTION_BLEND=tv.LABELMAP_EDGE_PROJECTION_BLEND]="LABELMAP_EDGE_PROJECTION_BLEND"})(Kd||(Kd={}));var qd;(function(t){t.AXIAL="axial",t.CORONAL="coronal",t.SAGITTAL="sagittal",t.ACQUISITION="acquisition",t.AXIAL_REFORMAT="axial_reformat",t.CORONAL_REFORMAT="coronal_reformat",t.SAGITTAL_REFORMAT="sagittal_reformat",t.REFORMAT="reformat"})(qd||(qd={}));var lu;(function(t){t.CONTOUR="CONTOUR",t.SURFACE="SURFACE",t.MESH="MESH"})(lu||(lu={}));var l_;(function(t){t.CLOSED_PLANAR="CLOSED_PLANAR",t.OPEN_PLANAR="OPEN_PLANAR"})(l_||(l_={}));const g5e=l_;var el;(function(t){t.PLY="PLY",t.STL="STL",t.OBJ="OBJ",t.VTP="VTP"})(el||(el={}));var po;(function(t){t.LINEAR="LINEAR",t.SAMPLED_SIGMOID="SIGMOID",t.LINEAR_EXACT="LINEAR_EXACT"})(po||(po={}));var c_;(function(t){t.SUM="SUM",t.AVERAGE="AVERAGE",t.SUBTRACT="SUBTRACT"})(c_||(c_={}));const m5e=c_;var Zc;(function(t){t.NOT_APPLICABLE="",t.ERMF="ERMF",t.USER="User",t.PROJECTION="Proj",t.REGION="Region",t.ERROR="Error",t.UNCALIBRATED="Uncalibrated",t.CALIBRATED="Calibrated",t.UNKNOWN="Unknown"})(Zc||(Zc={}));var Io;(function(t){t.NO_DATA="noData",t.LOADING="loading",t.PRE_RENDER="preRender",t.RESIZE="resize",t.RENDERED="rendered"})(Io||(Io={}));var Ds;(function(t){t[t.FAR_REPLICATE=1]="FAR_REPLICATE",t[t.ADJACENT_REPLICATE=3]="ADJACENT_REPLICATE",t[t.SUBRESOLUTION=6]="SUBRESOLUTION",t[t.LOSSY=7]="LOSSY",t[t.FULL_RESOLUTION=8]="FULL_RESOLUTION"})(Ds||(Ds={}));var B2;(function(t){t.FRAME="f",t.SECOND="s"})(B2||(B2={}));const v5e=Object.freeze(Object.defineProperty({__proto__:null,get SpeedUnit(){return B2}},Symbol.toStringTag,{value:"Module"}));var ts;(function(t){t.CALIBRATION="calibrationModule",t.CINE="cineModule",t.GENERAL_IMAGE="generalImageModule",t.GENERAL_SERIES="generalSeriesModule",t.GENERAL_STUDY="generalStudyModule",t.IMAGE_PIXEL="imagePixelModule",t.IMAGE_PLANE="imagePlaneModule",t.IMAGE_URL="imageUrlModule",t.MODALITY_LUT="modalityLutModule",t.MULTIFRAME="multiframeModule",t.NM_MULTIFRAME_GEOMETRY="nmMultiframeGeometryModule",t.OVERLAY_PLANE="overlayPlaneModule",t.PATIENT="patientModule",t.PATIENT_STUDY="patientStudyModule",t.PET_IMAGE="petImageModule",t.PET_ISOTOPE="petIsotopeModule",t.PET_SERIES="petSeriesModule",t.SOP_COMMON="sopCommonModule",t.ULTRASOUND_ENHANCED_REGION="ultrasoundEnhancedRegionModule",t.VOI_LUT="voiLutModule",t.WADO_WEB_CLIENT="wadoWebClient"})(ts||(ts={}));var u_;(function(t){t.SUM="SUM",t.SUBTRACT="SUBTRACT",t.AVERAGE="AVERAGE"})(u_||(u_={}));var jw;(function(t){t.RLE="RLE",t.Volume="Volume"})(jw||(jw={}));var Ah;(function(t){t.Tiled="tiled",t.ContextPool="contextPool"})(Ah||(Ah={}));const ll=Object.freeze(Object.defineProperty({__proto__:null,BlendModes:Kd,CalibrationTypes:Zc,ContourType:g5e,DynamicOperatorType:m5e,Events:mt,get GenerateImageType(){return u_},GeometryType:lu,ImageQualityStatus:Ds,InterpolationType:Sf,MeshType:el,MetadataModules:ts,OrientationAxis:qd,RenderingEngineModeEnum:Ah,RequestType:_n,VOILUTFunctionType:po,VideoEnums:v5e,ViewportStatus:Io,ViewportType:Tr,VoxelManagerEnum:jw},Symbol.toStringTag,{value:"Module"})),f_={hotIron:{name:"Hot Iron",numOfColors:256,colors:[[0,0,0,255],[2,0,0,255],[4,0,0,255],[6,0,0,255],[8,0,0,255],[10,0,0,255],[12,0,0,255],[14,0,0,255],[16,0,0,255],[18,0,0,255],[20,0,0,255],[22,0,0,255],[24,0,0,255],[26,0,0,255],[28,0,0,255],[30,0,0,255],[32,0,0,255],[34,0,0,255],[36,0,0,255],[38,0,0,255],[40,0,0,255],[42,0,0,255],[44,0,0,255],[46,0,0,255],[48,0,0,255],[50,0,0,255],[52,0,0,255],[54,0,0,255],[56,0,0,255],[58,0,0,255],[60,0,0,255],[62,0,0,255],[64,0,0,255],[66,0,0,255],[68,0,0,255],[70,0,0,255],[72,0,0,255],[74,0,0,255],[76,0,0,255],[78,0,0,255],[80,0,0,255],[82,0,0,255],[84,0,0,255],[86,0,0,255],[88,0,0,255],[90,0,0,255],[92,0,0,255],[94,0,0,255],[96,0,0,255],[98,0,0,255],[100,0,0,255],[102,0,0,255],[104,0,0,255],[106,0,0,255],[108,0,0,255],[110,0,0,255],[112,0,0,255],[114,0,0,255],[116,0,0,255],[118,0,0,255],[120,0,0,255],[122,0,0,255],[124,0,0,255],[126,0,0,255],[128,0,0,255],[130,0,0,255],[132,0,0,255],[134,0,0,255],[136,0,0,255],[138,0,0,255],[140,0,0,255],[142,0,0,255],[144,0,0,255],[146,0,0,255],[148,0,0,255],[150,0,0,255],[152,0,0,255],[154,0,0,255],[156,0,0,255],[158,0,0,255],[160,0,0,255],[162,0,0,255],[164,0,0,255],[166,0,0,255],[168,0,0,255],[170,0,0,255],[172,0,0,255],[174,0,0,255],[176,0,0,255],[178,0,0,255],[180,0,0,255],[182,0,0,255],[184,0,0,255],[186,0,0,255],[188,0,0,255],[190,0,0,255],[192,0,0,255],[194,0,0,255],[196,0,0,255],[198,0,0,255],[200,0,0,255],[202,0,0,255],[204,0,0,255],[206,0,0,255],[208,0,0,255],[210,0,0,255],[212,0,0,255],[214,0,0,255],[216,0,0,255],[218,0,0,255],[220,0,0,255],[222,0,0,255],[224,0,0,255],[226,0,0,255],[228,0,0,255],[230,0,0,255],[232,0,0,255],[234,0,0,255],[236,0,0,255],[238,0,0,255],[240,0,0,255],[242,0,0,255],[244,0,0,255],[246,0,0,255],[248,0,0,255],[250,0,0,255],[252,0,0,255],[254,0,0,255],[255,0,0,255],[255,2,0,255],[255,4,0,255],[255,6,0,255],[255,8,0,255],[255,10,0,255],[255,12,0,255],[255,14,0,255],[255,16,0,255],[255,18,0,255],[255,20,0,255],[255,22,0,255],[255,24,0,255],[255,26,0,255],[255,28,0,255],[255,30,0,255],[255,32,0,255],[255,34,0,255],[255,36,0,255],[255,38,0,255],[255,40,0,255],[255,42,0,255],[255,44,0,255],[255,46,0,255],[255,48,0,255],[255,50,0,255],[255,52,0,255],[255,54,0,255],[255,56,0,255],[255,58,0,255],[255,60,0,255],[255,62,0,255],[255,64,0,255],[255,66,0,255],[255,68,0,255],[255,70,0,255],[255,72,0,255],[255,74,0,255],[255,76,0,255],[255,78,0,255],[255,80,0,255],[255,82,0,255],[255,84,0,255],[255,86,0,255],[255,88,0,255],[255,90,0,255],[255,92,0,255],[255,94,0,255],[255,96,0,255],[255,98,0,255],[255,100,0,255],[255,102,0,255],[255,104,0,255],[255,106,0,255],[255,108,0,255],[255,110,0,255],[255,112,0,255],[255,114,0,255],[255,116,0,255],[255,118,0,255],[255,120,0,255],[255,122,0,255],[255,124,0,255],[255,126,0,255],[255,128,4,255],[255,130,8,255],[255,132,12,255],[255,134,16,255],[255,136,20,255],[255,138,24,255],[255,140,28,255],[255,142,32,255],[255,144,36,255],[255,146,40,255],[255,148,44,255],[255,150,48,255],[255,152,52,255],[255,154,56,255],[255,156,60,255],[255,158,64,255],[255,160,68,255],[255,162,72,255],[255,164,76,255],[255,166,80,255],[255,168,84,255],[255,170,88,255],[255,172,92,255],[255,174,96,255],[255,176,100,255],[255,178,104,255],[255,180,108,255],[255,182,112,255],[255,184,116,255],[255,186,120,255],[255,188,124,255],[255,190,128,255],[255,192,132,255],[255,194,136,255],[255,196,140,255],[255,198,144,255],[255,200,148,255],[255,202,152,255],[255,204,156,255],[255,206,160,255],[255,208,164,255],[255,210,168,255],[255,212,172,255],[255,214,176,255],[255,216,180,255],[255,218,184,255],[255,220,188,255],[255,222,192,255],[255,224,196,255],[255,226,200,255],[255,228,204,255],[255,230,208,255],[255,232,212,255],[255,234,216,255],[255,236,220,255],[255,238,224,255],[255,240,228,255],[255,242,232,255],[255,244,236,255],[255,246,240,255],[255,248,244,255],[255,250,248,255],[255,252,252,255],[255,255,255,255]]},pet:{name:"PET",numColors:256,colors:[[0,0,0,255],[0,2,1,255],[0,4,3,255],[0,6,5,255],[0,8,7,255],[0,10,9,255],[0,12,11,255],[0,14,13,255],[0,16,15,255],[0,18,17,255],[0,20,19,255],[0,22,21,255],[0,24,23,255],[0,26,25,255],[0,28,27,255],[0,30,29,255],[0,32,31,255],[0,34,33,255],[0,36,35,255],[0,38,37,255],[0,40,39,255],[0,42,41,255],[0,44,43,255],[0,46,45,255],[0,48,47,255],[0,50,49,255],[0,52,51,255],[0,54,53,255],[0,56,55,255],[0,58,57,255],[0,60,59,255],[0,62,61,255],[0,65,63,255],[0,67,65,255],[0,69,67,255],[0,71,69,255],[0,73,71,255],[0,75,73,255],[0,77,75,255],[0,79,77,255],[0,81,79,255],[0,83,81,255],[0,85,83,255],[0,87,85,255],[0,89,87,255],[0,91,89,255],[0,93,91,255],[0,95,93,255],[0,97,95,255],[0,99,97,255],[0,101,99,255],[0,103,101,255],[0,105,103,255],[0,107,105,255],[0,109,107,255],[0,111,109,255],[0,113,111,255],[0,115,113,255],[0,117,115,255],[0,119,117,255],[0,121,119,255],[0,123,121,255],[0,125,123,255],[0,128,125,255],[1,126,127,255],[3,124,129,255],[5,122,131,255],[7,120,133,255],[9,118,135,255],[11,116,137,255],[13,114,139,255],[15,112,141,255],[17,110,143,255],[19,108,145,255],[21,106,147,255],[23,104,149,255],[25,102,151,255],[27,100,153,255],[29,98,155,255],[31,96,157,255],[33,94,159,255],[35,92,161,255],[37,90,163,255],[39,88,165,255],[41,86,167,255],[43,84,169,255],[45,82,171,255],[47,80,173,255],[49,78,175,255],[51,76,177,255],[53,74,179,255],[55,72,181,255],[57,70,183,255],[59,68,185,255],[61,66,187,255],[63,64,189,255],[65,63,191,255],[67,61,193,255],[69,59,195,255],[71,57,197,255],[73,55,199,255],[75,53,201,255],[77,51,203,255],[79,49,205,255],[81,47,207,255],[83,45,209,255],[85,43,211,255],[86,41,213,255],[88,39,215,255],[90,37,217,255],[92,35,219,255],[94,33,221,255],[96,31,223,255],[98,29,225,255],[100,27,227,255],[102,25,229,255],[104,23,231,255],[106,21,233,255],[108,19,235,255],[110,17,237,255],[112,15,239,255],[114,13,241,255],[116,11,243,255],[118,9,245,255],[120,7,247,255],[122,5,249,255],[124,3,251,255],[126,1,253,255],[128,0,255,255],[130,2,252,255],[132,4,248,255],[134,6,244,255],[136,8,240,255],[138,10,236,255],[140,12,232,255],[142,14,228,255],[144,16,224,255],[146,18,220,255],[148,20,216,255],[150,22,212,255],[152,24,208,255],[154,26,204,255],[156,28,200,255],[158,30,196,255],[160,32,192,255],[162,34,188,255],[164,36,184,255],[166,38,180,255],[168,40,176,255],[170,42,172,255],[171,44,168,255],[173,46,164,255],[175,48,160,255],[177,50,156,255],[179,52,152,255],[181,54,148,255],[183,56,144,255],[185,58,140,255],[187,60,136,255],[189,62,132,255],[191,64,128,255],[193,66,124,255],[195,68,120,255],[197,70,116,255],[199,72,112,255],[201,74,108,255],[203,76,104,255],[205,78,100,255],[207,80,96,255],[209,82,92,255],[211,84,88,255],[213,86,84,255],[215,88,80,255],[217,90,76,255],[219,92,72,255],[221,94,68,255],[223,96,64,255],[225,98,60,255],[227,100,56,255],[229,102,52,255],[231,104,48,255],[233,106,44,255],[235,108,40,255],[237,110,36,255],[239,112,32,255],[241,114,28,255],[243,116,24,255],[245,118,20,255],[247,120,16,255],[249,122,12,255],[251,124,8,255],[253,126,4,255],[255,128,0,255],[255,130,4,255],[255,132,8,255],[255,134,12,255],[255,136,16,255],[255,138,20,255],[255,140,24,255],[255,142,28,255],[255,144,32,255],[255,146,36,255],[255,148,40,255],[255,150,44,255],[255,152,48,255],[255,154,52,255],[255,156,56,255],[255,158,60,255],[255,160,64,255],[255,162,68,255],[255,164,72,255],[255,166,76,255],[255,168,80,255],[255,170,85,255],[255,172,89,255],[255,174,93,255],[255,176,97,255],[255,178,101,255],[255,180,105,255],[255,182,109,255],[255,184,113,255],[255,186,117,255],[255,188,121,255],[255,190,125,255],[255,192,129,255],[255,194,133,255],[255,196,137,255],[255,198,141,255],[255,200,145,255],[255,202,149,255],[255,204,153,255],[255,206,157,255],[255,208,161,255],[255,210,165,255],[255,212,170,255],[255,214,174,255],[255,216,178,255],[255,218,182,255],[255,220,186,255],[255,222,190,255],[255,224,194,255],[255,226,198,255],[255,228,202,255],[255,230,206,255],[255,232,210,255],[255,234,214,255],[255,236,218,255],[255,238,222,255],[255,240,226,255],[255,242,230,255],[255,244,234,255],[255,246,238,255],[255,248,242,255],[255,250,246,255],[255,252,250,255],[255,255,255,255]]},hotMetalBlue:{name:"Hot Metal Blue",numColors:256,colors:[[0,0,0,255],[0,0,2,255],[0,0,4,255],[0,0,6,255],[0,0,8,255],[0,0,10,255],[0,0,12,255],[0,0,14,255],[0,0,16,255],[0,0,17,255],[0,0,19,255],[0,0,21,255],[0,0,23,255],[0,0,25,255],[0,0,27,255],[0,0,29,255],[0,0,31,255],[0,0,33,255],[0,0,35,255],[0,0,37,255],[0,0,39,255],[0,0,41,255],[0,0,43,255],[0,0,45,255],[0,0,47,255],[0,0,49,255],[0,0,51,255],[0,0,53,255],[0,0,55,255],[0,0,57,255],[0,0,59,255],[0,0,61,255],[0,0,63,255],[0,0,65,255],[0,0,67,255],[0,0,69,255],[0,0,71,255],[0,0,73,255],[0,0,75,255],[0,0,77,255],[0,0,79,255],[0,0,81,255],[0,0,83,255],[0,0,84,255],[0,0,86,255],[0,0,88,255],[0,0,90,255],[0,0,92,255],[0,0,94,255],[0,0,96,255],[0,0,98,255],[0,0,100,255],[0,0,102,255],[0,0,104,255],[0,0,106,255],[0,0,108,255],[0,0,110,255],[0,0,112,255],[0,0,114,255],[0,0,116,255],[0,0,117,255],[0,0,119,255],[0,0,121,255],[0,0,123,255],[0,0,125,255],[0,0,127,255],[0,0,129,255],[0,0,131,255],[0,0,133,255],[0,0,135,255],[0,0,137,255],[0,0,139,255],[0,0,141,255],[0,0,143,255],[0,0,145,255],[0,0,147,255],[0,0,149,255],[0,0,151,255],[0,0,153,255],[0,0,155,255],[0,0,157,255],[0,0,159,255],[0,0,161,255],[0,0,163,255],[0,0,165,255],[0,0,167,255],[3,0,169,255],[6,0,171,255],[9,0,173,255],[12,0,175,255],[15,0,177,255],[18,0,179,255],[21,0,181,255],[24,0,183,255],[26,0,184,255],[29,0,186,255],[32,0,188,255],[35,0,190,255],[38,0,192,255],[41,0,194,255],[44,0,196,255],[47,0,198,255],[50,0,200,255],[52,0,197,255],[55,0,194,255],[57,0,191,255],[59,0,188,255],[62,0,185,255],[64,0,182,255],[66,0,179,255],[69,0,176,255],[71,0,174,255],[74,0,171,255],[76,0,168,255],[78,0,165,255],[81,0,162,255],[83,0,159,255],[85,0,156,255],[88,0,153,255],[90,0,150,255],[93,2,144,255],[96,4,138,255],[99,6,132,255],[102,8,126,255],[105,9,121,255],[108,11,115,255],[111,13,109,255],[114,15,103,255],[116,17,97,255],[119,19,91,255],[122,21,85,255],[125,23,79,255],[128,24,74,255],[131,26,68,255],[134,28,62,255],[137,30,56,255],[140,32,50,255],[143,34,47,255],[146,36,44,255],[149,38,41,255],[152,40,38,255],[155,41,35,255],[158,43,32,255],[161,45,29,255],[164,47,26,255],[166,49,24,255],[169,51,21,255],[172,53,18,255],[175,55,15,255],[178,56,12,255],[181,58,9,255],[184,60,6,255],[187,62,3,255],[190,64,0,255],[194,66,0,255],[198,68,0,255],[201,70,0,255],[205,72,0,255],[209,73,0,255],[213,75,0,255],[217,77,0,255],[221,79,0,255],[224,81,0,255],[228,83,0,255],[232,85,0,255],[236,87,0,255],[240,88,0,255],[244,90,0,255],[247,92,0,255],[251,94,0,255],[255,96,0,255],[255,98,3,255],[255,100,6,255],[255,102,9,255],[255,104,12,255],[255,105,15,255],[255,107,18,255],[255,109,21,255],[255,111,24,255],[255,113,26,255],[255,115,29,255],[255,117,32,255],[255,119,35,255],[255,120,38,255],[255,122,41,255],[255,124,44,255],[255,126,47,255],[255,128,50,255],[255,130,53,255],[255,132,56,255],[255,134,59,255],[255,136,62,255],[255,137,65,255],[255,139,68,255],[255,141,71,255],[255,143,74,255],[255,145,76,255],[255,147,79,255],[255,149,82,255],[255,151,85,255],[255,152,88,255],[255,154,91,255],[255,156,94,255],[255,158,97,255],[255,160,100,255],[255,162,103,255],[255,164,106,255],[255,166,109,255],[255,168,112,255],[255,169,115,255],[255,171,118,255],[255,173,121,255],[255,175,124,255],[255,177,126,255],[255,179,129,255],[255,181,132,255],[255,183,135,255],[255,184,138,255],[255,186,141,255],[255,188,144,255],[255,190,147,255],[255,192,150,255],[255,194,153,255],[255,196,156,255],[255,198,159,255],[255,200,162,255],[255,201,165,255],[255,203,168,255],[255,205,171,255],[255,207,174,255],[255,209,176,255],[255,211,179,255],[255,213,182,255],[255,215,185,255],[255,216,188,255],[255,218,191,255],[255,220,194,255],[255,222,197,255],[255,224,200,255],[255,226,203,255],[255,228,206,255],[255,229,210,255],[255,231,213,255],[255,233,216,255],[255,235,219,255],[255,237,223,255],[255,239,226,255],[255,240,229,255],[255,242,232,255],[255,244,236,255],[255,246,239,255],[255,248,242,255],[255,250,245,255],[255,251,249,255],[255,253,252,255],[255,255,255,255]]},pet20Step:{name:"PET 20 Step",numColors:256,colors:[[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255]]},gray:{name:"Gray",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[1,1,1]],green:[[0,0,0],[1,1,1]],blue:[[0,0,0],[1,1,1]]}},jet:{name:"Jet",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[.35,0,0],[.66,1,1],[.89,1,1],[1,.5,.5]],green:[[0,0,0],[.125,0,0],[.375,1,1],[.64,1,1],[.91,0,0],[1,0,0]],blue:[[0,.5,.5],[.11,1,1],[.34,1,1],[.65,0,0],[1,0,0]]}},hsv:{name:"HSV",numColors:256,gamma:1,segmentedData:{red:[[0,1,1],[.15873,1,1],[.174603,.96875,.96875],[.333333,.03125,.03125],[.349206,0,0],[.666667,0,0],[.68254,.03125,.03125],[.84127,.96875,.96875],[.857143,1,1],[1,1,1]],green:[[0,0,0],[.15873,.9375,.9375],[.174603,1,1],[.507937,1,1],[.666667,.0625,.0625],[.68254,0,0],[1,0,0]],blue:[[0,0,0],[.333333,0,0],[.349206,.0625,.0625],[.507937,1,1],[.84127,1,1],[.857143,.9375,.9375],[1,.09375,.09375]]}},hot:{name:"Hot",numColors:256,gamma:1,segmentedData:{red:[[0,.0416,.0416],[.365079,1,1],[1,1,1]],green:[[0,0,0],[.365079,0,0],[.746032,1,1],[1,1,1]],blue:[[0,0,0],[.746032,0,0],[1,1,1]]}},cool:{name:"Cool",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[1,1,1]],green:[[0,1,1],[1,0,0]],blue:[[0,1,1],[1,1,1]]}},spring:{name:"Spring",numColors:256,gamma:1,segmentedData:{red:[[0,1,1],[1,1,1]],green:[[0,0,0],[1,1,1]],blue:[[0,1,1],[1,0,0]]}},summer:{name:"Summer",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[1,1,1]],green:[[0,.5,.5],[1,1,1]],blue:[[0,.4,.4],[1,.4,.4]]}},autumn:{name:"Autumn",numColors:256,gamma:1,segmentedData:{red:[[0,1,1],[1,1,1]],green:[[0,0,0],[1,1,1]],blue:[[0,0,0],[1,0,0]]}},winter:{name:"Winter",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[1,0,0]],green:[[0,0,0],[1,1,1]],blue:[[0,1,1],[1,.5,.5]]}},bone:{name:"Bone",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[.746032,.652778,.652778],[1,1,1]],green:[[0,0,0],[.365079,.319444,.319444],[.746032,.777778,.777778],[1,1,1]],blue:[[0,0,0],[.365079,.444444,.444444],[1,1,1]]}},copper:{name:"Copper",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[.809524,1,1],[1,1,1]],green:[[0,0,0],[1,.7812,.7812]],blue:[[0,0,0],[1,.4975,.4975]]}},spectral:{name:"Spectral",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[.05,.4667,.4667],[.1,.5333,.5333],[.15,0,0],[.2,0,0],[.25,0,0],[.3,0,0],[.35,0,0],[.4,0,0],[.45,0,0],[.5,0,0],[.55,0,0],[.6,0,0],[.65,.7333,.7333],[.7,.9333,.9333],[.75,1,1],[.8,1,1],[.85,1,1],[.9,.8667,.8667],[.95,.8,.8],[1,.8,.8]],green:[[0,0,0],[.05,0,0],[.1,0,0],[.15,0,0],[.2,0,0],[.25,.4667,.4667],[.3,.6,.6],[.35,.6667,.6667],[.4,.6667,.6667],[.45,.6,.6],[.5,.7333,.7333],[.55,.8667,.8667],[.6,1,1],[.65,1,1],[.7,.9333,.9333],[.75,.8,.8],[.8,.6,.6],[.85,0,0],[.9,0,0],[.95,0,0],[1,.8,.8]],blue:[[0,0,0],[.05,.5333,.5333],[.1,.6,.6],[.15,.6667,.6667],[.2,.8667,.8667],[.25,.8667,.8667],[.3,.8667,.8667],[.35,.6667,.6667],[.4,.5333,.5333],[.45,0,0],[.5,0,0],[.55,0,0],[.6,0,0],[.65,0,0],[.7,0,0],[.75,0,0],[.8,0,0],[.85,0,0],[.9,0,0],[.95,0,0],[1,.8,.8]]}},coolwarm:{name:"CoolWarm",numColors:256,gamma:1,segmentedData:{red:[[0,.2298057,.2298057],[.03125,.26623388,.26623388],[.0625,.30386891,.30386891],[.09375,.342804478,.342804478],[.125,.38301334,.38301334],[.15625,.424369608,.424369608],[.1875,.46666708,.46666708],[.21875,.509635204,.509635204],[.25,.552953156,.552953156],[.28125,.596262162,.596262162],[.3125,.639176211,.639176211],[.34375,.681291281,.681291281],[.375,.722193294,.722193294],[.40625,.761464949,.761464949],[.4375,.798691636,.798691636],[.46875,.833466556,.833466556],[.5,.865395197,.865395197],[.53125,.897787179,.897787179],[.5625,.924127593,.924127593],[.59375,.944468518,.944468518],[.625,.958852946,.958852946],[.65625,.96732803,.96732803],[.6875,.969954137,.969954137],[.71875,.966811177,.966811177],[.75,.958003065,.958003065],[.78125,.943660866,.943660866],[.8125,.923944917,.923944917],[.84375,.89904617,.89904617],[.875,.869186849,.869186849],[.90625,.834620542,.834620542],[.9375,.795631745,.795631745],[.96875,.752534934,.752534934],[1,.705673158,.705673158]],green:[[0,.298717966,.298717966],[.03125,.353094838,.353094838],[.0625,.406535296,.406535296],[.09375,.458757618,.458757618],[.125,.50941904,.50941904],[.15625,.558148092,.558148092],[.1875,.604562568,.604562568],[.21875,.648280772,.648280772],[.25,.688929332,.688929332],[.28125,.726149107,.726149107],[.3125,.759599947,.759599947],[.34375,.788964712,.788964712],[.375,.813952739,.813952739],[.40625,.834302879,.834302879],[.4375,.849786142,.849786142],[.46875,.860207984,.860207984],[.5,.86541021,.86541021],[.53125,.848937047,.848937047],[.5625,.827384882,.827384882],[.59375,.800927443,.800927443],[.625,.769767752,.769767752],[.65625,.734132809,.734132809],[.6875,.694266682,.694266682],[.71875,.650421156,.650421156],[.75,.602842431,.602842431],[.78125,.551750968,.551750968],[.8125,.49730856,.49730856],[.84375,.439559467,.439559467],[.875,.378313092,.378313092],[.90625,.312874446,.312874446],[.9375,.24128379,.24128379],[.96875,.157246067,.157246067],[1,.01555616,.01555616]],blue:[[0,.753683153,.753683153],[.03125,.801466763,.801466763],[.0625,.84495867,.84495867],[.09375,.883725899,.883725899],[.125,.917387822,.917387822],[.15625,.945619588,.945619588],[.1875,.968154911,.968154911],[.21875,.98478814,.98478814],[.25,.995375608,.995375608],[.28125,.999836203,.999836203],[.3125,.998151185,.998151185],[.34375,.990363227,.990363227],[.375,.976574709,.976574709],[.40625,.956945269,.956945269],[.4375,.931688648,.931688648],[.46875,.901068838,.901068838],[.5,.865395561,.865395561],[.53125,.820880546,.820880546],[.5625,.774508472,.774508472],[.59375,.726736146,.726736146],[.625,.678007945,.678007945],[.65625,.628751763,.628751763],[.6875,.579375448,.579375448],[.71875,.530263762,.530263762],[.75,.481775914,.481775914],[.78125,.434243684,.434243684],[.8125,.387970225,.387970225],[.84375,.343229596,.343229596],[.875,.300267182,.300267182],[.90625,.259301199,.259301199],[.9375,.220525627,.220525627],[.96875,.184115123,.184115123],[1,.150232812,.150232812]]}},blues:{name:"Blues",numColors:256,gamma:1,segmentedData:{red:[[0,.9686274528503418,.9686274528503418],[.125,.8705882430076599,.8705882430076599],[.25,.7764706015586853,.7764706015586853],[.375,.6196078658103943,.6196078658103943],[.5,.41960784792900085,.41960784792900085],[.625,.25882354378700256,.25882354378700256],[.75,.12941177189350128,.12941177189350128],[.875,.0313725508749485,.0313725508749485],[1,.0313725508749485,.0313725508749485]],green:[[0,.9843137264251709,.9843137264251709],[.125,.9215686321258545,.9215686321258545],[.25,.8588235378265381,.8588235378265381],[.375,.7921568751335144,.7921568751335144],[.5,.6823529601097107,.6823529601097107],[.625,.572549045085907,.572549045085907],[.75,.4431372582912445,.4431372582912445],[.875,.3176470696926117,.3176470696926117],[1,.1882352977991104,.1882352977991104]],blue:[[0,1,1],[.125,.9686274528503418,.9686274528503418],[.25,.9372549057006836,.9372549057006836],[.375,.8823529481887817,.8823529481887817],[.5,.8392156958580017,.8392156958580017],[.625,.7764706015586853,.7764706015586853],[.75,.7098039388656616,.7098039388656616],[.875,.6117647290229797,.6117647290229797],[1,.41960784792900085,.41960784792900085]]}}},Oi={MINIMUM_SLAB_THICKNESS:.05,MAXIMUM_RAY_DISTANCE:1e6};Object.freeze(Oi);const al=.001;function zK(t){const e=Object.getOwnPropertyNames(t);for(const n of e){const r=t[n];r&&typeof r=="object"&&zK(r)}return Object.freeze(t)}const y5e={axial:{viewPlaneNormal:[0,0,-1],viewUp:[0,-1,0],viewRight:[1,0,0]},sagittal:{viewPlaneNormal:[1,0,0],viewUp:[0,0,1],viewRight:[0,1,0]},coronal:{viewPlaneNormal:[0,-1,0],viewUp:[0,0,1],viewRight:[1,0,0]}},Tf=zK(y5e),WK=[{name:"CT-AAA",gradientOpacity:"4 0 1 255 1",specularPower:"10",scalarOpacity:"12 -3024 0 143.556 0 166.222 0.686275 214.389 0.696078 419.736 0.833333 3071 0.803922",specular:"0.2",shade:"1",ambient:"0.1",colorTransfer:"24 -3024 0 0 0 143.556 0.615686 0.356863 0.184314 166.222 0.882353 0.603922 0.290196 214.389 1 1 1 419.736 1 0.937033 0.954531 3071 0.827451 0.658824 1",diffuse:"0.9",interpolation:"1"},{name:"CT-AAA2",gradientOpacity:"4 0 1 255 1",specularPower:"10",scalarOpacity:"16 -3024 0 129.542 0 145.244 0.166667 157.02 0.5 169.918 0.627451 395.575 0.8125 1578.73 0.8125 3071 0.8125",specular:"0.2",shade:"1",ambient:"0.1",colorTransfer:"32 -3024 0 0 0 129.542 0.54902 0.25098 0.14902 145.244 0.6 0.627451 0.843137 157.02 0.890196 0.47451 0.6 169.918 0.992157 0.870588 0.392157 395.575 1 0.886275 0.658824 1578.73 1 0.829256 0.957922 3071 0.827451 0.658824 1",diffuse:"0.9",interpolation:"1"},{name:"CT-Bone",gradientOpacity:"4 0 1 255 1",specularPower:"10",scalarOpacity:"8 -3024 0 -16.4458 0 641.385 0.715686 3071 0.705882",specular:"0.2",shade:"1",ambient:"0.1",colorTransfer:"16 -3024 0 0 0 -16.4458 0.729412 0.254902 0.301961 641.385 0.905882 0.815686 0.552941 3071 1 1 1",diffuse:"0.9",interpolation:"1"},{name:"CT-Bones",gradientOpacity:"4 0 1 985.12 1",specularPower:"1",scalarOpacity:"8 -1000 0 152.19 0 278.93 0.190476 952 0.2",specular:"0",shade:"1",ambient:"0.2",colorTransfer:"20 -1000 0.3 0.3 1 -488 0.3 1 0.3 463.28 1 0 0 659.15 1 0.912535 0.0374849 953 1 0.3 0.3",diffuse:"1",interpolation:"1"},{name:"CT-Cardiac",gradientOpacity:"4 0 1 255 1",specularPower:"10",scalarOpacity:"12 -3024 0 -77.6875 0 94.9518 0.285714 179.052 0.553571 260.439 0.848214 3071 0.875",specular:"0.2",shade:"1",ambient:"0.1",colorTransfer:"24 -3024 0 0 0 -77.6875 0.54902 0.25098 0.14902 94.9518 0.882353 0.603922 0.290196 179.052 1 0.937033 0.954531 260.439 0.615686 0 0 3071 0.827451 0.658824 1",diffuse:"0.9",interpolation:"1"},{name:"CT-Cardiac2",gradientOpacity:"4 0 1 255 1",specularPower:"10",scalarOpacity:"12 -3024 0 42.8964 0 163.488 0.428571 277.642 0.776786 1587 0.754902 3071 0.754902",specular:"0.2",shade:"1",ambient:"0.1",colorTransfer:"24 -3024 0 0 0 42.8964 0.54902 0.25098 0.14902 163.488 0.917647 0.639216 0.0588235 277.642 1 0.878431 0.623529 1587 1 1 1 3071 0.827451 0.658824 1",diffuse:"0.9",interpolation:"1"},{name:"CT-Cardiac3",gradientOpacity:"4 0 1 255 1",specularPower:"10",scalarOpacity:"14 -3024 0 -86.9767 0 45.3791 0.169643 139.919 0.589286 347.907 0.607143 1224.16 0.607143 3071 0.616071",specular:"0.2",shade:"1",ambient:"0.1",colorTransfer:"28 -3024 0 0 0 -86.9767 0 0.25098 1 45.3791 1 0 0 139.919 1 0.894893 0.894893 347.907 1 1 0.25098 1224.16 1 1 1 3071 0.827451 0.658824 1",diffuse:"0.9",interpolation:"1"},{name:"CT-Chest-Contrast-Enhanced",gradientOpacity:"4 0 1 255 1",specularPower:"10",scalarOpacity:"10 -3024 0 67.0106 0 251.105 0.446429 439.291 0.625 3071 0.616071",specular:"0.2",shade:"1",ambient:"0.1",colorTransfer:"20 -3024 0 0 0 67.0106 0.54902 0.25098 0.14902 251.105 0.882353 0.603922 0.290196 439.291 1 0.937033 0.954531 3071 0.827451 0.658824 1",diffuse:"0.9",interpolation:"1"},{name:"CT-Chest-Vessels",gradientOpacity:"4 0 1 255 1",specularPower:"1",scalarOpacity:"10 -3024 0 -1278.35 0 22.8277 0.428571 439.291 0.625 3071 0.616071",specular:"0",shade:"1",ambient:"0.2",colorTransfer:"20 -3024 0 0 0 -1278.35 0.54902 0.25098 0.14902 22.8277 0.882353 0.603922 0.290196 439.291 1 0.937033 0.954531 3071 0.827451 0.658824 1",diffuse:"1",interpolation:"1"},{name:"CT-Coronary-Arteries",gradientOpacity:"4 0 1 255 1",specularPower:"1",scalarOpacity:"12 -2048 0 136.47 0 159.215 0.258929 318.43 0.571429 478.693 0.776786 3661 1",specular:"0",shade:"0",ambient:"0.2",colorTransfer:"24 -2048 0 0 0 136.47 0 0 0 159.215 0.159804 0.159804 0.159804 318.43 0.764706 0.764706 0.764706 478.693 1 1 1 3661 1 1 1",diffuse:"1",interpolation:"1"},{name:"CT-Coronary-Arteries-2",gradientOpacity:"4 0 1 255 1",specularPower:"1",scalarOpacity:"14 -2048 0 142.677 0 145.016 0.116071 192.174 0.5625 217.24 0.776786 384.347 0.830357 3661 0.830357",specular:"0",shade:"1",ambient:"0.2",colorTransfer:"28 -2048 0 0 0 142.677 0 0 0 145.016 0.615686 0 0.0156863 192.174 0.909804 0.454902 0 217.24 0.972549 0.807843 0.611765 384.347 0.909804 0.909804 1 3661 1 1 1",diffuse:"1",interpolation:"1"},{name:"CT-Coronary-Arteries-3",gradientOpacity:"4 0 1 255 1",specularPower:"10",scalarOpacity:"14 -2048 0 128.643 0 129.982 0.0982143 173.636 0.669643 255.884 0.857143 584.878 0.866071 3661 1",specular:"0.2",shade:"1",ambient:"0.1",colorTransfer:"28 -2048 0 0 0 128.643 0 0 0 129.982 0.615686 0 0.0156863 173.636 0.909804 0.454902 0 255.884 0.886275 0.886275 0.886275 584.878 0.968627 0.968627 0.968627 3661 1 1 1",diffuse:"0.9",interpolation:"1"},{name:"CT-Cropped-Volume-Bone",gradientOpacity:"4 0 1 255 1",specularPower:"1",scalarOpacity:"10 -2048 0 -451 0 -450 1 1050 1 3661 1",specular:"0",shade:"0",ambient:"0.2",colorTransfer:"20 -2048 0 0 0 -451 0 0 0 -450 0.0556356 0.0556356 0.0556356 1050 1 1 1 3661 1 1 1",diffuse:"1",interpolation:"1"},{name:"CT-Fat",gradientOpacity:"6 0 1 985.12 1 988 1",specularPower:"1",scalarOpacity:"14 -1000 0 -100 0 -99 0.15 -60 0.15 -59 0 101.2 0 952 0",specular:"0",shade:"0",ambient:"0.2",colorTransfer:"36 -1000 0.3 0.3 1 -497.5 0.3 1 0.3 -99 0 0 1 -76.946 0 1 0 -65.481 0.835431 0.888889 0.0165387 83.89 1 0 0 463.28 1 0 0 659.15 1 0.912535 0.0374849 2952 1 0.300267 0.299886",diffuse:"1",interpolation:"1"},{name:"CT-Liver-Vasculature",gradientOpacity:"4 0 1 255 1",specularPower:"1",scalarOpacity:"14 -2048 0 149.113 0 157.884 0.482143 339.96 0.660714 388.526 0.830357 1197.95 0.839286 3661 0.848214",specular:"0",shade:"0",ambient:"0.2",colorTransfer:"28 -2048 0 0 0 149.113 0 0 0 157.884 0.501961 0.25098 0 339.96 0.695386 0.59603 0.36886 388.526 0.854902 0.85098 0.827451 1197.95 1 1 1 3661 1 1 1",diffuse:"1",interpolation:"1"},{name:"CT-Lung",gradientOpacity:"6 0 1 985.12 1 988 1",specularPower:"1",scalarOpacity:"12 -1000 0 -600 0 -599 0.15 -400 0.15 -399 0 2952 0",specular:"0",shade:"1",ambient:"0.2",colorTransfer:"24 -1000 0.3 0.3 1 -600 0 0 1 -530 0.134704 0.781726 0.0724558 -460 0.929244 1 0.109473 -400 0.888889 0.254949 0.0240258 2952 1 0.3 0.3",diffuse:"1",interpolation:"1"},{name:"CT-MIP",gradientOpacity:"4 0 1 255 1",specularPower:"10",scalarOpacity:"8 -3024 0 -637.62 0 700 1 3071 1",specular:"0.2",shade:"1",ambient:"0.1",colorTransfer:"16 -3024 0 0 0 -637.62 1 1 1 700 1 1 1 3071 1 1 1",diffuse:"0.9",interpolation:"1"},{name:"CT-Muscle",gradientOpacity:"4 0 1 255 1",specularPower:"10",scalarOpacity:"10 -3024 0 -155.407 0 217.641 0.676471 419.736 0.833333 3071 0.803922",specular:"0.2",shade:"1",ambient:"0.1",colorTransfer:"20 -3024 0 0 0 -155.407 0.54902 0.25098 0.14902 217.641 0.882353 0.603922 0.290196 419.736 1 0.937033 0.954531 3071 0.827451 0.658824 1",diffuse:"0.9",interpolation:"1"},{name:"CT-Pulmonary-Arteries",gradientOpacity:"4 0 1 255 1",specularPower:"1",scalarOpacity:"14 -2048 0 -568.625 0 -364.081 0.0714286 -244.813 0.401786 18.2775 0.607143 447.798 0.830357 3592.73 0.839286",specular:"0",shade:"1",ambient:"0.2",colorTransfer:"28 -2048 0 0 0 -568.625 0 0 0 -364.081 0.396078 0.301961 0.180392 -244.813 0.611765 0.352941 0.0705882 18.2775 0.843137 0.0156863 0.156863 447.798 0.752941 0.752941 0.752941 3592.73 1 1 1",diffuse:"1",interpolation:"1"},{name:"CT-Soft-Tissue",gradientOpacity:"4 0 1 255 1",specularPower:"1",scalarOpacity:"10 -2048 0 -167.01 0 -160 1 240 1 3661 1",specular:"0",shade:"0",ambient:"0.2",colorTransfer:"20 -2048 0 0 0 -167.01 0 0 0 -160 0.0556356 0.0556356 0.0556356 240 1 1 1 3661 1 1 1",diffuse:"1",interpolation:"1"},{name:"CT-Air",gradientOpacity:"4 0 1 255 1",specularPower:"10",scalarOpacity:"8 -3024 0.705882 -900.0 0.715686 -500.0 0 3071 0",specular:"0.2",shade:"1",ambient:"0.1",colorTransfer:"16 -3024 1 1 1 -900.0 0.2 1.0 1.0 -500.0 0.3 0.3 1.0 3071 0 0 0 ",diffuse:"0.9",interpolation:"1"},{name:"MR-Angio",gradientOpacity:"4 0 1 255 1",specularPower:"1",scalarOpacity:"12 -2048 0 151.354 0 158.279 0.4375 190.112 0.580357 200.873 0.732143 3661 0.741071",specular:"0",shade:"1",ambient:"0.2",colorTransfer:"24 -2048 0 0 0 151.354 0 0 0 158.279 0.74902 0.376471 0 190.112 1 0.866667 0.733333 200.873 0.937255 0.937255 0.937255 3661 1 1 1",diffuse:"1",interpolation:"1"},{name:"MR-Default",gradientOpacity:"4 0 1 255 1",specularPower:"1",scalarOpacity:"12 0 0 20 0 40 0.15 120 0.3 220 0.375 1024 0.5",specular:"0",shade:"1",ambient:"0.2",colorTransfer:"24 0 0 0 0 20 0.168627 0 0 40 0.403922 0.145098 0.0784314 120 0.780392 0.607843 0.380392 220 0.847059 0.835294 0.788235 1024 1 1 1",diffuse:"1",interpolation:"1"},{name:"MR-MIP",gradientOpacity:"4 0 1 255 1",specularPower:"1",scalarOpacity:"8 0 0 98.3725 0 416.637 1 2800 1",specular:"0",shade:"0",ambient:"0.2",colorTransfer:"16 0 1 1 1 98.3725 1 1 1 416.637 1 1 1 2800 1 1 1",diffuse:"1",interpolation:"1"},{name:"MR-T2-Brain",gradientOpacity:"4 0 1 160.25 1",specularPower:"40",scalarOpacity:"10 0 0 36.05 0 218.302 0.171429 412.406 1 641 1",specular:"0.5",shade:"1",ambient:"0.3",colorTransfer:"16 0 0 0 0 98.7223 0.956863 0.839216 0.192157 412.406 0 0.592157 0.807843 641 1 1 1",diffuse:"0.6",interpolation:"1"},{name:"DTI-FA-Brain",gradientOpacity:"4 0 1 0.9950 1",specularPower:"40",scalarOpacity:"16 0 0 0 0 0.3501 0.0158 0.49379 0.7619 0.6419 1 0.9920 1 0.9950 0 0.9950 0",specular:"0.5",shade:"1",ambient:"0.3",colorTransfer:"28 0 1 0 0 0 1 0 0 0.24974 0.4941 1 0 0.49949 0 0.9882 1 0.7492 0.51764 0 1 0.9950 1 0 0 0.9950 1 0 0",diffuse:"0.9",interpolation:"1"}],x5e={slicer3D:[160/255,164/255,217/255]},Xh=Object.freeze(Object.defineProperty({__proto__:null,BACKGROUND_COLORS:x5e,CPU_COLORMAPS:f_,EPSILON:al,MPR_CAMERA_VALUES:Tf,RENDERING_DEFAULTS:Oi,VIEWPORT_PRESETS:WK},Symbol.toStringTag,{value:"Module"})),nv={},$2={get:t=>nv[t],set:t=>{const e=t.id;nv[e]=t},delete:t=>delete nv[t],getAll:()=>{const e=Object.keys(nv).map(n=>nv[n]);return e.sort((n,r)=>n.id[0]==="_"&&r.id[0]!=="_"?1:n.id[0]!=="_"&&r.id[0]==="_"?-1:0),e}};function zf(t){return $2.get(t)}function jl(){return $2.getAll()}const zw=t=>t&&typeof t=="object"&&Object.prototype.toString.call(t)!=="[object RegExp]"&&Object.prototype.toString.call(t)!=="[object Date]",b5e=t=>Array.isArray(t)?[]:{},G2=(t,e)=>e&&e.clone===!0&&zw(t)?No(b5e(t),t,e):t,lk=(t,e,n)=>{const r=t.slice();return e.forEach(function(i,a){typeof r[a]>"u"?r[a]=G2(i,n):zw(i)?r[a]=No(t[a],i,n):t.indexOf(i)===-1&&(r[a]=G2(i,n))}),r},w5e=(t,e,n)=>{const r={};return zw(t)&&Object.keys(t).forEach(function(i){r[i]=G2(t[i],n)}),Object.keys(e).forEach(function(i){!zw(e[i])||!t[i]?r[i]=G2(e[i],n):r[i]=No(t[i],e[i],n)}),r},No=(t={},e={},n=void 0)=>{const r=Array.isArray(e),a=(n||{arrayMerge:lk}).arrayMerge||lk;return r?Array.isArray(t)?a(t,e,n):G2(e,n):w5e(t,e,n)};/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const HK=Symbol("Comlink.proxy"),C5e=Symbol("Comlink.endpoint"),KK=Symbol("Comlink.releaseProxy"),yE=Symbol("Comlink.finalizer"),Fb=Symbol("Comlink.thrown"),qK=t=>typeof t=="object"&&t!==null||typeof t=="function",S5e={canHandle:t=>qK(t)&&t[HK],serialize(t){const{port1:e,port2:n}=new MessageChannel;return ND(t,e),[n,[n]]},deserialize(t){return t.start(),d_(t)}},T5e={canHandle:t=>qK(t)&&Fb in t,serialize({value:t}){let e;return t instanceof Error?e={isError:!0,value:{message:t.message,name:t.name,stack:t.stack}}:e={isError:!1,value:t},[e,[]]},deserialize(t){throw t.isError?Object.assign(new Error(t.value.message),t.value):t.value}},XK=new Map([["proxy",S5e],["throw",T5e]]);function E5e(t,e){for(const n of t)if(e===n||n==="*"||n instanceof RegExp&&n.test(e))return!0;return!1}function ND(t,e=globalThis,n=["*"]){e.addEventListener("message",function r(i){if(!i||!i.data)return;if(!E5e(n,i.origin)){console.warn(`Invalid origin '${i.origin}' for comlink proxy`);return}const{id:a,type:o,path:s}=Object.assign({path:[]},i.data),l=(i.data.argumentList||[]).map(Z0);let c;try{const f=s.slice(0,-1).reduce((d,h)=>d[h],t),u=s.reduce((d,h)=>d[h],t);switch(o){case"GET":c=u;break;case"SET":f[s.slice(-1)[0]]=Z0(i.data.value),c=!0;break;case"APPLY":c=u.apply(f,l);break;case"CONSTRUCT":{const d=new u(...l);c=QK(d)}break;case"ENDPOINT":{const{port1:d,port2:h}=new MessageChannel;ND(t,h),c=I5e(d,[d])}break;case"RELEASE":c=void 0;break;default:return}}catch(f){c={value:f,[Fb]:0}}Promise.resolve(c).catch(f=>({value:f,[Fb]:0})).then(f=>{const[u,d]=Kw(f);e.postMessage(Object.assign(Object.assign({},u),{id:a}),d),o==="RELEASE"&&(e.removeEventListener("message",r),YK(e),yE in t&&typeof t[yE]=="function"&&t[yE]())}).catch(f=>{const[u,d]=Kw({value:new TypeError("Unserializable return value"),[Fb]:0});e.postMessage(Object.assign(Object.assign({},u),{id:a}),d)})}),e.start&&e.start()}function _5e(t){return t.constructor.name==="MessagePort"}function YK(t){_5e(t)&&t.close()}function d_(t,e){const n=new Map;return t.addEventListener("message",function(i){const{data:a}=i;if(!a||!a.id)return;const o=n.get(a.id);if(o)try{o(a)}finally{n.delete(a.id)}}),h_(t,n,[],e)}function Ix(t){if(t)throw new Error("Proxy has been released and is not useable")}function JK(t){return Jp(t,new Map,{type:"RELEASE"}).then(()=>{YK(t)})}const Ww=new WeakMap,Hw="FinalizationRegistry"in globalThis&&new FinalizationRegistry(t=>{const e=(Ww.get(t)||0)-1;Ww.set(t,e),e===0&&JK(t)});function D5e(t,e){const n=(Ww.get(e)||0)+1;Ww.set(e,n),Hw&&Hw.register(t,e,t)}function O5e(t){Hw&&Hw.unregister(t)}function h_(t,e,n=[],r=function(){}){let i=!1;const a=new Proxy(r,{get(o,s){if(Ix(i),s===KK)return()=>{O5e(a),JK(t),e.clear(),i=!0};if(s==="then"){if(n.length===0)return{then:()=>a};const l=Jp(t,e,{type:"GET",path:n.map(c=>c.toString())}).then(Z0);return l.then.bind(l)}return h_(t,e,[...n,s])},set(o,s,l){Ix(i);const[c,f]=Kw(l);return Jp(t,e,{type:"SET",path:[...n,s].map(u=>u.toString()),value:c},f).then(Z0)},apply(o,s,l){Ix(i);const c=n[n.length-1];if(c===C5e)return Jp(t,e,{type:"ENDPOINT"}).then(Z0);if(c==="bind")return h_(t,e,n.slice(0,-1));const[f,u]=ck(l);return Jp(t,e,{type:"APPLY",path:n.map(d=>d.toString()),argumentList:f},u).then(Z0)},construct(o,s){Ix(i);const[l,c]=ck(s);return Jp(t,e,{type:"CONSTRUCT",path:n.map(f=>f.toString()),argumentList:l},c).then(Z0)}});return D5e(a,t),a}function M5e(t){return Array.prototype.concat.apply([],t)}function ck(t){const e=t.map(Kw);return[e.map(n=>n[0]),M5e(e.map(n=>n[1]))]}const ZK=new WeakMap;function I5e(t,e){return ZK.set(t,e),t}function QK(t){return Object.assign(t,{[HK]:!0})}function Kw(t){for(const[e,n]of XK)if(n.canHandle(t)){const[r,i]=n.serialize(t);return[{type:"HANDLER",name:e,value:r},i]}return[{type:"RAW",value:t},ZK.get(t)||[]]}function Z0(t){switch(t.type){case"HANDLER":return XK.get(t.name).deserialize(t.value);case"RAW":return t.value}}function Jp(t,e,n,r){return new Promise(i=>{const a=R5e();e.set(a,i),t.start&&t.start(),t.postMessage(Object.assign({id:a},n),r)})}function R5e(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}function cr(){return typeof crypto.randomUUID=="function"?crypto.randomUUID():("10000000-1000-4000-8000"+-1e11).replace(/[018]/g,t=>(t^crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16))}class LD{constructor(e){this.numRequests={[_n.Interaction]:0,[_n.Thumbnail]:0,[_n.Prefetch]:0,[_n.Compute]:0},this.id=e||cr(),this.requestPool={[_n.Interaction]:{0:[]},[_n.Thumbnail]:{0:[]},[_n.Prefetch]:{0:[]},[_n.Compute]:{0:[]}},this.grabDelay=5,this.awake=!1,this.numRequests={[_n.Interaction]:0,[_n.Thumbnail]:0,[_n.Prefetch]:0,[_n.Compute]:0},this.maxNumRequests={[_n.Interaction]:6,[_n.Thumbnail]:6,[_n.Prefetch]:5,[_n.Compute]:1e3}}setMaxSimultaneousRequests(e,n){this.maxNumRequests[e]=n}getMaxSimultaneousRequests(e){return this.maxNumRequests[e]}destroy(){this.timeoutHandle&&window.clearTimeout(this.timeoutHandle)}addRequest(e,n,r,i=0){const a={requestFn:e,type:n,additionalDetails:r};this.requestPool[n][i]===void 0&&(this.requestPool[n][i]=[]),this.requestPool[n][i].push(a),this.startGrabbing()}filterRequests(e){Object.keys(this.requestPool).forEach(n=>{const r=this.requestPool[n];Object.keys(r).forEach(i=>{r[i]=r[i].filter(a=>e(a))})})}clearRequestStack(e){if(!this.requestPool[e])throw new Error(`No category for the type ${e} found`);this.requestPool[e]={0:[]}}sendRequests(e){const n=this.maxNumRequests[e]-this.numRequests[e];let r=0;for(let i=0;i<n;i++){const a=this.getNextRequest(e);if(a===null)return!1;if(a){this.numRequests[e]++,this.awake=!0;let o;try{o=a.requestFn()}catch(s){console.warn("sendRequest failed",s)}o?.finally?o.finally(()=>{this.numRequests[e]--,this.startAgain()}):(this.numRequests[e]--,r++)}}return r&&this.startAgain(),!0}getNextRequest(e){const n=this.getSortedPriorityGroups(e);for(const r of n)if(this.requestPool[e][r].length)return this.requestPool[e][r].shift();return null}startGrabbing(){const e=this.sendRequests(_n.Interaction),n=this.sendRequests(_n.Thumbnail),r=this.sendRequests(_n.Prefetch),i=this.sendRequests(_n.Compute);!e&&!n&&!r&&!i&&(this.awake=!1)}startAgain(){this.awake&&(this.grabDelay!==void 0?this.timeoutHandle||(this.timeoutHandle=window.setTimeout(()=>{this.timeoutHandle=null,this.startGrabbing()},this.grabDelay)):this.startGrabbing())}getSortedPriorityGroups(e){return Object.keys(this.requestPool[e]).map(Number).filter(r=>this.requestPool[e][r].length).sort((r,i)=>r-i)}getRequestPool(){return this.requestPool}}class eq{constructor(){this.workerRegistry={},this.workerPoolManager=new LD("webworker")}registerWorker(e,n,r={}){const{maxWorkerInstances:i=1,overwrite:a=!1,autoTerminateOnIdle:o={enabled:!1,idleTimeThreshold:3e3}}=r;if(this.workerRegistry[e]&&!a){console.warn(`Worker type '${e}' is already registered...`);return}a&&this.workerRegistry[e]?.idleCheckIntervalId&&clearInterval(this.workerRegistry[e].idleCheckIntervalId);const s={workerFn:null,instances:[],loadCounters:[],lastActiveTime:[],nativeWorkers:[],autoTerminateOnIdle:o.enabled,idleCheckIntervalId:null,idleTimeThreshold:o.idleTimeThreshold};s.loadCounters=Array(i).fill(0),s.lastActiveTime=Array(i).fill(null);for(let l=0;l<i;l++){const c=n();s.instances.push(d_(c)),s.nativeWorkers.push(c),s.workerFn=n}this.workerRegistry[e]=s}getNextWorkerAPI(e){const n=this.workerRegistry[e];if(!n)return console.error(`Worker type '${e}' is not registered.`),null;const r=n.instances.filter(o=>o!==null);let i=0,a=n.loadCounters[0]||0;for(let o=1;o<r.length;o++){const s=n.loadCounters[o]||0;s<a&&(i=o,a=s)}if(n.instances[i]===null){const o=n.workerFn();n.instances[i]=d_(o),n.nativeWorkers[i]=o}return n.loadCounters[i]+=1,{api:n.instances[i],index:i}}executeTask(e,n,r={},{requestType:i=_n.Compute,priority:a=0,options:o={},callbacks:s=[]}={}){return new Promise((l,c)=>{const f=async()=>{const{api:u,index:d}=this.getNextWorkerAPI(e);if(!u){const h=new Error(`No available worker instance for '${e}'`);console.error(h),c(h);return}try{let h=[];s.length&&(h=s.map(m=>QK(m)));const p=this.workerRegistry[e];p.processing=!0;const g=await u[n](r,...h);p.processing=!1,p.lastActiveTime[d]=Date.now(),p.autoTerminateOnIdle&&!p.idleCheckIntervalId&&p.idleTimeThreshold&&(p.idleCheckIntervalId=setInterval(()=>{this.terminateIdleWorkers(e,p.idleTimeThreshold)},p.idleTimeThreshold)),l(g)}catch(h){console.error(`Error executing method '${n}' on worker '${e}':`,h),c(h)}finally{this.workerRegistry[e].loadCounters[d]--}};this.workerPoolManager.addRequest(f,i,o,a)})}terminateIdleWorkers(e,n){const r=this.workerRegistry[e];if(r.processing)return;const i=Date.now();r.instances.forEach((a,o)=>{const s=r.lastActiveTime[o],l=s!==null&&r.loadCounters[o]>0,c=i-s;!l&&c>n&&this.terminateWorkerInstance(e,o)})}terminate(e){const n=this.workerRegistry[e];if(!n){console.error(`Worker type '${e}' is not registered.`);return}n.instances.forEach((r,i)=>{this.terminateWorkerInstance(e,i)})}terminateWorkerInstance(e,n){const r=this.workerRegistry[e],i=r.instances[n];i!==null&&(i[KK](),r.nativeWorkers[n].terminate(),r.instances[n]=null,r.lastActiveTime[n]=null)}}const xE=4,P5e=5,A5e=1,uk=[1,1];function fk({ext:t,filterType:e,texData:n,internalFormat:r,glDataType:i}){try{const a=document.createElement("canvas");a.width=xE,a.height=xE;const o=a.getContext("webgl2");if(!o)return!1;const s=`#version 300 es
    void main() {
      gl_PointSize = ${xE.toFixed(1)};
      gl_Position = vec4(0, 0, 0, 1);
    }
  `,l=`#version 300 es
    precision highp float;
    precision highp int;
    precision highp sampler2D;

    uniform sampler2D u_image;

    out vec4 color;

    void main() {
        vec4 intColor = texture(u_image, gl_PointCoord.xy);
        color = vec4(vec3(intColor.rrr), 1);
    }
    `;let c;if(t&&(c=o.getExtension(t),!c))return!1;const f=o.createShader(o.VERTEX_SHADER);if(o.shaderSource(f,s),o.compileShader(f),!o.getShaderParameter(f,o.COMPILE_STATUS))return!1;const u=o.createShader(o.FRAGMENT_SHADER);if(o.shaderSource(u,l),o.compileShader(u),!o.getShaderParameter(u,o.COMPILE_STATUS))return!1;const d=o.createProgram();if(o.attachShader(d,f),o.attachShader(d,u),o.linkProgram(d),!o.getProgramParameter(d,o.LINK_STATUS))return!1;const h=o.createTexture();o.bindTexture(o.TEXTURE_2D,h),o.texImage2D(o.TEXTURE_2D,0,r(o,c),P5e,A5e,0,o.RED,i(o,c),n);const p=e==="LINEAR"?o.LINEAR:o.NEAREST;o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,p),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,p),o.useProgram(d),o.drawArrays(o.POINTS,0,1);const g=new Uint8Array(4);o.readPixels(uk[0],uk[1],1,1,o.RGBA,o.UNSIGNED_BYTE,g);const[m,y,v]=g,x=o.getExtension("WEBGL_lose_context");return x&&x.loseContext(),m===y&&y===v&&m!==0}catch{return!1}}function N5e(){const t=new Int16Array([32767,2e3,3e3,4e3,5e3,16784,7e3,8e3,9e3,32767]);return{norm16:fk({ext:"EXT_texture_norm16",filterType:"NEAREST",texData:t,internalFormat:(e,n)=>n.R16_SNORM_EXT,glDataType:e=>e.SHORT}),norm16Linear:fk({ext:"EXT_texture_norm16",filterType:"LINEAR",texData:t,internalFormat:(e,n)=>n.R16_SNORM_EXT,glDataType:e=>e.SHORT})}}let Vd=!1;const p_={gpuTier:{tier:2},isMobile:!1,rendering:{useCPURendering:!1,preferSizeOverAccuracy:!1,strictZSpacingForVolumeViewport:!0,renderingEngineMode:Ah.ContextPool,webGlContextCount:7,volumeRendering:{sampleDistanceMultiplier:1}},debug:{statsOverlay:!1},peerImport:t=>null};let Ys={...p_,rendering:{...p_.rendering}},n2=null,tq=!1;function L5e(){const t=document.createElement("canvas");return t.getContext("webgl2")||t.getContext("webgl")||t.getContext("experimental-webgl")}function nq(){const t=L5e();return t instanceof WebGLRenderingContext||t instanceof WebGL2RenderingContext}function k5e(){const t=N5e();return t.norm16&&t.norm16Linear}function rq(){return/iPad|iPhone|iPod/.test(navigator.platform)?!0:navigator.maxTouchPoints&&navigator.maxTouchPoints>2&&navigator.platform.includes("MacIntel")}function iq(t=Ys){return Vd||(tq=k5e(),Ys=No(p_,t),Ys.isMobile&&(Ys.rendering.webGlContextCount=1),rq()&&(t.rendering?.preferSizeOverAccuracy?Ys.rendering.preferSizeOverAccuracy=!0:console.log("norm16 texture not supported, you can turn on the preferSizeOverAccuracy flag to use native data type, but be aware of the inaccuracy of the rendering in high bits")),nq()?console.log("CornerstoneRender: using GPU rendering"):(console.log("CornerstoneRender: GPU not detected, using CPU rendering"),Ys.rendering.useCPURendering=!0),Vd=!0,n2||(n2=new eq),Vd)}function V5e(){return tq}function F5e(t,e=!0){Ys.rendering.useCPURendering=t,Vd=!0,e&&RC()}function U5e(t){Ys.rendering.preferSizeOverAccuracy=t,Vd=!0,RC()}function IC(){return!rq()}function B5e(){Ys.rendering.useCPURendering=!nq(),RC()}function Gg(){return Ys.rendering.useCPURendering}function aq(){return Vd}function $5e(){Vd=!1}function Vf(){return Ys}function G5e(t){Ys=t,RC()}function RC(){jl().forEach(t=>{t.getViewports().forEach(e=>{e.updateRenderingPipeline()})})}function Bm(){return n2||(n2=new eq),n2}async function oq(t){return Ys.peerImport(t)}class j5e{constructor(){this.listeners={},this.debouncedListeners={}}reset(){this.listeners={},this.debouncedListeners={}}addEventListenerOnce(e,n){const r=i=>{this.removeEventListener(e,r),n.call(this,i)};this.addEventListener(e,r)}addEventListener(e,n){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].indexOf(n)===-1&&this.listeners[e].push(n)}addEventListenerDebounced(e,n,r){this.debouncedListeners[e]=this.debouncedListeners[e]||{};const i=this.debouncedListeners[e];if(!i[n]){const a=o=>{i[n]&&clearTimeout(i[n].timeoutId),i[n].timeoutId=setTimeout(()=>{n.call(this,o)},r)};i[n]={original:n,handle:a,timeoutId:null},this.addEventListener(e,a)}}removeEventListenerDebounced(e,n){if(this.debouncedListeners[e]?.[n]){const r=this.debouncedListeners[e][n];this.removeEventListener(e,r.handle),clearTimeout(r.timeoutId),delete this.debouncedListeners[e][n]}}removeEventListener(e,n){if(!this.listeners[e])return;const r=this.listeners[e],i=r.length;for(let a=0;a<i;a++)if(r[a]===n){r.splice(a,1);return}}dispatchEvent(e){if(!this.listeners[e.type])return!e.defaultPrevented;const n=this.listeners[e.type].slice(),r=n.length;for(let i=0;i<r;i++)try{n[i].call(this,e)}catch(a){console.error(`error in event listener of type:  ${e.type}`,a)}return!e.defaultPrevented}}const vt=new j5e;function wt(t=vt,e,n=null){if(!e)throw new Error("Event type was not defined");const r=new CustomEvent(e,{detail:n,cancelable:!0});return t?.dispatchEvent(r)}var bE,dk;function z5e(){return dk||(dk=1,bE=function t(e,n){if(e===n)return!0;if(e&&n&&typeof e=="object"&&typeof n=="object"){if(e.constructor!==n.constructor)return!1;var r,i,a;if(Array.isArray(e)){if(r=e.length,r!=n.length)return!1;for(i=r;i--!==0;)if(!t(e[i],n[i]))return!1;return!0}if(e.constructor===RegExp)return e.source===n.source&&e.flags===n.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===n.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===n.toString();if(a=Object.keys(e),r=a.length,r!==Object.keys(n).length)return!1;for(i=r;i--!==0;)if(!Object.prototype.hasOwnProperty.call(n,a[i]))return!1;for(i=r;i--!==0;){var o=a[i];if(!t(e[o],n[o]))return!1}return!0}return e!==e&&n!==n}),bE}var W5e=z5e();const kD=sl(W5e);var wE,hk;function sq(){if(hk)return wE;hk=1;var t=Object.prototype.toString;return wE=function(n){var r=t.call(n),i=r==="[object Arguments]";return i||(i=r!=="[object Array]"&&n!==null&&typeof n=="object"&&typeof n.length=="number"&&n.length>=0&&t.call(n.callee)==="[object Function]"),i},wE}var CE,pk;function H5e(){if(pk)return CE;pk=1;var t;if(!Object.keys){var e=Object.prototype.hasOwnProperty,n=Object.prototype.toString,r=sq(),i=Object.prototype.propertyIsEnumerable,a=!i.call({toString:null},"toString"),o=i.call(function(){},"prototype"),s=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],l=function(d){var h=d.constructor;return h&&h.prototype===d},c={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},f=(function(){if(typeof window>"u")return!1;for(var d in window)try{if(!c["$"+d]&&e.call(window,d)&&window[d]!==null&&typeof window[d]=="object")try{l(window[d])}catch{return!0}}catch{return!0}return!1})(),u=function(d){if(typeof window>"u"||!f)return l(d);try{return l(d)}catch{return!1}};t=function(h){var p=h!==null&&typeof h=="object",g=n.call(h)==="[object Function]",m=r(h),y=p&&n.call(h)==="[object String]",v=[];if(!p&&!g&&!m)throw new TypeError("Object.keys called on a non-object");var x=o&&g;if(y&&h.length>0&&!e.call(h,0))for(var w=0;w<h.length;++w)v.push(String(w));if(m&&h.length>0)for(var S=0;S<h.length;++S)v.push(String(S));else for(var T in h)!(x&&T==="prototype")&&e.call(h,T)&&v.push(String(T));if(a)for(var _=u(h),D=0;D<s.length;++D)!(_&&s[D]==="constructor")&&e.call(h,s[D])&&v.push(s[D]);return v}}return CE=t,CE}var SE,gk;function K5e(){if(gk)return SE;gk=1;var t=Array.prototype.slice,e=sq(),n=Object.keys,r=n?function(o){return n(o)}:H5e(),i=Object.keys;return r.shim=function(){if(Object.keys){var o=(function(){var s=Object.keys(arguments);return s&&s.length===arguments.length})(1,2);o||(Object.keys=function(l){return e(l)?i(t.call(l)):i(l)})}else Object.keys=r;return Object.keys||r},SE=r,SE}var TE,mk;function lq(){if(mk)return TE;mk=1;var t=Object.defineProperty||!1;if(t)try{t({},"a",{value:1})}catch{t=!1}return TE=t,TE}var EE,vk;function q5e(){return vk||(vk=1,EE=SyntaxError),EE}var _E,yk;function X5e(){return yk||(yk=1,_E=TypeError),_E}var DE,xk;function Y5e(){return xk||(xk=1,DE=Object.getOwnPropertyDescriptor),DE}var OE,bk;function J5e(){if(bk)return OE;bk=1;var t=Y5e();if(t)try{t([],"length")}catch{t=null}return OE=t,OE}var ME,wk;function Z5e(){if(wk)return ME;wk=1;var t=lq(),e=q5e(),n=X5e(),r=J5e();return ME=function(a,o,s){if(!a||typeof a!="object"&&typeof a!="function")throw new n("`obj` must be an object or a function`");if(typeof o!="string"&&typeof o!="symbol")throw new n("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new n("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new n("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new n("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new n("`loose`, if provided, must be a boolean");var l=arguments.length>3?arguments[3]:null,c=arguments.length>4?arguments[4]:null,f=arguments.length>5?arguments[5]:null,u=arguments.length>6?arguments[6]:!1,d=!!r&&r(a,o);if(t)t(a,o,{configurable:f===null&&d?d.configurable:!f,enumerable:l===null&&d?d.enumerable:!l,value:s,writable:c===null&&d?d.writable:!c});else if(u||!l&&!c&&!f)a[o]=s;else throw new e("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},ME}var IE,Ck;function Q5e(){if(Ck)return IE;Ck=1;var t=lq(),e=function(){return!!t};return e.hasArrayLengthDefineBug=function(){if(!t)return null;try{return t([],"length",{value:1}).length!==1}catch{return!0}},IE=e,IE}var RE,Sk;function cq(){if(Sk)return RE;Sk=1;var t=K5e(),e=typeof Symbol=="function"&&typeof Symbol("foo")=="symbol",n=Object.prototype.toString,r=Array.prototype.concat,i=Z5e(),a=function(c){return typeof c=="function"&&n.call(c)==="[object Function]"},o=Q5e()(),s=function(c,f,u,d){if(f in c){if(d===!0){if(c[f]===u)return}else if(!a(d)||!d())return}o?i(c,f,u,!0):i(c,f,u)},l=function(c,f){var u=arguments.length>2?arguments[2]:{},d=t(f);e&&(d=r.call(d,Object.getOwnPropertySymbols(f)));for(var h=0;h<d.length;h+=1)s(c,d[h],f[d[h]],u[d[h]])};return l.supportsDescriptors=!!o,RE=l,RE}var rv={exports:{}},Tk;function uq(){return Tk||(Tk=1,typeof self<"u"?rv.exports=self:typeof window<"u"?rv.exports=window:rv.exports=Function("return this")()),rv.exports}var PE,Ek;function fq(){if(Ek)return PE;Ek=1;var t=uq();return PE=function(){return typeof vf!="object"||!vf||vf.Math!==Math||vf.Array!==Array?t:vf},PE}var AE,_k;function exe(){if(_k)return AE;_k=1;var t=cq(),e=fq();return AE=function(){var r=e();if(t.supportsDescriptors){var i=Object.getOwnPropertyDescriptor(r,"globalThis");(!i||i.configurable&&(i.enumerable||!i.writable||globalThis!==r))&&Object.defineProperty(r,"globalThis",{configurable:!0,enumerable:!1,value:r,writable:!0})}else(typeof globalThis!="object"||globalThis!==r)&&(r.globalThis=r);return r},AE}var NE,Dk;function txe(){if(Dk)return NE;Dk=1;var t=cq(),e=uq(),n=fq(),r=exe(),i=n(),a=function(){return i};return t(a,{getPolyfill:n,implementation:e,shim:r}),NE=a,NE}var nxe=txe();const rxe=sl(nxe),pc=rxe(),dq={vtkObject:()=>null};function yc(t){if(t==null||t.isA)return t;if(!t.vtkClass)return pc.console&&pc.console.error&&pc.console.error("Invalid VTK object"),null;const e=dq[t.vtkClass];if(!e)return pc.console&&pc.console.error&&pc.console.error(`No vtk class found for Object of type ${t.vtkClass}`),null;const n={...t};Object.keys(n).forEach(i=>{n[i]&&typeof n[i]=="object"&&n[i].vtkClass&&(n[i]=yc(n[i]))});const r=e(n);return r&&r.modified&&r.modified(),r}function ixe(t,e){dq[t]=e}yc.register=ixe;class LE extends Array{push(){for(let e=0;e<arguments.length;e++)this.includes(arguments[e])||super.push(arguments[e]);return this.length}}let g_=0;const hq=Symbol("void");function axe(){return g_}const pq={};function Q0(){}const oxe=["log","debug","info","warn","error","time","timeEnd","group","groupEnd"];oxe.forEach(t=>{pq[t]=Q0});pc.console=console.hasOwnProperty("log")?console:pq;const t0={debug:Q0,error:pc.console.error||Q0,info:pc.console.info||Q0,log:pc.console.log||Q0,warn:pc.console.warn||Q0};function gq(t,e){t0[t]&&(t0[t]=e||Q0)}function mq(){t0.log(...arguments)}function vq(){t0.info(...arguments)}function qw(){t0.debug(...arguments)}function $n(){t0.error(...arguments)}function PC(){t0.warn(...arguments)}const Ok={};function yq(t){Ok[t]||(t0.error(t),Ok[t]=!0)}const ko=Object.create(null);ko.Float32Array=Float32Array;ko.Float64Array=Float64Array;ko.Uint8Array=Uint8Array;ko.Int8Array=Int8Array;ko.Uint16Array=Uint16Array;ko.Int16Array=Int16Array;ko.Uint32Array=Uint32Array;ko.Int32Array=Int32Array;ko.Uint8ClampedArray=Uint8ClampedArray;try{ko.BigInt64Array=BigInt64Array,ko.BigUint64Array=BigUint64Array}catch{}function $m(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return new(ko[t]||Float64Array)(...n)}function AC(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return(ko[t]||Float64Array).from(...n)}function NC(t){return t.charAt(0).toUpperCase()+t.slice(1)}function Yi(t){return NC(t[0]==="_"?t.slice(1):t)}function xq(t){return t.charAt(0).toLowerCase()+t.slice(1)}function bq(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1e3;const r=["TB","GB","MB","KB"];let i=Number(t),a="B";for(;i>n;)i/=n,a=r.pop();return`${i.toFixed(e)} ${a}`}function wq(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";const n=[];let r=t;for(;r>1e3;)n.push(`000${r%1e3}`.slice(-3)),r=Math.floor(r/1e3);return r>0&&n.push(r),n.reverse(),n.join(e)}function Cq(t){Object.keys(t).forEach(e=>{Array.isArray(t[e])&&(t[e]=[].concat(t[e]))})}function sxe(t){return Object.values(ko).some(e=>t instanceof e)}function lxe(t,e){if(t===e)return!0;if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}return!1}function cxe(t,e){return Object.keys(t).find(n=>t[n]===e)}function Sq(t){return t&&t.isA?t.getState():t}function VD(t){setTimeout(t,0)}function Tq(t,e){const n=performance.now();t.finally(()=>{const r=performance.now()-n;e(r)})}function Wr(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Cq(e);const n=[];if(Number.isInteger(e.mtime)||(e.mtime=++g_),!("classHierarchy"in e))e.classHierarchy=new LE("vtkObject");else if(!(e.classHierarchy instanceof LE)){const a=new LE;for(let o=0;o<e.classHierarchy.length;o++)a.push(e.classHierarchy[o]);e.classHierarchy=a}function r(a){n[a]=null}function i(a){function o(){r(a)}return Object.freeze({unsubscribe:o})}return t.isDeleted=()=>!!e.deleted,t.modified=a=>{if(e.deleted){$n("instance deleted - cannot call any method");return}a&&a<t.getMTime()||(e.mtime=++g_,n.forEach(o=>o&&o(t)))},t.onModified=a=>{if(e.deleted)return $n("instance deleted - cannot call any method"),null;const o=n.length;return n.push(a),i(o)},t.getMTime=()=>e.mtime,t.isA=a=>{let o=e.classHierarchy.length;for(;o--;)if(e.classHierarchy[o]===a)return!0;return!1},t.getClassName=function(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return e.classHierarchy[e.classHierarchy.length-1-a]},t.set=function(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,l=!1;return Object.keys(a).forEach(c=>{const f=s?null:t[`set${NC(c)}`];f&&Array.isArray(a[c])&&f.length>1?l=f(...a[c])||l:f?l=f(a[c])||l:(["mtime"].indexOf(c)===-1&&!o&&PC(`Warning: Set value to model directly ${c}, ${a[c]}`),l=e[c]!==a[c]||l,e[c]=a[c])}),l},t.get=function(){for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];if(!o.length)return e;const l={};return o.forEach(c=>{l[c]=e[c]}),l},t.getReferenceByName=a=>e[a],t.delete=()=>{Object.keys(e).forEach(a=>delete e[a]),n.forEach((a,o)=>r(o)),e.deleted=!0},t.getState=()=>{if(e.deleted)return null;const a={...e,vtkClass:t.getClassName()};Object.keys(a).forEach(s=>{a[s]===null||a[s]===void 0||s[0]==="_"?delete a[s]:a[s].isA?a[s]=a[s].getState():Array.isArray(a[s])?a[s]=a[s].map(Sq):sxe(a[s])&&(a[s]=Array.from(a[s]))});const o={};return Object.keys(a).sort().forEach(s=>{o[s]=a[s]}),o.mtime&&delete o.mtime,o},t.shallowCopy=function(a){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(a.getClassName()!==t.getClassName())throw new Error(`Cannot ShallowCopy ${a.getClassName()} into ${t.getClassName()}`);const s=a.get(),l=Object.keys(e).sort();Object.keys(s).sort().forEach(f=>{const u=l.indexOf(f);u===-1?o&&qw(`add ${f} in shallowCopy`):l.splice(u,1),e[f]=s[f]}),l.length&&o&&qw(`Untouched keys: ${l.join(", ")}`),t.modified()},t.toJSON=function(){return t.getState()},t}const uxe={object(t,e,n){return function(){return{...e[n.name]}}}};function Fo(t,e,n){n.forEach(r=>{if(typeof r=="object"){const i=uxe[r.type];i?t[`get${Yi(r.name)}`]=i(t,e,r):t[`get${Yi(r.name)}`]=()=>e[r.name]}else t[`get${Yi(r)}`]=()=>e[r]})}const Eq={enum(t,e,n){const r=`_on${Yi(n.name)}Changed`;return i=>{if(typeof i=="string"){if(n.enum[i]!==void 0)return e[n.name]!==n.enum[i]?(e[n.name]=n.enum[i],t.modified(),!0):!1;throw $n(`Set Enum with invalid argument ${n}, ${i}`),new RangeError("Set Enum with invalid string argument")}if(typeof i=="number"){if(e[n.name]!==i){if(Object.keys(n.enum).map(a=>n.enum[a]).indexOf(i)!==-1){const a=e[n.name];return e[n.name]=i,e[r]?.(t,e,i,a),t.modified(),!0}throw $n(`Set Enum outside numeric range ${n}, ${i}`),new RangeError("Set Enum outside numeric range")}return!1}throw $n(`Set Enum with invalid argument (String/Number) ${n}, ${i}`),new TypeError("Set Enum with invalid argument (String/Number)")}},object(t,e,n){n.params?.length===1&&PC('Setter of type "object" with a single "param" field is not supported');const r=`_on${Yi(n.name)}Changed`;return function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];let s;if(a.length>1&&n.params?.length?s=n.params.reduce((l,c,f)=>Object.assign(l,{[c]:a[f]}),{}):s=a[0],!kD(e[n.name],s)){const l=e[n.name];return e[n.name]=s,e[r]?.(t,e,s,l),t.modified(),!0}return!1}}};function Mk(t){if(typeof t=="object"){const e=Eq[t.type];if(e)return(n,r)=>e(n,r,t);throw $n(`No setter for field ${t}`),new TypeError("No setter for field")}return function(n,r){const i=`_on${Yi(t)}Changed`;return function(o){if(r.deleted)return $n("instance deleted - cannot call any method"),!1;if(r[t]!==o){const s=r[t.name];return r[t]=o,r[i]?.(n,r,o,s),n.modified(),!0}return!1}}}function _y(t,e,n){n.forEach(r=>{typeof r=="object"?t[`set${Yi(r.name)}`]=Mk(r)(t,e):t[`set${Yi(r)}`]=Mk(r)(t,e)})}function Ni(t,e,n){Fo(t,e,n),_y(t,e,n)}function Gm(t,e,n){n.forEach(r=>{t[`get${Yi(r)}`]=()=>e[r]?Array.from(e[r]):e[r],t[`get${Yi(r)}ByReference`]=()=>e[r]})}function FD(t,e,n,r){let i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:void 0;n.forEach(a=>{if(e[a]&&r&&e[a].length!==r)throw new RangeError(`Invalid initial number of values for array (${a})`);const o=`_on${Yi(a)}Changed`;t[`set${Yi(a)}`]=function(){if(e.deleted)return $n("instance deleted - cannot call any method"),!1;for(var s=arguments.length,l=new Array(s),c=0;c<s;c++)l[c]=arguments[c];let f=l,u,d=!1;if(f.length===1&&(f[0]==null||f[0].length>=0)&&(f=f[0],d=!0),f==null)u=e[a]!==f;else{if(r&&f.length!==r)if(f.length<r&&i!==void 0)for(f=Array.from(f),d=!1;f.length<r;)f.push(i);else throw new RangeError(`Invalid number of values for array setter (${a})`);u=e[a]==null||e[a].length!==f.length;for(let h=0;!u&&h<f.length;++h)u=e[a][h]!==f[h];u&&d&&(f=Array.from(f))}if(u){const h=e[a.name];e[a]=f,e[o]?.(t,e,f,h),t.modified()}return u},t[`set${Yi(a)}From`]=s=>{const l=e[a];s.forEach((c,f)=>{l[f]=c})}})}function UD(t,e,n,r){let i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:void 0;Gm(t,e,n),FD(t,e,n,r,i)}function Dy(t,e,n){for(let r=0;r<n.length;r++){const i=n[r];e[i]!==void 0&&(e[`_${i}`]=e[i],delete e[i])}}function BD(t,e,n,r){e.inputData?e.inputData=e.inputData.map(yc):e.inputData=[],e.inputConnection?e.inputConnection=e.inputConnection.map(yc):e.inputConnection=[],e.output?e.output=e.output.map(yc):e.output=[],e.inputArrayToProcess?e.inputArrayToProcess=e.inputArrayToProcess.map(yc):e.inputArrayToProcess=[],e.numberOfInputs=n;function i(h){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(e.deleted){$n("instance deleted - cannot call any method");return}if(p>=e.numberOfInputs){$n(`algorithm ${t.getClassName()} only has ${e.numberOfInputs} input ports. To add more input ports, use addInputData()`);return}(e.inputData[p]!==h||e.inputConnection[p])&&(e.inputData[p]=h,e.inputConnection[p]=null,t.modified&&t.modified())}function a(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return e.inputConnection[h]&&(e.inputData[h]=e.inputConnection[h]()),e.inputData[h]}function o(h){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(e.deleted){$n("instance deleted - cannot call any method");return}if(p>=e.numberOfInputs){let g=`algorithm ${t.getClassName()} only has `;g+=`${e.numberOfInputs}`,g+=" input ports. To add more input ports, use addInputConnection()",$n(g);return}e.inputData[p]=null,e.inputConnection[p]=h}function s(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return e.inputConnection[h]}function l(){let h=e.numberOfInputs;for(;h&&!e.inputData[h-1]&&!e.inputConnection[h-1];)h--;return h===e.numberOfInputs&&e.numberOfInputs++,h}function c(h){if(e.deleted){$n("instance deleted - cannot call any method");return}o(h,l())}function f(h){if(e.deleted){$n("instance deleted - cannot call any method");return}i(h,l())}function u(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return e.deleted?($n("instance deleted - cannot call any method"),null):(t.shouldUpdate()&&t.update(),e.output[h])}t.shouldUpdate=()=>{const h=t.getMTime();let p=1/0,g=r;for(;g--;){if(!e.output[g]||e.output[g].isDeleted())return!0;const m=e.output[g].getMTime();if(m<h)return!0;m<p&&(p=m)}for(g=e.numberOfInputs;g--;)if(e.inputConnection[g]?.filter.shouldUpdate()||t.getInputData(g)?.getMTime()>p)return!0;return!1};function d(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;const p=()=>u(h);return p.filter=t,p}if(e.numberOfInputs){let h=e.numberOfInputs;for(;h--;)e.inputData.push(null),e.inputConnection.push(null);t.setInputData=i,t.setInputConnection=o,t.addInputData=f,t.addInputConnection=c,t.getInputData=a,t.getInputConnection=s}r&&(t.getOutputData=u,t.getOutputPort=d),t.update=()=>{const h=[];if(e.numberOfInputs){let p=0;for(;p<e.numberOfInputs;)h[p]=t.getInputData(p),p++}t.shouldUpdate()&&t.requestData&&t.requestData(h,e.output)},t.getNumberOfInputPorts=()=>e.numberOfInputs,t.getNumberOfOutputPorts=()=>r||e.output.length,t.getInputArrayToProcess=h=>{const p=e.inputArrayToProcess[h],g=e.inputData[h];return p&&g?g[`get${p.fieldAssociation}`]().getArray(p.arrayName):null},t.setInputArrayToProcess=function(h,p,g){let m=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"Scalars";for(;e.inputArrayToProcess.length<h;)e.inputArrayToProcess.push(null);e.inputArrayToProcess[h]={arrayName:p,fieldAssociation:g,attributeType:m}}}const $D=Symbol("Event abort");function GD(t,e,n){const r=[],i=t.delete;let a=1;function o(c){for(let f=0;f<r.length;++f){const[u]=r[f];if(u===c){r.splice(f,1);return}}}function s(c){function f(){o(c)}return Object.freeze({unsubscribe:f})}function l(){if(e.deleted){$n("instance deleted - cannot call any method");return}const c=r.slice();for(let f=0;f<c.length;++f){const[,u,d]=c[f];if(u){if(d<0)setTimeout(()=>u.apply(t,arguments),1-d);else if(u.apply(t,arguments)===$D)break}}}t[`invoke${Yi(n)}`]=l,t[`on${Yi(n)}`]=function(c){let f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(!c.apply)return console.error(`Invalid callback for event ${n}`),null;if(e.deleted)return $n("instance deleted - cannot call any method"),null;const u=a++;return r.push([u,c,f]),r.sort((d,h)=>h[2]-d[2]),s(u)},t.delete=()=>{i(),r.forEach(c=>{let[f]=c;return o(f)})}}function Qn(t,e){const n=function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const i={},a={};return t(a,i,r),Object.freeze(a)};return e&&yc.register(e,n),n}function Oy(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(){for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return e.filter(o=>!!o).map(o=>o(...i))}}function jD(t){return t&&t.isA&&t.isA("vtkObject")}function Xw(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[];if(jD(t)){if(r.indexOf(t)>=0)return n;r.push(t);const i=e(t);i!==void 0&&n.push(i);const a=t.get();Object.keys(a).forEach(o=>{const s=a[o];Array.isArray(s)?s.forEach(l=>{Xw(l,e,n,r)}):Xw(s,e,n,r)})}return n}function _q(t,e,n){var r=this;let i;const a=function(){for(var o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];const c=r,f=()=>{i=null,n||t.apply(c,s)},u=n&&!i;clearTimeout(i),i=setTimeout(f,e),u&&t.apply(c,s)};return a.cancel=()=>clearTimeout(i),a}function Dq(t,e){let n=!1,r=null;function i(){n=!1,r!==null&&(a(...r),r=null)}function a(){for(var o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];if(n){r=s;return}n=!0,t(...s),setTimeout(i,e)}return a}function zD(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};e.keystore=Object.assign(e.keystore||{},n),t.setKey=(r,i)=>{e.keystore[r]=i},t.getKey=r=>e.keystore[r],t.getAllKeys=()=>Object.keys(e.keystore),t.deleteKey=r=>delete e.keystore[r],t.clearKeystore=()=>t.getAllKeys().forEach(r=>delete e.keystore[r])}let fxe=1;const Rx="__root__";function Oq(t,e){zD(t,e);const n=t.delete;e.proxyId=`${fxe++}`,e.ui=JSON.parse(JSON.stringify(e.ui||[])),Fo(t,e,["proxyId","proxyGroup","proxyName"]),Ni(t,e,["proxyManager"]);const r={},i={};function a(c,f){i[f]||(i[f]=[]);const u=i[f];for(let d=0;d<c.length;d++)u.push(c[d].name),r[c[d].name]=c[d],c[d].children&&c[d].children.length&&a(c[d].children,c[d].name)}a(e.ui,Rx),t.updateUI=c=>{e.ui=JSON.parse(JSON.stringify(c||[])),Object.keys(r).forEach(f=>delete r[f]),Object.keys(i).forEach(f=>delete i[f]),a(e.ui,Rx),t.modified()};function o(){let c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Rx;return i[c]}t.updateProxyProperty=(c,f)=>{const u=r[c];u?Object.assign(u,f):r[c]={...f}},t.activate=()=>{if(e.proxyManager){const c=`setActive${Yi(t.getProxyGroup().slice(0,-1))}`;e.proxyManager[c]&&e.proxyManager[c](t)}},e.propertyLinkSubscribers={},t.registerPropertyLinkForGC=(c,f)=>{f in e.propertyLinkSubscribers||(e.propertyLinkSubscribers[f]=[]),e.propertyLinkSubscribers[f].push(c)},t.gcPropertyLinks=c=>{const f=e.propertyLinkSubscribers[c]||[];for(;f.length;)f.pop().unbind(t)},e.propertyLinkMap={},t.getPropertyLink=function(c){let f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(e.propertyLinkMap[c])return e.propertyLinkMap[c];let u=null;const d=[];let h=0,p=!1;function g(w){let S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(p)return null;const T=[];let _=null;for(h=d.length;h--;){const I=d[h];I.instance===w?_=I:T.push(I)}if(!_)return null;const D=_.instance[`get${Yi(_.propertyName)}`]();if(!lxe(D,u)||S){for(u=D,p=!0;T.length;){const I=T.pop();I.instance.set({[I.propertyName]:u})}p=!1}return e.propertyLinkMap[c].persistent&&(e.propertyLinkMap[c].value=D),D}function m(w,S){const T=[];for(h=d.length;h--;){const _=d[h];_.instance===w&&(_.propertyName===S||S===void 0)&&(_.subscription.unsubscribe(),T.push(h))}for(;T.length;)d.splice(T.pop(),1)}function y(w,S){let T=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const _=w.onModified(g),D=d[0];return d.push({instance:w,propertyName:S,subscription:_}),T&&(e.propertyLinkMap[c].persistent&&e.propertyLinkMap[c].value!==void 0?w.set({[S]:e.propertyLinkMap[c].value}):D&&g(D.instance,!0)),{unsubscribe:()=>m(w,S)}}function v(){for(;d.length;)d.pop().subscription.unsubscribe()}const x={bind:y,unbind:m,unsubscribe:v,persistent:f};return e.propertyLinkMap[c]=x,x};function s(){let c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Rx;const f=[],u=e.proxyId,d=o(c)||[];for(let h=0;h<d.length;h++){const p=d[h],g=t[`get${Yi(p)}`],m=g?g():void 0,y={id:u,name:p,value:m},v=s(p);v.length&&(y.children=v),f.push(y)}return f}t.listPropertyNames=()=>s().map(c=>c.name),t.getPropertyByName=c=>s().find(f=>f.name===c),t.getPropertyDomainByName=c=>(r[c]||{}).domain,t.getProxySection=()=>({id:e.proxyId,name:e.proxyGroup,ui:e.ui,properties:s()}),t.delete=()=>{const c=Object.keys(e.propertyLinkMap);let f=c.length;for(;f--;)e.propertyLinkMap[c[f]].unsubscribe();Object.keys(e.propertyLinkSubscribers).forEach(t.gcPropertyLinks),n()},t.getState=()=>null;function l(){if(e.links)for(let c=0;c<e.links.length;c++){const{link:f,property:u,persistent:d,updateOnBind:h,type:p}=e.links[c];if(p==="application"){const g=e.proxyManager.getPropertyLink(f,d);t.registerPropertyLinkForGC(g,"application"),g.bind(t,u,h)}}}VD(l)}function Mq(t,e,n){const r=t.delete,i=[],a=Object.keys(n);let o=a.length;for(;o--;){const s=a[o],{modelKey:l,property:c,modified:f=!0}=n[s],u=Yi(c),d=Yi(s);t[`get${d}`]=e[l][`get${u}`],t[`set${d}`]=e[l][`set${u}`],f&&i.push(e[l].onModified(t.modified))}t.delete=()=>{for(;i.length;)i.pop().unsubscribe();r()}}function Iq(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};e.this=t;function i(s){const l=Object.keys(s);let c=l.length;for(;c--;){const f=l[c];e[f].set(s[f])}}const a=Object.keys(r);let o=a.length;for(;o--;){const s=a[o];e[s]=r[s];const l=n[s];t[`set${Yi(s)}`]=c=>{if(c!==e[s]){e[s]=c;const f=l[c];i(f),t.modified()}}}a.length&&Fo(t,e,a)}const Ik=10,Rk=40,Pk=800;function Rq(t){let e=0,n=0,r=0,i=0;return"detail"in t&&(n=t.detail),"wheelDelta"in t&&(n=-t.wheelDelta/120),"wheelDeltaY"in t&&(n=-t.wheelDeltaY/120),"wheelDeltaX"in t&&(e=-t.wheelDeltaX/120),"axis"in t&&t.axis===t.HORIZONTAL_AXIS&&(e=n,n=0),r=e*Ik,i=n*Ik,"deltaY"in t&&(i=t.deltaY),"deltaX"in t&&(r=t.deltaX),(r||i)&&t.deltaMode&&(t.deltaMode===1?(r*=Rk,i*=Rk):(r*=Pk,i*=Pk)),r&&!e&&(e=r<1?-1:1),i&&!n&&(n=i<1?-1:1),{spinX:e,spinY:n||e,pixelX:r,pixelY:i||r}}var ce={algo:BD,capitalize:NC,chain:Oy,debounce:_q,enumToString:cxe,event:GD,EVENT_ABORT:$D,formatBytesToProperUnit:bq,formatNumbersWithThousandSeparator:wq,get:Fo,getArray:Gm,getCurrentGlobalMTime:axe,getStateArrayMapFunc:Sq,isVtkObject:jD,keystore:zD,measurePromiseExecution:Tq,moveToProtected:Dy,newInstance:Qn,newTypedArray:$m,newTypedArrayFrom:AC,normalizeWheel:Rq,obj:Wr,proxy:Oq,proxyPropertyMapping:Mq,proxyPropertyState:Iq,safeArrays:Cq,set:_y,setArray:FD,setGet:Ni,setGetArray:UD,setImmediate:VD,setLoggerFunction:gq,throttle:Dq,traverseInstanceTree:Xw,TYPED_ARRAYS:ko,uncapitalize:xq,VOID:hq,vtkDebugMacro:qw,vtkErrorMacro:$n,vtkInfoMacro:vq,vtkLogMacro:mq,vtkOnceErrorMacro:yq,vtkWarningMacro:PC,objectSetterMap:Eq},wo=Object.freeze({__proto__:null,VOID:hq,setLoggerFunction:gq,vtkLogMacro:mq,vtkInfoMacro:vq,vtkDebugMacro:qw,vtkErrorMacro:$n,vtkWarningMacro:PC,vtkOnceErrorMacro:yq,TYPED_ARRAYS:ko,newTypedArray:$m,newTypedArrayFrom:AC,capitalize:NC,_capitalize:Yi,uncapitalize:xq,formatBytesToProperUnit:bq,formatNumbersWithThousandSeparator:wq,setImmediateVTK:VD,measurePromiseExecution:Tq,obj:Wr,get:Fo,set:_y,setGet:Ni,getArray:Gm,setArray:FD,setGetArray:UD,moveToProtected:Dy,algo:BD,EVENT_ABORT:$D,event:GD,newInstance:Qn,chain:Oy,isVtkObject:jD,traverseInstanceTree:Xw,debounce:_q,throttle:Dq,keystore:zD,proxy:Oq,proxyPropertyMapping:Mq,proxyPropertyState:Iq,normalizeWheel:Rq,default:ce}),Ub={exports:{}},dxe=Ub.exports,Ak;function hxe(){return Ak||(Ak=1,(function(t){(function(e,n,r){function i(l){var c=this,f=s();c.next=function(){var u=2091639*c.s0+c.c*23283064365386963e-26;return c.s0=c.s1,c.s1=c.s2,c.s2=u-(c.c=u|0)},c.c=1,c.s0=f(" "),c.s1=f(" "),c.s2=f(" "),c.s0-=f(l),c.s0<0&&(c.s0+=1),c.s1-=f(l),c.s1<0&&(c.s1+=1),c.s2-=f(l),c.s2<0&&(c.s2+=1),f=null}function a(l,c){return c.c=l.c,c.s0=l.s0,c.s1=l.s1,c.s2=l.s2,c}function o(l,c){var f=new i(l),u=c&&c.state,d=f.next;return d.int32=function(){return f.next()*4294967296|0},d.double=function(){return d()+(d()*2097152|0)*11102230246251565e-32},d.quick=d,u&&(typeof u=="object"&&a(u,f),d.state=function(){return a(f,{})}),d}function s(){var l=4022871197,c=function(f){f=String(f);for(var u=0;u<f.length;u++){l+=f.charCodeAt(u);var d=.02519603282416938*l;l=d>>>0,d-=l,d*=l,l=d>>>0,d-=l,l+=d*4294967296}return(l>>>0)*23283064365386963e-26};return c}n&&n.exports?n.exports=o:this.alea=o})(dxe,t)})(Ub)),Ub.exports}var Bb={exports:{}},pxe=Bb.exports,Nk;function gxe(){return Nk||(Nk=1,(function(t){(function(e,n,r){function i(s){var l=this,c="";l.x=0,l.y=0,l.z=0,l.w=0,l.next=function(){var u=l.x^l.x<<11;return l.x=l.y,l.y=l.z,l.z=l.w,l.w^=l.w>>>19^u^u>>>8},s===(s|0)?l.x=s:c+=s;for(var f=0;f<c.length+64;f++)l.x^=c.charCodeAt(f)|0,l.next()}function a(s,l){return l.x=s.x,l.y=s.y,l.z=s.z,l.w=s.w,l}function o(s,l){var c=new i(s),f=l&&l.state,u=function(){return(c.next()>>>0)/4294967296};return u.double=function(){do var d=c.next()>>>11,h=(c.next()>>>0)/4294967296,p=(d+h)/(1<<21);while(p===0);return p},u.int32=c.next,u.quick=u,f&&(typeof f=="object"&&a(f,c),u.state=function(){return a(c,{})}),u}n&&n.exports?n.exports=o:this.xor128=o})(pxe,t)})(Bb)),Bb.exports}var $b={exports:{}},mxe=$b.exports,Lk;function vxe(){return Lk||(Lk=1,(function(t){(function(e,n,r){function i(s){var l=this,c="";l.next=function(){var u=l.x^l.x>>>2;return l.x=l.y,l.y=l.z,l.z=l.w,l.w=l.v,(l.d=l.d+362437|0)+(l.v=l.v^l.v<<4^(u^u<<1))|0},l.x=0,l.y=0,l.z=0,l.w=0,l.v=0,s===(s|0)?l.x=s:c+=s;for(var f=0;f<c.length+64;f++)l.x^=c.charCodeAt(f)|0,f==c.length&&(l.d=l.x<<10^l.x>>>4),l.next()}function a(s,l){return l.x=s.x,l.y=s.y,l.z=s.z,l.w=s.w,l.v=s.v,l.d=s.d,l}function o(s,l){var c=new i(s),f=l&&l.state,u=function(){return(c.next()>>>0)/4294967296};return u.double=function(){do var d=c.next()>>>11,h=(c.next()>>>0)/4294967296,p=(d+h)/(1<<21);while(p===0);return p},u.int32=c.next,u.quick=u,f&&(typeof f=="object"&&a(f,c),u.state=function(){return a(c,{})}),u}n&&n.exports?n.exports=o:this.xorwow=o})(mxe,t)})($b)),$b.exports}var Gb={exports:{}},yxe=Gb.exports,kk;function xxe(){return kk||(kk=1,(function(t){(function(e,n,r){function i(s){var l=this;l.next=function(){var f=l.x,u=l.i,d,h;return d=f[u],d^=d>>>7,h=d^d<<24,d=f[u+1&7],h^=d^d>>>10,d=f[u+3&7],h^=d^d>>>3,d=f[u+4&7],h^=d^d<<7,d=f[u+7&7],d=d^d<<13,h^=d^d<<9,f[u]=h,l.i=u+1&7,h};function c(f,u){var d,h=[];if(u===(u|0))h[0]=u;else for(u=""+u,d=0;d<u.length;++d)h[d&7]=h[d&7]<<15^u.charCodeAt(d)+h[d+1&7]<<13;for(;h.length<8;)h.push(0);for(d=0;d<8&&h[d]===0;++d);for(d==8?h[7]=-1:h[d],f.x=h,f.i=0,d=256;d>0;--d)f.next()}c(l,s)}function a(s,l){return l.x=s.x.slice(),l.i=s.i,l}function o(s,l){s==null&&(s=+new Date);var c=new i(s),f=l&&l.state,u=function(){return(c.next()>>>0)/4294967296};return u.double=function(){do var d=c.next()>>>11,h=(c.next()>>>0)/4294967296,p=(d+h)/(1<<21);while(p===0);return p},u.int32=c.next,u.quick=u,f&&(f.x&&a(f,c),u.state=function(){return a(c,{})}),u}n&&n.exports?n.exports=o:this.xorshift7=o})(yxe,t)})(Gb)),Gb.exports}var jb={exports:{}},bxe=jb.exports,Vk;function wxe(){return Vk||(Vk=1,(function(t){(function(e,n,r){function i(s){var l=this;l.next=function(){var f=l.w,u=l.X,d=l.i,h,p;return l.w=f=f+1640531527|0,p=u[d+34&127],h=u[d=d+1&127],p^=p<<13,h^=h<<17,p^=p>>>15,h^=h>>>12,p=u[d]=p^h,l.i=d,p+(f^f>>>16)|0};function c(f,u){var d,h,p,g,m,y=[],v=128;for(u===(u|0)?(h=u,u=null):(u=u+"\0",h=0,v=Math.max(v,u.length)),p=0,g=-32;g<v;++g)u&&(h^=u.charCodeAt((g+32)%u.length)),g===0&&(m=h),h^=h<<10,h^=h>>>15,h^=h<<4,h^=h>>>13,g>=0&&(m=m+1640531527|0,d=y[g&127]^=h+m,p=d==0?p+1:0);for(p>=128&&(y[(u&&u.length||0)&127]=-1),p=127,g=512;g>0;--g)h=y[p+34&127],d=y[p=p+1&127],h^=h<<13,d^=d<<17,h^=h>>>15,d^=d>>>12,y[p]=h^d;f.w=m,f.X=y,f.i=p}c(l,s)}function a(s,l){return l.i=s.i,l.w=s.w,l.X=s.X.slice(),l}function o(s,l){s==null&&(s=+new Date);var c=new i(s),f=l&&l.state,u=function(){return(c.next()>>>0)/4294967296};return u.double=function(){do var d=c.next()>>>11,h=(c.next()>>>0)/4294967296,p=(d+h)/(1<<21);while(p===0);return p},u.int32=c.next,u.quick=u,f&&(f.X&&a(f,c),u.state=function(){return a(c,{})}),u}n&&n.exports?n.exports=o:this.xor4096=o})(bxe,t)})(jb)),jb.exports}var zb={exports:{}},Cxe=zb.exports,Fk;function Sxe(){return Fk||(Fk=1,(function(t){(function(e,n,r){function i(s){var l=this,c="";l.next=function(){var u=l.b,d=l.c,h=l.d,p=l.a;return u=u<<25^u>>>7^d,d=d-h|0,h=h<<24^h>>>8^p,p=p-u|0,l.b=u=u<<20^u>>>12^d,l.c=d=d-h|0,l.d=h<<16^d>>>16^p,l.a=p-u|0},l.a=0,l.b=0,l.c=-1640531527,l.d=1367130551,s===Math.floor(s)?(l.a=s/4294967296|0,l.b=s|0):c+=s;for(var f=0;f<c.length+20;f++)l.b^=c.charCodeAt(f)|0,l.next()}function a(s,l){return l.a=s.a,l.b=s.b,l.c=s.c,l.d=s.d,l}function o(s,l){var c=new i(s),f=l&&l.state,u=function(){return(c.next()>>>0)/4294967296};return u.double=function(){do var d=c.next()>>>11,h=(c.next()>>>0)/4294967296,p=(d+h)/(1<<21);while(p===0);return p},u.int32=c.next,u.quick=u,f&&(typeof f=="object"&&a(f,c),u.state=function(){return a(c,{})}),u}n&&n.exports?n.exports=o:this.tychei=o})(Cxe,t)})(zb)),zb.exports}var Wb={exports:{}};const Txe={},Exe=Object.freeze(Object.defineProperty({__proto__:null,default:Txe},Symbol.toStringTag,{value:"Module"})),Ff=jB(Exe);var _xe=Wb.exports,Uk;function Dxe(){return Uk||(Uk=1,(function(t){(function(e,n,r){var i=256,a=6,o=52,s="random",l=r.pow(i,a),c=r.pow(2,o),f=c*2,u=i-1,d;function h(w,S,T){var _=[];S=S==!0?{entropy:!0}:S||{};var D=y(m(S.entropy?[w,x(n)]:w??v(),3),_),I=new p(_),R=function(){for(var O=I.g(a),P=l,N=0;O<c;)O=(O+N)*i,P*=i,N=I.g(1);for(;O>=f;)O/=2,P/=2,N>>>=1;return(O+N)/P};return R.int32=function(){return I.g(4)|0},R.quick=function(){return I.g(4)/4294967296},R.double=R,y(x(I.S),n),(S.pass||T||function(O,P,N,A){return A&&(A.S&&g(A,I),O.state=function(){return g(I,{})}),N?(r[s]=O,P):O})(R,D,"global"in S?S.global:this==r,S.state)}function p(w){var S,T=w.length,_=this,D=0,I=_.i=_.j=0,R=_.S=[];for(T||(w=[T++]);D<i;)R[D]=D++;for(D=0;D<i;D++)R[D]=R[I=u&I+w[D%T]+(S=R[D])],R[I]=S;(_.g=function(O){for(var P,N=0,A=_.i,B=_.j,V=_.S;O--;)P=V[A=u&A+1],N=N*i+V[u&(V[A]=V[B=u&B+P])+(V[B]=P)];return _.i=A,_.j=B,N})(i)}function g(w,S){return S.i=w.i,S.j=w.j,S.S=w.S.slice(),S}function m(w,S){var T=[],_=typeof w,D;if(S&&_=="object")for(D in w)try{T.push(m(w[D],S-1))}catch{}return T.length?T:_=="string"?w:w+"\0"}function y(w,S){for(var T=w+"",_,D=0;D<T.length;)S[u&D]=u&(_^=S[u&D]*19)+T.charCodeAt(D++);return x(S)}function v(){try{var w;return d&&(w=d.randomBytes)?w=w(i):(w=new Uint8Array(i),(e.crypto||e.msCrypto).getRandomValues(w)),x(w)}catch{var S=e.navigator,T=S&&S.plugins;return[+new Date,e,T,e.screen,x(n)]}}function x(w){return String.fromCharCode.apply(0,w)}if(y(r.random(),n),t.exports){t.exports=h;try{d=Ff}catch{}}else r["seed"+s]=h})(typeof self<"u"?self:_xe,[],Math)})(Wb)),Wb.exports}var kE,Bk;function Oxe(){if(Bk)return kE;Bk=1;var t=hxe(),e=gxe(),n=vxe(),r=xxe(),i=wxe(),a=Sxe(),o=Dxe();return o.alea=t,o.xor128=e,o.xorwow=n,o.xorshift7=r,o.xor4096=i,o.tychei=a,kE=o,kE}var Mxe=Oxe();const Ixe=sl(Mxe),WD=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Rxe=[1,0,0,0,1,0,0,0,1],HD=1e-6,KD=1e-12,{vtkErrorMacro:Pq,vtkWarningMacro:Nh}=ce;let Aq=0;const $k=20;function My(t){return()=>Pq(`vtkMath::${t} - NOT IMPLEMENTED`)}function r2(t,e,n,r){let i;for(let a=0;a<e;a++)i=t[n*e+a],t[n*e+a]=t[r*e+a],t[r*e+a]=i}function Tv(t,e,n,r){let i;for(let a=0;a<e;a++)i=t[a*e+n],t[a*e+n]=t[a*e+r],t[a*e+r]=i}function ri(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:3;const e=Array(t);for(let n=0;n<t;++n)e[n]=0;return e}const Pxe=()=>Math.PI;function Axe(t,e){return e>1023?t*2**1023*2**(e-1023):e<-1074?t*2**-1074*2**(e+1074):t*2**e}function Di(t){return t/180*Math.PI}function Yw(t){return t*180/Math.PI}const{round:Ev,floor:qD,ceil:Nxe,min:Lxe,max:kxe}=Math;function Vxe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,r=1/0;for(let i=e,a=t.length;i<a;i+=n)t[i]<r&&(r=t[i]);return r}function Fxe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,r=-1/0;for(let i=e,a=t.length;i<a;i+=n)r<t[i]&&(r=t[i]);return r}function Uxe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,r=1/0,i=-1/0;for(let a=e,o=t.length;a<o;a+=n)t[a]<r&&(r=t[a]),i<t[a]&&(i=t[a]);return[r,i]}const Bxe=My("ceilLog2"),$xe=My("factorial");function Al(t){let e=1;for(;e<t;)e*=2;return e}function _v(t){return t===Al(t)}function Gxe(t,e){let n=1;for(let r=1;r<=e;++r)n*=(t-r+1)/r;return Math.floor(n)}function jxe(t,e){if(t<e)return 0;const n=ri(e);for(let r=0;r<e;++r)n[r]=r;return n}function zxe(t,e,n){let r=0;for(let i=e-1;i>=0;--i)if(n[i]<t-e+i){let a=n[i]+1;for(;i<e;)n[i++]=a++;r=1;break}return r}function Wxe(t){Ixe(`${t}`,{global:!0}),Aq=t}function Hxe(){return Aq}function Kxe(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;const n=(arguments.length>1&&arguments[1]!==void 0?arguments[1]:1)-t;return t+n*Math.random()}const qxe=My("gaussian");function Jw(t,e,n){return n[0]=t[0]+e[0],n[1]=t[1]+e[1],n[2]=t[2]+e[2],n}function Df(t,e,n){return n[0]=t[0]-e[0],n[1]=t[1]-e[1],n[2]=t[2]-e[2],n}function Nq(t,e){return t[0]*=e,t[1]*=e,t[2]*=e,t}function Lq(t,e){return t[0]*=e,t[1]*=e,t}function m_(t,e,n,r){return r[0]=t[0]+e[0]*n,r[1]=t[1]+e[1]*n,r[2]=t[2]+e[2]*n,r}function Xxe(t,e,n,r){return r[0]=t[0]+e[0]*n,r[1]=t[1]+e[1]*n,r}function An(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Yxe(t,e,n){n[0]=t[0]*e[0],n[1]=t[0]*e[1],n[2]=t[0]*e[2],n[3]=t[1]*e[0],n[4]=t[1]*e[1],n[5]=t[1]*e[2],n[6]=t[2]*e[0],n[7]=t[2]*e[1],n[8]=t[2]*e[2]}function yu(t,e,n){const r=t[1]*e[2]-t[2]*e[1],i=t[2]*e[0]-t[0]*e[2],a=t[0]*e[1]-t[1]*e[0];return n[0]=r,n[1]=i,n[2]=a,n}function Fd(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:3;switch(e){case 1:return Math.abs(t);case 2:return Math.sqrt(t[0]*t[0]+t[1]*t[1]);case 3:return Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);default:{let n=0;for(let r=0;r<e;r++)n+=t[r]*t[r];return Math.sqrt(n)}}}function Lh(t){const e=Fd(t);return e!==0&&(t[0]/=e,t[1]/=e,t[2]/=e),e}function Jxe(t,e,n,r){const i=t[0]*t[0],a=t[1]*t[1],o=t[2]*t[2],s=Math.sqrt(i+a+o);let l,c,f;i>a&&i>o?(l=0,c=1,f=2):a>o?(l=1,c=2,f=0):(l=2,c=0,f=1);const u=t[l]/s,d=t[c]/s,h=t[f]/s,p=Math.sqrt(u*u+h*h);if(r!==0){const g=Math.sin(r),m=Math.cos(r);e&&(e[l]=(h*m-u*d*g)/p,e[c]=g*p,e[f]=(-(u*m)-d*h*g)/p),n&&(n[l]=(-(h*g)-u*d*m)/p,n[c]=m*p,n[f]=(u*g-d*h*m)/p)}else e&&(e[l]=h/p,e[c]=0,e[f]=-u/p),n&&(n[l]=-u*d/p,n[c]=p,n[f]=-d*h/p)}function Zxe(t,e,n){const r=An(e,e);if(r===0)return n[0]=0,n[1]=0,n[2]=0,!1;const i=An(t,e)/r;for(let a=0;a<3;a++)n[a]=e[a];return Nq(n,i),!0}function v_(t,e){return t[0]*e[0]+t[1]*e[1]}function Qxe(t,e,n){const r=v_(e,e);if(r===0)return n[0]=0,n[1]=0,!1;const i=v_(t,e)/r;for(let a=0;a<2;a++)n[a]=e[a];return Lq(n,i),!0}function Jc(t,e){return(t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1])+(t[2]-e[2])*(t[2]-e[2])}function ebe(t,e){const n=[0,0,0];return yu(t,e,n),Math.atan2(Fd(n),An(t,e))}function tbe(t,e,n){const r=Math.abs(t-n);return 1/Math.sqrt(2*Math.PI*e)*Math.exp(-(r**2)/(2*e))}function nbe(t,e,n){const r=Math.abs(t-n);return Math.exp(-(r**2)/(2*e))}function rbe(t,e,n){n[0]=t[0]*e[0],n[1]=t[0]*e[1],n[2]=t[1]*e[0],n[3]=t[1]*e[1]}function kq(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function Vq(t){const e=kq(t);return e!==0&&(t[0]/=e,t[1]/=e),e}function Mi(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.length===2?e[0][0]*e[1][1]-e[1][0]*e[0][1]:e.length===4?e[0]*e[3]-e[1]*e[2]:Number.NaN}function ibe(t,e){let n,r,i;const a=[0,0,0];for(let o=0;o<3;o++)i=Math.abs(t[o*3]),(r=Math.abs(t[o*3+1]))>i&&(i=r),(r=Math.abs(t[o*3+2]))>i&&(i=r),a[o]=1/i;i=a[0]*Math.abs(t[0]),n=0,(r=a[1]*Math.abs(t[3]))>=i&&(i=r,n=1),(r=a[2]*Math.abs(t[6]))>=i&&(n=2),n!==0&&(r2(t,3,n,0),a[n]=a[0]),e[0]=n,t[3]/=t[0],t[6]/=t[0],t[4]-=t[3]*t[1],t[7]-=t[6]*t[1],i=a[1]*Math.abs(t[4]),n=1,(r=a[2]*Math.abs(t[7]))>=i&&(n=2,r2(t,3,1,2),a[2]=a[1]),e[1]=n,t[7]/=t[4],t[5]-=t[3]*t[2],t[8]-=t[6]*t[2]+t[7]*t[5],e[2]=2}function abe(t,e,n){let r=n[e[0]];n[e[0]]=n[0],n[0]=r,r=n[e[1]],n[e[1]]=n[1],n[1]=r-t[3]*n[0],r=n[e[2]],n[e[2]]=n[2],n[2]=r-t[6]*n[0]-t[7]*n[1],n[2]/=t[8],n[1]=(n[1]-t[5]*n[2])/t[4],n[0]=(n[0]-t[1]*n[1]-t[2]*n[2])/t[0]}function obe(t,e,n){const r=t[0],i=t[1],a=t[2],o=t[3],s=t[4],l=t[5],c=t[6],f=t[7],u=t[8],d=+Mi(s,f,l,u),h=-Mi(o,c,l,u),p=+Mi(o,c,s,f),g=-Mi(i,f,a,u),m=+Mi(r,c,a,u),y=-Mi(r,c,i,f),v=+Mi(i,s,a,l),x=-Mi(r,o,a,l),w=+Mi(r,o,i,s),S=r*d+i*h+a*p,T=d*e[0]+g*e[1]+v*e[2],_=h*e[0]+m*e[1]+x*e[2],D=p*e[0]+y*e[1]+w*e[2];n[0]=T/S,n[1]=_/S,n[2]=D/S}function Hb(t,e,n){const r=t[0]*e[0]+t[1]*e[1]+t[2]*e[2],i=t[3]*e[0]+t[4]*e[1]+t[5]*e[2],a=t[6]*e[0]+t[7]*e[1]+t[8]*e[2];n[0]=r,n[1]=i,n[2]=a}function y_(t,e,n){const r=[...t],i=[...e];for(let a=0;a<3;a++)n[a]=r[0]*i[a]+r[1]*i[a+3]+r[2]*i[a+6],n[a+3]=r[3]*i[a]+r[4]*i[a+3]+r[5]*i[a+6],n[a+6]=r[6]*i[a]+r[7]*i[a+3]+r[8]*i[a+6]}function sbe(t,e,n,r,i,a,o){r!==i&&Pq("Number of columns of A must match number of rows of B.");const s=[...t],l=[...e];for(let c=0;c<n;c++)for(let f=0;f<a;f++){o[c*a+f]=0;for(let u=0;u<r;u++)o[c*a+f]+=s[c*r+u]*l[f+a*u]}}function jg(t,e){let n;n=t[3],e[3]=t[1],e[1]=n,n=t[6],e[6]=t[2],e[2]=n,n=t[7],e[7]=t[5],e[5]=n,e[0]=t[0],e[4]=t[4],e[8]=t[8]}function lbe(t,e){const n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],s=t[5],l=t[6],c=t[7],f=t[8],u=+Mi(o,c,s,f),d=-Mi(a,l,s,f),h=+Mi(a,l,o,c),p=-Mi(r,c,i,f),g=+Mi(n,l,i,f),m=-Mi(n,l,r,c),y=+Mi(r,o,i,s),v=-Mi(n,a,i,s),x=+Mi(n,a,r,o),w=n*u+r*d+i*h;w===0&&Nh("Matrix has 0 determinant"),e[0]=u/w,e[3]=d/w,e[6]=h/w,e[1]=p/w,e[4]=g/w,e[7]=m/w,e[2]=y/w,e[5]=v/w,e[8]=x/w}function LC(t){return t[0]*t[4]*t[8]+t[3]*t[7]*t[2]+t[6]*t[1]*t[5]-t[0]*t[7]*t[5]-t[3]*t[1]*t[8]-t[6]*t[4]*t[2]}function Fq(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:HD;if(t.length!==e.length)return!1;function r(i,a){return Math.abs(i-e[a])<=n}return t.every(r)}const Iy=Fq;function Uq(t){for(let e=0;e<3;e++)t[e*3]=t[e*3+1]=t[e*3+2]=0,t[e*3+e]=1}function Bq(t,e){for(let n=0;n<t;n++){for(let r=0;r<t;r++)e[n*t+r]=0;e[n*t+n]=1}return e}function cbe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:HD;return Iy(t,WD,e)}function ube(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:HD;return Iy(t,Rxe,e)}function $q(t,e){const n=t[0]*t[0],r=t[0]*t[1],i=t[0]*t[2],a=t[0]*t[3],o=t[1]*t[1],s=t[2]*t[2],l=t[3]*t[3],c=t[1]*t[2],f=t[1]*t[3],u=t[2]*t[3],d=o+s+l;let h=1/(n+d);const p=(n-d)*h;h*=2,e[0]=o*h+p,e[3]=(c+a)*h,e[6]=(f-i)*h,e[1]=(c-a)*h,e[4]=s*h+p,e[7]=(u+r)*h,e[2]=(f+i)*h,e[5]=(u-r)*h,e[8]=l*h+p}function Kb(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(!`${t}`.includes("e"))return+`${Math.round(`${t}e+${e}`)}e-${e}`;const n=`${t}`.split("e");let r="";return+n[1]+e>0&&(r="+"),+`${Math.round(`${+n[0]}e${r}${+n[1]+e}`)}e-${e}`}function x_(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return e[0]=Kb(t[0],n),e[1]=Kb(t[1],n),e[2]=Kb(t[2],n),e}function Ry(t,e,n,r){let i,a,o,s,l,c,f,u,d,h,p,g,m,y,v,x;const w=ri(e),S=ri(e),T=(D,I,R)=>{y=D[I],m=D[R],D[I]=y-g*(m+y*h),D[R]=m+g*(y-m*h)};for(Bq(e,r),l=0;l<e;l++)w[l]=n[l]=t[l+l*e],S[l]=0;for(i=0;i<$k;i++){for(p=0,l=0;l<e-1;l++)for(s=l+1;s<e;s++)p+=Math.abs(t[l*e+s]);if(p===0)break;for(i<3?f=.2*p/(e*e):f=0,l=0;l<e-1;l++)for(s=l+1;s<e;s++)if(y=100*Math.abs(t[l*e+s]),i>3&&Math.abs(n[l])+y===Math.abs(n[l])&&Math.abs(n[s])+y===Math.abs(n[s]))t[l*e+s]=0;else if(Math.abs(t[l*e+s])>f){for(m=n[s]-n[l],Math.abs(m)+y===Math.abs(m)?d=t[l*e+s]/m:(u=.5*m/t[l*e+s],d=1/(Math.abs(u)+Math.sqrt(1+u*u)),u<0&&(d=-d)),v=1/Math.sqrt(1+d*d),g=d*v,h=g/(1+v),m=d*t[l*e+s],S[l]-=m,S[s]+=m,n[l]-=m,n[s]+=m,t[l*e+s]=0,a=0;a<=l-1;a++)T(t,a*e+l,a*e+s);for(a=l+1;a<=s-1;a++)T(t,l*e+a,a*e+s);for(a=s+1;a<e;a++)T(t,l*e+a,s*e+a);for(a=0;a<e;a++)T(r,a*e+l,a*e+s)}for(l=0;l<e;l++)w[l]+=S[l],n[l]=w[l],S[l]=0}if(i>=$k)return Nh("vtkMath::Jacobi: Error extracting eigenfunctions"),0;for(a=0;a<e-1;a++){for(o=a,x=n[o],i=a+1;i<e;i++)(n[i]>=x||Math.abs(n[i]-x)<KD)&&(o=i,x=n[o]);o!==a&&(n[o]=n[a],n[a]=x,Tv(r,e,a,o))}const _=(e>>1)+(e&1);for(c=0,i=0;i<e*e;i++)r[i]>=0&&c++;if(c<_)for(i=0;i<e;i++)r[i*e+a]*=-1;return 1}function Gq(t,e){const n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];n[0]=t[0]+t[4]+t[8],n[5]=t[0]-t[4]-t[8],n[10]=-t[0]+t[4]-t[8],n[15]=-t[0]-t[4]+t[8],n[1]=n[4]=t[7]-t[5],n[2]=n[8]=t[2]-t[6],n[3]=n[12]=t[3]-t[1],n[6]=n[9]=t[3]+t[1],n[7]=n[13]=t[2]+t[6],n[11]=n[14]=t[7]+t[5];const r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],i=[0,0,0,0],a=[...n];Ry(a,4,i,r),e[0]=r[0],e[1]=r[4],e[2]=r[8],e[3]=r[12]}function fbe(t,e,n){const r=t[0]*e[0],i=t[0]*e[1],a=t[0]*e[2],o=t[0]*e[3],s=t[1]*e[0],l=t[1]*e[1],c=t[1]*e[2],f=t[1]*e[3],u=t[2]*e[0],d=t[2]*e[1],h=t[2]*e[2],p=t[2]*e[3],g=t[3]*e[0],m=t[3]*e[1],y=t[3]*e[2],v=t[3]*e[3];n[0]=r-l-h-v,n[1]=i+s+p-y,n[2]=a-f+u+m,n[3]=o+c-d+g}function jq(t,e){for(let d=0;d<9;d++)e[d]=t[d];const n=ri(3),r=ri(3);let i;for(let d=0;d<3;d++){const h=Math.abs(e[d*3]),p=Math.abs(e[d*3+1]),g=Math.abs(e[d*3+2]);i=p>h?p:h,i=g>i?g:i,n[d]=1,i!==0&&(n[d]/=i)}const a=Math.abs(e[0])*n[0],o=Math.abs(e[3])*n[1],s=Math.abs(e[6])*n[2];r[0]=0,i=a,o>=i&&(i=o,r[0]=1),s>=i&&(r[0]=2),r[0]!==0&&(Tv(e,3,r[0],0),n[r[0]]=n[0]);const l=Math.abs(e[4])*n[1],c=Math.abs(e[7])*n[2];r[1]=1,i=l,c>=i&&(r[1]=2,Tv(e,3,1,2)),r[2]=2;let f=0;if(LC(e)<0){f=1;for(let d=0;d<9;d++)e[d]=-e[d]}const u=ri(4);if(Gq(e,u),$q(u,e),f)for(let d=0;d<9;d++)e[d]=-e[d];r[1]!==1&&Tv(e,3,r[1],1),r[0]!==0&&Tv(e,3,r[0],0)}function zq(t,e,n){let r,i,a,o,s,l;const c=[...t];if(Ry(c,3,e,n),e[0]===e[1]&&e[0]===e[2]){Uq(n);return}for(jg(n,n),r=0;r<3;r++)if(e[(r+1)%3]===e[(r+2)%3]){for(l=Math.abs(n[r*3]),o=0,i=1;i<3;i++)l<(s=Math.abs(n[r*3+i]))&&(l=s,o=i);o!==r&&(s=e[o],e[o]=e[r],e[r]=s,r2(n,3,r,o)),n[o*3+o]<0&&(n[o*3]=-n[o*3],n[o*3+1]=-n[o*3+1],n[o*3+2]=-n[o*3+2]),i=(o+1)%3,a=(o+2)%3,n[i*3]=0,n[i*3+1]=0,n[i*3+2]=0,n[i*3+i]=1;const f=yu([n[o*3],n[o*3+1],n[o*3+2]],[n[i*3],n[i*3+1],n[i*3+2]],[]);Lh(f);const u=yu(f,[n[o*3],n[o*3+1],n[o*3+2]],[]);for(let d=0;d<3;d++)n[a*3+d]=f[d],n[i*3+d]=u[d];jg(n,n);return}for(l=Math.abs(n[0]),o=0,r=1;r<3;r++)l<(s=Math.abs(n[r*3]))&&(l=s,o=r);if(o!==0){const f=e[o];e[o]=e[0],e[0]=f,r2(n,3,o,0)}if(Math.abs(n[4])<Math.abs(n[7])){const f=e[2];e[2]=e[1],e[1]=f,r2(n,3,1,2)}for(r=0;r<2;r++)n[r*3+r]<0&&(n[r*3]=-n[r*3],n[r*3+1]=-n[r*3+1],n[r*3+2]=-n[r*3+2]);LC(n)<0&&(n[6]=-n[6],n[7]=-n[7],n[8]=-n[8]),jg(n,n)}function dbe(t,e,n,r){let i;const a=[...t],o=LC(a);if(o<0)for(i=0;i<9;i++)a[i]=-a[i];jq(a,e),jg(a,a),y_(a,e,r),zq(r,n,r),y_(e,r,e),jg(r,r),o<0&&(n[0]=-n[0],n[1]=-n[1],n[2]=-n[2])}function XD(t,e,n){let r,i,a,o,s=0,l,c,f;const u=ri(n);for(r=0;r<n;r++){for(o=0,i=0;i<n;i++)(f=Math.abs(t[r*n+i]))>o&&(o=f);if(o===0)return Nh("Unable to factor linear system"),0;u[r]=1/o}for(i=0;i<n;i++){for(r=0;r<i;r++){for(l=t[r*n+i],a=0;a<r;a++)l-=t[r*n+a]*t[a*n+i];t[r*n+i]=l}for(o=0,r=i;r<n;r++){for(l=t[r*n+i],a=0;a<i;a++)l-=t[r*n+a]*t[a*n+i];t[r*n+i]=l,(c=u[r]*Math.abs(l))>=o&&(o=c,s=r)}if(i!==s){for(a=0;a<n;a++)c=t[s*n+a],t[s*n+a]=t[i*n+a],t[i*n+a]=c;u[s]=u[i]}if(e[i]=s,Math.abs(t[i*n+i])<=KD)return Nh("Unable to factor linear system"),0;if(i!==n-1)for(c=1/t[i*n+i],r=i+1;r<n;r++)t[r*n+i]*=c}return 1}function YD(t,e,n,r){let i,a,o,s,l;for(o=-1,i=0;i<r;i++){if(s=e[i],l=n[s],n[s]=n[i],o>=0)for(a=o;a<=i-1;a++)l-=t[i*r+a]*n[a];else l!==0&&(o=i);n[i]=l}for(i=r-1;i>=0;i--){for(l=n[i],a=i+1;a<r;a++)l-=t[i*r+a]*n[a];n[i]=l/t[i*r+i]}}function Wq(t,e,n){if(n===2){const i=ri(2),a=Mi(t[0],t[1],t[2],t[3]);return a===0?0:(i[0]=(t[3]*e[0]-t[1]*e[1])/a,i[1]=(-(t[2]*e[0])+t[0]*e[1])/a,e[0]=i[0],e[1]=i[1],1)}if(n===1)return t[0]===0?0:(e[0]/=t[0],1);const r=ri(n);return XD(t,r,n)===0?0:(YD(t,r,e,n),1)}function Hq(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null;const a=r||ri(n),o=i||ri(n);if(XD(t,a,n)===0)return null;for(let s=0;s<n;s++){for(let l=0;l<n;l++)o[l]=0;o[s]=1,YD(t,a,o,n);for(let l=0;l<n;l++)e[l*n+s]=o[l]}return e}function hbe(t,e){let n=+Number.MAX_VALUE,r=-Number.MAX_VALUE;for(let i=0;i<e;i++)for(let a=i;a<e;a++)Math.abs(t[i*e+a])>r&&(r=Math.abs(t[i*e+a]));for(let i=0;i<e;i++)Math.abs(t[i*e+i])<n&&(n=Math.abs(t[i*e+i]));return n===0?Number.MAX_VALUE:r/n}function pbe(t,e,n){return Ry(t,3,e,n)}function b_(t,e,n,r){if(t<n)return Nh("Insufficient number of samples. Underdetermined."),0;let i,a,o;const s=ri(n*n),l=ri(n),c=ri(n*n);for(o=0;o<t;o++)for(i=0;i<n;i++)for(a=i;a<n;a++)s[i*n+a]+=e[o*n+i]*e[o*n+a];for(i=0;i<n;i++)for(a=0;a<i;a++)s[i*n+a]=s[a*n+i];for(Ry(s,n,l,c),i=0;i<n;i++)r[i]=c[i*n+n-1];return 1}function gbe(t,e,n,r,i,a){let o=arguments.length>6&&arguments[6]!==void 0?arguments[6]:!0;if(t<n||t<i)return Nh("Insufficient number of samples. Underdetermined."),0;const s=ri(i);let l=1,c,f=0,u,d,h,p=0;if(o){for(d=0;d<i;d++)s[d]=1;for(u=0;u<t;u++)for(d=0;d<i;d++)Math.abs(r[u*i+d])>KD&&(l=0,s[d]=0);if(l&&i===1)return Nh("Detected homogeneous system (Y=0), calling SolveHomogeneousLeastSquares()"),b_(t,e,n,a);if(l)p=1;else for(d=0;d<i;d++)s[d]&&(p=1)}p&&(c=ri(n),f=b_(t,e,n,c));const g=ri(n*n),m=ri(n*n),y=ri(n*i);for(h=0;h<t;h++)for(u=0;u<n;u++){for(d=u;d<n;d++)g[u*n+d]+=e[h*n+u]*e[h*n+d];for(d=0;d<i;d++)y[u*i+d]+=e[h*n+u]*r[h*i+d]}for(u=0;u<n;u++)for(d=0;d<u;d++)g[u*n+d]=g[d*n+u];const v=Hq(g,m,n);if(v)for(u=0;u<n;u++)for(d=0;d<i;d++)for(a[u*i+d]=0,h=0;h<n;h++)a[u*i+d]+=m[u*n+h]*y[h*i+d];if(p){for(d=0;d<i;d++)if(s[d])for(u=0;u<n;u++)a[u*i+d]=c[u*i]}return p?f&&v:v}function mbe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,.5,1];switch(t.length){case 3:return e[0]=parseInt(t[0],16)*17/255,e[1]=parseInt(t[1],16)*17/255,e[2]=parseInt(t[2],16)*17/255,e;case 4:return e[0]=parseInt(t[1],16)*17/255,e[1]=parseInt(t[2],16)*17/255,e[2]=parseInt(t[3],16)*17/255,e;case 6:return e[0]=parseInt(t.substr(0,2),16)/255,e[1]=parseInt(t.substr(2,2),16)/255,e[2]=parseInt(t.substr(4,2),16)/255,e;case 7:return e[0]=parseInt(t.substr(1,2),16)/255,e[1]=parseInt(t.substr(3,2),16)/255,e[2]=parseInt(t.substr(5,2),16)/255,e;case 9:return e[0]=parseInt(t.substr(1,2),16)/255,e[1]=parseInt(t.substr(3,2),16)/255,e[2]=parseInt(t.substr(5,2),16)/255,e[3]=parseInt(t.substr(7,2),16)/255,e;default:return e}}function Dv(t,e){let n,r;const[i,a,o]=t,s=1/3,l=1/6,c=2/3;let f=i,u=i;a>f?f=a:a<u&&(u=a),o>f?f=o:o<u&&(u=o);const d=f;d>0?r=(f-u)/f:r=0,r>0?(i===f?n=l*(a-o)/(f-u):a===f?n=s+l*(o-i)/(f-u):n=c+l*(i-a)/(f-u),n<0&&(n+=1)):n=0,e[0]=n,e[1]=r,e[2]=d}function eh(t,e){const[n,r,i]=t,a=1/3,o=1/6,s=2/3,l=5/6;let c,f,u;n>o&&n<=a?(f=1,c=(a-n)/o,u=0):n>a&&n<=.5?(f=1,u=(n-a)/o,c=0):n>.5&&n<=s?(u=1,f=(s-n)/o,c=0):n>s&&n<=l?(u=1,c=(n-s)/o,f=0):n>l&&n<=1?(c=1,u=(1-n)/o,f=0):(c=1,f=n/o,u=0),c=r*c+(1-r),f=r*f+(1-r),u=r*u+(1-r),c*=i,f*=i,u*=i,e[0]=c,e[1]=f,e[2]=u}function Kq(t,e){const[n,r,i]=t;let a=(n+16)/116,o=r/500+a,s=a-i/200;a**3>.008856?a**=3:a=(a-16/116)/7.787,o**3>.008856?o**=3:o=(o-16/116)/7.787,s**3>.008856?s**=3:s=(s-16/116)/7.787;const l=.9505,c=1,f=1.089;e[0]=l*o,e[1]=c*a,e[2]=f*s}function qq(t,e){const[n,r,i]=t,a=.9505,o=1,s=1.089;let l=n/a,c=r/o,f=i/s;l>.008856?l**=1/3:l=7.787*l+16/116,c>.008856?c**=1/3:c=7.787*c+16/116,f>.008856?f**=1/3:f=7.787*f+16/116,e[0]=116*c-16,e[1]=500*(l-c),e[2]=200*(c-f)}function Xq(t,e){const[n,r,i]=t;let a=n*3.2406+r*-1.5372+i*-.4986,o=n*-.9689+r*1.8758+i*.0415,s=n*.0557+r*-.204+i*1.057;a>.0031308?a=1.055*a**(1/2.4)-.055:a*=12.92,o>.0031308?o=1.055*o**(1/2.4)-.055:o*=12.92,s>.0031308?s=1.055*s**(1/2.4)-.055:s*=12.92;let l=a;l<o&&(l=o),l<s&&(l=s),l>1&&(a/=l,o/=l,s/=l),a<0&&(a=0),o<0&&(o=0),s<0&&(s=0),e[0]=a,e[1]=o,e[2]=s}function Yq(t,e){let[n,r,i]=t;n>.04045?n=((n+.055)/1.055)**2.4:n/=12.92,r>.04045?r=((r+.055)/1.055)**2.4:r/=12.92,i>.04045?i=((i+.055)/1.055)**2.4:i/=12.92,e[0]=n*.4124+r*.3576+i*.1805,e[1]=n*.2126+r*.7152+i*.0722,e[2]=n*.0193+r*.1192+i*.9505}function fh(t,e){const n=[0,0,0];Yq(t,n),qq(n,e)}function Zw(t,e){const n=[0,0,0];Kq(t,n),Xq(n,e)}function jm(t){return t[0]=1,t[1]=-1,t[2]=1,t[3]=-1,t[4]=1,t[5]=-1,t}function qb(t){return!(t[1]-t[0]<0)}function vbe(t,e,n){return n[0]=Math.min(t[0],e[0]),n[1]=Math.max(t[0],e[0]),n[2]=Math.min(t[1],e[1]),n[3]=Math.max(t[1],e[1]),n[4]=Math.min(t[2],e[2]),n[5]=Math.max(t[2],e[2]),n}function xc(t,e,n){return t<e?e:t>n?n:t}function w_(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[0,0,0];return r[0]=xc(t[0],e[0],n[0]),r[1]=xc(t[1],e[1],n[1]),r[2]=xc(t[2],e[2],n[2]),r}function ybe(t,e){let n=0;return e[0]!==e[1]&&(t<e[0]?n=e[0]:t>e[1]?n=e[1]:n=t,n=(n-e[0])/(e[1]-e[0])),n}const xbe=My("GetScalarTypeFittingRange"),bbe=My("GetAdjustedScalarRange");function wbe(t,e){if(!t||!e)return 0;for(let n=0;n<6;n+=2)if(t[n]<e[n]||t[n]>e[n+1]||t[n+1]<e[n]||t[n+1]>e[n+1])return 0;return 1}function Cbe(t,e,n){if(!t||!e)return 0;for(let r=0;r<6;r+=2)if(t[r]+n[r/2]<e[r]||t[r]-n[r/2]>e[r+1]||t[r+1]+n[r/2]<e[r]||t[r+1]-n[r/2]>e[r+1])return 0;return 1}function Sbe(t,e,n){if(!t||!e||!n)return 0;for(let r=0;r<3;r++)if(t[r]+n[r]<e[2*r]||t[r]-n[r]>e[2*r+1])return 0;return 1}function Tbe(t,e,n,r){const i=ri(3),a=ri(3),o=ri(3),s=ri(3),l=ri(3),c=ri(3);for(let w=0;w<3;++w)i[w]=t[w]-e[w],a[w]=e[w]-n[w],o[w]=n[w]-t[w],s[w]=-i[w],l[w]=-a[w],c[w]=-o[w];const f=Fd(s),u=Fd(l),d=Fd(o),h=ri(3);yu(i,a,h);const p=Fd(h),g=f*u*d/(2*p),m=2*p*p,y=u*u*An(i,c)/m,v=d*d*An(s,a)/m,x=f*f*An(o,l)/m;for(let w=0;w<3;++w)r[w]=y*t[w]+v*e[w]+x*n[w];return g}const Ebe=1/0,_be=-1/0,Jq=t=>!Number.isFinite(t),{isFinite:Dbe,isNaN:C_}=Number,Qw=C_;function n0(){return[].concat([Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE])}function Obe(t){let e=-1,n=-1;for(let r=0;r<t.length;r++){const i=Math.abs(t[r]);i>e&&(n=r,e=i)}return n}function Zq(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:3;const n=new Array(e),r=new Array(e);for(let a=0;a<e;++a)n[a]=a,r[a]=a;for(let a=e-1;a>0;a--){let o=-1/0,s=0,l=0;for(let c=0;c<=a;++c){const f=n[c];for(let u=0;u<=a;++u){const d=r[u],h=Math.abs(t[f+e*d]);h>o&&(o=h,s=c,l=u)}}[n[a],n[s]]=[n[s],n[a]],[r[a],r[l]]=[r[l],r[a]]}const i=new Array(e*e).fill(0);for(let a=0;a<e;++a){const o=n[a]+e*r[a];i[o]=t[o]<0?-1:1}return i}function Qq(t){const e=Math.floor(t*255);return e>15?e.toString(16):`0${e.toString(16)}`}function Mbe(t){return`${arguments.length>1&&arguments[1]!==void 0?arguments[1]:"#"}${t.map(Qq).join("")}`}function Px(t){return Math.round(t*255)}function Ibe(t){return t.length===3?`rgb(${t.map(Px).join(", ")})`:`rgba(${Px(t[0]||0)}, ${Px(t[1]||0)}, ${Px(t[2]||0)}, ${t[3]||0})`}var Zs={Pi:Pxe,ldexp:Axe,radiansFromDegrees:Di,degreesFromRadians:Yw,round:Ev,floor:qD,ceil:Nxe,ceilLog2:Bxe,min:Lxe,max:kxe,arrayMin:Vxe,arrayMax:Fxe,arrayRange:Uxe,isPowerOfTwo:_v,nearestPowerOfTwo:Al,factorial:$xe,binomial:Gxe,beginCombination:jxe,nextCombination:zxe,randomSeed:Wxe,getSeed:Hxe,random:Kxe,gaussian:qxe,add:Jw,subtract:Df,multiplyScalar:Nq,multiplyScalar2D:Lq,multiplyAccumulate:m_,multiplyAccumulate2D:Xxe,dot:An,outer:Yxe,cross:yu,norm:Fd,normalize:Lh,perpendiculars:Jxe,projectVector:Zxe,projectVector2D:Qxe,distance2BetweenPoints:Jc,angleBetweenVectors:ebe,gaussianAmplitude:tbe,gaussianWeight:nbe,dot2D:v_,outer2D:rbe,norm2D:kq,normalize2D:Vq,determinant2x2:Mi,LUFactor3x3:ibe,LUSolve3x3:abe,linearSolve3x3:obe,multiply3x3_vect3:Hb,multiply3x3_mat3:y_,multiplyMatrix:sbe,transpose3x3:jg,invert3x3:lbe,identity3x3:Uq,identity:Bq,isIdentity:cbe,isIdentity3x3:ube,determinant3x3:LC,quaternionToMatrix3x3:$q,areEquals:Fq,areMatricesEqual:Iy,roundNumber:Kb,roundVector:x_,matrix3x3ToQuaternion:Gq,multiplyQuaternion:fbe,orthogonalize3x3:jq,diagonalize3x3:zq,singularValueDecomposition3x3:dbe,solveLinearSystem:Wq,invertMatrix:Hq,luFactorLinearSystem:XD,luSolveLinearSystem:YD,estimateMatrixCondition:hbe,jacobi:pbe,jacobiN:Ry,solveHomogeneousLeastSquares:b_,solveLeastSquares:gbe,hex2float:mbe,rgb2hsv:Dv,hsv2rgb:eh,lab2xyz:Kq,xyz2lab:qq,xyz2rgb:Xq,rgb2xyz:Yq,rgb2lab:fh,lab2rgb:Zw,uninitializeBounds:jm,areBoundsInitialized:qb,computeBoundsFromPoints:vbe,clampValue:xc,clampVector:w_,clampAndNormalizeValue:ybe,getScalarTypeFittingRange:xbe,getAdjustedScalarRange:bbe,extentIsWithinOtherExtent:wbe,boundsIsWithinOtherBounds:Cbe,pointIsWithinBounds:Sbe,solve3PointCircle:Tbe,inf:Ebe,negInf:_be,isInf:Jq,isNan:C_,isNaN:C_,isFinite:Dbe,createUninitializedBounds:n0,getMajorAxisIndex:Obe,getSparseOrthogonalMatrix:Zq,floatToHex2:Qq,floatRGB2HexCode:Mbe,float2CssRGBA:Ibe};const eX={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},Ln={VOID:"",CHAR:"Int8Array",SIGNED_CHAR:"Int8Array",UNSIGNED_CHAR:"Uint8Array",UNSIGNED_CHAR_CLAMPED:"Uint8ClampedArray",SHORT:"Int16Array",UNSIGNED_SHORT:"Uint16Array",INT:"Int32Array",UNSIGNED_INT:"Uint32Array",FLOAT:"Float32Array",DOUBLE:"Float64Array"},Rbe=Ln.FLOAT;var tX={DefaultDataType:Rbe,DataTypeByteSize:eX,VtkDataTypes:Ln};const{vtkErrorMacro:Pbe}=wo,{DefaultDataType:Abe}=tX,Nbe=1e-6;function S_(t,e,n){const r=t.length;let i=Number.MAX_VALUE,a=-Number.MAX_VALUE,o,s;for(s=e;s<r;s+=n)if(!Number.isNaN(t[s])){i=t[s],a=i;break}for(;s<r;s+=n)o=t[s],o<i?i=o:o>a&&(a=o);return{min:i,max:a}}function Lbe(){let t=Number.MAX_VALUE,e=-Number.MAX_VALUE,n=0,r=0;return{add(i){t>i&&(t=i),e<i&&(e=i),n++,r+=i},get(){return{min:t,max:e,count:n,sum:r,mean:r/n}},getRange(){return{min:t,max:e}}}}function nX(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;if(e<0&&n>1){const i=t.length/n,a=new Float64Array(i);for(let o=0,s=0;o<i;++o){for(let l=s+n;s<l;++s)a[o]+=t[s]*t[s];a[o]**=.5}return S_(a,0,1)}return S_(t,e<0?0:e,n)}function Gk(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const n=t||[];for(;n.length<=e;)n.push(null);return n}function JD(t){return Object.prototype.toString.call(t).slice(8,-1)}function kbe(t){const e=t.getNumberOfComponents();let n=0;const r=new Array(e);for(let i=0;i<t.getNumberOfTuples();++i){t.getTuple(i,r);const a=Fd(r,e);a>n&&(n=a)}return n}const Vbe={computeRange:nX,createRangeHelper:Lbe,fastComputeRange:S_,getDataType:JD,getMaxNorm:kbe};function Fbe(t,e){e.classHierarchy.push("vtkDataArray");function n(r){if(r<0)return!1;const i=t.getNumberOfComponents(),a=e.values.length/(i>0?i:1);if(r===a)return!0;if(r>a){const o=e.values;return e.values=$m(e.dataType,(r+a)*i),e.values.set(o),!0}return e.size>r*i&&(e.size=r*i,t.dataChange()),!0}t.dataChange=()=>{e.ranges=null,t.modified()},t.resize=r=>{n(r);const i=r*t.getNumberOfComponents();return e.size!==i?(e.size=i,t.dataChange(),!0):!1},t.initialize=()=>{t.resize(0)},t.getElementComponentSize=()=>e.values.BYTES_PER_ELEMENT,t.getComponent=function(r){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return e.values[r*e.numberOfComponents+i]},t.setComponent=(r,i,a)=>{a!==e.values[r*e.numberOfComponents+i]&&(e.values[r*e.numberOfComponents+i]=a,t.dataChange())},t.getValue=r=>{const i=r/e.numberOfComponents,a=r%e.numberOfComponents;return t.getComponent(i,a)},t.setValue=(r,i)=>{const a=r/e.numberOfComponents,o=r%e.numberOfComponents;t.setComponent(a,o,i)},t.getData=()=>e.size===e.values.length?e.values:e.values.subarray(0,e.size),t.getRange=function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:-1,i=r;i<0&&(i=e.numberOfComponents===1?0:e.numberOfComponents);let a=null;return e.ranges||(e.ranges=Gk(e.ranges,e.numberOfComponents)),a=e.ranges[i],a?(e.rangeTuple[0]=a.min,e.rangeTuple[1]=a.max,e.rangeTuple):(a=nX(t.getData(),r,e.numberOfComponents),e.ranges[i]=a,e.rangeTuple[0]=a.min,e.rangeTuple[1]=a.max,e.rangeTuple)},t.setRange=(r,i)=>{e.ranges||(e.ranges=Gk(e.ranges,e.numberOfComponents));const a={min:r.min,max:r.max};return e.ranges[i]=a,e.rangeTuple[0]=a.min,e.rangeTuple[1]=a.max,e.rangeTuple},t.getRanges=function(){if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0))return structuredClone(e.ranges);const i=[];for(let a=0;a<e.numberOfComponents;a++){const[o,s]=t.getRange(a),l={min:o,max:s};i.push(l)}if(e.numberOfComponents>1){const[a,o]=t.getRange(-1),s={min:a,max:o};i.push(s)}return i},t.setTuple=(r,i)=>{const a=r*e.numberOfComponents;for(let o=0;o<e.numberOfComponents;o++)e.values[a+o]=i[o]},t.setTuples=(r,i)=>{let a=r*e.numberOfComponents;const o=Math.min(i.length,e.size-a);for(let s=0;s<o;)e.values[a++]=i[s++]},t.insertTuple=(r,i)=>(e.size<=r*e.numberOfComponents&&(e.size=(r+1)*e.numberOfComponents,n(r+1)),t.setTuple(r,i),r),t.insertTuples=(r,i)=>{const a=r+i.length/e.numberOfComponents;return e.size<a*e.numberOfComponents&&(e.size=a*e.numberOfComponents,n(a)),t.setTuples(r,i),a},t.insertNextTuple=r=>{const i=e.size/e.numberOfComponents;return t.insertTuple(i,r)},t.insertNextTuples=r=>{const i=e.size/e.numberOfComponents;return t.insertTuples(i,r)},t.findTuple=function(r){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Nbe;for(let a=0;a<e.size;a+=e.numberOfComponents)if(Math.abs(r[0]-e.values[a])<=i){let o=!0;for(let s=1;s<e.numberOfComponents;++s)if(Math.abs(r[s]-e.values[a+s])>i){o=!1;break}if(o)return a/e.numberOfComponents}return-1},t.getTuple=function(r){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const a=e.numberOfComponents||1,o=r*a;switch(a){case 4:i[3]=e.values[o+3];case 3:i[2]=e.values[o+2];case 2:i[1]=e.values[o+1];case 1:i[0]=e.values[o];break;default:for(let s=a-1;s>=0;--s)i[s]=e.values[o+s]}return i},t.getTuples=(r,i)=>{const a=(r??0)*e.numberOfComponents,o=(i??t.getNumberOfTuples())*e.numberOfComponents,s=t.getData().subarray(a,o);return s.length>0?s:null},t.getTupleLocation=function(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:1)*e.numberOfComponents},t.getNumberOfComponents=()=>e.numberOfComponents,t.getNumberOfValues=()=>e.size,t.getNumberOfTuples=()=>e.size/e.numberOfComponents,t.getDataType=()=>e.dataType,t.newClone=()=>iX({empty:!0,name:e.name,dataType:e.dataType,numberOfComponents:e.numberOfComponents}),t.getName=()=>(e.name||(t.modified(),e.name=`vtkDataArray${t.getMTime()}`),e.name),t.setData=(r,i)=>{e.values=r,e.size=r.length,e.dataType=JD(r),i&&(e.numberOfComponents=i),e.size%e.numberOfComponents!==0&&(e.numberOfComponents=1),t.dataChange()},t.getState=()=>{if(e.deleted)return null;const r={...e,vtkClass:t.getClassName()};r.values=Array.from(r.values),delete r.buffer,Object.keys(r).forEach(a=>{r[a]||delete r[a]});const i={};return Object.keys(r).sort().forEach(a=>{i[a]=r[a]}),i.mtime&&delete i.mtime,i},t.deepCopy=r=>{const i=t.getDataType(),a=e.values;t.shallowCopy(r),e.ranges=structuredClone(r.getRanges()),a?.length>=r.getNumberOfValues()&&i===r.getDataType()?(a.set(r.getData()),e.values=a,t.dataChange()):t.setData(r.getData().slice())},t.interpolateTuple=(r,i,a,o,s,l)=>{const c=e.numberOfComponents||1;(c!==i.getNumberOfComponents()||c!==o.getNumberOfComponents())&&Pbe("numberOfComponents must match");const f=i.getTuple(a),u=o.getTuple(s),d=[];switch(d.length=c,c){case 4:d[3]=f[3]+(u[3]-f[3])*l;case 3:d[2]=f[2]+(u[2]-f[2])*l;case 2:d[1]=f[1]+(u[1]-f[1])*l;case 1:d[0]=f[0]+(u[0]-f[0])*l;break;default:for(let h=0;h<c;h++)d[h]=f[h]+(u[h]-f[h])*l}return t.insertTuple(r,d)}}const Ube={name:"",numberOfComponents:1,dataType:Abe,rangeTuple:[0,0]};function rX(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(Object.assign(e,Ube,n),Array.isArray(n.values)&&n.dataType===void 0&&console.warn("vtkDataArray.newInstance: no dataType provided, converting to Float32Array"),!e.empty&&!e.values&&!e.size)throw new TypeError("Cannot create vtkDataArray object without: size > 0, values");if(e.values?Array.isArray(e.values)&&(e.values=AC(e.dataType,e.values)):e.values=$m(e.dataType,e.size),e.values&&(e.size=e.size??e.values.length,e.dataType=JD(e.values)),Wr(t,e),_y(t,e,["name","numberOfComponents"]),e.size%e.numberOfComponents!==0)throw new RangeError("model.size is not a multiple of model.numberOfComponents");Fbe(t,e)}const iX=Qn(rX,"vtkDataArray");var tn={newInstance:iX,extend:rX,...Vbe,...tX};const Bbe={MAGNITUDE:0,COMPONENT:1,RGBCOLORS:2},T_={LUMINANCE:1,LUMINANCE_ALPHA:2,RGB:3,RGBA:4};var ZD={VectorMode:Bbe,ScalarMappingTarget:T_};const $be={DEFAULT:0,MAP_SCALARS:1,DIRECT_SCALARS:2},Gbe={DEFAULT:0,USE_POINT_DATA:1,USE_CELL_DATA:2,USE_POINT_FIELD_DATA:3,USE_CELL_FIELD_DATA:4,USE_FIELD_DATA:5},jbe={BY_ID:0,BY_NAME:1};var kC={ColorMode:$be,GetArray:jbe,ScalarMode:Gbe};const{ScalarMappingTarget:jk,VectorMode:Xc}=ZD,{VtkDataTypes:md}=tn,{ColorMode:Ax}=kC,{vtkErrorMacro:zk}=ce;function zbe(t){return t}function Wk(t){return Math.floor(t*255+.5)}function Wbe(t,e){e.classHierarchy.push("vtkScalarsToColors"),t.setVectorModeToMagnitude=()=>t.setVectorMode(Xc.MAGNITUDE),t.setVectorModeToComponent=()=>t.setVectorMode(Xc.COMPONENT),t.setVectorModeToRGBColors=()=>t.setVectorMode(Xc.RGBCOLORS),t.build=()=>{},t.isOpaque=()=>!0,t.setAnnotations=(n,r)=>{if(!(n&&!r||!n&&r)){if(n&&r&&n.length!==r.length){zk("Values and annotations do not have the same number of tuples so ignoring");return}if(e.annotationArray=[],r&&n){const i=r.length;for(let a=0;a<i;a++)e.annotationArray.push({value:n[a],annotation:String(r[a])})}t.updateAnnotatedValueMap(),t.modified()}},t.setAnnotation=(n,r)=>{let i=t.checkForAnnotatedValue(n),a=!1;return i>=0?e.annotationArray[i].annotation!==r&&(e.annotationArray[i].annotation=r,a=!0):(e.annotationArray.push({value:n,annotation:r}),i=e.annotationArray.length-1,a=!0),a&&(t.updateAnnotatedValueMap(),t.modified()),i},t.getNumberOfAnnotatedValues=()=>e.annotationArray.length,t.getAnnotatedValue=n=>n<0||n>=e.annotationArray.length?null:e.annotationArray[n].value,t.getAnnotation=n=>e.annotationArray[n]===void 0?null:e.annotationArray[n].annotation,t.getAnnotatedValueIndex=n=>e.annotationArray.length?t.checkForAnnotatedValue(n):-1,t.removeAnnotation=n=>{const r=t.checkForAnnotatedValue(n),i=r>=0;return i&&(e.annotationArray.splice(r,1),t.updateAnnotatedValueMap(),t.modified()),i},t.resetAnnotations=()=>{e.annotationArray=[],e.annotatedValueMap=[],t.modified()},t.getAnnotationColor=(n,r)=>{if(e.indexedLookup){const i=t.getAnnotatedValueIndex(n);t.getIndexedColor(i,r)}else t.getColor(parseFloat(n),r),r[3]=1},t.checkForAnnotatedValue=n=>t.getAnnotatedValueIndexInternal(n),t.getAnnotatedValueIndexInternal=n=>{if(e.annotatedValueMap[n]!==void 0){const r=e.annotationArray.length;return e.annotatedValueMap[n]%r}return-1},t.getIndexedColor=(n,r)=>{r[0]=0,r[1]=0,r[2]=0,r[3]=0},t.updateAnnotatedValueMap=()=>{e.annotatedValueMap=[];const n=e.annotationArray.length;for(let r=0;r<n;r++)e.annotatedValueMap[e.annotationArray[r].value]=r},t.mapScalars=(n,r,i)=>{const a=n.getNumberOfComponents();let o=null;if(r===Ax.DEFAULT&&(n.getDataType()===md.UNSIGNED_CHAR||n.getDataType()===md.UNSIGNED_CHAR_CLAMPED)||r===Ax.DIRECT_SCALARS&&n)o=t.convertToRGBA(n,a,n.getNumberOfTuples());else{const s={type:"vtkDataArray",name:"temp",numberOfComponents:4,dataType:md.UNSIGNED_CHAR},l=ce.newTypedArray(s.dataType,4*n.getNumberOfTuples());s.values=l,s.size=l.length,o=tn.newInstance(s);let c=i;c<0&&a>1?t.mapVectorsThroughTable(n,o,jk.RGBA,-1,-1):(c<0&&(c=0),c>=a&&(c=a-1),t.mapScalarsThroughTable(n,o,jk.RGBA,c))}return o},t.mapVectorsToMagnitude=(n,r,i)=>{const a=n.getNumberOfTuples(),o=n.getNumberOfComponents(),s=r.getData(),l=n.getData();for(let c=0;c<a;c++){let f=0;for(let u=0;u<i;u++)f+=l[c*o+u]*l[c*o+u];s[c]=Math.sqrt(f)}},t.mapVectorsThroughTable=(n,r,i,a,o)=>{let s=t.getVectorMode(),l=o,c=a;const f=n.getNumberOfComponents();s===Xc.COMPONENT?(c===-1&&(c=t.getVectorComponent()),c<0&&(c=0),c>=f&&(c=f-1)):(l===-1&&(l=t.getVectorSize()),l<=0?(c=0,l=f):(c<0&&(c=0),c>=f&&(c=f-1),c+l>f&&(l=f-c)),s===Xc.MAGNITUDE&&(f===1||l===1)&&(s=Xc.COMPONENT));let u=0;switch(c>0&&(u=c),s){case Xc.COMPONENT:{t.mapScalarsThroughTable(n,r,i,u);break}case Xc.RGBCOLORS:break;case Xc.MAGNITUDE:default:{const d=tn.newInstance({numberOfComponents:1,values:new Float32Array(n.getNumberOfTuples())});t.mapVectorsToMagnitude(n,d,l),t.mapScalarsThroughTable(d,r,i,0);break}}},t.luminanceToRGBA=(n,r,i,a)=>{const o=a(i),s=r.getData(),l=n.getData(),c=s.length,f=0,u=1;let d=0;for(let h=f;h<c;h+=u){const p=a(s[h]);l[d*4]=p,l[d*4+1]=p,l[d*4+2]=p,l[d*4+3]=o,d++}},t.luminanceAlphaToRGBA=(n,r,i,a)=>{const o=r.getData(),s=n.getData(),l=o.length,c=0,f=2;let u=0;for(let d=c;d<l;d+=f){const h=a(o[d]);s[u]=h,s[u+1]=h,s[u+2]=h,s[u+3]=a(o[d+1])*i,u+=4}},t.rGBToRGBA=(n,r,i,a)=>{const o=Wk(i),s=r.getData(),l=n.getData(),c=s.length,f=0,u=3;let d=0;for(let h=f;h<c;h+=u)l[d*4]=a(s[h]),l[d*4+1]=a(s[h+1]),l[d*4+2]=a(s[h+2]),l[d*4+3]=o,d++},t.rGBAToRGBA=(n,r,i,a)=>{const o=r.getData(),s=n.getData(),l=o.length,c=0,f=4;let u=0;for(let d=c;d<l;d+=f)s[u*4]=a(o[d]),s[u*4+1]=a(o[d+1]),s[u*4+2]=a(o[d+2]),s[u*4+3]=a(o[d+3])*i,u++},t.convertToRGBA=(n,r,i)=>{let{alpha:a}=e;if(r===4&&a>=1&&n.getDataType()===md.UNSIGNED_CHAR)return n;const o=tn.newInstance({numberOfComponents:4,empty:!0,size:4*i,dataType:md.UNSIGNED_CHAR});if(i<=0)return o;a=a>0?a:0,a=a<1?a:1;let s=zbe;switch((n.getDataType()===md.FLOAT||n.getDataType()===md.DOUBLE)&&(s=Wk),r){case 1:t.luminanceToRGBA(o,n,a,s);break;case 2:t.luminanceAlphaToRGBA(o,n,s);break;case 3:t.rGBToRGBA(o,n,a,s);break;case 4:t.rGBAToRGBA(o,n,a,s);break;default:return zk("Cannot convert colors"),null}return o},t.usingLogScale=()=>!1,t.getNumberOfAvailableColors=()=>256*256*256,t.setRange=(n,r)=>t.setMappingRange(n,r),t.getRange=()=>t.getMappingRange(),t.areScalarsOpaque=(n,r,i)=>{if(!n)return t.isOpaque();const a=n.getNumberOfComponents();return r===Ax.DEFAULT&&n.getDataType()===md.UNSIGNED_CHAR||r===Ax.DIRECT_SCALARS?a===3||a===1?e.alpha>=1:n.getRange(a-1)[0]===255:!0}}const Hbe={alpha:1,vectorComponent:0,vectorSize:-1,vectorMode:Xc.COMPONENT,mappingRange:null,annotationArray:null,annotatedValueMap:null,indexedLookup:!1};function aX(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Hbe,n),ce.obj(t,e),e.mappingRange=[0,255],e.annotationArray=[],e.annotatedValueMap=[],ce.setGet(t,e,["vectorSize","vectorComponent","vectorMode","alpha","indexedLookup"]),ce.setArray(t,e,["mappingRange"],2),ce.getArray(t,e,["mappingRange"]),Wbe(t,e)}const Kbe=ce.newInstance(aX,"vtkScalarsToColors");var VC={newInstance:Kbe,extend:aX,...ZD};const qbe={RGB:0,HSV:1,LAB:2,DIVERGING:3},Xbe={LINEAR:0,LOG10:1};var oX={ColorSpace:qbe,Scale:Xbe};const{ColorSpace:Il,Scale:QD}=oX,{ScalarMappingTarget:Nx}=VC,{vtkDebugMacro:Ybe,vtkErrorMacro:rf,vtkWarningMacro:Jbe}=ce;function Hk(t,e){const n=t[0],r=t[1],i=t[2],a=Math.sqrt(n*n+r*r+i*i),o=a>.001?Math.acos(n/a):0,s=o>.001?Math.atan2(i,r):0;e[0]=a,e[1]=o,e[2]=s}function Zbe(t,e){const n=t[0],r=t[1],i=t[2];e[0]=n*Math.cos(r),e[1]=n*Math.sin(r)*Math.cos(i),e[2]=n*Math.sin(r)*Math.sin(i)}function Kk(t,e){if(t[0]>=e-.1)return t[2];const n=t[1]*Math.sqrt(e*e-t[0]*t[0])/(t[0]*Math.sin(t[1]));return t[2]>-.3*Math.PI?t[2]+n:t[2]-n}function Qbe(t,e){let n=t-e;for(n<0&&(n=-n);n>=2*Math.PI;)n-=2*Math.PI;return n>Math.PI&&(n=2*Math.PI-n),n}function qk(t,e,n,r){const i=[],a=[];fh(e,i),fh(n,a);const o=[],s=[];Hk(i,o),Hk(a,s);let l=t;if(o[1]>.05&&s[1]>.05&&Qbe(o[2],s[2])>.33*Math.PI){let u=Math.max(o[0],s[0]);u=Math.max(88,u),t<.5?(s[0]=u,s[1]=0,s[2]=0,l*=2):(o[0]=u,o[1]=0,o[2]=0,l=2*l-1)}o[1]<.05&&s[1]>.05?o[2]=Kk(s,o[0]):s[1]<.05&&o[1]>.05&&(s[2]=Kk(o,s[0]));const c=[];c[0]=(1-l)*o[0]+l*s[0],c[1]=(1-l)*o[1]+l*s[1],c[2]=(1-l)*o[2]+l*s[2];const f=[];Zbe(c,f),Zw(f,r)}function ewe(t,e){e.classHierarchy.push("vtkColorTransferFunction"),t.getSize=()=>e.nodes.length,t.addRGBPoint=(n,r,i,a)=>t.addRGBPointLong(n,r,i,a,.5,0),t.addRGBPointLong=function(n,r,i,a){let o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:.5,s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:0;if(o<0||o>1)return rf("Midpoint outside range [0.0, 1.0]"),-1;if(s<0||s>1)return rf("Sharpness outside range [0.0, 1.0]"),-1;e.allowDuplicateScalars||t.removePoint(n);const l={x:n,r,g:i,b:a,midpoint:o,sharpness:s};e.nodes.push(l),t.sortAndUpdateRange();let c=0;for(;c<e.nodes.length&&e.nodes[c].x!==n;c++);return c<e.nodes.length?c:-1},t.addHSVPoint=(n,r,i,a)=>t.addHSVPointLong(n,r,i,a,.5,0),t.addHSVPointLong=function(n,r,i,a){let o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:.5,s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:0;const l=[];return eh([r,i,a],l),t.addRGBPoint(n,l[0],l[1],l[2],o,s)},t.setNodes=n=>{if(e.nodes!==n){const r=JSON.stringify(e.nodes);e.nodes=n;const i=JSON.stringify(e.nodes);if(t.sortAndUpdateRange()||r!==i)return t.modified(),!0}return!1},t.sortAndUpdateRange=()=>{const n=JSON.stringify(e.nodes);e.nodes.sort((a,o)=>a.x-o.x);const r=JSON.stringify(e.nodes),i=t.updateRange();return!i&&n!==r?(t.modified(),!0):i},t.updateRange=()=>{const n=[2];n[0]=e.mappingRange[0],n[1]=e.mappingRange[1];const r=e.nodes.length;return r?(e.mappingRange[0]=e.nodes[0].x,e.mappingRange[1]=e.nodes[r-1].x):(e.mappingRange[0]=0,e.mappingRange[1]=0),n[0]===e.mappingRange[0]&&n[1]===e.mappingRange[1]?!1:(t.modified(),!0)},t.removePoint=n=>{let r=0;for(;r<e.nodes.length&&e.nodes[r].x!==n;r++);const i=r;if(r>=e.nodes.length)return-1;let a=!1;return e.nodes.splice(r,1),(r===0||r===e.nodes.length)&&(a=t.updateRange()),a||t.modified(),i},t.movePoint=(n,r)=>{if(n!==r){t.removePoint(r);for(let i=0;i<e.nodes.length;i++)if(e.nodes[i].x===n){e.nodes[i].x=r,t.sortAndUpdateRange();break}}},t.removeAllPoints=()=>{e.nodes=[],t.sortAndUpdateRange()},t.addRGBSegment=(n,r,i,a,o,s,l,c)=>{t.sortAndUpdateRange();for(let f=0;f<e.nodes.length;)e.nodes[f].x>=n&&e.nodes[f].x<=o?e.nodes.splice(f,1):f++;t.addRGBPointLong(n,r,i,a,.5,0),t.addRGBPointLong(o,s,l,c,.5,0),t.modified()},t.addHSVSegment=(n,r,i,a,o,s,l,c)=>{const f=[r,i,a],u=[s,l,c],d=[],h=[];eh(f,d),eh(u,h),t.addRGBSegment(n,d[0],d[1],d[2],o,h[0],h[1],h[2])},t.mapValue=n=>{const r=[];return t.getColor(n,r),[Math.floor(255*r[0]+.5),Math.floor(255*r[1]+.5),Math.floor(255*r[2]+.5),255]},t.getColor=(n,r)=>{if(e.indexedLookup){const i=t.getSize(),a=t.getAnnotatedValueIndexInternal(n);if(a<0||i===0){const o=t.getNanColorByReference();r[0]=o[0],r[1]=o[1],r[2]=o[2]}else{const o=[];t.getNodeValue(a%i,o),r[0]=o[1],r[1]=o[2],r[2]=o[3]}return}t.getTable(n,n,1,r)},t.getRedValue=n=>{const r=[];return t.getColor(n,r),r[0]},t.getGreenValue=n=>{const r=[];return t.getColor(n,r),r[1]},t.getBlueValue=n=>{const r=[];return t.getColor(n,r),r[2]},t.getTable=(n,r,i,a)=>{const o=Number(n),s=Number(r);if(Qw(o)||Qw(s)){for(let I=0;I<i;I++)a[I*3+0]=e.nanColor[0],a[I*3+1]=e.nanColor[1],a[I*3+2]=e.nanColor[2];return}let l=0;const c=e.nodes.length;let f=0,u=0,d=0;c!==0&&(f=e.nodes[c-1].r,u=e.nodes[c-1].g,d=e.nodes[c-1].b);let h=0,p=0,g=0;const m=[0,0,0],y=[0,0,0];let v=0,x=0;const w=[];let S=e.scale===QD.LOG10;S&&(S=e.mappingRange[0]>0);let T=0,_=0,D=0;S&&(T=Math.log10(o),_=Math.log10(s));for(let I=0;I<i;I++){const R=3*I;if(i>1?S?(D=T+I/(i-1)*(_-T),h=10**D):h=o+I/(i-1)*(s-o):S?(D=.5*(T+_),h=10**D):h=.5*(o+s),e.discretize){const O=e.mappingRange;if(h>=O[0]&&h<=O[1]){const P=e.numberOfValues,N=O[1]-O[0];if(P<=1)h=O[0]+N/2;else{const A=(h-O[0])/N,B=qD(P*A);h=O[0]+B/(P-1)*N}}}for(;l<c&&h>e.nodes[l].x;)l++,l<c&&(p=e.nodes[l-1].x,g=e.nodes[l].x,S&&(p=Math.log10(p),g=Math.log10(g)),m[0]=e.nodes[l-1].r,y[0]=e.nodes[l].r,m[1]=e.nodes[l-1].g,y[1]=e.nodes[l].g,m[2]=e.nodes[l-1].b,y[2]=e.nodes[l].b,v=e.nodes[l-1].midpoint,x=e.nodes[l-1].sharpness,v<1e-5&&(v=1e-5),v>.99999&&(v=.99999));if(h>e.mappingRange[1])a[R]=0,a[R+1]=0,a[R+2]=0,e.clamping&&(t.getUseAboveRangeColor()?(a[R]=e.aboveRangeColor[0],a[R+1]=e.aboveRangeColor[1],a[R+2]=e.aboveRangeColor[2]):(a[R]=f,a[R+1]=u,a[R+2]=d));else if(h<e.mappingRange[0]||Jq(h)&&h<0)a[R]=0,a[R+1]=0,a[R+2]=0,e.clamping&&(t.getUseBelowRangeColor()?(a[R]=e.belowRangeColor[0],a[R+1]=e.belowRangeColor[1],a[R+2]=e.belowRangeColor[2]):c>0&&(a[R]=e.nodes[0].r,a[R+1]=e.nodes[0].g,a[R+2]=e.nodes[0].b));else if(l===0&&(Math.abs(h-o)<1e-6||e.discretize))c>0?(a[R]=e.nodes[0].r,a[R+1]=e.nodes[0].g,a[R+2]=e.nodes[0].b):(a[R]=0,a[R+1]=0,a[R+2]=0);else{let O=0;if(S?O=(D-p)/(g-p):O=(h-p)/(g-p),O<v?O=.5*O/v:O=.5+.5*(O-v)/(1-v),x>.99)if(O<.5){a[R]=m[0],a[R+1]=m[1],a[R+2]=m[2];continue}else{a[R]=y[0],a[R+1]=y[1],a[R+2]=y[2];continue}if(x<.01){if(e.colorSpace===Il.RGB)a[R]=(1-O)*m[0]+O*y[0],a[R+1]=(1-O)*m[1]+O*y[1],a[R+2]=(1-O)*m[2]+O*y[2];else if(e.colorSpace===Il.HSV){const F=[],J=[];Dv(m,F),Dv(y,J),e.hSVWrap&&(F[0]-J[0]>.5||J[0]-F[0]>.5)&&(F[0]>J[0]?F[0]-=1:J[0]-=1);const Q=[];Q[0]=(1-O)*F[0]+O*J[0],Q[0]<0&&(Q[0]+=1),Q[1]=(1-O)*F[1]+O*J[1],Q[2]=(1-O)*F[2]+O*J[2],eh(Q,w),a[R]=w[0],a[R+1]=w[1],a[R+2]=w[2]}else if(e.colorSpace===Il.LAB){const F=[],J=[];fh(m,F),fh(y,J);const Q=[];Q[0]=(1-O)*F[0]+O*J[0],Q[1]=(1-O)*F[1]+O*J[1],Q[2]=(1-O)*F[2]+O*J[2],Zw(Q,w),a[R]=w[0],a[R+1]=w[1],a[R+2]=w[2]}else e.colorSpace===Il.DIVERGING?(qk(O,m,y,w),a[R]=w[0],a[R+1]=w[1],a[R+2]=w[2]):rf("ColorSpace set to invalid value.",e.colorSpace);continue}O<.5?O=.5*(O*2)**(1+10*x):O>.5&&(O=1-.5*((1-O)*2)**(1+10*x));const P=O*O,N=P*O,A=2*N-3*P+1,B=-2*N+3*P,V=N-2*P+O,$=N-P;let U,G;if(e.colorSpace===Il.RGB)for(let F=0;F<3;F++)U=y[F]-m[F],G=(1-x)*U,a[R+F]=A*m[F]+B*y[F]+V*G+$*G;else if(e.colorSpace===Il.HSV){const F=[],J=[];Dv(m,F),Dv(y,J),e.hSVWrap&&(F[0]-J[0]>.5||J[0]-F[0]>.5)&&(F[0]>J[0]?F[0]-=1:J[0]-=1);const Q=[];for(let ne=0;ne<3;ne++)U=J[ne]-F[ne],G=(1-x)*U,Q[ne]=A*F[ne]+B*J[ne]+V*G+$*G,ne===0&&Q[ne]<0&&(Q[ne]+=1);eh(Q,w),a[R]=w[0],a[R+1]=w[1],a[R+2]=w[2]}else if(e.colorSpace===Il.LAB){const F=[],J=[];fh(m,F),fh(y,J);const Q=[];for(let ne=0;ne<3;ne++)U=J[ne]-F[ne],G=(1-x)*U,Q[ne]=A*F[ne]+B*J[ne]+V*G+$*G;Zw(Q,w),a[R]=w[0],a[R+1]=w[1],a[R+2]=w[2]}else e.colorSpace===Il.DIVERGING?(qk(O,m,y,w),a[R]=w[0],a[R+1]=w[1],a[R+2]=w[2]):rf("ColorSpace set to invalid value.");for(let F=0;F<3;F++)a[R+F]=a[R+F]<0?0:a[R+F],a[R+F]=a[R+F]>1?1:a[R+F]}}},t.getUint8Table=function(n,r,i){let a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(t.getMTime()<=e.buildTime&&e.tableSize===i&&e.tableWithAlpha!==a)return e.table;if(e.nodes.length===0)return rf("Attempting to lookup a value with no points in the function"),e.table;const o=a?4:3;(e.tableSize!==i||e.tableWithAlpha!==a)&&(e.table=new Uint8Array(i*o),e.tableSize=i,e.tableWithAlpha=a);const s=[];t.getTable(n,r,i,s);for(let l=0;l<i;l++)e.table[l*o+0]=Math.floor(s[l*3+0]*255+.5),e.table[l*o+1]=Math.floor(s[l*3+1]*255+.5),e.table[l*o+2]=Math.floor(s[l*3+2]*255+.5),a&&(e.table[l*o+3]=255);return e.buildTime.modified(),e.table},t.buildFunctionFromArray=n=>{t.removeAllPoints();const r=n.getNumberOfComponents();for(let i=0;i<n.getNumberOfTuples();i++)switch(r){case 3:{e.nodes.push({x:i,r:n.getComponent(i,0),g:n.getComponent(i,1),b:n.getComponent(i,2),midpoint:.5,sharpness:0});break}case 4:{e.nodes.push({x:n.getComponent(i,0),r:n.getComponent(i,1),g:n.getComponent(i,2),b:n.getComponent(i,3),midpoint:.5,sharpness:0});break}case 5:{e.nodes.push({x:i,r:n.getComponent(i,0),g:n.getComponent(i,1),b:n.getComponent(i,2),midpoint:n.getComponent(i,4),sharpness:n.getComponent(i,5)});break}case 6:{e.nodes.push({x:n.getComponent(i,0),r:n.getComponent(i,1),g:n.getComponent(i,2),b:n.getComponent(i,3),midpoint:n.getComponent(i,4),sharpness:n.getComponent(i,5)});break}}t.sortAndUpdateRange()},t.buildFunctionFromTable=(n,r,i,a)=>{let o=0;t.removeAllPoints(),i>1&&(o=(r-n)/(i-1));for(let s=0;s<i;s++){const l={x:n+o*s,r:a[s*3],g:a[s*3+1],b:a[s*3+2],sharpness:0,midpoint:.5};e.nodes.push(l)}t.sortAndUpdateRange()},t.getNodeValue=(n,r)=>n<0||n>=e.nodes.length?(rf("Index out of range!"),-1):(r[0]=e.nodes[n].x,r[1]=e.nodes[n].r,r[2]=e.nodes[n].g,r[3]=e.nodes[n].b,r[4]=e.nodes[n].midpoint,r[5]=e.nodes[n].sharpness,1),t.setNodeValue=(n,r)=>{if(n<0||n>=e.nodes.length)return rf("Index out of range!"),-1;const i=e.nodes[n].x;return e.nodes[n].x=r[0],e.nodes[n].r=r[1],e.nodes[n].g=r[2],e.nodes[n].b=r[3],e.nodes[n].midpoint=r[4],e.nodes[n].sharpness=r[5],i!==r[0]?t.sortAndUpdateRange():t.modified(),1},t.getNumberOfAvailableColors=()=>{if(e.indexedLookup&&t.getSize())return t.getSize();if(e.tableSize)return e.tableSize;const n=e.nodes?.length??0;return Math.max(4094,n)},t.getIndexedColor=(n,r)=>{const i=t.getSize();if(i>0&&n>=0){const o=[];t.getNodeValue(n%i,o);for(let s=0;s<3;++s)r[s]=o[s+1];r[3]=1;return}const a=t.getNanColorByReference();r[0]=a[0],r[1]=a[1],r[2]=a[2],r[3]=1},t.fillFromDataPointer=(n,r)=>{if(!(n<=0||!r)){t.removeAllPoints();for(let i=0;i<n;i++)t.addRGBPoint(r[i*4],r[i*4+1],r[i*4+2],r[i*4+3])}},t.setMappingRange=(n,r)=>{const i=[n,r],a=t.getRange();if(a[1]===i[1]&&a[0]===i[0])return;if(i[1]===i[0]){rf("attempt to set zero width color range");return}const o=(i[1]-i[0])/(a[1]-a[0]),s=i[0]-a[0]*o;for(let l=0;l<e.nodes.length;++l)e.nodes[l].x=e.nodes[l].x*o+s;e.mappingRange[0]=i[0],e.mappingRange[1]=i[1],t.modified()},t.adjustRange=n=>{const r=t.getRange(),i=[];r[0]<n[0]?(t.getColor(n[0],i),t.addRGBPoint(n[0],i[0],i[1],i[2])):(t.getColor(r[0],i),t.addRGBPoint(n[0],i[0],i[1],i[2])),r[1]>n[1]?(t.getColor(n[1],i),t.addRGBPoint(n[1],i[0],i[1],i[2])):(t.getColor(r[1],i),t.addRGBPoint(n[1],i[0],i[1],i[2])),t.sortAndUpdateRange();for(let a=0;a<e.nodes.length;)e.nodes[a].x>=n[0]&&e.nodes[a].x<=n[1]?e.nodes.splice(a,1):++a;return 1},t.estimateMinNumberOfSamples=(n,r)=>{const i=t.findMinimumXDistance();return Math.ceil((r-n)/i)},t.findMinimumXDistance=()=>{if(e.nodes.length<2)return-1;let n=Number.MAX_VALUE;for(let r=0;r<e.nodes.length-1;r++){const i=e.nodes[r+1].x-e.nodes[r].x;i<n&&(n=i)}return n},t.mapScalarsThroughTable=(n,r,i,a)=>{if(t.getSize()===0){Ybe("Transfer Function Has No Points!");return}e.indexedLookup?t.mapDataIndexed(n,r,i,a):t.mapData(n,r,i,a)},t.mapData=(n,r,i,a)=>{if(t.getSize()===0){Jbe("Transfer Function Has No Points!");return}const o=Math.floor(t.getAlpha()*255+.5),s=n.getNumberOfTuples(),l=n.getNumberOfComponents(),c=r.getData(),f=n.getData(),u=[];if(i===Nx.RGBA)for(let d=0;d<s;d++){const h=f[d*l+a];t.getColor(h,u),c[d*4]=Math.floor(u[0]*255+.5),c[d*4+1]=Math.floor(u[1]*255+.5),c[d*4+2]=Math.floor(u[2]*255+.5),c[d*4+3]=o}if(i===Nx.RGB)for(let d=0;d<s;d++){const h=f[d*l+a];t.getColor(h,u),c[d*3]=Math.floor(u[0]*255+.5),c[d*3+1]=Math.floor(u[1]*255+.5),c[d*3+2]=Math.floor(u[2]*255+.5)}if(i===Nx.LUMINANCE)for(let d=0;d<s;d++){const h=f[d*l+a];t.getColor(h,u),c[d]=Math.floor(u[0]*76.5+u[1]*150.45+u[2]*28.05+.5)}if(i===Nx.LUMINANCE_ALPHA)for(let d=0;d<s;d++){const h=f[d*l+a];t.getColor(h,u),c[d*2]=Math.floor(u[0]*76.5+u[1]*150.45+u[2]*28.05+.5),c[d*2+1]=o}},t.applyColorMap=n=>{const r=JSON.stringify(e.colorSpace);n.ColorSpace&&(e.colorSpace=Il[n.ColorSpace.toUpperCase()],e.colorSpace===void 0&&(rf(`ColorSpace ${n.ColorSpace} not supported, using RGB instead`),e.colorSpace=Il.RGB));let i=r!==JSON.stringify(e.colorSpace);const a=i||JSON.stringify(e.nanColor);if(n.NanColor)for(e.nanColor=[].concat(n.NanColor);e.nanColor.length<4;)e.nanColor.push(1);i=i||a!==JSON.stringify(e.nanColor);const o=i||JSON.stringify(e.nodes);if(n.RGBPoints){const c=n.RGBPoints.length;e.nodes=[];const f=.5,u=0;for(let d=0;d<c;d+=4)e.nodes.push({x:n.RGBPoints[d],r:n.RGBPoints[d+1],g:n.RGBPoints[d+2],b:n.RGBPoints[d+3],midpoint:f,sharpness:u})}const s=t.sortAndUpdateRange(),l=!s&&(i||o!==JSON.stringify(e.nodes));return l&&t.modified(),s||l}}const twe={clamping:!0,colorSpace:Il.RGB,hSVWrap:!0,scale:QD.LINEAR,nanColor:null,belowRangeColor:null,aboveRangeColor:null,useAboveRangeColor:!1,useBelowRangeColor:!1,allowDuplicateScalars:!1,table:null,tableSize:0,buildTime:null,nodes:null,discretize:!1,numberOfValues:256};function sX(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,twe,n),VC.extend(t,e,n),e.table=[],e.nodes=[],e.nanColor=[.5,0,0,1],e.belowRangeColor=[0,0,0,1],e.aboveRangeColor=[1,1,1,1],e.buildTime={},ce.obj(e.buildTime),ce.get(t,e,["buildTime","mappingRange"]),ce.setGet(t,e,["useAboveRangeColor","useBelowRangeColor","discretize","numberOfValues",{type:"enum",name:"colorSpace",enum:Il},{type:"enum",name:"scale",enum:QD}]),ce.setArray(t,e,["nanColor","belowRangeColor","aboveRangeColor"],4),ce.getArray(t,e,["nanColor","belowRangeColor","aboveRangeColor"]),ewe(t,e)}const nwe=ce.newInstance(sX,"vtkColorTransferFunction");var Uf={newInstance:nwe,extend:sX,...oX},rwe=[{Name:"KAAMS",IndexedColors:[1,1,1,1,0,0,0,1,0,0,0,1,1,1,0,1,0,1,0,1,1,.63,.63,1,.67,.5,.33,1,.5,.75,.53,.35,.7,1,.75,.5],Annotations:[0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11]},{ColorSpace:"Diverging",Name:"Cool to Warm",NanColor:[1,1,0],RGBPoints:[0,.23137254902,.298039215686,.752941176471,.5,.865,.865,.865,1,.705882352941,.0156862745098,.149019607843]},{ColorSpace:"Lab",Creator:"Francesca Samsel",Name:"Cool to Warm (Extended)",NanColor:[.25,0,0],RGBPoints:[0,0,0,.34902,.03125,.039216,.062745,.380392,.0625,.062745,.117647,.411765,.09375,.090196,.184314,.45098,.125,.12549,.262745,.501961,.15625,.160784,.337255,.541176,.1875,.2,.396078,.568627,.21875,.239216,.454902,.6,.25,.286275,.521569,.65098,.28125,.337255,.592157,.701961,.3125,.388235,.654902,.74902,.34375,.466667,.737255,.819608,.375,.572549,.819608,.878431,.40625,.654902,.866667,.909804,.4375,.752941,.917647,.941176,.46875,.823529,.956863,.968627,.5,.988235,.960784,.901961,.5,.941176,.984314,.988235,.52,.988235,.945098,.85098,.54,.980392,.898039,.784314,.5625,.968627,.835294,.698039,.59375,.94902,.733333,.588235,.625,.929412,.65098,.509804,.65625,.909804,.564706,.435294,.6875,.878431,.458824,.352941,.71875,.839216,.388235,.286275,.75,.760784,.294118,.211765,.78125,.701961,.211765,.168627,.8125,.65098,.156863,.129412,.84375,.6,.094118,.094118,.875,.54902,.066667,.098039,.90625,.501961,.05098,.12549,.9375,.45098,.054902,.172549,.96875,.4,.054902,.192157,1,.34902,.070588,.211765]},{ColorSpace:"Diverging",Name:"Warm to Cool",NanColor:[1,1,0],RGBPoints:[0,.705882352941,.0156862745098,.149019607843,.5,.865,.865,.865,1,.23137254902,.298039215686,.752941176471]},{ColorSpace:"Lab",Creator:"Francesca Samsel",Name:"Warm to Cool (Extended)",NanColor:[.250004,0,0],RGBPoints:[0,.34902,0,.129412,.025,.4,.00392157,.101961,.05,.470588,.0156863,.0901961,.075,.54902,.027451,.0705882,.1,.619608,.0627451,.0431373,.125,.690196,.12549,.0627451,.15,.741176,.184314,.0745098,.175,.788235,.266667,.0941176,.2,.811765,.345098,.113725,.225,.831373,.411765,.133333,.25,.85098,.47451,.145098,.275,.870588,.54902,.156863,.3,.878431,.619608,.168627,.325,.890196,.658824,.196078,.35,.909804,.717647,.235294,.375,.929412,.776471,.278431,.395522,.94902,.823529,.321569,.418905,.968627,.87451,.407843,.444278,.980392,.917647,.509804,.470149,.988235,.956863,.643137,.483582,.992157,.964706,.713725,.499,.988235,.980392,.870588,.5,1,1,1,.501,.913725,.988235,.937255,.516418,.827451,.980392,.886275,.531343,.764706,.980392,.866667,.546766,.658824,.980392,.843137,.564179,.572549,.964706,.835294,.587562,.423529,.941176,.87451,.60597,.262745,.901961,.862745,.629851,.0705882,.854902,.870588,.651741,.0509804,.8,.85098,.681592,.0235294,.709804,.831373,.712935,.0313725,.615686,.811765,.75,.0313725,.537255,.788235,.775,.0392157,.466667,.768627,.8,.0509804,.396078,.741176,.825,.054902,.317647,.709804,.85,.054902,.243137,.678431,.875,.0431373,.164706,.639216,.9,.0313725,.0980392,.6,.925,.0392157,.0392157,.560784,.95,.105882,.0509804,.509804,.975,.113725,.0235294,.45098,1,.12549,0,.380392]},{ColorSpace:"RGB",Name:"Rainbow Desaturated",NanColor:[1,1,0],RGBPoints:[0,.278431372549,.278431372549,.858823529412,.143,0,0,.360784313725,.285,0,1,1,.429,0,.501960784314,0,.571,1,1,0,.714,1,.380392156863,0,.857,.419607843137,0,0,1,.878431372549,.301960784314,.301960784314]},{ColorSpace:"RGB",Name:"Cold and Hot",NanColor:[1,1,0],RGBPoints:[0,0,1,1,.45,0,0,1,.5,0,0,.501960784314,.55,1,0,0,1,1,1,0]},{ColorSpace:"RGB",Name:"Black-Body Radiation",NanColor:[0,.498039215686,1],RGBPoints:[0,0,0,0,.4,.901960784314,0,0,.8,.901960784314,.901960784314,0,1,1,1,1]},{ColorSpace:"RGB",Name:"X Ray",NanColor:[1,0,0],RGBPoints:[0,1,1,1,1,0,0,0]},{ColorSpace:"RGB",Name:"Grayscale",NanColor:[1,0,0],RGBPoints:[0,0,0,0,1,1,1,1]},{ColorSpace:"RGB",Name:"BkRd",NanColor:[0,1,1],RGBPoints:[0,0,0,0,1,1,0,0]},{ColorSpace:"RGB",Name:"BkGn",NanColor:[1,0,1],RGBPoints:[0,0,0,0,1,0,1,0]},{ColorSpace:"RGB",Name:"BkBu",NanColor:[1,1,0],RGBPoints:[0,0,0,0,1,0,0,1]},{ColorSpace:"RGB",Name:"BkMa",NanColor:[0,1,0],RGBPoints:[0,0,0,0,1,1,0,1]},{ColorSpace:"RGB",Name:"BkCy",NanColor:[0,1,1],RGBPoints:[0,0,0,0,1,0,1,1]},{ColorSpace:"RGB",Name:"Black, Blue and White",NanColor:[1,1,0],RGBPoints:[0,0,0,0,.333,0,0,.501960784314,.666,0,.501960784314,1,1,1,1,1]},{ColorSpace:"RGB",Name:"Black, Orange and White",NanColor:[1,1,0],RGBPoints:[0,0,0,0,.333,.501960784314,0,0,.666,1,.501960784314,0,1,1,1,1]},{ColorSpace:"Lab",Creator:"Francesca Samsel",Name:"Linear YGB 1211g",NanColor:[.25,0,0],RGBPoints:[0,1,.988235,.968627,.02,1,.952941,.878431,.05,.968627,.905882,.776471,.1,.94902,.898039,.647059,.15,.901961,.878431,.556863,.2,.847059,.858824,.482353,.25,.690196,.819608,.435294,.3,.513725,.768627,.384314,.35,.337255,.721569,.337255,.4,.278431,.658824,.392157,.45,.231373,.639216,.435294,.5,.203922,.6,.486275,.55,.172549,.568627,.537255,.6,.141176,.517647,.54902,.65,.133333,.458824,.541176,.7,.12549,.396078,.529412,.75,.117647,.321569,.521569,.8,.121569,.258824,.509804,.85,.133333,.227451,.501961,.9,.145098,.192157,.490196,.95,.188235,.164706,.470588,1,.258824,.196078,.439216]},{ColorSpace:"CIELAB",Creator:"Francesca Samsel",Name:"Linear Green (Gr4L)",NanColor:[.25,0,0],RGBPoints:[0,.054902,.109804,.121569,.05,.07451,.172549,.180392,.1,.086275,.231373,.219608,.15,.094118,.278431,.25098,.2,.109804,.34902,.278431,.25,.113725,.4,.278431,.3,.117647,.45098,.270588,.35,.117647,.490196,.243137,.4,.113725,.521569,.203922,.45,.109804,.54902,.152941,.5,.082353,.588235,.082353,.55,.109804,.631373,.05098,.6,.211765,.678431,.082353,.65,.317647,.721569,.113725,.7,.431373,.760784,.160784,.75,.556863,.8,.239216,.8,.666667,.839216,.294118,.85,.784314,.878431,.396078,.9,.886275,.921569,.533333,.95,.960784,.94902,.670588,1,1,.984314,.901961]},{ColorSpace:"Lab",Creator:"Francesca Samsel",Name:"Linear Blue (8_31f)",NanColor:[.25,0,0],RGBPoints:[0,.960784,1,.980392,.05,.815686,.960784,.913725,.1,.670588,.929412,.870588,.15,.556863,.901961,.843137,.2,.478431,.870588,.823529,.25,.439216,.831373,.803922,.3,.4,.8,.788235,.35,.376471,.768627,.768627,.4,.34902,.709804,.729412,.45,.32549,.654902,.690196,.5,.301961,.607843,.658824,.55,.247059,.545098,.619608,.6,.239216,.494118,.580392,.65,.227451,.439216,.541176,.7,.227451,.403922,.521569,.75,.231373,.368627,.501961,.8,.227451,.321569,.470588,.85,.219608,.282353,.439216,.9,.192157,.235294,.4,.95,.160784,.184314,.34902,1,.133333,.12549,.301961]},{ColorSpace:"HSV",Name:"Blue to Red Rainbow",NanColor:[.498039215686,.498039215686,.498039215686],RGBPoints:[0,0,0,1,1,1,0,0]},{ColorSpace:"HSV",Name:"Red to Blue Rainbow",NanColor:[.498039215686,.498039215686,.498039215686],RGBPoints:[0,1,0,0,1,0,0,1]},{ColorSpace:"RGB",Name:"Rainbow Blended White",NanColor:[1,1,0],RGBPoints:[0,1,1,1,.17,0,0,1,.34,0,1,1,.5,0,1,0,.67,1,1,0,.84,1,0,0,1,.878431372549,0,1]},{ColorSpace:"RGB",Name:"Rainbow Blended Grey",NanColor:[1,1,0],RGBPoints:[0,.317647058824,.341176470588,.43137254902,.17,0,0,1,.34,0,1,1,.5,0,1,0,.67,1,1,0,.84,1,0,0,1,.878431372549,0,1]},{ColorSpace:"RGB",Name:"Rainbow Blended Black",NanColor:[1,1,0],RGBPoints:[0,0,0,0,.17,0,0,1,.34,0,1,1,.5,0,1,0,.67,1,1,0,.84,1,0,0,1,.878431372549,0,1]},{ColorSpace:"RGB",Name:"Blue to Yellow",NanColor:[1,0,0],RGBPoints:[0,.0392156862745,.0392156862745,.949019607843,1,.949019607843,.949019607843,.0392156862745]},{ColorSpace:"HSV",Name:"blot",RGBPoints:[0,0,0,1,.166,0,0,1,.167,1,0,1,.332,1,0,1,.333,0,1,1,.5,0,1,1,.501,0,1,0,.666,0,1,0,.667,1,1,0,.832,1,1,0,.833,1,0,0,1,1,0,0]},{ColorSpace:"Lab",Name:"CIELab Blue to Red",NanColor:[1,1,0],RGBPoints:[0,0,.6,.749019607843,1,.76862745098,.466666666667,.341176470588]},{ColorSpace:"RGB",Name:"jet",RGBPoints:[-1,0,0,.5625,-.777778,0,0,1,-.269841,0,1,1,-.015873,.5,1,.5,.238095,1,1,0,.746032,1,0,0,1,.5,0,0]},{ColorSpace:"RGB",Name:"rainbow",RGBPoints:[-1,0,0,1,-.5,0,1,1,0,0,1,0,.5,1,1,0,1,1,0,0]},{ColorSpace:"Lab",Name:"erdc_rainbow_bright",RGBPoints:[-1,.32549,.14902,.960784,-.866221,.297047,.375586,.963836,-.732441,.180302,.536818,.964627,-.598662,.1302,.649207,.929647,-.464883,.0445143,.749654,.855998,-.331104,.0271325,.830713,.721527,-.197324,.259504,.866145,.543555,-.0635452,.428364,.890725,.329819,.0702341,.568503,.898508,.187623,.204013,.738259,.890317,.0825461,.337793,.84546,.86136,.0147555,.471572,.912191,.808018,0,.605351,.962848,.710445,0,.73913,.999469,.600258,.0176284,.87291,.994156,.445975,.193912,1,.980407,.247105,.262699]},{ColorSpace:"Lab",Name:"erdc_rainbow_dark",RGBPoints:[-1,0,0,.423499,-.866221,0,.119346,.529237,-.732441,0,.238691,.634976,-.598662,0,.346852,.68788,-.464883,0,.45022,.718141,-.331104,0,.553554,.664839,-.197324,0,.651082,.519303,-.0635452,.115841,.72479,.352857,.0702341,.326771,.781195,.140187,.204013,.522765,.798524,.0284624,.337793,.703162,.788685,.00885756,.471572,.845118,.751133,0,.605351,.955734,.690825,0,.73913,.995402,.567916,.0618524,.87291,.987712,.403398,.164851,1,.980407,.247105,.262699]},{ColorSpace:"Lab",Name:"nic_CubicL",RGBPoints:[-1,.479965,.0118108,.5307,-.87451,.522213,.0551282,.706919,-.74902,.50839,.237278,.867764,-.623529,.451617,.373834,.987255,-.498039,.39365,.497255,.97506,-.372549,.328631,.599639,.891843,-.247059,.250043,.690286,.778553,-.121569,.249656,.764905,.645857,.00392157,.297954,.821466,.50449,.129412,.337509,.872595,.358447,.254902,.430011,.913789,.297079,.380392,.587191,.931381,.333353,.505882,.727937,.93591,.353742,.631373,.826403,.921081,.365066,.756863,.893201,.846317,.372662,.882353,.965347,.73884,.378506,1,.983235,.597451,.366856]},{ColorSpace:"Lab",Name:"nic_CubicYF",RGBPoints:[-1,.5151,.0482,.6697,-.87451,.520711,.168955,.800574,-.74902,.493694,.278596,.911824,-.623529,.440026,.369475,.984978,-.498039,.398932,.457593,.987053,-.372549,.350651,.540644,.929608,-.247059,.298827,.615625,.857729,-.121569,.239928,.685061,.769531,.00392157,.228832,.739349,.673287,.129412,.263297,.78608,.569988,.254902,.298107,.828337,.460214,.380392,.33092,.864071,.352674,.505882,.38306,.898169,.287309,.631373,.49023,.917481,.307961,.756863,.62372,.926026,.332309,.882353,.717458,.92527,.342476,1,.8,.9255,.3529]},{ColorSpace:"Lab",Name:"gist_earth",RGBPoints:[-1,0,0,0,-.87451,.239216,.027451,.415686,-.74902,.0901961,.254902,.556863,-.623529,.0941176,.352941,.54902,-.498039,.105882,.435294,.533333,-.372549,.12549,.52549,.501961,-.247059,.156863,.596078,.443137,-.121569,.196078,.65098,.380392,.00392157,.282353,.717647,.301961,.129412,.466667,.772549,.27451,.254902,.678431,.784314,.309804,.380392,.901961,.756863,.376471,.505882,.992157,.705882,.521569,.631373,1,.721569,.701961,.756863,1,.784314,.784314,.882353,1,.866667,.866667,1,1,1,1]},{ColorSpace:"Lab",Name:"2hot",RGBPoints:[-1,.0416667,0,0,-.873016,.208333,0,0,-.746032,.375,0,0,-.619048,.541667,0,0,-.492063,.708333,0,0,-.365079,.854137,0,0,-.238095,.937488,.039062,0,-.111111,1,.208333,0,.015873,1,.375,0,.142857,1,.541667,0,.269841,1,.708333,0,.396825,1,.858805,.03125,.52381,1,.947392,.15625,.650794,1,1,.3125,.777778,1,1,.5625,.904762,1,1,.8125,1,1,1,1]},{ColorSpace:"Lab",Name:"erdc_red2yellow_BW",RGBPoints:[-1,754296e-12,0,109827e-10,-.87451,.18285,.0264094,0,-.74902,.3066,0,0,-.623529,.422841,0,0,-.498039,.522945,0,0,-.372549,.605721,0,0,-.247059,.672502,.14168,0,-.121569,.728167,.244025,0,.00392157,.781215,.333454,0,.129412,.825,.423586,0,.254902,.855893,.516793,0,.380392,.880491,.608846,0,.505882,.910305,.695505,0,.631373,.94109,.779067,.223528,.756863,.967873,.858572,.473521,.882353,.986815,.933211,.751583,1,1,1,.999997]},{ColorSpace:"Lab",Name:"erdc_marine2gold_BW",RGBPoints:[-1,111641e-12,0,162551e-11,-.87451,.0413146,.0619808,.209857,-.74902,.0185557,.101341,.350684,-.623529,.00486405,.149847,.461054,-.498039,.0836345,.210845,.517906,-.372549,.173222,.276134,.541793,-.247059,.259857,.343877,.535869,-.121569,.362299,.408124,.504293,.00392157,.468266,.468276,.468257,.129412,.582781,.527545,.374914,.254902,.691591,.585251,.274266,.380392,.784454,.645091,.247332,.505882,.862299,.710383,.27518,.631373,.920863,.782923,.351563,.756863,.955792,.859699,.533541,.882353,.976162,.93433,.780671,1,1,1,.999983]},{ColorSpace:"Lab",Name:"erdc_blue2gold_BW",RGBPoints:[-1,0,0,0,-.87451,.0742735,.0440331,.230013,-.74902,.125276,.0258685,.415826,-.623529,.143879,.0163031,.591346,-.498039,.212261,.0627855,.705239,-.372549,.306048,.141178,.763636,-.247059,.391537,.232286,.773263,-.121569,.461734,.336633,.708321,.00392157,.54209,.427581,.590007,.129412,.61704,.508623,.460978,.254902,.702703,.579586,.309117,.380392,.790336,.644811,.170397,.505882,.870173,.710733,.117134,.631373,.93656,.781991,.157144,.756863,.965672,.862068,.409836,.882353,.985751,.936296,.714162,1,1,1,.999999]},{ColorSpace:"Lab",Name:"erdc_sapphire2gold_BW",RGBPoints:[-1,.107704,.107708,.107694,-.87451,.1851,.112354,.308554,-.74902,.236782,.114233,.48788,-.623529,.28296,.126187,.639464,-.498039,.344787,.171643,.739713,-.372549,.413325,.242371,.76913,-.247059,.481863,.3131,.719841,-.121569,.550402,.383829,.612222,.00392157,.61894,.454558,.51126,.129412,.687478,.525287,.39993,.254902,.756017,.596016,.289923,.380392,.824555,.666745,.255498,.505882,.892979,.736822,.27696,.631373,.938851,.804966,.351734,.756863,.966491,.874853,.53572,.882353,.982105,.94153,.782579,1,1,1,.999986]},{ColorSpace:"Lab",Name:"erdc_red2purple_BW",RGBPoints:[-1,0,0,0,-.87451,.167793,.0166271,.0431278,-.74902,.262608,.0107595,.0791181,-.623529,.351902,.0101858,.100926,-.498039,.441257,.0160835,.131919,-.372549,.5221,.0555972,.195625,-.247059,.593852,.104294,.310234,-.121569,.654628,.158115,.448486,.00392157,.707443,.220914,.570253,.129412,.749504,.293268,.67897,.254902,.781587,.370517,.779269,.380392,.809951,.451099,.855831,.505882,.84424,.531462,.900451,.631373,.865174,.620901,.91606,.756863,.875041,.714054,.910284,.882353,.880764,.80554,.896276,1,.887572,.887591,.887556]},{ColorSpace:"Lab",Name:"erdc_purple2pink_BW",RGBPoints:[-1,0,0,0,-.87451,.117562,.0291202,.175876,-.74902,.178368,.0458476,.285454,-.623529,.237731,.0680173,.387717,-.498039,.300877,.0956291,.484802,-.372549,.370929,.136858,.554985,-.247059,.449033,.189273,.58863,-.121569,.529971,.245796,.598587,.00392157,.609914,.300643,.610244,.129412,.697079,.351286,.616371,.254902,.785858,.401991,.617376,.380392,.862517,.45745,.64463,.505882,.91359,.525462,.705336,.631373,.932583,.61064,.767412,.756863,.922478,.706966,.817522,.882353,.901302,.803071,.856311,1,.887571,.887591,.887549]},{ColorSpace:"Lab",Name:"erdc_pbj_lin",RGBPoints:[-1,0,0,0,-.87451,.091821,.0611476,.10617,-.74902,.160311,.0900022,.192713,-.623529,.22484,.12126,.272128,-.498039,.291263,.157469,.340828,-.372549,.360015,.200388,.388903,-.247059,.437497,.250058,.387201,-.121569,.512636,.304969,.355955,.00392157,.582603,.360874,.33488,.129412,.655126,.416374,.306351,.254902,.725889,.473329,.279051,.380392,.778125,.537928,.302697,.505882,.815894,.606931,.382431,.631373,.839159,.679308,.497608,.756863,.854748,.751666,.631792,.882353,.869483,.822508,.768592,1,.887572,.887589,.887565]},{ColorSpace:"Lab",Name:"erdc_blue2green_muted",RGBPoints:[-1,.107704,.107708,.107695,-.87451,.141522,.13066,.270741,-.74902,.180123,.146119,.42308,-.623529,.210161,.169674,.551795,-.498039,.239701,.212939,.634969,-.372549,.253916,.282947,.653641,-.247059,.242791,.366933,.608521,-.121569,.226302,.446776,.52693,.00392157,.236237,.514689,.458798,.129412,.274641,.577589,.376069,.254902,.349625,.633993,.288131,.380392,.4437,.683677,.260497,.505882,.536247,.731214,.285424,.631373,.628472,.777128,.349151,.756863,.718259,.819287,.496825,.882353,.804768,.856164,.703299,1,.887571,.887591,.887548]},{ColorSpace:"Lab",Name:"erdc_blue2green_BW",RGBPoints:[-1,363578e-12,0,529374e-11,-.87451,.0539915,.0577948,.212806,-.74902,.0620393,.0758942,.388959,-.623529,.0697499,.102032,.54177,-.498039,.113295,.156156,.64334,-.372549,.152047,.243196,.670283,-.247059,.158096,.344084,.622864,-.121569,.151142,.43922,.532767,.00392157,.17155,.521588,.457719,.129412,.225861,.599141,.363997,.254902,.32328,.67007,.259083,.380392,.442344,.733697,.223754,.505882,.558409,.794941,.257411,.631373,.673875,.854344,.340822,.756863,.787244,.909326,.524717,.882353,.896483,.958063,.775914,1,1,1,.999982]},{ColorSpace:"Lab",Name:"GREEN-WHITE_LINEAR",RGBPoints:[-1,0,0,0,-.87451,0,.062745,0,-.74902,0,.12549,0,-.623529,0,.188235,0,-.498039,0,.25098,0,-.372549,0,.313725,0,-.247059,0,.376471,0,-.121569,.094118,.439216,0,.00392157,.196078,.501961,0,.129412,.294118,.564706,0,.254902,.396078,.627451,0,.380392,.498039,.690196,0,.505882,.6,.752941,.145098,.631373,.701961,.815686,.364706,.756863,.8,.878431,.580392,.882353,.901961,.941176,.796078,1,1,1,1]},{ColorSpace:"Lab",Name:"erdc_green2yellow_BW",RGBPoints:[-1,0,0,0,-.87451,0,.105542,.0603919,-.74902,0,.159454,.104148,-.623529,0,.219502,.15542,-.498039,0,.282276,.203811,-.372549,0,.346331,.235652,-.247059,0,.411765,.235428,-.121569,0,.477177,.217977,.00392157,.0593644,.541635,.21361,.129412,.233081,.604722,.210591,.254902,.369803,.664942,.226536,.380392,.498446,.722367,.288237,.505882,.601929,.782244,.380815,.631373,.703207,.840497,.512134,.756863,.803186,.896433,.674462,.882353,.903834,.950266,.846715,1,1,1,.999981]},{ColorSpace:"Lab",Name:"blue2cyan",RGBPoints:[-1,0,0,0,-.87451,0,.152941,.364706,-.74902,0,.254902,.470588,-.623529,0,.34902,.572549,-.498039,0,.443137,.670588,-.372549,0,.537255,.772549,-.247059,0,.627451,.870588,-.121569,0,.717647,.964706,.00392157,.0784314,.772549,1,.129412,.207843,.858824,1,.254902,.32549,.941176,1,.380392,.45098,1,1,.505882,.560784,1,1,.631373,.662745,1,1,.756863,.760784,1,1,.882353,.870588,1,1,1,1,1,1]},{ColorSpace:"Lab",Name:"erdc_blue2cyan_BW",RGBPoints:[-1,405298e-12,0,59012e-10,-.87451,.0207526,.0740933,.18093,-.74902,0,.121033,.30343,-.623529,0,.166892,.416095,-.498039,0,.216768,.524796,-.372549,.0164769,.275471,.608585,-.247059,.0544527,.344824,.659267,-.121569,.0880643,.419118,.688675,.00392157,.127938,.492556,.720256,.129412,.149476,.566946,.756918,.254902,.188961,.641333,.792122,.380392,.245482,.715336,.827609,.505882,.329216,.786235,.874761,.631373,.453558,.852803,.918466,.756863,.626281,.910493,.954,.882353,.82257,.958709,.980146,1,1,1,.999989]},{ColorSpace:"Lab",Name:"erdc_blue_BW",RGBPoints:[-1,0,0,0,-.87451,.0425591,.0763529,.150682,-.74902,.0569472,.119154,.275403,-.623529,.0635978,.164772,.395427,-.498039,.0774342,.213851,.510014,-.372549,.106815,.267034,.615102,-.247059,.122093,.324649,.720068,-.121569,.160851,.387068,.806956,.00392157,.213754,.453516,.878012,.129412,.26722,.524656,.932436,.254902,.326844,.599279,.968038,.380392,.403403,.674712,.984784,.505882,.499703,.745519,1,.631373,.615055,.813983,1,.756863,.74405,.879228,1,.882353,.877909,.941913,1,1,1,1,.999996]},{ColorSpace:"Lab",Name:"BLUE-WHITE",RGBPoints:[-1,0,0,0,-.87451,0,0,.082353,-.74902,0,0,.168627,-.623529,0,0,.254902,-.498039,0,0,.337255,-.372549,0,0,.423529,-.247059,0,0,.509804,-.121569,0,.101961,.592157,.00392157,0,.203922,.678431,.129412,0,.301961,.764706,.254902,0,.403922,.85098,.380392,0,.505882,.933333,.505882,0,.603922,1,.631373,.254902,.705882,1,.756863,.509804,.807843,1,.882353,.764706,.905882,1,1,1,1,1]},{ColorSpace:"Lab",Name:"erdc_purple_BW",RGBPoints:[-1,4264e-11,0,620844e-12,-.87451,.100579,.0593111,.145666,-.74902,.167794,.0889224,.254953,-.623529,.231446,.123339,.360511,-.498039,.296699,.163027,.461278,-.372549,.363211,.209286,.55306,-.247059,.431136,.260776,.637195,-.121569,.498202,.320012,.705799,.00392157,.567456,.380459,.778091,.129412,.629381,.445284,.8448,.254902,.688373,.517374,.895694,.380392,.74891,.590906,.93976,.505882,.805017,.667956,.977626,.631373,.850914,.752618,.992396,.756863,.89724,.838454,.994093,.882353,.948461,.922603,.994449,1,1,1,.999967]},{ColorSpace:"Lab",Name:"erdc_magenta_BW",RGBPoints:[-1,0,0,254023e-10,-.87451,.128696,.0456782,.11635,-.74902,.228133,.0476299,.201452,-.623529,.327273,.0374065,.282107,-.498039,.420953,.0408166,.35709,-.372549,.511562,.0642203,.430511,-.247059,.599552,.102686,.504257,-.121569,.684646,.150536,.579429,.00392157,.765817,.205978,.656062,.129412,.839176,.27229,.731807,.254902,.89536,.357594,.797309,.380392,.930238,.457825,.846984,.505882,.945921,.564536,.880571,.631373,.948995,.670753,.902279,.756863,.947124,.772819,.918171,.882353,.947265,.869424,.934352,1,.954719,.95475,.954726]},{ColorSpace:"Lab",Name:"magenta",RGBPoints:[-1,0,0,0,-.87451,.364706,0,.152941,-.74902,.470588,0,.254902,-.623529,.572549,0,.34902,-.498039,.670588,0,.443137,-.372549,.772549,0,.537255,-.247059,.870588,0,.627451,-.121569,.964706,0,.717647,.00392157,1,.0784314,.772549,.129412,1,.207843,.858824,.254902,1,.32549,.941176,.380392,1,.45098,1,.505882,1,.560784,1,.631373,1,.662745,1,.756863,1,.760784,1,.882353,1,.870588,1,1,1,1,1]},{ColorSpace:"Lab",Name:"RED-PURPLE",RGBPoints:[-1,0,0,0,-.87451,.188235,0,.007843,-.74902,.345098,0,.035294,-.623529,.439216,0,.098039,-.498039,.533333,0,.152941,-.372549,.627451,.015686,.211765,-.247059,.721569,.031373,.266667,-.121569,.8,.047059,.329412,.00392157,.862745,.047059,.403922,.129412,.941176,.062745,.466667,.254902,.988235,.078431,.54902,.380392,.988235,.141176,.643137,.505882,.988235,.25098,.729412,.631373,.988235,.376471,.811765,.756863,.988235,.54902,.886275,.882353,.988235,.752941,.952941,1,.996078,.996078,.996078]},{ColorSpace:"Lab",Name:"erdc_red_BW",RGBPoints:[-1,0,0,0,-.87451,.147204,.0480135,.0401815,-.74902,.253411,.0617478,.0301333,-.623529,.356059,.0746331,.0446897,-.498039,.457731,.0934935,.0636931,-.372549,.557199,.122714,.0860013,-.247059,.665179,.144238,.105585,-.121569,.763833,.187056,.138326,.00392157,.847035,.254558,.189407,.129412,.905663,.345937,.258215,.254902,.941431,.447111,.346277,.380392,.962608,.546927,.457571,.505882,.987833,.637276,.569944,.631373,.994202,.732176,.687958,.756863,.993304,.826268,.800567,.882353,.994413,.917205,.906393,1,1,1,.999979]},{ColorSpace:"Lab",Name:"RED_TEMPERATURE",RGBPoints:[-1,0,0,0,-.87451,.090196,0,0,-.74902,.180392,0,0,-.623529,.270588,0,0,-.498039,.360784,0,0,-.372549,.45098,0,0,-.247059,.545098,0,0,-.121569,.635294,0,0,.00392157,.72549,.058824,0,.129412,.815686,.176471,0,.254902,.905882,.294118,0,.380392,1,.411765,0,.505882,1,.533333,.027451,.631373,1,.65098,.27451,.756863,1,.768627,.521569,.882353,1,.886275,.768627,1,1,1,1]},{ColorSpace:"Lab",Name:"erdc_orange_BW",RGBPoints:[-1,0,0,253806e-10,-.87451,.135871,.0593824,0,-.74902,.224328,.0907216,0,-.623529,.318083,.119647,0,-.498039,.414443,.150246,0,-.372549,.511077,.184884,0,-.247059,.605501,.226033,0,-.121569,.695274,.275491,0,.00392157,.777826,.334445,0,.129412,.851498,.402441,0,.254902,.915899,.47759,602975e-9,.380392,.971984,.557882,.0361443,.505882,1,.641287,.135967,.631373,1,.725198,.27997,.756863,1,.808205,.438135,.882353,1,.89306,.587036,1,1,.977928,.721599]},{ColorSpace:"Lab",Name:"heated_object",RGBPoints:[-1,0,0,0,-.87451,.34902,.0862745,0,-.74902,.45098,.172549,0,-.623529,.52549,.231373,0,-.498039,.580392,.278431,0,-.372549,.623529,.313725,0,-.247059,.670588,.352941,0,-.121569,.717647,.392157,0,.00392157,.772549,.439216,0,.129412,.839216,.494118,0,.254902,.901961,.541176,0,.380392,.968627,.6,0,.505882,1,.658824,0,.631373,1,.721569,0,.756863,1,.827451,.298039,.882353,1,.976471,.72549,1,1,1,1]},{ColorSpace:"Lab",Name:"erdc_gold_BW",RGBPoints:[-1,0,0,190933e-10,-.87451,.128363,.0636265,0,-.74902,.193795,.111057,0,-.623529,.25976,.15987,0,-.498039,.328546,.210589,0,-.372549,.399726,.26332,0,-.247059,.472969,.318261,0,-.121569,.546245,.375827,0,.00392157,.61745,.436719,0,.129412,.685545,.501113,0,.254902,.749578,.568799,0,.380392,.80962,.6394,0,.505882,.865572,.712699,.10257,.631373,.917709,.787569,.233665,.756863,.966914,.863138,.369608,.882353,1,.939405,.496104,1,.999225,1,.612275]},{ColorSpace:"Lab",Name:"erdc_brown_BW",RGBPoints:[-1,33216e-11,0,483629e-11,-.87451,.14693,.0518172,0,-.74902,.225806,.0814996,0,-.623529,.301681,.111452,0,-.498039,.370487,.150664,0,-.372549,.43108,.199477,0,-.247059,.4849,.255107,0,-.121569,.536798,.313486,0,.00392157,.59286,.371167,0,.129412,.653119,.428135,0,.254902,.714589,.485917,.0379541,.380392,.774667,.54565,.116634,.505882,.831222,.608047,.183895,.631373,.880305,.674199,.260298,.756863,.922314,.742472,.367086,.882353,.959408,.811222,.497258,1,.993548,.875183,.622093]},{ColorSpace:"Lab",Name:"copper_Matlab",RGBPoints:[-1,0,0,0,-.87451,.0784314,.0501961,.0313725,-.74902,.156863,.100392,.0627451,-.623529,.235294,.150588,.0941176,-.498039,.313725,.200784,.12549,-.372549,.392157,.25098,.156863,-.247059,.470588,.301176,.188235,-.121569,.54902,.351373,.219608,.00392157,.627451,.401569,.25098,.129412,.705882,.451765,.282353,.254902,.784314,.501961,.313725,.380392,.862745,.552157,.345098,.505882,.941176,.602353,.376471,.631373,1,.652549,.407843,.756863,1,.702745,.439216,.882353,1,.752941,.470588,1,1,.8,.5]},{ColorSpace:"Lab",Name:"pink_Matlab",RGBPoints:[-1,0,0,0,-.87451,.312416,.204524,.204524,-.74902,.441822,.289241,.289241,-.623529,.54112,.354246,.354246,-.498039,.624831,.409048,.409048,-.372549,.698582,.45733,.45733,-.247059,.764404,.502282,.500979,-.121569,.791292,.591516,.54112,.00392157,.817297,.66895,.578481,.129412,.842499,.738308,.613572,.254902,.866968,.801687,.646762,.380392,.890766,.86041,.678329,.505882,.913944,.913944,.711254,.631373,.936549,.936549,.79459,.756863,.958621,.958621,.869979,.882353,.980196,.980196,.939336,1,1,1,1]},{ColorSpace:"Lab",Name:"bone_Matlab",RGBPoints:[-1,0,0,0,-.87451,.054902,.054902,.075817,-.74902,.109804,.109804,.151634,-.623529,.164706,.164706,.227451,-.498039,.219608,.219608,.303268,-.372549,.27451,.27451,.379085,-.247059,.329412,.329902,.454412,-.121569,.384314,.405719,.509314,.00392157,.439216,.481536,.564216,.129412,.494118,.557353,.619118,.254902,.54902,.63317,.67402,.380392,.603922,.708987,.728922,.505882,.660294,.783824,.783824,.631373,.746569,.838725,.838725,.756863,.832843,.893627,.893627,.882353,.919118,.948529,.948529,1,1,1,1]},{ColorSpace:"Lab",Name:"gray_Matlab",RGBPoints:[-1,0,0,0,-.87451,.0627451,.0627451,.0627451,-.74902,.12549,.12549,.12549,-.623529,.188235,.188235,.188235,-.498039,.25098,.25098,.25098,-.372549,.313725,.313725,.313725,-.247059,.376471,.376471,.376471,-.121569,.439216,.439216,.439216,.00392157,.501961,.501961,.501961,.129412,.564706,.564706,.564706,.254902,.627451,.627451,.627451,.380392,.690196,.690196,.690196,.505882,.752941,.752941,.752941,.631373,.815686,.815686,.815686,.756863,.878431,.878431,.878431,.882353,.941176,.941176,.941176,1,1,1,1]},{ColorSpace:"Lab",Name:"Purples",RGBPoints:[-1,.247059,0,.490196,-.87451,.288397,.07677,.525629,-.74902,.32975,.153587,.561092,-.623529,.373057,.236263,.600461,-.498039,.416363,.319,.639923,-.372549,.459669,.405613,.685198,-.247059,.503345,.491534,.730058,-.121569,.562399,.54862,.757616,.00392157,.621453,.606075,.785544,.129412,.680508,.674971,.824914,.254902,.739562,.743406,.863899,.380392,.798616,.800492,.893426,.505882,.85684,.856655,.922491,.631373,.898178,.894056,.942176,.756863,.938654,.930919,.961646,.882353,.964245,.958478,.977393,1,.988235,.984314,.992157]},{ColorSpace:"Lab",Name:"Blues",RGBPoints:[-1,.031373,.188235,.419608,-.87451,.031373,.253195,.516063,-.74902,.031757,.318139,.612149,-.623529,.080969,.38113,.661361,-.498039,.130427,.444152,.710327,-.372549,.195386,.509112,.743791,-.247059,.260715,.573841,.777209,-.121569,.341423,.628958,.808704,.00392157,.422745,.684075,.839892,.129412,.523137,.739193,.861546,.254902,.622684,.793464,.883429,.380392,.701423,.826928,.910988,.505882,.778685,.8603,.937993,.631373,.825928,.891795,.953741,.756863,.87328,.923291,.969489,.882353,.922491,.954787,.985236,1,.968627,.984314,1]},{ColorSpace:"Lab",Name:"Greens",RGBPoints:[-1,0,.266667,.105882,-.87451,0,.347374,.139346,-.74902,538e-6,.427912,.172933,-.623529,.069435,.486967,.222145,-.498039,.138178,.546082,.271326,-.372549,.197232,.609073,.31857,-.247059,.257255,.671742,.365859,-.121569,.357647,.720953,.415071,.00392157,.45767,.769919,.465021,.129412,.546251,.811257,.537855,.254902,.634295,.852211,.610688,.380392,.709097,.883706,.683522,.505882,.78316,.914833,.755894,.631373,.842215,.938454,.818885,.756863,.899977,.961538,.880692,.882353,.935409,.975317,.92203,1,.968627,.988235,.960784]},{ColorSpace:"Lab",Name:"PuBu",RGBPoints:[-1,.301961,0,.294118,-.87451,.404321,.029527,.390573,-.74902,.50599,.059592,.486782,-.623529,.519769,.158016,.551742,-.498039,.533456,.256194,.616301,-.372549,.54133,.33887,.655671,-.247059,.54902,.421592,.695087,-.121569,.54902,.506236,.736424,.00392157,.550127,.590573,.777701,.129412,.585559,.665375,.81707,.254902,.622145,.739023,.855825,.380392,.687105,.784298,.879446,.505882,.752065,.829758,.903253,.631373,.817024,.87897,.930811,.756863,.880907,.927213,.957832,.882353,.926182,.958708,.975548,1,.968627,.988235,.992157]},{ColorSpace:"Lab",Name:"BuPu",RGBPoints:[-1,.007843,.219608,.345098,-.87451,.01178,.286536,.449427,-.74902,.015702,.35328,.553479,-.623529,.01767,.396586,.622376,-.498039,.021115,.4402,.690688,-.372549,.11757,.503191,.722184,-.247059,.214625,.565859,.753633,-.121569,.336671,.615071,.78316,.00392157,.457978,.663975,.812503,.129412,.556401,.703345,.836125,.254902,.65421,.742714,.859669,.380392,.736886,.782084,.881323,.505882,.81827,.821638,.903068,.631373,.873387,.864944,.92669,.756863,.927536,.907605,.949988,.882353,.964937,.9391,.967705,1,1,.968627,.984314]},{ColorSpace:"Lab",Name:"BuGn",RGBPoints:[-1,.031373,.25098,.505882,-.87451,.031373,.329719,.590527,-.74902,.031911,.408397,.674787,-.623529,.100807,.479262,.710219,-.498039,.169704,.550219,.745744,-.372549,.238601,.62699,.787082,-.247059,.307958,.703114,.826759,-.121569,.39654,.752326,.797232,.00392157,.485121,.801046,.767705,.129412,.573702,.83451,.738178,.254902,.661592,.867743,.711034,.380392,.732457,.895302,.74253,.505882,.801845,.922307,.774579,.631373,.841215,.938055,.817885,.756863,.880907,.95391,.861084,.882353,.926182,.971626,.902422,1,.968627,.988235,.941176]},{ColorSpace:"Lab",Name:"GnBu",RGBPoints:[-1,0,.266667,.105882,-.87451,0,.347374,.139346,-.74902,538e-6,.427912,.172933,-.623529,.069435,.486967,.222145,-.498039,.138178,.546175,.272095,-.372549,.197232,.615071,.368551,-.247059,.256609,.683276,.464867,-.121569,.329443,.722645,.555417,.00392157,.403137,.762138,.645413,.129412,.503529,.805444,.718247,.254902,.603922,.848597,.790465,.380392,.704314,.887966,.847551,.505882,.802307,.926321,.903714,.631373,.851519,.944037,.941115,.756863,.899977,.961538,.976901,.882353,.935409,.975317,.984775,1,.968627,.988235,.992157]},{ColorSpace:"Lab",Name:"GnBuPu",RGBPoints:[-1,.003922,.27451,.211765,-.87451,.003922,.349312,.280661,-.74902,.003937,.423852,.349773,-.623529,.005905,.46519,.446228,-.498039,.009443,.506344,.542837,-.372549,.111803,.535871,.649135,-.247059,.214025,.565859,.753633,-.121569,.310481,.615071,.78316,.00392157,.407797,.663975,.812503,.129412,.531811,.703345,.836125,.254902,.65421,.742714,.859669,.380392,.736886,.782084,.881323,.505882,.81827,.821176,.902884,.631373,.873387,.854641,.922568,.756863,.927536,.888535,.942361,.882353,.964937,.929873,.964014,1,1,.968627,.984314]},{ColorSpace:"Lab",Name:"BuGnYl",RGBPoints:[-1,.031373,.113725,.345098,-.87451,.088458,.159,.463206,-.74902,.145052,.204567,.5807,-.623529,.139146,.287243,.620069,-.498039,.13318,.370196,.659562,-.372549,.123337,.470588,.706805,-.247059,.115386,.570335,.753126,-.121569,.186251,.643168,.761,.00392157,.258716,.71514,.768074,.129412,.380761,.760415,.750358,.254902,.503576,.806075,.732795,.380392,.645306,.861192,.719016,.505882,.783899,.91511,.705606,.631373,.858701,.944637,.6997,.756863,.931349,.973303,.698424,.882353,.966782,.987082,.777163,1,1,1,.85098]},{ColorSpace:"Lab",Name:"PuRd",RGBPoints:[-1,.286275,0,.415686,-.87451,.38273,.001968,.441276,-.74902,.479231,.003922,.466774,-.623529,.581592,.003922,.480554,-.498039,.683799,.00549,.494887,-.372549,.776317,.105882,.544098,-.247059,.867866,.206321,.592618,-.121569,.919047,.308681,.612303,.00392157,.968812,.411226,.632603,.129412,.974717,.519493,.671972,.254902,.980546,.626451,.71065,.380392,.984483,.701253,.732303,.505882,.988328,.77504,.755617,.631373,.990296,.828189,.812703,.756863,.992372,.880907,.869035,.882353,.996309,.926182,.912341,1,1,.968627,.952941]},{ColorSpace:"Lab",Name:"RdPu",RGBPoints:[-1,.403922,0,.121569,-.87451,.500377,0,.192434,-.74902,.596909,277e-6,.263037,-.623529,.703206,.035709,.300438,-.498039,.808612,.071296,.338854,-.372549,.857824,.116571,.441215,-.247059,.905513,.163552,.54293,-.121569,.889765,.281661,.617732,.00392157,.873156,.39897,.691611,.129412,.82985,.491488,.736886,.254902,.789081,.583237,.781853,.380392,.810734,.656071,.819254,.505882,.833126,.729181,.85684,.631373,.870527,.80792,.898178,.756863,.907605,.884398,.938331,.882353,.9391,.921799,.958016,1,.968627,.956863,.976471]},{ColorSpace:"Lab",Name:"Oranges",RGBPoints:[-1,.498039,.152941,.015686,-.87451,.57481,.182468,.013718,-.74902,.651765,.212042,.011734,-.623529,.752157,.247474,.007797,-.498039,.851719,.283368,.004475,-.372549,.898962,.348328,.039908,-.247059,.945652,.413426,.076401,-.121569,.969273,.484291,.157109,.00392157,.992157,.554971,.238185,.129412,.992157,.619931,.330704,.254902,.992157,.684967,.423837,.380392,.992157,.751895,.532103,.505882,.992249,.817716,.639354,.631373,.994218,.861023,.725967,.756863,.996186,.903576,.810965,.882353,.998155,.933103,.868051,1,1,.960784,.921569]},{ColorSpace:"Lab",Name:"Reds",RGBPoints:[-1,.403922,0,.05098,-.87451,.525967,.029527,.066728,-.74902,.647643,.058962,.082476,-.623529,.722445,.076678,.098224,-.498039,.797186,.095194,.114187,-.372549,.868051,.164091,.143714,-.247059,.937809,.233541,.173933,-.121569,.96143,.326059,.232987,.00392157,.984375,.418147,.292657,.129412,.986344,.496886,.371396,.254902,.988235,.575702,.450673,.380392,.988235,.656409,.543191,.505882,.98842,.736747,.635894,.631373,.992357,.809581,.732349,.756863,.996186,.880692,.826759,.882353,.998155,.92203,.885813,1,1,.960784,.941176]},{ColorSpace:"Lab",Name:"RdOr",RGBPoints:[-1,.498039,0,0,-.87451,.6004,0,0,-.74902,.702514,738e-6,477e-6,-.623529,.773379,.095225,.061499,-.498039,.843875,.189865,.12283,-.372549,.891119,.294195,.203537,-.247059,.937855,.397924,.283137,-.121569,.963445,.476663,.316601,.00392157,.988297,.555771,.351665,.129412,.990265,.646321,.436309,.254902,.992157,.735256,.519646,.380392,.992157,.784468,.570827,.505882,.992249,.833218,.623483,.631373,.994218,.872587,.706159,.756863,.996186,.911419,.788189,.882353,.998155,.940946,.859054,1,1,.968627,.92549]},{ColorSpace:"Lab",Name:"BrOrYl",RGBPoints:[-1,.4,.145098,.023529,-.87451,.500392,.174625,.019592,-.74902,.600784,.204291,.015656,-.623529,.701176,.251534,.011719,-.498039,.800984,.299146,.008397,-.372549,.863975,.370012,.043829,-.247059,.926321,.441107,.0794,-.121569,.961753,.521815,.120738,.00392157,.996078,.602645,.163122,.129412,.996078,.68729,.237924,.254902,.996078,.771011,.314879,.380392,.996078,.832034,.444798,.505882,.996171,.892042,.572595,.631373,.998139,.931411,.65724,.756863,1,.969489,.741669,.882353,1,.985236,.822376,1,1,1,.898039]},{ColorSpace:"Lab",Name:"RdOrYl",RGBPoints:[-1,.501961,0,.14902,-.87451,.622038,0,.14902,-.74902,.741761,4e-4,.148866,-.623529,.816563,.05158,.129181,-.498039,.890965,.10356,.110235,-.372549,.940177,.205921,.137793,-.247059,.988281,.308789,.165536,-.121569,.99025,.432803,.200969,.00392157,.992218,.555217,.236278,.129412,.994187,.628051,.267774,.254902,.996078,.701038,.301269,.380392,.996078,.777809,.383945,.505882,.996171,.852826,.466621,.631373,.998139,.892195,.549296,.756863,1,.931349,.632188,.882353,1,.966782,.7188,1,1,1,.8]},{ColorSpace:"Lab",Name:"CIELab_blue2red",RGBPoints:[-1,0,.6,.74902,1,.76863,.46667,.34118]},{ColorSpace:"Lab",Name:"blue2yellow",RGBPoints:[-1,0,0,1,0,.5,.5,.5,1,1,1,0]},{ColorSpace:"Lab",Name:"erdc_blue2gold",RGBPoints:[-1,.175119,.0438468,1,-.874016,.22383,.159771,.94557,-.748031,.27254,.233611,.891216,-.622047,.321251,.296526,.836857,-.496063,.369962,.354296,.782359,-.370079,.418672,.409139,.72754,-.244094,.467383,.462152,.672148,-.11811,.51609,.51396,.615825,.00787402,.572863,.55452,.559172,.133858,.630269,.593822,.517729,.259843,.689588,.624668,.47446,.385827,.745394,.656113,.428638,.511811,.798624,.688104,.379105,.637795,.849926,.720593,.323834,.76378,.899765,.753543,.258657,.889764,.948487,.78692,.171778,1,.990413,.816451,.00729848]},{ColorSpace:"Lab",Name:"erdc_blue2yellow",RGBPoints:[-1,.0830122,0,.495617,-.87451,.141973,.0551288,.57363,-.74902,.193048,.110258,.604561,-.623529,.234231,.165386,.57643,-.498039,.275413,.220515,.548299,-.372549,.316596,.275644,.520169,-.247059,.357778,.330773,.492038,-.121569,.398961,.385901,.463908,.00392157,.449929,.438487,.426815,.129412,.511572,.488299,.379944,.254902,.581222,.53603,.325741,.380392,.650871,.583761,.271538,.505882,.720521,.631493,.217335,.631373,.79017,.679224,.163132,.756863,.85982,.726955,.108929,.882353,.910254,.774159,.14112,1,.927513,.81759,.306289]},{ColorSpace:"Lab",Name:"erdc_cyan2orange",RGBPoints:[-1,.0471513,.213874,.414329,-.87451,.0674702,.256648,.439027,-.74902,.0959957,.299331,.462089,-.623529,.132428,.341872,.483212,-.498039,.188743,.38277,.500597,-.372549,.268511,.420229,.512179,-.247059,.352945,.455602,.519101,-.121569,.43893,.489368,.521538,.00392157,.522445,.522495,.522436,.129412,.600089,.555682,.53205,.254902,.67988,.587981,.539163,.380392,.761011,.619586,.544439,.505882,.84278,.650741,.548567,.631373,.910713,.687347,.557822,.756863,.952232,.734972,.577775,.882353,.975642,.789858,.604868,1,.990752,.843643,.632857]},{ColorSpace:"Lab",Name:"erdc_purple2green",RGBPoints:[-1,.235006,.0483128,.530899,-.87451,.302968,.108419,.552391,-.74902,.360241,.166059,.569502,-.623529,.406746,.226782,.579373,-.498039,.444073,.28964,.582094,-.372549,.473648,.353774,.577947,-.247059,.497636,.418154,.567911,-.121569,.519086,.481741,.553968,.00392157,.542884,.542914,.542875,.129412,.566303,.603989,.527499,.254902,.595218,.662965,.516857,.380392,.628641,.720701,.510673,.505882,.665373,.777849,.508165,.631373,.704182,.834921,.508303,.756863,.743846,.892328,.50999,.882353,.783158,.950422,.512181,1,.818617,1,.513888]},{ColorSpace:"Lab",Name:"erdc_purple2green_dark",RGBPoints:[-1,.107656,0,.428682,-.87451,.1924,0,.449799,-.74902,.255118,.0648939,.466726,-.623529,.304256,.133066,.476703,-.498039,.343202,.19716,.479793,-.372549,.373876,.260353,.476241,-.247059,.398497,.322872,.466953,-.121569,.420016,.384252,.453785,.00392157,.44319,.443216,.443186,.129412,.465553,.502139,.428233,.254902,.492959,.559151,.417591,.380392,.524654,.615092,.411016,.505882,.55959,.670583,.40779,.631373,.596614,.726102,.406948,.756863,.634544,.782032,.407439,.882353,.672183,.838703,.408237,1,.706131,.892759,.408452]},{ColorSpace:"Lab",Name:"coolwarm",RGBPoints:[-1,.229806,.298718,.753683,-.875,.303869,.406535,.844959,-.75,.383013,.509419,.917388,-.625,.466667,.604563,.968155,-.5,.552953,.688929,.995376,-.375,.639176,.7596,.998151,-.25,.722193,.813953,.976575,-.125,.798692,.849786,.931689,0,.865395,.86541,.865396,.125,.924128,.827385,.774508,.25,.958853,.769768,.678008,.375,.969954,.694267,.579375,.5,.958003,.602842,.481776,.625,.923945,.497309,.38797,.75,.869187,.378313,.300267,.875,.795632,.241284,.220526,1,.705673,.0155562,.150233]},{ColorSpace:"Lab",Name:"BuRd",RGBPoints:[-1,.019608,.188235,.380392,-.87451,.088504,.321107,.564937,-.74902,.163399,.444983,.697501,-.623529,.247059,.555709,.754095,-.498039,.420684,.676432,.818685,-.372549,.606459,.789773,.880277,-.247059,.761476,.868512,.924567,-.121569,.878047,.925721,.951942,.00392157,.969089,.966474,.964937,.129412,.983852,.897578,.846828,.254902,.982468,.800692,.706113,.380392,.960323,.66782,.536332,.505882,.894579,.503806,.399769,.631373,.81707,.33218,.281046,.756863,.728489,.155017,.197386,.882353,.576932,.055363,.14925,1,.403922,0,.121569]},{ColorSpace:"Lab",Name:"Spectral_lowBlue",RGBPoints:[-1,.368627,.309804,.635294,-.87451,.260361,.450058,.70173,-.74902,.248058,.591311,.717186,-.623529,.376009,.734025,.658132,-.498039,.537947,.814764,.64506,-.372549,.702345,.879585,.636678,-.247059,.84752,.938639,.607151,-.121569,.940408,.976163,.656055,.00392157,.999923,.997616,.745021,.129412,.997463,.921338,.61707,.254902,.995002,.824606,.499885,.380392,.992541,.701576,.39654,.505882,.973472,.547405,.318108,.631373,.937793,.398539,.270127,.756863,.861515,.282891,.299654,.882353,.746482,.144637,.288812,1,.619608,.003922,.258824]},{ColorSpace:"Lab",Name:"GnRP",RGBPoints:[-1,0,.266667,.105882,-.87451,.066436,.394617,.174779,-.74902,.168858,.524567,.25767,-.623529,.323875,.657439,.361015,-.498039,.504883,.772318,.506344,-.372549,.678431,.870127,.654902,-.247059,.803922,.921799,.780392,-.121569,.897116,.951942,.882814,.00392157,.967397,.965936,.967474,.129412,.928028,.879815,.930565,.254902,.866052,.780777,.882891,.380392,.77501,.665129,.821376,.505882,.675663,.537024,.737024,.631373,.57847,.396155,.645982,.756863,.492349,.223914,.547559,.882353,.375548,.096886,.423299,1,.25098,0,.294118]},{ColorSpace:"Lab",Name:"GYPi",RGBPoints:[-1,.152941,.392157,.098039,-.87451,.246444,.505344,.117724,-.74902,.351942,.614533,.161399,-.623529,.474971,.717878,.240138,-.498039,.611995,.811226,.392849,-.372549,.746328,.893118,.565321,-.247059,.859516,.94233,.747405,-.121569,.928105,.96386,.875663,.00392157,.969089,.966859,.968012,.129412,.983852,.910265,.948328,.254902,.979239,.833218,.914648,.380392,.949712,.729873,.862976,.505882,.905652,.58293,.763552,.631373,.85521,.410073,.652211,.756863,.793695,.183699,.531642,.882353,.683737,.063899,.420761,1,.556863,.003922,.321569]},{ColorSpace:"Lab",Name:"GnYlRd",RGBPoints:[-1,0,.407843,.215686,-.87451,.063975,.525952,.277201,-.74902,.177932,.633064,.332718,-.623529,.364937,.724106,.379469,-.498039,.527951,.797155,.40223,-.372549,.678431,.862822,.433449,-.247059,.803922,.916955,.514648,-.121569,.909419,.961861,.625067,.00392157,.999923,.997616,.745021,.129412,.997463,.921338,.61707,.254902,.995002,.824606,.499885,.380392,.992541,.701576,.39654,.505882,.973472,.547405,.318108,.631373,.939023,.389927,.245521,.756863,.867666,.239831,.176624,.882353,.762399,.110727,.151326,1,.647059,0,.14902]},{ColorSpace:"Lab",Name:"GBBr",RGBPoints:[-1,0,.235294,.188235,-.87451,.002461,.338639,.301423,-.74902,.055902,.448981,.417609,-.623529,.183852,.56955,.538178,-.498039,.357785,.700115,.660746,-.372549,.540177,.819531,.77624,-.247059,.714879,.890888,.864821,-.121569,.851134,.934564,.922645,.00392157,.960861,.959785,.95694,.129412,.963322,.927797,.83391,.254902,.939946,.868897,.68935,.380392,.883353,.775394,.517109,.505882,.808074,.625836,.324106,.631373,.717647,.476355,.15494,.756863,.592157,.358247,.06882,.882353,.458593,.26436,.031142,1,.329412,.188235,.019608]},{ColorSpace:"Lab",Name:"PuOr",RGBPoints:[-1,.498039,.231373,.031373,-.87451,.62599,.30273,.026451,-.74902,.746943,.387082,.037524,-.623529,.85767,.490427,.071972,-.498039,.936409,.617762,.236371,-.372549,.992695,.743099,.43291,-.247059,.995156,.841523,.63714,-.121569,.985313,.913802,.813687,.00392157,.966244,.966398,.967705,.129412,.889965,.89504,.938178,.254902,.806151,.804306,.894656,.380392,.712649,.688658,.833141,.505882,.594233,.554325,.744637,.631373,.474894,.404229,.652364,.756863,.366628,.217224,.563783,.882353,.266436,.089965,.434833,1,.176471,0,.294118]},{ColorSpace:"Lab",Name:"PRGn",RGBPoints:[-1,.25098,0,.294118,-.87451,.383852,.103345,.431911,-.74902,.497732,.234679,.55371,-.623529,.583852,.40692,.652134,-.498039,.681968,.545175,.742561,-.372549,.7807,.672357,.825221,-.247059,.871742,.788005,.886736,-.121569,.930488,.885198,.932872,.00392157,.966321,.968089,.965859,.129412,.892503,.950865,.877278,.254902,.796078,.91857,.772549,.380392,.670588,.866897,.647059,.505882,.493195,.765398,.496655,.631373,.314187,.649135,.354556,.756863,.15917,.516263,.251211,.882353,.062284,.386621,.170473,1,0,.266667,.105882]},{ColorSpace:"Lab",Name:"PiYG",RGBPoints:[-1,.556863,.003922,.321569,-.87451,.692195,.067897,.427374,-.74902,.797539,.197847,.539177,-.623529,.859054,.424221,.659746,-.498039,.908574,.592618,.770319,-.372549,.951557,.736332,.866205,-.247059,.981084,.839677,.917878,-.121569,.98293,.913802,.949558,.00392157,.96732,.968474,.965629,.129412,.92549,.963552,.869666,.254902,.852441,.939254,.736025,.380392,.739254,.890042,.553941,.505882,.60323,.805536,.382238,.631373,.467282,.711419,.235217,.756863,.344252,.608074,.156478,.882353,.2406,.49827,.116494,1,.152941,.392157,.098039]},{ColorSpace:"Lab",Name:"OrPu",RGBPoints:[-1,.176471,0,.294118,-.87451,.272434,.095963,.444214,-.74902,.373395,.228912,.56932,-.623529,.481661,.415917,.657901,-.498039,.601922,.562937,.750481,-.372549,.718493,.695886,.836986,-.247059,.811995,.811534,.898501,-.121569,.894733,.8995,.940023,.00392157,.969166,.966859,.963629,.129412,.98639,.910265,.803691,.254902,.995002,.835371,.624375,.380392,.992541,.736947,.420146,.505882,.931949,.609458,.224221,.631373,.85075,.483968,.069819,.756863,.740023,.380623,.035371,.882353,.617993,.29827,.026759,1,.498039,.231373,.031373]},{ColorSpace:"Lab",Name:"BrBG",RGBPoints:[-1,.329412,.188235,.019608,-.87451,.467205,.269435,.031911,-.74902,.6,.365629,.074202,-.623529,.72549,.483737,.160323,-.498039,.812995,.635832,.336409,-.372549,.88689,.781238,.527874,-.247059,.943483,.87474,.700115,-.121569,.963168,.929796,.841599,.00392157,.957247,.959938,.959554,.129412,.84406,.932872,.920185,.254902,.70396,.886428,.859285,.380392,.529258,.815071,.770704,.505882,.346251,.691811,.653057,.631373,.175855,.562015,.530642,.756863,.047905,.441446,.410073,.882353,.002307,.33218,.294348,1,0,.235294,.188235]},{ColorSpace:"Lab",Name:"GyRd",RGBPoints:[-1,.101961,.101961,.101961,-.87451,.227451,.227451,.227451,-.74902,.359939,.359939,.359939,-.623529,.502653,.502653,.502653,-.498039,.631373,.631373,.631373,-.372549,.749865,.749865,.749865,-.247059,.843368,.843368,.843368,-.121569,.926105,.926105,.926105,.00392157,.999846,.997232,.995694,.129412,.994925,.908651,.857901,.254902,.982468,.800692,.706113,.380392,.960323,.66782,.536332,.505882,.894579,.503806,.399769,.631373,.81707,.33218,.281046,.756863,.728489,.155017,.197386,.882353,.576932,.055363,.14925,1,.403922,0,.121569]},{ColorSpace:"Lab",Name:"erdc_divHi_purpleGreen",RGBPoints:[-1,.297553,0,.489074,-.87451,.40259,.151146,.567754,-.74902,.516038,.284843,.658231,-.623529,.629783,.423646,.750938,-.498039,.735198,.563697,.835956,-.372549,.82408,.695541,.903582,-.247059,.889091,.807454,.944862,-.121569,.92334,.886917,.951839,.00392157,.921045,.921084,.921003,.129412,.877324,.907455,.845381,.254902,.797649,.849713,.734695,.380392,.691646,.75964,.600532,.505882,.568981,.649159,.453807,.631373,.438945,.529756,.304259,.756863,.30973,.412001,.158303,.882353,.187078,.305111,.00251458,1,.101655,.220836,0]},{ColorSpace:"Lab",Name:"erdc_divHi_purpleGreen_dim",RGBPoints:[-1,.404088,.131038,.592767,-.87451,.486469,.230957,.651243,-.74902,.575165,.339335,.717723,-.623529,.662741,.454332,.784263,-.498039,.742071,.570213,.842918,-.372549,.806935,.678992,.886227,-.247059,.852219,.771315,.90763,-.121569,.873345,.837327,.901572,.00392157,.866783,.86682,.866745,.129412,.82839,.858225,.796812,.254902,.762578,.814287,.700202,.380392,.676429,.744229,.585735,.505882,.577033,.65732,.461526,.631373,.47128,.562476,.33476,.756863,.365461,.467957,.21076,.882353,.264758,.381138,.0878313,1,.182591,.312249,0]},{ColorSpace:"Lab",Name:"erdc_divLow_icePeach",RGBPoints:[-1,.480048,.817441,.998056,-.87451,.425898,.726921,.883187,-.74902,.366682,.629445,.761936,-.623529,.308756,.531002,.640217,-.498039,.258021,.43705,.523433,-.372549,.219244,.352381,.416348,-.247059,.195127,.281032,.322979,-.121569,.186286,.22627,.246525,.00392157,.192352,.19236,.192364,.129412,.255927,.214469,.191756,.254902,.340459,.254426,.206666,.380392,.444655,.309315,.234029,.505882,.565353,.376004,.270969,.631373,.697917,.450748,.314293,.756863,.836657,.529064,.360227,.882353,.972695,.614884,.413123,1,1,.705904,.472699]},{ColorSpace:"Lab",Name:"erdc_divLow_purpleGreen",RGBPoints:[-1,.956034,.666487,.952663,-.87451,.874457,.572698,.936352,-.74902,.753465,.488253,.909063,-.623529,.63309,.413507,.763833,-.498039,.514491,.345878,.620015,-.372549,.405008,.288141,.484376,-.247059,.311388,.241986,.363556,-.121569,.238722,.209044,.263449,.00392157,.192352,.192366,.192362,.129412,.200379,.233201,.168618,.254902,.230151,.291737,.165227,.380392,.279481,.366076,.178607,.505882,.344927,.453267,.205703,.631373,.421554,.549449,.242643,.756863,.503334,.649999,.284377,.882353,.583497,.749672,.324969,1,.650705,.837228,.356264]},{ColorSpace:"Lab",Name:"Haze_green",RGBPoints:[-1,1,.835294,.886275,-.87451,.937255,.756863,.870443,-.74902,.875817,.666376,.857807,-.623529,.778359,.583007,.808134,-.498039,.676253,.494118,.745098,-.372549,.561365,.390123,.682353,-.247059,.438344,.262745,.621496,-.121569,.321133,.141031,.558751,.00392157,.203922,.0217865,.495861,.129412,.265505,.129412,.433261,.254902,.311692,.255338,.37008,.380392,.356282,.377342,.310821,.505882,.39971,.488889,.258243,.631373,.442556,.604357,.205519,.756863,.48671,.71968,.152941,.882353,.529847,.830356,.100944,1,.572549,.933333,.054902]},{ColorSpace:"Lab",Name:"Haze_lime",RGBPoints:[-1,.704034,.784196,1,-.87451,.633111,.691418,.956078,-.74902,.564021,.600606,.912157,-.623529,.496827,.51189,.868235,-.498039,.43157,.425416,.824314,-.372549,.368248,.341347,.780392,-.247059,.306767,.259855,.736471,-.121569,.246862,.181069,.692549,.00392157,.191619,.109542,.648627,.129412,.257404,.194031,.604706,.254902,.321794,.278775,.560784,.380392,.387909,.364617,.516863,.505882,.456569,.451881,.472941,.631373,.527424,.540773,.42902,.756863,.599759,.631427,.385098,.882353,.673065,.723898,.341176,1,.742751,.812252,.3]},{ColorSpace:"RGB",Name:"Haze",RGBPoints:[-1,1,.835294,.996078,-.00392157,.023529,.141176,.498039,.00392157,.015686,.137255,.494118,1,.984314,.764706,0]},{ColorSpace:"Lab",Name:"Haze_cyan",RGBPoints:[-1,.956863,1,.835294,-.87451,.933188,.921714,.760784,-.74902,.870588,.803486,.671605,-.623529,.807843,.684096,.583297,-.498039,.745098,.569208,.494118,-.372549,.682353,.437763,.390123,-.247059,.621496,.288163,.262745,-.121569,.558751,.144517,.141031,.00392157,.495861,.0217865,.0413943,.129412,.433261,.137255,.129412,.254902,.37008,.263181,.255338,.380392,.306318,.381845,.372694,.505882,.243137,.503994,.494263,.631373,.180392,.629484,.619753,.756863,.117647,.754975,.747131,.882353,.054902,.876398,.866812,1,0,.988235,.976471]},{ColorSpace:"Lab",Name:"nic_Edge",RGBPoints:[-1,.191208,.191208,.191208,-.87451,.239484,.00545035,.614821,-.74902,.220593,.0617459,.863547,-.623529,.17509,.278988,.97794,-.498039,.143526,.576069,.998553,-.372549,.166456,.871883,.96594,-.247059,.376202,.993555,.981833,-.121569,.681996,.991297,.999239,.00392157,.954172,.952734,.94374,.129412,.999735,.99301,.662896,.254902,.979399,.991466,.357973,.380392,.968771,.854967,.162659,.505882,.999245,.556697,.144323,.631373,.973959,.26223,.177946,.756863,.852358,.0526707,.222974,.882353,.593889,.00912724,.238855,1,.191208,.191208,.191208]},{ColorSpace:"Lab",Name:"erdc_iceFire_H",RGBPoints:[-1,405432e-12,0,590122e-11,-.87451,0,.120401,.302675,-.74902,0,.216583,.524574,-.623529,.0552475,.345025,.6595,-.498039,.128047,.492588,.720288,-.372549,.188955,.641309,.792092,-.247059,.327673,.784935,.873434,-.121569,.60824,.892164,.935547,.00392157,.881371,.912178,.818099,.129412,.951407,.835621,.449279,.254902,.904481,.690489,0,.380392,.85407,.510864,0,.505882,.777093,.33018,88199e-8,.631373,.672862,.139087,.00269398,.756863,.508815,0,0,.882353,.299417,366289e-9,547829e-9,1,.0157519,.00332021,455569e-13]},{ColorSpace:"Lab",Name:"erdc_iceFire_L",RGBPoints:[-1,.870485,.913768,.832905,-.87451,.586919,.887865,.934003,-.74902,.31583,.776442,.867858,-.623529,.18302,.632034,.787722,-.498039,.117909,.484134,.713825,-.372549,.0507239,.335979,.654741,-.247059,0,.209874,.511832,-.121569,0,.114689,.28935,.00392157,.0157519,.00332021,455569e-13,.129412,.312914,0,0,.254902,.520865,0,0,.380392,.680105,.15255,.0025996,.505882,.785109,.339479,797922e-9,.631373,.857354,.522494,0,.756863,.910974,.699774,0,.882353,.951921,.842817,.478545,1,.881371,.912178,.818099]},{ColorSpace:"RGB",Name:"hsv",RGBPoints:[-1,1,0,0,-.666666,1,0,1,-.333333,0,0,1,0,0,1,1,.33333,0,1,0,.66666,1,1,0,1,1,0,0]},{ColorSpace:"Lab",Name:"hue_L60",RGBPoints:[-1,.964784,.400592,.349549,-.87451,.964915,.372498,.53785,-.74902,.892353,.401039,.759569,-.623529,.79263,.446956,.903017,-.498039,.682208,.49954,.966673,-.372549,.56392,.553082,.968836,-.247059,.442031,.606396,.901601,-.121569,.305499,.65701,.765784,.00392157,.197251,.687914,.620914,.129412,.193882,.701887,.472654,.254902,.249866,.706123,.320005,.380392,.35132,.697417,.202919,.505882,.498097,.669467,.125232,.631373,.637477,.626239,.107431,.756863,.762115,.56872,.155812,.882353,.889434,.481116,.240445,1,.964784,.400592,.349549]},{IndexedColors:[0,0,0,.8941176470588236,.1019607843137255,.1098039215686274,.2156862745098039,.4941176470588236,.7215686274509804,.3019607843137255,.6862745098039216,.2901960784313726,.596078431372549,.3058823529411765,.6392156862745098,1,.4980392156862745,0,.6509803921568628,.3372549019607843,.1568627450980392],Name:"Spectrum",NanColor:[.6509803921568628,.3372549019607843,.1568627450980392]},{IndexedColors:[.4745098039215686,.09019607843137255,.09019607843137255,.7098039215686275,.00392156862745098,.00392156862745098,.9372549019607843,.2784313725490196,.09803921568627451,.9764705882352941,.5137254901960784,.1411764705882353,1,.7058823529411765,0,1,.8980392156862745,.02352941176470588],Name:"Warm",NanColor:[1,.8980392156862745,.02352941176470588]},{IndexedColors:[.4588235294117647,.6941176470588235,.00392156862745098,.3450980392156863,.5019607843137255,.1607843137254902,.3137254901960784,.8431372549019608,.7490196078431373,.1098039215686274,.5843137254901961,.803921568627451,.2313725490196079,.407843137254902,.6705882352941176,.6039215686274509,.407843137254902,1,.3725490196078431,.2,.5019607843137255],Name:"Cool",NanColor:[.3725490196078431,.2,.5019607843137255]},{IndexedColors:[.2313725490196079,.407843137254902,.6705882352941176,.1098039215686274,.5843137254901961,.803921568627451,.3058823529411765,.8509803921568627,.9176470588235294,.4509803921568628,.6039215686274509,.8352941176470589,.2588235294117647,.2392156862745098,.6627450980392157,.3137254901960784,.3294117647058823,.5294117647058824,.06274509803921569,.1647058823529412,.3215686274509804],Name:"Blues",NanColor:[.06274509803921569,.1647058823529412,.3215686274509804]},{IndexedColors:[.1098039215686274,.5843137254901961,.803921568627451,.2313725490196079,.407843137254902,.6705882352941176,.4,.2431372549019608,.7176470588235294,.6352941176470588,.3294117647058823,.8117647058823529,.8705882352941177,.3803921568627451,.807843137254902,.8627450980392157,.3803921568627451,.5843137254901961,.2392156862745098,.06274509803921569,.3215686274509804],Name:"Wild Flower",NanColor:[.2392156862745098,.06274509803921569,.3215686274509804]},{IndexedColors:[.396078431372549,.4862745098039216,.2156862745098039,.4588235294117647,.6941176470588235,.00392156862745098,.6980392156862745,.7294117647058823,.1882352941176471,1,.8980392156862745,.02352941176470588,1,.7058823529411765,0,.9764705882352941,.5137254901960784,.1411764705882353],Name:"Citrus",NanColor:[.9764705882352941,.5137254901960784,.1411764705882353]},{IndexedColors:[.4980392156862745,.2313725490196079,.03137254901960784,.7019607843137254,.3450980392156863,.02352941176470588,.8784313725490196,.5098039215686274,.0784313725490196,.9921568627450981,.7215686274509804,.3882352941176471,.996078431372549,.8784313725490196,.7137254901960784,.9686274509803922,.9686274509803922,.9686274509803922,.8470588235294118,.8549019607843137,.9215686274509803,.6980392156862745,.6705882352941176,.8235294117647058,.5019607843137255,.4509803921568628,.6745098039215687,.3294117647058823,.1529411764705882,.5333333333333333,.1764705882352941,0,.2941176470588235],Name:"Brewer Diverging Purple-Orange (11)",NanColor:[.1764705882352941,0,.2941176470588235]},{IndexedColors:[.4980392156862745,.2313725490196079,.03137254901960784,.7019607843137254,.3450980392156863,.02352941176470588,.8784313725490196,.5098039215686274,.0784313725490196,.9921568627450981,.7215686274509804,.3882352941176471,.996078431372549,.8784313725490196,.7137254901960784,.8470588235294118,.8549019607843137,.9215686274509803,.6980392156862745,.6705882352941176,.8235294117647058,.5019607843137255,.4509803921568628,.6745098039215687,.3294117647058823,.1529411764705882,.5333333333333333,.1764705882352941,0,.2941176470588235],Name:"Brewer Diverging Purple-Orange (10)",NanColor:[.1764705882352941,0,.2941176470588235]},{IndexedColors:[.7019607843137254,.3450980392156863,.02352941176470588,.8784313725490196,.5098039215686274,.0784313725490196,.9921568627450981,.7215686274509804,.3882352941176471,.996078431372549,.8784313725490196,.7137254901960784,.9686274509803922,.9686274509803922,.9686274509803922,.8470588235294118,.8549019607843137,.9215686274509803,.6980392156862745,.6705882352941176,.8235294117647058,.5019607843137255,.4509803921568628,.6745098039215687,.3294117647058823,.1529411764705882,.5333333333333333],Name:"Brewer Diverging Purple-Orange (9)",NanColor:[.3294117647058823,.1529411764705882,.5333333333333333]},{IndexedColors:[.7019607843137254,.3450980392156863,.02352941176470588,.8784313725490196,.5098039215686274,.0784313725490196,.9921568627450981,.7215686274509804,.3882352941176471,.996078431372549,.8784313725490196,.7137254901960784,.8470588235294118,.8549019607843137,.9215686274509803,.6980392156862745,.6705882352941176,.8235294117647058,.5019607843137255,.4509803921568628,.6745098039215687,.3294117647058823,.1529411764705882,.5333333333333333],Name:"Brewer Diverging Purple-Orange (8)",NanColor:[.3294117647058823,.1529411764705882,.5333333333333333]},{IndexedColors:[.7019607843137254,.3450980392156863,.02352941176470588,.9450980392156862,.6392156862745098,.2509803921568627,.996078431372549,.8784313725490196,.7137254901960784,.9686274509803922,.9686274509803922,.9686274509803922,.8470588235294118,.8549019607843137,.9215686274509803,.6,.5568627450980392,.7647058823529411,.3294117647058823,.1529411764705882,.5333333333333333],Name:"Brewer Diverging Purple-Orange (7)",NanColor:[.3294117647058823,.1529411764705882,.5333333333333333]},{IndexedColors:[.7019607843137254,.3450980392156863,.02352941176470588,.9450980392156862,.6392156862745098,.2509803921568627,.996078431372549,.8784313725490196,.7137254901960784,.8470588235294118,.8549019607843137,.9215686274509803,.6,.5568627450980392,.7647058823529411,.3294117647058823,.1529411764705882,.5333333333333333],Name:"Brewer Diverging Purple-Orange (6)",NanColor:[.3294117647058823,.1529411764705882,.5333333333333333]},{IndexedColors:[.9019607843137255,.3803921568627451,.00392156862745098,.9921568627450981,.7215686274509804,.3882352941176471,.9686274509803922,.9686274509803922,.9686274509803922,.6980392156862745,.6705882352941176,.8235294117647058,.3686274509803922,.2352941176470588,.6],Name:"Brewer Diverging Purple-Orange (5)",NanColor:[.3686274509803922,.2352941176470588,.6]},{IndexedColors:[.9019607843137255,.3803921568627451,.00392156862745098,.9921568627450981,.7215686274509804,.3882352941176471,.6980392156862745,.6705882352941176,.8235294117647058,.3686274509803922,.2352941176470588,.6],Name:"Brewer Diverging Purple-Orange (4)",NanColor:[.3686274509803922,.2352941176470588,.6]},{IndexedColors:[.9450980392156862,.6392156862745098,.2509803921568627,.9686274509803922,.9686274509803922,.9686274509803922,.6,.5568627450980392,.7647058823529411],Name:"Brewer Diverging Purple-Orange (3)",NanColor:[.6,.5568627450980392,.7647058823529411]},{IndexedColors:[.6196078431372549,.00392156862745098,.2588235294117647,.8352941176470589,.2431372549019608,.3098039215686275,.9568627450980393,.4274509803921568,.2627450980392157,.9921568627450981,.6823529411764706,.3803921568627451,.996078431372549,.8784313725490196,.5450980392156862,1,1,.7490196078431373,.9019607843137255,.9607843137254902,.596078431372549,.6705882352941176,.8666666666666667,.6431372549019608,.4,.7607843137254902,.6470588235294118,.196078431372549,.5333333333333333,.7411764705882353,.3686274509803922,.3098039215686275,.6352941176470588],Name:"Brewer Diverging Spectral (11)",NanColor:[.3686274509803922,.3098039215686275,.6352941176470588]},{IndexedColors:[.6196078431372549,.00392156862745098,.2588235294117647,.8352941176470589,.2431372549019608,.3098039215686275,.9568627450980393,.4274509803921568,.2627450980392157,.9921568627450981,.6823529411764706,.3803921568627451,.996078431372549,.8784313725490196,.5450980392156862,.9019607843137255,.9607843137254902,.596078431372549,.6705882352941176,.8666666666666667,.6431372549019608,.4,.7607843137254902,.6470588235294118,.196078431372549,.5333333333333333,.7411764705882353,.3686274509803922,.3098039215686275,.6352941176470588],Name:"Brewer Diverging Spectral (10)",NanColor:[.3686274509803922,.3098039215686275,.6352941176470588]},{IndexedColors:[.8352941176470589,.2431372549019608,.3098039215686275,.9568627450980393,.4274509803921568,.2627450980392157,.9921568627450981,.6823529411764706,.3803921568627451,.996078431372549,.8784313725490196,.5450980392156862,1,1,.7490196078431373,.9019607843137255,.9607843137254902,.596078431372549,.6705882352941176,.8666666666666667,.6431372549019608,.4,.7607843137254902,.6470588235294118,.196078431372549,.5333333333333333,.7411764705882353],Name:"Brewer Diverging Spectral (9)",NanColor:[.196078431372549,.5333333333333333,.7411764705882353]},{IndexedColors:[.8352941176470589,.2431372549019608,.3098039215686275,.9568627450980393,.4274509803921568,.2627450980392157,.9921568627450981,.6823529411764706,.3803921568627451,.996078431372549,.8784313725490196,.5450980392156862,.9019607843137255,.9607843137254902,.596078431372549,.6705882352941176,.8666666666666667,.6431372549019608,.4,.7607843137254902,.6470588235294118,.196078431372549,.5333333333333333,.7411764705882353],Name:"Brewer Diverging Spectral (8)",NanColor:[.196078431372549,.5333333333333333,.7411764705882353]},{IndexedColors:[.8352941176470589,.2431372549019608,.3098039215686275,.9882352941176471,.5529411764705883,.3490196078431372,.996078431372549,.8784313725490196,.5450980392156862,1,1,.7490196078431373,.9019607843137255,.9607843137254902,.596078431372549,.6,.8352941176470589,.5803921568627451,.196078431372549,.5333333333333333,.7411764705882353],Name:"Brewer Diverging Spectral (7)",NanColor:[.196078431372549,.5333333333333333,.7411764705882353]},{IndexedColors:[.8352941176470589,.2431372549019608,.3098039215686275,.9882352941176471,.5529411764705883,.3490196078431372,.996078431372549,.8784313725490196,.5450980392156862,.9019607843137255,.9607843137254902,.596078431372549,.6,.8352941176470589,.5803921568627451,.196078431372549,.5333333333333333,.7411764705882353],Name:"Brewer Diverging Spectral (6)",NanColor:[.196078431372549,.5333333333333333,.7411764705882353]},{IndexedColors:[.8431372549019608,.09803921568627451,.1098039215686274,.9921568627450981,.6823529411764706,.3803921568627451,1,1,.7490196078431373,.6705882352941176,.8666666666666667,.6431372549019608,.1686274509803922,.5137254901960784,.7294117647058823],Name:"Brewer Diverging Spectral (5)",NanColor:[.1686274509803922,.5137254901960784,.7294117647058823]},{IndexedColors:[.8431372549019608,.09803921568627451,.1098039215686274,.9921568627450981,.6823529411764706,.3803921568627451,.6705882352941176,.8666666666666667,.6431372549019608,.1686274509803922,.5137254901960784,.7294117647058823],Name:"Brewer Diverging Spectral (4)",NanColor:[.1686274509803922,.5137254901960784,.7294117647058823]},{IndexedColors:[.9882352941176471,.5529411764705883,.3490196078431372,1,1,.7490196078431373,.6,.8352941176470589,.5803921568627451],Name:"Brewer Diverging Spectral (3)",NanColor:[.6,.8352941176470589,.5803921568627451]},{IndexedColors:[.3294117647058823,.1882352941176471,.0196078431372549,.5490196078431373,.3176470588235294,.0392156862745098,.7490196078431373,.5058823529411764,.1764705882352941,.8745098039215686,.7607843137254902,.4901960784313725,.9647058823529412,.9098039215686274,.7647058823529411,.9607843137254902,.9607843137254902,.9607843137254902,.7803921568627451,.9176470588235294,.8980392156862745,.5019607843137255,.803921568627451,.7568627450980392,.207843137254902,.592156862745098,.5607843137254902,.00392156862745098,.4,.3686274509803922,0,.2352941176470588,.1882352941176471],Name:"Brewer Diverging Brown-Blue-Green (11)",NanColor:[0,.2352941176470588,.1882352941176471]},{IndexedColors:[.3294117647058823,.1882352941176471,.0196078431372549,.5490196078431373,.3176470588235294,.0392156862745098,.7490196078431373,.5058823529411764,.1764705882352941,.8745098039215686,.7607843137254902,.4901960784313725,.9647058823529412,.9098039215686274,.7647058823529411,.7803921568627451,.9176470588235294,.8980392156862745,.5019607843137255,.803921568627451,.7568627450980392,.207843137254902,.592156862745098,.5607843137254902,.00392156862745098,.4,.3686274509803922,0,.2352941176470588,.1882352941176471],Name:"Brewer Diverging Brown-Blue-Green (10)",NanColor:[0,.2352941176470588,.1882352941176471]},{IndexedColors:[.5490196078431373,.3176470588235294,.0392156862745098,.7490196078431373,.5058823529411764,.1764705882352941,.8745098039215686,.7607843137254902,.4901960784313725,.9647058823529412,.9098039215686274,.7647058823529411,.9607843137254902,.9607843137254902,.9607843137254902,.7803921568627451,.9176470588235294,.8980392156862745,.5019607843137255,.803921568627451,.7568627450980392,.207843137254902,.592156862745098,.5607843137254902,.00392156862745098,.4,.3686274509803922],Name:"Brewer Diverging Brown-Blue-Green (9)",NanColor:[.00392156862745098,.4,.3686274509803922]},{IndexedColors:[.5490196078431373,.3176470588235294,.0392156862745098,.7490196078431373,.5058823529411764,.1764705882352941,.8745098039215686,.7607843137254902,.4901960784313725,.9647058823529412,.9098039215686274,.7647058823529411,.7803921568627451,.9176470588235294,.8980392156862745,.5019607843137255,.803921568627451,.7568627450980392,.207843137254902,.592156862745098,.5607843137254902,.00392156862745098,.4,.3686274509803922],Name:"Brewer Diverging Brown-Blue-Green (8)",NanColor:[.00392156862745098,.4,.3686274509803922]},{IndexedColors:[.5490196078431373,.3176470588235294,.0392156862745098,.8470588235294118,.7019607843137254,.396078431372549,.9647058823529412,.9098039215686274,.7647058823529411,.9607843137254902,.9607843137254902,.9607843137254902,.7803921568627451,.9176470588235294,.8980392156862745,.3529411764705883,.7058823529411765,.6745098039215687,.00392156862745098,.4,.3686274509803922],Name:"Brewer Diverging Brown-Blue-Green (7)",NanColor:[.00392156862745098,.4,.3686274509803922]},{IndexedColors:[.5490196078431373,.3176470588235294,.0392156862745098,.8470588235294118,.7019607843137254,.396078431372549,.9647058823529412,.9098039215686274,.7647058823529411,.7803921568627451,.9176470588235294,.8980392156862745,.3529411764705883,.7058823529411765,.6745098039215687,.00392156862745098,.4,.3686274509803922],Name:"Brewer Diverging Brown-Blue-Green (6)",NanColor:[.00392156862745098,.4,.3686274509803922]},{IndexedColors:[.6509803921568628,.3803921568627451,.1019607843137255,.8745098039215686,.7607843137254902,.4901960784313725,.9607843137254902,.9607843137254902,.9607843137254902,.5019607843137255,.803921568627451,.7568627450980392,.00392156862745098,.5215686274509804,.4431372549019608],Name:"Brewer Diverging Brown-Blue-Green (5)",NanColor:[.00392156862745098,.5215686274509804,.4431372549019608]},{IndexedColors:[.6509803921568628,.3803921568627451,.1019607843137255,.8745098039215686,.7607843137254902,.4901960784313725,.5019607843137255,.803921568627451,.7568627450980392,.00392156862745098,.5215686274509804,.4431372549019608],Name:"Brewer Diverging Brown-Blue-Green (4)",NanColor:[.00392156862745098,.5215686274509804,.4431372549019608]},{IndexedColors:[.8470588235294118,.7019607843137254,.396078431372549,.9607843137254902,.9607843137254902,.9607843137254902,.3529411764705883,.7058823529411765,.6745098039215687],Name:"Brewer Diverging Brown-Blue-Green (3)",NanColor:[.3529411764705883,.7058823529411765,.6745098039215687]},{IndexedColors:[.9686274509803922,.9882352941176471,.9921568627450981,.8980392156862745,.9607843137254902,.9764705882352941,.8,.9254901960784314,.9019607843137255,.6,.8470588235294118,.788235294117647,.4,.7607843137254902,.6431372549019608,.2549019607843137,.6823529411764706,.4627450980392157,.1372549019607843,.5450980392156862,.2705882352941176,0,.4274509803921568,.1725490196078431,0,.2666666666666667,.1058823529411765],Name:"Brewer Sequential Blue-Green (9)",NanColor:[0,.2666666666666667,.1058823529411765]},{IndexedColors:[.9686274509803922,.9882352941176471,.9921568627450981,.8980392156862745,.9607843137254902,.9764705882352941,.8,.9254901960784314,.9019607843137255,.6,.8470588235294118,.788235294117647,.4,.7607843137254902,.6431372549019608,.2549019607843137,.6823529411764706,.4627450980392157,.1372549019607843,.5450980392156862,.2705882352941176,0,.3450980392156863,.1411764705882353],Name:"Brewer Sequential Blue-Green (8)",NanColor:[0,.3450980392156863,.1411764705882353]},{IndexedColors:[.9294117647058824,.9725490196078431,.984313725490196,.8,.9254901960784314,.9019607843137255,.8,.9254901960784314,.9019607843137255,.4,.7607843137254902,.6431372549019608,.2549019607843137,.6823529411764706,.4627450980392157,.1372549019607843,.5450980392156862,.2705882352941176,0,.3450980392156863,.1411764705882353],Name:"Brewer Sequential Blue-Green (7)",NanColor:[0,.3450980392156863,.1411764705882353]},{IndexedColors:[.9294117647058824,.9725490196078431,.984313725490196,.8,.9254901960784314,.9019607843137255,.6,.8470588235294118,.788235294117647,.4,.7607843137254902,.6431372549019608,.1725490196078431,.6352941176470588,.3725490196078431,0,.4274509803921568,.1725490196078431],Name:"Brewer Sequential Blue-Green (6)",NanColor:[0,.4274509803921568,.1725490196078431]},{IndexedColors:[.9294117647058824,.9725490196078431,.984313725490196,.6980392156862745,.8862745098039215,.8862745098039215,.4,.7607843137254902,.6431372549019608,.1725490196078431,.6352941176470588,.3725490196078431,0,.4274509803921568,.1725490196078431],Name:"Brewer Sequential Blue-Green (5)",NanColor:[0,.4274509803921568,.1725490196078431]},{IndexedColors:[.9294117647058824,.9725490196078431,.984313725490196,.6980392156862745,.8862745098039215,.8862745098039215,.4,.7607843137254902,.6431372549019608,.1372549019607843,.5450980392156862,.2705882352941176],Name:"Brewer Sequential Blue-Green (4)",NanColor:[.1372549019607843,.5450980392156862,.2705882352941176]},{IndexedColors:[.8980392156862745,.9607843137254902,.9764705882352941,.6,.8470588235294118,.788235294117647,.1725490196078431,.6352941176470588,.3725490196078431],Name:"Brewer Sequential Blue-Green (3)",NanColor:[.1725490196078431,.6352941176470588,.3725490196078431]},{IndexedColors:[1,1,.8980392156862745,1,.9686274509803922,.7372549019607844,.996078431372549,.8901960784313725,.5686274509803921,.996078431372549,.7686274509803922,.3098039215686275,.996078431372549,.6,.1607843137254902,.9254901960784314,.4392156862745098,.0784313725490196,.8,.2980392156862745,.00784313725490196,.6,.203921568627451,.01568627450980392,.4,.1450980392156863,.02352941176470588],Name:"Brewer Sequential Yellow-Orange-Brown (9)",NanColor:[.4,.1450980392156863,.02352941176470588]},{IndexedColors:[1,1,.8980392156862745,1,.9686274509803922,.7372549019607844,.996078431372549,.8901960784313725,.5686274509803921,.996078431372549,.7686274509803922,.3098039215686275,.996078431372549,.6,.1607843137254902,.9254901960784314,.4392156862745098,.0784313725490196,.8,.2980392156862745,.00784313725490196,.5490196078431373,.1764705882352941,.01568627450980392],Name:"Brewer Sequential Yellow-Orange-Brown (8)",NanColor:[.5490196078431373,.1764705882352941,.01568627450980392]},{IndexedColors:[1,1,.8313725490196079,.996078431372549,.8901960784313725,.5686274509803921,.996078431372549,.7686274509803922,.3098039215686275,.996078431372549,.6,.1607843137254902,.9254901960784314,.4392156862745098,.0784313725490196,.8,.2980392156862745,.00784313725490196,.5490196078431373,.1764705882352941,.01568627450980392],Name:"Brewer Sequential Yellow-Orange-Brown (7)",NanColor:[.5490196078431373,.1764705882352941,.01568627450980392]},{IndexedColors:[1,1,.8313725490196079,.996078431372549,.8901960784313725,.5686274509803921,.996078431372549,.7686274509803922,.3098039215686275,.996078431372549,.6,.1607843137254902,.8509803921568627,.3725490196078431,.05490196078431372,.6,.203921568627451,.01568627450980392],Name:"Brewer Sequential Yellow-Orange-Brown (6)",NanColor:[.6,.203921568627451,.01568627450980392]},{IndexedColors:[1,1,.8313725490196079,.996078431372549,.8509803921568627,.5568627450980392,.996078431372549,.6,.1607843137254902,.8509803921568627,.3725490196078431,.05490196078431372,.6,.203921568627451,.01568627450980392],Name:"Brewer Sequential Yellow-Orange-Brown (5)",NanColor:[.6,.203921568627451,.01568627450980392]},{IndexedColors:[1,1,.8313725490196079,.996078431372549,.8509803921568627,.5568627450980392,.996078431372549,.6,.1607843137254902,.8,.2980392156862745,.00784313725490196],Name:"Brewer Sequential Yellow-Orange-Brown (4)",NanColor:[.8,.2980392156862745,.00784313725490196]},{IndexedColors:[1,.9686274509803922,.7372549019607844,.996078431372549,.7686274509803922,.3098039215686275,.8509803921568627,.3725490196078431,.05490196078431372],Name:"Brewer Sequential Yellow-Orange-Brown (3)",NanColor:[.8509803921568627,.3725490196078431,.05490196078431372]},{IndexedColors:[.9686274509803922,.9882352941176471,.9921568627450981,.8784313725490196,.9254901960784314,.9568627450980393,.7490196078431373,.8274509803921568,.9019607843137255,.6196078431372549,.7372549019607844,.8549019607843137,.5490196078431373,.5882352941176471,.7764705882352941,.5490196078431373,.4196078431372549,.6941176470588235,.5333333333333333,.2549019607843137,.615686274509804,.5058823529411764,.05882352941176471,.4862745098039216,.3019607843137255,0,.2941176470588235],Name:"Brewer Sequential Blue-Purple (9)",NanColor:[.3019607843137255,0,.2941176470588235]},{IndexedColors:[.9686274509803922,.9882352941176471,.9921568627450981,.8784313725490196,.9254901960784314,.9568627450980393,.7490196078431373,.8274509803921568,.9019607843137255,.6196078431372549,.7372549019607844,.8549019607843137,.5490196078431373,.5882352941176471,.7764705882352941,.5490196078431373,.4196078431372549,.6941176470588235,.5333333333333333,.2549019607843137,.615686274509804,.4313725490196079,.00392156862745098,.4196078431372549],Name:"Brewer Sequential Blue-Purple (8)",NanColor:[.4313725490196079,.00392156862745098,.4196078431372549]},{IndexedColors:[.9294117647058824,.9725490196078431,.984313725490196,.7490196078431373,.8274509803921568,.9019607843137255,.6196078431372549,.7372549019607844,.8549019607843137,.5490196078431373,.5882352941176471,.7764705882352941,.5490196078431373,.4196078431372549,.6941176470588235,.5333333333333333,.2549019607843137,.615686274509804,.4313725490196079,.00392156862745098,.4196078431372549],Name:"Brewer Sequential Blue-Purple (7)",NanColor:[.4313725490196079,.00392156862745098,.4196078431372549]},{IndexedColors:[.9294117647058824,.9725490196078431,.984313725490196,.7490196078431373,.8274509803921568,.9019607843137255,.6196078431372549,.7372549019607844,.8549019607843137,.5490196078431373,.5882352941176471,.7764705882352941,.5333333333333333,.3372549019607843,.6549019607843137,.5058823529411764,.05882352941176471,.4862745098039216],Name:"Brewer Sequential Blue-Purple (6)",NanColor:[.5058823529411764,.05882352941176471,.4862745098039216]},{IndexedColors:[.9294117647058824,.9725490196078431,.984313725490196,.7019607843137254,.803921568627451,.8901960784313725,.5490196078431373,.5882352941176471,.7764705882352941,.5333333333333333,.3372549019607843,.6549019607843137,.5058823529411764,.05882352941176471,.4862745098039216],Name:"Brewer Sequential Blue-Purple (5)",NanColor:[.5058823529411764,.05882352941176471,.4862745098039216]},{IndexedColors:[.9294117647058824,.9725490196078431,.984313725490196,.7019607843137254,.803921568627451,.8901960784313725,.5490196078431373,.5882352941176471,.7764705882352941,.5333333333333333,.2549019607843137,.615686274509804],Name:"Brewer Sequential Blue-Purple (4)",NanColor:[.5333333333333333,.2549019607843137,.615686274509804]},{IndexedColors:[.8784313725490196,.9254901960784314,.9568627450980393,.6196078431372549,.7372549019607844,.8549019607843137,.5333333333333333,.3372549019607843,.6549019607843137],Name:"Brewer Sequential Blue-Purple (3)",NanColor:[.5333333333333333,.3372549019607843,.6549019607843137]},{IndexedColors:[.4980392156862745,.788235294117647,.4980392156862745,.7450980392156863,.6823529411764706,.8313725490196079,.9921568627450981,.7529411764705882,.5254901960784314,1,1,.6,.2196078431372549,.4235294117647059,.6901960784313725,.9411764705882353,.00784313725490196,.4980392156862745,.7490196078431373,.3568627450980392,.09019607843137255,.4,.4,.4],Name:"Brewer Qualitative Accent",NanColor:[.4,.4,.4]},{IndexedColors:[.1058823529411765,.6196078431372549,.4666666666666667,.8509803921568627,.3725490196078431,.00784313725490196,.4588235294117647,.4392156862745098,.7019607843137254,.9058823529411765,.1607843137254902,.5411764705882353,.4,.6509803921568628,.1176470588235294,.9019607843137255,.6705882352941176,.00784313725490196,.6509803921568628,.4627450980392157,.1137254901960784,.4,.4,.4],Name:"Brewer Qualitative Dark2",NanColor:[.4,.4,.4]},{IndexedColors:[.4,.7607843137254902,.6470588235294118,.9882352941176471,.5529411764705883,.3843137254901961,.5529411764705883,.6274509803921569,.796078431372549,.9058823529411765,.5411764705882353,.7647058823529411,.6509803921568628,.8470588235294118,.3294117647058823,1,.8509803921568627,.1843137254901961,.8980392156862745,.7686274509803922,.5803921568627451,.7019607843137254,.7019607843137254,.7019607843137254],Name:"Brewer Qualitative Set2",NanColor:[.7019607843137254,.7019607843137254,.7019607843137254]},{IndexedColors:[.7019607843137254,.8862745098039215,.803921568627451,.9921568627450981,.803921568627451,.6745098039215687,.796078431372549,.8352941176470589,.9098039215686274,.9568627450980393,.792156862745098,.8941176470588236,.9019607843137255,.9607843137254902,.788235294117647,1,.9490196078431372,.6823529411764706,.9450980392156862,.8862745098039215,.8,.8,.8,.8],Name:"Brewer Qualitative Pastel2",NanColor:[.8,.8,.8]},{IndexedColors:[.984313725490196,.7058823529411765,.6823529411764706,.7019607843137254,.803921568627451,.8901960784313725,.8,.9215686274509803,.7725490196078432,.8705882352941177,.796078431372549,.8941176470588236,.996078431372549,.8509803921568627,.6509803921568628,1,1,.8,.8980392156862745,.8470588235294118,.7411764705882353,.9921568627450981,.8549019607843137,.9254901960784314,.9490196078431372,.9490196078431372,.9490196078431372],Name:"Brewer Qualitative Pastel1",NanColor:[.9490196078431372,.9490196078431372,.9490196078431372]},{IndexedColors:[.8941176470588236,.1019607843137255,.1098039215686274,.2156862745098039,.4941176470588236,.7215686274509804,.3019607843137255,.6862745098039216,.2901960784313726,.596078431372549,.3058823529411765,.6392156862745098,1,.4980392156862745,0,1,1,.2,.6509803921568628,.3372549019607843,.1568627450980392,.9686274509803922,.5058823529411764,.7490196078431373,.6,.6,.6],Name:"Brewer Qualitative Set1",NanColor:[.6,.6,.6]},{IndexedColors:[.6509803921568628,.807843137254902,.8901960784313725,.1215686274509804,.4705882352941176,.7058823529411765,.6980392156862745,.8745098039215686,.5411764705882353,.2,.6274509803921569,.1725490196078431,.984313725490196,.6039215686274509,.6,.8901960784313725,.1019607843137255,.1098039215686274,.9921568627450981,.7490196078431373,.4352941176470588,1,.4980392156862745,0,.792156862745098,.6980392156862745,.8392156862745098,.4156862745098039,.2392156862745098,.6039215686274509,1,1,.6],Name:"Brewer Qualitative Paired",NanColor:[1,1,.6]},{IndexedColors:[.5529411764705883,.8274509803921568,.7803921568627451,1,1,.7019607843137254,.7450980392156863,.7294117647058823,.8549019607843137,.984313725490196,.5019607843137255,.4470588235294118,.5019607843137255,.6941176470588235,.8274509803921568,.9921568627450981,.7058823529411765,.3843137254901961,.7019607843137254,.8705882352941177,.4117647058823529,.9882352941176471,.803921568627451,.8980392156862745,.8509803921568627,.8509803921568627,.8509803921568627,.7372549019607844,.5019607843137255,.7411764705882353,.8,.9215686274509803,.7725490196078432,1,.9294117647058824,.4352941176470588],Name:"Brewer Qualitative Set3",NanColor:[1,.9294117647058824,.4352941176470588]},{IndexedColors:[1,0,0,1,.862745,0,0,.695201,0],Name:"Traffic Lights",NanColor:[.803922,0,.803922]},{IndexedColors:[.908659,.604013,.581857,1,.862745,0,0,.695201,0],Name:"Traffic Lights For Deuteranopes",NanColor:[.803922,0,.803922]},{IndexedColors:[.4196078431372549,0,.07058823529411765,.9019607843137255,.9411764705882353,.0196078431372549,.01568627450980392,.6196078431372549,.00784313725490196],Name:"Traffic Lights For Deuteranopes 2",NanColor:[.803922,0,.803922]},{ColorSpace:"Lab",Creator:"Francesca Samsel",Name:"Muted Blue-Green",NanColor:[.25,0,0],RGBPoints:[0,.109804,.27451,.301961,.02,.129412,.309804,.341176,.05,.14902,.341176,.380392,.1,.188235,.403922,.458824,.15,.227451,.447059,.521569,.2,.290196,.494118,.588235,.25,.368627,.552941,.670588,.3,.458824,.619608,.74902,.35,.588235,.713725,.85098,.4,.72549,.815686,.941176,.45,.831373,.882353,.980392,.475,.909804,.933333,1,.5,.980392,.984314,1,.5,.996078,1,.94902,.5,1,1,.980392,.5,.980392,.984314,1,.525,.972549,.988235,.890196,.55,.917647,.960784,.835294,.6,.835294,.921569,.772549,.65,.768627,.901961,.737255,.7,.670588,.831373,.654902,.75,.576471,.760784,.584314,.8,.498039,.678431,.521569,.85,.392157,.560784,.427451,.9,.294118,.45098,.333333,.95,.211765,.34902,.254902,1,.152941,.278431,.196078]},{ColorSpace:"Lab",Creator:"Francesca Samsel",Name:"Green-Blue Asymmetric Divergent (62Blbc)",NanColor:[.25,0,0],RGBPoints:[0,.121569,.2,.145098,.05,.196078,.301961,.223529,.1,.258824,.4,.278431,.2,.341176,.54902,.341176,.25,.419608,.619608,.376471,.3,.545098,.701961,.392157,.35,.643137,.780392,.403922,.4,.729412,.819608,.45098,.45,.811765,.870588,.521569,.5,.898039,.909804,.564706,.55,.941176,.92549,.686275,.6,.960784,.94902,.776471,.64,1,1,1,.65,.890196,.988235,.972549,.7,.721569,.894118,.901961,.75,.631373,.823529,.839216,.8,.517647,.662745,.701961,.85,.384314,.494118,.54902,.9,.298039,.360784,.45098,.95,.223529,.25098,.34902,.99,.156863,.172549,.25098,1,.137255,.137255,.188235]},{ColorSpace:"Lab",Creator:"Francesca Samsel",Name:"Asymmtrical Earth Tones (6_21b)",NanColor:[.25,0,0],RGBPoints:[0,.141176,.14902,.2,.05,.215686,.258824,.321569,.1,.243137,.368627,.380392,.15,.27451,.439216,.4,.2,.32549,.501961,.384314,.25,.403922,.6,.419608,.3,.486275,.701961,.454902,.35,.556863,.74902,.494118,.4,.670588,.8,.545098,.5,.854902,.901961,.631373,.55,.92549,.941176,.694118,.6,.960784,.94902,.776471,.65,.988235,.968627,.909804,.7,.839216,.815686,.772549,.75,.701961,.662745,.615686,.8,.6,.529412,.478431,.85,.501961,.403922,.360784,.9,.439216,.313725,.290196,1,.301961,.164706,.176471]},{ColorSpace:"Lab",Creator:"Francesca Samsel",Name:"Yellow 15",NanColor:[.25,0,0],RGBPoints:[0,1,1,.988235,.002,1,1,.988235,.05,.984314,.988235,.843137,.1,.988235,.988235,.741176,.15,.980392,.968627,.654902,.2,.980392,.945098,.576471,.25,.968627,.905882,.486275,.3,.968627,.862745,.388235,.35,.960784,.803922,.286275,.4,.94902,.741176,.219608,.45,.941176,.678431,.14902,.5,.929412,.607843,.094118,.55,.921569,.545098,.054902,.6,.909804,.486275,.035294,.65,.890196,.411765,.019608,.7,.8,.305882,0,.75,.760784,.239216,0,.8,.678431,.180392,.011765,.85,.6,.121569,.023529,.9,.501961,.054902,.031373,.95,.4,.039216,.058824,1,.301961,.047059,.090196]},{ColorSpace:"Diverging",Name:"Magma (matplotlib)",NanColor:[0,1,0],Source:"https://github.com/BIDS/colormap/blob/master/colormaps.py",License:"CC0",Creator:"Nathaniel J. Smith & Stefan van der Walt",RGBPoints:[0,.001462,466e-6,.013866,.003922,.002258,.001295,.018331,.007843,.003279,.002305,.023708,.011765,.004512,.00349,.029965,.015686,.00595,.004843,.03713,.019608,.007588,.006356,.044973,.023529,.009426,.008022,.052844,.027451,.011465,.009828,.06075,.031373,.013708,.011771,.068667,.035294,.016156,.01384,.076603,.039216,.018815,.016026,.084584,.043137,.021692,.01832,.09261,.047059,.024792,.020715,.100676,.05098,.028123,.023201,.108787,.054902,.031696,.025765,.116965,.058824,.03552,.028397,.125209,.062745,.039608,.03109,.133515,.066667,.04383,.03383,.141886,.070588,.048062,.036607,.150327,.07451,.05232,.039407,.158841,.078431,.056615,.04216,.167446,.082353,.060949,.044794,.176129,.086275,.06533,.047318,.184892,.090196,.069764,.049726,.193735,.094118,.074257,.052017,.20266,.098039,.078815,.054184,.211667,.101961,.083446,.056225,.220755,.105882,.088155,.058133,.229922,.109804,.092949,.059904,.239164,.113725,.097833,.061531,.248477,.117647,.102815,.06301,.257854,.121569,.107899,.064335,.267289,.12549,.113094,.065492,.276784,.129412,.118405,.066479,.286321,.133333,.123833,.067295,.295879,.137255,.12938,.067935,.305443,.141176,.135053,.068391,.315,.145098,.140858,.068654,.324538,.14902,.146785,.068738,.334011,.152941,.152839,.068637,.343404,.156863,.159018,.068354,.352688,.160784,.165308,.067911,.361816,.164706,.171713,.067305,.370771,.168627,.178212,.066576,.379497,.172549,.184801,.065732,.387973,.176471,.19146,.064818,.396152,.180392,.198177,.063862,.404009,.184314,.204935,.062907,.411514,.188235,.211718,.061992,.418647,.192157,.218512,.061158,.425392,.196078,.225302,.060445,.431742,.2,.232077,.059889,.437695,.203922,.238826,.059517,.443256,.207843,.245543,.059352,.448436,.211765,.25222,.059415,.453248,.215686,.258857,.059706,.45771,.219608,.265447,.060237,.46184,.223529,.271994,.060994,.46566,.227451,.278493,.061978,.46919,.231373,.284951,.063168,.472451,.235294,.291366,.064553,.475462,.239216,.29774,.066117,.478243,.243137,.304081,.067835,.480812,.247059,.310382,.069702,.483186,.25098,.316654,.07169,.48538,.254902,.322899,.073782,.487408,.258824,.329114,.075972,.489287,.262745,.335308,.078236,.491024,.266667,.341482,.080564,.492631,.270588,.347636,.082946,.494121,.27451,.353773,.085373,.495501,.278431,.359898,.087831,.496778,.282353,.366012,.090314,.49796,.286275,.372116,.092816,.499053,.290196,.378211,.095332,.500067,.294118,.384299,.097855,.501002,.298039,.390384,.100379,.501864,.301961,.396467,.102902,.502658,.305882,.402548,.10542,.503386,.309804,.408629,.10793,.504052,.313725,.414709,.110431,.504662,.317647,.420791,.11292,.505215,.321569,.426877,.115395,.505714,.32549,.432967,.117855,.50616,.329412,.439062,.120298,.506555,.333333,.445163,.122724,.506901,.337255,.451271,.125132,.507198,.341176,.457386,.127522,.507448,.345098,.463508,.129893,.507652,.34902,.46964,.132245,.507809,.352941,.47578,.134577,.507921,.356863,.481929,.136891,.507989,.360784,.488088,.139186,.508011,.364706,.494258,.141462,.507988,.368627,.500438,.143719,.50792,.372549,.506629,.145958,.507806,.376471,.512831,.148179,.507648,.380392,.519045,.150383,.507443,.384314,.52527,.152569,.507192,.388235,.531507,.154739,.506895,.392157,.537755,.156894,.506551,.396078,.544015,.159033,.506159,.4,.550287,.161158,.505719,.403922,.556571,.163269,.50523,.407843,.562866,.165368,.504692,.411765,.569172,.167454,.504105,.415686,.57549,.16953,.503466,.419608,.581819,.171596,.502777,.423529,.588158,.173652,.502035,.427451,.594508,.175701,.501241,.431373,.600868,.177743,.500394,.435294,.607238,.179779,.499492,.439216,.613617,.181811,.498536,.443137,.620005,.18384,.497524,.447059,.626401,.185867,.496456,.45098,.632805,.187893,.495332,.454902,.639216,.189921,.49415,.458824,.645633,.191952,.49291,.462745,.652056,.193986,.491611,.466667,.658483,.196027,.490253,.470588,.664915,.198075,.488836,.47451,.671349,.200133,.487358,.478431,.677786,.202203,.485819,.482353,.684224,.204286,.484219,.486275,.690661,.206384,.482558,.490196,.697098,.208501,.480835,.494118,.703532,.210638,.479049,.498039,.709962,.212797,.477201,.501961,.716387,.214982,.47529,.505882,.722805,.217194,.473316,.509804,.729216,.219437,.471279,.513725,.735616,.221713,.46918,.517647,.742004,.224025,.467018,.521569,.748378,.226377,.464794,.52549,.754737,.228772,.462509,.529412,.761077,.231214,.460162,.533333,.767398,.233705,.457755,.537255,.773695,.236249,.455289,.541176,.779968,.238851,.452765,.545098,.786212,.241514,.450184,.54902,.792427,.244242,.447543,.552941,.798608,.24704,.444848,.556863,.804752,.249911,.442102,.560784,.810855,.252861,.439305,.564706,.816914,.255895,.436461,.568627,.822926,.259016,.433573,.572549,.828886,.262229,.430644,.576471,.834791,.26554,.427671,.580392,.840636,.268953,.424666,.584314,.846416,.272473,.421631,.588235,.852126,.276106,.418573,.592157,.857763,.279857,.415496,.596078,.86332,.283729,.412403,.6,.868793,.287728,.409303,.603922,.874176,.291859,.406205,.607843,.879464,.296125,.403118,.611765,.884651,.30053,.400047,.615686,.889731,.305079,.397002,.619608,.8947,.309773,.393995,.623529,.899552,.314616,.391037,.627451,.904281,.31961,.388137,.631373,.908884,.324755,.385308,.635294,.913354,.330052,.382563,.639216,.917689,.3355,.379915,.643137,.921884,.341098,.377376,.647059,.925937,.346844,.374959,.65098,.929845,.352734,.372677,.654902,.933606,.358764,.370541,.658824,.937221,.364929,.368567,.662745,.940687,.371224,.366762,.666667,.944006,.377643,.365136,.670588,.94718,.384178,.363701,.67451,.95021,.39082,.362468,.678431,.953099,.397563,.361438,.682353,.955849,.4044,.360619,.686275,.958464,.411324,.360014,.690196,.960949,.418323,.35963,.694118,.96331,.42539,.359469,.698039,.965549,.432519,.359529,.701961,.967671,.439703,.35981,.705882,.96968,.446936,.360311,.709804,.971582,.45421,.36103,.713725,.973381,.46152,.361965,.717647,.975082,.468861,.363111,.721569,.97669,.476226,.364466,.72549,.97821,.483612,.366025,.729412,.979645,.491014,.367783,.733333,.981,.498428,.369734,.737255,.982279,.505851,.371874,.741176,.983485,.51328,.374198,.745098,.984622,.520713,.376698,.74902,.985693,.528148,.379371,.752941,.9867,.535582,.38221,.756863,.987646,.543015,.38521,.760784,.988533,.550446,.388365,.764706,.989363,.557873,.391671,.768627,.990138,.565296,.395122,.772549,.990871,.572706,.398714,.776471,.991558,.580107,.402441,.780392,.992196,.587502,.406299,.784314,.992785,.594891,.410283,.788235,.993326,.602275,.41439,.792157,.993834,.609644,.418613,.796078,.994309,.616999,.42295,.8,.994738,.62435,.427397,.803922,.995122,.631696,.431951,.807843,.99548,.639027,.436607,.811765,.99581,.646344,.441361,.815686,.996096,.653659,.446213,.819608,.996341,.660969,.45116,.823529,.99658,.668256,.456192,.827451,.996775,.675541,.461314,.831373,.996925,.682828,.466526,.835294,.997077,.690088,.471811,.839216,.997186,.697349,.477182,.843137,.997254,.704611,.482635,.847059,.997325,.711848,.488154,.85098,.997351,.719089,.493755,.854902,.997351,.726324,.499428,.858824,.997341,.733545,.505167,.862745,.997285,.740772,.510983,.866667,.997228,.747981,.516859,.870588,.997138,.75519,.522806,.87451,.997019,.762398,.528821,.878431,.996898,.769591,.534892,.882353,.996727,.776795,.541039,.886275,.996571,.783977,.547233,.890196,.996369,.791167,.553499,.894118,.996162,.798348,.55982,.898039,.995932,.805527,.566202,.901961,.99568,.812706,.572645,.905882,.995424,.819875,.57914,.909804,.995131,.827052,.585701,.913725,.994851,.834213,.592307,.917647,.994524,.841387,.598983,.921569,.994222,.84854,.605696,.92549,.993866,.855711,.612482,.929412,.993545,.862859,.619299,.933333,.99317,.870024,.626189,.937255,.992831,.877168,.633109,.941176,.99244,.88433,.640099,.945098,.992089,.89147,.647116,.94902,.991688,.898627,.654202,.952941,.991332,.905763,.661309,.956863,.99093,.912915,.668481,.960784,.99057,.920049,.675675,.964706,.990175,.927196,.682926,.968627,.989815,.934329,.690198,.972549,.989434,.94147,.697519,.976471,.989077,.948604,.704863,.980392,.988717,.955742,.712242,.984314,.988367,.962878,.719649,.988235,.988033,.970012,.727077,.992157,.987691,.977154,.734536,.996078,.987387,.984288,.742002,1,.987053,.991438,.749504]},{ColorSpace:"Diverging",Name:"Inferno (matplotlib)",NanColor:[0,1,0],Source:"https://github.com/BIDS/colormap/blob/master/colormaps.py",License:"CC0",Creator:"Nathaniel J. Smith & Stefan van der Walt",RGBPoints:[0,.001462,466e-6,.013866,.003922,.002267,.00127,.01857,.007843,.003299,.002249,.024239,.011765,.004547,.003392,.030909,.015686,.006006,.004692,.038558,.019608,.007676,.006136,.046836,.023529,.009561,.007713,.055143,.027451,.011663,.009417,.06346,.031373,.013995,.011225,.071862,.035294,.016561,.013136,.080282,.039216,.019373,.015133,.088767,.043137,.022447,.017199,.097327,.047059,.025793,.019331,.10593,.05098,.029432,.021503,.114621,.054902,.033385,.023702,.123397,.058824,.037668,.025921,.132232,.062745,.042253,.028139,.141141,.066667,.046915,.030324,.150164,.070588,.051644,.032474,.159254,.07451,.056449,.034569,.168414,.078431,.06134,.03659,.177642,.082353,.066331,.038504,.186962,.086275,.071429,.040294,.196354,.090196,.076637,.041905,.205799,.094118,.081962,.043328,.215289,.098039,.087411,.044556,.224813,.101961,.09299,.045583,.234358,.105882,.098702,.046402,.243904,.109804,.104551,.047008,.25343,.113725,.110536,.047399,.262912,.117647,.116656,.047574,.272321,.121569,.122908,.047536,.281624,.12549,.129285,.047293,.290788,.129412,.135778,.046856,.299776,.133333,.142378,.046242,.308553,.137255,.149073,.045468,.317085,.141176,.15585,.044559,.325338,.145098,.162689,.043554,.333277,.14902,.169575,.042489,.340874,.152941,.176493,.041402,.348111,.156863,.183429,.040329,.354971,.160784,.190367,.039309,.361447,.164706,.197297,.0384,.367535,.168627,.204209,.037632,.373238,.172549,.211095,.03703,.378563,.176471,.217949,.036615,.383522,.180392,.224763,.036405,.388129,.184314,.231538,.036405,.3924,.188235,.238273,.036621,.396353,.192157,.244967,.037055,.400007,.196078,.25162,.037705,.403378,.2,.258234,.038571,.406485,.203922,.26481,.039647,.409345,.207843,.271347,.040922,.411976,.211765,.27785,.042353,.414392,.215686,.284321,.043933,.416608,.219608,.290763,.045644,.418637,.223529,.297178,.04747,.420491,.227451,.303568,.049396,.422182,.231373,.309935,.051407,.423721,.235294,.316282,.05349,.425116,.239216,.32261,.055634,.426377,.243137,.328921,.057827,.427511,.247059,.335217,.06006,.428524,.25098,.3415,.062325,.429425,.254902,.347771,.064616,.430217,.258824,.354032,.066925,.430906,.262745,.360284,.069247,.431497,.266667,.366529,.071579,.431994,.270588,.372768,.073915,.4324,.27451,.379001,.076253,.432719,.278431,.385228,.078591,.432955,.282353,.391453,.080927,.433109,.286275,.397674,.083257,.433183,.290196,.403894,.08558,.433179,.294118,.410113,.087896,.433098,.298039,.416331,.090203,.432943,.301961,.422549,.092501,.432714,.305882,.428768,.09479,.432412,.309804,.434987,.097069,.432039,.313725,.441207,.099338,.431594,.317647,.447428,.101597,.43108,.321569,.453651,.103848,.430498,.32549,.459875,.106089,.429846,.329412,.4661,.108322,.429125,.333333,.472328,.110547,.428334,.337255,.478558,.112764,.427475,.341176,.484789,.114974,.426548,.345098,.491022,.117179,.425552,.34902,.497257,.119379,.424488,.352941,.503493,.121575,.423356,.356863,.50973,.123769,.422156,.360784,.515967,.12596,.420887,.364706,.522206,.12815,.419549,.368627,.528444,.130341,.418142,.372549,.534683,.132534,.416667,.376471,.54092,.134729,.415123,.380392,.547157,.136929,.413511,.384314,.553392,.139134,.411829,.388235,.559624,.141346,.410078,.392157,.565854,.143567,.408258,.396078,.572081,.145797,.406369,.4,.578304,.148039,.404411,.403922,.584521,.150294,.402385,.407843,.590734,.152563,.40029,.411765,.59694,.154848,.398125,.415686,.603139,.157151,.395891,.419608,.60933,.159474,.393589,.423529,.615513,.161817,.391219,.427451,.621685,.164184,.388781,.431373,.627847,.166575,.386276,.435294,.633998,.168992,.383704,.439216,.640135,.171438,.381065,.443137,.64626,.173914,.378359,.447059,.652369,.176421,.375586,.45098,.658463,.178962,.372748,.454902,.66454,.181539,.369846,.458824,.670599,.184153,.366879,.462745,.676638,.186807,.363849,.466667,.682656,.189501,.360757,.470588,.688653,.192239,.357603,.47451,.694627,.195021,.354388,.478431,.700576,.197851,.351113,.482353,.7065,.200728,.347777,.486275,.712396,.203656,.344383,.490196,.718264,.206636,.340931,.494118,.724103,.20967,.337424,.498039,.729909,.212759,.333861,.501961,.735683,.215906,.330245,.505882,.741423,.219112,.326576,.509804,.747127,.222378,.322856,.513725,.752794,.225706,.319085,.517647,.758422,.229097,.315266,.521569,.76401,.232554,.311399,.52549,.769556,.236077,.307485,.529412,.775059,.239667,.303526,.533333,.780517,.243327,.299523,.537255,.785929,.247056,.295477,.541176,.791293,.250856,.29139,.545098,.796607,.254728,.287264,.54902,.801871,.258674,.283099,.552941,.807082,.262692,.278898,.556863,.812239,.266786,.274661,.560784,.817341,.270954,.27039,.564706,.822386,.275197,.266085,.568627,.827372,.279517,.26175,.572549,.832299,.283913,.257383,.576471,.837165,.288385,.252988,.580392,.841969,.292933,.248564,.584314,.846709,.297559,.244113,.588235,.851384,.30226,.239636,.592157,.855992,.307038,.235133,.596078,.860533,.311892,.230606,.6,.865006,.316822,.226055,.603922,.869409,.321827,.221482,.607843,.873741,.326906,.216886,.611765,.878001,.33206,.212268,.615686,.882188,.337287,.207628,.619608,.886302,.342586,.202968,.623529,.890341,.347957,.198286,.627451,.894305,.353399,.193584,.631373,.898192,.358911,.18886,.635294,.902003,.364492,.184116,.639216,.905735,.37014,.17935,.643137,.90939,.375856,.174563,.647059,.912966,.381636,.169755,.65098,.916462,.387481,.164924,.654902,.919879,.393389,.16007,.658824,.923215,.399359,.155193,.662745,.92647,.405389,.150292,.666667,.929644,.411479,.145367,.670588,.932737,.417627,.140417,.67451,.935747,.423831,.13544,.678431,.938675,.430091,.130438,.682353,.941521,.436405,.125409,.686275,.944285,.442772,.120354,.690196,.946965,.449191,.115272,.694118,.949562,.45566,.110164,.698039,.952075,.462178,.105031,.701961,.954506,.468744,.099874,.705882,.956852,.475356,.094695,.709804,.959114,.482014,.089499,.713725,.961293,.488716,.084289,.717647,.963387,.495462,.079073,.721569,.965397,.502249,.073859,.72549,.967322,.509078,.068659,.729412,.969163,.515946,.063488,.733333,.970919,.522853,.058367,.737255,.97259,.529798,.053324,.741176,.974176,.53678,.048392,.745098,.975677,.543798,.043618,.74902,.977092,.55085,.03905,.752941,.978422,.557937,.034931,.756863,.979666,.565057,.031409,.760784,.980824,.572209,.028508,.764706,.981895,.579392,.02625,.768627,.982881,.586606,.024661,.772549,.983779,.593849,.02377,.776471,.984591,.601122,.023606,.780392,.985315,.608422,.024202,.784314,.985952,.61575,.025592,.788235,.986502,.623105,.027814,.792157,.986964,.630485,.030908,.796078,.987337,.63789,.034916,.8,.987622,.64532,.039886,.803922,.987819,.652773,.045581,.807843,.987926,.66025,.05175,.811765,.987945,.667748,.058329,.815686,.987874,.675267,.065257,.819608,.987714,.682807,.072489,.823529,.987464,.690366,.07999,.827451,.987124,.697944,.087731,.831373,.986694,.70554,.095694,.835294,.986175,.713153,.103863,.839216,.985566,.720782,.112229,.843137,.984865,.728427,.120785,.847059,.984075,.736087,.129527,.85098,.983196,.743758,.138453,.854902,.982228,.751442,.147565,.858824,.981173,.759135,.156863,.862745,.980032,.766837,.166353,.866667,.978806,.774545,.176037,.870588,.977497,.782258,.185923,.87451,.976108,.789974,.196018,.878431,.974638,.797692,.206332,.882353,.973088,.805409,.216877,.886275,.971468,.813122,.227658,.890196,.969783,.820825,.238686,.894118,.968041,.828515,.249972,.898039,.966243,.836191,.261534,.901961,.964394,.843848,.273391,.905882,.962517,.851476,.285546,.909804,.960626,.859069,.29801,.913725,.95872,.866624,.31082,.917647,.956834,.874129,.323974,.921569,.954997,.881569,.337475,.92549,.953215,.888942,.351369,.929412,.951546,.896226,.365627,.933333,.950018,.903409,.380271,.937255,.948683,.910473,.395289,.941176,.947594,.917399,.410665,.945098,.946809,.924168,.426373,.94902,.946392,.930761,.442367,.952941,.946403,.937159,.458592,.956863,.946903,.943348,.47497,.960784,.947937,.949318,.491426,.964706,.949545,.955063,.50786,.968627,.95174,.960587,.524203,.972549,.954529,.965896,.540361,.976471,.957896,.971003,.556275,.980392,.961812,.975924,.571925,.984314,.966249,.980678,.587206,.988235,.971162,.985282,.602154,.992157,.976511,.989753,.61676,.996078,.982257,.994109,.631017,1,.988362,.998364,.644924]},{ColorSpace:"Diverging",Name:"Plasma (matplotlib)",NanColor:[0,1,0],Source:"https://github.com/BIDS/colormap/blob/master/colormaps.py",License:"CC0",Creator:"Nathaniel J. Smith & Stefan van der Walt",RGBPoints:[0,.050383,.029803,.527975,.003922,.063536,.028426,.533124,.007843,.075353,.027206,.538007,.011765,.086222,.026125,.542658,.015686,.096379,.025165,.547103,.019608,.10598,.024309,.551368,.023529,.115124,.023556,.555468,.027451,.123903,.022878,.559423,.031373,.132381,.022258,.56325,.035294,.140603,.021687,.566959,.039216,.148607,.021154,.570562,.043137,.156421,.020651,.574065,.047059,.16407,.020171,.577478,.05098,.171574,.019706,.580806,.054902,.17895,.019252,.584054,.058824,.186213,.018803,.587228,.062745,.193374,.018354,.59033,.066667,.200445,.017902,.593364,.070588,.207435,.017442,.596333,.07451,.21435,.016973,.599239,.078431,.221197,.016497,.602083,.082353,.227983,.016007,.604867,.086275,.234715,.015502,.607592,.090196,.241396,.014979,.610259,.094118,.248032,.014439,.612868,.098039,.254627,.013882,.615419,.101961,.261183,.013308,.617911,.105882,.267703,.012716,.620346,.109804,.274191,.012109,.622722,.113725,.280648,.011488,.625038,.117647,.287076,.010855,.627295,.121569,.293478,.010213,.62949,.12549,.299855,.009561,.631624,.129412,.30621,.008902,.633694,.133333,.312543,.008239,.6357,.137255,.318856,.007576,.63764,.141176,.32515,.006915,.639512,.145098,.331426,.006261,.641316,.14902,.337683,.005618,.643049,.152941,.343925,.004991,.64471,.156863,.35015,.004382,.646298,.160784,.356359,.003798,.64781,.164706,.362553,.003243,.649245,.168627,.368733,.002724,.650601,.172549,.374897,.002245,.651876,.176471,.381047,.001814,.653068,.180392,.387183,.001434,.654177,.184314,.393304,.001114,.655199,.188235,.399411,859e-6,.656133,.192157,.405503,678e-6,.656977,.196078,.41158,577e-6,.65773,.2,.417642,564e-6,.65839,.203922,.423689,646e-6,.658956,.207843,.429719,831e-6,.659425,.211765,.435734,.001127,.659797,.215686,.441732,.00154,.660069,.219608,.447714,.00208,.66024,.223529,.453677,.002755,.66031,.227451,.459623,.003574,.660277,.231373,.46555,.004545,.660139,.235294,.471457,.005678,.659897,.239216,.477344,.00698,.659549,.243137,.48321,.00846,.659095,.247059,.489055,.010127,.658534,.25098,.494877,.01199,.657865,.254902,.500678,.014055,.657088,.258824,.506454,.016333,.656202,.262745,.512206,.018833,.655209,.266667,.517933,.021563,.654109,.270588,.523633,.024532,.652901,.27451,.529306,.027747,.651586,.278431,.534952,.031217,.650165,.282353,.54057,.03495,.64864,.286275,.546157,.038954,.64701,.290196,.551715,.043136,.645277,.294118,.557243,.047331,.643443,.298039,.562738,.051545,.641509,.301961,.568201,.055778,.639477,.305882,.573632,.060028,.637349,.309804,.579029,.064296,.635126,.313725,.584391,.068579,.632812,.317647,.589719,.072878,.630408,.321569,.595011,.07719,.627917,.32549,.600266,.081516,.625342,.329412,.605485,.085854,.622686,.333333,.610667,.090204,.619951,.337255,.615812,.094564,.61714,.341176,.620919,.098934,.614257,.345098,.625987,.103312,.611305,.34902,.631017,.107699,.608287,.352941,.636008,.112092,.605205,.356863,.640959,.116492,.602065,.360784,.645872,.120898,.598867,.364706,.650746,.125309,.595617,.368627,.65558,.129725,.592317,.372549,.660374,.134144,.588971,.376471,.665129,.138566,.585582,.380392,.669845,.142992,.582154,.384314,.674522,.147419,.578688,.388235,.67916,.151848,.575189,.392157,.683758,.156278,.57166,.396078,.688318,.160709,.568103,.4,.69284,.165141,.564522,.403922,.697324,.169573,.560919,.407843,.701769,.174005,.557296,.411765,.706178,.178437,.553657,.415686,.710549,.182868,.550004,.419608,.714883,.187299,.546338,.423529,.719181,.191729,.542663,.427451,.723444,.196158,.538981,.431373,.72767,.200586,.535293,.435294,.731862,.205013,.531601,.439216,.736019,.209439,.527908,.443137,.740143,.213864,.524216,.447059,.744232,.218288,.520524,.45098,.748289,.222711,.516834,.454902,.752312,.227133,.513149,.458824,.756304,.231555,.509468,.462745,.760264,.235976,.505794,.466667,.764193,.240396,.502126,.470588,.76809,.244817,.498465,.47451,.771958,.249237,.494813,.478431,.775796,.253658,.491171,.482353,.779604,.258078,.487539,.486275,.783383,.2625,.483918,.490196,.787133,.266922,.480307,.494118,.790855,.271345,.476706,.498039,.794549,.27577,.473117,.501961,.798216,.280197,.469538,.505882,.801855,.284626,.465971,.509804,.805467,.289057,.462415,.513725,.809052,.293491,.45887,.517647,.812612,.297928,.455338,.521569,.816144,.302368,.451816,.52549,.819651,.306812,.448306,.529412,.823132,.311261,.444806,.533333,.826588,.315714,.441316,.537255,.830018,.320172,.437836,.541176,.833422,.324635,.434366,.545098,.836801,.329105,.430905,.54902,.840155,.33358,.427455,.552941,.843484,.338062,.424013,.556863,.846788,.342551,.420579,.560784,.850066,.347048,.417153,.564706,.853319,.351553,.413734,.568627,.856547,.356066,.410322,.572549,.85975,.360588,.406917,.576471,.862927,.365119,.403519,.580392,.866078,.36966,.400126,.584314,.869203,.374212,.396738,.588235,.872303,.378774,.393355,.592157,.875376,.383347,.389976,.596078,.878423,.387932,.3866,.6,.881443,.392529,.383229,.603922,.884436,.397139,.37986,.607843,.887402,.401762,.376494,.611765,.89034,.406398,.37313,.615686,.89325,.411048,.369768,.619608,.896131,.415712,.366407,.623529,.898984,.420392,.363047,.627451,.901807,.425087,.359688,.631373,.904601,.429797,.356329,.635294,.907365,.434524,.35297,.639216,.910098,.439268,.34961,.643137,.9128,.444029,.346251,.647059,.915471,.448807,.34289,.65098,.918109,.453603,.339529,.654902,.920714,.458417,.336166,.658824,.923287,.463251,.332801,.662745,.925825,.468103,.329435,.666667,.928329,.472975,.326067,.670588,.930798,.477867,.322697,.67451,.933232,.48278,.319325,.678431,.93563,.487712,.315952,.682353,.93799,.492667,.312575,.686275,.940313,.497642,.309197,.690196,.942598,.502639,.305816,.694118,.944844,.507658,.302433,.698039,.947051,.512699,.299049,.701961,.949217,.517763,.295662,.705882,.951344,.52285,.292275,.709804,.953428,.52796,.288883,.713725,.95547,.533093,.28549,.717647,.957469,.53825,.282096,.721569,.959424,.543431,.278701,.72549,.961336,.548636,.275305,.729412,.963203,.553865,.271909,.733333,.965024,.559118,.268513,.737255,.966798,.564396,.265118,.741176,.968526,.5697,.261721,.745098,.970205,.575028,.258325,.74902,.971835,.580382,.254931,.752941,.973416,.585761,.25154,.756863,.974947,.591165,.248151,.760784,.976428,.596595,.244767,.764706,.977856,.602051,.241387,.768627,.979233,.607532,.238013,.772549,.980556,.613039,.234646,.776471,.981826,.618572,.231287,.780392,.983041,.624131,.227937,.784314,.984199,.629718,.224595,.788235,.985301,.63533,.221265,.792157,.986345,.640969,.217948,.796078,.987332,.646633,.214648,.8,.98826,.652325,.211364,.803922,.989128,.658043,.2081,.807843,.989935,.663787,.204859,.811765,.990681,.669558,.201642,.815686,.991365,.675355,.198453,.819608,.991985,.681179,.195295,.823529,.992541,.68703,.19217,.827451,.993032,.692907,.189084,.831373,.993456,.69881,.186041,.835294,.993814,.704741,.183043,.839216,.994103,.710698,.180097,.843137,.994324,.716681,.177208,.847059,.994474,.722691,.174381,.85098,.994553,.728728,.171622,.854902,.994561,.734791,.168938,.858824,.994495,.74088,.166335,.862745,.994355,.746995,.163821,.866667,.994141,.753137,.161404,.870588,.993851,.759304,.159092,.87451,.993482,.765499,.156891,.878431,.993033,.77172,.154808,.882353,.992505,.777967,.152855,.886275,.991897,.784239,.151042,.890196,.991209,.790537,.149377,.894118,.990439,.796859,.14787,.898039,.989587,.803205,.146529,.901961,.988648,.809579,.145357,.905882,.987621,.815978,.144363,.909804,.986509,.822401,.143557,.913725,.985314,.828846,.142945,.917647,.984031,.835315,.142528,.921569,.982653,.841812,.142303,.92549,.98119,.848329,.142279,.929412,.979644,.854866,.142453,.933333,.977995,.861432,.142808,.937255,.976265,.868016,.143351,.941176,.974443,.874622,.144061,.945098,.97253,.88125,.144923,.94902,.970533,.887896,.145919,.952941,.968443,.894564,.147014,.956863,.966271,.901249,.14818,.960784,.964021,.90795,.14937,.964706,.961681,.914672,.15052,.968627,.959276,.921407,.151566,.972549,.956808,.928152,.152409,.976471,.954287,.934908,.152921,.980392,.951726,.941671,.152925,.984314,.949151,.948435,.152178,.988235,.946602,.95519,.150328,.992157,.944152,.961916,.146861,.996078,.941896,.96859,.140956,1,.940015,.975158,.131326]},{ColorSpace:"Diverging",Name:"Viridis (matplotlib)",NanColor:[1,0,0],Source:"https://github.com/BIDS/colormap/blob/master/colormaps.py",License:"CC0",Creator:"Eric Firing",RGBPoints:[0,.267004,.004874,.329415,.003922,.26851,.009605,.335427,.007843,.269944,.014625,.341379,.011765,.271305,.019942,.347269,.015686,.272594,.025563,.353093,.019608,.273809,.031497,.358853,.023529,.274952,.037752,.364543,.027451,.276022,.044167,.370164,.031373,.277018,.050344,.375715,.035294,.277941,.056324,.381191,.039216,.278791,.062145,.386592,.043137,.279566,.067836,.391917,.047059,.280267,.073417,.397163,.05098,.280894,.078907,.402329,.054902,.281446,.08432,.407414,.058824,.281924,.089666,.412415,.062745,.282327,.094955,.417331,.066667,.282656,.100196,.42216,.070588,.28291,.105393,.426902,.07451,.283091,.110553,.431554,.078431,.283197,.11568,.436115,.082353,.283229,.120777,.440584,.086275,.283187,.125848,.44496,.090196,.283072,.130895,.449241,.094118,.282884,.13592,.453427,.098039,.282623,.140926,.457517,.101961,.28229,.145912,.46151,.105882,.281887,.150881,.465405,.109804,.281412,.155834,.469201,.113725,.280868,.160771,.472899,.117647,.280255,.165693,.476498,.121569,.279574,.170599,.479997,.12549,.278826,.17549,.483397,.129412,.278012,.180367,.486697,.133333,.277134,.185228,.489898,.137255,.276194,.190074,.493001,.141176,.275191,.194905,.496005,.145098,.274128,.199721,.498911,.14902,.273006,.20452,.501721,.152941,.271828,.209303,.504434,.156863,.270595,.214069,.507052,.160784,.269308,.218818,.509577,.164706,.267968,.223549,.512008,.168627,.26658,.228262,.514349,.172549,.265145,.232956,.516599,.176471,.263663,.237631,.518762,.180392,.262138,.242286,.520837,.184314,.260571,.246922,.522828,.188235,.258965,.251537,.524736,.192157,.257322,.25613,.526563,.196078,.255645,.260703,.528312,.2,.253935,.265254,.529983,.203922,.252194,.269783,.531579,.207843,.250425,.27429,.533103,.211765,.248629,.278775,.534556,.215686,.246811,.283237,.535941,.219608,.244972,.287675,.53726,.223529,.243113,.292092,.538516,.227451,.241237,.296485,.539709,.231373,.239346,.300855,.540844,.235294,.237441,.305202,.541921,.239216,.235526,.309527,.542944,.243137,.233603,.313828,.543914,.247059,.231674,.318106,.544834,.25098,.229739,.322361,.545706,.254902,.227802,.326594,.546532,.258824,.225863,.330805,.547314,.262745,.223925,.334994,.548053,.266667,.221989,.339161,.548752,.270588,.220057,.343307,.549413,.27451,.21813,.347432,.550038,.278431,.21621,.351535,.550627,.282353,.214298,.355619,.551184,.286275,.212395,.359683,.55171,.290196,.210503,.363727,.552206,.294118,.208623,.367752,.552675,.298039,.206756,.371758,.553117,.301961,.204903,.375746,.553533,.305882,.203063,.379716,.553925,.309804,.201239,.38367,.554294,.313725,.19943,.387607,.554642,.317647,.197636,.391528,.554969,.321569,.19586,.395433,.555276,.32549,.1941,.399323,.555565,.329412,.192357,.403199,.555836,.333333,.190631,.407061,.556089,.337255,.188923,.41091,.556326,.341176,.187231,.414746,.556547,.345098,.185556,.41857,.556753,.34902,.183898,.422383,.556944,.352941,.182256,.426184,.55712,.356863,.180629,.429975,.557282,.360784,.179019,.433756,.55743,.364706,.177423,.437527,.557565,.368627,.175841,.44129,.557685,.372549,.174274,.445044,.557792,.376471,.172719,.448791,.557885,.380392,.171176,.45253,.557965,.384314,.169646,.456262,.55803,.388235,.168126,.459988,.558082,.392157,.166617,.463708,.558119,.396078,.165117,.467423,.558141,.4,.163625,.471133,.558148,.403922,.162142,.474838,.55814,.407843,.160665,.47854,.558115,.411765,.159194,.482237,.558073,.415686,.157729,.485932,.558013,.419608,.15627,.489624,.557936,.423529,.154815,.493313,.55784,.427451,.153364,.497,.557724,.431373,.151918,.500685,.557587,.435294,.150476,.504369,.55743,.439216,.149039,.508051,.55725,.443137,.147607,.511733,.557049,.447059,.14618,.515413,.556823,.45098,.144759,.519093,.556572,.454902,.143343,.522773,.556295,.458824,.141935,.526453,.555991,.462745,.140536,.530132,.555659,.466667,.139147,.533812,.555298,.470588,.13777,.537492,.554906,.47451,.136408,.541173,.554483,.478431,.135066,.544853,.554029,.482353,.133743,.548535,.553541,.486275,.132444,.552216,.553018,.490196,.131172,.555899,.552459,.494118,.129933,.559582,.551864,.498039,.128729,.563265,.551229,.501961,.127568,.566949,.550556,.505882,.126453,.570633,.549841,.509804,.125394,.574318,.549086,.513725,.124395,.578002,.548287,.517647,.123463,.581687,.547445,.521569,.122606,.585371,.546557,.52549,.121831,.589055,.545623,.529412,.121148,.592739,.544641,.533333,.120565,.596422,.543611,.537255,.120092,.600104,.54253,.541176,.119738,.603785,.5414,.545098,.119512,.607464,.540218,.54902,.119423,.611141,.538982,.552941,.119483,.614817,.537692,.556863,.119699,.61849,.536347,.560784,.120081,.622161,.534946,.564706,.120638,.625828,.533488,.568627,.12138,.629492,.531973,.572549,.122312,.633153,.530398,.576471,.123444,.636809,.528763,.580392,.12478,.640461,.527068,.584314,.126326,.644107,.525311,.588235,.128087,.647749,.523491,.592157,.130067,.651384,.521608,.596078,.132268,.655014,.519661,.6,.134692,.658636,.517649,.603922,.137339,.662252,.515571,.607843,.14021,.665859,.513427,.611765,.143303,.669459,.511215,.615686,.146616,.67305,.508936,.619608,.150148,.676631,.506589,.623529,.153894,.680203,.504172,.627451,.157851,.683765,.501686,.631373,.162016,.687316,.499129,.635294,.166383,.690856,.496502,.639216,.170948,.694384,.493803,.643137,.175707,.6979,.491033,.647059,.180653,.701402,.488189,.65098,.185783,.704891,.485273,.654902,.19109,.708366,.482284,.658824,.196571,.711827,.479221,.662745,.202219,.715272,.476084,.666667,.20803,.718701,.472873,.670588,.214,.722114,.469588,.67451,.220124,.725509,.466226,.678431,.226397,.728888,.462789,.682353,.232815,.732247,.459277,.686275,.239374,.735588,.455688,.690196,.24607,.73891,.452024,.694118,.252899,.742211,.448284,.698039,.259857,.745492,.444467,.701961,.266941,.748751,.440573,.705882,.274149,.751988,.436601,.709804,.281477,.755203,.432552,.713725,.288921,.758394,.428426,.717647,.296479,.761561,.424223,.721569,.304148,.764704,.419943,.72549,.311925,.767822,.415586,.729412,.319809,.770914,.411152,.733333,.327796,.77398,.40664,.737255,.335885,.777018,.402049,.741176,.344074,.780029,.397381,.745098,.35236,.783011,.392636,.74902,.360741,.785964,.387814,.752941,.369214,.788888,.382914,.756863,.377779,.791781,.377939,.760784,.386433,.794644,.372886,.764706,.395174,.797475,.367757,.768627,.404001,.800275,.362552,.772549,.412913,.803041,.357269,.776471,.421908,.805774,.35191,.780392,.430983,.808473,.346476,.784314,.440137,.811138,.340967,.788235,.449368,.813768,.335384,.792157,.458674,.816363,.329727,.796078,.468053,.818921,.323998,.8,.477504,.821444,.318195,.803922,.487026,.823929,.312321,.807843,.496615,.826376,.306377,.811765,.506271,.828786,.300362,.815686,.515992,.831158,.294279,.819608,.525776,.833491,.288127,.823529,.535621,.835785,.281908,.827451,.545524,.838039,.275626,.831373,.555484,.840254,.269281,.835294,.565498,.84243,.262877,.839216,.575563,.844566,.256415,.843137,.585678,.846661,.249897,.847059,.595839,.848717,.243329,.85098,.606045,.850733,.236712,.854902,.616293,.852709,.230052,.858824,.626579,.854645,.223353,.862745,.636902,.856542,.21662,.866667,.647257,.8584,.209861,.870588,.657642,.860219,.203082,.87451,.668054,.861999,.196293,.878431,.678489,.863742,.189503,.882353,.688944,.865448,.182725,.886275,.699415,.867117,.175971,.890196,.709898,.868751,.169257,.894118,.720391,.87035,.162603,.898039,.730889,.871916,.156029,.901961,.741388,.873449,.149561,.905882,.751884,.874951,.143228,.909804,.762373,.876424,.137064,.913725,.772852,.877868,.131109,.917647,.783315,.879285,.125405,.921569,.79376,.880678,.120005,.92549,.804182,.882046,.114965,.929412,.814576,.883393,.110347,.933333,.82494,.88472,.106217,.937255,.83527,.886029,.102646,.941176,.845561,.887322,.099702,.945098,.85581,.888601,.097452,.94902,.866013,.889868,.095953,.952941,.876168,.891125,.09525,.956863,.886271,.892374,.095374,.960784,.89632,.893616,.096335,.964706,.906311,.894855,.098125,.968627,.916242,.896091,.100717,.972549,.926106,.89733,.104071,.976471,.935904,.89857,.108131,.980392,.945636,.899815,.112838,.984314,.9553,.901065,.118128,.988235,.964894,.902323,.123941,.992157,.974417,.90359,.130215,.996078,.983868,.904867,.136897,1,.993248,.906157,.143936]},{ShowIndexedColorActiveValues:1,IndexedColors:[.07,.5,.7,1,1,1,.85,1,1,.8,.5,1,.76,1,0,1,.71,.71,.5,.5,.5,.05,.05,1,1,.05,.05,.7,1,1,.7,.89,.96,.67,.36,.95,.54,1,0,.75,.65,.65,.5,.6,.6,1,.5,0,1,1,.19,.12,.94,.12,.5,.82,.89,.56,.25,.83,.24,1,0,.9,.9,.9,.75,.76,.78,.65,.65,.67,.54,.6,.78,.61,.48,.78,.5,.48,.78,.44,.48,.78,.36,.48,.76,1,.48,.38,.49,.5,.69,.76,.56,.56,.4,.56,.56,.74,.5,.89,1,.63,0,.65,.16,.16,.36,.72,.82,.44,.18,.69,0,1,0,.58,1,1,.58,.88,.88,.45,.76,.79,.33,.71,.71,.23,.62,.62,.14,.56,.56,.04,.49,.55,0,.41,.52,.88,.88,1,1,.85,.56,.65,.46,.45,.4,.5,.5,.62,.39,.71,.83,.48,0,.58,0,.58,.26,.62,.69,.34,.09,.56,0,.79,0,.44,.83,1,1,1,.78,.85,1,.78,.78,1,.78,.64,1,.78,.56,1,.78,.38,1,.78,.27,1,.78,.19,1,.78,.12,1,.78,0,1,.61,0,.9,.46,0,.83,.32,0,.75,.22,0,.67,.14,.3,.76,1,.3,.65,1,.13,.58,.84,.15,.49,.67,.15,.4,.59,.09,.33,.53,.96,.93,.82,.8,.82,.12,.71,.71,.76,.65,.33,.3,.34,.35,.38,.62,.31,.71,.67,.36,0,.46,.31,.27,.26,.51,.59,.26,0,.4,0,.49,0,.44,.67,.98,0,.73,1,0,.63,1,0,.56,1,0,.5,1,0,.42,1,.33,.36,.95,.47,.36,.89,.54,.31,.89,.63,.21,.83,.7,.12,.83,.7,.12,.73,.7,.05,.65,.74,.05,.53,.78,0,.4,.8,0,.35,.82,0,.31,.85,0,.27,.88,0,.22,.9,0,.18,.91,0,.15,.92,0,.14,.93,0,.13,.94,0,.12,.95,0,.11,.96,0,.1,.97,0,.09,.98,0,.08,.99,0,.07,1,0,.06],Annotations:[0,"Xx",1,"H",2,"He",3,"Li",4,"Be",5,"B",6,"C",7,"N",8,"O",9,"F",10,"Ne",11,"Na",12,"Mg",13,"Al",14,"Si",15,"P",16,"S",17,"Cl",18,"Ar",19,"K",20,"Ca",21,"Sc",22,"Ti",23,"V",24,"Cr",25,"Mn",26,"Fe",27,"Co",28,"Ni",29,"Cu",30,"Zn",31,"Ga",32,"Ge",33,"As",34,"Se",35,"Br",36,"Kr",37,"Rb",38,"Sr",39,"Y",40,"Zr",41,"Nb",42,"Mo",43,"Tc",44,"Ru",45,"Rh",46,"Pd",47,"Ag",48,"Cd",49,"In",50,"Sn",51,"Sb",52,"Te",53,"I",54,"Xe",55,"Cs",56,"Ba",57,"La",58,"Ce",59,"Pr",60,"Nd",61,"Pm",62,"Sm",63,"Eu",64,"Gd",65,"Tb",66,"Dy",67,"Ho",68,"Er",69,"Tm",70,"Yb",71,"Lu",72,"Hf",73,"Ta",74,"W",75,"Re",76,"Os",77,"Ir",78,"Pt",79,"Au",80,"Hg",81,"Tl",82,"Pb",83,"Bi",84,"Po",85,"At",86,"Rn",87,"Fr",88,"Ra",89,"Ac",90,"Th",91,"Pa",92,"U",93,"Np",94,"Pu",95,"Am",96,"Cm",97,"Bk",98,"Cf",99,"Es",100,"Fm",101,"Md",102,"No",103,"Lr",104,"Rf",105,"Db",106,"Sg",107,"Bh",108,"Hs",109,"Mt",110,"Ds",111,"Rg",112,"Cn",113,"Uut",114,"Uuq",115,"Uup",116,"Uuh",117,"Uus",118,"Uuo"],Name:"BlueObeliskElements"}];const fm=Object.create(null);rwe.filter(t=>t.RGBPoints).filter(t=>t.ColorSpace!=="CIELAB").forEach(t=>{fm[t.Name]=t});const dm=Object.keys(fm);dm.sort();function iwe(t){return fm[t]}function awe(t){!t.RGBPoints||t.ColorSpace==="CIELAB"||(fm[t.Name]||(dm.push(t.Name),dm.sort()),fm[t.Name]=t)}function owe(t){const e=dm.indexOf(t);e>-1&&dm.splice(e,1),delete fm[t]}var j2={addPreset:awe,removePresetByName:owe,getPresetByName:iwe,rgbPresetNames:dm};const{vtkErrorMacro:Lx}=ce;function swe(t,e){e.classHierarchy.push("vtkPiecewiseFunction"),t.getSize=()=>e.nodes.length,t.getType=()=>{let n,r=0,i=0;e.nodes.length>0&&(r=e.nodes[0].y);for(let a=1;a<e.nodes.length;a++){if(n=e.nodes[a].y,n!==r)if(n>r)switch(i){case 0:case 1:i=1;break;case 2:default:i=3;break}else switch(i){case 0:case 2:i=2;break;case 1:default:i=3;break}if(r=n,i===3)break}switch(i){case 0:return"Constant";case 1:return"NonDecreasing";case 2:return"NonIncreasing";case 3:default:return"Varied"}},t.getDataPointer=()=>{const n=e.nodes.length;if(e.function=null,n>0){e.function=[];for(let r=0;r<n;r++)e.function[2*r]=e.nodes[r].x,e.function[2*r+1]=e.nodes[r].y}return e.function},t.getFirstNonZeroValue=()=>{if(e.nodes.length===0)return 0;let n=1,r=0,i=0;for(;i<e.nodes.length;i++)if(e.nodes[i].y!==0){n=0;break}return n?r=Number.MAX_VALUE:i>0?r=e.nodes[i-1].x:e.clamping?r=-Number.MAX_VALUE:r=e.nodes[0].x,r},t.getNodeValue=(n,r)=>{const i=e.nodes.length;return n<0||n>=i?(Lx("Index out of range!"),-1):(r[0]=e.nodes[n].x,r[1]=e.nodes[n].y,r[2]=e.nodes[n].midpoint,r[3]=e.nodes[n].sharpness,1)},t.setNodeValue=(n,r)=>{const i=e.nodes.length;if(n<0||n>=i)return Lx("Index out of range!"),-1;const a=e.nodes[n].x;return e.nodes[n].x=r[0],e.nodes[n].y=r[1],e.nodes[n].midpoint=r[2],e.nodes[n].sharpness=r[3],a!==r[0]?t.sortAndUpdateRange():t.modified(),1},t.addPoint=(n,r)=>t.addPointLong(n,r,.5,0),t.addPointLong=(n,r,i,a)=>{if(i<0||i>1)return Lx("Midpoint outside range [0.0, 1.0]"),-1;if(a<0||a>1)return Lx("Sharpness outside range [0.0, 1.0]"),-1;e.allowDuplicateScalars||t.removePoint(n);const o={x:n,y:r,midpoint:i,sharpness:a};e.nodes.push(o),t.sortAndUpdateRange();let s;for(s=0;s<e.nodes.length&&e.nodes[s].x!==n;s++);return s<e.nodes.length?s:-1},t.setNodes=n=>{e.nodes!==n&&(e.nodes=n,t.sortAndUpdateRange())},t.sortAndUpdateRange=()=>{e.nodes.sort((r,i)=>r.x-i.x),t.updateRange()||t.modified()},t.updateRange=()=>{const n=e.range.slice(),r=e.nodes.length;return r?(e.range[0]=e.nodes[0].x,e.range[1]=e.nodes[r-1].x):(e.range[0]=0,e.range[1]=0),n[0]===e.range[0]&&n[1]===e.range[1]?!1:(t.modified(),!0)},t.removePoint=n=>{let r;for(r=0;r<e.nodes.length&&e.nodes[r].x!==n;r++);if(r>=e.nodes.length)return-1;const i=r;let a=!1;return e.nodes.splice(r,1),(r===0||r===e.nodes.length)&&(a=t.updateRange()),a||t.modified(),i},t.removeAllPoints=()=>{e.nodes=[],t.sortAndUpdateRange()},t.addSegment=(n,r,i,a)=>{t.sortAndUpdateRange();for(let o=0;o<e.nodes.length;)e.nodes[o].x>=n&&e.nodes[o].x<=i?e.nodes.splice(o,1):o++;t.addPoint(n,r,.5,0),t.addPoint(i,a,.5,0)},t.getValue=n=>{const r=[];return t.getTable(n,n,1,r),r[0]},t.adjustRange=n=>{if(n.length<2)return 0;const r=t.getRange();r[0]<n[0]?t.addPoint(n[0],t.getValue(n[0])):t.addPoint(n[0],t.getValue(r[0])),r[1]>n[1]?t.addPoint(n[1],t.getValue(n[1])):t.addPoint(n[1],t.getValue(r[1])),t.sortAndUpdateRange();for(let i=0;i<e.nodes.length;)e.nodes[i].x>=n[0]&&e.nodes[i].x<=n[1]?e.nodes.splice(i,1):++i;return t.sortAndUpdateRange(),1},t.estimateMinNumberOfSamples=(n,r)=>{const i=t.findMinimumXDistance();return Math.ceil((r-n)/i)},t.findMinimumXDistance=()=>{const n=e.nodes.length;if(n<2)return-1;let r=e.nodes[1].x-e.nodes[0].x;for(let i=0;i<n-1;i++){const a=e.nodes[i+1].x-e.nodes[i].x;a<r&&(r=a)}return r},t.getTable=function(n,r,i,a){let o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1,s,l=0;const c=e.nodes.length;let f=0;c!==0&&(f=e.nodes[c-1].y);let u=0,d=0,h=0,p=0,g=0,m=0,y=0;for(s=0;s<i;s++){const v=o*s;for(i>1?u=n+s/(i-1)*(r-n):u=.5*(n+r);l<c&&u>e.nodes[l].x;)l++,l<c&&(d=e.nodes[l-1].x,h=e.nodes[l].x,p=e.nodes[l-1].y,g=e.nodes[l].y,m=e.nodes[l-1].midpoint,y=e.nodes[l-1].sharpness,m<1e-5&&(m=1e-5),m>.99999&&(m=.99999));if(l>=c)a[v]=e.clamping?f:0;else if(l===0)a[v]=e.clamping?e.nodes[0].y:0;else{let x=(u-d)/(h-d);if(x<m?x=.5*x/m:x=.5+.5*(x-m)/(1-m),y>.99)if(x<.5){a[v]=p;continue}else{a[v]=g;continue}if(y<.01){a[v]=(1-x)*p+x*g;continue}x<.5?x=.5*(x*2)**(1+10*y):x>.5&&(x=1-.5*((1-x)*2)**(1+10*y));const w=x*x,S=w*x,T=2*S-3*w+1,_=-2*S+3*w,D=S-2*w+x,I=S-w,R=g-p,O=(1-y)*R;a[v]=T*p+_*g+D*O+I*O;const P=p<g?p:g,N=p>g?p:g;a[v]=a[v]<P?P:a[v],a[v]=a[v]>N?N:a[v]}}}}const lwe={range:[0,0],clamping:!0,allowDuplicateScalars:!1};function lX(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,lwe,n),ce.obj(t,e),e.nodes=[],ce.setGet(t,e,["allowDuplicateScalars","clamping"]),ce.setArray(t,e,["range"],2),ce.getArray(t,e,["range"]),swe(t,e)}const cwe=ce.newInstance(lX,"vtkPiecewiseFunction");var kh={newInstance:cwe,extend:lX},cX=1e-6,Rs=typeof Float32Array<"u"?Float32Array:Array;function VE(t){return t>=0?Math.round(t):t%.5===0?Math.floor(t):Math.round(t)}function e3(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:cX;return Math.abs(t-e)<=n*Math.max(1,Math.abs(t),Math.abs(e))}function kx(t,e,n,r,i,a,o,s,l){var c=new Rs(9);return c[0]=t,c[1]=e,c[2]=n,c[3]=r,c[4]=i,c[5]=a,c[6]=o,c[7]=s,c[8]=l,c}function Lp(t){var e=t[0],n=t[1],r=t[2],i=t[3],a=t[4],o=t[5],s=t[6],l=t[7],c=t[8];return e*(c*a-o*l)+n*(-c*i+o*s)+r*(l*i-a*s)}function r0(){var t=new Rs(16);return Rs!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function Xk(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function uX(t,e,n,r,i,a,o,s,l,c,f,u,d,h,p,g){var m=new Rs(16);return m[0]=t,m[1]=e,m[2]=n,m[3]=r,m[4]=i,m[5]=a,m[6]=o,m[7]=s,m[8]=l,m[9]=c,m[10]=f,m[11]=u,m[12]=d,m[13]=h,m[14]=p,m[15]=g,m}function Yk(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Jk(t,e){if(t===e){var n=e[1],r=e[2],i=e[3],a=e[6],o=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=a,t[11]=e[14],t[12]=i,t[13]=o,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function e7(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],s=e[5],l=e[6],c=e[7],f=e[8],u=e[9],d=e[10],h=e[11],p=e[12],g=e[13],m=e[14],y=e[15],v=n*s-r*o,x=n*l-i*o,w=n*c-a*o,S=r*l-i*s,T=r*c-a*s,_=i*c-a*l,D=f*g-u*p,I=f*m-d*p,R=f*y-h*p,O=u*m-d*g,P=u*y-h*g,N=d*y-h*m,A=v*N-x*P+w*O+S*R-T*I+_*D;return A?(A=1/A,t[0]=(s*N-l*P+c*O)*A,t[1]=(i*P-r*N-a*O)*A,t[2]=(g*_-m*T+y*S)*A,t[3]=(d*T-u*_-h*S)*A,t[4]=(l*R-o*N-c*I)*A,t[5]=(n*N-i*R+a*I)*A,t[6]=(m*w-p*_-y*x)*A,t[7]=(f*_-d*w+h*x)*A,t[8]=(o*P-s*R+c*D)*A,t[9]=(r*R-n*P-a*D)*A,t[10]=(p*T-g*w+y*v)*A,t[11]=(u*w-f*T-h*v)*A,t[12]=(s*I-o*O-l*D)*A,t[13]=(n*O-r*I+i*D)*A,t[14]=(g*x-p*S-m*v)*A,t[15]=(f*S-u*x+d*v)*A,t):null}function fX(t,e,n){var r=n[0],i=n[1],a=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*a,t[9]=e[9]*a,t[10]=e[10]*a,t[11]=e[11]*a,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function dX(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function uwe(t,e,n){var r=n[0],i=n[1],a=n[2],o=Math.sqrt(r*r+i*i+a*a),s,l,c;return o<cX?null:(o=1/o,r*=o,i*=o,a*=o,s=Math.sin(e),l=Math.cos(e),c=1-l,t[0]=r*r*c+l,t[1]=i*r*c+a*s,t[2]=a*r*c-i*s,t[3]=0,t[4]=r*i*c-a*s,t[5]=i*i*c+l,t[6]=a*i*c+r*s,t[7]=0,t[8]=r*a*c+i*s,t[9]=i*a*c-r*s,t[10]=a*a*c+l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function fwe(t,e,n,r,i,a,o){var s=1/(e-n),l=1/(r-i),c=1/(a-o);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+n)*s,t[13]=(i+r)*l,t[14]=(o+a)*c,t[15]=1,t}var dwe=fwe;function hwe(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t}function it(){var t=new Rs(3);return Rs!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function hX(t){var e=new Rs(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function Vo(t){var e=t[0],n=t[1],r=t[2];return Math.sqrt(e*e+n*n+r*r)}function Sn(t,e,n){var r=new Rs(3);return r[0]=t,r[1]=e,r[2]=n,r}function t7(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function t3(t,e,n,r){return t[0]=e,t[1]=n,t[2]=r,t}function Ul(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function Pr(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function pwe(t,e){return t[0]=VE(e[0]),t[1]=VE(e[1]),t[2]=VE(e[2]),t}function tl(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function Ar(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t}function ol(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return Math.sqrt(n*n+r*r+i*i)}function pX(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return n*n+r*r+i*i}function cu(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function Lr(t,e){var n=e[0],r=e[1],i=e[2],a=n*n+r*r+i*i;return a>0&&(a=1/Math.sqrt(a)),t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a,t}function zt(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function gr(t,e,n){var r=e[0],i=e[1],a=e[2],o=n[0],s=n[1],l=n[2];return t[0]=i*l-a*s,t[1]=a*o-r*l,t[2]=r*s-i*o,t}function z2(t,e,n){var r=e[0],i=e[1],a=e[2],o=n[3]*r+n[7]*i+n[11]*a+n[15];return o=o||1,t[0]=(n[0]*r+n[4]*i+n[8]*a+n[12])/o,t[1]=(n[1]*r+n[5]*i+n[9]*a+n[13])/o,t[2]=(n[2]*r+n[6]*i+n[10]*a+n[14])/o,t}function gX(t,e){var n=t[0],r=t[1],i=t[2],a=e[0],o=e[1],s=e[2],l=Math.sqrt((n*n+r*r+i*i)*(a*a+o*o+s*s)),c=l&&zt(t,e)/l;return Math.acos(Math.min(Math.max(c,-1),1))}var dr=Pr,gwe=pX,E_=Vo;(function(){var t=it();return function(e,n,r,i,a,o){var s,l;for(n||(n=3),r||(r=0),i?l=Math.min(i*n+r,e.length):l=e.length,s=r;s<l;s+=n)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],a(t,t,o),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2];return e}})();function mX(){var t=new Rs(4);return Rs!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function FE(t,e,n,r){var i=new Rs(4);return i[0]=t,i[1]=e,i[2]=n,i[3]=r,i}function Zk(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function mwe(t,e,n){var r=e[0],i=e[1],a=e[2],o=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*a+n[12]*o,t[1]=n[1]*r+n[5]*i+n[9]*a+n[13]*o,t[2]=n[2]*r+n[6]*i+n[10]*a+n[14]*o,t[3]=n[3]*r+n[7]*i+n[11]*a+n[15]*o,t}(function(){var t=mX();return function(e,n,r,i,a,o){var s,l;for(n||(n=4),r||(r=0),i?l=Math.min(i*n+r,e.length):l=e.length,s=r;s<l;s+=n)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],t[3]=e[s+3],a(t,t,o),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2],e[s+3]=t[3];return e}})();function Kn(){var t=new Rs(2);return Rs!=Float32Array&&(t[0]=0,t[1]=0),t}function Qk(t,e){var n=new Rs(2);return n[0]=t,n[1]=e,n}function Nl(t,e,n){return t[0]=e,t[1]=n,t}function FC(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function ka(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t}function __(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t}function Ov(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t}function ii(t,e){var n=e[0]-t[0],r=e[1]-t[1];return Math.sqrt(n*n+r*r)}function Ud(t,e){var n=e[0]-t[0],r=e[1]-t[1];return n*n+r*r}function D_(t){var e=t[0],n=t[1];return Math.sqrt(e*e+n*n)}function dh(t,e){var n=e[0],r=e[1],i=n*n+r*r;return i>0&&(i=1/Math.sqrt(i)),t[0]=e[0]*i,t[1]=e[1]*i,t}function pf(t,e){return t[0]*e[0]+t[1]*e[1]}function vwe(t,e,n,r){var i=e[0]-n[0],a=e[1]-n[1],o=Math.sin(r),s=Math.cos(r);return t[0]=i*s-a*o+n[0],t[1]=i*o+a*s+n[1],t}var Vh=ka,n7=ii;(function(){var t=Kn();return function(e,n,r,i,a,o){var s,l;for(n||(n=2),r||(r=0),i?l=Math.min(i*n+r,e.length):l=e.length,s=r;s<l;s+=n)t[0]=e[s],t[1]=e[s+1],a(t,t,o),e[s]=t[0],e[s+1]=t[1];return e}})();function Ci(t){const e=t.indexOf(":");return t.substring(e+1)}function vX(t){let e=2166136261;for(let n=0;n<t.length;n++)e^=t.charCodeAt(n),e+=(e<<1)+(e<<4)+(e<<7)+(e<<8)+(e<<24);return(e>>>0).toString(36)}const ywe=1073741824;class xwe{constructor(){this._imageCache=new Map,this._volumeCache=new Map,this._imageIdsToVolumeIdCache=new Map,this._referencedImageIdToImageIdCache=new Map,this._geometryCache=new Map,this._imageCacheSize=0,this._maxCacheSize=3*ywe,this._geometryCacheSize=0,this.setMaxCacheSize=e=>{if(!e||typeof e!="number"){const n=`New max cacheSize ${this._maxCacheSize} should be defined and should be a number.`;throw new Error(n)}this._maxCacheSize=e},this.isCacheable=e=>{const n=this.getBytesAvailable(),r=Array.from(this._imageCache.values()).reduce((a,o)=>o.sharedCacheKey?a:a+o.sizeInBytes,0);return n+r>=e},this.getMaxCacheSize=()=>this._maxCacheSize,this.getCacheSize=()=>this._imageCacheSize,this._decacheImage=(e,n=!1)=>{const r=this._imageCache.get(e);if(!r)return;if(r.sharedCacheKey&&!n)throw new Error("Cannot decache an image with a shared cache key. You need to manually decache the volume first.");const{imageLoadObject:i}=r;r.image?.referencedImageId&&this._referencedImageIdToImageIdCache.delete(r.image.referencedImageId),i?.cancelFn&&i.cancelFn(),i?.decache&&i.decache(),this._imageCache.delete(e)},this._decacheVolume=e=>{const n=this._volumeCache.get(e);if(!n)return;const{volumeLoadObject:r,volume:i}=n;i&&(i.cancelLoading&&i.cancelLoading(),i.imageData&&i.imageData.delete(),r.cancelFn&&r.cancelFn(),i.imageIds&&i.imageIds.forEach(a=>{const o=this._imageCache.get(a);o&&o.sharedCacheKey===e&&(o.sharedCacheKey=void 0)}),this._volumeCache.delete(e))},this.purgeCache=()=>{const e=this._imageCache.keys();for(this.purgeVolumeCache();;){const{value:n,done:r}=e.next();if(r)break;this.removeImageLoadObject(n,{force:!0}),wt(vt,mt.IMAGE_CACHE_IMAGE_REMOVED,{imageId:n})}},this.purgeVolumeCache=()=>{const e=this._volumeCache.keys();for(;;){const{value:n,done:r}=e.next();if(r)break;this.removeVolumeLoadObject(n),wt(vt,mt.VOLUME_CACHE_VOLUME_REMOVED,{volumeId:n})}},this.getVolumeLoadObject=e=>{if(e===void 0)throw new Error("getVolumeLoadObject: volumeId must not be undefined");const n=this._volumeCache.get(e);if(n)return n.timeStamp=Date.now(),n.volumeLoadObject},this.putGeometryLoadObject=(e,n)=>{if(e===void 0)throw new Error("putGeometryLoadObject: geometryId must not be undefined");if(n.promise===void 0)throw new Error("putGeometryLoadObject: geometryLoadObject.promise must not be undefined");if(this._geometryCache.has(e))throw new Error("putGeometryLoadObject: geometryId already present in geometryCache");if(n.cancelFn&&typeof n.cancelFn!="function")throw new Error("putGeometryLoadObject: geometryLoadObject.cancel must be a function");const r={loaded:!1,geometryId:e,geometryLoadObject:n,timeStamp:Date.now(),sizeInBytes:0};return this._geometryCache.set(e,r),n.promise.then(i=>{try{this._putGeometryCommon(e,i,r)}catch(a){throw console.debug(`Error in _putGeometryCommon for geometry ${e}:`,a),a}}).catch(i=>{throw console.debug(`Error caching geometry ${e}:`,i),this._geometryCache.delete(e),i})},this.getGeometry=e=>{if(e===void 0)throw new Error("getGeometry: geometryId must not be undefined");const n=this._geometryCache.get(e);if(n)return n.timeStamp=Date.now(),n.geometry},this.removeGeometryLoadObject=e=>{if(e===void 0)throw new Error("removeGeometryLoadObject: geometryId must not be undefined");const n=this._geometryCache.get(e);if(!n)throw new Error("removeGeometryLoadObject: geometryId was not present in geometryCache");this.decrementGeometryCacheSize(n.sizeInBytes);const r={geometry:n,geometryId:e};wt(vt,mt.GEOMETRY_CACHE_GEOMETRY_REMOVED,r),this._decacheGeometry(e)},this._decacheGeometry=e=>{const n=this._geometryCache.get(e);if(!n)return;const{geometryLoadObject:r}=n;r.cancelFn&&r.cancelFn(),r.decache&&r.decache(),this._geometryCache.delete(e)},this.incrementGeometryCacheSize=e=>{this._geometryCacheSize+=e},this.decrementGeometryCacheSize=e=>{this._geometryCacheSize-=e},this.getImageByReferencedImageId=e=>{const n=this._referencedImageIdToImageIdCache.get(e);if(n)return this._imageCache.get(n)?.image},this.getImage=(e,n=Ds.FAR_REPLICATE)=>{if(e===void 0)throw new Error("getImage: imageId must not be undefined");const r=this._imageCache.get(e);if(r&&(r.timeStamp=Date.now(),!(r.image?.imageQualityStatus<n)))return r.image},this.getVolume=(e,n=!1)=>{if(e===void 0)throw new Error("getVolume: volumeId must not be undefined");const r=this._volumeCache.get(e);return r?(r.timeStamp=Date.now(),r.volume):n?[...this._volumeCache.values()].find(i=>i.volumeId.includes(e))?.volume:void 0},this.getVolumes=()=>Array.from(this._volumeCache.values()).map(n=>n.volume),this.filterVolumesByReferenceId=e=>this.getVolumes().filter(r=>r.referencedVolumeId===e),this.removeImageLoadObject=(e,{force:n=!1}={})=>{if(e===void 0)throw new Error("removeImageLoadObject: imageId must not be undefined");const r=this._imageCache.get(e);if(!r)throw new Error("removeImageLoadObject: imageId was not present in imageCache");this._decacheImage(e,n),this.incrementImageCacheSize(-r.sizeInBytes);const i={image:r,imageId:e};wt(vt,mt.IMAGE_CACHE_IMAGE_REMOVED,i)},this.removeVolumeLoadObject=e=>{if(e===void 0)throw new Error("removeVolumeLoadObject: volumeId must not be undefined");const n=this._volumeCache.get(e);if(!n)throw new Error("removeVolumeLoadObject: volumeId was not present in volumeCache");const r={volume:n,volumeId:e};wt(vt,mt.VOLUME_CACHE_VOLUME_REMOVED,r),this._decacheVolume(e)},this.incrementImageCacheSize=e=>{this._imageCacheSize+=e},this.decrementImageCacheSize=e=>{this._imageCacheSize-=e},this.getGeometryLoadObject=e=>{if(e===void 0)throw new Error("getGeometryLoadObject: geometryId must not be undefined");const n=this._geometryCache.get(e);if(n)return n.timeStamp=Date.now(),n.geometryLoadObject}}generateVolumeId(e){const n=e.map(Ci).sort();let r=2166136261;for(const i of n){const a=vX(i);for(let o=0;o<a.length;o++)r^=a.charCodeAt(o),r+=(r<<1)+(r<<4)+(r<<7)+(r<<8)+(r<<24)}return`volume-${(r>>>0).toString(36)}`}getImageIdsForVolumeId(e){return Array.from(this._imageIdsToVolumeIdCache.entries()).filter(([n,r])=>r===e).map(([n])=>n)}getBytesAvailable(){return this.getMaxCacheSize()-this.getCacheSize()}decacheIfNecessaryUntilBytesAvailable(e,n){let r=this.getBytesAvailable();if(r>=e)return r;const i=Array.from(this._imageCache.values()).filter(l=>!l.sharedCacheKey);function a(l,c){return l.timeStamp>c.timeStamp?1:l.timeStamp<c.timeStamp?-1:0}i.sort(a);const o=i.map(l=>l.imageId);let s=o;n&&(s=o.filter(l=>!n.includes(l)));for(const l of s)if(this.removeImageLoadObject(l),wt(vt,mt.IMAGE_CACHE_IMAGE_REMOVED,{imageId:l}),r=this.getBytesAvailable(),r>=e)return r;for(const l of o)if(this.removeImageLoadObject(l),wt(vt,mt.IMAGE_CACHE_IMAGE_REMOVED,{imageId:l}),r=this.getBytesAvailable(),r>=e)return r}_putImageCommon(e,n,r){if(!this._imageCache.has(e)){console.warn("The image was purged from the cache before it completed loading.");return}if(!n){console.warn("Image is undefined");return}if(n.sizeInBytes===void 0||Number.isNaN(n.sizeInBytes))throw new Error("_putImageCommon: image.sizeInBytes must not be undefined");if(n.sizeInBytes.toFixed===void 0)throw new Error("_putImageCommon: image.sizeInBytes is not a number");if(!this.isCacheable(n.sizeInBytes))throw new Error(mt.CACHE_SIZE_EXCEEDED);this.decacheIfNecessaryUntilBytesAvailable(n.sizeInBytes),r.loaded=!0,r.image=n,r.sizeInBytes=n.sizeInBytes,this.incrementImageCacheSize(r.sizeInBytes);const i={image:r};n.referencedImageId&&this._referencedImageIdToImageIdCache.set(n.referencedImageId,e),wt(vt,mt.IMAGE_CACHE_IMAGE_ADDED,i),r.sharedCacheKey=n.sharedCacheKey}async putImageLoadObject(e,n){if(e===void 0)throw console.error("putImageLoadObject: imageId must not be undefined"),new Error("putImageLoadObject: imageId must not be undefined");if(n.promise===void 0)throw console.error("putImageLoadObject: imageLoadObject.promise must not be undefined"),new Error("putImageLoadObject: imageLoadObject.promise must not be undefined");const r=this._imageCache.get(e);if(r?.imageLoadObject)throw console.warn(`putImageLoadObject: imageId ${e} already in cache`),new Error("putImageLoadObject: imageId already in cache");if(n.cancelFn&&typeof n.cancelFn!="function")throw console.error("putImageLoadObject: imageLoadObject.cancel must be a function"),new Error("putImageLoadObject: imageLoadObject.cancel must be a function");const i={...r,loaded:!1,imageId:e,sharedCacheKey:void 0,imageLoadObject:n,timeStamp:Date.now(),sizeInBytes:0};return this._imageCache.set(e,i),n.promise.then(a=>{try{this._putImageCommon(e,a,i)}catch(o){throw console.debug(`Error in _putImageCommon for image ${e}:`,o),o}}).catch(a=>{throw console.debug(`Error caching image ${e}:`,a),this._imageCache.delete(e),a})}putImageSync(e,n){if(e===void 0)throw new Error("putImageSync: imageId must not be undefined");if(this._imageCache.has(e))throw new Error("putImageSync: imageId already in cache");const r={loaded:!1,imageId:e,sharedCacheKey:void 0,imageLoadObject:{promise:Promise.resolve(n)},timeStamp:Date.now(),sizeInBytes:0};this._imageCache.set(e,r);try{this._putImageCommon(e,n,r)}catch(i){throw this._imageCache.delete(e),i}}getImageLoadObject(e){if(e===void 0)throw new Error("getImageLoadObject: imageId must not be undefined");const n=this._imageCache.get(e);if(n)return n.timeStamp=Date.now(),n.imageLoadObject}isLoaded(e){const n=this._imageCache.get(e);return n?n.loaded:!1}getVolumeContainingImageId(e){const n=Array.from(this._volumeCache.keys()),r=Ci(e);for(const i of n){const a=this._volumeCache.get(i);if(!a)return;const{volume:o}=a;if(!o.imageIds.length)return;const s=o.getImageURIIndex(r);if(s>-1)return{volume:o,imageIdIndex:s}}}getCachedImageBasedOnImageURI(e){const n=Ci(e),i=Array.from(this._imageCache.keys()).find(a=>Ci(a)===n);if(i)return this._imageCache.get(i)}_putVolumeCommon(e,n,r){if(!this._volumeCache.get(e)){console.warn("The volume was purged from the cache before it completed loading.");return}r.loaded=!0,r.volume=n,n.imageIds?.forEach(a=>{const o=this._imageCache.get(a);o&&(o.sharedCacheKey=e)});const i={volume:r};wt(vt,mt.VOLUME_CACHE_VOLUME_ADDED,i)}putVolumeSync(e,n){if(e===void 0)throw new Error("putVolumeSync: volumeId must not be undefined");if(this._volumeCache.has(e))throw new Error("putVolumeSync: volumeId already in cache");const r={loaded:!1,volumeId:e,volumeLoadObject:{promise:Promise.resolve(n)},timeStamp:Date.now(),sizeInBytes:0};this._volumeCache.set(e,r);try{this._putVolumeCommon(e,n,r)}catch(i){throw this._volumeCache.delete(e),i}}async putVolumeLoadObject(e,n){if(e===void 0)throw new Error("putVolumeLoadObject: volumeId must not be undefined");if(n.promise===void 0)throw new Error("putVolumeLoadObject: volumeLoadObject.promise must not be undefined");if(this._volumeCache.has(e))throw new Error(`putVolumeLoadObject: volumeId:${e} already in cache`);if(n.cancelFn&&typeof n.cancelFn!="function")throw new Error("putVolumeLoadObject: volumeLoadObject.cancel must be a function");const r={loaded:!1,volumeId:e,volumeLoadObject:n,timeStamp:Date.now(),sizeInBytes:0};return this._volumeCache.set(e,r),n.promise.then(i=>{try{this._putVolumeCommon(e,i,r)}catch(a){throw console.error(`Error in _putVolumeCommon for volume ${e}:`,a),this._volumeCache.delete(e),a}}).catch(i=>{throw this._volumeCache.delete(e),i})}_putGeometryCommon(e,n,r){if(!this._geometryCache.get(e)){console.warn("The geometry was purged from the cache before it completed loading.");return}if(!n){console.warn("Geometry is undefined");return}if(n.sizeInBytes===void 0||Number.isNaN(n.sizeInBytes))throw new Error("_putGeometryCommon: geometry.sizeInBytes must not be undefined");if(n.sizeInBytes.toFixed===void 0)throw new Error("_putGeometryCommon: geometry.sizeInBytes is not a number");if(!this.isCacheable(n.sizeInBytes))throw new Error(mt.CACHE_SIZE_EXCEEDED);this.decacheIfNecessaryUntilBytesAvailable(n.sizeInBytes),r.loaded=!0,r.geometry=n,r.sizeInBytes=n.sizeInBytes,this.incrementGeometryCacheSize(r.sizeInBytes);const i={geometry:r};wt(vt,mt.GEOMETRY_CACHE_GEOMETRY_ADDED,i)}putGeometrySync(e,n){if(e===void 0)throw new Error("putGeometrySync: geometryId must not be undefined");if(this._geometryCache.has(e))throw new Error("putGeometrySync: geometryId already in cache");const r={loaded:!1,geometryId:e,geometryLoadObject:{promise:Promise.resolve(n)},timeStamp:Date.now(),sizeInBytes:0};this._geometryCache.set(e,r);try{this._putGeometryCommon(e,n,r)}catch(i){throw this._geometryCache.delete(e),i}}setPartialImage(e,n){const r=this._imageCache.get(e);if(!r){n&&this._imageCache.set(e,{image:n,imageId:e,loaded:!1,timeStamp:Date.now(),sizeInBytes:0});return}r.loaded&&(r.loaded=!1,r.imageLoadObject=null,this.incrementImageCacheSize(-r.sizeInBytes),r.sizeInBytes=0),r.image=n||r.image}getImageQuality(e){const n=this._imageCache.get(e)?.image;return n?n.imageQualityStatus||Ds.FULL_RESOLUTION:void 0}}const yt=new xwe;function yX(t,e,n){return Math.abs(t-e)<=n}function bwe(t,e,n=1e-5){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!yX(t[r],e[r],n))return!1;return!0}function eV(t){return typeof t=="number"}function tV(t){return t&&typeof t=="object"&&"length"in t&&typeof t.length=="number"&&t.length>0&&typeof t[0]=="number"}function pr(t,e,n=1e-5){return typeof t!=typeof e||t===null||e===null?!1:eV(t)&&eV(e)?yX(t,e,n):tV(t)&&tV(e)?bwe(t,e,n):!1}const xX=t=>typeof t=="number"?-t:t?.map?t.map(xX):!t,O_=t=>typeof t=="number"?Math.abs(t):t?.map?t.map(O_):t,bX=(t,e,n=void 0)=>pr(t,xX(e),n),Xb=(t,e,n=void 0)=>pr(O_(t),O_(e),n);function hi(t){return Array.isArray(t)?hi(t[0]):isFinite(t)&&!isNaN(t)}function gc(t){return ns(t,"vtkVolume")||ns(t,"vtkImageSlice")}function ns(t,e){const n="isA"in t?t:t.actor;return n?!!n.isA(e):!1}const r7=new Map;function wwe(t){t.name=t.name||t.Name,r7.set(t.name,t)}function W2(t){return r7.get(t)}function wX(){return Array.from(r7.keys())}function i7(t,e){const n=j2.rgbPresetNames.map(l=>j2.getPresetByName(l)),r=wX().map(l=>W2(l)),a=n.concat(r).find(l=>{const{RGBPoints:c}=l;if(c.length!==t.length)return!1;for(let f=0;f<c.length;f+=4)if(!pr(c.slice(f+1,f+4),t.slice(f+1,f+4)))return!1;return!0});if(!a)return null;const o=[];if(ns(e,"vtkVolume")){const l=e.getProperty().getScalarOpacity(0).getDataPointer();if(!l)return{name:a.Name};for(let c=0;c<l.length;c+=2)o.push({value:l[c],opacity:l[c+1]})}return{name:a.Name,...Array.isArray(o)&&o.length>0&&{opacity:o},...typeof o=="number"&&{opacity:o}}}function Cwe(t){const{volumeActor:e,preset:n,opacity:r=.9,threshold:i=null,colorRange:a=[0,5]}=t;e.getMapper().setSampleDistance(1);const s=Uf.newInstance(),l=n||j2.getPresetByName("hsv");s.applyColorMap(l),s.setMappingRange(a[0],a[1]),e.getProperty().setRGBTransferFunction(0,s),a7(e,r,i)}function CX(t,e){const n=o7(t);a7(t,e,n)}function SX(t,e){const n=s7(t);a7(t,n,e)}function a7(t,e,n){const r=t.getMapper().getInputData().get("voxelManager");if(!r?.voxelManager)throw new Error("No voxel manager was found for the volume actor, or you cannot yet update opacity with a threshold using stacked images");const i=r.voxelManager.getRange(),a=kh.newInstance();if(n!==null){const o=Math.abs(i[1]-i[0])*.001,s=Math.max(i[0],Math.min(i[1],n));a.addPoint(i[0],0),a.addPoint(s-o,0),a.addPoint(s,e),a.addPoint(i[1],e)}else a.addPoint(i[0],e),a.addPoint(i[1],e);t.getProperty().setScalarOpacity(0,a)}function o7(t){const e=t.getProperty().getScalarOpacity(0);if(!e)return null;const n=e.getDataPointer();if(!n||n.length<=4)return null;for(let r=0;r<n.length-2;r+=2){n[r];const i=n[r+1],a=n[r+2],o=n[r+3];if(i===0&&o>0)return a}return null}function s7(t){const e=t.getProperty().getScalarOpacity(0);if(!e)return 1;const n=e.getDataPointer();if(!n||n.length===0)return 1;let r=0;for(let i=1;i<n.length;i+=2)n[i]>r&&(r=n[i]);return r}const Swe=Object.freeze(Object.defineProperty({__proto__:null,findMatchingColormap:i7,getColormap:W2,getColormapNames:wX,getMaxOpacity:s7,getThresholdValue:o7,registerColormap:wwe,setColorMapTransferFunctionForVolumeActor:Cwe,updateOpacity:CX,updateThreshold:SX},Symbol.toStringTag,{value:"Module"}));function i2(t){if(!t)return;const e=t.getSize();for(let n=0;n<e;n++){const r=[];t.getNodeValue(n,r),r[1]=1-r[1],r[2]=1-r[2],r[3]=1-r[3],t.setNodeValue(n,r)}}const M_=(t,e,n)=>e-n/4*Math.log((1-t)/t);function Py(t,e){const n=Math.abs(e-t)+1,r=(t+e+1)/2;return{windowWidth:n,windowCenter:r}}function zg(t,e,n=po.LINEAR){if(n===po.LINEAR)return{lower:e-.5-(t-1)/2,upper:e-.5+(t-1)/2};if(n===po.LINEAR_EXACT)return{lower:e-t/2,upper:e+t/2};if(n===po.SAMPLED_SIGMOID){const r=M_(.01,e,t),i=M_(.99,e,t);return{lower:r,upper:i}}else throw new Error("Invalid VOI LUT function")}const Twe=Object.freeze(Object.defineProperty({__proto__:null,toLowHighRange:zg,toWindowLevel:Py},Symbol.toStringTag,{value:"Module"}));function l7(t,e=1024){const{windowWidth:n,windowCenter:r}=Py(t.lower,t.upper),a=Array.from({length:e},(s,l)=>(l+1)/(e+2)).flatMap(s=>[M_(s,r,n),s,s,s,.5,0]),o=Uf.newInstance();return o.buildFunctionFromArray(tn.newInstance({values:a,numberOfComponents:6})),o}function fo(t,e){return t.worldToIndex(e).map(Math.round)}function Yb(t,e){return t.worldToIndex(e)}function n3(t){const e=t.getSize(),n=[];for(let r=0;r<e;r++){const i=[];t.getNodeValue(r,i),n.push(i)}return n}function UC(t,e){e?.length&&(t.removeAllPoints(),e.forEach(n=>{t.addRGBPoint(...n)}))}const Ewe=Object.freeze(Object.defineProperty({__proto__:null,getTransferFunctionNodes:n3,setTransferFunctionNodes:UC},Symbol.toStringTag,{value:"Module"}));var or=1e-6,Qa=typeof Float32Array<"u"?Float32Array:Array,_we=Math.PI/180;function Dwe(t){return t*_we}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});function c7(){var t=new Qa(9);return Qa!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function BC(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}function Owe(t){var e=new Qa(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function Mwe(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function Iwe(t,e,n,r,i,a,o,s,l){var c=new Qa(9);return c[0]=t,c[1]=e,c[2]=n,c[3]=r,c[4]=i,c[5]=a,c[6]=o,c[7]=s,c[8]=l,c}function TX(t,e,n,r,i,a,o,s,l,c){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=a,t[5]=o,t[6]=s,t[7]=l,t[8]=c,t}function Bl(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function u7(t,e){if(t===e){var n=e[1],r=e[2],i=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=r,t[7]=i}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function Ay(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],s=e[5],l=e[6],c=e[7],f=e[8],u=f*o-s*c,d=-f*a+s*l,h=c*a-o*l,p=n*u+r*d+i*h;return p?(p=1/p,t[0]=u*p,t[1]=(-f*r+i*c)*p,t[2]=(s*r-i*o)*p,t[3]=d*p,t[4]=(f*n-i*l)*p,t[5]=(-s*n+i*a)*p,t[6]=h*p,t[7]=(-c*n+r*l)*p,t[8]=(o*n-r*a)*p,t):null}function Rwe(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],s=e[5],l=e[6],c=e[7],f=e[8];return t[0]=o*f-s*c,t[1]=i*c-r*f,t[2]=r*s-i*o,t[3]=s*l-a*f,t[4]=n*f-i*l,t[5]=i*a-n*s,t[6]=a*c-o*l,t[7]=r*l-n*c,t[8]=n*o-r*a,t}function Pwe(t){var e=t[0],n=t[1],r=t[2],i=t[3],a=t[4],o=t[5],s=t[6],l=t[7],c=t[8];return e*(c*a-o*l)+n*(-c*i+o*s)+r*(l*i-a*s)}function hm(t,e,n){var r=e[0],i=e[1],a=e[2],o=e[3],s=e[4],l=e[5],c=e[6],f=e[7],u=e[8],d=n[0],h=n[1],p=n[2],g=n[3],m=n[4],y=n[5],v=n[6],x=n[7],w=n[8];return t[0]=d*r+h*o+p*c,t[1]=d*i+h*s+p*f,t[2]=d*a+h*l+p*u,t[3]=g*r+m*o+y*c,t[4]=g*i+m*s+y*f,t[5]=g*a+m*l+y*u,t[6]=v*r+x*o+w*c,t[7]=v*i+x*s+w*f,t[8]=v*a+x*l+w*u,t}function Awe(t,e,n){var r=e[0],i=e[1],a=e[2],o=e[3],s=e[4],l=e[5],c=e[6],f=e[7],u=e[8],d=n[0],h=n[1];return t[0]=r,t[1]=i,t[2]=a,t[3]=o,t[4]=s,t[5]=l,t[6]=d*r+h*o+c,t[7]=d*i+h*s+f,t[8]=d*a+h*l+u,t}function Nwe(t,e,n){var r=e[0],i=e[1],a=e[2],o=e[3],s=e[4],l=e[5],c=e[6],f=e[7],u=e[8],d=Math.sin(n),h=Math.cos(n);return t[0]=h*r+d*o,t[1]=h*i+d*s,t[2]=h*a+d*l,t[3]=h*o-d*r,t[4]=h*s-d*i,t[5]=h*l-d*a,t[6]=c,t[7]=f,t[8]=u,t}function Lwe(t,e,n){var r=n[0],i=n[1];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=i*e[3],t[4]=i*e[4],t[5]=i*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function kwe(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t}function Vwe(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=-n,t[4]=r,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function Fwe(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function Uwe(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t}function Bwe(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],o=n+n,s=r+r,l=i+i,c=n*o,f=r*o,u=r*s,d=i*o,h=i*s,p=i*l,g=a*o,m=a*s,y=a*l;return t[0]=1-u-p,t[3]=f-y,t[6]=d+m,t[1]=f+y,t[4]=1-c-p,t[7]=h-g,t[2]=d-m,t[5]=h+g,t[8]=1-c-u,t}function $we(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],s=e[5],l=e[6],c=e[7],f=e[8],u=e[9],d=e[10],h=e[11],p=e[12],g=e[13],m=e[14],y=e[15],v=n*s-r*o,x=n*l-i*o,w=n*c-a*o,S=r*l-i*s,T=r*c-a*s,_=i*c-a*l,D=f*g-u*p,I=f*m-d*p,R=f*y-h*p,O=u*m-d*g,P=u*y-h*g,N=d*y-h*m,A=v*N-x*P+w*O+S*R-T*I+_*D;return A?(A=1/A,t[0]=(s*N-l*P+c*O)*A,t[1]=(l*R-o*N-c*I)*A,t[2]=(o*P-s*R+c*D)*A,t[3]=(i*P-r*N-a*O)*A,t[4]=(n*N-i*R+a*I)*A,t[5]=(r*R-n*P-a*D)*A,t[6]=(g*_-m*T+y*S)*A,t[7]=(m*w-p*_-y*x)*A,t[8]=(p*T-g*w+y*v)*A,t):null}function Gwe(t,e,n){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/n,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}function jwe(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"}function zwe(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])}function Wwe(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t}function EX(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t}function Hwe(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t}function Kwe(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t}function qwe(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]}function Xwe(t,e){var n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],s=t[5],l=t[6],c=t[7],f=t[8],u=e[0],d=e[1],h=e[2],p=e[3],g=e[4],m=e[5],y=e[6],v=e[7],x=e[8];return Math.abs(n-u)<=or*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(r-d)<=or*Math.max(1,Math.abs(r),Math.abs(d))&&Math.abs(i-h)<=or*Math.max(1,Math.abs(i),Math.abs(h))&&Math.abs(a-p)<=or*Math.max(1,Math.abs(a),Math.abs(p))&&Math.abs(o-g)<=or*Math.max(1,Math.abs(o),Math.abs(g))&&Math.abs(s-m)<=or*Math.max(1,Math.abs(s),Math.abs(m))&&Math.abs(l-y)<=or*Math.max(1,Math.abs(l),Math.abs(y))&&Math.abs(c-v)<=or*Math.max(1,Math.abs(c),Math.abs(v))&&Math.abs(f-x)<=or*Math.max(1,Math.abs(f),Math.abs(x))}var Ywe=hm,Jwe=EX;const Zwe=Object.freeze(Object.defineProperty({__proto__:null,add:Wwe,adjoint:Rwe,clone:Owe,copy:Mwe,create:c7,determinant:Pwe,equals:Xwe,exactEquals:qwe,frob:zwe,fromMat2d:Uwe,fromMat4:BC,fromQuat:Bwe,fromRotation:Vwe,fromScaling:Fwe,fromTranslation:kwe,fromValues:Iwe,identity:Bl,invert:Ay,mul:Ywe,multiply:hm,multiplyScalar:Hwe,multiplyScalarAndAdd:Kwe,normalFromMat4:$we,projection:Gwe,rotate:Nwe,scale:Lwe,set:TX,str:jwe,sub:Jwe,subtract:EX,translate:Awe,transpose:u7},Symbol.toStringTag,{value:"Module"}));function f7(){var t=new Qa(16);return Qa!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function Qwe(t){var e=new Qa(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Ri(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function e3e(t,e,n,r,i,a,o,s,l,c,f,u,d,h,p,g){var m=new Qa(16);return m[0]=t,m[1]=e,m[2]=n,m[3]=r,m[4]=i,m[5]=a,m[6]=o,m[7]=s,m[8]=l,m[9]=c,m[10]=f,m[11]=u,m[12]=d,m[13]=h,m[14]=p,m[15]=g,m}function t3e(t,e,n,r,i,a,o,s,l,c,f,u,d,h,p,g,m){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=a,t[5]=o,t[6]=s,t[7]=l,t[8]=c,t[9]=f,t[10]=u,t[11]=d,t[12]=h,t[13]=p,t[14]=g,t[15]=m,t}function on(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function jn(t,e){if(t===e){var n=e[1],r=e[2],i=e[3],a=e[6],o=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=a,t[11]=e[14],t[12]=i,t[13]=o,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function Ea(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],s=e[5],l=e[6],c=e[7],f=e[8],u=e[9],d=e[10],h=e[11],p=e[12],g=e[13],m=e[14],y=e[15],v=n*s-r*o,x=n*l-i*o,w=n*c-a*o,S=r*l-i*s,T=r*c-a*s,_=i*c-a*l,D=f*g-u*p,I=f*m-d*p,R=f*y-h*p,O=u*m-d*g,P=u*y-h*g,N=d*y-h*m,A=v*N-x*P+w*O+S*R-T*I+_*D;return A?(A=1/A,t[0]=(s*N-l*P+c*O)*A,t[1]=(i*P-r*N-a*O)*A,t[2]=(g*_-m*T+y*S)*A,t[3]=(d*T-u*_-h*S)*A,t[4]=(l*R-o*N-c*I)*A,t[5]=(n*N-i*R+a*I)*A,t[6]=(m*w-p*_-y*x)*A,t[7]=(f*_-d*w+h*x)*A,t[8]=(o*P-s*R+c*D)*A,t[9]=(r*R-n*P-a*D)*A,t[10]=(p*T-g*w+y*v)*A,t[11]=(u*w-f*T-h*v)*A,t[12]=(s*I-o*O-l*D)*A,t[13]=(n*O-r*I+i*D)*A,t[14]=(g*x-p*S-m*v)*A,t[15]=(f*S-u*x+d*v)*A,t):null}function n3e(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],s=e[5],l=e[6],c=e[7],f=e[8],u=e[9],d=e[10],h=e[11],p=e[12],g=e[13],m=e[14],y=e[15];return t[0]=s*(d*y-h*m)-u*(l*y-c*m)+g*(l*h-c*d),t[1]=-(r*(d*y-h*m)-u*(i*y-a*m)+g*(i*h-a*d)),t[2]=r*(l*y-c*m)-s*(i*y-a*m)+g*(i*c-a*l),t[3]=-(r*(l*h-c*d)-s*(i*h-a*d)+u*(i*c-a*l)),t[4]=-(o*(d*y-h*m)-f*(l*y-c*m)+p*(l*h-c*d)),t[5]=n*(d*y-h*m)-f*(i*y-a*m)+p*(i*h-a*d),t[6]=-(n*(l*y-c*m)-o*(i*y-a*m)+p*(i*c-a*l)),t[7]=n*(l*h-c*d)-o*(i*h-a*d)+f*(i*c-a*l),t[8]=o*(u*y-h*g)-f*(s*y-c*g)+p*(s*h-c*u),t[9]=-(n*(u*y-h*g)-f*(r*y-a*g)+p*(r*h-a*u)),t[10]=n*(s*y-c*g)-o*(r*y-a*g)+p*(r*c-a*s),t[11]=-(n*(s*h-c*u)-o*(r*h-a*u)+f*(r*c-a*s)),t[12]=-(o*(u*m-d*g)-f*(s*m-l*g)+p*(s*d-l*u)),t[13]=n*(u*m-d*g)-f*(r*m-i*g)+p*(r*d-i*u),t[14]=-(n*(s*m-l*g)-o*(r*m-i*g)+p*(r*l-i*s)),t[15]=n*(s*d-l*u)-o*(r*d-i*u)+f*(r*l-i*s),t}function r3e(t){var e=t[0],n=t[1],r=t[2],i=t[3],a=t[4],o=t[5],s=t[6],l=t[7],c=t[8],f=t[9],u=t[10],d=t[11],h=t[12],p=t[13],g=t[14],m=t[15],y=e*o-n*a,v=e*s-r*a,x=e*l-i*a,w=n*s-r*o,S=n*l-i*o,T=r*l-i*s,_=c*p-f*h,D=c*g-u*h,I=c*m-d*h,R=f*g-u*p,O=f*m-d*p,P=u*m-d*g;return y*P-v*O+x*R+w*I-S*D+T*_}function zn(t,e,n){var r=e[0],i=e[1],a=e[2],o=e[3],s=e[4],l=e[5],c=e[6],f=e[7],u=e[8],d=e[9],h=e[10],p=e[11],g=e[12],m=e[13],y=e[14],v=e[15],x=n[0],w=n[1],S=n[2],T=n[3];return t[0]=x*r+w*s+S*u+T*g,t[1]=x*i+w*l+S*d+T*m,t[2]=x*a+w*c+S*h+T*y,t[3]=x*o+w*f+S*p+T*v,x=n[4],w=n[5],S=n[6],T=n[7],t[4]=x*r+w*s+S*u+T*g,t[5]=x*i+w*l+S*d+T*m,t[6]=x*a+w*c+S*h+T*y,t[7]=x*o+w*f+S*p+T*v,x=n[8],w=n[9],S=n[10],T=n[11],t[8]=x*r+w*s+S*u+T*g,t[9]=x*i+w*l+S*d+T*m,t[10]=x*a+w*c+S*h+T*y,t[11]=x*o+w*f+S*p+T*v,x=n[12],w=n[13],S=n[14],T=n[15],t[12]=x*r+w*s+S*u+T*g,t[13]=x*i+w*l+S*d+T*m,t[14]=x*a+w*c+S*h+T*y,t[15]=x*o+w*f+S*p+T*v,t}function di(t,e,n){var r=n[0],i=n[1],a=n[2],o,s,l,c,f,u,d,h,p,g,m,y;return e===t?(t[12]=e[0]*r+e[4]*i+e[8]*a+e[12],t[13]=e[1]*r+e[5]*i+e[9]*a+e[13],t[14]=e[2]*r+e[6]*i+e[10]*a+e[14],t[15]=e[3]*r+e[7]*i+e[11]*a+e[15]):(o=e[0],s=e[1],l=e[2],c=e[3],f=e[4],u=e[5],d=e[6],h=e[7],p=e[8],g=e[9],m=e[10],y=e[11],t[0]=o,t[1]=s,t[2]=l,t[3]=c,t[4]=f,t[5]=u,t[6]=d,t[7]=h,t[8]=p,t[9]=g,t[10]=m,t[11]=y,t[12]=o*r+f*i+p*a+e[12],t[13]=s*r+u*i+g*a+e[13],t[14]=l*r+d*i+m*a+e[14],t[15]=c*r+h*i+y*a+e[15]),t}function i0(t,e,n){var r=n[0],i=n[1],a=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*a,t[9]=e[9]*a,t[10]=e[10]*a,t[11]=e[11]*a,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function lc(t,e,n,r){var i=r[0],a=r[1],o=r[2],s=Math.hypot(i,a,o),l,c,f,u,d,h,p,g,m,y,v,x,w,S,T,_,D,I,R,O,P,N,A,B;return s<or?null:(s=1/s,i*=s,a*=s,o*=s,l=Math.sin(n),c=Math.cos(n),f=1-c,u=e[0],d=e[1],h=e[2],p=e[3],g=e[4],m=e[5],y=e[6],v=e[7],x=e[8],w=e[9],S=e[10],T=e[11],_=i*i*f+c,D=a*i*f+o*l,I=o*i*f-a*l,R=i*a*f-o*l,O=a*a*f+c,P=o*a*f+i*l,N=i*o*f+a*l,A=a*o*f-i*l,B=o*o*f+c,t[0]=u*_+g*D+x*I,t[1]=d*_+m*D+w*I,t[2]=h*_+y*D+S*I,t[3]=p*_+v*D+T*I,t[4]=u*R+g*O+x*P,t[5]=d*R+m*O+w*P,t[6]=h*R+y*O+S*P,t[7]=p*R+v*O+T*P,t[8]=u*N+g*A+x*B,t[9]=d*N+m*A+w*B,t[10]=h*N+y*A+S*B,t[11]=p*N+v*A+T*B,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function d7(t,e,n){var r=Math.sin(n),i=Math.cos(n),a=e[4],o=e[5],s=e[6],l=e[7],c=e[8],f=e[9],u=e[10],d=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=a*i+c*r,t[5]=o*i+f*r,t[6]=s*i+u*r,t[7]=l*i+d*r,t[8]=c*i-a*r,t[9]=f*i-o*r,t[10]=u*i-s*r,t[11]=d*i-l*r,t}function h7(t,e,n){var r=Math.sin(n),i=Math.cos(n),a=e[0],o=e[1],s=e[2],l=e[3],c=e[8],f=e[9],u=e[10],d=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*i-c*r,t[1]=o*i-f*r,t[2]=s*i-u*r,t[3]=l*i-d*r,t[8]=a*r+c*i,t[9]=o*r+f*i,t[10]=s*r+u*i,t[11]=l*r+d*i,t}function p7(t,e,n){var r=Math.sin(n),i=Math.cos(n),a=e[0],o=e[1],s=e[2],l=e[3],c=e[4],f=e[5],u=e[6],d=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*i+c*r,t[1]=o*i+f*r,t[2]=s*i+u*r,t[3]=l*i+d*r,t[4]=c*i-a*r,t[5]=f*i-o*r,t[6]=u*i-s*r,t[7]=d*i-l*r,t}function g7(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function m7(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function _X(t,e,n){var r=n[0],i=n[1],a=n[2],o=Math.hypot(r,i,a),s,l,c;return o<or?null:(o=1/o,r*=o,i*=o,a*=o,s=Math.sin(e),l=Math.cos(e),c=1-l,t[0]=r*r*c+l,t[1]=i*r*c+a*s,t[2]=a*r*c-i*s,t[3]=0,t[4]=r*i*c-a*s,t[5]=i*i*c+l,t[6]=a*i*c+r*s,t[7]=0,t[8]=r*a*c+i*s,t[9]=i*a*c-r*s,t[10]=a*a*c+l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function i3e(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function a3e(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function o3e(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function DX(t,e,n){var r=e[0],i=e[1],a=e[2],o=e[3],s=r+r,l=i+i,c=a+a,f=r*s,u=r*l,d=r*c,h=i*l,p=i*c,g=a*c,m=o*s,y=o*l,v=o*c;return t[0]=1-(h+g),t[1]=u+v,t[2]=d-y,t[3]=0,t[4]=u-v,t[5]=1-(f+g),t[6]=p+m,t[7]=0,t[8]=d+y,t[9]=p-m,t[10]=1-(f+h),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function s3e(t,e){var n=new Qa(3),r=-e[0],i=-e[1],a=-e[2],o=e[3],s=e[4],l=e[5],c=e[6],f=e[7],u=r*r+i*i+a*a+o*o;return u>0?(n[0]=(s*o+f*r+l*a-c*i)*2/u,n[1]=(l*o+f*i+c*r-s*a)*2/u,n[2]=(c*o+f*a+s*i-l*r)*2/u):(n[0]=(s*o+f*r+l*a-c*i)*2,n[1]=(l*o+f*i+c*r-s*a)*2,n[2]=(c*o+f*a+s*i-l*r)*2),DX(t,e,n),t}function l3e(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function OX(t,e){var n=e[0],r=e[1],i=e[2],a=e[4],o=e[5],s=e[6],l=e[8],c=e[9],f=e[10];return t[0]=Math.hypot(n,r,i),t[1]=Math.hypot(a,o,s),t[2]=Math.hypot(l,c,f),t}function I_(t,e){var n=new Qa(3);OX(n,e);var r=1/n[0],i=1/n[1],a=1/n[2],o=e[0]*r,s=e[1]*i,l=e[2]*a,c=e[4]*r,f=e[5]*i,u=e[6]*a,d=e[8]*r,h=e[9]*i,p=e[10]*a,g=o+f+p,m=0;return g>0?(m=Math.sqrt(g+1)*2,t[3]=.25*m,t[0]=(u-h)/m,t[1]=(d-l)/m,t[2]=(s-c)/m):o>f&&o>p?(m=Math.sqrt(1+o-f-p)*2,t[3]=(u-h)/m,t[0]=.25*m,t[1]=(s+c)/m,t[2]=(d+l)/m):f>p?(m=Math.sqrt(1+f-o-p)*2,t[3]=(d-l)/m,t[0]=(s+c)/m,t[1]=.25*m,t[2]=(u+h)/m):(m=Math.sqrt(1+p-o-f)*2,t[3]=(s-c)/m,t[0]=(d+l)/m,t[1]=(u+h)/m,t[2]=.25*m),t}function MX(t,e,n,r){var i=e[0],a=e[1],o=e[2],s=e[3],l=i+i,c=a+a,f=o+o,u=i*l,d=i*c,h=i*f,p=a*c,g=a*f,m=o*f,y=s*l,v=s*c,x=s*f,w=r[0],S=r[1],T=r[2];return t[0]=(1-(p+m))*w,t[1]=(d+x)*w,t[2]=(h-v)*w,t[3]=0,t[4]=(d-x)*S,t[5]=(1-(u+m))*S,t[6]=(g+y)*S,t[7]=0,t[8]=(h+v)*T,t[9]=(g-y)*T,t[10]=(1-(u+p))*T,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function c3e(t,e,n,r,i){var a=e[0],o=e[1],s=e[2],l=e[3],c=a+a,f=o+o,u=s+s,d=a*c,h=a*f,p=a*u,g=o*f,m=o*u,y=s*u,v=l*c,x=l*f,w=l*u,S=r[0],T=r[1],_=r[2],D=i[0],I=i[1],R=i[2],O=(1-(g+y))*S,P=(h+w)*S,N=(p-x)*S,A=(h-w)*T,B=(1-(d+y))*T,V=(m+v)*T,$=(p+x)*_,U=(m-v)*_,G=(1-(d+g))*_;return t[0]=O,t[1]=P,t[2]=N,t[3]=0,t[4]=A,t[5]=B,t[6]=V,t[7]=0,t[8]=$,t[9]=U,t[10]=G,t[11]=0,t[12]=n[0]+D-(O*D+A*I+$*R),t[13]=n[1]+I-(P*D+B*I+U*R),t[14]=n[2]+R-(N*D+V*I+G*R),t[15]=1,t}function r3(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],o=n+n,s=r+r,l=i+i,c=n*o,f=r*o,u=r*s,d=i*o,h=i*s,p=i*l,g=a*o,m=a*s,y=a*l;return t[0]=1-u-p,t[1]=f+y,t[2]=d-m,t[3]=0,t[4]=f-y,t[5]=1-c-p,t[6]=h+g,t[7]=0,t[8]=d+m,t[9]=h-g,t[10]=1-c-u,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function u3e(t,e,n,r,i,a,o){var s=1/(n-e),l=1/(i-r),c=1/(a-o);return t[0]=a*2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a*2*l,t[6]=0,t[7]=0,t[8]=(n+e)*s,t[9]=(i+r)*l,t[10]=(o+a)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*a*2*c,t[15]=0,t}function IX(t,e,n,r,i){var a=1/Math.tan(e/2),o;return t[0]=a/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,i!=null&&i!==1/0?(o=1/(r-i),t[10]=(i+r)*o,t[14]=2*i*r*o):(t[10]=-1,t[14]=-2*r),t}var f3e=IX;function d3e(t,e,n,r,i){var a=1/Math.tan(e/2),o;return t[0]=a/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,i!=null&&i!==1/0?(o=1/(r-i),t[10]=i*o,t[14]=i*r*o):(t[10]=-1,t[14]=-r),t}function h3e(t,e,n,r){var i=Math.tan(e.upDegrees*Math.PI/180),a=Math.tan(e.downDegrees*Math.PI/180),o=Math.tan(e.leftDegrees*Math.PI/180),s=Math.tan(e.rightDegrees*Math.PI/180),l=2/(o+s),c=2/(i+a);return t[0]=l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=-((o-s)*l*.5),t[9]=(i-a)*c*.5,t[10]=r/(n-r),t[11]=-1,t[12]=0,t[13]=0,t[14]=r*n/(n-r),t[15]=0,t}function RX(t,e,n,r,i,a,o){var s=1/(e-n),l=1/(r-i),c=1/(a-o);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+n)*s,t[13]=(i+r)*l,t[14]=(o+a)*c,t[15]=1,t}var PX=RX;function p3e(t,e,n,r,i,a,o){var s=1/(e-n),l=1/(r-i),c=1/(a-o);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=c,t[11]=0,t[12]=(e+n)*s,t[13]=(i+r)*l,t[14]=a*c,t[15]=1,t}function AX(t,e,n,r){var i,a,o,s,l,c,f,u,d,h,p=e[0],g=e[1],m=e[2],y=r[0],v=r[1],x=r[2],w=n[0],S=n[1],T=n[2];return Math.abs(p-w)<or&&Math.abs(g-S)<or&&Math.abs(m-T)<or?on(t):(f=p-w,u=g-S,d=m-T,h=1/Math.hypot(f,u,d),f*=h,u*=h,d*=h,i=v*d-x*u,a=x*f-y*d,o=y*u-v*f,h=Math.hypot(i,a,o),h?(h=1/h,i*=h,a*=h,o*=h):(i=0,a=0,o=0),s=u*o-d*a,l=d*i-f*o,c=f*a-u*i,h=Math.hypot(s,l,c),h?(h=1/h,s*=h,l*=h,c*=h):(s=0,l=0,c=0),t[0]=i,t[1]=s,t[2]=f,t[3]=0,t[4]=a,t[5]=l,t[6]=u,t[7]=0,t[8]=o,t[9]=c,t[10]=d,t[11]=0,t[12]=-(i*p+a*g+o*m),t[13]=-(s*p+l*g+c*m),t[14]=-(f*p+u*g+d*m),t[15]=1,t)}function g3e(t,e,n,r){var i=e[0],a=e[1],o=e[2],s=r[0],l=r[1],c=r[2],f=i-n[0],u=a-n[1],d=o-n[2],h=f*f+u*u+d*d;h>0&&(h=1/Math.sqrt(h),f*=h,u*=h,d*=h);var p=l*d-c*u,g=c*f-s*d,m=s*u-l*f;return h=p*p+g*g+m*m,h>0&&(h=1/Math.sqrt(h),p*=h,g*=h,m*=h),t[0]=p,t[1]=g,t[2]=m,t[3]=0,t[4]=u*m-d*g,t[5]=d*p-f*m,t[6]=f*g-u*p,t[7]=0,t[8]=f,t[9]=u,t[10]=d,t[11]=0,t[12]=i,t[13]=a,t[14]=o,t[15]=1,t}function m3e(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function v3e(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}function y3e(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t}function NX(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t}function x3e(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t}function b3e(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t[9]=e[9]+n[9]*r,t[10]=e[10]+n[10]*r,t[11]=e[11]+n[11]*r,t[12]=e[12]+n[12]*r,t[13]=e[13]+n[13]*r,t[14]=e[14]+n[14]*r,t[15]=e[15]+n[15]*r,t}function w3e(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function C3e(t,e){var n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],s=t[5],l=t[6],c=t[7],f=t[8],u=t[9],d=t[10],h=t[11],p=t[12],g=t[13],m=t[14],y=t[15],v=e[0],x=e[1],w=e[2],S=e[3],T=e[4],_=e[5],D=e[6],I=e[7],R=e[8],O=e[9],P=e[10],N=e[11],A=e[12],B=e[13],V=e[14],$=e[15];return Math.abs(n-v)<=or*Math.max(1,Math.abs(n),Math.abs(v))&&Math.abs(r-x)<=or*Math.max(1,Math.abs(r),Math.abs(x))&&Math.abs(i-w)<=or*Math.max(1,Math.abs(i),Math.abs(w))&&Math.abs(a-S)<=or*Math.max(1,Math.abs(a),Math.abs(S))&&Math.abs(o-T)<=or*Math.max(1,Math.abs(o),Math.abs(T))&&Math.abs(s-_)<=or*Math.max(1,Math.abs(s),Math.abs(_))&&Math.abs(l-D)<=or*Math.max(1,Math.abs(l),Math.abs(D))&&Math.abs(c-I)<=or*Math.max(1,Math.abs(c),Math.abs(I))&&Math.abs(f-R)<=or*Math.max(1,Math.abs(f),Math.abs(R))&&Math.abs(u-O)<=or*Math.max(1,Math.abs(u),Math.abs(O))&&Math.abs(d-P)<=or*Math.max(1,Math.abs(d),Math.abs(P))&&Math.abs(h-N)<=or*Math.max(1,Math.abs(h),Math.abs(N))&&Math.abs(p-A)<=or*Math.max(1,Math.abs(p),Math.abs(A))&&Math.abs(g-B)<=or*Math.max(1,Math.abs(g),Math.abs(B))&&Math.abs(m-V)<=or*Math.max(1,Math.abs(m),Math.abs(V))&&Math.abs(y-$)<=or*Math.max(1,Math.abs(y),Math.abs($))}var i3=zn,S3e=NX;const H2=Object.freeze(Object.defineProperty({__proto__:null,add:y3e,adjoint:n3e,clone:Qwe,copy:Ri,create:f7,determinant:r3e,equals:C3e,exactEquals:w3e,frob:v3e,fromQuat:r3,fromQuat2:s3e,fromRotation:_X,fromRotationTranslation:DX,fromRotationTranslationScale:MX,fromRotationTranslationScaleOrigin:c3e,fromScaling:m7,fromTranslation:g7,fromValues:e3e,fromXRotation:i3e,fromYRotation:a3e,fromZRotation:o3e,frustum:u3e,getRotation:I_,getScaling:OX,getTranslation:l3e,identity:on,invert:Ea,lookAt:AX,mul:i3,multiply:zn,multiplyScalar:x3e,multiplyScalarAndAdd:b3e,ortho:PX,orthoNO:RX,orthoZO:p3e,perspective:f3e,perspectiveFromFieldOfView:h3e,perspectiveNO:IX,perspectiveZO:d3e,rotate:lc,rotateX:d7,rotateY:h7,rotateZ:p7,scale:i0,set:t3e,str:m3e,sub:S3e,subtract:NX,targetTo:g3e,translate:di,transpose:jn},Symbol.toStringTag,{value:"Module"}));function LX(){var t=new Qa(3);return Qa!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function Wg(t){var e=t[0],n=t[1],r=t[2];return Math.hypot(e,n,r)}function nV(t,e,n){var r=new Qa(3);return r[0]=t,r[1]=e,r[2]=n,r}function Br(t,e,n,r){return t[0]=e,t[1]=n,t[2]=r,t}function Mv(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function Bd(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function T3e(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function E3e(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t}function ff(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function kX(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function wc(t,e){var n=e[0],r=e[1],i=e[2],a=n*n+r*r+i*i;return a>0&&(a=1/Math.sqrt(a)),t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a,t}function K2(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Hg(t,e,n){var r=e[0],i=e[1],a=e[2],o=n[0],s=n[1],l=n[2];return t[0]=i*l-a*s,t[1]=a*o-r*l,t[2]=r*s-i*o,t}function Gn(t,e,n){var r=e[0],i=e[1],a=e[2],o=n[3]*r+n[7]*i+n[11]*a+n[15];return o=o||1,t[0]=(n[0]*r+n[4]*i+n[8]*a+n[12])/o,t[1]=(n[1]*r+n[5]*i+n[9]*a+n[13])/o,t[2]=(n[2]*r+n[6]*i+n[10]*a+n[14])/o,t}function Jb(t,e,n){var r=e[0],i=e[1],a=e[2];return t[0]=r*n[0]+i*n[3]+a*n[6],t[1]=r*n[1]+i*n[4]+a*n[7],t[2]=r*n[2]+i*n[5]+a*n[8],t}function _3e(t){return t[0]=0,t[1]=0,t[2]=0,t}function rV(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function iV(t,e){var n=t[0],r=t[1],i=t[2],a=e[0],o=e[1],s=e[2];return Math.abs(n-a)<=or*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(r-o)<=or*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(i-s)<=or*Math.max(1,Math.abs(i),Math.abs(s))}var R_=Bd,D3e=T3e,VX=Wg;(function(){var t=LX();return function(e,n,r,i,a,o){var s,l;for(n||(n=3),r||(r=0),i?l=Math.min(i*n+r,e.length):l=e.length,s=r;s<l;s+=n)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],a(t,t,o),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2];return e}})();function O3e(){var t=new Qa(4);return Qa!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function M3e(t,e,n,r){var i=new Qa(4);return i[0]=t,i[1]=e,i[2]=n,i[3]=r,i}function aV(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t}function I3e(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],o=n*n+r*r+i*i+a*a;return o>0&&(o=1/Math.sqrt(o)),t[0]=n*o,t[1]=r*o,t[2]=i*o,t[3]=a*o,t}function hh(t,e,n){var r=e[0],i=e[1],a=e[2],o=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*a+n[12]*o,t[1]=n[1]*r+n[5]*i+n[9]*a+n[13]*o,t[2]=n[2]*r+n[6]*i+n[10]*a+n[14]*o,t[3]=n[3]*r+n[7]*i+n[11]*a+n[15]*o,t}(function(){var t=O3e();return function(e,n,r,i,a,o){var s,l;for(n||(n=4),r||(r=0),i?l=Math.min(i*n+r,e.length):l=e.length,s=r;s<l;s+=n)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],t[3]=e[s+3],a(t,t,o),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2],e[s+3]=t[3];return e}})();function Fh(){var t=new Qa(4);return Qa!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function v7(t,e,n){n=n*.5;var r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t}function R3e(t,e){var n=Math.acos(e[3])*2,r=Math.sin(n/2);return r>or?(t[0]=e[0]/r,t[1]=e[1]/r,t[2]=e[2]/r):(t[0]=1,t[1]=0,t[2]=0),n}function oV(t,e,n){var r=e[0],i=e[1],a=e[2],o=e[3],s=n[0],l=n[1],c=n[2],f=n[3];return t[0]=r*f+o*s+i*c-a*l,t[1]=i*f+o*l+a*s-r*c,t[2]=a*f+o*c+r*l-i*s,t[3]=o*f-r*s-i*l-a*c,t}function Zb(t,e,n,r){var i=e[0],a=e[1],o=e[2],s=e[3],l=n[0],c=n[1],f=n[2],u=n[3],d,h,p,g,m;return h=i*l+a*c+o*f+s*u,h<0&&(h=-h,l=-l,c=-c,f=-f,u=-u),1-h>or?(d=Math.acos(h),p=Math.sin(d),g=Math.sin((1-r)*d)/p,m=Math.sin(r*d)/p):(g=1-r,m=r),t[0]=g*i+m*l,t[1]=g*a+m*c,t[2]=g*o+m*f,t[3]=g*s+m*u,t}function P3e(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function A3e(t,e){var n=e[0]+e[4]+e[8],r;if(n>0)r=Math.sqrt(n+1),t[3]=.5*r,r=.5/r,t[0]=(e[5]-e[7])*r,t[1]=(e[6]-e[2])*r,t[2]=(e[1]-e[3])*r;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[i*3+i]&&(i=2);var a=(i+1)%3,o=(i+2)%3;r=Math.sqrt(e[i*3+i]-e[a*3+a]-e[o*3+o]+1),t[i]=.5*r,r=.5/r,t[3]=(e[a*3+o]-e[o*3+a])*r,t[a]=(e[a*3+i]+e[i*3+a])*r,t[o]=(e[o*3+i]+e[i*3+o])*r}return t}var sV=M3e,FX=I3e;(function(){var t=LX(),e=nV(1,0,0),n=nV(0,1,0);return function(r,i,a){var o=K2(i,a);return o<-.999999?(Hg(t,e,i),VX(t)<1e-6&&Hg(t,n,i),wc(t,t),v7(r,t,Math.PI),r):o>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(Hg(t,i,a),r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=1+o,FX(r,r))}})();(function(){var t=Fh(),e=Fh();return function(n,r,i,a,o,s){return Zb(t,r,o,s),Zb(e,i,a,s),Zb(n,t,e,2*s*(1-s)),n}})();(function(){var t=c7();return function(e,n,r,i){return t[0]=r[0],t[3]=r[1],t[6]=r[2],t[1]=i[0],t[4]=i[1],t[7]=i[2],t[2]=-n[0],t[5]=-n[1],t[8]=-n[2],FX(e,A3e(e,t))}})();function N3e(t,e){e.classHierarchy.push("vtkImplicitFunction"),t.functionValue=n=>{if(!e.transform)return t.evaluateFunction(n);const r=[];return e.transform.transformPoint(n,r),t.evaluateFunction(r)},t.evaluateFunction=n=>{ce.vtkErrorMacro("not implemented")}}const L3e={};function UX(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,L3e,n),ce.obj(t,e),ce.setGet(t,e,["transform"]),N3e(t,e)}const k3e=ce.newInstance(UX,"vtkImplicitFunction");var V3e={newInstance:k3e,extend:UX};const P_=1e-6,BX="coincide",$X="disjoint";function F3e(t,e,n){return t[0]*(n[0]-e[0])+t[1]*(n[1]-e[1])+t[2]*(n[2]-e[2])}function GX(t,e,n){const r=n[0]*(t[0]-e[0])+n[1]*(t[1]-e[1])+n[2]*(t[2]-e[2]);return Math.abs(r)}function jX(t,e,n,r){const i=[];Df(t,e,i);const a=An(n,i);r[0]=t[0]-a*n[0],r[1]=t[1]-a*n[1],r[2]=t[2]-a*n[2]}function zX(t,e,n){const r=An(t,e);let i=An(e,e);return i===0&&(i=1),n[0]=t[0]-r*e[0]/i,n[1]=t[1]-r*e[1]/i,n[2]=t[2]-r*e[2]/i,n}function WX(t,e,n,r){const i=[];Df(t,e,i);const a=An(n,i),o=An(n,n);o!==0?(r[0]=t[0]-a*n[0]/o,r[1]=t[1]-a*n[1]/o,r[2]=t[2]-a*n[2]/o):(r[0]=t[0],r[1]=t[1],r[2]=t[2])}function HX(t,e,n,r){const i={intersection:!1,betweenPoints:!1,t:Number.MAX_VALUE,x:[]},a=[],o=[];Df(e,t,a),Df(n,t,o);const s=An(r,o),l=An(r,a);let c,f;return l<0?c=-l:c=l,s<0?f=-s*P_:f=s*P_,c<=f||(i.t=s/l,i.x[0]=t[0]+i.t*a[0],i.x[1]=t[1]+i.t*a[1],i.x[2]=t[2]+i.t*a[2],i.intersection=!0,i.betweenPoints=i.t>=0&&i.t<=1),i}function KX(t,e,n,r){const i={intersection:!1,l0:[],l1:[],error:null},a=[];yu(e,r,a);const o=a.map(u=>Math.abs(u));if(o[0]+o[1]+o[2]<P_){const u=[];return Df(t,n,u),An(e,u)===0?i.error=BX:i.error=$X,i}let s;o[0]>o[1]&&o[0]>o[2]?s="x":o[1]>o[2]?s="y":s="z";const l=[],c=-An(e,t),f=-An(r,n);switch(s){case"x":l[0]=0,l[1]=(f*e[2]-c*r[2])/a[0],l[2]=(c*r[1]-f*e[1])/a[0];break;case"y":l[0]=(c*r[2]-f*e[2])/a[1],l[1]=0,l[2]=(f*e[0]-c*r[0])/a[1];break;case"z":l[0]=(f*e[1]-c*r[1])/a[2],l[1]=(c*r[0]-f*e[0])/a[2],l[2]=0;break}return i.l0=l,Jw(l,a,i.l1),i.intersection=!0,i}const U3e={evaluate:F3e,distanceToPlane:GX,projectPoint:jX,projectVector:zX,generalizedProjectPoint:WX,intersectWithLine:HX,intersectWithPlane:KX,DISJOINT:$X,COINCIDE:BX};function B3e(t,e){e.classHierarchy.push("vtkPlane"),t.distanceToPlane=n=>GX(n,e.origin,e.normal),t.projectPoint=(n,r)=>{jX(n,e.origin,e.normal,r)},t.projectVector=(n,r)=>zX(n,e.normal,r),t.push=n=>{if(n!==0)for(let r=0;r<3;r++)e.origin[r]+=n*e.normal[r]},t.generalizedProjectPoint=(n,r)=>{WX(n,e.origin,e.normal,r)},t.evaluateFunction=(n,r,i)=>Array.isArray(n)?e.normal[0]*(n[0]-e.origin[0])+e.normal[1]*(n[1]-e.origin[1])+e.normal[2]*(n[2]-e.origin[2]):e.normal[0]*(n-e.origin[0])+e.normal[1]*(r-e.origin[1])+e.normal[2]*(i-e.origin[2]),t.evaluateGradient=n=>[e.normal[0],e.normal[1],e.normal[2]],t.intersectWithLine=(n,r)=>HX(n,r,e.origin,e.normal),t.intersectWithPlane=(n,r)=>KX(n,r,e.origin,e.normal)}const $3e={normal:[0,0,1],origin:[0,0,0]};function qX(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,$3e,n),V3e.extend(t,e,n),ce.setGetArray(t,e,["normal","origin"],3),B3e(t,e)}const G3e=ce.newInstance(qX,"vtkPlane");var Ao={newInstance:G3e,extend:qX,...U3e};const $C=[Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE];function XX(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]}function Bf(t){return t?.length>=6&&t[0]<=t[1]&&t[2]<=t[3]&&t[4]<=t[5]}function y7(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function x7(t){return y7(t,$C)}function a3(t,e,n,r){const[i,a,o,s,l,c]=t;return t[0]=i<e?i:e,t[1]=a>e?a:e,t[2]=o<n?o:n,t[3]=s>n?s:n,t[4]=l<r?l:r,t[5]=c>r?c:r,t}function b7(t,e){if(e.length===0)return t;if(Array.isArray(e[0]))for(let n=0;n<e.length;++n)a3(t,...e[n]);else for(let n=0;n<e.length;n+=3)a3(t,...e.slice(n,n+3));return t}function YX(t,e,n,r,i,a,o){const[s,l,c,f,u,d]=t;return o===void 0?(t[0]=Math.min(e[0],s),t[1]=Math.max(e[1],l),t[2]=Math.min(e[2],c),t[3]=Math.max(e[3],f),t[4]=Math.min(e[4],u),t[5]=Math.max(e[5],d)):(t[0]=Math.min(e,s),t[1]=Math.max(n,l),t[2]=Math.min(r,c),t[3]=Math.max(i,f),t[4]=Math.min(a,u),t[5]=Math.max(o,d)),t}function JX(t,e,n,r){const[i,a,o,s,l,c]=t;return t[0]=e,t[1]=e>a?e:a,t[2]=n,t[3]=n>s?n:s,t[4]=r,t[5]=r>c?r:c,i!==e||o!==n||l!==r}function ZX(t,e,n,r){const[i,a,o,s,l,c]=t;return t[0]=e<i?e:i,t[1]=e,t[2]=n<o?n:o,t[3]=n,t[4]=r<l?r:l,t[5]=r,a!==e||s!==n||c!==r}function QX(t,e){return t[0]-=e,t[1]+=e,t[2]-=e,t[3]+=e,t[4]-=e,t[5]+=e,t}function w7(t,e,n,r){return Bf(t)?(e>=0?(t[0]*=e,t[1]*=e):(t[0]=e*t[1],t[1]=e*t[0]),n>=0?(t[2]*=n,t[3]*=n):(t[2]=n*t[3],t[3]=n*t[2]),r>=0?(t[4]*=r,t[5]*=r):(t[4]=r*t[5],t[5]=r*t[4]),!0):!1}function C7(t){return[.5*(t[0]+t[1]),.5*(t[2]+t[3]),.5*(t[4]+t[5])]}function j3e(t,e,n,r){if(!Bf(t))return!1;const i=C7(t);return t[0]-=i[0],t[1]-=i[0],t[2]-=i[1],t[3]-=i[1],t[4]-=i[2],t[5]-=i[2],w7(t,e,n,r),t[0]+=i[0],t[1]+=i[0],t[2]+=i[1],t[3]+=i[1],t[4]+=i[2],t[5]+=i[2],!0}function a2(t,e){return t[e*2+1]-t[e*2]}function GC(t){return[a2(t,0),a2(t,1),a2(t,2)]}function eY(t){return t.slice(0,2)}function tY(t){return t.slice(2,4)}function nY(t){return t.slice(4,6)}function rY(t){const e=GC(t);return e[0]>e[1]?e[0]>e[2]?e[0]:e[2]:e[1]>e[2]?e[1]:e[2]}function iY(t){if(Bf(t)){const e=GC(t);return Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2])}return null}function S7(t){return[t[0],t[2],t[4]]}function T7(t){return[t[1],t[3],t[5]]}function Vx(t,e){return t<=0&&e>=0||t>=0&&e<=0}function E7(t,e){let n=0;for(let r=0;r<2;r++)for(let i=2;i<4;i++)for(let a=4;a<6;a++)e[n++]=[t[r],t[i],t[a]];return e}function aY(t,e,n){return e[0]=t[0],e[1]=t[2],e[2]=t[4],n[0]=t[1],n[1]=t[3],n[2]=t[5],e}function oY(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const r=E7(t,[]);for(let i=0;i<r.length;++i)Gn(r[i],r[i],e);return x7(n),b7(n,r)}function sY(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return e[0]=.5*(t[1]-t[0]),e[1]=.5*(t[3]-t[2]),e[2]=.5*(t[5]-t[4]),e}function lY(t,e,n,r){const i=[].concat($C),a=t.getData();for(let o=0;o<a.length;o+=3){const s=[a[o],a[o+1],a[o+2]],l=An(s,e);i[0]=Math.min(l,i[0]),i[1]=Math.max(l,i[1]);const c=An(s,n);i[2]=Math.min(c,i[2]),i[3]=Math.max(c,i[3]);const f=An(s,r);i[4]=Math.min(f,i[4]),i[5]=Math.max(f,i[5])}return i}function cY(t,e,n,r,i){let a=!0;const o=[];let s=0;const l=[],c=[0,0,0],f=0,u=1,d=2;for(let h=0;h<3;h++)e[h]<t[2*h]?(o[h]=u,c[h]=t[2*h],a=!1):e[h]>t[2*h+1]?(o[h]=f,c[h]=t[2*h+1],a=!1):o[h]=d;if(a)return r[0]=e[0],r[1]=e[1],r[2]=e[2],i[0]=0,1;for(let h=0;h<3;h++)o[h]!==d&&n[h]!==0?l[h]=(c[h]-e[h])/n[h]:l[h]=-1;for(let h=0;h<3;h++)l[s]<l[h]&&(s=h);if(l[s]>1||l[s]<0)return 0;i[0]=l[s];for(let h=0;h<3;h++)if(s!==h){if(r[h]=e[h]+l[s]*n[h],r[h]<t[2*h]||r[h]>t[2*h+1])return 0}else r[h]=c[h];return 1}function uY(t,e,n){const r=[];let i=0,a=1,o=1;for(let s=4;s<=5;++s){r[2]=t[s];for(let l=2;l<=3;++l){r[1]=t[l];for(let c=0;c<=1;++c)if(r[0]=t[c],i=Ao.evaluate(n,e,r),o&&(a=i>=0?1:-1,o=0),i===0||a>0&&i<0||a<0&&i>0)return 1}}return 0}function fY(t,e){if(!(Bf(t)&&Bf(e)))return!1;const n=[0,0,0,0,0,0];let r;for(let i=0;i<3;i++)if(r=!1,e[i*2]>=t[i*2]&&e[i*2]<=t[i*2+1]?(r=!0,n[i*2]=e[i*2]):t[i*2]>=e[i*2]&&t[i*2]<=e[i*2+1]&&(r=!0,n[i*2]=t[i*2]),e[i*2+1]>=t[i*2]&&e[i*2+1]<=t[i*2+1]?(r=!0,n[i*2+1]=e[2*i+1]):t[i*2+1]>=e[i*2]&&t[i*2+1]<=e[i*2+1]&&(r=!0,n[i*2+1]=t[i*2+1]),!r)return!1;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],!0}function o3(t,e){if(!(Bf(t)&&Bf(e)))return!1;for(let n=0;n<3;n++)if(!(e[n*2]>=t[n*2]&&e[n*2]<=t[n*2+1])&&!(t[n*2]>=e[n*2]&&t[n*2]<=e[n*2+1])&&!(e[n*2+1]>=t[n*2]&&e[n*2+1]<=t[n*2+1])&&!(t[n*2+1]>=e[n*2]&&t[n*2+1]<=e[n*2+1]))return!1;return!0}function s3(t,e,n,r){return!(e<t[0]||e>t[1]||n<t[2]||n>t[3]||r<t[4]||r>t[5])}function z3e(t,e){return!(!o3(t,e)||!s3(t,...S7(e))||!s3(t,...T7(e)))}function dY(t,e,n){const r=[[0,1,2,3,4,5,6,7],[0,1,4,5,2,3,6,7],[0,2,4,6,1,3,5,7]],i=[0,0,0,0,0,0,0,0];let a=0;for(let u=0;u<2;u++)for(let d=2;d<4;d++)for(let h=4;h<6;h++){const p=[t[u],t[d],t[h]];i[a++]=Ao.evaluate(n,e,p)}let o=2;for(;o--&&!(Vx(i[r[o][0]],i[r[o][4]])&&Vx(i[r[o][1]],i[r[o][5]])&&Vx(i[r[o][2]],i[r[o][6]])&&Vx(i[r[o][3]],i[r[o][7]])););if(o<0)return!1;const s=Math.sign(n[o]),l=Math.abs((t[o*2+1]-t[o*2])*n[o]);let c=s>0?1:0;for(let u=0;u<4;u++){if(l===0)continue;const d=Math.abs(i[r[o][u]])/l;s>0&&d<c&&(c=d),s<0&&d>c&&(c=d)}const f=(1-c)*t[o*2]+c*t[o*2+1];return s>0?t[o*2]=f:t[o*2+1]=f,!0}class W3e{constructor(e){this.bounds=e,this.bounds||(this.bounds=new Float64Array($C))}getBounds(){return this.bounds}equals(e){return XX(this.bounds,e)}isValid(){return Bf(this.bounds)}setBounds(e){return y7(this.bounds,e)}reset(){return x7(this.bounds)}addPoint(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return a3(this.bounds,...n)}addPoints(e){return b7(this.bounds,e)}addBounds(e,n,r,i,a,o){return YX(this.bounds,e,n,r,i,a,o)}setMinPoint(e,n,r){return JX(this.bounds,e,n,r)}setMaxPoint(e,n,r){return ZX(this.bounds,e,n,r)}inflate(e){return QX(this.bounds,e)}scale(e,n,r){return w7(this.bounds,e,n,r)}getCenter(){return C7(this.bounds)}getLength(e){return a2(this.bounds,e)}getLengths(){return GC(this.bounds)}getMaxLength(){return rY(this.bounds)}getDiagonalLength(){return iY(this.bounds)}getMinPoint(){return S7(this.bounds)}getMaxPoint(){return T7(this.bounds)}getXRange(){return eY(this.bounds)}getYRange(){return tY(this.bounds)}getZRange(){return nY(this.bounds)}getCorners(e){return E7(this.bounds,e)}computeCornerPoints(e,n){return aY(this.bounds,e,n)}computeLocalBounds(e,n,r){return lY(this.bounds,e,n,r)}transformBounds(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return oY(this.bounds,e,n)}computeScale3(e){return sY(this.bounds,e)}cutWithPlane(e,n){return dY(this.bounds,e,n)}intersectBox(e,n,r,i){return cY(this.bounds,e,n,r,i)}intersectPlane(e,n){return uY(this.bounds,e,n)}intersect(e){return fY(this.bounds,e)}intersects(e){return o3(this.bounds,e)}containsPoint(e,n,r){return s3(this.bounds,e,n,r)}contains(e){return o3(this.bounds,e)}}function H3e(t){const e=t&&t.bounds;return new W3e(e)}const K3e={equals:XX,isValid:Bf,setBounds:y7,reset:x7,addPoint:a3,addPoints:b7,addBounds:YX,setMinPoint:JX,setMaxPoint:ZX,inflate:QX,scale:w7,scaleAboutCenter:j3e,getCenter:C7,getLength:a2,getLengths:GC,getMaxLength:rY,getDiagonalLength:iY,getMinPoint:S7,getMaxPoint:T7,getXRange:eY,getYRange:tY,getZRange:nY,getCorners:E7,computeCornerPoints:aY,computeLocalBounds:lY,transformBounds:oY,computeScale3:sY,cutWithPlane:dY,intersectBox:cY,intersectPlane:uY,intersect:fY,intersects:o3,containsPoint:s3,contains:z3e,INIT_BOUNDS:$C};var Er={newInstance:H3e,...K3e};const q3e={DISPLAY:0,WORLD:1};var hY={CoordinateSystem:q3e};const{CoordinateSystem:A_}=hY;function lV(t){return()=>ce.vtkErrorMacro(`vtkProp::${t} - NOT IMPLEMENTED`)}function X3e(t,e){e.classHierarchy.push("vtkProp"),t.getMTime=()=>{let n=e.mtime;for(let r=0;r<e.textures.length;++r){const i=e.textures[r].getMTime();i>n&&(n=i)}return n},t.processSelectorPixelBuffers=(n,r)=>{},t.getNestedProps=()=>null,t.getActors=()=>[],t.getActors2D=()=>[],t.getVolumes=()=>[],t.pick=lV("pick"),t.hasKey=lV("hasKey"),t.getNestedVisibility=()=>e.visibility&&(!e._parentProp||e._parentProp.getNestedVisibility()),t.getNestedPickable=()=>e.pickable&&(!e._parentProp||e._parentProp.getNestedPickable()),t.getNestedDragable=()=>e.dragable&&(!e._parentProp||e._parentProp.getNestedDragable()),t.getRedrawMTime=()=>e.mtime,t.setEstimatedRenderTime=n=>{e.estimatedRenderTime=n,e.savedEstimatedRenderTime=n},t.restoreEstimatedRenderTime=()=>{e.estimatedRenderTime=e.savedEstimatedRenderTime},t.addEstimatedRenderTime=n=>{e.estimatedRenderTime+=n},t.setAllocatedRenderTime=n=>{e.allocatedRenderTime=n,e.savedEstimatedRenderTime=e.estimatedRenderTime,e.estimatedRenderTime=0},t.getSupportsSelection=()=>!1,t.getTextures=()=>e.textures,t.hasTexture=n=>e.textures.indexOf(n)!==-1,t.addTexture=n=>{n&&!t.hasTexture(n)&&(e.textures=e.textures.concat(n),t.modified())},t.removeTexture=n=>{const r=e.textures.filter(i=>i!==n);e.textures.length!==r.length&&(e.textures=r,t.modified())},t.removeAllTextures=()=>{e.textures=[],t.modified()},t.setCoordinateSystemToWorld=()=>t.setCoordinateSystem(A_.WORLD),t.setCoordinateSystemToDisplay=()=>t.setCoordinateSystem(A_.DISPLAY)}const Y3e={allocatedRenderTime:10,coordinateSystem:A_.WORLD,dragable:!0,estimatedRenderTime:0,paths:null,pickable:!0,renderTimeMultiplier:1,savedEstimatedRenderTime:0,textures:[],useBounds:!0,visibility:!0};function pY(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Y3e,n),ce.obj(t,e),ce.get(t,e,["estimatedRenderTime","allocatedRenderTime"]),ce.setGet(t,e,["_parentProp","coordinateSystem","dragable","pickable","renderTimeMultiplier","useBounds","visibility"]),ce.moveToProtected(t,e,["parentProp"]),X3e(t,e)}const J3e=ce.newInstance(pY,"vtkProp");var Ny={newInstance:J3e,extend:pY,...hY};const Z3e=1e-6;function Q3e(t,e){e.classHierarchy.push("vtkProp3D"),t.addPosition=r=>{e.position=e.position.map((i,a)=>i+r[a]),t.modified()},t.getOrientationWXYZ=()=>{const r=Fh();I_(r,e.rotation);const i=new Float64Array(3),a=R3e(i,r);return[Yw(a),i[0],i[1],i[2]]},t.getOrientationQuaternion=function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return I_(r,e.rotation)},t.rotateX=r=>{r!==0&&(d7(e.rotation,e.rotation,Di(r)),t.modified())},t.rotateY=r=>{r!==0&&(h7(e.rotation,e.rotation,Di(r)),t.modified())},t.rotateZ=r=>{r!==0&&(p7(e.rotation,e.rotation,Di(r)),t.modified())},t.rotateWXYZ=(r,i,a,o)=>{if(r===0||i===0&&a===0&&o===0)return;const s=Di(r),l=Fh();v7(l,[i,a,o],s);const c=new Float64Array(16);r3(c,l),zn(e.rotation,e.rotation,c),t.modified()},t.rotateQuaternion=r=>{if(Math.abs(r[3])>=1-Z3e)return;const i=r3(new Float64Array(16),r);zn(e.rotation,e.rotation,i),t.modified()},t.setOrientation=(r,i,a)=>r===e.orientation[0]&&i===e.orientation[1]&&a===e.orientation[2]?!1:(e.orientation=[r,i,a],on(e.rotation),t.rotateZ(a),t.rotateX(r),t.rotateY(i),t.modified(),!0),t.setUserMatrix=r=>Iy(e.userMatrix,r)?!1:(Ri(e.userMatrix,r),t.modified(),!0),t.getMatrix=()=>(t.computeMatrix(),e.matrix),t.computeMatrix=()=>{if(t.getMTime()>e.matrixMTime.getMTime()){on(e.matrix),e.userMatrix&&zn(e.matrix,e.matrix,e.userMatrix),di(e.matrix,e.matrix,e.origin),di(e.matrix,e.matrix,e.position),zn(e.matrix,e.matrix,e.rotation),i0(e.matrix,e.matrix,e.scale),di(e.matrix,e.matrix,[-e.origin[0],-e.origin[1],-e.origin[2]]),jn(e.matrix,e.matrix),e.isIdentity=!0;for(let r=0;r<4;++r)for(let i=0;i<4;++i)(r===i?1:0)!==e.matrix[r+i*4]&&(e.isIdentity=!1);e.matrixMTime.modified()}},t.getCenter=()=>Er.getCenter(e.bounds),t.getLength=()=>Er.getLength(e.bounds),t.getXRange=()=>Er.getXRange(e.bounds),t.getYRange=()=>Er.getYRange(e.bounds),t.getZRange=()=>Er.getZRange(e.bounds),t.getUserMatrix=()=>e.userMatrix;function n(){t.computeMatrix()}t.onModified(n)}const eCe={origin:[0,0,0],position:[0,0,0],orientation:[0,0,0],rotation:null,scale:[1,1,1],bounds:[1,-1,1,-1,1,-1],userMatrix:null,userMatrixMTime:null,cachedProp3D:null,isIdentity:!0,matrixMTime:null};function gY(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,eCe,n),Ny.extend(t,e,n),e.matrixMTime={},ce.obj(e.matrixMTime),ce.get(t,e,["bounds","isIdentity"]),ce.getArray(t,e,["orientation"]),ce.setGetArray(t,e,["origin","position","scale"],3),e.matrix=on(new Float64Array(16)),e.rotation=on(new Float64Array(16)),e.userMatrix=on(new Float64Array(16)),e.transform=null,Q3e(t,e)}const tCe=ce.newInstance(gY,"vtkProp3D");var _7={newInstance:tCe,extend:gY};const N_={NEAREST:0,LINEAR:1,FAST_LINEAR:2},mY={FRACTIONAL:0,PROPORTIONAL:1},Qb={CUSTOM:0,ADDITIVE:1,COLORIZE:2};var vY={InterpolationType:N_,OpacityMode:mY,ColorMixPreset:Qb};const{InterpolationType:Iv,OpacityMode:nCe}=vY,{vtkErrorMacro:UE}=ce,ew=4;function rCe(t,e){e.classHierarchy.push("vtkVolumeProperty"),t.getMTime=()=>{let i=e.mtime,a;for(let o=0;o<ew;o++)e.componentData[o].colorChannels===1?e.componentData[o].grayTransferFunction&&(a=e.componentData[o].grayTransferFunction.getMTime(),i=i>a?i:a):e.componentData[o].colorChannels===3&&e.componentData[o].rGBTransferFunction&&(a=e.componentData[o].rGBTransferFunction.getMTime(),i=i>a?i:a),e.componentData[o].scalarOpacity&&(a=e.componentData[o].scalarOpacity.getMTime(),i=i>a?i:a),e.componentData[o].gradientOpacity&&(e.componentData[o].disableGradientOpacity||(a=e.componentData[o].gradientOpacity.getMTime(),i=i>a?i:a));return i},t.getColorChannels=i=>i<0||i>3?(UE("Bad index - must be between 0 and 3"),0):e.componentData[i].colorChannels,t.setGrayTransferFunction=function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,o=!1;return e.componentData[i].grayTransferFunction!==a&&(e.componentData[i].grayTransferFunction=a,o=!0),e.componentData[i].colorChannels!==1&&(e.componentData[i].colorChannels=1,o=!0),o&&t.modified(),o},t.getGrayTransferFunction=function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return e.componentData[i].grayTransferFunction===null&&(e.componentData[i].grayTransferFunction=kh.newInstance(),e.componentData[i].grayTransferFunction.addPoint(0,0),e.componentData[i].grayTransferFunction.addPoint(1024,1),e.componentData[i].colorChannels!==1&&(e.componentData[i].colorChannels=1),t.modified()),e.componentData[i].grayTransferFunction},t.setRGBTransferFunction=function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,o=!1;return e.componentData[i].rGBTransferFunction!==a&&(e.componentData[i].rGBTransferFunction=a,o=!0),e.componentData[i].colorChannels!==3&&(e.componentData[i].colorChannels=3,o=!0),o&&t.modified(),o},t.getRGBTransferFunction=function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return e.componentData[i].rGBTransferFunction===null&&(e.componentData[i].rGBTransferFunction=Uf.newInstance(),e.componentData[i].rGBTransferFunction.addRGBPoint(0,0,0,0),e.componentData[i].rGBTransferFunction.addRGBPoint(1024,1,1,1),e.componentData[i].colorChannels!==3&&(e.componentData[i].colorChannels=3),t.modified()),e.componentData[i].rGBTransferFunction},t.setScalarOpacity=function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return e.componentData[i].scalarOpacity!==a?(e.componentData[i].scalarOpacity=a,t.modified(),!0):!1},t.getScalarOpacity=function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return e.componentData[i].scalarOpacity===null&&(e.componentData[i].scalarOpacity=kh.newInstance(),e.componentData[i].scalarOpacity.addPoint(0,1),e.componentData[i].scalarOpacity.addPoint(1024,1),t.modified()),e.componentData[i].scalarOpacity},t.setComponentWeight=function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;if(i<0||i>=ew)return UE("Invalid index"),!1;const o=Math.min(1,Math.max(0,a));return e.componentData[i].componentWeight!==o?(e.componentData[i].componentWeight=o,t.modified(),!0):!1},t.getComponentWeight=function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return i<0||i>=ew?(UE("Invalid index"),0):e.componentData[i].componentWeight},t.setInterpolationTypeToNearest=()=>t.setInterpolationType(Iv.NEAREST),t.setInterpolationTypeToLinear=()=>t.setInterpolationType(Iv.LINEAR),t.setInterpolationTypeToFastLinear=()=>t.setInterpolationType(Iv.FAST_LINEAR),t.getInterpolationTypeAsString=()=>ce.enumToString(Iv,e.interpolationType),["useGradientOpacity","scalarOpacityUnitDistance","gradientOpacityMinimumValue","gradientOpacityMinimumOpacity","gradientOpacityMaximumValue","gradientOpacityMaximumOpacity","opacityMode","forceNearestInterpolation"].forEach(i=>{const a=ce.capitalize(i);t[`set${a}`]=(o,s)=>e.componentData[o][`${i}`]!==s?(e.componentData[o][`${i}`]=s,t.modified(),!0):!1}),["useGradientOpacity","scalarOpacityUnitDistance","gradientOpacityMinimumValue","gradientOpacityMinimumOpacity","gradientOpacityMaximumValue","gradientOpacityMaximumOpacity","opacityMode","forceNearestInterpolation"].forEach(i=>{const a=ce.capitalize(i);t[`get${a}`]=o=>e.componentData[o][`${i}`]})}const iCe={colorMixPreset:null,independentComponents:!0,interpolationType:Iv.FAST_LINEAR,shade:!1,ambient:.1,diffuse:.7,specular:.2,specularPower:10,useLabelOutline:!1,labelOutlineThickness:[1],labelOutlineOpacity:1};function aCe(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(Object.assign(e,iCe,n),ce.obj(t,e),!e.componentData){e.componentData=[];for(let r=0;r<ew;++r)e.componentData.push({colorChannels:1,grayTransferFunction:null,rGBTransferFunction:null,scalarOpacity:null,scalarOpacityUnitDistance:1,opacityMode:nCe.FRACTIONAL,gradientOpacityMinimumValue:0,gradientOpacityMinimumOpacity:0,gradientOpacityMaximumValue:1,gradientOpacityMaximumOpacity:1,useGradientOpacity:!1,componentWeight:1,forceNearestInterpolation:!1})}ce.setGet(t,e,["colorMixPreset","independentComponents","interpolationType","shade","ambient","diffuse","specular","specularPower","useLabelOutline","labelOutlineOpacity"]),ce.setGetArray(t,e,["labelOutlineThickness"]),rCe(t,e)}const oCe=ce.newInstance(aCe,"vtkVolumeProperty");var sCe={newInstance:oCe,...vY};const{vtkDebugMacro:lCe}=ce;function cCe(t,e){e.classHierarchy.push("vtkVolume"),t.getVolumes=()=>t,t.makeProperty=sCe.newInstance,t.getProperty=()=>(e.property===null&&(e.property=t.makeProperty()),e.property),t.getBounds=()=>{if(e.mapper===null)return e.bounds;const n=e.mapper.getBounds();if(!n||n.length!==6)return n;if(n[0]>n[1])return e.mapperBounds=n.concat(),e.bounds=[1,-1,1,-1,1,-1],e.boundsMTime.modified(),n;const r=i=>i[0].map((a,o)=>i.map(s=>s[o]));if(!e.mapperBounds||!r([n,e.mapperBounds]).reduce((i,a)=>i&&a[0]===a[1],!0)||t.getMTime()>e.boundsMTime.getMTime()){lCe("Recomputing bounds..."),e.mapperBounds=n.map(o=>o);const i=[];Er.getCorners(n,i),t.computeMatrix();const a=new Float64Array(16);jn(a,e.matrix),i.forEach(o=>Gn(o,o,a)),e.bounds[0]=e.bounds[2]=e.bounds[4]=Number.MAX_VALUE,e.bounds[1]=e.bounds[3]=e.bounds[5]=-Number.MAX_VALUE,e.bounds=e.bounds.map((o,s)=>s%2===0?i.reduce((l,c)=>l>c[s/2]?c[s/2]:l,o):i.reduce((l,c)=>l<c[(s-1)/2]?c[(s-1)/2]:l,o)),e.boundsMTime.modified()}return e.bounds},t.getMTime=()=>{let n=e.mtime;if(e.property!==null){const r=e.property.getMTime();n=r>n?r:n}return n},t.getRedrawMTime=()=>{let n=e.mtime;if(e.mapper!==null){let r=e.mapper.getMTime();n=r>n?r:n,e.mapper.getInput()!==null&&(e.mapper.getInputAlgorithm().update(),r=e.mapper.getInput().getMTime(),n=r>n?r:n)}return n}}const uCe={mapper:null,property:null,bounds:[1,-1,1,-1,1,-1]};function yY(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,uCe,n),_7.extend(t,e,n),e.boundsMTime={},ce.obj(e.boundsMTime),ce.set(t,e,["property"]),ce.setGet(t,e,["mapper"]),ce.getArray(t,e,["bounds"],6),cCe(t,e)}const fCe=ce.newInstance(yY,"vtkVolume");var dCe={newInstance:fCe,extend:yY};const{vtkErrorMacro:hCe}=ce,pCe=["Build","Render"];function gCe(t,e){e.classHierarchy.push("vtkViewNode"),t.build=r=>{},t.render=r=>{},t.traverse=r=>{const i=r.getTraverseOperation(),a=t[i];if(a){a(r);return}t.apply(r,!0);for(let o=0;o<e.children.length;o++)e.children[o].traverse(r);t.apply(r,!1)},t.apply=(r,i)=>{const a=t[r.getOperation()];a&&a(i,r)},t.getViewNodeFor=r=>{if(e.renderable===r)return t;for(let i=0;i<e.children.length;++i){const o=e.children[i].getViewNodeFor(r);if(o)return o}},t.getFirstAncestorOfType=r=>e._parent?e._parent.isA(r)?e._parent:e._parent.getFirstAncestorOfType(r):null,t.getLastAncestorOfType=r=>{if(!e._parent)return null;const i=e._parent.getLastAncestorOfType(r);return i||(e._parent.isA(r)?e._parent:null)},t.addMissingNode=r=>{if(!r)return;const i=e._renderableChildMap.get(r);if(i!==void 0)return i.setVisited(!0),i;const a=t.createViewNode(r);if(a)return a.setParent(t),a.setVisited(!0),e._renderableChildMap.set(r,a),e.children.push(a),a},t.addMissingNodes=r=>{if(!(!r||!r.length))for(let i=0;i<r.length;++i){const a=r[i];t.addMissingNode(a)}},t.addMissingChildren=r=>{if(!(!r||!r.length))for(let i=0;i<r.length;++i){const a=r[i];if(e.children.indexOf(a)===-1){a.setParent(t),e.children.push(a);const s=a.getRenderable();s&&e._renderableChildMap.set(s,a)}a.setVisited(!0)}},t.removeNode=r=>{const i=e.children.findIndex(o=>o===r);if(i<0)return!1;const a=r.getRenderable();return a&&e._renderableChildMap.delete(a),r.delete(),e.children.splice(i,1),!0},t.prepareNodes=()=>{for(let r=0;r<e.children.length;++r)e.children[r].setVisited(!1)},t.setVisited=r=>{e.visited=r},t.removeUnusedNodes=()=>{let r=0;for(let i=0;i<e.children.length;++i){const a=e.children[i];if(a.getVisited())e.children[r++]=a,a.setVisited(!1);else{const s=a.getRenderable();s&&e._renderableChildMap.delete(s),a.delete()}}e.children.length=r},t.createViewNode=r=>{if(!e.myFactory)return hCe("Cannot create view nodes without my own factory"),null;const i=e.myFactory.createNode(r);return i&&i.setRenderable(r),i};const n=t.delete;t.delete=()=>{for(let r=0;r<e.children.length;r++)e.children[r].delete();n()}}const mCe={renderable:null,myFactory:null,children:[],visited:!1};function xY(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,mCe,n),ce.obj(t,e),ce.event(t,e,"event"),e._renderableChildMap=new Map,ce.get(t,e,["visited"]),ce.setGet(t,e,["_parent","renderable","myFactory"]),ce.getArray(t,e,["children"]),ce.moveToProtected(t,e,["parent"]),gCe(t,e)}const vCe=ce.newInstance(xY,"vtkViewNode");var kr={newInstance:vCe,extend:xY,PASS_TYPES:pCe};function yCe(t,e){e.overrides||(e.overrides={}),e.classHierarchy.push("vtkViewNodeFactory"),t.createNode=n=>{if(n.isDeleted())return null;let r=0,i=n.getClassName(r++),a=!1;const o=Object.keys(e.overrides);for(;i&&!a;)o.indexOf(i)!==-1?a=!0:i=n.getClassName(r++);if(!a)return null;const s=e.overrides[i]();return s.setMyFactory(t),s}}const xCe={};function bY(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,xCe,n),ce.obj(t,e),yCe(t,e)}const bCe=ce.newInstance(bY,"vtkViewNodeFactory");var D7={newInstance:bCe,extend:bY};const wY=Object.create(null);function ha(t,e){wY[t]=e}function wCe(t,e){e.classHierarchy.push("vtkOpenGLViewNodeFactory")}const CCe={};function CY(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,CCe,n),e.overrides=wY,D7.extend(t,e,n),wCe(t,e)}const SCe=ce.newInstance(CY,"vtkOpenGLViewNodeFactory");var TCe={newInstance:SCe,extend:CY};function ECe(t,e){e.classHierarchy.push("vtkOpenGLCamera"),t.buildPass=n=>{n&&(e._openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e._openGLRenderWindow=e._openGLRenderer.getParent(),e.context=e._openGLRenderWindow.getContext())},t.opaquePass=n=>{if(n){const r=e._openGLRenderer.getTiledSizeAndOrigin();e.context.viewport(r.lowerLeftU,r.lowerLeftV,r.usize,r.vsize),e.context.scissor(r.lowerLeftU,r.lowerLeftV,r.usize,r.vsize)}},t.translucentPass=t.opaquePass,t.zBufferPass=t.opaquePass,t.opaqueZBufferPass=t.opaquePass,t.volumePass=t.opaquePass,t.getKeyMatrices=n=>{if(n!==e.lastRenderer||e._openGLRenderWindow.getMTime()>e.keyMatrixTime.getMTime()||t.getMTime()>e.keyMatrixTime.getMTime()||n.getMTime()>e.keyMatrixTime.getMTime()||e.renderable.getMTime()>e.keyMatrixTime.getMTime()){Ri(e.keyMatrices.wcvc,e.renderable.getViewMatrix()),BC(e.keyMatrices.normalMatrix,e.keyMatrices.wcvc),Ay(e.keyMatrices.normalMatrix,e.keyMatrices.normalMatrix),jn(e.keyMatrices.wcvc,e.keyMatrices.wcvc);const r=e._openGLRenderer.getAspectRatio();Ri(e.keyMatrices.vcpc,e.renderable.getProjectionMatrix(r,-1,1)),jn(e.keyMatrices.vcpc,e.keyMatrices.vcpc),zn(e.keyMatrices.wcpc,e.keyMatrices.vcpc,e.keyMatrices.wcvc),e.keyMatrixTime.modified(),e.lastRenderer=n}return e.keyMatrices}}const _Ce={context:null,lastRenderer:null,keyMatrixTime:null,keyMatrices:null};function DCe(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,_Ce,n),kr.extend(t,e,n),e.keyMatrixTime={},Wr(e.keyMatrixTime),e.keyMatrices={normalMatrix:new Float64Array(9),vcpc:new Float64Array(16),wcvc:new Float64Array(16),wcpc:new Float64Array(16)},Ni(t,e,["context","keyMatrixTime"]),ECe(t,e)}const SY=Qn(DCe);var OCe={newInstance:SY};ha("vtkCamera",SY);const{vtkDebugMacro:MCe}=wo;function ICe(t,e){e.classHierarchy.push("vtkOpenGLRenderer"),t.buildPass=n=>{if(n){if(!e.renderable)return;t.updateLights(),t.prepareNodes(),t.addMissingNode(e.renderable.getActiveCamera()),t.addMissingNodes(e.renderable.getViewPropsWithNestedProps()),t.removeUnusedNodes()}},t.updateLights=()=>{let n=0;const r=e.renderable.getLightsByReference();for(let i=0;i<r.length;++i)r[i].getSwitch()>0&&n++;return n||(MCe("No lights are on, creating one."),e.renderable.createLight()),n},t.zBufferPass=n=>{if(n){let r=0;const i=e.context;e.renderable.getTransparent()||(e.context.clearColor(1,0,0,1),r|=i.COLOR_BUFFER_BIT),e.renderable.getPreserveDepthBuffer()||(i.clearDepth(1),r|=i.DEPTH_BUFFER_BIT,e.context.depthMask(!0));const a=t.getTiledSizeAndOrigin();i.enable(i.SCISSOR_TEST),i.scissor(a.lowerLeftU,a.lowerLeftV,a.usize,a.vsize),i.viewport(a.lowerLeftU,a.lowerLeftV,a.usize,a.vsize),i.colorMask(!0,!0,!0,!0),r&&i.clear(r),i.enable(i.DEPTH_TEST)}},t.opaqueZBufferPass=n=>t.zBufferPass(n),t.cameraPass=n=>{n&&t.clear()},t.getAspectRatio=()=>{const n=e._parent.getSizeByReference(),r=e.renderable.getViewportByReference();return n[0]*(r[2]-r[0])/((r[3]-r[1])*n[1])},t.getTiledSizeAndOrigin=()=>{const n=e.renderable.getViewportByReference(),r=[0,0,1,1],i=n[0]-r[0],a=n[1]-r[1],o=e._parent.normalizedDisplayToDisplay(i,a),s=Math.round(o[0]),l=Math.round(o[1]),c=n[2]-r[0],f=n[3]-r[1],u=e._parent.normalizedDisplayToDisplay(c,f);let d=Math.round(u[0])-s,h=Math.round(u[1])-l;return d<0&&(d=0),h<0&&(h=0),{usize:d,vsize:h,lowerLeftU:s,lowerLeftV:l}},t.clear=()=>{let n=0;const r=e.context;if(!e.renderable.getTransparent()){const a=e.renderable.getBackgroundByReference();r.clearColor(a[0],a[1],a[2],a[3]),n|=r.COLOR_BUFFER_BIT}e.renderable.getPreserveDepthBuffer()||(r.clearDepth(1),n|=r.DEPTH_BUFFER_BIT,r.depthMask(!0)),r.colorMask(!0,!0,!0,!0);const i=t.getTiledSizeAndOrigin();r.enable(r.SCISSOR_TEST),r.scissor(i.lowerLeftU,i.lowerLeftV,i.usize,i.vsize),r.viewport(i.lowerLeftU,i.lowerLeftV,i.usize,i.vsize),n&&r.clear(n),r.enable(r.DEPTH_TEST)},t.releaseGraphicsResources=()=>{e.selector!==null&&e.selector.releaseGraphicsResources(),e.renderable&&e.renderable.getViewProps().forEach(n=>{n.modified()})},t.setOpenGLRenderWindow=n=>{e._openGLRenderWindow!==n&&(t.releaseGraphicsResources(),e._openGLRenderWindow=n,e.context=null,n&&(e.context=e._openGLRenderWindow.getContext()))}}const RCe={context:null,_openGLRenderWindow:null,selector:null};function PCe(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,RCe,n),kr.extend(t,e,n),Fo(t,e,["shaderCache"]),Ni(t,e,["selector"]),Dy(t,e,["openGLRenderWindow"]),ICe(t,e)}const TY=Qn(PCe,"vtkOpenGLRenderer");var ACe={newInstance:TY};ha("vtkRenderer",TY);function EY(t){let e=0;return t.filter((n,r)=>r===e?(e+=n+1,!0):!1)}function _Y(t){let e=0;for(let n=0;n<t.length;)n+=t[n]+1,e++;return e}const NCe={extractCellSizes:EY,getNumberOfCells:_Y};function LCe(t,e){e.classHierarchy.push("vtkCellArray");const n={...t};t.getNumberOfCells=r=>(e.numberOfCells!==void 0&&!r||(e.cellSizes?e.numberOfCells=e.cellSizes.length:e.numberOfCells=_Y(t.getData())),e.numberOfCells),t.getCellSizes=r=>(e.cellSizes!==void 0&&!r||(e.cellSizes=EY(t.getData())),e.cellSizes),t.resize=r=>{const i=t.getNumberOfTuples();n.resize(r);const a=t.getNumberOfTuples();a<i&&(a===0?(e.numberOfCells=0,e.cellSizes=[]):(e.numberOfCells=void 0,e.cellSizes=void 0))},t.setData=r=>{n.setData(r,1),e.numberOfCells=void 0,e.cellSizes=void 0},t.getCell=r=>{let i=r;const a=e.values[i++];return e.values.subarray(i,i+a)},t.insertNextCell=r=>{const i=t.getNumberOfCells();return t.insertNextTuples([r.length,...r]),++e.numberOfCells,e.cellSizes!=null&&e.cellSizes.push(r.length),i}}function kCe(t){return{empty:!0,numberOfComponents:1,dataType:Ln.UNSIGNED_INT,...t}}function DY(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};tn.extend(t,e,kCe(n)),LCe(t,e)}const VCe=ce.newInstance(DY,"vtkCellArray");var Uh={newInstance:VCe,extend:DY,...NCe};const{vtkErrorMacro:FCe}=ce,UCe=[1,-1,1,-1,1,-1];function BCe(t,e){e.classHierarchy.push("vtkPoints"),t.getNumberOfPoints=t.getNumberOfTuples,t.setNumberOfPoints=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:3;t.getNumberOfPoints()!==n&&(e.size=n*r,e.values=ce.newTypedArray(e.dataType,e.size),t.setNumberOfComponents(r),t.modified())},t.setPoint=function(n){for(var r=arguments.length,i=new Array(r>1?r-1:0),a=1;a<r;a++)i[a-1]=arguments[a];t.setTuple(n,i)},t.getPoint=t.getTuple,t.findPoint=t.findTuple,t.insertNextPoint=(n,r,i)=>t.insertNextTuple([n,r,i]),t.getBounds=()=>{if(t.getNumberOfComponents()===3){const i=t.getRange(0);e.bounds[0]=i[0],e.bounds[1]=i[1];const a=t.getRange(1);e.bounds[2]=a[0],e.bounds[3]=a[1];const o=t.getRange(2);return e.bounds[4]=o[0],e.bounds[5]=o[1],e.bounds}if(t.getNumberOfComponents()!==2)return FCe(`getBounds called on an array with components of
        ${t.getNumberOfComponents()}`),UCe;const n=t.getRange(0);e.bounds[0]=n[0],e.bounds[1]=n[1];const r=t.getRange(1);return e.bounds[2]=r[0],e.bounds[3]=r[1],e.bounds[4]=0,e.bounds[5]=0,e.bounds},t.computeBounds=t.getBounds,t.setNumberOfComponents(e.numberOfComponents<2?3:e.numberOfComponents)}const $Ce={empty:!0,numberOfComponents:3,dataType:Ln.FLOAT,bounds:[1,-1,1,-1,1,-1]};function OY(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,$Ce,n),tn.extend(t,e,n),BCe(t,e)}const GCe=ce.newInstance(OY,"vtkPoints");var l3={newInstance:GCe,extend:OY};function jCe(t,e){e.classHierarchy.push("vtkCell"),t.initialize=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(r){e.pointsIds=r;let i=e.points.getData();i.length!==3*e.pointsIds.length&&(i=ce.newTypedArray(n.getDataType(),3*e.pointsIds.length));const a=n.getData();e.pointsIds.forEach((o,s)=>{let l=3*o,c=3*s;i[c]=a[l],i[++c]=a[++l],i[++c]=a[++l]}),e.points.setData(i)}else{e.points=n,e.pointsIds=new Array(n.getNumberOfPoints());for(let i=n.getNumberOfPoints()-1;i>=0;--i)e.pointsIds[i]=i}},t.getBounds=()=>{const n=e.points.getNumberOfPoints(),r=[];if(n){e.points.getPoint(0,r),e.bounds[0]=r[0],e.bounds[1]=r[0],e.bounds[2]=r[1],e.bounds[3]=r[1],e.bounds[4]=r[2],e.bounds[5]=r[2];for(let i=1;i<n;i++)e.points.getPoint(i,r),e.bounds[0]=r[0]<e.bounds[0]?r[0]:e.bounds[0],e.bounds[1]=r[0]>e.bounds[1]?r[0]:e.bounds[1],e.bounds[2]=r[1]<e.bounds[2]?r[1]:e.bounds[2],e.bounds[3]=r[1]>e.bounds[3]?r[1]:e.bounds[3],e.bounds[4]=r[2]<e.bounds[4]?r[2]:e.bounds[4],e.bounds[5]=r[2]>e.bounds[5]?r[2]:e.bounds[5]}else jm(e.bounds);return e.bounds},t.getLength2=()=>{t.getBounds();let n=0,r=0;for(let i=0;i<3;i++)r=e.bounds[2*i+1]-e.bounds[2*i],n+=r*r;return n},t.getParametricDistance=n=>{let r,i=0;for(let a=0;a<3;a++)n[a]<0?r=-n[a]:n[a]>1?r=n[a]-1:r=0,r>i&&(i=r);return i},t.getNumberOfPoints=()=>e.points.getNumberOfPoints(),t.deepCopy=n=>{n.initialize(e.points,e.pointsIds)},t.getCellDimension=()=>{},t.intersectWithLine=(n,r,i,a,o,s,l)=>{},t.evaluatePosition=(n,r,i,a,o,s)=>{ce.vtkErrorMacro("vtkCell.evaluatePosition is not implemented.")}}const zCe={bounds:[-1,-1,-1,-1,-1,-1],pointsIds:[]};function MY(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,zCe,n),ce.obj(t,e),e.points||(e.points=l3.newInstance()),ce.get(t,e,["points","pointsIds"]),jCe(t,e)}const WCe=ce.newInstance(MY,"vtkCell");var c3={newInstance:WCe,extend:MY};function HCe(t,e){let n=e;for(e>=t.array.length&&(n+=t.array.length);n>t.array.length;)t.array.push({ncells:0,cells:null});t.array.length=n}function KCe(t,e){e.classHierarchy.push("vtkCellLinks"),t.buildLinks=n=>{const r=n.getPoints().getNumberOfPoints(),i=n.getNumberOfCells(),a=new Uint32Array(r);if(n.isA("vtkPolyData")){for(let o=0;o<i;++o){const{cellPointIds:s}=n.getCellPoints(o);s.forEach(l=>{t.incrementLinkCount(l)})}t.allocateLinks(r),e.maxId=r-1;for(let o=0;o<i;++o){const{cellPointIds:s}=n.getCellPoints(o);s.forEach(l=>{t.insertCellReference(l,a[l]++,o)})}}else{for(let o=0;o<i;o++)c3.newInstance().getPointsIds().forEach(l=>{t.incrementLinkCount(l)});t.allocateLinks(r),e.maxId=r-1;for(let o=0;o<i;++o)c3.newInstance().getPointsIds().forEach(l=>{t.insertCellReference(l,a[l]++,o)})}},t.allocate=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e3;e.array=Array(n).fill().map(()=>({ncells:0,cells:null})),e.extend=r,e.maxId=-1},t.initialize=()=>{e.array=null},t.getLink=n=>e.array[n],t.getNcells=n=>e.array[n].ncells,t.getCells=n=>e.array[n].cells,t.insertNextPoint=n=>{e.array.push({ncells:n,cells:Array(n)}),++e.maxId},t.insertNextCellReference=(n,r)=>{e.array[n].cells[e.array[n].ncells++]=r},t.deletePoint=n=>{e.array[n].ncells=0,e.array[n].cells=null},t.removeCellReference=(n,r)=>{e.array[r].cells=e.array[r].cells.filter(i=>i!==n),e.array[r].ncells=e.array[r].cells.length},t.addCellReference=(n,r)=>{e.array[r].cells[e.array[r].ncells++]=n},t.resizeCellList=(n,r)=>{e.array[n].cells.length=r},t.squeeze=()=>{HCe(e,e.maxId+1)},t.reset=()=>{e.maxId=-1},t.deepCopy=n=>{e.array=[...n.array],e.extend=n.extend,e.maxId=n.maxId},t.incrementLinkCount=n=>{++e.array[n].ncells},t.allocateLinks=n=>{for(let r=0;r<n;++r)e.array[r].cells=new Array(e.array[r].ncells)},t.insertCellReference=(n,r,i)=>{e.array[n].cells[r]=i}}const qCe={array:null,maxId:0,extend:0};function IY(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,qCe,n),ce.obj(t,e),KCe(t,e)}const XCe=ce.newInstance(IY,"vtkCellLinks");var YCe={newInstance:XCe,extend:IY};const ti={VTK_EMPTY_CELL:0,VTK_VERTEX:1,VTK_POLY_VERTEX:2,VTK_LINE:3,VTK_POLY_LINE:4,VTK_TRIANGLE:5,VTK_TRIANGLE_STRIP:6,VTK_POLYGON:7,VTK_QUAD:9,VTK_QUADRATIC_EDGE:21,VTK_CONVEX_POINT_SET:41,VTK_POLYHEDRON:42},L_=["vtkEmptyCell","vtkVertex","vtkPolyVertex","vtkLine","vtkPolyLine","vtkTriangle","vtkTriangleStrip","vtkPolygon","vtkPixel","vtkQuad","vtkTetra","vtkVoxel","vtkHexahedron","vtkWedge","vtkPyramid","vtkPentagonalPrism","vtkHexagonalPrism","UnknownClass","UnknownClass","UnknownClass","UnknownClass","vtkQuadraticEdge","vtkQuadraticTriangle","vtkQuadraticQuad","vtkQuadraticTetra","vtkQuadraticHexahedron","vtkQuadraticWedge","vtkQuadraticPyramid","vtkBiQuadraticQuad","vtkTriQuadraticHexahedron","vtkQuadraticLinearQuad","vtkQuadraticLinearWedge","vtkBiQuadraticQuadraticWedge","vtkBiQuadraticQuadraticHexahedron","vtkBiQuadraticTriangle","vtkCubicLine","vtkQuadraticPolygon","UnknownClass","UnknownClass","UnknownClass","UnknownClass","vtkConvexPointSet","UnknownClass","UnknownClass","UnknownClass","UnknownClass","UnknownClass","UnknownClass","UnknownClass","UnknownClass","UnknownClass","vtkParametricCurve","vtkParametricSurface","vtkParametricTriSurface","vtkParametricQuadSurface","vtkParametricTetraRegion","vtkParametricHexRegion","UnknownClass","UnknownClass","UnknownClass","vtkHigherOrderEdge","vtkHigherOrderTriangle","vtkHigherOrderQuad","vtkHigherOrderPolygon","vtkHigherOrderTetrahedron","vtkHigherOrderWedge","vtkHigherOrderPyramid","vtkHigherOrderHexahedron"];function JCe(t){return t<L_.length?L_[t]:"UnknownClass"}function ZCe(t){return L_.findIndex(t)}function QCe(t){return t<ti.VTK_QUADRATIC_EDGE||t===ti.VTK_CONVEX_POINT_SET||t===ti.VTK_POLYHEDRON}function eSe(t){return t===ti.VTK_TRIANGLE_STRIP||t===ti.VTK_POLY_LINE||t===ti.VTK_POLY_VERTEX}const tSe={getClassNameFromTypeId:JCe,getTypeIdFromClassName:ZCe,isLinear:QCe,hasSubCells:eSe};function nSe(t,e){e.classHierarchy.push("vtkCellTypes"),t.allocate=function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:512,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e3;e.size=n>0?n:1,e.extend=r>0?r:1,e.maxId=-1,e.typeArray=new Uint8Array(n),e.locationArray=new Uint32Array(n)},t.insertCell=(n,r,i)=>{e.typeArray[n]=r,e.locationArray[n]=i,n>e.maxId&&(e.maxId=n)},t.insertNextCell=(n,r)=>(t.insertCell(++e.maxId,n,r),e.maxId),t.setCellTypes=(n,r,i)=>{e.size=n,e.typeArray=r,e.locationArray=i,e.maxId=n-1},t.getCellLocation=n=>e.locationArray[n],t.deleteCell=n=>{e.typeArray[n]=ti.VTK_EMPTY_CELL},t.getNumberOfTypes=()=>e.maxId+1,t.isType=n=>{const r=t.getNumberOfTypes();for(let i=0;i<r;++i)if(n===t.getCellType(i))return!0;return!1},t.insertNextType=n=>t.insertNextCell(n,-1),t.getCellType=n=>e.typeArray[n],t.reset=()=>{e.maxId=-1},t.deepCopy=n=>{t.allocate(n.getSize(),n.getExtend()),e.typeArray.set(n.getTypeArray()),e.locationArray.set(n.getLocationArray()),e.maxId=n.getMaxId()}}const rSe={size:0,maxId:-1,extend:1e3};function RY(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,rSe,n),ce.obj(t,e),ce.get(t,e,["size","maxId","extend"]),ce.getArray(t,e,["typeArray","locationArray"]),nSe(t,e)}const iSe=ce.newInstance(RY,"vtkCellTypes");var aSe={newInstance:iSe,extend:RY,...tSe};const oSe={NO_INTERSECTION:0,YES_INTERSECTION:1,ON_LINE:2};var PY={IntersectionState:oSe};const{IntersectionState:tw}=PY;function lg(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;const i={t:Number.MIN_VALUE,distance:0},a=[];let o;a[0]=n[0]-e[0],a[1]=n[1]-e[1],a[2]=n[2]-e[2];const s=a[0]*(t[0]-e[0])+a[1]*(t[1]-e[1])+a[2]*(t[2]-e[2]),l=An(a,a);let c=1e-5*s;return l!==0&&(i.t=s/l),c<0&&(c=-c),-c<l&&l<c||l<=0||i.t<0?o=e:i.t>1?o=n:(o=a,a[0]=e[0]+i.t*a[0],a[1]=e[1]+i.t*a[1],a[2]=e[2]+i.t*a[2]),r&&(r[0]=o[0],r[1]=o[1],r[2]=o[2]),i.distance=Jc(o,t),i}function AY(t,e,n,r,i,a){const o=[],s=[],l=[];i[0]=0,a[0]=0,Df(e,t,o),Df(r,n,s),Df(n,t,l);const c=[An(o,o),-An(o,s),-An(o,s),An(s,s)],f=[];if(f[0]=An(o,l),f[1]=-An(s,l),Wq(c,f,2)===0){let u=Number.MAX_VALUE;const d=[t,e,n,r],h=[n,n,t,t],p=[r,r,e,e];a[0],a[0],i[0],i[0],i[0],i[0],a[0],a[0];let g;for(let m=0;m<4;m++)g=lg(d[m],h[m],p[m]),g.distance<u&&(u=g.distance,g.t);return tw.ON_LINE}return i[0]=f[0],a[0]=f[1],i[0]>=0&&i[0]<=1&&a[0]>=0&&a[0]<=1?tw.YES_INTERSECTION:tw.NO_INTERSECTION}const sSe={distanceToLine:lg,intersection:AY};function lSe(t,e){e.classHierarchy.push("vtkLine");function n(r){return r>=0&&r<=1}t.getCellDimension=()=>1,t.intersectWithLine=(r,i,a,o,s)=>{const l={intersect:0,t:Number.MAX_VALUE,subId:0,betweenPoints:null};s[1]=0,s[2]=0;const c=[],f=[],u=[];e.points.getPoint(0,f),e.points.getPoint(1,u);const d=[],h=[],p=AY(r,i,f,u,d,h);if(l.t=d[0],l.betweenPoints=n(l.t),s[0]=h[0],p===tw.YES_INTERSECTION){for(let g=0;g<3;g++)o[g]=f[g]+s[0]*(u[g]-f[g]),c[g]=r[g]+l.t*(i[g]-r[g]);if(Jc(o,c)<=a*a)return l.intersect=1,l}else{let g;if(l.t<0)return g=lg(r,f,u,o),g.distance<=a*a&&(l.t=0,l.intersect=1,l.betweenPoints=!0),l;if(l.t>1)return g=lg(i,f,u,o),g.distance<=a*a&&(l.t=1,l.intersect=1,l.betweenPoints=!0),l;if(s[0]<0)return s[0]=0,g=lg(f,r,i,o),l.t=g.t,g.distance<=a*a&&(l.intersect=1),l;if(s[0]>1)return s[0]=1,g=lg(u,r,i,o),l.t=g.t,g.distance<=a*a&&(l.intersect=1),l}return l},t.evaluateLocation=(r,i,a)=>{const o=[],s=[];e.points.getPoint(0,o),e.points.getPoint(1,s);for(let l=0;l<3;l++)i[l]=o[l]+r[0]*(s[l]-o[l]);a[0]=1-r[0],a[1]=r[0]},t.evaluateOrientation=(r,i,a)=>e.orientations?(Zb(i,e.orientations[0],e.orientations[1],r[0]),a[0]=1-r[0],a[1]=r[0],!0):!1}const cSe={orientations:null};function NY(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,cSe,n),c3.extend(t,e,n),ce.setGet(t,e,["orientations"]),lSe(t,e)}const uSe=ce.newInstance(NY,"vtkLine");var Rl={newInstance:uSe,extend:NY,...sSe,...PY};const{vtkErrorMacro:cV,vtkWarningMacro:fSe}=ce;function dSe(t,e){e.classHierarchy.push("vtkFieldData");const n=t.getState;e.arrays&&(e.arrays=e.arrays.map(r=>({data:yc(r.data)}))),t.initialize=()=>{t.initializeFields(),t.copyAllOn(),t.clearFieldFlags()},t.initializeFields=()=>{e.arrays=[],e.copyFieldFlags={},t.modified()},t.copyStructure=r=>{t.initializeFields(),e.copyFieldFlags=r.getCopyFieldFlags().map(i=>i),e.arrays=r.arrays().map(i=>({array:i}))},t.getNumberOfArrays=()=>e.arrays.length,t.getNumberOfActiveArrays=()=>e.arrays.length,t.addArray=r=>{const i=r.getName(),{array:a,index:o}=t.getArrayWithIndex(i);return a!=null?(e.arrays[o]={data:r},o):(e.arrays=[].concat(e.arrays,{data:r}),e.arrays.length-1)},t.removeAllArrays=()=>{e.arrays=[]},t.removeArray=r=>{const i=e.arrays.findIndex(a=>a.data.getName()===r);return t.removeArrayByIndex(i)},t.removeArrayByIndex=r=>r!==-1&&r<e.arrays.length?(e.arrays.splice(r,1),!0):!1,t.getArrays=()=>e.arrays.map(r=>r.data),t.getArray=r=>typeof r=="number"?t.getArrayByIndex(r):t.getArrayByName(r),t.getArrayByName=r=>e.arrays.reduce((i,a,o)=>a.data.getName()===r?a.data:i,null),t.getArrayWithIndex=r=>{const i=e.arrays.findIndex(a=>a.data.getName()===r);return{array:i!==-1?e.arrays[i].data:null,index:i}},t.getArrayByIndex=r=>r>=0&&r<e.arrays.length?e.arrays[r].data:null,t.hasArray=r=>t.getArrayWithIndex(r).index>=0,t.getArrayName=r=>{const i=e.arrays[r];return i?i.data.getName():""},t.getCopyFieldFlags=()=>e.copyFieldFlags,t.getFlag=r=>e.copyFieldFlags[r],t.passData=function(r){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1;r.getArrays().forEach(o=>{const s=t.getFlag(o.getName());if(s!==!1&&!(e.doCopyAllOff&&s!==!0)&&o){let l=t.getArrayByName(o.getName());if(l)if(o.getNumberOfComponents()===l.getNumberOfComponents())if(i>-1&&i<o.getNumberOfTuples()){const c=a>-1?a:i;l.insertTuple(c,o.getTuple(i))}else l.insertTuples(0,o.getTuples());else cV("Unhandled case in passData");else if(i<0||i>o.getNumberOfTuples())t.addArray(o),r.getAttributes(o).forEach(c=>{t.setAttribute(o,c)});else{const c=o.getNumberOfComponents();let f=o.getNumberOfValues();const u=a>-1?a:i;f<=u*c&&(f=(u+1)*c),l=tn.newInstance({name:o.getName(),dataType:o.getDataType(),numberOfComponents:c,values:ce.newTypedArray(o.getDataType(),f),size:0}),l.insertTuple(u,o.getTuple(i)),t.addArray(l),r.getAttributes(o).forEach(d=>{t.setAttribute(l,d)})}}})},t.interpolateData=function(r){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:-1,s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:.5;r.getArrays().forEach(l=>{const c=t.getFlag(l.getName());if(c!==!1&&!(e.doCopyAllOff&&c!==!0)&&l){let f=t.getArrayByName(l.getName());if(f)if(l.getNumberOfComponents()===f.getNumberOfComponents())if(i>-1&&i<l.getNumberOfTuples()){const u=o>-1?o:i;f.interpolateTuple(u,l,i,l,a,s),fSe("Unexpected case in interpolateData")}else f.insertTuples(l.getTuples());else cV("Unhandled case in interpolateData");else if(i<0||a<0||i>l.getNumberOfTuples())t.addArray(l),r.getAttributes(l).forEach(u=>{t.setAttribute(l,u)});else{const u=l.getNumberOfComponents();let d=l.getNumberOfValues();const h=o>-1?o:i;d<=h*u&&(d=(h+1)*u),f=tn.newInstance({name:l.getName(),dataType:l.getDataType(),numberOfComponents:u,values:ce.newTypedArray(l.getDataType(),d),size:0}),f.interpolateTuple(h,l,i,l,a,s),t.addArray(f),r.getAttributes(l).forEach(p=>{t.setAttribute(f,p)})}}})},t.copyFieldOn=r=>{e.copyFieldFlags[r]=!0},t.copyFieldOff=r=>{e.copyFieldFlags[r]=!1},t.copyAllOn=()=>{(!e.doCopyAllOn||e.doCopyAllOff)&&(e.doCopyAllOn=!0,e.doCopyAllOff=!1,t.modified())},t.copyAllOff=()=>{(e.doCopyAllOn||!e.doCopyAllOff)&&(e.doCopyAllOn=!1,e.doCopyAllOff=!0,t.modified())},t.clearFieldFlags=()=>{e.copyFieldFlags={}},t.deepCopy=r=>{e.arrays=r.getArrays().map(i=>{const a=i.newClone();return a.deepCopy(i),{data:a}})},t.copyFlags=r=>r.getCopyFieldFlags().map(i=>i),t.reset=()=>e.arrays.forEach(r=>r.data.reset()),t.getMTime=()=>e.arrays.reduce((r,i)=>i.data.getMTime()>r?i.data.getMTime():r,e.mtime),t.getNumberOfComponents=()=>e.arrays.reduce((r,i)=>r+i.data.getNumberOfComponents(),0),t.getNumberOfTuples=()=>e.arrays.length>0?e.arrays[0].getNumberOfTuples():0,t.getState=()=>{const r=n();return r&&(r.arrays=e.arrays.map(i=>({data:i.data.getState()}))),r}}const hSe={arrays:[],copyFieldFlags:[],doCopyAllOn:!0,doCopyAllOff:!1};function LY(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,hSe,n),ce.obj(t,e),dSe(t,e)}const pSe=ce.newInstance(LY,"vtkFieldData");var gSe={newInstance:pSe,extend:LY};const mSe={SCALARS:0,VECTORS:1,NORMALS:2,TCOORDS:3,TENSORS:4,GLOBALIDS:5,PEDIGREEIDS:6,EDGEFLAG:7,NUM_ATTRIBUTES:8},vSe={MAX:0,EXACT:1,NOLIMIT:2},ySe={DUPLICATECELL:1,HIGHCONNECTIVITYCELL:2,LOWCONNECTIVITYCELL:4,REFINEDCELL:8,EXTERIORCELL:16,HIDDENCELL:32},xSe={DUPLICATEPOINT:1,HIDDENPOINT:2},bSe={COPYTUPLE:0,INTERPOLATE:1,PASSDATA:2,ALLCOPY:3},wSe="vtkGhostType",CSe={DEFAULT:0,SINGLE:1,DOUBLE:2};var kY={AttributeCopyOperations:bSe,AttributeLimitTypes:vSe,AttributeTypes:mSe,CellGhostTypes:ySe,DesiredOutputPrecision:CSe,PointGhostTypes:xSe,ghostArrayName:wSe};const{AttributeTypes:vd,AttributeCopyOperations:k0}=kY,{vtkWarningMacro:Fx}=ce;function SSe(t,e){const n=["Scalars","Vectors","Normals","TCoords","Tensors","GlobalIds","PedigreeIds"];function r(o){let s=n.find(l=>vd[l.toUpperCase()]===o||typeof o!="number"&&l.toLowerCase()===o.toLowerCase());return typeof s>"u"&&(s=null),s}e.classHierarchy.push("vtkDataSetAttributes");const i={...t};t.checkNumberOfComponents=o=>!0,t.setAttribute=(o,s)=>{const l=r(s);if(o&&l.toUpperCase()==="PEDIGREEIDS"&&!o.isA("vtkDataArray"))return Fx(`Cannot set attribute ${l}. The attribute must be a vtkDataArray.`),-1;if(o&&!t.checkNumberOfComponents(o,l))return Fx(`Cannot set attribute ${l}. Incorrect number of components.`),-1;let c=e[`active${l}`];if(c>=0&&c<e.arrays.length){if(e.arrays[c]===o)return c;t.removeArrayByIndex(c)}return o?(c=t.addArray(o),e[`active${l}`]=c):e[`active${l}`]=-1,t.modified(),e[`active${l}`]},t.getAttributes=o=>n.filter(s=>t[`get${s}`]()===o),t.setActiveAttributeByName=(o,s)=>t.setActiveAttributeByIndex(t.getArrayWithIndex(o).index,s),t.setActiveAttributeByIndex=(o,s)=>{const l=r(s);if(o>=0&&o<e.arrays.length){if(l.toUpperCase()!=="PEDIGREEIDS"){const c=t.getArrayByIndex(o);if(!c.isA("vtkDataArray"))return Fx(`Cannot set attribute ${l}. Only vtkDataArray subclasses can be set as active attributes.`),-1;if(!t.checkNumberOfComponents(c,l))return Fx(`Cannot set attribute ${l}. Incorrect number of components.`),-1}return e[`active${l}`]=o,t.modified(),o}return o===-1&&(e[`active${l}`]=o,t.modified()),-1},t.getActiveAttribute=o=>{const s=r(o);return t[`get${s}`]()},t.removeAllArrays=()=>{n.forEach(o=>{e[`active${o}`]=-1}),i.removeAllArrays()},t.removeArrayByIndex=o=>(o!==-1&&n.forEach(s=>{o===e[`active${s}`]?e[`active${s}`]=-1:o<e[`active${s}`]&&(e[`active${s}`]-=1)}),i.removeArrayByIndex(o)),n.forEach(o=>{const s=`active${o}`;t[`get${o}`]=()=>t.getArrayByIndex(e[s]),t[`set${o}`]=l=>t.setAttribute(l,o),t[`setActive${o}`]=l=>t.setActiveAttributeByIndex(t.getArrayWithIndex(l).index,o),t[`copy${o}Off`]=()=>{const l=o.toUpperCase();e.copyAttributeFlags[k0.PASSDATA][vd[l]]=!1},t[`copy${o}On`]=()=>{const l=o.toUpperCase();e.copyAttributeFlags[k0.PASSDATA][vd[l]]=!0}}),t.initializeAttributeCopyFlags=()=>{e.copyAttributeFlags=[],Object.keys(k0).filter(o=>o!=="ALLCOPY").forEach(o=>{e.copyAttributeFlags[k0[o]]=Object.keys(vd).filter(s=>s!=="NUM_ATTRIBUTES").reduce((s,l)=>(s[vd[l]]=!0,s),[])}),e.copyAttributeFlags[k0.COPYTUPLE][vd.GLOBALIDS]=!1,e.copyAttributeFlags[k0.INTERPOLATE][vd.GLOBALIDS]=!1,e.copyAttributeFlags[k0.COPYTUPLE][vd.PEDIGREEIDS]=!1},t.initialize=ce.chain(t.initialize,t.initializeAttributeCopyFlags),e.dataArrays&&Object.keys(e.dataArrays).length&&Object.keys(e.dataArrays).forEach(o=>{!e.dataArrays[o].ref&&e.dataArrays[o].type==="vtkDataArray"&&t.addArray(tn.newInstance(e.dataArrays[o]))});const a=t.shallowCopy;t.shallowCopy=(o,s)=>{a(o,s),e.arrays=o.getArrays().map(l=>{const c=l.newClone();return c.shallowCopy(l,s),{data:c}})},t.initializeAttributeCopyFlags()}const TSe={activeScalars:-1,activeVectors:-1,activeTensors:-1,activeNormals:-1,activeTCoords:-1,activeGlobalIds:-1,activePedigreeIds:-1};function VY(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,TSe,n),gSe.extend(t,e,n),ce.setGet(t,e,["activeScalars","activeNormals","activeTCoords","activeVectors","activeTensors","activeGlobalIds","activePedigreeIds"]),e.arrays||(e.arrays={}),SSe(t,e)}const ESe=ce.newInstance(VY,"vtkDataSetAttributes");var uV={newInstance:ESe,extend:VY,...kY};const _Se={UNIFORM:0,DATA_OBJECT_FIELD:0,COORDINATE:1,POINT_DATA:1,POINT:2,POINT_FIELD_DATA:2,CELL:3,CELL_FIELD_DATA:3,VERTEX:4,VERTEX_FIELD_DATA:4,EDGE:5,EDGE_FIELD_DATA:5,ROW:6,ROW_DATA:6},DSe={FIELD_ASSOCIATION_POINTS:0,FIELD_ASSOCIATION_CELLS:1,FIELD_ASSOCIATION_NONE:2,FIELD_ASSOCIATION_POINTS_THEN_CELLS:3,FIELD_ASSOCIATION_VERTICES:4,FIELD_ASSOCIATION_EDGES:5,FIELD_ASSOCIATION_ROWS:6,NUMBER_OF_ASSOCIATIONS:7};var OSe={FieldDataTypes:_Se,FieldAssociations:DSe};const k_=["pointData","cellData","fieldData"];function MSe(t,e){e.classHierarchy.push("vtkDataSet"),k_.forEach(r=>{e[r]?e[r]=yc(e[r]):e[r]=uV.newInstance()});const n=t.shallowCopy;t.shallowCopy=function(r){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;n(r,i),k_.forEach(a=>{e[a]=uV.newInstance(),e[a].shallowCopy(r.getReferenceByName(a))})}}const ISe={};function FY(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,ISe,n),ce.obj(t,e),ce.setGet(t,e,k_),MSe(t,e)}const RSe=ce.newInstance(FY,"vtkDataSet");var zm={newInstance:RSe,extend:FY,...OSe};function PSe(t,e){e.classHierarchy.push("vtkPointSet"),e.points?e.points=yc(e.points):e.points=l3.newInstance(),t.getNumberOfPoints=()=>e.points.getNumberOfPoints(),t.getBounds=()=>e.points.getBounds(),t.computeBounds=()=>{t.getBounds()};const n=t.shallowCopy;t.shallowCopy=function(r){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;n(r,i),e.points=l3.newInstance(),e.points.shallowCopy(r.getPoints())}}const ASe={};function UY(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,ASe,n),zm.extend(t,e,n),ce.setGet(t,e,["points"]),PSe(t,e)}const NSe=ce.newInstance(UY,"vtkPointSet");var LSe={newInstance:NSe,extend:UY};function O7(t,e,n,r){const i=n[0]-e[0],a=n[1]-e[1],o=n[2]-e[2],s=t[0]-e[0],l=t[1]-e[1],c=t[2]-e[2];r[0]=a*c-o*l,r[1]=o*s-i*c,r[2]=i*l-a*s}function u3(t,e,n,r){O7(t,e,n,r);const i=Math.sqrt(r[0]*r[0]+r[1]*r[1]+r[2]*r[2]);i!==0&&(r[0]/=i,r[1]/=i,r[2]/=i)}function kSe(t,e,n,r,i,a){let o=arguments.length>6&&arguments[6]!==void 0?arguments[6]:1e-6,s=!1;const l=[],c=[],f=[],u=[],d=[];u3(t,e,n,u),u3(r,i,a,d);const h=-An(u,t),p=-An(d,r),g=[An(d,t)+p,An(d,e)+p,An(d,n)+p];if(g[0]*g[1]>o&&g[0]*g[2]>o)return{intersect:!1,coplanar:s,pt1:l,pt2:c,surfaceId:f};const m=[An(u,r)+h,An(u,i)+h,An(u,a)+h];if(m[0]*m[1]>o&&m[0]*m[2]>o)return{intersect:!1,coplanar:s,pt1:l,pt2:c,surfaceId:f};if(Math.abs(u[0]-d[0])<1e-9&&Math.abs(u[1]-d[1])<1e-9&&Math.abs(u[2]-d[2])<1e-9&&Math.abs(h-p)<1e-9)return s=!0,{intersect:!1,coplanar:s,pt1:l,pt2:c,surfaceId:f};const y=[t,e,n],v=[r,i,a],x=An(u,d),w=(h-p*x)/(x*x-1),S=(p-h*x)/(x*x-1),T=[w*u[0]+S*d[0],w*u[1]+S*d[1],w*u[2]+S*d[2]],_=yu(u,d,[]);Lh(_);let D=0,I=0;const R=[],O=[];let P=50,N=50;for(let V=0;V<3;V++){const $=V,U=(V+1)%3,G=Ao.intersectWithLine(y[$],y[U],r,d);G.intersection&&G.t>0-o&&G.t<1+o&&(G.t<1+o&&G.t>1-o&&(P=D),R[D++]=An(G.x,_)-An(T,_));const F=Ao.intersectWithLine(v[$],v[U],t,u);F.intersection&&F.t>0-o&&F.t<1+o&&(F.t<1+o&&F.t>1-o&&(N=I),O[I++]=An(F.x,_)-An(T,_))}if(D>2){D--;const V=R[2];R[2]=R[P],R[P]=V}if(I>2){I--;const V=O[2];O[2]=O[N],O[N]=V}if(D!==2||I!==2)return{intersect:!1,coplanar:s,pt1:l,pt2:c,surfaceId:f};if(Number.isNaN(R[0])||Number.isNaN(R[1])||Number.isNaN(O[0])||Number.isNaN(O[1]))return{intersect:!1,coplanar:s,pt1:l,pt2:c,surfaceId:f};if(R[0]>R[1]){const V=R[1];R[1]=R[0],R[0]=V}if(O[0]>O[1]){const V=O[1];O[1]=O[0],O[0]=V}let A,B;return R[1]<O[0]||O[1]<R[0]?{intersect:!1,coplanar:s,pt1:l,pt2:c,surfaceId:f}:(R[0]<O[0]?R[1]<O[1]?(f[0]=2,f[1]=1,A=O[0],B=R[1]):(f[0]=2,f[1]=2,A=O[0],B=O[1]):R[1]<O[1]?(f[0]=1,f[1]=1,A=R[0],B=R[1]):(f[0]=1,f[1]=2,A=R[0],B=O[1]),m_(T,_,A,l),m_(T,_,B,c),{intersect:!0,coplanar:s,pt1:l,pt2:c,surfaceId:f})}const VSe={computeNormalDirection:O7,computeNormal:u3,intersectWithTriangle:kSe};function FSe(t,e){e.classHierarchy.push("vtkTriangle"),t.getCellDimension=()=>2,t.intersectWithLine=(n,r,i,a,o)=>{const s={subId:0,t:Number.MAX_VALUE,intersect:0,betweenPoints:!1};o[2]=0;const l=[],c=i*i,f=[],u=[],d=[];e.points.getPoint(0,f),e.points.getPoint(1,u),e.points.getPoint(2,d);const h=[],p=[];if(u3(f,u,d,h),h[0]!==0||h[1]!==0||h[2]!==0){const x=Ao.intersectWithLine(n,r,f,h);if(s.betweenPoints=x.betweenPoints,s.t=x.t,a[0]=x.x[0],a[1]=x.x[1],a[2]=x.x[2],!x.intersection)return o[0]=0,o[1]=0,s.intersect=0,s;const w=t.evaluatePosition(a,l,o,p);if(w.evaluation>=0)return w.dist2<=c?(s.intersect=1,s):(s.intersect=w.evaluation,s)}const g=Jc(f,u),m=Jc(u,d),y=Jc(d,f);e.line||(e.line=Rl.newInstance()),g>m&&g>y?(e.line.getPoints().setPoint(0,f),e.line.getPoints().setPoint(1,u)):m>y&&m>g?(e.line.getPoints().setPoint(0,u),e.line.getPoints().setPoint(1,d)):(e.line.getPoints().setPoint(0,d),e.line.getPoints().setPoint(1,f));const v=e.line.intersectWithLine(n,r,i,a,o);if(s.betweenPoints=v.betweenPoints,s.t=v.t,v.intersect){const x=[],w=[],S=[];for(let T=0;T<3;T++)x[T]=f[T]-d[T],w[T]=u[T]-d[T],S[T]=a[T]-d[T];return o[0]=An(S,x)/y,o[1]=An(S,w)/m,s.intersect=1,s}return o[0]=0,o[1]=0,s.intersect=0,s},t.evaluatePosition=(n,r,i,a)=>{const o={subId:0,dist2:0,evaluation:-1};let s,l;const c=[],f=[],u=[],d=[];let h;const p=[],g=[],m=[];let y=0,v=0;const x=[];let w,S,T,_=[];const D=[],I=[],R=[];o.subId=0,i[2]=0,e.points.getPoint(1,c),e.points.getPoint(2,f),e.points.getPoint(0,u),O7(c,f,u,d),Ao.generalizedProjectPoint(n,c,d,R);let O=0;for(s=0;s<3;s++)d[s]<0?h=-d[s]:h=d[s],h>O&&(O=h,v=s);for(l=0,s=0;s<3;s++)s!==v&&(x[l++]=s);for(s=0;s<2;s++)p[s]=R[x[s]]-u[x[s]],g[s]=c[x[s]]-u[x[s]],m[s]=f[x[s]]-u[x[s]];if(y=Mi(g,m),y===0)return i[0]=0,i[1]=0,o.evaluation=-1,o;if(i[0]=Mi(p,m)/y,i[1]=Mi(g,p)/y,a[0]=1-(i[0]+i[1]),a[1]=i[0],a[2]=i[1],a[0]>=0&&a[0]<=1&&a[1]>=0&&a[1]<=1&&a[2]>=0&&a[2]<=1)r&&(o.dist2=Jc(R,n),r[0]=R[0],r[1]=R[1],r[2]=R[2]),o.evaluation=1;else{let P;if(r){if(a[1]<0&&a[2]<0)for(w=Jc(n,u),S=Rl.distanceToLine(n,c,u,P,D),T=Rl.distanceToLine(n,u,f,P,I),w<S?(o.dist2=w,_=u):(o.dist2=S,_=D),T<o.dist2&&(o.dist2=T,_=I),s=0;s<3;s++)r[s]=_[s];else if(a[2]<0&&a[0]<0)for(w=Jc(n,c),S=Rl.distanceToLine(n,c,u,P,D),T=Rl.distanceToLine(n,c,f,P,I),w<S?(o.dist2=w,_=c):(o.dist2=S,_=D),T<o.dist2&&(o.dist2=T,_=I),s=0;s<3;s++)r[s]=_[s];else if(a[1]<0&&a[0]<0)for(w=Jc(n,f),S=Rl.distanceToLine(n,f,u,P,D),T=Rl.distanceToLine(n,c,f,P,I),w<S?(o.dist2=w,_=f):(o.dist2=S,_=D),T<o.dist2&&(o.dist2=T,_=I),s=0;s<3;s++)r[s]=_[s];else if(a[0]<0){const N=Rl.distanceToLine(n,c,f,r);o.dist2=N.distance}else if(a[1]<0){const N=Rl.distanceToLine(n,f,u,r);o.dist2=N.distance}else if(a[2]<0){const N=Rl.distanceToLine(n,c,u,r);o.dist2=N.distance}}o.evaluation=0}return o},t.evaluateLocation=(n,r,i)=>{const a=[],o=[],s=[];e.points.getPoint(0,a),e.points.getPoint(1,o),e.points.getPoint(2,s);const l=1-n[0]-n[1];for(let c=0;c<3;c++)r[c]=a[c]*l+o[c]*n[0]+s[c]*n[1];i[0]=l,i[1]=n[0],i[2]=n[1]},t.getParametricDistance=n=>{let r,i=0;const a=[];a[0]=n[0],a[1]=n[1],a[2]=1-n[0]-n[1];for(let o=0;o<3;o++)a[o]<0?r=-a[o]:a[o]>1?r=a[o]-1:r=0,r>i&&(i=r);return i}}const USe={};function BY(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,USe,n),c3.extend(t,e,n),FSe(t,e)}const BSe=ce.newInstance(BY,"vtkTriangle");var $Y={newInstance:BSe,extend:BY,...VSe};const BE=["verts","lines","polys","strips"],{vtkWarningMacro:fV}=ce,$Se={[ti.VTK_LINE]:Rl,[ti.VTK_POLY_LINE]:Rl,[ti.VTK_TRIANGLE]:$Y};function GSe(t,e){e.classHierarchy.push("vtkPolyData");function n(i){return i.replace(/(?:^\w|[A-Z]|\b\w)/g,a=>a.toUpperCase()).replace(/\s+/g,"")}BE.forEach(i=>{t[`getNumberOf${n(i)}`]=()=>e[i].getNumberOfCells(),e[i]?e[i]=yc(e[i]):e[i]=Uh.newInstance()}),t.getNumberOfCells=()=>BE.reduce((i,a)=>i+e[a].getNumberOfCells(),0);const r=t.shallowCopy;t.shallowCopy=function(i){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;r(i,a),BE.forEach(o=>{e[o]=Uh.newInstance(),e[o].shallowCopy(i.getReferenceByName(o))})},t.buildCells=()=>{const i=t.getNumberOfVerts(),a=t.getNumberOfLines(),o=t.getNumberOfPolys(),s=t.getNumberOfStrips(),l=i+a+o+s,c=new Uint8Array(l);let f=c;const u=new Uint32Array(l);let d=u;if(i){let h=0;e.verts.getCellSizes().forEach((p,g)=>{d[g]=h,f[g]=p>1?ti.VTK_POLY_VERTEX:ti.VTK_VERTEX,h+=p+1}),d=d.subarray(i),f=f.subarray(i)}if(a){let h=0;e.lines.getCellSizes().forEach((p,g)=>{d[g]=h,f[g]=p>2?ti.VTK_POLY_LINE:ti.VTK_LINE,p===1&&fV("Building VTK_LINE ",g," with only one point, but VTK_LINE needs at least two points. Check the input."),h+=p+1}),d=d.subarray(a),f=f.subarray(a)}if(o){let h=0;e.polys.getCellSizes().forEach((p,g)=>{switch(d[g]=h,p){case 3:f[g]=ti.VTK_TRIANGLE;break;case 4:f[g]=ti.VTK_QUAD;break;default:f[g]=ti.VTK_POLYGON;break}p<3&&fV("Building VTK_TRIANGLE ",g," with less than three points, but VTK_TRIANGLE needs at least three points. Check the input."),h+=p+1}),d+=d.subarray(o),f+=f.subarray(o)}if(s){let h=0;f.fill(ti.VTK_TRIANGLE_STRIP,0,s),e.strips.getCellSizes().forEach((p,g)=>{d[g]=h,h+=p+1})}e.cells=aSe.newInstance(),e.cells.setCellTypes(l,c,u)},t.buildLinks=function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;e.cells===void 0&&t.buildCells(),e.links=YCe.newInstance(),i>0?e.links.allocate(i):e.links.allocate(t.getPoints().getNumberOfPoints()),e.links.buildLinks(t)},t.getCellType=i=>e.cells.getCellType(i),t.getCellPoints=i=>{const a=t.getCellType(i);let o=null;switch(a){case ti.VTK_VERTEX:case ti.VTK_POLY_VERTEX:o=e.verts;break;case ti.VTK_LINE:case ti.VTK_POLY_LINE:o=e.lines;break;case ti.VTK_TRIANGLE:case ti.VTK_QUAD:case ti.VTK_POLYGON:o=e.polys;break;case ti.VTK_TRIANGLE_STRIP:o=e.strips;break;default:return o=null,{type:0,cellPointIds:null}}const s=e.cells.getCellLocation(i),l=o.getCell(s);return{cellType:a,cellPointIds:l}},t.getPointCells=i=>e.links.getCells(i),t.getCellEdgeNeighbors=(i,a,o)=>{const s=e.links.getLink(a),l=e.links.getLink(o);return s.cells.filter(c=>c!==i&&l.cells.indexOf(c)!==-1)},t.getCell=function(i){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const o=t.getCellPoints(i),s=a||$Se[o.cellType].newInstance();return s.initialize(t.getPoints(),o.cellPointIds),s}}const jSe={};function GY(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,jSe,n),LSe.extend(t,e,n),ce.get(t,e,["cells","links"]),ce.setGet(t,e,["verts","lines","polys","strips"]),GSe(t,e)}const zSe=ce.newInstance(GY,"vtkPolyData");var ca={newInstance:zSe,extend:GY};const{vtkErrorMacro:WSe}=ce;class HSe{constructor(){this.segmentMapping={},this.segments=[null],this.faces=[]}addSegment(e){const n=e[0],r=e[e.length-1];if(n===r||e.length<2)return;const i=this.segmentMapping[n],a=this.segmentMapping[r];if(i!==void 0&&a!==void 0)if(Math.abs(i)===Math.abs(a)){const o=i<a?a:i,s=this.segments[o];if(i>0)for(let l=1;l<e.length-1;l++)s.push(e[l]);else for(let l=1;l<e.length-1;l++)s.unshift(e[e.length-1-l]);this.faces.push(s),this.segments[o]=null,this.segmentMapping[n]=void 0,this.segmentMapping[r]=void 0}else{const o=Math.abs(i),s=Math.abs(a),l=this.segments[o],c=this.segments[s];this.segments[o]=null,this.segments[s]=null,this.segmentMapping[l[0]]=void 0,this.segmentMapping[c[0]]=void 0,this.segmentMapping[l[l.length-1]]=void 0,this.segmentMapping[c[c.length-1]]=void 0,this.addSegment(e),this.addSegment(l),this.addSegment(c)}else if(i!==void 0){if(i>0){const o=this.segments[i];for(let s=1;s<e.length;s++)o.push(e[s]);this.segmentMapping[r]=i}else{const o=this.segments[-i];this.segmentMapping[r]=i;for(let s=1;s<e.length;s++)o.unshift(e[s])}this.segmentMapping[n]=void 0}else if(a!==void 0){if(a>0){const o=this.segments[a];for(let s=1;s<e.length;s++)o.push(e[e.length-1-s]);this.segmentMapping[n]=a}else{const o=this.segments[-a];this.segmentMapping[n]=a;for(let s=1;s<e.length;s++)o.unshift(e[e.length-s-1])}this.segmentMapping[r]=void 0}else{const o=this.segments.length;this.segments.push(e),this.segmentMapping[n]=-o,this.segmentMapping[r]=o}}}function KSe(t,e){e.classHierarchy.push("vtkClosedPolyLineToSurfaceFilter"),t.requestData=(n,r)=>{const i=n[0];if(!i){WSe("Invalid or missing input");return}const a=ca.newInstance();a.shallowCopy(i);const o=new HSe,s=i.getLines().getData();let l=0;for(;l<s.length;){const d=s[l++],h=[];for(let p=0;p<d;p++)h.push(s[l+p]);o.addSegment(h),l+=d}const{faces:c}=o;let f=c.length;for(let d=0;d<c.length;d++)f+=c[d].length;const u=new Uint16Array(f);l=0;for(let d=0;d<c.length;d++){const h=c[d];u[l++]=h.length;for(let p=0;p<h.length;p++)u[l++]=h[p]}a.setPolys(Uh.newInstance({values:u,name:"faces"})),r[0]=a}}const qSe={};function jY(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,qSe,n),ce.obj(t,e),ce.algo(t,e,1,1),KSe(t,e)}const XSe=ce.newInstance(jY,"vtkClosedPolyLineToSurfaceFilter");var YSe={newInstance:XSe,extend:jY};const{vtkErrorMacro:dV}=wo;function JSe(t){const e=t.getPolys().getData(),n=t.getStrips().getData(),r={cellSize:0,cell:[],done:!1,polyIdx:0,stripIdx:0,remainingStripLength:0,next(){if(r.polyIdx<e.length){r.cellSize=e[r.polyIdx];const i=r.polyIdx+1,a=i+r.cellSize;r.polyIdx=a;let o=0;for(let s=i;s<a;++s)r.cell[o++]=e[s]}else if(r.stripIdx<n.length){r.cellSize=3,r.remainingStripLength===0&&(r.remainingStripLength=n[r.stripIdx]-2,r.stripIdx+=3);const i=r.stripIdx-2,a=r.stripIdx+1;r.stripIdx++,r.remainingStripLength--;let o=0;for(let s=i;s<a;++s)r.cell[o++]=n[s]}else if(!r.done)r.done=!0;else throw new Error("Iterator is done")}};return r.next(),r}function ZSe(t,e){e.classHierarchy.push("vtkCutter");const n={...t};t.getMTime=()=>{let i=n.getMTime();return e.cutFunction&&(i=Math.max(i,e.cutFunction.getMTime())),i};function r(i,a){const o=i.getPoints(),s=o.getData(),l=o.getNumberOfPoints(),c=[],f=[],u=[];(!e.cutScalars||e.cutScalars.length<l)&&(e.cutScalars=new Float32Array(l));let d=0,h=0;for(;d<s.length;)e.cutScalars[h++]=e.cutFunction.evaluateFunction(s[d++],s[d++],s[d++]);const p=[],g=new Array(3),m=new Array(3),y=[];for(const x=JSe(i);!x.done;x.next()){if(x.cellSize<=2)continue;for(let D=0;D<x.cellSize;)y[D]=e.cutScalars[x.cell[D++]];const w=y[0]>0;let S=!0;for(let D=1;D<x.cell.length;D++)if(y[D]>0!==w){S=!1;break}if(S)continue;const T=[];for(let D=0;D<x.cellSize;D++){const I=D+1===x.cellSize?0:D+1,R=y[D]>0;if(y[I]>0===R)continue;let P=D,N=I,A=y[N]-y[P];A<=0&&(P=I,N=D,A*=-1);let B=0;A!==0&&(B=(e.cutValue-y[P])/A);const V=x.cell[P],$=x.cell[N];g[0]=s[V*3],g[1]=s[V*3+1],g[2]=s[V*3+2],m[0]=s[$*3],m[1]=s[$*3+1],m[2]=s[$*3+2];const U=[g[0]+B*(m[0]-g[0]),g[1]+B*(m[1]-g[1]),g[2]+B*(m[2]-g[2])];T.push({pointEdge1:V,pointEdge2:$,intersectedPoint:U,newPointID:-1})}for(let D=0;D<T.length;D++){const I=T[D];let R=!1;for(let O=0;O<p.length;O++){const P=p[O],N=I.pointEdge1===P.pointEdge1&&I.pointEdge2===P.pointEdge2,A=I.intersectedPoint[0]===P.intersectedPoint[0]&&I.intersectedPoint[1]===P.intersectedPoint[1]&&I.intersectedPoint[2]===P.intersectedPoint[2];if(N||A){R=!0,T[D].newPointID=p[O].newPointID;break}}R||(c.push(I.intersectedPoint[0]),c.push(I.intersectedPoint[1]),c.push(I.intersectedPoint[2]),T[D].newPointID=c.length/3-1,p.push(T[D]))}const _=T.length;_===2?f.push(_,T[0].newPointID,T[1].newPointID):_>2&&(u.push(_),T.forEach(D=>{u.push(D.newPointID)}))}a.getPoints().setData(AC(o.getDataType(),c),3),f.length!==0&&a.getLines().setData(Uint16Array.from(f)),u.length!==0&&a.getPolys().setData(Uint16Array.from(u))}t.requestData=(i,a)=>{const o=i[0];if(!o){dV("Invalid or missing input");return}if(!e.cutFunction){dV("Missing cut function");return}const s=ca.newInstance();r(o,s),a[0]=s}}const QSe={cutFunction:null,cutScalars:null,cutValue:0};function zY(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,QSe,n),Wr(t,e),BD(t,e,1,1),Ni(t,e,["cutFunction","cutValue"]),ZSe(t,e)}const e4e=Qn(zY,"vtkCutter");var t4e={newInstance:e4e,extend:zY};const Of={ARRAY_BUFFER:0,ELEMENT_ARRAY_BUFFER:1,TEXTURE_BUFFER:2};var WY={ObjectType:Of};const{ObjectType:nw}=WY,n4e={};function r4e(t,e){e.classHierarchy.push("vtkOpenGLBufferObject");function n(s){switch(s){case nw.ELEMENT_ARRAY_BUFFER:return e.context.ELEMENT_ARRAY_BUFFER;case nw.TEXTURE_BUFFER:if("TEXTURE_BUFFER"in e.context)return e.context.TEXTURE_BUFFER;case nw.ARRAY_BUFFER:default:return e.context.ARRAY_BUFFER}}let r=null,i=null,a=!0,o="";t.getType=()=>r,t.setType=s=>{r=s},t.getHandle=()=>i,t.isReady=()=>a===!1,t.generateBuffer=s=>{const l=n(s);return i===null&&(i=e.context.createBuffer(),r=s),n(r)===l},t.upload=(s,l)=>t.generateBuffer(l)?(e.context.bindBuffer(n(r),i),e.context.bufferData(n(r),s,e.context.STATIC_DRAW),e.allocatedGPUMemoryInBytes=s.length*s.BYTES_PER_ELEMENT,a=!1,!0):(o="Trying to upload array buffer to incompatible buffer.",!1),t.bind=()=>i?(e.context.bindBuffer(n(r),i),!0):!1,t.release=()=>i?(e.context.bindBuffer(n(r),null),!0):!1,t.releaseGraphicsResources=()=>{i!==null&&(e.context.bindBuffer(n(r),null),e.context.deleteBuffer(i),i=null,e.allocatedGPUMemoryInBytes=0)},t.setOpenGLRenderWindow=s=>{e._openGLRenderWindow!==s&&(t.releaseGraphicsResources(),e._openGLRenderWindow=s,e.context=null,s&&(e.context=e._openGLRenderWindow.getContext()))},t.getError=()=>o}const i4e={objectType:nw.ARRAY_BUFFER,context:null,allocatedGPUMemoryInBytes:0};function HY(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,i4e,n),ce.obj(t,e),ce.get(t,e,["_openGLRenderWindow","allocatedGPUMemoryInBytes"]),ce.moveToProtected(t,e,["openGLRenderWindow"]),r4e(t,e)}const a4e=ce.newInstance(HY);var Ef={newInstance:a4e,extend:HY,...n4e,...WY};const KY={FLAT:0,GOURAUD:1,PHONG:2},go={POINTS:0,WIREFRAME:1,SURFACE:2},o4e=KY;var qY={Shading:KY,Representation:go,Interpolation:o4e};const{vtkErrorMacro:hV}=ce;function s4e(t,e){const n=new Float64Array(3);kX(n,e);const r=new Float64Array(16);return MX(r,Fh(),t,n),r}function l4e(t,e){return t===null||e===null?!1:!(rV(t,[0,0,0])&&rV(e,[1,1,1]))}function c4e(t,e){e.classHierarchy.push("vtkOpenGLCellArrayBufferObject"),t.setType(Of.ARRAY_BUFFER),t.createVBO=function(n,r,i,a){let o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null;if(!n.getData()||!n.getData().length)return e.elementCount=0,0;e.blockSize=3,e.vertexOffset=0,e.normalOffset=0,e.tCoordOffset=0,e.tCoordComponents=0,e.colorComponents=0,e.colorOffset=0,e.customData=[];const s=a.points.getData();let l=null,c=null,f=null;const u=a.colors?a.colors.getNumberOfComponents():0,d=a.tcoords?a.tcoords.getNumberOfComponents():0;a.normals&&(e.normalOffset=4*e.blockSize,e.blockSize+=3,l=a.normals.getData()),a.customAttributes&&a.customAttributes.forEach(G=>{G&&(e.customData.push({data:G.getData(),offset:4*e.blockSize,components:G.getNumberOfComponents(),name:G.getName()}),e.blockSize+=G.getNumberOfComponents())}),a.tcoords&&(e.tCoordOffset=4*e.blockSize,e.tCoordComponents=d,e.blockSize+=d,c=a.tcoords.getData()),a.colors?(e.colorComponents=a.colors.getNumberOfComponents(),e.colorOffset=0,f=a.colors.getData(),e.colorBO||(e.colorBO=Ef.newInstance()),e.colorBO.setOpenGLRenderWindow(e._openGLRenderWindow)):e.colorBO=null,e.stride=4*e.blockSize;let h=0,p=0,g=0,m=0,y=0,v=0,x;const w={anythingToPoints(G,F,J,Q){for(let ne=0;ne<G;++ne)x(F[J+ne],Q)},linesToWireframe(G,F,J,Q){for(let ne=0;ne<G-1;++ne)x(F[J+ne],Q),x(F[J+ne+1],Q)},polysToWireframe(G,F,J,Q){if(G>2)for(let ne=0;ne<G;++ne)x(F[J+ne],Q),x(F[J+(ne+1)%G],Q)},stripsToWireframe(G,F,J,Q){if(G>2){for(let ne=0;ne<G-1;++ne)x(F[J+ne],Q),x(F[J+ne+1],Q);for(let ne=0;ne<G-2;ne++)x(F[J+ne],Q),x(F[J+ne+2],Q)}},polysToSurface(G,F,J,Q){for(let ne=0;ne<G-2;ne++)x(F[J+0],Q),x(F[J+ne+1],Q),x(F[J+ne+2],Q)},stripsToSurface(G,F,J,Q){for(let ne=0;ne<G-2;ne++)x(F[J+ne],Q),x(F[J+ne+1+ne%2],Q),x(F[J+ne+1+(ne+1)%2],Q)}},S={anythingToPoints(G,F){return G},linesToWireframe(G,F){return G>1?(G-1)*2:0},polysToWireframe(G,F){return G>2?G*2:0},stripsToWireframe(G,F){return G>2?G*4-6:0},polysToSurface(G,F){return G>2?(G-2)*3:0},stripsToSurface(G,F,J){return G>2?(G-2)*3:0}};let T=null,_=null;i===go.POINTS||r==="verts"?(T=w.anythingToPoints,_=S.anythingToPoints):i===go.WIREFRAME||r==="lines"?(T=w[`${r}ToWireframe`],_=S[`${r}ToWireframe`]):(T=w[`${r}ToSurface`],_=S[`${r}ToSurface`]);const D=n.getData(),I=D.length;let R=0;for(let G=0;G<I;)R+=_(D[G],D),G+=D[G]+1;let O=null;const P=new Float32Array(R*e.blockSize);f&&(O=new Uint8Array(R*4));let N=0,A=0,B=0,V=0;for(let G=0;G<3;++G){const F=a.points.getRange(G),J=F[1]-F[0];B+=J*J;const Q=.5*(F[1]+F[0]);V+=Q*Q}if(B>0&&(Math.abs(V)/B>1e6||Math.abs(Math.log10(B))>3||B===0&&V>1e6)){const G=new Float64Array(3),F=new Float64Array(3);for(let J=0;J<3;++J){const Q=a.points.getRange(J),ne=Q[1]-Q[0];G[J]=.5*(Q[1]+Q[0]),F[J]=ne>0?1/ne:1}t.setCoordShiftAndScale(G,F)}else e.coordShiftAndScaleEnabled===!0&&t.setCoordShiftAndScale(null,null);if(o)if(!o.points&&!o.cells)o.points=new Int32Array(R),o.cells=new Int32Array(R);else{const G=new Int32Array(R+o.points.length);G.set(o.points),o.points=G;const F=new Int32Array(R+o.cells.length);F.set(o.cells),o.cells=F}let U=a.vertexOffset;x=function(F,J){if(o&&(o.points[U]=F,o.cells[U]=v+a.cellOffset),++U,h=F*3,e.coordShiftAndScaleEnabled?(P[N++]=(s[h++]-e.coordShift[0])*e.coordScale[0],P[N++]=(s[h++]-e.coordShift[1])*e.coordScale[1],P[N++]=(s[h++]-e.coordShift[2])*e.coordScale[2]):(P[N++]=s[h++],P[N++]=s[h++],P[N++]=s[h++]),l!==null&&(a.haveCellNormals?p=(v+a.cellOffset)*3:p=F*3,P[N++]=l[p++],P[N++]=l[p++],P[N++]=l[p++]),e.customData.forEach(Q=>{y=F*Q.components;for(let ne=0;ne<Q.components;++ne)P[N++]=Q.data[y++]}),c!==null){a.useTCoordsPerCell?g=J*d:g=F*d;for(let Q=0;Q<d;++Q)P[N++]=c[g++]}f!==null&&(a.haveCellScalars?m=(v+a.cellOffset)*u:m=F*u,O[A++]=f[m++],O[A++]=f[m++],O[A++]=f[m++],O[A++]=u===4?f[m++]:255)};for(let G=0;G<I;G+=D[G]+1,v++)T(D[G],D,G+1,v+a.cellOffset);return e.elementCount=R,t.upload(P,Of.ARRAY_BUFFER),e.colorBO&&(e.colorBOStride=4,e.colorBO.upload(O,Of.ARRAY_BUFFER)),v},t.setCoordShiftAndScale=(n,r)=>{if(n!==null&&(n.constructor!==Float64Array||n.length!==3)){hV("Wrong type for coordShift, expected vec3 or null");return}if(r!==null&&(r.constructor!==Float64Array||r.length!==3)){hV("Wrong type for coordScale, expected vec3 or null");return}(e.coordShift===null||n===null||!iV(n,e.coordShift))&&(e.coordShift=n),(e.coordScale===null||r===null||!iV(r,e.coordScale))&&(e.coordScale=r),e.coordShiftAndScaleEnabled=l4e(e.coordShift,e.coordScale),e.coordShiftAndScaleEnabled?e.inverseShiftAndScaleMatrix=s4e(e.coordShift,e.coordScale):e.inverseShiftAndScaleMatrix=null}}const u4e={elementCount:0,stride:0,colorBOStride:0,vertexOffset:0,normalOffset:0,tCoordOffset:0,tCoordComponents:0,colorOffset:0,colorComponents:0,tcoordBO:null,customData:[],coordShift:null,coordScale:null,coordShiftAndScaleEnabled:!1,inverseShiftAndScaleMatrix:null};function XY(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,u4e,n),Ef.extend(t,e,n),ce.setGet(t,e,["colorBO","elementCount","stride","colorBOStride","vertexOffset","normalOffset","tCoordOffset","tCoordComponents","colorOffset","colorComponents","customData"]),ce.get(t,e,["coordShift","coordScale","coordShiftAndScaleEnabled","inverseShiftAndScaleMatrix"]),c4e(t,e)}const f4e=ce.newInstance(XY);var d4e={newInstance:f4e,extend:XY};const{vtkErrorMacro:h4e}=ce;function p4e(t,e){e.classHierarchy.push("vtkShader"),t.compile=()=>{let n=e.context.VERTEX_SHADER;if(!e.source||!e.source.length||e.shaderType==="Unknown")return!1;switch(e.handle!==0&&(e.context.deleteShader(e.handle),e.handle=0),e.shaderType){case"Fragment":n=e.context.FRAGMENT_SHADER;break;case"Vertex":default:n=e.context.VERTEX_SHADER;break}if(e.handle=e.context.createShader(n),e.context.shaderSource(e.handle,e.source),e.context.compileShader(e.handle),!e.context.getShaderParameter(e.handle,e.context.COMPILE_STATUS)){const i=e.context.getShaderInfoLog(e.handle);return h4e(`Error compiling shader '${e.source}': ${i}`),e.context.deleteShader(e.handle),e.handle=0,!1}return!0},t.cleanup=()=>{e.shaderType==="Unknown"||e.handle===0||(e.context.deleteShader(e.handle),e.handle=0,e.dirty=!0)}}const g4e={shaderType:"Unknown",source:"",error:"",handle:0,dirty:!1,context:null};function YY(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,g4e,n),ce.obj(t,e),ce.setGet(t,e,["shaderType","source","error","handle","context"]),p4e(t,e)}const m4e=ce.newInstance(YY,"vtkShader");var $E={newInstance:m4e,extend:YY};const{vtkErrorMacro:Kc}=ce;function v4e(t,e,n,r){const i=typeof n=="string"?n:n.join(`
`),a=r===!1?e:new RegExp(e,"g"),o=t.replace(a,i);return{replace:o!==i,result:o}}function y4e(t,e){e.classHierarchy.push("vtkShaderProgram"),t.compileShader=()=>e.vertexShader.compile()?e.fragmentShader.compile()?!t.attachShader(e.vertexShader)||!t.attachShader(e.fragmentShader)?(Kc(e.error),0):t.link()?(t.setCompiled(!0),1):(Kc(`Links failed: ${e.error}`),0):(Kc(e.fragmentShader.getSource().split(`
`).map((n,r)=>`${r}: ${n}`).join(`
`)),Kc(e.fragmentShader.getError()),0):(Kc(e.vertexShader.getSource().split(`
`).map((n,r)=>`${r}: ${n}`).join(`
`)),Kc(e.vertexShader.getError()),0),t.cleanup=()=>{e.shaderType==="Unknown"||e.handle===0||(t.release(),e.vertexShaderHandle!==0&&(e.context.detachShader(e.handle,e.vertexShaderHandle),e.vertexShaderHandle=0),e.fragmentShaderHandle!==0&&(e.context.detachShader(e.handle,e.fragmentShaderHandle),e.fragmentShaderHandle=0),e.context.deleteProgram(e.handle),e.handle=0,t.setCompiled(!1))},t.bind=()=>!e.linked&&!t.link()?!1:(e.context.useProgram(e.handle),t.setBound(!0),!0),t.isBound=()=>!!e.bound,t.release=()=>{e.context.useProgram(null),t.setBound(!1)},t.setContext=n=>{e.vertexShader.setContext(n),e.fragmentShader.setContext(n),e.geometryShader.setContext(n)},t.link=()=>{if(e.linked)return!0;if(e.handle===0)return e.error="Program has not been initialized, and/or does not have shaders.",!1;if(e.uniformLocs={},e.context.linkProgram(e.handle),!e.context.getProgramParameter(e.handle,e.context.LINK_STATUS)){const r=e.context.getProgramInfoLog(e.handle);return Kc(`Error linking shader ${r}`),e.handle=0,!1}return t.setLinked(!0),e.attributeLocs={},!0},t.setUniformMatrix=(n,r)=>{const i=t.findUniform(n);if(i===-1)return e.error=`Could not set uniform ${n} . No such uniform.`,!1;const a=new Float32Array(r);return e.context.uniformMatrix4fv(i,!1,a),!0},t.setUniformMatrix3x3=(n,r)=>{const i=t.findUniform(n);if(i===-1)return e.error=`Could not set uniform ${n} . No such uniform.`,!1;const a=new Float32Array(r);return e.context.uniformMatrix3fv(i,!1,a),!0},t.setUniformf=(n,r)=>{const i=t.findUniform(n);return i===-1?(e.error=`Could not set uniform ${n} . No such uniform.`,!1):(e.context.uniform1f(i,r),!0)},t.setUniformfv=(n,r)=>{const i=t.findUniform(n);return i===-1?(e.error=`Could not set uniform ${n} . No such uniform.`,!1):(e.context.uniform1fv(i,r),!0)},t.setUniformi=(n,r)=>{const i=t.findUniform(n);return i===-1?(e.error=`Could not set uniform ${n} . No such uniform.`,!1):(e.context.uniform1i(i,r),!0)},t.setUniformiv=(n,r)=>{const i=t.findUniform(n);return i===-1?(e.error=`Could not set uniform ${n} . No such uniform.`,!1):(e.context.uniform1iv(i,r),!0)},t.setUniform2f=(n,r,i)=>{const a=t.findUniform(n);if(a===-1)return e.error=`Could not set uniform ${n} . No such uniform.`,!1;if(i===void 0)throw new RangeError("Invalid number of values for array");return e.context.uniform2f(a,r,i),!0},t.setUniform2fv=(n,r)=>{const i=t.findUniform(n);return i===-1?(e.error=`Could not set uniform ${n} . No such uniform.`,!1):(e.context.uniform2fv(i,r),!0)},t.setUniform2i=(n,r,i)=>{const a=t.findUniform(n);if(a===-1)return e.error=`Could not set uniform ${n} . No such uniform.`,!1;if(i===void 0)throw new RangeError("Invalid number of values for array");return e.context.uniform2i(a,r,i),!0},t.setUniform2iv=(n,r)=>{const i=t.findUniform(n);return i===-1?(e.error=`Could not set uniform ${n} . No such uniform.`,!1):(e.context.uniform2iv(i,r),!0)},t.setUniform3f=(n,r,i,a)=>{const o=t.findUniform(n);if(o===-1)return e.error=`Could not set uniform ${n} . No such uniform.`,!1;if(a===void 0)throw new RangeError("Invalid number of values for array");return e.context.uniform3f(o,r,i,a),!0},t.setUniform3fArray=(n,r)=>{const i=t.findUniform(n);if(i===-1)return e.error=`Could not set uniform ${n} . No such uniform.`,!1;if(!Array.isArray(r)||r.length!==3)throw new RangeError("Invalid number of values for array");return e.context.uniform3f(i,r[0],r[1],r[2]),!0},t.setUniform3fv=(n,r)=>{const i=t.findUniform(n);return i===-1?(e.error=`Could not set uniform ${n} . No such uniform.`,!1):(e.context.uniform3fv(i,r),!0)},t.setUniform3i=function(n){const r=t.findUniform(n);if(r===-1)return e.error=`Could not set uniform ${n} . No such uniform.`,!1;for(var i=arguments.length,a=new Array(i>1?i-1:0),o=1;o<i;o++)a[o-1]=arguments[o];let s=a;if(s.length===1&&Array.isArray(s[0])&&(s=s[0]),s.length!==3)throw new RangeError("Invalid number of values for array");return e.context.uniform3i(r,s[0],s[1],s[2]),!0},t.setUniform3iv=(n,r)=>{const i=t.findUniform(n);return i===-1?(e.error=`Could not set uniform ${n} . No such uniform.`,!1):(e.context.uniform3iv(i,r),!0)},t.setUniform4f=function(n){const r=t.findUniform(n);if(r===-1)return e.error=`Could not set uniform ${n} . No such uniform.`,!1;for(var i=arguments.length,a=new Array(i>1?i-1:0),o=1;o<i;o++)a[o-1]=arguments[o];let s=a;if(s.length===1&&Array.isArray(s[0])&&(s=s[0]),s.length!==4)throw new RangeError("Invalid number of values for array");return e.context.uniform4f(r,s[0],s[1],s[2],s[3]),!0},t.setUniform4fv=(n,r)=>{const i=t.findUniform(n);return i===-1?(e.error=`Could not set uniform ${n} . No such uniform.`,!1):(e.context.uniform4fv(i,r),!0)},t.setUniform4i=function(n){const r=t.findUniform(n);if(r===-1)return e.error=`Could not set uniform ${n} . No such uniform.`,!1;for(var i=arguments.length,a=new Array(i>1?i-1:0),o=1;o<i;o++)a[o-1]=arguments[o];let s=a;if(s.length===1&&Array.isArray(s[0])&&(s=s[0]),s.length!==4)throw new RangeError("Invalid number of values for array");return e.context.uniform4i(r,s[0],s[1],s[2],s[3]),!0},t.setUniform4iv=(n,r)=>{const i=t.findUniform(n);return i===-1?(e.error=`Could not set uniform ${n} . No such uniform.`,!1):(e.context.uniform4iv(i,r),!0)},t.findUniform=n=>{if(!n||!e.linked)return-1;let r=e.uniformLocs[n];return r!==void 0?r:(r=e.context.getUniformLocation(e.handle,n),r===null?(e.error=`Uniform ${n} not found in current shader program.`,e.uniformLocs[n]=-1,-1):(e.uniformLocs[n]=r,r))},t.isUniformUsed=n=>{if(!n)return!1;let r=e.uniformLocs[n];return r!==void 0?r!==null:e.linked?(r=e.context.getUniformLocation(e.handle,n),e.uniformLocs[n]=r,r!==null):(Kc("attempt to find uniform when the shader program is not linked"),!1)},t.isAttributeUsed=n=>{if(!n)return!1;if(n in e.attributeLocs)return!0;if(!e.linked)return Kc("attempt to find uniform when the shader program is not linked"),!1;const r=e.context.getAttribLocation(e.handle,n);return r===-1?!1:(e.attributeLocs[n]=r,!0)},t.attachShader=n=>{if(n.getHandle()===0)return e.error="Shader object was not initialized, cannot attach it.",!1;if(n.getShaderType()==="Unknown")return e.error="Shader object is of type Unknown and cannot be used.",!1;if(e.handle===0){const r=e.context.createProgram();if(r===0)return e.error="Could not create shader program.",!1;e.handle=r,e.linked=!1}return n.getShaderType()==="Vertex"&&(e.vertexShaderHandle!==0&&e.context.detachShader(e.handle,e.vertexShaderHandle),e.vertexShaderHandle=n.getHandle()),n.getShaderType()==="Fragment"&&(e.fragmentShaderHandle!==0&&e.context.detachShader(e.handle,e.fragmentShaderHandle),e.fragmentShaderHandle=n.getHandle()),e.context.attachShader(e.handle,n.getHandle()),t.setLinked(!1),!0},t.detachShader=n=>{if(n.getHandle()===0)return e.error="shader object was not initialized, cannot attach it.",!1;if(n.getShaderType()==="Unknown")return e.error="Shader object is of type Unknown and cannot be used.",!1;switch(e.handle===0&&(e.error="This shader program has not been initialized yet."),n.getShaderType()){case"Vertex":return e.vertexShaderHandle!==n.getHandle()?(e.error="The supplied shader was not attached to this program.",!1):(e.context.detachShader(e.handle,n.getHandle()),e.vertexShaderHandle=0,e.linked=!1,!0);case"Fragment":return e.fragmentShaderHandle!==n.getHandle()?(e.error="The supplied shader was not attached to this program.",!1):(e.context.detachShader(e.handle,n.getHandle()),e.fragmentShaderHandle=0,e.linked=!1,!0);default:return!1}},t.setContext=n=>{e.context=n,e.vertexShader.setContext(n),e.fragmentShader.setContext(n),e.geometryShader.setContext(n)},t.setLastCameraMTime=n=>{e.lastCameraMTime=n}}const x4e={vertexShaderHandle:0,fragmentShaderHandle:0,geometryShaderHandle:0,vertexShader:null,fragmentShader:null,geometryShader:null,linked:!1,bound:!1,compiled:!1,error:"",handle:0,numberOfOutputs:0,attributesLocs:null,uniformLocs:null,md5Hash:0,context:null,lastCameraMTime:null};function JY(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,x4e,n),e.attributesLocs={},e.uniformLocs={},e.vertexShader=$E.newInstance(),e.vertexShader.setShaderType("Vertex"),e.fragmentShader=$E.newInstance(),e.fragmentShader.setShaderType("Fragment"),e.geometryShader=$E.newInstance(),e.geometryShader.setShaderType("Geometry"),ce.obj(t,e),ce.get(t,e,["lastCameraMTime"]),ce.setGet(t,e,["error","handle","compiled","bound","md5Hash","vertexShader","fragmentShader","geometryShader","linked"]),y4e(t,e)}const b4e=ce.newInstance(JY,"vtkShaderProgram");var $e={newInstance:b4e,extend:JY,substitute:v4e};function w4e(t,e){e.classHierarchy.push("vtkOpenGLVertexArrayObject"),t.exposedMethod=()=>{},t.initialize=()=>{e.instancingExtension=null,e._openGLRenderWindow.getWebgl2()||(e.instancingExtension=e.context.getExtension("ANGLE_instanced_arrays")),!e.forceEmulation&&e._openGLRenderWindow&&e._openGLRenderWindow.getWebgl2()?(e.extension=null,e.supported=!0,e.handleVAO=e.context.createVertexArray()):(e.extension=e.context.getExtension("OES_vertex_array_object"),!e.forceEmulation&&e.extension?(e.supported=!0,e.handleVAO=e.extension.createVertexArrayOES()):e.supported=!1)},t.isReady=()=>e.handleVAO!==0||e.supported===!1,t.bind=()=>{if(t.isReady()||t.initialize(),t.isReady()&&e.supported)e.extension?e.extension.bindVertexArrayOES(e.handleVAO):e.context.bindVertexArray(e.handleVAO);else if(t.isReady()){const n=e.context;for(let r=0;r<e.buffers.length;++r){const i=e.buffers[r];e.context.bindBuffer(n.ARRAY_BUFFER,i.buffer);for(let a=0;a<i.attributes.length;++a){const o=i.attributes[a],s=o.isMatrix?o.size:1;for(let l=0;l<s;++l)n.enableVertexAttribArray(o.index+l),n.vertexAttribPointer(o.index+l,o.size,o.type,o.normalize,o.stride,o.offset+o.stride*l/o.size),o.divisor>0&&(e.instancingExtension?e.instancingExtension.vertexAttribDivisorANGLE(o.index+l,1):n.vertexAttribDivisor(o.index+l,1))}}}},t.release=()=>{if(t.isReady()&&e.supported)e.extension?e.extension.bindVertexArrayOES(null):e.context.bindVertexArray(null);else if(t.isReady()){const n=e.context;for(let r=0;r<e.buffers.length;++r){const i=e.buffers[r];e.context.bindBuffer(n.ARRAY_BUFFER,i.buffer);for(let a=0;a<i.attributes.length;++a){const o=i.attributes[a],s=o.isMatrix?o.size:1;for(let l=0;l<s;++l)n.enableVertexAttribArray(o.index+l),n.vertexAttribPointer(o.index+l,o.size,o.type,o.normalize,o.stride,o.offset+o.stride*l/o.size),o.divisor>0&&(e.instancingExtension?e.instancingExtension.vertexAttribDivisorANGLE(o.index+l,0):n.vertexAttribDivisor(o.index+l,0)),n.disableVertexAttribArray(o.index+l)}}}},t.shaderProgramChanged=()=>{t.release(),e.handleVAO&&(e.extension?e.extension.deleteVertexArrayOES(e.handleVAO):e.context.deleteVertexArray(e.handleVAO)),e.handleVAO=0,e.handleProgram=0},t.releaseGraphicsResources=()=>{t.shaderProgramChanged(),e.handleVAO&&(e.extension?e.extension.deleteVertexArrayOES(e.handleVAO):e.context.deleteVertexArray(e.handleVAO)),e.handleVAO=0,e.supported=!0,e.handleProgram=0},t.addAttributeArray=(n,r,i,a,o,s,l,c)=>t.addAttributeArrayWithDivisor(n,r,i,a,o,s,l,c,0,!1),t.addAttributeArrayWithDivisor=(n,r,i,a,o,s,l,c,f,u)=>{if(!n||!n.isBound()||r.getHandle()===0||r.getType()!==Of.ARRAY_BUFFER||(e.handleProgram===0&&(e.handleProgram=n.getHandle()),t.isReady()||t.initialize(),!t.isReady()||e.handleProgram!==n.getHandle()))return!1;const d=e.context,h={};if(h.name=i,h.index=d.getAttribLocation(e.handleProgram,i),h.offset=a,h.stride=o,h.type=s,h.size=l,h.normalize=c,h.isMatrix=u,h.divisor=f,h.Index===-1)return!1;if(r.bind(),d.enableVertexAttribArray(h.index),d.vertexAttribPointer(h.index,h.size,h.type,h.normalize,h.stride,h.offset),f>0&&(e.instancingExtension?e.instancingExtension.vertexAttribDivisorANGLE(h.index,1):d.vertexAttribDivisor(h.index,1)),h.buffer=r.getHandle(),!e.supported){let p=!1;for(let g=0;g<e.buffers.length;++g){const m=e.buffers[g];if(m.buffer===h.buffer){p=!0;let y=!1;for(let v=0;v<m.attributes.length;++v)m.attributes[v].name===i&&(y=!0,m.attributes[v]=h);y||m.attributes.push(h)}}p||e.buffers.push({buffer:h.buffer,attributes:[h]})}return!0},t.addAttributeMatrixWithDivisor=(n,r,i,a,o,s,l,c,f)=>{const u=t.addAttributeArrayWithDivisor(n,r,i,a,o,s,l,c,f,!0);if(!u)return u;const d=e.context,h=d.getAttribLocation(e.handleProgram,i);for(let p=1;p<l;p++)d.enableVertexAttribArray(h+p),d.vertexAttribPointer(h+p,l,s,c,o,a+o*p/l),f>0&&(e.instancingExtension?e.instancingExtension.vertexAttribDivisorANGLE(h+p,1):d.vertexAttribDivisor(h+p,1));return!0},t.removeAttributeArray=n=>{if(!t.isReady()||e.handleProgram===0)return!1;if(!e.supported)for(let r=0;r<e.buffers.length;++r){const i=e.buffers[r];for(let a=0;a<i.attributes.length;++a)if(i.attributes[a].name===n)return i.attributes.splice(a,1),i.attributes.length||e.buffers.splice(r,1),!0}return!0},t.setOpenGLRenderWindow=n=>{e._openGLRenderWindow!==n&&(t.releaseGraphicsResources(),e._openGLRenderWindow=n,e.context=null,n&&(e.context=e._openGLRenderWindow.getContext()))}}const C4e={forceEmulation:!1,handleVAO:0,handleProgram:0,supported:!0,buffers:null,context:null};function ZY(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,C4e,n),e.buffers=[],ce.obj(t,e),ce.get(t,e,["supported"]),ce.setGet(t,e,["forceEmulation"]),w4e(t,e)}const S4e=ce.newInstance(ZY,"vtkOpenGLVertexArrayObject");var M7={newInstance:S4e,extend:ZY};const Ed={Start:0,Points:0,Lines:1,Tris:2,TriStrips:3,TrisEdges:4,TriStripsEdges:5,End:6};function T4e(t,e){e.classHierarchy.push("vtkOpenGLHelper"),t.setOpenGLRenderWindow=n=>{e.context=n.getContext(),e.program.setContext(e.context),e.VAO.setOpenGLRenderWindow(n),e.CABO.setOpenGLRenderWindow(n)},t.releaseGraphicsResources=n=>{e.VAO.releaseGraphicsResources(),e.CABO.releaseGraphicsResources(),e.CABO.setElementCount(0)},t.drawArrays=(n,r,i,a)=>{if(e.CABO.getElementCount()){const o=t.getOpenGLMode(i),s=t.haveWideLines(n,r),l=e.context,c=l.getParameter(l.DEPTH_WRITEMASK);e.pointPicking&&l.depthMask(!1),o===l.LINES&&s?(t.updateShaders(n,r,a),l.drawArraysInstanced(o,0,e.CABO.getElementCount(),2*Math.ceil(r.getProperty().getLineWidth()))):(l.lineWidth(r.getProperty().getLineWidth()),t.updateShaders(n,r,a),l.drawArrays(o,0,e.CABO.getElementCount()),l.lineWidth(1));const u=(o===l.POINTS?1:0)||(o===l.LINES?2:3);return e.pointPicking&&l.depthMask(c),e.CABO.getElementCount()/u}return 0},t.getOpenGLMode=n=>{if(e.pointPicking)return e.context.POINTS;const r=e.primitiveType;return n===go.POINTS||r===Ed.Points?e.context.POINTS:n===go.WIREFRAME||r===Ed.Lines||r===Ed.TrisEdges||r===Ed.TriStripsEdges?e.context.LINES:e.context.TRIANGLES},t.haveWideLines=(n,r)=>r.getProperty().getLineWidth()>1?!(e.CABO.getOpenGLRenderWindow()&&e.CABO.getOpenGLRenderWindow().getHardwareMaximumLineWidth()>=r.getProperty().getLineWidth()):!1,t.getNeedToRebuildShaders=(n,r,i)=>!!(i.getNeedToRebuildShaders(t,n,r)||t.getProgram()===0||t.getShaderSourceTime().getMTime()<i.getMTime()||t.getShaderSourceTime().getMTime()<r.getMTime()),t.updateShaders=(n,r,i)=>{if(t.getNeedToRebuildShaders(n,r,i)){const a={Vertex:null,Fragment:null,Geometry:null};i.buildShaders(a,n,r);const o=e.CABO.getOpenGLRenderWindow().getShaderCache().readyShaderProgramArray(a.Vertex,a.Fragment,a.Geometry);o!==t.getProgram()&&(t.setProgram(o),t.getVAO().releaseGraphicsResources()),t.getShaderSourceTime().modified()}else e.CABO.getOpenGLRenderWindow().getShaderCache().readyShaderProgram(t.getProgram());t.getVAO().bind(),i.setMapperShaderParameters(t,n,r),i.setPropertyShaderParameters(t,n,r),i.setCameraShaderParameters(t,n,r),i.setLightingShaderParameters(t,n,r),i.invokeShaderCallbacks(t,n,r)},t.setMapperShaderParameters=(n,r,i)=>{if(t.haveWideLines(n,r)){t.getProgram().setUniform2f("viewportSize",i.usize,i.vsize);const a=parseFloat(r.getProperty().getLineWidth()),o=a/2;t.getProgram().setUniformf("lineWidthStepSize",a/Math.ceil(a)),t.getProgram().setUniformf("halfLineWidth",o)}e.primitiveType===Ed.Points||r.getProperty().getRepresentation()===go.POINTS?t.getProgram().setUniformf("pointSize",r.getProperty().getPointSize()):e.pointPicking&&t.getProgram().setUniformf("pointSize",t.getPointPickingPrimitiveSize())},t.replaceShaderPositionVC=(n,r,i)=>{let a=n.Vertex;a=$e.substitute(a,"//VTK::PositionVC::Dec",["//VTK::PositionVC::Dec","uniform float pointSize;"]).result,a=$e.substitute(a,"//VTK::PositionVC::Impl",["//VTK::PositionVC::Impl","  gl_PointSize = pointSize;"],!1).result,t.getOpenGLMode(i.getProperty().getRepresentation())===e.context.LINES&&t.haveWideLines(r,i)&&(a=$e.substitute(a,"//VTK::PositionVC::Dec",["//VTK::PositionVC::Dec","uniform vec2 viewportSize;","uniform float lineWidthStepSize;","uniform float halfLineWidth;"]).result,a=$e.substitute(a,"//VTK::PositionVC::Impl",["//VTK::PositionVC::Impl"," if (halfLineWidth > 0.0)","   {","   float offset = float(gl_InstanceID / 2) * lineWidthStepSize - halfLineWidth;","   vec4 tmpPos = gl_Position;","   vec3 tmpPos2 = tmpPos.xyz / tmpPos.w;","   tmpPos2.x = tmpPos2.x + 2.0 * mod(float(gl_InstanceID), 2.0) * offset / viewportSize[0];","   tmpPos2.y = tmpPos2.y + 2.0 * mod(float(gl_InstanceID + 1), 2.0) * offset / viewportSize[1];","   gl_Position = vec4(tmpPos2.xyz * tmpPos.w, tmpPos.w);","   }"]).result),n.Vertex=a},t.getPointPickingPrimitiveSize=()=>e.primitiveType===Ed.Points?2:e.primitiveType===Ed.Lines?4:6,t.getAllocatedGPUMemoryInBytes=()=>t.getCABO().getAllocatedGPUMemoryInBytes()}const E4e={context:null,program:null,shaderSourceTime:null,VAO:null,attributeUpdateTime:null,CABO:null,primitiveType:0,pointPicking:!1};function QY(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,E4e,n),ce.obj(t,e),e.shaderSourceTime={},ce.obj(e.shaderSourceTime),e.attributeUpdateTime={},ce.obj(e.attributeUpdateTime),ce.setGet(t,e,["program","shaderSourceTime","VAO","attributeUpdateTime","CABO","primitiveType","pointPicking"]),e.program=$e.newInstance(),e.VAO=M7.newInstance(),e.CABO=d4e.newInstance(),T4e(t,e)}const _4e=ce.newInstance(QY);var Du={newInstance:_4e,extend:QY,primTypes:Ed};const D4e=t=>t,pV=1e-6;let eJ=class{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.matrix=on(new Float64Array(16)),this.tmp=new Float64Array(3),this.angleConv=e?Dwe:D4e}rotateFromDirections(e,n){const r=new Float64Array(3),i=new Float64Array(3),a=new Float64Array(16);Br(r,e[0],e[1],e[2]),Br(i,n[0],n[1],n[2]),wc(r,r),wc(i,i);const o=K2(r,i);return o>=1?this:(Hg(this.tmp,r,i),Wg(this.tmp)<pV&&(Hg(this.tmp,[1,0,0],e),Wg(this.tmp)<pV&&Hg(this.tmp,[0,1,0],e)),_X(a,Math.acos(o),this.tmp),zn(this.matrix,this.matrix,a),this)}rotate(e,n){return Br(this.tmp,...n),wc(this.tmp,this.tmp),lc(this.matrix,this.matrix,this.angleConv(e),this.tmp),this}rotateX(e){return d7(this.matrix,this.matrix,this.angleConv(e)),this}rotateY(e){return h7(this.matrix,this.matrix,this.angleConv(e)),this}rotateZ(e){return p7(this.matrix,this.matrix,this.angleConv(e)),this}translate(e,n,r){return Br(this.tmp,e,n,r),di(this.matrix,this.matrix,this.tmp),this}scale(e,n,r){return Br(this.tmp,e,n,r),i0(this.matrix,this.matrix,this.tmp),this}multiply(e){return zn(this.matrix,this.matrix,e),this}multiply3x3(e){return zn(this.matrix,this.matrix,[e[0],e[1],e[2],0,e[3],e[4],e[5],0,e[6],e[7],e[8],0,0,0,0,1]),this}invert(){return Ea(this.matrix,this.matrix),this}identity(){return on(this.matrix),this}apply(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1;if(Iy(WD,this.matrix))return this;const i=r===-1?e.length:n+r*3;for(let a=n;a<i;a+=3)Br(this.tmp,e[a],e[a+1],e[a+2]),Gn(this.tmp,this.tmp,this.matrix),e[a]=this.tmp[0],e[a+1]=this.tmp[1],e[a+2]=this.tmp[2];return this}getMatrix(){return this.matrix}setMatrix(e){return e&&e.length===16&&Ri(this.matrix,e),this}};function O4e(){return new eJ(!0)}function M4e(){return new eJ(!1)}var $d={buildFromDegree:O4e,buildFromRadian:M4e};const I4e=[2,0,1,2,2,3,2,4,5,2,6,7,2,0,2,2,1,3,2,4,6,2,5,7,2,0,4,2,1,5,2,2,6,2,3,7],R4e=[4,0,1,3,2,4,4,6,7,5,4,8,10,11,9,4,12,13,15,14,4,16,18,19,17,4,20,21,23,22];function P4e(t,e){e.classHierarchy.push("vtkCubeSource");function n(r,i){if(e.deleted)return;const a=ca.newInstance();i[0]=a;const o=24,s=ce.newTypedArray(e.pointType,o*3);a.getPoints().setData(s,3);const l=ce.newTypedArray(e.pointType,o*3),c=tn.newInstance({name:"Normals",values:l,numberOfComponents:3});a.getPointData().setNormals(c);let f=2;e.generate3DTextureCoordinates===!0&&(f=3);const u=ce.newTypedArray(e.pointType,o*f),d=tn.newInstance({name:"TextureCoordinates",values:u,numberOfComponents:f});a.getPointData().setTCoords(d);const h=[0,0,0],p=[0,0,0],g=[0,0];let m=0;h[0]=-e.xLength/2,p[0]=-1,p[1]=0,p[2]=0;for(let y=0;y<2;y++){h[1]=-e.yLength/2;for(let v=0;v<2;v++){g[1]=h[1]+.5,h[2]=-e.zLength/2;for(let x=0;x<2;x++)g[0]=(h[2]+.5)*(1-2*y),s[m*3]=h[0],s[m*3+1]=h[1],s[m*3+2]=h[2],l[m*3]=p[0],l[m*3+1]=p[1],l[m*3+2]=p[2],f===2?(u[m*f]=g[0],u[m*f+1]=g[1]):(u[m*f]=2*y-1,u[m*f+1]=2*v-1,u[m*f+2]=2*x-1),m++,h[2]+=e.zLength;h[1]+=e.yLength}h[0]+=e.xLength,p[0]+=2}h[1]=-e.yLength/2,p[1]=-1,p[0]=0,p[2]=0;for(let y=0;y<2;y++){h[0]=-e.xLength/2;for(let v=0;v<2;v++){g[0]=(h[0]+.5)*(2*y-1),h[2]=-e.zLength/2;for(let x=0;x<2;x++)g[1]=(h[2]+.5)*-1,s[m*3]=h[0],s[m*3+1]=h[1],s[m*3+2]=h[2],l[m*3]=p[0],l[m*3+1]=p[1],l[m*3+2]=p[2],f===2?(u[m*f]=g[0],u[m*f+1]=g[1]):(u[m*f]=2*v-1,u[m*f+1]=2*y-1,u[m*f+2]=2*x-1),m++,h[2]+=e.zLength;h[0]+=e.xLength}h[1]+=e.yLength,p[1]+=2}h[2]=-e.zLength/2,p[2]=-1,p[0]=0,p[1]=0;for(let y=0;y<2;y++){h[1]=-e.yLength/2;for(let v=0;v<2;v++){g[1]=h[1]+.5,h[0]=-e.xLength/2;for(let x=0;x<2;x++)g[0]=(h[0]+.5)*(2*y-1),s[m*3]=h[0],s[m*3+1]=h[1],s[m*3+2]=h[2],l[m*3]=p[0],l[m*3+1]=p[1],l[m*3+2]=p[2],f===2?(u[m*f]=g[0],u[m*f+1]=g[1]):(u[m*f]=2*x-1,u[m*f+1]=2*v-1,u[m*f+2]=2*y-1),m++,h[0]+=e.xLength;h[1]+=e.yLength}h[2]+=e.zLength,p[2]+=2}if(e.rotations&&$d.buildFromDegree().rotateX(e.rotations[0]).rotateY(e.rotations[1]).rotateZ(e.rotations[2]).apply(s).apply(l),e.center&&$d.buildFromRadian().translate(...e.center).apply(s),e.matrix){$d.buildFromRadian().setMatrix(e.matrix).apply(s);const y=[e.matrix[0],e.matrix[1],e.matrix[2],0,e.matrix[4],e.matrix[5],e.matrix[6],0,e.matrix[8],e.matrix[9],e.matrix[10],0,0,0,0,1];$d.buildFromRadian().setMatrix(y).apply(l)}e.generateFaces?a.getPolys().deepCopy(e._polys):a.getPolys().initialize(),e.generateLines?(a.getLines().deepCopy(e._lineCells),a.getPointData().setNormals(null)):a.getLines().initialize(),a.modified()}t.setBounds=function(){let r=[];if(Array.isArray(arguments.length<=0?void 0:arguments[0]))r=arguments.length<=0?void 0:arguments[0];else for(let i=0;i<arguments.length;i++)r.push(i<0||arguments.length<=i?void 0:arguments[i]);r.length===6&&(t.setXLength(r[1]-r[0]),t.setYLength(r[3]-r[2]),t.setZLength(r[5]-r[4]),t.setCenter([(r[0]+r[1])/2,(r[2]+r[3])/2,(r[4]+r[5])/2]))},t.requestData=n}const A4e={xLength:1,yLength:1,zLength:1,pointType:"Float64Array",generate3DTextureCoordinates:!1,generateFaces:!0,generateLines:!1};function tJ(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,A4e,n),ce.obj(t,e),ce.setGet(t,e,["xLength","yLength","zLength","generate3DTextureCoordinates","generateFaces","generateLines"]),ce.setGetArray(t,e,["center","rotations"],3),ce.setGetArray(t,e,["matrix"],16),e._polys=Uh.newInstance({values:Uint16Array.from(R4e)}),e._lineCells=Uh.newInstance({values:Uint16Array.from(I4e)}),ce.moveToProtected(t,e,["polys","lineCells"]),ce.algo(t,e,0,1),P4e(t,e)}const N4e=ce.newInstance(tJ,"vtkCubeSource");var L4e={newInstance:N4e,extend:tJ};const{vtkErrorMacro:gV}=ce;function k4e(t,e){e.classHierarchy.push("vtkImageDataOutlineFilter");const n={...t};t.requestData=(r,i)=>{const a=r[0];if(!a||!a.isA("vtkImageData")){gV("Invalid or missing input");return}const o=a.getSpatialExtent();if(!o){gV("Unable to fetch spatial extents of input image.");return}e._cubeSource.setBounds(o),e._cubeSource.setMatrix(a.getIndexToWorld()),i[0]=e._cubeSource.getOutputData()},t.getMTime=()=>Math.max(n.getMTime(),e._cubeSource.getMTime()),t.setGenerateFaces=e._cubeSource.setGenerateFaces,t.setGenerateLines=e._cubeSource.setGenerateLines,t.getGenerateFaces=e._cubeSource.getGenerateFaces,t.getGenerateLines=e._cubeSource.getGenerateLines}const V4e={};function nJ(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,V4e,n),ce.obj(t,e),ce.algo(t,e,1,1),e._cubeSource=L4e.newInstance(),ce.moveToProtected(t,e,["cubeSource","tmpOut"]),k4e(t,e)}const F4e=ce.newInstance(nJ,"vtkImageDataOutlineFilter");var U4e={newInstance:F4e,extend:nJ};const q2={CLAMP_TO_EDGE:0,REPEAT:1,MIRRORED_REPEAT:2},an={NEAREST:0,LINEAR:1,NEAREST_MIPMAP_NEAREST:2,NEAREST_MIPMAP_LINEAR:3,LINEAR_MIPMAP_NEAREST:4,LINEAR_MIPMAP_LINEAR:5};var rJ={Wrap:q2,Filter:an};const iJ=new Float32Array(1),B4e=new Int32Array(iJ.buffer);function $4e(t){iJ[0]=t;const e=B4e[0];let n=e>>16&32768,r=e>>12&2047;const i=e>>23&255;return i<103?n:i>142?(n|=31744,n|=(i===255?0:1)&&e&8388607,n):i<113?(r|=2048,n|=(r>>114-i)+(r>>113-i&1),n):(n|=i-112<<10|r>>1,n+=r&1,n)}function G4e(t){const e=(t&32768)>>15,n=(t&31744)>>10,r=t&1023;return n===0?(e?-1:1)*2**-14*(r/2**10):n===31?r?NaN:(e?-1:1)*(1/0):(e?-1:1)*2**(n-15)*(1+r/2**10)}var th={fromHalf:G4e,toHalf:$4e};function j4e(){try{const r=new Int16Array([0,32767]),i=[1,1],a=document.createElement("canvas");a.width=4,a.height=4;const o=a.getContext("webgl2");if(!o)return!1;const s=o.getExtension("EXT_texture_norm16");if(!s)return!1;const l=`#version 300 es
    void main() {
      gl_PointSize = ${4 .toFixed(1)};
      gl_Position = vec4(0, 0, 0, 1);
    }
  `,c=`#version 300 es
    precision highp float;
    precision highp int;
    precision highp sampler2D;

    uniform sampler2D u_image;

    out vec4 color;

    void main() {
        vec4 intColor = texture(u_image, gl_PointCoord.xy);
        color = vec4(vec3(intColor.rrr), 1);
    }
    `,f=o.createShader(o.VERTEX_SHADER);if(o.shaderSource(f,l),o.compileShader(f),!o.getShaderParameter(f,o.COMPILE_STATUS))return!1;const u=o.createShader(o.FRAGMENT_SHADER);if(o.shaderSource(u,c),o.compileShader(u),!o.getShaderParameter(u,o.COMPILE_STATUS))return!1;const d=o.createProgram();if(o.attachShader(d,f),o.attachShader(d,u),o.linkProgram(d),!o.getProgramParameter(d,o.LINK_STATUS))return!1;const h=o.createTexture();o.bindTexture(o.TEXTURE_2D,h),o.texImage2D(o.TEXTURE_2D,0,s.R16_SNORM_EXT,2,1,0,o.RED,o.SHORT,r),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR),o.useProgram(d),o.drawArrays(o.POINTS,0,1);const p=new Uint8Array(4);o.readPixels(i[0],i[1],1,1,o.RGBA,o.UNSIGNED_BYTE,p);const[g,m,y]=p,v=o.getExtension("WEBGL_lose_context");return v&&v.loseContext(),g===m&&m===y&&g!==0}catch{return!1}}let GE;function z4e(){return GE===void 0&&(GE=j4e()),GE}const{Wrap:gf,Filter:Aa}=rJ,{VtkDataTypes:ar}=tn,{vtkDebugMacro:jE,vtkErrorMacro:kp,vtkWarningMacro:mV}=wo,{toHalf:W4e}=th;function H4e(t,e){e.classHierarchy.push("vtkOpenGLTexture");function n(){return{internalFormat:e.internalFormat,format:e.format,openGLDataType:e.openGLDataType,width:e.width,height:e.height}}t.render=function(){let p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;if(p?e._openGLRenderWindow=p:(e._openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e._openGLRenderWindow=e._openGLRenderer.getLastAncestorOfType("vtkOpenGLRenderWindow")),e.context=e._openGLRenderWindow.getContext(),e.renderable.getInterpolate()?(e.generateMipmap?t.setMinificationFilter(Aa.LINEAR_MIPMAP_LINEAR):t.setMinificationFilter(Aa.LINEAR),t.setMagnificationFilter(Aa.LINEAR)):(t.setMinificationFilter(Aa.NEAREST),t.setMagnificationFilter(Aa.NEAREST)),e.renderable.getRepeat()&&(t.setWrapR(gf.REPEAT),t.setWrapS(gf.REPEAT),t.setWrapT(gf.REPEAT)),e.renderable.getInputData()&&e.renderable.setImage(null),!e.handle||e.renderable.getMTime()>e.textureBuildTime.getMTime()){if(e.renderable.getImage()!==null&&(e.renderable.getInterpolate()&&(e.generateMipmap=!0,t.setMinificationFilter(Aa.LINEAR_MIPMAP_LINEAR)),e.renderable.getImage()&&e.renderable.getImageLoaded()&&(t.create2DFromImage(e.renderable.getImage()),t.activate(),t.sendParameters(),e.textureBuildTime.modified())),e.renderable.getCanvas()!==null){e.renderable.getInterpolate()&&(e.generateMipmap=!0,t.setMinificationFilter(Aa.LINEAR_MIPMAP_LINEAR));const m=e.renderable.getCanvas();t.create2DFromRaw(m.width,m.height,4,ar.UNSIGNED_CHAR,m,!0),t.activate(),t.sendParameters(),e.textureBuildTime.modified()}if(e.renderable.getJsImageData()!==null){const m=e.renderable.getJsImageData();e.renderable.getInterpolate()&&(e.generateMipmap=!0,t.setMinificationFilter(Aa.LINEAR_MIPMAP_LINEAR)),t.create2DFromRaw(m.width,m.height,4,ar.UNSIGNED_CHAR,m.data,!0),t.activate(),t.sendParameters(),e.textureBuildTime.modified()}const g=e.renderable.getInputData(0);if(g&&g.getPointData().getScalars()){const m=g.getExtent(),y=g.getPointData().getScalars(),v=[];for(let x=0;x<e.renderable.getNumberOfInputPorts();++x){const w=e.renderable.getInputData(x),S=w?w.getPointData().getScalars().getData():null;S&&v.push(S)}e.renderable.getInterpolate()&&y.getNumberOfComponents()===4&&(e.generateMipmap=!0,t.setMinificationFilter(Aa.LINEAR_MIPMAP_LINEAR)),v.length%6===0?t.createCubeFromRaw(m[1]-m[0]+1,m[3]-m[2]+1,y.getNumberOfComponents(),y.getDataType(),v):t.create2DFromRaw(m[1]-m[0]+1,m[3]-m[2]+1,y.getNumberOfComponents(),y.getDataType(),y.getData()),t.activate(),t.sendParameters(),e.textureBuildTime.modified()}}e.handle&&t.activate()};const r=()=>{if(!((e.minificationFilter===Aa.LINEAR||e.magnificationFilter===Aa.LINEAR)&&!z4e()))return e.oglNorm16Ext};t.destroyTexture=()=>{t.deactivate(),e.context&&e.handle&&e.context.deleteTexture(e.handle),e._prevTexParams=null,e.handle=0,e.numberOfDimensions=0,e.target=0,e.components=0,e.width=0,e.height=0,e.depth=0,t.resetFormatAndType()},t.createTexture=()=>{e.handle||(e.handle=e.context.createTexture(),e.target&&(e.context.bindTexture(e.target,e.handle),e.context.texParameteri(e.target,e.context.TEXTURE_MIN_FILTER,t.getOpenGLFilterMode(e.minificationFilter)),e.context.texParameteri(e.target,e.context.TEXTURE_MAG_FILTER,t.getOpenGLFilterMode(e.magnificationFilter)),e.context.texParameteri(e.target,e.context.TEXTURE_WRAP_S,t.getOpenGLWrapMode(e.wrapS)),e.context.texParameteri(e.target,e.context.TEXTURE_WRAP_T,t.getOpenGLWrapMode(e.wrapT)),e._openGLRenderWindow.getWebgl2()&&e.context.texParameteri(e.target,e.context.TEXTURE_WRAP_R,t.getOpenGLWrapMode(e.wrapR)),e.context.bindTexture(e.target,null)))},t.getTextureUnit=()=>e._openGLRenderWindow?e._openGLRenderWindow.getTextureUnitForTexture(t):-1,t.activate=()=>{e._openGLRenderWindow.activateTexture(t),t.bind()},t.deactivate=()=>{e._openGLRenderWindow&&e._openGLRenderWindow.deactivateTexture(t)},t.releaseGraphicsResources=p=>{p&&e.handle&&(p.activateTexture(t),p.deactivateTexture(t),e.context.deleteTexture(e.handle),e._prevTexParams=null,e.handle=0,e.numberOfDimensions=0,e.target=0,e.internalFormat=0,e.format=0,e.openGLDataType=0,e.components=0,e.width=0,e.height=0,e.depth=0,e.allocatedGPUMemoryInBytes=0),e.shaderProgram&&(e.shaderProgram.releaseGraphicsResources(p),e.shaderProgram=null)},t.bind=()=>{e.context.bindTexture(e.target,e.handle),e.autoParameters&&t.getMTime()>e.sendParametersTime.getMTime()&&t.sendParameters()},t.isBound=()=>{let p=!1;if(e.context&&e.handle){let g=0;switch(e.target){case e.context.TEXTURE_2D:g=e.context.TEXTURE_BINDING_2D;break;default:mV("impossible case");break}p=e.context.getIntegerv(g)===e.handle}return p},t.sendParameters=()=>{e.context.texParameteri(e.target,e.context.TEXTURE_WRAP_S,t.getOpenGLWrapMode(e.wrapS)),e.context.texParameteri(e.target,e.context.TEXTURE_WRAP_T,t.getOpenGLWrapMode(e.wrapT)),e._openGLRenderWindow.getWebgl2()&&e.context.texParameteri(e.target,e.context.TEXTURE_WRAP_R,t.getOpenGLWrapMode(e.wrapR)),e.context.texParameteri(e.target,e.context.TEXTURE_MIN_FILTER,t.getOpenGLFilterMode(e.minificationFilter)),e.context.texParameteri(e.target,e.context.TEXTURE_MAG_FILTER,t.getOpenGLFilterMode(e.magnificationFilter)),e._openGLRenderWindow.getWebgl2()&&(e.context.texParameteri(e.target,e.context.TEXTURE_BASE_LEVEL,e.baseLevel),e.context.texParameteri(e.target,e.context.TEXTURE_MAX_LEVEL,e.maxLevel)),e.sendParametersTime.modified()},t.getInternalFormat=(p,g)=>(e._forceInternalFormat||(e.internalFormat=t.getDefaultInternalFormat(p,g)),e.internalFormat||jE(`Unable to find suitable internal format for T=${p} NC= ${g}`),[e.context.R32F,e.context.RG32F,e.context.RGB32F,e.context.RGBA32F].includes(e.internalFormat)&&!e.context.getExtension("OES_texture_float_linear")&&mV("Failed to load OES_texture_float_linear. Texture filtering is not available for *32F internal formats."),e.internalFormat),t.getDefaultInternalFormat=(p,g)=>{let m=0;return m=e._openGLRenderWindow.getDefaultTextureInternalFormat(p,g,r(),t.useHalfFloat()),m||(m||(jE("Unsupported internal texture type!"),jE(`Unable to find suitable internal format for T=${p} NC= ${g}`)),m)},t.useHalfFloat=()=>e.enableUseHalfFloat&&e.canUseHalfFloat,t.setInternalFormat=p=>{e._forceInternalFormat=!0,p!==e.internalFormat&&(e.internalFormat=p,t.modified())},t.getFormat=(p,g)=>(e.format=t.getDefaultFormat(p,g),e.format),t.getDefaultFormat=(p,g)=>{if(e._openGLRenderWindow.getWebgl2())switch(g){case 1:return e.context.RED;case 2:return e.context.RG;case 3:return e.context.RGB;case 4:return e.context.RGBA;default:return e.context.RGB}else switch(g){case 1:return e.context.LUMINANCE;case 2:return e.context.LUMINANCE_ALPHA;case 3:return e.context.RGB;case 4:return e.context.RGBA;default:return e.context.RGB}},t.resetFormatAndType=()=>{e._prevTexParams=null,e.format=0,e.internalFormat=0,e._forceInternalFormat=!1,e.openGLDataType=0},t.getDefaultDataType=p=>{const g=t.useHalfFloat();if(e._openGLRenderWindow.getWebgl2())switch(p){case ar.UNSIGNED_CHAR:return e.context.UNSIGNED_BYTE;case(r()&&!g&&ar.SHORT):return e.context.SHORT;case(r()&&!g&&ar.UNSIGNED_SHORT):return e.context.UNSIGNED_SHORT;case(g&&ar.SHORT):return e.context.HALF_FLOAT;case(g&&ar.UNSIGNED_SHORT):return e.context.HALF_FLOAT;case ar.FLOAT:case ar.VOID:default:return e.context.FLOAT}switch(p){case ar.UNSIGNED_CHAR:return e.context.UNSIGNED_BYTE;case ar.FLOAT:case ar.VOID:default:if(e.context.getExtension("OES_texture_float")&&e.context.getExtension("OES_texture_float_linear"))return e.context.FLOAT;{const m=e.context.getExtension("OES_texture_half_float");if(m&&e.context.getExtension("OES_texture_half_float_linear"))return m.HALF_FLOAT_OES}return e.context.UNSIGNED_BYTE}},t.getOpenGLDataType=function(p){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return(!e.openGLDataType||g)&&(e.openGLDataType=t.getDefaultDataType(p)),e.openGLDataType},t.getShiftAndScale=()=>{let p=0,g=1;switch(e.openGLDataType){case e.context.BYTE:g=127.5,p=g-128;break;case e.context.UNSIGNED_BYTE:g=255,p=0;break;case e.context.SHORT:g=32767.5,p=g-32768;break;case e.context.UNSIGNED_SHORT:g=65536,p=0;break;case e.context.INT:g=21474836475e-1,p=g-2147483648;break;case e.context.UNSIGNED_INT:g=4294967295,p=0;break;case e.context.FLOAT:}return{shift:p,scale:g}},t.getOpenGLFilterMode=p=>{switch(p){case Aa.NEAREST:return e.context.NEAREST;case Aa.LINEAR:return e.context.LINEAR;case Aa.NEAREST_MIPMAP_NEAREST:return e.context.NEAREST_MIPMAP_NEAREST;case Aa.NEAREST_MIPMAP_LINEAR:return e.context.NEAREST_MIPMAP_LINEAR;case Aa.LINEAR_MIPMAP_NEAREST:return e.context.LINEAR_MIPMAP_NEAREST;case Aa.LINEAR_MIPMAP_LINEAR:return e.context.LINEAR_MIPMAP_LINEAR;default:return e.context.NEAREST}},t.getOpenGLWrapMode=p=>{switch(p){case gf.CLAMP_TO_EDGE:return e.context.CLAMP_TO_EDGE;case gf.REPEAT:return e.context.REPEAT;case gf.MIRRORED_REPEAT:return e.context.MIRRORED_REPEAT;default:return e.context.CLAMP_TO_EDGE}};function i(p){const[g,m,y,v,x,w]=p;return[m-g+1,v-y+1,w-x+1]}function a(p){const[g,m,y]=i(p);return g*m*y}function o(p,g,m,y,v){const[x,w,S,T,_,D]=m,[I,R]=g,O=I*R;let P=v;for(let N=_;N<=D;N++){const A=N*O;for(let B=S;B<=T;B++){const V=A+B*I;for(let $=V+x,U=V+w;$<=U;$++,P++)y[P]=p[$]}}}function s(p,g){const y=(arguments.length>2&&arguments[2]!==void 0?arguments[2]:null)||p.constructor,v=g.reduce((T,_)=>T+a(_),0),x=new y(v),w=[e.width,e.height,e.depth];let S=0;return g.forEach(T=>{o(p,w,T,x,S),S+=a(T)}),x}t.updateArrayDataTypeForGL=function(p,g){let m=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,y=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[];const v=[];let x=e.width*e.height*e.components;m&&(x*=e.depth);const w=!!y.length;if(p!==ar.FLOAT&&e.openGLDataType===e.context.FLOAT)for(let T=0;T<g.length;T++)if(g[T])if(w)v.push(s(g[T],y,Float32Array));else{const _=g[T].length>x?g[T].subarray(0,x):g[T];v.push(new Float32Array(_))}else v.push(null);if(p!==ar.UNSIGNED_CHAR&&e.openGLDataType===e.context.UNSIGNED_BYTE)for(let T=0;T<g.length;T++)if(g[T])if(w)v.push(s(g[T],y,Uint8Array));else{const _=g[T].length>x?g[T].subarray(0,x):g[T];v.push(new Uint8Array(_))}else v.push(null);let S=!1;if(e._openGLRenderWindow.getWebgl2())S=e.openGLDataType===e.context.HALF_FLOAT;else{const T=e.context.getExtension("OES_texture_half_float");S=T&&e.openGLDataType===T.HALF_FLOAT_OES}if(S)for(let T=0;T<g.length;T++)if(g[T]){const _=w?s(g[T],y):g[T],D=new Uint16Array(w?_.length:x),I=D.length;for(let R=0;R<I;R++)D[R]=W4e(_[R]);v.push(D)}else v.push(null);if(v.length===0)for(let T=0;T<g.length;T++)v.push(w&&g[T]?s(g[T],y):g[T]);return v};function l(p){if(e._openGLRenderWindow.getWebgl2())return p;const g=[],m=e.width,y=e.height,v=e.components;if(p&&(!_v(m)||!_v(y))){const x=e.context.getExtension("OES_texture_half_float"),w=Al(m),S=Al(y),T=w*S*e.components;for(let _=0;_<p.length;_++)if(p[_]!==null){let D=null;const I=y/S,R=m/w;let O=!1;e.openGLDataType===e.context.FLOAT?D=new Float32Array(T):x&&e.openGLDataType===x.HALF_FLOAT_OES?(D=new Uint16Array(T),O=!0):D=new Uint8Array(T);for(let P=0;P<S;P++){const N=P*w*v,A=P*I;let B=Math.floor(A),V=Math.ceil(A);V>=y&&(V=y-1);const $=A-B,U=1-$;B=B*m*v,V=V*m*v;for(let G=0;G<w;G++){const F=G*v,J=G*R;let Q=Math.floor(J),ne=Math.ceil(J);ne>=m&&(ne=m-1);const ye=J-Q;Q*=v,ne*=v;for(let ve=0;ve<v;ve++)O?D[N+F+ve]=th.toHalf(th.fromHalf(p[_][B+Q+ve])*U*(1-ye)+th.fromHalf(p[_][B+ne+ve])*U*ye+th.fromHalf(p[_][V+Q+ve])*$*(1-ye)+th.fromHalf(p[_][V+ne+ve])*$*ye):D[N+F+ve]=p[_][B+Q+ve]*U*(1-ye)+p[_][B+ne+ve]*U*ye+p[_][V+Q+ve]*$*(1-ye)+p[_][V+ne+ve]*$*ye}}g.push(D),e.width=w,e.height=S}else g.push(null)}if(g.length===0)for(let x=0;x<p.length;x++)g.push(p[x]);return g}function c(p){return e._openGLRenderWindow?e.resizable||e.renderable?.getResizable()?!1:e._openGLRenderWindow.getWebgl2()?!(e._openGLRenderWindow.getGLInformations().RENDERER.value.match(/WebKit/gi)&&navigator.platform.match(/Mac/gi)&&r()&&(p===ar.UNSIGNED_SHORT||p===ar.SHORT)):!1:!1}t.create2DFromRaw=function(p,g,m,y,v){let x=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!1;if(t.getOpenGLDataType(y,!0),t.getInternalFormat(y,m),t.getFormat(y,m),!e.internalFormat||!e.format||!e.openGLDataType)return kp("Failed to determine texture parameters."),!1;e.target=e.context.TEXTURE_2D,e.components=m,e.width=p,e.height=g,e.depth=1,e.numberOfDimensions=2,e._openGLRenderWindow.activateTexture(t),t.createTexture(),t.bind();const w=[v],S=t.updateArrayDataTypeForGL(y,w),T=l(S);return e.context.pixelStorei(e.context.UNPACK_FLIP_Y_WEBGL,x),e.context.pixelStorei(e.context.UNPACK_ALIGNMENT,1),c(y)?(e.context.texStorage2D(e.target,1,e.internalFormat,e.width,e.height),T[0]!=null&&e.context.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.openGLDataType,T[0])):e.context.texImage2D(e.target,0,e.internalFormat,e.width,e.height,0,e.format,e.openGLDataType,T[0]),e.generateMipmap&&e.context.generateMipmap(e.target),x&&e.context.pixelStorei(e.context.UNPACK_FLIP_Y_WEBGL,!1),e.allocatedGPUMemoryInBytes=e.width*e.height*e.depth*m*e._openGLRenderWindow.getDefaultTextureByteSize(y,r(),t.useHalfFloat()),t.deactivate(),!0},t.createCubeFromRaw=(p,g,m,y,v)=>{if(t.getOpenGLDataType(y),t.getInternalFormat(y,m),t.getFormat(y,m),!e.internalFormat||!e.format||!e.openGLDataType)return kp("Failed to determine texture parameters."),!1;e.target=e.context.TEXTURE_CUBE_MAP,e.components=m,e.width=p,e.height=g,e.depth=1,e.numberOfDimensions=2,e._openGLRenderWindow.activateTexture(t),e.maxLevel=v.length/6-1,t.createTexture(),t.bind();const x=t.updateArrayDataTypeForGL(y,v),w=l(x),S=[];let T=e.width,_=e.height;for(let D=0;D<w.length;D++){D%6===0&&D!==0&&(T/=2,_/=2),S[D]=$m(y,_*T*e.components);for(let I=0;I<_;++I){const R=I*T*e.components,O=(_-I-1)*T*e.components;S[D].set(w[D].slice(O,O+T*e.components),R)}}e.context.pixelStorei(e.context.UNPACK_ALIGNMENT,1),c(y)&&e.context.texStorage2D(e.target,6,e.internalFormat,e.width,e.height);for(let D=0;D<6;D++){let I=0,R=e.width,O=e.height;for(;R>=1&&O>=1;){let P=null;I<=e.maxLevel&&(P=S[6*I+D]),c(y)?P!=null&&e.context.texSubImage2D(e.context.TEXTURE_CUBE_MAP_POSITIVE_X+D,I,0,0,R,O,e.format,e.openGLDataType,P):e.context.texImage2D(e.context.TEXTURE_CUBE_MAP_POSITIVE_X+D,I,e.internalFormat,R,O,0,e.format,e.openGLDataType,P),I++,R/=2,O/=2}}return e.allocatedGPUMemoryInBytes=e.width*e.height*e.depth*m*e._openGLRenderWindow.getDefaultTextureByteSize(y,r(),t.useHalfFloat()),t.deactivate(),!0},t.createDepthFromRaw=(p,g,m,y)=>(t.getOpenGLDataType(m),e.format=e.context.DEPTH_COMPONENT,e._openGLRenderWindow.getWebgl2()?m===ar.FLOAT?e.internalFormat=e.context.DEPTH_COMPONENT32F:e.internalFormat=e.context.DEPTH_COMPONENT16:e.internalFormat=e.context.DEPTH_COMPONENT,!e.internalFormat||!e.format||!e.openGLDataType?(kp("Failed to determine texture parameters."),!1):(e.target=e.context.TEXTURE_2D,e.components=1,e.width=p,e.height=g,e.depth=1,e.numberOfDimensions=2,e._openGLRenderWindow.activateTexture(t),t.createTexture(),t.bind(),e.context.pixelStorei(e.context.UNPACK_ALIGNMENT,1),c(m)?(e.context.texStorage2D(e.target,1,e.internalFormat,e.width,e.height),y!=null&&e.context.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.openGLDataType,y)):e.context.texImage2D(e.target,0,e.internalFormat,e.width,e.height,0,e.format,e.openGLDataType,y),e.generateMipmap&&e.context.generateMipmap(e.target),e.allocatedGPUMemoryInBytes=e.width*e.height*e.depth*e.components*e._openGLRenderWindow.getDefaultTextureByteSize(m,r(),t.useHalfFloat()),t.deactivate(),!0)),t.create2DFromImage=p=>{if(t.getOpenGLDataType(ar.UNSIGNED_CHAR),t.getInternalFormat(ar.UNSIGNED_CHAR,4),t.getFormat(ar.UNSIGNED_CHAR,4),!e.internalFormat||!e.format||!e.openGLDataType)return kp("Failed to determine texture parameters."),!1;e.target=e.context.TEXTURE_2D,e.components=4,e.depth=1,e.numberOfDimensions=2,e._openGLRenderWindow.activateTexture(t),t.createTexture(),t.bind(),e.context.pixelStorei(e.context.UNPACK_ALIGNMENT,1);const g=!e._openGLRenderWindow.getWebgl2()&&(!_v(p.width)||!_v(p.height)),m=document.createElement("canvas");m.width=g?Al(p.width):p.width,m.height=g?Al(p.height):p.height,e.width=m.width,e.height=m.height;const y=m.getContext("2d");y.translate(0,m.height),y.scale(1,-1),y.drawImage(p,0,0,p.width,p.height,0,0,m.width,m.height);const v=m;return c(ar.UNSIGNED_CHAR)?(e.context.texStorage2D(e.target,1,e.internalFormat,e.width,e.height),v!=null&&e.context.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.openGLDataType,v)):e.context.texImage2D(e.target,0,e.internalFormat,e.width,e.height,0,e.format,e.openGLDataType,v),e.generateMipmap&&e.context.generateMipmap(e.target),e.allocatedGPUMemoryInBytes=e.width*e.height*e.depth*e.components*e._openGLRenderWindow.getDefaultTextureByteSize(ar.UNSIGNED_CHAR,r(),t.useHalfFloat()),t.deactivate(),!0};function f(p,g,m){const y=new Array(m),v=new Array(m);for(let x=0;x<m;++x)y[x]=p[x],v[x]=g[x]-p[x]||1;return{scale:v,offset:y}}function u(p,g){for(let m=0;m<p.length;m++){const y=p[m],v=g[m]+y;if(y<-2048||y>2048||v<-2048||v>2048)return!1}return!0}function d(p,g,m,y){t.getOpenGLDataType(p);const v=u(g,m)||y;let x=!1;if(e._openGLRenderWindow.getWebgl2())x=e.openGLDataType===e.context.FLOAT&&e.context.getExtension("OES_texture_float_linear")===null&&v||e.openGLDataType===e.context.HALF_FLOAT;else{const w=e.context.getExtension("OES_texture_half_float");x=w&&e.openGLDataType===w.HALF_FLOAT_OES}e.canUseHalfFloat=x&&v}function h(p,g){const m=p.getNumberOfComponents(),y=p.getDataType(),v=p.getData(),x=new Array(m),w=new Array(m);for(let T=0;T<m;++T){const[_,D]=p.getRange(T);x[T]=_,w[T]=D}const S=f(x,w,m);return d(y,S.offset,S.scale,g),t.useHalfFloat()||t.getOpenGLDataType(y,!0),{numComps:m,dataType:y,data:v,scaleOffsets:S}}t.create2DFilterableFromRaw=function(p,g,m,y,v){let x=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!1,w=arguments.length>6&&arguments[6]!==void 0?arguments[6]:void 0;return t.create2DFilterableFromDataArray(p,g,tn.newInstance({numberOfComponents:m,dataType:y,values:v,ranges:w}),x)},t.create2DFilterableFromDataArray=function(p,g,m){let y=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const{numComps:v,dataType:x,data:w}=h(m,y);t.create2DFromRaw(p,g,v,x,w)},t.updateVolumeInfoForGL=(p,g)=>{let m=!1;const y=t.useHalfFloat();(!e.volumeInfo?.scale||!e.volumeInfo?.offset)&&(e.volumeInfo={scale:new Array(g),offset:new Array(g)});for(let v=0;v<g;++v)e.volumeInfo.scale[v]=1,e.volumeInfo.offset[v]=0;if(r()&&!y&&p===ar.SHORT){for(let v=0;v<g;++v)e.volumeInfo.scale[v]=32767;m=!0}if(r()&&!y&&p===ar.UNSIGNED_SHORT){for(let v=0;v<g;++v)e.volumeInfo.scale[v]=65535;m=!0}if(p===ar.UNSIGNED_CHAR){for(let v=0;v<g;++v)e.volumeInfo.scale[v]=255;m=!0}return(p===ar.FLOAT||y&&(p===ar.SHORT||p===ar.UNSIGNED_SHORT))&&(m=!0),m},t.create3DFromRaw=function(p,g,m,y,v,x){let w=arguments.length>6&&arguments[6]!==void 0?arguments[6]:[],S=v,T=x;if(!t.updateVolumeInfoForGL(S,y)&&T){const N=p*g*m,A=structuredClone(e.volumeInfo),B=new Float32Array(N*y);e.volumeInfo.offset=A.offset,e.volumeInfo.scale=A.scale;let V=0;const $=A.scale.map(U=>1/U);for(let U=0;U<N;U++)for(let G=0;G<y;G++)B[V]=(T[V]-A.offset[G])*$[G],V++;S=ar.FLOAT,T=B}if(t.getOpenGLDataType(S),t.getInternalFormat(S,y),t.getFormat(S,y),!e.internalFormat||!e.format||!e.openGLDataType)return kp("Failed to determine texture parameters."),!1;e.target=e.context.TEXTURE_3D,e.components=y,e.width=p,e.height=g,e.depth=m,e.numberOfDimensions=3,e._openGLRenderWindow.activateTexture(t),t.createTexture(),t.bind();const _=w.length>0,D=!_||!kD(e._prevTexParams,n()),I=[T],O=t.updateArrayDataTypeForGL(S,I,!0,D?[]:w),P=l(O);if(e.context.pixelStorei(e.context.UNPACK_ALIGNMENT,1),D)c(S)?(e.context.texStorage3D(e.target,1,e.internalFormat,e.width,e.height,e.depth),P[0]!=null&&e.context.texSubImage3D(e.target,0,0,0,0,e.width,e.height,e.depth,e.format,e.openGLDataType,P[0])):e.context.texImage3D(e.target,0,e.internalFormat,e.width,e.height,e.depth,0,e.format,e.openGLDataType,P[0]),e._prevTexParams=n();else if(_){const N=P[0];let A=0;for(let B=0;B<w.length;B++){const V=w[B],$=i(V),U=a(V),G=new N.constructor(N.buffer,A,U);A+=G.byteLength,e.context.texSubImage3D(e.target,0,V[0],V[2],V[4],$[0],$[1],$[2],e.format,e.openGLDataType,G)}}return e.generateMipmap&&e.context.generateMipmap(e.target),e.allocatedGPUMemoryInBytes=e.width*e.height*e.depth*e.components*e._openGLRenderWindow.getDefaultTextureByteSize(S,r(),t.useHalfFloat()),t.deactivate(),!0},t.create3DFilterableFromRaw=function(p,g,m,y,v,x){let w=arguments.length>6&&arguments[6]!==void 0?arguments[6]:!1,S=arguments.length>7&&arguments[7]!==void 0?arguments[7]:void 0,T=arguments.length>8&&arguments[8]!==void 0?arguments[8]:[];return t.create3DFilterableFromDataArray(p,g,m,tn.newInstance({numberOfComponents:y,dataType:v,values:x,ranges:S}),w,T)},t.create3DFilterableFromDataArray=function(p,g,m,y){let v=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,x=arguments.length>5&&arguments[5]!==void 0?arguments[5]:[];const{numComps:w,dataType:S,data:T,scaleOffsets:_}=h(y,v),D=[],I=[];for(let Ce=0;Ce<w;++Ce)D[Ce]=0,I[Ce]=1;if(e.volumeInfo={scale:I,offset:D,dataComputedScale:_.scale,dataComputedOffset:_.offset,width:p,height:g,depth:m},e._openGLRenderWindow.getWebgl2())return t.create3DFromRaw(p,g,m,w,S,T,x);const R=p*g*m,O=structuredClone(_);let P=(Ce,we,Ae,Me,q)=>{Ce[we]=Ae},N=ar.UNSIGNED_CHAR;if(S===ar.UNSIGNED_CHAR)for(let Ce=0;Ce<w;++Ce)O.offset[Ce]=0,O.scale[Ce]=255;else e.context.getExtension("OES_texture_float")&&e.context.getExtension("OES_texture_float_linear")?(N=ar.FLOAT,P=(Ce,we,Ae,Me,q)=>{Ce[we]=(Ae-Me)/q}):(N=ar.UNSIGNED_CHAR,P=(Ce,we,Ae,Me,q)=>{Ce[we]=255*(Ae-Me)/q});if(t.getOpenGLDataType(N),t.getInternalFormat(N,w),t.getFormat(N,w),!e.internalFormat||!e.format||!e.openGLDataType)return kp("Failed to determine texture parameters."),!1;e.target=e.context.TEXTURE_2D,e.components=w,e.depth=1,e.numberOfDimensions=2;let A=e.context.getParameter(e.context.MAX_TEXTURE_SIZE);A>4096&&(N===ar.FLOAT||w>=3)&&(A=4096);let B=1,V=1;R>A*A&&(B=Math.ceil(Math.sqrt(R/(A*A))),V=B);let $=Math.sqrt(R)/B;$=Al($);const U=Math.floor($*B/p),G=Math.ceil(m/U),F=Al(g*G/V);e.width=$,e.height=F,e._openGLRenderWindow.activateTexture(t),t.createTexture(),t.bind(),e.volumeInfo.xreps=U,e.volumeInfo.yreps=G,e.volumeInfo.xstride=B,e.volumeInfo.ystride=V,e.volumeInfo.offset=O.offset,e.volumeInfo.scale=O.scale;let J;const Q=$*F*w;N===ar.FLOAT?J=new Float32Array(Q):J=new Uint8Array(Q);let ne=0;const ye=Math.floor(p/B),ve=Math.floor(g/V);for(let Ce=0;Ce<G;Ce++){const we=Math.min(U,m-Ce*U),Ae=w*(e.width-we*Math.floor(p/B));for(let Me=0;Me<ve;Me++){for(let q=0;q<we;q++){const k=w*((Ce*U+q)*p*g+V*Me*p);for(let Y=0;Y<ye;Y++)for(let X=0;X<w;X++)P(J,ne,T[k+B*Y*w+X],O.offset[X],O.scale[X]),ne++}ne+=Ae}}return e.context.pixelStorei(e.context.UNPACK_ALIGNMENT,1),c(N)?(e.context.texStorage2D(e.target,1,e.internalFormat,e.width,e.height),J!=null&&e.context.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.openGLDataType,J)):e.context.texImage2D(e.target,0,e.internalFormat,e.width,e.height,0,e.format,e.openGLDataType,J),t.deactivate(),!0},t.setOpenGLRenderWindow=p=>{e._openGLRenderWindow!==p&&(t.releaseGraphicsResources(),e._openGLRenderWindow=p,e.context=null,p&&(e.context=e._openGLRenderWindow.getContext()))},t.getMaximumTextureSize=p=>p&&p.isCurrent()?p.getIntegerv(p.MAX_TEXTURE_SIZE):-1,t.enableUseHalfFloat=p=>{e.enableUseHalfFloat=p}}const K4e={_openGLRenderWindow:null,_forceInternalFormat:!1,_prevTexParams:null,context:null,handle:0,sendParametersTime:null,textureBuildTime:null,numberOfDimensions:0,target:0,format:0,openGLDataType:0,components:0,width:0,height:0,depth:0,autoParameters:!0,wrapS:gf.CLAMP_TO_EDGE,wrapT:gf.CLAMP_TO_EDGE,wrapR:gf.CLAMP_TO_EDGE,minificationFilter:Aa.NEAREST,magnificationFilter:Aa.NEAREST,minLOD:-1e3,maxLOD:1e3,baseLevel:0,maxLevel:1e3,generateMipmap:!1,oglNorm16Ext:null,allocatedGPUMemoryInBytes:0,enableUseHalfFloat:!0,canUseHalfFloat:!1};function aJ(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,K4e,n),kr.extend(t,e,n),e.sendParametersTime={},Wr(e.sendParametersTime,{mtime:0}),e.textureBuildTime={},Wr(e.textureBuildTime,{mtime:0}),_y(t,e,["format","openGLDataType"]),Ni(t,e,["keyMatrixTime","minificationFilter","magnificationFilter","wrapS","wrapT","wrapR","generateMipmap","oglNorm16Ext"]),Fo(t,e,["width","height","volumeInfo","components","handle","target","allocatedGPUMemoryInBytes"]),Dy(t,e,["openGLRenderWindow"]),H4e(t,e)}const oJ=Qn(aJ,"vtkOpenGLTexture");var ai={newInstance:oJ,extend:aJ,...rJ};ha("vtkTexture",oJ);function q4e(t,e){t.replaceShaderCoincidentOffset=(n,r,i)=>{const a=t.getCoincidentParameters(r,i);if(a&&(a.factor!==0||a.offset!==0)){let o=n.Fragment;o=$e.substitute(o,"//VTK::Coincident::Dec",["uniform float cfactor;","uniform float coffset;"]).result,e.context.getExtension("EXT_frag_depth")&&(a.factor!==0?(o=$e.substitute(o,"//VTK::UniformFlow::Impl",["float cscale = length(vec2(dFdx(gl_FragCoord.z),dFdy(gl_FragCoord.z)));","//VTK::UniformFlow::Impl"],!1).result,o=$e.substitute(o,"//VTK::Depth::Impl","gl_FragDepthEXT = gl_FragCoord.z + cfactor*cscale + 0.000016*coffset;").result):o=$e.substitute(o,"//VTK::Depth::Impl","gl_FragDepthEXT = gl_FragCoord.z + 0.000016*coffset;").result),e._openGLRenderWindow.getWebgl2()&&(a.factor!==0?(o=$e.substitute(o,"//VTK::UniformFlow::Impl",["float cscale = length(vec2(dFdx(gl_FragCoord.z),dFdy(gl_FragCoord.z)));","//VTK::UniformFlow::Impl"],!1).result,o=$e.substitute(o,"//VTK::Depth::Impl","gl_FragDepth = gl_FragCoord.z + cfactor*cscale + 0.000016*coffset;").result):o=$e.substitute(o,"//VTK::Depth::Impl","gl_FragDepth = gl_FragCoord.z + 0.000016*coffset;").result),n.Fragment=o}}}function X4e(t,e){t.applyShaderReplacements=(n,r,i)=>{let a=null;if(r&&(a=r.ShaderReplacements),a)for(let o=0;o<a.length;o++){const s=a[o];if(i&&s.replaceFirst||!i&&!s.replaceFirst){const l=s.shaderType,c=n[l],f=$e.substitute(c,s.originalValue,s.replacementValue,s.replaceAll);n[l]=f.result}}},t.buildShaders=(n,r,i)=>{t.getReplacedShaderTemplate(n,r,i),e.lastRenderPassShaderReplacement=e.currentRenderPass?e.currentRenderPass.getShaderReplacement():null,e.lastRenderPassShaderReplacement&&e.lastRenderPassShaderReplacement(n);const a=e.renderable.getViewSpecificProperties().OpenGL;t.applyShaderReplacements(n,a,!0),t.replaceShaderValues(n,r,i),t.applyShaderReplacements(n,a)},t.getReplacedShaderTemplate=(n,r,i)=>{const a=e.renderable.getViewSpecificProperties().OpenGL;t.getShaderTemplate(n,r,i);let o=n.Vertex;if(a){const c=a.VertexShaderCode;c!==void 0&&c!==""&&(o=c)}n.Vertex=o;let s=n.Fragment;if(a){const c=a.FragmentShaderCode;c!==void 0&&c!==""&&(s=c)}n.Fragment=s;let l=n.Geometry;if(a){const c=a.GeometryShaderCode;c!==void 0&&(l=c)}n.Geometry=l}}var xu={implementReplaceShaderCoincidentOffset:q4e,implementBuildShadersWithReplacements:X4e};let I7;function Y4e(t,e){e.classHierarchy.push("vtkAbstractTransform","vtkHomogeneousTransform","vtkTransform"),t.transformPoint=(n,r)=>(Gn(r,n,e.matrix),r),t.transformPoints=(n,r)=>{const i=new Float64Array(3),a=new Float64Array(3);for(let o=0;o<n.length;o+=3)i[0]=n[o],i[1]=n[o+1],i[2]=n[o+2],Gn(a,i,e.matrix),r[o]=a[0],r[o+1]=a[1],r[o+2]=a[2];return r},t.preMultiply=()=>{t.setPreMultiplyFlag(!0)},t.postMultiply=()=>{t.setPreMultiplyFlag(!1)},t.transformMatrix=(n,r)=>(e.preMultiplyFlag?zn(r,e.matrix,n):zn(r,n,e.matrix),r),t.transformMatrices=(n,r)=>{const i=new Float64Array(16),a=new Float64Array(16),o=e.preMultiplyFlag?()=>zn(a,e.matrix,i):()=>zn(a,i,e.matrix);for(let s=0;s<n.length;s+=16){for(let l=0;l<16;++l)i[l]=n[s+l];o();for(let l=0;l<16;++l)r[s+l]=a[l]}return r},t.getInverse=()=>I7({matrix:Zs.invertMatrix(Array.from(e.matrix),[],4),preMultiplyFlag:e.preMultiplyFlag})}const J4e={preMultiplyFlag:!1,matrix:[...WD]};function sJ(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,J4e,n),ce.obj(t,e),ce.setGet(t,e,["preMultiplyFlag"]),ce.setGetArray(t,e,["matrix"],16),Y4e(t,e)}I7=ce.newInstance(sJ,"vtkTransform");var Z4e={newInstance:I7,extend:sJ};function bu(t,e,n){return t?`${t.getMTime()}-${e}-${n}`:"0"}function R7(t,e){return`${t.getMTime()}A${e.getMTime()}`}var Q4e=`//VTK::System::Dec

/*=========================================================================

  Program:   Visualization Toolkit
  Module:    vtkImageResliceMapperVS.glsl

  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen
  All rights reserved.
  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.

     This software is distributed WITHOUT ANY WARRANTY; without even
     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
     PURPOSE.  See the above copyright notice for more information.

=========================================================================*/

// all variables that represent positions or directions have a suffix
// indicating the coordinate system they are in. The possible values are
// MC - Model coordinates
// WC - World coordinates
// VC - View coordinates
// DC - Display coordinates
// TC - Texture coordinates

// frag position in VC
//VTK::PositionVC::Dec

// Texture coordinates
//VTK::TCoord::Dec

// picking support
//VTK::Picking::Dec

// camera and actor matrix values
//VTK::Camera::Dec

void main()
{
  //VTK::PositionVC::Impl

  //VTK::TCoord::Impl

  //VTK::Picking::Impl
}
`,eTe=`//VTK::System::Dec

/*=========================================================================

  Program:   Visualization Toolkit
  Module:    vtkImageResliceMapperFS.glsl

  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen
  All rights reserved.
  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.

     This software is distributed WITHOUT ANY WARRANTY; without even
     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
     PURPOSE.  See the above copyright notice for more information.

=========================================================================*/
// Template for the gpu image mapper fragment shader

// VC position of this fragment
//VTK::PositionVC::Dec

// Texture coordinates
//VTK::TCoord::Dec

// picking support
//VTK::Picking::Dec

// handle coincident offsets
//VTK::Coincident::Dec

//VTK::ZBuffer::Dec

// the output of this shader
//VTK::Output::Dec

void main()
{
  // VC position of this fragment. This should not branch/return/discard.
  //VTK::PositionVC::Impl

  // Place any calls that require uniform flow (e.g. dFdx) here.
  //VTK::UniformFlow::Impl

  // Set gl_FragDepth here (gl_FragCoord.z by default)
  //VTK::Depth::Impl

  // Early depth peeling abort:
  //VTK::DepthPeeling::PreColor

  //VTK::TCoord::Impl

  if (gl_FragData[0].a <= 0.0)
    {
    discard;
    }

  //VTK::DepthPeeling::Impl

  //VTK::Picking::Impl

  // handle coincident offsets
  //VTK::Coincident::Impl

  //VTK::ZBuffer::Impl

  //VTK::RenderPassFragmentShader::Impl
}
`;const Sh={NEAREST:0,LINEAR:1};var tTe={InterpolationType:Sh};const Dc={Off:0,PolygonOffset:1};let V_=Dc.PolygonOffset,f3=Dc.Off;const nTe=["VTK_RESOLVE_OFF","VTK_RESOLVE_POLYGON_OFFSET"];function rTe(){return V_}function iTe(t){const e=V_===t;return V_=t,e}function aTe(){return f3}function jC(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;const e=f3===t;return f3=t,e}function oTe(){return jC(Dc.Off)}function sTe(){return jC(Dc.Off)}function lTe(){return jC(Dc.PolygonOffset)}function cTe(){return nTe[f3]}var F_={Resolve:Dc,getResolveCoincidentTopologyAsString:cTe,getResolveCoincidentTopologyPolygonOffsetFaces:rTe,getResolveCoincidentTopology:aTe,setResolveCoincidentTopology:jC,setResolveCoincidentTopologyPolygonOffsetFaces:iTe,setResolveCoincidentTopologyToDefault:oTe,setResolveCoincidentTopologyToOff:sTe,setResolveCoincidentTopologyToPolygonOffset:lTe};function lJ(t,e,n){n.forEach(r=>{t[`get${r.method}`]=()=>e[r.key],t[`set${r.method}`]=ce.objectSetterMap.object(t,e,{name:r.key,params:["factor","offset"]})})}const P7=["Polygon","Line","Point"],uTe={Polygon:{factor:2,offset:0},Line:{factor:1,offset:-1},Point:{factor:0,offset:-2}},fTe=()=>{},nh={modified:fTe};lJ(nh,uTe,P7.map(t=>({key:t,method:`ResolveCoincidentTopology${t}OffsetParameters`})));function dTe(t,e){e.resolveCoincidentTopology===void 0&&(e.resolveCoincidentTopology=!1),ce.setGet(t,e,["resolveCoincidentTopology"]),e.topologyOffset={Polygon:{factor:0,offset:0},Line:{factor:0,offset:0},Point:{factor:0,offset:0}},Object.keys(F_).forEach(n=>{t[n]=F_[n]}),Object.keys(nh).filter(n=>n!=="modified").forEach(n=>{t[n]=nh[n]}),lJ(t,e.topologyOffset,P7.map(n=>({key:n,method:`RelativeCoincidentTopology${n}OffsetParameters`}))),t.getCoincidentTopologyPolygonOffsetParameters=()=>{const n=nh.getResolveCoincidentTopologyPolygonOffsetParameters(),r=t.getRelativeCoincidentTopologyPolygonOffsetParameters();return{factor:n.factor+r.factor,offset:n.offset+r.offset}},t.getCoincidentTopologyLineOffsetParameters=()=>{const n=nh.getResolveCoincidentTopologyLineOffsetParameters(),r=t.getRelativeCoincidentTopologyLineOffsetParameters();return{factor:n.factor+r.factor,offset:n.offset+r.offset}},t.getCoincidentTopologyPointOffsetParameter=()=>{const n=nh.getResolveCoincidentTopologyPointOffsetParameters(),r=t.getRelativeCoincidentTopologyPointOffsetParameters();return{factor:n.factor+r.factor,offset:n.offset+r.offset}}}var zC={implementCoincidentTopologyMethods:dTe,staticOffsetAPI:nh,otherStaticMethods:F_,CATEGORIES:P7,Resolve:Dc};const{vtkErrorMacro:V0}=wo;function vV(t,e,n){return e.identity(n),t.reduce((r,i,a)=>a===0?i?e.copy(r,i):e.identity(r):i?e.multiply(r,r,i):r,n)}function hTe(t,e){e.classHierarchy.push("vtkOpenGLImageResliceMapper");function n(i){[e._scalars,e._colorTransferFunc,e._pwFunc].forEach(a=>i.unregisterGraphicsResourceUser(a,t))}t.buildPass=i=>{if(i){e.currentRenderPass=null,e._openGLImageSlice=t.getFirstAncestorOfType("vtkOpenGLImageSlice"),e._openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer");const a=e._openGLRenderer.getRenderable();e._openGLCamera=e._openGLRenderer.getViewNodeFor(a.getActiveCamera());const o=e._openGLRenderWindow;e._openGLRenderWindow=e._openGLRenderer.getLastAncestorOfType("vtkOpenGLRenderWindow"),o&&!o.isDeleted()&&o!==e._openGLRenderWindow&&n(o),e.context=e._openGLRenderWindow.getContext(),e.tris.setOpenGLRenderWindow(e._openGLRenderWindow)}},t.translucentPass=(i,a)=>{i&&(e.currentRenderPass=a,t.render())},t.zBufferPass=i=>{i&&(e.haveSeenDepthRequest=!0,e.renderDepth=!0,t.render(),e.renderDepth=!1)},t.opaqueZBufferPass=i=>t.zBufferPass(i),t.opaquePass=i=>{i&&t.render()},t.getCoincidentParameters=(i,a)=>e.renderable.getResolveCoincidentTopology()==Dc.PolygonOffset?e.renderable.getCoincidentTopologyPolygonOffsetParameters():null,t.render=()=>{const i=e._openGLImageSlice.getRenderable(),a=e._openGLRenderer.getRenderable();t.renderPiece(a,i)},t.renderPiece=(i,a)=>{if(t.invokeEvent({type:"StartEvent"}),e.renderable.update(),e.currentInput=e.renderable.getInputData(),!e.currentInput){V0("No input!");return}t.updateResliceGeometry(),t.renderPieceStart(i,a),t.renderPieceDraw(i,a),t.renderPieceFinish(i,a),t.invokeEvent({type:"EndEvent"})},t.renderPieceStart=(i,a)=>{t.updateBufferObjects(i,a),a.getProperty().getInterpolationType()===Sh.NEAREST?(e.openGLTexture.setMinificationFilter(an.NEAREST),e.openGLTexture.setMagnificationFilter(an.NEAREST),e.colorTexture.setMinificationFilter(an.NEAREST),e.colorTexture.setMagnificationFilter(an.NEAREST),e.pwfTexture.setMinificationFilter(an.NEAREST),e.pwfTexture.setMagnificationFilter(an.NEAREST)):(e.openGLTexture.setMinificationFilter(an.LINEAR),e.openGLTexture.setMagnificationFilter(an.LINEAR),e.colorTexture.setMinificationFilter(an.LINEAR),e.colorTexture.setMagnificationFilter(an.LINEAR),e.pwfTexture.setMinificationFilter(an.LINEAR),e.pwfTexture.setMagnificationFilter(an.LINEAR)),e.lastBoundBO=null},t.renderPieceDraw=(i,a)=>{const o=e.context;e.openGLTexture.activate(),e.colorTexture.activate(),e.pwfTexture.activate(),t.updateShaders(e.tris,i,a),o.drawArrays(o.TRIANGLES,0,e.tris.getCABO().getElementCount()),e.tris.getVAO().release(),e.openGLTexture.deactivate(),e.colorTexture.deactivate(),e.pwfTexture.deactivate()},t.renderPieceFinish=(i,a)=>{},t.updateBufferObjects=(i,a)=>{t.getNeedToRebuildBufferObjects(i,a)&&t.buildBufferObjects(i,a)},t.getNeedToRebuildBufferObjects=(i,a)=>e.VBOBuildTime.getMTime()<t.getMTime()||e.VBOBuildTime.getMTime()<a.getMTime()||e.VBOBuildTime.getMTime()<e.renderable.getMTime()||e.VBOBuildTime.getMTime()<a.getProperty().getMTime()||e.VBOBuildTime.getMTime()<e.currentInput.getMTime()||e.VBOBuildTime.getMTime()<e.resliceGeom.getMTime()||!e.openGLTexture?.getHandle()||!e.colorTexture?.getHandle()||!e.pwfTexture?.getHandle(),t.buildBufferObjects=(i,a)=>{const o=e.currentInput;if(!o)return;const s=o.getPointData()?.getScalars();if(!s)return;const l=s.getNumberOfComponents();let c=R7(o,s);const f=e._openGLRenderWindow.getGraphicsResourceForObject(s),u=!f?.oglObject?.getHandle()||f?.hash!==c,d=e.renderable.getUpdatedExtents(),h=!!d.length;if(u&&!h){e.openGLTexture=ai.newInstance(),e.openGLTexture.setOpenGLRenderWindow(e._openGLRenderWindow),e.openGLTexture.setOglNorm16Ext(e.context.getExtension("EXT_texture_norm16")),e.openGLTexture.resetFormatAndType();const I=o.getDimensions();e.openGLTexture.create3DFilterableFromDataArray(I[0],I[1],I[2],s,!1,d),e._openGLRenderWindow.setGraphicsResourceForObject(s,e.openGLTexture,c),s!==e._scalars&&(e._openGLRenderWindow.registerGraphicsResourceUser(s,t),e._openGLRenderWindow.unregisterGraphicsResourceUser(e._scalars,t)),e._scalars=s}else e.openGLTexture=f.oglObject;if(h){e.renderable.setUpdatedExtents([]);const I=o.getDimensions();e.openGLTexture.create3DFilterableFromDataArray(I[0],I[1],I[2],s,!1,d)}const p=a.getProperty(),g=p.getIndependentComponents(),m=g?l:1,y=g?2*m:1,v=p.getRGBTransferFunction();c=bu(v,g,m);const x=e._openGLRenderWindow.getGraphicsResourceForObject(v);if(!x?.oglObject?.getHandle()||x?.hash!==c){const R=1024*y*3,O=new Uint8ClampedArray(R);if(e.colorTexture=ai.newInstance(),e.colorTexture.setOpenGLRenderWindow(e._openGLRenderWindow),v){const P=new Float32Array(3072);for(let N=0;N<m;N++){const A=p.getRGBTransferFunction(N),B=A.getRange();if(A.getTable(B[0],B[1],1024,P,1),g)for(let V=0;V<1024*3;V++)O[N*1024*6+V]=255*P[V],O[N*1024*6+V+1024*3]=255*P[V];else for(let V=0;V<1024*3;V++)O[N*1024*6+V]=255*P[V]}e.colorTexture.resetFormatAndType(),e.colorTexture.create2DFromRaw(1024,y,3,Ln.UNSIGNED_CHAR,O)}else{for(let P=0;P<1024*3;++P)O[P]=255*P/(1023*3),O[P+1]=255*P/(1023*3),O[P+2]=255*P/(1023*3);e.colorTexture.resetFormatAndType(),e.colorTexture.create2DFromRaw(1024,1,3,Ln.UNSIGNED_CHAR,O)}v&&(e._openGLRenderWindow.setGraphicsResourceForObject(v,e.colorTexture,c),v!==e._colorTransferFunc&&(e._openGLRenderWindow.registerGraphicsResourceUser(v,t),e._openGLRenderWindow.unregisterGraphicsResourceUser(e._colorTransferFunc,t)),e._colorTransferFunc=v)}else e.colorTexture=x.oglObject;const S=p.getPiecewiseFunction();c=bu(S,g,m);const T=e._openGLRenderWindow.getGraphicsResourceForObject(S);if(!T?.oglObject?.getHandle()||T?.hash!==c){const R=1024*y,O=new Uint8ClampedArray(R);if(e.pwfTexture=ai.newInstance(),e.pwfTexture.setOpenGLRenderWindow(e._openGLRenderWindow),S){const P=new Float32Array(R),N=new Float32Array(1024);for(let A=0;A<m;++A){const B=p.getPiecewiseFunction(A);if(B===null)P.fill(1);else{const V=B.getRange();if(B.getTable(V[0],V[1],1024,N,1),g)for(let $=0;$<1024;$++)P[A*1024*2+$]=N[$],P[A*1024*2+$+1024]=N[$];else for(let $=0;$<1024;$++)P[A*1024*2+$]=N[$]}}e.pwfTexture.resetFormatAndType(),e.pwfTexture.create2DFromRaw(1024,y,1,Ln.FLOAT,P)}else O.fill(255),e.pwfTexture.resetFormatAndType(),e.pwfTexture.create2DFromRaw(1024,1,1,Ln.UNSIGNED_CHAR,O);S&&(e._openGLRenderWindow.setGraphicsResourceForObject(S,e.pwfTexture,c),S!==e._pwFunc&&(e._openGLRenderWindow.registerGraphicsResourceUser(S,t),e._openGLRenderWindow.unregisterGraphicsResourceUser(e._pwFunc,t)),e._pwFunc=S)}else e.pwfTexture=T.oglObject;const D=`${e.resliceGeom.getMTime()}A${e.renderable.getSlabThickness()}`;if(!e.tris.getCABO().getElementCount()||e.VBOBuildString!==D){const I=tn.newInstance({numberOfComponents:3,values:e.resliceGeom.getPoints().getData()});I.setName("points");const R=tn.newInstance({numberOfComponents:1,values:e.resliceGeom.getPolys().getData()}),O={points:I,cellOffset:0};if(e.renderable.getSlabThickness()>0){const P=e.resliceGeom.getPointData().getNormals();P?O.normals=P:V0("Slab mode requested without normals")}e.tris.getCABO().createVBO(R,"polys",go.SURFACE,O)}e.VBOBuildString=D,e.VBOBuildTime.modified()},t.updateShaders=(i,a,o)=>{if(e.lastBoundBO=i,t.getNeedToRebuildShaders(i,a,o)){const s={Vertex:null,Fragment:null,Geometry:null};t.buildShaders(s,a,o);const l=e._openGLRenderWindow.getShaderCache().readyShaderProgramArray(s.Vertex,s.Fragment,s.Geometry);l!==i.getProgram()&&(i.setProgram(l),i.getVAO().releaseGraphicsResources()),i.getShaderSourceTime().modified()}else e._openGLRenderWindow.getShaderCache().readyShaderProgram(i.getProgram());i.getVAO().bind(),t.setMapperShaderParameters(i,a,o),t.setCameraShaderParameters(i,a,o),t.setPropertyShaderParameters(i,a,o)},t.setMapperShaderParameters=(i,a,o)=>{const s=i.getProgram();if(i.getCABO().getElementCount()&&(e.VBOBuildTime.getMTime()>i.getAttributeUpdateTime().getMTime()||i.getShaderSourceTime().getMTime()>i.getAttributeUpdateTime().getMTime())){s.isUniformUsed("texture1")&&s.setUniformi("texture1",e.openGLTexture.getTextureUnit()),s.isAttributeUsed("vertexWC")&&(i.getVAO().addAttributeArray(s,i.getCABO(),"vertexWC",i.getCABO().getVertexOffset(),i.getCABO().getStride(),e.context.FLOAT,3,e.context.FALSE)||V0("Error setting vertexWC in shader VAO.")),s.isAttributeUsed("normalWC")&&(i.getVAO().addAttributeArray(s,i.getCABO(),"normalWC",i.getCABO().getNormalOffset(),i.getCABO().getStride(),e.context.FLOAT,3,e.context.FALSE)||V0("Error setting normalWC in shader VAO.")),s.isUniformUsed("slabThickness")&&s.setUniformf("slabThickness",e.renderable.getSlabThickness()),s.isUniformUsed("spacing")&&s.setUniform3fv("spacing",e.currentInput.getSpacing()),s.isUniformUsed("slabType")&&s.setUniformi("slabType",e.renderable.getSlabType()),s.isUniformUsed("slabType")&&s.setUniformi("slabType",e.renderable.getSlabType()),s.isUniformUsed("slabTrapezoid")&&s.setUniformi("slabTrapezoid",e.renderable.getSlabTrapezoidIntegration());const c=i.getCABO().getCoordShiftAndScaleEnabled()?i.getCABO().getInverseShiftAndScaleMatrix():null;if(s.isUniformUsed("WCTCMatrix")){const f=e.currentInput,u=f.getDimensions();Ri(e.tmpMat4,f.getIndexToWorld()),di(e.tmpMat4,e.tmpMat4,[-.5,-.5,-.5]),i0(e.tmpMat4,e.tmpMat4,u),Ea(e.tmpMat4,e.tmpMat4),c&&zn(e.tmpMat4,e.tmpMat4,c),s.setUniformMatrix("WCTCMatrix",e.tmpMat4)}s.isUniformUsed("vboScaling")&&s.setUniform3fv("vboScaling",i.getCABO().getCoordScale()??[1,1,1]),i.getAttributeUpdateTime().modified()}if(e.haveSeenDepthRequest&&i.getProgram().setUniformi("depthRequest",e.renderDepth?1:0),i.getProgram().isUniformUsed("coffset")){const l=t.getCoincidentParameters(a,o);i.getProgram().setUniformf("coffset",l.offset),i.getProgram().isUniformUsed("cfactor")&&i.getProgram().setUniformf("cfactor",l.factor)}},t.setCameraShaderParameters=(i,a,o)=>{const s=e._openGLCamera.getKeyMatrices(a),l=e._openGLImageSlice.getKeyMatrices(),f=i.getCABO().getCoordShiftAndScaleEnabled()?i.getCABO().getInverseShiftAndScaleMatrix():null,u=i.getProgram();u.isUniformUsed("MCPCMatrix")&&(on(e.tmpMat4),u.setUniformMatrix("MCPCMatrix",vV([s.wcpc,l.mcwc,f],H2,e.tmpMat4))),u.isUniformUsed("MCVCMatrix")&&(on(e.tmpMat4),u.setUniformMatrix("MCVCMatrix",vV([s.wcvc,l.mcwc,f],H2,e.tmpMat4)))},t.setPropertyShaderParameters=(i,a,o)=>{const s=i.getProgram(),l=o.getProperty(),c=l.getOpacity();s.setUniformf("opacity",c);const f=e.openGLTexture.getComponents(),u=l.getIndependentComponents();if(u)for(let g=0;g<f;++g)s.setUniformf(`mix${g}`,l.getComponentWeight(g));const d=e.openGLTexture.getVolumeInfo();for(let g=0;g<f;g++){let m=l.getColorWindow(),y=l.getColorLevel();const v=u?g:0,x=l.getRGBTransferFunction(v);if(x&&l.getUseLookupTableScalarRange()){const T=x.getRange();m=T[1]-T[0],y=.5*(T[1]+T[0])}const w=d.scale[g]/m,S=(d.offset[g]-y)/m+.5;s.setUniformf(`cshift${g}`,S),s.setUniformf(`cscale${g}`,w)}const h=e.colorTexture.getTextureUnit();s.setUniformi("colorTexture1",h);for(let g=0;g<f;g++){let m=1,y=0;const v=u?g:0,x=l.getPiecewiseFunction(v);if(x){const w=x.getRange(),S=w[1]-w[0],T=.5*(w[0]+w[1]);m=d.scale[g]/S,y=(d.offset[g]-T)/S+.5}s.setUniformf(`pwfshift${g}`,y),s.setUniformf(`pwfscale${g}`,m)}const p=e.pwfTexture.getTextureUnit();s.setUniformi("pwfTexture1",p),s.setUniform4fv("backgroundColor",e.renderable.getBackgroundColor())},t.getNeedToRebuildShaders=(i,a,o)=>{const s=e.openGLTexture.getComponents(),l=o.getProperty().getIndependentComponents(),c=e.renderable.getSlabThickness(),f=e.renderable.getSlabType(),u=e.renderable.getSlabTrapezoidIntegration();let d=!1;return(!e.currentRenderPass&&e.lastRenderPassShaderReplacement||e.currentRenderPass&&e.currentRenderPass.getShaderReplacement()!==e.lastRenderPassShaderReplacement)&&(d=!0),d||e.lastHaveSeenDepthRequest!==e.haveSeenDepthRequest||i.getProgram()?.getHandle()===0||e.lastTextureComponents!==s||e.lastIndependentComponents!==l||e.lastSlabThickness!==c||e.lastSlabType!==f||e.lastSlabTrapezoidIntegration!==u?(e.lastHaveSeenDepthRequest=e.haveSeenDepthRequest,e.lastTextureComponents=s,e.lastIndependentComponents=l,e.lastSlabThickness=c,e.lastSlabType=f,e.lastSlabTrapezoidIntegration=u,!0):!1},t.getShaderTemplate=(i,a,o)=>{i.Vertex=Q4e,i.Fragment=eTe,i.Geometry=""},t.replaceShaderValues=(i,a,o)=>{if(t.replaceShaderTCoord(i,a,o),t.replaceShaderPositionVC(i,a,o),e.haveSeenDepthRequest){let s=i.Fragment;s=$e.substitute(s,"//VTK::ZBuffer::Dec","uniform int depthRequest;").result,s=$e.substitute(s,"//VTK::ZBuffer::Impl",["if (depthRequest == 1) {","float iz = floor(gl_FragCoord.z*65535.0 + 0.1);","float rf = floor(iz/256.0)/255.0;","float gf = mod(iz,256.0)/255.0;","gl_FragData[0] = vec4(rf, gf, 0.0, 1.0); }"]).result,i.Fragment=s}t.replaceShaderCoincidentOffset(i,a,o)},t.replaceShaderTCoord=(i,a,o)=>{let s=i.Vertex;const l=i.Geometry;let c=i.Fragment;const f=["uniform mat4 WCTCMatrix;","out vec3 fragTexCoord;"],u=e.renderable.getSlabThickness();s=$e.substitute(s,"//VTK::TCoord::Dec",f).result;const d=["fragTexCoord = (WCTCMatrix * vertexWC).xyz;"];s=$e.substitute(s,"//VTK::TCoord::Impl",d).result;const h=e.openGLTexture.getComponents(),p=o.getProperty().getIndependentComponents();let g=["in vec3 fragTexCoord;","uniform highp sampler3D texture1;","uniform mat4 WCTCMatrix;","uniform float cshift0;","uniform float cscale0;","uniform float pwfshift0;","uniform float pwfscale0;","uniform sampler2D colorTexture1;","uniform sampler2D pwfTexture1;","uniform float opacity;","uniform vec4 backgroundColor;"];if(p){for(let y=1;y<h;y++)g=g.concat([`uniform float cshift${y};`,`uniform float cscale${y};`,`uniform float pwfshift${y};`,`uniform float pwfscale${y};`]);switch(h){case 1:g=g.concat(["uniform float mix0;","#define height0 0.5"]);break;case 2:g=g.concat(["uniform float mix0;","uniform float mix1;","#define height0 0.25","#define height1 0.75"]);break;case 3:g=g.concat(["uniform float mix0;","uniform float mix1;","uniform float mix2;","#define height0 0.17","#define height1 0.5","#define height2 0.83"]);break;case 4:g=g.concat(["uniform float mix0;","uniform float mix1;","uniform float mix2;","uniform float mix3;","#define height0 0.125","#define height1 0.375","#define height2 0.625","#define height3 0.875"]);break;default:V0("Unsupported number of independent coordinates.")}}u>0&&(g=g.concat(["uniform vec3 spacing;","uniform float slabThickness;","uniform int slabType;","uniform int slabTrapezoid;","uniform vec3 vboScaling;"]),g=g.concat(["vec4 compositeValue(vec4 currVal, vec4 valToComp, int trapezoid)","{","  vec4 retVal = vec4(1.0);","  if (slabType == 0) // min","  {","    retVal = min(currVal, valToComp);","  }","  else if (slabType == 1) // max","  {","    retVal = max(currVal, valToComp);","  }","  else if (slabType == 3) // sum","  {","    retVal = currVal + (trapezoid > 0 ? 0.5 * valToComp : valToComp); ","  }","  else // mean","  {","    retVal = currVal + (trapezoid > 0 ? 0.5 * valToComp : valToComp); ","  }","  return retVal;","}"])),c=$e.substitute(c,"//VTK::TCoord::Dec",g).result;let m=["if (any(greaterThan(fragTexCoord, vec3(1.0))) || any(lessThan(fragTexCoord, vec3(0.0))))","{","  // set the background color and exit","  gl_FragData[0] = backgroundColor;","  return;","}","vec4 tvalue = texture(texture1, fragTexCoord);"];if(u>0&&(m=m.concat(["// Get the first and last samples","int numSlices = 1;","float scaling = min(min(spacing.x, spacing.y), spacing.z) * 0.5;","vec3 normalxspacing = scaling * normalWCVSOutput;","float distTraveled = length(normalxspacing);","int trapezoid = 0;","while (distTraveled < slabThickness * 0.5)","{","  distTraveled += length(normalxspacing);","  float fnumSlices = float(numSlices);","  if (distTraveled > slabThickness * 0.5)","  {","    // Before stepping outside the slab, sample at the boundaries","    normalxspacing = normalWCVSOutput * slabThickness * 0.5 / fnumSlices;","    trapezoid = slabTrapezoid;","  }","  vec3 fragTCoordNeg = (WCTCMatrix * vec4(vertexWCVSOutput.xyz - fnumSlices * normalxspacing * vboScaling, 1.0)).xyz;","  if (!any(greaterThan(fragTCoordNeg, vec3(1.0))) && !any(lessThan(fragTCoordNeg, vec3(0.0))))","  {","    vec4 newVal = texture(texture1, fragTCoordNeg);","    tvalue = compositeValue(tvalue, newVal, trapezoid);","    numSlices += 1;","  }","  vec3 fragTCoordPos = (WCTCMatrix * vec4(vertexWCVSOutput.xyz + fnumSlices * normalxspacing * vboScaling, 1.0)).xyz;","  if (!any(greaterThan(fragTCoordNeg, vec3(1.0))) && !any(lessThan(fragTCoordNeg, vec3(0.0))))","  {","    vec4 newVal = texture(texture1, fragTCoordPos);","    tvalue = compositeValue(tvalue, newVal, trapezoid);","    numSlices += 1;","  }","}","// Finally, if slab type is *mean*, divide the sum by the numSlices","if (slabType == 2)","{","  tvalue = tvalue / float(numSlices);","}"])),p){const y=["r","g","b","a"];for(let v=0;v<h;++v)m=m.concat([`vec3 tcolor${v} = mix${v} * texture2D(colorTexture1, vec2(tvalue.${y[v]} * cscale${v} + cshift${v}, height${v})).rgb;`,`float compWeight${v} = mix${v} * texture2D(pwfTexture1, vec2(tvalue.${y[v]} * pwfscale${v} + pwfshift${v}, height${v})).r;`]);switch(h){case 1:m=m.concat(["gl_FragData[0] = vec4(tcolor0.rgb, compWeight0 * opacity);"]);break;case 2:m=m.concat(["float weightSum = compWeight0 + compWeight1;","gl_FragData[0] = vec4(vec3((tcolor0.rgb * (compWeight0 / weightSum)) + (tcolor1.rgb * (compWeight1 / weightSum))), opacity);"]);break;case 3:m=m.concat(["float weightSum = compWeight0 + compWeight1 + compWeight2;","gl_FragData[0] = vec4(vec3((tcolor0.rgb * (compWeight0 / weightSum)) + (tcolor1.rgb * (compWeight1 / weightSum)) + (tcolor2.rgb * (compWeight2 / weightSum))), opacity);"]);break;case 4:m=m.concat(["float weightSum = compWeight0 + compWeight1 + compWeight2 + compWeight3;","gl_FragData[0] = vec4(vec3((tcolor0.rgb * (compWeight0 / weightSum)) + (tcolor1.rgb * (compWeight1 / weightSum)) + (tcolor2.rgb * (compWeight2 / weightSum)) + (tcolor3.rgb * (compWeight3 / weightSum))), opacity);"]);break;default:V0("Unsupported number of independent coordinates.")}}else switch(h){case 1:m=m.concat(["// Dependent components","float intensity = tvalue.r;","vec3 tcolor = texture2D(colorTexture1, vec2(intensity * cscale0 + cshift0, 0.5)).rgb;","float scalarOpacity = texture2D(pwfTexture1, vec2(intensity * pwfscale0 + pwfshift0, 0.5)).r;","gl_FragData[0] = vec4(tcolor, scalarOpacity * opacity);"]);break;case 2:m=m.concat(["float intensity = tvalue.r*cscale0 + cshift0;","gl_FragData[0] = vec4(texture2D(colorTexture1, vec2(intensity, 0.5)).rgb, pwfscale0*tvalue.g + pwfshift0);"]);break;case 3:m=m.concat(["vec4 tcolor = cscale0*tvalue + cshift0;","gl_FragData[0] = vec4(texture2D(colorTexture1, vec2(tcolor.r,0.5)).r,","  texture2D(colorTexture1, vec2(tcolor.g,0.5)).r,","  texture2D(colorTexture1, vec2(tcolor.b,0.5)).r, opacity);"]);break;default:m=m.concat(["vec4 tcolor = cscale0*tvalue + cshift0;","gl_FragData[0] = vec4(texture2D(colorTexture1, vec2(tcolor.r,0.5)).r,","  texture2D(colorTexture1, vec2(tcolor.g,0.5)).r,","  texture2D(colorTexture1, vec2(tcolor.b,0.5)).r, tcolor.a);"])}c=$e.substitute(c,"//VTK::TCoord::Impl",m).result,i.Vertex=s,i.Fragment=c,i.Geometry=l},t.replaceShaderPositionVC=(i,a,o)=>{let s=i.Vertex;const l=i.Geometry;let c=i.Fragment;const f=e.renderable.getSlabThickness();let u=["attribute vec4 vertexWC;"];u=u.concat([`//${t.getMTime()}${e.resliceGeomUpdateString}`]),f>0&&(u=u.concat(["attribute vec3 normalWC;","varying vec3 normalWCVSOutput;","varying vec4 vertexWCVSOutput;"])),s=$e.substitute(s,"//VTK::PositionVC::Dec",u).result;let d=["gl_Position = MCPCMatrix * vertexWC;"];f>0&&(d=d.concat(["normalWCVSOutput = normalWC;","vertexWCVSOutput = vertexWC;"])),s=$e.substitute(s,"//VTK::PositionVC::Impl",d).result,s=$e.substitute(s,"//VTK::Camera::Dec",["uniform mat4 MCPCMatrix;","uniform mat4 MCVCMatrix;"]).result;let h=[];f>0&&(h=h.concat(["varying vec3 normalWCVSOutput;","varying vec4 vertexWCVSOutput;"])),c=$e.substitute(c,"//VTK::PositionVC::Dec",h).result,i.Vertex=s,i.Geometry=l,i.Fragment=c};function r(i){Zs.normalize(i);const a=[0,0,0];for(let o=0;o<3;++o){_3e(a),a[o]=1;const s=Zs.dot(i,a);if(s<-.999999||s>.999999)return[!0,o]}return[!1,2]}t.updateResliceGeometry=()=>{let i="";const a=e.currentInput,o=a?.getBounds();let s=!0,l=2;const c=e.renderable.getSlicePolyData(),f=e.renderable.getSlicePlane();if(c)i=i.concat(`PolyData${c.getMTime()}`);else if(f){i=i.concat(`Plane${f.getMTime()}`);const u=c7();a&&(i=i.concat(`Image${a.getMTime()}`),TX(u,...a.getDirection()),Ay(u,u));const d=[...f.getNormal()];Jb(d,d,u),[s,l]=r(d)}else{const u=Ao.newInstance();u.setNormal(0,0,1);let d=[0,1,0,1,0,1];a&&(d=o),u.setOrigin(d[0],d[2],.5*(d[5]+d[4])),e.renderable.setSlicePlane(u),i=i.concat(`Plane${f?.getMTime()}`),a&&(i=i.concat(`Image${a.getMTime()}`))}if(!e.resliceGeom||e.resliceGeomUpdateString!==i){if(c)e.resliceGeom||(e.resliceGeom=ca.newInstance()),e.resliceGeom.getPoints().setData(c.getPoints().getData(),3),e.resliceGeom.getPolys().setData(c.getPolys().getData(),1),e.resliceGeom.getPointData().setNormals(c.getPointData().getNormals());else if(f)if(s){const u=new Float32Array(12),d=a.worldToIndex(f.getOrigin(),[0,0,0]),h=[(l+1)%3,(l+2)%3].sort(),p=a.getSpatialExtent();let g=0;for(let w=0;w<2;++w)for(let S=0;S<2;++S)u[g+l]=d[l],u[g+h[0]]=p[2*h[0]+S],u[g+h[1]]=p[2*h[1]+w],g+=3;e.transform.setMatrix(a.getIndexToWorld()),e.transform.transformPoints(u,u);const m=new Uint16Array(8);m[0]=3,m[1]=0,m[2]=1,m[3]=3,m[4]=3,m[5]=0,m[6]=3,m[7]=2;const y=f.getNormal();Zs.normalize(y);const v=new Float32Array(12);for(let w=0;w<4;++w)v[3*w]=y[0],v[3*w+1]=y[1],v[3*w+2]=y[2];e.resliceGeom||(e.resliceGeom=ca.newInstance()),e.resliceGeom.getPoints().setData(u,3),e.resliceGeom.getPolys().setData(m,1);const x=tn.newInstance({numberOfComponents:3,values:v,name:"Normals"});e.resliceGeom.getPointData().setNormals(x)}else{e.outlineFilter.setInputData(a),e.cutter.setInputConnection(e.outlineFilter.getOutputPort()),e.cutter.setCutFunction(f),e.lineToSurfaceFilter.setInputConnection(e.cutter.getOutputPort()),e.lineToSurfaceFilter.update(),e.resliceGeom||(e.resliceGeom=ca.newInstance());const u=e.lineToSurfaceFilter.getOutputData();e.resliceGeom.getPoints().setData(u.getPoints().getData(),3),e.resliceGeom.getPolys().setData(u.getPolys().getData(),1),e.resliceGeom.getPointData().setNormals(u.getPointData().getNormals());const d=f.getNormal(),h=e.resliceGeom.getNumberOfPoints();Zs.normalize(d);const p=new Float32Array(h*3);for(let m=0;m<h;++m)p[3*m]=d[0],p[3*m+1]=d[1],p[3*m+2]=d[2];const g=tn.newInstance({numberOfComponents:3,values:p,name:"Normals"});e.resliceGeom.getPointData().setNormals(g)}else V0("Something went wrong.","A default slice plane should have been created in the beginning of","updateResliceGeometry.");e.resliceGeomUpdateString=i,e.resliceGeom?.modified()}},t.setOpenGLTexture=i=>{i&&(e.openGLTexture=i,e._externalOpenGLTexture=!0)},t.delete=Oy(()=>{e._openGLRenderWindow&&n(e._openGLRenderWindow)},t.delete)}const pTe={VBOBuildTime:{},VBOBuildString:null,haveSeenDepthRequest:!1,lastHaveSeenDepthRequest:!1,lastIndependentComponents:!1,lastTextureComponents:0,lastSlabThickness:0,lastSlabTrapezoidIntegration:0,lastSlabType:-1,openGLTexture:null,colorTextureString:null,pwfTextureString:null,resliceGeom:null,resliceGeomUpdateString:null,tris:null,colorTexture:null,pwfTexture:null,_externalOpenGLTexture:!1};function gTe(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,pTe,n),kr.extend(t,e,n),xu.implementReplaceShaderCoincidentOffset(t,e,n),xu.implementBuildShadersWithReplacements(t,e,n),e.tris=Du.newInstance(),e.openGLTexture=null,e.colorTexture=null,e.pwfTexture=null,e.VBOBuildTime={},Wr(e.VBOBuildTime),e.tmpMat4=on(new Float64Array(16)),e.outlineFilter=U4e.newInstance(),e.outlineFilter.setGenerateFaces(!0),e.outlineFilter.setGenerateLines(!1),e.cubePolyData=ca.newInstance(),e.cutter=t4e.newInstance(),e.lineToSurfaceFilter=YSe.newInstance(),e.transform=Z4e.newInstance(),Fo(t,e,["openGLTexture"]),hTe(t,e)}const mTe=Qn(gTe,"vtkOpenGLImageResliceMapper");ha("vtkImageResliceMapper",mTe);const vTe={NONE:-1,I:0,J:1,K:2,X:3,Y:4,Z:5};var WC={SlicingMode:vTe},A7=`//VTK::System::Dec

/*=========================================================================

  Program:   Visualization Toolkit
  Module:    vtkPolyDataVS.glsl

  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen
  All rights reserved.
  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.

     This software is distributed WITHOUT ANY WARRANTY; without even
     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
     PURPOSE.  See the above copyright notice for more information.

=========================================================================*/

attribute vec4 vertexMC;

// frag position in VC
//VTK::PositionVC::Dec

// optional normal declaration
//VTK::Normal::Dec

// extra lighting parameters
//VTK::Light::Dec

// Texture coordinates
//VTK::TCoord::Dec

// material property values
//VTK::Color::Dec

// clipping plane vars
//VTK::Clip::Dec

// camera and actor matrix values
//VTK::Camera::Dec

// Apple Bug
//VTK::PrimID::Dec

// picking support
//VTK::Picking::Dec

void main()
{
  //VTK::Color::Impl

  //VTK::Normal::Impl

  //VTK::TCoord::Impl

  //VTK::Clip::Impl

  //VTK::PrimID::Impl

  //VTK::PositionVC::Impl

  //VTK::Light::Impl

  //VTK::Picking::Impl
}
`,Ly=`//VTK::System::Dec

/*=========================================================================

  Program:   Visualization Toolkit
  Module:    vtkPolyDataFS.glsl

  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen
  All rights reserved.
  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.

     This software is distributed WITHOUT ANY WARRANTY; without even
     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
     PURPOSE.  See the above copyright notice for more information.

=========================================================================*/
// Template for the polydata mappers fragment shader

uniform int PrimitiveIDOffset;

// VC position of this fragment
//VTK::PositionVC::Dec

// optional color passed in from the vertex shader, vertexColor
//VTK::Color::Dec

// optional surface normal declaration
//VTK::Normal::Dec

// extra lighting parameters
//VTK::Light::Dec

// define vtkImageLabelOutlineOn
//VTK::ImageLabelOutlineOn

// Texture coordinates
//VTK::TCoord::Dec

// picking support
//VTK::Picking::Dec

// Depth Peeling Support
//VTK::DepthPeeling::Dec

// clipping plane vars
//VTK::Clip::Dec

// label outline 
//VTK::LabelOutline::Dec

// the output of this shader
//VTK::Output::Dec

// Apple Bug
//VTK::PrimID::Dec

// handle coincident offsets
//VTK::Coincident::Dec

//VTK::ZBuffer::Dec

//VTK::LabelOutlineHelperFunction

void main()
{
  // VC position of this fragment. This should not branch/return/discard.
  //VTK::PositionVC::Impl

  // Place any calls that require uniform flow (e.g. dFdx) here.
  //VTK::UniformFlow::Impl

  // Set gl_FragDepth here (gl_FragCoord.z by default)
  //VTK::Depth::Impl

  // Early depth peeling abort:
  //VTK::DepthPeeling::PreColor

  // Apple Bug
  //VTK::PrimID::Impl

  //VTK::Clip::Impl

  //VTK::Color::Impl

  // Generate the normal if we are not passed in one
  //VTK::Normal::Impl

  //VTK::TCoord::Impl

  //VTK::Light::Impl

  if (gl_FragData[0].a <= 0.0)
    {
    discard;
    }

  //VTK::DepthPeeling::Impl

  //VTK::Picking::Impl

  // handle coincident offsets
  //VTK::Coincident::Impl

  //VTK::ZBuffer::Impl

  //VTK::RenderPassFragmentShader::Impl
}
`;const{vtkErrorMacro:Vp}=wo,{SlicingMode:Hs}=WC;function yTe(t){const e=t.split(`
`),n=[];for(let r=0;r<e.length;++r){const i=e[r].trim();i.length>0&&n.push(i)}return n}function xTe(t,e){e.classHierarchy.push("vtkOpenGLImageMapper");function n(r){e.openGLTexture.releaseGraphicsResources(r),[e._colorTransferFunc,e._pwFunc,e._labelOutlineThicknessArray].forEach(i=>r.unregisterGraphicsResourceUser(i,t))}t.buildPass=r=>{if(r){e.currentRenderPass=null,e.openGLImageSlice=t.getFirstAncestorOfType("vtkOpenGLImageSlice"),e._openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer");const i=e._openGLRenderWindow;e._openGLRenderWindow=e._openGLRenderer.getLastAncestorOfType("vtkOpenGLRenderWindow"),i&&!i.isDeleted()&&i!==e._openGLRenderWindow&&n(i),e.context=e._openGLRenderWindow.getContext(),e.tris.setOpenGLRenderWindow(e._openGLRenderWindow);const a=e._openGLRenderer.getRenderable();e.openGLCamera=e._openGLRenderer.getViewNodeFor(a.getActiveCamera()),e.renderable.isA("vtkImageMapper")&&e.renderable.getSliceAtFocalPoint()&&e.renderable.setSliceFromCamera(a.getActiveCamera())}},t.translucentPass=(r,i)=>{r&&(e.currentRenderPass=i,t.render())},t.zBufferPass=r=>{r&&(e.haveSeenDepthRequest=!0,e.renderDepth=!0,t.render(),e.renderDepth=!1)},t.opaqueZBufferPass=r=>t.zBufferPass(r),t.opaquePass=r=>{r&&t.render()},t.getCoincidentParameters=(r,i)=>e.renderable.getResolveCoincidentTopology()==Dc.PolygonOffset?e.renderable.getCoincidentTopologyPolygonOffsetParameters():null,t.render=()=>{const r=e.openGLImageSlice.getRenderable(),i=e._openGLRenderer.getRenderable();t.renderPiece(i,r)},t.getShaderTemplate=(r,i,a)=>{r.Vertex=A7,r.Fragment=Ly,r.Geometry=""},t.replaceShaderValues=(r,i,a)=>{let o=r.Vertex,s=r.Fragment;o=$e.substitute(o,"//VTK::Camera::Dec",["uniform mat4 MCPCMatrix;"]).result,o=$e.substitute(o,"//VTK::PositionVC::Impl",["  gl_Position = MCPCMatrix * vertexMC;"]).result,o=$e.substitute(o,"//VTK::TCoord::Impl","tcoordVCVSOutput = tcoordMC;").result,o=$e.substitute(o,"//VTK::TCoord::Dec","attribute vec2 tcoordMC; varying vec2 tcoordVCVSOutput;").result;const l=e.openGLTexture.getComponents(),c=a.getProperty().getIndependentComponents();let f=["varying vec2 tcoordVCVSOutput;","uniform float cshift0;","uniform float cscale0;","uniform float pwfshift0;","uniform float pwfscale0;","uniform sampler2D texture1;","uniform sampler2D colorTexture1;","uniform sampler2D pwfTexture1;","uniform sampler2D labelOutlineTexture1;","uniform float opacity;","uniform float outlineOpacity;"];if(c){for(let d=1;d<l;d++)f=f.concat([`uniform float cshift${d};`,`uniform float cscale${d};`,`uniform float pwfshift${d};`,`uniform float pwfscale${d};`]);switch(l){case 1:f=f.concat(["uniform float mix0;","#define height0 0.5"]);break;case 2:f=f.concat(["uniform float mix0;","uniform float mix1;","#define height0 0.25","#define height1 0.75"]);break;case 3:f=f.concat(["uniform float mix0;","uniform float mix1;","uniform float mix2;","#define height0 0.17","#define height1 0.5","#define height2 0.83"]);break;case 4:f=f.concat(["uniform float mix0;","uniform float mix1;","uniform float mix2;","uniform float mix3;","#define height0 0.125","#define height1 0.375","#define height2 0.625","#define height3 0.875"]);break;default:Vp("Unsupported number of independent coordinates.")}}if(s=$e.substitute(s,"//VTK::TCoord::Dec",f).result,a.getProperty().getUseLabelOutline()===!0&&(s=$e.substitute(s,"//VTK::LabelOutline::Dec",["uniform int outlineThickness;","uniform float vpWidth;","uniform float vpHeight;","uniform float vpOffsetX;","uniform float vpOffsetY;","uniform mat4 PCWCMatrix;","uniform mat4 vWCtoIDX;","uniform ivec3 imageDimensions;","uniform int sliceAxis;"]).result,s=$e.substitute(s,"//VTK::ImageLabelOutlineOn","#define vtkImageLabelOutlineOn").result,s=$e.substitute(s,"//VTK::LabelOutlineHelperFunction",["#ifdef vtkImageLabelOutlineOn","vec3 fragCoordToIndexSpace(vec4 fragCoord) {","  vec4 pcPos = vec4(","    (fragCoord.x / vpWidth - vpOffsetX - 0.5) * 2.0,","    (fragCoord.y / vpHeight - vpOffsetY - 0.5) * 2.0,","    (fragCoord.z - 0.5) * 2.0,","    1.0);","","  vec4 worldCoord = PCWCMatrix * pcPos;","  vec4 vertex = (worldCoord/worldCoord.w);","","  vec3 index = (vWCtoIDX * vertex).xyz;","","  // half voxel fix for labelmapOutline","  return (index + vec3(0.5)) / vec3(imageDimensions);","}","vec2 getSliceCoords(vec3 coord, int axis) {","  if (axis == 0) return coord.yz;","  if (axis == 1) return coord.xz;","  if (axis == 2) return coord.xy;","}","#endif"]).result),c){const d=["r","g","b","a"];let h=["vec4 tvalue = texture2D(texture1, tcoordVCVSOutput);"];for(let p=0;p<l;p++)h=h.concat([`vec3 tcolor${p} = mix${p} * texture2D(colorTexture1, vec2(tvalue.${d[p]} * cscale${p} + cshift${p}, height${p})).rgb;`,`float compWeight${p} = mix${p} * texture2D(pwfTexture1, vec2(tvalue.${d[p]} * pwfscale${p} + pwfshift${p}, height${p})).r;`]);switch(l){case 1:h=h.concat(["gl_FragData[0] = vec4(tcolor0.rgb, opacity);"]);break;case 2:h=h.concat(["float weightSum = compWeight0 + compWeight1;","gl_FragData[0] = vec4(vec3((tcolor0.rgb * (compWeight0 / weightSum)) + (tcolor1.rgb * (compWeight1 / weightSum))), opacity);"]);break;case 3:h=h.concat(["float weightSum = compWeight0 + compWeight1 + compWeight2;","gl_FragData[0] = vec4(vec3((tcolor0.rgb * (compWeight0 / weightSum)) + (tcolor1.rgb * (compWeight1 / weightSum)) + (tcolor2.rgb * (compWeight2 / weightSum))), opacity);"]);break;case 4:h=h.concat(["float weightSum = compWeight0 + compWeight1 + compWeight2 + compWeight3;","gl_FragData[0] = vec4(vec3((tcolor0.rgb * (compWeight0 / weightSum)) + (tcolor1.rgb * (compWeight1 / weightSum)) + (tcolor2.rgb * (compWeight2 / weightSum)) + (tcolor3.rgb * (compWeight3 / weightSum))), opacity);"]);break;default:Vp("Unsupported number of independent coordinates.")}s=$e.substitute(s,"//VTK::TCoord::Impl",h).result}else switch(l){case 1:s=$e.substitute(s,"//VTK::TCoord::Impl",[...yTe(`
                #ifdef vtkImageLabelOutlineOn
                  vec3 centerPosIS = fragCoordToIndexSpace(gl_FragCoord);
                  float centerValue = texture2D(texture1, getSliceCoords(centerPosIS, sliceAxis)).r;
                  bool pixelOnBorder = false;
                  vec3 tColor = texture2D(colorTexture1, vec2(centerValue * cscale0 + cshift0, 0.5)).rgb;
                  float scalarOpacity = texture2D(pwfTexture1, vec2(centerValue * pwfscale0 + pwfshift0, 0.5)).r;
                  float opacityToUse = scalarOpacity * opacity;
                  int segmentIndex = int(centerValue * 255.0);
                  float textureCoordinate = float(segmentIndex - 1) / 1024.0;
                  float textureValue = texture2D(labelOutlineTexture1, vec2(textureCoordinate, 0.5)).r;
                  int actualThickness = int(textureValue * 255.0);

                  if (segmentIndex == 0){
                    gl_FragData[0] = vec4(0.0, 0.0, 0.0, 0.0);
                    return;
                  }

                  for (int i = -actualThickness; i <= actualThickness; i++) {
                    for (int j = -actualThickness; j <= actualThickness; j++) {
                      if (i == 0 || j == 0) {
                        continue;
                      }
                      vec4 neighborPixelCoord = vec4(gl_FragCoord.x + float(i),
                        gl_FragCoord.y + float(j),
                        gl_FragCoord.z, gl_FragCoord.w);
                      vec3 neighborPosIS = fragCoordToIndexSpace(neighborPixelCoord);
                      float value = texture2D(texture1, getSliceCoords(neighborPosIS, sliceAxis)).r;
                      if (value != centerValue) {
                        pixelOnBorder = true;
                        break;
                      }
                    }
                    if (pixelOnBorder == true) {
                      break;
                    }
                  }
                  if (pixelOnBorder == true) {
                    gl_FragData[0] = vec4(tColor, outlineOpacity);
                  }
                  else {
                    gl_FragData[0] = vec4(tColor, opacityToUse);
                  }
                #else
                  float intensity = texture2D(texture1, tcoordVCVSOutput).r;
                  vec3 tcolor = texture2D(colorTexture1, vec2(intensity * cscale0 + cshift0, 0.5)).rgb;
                  float scalarOpacity = texture2D(pwfTexture1, vec2(intensity * pwfscale0 + pwfshift0, 0.5)).r;
                  gl_FragData[0] = vec4(tcolor, scalarOpacity * opacity);
                #endif
                `)]).result;break;case 2:s=$e.substitute(s,"//VTK::TCoord::Impl",["vec4 tcolor = texture2D(texture1, tcoordVCVSOutput);","float intensity = tcolor.r*cscale0 + cshift0;","gl_FragData[0] = vec4(texture2D(colorTexture1, vec2(intensity, 0.5)).rgb, pwfscale0*tcolor.g + pwfshift0);"]).result;break;case 3:s=$e.substitute(s,"//VTK::TCoord::Impl",["vec4 tcolor = cscale0*texture2D(texture1, tcoordVCVSOutput.st) + cshift0;","gl_FragData[0] = vec4(texture2D(colorTexture1, vec2(tcolor.r,0.5)).r,","  texture2D(colorTexture1, vec2(tcolor.g,0.5)).r,","  texture2D(colorTexture1, vec2(tcolor.b,0.5)).r, opacity);"]).result;break;default:s=$e.substitute(s,"//VTK::TCoord::Impl",["vec4 tcolor = cscale0*texture2D(texture1, tcoordVCVSOutput.st) + cshift0;","gl_FragData[0] = vec4(texture2D(colorTexture1, vec2(tcolor.r,0.5)).r,","  texture2D(colorTexture1, vec2(tcolor.g,0.5)).r,","  texture2D(colorTexture1, vec2(tcolor.b,0.5)).r, tcolor.a);"]).result}e.haveSeenDepthRequest&&(s=$e.substitute(s,"//VTK::ZBuffer::Dec","uniform int depthRequest;").result,s=$e.substitute(s,"//VTK::ZBuffer::Impl",["if (depthRequest == 1) {","float iz = floor(gl_FragCoord.z*65535.0 + 0.1);","float rf = floor(iz/256.0)/255.0;","float gf = mod(iz,256.0)/255.0;","gl_FragData[0] = vec4(rf, gf, 0.0, 1.0); }"]).result),r.Vertex=o,r.Fragment=s,t.replaceShaderClip(r,i,a),t.replaceShaderCoincidentOffset(r,i,a)},t.replaceShaderClip=(r,i,a)=>{let o=r.Vertex,s=r.Fragment;if(e.renderable.getNumberOfClippingPlanes()){let l=e.renderable.getNumberOfClippingPlanes();l>6&&($n("OpenGL has a limit of 6 clipping planes"),l=6),o=$e.substitute(o,"//VTK::Clip::Dec",["uniform int numClipPlanes;","uniform vec4 clipPlanes[6];","varying float clipDistancesVSOutput[6];"]).result,o=$e.substitute(o,"//VTK::Clip::Impl",["for (int planeNum = 0; planeNum < 6; planeNum++)","    {","    if (planeNum >= numClipPlanes)","        {","        break;","        }","    clipDistancesVSOutput[planeNum] = dot(clipPlanes[planeNum], vertexMC);","    }"]).result,s=$e.substitute(s,"//VTK::Clip::Dec",["uniform int numClipPlanes;","varying float clipDistancesVSOutput[6];"]).result,s=$e.substitute(s,"//VTK::Clip::Impl",["for (int planeNum = 0; planeNum < 6; planeNum++)","    {","    if (planeNum >= numClipPlanes)","        {","        break;","        }","    if (clipDistancesVSOutput[planeNum] < 0.0) discard;","    }"]).result}r.Vertex=o,r.Fragment=s},t.getNeedToRebuildShaders=(r,i,a)=>{const o=e.openGLTexture.getComponents(),s=a.getProperty().getIndependentComponents();let l=!1;return(!e.currentRenderPass&&e.lastRenderPassShaderReplacement||e.currentRenderPass&&e.currentRenderPass.getShaderReplacement()!==e.lastRenderPassShaderReplacement)&&(l=!0),l||e.lastHaveSeenDepthRequest!==e.haveSeenDepthRequest||r.getProgram()?.getHandle()===0||e.lastTextureComponents!==o||e.lastIndependentComponents!==s?(e.lastHaveSeenDepthRequest=e.haveSeenDepthRequest,e.lastTextureComponents=o,e.lastIndependentComponents=s,!0):!1},t.updateShaders=(r,i,a)=>{if(e.lastBoundBO=r,t.getNeedToRebuildShaders(r,i,a)){const o={Vertex:null,Fragment:null,Geometry:null};t.buildShaders(o,i,a);const s=e._openGLRenderWindow.getShaderCache().readyShaderProgramArray(o.Vertex,o.Fragment,o.Geometry);s!==r.getProgram()&&(r.setProgram(s),r.getVAO().releaseGraphicsResources()),r.getShaderSourceTime().modified()}else e._openGLRenderWindow.getShaderCache().readyShaderProgram(r.getProgram());r.getVAO().bind(),t.setMapperShaderParameters(r,i,a),t.setCameraShaderParameters(r,i,a),t.setPropertyShaderParameters(r,i,a)},t.setMapperShaderParameters=(r,i,a)=>{r.getCABO().getElementCount()&&(e.VBOBuildTime>r.getAttributeUpdateTime().getMTime()||r.getShaderSourceTime().getMTime()>r.getAttributeUpdateTime().getMTime())&&(r.getProgram().isAttributeUsed("vertexMC")&&(r.getVAO().addAttributeArray(r.getProgram(),r.getCABO(),"vertexMC",r.getCABO().getVertexOffset(),r.getCABO().getStride(),e.context.FLOAT,3,e.context.FALSE)||Vp("Error setting vertexMC in shader VAO.")),r.getProgram().isAttributeUsed("tcoordMC")&&r.getCABO().getTCoordOffset()&&(r.getVAO().addAttributeArray(r.getProgram(),r.getCABO(),"tcoordMC",r.getCABO().getTCoordOffset(),r.getCABO().getStride(),e.context.FLOAT,r.getCABO().getTCoordComponents(),e.context.FALSE)||Vp("Error setting tcoordMC in shader VAO.")),r.getAttributeUpdateTime().modified());const o=e.openGLTexture.getTextureUnit();r.getProgram().setUniformi("texture1",o);const s=e.openGLTexture.getComponents(),l=a.getProperty().getIndependentComponents();if(l)for(let p=0;p<s;p++)r.getProgram().setUniformf(`mix${p}`,a.getProperty().getComponentWeight(p));const c=e.openGLTexture.getShiftAndScale();for(let p=0;p<s;p++){let g=a.getProperty().getColorWindow(),m=a.getProperty().getColorLevel();const y=l?p:0,v=a.getProperty().getRGBTransferFunction(y);if(v&&a.getProperty().getUseLookupTableScalarRange()){const S=v.getRange();g=S[1]-S[0],m=.5*(S[1]+S[0])}const x=c.scale/g,w=(c.shift-m)/g+.5;r.getProgram().setUniformf(`cshift${p}`,w),r.getProgram().setUniformf(`cscale${p}`,x)}for(let p=0;p<s;p++){let g=1,m=0;const y=l?p:0,v=a.getProperty().getPiecewiseFunction(y);if(v){const x=v.getRange(),w=x[1]-x[0],S=.5*(x[0]+x[1]);g=c.scale/w,m=(c.shift-S)/w+.5}r.getProgram().setUniformf(`pwfshift${p}`,m),r.getProgram().setUniformf(`pwfscale${p}`,g)}if(e.haveSeenDepthRequest&&r.getProgram().setUniformi("depthRequest",e.renderDepth?1:0),r.getProgram().isUniformUsed("coffset")){const p=t.getCoincidentParameters(i,a);r.getProgram().setUniformf("coffset",p.offset),r.getProgram().isUniformUsed("cfactor")&&r.getProgram().setUniformf("cfactor",p.factor)}const f=e.colorTexture.getTextureUnit();r.getProgram().setUniformi("colorTexture1",f);const u=e.pwfTexture.getTextureUnit();r.getProgram().setUniformi("pwfTexture1",u);const d=e.labelOutlineThicknessTexture.getTextureUnit();if(r.getProgram().setUniformi("labelOutlineTexture1",d),e.renderable.getNumberOfClippingPlanes()){let p=e.renderable.getNumberOfClippingPlanes();p>6&&($n("OpenGL has a limit of 6 clipping planes"),p=6);const m=r.getCABO().getCoordShiftAndScaleEnabled()?r.getCABO().getInverseShiftAndScaleMatrix():null,y=m?Ri(e.imagematinv,a.getMatrix()):a.getMatrix();m&&(jn(y,y),zn(y,y,m),jn(y,y)),jn(e.imagemat,e.currentInput.getIndexToWorld()),zn(e.imagematinv,y,e.imagemat);const v=[];for(let x=0;x<p;x++){const w=[];e.renderable.getClippingPlaneInDataCoords(e.imagematinv,x,w);for(let S=0;S<4;S++)v.push(w[S])}r.getProgram().setUniformi("numClipPlanes",p),r.getProgram().setUniform4fv("clipPlanes",v)}if(a.getProperty().getUseLabelOutline()===!0){const p=a.getProperty().getLabelOutlineOpacity();r.getProgram().setUniformf("outlineOpacity",p)}},t.setCameraShaderParameters=(r,i,a)=>{const o=r.getProgram(),s=e.openGLImageSlice.getKeyMatrices(),l=e.currentInput,c=l.getIndexToWorld();zn(e.imagemat,s.mcwc,c);const f=e.openGLCamera.getKeyMatrices(i);if(zn(e.imagemat,f.wcpc,e.imagemat),r.getCABO().getCoordShiftAndScaleEnabled()){const d=r.getCABO().getInverseShiftAndScaleMatrix();zn(e.imagemat,e.imagemat,d)}if(o.setUniformMatrix("MCPCMatrix",e.imagemat),a.getProperty().getUseLabelOutline()===!0){const d=l.getWorldToIndex(),h=l.getDimensions();let p=e.renderable.getClosestIJKAxis().ijkMode;p===Hs.NONE&&(p=Hs.K),o.setUniform3i("imageDimensions",h[0],h[1],h[2]),o.setUniformi("sliceAxis",p),o.setUniformMatrix("vWCtoIDX",d);const g=e.openGLCamera.getKeyMatrices(i);Ea(e.projectionToWorld,g.wcpc),e.openGLCamera.getKeyMatrices(i),o.setUniformMatrix("PCWCMatrix",e.projectionToWorld);const m=t.getRenderTargetSize();o.setUniformf("vpWidth",m[0]),o.setUniformf("vpHeight",m[1]);const y=t.getRenderTargetOffset();o.setUniformf("vpOffsetX",y[0]/m[0]),o.setUniformf("vpOffsetY",y[1]/m[1])}},t.setPropertyShaderParameters=(r,i,a)=>{const o=r.getProgram(),l=a.getProperty().getOpacity();o.setUniformf("opacity",l)},t.renderPieceStart=(r,i)=>{t.updateBufferObjects(r,i),e.lastBoundBO=null},t.renderPieceDraw=(r,i)=>{const a=e.context;e.openGLTexture.activate(),e.colorTexture.activate(),e.labelOutlineThicknessTexture.activate(),e.pwfTexture.activate(),e.tris.getCABO().getElementCount()&&(t.updateShaders(e.tris,r,i),a.drawArrays(a.TRIANGLES,0,e.tris.getCABO().getElementCount()),e.tris.getVAO().release()),e.openGLTexture.deactivate(),e.colorTexture.deactivate(),e.labelOutlineThicknessTexture.deactivate(),e.pwfTexture.deactivate()},t.renderPieceFinish=(r,i)=>{},t.renderPiece=(r,i)=>{if(t.invokeEvent({type:"StartEvent"}),e.renderable.update(),e.currentInput=e.renderable.getCurrentImage(),t.invokeEvent({type:"EndEvent"}),!e.currentInput){Vp("No input!");return}t.renderPieceStart(r,i),t.renderPieceDraw(r,i),t.renderPieceFinish(r,i)},t.computeBounds=(r,i)=>{if(!t.getInput()){jm(e.bounds);return}e.bounds=t.getInput().getBounds()},t.updateBufferObjects=(r,i)=>{t.getNeedToRebuildBufferObjects(r,i)&&t.buildBufferObjects(r,i)},t.getNeedToRebuildBufferObjects=(r,i)=>e.VBOBuildTime.getMTime()<t.getMTime()||e.VBOBuildTime.getMTime()<i.getMTime()||e.VBOBuildTime.getMTime()<e.renderable.getMTime()||e.VBOBuildTime.getMTime()<i.getProperty().getMTime()||e.VBOBuildTime.getMTime()<e.currentInput.getMTime()||!e.openGLTexture?.getHandle()||!e.colorTexture?.getHandle()||!e.labelOutlineThicknessTexture?.getHandle()||!e.pwfTexture?.getHandle(),t.buildBufferObjects=(r,i)=>{const a=e.currentInput;if(!a)return;const o=a.getPointData()&&a.getPointData().getScalars();if(!o)return;const s=o.getDataType(),l=o.getNumberOfComponents(),c=i.getProperty(),f=c.getInterpolationType(),u=c.getIndependentComponents(),d=u?l:1,h=u?2*d:1,p=c.getRGBTransferFunction(),g=bu(p,u,d),m=e._openGLRenderWindow.getGraphicsResourceForObject(p);if(!m?.oglObject?.getHandle()||m?.hash!==g){e.colorTexture=ai.newInstance({resizable:!0}),e.colorTexture.setOpenGLRenderWindow(e._openGLRenderWindow);const P=1024,N=P*h*3,A=new Uint8ClampedArray(N);if(f===Sh.NEAREST?(e.colorTexture.setMinificationFilter(an.NEAREST),e.colorTexture.setMagnificationFilter(an.NEAREST)):(e.colorTexture.setMinificationFilter(an.LINEAR),e.colorTexture.setMagnificationFilter(an.LINEAR)),p){const B=new Float32Array(P*3);for(let V=0;V<d;V++){const $=c.getRGBTransferFunction(V),U=$.getRange();if($.getTable(U[0],U[1],P,B,1),u)for(let G=0;G<P*3;G++)A[V*P*6+G]=255*B[G],A[V*P*6+G+P*3]=255*B[G];else for(let G=0;G<P*3;G++)A[V*P*6+G]=255*B[G]}e.colorTexture.resetFormatAndType(),e.colorTexture.create2DFromRaw(P,h,3,Ln.UNSIGNED_CHAR,A)}else{for(let B=0;B<P*3;++B)A[B]=255*B/((P-1)*3),A[B+1]=255*B/((P-1)*3),A[B+2]=255*B/((P-1)*3);e.colorTexture.create2DFromRaw(P,1,3,Ln.UNSIGNED_CHAR,A)}p&&(e._openGLRenderWindow.setGraphicsResourceForObject(p,e.colorTexture,g),p!==e._colorTransferFunc&&(e._openGLRenderWindow.registerGraphicsResourceUser(p,t),e._openGLRenderWindow.unregisterGraphicsResourceUser(e._colorTransferFunc,t)),e._colorTransferFunc=p)}else e.colorTexture=m.oglObject;const v=c.getPiecewiseFunction(),x=bu(v,u,d),w=e._openGLRenderWindow.getGraphicsResourceForObject(v);if(!w?.oglObject?.getHandle()||w?.hash!==x){const N=1024*h,A=new Uint8ClampedArray(N);if(e.pwfTexture=ai.newInstance({resizable:!0}),e.pwfTexture.setOpenGLRenderWindow(e._openGLRenderWindow),f===Sh.NEAREST?(e.pwfTexture.setMinificationFilter(an.NEAREST),e.pwfTexture.setMagnificationFilter(an.NEAREST)):(e.pwfTexture.setMinificationFilter(an.LINEAR),e.pwfTexture.setMagnificationFilter(an.LINEAR)),v){const B=new Float32Array(N),V=new Float32Array(1024);for(let $=0;$<d;++$){const U=c.getPiecewiseFunction($);if(U===null)B.fill(1);else{const G=U.getRange();if(U.getTable(G[0],G[1],1024,V,1),u)for(let F=0;F<1024;F++)B[$*1024*2+F]=V[F],B[$*1024*2+F+1024]=V[F];else for(let F=0;F<1024;F++)B[$*1024*2+F]=V[F]}}e.pwfTexture.resetFormatAndType(),e.pwfTexture.create2DFromRaw(1024,h,1,Ln.FLOAT,B)}else A.fill(255),e.pwfTexture.create2DFromRaw(1024,1,1,Ln.UNSIGNED_CHAR,A);v&&(e._openGLRenderWindow.setGraphicsResourceForObject(v,e.pwfTexture,x),v!==e._pwFunc&&(e._openGLRenderWindow.registerGraphicsResourceUser(v,t),e._openGLRenderWindow.unregisterGraphicsResourceUser(e._pwFunc,t)),e._pwFunc=v)}else e.pwfTexture=w.oglObject;t.updatelabelOutlineThicknessTexture(i);const{ijkMode:T}=e.renderable.getClosestIJKAxis();let _=e.renderable.getSlice();T!==e.renderable.getSlicingMode()&&(_=e.renderable.getSliceAtPosition(_));const D=e.renderable.isA("vtkImageArrayMapper")?e.renderable.getSubSlice():Math.round(_),I=a.getExtent();let R;T===Hs.I&&(R=D-I[0]),T===Hs.J&&(R=D-I[2]),(T===Hs.K||T===Hs.NONE)&&(R=D-I[4]);const O=`${_}A${a.getMTime()}A${o.getMTime()}B${t.getMTime()}C${e.renderable.getSlicingMode()}D${i.getProperty().getInterpolationType()}`;if(e.VBOBuildString!==O){const P=a.getDimensions();e.openGLTexture||(e.openGLTexture=ai.newInstance({resizable:!0})),e.openGLTexture.setOpenGLRenderWindow(e._openGLRenderWindow),e.openGLTexture.setOglNorm16Ext(e.context.getExtension("EXT_texture_norm16")),f===Sh.NEAREST?(new Set([1,3,4]).has(l)&&s===Ln.UNSIGNED_CHAR&&!u&&e.openGLTexture.setGenerateMipmap(!0),e.openGLTexture.setMinificationFilter(an.NEAREST),e.openGLTexture.setMagnificationFilter(an.NEAREST)):(l===4&&s===Ln.UNSIGNED_CHAR&&!u?(e.openGLTexture.setGenerateMipmap(!0),e.openGLTexture.setMinificationFilter(an.LINEAR_MIPMAP_LINEAR)):e.openGLTexture.setMinificationFilter(an.LINEAR),e.openGLTexture.setMagnificationFilter(an.LINEAR)),e.openGLTexture.setWrapS(q2.CLAMP_TO_EDGE),e.openGLTexture.setWrapT(q2.CLAMP_TO_EDGE);const N=P[0]*P[1]*l,A=new Float32Array(12),B=new Float32Array(8);for(let ve=0;ve<4;ve++)B[ve*2]=ve%2?1:0,B[ve*2+1]=ve>1?1:0;const V=[Hs.X,Hs.Y,Hs.Z].includes(e.renderable.getSlicingMode())?_:D,$=a.getSpatialExtent(),U=o.getData();let G=null;if(T===Hs.I){G=new U.constructor(P[2]*P[1]*l);let ve=0;for(let Ce=0;Ce<P[2];Ce++)for(let we=0;we<P[1];we++){let Ae=(R+we*P[0]+Ce*P[0]*P[1])*l;ve=(Ce*P[1]+we)*l;const Me=Ae+l;for(;Ae<Me;)G[ve++]=U[Ae++]}P[0]=P[1],P[1]=P[2],A[0]=V,A[1]=$[2],A[2]=$[4],A[3]=V,A[4]=$[3],A[5]=$[4],A[6]=V,A[7]=$[2],A[8]=$[5],A[9]=V,A[10]=$[3],A[11]=$[5]}else if(T===Hs.J){G=new U.constructor(P[2]*P[0]*l);let ve=0;for(let Ce=0;Ce<P[2];Ce++)for(let we=0;we<P[0];we++){let Ae=(we+R*P[0]+Ce*P[0]*P[1])*l;ve=(Ce*P[0]+we)*l;const Me=Ae+l;for(;Ae<Me;)G[ve++]=U[Ae++]}P[1]=P[2],A[0]=$[0],A[1]=V,A[2]=$[4],A[3]=$[1],A[4]=V,A[5]=$[4],A[6]=$[0],A[7]=V,A[8]=$[5],A[9]=$[1],A[10]=V,A[11]=$[5]}else T===Hs.K||T===Hs.NONE?(G=U.subarray(R*N,(R+1)*N),A[0]=$[0],A[1]=$[2],A[2]=V,A[3]=$[1],A[4]=$[2],A[5]=V,A[6]=$[0],A[7]=$[3],A[8]=V,A[9]=$[1],A[10]=$[3],A[11]=V):Vp("Reformat slicing not yet supported.");const F=o.getRanges();e.openGLTexture.resetFormatAndType(),e.openGLTexture.create2DFilterableFromRaw(P[0],P[1],l,o.getDataType(),G,e.renderable.getPreferSizeOverAccuracy?.(),F),e.openGLTexture.activate(),e.openGLTexture.sendParameters(),e.openGLTexture.deactivate();const J=tn.newInstance({numberOfComponents:3,values:A});J.setName("points");const Q=tn.newInstance({numberOfComponents:2,values:B});Q.setName("tcoords");const ne=new Uint16Array(8);ne[0]=3,ne[1]=0,ne[2]=1,ne[3]=3,ne[4]=3,ne[5]=0,ne[6]=3,ne[7]=2;const ye=tn.newInstance({numberOfComponents:1,values:ne});e.tris.getCABO().createVBO(ye,"polys",go.SURFACE,{points:J,tcoords:Q,cellOffset:0}),e.VBOBuildTime.modified(),e.VBOBuildString=O}},t.updatelabelOutlineThicknessTexture=r=>{const i=r.getProperty().getLabelOutlineThicknessByReference(),a=e._openGLRenderWindow.getGraphicsResourceForObject(i),o=`${i.join("-")}`;if(!a?.oglObject?.getHandle()||a?.hash!==o){const u=new Uint8Array(1024);for(let d=0;d<1024;++d){const h=typeof i[d]<"u"?i[d]:i[0];u[d]=h}e.labelOutlineThicknessTexture=ai.newInstance({resizable:!1}),e.labelOutlineThicknessTexture.setOpenGLRenderWindow(e._openGLRenderWindow),e.labelOutlineThicknessTexture.resetFormatAndType(),e.labelOutlineThicknessTexture.setMinificationFilter(an.NEAREST),e.labelOutlineThicknessTexture.setMagnificationFilter(an.NEAREST),e.labelOutlineThicknessTexture.create2DFromRaw(1024,1,1,Ln.UNSIGNED_CHAR,u),i&&(e._openGLRenderWindow.setGraphicsResourceForObject(i,e.labelOutlineThicknessTexture,o),i!==e._labelOutlineThicknessArray&&(e._openGLRenderWindow.registerGraphicsResourceUser(i,t),e._openGLRenderWindow.unregisterGraphicsResourceUser(e._labelOutlineThicknessArray,t)),e._labelOutlineThicknessArray=i)}else e.labelOutlineThicknessTexture=a.oglObject},t.getRenderTargetSize=()=>{if(e._useSmallViewport)return[e._smallViewportWidth,e._smallViewportHeight];const{usize:r,vsize:i}=e._openGLRenderer.getTiledSizeAndOrigin();return[r,i]},t.getRenderTargetOffset=()=>{const{lowerLeftU:r,lowerLeftV:i}=e._openGLRenderer.getTiledSizeAndOrigin();return[r,i]},t.delete=Oy(()=>{e._openGLRenderWindow&&n(e._openGLRenderWindow)},t.delete)}const bTe={VBOBuildTime:0,VBOBuildString:null,openGLTexture:null,tris:null,imagemat:null,imagematinv:null,colorTexture:null,pwfTexture:null,labelOutlineThicknessTexture:null,labelOutlineThicknessTextureString:null,lastHaveSeenDepthRequest:!1,haveSeenDepthRequest:!1,lastTextureComponents:0};function wTe(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,bTe,n),kr.extend(t,e,n),xu.implementReplaceShaderCoincidentOffset(t,e,n),xu.implementBuildShadersWithReplacements(t,e,n),e.tris=Du.newInstance(),e.imagemat=on(new Float64Array(16)),e.imagematinv=on(new Float64Array(16)),e.projectionToWorld=on(new Float64Array(16)),e.idxToView=on(new Float64Array(16)),e.idxNormalMatrix=Bl(new Float64Array(9)),e.modelToView=on(new Float64Array(16)),e.projectionToView=on(new Float64Array(16)),Ni(t,e,[]),e.VBOBuildTime={},Wr(e.VBOBuildTime),xTe(t,e)}const cJ=Qn(wTe,"vtkOpenGLImageMapper");var CTe={newInstance:cJ};ha("vtkAbstractImageMapper",cJ);const F0={MAX:0,MIN:1,AVERAGE:2},{vtkErrorMacro:Ux}=ce;function STe(t,e){e.classHierarchy.push("vtkOpenGLImageCPRMapper");function n(r){[e._scalars,e._colorTransferFunc,e._pwFunc].forEach(i=>r.unregisterGraphicsResourceUser(i,t))}t.buildPass=r=>{if(r){e.currentRenderPass=null,e.openGLImageSlice=t.getFirstAncestorOfType("vtkOpenGLImageSlice"),e._openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer");const i=e._openGLRenderWindow;e._openGLRenderWindow=e._openGLRenderer.getLastAncestorOfType("vtkOpenGLRenderWindow"),i&&!i.isDeleted()&&i!==e._openGLRenderWindow&&n(i),e.context=e._openGLRenderWindow.getContext(),e.openGLCamera=e._openGLRenderer.getViewNodeFor(e._openGLRenderer.getRenderable().getActiveCamera()),e.tris.setOpenGLRenderWindow(e._openGLRenderWindow)}},t.opaquePass=(r,i)=>{r&&(e.currentRenderPass=i,t.render())},t.opaqueZBufferPass=r=>{r&&(e.haveSeenDepthRequest=!0,e.renderDepth=!0,t.render(),e.renderDepth=!1)},t.getCoincidentParameters=(r,i)=>e.renderable.getResolveCoincidentTopology()===Dc.PolygonOffset?e.renderable.getCoincidentTopologyPolygonOffsetParameters():null,t.render=()=>{const r=e.openGLImageSlice.getRenderable(),i=e._openGLRenderer.getRenderable();t.renderPiece(i,r)},t.renderPiece=(r,i)=>{t.invokeEvent({type:"StartEvent"}),e.renderable.update(),t.invokeEvent({type:"EndEvent"}),e.renderable.preRenderCheck()&&(e.currentImageDataInput=e.renderable.getInputData(0),e.currentCenterlineInput=e.renderable.getOrientedCenterline(),t.renderPieceStart(r,i),t.renderPieceDraw(r,i),t.renderPieceFinish(r,i))},t.renderPieceStart=(r,i)=>{t.updateBufferObjects(r,i)},t.renderPieceDraw=(r,i)=>{const a=e.context;e.volumeTexture.activate(),e.colorTexture.activate(),e.pwfTexture.activate(),e.tris.getCABO().getElementCount()&&(t.updateShaders(e.tris,r,i),a.drawArrays(a.TRIANGLES,0,e.tris.getCABO().getElementCount()),e.tris.getVAO().release()),e.volumeTexture.deactivate(),e.colorTexture.deactivate(),e.pwfTexture.deactivate()},t.renderPieceFinish=(r,i)=>{},t.updateBufferObjects=(r,i)=>{t.getNeedToRebuildBufferObjects(r,i)&&t.buildBufferObjects(r,i),i.getProperty().getInterpolationType()===Sh.NEAREST?(e.volumeTexture.setMinificationFilter(an.NEAREST),e.volumeTexture.setMagnificationFilter(an.NEAREST),e.colorTexture.setMinificationFilter(an.NEAREST),e.colorTexture.setMagnificationFilter(an.NEAREST),e.pwfTexture.setMinificationFilter(an.NEAREST),e.pwfTexture.setMagnificationFilter(an.NEAREST)):(e.volumeTexture.setMinificationFilter(an.LINEAR),e.volumeTexture.setMagnificationFilter(an.LINEAR),e.colorTexture.setMinificationFilter(an.LINEAR),e.colorTexture.setMagnificationFilter(an.LINEAR),e.pwfTexture.setMinificationFilter(an.LINEAR),e.pwfTexture.setMagnificationFilter(an.LINEAR))},t.getNeedToRebuildBufferObjects=(r,i)=>{const a=e.VBOBuildTime.getMTime();return a<t.getMTime()||a<e.renderable.getMTime()||a<i.getMTime()||a<e.currentImageDataInput.getMTime()||a<e.currentCenterlineInput.getMTime()||!e.volumeTexture?.getHandle()},t.buildBufferObjects=(r,i)=>{const a=e.currentImageDataInput,o=e.currentCenterlineInput,s=a?.getPointData()?.getScalars();if(!s)return;const l=e._openGLRenderWindow.getGraphicsResourceForObject(s),c=R7(a,s),f=!l?.oglObject?.getHandle()||l?.hash!==c,u=e.renderable.getUpdatedExtents(),d=!!u.length;if(f){e.volumeTexture=ai.newInstance(),e.volumeTexture.setOpenGLRenderWindow(e._openGLRenderWindow);const R=a.getDimensions();e.volumeTexture.setOglNorm16Ext(e.context.getExtension("EXT_texture_norm16")),e.volumeTexture.resetFormatAndType(),e.volumeTexture.create3DFilterableFromDataArray(R[0],R[1],R[2],s,e.renderable.getPreferSizeOverAccuracy()),e._openGLRenderWindow.setGraphicsResourceForObject(s,e.volumeTexture,c),s!==e._scalars&&(e._openGLRenderWindow.registerGraphicsResourceUser(s,t),e._openGLRenderWindow.unregisterGraphicsResourceUser(e._scalars,t)),e._scalars=s}else e.volumeTexture=l.oglObject;if(d){e.renderable.setUpdatedExtents([]);const R=a.getDimensions();e.volumeTexture.create3DFilterableFromDataArray(R[0],R[1],R[2],s,!1,u)}const h=s.getNumberOfComponents(),p=i.getProperty(),g=p.getIndependentComponents(),m=g?h:1,y=g?2*m:1,v=p.getRGBTransferFunction(),x=bu(v,g,m),w=e._openGLRenderWindow.getGraphicsResourceForObject(v);if(!w?.oglObject?.getHandle()||w?.hash!==x){const O=1024*y*3,P=new Uint8ClampedArray(O);if(e.colorTexture=ai.newInstance(),e.colorTexture.setOpenGLRenderWindow(e._openGLRenderWindow),v){const N=new Float32Array(3072);for(let A=0;A<m;A++){const B=p.getRGBTransferFunction(A),V=B.getRange();if(B.getTable(V[0],V[1],1024,N,1),g)for(let $=0;$<1024*3;$++)P[A*1024*6+$]=255*N[$],P[A*1024*6+$+1024*3]=255*N[$];else for(let $=0;$<1024*3;$++)P[A*1024*6+$]=255*N[$]}e.colorTexture.resetFormatAndType(),e.colorTexture.create2DFromRaw(1024,y,3,Ln.UNSIGNED_CHAR,P)}else{for(let N=0;N<1024*3;++N)P[N]=255*N/(1023*3),P[N+1]=255*N/(1023*3),P[N+2]=255*N/(1023*3);e.colorTexture.resetFormatAndType(),e.colorTexture.create2DFromRaw(1024,1,3,Ln.UNSIGNED_CHAR,P)}v&&(e._openGLRenderWindow.setGraphicsResourceForObject(v,e.colorTexture,x),v!==e._colorTransferFunc&&(e._openGLRenderWindow.registerGraphicsResourceUser(v,t),e._openGLRenderWindow.unregisterGraphicsResourceUser(e._colorTransferFunc,t)),e._colorTransferFunc=v)}else e.colorTexture=w.oglObject;const T=p.getPiecewiseFunction(),_=bu(T,g,m),D=e._openGLRenderWindow.getGraphicsResourceForObject(T);if(!D?.oglObject?.getHandle()||D?.hash!==_){const O=1024*y,P=new Uint8ClampedArray(O);if(e.pwfTexture=ai.newInstance(),e.pwfTexture.setOpenGLRenderWindow(e._openGLRenderWindow),T){const N=new Float32Array(O),A=new Float32Array(1024);for(let B=0;B<m;++B){const V=p.getPiecewiseFunction(B);if(V===null)N.fill(1);else{const $=V.getRange();if(V.getTable($[0],$[1],1024,A,1),g)for(let U=0;U<1024;U++)N[B*1024*2+U]=A[U],N[B*1024*2+U+1024]=A[U];else for(let U=0;U<1024;U++)N[B*1024*2+U]=A[U]}}e.pwfTexture.resetFormatAndType(),e.pwfTexture.create2DFromRaw(1024,y,1,Ln.FLOAT,N)}else P.fill(255),e.pwfTexture.resetFormatAndType(),e.pwfTexture.create2DFromRaw(1024,1,1,Ln.UNSIGNED_CHAR,P);T&&(e._openGLRenderWindow.setGraphicsResourceForObject(T,e.pwfTexture,_),T!==e._pwFunc&&(e._openGLRenderWindow.registerGraphicsResourceUser(T,t),e._openGLRenderWindow.unregisterGraphicsResourceUser(e._pwFunc,t)),e._pwFunc=T)}else e.pwfTexture=D.oglObject;if(e.VBOBuildTime.getMTime()<e.renderable.getMTime()||e.VBOBuildTime.getMTime()<o.getMTime()){const R=o.getNumberOfPoints(),O=R<=1?0:R-1,P=o.getDistancesToFirstPoint(),N=e.renderable.getHeight(),A=4*O,B=new Float32Array(3*A),V=e.renderable.getWidth();for(let Ae=0,Me=0;Ae<O;++Ae)B.set([0,N-P[Ae],0],Me),Me+=3,B.set([V,N-P[Ae],0],Me),Me+=3,B.set([V,N-P[Ae+1],0],Me),Me+=3,B.set([0,N-P[Ae+1],0],Me),Me+=3;const $=tn.newInstance({numberOfComponents:3,values:B});$.setName("points");const U=new Uint16Array(5*O);for(let Ae=0,Me=0,q=0;Ae<O;++Ae)U.set([4,q+3,q+2,q+1,q],Me),Me+=5,q+=4;const G=tn.newInstance({numberOfComponents:1,values:U}),F=o.getPoints(),J=new Float32Array(3*A),Q=new Array(3),ne=new Array(3);for(let Ae=0,Me=0;Ae<O;++Ae)F.getPoint(Ae,Q),F.getPoint(Ae+1,ne),J.set(Q,Me),Me+=3,J.set(Q,Me),Me+=3,J.set(ne,Me),Me+=3,J.set(ne,Me),Me+=3;const ye=tn.newInstance({numberOfComponents:3,values:J,name:"centerlinePosition"}),ve=new Float32Array(A);for(let Ae=0,Me=0;Ae<O;++Ae)ve.set([0,1,3,2],Me),Me+=4;const Ce=tn.newInstance({numberOfComponents:1,values:ve,name:"quadIndex"}),we=[ye,Ce];if(!e.renderable.getUseUniformOrientation()){const Ae=e.renderable.getOrientedCenterline().getOrientations()??[],Me=new Float32Array(4*A),q=new Float32Array(4*A);for(let X=0;X<O;++X){const re=Ae[X],de=Ae[X+1];for(let he=0;he<4;++he){const Oe=4*(he+4*X);Me.set(re,Oe),q.set(de,Oe)}}const k=tn.newInstance({numberOfComponents:4,values:Me,name:"centerlineTopOrientation"}),Y=tn.newInstance({numberOfComponents:4,values:q,name:"centerlineBotOrientation"});we.push(k,Y)}e.tris.getCABO().createVBO(G,"polys",go.SURFACE,{points:$,customAttributes:we}),e.VBOBuildTime.modified()}},t.getNeedToRebuildShaders=(r,i,a)=>{const o=e.volumeTexture.getComponents(),s=a.getProperty().getIndependentComponents(),l=!!e.renderable.getCenterPoint(),c=e.renderable.getUseUniformOrientation(),f=e.renderable.isProjectionEnabled()&&e.renderable.getProjectionMode();return r.getProgram()===0||e.lastUseCenterPoint!==l||e.lastUseUniformOrientation!==c||e.lastProjectionMode!==f||e.lastHaveSeenDepthRequest!==e.haveSeenDepthRequest||e.lastTextureComponents!==o||e.lastIndependentComponents!==s?(e.lastUseCenterPoint=l,e.lastUseUniformOrientation=c,e.lastProjectionMode=f,e.lastHaveSeenDepthRequest=e.haveSeenDepthRequest,e.lastTextureComponents=o,e.lastIndependentComponents=s,!0):!1},t.buildShaders=(r,i,a)=>{t.getShaderTemplate(r,i,a),t.replaceShaderValues(r,i,a)},t.replaceShaderValues=(r,i,a)=>{let o=r.Vertex,s=r.Fragment;const l=["vec3 applyQuaternionToVec(vec4 q, vec3 v) {","  float uvx = q.y * v.z - q.z * v.y;","  float uvy = q.z * v.x - q.x * v.z;","  float uvz = q.x * v.y - q.y * v.x;","  float uuvx = q.y * uvz - q.z * uvy;","  float uuvy = q.z * uvx - q.x * uvz;","  float uuvz = q.x * uvy - q.y * uvx;","  float w2 = q.w * 2.0;","  uvx *= w2;","  uvy *= w2;","  uvz *= w2;","  uuvx *= 2.0;","  uuvy *= 2.0;","  uuvz *= 2.0;","  return vec3(v.x + uvx + uuvx, v.y + uvy + uuvy, v.z + uvz + uuvz);","}"];o=$e.substitute(o,"//VTK::Camera::Dec",["uniform mat4 MCPCMatrix;"]).result,o=$e.substitute(o,"//VTK::PositionVC::Impl",["  gl_Position = MCPCMatrix * vertexMC;"]).result;const c=["attribute vec3 centerlinePosition;","attribute float quadIndex;","uniform float width;","out vec2 quadOffsetVSOutput;","out vec3 centerlinePosVSOutput;"],f=e.renderable.isProjectionEnabled(),u=e.renderable.getUseUniformOrientation();u?(c.push("out vec3 samplingDirVSOutput;","uniform vec4 centerlineOrientation;","uniform vec3 tangentDirection;",...l),f&&c.push("out vec3 projectionDirVSOutput;","uniform vec3 bitangentDirection;")):c.push("out vec4 centerlineTopOrientationVSOutput;","out vec4 centerlineBotOrientationVSOutput;","attribute vec4 centerlineTopOrientation;","attribute vec4 centerlineBotOrientation;"),o=$e.substitute(o,"//VTK::Color::Dec",c).result;const d=["quadOffsetVSOutput = vec2(width * (mod(quadIndex, 2.0) == 0.0 ? -0.5 : 0.5), quadIndex > 1.0 ? 0.0 : 1.0);","centerlinePosVSOutput = centerlinePosition;"];u?(d.push("samplingDirVSOutput = applyQuaternionToVec(centerlineOrientation, tangentDirection);"),f&&d.push("projectionDirVSOutput = applyQuaternionToVec(centerlineOrientation, bitangentDirection);")):d.push("centerlineTopOrientationVSOutput = centerlineTopOrientation;","centerlineBotOrientationVSOutput = centerlineBotOrientation;"),o=$e.substitute(o,"//VTK::Color::Impl",d).result;const h=e.volumeTexture.getComponents(),p=a.getProperty().getIndependentComponents();let g=["uniform mat4 MCTCMatrix; // Model coordinates to texture coordinates","in vec2 quadOffsetVSOutput;","in vec3 centerlinePosVSOutput;","uniform highp sampler3D volumeTexture;","uniform sampler2D colorTexture1;","uniform sampler2D pwfTexture1;","uniform float opacity;","uniform vec4 backgroundColor;","uniform float cshift0;","uniform float cscale0;","uniform float pwfshift0;","uniform float pwfscale0;"];f&&g.push("uniform vec3 volumeSizeMC;","uniform int projectionSlabNumberOfSamples;","uniform float projectionConstantOffset;","uniform float projectionStepLength;"),u?(g.push("in vec3 samplingDirVSOutput;"),f&&g.push("in vec3 projectionDirVSOutput;")):(g.push("uniform vec3 tangentDirection;","in vec4 centerlineTopOrientationVSOutput;","in vec4 centerlineBotOrientationVSOutput;",...l),f&&g.push("uniform vec3 bitangentDirection;"));const m=e.renderable.getCenterPoint();if(m&&g.push("uniform vec3 globalCenterPoint;"),p){for(let v=1;v<h;v++)g=g.concat([`uniform float cshift${v};`,`uniform float cscale${v};`,`uniform float pwfshift${v};`,`uniform float pwfscale${v};`]);switch(h){case 1:g=g.concat(["uniform float mix0;","#define height0 0.5"]);break;case 2:g=g.concat(["uniform float mix0;","uniform float mix1;","#define height0 0.25","#define height1 0.75"]);break;case 3:g=g.concat(["uniform float mix0;","uniform float mix1;","uniform float mix2;","#define height0 0.17","#define height1 0.5","#define height2 0.83"]);break;case 4:g=g.concat(["uniform float mix0;","uniform float mix1;","uniform float mix2;","uniform float mix3;","#define height0 0.125","#define height1 0.375","#define height2 0.625","#define height3 0.875"]);break;default:Ux("Unsupported number of independent coordinates.")}}s=$e.substitute(s,"//VTK::TCoord::Dec",g).result;let y=[];if(u?(y.push("vec3 samplingDirection = samplingDirVSOutput;"),f&&y.push("vec3 projectionDirection = projectionDirVSOutput;")):(y.push("vec4 q0 = centerlineBotOrientationVSOutput;","vec4 q1 = centerlineTopOrientationVSOutput;","float qCosAngle = dot(q0, q1);","vec4 interpolatedOrientation;","if (qCosAngle > 0.999 || qCosAngle < -0.999) {","  // Use LERP instead of SLERP when the two quaternions are close or opposite","  interpolatedOrientation = normalize(mix(q0, q1, quadOffsetVSOutput.y));","} else {","  float omega = acos(qCosAngle);","  interpolatedOrientation = normalize(sin((1.0 - quadOffsetVSOutput.y) * omega) * q0 + sin(quadOffsetVSOutput.y * omega) * q1);","}","vec3 samplingDirection = applyQuaternionToVec(interpolatedOrientation, tangentDirection);"),f&&y.push("vec3 projectionDirection = applyQuaternionToVec(interpolatedOrientation, bitangentDirection);")),m?y.push("float baseOffset = dot(samplingDirection, globalCenterPoint - centerlinePosVSOutput);","float horizontalOffset = quadOffsetVSOutput.x + baseOffset;"):y.push("float horizontalOffset = quadOffsetVSOutput.x;"),y.push("vec3 volumePosMC = centerlinePosVSOutput + horizontalOffset * samplingDirection;","vec3 volumePosTC = (MCTCMatrix * vec4(volumePosMC, 1.0)).xyz;","if (any(lessThan(volumePosTC, vec3(0.0))) || any(greaterThan(volumePosTC, vec3(1.0))))","{","  // set the background color and exit","  gl_FragData[0] = backgroundColor;","  return;","}"),f){const v=e.renderable.getProjectionMode();switch(v){case F0.MIN:y.push("const vec4 initialProjectionTextureValue = vec4(1.0);");break;case F0.MAX:case F0.AVERAGE:default:y.push("const vec4 initialProjectionTextureValue = vec4(0.0);");break}switch(y.push("vec3 projectionScaledDirection = projectionDirection / volumeSizeMC;","vec3 projectionStep = projectionStepLength * projectionScaledDirection;","vec3 projectionStartPosition = volumePosTC + projectionConstantOffset * projectionScaledDirection;","vec4 tvalue = initialProjectionTextureValue;","for (int projectionSampleIdx = 0; projectionSampleIdx < projectionSlabNumberOfSamples; ++projectionSampleIdx) {","  vec3 projectionSamplePosition = projectionStartPosition + float(projectionSampleIdx) * projectionStep;","  vec4 sampledTextureValue = texture(volumeTexture, projectionSamplePosition);"),v){case F0.MAX:y.push("  tvalue = max(tvalue, sampledTextureValue);");break;case F0.MIN:y.push("  tvalue = min(tvalue, sampledTextureValue);");break;case F0.AVERAGE:default:y.push("  tvalue = tvalue + sampledTextureValue;");break}y.push("}"),v===F0.AVERAGE&&y.push("tvalue = tvalue / float(projectionSlabNumberOfSamples);")}else y.push("vec4 tvalue = texture(volumeTexture, volumePosTC);");if(p){const v=["r","g","b","a"];for(let x=0;x<h;++x)y=y.concat([`vec3 tcolor${x} = mix${x} * texture2D(colorTexture1, vec2(tvalue.${v[x]} * cscale${x} + cshift${x}, height${x})).rgb;`,`float compWeight${x} = mix${x} * texture2D(pwfTexture1, vec2(tvalue.${v[x]} * pwfscale${x} + pwfshift${x}, height${x})).r;`]);switch(h){case 1:y=y.concat(["gl_FragData[0] = vec4(tcolor0.rgb, compWeight0 * opacity);"]);break;case 2:y=y.concat(["float weightSum = compWeight0 + compWeight1;","gl_FragData[0] = vec4(vec3((tcolor0.rgb * (compWeight0 / weightSum)) + (tcolor1.rgb * (compWeight1 / weightSum))), opacity);"]);break;case 3:y=y.concat(["float weightSum = compWeight0 + compWeight1 + compWeight2;","gl_FragData[0] = vec4(vec3((tcolor0.rgb * (compWeight0 / weightSum)) + (tcolor1.rgb * (compWeight1 / weightSum)) + (tcolor2.rgb * (compWeight2 / weightSum))), opacity);"]);break;case 4:y=y.concat(["float weightSum = compWeight0 + compWeight1 + compWeight2 + compWeight3;","gl_FragData[0] = vec4(vec3((tcolor0.rgb * (compWeight0 / weightSum)) + (tcolor1.rgb * (compWeight1 / weightSum)) + (tcolor2.rgb * (compWeight2 / weightSum)) + (tcolor3.rgb * (compWeight3 / weightSum))), opacity);"]);break;default:Ux("Unsupported number of independent coordinates.")}}else switch(h){case 1:y=y.concat(["// Dependent components","float intensity = tvalue.r;","vec3 tcolor = texture2D(colorTexture1, vec2(intensity * cscale0 + cshift0, 0.5)).rgb;","float scalarOpacity = texture2D(pwfTexture1, vec2(intensity * pwfscale0 + pwfshift0, 0.5)).r;","gl_FragData[0] = vec4(tcolor, scalarOpacity * opacity);"]);break;case 2:y=y.concat(["float intensity = tvalue.r*cscale0 + cshift0;","gl_FragData[0] = vec4(texture2D(colorTexture1, vec2(intensity, 0.5)).rgb, pwfscale0*tvalue.g + pwfshift0);"]);break;case 3:y=y.concat(["vec4 tcolor = cscale0*tvalue + cshift0;","gl_FragData[0] = vec4(texture2D(colorTexture1, vec2(tcolor.r,0.5)).r,","  texture2D(colorTexture1, vec2(tcolor.g,0.5)).r,","  texture2D(colorTexture1, vec2(tcolor.b,0.5)).r, opacity);"]);break;default:y=y.concat(["vec4 tcolor = cscale0*tvalue + cshift0;","gl_FragData[0] = vec4(texture2D(colorTexture1, vec2(tcolor.r,0.5)).r,","  texture2D(colorTexture1, vec2(tcolor.g,0.5)).r,","  texture2D(colorTexture1, vec2(tcolor.b,0.5)).r, tcolor.a);"])}s=$e.substitute(s,"//VTK::TCoord::Impl",y).result,e.haveSeenDepthRequest&&(s=$e.substitute(s,"//VTK::ZBuffer::Dec","uniform int depthRequest;").result,s=$e.substitute(s,"//VTK::ZBuffer::Impl",["if (depthRequest == 1) {","float iz = floor(gl_FragCoord.z*65535.0 + 0.1);","float rf = floor(iz/256.0)/255.0;","float gf = mod(iz,256.0)/255.0;","gl_FragData[0] = vec4(rf, gf, 0.0, 1.0); }"]).result),r.Vertex=o,r.Fragment=s,t.replaceShaderClip(r,i,a),t.replaceShaderCoincidentOffset(r,i,a)},t.replaceShaderClip=(r,i,a)=>{let o=r.Vertex,s=r.Fragment;if(e.renderable.getNumberOfClippingPlanes()){let l=e.renderable.getNumberOfClippingPlanes();l>6&&(ce.vtkErrorMacro("OpenGL has a limit of 6 clipping planes"),l=6),o=$e.substitute(o,"//VTK::Clip::Dec",["uniform int numClipPlanes;","uniform vec4 clipPlanes[6];","varying float clipDistancesVSOutput[6];"]).result,o=$e.substitute(o,"//VTK::Clip::Impl",["for (int planeNum = 0; planeNum < 6; planeNum++)","    {","    if (planeNum >= numClipPlanes)","        {","        break;","        }","    clipDistancesVSOutput[planeNum] = dot(clipPlanes[planeNum], vertexMC);","    }"]).result,s=$e.substitute(s,"//VTK::Clip::Dec",["uniform int numClipPlanes;","varying float clipDistancesVSOutput[6];"]).result,s=$e.substitute(s,"//VTK::Clip::Impl",["for (int planeNum = 0; planeNum < 6; planeNum++)","    {","    if (planeNum >= numClipPlanes)","        {","        break;","        }","    if (clipDistancesVSOutput[planeNum] < 0.0) discard;","    }"]).result}r.Vertex=o,r.Fragment=s},t.getShaderTemplate=(r,i,a)=>{r.Vertex=A7,r.Fragment=Ly,r.Geometry=""},t.setMapperShaderParameters=(r,i,a)=>{const o=r.getProgram(),s=r.getCABO();s.getElementCount()&&(e.VBOBuildTime.getMTime()>r.getAttributeUpdateTime().getMTime()||r.getShaderSourceTime().getMTime()>r.getAttributeUpdateTime().getMTime())&&(o.isAttributeUsed("vertexMC")&&(r.getVAO().addAttributeArray(o,s,"vertexMC",s.getVertexOffset(),s.getStride(),e.context.FLOAT,3,e.context.FALSE)||Ux("Error setting vertexMC in shader VAO.")),r.getCABO().getCustomData().forEach(h=>{h&&o.isAttributeUsed(h.name)&&!r.getVAO().addAttributeArray(o,s,h.name,h.offset,s.getStride(),e.context.FLOAT,h.components,e.context.FALSE)&&Ux(`Error setting ${h.name} in shader VAO.`)}),r.getAttributeUpdateTime().modified());const l=e.volumeTexture.getTextureUnit();if(o.setUniformi("volumeTexture",l),o.setUniformf("width",e.renderable.getWidth()),r.getProgram().setUniform4fv("backgroundColor",e.renderable.getBackgroundColor()),o.isUniformUsed("tangentDirection")){const h=e.renderable.getTangentDirection();r.getProgram().setUniform3fArray("tangentDirection",h)}if(o.isUniformUsed("bitangentDirection")){const h=e.renderable.getBitangentDirection();r.getProgram().setUniform3fArray("bitangentDirection",h)}if(o.isUniformUsed("centerlineOrientation")){const h=e.renderable.getUniformOrientation();r.getProgram().setUniform4fv("centerlineOrientation",h)}if(o.isUniformUsed("globalCenterPoint")){const h=e.renderable.getCenterPoint();o.setUniform3fArray("globalCenterPoint",h)}if(e.renderable.isProjectionEnabled()){const h=e.currentImageDataInput,p=h.getSpacing(),g=h.getDimensions(),m=e.renderable.getProjectionSlabThickness(),y=e.renderable.getProjectionSlabNumberOfSamples(),v=D3e([],p,g);o.setUniform3fArray("volumeSizeMC",v),o.setUniformi("projectionSlabNumberOfSamples",y);const x=-.5*m;o.setUniformf("projectionConstantOffset",x);const w=m/(y-1);o.setUniformf("projectionStepLength",w)}const c=e.currentImageDataInput,f=c.getWorldToIndex(),u=m7(new Float32Array(16),kX([],c.getDimensions())),d=i3(u,u,f);if(o.setUniformMatrix("MCTCMatrix",d),e.haveSeenDepthRequest&&r.getProgram().setUniformi("depthRequest",e.renderDepth?1:0),e.renderable.getNumberOfClippingPlanes()){let h=e.renderable.getNumberOfClippingPlanes();h>6&&(ce.vtkErrorMacro("OpenGL has a limit of 6 clipping planes"),h=6);const g=s.getCoordShiftAndScaleEnabled()?s.getInverseShiftAndScaleMatrix():null,m=g?Ri(e.imagematinv,a.getMatrix()):a.getMatrix();g&&(jn(m,m),zn(m,m,g),jn(m,m)),jn(e.imagemat,e.currentImageDataInput.getIndexToWorld()),zn(e.imagematinv,m,e.imagemat);const y=[];for(let v=0;v<h;v++){const x=[];e.renderable.getClippingPlaneInDataCoords(e.imagematinv,v,x);for(let w=0;w<4;w++)y.push(x[w])}o.setUniformi("numClipPlanes",h),o.setUniform4fv("clipPlanes",y)}if(o.isUniformUsed("coffset")){const h=t.getCoincidentParameters(i,a);o.setUniformf("coffset",h.offset),o.isUniformUsed("cfactor")&&o.setUniformf("cfactor",h.factor)}},t.setCameraShaderParameters=(r,i,a)=>{const o=e.openGLImageSlice.getKeyMatrices().mcwc,s=e.openGLCamera.getKeyMatrices(i).wcpc;if(zn(e.imagemat,s,o),r.getCABO().getCoordShiftAndScaleEnabled()){const l=r.getCABO().getInverseShiftAndScaleMatrix();zn(e.imagemat,e.imagemat,l)}r.getProgram().setUniformMatrix("MCPCMatrix",e.imagemat)},t.setPropertyShaderParameters=(r,i,a)=>{const o=r.getProgram(),s=a.getProperty(),l=s.getOpacity();o.setUniformf("opacity",l);const c=e.volumeTexture.getComponents(),f=s.getIndependentComponents();if(f)for(let p=0;p<c;++p)o.setUniformf(`mix${p}`,s.getComponentWeight(p));const u=e.volumeTexture.getVolumeInfo();for(let p=0;p<c;p++){let g=s.getColorWindow(),m=s.getColorLevel();const y=f?p:0,v=s.getRGBTransferFunction(y);if(v&&s.getUseLookupTableScalarRange()){const S=v.getRange();g=S[1]-S[0],m=.5*(S[1]+S[0])}const x=u.scale[p]/g,w=(u.offset[p]-m)/g+.5;o.setUniformf(`cshift${p}`,w),o.setUniformf(`cscale${p}`,x)}const d=e.colorTexture.getTextureUnit();o.setUniformi("colorTexture1",d);for(let p=0;p<c;p++){let g=1,m=0;const y=f?p:0,v=s.getPiecewiseFunction(y);if(v){const x=v.getRange(),w=x[1]-x[0],S=.5*(x[0]+x[1]);g=u.scale[p]/w,m=(u.offset[p]-S)/w+.5}o.setUniformf(`pwfshift${p}`,m),o.setUniformf(`pwfscale${p}`,g)}const h=e.pwfTexture.getTextureUnit();o.setUniformi("pwfTexture1",h)},t.updateShaders=(r,i,a)=>{if(t.getNeedToRebuildShaders(r,i,a)){const o={Vertex:null,Fragment:null,Geometry:null};t.buildShaders(o,i,a);const s=e._openGLRenderWindow.getShaderCache().readyShaderProgramArray(o.Vertex,o.Fragment,o.Geometry);s!==r.getProgram()&&(r.setProgram(s),r.getVAO().releaseGraphicsResources()),r.getShaderSourceTime().modified()}else e._openGLRenderWindow.getShaderCache().readyShaderProgram(r.getProgram());r.getVAO().bind(),t.setMapperShaderParameters(r,i,a),t.setCameraShaderParameters(r,i,a),t.setPropertyShaderParameters(r,i,a)},t.delete=ce.chain(()=>{e._openGLRenderWindow&&n(e._openGLRenderWindow)},t.delete)}const TTe={currentRenderPass:null,volumeTexture:null,colorTexture:null,pwfTexture:null,tris:null,lastHaveSeenDepthRequest:!1,haveSeenDepthRequest:!1,lastTextureComponents:0,lastIndependentComponents:0,imagemat:null,imagematinv:null};function ETe(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,TTe,n),kr.extend(t,e,n),xu.implementReplaceShaderCoincidentOffset(t,e,n),ce.algo(t,e,2,0),e.tris=Du.newInstance(),e.volumeTexture=null,e.colorTexture=null,e.pwfTexture=null,e.imagemat=on(new Float64Array(16)),e.imagematinv=on(new Float64Array(16)),e.VBOBuildTime={},ce.obj(e.VBOBuildTime,{mtime:0}),STe(t,e)}const uJ=ce.newInstance(ETe,"vtkOpenGLImageCPRMapper"),_Te={};var DTe={newInstance:uJ,..._Te};ha("vtkImageCPRMapper",uJ);function OTe(t,e){e.classHierarchy.push("vtkOpenGLImageSlice"),t.buildPass=n=>{if(!(!e.renderable||!e.renderable.getVisibility())&&n){if(!e.renderable)return;e._openGLRenderWindow=t.getLastAncestorOfType("vtkOpenGLRenderWindow"),e._openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e.context=e._openGLRenderWindow.getContext(),t.prepareNodes(),t.addMissingNode(e.renderable.getMapper()),t.removeUnusedNodes()}},t.traverseZBufferPass=n=>{!e.renderable||!e.renderable.getNestedVisibility()||e._openGLRenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(n,!0),e.children.forEach(r=>{r.traverse(n)}),t.apply(n,!1))},t.traverseOpaqueZBufferPass=n=>t.traverseOpaquePass(n),t.traverseOpaquePass=n=>{!e.renderable||!e.renderable.getNestedVisibility()||!e.renderable.getIsOpaque()||e._openGLRenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(n,!0),e.children.forEach(r=>{r.traverse(n)}),t.apply(n,!1))},t.traverseTranslucentPass=n=>{!e.renderable||!e.renderable.getNestedVisibility()||e.renderable.getIsOpaque()||e._openGLRenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(n,!0),e.children.forEach(r=>{r.traverse(n)}),t.apply(n,!1))},t.queryPass=(n,r)=>{if(n){if(!e.renderable||!e.renderable.getVisibility())return;e.renderable.getIsOpaque()?r.incrementOpaqueActorCount():r.incrementTranslucentActorCount()}},t.zBufferPass=(n,r)=>t.opaquePass(n,r),t.opaqueZBufferPass=(n,r)=>t.opaquePass(n,r),t.opaquePass=(n,r)=>{n&&e.context.depthMask(!0)},t.translucentPass=(n,r)=>{e.context.depthMask(!n)},t.getKeyMatrices=()=>(e.renderable.getMTime()>e.keyMatrixTime.getMTime()&&(Ri(e.keyMatrices.mcwc,e.renderable.getMatrix()),jn(e.keyMatrices.mcwc,e.keyMatrices.mcwc),e.keyMatrixTime.modified()),e.keyMatrices)}const MTe={context:null,keyMatrixTime:null,keyMatrices:null};function ITe(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,MTe,n),kr.extend(t,e,n),e.keyMatrixTime={},Wr(e.keyMatrixTime,{mtime:0}),e.keyMatrices={mcwc:on(new Float64Array(16))},Ni(t,e,["context"]),OTe(t,e)}const fJ=Qn(ITe,"vtkOpenGLImageSlice");var RTe={newInstance:fJ};ha("vtkImageSlice",fJ);function PTe(t,e){e.classHierarchy.push("vtkOpenGLVolume"),t.buildPass=n=>{!e.renderable||!e.renderable.getVisibility()||n&&(e._openGLRenderWindow=t.getLastAncestorOfType("vtkOpenGLRenderWindow"),e._openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e.context=e._openGLRenderWindow.getContext(),t.prepareNodes(),t.addMissingNode(e.renderable.getMapper()),t.removeUnusedNodes())},t.queryPass=(n,r)=>{if(n){if(!e.renderable||!e.renderable.getVisibility())return;r.incrementVolumeCount()}},t.traverseVolumePass=n=>{!e.renderable||!e.renderable.getNestedVisibility()||e._openGLRenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(n,!0),e.children[0].traverse(n),t.apply(n,!1))},t.volumePass=n=>{!e.renderable||!e.renderable.getVisibility()||e.context.depthMask(!n)},t.getKeyMatrices=()=>(e.renderable.getMTime()>e.keyMatrixTime.getMTime()&&(e.renderable.computeMatrix(),Ri(e.MCWCMatrix,e.renderable.getMatrix()),jn(e.MCWCMatrix,e.MCWCMatrix),e.renderable.getIsIdentity()?Bl(e.normalMatrix):(BC(e.normalMatrix,e.MCWCMatrix),Ay(e.normalMatrix,e.normalMatrix),u7(e.normalMatrix,e.normalMatrix)),e.keyMatrixTime.modified()),{mcwc:e.MCWCMatrix,normalMatrix:e.normalMatrix})}const ATe={};function NTe(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,ATe,n),kr.extend(t,e,n),e.keyMatrixTime={},Wr(e.keyMatrixTime,{mtime:0}),e.normalMatrix=new Float64Array(9),e.MCWCMatrix=new Float64Array(16),Ni(t,e,["context"]),PTe(t,e)}const dJ=Qn(NTe,"vtkOpenGLVolume");var LTe={newInstance:dJ};ha("vtkVolume",dJ);function kTe(t,e){e.classHierarchy.push("vtkFramebuffer"),t.getBothMode=()=>e.context.FRAMEBUFFER,t.saveCurrentBindingsAndBuffers=n=>{const r=typeof n<"u"?n:t.getBothMode();t.saveCurrentBindings(r),t.saveCurrentBuffers(r)},t.saveCurrentBindings=n=>{if(!e.context){$n("you must set the OpenGLRenderWindow before calling saveCurrentBindings");return}const r=e.context;e.previousDrawBinding=r.getParameter(e.context.FRAMEBUFFER_BINDING),e.previousActiveFramebuffer=e._openGLRenderWindow.getActiveFramebuffer()},t.saveCurrentBuffers=n=>{},t.restorePreviousBindingsAndBuffers=n=>{const r=typeof n<"u"?n:t.getBothMode();t.restorePreviousBindings(r),t.restorePreviousBuffers(r)},t.restorePreviousBindings=n=>{if(!e.context){$n("you must set the OpenGLRenderWindow before calling restorePreviousBindings");return}const r=e.context;r.bindFramebuffer(r.FRAMEBUFFER,e.previousDrawBinding),e._openGLRenderWindow.setActiveFramebuffer(e.previousActiveFramebuffer)},t.restorePreviousBuffers=n=>{},t.bind=function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;r===null&&(r=e.context.FRAMEBUFFER),e.context.bindFramebuffer(r,e.glFramebuffer);for(let i=0;i<e.colorBuffers.length;i++)e.colorBuffers[i].bind();e._openGLRenderWindow.setActiveFramebuffer(t)},t.create=(n,r)=>{if(!e.context){$n("you must set the OpenGLRenderWindow before calling create");return}e.glFramebuffer=e.context.createFramebuffer(),e.glFramebuffer.width=n,e.glFramebuffer.height=r},t.setColorBuffer=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const i=e.context;if(!i){$n("you must set the OpenGLRenderWindow before calling setColorBuffer");return}let a=i.COLOR_ATTACHMENT0;if(r>0)if(e._openGLRenderWindow.getWebgl2())a+=r;else{$n("Using multiple framebuffer attachments requires WebGL 2");return}e.colorBuffers[r]=n,i.framebufferTexture2D(i.FRAMEBUFFER,a,i.TEXTURE_2D,n.getHandle(),0)},t.removeColorBuffer=function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;const r=e.context;if(!r){$n("you must set the OpenGLRenderWindow before calling removeColorBuffer");return}let i=r.COLOR_ATTACHMENT0;if(n>0)if(e._openGLRenderWindow.getWebgl2())i+=n;else{$n("Using multiple framebuffer attachments requires WebGL 2");return}r.framebufferTexture2D(r.FRAMEBUFFER,i,r.TEXTURE_2D,null,0),e.colorBuffers=e.colorBuffers.splice(n,1)},t.setDepthBuffer=n=>{if(!e.context){$n("you must set the OpenGLRenderWindow before calling setDepthBuffer");return}if(e._openGLRenderWindow.getWebgl2()){const r=e.context;r.framebufferTexture2D(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.TEXTURE_2D,n.getHandle(),0)}else $n("Attaching depth buffer textures to fbo requires WebGL 2")},t.removeDepthBuffer=()=>{if(!e.context){$n("you must set the OpenGLRenderWindow before calling removeDepthBuffer");return}if(e._openGLRenderWindow.getWebgl2()){const n=e.context;n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,null,0)}else $n("Attaching depth buffer textures to framebuffers requires WebGL 2")},t.getGLFramebuffer=()=>e.glFramebuffer,t.setOpenGLRenderWindow=n=>{e._openGLRenderWindow!==n&&(t.releaseGraphicsResources(),e._openGLRenderWindow=n,e.context=null,n&&(e.context=e._openGLRenderWindow.getContext()))},t.releaseGraphicsResources=()=>{e.glFramebuffer&&e.context.deleteFramebuffer(e.glFramebuffer)},t.getSize=()=>e.glFramebuffer==null?null:[e.glFramebuffer.width,e.glFramebuffer.height],t.populateFramebuffer=()=>{if(!e.context){$n("you must set the OpenGLRenderWindow before calling populateFrameBuffer");return}t.bind();const n=e.context,r=ai.newInstance();r.setOpenGLRenderWindow(e._openGLRenderWindow),r.setMinificationFilter(an.LINEAR),r.setMagnificationFilter(an.LINEAR),r.create2DFromRaw(e.glFramebuffer.width,e.glFramebuffer.height,4,Ln.UNSIGNED_CHAR,null),t.setColorBuffer(r),e.depthTexture=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,e.depthTexture),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_COMPONENT16,e.glFramebuffer.width,e.glFramebuffer.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,e.depthTexture)},t.getColorTexture=()=>e.colorBuffers[0]}const VTe={glFramebuffer:null,colorBuffers:null,depthTexture:null,previousDrawBinding:0,previousReadBinding:0,previousDrawBuffer:0,previousReadBuffer:0,previousActiveFramebuffer:null};function hJ(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,VTe,n),Wr(t,e),e.colorBuffers&&$n("you cannot initialize colorBuffers through the constructor. You should call setColorBuffer() instead."),e.colorBuffers=[],Gm(t,e,["colorBuffers"]),kTe(t,e)}const FTe=Qn(hJ,"vtkFramebuffer");var HC={newInstance:FTe,extend:hJ},UTe=`//VTK::System::Dec

/*=========================================================================

  Program:   Visualization Toolkit
  Module:    vtkPolyDataVS.glsl

  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen
  All rights reserved.
  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.

     This software is distributed WITHOUT ANY WARRANTY; without even
     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
     PURPOSE.  See the above copyright notice for more information.

=========================================================================*/

attribute vec4 vertexDC;

varying vec3 vertexVCVSOutput;
uniform mat4 PCVCMatrix;

uniform float dcxmin;
uniform float dcxmax;
uniform float dcymin;
uniform float dcymax;

void main()
{
  // dcsmall is the device coords reduced to the
  // x y area covered by the volume
  vec4 dcsmall = vec4(
    dcxmin + 0.5 * (vertexDC.x + 1.0) * (dcxmax - dcxmin),
    dcymin + 0.5 * (vertexDC.y + 1.0) * (dcymax - dcymin),
    vertexDC.z,
    vertexDC.w);
  vec4 vcpos = PCVCMatrix * dcsmall;
  vertexVCVSOutput = vcpos.xyz/vcpos.w;
  gl_Position = dcsmall;
}
`,BTe=`//VTK::System::Dec

/*=========================================================================

  Program:   Visualization Toolkit
  Module:    vtkVolumeFS.glsl

  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen
  All rights reserved.
  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.

     This software is distributed WITHOUT ANY WARRANTY; without even
     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
     PURPOSE.  See the above copyright notice for more information.

=========================================================================*/
// Template for the volume mappers fragment shader

// the output of this shader
//VTK::Output::Dec

varying vec3 vertexVCVSOutput;

// first declare the settings from the mapper
// that impact the code paths in here

// always set vtkNumComponents 1,2,3,4
//VTK::NumComponents

// possibly define vtkTrilinearOn
//VTK::TrilinearOn

// possibly define UseIndependentComponents
//VTK::IndependentComponentsOn

// possibly define vtkCustomComponentsColorMix
//VTK::CustomComponentsColorMixOn

// possibly define any "proportional" components
//VTK::vtkProportionalComponents

// possibly define any components that are forced to nearest interpolation
//VTK::vtkForceNearestComponents

// Define the blend mode to use
#define vtkBlendMode //VTK::BlendMode

// Possibly define vtkImageLabelOutlineOn
//VTK::ImageLabelOutlineOn

// Possibly define vtkLabelEdgeProjectionOn
//VTK::LabelEdgeProjectionOn


#ifdef vtkImageLabelOutlineOn
  uniform float outlineOpacity;
  uniform float vpWidth;
  uniform float vpHeight;
  uniform float vpOffsetX;
  uniform float vpOffsetY;
  uniform mat4 PCWCMatrix;
  uniform mat4 vWCtoIDX;

  const int MAX_SEGMENT_INDEX = 256; // Define as per expected maximum
  // bool seenSegmentsByOriginalPos[MAX_SEGMENT_INDEX];
  #define MAX_SEGMENTS 256
  #define UINT_SIZE 32
  #define BITMASK_SIZE ((MAX_SEGMENTS + UINT_SIZE - 1) / UINT_SIZE)

  uint bitmask[BITMASK_SIZE];

  // Set the corresponding bit in the bitmask
  void setBit(int segmentIndex) {
    int index = segmentIndex / UINT_SIZE;
    int bitIndex = segmentIndex % UINT_SIZE;
    bitmask[index] |= 1u << bitIndex;
  }

  // Check if a bit is set in the bitmask
  bool isBitSet(int segmentIndex) {
    int index = segmentIndex / UINT_SIZE;
    int bitIndex = segmentIndex % UINT_SIZE;
    return ((bitmask[index] & (1u << bitIndex)) != 0u);
  }
#endif

// define vtkLightComplexity
//VTK::LightComplexity
#if vtkLightComplexity > 0
uniform float vSpecularPower;
uniform float vAmbient;
uniform float vDiffuse;
uniform float vSpecular;
//VTK::Light::Dec
#endif

//VTK::VolumeShadowOn
//VTK::SurfaceShadowOn
//VTK::localAmbientOcclusionOn
//VTK::LAO::Dec
//VTK::VolumeShadow::Dec

// define vtkComputeNormalFromOpacity
//VTK::vtkComputeNormalFromOpacity

// possibly define vtkGradientOpacityOn
//VTK::GradientOpacityOn
#ifdef vtkGradientOpacityOn
uniform float goscale0;
uniform float goshift0;
uniform float gomin0;
uniform float gomax0;
#ifdef UseIndependentComponents
#if vtkNumComponents > 1
uniform float goscale1;
uniform float goshift1;
uniform float gomin1;
uniform float gomax1;
#if vtkNumComponents > 2
uniform float goscale2;
uniform float goshift2;
uniform float gomin2;
uniform float gomax2;
#if vtkNumComponents > 3
uniform float goscale3;
uniform float goshift3;
uniform float gomin3;
uniform float gomax3;
#endif
#endif
#endif
#endif
#endif

// if you want to see the raw tiled
// data in webgl1 uncomment the following line
// #define debugtile

// camera values
uniform float camThick;
uniform float camNear;
uniform float camFar;
uniform int cameraParallel;

// values describing the volume geometry
uniform vec3 vOriginVC;
uniform vec3 vSpacing;
uniform ivec3 volumeDimensions; // 3d texture dimensions
uniform vec3 vPlaneNormal0;
uniform float vPlaneDistance0;
uniform vec3 vPlaneNormal1;
uniform float vPlaneDistance1;
uniform vec3 vPlaneNormal2;
uniform float vPlaneDistance2;
uniform vec3 vPlaneNormal3;
uniform float vPlaneDistance3;
uniform vec3 vPlaneNormal4;
uniform float vPlaneDistance4;
uniform vec3 vPlaneNormal5;
uniform float vPlaneDistance5;

//VTK::ClipPlane::Dec

// opacity and color textures
uniform sampler2D otexture;
uniform float oshift0;
uniform float oscale0;
uniform sampler2D ctexture;
uniform float cshift0;
uniform float cscale0;

#if vtkNumComponents >= 2
uniform float oshift1;
uniform float oscale1;
uniform float cshift1;
uniform float cscale1;
#endif
#if vtkNumComponents >= 3
uniform float oshift2;
uniform float oscale2;
uniform float cshift2;
uniform float cscale2;
#endif
#if vtkNumComponents >= 4
uniform float oshift3;
uniform float oscale3;
uniform float cshift3;
uniform float cscale3;
#endif

// jitter texture
uniform sampler2D jtexture;
uniform sampler2D ttexture;


// some 3D texture values
uniform float sampleDistance;
uniform vec3 vVCToIJK;
uniform vec3 volumeSpacings; // spacing in the world coorindates


// the heights defined below are the locations
// for the up to four components of the tfuns
// the tfuns have a height of 2XnumComps pixels so the
// values are computed to hit the middle of the two rows
// for that component
#ifdef UseIndependentComponents
#if vtkNumComponents == 1
uniform float mix0;
#define height0 0.5
#endif
#if vtkNumComponents == 2
uniform float mix0;
uniform float mix1;
#define height0 0.25
#define height1 0.75
#endif
#if vtkNumComponents == 3
uniform float mix0;
uniform float mix1;
uniform float mix2;
#define height0 0.17
#define height1 0.5
#define height2 0.83
#endif
#if vtkNumComponents == 4
uniform float mix0;
uniform float mix1;
uniform float mix2;
uniform float mix3;
#define height0 0.125
#define height1 0.375
#define height2 0.625
#define height3 0.875
#endif
#endif

uniform vec4 ipScalarRangeMin;
uniform vec4 ipScalarRangeMax;

// declaration for intermixed geometry
//VTK::ZBuffer::Dec

//=======================================================================
// global and custom variables (a temporary section before photorealistics rendering module is complete)
vec3 rayDirVC;
float sampleDistanceISVS;
float sampleDistanceIS;

#define SQRT3    1.7321
#define INV4PI   0.0796
#define EPSILON  0.001
#define PI       3.1415
#define PI2      9.8696

//=======================================================================
// Webgl2 specific version of functions
#if __VERSION__ == 300

uniform highp sampler3D texture1;

vec4 getTextureValue(vec3 pos)
{
  vec4 tmp = texture(texture1, pos);

  #if defined(vtkComponent0ForceNearest) || \\
      defined(vtkComponent1ForceNearest) || \\
      defined(vtkComponent2ForceNearest) || \\
      defined(vtkComponent3ForceNearest)
    vec3 nearestPos = (floor(pos * vec3(volumeDimensions)) + 0.5) / vec3(volumeDimensions);
    vec4 nearestValue = texture(texture1, nearestPos);
    #ifdef vtkComponent0ForceNearest
      tmp[0] = nearestValue[0];
    #endif
    #ifdef vtkComponent1ForceNearest
      tmp[1] = nearestValue[1];
    #endif
    #ifdef vtkComponent2ForceNearest
      tmp[2] = nearestValue[2];
    #endif
    #ifdef vtkComponent3ForceNearest
      tmp[3] = nearestValue[3];
    #endif
  #endif

  #ifndef UseIndependentComponents
    #if vtkNumComponents == 1
      tmp.a = tmp.r;
    #endif
    #if vtkNumComponents == 2
      tmp.a = tmp.g;
    #endif
    #if vtkNumComponents == 3
      tmp.a = length(tmp.rgb);
    #endif
  #endif

  return tmp;
}

//=======================================================================
// WebGL1 specific version of functions
#else

uniform sampler2D texture1;

uniform float texWidth;
uniform float texHeight;
uniform int xreps;
uniform int xstride;
uniform int ystride;

// if computing trilinear values from multiple z slices
#ifdef vtkTrilinearOn
vec4 getTextureValue(vec3 ijk)
{
  float zoff = 1.0/float(volumeDimensions.z);
  vec4 val1 = getOneTextureValue(ijk);
  vec4 val2 = getOneTextureValue(vec3(ijk.xy, ijk.z + zoff));

  float indexZ = float(volumeDimensions)*ijk.z;
  float zmix =  indexZ - floor(indexZ);

  return mix(val1, val2, zmix);
}

vec4 getOneTextureValue(vec3 ijk)
#else // nearest or fast linear
vec4 getTextureValue(vec3 ijk)
#endif
{
  vec3 tdims = vec3(volumeDimensions);

#ifdef debugtile
  vec2 tpos = vec2(ijk.x, ijk.y);
  vec4 tmp = texture2D(texture1, tpos);
  tmp.a = 1.0;

#else
  int z = int(ijk.z * tdims.z);
  int yz = z / xreps;
  int xz = z - yz*xreps;

  int tileWidth = volumeDimensions.x/xstride;
  int tileHeight = volumeDimensions.y/ystride;

  xz *= tileWidth;
  yz *= tileHeight;

  float ni = float(xz) + (ijk.x*float(tileWidth));
  float nj = float(yz) + (ijk.y*float(tileHeight));

  vec2 tpos = vec2(ni/texWidth, nj/texHeight);

  vec4 tmp = texture2D(texture1, tpos);

#if vtkNumComponents == 1
  tmp.a = tmp.r;
#endif
#if vtkNumComponents == 2
  tmp.g = tmp.a;
#endif
#if vtkNumComponents == 3
  tmp.a = length(tmp.rgb);
#endif
#endif

  return tmp;
}

// End of Webgl1 specific code
//=======================================================================
#endif

//=======================================================================
// transformation between VC and IS space

// convert vector position from idx to vc
#if (vtkLightComplexity > 0) || (defined vtkClippingPlanesOn)
vec3 IStoVC(vec3 posIS){
  vec3 posVC = posIS / vVCToIJK;
  return posVC.x * vPlaneNormal0 +
         posVC.y * vPlaneNormal2 +
         posVC.z * vPlaneNormal4 +
         vOriginVC;
}

// convert vector position from vc to idx
vec3 VCtoIS(vec3 posVC){
  posVC = posVC - vOriginVC;
  posVC = vec3(
    dot(posVC, vPlaneNormal0),
    dot(posVC, vPlaneNormal2),
    dot(posVC, vPlaneNormal4));
  return posVC * vVCToIJK;
}
#endif

//Rotate vector to view coordinate
#if (vtkLightComplexity > 0) || (defined vtkGradientOpacityOn)
void rotateToViewCoord(inout vec3 dirIS){
  dirIS.xyz =
    dirIS.x * vPlaneNormal0 +
    dirIS.y * vPlaneNormal2 +
    dirIS.z * vPlaneNormal4;
}

//Rotate vector to idx coordinate
vec3 rotateToIDX(vec3 dirVC){
  vec3 dirIS;
  dirIS.xyz = vec3(
    dot(dirVC, vPlaneNormal0),
    dot(dirVC, vPlaneNormal2),
    dot(dirVC, vPlaneNormal4));
  return dirIS;
}
#endif

//=======================================================================
// Given a normal compute the gradient opacity factors
float computeGradientOpacityFactor(
  float normalMag, float goscale, float goshift, float gomin, float gomax)
{
  return clamp(normalMag * goscale + goshift, gomin, gomax);
}

//=======================================================================
// compute the normal and gradient magnitude for a position, uses forward difference
#if (vtkLightComplexity > 0) || (defined vtkGradientOpacityOn)
  #ifdef vtkClippingPlanesOn
    void adjustClippedVoxelValues(vec3 pos, vec3 texPos[3], inout vec3 g1)
    {
      vec3 g1VC[3];
      for (int i = 0; i < 3; ++i)
      {
        g1VC[i] = IStoVC(texPos[i]);
      }
      vec3 posVC = IStoVC(pos);
      for (int i = 0; i < clip_numPlanes; ++i)
      {
        for (int j = 0; j < 3; ++j)
        {
          if(dot(vec3(vClipPlaneOrigins[i] - g1VC[j].xyz), vClipPlaneNormals[i]) > 0.0)
          {
            g1[j] = 0.0;
          }
        }
      }
    }
  #endif

  #ifdef vtkComputeNormalFromOpacity
    vec4 computeDensityNormal(vec3 opacityUCoords[2], float opactityTextureHeight, float gradientOpacity) {
      vec3 opacityG1, opacityG2;
      opacityG1.x = texture2D(otexture, vec2(opacityUCoords[0].x, opactityTextureHeight)).r;
      opacityG1.y = texture2D(otexture, vec2(opacityUCoords[0].y, opactityTextureHeight)).r;
      opacityG1.z = texture2D(otexture, vec2(opacityUCoords[0].z, opactityTextureHeight)).r;
      opacityG2.x = texture2D(otexture, vec2(opacityUCoords[1].x, opactityTextureHeight)).r;
      opacityG2.y = texture2D(otexture, vec2(opacityUCoords[1].y, opactityTextureHeight)).r;
      opacityG2.z = texture2D(otexture, vec2(opacityUCoords[1].z, opactityTextureHeight)).r;
      opacityG1.xyz *= gradientOpacity;
      opacityG2.xyz *= gradientOpacity;

      vec4 opacityG = vec4(opacityG1 - opacityG2, 1.0f);
      // divide by spacing
      opacityG.xyz /= vSpacing;
      opacityG.w = length(opacityG.xyz);
      // rotate to View Coords
      rotateToViewCoord(opacityG.xyz);
      if (!all(equal(opacityG.xyz, vec3(0.0)))) {
        return vec4(normalize(opacityG.xyz),opacityG.w);
      } else {
        return vec4(0.0);
      }
    }

    vec4 computeNormalForDensity(vec3 pos, vec3 tstep, out vec3 scalarInterp[2], const int opacityComponent)
    {
      vec3 xvec = vec3(tstep.x, 0.0, 0.0);
      vec3 yvec = vec3(0.0, tstep.y, 0.0);
      vec3 zvec = vec3(0.0, 0.0, tstep.z);
      vec3 texPosPVec[3];
      texPosPVec[0] = pos + xvec;
      texPosPVec[1] = pos + yvec;
      texPosPVec[2] = pos + zvec;
      vec3 texPosNVec[3];
      texPosNVec[0] = pos - xvec;
      texPosNVec[1] = pos - yvec;
      texPosNVec[2] = pos - zvec;
      vec3 g1, g2;

      scalarInterp[0].x = getTextureValue(texPosPVec[0])[opacityComponent];
      scalarInterp[0].y = getTextureValue(texPosPVec[1])[opacityComponent];
      scalarInterp[0].z = getTextureValue(texPosPVec[2])[opacityComponent];
      scalarInterp[1].x = getTextureValue(texPosNVec[0])[opacityComponent];
      scalarInterp[1].y = getTextureValue(texPosNVec[1])[opacityComponent];
      scalarInterp[1].z = getTextureValue(texPosNVec[2])[opacityComponent];

      #ifdef vtkClippingPlanesOn
        adjustClippedVoxelValues(pos, texPosPVec, scalarInterp[0]);
        adjustClippedVoxelValues(pos, texPosNVec, scalarInterp[1]);
      #endif
      vec4 result;
      result.x = scalarInterp[0].x - scalarInterp[1].x;
      result.y = scalarInterp[0].y - scalarInterp[1].y;
      result.z = scalarInterp[0].z - scalarInterp[1].z;
      // divide by spacing
      result.xyz /= vSpacing;
      result.w = length(result.xyz);
      // rotate to View Coords
      rotateToViewCoord(result.xyz);
      if (length(result.xyz) > 0.0) {
        return vec4(normalize(result.xyz),result.w);
      } else {
        return vec4(0.0);
      }
    }
  #endif

  // only works with dependent components
  vec4 computeNormal(vec3 pos, vec3 tstep)
  {
    vec3 xvec = vec3(tstep.x, 0.0, 0.0);
    vec3 yvec = vec3(0.0, tstep.y, 0.0);
    vec3 zvec = vec3(0.0, 0.0, tstep.z);
    vec3 texPosPVec[3];
    texPosPVec[0] = pos + xvec;
    texPosPVec[1] = pos + yvec;
    texPosPVec[2] = pos + zvec;
    vec3 texPosNVec[3];
    texPosNVec[0] = pos - xvec;
    texPosNVec[1] = pos - yvec;
    texPosNVec[2] = pos - zvec;
    vec3 g1, g2;
    g1.x = getTextureValue(texPosPVec[0]).a;
    g1.y = getTextureValue(texPosPVec[1]).a;
    g1.z = getTextureValue(texPosPVec[2]).a;
    g2.x = getTextureValue(texPosNVec[0]).a;
    g2.y = getTextureValue(texPosNVec[1]).a;
    g2.z = getTextureValue(texPosNVec[2]).a;
    #ifdef vtkClippingPlanesOn
      adjustClippedVoxelValues(pos, texPosPVec, g1);
      adjustClippedVoxelValues(pos, texPosNVec, g2);
    #endif
    vec4 result;
    result = vec4(g1 - g2, -1.0);
    // divide by spacing
    result.xyz /= vSpacing;
    result.w = length(result.xyz);
    if (result.w > 0.0){
      // rotate to View Coords
      rotateToViewCoord(result.xyz);
      return vec4(normalize(result.xyz),result.w);
    } else {
      return vec4(0.0);
    }
  }
#endif


#ifdef vtkImageLabelOutlineOn
  vec4 fragCoordToPCPos(vec4 fragCoord) {
    return vec4(
      (fragCoord.x / vpWidth - vpOffsetX - 0.5) * 2.0,
      (fragCoord.y / vpHeight - vpOffsetY - 0.5) * 2.0,
      (fragCoord.z - 0.5) * 2.0,
      1.0);
  }

  vec4 pcPosToWorldCoord(vec4 pcPos) {
    return PCWCMatrix * pcPos;
  }

  vec3 fragCoordToIndexSpace(vec4 fragCoord) {
    vec4 pcPos = fragCoordToPCPos(fragCoord);
    vec4 worldCoord = pcPosToWorldCoord(pcPos);
    vec4 vertex = (worldCoord / worldCoord.w);

    vec3 index = (vWCtoIDX * vertex).xyz;

    // half voxel fix for labelmapOutline
    return (index + vec3(0.5)) / vec3(volumeDimensions);
  }

  vec3 fragCoordToWorld(vec4 fragCoord) {
    vec4 pcPos = fragCoordToPCPos(fragCoord);
    vec4 worldCoord = pcPosToWorldCoord(pcPos);
    return worldCoord.xyz;
  }
#endif

//=======================================================================
// compute the normals and gradient magnitudes for a position
// for independent components
mat4 computeMat4Normal(vec3 pos, vec4 tValue, vec3 tstep)
{
  mat4 result;
  vec4 distX = getTextureValue(pos + vec3(tstep.x, 0.0, 0.0)) - tValue;
  vec4 distY = getTextureValue(pos + vec3(0.0, tstep.y, 0.0)) - tValue;
  vec4 distZ = getTextureValue(pos + vec3(0.0, 0.0, tstep.z)) - tValue;

  // divide by spacing
  distX /= vSpacing.x;
  distY /= vSpacing.y;
  distZ /= vSpacing.z;

  mat3 rot;
  rot[0] = vPlaneNormal0;
  rot[1] = vPlaneNormal2;
  rot[2] = vPlaneNormal4;

#if !defined(vtkComponent0Proportional)
  result[0].xyz = vec3(distX.r, distY.r, distZ.r);
  result[0].a = length(result[0].xyz);
  result[0].xyz *= rot;
  if (result[0].w > 0.0)
  {
    result[0].xyz /= result[0].w;
  }
#endif

// optionally compute the 2nd component
#if vtkNumComponents >= 2 && !defined(vtkComponent1Proportional)
  result[1].xyz = vec3(distX.g, distY.g, distZ.g);
  result[1].a = length(result[1].xyz);
  result[1].xyz *= rot;
  if (result[1].w > 0.0)
  {
    result[1].xyz /= result[1].w;
  }
#endif

// optionally compute the 3rd component
#if vtkNumComponents >= 3 && !defined(vtkComponent2Proportional)
  result[2].xyz = vec3(distX.b, distY.b, distZ.b);
  result[2].a = length(result[2].xyz);
  result[2].xyz *= rot;
  if (result[2].w > 0.0)
  {
    result[2].xyz /= result[2].w;
  }
#endif

// optionally compute the 4th component
#if vtkNumComponents >= 4 && !defined(vtkComponent3Proportional)
  result[3].xyz = vec3(distX.a, distY.a, distZ.a);
  result[3].a = length(result[3].xyz);
  result[3].xyz *= rot;
  if (result[3].w > 0.0)
  {
    result[3].xyz /= result[3].w;
  }
#endif

  return result;
}

//=======================================================================
// global shadow - secondary ray
#if defined(VolumeShadowOn) || defined(localAmbientOcclusionOn)
float random()
{
  float rand = fract(sin(dot(gl_FragCoord.xy,vec2(12.9898,78.233)))*43758.5453123);
  float jitter=texture2D(jtexture,gl_FragCoord.xy/32.).r;
  uint pcg_state = floatBitsToUint(jitter);
  uint state = pcg_state;
  pcg_state = pcg_state * uint(747796405) + uint(2891336453);
  uint word = ((state >> ((state >> uint(28)) + uint(4))) ^ state) * uint(277803737);
  return (float((((word >> uint(22)) ^ word) >> 1 ))/float(2147483647) + rand)/2.0;
}
#endif

#ifdef VolumeShadowOn
// henyey greenstein phase function
float phase_function(float cos_angle)
{
  // divide by 2.0 instead of 4pi to increase intensity
  return ((1.0-anisotropy2)/pow(1.0+anisotropy2-2.0*anisotropy*cos_angle, 1.5))/2.0;
}

// Computes the intersection between a ray and a box
struct Hit
{
  float tmin;
  float tmax;
};

struct Ray
{
  vec3 origin;
  vec3 dir;
  vec3 invDir;
};

bool BBoxIntersect(vec3 boundMin, vec3 boundMax, const Ray r, out Hit hit)
{
  vec3 tbot = r.invDir * (boundMin - r.origin);
  vec3 ttop = r.invDir * (boundMax - r.origin);
  vec3 tmin = min(ttop, tbot);
  vec3 tmax = max(ttop, tbot);
  vec2 t = max(tmin.xx, tmin.yz);
  float t0 = max(t.x, t.y);
  t = min(tmax.xx, tmax.yz);
  float t1 = min(t.x, t.y);
  hit.tmin = t0;
  hit.tmax = t1;
  return t1 > max(t0,0.0);
}

// As BBoxIntersect requires the inverse of the ray coords,
// this function is used to avoid numerical issues
void safe_0_vector(inout Ray ray)
{
  if(abs(ray.dir.x) < EPSILON) ray.dir.x = sign(ray.dir.x) * EPSILON;
  if(abs(ray.dir.y) < EPSILON) ray.dir.y = sign(ray.dir.y) * EPSILON;
  if(abs(ray.dir.z) < EPSILON) ray.dir.z = sign(ray.dir.z) * EPSILON;
}

float volume_shadow(vec3 posIS, vec3 lightDirNormIS)
{
  float shadow = 1.0;
  float opacity = 0.0;

  // modify sample distance with a random number between 1.5 and 3.0
  float sampleDistanceISVS_jitter = sampleDistanceISVS * mix(1.5, 3.0, random());
  float opacityPrev = texture2D(otexture, vec2(getTextureValue(posIS).r * oscale0 + oshift0, 0.5)).r;

  // in case the first sample near surface has a very tiled light ray, we need to offset start position
  posIS += sampleDistanceISVS_jitter * lightDirNormIS;

  // compute the start and end points for the ray
  Ray ray;
  Hit hit;
  ray.origin = posIS;
  ray.dir = lightDirNormIS;
  safe_0_vector(ray);
  ray.invDir = 1.0/ray.dir;

  if(!BBoxIntersect(vec3(0.0),vec3(1.0), ray, hit))
  {
    return 1.0;
  }
  float maxdist = hit.tmax;

  // interpolate shadow ray length between: 1 unit of sample distance in IS to SQRT3, based on globalIlluminationReach
  float maxgi = mix(sampleDistanceISVS_jitter,SQRT3,giReach);
  maxdist = min(maxdist,maxgi);
  if(maxdist < EPSILON) {
    return 1.0;
  }

  float current_dist = 0.0;
  float current_step = length(sampleDistanceISVS_jitter * lightDirNormIS);
  float clamped_step = 0.0;

  vec4 scalar = vec4(0.0);
  while(current_dist < maxdist)
  {
#ifdef vtkClippingPlanesOn
    vec3 posVC = IStoVC(posIS);
    for (int i = 0; i < clip_numPlanes; ++i)
    {
      if (dot(vec3(vClipPlaneOrigins[i] - posVC), vClipPlaneNormals[i]) > 0.0)
      {
        current_dist = maxdist;
      }
    }
#endif
    scalar = getTextureValue(posIS);
    opacity = texture2D(otexture, vec2(scalar.r * oscale0 + oshift0, 0.5)).r;
    #if defined(vtkGradientOpacityOn) && !defined(UseIndependentComponents)
      vec4 normal = computeNormal(posIS, vec3(1.0/vec3(volumeDimensions)));
      opacity *= computeGradientOpacityFactor(normal.w, goscale0, goshift0, gomin0, gomax0);
    #endif
    shadow *= 1.0 - opacity;

    // optimization: early termination
    if (shadow < EPSILON){
      return 0.0;
    }

    clamped_step = min(maxdist - current_dist, current_step);
    posIS += clamped_step * lightDirNormIS;
    current_dist += current_step;
  }

  return shadow;
}

vec3 applyShadowRay(vec3 tColor, vec3 posIS, vec3 viewDirectionVC)
{
  vec3 vertLight = vec3(0.0);
  vec3 secondary_contrib = vec3(0.0);
  // here we assume only positional light, no effect of cones
  for (int i = 0; i < lightNum; i++)
  {
    #if(vtkLightComplexity==3)
      if (lightPositional[i] == 1){
        vertLight = lightPositionVC[i] - IStoVC(posIS);
      }else{
        vertLight = - lightDirectionVC[i];
      }
    #else
      vertLight = - lightDirectionVC[i];
    #endif
    // here we assume achromatic light, only intensity
    float dDotL = dot(viewDirectionVC, normalize(vertLight));
    // isotropic scatter returns 0.5 instead of 1/4pi to increase intensity
    float phase_attenuation = 0.5;
    if (abs(anisotropy) > EPSILON){
      phase_attenuation = phase_function(dDotL);
    }
    float vol_shadow = volume_shadow(posIS, normalize(rotateToIDX(vertLight)));
    secondary_contrib += tColor * vDiffuse * lightColor[i] * vol_shadow * phase_attenuation;
    secondary_contrib += tColor * vAmbient;
  }
  return secondary_contrib;
}
#endif

//=======================================================================
// local ambient occlusion
#ifdef localAmbientOcclusionOn
vec3 sample_direction_uniform(int i)
{
  float rand = random() * 0.5;
  float theta = PI2 * (kernelSample[i][0] + rand);
  float phi = acos(2.0 * (kernelSample[i][1] + rand) -1.0) / 2.5;
  return normalize(vec3(cos(theta)*sin(phi), sin(theta)*sin(phi), cos(phi)));
}

// return a matrix that transform startDir into z axis; startDir should be normalized
mat3 zBaseRotationalMatrix(vec3 startDir){
  vec3 axis = cross(startDir, vec3(0.0,0.0,1.0));
  float cosA = startDir.z;
  float k = 1.0 / (1.0 + cosA);
  mat3 matrix = mat3((axis.x * axis.x * k) + cosA, (axis.y * axis.x * k) - axis.z, (axis.z * axis.x * k) + axis.y,
              (axis.x * axis.y * k) + axis.z, (axis.y * axis.y * k) + cosA, (axis.z * axis.y * k) - axis.x,
              (axis.x * axis.z * k) - axis.y, (axis.y * axis.z * k) + axis.x, (axis.z * axis.z * k) + cosA);
  return matrix;
}

float computeLAO(vec3 posIS, float op, vec3 lightDir, vec4 normal){
  // apply LAO only at selected locations, otherwise return full brightness
  if (normal.w > 0.0 && op > 0.05){
    float total_transmittance = 0.0;
    mat3 inverseRotateBasis = inverse(zBaseRotationalMatrix(normalize(-normal.xyz)));
    vec3 currPos, randomDirStep;
    float weight, transmittance, opacity;
    for (int i = 0; i < kernelSize; i++)
    {
      randomDirStep = inverseRotateBasis * sample_direction_uniform(i) * sampleDistanceIS;
      weight = 1.0 - dot(normalize(lightDir), normalize(randomDirStep));
      currPos = posIS;
      transmittance = 1.0;
      for (int j = 0; j < kernelRadius ; j++){
        currPos += randomDirStep;
        // check if it's at clipping plane, if so return full brightness
        if (all(greaterThan(currPos, vec3(EPSILON))) && all(lessThan(currPos,vec3(1.0-EPSILON)))){
          opacity = texture2D(otexture, vec2(getTextureValue(currPos).r * oscale0 + oshift0, 0.5)).r;
          #ifdef vtkGradientOpacityOn
             opacity *= computeGradientOpacityFactor(normal.w, goscale0, goshift0, gomin0, gomax0);
          #endif
          transmittance *= 1.0 - opacity;
        }
        else{
          break;
        }
      }
      total_transmittance += transmittance / float(kernelRadius) * weight;

      // early termination if fully translucent
      if (total_transmittance > 1.0 - EPSILON){
        return 1.0;
      }
    }
    // average transmittance and reduce variance
    return clamp(total_transmittance / float(kernelSize), 0.3, 1.0);
  } else {
    return 1.0;
  }
}
#endif

//=======================================================================
// surface light contribution
#if vtkLightComplexity > 0
  void applyLighting(inout vec3 tColor, vec4 normal)
  {
    vec3 diffuse = vec3(0.0, 0.0, 0.0);
    vec3 specular = vec3(0.0, 0.0, 0.0);
    float df, sf = 0.0;
    for (int i = 0; i < lightNum; i++){
        df = abs(dot(normal.rgb, -lightDirectionVC[i]));
        diffuse += df * lightColor[i];
        sf = pow( abs(dot(lightHalfAngleVC[i],normal.rgb)), vSpecularPower);
        specular += sf * lightColor[i];
    }
    tColor.rgb = tColor.rgb*(diffuse*vDiffuse + vAmbient) + specular*vSpecular;
  }
  #ifdef SurfaceShadowOn
  #if vtkLightComplexity < 3
    vec3 applyLightingDirectional(vec3 posIS, vec4 tColor, vec4 normal)
    {
      // everything in VC
      vec3 diffuse = vec3(0.0);
      vec3 specular = vec3(0.0);
      #ifdef localAmbientOcclusionOn
        vec3 ambient = vec3(0.0);
      #endif
      vec3 vertLightDirection;
      for (int i = 0; i < lightNum; i++){
        float ndotL,vdotR;
        vertLightDirection = lightDirectionVC[i];
        ndotL = dot(normal.xyz, vertLightDirection);
        if (ndotL < 0.0 && twoSidedLighting)
        {
          ndotL = -ndotL;
        }
        if (ndotL > 0.0)
        {
          diffuse += ndotL * lightColor[i];
          //specular
          vdotR = dot(-rayDirVC, normalize(2.0 * ndotL * -normal.xyz + vertLightDirection));
          if (vdotR > 0.0)
          {
            specular += pow(vdotR, vSpecularPower) * lightColor[i];
          }
        }
        #ifdef localAmbientOcclusionOn
            ambient += computeLAO(posIS, tColor.a, vertLightDirection, normal);
        #endif
      }
      #ifdef localAmbientOcclusionOn
        return tColor.rgb * (diffuse * vDiffuse + vAmbient * ambient) + specular*vSpecular;
      #else
        return tColor.rgb * (diffuse * vDiffuse + vAmbient) + specular*vSpecular;
      #endif
    }
  #else
    vec3 applyLightingPositional(vec3 posIS, vec4 tColor, vec4 normal, vec3 posVC)
    {
      // everything in VC
      vec3 diffuse = vec3(0.0);
      vec3 specular = vec3(0.0);
      #ifdef localAmbientOcclusionOn
        vec3 ambient = vec3(0.0);
      #endif
      vec3 vertLightDirection;
      for (int i = 0; i < lightNum; i++){
        float distance,attenuation,ndotL,vdotR;
        vec3 lightDir;
        if (lightPositional[i] == 1){
          lightDir = lightDirectionVC[i];
          vertLightDirection = posVC - lightPositionVC[i];
          distance = length(vertLightDirection);
          vertLightDirection = normalize(vertLightDirection);
          attenuation = 1.0 / (lightAttenuation[i].x
                              + lightAttenuation[i].y * distance
                              + lightAttenuation[i].z * distance * distance);
          // per OpenGL standard cone angle is 90 or less for a spot light
          if (lightConeAngle[i] <= 90.0){
            float coneDot = dot(vertLightDirection, lightDir);
            if (coneDot >= cos(radians(lightConeAngle[i]))){  // if inside cone
              attenuation = attenuation * pow(coneDot, lightExponent[i]);
            }
            else {
              attenuation = 0.0;
            }
          }
          ndotL = dot(normal.xyz, vertLightDirection);
          if (ndotL < 0.0 && twoSidedLighting)
          {
            ndotL = -ndotL;
          }
          if (ndotL > 0.0)
          {
            diffuse += ndotL * attenuation * lightColor[i];
            //specular
            vdotR = dot(-rayDirVC, normalize(2.0 * ndotL * -normal.xyz + vertLightDirection));
            if (vdotR > 0.0)
            {
              specular += pow(vdotR, vSpecularPower) * attenuation * lightColor[i];
            }
          }
          #ifdef localAmbientOcclusionOn
            ambient += computeLAO(posIS, tColor.a, vertLightDirection, normal);
          #endif
        } else {
          vertLightDirection = lightDirectionVC[i];
          ndotL = dot(normal.xyz, vertLightDirection);
          if (ndotL < 0.0 && twoSidedLighting)
          {
            ndotL = -ndotL;
          }
          if (ndotL > 0.0)
          {
            diffuse += ndotL * lightColor[i];
            //specular
            vdotR = dot(-rayDirVC, normalize(2.0 * ndotL * -normal.xyz + vertLightDirection));
            if (vdotR > 0.0)
            {
              specular += pow(vdotR, vSpecularPower) * lightColor[i];
            }
          }
          #ifdef localAmbientOcclusionOn
            ambient += computeLAO(posIS, tColor.a, vertLightDirection, normal);
          #endif
        }
      }
      #ifdef localAmbientOcclusionOn
        return tColor.rgb * (diffuse * vDiffuse + vAmbient * ambient) + specular*vSpecular;
      #else
        return tColor.rgb * (diffuse * vDiffuse + vAmbient) + specular*vSpecular;
      #endif
    }
  #endif
  #endif
#endif

// LAO of surface shadows and volume shadows only work with dependent components
vec3 applyAllLightning(vec3 tColor, float alpha, vec3 posIS, vec4 normalLight) {
  #if vtkLightComplexity > 0
    // surface shadows if needed
    #ifdef SurfaceShadowOn
      #if vtkLightComplexity < 3
        vec3 tColorS = applyLightingDirectional(posIS, vec4(tColor, alpha), normalLight);
      #else
        vec3 tColorS = applyLightingPositional(posIS, vec4(tColor, alpha), normalLight, IStoVC(posIS));
      #endif
    #endif

    // volume shadows if needed
    #ifdef VolumeShadowOn
      vec3 tColorVS = applyShadowRay(tColor, posIS, rayDirVC);
    #endif

    // merge
    #ifdef VolumeShadowOn
      #ifdef SurfaceShadowOn
        // surface shadows + volumetric shadows
        float vol_coef = volumetricScatteringBlending * (1.0 - alpha / 2.0) * (1.0 - atan(normalLight.w) * INV4PI);
        tColor = (1.0-vol_coef) * tColorS + vol_coef * tColorVS;
      #else
        // volumetric shadows only
        tColor = tColorVS;
      #endif
    #else
      #ifdef SurfaceShadowOn
        // surface shadows only
        tColor = tColorS;
      #else
        // no shadows
        applyLighting(tColor, normal3);
      #endif
    #endif
  #endif
  return tColor;
}

  
vec4 getColorForValue(vec4 tValue, vec3 posIS, vec3 tstep)
{

// If labeloutline and not the edge labelmap, since in the edge labelmap blend
// we need the underlying data to sample through
#if defined(vtkImageLabelOutlineOn) && !defined(vtkLabelEdgeProjectionOn)
  vec3 centerPosIS = fragCoordToIndexSpace(gl_FragCoord); // pos in texture space
  vec4 centerValue = getTextureValue(centerPosIS);
  bool pixelOnBorder = false;
  vec4 tColor = texture2D(ctexture, vec2(centerValue.r * cscale0 + cshift0, 0.5));

  // Get alpha of segment from opacity function.
  tColor.a = texture2D(otexture, vec2(centerValue.r * oscale0 + oshift0, 0.5)).r;

  int segmentIndex = int(centerValue.r * 255.0);
  
  // Use texture sampling for outlineThickness
  float textureCoordinate = float(segmentIndex - 1) / 1024.0;
  float textureValue = texture2D(ttexture, vec2(textureCoordinate, 0.5)).r;

  int actualThickness = int(textureValue * 255.0);


  // If it is the background (segment index 0), we should quickly bail out. 
  // Previously, this was determined by tColor.a, which was incorrect as it
  // prevented the outline from appearing when the fill is 0.
  if (segmentIndex == 0){
    return vec4(0, 0, 0, 0);
  }

  // Only perform outline check on fragments rendering voxels that aren't invisible.
  // Saves a bunch of needless checks on the background.
  // TODO define epsilon when building shader?
  for (int i = -actualThickness; i <= actualThickness; i++) {
    for (int j = -actualThickness; j <= actualThickness; j++) {
      if (i == 0 || j == 0) {
        continue;
      }

      vec4 neighborPixelCoord = vec4(gl_FragCoord.x + float(i),
        gl_FragCoord.y + float(j),
        gl_FragCoord.z, gl_FragCoord.w);

      vec3 neighborPosIS = fragCoordToIndexSpace(neighborPixelCoord);
      vec4 value = getTextureValue(neighborPosIS);

      // If any of my neighbours are not the same value as I
      // am, this means I am on the border of the segment.
      // We can break the loops
      if (any(notEqual(value, centerValue))) {
        pixelOnBorder = true;
        break;
      }
    }

    if (pixelOnBorder == true) {
      break;
    }
  }

  // If I am on the border, I am displayed at full opacity
  if (pixelOnBorder == true) {
    tColor.a = outlineOpacity;
  }

  return tColor;

#else
  // compute the normal and gradient magnitude if needed
  // We compute it as a vec4 if possible otherwise a mat4

  #ifdef UseIndependentComponents

    // sample textures
    vec3 tColor0 = texture2D(ctexture, vec2(tValue.r * cscale0 + cshift0, height0)).rgb;
    float pwfValue0 = texture2D(otexture, vec2(tValue.r * oscale0 + oshift0, height0)).r;

    #if vtkNumComponents > 1
      vec3 tColor1 = texture2D(ctexture, vec2(tValue.g * cscale1 + cshift1, height1)).rgb;
      float pwfValue1 = texture2D(otexture, vec2(tValue.g * oscale1 + oshift1, height1)).r;

      #if vtkNumComponents > 2
        vec3 tColor2 = texture2D(ctexture, vec2(tValue.b * cscale2 + cshift2, height2)).rgb;
        float pwfValue2 = texture2D(otexture, vec2(tValue.b * oscale2 + oshift2, height2)).r;

        #if vtkNumComponents > 3
          vec3 tColor3 = texture2D(ctexture, vec2(tValue.a * cscale3 + cshift3, height3)).rgb;
          float pwfValue3 = texture2D(otexture, vec2(tValue.a * oscale3 + oshift3, height3)).r;
        #endif
      #endif
    #endif

    #if !defined(vtkCustomComponentsColorMix)
      // default path for component color mix

      // compute the normal vectors as needed
      #if (vtkLightComplexity > 0) || defined(vtkGradientOpacityOn)
        mat4 normalMat = computeMat4Normal(posIS, tValue, tstep);
      #endif

      // compute gradient opacity factors as needed
      vec4 goFactor = vec4(1.0, 1.0 ,1.0 ,1.0);
      #if defined(vtkGradientOpacityOn)
        #if !defined(vtkComponent0Proportional)
          goFactor.x =
            computeGradientOpacityFactor(normalMat[0].a, goscale0, goshift0, gomin0, gomax0);
        #endif
        #if vtkNumComponents > 1
          #if !defined(vtkComponent1Proportional)
            goFactor.y =
              computeGradientOpacityFactor(normalMat[1].a, goscale1, goshift1, gomin1, gomax1);
          #endif
          #if vtkNumComponents > 2
            #if !defined(vtkComponent2Proportional)
              goFactor.z =
                computeGradientOpacityFactor(normalMat[2].a, goscale2, goshift2, gomin2, gomax2);
            #endif
            #if vtkNumComponents > 3
              #if !defined(vtkComponent3Proportional)
                goFactor.w =
                  computeGradientOpacityFactor(normalMat[3].a, goscale3, goshift3, gomin3, gomax3);
              #endif
            #endif
          #endif
        #endif
      #endif

      // process color and opacity for each component
      #if !defined(vtkComponent0Proportional)
        float alpha = goFactor.x*mix0*pwfValue0;
        #if vtkLightComplexity > 0
          applyLighting(tColor0, normalMat[0]);
        #endif
      #else
        tColor0 *= pwfValue0;
        float alpha = mix(pwfValue0, 1.0, (1.0 - mix0));
      #endif

      #if vtkNumComponents > 1
        #if !defined(vtkComponent1Proportional)
          alpha += goFactor.y*mix1*pwfValue1;
          #if vtkLightComplexity > 0
            applyLighting(tColor1, normalMat[1]);
          #endif
        #else
          tColor1 *= pwfValue1;
          alpha *= mix(pwfValue1, 1.0, (1.0 - mix1));
        #endif

        #if vtkNumComponents > 2
          #if !defined(vtkComponent2Proportional)
            alpha += goFactor.z*mix2*pwfValue2;
            #if vtkLightComplexity > 0
              applyLighting(tColor2, normalMat[2]);
            #endif
          #else
            tColor2 *= pwfValue2;
            alpha *= mix(pwfValue2, 1.0, (1.0 - mix2));
          #endif
        #endif

        #if vtkNumComponents > 3
          #if !defined(vtkComponent3Proportional)
            alpha += goFactor.w*mix3*pwfValue3;
            #if vtkLightComplexity > 0
              applyLighting(tColor3, normalMat[3]);
            #endif
          #else
            tColor3 *= pwfValue3;
            alpha *= mix(pwfValue3, 1.0, (1.0 - mix3));
          #endif
        #endif
      #endif

      // perform final independent blend
      vec3 tColor = mix0 * tColor0;
      #if vtkNumComponents > 1
        tColor += mix1 * tColor1;
        #if vtkNumComponents > 2
          tColor += mix2 * tColor2;
          #if vtkNumComponents > 3
            tColor += mix3 * tColor3;
          #endif
        #endif
      #endif

      return vec4(tColor, alpha);
    #else
      /*
       * Mix the color information from all the independent components to get a single rgba output
       * Gradient opactity factors and normals are not computed
       *
       * You can compute these using:
       * - computeMat4Normal: always available, compute normal only for non proportional components, used by default independent component mix
       * - computeDensityNormal & computeNormalForDensity: available if ((LightComplexity > 0) || GradientOpacityOn) && ComputeNormalFromOpacity),
       *                                                   used by dependent component color mix, see code for Additive preset in OpenGl/VolumeMapper
       * - computeGradientOpacityFactor: always available, used in a lot of places
       *
       * Using applyAllLightning() is advised for shading but some features don't work well with it (volume shadows, LAO)
       * mix0, mix1, ... are defined for each component that is used and correspond to the componentWeight
       */
      //VTK::CustomComponentsColorMix::Impl
    #endif
  #else
    // dependent components

    // compute normal if needed
    #if (vtkLightComplexity > 0) || defined(vtkGradientOpacityOn)
      // use component 3 of the opacity texture as getTextureValue() sets alpha to the opacity value
      #ifdef vtkComputeNormalFromOpacity
        vec3 scalarInterp[2];
        vec4 normal0 = computeNormalForDensity(posIS, tstep, scalarInterp, 3);
      #else
        vec4 normal0 = computeNormal(posIS, tstep);
      #endif
    #endif

    // compute gradient opacity factor enabled
    #if defined(vtkGradientOpacityOn)
      float gradientOpacity = computeGradientOpacityFactor(normal0.a, goscale0, goshift0, gomin0, gomax0);
    #else
      const float gradientOpacity = 1.0;
    #endif

    // get color and opacity
    #if vtkNumComponents == 1
      vec3 tColor = texture2D(ctexture, vec2(tValue.r * cscale0 + cshift0, 0.5)).rgb;
      float alpha = gradientOpacity*texture2D(otexture, vec2(tValue.r * oscale0 + oshift0, 0.5)).r;
      if (alpha < EPSILON){
        return vec4(0.0);
      }
    #endif
    #if vtkNumComponents == 2
      vec3 tColor = vec3(tValue.r * cscale0 + cshift0);
      float alpha = gradientOpacity*texture2D(otexture, vec2(tValue.a * oscale1 + oshift1, 0.5)).r;
    #endif
    #if vtkNumComponents == 3
      vec3 tColor;
      tColor.r = tValue.r * cscale0 + cshift0;
      tColor.g = tValue.g * cscale1 + cshift1;
      tColor.b = tValue.b * cscale2 + cshift2;
      float alpha = gradientOpacity*texture2D(otexture, vec2(tValue.a * oscale0 + oshift0, 0.5)).r;
    #endif
    #if vtkNumComponents == 4
      vec3 tColor;
      tColor.r = tValue.r * cscale0 + cshift0;
      tColor.g = tValue.g * cscale1 + cshift1;
      tColor.b = tValue.b * cscale2 + cshift2;
      float alpha = gradientOpacity*texture2D(otexture, vec2(tValue.a * oscale3 + oshift3, 0.5)).r;
    #endif

    // lighting
    #if (vtkLightComplexity > 0)
      #ifdef vtkComputeNormalFromOpacity
        vec4 normalLight;
        if (!all(equal(normal0, vec4(0.0)))) {
          scalarInterp[0] = scalarInterp[0] * oscale0 + oshift0;
          scalarInterp[1] = scalarInterp[1] * oscale0 + oshift0;
          normalLight = computeDensityNormal(scalarInterp, 0.5, gradientOpacity);
          if (all(equal(normalLight, vec4(0.0)))) {
            normalLight = normal0;
          }
        }
      #else
        vec4 normalLight = normal0;
      #endif
      tColor = applyAllLightning(tColor, alpha, posIS, normalLight);
    #endif

    return vec4(tColor, alpha);
  #endif // dependent
#endif
}

bool valueWithinScalarRange(vec4 val, vec4 min, vec4 max) {
  bool withinRange = false;
  #if vtkNumComponents == 1
    if (val.r >= min.r && val.r <= max.r) {
      withinRange = true;
    }
  #else
    #ifdef UseIndependentComponents
      #if vtkNumComponents == 2
        if (val.r >= min.r && val.r <= max.r &&
            val.g >= min.g && val.g <= max.g) {
          withinRange = true;
        }
      #else
        if (all(greaterThanEqual(val, ipScalarRangeMin)) &&
            all(lessThanEqual(val, ipScalarRangeMax))) {
          withinRange = true;
        }
      #endif
    #endif
  #endif
  return withinRange;
}

#if vtkBlendMode == 6 
bool checkOnEdgeForNeighbor(int i, int j, int s, vec3 stepIS) {
    vec4 neighborPixelCoord = vec4(gl_FragCoord.x + float(i), gl_FragCoord.y + float(j), gl_FragCoord.z, gl_FragCoord.w);
    vec3 originalNeighborPosIS = fragCoordToIndexSpace(neighborPixelCoord);

    bool justSawIt = false;

    vec3 neighborPosIS = originalNeighborPosIS;

    float stepsTraveled = 0.0;


    // float neighborValue;
    for (int k = 0; k < //VTK::MaximumSamplesValue /2 ; ++k) {
        ivec3 texCoord = ivec3(neighborPosIS * vec3(volumeDimensions));
        vec4 texValue = texelFetch(texture1, texCoord, 0);

        if (int(texValue.g) == s) {
            justSawIt = true;
            break;
        }
        neighborPosIS += stepIS;
    }

    if (justSawIt){
      return false;
    }

   
    neighborPosIS = originalNeighborPosIS;
    for (int k = 0; k < //VTK::MaximumSamplesValue /2 ; ++k) {
        ivec3 texCoord = ivec3(neighborPosIS * vec3(volumeDimensions));
        vec4 texValue = texelFetch(texture1, texCoord, 0);

        if (int(texValue.g) == s) {
            justSawIt = true;
            break;
        }
        neighborPosIS -= stepIS;
    }


    if (!justSawIt) {
        // onedge
        vec3 tColorSegment = texture2D(ctexture, vec2(float(s) * cscale1 + cshift1, height1)).rgb;
        float pwfValueSegment = texture2D(otexture, vec2(float(s) * oscale1 + oshift1, height1)).r;
        gl_FragData[0] = vec4(tColorSegment, pwfValueSegment);
        return true;
    }

    // not on edge
    return false;
}

#endif


//=======================================================================
// Apply the specified blend mode operation along the ray's path.
//
void applyBlend(vec3 posIS, vec3 endIS, vec3 tdims)
{
  vec3 tstep = 1.0/tdims;

  // start slightly inside and apply some jitter
  vec3 delta = endIS - posIS;
  vec3 stepIS = normalize(delta)*sampleDistanceIS;
  float raySteps = length(delta)/sampleDistanceIS;

  // Initialize arrays to false
  // avoid 0.0 jitter
  float jitter = 0.01 + 0.99*texture2D(jtexture, gl_FragCoord.xy/32.0).r;
  float stepsTraveled = jitter;

  // local vars for the loop
  vec4 color = vec4(0.0, 0.0, 0.0, 0.0);
  vec4 tValue;
  vec4 tColor;

  // if we have less than one step then pick the middle point
  // as our value
  // if (raySteps <= 1.0)
  // {
  //   posIS = (posIS + endIS)*0.5;
  // }

  // Perform initial step at the volume boundary
  // compute the scalar
  tValue = getTextureValue(posIS);
  
  #if vtkBlendMode == 6 
    if (raySteps <= 1.0)
    {
      gl_FragData[0] = getColorForValue(tValue, posIS, tstep);
      return;
    }

    vec4 value = tValue;
    posIS += (jitter*stepIS);
    vec3 maxPosIS = posIS; // Store the position of the max value
    int segmentIndex = int(value.g);
    bool originalPosHasSeenNonZero = false;

    uint bitmask = 0u;

    if (segmentIndex != 0) {
      // Tried using the segment index in an boolean array but reading 
      // from the array by dynamic indexing was horrondously slow
      // so use bit masking instead and assign 1 to the bit corresponding to the segment index
      // and later check if the bit is set via bit operations
      setBit(segmentIndex);
    }
    
    // Sample along the ray until MaximumSamplesValue,
    // ending slightly inside the total distance
    for (int i = 0; i < //VTK::MaximumSamplesValue ; ++i)
    {
      // If we have reached the last step, break
      if (stepsTraveled + 1.0 >= raySteps) { break; }

      // compute the scalar
      tValue = getTextureValue(posIS);
      segmentIndex = int(tValue.g);

      if (segmentIndex != 0) {
        originalPosHasSeenNonZero = true;
        setBit(segmentIndex);
      }

      if (tValue.r > value.r) {
        value =  tValue; // Update the max value
        maxPosIS = posIS; // Update the position where max occurred
      }

      // Otherwise, continue along the ray
      stepsTraveled++;
      posIS += stepIS;
    }

    // Perform the last step along the ray using the
    // residual distance
    posIS = endIS;
    tValue = getTextureValue(posIS);

    if (tValue.r > value.r) {
      value = tValue; // Update the max value
      maxPosIS = posIS; // Update the position where max occurred
    }  

    // If we have not seen any non-zero segments, we can return early
    // and grab color from the actual center value first component (image)
    if (!originalPosHasSeenNonZero) {
      gl_FragData[0] = getColorForValue(value, maxPosIS, tstep);
      return;
    }

    // probably we can make this configurable but for now we will use the same
    // sample distance as the original sample distance
    float neighborSampleDistanceIS = sampleDistanceIS;

    vec3 neighborRayStepsIS = stepIS;
    float neighborRaySteps = raySteps;
    bool shouldLookInAllNeighbors = false;

    float minVoxelSpacing = min(volumeSpacings[0], min(volumeSpacings[1], volumeSpacings[2]));
    vec4 base = vec4(gl_FragCoord.x, gl_FragCoord.y, gl_FragCoord.z, gl_FragCoord.w);

    vec4 baseXPlus = vec4(gl_FragCoord.x + 1.0, gl_FragCoord.y, gl_FragCoord.z, gl_FragCoord.w);
    vec4 baseYPlus = vec4(gl_FragCoord.x, gl_FragCoord.y + 1.0, gl_FragCoord.z, gl_FragCoord.w);

    vec3 baseWorld = fragCoordToWorld(base);
    vec3 baseXPlusWorld = fragCoordToWorld(baseXPlus);
    vec3 baseYPlusWorld = fragCoordToWorld(baseYPlus);

    float XPlusDiff = length(baseXPlusWorld - baseWorld);
    float YPlusDiff = length(baseYPlusWorld - baseWorld);

    float minFragSpacingWorld = min(XPlusDiff, YPlusDiff);

    for (int s = 1; s < MAX_SEGMENT_INDEX; s++) {
      // bail out quickly if the segment index has not 
      // been seen by the center segment
      if (!isBitSet(s)) {
       continue;
      }

      // Use texture sampling for outlineThickness so that we can have 
      // per segment thickness
      float textureCoordinate = float(s - 1) / 1024.0;
      float textureValue = texture2D(ttexture, vec2(textureCoordinate, 0.5)).r;

      int actualThickness = int(textureValue * 255.0);

      // check the extreme points in the neighborhood since there is a better
      // chance of finding the edge there, so that we can bail out 
      // faster if we find the edge
      bool onEdge =
          checkOnEdgeForNeighbor(-actualThickness, -actualThickness, s, stepIS) ||
          checkOnEdgeForNeighbor(actualThickness, actualThickness, s, stepIS) ||
          checkOnEdgeForNeighbor(actualThickness, -actualThickness, s, stepIS) ||
          checkOnEdgeForNeighbor(-actualThickness, +actualThickness, s, stepIS);

      if (onEdge) {
        return;
      }

      // since the next step is computationally expensive, we need to perform
      // some optimizations to avoid it if possible. One of the optimizations
      // is to check the whether the minimum of the voxel spacing is greater than 
      // the 2 * the thickness of the outline segment. If that is the case
      // then we can safely skip the next step since we can be sure that the
      // the previous 4 checks on the extreme points would caught the entirety 
      // of the all the fragments inside. i.e., this happens when we zoom out, 
      if (minVoxelSpacing > (2.0 * float(actualThickness) - 1.0) * minFragSpacingWorld) {
        continue;
      }
      
      // Loop through the rest, skipping the processed extremes and the center
      for (int i = -actualThickness; i <= actualThickness; i++) {
            for (int j = -actualThickness; j <= actualThickness; j++) {
                if (i == 0 && j == 0) continue; // Skip the center
                if (abs(i) == actualThickness && abs(j) == actualThickness) continue; // Skip corners
                if (checkOnEdgeForNeighbor(i, j, s, stepIS )) {
                    return;
                }
          }
      }
    }

    vec3 tColor0 = texture2D(ctexture, vec2(value.r * cscale0 + cshift0, height0)).rgb;
    float pwfValue0 = texture2D(otexture, vec2(value.r * oscale0 + oshift0, height0)).r;
    gl_FragData[0] = vec4(tColor0, pwfValue0);
  #endif
  #if vtkBlendMode == 0 // COMPOSITE_BLEND
    // now map through opacity and color
    tColor = getColorForValue(tValue, posIS, tstep);

    // handle very thin volumes
    if (raySteps <= 1.0)
    {
      tColor.a = 1.0 - pow(1.0 - tColor.a, raySteps);
      gl_FragData[0] = tColor;
      return;
    }

    tColor.a = 1.0 - pow(1.0 - tColor.a, jitter);
    color = vec4(tColor.rgb*tColor.a, tColor.a);
    posIS += (jitter*stepIS);

    for (int i = 0; i < //VTK::MaximumSamplesValue ; ++i)
    {
      if (stepsTraveled + 1.0 >= raySteps) { break; }

      // compute the scalar
      tValue = getTextureValue(posIS);

      // now map through opacity and color
      tColor = getColorForValue(tValue, posIS, tstep);

      float mix = (1.0 - color.a);

      // this line should not be needed but nvidia seems to not handle
      // the break correctly on windows/chrome 58 angle
      //mix = mix * sign(max(raySteps - stepsTraveled - 1.0, 0.0));

      color = color + vec4(tColor.rgb*tColor.a, tColor.a)*mix;
      stepsTraveled++;
      posIS += stepIS;
      if (color.a > 0.99) { color.a = 1.0; break; }
    }

    if (color.a < 0.99 && (raySteps - stepsTraveled) > 0.0)
    {
      posIS = endIS;

      // compute the scalar
      tValue = getTextureValue(posIS);

      // now map through opacity and color
      tColor = getColorForValue(tValue, posIS, tstep);
      tColor.a = 1.0 - pow(1.0 - tColor.a, raySteps - stepsTraveled);

      float mix = (1.0 - color.a);
      color = color + vec4(tColor.rgb*tColor.a, tColor.a)*mix;
    }

    gl_FragData[0] = vec4(color.rgb/color.a, color.a);
  #endif
  #if vtkBlendMode == 1 || vtkBlendMode == 2
    // MAXIMUM_INTENSITY_BLEND || MINIMUM_INTENSITY_BLEND
    // Find maximum/minimum intensity along the ray.

    // Define the operation we will use (min or max)
    #if vtkBlendMode == 1
    #define OP max
    #else
    #define OP min
    #endif

    // If the clipping range is shorter than the sample distance
    // we can skip the sampling loop along the ray.
    if (raySteps <= 1.0)
    {
      gl_FragData[0] = getColorForValue(tValue, posIS, tstep);
      return;
    }

    vec4 value = tValue;
    posIS += (jitter*stepIS);

    // Sample along the ray until MaximumSamplesValue,
    // ending slightly inside the total distance
    for (int i = 0; i < //VTK::MaximumSamplesValue ; ++i)
    {
      // If we have reached the last step, break
      if (stepsTraveled + 1.0 >= raySteps) { break; }

      // compute the scalar
      tValue = getTextureValue(posIS);

      // Update the maximum value if necessary
      value = OP(tValue, value);

      // Otherwise, continue along the ray
      stepsTraveled++;
      posIS += stepIS;
    }

    // Perform the last step along the ray using the
    // residual distance
    posIS = endIS;
    tValue = getTextureValue(posIS);
    value = OP(tValue, value);

    // Now map through opacity and color
    gl_FragData[0] = getColorForValue(value, posIS, tstep);
  #endif
  #if vtkBlendMode == 3 || vtkBlendMode == 4 //AVERAGE_INTENSITY_BLEND || ADDITIVE_BLEND
    vec4 sum = vec4(0.);

    if (valueWithinScalarRange(tValue, ipScalarRangeMin, ipScalarRangeMax)) {
      sum += tValue;
    }

    if (raySteps <= 1.0) {
      gl_FragData[0] = getColorForValue(sum, posIS, tstep);
      return;
    }

    posIS += (jitter*stepIS);

    // Sample along the ray until MaximumSamplesValue,
    // ending slightly inside the total distance
    for (int i = 0; i < //VTK::MaximumSamplesValue ; ++i)
    {
      // If we have reached the last step, break
      if (stepsTraveled + 1.0 >= raySteps) { break; }

      // compute the scalar
      tValue = getTextureValue(posIS);

      // One can control the scalar range by setting the AverageIPScalarRange to disregard scalar values, not in the range of interest, from the average computation.
      // Notes:
      // - We are comparing all values in the texture to see if any of them
      //   are outside of the scalar range. In the future we might want to allow
      //   scalar ranges for each component.
      if (valueWithinScalarRange(tValue, ipScalarRangeMin, ipScalarRangeMax)) {
        // Sum the values across each step in the path
        sum += tValue;
      }
      stepsTraveled++;
      posIS += stepIS;
    }

    // Perform the last step along the ray using the
    // residual distance
    posIS = endIS;

    // compute the scalar
    tValue = getTextureValue(posIS);

    // One can control the scalar range by setting the IPScalarRange to disregard scalar values, not in the range of interest, from the average computation
    if (valueWithinScalarRange(tValue, ipScalarRangeMin, ipScalarRangeMax)) {
      sum += tValue;

      stepsTraveled++;
    }

    #if vtkBlendMode == 3 // Average
      sum /= vec4(stepsTraveled, stepsTraveled, stepsTraveled, 1.0);
    #endif

    gl_FragData[0] = getColorForValue(sum, posIS, tstep);
  #endif
  #if vtkBlendMode == 5 // RADON
    float normalizedRayIntensity = 1.0;

    // handle very thin volumes
    if (raySteps <= 1.0)
    {
      tValue = getTextureValue(posIS);
      normalizedRayIntensity = normalizedRayIntensity - sampleDistance*texture2D(otexture, vec2(tValue.r * oscale0 + oshift0, 0.5)).r;
      gl_FragData[0] = texture2D(ctexture, vec2(normalizedRayIntensity, 0.5));
      return;
    }

    posIS += (jitter*stepIS);

    for (int i = 0; i < //VTK::MaximumSamplesValue ; ++i)
    {
      if (stepsTraveled + 1.0 >= raySteps) { break; }

      // compute the scalar value
      tValue = getTextureValue(posIS);

      // Convert scalar value to normalizedRayIntensity coefficient and accumulate normalizedRayIntensity
      normalizedRayIntensity = normalizedRayIntensity - sampleDistance*texture2D(otexture, vec2(tValue.r * oscale0 + oshift0, 0.5)).r;

      posIS += stepIS;
      stepsTraveled++;
    }

    // map normalizedRayIntensity to color
    gl_FragData[0] = texture2D(ctexture, vec2(normalizedRayIntensity , 0.5));

  #endif
}

//=======================================================================
// Compute a new start and end point for a given ray based
// on the provided bounded clipping plane (aka a rectangle)
void getRayPointIntersectionBounds(
  vec3 rayPos, vec3 rayDir,
  vec3 planeDir, float planeDist,
  inout vec2 tbounds, vec3 vPlaneX, vec3 vPlaneY,
  float vSize1, float vSize2)
{
  float result = dot(rayDir, planeDir);
  if (abs(result) < 1e-6)
  {
    return;
  }
  result = -1.0 * (dot(rayPos, planeDir) + planeDist) / result;
  vec3 xposVC = rayPos + rayDir*result;
  vec3 vxpos = xposVC - vOriginVC;
  vec2 vpos = vec2(
    dot(vxpos, vPlaneX),
    dot(vxpos, vPlaneY));

  // on some apple nvidia systems this does not work
  // if (vpos.x < 0.0 || vpos.x > vSize1 ||
  //     vpos.y < 0.0 || vpos.y > vSize2)
  // even just
  // if (vpos.x < 0.0 || vpos.y < 0.0)
  // fails
  // so instead we compute a value that represents in and out
  //and then compute the return using this value
  float xcheck = max(0.0, vpos.x * (vpos.x - vSize1)); //  0 means in bounds
  float check = sign(max(xcheck, vpos.y * (vpos.y - vSize2))); //  0 means in bounds, 1 = out

  tbounds = mix(
   vec2(min(tbounds.x, result), max(tbounds.y, result)), // in value
   tbounds, // out value
   check);  // 0 in 1 out
}

//=======================================================================
// given a
// - ray direction (rayDir)
// - starting point (vertexVCVSOutput)
// - bounding planes of the volume
// - optionally depth buffer values
// - far clipping plane
// compute the start/end distances of the ray we need to cast
vec2 computeRayDistances(vec3 rayDir, vec3 tdims)
{
  vec2 dists = vec2(100.0*camFar, -1.0);

  vec3 vSize = vSpacing*tdims;

  // all this is in View Coordinates
  getRayPointIntersectionBounds(vertexVCVSOutput, rayDir,
    vPlaneNormal0, vPlaneDistance0, dists, vPlaneNormal2, vPlaneNormal4,
    vSize.y, vSize.z);
  getRayPointIntersectionBounds(vertexVCVSOutput, rayDir,
    vPlaneNormal1, vPlaneDistance1, dists, vPlaneNormal2, vPlaneNormal4,
    vSize.y, vSize.z);
  getRayPointIntersectionBounds(vertexVCVSOutput, rayDir,
    vPlaneNormal2, vPlaneDistance2, dists, vPlaneNormal0, vPlaneNormal4,
    vSize.x, vSize.z);
  getRayPointIntersectionBounds(vertexVCVSOutput, rayDir,
    vPlaneNormal3, vPlaneDistance3, dists, vPlaneNormal0, vPlaneNormal4,
    vSize.x, vSize.z);
  getRayPointIntersectionBounds(vertexVCVSOutput, rayDir,
    vPlaneNormal4, vPlaneDistance4, dists, vPlaneNormal0, vPlaneNormal2,
    vSize.x, vSize.y);
  getRayPointIntersectionBounds(vertexVCVSOutput, rayDir,
    vPlaneNormal5, vPlaneDistance5, dists, vPlaneNormal0, vPlaneNormal2,
    vSize.x, vSize.y);

  //VTK::ClipPlane::Impl

  // do not go behind front clipping plane
  dists.x = max(0.0,dists.x);

  // do not go PAST far clipping plane
  float farDist = -camThick/rayDir.z;
  dists.y = min(farDist,dists.y);

  // Do not go past the zbuffer value if set
  // This is used for intermixing opaque geometry
  //VTK::ZBuffer::Impl

  return dists;
}

//=======================================================================
// Compute the index space starting position (pos) and end
// position
//
void computeIndexSpaceValues(out vec3 pos, out vec3 endPos, vec3 rayDir, vec2 dists)
{
  // compute starting and ending values in volume space
  pos = vertexVCVSOutput + dists.x*rayDir;
  pos = pos - vOriginVC;
  // convert to volume basis and origin
  pos = vec3(
    dot(pos, vPlaneNormal0),
    dot(pos, vPlaneNormal2),
    dot(pos, vPlaneNormal4));

  endPos = vertexVCVSOutput + dists.y*rayDir;
  endPos = endPos - vOriginVC;
  endPos = vec3(
    dot(endPos, vPlaneNormal0),
    dot(endPos, vPlaneNormal2),
    dot(endPos, vPlaneNormal4));

  float delta = length(endPos - pos);

  pos *= vVCToIJK;
  endPos *= vVCToIJK;

  float delta2 = length(endPos - pos);
  sampleDistanceIS = sampleDistance*delta2/delta;
  #ifdef VolumeShadowOn
    sampleDistanceISVS = sampleDistanceIS * volumeShadowSamplingDistFactor;
  #endif
}

void main()
{

  if (cameraParallel == 1)
  {
    // Camera is parallel, so the rayDir is just the direction of the camera.
    rayDirVC = vec3(0.0, 0.0, -1.0);
  } else {
    // camera is at 0,0,0 so rayDir for perspective is just the vc coord
    rayDirVC = normalize(vertexVCVSOutput);
  }

  vec3 tdims = vec3(volumeDimensions);

  // compute the start and end points for the ray
  vec2 rayStartEndDistancesVC = computeRayDistances(rayDirVC, tdims);

  // do we need to composite? aka does the ray have any length
  // If not, bail out early
  if (rayStartEndDistancesVC.y <= rayStartEndDistancesVC.x)
  {
    discard;
  }

  // IS = Index Space
  vec3 posIS;
  vec3 endIS;
  computeIndexSpaceValues(posIS, endIS, rayDirVC, rayStartEndDistancesVC);

  // Perform the blending operation along the ray
  applyBlend(posIS, endIS, tdims);
}
`;const{vtkWarningMacro:$Te,vtkErrorMacro:zE}=wo;function GTe(t){switch(t){case Qb.CUSTOM:return"//VTK::CustomColorMix";case Qb.ADDITIVE:return`
        // compute normals
        mat4 normalMat = computeMat4Normal(posIS, tValue, tstep);
        #if (vtkLightComplexity > 0) && defined(vtkComputeNormalFromOpacity)
          vec3 scalarInterp0[2];
          vec4 normalLight0 = computeNormalForDensity(posIS, tstep, scalarInterp0, 0);
          scalarInterp0[0] = scalarInterp0[0] * oscale0 + oshift0;
          scalarInterp0[1] = scalarInterp0[1] * oscale0 + oshift0;
          normalLight0 = computeDensityNormal(scalarInterp0, height0, 1.0);

          vec3 scalarInterp1[2];
          vec4 normalLight1 = computeNormalForDensity(posIS, tstep, scalarInterp1, 1);
          scalarInterp1[0] = scalarInterp1[0] * oscale1 + oshift1;
          scalarInterp1[1] = scalarInterp1[1] * oscale1 + oshift1;
          normalLight1 = computeDensityNormal(scalarInterp1, height1, 1.0);
        #else
          vec4 normalLight0 = normalMat[0];
          vec4 normalLight1 = normalMat[1];
        #endif

        // compute opacities
        float opacity0 = pwfValue0;
        float opacity1 = pwfValue1;
        #ifdef vtkGradientOpacityOn
          float gof0 = computeGradientOpacityFactor(normalMat[0].a, goscale0, goshift0, gomin0, gomax0);
          opacity0 *= gof0;
          float gof1 = computeGradientOpacityFactor(normalMat[1].a, goscale1, goshift1, gomin1, gomax1);
          opacity1 *= gof1;
        #endif
        float opacitySum = opacity0 + opacity1;
        if (opacitySum <= 0.0) {
          return vec4(0.0);
        }

        // mix the colors and opacities
        tColor0 = applyAllLightning(tColor0, opacity0, posIS, normalLight0);
        tColor1 = applyAllLightning(tColor1, opacity1, posIS, normalLight1);
        vec3 mixedColor = (opacity0 * tColor0 + opacity1 * tColor1) / opacitySum;
        return vec4(mixedColor, min(1.0, opacitySum));
`;case Qb.COLORIZE:return`
        // compute normals
        mat4 normalMat = computeMat4Normal(posIS, tValue, tstep);
        #if (vtkLightComplexity > 0) && defined(vtkComputeNormalFromOpacity)
          vec3 scalarInterp0[2];
          vec4 normalLight0 = computeNormalForDensity(posIS, tstep, scalarInterp0, 0);
          scalarInterp0[0] = scalarInterp0[0] * oscale0 + oshift0;
          scalarInterp0[1] = scalarInterp0[1] * oscale0 + oshift0;
          normalLight0 = computeDensityNormal(scalarInterp0, height0, 1.0);
        #else
          vec4 normalLight0 = normalMat[0];
        #endif

        // compute opacities
        float opacity0 = pwfValue0;
        #ifdef vtkGradientOpacityOn
          float gof0 = computeGradientOpacityFactor(normalMat[0].a, goscale0, goshift0, gomin0, gomax0);
          opacity0 *= gof0;
        #endif

        // mix the colors and opacities
        vec3 color = tColor0 * mix(vec3(1.0), tColor1, pwfValue1);
        color = applyAllLightning(color, opacity0, posIS, normalLight0);
        return vec4(color, opacity0);
`;default:return null}}function jTe(t,e){e.classHierarchy.push("vtkOpenGLVolumeMapper");function n(i){[e._scalars,e._scalarOpacityFunc,e._colorTransferFunc,e._labelOutlineThicknessArray].forEach(a=>i.unregisterGraphicsResourceUser(a,t))}t.buildPass=()=>{e.zBufferTexture=null},t.zBufferPass=(i,a)=>{if(i){const o=a.getZBufferTexture();o!==e.zBufferTexture&&(e.zBufferTexture=o)}},t.opaqueZBufferPass=(i,a)=>t.zBufferPass(i,a),t.volumePass=(i,a)=>{if(i){const o=e._openGLRenderWindow;e._openGLRenderWindow=t.getLastAncestorOfType("vtkOpenGLRenderWindow"),o&&!o.isDeleted()&&o!==e._openGLRenderWindow&&n(o),e.context=e._openGLRenderWindow.getContext(),e.tris.setOpenGLRenderWindow(e._openGLRenderWindow),e.jitterTexture.setOpenGLRenderWindow(e._openGLRenderWindow),e.framebuffer.setOpenGLRenderWindow(e._openGLRenderWindow),e.openGLVolume=t.getFirstAncestorOfType("vtkOpenGLVolume");const s=e.openGLVolume.getRenderable();e._openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer");const l=e._openGLRenderer.getRenderable();e.openGLCamera=e._openGLRenderer.getViewNodeFor(l.getActiveCamera()),t.renderPiece(l,s)}},t.getShaderTemplate=(i,a,o)=>{i.Vertex=UTe,i.Fragment=BTe,i.Geometry=""},t.useIndependentComponents=i=>{const a=i.getIndependentComponents(),s=e.currentInput?.getPointData()?.getScalars()?.getNumberOfComponents(),l=i.getColorMixPreset();return a&&s>=2||!!l},t.replaceShaderValues=(i,a,o)=>{const s=o.getProperty();let l=i.Fragment;s.getInterpolationType()===N_.LINEAR&&(l=$e.substitute(l,"//VTK::TrilinearOn","#define vtkTrilinearOn").result),t.isLabelmapOutlineRequired(o)===!0&&(l=$e.substitute(l,"//VTK::ImageLabelOutlineOn","#define vtkImageLabelOutlineOn").result),e.renderable.getBlendMode()===Vb.LABELMAP_EDGE_PROJECTION_BLEND&&(l=$e.substitute(l,"//VTK::LabelEdgeProjectionOn","#define vtkLabelEdgeProjectionOn").result);const d=e.scalarTexture.getComponents();l=$e.substitute(l,"//VTK::NumComponents",`#define vtkNumComponents ${d}`).result;const h=t.useIndependentComponents(s);h&&(l=$e.substitute(l,"//VTK::IndependentComponentsOn","#define UseIndependentComponents").result);const p=[],g=[];for(let _=0;_<d;_++)s.getOpacityMode(_)===mY.PROPORTIONAL&&p.push(`#define vtkComponent${_}Proportional`),s.getForceNearestInterpolation(_)&&g.push(`#define vtkComponent${_}ForceNearest`);l=$e.substitute(l,"//VTK::vtkProportionalComponents",p.join(`
`)).result,l=$e.substitute(l,"//VTK::vtkForceNearestComponents",g.join(`
`)).result;const m=s.getColorMixPreset(),y=GTe(m);y&&(l=$e.substitute(l,"//VTK::CustomComponentsColorMixOn","#define vtkCustomComponentsColorMix").result,l=$e.substitute(l,"//VTK::CustomComponentsColorMix::Impl",y).result);const v=e.currentInput.getSpatialExtent(),x=e.currentInput.getSpacing(),w=new Float64Array(3);Br(w,(v[1]-v[0])*x[0],(v[3]-v[2])*x[1],(v[5]-v[4])*x[2]);const S=Wg(w)/t.getCurrentSampleDistance(a);l=$e.substitute(l,"//VTK::MaximumSamplesValue",`${Math.ceil(S)}`).result,l=$e.substitute(l,"//VTK::LightComplexity",`#define vtkLightComplexity ${e.lightComplexity}`).result,e.lightComplexity>0&&(e.renderable.getVolumetricScatteringBlending()>0&&(l=$e.substitute(l,"//VTK::VolumeShadowOn","#define VolumeShadowOn").result),e.renderable.getVolumetricScatteringBlending()<1&&(l=$e.substitute(l,"//VTK::SurfaceShadowOn","#define SurfaceShadowOn").result),e.renderable.getLocalAmbientOcclusion()&&s.getAmbient()>0&&(l=$e.substitute(l,"//VTK::localAmbientOcclusionOn","#define localAmbientOcclusionOn").result));const T=h?d:1;e.gopacity=!1;for(let _=0;!e.gopacity&&_<T;++_)e.gopacity||=s.getUseGradientOpacity(_);e.gopacity&&(l=$e.substitute(l,"//VTK::GradientOpacityOn","#define vtkGradientOpacityOn").result),e.renderable.getComputeNormalFromOpacity()&&(l=$e.substitute(l,"//VTK::vtkComputeNormalFromOpacity","#define vtkComputeNormalFromOpacity").result),e.zBufferTexture!==null&&(l=$e.substitute(l,"//VTK::ZBuffer::Dec",["uniform sampler2D zBufferTexture;","uniform float vpZWidth;","uniform float vpZHeight;"]).result,l=$e.substitute(l,"//VTK::ZBuffer::Impl",["vec4 depthVec = texture2D(zBufferTexture, vec2(gl_FragCoord.x / vpZWidth, gl_FragCoord.y/vpZHeight));","float zdepth = (depthVec.r*256.0 + depthVec.g)/257.0;","zdepth = zdepth * 2.0 - 1.0;","if (cameraParallel == 0) {","zdepth = -2.0 * camFar * camNear / (zdepth*(camFar-camNear)-(camFar+camNear)) - camNear;}","else {",`zdepth = (zdepth + 1.0) * 0.5 * (camFar - camNear);}
`,"zdepth = -zdepth/rayDir.z;","dists.y = min(zdepth,dists.y);"]).result),l=$e.substitute(l,"//VTK::BlendMode",`${e.renderable.getBlendMode()}`).result,i.Fragment=l,t.replaceShaderLight(i,a,o),t.replaceShaderClippingPlane(i,a,o)},t.replaceShaderLight=(i,a,o)=>{if(e.lightComplexity===0)return;let s=i.Fragment,l=0;a.getLights().forEach(c=>{c.getSwitch()&&(l+=1)}),s=$e.substitute(s,"//VTK::Light::Dec",["uniform int lightNum;","uniform bool twoSidedLighting;",`uniform vec3 lightColor[${l}];`,`uniform vec3 lightDirectionVC[${l}]; // normalized`,`uniform vec3 lightHalfAngleVC[${l}];`,"//VTK::Light::Dec"],!1).result,e.lightComplexity===3&&(s=$e.substitute(s,"//VTK::Light::Dec",[`uniform vec3 lightPositionVC[${l}];`,`uniform vec3 lightAttenuation[${l}];`,`uniform float lightConeAngle[${l}];`,`uniform float lightExponent[${l}];`,`uniform int lightPositional[${l}];`],!1).result),e.renderable.getVolumetricScatteringBlending()>0&&(s=$e.substitute(s,"//VTK::VolumeShadow::Dec",["uniform float volumetricScatteringBlending;","uniform float giReach;","uniform float volumeShadowSamplingDistFactor;","uniform float anisotropy;","uniform float anisotropy2;"],!1).result),e.renderable.getLocalAmbientOcclusion()&&o.getProperty().getAmbient()>0&&(s=$e.substitute(s,"//VTK::LAO::Dec",["uniform int kernelRadius;",`uniform vec2 kernelSample[${e.renderable.getLAOKernelRadius()}];`,"uniform int kernelSize;"],!1).result),i.Fragment=s},t.replaceShaderClippingPlane=(i,a,o)=>{let s=i.Fragment;if(e.renderable.getClippingPlanes().length>0){const l=e.renderable.getClippingPlanes().length;s=$e.substitute(s,"//VTK::ClipPlane::Dec",["uniform vec3 vClipPlaneNormals[6];","uniform float vClipPlaneDistances[6];","uniform vec3 vClipPlaneOrigins[6];","uniform int clip_numPlanes;","//VTK::ClipPlane::Dec","#define vtkClippingPlanesOn"],!1).result,s=$e.substitute(s,"//VTK::ClipPlane::Impl",[`for(int i = 0; i < ${l}; i++) {`,"  float rayDirRatio = dot(rayDir, vClipPlaneNormals[i]);","  float equationResult = dot(vertexVCVSOutput, vClipPlaneNormals[i]) + vClipPlaneDistances[i];","  if (rayDirRatio == 0.0)","  {","    if (equationResult < 0.0) dists.x = dists.y;","    continue;","  }","  float result = -1.0 * equationResult / rayDirRatio;","  if (rayDirRatio < 0.0) dists.y = min(dists.y, result);","  else dists.x = max(dists.x, result);","}","//VTK::ClipPlane::Impl"],!1).result}i.Fragment=s};const r=(i,a)=>{let o=0;i.getProperty().getShade()&&e.renderable.getBlendMode()===Vb.COMPOSITE_BLEND&&(o=0,e.numberOfLights=0,a.forEach(s=>{s.getSwitch()>0&&(e.numberOfLights++,o===0&&(o=1)),o===1&&(e.numberOfLights>1||s.getIntensity()!==1||!s.lightTypeIsHeadLight())&&(o=2),o<3&&s.getPositional()&&(o=3)})),o!==e.lightComplexity&&(e.lightComplexity=o,t.modified())};t.getNeedToRebuildShaders=(i,a,o)=>{const s=o.getProperty();r(o,a.getLights());const l=e.scalarTexture.getComponents(),c=[],f=[];for(let y=0;y<l;y++)c.push(s.getOpacityMode(y)),f.push(s.getForceNearestInterpolation(y));const u=e.currentInput.getSpatialExtent(),d=e.currentInput.getSpacing(),h=new Float64Array(3);Br(h,(u[1]-u[0])*d[0],(u[3]-u[2])*d[1],(u[5]-u[4])*d[2]);const p=Wg(h)/t.getCurrentSampleDistance(a),g=!!e.zBufferTexture,m={iComps:s.getIndependentComponents(),colorMixPreset:s.getColorMixPreset(),interpolationType:s.getInterpolationType(),useLabelOutline:t.isLabelmapOutlineRequired(o),numComp:l,maxSamples:p,useGradientOpacity:s.getUseGradientOpacity(0),blendMode:e.renderable.getBlendMode(),hasZBufferTexture:g,opacityModes:c,forceNearestInterps:f};return i.getProgram()?.getHandle()===0||i.getShaderSourceTime().getMTime()<t.getMTime()||i.getShaderSourceTime().getMTime()<e.renderable.getMTime()||!e.previousState||!kD(e.previousState,m)?(e.previousState=m,!0):!1},t.updateShaders=(i,a,o)=>{if(t.getNeedToRebuildShaders(i,a,o)){const s={Vertex:null,Fragment:null,Geometry:null};t.buildShaders(s,a,o);const l=e._openGLRenderWindow.getShaderCache().readyShaderProgramArray(s.Vertex,s.Fragment,s.Geometry);l!==i.getProgram()&&(i.setProgram(l),i.getVAO().releaseGraphicsResources()),i.getShaderSourceTime().modified()}else e._openGLRenderWindow.getShaderCache().readyShaderProgram(i.getProgram());i.getVAO().bind(),t.setMapperShaderParameters(i,a,o),t.setCameraShaderParameters(i,a,o),t.setPropertyShaderParameters(i,a,o),t.getClippingPlaneShaderParameters(i,a,o)},t.setMapperShaderParameters=(i,a,o)=>{const s=i.getProgram();i.getCABO().getElementCount()&&(e.VBOBuildTime.getMTime()>i.getAttributeUpdateTime().getMTime()||i.getShaderSourceTime().getMTime()>i.getAttributeUpdateTime().getMTime())&&(s.isAttributeUsed("vertexDC")&&(i.getVAO().addAttributeArray(s,i.getCABO(),"vertexDC",i.getCABO().getVertexOffset(),i.getCABO().getStride(),e.context.FLOAT,3,e.context.FALSE)||zE("Error setting vertexDC in shader VAO.")),i.getAttributeUpdateTime().modified()),s.setUniformi("texture1",e.scalarTexture.getTextureUnit()),s.setUniformf("sampleDistance",t.getCurrentSampleDistance(a));const l=e.scalarTexture.getVolumeInfo(),c=e.renderable.getIpScalarRange();if(l?.dataComputedScale?.length){const f=[],u=[];for(let d=0;d<4;d++)f[d]=c[0]*l.dataComputedScale[d]+l.dataComputedOffset[d],u[d]=c[1]*l.dataComputedScale[d]+l.dataComputedOffset[d],f[d]=(f[d]-l.offset[d])/l.scale[d],u[d]=(u[d]-l.offset[d])/l.scale[d];s.setUniform4f("ipScalarRangeMin",f[0],f[1],f[2],f[3]),s.setUniform4f("ipScalarRangeMax",u[0],u[1],u[2],u[3])}if(e.zBufferTexture!==null){s.setUniformi("zBufferTexture",e.zBufferTexture.getTextureUnit());const f=e._useSmallViewport?[e._smallViewportWidth,e._smallViewportHeight]:e._openGLRenderWindow.getFramebufferSize();s.setUniformf("vpZWidth",f[0]),s.setUniformf("vpZHeight",f[1])}},t.setCameraShaderParameters=(i,a,o)=>{const s=e.openGLCamera.getKeyMatrices(a),l=e.openGLVolume.getKeyMatrices();zn(e.modelToView,s.wcvc,l.mcwc);const c=i.getProgram(),f=e.openGLCamera.getRenderable(),u=f.getClippingRange();c.setUniformf("camThick",u[1]-u[0]),c.setUniformf("camNear",u[0]),c.setUniformf("camFar",u[1]);const d=e.currentInput.getBounds(),h=e.currentInput.getDimensions(),p=new Float64Array(3),g=new Float64Array(3);let m=1,y=-1,v=1,x=-1;for(let V=0;V<8;++V){if(Br(p,d[V%2],d[2+Math.floor(V/2)%2],d[4+Math.floor(V/4)]),Gn(p,p,e.modelToView),!f.getParallelProjection()){wc(g,p);const $=-u[0]/p[2];ff(p,g,$)}Gn(p,p,s.vcpc),m=Math.min(p[0],m),y=Math.max(p[0],y),v=Math.min(p[1],v),x=Math.max(p[1],x)}c.setUniformf("dcxmin",m),c.setUniformf("dcxmax",y),c.setUniformf("dcymin",v),c.setUniformf("dcymax",x),c.isUniformUsed("cameraParallel")&&c.setUniformi("cameraParallel",f.getParallelProjection());const w=e.currentInput.getSpatialExtent(),S=e.currentInput.getSpacing(),T=new Float64Array(3);Br(T,(w[1]-w[0])*S[0],(w[3]-w[2])*S[1],(w[5]-w[4])*S[2]),c.setUniform3f("vSpacing",S[0],S[1],S[2]),Br(p,w[0],w[2],w[4]),e.currentInput.indexToWorldVec3(p,p),Gn(p,p,e.modelToView),c.setUniform3f("vOriginVC",p[0],p[1],p[2]);const _=e.currentInput.getIndexToWorld();zn(e.idxToView,e.modelToView,_),hm(e.idxNormalMatrix,s.normalMatrix,l.normalMatrix),hm(e.idxNormalMatrix,e.idxNormalMatrix,e.currentInput.getDirectionByReference());const D=Wg(T)/t.getCurrentSampleDistance(a);D>e.renderable.getMaximumSamplesPerRay()&&$Te(`The number of steps required ${Math.ceil(D)} is larger than the
        specified maximum number of steps ${e.renderable.getMaximumSamplesPerRay()}.
        Please either change the
        volumeMapper sampleDistance or its maximum number of samples.`);const I=new Float64Array(3);if(Br(I,1,1,1),E3e(I,I,T),c.setUniform3f("vVCToIJK",I[0],I[1],I[2]),c.setUniform3i("volumeDimensions",h[0],h[1],h[2]),c.setUniform3f("volumeSpacings",S[0],S[1],S[2]),!e._openGLRenderWindow.getWebgl2()){const V=e.scalarTexture.getVolumeInfo();c.setUniformf("texWidth",e.scalarTexture.getWidth()),c.setUniformf("texHeight",e.scalarTexture.getHeight()),c.setUniformi("xreps",V.xreps),c.setUniformi("xstride",V.xstride),c.setUniformi("ystride",V.ystride)}const R=new Float64Array(3),O=new Float64Array(3);for(let V=0;V<6;++V){switch(V){case 1:Br(R,-1,0,0),Br(O,w[0],w[2],w[4]);break;case 2:Br(R,0,1,0),Br(O,w[1],w[3],w[5]);break;case 3:Br(R,0,-1,0),Br(O,w[0],w[2],w[4]);break;case 4:Br(R,0,0,1),Br(O,w[1],w[3],w[5]);break;case 5:Br(R,0,0,-1),Br(O,w[0],w[2],w[4]);break;case 0:default:Br(R,1,0,0),Br(O,w[1],w[3],w[5]);break}Jb(R,R,e.idxNormalMatrix),Gn(O,O,e.idxToView);const $=-1*K2(O,R);c.setUniform3f(`vPlaneNormal${V}`,R[0],R[1],R[2]),c.setUniformf(`vPlaneDistance${V}`,$)}if(t.isLabelmapOutlineRequired(o)){const $=e.currentInput.getWorldToIndex();c.setUniformMatrix("vWCtoIDX",$);const U=a.getActiveCamera(),[G,F]=U.getClippingRange(),J=U.getDistance();U.setClippingRange(J,J+.1);const Q=e.openGLCamera.getKeyMatrices(a);Ea(e.projectionToWorld,Q.wcpc),U.setClippingRange(G,F),e.openGLCamera.getKeyMatrices(a),c.setUniformMatrix("PCWCMatrix",e.projectionToWorld);const ne=t.getRenderTargetSize();c.setUniformf("vpWidth",ne[0]),c.setUniformf("vpHeight",ne[1]);const ye=t.getRenderTargetOffset();c.setUniformf("vpOffsetX",ye[0]/ne[0]),c.setUniformf("vpOffsetY",ye[1]/ne[1])}if(Ea(e.projectionToView,s.vcpc),c.setUniformMatrix("PCVCMatrix",e.projectionToView),e.lightComplexity===0)return;let P=0;const N=[],A=[],B=[];if(a.getLights().forEach(V=>{if(V.getSwitch()>0){const U=V.getColor(),G=V.getIntensity();N[0+P*3]=U[0]*G,N[1+P*3]=U[1]*G,N[2+P*3]=U[2]*G;const F=V.getDirection();Br(R,F[0],F[1],F[2]),Jb(R,R,s.normalMatrix),wc(R,R),A[0+P*3]=R[0],A[1+P*3]=R[1],A[2+P*3]=R[2],B[0+P*3]=-.5*R[0],B[1+P*3]=-.5*R[1],B[2+P*3]=-.5*(R[2]-1),P++}}),c.setUniformi("twoSidedLighting",a.getTwoSidedLighting()),c.setUniformi("lightNum",P),c.setUniform3fv("lightColor",N),c.setUniform3fv("lightDirectionVC",A),c.setUniform3fv("lightHalfAngleVC",B),e.lightComplexity===3){P=0;const V=[],$=[],U=[],G=[],F=[];a.getLights().forEach(J=>{if(J.getSwitch()>0){const ne=J.getAttenuationValues();$[0+P*3]=ne[0],$[1+P*3]=ne[1],$[2+P*3]=ne[2],G[P]=J.getExponent(),U[P]=J.getConeAngle(),F[P]=J.getPositional();const ye=J.getTransformedPosition();Gn(ye,ye,e.modelToView),V[0+P*3]=ye[0],V[1+P*3]=ye[1],V[2+P*3]=ye[2],P+=1}}),c.setUniform3fv("lightPositionVC",V),c.setUniform3fv("lightAttenuation",$),c.setUniformfv("lightConeAngle",U),c.setUniformfv("lightExponent",G),c.setUniformiv("lightPositional",F)}if(e.renderable.getVolumetricScatteringBlending()>0&&(c.setUniformf("giReach",e.renderable.getGlobalIlluminationReach()),c.setUniformf("volumetricScatteringBlending",e.renderable.getVolumetricScatteringBlending()),c.setUniformf("volumeShadowSamplingDistFactor",e.renderable.getVolumeShadowSamplingDistFactor()),c.setUniformf("anisotropy",e.renderable.getAnisotropy()),c.setUniformf("anisotropy2",e.renderable.getAnisotropy()**2)),e.renderable.getLocalAmbientOcclusion()&&o.getProperty().getAmbient()>0){const V=e.renderable.getLAOKernelSize();c.setUniformi("kernelSize",V);const $=[];for(let U=0;U<V;U++)$[U*2]=Math.random()*.5,$[U*2+1]=Math.random()*.5;c.setUniform2fv("kernelSample",$),c.setUniformi("kernelRadius",e.renderable.getLAOKernelRadius())}},t.setPropertyShaderParameters=(i,a,o)=>{const s=i.getProgram();s.setUniformi("ctexture",e.colorTexture.getTextureUnit()),s.setUniformi("otexture",e.opacityTexture.getTextureUnit()),s.setUniformi("jtexture",e.jitterTexture.getTextureUnit()),s.setUniformi("ttexture",e.labelOutlineThicknessTexture.getTextureUnit());const l=e.scalarTexture.getVolumeInfo(),c=o.getProperty(),f=e.scalarTexture.getComponents(),u=t.useIndependentComponents(c);if(u)for(let h=0;h<f;h++)s.setUniformf(`mix${h}`,o.getProperty().getComponentWeight(h));for(let h=0;h<f;h++){const p=u?h:0,g=l.scale[h],y=c.getScalarOpacity(p).getRange(),v=g/(y[1]-y[0]),x=(l.offset[h]-y[0])/(y[1]-y[0]);s.setUniformf(`oshift${h}`,x),s.setUniformf(`oscale${h}`,v);const S=c.getRGBTransferFunction(p).getRange(),T=(l.offset[h]-S[0])/(S[1]-S[0]),_=g/(S[1]-S[0]);s.setUniformf(`cshift${h}`,T),s.setUniformf(`cscale${h}`,_)}if(e.gopacity)if(u)for(let h=0;h<f;++h){const p=l.scale[h];if(c.getUseGradientOpacity(h)){const m=c.getGradientOpacityMinimumOpacity(h),y=c.getGradientOpacityMaximumOpacity(h);s.setUniformf(`gomin${h}`,m),s.setUniformf(`gomax${h}`,y);const v=[c.getGradientOpacityMinimumValue(h),c.getGradientOpacityMaximumValue(h)];s.setUniformf(`goscale${h}`,p*(y-m)/(v[1]-v[0])),s.setUniformf(`goshift${h}`,-v[0]*(y-m)/(v[1]-v[0])+m)}else s.setUniformf(`gomin${h}`,1),s.setUniformf(`gomax${h}`,1),s.setUniformf(`goscale${h}`,0),s.setUniformf(`goshift${h}`,1)}else{const h=l.scale[f-1],p=c.getGradientOpacityMinimumOpacity(0),g=c.getGradientOpacityMaximumOpacity(0);s.setUniformf("gomin0",p),s.setUniformf("gomax0",g);const m=[c.getGradientOpacityMinimumValue(0),c.getGradientOpacityMaximumValue(0)];s.setUniformf("goscale0",h*(g-p)/(m[1]-m[0])),s.setUniformf("goshift0",-m[0]*(g-p)/(m[1]-m[0])+p)}if(t.isLabelmapOutlineRequired(o)===!0){const h=o.getProperty().getLabelOutlineOpacity();s.setUniformf("outlineOpacity",h)}e.lightComplexity>0&&(s.setUniformf("vAmbient",c.getAmbient()),s.setUniformf("vDiffuse",c.getDiffuse()),s.setUniformf("vSpecular",c.getSpecular()),s.setUniformf("vSpecularPower",c.getSpecularPower()))},t.getClippingPlaneShaderParameters=(i,a,o)=>{if(e.renderable.getClippingPlanes().length>0){const s=e.openGLCamera.getKeyMatrices(a),l=[],c=[],f=[],u=e.renderable.getClippingPlanes(),d=u.length;for(let p=0;p<d;++p){const g=u[p].getNormal(),m=u[p].getOrigin();Jb(g,g,s.normalMatrix),Gn(m,m,s.wcvc);const y=-1*K2(m,g);l.push(g[0]),l.push(g[1]),l.push(g[2]),c.push(y),f.push(m[0]),f.push(m[1]),f.push(m[2])}const h=i.getProgram();h.setUniform3fv("vClipPlaneNormals",l),h.setUniformfv("vClipPlaneDistances",c),h.setUniform3fv("vClipPlaneOrigins",f),h.setUniformi("clip_numPlanes",d)}},t.delete=Oy(()=>{e._animationRateSubscription&&(e._animationRateSubscription.unsubscribe(),e._animationRateSubscription=null)},()=>{e._openGLRenderWindow&&n(e._openGLRenderWindow)},t.delete),t.getRenderTargetSize=()=>{if(e._useSmallViewport)return[e._smallViewportWidth,e._smallViewportHeight];const{usize:i,vsize:a}=e._openGLRenderer.getTiledSizeAndOrigin();return[i,a]},t.getRenderTargetOffset=()=>{const{lowerLeftU:i,lowerLeftV:a}=e._openGLRenderer.getTiledSizeAndOrigin();return[i,a]},t.getCurrentSampleDistance=i=>{const a=i.getVTKWindow().getInteractor(),o=e.renderable.getSampleDistance();if(a.isAnimating()){const s=e.renderable.getInteractionSampleDistanceFactor();return o*s}return o},t.renderPieceStart=(i,a)=>{const o=i.getVTKWindow().getInteractor();if(e._lastScale||(e._lastScale=e.renderable.getInitialInteractionScale()),e._useSmallViewport=!1,o.isAnimating()&&e._lastScale>1.5&&(e._useSmallViewport=!0),e._animationRateSubscription||(e._animationRateSubscription=o.onAnimationFrameRateUpdate(()=>{if(e.renderable.getAutoAdjustSampleDistances()){const l=o.getRecentAnimationFrameRate(),c=o.getDesiredUpdateRate()/l;(c>1.15||c<.85)&&(e._lastScale*=c),e._lastScale>400&&(e._lastScale=400),e._lastScale<1.5&&(e._lastScale=1.5)}else e._lastScale=e.renderable.getImageSampleDistance()*e.renderable.getImageSampleDistance()})),e._useSmallViewport){const l=e._openGLRenderWindow.getFramebufferSize(),c=1/Math.sqrt(e._lastScale);if(e._smallViewportWidth=Math.ceil(c*l[0]),e._smallViewportHeight=Math.ceil(c*l[1]),e._smallViewportHeight>l[1]&&(e._smallViewportHeight=l[1]),e._smallViewportWidth>l[0]&&(e._smallViewportWidth=l[0]),e.framebuffer.saveCurrentBindingsAndBuffers(),e.framebuffer.getGLFramebuffer()===null)e.framebuffer.create(l[0],l[1]),e.framebuffer.populateFramebuffer();else{const u=e.framebuffer.getSize();(!u||u[0]!==l[0]||u[1]!==l[1])&&(e.framebuffer.create(l[0],l[1]),e.framebuffer.populateFramebuffer())}e.framebuffer.bind();const f=e.context;f.clearColor(0,0,0,0),f.colorMask(!0,!0,!0,!0),f.clear(f.COLOR_BUFFER_BIT),f.viewport(0,0,e._smallViewportWidth,e._smallViewportHeight),e.fvp=[e._smallViewportWidth/l[0],e._smallViewportHeight/l[1]]}e.context.disable(e.context.DEPTH_TEST),t.updateBufferObjects(i,a),a.getProperty().getInterpolationType()===N_.NEAREST?(e.scalarTexture.setMinificationFilter(an.NEAREST),e.scalarTexture.setMagnificationFilter(an.NEAREST)):(e.scalarTexture.setMinificationFilter(an.LINEAR),e.scalarTexture.setMagnificationFilter(an.LINEAR)),e.zBufferTexture!==null&&e.zBufferTexture.activate()},t.renderPieceDraw=(i,a)=>{const o=e.context;e.scalarTexture.activate(),e.opacityTexture.activate(),e.labelOutlineThicknessTexture.activate(),e.colorTexture.activate(),e.jitterTexture.activate(),t.updateShaders(e.tris,i,a),o.drawArrays(o.TRIANGLES,0,e.tris.getCABO().getElementCount()),e.tris.getVAO().release(),e.scalarTexture.deactivate(),e.colorTexture.deactivate(),e.opacityTexture.deactivate(),e.labelOutlineThicknessTexture.deactivate(),e.jitterTexture.deactivate()},t.renderPieceFinish=(i,a)=>{if(e.zBufferTexture!==null&&e.zBufferTexture.deactivate(),e._useSmallViewport){if(e.framebuffer.restorePreviousBindingsAndBuffers(),e.copyShader===null){e.copyShader=e._openGLRenderWindow.getShaderCache().readyShaderProgramArray(["//VTK::System::Dec","attribute vec4 vertexDC;","uniform vec2 tfactor;","varying vec2 tcoord;","void main() { tcoord = vec2(vertexDC.x*0.5 + 0.5, vertexDC.y*0.5 + 0.5) * tfactor; gl_Position = vertexDC; }"].join(`
`),["//VTK::System::Dec","//VTK::Output::Dec","uniform sampler2D texture1;","varying vec2 tcoord;","void main() { gl_FragData[0] = texture2D(texture1,tcoord); }"].join(`
`),"");const c=e.copyShader;e.copyVAO=M7.newInstance(),e.copyVAO.setOpenGLRenderWindow(e._openGLRenderWindow),e.tris.getCABO().bind(),e.copyVAO.addAttributeArray(c,e.tris.getCABO(),"vertexDC",e.tris.getCABO().getVertexOffset(),e.tris.getCABO().getStride(),e.context.FLOAT,3,e.context.FALSE)||zE("Error setting vertexDC in copy shader VAO.")}else e._openGLRenderWindow.getShaderCache().readyShaderProgram(e.copyShader);const o=e._openGLRenderWindow.getFramebufferSize();e.context.viewport(0,0,o[0],o[1]);const s=e.framebuffer.getColorTexture();s.activate(),e.copyShader.setUniformi("texture",s.getTextureUnit()),e.copyShader.setUniform2f("tfactor",e.fvp[0],e.fvp[1]);const l=e.context;l.blendFuncSeparate(l.ONE,l.ONE_MINUS_SRC_ALPHA,l.ONE,l.ONE_MINUS_SRC_ALPHA),e.context.drawArrays(e.context.TRIANGLES,0,e.tris.getCABO().getElementCount()),s.deactivate(),l.blendFuncSeparate(l.SRC_ALPHA,l.ONE_MINUS_SRC_ALPHA,l.ONE,l.ONE_MINUS_SRC_ALPHA)}},t.renderPiece=(i,a)=>{if(t.invokeEvent({type:"StartEvent"}),e.renderable.update(),e.currentInput=e.renderable.getInputData(),t.invokeEvent({type:"EndEvent"}),!e.currentInput){zE("No input!");return}t.renderPieceStart(i,a),t.renderPieceDraw(i,a),t.renderPieceFinish(i,a)},t.computeBounds=(i,a)=>{if(!t.getInput()){jm(e.Bounds);return}e.bounds=t.getInput().getBounds()},t.updateBufferObjects=(i,a)=>{t.getNeedToRebuildBufferObjects(i,a)&&t.buildBufferObjects(i,a)},t.getNeedToRebuildBufferObjects=(i,a)=>e.VBOBuildTime.getMTime()<t.getMTime()||e.VBOBuildTime.getMTime()<a.getMTime()||e.VBOBuildTime.getMTime()<e.renderable.getMTime()||e.VBOBuildTime.getMTime()<a.getProperty().getMTime()||e.VBOBuildTime.getMTime()<e.currentInput.getMTime()||!e.scalarTexture?.getHandle()||!e.colorTexture?.getHandle()||!e.labelOutlineThicknessTexture?.getHandle(),t.buildBufferObjects=(i,a)=>{const o=e.currentInput;if(!o)return;const s=o.getPointData()&&o.getPointData().getScalars();if(!s)return;const l=a.getProperty();if(!e.jitterTexture.getHandle()){const _=new Uint8Array(1024);for(let D=0;D<1024;++D)_[D]=255*Math.random();e.jitterTexture.setMinificationFilter(an.LINEAR),e.jitterTexture.setMagnificationFilter(an.LINEAR),e.jitterTexture.create2DFromRaw(32,32,1,Ln.UNSIGNED_CHAR,_)}const c=s.getNumberOfComponents(),f=t.useIndependentComponents(l),u=f?c:1,d=l.getScalarOpacity(),h=e._openGLRenderWindow.getGraphicsResourceForObject(d);let p=bu(d,f,u);if(!h?.oglObject||h.hash!==p){e.opacityTexture=ai.newInstance(),e.opacityTexture.setOpenGLRenderWindow(e._openGLRenderWindow);const _=1024,D=_*2*u,I=new Float32Array(D),R=new Float32Array(_);for(let O=0;O<u;++O){const P=l.getScalarOpacity(O),N=t.getCurrentSampleDistance(i)/l.getScalarOpacityUnitDistance(O),A=P.getRange();P.getTable(A[0],A[1],_,R,1);for(let B=0;B<_;++B)I[O*_*2+B]=1-(1-R[B])**N,I[O*_*2+B+_]=I[O*_*2+B]}if(e.opacityTexture.resetFormatAndType(),e.opacityTexture.setMinificationFilter(an.LINEAR),e.opacityTexture.setMagnificationFilter(an.LINEAR),e._openGLRenderWindow.getWebgl2()||e.context.getExtension("OES_texture_float")&&e.context.getExtension("OES_texture_float_linear"))e.opacityTexture.create2DFromRaw(_,2*u,1,Ln.FLOAT,I);else{const O=new Uint8ClampedArray(D);for(let P=0;P<D;++P)O[P]=255*I[P];e.opacityTexture.create2DFromRaw(_,2*u,1,Ln.UNSIGNED_CHAR,O)}d&&(e._openGLRenderWindow.setGraphicsResourceForObject(d,e.opacityTexture,p),d!==e._scalarOpacityFunc&&(e._openGLRenderWindow.registerGraphicsResourceUser(d,t),e._openGLRenderWindow.unregisterGraphicsResourceUser(e._scalarOpacityFunc,t)),e._scalarOpacityFunc=d)}else e.opacityTexture=h.oglObject;const m=l.getRGBTransferFunction();p=bu(m,f,u);const y=e._openGLRenderWindow.getGraphicsResourceForObject(m);if(!y?.oglObject?.getHandle()||y?.hash!==p){e.colorTexture=ai.newInstance(),e.colorTexture.setOpenGLRenderWindow(e._openGLRenderWindow);const _=1024,D=_*2*u*3,I=new Uint8ClampedArray(D),R=new Float32Array(_*3);for(let O=0;O<u;++O){const P=l.getRGBTransferFunction(O),N=P.getRange();P.getTable(N[0],N[1],_,R,1);for(let A=0;A<_*3;++A)I[O*_*6+A]=255*R[A],I[O*_*6+A+_*3]=255*R[A]}e.colorTexture.resetFormatAndType(),e.colorTexture.setMinificationFilter(an.LINEAR),e.colorTexture.setMagnificationFilter(an.LINEAR),e.colorTexture.create2DFromRaw(_,2*u,3,Ln.UNSIGNED_CHAR,I),m&&(e._openGLRenderWindow.setGraphicsResourceForObject(m,e.colorTexture,p),m!==e._colorTransferFunc&&(e._openGLRenderWindow.registerGraphicsResourceUser(m,t),e._openGLRenderWindow.unregisterGraphicsResourceUser(e._colorTransferFunc,t)),e._colorTransferFunc=m)}else e.colorTexture=y.oglObject;t.updateLabelOutlineThicknessTexture(a);const x=e._openGLRenderWindow.getGraphicsResourceForObject(s);p=R7(o,s);const w=!x?.oglObject?.getHandle()||x?.hash!==p,S=e.renderable.getUpdatedExtents(),T=!!S.length;if(w&&!T){e.scalarTexture=ai.newInstance(),e.scalarTexture.setOpenGLRenderWindow(e._openGLRenderWindow);const _=o.getDimensions();e.scalarTexture.setOglNorm16Ext(e.context.getExtension("EXT_texture_norm16")),e.scalarTexture.resetFormatAndType(),e.scalarTexture.create3DFilterableFromDataArray(_[0],_[1],_[2],s),s&&(e._openGLRenderWindow.setGraphicsResourceForObject(s,e.scalarTexture,p),s!==e._scalars&&(e._openGLRenderWindow.registerGraphicsResourceUser(s,t),e._openGLRenderWindow.unregisterGraphicsResourceUser(e._scalars,t)),e._scalars=s)}else e.scalarTexture=x.oglObject;if(T){e.renderable.setUpdatedExtents([]);const _=o.getDimensions();e.scalarTexture.create3DFilterableFromDataArray(_[0],_[1],_[2],s,!1,S)}if(!e.tris.getCABO().getElementCount()){const _=new Float32Array(12);for(let O=0;O<4;O++)_[O*3]=O%2*2-1,_[O*3+1]=O>1?1:-1,_[O*3+2]=-1;const D=new Uint16Array(8);D[0]=3,D[1]=0,D[2]=1,D[3]=3,D[4]=3,D[5]=0,D[6]=3,D[7]=2;const I=tn.newInstance({numberOfComponents:3,values:_});I.setName("points");const R=tn.newInstance({numberOfComponents:1,values:D});e.tris.getCABO().createVBO(R,"polys",go.SURFACE,{points:I,cellOffset:0})}e.VBOBuildTime.modified()},t.updateLabelOutlineThicknessTexture=i=>{const a=i.getProperty().getLabelOutlineThickness(),o=e._openGLRenderWindow.getGraphicsResourceForObject(a),s=`${a.join("-")}`;if(!o?.oglObject?.getHandle()||o?.hash!==s){e.labelOutlineThicknessTexture=ai.newInstance(),e.labelOutlineThicknessTexture.setOpenGLRenderWindow(e._openGLRenderWindow);const c=1024,f=1,u=c*f,d=new Uint8Array(u);for(let h=0;h<c;++h){const p=typeof a[h]<"u"?a[h]:a[0];d[h]=p}e.labelOutlineThicknessTexture.resetFormatAndType(),e.labelOutlineThicknessTexture.setMinificationFilter(an.NEAREST),e.labelOutlineThicknessTexture.setMagnificationFilter(an.NEAREST),e.labelOutlineThicknessTexture.create2DFromRaw(c,f,1,Ln.UNSIGNED_CHAR,d),a&&(e._openGLRenderWindow.setGraphicsResourceForObject(a,e.labelOutlineThicknessTexture,s),a!==e._labelOutlineThicknessArray&&(e._openGLRenderWindow.registerGraphicsResourceUser(a,t),e._openGLRenderWindow.unregisterGraphicsResourceUser(e._labelOutlineThicknessArray,t)),e._labelOutlineThicknessArray=a)}else e.labelOutlineThicknessTexture=o.oglObject},t.isLabelmapOutlineRequired=i=>{const a=i.getProperty(),o=e.renderable;return a.getUseLabelOutline()||o.getBlendMode()===Vb.LABELMAP_EDGE_PROJECTION_BLEND}}const zTe={context:null,VBOBuildTime:null,scalarTexture:null,opacityTexture:null,opacityTextureString:null,colorTexture:null,colorTextureString:null,jitterTexture:null,labelOutlineThicknessTexture:null,labelOutlineThicknessTextureString:null,tris:null,framebuffer:null,copyShader:null,copyVAO:null,lastXYF:1,targetXYF:1,zBufferTexture:null,lastZBufferTexture:null,lightComplexity:0,fullViewportTime:1,idxToView:null,idxNormalMatrix:null,modelToView:null,projectionToView:null,avgWindowArea:0,avgFrameTime:0};function pJ(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,zTe,n),kr.extend(t,e,n),xu.implementBuildShadersWithReplacements(t,e,n),e.VBOBuildTime={},Wr(e.VBOBuildTime,{mtime:0}),e.tris=Du.newInstance(),e.jitterTexture=ai.newInstance(),e.jitterTexture.setWrapS(q2.REPEAT),e.jitterTexture.setWrapT(q2.REPEAT),e.framebuffer=HC.newInstance(),e.idxToView=on(new Float64Array(16)),e.idxNormalMatrix=Bl(new Float64Array(9)),e.modelToView=on(new Float64Array(16)),e.projectionToView=on(new Float64Array(16)),e.projectionToWorld=on(new Float64Array(16)),Ni(t,e,["context"]),jTe(t,e)}const gJ=Qn(pJ,"vtkOpenGLVolumeMapper");var mJ={newInstance:gJ,extend:pJ};ha("vtkVolumeMapper",gJ);const{vtkDebugMacro:WTe}=wo;function HTe(t,e){e.classHierarchy.push("vtkOpenGLPixelSpaceCallbackMapper"),t.opaquePass=(n,r)=>{e._openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e._openGLRenderWindow=e._openGLRenderer.getLastAncestorOfType("vtkOpenGLRenderWindow");const i=e._openGLRenderer.getAspectRatio(),a=e._openGLRenderer?e._openGLRenderer.getRenderable().getActiveCamera():null,o=e._openGLRenderer.getTiledSizeAndOrigin();let s=null;if(e.renderable.getUseZValues()){const l=r.getZBufferTexture(),c=Math.floor(l.getWidth()),f=Math.floor(l.getHeight()),u=e._openGLRenderWindow.getContext();l.bind();const d=r.getFramebuffer();d?d.saveCurrentBindingsAndBuffers():WTe("No framebuffer to save/restore");const h=u.createFramebuffer();u.bindFramebuffer(u.FRAMEBUFFER,h),u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,l.getHandle(),0),u.checkFramebufferStatus(u.FRAMEBUFFER)===u.FRAMEBUFFER_COMPLETE&&(s=new Uint8Array(c*f*4),u.viewport(0,0,c,f),u.readPixels(0,0,c,f,u.RGBA,u.UNSIGNED_BYTE,s)),d&&d.restorePreviousBindingsAndBuffers(),u.deleteFramebuffer(h)}e.renderable.invokeCallback(e.renderable.getInputData(),a,i,o,s)},t.queryPass=(n,r)=>{n&&e.renderable.getUseZValues()&&r.requestDepth()}}const KTe={};function qTe(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,KTe,n),kr.extend(t,e,n),HTe(t,e)}const vJ=Qn(qTe,"vtkOpenGLPixelSpaceCallbackMapper");var XTe={newInstance:vJ};ha("vtkPixelSpaceCallbackMapper",vJ);const yJ=Object.create(null);function zl(t,e){yJ[t]=e}function YTe(t,e){e.classHierarchy.push("vtkWebGPUViewNodeFactory")}const JTe={};function ZTe(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,JTe,n),e.overrides=yJ,D7.extend(t,e,n),YTe(t,e)}ce.newInstance(ZTe,"vtkWebGPUViewNodeFactory");function QTe(t,e){e.classHierarchy.push("vtkWebGPUCamera"),t.getProjectionMatrix=(n,r,i,a)=>{if(on(n),e.renderable.getParallelProjection()){const o=e.renderable.getParallelScale(),s=o*r,l=o,c=(a[0]-1)*s,f=(a[0]+1)*s,u=(a[1]-1)*l,d=(a[1]+1)*l,h=1/(f-c),p=1/(d-u);n[0]=2*h,n[5]=2*p,n[10]=1/(i[1]-i[0]),n[12]=(f+c)*h,n[13]=(d+u)*p,n[14]=i[1]/(i[1]-i[0])}else{const o=Math.tan(Math.PI*e.renderable.getViewAngle()/360);let s,l;e.renderable.getUseHorizontalViewAngle()===!0?(s=i[0]*o,l=i[0]*o/r):(s=i[0]*o*r,l=i[0]*o);const c=(a[0]-1)*s,f=(a[0]+1)*s,u=(a[1]-1)*l,d=(a[1]+1)*l;n[0]=2*i[0]/(f-c),n[5]=2*i[0]/(d-u),n[12]=(c+f)/(f-c),n[13]=(u+d)/(d-u),n[10]=0,n[14]=i[0],n[11]=-1,n[15]=0}},t.convertToOpenGLDepth=n=>{if(e.renderable.getParallelProjection())return 1-n;const r=e.renderable.getClippingRangeByReference();let i=-r[0]/n;return i=(r[0]+r[1])/(r[1]-r[0])+2*r[0]*r[1]/(i*(r[1]-r[0])),.5*i+.5},t.getKeyMatrices=n=>{const r=n.getRenderable(),i=n.getParent();if(Math.max(i.getMTime(),t.getMTime(),r.getMTime(),e.renderable.getMTime(),n.getStabilizedTime())>e.keyMatrixTime.getMTime()){const a=e.renderable.getViewMatrix();Ri(e.keyMatrices.normalMatrix,a),e.keyMatrices.normalMatrix[3]=0,e.keyMatrices.normalMatrix[7]=0,e.keyMatrices.normalMatrix[11]=0,Ea(e.keyMatrices.normalMatrix,e.keyMatrices.normalMatrix),jn(e.keyMatrices.wcvc,a);const o=n.getStabilizedCenterByReference();di(e.keyMatrices.scvc,e.keyMatrices.wcvc,o);const s=n.getAspectRatio(),l=e.renderable.getClippingRangeByReference();t.getProjectionMatrix(e.keyMatrices.vcpc,s,l,e.renderable.getWindowCenterByReference()),zn(e.keyMatrices.scpc,e.keyMatrices.vcpc,e.keyMatrices.scvc),Ea(e.keyMatrices.pcsc,e.keyMatrices.scpc),e.keyMatrixTime.modified()}return e.keyMatrices}}const eEe={keyMatrixTime:null,keyMatrices:null};function tEe(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,eEe,n),kr.extend(t,e,n),e.keyMatrixTime={},ce.obj(e.keyMatrixTime),e.keyMatrices={normalMatrix:new Float64Array(16),vcpc:new Float64Array(16),pcsc:new Float64Array(16),wcvc:new Float64Array(16),scpc:new Float64Array(16),scvc:new Float64Array(16)},ce.setGet(t,e,["keyMatrixTime"]),QTe(t,e)}const nEe=ce.newInstance(tEe);zl("vtkCamera",nEe);function rEe(t,e){e.classHierarchy.push("vtkWebGPUBindGroup"),t.setBindables=n=>{if(e.bindables.length===n.length){let r=!0;for(let i=0;i<e.bindables.length;i++)e.bindables[i]!==n[i]&&(r=!1);if(r)return}e.bindables=n,t.modified()},t.getBindGroupLayout=n=>{const r=[];for(let i=0;i<e.bindables.length;i++){const a=e.bindables[i].getBindGroupLayoutEntry();a.binding=i,r.push(a)}return n.getBindGroupLayout({entries:r})},t.getBindGroup=n=>{let r=t.getMTime();for(let a=0;a<e.bindables.length;a++){const o=e.bindables[a].getBindGroupTime().getMTime();r=o>r?o:r}if(r<e.bindGroupTime.getMTime())return e.bindGroup;const i=[];for(let a=0;a<e.bindables.length;a++){const o=e.bindables[a].getBindGroupEntry();o.binding=a,i.push(o)}return e.bindGroup=n.getHandle().createBindGroup({layout:t.getBindGroupLayout(n),entries:i,label:e.label}),e.bindGroupTime.modified(),e.bindGroup},t.getShaderCode=n=>{const r=[],i=n.getBindGroupLayoutCount(e.label);for(let a=0;a<e.bindables.length;a++)r.push(e.bindables[a].getShaderCode(a,i));return r.join(`
`)}}const iEe={device:null,handle:null,label:null};function xJ(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,iEe,n),ce.obj(t,e),e.bindables=[],e.bindGroupTime={},ce.obj(e.bindGroupTime,{mtime:0}),ce.get(t,e,["bindGroupTime","handle","sizeInBytes","usage"]),ce.setGet(t,e,["label","device","arrayInformation"]),rEe(t,e)}const aEe=ce.newInstance(xJ);var bJ={newInstance:aEe,extend:xJ};function oEe(t,e){e.classHierarchy.push("vtkWebGPUShaderModule"),t.initialize=(n,r)=>{e.device=n,e.handle=e.device.getHandle().createShaderModule({code:r.getCode()})}}const sEe={device:null,handle:null};function wJ(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,sEe,n),ce.obj(t,e),ce.get(t,e,["lastCameraMTime"]),ce.setGet(t,e,["device","handle"]),oEe(t,e)}const lEe=ce.newInstance(wJ,"vtkWebGPUShaderModule");var cEe={newInstance:lEe,extend:wJ};function uEe(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0;const i=Array.isArray(n)?n.join(`
`):n;let a=!1;t.search(e)!==-1&&(a=!0);let o="";r&&(o="g");const s=new RegExp(e,o),l=t.replace(s,i);return{replace:a,result:l}}function fEe(t,e){e.classHierarchy.push("vtkWebGPUShaderCache"),t.getShaderModule=n=>{const r=n.getType(),i=n.getHash(),a=e._shaderModules.keys();for(let s=0;s<a.length;s++){const l=a[s];if(l.getHash()===i&&l.getType()===r)return e._shaderModules.get(l)}const o=cEe.newInstance();return o.initialize(e.device,n),e._shaderModules.set(n,o),o}}const dEe={shaderModules:null,device:null,window:null};function CJ(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,dEe,n),e._shaderModules=new Map,ce.obj(t,e),ce.setGet(t,e,["device","window"]),fEe(t,e)}const hEe=ce.newInstance(CJ,"vtkWebGPUShaderCache");var Rr={newInstance:hEe,extend:CJ,substitute:uEe};function pEe(t,e){e.classHierarchy.push("vtkWebGPUPipeline"),t.getShaderDescriptions=()=>e.shaderDescriptions,t.initialize=(n,r)=>{e.pipelineDescription=e.renderEncoder.getPipelineSettings(),e.pipelineDescription.primitive.topology=e.topology,e.pipelineDescription.vertex=e.vertexState,e.pipelineDescription.label=r;const i=[];for(let a=0;a<e.layouts.length;a++)i.push(e.layouts[a].layout);e.pipelineLayout=n.getHandle().createPipelineLayout({bindGroupLayouts:i}),e.pipelineDescription.layout=e.pipelineLayout;for(let a=0;a<e.shaderDescriptions.length;a++){const o=e.shaderDescriptions[a],s=n.getShaderModule(o);o.getType()==="vertex"&&(e.pipelineDescription.vertex.module=s.getHandle(),e.pipelineDescription.vertex.entryPoint="main"),o.getType()==="fragment"&&(e.pipelineDescription.fragment.module=s.getHandle(),e.pipelineDescription.fragment.entryPoint="main")}e.handle=n.getHandle().createRenderPipeline(e.pipelineDescription)},t.getShaderDescription=n=>{for(let r=0;r<e.shaderDescriptions.length;r++)if(e.shaderDescriptions[r].getType()===n)return e.shaderDescriptions[r];return null},t.addBindGroupLayout=n=>{n&&e.layouts.push({layout:n.getBindGroupLayout(e.device),label:n.getLabel()})},t.getBindGroupLayout=n=>e.layouts[n].layout,t.getBindGroupLayoutCount=n=>{for(let r=0;r<e.layouts.length;r++)if(e.layouts[r].label===n)return r;return 0},t.bindVertexInput=(n,r)=>{r.bindBuffers(n)}}const gEe={handle:null,layouts:null,renderEncoder:null,shaderDescriptions:null,vertexState:null,topology:null,pipelineDescription:null};function SJ(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,gEe,n),Wr(t,e),e.layouts=[],e.shaderDescriptions=[],Fo(t,e,["handle","pipelineDescription"]),Ni(t,e,["device","renderEncoder","topology","vertexState"]),pEe(t,e)}const mEe=Qn(SJ,"vtkWebGPUPipeline");var vEe={newInstance:mEe,extend:SJ};function yEe(t,e){e.classHierarchy.push("vtkWebGPUShaderDescription"),t.hasOutput=n=>e.outputNames.includes(n),t.addOutput=function(n,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0;e.outputTypes.push(n),e.outputNames.push(r),e.outputInterpolations.push(i)},t.addBuiltinOutput=(n,r)=>{e.builtinOutputTypes.push(n),e.builtinOutputNames.push(r)},t.addBuiltinInput=(n,r)=>{e.builtinInputTypes.push(n),e.builtinInputNames.push(r)},t.replaceShaderCode=(n,r)=>{const i=[];let a=[];if(r&&i.push(r.getShaderCode()),n||e.builtinInputNames.length){const o=[];if(o.push(`struct ${e.type}Input
{`),n){const s=n.getOutputNamesByReference(),l=n.getOutputTypesByReference(),c=n.getOutputInterpolationsByReference();for(let f=0;f<s.length;f++)c[f]!==void 0?o.push(`  @location(${f}) @interpolate(${c[f]}) ${s[f]} : ${l[f]},`):o.push(`  @location(${f}) ${s[f]} : ${l[f]},`)}for(let s=0;s<e.builtinInputNames.length;s++)o.push(`  ${e.builtinInputNames[s]} : ${e.builtinInputTypes[s]},`);o.length>1&&(o.push("};"),a=o,i[i.length-1]+=",",i.push(`input: ${e.type}Input`))}if(i.length&&(e.code=Rr.substitute(e.code,"//VTK::IOStructs::Input",i).result),e.outputNames.length+e.builtinOutputNames.length){const o=[`struct ${e.type}Output
{`];for(let s=0;s<e.outputNames.length;s++)e.outputInterpolations[s]!==void 0?o.push(`  @location(${s}) @interpolate(${e.outputInterpolations[s]}) ${e.outputNames[s]} : ${e.outputTypes[s]},`):o.push(`  @location(${s}) ${e.outputNames[s]} : ${e.outputTypes[s]},`);for(let s=0;s<e.builtinOutputNames.length;s++)o.push(`  ${e.builtinOutputNames[s]} : ${e.builtinOutputTypes[s]},`);o.push("};"),a=a.concat(o),e.code=Rr.substitute(e.code,"//VTK::IOStructs::Output",[`-> ${e.type}Output`]).result}e.code=Rr.substitute(e.code,"//VTK::IOStructs::Dec",a).result}}const xEe={type:null,hash:null,code:null,outputNames:null,outputTypes:null};function TJ(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,xEe,n),e.outputNames=[],e.outputTypes=[],e.outputInterpolations=[],e.builtinOutputNames=[],e.builtinOutputTypes=[],e.builtinInputNames=[],e.builtinInputTypes=[],ce.obj(t,e),ce.setGet(t,e,["type","hash","code"]),ce.getArray(t,e,["outputTypes","outputNames","outputInterpolations"]),yEe(t,e)}const bEe=ce.newInstance(TJ,"vtkWebGPUShaderDescription");var yV={newInstance:bEe,extend:TJ};const xV={r8unorm:{numComponents:1,nativeType:Uint8Array,stride:1,elementSize:1,sampleType:"float"},r8snorm:{numComponents:1,nativeType:Int8Array,stride:1,elementSize:1,sampleType:"float"},r8uint:{numComponents:1,nativeType:Uint8Array,stride:1,elementSize:1,sampleType:"uint"},r8sint:{numComponents:1,nativeType:Int8Array,stride:1,elementSize:1,sampleType:"sint"},r16uint:{numComponents:1,nativeType:Uint16Array,stride:2,elementSize:2,sampleType:"uint"},r16sint:{numComponents:1,nativeType:Int16Array,stride:2,elementSize:2,sampleType:"sint"},r16float:{numComponents:1,nativeType:Float32Array,stride:2,elementSize:2,sampleType:"float"},rg8unorm:{numComponents:2,nativeType:Uint8Array,stride:2,elementSize:1,sampleType:"float"},rg8snorm:{numComponents:2,nativeType:Int8Array,stride:2,elementSize:1,sampleType:"float"},rg8uint:{numComponents:2,nativeType:Uint8Array,stride:2,elementSize:1,sampleType:"uint"},rg8sint:{numComponents:2,nativeType:Int8Array,stride:2,elementSize:1,sampleType:"sint"},r32uint:{numComponents:1,nativeType:Uint32Array,stride:4,elementSize:4,sampleType:"uint"},r32sint:{numComponents:1,nativeType:Int32Array,stride:4,elementSize:4,sampleType:"sint"},r32float:{numComponents:1,nativeType:Float32Array,stride:4,elementSize:4,sampleType:"unfilterable-float"},rg16uint:{numComponents:2,nativeType:Uint16Array,stride:4,elementSize:2,sampleType:"uint"},rg16sint:{numComponents:2,nativeType:Int16Array,stride:4,elementSize:2,sampleType:"sint"},rg16float:{numComponents:2,nativeType:Float32Array,stride:4,elementSize:2,sampleType:"float"},rgba8unorm:{numComponents:4,nativeType:Uint8Array,stride:4,elementSize:1,sampleType:"float"},"rgba8unorm-srgb":{numComponents:4,nativeType:Uint8Array,stride:4,elementSize:1,sampleType:"float"},rgba8snorm:{numComponents:4,nativeType:Int8Array,stride:4,elementSize:1,sampleType:"float"},rgba8uint:{numComponents:4,nativeType:Uint8Array,stride:4,elementSize:1,sampleType:"uint"},rgba8sint:{numComponents:4,nativeType:Int8Array,stride:4,elementSize:1,sampleType:"sint"},bgra8unorm:{numComponents:4,nativeType:Uint8Array,stride:4,elementSize:1,sampleType:"float"},"bgra8unorm-srgb":{numComponents:4,nativeType:Uint8Array,stride:4,elementSize:1,sampleType:"float"},rgb9e5ufloat:{numComponents:4,nativeType:Uint32Array,stride:4,sampleType:"float"},rgb10a2unorm:{numComponents:4,nativeType:Uint32Array,stride:4,sampleType:"float"},rg11b10ufloat:{numComponents:4,nativeType:Float32Array,stride:4,sampleType:"float"},rg32uint:{numComponents:2,nativeType:Uint32Array,stride:8,elementSize:4,sampleType:"uint"},rg32sint:{numComponents:2,nativeType:Int32Array,stride:8,elementSize:4,sampleType:"sint"},rg32float:{numComponents:2,nativeType:Float32Array,stride:8,elementSize:4,sampleType:"unfilterable-float"},rgba16uint:{numComponents:4,nativeType:Uint16Array,stride:8,elementSize:2,sampleType:"uint"},rgba16sint:{numComponents:4,nativeType:Int16Array,stride:8,elementSize:2,sampleType:"sint"},rgba16float:{numComponents:4,nativeType:Float32Array,stride:8,elementSize:2,sampleType:"float"},rgba32uint:{numComponents:4,nativeType:Uint32Array,stride:16,elementSize:4,sampleType:"uint"},rgba32sint:{numComponents:4,nativeType:Int32Array,stride:16,elementSize:4,sampleType:"sint"},rgba32float:{numComponents:4,nativeType:Float32Array,stride:16,elementSize:4,sampleType:"unfilterable-float"},stencil8:{numComponents:1,nativeType:Uint8Array,stride:1,elementSize:1,sampleType:"uint"},depth16unorm:{numComponents:1,nativeType:Uint16Array,stride:2,elementSize:2,sampleType:"depth"},depth24plus:{numComponents:1,nativeType:Uint32Array,stride:4,elementSize:3,sampleType:"depth"},"depth24plus-stencil8":{numComponents:2,nativeType:Uint32Array,stride:4,sampleType:"mixed"},depth32float:{numComponents:1,nativeType:Float32Array,stride:4,elementSize:4,sampleType:"depth"}};function wEe(t){return!t||t.length<6?0:t in xV?xV[t]:($n(`unknown format ${t}`),null)}function CEe(t){if(!t||t.length<5)return 0;let e=1;t[t.length-2]==="x"&&(e=Number(t[t.length-1]));const n=e===1?t.length-1:t.length-3,r=Number(t[n]);if(Number.isNaN(r))return $n(`unknown format ${t}`),0;const i=5-r/2;return e*i}function SEe(t){if(!t||t.length<5)return 0;let e=1;return t[t.length-2]==="x"&&(e=Number(t[t.length-1])),e}function TEe(t){if(!t||t.length<5)return 0;let e;if(t[0]==="f")e="Float";else if(t[0]==="s")e="Int";else if(t[0]==="u")e="Uint";else{$n(`unknown format ${t}`);return}const n=t.split("x")[0],r=Number(n[n.length-1]);if(Number.isNaN(r)){$n(`unknown format ${t}`);return}return e+=8*(5-r/2),e+="Array",e}function EEe(t){let e;if(t[0]==="f"||t[1]==="n")e="f32";else if(t[0]==="s"&&t[1]==="i")e="i32";else if(t[0]==="u"&&t[1]==="i")e="u32";else{$n(`unknown format ${t}`);return}let n=1;return t[t.length-2]==="x"&&(n=Number(t[t.length-1])),n===4?`vec4<${e}>`:n===3?`vec3<${e}>`:n===2?`vec2<${e}>`:e}function _Ee(t){if(!t)return 0;let e=1;return t.substring(0,3)==="vec"?e=Number(t[3]):t.substring(0,3)==="mat"&&(e=t[3]*t[5]),e*4}function DEe(t){if(t){if(t.includes("f32"))return"Float32Array";if(t.includes("i32"))return"Int32Array";if(t.includes("u32"))return"Uint32Array";$n(`unknown format ${t}`)}}var ho={getDetailsFromTextureFormat:wEe,getByteStrideFromBufferFormat:CEe,getNumberOfComponentsFromBufferFormat:SEe,getNativeTypeFromBufferFormat:TEe,getShaderTypeFromBufferFormat:EEe,getByteStrideFromShaderFormat:_Ee,getNativeTypeFromShaderFormat:DEe};function OEe(t,e){if(t===e)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!e.includes(t[n]))return!1;return!0}function MEe(t,e){e.classHierarchy.push("vtkWebGPUVertexInput"),t.addBuffer=function(n,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"vertex",a=r;Array.isArray(a)||(a=[a]);for(let o=0;o<e.inputs.length;o++)if(OEe(e.inputs[o].names,a)){if(e.inputs[o].buffer===n)return;e.inputs[o].buffer=n;return}e.inputs.push({buffer:n,stepMode:i,names:a}),e.inputs=e.inputs.sort((o,s)=>o.names[0]<s.names[0]?-1:o.names[0]>s.names[0]?1:0)},t.removeBufferIfPresent=n=>{for(let r=0;r<e.inputs.length;r++)e.inputs[r].names.includes(n)&&e.inputs.splice(r,1)},t.getBuffer=n=>{for(let r=0;r<e.inputs.length;r++)if(e.inputs[r].names.includes(n))return e.inputs[r].buffer;return null},t.hasAttribute=n=>{for(let r=0;r<e.inputs.length;r++)if(e.inputs[r].names.includes(n))return!0;return!1},t.getAttributeTime=n=>{for(let r=0;r<e.inputs.length;r++)if(e.inputs[r].names.includes(n))return e.inputs[r].buffer.getSourceTime();return 0},t.getShaderCode=()=>{let n="",r=0;for(let i=0;i<e.inputs.length;i++)for(let a=0;a<e.inputs[i].names.length;a++){const o=e.inputs[i].buffer.getArrayInformation()[a],s=ho.getShaderTypeFromBufferFormat(o.format);r>0&&(n+=`,
`),n=`${n}  @location(${r}) ${e.inputs[i].names[a]} : ${s}`,r++}return n},t.getVertexInputInformation=()=>{const n={};if(e.inputs.length){const r=[];let i=0;for(let a=0;a<e.inputs.length;a++){const o=e.inputs[a].buffer,s={arrayStride:o.getStrideInBytes(),stepMode:e.inputs[a].stepMode,attributes:[]},l=o.getArrayInformation();for(let c=0;c<e.inputs[a].names.length;c++)s.attributes.push({shaderLocation:i,offset:l[c].offset,format:l[c].format}),i++;r.push(s)}n.buffers=r}return n},t.bindBuffers=n=>{for(let r=0;r<e.inputs.length;r++)n.setVertexBuffer(r,e.inputs[r].buffer.getHandle());e.indexBuffer&&n.setIndexBuffer(e.indexBuffer.getHandle(),e.indexBuffer.getArrayInformation()[0].format)},t.getReady=()=>{},t.releaseGraphicsResources=()=>{e.created&&(e.inputs=[],e.bindingDescriptions=[],e.attributeDescriptions=[])}}const IEe={inputs:null,bindingDescriptions:!1,attributeDescriptions:null,indexBuffer:null};function EJ(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,IEe,n),Wr(t,e),e.bindingDescriptions=[],e.attributeDescriptions=[],e.inputs=[],Ni(t,e,["created","device","handle","indexBuffer"]),MEe(t,e)}const REe=Qn(EJ,"vtkWebGPUVertexInput");var PEe={newInstance:REe,extend:EJ};const AEe=`
//VTK::Renderer::Dec

//VTK::Color::Dec

//VTK::Normal::Dec

//VTK::TCoord::Dec

//VTK::Select::Dec

//VTK::Mapper::Dec

//VTK::IOStructs::Dec

@vertex
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var output : vertexOutput;

  // var vertex: vec4<f32> = vertexBC;

  //VTK::Color::Impl

  //VTK::Normal::Impl

  //VTK::TCoord::Impl

  //VTK::Select::Impl

  //VTK::Position::Impl

  return output;
}
`,NEe=`
//VTK::Renderer::Dec

//VTK::Color::Dec

//VTK::Normal::Dec

//VTK::TCoord::Dec

//VTK::Select::Dec

//VTK::RenderEncoder::Dec

//VTK::Mapper::Dec

//VTK::IOStructs::Dec

@fragment
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var output : fragmentOutput;

  //VTK::Color::Impl

  //VTK::Normal::Impl

  //VTK::Light::Impl

  //VTK::TCoord::Impl

  //VTK::Select::Impl

  // var computedColor:vec4<f32> = vec4<f32>(1.0,0.5,0.5,1.0);

  //VTK::RenderEncoder::Impl
  return output;
}
`;function LEe(t,e){e.classHierarchy.push("vtkWebGPUSimpleMapper"),t.generateShaderDescriptions=(n,r,i)=>{const a=yV.newInstance({type:"vertex",hash:n,code:e.vertexShaderTemplate}),o=yV.newInstance({type:"fragment",hash:n,code:e.fragmentShaderTemplate}),s=r.getShaderDescriptions();s.push(a),s.push(o);const l=e.vertexShaderTemplate+e.fragmentShaderTemplate,c=new RegExp("//VTK::[^:]*::","g"),u=l.match(c).filter((d,h,p)=>p.indexOf(d)===h).map(d=>`replaceShader${d.substring(7,d.length-2)}`);for(let d=0;d<u.length;d++){const h=u[d];h!=="replaceShaderIOStructs"&&e.shaderReplacements.has(h)&&e.shaderReplacements.get(h)(n,r,i)}t.replaceShaderIOStructs(n,r,i)},t.replaceShaderIOStructs=(n,r,i)=>{const a=r.getShaderDescription("vertex");a.replaceShaderCode(null,i),r.getShaderDescription("fragment").replaceShaderCode(a)},t.replaceShaderRenderEncoder=(n,r,i)=>{e.renderEncoder.replaceShaderCode(r)},e.shaderReplacements.set("replaceShaderRenderEncoder",t.replaceShaderRenderEncoder),t.replaceShaderRenderer=(n,r,i)=>{if(!e.WebGPURenderer)return;const a=e.WebGPURenderer.getBindGroup().getShaderCode(r),o=r.getShaderDescription("vertex");let s=o.getCode();s=Rr.substitute(s,"//VTK::Renderer::Dec",[a]).result,o.setCode(s);const l=r.getShaderDescription("fragment");s=l.getCode(),s=Rr.substitute(s,"//VTK::Renderer::Dec",[a]).result,l.setCode(s)},e.shaderReplacements.set("replaceShaderRenderer",t.replaceShaderRenderer),t.replaceShaderMapper=(n,r,i)=>{const a=e.bindGroup.getShaderCode(r),o=r.getShaderDescription("vertex");let s=o.getCode();s=Rr.substitute(s,"//VTK::Mapper::Dec",[a]).result,o.setCode(s);const l=r.getShaderDescription("fragment");l.addBuiltinInput("bool","@builtin(front_facing) frontFacing"),s=l.getCode(),s=Rr.substitute(s,"//VTK::Mapper::Dec",[a]).result,l.setCode(s)},e.shaderReplacements.set("replaceShaderMapper",t.replaceShaderMapper),t.replaceShaderPosition=(n,r,i)=>{const a=r.getShaderDescription("vertex");a.addBuiltinOutput("vec4<f32>","@builtin(position) Position");let o=a.getCode();o=Rr.substitute(o,"//VTK::Position::Impl",["    output.Position = rendererUBO.SCPCMatrix*vertexBC;"]).result,a.setCode(o)},e.shaderReplacements.set("replaceShaderPosition",t.replaceShaderPosition),t.replaceShaderTCoord=(n,r,i)=>{r.getShaderDescription("vertex").addOutput("vec2<f32>","tcoordVS")},e.shaderReplacements.set("replaceShaderTCoord",t.replaceShaderTCoord),t.addTextureView=n=>{e.textureViews.includes(n)||e.textureViews.push(n)},t.prepareToDraw=n=>{e.renderEncoder=n,t.updateInput(),t.updateBuffers(),t.updateBindings(),t.updatePipeline()},t.updateInput=()=>{},t.updateBuffers=()=>{},t.updateBindings=()=>{e.bindGroup.setBindables(t.getBindables())},t.computePipelineHash=()=>{},t.registerDrawCallback=n=>{n.registerDrawCallback(e.pipeline,t.draw)},t.prepareAndDraw=n=>{t.prepareToDraw(n),n.setPipeline(e.pipeline),t.draw(n)},t.draw=n=>{const r=n.getBoundPipeline();n.activateBindGroup(e.bindGroup),e.WebGPURenderer&&e.WebGPURenderer.bindUBO(n),r.bindVertexInput(n,e.vertexInput);const i=e.vertexInput.getIndexBuffer();i?n.drawIndexed(i.getIndexCount(),e.numberOfInstances,0,0,0):n.draw(e.numberOfVertices,e.numberOfInstances,0,0)},t.getBindables=()=>{const n=[...e.additionalBindables];e.UBO&&n.push(e.UBO),e.SSBO&&n.push(e.SSBO);for(let r=0;r<e.textureViews.length;r++){n.push(e.textureViews[r]);const i=e.textureViews[r].getSampler();i&&n.push(i)}return n},t.updatePipeline=()=>{t.computePipelineHash(),e.pipeline=e.device.getPipeline(e.pipelineHash),e.pipeline||(e.pipeline=vEe.newInstance(),e.pipeline.setDevice(e.device),e.WebGPURenderer&&e.pipeline.addBindGroupLayout(e.WebGPURenderer.getBindGroup()),e.pipeline.addBindGroupLayout(e.bindGroup),t.generateShaderDescriptions(e.pipelineHash,e.pipeline,e.vertexInput),e.pipeline.setTopology(e.topology),e.pipeline.setRenderEncoder(e.renderEncoder),e.pipeline.setVertexState(e.vertexInput.getVertexInputInformation()),e.device.createPipeline(e.pipelineHash,e.pipeline))}}const kEe={additionalBindables:void 0,bindGroup:null,device:null,fragmentShaderTemplate:null,numberOfInstances:1,numberOfVertices:0,pipelineHash:null,shaderReplacements:null,SSBO:null,textureViews:null,topology:"triangle-list",UBO:null,vertexShaderTemplate:null,WebGPURenderer:null};function _J(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,kEe,n),kr.extend(t,e,n),e.textureViews=[],e.vertexInput=PEe.newInstance(),e.bindGroup=bJ.newInstance({label:"mapperBG"}),e.additionalBindables=[],e.fragmentShaderTemplate=e.fragmentShaderTemplate||NEe,e.vertexShaderTemplate=e.vertexShaderTemplate||AEe,e.shaderReplacements=new Map,ce.get(t,e,["pipeline","vertexInput"]),ce.setGet(t,e,["additionalBindables","device","fragmentShaderTemplate","interpolate","numberOfInstances","numberOfVertices","pipelineHash","shaderReplacements","SSBO","textureViews","topology","UBO","vertexShaderTemplate","WebGPURenderer"]),LEe(t,e)}const VEe=ce.newInstance(_J,"vtkWebGPUSimpleMapper");var DJ={newInstance:VEe,extend:_J};function FEe(t,e){e.classHierarchy.push("vtkWebGPUFullScreenQuad"),t.replaceShaderPosition=(n,r,i)=>{const a=r.getShaderDescription("vertex");a.addBuiltinOutput("vec4<f32>","@builtin(position) Position"),a.addOutput("vec4<f32>","vertexVC");let o=a.getCode();o=Rr.substitute(o,"//VTK::Position::Impl",["output.tcoordVS = vec2<f32>(vertexBC.x * 0.5 + 0.5, 1.0 - vertexBC.y * 0.5 - 0.5);","output.Position = vec4<f32>(vertexBC, 1.0);","output.vertexVC = vec4<f32>(vertexBC, 1);"]).result,a.setCode(o)},e.shaderReplacements.set("replaceShaderPosition",t.replaceShaderPosition),t.updateBuffers=()=>{const n=e.device.getBufferManager().getFullScreenQuadBuffer();e.vertexInput.addBuffer(n,["vertexBC"]),e.numberOfVertices=6}}const UEe={};function OJ(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,UEe,n),DJ.extend(t,e,n),FEe(t,e)}const BEe=ce.newInstance(OJ,"vtkWebGPUFullScreenQuad");var U_={newInstance:BEe,extend:OJ};const $Ee={Verts:0,Lines:1,Triangles:2,Strips:3,LinesFromStrips:4,LinesFromTriangles:5,Points:6,UniformArray:7,PointArray:8,NormalsFromPoints:9,Texture:10,RawVertex:11,Storage:12,Index:13},GEe={Start:0,Points:0,Lines:1,Triangles:2,TriangleStrips:3,TriangleEdges:4,TriangleStripEdges:5,End:6};var ky={BufferUsage:$Ee,PrimitiveTypes:GEe};const WE=["getMappedRange","mapAsync","unmap"];function jEe(t,e,n,r){const i=r.byteLength,a=t.createBuffer({size:i,usage:GPUBufferUsage.COPY_SRC,mappedAtCreation:!0}),o=a.getMappedRange(0,i);new Uint8Array(o).set(new Uint8Array(r)),a.unmap();const s=t.createCommandEncoder();s.copyBufferToBuffer(a,0,e,n,i);const l=s.finish();t.queue.submit([l]),a.destroy()}function zEe(t,e){e.classHierarchy.push("vtkWebGPUBuffer"),t.create=(n,r)=>{e.handle=e.device.getHandle().createBuffer({size:n,usage:r,label:e.label}),e.sizeInBytes=n,e.usage=r},t.write=n=>{jEe(e.device.getHandle(),e.handle,0,n.buffer)},t.createAndWrite=(n,r)=>{e.handle=e.device.getHandle().createBuffer({size:n.byteLength,usage:r,mappedAtCreation:!0,label:e.label}),e.sizeInBytes=n.byteLength,e.usage=r,new Uint8Array(e.handle.getMappedRange()).set(new Uint8Array(n.buffer)),e.handle.unmap()};for(let n=0;n<WE.length;n++)t[WE[n]]=function(){return e.handle[WE[n]](...arguments)}}const WEe={device:null,handle:null,sizeInBytes:0,strideInBytes:0,arrayInformation:null,usage:null,label:null,sourceTime:null};function MJ(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,WEe,n),ce.obj(t,e),ce.get(t,e,["handle","sizeInBytes","usage"]),ce.setGet(t,e,["strideInBytes","device","arrayInformation","label","sourceTime"]),zEe(t,e)}const HEe=ce.newInstance(MJ);var B_={newInstance:HEe,extend:MJ,...ky};const{Representation:Rv,Interpolation:Pv}=qY;function bV(t){return()=>ce.vtkErrorMacro(`vtkProperty::${t} - NOT IMPLEMENTED`)}function KEe(t,e){e.classHierarchy.push("vtkProperty"),t.setColor=(n,r,i)=>{Array.isArray(n)?(e.color[0]!==n[0]||e.color[1]!==n[1]||e.color[2]!==n[2])&&(e.color[0]=n[0],e.color[1]=n[1],e.color[2]=n[2],t.modified()):(e.color[0]!==n||e.color[1]!==r||e.color[2]!==i)&&(e.color[0]=n,e.color[1]=r,e.color[2]=i,t.modified()),t.setDiffuseColor(e.color),t.setAmbientColor(e.color),t.setSpecularColor(e.color)},t.computeCompositeColor=bV("ComputeCompositeColor"),t.getColor=()=>{let n=0;e.ambient+e.diffuse+e.specular>0&&(n=1/(e.ambient+e.diffuse+e.specular));for(let r=0;r<3;r++)e.color[r]=n*(e.ambient*e.ambientColor[r]+e.diffuse*e.diffuseColor[r]+e.specular*e.specularColor[r]);return[].concat(e.color)},t.setSpecularPower=n=>{const r=1/Math.max(1,n);(e.roughness!==r||e.specularPower!==n)&&(e.specularPower=n,e.roughness=r,t.modified())},t.addShaderVariable=bV("AddShaderVariable"),t.setInterpolationToFlat=()=>t.setInterpolation(Pv.FLAT),t.setInterpolationToGouraud=()=>t.setInterpolation(Pv.GOURAUD),t.setInterpolationToPhong=()=>t.setInterpolation(Pv.PHONG),t.getInterpolationAsString=()=>ce.enumToString(Pv,e.interpolation),t.setRepresentationToWireframe=()=>t.setRepresentation(Rv.WIREFRAME),t.setRepresentationToSurface=()=>t.setRepresentation(Rv.SURFACE),t.setRepresentationToPoints=()=>t.setRepresentation(Rv.POINTS),t.getRepresentationAsString=()=>ce.enumToString(Rv,e.representation)}const qEe={color:[1,1,1],ambientColor:[1,1,1],diffuseColor:[1,1,1],specularColor:[1,1,1],edgeColor:[0,0,0],ambient:0,diffuse:1,metallic:0,roughness:.6,normalStrength:1,emission:1,baseIOR:1.45,specular:0,specularPower:1,opacity:1,interpolation:Pv.GOURAUD,representation:Rv.SURFACE,edgeVisibility:!1,backfaceCulling:!1,frontfaceCulling:!1,pointSize:1,lineWidth:1,lighting:!0,shading:!1,materialName:null};function IJ(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,qEe,n),ce.obj(t,e),ce.setGet(t,e,["lighting","interpolation","ambient","diffuse","metallic","roughness","normalStrength","emission","baseIOR","specular","specularPower","opacity","edgeVisibility","lineWidth","pointSize","backfaceCulling","frontfaceCulling","representation","diffuseTexture","metallicTexture","roughnessTexture","normalTexture","ambientOcclusionTexture","emissionTexture"]),ce.setGetArray(t,e,["ambientColor","specularColor","diffuseColor","edgeColor"],3),KEe(t,e)}const XEe=ce.newInstance(IJ,"vtkProperty");var Yh={newInstance:XEe,extend:IJ,...qY};const{Representation:wV}=Yh,{PrimitiveTypes:Id}=ky;class YEe{constructor(){this.keys=new Uint32Array(10),this.values=new Uint32Array(10),this.count=0}clear(){this.count=0}has(e){for(let n=0;n<this.count;n++)if(this.keys[n]===e)return!0}get(e){for(let n=0;n<this.count;n++)if(this.keys[n]===e)return this.values[n]}set(e,n){this.count<9&&(this.keys[this.count]=e,this.values[this.count++]=n)}}function JEe(t){switch(t){case Id.Points:return"points";case Id.Lines:return"lines";case Id.Triangles:case Id.TriangleEdges:return"polys";case Id.TriangleStripEdges:case Id.TriangleStrips:return"strips";default:return""}}function Bx(t,e,n){let r=t.pointIdToFlatId[e];return r<0&&(r=t.flatId,t.pointIdToFlatId[e]=r,t.flatIdToPointId[t.flatId]=e,t.flatIdToCellId[t.flatId]=n,t.flatId++),r}function ZEe(t,e,n){const r=t.length;for(let o=0;o<r;o++){let s=t[o];if(n.cellProvokedMap.has(s)){n.ibo[n.iboId++]=n.cellProvokedMap.get(s);for(let l=o+1;l<o+r;l++){s=t[l%r];const c=Bx(n,s,e);n.ibo[n.iboId++]=c}return}}for(let o=0;o<r;o++){let s=t[o];if(!n.provokedPointIds[s]){let l=Bx(n,s,e);n.provokedPointIds[s]=1,n.cellProvokedMap.set(s,l),n.flatIdToCellId[l]=e,n.ibo[n.iboId++]=l;for(let c=o+1;c<o+r;c++)s=t[c%r],l=Bx(n,s,e),n.ibo[n.iboId++]=l;return}}let i=t[0],a=n.flatId;n.cellProvokedMap.set(i,a),n.flatIdToPointId[n.flatId]=i,n.flatIdToCellId[n.flatId]=e,n.flatId++,n.ibo[n.iboId++]=a;for(let o=1;o<r;o++)i=t[o],a=Bx(n,i,e),n.ibo[n.iboId++]=a}function QEe(t,e,n){const r=t.length;n.iboSize+=r;for(let i=0;i<r;i++){const a=t[i];if(n.cellProvokedMap.has(a))return}for(let i=0;i<r;i++){const a=t[i];if(!n.provokedPointIds[a]){n.provokedPointIds[a]=1,n.cellProvokedMap.set(a,1);return}}n.cellProvokedMap.set(t[0],1),n.extraPoints++}let df;const CV=new Uint32Array(1),Ol=new Uint32Array(2),yd=new Uint32Array(3),HE={anythingToPoints(t,e,n,r,i){for(let a=0;a<t;++a)CV[0]=e[n+a],df(CV,r,i)},linesToWireframe(t,e,n,r,i){for(let a=0;a<t-1;++a)Ol[0]=e[n+a],Ol[1]=e[n+a+1],df(Ol,r,i)},polysToWireframe(t,e,n,r,i){if(t>2)for(let a=0;a<t;++a)Ol[0]=e[n+a],Ol[1]=e[n+(a+1)%t],df(Ol,r,i)},stripsToWireframe(t,e,n,r,i){if(t>2){for(let a=0;a<t-1;++a)Ol[0]=e[n+a],Ol[1]=e[n+a+1],df(Ol,r,i);for(let a=0;a<t-2;a++)Ol[0]=e[n+a],Ol[1]=e[n+a+2],df(Ol,r,i)}},polysToSurface(t,e,n,r,i){for(let a=0;a<t-2;a++)yd[0]=e[n],yd[1]=e[n+a+1],yd[2]=e[n+a+2],df(yd,r,i)},stripsToSurface(t,e,n,r,i){for(let a=0;a<t-2;a++)yd[0]=e[n+a],yd[1]=e[n+a+1+a%2],yd[2]=e[n+a+1+(a+1)%2],df(yd,r,i)}};function e8e(t,e){e.classHierarchy.push("vtkWebGPUIndexBuffer"),t.buildIndexBuffer=n=>{const r=n.cells,i=n.primitiveType,a=n.representation,o=n.cellOffset,s=r.getData(),l=s.length,c=JEe(i),f=n.numberOfPoints,u={provokedPointIds:new Uint8Array(f),extraPoints:0,iboSize:0,flatId:0,iboId:0,cellProvokedMap:new YEe};let d=null;a===wV.POINTS||i===Id.Points?d=HE.anythingToPoints:a===wV.WIREFRAME||i===Id.Lines?d=HE[`${c}ToWireframe`]:d=HE[`${c}ToSurface`],df=QEe;let h=o||0;for(let p=0;p<l;)u.cellProvokedMap.clear(),d(s[p],s,p+1,h,u),p+=s[p]+1,h++;f<=65535?u.flatIdToPointId=new Uint16Array(f+u.extraPoints):u.flatIdToPointId=new Uint32Array(f+u.extraPoints),f+u.extraPoints<36863?u.pointIdToFlatId=new Int16Array(f):u.pointIdToFlatId=new Int32Array(f),f+u.extraPoints<=65535?(u.ibo=new Uint16Array(u.iboSize),n.format="uint16"):(u.ibo=new Uint32Array(u.iboSize),n.format="uint32"),h<=65535?u.flatIdToCellId=new Uint16Array(f+u.extraPoints):u.flatIdToCellId=new Uint32Array(f+u.extraPoints),u.pointIdToFlatId.fill(-1),u.provokedPointIds.fill(0),df=ZEe,h=o||0;for(let p=0;p<l;)u.cellProvokedMap.clear(),d(s[p],s,p+1,h,u),p+=s[p]+1,h++;delete u.provokedPointIds,delete u.pointIdToFlatId,n.nativeArray=u.ibo,e.flatIdToPointId=u.flatIdToPointId,e.flatIdToCellId=u.flatIdToCellId,e.flatSize=u.flatId,e.indexCount=u.iboId}}const t8e={flatIdToPointId:null,flatIdToCellId:null,flatSize:0,indexCount:0};function RJ(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,t8e,n),B_.extend(t,e,n),ce.setGet(t,e,["flatIdToPointId","flatIdToCellId","flatSize","indexCount"]),e8e(t,e)}const n8e=ce.newInstance(RJ);var r8e={newInstance:n8e,extend:RJ,...ky};const{BufferUsage:xd}=ky,{vtkErrorMacro:i8e}=wo,{VtkDataTypes:U0}=tn,a8e={};function o8e(t){let e;switch(t.getDataType()){case U0.UNSIGNED_CHAR:e="uint8";break;case U0.FLOAT:e="float32";break;case U0.UNSIGNED_INT:e="uint32";break;case U0.INT:e="sint32";break;case U0.DOUBLE:e="float32";break;case U0.UNSIGNED_SHORT:e="uint16";break;case U0.SHORT:e="sin16";break;default:e="float32";break}switch(t.getNumberOfComponents()){case 2:e+="x2";break;case 3:e.includes("32")||i8e(`unsupported x3 type for ${e}`),e+="x3";break;case 4:e+="x4";break}return e}function SV(t,e,n,r,i){const a={},o=t.getFlatSize();if(!o)return a;let s=[0,0,0,0];i.shift&&(i.shift.length?s=i.shift:s.fill(i.shift));let l=[1,1,1,1];i.scale&&(i.scale.length?l=i.scale:l.fill(i.scale));const c=Object.prototype.hasOwnProperty.call(i,"packExtra")?i.packExtra:!1;let f,u=0;const d=n+(c?1:0),h=$m(r,o*d);let p=t.getFlatIdToPointId();i.cellData&&(p=t.getFlatIdToCellId()),n===1?f=function(m){h[u++]=l[0]*e[m]+s[0]}:n===2?f=function(m){h[u++]=l[0]*e[m]+s[0],h[u++]=l[1]*e[m+1]+s[1]}:n===3&&!c?f=function(m){h[u++]=l[0]*e[m]+s[0],h[u++]=l[1]*e[m+1]+s[1],h[u++]=l[2]*e[m+2]+s[2]}:n===3&&c?f=function(m){h[u++]=l[0]*e[m]+s[0],h[u++]=l[1]*e[m+1]+s[1],h[u++]=l[2]*e[m+2]+s[2],h[u++]=l[3]*1+s[3]}:n===4&&(f=function(m){h[u++]=l[0]*e[m]+s[0],h[u++]=l[1]*e[m+1]+s[1],h[u++]=l[2]*e[m+2]+s[2],h[u++]=l[3]*e[m+3]+s[3]});for(let g=0;g<o;g++){const m=n*p[g];f(m)}return a.nativeArray=h,a}function s8e(t,e,n,r){const i=[t[r*3]-t[n*3],t[r*3+1]-t[n*3+1],t[r*3+2]-t[n*3+2]],a=[t[e*3]-t[n*3],t[e*3+1]-t[n*3+1],t[e*3+2]-t[n*3+2]],o=[];return yu(i,a,o),Lh(o),o}function l8e(t,e){const n=e.getData(),r=t.getData();if(!r||!n)return null;const i=new Int8Array(t.getNumberOfCells()*4),a=r.length;let o=0;for(let s=0;s<a;){const l=s8e(n,r[s+1],r[s+2],r[s+3]);i[o++]=127*l[0],i[o++]=127*l[1],i[o++]=127*l[2],i[o++]=127,s+=r[s]+1}return i}function c8e(t,e){e.classHierarchy.push("vtkWebGPUBufferManager");function n(r){r.dataArray&&!r.nativeArray&&(r.nativeArray=r.dataArray.getData());let i,a;if(r.usage===xd.Index&&(i=r8e.newInstance({label:r.label}),i.setDevice(e.device),a=GPUBufferUsage.INDEX|GPUBufferUsage.COPY_DST,i.buildIndexBuffer(r),i.createAndWrite(r.nativeArray,a),i.setArrayInformation([{format:r.format}])),i||(i=B_.newInstance({label:r.label}),i.setDevice(e.device)),r.usage===xd.UniformArray&&(a=GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST,i.createAndWrite(r.nativeArray,a)),r.usage===xd.Storage&&(a=GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST,i.createAndWrite(r.nativeArray,a)),r.usage===xd.Texture&&(a=GPUBufferUsage.COPY_SRC,i.createAndWrite(r.nativeArray,a)),r.usage===xd.PointArray){a=GPUBufferUsage.VERTEX;const o=ho.getNativeTypeFromBufferFormat(r.format),s=SV(r.indexBuffer,r.dataArray.getData(),r.dataArray.getNumberOfComponents(),o,{packExtra:r.packExtra,shift:r.shift,scale:r.scale,cellData:r.cellData,cellOffset:r.cellOffset});i.createAndWrite(s.nativeArray,a),i.setStrideInBytes(ho.getByteStrideFromBufferFormat(r.format)),i.setArrayInformation([{offset:0,format:r.format,interpolation:r.cellData?"flat":"perspective"}])}if(r.usage===xd.NormalsFromPoints){a=GPUBufferUsage.VERTEX;const o=ho.getNativeTypeFromBufferFormat(r.format),s=l8e(r.cells,r.dataArray),l=SV(r.indexBuffer,s,4,o,{cellData:!0});i.createAndWrite(l.nativeArray,a),i.setStrideInBytes(ho.getByteStrideFromBufferFormat(r.format)),i.setArrayInformation([{offset:0,format:r.format,interpolation:"flat"}])}return r.usage===xd.RawVertex&&(a=GPUBufferUsage.VERTEX,i.createAndWrite(r.nativeArray,a),i.setStrideInBytes(ho.getByteStrideFromBufferFormat(r.format)),i.setArrayInformation([{offset:0,format:r.format}])),i.setSourceTime(r.time),i}t.hasBuffer=r=>e.device.hasCachedObject(r),t.getBuffer=r=>r.hash?e.device.getCachedObject(r.hash,n,r):n(r),t.getBufferForPointArray=(r,i)=>{const a=o8e(r),o={hash:`${r.getMTime()}I${i.getMTime()}${a}`,usage:xd.PointArray,format:a,dataArray:r,indexBuffer:i};return t.getBuffer(o)},t.getFullScreenQuadBuffer=()=>{if(e.fullScreenQuadBuffer)return e.fullScreenQuadBuffer;e.fullScreenQuadBuffer=B_.newInstance(),e.fullScreenQuadBuffer.setDevice(e.device);const r=new Float32Array([-1,-1,0,1,-1,0,1,1,0,-1,-1,0,1,1,0,-1,1,0]);return e.fullScreenQuadBuffer.createAndWrite(r,GPUBufferUsage.VERTEX),e.fullScreenQuadBuffer.setStrideInBytes(12),e.fullScreenQuadBuffer.setArrayInformation([{offset:0,format:"float32x3"}]),e.fullScreenQuadBuffer}}const u8e={device:null,fullScreenQuadBuffer:null};function f8e(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,u8e,n),Wr(t,e),Ni(t,e,["device"]),c8e(t,e)}Qn(f8e);var Wm={...a8e,...ky};const{BufferUsage:d8e}=Wm,{vtkErrorMacro:Fp}=ce;function h8e(t,e){e.classHierarchy.push("vtkWebGPUStorageBuffer"),t.addEntry=(n,r)=>{if(e._bufferEntryNames.has(n)){Fp(`entry named ${n} already exists`);return}e._bufferEntryNames.set(n,e.bufferEntries.length);const i=ho.getByteStrideFromShaderFormat(r);e.bufferEntries.push({name:n,type:r,sizeInBytes:i,offset:e.sizeInBytes,nativeType:ho.getNativeTypeFromShaderFormat(r)}),e.sizeInBytes+=i},t.send=n=>{if(!e._buffer){const r={nativeArray:e.Float32Array,usage:d8e.Storage,label:e.label};e._buffer=n.getBufferManager().getBuffer(r),e.bindGroupTime.modified(),e._sendTime.modified();return}n.getHandle().queue.writeBuffer(e._buffer.getHandle(),0,e.arrayBuffer,0,e.sizeInBytes*e.numberOfInstances),e._sendTime.modified()},t.createView=n=>{n in e||(e.arrayBuffer||(e.arrayBuffer=new ArrayBuffer(e.sizeInBytes*e.numberOfInstances)),e[n]=ce.newTypedArray(n,e.arrayBuffer))},t.setValue=(n,r,i)=>{const a=e._bufferEntryNames.get(n);if(a===void 0){Fp(`entry named ${n} not found in UBO`);return}const o=e.bufferEntries[a];t.createView(o.nativeType);const s=e[o.nativeType];s[(o.offset+r*e.sizeInBytes)/s.BYTES_PER_ELEMENT]=i},t.setArray=(n,r,i)=>{const a=e._bufferEntryNames.get(n);if(a===void 0){Fp(`entry named ${n} not found in UBO`);return}const o=e.bufferEntries[a];t.createView(o.nativeType);const s=e[o.nativeType],l=(o.offset+r*e.sizeInBytes)/s.BYTES_PER_ELEMENT;for(let c=0;c<i.length;c++)s[l+c]=i[c]},t.setAllInstancesFromArray=(n,r)=>{const i=e._bufferEntryNames.get(n);if(i===void 0){Fp(`entry named ${n} not found in UBO`);return}const a=e.bufferEntries[i];t.createView(a.nativeType);const o=e[a.nativeType],s=r.length/e.numberOfInstances;for(let l=0;l<e.numberOfInstances;l++){const c=(a.offset+l*e.sizeInBytes)/o.BYTES_PER_ELEMENT;for(let f=0;f<s;f++)o[c+f]=r[l*s+f]}},t.setAllInstancesFromArrayColorToFloat=(n,r)=>{const i=e._bufferEntryNames.get(n);if(i===void 0){Fp(`entry named ${n} not found in UBO`);return}const a=e.bufferEntries[i];t.createView(a.nativeType);const o=e[a.nativeType],s=r.length/e.numberOfInstances;for(let l=0;l<e.numberOfInstances;l++){const c=(a.offset+l*e.sizeInBytes)/o.BYTES_PER_ELEMENT;for(let f=0;f<s;f++)o[c+f]=r[l*s+f]/255}},t.setAllInstancesFromArray3x3To4x4=(n,r)=>{const i=e._bufferEntryNames.get(n);if(i===void 0){Fp(`entry named ${n} not found in UBO`);return}const a=e.bufferEntries[i];t.createView(a.nativeType);const o=e[a.nativeType],s=9;for(let l=0;l<e.numberOfInstances;l++){const c=(a.offset+l*e.sizeInBytes)/o.BYTES_PER_ELEMENT;for(let f=0;f<3;f++)for(let u=0;u<3;u++)o[c+f*4+u]=r[l*s+f*3+u]}},t.getSendTime=()=>e._sendTime.getMTime(),t.getShaderCode=(n,r)=>{const i=[`struct ${e.label}StructEntry
{`];for(let a=0;a<e.bufferEntries.length;a++){const o=e.bufferEntries[a];i.push(`  ${o.name}: ${o.type},`)}return i.push(`
};
struct ${e.label}Struct
{
  values: array<${e.label}StructEntry>,
};
@binding(${n}) @group(${r}) var<storage, read> ${e.label}: ${e.label}Struct;
`),i.join(`
`)},t.getBindGroupEntry=()=>({resource:{buffer:e._buffer.getHandle()}}),t.clearData=()=>{e.numberOfInstances=0,e.sizeInBytes=0,e.bufferEntries=[],e._bufferEntryNames=new Map,e._buffer=null,delete e.arrayBuffer,delete e.Float32Array}}const p8e={bufferEntries:null,bufferEntryNames:null,sizeInBytes:0,label:null,numberOfInstances:1};function PJ(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,p8e,n),ce.obj(t,e),e._bufferEntryNames=new Map,e.bufferEntries=[],e._sendTime={},ce.obj(e._sendTime,{mtime:0}),e.bindGroupTime={},ce.obj(e.bindGroupTime,{mtime:0}),e.bindGroupLayoutEntry=e.bindGroupLayoutEntry||{buffer:{type:"read-only-storage"}},ce.get(t,e,["bindGroupTime"]),ce.setGet(t,e,["device","bindGroupLayoutEntry","label","numberOfInstances","sizeInBytes"]),h8e(t,e)}const g8e=ce.newInstance(PJ,"vtkWebGPUStorageBuffer");var m8e={newInstance:g8e,extend:PJ};const{BufferUsage:v8e}=Wm,{vtkErrorMacro:KE}=ce;function y8e(t,e){e.classHierarchy.push("vtkWebGPUUniformBuffer"),t.addEntry=(n,r)=>{if(e._bufferEntryNames.has(n)){KE(`entry named ${n} already exists`);return}e.sortDirty=!0,e._bufferEntryNames.set(n,e.bufferEntries.length),e.bufferEntries.push({name:n,type:r,sizeInBytes:ho.getByteStrideFromShaderFormat(r),offset:-1,nativeType:ho.getNativeTypeFromShaderFormat(r),packed:!1})},t.sortBufferEntries=()=>{if(!e.sortDirty)return;let n=0;const r=[];let i=4;for(let a=0;a<e.bufferEntries.length;a++){const o=e.bufferEntries[a];o.sizeInBytes%16===0&&(i=Math.max(16,i)),o.sizeInBytes%8===0&&(i=Math.max(8,i))}for(let a=0;a<e.bufferEntries.length;a++){const o=e.bufferEntries[a];o.packed===!1&&o.sizeInBytes%16===0&&(o.packed=!0,o.offset=n,r.push(o),n+=o.sizeInBytes)}for(let a=0;a<e.bufferEntries.length;a++){const o=e.bufferEntries[a];if(o.packed===!1&&o.sizeInBytes===12)for(let s=0;s<e.bufferEntries.length;s++){const l=e.bufferEntries[s];if(l.packed===!1&&l.sizeInBytes===4){o.packed=!0,o.offset=n,r.push(o),n+=o.sizeInBytes,l.packed=!0,l.offset=n,r.push(l),n+=l.sizeInBytes;break}}}for(let a=0;a<e.bufferEntries.length;a++){const o=e.bufferEntries[a];if(!o.packed&&o.sizeInBytes%8===0)for(let s=a+1;s<e.bufferEntries.length;s++){const l=e.bufferEntries[s];if(!l.packed&&l.sizeInBytes%8===0){o.packed=!0,o.offset=n,r.push(o),n+=o.sizeInBytes,l.packed=!0,l.offset=n,r.push(l),n+=l.sizeInBytes;break}}}for(let a=0;a<e.bufferEntries.length;a++){const o=e.bufferEntries[a];if(!o.packed&&o.sizeInBytes%8===0){let s=!1;for(let l=0;!s&&l<e.bufferEntries.length;l++){const c=e.bufferEntries[l];if(!c.packed&&c.sizeInBytes===4)for(let f=l+1;f<e.bufferEntries.length;f++){const u=e.bufferEntries[f];if(!u.packed&&u.sizeInBytes===4){o.packed=!0,o.offset=n,r.push(o),n+=o.sizeInBytes,c.packed=!0,c.offset=n,r.push(c),n+=c.sizeInBytes,u.packed=!0,u.offset=n,r.push(u),n+=u.sizeInBytes,s=!0;break}}}}}for(let a=0;a<e.bufferEntries.length;a++){const o=e.bufferEntries[a];!o.packed&&o.sizeInBytes>4&&(o.packed=!0,o.offset=n,r.push(o),n+=o.sizeInBytes)}for(let a=0;a<e.bufferEntries.length;a++){const o=e.bufferEntries[a];o.packed||(o.packed=!0,o.offset=n,r.push(o),n+=o.sizeInBytes)}e.bufferEntries=r,e._bufferEntryNames.clear();for(let a=0;a<e.bufferEntries.length;a++)e._bufferEntryNames.set(e.bufferEntries[a].name,a);e.sizeInBytes=n,e.sizeInBytes=i*Math.ceil(e.sizeInBytes/i),e.sortDirty=!1},t.sendIfNeeded=n=>{if(!e.UBO){const r={nativeArray:e.Float32Array,usage:v8e.UniformArray,label:e.label};e.UBO=n.getBufferManager().getBuffer(r),e.bindGroupTime.modified(),e.sendDirty=!1}e.sendDirty&&(n.getHandle().queue.writeBuffer(e.UBO.getHandle(),0,e.arrayBuffer,0,e.sizeInBytes),e.sendDirty=!1),e.sendTime.modified()},t.createView=n=>{n in e||(e.arrayBuffer||(e.arrayBuffer=new ArrayBuffer(e.sizeInBytes)),e[n]=ce.newTypedArray(n,e.arrayBuffer))},t.setValue=(n,r)=>{t.sortBufferEntries();const i=e._bufferEntryNames.get(n);if(i===void 0){KE(`entry named ${n} not found in UBO`);return}const a=e.bufferEntries[i];t.createView(a.nativeType);const o=e[a.nativeType];a.lastValue!==r&&(o[a.offset/o.BYTES_PER_ELEMENT]=r,e.sendDirty=!0),a.lastValue=r},t.setArray=(n,r)=>{t.sortBufferEntries();const i=e._bufferEntryNames.get(n);if(i===void 0){KE(`entry named ${n} not found in UBO`);return}const a=e.bufferEntries[i];t.createView(a.nativeType);const o=e[a.nativeType];let s=!1;for(let l=0;l<r.length;l++)(!a.lastValue||a.lastValue[l]!==r[l])&&(o[a.offset/o.BYTES_PER_ELEMENT+l]=r[l],s=!0);s&&(e.sendDirty=!0,a.lastValue=[...r])},t.getBindGroupEntry=()=>({resource:{buffer:e.UBO.getHandle()}}),t.getSendTime=()=>e.sendTime.getMTime(),t.getShaderCode=(n,r)=>{t.sortBufferEntries();const i=[`struct ${e.label}Struct
{`];for(let a=0;a<e.bufferEntries.length;a++){const o=e.bufferEntries[a];i.push(`  ${o.name}: ${o.type},`)}return i.push(`};
@binding(${n}) @group(${r}) var<uniform> ${e.label}: ${e.label}Struct;`),i.join(`
`)}}const x8e={bufferEntries:null,bufferEntryNames:null,sizeInBytes:0,label:null,bindGroupLayoutEntry:null,bindGroupEntry:null};function AJ(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,x8e,n),ce.obj(t,e),e._bufferEntryNames=new Map,e.bufferEntries=[],e.bindGroupLayoutEntry=e.bindGroupLayoutEntry||{buffer:{type:"uniform"}},e.sendTime={},ce.obj(e.sendTime,{mtime:0}),e.bindGroupTime={},ce.obj(e.bindGroupTime,{mtime:0}),e.sendDirty=!0,e.sortDirty=!0,ce.get(t,e,["binding","bindGroupTime"]),ce.setGet(t,e,["bindGroupLayoutEntry","device","label","sizeInBytes"]),y8e(t,e)}const b8e=ce.newInstance(AJ,"vtkWebGPUUniformBuffer");var Kg={newInstance:b8e,extend:AJ};const{vtkDebugMacro:w8e}=wo,TV=`
//VTK::Renderer::Dec

//VTK::Mapper::Dec

//VTK::TCoord::Dec

//VTK::RenderEncoder::Dec

//VTK::IOStructs::Dec

@fragment
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var output: fragmentOutput;

  var computedColor: vec4<f32> = mapperUBO.BackgroundColor;

  //VTK::RenderEncoder::Impl
  return output;
}
`,C8e=`
fn vecToRectCoord(dir: vec3<f32>) -> vec2<f32> {
  var tau: f32 = 6.28318530718;
  var pi: f32 = 3.14159265359;
  var out: vec2<f32> = vec2<f32>(0.0);

  out.x = atan2(dir.z, dir.x) / tau;
  out.x += 0.5;

  var phix: f32 = length(vec2(dir.x, dir.z));
  out.y = atan2(dir.y, phix) / pi + 0.5;

  return out;
}

//VTK::Renderer::Dec

//VTK::Mapper::Dec

//VTK::TCoord::Dec

//VTK::RenderEncoder::Dec

//VTK::IOStructs::Dec

@fragment
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var output: fragmentOutput;

  var tcoord: vec4<f32> = vec4<f32>(input.vertexVC.xy, -1, 1);
  var V: vec4<f32> = normalize(mapperUBO.FSQMatrix * tcoord); // vec2<f32>((input.tcoordVS.x - 0.5) * 2, -(input.tcoordVS.y - 0.5) * 2);
  // textureSampleLevel gets rid of some ugly artifacts
  var background = textureSampleLevel(EnvironmentTexture, EnvironmentTextureSampler, vecToRectCoord(V.xyz), 0.0);
  var computedColor: vec4<f32> = vec4<f32>(background.rgb, 1);

  //VTK::RenderEncoder::Impl
  return output;
}
`,$x=new Float64Array(16),EV=new Float64Array(16);function S8e(t){return t.getPositional()?t.getConeAngle()>=90?0:2:1}function T8e(t,e){e.classHierarchy.push("vtkWebGPURenderer"),t.buildPass=n=>{if(n){if(!e.renderable)return;e.camera=e.renderable.getActiveCamera(),t.updateLights(),t.prepareNodes(),t.addMissingNode(e.camera),t.addMissingNodes(e.renderable.getViewPropsWithNestedProps()),t.removeUnusedNodes(),e.webgpuCamera=t.getViewNodeFor(e.camera),t.updateStabilizedMatrix()}},t.updateStabilizedMatrix=()=>{const n=e.camera.getClippingRange(),r=e.camera.getPositionByReference(),i=e.camera.getDirectionOfProjectionByReference(),a=[],o=[];ff(o,i,.5*(n[0]+n[1])),Mv(a,r,o),R_(o,a,e.stabilizedCenter),VX(o)/(n[1]-n[0])>e.recenterThreshold&&(e.stabilizedCenter=a,e.stabilizedTime.modified())},t.updateLights=()=>{let n=0;const r=e.renderable.getLightsByReference();for(let i=0;i<r.length;++i)r[i].getSwitch()>0&&n++;return n||(w8e("No lights are on, creating one."),e.renderable.createLight()),n},t.updateUBO=()=>{const n=e.UBO.getSendTime();if(e._parent.getMTime()>n||t.getMTime()>n||e.camera.getMTime()>n||e.renderable.getMTime()>n){const r=e.webgpuCamera.getKeyMatrices(t);e.UBO.setArray("WCVCMatrix",r.wcvc),e.UBO.setArray("SCPCMatrix",r.scpc),e.UBO.setArray("PCSCMatrix",r.pcsc),e.UBO.setArray("SCVCMatrix",r.scvc),e.UBO.setArray("VCPCMatrix",r.vcpc),e.UBO.setArray("WCVCNormals",r.normalMatrix),e.UBO.setValue("LightCount",e.renderable.getLights().length),e.UBO.setValue("MaxEnvironmentMipLevel",e.renderable.getEnvironmentTexture()?.getMipLevel()),e.UBO.setValue("BackgroundDiffuseStrength",e.renderable.getEnvironmentTextureDiffuseStrength()),e.UBO.setValue("BackgroundSpecularStrength",e.renderable.getEnvironmentTextureSpecularStrength());const i=t.getYInvertedTiledSizeAndOrigin();e.UBO.setArray("viewportSize",[i.usize,i.vsize]),e.UBO.setValue("cameraParallel",e.camera.getParallelProjection());const a=e._parent.getDevice();e.UBO.sendIfNeeded(a)}},t.updateSSBO=()=>{const n=e.renderable.getLights(),r=e.webgpuCamera.getKeyMatrices(t);let i=`${e.renderable.getMTime()}`;for(let a=0;a<n.length;a++)i+=n[a].getMTime();if(i!==e.lightTimeString){const a=new Float32Array(n.length*4),o=new Float32Array(n.length*4),s=new Float32Array(n.length*4),l=new Float32Array(n.length*4);for(let f=0;f<n.length;f++){const u=f*4,d=n[f].getPosition();Gn(d,d,r.wcvc),a[u]=d[0],a[u+1]=d[1],a[u+2]=d[2],a[u+3]=0,o[u]=-n[f].getDirection()[0],o[u+1]=-n[f].getDirection()[1],o[u+2]=-n[f].getDirection()[2],o[u+3]=0,s[u]=n[f].getColor()[0],s[u+1]=n[f].getColor()[1],s[u+2]=n[f].getColor()[2],s[u+3]=n[f].getIntensity()*5,l[u]=S8e(n[f]),l[u+1]=Math.cos(Di(n[f].getConeAngle())),l[u+2]=Math.cos(Di(n[f].getConeAngle()+n[f].getConeFalloff())),l[u+3]=0}e.SSBO.clearData(),e.SSBO.setNumberOfInstances(n.length),e.SSBO.addEntry("LightPos","vec4<f32>"),e.SSBO.addEntry("LightDir","vec4<f32>"),e.SSBO.addEntry("LightColor","vec4<f32>"),e.SSBO.addEntry("LightData","vec4<f32>"),e.SSBO.setAllInstancesFromArray("LightPos",a),e.SSBO.setAllInstancesFromArray("LightDir",o),e.SSBO.setAllInstancesFromArray("LightColor",s),e.SSBO.setAllInstancesFromArray("LightData",l);const c=e._parent.getDevice();e.SSBO.send(c)}e.lightTimeString=i},t.scissorAndViewport=n=>{const r=t.getYInvertedTiledSizeAndOrigin();n.getHandle().setViewport(r.lowerLeftU,r.lowerLeftV,r.usize,r.vsize,0,1),n.getHandle().setScissorRect(r.lowerLeftU,r.lowerLeftV,r.usize,r.vsize)},t.bindUBO=n=>{n.activateBindGroup(e.bindGroup)},t.opaquePass=n=>{n?(e.renderEncoder.begin(e._parent.getCommandEncoder()),t.updateUBO(),t.updateSSBO()):(t.scissorAndViewport(e.renderEncoder),t.clear(),e.renderEncoder.end())},t.clear=()=>{if(e.renderable.getTransparent()||e.suppressClear)return;const n=e._parent.getDevice();if(!e.clearFSQ){e.clearFSQ=U_.newInstance(),e.clearFSQ.setDevice(n),e.clearFSQ.setPipelineHash("clearfsq"),e.clearFSQ.setFragmentShaderTemplate(TV);const a=Kg.newInstance({label:"mapperUBO"});a.addEntry("FSQMatrix","mat4x4<f32>"),a.addEntry("BackgroundColor","vec4<f32>"),e.clearFSQ.setUBO(a),e.backgroundTex=e.renderable.getEnvironmentTexture()}if(e.clearFSQ.getPipelineHash()!=="clearfsqwithtexture"&&e.renderable.getUseEnvironmentTextureAsBackground()&&e.backgroundTex?.getImageLoaded()){e.clearFSQ.setFragmentShaderTemplate(C8e);const a=Kg.newInstance({label:"mapperUBO"});a.addEntry("FSQMatrix","mat4x4<f32>"),a.addEntry("BackgroundColor","vec4<f32>"),e.clearFSQ.setUBO(a);const o=n.getTextureManager().getTextureForVTKTexture(e.backgroundTex);if(o.getReady()){const s=o.createView("EnvironmentTexture");e.clearFSQ.setTextureViews([s]),e.backgroundTexLoaded=!0;const l=e.backgroundTex.getInterpolate()?"linear":"nearest";s.addSampler(n,{addressModeU:"repeat",addressModeV:"clamp-to-edge",addressModeW:"repeat",minFilter:l,magFilter:l,mipmapFilter:"linear"})}e.clearFSQ.setPipelineHash("clearfsqwithtexture")}else if(e.clearFSQ.getPipelineHash()==="clearfsqwithtexture"&&!e.renderable.getUseEnvironmentTextureAsBackground()){e.clearFSQ=U_.newInstance(),e.clearFSQ.setDevice(n),e.clearFSQ.setPipelineHash("clearfsq"),e.clearFSQ.setFragmentShaderTemplate(TV);const a=Kg.newInstance({label:"mapperUBO"});a.addEntry("FSQMatrix","mat4x4<f32>"),a.addEntry("BackgroundColor","vec4<f32>"),e.clearFSQ.setUBO(a)}const r=e.webgpuCamera.getKeyMatrices(t),i=e.renderable.getBackgroundByReference();e.clearFSQ.getUBO().setArray("BackgroundColor",i),jn(EV,r.normalMatrix),i3($x,r.scvc,r.pcsc),i3($x,EV,$x),e.clearFSQ.getUBO().setArray("FSQMatrix",$x),e.clearFSQ.getUBO().sendIfNeeded(n),e.clearFSQ.prepareAndDraw(e.renderEncoder)},t.translucentPass=n=>{n?e.renderEncoder.begin(e._parent.getCommandEncoder()):(t.scissorAndViewport(e.renderEncoder),e.renderEncoder.end())},t.volumeDepthRangePass=n=>{n?e.renderEncoder.begin(e._parent.getCommandEncoder()):(t.scissorAndViewport(e.renderEncoder),e.renderEncoder.end())},t.getAspectRatio=()=>{const n=e._parent.getSizeByReference(),r=e.renderable.getViewportByReference();return n[0]*(r[2]-r[0])/((r[3]-r[1])*n[1])},t.convertToOpenGLDepth=n=>e.webgpuCamera.convertToOpenGLDepth(n),t.getYInvertedTiledSizeAndOrigin=()=>{const n=t.getTiledSizeAndOrigin(),r=e._parent.getSizeByReference();return n.lowerLeftV=r[1]-n.vsize-n.lowerLeftV,n},t.getTiledSizeAndOrigin=()=>{const n=e.renderable.getViewportByReference(),r=[0,0,1,1],i=n[0]-r[0],a=n[1]-r[1],o=e._parent.normalizedDisplayToDisplay(i,a),s=Math.round(o[0]),l=Math.round(o[1]),c=n[2]-r[0],f=n[3]-r[1],u=e._parent.normalizedDisplayToDisplay(c,f);let d=Math.round(u[0])-s,h=Math.round(u[1])-l;return d<0&&(d=0),h<0&&(h=0),{usize:d,vsize:h,lowerLeftU:s,lowerLeftV:l}},t.getPropFromID=n=>{for(let r=0;r<e.children.length;r++)if((e.children[r].getPropID?e.children[r].getPropID():-1)===n)return e.children[r];return null},t.getStabilizedTime=()=>e.stabilizedTime.getMTime(),t.releaseGraphicsResources=()=>{e.selector!==null&&e.selector.releaseGraphicsResources()}}const E8e={bindGroup:null,selector:null,renderEncoder:null,recenterThreshold:20,suppressClear:!1,stabilizedCenter:[0,0,0]};function _8e(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,E8e,n),kr.extend(t,e,n),e.UBO=Kg.newInstance({label:"rendererUBO"}),e.UBO.addEntry("WCVCMatrix","mat4x4<f32>"),e.UBO.addEntry("SCPCMatrix","mat4x4<f32>"),e.UBO.addEntry("PCSCMatrix","mat4x4<f32>"),e.UBO.addEntry("SCVCMatrix","mat4x4<f32>"),e.UBO.addEntry("VCPCMatrix","mat4x4<f32>"),e.UBO.addEntry("WCVCNormals","mat4x4<f32>"),e.UBO.addEntry("viewportSize","vec2<f32>"),e.UBO.addEntry("LightCount","i32"),e.UBO.addEntry("MaxEnvironmentMipLevel","f32"),e.UBO.addEntry("BackgroundDiffuseStrength","f32"),e.UBO.addEntry("BackgroundSpecularStrength","f32"),e.UBO.addEntry("cameraParallel","u32"),e.SSBO=m8e.newInstance({label:"rendererLightSSBO"}),e.lightTimeString="",e.bindGroup=bJ.newInstance({label:"rendererBG"}),e.bindGroup.setBindables([e.UBO,e.SSBO]),e.tmpMat4=on(new Float64Array(16)),e.stabilizedTime={},Wr(e.stabilizedTime,{mtime:0}),Fo(t,e,["bindGroup","stabilizedTime"]),Gm(t,e,["stabilizedCenter"]),Ni(t,e,["renderEncoder","selector","suppressClear","UBO"]),T8e(t,e)}const D8e=Qn(_8e,"vtkWebGPURenderer");zl("vtkRenderer",D8e);function O8e(t,e){e.classHierarchy.push("vtkWebGPUSampler"),t.create=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e.device=n,e.options.addressModeU=r.addressModeU?r.addressModeU:"clamp-to-edge",e.options.addressModeV=r.addressModeV?r.addressModeV:"clamp-to-edge",e.options.addressModeW=r.addressModeW?r.addressModeW:"clamp-to-edge",e.options.magFilter=r.magFilter?r.magFilter:"nearest",e.options.minFilter=r.minFilter?r.minFilter:"nearest",e.options.mipmapFilter=r.mipmapFilter?r.mipmapFilter:"nearest",e.options.label=e.label,e.handle=e.device.getHandle().createSampler(e.options),e.bindGroupTime.modified()},t.getShaderCode=(n,r)=>`@binding(${n}) @group(${r}) var ${e.label}: sampler;`,t.getBindGroupEntry=()=>({resource:e.handle})}const M8e={device:null,handle:null,label:null,options:null};function NJ(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,M8e,n),ce.obj(t,e),e.options={},e.bindGroupLayoutEntry={visibility:GPUShaderStage.VERTEX|GPUShaderStage.FRAGMENT,sampler:{}},e.bindGroupTime={},ce.obj(e.bindGroupTime,{mtime:0}),ce.get(t,e,["bindGroupTime","handle","options"]),ce.setGet(t,e,["bindGroupLayoutEntry","device","label"]),O8e(t,e)}const I8e=ce.newInstance(NJ);var LJ={newInstance:I8e,extend:NJ};const{SlicingMode:_V}=WC,R8e=`
//VTK::Renderer::Dec

//VTK::Mapper::Dec

//VTK::TCoord::Dec

//VTK::Image::Dec

//VTK::RenderEncoder::Dec

//VTK::IOStructs::Dec

@fragment
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var output: fragmentOutput;

  //VTK::Image::Sample

  // var computedColor: vec4<f32> = vec4<f32>(1.0,0.7, 0.5, 1.0);

//VTK::RenderEncoder::Impl

  return output;
}
`;function P8e(t,e,n){if(e.apply(t)){const i=t.getIndependentComponents();return`${t.getMTime()}-${i}-${n}`}return"0"}const Ks=new Float64Array(16),qc=new Float64Array(16),Gx=new Float64Array(16),af=new Float64Array(4),ya=new Float64Array(4);function A8e(t,e){e.classHierarchy.push("vtkWebGPUImageMapper"),t.buildPass=i=>{if(i){e.WebGPUImageSlice=t.getFirstAncestorOfType("vtkWebGPUImageSlice"),e.WebGPURenderer=e.WebGPUImageSlice.getFirstAncestorOfType("vtkWebGPURenderer"),e.WebGPURenderWindow=e.WebGPURenderer.getParent(),e.device=e.WebGPURenderWindow.getDevice();const a=e.WebGPURenderer.getRenderable();e.renderable.getSliceAtFocalPoint()&&e.renderable.setSliceFromCamera(a.getActiveCamera())}},t.translucentPass=i=>{i&&t.render()},t.opaquePass=i=>{i&&t.render()},t.render=()=>{e.renderable.update(),e.currentInput=e.renderable.getInputData(),t.prepareToDraw(e.WebGPURenderer.getRenderEncoder()),e.renderEncoder.registerDrawCallback(e.pipeline,t.draw)},t.computePipelineHash=()=>{const i=e.currentInput.getExtent();i[0]===i[1]||i[2]===i[3]||i[4]===i[5]?(e.dimensions=2,e.pipelineHash="img2"):(e.dimensions=3,e.pipelineHash="img3")},t.updateUBO=()=>{const i=e.UBO.getSendTime(),a=e.WebGPUImageSlice.getRenderable(),o=a.getMapper();if(t.getMTime()>i||e.renderable.getMTime()>i||a.getProperty().getMTime()>i){const s=o.getInputData(),l=e.WebGPURenderer.getStabilizedCenterByReference();on(Ks),di(Ks,Ks,l);const c=a.getMatrix();jn(qc,c),Ea(qc,qc),zn(Ks,qc,Ks);const f=s.getWorldToIndex();zn(Ks,f,Ks),Ea(Gx,Ks),g7(qc,[.5,.5,.5]),zn(Ks,qc,Ks);const u=s.getDimensions();on(qc),i0(qc,qc,[1/u[0],1/u[1],1/u[2]]),zn(Ks,qc,Ks),e.UBO.setArray("SCTCMatrix",Ks);const d=e.currentInput.getExtent(),{ijkMode:h}=e.renderable.getClosestIJKAxis();let p=e.renderable.getSlice();h!==e.renderable.getSlicingMode()&&(p=e.renderable.getSliceAtPosition(p));let g=2,m=0,y=1;h===_V.I?(g=0,m=1,y=2):h===_V.J&&(g=1,m=2,y=0),af[g]=p,af[m]=d[m*2]-.5,af[y]=d[y*2]-.5,af[3]=1,hh(af,af,Gx),e.UBO.setArray("Origin",af),ya[g]=p,ya[m]=d[m*2+1]+.5,ya[y]=d[y*2]-.5,ya[3]=1,hh(ya,ya,Gx),aV(ya,ya,af),ya[3]=1,e.UBO.setArray("Axis1",ya),ya[g]=p,ya[m]=d[m*2]-.5,ya[y]=d[y*2+1]+.5,ya[3]=1,hh(ya,ya,Gx),aV(ya,ya,af),ya[3]=1,e.UBO.setArray("Axis2",ya);const v=[1,1,1,1],x=[0,0,0,0],w=e.textureViews[0],S=w.getTexture().getScale(),T=w.getTexture().getNumberOfComponents();for(let _=0;_<T;_++){let D=a.getProperty().getColorWindow(),I=a.getProperty().getColorLevel();const O=a.getProperty().getRGBTransferFunction(0);if(O){const P=O.getRange();D=P[1]-P[0],I=.5*(P[1]+P[0])}v[_]=S/D,x[_]=-I/D+.5}e.UBO.setArray("cScale",v),e.UBO.setArray("cShift",x),e.UBO.sendIfNeeded(e.device)}},t.updateLUTImage=()=>{const i=e.WebGPUImageSlice.getRenderable().getProperty();t.getTextureViews()[0].getTexture().getNumberOfComponents();const o=1,s=P8e(i,i.getRGBTransferFunction,o);if(e.colorTextureString!==s){e.numRows=o;const l=new Uint8ClampedArray(e.numRows*2*e.rowLength*4);let c=i.getRGBTransferFunction();if(c){const f=new Float32Array(e.rowLength*3);for(let u=0;u<o;u++){c=i.getRGBTransferFunction(u);const d=c.getRange();c.getTable(d[0],d[1],e.rowLength,f,1);for(let h=0;h<e.rowLength;h++){const p=u*e.rowLength*8+h*4;l[p]=255*f[h*3],l[p+1]=255*f[h*3+1],l[p+2]=255*f[h*3+2],l[p+3]=255;for(let g=0;g<4;g++)l[p+e.rowLength*4+g]=l[p+g]}}}else for(let f=0;f<e.rowLength;++f){const u=255*f/(e.rowLength-1);l[f*4]=u,l[f*4+1]=u,l[f*4+2]=u,l[f*4+3]=255;for(let d=0;d<4;d++)l[f*4+e.rowLength*4+d]=l[f*4+d]}{const f={nativeArray:l,width:e.rowLength,height:e.numRows*2,depth:1,format:"rgba8unorm"},d=e.device.getTextureManager().getTexture(f).createView("tfunTexture");e.textureViews[1]=d}e.colorTextureString=s}};const n=t.updateBuffers;t.updateBuffers=()=>{n();const i=e.device.getTextureManager().getTextureForImageData(e.currentInput),a=e.textureViews;if(!a[0]||a[0].getTexture()!==i){const l=i.createView("imgTexture");a[0]=l}t.updateLUTImage(),t.updateUBO();const s=e.WebGPUImageSlice.getRenderable().getProperty().getInterpolationType()===Sh.NEAREST?"nearest":"linear";(!e.clampSampler||s!==e.clampSampler.getOptions().minFilter)&&(e.clampSampler=LJ.newInstance({label:"clampSampler"}),e.clampSampler.create(e.device,{minFilter:s,magFilter:s}),e.additionalBindables=[e.clampSampler])};const r=t.getShaderReplacements();t.replaceShaderPosition=(i,a,o)=>{const s=a.getShaderDescription("vertex");s.addBuiltinOutput("vec4<f32>","@builtin(position) Position");let l=s.getCode();const c=["var pos: vec4<f32> = mapperUBO.Origin +","   (vertexBC.x * 0.5 + 0.5) * mapperUBO.Axis1 + (vertexBC.y * 0.5 + 0.5) * mapperUBO.Axis2;","pos.w = 1.0;"];e.dimensions===2?c.push("var tcoord : vec2<f32> = (mapperUBO.SCTCMatrix * pos).xy;"):c.push("var tcoord : vec3<f32> = (mapperUBO.SCTCMatrix * pos).xyz;"),c.push("output.tcoordVS = tcoord;","output.Position = rendererUBO.SCPCMatrix * pos;"),l=Rr.substitute(l,"//VTK::Position::Impl",c).result,s.setCode(l)},r.set("replaceShaderPosition",t.replaceShaderPosition),t.replaceShaderTCoord=(i,a,o)=>{const s=a.getShaderDescription("vertex");e.dimensions===2?s.addOutput("vec2<f32>","tcoordVS"):s.addOutput("vec3<f32>","tcoordVS")},r.set("replaceShaderTCoord",t.replaceShaderTCoord),t.replaceShaderImage=(i,a,o)=>{const s=a.getShaderDescription("fragment");let l=s.getCode();e.dimensions===3?l=Rr.substitute(l,"//VTK::Image::Sample",["    var computedColor: vec4<f32> =","      textureSampleLevel(imgTexture, clampSampler, input.tcoordVS, 0.0);","//VTK::Image::Sample"]).result:l=Rr.substitute(l,"//VTK::Image::Sample",["    var computedColor: vec4<f32> =","      textureSampleLevel(imgTexture, clampSampler, input.tcoordVS, 0.0);","//VTK::Image::Sample"]).result,l=Rr.substitute(l,"//VTK::Image::Sample",["    var coord: vec2<f32> =","      vec2<f32>(computedColor.r * mapperUBO.cScale.r + mapperUBO.cShift.r, 0.5);","    computedColor = textureSampleLevel(tfunTexture, clampSampler, coord, 0.0);"]).result,s.setCode(l)},r.set("replaceShaderImage",t.replaceShaderImage)}const N8e={rowLength:1024};function L8e(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,N8e,n),U_.extend(t,e,n),t.setFragmentShaderTemplate(R8e),e.UBO=Kg.newInstance({label:"mapperUBO"}),e.UBO.addEntry("SCTCMatrix","mat4x4<f32>"),e.UBO.addEntry("Origin","vec4<f32>"),e.UBO.addEntry("Axis2","vec4<f32>"),e.UBO.addEntry("Axis1","vec4<f32>"),e.UBO.addEntry("cScale","vec4<f32>"),e.UBO.addEntry("cShift","vec4<f32>"),e.lutBuildTime={},Wr(e.lutBuildTime,{mtime:0}),e.imagemat=on(new Float64Array(16)),e.imagematinv=on(new Float64Array(16)),e.VBOBuildTime={},Wr(e.VBOBuildTime),A8e(t,e)}const k8e=Qn(L8e,"vtkWebGPUImageMapper");zl("vtkImageMapper",k8e);function V8e(t,e){e.classHierarchy.push("vtkWebGPUImageSlice"),t.buildPass=n=>{if(!(!e.renderable||!e.renderable.getVisibility())&&n){if(!e.renderable)return;e.WebGPURenderer=t.getFirstAncestorOfType("vtkWebGPURenderer"),e.WebGPURenderWindow=e.WebGPURenderer.getFirstAncestorOfType("vtkWebGPURenderWindow"),e.propID===void 0&&(e.propID=e.WebGPURenderWindow.getUniquePropID()),t.prepareNodes(),t.addMissingNode(e.renderable.getMapper()),t.removeUnusedNodes()}},t.traverseOpaquePass=n=>{!e.renderable||!e.renderable.getNestedVisibility()||!e.renderable.getIsOpaque()||e.WebGPURenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(n,!0),e.children.forEach(r=>{r.traverse(n)}),t.apply(n,!1))},t.traverseTranslucentPass=n=>{!e.renderable||!e.renderable.getNestedVisibility()||e.renderable.getIsOpaque()||e.WebGPURenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(n,!0),e.children.forEach(r=>{r.traverse(n)}),t.apply(n,!1))},t.queryPass=(n,r)=>{if(n){if(!e.renderable||!e.renderable.getVisibility())return;e.renderable.getIsOpaque()?r.incrementOpaqueActorCount():r.incrementTranslucentActorCount()}},t.getBufferShift=n=>(t.getKeyMatrices(n),e.bufferShift),t.getKeyMatrices=n=>{if(Math.max(e.renderable.getMTime(),n.getStabilizedTime())>e.keyMatricesTime.getMTime()){e.renderable.computeMatrix();const r=e.renderable.getMatrix(),i=n.getStabilizedCenterByReference();e.bufferShift[0]=r[3]-i[0],e.bufferShift[1]=r[7]-i[1],e.bufferShift[2]=r[11]-i[2],jn(e.keyMatrices.bcwc,r),e.renderable.getIsIdentity()?on(e.keyMatrices.normalMatrix):(Ri(e.keyMatrices.normalMatrix,e.keyMatrices.bcwc),e.keyMatrices.normalMatrix[3]=0,e.keyMatrices.normalMatrix[7]=0,e.keyMatrices.normalMatrix[11]=0,Ea(e.keyMatrices.normalMatrix,e.keyMatrices.normalMatrix),jn(e.keyMatrices.normalMatrix,e.keyMatrices.normalMatrix)),di(e.keyMatrices.bcwc,e.keyMatrices.bcwc,[-e.bufferShift[0],-e.bufferShift[1],-e.bufferShift[2]]),di(e.keyMatrices.bcsc,e.keyMatrices.bcwc,[-i[0],-i[1],-i[2]]),e.keyMatricesTime.modified()}return e.keyMatrices}}const F8e={bufferShift:void 0,keyMatrixTime:null,keyMatrices:null,propID:void 0};function U8e(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,F8e,n),kr.extend(t,e,n),e.keyMatricesTime={},Wr(e.keyMatricesTime,{mtime:0}),e.keyMatrices={normalMatrix:new Float64Array(16),bcwc:new Float64Array(16),bcsc:new Float64Array(16)},e.keyMatrixTime={},Wr(e.keyMatrixTime,{mtime:0}),e.keyMatrices={mcwc:on(new Float64Array(16))},e.bufferShift=[0,0,0,0],Fo(t,e,["propID","keyMatricesTime"]),V8e(t,e)}const B8e=Qn(U8e,"vtkWebGPUImageSlice");zl("vtkImageSlice",B8e);function $8e(t,e){e.classHierarchy.push("vtkWebGPUVolume"),t.buildPass=i=>{!e.renderable||!e.renderable.getVisibility()||i&&(e.WebGPURenderer=t.getFirstAncestorOfType("vtkWebGPURenderer"),e.WebGPURenderWindow=e.WebGPURenderer.getFirstAncestorOfType("vtkWebGPURenderWindow"),e.propID===void 0&&(e.propID=e.WebGPURenderWindow.getUniquePropID()),e.renderable.getMapper().update())},t.queryPass=(i,a)=>{if(i){if(!e.renderable||!e.renderable.getVisibility())return;const o=e.renderable.getMapper().getBounds();if(!o||o.length!==6||o[0]>o[1])return;a.addVolume(t)}};const n=new Float64Array(3),r=new Float64Array(3);t.getBoundingCubePoints=(i,a)=>{const o=e.renderable.getMapper().getInputData();if(!o)return;const s=o.getExtent(),l=e.renderable.getMatrix();let c=0;for(let f=4;f<6;f++){n[2]=s[f];for(let u=2;u<4;u++){n[1]=s[u];for(let d=0;d<2;d++){n[0]=s[d],o.indexToWorld(n,r);let h=a+c*3;i[h++]=l[0]*r[0]+l[1]*r[1]+l[2]*r[2]+l[3],i[h++]=l[4]*r[0]+l[5]*r[1]+l[6]*r[2]+l[7],i[h++]=l[8]*r[0]+l[9]*r[1]+l[10]*r[2]+l[11],c++}}}},t.getKeyMatrices=i=>{if(Math.max(e.renderable.getMTime(),i.getStabilizedTime())>e.keyMatricesTime.getMTime()){e.renderable.computeMatrix();const a=e.renderable.getMatrix(),o=i.getStabilizedCenterByReference();jn(e.keyMatrices.bcwc,a),di(e.keyMatrices.bcsc,e.keyMatrices.bcwc,[-o[0],-o[1],-o[2]]),e.keyMatricesTime.modified()}return e.keyMatrices}}const G8e={propID:void 0,keyMatricesTime:null};function j8e(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,G8e,n),kr.extend(t,e,n),e.keyMatricesTime={},ce.obj(e.keyMatricesTime,{mtime:0}),e.keyMatrices={bcwc:new Float64Array(16),bcsc:new Float64Array(16)},ce.get(t,e,["propID","keyMatricesTime"]),$8e(t,e)}const z8e=ce.newInstance(j8e,"vtkWebGPUVolume");zl("vtkVolume",z8e);function W8e(t,e){e.classHierarchy.push("vtkWebGPUPixelSpaceCallbackMapper"),t.opaquePass=(n,r)=>{e.WebGPURenderer=t.getFirstAncestorOfType("vtkWebGPURenderer"),e.WebGPURenderWindow=e.WebGPURenderer.getParent();const i=e.WebGPURenderer.getAspectRatio(),a=e.WebGPURenderer?e.WebGPURenderer.getRenderable().getActiveCamera():null,o=e.WebGPURenderer.getTiledSizeAndOrigin(),s=null;e.renderable.getUseZValues(),e.renderable.invokeCallback(e.renderable.getInputData(),a,i,o,s)}}const H8e={};function K8e(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,H8e,n),kr.extend(t,e,n),W8e(t,e)}const q8e=ce.newInstance(K8e,"vtkWebGPUPixelSpaceCallbackMapper");zl("vtkPixelSpaceCallbackMapper",q8e);const cc={UNCHANGED:0,SINGLE_POINT:1,X_LINE:2,Y_LINE:3,Z_LINE:4,XY_PLANE:5,YZ_PLANE:6,XZ_PLANE:7,XYZ_GRID:8,EMPTY:9};var kJ={StructuredType:cc};const{StructuredType:of}=kJ;function X8e(t){let e=0;for(let n=0;n<3;++n)t[n*2]<t[n*2+1]&&e++;return t[0]>t[1]||t[2]>t[3]||t[4]>t[5]?of.EMPTY:e===3?of.XYZ_GRID:e===2?t[0]===t[1]?of.YZ_PLANE:t[2]===t[3]?of.XZ_PLANE:of.XY_PLANE:e===1?t[0]<t[1]?of.X_LINE:t[2]<t[3]?of.Y_LINE:of.Z_LINE:of.SINGLE_POINT}var Y8e={getDataDescriptionFromExtent:X8e,...kJ};const{vtkErrorMacro:B0}=ce;function J8e(t,e){e.classHierarchy.push("vtkImageData"),t.setExtent=function(){if(e.deleted)return B0("instance deleted - cannot call any method"),!1;for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];const a=r.length===1?r[0]:r;if(a.length!==6)return!1;const o=e.extent.some((s,l)=>s!==a[l]);return o&&(e.extent=a.slice(),e.dataDescription=Y8e.getDataDescriptionFromExtent(e.extent),t.modified()),o},t.setDimensions=function(){let n,r,i;if(e.deleted){B0("instance deleted - cannot call any method");return}if(arguments.length===1){const a=arguments.length<=0?void 0:arguments[0];n=a[0],r=a[1],i=a[2]}else if(arguments.length===3)n=arguments.length<=0?void 0:arguments[0],r=arguments.length<=1?void 0:arguments[1],i=arguments.length<=2?void 0:arguments[2];else{B0("Bad dimension specification");return}t.setExtent(0,n-1,0,r-1,0,i-1)},t.getDimensions=()=>[e.extent[1]-e.extent[0]+1,e.extent[3]-e.extent[2]+1,e.extent[5]-e.extent[4]+1],t.getNumberOfCells=()=>{const n=t.getDimensions();let r=1;for(let i=0;i<3;i++){if(n[i]===0)return 0;n[i]>1&&(r*=n[i]-1)}return r},t.getNumberOfPoints=()=>{const n=t.getDimensions();return n[0]*n[1]*n[2]},t.getPoint=n=>{const r=t.getDimensions();if(r[0]===0||r[1]===0||r[2]===0)return B0("Requesting a point from an empty image."),null;const i=new Float64Array(3);switch(e.dataDescription){case cc.EMPTY:return null;case cc.SINGLE_POINT:break;case cc.X_LINE:i[0]=n;break;case cc.Y_LINE:i[1]=n;break;case cc.Z_LINE:i[2]=n;break;case cc.XY_PLANE:i[0]=n%r[0],i[1]=n/r[0];break;case cc.YZ_PLANE:i[1]=n%r[1],i[2]=n/r[1];break;case cc.XZ_PLANE:i[0]=n%r[0],i[2]=n/r[0];break;case cc.XYZ_GRID:i[0]=n%r[0],i[1]=n/r[0]%r[1],i[2]=n/(r[0]*r[1]);break;default:B0("Invalid dataDescription");break}const a=[0,0,0];return t.indexToWorld(i,a),a},t.getBounds=()=>t.extentToBounds(t.getSpatialExtent()),t.extentToBounds=n=>Er.transformBounds(n,e.indexToWorld),t.getSpatialExtent=()=>Er.inflate([...e.extent],.5),t.computeTransforms=()=>{g7(e.indexToWorld,e.origin),e.indexToWorld[0]=e.direction[0],e.indexToWorld[1]=e.direction[1],e.indexToWorld[2]=e.direction[2],e.indexToWorld[4]=e.direction[3],e.indexToWorld[5]=e.direction[4],e.indexToWorld[6]=e.direction[5],e.indexToWorld[8]=e.direction[6],e.indexToWorld[9]=e.direction[7],e.indexToWorld[10]=e.direction[8],i0(e.indexToWorld,e.indexToWorld,e.spacing),Ea(e.worldToIndex,e.indexToWorld)},t.indexToWorld=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return Gn(r,n,e.indexToWorld),r},t.indexToWorldVec3=t.indexToWorld,t.worldToIndex=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return Gn(r,n,e.worldToIndex),r},t.worldToIndexVec3=t.worldToIndex,t.indexToWorldBounds=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return Er.transformBounds(n,e.indexToWorld,r)},t.worldToIndexBounds=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return Er.transformBounds(n,e.worldToIndex,r)},t.onModified(t.computeTransforms),t.computeTransforms(),t.getCenter=()=>Er.getCenter(t.getBounds()),t.computeHistogram=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const i=[0,0,0,0,0,0];t.worldToIndexBounds(n,i);const a=[0,0,0],o=[0,0,0];Er.computeCornerPoints(i,a,o),x_(a,a),x_(o,o);const s=t.getDimensions();w_(a,[0,0,0],[s[0]-1,s[1]-1,s[2]-1],a),w_(o,[0,0,0],[s[0]-1,s[1]-1,s[2]-1],o);const l=s[0],c=s[0]*s[1],f=t.getPointData().getScalars().getData();let u=-1/0,d=1/0,h=0,p=0,g=0;for(let x=a[2];x<=o[2];x++)for(let w=a[1];w<=o[1];w++){let S=a[0]+w*l+x*c;for(let T=a[0];T<=o[0];T++){if(!r||r([T,w,x],i)){const _=f[S];_>u&&(u=_),_<d&&(d=_),h+=_*_,p+=_,g+=1}++S}}const m=g>0?p/g:0,y=g?Math.abs(h/g-m*m):0,v=Math.sqrt(y);return{minimum:d,maximum:u,average:m,variance:y,sigma:v,count:g}},t.computeIncrements=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const i=[];let a=r;for(let o=0;o<3;++o)i[o]=a,a*=n[o*2+1]-n[o*2]+1;return i},t.computeOffsetIndex=n=>{let[r,i,a]=n;const o=t.getExtent(),s=t.getPointData().getScalars().getNumberOfComponents(),l=t.computeIncrements(o,s);return Math.floor((Math.round(r)-o[0])*l[0]+(Math.round(i)-o[2])*l[1]+(Math.round(a)-o[4])*l[2])},t.getOffsetIndexFromWorld=n=>{const r=t.getExtent(),i=t.worldToIndex(n);for(let a=0;a<3;++a)if(i[a]<r[a*2]||i[a]>r[a*2+1])return B0(`GetScalarPointer: Pixel ${i} is not in memory. Current extent = ${r}`),NaN;return t.computeOffsetIndex(i)},t.getScalarValueFromWorld=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const i=t.getPointData().getScalars().getNumberOfComponents();if(r<0||r>=i)return B0(`GetScalarPointer: Scalar Component ${r} is not within bounds. Current Scalar numberOfComponents: ${i}`),NaN;const a=t.getOffsetIndexFromWorld(n);return Number.isNaN(a)?a:t.getPointData().getScalars().getComponent(a,r)}}const Z8e={direction:null,indexToWorld:null,worldToIndex:null,spacing:[1,1,1],origin:[0,0,0],extent:[0,-1,0,-1,0,-1],dataDescription:cc.EMPTY};function VJ(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Z8e,n),zm.extend(t,e,n),e.direction?Array.isArray(e.direction)&&(e.direction=new Float64Array(e.direction.slice(0,9))):e.direction=Bl(new Float64Array(9)),e.indexToWorld=new Float64Array(16),e.worldToIndex=new Float64Array(16),ce.get(t,e,["indexToWorld","worldToIndex"]),ce.setGetArray(t,e,["origin","spacing"],3),ce.setGetArray(t,e,["direction"],9),ce.getArray(t,e,["extent"],6),J8e(t,e)}const Q8e=ce.newInstance(VJ,"vtkImageData");var KC={newInstance:Q8e,extend:VJ};const DV=[[0,-1,0],[0,1,0],[0,0,-1],[0,0,1]],OV=[[0,-1,0],[0,1,0]],e6e=[[0,-1,0],[0,1,0],[0,0,-1]],t6e=[[0,-1,0],[0,1,0],[0,0,1]];var om;let Zp=(om=class{static copyMap(e,n){for(const[r,i]of n.rows)e.rows.set(r,structuredClone(i))}constructor(e,n,r=1){this.rows=new Map,this.height=1,this.width=1,this.depth=1,this.jMultiple=1,this.kMultiple=1,this.numComps=1,this.pixelDataConstructor=Uint8Array,this.updateScalarData=function(i){i.fill(0);const a=(o,s,l)=>{const{start:c,end:f,value:u}=s;for(let d=c;d<f;d++)i[o+d]=u};this.forEach(a)},this.get=i=>{const a=i%this.jMultiple,o=(i-a)/this.jMultiple;return this.getRLE(a,o)?.value??this.defaultValue},this.getRun=(i,a)=>{const o=i+a*this.height;return this.rows.get(o)},this.set=(i,a)=>{if(a===void 0)return;const o=i%this.width,s=(i-o)/this.width,l=this.rows.get(s);if(!l){this.rows.set(s,[{start:o,end:o+1,value:a}]);return}const c=this.findIndex(l,o),f=l[c],u=l[c-1];if(!f){if(!u||u.value!==a||u.end!==o){l[c]={start:o,end:o+1,value:a};return}u.end++;return}const{start:d,end:h,value:p}=f;if(a===p&&o>=d)return;const g={start:o,end:o+1,value:a},m=o>d,y=m?c+1:c,v=m?f:u;let x=m?l[c+1]:f;if(v?.value===a&&v?.end===o){v.end++,x?.value===a&&x.start===o+1?(v.end=x.end,l.splice(c,1)):x?.start===o&&(x.start++,x.start===x.end&&(l.splice(c,1),x=l[c],x?.start===o+1&&x.value===a&&(v.end=x.end,l.splice(c,1))));return}if(x?.value===a&&x.start===o+1){x.start--,v?.end>o&&(v.end=o,v.end===v.start&&l.splice(c,1));return}if(x?.start===o&&x.end===o+1){x.value=a;const w=l[c+1];w?.start==o+1&&w.value===a&&(l.splice(c+1,1),x.end=w.end);return}o===x?.start&&x.start++,m&&h>o+1?l.splice(y,0,g,{start:o+1,end:v.end,value:v.value}):l.splice(y,0,g),v?.end>o&&(v.end=o)},this.width=e,this.height=n,this.depth=r,this.jMultiple=e,this.kMultiple=this.jMultiple*n}toIJK(e){const n=e%this.jMultiple,r=(e-n)/this.jMultiple%this.height,i=Math.floor(e/this.kMultiple);return[n,r,i]}toIndex([e,n,r]){return e+r*this.kMultiple+n*this.jMultiple}getRLE(e,n,r=0){const i=this.rows.get(n+r*this.height);if(!i)return;const a=this.findIndex(i,e),o=i[a];return e>=o?.start?o:void 0}has(e){const n=e%this.jMultiple,r=(e-n)/this.jMultiple;return this.getRLE(n,r)?.value!==void 0}delete(e){const n=e%this.width,r=(e-n)/this.width,i=this.rows.get(r);if(!i)return;const a=this.findIndex(i,n),o=i[a];if(!o||o.start>n)return;if(o.end===n+1){o.end--,o.start>=o.end&&(i.splice(a,1),i.length||this.rows.delete(r));return}if(o.start===n){o.start++;return}const s={value:o.value,start:n+1,end:o.end};o.end=n,i.splice(a+1,0,s)}findIndex(e,n){for(let r=0;r<e.length;r++){const{end:i}=e[r];if(n<i)return r}return e.length}forEach(e,n){const r=n?.rowModified;for(const[i,a]of this.rows){const o=r?[...a]:a;for(const s of o)e(i*this.width,s,a)}}forEachRow(e){for(const[n,r]of this.rows)e(n*this.width,r)}clear(){this.rows.clear()}keys(){return[...this.rows.keys()]}getPixelData(e=0,n){n?n.fill(0):n=new this.pixelDataConstructor(this.width*this.height*this.numComps);const{width:r,height:i,numComps:a}=this;for(let o=0;o<i;o++){const s=this.getRun(o,e);if(s)if(a===1)for(const l of s){const c=o*r,{start:f,end:u,value:d}=l;for(let h=f;h<u;h++)n[c+h]=d}else for(const l of s){const c=o*r*a,{start:f,end:u,value:d}=l;for(let h=f;h<u;h+=a)for(let p=0;p<a;p++)n[c+h+p]=d[p]}}return n}floodFill(e,n,r,i,a){const o=this.getRLE(e,n,r);if(!o)throw new Error(`Initial point ${e},${n},${r} isn't in the RLE`);const s=[[o,n,r]],l=o.value;if(l===i)throw new Error(`source (${l}) and destination (${i}) are identical`);return this.flood(s,l,i,a)}flood(e,n,r,i){let a=0;const{planar:o=!0,diagonals:s=!0,singlePlane:l=!1}=i||{},c={planar:o,diagonals:s,singlePlane:l};for(;e.length;){const f=e.pop(),[u]=f;if(u.value!==n)continue;u.value=r,a+=u.end-u.start;const d=this.findAdjacents(f,c).filter(h=>h&&h[0].value===n);e.push(...d)}return a}fillFrom(e,n){for(let r=n[2][0];r<=n[2][1];r++)for(let i=n[1][0];i<=n[1][1];i++){let a,o;for(let s=n[0][0];s<=n[0][1];s++){const l=e(s,i,r);if(l===void 0){a=void 0;continue}o||(o=[],this.rows.set(i+r*this.height,o)),a&&a.value!==l&&(a=void 0),a||(a={start:s,end:s,value:l},o.push(a)),a.end++}}}findAdjacents(e,{diagonals:n=!0,planar:r=!0,singlePlane:i=!1}){const[a,o,s,l]=e,{start:c,end:f}=a,u=c>0&&this.getRLE(c-1,o,s),d=f<this.width&&this.getRLE(f,o,s),h=n?[c>0?c-1:c,f<this.width?f+1:f]:[c,f],p=[];u&&p.push([u,o,s]),d&&p.push([d,o,s]);for(const g of l||(i?OV:DV)){const[,m,y]=g,v=m+o,x=y+s;if(v<0||v>=this.height||x<0||x>=this.depth)continue;const w=this.getRun(v,x);if(w)for(const S of w){const T=l||i&&OV||r&&y>0&&t6e||r&&y<0&&e6e||DV;S.end<=h[0]||S.start>=h[1]||p.push([S,v,x,T])}}return p}},om.getScalarData=function(e=Uint8ClampedArray){const n=new e(this.frameSize);return this.map.updateScalarData(n),n},om),rw=class Av{constructor(e={}){this._dimensions=3,this._length=0,this._byteSize=4,this.growSize=128;const{initialSize:n=1024,dimensions:r=3,growSize:i=128}=e,a=n*r;this.growSize=i,this.array=new ArrayBuffer(a*this._byteSize),this.data=new Float32Array(this.array),this._dimensions=r}forEach(e){for(let n=0;n<this._length;n++)e(this.getPoint(n),n)}get length(){return this._length}get dimensions(){return this._dimensions}get dimensionLength(){return this._length*this._dimensions}getPoint(e){if(e<0&&(e+=this._length),e<0||e>=this._length)return;const n=this._dimensions*e;return this.data.subarray(n,n+this._dimensions)}getPointArray(e){const n=[];if(e<0&&(e+=this._length),e<0||e>=this._length)return;const r=this._dimensions*e;for(let i=0;i<this._dimensions;i++)n.push(this.data[i+r]);return n}grow(e=1,n=this.growSize){if(this.dimensionLength+e*this._dimensions<=this.data.length)return;const r=this.data.length+n,i=new ArrayBuffer(r*this._dimensions*this._byteSize),a=new Float32Array(i);a.set(this.data),this.data=a,this.array=i}reverse(){const e=Math.floor(this._length/2);for(let n=0;n<e;n++){const r=n*this._dimensions,i=(this._length-1-n)*this._dimensions;for(let a=0;a<this._dimensions;a++){const o=this.data[r+a];this.data[r+a]=this.data[i+a],this.data[i+a]=o}}}getTypedArray(){return this.data}push(e){this.grow(1);const n=this.length*this._dimensions;for(let r=0;r<this._dimensions;r++)this.data[r+n]=e[r];this._length++}map(e){const n=[];for(let r=0;r<this._length;r++)n.push(e(this.getPoint(r),r));return n}get points(){return this.map(e=>e)}toXYZ(){const e={x:[],y:[]};this._dimensions>=3&&(e.z=[]);const{x:n,y:r,z:i}=e;return this.forEach(a=>{n.push(a[0]),r.push(a[1]),i&&i.push(a[2])}),e}static fromXYZ({x:e,y:n,z:r}){const i=Av.create3(e.length);let a=0;for(let o=0;o<e.length;o++)i.data[a++]=e[o],i.data[a++]=n[o],i.data[a++]=r?r[o]:0;return i._length=e.length,i}subselect(e=10,n=0){const r=new Av({initialSize:e,dimensions:this._dimensions});for(let i=0;i<e;i++){const a=(n+Math.floor(this.length*i/e))%this.length;r.push(this.getPoint(a))}return r}static create3(e=128,n){e=Math.max(e,n?.length||0);const r=new Av({initialSize:e,dimensions:3});return n&&n.forEach(i=>r.push(i)),r}static create2(e=128){return new Av({initialSize:e,dimensions:2})}};function FJ(t){const e=it(),n=t.getDimensions(),r=rw.create3(n[0]),i=rw.create3(n[1]),a=rw.create3(n[2]),o=t.getDirection(),s=o.slice(0,3),l=o.slice(3,6),c=o.slice(6,9),f=t.getSpacing(),[u,d,h]=f,p=t.indexToWorld([0,0,0]),g=Sn(s[0]*u,s[1]*u,s[2]*u),m=Sn(l[0]*d,l[1]*d,l[2]*d),y=Sn(c[0]*h,c[1]*h,c[2]*h),v=it();for(let T=0;T<n[0];T++)r.push(Ul(v,p,tl(v,g,T)));for(let T=0;T<n[1];T++)i.push(tl(v,m,T));for(let T=0;T<n[2];T++)a.push(tl(v,y,T));const x=r.getTypedArray(),w=i.getTypedArray(),S=a.getTypedArray();return(T,_=e)=>{const[D,I,R]=T,O=D*3,P=I*3,N=R*3;return _[0]=x[O]+w[P]+S[N],_[1]=x[O+1]+w[P+1]+S[N+1],_[2]=x[O+2]+w[P+2]+S[N+2],_}}function N7(t,e){const{pointInShapeFn:n,callback:r,boundsIJK:i,returnPoints:a=!1}=e;let o;if(t.getScalarData)o=t.getScalarData();else{const u=t.getPointData().getScalars();if(u)o=u.getData();else{const{voxelManager:d}=t.get("voxelManager")||{};d&&(o=d.getCompleteScalarDataArray())}}const s=t.getDimensions(),l=[[0,s[0]],[0,s[1]],[0,s[2]]],f=n6e({imageData:t,bounds:i||l,scalarData:o,pointInShapeFn:n,callback:r});return a?f:void 0}function n6e({imageData:t,bounds:e,scalarData:n,pointInShapeFn:r,callback:i}){const[[a,o],[s,l],[c,f]]=e,{numComps:u}=t,d=t.getDimensions(),h=FJ(t),p=[0,0,0],g=u||n.length/d[2]/d[1]/d[0],m=d[0]*g,y=d[1]*m,v=[];for(let x=c;x<=f;x++){p[2]=x;const w=x*y;for(let S=s;S<=l;S++){p[1]=S;const T=w+S*m;for(let _=a;_<=o;_++){p[0]=_;const D=h(p);if(r(D,p)){const I=T+_*g;let R;g>2?R=[n[I],n[I+1],n[I+2]]:R=n[I],v.push({value:R,index:I,pointIJK:p,pointLPS:D.slice()}),i({value:R,index:I,pointIJK:p,pointLPS:D})}}}}return v}function r6e({voxelManager:t,bounds:e,imageData:n,pointInShapeFn:r,callback:i,returnPoints:a}){const[[o,s],[l,c],[f,u]]=e,d=FJ(n),h=[0,0,0],p=[];for(let g=f;g<=u;g++){h[2]=g;for(let m=l;m<=c;m++){h[1]=m;for(let y=o;y<=s;y++){h[0]=y;const v=d(h);if(r(v,h)){const x=t.toIndex(h),w=t.getAtIndex(x);a&&p.push({value:w,index:x,pointIJK:[...h],pointLPS:v.slice()}),i?.({value:w,index:x,pointIJK:h,pointLPS:v})}}}}return p}const i6e=5*1024;let a0=class xa{get id(){return this._id}constructor(e,n){this.modifiedSlices=new Set,this.boundsIJK=[[1/0,-1/0],[1/0,-1/0],[1/0,-1/0]],this.scalarData=null,this._sliceDataCache=null,this.getAtIJK=(r,i,a)=>{const o=this.toIndex([r,i,a]);return this._get(o)},this.setAtIJK=(r,i,a,o)=>{const s=this.toIndex([r,i,a]),l=this._set(s,o);return l!==!1&&(this.modifiedSlices.add(a),xa.addBounds(this.boundsIJK,[r,i,a])),l},this.getAtIJKPoint=([r,i,a])=>this.getAtIJK(r,i,a),this.setAtIJKPoint=([r,i,a],o)=>{this.setAtIJK(r,i,a,o)},this.getAtIndex=r=>this._get(r),this.setAtIndex=(r,i)=>{const a=this._set(r,i);if(a!==!1){const o=this.toIJK(r);this.modifiedSlices.add(o[2]),xa.addBounds(this.boundsIJK,o)}return a},this.getMiddleSliceData=()=>{const r=Math.floor(this.dimensions[2]/2);return this.getSliceData({sliceIndex:r,slicePlane:2})},this.forEach=(r,i={})=>{const a=i.boundsIJK||this.getBoundsIJK(),o=i.isInObject||this.isInObject||(()=>!0),s=i.returnPoints||!1,l=i.imageData,c=Math.min(a[0][0],a[0][1]),f=Math.max(a[0][0],a[0][1]),u=Math.min(a[1][0],a[1][1]),d=Math.max(a[1][0],a[1][1]),h=Math.min(a[2][0],a[2][1]),p=Math.max(a[2][0],a[2][1]),g=[];if(l)return r6e({voxelManager:this,imageData:i.imageData,bounds:[[c,f],[u,d],[h,p]],pointInShapeFn:o,callback:r,returnPoints:s});if(this.map){if(this.map instanceof Zp)return this.rleForEach(r,i);for(const m of this.map.keys()){const y=this.toIJK(m);if(!o(null,y))continue;const v=this._get(m);s&&g.push({value:v,index:m,pointIJK:y,pointLPS:null}),r({value:v,index:m,pointIJK:y,pointLPS:null})}return g}else{for(let m=h;m<=p;m++){const y=m*this.frameSize;for(let v=u;v<=d;v++){const x=y+v*this.width;for(let w=c,S=x+w;w<=f;w++,S++){const T=this.getAtIndex(S),_=[w,v,m];o(null,_)&&(s&&g.push({value:T,index:S,pointIJK:_,pointLPS:null}),r({value:T,index:S,pointIJK:[w,v,m],pointLPS:null}))}}}return g}},this.getSliceData=({sliceIndex:r,slicePlane:i})=>{const[a,o,s]=this.dimensions,l=a*o,c=r*l;let f;const u=this.getConstructor();function d(p){return typeof p=="function"}if(!d(u))return new Uint8Array(0);let h;switch(i){case 0:f=o*s,h=new u(f);for(let p=0;p<o;p++)for(let g=0;g<s;g++){const m=r+p*a+g*l;this.setSliceDataValue(h,p*s+g,this._get(m))}break;case 1:f=a*s,h=new u(f);for(let p=0;p<a;p++)for(let g=0;g<s;g++){const m=p+r*a+g*l;this.setSliceDataValue(h,p+g*a,this._get(m))}break;case 2:f=a*o,h=new u(f);for(let p=0;p<f;p++)this.setSliceDataValue(h,p,this._get(c+p));break;default:throw new Error("Oblique plane - todo - implement as ortho normal vector")}return h},this.dimensions=e,this.width=e[0],this.frameSize=this.width*e[1],this._get=n._get,this._set=n._set,this._id=n._id||"",this._getConstructor=n._getConstructor,this.numberOfComponents=this.numberOfComponents||1,this.scalarData=n.scalarData,this._getScalarData=n._getScalarData,this._updateScalarData=n._updateScalarData}getMinMax(){let e,n;const r=({value:i})=>{const a=Array.isArray(i);if(e===void 0&&(e=a?[...i]:i,n=a?[...i]:i),a)for(let o=0;o<i.length;o++)e[o]=Math.min(e[o],i[o]),n[o]=Math.max(n[o],i[o]);else e=Math.min(e,i),n=Math.max(n,i)};return this.forEach(r,{boundsIJK:this.getDefaultBounds()}),{min:e,max:n}}toIJK(e){return[e%this.width,Math.floor(e%this.frameSize/this.width),Math.floor(e/this.frameSize)]}toIndex(e){return e[0]+e[1]*this.width+e[2]*this.frameSize}getDefaultBounds(){return this.dimensions.map(e=>[0,e-1])}getBoundsIJK(){return this.boundsIJK[0][0]<this.dimensions[0]?this.boundsIJK:this.getDefaultBounds()}rleForEach(e,n){const r=n?.boundsIJK||this.getBoundsIJK(),{isWithinObject:i}=n||{},a=this.map;if(!a){console.warn("No map found, you need to use a map voxel manager to use rleForEach");return}a.defaultValue=void 0;for(let o=r[2][0];o<=r[2][1];o++)for(let s=r[1][0];s<=r[1][1];s++){const l=a.getRun(s,o);if(l)for(const c of l){const{start:f,end:u,value:d}=c,h=this.toIndex([0,s,o]);for(let p=f;p<u;p++){const g={value:d,index:h+p,pointIJK:[p,s,o]};i?.(g)!==!1&&e(g)}}}}getScalarData(e=!1){if(this.scalarData)return this._updateScalarData?.(this.scalarData),this.scalarData;if(this._getScalarData){const n=this._getScalarData();return e&&console.log("Not transient, should store value",n),n}throw new Error("No scalar data available")}setScalarData(e){this.scalarData=e}getScalarDataLength(){if(this.scalarData)return this.scalarData.length;if(this._getScalarDataLength)return this._getScalarDataLength();throw new Error("No scalar data available")}get sizeInBytes(){return this.getScalarDataLength()*this.bytePerVoxel}get bytePerVoxel(){return this.scalarData?this.scalarData.BYTES_PER_ELEMENT:this._get(0).BYTES_PER_ELEMENT}clearBounds(){this.boundsIJK.map(e=>{e[0]=1/0,e[1]=-1/0})}clear(){this.map?.clear(),this.clearBounds(),this.modifiedSlices.clear(),this.points?.clear()}getConstructor(){return this.scalarData?this.scalarData.constructor:this._getConstructor?this._getConstructor():(console.warn("No scalar data available or can be used to get the constructor"),Float32Array)}getArrayOfModifiedSlices(){return Array.from(this.modifiedSlices)}resetModifiedSlices(){this.modifiedSlices.clear()}setBounds(e){this.boundsIJK=e}static addBounds(e,n){e||(e=[[1/0,-1/0],[1/0,-1/0],[1/0,-1/0]]),e[0][0]=Math.min(n[0],e[0][0]),e[0][1]=Math.max(n[0],e[0][1]),e[1][0]=Math.min(n[1],e[1][0]),e[1][1]=Math.max(n[1],e[1][1]),e[2][0]=Math.min(n[2],e[2][0]),e[2][1]=Math.max(n[2],e[2][1])}addPoint(e){const n=Array.isArray(e)?e[0]+this.width*e[1]+this.frameSize*e[2]:e;this.points||(this.points=new Set),this.points.add(n)}getPoints(){return this.points?[...this.points].map(e=>this.toIJK(e)):[]}setSliceDataValue(e,n,r){if(Array.isArray(r))for(let i=0;i<r.length;i++)e[n*r.length+i]=this.toNumber(r[i]);else e[n]=this.toNumber(r)}toNumber(e){return typeof e=="number"?e:Array.isArray(e)&&e[0]||0}static _createRGBScalarVolumeVoxelManager({dimensions:e,scalarData:n,numberOfComponents:r=3,id:i}){const a=new xa(e,{_get:o=>(o*=r,[n[o++],n[o++],n[o++]]),_id:i||"_createRGBScalarVolumeVoxelManager",_set:(o,s)=>{o*=3;const l=!pr(n[o],s);return n[o++]=s[0],n[o++]=s[1],n[o++]=s[2],l},numberOfComponents:r,scalarData:n});return a.clear=()=>{n.fill(0)},a}static createImageVolumeVoxelManager({dimensions:e,imageIds:n,numberOfComponents:r=1,id:i}){const a=e[0]*e[1];function o(u){const d=Math.floor(u/a);if(d<0||d>=e[2])return{};const h=n[d];if(!h)return console.warn(`ImageId not found for sliceIndex: ${d}`),{pixelData:null,pixelIndex:null};const p=yt.getImage(h);if(!p)return console.warn(`Image not found for imageId: ${h}`),{pixelData:null,pixelIndex:null};const g=p.voxelManager,m=u%a;return{voxelManager:g,pixelIndex:m}}function s(u){const{voxelManager:d,pixelIndex:h}=o(u);return!d||h===null?null:d.getAtIndex(h)}function l(u,d){const{voxelManager:h,pixelIndex:p}=o(u);if(!h||p===null)return!1;const g=h.getAtIndex(p),m=!pr(d,g);return m&&(h.setAtIndex(p,d),!0)}const c=()=>{const{voxelManager:u,pixelIndex:d}=o(0);return!u||d===null?null:u.getConstructor()},f=new xa(e,{_get:s,_set:l,numberOfComponents:r,_getConstructor:c,_id:i||"createImageVolumeVoxelManager"});return f.getMiddleSliceData=()=>{const u=Math.floor(e[2]/2);return f.getSliceData({sliceIndex:u,slicePlane:2})},f.clear=()=>{for(const u of n)yt.getImage(u).voxelManager.clear()},f.getRange=()=>{let u=1/0,d=-1/0;for(const h of n){const p=yt.getImage(h);p&&(p.minPixelValue<u&&(u=p.minPixelValue),p.maxPixelValue>d&&(d=p.maxPixelValue))}return u===1/0&&d===-1/0?[0,0]:[u,d]},f._getScalarDataLength=()=>{const{voxelManager:u,pixelIndex:d}=o(0);return!u||d===null?0:u.getScalarDataLength()*e[2]},f.getCompleteScalarDataArray=()=>{const u=f._getConstructor();if(!u)return new Uint8Array(0);const d=f.getScalarDataLength(),h=new u(d),p=e[0]*e[1]*r;for(let g=0;g<e[2];g++){const{voxelManager:m,pixelIndex:y}=o(g*p/r);if(m&&y!==null){const v=g*p,x=m.getScalarData();if(r===1)h.set(x,v);else for(let w=0;w<x.length;w+=r)for(let S=0;S<r;S++)h[v+w+S]=x[w+S]}}return h},f.setCompleteScalarDataArray=u=>{const d=e[0]*e[1]*r,h=f._getConstructor();let p=1/0,g=-1/0;for(let m=0;m<e[2];m++){const{voxelManager:y}=o(m*d/r);if(y&&h){const v=m*d,x=v+d,w=new h(d);if(w.set(u.subarray(v,x)),y.scalarData)y.scalarData.set(w),y.modifiedSlices.add(m);else for(let _=0;_<d;_++)y.setAtIndex(_,w[_]);for(let _=0;_<w.length;_++){const D=w[_];p=Math.min(p,D),g=Math.max(g,D)}const S=n[m],T=yt.getImage(S);T&&(T.minPixelValue=p,T.maxPixelValue=g)}}for(let m=0;m<e[2];m++)f.modifiedSlices.add(m);f.boundsIJK=[[0,e[0]-1],[0,e[1]-1],[0,e[2]-1]]},f}static createScalarVolumeVoxelManager({dimensions:e,scalarData:n,numberOfComponents:r,id:i}){if(e.length!==3)throw new Error("Dimensions must be provided as [number, number, number] for [width, height, depth]");if(!r&&(r=n.length/e[0]/e[1]/e[2],r>4||r<1||r===2))throw new Error(`Number of components ${r} must be 1, 3 or 4`);return r>1?xa._createRGBScalarVolumeVoxelManager({dimensions:e,scalarData:n,numberOfComponents:r,id:i}):xa._createNumberVolumeVoxelManager({dimensions:e,scalarData:n,id:i})}static createScalarDynamicVolumeVoxelManager({imageIdGroups:e,dimensions:n,dimensionGroupNumber:r=1,timePoint:i=0,numberOfComponents:a=1,id:o}){let s=0;if(r!==void 0?s=r-1:i!==void 0&&(console.warn("Warning: timePoint parameter is deprecated. Please use dimensionGroupNumber instead. timePoint is zero-based while dimensionGroupNumber starts at 1."),s=i),!a){const f=yt.getImage(e[0][0]);if(!f)throw new Error("Unable to determine number of components: No image found");if(a=f.getPixelData().length/(n[0]*n[1]),a>4||a<1||a===2)throw new Error(`Number of components ${a} must be 1, 3 or 4`)}const l=e.map(f=>xa.createImageVolumeVoxelManager({dimensions:n,imageIds:f,numberOfComponents:a,id:o})),c=new xa(n,{_get:f=>l[s]._get(f),_set:(f,u)=>l[s]._set(f,u),numberOfComponents:a,_id:o||"createScalarDynamicVolumeVoxelManager"});return c.getScalarDataLength=()=>l[s].getScalarDataLength(),c.getConstructor=()=>l[s].getConstructor(),c.getRange=()=>l[s].getRange(),c.getMiddleSliceData=()=>l[s].getMiddleSliceData(),c.setTimePoint=f=>{console.warn("Warning: setTimePoint is deprecated. Please use setDimensionGroupNumber instead. Note that timePoint is zero-based while dimensionGroupNumber starts at 1."),c.setDimensionGroupNumber(f+1)},c.setDimensionGroupNumber=f=>{s=f-1,c._get=u=>l[s]._get(u),c._set=(u,d)=>l[s]._set(u,d)},c.getAtIndexAndTimePoint=(f,u)=>(console.warn("Warning: getAtIndexAndTimePoint is deprecated. Please use getAtIndexAndDimensionGroup instead. Note that timePoint is zero-based while dimensionGroupNumber starts at 1."),c.getAtIndexAndDimensionGroup(f,u+1)),c.getAtIndexAndDimensionGroup=(f,u)=>l[u-1]._get(f),c.getTimePointScalarData=f=>(console.warn("Warning: getTimePointScalarData is deprecated. Please use getDimensionGroupScalarData instead. Note that timePoint is zero-based while dimensionGroupNumber starts at 1."),c.getDimensionGroupScalarData(f+1)),c.getDimensionGroupScalarData=f=>l[f-1].getCompleteScalarDataArray(),c.getCurrentTimePointScalarData=()=>(console.warn("Warning: getCurrentTimePointScalarData is deprecated. Please use getCurrentDimensionGroupScalarData instead."),c.getCurrentDimensionGroupScalarData()),c.getCurrentDimensionGroupScalarData=()=>l[s].getCompleteScalarDataArray(),c.getCurrentTimePoint=()=>(console.warn("Warning: getCurrentTimePoint is deprecated. Please use getCurrentDimensionGroupNumber instead. Note that timePoint is zero-based while dimensionGroupNumber starts at 1."),s),c.getCurrentDimensionGroupNumber=()=>s+1,c}static createImageVoxelManager({width:e,height:n,scalarData:r,numberOfComponents:i=1,id:a}){const o=[e,n,1];if(!i&&(i=r.length/e/n,i>4||i<1||i===2))throw new Error(`Number of components ${i} must be 1, 3 or 4`);return i>1?xa._createRGBScalarVolumeVoxelManager({dimensions:o,scalarData:r,numberOfComponents:i,id:a}):xa._createNumberVolumeVoxelManager({dimensions:o,scalarData:r,id:a})}static _createNumberVolumeVoxelManager({dimensions:e,scalarData:n,id:r}){const i=new xa(e,{_get:a=>n[a],_set:(a,o)=>{const s=n[a]!==o;return n[a]=o,s},_getConstructor:()=>n.constructor,_id:r||"_createNumberVolumeVoxelManager"});return i.scalarData=n,i.clear=()=>{i.scalarData.fill(0)},i.getMiddleSliceData=()=>{const a=Math.floor(e[2]/2);return i.getSliceData({sliceIndex:a,slicePlane:2})},i}static createMapVoxelManager({dimension:e,id:n}){const r=new Map,i=new xa(e,{_get:r.get.bind(r),_set:(a,o)=>r.set(a,o)&&!0,_id:n||"createMapVoxelManager"});return i.map=r,i}static createHistoryVoxelManager(e,n){const r=new Map,{dimensions:i}=e,a=new xa(i,{_get:o=>r.get(o),_set:function(o,s){if(r.has(o))s===r.get(o)&&r.delete(o);else{const l=this.sourceVoxelManager.getAtIndex(o);if(l===s)return!1;r.set(o,l)}this.sourceVoxelManager.setAtIndex(o,s)},_id:n||"createHistoryVoxelManager"});return a.map=r,a.scalarData=e.scalarData,a.sourceVoxelManager=e,a}static createRLEHistoryVoxelManager(e,n){const{dimensions:r}=e,i=new Zp(r[0],r[1],r[2]),a=new xa(r,{_get:o=>i.get(o),_set:function(o,s){const l=i.get(o);if(l===void 0){const c=this.sourceVoxelManager.getAtIndex(o);if(c===s||c===void 0&&s===0||s===null)return!1;i.set(o,c??0)}else(s===l||s===null)&&(i.delete(o),s=l);this.sourceVoxelManager.setAtIndex(o,s)},_getScalarData:Zp.getScalarData,_updateScalarData:o=>(i.updateScalarData(o),o),_id:n||"createRLEHistoryVoxelManager"});return a.map=i,a.sourceVoxelManager=e,a}static createLazyVoxelManager({dimensions:e,planeFactory:n,id:r}){const i=new Map,[a,o]=e,s=a*o,l=new xa(e,{_get:c=>i.get(Math.floor(c/s))[c%s],_set:(c,f)=>{const u=Math.floor(c/s);let d=i.get(u);return d||(d=n(a,o),i.set(u,d)),d[c%s]=f,!0},_id:r||"createLazyVoxelManager"});return l.map=i,l}static createRLEVolumeVoxelManager({dimensions:e,id:n}){const[r,i,a]=e,o=new Zp(r,i,a),s=new xa(e,{_get:l=>o.get(l),_set:(l,c)=>(o.set(l,c),!0),_getScalarData:Zp.getScalarData,_updateScalarData:l=>(o.updateScalarData(l),l),_id:n||"createRLEVolumeVoxelManager"});return s.map=o,s.getPixelData=o.getPixelData.bind(o),s}static createRLEImageVoxelManager({dimensions:e,id:n}){const[r,i]=e;return xa.createRLEVolumeVoxelManager({dimensions:[r,i,1],id:n})}static addInstanceToImage(e){const{width:n,height:r}=e,i=e.voxelManager.getScalarData();if(i.length>=n*r){e.voxelManager=xa.createScalarVolumeVoxelManager({dimensions:[n,r,1],scalarData:i});return}e.voxelManager=xa.createRLEVolumeVoxelManager({dimensions:[n,r,1]}),e.getPixelData=e.voxelManager.getPixelData,e.sizeInBytes=i6e}};const a6e="WebGL",d3=Object.create(null);function UJ(t,e){d3[t]=e}function o6e(){return Object.keys(d3)}function BJ(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return d3[t]&&d3[t](e)}function s6e(t,e){e.classHierarchy.push("vtkRenderWindow"),t.addRenderer=n=>{t.hasRenderer(n)||(n.setRenderWindow(t),e.renderers.push(n),t.modified())},t.removeRenderer=n=>{e.renderers=e.renderers.filter(r=>r!==n),t.modified()},t.hasRenderer=n=>e.renderers.indexOf(n)!==-1,t.newAPISpecificView=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return BJ(n||e.defaultViewAPI,r)},t.addView=n=>{t.hasView(n)||(n.setRenderable(t),e._views.push(n),t.modified())},t.removeView=n=>{e._views=e._views.filter(r=>r!==n),t.modified()},t.hasView=n=>e._views.indexOf(n)!==-1,t.preRender=()=>{e.renderers.forEach(n=>{n.isActiveCameraCreated()||n.resetCamera()})},t.render=()=>{t.preRender(),e.interactor?e.interactor.render():e._views.forEach(n=>n.traverseAllPasses())},t.getStatistics=()=>{const n={propCount:0,invisiblePropCount:0,gpuMemoryMB:0};return e._views.forEach(r=>{r.getGraphicsMemoryInfo&&(n.gpuMemoryMB+=r.getGraphicsMemoryInfo()/1e6)}),e.renderers.forEach(r=>{const i=r.getViewProps(),a=e._views[0].getViewNodeFor(r);i.forEach(o=>{if(o.getVisibility()){n.propCount+=1;const s=o.getMapper&&o.getMapper();if(s&&s.getPrimitiveCount){const l=a.getViewNodeFor(s);if(l){l.getAllocatedGPUMemoryInBytes&&(n.gpuMemoryMB+=l.getAllocatedGPUMemoryInBytes()/1e6);const c=s.getPrimitiveCount();Object.keys(c).forEach(f=>{n[f]||(n[f]=0),n[f]+=c[f]})}}}else n.invisiblePropCount+=1})}),n.str=Object.keys(n).map(r=>`${r}: ${n[r]}`).join(`
`),n},t.captureImages=function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"image/png",r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return ce.setImmediate(t.render),e._views.map(i=>i.captureNextImage?i.captureNextImage(n,r):void 0).filter(i=>!!i)},t.addRenderWindow=n=>e.childRenderWindows.includes(n)?!1:(e.childRenderWindows.push(n),t.modified(),!0),t.removeRenderWindow=n=>{const r=e.childRenderWindows.findIndex(i=>i===n);return r<0?!1:(e.childRenderWindows.splice(r,1),t.modified(),!0)}}const l6e={defaultViewAPI:a6e,renderers:[],views:[],interactor:null,neverRendered:!0,numberOfLayers:1,childRenderWindows:[]};function $J(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,l6e,n),ce.obj(t,e),ce.setGet(t,e,["interactor","numberOfLayers","_views","defaultViewAPI"]),ce.get(t,e,["neverRendered"]),ce.getArray(t,e,["renderers","childRenderWindows"]),ce.moveToProtected(t,e,["views"]),ce.event(t,e,"completion"),s6e(t,e)}const c6e=ce.newInstance($J,"vtkRenderWindow");var u6e={newInstance:c6e,extend:$J,registerViewConstructor:UJ,listViewAPIs:o6e,newAPISpecificView:BJ};function f6e(t,e){e.classHierarchy.push("vtkRenderPass"),t.getOperation=()=>e.currentOperation,t.setCurrentOperation=n=>{e.currentOperation=n,e.currentTraverseOperation=`traverse${ce.capitalize(e.currentOperation)}`},t.getTraverseOperation=()=>e.currentTraverseOperation,t.traverse=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;e.deleted||(e._currentParent=r,e.preDelegateOperations.forEach(i=>{t.setCurrentOperation(i),n.traverse(t)}),e.delegates.forEach(i=>{i.traverse(n,t)}),e.postDelegateOperations.forEach(i=>{t.setCurrentOperation(i),n.traverse(t)}))}}const d6e={delegates:[],currentOperation:null,preDelegateOperations:[],postDelegateOperations:[],currentParent:null};function GJ(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,d6e,n),ce.obj(t,e),ce.get(t,e,["currentOperation"]),ce.setGet(t,e,["delegates","_currentParent","preDelegateOperations","postDelegateOperations"]),ce.moveToProtected(t,e,["currentParent"]),f6e(t,e)}const h6e=ce.newInstance(GJ,"vtkRenderPass");var L7={newInstance:h6e,extend:GJ};const{Representation:p6e}=Yh,{vtkErrorMacro:MV}=ce;function g6e(t){const e=$e.substitute(t.Fragment,"//VTK::RenderPassFragmentShader::Impl",`
      float weight = gl_FragData[0].a * pow(max(1.1 - gl_FragCoord.z, 0.0), 2.0);
      gl_FragData[0] = vec4(gl_FragData[0].rgb*weight, gl_FragData[0].a);
      gl_FragData[1].r = weight;
    `,!1);t.Fragment=e.result}const m6e=`//VTK::System::Dec

in vec2 tcoord;

uniform sampler2D translucentRTexture;
uniform sampler2D translucentRGBATexture;

// the output of this shader
//VTK::Output::Dec

void main()
{
  vec4 t1Color = texture(translucentRGBATexture, tcoord);
  float t2Color = texture(translucentRTexture, tcoord).r;
  gl_FragData[0] = vec4(t1Color.rgb/max(t2Color,0.01), 1.0 - t1Color.a);
}
`;function v6e(t,e){e.classHierarchy.push("vtkOpenGLOrderIndependentTranslucentPass"),t.createVertexBuffer=()=>{const n=new Float32Array([-1,-1,-1,1,-1,-1,-1,1,-1,1,1,-1]),r=new Float32Array([0,0,1,0,0,1,1,1]),i=new Uint16Array([4,0,1,3,2]),a=tn.newInstance({numberOfComponents:3,values:n});a.setName("points");const o=tn.newInstance({numberOfComponents:2,values:r});o.setName("tcoords");const s=tn.newInstance({numberOfComponents:1,values:i});e.tris.getCABO().createVBO(s,"polys",p6e.SURFACE,{points:a,tcoords:o,cellOffset:0}),e.VBOBuildTime.modified()},t.createFramebuffer=n=>{const r=n.getSize(),i=n.getContext();e.framebuffer=HC.newInstance(),e.framebuffer.setOpenGLRenderWindow(n),e.framebuffer.create(...r),e.framebuffer.saveCurrentBindingsAndBuffers(),e.framebuffer.bind(),e.translucentRGBATexture=ai.newInstance(),e.translucentRGBATexture.setInternalFormat(i.RGBA16F),e.translucentRGBATexture.setFormat(i.RGBA),e.translucentRGBATexture.setOpenGLDataType(i.HALF_FLOAT),e.translucentRGBATexture.setOpenGLRenderWindow(n),e.translucentRGBATexture.create2DFromRaw(r[0],r[1],4,"Float32Array",null),e.translucentRTexture=ai.newInstance(),e.translucentRTexture.setInternalFormat(i.R16F),e.translucentRTexture.setFormat(i.RED),e.translucentRTexture.setOpenGLDataType(i.HALF_FLOAT),e.translucentRTexture.setOpenGLRenderWindow(n),e.translucentRTexture.create2DFromRaw(r[0],r[1],1,"Float32Array",null),e.translucentZTexture=ai.newInstance(),e.translucentZTexture.setOpenGLRenderWindow(n),e.translucentZTexture.createDepthFromRaw(r[0],r[1],"Float32Array",null),e.framebuffer.setColorBuffer(e.translucentRGBATexture,0),e.framebuffer.setColorBuffer(e.translucentRTexture,1),e.framebuffer.setDepthBuffer(e.translucentZTexture)},t.createCopyShader=n=>{e.copyShader=n.getShaderCache().readyShaderProgramArray(["//VTK::System::Dec","attribute vec4 vertexDC;","attribute vec2 tcoordTC;","varying vec2 tcoord;","void main() { tcoord = tcoordTC; gl_Position = vertexDC; }"].join(`
`),m6e,"")},t.createVBO=n=>{const r=n.getContext();e.tris.setOpenGLRenderWindow(n),t.createVertexBuffer();const i=e.copyShader;e.tris.getCABO().bind(),e.copyVAO.addAttributeArray(i,e.tris.getCABO(),"vertexDC",e.tris.getCABO().getVertexOffset(),e.tris.getCABO().getStride(),r.FLOAT,3,r.FALSE)||MV("Error setting vertexDC in copy shader VAO."),e.copyVAO.addAttributeArray(i,e.tris.getCABO(),"tcoordTC",e.tris.getCABO().getTCoordOffset(),e.tris.getCABO().getStride(),r.FLOAT,2,r.FALSE)||MV("Error setting vertexDC in copy shader VAO.")},t.traverse=(n,r,i)=>{if(e.deleted)return;const a=n.getSize(),o=n.getContext();if(e._supported=!1,r.getSelector()||!o||!n.getWebgl2()||!o.getExtension("EXT_color_buffer_half_float")&&!o.getExtension("EXT_color_buffer_float")){t.setCurrentOperation("translucentPass"),r.traverse(t);return}if(e._supported=!0,e.framebuffer===null)t.createFramebuffer(n);else{const l=e.framebuffer.getSize();l===null||l[0]!==a[0]||l[1]!==a[1]?(e.framebuffer.releaseGraphicsResources(),e.translucentRGBATexture.releaseGraphicsResources(n),e.translucentRTexture.releaseGraphicsResources(n),e.translucentZTexture.releaseGraphicsResources(n),t.createFramebuffer(n)):(e.framebuffer.saveCurrentBindingsAndBuffers(),e.framebuffer.bind())}o.drawBuffers([o.COLOR_ATTACHMENT0]),o.clearBufferfv(o.COLOR,0,[0,0,0,0]),o.clearBufferfv(o.DEPTH,0,[1]),o.colorMask(!1,!1,!1,!1),i.getOpaqueActorCount()>0&&(i.setCurrentOperation("opaqueZBufferPass"),r.traverse(i)),o.colorMask(!0,!0,!0,!0),o.drawBuffers([o.COLOR_ATTACHMENT0,o.COLOR_ATTACHMENT1]),o.viewport(0,0,a[0],a[1]),o.scissor(0,0,a[0],a[1]),o.clearBufferfv(o.COLOR,0,[0,0,0,1]),o.clearBufferfv(o.COLOR,1,[0,0,0,0]),o.enable(o.DEPTH_TEST),o.enable(o.BLEND),o.blendFuncSeparate(o.ONE,o.ONE,o.ZERO,o.ONE_MINUS_SRC_ALPHA),t.setCurrentOperation("translucentPass"),r.traverse(t),o.drawBuffers([o.NONE]),e.framebuffer.restorePreviousBindingsAndBuffers(),e.copyShader===null?t.createCopyShader(n):n.getShaderCache().readyShaderProgram(e.copyShader),e.copyVAO||(e.copyVAO=M7.newInstance(),e.copyVAO.setOpenGLRenderWindow(n)),e.copyVAO.bind(),e.VBOBuildTime.getMTime()<t.getMTime()&&t.createVBO(n),o.blendFuncSeparate(o.SRC_ALPHA,o.ONE_MINUS_SRC_ALPHA,o.ONE,o.ONE_MINUS_SRC_ALPHA),o.depthMask(!1),o.depthFunc(o.ALWAYS),o.viewport(0,0,a[0],a[1]),o.scissor(0,0,a[0],a[1]),e.translucentRGBATexture.activate(),e.copyShader.setUniformi("translucentRGBATexture",e.translucentRGBATexture.getTextureUnit()),e.translucentRTexture.activate(),e.copyShader.setUniformi("translucentRTexture",e.translucentRTexture.getTextureUnit()),o.drawArrays(o.TRIANGLES,0,e.tris.getCABO().getElementCount()),o.depthMask(!0),o.depthFunc(o.LEQUAL),e.translucentRGBATexture.deactivate(),e.translucentRTexture.deactivate();const s=r.getTiledSizeAndOrigin();o.scissor(s.lowerLeftU,s.lowerLeftV,s.usize,s.vsize),o.viewport(s.lowerLeftU,s.lowerLeftV,s.usize,s.vsize)},t.getShaderReplacement=()=>e._supported?g6e:null,t.releaseGraphicsResources=n=>{e.framebuffer&&(e.framebuffer.releaseGraphicsResources(n),e.framebuffer=null),e.translucentRGBATexture&&(e.translucentRGBATexture.releaseGraphicsResources(n),e.translucentRGBATexture=null),e.translucentRTexture&&(e.translucentRTexture.releaseGraphicsResources(n),e.translucentRTexture=null),e.translucentZTexture&&(e.translucentZTexture.releaseGraphicsResources(n),e.translucentZTexture=null),e.copyVAO&&(e.copyVAO.releaseGraphicsResources(n),e.copyVAO=null),e.copyShader&&(e.copyShader.releaseGraphicsResources(n),e.copyShader=null),e.tris&&(e.tris.releaseGraphicsResources(n),e.tris=null),t.modified()}}const y6e={framebuffer:null,copyShader:null,tris:null};function jJ(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,y6e,n),L7.extend(t,e,n),e.VBOBuildTime={},ce.obj(e.VBOBuildTime,{mtime:0}),e.tris=Du.newInstance(),ce.get(t,e,["framebuffer"]),v6e(t,e)}const x6e=ce.newInstance(jJ,"vtkOpenGLOrderIndependentTranslucentPass");var b6e={newInstance:x6e,extend:jJ};function w6e(t,e){e.classHierarchy.push("vtkForwardPass"),t.traverse=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(e.deleted)return;e._currentParent=r,t.setCurrentOperation("buildPass"),n.traverse(t);const i=n.getRenderable().getNumberOfLayers(),a=n.getRenderable().getRenderersByReference();for(let o=0;o<i;o++)for(let s=0;s<a.length;s++){const l=a[s],c=n.getViewNodeFor(l);if(l.getDraw()&&l.getLayer()===o){if(e.opaqueActorCount=0,e.translucentActorCount=0,e.volumeCount=0,e.overlayActorCount=0,t.setCurrentOperation("queryPass"),c.traverse(t),(e.opaqueActorCount>0||e.translucentActorCount>0)&&e.volumeCount>0||e.depthRequested){const f=n.getFramebufferSize();e.framebuffer===null&&(e.framebuffer=HC.newInstance()),e.framebuffer.setOpenGLRenderWindow(n),e.framebuffer.saveCurrentBindingsAndBuffers();const u=e.framebuffer.getSize();(u===null||u[0]!==f[0]||u[1]!==f[1])&&(e.framebuffer.create(f[0],f[1]),e.framebuffer.populateFramebuffer()),e.framebuffer.bind(),t.setCurrentOperation("zBufferPass"),c.traverse(t),e.framebuffer.restorePreviousBindingsAndBuffers(),e.depthRequested=!1}t.setCurrentOperation("cameraPass"),c.traverse(t),e.opaqueActorCount>0&&(t.setCurrentOperation("opaquePass"),c.traverse(t)),e.translucentActorCount>0&&(e.translucentPass||(e.translucentPass=b6e.newInstance()),e.translucentPass.traverse(n,c,t)),e.volumeCount>0&&(t.setCurrentOperation("volumePass"),c.traverse(t)),e.overlayActorCount>0&&(t.setCurrentOperation("overlayPass"),c.traverse(t))}}},t.getZBufferTexture=()=>e.framebuffer?e.framebuffer.getColorTexture():null,t.requestDepth=()=>{e.depthRequested=!0},t.incrementOpaqueActorCount=()=>e.opaqueActorCount++,t.incrementTranslucentActorCount=()=>e.translucentActorCount++,t.incrementVolumeCount=()=>e.volumeCount++,t.incrementOverlayActorCount=()=>e.overlayActorCount++}const C6e={opaqueActorCount:0,translucentActorCount:0,volumeCount:0,overlayActorCount:0,framebuffer:null,depthRequested:!1};function zJ(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,C6e,n),L7.extend(t,e,n),ce.get(t,e,["framebuffer","opaqueActorCount","translucentActorCount","volumeCount"]),w6e(t,e)}const S6e=ce.newInstance(zJ,"vtkForwardPass");var T6e={newInstance:S6e,extend:zJ};const Jo={MIN_KNOWN_PASS:0,ACTOR_PASS:0,COMPOSITE_INDEX_PASS:1,ID_LOW24:2,ID_HIGH24:3,MAX_KNOWN_PASS:3};var WJ={PassTypes:Jo};const{FieldAssociations:E6e}=zm;function _6e(t,e){e.classHierarchy.push("vtkHardwareSelector"),t.getSourceDataAsync=async(n,r,i,a,o)=>{},t.selectAsync=async(n,r,i,a,o)=>{const s=await t.getSourceDataAsync(n,r,i,a,o);return s?s.generateSelection(r,i,a,o):[]}}const D6e={fieldAssociation:E6e.FIELD_ASSOCIATION_CELLS,captureZValues:!1};function HJ(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,D6e,n),ce.obj(t,e),ce.setGet(t,e,["fieldAssociation","captureZValues"]),_6e(t,e)}const O6e=ce.newInstance(HJ,"vtkHardwareSelector");var M6e={newInstance:O6e,extend:HJ};const I6e={GLOBALIDS:0,PEDIGREEIDS:1,VALUES:2,INDICES:3,FRUSTUM:4,LOCATIONS:5,THRESHOLDS:6,BLOCKS:7,QUERY:8},R6e={CELL:0,POINT:1,FIELD:2,VERTEX:3,EDGE:4,ROW:5};var P6e={SelectionContent:I6e,SelectionField:R6e};function A6e(t,e){e.classHierarchy.push("vtkSelectionNode"),t.getBounds=()=>e.points.getBounds()}const N6e={contentType:-1,fieldType:-1,properties:null,selectionList:[]};function KJ(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,N6e,n),ce.obj(t,e),e.properties={},ce.setGet(t,e,["contentType","fieldType","properties","selectionList"]),A6e(t,e)}const L6e=ce.newInstance(KJ,"vtkSelectionNode");var qJ={newInstance:L6e,extend:KJ,...P6e};const{PassTypes:oa}=WJ,{SelectionContent:k6e,SelectionField:IV}=qJ,{FieldAssociations:o2}=zm,{vtkErrorMacro:XJ}=ce,Nd=1;function YJ(t){return`${t.propID} ${t.compositeID}`}function JJ(t,e,n,r){if(!n)return 0;const i=(e*(r[2]-r[0]+1)+t)*4;return n[i+3]}function yf(t,e,n,r){if(!n)return 0;const i=(e*(r[2]-r[0]+1)+t)*4,a=n[i],o=n[i+1];return(n[i+2]*256+o)*256+a}function ZJ(t,e){let n=e;return n<<=24,n|=t,n}function V6e(t,e,n,r){{if(r[0]=e[0],r[1]=e[1],e[0]<t.area[0]||e[0]>t.area[2]||e[1]<t.area[1]||e[1]>t.area[3])return null;const i=[e[0]-t.area[0],e[1]-t.area[1]],a=yf(i[0],i[1],t.pixBuffer[oa.ACTOR_PASS],t.area);if(a<=0||a-Nd>=t.props.length)return null;const o={};o.valid=!0,o.propID=a-Nd,o.prop=t.props[o.propID];let s=yf(i[0],i[1],t.pixBuffer[oa.COMPOSITE_INDEX_PASS],t.area);if((s<0||s>16777215)&&(s=0),o.compositeID=s-Nd,t.captureZValues){const f=(i[1]*(t.area[2]-t.area[0]+1)+i[0])*4;o.zValue=(256*t.zBuffer[f]+t.zBuffer[f+1])/65535,o.displayPosition=e}if(t.pixBuffer[oa.ID_LOW24]&&JJ(i[0],i[1],t.pixBuffer[oa.ID_LOW24],t.area)===0)return o;const l=yf(i[0],i[1],t.pixBuffer[oa.ID_LOW24],t.area),c=yf(i[0],i[1],t.pixBuffer[oa.ID_HIGH24],t.area);return o.attributeID=ZJ(l,c),o}}function QJ(t,e,n,r,i){const a=[];let o=0;return e.forEach((s,l)=>{const c=qJ.newInstance();switch(c.setContentType(k6e.INDICES),t){case o2.FIELD_ASSOCIATION_CELLS:c.setFieldType(IV.CELL);break;case o2.FIELD_ASSOCIATION_POINTS:c.setFieldType(IV.POINT);break;default:XJ("Unknown field association")}c.getProperties().propID=s.info.propID,c.getProperties().prop=s.info.prop,c.getProperties().compositeID=s.info.compositeID,c.getProperties().attributeID=s.info.attributeID,c.getProperties().pixelCount=s.pixelCount,n&&(c.getProperties().displayPosition=[s.info.displayPosition[0],s.info.displayPosition[1],s.info.zValue],c.getProperties().worldPosition=i.displayToWorld(s.info.displayPosition[0],s.info.displayPosition[1],s.info.zValue,r)),c.setSelectionList(s.attributeIDs),a[o]=c,o++}),a}function F6e(t,e,n,r,i){const a=Math.floor(e),o=Math.floor(n),s=Math.floor(r),l=Math.floor(i),c=new Map,f=[0,0];for(let u=o;u<=l;u++)for(let d=a;d<=s;d++){const p=V6e(t,[d,u],0,f);if(p&&p.valid){const g=YJ(p);if(!c.has(g))c.set(g,{info:p,pixelCount:1,attributeIDs:[p.attributeID]});else{const m=c.get(g);m.pixelCount++,t.captureZValues&&p.zValue<m.info.zValue&&(m.info=p),m.attributeIDs.indexOf(p.attributeID)===-1&&m.attributeIDs.push(p.attributeID)}}}return QJ(t.fieldAssociation,c,t.captureZValues,t.renderer,t.openGLRenderWindow)}function U6e(t,e){e.classHierarchy.push("vtkOpenGLHardwareSelector"),t.releasePixBuffers=()=>{e.rawPixBuffer=[],e.pixBuffer=[],e.zBuffer=null},t.beginSelection=()=>{e._openGLRenderer=e._openGLRenderWindow.getViewNodeFor(e._renderer),e.maxAttributeId=0;const r=e._openGLRenderWindow.getSize();if(!e.framebuffer)e.framebuffer=HC.newInstance(),e.framebuffer.setOpenGLRenderWindow(e._openGLRenderWindow),e.framebuffer.saveCurrentBindingsAndBuffers(),e.framebuffer.create(r[0],r[1]),e.framebuffer.populateFramebuffer();else{e.framebuffer.setOpenGLRenderWindow(e._openGLRenderWindow),e.framebuffer.saveCurrentBindingsAndBuffers();const i=e.framebuffer.getSize();!i||i[0]!==r[0]||i[1]!==r[1]?(e.framebuffer.create(r[0],r[1]),e.framebuffer.populateFramebuffer()):e.framebuffer.bind()}if(e._openGLRenderer.clear(),e._openGLRenderer.setSelector(t),e.hitProps={},e.propPixels={},e.props=[],t.releasePixBuffers(),e.fieldAssociation===o2.FIELD_ASSOCIATION_POINTS){const i=e._openGLRenderWindow.getContext(),a=i.isEnabled(i.BLEND);i.disable(i.BLEND),e._openGLRenderWindow.traverseAllPasses(),a&&i.enable(i.BLEND)}},t.endSelection=()=>{e.hitProps={},e._openGLRenderer.setSelector(null),e.framebuffer.restorePreviousBindingsAndBuffers()},t.preCapturePass=()=>{const r=e._openGLRenderWindow.getContext();e.originalBlending=r.isEnabled(r.BLEND),r.disable(r.BLEND)},t.postCapturePass=()=>{const r=e._openGLRenderWindow.getContext();e.originalBlending&&r.enable(r.BLEND)},t.select=()=>{let r=null;return t.captureBuffers()&&(r=t.generateSelection(e.area[0],e.area[1],e.area[2],e.area[3]),t.releasePixBuffers()),r},t.getSourceDataAsync=async(r,i,a,o,s)=>{if(e._renderer=r,i===void 0){const c=e._openGLRenderWindow.getSize();t.setArea(0,0,c[0]-1,c[1]-1)}else t.setArea(i,a,o,s);if(!t.captureBuffers())return!1;const l={area:[...e.area],pixBuffer:[...e.pixBuffer],captureZValues:e.captureZValues,zBuffer:e.zBuffer,props:[...e.props],fieldAssociation:e.fieldAssociation,renderer:r,openGLRenderWindow:e._openGLRenderWindow};return l.generateSelection=function(){for(var c=arguments.length,f=new Array(c),u=0;u<c;u++)f[u]=arguments[u];return F6e(l,...f)},l},t.captureBuffers=()=>{if(!e._renderer||!e._openGLRenderWindow)return XJ("Renderer and view must be set before calling Select."),!1;e._openGLRenderer=e._openGLRenderWindow.getViewNodeFor(e._renderer),e._openGLRenderWindow.getRenderable().preRender(),t.invokeEvent({type:"StartEvent"}),e.originalBackground=e._renderer.getBackgroundByReference(),e._renderer.setBackground(0,0,0,0);const r=e._openGLRenderWindow.getRenderPasses();t.beginSelection();const i=[];for(e.currentPass=oa.MIN_KNOWN_PASS;e.currentPass<=oa.MAX_KNOWN_PASS;e.currentPass++)t.passRequired(e.currentPass)&&(t.preCapturePass(e.currentPass),e.captureZValues&&e.currentPass===oa.ACTOR_PASS&&typeof r[0].requestDepth=="function"&&typeof r[0].getFramebuffer=="function"&&r[0].requestDepth(),e._openGLRenderWindow.traverseAllPasses(),t.postCapturePass(e.currentPass),t.savePixelBuffer(e.currentPass),i.push(e.currentPass));return i.forEach(a=>{e.currentPass=a,t.processPixelBuffers()}),e.currentPass=oa.MAX_KNOWN_PASS,t.endSelection(),e._renderer.setBackground(e.originalBackground),t.invokeEvent({type:"EndEvent"}),!0},t.processPixelBuffers=()=>{e.props.forEach((r,i)=>{t.isPropHit(i)&&r.processSelectorPixelBuffers(t,e.propPixels[i])})},t.passRequired=r=>{if(r===oa.ID_HIGH24){if(e.fieldAssociation===o2.FIELD_ASSOCIATION_POINTS)return e.maximumPointId>16777215;if(e.fieldAssociation===o2.FIELD_ASSOCIATION_CELLS)return e.maximumCellId>16777215}return!0},t.savePixelBuffer=r=>{if(e.pixBuffer[r]=e._openGLRenderWindow.getPixelData(e.area[0],e.area[1],e.area[2],e.area[3]),!e.rawPixBuffer[r]){const i=(e.area[2]-e.area[0]+1)*(e.area[3]-e.area[1]+1)*4;e.rawPixBuffer[r]=new Uint8Array(i),e.rawPixBuffer[r].set(e.pixBuffer[r])}if(r===oa.ACTOR_PASS){if(e.captureZValues){const i=e._openGLRenderWindow.getRenderPasses();if(typeof i[0].requestDepth=="function"&&typeof i[0].getFramebuffer=="function"){const a=i[0].getFramebuffer();a.saveCurrentBindingsAndBuffers(),a.bind(),e.zBuffer=e._openGLRenderWindow.getPixelData(e.area[0],e.area[1],e.area[2],e.area[3]),a.restorePreviousBindingsAndBuffers()}}t.buildPropHitList(e.rawPixBuffer[r])}},t.buildPropHitList=r=>{let i=0;for(let a=0;a<=e.area[3]-e.area[1];a++)for(let o=0;o<=e.area[2]-e.area[0];o++){let s=yf(o,a,r,e.area);s>0&&(s--,s in e.hitProps||(e.hitProps[s]=!0,e.propPixels[s]=[]),e.propPixels[s].push(i*4)),++i}},t.renderProp=r=>{e.currentPass===oa.ACTOR_PASS&&(t.setPropColorValueFromInt(e.props.length+Nd),e.props.push(r))},t.renderCompositeIndex=r=>{e.currentPass===oa.COMPOSITE_INDEX_PASS&&t.setPropColorValueFromInt(r+Nd)},t.renderAttributeId=r=>{r<0||(e.maxAttributeId=r>e.maxAttributeId?r:e.maxAttributeId)},t.passTypeToString=r=>ce.enumToString(oa,r),t.isPropHit=r=>!!e.hitProps[r],t.setPropColorValueFromInt=r=>{e.propColorValue[0]=r%256/255,e.propColorValue[1]=Math.floor(r/256)%256/255,e.propColorValue[2]=Math.floor(r/65536)%256/255},t.getPixelInformation=(r,i,a)=>{const o=i<0?0:i;if(o===0){if(a[0]=r[0],a[1]=r[1],r[0]<e.area[0]||r[0]>e.area[2]||r[1]<e.area[1]||r[1]>e.area[3])return null;const f=[r[0]-e.area[0],r[1]-e.area[1]],u=yf(f[0],f[1],e.pixBuffer[oa.ACTOR_PASS],e.area);if(u<=0||u-Nd>=e.props.length)return null;const d={};d.valid=!0,d.propID=u-Nd,d.prop=e.props[d.propID];let h=yf(f[0],f[1],e.pixBuffer[oa.COMPOSITE_INDEX_PASS],e.area);if((h<0||h>16777215)&&(h=0),d.compositeID=h-Nd,e.captureZValues){const m=(f[1]*(e.area[2]-e.area[0]+1)+f[0])*4;d.zValue=(256*e.zBuffer[m]+e.zBuffer[m+1])/65535,d.displayPosition=r}if(e.pixBuffer[oa.ID_LOW24]&&JJ(f[0],f[1],e.pixBuffer[oa.ID_LOW24],e.area)===0)return d;const p=yf(f[0],f[1],e.pixBuffer[oa.ID_LOW24],e.area),g=yf(f[0],f[1],e.pixBuffer[oa.ID_HIGH24],e.area);return d.attributeID=ZJ(p,g),d}const s=[r[0],r[1]],l=[0,0];let c=t.getPixelInformation(r,0,a);if(c&&c.valid)return c;for(let f=1;f<o;++f){for(let u=s[1]>f?s[1]-f:0;u<=s[1]+f;++u)if(l[1]=u,s[0]>=f&&(l[0]=s[0]-f,c=t.getPixelInformation(l,0,a),c&&c.valid)||(l[0]=s[0]+f,c=t.getPixelInformation(l,0,a),c&&c.valid))return c;for(let u=s[0]>=f?s[0]-(f-1):0;u<=s[0]+(f-1);++u)if(l[0]=u,s[1]>=f&&(l[1]=s[1]-f,c=t.getPixelInformation(l,0,a),c&&c.valid)||(l[1]=s[1]+f,c=t.getPixelInformation(l,0,a),c&&c.valid))return c}return a[0]=r[0],a[1]=r[1],null},t.generateSelection=(r,i,a,o)=>{const s=Math.floor(r),l=Math.floor(i),c=Math.floor(a),f=Math.floor(o),u=new Map,d=[0,0];for(let h=l;h<=f;h++)for(let p=s;p<=c;p++){const g=[p,h],m=t.getPixelInformation(g,0,d);if(m&&m.valid){const y=YJ(m);if(!u.has(y))u.set(y,{info:m,pixelCount:1,attributeIDs:[m.attributeID]});else{const v=u.get(y);v.pixelCount++,e.captureZValues&&m.zValue<v.info.zValue&&(v.info=m),v.attributeIDs.indexOf(m.attributeID)===-1&&v.attributeIDs.push(m.attributeID)}}}return QJ(e.fieldAssociation,u,e.captureZValues,e._renderer,e._openGLRenderWindow)},t.getRawPixelBuffer=r=>e.rawPixBuffer[r],t.getPixelBuffer=r=>e.pixBuffer[r],t.attach=(r,i)=>{e._openGLRenderWindow=r,e._renderer=i};const n=t.setArea;t.setArea=function(){return n(...arguments)?(e.area[0]=Math.floor(e.area[0]),e.area[1]=Math.floor(e.area[1]),e.area[2]=Math.floor(e.area[2]),e.area[3]=Math.floor(e.area[3]),!0):!1}}const B6e={area:void 0,currentPass:-1,propColorValue:null,props:null,maximumPointId:0,maximumCellId:0,idOffset:1};function eZ(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,B6e,n),M6e.extend(t,e,n),e.propColorValue=[0,0,0],e.props=[],e.area||(e.area=[0,0,0,0]),ce.setGetArray(t,e,["area"],4),ce.setGet(t,e,["_renderer","currentPass","_openGLRenderWindow","maximumPointId","maximumCellId"]),ce.setGetArray(t,e,["propColorValue"],3),ce.moveToProtected(t,e,["renderer","openGLRenderWindow"]),ce.event(t,e,"event"),U6e(t,e)}const $6e=ce.newInstance(eZ,"vtkOpenGLHardwareSelector");var k7={newInstance:$6e,extend:eZ,...WJ},qE={exports:{}},RV;function G6e(){return RV||(RV=1,(function(t,e){(function(n){t.exports=n()})(function(n){var r=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function i(y,v){var x=y[0],w=y[1],S=y[2],T=y[3];x+=(w&S|~w&T)+v[0]-680876936|0,x=(x<<7|x>>>25)+w|0,T+=(x&w|~x&S)+v[1]-389564586|0,T=(T<<12|T>>>20)+x|0,S+=(T&x|~T&w)+v[2]+606105819|0,S=(S<<17|S>>>15)+T|0,w+=(S&T|~S&x)+v[3]-1044525330|0,w=(w<<22|w>>>10)+S|0,x+=(w&S|~w&T)+v[4]-176418897|0,x=(x<<7|x>>>25)+w|0,T+=(x&w|~x&S)+v[5]+1200080426|0,T=(T<<12|T>>>20)+x|0,S+=(T&x|~T&w)+v[6]-1473231341|0,S=(S<<17|S>>>15)+T|0,w+=(S&T|~S&x)+v[7]-45705983|0,w=(w<<22|w>>>10)+S|0,x+=(w&S|~w&T)+v[8]+1770035416|0,x=(x<<7|x>>>25)+w|0,T+=(x&w|~x&S)+v[9]-1958414417|0,T=(T<<12|T>>>20)+x|0,S+=(T&x|~T&w)+v[10]-42063|0,S=(S<<17|S>>>15)+T|0,w+=(S&T|~S&x)+v[11]-1990404162|0,w=(w<<22|w>>>10)+S|0,x+=(w&S|~w&T)+v[12]+1804603682|0,x=(x<<7|x>>>25)+w|0,T+=(x&w|~x&S)+v[13]-40341101|0,T=(T<<12|T>>>20)+x|0,S+=(T&x|~T&w)+v[14]-1502002290|0,S=(S<<17|S>>>15)+T|0,w+=(S&T|~S&x)+v[15]+1236535329|0,w=(w<<22|w>>>10)+S|0,x+=(w&T|S&~T)+v[1]-165796510|0,x=(x<<5|x>>>27)+w|0,T+=(x&S|w&~S)+v[6]-1069501632|0,T=(T<<9|T>>>23)+x|0,S+=(T&w|x&~w)+v[11]+643717713|0,S=(S<<14|S>>>18)+T|0,w+=(S&x|T&~x)+v[0]-373897302|0,w=(w<<20|w>>>12)+S|0,x+=(w&T|S&~T)+v[5]-701558691|0,x=(x<<5|x>>>27)+w|0,T+=(x&S|w&~S)+v[10]+38016083|0,T=(T<<9|T>>>23)+x|0,S+=(T&w|x&~w)+v[15]-660478335|0,S=(S<<14|S>>>18)+T|0,w+=(S&x|T&~x)+v[4]-405537848|0,w=(w<<20|w>>>12)+S|0,x+=(w&T|S&~T)+v[9]+568446438|0,x=(x<<5|x>>>27)+w|0,T+=(x&S|w&~S)+v[14]-1019803690|0,T=(T<<9|T>>>23)+x|0,S+=(T&w|x&~w)+v[3]-187363961|0,S=(S<<14|S>>>18)+T|0,w+=(S&x|T&~x)+v[8]+1163531501|0,w=(w<<20|w>>>12)+S|0,x+=(w&T|S&~T)+v[13]-1444681467|0,x=(x<<5|x>>>27)+w|0,T+=(x&S|w&~S)+v[2]-51403784|0,T=(T<<9|T>>>23)+x|0,S+=(T&w|x&~w)+v[7]+1735328473|0,S=(S<<14|S>>>18)+T|0,w+=(S&x|T&~x)+v[12]-1926607734|0,w=(w<<20|w>>>12)+S|0,x+=(w^S^T)+v[5]-378558|0,x=(x<<4|x>>>28)+w|0,T+=(x^w^S)+v[8]-2022574463|0,T=(T<<11|T>>>21)+x|0,S+=(T^x^w)+v[11]+1839030562|0,S=(S<<16|S>>>16)+T|0,w+=(S^T^x)+v[14]-35309556|0,w=(w<<23|w>>>9)+S|0,x+=(w^S^T)+v[1]-1530992060|0,x=(x<<4|x>>>28)+w|0,T+=(x^w^S)+v[4]+1272893353|0,T=(T<<11|T>>>21)+x|0,S+=(T^x^w)+v[7]-155497632|0,S=(S<<16|S>>>16)+T|0,w+=(S^T^x)+v[10]-1094730640|0,w=(w<<23|w>>>9)+S|0,x+=(w^S^T)+v[13]+681279174|0,x=(x<<4|x>>>28)+w|0,T+=(x^w^S)+v[0]-358537222|0,T=(T<<11|T>>>21)+x|0,S+=(T^x^w)+v[3]-722521979|0,S=(S<<16|S>>>16)+T|0,w+=(S^T^x)+v[6]+76029189|0,w=(w<<23|w>>>9)+S|0,x+=(w^S^T)+v[9]-640364487|0,x=(x<<4|x>>>28)+w|0,T+=(x^w^S)+v[12]-421815835|0,T=(T<<11|T>>>21)+x|0,S+=(T^x^w)+v[15]+530742520|0,S=(S<<16|S>>>16)+T|0,w+=(S^T^x)+v[2]-995338651|0,w=(w<<23|w>>>9)+S|0,x+=(S^(w|~T))+v[0]-198630844|0,x=(x<<6|x>>>26)+w|0,T+=(w^(x|~S))+v[7]+1126891415|0,T=(T<<10|T>>>22)+x|0,S+=(x^(T|~w))+v[14]-1416354905|0,S=(S<<15|S>>>17)+T|0,w+=(T^(S|~x))+v[5]-57434055|0,w=(w<<21|w>>>11)+S|0,x+=(S^(w|~T))+v[12]+1700485571|0,x=(x<<6|x>>>26)+w|0,T+=(w^(x|~S))+v[3]-1894986606|0,T=(T<<10|T>>>22)+x|0,S+=(x^(T|~w))+v[10]-1051523|0,S=(S<<15|S>>>17)+T|0,w+=(T^(S|~x))+v[1]-2054922799|0,w=(w<<21|w>>>11)+S|0,x+=(S^(w|~T))+v[8]+1873313359|0,x=(x<<6|x>>>26)+w|0,T+=(w^(x|~S))+v[15]-30611744|0,T=(T<<10|T>>>22)+x|0,S+=(x^(T|~w))+v[6]-1560198380|0,S=(S<<15|S>>>17)+T|0,w+=(T^(S|~x))+v[13]+1309151649|0,w=(w<<21|w>>>11)+S|0,x+=(S^(w|~T))+v[4]-145523070|0,x=(x<<6|x>>>26)+w|0,T+=(w^(x|~S))+v[11]-1120210379|0,T=(T<<10|T>>>22)+x|0,S+=(x^(T|~w))+v[2]+718787259|0,S=(S<<15|S>>>17)+T|0,w+=(T^(S|~x))+v[9]-343485551|0,w=(w<<21|w>>>11)+S|0,y[0]=x+y[0]|0,y[1]=w+y[1]|0,y[2]=S+y[2]|0,y[3]=T+y[3]|0}function a(y){var v=[],x;for(x=0;x<64;x+=4)v[x>>2]=y.charCodeAt(x)+(y.charCodeAt(x+1)<<8)+(y.charCodeAt(x+2)<<16)+(y.charCodeAt(x+3)<<24);return v}function o(y){var v=[],x;for(x=0;x<64;x+=4)v[x>>2]=y[x]+(y[x+1]<<8)+(y[x+2]<<16)+(y[x+3]<<24);return v}function s(y){var v=y.length,x=[1732584193,-271733879,-1732584194,271733878],w,S,T,_,D,I;for(w=64;w<=v;w+=64)i(x,a(y.substring(w-64,w)));for(y=y.substring(w-64),S=y.length,T=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],w=0;w<S;w+=1)T[w>>2]|=y.charCodeAt(w)<<(w%4<<3);if(T[w>>2]|=128<<(w%4<<3),w>55)for(i(x,T),w=0;w<16;w+=1)T[w]=0;return _=v*8,_=_.toString(16).match(/(.*?)(.{0,8})$/),D=parseInt(_[2],16),I=parseInt(_[1],16)||0,T[14]=D,T[15]=I,i(x,T),x}function l(y){var v=y.length,x=[1732584193,-271733879,-1732584194,271733878],w,S,T,_,D,I;for(w=64;w<=v;w+=64)i(x,o(y.subarray(w-64,w)));for(y=w-64<v?y.subarray(w-64):new Uint8Array(0),S=y.length,T=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],w=0;w<S;w+=1)T[w>>2]|=y[w]<<(w%4<<3);if(T[w>>2]|=128<<(w%4<<3),w>55)for(i(x,T),w=0;w<16;w+=1)T[w]=0;return _=v*8,_=_.toString(16).match(/(.*?)(.{0,8})$/),D=parseInt(_[2],16),I=parseInt(_[1],16)||0,T[14]=D,T[15]=I,i(x,T),x}function c(y){var v="",x;for(x=0;x<4;x+=1)v+=r[y>>x*8+4&15]+r[y>>x*8&15];return v}function f(y){var v;for(v=0;v<y.length;v+=1)y[v]=c(y[v]);return y.join("")}f(s("hello")),typeof ArrayBuffer<"u"&&!ArrayBuffer.prototype.slice&&(function(){function y(v,x){return v=v|0||0,v<0?Math.max(v+x,0):Math.min(v,x)}ArrayBuffer.prototype.slice=function(v,x){var w=this.byteLength,S=y(v,w),T=w,_,D,I,R;return x!==n&&(T=y(x,w)),S>T?new ArrayBuffer(0):(_=T-S,D=new ArrayBuffer(_),I=new Uint8Array(D),R=new Uint8Array(this,S,_),I.set(R),D)}})();function u(y){return/[\u0080-\uFFFF]/.test(y)&&(y=unescape(encodeURIComponent(y))),y}function d(y,v){var x=y.length,w=new ArrayBuffer(x),S=new Uint8Array(w),T;for(T=0;T<x;T+=1)S[T]=y.charCodeAt(T);return v?S:w}function h(y){return String.fromCharCode.apply(null,new Uint8Array(y))}function p(y,v,x){var w=new Uint8Array(y.byteLength+v.byteLength);return w.set(new Uint8Array(y)),w.set(new Uint8Array(v),y.byteLength),w}function g(y){var v=[],x=y.length,w;for(w=0;w<x-1;w+=2)v.push(parseInt(y.substr(w,2),16));return String.fromCharCode.apply(String,v)}function m(){this.reset()}return m.prototype.append=function(y){return this.appendBinary(u(y)),this},m.prototype.appendBinary=function(y){this._buff+=y,this._length+=y.length;var v=this._buff.length,x;for(x=64;x<=v;x+=64)i(this._hash,a(this._buff.substring(x-64,x)));return this._buff=this._buff.substring(x-64),this},m.prototype.end=function(y){var v=this._buff,x=v.length,w,S=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],T;for(w=0;w<x;w+=1)S[w>>2]|=v.charCodeAt(w)<<(w%4<<3);return this._finish(S,x),T=f(this._hash),y&&(T=g(T)),this.reset(),T},m.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},m.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash.slice()}},m.prototype.setState=function(y){return this._buff=y.buff,this._length=y.length,this._hash=y.hash,this},m.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},m.prototype._finish=function(y,v){var x=v,w,S,T;if(y[x>>2]|=128<<(x%4<<3),x>55)for(i(this._hash,y),x=0;x<16;x+=1)y[x]=0;w=this._length*8,w=w.toString(16).match(/(.*?)(.{0,8})$/),S=parseInt(w[2],16),T=parseInt(w[1],16)||0,y[14]=S,y[15]=T,i(this._hash,y)},m.hash=function(y,v){return m.hashBinary(u(y),v)},m.hashBinary=function(y,v){var x=s(y),w=f(x);return v?g(w):w},m.ArrayBuffer=function(){this.reset()},m.ArrayBuffer.prototype.append=function(y){var v=p(this._buff.buffer,y),x=v.length,w;for(this._length+=y.byteLength,w=64;w<=x;w+=64)i(this._hash,o(v.subarray(w-64,w)));return this._buff=w-64<x?new Uint8Array(v.buffer.slice(w-64)):new Uint8Array(0),this},m.ArrayBuffer.prototype.end=function(y){var v=this._buff,x=v.length,w=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],S,T;for(S=0;S<x;S+=1)w[S>>2]|=v[S]<<(S%4<<3);return this._finish(w,x),T=f(this._hash),y&&(T=g(T)),this.reset(),T},m.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},m.ArrayBuffer.prototype.getState=function(){var y=m.prototype.getState.call(this);return y.buff=h(y.buff),y},m.ArrayBuffer.prototype.setState=function(y){return y.buff=d(y.buff,!0),m.prototype.setState.call(this,y)},m.ArrayBuffer.prototype.destroy=m.prototype.destroy,m.ArrayBuffer.prototype._finish=m.prototype._finish,m.ArrayBuffer.hash=function(y,v){var x=l(new Uint8Array(y)),w=f(x);return v?g(w):w},m})})(qE)),qE.exports}var j6e=G6e();const z6e=sl(j6e),W6e=["lastShaderProgramBound","context","_openGLRenderWindow"];function H6e(t,e){e.classHierarchy.push("vtkShaderCache"),t.replaceShaderValues=(n,r,i)=>{let a=r;i.length>0&&(a=$e.substitute(a,"VSOut","GSOut").result);const o=e._openGLRenderWindow.getWebgl2();let s=`
`,l=`#version 100
`;o?l=`#version 300 es
#define attribute in
#define textureCube texture
#define texture2D texture
#define textureCubeLod textureLod
#define texture2DLod textureLod
`:(e.context.getExtension("OES_standard_derivatives"),e.context.getExtension("EXT_frag_depth")&&(s=`#extension GL_EXT_frag_depth : enable
`),e.context.getExtension("EXT_shader_texture_lod")&&(s+=`#extension GL_EXT_shader_texture_lod : enable
#define textureCubeLod textureCubeLodEXT
#define texture2DLod texture2DLodEXT`)),a=$e.substitute(a,"//VTK::System::Dec",[`${l}
`,o?"":`#extension GL_OES_standard_derivatives : enable
`,s,"#ifdef GL_FRAGMENT_PRECISION_HIGH","precision highp float;","precision highp int;","#else","precision mediump float;","precision mediump int;","#endif"]).result;let c=$e.substitute(n,"//VTK::System::Dec",[`${l}
`,"#ifdef GL_FRAGMENT_PRECISION_HIGH","precision highp float;","precision highp int;","#else","precision mediump float;","precision mediump int;","#endif"]).result;if(o){c=$e.substitute(c,"varying","out").result,a=$e.substitute(a,"varying","in").result;let u="",d=0;for(;a.includes(`gl_FragData[${d}]`);)a=$e.substitute(a,`gl_FragData\\[${d}\\]`,`fragOutput${d}`).result,u+=`layout(location = ${d}) out vec4 fragOutput${d};
`,d++;a=$e.substitute(a,"//VTK::Output::Dec",u).result}const f=$e.substitute(i,"//VTK::System::Dec",l).result;return{VSSource:c,FSSource:a,GSSource:f}},t.readyShaderProgramArray=(n,r,i)=>{const a=t.replaceShaderValues(n,r,i),o=t.getShaderProgram(a.VSSource,a.FSSource,a.GSSource);return t.readyShaderProgram(o)},t.readyShaderProgram=n=>!n||!n.getCompiled()&&!n.compileShader()||!t.bindShaderProgram(n)?null:n,t.getShaderProgram=(n,r,i)=>{const a=`${n}${r}${i}`,o=z6e.hash(a);if(!(o in e.shaderPrograms)){const s=$e.newInstance();return s.setContext(e.context),s.getVertexShader().setSource(n),s.getFragmentShader().setSource(r),i&&s.getGeometryShader().setSource(i),s.setMd5Hash(o),e.shaderPrograms[o]=s,s}return e.shaderPrograms[o]},t.releaseGraphicsResources=n=>{t.releaseCurrentShaderProgram(),Object.keys(e.shaderPrograms).map(r=>e.shaderPrograms[r]).forEach(r=>r.cleanup()),e.shaderPrograms={}},t.releaseCurrentShaderProgram=()=>{e.lastShaderProgramBound&&(e.lastShaderProgramBound.cleanup(),e.lastShaderProgramBound=null)},t.bindShaderProgram=n=>(e.lastShaderProgramBound===n||(e.lastShaderProgramBound&&e.lastShaderProgramBound.release(),n.bind(),e.lastShaderProgramBound=n),1)}const K6e={lastShaderProgramBound:null,shaderPrograms:null,context:null};function tZ(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,K6e,n),e.shaderPrograms={},ce.obj(t,e),ce.setGet(t,e,W6e),ce.moveToProtected(t,e,["openGLRenderWindow"]),H6e(t,e)}const q6e=ce.newInstance(tZ,"vtkShaderCache");var X6e={newInstance:q6e,extend:tZ};const{vtkErrorMacro:Y6e}=ce;function J6e(t,e){e.classHierarchy.push("vtkOpenGLTextureUnitManager"),t.deleteTable=()=>{for(let n=0;n<e.numberOfTextureUnits;++n)e.textureUnits[n]===!0&&Y6e("some texture units  were not properly released");e.textureUnits=[],e.numberOfTextureUnits=0},t.setContext=n=>{if(e.context!==n){if(e.context!==0&&t.deleteTable(),e.context=n,e.context){e.numberOfTextureUnits=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS);for(let r=0;r<e.numberOfTextureUnits;++r)e.textureUnits[r]=!1}t.modified()}},t.allocate=()=>{for(let n=0;n<e.numberOfTextureUnits;n++)if(!t.isAllocated(n))return e.textureUnits[n]=!0,n;return-1},t.allocateUnit=n=>t.isAllocated(n)?-1:(e.textureUnits[n]=!0,n),t.isAllocated=n=>e.textureUnits[n],t.free=n=>{e.textureUnits[n]=!1},t.freeAll=()=>{for(let n=0;n<e.numberOfTextureUnits;++n)e.textureUnits[n]=!1}}const Z6e={context:null,numberOfTextureUnits:0,textureUnits:0};function nZ(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Z6e,n),ce.obj(t,e),e.textureUnits=[],ce.get(t,e,["numberOfTextureUnits"]),ce.setGet(t,e,["context"]),J6e(t,e)}const Q6e=ce.newInstance(nZ,"vtkOpenGLTextureUnitManager");var e_e={newInstance:Q6e,extend:nZ};function t_e(t,e){e.classHierarchy.push("vtkRenderWindowViewNode"),t.getViewNodeFactory=()=>null,t.getAspectRatio=()=>e.size[0]/e.size[1],t.getAspectRatioForRenderer=n=>{const r=n.getViewportByReference();return e.size[0]*(r[2]-r[0])/((r[3]-r[1])*e.size[1])},t.isInViewport=(n,r,i)=>{const a=i.getViewportByReference(),o=t.getFramebufferSize();return a[0]*o[0]<=n&&a[2]*o[0]>=n&&a[1]*o[1]<=r&&a[3]*o[1]>=r},t.getViewportSize=n=>{const r=n.getViewportByReference(),i=t.getFramebufferSize();return[(r[2]-r[0])*i[0],(r[3]-r[1])*i[1]]},t.getViewportCenter=n=>{const r=t.getViewportSize(n);return[r[0]*.5,r[1]*.5]},t.displayToNormalizedDisplay=(n,r,i)=>{const a=t.getFramebufferSize();return[n/a[0],r/a[1],i]},t.normalizedDisplayToDisplay=(n,r,i)=>{const a=t.getFramebufferSize();return[n*a[0],r*a[1],i]},t.worldToView=(n,r,i,a)=>a.worldToView(n,r,i),t.viewToWorld=(n,r,i,a)=>a.viewToWorld(n,r,i),t.worldToDisplay=(n,r,i,a)=>{const o=a.worldToView(n,r,i),s=t.getViewportSize(a),l=a.viewToProjection(o[0],o[1],o[2],s[0]/s[1]),c=a.projectionToNormalizedDisplay(l[0],l[1],l[2]);return t.normalizedDisplayToDisplay(c[0],c[1],c[2])},t.displayToWorld=(n,r,i,a)=>{const o=t.displayToNormalizedDisplay(n,r,i),s=a.normalizedDisplayToProjection(o[0],o[1],o[2]),l=t.getViewportSize(a),c=a.projectionToView(s[0],s[1],s[2],l[0]/l[1]);return a.viewToWorld(c[0],c[1],c[2])},t.normalizedDisplayToViewport=(n,r,i,a)=>{let o=a.getViewportByReference();o=t.normalizedDisplayToDisplay(o[0],o[1],0);const s=t.normalizedDisplayToDisplay(n,r,i);return[s[0]-o[0]-.5,s[1]-o[1]-.5,i]},t.viewportToNormalizedViewport=(n,r,i,a)=>{const o=t.getViewportSize(a);return o&&o[0]!==0&&o[1]!==0?[n/(o[0]-1),r/(o[1]-1),i]:[n,r,i]},t.normalizedViewportToViewport=(n,r,i,a)=>{const o=t.getViewportSize(a);return[n*(o[0]-1),r*(o[1]-1),i]},t.displayToLocalDisplay=(n,r,i)=>{const a=t.getFramebufferSize();return[n,a[1]-r-1,i]},t.viewportToNormalizedDisplay=(n,r,i,a)=>{let o=a.getViewportByReference();o=t.normalizedDisplayToDisplay(o[0],o[1],0);const s=n+o[0]+.5,l=r+o[1]+.5;return t.displayToNormalizedDisplay(s,l,i)},t.getComputedDevicePixelRatio=()=>e.size[0]/t.getContainerSize()[0],t.getContainerSize=()=>{ce.vtkErrorMacro("not implemented")},t.getPixelData=(n,r,i,a)=>{ce.vtkErrorMacro("not implemented")},t.createSelector=()=>{ce.vtkErrorMacro("not implemented")}}const n_e={size:void 0,selector:void 0};function rZ(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,n_e,n),e.size||(e.size=[300,300]),ce.getArray(t,e,["size"],2),ce.get(t,e,["selector"]),kr.extend(t,e,n),t_e(t,e)}const r_e=ce.newInstance(rZ,"vtkRenderWindowViewNode");var i_e={newInstance:r_e,extend:rZ};const a_e="__getUnderlyingContext";function o_e(){const t=new Map,e={apply(i,a,o){return t.has(o[0])?t.get(o[0]):i.apply(a,o)}};function n(i){return{apply(a,o,s){return t.set(i,s[0]),a.apply(o,s)}}}const r=Object.create(null);return r.getParameter=(i,a,o,s)=>new Proxy(s.bind(i),e),r.depthMask=(i,a,o,s)=>new Proxy(s.bind(i),n(i.DEPTH_WRITEMASK)),{get(i,a,o){if(a===a_e)return()=>i;let s=Reflect.get(i,a,i);s instanceof Function&&(s=s.bind(i));const l=r[a];return l?l(i,a,o,s):s}}}const{vtkDebugMacro:PV,vtkErrorMacro:AV}=ce,s_e={position:"absolute",top:0,left:0,width:"100%",height:"100%"},l_e=["activateTexture","deactivateTexture","disableCullFace","enableCullFace","get3DContext","getActiveFramebuffer","getContext","getDefaultTextureByteSize","getDefaultTextureInternalFormat","getDefaultToWebgl2","getGLInformations","getGraphicsMemoryInfo","getGraphicsResourceForObject","getHardwareMaximumLineWidth","getPixelData","getShaderCache","getTextureUnitForTexture","getTextureUnitManager","getWebgl2","makeCurrent","releaseGraphicsResources","registerGraphicsResourceUser","unregisterGraphicsResourceUser","restoreContext","setActiveFramebuffer","setContext","setDefaultToWebgl2","setGraphicsResourceForObject"];function Xo(t,e,n){const r=t.createFramebuffer(),i=t.createTexture();t.bindTexture(t.TEXTURE_2D,i),t.texImage2D(t.TEXTURE_2D,0,e,2,2,0,e,n,null),t.bindFramebuffer(t.FRAMEBUFFER,r),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,i,0);const a=t.checkFramebufferStatus(t.FRAMEBUFFER);return t.bindFramebuffer(t.FRAMEBUFFER,null),t.bindTexture(t.TEXTURE_2D,null),a===t.FRAMEBUFFER_COMPLETE}let h3=0;const qC=[];function c_e(){h3++,qC.forEach(t=>t(h3))}function u_e(){h3--,qC.forEach(t=>t(h3))}function f_e(t){qC.push(t)}function d_e(t){return qC.pop()}function NV(t){t.preventDefault()}function h_e(t,e){e.classHierarchy.push("vtkOpenGLRenderWindow");let n;function r(){return n||(n=o_e()),n}t.getViewNodeFactory=()=>e.myFactory,e.canvas.addEventListener("webglcontextlost",NV,!1),e.canvas.addEventListener("webglcontextrestored",t.restoreContext,!1);const i=[0,0];function a(){e.renderable&&(e.size[0]!==i[0]||e.size[1]!==i[1])&&(i[0]=e.size[0],i[1]=e.size[1],e.canvas.setAttribute("width",e.size[0]),e.canvas.setAttribute("height",e.size[1])),e.viewStream&&e.viewStream.setSize(e.size[0],e.size[1]),e.canvas.style.display=e.useOffScreen?"none":"block",e.el&&(e.el.style.cursor=e.cursorVisibility?e.cursor:"none"),e.containerSize=null}t.onModified(a),t.buildPass=u=>{if(u){if(!e.renderable)return;t.prepareNodes(),t.addMissingNodes(e.renderable.getRenderersByReference()),t.addMissingNodes(e.renderable.getChildRenderWindowsByReference()),t.removeUnusedNodes(),t.initialize(),e.children.forEach(d=>{d.setOpenGLRenderWindow?.(t)})}},t.initialize=()=>{if(!e.initialized){if(e.rootOpenGLRenderWindow=t.getLastAncestorOfType("vtkOpenGLRenderWindow"),e.rootOpenGLRenderWindow)e.context2D=t.get2DContext();else{e.context=t.get3DContext(),t.resizeFromChildRenderWindows(),e.context&&c_e(),e.textureUnitManager=e_e.newInstance(),e.textureUnitManager.setContext(e.context),e.shaderCache.setContext(e.context);const u=e.context;u.blendFuncSeparate(u.SRC_ALPHA,u.ONE_MINUS_SRC_ALPHA,u.ONE,u.ONE_MINUS_SRC_ALPHA),u.depthFunc(u.LEQUAL),u.enable(u.BLEND)}e.initialized=!0}},t.makeCurrent=()=>{e.context.makeCurrent()},t.setContainer=u=>{e.el&&e.el!==u&&(e.canvas.parentNode!==e.el&&AV("Error: canvas parent node does not match container"),e.el.removeChild(e.canvas),e.el.contains(e.bgImage)&&e.el.removeChild(e.bgImage)),e.el!==u&&(e.el=u,e.el&&(e.el.appendChild(e.canvas),e.useBackgroundImage&&e.el.appendChild(e.bgImage)),t.modified())},t.getContainer=()=>e.el,t.getContainerSize=()=>{if(!e.containerSize&&e.el){const{width:u,height:d}=e.el.getBoundingClientRect();e.containerSize=[u,d]}return e.containerSize||e.size},t.getFramebufferSize=()=>e.activeFramebuffer?.getSize()||e.size,t.getPixelData=(u,d,h,p)=>{const g=new Uint8Array((h-u+1)*(p-d+1)*4);return e.context.readPixels(u,d,h-u+1,p-d+1,e.context.RGBA,e.context.UNSIGNED_BYTE,g),g},t.get3DContext=function(){let u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{preserveDrawingBuffer:!1,depth:!0,alpha:!0,powerPreference:"high-performance"},d=null;const h=typeof WebGL2RenderingContext<"u";return e.webgl2=!1,e.defaultToWebgl2&&h&&(d=e.canvas.getContext("webgl2",u),d&&(e.webgl2=!0,PV("using webgl2"))),d||(PV("using webgl1"),d=e.canvas.getContext("webgl",u)||e.canvas.getContext("experimental-webgl",u)),new Proxy(d,r())},t.get2DContext=function(){let u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e.canvas.getContext("2d",u)},t.restoreContext=()=>{const u=L7.newInstance();u.setCurrentOperation("Release"),u.traverse(t,null)},t.activateTexture=u=>{const d=e._textureResourceIds.get(u);if(d!==void 0){e.context.activeTexture(e.context.TEXTURE0+d);return}const h=t.getTextureUnitManager().allocate();if(h<0){AV("Hardware does not support the number of textures defined.");return}e._textureResourceIds.set(u,h),e.context.activeTexture(e.context.TEXTURE0+h)},t.deactivateTexture=u=>{const d=e._textureResourceIds.get(u);d!==void 0&&(t.getTextureUnitManager().free(d),e._textureResourceIds.delete(u))},t.getTextureUnitForTexture=u=>{const d=e._textureResourceIds.get(u);return d!==void 0?d:-1},t.getDefaultTextureByteSize=function(u){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(e.webgl2)switch(u){case Ln.CHAR:case Ln.SIGNED_CHAR:case Ln.UNSIGNED_CHAR:return 1;case d:case h:case Ln.UNSIGNED_SHORT:case Ln.SHORT:case Ln.VOID:return 2;default:return 4}return 1},t.getDefaultTextureInternalFormat=function(u,d){let h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,p=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(e.webgl2)switch(u){case Ln.UNSIGNED_CHAR:switch(d){case 1:return e.context.R8;case 2:return e.context.RG8;case 3:return e.context.RGB8;case 4:default:return e.context.RGBA8}case(h&&!p&&Ln.UNSIGNED_SHORT):switch(d){case 1:return h.R16_EXT;case 2:return h.RG16_EXT;case 3:return h.RGB16_EXT;case 4:default:return h.RGBA16_EXT}case(h&&!p&&Ln.SHORT):switch(d){case 1:return h.R16_SNORM_EXT;case 2:return h.RG16_SNORM_EXT;case 3:return h.RGB16_SNORM_EXT;case 4:default:return h.RGBA16_SNORM_EXT}case Ln.UNSIGNED_SHORT:case Ln.SHORT:case Ln.FLOAT:default:switch(d){case 1:return p?e.context.R16F:e.context.R32F;case 2:return p?e.context.RG16F:e.context.RG32F;case 3:return p?e.context.RGB16F:e.context.RGB32F;case 4:default:return p?e.context.RGBA16F:e.context.RGBA32F}}switch(d){case 1:return e.context.LUMINANCE;case 2:return e.context.LUMINANCE_ALPHA;case 3:return e.context.RGB;case 4:default:return e.context.RGBA}},t.setBackgroundImage=u=>{e.bgImage.src=u.src},t.setUseBackgroundImage=u=>{e.useBackgroundImage=u,e.useBackgroundImage&&!e.el.contains(e.bgImage)?e.el.appendChild(e.bgImage):!e.useBackgroundImage&&e.el.contains(e.bgImage)&&e.el.removeChild(e.bgImage)};function o(){let u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:e.imageFormat;const d=document.createElement("canvas"),h=d.getContext("2d");d.width=e.canvas.width,d.height=e.canvas.height,h.drawImage(e.canvas,0,0);const p=e.canvas.getBoundingClientRect();e.renderable.getRenderers().forEach(v=>{v.getViewProps().forEach(w=>{if(w.getContainer){const T=w.getContainer().getElementsByTagName("canvas");for(let _=0;_<T.length;_++){const D=T[_],I=D.getBoundingClientRect(),R=I.x-p.x,O=I.y-p.y;h.drawImage(D,R,O)}}})});const y=d.toDataURL(u);d.remove(),t.invokeImageReady(y)}t.captureNextImage=function(){let u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"image/png",{resetCamera:d=!1,size:h=null,scale:p=1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e.deleted)return null;e.imageFormat=u;const g=e.notifyStartCaptureImage;return e.notifyStartCaptureImage=!0,e._screenshot={size:h||p!==1?h||e.size.map(m=>m*p):null},new Promise((m,y)=>{const v=t.onImageReady(x=>{if(e._screenshot.size===null)e.notifyStartCaptureImage=g,v.unsubscribe(),e._screenshot.placeHolder&&(e.size=e._screenshot.originalSize,t.modified(),e._screenshot.cameras&&e._screenshot.cameras.forEach(w=>{let{restoreParamsFn:S,arg:T}=w;return S(T)}),t.traverseAllPasses(),e.el.removeChild(e._screenshot.placeHolder),e._screenshot.placeHolder.remove(),e._screenshot=null),m(x);else{const w=document.createElement("img");if(w.style=s_e,w.src=x,e._screenshot.placeHolder=e.el.appendChild(w),e.canvas.style.display="none",e._screenshot.originalSize=e.size,e.size=e._screenshot.size,e.rootOpenGLRenderWindow?.resizeFromChildRenderWindows(),e._screenshot.size=null,t.modified(),d){const S=d!==!0;e._screenshot.cameras=e.renderable.getRenderers().map(T=>{const _=T.getActiveCamera(),D=_.get("focalPoint","position","parallelScale");return{resetCameraArgs:S?{renderer:T}:void 0,resetCameraFn:S?d:T.resetCamera,restoreParamsFn:_.set,arg:JSON.parse(JSON.stringify(D))}}),e._screenshot.cameras.forEach(T=>{let{resetCameraFn:_,resetCameraArgs:D}=T;return _(D)})}t.traverseAllPasses()}})})};let s;t.getHardwareMaximumLineWidth=()=>{if(s!=null)return s;const u=t.get3DContext(),d=u.getParameter(u.ALIASED_LINE_WIDTH_RANGE);return s=d[1],d[1]},t.getGLInformations=()=>{if(e._glInformation)return e._glInformation;const u=t.get3DContext(),d=u.getExtension("OES_texture_float"),h=u.getExtension("OES_texture_half_float"),p=u.getExtension("WEBGL_debug_renderer_info"),g=u.getExtension("WEBGL_draw_buffers"),m=u.getExtension("EXT_texture_filter_anisotropic")||u.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),y=[["Max Vertex Attributes","MAX_VERTEX_ATTRIBS",u.getParameter(u.MAX_VERTEX_ATTRIBS)],["Max Varying Vectors","MAX_VARYING_VECTORS",u.getParameter(u.MAX_VARYING_VECTORS)],["Max Vertex Uniform Vectors","MAX_VERTEX_UNIFORM_VECTORS",u.getParameter(u.MAX_VERTEX_UNIFORM_VECTORS)],["Max Fragment Uniform Vectors","MAX_FRAGMENT_UNIFORM_VECTORS",u.getParameter(u.MAX_FRAGMENT_UNIFORM_VECTORS)],["Max Fragment Texture Image Units","MAX_TEXTURE_IMAGE_UNITS",u.getParameter(u.MAX_TEXTURE_IMAGE_UNITS)],["Max Vertex Texture Image Units","MAX_VERTEX_TEXTURE_IMAGE_UNITS",u.getParameter(u.MAX_VERTEX_TEXTURE_IMAGE_UNITS)],["Max Combined Texture Image Units","MAX_COMBINED_TEXTURE_IMAGE_UNITS",u.getParameter(u.MAX_COMBINED_TEXTURE_IMAGE_UNITS)],["Max 2D Texture Size","MAX_TEXTURE_SIZE",u.getParameter(u.MAX_TEXTURE_SIZE)],["Max Cube Texture Size","MAX_CUBE_MAP_TEXTURE_SIZE",u.getParameter(u.MAX_CUBE_MAP_TEXTURE_SIZE)],["Max Texture Anisotropy","MAX_TEXTURE_MAX_ANISOTROPY_EXT",m&&u.getParameter(m.MAX_TEXTURE_MAX_ANISOTROPY_EXT)],["Point Size Range","ALIASED_POINT_SIZE_RANGE",u.getParameter(u.ALIASED_POINT_SIZE_RANGE).join(" - ")],["Line Width Range","ALIASED_LINE_WIDTH_RANGE",u.getParameter(u.ALIASED_LINE_WIDTH_RANGE).join(" - ")],["Max Viewport Dimensions","MAX_VIEWPORT_DIMS",u.getParameter(u.MAX_VIEWPORT_DIMS).join(" - ")],["Max Renderbuffer Size","MAX_RENDERBUFFER_SIZE",u.getParameter(u.MAX_RENDERBUFFER_SIZE)],["Framebuffer Red Bits","RED_BITS",u.getParameter(u.RED_BITS)],["Framebuffer Green Bits","GREEN_BITS",u.getParameter(u.GREEN_BITS)],["Framebuffer Blue Bits","BLUE_BITS",u.getParameter(u.BLUE_BITS)],["Framebuffer Alpha Bits","ALPHA_BITS",u.getParameter(u.ALPHA_BITS)],["Framebuffer Depth Bits","DEPTH_BITS",u.getParameter(u.DEPTH_BITS)],["Framebuffer Stencil Bits","STENCIL_BITS",u.getParameter(u.STENCIL_BITS)],["Framebuffer Subpixel Bits","SUBPIXEL_BITS",u.getParameter(u.SUBPIXEL_BITS)],["MSAA Samples","SAMPLES",u.getParameter(u.SAMPLES)],["MSAA Sample Buffers","SAMPLE_BUFFERS",u.getParameter(u.SAMPLE_BUFFERS)],["Supported Formats for UByte Render Targets     ","UNSIGNED_BYTE RENDER TARGET FORMATS",[d&&Xo(u,u.RGBA,u.UNSIGNED_BYTE)?"RGBA":"",d&&Xo(u,u.RGB,u.UNSIGNED_BYTE)?"RGB":"",d&&Xo(u,u.LUMINANCE,u.UNSIGNED_BYTE)?"LUMINANCE":"",d&&Xo(u,u.ALPHA,u.UNSIGNED_BYTE)?"ALPHA":"",d&&Xo(u,u.LUMINANCE_ALPHA,u.UNSIGNED_BYTE)?"LUMINANCE_ALPHA":""].join(" ")],["Supported Formats for Half Float Render Targets","HALF FLOAT RENDER TARGET FORMATS",[h&&Xo(u,u.RGBA,h.HALF_FLOAT_OES)?"RGBA":"",h&&Xo(u,u.RGB,h.HALF_FLOAT_OES)?"RGB":"",h&&Xo(u,u.LUMINANCE,h.HALF_FLOAT_OES)?"LUMINANCE":"",h&&Xo(u,u.ALPHA,h.HALF_FLOAT_OES)?"ALPHA":"",h&&Xo(u,u.LUMINANCE_ALPHA,h.HALF_FLOAT_OES)?"LUMINANCE_ALPHA":""].join(" ")],["Supported Formats for Full Float Render Targets","FLOAT RENDER TARGET FORMATS",[d&&Xo(u,u.RGBA,u.FLOAT)?"RGBA":"",d&&Xo(u,u.RGB,u.FLOAT)?"RGB":"",d&&Xo(u,u.LUMINANCE,u.FLOAT)?"LUMINANCE":"",d&&Xo(u,u.ALPHA,u.FLOAT)?"ALPHA":"",d&&Xo(u,u.LUMINANCE_ALPHA,u.FLOAT)?"LUMINANCE_ALPHA":""].join(" ")],["Max Multiple Render Targets Buffers","MAX_DRAW_BUFFERS_WEBGL",g?u.getParameter(g.MAX_DRAW_BUFFERS_WEBGL):0],["High Float Precision in Vertex Shader","HIGH_FLOAT VERTEX_SHADER",[u.getShaderPrecisionFormat(u.VERTEX_SHADER,u.HIGH_FLOAT).precision," (-2<sup>",u.getShaderPrecisionFormat(u.VERTEX_SHADER,u.HIGH_FLOAT).rangeMin,"</sup> - 2<sup>",u.getShaderPrecisionFormat(u.VERTEX_SHADER,u.HIGH_FLOAT).rangeMax,"</sup>)"].join("")],["Medium Float Precision in Vertex Shader","MEDIUM_FLOAT VERTEX_SHADER",[u.getShaderPrecisionFormat(u.VERTEX_SHADER,u.MEDIUM_FLOAT).precision," (-2<sup>",u.getShaderPrecisionFormat(u.VERTEX_SHADER,u.MEDIUM_FLOAT).rangeMin,"</sup> - 2<sup>",u.getShaderPrecisionFormat(u.VERTEX_SHADER,u.MEDIUM_FLOAT).rangeMax,"</sup>)"].join("")],["Low Float Precision in Vertex Shader","LOW_FLOAT VERTEX_SHADER",[u.getShaderPrecisionFormat(u.VERTEX_SHADER,u.LOW_FLOAT).precision," (-2<sup>",u.getShaderPrecisionFormat(u.VERTEX_SHADER,u.LOW_FLOAT).rangeMin,"</sup> - 2<sup>",u.getShaderPrecisionFormat(u.VERTEX_SHADER,u.LOW_FLOAT).rangeMax,"</sup>)"].join("")],["High Float Precision in Fragment Shader","HIGH_FLOAT FRAGMENT_SHADER",[u.getShaderPrecisionFormat(u.FRAGMENT_SHADER,u.HIGH_FLOAT).precision," (-2<sup>",u.getShaderPrecisionFormat(u.FRAGMENT_SHADER,u.HIGH_FLOAT).rangeMin,"</sup> - 2<sup>",u.getShaderPrecisionFormat(u.FRAGMENT_SHADER,u.HIGH_FLOAT).rangeMax,"</sup>)"].join("")],["Medium Float Precision in Fragment Shader","MEDIUM_FLOAT FRAGMENT_SHADER",[u.getShaderPrecisionFormat(u.FRAGMENT_SHADER,u.MEDIUM_FLOAT).precision," (-2<sup>",u.getShaderPrecisionFormat(u.FRAGMENT_SHADER,u.MEDIUM_FLOAT).rangeMin,"</sup> - 2<sup>",u.getShaderPrecisionFormat(u.FRAGMENT_SHADER,u.MEDIUM_FLOAT).rangeMax,"</sup>)"].join("")],["Low Float Precision in Fragment Shader","LOW_FLOAT FRAGMENT_SHADER",[u.getShaderPrecisionFormat(u.FRAGMENT_SHADER,u.LOW_FLOAT).precision," (-2<sup>",u.getShaderPrecisionFormat(u.FRAGMENT_SHADER,u.LOW_FLOAT).rangeMin,"</sup> - 2<sup>",u.getShaderPrecisionFormat(u.FRAGMENT_SHADER,u.LOW_FLOAT).rangeMax,"</sup>)"].join("")],["High Int Precision in Vertex Shader","HIGH_INT VERTEX_SHADER",[u.getShaderPrecisionFormat(u.VERTEX_SHADER,u.HIGH_INT).precision," (-2<sup>",u.getShaderPrecisionFormat(u.VERTEX_SHADER,u.HIGH_INT).rangeMin,"</sup> - 2<sup>",u.getShaderPrecisionFormat(u.VERTEX_SHADER,u.HIGH_INT).rangeMax,"</sup>)"].join("")],["Medium Int Precision in Vertex Shader","MEDIUM_INT VERTEX_SHADER",[u.getShaderPrecisionFormat(u.VERTEX_SHADER,u.MEDIUM_INT).precision," (-2<sup>",u.getShaderPrecisionFormat(u.VERTEX_SHADER,u.MEDIUM_INT).rangeMin,"</sup> - 2<sup>",u.getShaderPrecisionFormat(u.VERTEX_SHADER,u.MEDIUM_INT).rangeMax,"</sup>)"].join("")],["Low Int Precision in Vertex Shader","LOW_INT VERTEX_SHADER",[u.getShaderPrecisionFormat(u.VERTEX_SHADER,u.LOW_INT).precision," (-2<sup>",u.getShaderPrecisionFormat(u.VERTEX_SHADER,u.LOW_INT).rangeMin,"</sup> - 2<sup>",u.getShaderPrecisionFormat(u.VERTEX_SHADER,u.LOW_INT).rangeMax,"</sup>)"].join("")],["High Int Precision in Fragment Shader","HIGH_INT FRAGMENT_SHADER",[u.getShaderPrecisionFormat(u.FRAGMENT_SHADER,u.HIGH_INT).precision," (-2<sup>",u.getShaderPrecisionFormat(u.FRAGMENT_SHADER,u.HIGH_INT).rangeMin,"</sup> - 2<sup>",u.getShaderPrecisionFormat(u.FRAGMENT_SHADER,u.HIGH_INT).rangeMax,"</sup>)"].join("")],["Medium Int Precision in Fragment Shader","MEDIUM_INT FRAGMENT_SHADER",[u.getShaderPrecisionFormat(u.FRAGMENT_SHADER,u.MEDIUM_INT).precision," (-2<sup>",u.getShaderPrecisionFormat(u.FRAGMENT_SHADER,u.MEDIUM_INT).rangeMin,"</sup> - 2<sup>",u.getShaderPrecisionFormat(u.FRAGMENT_SHADER,u.MEDIUM_INT).rangeMax,"</sup>)"].join("")],["Low Int Precision in Fragment Shader","LOW_INT FRAGMENT_SHADER",[u.getShaderPrecisionFormat(u.FRAGMENT_SHADER,u.LOW_INT).precision," (-2<sup>",u.getShaderPrecisionFormat(u.FRAGMENT_SHADER,u.LOW_INT).rangeMin,"</sup> - 2<sup>",u.getShaderPrecisionFormat(u.FRAGMENT_SHADER,u.LOW_INT).rangeMax,"</sup>)"].join("")],["Supported Extensions","EXTENSIONS",u.getSupportedExtensions().join("<br/>					    ")],["WebGL Renderer","RENDERER",u.getParameter(u.RENDERER)],["WebGL Vendor","VENDOR",u.getParameter(u.VENDOR)],["WebGL Version","VERSION",u.getParameter(u.VERSION)],["Shading Language Version","SHADING_LANGUAGE_VERSION",u.getParameter(u.SHADING_LANGUAGE_VERSION)],["Unmasked Renderer","UNMASKED_RENDERER",p&&u.getParameter(p.UNMASKED_RENDERER_WEBGL)],["Unmasked Vendor","UNMASKED_VENDOR",p&&u.getParameter(p.UNMASKED_VENDOR_WEBGL)],["WebGL Version","WEBGL_VERSION",e.webgl2?2:1]],v={};for(;y.length;){const[x,w,S]=y.pop();w&&(v[w]={label:x,value:S})}return e._glInformation=v,v},t.traverseAllPasses=()=>{if(e.renderPasses)for(let d=0;d<e.renderPasses.length;++d)e.renderPasses[d].traverse(t,null);t.copyParentContent(),e.notifyStartCaptureImage&&o();const u=e.renderable.getChildRenderWindowsByReference();for(let d=0;d<u.length;++d)t.getViewNodeFor(u[d])?.traverseAllPasses()},t.copyParentContent=()=>{const u=e.rootOpenGLRenderWindow;if(!u||!e.context2D||e.children.some(p=>!!p.getSelector?.()))return;const d=u.getCanvas(),h=e.canvas;e.context2D.drawImage(d,0,d.height-h.height,h.width,h.height,0,0,h.width,h.height)},t.resizeFromChildRenderWindows=()=>{const u=e.renderable.getChildRenderWindowsByReference();if(u.length>0){const d=[0,0];for(let h=0;h<u.length;++h){const p=t.getViewNodeFor(u[h])?.getSize();p&&(d[0]=p[0]>d[0]?p[0]:d[0],d[1]=p[1]>d[1]?p[1]:d[1])}t.setSize(...d)}},t.disableCullFace=()=>{e.cullFaceEnabled&&(e.context.disable(e.context.CULL_FACE),e.cullFaceEnabled=!1)},t.enableCullFace=()=>{e.cullFaceEnabled||(e.context.enable(e.context.CULL_FACE),e.cullFaceEnabled=!0)},t.setViewStream=u=>{if(e.viewStream===u)return!1;if(e.subscription&&(e.subscription.unsubscribe(),e.subscription=null),e.viewStream=u,e.viewStream){const d=e.renderable.getRenderers()[0];d.getBackgroundByReference()[3]=0,t.setUseBackgroundImage(!0),e.subscription=e.viewStream.onImageReady(h=>t.setBackgroundImage(h.image)),e.viewStream.setSize(e.size[0],e.size[1]),e.viewStream.invalidateCache(),e.viewStream.render(),t.modified()}return!0},t.createSelector=()=>{const u=k7.newInstance();return u.setOpenGLRenderWindow(t),u};function l(){e.canvas.removeEventListener("webglcontextlost",NV),e.canvas.removeEventListener("webglcontextrestored",t.restoreContext)}t.delete=ce.chain(()=>{e.context&&u_e(),t.setContainer(),t.setViewStream()},l,t.delete),t.setActiveFramebuffer=u=>{e.activeFramebuffer=u};const c=t.setSize;t.setSize=(u,d)=>{const h=c(u,d);return h&&t.invokeWindowResizeEvent({width:u,height:d}),h},t.registerGraphicsResourceUser=(u,d)=>{e._graphicsResources.has(u)||t.setGraphicsResourceForObject(u,null,null),e._graphicsResources.get(u)?.users.add(d)},t.unregisterGraphicsResourceUser=(u,d)=>{const h=e._graphicsResources.get(u);h&&(h.users.delete(d),h.users.size||(h.oglObject?.releaseGraphicsResources(t),e._graphicsResources.delete(u)))},t.getGraphicsResourceForObject=u=>e._graphicsResources.get(u),t.setGraphicsResourceForObject=(u,d,h)=>{if(!u)return;const p=e._graphicsResources.get(u);p?.oglObject?.releaseGraphicsResources(t),e._graphicsResources.set(u,{coreObject:u,oglObject:d,hash:h,users:p?.users??new Set})},t.getGraphicsMemoryInfo=()=>{let u=0;return e._graphicsResources.forEach(d=>{let{oglObject:h}=d;u+=h.getAllocatedGPUMemoryInBytes()}),u},t.releaseGraphicsResources=()=>{e.shaderCache!==null&&e.shaderCache.releaseGraphicsResources(t),e._graphicsResources.forEach(u=>{let{oglObject:d}=u;d.releaseGraphicsResources(t)}),e._graphicsResources.clear(),e.textureUnitManager!==null&&e.textureUnitManager.freeAll(),e.renderable.getRenderersByReference().forEach(u=>{t.getViewNodeFor(u)?.releaseGraphicsResources()})};const f={...t};l_e.forEach(u=>{t[u]=function(){return e.rootOpenGLRenderWindow?e.rootOpenGLRenderWindow[u](...arguments):f[u](...arguments)}})}const p_e={cullFaceEnabled:!1,shaderCache:null,initialized:!1,context:null,context2D:null,canvas:null,cursorVisibility:!0,cursor:"pointer",textureUnitManager:null,textureResourceIds:null,containerSize:null,renderPasses:[],notifyStartCaptureImage:!1,webgl2:!1,defaultToWebgl2:!0,activeFramebuffer:null,imageFormat:"image/png",useOffScreen:!1,useBackgroundImage:!1};function iZ(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,p_e,n),i_e.extend(t,e,n),e.canvas||(e.canvas=document.createElement("canvas"),e.canvas.style.width="100%"),e.selector||(e.selector=k7.newInstance(),e.selector.setOpenGLRenderWindow(t)),e.bgImage=new Image,e.bgImage.style.position="absolute",e.bgImage.style.left="0",e.bgImage.style.top="0",e.bgImage.style.width="100%",e.bgImage.style.height="100%",e.bgImage.style.zIndex="-1",e._textureResourceIds=new Map,e._graphicsResources=new Map,e._glInformation=null,e.myFactory=TCe.newInstance(),e.shaderCache=X6e.newInstance(),e.shaderCache.setOpenGLRenderWindow(t),e.renderPasses[0]=T6e.newInstance(),ce.get(t,e,["shaderCache","textureUnitManager","webgl2","useBackgroundImage","activeFramebuffer","rootOpenGLRenderWindow"]),ce.setGet(t,e,["initialized","context","context2D","canvas","renderPasses","notifyStartCaptureImage","defaultToWebgl2","cursor","useOffScreen"]),ce.setGetArray(t,e,["size"],2),ce.event(t,e,"imageReady"),ce.event(t,e,"windowResizeEvent"),h_e(t,e)}const V7=ce.newInstance(iZ,"vtkOpenGLRenderWindow");UJ("WebGL",V7);var g_e={newInstance:V7,extend:iZ,pushMonitorGLContextCount:f_e,popMonitorGLContextCount:d_e};ha("vtkRenderWindow",V7);function m_e(t,e){e.classHierarchy.push("vtkOpenGLActor"),t.buildPass=n=>{if(n){e._openGLRenderWindow=t.getLastAncestorOfType("vtkOpenGLRenderWindow"),e._openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e.context=e._openGLRenderWindow.getContext(),t.prepareNodes(),t.addMissingNodes(e.renderable.getTextures()),t.addMissingNode(e.renderable.getMapper()),t.removeUnusedNodes(),e.ogltextures=null,e.activeTextures=null;for(let r=0;r<e.children.length;r++){const i=e.children[r];i.isA("vtkOpenGLTexture")?(e.ogltextures||(e.ogltextures=[]),e.ogltextures.push(i)):e.oglmapper=i}}},t.traverseZBufferPass=n=>{!e.renderable||!e.renderable.getNestedVisibility()||e._openGLRenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(n,!0),e.oglmapper.traverse(n),t.apply(n,!1))},t.traverseOpaqueZBufferPass=n=>t.traverseOpaquePass(n),t.traverseOpaquePass=n=>{!e.renderable||!e.renderable.getNestedVisibility()||!e.renderable.getIsOpaque()||e._openGLRenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(n,!0),e.oglmapper.traverse(n),t.apply(n,!1))},t.traverseTranslucentPass=n=>{!e.renderable||!e.renderable.getNestedVisibility()||e.renderable.getIsOpaque()||e._openGLRenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(n,!0),e.oglmapper.traverse(n),t.apply(n,!1))},t.activateTextures=()=>{if(e.ogltextures){e.activeTextures=[];for(let n=0;n<e.ogltextures.length;n++){const r=e.ogltextures[n];r.render(),r.getHandle()&&e.activeTextures.push(r)}}},t.queryPass=(n,r)=>{if(n){if(!e.renderable||!e.renderable.getVisibility())return;e.renderable.getIsOpaque()?r.incrementOpaqueActorCount():r.incrementTranslucentActorCount()}},t.zBufferPass=(n,r)=>t.opaquePass(n,r),t.opaqueZBufferPass=(n,r)=>t.opaquePass(n,r),t.opaquePass=(n,r)=>{if(n)e.context.depthMask(!0),t.activateTextures();else if(e.activeTextures)for(let i=0;i<e.activeTextures.length;i++)e.activeTextures[i].deactivate()},t.translucentPass=(n,r)=>{if(n)e.context.depthMask(e._openGLRenderer.getSelector()&&e.renderable.getNestedPickable()),t.activateTextures();else if(e.activeTextures)for(let i=0;i<e.activeTextures.length;i++)e.activeTextures[i].deactivate()},t.getKeyMatrices=()=>(e.renderable.getMTime()>e.keyMatrixTime.getMTime()&&(e.renderable.computeMatrix(),Ri(e.keyMatrices.mcwc,e.renderable.getMatrix()),jn(e.keyMatrices.mcwc,e.keyMatrices.mcwc),e.renderable.getIsIdentity()?Bl(e.keyMatrices.normalMatrix):(BC(e.keyMatrices.normalMatrix,e.keyMatrices.mcwc),Ay(e.keyMatrices.normalMatrix,e.keyMatrices.normalMatrix),u7(e.keyMatrices.normalMatrix,e.keyMatrices.normalMatrix)),e.keyMatrixTime.modified()),e.keyMatrices)}const v_e={context:null,keyMatrixTime:null,keyMatrices:null,activeTextures:null};function y_e(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,v_e,n),kr.extend(t,e,n),e.keyMatrixTime={},Wr(e.keyMatrixTime,{mtime:0}),e.keyMatrices={normalMatrix:Bl(new Float64Array(9)),mcwc:on(new Float64Array(16))},Ni(t,e,["context"]),Fo(t,e,["activeTextures"]),m_e(t,e)}const aZ=Qn(y_e);var x_e={newInstance:aZ};ha("vtkActor",aZ);function b_e(t,e){e.classHierarchy.push("vtkOpenGLActor2D"),t.buildPass=n=>{if(n){if(!e.renderable)return;e._openGLRenderWindow=t.getLastAncestorOfType("vtkOpenGLRenderWindow"),e._openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e.context=e._openGLRenderWindow.getContext(),t.prepareNodes(),t.addMissingNodes(e.renderable.getTextures()),t.addMissingNode(e.renderable.getMapper()),t.removeUnusedNodes(),e.ogltextures=null,e.activeTextures=null;for(let r=0;r<e.children.length;r++){const i=e.children[r];i.isA("vtkOpenGLTexture")?(e.ogltextures||(e.ogltextures=[]),e.ogltextures.push(i)):e.oglmapper=i}}},t.queryPass=(n,r)=>{if(n){if(!e.renderable||!e.renderable.getVisibility())return;r.incrementOverlayActorCount()}},t.traverseOpaquePass=n=>{!e.oglmapper||!e.renderable||!e.renderable.getNestedVisibility()||!e.renderable.getIsOpaque()||e._openGLRenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(n,!0),e.oglmapper.traverse(n),t.apply(n,!1))},t.traverseTranslucentPass=n=>{!e.oglmapper||!e.renderable||!e.renderable.getNestedVisibility()||e.renderable.getIsOpaque()||e._openGLRenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(n,!0),e.oglmapper.traverse(n),t.apply(n,!1))},t.traverseOverlayPass=n=>{!e.oglmapper||!e.renderable||!e.renderable.getNestedVisibility()||e._openGLRenderer.getSelector()&&!e.renderable.getNestedPickable||(t.apply(n,!0),e.oglmapper.traverse(n),t.apply(n,!1))},t.activateTextures=()=>{if(e.ogltextures){e.activeTextures=[];for(let n=0;n<e.ogltextures.length;n++){const r=e.ogltextures[n];r.render(),r.getHandle()&&e.activeTextures.push(r)}}},t.opaquePass=(n,r)=>{if(n)e.context.depthMask(!0),t.activateTextures();else if(e.activeTextures)for(let i=0;i<e.activeTextures.length;i++)e.activeTextures[i].deactivate()},t.translucentPass=(n,r)=>{if(n)e.context.depthMask(!1),t.activateTextures();else if(e.activeTextures)for(let i=0;i<e.activeTextures.length;i++)e.activeTextures[i].deactivate()},t.overlayPass=(n,r)=>{if(n)e.context.depthMask(!0),t.activateTextures();else if(e.activeTextures)for(let i=0;i<e.activeTextures.length;i++)e.activeTextures[i].deactivate()}}const w_e={context:null,activeTextures:null};function C_e(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,w_e,n),kr.extend(t,e,n),Ni(t,e,["context"]),Fo(t,e,["activeTextures"]),b_e(t,e)}const oZ=Qn(C_e);var S_e={newInstance:oZ};ha("vtkActor2D",oZ);function T_e(t,e){e.classHierarchy.push("vtkAbstractMapper"),t.update=()=>{t.getInputData()},t.addClippingPlane=n=>n.isA("vtkPlane")?e.clippingPlanes.includes(n)?!1:(e.clippingPlanes.push(n),t.modified(),!0):!1,t.getNumberOfClippingPlanes=()=>e.clippingPlanes.length,t.removeAllClippingPlanes=()=>e.clippingPlanes.length===0?!1:(e.clippingPlanes.length=0,t.modified(),!0),t.removeClippingPlane=n=>{const r=e.clippingPlanes.indexOf(n);return r===-1?!1:(e.clippingPlanes.splice(r,1),t.modified(),!0)},t.getClippingPlanes=()=>e.clippingPlanes,t.setClippingPlanes=n=>{if(n)if(!Array.isArray(n))t.addClippingPlane(n);else{const r=n.length;for(let i=0;i<r&&i<6;i++)t.addClippingPlane(n[i])}},t.getClippingPlaneInDataCoords=(n,r,i)=>{const a=e.clippingPlanes,o=n;if(a){const s=a.length;if(r>=0&&r<s){const l=a[r],c=l.getNormal(),f=l.getOrigin(),u=c[0],d=c[1],h=c[2],p=-(u*f[0]+d*f[1]+h*f[2]);i[0]=u*o[0]+d*o[4]+h*o[8]+p*o[12],i[1]=u*o[1]+d*o[5]+h*o[9]+p*o[13],i[2]=u*o[2]+d*o[6]+h*o[10]+p*o[14],i[3]=u*o[3]+d*o[7]+h*o[11]+p*o[15];return}}ce.vtkErrorMacro(`Clipping plane index ${r} is out of range.`)}}const E_e={clippingPlanes:[]};function __e(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,E_e,n),ce.obj(t,e),ce.algo(t,e,1,0),e.clippingPlanes||(e.clippingPlanes=[]),T_e(t,e)}var sZ={extend:__e};function D_e(t,e){t.getBounds=()=>(ce.vtkErrorMacro("vtkAbstractMapper3D.getBounds - NOT IMPLEMENTED"),n0()),t.getCenter=()=>{const n=t.getBounds();return e.center=Er.isValid(n)?Er.getCenter(n):null,e.center?.slice()},t.getLength=()=>{const n=t.getBounds();return Er.getDiagonalLength(n)}}const O_e=t=>({bounds:[...Er.INIT_BOUNDS],center:[0,0,0],viewSpecificProperties:{},...t});function M_e(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,O_e(n)),sZ.extend(t,e,n),ce.setGet(t,e,["viewSpecificProperties"]),D_e(t,e)}var F7={extend:M_e};const{vtkErrorMacro:LV}=ce,kV=0,VV=1,XE=2;function I_e(t,e){e.classHierarchy.push("vtkLookupTable"),t.isOpaque=()=>{if(e.opaqueFlagBuildTime.getMTime()<t.getMTime()){let n=!0;e.nanColor[3]<1&&(n=0),e.useBelowRangeColor&&e.belowRangeColor[3]<1&&(n=0),e.useAboveRangeColor&&e.aboveRangeColor[3]<1&&(n=0);for(let r=3;r<e.table.length&&n;r+=4)e.table[r]<255&&(n=!1);e.opaqueFlag=n,e.opaqueFlagBuildTime.modified()}return e.opaqueFlag},t.usingLogScale=()=>!1,t.getNumberOfAvailableColors=()=>e.table.length/4-3,t.linearIndexLookup=(n,r)=>{let i=0;const a=Number(n);return a<r.range[0]?i=r.maxIndex+kV+1.5:a>r.range[1]?i=r.maxIndex+VV+1.5:(i=(a+r.shift)*r.scale,i=i<r.maxIndex?i:r.maxIndex),Math.floor(i)},t.linearLookup=(n,r,i)=>{let a=0;Qw(n)?a=Math.floor(i.maxIndex+1.5+XE):a=t.linearIndexLookup(n,i);const o=4*a;return r.slice(o,o+4)},t.indexedLookupFunction=(n,r,i)=>{let a=t.getAnnotatedValueIndexInternal(n);a===-1&&(a=e.numberOfColors+XE);const o=4*a;return[r[o],r[o+1],r[o+2],r[o+3]]},t.lookupShiftAndScale=(n,r)=>{r.shift=-n[0],r.scale=Number.MAX_VALUE,n[1]>n[0]&&(r.scale=(r.maxIndex+1)/(n[1]-n[0]))},t.mapScalarsThroughTable=(n,r,i,a)=>{let o=t.linearLookup;e.indexedLookup&&(o=t.indexedLookupFunction);const s=t.getMappingRange(),l={maxIndex:t.getNumberOfColors()-1,range:s,shift:0,scale:0};t.lookupShiftAndScale(s,l);const c=t.getAlpha(),f=n.getNumberOfTuples(),u=n.getNumberOfComponents(),d=r.getData(),h=n.getData();if(c>=1){if(i===T_.RGBA)for(let p=0;p<f;p++){const g=o(h[p*u+a],e.table,l);d[p*4]=g[0],d[p*4+1]=g[1],d[p*4+2]=g[2],d[p*4+3]=g[3]}}else if(i===T_.RGBA)for(let p=0;p<f;p++){const g=o(h[p*u+a],e.table,l);d[p*4]=g[0],d[p*4+1]=g[1],d[p*4+2]=g[2],d[p*4+3]=Math.floor(g[3]*c+.5)}},t.forceBuild=()=>{let n=0,r=0,i=0,a=0;const o=e.numberOfColors-1;o&&(n=(e.hueRange[1]-e.hueRange[0])/o,r=(e.saturationRange[1]-e.saturationRange[0])/o,i=(e.valueRange[1]-e.valueRange[0])/o,a=(e.alphaRange[1]-e.alphaRange[0])/o),e.table.length=4*o+16;const s=[],l=[];for(let c=0;c<=o;c++)s[0]=e.hueRange[0]+c*n,s[1]=e.saturationRange[0]+c*r,s[2]=e.valueRange[0]+c*i,eh(s,l),l[3]=e.alphaRange[0]+c*a,e.table[c*4]=l[0]*255+.5,e.table[c*4+1]=l[1]*255+.5,e.table[c*4+2]=l[2]*255+.5,e.table[c*4+3]=l[3]*255+.5;t.buildSpecialColors(),e.buildTime.modified()},t.setTable=n=>{if(Array.isArray(n)){const i=n[0].length;e.numberOfColors=n.length;const a=4-i;let o=0;for(let s=0;s<e.numberOfColors;s++)e.table[s*4]=255,e.table[s*4+1]=255,e.table[s*4+2]=255,e.table[s*4+3]=255;for(let s=0;s<n.length;s++){const l=n[s];for(let c=0;c<i;c++)e.table[o++]=l[c];o+=a}return t.buildSpecialColors(),e.insertTime.modified(),t.modified(),!0}if(n.getNumberOfComponents()!==4)return LV("Expected 4 components for RGBA colors"),!1;if(n.getDataType()!==Ln.UNSIGNED_CHAR)return LV("Expected unsigned char values for RGBA colors"),!1;e.numberOfColors=n.getNumberOfTuples();const r=n.getData();e.table.length=r.length;for(let i=0;i<r.length;i++)e.table[i]=r[i];return t.buildSpecialColors(),e.insertTime.modified(),t.modified(),!0},t.buildSpecialColors=()=>{const{numberOfColors:n}=e,r=e.table;let i=(n+kV)*4;e.useBelowRangeColor||n===0?(r[i]=e.belowRangeColor[0]*255+.5,r[i+1]=e.belowRangeColor[1]*255+.5,r[i+2]=e.belowRangeColor[2]*255+.5,r[i+3]=e.belowRangeColor[3]*255+.5):(r[i]=r[0],r[i+1]=r[1],r[i+2]=r[2],r[i+3]=r[3]),i=(n+VV)*4,e.useAboveRangeColor||n===0?(r[i]=e.aboveRangeColor[0]*255+.5,r[i+1]=e.aboveRangeColor[1]*255+.5,r[i+2]=e.aboveRangeColor[2]*255+.5,r[i+3]=e.aboveRangeColor[3]*255+.5):(r[i]=r[4*(n-1)+0],r[i+1]=r[4*(n-1)+1],r[i+2]=r[4*(n-1)+2],r[i+3]=r[4*(n-1)+3]),i=(n+XE)*4,r[i]=e.nanColor[0]*255+.5,r[i+1]=e.nanColor[1]*255+.5,r[i+2]=e.nanColor[2]*255+.5,r[i+3]=e.nanColor[3]*255+.5},t.build=()=>{(e.table.length<1||t.getMTime()>e.buildTime.getMTime()&&e.insertTime.getMTime()<=e.buildTime.getMTime())&&t.forceBuild()},e.table.length>0&&(t.buildSpecialColors(),e.insertTime.modified())}const R_e={numberOfColors:256,hueRange:[0,.66667],saturationRange:[1,1],valueRange:[1,1],alphaRange:[1,1],nanColor:[.5,0,0,1],belowRangeColor:[0,0,0,1],aboveRangeColor:[1,1,1,1],useAboveRangeColor:!1,useBelowRangeColor:!1,alpha:1};function lZ(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,R_e,n),VC.extend(t,e,n),e.table||(e.table=[]),e.buildTime={},ce.obj(e.buildTime),e.opaqueFlagBuildTime={},ce.obj(e.opaqueFlagBuildTime,{mtime:0}),e.insertTime={},ce.obj(e.insertTime,{mtime:0}),ce.get(t,e,["buildTime"]),ce.setGet(t,e,["numberOfColors","useAboveRangeColor","useBelowRangeColor"]),ce.setArray(t,e,["alphaRange","hueRange","saturationRange","valueRange"],2),ce.setArray(t,e,["nanColor","belowRangeColor","aboveRangeColor"],4),ce.getArray(t,e,["hueRange","saturationRange","valueRange","alphaRange","nanColor","belowRangeColor","aboveRangeColor"]),I_e(t,e)}const P_e=ce.newInstance(lZ,"vtkLookupTable");var p3={newInstance:P_e,extend:lZ};const{FieldAssociations:FV}=zm,{staticOffsetAPI:A_e,otherStaticMethods:N_e}=zC,{ColorMode:jx,ScalarMode:$0,GetArray:YE}=kC,{VectorMode:L_e}=ZD,{VtkDataTypes:k_e}=tn;function iv(t){return()=>ce.vtkErrorMacro(`vtkMapper::${t} - NOT IMPLEMENTED`)}function V_e(t,e){const n=t[1]%2===0?1:-1;if(t[0]+=n,t[0]>=e[0]||t[0]<0){const r=t[2]%2===0?1:-1;t[0]-=n,t[1]+=r,(t[1]>=e[1]||t[1]<0)&&(t[1]-=r,t[2]++)}}function F_e(t,e){return t[0]+e[0]*(t[1]+e[1]*t[2])}function UV(t,e,n){const r=Math.floor(e),i=r%(2*n[0]);let a,o;i<n[0]?(t[0]=i,a=1,o=t[0]===n[0]-1):(t[0]=2*n[0]-1-i,a=-1,o=t[0]===0);const s=Math.floor(r/n[0]),l=s%(2*n[1]);let c,f;l<n[1]?(t[1]=l,c=1,f=t[1]===n[1]-1):(t[1]=2*n[1]-1-l,c=-1,f=t[1]===0),t[2]=Math.floor(s/n[1]);const u=e-r;o?f?t[2]+=u:t[1]+=c*u:t[0]+=a*u,t[0]=(t[0]+.5)/n[0],t[1]=(t[1]+.5)/n[1],t[2]=(t[2]+.5)/n[2]}const BV=new WeakMap;function U_e(t,e,n,r,i,a,o){const s=new Array(arguments.length);for(let P=0;P<arguments.length;++P){const N=arguments[P];s[P]=N.getMTime?.()??N}const l=s.join("/"),c=BV.get(t);if(c&&c.stringHash===l)return c.textureCoordinates;const f=(n[1]-n[0])/(r-1),[u,d]=[n[0]-f,n[1]+f],h=u-.5*f,p=1/(d-u+f),g=u,m=(r+1)/(d-u),y=t.getData(),v=t.getNumberOfTuples(),x=t.getNumberOfComponents(),w=e<0||e>=x,S=i[2]<=1?2:3,T=tn.newInstance({numberOfComponents:S,values:new Float32Array(v*S)}),_=T.getData(),D=[0,0,0];UV(D,r+2,i);let I=0,R=0;const O=[.5,.5,.5];for(let P=0;P<v;++P){let N;if(w){let A=0;for(let B=0;B<x;++B){const V=y[I+B];A+=V*V}N=Math.sqrt(A)}else N=y[I+e];if(I+=x,a&&(N=p3.applyLogScale(N,n,n)),Qw(N))O[0]=D[0],O[1]=D[1],O[2]=D[2];else if(o){let A=(N-g)*m;A<1?A=0:A>r&&(A=r+1),UV(O,A,i)}else{O[1]=.49;const A=(N-h)*p;A>1e3?O[0]=1e3:A<-1e3?O[0]=-1e3:O[0]=A}for(let A=0;A<S;++A)_[R++]=O[A]}return BV.set(t,{stringHash:l,textureCoordinates:T}),T}function B_e(t,e){e.classHierarchy.push("vtkMapper"),t.getBounds=()=>{const n=t.getInputData();return n?(e.static||t.update(),e.bounds=n.getBounds()):e.bounds=n0(),e.bounds},t.setForceCompileOnly=n=>{e.forceCompileOnly=n},t.setSelectionWebGLIdsToVTKIds=n=>{e.selectionWebGLIdsToVTKIds=n},t.createDefaultLookupTable=()=>{e.lookupTable=p3.newInstance()},t.getColorModeAsString=()=>ce.enumToString(jx,e.colorMode),t.setColorModeToDefault=()=>t.setColorMode(0),t.setColorModeToMapScalars=()=>t.setColorMode(1),t.setColorModeToDirectScalars=()=>t.setColorMode(2),t.getScalarModeAsString=()=>ce.enumToString($0,e.scalarMode),t.setScalarModeToDefault=()=>t.setScalarMode(0),t.setScalarModeToUsePointData=()=>t.setScalarMode(1),t.setScalarModeToUseCellData=()=>t.setScalarMode(2),t.setScalarModeToUsePointFieldData=()=>t.setScalarMode(3),t.setScalarModeToUseCellFieldData=()=>t.setScalarMode(4),t.setScalarModeToUseFieldData=()=>t.setScalarMode(5),t.getAbstractScalars=(n,r,i,a,o)=>{if(!n||!e.scalarVisibility)return{scalars:null,cellFlag:!1};let s=null,l=!1;if(r===$0.DEFAULT)s=n.getPointData().getScalars(),s||(s=n.getCellData().getScalars(),l=!0);else if(r===$0.USE_POINT_DATA)s=n.getPointData().getScalars();else if(r===$0.USE_CELL_DATA)s=n.getCellData().getScalars(),l=!0;else if(r===$0.USE_POINT_FIELD_DATA){const c=n.getPointData();i===YE.BY_ID?s=c.getArrayByIndex(a):s=c.getArrayByName(o)}else if(r===$0.USE_CELL_FIELD_DATA){const c=n.getCellData();l=!0,i===YE.BY_ID?s=c.getArrayByIndex(a):s=c.getArrayByName(o)}else if(r===$0.USE_FIELD_DATA){const c=n.getFieldData();i===YE.BY_ID?s=c.getArrayByIndex(a):s=c.getArrayByName(o)}return{scalars:s,cellFlag:l}},t.mapScalars=(n,r)=>{const{scalars:i,cellFlag:a}=t.getAbstractScalars(n,e.scalarMode,e.arrayAccessMode,e.arrayId,e.colorByArrayName);if(e.areScalarsMappedFromCells=a,!i){e.colorCoordinates=null,e.colorTextureMap=null,e.colorMapColors=null;return}const o=`${t.getMTime()}${i.getMTime()}${r}`;if(e.colorBuildString!==o){if(e.useLookupTableScalarRange||t.getLookupTable().setRange(e.scalarRange[0],e.scalarRange[1]),t.canUseTextureMapForColoring(i,a))e.mapScalarsToTexture(i,a,r);else{e.colorCoordinates=null,e.colorTextureMap=null;const s=t.getLookupTable();s&&(s.build(),e.colorMapColors=s.mapScalars(i,e.colorMode,e.fieldDataTupleId))}e.colorBuildString=`${t.getMTime()}${i.getMTime()}${r}`}},e.mapScalarsToTexture=(n,r,i)=>{const a=e.lookupTable.getRange(),o=e.lookupTable.usingLogScale();o&&p3.getLogRange(a,a);const s=e.lookupTable.getAlpha();if(e.colorMapColors=null,e.colorTextureMap==null||t.getMTime()>e.colorTextureMap.getMTime()||e.lookupTable.getMTime()>e.colorTextureMap.getMTime()||e.lookupTable.getAlpha()!==i){e.lookupTable.setAlpha(i),e.colorTextureMap=null,e.lookupTable.build();const c=e.lookupTable.getNumberOfAvailableColors(),f=2048,u=f**3-3,h=4096-2,p=2,g=r?u:h;e.numberOfColorsInRange=Math.min(Math.max(c,p),g);const m=e.numberOfColorsInRange+3,y=e.numberOfColorsInRange+2,v=r?[Math.min(Math.ceil(m/f**0),f),Math.min(Math.ceil(m/f**1),f),Math.min(Math.ceil(m/f**2),f)]:[y,2,1],x=v[0]*v[1]*v[2],w=new Float64Array(x);w.fill(NaN);const S=e.numberOfColorsInRange,T=S+2,_=[0,0,0],D=a[0],I=a[1]-a[0];for(let P=0;P<T;++P){const N=F_e(_,v),A=D+I*(P-1)/(S-1);w[N]=o?10**A:A,V_e(_,v)}const R=tn.newInstance({numberOfComponents:1,values:w}),O=e.lookupTable.mapScalars(R,e.colorMode,0);e.colorTextureMap=KC.newInstance(),e.colorTextureMap.setDimensions(v),e.colorTextureMap.getPointData().setScalars(O),e.lookupTable.setAlpha(s)}const l=e.lookupTable.getVectorMode()===L_e.MAGNITUDE&&n.getNumberOfComponents()>1?-1:e.lookupTable.getVectorComponent();e.colorCoordinates=U_e(n,l,a,e.numberOfColorsInRange,e.colorTextureMap.getDimensions(),o,r)},t.getIsOpaque=()=>{const n=t.getInputData(),i=t.getAbstractScalars(n,e.scalarMode,e.arrayAccessMode,e.arrayId,e.colorByArrayName).scalars;if(!e.scalarVisibility||i==null)return!0;const a=t.getLookupTable();return a?(a.build(),a.areScalarsOpaque(i,e.colorMode,-1)):!0},t.canUseTextureMapForColoring=(n,r)=>r&&e.colorMode!==jx.DIRECT_SCALARS?!0:!(!e.interpolateScalarsBeforeMapping||e.lookupTable&&e.lookupTable.getIndexedLookup()||!n||e.colorMode===jx.DEFAULT&&n.getDataType()===k_e.UNSIGNED_CHAR||e.colorMode===jx.DIRECT_SCALARS),t.clearColorArrays=()=>{e.colorMapColors=null,e.colorCoordinates=null,e.colorTextureMap=null},t.getLookupTable=()=>(e.lookupTable||t.createDefaultLookupTable(),e.lookupTable),t.getMTime=()=>{let n=e.mtime;if(e.lookupTable!==null){const r=e.lookupTable.getMTime();n=r>n?r:n}return n},t.getPrimitiveCount=()=>{const n=t.getInputData();return{points:n.getPoints().getNumberOfValues()/3,verts:n.getVerts().getNumberOfValues()-n.getVerts().getNumberOfCells(),lines:n.getLines().getNumberOfValues()-2*n.getLines().getNumberOfCells(),triangles:n.getPolys().getNumberOfValues()-3*n.getPolys().getNumberOfCells()}},t.acquireInvertibleLookupTable=iv("AcquireInvertibleLookupTable"),t.valueToColor=iv("ValueToColor"),t.colorToValue=iv("ColorToValue"),t.useInvertibleColorFor=iv("UseInvertibleColorFor"),t.clearInvertibleColor=iv("ClearInvertibleColor"),t.processSelectorPixelBuffers=(n,r)=>{if(!n||!e.selectionWebGLIdsToVTKIds||!e.populateSelectionSettings)return;const i=n.getRawPixelBuffer(Jo.ID_LOW24),a=n.getRawPixelBuffer(Jo.ID_HIGH24),o=n.getCurrentPass(),s=n.getFieldAssociation();let l=null;s===FV.FIELD_ASSOCIATION_POINTS?l=e.selectionWebGLIdsToVTKIds.points:s===FV.FIELD_ASSOCIATION_CELLS&&(l=e.selectionWebGLIdsToVTKIds.cells),l&&r.forEach(c=>{if(o===Jo.ID_LOW24){let f=0;a&&(f+=a[c],f*=256),f+=i[c+2],f*=256,f+=i[c+1],f*=256,f+=i[c];const u=l[f],d=n.getPixelBuffer(Jo.ID_LOW24);d[c]=u&255,d[c+1]=(u&65280)>>8,d[c+2]=(u&16711680)>>16}else if(o===Jo.ID_HIGH24&&a){let f=0;f+=a[c],f*=256,f+=i[c+2],f*=256,f+=i[c+1],f*=256,f+=i[c];const u=l[f],d=n.getPixelBuffer(Jo.ID_HIGH24);d[c]=(u&4278190080)>>24}})}}const $_e={colorMapColors:null,areScalarsMappedFromCells:!1,static:!1,lookupTable:null,scalarVisibility:!0,scalarRange:[0,1],useLookupTableScalarRange:!1,colorMode:0,scalarMode:0,arrayAccessMode:1,renderTime:0,colorByArrayName:null,fieldDataTupleId:-1,populateSelectionSettings:!0,selectionWebGLIdsToVTKIds:null,interpolateScalarsBeforeMapping:!1,colorCoordinates:null,colorTextureMap:null,numberOfColorsInRange:0,forceCompileOnly:0,useInvertibleColors:!1,invertibleScalars:null,customShaderAttributes:[]};function cZ(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,$_e,n),F7.extend(t,e,n),ce.get(t,e,["areScalarsMappedFromCells","colorCoordinates","colorMapColors","colorTextureMap","numberOfColorsInRange","selectionWebGLIdsToVTKIds"]),ce.setGet(t,e,["colorByArrayName","arrayAccessMode","colorMode","fieldDataTupleId","interpolateScalarsBeforeMapping","lookupTable","populateSelectionSettings","renderTime","scalarMode","scalarVisibility","static","useLookupTableScalarRange","customShaderAttributes"]),ce.setGetArray(t,e,["scalarRange"],2),zC.implementCoincidentTopologyMethods(t,e),B_e(t,e)}const G_e=ce.newInstance(cZ,"vtkMapper");var bc={newInstance:G_e,extend:cZ,...A_e,...N_e,...kC};const{FieldAssociations:JE}=zm,{primTypes:Na}=Du,{Representation:Up,Shading:$V}=Yh,{ScalarMode:zx}=bc,{Filter:GV,Wrap:jV}=ai,{vtkErrorMacro:G0}=wo,j_e={type:"StartEvent"},z_e={type:"EndEvent"},{CoordinateSystem:W_e}=Ny;function H_e(t){const e=t.getSelector();return e?e.getCurrentPass():Jo.MIN_KNOWN_PASS-1}function K_e(t,e){e.classHierarchy.push("vtkOpenGLPolyDataMapper"),t.buildPass=r=>{r&&(e.currentRenderPass=null,e.openGLActor=t.getFirstAncestorOfType("vtkOpenGLActor"),e._openGLRenderer=e.openGLActor.getFirstAncestorOfType("vtkOpenGLRenderer"),e._openGLRenderWindow=e._openGLRenderer.getLastAncestorOfType("vtkOpenGLRenderWindow"),e.openGLCamera=e._openGLRenderer.getViewNodeFor(e._openGLRenderer.getRenderable().getActiveCamera()))},t.translucentPass=(r,i)=>{r&&(e.currentRenderPass=i,t.render())},t.zBufferPass=r=>{r&&(e.haveSeenDepthRequest=!0,e.renderDepth=!0,t.render(),e.renderDepth=!1)},t.opaqueZBufferPass=r=>t.zBufferPass(r),t.opaquePass=r=>{r&&t.render()},t.render=()=>{const r=e._openGLRenderWindow.getContext();if(e.context!==r){e.context=r;for(let o=Na.Start;o<Na.End;o++)e.primitives[o].setOpenGLRenderWindow(e._openGLRenderWindow)}const i=e.openGLActor.getRenderable(),a=e._openGLRenderer.getRenderable();t.renderPiece(a,i)},t.getShaderTemplate=(r,i,a)=>{r.Vertex=A7,r.Fragment=Ly,r.Geometry=""},t.replaceShaderColor=(r,i,a)=>{let o=r.Vertex,s=r.Geometry,l=r.Fragment;const c=e.lastBoundBO.getReferenceByName("lastLightComplexity");let f=["uniform float ambient;","uniform float diffuse;","uniform float specular;","uniform float opacityUniform; // the fragment opacity","uniform vec3 ambientColorUniform;","uniform vec3 diffuseColorUniform;"];c&&(f=f.concat(["uniform vec3 specularColorUniform;","uniform float specularPowerUniform;"]));let u=["vec3 ambientColor;","  vec3 diffuseColor;","  float opacity;"];c&&(u=u.concat(["  vec3 specularColor;","  float specularPower;"])),u=u.concat(["  ambientColor = ambientColorUniform;","  diffuseColor = diffuseColorUniform;","  opacity = opacityUniform;"]),c&&(u=u.concat(["  specularColor = specularColorUniform;","  specularPower = specularPowerUniform;"])),e.lastBoundBO.getCABO().getColorComponents()!==0&&!e.drawingEdges&&(f=f.concat(["varying vec4 vertexColorVSOutput;"]),o=$e.substitute(o,"//VTK::Color::Dec",["attribute vec4 scalarColor;","varying vec4 vertexColorVSOutput;"]).result,o=$e.substitute(o,"//VTK::Color::Impl",["vertexColorVSOutput =  scalarColor;"]).result,s=$e.substitute(s,"//VTK::Color::Dec",["in vec4 vertexColorVSOutput[];","out vec4 vertexColorGSOutput;"]).result,s=$e.substitute(s,"//VTK::Color::Impl",["vertexColorGSOutput = vertexColorVSOutput[i];"]).result),e.lastBoundBO.getCABO().getColorComponents()!==0&&!e.drawingEdges?l=$e.substitute(l,"//VTK::Color::Impl",u.concat(["  diffuseColor = vertexColorVSOutput.rgb;","  ambientColor = vertexColorVSOutput.rgb;","  opacity = opacity*vertexColorVSOutput.a;"])).result:(e.renderable.getAreScalarsMappedFromCells()||e.renderable.getInterpolateScalarsBeforeMapping())&&e.renderable.getColorCoordinates()&&!e.drawingEdges?l=$e.substitute(l,"//VTK::Color::Impl",u.concat(["  vec4 texColor = texture2D(texture1, tcoordVCVSOutput.st);","  diffuseColor = texColor.rgb;","  ambientColor = texColor.rgb;","  opacity = opacity*texColor.a;"])).result:(a.getBackfaceProperty()&&!e.drawingEdges&&(f=f.concat(["uniform float opacityUniformBF; // the fragment opacity","uniform float ambientIntensityBF; // the material ambient","uniform float diffuseIntensityBF; // the material diffuse","uniform vec3 ambientColorUniformBF; // ambient material color","uniform vec3 diffuseColorUniformBF; // diffuse material color"]),c?(f=f.concat(["uniform float specularIntensityBF; // the material specular intensity","uniform vec3 specularColorUniformBF; // intensity weighted color","uniform float specularPowerUniformBF;"]),u=u.concat(["if (gl_FrontFacing == false) {","  ambientColor = ambientIntensityBF * ambientColorUniformBF;","  diffuseColor = diffuseIntensityBF * diffuseColorUniformBF;","  specularColor = specularIntensityBF * specularColorUniformBF;","  specularPower = specularPowerUniformBF;","  opacity = opacityUniformBF; }"])):u=u.concat(["if (gl_FrontFacing == false) {","  ambientColor = ambientIntensityBF * ambientColorUniformBF;","  diffuseColor = diffuseIntensityBF * diffuseColorUniformBF;","  opacity = opacityUniformBF; }"])),e.haveCellScalars&&!e.drawingEdges&&(f=f.concat(["uniform samplerBuffer texture1;"])),l=$e.substitute(l,"//VTK::Color::Impl",u).result),l=$e.substitute(l,"//VTK::Color::Dec",f).result,r.Vertex=o,r.Geometry=s,r.Fragment=l},t.replaceShaderLight=(r,i,a)=>{let o=r.Fragment;const s="",l=e.lastBoundBO.getReferenceByName("lastLightComplexity"),c=e.lastBoundBO.getReferenceByName("lastLightCount");let f=[];switch(l){case 0:o=$e.substitute(o,"//VTK::Light::Impl",["  gl_FragData[0] = vec4(ambientColor * ambient + diffuseColor * diffuse, opacity);","  //VTK::Light::Impl"],!1).result;break;case 1:o=$e.substitute(o,"//VTK::Light::Impl",["  float df = max(0.0, normalVCVSOutput.z);","  float sf = pow(df, specularPower);","  vec3 diffuseL = df * diffuseColor;","  vec3 specularL = sf * specularColor;","  gl_FragData[0] = vec4(ambientColor * ambient + diffuseL * diffuse + specularL * specular, opacity);","  //VTK::Light::Impl"],!1).result;break;case 2:for(let u=0;u<c;++u)f=f.concat([`uniform vec3 lightColor${u};`,`uniform vec3 lightDirectionVC${u}; // normalized`,`uniform vec3 lightHalfAngleVC${u}; // normalized`]);o=$e.substitute(o,"//VTK::Light::Dec",f).result,f=["vec3 diffuseL = vec3(0,0,0);","  vec3 specularL = vec3(0,0,0);","  float df;"];for(let u=0;u<c;++u)f=f.concat([`  df = max(0.0, dot(normalVCVSOutput, -lightDirectionVC${u}));`,`  diffuseL += ((df${s}) * lightColor${u});`,`  if (dot(normalVCVSOutput, lightDirectionVC${u}) < 0.0)`,"    {",`    float sf = sign(df)*pow(max(1e-5,
                                              dot(reflect(lightDirectionVC${u},normalVCVSOutput),
                                                  normalize(-vertexVC.xyz))),
                                         specularPower);`,`    specularL += (sf${s} * lightColor${u});`,"    }"]);f=f.concat(["  diffuseL = diffuseL * diffuseColor;","  specularL = specularL * specularColor;","  gl_FragData[0] = vec4(ambientColor * ambient + diffuseL * diffuse + specularL * specular, opacity);","  //VTK::Light::Impl"]),o=$e.substitute(o,"//VTK::Light::Impl",f,!1).result;break;case 3:for(let u=0;u<c;++u)f=f.concat([`uniform vec3 lightColor${u};`,`uniform vec3 lightDirectionVC${u}; // normalized`,`uniform vec3 lightHalfAngleVC${u}; // normalized`,`uniform vec3 lightPositionVC${u};`,`uniform vec3 lightAttenuation${u};`,`uniform float lightConeAngle${u};`,`uniform float lightExponent${u};`,`uniform int lightPositional${u};`]);o=$e.substitute(o,"//VTK::Light::Dec",f).result,f=["vec3 diffuseL = vec3(0,0,0);","  vec3 specularL = vec3(0,0,0);","  vec3 vertLightDirectionVC;","  float attenuation;","  float df;"];for(let u=0;u<c;++u)f=f.concat(["  attenuation = 1.0;",`  if (lightPositional${u} == 0)`,"    {",`      vertLightDirectionVC = lightDirectionVC${u};`,"    }","  else","    {",`    vertLightDirectionVC = vertexVC.xyz - lightPositionVC${u};`,"    float distanceVC = length(vertLightDirectionVC);","    vertLightDirectionVC = normalize(vertLightDirectionVC);","    attenuation = 1.0 /",`      (lightAttenuation${u}.x`,`       + lightAttenuation${u}.y * distanceVC`,`       + lightAttenuation${u}.z * distanceVC * distanceVC);`,"    // per OpenGL standard cone angle is 90 or less for a spot light",`    if (lightConeAngle${u} <= 90.0)`,"      {",`      float coneDot = dot(vertLightDirectionVC, lightDirectionVC${u});`,"      // if inside the cone",`      if (coneDot >= cos(radians(lightConeAngle${u})))`,"        {",`        attenuation = attenuation * pow(coneDot, lightExponent${u});`,"        }","      else","        {","        attenuation = 0.0;","        }","      }","    }","    df = max(0.0, attenuation*dot(normalVCVSOutput, -vertLightDirectionVC));",`    diffuseL += ((df${s}) * lightColor${u});`,"    if (dot(normalVCVSOutput, vertLightDirectionVC) < 0.0)","      {",`      float sf = sign(df)*attenuation*pow(max(1e-5,
                                                           dot(reflect(lightDirectionVC${u},
                                                                       normalVCVSOutput),
                                                               normalize(-vertexVC.xyz))),
                                                       specularPower);`,`    specularL += ((sf${s}) * lightColor${u});`,"    }"]);f=f.concat(["  diffuseL = diffuseL * diffuseColor;","  specularL = specularL * specularColor;","  gl_FragData[0] = vec4(ambientColor * ambient + diffuseL * diffuse + specularL * specular, opacity);","  //VTK::Light::Impl"]),o=$e.substitute(o,"//VTK::Light::Impl",f,!1).result;break;default:G0("bad light complexity")}r.Fragment=o},t.replaceShaderNormal=(r,i,a)=>{if(e.lastBoundBO.getReferenceByName("lastLightComplexity")>0){let s=r.Vertex,l=r.Geometry,c=r.Fragment;e.lastBoundBO.getCABO().getNormalOffset()?(s=$e.substitute(s,"//VTK::Normal::Dec",["attribute vec3 normalMC;","uniform mat3 normalMatrix;","varying vec3 normalVCVSOutput;"]).result,s=$e.substitute(s,"//VTK::Normal::Impl",["normalVCVSOutput = normalMatrix * normalMC;"]).result,l=$e.substitute(l,"//VTK::Normal::Dec",["in vec3 normalVCVSOutput[];","out vec3 normalVCGSOutput;"]).result,l=$e.substitute(l,"//VTK::Normal::Impl",["normalVCGSOutput = normalVCVSOutput[i];"]).result,c=$e.substitute(c,"//VTK::Normal::Dec",["varying vec3 normalVCVSOutput;"]).result,c=$e.substitute(c,"//VTK::Normal::Impl",["vec3 normalVCVSOutput = normalize(normalVCVSOutput);","  if (gl_FrontFacing == false) { normalVCVSOutput = -normalVCVSOutput; }"]).result):e.haveCellNormals?(c=$e.substitute(c,"//VTK::Normal::Dec",["uniform mat3 normalMatrix;","uniform samplerBuffer textureN;"]).result,c=$e.substitute(c,"//VTK::Normal::Impl",["vec3 normalVCVSOutput = normalize(normalMatrix *","    texelFetchBuffer(textureN, gl_PrimitiveID + PrimitiveIDOffset).xyz);","  if (gl_FrontFacing == false) { normalVCVSOutput = -normalVCVSOutput; }"]).result):e.lastBoundBO.getOpenGLMode(a.getProperty().getRepresentation())===e.context.LINES?(c=$e.substitute(c,"//VTK::UniformFlow::Impl",["  vec3 fdx = dFdx(vertexVC.xyz);","  vec3 fdy = dFdy(vertexVC.xyz);","  //VTK::UniformFlow::Impl"]).result,c=$e.substitute(c,"//VTK::Normal::Impl",["vec3 normalVCVSOutput;","  if (abs(fdx.x) > 0.0)","    { fdx = normalize(fdx); normalVCVSOutput = normalize(cross(vec3(fdx.y, -fdx.x, 0.0), fdx)); }","  else { fdy = normalize(fdy); normalVCVSOutput = normalize(cross(vec3(fdy.y, -fdy.x, 0.0), fdy));}"]).result):(c=$e.substitute(c,"//VTK::Normal::Dec",["uniform int cameraParallel;"]).result,c=$e.substitute(c,"//VTK::UniformFlow::Impl",["  vec3 fdx = dFdx(vertexVC.xyz);","  vec3 fdy = dFdy(vertexVC.xyz);","  //VTK::UniformFlow::Impl"]).result,c=$e.substitute(c,"//VTK::Normal::Impl",["  fdx = normalize(fdx);","  fdy = normalize(fdy);","  vec3 normalVCVSOutput = normalize(cross(fdx,fdy));","  if (cameraParallel == 1 && normalVCVSOutput.z < 0.0) { normalVCVSOutput = -1.0*normalVCVSOutput; }","  if (cameraParallel == 0 && dot(normalVCVSOutput,vertexVC.xyz) > 0.0) { normalVCVSOutput = -1.0*normalVCVSOutput; }"]).result),r.Vertex=s,r.Geometry=l,r.Fragment=c}},t.replaceShaderPositionVC=(r,i,a)=>{e.lastBoundBO.replaceShaderPositionVC(r,i,a);let o=r.Vertex,s=r.Geometry,l=r.Fragment;e.lastBoundBO.getReferenceByName("lastLightComplexity")>0?(o=$e.substitute(o,"//VTK::PositionVC::Dec",["varying vec4 vertexVCVSOutput;"]).result,o=$e.substitute(o,"//VTK::PositionVC::Impl",["vertexVCVSOutput = MCVCMatrix * vertexMC;","  gl_Position = MCPCMatrix * vertexMC;"]).result,o=$e.substitute(o,"//VTK::Camera::Dec",["uniform mat4 MCPCMatrix;","uniform mat4 MCVCMatrix;"]).result,s=$e.substitute(s,"//VTK::PositionVC::Dec",["in vec4 vertexVCVSOutput[];","out vec4 vertexVCGSOutput;"]).result,s=$e.substitute(s,"//VTK::PositionVC::Impl",["vertexVCGSOutput = vertexVCVSOutput[i];"]).result,l=$e.substitute(l,"//VTK::PositionVC::Dec",["varying vec4 vertexVCVSOutput;"]).result,l=$e.substitute(l,"//VTK::PositionVC::Impl",["vec4 vertexVC = vertexVCVSOutput;"]).result):(o=$e.substitute(o,"//VTK::Camera::Dec",["uniform mat4 MCPCMatrix;"]).result,o=$e.substitute(o,"//VTK::PositionVC::Impl",["  gl_Position = MCPCMatrix * vertexMC;"]).result),r.Vertex=o,r.Geometry=s,r.Fragment=l},t.replaceShaderTCoord=(r,i,a)=>{if(e.lastBoundBO.getCABO().getTCoordOffset()){let o=r.Vertex,s=r.Geometry,l=r.Fragment;if(e.drawingEdges)return;o=$e.substitute(o,"//VTK::TCoord::Impl","tcoordVCVSOutput = tcoordMC;").result;const c=e.openGLActor.getActiveTextures();let f=2,u=2;if(c&&c.length>0&&(f=c[0].getComponents(),c[0].getTarget()===e.context.TEXTURE_CUBE_MAP&&(u=3)),e.renderable.getColorTextureMap()&&(f=e.renderable.getColorTextureMap().getPointData().getScalars().getNumberOfComponents(),u=2),u===2){if(o=$e.substitute(o,"//VTK::TCoord::Dec","attribute vec2 tcoordMC; varying vec2 tcoordVCVSOutput;").result,s=$e.substitute(s,"//VTK::TCoord::Dec",["in vec2 tcoordVCVSOutput[];","out vec2 tcoordVCGSOutput;"]).result,s=$e.substitute(s,"//VTK::TCoord::Impl","tcoordVCGSOutput = tcoordVCVSOutput[i];").result,l=$e.substitute(l,"//VTK::TCoord::Dec",["varying vec2 tcoordVCVSOutput;","uniform sampler2D texture1;"]).result,c&&c.length>=1)switch(f){case 1:l=$e.substitute(l,"//VTK::TCoord::Impl",["  vec4 tcolor = texture2D(texture1, tcoordVCVSOutput);","  ambientColor = ambientColor*tcolor.r;","  diffuseColor = diffuseColor*tcolor.r;"]).result;break;case 2:l=$e.substitute(l,"//VTK::TCoord::Impl",["  vec4 tcolor = texture2D(texture1, tcoordVCVSOutput);","  ambientColor = ambientColor*tcolor.r;","  diffuseColor = diffuseColor*tcolor.r;","  opacity = opacity * tcolor.g;"]).result;break;default:l=$e.substitute(l,"//VTK::TCoord::Impl",["  vec4 tcolor = texture2D(texture1, tcoordVCVSOutput);","  ambientColor = ambientColor*tcolor.rgb;","  diffuseColor = diffuseColor*tcolor.rgb;","  opacity = opacity * tcolor.a;"]).result}}else switch(o=$e.substitute(o,"//VTK::TCoord::Dec","attribute vec3 tcoordMC; varying vec3 tcoordVCVSOutput;").result,s=$e.substitute(s,"//VTK::TCoord::Dec",["in vec3 tcoordVCVSOutput[];","out vec3 tcoordVCGSOutput;"]).result,s=$e.substitute(s,"//VTK::TCoord::Impl","tcoordVCGSOutput = tcoordVCVSOutput[i];").result,l=$e.substitute(l,"//VTK::TCoord::Dec",["varying vec3 tcoordVCVSOutput;","uniform samplerCube texture1;"]).result,f){case 1:l=$e.substitute(l,"//VTK::TCoord::Impl",["  vec4 tcolor = textureCube(texture1, tcoordVCVSOutput);","  ambientColor = ambientColor*tcolor.r;","  diffuseColor = diffuseColor*tcolor.r;"]).result;break;case 2:l=$e.substitute(l,"//VTK::TCoord::Impl",["  vec4 tcolor = textureCube(texture1, tcoordVCVSOutput);","  ambientColor = ambientColor*tcolor.r;","  diffuseColor = diffuseColor*tcolor.r;","  opacity = opacity * tcolor.g;"]).result;break;default:l=$e.substitute(l,"//VTK::TCoord::Impl",["  vec4 tcolor = textureCube(texture1, tcoordVCVSOutput);","  ambientColor = ambientColor*tcolor.rgb;","  diffuseColor = diffuseColor*tcolor.rgb;","  opacity = opacity * tcolor.a;"]).result}r.Vertex=o,r.Geometry=s,r.Fragment=l}},t.replaceShaderClip=(r,i,a)=>{let o=r.Vertex,s=r.Fragment;if(e.renderable.getNumberOfClippingPlanes()){const l=e.renderable.getNumberOfClippingPlanes();o=$e.substitute(o,"//VTK::Clip::Dec",["uniform int numClipPlanes;",`uniform vec4 clipPlanes[${l}];`,`varying float clipDistancesVSOutput[${l}];`]).result,o=$e.substitute(o,"//VTK::Clip::Impl",[`for (int planeNum = 0; planeNum < ${l}; planeNum++)`,"    {","    if (planeNum >= numClipPlanes)","        {","        break;","        }","    clipDistancesVSOutput[planeNum] = dot(clipPlanes[planeNum], vertexMC);","    }"]).result,s=$e.substitute(s,"//VTK::Clip::Dec",["uniform int numClipPlanes;",`varying float clipDistancesVSOutput[${l}];`]).result,s=$e.substitute(s,"//VTK::Clip::Impl",[`for (int planeNum = 0; planeNum < ${l}; planeNum++)`,"    {","    if (planeNum >= numClipPlanes)","        {","        break;","        }","    if (clipDistancesVSOutput[planeNum] < 0.0) discard;","    }"]).result}r.Vertex=o,r.Fragment=s},t.getCoincidentParameters=(r,i)=>{let a={factor:0,offset:0};const o=i.getProperty();if(e.renderable.getResolveCoincidentTopology()==Dc.PolygonOffset||o.getEdgeVisibility()&&o.getRepresentation()===Up.SURFACE){const l=e.lastBoundBO.getPrimitiveType();l===Na.Points||o.getRepresentation()===Up.POINTS?a=e.renderable.getCoincidentTopologyPointOffsetParameter():l===Na.Lines||o.getRepresentation()===Up.WIREFRAME?a=e.renderable.getCoincidentTopologyLineOffsetParameters():(l===Na.Tris||l===Na.TriStrips)&&(a=e.renderable.getCoincidentTopologyPolygonOffsetParameters()),(l===Na.TrisEdges||l===Na.TriStripsEdges)&&(a=e.renderable.getCoincidentTopologyPolygonOffsetParameters(),a.factor/=2,a.offset/=2)}const s=e._openGLRenderer.getSelector();return s&&s.getFieldAssociation()===JE.FIELD_ASSOCIATION_POINTS&&(a.offset-=2),a},t.replaceShaderPicking=(r,i,a)=>{let o=r.Fragment,s=r.Vertex;if(o=$e.substitute(o,"//VTK::Picking::Dec",["uniform int picking;","//VTK::Picking::Dec"]).result,!!e._openGLRenderer.getSelector()){switch((e.lastSelectionState===Jo.ID_LOW24||e.lastSelectionState===Jo.ID_HIGH24)&&(s=$e.substitute(s,"//VTK::Picking::Dec",[`flat out int vertexIDVSOutput;
`,`uniform int VertexIDOffset;
`]).result,s=$e.substitute(s,"//VTK::Picking::Impl",`  vertexIDVSOutput = gl_VertexID + VertexIDOffset;
`).result,o=$e.substitute(o,"//VTK::Picking::Dec",`flat in int vertexIDVSOutput;
`).result,o=$e.substitute(o,"//VTK::Picking::Impl",["  int idx = vertexIDVSOutput;","//VTK::Picking::Impl"]).result),e.lastSelectionState){case Jo.ID_LOW24:o=$e.substitute(o,"//VTK::Picking::Impl","  gl_FragData[0] = vec4(float(idx%256)/255.0, float((idx/256)%256)/255.0, float((idx/65536)%256)/255.0, 1.0);").result;break;case Jo.ID_HIGH24:o=$e.substitute(o,"//VTK::Picking::Impl","  gl_FragData[0] = vec4(float((idx/16777216)%256)/255.0, 0.0, 0.0, 1.0);").result;break;default:o=$e.substitute(o,"//VTK::Picking::Dec","uniform vec3 mapperIndex;").result,o=$e.substitute(o,"//VTK::Picking::Impl","  gl_FragData[0] = picking != 0 ? vec4(mapperIndex,1.0) : gl_FragData[0];").result}r.Fragment=o,r.Vertex=s}},t.replaceShaderValues=(r,i,a)=>{if(t.replaceShaderColor(r,i,a),t.replaceShaderNormal(r,i,a),t.replaceShaderLight(r,i,a),t.replaceShaderTCoord(r,i,a),t.replaceShaderPicking(r,i,a),t.replaceShaderClip(r,i,a),t.replaceShaderCoincidentOffset(r,i,a),t.replaceShaderPositionVC(r,i,a),e.haveSeenDepthRequest){let o=r.Fragment;o=$e.substitute(o,"//VTK::ZBuffer::Dec","uniform int depthRequest;").result,o=$e.substitute(o,"//VTK::ZBuffer::Impl",["if (depthRequest == 1) {","float iz = floor(gl_FragCoord.z*65535.0 + 0.1);","float rf = floor(iz/256.0)/255.0;","float gf = mod(iz,256.0)/255.0;","gl_FragData[0] = vec4(rf, gf, 0.0, 1.0); }"]).result,r.Fragment=o}},t.getNeedToRebuildShaders=(r,i,a)=>{let o=0,s=0;const l=r.getPrimitiveType(),c=e.currentInput;let f=!1;const u=c.getPointData().getNormals(),d=c.getCellData().getNormals(),h=a.getProperty().getInterpolation()===$V.FLAT,p=a.getProperty().getRepresentation(),g=r.getOpenGLMode(p,l);if((g===e.context.TRIANGLES||d&&!u||!h&&u||!h&&g===e.context.LINES)&&(f=!0),a.getProperty().getLighting()&&f){o=0;const x=i.getLightsByReference();for(let w=0;w<x.length;++w){const S=x[w];S.getSwitch()>0&&(s++,o===0&&(o=1)),o===1&&(s>1||S.getIntensity()!==1||!S.lightTypeIsHeadLight())&&(o=2),o<3&&S.getPositional()&&(o=3)}}let m=!1;const y=e.lastBoundBO.getReferenceByName("lastLightComplexity"),v=e.lastBoundBO.getReferenceByName("lastLightCount");return(y!==o||v!==s)&&(e.lastBoundBO.set({lastLightComplexity:o},!0),e.lastBoundBO.set({lastLightCount:s},!0),m=!0),(!e.currentRenderPass&&e.lastRenderPassShaderReplacement||e.currentRenderPass&&e.currentRenderPass.getShaderReplacement()!==e.lastRenderPassShaderReplacement)&&(m=!0),e.lastHaveSeenDepthRequest!==e.haveSeenDepthRequest||r.getShaderSourceTime().getMTime()<e.renderable.getMTime()||r.getShaderSourceTime().getMTime()<e.currentInput.getMTime()||r.getShaderSourceTime().getMTime()<e.selectionStateChanged.getMTime()||m?(e.lastHaveSeenDepthRequest=e.haveSeenDepthRequest,!0):!1},t.invokeShaderCallbacks=(r,i,a)=>{const o=e.renderable.getViewSpecificProperties().ShadersCallbacks;o&&o.forEach(s=>{s.callback(s.userData,r,i,a)})},t.setMapperShaderParameters=(r,i,a)=>{if(r.getProgram().isUniformUsed("PrimitiveIDOffset")&&r.getProgram().setUniformi("PrimitiveIDOffset",e.primitiveIDOffset),r.getProgram().isUniformUsed("VertexIDOffset")&&r.getProgram().setUniformi("VertexIDOffset",e.vertexIDOffset),r.getCABO().getElementCount()&&(e.VBOBuildTime.getMTime()>r.getAttributeUpdateTime().getMTime()||r.getShaderSourceTime().getMTime()>r.getAttributeUpdateTime().getMTime())){const l=e.lastBoundBO.getReferenceByName("lastLightComplexity");r.getProgram().isAttributeUsed("vertexMC")&&(r.getVAO().addAttributeArray(r.getProgram(),r.getCABO(),"vertexMC",r.getCABO().getVertexOffset(),r.getCABO().getStride(),e.context.FLOAT,3,!1)||G0("Error setting vertexMC in shader VAO.")),r.getProgram().isAttributeUsed("normalMC")&&r.getCABO().getNormalOffset()&&l>0?r.getVAO().addAttributeArray(r.getProgram(),r.getCABO(),"normalMC",r.getCABO().getNormalOffset(),r.getCABO().getStride(),e.context.FLOAT,3,!1)||G0("Error setting normalMC in shader VAO."):r.getVAO().removeAttributeArray("normalMC"),e.renderable.getCustomShaderAttributes().forEach((c,f)=>{r.getProgram().isAttributeUsed(`${c}MC`)&&(r.getVAO().addAttributeArray(r.getProgram(),r.getCABO(),`${c}MC`,r.getCABO().getCustomData()[f].offset,r.getCABO().getStride(),e.context.FLOAT,r.getCABO().getCustomData()[f].components,!1)||G0(`Error setting ${c}MC in shader VAO.`))}),r.getProgram().isAttributeUsed("tcoordMC")&&r.getCABO().getTCoordOffset()?r.getVAO().addAttributeArray(r.getProgram(),r.getCABO(),"tcoordMC",r.getCABO().getTCoordOffset(),r.getCABO().getStride(),e.context.FLOAT,r.getCABO().getTCoordComponents(),!1)||G0("Error setting tcoordMC in shader VAO."):r.getVAO().removeAttributeArray("tcoordMC"),r.getProgram().isAttributeUsed("scalarColor")&&r.getCABO().getColorComponents()?r.getVAO().addAttributeArray(r.getProgram(),r.getCABO().getColorBO(),"scalarColor",r.getCABO().getColorOffset(),r.getCABO().getColorBOStride(),e.context.UNSIGNED_BYTE,4,!0)||G0("Error setting scalarColor in shader VAO."):r.getVAO().removeAttributeArray("scalarColor"),r.getAttributeUpdateTime().modified()}if(e.renderable.getNumberOfClippingPlanes()){const l=e.renderable.getNumberOfClippingPlanes(),c=[],u=r.getCABO().getCoordShiftAndScaleEnabled()?r.getCABO().getInverseShiftAndScaleMatrix():null,d=u?Ri(e.tmpMat4,a.getMatrix()):a.getMatrix();u&&(jn(d,d),zn(d,d,u),jn(d,d));for(let h=0;h<l;h++){const p=[];e.renderable.getClippingPlaneInDataCoords(d,h,p);for(let g=0;g<4;g++)c.push(p[g])}r.getProgram().setUniformi("numClipPlanes",l),r.getProgram().setUniform4fv("clipPlanes",c)}e.internalColorTexture&&r.getProgram().isUniformUsed("texture1")&&r.getProgram().setUniformi("texture1",e.internalColorTexture.getTextureUnit());const o=e.openGLActor.getActiveTextures();if(o)for(let l=0;l<o.length;++l){const f=o[l].getTextureUnit(),u=`texture${f+1}`;r.getProgram().isUniformUsed(u)&&r.getProgram().setUniformi(u,f)}if(e.haveSeenDepthRequest&&r.getProgram().setUniformi("depthRequest",e.renderDepth?1:0),r.getProgram().isUniformUsed("coffset")){const l=t.getCoincidentParameters(i,a);r.getProgram().setUniformf("coffset",l.offset),r.getProgram().isUniformUsed("cfactor")&&r.getProgram().setUniformf("cfactor",l.factor)}r.setMapperShaderParameters(i,a,e._openGLRenderer.getTiledSizeAndOrigin());const s=e._openGLRenderer.getSelector();r.getProgram().setUniform3fArray("mapperIndex",s?s.getPropColorValue():[0,0,0]),r.getProgram().setUniformi("picking",s?s.getCurrentPass()+1:0)},t.setLightingShaderParameters=(r,i,a)=>{const o=e.lastBoundBO.getReferenceByName("lastLightComplexity");if(o<2)return;const s=r.getProgram();let l=0;const c=i.getLightsByReference();for(let d=0;d<c.length;++d){const h=c[d];if(h.getSwitch()>0){const g=h.getColorByReference(),m=h.getIntensity();e.lightColor[0]=g[0]*m,e.lightColor[1]=g[1]*m,e.lightColor[2]=g[2]*m;const y=h.getDirection(),v=i.getActiveCamera().getViewMatrix(),x=[...y];h.lightTypeIsSceneLight()&&(x[0]=v[0]*y[0]+v[1]*y[1]+v[2]*y[2],x[1]=v[4]*y[0]+v[5]*y[1]+v[6]*y[2],x[2]=v[8]*y[0]+v[9]*y[1]+v[10]*y[2],Lh(x)),e.lightDirection[0]=x[0],e.lightDirection[1]=x[1],e.lightDirection[2]=x[2],Lh(e.lightDirection),s.setUniform3fArray(`lightColor${l}`,e.lightColor),s.setUniform3fArray(`lightDirectionVC${l}`,e.lightDirection),l++}}if(o<3)return;const u=i.getActiveCamera().getViewMatrix();jn(u,u),l=0;for(let d=0;d<c.length;++d){const h=c[d];if(h.getSwitch()>0){const g=h.getTransformedPosition(),m=new Float64Array(3);Gn(m,g,u),s.setUniform3fArray(`lightAttenuation${l}`,h.getAttenuationValuesByReference()),s.setUniformi(`lightPositional${l}`,h.getPositional()),s.setUniformf(`lightExponent${l}`,h.getExponent()),s.setUniformf(`lightConeAngle${l}`,h.getConeAngle()),s.setUniform3fArray(`lightPositionVC${l}`,[m[0],m[1],m[2]]),l++}}};function n(r,i,a){return i.identity(a),r.reduce((o,s,l)=>l===0?s?i.copy(o,s):i.identity(o):s?i.multiply(o,o,s):o,a)}t.setCameraShaderParameters=(r,i,a)=>{const o=r.getProgram(),s=e.openGLCamera.getKeyMatrices(i),l=i.getActiveCamera(),c=e.openGLCamera.getKeyMatrixTime().getMTime(),f=o.getLastCameraMTime(),d=r.getCABO().getCoordShiftAndScaleEnabled()?r.getCABO().getInverseShiftAndScaleMatrix():null,h=a.getIsIdentity(),p=h?{mcwc:null,normalMatrix:null}:e.openGLActor.getKeyMatrices();if(a.getCoordinateSystem()===W_e.DISPLAY){const g=e._openGLRenderer.getTiledSizeAndOrigin();on(e.tmpMat4),e.tmpMat4[0]=2/g.usize,e.tmpMat4[12]=-1,e.tmpMat4[5]=2/g.vsize,e.tmpMat4[13]=-1,zn(e.tmpMat4,e.tmpMat4,d),o.setUniformMatrix("MCPCMatrix",e.tmpMat4)}else o.setUniformMatrix("MCPCMatrix",n([s.wcpc,p.mcwc,d],H2,e.tmpMat4));o.isUniformUsed("MCVCMatrix")&&o.setUniformMatrix("MCVCMatrix",n([s.wcvc,p.mcwc,d],H2,e.tmpMat4)),o.isUniformUsed("normalMatrix")&&o.setUniformMatrix3x3("normalMatrix",n([s.normalMatrix,p.normalMatrix],Zwe,e.tmpMat3)),f!==c&&(o.isUniformUsed("cameraParallel")&&o.setUniformi("cameraParallel",l.getParallelProjection()),o.setLastCameraMTime(c)),h||o.setLastCameraMTime(0)},t.setPropertyShaderParameters=(r,i,a)=>{const o=r.getProgram();let s=a.getProperty(),l=s.getOpacity(),c=e.drawingEdges?s.getEdgeColorByReference():s.getAmbientColorByReference(),f=e.drawingEdges?s.getEdgeColorByReference():s.getDiffuseColorByReference(),u=e.drawingEdges?1:s.getAmbient(),d=e.drawingEdges?0:s.getDiffuse(),h=e.drawingEdges?0:s.getSpecular();const p=s.getSpecularPower();o.setUniformf("opacityUniform",l),o.setUniform3fArray("ambientColorUniform",c),o.setUniform3fArray("diffuseColorUniform",f),o.setUniformf("ambient",u),o.setUniformf("diffuse",d);const g=e.lastBoundBO.getReferenceByName("lastLightComplexity");if(g<1)return;let m=s.getSpecularColorByReference();if(o.setUniform3fArray("specularColorUniform",m),o.setUniformf("specularPowerUniform",p),o.setUniformf("specular",h),o.isUniformUsed("ambientIntensityBF")){if(s=a.getBackfaceProperty(),l=s.getOpacity(),c=s.getAmbientColor(),u=s.getAmbient(),f=s.getDiffuseColor(),d=s.getDiffuse(),m=s.getSpecularColor(),h=s.getSpecular(),o.setUniformf("ambientIntensityBF",u),o.setUniformf("diffuseIntensityBF",d),o.setUniformf("opacityUniformBF",l),o.setUniform3fArray("ambientColorUniformBF",c),o.setUniform3fArray("diffuseColorUniformBF",f),g<1)return;o.setUniformf("specularIntensityBF",h),o.setUniform3fArray("specularColorUniformBF",m),o.setUniformf("specularPowerUniformBF",p)}},t.updateMaximumPointCellIds=(r,i)=>{const a=e._openGLRenderer.getSelector();if(!a)return;if(e.selectionWebGLIdsToVTKIds?.points?.length){const s=e.selectionWebGLIdsToVTKIds.points.length;a.setMaximumPointId(s-1)}if(e.selectionWebGLIdsToVTKIds?.cells?.length){const s=e.selectionWebGLIdsToVTKIds.cells.length;a.setMaximumCellId(s-1)}a.getFieldAssociation()===JE.FIELD_ASSOCIATION_POINTS&&(e.pointPicking=!0)},t.renderPieceStart=(r,i)=>{e.primitiveIDOffset=0,e.vertexIDOffset=0;const a=H_e(e._openGLRenderer);e.lastSelectionState!==a&&(e.selectionStateChanged.modified(),e.lastSelectionState=a),e._openGLRenderer.getSelector()&&e._openGLRenderer.getSelector().renderProp(i),t.updateBufferObjects(r,i),e.renderable.getColorTextureMap()&&e.internalColorTexture.activate(),e.lastBoundBO=null},t.renderPieceDraw=(r,i)=>{const a=i.getProperty().getRepresentation(),o=i.getProperty().getEdgeVisibility()&&a===Up.SURFACE,s=e._openGLRenderer.getSelector(),l=s&&s.getFieldAssociation()===JE.FIELD_ASSOCIATION_POINTS&&(e.lastSelectionState===Jo.ID_LOW24||e.lastSelectionState===Jo.ID_HIGH24);for(let c=Na.Start;c<Na.End;c++)e.primitives[c].setPointPicking(l),e.primitives[c].getCABO().getElementCount()&&(e.drawingEdges=o&&(c===Na.TrisEdges||c===Na.TriStripsEdges),(!e.drawingEdges||!(e.renderDepth||e.lastSelectionState>=0))&&(e.lastBoundBO=e.primitives[c],e.primitiveIDOffset+=e.primitives[c].drawArrays(r,i,a,t),e.vertexIDOffset+=e.primitives[c].getCABO().getElementCount()))},t.renderPieceFinish=(r,i)=>{e.LastBoundBO&&e.LastBoundBO.getVAO().release(),e.renderable.getColorTextureMap()&&e.internalColorTexture.deactivate()},t.renderPiece=(r,i)=>{if(t.invokeEvent(j_e),e.renderable.getStatic()||e.renderable.update(),e.currentInput=e.renderable.getInputData(),t.invokeEvent(z_e),!e.currentInput){G0("No input!");return}if(!e.currentInput.getPoints||!e.currentInput.getPoints().getNumberOfValues())return;const a=e.context,o=i.getProperty().getBackfaceCulling(),s=i.getProperty().getFrontfaceCulling();!o&&!s?e._openGLRenderWindow.disableCullFace():s?(e._openGLRenderWindow.enableCullFace(),a.cullFace(a.FRONT)):(e._openGLRenderWindow.enableCullFace(),a.cullFace(a.BACK)),t.renderPieceStart(r,i),t.renderPieceDraw(r,i),t.renderPieceFinish(r,i)},t.computeBounds=(r,i)=>{if(!t.getInput()){jm(e.bounds);return}e.bounds=t.getInput().getBounds()},t.updateBufferObjects=(r,i)=>{t.getNeedToRebuildBufferObjects(r,i)&&t.buildBufferObjects(r,i),t.updateMaximumPointCellIds()},t.getNeedToRebuildBufferObjects=(r,i)=>{const a=e.VBOBuildTime.getMTime();return a<t.getMTime()||a<e.renderable.getMTime()||a<i.getMTime()||a<e.currentInput.getMTime()},t.buildBufferObjects=(r,i)=>{const a=e.currentInput;if(a===null)return;e.renderable.mapScalars(a,1);const o=e.renderable.getColorMapColors();e.haveCellScalars=!1;const s=e.renderable.getScalarMode();e.renderable.getScalarVisibility()&&(s===zx.USE_CELL_DATA||s===zx.USE_CELL_FIELD_DATA||s===zx.USE_FIELD_DATA||!a.getPointData().getScalars())&&s!==zx.USE_POINT_FIELD_DATA&&o&&(e.haveCellScalars=!0);let l=i.getProperty().getInterpolation()!==$V.FLAT?a.getPointData().getNormals():null;l===null&&a.getCellData().getNormals()&&(e.haveCellNormals=!0,l=a.getCellData().getNormals());const c=i.getProperty().getRepresentation();let f=a.getPointData().getTCoords();e.openGLActor.getActiveTextures()||(f=null);let u=!1;if(e.renderable.getColorCoordinates()){f=e.renderable.getColorCoordinates(),u=e.renderable.getAreScalarsMappedFromCells(),e.internalColorTexture||(e.internalColorTexture=ai.newInstance({resizable:!0}));const h=e.internalColorTexture;h.setMinificationFilter(GV.NEAREST),h.setMagnificationFilter(GV.NEAREST),h.setWrapS(jV.CLAMP_TO_EDGE),h.setWrapT(jV.CLAMP_TO_EDGE),h.setOpenGLRenderWindow(e._openGLRenderWindow);const p=e.renderable.getColorTextureMap(),g=p.getExtent(),m=p.getPointData().getScalars();h.create2DFromRaw(g[1]-g[0]+1,g[3]-g[2]+1,m.getNumberOfComponents(),m.getDataType(),m.getData()),h.activate(),h.sendParameters(),h.deactivate()}const d=`${a.getMTime()}A${c}B${a.getMTime()}C${l?l.getMTime():1}D${o?o.getMTime():1}E${i.getProperty().getEdgeVisibility()}F${f?f.getMTime():1}`;if(e.VBOBuildString!==d){const p={points:a.getPoints(),normals:l,tcoords:f,colors:o,cellOffset:0,vertexOffset:0,useTCoordsPerCell:u,haveCellScalars:e.haveCellScalars,haveCellNormals:e.haveCellNormals,customAttributes:e.renderable.getCustomShaderAttributes().map(y=>a.getPointData().getArrayByName(y))};e.renderable.getPopulateSelectionSettings()&&(e.selectionWebGLIdsToVTKIds={points:null,cells:null});const g=[{inRep:"verts",cells:a.getVerts()},{inRep:"lines",cells:a.getLines()},{inRep:"polys",cells:a.getPolys()},{inRep:"strips",cells:a.getStrips()},{inRep:"polys",cells:a.getPolys()},{inRep:"strips",cells:a.getStrips()}],m=i.getProperty().getEdgeVisibility()&&c===Up.SURFACE;for(let y=Na.Start;y<Na.End;y++)y!==Na.TrisEdges&&y!==Na.TriStripsEdges?(p.cellOffset+=e.primitives[y].getCABO().createVBO(g[y].cells,g[y].inRep,c,p,e.selectionWebGLIdsToVTKIds),p.vertexOffset+=e.primitives[y].getCABO().getElementCount()):m?e.primitives[y].getCABO().createVBO(g[y].cells,g[y].inRep,Up.WIREFRAME,{...p,tcoords:null,colors:null,haveCellScalars:!1,haveCellNormals:!1}):e.primitives[y].releaseGraphicsResources();e.renderable.getPopulateSelectionSettings()&&e.renderable.setSelectionWebGLIdsToVTKIds(e.selectionWebGLIdsToVTKIds),e.VBOBuildString=d}e.VBOBuildTime.modified()},t.getAllocatedGPUMemoryInBytes=()=>{let r=0;return e.primitives.forEach(i=>{r+=i.getAllocatedGPUMemoryInBytes()}),r}}const q_e={context:null,VBOBuildTime:0,VBOBuildString:null,primitives:null,primTypes:null,shaderRebuildString:null,tmpMat4:null,ambientColor:[],diffuseColor:[],specularColor:[],lightColor:[],lightDirection:[],lastHaveSeenDepthRequest:!1,haveSeenDepthRequest:!1,lastSelectionState:Jo.MIN_KNOWN_PASS-1,selectionStateChanged:null,selectionWebGLIdsToVTKIds:null,pointPicking:!1};function uZ(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,q_e,n),kr.extend(t,e,n),xu.implementReplaceShaderCoincidentOffset(t,e,n),xu.implementBuildShadersWithReplacements(t,e,n),e.primitives=[],e.primTypes=Na,e.tmpMat3=Bl(new Float64Array(9)),e.tmpMat4=on(new Float64Array(16));for(let r=Na.Start;r<Na.End;r++)e.primitives[r]=Du.newInstance(),e.primitives[r].setPrimitiveType(r),e.primitives[r].set({lastLightComplexity:0,lastLightCount:0,lastSelectionPass:!1},!0);Ni(t,e,["context"]),e.VBOBuildTime={},Wr(e.VBOBuildTime,{mtime:0}),e.selectionStateChanged={},Wr(e.selectionStateChanged,{mtime:0}),K_e(t,e)}const fZ=Qn(uZ,"vtkOpenGLPolyDataMapper");var XC={newInstance:fZ,extend:uZ};ha("vtkMapper",fZ);const{vtkErrorMacro:av}=wo,{Representation:X_e}=Yh,{ObjectType:Wx}=Ef,{PassTypes:Y_e}=k7,J_e={type:"StartEvent"},Z_e={type:"EndEvent"};function Q_e(t,e){e.classHierarchy.push("vtkOpenGLGlyph3DMapper");const n={...t};t.renderPiece=(r,i)=>{if(t.invokeEvent(J_e),e.renderable.getStatic()||e.renderable.update(),e.currentInput=e.renderable.getInputData(1),t.invokeEvent(Z_e),!e.currentInput){av("No input!");return}if(!e.currentInput.getPoints||!e.currentInput.getPoints().getNumberOfValues())return;const a=e.context;e._openGLRenderWindow.getWebgl2()?(e.hardwareSupport=!0,e.extension=null):e.extension||(e.extension=e.context.getExtension("ANGLE_instanced_arrays"),e.hardwareSupport=!!e.extension);const o=i.getProperty().getBackfaceCulling(),s=i.getProperty().getFrontfaceCulling();!o&&!s?e._openGLRenderWindow.disableCullFace():s?(e._openGLRenderWindow.enableCullFace(),a.cullFace(a.FRONT)):(e._openGLRenderWindow.enableCullFace(),a.cullFace(a.BACK)),t.renderPieceStart(r,i),t.renderPieceDraw(r,i),t.renderPieceFinish(r,i)},t.multiply4x4WithOffset=(r,i,a,o)=>{const s=i[0],l=i[1],c=i[2],f=i[3],u=i[4],d=i[5],h=i[6],p=i[7],g=i[8],m=i[9],y=i[10],v=i[11],x=i[12],w=i[13],S=i[14],T=i[15];let _=a[o],D=a[o+1],I=a[o+2],R=a[o+3];r[0]=_*s+D*u+I*g+R*x,r[1]=_*l+D*d+I*m+R*w,r[2]=_*c+D*h+I*y+R*S,r[3]=_*f+D*p+I*v+R*T,_=a[o+4],D=a[o+5],I=a[o+6],R=a[o+7],r[4]=_*s+D*u+I*g+R*x,r[5]=_*l+D*d+I*m+R*w,r[6]=_*c+D*h+I*y+R*S,r[7]=_*f+D*p+I*v+R*T,_=a[o+8],D=a[o+9],I=a[o+10],R=a[o+11],r[8]=_*s+D*u+I*g+R*x,r[9]=_*l+D*d+I*m+R*w,r[10]=_*c+D*h+I*y+R*S,r[11]=_*f+D*p+I*v+R*T,_=a[o+12],D=a[o+13],I=a[o+14],R=a[o+15],r[12]=_*s+D*u+I*g+R*x,r[13]=_*l+D*d+I*m+R*w,r[14]=_*c+D*h+I*y+R*S,r[15]=_*f+D*p+I*v+R*T},t.replaceShaderNormal=(r,i,a)=>{if(e.hardwareSupport&&e.lastBoundBO.getReferenceByName("lastLightComplexity")>0){let s=r.Vertex;e.lastBoundBO.getCABO().getNormalOffset()&&(s=$e.substitute(s,"//VTK::Normal::Dec",["attribute vec3 normalMC;","attribute mat3 gNormal;","uniform mat3 normalMatrix;","varying vec3 normalVCVSOutput;"]).result,s=$e.substitute(s,"//VTK::Normal::Impl",["normalVCVSOutput = normalMatrix * gNormal * normalMC;"]).result),r.Vertex=s}n.replaceShaderNormal(r,i,a)},t.replaceShaderColor=(r,i,a)=>{if(e.hardwareSupport&&e.renderable.getColorArray()){let o=r.Vertex,s=r.Geometry,l=r.Fragment;const c=e.lastBoundBO.getReferenceByName("lastLightComplexity");let f=["uniform float ambient;","uniform float diffuse;","uniform float specular;","uniform float opacityUniform; // the fragment opacity"];c&&(f=f.concat(["uniform vec3 specularColorUniform;","uniform float specularPowerUniform;"]));let u=["vec3 ambientColor;","  vec3 diffuseColor;","  float opacity;"];c&&(u=u.concat(["  vec3 specularColor;","  float specularPower;"])),u=u.concat(["  opacity = opacityUniform;"]),c&&(u=u.concat(["  specularColor = specularColorUniform;","  specularPower = specularPowerUniform;"])),e.drawingEdges||(f=f.concat(["varying vec4 vertexColorVSOutput;"]),o=$e.substitute(o,"//VTK::Color::Dec",["attribute vec4 gColor;","varying vec4 vertexColorVSOutput;"]).result,o=$e.substitute(o,"//VTK::Color::Impl",["vertexColorVSOutput = gColor;"]).result,s=$e.substitute(s,"//VTK::Color::Dec",["in vec4 vertexColorVSOutput[];","out vec4 vertexColorGSOutput;"]).result,s=$e.substitute(s,"//VTK::Color::Impl",["vertexColorGSOutput = vertexColorVSOutput[i];"]).result,u=u.concat(["  diffuseColor = vertexColorVSOutput.rgb;","  ambientColor = vertexColorVSOutput.rgb;","  opacity = opacity*vertexColorVSOutput.a;"])),l=$e.substitute(l,"//VTK::Color::Impl",u).result,l=$e.substitute(l,"//VTK::Color::Dec",f).result,r.Vertex=o,r.Geometry=s,r.Fragment=l}n.replaceShaderColor(r,i,a)},t.replaceShaderPositionVC=(r,i,a)=>{if(e.hardwareSupport){let o=r.Vertex;e.lastBoundBO.getReferenceByName("lastLightComplexity")>0?(o=$e.substitute(o,"//VTK::PositionVC::Impl",["vec4 gVertexMC = gMatrix * vertexMC;","vertexVCVSOutput = MCVCMatrix * gVertexMC;","  gl_Position = MCPCMatrix * gVertexMC;"]).result,o=$e.substitute(o,"//VTK::Camera::Dec",["attribute mat4 gMatrix;","uniform mat4 MCPCMatrix;","uniform mat4 MCVCMatrix;"]).result):(o=$e.substitute(o,"//VTK::Camera::Dec",["attribute mat4 gMatrix;","uniform mat4 MCPCMatrix;"]).result,o=$e.substitute(o,"//VTK::PositionVC::Impl",["vec4 gVertexMC = gMatrix * vertexMC;","  gl_Position = MCPCMatrix * gVertexMC;"]).result),r.Vertex=o}n.replaceShaderPositionVC(r,i,a)},t.replaceShaderPicking=(r,i,a)=>{if(e.hardwareSupport){let o=r.Fragment,s=r.Vertex;s=$e.substitute(s,"//VTK::Picking::Dec",["attribute vec3 mapperIndexVS;","varying vec3 mapperIndexVSOutput;"]).result,s=$e.substitute(s,"//VTK::Picking::Impl","  mapperIndexVSOutput = mapperIndexVS;").result,r.Vertex=s,o=$e.substitute(o,"//VTK::Picking::Dec",["varying vec3 mapperIndexVSOutput;","uniform vec3 mapperIndex;","uniform int picking;"]).result,o=$e.substitute(o,"//VTK::Picking::Impl",["  vec4 pickColor = picking == 2 ? vec4(mapperIndexVSOutput,1.0) : vec4(mapperIndex,1.0);","  gl_FragData[0] = picking != 0 ? pickColor : gl_FragData[0];"]).result,r.Fragment=o}else n.replaceShaderPicking(r,i,a)},t.updateGlyphShaderParameters=(r,i,a,o,s,l,c,f)=>{const u=a.getProgram();if(r){const d=e.normalMatrix,h=l,p=c*9,g=e.tmpMat3,m=d[0],y=d[1],v=d[2],x=d[3],w=d[4],S=d[5],T=d[6],_=d[7],D=d[8],I=h[p],R=h[p+1],O=h[p+2],P=h[p+3],N=h[p+4],A=h[p+5],B=h[p+6],V=h[p+7],$=h[p+8];g[0]=I*m+R*x+O*T,g[1]=I*y+R*w+O*_,g[2]=I*v+R*S+O*D,g[3]=P*m+N*x+A*T,g[4]=P*y+N*w+A*_,g[5]=P*v+N*S+A*D,g[6]=B*m+V*x+$*T,g[7]=B*y+V*w+$*_,g[8]=B*v+V*S+$*D,u.setUniformMatrix3x3("normalMatrix",e.tmpMat3)}if(t.multiply4x4WithOffset(e.tmpMat4,e.mcpcMatrix,s,c*16),u.setUniformMatrix("MCPCMatrix",e.tmpMat4),i&&(t.multiply4x4WithOffset(e.tmpMat4,e.mcvcMatrix,s,c*16),u.setUniformMatrix("MCVCMatrix",e.tmpMat4)),o){const d=o.getData();e.tmpColor[0]=d[c*4]/255,e.tmpColor[1]=d[c*4+1]/255,e.tmpColor[2]=d[c*4+2]/255,u.setUniform3fArray("ambientColorUniform",e.tmpColor),u.setUniform3fArray("diffuseColorUniform",e.tmpColor)}f&&u.setUniform3fArray("mapperIndex",f.getPropColorValue())},t.renderPieceDraw=(r,i)=>{const a=i.getProperty().getRepresentation(),o=e.context,s=i.getProperty().getEdgeVisibility()&&a===X_e.SURFACE,l=e.openGLCamera.getKeyMatrices(r),c=e.openGLActor.getKeyMatrices();hm(e.normalMatrix,l.normalMatrix,c.normalMatrix),zn(e.mcpcMatrix,l.wcpc,c.mcwc),zn(e.mcvcMatrix,l.wcvc,c.mcwc);const f=e.renderable.getMatrixArray(),u=e.renderable.getNormalArray(),d=e.renderable.getColorArray(),h=f.length/16;let p=!1;e._openGLRenderer.getSelector()&&e._openGLRenderer.getSelector().getCurrentPass()===Y_e.COMPOSITE_INDEX_PASS&&(p=!0);for(let g=e.primTypes.Start;g<e.primTypes.End;g++){const m=e.primitives[g].getCABO();if(m.getElementCount()){e.drawingEdges=s&&(g===e.primTypes.TrisEdges||g===e.primTypes.TriStripsEdges),e.lastBoundBO=e.primitives[g],e.primitives[g].updateShaders(r,i,t);const y=e.primitives[g].getProgram(),v=e.primitives[g].getOpenGLMode(a),x=y.isUniformUsed("normalMatrix"),w=y.isUniformUsed("MCVCMatrix");if(e.hardwareSupport)e.extension?e.extension.drawArraysInstancedANGLE(v,0,m.getElementCount(),h):o.drawArraysInstanced(v,0,m.getElementCount(),h);else for(let S=0;S<h;++S)p&&e._openGLRenderer.getSelector().renderCompositeIndex(S),t.updateGlyphShaderParameters(x,w,e.primitives[g],d,f,u,S,p?e._openGLRenderer.getSelector():null),o.drawArrays(v,0,m.getElementCount())}}},t.setMapperShaderParameters=(r,i,a)=>{if(r.getCABO().getElementCount()&&(e.glyphBOBuildTime.getMTime()>r.getAttributeUpdateTime().getMTime()||r.getShaderSourceTime().getMTime()>r.getAttributeUpdateTime().getMTime())){r.getProgram().isAttributeUsed("gMatrix")?r.getVAO().addAttributeMatrixWithDivisor(r.getProgram(),e.matrixBuffer,"gMatrix",0,64,e.context.FLOAT,4,!1,1)||av("Error setting gMatrix in shader VAO."):r.getVAO().removeAttributeArray("gMatrix"),r.getProgram().isAttributeUsed("gNormal")?r.getVAO().addAttributeMatrixWithDivisor(r.getProgram(),e.normalBuffer,"gNormal",0,36,e.context.FLOAT,3,!1,1)||av("Error setting gNormal in shader VAO."):r.getVAO().removeAttributeArray("gNormal"),r.getProgram().isAttributeUsed("gColor")?r.getVAO().addAttributeArrayWithDivisor(r.getProgram(),e.colorBuffer,"gColor",0,4,e.context.UNSIGNED_BYTE,4,!0,1,!1)||av("Error setting gColor in shader VAO."):r.getVAO().removeAttributeArray("gColor"),r.getProgram().isAttributeUsed("mapperIndexVS")?r.getVAO().addAttributeArrayWithDivisor(r.getProgram(),e.pickBuffer,"mapperIndexVS",0,4,e.context.UNSIGNED_BYTE,4,!0,1,!1)||av("Error setting mapperIndexVS in shader VAO."):r.getVAO().removeAttributeArray("mapperIndexVS"),n.setMapperShaderParameters(r,i,a),r.getAttributeUpdateTime().modified();return}n.setMapperShaderParameters(r,i,a)},t.getNeedToRebuildBufferObjects=(r,i)=>(e.renderable.buildArrays(),e.VBOBuildTime.getMTime()<e.renderable.getBuildTime().getMTime()?!0:n.getNeedToRebuildBufferObjects(r,i)),t.getNeedToRebuildShaders=(r,i,a)=>!!(n.getNeedToRebuildShaders(r,i,a)||r.getShaderSourceTime().getMTime()<e.renderable.getMTime()||r.getShaderSourceTime().getMTime()<e.currentInput.getMTime()),t.buildBufferObjects=(r,i)=>{if(e.hardwareSupport){const a=e.renderable.getMatrixArray(),o=e.renderable.getNormalArray(),s=e.renderable.getColorArray();if(e.matrixBuffer||(e.matrixBuffer=Ef.newInstance(),e.matrixBuffer.setOpenGLRenderWindow(e._openGLRenderWindow),e.normalBuffer=Ef.newInstance(),e.normalBuffer.setOpenGLRenderWindow(e._openGLRenderWindow),e.colorBuffer=Ef.newInstance(),e.colorBuffer.setOpenGLRenderWindow(e._openGLRenderWindow),e.pickBuffer=Ef.newInstance(),e.pickBuffer.setOpenGLRenderWindow(e._openGLRenderWindow)),e.renderable.getBuildTime().getMTime()>e.glyphBOBuildTime.getMTime()){e.matrixBuffer.upload(a,Wx.ARRAY_BUFFER),e.normalBuffer.upload(o,Wx.ARRAY_BUFFER),s?e.colorBuffer.upload(s.getData(),Wx.ARRAY_BUFFER):e.colorBuffer.releaseGraphicsResources();const l=a.length/16,c=new Uint8Array(4*l);for(let f=0;f<l;++f){let u=f+1;const d=f*4;c[d]=u%256,u-=c[d],u/=256,c[d+1]=u%256,u-=c[d+1],u/=256,c[d+2]=u%256,c[d+3]=255}e.pickBuffer.upload(c,Wx.ARRAY_BUFFER),e.glyphBOBuildTime.modified()}}return n.buildBufferObjects(r,i)}}const e9e={normalMatrix:null,mcpcMatrix:null,mcwcMatrix:null};function t9e(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,e9e,n),XC.extend(t,e,n),e.tmpMat3=Bl(new Float64Array(9)),e.normalMatrix=Bl(new Float64Array(9)),e.mcpcMatrix=on(new Float64Array(16)),e.mcvcMatrix=on(new Float64Array(16)),e.tmpColor=[],e.glyphBOBuildTime={},Wr(e.glyphBOBuildTime,{mtime:0}),Q_e(t,e)}const dZ=Qn(t9e,"vtkOpenGLGlyph3DMapper");var n9e={newInstance:dZ};ha("vtkGlyph3DMapper",dZ);const{vtkErrorMacro:zV}=wo;function r9e(t,e){e.classHierarchy.push("vtkOpenGLSkybox"),t.buildPass=n=>{if(n){e._openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e._openGLRenderWindow=e._openGLRenderer.getParent(),e.context=e._openGLRenderWindow.getContext(),e.tris.setOpenGLRenderWindow(e._openGLRenderWindow),e.openGLTexture.setOpenGLRenderWindow(e._openGLRenderWindow);const r=e._openGLRenderer.getRenderable();e.openGLCamera=e._openGLRenderer.getViewNodeFor(r.getActiveCamera())}},t.queryPass=(n,r)=>{if(n){if(!e.renderable||!e.renderable.getVisibility())return;r.incrementOpaqueActorCount()}},t.opaquePass=(n,r)=>{if(n&&!e._openGLRenderer.getSelector()){t.updateBufferObjects(),e.context.depthMask(!0),e._openGLRenderWindow.getShaderCache().readyShaderProgram(e.tris.getProgram()),e.openGLTexture.render(e._openGLRenderWindow);const i=e.openGLTexture.getTextureUnit();e.tris.getProgram().setUniformi("sbtexture",i);const a=e._openGLRenderer.getRenderable(),o=e.openGLCamera.getKeyMatrices(a),s=new Float64Array(16);if(Ea(s,o.wcpc),e.tris.getProgram().setUniformMatrix("IMCPCMatrix",s),e.lastFormat==="box"){const l=a.getActiveCamera().getPosition();e.tris.getProgram().setUniform3f("camPos",l[0],l[1],l[2])}e.tris.getVAO().bind(),e.context.drawArrays(e.context.TRIANGLES,0,e.tris.getCABO().getElementCount()),e.tris.getVAO().release(),e.openGLTexture.deactivate()}},t.updateBufferObjects=()=>{if(!e.tris.getCABO().getElementCount()){const r=new Float32Array(12);for(let s=0;s<4;s++)r[s*3]=s%2*2-1,r[s*3+1]=s>1?1:-1,r[s*3+2]=1;const i=tn.newInstance({numberOfComponents:3,values:r});i.setName("points");const a=new Uint16Array(8);a[0]=3,a[1]=0,a[2]=1,a[3]=3,a[4]=3,a[5]=0,a[6]=3,a[7]=2;const o=tn.newInstance({numberOfComponents:1,values:a});e.tris.getCABO().createVBO(o,"polys",go.SURFACE,{points:i,cellOffset:0})}e.renderable.getFormat()!==e.lastFormat&&(e.lastFormat=e.renderable.getFormat(),e.lastFormat==="box"&&e.tris.setProgram(e._openGLRenderWindow.getShaderCache().readyShaderProgramArray(`//VTK::System::Dec
             attribute vec3 vertexMC;
             uniform mat4 IMCPCMatrix;
             varying vec3 TexCoords;
             void main () {
              gl_Position = vec4(vertexMC.xyz, 1.0);
              vec4 wpos = IMCPCMatrix * gl_Position;
              TexCoords = wpos.xyz/wpos.w;
             }`,`//VTK::System::Dec
             //VTK::Output::Dec
             varying vec3 TexCoords;
             uniform samplerCube sbtexture;
             uniform vec3 camPos;
             void main () {
               // skybox looks from inside out
               // which means we have to adjust
               // our tcoords. Otherwise text would
               // be flipped
               vec3 tc = normalize(TexCoords - camPos);
               if (abs(tc.z) < max(abs(tc.x),abs(tc.y)))
               {
                 tc = vec3(1.0, 1.0, -1.0) * tc;
               }
               else
               {
                 tc = vec3(-1.0, 1.0, 1.0) * tc;
               }
               gl_FragData[0] = textureCube(sbtexture, tc);
             }`,"")),e.lastFormat==="background"&&e.tris.setProgram(e._openGLRenderWindow.getShaderCache().readyShaderProgramArray(`//VTK::System::Dec
             attribute vec3 vertexMC;
             uniform mat4 IMCPCMatrix;
             varying vec2 TexCoords;
             void main () {
              gl_Position = vec4(vertexMC.xyz, 1.0);
              vec4 wpos = IMCPCMatrix * gl_Position;
              TexCoords = vec2(vertexMC.x, vertexMC.y)*0.5 + 0.5;
             }`,`//VTK::System::Dec
             //VTK::Output::Dec
             varying vec2 TexCoords;
             uniform sampler2D sbtexture;
             void main () {
               gl_FragData[0] = texture2D(sbtexture, TexCoords);
             }`,"")),e.tris.getShaderSourceTime().modified(),e.tris.getVAO().bind(),e.tris.getVAO().addAttributeArray(e.tris.getProgram(),e.tris.getCABO(),"vertexMC",e.tris.getCABO().getVertexOffset(),e.tris.getCABO().getStride(),e.context.FLOAT,3,e.context.FALSE)||zV("Error setting vertexMC in shader VAO."));const n=e.renderable.getTextures();n.length||zV("vtkSkybox requires a texture map"),e.openGLTexture.getRenderable()!==n[0]&&(e.openGLTexture.releaseGraphicsResources(e._openGLRenderWindow),e.openGLTexture.setRenderable(n[0]))}}const i9e={context:null};function a9e(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,i9e,n),kr.extend(t,e,n),e.openGLTexture=ai.newInstance(),e.tris=Du.newInstance(),e.keyMatrixTime={},Wr(e.keyMatrixTime,{mtime:0}),e.keyMatrices={normalMatrix:Bl(new Float64Array(9)),mcwc:on(new Float64Array(16))},Ni(t,e,["context"]),Fo(t,e,["activeTextures"]),r9e(t,e)}const hZ=Qn(a9e);var o9e={newInstance:hZ};ha("vtkSkybox",hZ);var s9e=`//VTK::System::Dec

/*=========================================================================

  Program:   Visualization Toolkit
  Module:    vtkSphereMapperVS.glsl

  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen
  All rights reserved.
  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.

     This software is distributed WITHOUT ANY WARRANTY; without even
     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
     PURPOSE.  See the above copyright notice for more information.

=========================================================================*/
// this shader implements imposters in OpenGL for Spheres

attribute vec4 vertexMC;
attribute vec2 offsetMC;

// optional normal declaration
//VTK::Normal::Dec

//VTK::Picking::Dec

// Texture coordinates
//VTK::TCoord::Dec

uniform mat3 normalMatrix; // transform model coordinate directions to view coordinates

// material property values
//VTK::Color::Dec

// clipping plane vars
//VTK::Clip::Dec

// camera and actor matrix values
//VTK::Camera::Dec

varying vec4 vertexVCVSOutput;
varying float radiusVCVSOutput;
varying vec3 centerVCVSOutput;

uniform int cameraParallel;
uniform float scaleFactor;

void main()
{
  //VTK::Picking::Impl

  //VTK::Color::Impl

  //VTK::Normal::Impl

  //VTK::TCoord::Impl

  //VTK::Clip::Impl

  // compute the projected vertex position
  vec2 scaledOffsetMC = scaleFactor * offsetMC;
  vertexVCVSOutput = MCVCMatrix * vertexMC;
  centerVCVSOutput = vertexVCVSOutput.xyz;
  radiusVCVSOutput = length(scaledOffsetMC)*0.5;

  // make the triangle face the camera
  if (cameraParallel == 0)
    {
    vec3 dir = normalize(-vertexVCVSOutput.xyz);
    vec3 base2 = normalize(cross(dir,vec3(1.0,0.0,0.0)));
    vec3 base1 = cross(base2,dir);
    vertexVCVSOutput.xyz = vertexVCVSOutput.xyz + scaledOffsetMC.x*base1 + scaledOffsetMC.y*base2;
    }
  else
    {
    // add in the offset
    vertexVCVSOutput.xy = vertexVCVSOutput.xy + scaledOffsetMC;
    }

  gl_Position = VCPCMatrix * vertexVCVSOutput;
}
`;const{vtkErrorMacro:l9e}=wo;function c9e(t,e){e.classHierarchy.push("vtkOpenGLSphereMapper");const n={...t};t.getShaderTemplate=(r,i,a)=>{r.Vertex=s9e,r.Fragment=Ly,r.Geometry=""},t.replaceShaderValues=(r,i,a)=>{let o=r.Vertex,s=r.Fragment;o=$e.substitute(o,"//VTK::Camera::Dec",[`uniform mat4 VCPCMatrix;
`,"uniform mat4 MCVCMatrix;"]).result,s=$e.substitute(s,"//VTK::PositionVC::Dec",["varying vec4 vertexVCVSOutput;"]).result,s=$e.substitute(s,"//VTK::PositionVC::Impl",[`vec4 vertexVC = vertexVCVSOutput;
`]).result;const l=[`uniform float invertedDepth;
`,`uniform int cameraParallel;
`,`varying float radiusVCVSOutput;
`,`varying vec3 centerVCVSOutput;
`,`uniform mat4 VCPCMatrix;
`];s=$e.substitute(s,"//VTK::Normal::Dec",l).result;let c="";e.context.getExtension("EXT_frag_depth")&&(c=`gl_FragDepthEXT = (pos.z / pos.w + 1.0) / 2.0;
`),e._openGLRenderWindow.getWebgl2()&&(c=`gl_FragDepth = (pos.z / pos.w + 1.0) / 2.0;
`),s=$e.substitute(s,"//VTK::Depth::Impl",[`  vec3 EyePos;
`,`  vec3 EyeDir;
`,`  if (cameraParallel != 0) {
`,`    EyePos = vec3(vertexVC.x, vertexVC.y, vertexVC.z + 3.0*radiusVCVSOutput);
`,`    EyeDir = vec3(0.0,0.0,-1.0); }
`,`  else {
`,`    EyeDir = vertexVC.xyz;
`,`    EyePos = vec3(0.0,0.0,0.0);
`,`    float lengthED = length(EyeDir);
`,`    EyeDir = normalize(EyeDir);
`,`    if (lengthED > radiusVCVSOutput*3.0) {
`,`      EyePos = vertexVC.xyz - EyeDir*3.0*radiusVCVSOutput; }
`,`    }
`,`  EyePos = EyePos - centerVCVSOutput;
`,`  EyePos = EyePos/radiusVCVSOutput;
`,`  float b = 2.0*dot(EyePos,EyeDir);
`,`  float c = dot(EyePos,EyePos) - 1.0;
`,`  float d = b*b - 4.0*c;
`,`  vec3 normalVCVSOutput = vec3(0.0,0.0,1.0);
`,`  if (d < 0.0) { discard; }
`,`  else {
`,`    float t = (-b - invertedDepth*sqrt(d))*0.5;
`,`    normalVCVSOutput = invertedDepth*normalize(EyePos + t*EyeDir);
`,`    vertexVC.xyz = normalVCVSOutput*radiusVCVSOutput + centerVCVSOutput;
`,`    }
`,`  vec4 pos = VCPCMatrix * vertexVC;
`,c]).result,s=$e.substitute(s,"//VTK::Normal::Impl","").result,e.haveSeenDepthRequest&&(s=$e.substitute(s,"//VTK::ZBuffer::Impl",["if (depthRequest == 1) {","float computedZ = (pos.z / pos.w + 1.0) / 2.0;","float iz = floor(computedZ * 65535.0 + 0.1);","float rf = floor(iz/256.0)/255.0;","float gf = mod(iz,256.0)/255.0;","gl_FragData[0] = vec4(rf, gf, 0.0, 1.0); }"]).result),r.Vertex=o,r.Fragment=s,n.replaceShaderValues(r,i,a)},t.setMapperShaderParameters=(r,i,a)=>{if(r.getCABO().getElementCount()&&(e.VBOBuildTime>r.getAttributeUpdateTime().getMTime()||r.getShaderSourceTime().getMTime()>r.getAttributeUpdateTime().getMTime())&&r.getProgram().isAttributeUsed("offsetMC")&&(r.getVAO().addAttributeArray(r.getProgram(),r.getCABO(),"offsetMC",12,r.getCABO().getStride(),e.context.FLOAT,2,!1)||l9e("Error setting 'offsetMC' in shader VAO.")),r.getProgram().isUniformUsed("invertedDepth")&&r.getProgram().setUniformf("invertedDepth",e.invert?-1:1),r.getProgram().isUniformUsed("scaleFactor")){const s=e.currentInput.getPointData();e.renderable.getScaleArray()!=null&&s.hasArray(e.renderable.getScaleArray())?r.getProgram().setUniformf("scaleFactor",e.renderable.getScaleFactor()):r.getProgram().setUniformf("scaleFactor",1)}n.setMapperShaderParameters(r,i,a)},t.setCameraShaderParameters=(r,i,a)=>{const o=r.getProgram(),s=i.getActiveCamera(),l=e.openGLCamera.getKeyMatrices(i);if(o.isUniformUsed("VCPCMatrix")&&o.setUniformMatrix("VCPCMatrix",l.vcpc),o.isUniformUsed("MCVCMatrix"))if(a.getIsIdentity())o.setUniformMatrix("MCVCMatrix",l.wcvc);else{const c=e.openGLActor.getKeyMatrices(),f=new Float64Array(16);zn(f,l.wcvc,c.mcwc),o.setUniformMatrix("MCVCMatrix",f)}o.isUniformUsed("cameraParallel")&&r.getProgram().setUniformi("cameraParallel",s.getParallelProjection())},t.getOpenGLMode=(r,i)=>e.context.TRIANGLES,t.buildBufferObjects=(r,i)=>{const a=e.currentInput;if(a===null)return;e.renderable.mapScalars(a,1);const o=e.renderable.getColorMapColors(),s=e.primitives[e.primTypes.Tris].getCABO(),l=a.getPointData(),c=a.getPoints(),f=c.getNumberOfPoints(),u=c.getData(),d=5;let h=null;e.renderable.getScaleArray()!=null&&l.hasArray(e.renderable.getScaleArray())&&(h=l.getArray(e.renderable.getScaleArray()).getData());let p=null,g=0,m=null;o?(g=o.getNumberOfComponents(),s.setColorOffset(0),s.setColorBOStride(4),p=o.getData(),m=new Uint8Array(3*f*4),s.getColorBO()||s.setColorBO(Ef.newInstance()),s.getColorBO().setOpenGLRenderWindow(e._openGLRenderWindow)):s.getColorBO()&&s.setColorBO(null),s.setColorComponents(g);const y=new Float32Array(d*f*3);s.setStride(d*4);const v=Math.cos(Di(30));let x=0,w=0,S=0,T=0;for(let _=0;_<f;++_){let D=e.renderable.getRadius();h&&(D=h[_]),x=_*3,y[S++]=u[x++],y[S++]=u[x++],y[S++]=u[x++],y[S++]=-2*D*v,y[S++]=-D,p&&(w=_*g,m[T++]=p[w],m[T++]=p[w+1],m[T++]=p[w+2],m[T++]=p[w+3]),x=_*3,y[S++]=u[x++],y[S++]=u[x++],y[S++]=u[x++],y[S++]=2*D*v,y[S++]=-D,p&&(m[T++]=p[w],m[T++]=p[w+1],m[T++]=p[w+2],m[T++]=p[w+3]),x=_*3,y[S++]=u[x++],y[S++]=u[x++],y[S++]=u[x++],y[S++]=0,y[S++]=2*D,p&&(m[T++]=p[w],m[T++]=p[w+1],m[T++]=p[w+2],m[T++]=p[w+3])}s.setElementCount(S/d),s.upload(y,Of.ARRAY_BUFFER),o&&s.getColorBO().upload(m,Of.ARRAY_BUFFER),e.VBOBuildTime.modified()}}const u9e={};function f9e(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,u9e,n),XC.extend(t,e,n),c9e(t,e)}const pZ=Qn(f9e,"vtkOpenGLSphereMapper");var d9e={newInstance:pZ};ha("vtkSphereMapper",pZ);var h9e=`//VTK::System::Dec

/*=========================================================================

  Program:   Visualization Toolkit
  Module:    vtkStickMapperVS.glsl

  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen
  All rights reserved.
  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.

     This software is distributed WITHOUT ANY WARRANTY; without even
     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
     PURPOSE.  See the above copyright notice for more information.

=========================================================================*/
// this shader implements imposters in OpenGL for Sticks

attribute vec4 vertexMC;
attribute vec3 orientMC;
attribute vec4 offsetMC;
attribute float radiusMC;

// optional normal declaration
//VTK::Normal::Dec

//VTK::Picking::Dec

// Texture coordinates
//VTK::TCoord::Dec

uniform mat3 normalMatrix; // transform model coordinate directions to view coordinates

// material property values
//VTK::Color::Dec

// clipping plane vars
//VTK::Clip::Dec

// camera and actor matrix values
//VTK::Camera::Dec

varying vec4 vertexVCVSOutput;
varying float radiusVCVSOutput;
varying float lengthVCVSOutput;
varying vec3 centerVCVSOutput;
varying vec3 orientVCVSOutput;

uniform int cameraParallel;

void main()
{
  //VTK::Picking::Impl

  //VTK::Color::Impl

  //VTK::Normal::Impl

  //VTK::TCoord::Impl

  //VTK::Clip::Impl

  vertexVCVSOutput = MCVCMatrix * vertexMC;
  centerVCVSOutput = vertexVCVSOutput.xyz;
  radiusVCVSOutput = radiusMC;
  lengthVCVSOutput = length(orientMC);
  orientVCVSOutput = normalMatrix * normalize(orientMC);

  // make sure it is pointing out of the screen
  if (orientVCVSOutput.z < 0.0)
    {
    orientVCVSOutput = -orientVCVSOutput;
    }

  // make the basis
  vec3 xbase;
  vec3 ybase;
  vec3 dir = vec3(0.0,0.0,1.0);
  if (cameraParallel == 0)
    {
    dir = normalize(-vertexVCVSOutput.xyz);
    }
  if (abs(dot(dir,orientVCVSOutput)) == 1.0)
    {
    xbase = normalize(cross(vec3(0.0,1.0,0.0),orientVCVSOutput));
    ybase = cross(xbase,orientVCVSOutput);
    }
  else
    {
    xbase = normalize(cross(orientVCVSOutput,dir));
    ybase = cross(orientVCVSOutput,xbase);
    }

  vec3 offsets = offsetMC.xyz*2.0-1.0;
  vertexVCVSOutput.xyz = vertexVCVSOutput.xyz +
    radiusVCVSOutput*offsets.x*xbase +
    radiusVCVSOutput*offsets.y*ybase +
    0.5*lengthVCVSOutput*offsets.z*orientVCVSOutput;

  gl_Position = VCPCMatrix * vertexVCVSOutput;
}
`;const{vtkErrorMacro:Hx}=wo;function p9e(t,e){e.classHierarchy.push("vtkOpenGLStickMapper");const n={...t};t.getShaderTemplate=(r,i,a)=>{r.Vertex=h9e,r.Fragment=Ly,r.Geometry=""},t.replaceShaderValues=(r,i,a)=>{let o=r.Vertex,s=r.Fragment;o=$e.substitute(o,"//VTK::Camera::Dec",[`uniform mat4 VCPCMatrix;
`,"uniform mat4 MCVCMatrix;"]).result,s=$e.substitute(s,"//VTK::PositionVC::Dec","varying vec4 vertexVCVSOutput;").result,s=$e.substitute(s,"//VTK::PositionVC::Impl",`  vec4 vertexVC = vertexVCVSOutput;
`).result;const l=[`uniform int cameraParallel;
`,`varying float radiusVCVSOutput;
`,`varying vec3 orientVCVSOutput;
`,`varying float lengthVCVSOutput;
`,`varying vec3 centerVCVSOutput;
`,`uniform mat4 VCPCMatrix;
`];s=$e.substitute(s,"//VTK::Normal::Dec",l).result;let c="";e.context.getExtension("EXT_frag_depth")&&(c=`  gl_FragDepthEXT = (pos.z / pos.w + 1.0) / 2.0;
`),e._openGLRenderWindow.getWebgl2()&&(c=`gl_FragDepth = (pos.z / pos.w + 1.0) / 2.0;
`),s=$e.substitute(s,"//VTK::Depth::Impl",[`  vec3 EyePos;
`,`  vec3 EyeDir;
`,`  if (cameraParallel != 0) {
`,`    EyePos = vec3(vertexVC.x, vertexVC.y, vertexVC.z + 3.0*radiusVCVSOutput);
`,`    EyeDir = vec3(0.0,0.0,-1.0); }
`,`  else {
`,`    EyeDir = vertexVC.xyz;
`,`    EyePos = vec3(0.0,0.0,0.0);
`,`    float lengthED = length(EyeDir);
`,`    EyeDir = normalize(EyeDir);
`,`    if (lengthED > radiusVCVSOutput*3.0) {
`,`      EyePos = vertexVC.xyz - EyeDir*3.0*radiusVCVSOutput; }
`,`    }
`,`  EyePos = EyePos - centerVCVSOutput;
`,`  vec3 base1;
`,`  if (abs(orientVCVSOutput.z) < 0.99) {
`,`    base1 = normalize(cross(orientVCVSOutput,vec3(0.0,0.0,1.0))); }
`,`  else {
`,`    base1 = normalize(cross(orientVCVSOutput,vec3(0.0,1.0,0.0))); }
`,`  vec3 base2 = cross(orientVCVSOutput,base1);
`,`  EyePos = vec3(dot(EyePos,base1),dot(EyePos,base2),dot(EyePos,orientVCVSOutput));
`,`  EyeDir = vec3(dot(EyeDir,base1),dot(EyeDir,base2),dot(EyeDir,orientVCVSOutput));
`,`  EyePos = EyePos/radiusVCVSOutput;
`,`  float a = EyeDir.x*EyeDir.x + EyeDir.y*EyeDir.y;
`,`  float b = 2.0*(EyePos.x*EyeDir.x + EyePos.y*EyeDir.y);
`,`  float c = EyePos.x*EyePos.x + EyePos.y*EyePos.y - 1.0;
`,`  float d = b*b - 4.0*a*c;
`,`  vec3 normalVCVSOutput = vec3(0.0,0.0,1.0);
`,`  if (d < 0.0) { discard; }
`,`  else {
`,`    float t =  (-b - sqrt(d))/(2.0*a);
`,`    float tz = EyePos.z + t*EyeDir.z;
`,`    vec3 iPoint = EyePos + t*EyeDir;
`,`    if (abs(iPoint.z)*radiusVCVSOutput > lengthVCVSOutput*0.5) {
`,`      float t2 = (-b + sqrt(d))/(2.0*a);
`,`      float tz2 = EyePos.z + t2*EyeDir.z;
`,`      if (tz2*radiusVCVSOutput > lengthVCVSOutput*0.5 || tz*radiusVCVSOutput < -0.5*lengthVCVSOutput) { discard; }
`,`      else {
`,`        normalVCVSOutput = orientVCVSOutput;
`,`        float t3 = (lengthVCVSOutput*0.5/radiusVCVSOutput - EyePos.z)/EyeDir.z;
`,`        iPoint = EyePos + t3*EyeDir;
`,`        vertexVC.xyz = radiusVCVSOutput*(iPoint.x*base1 + iPoint.y*base2 + iPoint.z*orientVCVSOutput) + centerVCVSOutput;
`,`        }
`,`      }
`,`    else {
`,`      normalVCVSOutput = iPoint.x*base1 + iPoint.y*base2;
`,`      vertexVC.xyz = radiusVCVSOutput*(normalVCVSOutput + iPoint.z*orientVCVSOutput) + centerVCVSOutput;
`,`      }
`,`    }
`,`  vec4 pos = VCPCMatrix * vertexVC;
`,c]).result,s=$e.substitute(s,"//VTK::Normal::Impl","").result,e.haveSeenDepthRequest&&(s=$e.substitute(s,"//VTK::ZBuffer::Impl",["if (depthRequest == 1) {","float computedZ = (pos.z / pos.w + 1.0) / 2.0;","float iz = floor(computedZ * 65535.0 + 0.1);","float rf = floor(iz/256.0)/255.0;","float gf = mod(iz,256.0)/255.0;","gl_FragData[0] = vec4(rf, gf, 0.0, 1.0); }"]).result),r.Vertex=o,r.Fragment=s,n.replaceShaderValues(r,i,a)},t.setMapperShaderParameters=(r,i,a)=>{r.getCABO().getElementCount()&&(e.VBOBuildTime>r.getAttributeUpdateTime().getMTime()||r.getShaderSourceTime().getMTime()>r.getAttributeUpdateTime().getMTime())&&(r.getProgram().isAttributeUsed("orientMC")&&(r.getVAO().addAttributeArray(r.getProgram(),r.getCABO(),"orientMC",12,r.getCABO().getStride(),e.context.FLOAT,3,!1)||Hx("Error setting 'orientMC' in shader VAO.")),r.getProgram().isAttributeUsed("offsetMC")&&(r.getVAO().addAttributeArray(r.getProgram(),r.getCABO().getColorBO(),"offsetMC",0,r.getCABO().getColorBOStride(),e.context.UNSIGNED_BYTE,3,!0)||Hx("Error setting 'offsetMC' in shader VAO.")),r.getProgram().isAttributeUsed("radiusMC")&&(r.getVAO().addAttributeArray(r.getProgram(),r.getCABO(),"radiusMC",24,r.getCABO().getStride(),e.context.FLOAT,1,!1)||Hx("Error setting 'radiusMC' in shader VAO."))),n.setMapperShaderParameters(r,i,a)},t.setCameraShaderParameters=(r,i,a)=>{const o=r.getProgram(),s=i.getActiveCamera(),l=e.openGLCamera.getKeyMatrices(i);if(o.isUniformUsed("VCPCMatrix")&&o.setUniformMatrix("VCPCMatrix",l.vcpc),a.getIsIdentity())o.isUniformUsed("MCVCMatrix")&&o.setUniformMatrix("MCVCMatrix",l.wcvc),o.isUniformUsed("normalMatrix")&&o.setUniformMatrix3x3("normalMatrix",l.normalMatrix);else{const c=e.openGLActor.getKeyMatrices();if(o.isUniformUsed("MCVCMatrix")){const f=new Float64Array(16);zn(f,l.wcvc,c.mcwc),o.setUniformMatrix("MCVCMatrix",f)}if(o.isUniformUsed("normalMatrix")){const f=new Float64Array(9);hm(f,l.normalMatrix,c.normalMatrix),o.setUniformMatrix3x3("normalMatrix",f)}}o.isUniformUsed("cameraParallel")&&r.getProgram().setUniformi("cameraParallel",s.getParallelProjection())},t.getOpenGLMode=(r,i)=>e.context.TRIANGLES,t.buildBufferObjects=(r,i)=>{const a=e.currentInput;if(a===null)return;e.renderable.mapScalars(a,1);const o=e.renderable.getColorMapColors(),s=e.primitives[e.primTypes.Tris].getCABO(),l=a.getPointData(),c=a.getPoints(),f=c.getNumberOfPoints(),u=c.getData();let d=3;d+=4;let h=null,p=0;s.setColorBOStride(4),s.getColorBO()||s.setColorBO(Ef.newInstance()),s.getColorBO().setOpenGLRenderWindow(e._openGLRenderWindow),o&&(p=o.getNumberOfComponents(),s.setColorOffset(4),h=o.getData(),s.setColorBOStride(8)),s.setColorComponents(p),s.setStride(d*4);const g=new Float32Array(d*f*12),m=new Uint8Array(12*f*(h?8:4));let y=null,v=null;e.renderable.getScaleArray()!=null&&l.hasArray(e.renderable.getScaleArray())&&(y=l.getArray(e.renderable.getScaleArray()).getData()),e.renderable.getOrientationArray()!=null&&l.hasArray(e.renderable.getOrientationArray())?v=l.getArray(e.renderable.getOrientationArray()).getData():Hx([`Error setting orientationArray.
`,"You have to specify the stick orientation"]);const x=[0,1,3,0,3,2,2,3,5,2,5,4];let w=0,S=0,T=0,_=0;for(let D=0;D<f;++D){let I=e.renderable.getLength(),R=e.renderable.getRadius();y&&(I=y[D*2],R=y[D*2+1]);for(let O=0;O<x.length;++O)w=D*3,g[T++]=u[w++],g[T++]=u[w++],g[T++]=u[w++],w=D*3,g[T++]=v[w++]*I,g[T++]=v[w++]*I,g[T++]=v[w++]*I,g[T++]=R,m[_++]=255*(x[O]%2),m[_++]=x[O]>=4?255:0,m[_++]=x[O]>=2?255:0,m[_++]=255,S=D*p,h&&(m[_++]=h[S],m[_++]=h[S+1],m[_++]=h[S+2],m[_++]=h[S+3])}s.setElementCount(T/d),s.upload(g,Of.ARRAY_BUFFER),s.getColorBO().upload(m,Of.ARRAY_BUFFER),e.VBOBuildTime.modified()}}const g9e={};function m9e(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,g9e,n),XC.extend(t,e,n),p9e(t,e)}const gZ=Qn(m9e,"vtkOpenGLStickMapper");var v9e={newInstance:gZ};ha("vtkStickMapper",gZ);function U7(t,e){switch(t){case"Float32Array":return Float32Array;case"Uint8Array":return Uint8Array;case"Uint32Array":return Uint32Array;case"Uint16Array":case"Int16Array":return e?(console.debug(`${t} is not supported for volume rendering, switching back to Float32Array`),Float32Array):t==="Uint16Array"?Uint16Array:Int16Array;default:if(t)throw new Error("TargetBuffer should be Float32Array, Uint8Array, Uint16Array, Int16Array, or Uint32Array");return Float32Array}}function B7(t,e,n={}){const{isVolumeBuffer:r=!1}=n,i=U7(t,r),a=i.BYTES_PER_ELEMENT;return{numBytes:e*a,TypedArrayConstructor:i}}function y9e(t,e){e.classHierarchy.push("vtkStreamingOpenGLVolumeMapper"),t.buildBufferObjects=(n,r)=>{const i=e.currentInput;if(!i)return;const a=r.getProperty();if(!e.jitterTexture.getHandle()){const g=new Uint8Array(1024);for(let m=0;m<1024;++m)g[m]=255*Math.random();e.jitterTexture.setMinificationFilter(an.LINEAR),e.jitterTexture.setMagnificationFilter(an.LINEAR),e.jitterTexture.create2DFromRaw(32,32,1,Ln.UNSIGNED_CHAR,g)}const{numberOfComponents:o}=i.get("numberOfComponents"),s=t.useIndependentComponents(a),l=a.getScalarOpacity(),c=e._openGLRenderWindow.getGraphicsResourceForObject(l);let f=bu(l,s,o);if(!c?.oglObject||c.hash!==f){e.opacityTexture=ai.newInstance(),e.opacityTexture.setOpenGLRenderWindow(e._openGLRenderWindow);const g=1024,m=g*2*o,y=new Float32Array(m),v=new Float32Array(g);for(let x=0;x<o;++x){const w=a.getScalarOpacity(x),S=t.getCurrentSampleDistance(n)/a.getScalarOpacityUnitDistance(x),T=w.getRange();w.getTable(T[0],T[1],g,v,1);for(let _=0;_<g;++_)y[x*g*2+_]=1-(1-v[_])**S,y[x*g*2+_+g]=y[x*g*2+_]}if(e.opacityTexture.resetFormatAndType(),e.opacityTexture.setMinificationFilter(an.LINEAR),e.opacityTexture.setMagnificationFilter(an.LINEAR),e._openGLRenderWindow.getWebgl2()&&e.context.getExtension("OES_texture_float")&&e.context.getExtension("OES_texture_float_linear"))e.opacityTexture.create2DFromRaw(g,2*o,1,Ln.FLOAT,y);else{const x=new Uint8ClampedArray(m);for(let w=0;w<m;++w)x[w]=255*y[w];e.opacityTexture.create2DFromRaw(g,2*o,1,Ln.UNSIGNED_CHAR,x)}l&&(e._openGLRenderWindow.setGraphicsResourceForObject(l,e.opacityTexture,f),l!==e._scalarOpacityFunc&&(e._openGLRenderWindow.registerGraphicsResourceUser(l,t),e._openGLRenderWindow.unregisterGraphicsResourceUser(e._scalarOpacityFunc,t)),e._scalarOpacityFunc=l)}else e.opacityTexture=c.oglObject;const d=a.getRGBTransferFunction();f=bu(d,s,o);const h=e._openGLRenderWindow.getGraphicsResourceForObject(d);if(!h?.oglObject?.getHandle()||h?.hash!==f){e.colorTexture=ai.newInstance(),e.colorTexture.setOpenGLRenderWindow(e._openGLRenderWindow);const g=1024,m=g*2*o*3,y=new Uint8ClampedArray(m),v=new Float32Array(g*3);for(let x=0;x<o;++x){const w=a.getRGBTransferFunction(x),S=w.getRange();w.getTable(S[0],S[1],g,v,1);for(let T=0;T<g*3;++T)y[x*g*6+T]=255*v[T],y[x*g*6+T+g*3]=255*v[T]}e.colorTexture.resetFormatAndType(),e.colorTexture.setMinificationFilter(an.LINEAR),e.colorTexture.setMagnificationFilter(an.LINEAR),e.colorTexture.create2DFromRaw(g,2*o,3,Ln.UNSIGNED_CHAR,y),d&&(e._openGLRenderWindow.setGraphicsResourceForObject(d,e.colorTexture,f),d!==e._colorTransferFunc&&(e._openGLRenderWindow.registerGraphicsResourceUser(d,t),e._openGLRenderWindow.unregisterGraphicsResourceUser(e._colorTransferFunc,t)),e._colorTransferFunc=d)}else e.colorTexture=h.oglObject;if(t.updateLabelOutlineThicknessTexture(r),f=`${i.getMTime()}-${e.scalarTexture.getMTime()}`,e.scalarTextureString!==f){const g=i.getDimensions();e.scalarTexture.setOpenGLRenderWindow(e._openGLRenderWindow),e.scalarTexture.enableUseHalfFloat(!1);const m=e.scalarTexture.getTextureParameters(),y=i.get("dataType").dataType;let v=!0;if(m?.dataType===y&&m?.width===g[0]&&m?.height===g[1]&&m?.depth===g[2]&&(v=!1),v){const x=e.context.getExtension("EXT_texture_norm16");e.scalarTexture.setOglNorm16Ext(V5e()?x:null),e.scalarTexture.resetFormatAndType(),e.scalarTexture.setTextureParameters({width:g[0],height:g[1],depth:g[2],numberOfComponents:o,dataType:y}),e.scalarTexture.create3DFromRaw(g[0],g[1],g[2],o,y,null),e.scalarTexture.update3DFromRaw()}else e.scalarTexture.deactivate(),e.scalarTexture.update3DFromRaw();e.scalarTextureString=f}if(!e.tris.getCABO().getElementCount()){const g=new Float32Array(12);for(let x=0;x<4;x++)g[x*3]=x%2*2-1,g[x*3+1]=x>1?1:-1,g[x*3+2]=-1;const m=new Uint16Array(8);m[0]=3,m[1]=0,m[2]=1,m[3]=3,m[4]=3,m[5]=0,m[6]=3,m[7]=2;const y=tn.newInstance({numberOfComponents:3,values:g});y.setName("points");const v=tn.newInstance({numberOfComponents:1,values:m});e.tris.getCABO().createVBO(v,"polys",go.SURFACE,{points:y,cellOffset:0})}e.VBOBuildTime.modified()},t.getNeedToRebuildBufferObjects=(n,r)=>e.VBOBuildTime.getMTime()<t.getMTime()||e.VBOBuildTime.getMTime()<r.getMTime()||e.VBOBuildTime.getMTime()<e.renderable.getMTime()||e.VBOBuildTime.getMTime()<r.getProperty().getMTime()||e.VBOBuildTime.getMTime()<e.currentInput.getMTime()||e.VBOBuildTime.getMTime()<e.scalarTexture?.getMTime()||e.VBOBuildTime.getMTime()<e.colorTexture?.getMTime()||e.VBOBuildTime.getMTime()<e.labelOutlineThicknessTexture?.getMTime()||!e.scalarTexture?.getHandle()||!e.colorTexture?.getHandle()||!e.labelOutlineThicknessTexture?.getHandle()}const x9e={};function b9e(t,e,n={}){Object.assign(e,x9e,n),mJ.extend(t,e,n),e.scalarTexture=n.scalarTexture,e.previousState={},y9e(t,e)}const w9e=ce.newInstance(b9e,"vtkStreamingOpenGLVolumeMapper"),C9e={newInstance:w9e},mZ=Object.create(null);function Ya(t,e){mZ[t]=e}function S9e(t,e){e.classHierarchy.push("vtkStreamingOpenGLViewNodeFactory"),t.createNode=n=>{if(n.isDeleted())return null;let r=0,i=n.getClassName(r++),a=!1;const o=Object.keys(e.overrides);for(;i&&!a;)o.includes(i)?a=!0:i=n.getClassName(r++);if(!a)return null;const s=e.getModelInitialValues(n),l=e.overrides[i](s);return l.setMyFactory(t),l},e.overrides=mZ,e.getModelInitialValues=n=>{const r={};return n.getClassName()==="vtkSharedVolumeMapper"&&(r.scalarTexture=n.getScalarTexture()),r}}const T9e={};function vZ(t,e,n={}){Object.assign(e,T9e,n),D7.extend(t,e,n),S9e(t,e),Ya("vtkActor",x_e.newInstance),Ya("vtkActor2D",S_e.newInstance),Ya("vtkCamera",OCe.newInstance),Ya("vtkGlyph3DMapper",n9e.newInstance),Ya("vtkImageMapper",CTe.newInstance),Ya("vtkImageCPRMapper",DTe.newInstance),Ya("vtkImageSlice",RTe.newInstance),Ya("vtkMapper",XC.newInstance),Ya("vtkPixelSpaceCallbackMapper",XTe.newInstance),Ya("vtkRenderer",ACe.newInstance),Ya("vtkSkybox",o9e.newInstance),Ya("vtkSphereMapper",d9e.newInstance),Ya("vtkStickMapper",v9e.newInstance),Ya("vtkTexture",ai.newInstance),Ya("vtkVolume",LTe.newInstance),Ya("vtkVolumeMapper",mJ.newInstance),Ya("vtkSharedVolumeMapper",C9e.newInstance)}const E9e=ce.newInstance(vZ,"vtkStreamingOpenGLViewNodeFactory"),_9e={newInstance:E9e,extend:vZ};function D9e(t,e){e.classHierarchy.push("vtkStreamingOpenGLRenderWindow")}function yZ(t,e,n={}){Object.assign(e,n),g_e.extend(t,e,n),e.myFactory=_9e.newInstance(),Ya("vtkRenderWindow",xZ),D9e(t,e)}const xZ=ce.newInstance(yZ,"vtkStreamingOpenGLRenderWindow"),O9e={newInstance:xZ,extend:yZ},{vtkDebugMacro:Kx}=ce;function M9e(t,e){e.classHierarchy.push("vtkCamera");const n=new Float64Array(3),r=new Float64Array([0,0,-1]),i=new Float64Array([0,1,0]),a=on(new Float64Array(16)),o=on(new Float64Array(16)),s=new Float64Array(3),l=new Float64Array(3),c=new Float64Array(3),f=on(new Float64Array(16)),u=on(new Float64Array(16)),d=new Float64Array(3),h=new Float64Array(3);function p(){e.viewPlaneNormal[0]=-e.directionOfProjection[0],e.viewPlaneNormal[1]=-e.directionOfProjection[1],e.viewPlaneNormal[2]=-e.directionOfProjection[2]}t.orthogonalizeViewUp=()=>{const g=t.getViewMatrix();e.viewUp[0]=g[4],e.viewUp[1]=g[5],e.viewUp[2]=g[6],t.modified()},t.setPosition=(g,m,y)=>{g===e.position[0]&&m===e.position[1]&&y===e.position[2]||(e.position[0]=g,e.position[1]=m,e.position[2]=y,t.computeDistance(),t.modified())},t.setFocalPoint=(g,m,y)=>{g===e.focalPoint[0]&&m===e.focalPoint[1]&&y===e.focalPoint[2]||(e.focalPoint[0]=g,e.focalPoint[1]=m,e.focalPoint[2]=y,t.computeDistance(),t.modified())},t.setDistance=g=>{if(e.distance===g)return;e.distance=g,e.distance<1e-20&&(e.distance=1e-20,Kx("Distance is set to minimum."));const m=e.directionOfProjection;e.focalPoint[0]=e.position[0]+m[0]*e.distance,e.focalPoint[1]=e.position[1]+m[1]*e.distance,e.focalPoint[2]=e.position[2]+m[2]*e.distance,t.modified()},t.computeDistance=()=>{const g=e.focalPoint[0]-e.position[0],m=e.focalPoint[1]-e.position[1],y=e.focalPoint[2]-e.position[2];if(e.distance=Math.sqrt(g*g+m*m+y*y),e.distance<1e-20){e.distance=1e-20,Kx("Distance is set to minimum.");const v=e.directionOfProjection;e.focalPoint[0]=e.position[0]+v[0]*e.distance,e.focalPoint[1]=e.position[1]+v[1]*e.distance,e.focalPoint[2]=e.position[2]+v[2]*e.distance}e.directionOfProjection[0]=g/e.distance,e.directionOfProjection[1]=m/e.distance,e.directionOfProjection[2]=y/e.distance,p()},t.dolly=g=>{if(g<=0)return;const m=e.distance/g;t.setPosition(e.focalPoint[0]-m*e.directionOfProjection[0],e.focalPoint[1]-m*e.directionOfProjection[1],e.focalPoint[2]-m*e.directionOfProjection[2])},t.roll=g=>{const m=e.position,y=e.focalPoint,v=e.viewUp,x=new Float64Array([v[0],v[1],v[2],0]);on(f);const w=new Float64Array([y[0]-m[0],y[1]-m[1],y[2]-m[2]]);lc(f,f,Di(g),w),hh(x,x,f),e.viewUp[0]=x[0],e.viewUp[1]=x[1],e.viewUp[2]=x[2],t.modified()},t.azimuth=g=>{const m=e.focalPoint;on(u),di(u,u,m),lc(u,u,Di(g),e.viewUp),di(u,u,[-m[0],-m[1],-m[2]]),Gn(d,e.position,u),t.setPosition(d[0],d[1],d[2])},t.yaw=g=>{const m=e.position;on(u),di(u,u,m),lc(u,u,Di(g),e.viewUp),di(u,u,[-m[0],-m[1],-m[2]]),Gn(h,e.focalPoint,u),t.setFocalPoint(h[0],h[1],h[2])},t.elevation=g=>{const m=e.focalPoint,y=t.getViewMatrix(),v=[-y[0],-y[1],-y[2]];on(u),di(u,u,m),lc(u,u,Di(g),v),di(u,u,[-m[0],-m[1],-m[2]]),Gn(d,e.position,u),t.setPosition(d[0],d[1],d[2])},t.pitch=g=>{const m=e.position,y=t.getViewMatrix(),v=[y[0],y[1],y[2]];on(u),di(u,u,m),lc(u,u,Di(g),v),di(u,u,[-m[0],-m[1],-m[2]]),Gn(h,e.focalPoint,u),t.setFocalPoint(...h)},t.zoom=g=>{g<=0||(e.parallelProjection?e.parallelScale/=g:e.viewAngle/=g,t.modified())},t.translate=(g,m,y)=>{const v=[g,m,y];Jw(e.position,v,e.position),Jw(e.focalPoint,v,e.focalPoint),t.computeDistance(),t.modified()},t.applyTransform=g=>{const m=[...e.viewUp,1],y=[],v=[],x=[];m[0]+=e.position[0],m[1]+=e.position[1],m[2]+=e.position[2],hh(y,[...e.position,1],g),hh(v,[...e.focalPoint,1],g),hh(x,m,g),x[0]-=y[0],x[1]-=y[1],x[2]-=y[2],t.setPosition(...y.slice(0,3)),t.setFocalPoint(...v.slice(0,3)),t.setViewUp(...x.slice(0,3))},t.getThickness=()=>e.clippingRange[1]-e.clippingRange[0],t.setThickness=g=>{let m=g;m<1e-20&&(m=1e-20,Kx("Thickness is set to minimum.")),t.setClippingRange(e.clippingRange[0],e.clippingRange[0]+m)},t.setThicknessFromFocalPoint=g=>{let m=g;m<1e-20&&(m=1e-20,Kx("Thickness is set to minimum.")),t.setClippingRange(e.distance-m/2,e.distance+m/2)},t.setRoll=g=>{},t.getRoll=()=>{},t.setObliqueAngles=(g,m)=>{},t.getOrientation=()=>{},t.getOrientationWXYZ=()=>{},t.getFrustumPlanes=g=>{},t.getCameraLightTransformMatrix=g=>(Ri(g,e.cameraLightTransform),g),t.computeCameraLightTransform=()=>{Ri(a,t.getViewMatrix()),Ea(a,a),m7(o,[e.distance,e.distance,e.distance]),zn(a,a,o),on(e.cameraLightTransform),di(e.cameraLightTransform,a,[0,0,-1])},t.deepCopy=g=>{},t.physicalOrientationToWorldDirection=g=>{const m=sV(g[0],g[1],g[2],g[3]),y=Fh(),v=sV(0,0,1,0);return P3e(y,m),oV(v,m,v),oV(v,v,y),[v[0],v[1],v[2]]},t.getPhysicalToWorldMatrix=g=>{t.getWorldToPhysicalMatrix(g),Ea(g,g)},t.getWorldToPhysicalMatrix=g=>{on(g);const m=[3];yu(e.physicalViewNorth,e.physicalViewUp,m),g[0]=m[0],g[1]=m[1],g[2]=m[2],g[4]=e.physicalViewUp[0],g[5]=e.physicalViewUp[1],g[6]=e.physicalViewUp[2],g[8]=-e.physicalViewNorth[0],g[9]=-e.physicalViewNorth[1],g[10]=-e.physicalViewNorth[2],jn(g,g),Br(s,1/e.physicalScale,1/e.physicalScale,1/e.physicalScale),i0(g,g,s),di(g,g,e.physicalTranslation)},t.computeViewParametersFromViewMatrix=g=>{Ea(a,g),Gn(s,n,a),t.computeDistance();const m=e.distance;t.setPosition(s[0],s[1],s[2]),Gn(l,r,a),Bd(l,l,s),wc(l,l),t.setDirectionOfProjection(l[0],l[1],l[2]),Gn(c,i,a),Bd(c,c,s),wc(c,c),t.setViewUp(c[0],c[1],c[2]),t.setDistance(m)},t.computeViewParametersFromPhysicalMatrix=g=>{t.getWorldToPhysicalMatrix(a),zn(a,g,a),t.computeViewParametersFromViewMatrix(a)},t.setViewMatrix=g=>{e.viewMatrix=g,e.viewMatrix&&(Ri(a,e.viewMatrix),t.computeViewParametersFromViewMatrix(a),jn(e.viewMatrix,e.viewMatrix))},t.getViewMatrix=()=>{if(e.viewMatrix)return e.viewMatrix;AX(a,e.position,e.focalPoint,e.viewUp),jn(a,a);const g=new Float64Array(16);return Ri(g,a),g},t.setProjectionMatrix=g=>{e.projectionMatrix=g},t.getProjectionMatrix=(g,m,y)=>{const v=new Float64Array(16);if(on(v),e.projectionMatrix){const S=1/e.physicalScale;return Br(s,S,S,S),Ri(v,e.projectionMatrix),i0(v,v,s),jn(v,v),v}on(a);const x=e.clippingRange[1]-e.clippingRange[0],w=[e.clippingRange[0]+(m+1)*x/2,e.clippingRange[0]+(y+1)*x/2];if(e.parallelProjection){const S=e.parallelScale*g,T=e.parallelScale,_=(e.windowCenter[0]-1)*S,D=(e.windowCenter[0]+1)*S,I=(e.windowCenter[1]-1)*T,R=(e.windowCenter[1]+1)*T;PX(a,_,D,I,R,w[0],w[1]),jn(a,a)}else{if(e.useOffAxisProjection)throw new Error("Off-Axis projection is not supported at this time");{const S=Math.tan(Di(e.viewAngle)/2);let T,_;e.useHorizontalViewAngle===!0?(T=e.clippingRange[0]*S,_=e.clippingRange[0]*S/g):(T=e.clippingRange[0]*S*g,_=e.clippingRange[0]*S);const D=(e.windowCenter[0]-1)*T,I=(e.windowCenter[0]+1)*T,R=(e.windowCenter[1]-1)*_,O=(e.windowCenter[1]+1)*_,P=w[0],N=w[1];a[0]=2*P/(I-D),a[5]=2*P/(O-R),a[2]=(D+I)/(I-D),a[6]=(R+O)/(O-R),a[10]=-(P+N)/(N-P),a[14]=-1,a[11]=-2*P*N/(N-P),a[15]=0}}return Ri(v,a),v},t.getCompositeProjectionMatrix=(g,m,y)=>{const v=t.getViewMatrix(),x=t.getProjectionMatrix(g,m,y);return zn(x,v,x),x},t.setDirectionOfProjection=(g,m,y)=>{if(e.directionOfProjection[0]===g&&e.directionOfProjection[1]===m&&e.directionOfProjection[2]===y)return;e.directionOfProjection[0]=g,e.directionOfProjection[1]=m,e.directionOfProjection[2]=y;const v=e.directionOfProjection;e.focalPoint[0]=e.position[0]+v[0]*e.distance,e.focalPoint[1]=e.position[1]+v[1]*e.distance,e.focalPoint[2]=e.position[2]+v[2]*e.distance,p()},t.setDeviceAngles=(g,m,y,v)=>{const x=[3];yu(e.physicalViewNorth,e.physicalViewUp,x);const w=on(new Float64Array(16));lc(w,w,Di(g),e.physicalViewUp),lc(w,w,Di(m),x),lc(w,w,Di(y),e.physicalViewNorth),lc(w,w,Di(-v),e.physicalViewUp);const S=new Float64Array([-e.physicalViewUp[0],-e.physicalViewUp[1],-e.physicalViewUp[2]]),T=new Float64Array(e.physicalViewNorth);Gn(S,S,w),Gn(T,T,w),t.setDirectionOfProjection(S[0],S[1],S[2]),t.setViewUp(T[0],T[1],T[2]),t.modified()},t.setOrientationWXYZ=(g,m,y,v)=>{const x=on(new Float64Array(16));if(g!==0&&(m!==0||y!==0||v!==0)){const T=Di(g),_=Fh();v7(_,[m,y,v],T),r3(x,_)}const w=new Float64Array(3);Gn(w,[0,0,-1],x);const S=new Float64Array(3);Gn(S,[0,1,0],x),t.setDirectionOfProjection(...w),t.setViewUp(...S),t.modified()},t.computeClippingRange=g=>{let m=null,y=null;m=e.viewPlaneNormal,y=e.position;const v=-m[0],x=-m[1],w=-m[2],S=-(v*y[0]+x*y[1]+w*y[2]),T=[v*g[0]+x*g[2]+w*g[4]+S,1e-18];for(let _=0;_<2;_++)for(let D=0;D<2;D++)for(let I=0;I<2;I++){const R=v*g[I]+x*g[2+D]+w*g[4+_]+S;T[0]=R<T[0]?R:T[0],T[1]=R>T[1]?R:T[1]}return T}}const I9e={position:[0,0,1],focalPoint:[0,0,0],viewUp:[0,1,0],directionOfProjection:[0,0,-1],parallelProjection:!1,useHorizontalViewAngle:!1,viewAngle:30,parallelScale:1,clippingRange:[.01,1000.01],windowCenter:[0,0],viewPlaneNormal:[0,0,1],useOffAxisProjection:!1,screenBottomLeft:[-.5,-.5,-.5],screenBottomRight:[.5,-.5,-.5],screenTopRight:[.5,.5,-.5],freezeFocalPoint:!1,projectionMatrix:null,viewMatrix:null,cameraLightTransform:f7(),physicalTranslation:[0,0,0],physicalScale:1,physicalViewUp:[0,1,0],physicalViewNorth:[0,0,-1]};function bZ(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,I9e,n),ce.obj(t,e),ce.get(t,e,["distance"]),ce.setGet(t,e,["parallelProjection","useHorizontalViewAngle","viewAngle","parallelScale","useOffAxisProjection","freezeFocalPoint","physicalScale"]),ce.getArray(t,e,["directionOfProjection","viewPlaneNormal","position","focalPoint"]),ce.setGetArray(t,e,["clippingRange","windowCenter"],2),ce.setGetArray(t,e,["viewUp","screenBottomLeft","screenBottomRight","screenTopRight","physicalTranslation","physicalViewUp","physicalViewNorth"],3),M9e(t,e)}const R9e=ce.newInstance(bZ,"vtkCamera");var $7={newInstance:R9e,extend:bZ};function P9e(t,e){e.classHierarchy.push("vtkLight");const n=new Float64Array(3);t.getTransformedPosition=()=>(e.transformMatrix?Gn(n,e.position,e.transformMatrix):Br(n,e.position[0],e.position[1],e.position[2]),n),t.getTransformedFocalPoint=()=>(e.transformMatrix?Gn(n,e.focalPoint,e.transformMatrix):Br(n,e.focalPoint[0],e.focalPoint[1],e.focalPoint[2]),n),t.getDirection=()=>(e.directionMTime<e.mtime&&(R_(e.direction,e.focalPoint,e.position),Lh(e.direction),e.directionMTime=e.mtime),e.direction),t.setDirection=r=>{const i=new Float64Array(3);R_(i,e.position,r),e.focalPoint=i},t.setDirectionAngle=(r,i)=>{const a=Di(r),o=Di(i);t.setPosition(Math.cos(a)*Math.sin(o),Math.sin(a),Math.cos(a)*Math.cos(o)),t.setFocalPoint(0,0,0),t.setPositional(0)},t.setLightTypeToHeadLight=()=>{t.setLightType("HeadLight")},t.setLightTypeToCameraLight=()=>{t.setLightType("CameraLight")},t.setLightTypeToSceneLight=()=>{t.setTransformMatrix(null),t.setLightType("SceneLight")},t.lightTypeIsHeadLight=()=>e.lightType==="HeadLight",t.lightTypeIsSceneLight=()=>e.lightType==="SceneLight",t.lightTypeIsCameraLight=()=>e.lightType==="CameraLight"}const A9e={switch:!0,intensity:1,color:[1,1,1],position:[0,0,1],focalPoint:[0,0,0],positional:!1,exponent:1,coneAngle:30,coneFalloff:5,attenuationValues:[1,0,0],transformMatrix:null,lightType:"SceneLight",shadowAttenuation:1,direction:[0,0,0],directionMTime:0};function N9e(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,A9e,n),ce.obj(t,e),ce.setGet(t,e,["intensity","switch","positional","exponent","coneAngle","coneFalloff","transformMatrix","lightType","shadowAttenuation","attenuationValues"]),ce.setGetArray(t,e,["color","position","focalPoint","attenuationValues"],3),P9e(t,e)}const L9e=ce.newInstance(N9e,"vtkLight");var k9e={newInstance:L9e};const{vtkErrorMacro:iw}=ce;function V9e(t){return()=>iw(`vtkViewport::${t} - NOT IMPLEMENTED`)}function F9e(t,e){e.classHierarchy.push("vtkViewport"),t.getViewProps=()=>e.props,t.hasViewProp=r=>e.props.includes(r),t.addViewProp=r=>{r&&!t.hasViewProp(r)&&e.props.push(r)},t.removeViewProp=r=>{const i=e.props.filter(a=>a!==r);e.props.length!==i.length&&(e.props=i)},t.removeAllViewProps=()=>{e.props=[]};function n(r){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];i.push(r);const a=r.getNestedProps();if(a&&a.length)for(let o=0;o<a.length;o++)n(a[o],i);return i}t.getViewPropsWithNestedProps=()=>{const r=[];for(let i=0;i<e.props.length;i++)n(e.props[i],r);return r},t.addActor2D=t.addViewProp,t.removeActor2D=r=>{t.removeViewProp(r)},t.getActors2D=()=>(e.actors2D=[],e.props.forEach(r=>{e.actors2D=e.actors2D.concat(r.getActors2D())}),e.actors2D),t.displayToView=()=>iw("call displayToView on your view instead"),t.viewToDisplay=()=>iw("callviewtodisplay on your view instead"),t.getSize=()=>iw("call getSize on your View instead"),t.normalizedDisplayToProjection=(r,i,a)=>{const o=t.normalizedDisplayToNormalizedViewport(r,i,a);return t.normalizedViewportToProjection(o[0],o[1],o[2])},t.normalizedDisplayToNormalizedViewport=(r,i,a)=>{const o=[e.viewport[2]-e.viewport[0],e.viewport[3]-e.viewport[1]];return[(r-e.viewport[0])/o[0],(i-e.viewport[1])/o[1],a]},t.normalizedViewportToProjection=(r,i,a)=>[r*2-1,i*2-1,a*2-1],t.projectionToNormalizedDisplay=(r,i,a)=>{const o=t.projectionToNormalizedViewport(r,i,a);return t.normalizedViewportToNormalizedDisplay(o[0],o[1],o[2])},t.normalizedViewportToNormalizedDisplay=(r,i,a)=>{const o=[e.viewport[2]-e.viewport[0],e.viewport[3]-e.viewport[1]];return[r*o[0]+e.viewport[0],i*o[1]+e.viewport[1],a]},t.projectionToNormalizedViewport=(r,i,a)=>[(r+1)*.5,(i+1)*.5,(a+1)*.5],t.PickPropFrom=V9e("PickPropFrom")}const U9e={background:[0,0,0],background2:[.2,.2,.2],gradientBackground:!1,viewport:[0,0,1,1],aspect:[1,1],pixelAspect:[1,1],props:[],actors2D:[]};function wZ(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,U9e,n),ce.obj(t,e),ce.event(t,e,"event"),ce.setGetArray(t,e,["viewport"],4),ce.setGetArray(t,e,["background","background2"],3),F9e(t,e)}const B9e=ce.newInstance(wZ,"vtkViewport");var $9e={newInstance:B9e,extend:wZ};const{vtkDebugMacro:ov,vtkErrorMacro:_d,vtkWarningMacro:G9e}=wo;function WV(t){return()=>_d(`vtkRenderer::${t} - NOT IMPLEMENTED`)}function j9e(t,e){e.classHierarchy.push("vtkRenderer");const n={type:"ComputeVisiblePropBoundsEvent",renderer:t},r={type:"ResetCameraClippingRangeEvent",renderer:t},i={type:"ResetCameraEvent",renderer:t};t.updateCamera=()=>(e.activeCamera||(ov("No cameras are on, creating one."),t.getActiveCameraAndResetIfCreated()),e.activeCamera.render(t),!0),t.updateLightsGeometryToFollowCamera=()=>{const a=t.getActiveCameraAndResetIfCreated();e.lights.forEach(o=>{o.lightTypeIsSceneLight()||(o.lightTypeIsHeadLight()?(o.setPositionFrom(a.getPositionByReference()),o.setFocalPointFrom(a.getFocalPointByReference()),o.modified(a.getMTime())):o.lightTypeIsCameraLight()?o.setTransformMatrix(a.getCameraLightTransformMatrix(f7())):_d("light has unknown light type",o.get()))})},t.updateLightGeometry=()=>e.lightFollowCamera?t.updateLightsGeometryToFollowCamera():!0,t.allocateTime=WV("allocateTime"),t.updateGeometry=WV("updateGeometry"),t.getVTKWindow=()=>e._renderWindow,t.setLayer=a=>{ov(t.getClassName(),t,"setting Layer to ",a),e.layer!==a&&(e.layer=a,t.modified()),t.setPreserveColorBuffer(!!a)},t.setActiveCamera=a=>e.activeCamera===a?!1:(e.activeCamera=a,t.modified(),t.invokeEvent({type:"ActiveCameraEvent",camera:a}),!0),t.makeCamera=()=>{const a=$7.newInstance();return t.invokeEvent({type:"CreateCameraEvent",camera:a}),a},t.getActiveCamera=()=>(e.activeCamera||(e.activeCamera=t.makeCamera()),e.activeCamera),t.getActiveCameraAndResetIfCreated=()=>(e.activeCamera||(t.getActiveCamera(),t.resetCamera()),e.activeCamera),t.getActors=()=>(e.actors=[],e.props.forEach(a=>{e.actors=e.actors.concat(a.getActors())}),e.actors),t.addActor=t.addViewProp,t.removeActor=a=>{e.actors=e.actors.filter(o=>o!==a),t.removeViewProp(a),t.modified()},t.removeAllActors=()=>{t.getActors().forEach(o=>{t.removeViewProp(o)}),e.actors=[],t.modified()},t.getVolumes=()=>(e.volumes=[],e.props.forEach(a=>{e.volumes=e.volumes.concat(a.getVolumes())}),e.volumes),t.addVolume=t.addViewProp,t.removeVolume=a=>{e.volumes=e.volumes.filter(o=>o!==a),t.removeViewProp(a),t.modified()},t.removeAllVolumes=()=>{t.getVolumes().forEach(o=>{t.removeViewProp(o)}),e.volumes=[],t.modified()},t.hasLight=a=>e.lights.includes(a),t.addLight=a=>{a&&!t.hasLight(a)&&(e.lights.push(a),t.modified())},t.removeLight=a=>{e.lights=e.lights.filter(o=>o!==a),t.modified()},t.removeAllLights=()=>{e.lights=[],t.modified()},t.setLightCollection=a=>{e.lights=a,t.modified()},t.makeLight=k9e.newInstance,t.createLight=()=>{e.automaticLightCreation&&(e._createdLight&&(t.removeLight(e._createdLight),e._createdLight.delete(),e._createdLight=null),e._createdLight=t.makeLight(),t.addLight(e._createdLight),e._createdLight.setLightTypeToHeadLight(),e._createdLight.setPosition(t.getActiveCamera().getPosition()),e._createdLight.setFocalPoint(t.getActiveCamera().getFocalPoint()))},t.normalizedDisplayToWorld=(a,o,s,l)=>{let c=t.normalizedDisplayToProjection(a,o,s);return c=t.projectionToView(c[0],c[1],c[2],l),t.viewToWorld(c[0],c[1],c[2])},t.worldToNormalizedDisplay=(a,o,s,l)=>{let c=t.worldToView(a,o,s);return c=t.viewToProjection(c[0],c[1],c[2],l),t.projectionToNormalizedDisplay(c[0],c[1],c[2])},t.viewToWorld=(a,o,s)=>{if(e.activeCamera===null)return _d("ViewToWorld: no active camera, cannot compute view to world, returning 0,0,0"),[0,0,0];const l=e.activeCamera.getViewMatrix();Ea(l,l),jn(l,l);const c=new Float64Array([a,o,s]);return Gn(c,c,l),c},t.projectionToView=(a,o,s,l)=>{if(e.activeCamera===null)return _d("ProjectionToView: no active camera, cannot compute projection to view, returning 0,0,0"),[0,0,0];const c=e.activeCamera.getProjectionMatrix(l,-1,1);Ea(c,c),jn(c,c);const f=new Float64Array([a,o,s]);return Gn(f,f,c),f},t.worldToView=(a,o,s)=>{if(e.activeCamera===null)return _d("WorldToView: no active camera, cannot compute view to world, returning 0,0,0"),[0,0,0];const l=e.activeCamera.getViewMatrix();jn(l,l);const c=new Float64Array([a,o,s]);return Gn(c,c,l),c},t.viewToProjection=(a,o,s,l)=>{if(e.activeCamera===null)return _d("ViewToProjection: no active camera, cannot compute view to projection, returning 0,0,0"),[0,0,0];const c=e.activeCamera.getProjectionMatrix(l,-1,1);jn(c,c);const f=new Float64Array([a,o,s]);return Gn(f,f,c),f},t.computeVisiblePropBounds=()=>{e.allBounds[0]=Er.INIT_BOUNDS[0],e.allBounds[1]=Er.INIT_BOUNDS[1],e.allBounds[2]=Er.INIT_BOUNDS[2],e.allBounds[3]=Er.INIT_BOUNDS[3],e.allBounds[4]=Er.INIT_BOUNDS[4],e.allBounds[5]=Er.INIT_BOUNDS[5];let a=!0;t.invokeEvent(n);for(let o=0;o<e.props.length;++o){const s=e.props[o];if(s.getVisibility()&&s.getUseBounds()){const l=s.getBounds();l&&qb(l)&&(a=!1,l[0]<e.allBounds[0]&&(e.allBounds[0]=l[0]),l[1]>e.allBounds[1]&&(e.allBounds[1]=l[1]),l[2]<e.allBounds[2]&&(e.allBounds[2]=l[2]),l[3]>e.allBounds[3]&&(e.allBounds[3]=l[3]),l[4]<e.allBounds[4]&&(e.allBounds[4]=l[4]),l[5]>e.allBounds[5]&&(e.allBounds[5]=l[5]))}}return a&&(jm(e.allBounds),ov("Can't compute bounds, no 3D props are visible")),e.allBounds},t.resetCamera=function(){const o=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:null)||t.computeVisiblePropBounds(),s=[0,0,0];if(!qb(o))return ov("Cannot reset camera!"),!1;let l=null;if(t.getActiveCamera())l=e.activeCamera.getViewPlaneNormal();else return _d("Trying to reset non-existent camera"),!1;e.activeCamera.setViewAngle(30),s[0]=(o[0]+o[1])/2,s[1]=(o[2]+o[3])/2,s[2]=(o[4]+o[5])/2;let c=o[1]-o[0],f=o[3]-o[2],u=o[5]-o[4];c*=c,f*=f,u*=u;let d=c+f+u;d=d===0?1:d,d=Math.sqrt(d)*.5;const h=Di(e.activeCamera.getViewAngle()),p=d,g=d/Math.sin(h*.5),m=e.activeCamera.getViewUp();return Math.abs(An(m,l))>.999&&(G9e("Resetting view-up since view plane normal is parallel"),e.activeCamera.setViewUp(-m[2],m[0],m[1])),e.activeCamera.setFocalPoint(s[0],s[1],s[2]),e.activeCamera.setPosition(s[0]+g*l[0],s[1]+g*l[1],s[2]+g*l[2]),t.resetCameraClippingRange(o),e.activeCamera.setParallelScale(p),e.activeCamera.setPhysicalScale(d),e.activeCamera.setPhysicalTranslation(-s[0],-s[1],-s[2]),t.invokeEvent(i),!0},t.resetCameraClippingRange=function(){const o=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:null)||t.computeVisiblePropBounds();if(!qb(o))return ov("Cannot reset camera clipping range!"),!1;if(t.getActiveCameraAndResetIfCreated(),!e.activeCamera)return _d("Trying to reset clipping range of non-existent camera"),!1;const s=e.activeCamera.computeClippingRange(o);let l=0;if(e.activeCamera.getParallelProjection())l=.2*e.activeCamera.getParallelScale();else{const c=Di(e.activeCamera.getViewAngle());l=.2*Math.tan(c/2)*s[1]}return s[1]-s[0]<l&&(l=l-s[1]+s[0],s[1]+=l/2,s[0]-=l/2),s[0]<0&&(s[0]=0),s[0]=.99*s[0]-(s[1]-s[0])*e.clippingRangeExpansion,s[1]=1.01*s[1]+(s[1]-s[0])*e.clippingRangeExpansion,s[0]=s[0]>=s[1]?.01*s[1]:s[0],e.nearClippingPlaneTolerance||(e.nearClippingPlaneTolerance=.01),s[0]<e.nearClippingPlaneTolerance*s[1]&&(s[0]=e.nearClippingPlaneTolerance*s[1]),e.activeCamera.setClippingRange(s[0],s[1]),t.invokeEvent(r),!1},t.setRenderWindow=a=>{a!==e._renderWindow&&(e._vtkWindow=a,e._renderWindow=a)},t.visibleActorCount=()=>e.props.filter(a=>a.getVisibility()).length,t.visibleVolumeCount=t.visibleActorCount,t.getMTime=()=>{let a=e.mtime;const o=e.activeCamera?e.activeCamera.getMTime():0;o>a&&(a=o);const s=e._createdLight?e._createdLight.getMTime():0;return s>a&&(a=s),a},t.getTransparent=()=>!!e.preserveColorBuffer,t.isActiveCameraCreated=()=>!!e.activeCamera}const z9e={pickedProp:null,activeCamera:null,allBounds:[],ambient:[1,1,1],allocatedRenderTime:100,timeFactor:1,automaticLightCreation:!0,twoSidedLighting:!0,lastRenderTimeInSeconds:-1,renderWindow:null,lights:[],actors:[],volumes:[],lightFollowCamera:!0,numberOfPropsRendered:0,propArray:null,pathArray:null,layer:0,preserveColorBuffer:!1,preserveDepthBuffer:!1,computeVisiblePropBounds:n0(),interactive:!0,nearClippingPlaneTolerance:0,clippingRangeExpansion:.05,erase:!0,draw:!0,useShadows:!1,useDepthPeeling:!1,occlusionRatio:0,maximumNumberOfPeels:4,selector:null,delegate:null,texturedBackground:!1,backgroundTexture:null,environmentTexture:null,environmentTextureDiffuseStrength:1,environmentTextureSpecularStrength:1,useEnvironmentTextureAsBackground:!1,pass:0};function CZ(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};for(Object.assign(e,z9e,n),$9e.extend(t,e,n),e.background||(e.background=[0,0,0,1]);e.background.length<3;)e.background.push(0);e.background.length===3&&e.background.push(1),Fo(t,e,["_renderWindow","allocatedRenderTime","timeFactor","lastRenderTimeInSeconds","numberOfPropsRendered","lastRenderingUsedDepthPeeling","selector"]),Ni(t,e,["twoSidedLighting","lightFollowCamera","automaticLightCreation","erase","draw","nearClippingPlaneTolerance","clippingRangeExpansion","backingStore","interactive","layer","preserveColorBuffer","preserveDepthBuffer","useDepthPeeling","occlusionRatio","maximumNumberOfPeels","delegate","backgroundTexture","texturedBackground","environmentTexture","environmentTextureDiffuseStrength","environmentTextureSpecularStrength","useEnvironmentTextureAsBackground","useShadows","pass"]),Gm(t,e,["actors","volumes","lights"]),UD(t,e,["background"],4,1),Dy(t,e,["renderWindow"]),j9e(t,e)}const W9e=Qn(CZ,"vtkRenderer");var H9e={newInstance:W9e,extend:CZ};const K9e={Unknown:0,LeftController:1,RightController:2},q9e={Unknown:0,Trigger:1,TrackPad:2,Grip:3,Thumbstick:4,A:5,B:6,ApplicationMenu:7},X9e={Unknown:0,TouchpadX:1,TouchpadY:2,ThumbstickX:3,ThumbstickY:4};var SZ={Device:K9e,Input:q9e,Axis:X9e};const{Device:qx,Input:Y0}=SZ,{vtkWarningMacro:Xx,vtkErrorMacro:Yx,normalizeWheel:Y9e,vtkOnceErrorMacro:J9e}=ce,Bp={ctrlKey:!1,altKey:!1,shiftKey:!1},ZE={"xr-standard":[Y0.Trigger,Y0.Grip,Y0.TrackPad,Y0.Thumbstick,Y0.A,Y0.B]},G7=["StartAnimation","Animation","EndAnimation","PointerEnter","PointerLeave","MouseEnter","MouseLeave","StartMouseMove","MouseMove","EndMouseMove","LeftButtonPress","LeftButtonRelease","MiddleButtonPress","MiddleButtonRelease","RightButtonPress","RightButtonRelease","KeyPress","KeyDown","KeyUp","StartMouseWheel","MouseWheel","EndMouseWheel","StartPinch","Pinch","EndPinch","StartPan","Pan","EndPan","StartRotate","Rotate","EndRotate","Button3D","Move3D","StartPointerLock","EndPointerLock","StartInteraction","Interaction","EndInteraction","AnimationFrameRateUpdate"];function sv(t){t.cancelable&&t.preventDefault()}function Jx(t){const e=Object.create(null);return t.forEach(n=>{let{pointerId:r,position:i}=n;e[r]=i}),e}function Z9e(t,e){e.classHierarchy.push("vtkRenderWindowInteractor");const n={...t},r=new Set,i=new Map;let a=1;t.start=()=>{!e.initialized&&(t.initialize(),!e.initialized)||t.startEventLoop()},t.setRenderWindow=g=>{Yx("you want to call setView(view) instead of setRenderWindow on a vtk.js interactor")},t.setInteractorStyle=g=>{e.interactorStyle!==g&&(e.interactorStyle!=null&&e.interactorStyle.setInteractor(null),e.interactorStyle=g,e.interactorStyle!=null&&e.interactorStyle.getInteractor()!==t&&e.interactorStyle.setInteractor(t))},t.initialize=()=>{e.initialized=!0,t.enable(),t.render()},t.enable=()=>t.setEnabled(!0),t.disable=()=>t.setEnabled(!1),t.startEventLoop=()=>Xx("empty event loop");function o(g,m){e._forcedRenderer||(e.currentRenderer=t.findPokedRenderer(g,m))}t.getCurrentRenderer=()=>(e.currentRenderer||o(0,0),e.currentRenderer);function s(g){const m=e._view.getCanvas(),y=m.getBoundingClientRect(),v=m.width/y.width,x=m.height/y.height,w={x:v*(g.clientX-y.left),y:x*(y.height-g.clientY+y.top),z:0};return(i.size<=1||!e.currentRenderer)&&o(w.x,w.y),w}const l=e._getScreenEventPositionFor||s;function c(g){return{controlKey:g.ctrlKey,altKey:g.altKey,shiftKey:g.shiftKey}}function f(g){const m=c(g);return{key:g.key,keyCode:g.charCode,...m}}function u(g){return g.pointerType||""}const d=()=>{if(e.container===null)return;const{container:g}=e;g.addEventListener("contextmenu",sv),g.addEventListener("wheel",t.handleWheel),g.addEventListener("DOMMouseScroll",t.handleWheel),g.addEventListener("pointerenter",t.handlePointerEnter),g.addEventListener("pointerleave",t.handlePointerLeave),g.addEventListener("pointermove",t.handlePointerMove,{passive:!1}),g.addEventListener("pointerdown",t.handlePointerDown,{passive:!1}),g.addEventListener("pointerup",t.handlePointerUp),g.addEventListener("pointercancel",t.handlePointerCancel),document.addEventListener("keypress",t.handleKeyPress),document.addEventListener("keydown",t.handleKeyDown),document.addEventListener("keyup",t.handleKeyUp),document.addEventListener("pointerlockchange",t.handlePointerLockChange),g.style.touchAction="none",g.style.userSelect="none",g.style.webkitTapHighlightColor="rgba(0,0,0,0)"};t.bindEvents=g=>{if(g===null)return;n.setContainer(g)&&d()};const h=()=>{clearTimeout(e.moveTimeoutID),clearTimeout(e.wheelTimeoutID),e.moveTimeoutID=0,e.wheelTimeoutID=0,a=1;const{container:g}=e;g&&(g.removeEventListener("contextmenu",sv),g.removeEventListener("wheel",t.handleWheel),g.removeEventListener("DOMMouseScroll",t.handleWheel),g.removeEventListener("pointerenter",t.handlePointerEnter),g.removeEventListener("pointerleave",t.handlePointerLeave),g.removeEventListener("pointermove",t.handlePointerMove,{passive:!1}),g.removeEventListener("pointerdown",t.handlePointerDown,{passive:!1}),g.removeEventListener("pointerup",t.handlePointerUp),g.removeEventListener("pointercancel",t.handlePointerCancel)),document.removeEventListener("keypress",t.handleKeyPress),document.removeEventListener("keydown",t.handleKeyDown),document.removeEventListener("keyup",t.handleKeyUp),document.removeEventListener("pointerlockchange",t.handlePointerLockChange),i.clear()};t.unbindEvents=()=>{h(),n.setContainer(null)},t.handleKeyPress=g=>{const m=f(g);t.keyPressEvent(m)},t.handleKeyDown=g=>{const m=f(g);t.keyDownEvent(m)},t.handleKeyUp=g=>{const m=f(g);t.keyUpEvent(m)},t.handlePointerEnter=g=>{const m={...c(g),position:l(g),deviceType:u(g)};t.pointerEnterEvent(m),m.deviceType==="mouse"&&t.mouseEnterEvent(m)},t.handlePointerLeave=g=>{const m={...c(g),position:l(g),deviceType:u(g)};t.pointerLeaveEvent(m),m.deviceType==="mouse"&&t.mouseLeaveEvent(m)},t.handlePointerDown=g=>{if(!(g.button>2||t.isPointerLocked()))switch(e.preventDefaultOnPointerDown&&sv(g),g.target.hasPointerCapture(g.pointerId)&&g.target.releasePointerCapture(g.pointerId),e.container.setPointerCapture(g.pointerId),i.has(g.pointerId)&&Xx("[RenderWindowInteractor] duplicate pointerId detected"),i.set(g.pointerId,{pointerId:g.pointerId,position:l(g)}),g.pointerType){case"pen":case"touch":t.handleTouchStart(g);break;case"mouse":default:t.handleMouseDown(g);break}},t.handlePointerUp=g=>{if(i.has(g.pointerId))switch(e.preventDefaultOnPointerUp&&sv(g),i.delete(g.pointerId),e.container.releasePointerCapture(g.pointerId),g.pointerType){case"pen":case"touch":t.handleTouchEnd(g);break;case"mouse":default:t.handleMouseUp(g);break}},t.handlePointerCancel=g=>{if(i.has(g.pointerId))switch(i.delete(g.pointerId),g.pointerType){case"pen":case"touch":t.handleTouchEnd(g);break;case"mouse":default:t.handleMouseUp(g);break}},t.handlePointerMove=g=>{if(i.has(g.pointerId)){const m=i.get(g.pointerId);m.position=l(g)}switch(g.pointerType){case"pen":case"touch":t.handleTouchMove(g);break;case"mouse":default:t.handleMouseMove(g);break}},t.handleMouseDown=g=>{const m={...c(g),position:l(g),deviceType:u(g)};switch(g.button){case 0:t.leftButtonPressEvent(m);break;case 1:t.middleButtonPressEvent(m);break;case 2:t.rightButtonPressEvent(m);break;default:Yx(`Unknown mouse button pressed: ${g.button}`);break}},t.requestPointerLock=()=>{e.container&&e.container.requestPointerLock()},t.exitPointerLock=()=>document.exitPointerLock?.(),t.isPointerLocked=()=>!!e.container&&document.pointerLockElement===e.container,t.handlePointerLockChange=()=>{t.isPointerLocked()?t.startPointerLockEvent():t.endPointerLockEvent()};function p(){e._view&&e.enabled&&e.enableRender&&(e.inRender=!0,e._view.traverseAllPasses(),e.inRender=!1),t.invokeRenderEvent()}t.requestAnimation=g=>{if(g===void 0){Yx("undefined requester, can not start animating");return}if(r.has(g)){Xx("requester is already registered for animating");return}r.add(g),!e.animationRequest&&r.size===1&&!e.xrAnimation&&(e._animationStartTime=Date.now(),e._animationFrameCount=0,e.animationRequest=requestAnimationFrame(t.handleAnimation),t.startAnimationEvent())},t.extendAnimation=g=>{const m=Date.now()+g;e._animationExtendedEnd=Math.max(e._animationExtendedEnd,m),!e.animationRequest&&r.size===0&&!e.xrAnimation&&(e._animationStartTime=Date.now(),e._animationFrameCount=0,e.animationRequest=requestAnimationFrame(t.handleAnimation),t.startAnimationEvent())},t.isAnimating=()=>e.xrAnimation||e.animationRequest!==null,t.cancelAnimation=function(g){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!r.has(g)){if(!m){const y=g&&g.getClassName?g.getClassName():g;Xx(`${y} did not request an animation`)}return}r.delete(g),e.animationRequest&&r.size===0&&Date.now()>e._animationExtendedEnd&&(cancelAnimationFrame(e.animationRequest),e.animationRequest=null,t.endAnimationEvent(),t.render())},t.switchToXRAnimation=()=>{e.animationRequest&&(cancelAnimationFrame(e.animationRequest),e.animationRequest=null),e.xrAnimation=!0},t.returnFromXRAnimation=()=>{e.xrAnimation=!1,r.size!==0&&(e.recentAnimationFrameRate=10,e.animationRequest=requestAnimationFrame(t.handleAnimation))},t.updateXRGamepads=(g,m,y)=>{g.inputSources.forEach(v=>{const x=v.gripSpace==null?null:m.getPose(v.gripSpace,y),w=v.gripSpace==null?null:m.getPose(v.targetRaySpace,y),S=v.gamepad,T=v.handedness;if(S){S.index in e.lastGamepadValues||(e.lastGamepadValues[S.index]={left:{buttons:{}},right:{buttons:{}},none:{buttons:{}}});for(let _=0;_<S.buttons.length;++_)_ in e.lastGamepadValues[S.index][T].buttons||(e.lastGamepadValues[S.index][T].buttons[_]=!1),e.lastGamepadValues[S.index][T].buttons[_]!==S.buttons[_].pressed&&x!=null&&(t.button3DEvent({gamepad:S,position:x.transform.position,orientation:x.transform.orientation,targetPosition:w.transform.position,targetOrientation:w.transform.orientation,pressed:S.buttons[_].pressed,device:v.handedness==="left"?qx.LeftController:qx.RightController,input:ZE[S.mapping]&&ZE[S.mapping][_]?ZE[S.mapping][_]:Y0.Trigger}),e.lastGamepadValues[S.index][T].buttons[_]=S.buttons[_].pressed),e.lastGamepadValues[S.index][T].buttons[_]&&x!=null&&t.move3DEvent({gamepad:S,position:x.transform.position,orientation:x.transform.orientation,targetPosition:w.transform.position,targetOrientation:w.transform.orientation,device:v.handedness==="left"?qx.LeftController:qx.RightController})}})},t.handleMouseMove=g=>{const m={...c(g),position:l(g),deviceType:u(g)};e.moveTimeoutID===0?t.startMouseMoveEvent(m):(t.mouseMoveEvent(m),clearTimeout(e.moveTimeoutID)),e.moveTimeoutID=setTimeout(()=>{t.endMouseMoveEvent(),e.moveTimeoutID=0},200)},t.handleAnimation=()=>{const g=Date.now();e._animationFrameCount++,g-e._animationStartTime>1e3&&e._animationFrameCount>1&&(e.recentAnimationFrameRate=1e3*(e._animationFrameCount-1)/(g-e._animationStartTime),e.lastFrameTime=1/e.recentAnimationFrameRate,t.animationFrameRateUpdateEvent(),e._animationStartTime=g,e._animationFrameCount=1),t.animationEvent(),p(),r.size>0||Date.now()<e._animationExtendedEnd?e.animationRequest=requestAnimationFrame(t.handleAnimation):(cancelAnimationFrame(e.animationRequest),e.animationRequest=null,t.endAnimationEvent(),t.render())},t.handleWheel=g=>{sv(g);const m={...Y9e(g),...c(g),position:l(g),deviceType:u(g)};e.wheelTimeoutID===0&&(Math.abs(m.spinY)>=.3?a=Math.abs(m.spinY):a=1),m.spinY/=a,e.wheelTimeoutID===0?(t.startMouseWheelEvent(m),t.mouseWheelEvent(m)):(t.mouseWheelEvent(m),clearTimeout(e.wheelTimeoutID)),e.mouseScrollDebounceByPass?(t.extendAnimation(600),t.endMouseWheelEvent(),e.wheelTimeoutID=0):e.wheelTimeoutID=setTimeout(()=>{t.extendAnimation(600),t.endMouseWheelEvent(),e.wheelTimeoutID=0},200)},t.handleMouseUp=g=>{const m={...c(g),position:l(g),deviceType:u(g)};switch(g.button){case 0:t.leftButtonReleaseEvent(m);break;case 1:t.middleButtonReleaseEvent(m);break;case 2:t.rightButtonReleaseEvent(m);break;default:Yx(`Unknown mouse button released: ${g.button}`);break}},t.handleTouchStart=g=>{const m=[...i.values()];if(e.recognizeGestures&&m.length>1){const y=Jx(i);if(m.length===2){const v={...c(Bp),position:m[0].position,deviceType:u(g)};t.leftButtonReleaseEvent(v)}t.recognizeGesture("TouchStart",y)}else if(m.length===1){const y={...c(Bp),position:l(g),deviceType:u(g)};t.leftButtonPressEvent(y)}},t.handleTouchMove=g=>{const m=[...i.values()];if(e.recognizeGestures&&m.length>1){const y=Jx(i);t.recognizeGesture("TouchMove",y)}else if(m.length===1){const y={...c(Bp),position:m[0].position,deviceType:u(g)};t.mouseMoveEvent(y)}},t.handleTouchEnd=g=>{const m=[...i.values()];if(e.recognizeGestures)if(m.length===0){const y={...c(Bp),position:l(g),deviceType:u(g)};t.leftButtonReleaseEvent(y)}else if(m.length===1){const y=Jx(i);t.recognizeGesture("TouchEnd",y);const v={...c(Bp),position:m[0].position,deviceType:u(g)};t.leftButtonPressEvent(v)}else{const y=Jx(i);t.recognizeGesture("TouchMove",y)}else if(m.length===1){const y={...c(Bp),position:m[0].position,deviceType:u(g)};t.leftButtonReleaseEvent(y)}},t.setView=g=>{e._view!==g&&(e._view=g,e._view.getRenderable().setInteractor(t),t.modified())},t.getFirstRenderer=()=>e._view?.getRenderable()?.getRenderersByReference()?.[0],t.findPokedRenderer=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(!e._view)return null;const y=e._view?.getRenderable()?.getRenderers();if(!y||y.length===0)return null;y.sort((T,_)=>T.getLayer()-_.getLayer());let v=null,x=null,w=null,S=y.length;for(;S--;){const T=y[S];if(e._view.isInViewport(g,m,T)&&T.getInteractive()){w=T;break}v===null&&T.getInteractive()&&(v=T),x===null&&e._view.isInViewport(g,m,T)&&(x=T)}return w===null&&(w=v),w===null&&(w=x),w==null&&(w=y[0]),w},t.render=()=>{!t.isAnimating()&&!e.inRender&&p()},G7.forEach(g=>{const m=g.charAt(0).toLowerCase()+g.slice(1);t[`${m}Event`]=y=>{if(!e.enabled)return;if(!t.getCurrentRenderer()){J9e(`
          Can not forward events without a current renderer on the interactor.
        `);return}const x={type:g,pokedRenderer:e.currentRenderer,firstRenderer:t.getFirstRenderer(),...y};t[`invoke${g}`](x)}}),t.recognizeGesture=(g,m)=>{if(Object.keys(m).length>2)return;if(e.startingEventPositions||(e.startingEventPositions={}),g==="TouchStart"){Object.keys(m).forEach(R=>{e.startingEventPositions[R]=m[R]}),e.currentGesture="Start";return}if(g==="TouchEnd"){e.currentGesture==="Pinch"&&(t.render(),t.endPinchEvent()),e.currentGesture==="Rotate"&&(t.render(),t.endRotateEvent()),e.currentGesture==="Pan"&&(t.render(),t.endPanEvent()),e.currentGesture="Start",e.startingEventPositions={};return}let y=0;const v=[],x=[];Object.keys(m).forEach(R=>{v[y]=m[R],x[y]=e.startingEventPositions[R],y++});const w=Math.sqrt((x[0].x-x[1].x)*(x[0].x-x[1].x)+(x[0].y-x[1].y)*(x[0].y-x[1].y)),S=Math.sqrt((v[0].x-v[1].x)*(v[0].x-v[1].x)+(v[0].y-v[1].y)*(v[0].y-v[1].y));let T=Yw(Math.atan2(x[1].y-x[0].y,x[1].x-x[0].x)),_=Yw(Math.atan2(v[1].y-v[0].y,v[1].x-v[0].x)),D=_-T;_=_+180>=360?_-180:_+180,T=T+180>=360?T-180:T+180,Math.abs(_-T)<Math.abs(D)&&(D=_-T);const I=[];if(I[0]=(v[0].x-x[0].x+v[1].x-x[1].x)/2,I[1]=(v[0].y-x[0].y+v[1].y-x[1].y)/2,g==="TouchMove")if(e.currentGesture==="Start"){let R=.01*Math.sqrt(e.container.clientWidth*e.container.clientWidth+e.container.clientHeight*e.container.clientHeight);R<15&&(R=15);const O=Math.abs(S-w),P=S*3.1415926*Math.abs(D)/360,N=Math.sqrt(I[0]*I[0]+I[1]*I[1]);if(O>R&&O>P&&O>N){e.currentGesture="Pinch";const A={scale:1,touches:m};t.startPinchEvent(A)}else if(P>R&&P>N){e.currentGesture="Rotate";const A={rotation:0,touches:m};t.startRotateEvent(A)}else if(N>R){e.currentGesture="Pan";const A={translation:[0,0],touches:m};t.startPanEvent(A)}}else{if(e.currentGesture==="Rotate"){const R={rotation:D,touches:m};t.rotateEvent(R)}if(e.currentGesture==="Pinch"){const R={scale:S/w,touches:m};t.pinchEvent(R)}if(e.currentGesture==="Pan"){const R={translation:I,touches:m};t.panEvent(R)}}},t.handleVisibilityChange=()=>{e._animationStartTime=Date.now(),e._animationFrameCount=0},t.setCurrentRenderer=g=>{e._forcedRenderer=!!g,e.currentRenderer=g},t.setContainer=g=>{h();const m=n.setContainer(g??null);return m&&d(),m},t.delete=()=>{for(;r.size;)t.cancelAnimation(r.values().next().value);typeof document.hidden<"u"&&document.removeEventListener("visibilitychange",t.handleVisibilityChange),e.container&&t.setContainer(null),n.delete()},typeof document.hidden<"u"&&document.addEventListener("visibilitychange",t.handleVisibilityChange,!1)}const Q9e={renderWindow:null,interactorStyle:null,picker:null,pickingManager:null,initialized:!1,enabled:!1,enableRender:!0,currentRenderer:null,lightFollowCamera:!0,desiredUpdateRate:30,stillUpdateRate:2,container:null,recognizeGestures:!0,currentGesture:"Start",animationRequest:null,lastFrameTime:.1,recentAnimationFrameRate:10,wheelTimeoutID:0,moveTimeoutID:0,lastGamepadValues:{},preventDefaultOnPointerDown:!1,preventDefaultOnPointerUp:!1,mouseScrollDebounceByPass:!1};function TZ(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Q9e,n),ce.obj(t,e),e._animationExtendedEnd=0,ce.event(t,e,"RenderEvent"),G7.forEach(r=>ce.event(t,e,r)),ce.get(t,e,["initialized","interactorStyle","lastFrameTime","recentAnimationFrameRate","_view"]),ce.setGet(t,e,["container","lightFollowCamera","enabled","enableRender","recognizeGestures","desiredUpdateRate","stillUpdateRate","picker","preventDefaultOnPointerDown","preventDefaultOnPointerUp","mouseScrollDebounceByPass"]),ce.moveToProtected(t,e,["view"]),Z9e(t,e)}const eDe=ce.newInstance(TZ,"vtkRenderWindowInteractor");var tDe={newInstance:eDe,extend:TZ,handledEvents:G7,...SZ};const{vtkDebugMacro:nDe}=ce;function rDe(t,e){e.classHierarchy.push("vtkActor");const n={...t};t.getActors=()=>[t],t.getIsOpaque=()=>{if(e.forceOpaque)return!0;if(e.forceTranslucent)return!1;e.property||t.getProperty();let r=e.property.getOpacity()>=1;return r=r&&(!e.texture||!e.texture.isTranslucent()),r=r&&(!e.mapper||e.mapper.getIsOpaque()),r},t.hasTranslucentPolygonalGeometry=()=>e.mapper===null?!1:(e.property===null&&t.setProperty(t.makeProperty()),!t.getIsOpaque()),t.makeProperty=Yh.newInstance,t.getProperty=()=>(e.property===null&&(e.property=t.makeProperty()),e.property),t.getBounds=()=>{if(e.mapper===null)return e.bounds;const r=e.mapper.getBounds();if(!r||r.length!==6)return r;if(r[0]>r[1])return e.mapperBounds=r.concat(),e.bounds=[1,-1,1,-1,1,-1],e.boundsMTime.modified(),r;if(!e.mapperBounds||r[0]!==e.mapperBounds[0]||r[1]!==e.mapperBounds[1]||r[2]!==e.mapperBounds[2]||r[3]!==e.mapperBounds[3]||r[4]!==e.mapperBounds[4]||r[5]!==e.mapperBounds[5]||t.getMTime()>e.boundsMTime.getMTime()){nDe("Recomputing bounds..."),e.mapperBounds=r.concat();const i=[];Er.getCorners(r,i),t.computeMatrix();const a=new Float64Array(16);jn(a,e.matrix),i.forEach(o=>Gn(o,o,a)),e.bounds[0]=e.bounds[2]=e.bounds[4]=Number.MAX_VALUE,e.bounds[1]=e.bounds[3]=e.bounds[5]=-Number.MAX_VALUE,e.bounds=e.bounds.map((o,s)=>s%2===0?i.reduce((l,c)=>l>c[s/2]?c[s/2]:l,o):i.reduce((l,c)=>l<c[(s-1)/2]?c[(s-1)/2]:l,o)),e.boundsMTime.modified()}return e.bounds},t.getMTime=()=>{let r=n.getMTime();if(e.property!==null){const i=e.property.getMTime();r=i>r?i:r}if(e.backfaceProperty!==null){const i=e.backfaceProperty.getMTime();r=i>r?i:r}return r},t.getRedrawMTime=()=>{let r=e.mtime;if(e.mapper!==null){let i=e.mapper.getMTime();r=i>r?i:r,e.mapper.getInput()!==null&&(e.mapper.getInputAlgorithm().update(),i=e.mapper.getInput().getMTime(),r=i>r?i:r)}return r},t.getSupportsSelection=()=>e.mapper?e.mapper.getSupportsSelection():!1,t.processSelectorPixelBuffers=(r,i)=>{e.mapper&&e.mapper.processSelectorPixelBuffers&&e.mapper.processSelectorPixelBuffers(r,i)}}const iDe={mapper:null,property:null,backfaceProperty:null,forceOpaque:!1,forceTranslucent:!1,bounds:[1,-1,1,-1,1,-1]};function EZ(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,iDe,n),_7.extend(t,e,n),e.boundsMTime={},ce.obj(e.boundsMTime),ce.set(t,e,["property"]),ce.setGet(t,e,["backfaceProperty","forceOpaque","forceTranslucent","mapper"]),rDe(t,e)}const aDe=ce.newInstance(EZ,"vtkActor");var o0={newInstance:aDe,extend:EZ};function oDe(t,e){const n=t.invokeResize;delete t.invokeResize,e.renderWindow=u6e.newInstance(),e.rendererMap={},e.openGLRenderWindow=O9e.newInstance(),e.renderWindow.addView(e.openGLRenderWindow),e.interactor=tDe.newInstance(),e.interactor.setView(e.openGLRenderWindow),e.interactor.initialize(),t.addRenderer=({viewport:r,id:i,background:a})=>{const o=H9e.newInstance({viewport:r,background:a||e.background});e.renderWindow.addRenderer(o),e.rendererMap[i]=o},t.destroy=()=>{e.renderWindow.getInteractor().delete()},t.removeRenderer=r=>{const i=t.getRenderer(r);e.renderWindow.removeRenderer(i),i.delete(),delete e.rendererMap[r]},t.getRenderer=r=>e.rendererMap[r],t.getRenderers=()=>{const{rendererMap:r}=e;return Object.keys(r).map(a=>({id:a,renderer:r[a]}))},t.resize=()=>{if(e.container){const{width:r,height:i}=e.container;e.openGLRenderWindow.setSize(Math.floor(r),Math.floor(i)),n(),e.renderWindow.render()}},t.setContainer=r=>{e.container=r,e.openGLRenderWindow.setContainer(e.container)},t.delete=ce.chain(t.setContainer,t.destroy,e.openGLRenderWindow.delete,t.delete),t.resize()}const sDe={background:[0,0,0],container:null};function _Z(t,e,n={}){Object.assign(e,sDe,n),ce.obj(t,e),ce.get(t,e,["renderWindow","openGLRenderWindow","interactor","container"]),ce.event(t,e,"resize"),oDe(t,e)}const lDe=ce.newInstance(_Z),DZ={newInstance:lDe,extend:_Z},{BlendMode:Dd,FilterMode:Nv}=jK;function cDe(t,e,n,r,i){let a=null;return i?(a=i,a.removeAllPoints()):a=kh.newInstance(),a.addPointLong(-1024,0,1,1),a.addPoint(t,e),a.addPoint(n,r),a}const uDe={createRadonTransferFunction:cDe};function fDe(t,e){e.classHierarchy.push("vtkVolumeMapper");const n={...t};t.getBounds=()=>{const r=t.getInputData();return r?(e.static||t.update(),e.bounds=r.getBounds()):e.bounds=n0(),e.bounds},t.update=()=>{t.getInputData()},t.setBlendModeToComposite=()=>{t.setBlendMode(Dd.COMPOSITE_BLEND)},t.setBlendModeToMaximumIntensity=()=>{t.setBlendMode(Dd.MAXIMUM_INTENSITY_BLEND)},t.setBlendModeToMinimumIntensity=()=>{t.setBlendMode(Dd.MINIMUM_INTENSITY_BLEND)},t.setBlendModeToAverageIntensity=()=>{t.setBlendMode(Dd.AVERAGE_INTENSITY_BLEND)},t.setBlendModeToAdditiveIntensity=()=>{t.setBlendMode(Dd.ADDITIVE_INTENSITY_BLEND)},t.setBlendModeToRadonTransform=()=>{t.setBlendMode(Dd.RADON_TRANSFORM_BLEND)},t.getBlendModeAsString=()=>ce.enumToString(Dd,e.blendMode),t.setAverageIPScalarRange=(r,i)=>{console.warn("setAverageIPScalarRange is deprecated use setIpScalarRange"),t.setIpScalarRange(r,i)},t.getFilterModeAsString=()=>ce.enumToString(Nv,e.filterMode),t.setFilterModeToOff=()=>{t.setFilterMode(Nv.OFF)},t.setFilterModeToNormalized=()=>{t.setFilterMode(Nv.NORMALIZED)},t.setFilterModeToRaw=()=>{t.setFilterMode(Nv.RAW)},t.setGlobalIlluminationReach=r=>n.setGlobalIlluminationReach(xc(r,0,1)),t.setVolumetricScatteringBlending=r=>n.setVolumetricScatteringBlending(xc(r,0,1)),t.setVolumeShadowSamplingDistFactor=r=>n.setVolumeShadowSamplingDistFactor(r>=1?r:1),t.setAnisotropy=r=>n.setAnisotropy(xc(r,-.99,.99)),t.setLAOKernelSize=r=>n.setLAOKernelSize(qD(xc(r,1,32))),t.setLAOKernelRadius=r=>n.setLAOKernelRadius(r>=1?r:1)}const dDe=t=>({bounds:[1,-1,1,-1,1,-1],sampleDistance:1,imageSampleDistance:1,maximumSamplesPerRay:1e3,autoAdjustSampleDistances:!0,initialInteractionScale:1,interactionSampleDistanceFactor:1,blendMode:Dd.COMPOSITE_BLEND,ipScalarRange:[-1e6,1e6],filterMode:Nv.OFF,preferSizeOverAccuracy:!1,computeNormalFromOpacity:!1,volumetricScatteringBlending:0,globalIlluminationReach:0,volumeShadowSamplingDistFactor:5,anisotropy:0,localAmbientOcclusion:!1,LAOKernelSize:15,LAOKernelRadius:7,updatedExtents:[],...t});function OZ(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,dDe(n)),F7.extend(t,e,n),ce.setGet(t,e,["sampleDistance","imageSampleDistance","maximumSamplesPerRay","autoAdjustSampleDistances","initialInteractionScale","interactionSampleDistanceFactor","blendMode","filterMode","preferSizeOverAccuracy","computeNormalFromOpacity","volumetricScatteringBlending","globalIlluminationReach","volumeShadowSamplingDistFactor","anisotropy","localAmbientOcclusion","LAOKernelSize","LAOKernelRadius","updatedExtents"]),ce.setGetArray(t,e,["ipScalarRange"],2),ce.event(t,e,"lightingActivated"),fDe(t,e)}const hDe=ce.newInstance(OZ,"vtkVolumeMapper");var MZ={newInstance:hDe,extend:OZ,...uDe};function pDe(t,e){e.classHierarchy.push("vtkSharedVolumeMapper");const n=t.delete;t.delete=()=>{e.scalarTexture=null,n()}}const gDe={scalarTexture:null};function IZ(t,e,n={}){Object.assign(e,gDe,n),MZ.extend(t,e,n),ce.setGet(t,e,["scalarTexture"]),pDe(t,e)}const mDe=ce.newInstance(IZ,"vtkSharedVolumeMapper"),vDe={newInstance:mDe,extend:IZ};function HV(t,e){const n=U7(e),r=new n(t.length);return r.set(t),r}function yDe(t,e){e.classHierarchy.push("vtkStreamingOpenGLTexture"),e.updatedFrames=[],e.volumeId=null;const n=t.create3DFilterableFromRaw;t.create3DFilterableFromRaw=(s,l,c,f,u,d,h)=>{e.inputDataType=u,e.inputNumComps=f,n(s,l,c,f,u,d,h)};const r=t.updateVolumeInfoForGL;t.updateVolumeInfoForGL=(s,l)=>{const c=r(s,l);return e.volumeInfo.dataComputedScale=[1],e.volumeInfo.dataComputedOffset=[0],c},t.update3DFromRaw=()=>{const{volumeId:s}=e;if(!s)return;const l=yt.getVolume(s);if(e._openGLRenderWindow.activateTexture(t),t.createTexture(),t.bind(),l.isDynamicVolume()){o();return}return t.hasUpdatedFrames()&&a()};const i=t.modified;t.setUpdatedFrame=s=>{e.updatedFrames[s]=!0,i()},t.modified=()=>{i();const s=yt.getVolume(e.volumeId);if(!s)return;const l=s.imageIds;for(let c=0;c<l.length;c++)e.updatedFrames[c]=!0};function a(){const s=yt.getVolume(e.volumeId),l=s.imageIds;for(let c=0;c<e.updatedFrames.length;c++)if(e.updatedFrames[c]){const f=yt.getImage(l[c]);if(!f)continue;let u=f.voxelManager.getScalarData();const d=e.context;s.dataType!==u.constructor.name&&(u=HV(u,s.dataType));const[h]=t.updateArrayDataTypeForGL(s.dataType,[u]);t.bind();const p=c;d.texSubImage3D(e.target,0,0,0,p,e.width,e.height,1,e.format,e.openGLDataType,h),t.deactivate(),e.updatedFrames[c]=null}return e.generateMipmap&&e.context.generateMipmap(e.target),t.deactivate(),!0}function o(){const s=yt.getVolume(e.volumeId),l=s.getCurrentDimensionGroupImageIds();if(!l.length)return!1;let c;for(let f=0;f<l.length;f++){const u=l[f],d=yt.getImage(u);let h;d?(h=d.voxelManager.getScalarData(),c=h.constructor):(c=U7(s.dataType,!0),h=new c(e.width*e.height));const p=e.context;s.dataType!==h.constructor.name&&(h=HV(h,s.dataType));const[g]=t.updateArrayDataTypeForGL(s.dataType,[h]);t.bind();let m=f;p.texSubImage3D(e.target,0,0,0,m,e.width,e.height,1,e.format,e.openGLDataType,g),t.deactivate()}return e.generateMipmap&&e.context.generateMipmap(e.target),t.deactivate(),!0}t.hasUpdatedFrames=()=>!e.updatedFrames.length||e.updatedFrames.some(s=>s),t.getUpdatedFrames=()=>e.updatedFrames,t.setVolumeId=s=>{e.volumeId=s},t.getVolumeId=()=>e.volumeId,t.setTextureParameters=({width:s,height:l,depth:c,numberOfComponents:f,dataType:u})=>{e.width??=s,e.height??=l,e.depth??=c,e.inputNumComps??=f,e.inputDataType??=u},t.getTextureParameters=()=>({width:e.width,height:e.height,depth:e.depth,numberOfComponents:e.inputNumComps,dataType:e.inputDataType})}const xDe={updatedFrames:[]};function RZ(t,e,n={}){Object.assign(e,xDe,n),ai.extend(t,e,n),yDe(t,e)}const bDe=ce.newInstance(RZ,"vtkStreamingOpenGLTexture"),wDe={newInstance:bDe,extend:RZ},CDe={isPerformingCoordinateTransformation:!1};function PZ(t,e,n={}){Object.assign(e,CDe,n),$7.extend(t,e,n),ce.setGet(t,e,["isPerformingCoordinateTransformation"]),TDe(t,e)}const SDe=ce.newInstance(PZ,"vtkSlabCamera");function TDe(t,e){e.classHierarchy.push("vtkSlabCamera");const n=Yk(new Float64Array(16)),r=new Float64Array(3);t.getProjectionMatrix=(i,a,o)=>{const s=r0();if(e.projectionMatrix){const d=1/e.physicalScale;return t3(r,d,d,d),Xk(s,e.projectionMatrix),fX(s,s,r),Jk(s,s),s}Yk(n);let l=e.clippingRange[0],c=e.clippingRange[1];e.isPerformingCoordinateTransformation&&(l=e.distance,c=e.distance+.1);const f=c-l,u=[l+(a+1)*f/2,l+(o+1)*f/2];if(e.parallelProjection){const d=e.parallelScale*i,h=e.parallelScale,p=(e.windowCenter[0]-1)*d,g=(e.windowCenter[0]+1)*d,m=(e.windowCenter[1]-1)*h,y=(e.windowCenter[1]+1)*h;dwe(n,p,g,m,y,u[0],u[1]),Jk(n,n)}else{if(e.useOffAxisProjection)throw new Error("Off-Axis projection is not supported at this time");{const d=Math.tan(Zs.radiansFromDegrees(e.viewAngle)/2);let h,p;e.useHorizontalViewAngle===!0?(h=l*d,p=l*d/i):(h=l*d*i,p=l*d);const g=(e.windowCenter[0]-1)*h,m=(e.windowCenter[0]+1)*h,y=(e.windowCenter[1]-1)*p,v=(e.windowCenter[1]+1)*p,x=u[0],w=u[1];n[0]=2*x/(m-g),n[5]=2*x/(v-y),n[2]=(g+m)/(m-g),n[6]=(y+v)/(v-y),n[10]=-(x+w)/(w-x),n[14]=-1,n[11]=-2*x*w/(w-x),n[15]=0}}return Xk(s,n),s}}const EDe={newInstance:SDe,extend:PZ};class Hm{constructor(e){this._imageIdsIndexMap=new Map,this._imageURIsIndexMap=new Map,this.cornerstoneImageMetaData=null,this.isPreScaled=!1,this.numTimePoints=null,this.numFrames=null;const{imageIds:n,scaling:r,dimensions:i,spacing:a,origin:o,direction:s,dataType:l,volumeId:c,referencedVolumeId:f,metadata:u,referencedImageIds:d,additionalDetails:h,voxelManager:p,numberOfComponents:g}=e;if(!l)throw new Error('Data type is required, please provide a data type as string such as "Uint8Array", "Float32Array", etc.');let{imageData:m}=e;this.suppressWarnings=!0,this.imageIds=n,this.volumeId=c,this.metadata=u,this.dimensions=i,this.spacing=a,this.origin=o,this.direction=s,this.dataType=l,this.vtkOpenGLTexture=wDe.newInstance(),this.vtkOpenGLTexture.setVolumeId(c),this.voxelManager=p??a0.createImageVolumeVoxelManager({dimensions:i,imageIds:n,numberOfComponents:g}),this.numVoxels=this.dimensions[0]*this.dimensions[1]*this.dimensions[2],m||(m=KC.newInstance(),m.setDimensions(i),m.setSpacing(a),m.setDirection(s),m.setOrigin(o)),m.set({dataType:l,voxelManager:this.voxelManager,id:c,numberOfComponents:g||1},this.suppressWarnings),m.set({hasScalarVolume:!1},this.suppressWarnings),this.imageData=m,this.numFrames=this._getNumFrames(),this._reprocessImageIds(),r&&(this.scaling=r),f&&(this.referencedVolumeId=f),d&&(this.referencedImageIds=d),h&&(this.additionalDetails=h)}get sizeInBytes(){return this.voxelManager.sizeInBytes}get imageIds(){return this._imageIds}set imageIds(e){this._imageIds=e,this._reprocessImageIds()}_reprocessImageIds(){this._imageIdsIndexMap.clear(),this._imageURIsIndexMap.clear(),this._imageIds.forEach((e,n)=>{const r=Ci(e);this._imageIdsIndexMap.set(e,n),this._imageURIsIndexMap.set(r,n)})}isDynamicVolume(){return this.numTimePoints>1}getImageIdIndex(e){return this._imageIdsIndexMap.get(e)}getImageIdByIndex(e){return this._imageIds[e]}getImageURIIndex(e){return this._imageURIsIndexMap.get(e)}load(e){}destroy(){this.imageData.delete(),this.imageData=null,this.voxelManager.clear(),this.vtkOpenGLTexture.releaseGraphicsResources(),this.vtkOpenGLTexture.delete()}invalidate(){for(let e=0;e<this.imageIds.length;e++)this.vtkOpenGLTexture.setUpdatedFrame(e);this.imageData.modified()}modified(){this.imageData.modified(),this.vtkOpenGLTexture.modified(),this.numFrames=this._getNumFrames()}removeFromCache(){yt.removeVolumeLoadObject(this.volumeId)}getScalarDataLength(){return this.voxelManager.getScalarDataLength()}_getNumFrames(){return this.isDynamicVolume()?this.numTimePoints:this.imageIds.length}imageIdIndexToFrameIndex(e){return e%this.numFrames}getCornerstoneImages(){const{imageIds:e}=this;return e.map(n=>yt.getImage(n))}}const uu=[];function Km(t,e=0){let n;for(n=0;n<uu.length&&!(uu[n].priority<=e);n++);uu.splice(n,0,{priority:e,provider:t})}function _De(t){for(let e=0;e<uu.length;e++)if(uu[e].provider===t){uu.splice(e,1);break}}function DDe(){for(;uu.length>0;)uu.pop()}function Ut(t,...e){for(let n=0;n<uu.length;n++){const r=uu[n].provider(t,...e);if(r!==void 0)return r}}const AZ=Object.freeze(Object.defineProperty({__proto__:null,addProvider:Km,get:Ut,removeAllProviders:DDe,removeProvider:_De},Symbol.toStringTag,{value:"Module"}));let lv={};const Gd={add:(t,e)=>{Gd.addRaw(t,{...e,metadata:structuredClone(e.metadata)})},addRaw:(t,e)=>{const n=e.type;lv[t]||(lv[t]={}),lv[t][n]=e.metadata},get:(t,e)=>lv[e]?.[t],clear:()=>{lv={}}};Km(Gd.get);const is=new LD("imageLoadPool");is.grabDelay=0;is.setMaxSimultaneousRequests(_n.Interaction,1e3);is.setMaxSimultaneousRequests(_n.Thumbnail,1e3);is.setMaxSimultaneousRequests(_n.Prefetch,1e3);const g3={};let m3;function NZ(t,e){const n=yt.getImageLoadObject(t);if(n)return KV(n.promise,t),n;const r=t.split(":")[0],i=g3[r]||m3;if(!i)throw new Error(`loadImageFromImageLoader: No image loader found for scheme '${r}'`);const a=i(t,e);return KV(a.promise,t),a}function KV(t,e){Promise.resolve(t).then(n=>{ODe(n),wt(vt,mt.IMAGE_LOADED,{image:n})}).catch(n=>{const r={imageId:e,error:n};wt(vt,mt.IMAGE_LOAD_FAILED,r)})}function ODe(t){if(!t.voxelManager){const{width:e,height:n,numberOfComponents:r}=t,i=a0.createImageVoxelManager({scalarData:t.getPixelData(),width:e,height:n,numberOfComponents:r});t.voxelManager=i,t.getPixelData=()=>i.getScalarData(),delete t.imageFrame.pixelData}}function LZ(t,e={priority:0,requestType:"prefetch"}){if(t===void 0)throw new Error("loadImage: parameter imageId must not be undefined");return NZ(t,e).promise}function s0(t,e={priority:0,requestType:"prefetch"}){if(t===void 0)throw new Error("loadAndCacheImage: parameter imageId must not be undefined");const n=NZ(t,e);return yt.getImageLoadObject(t)||yt.putImageLoadObject(t,n),n.promise}function MDe(t,e={priority:0,requestType:"prefetch"}){if(!t||t.length===0)throw new Error("loadAndCacheImages: parameter imageIds must be list of image Ids");return t.map(r=>s0(r,e))}function j7(t,e={}){if(t===void 0)throw new Error("createAndCacheDerivedImage: parameter imageId must not be undefined");e.imageId===void 0&&(e.imageId=`derived:${cr()}`);const{imageId:n,skipCreateBuffer:r,onCacheAdd:i,voxelRepresentation:a}=e,o=Ut("imagePlaneModule",t),s=o.rows*o.columns,{TypedArrayConstructor:l}=B7(e.targetBuffer?.type,s),c=new l(r?1:s),f=n,u=Ut("imagePlaneModule",t);Gd.add(f,{type:"imagePlaneModule",metadata:u});const d=Ut("generalSeriesModule",t);Gd.add(f,{type:"generalSeriesModule",metadata:d}),Gd.add(f,{type:"generalImageModule",metadata:{instanceNumber:e.instanceNumber}});const h=Ut("imagePixelModule",t);Gd.add(f,{type:"imagePixelModule",metadata:{...h,bitsAllocated:8,bitsStored:8,highBit:7,samplesPerPixel:1,pixelRepresentation:0}});const p=W7(n,{scalarData:c,onCacheAdd:i,skipCreateBuffer:r,targetBuffer:{type:c.constructor.name},voxelRepresentation:a,dimensions:[o.columns,o.rows],spacing:[o.columnPixelSpacing,o.rowPixelSpacing],origin:o.imagePositionPatient,direction:o.imageOrientationPatient,frameOfReferenceUID:o.frameOfReferenceUID,referencedImageId:t});return p.referencedImageId=t,yt.getImageLoadObject(n)||yt.putImageSync(n,p),p}function z7(t,e={}){if(t.length===0)throw new Error("createAndCacheDerivedImages: parameter imageIds must be list of image Ids");return t.map((r,i)=>{const a={imageId:e?.getDerivedImageId?.(r)||`derived:${cr()}`,...e};return j7(r,{...a,instanceNumber:i+1})})}function W7(t,e){const{scalarData:n,origin:r,direction:i,targetBuffer:a,skipCreateBuffer:o,onCacheAdd:s,frameOfReferenceUID:l,voxelRepresentation:c,referencedImageId:f}=e,u=e.dimensions,d=e.spacing;if(!u||!d)throw new Error("createAndCacheLocalImage: dimensions and spacing are required");const h=u[0],p=u[1],g=d[0],m=d[1],y={frameOfReferenceUID:l,rows:p,columns:h,imageOrientationPatient:i??[1,0,0,0,1,0],rowCosines:i?i.slice(0,3):[1,0,0],columnCosines:i?i.slice(3,6):[0,1,0],imagePositionPatient:r??[0,0,0],pixelSpacing:[m,g],rowPixelSpacing:m,columnPixelSpacing:g},v=h*p,x=n.length/v;let w;if(n){if(!(n instanceof Uint8Array||n instanceof Float32Array||n instanceof Uint16Array||n instanceof Int16Array))throw new Error("createAndCacheLocalImage: scalarData must be of type Uint8Array, Uint16Array, Int16Array or Float32Array");w=n}else if(!o){const{TypedArrayConstructor:B}=B7(a?.type,v);w=new B(v)}let S,T,_;if(w instanceof Uint8Array)S=8,T=8,_=7;else if(w instanceof Uint16Array)S=16,T=16,_=15;else if(w instanceof Int16Array)S=16,T=16,_=15;else if(w instanceof Float32Array)S=32,T=32,_=31;else throw new Error("Unsupported scalarData type");const D={samplesPerPixel:1,photometricInterpretation:w.length>u[0]*u[1]?"RGB":"MONOCHROME2",rows:p,columns:h,bitsAllocated:S,bitsStored:T,highBit:_},I={imagePlaneModule:y,imagePixelModule:D};["imagePlaneModule","imagePixelModule"].forEach(B=>{Gd.add(t,{type:B,metadata:I[B]||{}})});const R=t,O=c===jw.RLE&&a0.createRLEImageVoxelManager({dimensions:u,id:R})||a0.createImageVoxelManager({height:p,width:h,numberOfComponents:x,scalarData:w,id:R});let P=w[0],N=w[0];for(let B=1;B<w.length;B++)w[B]<P&&(P=w[B]),w[B]>N&&(N=w[B]);const A={imageId:t,intercept:0,windowCenter:0,windowWidth:0,color:D.photometricInterpretation==="RGB",numberOfComponents:D.samplesPerPixel,dataType:a?.type,slope:1,minPixelValue:P,maxPixelValue:N,rows:D.rows,columns:D.columns,getCanvas:void 0,height:D.rows,width:D.columns,rgba:void 0,columnPixelSpacing:y.columnPixelSpacing,rowPixelSpacing:y.rowPixelSpacing,FrameOfReferenceUID:y.frameOfReferenceUID,invert:!1,getPixelData:()=>O.getScalarData(),voxelManager:O,sizeInBytes:n.byteLength,referencedImageId:f};return s?.(A),yt.putImageSync(A.imageId,A),A}function kZ(t){const e=({additionalDetails:r})=>r.imageId?r.imageId!==t:!0;is.filterRequests(e);const n=yt.getImageLoadObject(t);n&&n.cancelFn()}function IDe(t){t.forEach(e=>{kZ(e)})}function RDe(){const t=is.getRequestPool();Object.keys(t).forEach(e=>{const n=t[e];Object.keys(n).forEach(r=>{const i=n[r].pop();if(!i)return;const a=i.additionalDetails,{imageId:o,volumeId:s}=a;let l;o?l=yt.getImageLoadObject(o):s&&(l=yt.getVolumeLoadObject(s)),l&&l.cancel()}),is.clearRequestStack(e)})}function qg(t,e){g3[t]=e}function PDe(t){const e=m3;return m3=t,e}function ADe(){Object.keys(g3).forEach(t=>delete g3[t]),m3=void 0}function NDe(t,e={}){return z7(t,{...e,targetBuffer:{type:"Uint8Array"}})}function LDe(t,e={}){return j7(t,{...e,targetBuffer:{type:"Uint8Array"}})}const kDe=Object.freeze(Object.defineProperty({__proto__:null,cancelLoadAll:RDe,cancelLoadImage:kZ,cancelLoadImages:IDe,createAndCacheDerivedImage:j7,createAndCacheDerivedImages:z7,createAndCacheDerivedLabelmapImage:LDe,createAndCacheDerivedLabelmapImages:NDe,createAndCacheLocalImage:W7,loadAndCacheImage:s0,loadAndCacheImages:MDe,loadImage:LZ,registerImageLoader:qg,registerUnknownImageLoader:PDe,unregisterAllImageLoaders:ADe},Symbol.toStringTag,{value:"Module"}));function VZ(t){const e=t[0],{pixelRepresentation:n,bitsAllocated:r,bitsStored:i,highBit:a,photometricInterpretation:o,samplesPerPixel:s}=Ut("imagePixelModule",e),l=[],c=Ut("voiLutModule",e);let f;if(c){const{windowWidth:v,windowCenter:x}=c;if(f=c?.voiLUTFunction,Array.isArray(v))for(let w=0;w<v.length;w++)l.push({windowWidth:v[w],windowCenter:x[w]});else l.push({windowWidth:v,windowCenter:x})}else l.push({windowWidth:void 0,windowCenter:void 0});const{modality:u,seriesInstanceUID:d}=Ut("generalSeriesModule",e),{imageOrientationPatient:h,pixelSpacing:p,frameOfReferenceUID:g,columns:m,rows:y}=Ut("imagePlaneModule",e);return{BitsAllocated:r,BitsStored:i,SamplesPerPixel:s,HighBit:a,PhotometricInterpretation:o,PixelRepresentation:n,Modality:u,ImageOrientationPatient:h,PixelSpacing:p,FrameOfReferenceUID:g,Columns:m,Rows:y,voiLut:l,VOILUTFunction:f,SeriesInstanceUID:d}}function FZ(t){const{imagePositionPatient:e,imageOrientationPatient:n}=Ut("imagePlaneModule",t[0]),r=Sn(n[0],n[1],n[2]),i=Sn(n[3],n[4],n[5]),a=it();gr(a,r,i);const o=Sn(e[0],e[1],e[2]),s=t[0].split(":")[0]==="wadouri";let l;function c(h){const{imagePositionPatient:p}=Ut("imagePlaneModule",h),g=it(),m=Sn(p[0],p[1],p[2]);return dr(g,o,m),zt(g,a)}if(s){const h=[t[0],t[Math.floor(t.length/2)]];c(h[0]),c(h[1]);const p=Ut("imagePlaneModule",h[1]);if(!p)throw new Error("Incomplete metadata required for volume construction.");const g=it(),m=Sn(p.imagePositionPatient[0],p.imagePositionPatient[1],p.imagePositionPatient[2]);dr(g,o,m);const y=zt(g,a);l=Math.abs(y)/Math.floor(t.length/2)}else{const h=t.map(g=>({distance:c(g),imageId:g}));h.sort((g,m)=>m.distance-g.distance);const p=h.length;l=Math.abs(h[p-1].distance-h[0].distance)/(p-1)}const{sliceThickness:f,spacingBetweenSlices:u}=Ut("imagePlaneModule",t[0]),{strictZSpacingForVolumeViewport:d}=Vf().rendering;return(l===0||isNaN(l))&&!d&&(u?(console.debug("Could not calculate spacing. Using spacingBetweenSlices"),l=u):f?(console.debug("Could not calculate spacing and no spacingBetweenSlices. Using sliceThickness"),l=f):(console.debug("Could not calculate spacing. The VolumeViewport visualization is compromised. Setting spacing to 1 to render"),l=1)),l}function H7(t,e){const{imagePositionPatient:n,imageOrientationPatient:r}=Ut("imagePlaneModule",t[0]);if(!e){const f=Sn(r[0],r[1],r[2]),u=Sn(r[3],r[4],r[5]);e=it(),gr(e,f,u)}const i=t[0].split(":")[0]==="wadouri",a=FZ(t);let o;function s(f){const{imagePositionPatient:u}=Ut("imagePlaneModule",f),d=it();return dr(d,n,u),zt(d,e)}if(i){const f=[t[0],t[Math.floor(t.length/2)]];o=t;const u=s(f[0]),d=s(f[1]);u-d<0&&o.reverse()}else{const f=t.map(u=>({distance:s(u),imageId:u}));f.sort((u,d)=>d.distance-u.distance),o=f.map(u=>u.imageId)}const{imagePositionPatient:l}=Ut("imagePlaneModule",o[0]);return{zSpacing:a,origin:l,sortedImageIds:o}}function UZ(t){const e=Ut("modalityLutModule",t)||{},n=Ut("generalSeriesModule",t)||{},{modality:r}=n,i={rescaleSlope:e.rescaleSlope||1,rescaleIntercept:e.rescaleIntercept??0,modality:r},a=Ut("scalingModule",t)||{};return{...i,...r==="PT"&&{suvbw:a.suvbw,suvbsa:a.suvbsa,suvlbm:a.suvlbm},...r==="RTDOSE"&&{doseGridScaling:a.DoseGridScaling,doseSummation:a.DoseSummation,doseType:a.DoseType,doseUnit:a.DoseUnit}}}const K7=t=>Object.values(t).some(n=>typeof n=="number"&&!Number.isInteger(n)),qV={Uint8Array:"Uint8Array",Int16Array:"Int16Array",Uint16Array:"Uint16Array",Float32Array:"Float32Array"};function YC(t,e){const n=VZ(t),{ImageOrientationPatient:r,PixelSpacing:i,Columns:a,Rows:o}=n,s=Sn(r[0],r[1],r[2]),l=Sn(r[3],r[4],r[5]),c=it();gr(c,s,l);const{zSpacing:f,origin:u,sortedImageIds:d}=H7(t,c),h=t.length,p=[i[1],i[0],f],g=[a,o,h].map(y=>Math.floor(y)),m=[...s,...l,...c];return{dimensions:g,spacing:p,origin:u,dataType:VDe(d,n),direction:m,metadata:n,imageIds:d,volumeId:e,voxelManager:null,numberOfComponents:n.PhotometricInterpretation==="RGB"?3:1}}function VDe(t,e){const{BitsAllocated:n,PixelRepresentation:r}=e,i=r===1,a=FDe(t);if(a)return a;const[o,s,l]=[0,Math.floor(t.length/2),t.length-1],c=[o,s,l].map(h=>UZ(t[h])),f=c.some(h=>h.rescaleIntercept<0||h.rescaleSlope<0),u=c.some(h=>K7(h)),d=IC();switch(n){case 8:return"Uint8Array";case 16:return d&&u?"Float32Array":i||f?"Int16Array":!i&&!f?"Uint16Array":"Float32Array";case 24:return"Uint8Array";case 32:return"Float32Array";default:throw new Error(`Bits allocated of ${n} is not defined to generate scalarData for the volume.`)}}function FDe(t){const n=[0,Math.floor(t.length/2),t.length-1].map(i=>yt.getImage(t[i]));if(!n.every(Boolean))return null;const r=n[0].getPixelData().constructor.name;return n.every(i=>i.getPixelData().constructor.name===r)&&r in qV?qV[r]:null}let v3=class BZ{constructor(e){this.name=e||"unknown"}static as(e){if(e.iterator)return e.iterator;const n=new BZ("as iterator");return e.then(r=>{try{n.add(r,!0)}catch(i){n.reject(i)}},r=>{n.reject(r)}),n}add(e,n=!1){this.nextValue=e,this.done||=n,this.waiting&&(this.waiting.resolve(e),this.waiting=void 0)}resolve(){this.done=!0,this.waiting&&(this.waiting.resolve(this.nextValue),this.waiting=void 0)}reject(e){this.rejectReason=e,this.waiting?.reject(e)}getRecent(){if(this.rejectReason)throw this.rejectReason;return this.nextValue}async*[Symbol.asyncIterator](){for(;!this.done;){if(this.rejectReason)throw this.rejectReason;if(this.nextValue!==void 0&&(yield this.nextValue,this.done))break;this.waiting||(this.waiting={},this.waiting.promise=new Promise((e,n)=>{this.waiting.resolve=e,this.waiting.reject=n})),await this.waiting.promise}yield this.nextValue}async forEach(e,n){let r=0;try{for await(const i of this){const{done:a}=this;try{await e(i,a,r),r++}catch(o){if(!a){console.warn("Caught exception in intermediate value",o);continue}if(n)n(o,a);else throw o}}}catch(i){if(n)n(i,!0);else throw i}}generate(e,n){return e(this,this.reject.bind(this)).then(()=>{this.done||this.resolve()},r=>{this.reject(r),n?n(r):console.warn("Couldn't process because",r)})}async nextPromise(){for await(const e of this)if(e)return e;return this.nextValue}async donePromise(){for await(const e of this);return this.nextValue}getNextPromise(){const e=this.nextPromise();return e.iterator=this,e}getDonePromise(){const e=this.donePromise();return e.iterator=this,e}};const $p=new Map,XV="imageRetrieveConfiguration",pm={IMAGE_RETRIEVE_CONFIGURATION:XV,clear:()=>{$p.clear()},add:(t,e)=>{$p.set(t,e)},clone:()=>new Map($p),restore:t=>{$p.clear(),t.forEach((e,n)=>{$p.set(n,e)})},get:(t,...e)=>{if(t===XV)return e.map(n=>$p.get(n)).find(n=>n!==void 0)}};Km(pm.get.bind(pm));function JC(t){const e=jl(),n=[];return e.forEach(r=>{const a=r.getVolumeViewports().filter(o=>o.hasVolumeId(t));n.push(...a)}),n}const $_=t=>{const e=UDe(t);e?.length&&e.forEach(({renderingEngine:n,viewportIds:r})=>{n.hasBeenDestroyed||n.renderViewports(r)})};function UDe(t){const e=jl(),n=[];return e.forEach(r=>{const i=JC(t);i.length&&n.push({renderingEngine:r,viewportIds:i.map(a=>a.id)})}),n}const YV=[{id:"initialImages",retrieveType:"single"}],BDe=[{id:"lossySequential",retrieveType:"singleFast"},{id:"finalSequential",retrieveType:"singleFinal"}],QE=[{offset:-1,imageQualityStatus:Ds.ADJACENT_REPLICATE},{offset:1,imageQualityStatus:Ds.ADJACENT_REPLICATE},{offset:2,imageQualityStatus:Ds.FAR_REPLICATE}],$De=[{id:"initialImages",positions:[.5,0,-1],retrieveType:"default",requestType:_n.Thumbnail,priority:5,nearbyFrames:QE},{id:"quarterThumb",decimate:4,offset:3,requestType:_n.Thumbnail,retrieveType:"multipleFast",priority:6,nearbyFrames:QE},{id:"halfThumb",decimate:4,offset:1,priority:7,requestType:_n.Thumbnail,retrieveType:"multipleFast",nearbyFrames:QE},{id:"quarterFull",decimate:4,offset:2,priority:8,requestType:_n.Thumbnail,retrieveType:"multipleFinal"},{id:"halfFull",decimate:4,offset:0,priority:9,requestType:_n.Thumbnail,retrieveType:"multipleFinal"},{id:"threeQuarterFull",decimate:4,offset:1,priority:10,requestType:_n.Thumbnail,retrieveType:"multipleFinal"},{id:"finalFull",decimate:4,offset:3,priority:11,requestType:_n.Thumbnail,retrieveType:"multipleFinal"},{id:"errorRetrieve"}];function $Z(t,e,n=0){const r=[];for(let i=n;i<t.length;i+=e)r.push(i);return r}function GDe(t,e,n){if(e?.nearbyRequests?.length)for(const r of e.nearbyRequests)try{const{itemId:i,imageQualityStatus:a}=r,o=yt.getImageQuality(i);if(o!==void 0&&o>=a)continue;const s={...n,imageId:i,imageQualityStatus:a};yt.setPartialImage(i,s),t.successCallback(i,s)}catch(i){console.warn("Couldn't fill nearby item ",r.itemId,i)}}const Dg=class Dg{constructor(e){this.stages=e.stages||YV,this.retrieveOptions=e.retrieveOptions||{}}loadImages(e,n){return new jDe(this,e,n).loadImages()}};Dg.createProgressive=GZ,Dg.interleavedRetrieveStages={stages:$De},Dg.singleRetrieveStages={stages:YV},Dg.sequentialRetrieveStages={stages:BDe};let X2=Dg;class jDe{constructor(e,n,r){this.outstandingRequests=0,this.stageStatusMap=new Map,this.displayedIterator=new v3("displayed"),this.stages=e.stages,this.retrieveOptions=e.retrieveOptions,this.imageIds=n,this.listener=r}async loadImages(){const e=this.createStageRequests();this.outstandingRequests=e.length;for(const n of e)this.addRequest(n);return this.outstandingRequests===0?Promise.resolve(null):this.displayedIterator.getDonePromise()}sendRequest(e,n){const{imageId:r,next:i}=e,a=(f,u)=>{this.listener.errorCallback(r,l||!i,f),u&&this.updateStageStatus(e.stage,f)},o=(n.loader||s0)(r,n),s=v3.as(o);let l=!1;return s.forEach(async(f,u)=>{const d=yt.getImageQuality(r);if(!f){console.warn("No image retrieved",r);return}const{imageQualityStatus:h}=f;if(l||=h===Ds.FULL_RESOLUTION,d!==void 0&&d>h){this.updateStageStatus(e.stage,null,!0);return}this.listener.successCallback(r,f),this.displayedIterator.add(f),u&&this.updateStageStatus(e.stage),GDe(this.listener,e,f)},a).finally(()=>{if(!l&&i)yt.setPartialImage(r),this.addRequest(i,n.streamingData);else{l||this.listener.errorCallback(r,!0,"Couldn't decode"),this.outstandingRequests--;for(let f=i;f;f=f.next)this.updateStageStatus(f.stage,null,!0)}this.outstandingRequests<=0&&this.displayedIterator.resolve()}),s.getDonePromise().catch(f=>null)}addRequest(e,n={}){const{imageId:r,stage:i}=e,a=this.listener.getLoaderImageOptions(r);if(!a)return;const{retrieveType:o="default"}=i,{retrieveOptions:s}=this,l=s[o]||s.default,c={...a,retrieveType:o,retrieveOptions:l,streamingData:n},f=i.priority??-5,u=i.requestType||_n.Interaction,d={imageId:r};is.addRequest(this.sendRequest.bind(this,e,c),u,d,f)}updateStageStatus(e,n,r=!1){const{id:i}=e,a=this.stageStatusMap.get(i);if(a&&(a.imageLoadPendingCount--,n?a.imageLoadFailedCount++:r||a.totalImageCount++,!r&&!a.stageStartTime&&(a.stageStartTime=Date.now()),!a.imageLoadPendingCount)){const{imageLoadFailedCount:o,totalImageCount:s,stageStartTime:l=Date.now(),startTime:c}=a,f={stageId:i,numberOfFailures:o,numberOfImages:s,stageDurationInMS:l?Date.now()-l:null,startDurationInMS:Date.now()-c};wt(vt,mt.IMAGE_RETRIEVAL_STAGE,f),this.stageStatusMap.delete(i)}}createStageRequests(){const e=new Array,n=new Map,r=(i,a)=>{const o=a<0?this.imageIds.length+a:a<1?Math.floor((this.imageIds.length-1)*a):a,s=this.imageIds[o];if(!s)throw new Error(`No value found to add to requests at ${a}`);const l={imageId:s,stage:i,index:o,nearbyRequests:this.findNearbyRequests(o,i)};this.addStageStatus(i);const c=n.get(s);c?c.next=l:e.push(l),n.set(s,l)};for(const i of this.stages)(i.positions||$Z(this.imageIds,i.decimate||1,i.offset??0)).forEach(o=>{r(i,o)});return e}findNearbyRequests(e,n){const r=new Array;if(!n.nearbyFrames)return r;for(const i of n.nearbyFrames){const a=e+i.offset;a<0||a>=this.imageIds.length||r.push({itemId:this.imageIds[a],imageQualityStatus:i.imageQualityStatus,index:a})}return r}addStageStatus(e){const{id:n}=e,r=this.stageStatusMap.get(n)||{stageId:n,startTime:Date.now(),stageStartTime:null,totalImageCount:0,imageLoadFailedCount:0,imageLoadPendingCount:0};return r.imageLoadPendingCount++,this.stageStatusMap.set(n,r),r}}function GZ(t){return new X2(t)}const JV=_n.Prefetch;class jZ extends Hm{constructor(e,n){super(e),this.framesLoaded=0,this.framesProcessed=0,this.framesUpdated=0,this.autoRenderOnLoad=!0,this.cachedFrames=[],this.reRenderTarget=0,this.reRenderFraction=2,this.imagesLoader=this,this.cancelLoading=()=>{const{loadStatus:r}=this;if(!r||!r.loading)return;r.loading=!1,r.cancelled=!0,this.clearLoadCallbacks();const i=({additionalDetails:a})=>a.volumeId!==this.volumeId;is.filterRequests(i)},this.loadStatus=n.loadStatus}invalidateVolume(e){const{vtkOpenGLTexture:n}=this,{numFrames:r}=this;for(let i=0;i<r;i++)n.setUpdatedFrame(i);this.modified(),e&&$_(this.volumeId)}clearLoadCallbacks(){this.loadStatus.callbacks=[]}callLoadStatusCallback(e){const{framesUpdated:n,framesProcessed:r,totalNumFrames:i}=e,{volumeId:a,reRenderFraction:o,loadStatus:s,metadata:l}=this,{FrameOfReferenceUID:c}=l;if(this.autoRenderOnLoad&&(n>this.reRenderTarget||r===i)&&(this.reRenderTarget+=o,$_(a)),r===i){s.callbacks.forEach(u=>u(e));const f={FrameOfReferenceUID:c,volumeId:a};wt(vt,mt.IMAGE_VOLUME_LOADING_COMPLETED,f)}}updateTextureAndTriggerEvents(e,n,r=Ds.FULL_RESOLUTION){const i=this.imageIdIndexToFrameIndex(e),{cachedFrames:a,numFrames:o,totalNumFrames:s}=this,{FrameOfReferenceUID:l}=this.metadata;if(a[i]>r||a[i]===Ds.FULL_RESOLUTION)return;const f=r===Ds.FULL_RESOLUTION;a[e]=r,this.framesUpdated++,f&&(this.framesLoaded++,this.framesProcessed++);const u={FrameOfReferenceUID:l,volumeId:this.volumeId,numberOfFrames:o,framesProcessed:this.framesProcessed};wt(vt,mt.IMAGE_VOLUME_MODIFIED,u),f&&this.framesProcessed===this.totalNumFrames&&(this.loadStatus.loaded=!0,this.loadStatus.loading=!1),this.callLoadStatusCallback({success:!0,imageIdIndex:e,imageId:n,framesLoaded:this.framesLoaded,framesProcessed:this.framesProcessed,framesUpdated:this.framesUpdated,numFrames:o,totalNumFrames:s,complete:f,imageQualityStatus:r}),this.vtkOpenGLTexture.setUpdatedFrame(i),this.loadStatus.loaded&&(this.loadStatus.callbacks=[])}successCallback(e,n){const r=this.getImageIdIndex(e),{imageQualityStatus:i}=n;if(this.loadStatus.cancelled){console.warn("volume load cancelled, returning for imageIdIndex: ",r);return}this.updateTextureAndTriggerEvents(r,e,i),this.isDynamicVolume()&&this.checkDimensionGroupCompletion(r)}errorCallback(e,n,r){if(!n)return;const{totalNumFrames:i,numFrames:a}=this,o=this.getImageIdIndex(e);this.framesProcessed++,this.framesProcessed===i&&(this.loadStatus.loaded=!0,this.loadStatus.loading=!1),this.callLoadStatusCallback({success:!1,imageId:e,imageIdIndex:o,error:r,framesLoaded:this.framesLoaded,framesProcessed:this.framesProcessed,framesUpdated:this.framesUpdated,numFrames:a,totalNumFrames:i}),this.loadStatus.loaded&&(this.loadStatus.callbacks=[]);const s={error:r,imageIdIndex:o,imageId:e};wt(vt,mt.IMAGE_LOAD_ERROR,s)}load(e){const{imageIds:n,loadStatus:r,numFrames:i}=this,{transferSyntaxUID:a}=Ut("transferSyntax",n[0])||{},o=Ut(pm.IMAGE_RETRIEVE_CONFIGURATION,this.volumeId,a,"volume");if(this.imagesLoader=this.isDynamicVolume()?this:o?(o.create||X2.createProgressive)(o):this,r.loading===!0)return;const{loaded:s}=this.loadStatus,l=n.length;if(s){e&&e({success:!0,framesLoaded:l,framesProcessed:l,numFrames:i,totalNumFrames:l});return}e&&this.loadStatus.callbacks.push(e),this._prefetchImageIds()}getLoaderImageOptions(e){const{transferSyntaxUID:n}=Ut("transferSyntax",e)||{},r=Ut("imagePlaneModule",e)||{},{rows:i,columns:a}=r,o=this.getImageIdIndex(e),s=Ut("modalityLutModule",e)||{},l=Ut("generalSeriesModule",e)||{},c={rescaleSlope:s.rescaleSlope,rescaleIntercept:s.rescaleIntercept,modality:l.modality},f=c.modality;if(f==="PT"||f==="RTDOSE"){const p=Ut("scalingModule",e);p&&(this._addScalingToVolume(p),Object.assign(c,p))}const u=K7(c),d=IC();if(this.isPreScaled=!0,c&&c.rescaleSlope!==void 0&&c.rescaleIntercept!==void 0){const{rescaleSlope:p,rescaleIntercept:g}=c;this.isPreScaled=typeof p=="number"&&typeof g=="number"}return!d&&u&&(this.isPreScaled=!1),{targetBuffer:{type:this.dataType,rows:i,columns:a},allowFloatRendering:d,preScale:{enabled:this.isPreScaled,scalingParameters:c},transferPixelData:!0,requestType:JV,transferSyntaxUID:n,additionalDetails:{imageId:e,imageIdIndex:o,volumeId:this.volumeId},retrieveOptions:void 0}}callLoadImage(e,n,r){const{cachedFrames:i}=this;if(i[n]===Ds.FULL_RESOLUTION)return;const a=s=>{const{image:l}=s.detail;l.imageId===e&&(this.vtkOpenGLTexture.setUpdatedFrame(n),vt.removeEventListener(mt.IMAGE_CACHE_IMAGE_ADDED,a))};return vt.addEventListener(mt.IMAGE_CACHE_IMAGE_ADDED,a),v3.as(s0(e,r)).forEach(s=>{this.successCallback(e,s)},this.errorCallback.bind(this,n,e))}getImageIdsRequests(e,n){this.totalNumFrames=this.imageIds.length;const r=2;return this.autoRenderOnLoad&&(this.reRenderFraction=this.totalNumFrames*(r/100),this.reRenderTarget=this.reRenderFraction),e.map(a=>{const o=this.getImageIdIndex(a),s=JV,l=n,c=this.getLoaderImageOptions(a),{retrieveOptions:f={}}=Ut(pm.IMAGE_RETRIEVE_CONFIGURATION,a,"volume")||{};return c.retrieveOptions={...c.retrieveOptions,...f.default||Object.values(f)?.[0]||{}},{callLoadImage:this.callLoadImage.bind(this),imageId:a,imageIdIndex:o,options:c,priority:l,requestType:s,additionalDetails:{volumeId:this.volumeId}}})}getImageLoadRequests(e){throw new Error("Abstract method")}getImageIdsToLoad(){throw new Error("Abstract method")}loadImages(){return this.loadStatus.loading=!0,this.getImageLoadRequests(5).reverse().forEach(n=>{if(!n)return;const{callLoadImage:r,imageId:i,imageIdIndex:a,options:o,priority:s,requestType:l,additionalDetails:c}=n;is.addRequest(r.bind(this,i,a,o),l,c,s)}),Promise.resolve(!0)}_prefetchImageIds(){this.loadStatus.loading=!0;const e=[...this.getImageIdsToLoad()];this.totalNumFrames=this.imageIds.length;const n=2;return this.autoRenderOnLoad&&(this.reRenderFraction=this.totalNumFrames*(n/100),this.reRenderTarget=this.reRenderFraction),this.imagesLoader.loadImages(e,this).catch(r=>{console.debug("progressive loading failed to complete",r)})}_addScalingToVolume(e){if(this.scaling)return;const{suvbw:n,suvlbm:r,suvbsa:i}=e,a={};r&&(a.suvbwToSuvlbm=r/n),i&&(a.suvbwToSuvbsa=i/n),n&&(a.suvbw=n),this.scaling={PT:a}}checkDimensionGroupCompletion(e){}}class zZ extends jZ{constructor(e,n){e.imageIds||(e.imageIds=n.imageIds),super(e,n),this.getImageIdsToLoad=()=>{const{imageIds:r}=this;return this.numFrames=r.length,r}}getScalarData(){return this.voxelManager.getScalarData()}getImageLoadRequests(e){const{imageIds:n}=this;return this.getImageIdsRequests(n,e)}}function WZ(t,e){if(!e||!e.imageIds||!e.imageIds.length)throw new Error("ImageIds must be provided to create a streaming image volume");async function n(){if(e.imageIds[0].split(":")[0]==="wadouri"){const[p,g]=[Math.floor(e.imageIds.length/2),e.imageIds.length-1],m=[0,p,g];await Promise.all(m.map(y=>yt.isLoaded(e.imageIds[y])?Promise.resolve(!0):new Promise((v,x)=>{const w=e.imageIds[y];is.addRequest(async()=>{LZ(w).then(()=>{console.log(`Prefetched imageId: ${w}`),v(!0)}).catch(S=>{x(S)})},_n.Prefetch,{volumeId:t},1)}))).catch(console.error)}const i=YC(e.imageIds,t),{dimensions:a,spacing:o,origin:s,direction:l,metadata:c,imageIds:f,dataType:u,numberOfComponents:d}=i;return new zZ({volumeId:t,metadata:c,dimensions:a,spacing:o,origin:s,direction:l,imageIds:f,dataType:u,numberOfComponents:d},{imageIds:f,loadStatus:{loaded:!1,loading:!1,cancelled:!1,cachedFrames:[],callbacks:[]}})}const r=n();return{promise:r,decache:()=>{r.then(i=>{i.destroy(),i=null})},cancel:()=>{r.then(i=>{i.cancelLoading()})}}}const q7={};let Xg=WZ;function HZ(t,e){const n=t.indexOf(":"),r=t.substring(0,n);let i=q7[r];if(i==null){if(Xg==null||typeof Xg!="function")throw new Error(`No volume loader for scheme ${r} has been registered`);i=Xg}const a=i(t,e);return a.promise.then(function(o){wt(vt,mt.VOLUME_LOADED,{volume:o})},function(o){const s={volumeId:t,error:o};wt(vt,mt.VOLUME_LOADED_FAILED,s)}),a}function X7(t,e={imageIds:[]}){if(t===void 0)throw new Error("loadVolume: parameter volumeId must not be undefined");let n=yt.getVolumeLoadObject(t);return n!==void 0?n.promise:(n=HZ(t,e),n.promise.then(r=>r))}async function Y7(t,e){if(t===void 0)throw new Error("createAndCacheVolume: parameter volumeId must not be undefined");let n=yt.getVolumeLoadObject(t);return n!==void 0||(n=HZ(t,e),yt.putVolumeLoadObject(t,n)),n.promise}function KZ(t,e){const n=yt.getVolume(t);if(!n)throw new Error(`Cannot created derived volume: Referenced volume with id ${t} does not exist.`);let{volumeId:r}=e;const{voxelRepresentation:i}=e;r===void 0&&(r=cr());const{metadata:a,dimensions:o,spacing:s,origin:l,direction:c}=n,f=n.isDynamicVolume()?n.getCurrentDimensionGroupImageIds():n.imageIds??[],u=z7(f,{targetBuffer:e.targetBuffer,voxelRepresentation:i}),d=u[0].dataType,h=u.map(g=>g.imageId),p=new Hm({volumeId:r,dataType:d,metadata:structuredClone(a),dimensions:[o[0],o[1],o[2]],spacing:s,origin:l,direction:c,referencedVolumeId:t,imageIds:h,referencedImageIds:n.imageIds??[]});return yt.putVolumeSync(r,p),p}async function qZ(t,e){if(e===void 0)throw new Error("createAndCacheVolumeFromImages: parameter imageIds must not be undefined");if(t===void 0)throw new Error("createAndCacheVolumeFromImages: parameter volumeId must not be undefined");const n=yt.getVolume(t);return n||(e.filter(a=>!yt.getImage(a)).length===0?ZC(t,e):await Y7(t,{imageIds:e}))}function ZC(t,e){if(e===void 0)throw new Error("createAndCacheVolumeFromImagesSync: parameter imageIds must not be undefined");if(t===void 0)throw new Error("createAndCacheVolumeFromImagesSync: parameter volumeId must not be undefined");const n=yt.getVolume(t);if(n)return n;const r=YC(e,t),i=new Hm({volumeId:t,dataType:r.dataType,metadata:structuredClone(r.metadata),dimensions:r.dimensions,spacing:r.spacing,origin:r.origin,direction:r.direction,referencedVolumeId:r.referencedVolumeId,imageIds:r.imageIds,referencedImageIds:r.referencedImageIds});return yt.putVolumeSync(t,i),i}function J7(t,e={}){const{metadata:n,dimensions:r,spacing:i,origin:a,direction:o,scalarData:s,targetBuffer:l,preventCache:c=!1}=e,f=yt.getVolume(t);if(f)return f;const u=r[0]*r[1],d=s?s.constructor.name:l?.type??"Float32Array",h=u*r[2];let p;switch(d){case"Uint8Array":case"Int8Array":p=h;break;case"Uint16Array":case"Int16Array":p=h*2;break;case"Float32Array":p=h*4;break}if(!yt.isCacheable(p))throw new Error(`Cannot created derived volume: Volume with id ${t} is not cacheable.`);const m=[];for(let x=0;x<r[2];x++){const w=`${t}_slice_${x}`;m.push(w);const S=s.subarray(x*u,(x+1)*u);W7(w,{scalarData:S,dimensions:[r[0],r[1]],spacing:[i[0],i[1]],origin:a,direction:o,targetBuffer:{type:d}})}const y=new Hm({volumeId:t,metadata:structuredClone(n),dimensions:[r[0],r[1],r[2]],spacing:i,origin:a,direction:o,imageIds:m,dataType:d}),v=a0.createImageVolumeVoxelManager({imageIds:m,dimensions:r,numberOfComponents:1,id:t});return y.voxelManager=v,c||yt.putVolumeSync(t,y),y}function zDe(t,e){q7[t]=e}function XZ(){return Object.keys(q7)}function WDe(t){const e=Xg;return Xg=t,e}function YZ(){return Xg.name}function HDe(t,e={}){return KZ(t,{...e,targetBuffer:{type:"Uint8Array",...e?.targetBuffer}})}function KDe(t,e,n=!1){return t.scalarData||(t.scalarData=new Uint8Array(t.dimensions[0]*t.dimensions[1]*t.dimensions[2])),J7(e,{...t,preventCache:n})}const qDe=Object.freeze(Object.defineProperty({__proto__:null,createAndCacheDerivedLabelmapVolume:HDe,createAndCacheDerivedVolume:KZ,createAndCacheVolume:Y7,createAndCacheVolumeFromImages:qZ,createAndCacheVolumeFromImagesSync:ZC,createLocalLabelmapVolume:KDe,createLocalVolume:J7,getUnknownVolumeLoaderSchema:YZ,getVolumeLoaderSchemes:XZ,loadVolume:X7,registerUnknownVolumeLoader:WDe,registerVolumeLoader:zDe},Symbol.toStringTag,{value:"Module"}));function JZ(t,e){const n=vDe.newInstance();Vf().rendering.preferSizeOverAccuracy&&n.setPreferSizeOverAccuracy(!0),n.setInputData(t);const r=t.getSpacing(),a=(Vf().rendering?.volumeRendering?.sampleDistanceMultiplier||1)*(r[0]+r[1]+r[2])/6;return n.setMaximumSamplesPerRay(4e3),n.setSampleDistance(a),n.setScalarTexture(e),n}function ZZ(t){const e=MZ.newInstance();e.setBlendMode(t.getBlendMode());const n=t.getInputData(),{voxelManager:r}=n.get("voxelManager"),i=r.getCompleteScalarDataArray(),a=tn.newInstance({name:"Pixels",values:i});return n.getPointData().setScalars(a),e.setInputData(n),e.setMaximumSamplesPerRay(t.getMaximumSamplesPerRay()),e.setSampleDistance(t.getSampleDistance()),e}const XDe=0,YDe=_n.Prefetch;async function Z7(t,e){let n=ZDe(e);!n&&e.imageIds.length&&(n=await QDe(e),n=JDe(e,n)),!(n.lower===0&&n.upper===0||n.lower===void 0||n.upper===void 0)&&t.getProperty().getRGBTransferFunction(0).setMappingRange(n.lower,n.upper)}function JDe(t,e){const n=t.imageIds,r=Math.floor(n.length/2),i=n[r],a=Ut("generalSeriesModule",i)||{};return e7e(a.modality,t)?{lower:0,upper:5}:e}function ZDe(t){const{imageIds:e,metadata:n}=t;let r;if(e?.length){const i=Math.floor(e.length/2),a=e[i],o=Ut("voiLutModule",a);if(o&&o.windowWidth&&o.windowCenter){o?.voiLUTFunction&&(r={},r.voiLUTFunction=o?.voiLUTFunction);const{windowWidth:s,windowCenter:l}=o,c=Array.isArray(s)?s[0]:s,f=Array.isArray(l)?l[0]:l;c!==0&&(r={windowWidth:c,windowCenter:f})}}else r=n.voiLut[0];if(r&&(r.windowWidth!==0||r.windowCenter!==0)){const{lower:i,upper:a}=zg(Number(r.windowWidth),Number(r.windowCenter),r.voiLUTFunction);return{lower:i,upper:a}}}async function QDe(t){const{imageIds:e}=t,n=Math.floor(e.length/2),r=t.imageIds[n],i=Ut("generalSeriesModule",r)||{},{modality:a}=i,o=Ut("modalityLutModule",r)||{},s={rescaleSlope:o.rescaleSlope,rescaleIntercept:o.rescaleIntercept,modality:a};let l;if(a==="PT"){const h=Ut("scalingModule",r);h&&(l={...s,suvbw:h.suvbw})}const c={priority:XDe,requestType:YDe,preScale:{scalingParameters:l}};let f=yt.getImage(r);t.referencedImageIds?.length||(f=await s0(r,{...c,ignoreCache:!0}));let{min:u,max:d}=f.voxelManager.getMinMax();return u?.length>1&&(u=Math.min(...u),d=Math.max(...d)),{lower:u,upper:d}}function e7e(t,e){return!(t!=="PT"||!e.isPreScaled||!e.scaling?.PT.suvbw)}async function y3(t,e,n,r=!1){const{volumeId:i,callback:a,blendMode:o}=t,s=await X7(i);if(!s)throw new Error(`imageVolume with id: ${s.volumeId} does not exist`);const{imageData:l,vtkOpenGLTexture:c}=s,f=JZ(l,c);o&&f.setBlendMode(o);const u=dCe.newInstance();u.setMapper(f);const{numberOfComponents:d}=l.get("numberOfComponents");return u.getProperty().set({viewportId:n},!0),d===3&&u.getProperty().setIndependentComponents(!1),await Z7(u,s),a&&a({volumeActor:u,volumeId:i}),r||t7e(e,n,u,i),u}function t7e(t,e,n,r){const i=n.getProperty().getRGBTransferFunction(0).getRange(),a={viewportId:e,range:{lower:i[0],upper:i[1]},volumeId:r};wt(t,mt.VOI_MODIFIED,a)}function QZ(t){const e=t.getMapper().getInputData(),n=e.extentToBounds(e.getExtent());return[[n[0],n[2],n[4]],[n[0],n[2],n[5]],[n[0],n[3],n[4]],[n[0],n[3],n[5]],[n[1],n[2],n[4]],[n[1],n[2],n[5]],[n[1],n[3],n[4]],[n[1],n[3],n[5]]]}const n7e=al*al,e8=t=>Math.abs(Math.abs(t)-1)<n7e,t8=(t,e)=>e8(t[e])||e8(t[e+1])||e8(t[e+2]),r7e=t=>t8(t,0)&&t8(t,3)&&t8(t,6);function QC(t,e,n){const r=t.getMapper().getInputData();let i;const a=r.getDirection();if(r7e(a))i=QZ(t);else{const[u,d,h]=r.getDimensions();i=[[0,0,0],[u-1,0,0],[0,d-1,0],[u-1,d-1,0],[0,0,h-1],[u-1,0,h-1],[0,d-1,h-1],[u-1,d-1,h-1]].map(g=>r.indexToWorld(g))}const o=$d.buildFromDegree().identity().rotateFromDirections(e,[1,0,0]);i.forEach(u=>o.apply(u));const s=[...n];o.apply(s);const l=s[0];let c=1/0,f=-1/0;for(let u=0;u<8;u++){const d=i[u][0];d>f&&(f=d),d<c&&(c=d)}return{min:c,max:f,current:l,actor:t,viewPlaneNormal:e,focalPoint:n}}function Jh(t,e){const{direction:n,spacing:r}=t,i=n.slice(0,3),a=n.slice(3,6),o=n.slice(6,9),s=[zt(i,e),zt(a,e),zt(o,e)],l=it();return t3(l,s[0]*r[0],s[1]*r[1],s[2]*r[2]),Vo(l)}const m0=t=>{const e="volumeId:",n=t.includes(e)?t.substring(e.length):t,r=n.indexOf("sliceIndex=");return r===-1?n:n.substring(0,r-1)},i7e=1+al,a7e=(t,e)=>e===t.substring(0,Math.min(t.length,e.length)),ZV=t=>!!XZ().find(e=>a7e(t.volumeId,e));function Vy(t,e,n,r=!1){const{viewPlaneNormal:i}=e,a=t.getActors();if(!a.length)return{spacingInNormalDirection:null,imageVolume:null,actorUID:null};const o=a.map(c=>{const f=c.referencedId??c.uid;return yt.getVolume(f)}).filter(c=>!!c);if(n){const c=m0(n),f=o.findIndex(p=>c.includes(p.volumeId)),u=o[f],{uid:d}=a[f],h=QV(u,i,t,r);return{imageVolume:u,spacingInNormalDirection:h,actorUID:d}}if(!o.length)return{spacingInNormalDirection:null,imageVolume:null,actorUID:null};const s={spacingInNormalDirection:1/0,imageVolume:null,actorUID:null},l=o.find(ZV);for(let c=0;c<o.length;c++){const f=o[c];if(l&&!ZV(f))continue;const u=QV(f,i,t);u*i7e<s.spacingInNormalDirection&&(s.spacingInNormalDirection=u,s.imageVolume=f,s.actorUID=a[c].uid)}return s}function QV(t,e,n,r=!1){const{slabThickness:i}=n.getProperties();let a=i;return(!i||!r)&&(a=Jh(t,e)),a}function x3(t){const e=t.getCamera(),{spacingInNormalDirection:n,imageVolume:r}=Vy(t,e);if(!r)return;const{viewPlaneNormal:i,focalPoint:a}=e,o=t.getActors().find(p=>p.referencedId===r.volumeId||p.uid===r.volumeId);o||console.warn("No actor found for with actorUID of",r.volumeId);const s=o.actor,l=QC(s,i,a),{min:c,max:f,current:u}=l,d=Math.round((f-c)/n)+1;let h=(u-c)/(f-c)*d;return h=Math.floor(h),h>d-1?h=d-1:h<0&&(h=0),{numberOfSlices:d,imageIndex:h}}const cg={};function o7e(t){cg[t]!==void 0&&delete cg[t]}function s7e(t){const{renderingEngineId:e,viewportId:n}=t.detail,i=zf(e).getViewport(n);if(!("setVolumes"in i))throw new Error("volumeNewImageEventDispatcher: viewport does not have setVolumes method");cg[i.id]===void 0&&(cg[i.id]=0);const a=x3(i);if(!a){console.warn(`volumeNewImageEventDispatcher: sliceData is undefined for viewport ${i.id}`);return}const{numberOfSlices:o,imageIndex:s}=a;if(cg[i.id]===s)return;cg[i.id]=s;const l={imageIndex:s,viewportId:n,renderingEngineId:e,numberOfSlices:o};wt(i.element,mt.VOLUME_NEW_IMAGE,l)}function b3(t,e,n){const[r,i,a]=t,[o,s,l]=e,[c,f,u,d]=n,h=o-r,p=s-i,g=l-a,m=-1*(c*r+f*i+u*a-d)/(c*h+f*p+u*g),y=h*m+r,v=p*m+i,x=g*m+a;return[y,v,x]}function Q7(t,e,n=!1){const[r,i,a]=t,o=r*e[0]+i*e[1]+a*e[2];if(n){const s=Math.sqrt(r*r+i*i+a*a);return[r/s,i/s,a/s,o/s]}return[r,i,a,o]}function l7e(t,e,n){const[r,i,a,o]=t,[s,l,c,f]=e,[u,d,h,p]=n,g=kx(r,s,u,i,l,d,a,c,h),m=kx(o,f,p,i,l,d,a,c,h),y=kx(r,s,u,o,f,p,a,c,h),v=kx(r,s,u,i,l,d,o,f,p),x=Lp(m)/Lp(g),w=Lp(y)/Lp(g),S=Lp(v)/Lp(g);return[x,w,S]}function eO(t,e,n=!1){const[r,i,a,o]=t,[s,l,c]=e,f=r*s+i*l+a*c-o,u=Math.abs(f)/Math.sqrt(r*r+i*i+a*a);return(n?Math.sign(f):1)*u}function c7e(t,e,n=al){return eO(e,t)<n}const u7e=Object.freeze(Object.defineProperty({__proto__:null,isPointOnPlane:c7e,linePlaneIntersection:b3,planeDistanceToPoint:eO,planeEquation:Q7,threePlaneIntersection:l7e},Symbol.toStringTag,{value:"Module"}));function G_(t){return Array.isArray(t)?t.some(e=>Number.isNaN(e)):Number.isNaN(t)}function mc(t){if(t===null||typeof t!="object"||typeof t=="function"||typeof structuredClone=="function")return t;if(Array.isArray(t))return t.map(mc);{const e={};for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=mc(t[n]));return e}}const f7e=.95;function eQ(t,e){if(!t?.length||!e.FrameOfReferenceUID)return;e.planeRestriction||={FrameOfReferenceUID:e.FrameOfReferenceUID,point:t[0],inPlaneVector1:null,inPlaneVector2:null};const{planeRestriction:n}=e;if(t.length===1)return n.inPlaneVector1=null,n.inPlaneVector2=null,n;const r=dr(it(),t[0],t[Math.floor(t.length/2)]);Lr(r,r),n.inPlaneVector1=r,n.inPlaneVector2=null;const i=t.length;if(i>2)for(let a=Math.floor(i/3);a<i;a++){const o=dr(it(),t[a],t[0]),s=Vo(o);if(!pr(s,0)&&zt(o,n.inPlaneVector1)<s*f7e)return Lr(o,o),n.inPlaneVector2=o,n}return n}const m2=class m2{constructor(e){this.insetImageMultiplier=1.1,this.flipHorizontal=!1,this.flipVertical=!1,this.viewportStatus=Io.NO_DATA,this._suppressCameraModifiedEvents=!1,this.hasPixelSpacing=!0,this.getProperties=()=>({}),this.setRotation=n=>{},this.viewportWidgets=new Map,this.addWidget=(n,r)=>{this.viewportWidgets.set(n,r)},this.getWidget=n=>this.viewportWidgets.get(n),this.getWidgets=()=>Array.from(this.viewportWidgets.values()),this.removeWidgets=()=>{this.getWidgets().forEach(r=>{if(r.getEnabled()&&r.setEnabled(!1),r.getActor&&r.getRenderer){const i=r.getActor(),a=r.getRenderer();a&&i&&a.removeActor(i)}})},this.id=e.id,this.renderingEngineId=e.renderingEngineId,this.type=e.type,this.element=e.element,this.canvas=e.canvas,this.sx=e.sx,this.sy=e.sy,this.sWidth=e.sWidth,this.sHeight=e.sHeight,this._actors=new Map,this.element.setAttribute("data-viewport-uid",this.id),this.element.setAttribute("data-rendering-engine-uid",this.renderingEngineId),this.defaultOptions=mc(e.defaultOptions),this.suppressEvents=e.defaultOptions.suppressEvents?e.defaultOptions.suppressEvents:!1,this.options=mc(e.defaultOptions),this.isDisabled=!1}static get useCustomRenderingPipeline(){return!1}setRendered(){this.viewportStatus===Io.NO_DATA||this.viewportStatus===Io.LOADING||(this.viewportStatus=Io.RENDERED)}setColorTransform(e,n){let r=null;if(!e&&!n)return;const i=n||[255,255,255],a=Math.max(...i),o=i.map(u=>a/u),{lower:s=0,upper:l=255}=e||{},c=(l-s+1)/255,f=s/255;return r=`url('data:image/svg+xml,      <svg xmlns="http://www.w3.org/2000/svg">        <filter id="colour" color-interpolation-filters="linearRGB">        <feColorMatrix type="matrix"         values="          ${o[0]*c} 0 0 0 ${f}           0 ${o[1]*c} 0 0 ${f}           0 0 ${o[2]*c} 0 ${f}           0 0 0 1 0" />        </filter>      </svg>#colour')`,r}getRenderingEngine(){return $2.get(this.renderingEngineId)}getRenderer(){const e=this.getRenderingEngine();if(!e||e.hasBeenDestroyed)throw new Error("Rendering engine has been destroyed");return e.offscreenMultiRenderWindow?.getRenderer(this.id)}render(){this.getRenderingEngine().renderViewport(this.id)}setOptions(e,n=!1){this.options=structuredClone(e),this.options?.displayArea&&this.setDisplayArea(this.options?.displayArea),n&&this.render()}reset(e=!1){this.options=structuredClone(this.defaultOptions),e&&this.render()}getSliceViewInfo(){throw new Error("Method not implemented.")}flip({flipHorizontal:e,flipVertical:n}){const r=this.getDefaultImageData();if(!r)return;const i=this.getCamera(),{viewPlaneNormal:a,viewUp:o,focalPoint:s,position:l}=i,c=gr(it(),a,o);let f=t7(it(),o);const u=cu(it(),a),d=ol(l,s),p=r.getDimensions().map(S=>Math.floor(S/2)),g=[p[0],p[1],p[2]],m=r.indexToWorld(g,it()),y=this._getFocalPointForResetCamera(m,i,{resetPan:!0,resetToCenter:!1}),v=Pr(it(),s,y),x=Vo(v),w=S=>{const T=tl(it(),S,2*zt(v,S));return Pr(T,T,v),Lr(T,T),T};if(e){const S=w(f),T=Ar(it(),y,S,x),_=Ar(it(),T,u,d);this.setCamera({viewPlaneNormal:u,position:_,focalPoint:T}),this.flipHorizontal=!this.flipHorizontal}if(n){f=cu(f,o);const S=w(c),T=Ar(it(),y,S,x),_=Ar(it(),T,u,d);this.setCamera({focalPoint:T,viewPlaneNormal:u,viewUp:f,position:_}),this.flipVertical=!this.flipVertical}this.render()}getDefaultImageData(){const e=this.getDefaultActor();if(e&&gc(e))return e.actor.getMapper().getInputData()}getDefaultActor(){return this.getActors()[0]}getActors(){return Array.from(this._actors.values())}getActorUIDs(){return Array.from(this._actors.keys())}getActor(e){return this._actors.get(e)}getImageActor(e){const n=this.getActors();let r=n[0];return e&&(r=n.find(a=>a.referencedId===e)),!r||!gc(r)?null:r.actor}getActorUIDByIndex(e){const n=this.getActors()[e];if(n)return n.uid}getActorByIndex(e){return this.getActors()[e]}setActors(e){const n=this.getActors();this.removeAllActors(),this.addActors(e,{resetCamera:!0}),wt(this.element,mt.ACTORS_CHANGED,{viewportId:this.id,removedActors:n,addedActors:e,currentActors:e})}_removeActor(e){const n=this.getActor(e);if(!n){console.warn(`Actor ${e} does not exist in ${this.id}, can't remove`);return}return this.getRenderer().removeActor(n.actor),this._actors.delete(e),n}removeActors(e){const n=[];e.forEach(i=>{const a=this._removeActor(i);a&&n.push(a)});const r=this.getActors();wt(this.element,mt.ACTORS_CHANGED,{viewportId:this.id,removedActors:n,addedActors:[],currentActors:r})}addActors(e,n={}){const{resetCamera:r=!1}=n,i=this.getRenderingEngine();if(!i||i.hasBeenDestroyed){console.warn("Viewport::addActors::Rendering engine has not been initialized or has been destroyed");return}e.forEach(s=>{this.addActor(s)});const a=this.getViewPresentation(),o=this.getViewReference();this.resetCamera(),r||(this.setViewReference(o),this.setViewPresentation(a)),wt(this.element,mt.ACTORS_CHANGED,{viewportId:this.id,removedActors:[],addedActors:e,currentActors:this.getActors()})}addActor(e){const{uid:n,actor:r}=e,i=this.getRenderingEngine();if(!i||i.hasBeenDestroyed){console.warn(`Cannot add actor UID of ${n} Rendering Engine has been destroyed`);return}if(!n||!r)throw new Error("Actors should have uid and vtk Actor properties");if(this.getActor(n)){console.warn(`Actor ${n} already exists for this viewport`);return}this.getRenderer()?.addActor(r),this._actors.set(n,Object.assign({},e)),this.updateCameraClippingPlanesAndRange(),wt(this.element,mt.ACTORS_CHANGED,{viewportId:this.id,removedActors:[],addedActors:[e],currentActors:this.getActors()})}removeAllActors(){const e=this.getActors();this.getRenderer()?.removeAllViewProps(),this._actors=new Map,wt(this.element,mt.ACTORS_CHANGED,{viewportId:this.id,removedActors:e,addedActors:[],currentActors:[]})}resetCameraNoEvent(){const e=this._suppressCameraModifiedEvents;this._suppressCameraModifiedEvents=!0,this.resetCamera(),this._suppressCameraModifiedEvents=e}setCameraNoEvent(e){const n=this._suppressCameraModifiedEvents;this._suppressCameraModifiedEvents=!0,this.setCamera(e),this._suppressCameraModifiedEvents=n}_getViewImageDataIntersections(e,n,r){const i=r[0],a=r[1],o=r[2],s=i*n[0]+a*n[1]+o*n[2],l=e.getBounds(),c=this._getEdges(l),f=[];for(const u of c){const[[d,h,p],[g,m,y]]=u;if(i*(g-d)+a*(m-h)+o*(y-p)===0)continue;const v=b3([d,h,p],[g,m,y],[i,a,o,s]);this._isInBounds(v,l)&&f.push(v)}return f}setInterpolationType(e,n){}setDisplayArea(e,n=!1){if(!e)return;const{storeAsInitialCamera:r,type:i}=e;r&&(this.options.displayArea=e);const{_suppressCameraModifiedEvents:a}=this;if(this._suppressCameraModifiedEvents=!0,this.setCamera(this.fitToCanvasCamera),i==="SCALE"?this.setDisplayAreaScale(e):(this.setInterpolationType(this.getProperties()?.interpolationType??Sf.LINEAR),this.setDisplayAreaFit(e)),r&&(this.initialCamera=this.getCamera()),this._suppressCameraModifiedEvents=a,!n&&!a){const o={viewportId:this.id,displayArea:e,storeAsInitialCamera:r};wt(this.element,mt.DISPLAY_AREA_MODIFIED,o),this.setCamera(this.getCamera())}}setDisplayAreaScale(e){const{scale:n=1}=e,r=this.canvas,i=r.height,a=r.width;if(i<8||a<8)return;const l=this.getDefaultImageData().getSpacing()[1];this.setInterpolationType(Sf.NEAREST),this.setCamera({parallelScale:i*l/(2*n)}),delete e.imageArea,this.setDisplayAreaFit(e);const{focalPoint:c,position:f,viewUp:u,viewPlaneNormal:d}=this.getCamera(),h=it();if(r.height%2&&Ar(h,h,u,n*.5*l),r.width%2){const p=gr(it(),u,d);Ar(h,h,p,n*.5*l)}!h[0]&&!h[1]&&!h[2]||this.setCamera({focalPoint:Ul(it(),c,h),position:Ul(it(),f,h)})}setDisplayAreaFit(e){const{imageArea:n,imageCanvasPoint:r}=e,i=window?.devicePixelRatio||1,a=this.getDefaultImageData();if(!a)return;const o=this.sWidth/i,s=this.sHeight/i,l=a.getDimensions(),c=this.worldToCanvas(a.indexToWorld([0,0,0])),f=this.worldToCanvas(a.indexToWorld([l[0],l[1],l[2]])),u=[Math.abs(f[0]-c[0]),Math.abs(f[1]-c[1])],[d,h]=u;let p=this.getZoom()/this.insetImageMultiplier;if(n){const[g,m]=n,y=Math.max(Math.abs(d/o),Math.abs(h/s)),v=Math.abs(g*d/o),x=Math.abs(m*h/s),w=this.getZoom(),S=this.getZoom(this.fitToCanvasCamera);p=(v>x?y/v:y/x)*w/S,this.setZoom(this.insetImageMultiplier*p,!1)}if(r){const{imagePoint:g,canvasPoint:m=g||[.5,.5]}=r,[y,v]=m,x=o*(y-.5),w=s*(v-.5),[S,T]=g||m,_=p,D=this.insetImageMultiplier*_*d*(.5-S),I=this.insetImageMultiplier*_*h*(.5-T),R=D+x,O=I+w,P=[R,O];FC(P,P,this.getPan()),this.setPan(P,!1)}}getDisplayArea(){return this.options?.displayArea}resetCamera(e){const{resetPan:n=!0,resetZoom:r=!0,resetToCenter:i=!0,storeAsInitialCamera:a=!0}=e||{},o=this.getRenderer();this.setCameraNoEvent({flipHorizontal:!1,flipVertical:!1});const s=this.getCamera();let l;const c=this.getDefaultActor();c&&gc(c)?l=c.actor.getMapper().getInputData().getBounds():l=o.computeVisiblePropBounds();const f=[0,0,0],u=this.getDefaultImageData();if(u){const A=u.getSpacing();l[0]=l[0]+A[0]/2,l[1]=l[1]-A[0]/2,l[2]=l[2]+A[1]/2,l[3]=l[3]-A[1]/2,l[4]=l[4]+A[2]/2,l[5]=l[5]-A[2]/2}const d=this.getVtkActiveCamera(),h=d.getViewPlaneNormal(),p=d.getViewUp();if(f[0]=(l[0]+l[1])/2,f[1]=(l[2]+l[3])/2,f[2]=(l[4]+l[5])/2,u){const B=u.getDimensions().map($=>Math.floor($/2)),V=[B[0],B[1],B[2]];u.indexToWorld(V,f)}const{widthWorld:g,heightWorld:m}=this._getWorldDistanceViewUpAndViewRight(l,p,h),y=[this.sWidth,this.sHeight],v=g/m,x=y[0]/y[1],w=v/x,S=w<1?this.insetImageMultiplier*m/2:this.insetImageMultiplier*m*w/2,T=m2.boundsRadius(l)*(this.type===Tr.VOLUME_3D?10:1),_=this.insetImageMultiplier*T,D=Math.abs(Zs.dot(p,h))>.999?[-p[2],p[0],p[1]]:p,I=this._getFocalPointForResetCamera(f,s,{resetPan:n,resetToCenter:i}),R=[I[0]+_*h[0],I[1]+_*h[1],I[2]+_*h[2]];o.resetCameraClippingRange(l);const O=[-Oi.MAXIMUM_RAY_DISTANCE,Oi.MAXIMUM_RAY_DISTANCE];d.setPhysicalScale(T),d.setPhysicalTranslation(-I[0],-I[1],-I[2]),this.setCamera({parallelScale:r?S:s.parallelScale,focalPoint:I,position:R,viewAngle:90,viewUp:D,clippingRange:O});const P=this.getCamera();this.setFitToCanvasCamera(this.getCamera()),a&&this.setInitialCamera(P),r&&this.setZoom(1,a);const N={type:"ResetCameraEvent",renderer:o};return o.invokeEvent(N),this.triggerCameraModifiedEventIfNecessary(s,P),u&&this.options.displayArea&&r&&n&&i&&this.setDisplayArea(this.options.displayArea),!0}setInitialCamera(e){this.initialCamera=e}setFitToCanvasCamera(e){this.fitToCanvasCamera=e}getPan(e=this.initialCamera){if(!e)return[0,0];const r=this.getVtkActiveCamera().getFocalPoint(),i=this.canvasToWorld([0,0]),a=this.worldToCanvas(Pr([0,0,0],e.focalPoint,i)),o=this.worldToCanvas(Pr([0,0,0],r,i));return ka([0,0],a,o)}getCurrentImageIdIndex(){throw new Error("Not implemented")}getSliceIndex(){throw new Error("Not implemented")}getImageData(){throw new Error("Not implemented")}getViewReferenceId(e){return null}setPan(e,n=!1){const r=this.getCamera(),{focalPoint:i,position:a}=r,o=this.canvasToWorld([0,0]),s=ka([0,0],e,this.getPan());if(Math.abs(s[0])<1&&Math.abs(s[1])<1&&!n)return;const l=Pr(it(),this.canvasToWorld(s),o),c=Pr(it(),i,l),f=Pr(it(),a,l);this.setCamera({...r,focalPoint:c,position:f},n)}getZoom(e=this.initialCamera){if(!e)return 1;const n=this.getVtkActiveCamera(),{parallelScale:r}=e;return r/n.getParallelScale()}setZoom(e,n=!1){const r=this.getCamera(),{parallelScale:i}=this.initialCamera,a=i/e;r.parallelScale===a&&!n||this.setCamera({...r,parallelScale:a},n)}_getFocalPointForViewPlaneReset(e){const{focalPoint:n,viewPlaneNormal:r}=this.getCamera(),i=this._getViewImageDataIntersections(e,n,r);let a=0,o=0,s=0;return i.forEach(([c,f,u])=>{a+=c,o+=f,s+=u}),[a/i.length,o/i.length,s/i.length]}getCanvas(){return this.canvas}getVtkActiveCamera(){const e=this.getRenderer();return e?e.getActiveCamera():(console.warn("No renderer found for the viewport"),null)}getCameraNoRotation(){const e=this.getVtkActiveCamera(),n=(s,l)=>s.some(c=>isNaN(c))?l:s,r=n([...e.getViewUp()],[0,1,0]),i=n([...e.getViewPlaneNormal()],[0,0,-1]),a=n([...e.getPosition()],[0,0,1]),o=n([...e.getFocalPoint()],[0,0,0]);return{viewUp:r,viewPlaneNormal:i,position:a,focalPoint:o,parallelProjection:e.getParallelProjection(),parallelScale:e.getParallelScale(),viewAngle:e.getViewAngle(),flipHorizontal:this.flipHorizontal,flipVertical:this.flipVertical}}getCamera(){return{...this.getCameraNoRotation(),rotation:this.getRotation()}}setCamera(e,n=!1){const r=this.getVtkActiveCamera(),i=this.getCamera(),a=Object.assign({},i,e),{viewUp:o,viewPlaneNormal:s,position:l,focalPoint:c,parallelScale:f,viewAngle:u,flipHorizontal:d,flipVertical:h,clippingRange:p}=e;if(d!==void 0){const y=d&&!this.flipHorizontal||!d&&this.flipHorizontal;y&&this.flip({flipHorizontal:y})}if(h!==void 0){const y=h&&!this.flipVertical||!h&&this.flipVertical;y&&this.flip({flipVertical:y})}o!==void 0&&r.setViewUp(o),s!==void 0&&r.setDirectionOfProjection(-s[0],-s[1],-s[2]),l!==void 0&&r.setPosition(...l),c!==void 0&&r.setFocalPoint(...c),f!==void 0&&r.setParallelScale(f),u!==void 0&&r.setViewAngle(u),p!==void 0&&r.setClippingRange(p);const g=i.focalPoint,m=i.viewUp;if(g&&c||m&&o){const y=r.getViewPlaneNormal(),v=r.getViewUp();let x=!1,w=!1;if(c){const S=[c[0]-g[0],c[1]-g[1],c[2]-g[2]];x=Math.abs(Zs.dot(S,y))>0}if(o&&(w=!pr(v,m)),x||w){const S=this.getDefaultActor();if(!S?.actor)return;ns(S,"vtkActor")||this.updateClippingPlanesForActors(a),(ns(S,"vtkImageSlice")||this.type===Tr.VOLUME_3D)&&this.getRenderer().resetCameraClippingRange()}}n&&this.setInitialCamera(a),this.triggerCameraModifiedEventIfNecessary(i,this.getCamera())}triggerCameraModifiedEventIfNecessary(e,n){if(!this._suppressCameraModifiedEvents&&!this.suppressEvents){const r={previousCamera:e,camera:n,element:this.element,viewportId:this.id,renderingEngineId:this.renderingEngineId};wt(this.element,mt.CAMERA_MODIFIED,r)}}updateCameraClippingPlanesAndRange(){const e=this.getCamera();this.updateClippingPlanesForActors(e),this.getRenderer().resetCameraClippingRange()}async updateClippingPlanesForActors(e){this.getActors().map(r=>{if(!r.actor)return;const i=r.actor.getMapper();let a=r?.clippingFilter?r?.clippingFilter.getClippingPlanes():i.getClippingPlanes();a.length===0&&r?.clippingFilter&&(a=[Ao.newInstance(),Ao.newInstance()]);let o=Oi.MINIMUM_SLAB_THICKNESS;r.slabThickness&&(o=r.slabThickness);const{viewPlaneNormal:s,focalPoint:l}=e;this.setOrientationOfClippingPlanes(a,o,s,l),wt(this.element,mt.CLIPPING_PLANES_UPDATED,{actorEntry:r,focalPoint:l,vtkPlanes:a,viewport:this})})}setOrientationOfClippingPlanes(e,n,r,i){if(e.length<2)return;const a=[r[0],r[1],r[2]];Zs.multiplyScalar(a,n),e[0].setNormal(r);const o=[0,0,0];Zs.subtract(i,a,o),e[0].setOrigin(o),e[1].setNormal(-r[0],-r[1],-r[2]);const s=[0,0,0];Zs.add(i,a,s),e[1].setOrigin(s)}getClippingPlanesForActor(e){if(e||(e=this.getDefaultActor()),!e.actor)throw new Error("Invalid actor entry: Actor is undefined");const n=e.actor.getMapper();let r=e?.clippingFilter?e?.clippingFilter.getClippingPlanes():n.getClippingPlanes();return r.length===0&&e?.clippingFilter&&(r=[Ao.newInstance(),Ao.newInstance()]),r}_getWorldDistanceViewUpAndViewRight(e,n,r){const i=this._getCorners(e),a=this._getCorners(e),o=gr(it(),n,r);let s=$d.buildFromDegree().identity().rotateFromDirections(n,[1,0,0]);i.forEach(d=>s.apply(d));let l=1/0,c=-1/0;for(let d=0;d<8;d++){const h=i[d][0];h>c&&(c=h),h<l&&(l=h)}s=$d.buildFromDegree().identity().rotateFromDirections([o[0],o[1],o[2]],[1,0,0]),a.forEach(d=>s.apply(d));let f=1/0,u=-1/0;for(let d=0;d<8;d++){const h=a[d][0];h>u&&(u=h),h<f&&(f=h)}return{widthWorld:u-f,heightWorld:c-l}}getViewReference(e){const{focalPoint:n,viewPlaneNormal:r,viewUp:i}=this.getCamera(),a=this.getFrameOfReferenceUID(),o={FrameOfReferenceUID:a,cameraFocalPoint:n,viewPlaneNormal:r,viewUp:i,sliceIndex:e?.sliceIndex??this.getSliceIndex(),planeRestriction:{FrameOfReferenceUID:a,point:e?.points?.[0]||n,inPlaneVector1:i,inPlaneVector2:gr(it(),i,r)}};return e?.points&&eQ(e.points,o.planeRestriction),o}isPlaneViewable(e,n){if(e.FrameOfReferenceUID!==this.getFrameOfReferenceUID())return!1;const{focalPoint:r,viewPlaneNormal:i}=this.getCamera(),{point:a,inPlaneVector1:o,inPlaneVector2:s}=e;if(n?.withOrientation)return!0;if(o&&!pr(0,zt(i,o))||s&&!pr(0,zt(i,s)))return!1;if(n?.withNavigation)return!0;const l=dr(it(),a,r);return pr(0,zt(l,i))}isReferenceViewable(e,n){if(e.planeRestriction)return this.isPlaneViewable(e.planeRestriction,n);if(e.FrameOfReferenceUID&&e.FrameOfReferenceUID!==this.getFrameOfReferenceUID())return!1;const{viewPlaneNormal:r}=e,i=this.getCamera();return r&&!pr(r,i.viewPlaneNormal)&&!pr(cu(i.viewPlaneNormal,i.viewPlaneNormal),r)?n?.withOrientation:!0}getViewPresentation(e={rotation:!0,displayArea:!0,zoom:!0,pan:!0,flipHorizontal:!0,flipVertical:!0}){const n={},{rotation:r,displayArea:i,zoom:a,pan:o,flipHorizontal:s,flipVertical:l}=e;r&&(n.rotation=this.getRotation()),i&&(n.displayArea=this.getDisplayArea());const c=this.getZoom();return a&&(n.zoom=c),o&&(n.pan=this.getPan(),__(n.pan,n.pan,1/c)),s&&(n.flipHorizontal=this.flipHorizontal),l&&(n.flipVertical=this.flipVertical),n}setViewReference(e){}setViewPresentation(e){if(!e)return;const{displayArea:n,zoom:r=this.getZoom(),pan:i,rotation:a,flipHorizontal:o=this.flipHorizontal,flipVertical:s=this.flipVertical}=e;n!==this.getDisplayArea()&&this.setDisplayArea(n),this.setZoom(r),i&&this.setPan(__([0,0],i,r)),o!==void 0&&o!==this.flipHorizontal&&this.flip({flipHorizontal:o}),s!==void 0&&s!==this.flipVertical&&this.flip({flipVertical:s}),a>=0&&this.setRotation(a)}_getCorners(e){return[[e[0],e[2],e[4]],[e[0],e[2],e[5]],[e[0],e[3],e[4]],[e[0],e[3],e[5]],[e[1],e[2],e[4]],[e[1],e[2],e[5]],[e[1],e[3],e[4]],[e[1],e[3],e[5]]]}_getFocalPointForResetCamera(e,n,{resetPan:r=!0,resetToCenter:i=!0}){if(i&&r)return e;if(i&&!r)return G_(n.focalPoint)?e:n.focalPoint;if(!i&&r){const a=n,o=a.focalPoint,s=a.viewPlaneNormal,l=Pr(it(),e,o),c=zt(l,s),f=Ar(it(),e,s,-1*c);return[f[0],f[1],f[2]]}if(!r&&!i)return G_(n.focalPoint)?e:n.focalPoint}_isInBounds(e,n){const[r,i,a,o,s,l]=n,[c,f,u]=e;return!(c<r||c>i||f<a||f>o||u<s||u>l)}_getEdges(e){const[n,r,i,a,o,s,l,c]=this._getCorners(e);return[[n,r],[n,o],[n,i],[r,a],[r,s],[i,a],[i,l],[a,c],[o,l],[o,s],[s,c],[l,c]]}static boundsRadius(e){const n=(e[1]-e[0])**2,r=(e[3]-e[2])**2,i=(e[5]-e[4])**2;return Math.sqrt(n+r+i||1)*.5}setDataIds(e,n){throw new Error("Unsupported operatoin setDataIds")}};m2.CameraViewPresentation={rotation:!0,pan:!0,zoom:!0,displayArea:!0},m2.TransferViewPresentation={windowLevel:!0,paletteLut:!0};let Bh=m2;function tQ(t,e,n=!1){const r=t.getCamera(),{focalPoint:i,viewPlaneNormal:a}=r,{spacingInNormalDirection:o,actorUID:s}=Vy(t,r,e,n);if(!s)throw new Error(`Could not find image volume with id ${e} in the viewport`);const l=t.getActor(s);if(!l)return console.warn("No actor found for with actorUID of",s),null;const c=l.actor;return{sliceRange:QC(c,a,i),spacingInNormalDirection:o,camera:r}}function Yg(t,e,n=!1){const{sliceRange:r,spacingInNormalDirection:i,camera:a}=tQ(t,e,n),{min:o,max:s,current:l}=r,c=Math.round((s-o)/i),u=(l-o)/(s-o)*c,d=Math.round(u);return{numScrollSteps:c,currentStepIndex:d,sliceRangeInfo:{sliceRange:r,spacingInNormalDirection:i,camera:a}}}function Jg(t,e,n,r,i,a){const{min:o,max:s,current:l}=n,c=it();dr(c,e,t);const f=Math.round((s-o)/i),d=(l-o)/(s-o)*f;let h=Math.round(d),p=[t[0]-r[0]*d*i,t[1]-r[1]*d*i,t[2]-r[2]*d*i];h+=a,h>f?h=f:h<0&&(h=0);const g=h*i;p=[p[0]+r[0]*g,p[1]+r[1]*g,p[2]+r[2]*g];const m=[p[0]+c[0],p[1]+c[1],p[2]+c[2]];return{newFocalPoint:p,newPosition:m}}function nQ(t){let e=[];const[n,r]=t.getRange();t.getTable(n,r,1024,e),e=e.filter((h,p)=>p%3===0);const i=[...Array(1024).keys()].map((h,p)=>n+(r-n)/1023*p),a=e[256],o=Math.log((1-a)/a),s=i[256],l=e[256*3],c=Math.log((1-l)/l),f=i[256*3],u=Math.round(4*(f-s)/(o-c)),d=Math.round(s+u*o/4);return[Math.round(d-u/2),Math.round(d+u/2)]}function rQ(t,e){const n=e.colorTransfer.split(" ").splice(1).map(parseFloat),{shiftRange:r}=d7e(n),i=r[0],a=r[1]-r[0],o=Uf.newInstance(),s=[];for(let w=0;w<n.length;w+=4){let S=n[w];const T=n[w+1],_=n[w+2],D=n[w+3];S=(S-i)/a,s.push([S,T,_,D])}h7e(s,r,o),t.getProperty().setRGBTransferFunction(0,o);const l=e.scalarOpacity.split(" ").splice(1).map(parseFloat),c=kh.newInstance(),f=[];for(let w=0;w<l.length;w+=2){let S=l[w];const T=l[w+1];S=(S-i)/a,f.push([S,T])}p7e(f,r,c);const u=t.getProperty();u.setScalarOpacity(0,c);const[d,h,p,g]=e.gradientOpacity.split(" ").splice(1).map(parseFloat);u.setUseGradientOpacity(0,!0),u.setGradientOpacityMinimumValue(0,d),u.setGradientOpacityMinimumOpacity(0,h),u.setGradientOpacityMaximumValue(0,p),u.setGradientOpacityMaximumOpacity(0,g),e.interpolation==="1"&&u.setInterpolationTypeToFastLinear(),u.setShade(e.shade==="1");const m=parseFloat(e.ambient),y=parseFloat(e.diffuse),v=parseFloat(e.specular),x=parseFloat(e.specularPower);u.setAmbient(m),u.setDiffuse(y),u.setSpecular(v),u.setSpecularPower(x)}function d7e(t){let e=1/0,n=-1/0;for(let i=0;i<t.length;i+=4)e=Math.min(e,t[i]),n=Math.max(n,t[i]);const r=(n-e)/2;return{shiftRange:[-r,r],min:e,max:n}}function h7e(t,e,n){const r=e[1]-e[0],i=t.map(([a,o,s,l])=>[a*r+e[0],o,s,l]);return n.removeAllPoints(),i.forEach(([a,o,s,l])=>n.addRGBPoint(a,o,s,l)),i}function p7e(t,e,n){const r=e[1]-e[0],i=t.map(([a,o])=>[a*r+e[0],o]);return n.removeAllPoints(),i.forEach(([a,o])=>n.addPoint(a,o)),i}const{MPR_CAMERA_VALUES:qs}=Xh,{OrientationAxis:mf}=ll;function iQ(t,e,n,r){let i;switch(r){case mf.AXIAL:case mf.AXIAL_REFORMAT:i=qs.axial;break;case mf.SAGITTAL:case mf.SAGITTAL_REFORMAT:i=qs.sagittal;break;case mf.CORONAL:case mf.CORONAL_REFORMAT:i=qs.coronal;break;default:i=qs.axial;break}const a=Lr(it(),t),o=Lr(it(),e),s=Lr(it(),n),l=[a,o,s],c=[Sn(i.viewRight[0],i.viewRight[1],i.viewRight[2]),Sn(i.viewUp[0],i.viewUp[1],i.viewUp[2]),Sn(i.viewPlaneNormal[0],i.viewPlaneNormal[1],i.viewPlaneNormal[2])],f=new Set,u=g=>{let m=0,y=-2,v=!1;l.forEach((w,S)=>{if(f.has(S))return;const T=zt(g,w),_=Math.abs(T);_>y&&(y=_,m=S,v=T<0)}),f.add(m);const x=hX(l[m]);return v&&cu(x,x),x},d=u(c[0]),h=u(c[1]),p=u(c[2]);return{viewPlaneNormal:[p[0],p[1],p[2]],viewUp:[h[0],h[1],h[2]],viewRight:[d[0],d[1],d[2]]}}function aQ(t,e){if(!t.getActors()?.length)return;t.type!==Tr.ORTHOGRAPHIC&&console.warn("Viewport should be a volume viewport");let n=t.getCurrentImageId();if(n||(n=t.getImageIds()?.[0]),!n)return;const{imageOrientationPatient:r}=Ut("imagePlaneModule",n),i=Sn(r[0],r[1],r[2]),a=Sn(r[3],r[4],r[5]),o=gr(it(),i,a);let{orientation:s}=e||{};const{useViewportNormal:l}=e||{};let c=o;return l&&(c=t.getCamera().viewPlaneNormal),s||(s=g7e(c)),iQ(i,a,o,s)}function g7e(t){const e=Lr(it(),t),n=Sn(qs.axial.viewPlaneNormal[0],qs.axial.viewPlaneNormal[1],qs.axial.viewPlaneNormal[2]),r=Sn(qs.sagittal.viewPlaneNormal[0],qs.sagittal.viewPlaneNormal[1],qs.sagittal.viewPlaneNormal[2]),i=Sn(qs.coronal.viewPlaneNormal[0],qs.coronal.viewPlaneNormal[1],qs.coronal.viewPlaneNormal[2]),a=Math.abs(zt(e,n)),o=Math.abs(zt(e,r)),s=Math.abs(zt(e,i));return a>=o&&a>=s?mf.AXIAL:o>=s?mf.SAGITTAL:mf.CORONAL}function oQ(){return Vf()?.rendering?.renderingEngineMode===Ah.ContextPool}class mo extends Bh{constructor(e){if(super(e),this.useCPURendering=!1,this.perVolumeIdDefaultProperties=new Map,this.viewportProperties={},this.volumeIds=new Set,this.setRotation=i=>{const a=this.getPan(this.fitToCanvasCamera),o=this.getPan(),s=this.getCamera(),l=Vh([0,0],a,o);this.setPan(l,!1);const{flipVertical:c}=this.getCamera(),f=c?cu([0,0,0],this.initialViewUp):this.initialViewUp;this.setCameraNoEvent({viewUp:f}),this.rotateCamera(i);const u=this.getPan(),d=this.getPan(this.fitToCanvasCamera),h=Vh([0,0],u,d),p=FC([0,0],a,h);if(this.setPan(p,!1),this._suppressCameraModifiedEvents)return;const g=this.getCamera(),m={previousCamera:s,camera:g,element:this.element,viewportId:this.id,renderingEngineId:this.renderingEngineId};wt(this.element,mt.CAMERA_MODIFIED,m)},this.getDefaultProperties=i=>{let a;return i!==void 0&&(a=this.perVolumeIdDefaultProperties.get(i)),a!==void 0?a:{...this.globalDefaultProperties}},this.getProperties=i=>{if(!this._getApplicableVolumeActor(i))return;const{colormap:o,VOILUTFunction:s,interpolationType:l,invert:c,slabThickness:f,preset:u}=this.viewportProperties;if(i||=this.getVolumeId(),!yt.getVolume(i))return null;const h=this.getActors().find(S=>S.referencedId===i);if(!h)return;const g=h.actor.getProperty().getRGBTransferFunction(0),[m,y]=this.viewportProperties?.VOILUTFunction==="SIGMOID"?nQ(g):g.getRange(),v={lower:m,upper:y},x=this.getColormap(i);return{colormap:i&&x?x:o,voiRange:v,VOILUTFunction:s,interpolationType:l,invert:c,slabThickness:f,preset:u}},this.getColormap=i=>{const a=this._getApplicableVolumeActor(i);if(!a)return;const{volumeActor:o}=a,s=this._getOrCreateColorTransferFunction(i),{nodes:l}=s.getState(),c=l.reduce((h,p)=>(h.push(p.x,p.r,p.g,p.b),h),[]),f=i7(c,o)||{},u=o7(o),d=s7(o);return f.threshold=u,f.opacity=d,f},this.getRotation=()=>{const{viewUp:i,viewPlaneNormal:a,flipVertical:o}=this.getCameraNoRotation(),s=o?cu([0,0,0],this.initialViewUp):this.initialViewUp;if(!s)return 0;const l=gX(s,i)*180/Math.PI,c=gr([0,0,0],s,i);return zt(c,a)>=0?l:(360-l)%360},this.getFrameOfReferenceUID=()=>this._FrameOfReferenceUID,this.canvasToWorldTiled=i=>{const a=this.getVtkActiveCamera();a.setIsPerformingCoordinateTransformation?.(!0);const o=this.getRenderer(),s=this.getVtkDisplayCoordsTiled(i),f=this.getRenderingEngine().offscreenMultiRenderWindow.getOpenGLRenderWindow().displayToWorld(s[0],s[1],s[2],o);return a.setIsPerformingCoordinateTransformation?.(!1),[f[0],f[1],f[2]]},this.canvasToWorldContextPool=i=>{const a=this.getVtkActiveCamera();a.setIsPerformingCoordinateTransformation?.(!0);const o=this.getRenderer(),s=window.devicePixelRatio||1,{width:l,height:c}=this.canvas,f=l/c,u=[i[0]*s,i[1]*s],d=[u[0]/l,1-u[1]/c,0],h=o.normalizedDisplayToProjection(d[0],d[1],d[2]),p=o.projectionToView(h[0],h[1],h[2],f),g=o.viewToWorld(p[0],p[1],p[2]);return a.setIsPerformingCoordinateTransformation?.(!1),[g[0],g[1],g[2]]},this.getVtkDisplayCoordsTiled=i=>{const a=window.devicePixelRatio||1,o=[i[0]*a,i[1]*a],c=this.getRenderingEngine().offscreenMultiRenderWindow.getOpenGLRenderWindow().getSize(),f=[o[0]+this.sx,o[1]+this.sy];return f[1]=c[1]-f[1],[f[0],f[1],0]},this.getVtkDisplayCoordsContextPool=i=>{const a=window.devicePixelRatio||1,o=[i[0]*a,i[1]*a],{height:s}=this.canvas,l=[o[0],s-o[1]];return[l[0],l[1],0]},this.worldToCanvasTiled=i=>{const a=this.getVtkActiveCamera();a.setIsPerformingCoordinateTransformation?.(!0);const o=this.getRenderer(),l=this.getRenderingEngine().offscreenMultiRenderWindow.getOpenGLRenderWindow(),c=l.getSize(),f=l.worldToDisplay(...i,o);f[1]=c[1]-f[1];const u=[f[0]-this.sx,f[1]-this.sy],d=window.devicePixelRatio||1,h=[u[0]/d,u[1]/d];return a.setIsPerformingCoordinateTransformation(!1),h},this.worldToCanvasContextPool=i=>{const a=this.getVtkActiveCamera();a.setIsPerformingCoordinateTransformation?.(!0);const o=this.getRenderer(),{width:s,height:l}=this.canvas,c=s/l,f=o.worldToView(i[0],i[1],i[2]),u=o.viewToProjection(f[0],f[1],f[2],c),d=o.projectionToNormalizedDisplay(u[0],u[1],u[2]),h=d[0]*s,p=(1-d[1])*l,g=window.devicePixelRatio||1,m=[h/g,p/g];return a.setIsPerformingCoordinateTransformation(!1),m},this.hasImageURI=i=>this.getActors().filter(o=>ns(o,"vtkVolume")).some(({uid:o,referencedId:s})=>{const l=yt.getVolume(s||o);return l?.getImageIdIndex?l.getImageIdIndex(i)!==void 0||l.getImageURIIndex(i)!==void 0:!1}),this.getImageIds=i=>{const a=this._getApplicableVolumeActor(i);if(!a)throw new Error(`No actor found for the given volumeId: ${i}`);const o=a.volumeId,s=yt.getVolume(o);if(!s)throw new Error(`imageVolume with id: ${o} does not exist in cache`);return s.imageIds},this.renderingPipelineFunctions={worldToCanvas:{tiled:this.worldToCanvasTiled,contextPool:this.worldToCanvasContextPool},canvasToWorld:{tiled:this.canvasToWorldTiled,contextPool:this.canvasToWorldContextPool},getVtkDisplayCoords:{tiled:this.getVtkDisplayCoordsTiled,contextPool:this.getVtkDisplayCoordsContextPool},getRenderer:{tiled:this.getRendererTiled,contextPool:this.getRendererContextPool}},this.useCPURendering=Gg(),this.useCPURendering)throw new Error("VolumeViewports cannot be used whilst CPU Fallback Rendering is enabled.");this._configureRenderingPipeline();const n=this.getRenderer(),r=EDe.newInstance();switch(n.setActiveCamera(r),this.type){case Tr.ORTHOGRAPHIC:r.setParallelProjection(!0);break;case Tr.VOLUME_3D:r.setParallelProjection(!0);break;case Tr.PERSPECTIVE:r.setParallelProjection(!1);break;default:throw new Error(`Unrecognized viewport type: ${this.type}`)}this.initializeVolumeNewImageEventDispatcher()}static get useCustomRenderingPipeline(){return!1}getSliceViewInfo(){throw new Error("Method not implemented.")}applyViewOrientation(e,n=!0){const{viewPlaneNormal:r,viewUp:i}=this._getOrientationVectors(e)||{};if(!r||!i)return;const a=this.getVtkActiveCamera();a.setDirectionOfProjection(-r[0],-r[1],-r[2]),a.setViewUpFrom(i),this.initialViewUp=i,n&&this.resetCamera({resetOrientation:!1,resetRotation:!1})}initializeVolumeNewImageEventDispatcher(){const e=r.bind(this),n=i.bind(this);function r(a){const{viewportId:o}=a.detail;o!==this.id||this.isDisabled||!this.getImageData()||s7e(a)}function i(a){const{viewportId:o}=a.detail;o===this.id&&(this.element.removeEventListener(mt.CAMERA_MODIFIED,e),vt.removeEventListener(mt.ELEMENT_DISABLED,n),o7e(o))}this.element.removeEventListener(mt.CAMERA_MODIFIED,e),this.element.addEventListener(mt.CAMERA_MODIFIED,e),vt.addEventListener(mt.ELEMENT_DISABLED,n)}setVOILUTFunction(e,n,r){Object.values(po).includes(e)||(e=po.LINEAR);const{voiRange:i}=this.getProperties();this.setVOI(i,n,r),this.viewportProperties.VOILUTFunction=e}setColormap(e,n,r){const i=this._getApplicableVolumeActor(n);if(!i)return;const{volumeActor:a}=i,o=Uf.newInstance();let s=W2(e.name);const{name:l}=e;if(s||(s=j2.getPresetByName(l)),!s)throw new Error(`Colormap ${e} not found`);const c=a.getProperty().getRGBTransferFunction(0).getRange();if(o.applyColorMap(s),o.setMappingRange(c[0],c[1]),a.getProperty().setRGBTransferFunction(0,o),this.viewportProperties.colormap=e,!r){const f=this.getColormap(n),u={viewportId:this.id,colormap:f,volumeId:n};wt(this.element,mt.VOI_MODIFIED,u),wt(this.element,mt.COLORMAP_MODIFIED,u)}}setOpacity(e,n){const r=this._getApplicableVolumeActor(n);if(!r)return;const{volumeActor:i}=r,a=kh.newInstance();typeof e.opacity=="number"?CX(i,e.opacity):(e.opacity.forEach(({opacity:l,value:c})=>{a.addPoint(c,l)}),i.getProperty().setScalarOpacity(0,a)),this.viewportProperties.colormap||(this.viewportProperties.colormap={}),this.viewportProperties.colormap.opacity=e.opacity;const o=this.getColormap(n),s={viewportId:this.id,colormap:o,volumeId:n};wt(this.element,mt.COLORMAP_MODIFIED,s)}setInvert(e,n,r){const i=this._getApplicableVolumeActor(n);if(!i)return;const a=i.volumeId,o=this._getOrCreateColorTransferFunction(a);if(i2(o),this.viewportProperties.invert=e,!r){const s={...this.getVOIModifiedEventDetail(a),invertStateChanged:!0};wt(this.element,mt.VOI_MODIFIED,s)}}getVOIModifiedEventDetail(e){const n=this._getApplicableVolumeActor(e);if(!n)throw new Error(`No actor found for the given volumeId: ${e}`);const a=n.volumeActor.getProperty().getRGBTransferFunction(0).getMappingRange(),o=this.getColormap(e),{VOILUTFunction:s,invert:l}=this.getProperties(e);return{viewportId:this.id,range:{lower:a[0],upper:a[1]},volumeId:n.volumeId,VOILUTFunction:s,colormap:o,invert:l}}_getOrCreateColorTransferFunction(e){const n=this._getApplicableVolumeActor(e);if(!n)return null;const{volumeActor:r}=n,i=r.getProperty().getRGBTransferFunction(0);if(i)return i;const a=Uf.newInstance();return r.getProperty().setRGBTransferFunction(0,a),a}setInterpolationType(e,n){const r=this._getApplicableVolumeActor(n);if(!r)return;const{volumeActor:i}=r;i.getProperty().setInterpolationType(e),this.viewportProperties.interpolationType=e}setVOI(e,n,r=!1){const i=this._getApplicableVolumeActor(n);if(!i)return;const{volumeActor:a}=i,o=i.volumeId,s=e;if(typeof s>"u")throw new Error("voiRangeToUse is undefined, need to implement this in the new volume model");const{VOILUTFunction:l}=this.getProperties(o);if(l===po.SAMPLED_SIGMOID){const c=l7(s);a.getProperty().setRGBTransferFunction(0,c)}else{const{lower:c,upper:f}=s;a.getProperty().getRGBTransferFunction(0).setRange(c,f)}if(!r){const c={...this.getVOIModifiedEventDetail(o)};wt(this.element,mt.VOI_MODIFIED,c)}this.viewportProperties.voiRange=s}rotateCamera(e){const n=e-this.getRotation();this.getVtkActiveCamera().roll(-n)}setDefaultProperties(e,n){n==null?this.globalDefaultProperties=e:this.perVolumeIdDefaultProperties.set(n,e)}clearDefaultProperties(e){e==null?(this.globalDefaultProperties={},this.resetProperties()):(this.perVolumeIdDefaultProperties.delete(e),this.resetToDefaultProperties(e))}getViewReference(e={}){const n=super.getViewReference(e),r=this.getVolumeId(e);if(e?.forFrameOfReference!==!1&&(n.volumeId=r),typeof e?.sliceIndex!="number")return n;const{viewPlaneNormal:i}=n,a=e?.sliceIndex-this.getSliceIndex(),{sliceRangeInfo:o}=Yg(this,r,!0),{sliceRange:s,spacingInNormalDirection:l,camera:c}=o,{focalPoint:f,position:u}=c,{newFocalPoint:d}=Jg(f,u,s,i,l,a);return n.cameraFocalPoint=d,n}isReferenceViewable(e,n){if(!e.FrameOfReferenceUID||!super.isReferenceViewable(e,n))return!1;if(n?.withNavigation){const{referencedImageId:a}=e;return!a||this.hasImageURI(a)}const r=this.getSliceIndex(),{sliceIndex:i}=e;return Array.isArray(i)?i[0]<=r&&r<=i[1]:i===void 0||i===r}scroll(e=1){const n=this.getVolumeId(),{sliceRangeInfo:r}=Yg(this,n,!0);if(!r)return;const{sliceRange:i,spacingInNormalDirection:a,camera:o}=r,{focalPoint:s,viewPlaneNormal:l,position:c}=o,{newFocalPoint:f,newPosition:u}=Jg(s,c,i,l,a,e);this.setCamera({focalPoint:f,position:u}),this.render()}setBestOrentation(e,n){if(!e&&!n)return;const{viewPlaneNormal:r}=this.getCamera();if(Gp(r,n)&&Gp(r,e))return;const i=this._getAcquisitionPlaneOrientation();if(Gp(i.viewPlaneNormal,n)&&Gp(i.viewPlaneNormal,e)){this.setOrientation(i);return}for(const o of Object.values(Tf))if(Gp(o.viewPlaneNormal,n)&&Gp(o.viewPlaneNormal,e)){this.setOrientation(o);return}const a=gr(it(),n||i.viewPlaneNormal,e);Lr(a,a),this.setOrientation({viewPlaneNormal:a})}setViewPlane(e){const{point:n,inPlaneVector1:r,inPlaneVector2:i,FrameOfReferenceUID:a}=e;this.setBestOrentation(r,i),this.setViewReference({FrameOfReferenceUID:a,cameraFocalPoint:n,viewPlaneNormal:this.getCamera().viewPlaneNormal})}setViewReference(e){if(!e)return;const n=this.getVolumeId(),{FrameOfReferenceUID:r,cameraFocalPoint:i,referencedImageId:a,planeRestriction:o,viewPlaneNormal:s,viewUp:l}=e;let{sliceIndex:c}=e;if(o&&!s)return this.setViewPlane(o);const{focalPoint:f,viewPlaneNormal:u,position:d}=this.getCamera(),h=bX(u,s),p=pr(u,s);if(typeof c=="number"&&n!==void 0&&e.volumeId===n&&(h||p)){const{currentStepIndex:g,sliceRangeInfo:m,numScrollSteps:y}=Yg(this,n,!0),{sliceRange:v,spacingInNormalDirection:x}=m;h&&(c=y-c-1);const w=c-g,{newFocalPoint:S,newPosition:T}=Jg(f,d,v,u,x,w);this.setCamera({focalPoint:S,position:T})}else if(r===this.getFrameOfReferenceUID()){if(s&&!h&&!p){this.setOrientation({viewPlaneNormal:s,viewUp:l}),this.setViewReference(e);return}if(a&&this.isInAcquisitionPlane()){const g=Ut(ts.IMAGE_PLANE,a),{imagePositionPatient:m}=g,{focalPoint:y}=this.getCamera(),v=Pr(it(),y,m),x=zt(v,u),w=Ar(it(),y,[-u[0],-u[1],-u[2]],x);this.setCamera({focalPoint:w}),this.render();return}if(i){const g=Pr([0,0,0],i,f),m=s??u,y=zt(g,m);pr(y,0)||tl(g,m,y);const v=Ul([0,0,0],f,g),x=Ul([0,0,0],d,g);this.setCamera({focalPoint:v,position:x})}}else throw new Error(`Incompatible view refs: ${r}!==${this.getFrameOfReferenceUID()}`)}setThreshold(e,n){const r=this._getApplicableVolumeActor(n);if(!r)return;const{volumeActor:i}=r;SX(i,e.threshold),this.viewportProperties.colormap||(this.viewportProperties.colormap={}),this.viewportProperties.colormap.threshold=e.threshold;const a=this.getColormap(n),o={viewportId:this.id,colormap:a,volumeId:n};wt(this.element,mt.COLORMAP_MODIFIED,o)}setProperties({voiRange:e,VOILUTFunction:n,invert:r,colormap:i,preset:a,interpolationType:o,slabThickness:s,sampleDistanceMultiplier:l}={},c,f=!1){this.globalDefaultProperties==null&&this.setDefaultProperties({voiRange:e,VOILUTFunction:n,invert:r,colormap:i,preset:a,slabThickness:s}),r!==void 0&&this.viewportProperties.invert!==r&&this.setInvert(r,c,f),i?.name&&this.setColormap(i,c,f),i?.opacity!=null&&this.setOpacity(i,c),i?.threshold!=null&&this.setThreshold(i,c),e!==void 0&&this.setVOI(e,c,f),typeof o<"u"&&this.setInterpolationType(o),n!==void 0&&this.setVOILUTFunction(n,c,f),a!==void 0&&this.setPreset(a,c,f),s!==void 0&&this.setSlabThickness(s),l!==void 0&&this.setSampleDistanceMultiplier(l)}resetToDefaultProperties(e){const n=this.globalDefaultProperties;n.colormap?.name&&this.setColormap(n.colormap,e),n.colormap?.opacity!=null&&this.setOpacity(n.colormap,e),n.voiRange!==void 0&&this.setVOI(n.voiRange,e),n.VOILUTFunction!==void 0&&this.setVOILUTFunction(n.VOILUTFunction,e),n.invert!==void 0&&this.setInvert(n.invert,e),n.slabThickness!==void 0&&(this.setSlabThickness(n.slabThickness),this.viewportProperties.slabThickness=n.slabThickness),n.sampleDistanceMultiplier!==void 0&&this.setSampleDistanceMultiplier(n.sampleDistanceMultiplier),n.preset!==void 0&&this.setPreset(n.preset,e,!1),this.render()}setPreset(e,n,r){const i=this._getApplicableVolumeActor(n);if(!i)return;const{volumeActor:a}=i;let o=e;typeof o=="string"&&(o=WK.find(s=>s.name===e)),o&&(rQ(a,o),this.viewportProperties.preset=o,this.render(),r||wt(this.element,mt.PRESET_MODIFIED,{viewportId:this.id,volumeId:i.volumeId,actor:a,presetName:o.name}))}setSampleDistanceMultiplier(e){}async setVolumes(e,n=!1,r=!1){const i=e[0].volumeId,a=yt.getVolume(i);if(!a)throw new Error(`imageVolume with id: ${i} does not exist, you need to create/allocate the volume first`);const o=a.metadata.FrameOfReferenceUID;this._isValidVolumeInputArray(e,o),this._FrameOfReferenceUID=o,e.forEach(l=>{this._addVolumeId(l.volumeId)});const s=[];for(let l=0;l<e.length;l++){const{volumeId:c,actorUID:f,slabThickness:u,...d}=e[l],h=await y3(e[l],this.element,this.id,r),p=f||cr();s.push({uid:p,actor:h,slabThickness:u,referencedId:c,...d})}this._setVolumeActors(s),this.viewportStatus=Io.PRE_RENDER,this.initializeColorTransferFunction(e),wt(this.element,mt.VOLUME_VIEWPORT_NEW_VOLUME,{viewportId:this.id,volumeActors:s}),n&&this.render()}async addVolumes(e,n=!1,r=!1){const i=yt.getVolume(e[0].volumeId);if(!i)throw new Error(`imageVolume with id: ${i.volumeId} does not exist`);const a=[];this._isValidVolumeInputArray(e,this._FrameOfReferenceUID),e.forEach(o=>{this._addVolumeId(o.volumeId)});for(let o=0;o<e.length;o++){const{volumeId:s,visibility:l,actorUID:c,slabThickness:f,...u}=e[o],d=await y3(e[o],this.element,this.id,r);l||d.setVisibility(!1);const h=c||cr();a.push({uid:h,actor:d,slabThickness:f,referencedId:s,...u})}this.addActors(a),this.initializeColorTransferFunction(e),n&&this.render()}removeVolumeActors(e,n=!1){this.removeActors(e),n&&this.render()}setOrientation(e,n=!0){console.warn('Method "setOrientation" needs implementation')}initializeColorTransferFunction(e){const n=e[0].volumeId,r=this._getOrCreateColorTransferFunction(n);!this.initialTransferFunctionNodes&&r&&(this.initialTransferFunctionNodes=n3(r))}_getApplicableVolumeActor(e){const n=this.getActors();if(!n?.length)return;if(e){const i=n.find(a=>a.referencedId===e);return i?{volumeActor:i.actor,volumeId:e,actorUID:i.uid}:void 0}const r=n[0];return{volumeActor:r.actor,volumeId:r.referencedId,actorUID:r.uid}}async _isValidVolumeInputArray(e,n){const r=e.length;for(let i=1;i<r;i++){const a=yt.getVolume(e[i].volumeId);if(n!==a.metadata.FrameOfReferenceUID)throw new Error(`Volumes being added to viewport ${this.id} do not share the same FrameOfReferenceUID. This is not yet supported`)}return!0}getBounds(){return this.getRenderer().computeVisiblePropBounds()}flip(e){super.flip(e)}hasVolumeId(e){return this.volumeIds.has(e)}hasVolumeURI(e){for(const n of this.volumeIds)if(n.includes(e))return!0;return!1}getImageData(e){if(!this.getDefaultActor())return;e||=this.getVolumeId();const r=this.getActors()?.find(s=>s.referencedId===e);if(!ns(r,"vtkVolume"))return;const i=r.actor,a=yt.getVolume(e),o=i.getMapper().getInputData();return{dimensions:o.getDimensions(),spacing:o.getSpacing(),origin:o.getOrigin(),direction:o.getDirection(),imageData:i.getMapper().getInputData(),metadata:{Modality:a?.metadata?.Modality,FrameOfReferenceUID:a?.metadata?.FrameOfReferenceUID},get scalarData(){return a?.voxelManager?.getScalarData()},scaling:a?.scaling,hasPixelSpacing:!0,voxelManager:a?.voxelManager}}setCameraClippingRange(){throw new Error("Method not implemented.")}getSliceIndex(){throw new Error("Method not implemented.")}setCamera(e,n){super.setCamera(e,n),this.setCameraClippingRange()}_setVolumeActors(e){for(let n=0;n<e.length;n++)this.viewportProperties.invert=!1;this.setActors(e)}getRendererContextPool(){return this.getRenderingEngine().getRenderer(this.id)}getRendererTiled(){const e=this.getRenderingEngine();if(!e||e.hasBeenDestroyed)throw new Error("Rendering engine has been destroyed");return e.offscreenMultiRenderWindow?.getRenderer(this.id)}_getViewUp(e){const{viewUp:n}=this.getCamera(),r=zt(n,e);if(pr(r,0))return n;if(Xb(e[0],1))return[0,0,1];if(Xb(e[1],1))return[0,0,1];if(Xb(e[2],1))return[0,-1,0];const i=Ar(it(),n,e,-r);return Lr(i,i),i}_getOrientationVectors(e){if(typeof e=="object"){if(e.viewPlaneNormal)return{...e,viewUp:e.viewUp||this._getViewUp(e.viewPlaneNormal)};throw new Error("Invalid orientation object. It must contain viewPlaneNormal")}else if(typeof e=="string"){if(e==="acquisition")return this._getAcquisitionPlaneOrientation();if(e==="reformat"||e.includes("_reformat"))return aQ(this,{useViewportNormal:!0});if(Tf[e])return this.viewportProperties.orientation=e,Tf[e]}throw new Error(`Invalid orientation: ${e}. Valid orientations are: ${Object.keys(Tf).join(", ")}`)}_getAcquisitionPlaneOrientation(){if(!this.getDefaultActor())return;const n=this.getVolumeId(),r=yt.getVolume(n);if(!r)throw new Error(`imageVolume with id: ${n} does not exist in cache`);const{direction:i}=r,a=i.slice(6,9).map(s=>-s),o=i.slice(3,6).map(s=>-s);return{viewPlaneNormal:a,viewUp:o}}getSlabThickness(){const e=this.getActors();let n=Oi.MINIMUM_SLAB_THICKNESS;return e.forEach(r=>{r.slabThickness>n&&(n=r.slabThickness)}),n}getIntensityFromWorld(e){const n=this.getDefaultActor();if(!ns(n,"vtkVolume"))return;const{actor:r}=n,i=r.getMapper().getInputData(),a=yt.getVolume(this.getVolumeId()),o=fo(i,e);return a.voxelManager.getAtIJKPoint(o)}getVolumeId(e){const n=this.getActors();if(!n)return;if(!e?.volumeId){const i=n.find(a=>a.actor.getClassName()==="vtkVolume");return i?.referencedId||i?.uid}const r=n.find(i=>i.actor.getClassName()==="vtkVolume"&&i.referencedId===e?.volumeId);return r?.referencedId||r?.uid}getViewReferenceId(e={}){let{volumeId:n,sliceIndex:r}=e;if(!n){const c=this.getActors();if(!c)return;n=c.find(f=>f.actor.getClassName()==="vtkVolume")?.referencedId}const i=this.getSliceIndex();r??=i;const{viewPlaneNormal:a,focalPoint:o}=this.getCamera(),s=n.includes("?")?"&":"?",l=a.map(c=>c.toFixed(3)).join(",");return`volumeId:${n}${s}sliceIndex=${r}&viewPlaneNormal=${l}`}_addVolumeId(e){this.volumeIds.add(e)}getAllVolumeIds(){return Array.from(this.volumeIds)}_configureRenderingPipeline(){const e=oQ();for(const n in this.renderingPipelineFunctions)if(Object.prototype.hasOwnProperty.call(this.renderingPipelineFunctions,n)){const r=this.renderingPipelineFunctions[n];this[n]=e?r.contextPool:r.tiled}}}function Gp(t,e){return!e||pr(zt(t,e),0)}function m7e(t,e){e.classHierarchy.push("vtkAbstractImageMapper"),t.getIsOpaque=()=>!0,t.getCurrentImage=()=>null,t.getBoundsForSlice=()=>(ce.vtkErrorMacro("vtkAbstractImageMapper.getBoundsForSlice - NOT IMPLEMENTED"),n0())}const v7e={slice:0,customDisplayExtent:[0,0,0,0,0,0],useCustomExtents:!1,backgroundColor:[0,0,0,1]};function y7e(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,v7e,n),F7.extend(t,e,n),ce.setGet(t,e,["slice","useCustomExtents"]),ce.setGetArray(t,e,["customDisplayExtent"],6),ce.setGetArray(t,e,["backgroundColor"],4),m7e(t,e)}var x7e={extend:y7e};function sQ(t,e,n){const r=n.getCurrentImage(),i=r.getExtent(),a=[i[0],i[2],i[4]],{ijkMode:o}=n.getClosestIJKAxis();let s=n.isA("vtkImageArrayMapper")?n.getSubSlice():n.getSlice();o!==n.getSlicingMode()&&(s=n.getSliceAtPosition(s)),a[o]+=s;const l=[0,0,0];r.indexToWorld(a,l),a[o]+=1;const c=[0,0,0];r.indexToWorld(a,c),c[0]-=l[0],c[1]-=l[1],c[2]-=l[2],wc(c,c);const f=Ao.intersectWithLine(t,e,l,c);if(f.intersection){const u=f.x,d=[0,0,0];return r.worldToIndex(u,d),{t:f.t,absoluteIJK:d}}return null}function b7e(t,e,n){const r=sQ(t,e,n);if(r){const a=n.getCurrentImage().getExtent(),o=[Math.round(r.absoluteIJK[0]),Math.round(r.absoluteIJK[1]),Math.round(r.absoluteIJK[2])];return o[0]<a[0]||o[0]>a[1]||o[1]<a[2]||o[1]>a[3]||o[2]<a[4]||o[2]>a[5]?null:{t:r.t,ijk:o}}return null}function w7e(t,e,n){const r=sQ(t,e,n);if(r){const a=n.getCurrentImage().getExtent(),o=r.absoluteIJK,s=[Math.floor(o[0]),Math.floor(o[1]),Math.floor(o[2])];if(s[0]<a[0]||s[0]>a[1]-1||s[1]<a[2]||s[1]>a[3]-1||s[2]<a[4]||s[2]>(a[5]?a[5]-1:a[5]))return null;const l=[o[0]-s[0],o[1]-s[1],o[2]-s[2]];return{t:r.t,ijk:s,pCoords:l}}return null}const{staticOffsetAPI:C7e,otherStaticMethods:S7e}=zC,{SlicingMode:rr}=WC;function T7e(t,e){e.classHierarchy.push("vtkImageMapper"),t.getSliceAtPosition=r=>{const i=t.getCurrentImage();let a;if(r.length===3)a=r;else if(Number.isFinite(r)){const f=i.getBounds();switch(e.slicingMode){case rr.X:a=[r,(f[3]+f[2])/2,(f[5]+f[4])/2];break;case rr.Y:a=[(f[1]+f[0])/2,r,(f[5]+f[4])/2];break;case rr.Z:a=[(f[1]+f[0])/2,(f[3]+f[2])/2,r];break}}const o=[0,0,0];i.worldToIndex(a,o);const s=i.getExtent(),{ijkMode:l}=t.getClosestIJKAxis();let c=0;switch(l){case rr.I:c=xc(o[0],s[0],s[1]);break;case rr.J:c=xc(o[1],s[2],s[3]);break;case rr.K:c=xc(o[2],s[4],s[5]);break;default:return 0}return c},t.setSliceFromCamera=r=>{const i=r.getFocalPoint();switch(e.slicingMode){case rr.I:case rr.J:case rr.K:{const a=t.getSliceAtPosition(i);t.setSlice(a)}break;case rr.X:t.setSlice(i[0]);break;case rr.Y:t.setSlice(i[1]);break;case rr.Z:t.setSlice(i[2]);break}},t.setXSlice=r=>{t.setSlicingMode(rr.X),t.setSlice(r)},t.setYSlice=r=>{t.setSlicingMode(rr.Y),t.setSlice(r)},t.setZSlice=r=>{t.setSlicingMode(rr.Z),t.setSlice(r)},t.setISlice=r=>{t.setSlicingMode(rr.I),t.setSlice(r)},t.setJSlice=r=>{t.setSlicingMode(rr.J),t.setSlice(r)},t.setKSlice=r=>{t.setSlicingMode(rr.K),t.setSlice(r)},t.getSlicingModeNormal=()=>{const r=[0,0,0],i=t.getCurrentImage().getDirection();switch(e.slicingMode){case rr.X:r[0]=1;break;case rr.Y:r[1]=1;break;case rr.Z:r[2]=1;break;case rr.I:Hb(i,[1,0,0],r);break;case rr.J:Hb(i,[0,1,0],r);break;case rr.K:Hb(i,[0,0,1],r);break}return r};function n(){let r;switch(e.slicingMode){case rr.X:r=0;break;case rr.Y:r=1;break;case rr.Z:r=2;break;default:e.closestIJKAxis={ijkMode:e.slicingMode,flip:!1};return}const i=t.getCurrentImage().getDirection(),a=Zq(i);let o=0;for(;o<3&&a[r+3*o]===0;++o);const s=a[r+3*o]<0;e.closestIJKAxis={ijkMode:o,flip:s}}t.setSlicingMode=r=>{e.slicingMode!==r&&(e.slicingMode=r,t.getCurrentImage()&&n(),t.modified())},t.getClosestIJKAxis=()=>((e.closestIJKAxis===void 0||e.closestIJKAxis.ijkMode===rr.NONE)&&t.getCurrentImage()&&n(),e.closestIJKAxis),t.getBounds=()=>{const r=t.getCurrentImage();if(!r)return n0();if(!e.useCustomExtents)return r.getBounds();const i=e.customDisplayExtent.slice(),{ijkMode:a}=t.getClosestIJKAxis();let o=e.slice;switch(a!==e.slicingMode&&(o=t.getSliceAtPosition(e.slice)),a){case rr.I:i[0]=o,i[1]=o;break;case rr.J:i[2]=o,i[3]=o;break;case rr.K:i[4]=o,i[5]=o;break}return r.extentToBounds(i)},t.getBoundsForSlice=function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:e.slice,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const a=t.getCurrentImage();if(!a)return n0();const o=a.getSpatialExtent(),{ijkMode:s}=t.getClosestIJKAxis();let l=r;switch(s!==e.slicingMode&&(l=t.getSliceAtPosition(r)),s){case rr.I:o[0]=l-i,o[1]=l+i;break;case rr.J:o[2]=l-i,o[3]=l+i;break;case rr.K:o[4]=l-i,o[5]=l+i;break}return a.extentToBounds(o)},t.intersectWithLineForPointPicking=(r,i)=>b7e(r,i,t),t.intersectWithLineForCellPicking=(r,i)=>w7e(r,i,t),t.getCurrentImage=()=>t.getInputData()}const E7e={slicingMode:rr.NONE,closestIJKAxis:{ijkMode:rr.NONE,flip:!1},renderToRectangle:!1,sliceAtFocalPoint:!1,preferSizeOverAccuracy:!1};function lQ(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,E7e,n),x7e.extend(t,e,n),ce.get(t,e,["slicingMode"]),ce.setGet(t,e,["closestIJKAxis","renderToRectangle","sliceAtFocalPoint","preferSizeOverAccuracy"]),zC.implementCoincidentTopologyMethods(t,e),T7e(t,e)}const _7e=ce.newInstance(lQ,"vtkImageMapper");var D7e={newInstance:_7e,extend:lQ,...C7e,...S7e,...WC};const{InterpolationType:aw}=tTe,{vtkErrorMacro:eF}=ce,ow=4;function O7e(t,e){e.classHierarchy.push("vtkImageProperty"),t.getMTime=()=>{let n=e.mtime,r;for(let i=0;i<ow;i++)e.componentData[i].rGBTransferFunction&&(r=e.componentData[i].rGBTransferFunction.getMTime(),n=n>r?n:r),e.componentData[i].piecewiseFunction&&(r=e.componentData[i].piecewiseFunction.getMTime(),n=n>r?n:r);return n},t.setRGBTransferFunction=function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=n,a=r;return Number.isInteger(n)||(a=n,i=0),e.componentData[i].rGBTransferFunction!==a?(e.componentData[i].rGBTransferFunction=a,t.modified(),!0):!1},t.getRGBTransferFunction=function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return e.componentData[n].rGBTransferFunction},t.setPiecewiseFunction=function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=n,a=r;return Number.isInteger(n)||(a=n,i=0),e.componentData[i].piecewiseFunction!==a?(e.componentData[i].piecewiseFunction=a,t.modified(),!0):!1},t.getPiecewiseFunction=function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return e.componentData[n].piecewiseFunction},t.setScalarOpacity=function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=n,a=r;return Number.isInteger(n)||(a=n,i=0),t.setPiecewiseFunction(i,a)},t.getScalarOpacity=function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return t.getPiecewiseFunction(n)},t.setComponentWeight=function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;if(n<0||n>=ow)return eF("Invalid index"),!1;const i=Math.min(1,Math.max(0,r));return e.componentData[n].componentWeight!==i?(e.componentData[n].componentWeight=i,t.modified(),!0):!1},t.getComponentWeight=function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return n<0||n>=ow?(eF("Invalid index"),0):e.componentData[n].componentWeight},t.setInterpolationTypeToNearest=()=>t.setInterpolationType(aw.NEAREST),t.setInterpolationTypeToLinear=()=>t.setInterpolationType(aw.LINEAR),t.getInterpolationTypeAsString=()=>ce.enumToString(aw,e.interpolationType)}const M7e={independentComponents:!1,interpolationType:aw.LINEAR,colorWindow:255,colorLevel:127.5,ambient:1,diffuse:0,opacity:1,useLookupTableScalarRange:!1,useLabelOutline:!1,labelOutlineThickness:[1],labelOutlineOpacity:1};function I7e(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(Object.assign(e,M7e,n),ce.obj(t,e),!e.componentData){e.componentData=[];for(let r=0;r<ow;r++)e.componentData.push({rGBTransferFunction:null,piecewiseFunction:null,componentWeight:1})}ce.setGet(t,e,["independentComponents","interpolationType","colorWindow","colorLevel","ambient","diffuse","opacity","useLookupTableScalarRange","useLabelOutline","labelOutlineOpacity"]),ce.setGetArray(t,e,["labelOutlineThickness"]),O7e(t,e)}const R7e=ce.newInstance(I7e,"vtkImageProperty");var P7e={newInstance:R7e};const{vtkDebugMacro:A7e}=ce;function N7e(t,e){e.classHierarchy.push("vtkImageSlice"),t.getActors=()=>t,t.getImages=()=>t,t.getIsOpaque=()=>{if(e.forceOpaque)return!0;if(e.forceTranslucent)return!1;e.property||t.getProperty();let n=e.property.getOpacity()>=1;return n=n&&(!e.mapper||e.mapper.getIsOpaque()),n},t.hasTranslucentPolygonalGeometry=()=>!1,t.makeProperty=P7e.newInstance,t.getProperty=()=>(e.property===null&&(e.property=t.makeProperty()),e.property),t.getBounds=()=>{if(e.mapper===null)return e.bounds;const n=e.mapper.getBounds();if(!n||n.length!==6)return n;if(n[0]>n[1])return e.mapperBounds=n.concat(),e.bounds=[1,-1,1,-1,1,-1],e.boundsMTime.modified(),n;const r=i=>i[0].map((a,o)=>i.map(s=>s[o]));if(!e.mapperBounds||!r([n,e.mapperBounds]).reduce((i,a)=>i&&a[0]===a[1],!0)||t.getMTime()>e.boundsMTime.getMTime()){A7e("Recomputing bounds..."),e.mapperBounds=n.map(a=>a),t.computeMatrix();const i=new Float64Array(16);jn(i,e.matrix),Er.transformBounds(n,i,e.bounds),e.boundsMTime.modified()}return e.bounds},t.getBoundsForSlice=(n,r)=>{const i=e.mapper.getBoundsForSlice(n,r);if(!Er.isValid(i))return i;t.computeMatrix();const a=new Float64Array(16);return jn(a,e.matrix),Er.transformBounds(i,a)},t.getMinXBound=()=>t.getBounds()[0],t.getMaxXBound=()=>t.getBounds()[1],t.getMinYBound=()=>t.getBounds()[2],t.getMaxYBound=()=>t.getBounds()[3],t.getMinZBound=()=>t.getBounds()[4],t.getMaxZBound=()=>t.getBounds()[5],t.getMTime=()=>{let n=e.mtime;if(e.property!==null){const r=e.property.getMTime();n=r>n?r:n}return n},t.getRedrawMTime=()=>{let n=e.mtime;if(e.mapper!==null){let r=e.mapper.getMTime();n=r>n?r:n,e.mapper.getInput()!==null&&(e.mapper.getInputAlgorithm().update(),r=e.mapper.getInput().getMTime(),n=r>n?r:n)}if(e.property!==null){let r=e.property.getMTime();n=r>n?r:n,e.property.getRGBTransferFunction()!==null&&(r=e.property.getRGBTransferFunction().getMTime(),n=r>n?r:n)}return n},t.getSupportsSelection=()=>e.mapper?e.mapper.getSupportsSelection():!1}const L7e={mapper:null,property:null,forceOpaque:!1,forceTranslucent:!1,bounds:[...Er.INIT_BOUNDS]};function cQ(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,L7e,n),_7.extend(t,e,n),e.boundsMTime={},ce.obj(e.boundsMTime),ce.set(t,e,["property"]),ce.setGet(t,e,["mapper","forceOpaque","forceTranslucent"]),ce.getArray(t,e,["bounds"],6),N7e(t,e)}const k7e=ce.newInstance(cQ,"vtkImageSlice");var V7e={newInstance:k7e,extend:cQ};function F7e(t){return Object.values(po).includes(t)?t:po.LINEAR}function uQ(t){const n={...Ut(ts.IMAGE_PLANE,t)};return n.columnPixelSpacing||(n.columnPixelSpacing=1),n.rowPixelSpacing||(n.rowPixelSpacing=1),n.columnCosines||(n.columnCosines=[0,1,0]),n.rowCosines||(n.rowCosines=[1,0,0]),n.imagePositionPatient||(n.imagePositionPatient=[0,0,0]),n.imageOrientationPatient||(n.imageOrientationPatient=new Float32Array([1,0,0,0,1,0])),n}function fQ(t){const e=t.imageId,{pixelRepresentation:n,bitsAllocated:r,bitsStored:i,highBit:a,photometricInterpretation:o,samplesPerPixel:s}=Ut("imagePixelModule",e),{windowWidth:l,windowCenter:c,voiLUTFunction:f}=t,{modality:u}=Ut("generalSeriesModule",e),d=Ut("scalingModule",e),h=Ut(ts.CALIBRATION,e),p=F7e(f),g=uQ(e);return{calibration:h,scalingFactor:d,voiLUTFunction:p,modality:u,imagePlaneModule:g,imagePixelModule:{bitsAllocated:r,bitsStored:i,samplesPerPixel:s,highBit:a,photometricInterpretation:o,pixelRepresentation:n,windowWidth:l,windowCenter:c,modality:u,voiLUTFunction:p}}}function tO(t){const{imagePlaneModule:e,imagePixelModule:n,voiLUTFunction:r,modality:i,scalingFactor:a,calibration:o}=fQ(t);let{rowCosines:s,columnCosines:l}=e;(s==null||l==null)&&(s=[1,0,0],l=[0,1,0]);const c=Sn(s[0],s[1],s[2]),f=Sn(l[0],l[1],l[2]),u=it();gr(u,c,f);let d=e.imagePositionPatient;d==null&&(d=[0,0,0]);const h=e.columnPixelSpacing||t.columnPixelSpacing,p=e.rowPixelSpacing||t.rowPixelSpacing,g=t.columns,m=t.rows,y=al,v=1;return!n.photometricInterpretation&&t.sizeInBytes===3*t.width*t.height&&(t.numberOfComponents=3),{numberOfComponents:t.numberOfComponents||U7e(n.photometricInterpretation),origin:d,direction:[...c,...f,...u],dimensions:[g,m,v],spacing:[h,p,y],numVoxels:g*m*v,imagePlaneModule:e,imagePixelModule:n,bitsAllocated:n.bitsAllocated,voiLUTFunction:r,modality:i,scalingFactor:a,calibration:o,scanAxisNormal:u}}function U7e(t){let e=1;return(t==="RGB"||t?.includes("YBR")||t==="PALETTE COLOR")&&(e=3),e}var sw={exports:{}},B7e=sw.exports,tF;function $7e(){return tF||(tF=1,(function(t){(function(e,n){t.exports?t.exports=n():e.log=n()})(B7e,function(){var e=function(){},n="undefined",r=typeof window!==n&&typeof window.navigator!==n&&/Trident\/|MSIE /.test(window.navigator.userAgent),i=["trace","debug","info","warn","error"],a={},o=null;function s(g,m){var y=g[m];if(typeof y.bind=="function")return y.bind(g);try{return Function.prototype.bind.call(y,g)}catch{return function(){return Function.prototype.apply.apply(y,[g,arguments])}}}function l(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function c(g){return g==="debug"&&(g="log"),typeof console===n?!1:g==="trace"&&r?l:console[g]!==void 0?s(console,g):console.log!==void 0?s(console,"log"):e}function f(){for(var g=this.getLevel(),m=0;m<i.length;m++){var y=i[m];this[y]=m<g?e:this.methodFactory(y,g,this.name)}if(this.log=this.debug,typeof console===n&&g<this.levels.SILENT)return"No console available for logging"}function u(g){return function(){typeof console!==n&&(f.call(this),this[g].apply(this,arguments))}}function d(g,m,y){return c(g)||u.apply(this,arguments)}function h(g,m){var y=this,v,x,w,S="loglevel";typeof g=="string"?S+=":"+g:typeof g=="symbol"&&(S=void 0);function T(O){var P=(i[O]||"silent").toUpperCase();if(!(typeof window===n||!S)){try{window.localStorage[S]=P;return}catch{}try{window.document.cookie=encodeURIComponent(S)+"="+P+";"}catch{}}}function _(){var O;if(!(typeof window===n||!S)){try{O=window.localStorage[S]}catch{}if(typeof O===n)try{var P=window.document.cookie,N=encodeURIComponent(S),A=P.indexOf(N+"=");A!==-1&&(O=/^([^;]+)/.exec(P.slice(A+N.length+1))[1])}catch{}return y.levels[O]===void 0&&(O=void 0),O}}function D(){if(!(typeof window===n||!S)){try{window.localStorage.removeItem(S)}catch{}try{window.document.cookie=encodeURIComponent(S)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}function I(O){var P=O;if(typeof P=="string"&&y.levels[P.toUpperCase()]!==void 0&&(P=y.levels[P.toUpperCase()]),typeof P=="number"&&P>=0&&P<=y.levels.SILENT)return P;throw new TypeError("log.setLevel() called with invalid level: "+O)}y.name=g,y.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},y.methodFactory=m||d,y.getLevel=function(){return w??x??v},y.setLevel=function(O,P){return w=I(O),P!==!1&&T(w),f.call(y)},y.setDefaultLevel=function(O){x=I(O),_()||y.setLevel(O,!1)},y.resetLevel=function(){w=null,D(),f.call(y)},y.enableAll=function(O){y.setLevel(y.levels.TRACE,O)},y.disableAll=function(O){y.setLevel(y.levels.SILENT,O)},y.rebuild=function(){if(o!==y&&(v=I(o.getLevel())),f.call(y),o===y)for(var O in a)a[O].rebuild()},v=I(o?o.getLevel():"WARN");var R=_();R!=null&&(w=I(R)),f.call(y)}o=new h,o.getLogger=function(m){if(typeof m!="symbol"&&typeof m!="string"||m==="")throw new TypeError("You must supply a name when creating a logger.");var y=a[m];return y||(y=a[m]=new h(m,o.methodFactory)),y};var p=typeof window!==n?window.log:void 0;return o.noConflict=function(){return typeof window!==n&&window.log===o&&(window.log=p),o},o.getLoggers=function(){return a},o.default=o,o})})(sw)),sw.exports}var G7e=$7e();const j7e=sl(G7e),dQ=j7e.noConflict();typeof window<"u"&&(window.log=dQ);function eS(t){const e=dQ.getLogger(t[0]);return e.getLogger=(...n)=>eS(`${t}.${n.join(".")}`),e}function nO(...t){return eS(t.join("."))}const qm=eS("cs3d"),rO=qm.getLogger("core"),z7e=qm.getLogger("tools"),W7e=qm.getLogger("dicomImageLoader"),H7e=qm.getLogger("ai"),K7e=qm.getLogger("examples"),q7e=nO("consistency","dicom"),X7e=nO("consistency","image"),Y7e=Object.freeze(Object.defineProperty({__proto__:null,aiLog:H7e,coreLog:rO,cs3dLog:qm,dicomConsistencyLog:q7e,examplesLog:K7e,getLogger:nO,getRootLogger:eS,imageConsistencyLog:X7e,loaderLog:W7e,toolsLog:z7e},Symbol.toStringTag,{value:"Module"}));function hQ(t){const e=Uf.newInstance();let n=0,r=1024;return t.lower!==void 0&&t.upper!==void 0&&(n=t.lower,r=t.upper),e.addRGBPoint(n,0,0,0),e.addRGBPoint(r,1,1,1),e}function tS(t,e){const n=e.voxelManager.getScalarData();if(!t.getPointData)return;const r=t.getPointData().getScalars().getData();if(e.color&&e.rgba){const i=new Uint8Array(e.columns*e.rows*3);for(let a=0;a<e.columns*e.rows;a++)i[a*3]=n[a*4],i[a*3+1]=n[a*4+1],i[a*3+2]=n[a*4+2];e.rgba=!1,e.getPixelData=()=>i,r.set(i)}else r.set(n);t.modified()}function Fn(){return window.performance?performance.now():Date.now()}function J7e(t,e){return function(n){const r=((n-(e-.5))/(t-1)+.5)*255;return Math.min(Math.max(r,0),255)}}function Z7e(t){const n=Math.max(...t.lut).toString(2).length-8,r=t.lut[0]>>n,i=t.lut[t.lut.length-1]>>n,a=t.firstValueMapped+t.lut.length-1;return function(o){return o<t.firstValueMapped?r:o>=a?i:t.lut[o-t.firstValueMapped]>>n}}function pQ(t,e,n){return n?Z7e(n):J7e(t,e)}function Q7e(t,e,n,r,i){const a=t.maxPixelValue,o=t.minPixelValue,s=Math.min(o,0);if(t.cachedLut===void 0){const f=a-s+1;t.cachedLut={},t.cachedLut.lutArray=new Uint8ClampedArray(f)}const l=t.cachedLut.lutArray,c=pQ(Array.isArray(e)?e[0]:e,Array.isArray(n)?n[0]:n,i);if(r)for(let f=o;f<=a;f++)l[f+-s]=255-c(f);else for(let f=o;f<=a;f++)l[f+-s]=c(f);return l}function eOe(t,e,n){let r=Fn();const i=t.voxelManager.getScalarData();t.stats.lastGetPixelDataTime=Fn()-r;const a=t.minPixelValue;let o=0,s=0;const l=i.length;if(r=Fn(),a<0)for(;s<l;)n[o++]=e[i[s++]+-a],n[o++]=e[i[s++]+-a],n[o++]=e[i[s++]+-a],n[o++]=255;else for(;s<l;)n[o++]=e[i[s++]],n[o++]=e[i[s++]],n[o++]=e[i[s++]],n[o++]=255;t.stats.lastStoredPixelDataToCanvasImageDataTime=Fn()-r}function tOe(t,e,n){let r=Fn();const i=t.getPixelData();t.stats.lastGetPixelDataTime=Fn()-r;const a=t.minPixelValue;let o=0,s=0;const l=i.length;if(r=Fn(),a<0)for(;s<l;)n[o++]=e[i[s++]+-a],n[o++]=e[i[s++]+-a],n[o++]=e[i[s++]+-a],n[o++]=i[s++];else for(;s<l;)n[o++]=e[i[s++]],n[o++]=e[i[s++]],n[o++]=e[i[s++]],n[o++]=i[s++];t.stats.lastStoredPixelDataToCanvasImageDataTime=Fn()-r}class Xm{constructor(){this.reset()}getMatrix(){return this.m}reset(){this.m=[1,0,0,1,0,0]}clone(){const e=new Xm;return e.m[0]=this.m[0],e.m[1]=this.m[1],e.m[2]=this.m[2],e.m[3]=this.m[3],e.m[4]=this.m[4],e.m[5]=this.m[5],e}multiply(e){const n=this.m[0]*e[0]+this.m[2]*e[1],r=this.m[1]*e[0]+this.m[3]*e[1],i=this.m[0]*e[2]+this.m[2]*e[3],a=this.m[1]*e[2]+this.m[3]*e[3],o=this.m[0]*e[4]+this.m[2]*e[5]+this.m[4],s=this.m[1]*e[4]+this.m[3]*e[5]+this.m[5];this.m[0]=n,this.m[1]=r,this.m[2]=i,this.m[3]=a,this.m[4]=o,this.m[5]=s}invert(){const e=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),n=this.m[3]*e,r=-this.m[1]*e,i=-this.m[2]*e,a=this.m[0]*e,o=e*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),s=e*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);this.m[0]=n,this.m[1]=r,this.m[2]=i,this.m[3]=a,this.m[4]=o,this.m[5]=s}rotate(e){const n=Math.cos(e),r=Math.sin(e),i=this.m[0]*n+this.m[2]*r,a=this.m[1]*n+this.m[3]*r,o=this.m[0]*-r+this.m[2]*n,s=this.m[1]*-r+this.m[3]*n;this.m[0]=i,this.m[1]=a,this.m[2]=o,this.m[3]=s}translate(e,n){this.m[4]+=this.m[0]*e+this.m[2]*n,this.m[5]+=this.m[1]*e+this.m[3]*n}scale(e,n){this.m[0]*=e,this.m[1]*=e,this.m[2]*=n,this.m[3]*=n}transformPoint(e){const n=e[0],r=e[1];return[n*this.m[0]+r*this.m[2]+this.m[4],n*this.m[1]+r*this.m[3]+this.m[5]]}}function Y2(t,e){const n=new Xm;if(!t.viewport.displayedArea)return n;n.translate(t.canvas.width/2,t.canvas.height/2);const r=t.viewport.rotation;r!==0&&n.rotate(r*Math.PI/180);let i=t.viewport.scale,a=t.viewport.scale;const o=t.viewport.displayedArea.brhc.x-(t.viewport.displayedArea.tlhc.x-1),s=t.viewport.displayedArea.brhc.y-(t.viewport.displayedArea.tlhc.y-1);if(t.viewport.displayedArea.presentationSizeMode==="NONE")t.image.rowPixelSpacing<t.image.columnPixelSpacing?i*=t.image.columnPixelSpacing/t.image.rowPixelSpacing:t.image.columnPixelSpacing<t.image.rowPixelSpacing&&(a*=t.image.rowPixelSpacing/t.image.columnPixelSpacing);else if(i=t.viewport.displayedArea.columnPixelSpacing,a=t.viewport.displayedArea.rowPixelSpacing,t.viewport.displayedArea.presentationSizeMode==="SCALE TO FIT"){const l=t.canvas.height/(s*a),c=t.canvas.width/(o*i);i=a=Math.min(c,l),t.viewport.displayedArea.rowPixelSpacing<t.viewport.displayedArea.columnPixelSpacing?i*=t.viewport.displayedArea.columnPixelSpacing/t.viewport.displayedArea.rowPixelSpacing:t.viewport.displayedArea.columnPixelSpacing<t.viewport.displayedArea.rowPixelSpacing&&(a*=t.viewport.displayedArea.rowPixelSpacing/t.viewport.displayedArea.columnPixelSpacing)}return n.scale(i,a),r!==0&&n.rotate(-r*Math.PI/180),n.translate(t.viewport.translation.x,t.viewport.translation.y),r!==0&&n.rotate(r*Math.PI/180),t.viewport.hflip&&n.scale(-1,1),t.viewport.vflip&&n.scale(1,-1),n.translate(-o/2,-s/2),n}function iO(t,e,n){if(t===void 0)throw new Error("setToPixelCoordinateSystem: parameter enabledElement must not be undefined");if(e===void 0)throw new Error("setToPixelCoordinateSystem: parameter context must not be undefined");const i=Y2(t).getMatrix();e.setTransform(i[0],i[1],i[2],i[3],i[4],i[5])}function aO(t,e){const n=t.renderingTools.lastRenderedImageId,r=t.renderingTools.lastRenderedViewport;return e.imageId!==n||!r||r.windowCenter!==t.viewport.voi.windowCenter||r.windowWidth!==t.viewport.voi.windowWidth||r.invert!==t.viewport.invert||r.rotation!==t.viewport.rotation||r.hflip!==t.viewport.hflip||r.vflip!==t.viewport.vflip||r.modalityLUT!==t.viewport.modalityLUT||r.voiLUT!==t.viewport.voiLUT||r.colormap!==t.viewport.colormap}function w3(t,e){const n=t.renderingTools.renderCanvas;n.width=e.width,n.height=e.height;const r=n.getContext("2d");r.fillStyle="white",r.fillRect(0,0,n.width,n.height);const i=r.getImageData(0,0,e.width,e.height);t.renderingTools.renderCanvasContext=r,t.renderingTools.renderCanvasData=i}function oO(t){const e=t.image.imageId,n=t.viewport,r=t.image.color;return t.renderingTools.lastRenderedImageId=e,t.renderingTools.lastRenderedIsColor=r,t.renderingTools.lastRenderedViewport={windowCenter:n.voi.windowCenter,windowWidth:n.voi.windowWidth,invert:n.invert,rotation:n.rotation,hflip:n.hflip,vflip:n.vflip,modalityLUT:n.modalityLUT,voiLUT:n.voiLUT,colormap:n.colormap},t.renderingTools}const gQ="viewport-element",mQ="cornerstone-canvas",Zg=1e-4;let j_;function Fy(t,e=512,n=512){const r=j_?j_(e,n):document.createElement("canvas");return t&&(r.style.position="absolute",r.style.width="100%",r.style.height="100%",r.style.imageRendering="pixelated",r.classList.add(mQ),t.appendChild(r)),r}function vQ(t){const e=document.createElement("div");return e.style.position="relative",e.style.width="100%",e.style.height="100%",e.style.overflow="hidden",e.classList.add(gQ),t.appendChild(e),e}function nOe(t){j_=t}function nl(t){const e=`canvas.${mQ}`,n=`div.${gQ}`,r=t.querySelector(n)||vQ(t),i=r.querySelector(e);if(i)return i;const a=Fy(r),o=r.getBoundingClientRect(),s=window.devicePixelRatio||1,l=Math.ceil(o.width*s),c=Math.ceil(o.height*s);return a.width=l,a.height=c,a}function rOe(t,e){return t.cachedLut!==void 0&&t.cachedLut.windowCenter===e.voi.windowCenter&&t.cachedLut.windowWidth===e.voi.windowWidth&&t.cachedLut.invert===e.invert||(Q7e(t,e.voi.windowWidth,e.voi.windowCenter,e.invert),t.cachedLut.windowWidth=e.voi.windowWidth,t.cachedLut.windowCenter=e.voi.windowCenter,t.cachedLut.invert=e.invert),t.cachedLut.lutArray}function iOe(t,e,n){const r=t.renderingTools.lastRenderedIsColor;(!t.renderingTools.renderCanvas||!r)&&(t.renderingTools.renderCanvas=Fy(null,e.width,e.height));const i=t.renderingTools.renderCanvas,{windowWidth:a,windowCenter:o}=t.viewport.voi;if((a===256||a===255)&&(o===128||o===127)&&!t.viewport.invert&&e.getCanvas&&e.getCanvas())return e.getCanvas();if(!aO(t,e)&&!n)return i;(!t.renderingTools.renderCanvasContext||i.width!==e.width||i.height!==e.height)&&w3(t,e);let s=Fn();const l=rOe(e,t.viewport);e.stats=e.stats||{},e.stats.lastLutGenerateTime=Fn()-s;const c=t.renderingTools.renderCanvasData,f=t.renderingTools.renderCanvasContext;return e.rgba?tOe(e,l,c.data):eOe(e,l,c.data),s=Fn(),f.putImageData(c,0,0),e.stats.lastPutImageDataTime=Fn()-s,i}function aOe(t,e){if(t===void 0)throw new Error("renderColorImage: enabledElement parameter must not be undefined");const n=t.image;if(n===void 0)throw new Error("renderColorImage: image must be loaded before it can be drawn");const r=t.canvas.getContext("2d");r.setTransform(1,0,0,1,0,0),r.fillStyle="black",r.fillRect(0,0,t.canvas.width,t.canvas.height),r.imageSmoothingEnabled=!t.viewport.pixelReplication,iO(t,r);const i=iOe(t,n,e),a=t.viewport.displayedArea.tlhc.x-1,o=t.viewport.displayedArea.tlhc.y-1,s=t.viewport.displayedArea.brhc.x-a,l=t.viewport.displayedArea.brhc.y-o;r.drawImage(i,a,o,s,l,0,0,s,l),t.renderingTools=oO(t)}function oOe(t,e,n){let r=Fn();const i=t.voxelManager.getScalarData();t.stats.lastGetPixelDataTime=Fn()-r;const a=i.length,o=t.minPixelValue;let s=3,l=0;if(r=Fn(),i instanceof Int16Array)if(o<0)for(;l<a;)n[s]=e[i[l++]+-o],s+=4;else for(;l<a;)n[s]=e[i[l++]],s+=4;else if(i instanceof Uint16Array)for(;l<a;)n[s]=e[i[l++]],s+=4;else if(o<0)for(;l<a;)n[s]=e[i[l++]+-o],s+=4;else for(;l<a;)n[s]=e[i[l++]],s+=4;t.stats.lastStoredPixelDataToCanvasImageDataTime=Fn()-r}function sOe(t,e,n){let r=Fn();const i=t.voxelManager.getScalarData();t.stats.lastGetPixelDataTime=Fn()-r;const a=i.length;let o=3,s=0;for(r=Fn();s<a;)n[o]=e(i[s++]),o+=4;t.stats.lastStoredPixelDataToCanvasImageDataTime=Fn()-r}function lOe(t,e,n){let r=Fn();const i=t.voxelManager.getScalarData();t.stats.lastGetPixelDataTime=Fn()-r;const a=i.length,o=t.minPixelValue;let s=0,l=0,c;if(r=Fn(),i instanceof Int16Array)if(o<0)for(;l<a;)c=e[i[l++]+-o],n[s++]=c,n[s++]=c,n[s++]=c,n[s++]=255;else for(;l<a;)c=e[i[l++]],n[s++]=c,n[s++]=c,n[s++]=c,n[s++]=255;else if(i instanceof Uint16Array)for(;l<a;)c=e[i[l++]],n[s++]=c,n[s++]=c,n[s++]=c,n[s++]=255;else if(o<0)for(;l<a;)c=e[i[l++]+-o],n[s++]=c,n[s++]=c,n[s++]=c,n[s++]=255;else for(;l<a;)c=e[i[l++]],n[s++]=c,n[s++]=c,n[s++]=c,n[s++]=255;t.stats.lastStoredPixelDataToCanvasImageDataTime=Fn()-r}function cOe(t,e){if(uOe(t))return;const n=e.maxPixelValue*e.slope+e.intercept,r=e.minPixelValue*e.slope+e.intercept,i=n-r,a=(n+r)/2;t.voi===void 0?t.voi={windowWidth:i,windowCenter:a,voiLUTFunction:e.voiLUTFunction}:(t.voi.windowWidth=i,t.voi.windowCenter=a)}function uOe(t){return t.voiLUT&&t.voiLUT.lut&&t.voiLUT.lut.length>0||t.voi.windowWidth!==void 0&&t.voi.windowCenter!==void 0}function nF(t,e){return!t&&!e?!0:!t||!e?!1:t.id===e.id}function fOe(t,e){return n=>n*t+e}function dOe(t){const e=t.lut[0],n=t.lut[t.lut.length-1],r=t.firstValueMapped+t.lut.length;return i=>i<t.firstValueMapped?e:i>=r?n:t.lut[i]}function hOe(t,e,n){return n?dOe(n):fOe(t,e)}function pOe(t,e,n,r,i,a){const o=t.maxPixelValue,s=t.minPixelValue,l=Math.min(s,0);if(t.cachedLut===void 0){const d=o-l+1;t.cachedLut={},t.cachedLut.lutArray=new Uint8ClampedArray(d)}const c=t.cachedLut.lutArray,f=hOe(t.slope,t.intercept,i),u=pQ(e,n,a);if(t.isPreScaled)if(r)for(let d=s;d<=o;d++)c[d+-l]=255-u(d);else for(let d=s;d<=o;d++)c[d+-l]=u(d);else if(r)for(let d=s;d<=o;d++)c[d+-l]=255-u(f(d));else for(let d=s;d<=o;d++)c[d+-l]=u(f(d));return c}function yQ(t,e,n){return t.cachedLut!==void 0&&t.cachedLut.windowCenter===e.voi.windowCenter&&t.cachedLut.windowWidth===e.voi.windowWidth&&nF(t.cachedLut.modalityLUT,e.modalityLUT)&&nF(t.cachedLut.voiLUT,e.voiLUT)&&t.cachedLut.invert===e.invert&&!n||(cOe(e,t),pOe(t,e.voi.windowWidth,e.voi.windowCenter,e.invert,e.modalityLUT,e.voiLUT),t.cachedLut.windowWidth=e.voi.windowWidth,t.cachedLut.windowCenter=e.voi.windowCenter,t.cachedLut.invert=e.invert,t.cachedLut.voiLUT=e.voiLUT,t.cachedLut.modalityLUT=e.modalityLUT),t.cachedLut.lutArray}function gOe(t,e,n,r=!0){const i=t.renderingTools.lastRenderedIsColor;(!t.renderingTools.renderCanvas||i)&&(t.renderingTools.renderCanvas=Fy(null,e.width,e.height),w3(t,e));const a=t.renderingTools.renderCanvas;if(!aO(t,e)&&!n)return a;(a.width!==e.width||a.height!==e.height)&&w3(t,e),e.stats=e.stats||{};const o=t.renderingTools.renderCanvasData,s=t.renderingTools.renderCanvasContext;let l=Fn();e.stats.lastLutGenerateTime=Fn()-l;const{viewport:c}=t;if(c.modality==="PT"&&e.isPreScaled){const{windowWidth:f,windowCenter:u}=c.voi,d=u-f/2,g=255/(u+f/2-d);let m;c.invert?m=y=>255-(y-d)*g:m=y=>(y-d)*g,sOe(e,m,o.data)}else{const f=yQ(e,c,n);r?oOe(e,f,o.data):lOe(e,f,o.data)}return l=Fn(),s.putImageData(o,0,0),e.stats.lastPutImageDataTime=Fn()-l,a}function mOe(t,e){if(t===void 0)throw new Error("drawImage: enabledElement parameter must not be undefined");const n=t.image;if(n===void 0)throw new Error("drawImage: image must be loaded before it can be drawn");const r=t.canvas.getContext("2d");r.setTransform(1,0,0,1,0,0),r.fillStyle="black",r.fillRect(0,0,t.canvas.width,t.canvas.height),r.imageSmoothingEnabled=!t.viewport.pixelReplication,iO(t,r);const i=gOe(t,n,e),a=t.viewport.displayedArea.tlhc.x-1,o=t.viewport.displayedArea.tlhc.y-1,s=t.viewport.displayedArea.brhc.x-a,l=t.viewport.displayedArea.brhc.y-o;r.drawImage(i,a,o,s,l,0,0,s,l),t.renderingTools=oO(t)}const z_=0,W_=1,vOe=2;function yOe(t,e,n){if(t>1)throw new Error("HSVToRGB expects hue < 1");const r=[];if(e===0)return r[0]=n,r[1]=n,r[2]=n,r;const i=Math.floor(t*6),a=6*t-i,o=n*(1-e),s=n*(1-e*a),l=n*(1-e*(1-a));switch(i){case 0:case 6:r[0]=n,r[1]=l,r[2]=o;break;case 1:r[0]=s,r[1]=n,r[2]=o;break;case 2:r[0]=o,r[1]=n,r[2]=l;break;case 3:r[0]=o,r[1]=s,r[2]=n;break;case 4:r[0]=l,r[1]=o,r[2]=n;break;case 5:r[0]=n,r[1]=o,r[2]=s;break}return r}function xOe(t,e){let n;return t<e.Range[0]?n=e.MaxIndex+z_+1.5:t>e.Range[1]?n=e.MaxIndex+W_+1.5:n=(t+e.Shift)*e.Scale,Math.floor(n)}class sO{constructor(){this.NumberOfColors=256,this.Ramp="linear",this.TableRange=[0,255],this.HueRange=[0,.66667],this.SaturationRange=[1,1],this.ValueRange=[1,1],this.AlphaRange=[1,1],this.NaNColor=[128,0,0,255],this.BelowRangeColor=[0,0,0,255],this.UseBelowRangeColor=!0,this.AboveRangeColor=[255,255,255,255],this.UseAboveRangeColor=!0,this.InputRange=[0,255],this.Table=[]}setNumberOfTableValues(e){this.NumberOfColors=e}setRamp(e){this.Ramp=e}setTableRange(e,n){this.TableRange[0]=e,this.TableRange[1]=n}setHueRange(e,n){this.HueRange[0]=e,this.HueRange[1]=n}setSaturationRange(e,n){this.SaturationRange[0]=e,this.SaturationRange[1]=n}setValueRange(e,n){this.ValueRange[0]=e,this.ValueRange[1]=n}setRange(e,n){this.InputRange[0]=e,this.InputRange[1]=n}setAlphaRange(e,n){this.AlphaRange[0]=e,this.AlphaRange[1]=n}getColor(e){return this.mapValue(e)}build(e){if(this.Table.length>1&&!e)return;this.Table=[];const n=this.NumberOfColors-1;let r,i,a,o;n?(r=(this.HueRange[1]-this.HueRange[0])/n,i=(this.SaturationRange[1]-this.SaturationRange[0])/n,a=(this.ValueRange[1]-this.ValueRange[0])/n,o=(this.AlphaRange[1]-this.AlphaRange[0])/n):r=i=a=o=0;for(let s=0;s<=n;s++){const l=this.HueRange[0]+s*r,c=this.SaturationRange[0]+s*i,f=this.ValueRange[0]+s*a,u=this.AlphaRange[0]+s*o,d=yOe(l,c,f),h=[0,0,0,0];switch(this.Ramp){case"scurve":h[0]=Math.floor(127.5*(1+Math.cos((1-d[0])*Math.PI))),h[1]=Math.floor(127.5*(1+Math.cos((1-d[1])*Math.PI))),h[2]=Math.floor(127.5*(1+Math.cos((1-d[2])*Math.PI))),h[3]=Math.floor(u*255);break;case"linear":h[0]=Math.floor(d[0]*255+.5),h[1]=Math.floor(d[1]*255+.5),h[2]=Math.floor(d[2]*255+.5),h[3]=Math.floor(u*255+.5);break;case"sqrt":h[0]=Math.floor(Math.sqrt(d[0])*255+.5),h[1]=Math.floor(Math.sqrt(d[1])*255+.5),h[2]=Math.floor(Math.sqrt(d[2])*255+.5),h[3]=Math.floor(Math.sqrt(u)*255+.5);break;default:throw new Error(`Invalid Ramp value (${this.Ramp})`)}this.Table.push(h)}this.buildSpecialColors()}buildSpecialColors(){const e=this.NumberOfColors,n=e+z_,r=e+W_,i=e+vOe;this.UseBelowRangeColor||e===0?this.Table[n]=this.BelowRangeColor:this.Table[n]=this.Table[0],this.UseAboveRangeColor||e===0?this.Table[r]=this.AboveRangeColor:this.Table[r]=this.Table[e-1],this.Table[i]=this.NaNColor}mapValue(e){const n=this.getIndex(e);if(n<0)return this.NaNColor;if(n===0){if(this.UseBelowRangeColor&&e<this.TableRange[0])return this.BelowRangeColor}else if(n===this.NumberOfColors-1&&this.UseAboveRangeColor&&e>this.TableRange[1])return this.AboveRangeColor;return this.Table[n]}getIndex(e){const n={Range:[],MaxIndex:this.NumberOfColors-1,Shift:-this.TableRange[0],Scale:1};if(this.TableRange[1]<=this.TableRange[0]?n.Scale=Number.MAX_VALUE:n.Scale=n.MaxIndex/(this.TableRange[1]-this.TableRange[0]),n.Range[0]=this.TableRange[0],n.Range[1]=this.TableRange[1],isNaN(e))return-1;let r=xOe(e,n);return r===this.NumberOfColors+z_?r=0:r===this.NumberOfColors+W_&&(r=this.NumberOfColors-1),r}setTableValue(e,n,r,i,a){let o;if(typeof n=="number"&&r!==void 0&&i!==void 0&&a!==void 0)o=[n,r,i,a];else if(Array.isArray(n))o=n;else throw new Error("Invalid arguments for setTableValue");if(e<0)throw new Error(`Can't set the table value for negative index (${e})`);if(e>=this.NumberOfColors)throw new Error(`Index ${e} is greater than the number of colors ${this.NumberOfColors}`);this.Table[e]=o,(e===0||e===this.NumberOfColors-1)&&this.buildSpecialColors()}}const rF=[0,0,0,0];function bOe(t,e,n){n=n===null?100:n;const r=(e-t)/(n-1),i=[];for(;n-- >0;)i.push(t),t+=r;return i[i.length-1]=e,i}function wOe(t,e){let n=0,r=t.length-1;for(;n<=r;){const i=n+Math.floor((r-n)/2),a=t[i];if(a===e)return i;e<a?r=i-1:n=i+1}return n}function COe(t,e){let n;const r=[],i=e.length;for(t.sort(function(a,o){return a-o}),n=0;n<i;n++)r[n]=wOe(t,e[n]);return r}function n8(t,e,n){let r;const i=[],a=[],o=[],s=[];for(n=n===null?1:n,r=0;r<e.length;r++){const f=e[r];i.push((t-1)*f[0]),a.push(f[1]),o.push(f[1])}const l=bOe(0,1,t);for(r=0;r<t;r++)l[r]=(t-1)*Math.pow(l[r],n);const c=COe(i,l);for(r=1;r<t-1;r++){const f=c[r],u=(l[r]-i[f-1])/(i[f]-i[f-1]),d=a[f]-o[f-1];s[r]=u*d+o[f-1]}return s[0]=o[0],s[t-1]=a[e.length-1],s}function SOe(t,e,n){let r;const i=[];e=e===null?256:e,n=n===null?1:n;const a=n8(e,t.red,n),o=n8(e,t.green,n),s=n8(e,t.blue,n);for(r=0;r<e;r++){const l=Math.round(a[r]*255),c=Math.round(o[r]*255),f=Math.round(s[r]*255),u=[l,c,f,255];i.push(u)}return i}function TOe(t,e){let n=f_[t];return n||(n=f_[t]={name:"",colors:[]}),!n.colors&&n.segmentedData&&(n.colors=SOe(n.segmentedData,n.numColors,n.gamma)),{getId(){return t},getColorSchemeName(){return n.name},setColorSchemeName(i){n.name=i},getNumberOfColors(){return n.colors.length},setNumberOfColors(i){for(;n.colors.length<i;)n.colors.push(rF);n.colors.length=i},getColor(i){return this.isValidIndex(i)?n.colors[i]:rF},getColorRepeating(i){const a=n.colors.length;return i=a?i%a:0,this.getColor(i)},setColor(i,a){this.isValidIndex(i)&&(n.colors[i]=a)},addColor(i){n.colors.push(i)},insertColor(i,a){this.isValidIndex(i)&&n.colors.splice(i,1,a)},removeColor(i){this.isValidIndex(i)&&n.colors.splice(i,1)},clearColors(){n.colors=[]},buildLookupTable(i){if(!i)return;const a=n.colors.length;i.setNumberOfTableValues(a);for(let o=0;o<a;o++)i.setTableValue(o,n.colors[o])},createLookupTable(){const i=new sO;return this.buildLookupTable(i),i},isValidIndex(i){return i>=0&&i<n.colors.length}}}function EOe(t,e,n,r){let i=Fn();const a=t.voxelManager.getScalarData();t.stats.lastGetPixelDataTime=Fn()-i;const o=a.length,s=t.minPixelValue;let l=0,c=0,f,u,d;if(i=Fn(),n instanceof sO?d=n.Table:d=n,s<0)for(;c<o;)f=e[a[c++]+-s],u=d[f],r[l++]=u[0],r[l++]=u[1],r[l++]=u[2],r[l++]=u[3];else for(;c<o;)f=e[a[c++]],u=d[f],r[l++]=u[0],r[l++]=u[1],r[l++]=u[2],r[l++]=u[3];t.stats.lastStoredPixelDataToCanvasImageDataTime=Fn()-i}function _Oe(t,e,n,r){let i=Fn();const a=t.voxelManager.getScalarData();t.stats.lastGetPixelDataTime=Fn()-i;const o=a.length,s=t.minPixelValue;let l=0,c=0,f,u,d;if(i=Fn(),n instanceof sO?d=n.Table:d=n,s<0)for(;c<o;)f=e(a[c++]+-s),u=d[f],r[l++]=u[0],r[l++]=u[1],r[l++]=u[2],r[l++]=u[3];else for(;c<o;)f=e(a[c++]),u=d[f],r[l++]=u[0],r[l++]=u[1],r[l++]=u[2],r[l++]=u[3];t.stats.lastStoredPixelDataToCanvasImageDataTime=Fn()-i}function H_(t,e,n){return Math.max(e,Math.min(n,t))}function DOe(t,e,n){t.renderingTools.renderCanvas||(t.renderingTools.renderCanvas=Fy(null,e.width,e.height));const r=t.renderingTools.renderCanvas;let i=t.viewport.colormap||t.options.colormap;if(t.options&&t.options.colormap&&console.warn("enabledElement.options.colormap is deprecated. Use enabledElement.viewport.colormap instead"),i&&typeof i=="string"&&(i=TOe(i)),!i)throw new Error("renderPseudoColorImage: colormap not found.");const a=i.getId();if(!aO(t,e)&&!n&&t.renderingTools.colormapId===a)return r;(!t.renderingTools.renderCanvasContext||r.width!==e.width||r.height!==e.height)&&w3(t,e);let o=Fn();(!t.renderingTools.colorLUT||n||t.renderingTools.colormapId!==a)&&(i.setNumberOfColors(256),t.renderingTools.colorLUT=i.createLookupTable(),t.renderingTools.colormapId=a);const s=t.renderingTools.renderCanvasData,l=t.renderingTools.renderCanvasContext,{viewport:c}=t,f=t.renderingTools.colorLUT;if(c.modality==="PT"){const{windowWidth:u,windowCenter:d}=c.voi,h=d-u/2,m=255/(d+u/2-h);let y;c.invert?y=v=>H_(Math.floor(255-(v-h)*m),0,255):y=v=>H_(Math.floor((v-h)*m),0,255),_Oe(e,y,f,s.data)}else{const u=yQ(e,t.viewport,n);e.stats=e.stats||{},e.stats.lastLutGenerateTime=Fn()-o,EOe(e,u,f,s.data)}return o=Fn(),l.putImageData(s,0,0),e.stats.lastPutImageDataTime=Fn()-o,r}function OOe(t,e){if(t===void 0)throw new Error("drawImage: enabledElement parameter must not be undefined");const n=t.image;if(n===void 0)throw new Error("drawImage: image must be loaded before it can be drawn");const r=t.canvas.getContext("2d");r.setTransform(1,0,0,1,0,0),r.fillStyle="black",r.fillRect(0,0,t.canvas.width,t.canvas.height),r.imageSmoothingEnabled=!t.viewport.pixelReplication,iO(t,r);const i=DOe(t,n,e),a=t.viewport.displayedArea.tlhc.x-1,o=t.viewport.displayedArea.tlhc.y-1,s=t.viewport.displayedArea.brhc.x-a,l=t.viewport.displayedArea.brhc.y-o;r.drawImage(i,a,o,s,l,0,0,s,l),t.renderingTools=oO(t)}function xQ(t,e){const n=t.image;if(!t.canvas||!t.image)return;const r=Fn();if(n.stats={lastGetPixelDataTime:-1,lastStoredPixelDataToCanvasImageDataTime:-1,lastPutImageDataTime:-1,lastRenderTime:-1,lastLutGenerateTime:-1},n){let a=n.render;a||(t.viewport.colormap?a=OOe:n.color?a=aOe:a=mOe),a(t,e)}const i=Fn()-r;n.stats.lastRenderTime=i,t.invalid=!1,t.needsRedraw=!1}function bQ(t){return Y2(t)}function Zx(t,e){const n=bQ(t);return n.invert(),n.transformPoint(e)}const MOe={viewport:{}};function IOe(){return{tlhc:{x:1,y:1},brhc:{x:1,y:1},rowPixelSpacing:1,columnPixelSpacing:1,presentationSizeMode:"NONE"}}function ROe(){const t=IOe(),e={scale:1,translation:{x:0,y:0},voi:{windowWidth:void 0,windowCenter:void 0,voiLUTFunction:po.LINEAR},invert:!1,pixelReplication:!1,rotation:0,hflip:!1,vflip:!1,modalityLUT:void 0,voiLUT:void 0,colormap:void 0,labelmap:!1,displayedArea:t};return Object.assign({},e,MOe.viewport)}function s2(t,e){if(t==null)throw new Error(e)}function POe(t){return!(t==null||t===0||t===180)}function wQ(t,e=null){return s2(t,"getImageSize: parameter image must not be undefined"),s2(t.width,"getImageSize: parameter image must have width"),s2(t.height,"getImageSize: parameter image must have height"),POe(e)?{height:t.width,width:t.height}:{width:t.width,height:t.height}}function lO(t,e,n=null){s2(t,"getImageScale: parameter canvas must not be undefined"),s2(e,"getImageScale: parameter image must not be undefined");const r=wQ(e,n),i=e.rowPixelSpacing||1,a=e.columnPixelSpacing||1;let o=1,s=1;i<a?s=a/i:o=i/a;const l=t.height/r.height/o,c=t.width/r.width/s;return{verticalScale:l,horizontalScale:c,scaleFactor:Math.min(c,l)}}function CQ(t,e,n,r){if(t===void 0)throw new Error("getDefaultViewport: parameter canvas must not be undefined");if(e===void 0)return ROe();const i=lO(t,e,0).scaleFactor;let a;return n==="PT"&&e.isPreScaled?a={windowWidth:5,windowCenter:2.5}:e.windowWidth!==void 0&&e.windowCenter!==void 0&&(a={windowWidth:Array.isArray(e.windowWidth)?e.windowWidth[0]:e.windowWidth,windowCenter:Array.isArray(e.windowCenter)?e.windowCenter[0]:e.windowCenter}),{scale:i,translation:{x:0,y:0},voi:a,invert:e.invert,pixelReplication:!1,rotation:0,hflip:!1,vflip:!1,modalityLUT:e.modalityLUT,modality:n,voiLUT:e.voiLUT,colormap:r!==void 0?r:e.colormap,displayedArea:{tlhc:{x:1,y:1},brhc:{x:e.columns,y:e.rows},rowPixelSpacing:e.rowPixelSpacing===void 0?1:e.rowPixelSpacing,columnPixelSpacing:e.columnPixelSpacing===void 0?1:e.columnPixelSpacing,presentationSizeMode:"NONE"}}}function iF(t,e){return bQ(t).transformPoint(e)}function AOe(t){const{image:e}=t;t.viewport.scale=lO(t.canvas,e,t.viewport.rotation).scaleFactor,t.viewport.translation.x=0,t.viewport.translation.y=0}function NOe(t){const{canvas:e}=t,{clientWidth:n,clientHeight:r}=e;(e.width!==n||e.height!==r)&&(e.width=n,e.height=r)}function LOe(t,e,n){const r=t.viewport.scale,i=wQ(t.image,t.viewport.rotation),a=Math.round(i.width*r),o=Math.round(i.height*r),s=t.viewport.translation.x,l=t.viewport.translation.y;return a===e&&o<=n||a<=e&&o===n&&s===0&&l===0}function kOe(t,e,n){const r=t.viewport.scale,i=t.canvas.width,a=t.canvas.height,o=i/e,s=a/n,l=Math.sqrt(o*s);t.viewport.scale=l*r}function VOe(t,e=!1){const n=t.canvas.width,r=t.canvas.height;NOe(t),t.image!==void 0&&(e||LOe(t,n,r)?AOe(t):kOe(t,n,r))}function FOe(t,e){const{hflip:n,vflip:r,rotation:i}=e;if(t.x*=n?-1:1,t.y*=r?-1:1,i!==0){const a=i*Math.PI/180,o=Math.cos(a),s=Math.sin(a),l=t.x*o-t.y*s,c=t.x*s+t.y*o;t.x=l,t.y=c}return t}function UOe(t,e=!0,n=!0){const{canvas:r,image:i,viewport:a}=t,o=lO(r,i,0).scaleFactor;a.vflip=!1,a.hflip=!1,e&&(a.translation.x=0,a.translation.y=0),n&&(a.displayedArea.tlhc.x=1,a.displayedArea.tlhc.y=1,a.displayedArea.brhc.x=i.columns,a.displayedArea.brhc.y=i.rows,a.scale=o)}const aF=rO.getLogger("utilities","getClosestImageId");function $h(t,e,n,r){const{direction:i,spacing:a,imageIds:o}=t,{ignoreSpacing:s=!1}=r||{};if(!o?.length)return;const l=i.slice(6,9),c=zt(l,n);if(Math.abs(c)<1-al)return;let f;s||(f=Jh({direction:i,spacing:a},n)/2);let u,d=1/0;for(let h=0;h<o.length;h++){const p=o[h],g=Ut("imagePlaneModule",p);if(!g?.imagePositionPatient){aF.warn(`Missing imagePositionPatient for imageId: ${p}`);continue}const{imagePositionPatient:m}=g,y=it();dr(y,e,m);const v=Math.abs(zt(y,n));s?v<d&&(d=v,u=p):v<f&&v<d&&(d=v,u=p)}return u===void 0&&aF.warn("No imageId found within the specified criteria (half spacing or absolute closest)."),u}function BOe(t,e){const n=zt(t,e),r=tl(it(),e,2*n);return dr(it(),t,r)}function oF(t,e,n,r){let i=hX(t);if(n&&cu(i,i),e){const a=gr(it(),r,i);Lr(a,a),i=BOe(i,a)}return i}const sF=rO.getLogger("RenderingEngine","StackViewport");class fa extends Bh{constructor(e){super(e),this.imageIds=[],this.imageKeyToIndexMap=new Map,this.currentImageIdIndex=0,this.targetImageIdIndex=0,this.imagesLoader=this,this.globalDefaultProperties={},this.perImageIdDefaultProperties=new Map,this.voiUpdatedWithSetProperties=!1,this.invert=!1,this.initialInvert=!1,this.initialTransferFunctionNodes=null,this.stackInvalidated=!1,this._publishCalibratedEvent=!1,this.updateRenderingPipeline=()=>{this._configureRenderingPipeline()},this.resize=()=>{this.useCPURendering&&this._resizeCPU()},this._resizeCPU=()=>{this._cpuFallbackEnabledElement.viewport&&VOe(this._cpuFallbackEnabledElement)},this.getFrameOfReferenceUID=n=>this.getImagePlaneReferenceData(n)?.FrameOfReferenceUID,this.getCornerstoneImage=()=>this.csImage,this.createActorMapper=n=>{const r=D7e.newInstance();r.setInputData(n);const i=V7e.newInstance();i.setMapper(r);const{preferSizeOverAccuracy:a}=Vf().rendering;return a&&r.setPreferSizeOverAccuracy(!0),n.getPointData().getScalars().getNumberOfComponents()>1&&i.getProperty().setIndependentComponents(!1),i},this.getNumberOfSlices=()=>this.imageIds.length,this.getDefaultProperties=n=>{let r;return n!==void 0&&(r=this.perImageIdDefaultProperties.get(n)),r!==void 0?r:{...this.globalDefaultProperties}},this.getProperties=()=>{const{colormap:n,voiRange:r,VOILUTFunction:i,interpolationType:a,invert:o,voiUpdatedWithSetProperties:s}=this;return{colormap:n,voiRange:r,VOILUTFunction:i,interpolationType:a,invert:o,isComputedVOI:!s}},this.resetCameraForResize=()=>this.resetCamera({resetPan:!0,resetZoom:!0,resetToCenter:!0,suppressEvents:!0}),this.getRotationCPU=()=>{const{viewport:n}=this._cpuFallbackEnabledElement;return n.rotation},this.getRotationGPU=()=>{const{viewUp:n,viewPlaneNormal:r,flipVertical:i,flipHorizontal:a}=this.getCameraNoRotation(),o=oF(this.initialViewUp,a,i,r),l=gX(o,n)*180/Math.PI,c=gr(it(),o,n);return zt(c,r)>=0?l:(360-l)%360},this.setRotation=n=>{const r=this.getCamera();if(this.useCPURendering?this.setRotationCPU(n):this.setRotationGPU(n),this._suppressCameraModifiedEvents)return;const i=this.getCamera(),a={previousCamera:r,camera:i,element:this.element,viewportId:this.id,renderingEngineId:this.renderingEngineId};wt(this.element,mt.CAMERA_MODIFIED,a)},this.renderImageObject=n=>{this._setCSImage(n),(this.useCPURendering?this._updateToDisplayImageCPU:this._updateActorToDisplayImageId).call(this,n)},this._setCSImage=n=>{n.isPreScaled=n.preScale?.scaled,this.csImage=n},this.canvasToWorldCPU=(n,r=[0,0,0])=>{if(!this._cpuFallbackEnabledElement.image)return;const[i,a]=Zx(this._cpuFallbackEnabledElement,n),{origin:o,spacing:s,direction:l}=this.getImageData(),c=l.slice(0,3),f=l.slice(3,6);return Ar(r,o,c,i*s[0]),Ar(r,r,f,a*s[1]),r},this.worldToCanvasCPU=n=>{const{spacing:r,direction:i,origin:a}=this.getImageData(),o=i.slice(0,3),s=i.slice(3,6),l=Pr(it(),n,a),c=[zt(l,o)/r[0],zt(l,s)/r[1]];return iF(this._cpuFallbackEnabledElement,c)},this.canvasToWorldGPUContextPool=n=>{const r=this.getRenderer(),i=this.getVtkActiveCamera(),a=i.getClippingRange(),o=i.getDistance();i.setClippingRange(o,o+.1);const s=window.devicePixelRatio||1,{width:l,height:c}=this.canvas,f=l/c,u=[n[0]*s,n[1]*s],d=[u[0]/l,1-u[1]/c,0],h=r.normalizedDisplayToProjection(d[0],d[1],d[2]),p=r.projectionToView(h[0],h[1],h[2],f),g=r.viewToWorld(p[0],p[1],p[2]);return i.setClippingRange(a[0],a[1]),[g[0],g[1],g[2]]},this.canvasToWorldGPUTiled=n=>{const r=this.getRenderer(),i=this.getVtkActiveCamera(),a=i.getClippingRange(),o=i.getDistance();i.setClippingRange(o,o+.1);const l=this.getRenderingEngine().offscreenMultiRenderWindow.getOpenGLRenderWindow(),c=l.getSize(),f=window.devicePixelRatio||1,u=[n[0]*f,n[1]*f],d=[u[0]+this.sx,u[1]+this.sy];d[1]=c[1]-d[1];const h=l.displayToWorld(d[0],d[1],0,r);return i.setClippingRange(a[0],a[1]),[h[0],h[1],h[2]]},this.worldToCanvasGPUContextPool=n=>{const r=this.getRenderer(),i=this.getVtkActiveCamera(),a=i.getClippingRange(),o=i.getDistance();i.setClippingRange(o,o+.1);const s=window.devicePixelRatio||1,{width:l,height:c}=this.canvas,f=l/c,u=r.worldToView(n[0],n[1],n[2]),d=r.viewToProjection(u[0],u[1],u[2],f),h=r.projectionToNormalizedDisplay(d[0],d[1],d[2]),p=h[0]*l,g=(1-h[1])*c;return i.setClippingRange(a[0],a[1]),[p/s,g/s]},this.worldToCanvasGPUTiled=n=>{const r=this.getRenderer(),i=this.getVtkActiveCamera(),a=i.getClippingRange(),o=i.getDistance();i.setClippingRange(o,o+.1);const l=this.getRenderingEngine().offscreenMultiRenderWindow.getOpenGLRenderWindow(),c=l.getSize(),f=l.worldToDisplay(...n,r);f[1]=c[1]-f[1];const u=[f[0]-this.sx,f[1]-this.sy];i.setClippingRange(a[0],a[1]);const d=window.devicePixelRatio||1;return[u[0]/d,u[1]/d]},this.getCurrentImageIdIndex=()=>this.currentImageIdIndex,this.getSliceIndex=()=>this.currentImageIdIndex,this.getTargetImageIdIndex=()=>this.targetImageIdIndex,this.getImageIds=()=>this.imageIds,this.getCurrentImageId=(n=this.getCurrentImageIdIndex())=>this.imageIds[n],this.hasImageId=n=>this.imageKeyToIndexMap.has(n),this.hasImageURI=n=>this.imageKeyToIndexMap.has(n),this.customRenderViewportToCanvas=()=>{if(!this.useCPURendering)throw new Error("Custom cpu rendering pipeline should only be hit in CPU rendering mode");return this._cpuFallbackEnabledElement.image?(xQ(this._cpuFallbackEnabledElement,this.cpuRenderingInvalidated),this.cpuRenderingInvalidated=!1):this.fillWithBackgroundColor(),{canvas:this.canvas,element:this.element,viewportId:this.id,renderingEngineId:this.renderingEngineId,viewportStatus:this.viewportStatus}},this.renderingPipelineFunctions={getImageData:{cpu:this.getImageDataCPU,gpu:this.getImageDataGPU},setColormap:{cpu:this.setColormapCPU,gpu:this.setColormapGPU},getCamera:{cpu:this.getCameraCPU,gpu:super.getCamera},setCamera:{cpu:this.setCameraCPU,gpu:super.setCamera},getPan:{cpu:this.getPanCPU,gpu:super.getPan},setPan:{cpu:this.setPanCPU,gpu:super.setPan},getZoom:{cpu:this.getZoomCPU,gpu:super.getZoom},setZoom:{cpu:this.setZoomCPU,gpu:super.setZoom},setVOI:{cpu:this.setVOICPU,gpu:this.setVOIGPU},getRotation:{cpu:this.getRotationCPU,gpu:this.getRotationGPU},setInterpolationType:{cpu:this.setInterpolationTypeCPU,gpu:this.setInterpolationTypeGPU},setInvertColor:{cpu:this.setInvertColorCPU,gpu:this.setInvertColorGPU},resetCamera:{cpu:(n={})=>{const{resetPan:r=!0,resetZoom:i=!0}=n;return this.resetCameraCPU({resetPan:r,resetZoom:i}),!0},gpu:(n={})=>{const{resetPan:r=!0,resetZoom:i=!0}=n;return this.resetCameraGPU({resetPan:r,resetZoom:i}),!0}},canvasToWorld:{cpu:this.canvasToWorldCPU,gpu:{tiled:this.canvasToWorldGPUTiled,contextPool:this.canvasToWorldGPUContextPool}},worldToCanvas:{cpu:this.worldToCanvasCPU,gpu:{tiled:this.worldToCanvasGPUTiled,contextPool:this.worldToCanvasGPUContextPool}},getRenderer:{cpu:()=>this.getCPUFallbackError("getRenderer"),gpu:{tiled:this.getRendererTiled,contextPool:this.getRendererContextPool}},getDefaultActor:{cpu:()=>this.getCPUFallbackError("getDefaultActor"),gpu:super.getDefaultActor},getActors:{cpu:()=>this.getCPUFallbackError("getActors"),gpu:super.getActors},getActor:{cpu:()=>this.getCPUFallbackError("getActor"),gpu:super.getActor},setActors:{cpu:()=>this.getCPUFallbackError("setActors"),gpu:super.setActors},addActors:{cpu:()=>this.getCPUFallbackError("addActors"),gpu:super.addActors},addActor:{cpu:()=>this.getCPUFallbackError("addActor"),gpu:super.addActor},removeAllActors:{cpu:()=>this.getCPUFallbackError("removeAllActors"),gpu:super.removeAllActors},unsetColormap:{cpu:this.unsetColormapCPU,gpu:this.unsetColormapGPU}},this.scaling={},this.modality=null,this.useCPURendering=Gg(),this._configureRenderingPipeline(),this.useCPURendering?this._resetCPUFallbackElement():this._resetGPUViewport(),this.currentImageIdIndex=0,this.targetImageIdIndex=0,this.resetCamera(),this.initializeElementDisabledHandler()}setUseCPURendering(e){this.useCPURendering=e,this._configureRenderingPipeline(e)}static get useCustomRenderingPipeline(){return Gg()}_configureRenderingPipeline(e){const n=oQ();this.useCPURendering=e??Gg();for(const r in this.renderingPipelineFunctions)if(Object.prototype.hasOwnProperty.call(this.renderingPipelineFunctions,r)){const i=this.renderingPipelineFunctions[r];this.useCPURendering?this[r]=i.cpu:typeof i.gpu=="object"&&i.gpu.tiled&&i.gpu.contextPool?this[r]=n?i.gpu.contextPool:i.gpu.tiled:this[r]=i.gpu}this.useCPURendering?this._resetCPUFallbackElement():this._resetGPUViewport()}_resetCPUFallbackElement(){this._cpuFallbackEnabledElement={canvas:this.canvas,renderingTools:{},transform:new Xm,viewport:{rotation:0}}}_resetGPUViewport(){const e=this.getRenderer(),n=$7.newInstance();e.setActiveCamera(n),this.initialViewUp=[0,-1,0],n.setDirectionOfProjection(-0,-0,1),n.setViewUp(...this.initialViewUp),n.setParallelProjection(!0),n.setThicknessFromFocalPoint(.1),n.setFreezeFocalPoint(!0)}initializeElementDisabledHandler(){vt.addEventListener(mt.ELEMENT_DISABLED,function e(){clearTimeout(this.debouncedTimeout),vt.removeEventListener(mt.ELEMENT_DISABLED,e)})}getImageDataGPU(){const e=this.getDefaultActor();if(!e||!gc(e))return;const{actor:n}=e,r=n.getMapper().getInputData(),i=this.csImage;return{dimensions:r.getDimensions(),spacing:r.getSpacing(),origin:r.getOrigin(),direction:r.getDirection(),get scalarData(){return i?.voxelManager.getScalarData()},imageData:n.getMapper().getInputData(),metadata:{Modality:this.modality,FrameOfReferenceUID:this.getFrameOfReferenceUID()},scaling:this.scaling,hasPixelSpacing:this.hasPixelSpacing,calibration:{...i?.calibration,...this.calibration},preScale:{...i?.preScale},voxelManager:i?.voxelManager}}getImageDataCPU(){const{metadata:e}=this._cpuFallbackEnabledElement;if(!e)return;const n=e.spacing,r=this.csImage;return{dimensions:e.dimensions,spacing:n,origin:e.origin,direction:e.direction,metadata:{Modality:this.modality,FrameOfReferenceUID:this.getFrameOfReferenceUID()},scaling:this.scaling,imageData:{getDirection:()=>e.direction,getDimensions:()=>e.dimensions,getScalarData:()=>this.cpuImagePixelData,getSpacing:()=>n,worldToIndex:i=>{const a=this.worldToCanvasCPU(i),o=Zx(this._cpuFallbackEnabledElement,a);return[o[0],o[1],0]},indexToWorld:(i,a)=>{const o=iF(this._cpuFallbackEnabledElement,[i[0],i[1]]);return this.canvasToWorldCPU(o,a)}},scalarData:this.cpuImagePixelData,hasPixelSpacing:this.hasPixelSpacing,calibration:{...r?.calibration,...this.calibration},preScale:{...r?.preScale},voxelManager:r?.voxelManager}}calibrateIfNecessary(e,n){const r=Ut("calibratedPixelSpacing",e),i=this.calibration!==r,{scale:a}=r||{};return this.hasPixelSpacing=a>0||n.rowPixelSpacing>0,n.calibration=r,i&&(this.calibration=r,this._publishCalibratedEvent=!0,this._calibrationEvent={scale:a,calibration:r}),n}setDefaultProperties(e,n){n==null?this.globalDefaultProperties=e:(this.perImageIdDefaultProperties.set(n,e),this.getCurrentImageId()===n&&this.setProperties(e))}clearDefaultProperties(e){e==null?(this.globalDefaultProperties={},this.resetProperties()):(this.perImageIdDefaultProperties.delete(e),this.resetToDefaultProperties())}setProperties({colormap:e,voiRange:n,VOILUTFunction:r,invert:i,interpolationType:a}={},o=!1){this.viewportStatus=this.csImage?Io.PRE_RENDER:Io.LOADING,this.globalDefaultProperties={colormap:this.globalDefaultProperties.colormap??e,voiRange:this.globalDefaultProperties.voiRange??n,VOILUTFunction:this.globalDefaultProperties.VOILUTFunction??r,invert:this.globalDefaultProperties.invert??i,interpolationType:this.globalDefaultProperties.interpolationType??a},typeof e<"u"&&this.setColormap(e),typeof n<"u"&&this.setVOI(n,{suppressEvents:o,voiUpdatedWithSetProperties:!0}),typeof r<"u"&&this.setVOILUTFunction(r,o),typeof i<"u"&&this.setInvertColor(i),typeof a<"u"&&this.setInterpolationType(a)}resetProperties(){this.cpuRenderingInvalidated=!0,this.voiUpdatedWithSetProperties=!1,this.viewportStatus=Io.PRE_RENDER,this.fillWithBackgroundColor(),this.useCPURendering&&(this._cpuFallbackEnabledElement.renderingTools={}),this._resetProperties(),this.render()}_resetProperties(){let e;if(this._isCurrentImagePTPrescaled()?e=this._getDefaultPTPrescaledVOIRange():e=this._getVOIRangeForCurrentImage(),this.setVOI(e),this.setInvertColor(this.initialInvert),this.setInterpolationType(Sf.LINEAR),!this.useCPURendering){const n=this.getTransferFunction();UC(n,this.initialTransferFunctionNodes);const i=n3(n).reduce((s,l)=>(s.push(l[0],l[1],l[2],l[3]),s),[]),a=this.getDefaultActor(),o=i7(i,a.actor);this.setColormap(o)}}resetToDefaultProperties(){this.cpuRenderingInvalidated=!0,this.viewportStatus=Io.PRE_RENDER,this.fillWithBackgroundColor(),this.useCPURendering&&(this._cpuFallbackEnabledElement.renderingTools={});const e=this.getCurrentImageId(),n=this.perImageIdDefaultProperties.get(e)||this.globalDefaultProperties;n.colormap?.name&&this.setColormap(n.colormap);let r;n.voiRange==null?r=this._getVOIRangeForCurrentImage():r=n.voiRange,this.setVOI(r),this.setInterpolationType(Sf.LINEAR),this.setInvertColor(!1),this.render()}_getVOIFromCache(){let e;return this.voiUpdatedWithSetProperties?e=this.voiRange:this._isCurrentImagePTPrescaled()?e=this._getDefaultPTPrescaledVOIRange():e=this._getVOIRangeForCurrentImage()??this.voiRange,e}_setPropertiesFromCache(){const e=this._getVOIFromCache(),{interpolationType:n,invert:r}=this;this.setVOI(e),this.setInterpolationType(n),this.setInvertColor(r)}getCameraCPU(){const{metadata:e,viewport:n}=this._cpuFallbackEnabledElement;if(!e)return{};const{direction:r}=e,i=r.slice(6,9).map(u=>-u);let a=r.slice(3,6).map(u=>-u);if(n.rotation){const u=uwe(r0(),n.rotation*Math.PI/180,i);a=z2(it(),a,u)}const o=[this.element.clientWidth/2,this.element.clientHeight/2],s=this.canvasToWorld(o),l=this.canvasToWorld([0,0]),c=this.canvasToWorld([0,this.element.clientHeight]),f=ol(l,c)/2;return{parallelProjection:!0,focalPoint:s,position:[0,0,0],parallelScale:f,scale:n.scale,viewPlaneNormal:[i[0],i[1],i[2]],viewUp:[a[0],a[1],a[2]],flipHorizontal:this.flipHorizontal,flipVertical:this.flipVertical}}setCameraCPU(e){const{viewport:n,image:r}=this._cpuFallbackEnabledElement,i=this.getCameraCPU(),{focalPoint:a,parallelScale:o,scale:s,flipHorizontal:l,flipVertical:c}=e,{clientHeight:f}=this.element;if(a){const d=this.worldToCanvasCPU(a),h=Zx(this._cpuFallbackEnabledElement,d),p=this.worldToCanvasCPU(i.focalPoint),g=Zx(this._cpuFallbackEnabledElement,p),m=Kn();ka(m,Qk(h[0],h[1]),Qk(g[0],g[1]));const y=FOe({x:m[0],y:m[1]},n);n.translation.x-=y.x,n.translation.y-=y.y}if(o){const{rowPixelSpacing:d}=r,h=f*d*.5/o;n.scale=h,n.parallelScale=o}if(s){const{rowPixelSpacing:d}=r;n.scale=s,n.parallelScale=f*d*.5/s}(l!==void 0||c!==void 0)&&this.setFlipCPU({flipHorizontal:l,flipVertical:c}),this._cpuFallbackEnabledElement.transform=Y2(this._cpuFallbackEnabledElement);const u={previousCamera:i,camera:this.getCamera(),element:this.element,viewportId:this.id,renderingEngineId:this.renderingEngineId};wt(this.element,mt.CAMERA_MODIFIED,u)}getPanCPU(){const{viewport:e}=this._cpuFallbackEnabledElement;return[e.translation.x,e.translation.y]}setPanCPU(e){const n=this.getCameraCPU();this.setCameraCPU({...n,focalPoint:[...e.map(r=>-r),0]})}getZoomCPU(){const{viewport:e}=this._cpuFallbackEnabledElement;return e.scale}setZoomCPU(e){const n=this.getCameraCPU();this.setCameraCPU({...n,scale:e})}setFlipCPU({flipHorizontal:e,flipVertical:n}){const{viewport:r}=this._cpuFallbackEnabledElement;e!==void 0&&(r.hflip=e,this.flipHorizontal=r.hflip),n!==void 0&&(r.vflip=n,this.flipVertical=r.vflip)}setVOILUTFunction(e,n){if(this.useCPURendering)throw new Error("VOI LUT function is not supported in CPU rendering");const r=this._getValidVOILUTFunction(e);let i=!1;this.VOILUTFunction!==r&&(i=!0),this.VOILUTFunction=r;const{voiRange:a}=this.getProperties();this.setVOI(a,{suppressEvents:n,forceRecreateLUTFunction:i})}setRotationCPU(e){const{viewport:n}=this._cpuFallbackEnabledElement;n.rotation=e}setRotationGPU(e){const n=this.getPan(this.fitToCanvasCamera),r=this.getPan(),i=Vh([0,0],n,r);this.setPan(i,!1);const{flipVertical:a,flipHorizontal:o,viewPlaneNormal:s}=this.getCamera(),l=oF(this.initialViewUp,o,a,s);this.setCameraNoEvent({viewUp:l}),this.getVtkActiveCamera().roll(-e);const c=this.getPan(),f=this.getPan(this.fitToCanvasCamera),u=Vh([0,0],c,f),d=FC([0,0],n,u);this.setPan(d,!1)}setInterpolationTypeGPU(e){const n=this.getDefaultActor();if(!n||!gc(n))return;const{actor:r}=n;r.getProperty().setInterpolationType(e),this.interpolationType=e}setInterpolationTypeCPU(e){const{viewport:n}=this._cpuFallbackEnabledElement;n.pixelReplication=e!==Sf.LINEAR,this.interpolationType=e}setInvertColorCPU(e){const{viewport:n}=this._cpuFallbackEnabledElement;n&&(n.invert=e,this.invert=e)}setInvertColorGPU(e){const n=this.getDefaultActor();if(n&&gc(n)){if(ns(n,"vtkVolume")){const i=n.actor.getProperty().getRGBTransferFunction(0);(!this.invert&&e||this.invert&&!e)&&i2(i),this.invert=e}else if(ns(n,"vtkImageSlice")){const i=n.actor.getProperty().getRGBTransferFunction(0);(!this.invert&&e||this.invert&&!e)&&i2(i),this.invert=e}}}setVOICPU(e,n={}){const{suppressEvents:r=!1}=n,{viewport:i,image:a}=this._cpuFallbackEnabledElement;if(!i||!a)return;if(typeof e>"u"){const{windowWidth:s,windowCenter:l}=a,c=Array.isArray(s)?s[0]:s,f=Array.isArray(l)?l[0]:l;i.voi={windowWidth:c,windowCenter:f,voiLUTFunction:a.voiLUTFunction};const{lower:u,upper:d}=zg(c,f,a.voiLUTFunction);e={lower:u,upper:d}}else{const{lower:s,upper:l}=e,{windowCenter:c,windowWidth:f}=Py(s,l);i.voi||(i.voi={windowWidth:0,windowCenter:0,voiLUTFunction:a.voiLUTFunction}),i.voi.windowWidth=f,i.voi.windowCenter=c}this.voiRange=e;const o={viewportId:this.id,range:e};r||wt(this.element,mt.VOI_MODIFIED,o)}getTransferFunction(){const e=this.getDefaultActor();return!e||!gc(e)?void 0:e.actor.getProperty().getRGBTransferFunction(0)}setVOIGPU(e,n={}){const{suppressEvents:r=!1,forceRecreateLUTFunction:i=!1,voiUpdatedWithSetProperties:a=!1}=n;if(e&&this.voiRange&&this.voiRange.lower===e.lower&&this.voiRange.upper===e.upper&&!i&&!this.stackInvalidated)return;const o=this.getDefaultActor();if(!o||!gc(o))return;const s=o.actor;let l=e;if(typeof l>"u"){const h=s.getMapper().getInputData().getPointData().getScalars().getRange();l={lower:h[0],upper:h[1]}}s.getProperty().setUseLookupTableScalarRange(!0);let c=s.getProperty().getRGBTransferFunction(0);const f=this.VOILUTFunction===po.SAMPLED_SIGMOID;if((f||!c||i)&&(c=(f?l7:hQ)(l),this.invert&&i2(c),s.getProperty().setRGBTransferFunction(0,c),this.initialTransferFunctionNodes=n3(c)),f||c.setRange(l.lower,l.upper),this.voiRange=l,this.voiUpdatedWithSetProperties||(this.voiUpdatedWithSetProperties=a),r)return;const u={viewportId:this.id,range:l,VOILUTFunction:this.VOILUTFunction};wt(this.element,mt.VOI_MODIFIED,u)}_addScalingToViewport(e){if(this.scaling.PT)return;const{suvbw:n,suvlbm:r,suvbsa:i}=e,a={};r&&(a.suvbwToSuvlbm=r/n),i&&(a.suvbwToSuvbsa=i/n),this.scaling.PT=a}getImageDataMetadata(e){const n=e.imageId,r=tO(e),{numberOfComponents:i,origin:a,direction:o,dimensions:s,spacing:l,numVoxels:c,imagePixelModule:f,voiLUTFunction:u,modality:d,scalingFactor:h,calibration:p}=r;d==="PT"&&h&&this._addScalingToViewport(h),this.modality=d;const g=this._getValidVOILUTFunction(u);this.VOILUTFunction=g,this.calibration=p;let m=this._getImagePlaneModule(n);return this.useCPURendering||(m=this.calibrateIfNecessary(n,m)),{bitsAllocated:f.bitsAllocated,numberOfComponents:i,origin:a,direction:o,dimensions:s,spacing:l,numVoxels:c,imagePlaneModule:m,imagePixelModule:f}}matchImagesForOverlay(e,n){return(i=>{const a=Ut(ts.IMAGE_PLANE,n),o=Ut(ts.IMAGE_PLANE,i),s=a.imageOrientationPatient,l=o.imageOrientationPatient;if(s&&l){if(pr(a.imageOrientationPatient,o.imageOrientationPatient)){const f=a.imagePositionPatient,u=o.imagePositionPatient;if(f&&u&&pr(f,u)){const h=a.rows,p=a.columns,g=o.rows,m=o.columns;if(h===g&&p===m)return i}}}else{const c=a.rows,f=a.columns,u=o.rows,d=o.columns;if(c===u&&f===d)return i}})(e)}getImagePlaneReferenceData(e=this.getCurrentImageIdIndex()){const n=this.imageIds[e];if(!n)return;const r=Ut(ts.IMAGE_PLANE,n);if(!r)return;const{imagePositionPatient:i,frameOfReferenceUID:a}=r;let{rowCosines:o,columnCosines:s}=r;o||=[1,0,0],s||=[0,1,0];const l=gr([0,0,0],s,o);return{FrameOfReferenceUID:a,viewPlaneNormal:l,cameraFocalPoint:i,referencedImageId:n,sliceIndex:e}}_getCameraOrientation(e){const n=e.slice(6,9).map(i=>-i),r=e.slice(3,6).map(i=>-i);return{viewPlaneNormal:[n[0],n[1],n[2]],viewUp:[r[0],r[1],r[2]]}}createVTKImageData({origin:e,direction:n,dimensions:r,spacing:i,numberOfComponents:a,pixelArray:o}){const s=new o.constructor(o.length),l=tn.newInstance({name:"Pixels",numberOfComponents:a,values:s}),c=KC.newInstance();return c.setDimensions(r),c.setSpacing(i),c.setDirection(n),c.setOrigin(e),c.getPointData().setScalars(l),c}_createVTKImageData({origin:e,direction:n,dimensions:r,spacing:i,numberOfComponents:a,pixelArray:o}){try{this._imageData=this.createVTKImageData({origin:e,direction:n,dimensions:r,spacing:i,numberOfComponents:a,pixelArray:o})}catch(s){sF.error(s)}}async setStack(e,n=0){if(this._throwIfDestroyed(),this.imageIds=e,n>e.length)throw new Error("Current image index is greater than the number of images in the stack");this.imageKeyToIndexMap.clear(),e.forEach((o,s)=>{this.imageKeyToIndexMap.set(o,s),this.imageKeyToIndexMap.set(Ci(o),s)}),this.currentImageIdIndex=n,this.targetImageIdIndex=n;const r=Ut(pm.IMAGE_RETRIEVE_CONFIGURATION,e[n],"stack");this.imagesLoader=r?(r.create||GZ)(r):this,this.stackInvalidated=!0,this.flipVertical=!1,this.flipHorizontal=!1,this.voiRange=null,this.interpolationType=Sf.LINEAR,this.invert=!1,this.viewportStatus=Io.LOADING,this.fillWithBackgroundColor(),this.useCPURendering&&(this._cpuFallbackEnabledElement.renderingTools={},delete this._cpuFallbackEnabledElement.viewport.colormap);const i=await this._setImageIdIndex(n),a={imageIds:e,viewportId:this.id,element:this.element,currentImageIdIndex:n};return wt(this.element,mt.VIEWPORT_NEW_IMAGE_SET,a),i}_throwIfDestroyed(){if(this.isDisabled)throw new Error("The stack viewport has been destroyed and is no longer usable. Renderings will not be performed. If you are using the same viewportId and have re-enabled the viewport, you need to grab the new viewport instance using renderingEngine.getViewport(viewportId), instead of using your lexical scoped reference to the viewport instance.")}_checkVTKImageDataMatchesCornerstoneImage(e,n){if(!n)return!1;const[r,i]=n.getSpacing(),[a,o]=n.getDimensions(),s=this._getImagePlaneModule(e.imageId),l=n.getDirection(),c=l.slice(0,3),f=l.slice(3,6),u=n.getPointData().getScalars().getDataType(),d=pr(r,e.columnPixelSpacing),h=pr(i,e.rowPixelSpacing),p=d||e.columnPixelSpacing===null&&r===1,g=h||e.rowPixelSpacing===null&&i===1,m=a===e.columns,y=o===e.rows,v=pr(s.rowCosines,c),x=pr(s.columnCosines,f),w=u===e.voxelManager.getScalarData().constructor.name;return p&&g&&m&&y&&v&&x&&w}_updateVTKImageDataFromCornerstoneImage(e){let r=this._getImagePlaneModule(e.imageId).imagePositionPatient;r==null&&(r=[0,0,0]),this._imageData.setOrigin(r);const i=this.getActor(this.id);i&&(i.referencedId=e.imageId),tS(this._imageData,e)}_loadAndDisplayImage(e,n){return this.useCPURendering?this._loadAndDisplayImageCPU(e,n):this._loadAndDisplayImageGPU(e,n)}_loadAndDisplayImageCPU(e,n){return new Promise((r,i)=>{function a(h,p,g){if(this.currentImageIdIndex!==p)return;const m=h.voxelManager.getScalarData(),y=h.preScale,v=y?.scalingParameters,x=y?.scaled&&v?.rescaleIntercept%1!==0||v?.rescaleSlope%1!==0;if(m instanceof Float32Array&&x){const S={min:h.minPixelValue,max:h.maxPixelValue},D=Math.abs(S.max-S.min)/65535,I=S.min,R=m.length,O=new Uint16Array(R);let P=65535,N=0;for(let A=0;A<R;A++){const B=Math.floor((m[A]-I)/D);O[A]=B,P=Math.min(P,B),N=Math.max(N,B)}h.minPixelValue=P,h.maxPixelValue=N,h.slope=D,h.intercept=I,h.voxelManager?h.voxelManager.getScalarData=()=>O:h.getPixelData=()=>O,h.preScale={...h.preScale,scaled:!1}}this._setCSImage(h),this.viewportStatus=Io.PRE_RENDER;const w={image:h,imageId:g,imageIdIndex:p,viewportId:this.id,renderingEngineId:this.renderingEngineId};wt(this.element,mt.STACK_NEW_IMAGE,w),this._updateToDisplayImageCPU(h),this.render(),this.currentImageIdIndex=p,r(g)}function o(h,p,g){const m={error:h,imageIdIndex:p,imageId:g};this.suppressEvents||wt(vt,mt.IMAGE_LOAD_ERROR,m),i(h)}function s(h,p,g){return s0(h,g).then(m=>{a.call(this,m,p,h)},m=>{o.call(this,m,p,h)})}const l=-5,c=_n.Interaction,f={imageId:e,imageIdIndex:n},u={useRGBA:!0,requestType:c},d={imageId:e,imageIdIndex:n,viewportId:this.id,renderingEngineId:this.renderingEngineId};wt(this.element,mt.PRE_STACK_NEW_IMAGE,d),is.addRequest(s.bind(this,e,n,u),c,f,l)})}successCallback(e,n){const r=this.imageIds.indexOf(e);if(this.currentImageIdIndex!==r)return;const i=this.csImage?.imageFrame,a=n?.imageFrame,o=i?.photometricInterpretation||this.csImage?.photometricInterpretation,s=a?.photometricInterpretation||n?.photometricInterpretation;o!==s&&(this.stackInvalidated=!0),this._setCSImage(n);const l={image:n,imageId:e,imageIdIndex:r,viewportId:this.id,renderingEngineId:this.renderingEngineId};this._updateActorToDisplayImageId(n),wt(this.element,mt.STACK_NEW_IMAGE,l),this.render(),this.currentImageIdIndex=r}errorCallback(e,n,r){if(!n)return;const i=this.imageIds.indexOf(e),a={error:r,imageIdIndex:i,imageId:e};wt(vt,mt.IMAGE_LOAD_ERROR,a)}getLoaderImageOptions(e){const n=this.imageIds.indexOf(e),{transferSyntaxUID:r}=Ut("transferSyntax",e)||{};return{useRGBA:!1,transferSyntaxUID:r,priority:5,requestType:_n.Interaction,additionalDetails:{imageId:e,imageIdIndex:n}}}async loadImages(e,n){const r=await Promise.allSettled(e.map(a=>{const o=this.getLoaderImageOptions(a);return s0(a,o).then(s=>(n.successCallback(a,s),a),s=>(n.errorCallback(a,!0,s),a))})),i=r.filter(a=>a.status==="rejected");if(i&&i.length){const a=new CustomEvent(mt.IMAGE_LOAD_ERROR,{detail:i,cancelable:!0});vt.dispatchEvent(a)}return r}_loadAndDisplayImageGPU(e,n){if(!e){console.warn("No image id set yet to load");return}const r={imageId:e,imageIdIndex:n,viewportId:this.id,renderingEngineId:this.renderingEngineId};return wt(this.element,mt.PRE_STACK_NEW_IMAGE,r),this.imagesLoader.loadImages([e],this).then(i=>e)}_updateToDisplayImageCPU(e){const n=this.getImageDataMetadata(e),r=CQ(this.canvas,e,this.modality,this._cpuFallbackEnabledElement.viewport.colormap),{windowCenter:i,windowWidth:a,voiLUTFunction:o}=r.voi;this.voiRange=zg(a,i,o),this._cpuFallbackEnabledElement.image=e,this._cpuFallbackEnabledElement.metadata={...n},this.cpuImagePixelData=e.voxelManager.getScalarData();const s=Object.assign({},r,this._cpuFallbackEnabledElement.viewport);this._cpuFallbackEnabledElement.viewport=this.stackInvalidated?r:s,this.stackInvalidated=!1,this.cpuRenderingInvalidated=!0,this._cpuFallbackEnabledElement.transform=Y2(this._cpuFallbackEnabledElement)}getSliceViewInfo(){throw new Error("Method not implemented.")}addImages(e){const n=[];e.forEach(r=>{const{imageId:i,...a}=r,o=yt.getImage(i),{origin:s,dimensions:l,direction:c,spacing:f,numberOfComponents:u}=this.getImageDataMetadata(o),d=this.createVTKImageData({origin:s,dimensions:l,direction:c,spacing:f,numberOfComponents:u,pixelArray:o.voxelManager.getScalarData()}),h=this.createActorMapper(d);h&&(n.push({uid:r.actorUID??cr(),actor:h,referencedId:i,...a}),r.callback&&r.callback({imageActor:h,imageId:r.imageId}))}),this.addActors(n)}_updateActorToDisplayImageId(e){const n=this._checkVTKImageDataMatchesCornerstoneImage(e,this._imageData),r=this.getViewPresentation();if(n&&!this.stackInvalidated){this._updateVTKImageDataFromCornerstoneImage(e),this.resetCameraNoEvent(),this.setViewPresentation(r),this._setPropertiesFromCache(),this.stackActorReInitialized=!1;return}const{origin:i,direction:a,dimensions:o,spacing:s,numberOfComponents:l,imagePixelModule:c}=this.getImageDataMetadata(e),f=e.voxelManager.getScalarData();this._createVTKImageData({origin:i,direction:a,dimensions:o,spacing:s,numberOfComponents:l,pixelArray:f}),this._updateVTKImageDataFromCornerstoneImage(e);const u=this.createActorMapper(this._imageData),d=this.getActors();d.length&&d[0].uid===this.id?d[0].actor=u:d.unshift({uid:this.id,actor:u,referencedId:e.imageId}),this.setActors(d);const{viewPlaneNormal:h,viewUp:p}=this._getCameraOrientation(a),g=this.getCamera();this.setCameraNoEvent({viewUp:p,viewPlaneNormal:h}),this.initialViewUp=p,this.resetCameraNoEvent(),this.setViewPresentation(r),this.triggerCameraEvent(this.getCamera(),g);const m=c.photometricInterpretation==="MONOCHROME1";this.stackInvalidated=!0;const y=this._getInitialVOIRange(e);this.setVOI(y,{forceRecreateLUTFunction:!!m}),this.initialInvert=!!m,this.setInvertColor(this.invert||this.initialInvert),this.stackInvalidated=!1,this.stackActorReInitialized=!0,this._publishCalibratedEvent&&this.triggerCalibrationEvent()}_getInitialVOIRange(e){if(this.voiRange&&this.voiUpdatedWithSetProperties)return this.voiRange;const{windowCenter:n,windowWidth:r,voiLUTFunction:i}=e;let a=this._getVOIRangeFromWindowLevel(r,n,i);return a=this._getPTPreScaledRange()||a,a}_getPTPreScaledRange(){if(this._isCurrentImagePTPrescaled())return this._getDefaultPTPrescaledVOIRange()}_isCurrentImagePTPrescaled(){return!(this.modality!=="PT"||!this.csImage.isPreScaled||!this.csImage.preScale?.scalingParameters.suvbw)}_getDefaultPTPrescaledVOIRange(){return{lower:0,upper:5}}_getVOIRangeFromWindowLevel(e,n,r=po.LINEAR){let i,a;if(typeof n=="number"&&typeof e=="number"?(i=n,a=e):Array.isArray(n)&&Array.isArray(e)&&(i=n[0],a=e[0]),i!==void 0&&a!==void 0)return zg(a,i,r)}async _setImageIdIndex(e){if(e>=this.imageIds.length)throw new Error(`ImageIdIndex provided ${e} is invalid, the stack only has ${this.imageIds.length} elements`);this.currentImageIdIndex=e,this.hasPixelSpacing=!0,this.viewportStatus=Io.PRE_RENDER;const n=await this._loadAndDisplayImage(this.imageIds[e],e);if(this.perImageIdDefaultProperties.size>=1){const r=this.perImageIdDefaultProperties.get(n);r!==void 0?this.setProperties(r):this.globalDefaultProperties!==void 0&&this.setProperties(this.globalDefaultProperties)}return n}resetCameraCPU({resetPan:e=!0,resetZoom:n=!0}){const{image:r}=this._cpuFallbackEnabledElement;if(!r)return;UOe(this._cpuFallbackEnabledElement,e,n);const{scale:i}=this._cpuFallbackEnabledElement.viewport,{clientWidth:a,clientHeight:o}=this.element,s=[a/2,o/2],l=this.canvasToWorldCPU(s);this.setCameraCPU({focalPoint:l,scale:i})}resetCameraGPU({resetPan:e,resetZoom:n}){return this.setCamera({flipHorizontal:!1,flipVertical:!1,viewUp:this.initialViewUp}),super.resetCamera({resetPan:e,resetZoom:n,resetToCenter:!0})}scroll(e,n=!0,r=!1){const i=this.imageIds;if(isNaN(this.targetImageIdIndex))return;const a=this.targetImageIdIndex,o=i.length;let s=a+e;r?s=(s+o)%o:s=Math.max(0,Math.min(o-1,s)),this.targetImageIdIndex=s;const l=i[s];yt.isLoaded(l)||!n?this.setImageIdIndex(s):(clearTimeout(this.debouncedTimeout),this.debouncedTimeout=window.setTimeout(()=>{this.setImageIdIndex(s)},40));const f={newImageIdIndex:s,imageId:l,direction:e};s!==a&&wt(this.element,mt.STACK_VIEWPORT_SCROLL,f)}setImageIdIndex(e){if(this._throwIfDestroyed(),this.currentImageIdIndex===e)return Promise.resolve(this.getCurrentImageId());const n=this._setImageIdIndex(e);return this.targetImageIdIndex=e,n}calibrateSpacing(e){const n=this.getImageIds().indexOf(e);this.stackInvalidated=!0,this._loadAndDisplayImage(e,n)}triggerCameraEvent(e,n){const r={previousCamera:n,camera:e,element:this.element,viewportId:this.id,renderingEngineId:this.renderingEngineId};this.suppressEvents||wt(this.element,mt.CAMERA_MODIFIED,r)}triggerCalibrationEvent(){const{imageData:e}=this.getImageData(),n={element:this.element,viewportId:this.id,renderingEngineId:this.renderingEngineId,imageId:this.getCurrentImageId(),imageData:e,worldToIndex:e.getWorldToIndex(),...this._calibrationEvent};this.suppressEvents||wt(this.element,mt.IMAGE_SPACING_CALIBRATED,n),this._publishCalibratedEvent=!1}jumpToWorld(e){const n=this.getImageIds(),r=this.getImageData(),{direction:i,spacing:a}=r,o=$h({direction:i,spacing:a,imageIds:n},e,this.getCamera().viewPlaneNormal,{ignoreSpacing:!0}),s=n.indexOf(o);return s===-1?!1:(this.setImageIdIndex(s),this.render(),!0)}getRendererContextPool(){return this.getRenderingEngine().getRenderer(this.id)}getRendererTiled(){const e=this.getRenderingEngine();if(!e||e.hasBeenDestroyed)throw new Error("Rendering engine has been destroyed");return e.offscreenMultiRenderWindow?.getRenderer(this.id)}_getVOIRangeForCurrentImage(){const{windowCenter:e,windowWidth:n,voiLUTFunction:r}=this.csImage;return this._getVOIRangeFromWindowLevel(n,e,r)}_getValidVOILUTFunction(e){return Object.values(po).includes(e)?e:po.LINEAR}getSliceInfo(){const e=this.getSliceIndex(),{dimensions:n}=this.getImageData();return{width:n[0],height:n[1],sliceIndex:e,slicePlane:2}}isReferenceViewable(e,n={}){const r=this.getCurrentImageIdIndex(),i=this.imageIds[r];if(!i||!e)return!1;const{referencedImageId:a,multiSliceReference:o}=e;if(a){if(a===i)return!0;e.referencedImageURI||=Ci(a);const{referencedImageURI:l}=e,c=this.imageKeyToIndexMap.get(l);if(n.asOverlay&&this.matchImagesForOverlay(i,a))return!0;if(c===void 0)return!1;if(n.withNavigation)return!0;const f=o&&this.imageKeyToIndexMap.get(o.referencedImageId);return r<=f&&r>=c}if(!super.isReferenceViewable(e,{...n,withOrientation:n?.asVolume}))return!1;if(e.volumeId||e.FrameOfReferenceUID)return n.asVolume;const{cameraFocalPoint:s}=e;if(n.asNearbyProjection&&s){const{spacing:l,direction:c,origin:f}=this.getImageData(),u=c.slice(6,9),d=Jh({direction:c,spacing:l},u),h=Pr(it(),s,f),p=zt(h,u),g=d/2;if(Math.abs(p)<=g)return!0}return!1}getViewReference(e={}){const{sliceIndex:n=this.getCurrentImageIdIndex()}=e,r=super.getViewReference(e),i=this.getCurrentImageId(n);if(i){if(r.referencedImageId=i,this.getCurrentImageIdIndex()!==n){const a=this.getImagePlaneReferenceData(n);if(!a)return;Object.assign(r,a)}return r}}setViewReference(e){if(!e?.referencedImageId){e?.sliceIndex!==void 0&&this.scroll(e.sliceIndex-this.targetImageIdIndex);return}const{referencedImageId:n}=e;e.referencedImageURI||=Ci(n);const{referencedImageURI:r}=e,i=this.imageKeyToIndexMap.get(r);if(i===void 0){sF.error(`No image URI found for ${r}`);return}this.scroll(i-this.targetImageIdIndex)}getViewReferenceId(e={}){const{sliceIndex:n=this.currentImageIdIndex}=e;return`imageId:${this.imageIds[n]}`}getSliceIndexForImage(e){if(e){if(typeof e=="string")return this.imageKeyToIndexMap.get(e);if(e.referencedImageId)return this.imageKeyToIndexMap.get(e.referencedImageId)}}getCPUFallbackError(e){return new Error(`method ${e} cannot be used during CPU Fallback mode`)}fillWithBackgroundColor(){const e=this.getRenderingEngine();e&&e.fillCanvasWithBackgroundColor(this.canvas,this.options.background)}unsetColormapCPU(){delete this._cpuFallbackEnabledElement.viewport.colormap,this._cpuFallbackEnabledElement.renderingTools={},this.cpuRenderingInvalidated=!0,this.fillWithBackgroundColor(),this.render()}setColormapCPU(e){this.colormap=e;const n=W2(e.name);this._cpuFallbackEnabledElement.viewport.colormap=n,this._cpuFallbackEnabledElement.renderingTools={},this.fillWithBackgroundColor(),this.cpuRenderingInvalidated=!0,this.render();const r={viewportId:this.id,colormap:e};wt(this.element,mt.COLORMAP_MODIFIED,r)}setColormapGPU(e){const i=this.getDefaultActor().actor.getProperty(),a=i.getRGBTransferFunction(),o=W2(e.name)||j2.getPresetByName(e.name);if(a)a.applyColorMap(o),a.setMappingRange(this.voiRange.lower,this.voiRange.upper),i.setRGBTransferFunction(0,a);else{const l=Uf.newInstance();l.applyColorMap(o),l.setMappingRange(this.voiRange.lower,this.voiRange.upper),i.setRGBTransferFunction(0,l)}this.colormap=e,this.render();const s={viewportId:this.id,colormap:e};wt(this.element,mt.COLORMAP_MODIFIED,s)}unsetColormapGPU(){throw new Error("unsetColormapGPU not implemented.")}_getImagePlaneModule(e){const n=uQ(e);return this.hasPixelSpacing=!n.usingDefaultValues||this.calibration?.scale>0||this.calibration?.rowPixelSpacing>0,this.calibration||=n.calibration,n}isInAcquisitionPlane(){return!0}}function Ld(t,e){const{imageData:n}=t.getImageData(),r=t.canvasToWorld(e);return fo(n,r)}function gm(t,e){return t.indexToWorld(e)}function $Oe(t,e){const{imageData:n}=t.getImageData(),r=gm(n,e);return t.worldToCanvas(r)}class da extends mo{constructor(e){super(e),this._useAcquisitionPlaneForViewPlane=!1,this.getNumberOfSlices=()=>{const{numberOfSlices:r}=x3(this)||{};return r},this.resetCameraForResize=()=>this.resetCamera({resetPan:!0,resetZoom:!0,resetToCenter:!0,resetRotation:!1,suppressEvents:!0}),this.getCurrentImageIdIndex=(r,i=!0)=>{const{currentStepIndex:a}=Yg(this,r||this.getVolumeId(),i);return a},this.getSliceIndex=()=>{const{imageIndex:r}=x3(this)||{};return r},this.getCurrentImageId=()=>{const r=this.getDefaultActor();if(!r||!ns(r,"vtkVolume"))return;const i=yt.getVolume(this.getVolumeId());if(!i)return;const{viewPlaneNormal:a,focalPoint:o}=this.getCamera();return $h(i,o,a)},this.getSlicePlaneCoordinates=()=>{const r=this.getDefaultActor();if(!r?.actor)return console.warn("No image data found for calculating vtkPlanes."),[];const i=this.getVolumeId(),a=yt.getVolume(i),o=this.getCamera(),{focalPoint:s,position:l,viewPlaneNormal:c}=o,f=Jh(a,c),u=QC(r.actor,c,s),d=Math.round((u.current-u.min)/f),h=Math.round((u.max-u.current)/f),p=this.getSliceIndex(),g=[];for(let m=-d;m<=h;m++){const{newFocalPoint:y}=Jg(s,l,u,c,f,m);g.push({sliceIndex:p+m,point:y})}return g};const{orientation:n}=this.options;if(n&&n!==qd.ACQUISITION){this.applyViewOrientation(n);return}this._useAcquisitionPlaneForViewPlane=!0}async setVolumes(e,n=!1,r=!1){const i=e[0].volumeId,a=yt.getVolume(i);if(!a)throw new Error(`imageVolume with id: ${i} does not exist`);return this._useAcquisitionPlaneForViewPlane?(this._setViewPlaneToAcquisitionPlane(a),this._useAcquisitionPlaneForViewPlane=!1):this.options.orientation&&typeof this.options.orientation=="string"&&this.options.orientation.includes("_reformat")&&this._setViewPlaneToReformatOrientation(this.options.orientation,a),super.setVolumes(e,n,r)}async addVolumes(e,n=!1,r=!1){const i=yt.getVolume(e[0].volumeId);if(!i)throw new Error(`imageVolume with id: ${i.volumeId} does not exist`);return this._useAcquisitionPlaneForViewPlane?(this._setViewPlaneToAcquisitionPlane(i),this._useAcquisitionPlaneForViewPlane=!1):this.options.orientation&&typeof this.options.orientation=="string"&&this.options.orientation.includes("_reformat")&&this._setViewPlaneToReformatOrientation(this.options.orientation,i),super.addVolumes(e,n,r)}jumpToWorld(e){const{focalPoint:n}=this.getCamera(),r=[0,0,0];dr(r,e,n);const i=this.getCamera(),a=i.viewPlaneNormal,o=zt(r,a),s=Sn(a[0],a[1],a[2]);if(tl(s,s,o),Math.abs(s[0])>.001||Math.abs(s[1])>.001||Math.abs(s[2])>.001){const l=[0,0,0],c=[0,0,0];Ul(l,i.focalPoint,s),Ul(c,i.position,s),this.setCamera({focalPoint:l,position:c}),this.render()}return!0}setOrientation(e,n=!0){let r,i;if(typeof e=="string"){if(e===qd.ACQUISITION)({viewPlaneNormal:r,viewUp:i}=super._getAcquisitionPlaneOrientation());else if(e===qd.REFORMAT||e.includes("_reformat"))({viewPlaneNormal:r,viewUp:i}=aQ(this,{useViewportNormal:!0}));else if(Tf[e])({viewPlaneNormal:r,viewUp:i}=Tf[e]);else throw new Error(`Invalid orientation: ${e}. Use Enums.OrientationAxis instead.`);this.setCamera({viewPlaneNormal:r,viewUp:i}),this.viewportProperties.orientation=e,this.resetCamera()}else({viewPlaneNormal:r,viewUp:i}=e),this.applyViewOrientation(e);n&&this.render()}setCameraClippingRange(){const e=this.getVtkActiveCamera();if(!e){console.warn("No active camera found");return}e.getParallelProjection()?e.setClippingRange(-Oi.MAXIMUM_RAY_DISTANCE,Oi.MAXIMUM_RAY_DISTANCE):e.setClippingRange(Oi.MINIMUM_SLAB_THICKNESS,Oi.MAXIMUM_RAY_DISTANCE)}_setViewPlaneToReformatOrientation(e,n){let r,i;if(n){const{direction:a}=n;({viewPlaneNormal:r,viewUp:i}=iQ(a.slice(0,3),a.slice(3,6),a.slice(6,9),e))}else({viewPlaneNormal:r,viewUp:i}=this._getAcquisitionPlaneOrientation());this.setCamera({viewPlaneNormal:r,viewUp:i}),this.initialViewUp=i,this.resetCamera()}_setViewPlaneToAcquisitionPlane(e){let n,r;if(e){const{direction:i}=e;n=i.slice(6,9).map(a=>-a),r=i.slice(3,6).map(a=>-a)}else({viewPlaneNormal:n,viewUp:r}=this._getAcquisitionPlaneOrientation());this.setCamera({viewPlaneNormal:n,viewUp:r}),this.initialViewUp=r,this.resetCamera()}getBlendMode(e){const n=this.getActors(),r=e?.length>0?n.find(i=>e.includes(i.uid)):n[0];return r?.blendMode||r?.actor.getMapper().getBlendMode()}setBlendMode(e,n=[],r=!1){let i=this.getActors();n?.length>0&&(i=i.filter(a=>n.includes(a.uid))),i.forEach(a=>{const{actor:o}=a;o.getMapper().setBlendMode?.(e),a.blendMode=e}),r&&this.render()}resetCamera(e){const{resetPan:n=!0,resetZoom:r=!0,resetRotation:i=!0,resetToCenter:a=!0,suppressEvents:o=!1,resetOrientation:s=!0}=e||{},{orientation:l}=this.viewportProperties;l&&s&&this.applyViewOrientation(l,!1),super.resetCamera({resetPan:n,resetZoom:r,resetToCenter:a});const c=this.getVtkActiveCamera(),f=c.getViewPlaneNormal(),u=c.getFocalPoint();if(this.getActors().forEach(h=>{if(!h.actor)return;const p=h.actor.getMapper();if(p.getClippingPlanes().length===0&&!h?.clippingFilter){const m=Ao.newInstance(),y=Ao.newInstance(),v=[m,y];let x=Oi.MINIMUM_SLAB_THICKNESS;h.slabThickness&&(x=h.slabThickness),this.setOrientationOfClippingPlanes(v,x,f,u),p.addClippingPlane(m),p.addClippingPlane(y)}}),i&&Tf[this.viewportProperties.orientation]!==void 0){const h=Tf[this.viewportProperties.orientation];this.setCameraNoEvent({viewUp:h.viewUp,viewPlaneNormal:h.viewPlaneNormal})}if(!o){const h={viewportId:this.id,camera:this.getCamera(),renderingEngineId:this.renderingEngineId,element:this.element};wt(this.element,mt.CAMERA_RESET,h)}return!0}setSlabThickness(e,n=[]){e<.1&&(e=.1);let r=this.getActors();n?.length>0&&(r=r.filter(a=>n.includes(a.uid))),r.forEach(a=>{ns(a,"vtkVolume")&&(a.slabThickness=e)});const i=this.getCamera();this.updateClippingPlanesForActors(i),this.triggerCameraModifiedEventIfNecessary(i,i),this.viewportProperties.slabThickness=e}resetSlabThickness(){this.getActors().forEach(r=>{ns(r,"vtkVolume")&&(r.slabThickness=Oi.MINIMUM_SLAB_THICKNESS)});const n=this.getCamera();this.updateClippingPlanesForActors(n),this.triggerCameraModifiedEventIfNecessary(n,n),this.viewportProperties.slabThickness=void 0}isInAcquisitionPlane(){const e=this.getImageData();if(!e)return!1;const{direction:n}=e,{viewPlaneNormal:r}=this.getCamera(),i=[n[6],n[7],n[8]];return Math.abs(zt(r,i))>.99}getSliceViewInfo(){const{width:e,height:n}=this.getCanvas(),r=Ld(this,[0,0]),i=Ld(this,[e-1,0]),a=Ld(this,[0,n-1]),o=dr(it(),i,r),s=dr(it(),a,r),l=gr(it(),o,s);Lr(o,o),Lr(s,s),Lr(l,l);const{dimensions:c}=this.getImageData(),[f,u,d]=c,g=[[0,0,0],[f-1,0,0],[0,u-1,0],[f-1,u-1,0],[0,0,d-1],[f-1,0,d-1],[0,u-1,d-1],[f-1,u-1,d-1]].map(R=>$Oe(this,R)).reduce((R,O)=>(R.minX=Math.min(R.minX,O[0]),R.minY=Math.min(R.minY,O[1]),R.maxX=Math.max(R.maxX,O[0]),R.maxY=Math.max(R.maxY,O[1]),R),{minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}),m=Ld(this,[g.minX,g.minY]),y=uX(o[0],o[1],o[2],0,s[0],s[1],s[2],0,l[0],l[1],l[2],0,m[0],m[1],m[2],1),v=Ld(this,[g.maxX,g.maxY]),x=dr(it(),v,m),w=e7(r0(),y),{viewPlaneNormal:S}=this.getCamera();if(S.filter(R=>Math.abs(R)>al).length>1)throw new Error("getSliceInfo is not supported for oblique views");const _=S.findIndex(R=>Math.abs(R)>1-al);if(_===-1)throw new Error("Unable to determine slice axis");const D=zt(o,x)+1,I=zt(s,x)+1;return{sliceIndex:this.getSliceIndex(),width:D,height:I,slicePlane:_,sliceToIndexMatrix:y,indexToSliceMatrix:w}}getCurrentSlicePixelData(){const{voxelManager:e}=this.getImageData();return e.getSliceData(this.getSliceViewInfo())}getViewReference(e={}){const n=super.getViewReference(e);if(!n?.volumeId)return;const r=yt.getVolume(n.volumeId);return n.referencedImageId=$h(r,n.cameraFocalPoint,n.viewPlaneNormal),n}resetProperties(e){this._resetProperties(e)}_resetProperties(e){const n=e?this.getActor(e):this.getDefaultActor();if(!n)throw new Error(`No actor found for the given volumeId: ${e}`);n.slabThickness&&(n.slabThickness=Oi.MINIMUM_SLAB_THICKNESS,this.viewportProperties.slabThickness=void 0,this.updateClippingPlanesForActors(this.getCamera())),e||=this.getVolumeId();const r=yt.getVolume(e);if(!r)throw new Error(`imageVolume with id: ${e} does not exist in cache`);if(Z7(n.actor,r),gc(n)){const c=n.actor.getProperty().getRGBTransferFunction(0);UC(c,this.initialTransferFunctionNodes)}const i={...super.getVOIModifiedEventDetail(e)};this.resetCamera({resetPan:!0,resetZoom:!0,resetToCenter:!0,resetCameraRotation:!0}),wt(this.element,mt.VOI_MODIFIED,i)}getSlicesClippingPlanes(){const e=this.getSlicePlaneCoordinates(),{viewPlaneNormal:n}=this.getCamera(),r=Oi.MINIMUM_SLAB_THICKNESS;return e.map(({point:i,sliceIndex:a})=>{const o=[Ao.newInstance(),Ao.newInstance()];return this.setOrientationOfClippingPlanes(o,r,n,i),{sliceIndex:a,planes:o.map(s=>({normal:s.getNormal(),origin:s.getOrigin()}))}})}}class nS extends mo{constructor(e){super(e),this.setSampleDistanceMultiplier=a=>{this.getActors().forEach(s=>{if(ns(s,"vtkVolume")){const c=s.actor.getMapper();if(c&&c.getInputData){const f=c.getInputData();if(f){const u=f.getSpacing();let p=(u[0]+u[1]+u[2])/6*(a||1);p!==void 0&&c.setSampleDistance&&(c.getSampleDistance(),c.setSampleDistance(p))}}}}),this.render()},this.getNumberOfSlices=()=>1,this.getRotation=()=>0,this.getCurrentImageIdIndex=()=>0,this.getCurrentImageId=()=>null,this.resetCameraForResize=()=>this.resetCamera({resetPan:!0,resetZoom:!0,resetToCenter:!0});const{parallelProjection:n,orientation:r}=this.options,i=this.getVtkActiveCamera();n!=null&&i.setParallelProjection(n),r&&r!==qd.ACQUISITION&&this.applyViewOrientation(r)}isInAcquisitionPlane(){return!1}resetCamera({resetPan:e=!0,resetZoom:n=!0,resetToCenter:r=!0}={}){super.resetCamera({resetPan:e,resetZoom:n,resetToCenter:r});const i=this.getVtkActiveCamera();return i.getParallelProjection()?i.setClippingRange(-Oi.MAXIMUM_RAY_DISTANCE,Oi.MAXIMUM_RAY_DISTANCE):i.setClippingRange(Oi.MINIMUM_SLAB_THICKNESS,Oi.MAXIMUM_RAY_DISTANCE),this.getRenderer().resetCameraClippingRange(),!0}setSlabThickness(e,n){return null}setBlendMode(e,n,r){return null}resetProperties(e){const n=e?this.getActor(e):this.getDefaultActor();if(!n)throw new Error(`No actor found for the given volumeId: ${e}`);n.slabThickness&&(n.slabThickness=Oi.MINIMUM_SLAB_THICKNESS,this.viewportProperties.slabThickness=void 0,this.updateClippingPlanesForActors(this.getCamera())),e||=this.getVolumeId();const r=yt.getVolume(e);if(!r)throw new Error(`imageVolume with id: ${e} does not exist in cache`);if(Z7(n.actor,r),gc(n)){const i=n.actor.getProperty().getRGBTransferFunction(0);UC(i,this.initialTransferFunctionNodes)}this.setCamera(this.initialCamera),wt(this.element,mt.VOI_MODIFIED,super.getVOIModifiedEventDetail(e))}getSliceIndex(){return null}setCamera(e){super.setCamera(e),this.getRenderer().resetCameraClippingRange(),this.render()}setCameraClippingRange(){const e=this.getVtkActiveCamera();e.getParallelProjection()?e.setClippingRange(-Oi.MAXIMUM_RAY_DISTANCE,Oi.MAXIMUM_RAY_DISTANCE):e.setClippingRange(Oi.MINIMUM_SLAB_THICKNESS,Oi.MAXIMUM_RAY_DISTANCE)}resetSlabThickness(){return null}}async function SQ(t,e,n,r=!1,i=!1){n.forEach(o=>{const s=t.getViewport(o);if(!s)throw new Error(`Viewport with Id ${o} does not exist`);if(!(s instanceof mo))throw new Error("setVolumesForViewports only supports VolumeViewport and VolumeViewport3D")});const a=n.map(async o=>{await t.getViewport(o).setVolumes(e,r,i)});await Promise.all(a)}async function TQ(t,e,n,r=!1,i=!1){for(const o of n){const s=t.getViewport(o);if(!s)throw new Error(`Viewport with Id ${o} does not exist`);if(!(s instanceof mo)){console.warn(`Viewport with Id ${o} is not a BaseVolumeViewport. Cannot add volume to this viewport.`);return}}const a=n.map(async o=>{await t.getViewport(o).addVolumes(e,r,i)});await Promise.all(a)}function EQ(t,e,n){for(const r of n){const i=t.getViewport(r);if(!i)throw new Error(`Viewport with Id ${r} does not exist`);if(!i.addImages){console.warn(`Viewport with Id ${r} does not have addImages. Cannot add image segmentation to this viewport.`);return}}n.forEach(r=>{t.getViewport(r).addImages(e)})}class GOe{constructor(e){this.opacity=.4,this.outlineOpacity=.4,this.transferFunction=[],this.actor=e}setRGBTransferFunction(e,n){this.transferFunction[e]=n}setScalarOpacity(e){}setInterpolationTypeToNearest(){}setUseLabelOutline(){}setLabelOutlineOpacity(e){this.outlineOpacity=e}setLabelOutlineThickness(){}getColor(e){const n=this.transferFunction[0],r=n.getRedValue(e),i=n.getGreenValue(e),a=n.getBlueValue(e);return[r,i,a,this.opacity]}}class jOe{constructor(e){this.actor=e}getInputData(){return this.actor.getImage()}}class zOe{constructor(e,n){this.canvasProperties=new GOe(this),this.visibility=!1,this.mapper=new jOe(this),this.className="CanvasActor",this.derivedImage=n,this.viewport=e}renderRLE(e,n,r){const{width:i,height:a}=this.image;let{canvas:o}=this;(!o||o.width!==i||o.height!==a)&&(this.canvas=o=new window.OffscreenCanvas(i,a));const s=o.getContext("2d"),l=s.createImageData(i,a),{data:c}=l;c.fill(0);const{map:f}=r;let u=1/0,d=1/0,h=-1/0,p=-1/0;for(let y=0;y<a;y++){const v=f.getRun(y,0);if(!v)continue;d=Math.min(d,y),p=Math.max(p,y);const x=y*i<<2;let w;for(const S of v){const{start:T,end:_,value:D}=S;if(D===0){w||=[],w.push(v.indexOf(S));continue}u=Math.min(u,T),h=Math.max(h,_);const I=this.canvasProperties.getColor(D).map(O=>O*255);let R=x+(T<<2);for(let O=T;O<_;O++)c[R++]=I[0],c[R++]=I[1],c[R++]=I[2],c[R++]=I[3]}}if(u>i)return;const g=h-u,m=p-d;s.putImageData(l,0,0,u-1,d-1,g+2,m+2),n.drawImage(o,u,d,g,m,u,d,g,m)}setMapper(e){this.mapper=e}render(e,n){if(!this.visibility)return;const r=this.image||this.getImage(),{width:i,height:a}=r,o=r.getScalarData();if(!o)return;const{voxelManager:s}=r;if(s&&s.map.getRun){this.renderRLE(e,n,s);return}let{canvas:l}=this;(!l||l.width!==i||l.height!==a)&&(this.canvas=l=new window.OffscreenCanvas(i,a));const c=l.getContext("2d"),f=c.createImageData(i,a),{data:u}=f;let d=0,h=0,p=1/0,g=1/0,m=-1/0,y=-1/0;for(let w=0;w<a;w++)for(let S=0;S<i;S++){const T=o[d++];if(T){p=Math.min(S,p),g=Math.min(w,g),m=Math.max(S,m),y=Math.max(w,y);const _=this.canvasProperties.getColor(T);u[h]=_[0]*255,u[h+1]=_[1]*255,u[h+2]=_[2]*255,u[h+3]=127}h+=4}if(p>i)return;const v=m-p+1,x=y-g+1;c.putImageData(f,0,0,p,g,v,x),n.drawImage(l,p,g,v,x,p,g,v,x)}getClassName(){return this.className}getProperty(){return this.canvasProperties}setVisibility(e){this.visibility=e}getMapper(){return this.mapper}isA(e){return e===this.className}getImage(){if(this.image)return this.image;this.image={...this.derivedImage};const e=this.viewport.getImageData();return Object.assign(this.image,{worldToIndex:n=>e.imageData.worldToIndex(n),indexToWorld:(n,r)=>e.imageData.indexToWorld(n,r),getDimensions:()=>e.dimensions,getScalarData:()=>this.derivedImage?.getPixelData(),getDirection:()=>e.direction,getSpacing:()=>e.spacing,setOrigin:()=>null,setDerivedImage:n=>{this.derivedImage=n,this.image=null},modified:()=>null}),this.image}}const fM=class fM{static imageIdToFrames(e){const n=e.match(this.frameRangeExtractor);if(!n||!n[2])return null;const r=n[2].split("-").map(i=>Number(i));return r.length===1?r[0]:r}static imageIdToFrameEnd(e){const n=this.imageIdToFrames(e);return Array.isArray(n)?n[1]:n}static imageIdToFrameStart(e){const n=this.imageIdToFrames(e);return Array.isArray(n)?n[0]:n}static framesToString(e){return Array.isArray(e)?`${e[0]}-${e[1]}`:String(e)}static framesToImageId(e,n){const r=e.match(this.frameRangeExtractor);if(!r||!r[2])return null;const i=this.framesToString(n);return e.replace(this.frameRangeExtractor,`${r[1]}${i}`)}};fM.frameRangeExtractor=/(\/frames\/|[&?]frameNumber=)([^/&?]*)/i;let Qg=fM;const v2=class v2 extends Bh{constructor(e){super({...e,canvas:e.canvas||nl(e.element)}),this.videoWidth=0,this.videoHeight=0,this.loop=!0,this.mute=!0,this.isPlaying=!1,this.scrollSpeed=1,this.playbackRate=1,this.frameRange=[0,0],this.fps=30,this.videoCamera={panWorld:[0,0],parallelScale:1},this.voiRange={lower:0,upper:255},this.getProperties=()=>({loop:this.videoElement.loop,muted:this.videoElement.muted,playbackRate:this.playbackRate,scrollSpeed:this.scrollSpeed,voiRange:{...this.voiRange}}),this.getMiddleSliceData=()=>{throw new Error("Method not implemented.")},this.useCustomRenderingPipeline=!0,this.resetCamera=()=>(this.refreshRenderValues(),this.canvasContext.fillRect(0,0,this.canvas.width,this.canvas.height),this.isPlaying||this.renderFrame(),!0),this.getNumberOfSlices=()=>{const n=Math.round(this.videoElement.duration*this.fps/this.scrollSpeed);return isNaN(n)?this.numberOfFrames:n},this.getFrameOfReferenceUID=()=>this.videoElement.src,this.resize=()=>{const n=this.canvas,{clientWidth:r,clientHeight:i}=n;(n.width!==r||n.height!==i)&&(n.width=r,n.height=i),this.refreshRenderValues(),this.isPlaying||this.renderFrame()},this.canvasToWorld=(n,r=[0,0,0])=>{const i=this.videoCamera.panWorld,a=this.getWorldToCanvasRatio(),o=[i[0]*a,i[1]*a],s=[n[0]-o[0],n[1]-o[1]];return r.splice(0,2,s[0]/a,s[1]/a),r},this.worldToCanvas=n=>{const r=this.videoCamera.panWorld,i=this.getWorldToCanvasRatio();return[(n[0]+r[0])*i,(n[1]+r[1])*i]},this.getRotation=()=>0,this.canvasToIndex=n=>{const r=this.getTransform();return r.invert(),r.transformPoint(n.map(i=>i*devicePixelRatio))},this.indexToCanvas=n=>this.getTransform().transformPoint(n).map(i=>i/devicePixelRatio),this.customRenderViewportToCanvas=()=>{this.renderFrame()},this.renderFrame=()=>{const n=window.devicePixelRatio||1,i=this.getTransform().getMatrix(),a=this.canvasContext;a.resetTransform(),a.clearRect(0,0,this.canvas.width,this.canvas.height),a.transform(i[0]/n,i[1]/n,i[2]/n,i[3]/n,i[4]/n,i[5]/n),a.drawImage(this.videoElement,0,0,this.videoWidth,this.videoHeight);for(const s of this.getActors())s.actor.render(this,this.canvasContext);this.canvasContext.resetTransform(),wt(this.element,mt.STACK_NEW_IMAGE,{element:this.element,viewportId:this.id,viewport:this,renderingEngineId:this.renderingEngineId,time:this.videoElement.currentTime,duration:this.videoElement.duration}),wt(this.element,mt.IMAGE_RENDERED,{element:this.element,viewportId:this.id,viewport:this,imageIndex:this.getCurrentImageIdIndex(),numberOfSlices:this.numberOfFrames,renderingEngineId:this.renderingEngineId,time:this.videoElement.currentTime,duration:this.videoElement.duration}),this.initialRender?.();const o=this.getFrameNumber();this.isPlaying&&(o<this.frameRange[0]?this.setFrameNumber(this.frameRange[0]):o>this.frameRange[1]&&(this.loop?this.setFrameNumber(this.frameRange[0]):this.pause()))},this.renderWhilstPlaying=()=>{this.renderFrame(),this.isPlaying&&requestAnimationFrame(this.renderWhilstPlaying)},this.canvasContext=this.canvas.getContext("2d"),this.renderingEngineId=e.renderingEngineId,this.element.setAttribute("data-viewport-uid",this.id),this.element.setAttribute("data-rendering-engine-uid",this.renderingEngineId),this.videoElement=document.createElement("video"),this.videoElement.muted=this.mute,this.videoElement.loop=this.loop,this.videoElement.autoplay=!0,this.videoElement.crossOrigin="anonymous",this.addEventListeners(),this.resize()}static get useCustomRenderingPipeline(){return!0}addEventListeners(){this.canvas.addEventListener(mt.ELEMENT_DISABLED,this.elementDisabledHandler)}removeEventListeners(){this.canvas.removeEventListener(mt.ELEMENT_DISABLED,this.elementDisabledHandler)}elementDisabledHandler(){this.removeEventListeners(),this.videoElement.remove()}getImageDataMetadata(e){const n=typeof e=="string"?e:e.imageId,r=Ut(ts.IMAGE_PLANE,n);let i=r.rowCosines,a=r.columnCosines;(r.usingDefaultValues||i==null||a==null)&&(i=[1,0,0],a=[0,1,0]);const s=Sn(i[0],i[1],i[2]),l=Sn(a[0],a[1],a[2]),{rows:c,columns:f}=r,u=it();gr(u,s,l);let d=r.imagePositionPatient;d==null&&(d=[0,0,0]);const h=r.columnPixelSpacing||1,p=r.rowPixelSpacing||1,g=r.columns,m=r.rows,y=1,v=1;return this.hasPixelSpacing=!!r.columnPixelSpacing,{bitsAllocated:8,numberOfComponents:3,origin:d,rows:c,columns:f,direction:[...s,...l,...u],dimensions:[g,m,v],spacing:[h,p,y],hasPixelSpacing:this.hasPixelSpacing,numVoxels:g*m*v,imagePlaneModule:r}}setDataIds(e,n){this.setVideo(e[0],(n.viewReference?.sliceIndex||0)+1)}setVideo(e,n){this.imageId=Array.isArray(e)?e[0]:e;const r=Ut(ts.IMAGE_URL,e);if(!r?.rendered)throw new Error(`Video Image ID ${e} does not have a rendered video view`);const{rendered:i}=r,a=Ut(ts.GENERAL_SERIES,e);this.modality=a?.Modality,this.metadata=this.getImageDataMetadata(e);let{cineRate:o,numberOfFrames:s}=Ut(ts.CINE,e);return this.numberOfFrames=s,this.setVideoURL(i).then(()=>((!s||s===1)&&(s=Math.round(this.videoElement.duration*(o||30))),o||(o=Math.round(s/this.videoElement.duration)),this.fps=o,this.numberOfFrames=s,this.setFrameRange([1,s]),this.initialRender=()=>{this.initialRender=null,this.pause(),this.setFrameNumber(n||1)},new Promise(l=>{window.setTimeout(()=>{this.setFrameNumber(n||1),l(this)},25)})))}async setVideoURL(e){return new Promise(n=>{this.videoElement.src=e,this.videoElement.preload="auto";const r=()=>{this.videoWidth=this.videoElement.videoWidth,this.videoHeight=this.videoElement.videoHeight,this.videoElement.removeEventListener("loadedmetadata",r),this.refreshRenderValues(),n(!0)};this.videoElement.addEventListener("loadedmetadata",r)})}getImageIds(){const e=new Array(this.numberOfFrames),n=this.imageId.replace(/[0-9]+$/,"");for(let r=0;r<this.numberOfFrames;r++)e[r]=`${n}${r+1}`;return e}togglePlayPause(){return this.isPlaying?(this.pause(),!1):(this.play(),!0)}async play(){try{this.isPlaying||(this.isPlaying=!0,await this.videoElement.play(),this.renderWhilstPlaying())}catch{}}pause(){try{this.isPlaying=!1,this.videoElement.pause()}catch{}}async scroll(e=1){await this.pause();const n=this.videoElement,r=this.renderFrame,a=n.currentTime+e*this.scrollSpeed/this.fps;n.currentTime=a;const o=s=>{r(),n.removeEventListener("seeked",o)};n.addEventListener("seeked",o)}async start(){const e=this.videoElement,n=this.renderFrame;if(e.currentTime=0,e.paused){const r=i=>{n(),e.removeEventListener("seeked",r)};e.addEventListener("seeked",r)}}async end(){const e=this.videoElement,n=this.renderFrame;if(e.currentTime=e.duration,e.paused){const r=i=>{n(),e.removeEventListener("seeked",r)};e.addEventListener("seeked",r)}}async setTime(e){const n=this.videoElement,r=this.renderFrame;if(n.currentTime=e,n.paused){const i=a=>{r(),n.removeEventListener("seeked",i)};n.addEventListener("seeked",i)}}getSliceViewInfo(){throw new Error("Method not implemented.")}async setFrameNumber(e){this.setTime((e-1)/this.fps)}setFrameRange(e){if(!e){this.frameRange=[1,this.numberOfFrames];return}e.length!==2||e[0]===e[1]||(this.frameRange=[e[0],e[1]])}getSliceIndexForImage(e){if(e){if(typeof e=="string")return Qg.imageIdToFrameStart(e);if(e.referencedImageId)return Qg.imageIdToFrameStart(e.referencedImageId)}}getFrameRange(){return this.frameRange}setProperties(e){e.loop!==void 0&&(this.videoElement.loop=e.loop),e.muted!==void 0&&(this.videoElement.muted=e.muted),e.playbackRate!==void 0&&this.setPlaybackRate(e.playbackRate),e.scrollSpeed!==void 0&&this.setScrollSpeed(e.scrollSpeed),e.voiRange&&this.setVOI(e.voiRange)}setPlaybackRate(e=1){if(this.playbackRate=e,e<.0625){this.pause();return}this.videoElement&&(this.videoElement.playbackRate=e,this.play())}setScrollSpeed(e=1,n=B2.FRAME){this.scrollSpeed=n===B2.SECOND?e*this.fps:e}resetProperties(){this.setProperties({loop:!1,muted:!0,voiRange:{lower:0,upper:255}})}getScalarData(){if(this.scalarData?.frameNumber===this.getFrameNumber())return this.scalarData;if(!this.videoElement||!this.videoElement.videoWidth||!this.videoElement.videoHeight){console.debug("Video not ready yet, returning empty scalar data");const a=new Uint8ClampedArray;return a.getRange=()=>[0,255],a.frameNumber=-1,a}const e=document.createElement("canvas");e.width=this.videoElement.videoWidth,e.height=this.videoElement.videoHeight;const n=e.getContext("2d");n.drawImage(this.videoElement,0,0);const i=n.getImageData(0,0,e.width,e.height).data;return i.getRange=()=>[0,255],i.frameNumber=this.getFrameNumber(),this.scalarData=i,i}getImageData(){const{metadata:e}=this,n=e.spacing,r={getDirection:()=>e.direction,getDimensions:()=>e.dimensions,getRange:()=>[0,255],getScalarData:()=>this.getScalarData(),getSpacing:()=>e.spacing,worldToIndex:a=>{const o=this.worldToCanvas(a),s=this.canvasToIndex(o);return[s[0],s[1],0]},indexToWorld:(a,o)=>{const s=this.indexToCanvas([a[0],a[1]]);return this.canvasToWorld(s,o)}},i={dimensions:e.dimensions,spacing:n,origin:e.origin,direction:e.direction,metadata:{Modality:this.modality,FrameOfReferenceUID:e.FrameOfReferenceUID},getScalarData:()=>this.getScalarData(),scalarData:this.getScalarData(),imageData:r,voxelManager:{forEach:(a,o)=>N7(o.imageData,{pointInShapeFn:o.isInObject??(()=>!0),callback:a,boundsIJK:o.boundsIJK,returnPoints:o.returnPoints??!1})},hasPixelSpacing:this.hasPixelSpacing,calibration:this.calibration,preScale:{scaled:!1}};return Object.defineProperty(r,"scalarData",{get:()=>this.getScalarData(),enumerable:!0}),i}hasImageURI(e){const n=e.match(v2.frameRangeExtractor),r=n?e.substring(0,n.index):e;return this.imageId.includes(r)}setVOI(e){this.voiRange=e;const n=this.setColorTransform(e,this.averageWhite);this.canvas.style.filter=n}setWindowLevel(e=256,n=128){const r=n-e/2,i=n+e/2-1;this.setVOI({lower:r,upper:i}),this.setColorTransform({lower:r,upper:i},this.averageWhite)}setAverageWhite(e){this.averageWhite=e,this.setColorTransform(this.voiRange,e)}setCamera(e){const{parallelScale:n,focalPoint:r}=e;if(n&&(this.videoCamera.parallelScale=this.element.clientHeight/2/n),r!==void 0){const i=this.worldToCanvas(r),a=[this.element.clientWidth/2,this.element.clientHeight/2],o=[(i[0]-a[0])/this.videoCamera.parallelScale,(i[1]-a[1])/this.videoCamera.parallelScale];this.videoCamera.panWorld=[this.videoCamera.panWorld[0]-o[0],this.videoCamera.panWorld[1]-o[1]]}this.canvasContext.fillStyle="rgba(0,0,0,1)",this.canvasContext.fillRect(0,0,this.canvas.width,this.canvas.height),this.isPlaying||this.renderFrame()}getCurrentImageId(e=this.getCurrentImageIdIndex()){return this.imageId?.replace("/frames/1",`/frames/${e+1}`)}getViewReferenceId(e={}){const{sliceIndex:n}=e;return n===void 0?`videoId:${this.getCurrentImageId()}`:Array.isArray(n)?`videoId:${this.imageId.substring(0,this.imageId.length-1)}${n[0]+1}-${n[1]+1}`:`videoId:${this.imageId.replace("/frames/1",`/frames/${1+n}`)}`}isReferenceViewable(e,n={}){let{imageURI:r}=n;const{referencedImageId:i,sliceIndex:a,multiSliceReference:o}=e;if(!super.isReferenceViewable(e))return!1;const s=this.getCurrentImageId();if(!r){const d=s.indexOf(":");r=s.substring(d+1,s.length-1)}if(n.withNavigation)return!0;const l=this.getSliceIndex();if(o){const d=Qg.imageIdToFrameEnd(o.referencedImageId);return l>=a&&l<=d}if(a!==void 0)return l===a;if(!i)return!1;const c=i.match(v2.frameRangeExtractor);if(!c||!c[2])return!0;const f=c[2].split("-").map(d=>Number(d)),u=l+1;return f[0]<=u&&u<=(f[1]??f[0])}setViewReference(e){typeof e.sliceIndex=="number"?this.setFrameNumber(e.sliceIndex+1):Array.isArray(e.sliceIndex)&&this.setFrameRange(e.sliceIndex)}getViewReference(e){const n=e?.sliceIndex??(this.isPlaying?this.frameRange[0]:this.getCurrentImageIdIndex()),r=e?.rangeEndSliceIndex??(this.isPlaying?this.frameRange[1]-1:void 0),i=r>n?{sliceIndex:r,referencedImageId:this.getCurrentImageId(r)}:void 0;return{...super.getViewReference(e),referencedImageId:this.getViewReferenceId(e),sliceIndex:n,multiSliceReference:i}}getFrameNumber(){return 1+this.getCurrentImageIdIndex()}getCurrentImageIdIndex(){return Math.round(this.videoElement.currentTime*this.fps)}getSliceIndex(){return this.getCurrentImageIdIndex()/this.scrollSpeed}getCamera(){const{parallelScale:e}=this.videoCamera,n=[this.element.clientWidth/2,this.element.clientHeight/2];return{parallelProjection:!0,focalPoint:this.canvasToWorld(n),position:[0,0,0],viewUp:[0,-1,0],parallelScale:this.element.clientHeight/2/e,viewPlaneNormal:[0,0,1]}}getFrameRate(){return this.fps}getPan(){const e=this.videoCamera.panWorld;return[e[0],e[1]]}refreshRenderValues(){let e=this.canvas.offsetWidth/this.videoWidth;this.videoHeight*e>this.canvas.height&&(e=this.canvas.offsetHeight/this.videoHeight);const n=Math.floor(this.videoWidth*e),r=Math.floor(this.videoHeight*e),i=(this.canvas.offsetWidth-n)/2,a=(this.canvas.offsetHeight-r)/2,o=i/e,s=a/e;this.videoCamera.panWorld=[o,s],this.videoCamera.parallelScale=e}getWorldToCanvasRatio(){return this.videoCamera.parallelScale}getCanvasToWorldRatio(){return 1/this.videoCamera.parallelScale}getTransform(){const e=this.videoCamera.panWorld,n=window.devicePixelRatio||1,r=this.getWorldToCanvasRatio(),i=this.getCanvasToWorldRatio(),a=[this.canvas.offsetWidth/2,this.canvas.offsetHeight/2],o=[a[0]*i,a[1]*i],s=new Xm;return s.scale(n,n),s.translate(a[0],a[1]),s.scale(r,r),s.translate(e[0],e[1]),s.translate(-o[0],-o[1]),s}updateCameraClippingPlanesAndRange(){}addImages(e){const n=this.getActors();e.forEach(r=>{const{imageId:i,...a}=r,o=yt.getImage(i),s=this.createActorMapper(o),l=r.actorUID??cr();s&&(n.push({uid:l,actor:s,referencedId:i,...a}),r.callback&&r.callback({imageActor:s,imageId:i}))}),this.setActors(n)}createActorMapper(e){return new zOe(this,e)}};v2.frameRangeExtractor=/(\/frames\/|[&?]frameNumber=)([^/&?]*)/i;let C3=v2;const WOe=`
.DicomMicroscopyViewer {
  --ol-partial-background-color: rgba(127, 127, 127, 0.7);
  --ol-foreground-color: #000000;
  --ol-subtle-foreground-color: #000;
  --ol-subtle-background-color: rgba(78, 78, 78, 0.5);
}

.DicomMicroscopyViewer .ol-box {
  box-sizing: border-box;
  border-radius: 2px;
  border: 1.5px solid var(--ol-background-color);
  background-color: var(--ol-partial-background-color);
}

.DicomMicroscopyViewer .ol-mouse-position {
  top: 8px;
  right: 8px;
  position: absolute;
}

.DicomMicroscopyViewer .ol-scale-line {
  background: var(--ol-partial-background-color);
  border-radius: 4px;
  bottom: 8px;
  left: 8px;
  padding: 2px;
  position: absolute;
}

.DicomMicroscopyViewer .ol-scale-line-inner {
  border: 1px solid var(--ol-subtle-foreground-color);
  border-top: none;
  color: var(--ol-foreground-color);
  font-size: 10px;
  text-align: center;
  margin: 1px;
  will-change: contents, width;
  transition: all 0.25s;
}

.DicomMicroscopyViewer .ol-scale-bar {
  position: absolute;
  bottom: 8px;
  left: 8px;
}

.DicomMicroscopyViewer .ol-scale-bar-inner {
  display: flex;
}

.DicomMicroscopyViewer .ol-scale-step-marker {
  width: 1px;
  height: 15px;
  background-color: var(--ol-foreground-color);
  float: right;
  z-index: 10;
}

.DicomMicroscopyViewer .ol-scale-step-text {
  position: absolute;
  bottom: -5px;
  font-size: 10px;
  z-index: 11;
  color: var(--ol-foreground-color);
  text-shadow:
    -1.5px 0 var(--ol-partial-background-color),
    0 1.5px var(--ol-partial-background-color),
    1.5px 0 var(--ol-partial-background-color),
    0 -1.5px var(--ol-partial-background-color);
}

.DicomMicroscopyViewer .ol-scale-text {
  position: absolute;
  font-size: 12px;
  text-align: center;
  bottom: 25px;
  color: var(--ol-foreground-color);
  text-shadow:
    -1.5px 0 var(--ol-partial-background-color),
    0 1.5px var(--ol-partial-background-color),
    1.5px 0 var(--ol-partial-background-color),
    0 -1.5px var(--ol-partial-background-color);
}

.DicomMicroscopyViewer .ol-scale-singlebar {
  position: relative;
  height: 10px;
  z-index: 9;
  box-sizing: border-box;
  border: 1px solid var(--ol-foreground-color);
}

.DicomMicroscopyViewer .ol-scale-singlebar-even {
  background-color: var(--ol-subtle-foreground-color);
}

.DicomMicroscopyViewer .ol-scale-singlebar-odd {
  background-color: var(--ol-background-color);
}

.DicomMicroscopyViewer .ol-unsupported {
  display: none;
}

.DicomMicroscopyViewer .ol-viewport,
.DicomMicroscopyViewer .ol-unselectable {
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -moz-user-select: none;
  user-select: none;
  -webkit-tap-highlight-color: transparent;
}

.DicomMicroscopyViewer .ol-viewport canvas {
  all: unset;
}

.DicomMicroscopyViewer .ol-selectable {
  -webkit-touch-callout: default;
  -webkit-user-select: text;
  -moz-user-select: text;
  user-select: text;
}

.DicomMicroscopyViewer .ol-grabbing {
  cursor: -webkit-grabbing;
  cursor: -moz-grabbing;
  cursor: grabbing;
}

.DicomMicroscopyViewer .ol-grab {
  cursor: move;
  cursor: -webkit-grab;
  cursor: -moz-grab;
  cursor: grab;
}

.DicomMicroscopyViewer .ol-control {
  position: absolute;
  background-color: var(--ol-subtle-background-color);
  border-radius: 4px;
}

.DicomMicroscopyViewer .ol-zoom {
  top: 0.5em;
  left: 0.5em;
}

.DicomMicroscopyViewer .ol-rotate {
  top: 0.5em;
  right: 0.5em;
  transition:
    opacity 0.25s linear,
    visibility 0s linear;
}

.DicomMicroscopyViewer .ol-rotate.ol-hidden {
  opacity: 0;
  visibility: hidden;
  transition:
    opacity 0.25s linear,
    visibility 0s linear 0.25s;
}

.DicomMicroscopyViewer .ol-zoom-extent {
  top: 4.643em;
  left: 0.5em;
}

.DicomMicroscopyViewer .ol-full-screen {
  right: 0.5em;
  top: 0.5em;
}

.DicomMicroscopyViewer .ol-control button {
  display: block;
  margin: 1px;
  padding: 0;
  color: var(--ol-subtle-foreground-color);
  font-weight: bold;
  text-decoration: none;
  font-size: inherit;
  text-align: center;
  height: 1.375em;
  width: 1.375em;
  line-height: 0.4em;
  background-color: var(--ol-background-color);
  border: none;
  border-radius: 2px;
}

.DicomMicroscopyViewer .ol-control button::-moz-focus-inner {
  border: none;
  padding: 0;
}

.DicomMicroscopyViewer .ol-zoom-extent button {
  line-height: 1.4em;
}

.DicomMicroscopyViewer .ol-compass {
  display: block;
  font-weight: normal;
  will-change: transform;
}

.DicomMicroscopyViewer .ol-touch .ol-control button {
  font-size: 1.5em;
}

.DicomMicroscopyViewer .ol-touch .ol-zoom-extent {
  top: 5.5em;
}

.DicomMicroscopyViewer .ol-control button:hover,
.DicomMicroscopyViewer .ol-control button:focus {
  text-decoration: none;
  outline: 1px solid var(--ol-subtle-foreground-color);
  color: var(--ol-foreground-color);
}

.DicomMicroscopyViewer .ol-zoom .ol-zoom-in {
  border-radius: 2px 2px 0 0;
}

.DicomMicroscopyViewer .ol-zoom .ol-zoom-out {
  border-radius: 0 0 2px 2px;
}

.DicomMicroscopyViewer .ol-attribution {
  text-align: right;
  bottom: 0.5em;
  right: 0.5em;
  max-width: calc(100% - 1.3em);
  display: flex;
  flex-flow: row-reverse;
  align-items: center;
}

.DicomMicroscopyViewer .ol-attribution a {
  color: var(--ol-subtle-foreground-color);
  text-decoration: none;
}

.DicomMicroscopyViewer .ol-attribution ul {
  margin: 0;
  padding: 1px 0.5em;
  color: var(--ol-foreground-color);
  text-shadow: 0 0 2px var(--ol-background-color);
  font-size: 12px;
}

.DicomMicroscopyViewer .ol-attribution li {
  display: inline;
  list-style: none;
}

.DicomMicroscopyViewer .ol-attribution li:not(:last-child):after {
  content: ' ';
}

.DicomMicroscopyViewer .ol-attribution img {
  max-height: 2em;
  max-width: inherit;
  vertical-align: middle;
}

.DicomMicroscopyViewer .ol-attribution button {
  flex-shrink: 0;
}

.DicomMicroscopyViewer .ol-attribution.ol-collapsed ul {
  display: none;
}

.DicomMicroscopyViewer .ol-attribution:not(.ol-collapsed) {
  background: var(--ol-partial-background-color);
}

.DicomMicroscopyViewer .ol-attribution.ol-uncollapsible {
  bottom: 0;
  right: 0;
  border-radius: 4px 0 0;
}

.DicomMicroscopyViewer .ol-attribution.ol-uncollapsible img {
  margin-top: -0.2em;
  max-height: 1.6em;
}

.DicomMicroscopyViewer .ol-attribution.ol-uncollapsible button {
  display: none;
}

.DicomMicroscopyViewer .ol-zoomslider {
  top: 4.5em;
  left: 0.5em;
  height: 200px;
}

.DicomMicroscopyViewer .ol-zoomslider button {
  position: relative;
  height: 10px;
}

.DicomMicroscopyViewer .ol-touch .ol-zoomslider {
  top: 5.5em;
}

.DicomMicroscopyViewer .ol-overviewmap {
  left: 0.5em;
  bottom: 0.5em;
}

.DicomMicroscopyViewer .ol-overviewmap.ol-uncollapsible {
  bottom: 0;
  left: 0;
  border-radius: 0 4px 0 0;
}

.DicomMicroscopyViewer .ol-overviewmap .ol-overviewmap-map,
.DicomMicroscopyViewer .ol-overviewmap button {
  display: block;
}

.DicomMicroscopyViewer .ol-overviewmap .ol-overviewmap-map {
  border: 1px solid var(--ol-subtle-foreground-color);
  height: 150px;
  width: 150px;
}

.DicomMicroscopyViewer .ol-overviewmap:not(.ol-collapsed) button {
  bottom: 0;
  left: 0;
  position: absolute;
}

.DicomMicroscopyViewer .ol-overviewmap.ol-collapsed .ol-overviewmap-map,
.DicomMicroscopyViewer .ol-overviewmap.ol-uncollapsible button {
  display: none;
}

.DicomMicroscopyViewer .ol-overviewmap:not(.ol-collapsed) {
  background: var(--ol-subtle-background-color);
}

.DicomMicroscopyViewer .ol-overviewmap-box {
  border: 0.5px dotted var(--ol-subtle-foreground-color);
}

.DicomMicroscopyViewer .ol-overviewmap .ol-overviewmap-box:hover {
  cursor: move;
}

@layout-header-background: #007ea3;
@primary-color: #007ea3;
@processing-color: #8cb8c6;
@success-color: #3f9c35;
@warning-color: #eeaf30;
@error-color: #96172e;
@font-size-base: 14px;

.DicomMicroscopyViewer .ol-tooltip {
  font-size: 16px !important;
}
`;let cv=null;const HOe="postrender",Og=class Og extends Bh{constructor(e){super({...e,canvas:e.canvas||nl(e.element)}),this.internalCamera={rotation:0,centerIndex:[0,0],extent:[0,-2,1,-1],xSpacing:1,ySpacing:1,resolution:1,zoom:1},this.voiRange={lower:0,upper:255},this.getProperties=()=>({voiRange:{...this.voiRange}}),this.resetCamera=()=>!0,this.getNumberOfSlices=()=>1,this.getFrameOfReferenceUID=()=>this.frameOfReferenceUID,this.resize=()=>{const r=this.canvas,{clientWidth:i,clientHeight:a}=r;(r.width!==i||r.height!==a)&&(r.width=i,r.height=a),this.refreshRenderValues()},this.canvasToWorld=r=>{if(!this.metadata)return;const i=this.canvasToIndex(r);return i[1]=-i[1],this.indexToWorld(i)},this.worldToCanvas=r=>{if(!this.metadata)return;const i=this.worldToIndex(r);return i[1]=-i[1],this.indexToCanvas([i[0],i[1],0])},this.postrender=()=>{this.refreshRenderValues(),wt(this.element,mt.IMAGE_RENDERED,{element:this.element,viewportId:this.id,viewport:this,renderingEngineId:this.renderingEngineId})},this.getRotation=()=>0,this.canvasToIndex=r=>{const i=this.getTransform();i.invert();const a=i.transformPoint(r.map(o=>o*devicePixelRatio));return[a[0],a[1],0]},this.indexToCanvas=r=>this.getTransform().transformPoint([r[0],r[1]]).map(a=>a/devicePixelRatio),this.customRenderViewportToCanvas=()=>{},this.getImageIds=()=>[this.imageIds[0]],this.renderingEngineId=e.renderingEngineId,this.element.setAttribute("data-viewport-uid",this.id),this.element.setAttribute("data-rendering-engine-uid",this.renderingEngineId),this.element.style.position="relative",this.microscopyElement=document.createElement("div"),this.microscopyElement.setAttribute("class","DicomMicroscopyViewer"),this.microscopyElement.id=cr(),this.microscopyElement.innerText="Initial",this.microscopyElement.style.background="grey",this.microscopyElement.style.width="100%",this.microscopyElement.style.height="100%",this.microscopyElement.style.position="absolute",this.microscopyElement.style.left="0",this.microscopyElement.style.top="0";const n=this.element.firstElementChild;n.insertBefore(this.microscopyElement,n.childNodes[1]),this.addEventListeners(),this.addWidget("DicomMicroscopyViewer",{getEnabled:()=>!!this.viewer,setEnabled:()=>{this.elementDisabledHandler()}}),this.resize()}static get useCustomRenderingPipeline(){return!0}addEventListeners(){this.canvas.addEventListener(mt.ELEMENT_DISABLED,this.elementDisabledHandler)}removeEventListeners(){this.canvas.removeEventListener(mt.ELEMENT_DISABLED,this.elementDisabledHandler)}elementDisabledHandler(){this.removeEventListeners(),this.viewer?.cleanup(),this.viewer=null,this.element.firstElementChild.removeChild(this.microscopyElement),this.microscopyElement=null}getImageDataMetadata(e=0){const n=this.metadataDicomweb.reduce((I,R)=>I?.NumberOfFrames<R.NumberOfFrames?R:I),{TotalPixelMatrixColumns:r,TotalPixelMatrixRows:i,ImageOrientationSlide:a,ImagedVolumeWidth:o,ImagedVolumeHeight:s,ImagedVolumeDepth:l}=n,c=Ut(ts.IMAGE_PLANE,this.imageIds[e]);let f=a.slice(0,3),u=a.slice(3,6);(f==null||u==null)&&(f=[1,0,0],u=[0,1,0]);const d=Sn(f[0],f[1],f[2]),h=Sn(u[0],u[1],u[2]),p=it();gr(p,d,h);const{XOffsetInSlideCoordinateSystem:g=0,YOffsetInSlideCoordinateSystem:m=0,ZOffsetInSlideCoordinateSystem:y=0}=n.TotalPixelMatrixOriginSequence?.[0]||{},v=[g,m,y],x=o/r,w=s/i,S=r,T=i,_=l,D=1;return this.hasPixelSpacing=!!(o&&s),{bitsAllocated:8,numberOfComponents:3,origin:v,direction:[...d,...h,...p],dimensions:[S,T,D],spacing:[x,w,_],hasPixelSpacing:this.hasPixelSpacing,numVoxels:S*T*D,imagePlaneModule:c}}async setFrameNumber(e){}setProperties(e){e.voiRange&&this.setVOI(e.voiRange)}resetProperties(){this.setProperties({voiRange:{lower:0,upper:255}})}setVOI(e){this.voiRange=e;const n=this.setColorTransform(e,this.averageWhite);this.map.getViewport().querySelectorAll(".ol-layers canvas").forEach(i=>{i.style.filter=n})}setAverageWhite(e){this.averageWhite=e,this.setColorTransform(this.voiRange,e)}getScalarData(){return null}computeTransforms(){const e=r0(),n=r0();return dX(e,this.metadata.origin),e[0]=this.metadata.direction[0],e[1]=this.metadata.direction[1],e[2]=this.metadata.direction[2],e[4]=this.metadata.direction[3],e[5]=this.metadata.direction[4],e[6]=this.metadata.direction[5],e[8]=this.metadata.direction[6],e[9]=this.metadata.direction[7],e[10]=this.metadata.direction[8],fX(e,e,this.metadata.spacing),e7(n,e),{indexToWorld:e,worldToIndex:n}}getImageData(){const{metadata:e}=this;if(!e)return null;const{spacing:n}=e,r={getDirection:()=>e.direction,getDimensions:()=>e.dimensions,getRange:()=>[0,255],getScalarData:()=>this.getScalarData(),getSpacing:()=>e.spacing,worldToIndex:a=>this.worldToIndex(a),indexToWorld:a=>this.indexToWorld(a)};return{dimensions:e.dimensions,spacing:n,numberOfComponents:3,origin:e.origin,direction:e.direction,metadata:{Modality:this.modality,FrameOfReferenceUID:this.frameOfReferenceUID},hasPixelSpacing:this.hasPixelSpacing,calibration:this.calibration,preScale:{scaled:!1},scalarData:this.getScalarData(),imageData:r}}hasImageURI(e){return!0}setCamera(e){const n=this.getCamera(),{parallelScale:r,focalPoint:i}=e,a=this.getView(),{xSpacing:o}=this.internalCamera;if(r){const l=this.element.clientHeight/r,c=1/o/l;a.setResolution(c)}if(i){const l=this.worldToCanvas(i),c=this.canvasToIndex(l);a.setCenter(c)}const s=this.getCamera();this.triggerCameraModifiedEventIfNecessary(n,s)}getCurrentImageId(){return this.imageIds[0]}getFrameNumber(){return 1}getCamera(){this.refreshRenderValues();const{resolution:e,xSpacing:n,centerIndex:r}=this.internalCamera,i=e*n,a=this.indexToCanvas([r[0],r[1],0]),o=this.canvasToWorld(a);return{parallelProjection:!0,focalPoint:o,position:o,viewUp:[0,-1,0],parallelScale:this.element.clientHeight*i,viewPlaneNormal:[0,0,1]}}worldToIndexWSI(e){if(!cv)return;const n=this.viewer.getAffine(),r=cv.applyInverseTransform({coordinate:[e[0],e[1]],affine:n});return[r[0],r[1]]}indexToWorldWSI(e){if(!cv)return;const n=cv.applyTransform({coordinate:[e[0],e[1]],affine:this.viewer.getAffine()});return[n[0],n[1],0]}worldToIndex(e){const{worldToIndex:n}=this.computeTransforms(),r=it();return z2(r,e,n),r}indexToWorld(e){const{indexToWorld:n}=this.computeTransforms(),r=it(),i=Sn(...e);return z2(r,i,n),[r[0],r[1],r[2]]}setDataIds(e,n){n?.miniNavigationOverlay!==!1&&Og.addMiniNavigationOverlayCss();const r=n?.webClient||Ut(ts.WADO_WEB_CLIENT,e[0]);if(!r)throw new Error(`To use setDataIds on WSI data, you must provide metaData.webClient for ${e[0]}`);return this.setWSI(e,r)}async setWSI(e,n){this.microscopyElement.style.background="black",this.microscopyElement.innerText="Loading",this.imageIds=e;const r=await Og.getDicomMicroscopyViewer();cv||=r.utils,this.frameOfReferenceUID=null;const i=this.imageIds.map(s=>{const l=n.getDICOMwebMetadata(s);Object.defineProperty(l,"isMultiframe",{value:l.isMultiframe,enumerable:!1}),Object.defineProperty(l,"frameNumber",{value:void 0,enumerable:!1});const c=l["00080008"]?.Value;c?.length===1&&(l["00080008"].Value=c[0].split("\\"));const f=l["00200052"]?.Value?.[0];return this.frameOfReferenceUID?f!==this.frameOfReferenceUID&&(l["00200052"].Value=[this.frameOfReferenceUID]):this.frameOfReferenceUID=f,l}),a=[];i.forEach(s=>{const l=new r.metadata.VLWholeSlideMicroscopyImage({metadata:s}),c=l.ImageType[2];c==="VOLUME"||c==="THUMBNAIL"?a.push(l):console.log("Unknown image type",l.ImageType)}),this.metadataDicomweb=a;const o=new r.viewer.VolumeImageViewer({client:n,metadata:a,controls:["overview","position"],retrieveRendered:!1,bindings:{}});o.render({container:this.microscopyElement}),this.metadata=this.getImageDataMetadata(),o.deactivateDragPanInteraction(),this.viewer=o,this.map=o.getMap(),this.map.on(HOe,this.postrender),this.resize(),this.microscopyElement.innerText="",Object.assign(this.microscopyElement.style,{"--ol-partial-background-color":"rgba(127, 127, 127, 0.7)","--ol-foreground-color":"#000000","--ol-subtle-foreground-color":"#000","--ol-subtle-background-color":"rgba(78, 78, 78, 0.5)",background:"none"})}scroll(e){const n=this.getCamera();this.setCamera({parallelScale:n.parallelScale*(1+.1*e)})}getSliceIndex(){return 0}getView(){if(!this.viewer)return;const e=this.viewer.getMap(),n=window;return n.map=e,n.viewer=this.viewer,n.view=e?.getView(),n.wsi=this,e?.getView()}refreshRenderValues(){const e=this.getView();if(!e)return;const n=e.getResolution();if(!n||n<al)return;const r=e.getCenter(),i=e.getProjection().getExtent(),a=e.getRotation(),o=e.getZoom(),{metadata:{spacing:[s,l]}}=this,c=1/n/s;Object.assign(this.internalCamera,{extent:i,centerIndex:r,worldToCanvasRatio:c,xSpacing:s,ySpacing:l,resolution:n,rotation:a,zoom:o})}getZoom(){return this.getView()?.getZoom()}setZoom(e){this.getView()?.setZoom(e)}getTransform(){this.refreshRenderValues();const{centerIndex:e,resolution:n,rotation:r}=this.internalCamera,i=[this.canvas.width/2,this.canvas.height/2],a=new Xm;return a.translate(i[0],i[1]),a.rotate(r),a.scale(1/n,-1/n),a.translate(-e[0],-e[1]),a}getViewReferenceId(){return`imageId:${this.getCurrentImageId()}`}getCurrentImageIdIndex(){return 0}static addMiniNavigationOverlayCss(){if(document.getElementById(this.overlayCssId))return;const e=document.createElement("style");e.innerText=WOe,e.setAttribute("id",this.overlayCssId),document.getElementsByTagName("head")[0].append(e)}};Og.getDicomMicroscopyViewer=async()=>oq("dicom-microscopy-viewer"),Og.overlayCssId="overlayCss";let S3=Og;const _Q={[Tr.ORTHOGRAPHIC]:da,[Tr.PERSPECTIVE]:da,[Tr.STACK]:fa,[Tr.VOLUME_3D]:nS,[Tr.VIDEO]:C3,[Tr.WHOLE_SLIDE]:S3};function iu(t){return _Q[t].useCustomRenderingPipeline}const xs={WIDTH:160,HEIGHT:96,TEXT_PADDING:3,TEXT_Y_OFFSET:2,GRAPH_Y_OFFSET:15,GRAPH_WIDTH:150,GRAPH_HEIGHT:70,FONT_SIZE:9,FONT_FAMILY:"Helvetica,Arial,sans-serif",GRAPH_ALPHA:.9},Qx={UPDATE_INTERVAL:1e3,MAX_MS_VALUE:200,MAX_FPS_VALUE:300,OVERLAY_STYLES:{position:"fixed",top:"0px",right:"0px",left:"auto",zIndex:"9999",cursor:"pointer",opacity:"0.9"}},r8={BYTES_TO_MB:1048576,MS_PER_SECOND:1e3},sf=[{name:"FPS",foregroundColor:"#0ff",backgroundColor:"#002"},{name:"MS",foregroundColor:"#0f0",backgroundColor:"#020"},{name:"MB",foregroundColor:"#f08",backgroundColor:"#201"}];class i8{constructor(e,n,r){this.minValue=1/0,this.maxValue=0,this.name=e,this.foregroundColor=n,this.backgroundColor=r,this.devicePixelRatio=Math.round(window.devicePixelRatio||1),this.dimensions=this.calculateDimensions(),this.dom=this.createCanvas(),this.context=this.initializeContext(),this.drawInitialPanel()}update(e,n){this.updateMinMax(e),this.clearTextArea(),this.drawText(e),this.scrollGraph(),this.drawNewValue(e,n)}calculateDimensions(){const e=this.devicePixelRatio;return{width:xs.WIDTH*e,height:xs.HEIGHT*e,textX:xs.TEXT_PADDING*e,textY:xs.TEXT_Y_OFFSET*e,graphX:xs.TEXT_PADDING*e,graphY:xs.GRAPH_Y_OFFSET*e,graphWidth:xs.GRAPH_WIDTH*e,graphHeight:xs.GRAPH_HEIGHT*e}}createCanvas(){const e=document.createElement("canvas");return e.width=this.dimensions.width,e.height=this.dimensions.height,e.style.cssText=`width:${xs.WIDTH}px;height:${xs.HEIGHT}px`,e}initializeContext(){const e=this.dom.getContext("2d");if(!e)throw new Error("Failed to get 2D context");return e.font=`bold ${xs.FONT_SIZE*this.devicePixelRatio}px ${xs.FONT_FAMILY}`,e.textBaseline="top",e}drawInitialPanel(){const{width:e,height:n,textX:r,textY:i,graphX:a,graphY:o,graphWidth:s,graphHeight:l}=this.dimensions;this.context.fillStyle=this.backgroundColor,this.context.fillRect(0,0,e,n),this.context.fillStyle=this.foregroundColor,this.context.fillText(this.name,r,i),this.context.fillRect(a,o,s,l),this.context.fillStyle=this.backgroundColor,this.context.globalAlpha=xs.GRAPH_ALPHA,this.context.fillRect(a,o,s,l),this.context.globalAlpha=1}updateMinMax(e){this.minValue=Math.min(this.minValue,e),this.maxValue=Math.max(this.maxValue,e)}clearTextArea(){const{width:e,graphY:n}=this.dimensions;this.context.fillStyle=this.backgroundColor,this.context.fillRect(0,0,e,n)}drawText(e){const{textX:n,textY:r}=this.dimensions,i=this.formatText(e);this.context.fillStyle=this.foregroundColor,this.context.fillText(i,n,r)}formatText(e){const n=Math.round(e),r=Math.round(this.minValue),i=Math.round(this.maxValue);return`${n} ${this.name} (${r}-${i})`}scrollGraph(){const{graphX:e,graphY:n,graphWidth:r,graphHeight:i}=this.dimensions,a=this.devicePixelRatio;this.context.drawImage(this.dom,e+a,n,r-a,i,e,n,r-a,i)}drawNewValue(e,n){const{graphX:r,graphY:i,graphWidth:a,graphHeight:o}=this.dimensions,s=this.devicePixelRatio,l=r+a-s;this.context.fillStyle=this.foregroundColor,this.context.fillRect(l,i,s,o);const c=Math.round((1-e/n)*o);this.context.fillStyle=this.backgroundColor,this.context.globalAlpha=xs.GRAPH_ALPHA,this.context.fillRect(l,i,s,c),this.context.globalAlpha=1}}var Ja;(function(t){t[t.FPS=0]="FPS",t[t.MS=1]="MS",t[t.MEMORY=2]="MEMORY"})(Ja||(Ja={}));var nu;let KOe=(nu=class{constructor(){this.dom=null,this.currentMode=0,this.startTime=0,this.lastUpdateTime=0,this.frameCount=0,this.panels=new Map,this.animationFrameId=null,this.isSetup=!1}static getInstance(){return nu.instance||(nu.instance=new nu),nu.instance}setup(){if(!this.isSetup)try{this.dom=this.createOverlayElement(),this.startTime=performance.now(),this.lastUpdateTime=this.startTime,this.initializePanels(),this.showPanel(Ja.FPS),this.applyOverlayStyles(),document.body.appendChild(this.dom),this.startLoop(),this.isSetup=!0}catch(e){console.warn("Failed to setup stats overlay:",e)}}cleanup(){this.stopLoop(),this.dom&&this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.dom=null,this.panels.clear(),this.isSetup=!1}showPanel(e){Array.from(this.dom.children).forEach((r,i)=>{r.style.display=i===e?"block":"none"}),this.currentMode=e}update(){this.startTime=this.updateStats()}createOverlayElement(){const e=document.createElement("div");return e.addEventListener("click",this.handleClick.bind(this),!1),e}applyOverlayStyles(){Object.assign(this.dom.style,Qx.OVERLAY_STYLES)}handleClick(e){e.preventDefault();const n=this.dom.children.length;this.showPanel((this.currentMode+1)%n)}initializePanels(){const e=new i8(sf[Ja.FPS].name,sf[Ja.FPS].foregroundColor,sf[Ja.FPS].backgroundColor);this.addPanel(Ja.FPS,e);const n=new i8(sf[Ja.MS].name,sf[Ja.MS].foregroundColor,sf[Ja.MS].backgroundColor);if(this.addPanel(Ja.MS,n),this.isMemoryAvailable()){const r=new i8(sf[Ja.MEMORY].name,sf[Ja.MEMORY].foregroundColor,sf[Ja.MEMORY].backgroundColor);this.addPanel(Ja.MEMORY,r)}}isMemoryAvailable(){return performance.memory!==void 0}addPanel(e,n){this.dom.appendChild(n.dom),this.panels.set(e,n)}startLoop(){const e=()=>{this.update(),this.animationFrameId=requestAnimationFrame(e)};this.animationFrameId=requestAnimationFrame(e)}stopLoop(){this.animationFrameId!==null&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=null)}updateStats(){this.frameCount++;const e=performance.now(),n=e-this.startTime,r=this.panels.get(Ja.MS);if(r&&r.update(n,Qx.MAX_MS_VALUE),e>=this.lastUpdateTime+Qx.UPDATE_INTERVAL){const i=this.frameCount*r8.MS_PER_SECOND/(e-this.lastUpdateTime),a=this.panels.get(Ja.FPS);a&&a.update(i,Qx.MAX_FPS_VALUE),this.lastUpdateTime=e,this.frameCount=0,this.updateMemoryPanel()}return e}updateMemoryPanel(){const e=this.panels.get(Ja.MEMORY);if(!e)return;const n=performance;if(n.memory){const r=n.memory.usedJSHeapSize/r8.BYTES_TO_MB,i=n.memory.jsHeapSizeLimit/r8.BYTES_TO_MB;e.update(r,i)}}},nu.instance=null,nu);const lF=KOe.getInstance(),T3=2;class cO{constructor(e){if(this._needsRender=new Set,this._animationFrameSet=!1,this._animationFrameHandle=null,this.renderFrameOfReference=r=>{const a=this._getViewportsAsArray().map(o=>{if(o.getFrameOfReferenceUID()===r)return o.id});this.renderViewports(a)},this.id=e||cr(),this.useCPURendering=Gg(),$2.set(this),!aq())throw new Error("@cornerstonejs/core is not initialized, run init() first");this._viewports=new Map,this.hasBeenDestroyed=!1,Vf()?.debug?.statsOverlay&&lF.setup()}enableElement(e){const n=this._normalizeViewportInputEntry(e);this._throwIfDestroyed();const{element:r,viewportId:i}=n;if(!r)throw new Error("No element provided");this.getViewport(i)&&this.disableElement(i);const{type:o}=n,s=iu(o);!this.useCPURendering&&!s?this.enableVTKjsDrivenViewport(n):this.addCustomViewport(n);const l=nl(r),{background:c}=n.defaultOptions;this.fillCanvasWithBackgroundColor(l,c)}disableElement(e){this._throwIfDestroyed();const n=this.getViewport(e);if(!n){console.warn(`viewport ${e} does not exist`);return}this._resetViewport(n),!iu(n.type)&&!this.useCPURendering&&this.offscreenMultiRenderWindow&&this.offscreenMultiRenderWindow.removeRenderer(e),this._removeViewport(e),n.isDisabled=!0,this._needsRender.delete(e),this.getViewports().length||this._clearAnimationFrame()}setViewports(e){const n=this._normalizeViewportInputEntries(e);this._throwIfDestroyed(),this._reset();const r=[],i=[];n.forEach(a=>{!this.useCPURendering&&!iu(a.type)?r.push(a):i.push(a)}),this.setVtkjsDrivenViewports(r),this.setCustomViewports(i),n.forEach(a=>{const o=nl(a.element),{background:s}=a.defaultOptions;this.fillCanvasWithBackgroundColor(o,s)})}resize(e=!0,n=!0){this._throwIfDestroyed();const r=this._getViewportsAsArray(),i=[],a=[];r.forEach(o=>{iu(o.type)?a.push(o):i.push(o)}),i.length&&this._resizeVTKViewports(i,n,e),a.length&&this._resizeUsingCustomResizeHandler(a,n,e)}getViewport(e){return this._viewports?.get(e)}getViewports(){return this._throwIfDestroyed(),this._getViewportsAsArray()}getStackViewport(e){this._throwIfDestroyed();const n=this.getViewport(e);if(!n)throw new Error(`Viewport with Id ${e} does not exist`);if(!(n instanceof fa))throw new Error(`Viewport with Id ${e} is not a StackViewport.`);return n}getStackViewports(){return this._throwIfDestroyed(),this.getViewports().filter(n=>n instanceof fa)}getVolumeViewports(){this._throwIfDestroyed();const e=this.getViewports(),n=r=>r instanceof mo;return e.filter(n)}render(){const n=this.getViewports().map(r=>r.id);this._setViewportsToBeRenderedNextFrame(n)}renderViewports(e){this._setViewportsToBeRenderedNextFrame(e)}renderViewport(e){this._setViewportsToBeRenderedNextFrame([e])}destroy(){this.hasBeenDestroyed||(lF.cleanup(),this.useCPURendering||(this._getViewportsAsArray().forEach(n=>{this.offscreenMultiRenderWindow&&this.offscreenMultiRenderWindow.removeRenderer(n.id)}),this.offscreenMultiRenderWindow&&this.offscreenMultiRenderWindow.delete(),delete this.offscreenMultiRenderWindow),this._reset(),$2.delete(this.id),this.hasBeenDestroyed=!0)}fillCanvasWithBackgroundColor(e,n){const r=e.getContext("2d");let i;if(n){const a=n.map(o=>Math.floor(255*o));i=`rgb(${a[0]}, ${a[1]}, ${a[2]})`}else i="black";r.fillStyle=i,r.fillRect(0,0,e.width,e.height)}_normalizeViewportInputEntry(e){const{type:n,defaultOptions:r}=e;let i=r;return(!i||Object.keys(i).length===0)&&(i={background:[0,0,0],orientation:null,displayArea:null},n===Tr.ORTHOGRAPHIC&&(i={...i,orientation:qd.AXIAL})),{...e,defaultOptions:i}}_normalizeViewportInputEntries(e){const n=[];return e.forEach(r=>{n.push(this._normalizeViewportInputEntry(r))}),n}_resizeUsingCustomResizeHandler(e,n=!0,r=!0){e.forEach(i=>{typeof i.resize=="function"&&i.resize()}),e.forEach(i=>{const a=i.getCamera();i.resetCamera(),n&&i.setCamera(a)}),r&&this.render()}_removeViewport(e){if(!this.getViewport(e)){console.warn(`viewport ${e} does not exist`);return}this._viewports.delete(e)}addCustomViewport(e){const{element:n,viewportId:r,type:i,defaultOptions:a}=e;n.tabIndex=-1;const o=nl(n),{clientWidth:s,clientHeight:l}=o;(o.width!==s||o.height!==l)&&(o.width=s,o.height=l);const c={id:r,renderingEngineId:this.id,element:n,type:i,canvas:o,sx:0,sy:0,sWidth:s,sHeight:l,defaultOptions:a||{}},f=_Q[i],u=new f(c);this._viewports.set(r,u);const d={element:n,viewportId:r,renderingEngineId:this.id};wt(vt,mt.ELEMENT_ENABLED,d)}getRenderer(e){return this.offscreenMultiRenderWindow.getRenderer(e)}getOffscreenMultiRenderWindow(e){if(this.useCPURendering)throw new Error("Offscreen multi render window is not available when using CPU rendering.");return this.offscreenMultiRenderWindow}setCustomViewports(e){e.forEach(n=>{this.addCustomViewport(n)})}_getViewportsAsArray(){return Array.from(this._viewports.values())}_setViewportsToBeRenderedNextFrame(e){e.forEach(n=>{this._needsRender.add(n)}),this._render()}_render(){this._needsRender.size>0&&!this._animationFrameSet&&(this._animationFrameHandle=window.requestAnimationFrame(this._renderFlaggedViewports),this._animationFrameSet=!0)}_resetViewport(e){const n=this.id,{element:r,canvas:i,id:a}=e,o={element:r,viewportId:a,renderingEngineId:n};e.removeWidgets(),wt(vt,mt.ELEMENT_DISABLED,o),r.removeAttribute("data-viewport-uid"),r.removeAttribute("data-rendering-engine-uid"),i.getContext("2d").clearRect(0,0,i.width,i.height)}_clearAnimationFrame(){window.cancelAnimationFrame(this._animationFrameHandle),this._needsRender.clear(),this._animationFrameSet=!1,this._animationFrameHandle=null}_reset(){this._getViewportsAsArray().forEach(n=>{this._resetViewport(n)}),this._clearAnimationFrame(),this._viewports=new Map}_throwIfDestroyed(){if(this.hasBeenDestroyed)throw new Error("this.destroy() has been manually called to free up memory, can not longer use this instance. Instead make a new one.")}}class uO extends cO{constructor(e){super(e),this._renderFlaggedViewports=()=>{this._throwIfDestroyed(),this.useCPURendering||this.performVtkDrawCall();const n=this._getViewportsAsArray(),r=[];for(let i=0;i<n.length;i++){const a=n[i];if(this._needsRender.has(a.id)){const o=this.renderViewportUsingCustomOrVtkPipeline(a);if(r.push(o),a.setRendered(),this._needsRender.delete(a.id),this._needsRender.size===0)break}}this._animationFrameSet=!1,this._animationFrameHandle=null,r.forEach(i=>{i?.element&&wt(i.element,mt.IMAGE_RENDERED,i)})},this.useCPURendering||(this.offscreenMultiRenderWindow=DZ.newInstance(),this.offScreenCanvasContainer=document.createElement("div"),this.offscreenMultiRenderWindow.setContainer(this.offScreenCanvasContainer))}enableVTKjsDrivenViewport(e){const r=this._getViewportsAsArray().filter(f=>iu(f.type)===!1),i=r.map(f=>f.canvas),a=nl(e.element);i.push(a);const{offScreenCanvasWidth:o,offScreenCanvasHeight:s}=this._resizeOffScreenCanvas(i),l=this._resize(r,o,s),c={...e,canvas:a};this.addVtkjsDrivenViewport(c,{offScreenCanvasWidth:o,offScreenCanvasHeight:s,xOffset:l})}addVtkjsDrivenViewport(e,n){const{element:r,canvas:i,viewportId:a,type:o,defaultOptions:s}=e;r.tabIndex=-1;const{offScreenCanvasWidth:l,offScreenCanvasHeight:c,xOffset:f}=n,{sxStartDisplayCoords:u,syStartDisplayCoords:d,sxEndDisplayCoords:h,syEndDisplayCoords:p,sx:g,sy:m,sWidth:y,sHeight:v}=this._getViewportCoordsOnOffScreenCanvas(e,l,c,f);this.offscreenMultiRenderWindow.addRenderer({viewport:[u,d,h,p],id:a,background:s.background?s.background:[0,0,0]});const x={id:a,element:r,renderingEngineId:this.id,type:o,canvas:i,sx:g,sy:m,sWidth:y,sHeight:v,defaultOptions:s||{}};let w;if(o===Tr.STACK)w=new fa(x);else if(o===Tr.ORTHOGRAPHIC||o===Tr.PERSPECTIVE)w=new da(x);else if(o===Tr.VOLUME_3D)w=new nS(x);else throw new Error(`Viewport Type ${o} is not supported`);this._viewports.set(a,w);const S={element:r,viewportId:a,renderingEngineId:this.id};w.suppressEvents||wt(vt,mt.ELEMENT_ENABLED,S)}setVtkjsDrivenViewports(e){if(e.length){const n=e.map(o=>nl(o.element));n.forEach(o=>{const s=window.devicePixelRatio||1,l=o.getBoundingClientRect();o.width=l.width*s,o.height=l.height*s});const{offScreenCanvasWidth:r,offScreenCanvasHeight:i}=this._resizeOffScreenCanvas(n);let a=0;for(let o=0;o<e.length;o++){const s=e[o],l=n[o],c={...s,canvas:l};this.addVtkjsDrivenViewport(c,{offScreenCanvasWidth:r,offScreenCanvasHeight:i,xOffset:a}),a+=l.width}}}_resizeVTKViewports(e,n=!0,r=!0){const i=e.map(a=>nl(a.element));if(i.forEach(a=>{const o=window.devicePixelRatio||1;a.width=a.clientWidth*o,a.height=a.clientHeight*o}),i.length){const{offScreenCanvasWidth:a,offScreenCanvasHeight:o}=this._resizeOffScreenCanvas(i);this._resize(e,a,o)}e.forEach(a=>{const o=a.getCamera(),s=a.getRotation(),{flipHorizontal:l}=o;a.resetCameraForResize();const c=a.getDisplayArea();n&&(c?(l&&a.setCamera({flipHorizontal:l}),s&&a.setViewPresentation({rotation:s})):a.setCamera(o))}),r&&this.render()}performVtkDrawCall(){const{offscreenMultiRenderWindow:e}=this,n=e.getRenderWindow(),r=e.getRenderers();if(r.length){for(let i=0;i<r.length;i++){const{renderer:a,id:o}=r[i];this._needsRender.has(o)?a.setDraw(!0):a.setDraw(!1)}n.render();for(let i=0;i<r.length;i++)r[i].renderer.setDraw(!1)}}renderViewportUsingCustomOrVtkPipeline(e){let n;if(e.sWidth<T3||e.sHeight<T3){console.warn("Viewport is too small",e.sWidth,e.sHeight);return}if(iu(e.type)===!0)n=e.customRenderViewportToCanvas();else{if(this.useCPURendering)throw new Error("GPU not available, and using a viewport with no custom render pipeline.");const{offscreenMultiRenderWindow:r}=this,o=r.getOpenGLRenderWindow().get3DContext().canvas;n=this._renderViewportFromVtkCanvasToOnscreenCanvas(e,o)}return n}_renderViewportFromVtkCanvasToOnscreenCanvas(e,n){const{element:r,canvas:i,sx:a,sy:o,sWidth:s,sHeight:l,id:c,renderingEngineId:f,suppressEvents:u}=e,{width:d,height:h}=i;return i.getContext("2d").drawImage(n,a,o,s,l,0,0,d,h),{element:r,suppressEvents:u,viewportId:c,renderingEngineId:f,viewportStatus:e.viewportStatus}}_resizeOffScreenCanvas(e){const{offScreenCanvasContainer:n,offscreenMultiRenderWindow:r}=this,i=Math.max(...e.map(o=>o.height));let a=0;return e.forEach(o=>{a+=o.width}),n.width=a,n.height=i,r.resize(),{offScreenCanvasWidth:a,offScreenCanvasHeight:i}}_resize(e,n,r){let i=0;for(let a=0;a<e.length;a++){const o=e[a],{sxStartDisplayCoords:s,syStartDisplayCoords:l,sxEndDisplayCoords:c,syEndDisplayCoords:f,sx:u,sy:d,sWidth:h,sHeight:p}=this._getViewportCoordsOnOffScreenCanvas(o,n,r,i);i+=o.canvas.width,o.sx=u,o.sy=d,o.sWidth=h,o.sHeight=p,this.offscreenMultiRenderWindow.getRenderer(o.id).setViewport(s,l,c,f)}return i}_getViewportCoordsOnOffScreenCanvas(e,n,r,i){const{canvas:a}=e,{width:o,height:s}=a,l=i,c=0,f=l/n,u=c+(r-s)/r,d=o/n,h=s/r;return{sxStartDisplayCoords:f,syStartDisplayCoords:u,sxEndDisplayCoords:f+d,syEndDisplayCoords:u+h,sx:l,sy:c,sWidth:o,sHeight:s}}}class qOe{constructor(e){this.contexts=[],this.offScreenCanvasContainers=[],this.viewportToContext=new Map;for(let n=0;n<e;n++){const r=DZ.newInstance(),i=document.createElement("div");r.setContainer(i),this.contexts.push(r),this.offScreenCanvasContainers.push(i)}}getContextByIndex(e){return e>=0&&e<this.contexts.length?{context:this.contexts[e],container:this.offScreenCanvasContainers[e]}:null}assignViewportToContext(e,n){this.viewportToContext.set(e,n)}getContextIndexForViewport(e){return this.viewportToContext.get(e)}getAllContexts(){return this.contexts}getContextCount(){return this.contexts.length}destroy(){this.contexts.forEach(e=>{e.delete()}),this.contexts=[],this.offScreenCanvasContainers=[],this.viewportToContext.clear()}}class K_ extends cO{constructor(e){super(e),this._renderFlaggedViewports=()=>{this._throwIfDestroyed();const a=this._getViewportsAsArray().filter(s=>this._needsRender.has(s.id));if(a.length===0){this._animationFrameSet=!1,this._animationFrameHandle=null;return}const o=a.map(s=>{const l=this.renderViewportUsingCustomOrVtkPipeline(s);return s.setRendered(),this._needsRender.delete(s.id),l});this._animationFrameSet=!1,this._animationFrameHandle=null,o.forEach(s=>{s?.element&&wt(s.element,mt.IMAGE_RENDERED,s)})};const{rendering:n}=Vf(),{webGlContextCount:r}=n;this.useCPURendering||(this.contextPool=new qOe(r))}enableVTKjsDrivenViewport(e){const i=this._getViewportsAsArray().filter(s=>iu(s.type)===!1).map(s=>s.canvas),a=nl(e.element);i.push(a);const o={...e,canvas:a};this.addVtkjsDrivenViewport(o)}addVtkjsDrivenViewport(e){const{element:n,canvas:r,viewportId:i,type:a,defaultOptions:o}=e;n.tabIndex=-1;let s=0;if(a===Tr.STACK){const h=this.contextPool.getAllContexts();s=this._viewports.size%h.length}this.contextPool.assignViewportToContext(i,s);const l=this.contextPool.getContextByIndex(s),{context:c}=l;c.addRenderer({viewport:[0,0,1,1],id:i,background:o.background?o.background:[0,0,0]});const f={id:i,element:n,renderingEngineId:this.id,type:a,canvas:r,sx:0,sy:0,sWidth:r.width,sHeight:r.height,defaultOptions:o||{}};let u;if(a===Tr.STACK)u=new fa(f);else if(a===Tr.ORTHOGRAPHIC||a===Tr.PERSPECTIVE)u=new da(f);else if(a===Tr.VOLUME_3D)u=new nS(f);else throw new Error(`Viewport Type ${a} is not supported`);this._viewports.set(i,u);const d={element:n,viewportId:i,renderingEngineId:this.id};u.suppressEvents||wt(vt,mt.ELEMENT_ENABLED,d)}setVtkjsDrivenViewports(e){if(e.length){const n=e.map(r=>nl(r.element));n.forEach(r=>{const i=window.devicePixelRatio||1,a=r.getBoundingClientRect();r.width=a.width*i,r.height=a.height*i});for(let r=0;r<e.length;r++){const i=e[r],a=n[r],o={...i,canvas:a};this.addVtkjsDrivenViewport(o)}}}_resizeVTKViewports(e,n=!0,r=!0){const i=e.map(a=>nl(a.element));i.forEach(a=>{const o=window.devicePixelRatio||1;a.width=a.clientWidth*o,a.height=a.clientHeight*o}),i.length&&this._resize(e),e.forEach(a=>{const o=a.getCamera(),s=a.getRotation(),{flipHorizontal:l}=o;a.resetCameraForResize();const c=a.getDisplayArea();n&&(c?(l&&a.setCamera({flipHorizontal:l}),s&&a.setViewPresentation({rotation:s})):a.setCamera(o))}),r&&this.render()}renderViewportUsingCustomOrVtkPipeline(e){if(iu(e.type))return e.customRenderViewportToCanvas();if(this.useCPURendering)throw new Error("GPU not available, and using a viewport with no custom render pipeline.");const n=this.contextPool.getContextIndexForViewport(e.id),r=this.contextPool.getContextByIndex(n),{context:i,container:a}=r;return this._renderViewportWithContext(e,i,a)}_renderViewportWithContext(e,n,r){if(e.sWidth<T3||e.sHeight<T3){console.warn("Viewport is too small",e.sWidth,e.sHeight);return}if(iu(e.type))return e.customRenderViewportToCanvas();if(this.useCPURendering)throw new Error("GPU not available, and using a viewport with no custom render pipeline.");n.getRenderer(e.id)||n.addRenderer({viewport:[0,0,1,1],id:e.id,background:e.defaultOptions?.background||[0,0,0]});const i=n.getRenderWindow();this._resizeOffScreenCanvasForViewport(e.canvas,r,n),n.getRenderer(e.id).setViewport(0,0,1,1);const o=n.getRenderers();o.forEach(({renderer:d,id:h})=>{d.setDraw(h===e.id)});const s=this.getWidgetRenderers();s.forEach((d,h)=>{h.setDraw(d===e.id)}),i.render(),o.forEach(({renderer:d})=>d.setDraw(!1)),s.forEach((d,h)=>{h.setDraw(!1)});const f=n.getOpenGLRenderWindow().get3DContext().canvas;return this._copyToOnscreenCanvas(e,f)}_renderViewportFromVtkCanvasToOnscreenCanvas(e,n){return this._copyToOnscreenCanvas(e,n)}_resizeOffScreenCanvasForViewport(e,n,r){const i=e.width,a=e.height;n.height===a&&n.width===i||(n.width=i,n.height=a,r.resize())}_copyToOnscreenCanvas(e,n){const{element:r,canvas:i,id:a,renderingEngineId:o,suppressEvents:s}=e,{width:l,height:c}=i;return i.getContext("2d").drawImage(n,0,0,l,c,0,0,l,c),{element:r,suppressEvents:s,viewportId:a,renderingEngineId:o,viewportStatus:e.viewportStatus}}_resize(e){for(const n of e){n.sx=0,n.sy=0,n.sWidth=n.canvas.width,n.sHeight=n.canvas.height;const r=this.contextPool.getContextIndexForViewport(n.id),i=this.contextPool.getContextByIndex(r),{context:a}=i;a.getRenderer(n.id).setViewport(0,0,1,1)}}getWidgetRenderers(){const e=this._getViewportsAsArray(),n=new Map;return e.forEach(r=>{(r.getWidgets?r.getWidgets():[]).forEach(a=>{const o=a.getRenderer?a.getRenderer():null;o&&n.set(o,r.id)})}),n}getRenderer(e){const n=this.contextPool?.getContextIndexForViewport(e),r=this.contextPool.getContextByIndex(n),{context:i}=r;return i.getRenderer(e)}disableElement(e){const n=this.getViewport(e);if(n&&(super.disableElement(e),!iu(n.type)&&!this.useCPURendering)){const r=this.contextPool.getContextIndexForViewport(e);if(r!==void 0){const i=this.contextPool.getContextByIndex(r);if(i){const{context:a}=i;a.removeRenderer(e)}}}}destroy(){this.contextPool&&this.contextPool.destroy(),super.destroy()}getOffscreenMultiRenderWindow(e){if(this.useCPURendering)throw new Error("Offscreen multi render window is not available when using CPU rendering.");const n=this.contextPool.getContextIndexForViewport(e);return this.contextPool.getContextByIndex(n).context}}class DQ{constructor(e){const r=Vf()?.rendering?.renderingEngineMode;switch(r){case Ah.Tiled:this._implementation=new uO(e);break;case Ah.ContextPool:this._implementation=new K_(e);break;default:console.warn(`RenderingEngine: Unknown rendering engine mode "${r}". Defaulting to Next rendering engine.`),this._implementation=new K_(e);break}}get id(){return this._implementation.id}enableElement(e){return this._implementation.enableElement(e)}disableElement(e){return this._implementation.disableElement(e)}setViewports(e){return this._implementation.setViewports(e)}resize(e=!0,n=!0){return this._implementation.resize(e,n)}getViewport(e){return this._implementation.getViewport(e)}getViewports(){return this._implementation.getViewports()}getStackViewport(e){return this._implementation.getStackViewport(e)}getStackViewports(){return this._implementation.getStackViewports()}getVolumeViewports(){return this._implementation.getVolumeViewports()}getRenderer(e){return this._implementation.getRenderer(e)}fillCanvasWithBackgroundColor(e,n){return this._implementation.fillCanvasWithBackgroundColor(e,n)}render(){return this._implementation.render()}renderViewports(e){return this._implementation.renderViewports(e)}renderViewport(e){return this._implementation.renderViewport(e)}destroy(){return this._implementation.destroy()}getOffscreenMultiRenderWindow(e){return this._implementation.getOffscreenMultiRenderWindow(e)}}const XOe="3.33.5";class OQ{constructor(e){this._color=[200,0,0],this.id=e.id,this._points=e.points,this._polys=e.polys,this._color=e.color??this._color,this.frameOfReferenceUID=e.frameOfReferenceUID,this._segmentIndex=e.segmentIndex,this.sizeInBytes=this._getSizeInBytes(),this._updateCentroid(),this._visible=!0}_getSizeInBytes(){return this._points.length*4+this._polys.length*4}_updateCentroid(){const e=this._points.length/3;let n=0,r=0,i=0;for(let a=0;a<this._points.length;a+=3)n+=this._points[a],r+=this._points[a+1],i+=this._points[a+2];this._centroid=[n/e,r/e,i/e]}get color(){return this._color}set color(e){this._color=e}get points(){return this._points}set points(e){this._points=e,this._updateCentroid()}get polys(){return this._polys}set polys(e){this._polys=e}get segmentIndex(){return this._segmentIndex}get visible(){return this._visible}set visible(e){this._visible=e}get centroid(){return this._centroid}get flatPointsArray(){return this._points}get totalNumberOfPoints(){return this._points.length/3}}function MQ(t){return new TextDecoder("latin1").decode(t)}function YOe(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;const r=MQ(t),i=e.exec(r);if(!i)return{text:r};const a=i.index+i[0].length,o=r.substring(0,a);let s=null;const l=n?n.exec(r):null;if(l){const c=r.substr(l.index);s={text:o+c,binaryBuffer:t.slice(a,l.index)}}else s={text:o,binaryBuffer:t.slice(a)};return s}var J2={arrayBufferToString:MQ,extractBinary:YOe};const fO={};function IQ(t){return!!fO[t]}function JOe(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"http",e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return fO[t](e)}function RQ(t,e){fO[t]=e}var Uy={get:JOe,has:IQ,registerType:RQ};function PQ(){const t=new ArrayBuffer(4),e=new Uint8Array(t),n=new Uint32Array(t);return e[0]=161,e[1]=178,e[2]=195,e[3]=212,n[0]===3569595041?"LittleEndian":n[0]===2712847316?"BigEndian":null}const ZOe=PQ();function QOe(t,e){if(e<2)return;const n=new Int8Array(t),r=n.length,i=[];for(let a=0;a<r;a+=e){for(let o=0;o<e;o++)i.push(n[a+o]);for(let o=0;o<e;o++)n[a+o]=i.pop()}}var a8={ENDIANNESS:ZOe,getEndianness:PQ,swapBytes:QOe};const{vtkErrorMacro:AQ,vtkDebugMacro:eMe}=ce,dO=()=>(AQ("LiteHttpDataAccessHelper does not support compression. Need to register HttpDataAccessHelper instead."),Promise.reject(new Error("LiteHttpDataAccessHelper does not support compression. Need to register HttpDataAccessHelper instead.")));let mm=0;function rS(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=new XMLHttpRequest;return r.open(t,e,!0),n.headers&&Object.entries(n.headers).forEach(i=>{let[a,o]=i;return r.setRequestHeader(a,o)}),n.progressCallback&&r.addEventListener("progress",n.progressCallback),r}function tMe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise((n,r)=>{const i=rS("GET",t,e);i.onreadystatechange=a=>{i.readyState===4&&(i.status===200||i.status===0?n(i.response):r({xhr:i,e:a}))},i.responseType="arraybuffer",i.send()})}function nMe(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return r&&r.compression?dO():n.ref&&!n.ref.pending?new Promise((i,a)=>{const o=[e,n.ref.basepath,n.ref.id].join("/"),s=rS("GET",o,r);s.onreadystatechange=l=>{s.readyState===1&&(n.ref.pending=!0,++mm===1&&t?.invokeBusy&&t.invokeBusy(!0)),s.readyState===4&&(n.ref.pending=!1,s.status===200||s.status===0?(n.buffer=s.response,n.ref.encode==="JSON"?n.values=JSON.parse(n.buffer):(a8.ENDIANNESS!==n.ref.encode&&a8.ENDIANNESS&&(eMe(`Swap bytes of ${n.name}`),a8.swapBytes(n.buffer,eX[n.dataType])),n.values=ce.newTypedArray(n.dataType,n.buffer)),n.values.length!==n.size&&AQ(`Error in FetchArray: ${n.name}, does not have the proper array size. Got ${n.values.length}, instead of ${n.size}`),delete n.ref,--mm===0&&t?.invokeBusy&&t.invokeBusy(!1),t?.modified&&t.modified(),i(n)):a({xhr:s,e:l}))},s.responseType=n.dataType!=="string"?"arraybuffer":"text",s.send()}):Promise.resolve(n)}function rMe(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return n&&n.compression?dO():new Promise((r,i)=>{const a=rS("GET",e,n);a.onreadystatechange=o=>{a.readyState===1&&++mm===1&&t?.invokeBusy&&t.invokeBusy(!0),a.readyState===4&&(--mm===0&&t?.invokeBusy&&t.invokeBusy(!1),a.status===200||a.status===0?r(JSON.parse(a.responseText)):i({xhr:a,e:o}))},a.responseType="text",a.send()})}function iMe(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return n&&n.compression?dO():new Promise((r,i)=>{const a=rS("GET",e,n);a.onreadystatechange=o=>{a.readyState===1&&++mm===1&&t?.invokeBusy&&t.invokeBusy(!0),a.readyState===4&&(--mm===0&&t?.invokeBusy&&t.invokeBusy(!1),a.status===200||a.status===0?r(a.responseText):i({xhr:a,e:o}))},a.responseType="text",a.send()})}function aMe(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return new Promise((r,i)=>{const a=new Image;n.crossOrigin&&(a.crossOrigin=n.crossOrigin),a.onload=()=>r(a),a.onerror=i,a.src=e})}const oMe={fetchArray:nMe,fetchJSON:rMe,fetchText:iMe,fetchBinary:tMe,fetchImage:aMe};IQ("http")||RQ("http",t=>oMe);const o8={ASCII:"ascii",BINARY_LITTLE_ENDIAN:"binary_little_endian"},cF={diffuse_red:"red",diffuse_green:"green",diffuse_blue:"blue"},NQ={patternHeader:/ply([\s\S]*)end_header\r?\n/,patternBody:/end_header\s([\s\S]*)$/};function uF(t){let e="",n=0;const r=NQ.patternHeader.exec(t);r!==null&&(e=r[1],n=r[0].length);const i={comments:[],elements:[],headerLength:n},a=e.split(`
`);let o,s,l;for(let c=0;c<a.length;c++){let f=a[c];if(f=f.trim(),f!==""){let u;switch(l=f.split(/\s+/),s=l.shift(),f=l.join(" "),s){case"format":i.format=l[0],i.version=l[1];break;case"comment":i.comments.push(f);break;case"element":o!==void 0&&i.elements.push(o),o={},o.name=l[0],o.count=parseInt(l[1],10),o.properties=[];break;case"property":u={type:l[0]},u.type==="list"?(u.name=l[3],u.countType=l[1],u.itemType=l[2]):u.name=l[1],u.name in cF&&(u.name=cF[u.name]),o.properties.push(u);break;case"obj_info":i.objInfo=f;break;default:console.warn("unhandled",s,l);break}}}return o!==void 0&&i.elements.push(o),i}function fF(t,e){const n=e.find(g=>g.name==="vertex"),r=e.find(g=>g.name==="face");let i=0,a=0;n&&(i=n.count),r&&(a=r.count);const o=new Float32Array(i*3),s=new Uint8Array(i*3),l=new Float32Array(i*2),c=new Float32Array(i*3),f=t.colors.length>0,u=t.uvs.length>0,d=t.normals.length>0,h=t.faceVertexUvs.length>0;for(let g=0;g<i;g++){let m=g*3+0,y=g*3+1;const v=g*3+2;o[m]=t.vertices[m],o[y]=t.vertices[y],o[v]=t.vertices[v],f&&(s[m]=t.colors[m],s[y]=t.colors[y],s[v]=t.colors[v]),u&&(m=g*2+0,y=g*2+1,l[m]=t.uvs[m],l[y]=t.uvs[y]),d&&(c[m]=t.normals[m],c[y]=t.normals[y],c[v]=t.normals[v])}if(!u&&h){let g=0,m=0;for(let y=0;y<a;++y){const v=t.indices[g++],x=t.faceVertexUvs[m++];if(x&&v*2===x.length)for(let w=0;w<v;++w){const S=t.indices[g++];l[S*2+0]=x[w*2+0],l[S*2+1]=x[w*2+1]}else g+=v}}const p=ca.newInstance();if(p.getPoints().setData(o,3),f&&p.getPointData().setScalars(tn.newInstance({numberOfComponents:3,values:s,name:"Scalars"})),u||h){const g=tn.newInstance({numberOfComponents:2,values:l,name:"TextureCoordinates"}),m=p.getPointData();m.addArray(g),m.setActiveTCoords(g.getName())}return d&&p.getPointData().setNormals(tn.newInstance({numberOfComponents:3,name:"Normals",values:c})),p.getPolys().setData(Uint32Array.from(t.indices)),p}function s8(t,e){let n;switch(e){case"char":case"uchar":case"short":case"ushort":case"int":case"uint":case"int8":case"uint8":case"int16":case"uint16":case"int32":case"uint32":n=parseInt(t,10);break;case"float":case"double":case"float32":case"float64":n=parseFloat(t);break;default:console.log("Unsupported type");break}return n}function sMe(t,e){const n=e.split(/\s+/),r={};for(let i=0;i<t.length;i++)if(t[i].type==="list"){const a=[],o=s8(n.shift(),t[i].countType);for(let s=0;s<o;s++)a.push(s8(n.shift(),t[i].itemType));r[t[i].name]=a}else r[t[i].name]=s8(n.shift(),t[i].type);return r}function dF(t,e,n){if(e==="vertex")t.vertices.push(n.x,n.y,n.z),"nx"in n&&"ny"in n&&"nz"in n&&t.normals.push(n.nx,n.ny,n.nz),"s"in n&&"t"in n?t.uvs.push(n.s,n.t):"u"in n&&"v"in n?t.uvs.push(n.u,n.v):"texture_u"in n&&"texture_v"in n&&t.uvs.push(n.texture_u,n.texture_v),"red"in n&&"green"in n&&"blue"in n&&t.colors.push(n.red,n.green,n.blue);else if(e==="face"){const r=n.vertex_indices||n.vertex_index,i=n.texcoord;r&&r.length>0&&(t.indices.push(r.length),r.forEach((a,o)=>{t.indices.push(a)})),t.faceVertexUvs.push(i)}}function l8(t,e,n,r){let i;switch(n){case"int8":case"char":i=[t.getInt8(e),1];break;case"uint8":case"uchar":i=[t.getUint8(e),1];break;case"int16":case"short":i=[t.getInt16(e,r),2];break;case"uint16":case"ushort":i=[t.getUint16(e,r),2];break;case"int32":case"int":i=[t.getInt32(e,r),4];break;case"uint32":case"uint":i=[t.getUint32(e,r),4];break;case"float32":case"float":i=[t.getFloat32(e,r),4];break;case"float64":case"double":i=[t.getFloat64(e,r),8];break;default:console.log("Unsupported type");break}return i}function lMe(t,e,n,r){const i={};let a,o=0;for(let s=0;s<n.length;s++)if(n[s].type==="list"){const l=[];a=l8(t,e+o,n[s].countType,r);const c=a[0];o+=a[1];for(let f=0;f<c;f++)a=l8(t,e+o,n[s].itemType,r),l.push(a[0]),o+=a[1];i[n[s].name]=l}else a=l8(t,e+o,n[s].type,r),i[n[s].name]=a[0],o+=a[1];return[i,o]}function cMe(t,e){e.classHierarchy.push("vtkPLYReader"),e.dataAccessHelper||(e.dataAccessHelper=Uy.get("http"));function n(r){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{compression:a,progressCallback:o}=e;return i.binary?e.dataAccessHelper.fetchBinary(r,{compression:a,progressCallback:o}):e.dataAccessHelper.fetchText(t,r,{compression:a,progressCallback:o})}t.setUrl=function(r){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{binary:!0};e.url=r;const a=r.split("/");return a.pop(),e.baseURL=a.join("/"),e.compression=i.compression,t.loadData({progressCallback:i.progressCallback,binary:!!i.binary})},t.loadData=function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const i=n(e.url,r);return i.then(t.parse),i},t.parse=r=>{typeof r=="string"?t.parseAsText(r):t.parseAsArrayBuffer(r)},t.parseAsArrayBuffer=r=>{if(!r)return;if(r!==e.parseData)t.modified();else return;const i=J2.arrayBufferToString(r),a=uF(i);if(!(a.format!==o8.ASCII)){t.parseAsText(r);return}e.parseData=r;const s={indices:[],vertices:[],normals:[],uvs:[],faceVertexUvs:[],colors:[]},l=a.format===o8.BINARY_LITTLE_ENDIAN,c=r instanceof ArrayBuffer?r:r.buffer,f=new DataView(c,a.headerLength);let u,d=0;for(let p=0;p<a.elements.length;p++)for(let g=0;g<a.elements[p].count;g++){u=lMe(f,d,a.elements[p].properties,l),d+=u[1];const m=u[0];dF(s,a.elements[p].name,m)}const h=fF(s,a.elements);e.output[0]=h},t.parseAsText=r=>{if(!r)return;if(r!==e.parseData)t.modified();else return;e.parseData=r;const i=J2.arrayBufferToString(r),a=uF(i);if(a.format!==o8.ASCII){t.parseAsArrayBuffer(r);return}const s={indices:[],vertices:[],normals:[],uvs:[],faceVertexUvs:[],colors:[]},l=NQ.patternBody.exec(i);let c="";l!==null&&(c=l[1]);const f=c.split(`
`);let u=0,d=0;for(let p=0;p<f.length;p++){let g=f[p];if(g=g.trim(),g!==""){d>=a.elements[u].count&&(u++,d=0);const m=sMe(a.elements[u].properties,g);dF(s,a.elements[u].name,m),d++}}const h=fF(s,a.elements);e.output[0]=h},t.requestData=(r,i)=>{t.parse(e.parseData)}}const uMe={};function LQ(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,uMe,n),ce.obj(t,e),ce.get(t,e,["url","baseURL"]),ce.setGet(t,e,["dataAccessHelper"]),ce.algo(t,e,0,1),cMe(t,e),e.compression||(e.compression=null),e.progressCallback||(e.progressCallback=null)}const fMe=ce.newInstance(LQ,"vtkPLYReader");var dMe={extend:LQ,newInstance:fMe};const{vtkErrorMacro:c8}=ce;function hMe(t){const n=t.split(" ").filter(i=>i.indexOf("=")>-1),r={};for(let i=0;i<n.length;++i){const o=n[i].split("=");o.length===2&&(r[o[0]]=o[1])}return r}function hF(t,e){for(let n=0;n<t.length;n++)e.push(t[n])}function pMe(t,e,n,r,i){const a=t[e];if(a===void 0)return-1;if(a.indexOf("endfacet")!==-1||a.indexOf("facet")===-1)return e+1;let o=0,s=2;const l=n.length/3,c=a.split(/[ \t]+/).filter(f=>f).slice(-3).map(Number);for(hF(c,i);t[e+s].indexOf("vertex")!==-1;){const u=t[e+s].split(/[ \t]+/).filter(d=>d).slice(-3).map(Number);hF(u,n),o++,s++}r.push(o);for(let f=0;f<o;f++)r.push(l+f);for(;t[e+s]&&t[e+s].indexOf("endfacet")!==-1;)s++;return e+s+2}function gMe(t,e){e.classHierarchy.push("vtkSTLReader"),e.dataAccessHelper||(e.dataAccessHelper=Uy.get("http"));function n(i){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const o=a.compression!==void 0?a.compression:e.compression,s=a.progressCallback!==void 0?a.progressCallback:e.progressCallback;return a.binary?e.dataAccessHelper.fetchBinary(i,{compression:o,progressCallback:s}):e.dataAccessHelper.fetchText(t,i,{compression:o,progressCallback:s})}function r(i){const a=e.output[0],o=a.getPoints().getData(),s=a.getPolys().getData();if(!o||!s){console.warn("No valid polydata.");return}const l=new Map,c=new Map;let f=0,u=!1;for(let g=0;g<o.length;g+=3){const m=(o[g]*10**i).toFixed(0),y=(o[g+1]*10**i).toFixed(0),v=(o[g+2]*10**i).toFixed(0),x=`${m},${y},${v}`;l.get(x)!==void 0?(c.set(g/3,l.get(x)),u=!0):(c.set(g/3,f),l.set(x,f),f++)}const d=new Float32Array(l.size*3),h=Array.from(l.keys());for(let g=0;g<h.length;g++){const m=h[g],y=l.get(m)*3,v=m.split(",").map(x=>+x*10**-i);d[y]=v[0],d[y+1]=v[1],d[y+2]=v[2]}const p=new Int32Array(s);for(let g=0;g<s.length;g+=4)p[g]=3,p[g+1]=c.get(s[g+1]),p[g+2]=c.get(s[g+2]),p[g+3]=c.get(s[g+3]);a.getPoints().setData(d),a.getPolys().setData(p),u&&t.modified()}t.setUrl=function(i){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{binary:!0};e.url=i;const o=i.split("/");return o.pop(),e.baseURL=o.join("/"),t.loadData(a)},t.loadData=function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const a=n(e.url,i);return a.then(t.parse),a},t.parse=i=>{typeof i=="string"?t.parseAsText(i):t.parseAsArrayBuffer(i)},t.parseAsArrayBuffer=i=>{if(!i)return;if(i!==e.parseData)t.modified();else return;e.parseData=i;let a=!1;if(a=84+new DataView(i,0,84).getUint32(80,!0)*50===i.byteLength,!a){t.parseAsText(J2.arrayBufferToString(i));return}const l=i.slice(0,80),c=J2.arrayBufferToString(l),f=hMe(c),u=new DataView(i,84),d=(i.byteLength-84)/50,h=new Float32Array(d*9),p=new Float32Array(d*3),g=new Uint32Array(d*4),m=new Uint16Array(d);let y=0;for(let w=0;w<d;w++){const S=w*50;p[w*3+0]=u.getFloat32(S+0,!0),p[w*3+1]=u.getFloat32(S+4,!0),p[w*3+2]=u.getFloat32(S+8,!0),h[w*9+0]=u.getFloat32(S+12,!0),h[w*9+1]=u.getFloat32(S+16,!0),h[w*9+2]=u.getFloat32(S+20,!0),h[w*9+3]=u.getFloat32(S+24,!0),h[w*9+4]=u.getFloat32(S+28,!0),h[w*9+5]=u.getFloat32(S+32,!0),h[w*9+6]=u.getFloat32(S+36,!0),h[w*9+7]=u.getFloat32(S+40,!0),h[w*9+8]=u.getFloat32(S+44,!0),g[y++]=3,g[y++]=w*3+0,g[y++]=w*3+1,g[y++]=w*3+2,m[w]=u.getUint16(S+48,!0)}const v="SPACE";if(v in f&&f[v]!=="LPS"){const w=f[v],S=new Float32Array(16);switch(S[15]=1,w[0]){case"L":S[0]=1;break;case"R":S[0]=-1;break;default:c8(`Can not convert STL file from ${w} to LPS space: permutations not supported. Use itk.js STL reader instead.`);return}switch(w[1]){case"P":S[5]=1;break;case"A":S[5]=-1;break;default:c8(`Can not convert STL file from ${w} to LPS space: permutations not supported. Use itk.js STL reader instead.`);return}switch(w[2]){case"S":S[10]=1;break;case"I":S[10]=-1;break;default:c8(`Can not convert STL file from ${w} to LPS space: permutations not supported. Use itk.js STL reader instead.`);return}$d.buildFromDegree().setMatrix(S).apply(h).apply(p)}const x=ca.newInstance();x.getPoints().setData(h,3),x.getPolys().setData(g),x.getCellData().setScalars(tn.newInstance({name:"Attribute",values:m})),x.getCellData().setNormals(tn.newInstance({name:"Normals",values:p,numberOfComponents:3})),e.output[0]=x,e.removeDuplicateVertices>=0&&r(e.removeDuplicateVertices)},t.parseAsText=i=>{if(!i)return;if(i!==e.parseData)t.modified();else return;e.parseData=i;const a=i.split(`
`);let o=1;const s=[],l=[],c=[];for(;o!==-1;)o=pMe(a,o,s,l,c);const f=ca.newInstance();f.getPoints().setData(Float32Array.from(s),3),f.getPolys().setData(Uint32Array.from(l)),f.getCellData().setNormals(tn.newInstance({name:"Normals",values:Float32Array.from(c),numberOfComponents:3})),e.output[0]=f,e.removeDuplicateVertices>=0&&r(e.removeDuplicateVertices)},t.requestData=(i,a)=>{t.parse(e.parseData)}}const mMe={removeDuplicateVertices:-1};function kQ(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,mMe,n),ce.obj(t,e),ce.get(t,e,["url","baseURL"]),ce.setGet(t,e,["dataAccessHelper","removeDuplicateVertices"]),ce.algo(t,e,0,1),gMe(t,e),e.compression||(e.compression=null),e.progressCallback||(e.progressCallback=null)}const vMe=ce.newInstance(kQ,"vtkSTLReader");var yMe={extend:kQ,newInstance:vMe},lw={exports:{}},xMe=lw.exports,pF;function bMe(){return pF||(pF=1,(function(t,e){(function(n,r){t.exports=r()})(xMe,(function(){return(function(n){var r={};function i(a){if(r[a])return r[a].exports;var o=r[a]={i:a,l:!1,exports:{}};return n[a].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=n,i.c=r,i.d=function(a,o,s){i.o(a,o)||Object.defineProperty(a,o,{enumerable:!0,get:s})},i.r=function(a){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},i.t=function(a,o){if(1&o&&(a=i(a)),8&o||4&o&&typeof a=="object"&&a&&a.__esModule)return a;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:a}),2&o&&typeof a!="string")for(var l in a)i.d(s,l,(function(c){return a[c]}).bind(null,l));return s},i.n=function(a){var o=a&&a.__esModule?function(){return a.default}:function(){return a};return i.d(o,"a",o),o},i.o=function(a,o){return Object.prototype.hasOwnProperty.call(a,o)},i.p="",i(i.s=184)})([function(n,r,i){function a(o){for(var s in o)r.hasOwnProperty(s)||(r[s]=o[s])}Object.defineProperty(r,"__esModule",{value:!0}),a(i(240)),a(i(251)),a(i(175)),a(i(107)),a(i(29)),a(i(73)),a(i(106)),a(i(30)),a(i(252)),a(i(52)),a(i(97)),a(i(253)),a(i(37)),a(i(51)),a(i(173)),a(i(176)),a(i(172)),a(i(108)),a(i(254)),a(i(255)),a(i(256)),a(i(72)),a(i(177)),a(i(105)),a(i(17)),a(i(257)),a(i(12)),a(i(174))},function(n,r,i){var a=this&&this.__values||function(x){var w=typeof Symbol=="function"&&Symbol.iterator,S=w&&x[w],T=0;if(S)return S.call(x);if(x&&typeof x.length=="number")return{next:function(){return x&&T>=x.length&&(x=void 0),{value:x&&x[T++],done:!x}}};throw new TypeError(w?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var o=i(212);r.FixedSizeSet=o.FixedSizeSet;var s=i(213);r.ObjectCache=s.ObjectCache;var l=i(214);r.CompareCache=l.CompareCache;var c=i(215);r.Lazy=c.Lazy;var f=i(216);function u(x,w,S){if(y(x))x.forEach((function(_,D){return w.call(S,D,_)}));else for(var T in x)x.hasOwnProperty(T)&&w.call(S,T,x[T])}function d(x){var w,S;if(h(x))return x;if(g(x)){var T=[];try{for(var _=a(x),D=_.next();!D.done;D=_.next()){var I=D.value;T.push(d(I))}}catch(P){w={error:P}}finally{try{D&&!D.done&&(S=_.return)&&S.call(_)}finally{if(w)throw w.error}}return T}if(p(x)){T={};for(var R in x)if(x.hasOwnProperty(R)){var O=x[R];T[R]=d(O)}return T}return x}function h(x){return!!x&&Object.prototype.toString.call(x)==="[object Function]"}function p(x){var w=typeof x;return!!x&&(w==="function"||w==="object")}function g(x){return Array.isArray(x)}function m(x){return x instanceof Set}function y(x){return x instanceof Map}function v(x){if(p(x)){var w=Object.getPrototypeOf(x),S=w.constructor;return w&&S&&typeof S=="function"&&S instanceof S&&Function.prototype.toString.call(S)===Function.prototype.toString.call(Object)}return!1}r.StringWalker=f.StringWalker,r.applyMixin=function(x,w){for(var S=[],T=2;T<arguments.length;T++)S[T-2]=arguments[T];Object.getOwnPropertyNames(w.prototype).forEach((function(_){if(_!=="constructor"){if(S.indexOf(_)!==-1){var D=Object.getOwnPropertyDescriptor(x.prototype,_);D&&Object.defineProperty(x.prototype,"_"+_,D)}var I=Object.getOwnPropertyDescriptor(w.prototype,_);I&&Object.defineProperty(x.prototype,_,I)}}))},r.applyDefaults=function x(w,S,T){T===void 0&&(T=!1);var _=d(w||{});return u(S,(function(D,I){v(I)?_[D]=x(_[D],I,T):(T||_[D]===void 0)&&(_[D]=I)})),_},r.forEachArray=function(x,w,S){x.forEach(w,S)},r.forEachObject=u,r.arrayLength=function(x){return m(x)?x.size:x.length},r.objectLength=function(x){return y(x)?x.size:Object.keys(x).length},r.getObjectValue=function(x,w){return y(x)?x.get(w):x[w]},r.removeObjectValue=function(x,w){y(x)?x.delete(w):delete x[w]},r.clone=d,r.isBoolean=function(x){return typeof x=="boolean"},r.isNumber=function(x){return typeof x=="number"},r.isString=function(x){return typeof x=="string"},r.isFunction=h,r.isObject=p,r.isArray=g,r.isSet=m,r.isMap=y,r.isEmpty=function(x){if(g(x))return!x.length;if(m(x)||y(x))return!x.size;if(p(x)){for(var w in x)if(x.hasOwnProperty(w))return!1;return!0}return!1},r.isPlainObject=v,r.isIterable=function(x){return x&&typeof x[Symbol.iterator]=="function"},r.getValue=function(x){return h(x.valueOf)?x.valueOf():x},r.utf8Encode=function(x){for(var w=new Uint8Array(4*x.length),S=0,T=0;T<x.length;T++){var _=x.charCodeAt(T);if(_<128)w[S++]=_;else{if(_<2048)w[S++]=_>>6|192;else{if(_>55295&&_<56320){if(++T>=x.length)throw new Error("Incomplete surrogate pair.");var D=x.charCodeAt(T);if(D<56320||D>57343)throw new Error("Invalid surrogate character.");_=65536+((1023&_)<<10)+(1023&D),w[S++]=_>>18|240,w[S++]=_>>12&63|128}else w[S++]=_>>12|224;w[S++]=_>>6&63|128}w[S++]=63&_|128}}return w.subarray(0,S)},r.utf8Decode=function(x){for(var w="",S=0;S<x.length;){var T=x[S++];if(T>127)if(T>191&&T<224){if(S>=x.length)throw new Error("Incomplete 2-byte sequence.");T=(31&T)<<6|63&x[S++]}else if(T>223&&T<240){if(S+1>=x.length)throw new Error("Incomplete 3-byte sequence.");T=(15&T)<<12|(63&x[S++])<<6|63&x[S++]}else{if(!(T>239&&T<248))throw new Error("Unknown multi-byte start.");if(S+2>=x.length)throw new Error("Incomplete 4-byte sequence.");T=(7&T)<<18|(63&x[S++])<<12|(63&x[S++])<<6|63&x[S++]}if(T<=65535)w+=String.fromCharCode(T);else{if(!(T<=1114111))throw new Error("Code point exceeds UTF-16 limit.");T-=65536,w+=String.fromCharCode(T>>10|55296),w+=String.fromCharCode(1023&T|56320)}}return w}},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),(function(a){a[a.Before=0]="Before",a[a.Equal=1]="Equal",a[a.After=2]="After"})(r.BoundaryPosition||(r.BoundaryPosition={})),(function(a){a[a.None=0]="None",a[a.Capturing=1]="Capturing",a[a.AtTarget=2]="AtTarget",a[a.Bubbling=3]="Bubbling"})(r.EventPhase||(r.EventPhase={})),(function(a){a[a.Element=1]="Element",a[a.Attribute=2]="Attribute",a[a.Text=3]="Text",a[a.CData=4]="CData",a[a.EntityReference=5]="EntityReference",a[a.Entity=6]="Entity",a[a.ProcessingInstruction=7]="ProcessingInstruction",a[a.Comment=8]="Comment",a[a.Document=9]="Document",a[a.DocumentType=10]="DocumentType",a[a.DocumentFragment=11]="DocumentFragment",a[a.Notation=12]="Notation"})(r.NodeType||(r.NodeType={})),(function(a){a[a.Disconnected=1]="Disconnected",a[a.Preceding=2]="Preceding",a[a.Following=4]="Following",a[a.Contains=8]="Contains",a[a.ContainedBy=16]="ContainedBy",a[a.ImplementationSpecific=32]="ImplementationSpecific"})(r.Position||(r.Position={})),(function(a){a[a.Accept=1]="Accept",a[a.Reject=2]="Reject",a[a.Skip=3]="Skip"})(r.FilterResult||(r.FilterResult={})),(function(a){a[a.All=4294967295]="All",a[a.Element=1]="Element",a[a.Attribute=2]="Attribute",a[a.Text=4]="Text",a[a.CDataSection=8]="CDataSection",a[a.EntityReference=16]="EntityReference",a[a.Entity=32]="Entity",a[a.ProcessingInstruction=64]="ProcessingInstruction",a[a.Comment=128]="Comment",a[a.Document=256]="Document",a[a.DocumentType=512]="DocumentType",a[a.DocumentFragment=1024]="DocumentFragment",a[a.Notation=2048]="Notation"})(r.WhatToShow||(r.WhatToShow={})),(function(a){a[a.StartToStart=0]="StartToStart",a[a.StartToEnd=1]="StartToEnd",a[a.EndToEnd=2]="EndToEnd",a[a.EndToStart=3]="EndToStart"})(r.HowToCompare||(r.HowToCompare={}))},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(241);r.Cast=a.Cast;var o=i(150);r.Guard=o.Guard;var s=i(242);r.EmptySet=s.EmptySet},function(n,r,i){var a=i(11),o=i(55).f,s=i(21),l=i(25),c=i(80),f=i(119),u=i(123);n.exports=function(d,h){var p,g,m,y,v,x=d.target,w=d.global,S=d.stat;if(p=w?a:S?a[x]||c(x,{}):(a[x]||{}).prototype)for(g in h){if(y=h[g],m=d.noTargetGet?(v=o(p,g))&&v.value:p[g],!u(w?g:x+(S?".":"#")+g,d.forced)&&m!==void 0){if(typeof y==typeof m)continue;f(y,m)}(d.sham||m&&m.sham)&&s(y,"sham",!0),l(p,g,y,d)}}},function(n,r,i){var a=i(11),o=i(81),s=i(14),l=i(58),c=i(86),f=i(124),u=o("wks"),d=a.Symbol,h=f?d:d&&d.withoutSetter||l;n.exports=function(p){return s(u,p)||(c&&s(d,p)?u[p]=d[p]:u[p]=h("Symbol."+p)),u[p]}},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(1),o=i(29),s=(function(){function l(){this._features={mutationObservers:!0,customElements:!0,slots:!0,steps:!0},this._window=null,this._compareCache=new a.CompareCache,this._rangeList=new a.FixedSizeSet}return l.prototype.setFeatures=function(c){if(c===void 0&&(c=!0),a.isObject(c))for(var f in c)this._features[f]=c[f]||!1;else for(var f in this._features)this._features[f]=c},Object.defineProperty(l.prototype,"features",{get:function(){return this._features},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"window",{get:function(){return this._window===null&&(this._window=o.create_window()),this._window},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"compareCache",{get:function(){return this._compareCache},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"rangeList",{get:function(){return this._rangeList},enumerable:!0,configurable:!0}),Object.defineProperty(l,"instance",{get:function(){return l._instance||(l._instance=new l),l._instance},enumerable:!0,configurable:!0}),l})();r.dom=s.instance},function(n,r,i){var a=this&&this.__importStar||function(v){if(v&&v.__esModule)return v;var x={};if(v!=null)for(var w in v)Object.hasOwnProperty.call(v,w)&&(x[w]=v[w]);return x.default=v,x};Object.defineProperty(r,"__esModule",{value:!0});var o=a(i(228));r.base64=o;var s=a(i(146));r.byte=s;var l=a(i(147));r.byteSequence=l;var c=a(i(96));r.codePoint=c;var f=a(i(232));r.json=f;var u=a(i(233));r.list=u;var d=a(i(234));r.map=d;var h=a(i(235));r.namespace=h;var p=a(i(236));r.queue=p;var g=a(i(237));r.set=g;var m=a(i(238));r.stack=m;var y=a(i(239));r.string=y},function(n,r){n.exports=function(i){try{return!!i()}catch{return!0}}},function(n,r,i){var a,o=this&&this.__extends||(a=function(U,G){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(F,J){F.__proto__=J}||function(F,J){for(var Q in J)J.hasOwnProperty(Q)&&(F[Q]=J[Q])})(U,G)},function(U,G){function F(){this.constructor=U}a(U,G),U.prototype=G===null?Object.create(G):(F.prototype=G.prototype,new F)});Object.defineProperty(r,"__esModule",{value:!0});var s=(function(U){function G(F,J){J===void 0&&(J="");var Q=U.call(this,J)||this;return Q.name=F,Q}return o(G,U),G})(Error);r.DOMException=s;var l=(function(U){function G(F){return F===void 0&&(F=""),U.call(this,"DOMStringSizeError",F)||this}return o(G,U),G})(s);r.DOMStringSizeError=l;var c=(function(U){function G(F){return F===void 0&&(F=""),U.call(this,"WrongDocumentError","The object is in the wrong document. "+F)||this}return o(G,U),G})(s);r.WrongDocumentError=c;var f=(function(U){function G(F){return F===void 0&&(F=""),U.call(this,"NoDataAllowedError",F)||this}return o(G,U),G})(s);r.NoDataAllowedError=f;var u=(function(U){function G(F){return F===void 0&&(F=""),U.call(this,"NoModificationAllowedError","The object can not be modified. "+F)||this}return o(G,U),G})(s);r.NoModificationAllowedError=u;var d=(function(U){function G(F){return F===void 0&&(F=""),U.call(this,"NotSupportedError","The operation is not supported. "+F)||this}return o(G,U),G})(s);r.NotSupportedError=d;var h=(function(U){function G(F){return F===void 0&&(F=""),U.call(this,"InUseAttributeError",F)||this}return o(G,U),G})(s);r.InUseAttributeError=h;var p=(function(U){function G(F){return F===void 0&&(F=""),U.call(this,"InvalidStateError","The object is in an invalid state. "+F)||this}return o(G,U),G})(s);r.InvalidStateError=p;var g=(function(U){function G(F){return F===void 0&&(F=""),U.call(this,"InvalidModificationError","The object can not be modified in this way. "+F)||this}return o(G,U),G})(s);r.InvalidModificationError=g;var m=(function(U){function G(F){return F===void 0&&(F=""),U.call(this,"NamespaceError","The operation is not allowed by Namespaces in XML. [XMLNS] "+F)||this}return o(G,U),G})(s);r.NamespaceError=m;var y=(function(U){function G(F){return F===void 0&&(F=""),U.call(this,"InvalidAccessError","The object does not support the operation or argument. "+F)||this}return o(G,U),G})(s);r.InvalidAccessError=y;var v=(function(U){function G(F){return F===void 0&&(F=""),U.call(this,"ValidationError",F)||this}return o(G,U),G})(s);r.ValidationError=v;var x=(function(U){function G(F){return F===void 0&&(F=""),U.call(this,"TypeMismatchError",F)||this}return o(G,U),G})(s);r.TypeMismatchError=x;var w=(function(U){function G(F){return F===void 0&&(F=""),U.call(this,"SecurityError","The operation is insecure. "+F)||this}return o(G,U),G})(s);r.SecurityError=w;var S=(function(U){function G(F){return F===void 0&&(F=""),U.call(this,"NetworkError","A network error occurred. "+F)||this}return o(G,U),G})(s);r.NetworkError=S;var T=(function(U){function G(F){return F===void 0&&(F=""),U.call(this,"AbortError","The operation was aborted. "+F)||this}return o(G,U),G})(s);r.AbortError=T;var _=(function(U){function G(F){return F===void 0&&(F=""),U.call(this,"URLMismatchError","The given URL does not match another URL. "+F)||this}return o(G,U),G})(s);r.URLMismatchError=_;var D=(function(U){function G(F){return F===void 0&&(F=""),U.call(this,"QuotaExceededError","The quota has been exceeded. "+F)||this}return o(G,U),G})(s);r.QuotaExceededError=D;var I=(function(U){function G(F){return F===void 0&&(F=""),U.call(this,"TimeoutError","The operation timed out. "+F)||this}return o(G,U),G})(s);r.TimeoutError=I;var R=(function(U){function G(F){return F===void 0&&(F=""),U.call(this,"InvalidNodeTypeError","The supplied node is incorrect or has an incorrect ancestor for this operation. "+F)||this}return o(G,U),G})(s);r.InvalidNodeTypeError=R;var O=(function(U){function G(F){return F===void 0&&(F=""),U.call(this,"DataCloneError","The object can not be cloned. "+F)||this}return o(G,U),G})(s);r.DataCloneError=O;var P=(function(U){function G(F){return F===void 0&&(F=""),U.call(this,"NotImplementedError","The DOM method is not implemented by this module. "+F)||this}return o(G,U),G})(s);r.NotImplementedError=P;var N=(function(U){function G(F){return F===void 0&&(F=""),U.call(this,"HierarchyRequestError","The operation would yield an incorrect node tree. "+F)||this}return o(G,U),G})(s);r.HierarchyRequestError=N;var A=(function(U){function G(F){return F===void 0&&(F=""),U.call(this,"NotFoundError","The object can not be found here. "+F)||this}return o(G,U),G})(s);r.NotFoundError=A;var B=(function(U){function G(F){return F===void 0&&(F=""),U.call(this,"IndexSizeError","The index is not in the allowed range. "+F)||this}return o(G,U),G})(s);r.IndexSizeError=B;var V=(function(U){function G(F){return F===void 0&&(F=""),U.call(this,"SyntaxError","The string did not match the expected pattern. "+F)||this}return o(G,U),G})(s);r.SyntaxError=V;var $=(function(U){function G(F){return F===void 0&&(F=""),U.call(this,"InvalidCharacterError","The string contains invalid characters. "+F)||this}return o(G,U),G})(s);r.InvalidCharacterError=$},function(n,r,i){var a=i(53),o=["kind","resolve","construct","instanceOf","predicate","represent","defaultStyle","styleAliases"],s=["scalar","sequence","mapping"];n.exports=function(l,c){var f,u;if(c=c||{},Object.keys(c).forEach((function(d){if(o.indexOf(d)===-1)throw new a('Unknown option "'+d+'" is met in definition of "'+l+'" YAML type.')})),this.tag=l,this.kind=c.kind||null,this.resolve=c.resolve||function(){return!0},this.construct=c.construct||function(d){return d},this.instanceOf=c.instanceOf||null,this.predicate=c.predicate||null,this.represent=c.represent||null,this.defaultStyle=c.defaultStyle||null,this.styleAliases=(f=c.styleAliases||null,u={},f!==null&&Object.keys(f).forEach((function(d){f[d].forEach((function(h){u[String(h)]=d}))})),u),s.indexOf(this.kind)===-1)throw new a('Unknown kind "'+this.kind+'" is specified for "'+l+'" YAML type.')}},function(n,r,i){(function(a){var o=function(s){return s&&s.Math==Math&&s};n.exports=o(typeof globalThis=="object"&&globalThis)||o(typeof window=="object"&&window)||o(typeof self=="object"&&self)||o(typeof a=="object"&&a)||Function("return this")()}).call(this,i(78))},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.idl_defineConst=function(a,o,s){Object.defineProperty(a,o,{writable:!1,enumerable:!0,configurable:!1,value:s})}},function(n,r){n.exports=function(i){return typeof i=="object"?i!==null:typeof i=="function"}},function(n,r){var i={}.hasOwnProperty;n.exports=function(a,o){return i.call(a,o)}},function(n,r,i){var a=i(16),o=i(115),s=i(18),l=i(56),c=Object.defineProperty;r.f=a?c:function(f,u,d){if(s(f),u=l(u,!0),s(d),o)try{return c(f,u,d)}catch{}if("get"in d||"set"in d)throw TypeError("Accessors not supported");return"value"in d&&(f[u]=d.value),f}},function(n,r,i){var a=i(8);n.exports=!a((function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}))},function(n,r,i){var a=this&&this.__values||function(x){var w=typeof Symbol=="function"&&Symbol.iterator,S=w&&x[w],T=0;if(S)return S.call(x);if(x&&typeof x.length=="number")return{next:function(){return x&&T>=x.length&&(x=void 0),{value:x&&x[T++],done:!x}}};throw new TypeError(w?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var o=i(3),s=i(2);function l(x,w,S){if(S===void 0&&(S=!1),S&&o.Guard.isElementNode(w)&&o.Guard.isShadowRoot(w.shadowRoot)&&w.shadowRoot._firstChild)return w.shadowRoot._firstChild;if(w._firstChild)return w._firstChild;if(w===x)return null;if(w._nextSibling)return w._nextSibling;for(var T=w._parent;T&&T!==x;){if(T._nextSibling)return T._nextSibling;T=T._parent}return null}function c(){var x;return(x={})[Symbol.iterator]=function(){return{next:function(){return{done:!0,value:null}}}},x}function f(x,w,S,T){w===void 0&&(w=!1),S===void 0&&(S=!1);for(var _=w?x:l(x,x,S);_&&T&&!T(_);)_=l(x,_,S);return _}function u(x,w,S,T,_){T===void 0&&(T=!1);for(var D=l(x,w,T);D&&_&&!_(D);)D=l(x,D,T);return D}function d(x,w,S,T){var _;return w===void 0&&(w=!1),S===void 0&&(S=!1),w||x._children.size!==0?((_={})[Symbol.iterator]=function(){var D=w?x:l(x,x,S);return{next:function(){for(;D&&T&&!T(D);)D=l(x,D,S);if(D===null)return{done:!0,value:null};var I={done:!1,value:D};return D=l(x,D,S),I}}},_):c()}function h(x,w,S){w===void 0&&(w=!1);for(var T=w?x:x._parent;T&&S&&!S(T);)T=T._parent;return T}function p(x,w,S,T){for(var _=w._parent;_&&T&&!T(_);)_=_._parent;return _}function g(x){return o.Guard.isDocumentTypeNode(x)?0:o.Guard.isCharacterDataNode(x)?x._data.length:x._children.size}function m(x,w){if(w===void 0&&(w=!1),w){var S=m(x,!1);return o.Guard.isShadowRoot(S)?m(S._host,!0):S}return x._parent?m(x._parent):x}function y(x,w,S,T){S===void 0&&(S=!1),T===void 0&&(T=!1);for(var _=S?x:T&&o.Guard.isShadowRoot(x)?x._host:x._parent;_!==null;){if(_===w)return!0;_=T&&o.Guard.isShadowRoot(_)?_._host:_._parent}return!1}function v(x){for(var w=m(x),S=0,T=f(w);T!==null;){if(S++,T===x)return S;T=u(w,T)}return-1}r.tree_getFirstDescendantNode=f,r.tree_getNextDescendantNode=u,r.tree_getDescendantNodes=d,r.tree_getDescendantElements=function(x,w,S,T){var _;return w===void 0&&(w=!1),S===void 0&&(S=!1),w||x._children.size!==0?((_={})[Symbol.iterator]=function(){var D=d(x,w,S,(function(R){return o.Guard.isElementNode(R)}))[Symbol.iterator](),I=D.next().value;return{next:function(){for(;I&&T&&!T(I);)I=D.next().value;if(I===null)return{done:!0,value:null};var R={done:!1,value:I};return I=D.next().value,R}}},_):c()},r.tree_getSiblingNodes=function(x,w,S){var T;return w===void 0&&(w=!1),x._parent&&x._parent._children.size!==0?((T={})[Symbol.iterator]=function(){var _=x._parent?x._parent._firstChild:null;return{next:function(){for(;_&&(S&&!S(_)||!w&&_===x);)_=_._nextSibling;if(_===null)return{done:!0,value:null};var D={done:!1,value:_};return _=_._nextSibling,D}}},T):c()},r.tree_getFirstAncestorNode=h,r.tree_getNextAncestorNode=p,r.tree_getAncestorNodes=function(x,w,S){var T;return w===void 0&&(w=!1),w||x._parent?((T={})[Symbol.iterator]=function(){var _=h(x,w,S);return{next:function(){if(_===null)return{done:!0,value:null};var D={done:!1,value:_};return _=p(0,_,w,S),D}}},T):c()},r.tree_getCommonAncestor=function(x,w){if(x===w)return x._parent;for(var S=[],T=[],_=h(x,!0);_!==null;)S.push(_),_=p(0,_);for(var D=h(w,!0);D!==null;)T.push(D),D=p(0,D);for(var I=S.length,R=T.length,O=null,P=Math.min(I,R);P>0;P--){var N=S[--I];if(N!==T[--R])break;O=N}return O},r.tree_getFollowingNode=function(x,w){if(w._firstChild)return w._firstChild;if(w._nextSibling)return w._nextSibling;for(;;){var S=w._parent;if(S===null||S===x)return null;if(S._nextSibling)return S._nextSibling;w=S}},r.tree_getPrecedingNode=function(x,w){return w===x?null:w._previousSibling?(w=w._previousSibling)._lastChild?w._lastChild:w:w._parent},r.tree_isConstrained=function x(w){var S,T,_,D,I,R;switch(w._nodeType){case s.NodeType.Document:var O=!1,P=!1;try{for(var N=a(w._children),A=N.next();!A.done;A=N.next())switch(A.value._nodeType){case s.NodeType.ProcessingInstruction:case s.NodeType.Comment:break;case s.NodeType.DocumentType:if(O||P)return!1;O=!0;break;case s.NodeType.Element:if(P)return!1;P=!0;break;default:return!1}}catch(G){S={error:G}}finally{try{A&&!A.done&&(T=N.return)&&T.call(N)}finally{if(S)throw S.error}}break;case s.NodeType.DocumentFragment:case s.NodeType.Element:try{for(var B=a(w._children),V=B.next();!V.done;V=B.next())switch(V.value._nodeType){case s.NodeType.Element:case s.NodeType.Text:case s.NodeType.ProcessingInstruction:case s.NodeType.CData:case s.NodeType.Comment:break;default:return!1}}catch(G){_={error:G}}finally{try{V&&!V.done&&(D=B.return)&&D.call(B)}finally{if(_)throw _.error}}break;case s.NodeType.DocumentType:case s.NodeType.Text:case s.NodeType.ProcessingInstruction:case s.NodeType.CData:case s.NodeType.Comment:return!w.hasChildNodes()}try{for(var $=a(w._children),U=$.next();!U.done;U=$.next())if(!x(U.value))return!1}catch(G){I={error:G}}finally{try{U&&!U.done&&(R=$.return)&&R.call($)}finally{if(I)throw I.error}}return!0},r.tree_nodeLength=g,r.tree_isEmpty=function(x){return g(x)===0},r.tree_rootNode=m,r.tree_isDescendantOf=function(x,w,S,T){S===void 0&&(S=!1),T===void 0&&(T=!1);for(var _=f(x,S,T);_!==null;){if(_===w)return!0;_=u(x,_,S,T)}return!1},r.tree_isAncestorOf=y,r.tree_isHostIncludingAncestorOf=function x(w,S,T){if(T===void 0&&(T=!1),y(w,S,T))return!0;var _=m(w);return!(!o.Guard.isDocumentFragmentNode(_)||_._host===null||!x(_._host,S,T))},r.tree_isSiblingOf=function(x,w,S){return S===void 0&&(S=!1),x!==w?x._parent!==null&&x._parent===w._parent:!!S},r.tree_isPreceding=function(x,w){var S=v(x),T=v(w);return S!==-1&&T!==-1&&m(x)===m(w)&&T<S},r.tree_isFollowing=function(x,w){var S=v(x),T=v(w);return S!==-1&&T!==-1&&m(x)===m(w)&&T>S},r.tree_isParentOf=function(x,w){return x._parent===w},r.tree_isChildOf=function(x,w){return w._parent===x},r.tree_previousSibling=function(x){return x._previousSibling},r.tree_nextSibling=function(x){return x._nextSibling},r.tree_firstChild=function(x){return x._firstChild},r.tree_lastChild=function(x){return x._lastChild},r.tree_treePosition=v,r.tree_index=function(x){for(var w=0;x._previousSibling!==null;)w++,x=x._previousSibling;return w},r.tree_retarget=function(x,w){for(;;){if(!x||!o.Guard.isNode(x))return x;var S=m(x);if(!o.Guard.isShadowRoot(S)||w&&o.Guard.isNode(w)&&y(S,w,!0,!0))return x;x=S.host}}},function(n,r,i){var a=i(13);n.exports=function(o){if(!a(o))throw TypeError(String(o)+" is not an object");return o}},function(n,r,i){var a=i(24),o=i(130),s=i(49),l=i(43),c=i(88),f=l.set,u=l.getterFor("Array Iterator");n.exports=c(Array,"Array",(function(d,h){f(this,{type:"Array Iterator",target:a(d),index:0,kind:h})}),(function(){var d=u(this),h=d.target,p=d.kind,g=d.index++;return!h||g>=h.length?(d.target=void 0,{value:void 0,done:!0}):p=="keys"?{value:g,done:!1}:p=="values"?{value:h[g],done:!1}:{value:[g,h[g]],done:!1}}),"values"),s.Arguments=s.Array,o("keys"),o("values"),o("entries")},function(n,r,i){var a=i(90),o=i(25),s=i(202);a||o(Object.prototype,"toString",s,{unsafe:!0})},function(n,r,i){var a=i(16),o=i(15),s=i(40);n.exports=a?function(l,c,f){return o.f(l,c,s(1,f))}:function(l,c,f){return l[c]=f,l}},function(n,r,i){var a=i(137).charAt,o=i(43),s=i(88),l=o.set,c=o.getterFor("String Iterator");s(String,"String",(function(f){l(this,{type:"String Iterator",string:String(f),index:0})}),(function(){var f,u=c(this),d=u.string,h=u.index;return h>=d.length?{value:void 0,done:!0}:(f=a(d,h),u.index+=f.length,{value:f,done:!1})}))},function(n,r,i){var a=i(11),o=i(203),s=i(19),l=i(21),c=i(5),f=c("iterator"),u=c("toStringTag"),d=s.values;for(var h in o){var p=a[h],g=p&&p.prototype;if(g){if(g[f]!==d)try{l(g,f,d)}catch{g[f]=d}if(g[u]||l(g,u,h),o[h]){for(var m in s)if(g[m]!==s[m])try{l(g,m,s[m])}catch{g[m]=s[m]}}}}},function(n,r,i){var a=i(41),o=i(35);n.exports=function(s){return a(o(s))}},function(n,r,i){var a=i(11),o=i(21),s=i(14),l=i(80),c=i(117),f=i(43),u=f.get,d=f.enforce,h=String(String).split("String");(n.exports=function(p,g,m,y){var v=!!y&&!!y.unsafe,x=!!y&&!!y.enumerable,w=!!y&&!!y.noTargetGet;typeof m=="function"&&(typeof g!="string"||s(m,"name")||o(m,"name",g),d(m).source=h.join(typeof g=="string"?g:"")),p!==a?(v?!w&&p[g]&&(x=!0):delete p[g],x?p[g]=m:o(p,g,m)):x?p[g]=m:l(g,m)})(Function.prototype,"toString",(function(){return typeof this=="function"&&u(this).source||c(this)}))},function(n,r,i){var a=i(47),o=Math.min;n.exports=function(s){return s>0?o(a(s),9007199254740991):0}},function(n,r,i){var a=i(35);n.exports=function(o){return Object(a(o))}},function(n,r,i){var a=i(16),o=i(8),s=i(14),l=Object.defineProperty,c={},f=function(u){throw u};n.exports=function(u,d){if(s(c,u))return c[u];d||(d={});var h=[][u],p=!!s(d,"ACCESSORS")&&d.ACCESSORS,g=s(d,0)?d[0]:f,m=s(d,1)?d[1]:void 0;return c[u]=!!h&&!o((function(){if(p&&!a)return!0;var y={length:-1};p?l(y,1,{enumerable:!0,get:f}):y[1]=1,h.call(y,g,m)}))}},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(148),o=i(149),s=i(151),l=i(98),c=i(153),f=i(154),u=i(155),d=i(99),h=i(100),p=i(156),g=i(157),m=i(101),y=i(158),v=i(159),x=i(160),w=i(161),S=i(162),T=i(163),_=i(164),D=i(165),I=i(166),R=i(167),O=i(168),P=i(169),N=i(170);r.create_domImplementation=function(A){return a.DOMImplementationImpl._create(A)},r.create_window=function(){return o.WindowImpl._create()},r.create_xmlDocument=function(){return new s.XMLDocumentImpl},r.create_document=function(){return new l.DocumentImpl},r.create_abortController=function(){return new c.AbortControllerImpl},r.create_abortSignal=function(){return f.AbortSignalImpl._create()},r.create_documentType=function(A,B,V,$){return u.DocumentTypeImpl._create(A,B,V,$)},r.create_element=function(A,B,V,$){return d.ElementImpl._create(A,B,V,$)},r.create_htmlElement=function(A,B,V,$){return d.ElementImpl._create(A,B,V,$)},r.create_htmlUnknownElement=function(A,B,V,$){return d.ElementImpl._create(A,B,V,$)},r.create_documentFragment=function(A){return h.DocumentFragmentImpl._create(A)},r.create_shadowRoot=function(A,B){return p.ShadowRootImpl._create(A,B)},r.create_attr=function(A,B){return g.AttrImpl._create(A,B)},r.create_text=function(A,B){return m.TextImpl._create(A,B)},r.create_cdataSection=function(A,B){return y.CDATASectionImpl._create(A,B)},r.create_comment=function(A,B){return v.CommentImpl._create(A,B)},r.create_processingInstruction=function(A,B,V){return x.ProcessingInstructionImpl._create(A,B,V)},r.create_htmlCollection=function(A,B){return B===void 0&&(B=function(){return!0}),w.HTMLCollectionImpl._create(A,B)},r.create_nodeList=function(A){return S.NodeListImpl._create(A)},r.create_nodeListStatic=function(A,B){return T.NodeListStaticImpl._create(A,B)},r.create_namedNodeMap=function(A){return _.NamedNodeMapImpl._create(A)},r.create_range=function(A,B){return D.RangeImpl._create(A,B)},r.create_nodeIterator=function(A,B,V){return I.NodeIteratorImpl._create(A,B,V)},r.create_treeWalker=function(A,B){return R.TreeWalkerImpl._create(A,B)},r.create_nodeFilter=function(){return O.NodeFilterImpl._create()},r.create_mutationRecord=function(A,B,V,$,U,G,F,J,Q){return P.MutationRecordImpl._create(A,B,V,$,U,G,F,J,Q)},r.create_domTokenList=function(A,B){return N.DOMTokenListImpl._create(A,B)}},function(n,r,i){var a=this&&this.__values||function(g){var m=typeof Symbol=="function"&&Symbol.iterator,y=m&&g[m],v=0;if(y)return y.call(g);if(g&&typeof g.length=="number")return{next:function(){return g&&v>=g.length&&(g=void 0),{value:g&&g[v++],done:!g}}};throw new TypeError(m?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var o=i(6),s=i(17),l=i(3),c=i(72),f=new Map;function u(g,m){if(m!==g._root&&s.tree_isAncestorOf(g._reference,m,!0)){if(g._pointerBeforeReference)for(;;){var y=s.tree_getFollowingNode(g._root,m);if(y!==null&&s.tree_isDescendantOf(g._root,y,!0)&&!s.tree_isDescendantOf(m,y,!0))return void(g._reference=y);if(y===null)return void(g._pointerBeforeReference=!1)}if(m._previousSibling===null)m._parent!==null&&(g._reference=m._parent);else{for(var v=m._previousSibling,x=s.tree_getFirstDescendantNode(m._previousSibling,!0,!1);x!==null;)x!==null&&(v=x),x=s.tree_getNextDescendantNode(m._previousSibling,x,!0,!1);g._reference=v}}}function d(g,m,y,v,x){if(l.Guard.isSlot(g)&&m==="name"&&x===null){if(v===y||v===null&&y===""||v===""&&y===null)return;g._name=v===null||v===""?"":v,c.shadowTree_assignSlotablesForATree(s.tree_rootNode(g))}}function h(g,m,y,v,x){if(l.Guard.isSlotable(g)&&m==="slot"&&x===null){if(v===y||v===null&&y===""||v===""&&y===null)return;g._name=v===null||v===""?"":v,c.shadowTree_isAssigned(g)&&c.shadowTree_assignSlotables(g._assignedSlot),c.shadowTree_assignASlot(g)}}function p(g,m,y,v){m==="id"&&v===null&&(g._uniqueIdentifier=y||void 0)}r.dom_runRemovingSteps=function(g,m){},r.dom_runCloningSteps=function(g,m,y,v){},r.dom_runAdoptingSteps=function(g,m){},r.dom_runAttributeChangeSteps=function(g,m,y,v,x){var w,S;o.dom.features.slots&&(h.call(g,g,m,y,v,x),d.call(g,g,m,y,v,x)),p.call(g,g,m,v,x);try{for(var T=a(g._attributeChangeSteps),_=T.next();!_.done;_=T.next())_.value.call(g,g,m,y,v,x)}catch(D){w={error:D}}finally{try{_&&!_.done&&(S=T.return)&&S.call(T)}finally{if(w)throw w.error}}},r.dom_runInsertionSteps=function(g){},r.dom_runNodeIteratorPreRemovingSteps=function(g,m){u.call(g,g,m)},r.dom_hasSupportedTokens=function(g){return f.has(g)},r.dom_getSupportedTokens=function(g){return f.get(g)||new Set},r.dom_runEventConstructingSteps=function(g){},r.dom_runChildTextContentChangeSteps=function(g){}},function(n,r,i){var a=i(4),o=i(11),s=i(46),l=i(44),c=i(16),f=i(86),u=i(124),d=i(8),h=i(14),p=i(59),g=i(13),m=i(18),y=i(27),v=i(24),x=i(56),w=i(40),S=i(60),T=i(61),_=i(82),D=i(190),I=i(85),R=i(55),O=i(15),P=i(79),N=i(21),A=i(25),B=i(81),V=i(57),$=i(45),U=i(58),G=i(5),F=i(125),J=i(126),Q=i(62),ne=i(43),ye=i(36).forEach,ve=V("hidden"),Ce=G("toPrimitive"),we=ne.set,Ae=ne.getterFor("Symbol"),Me=Object.prototype,q=o.Symbol,k=s("JSON","stringify"),Y=R.f,X=O.f,re=D.f,de=P.f,he=B("symbols"),Ee=B("op-symbols"),Oe=B("string-to-symbol-registry"),Pe=B("symbol-to-string-registry"),Ne=B("wks"),ie=o.QObject,ae=!ie||!ie.prototype||!ie.prototype.findChild,Te=c&&d((function(){return S(X({},"a",{get:function(){return X(this,"a",{value:7}).a}})).a!=7}))?function(Qe,st,ot){var Mt=Y(Me,st);Mt&&delete Me[st],X(Qe,st,ot),Mt&&Qe!==Me&&X(Me,st,Mt)}:X,me=function(Qe,st){var ot=he[Qe]=S(q.prototype);return we(ot,{type:"Symbol",tag:Qe,description:st}),c||(ot.description=st),ot},Se=u?function(Qe){return typeof Qe=="symbol"}:function(Qe){return Object(Qe)instanceof q},Ve=function(Qe,st,ot){Qe===Me&&Ve(Ee,st,ot),m(Qe);var Mt=x(st,!0);return m(ot),h(he,Mt)?(ot.enumerable?(h(Qe,ve)&&Qe[ve][Mt]&&(Qe[ve][Mt]=!1),ot=S(ot,{enumerable:w(0,!1)})):(h(Qe,ve)||X(Qe,ve,w(1,{})),Qe[ve][Mt]=!0),Te(Qe,Mt,ot)):X(Qe,Mt,ot)},ue=function(Qe,st){m(Qe);var ot=v(st),Mt=T(ot).concat(Fe(ot));return ye(Mt,(function(Ue){c&&!ut.call(ot,Ue)||Ve(Qe,Ue,ot[Ue])})),Qe},ut=function(Qe){var st=x(Qe,!0),ot=de.call(this,st);return!(this===Me&&h(he,st)&&!h(Ee,st))&&(!(ot||!h(this,st)||!h(he,st)||h(this,ve)&&this[ve][st])||ot)},ht=function(Qe,st){var ot=v(Qe),Mt=x(st,!0);if(ot!==Me||!h(he,Mt)||h(Ee,Mt)){var Ue=Y(ot,Mt);return!Ue||!h(he,Mt)||h(ot,ve)&&ot[ve][Mt]||(Ue.enumerable=!0),Ue}},Ot=function(Qe){var st=re(v(Qe)),ot=[];return ye(st,(function(Mt){h(he,Mt)||h($,Mt)||ot.push(Mt)})),ot},Fe=function(Qe){var st=Qe===Me,ot=re(st?Ee:v(Qe)),Mt=[];return ye(ot,(function(Ue){!h(he,Ue)||st&&!h(Me,Ue)||Mt.push(he[Ue])})),Mt};f||(A((q=function(){if(this instanceof q)throw TypeError("Symbol is not a constructor");var Qe=arguments.length&&arguments[0]!==void 0?String(arguments[0]):void 0,st=U(Qe),ot=function(Mt){this===Me&&ot.call(Ee,Mt),h(this,ve)&&h(this[ve],st)&&(this[ve][st]=!1),Te(this,st,w(1,Mt))};return c&&ae&&Te(Me,st,{configurable:!0,set:ot}),me(st,Qe)}).prototype,"toString",(function(){return Ae(this).tag})),A(q,"withoutSetter",(function(Qe){return me(U(Qe),Qe)})),P.f=ut,O.f=Ve,R.f=ht,_.f=D.f=Ot,I.f=Fe,F.f=function(Qe){return me(G(Qe),Qe)},c&&(X(q.prototype,"description",{configurable:!0,get:function(){return Ae(this).description}}),l||A(Me,"propertyIsEnumerable",ut,{unsafe:!0}))),a({global:!0,wrap:!0,forced:!f,sham:!f},{Symbol:q}),ye(T(Ne),(function(Qe){J(Qe)})),a({target:"Symbol",stat:!0,forced:!f},{for:function(Qe){var st=String(Qe);if(h(Oe,st))return Oe[st];var ot=q(st);return Oe[st]=ot,Pe[ot]=st,ot},keyFor:function(Qe){if(!Se(Qe))throw TypeError(Qe+" is not a symbol");if(h(Pe,Qe))return Pe[Qe]},useSetter:function(){ae=!0},useSimple:function(){ae=!1}}),a({target:"Object",stat:!0,forced:!f,sham:!c},{create:function(Qe,st){return st===void 0?S(Qe):ue(S(Qe),st)},defineProperty:Ve,defineProperties:ue,getOwnPropertyDescriptor:ht}),a({target:"Object",stat:!0,forced:!f},{getOwnPropertyNames:Ot,getOwnPropertySymbols:Fe}),a({target:"Object",stat:!0,forced:d((function(){I.f(1)}))},{getOwnPropertySymbols:function(Qe){return I.f(y(Qe))}}),k&&a({target:"JSON",stat:!0,forced:!f||d((function(){var Qe=q();return k([Qe])!="[null]"||k({a:Qe})!="{}"||k(Object(Qe))!="{}"}))},{stringify:function(Qe,st,ot){for(var Mt,Ue=[Qe],He=1;arguments.length>He;)Ue.push(arguments[He++]);if(Mt=st,(g(st)||Qe!==void 0)&&!Se(Qe))return p(st)||(st=function(Ct,$t){if(typeof Mt=="function"&&($t=Mt.call(this,Ct,$t)),!Se($t))return $t}),Ue[1]=st,k.apply(null,Ue)}}),q.prototype[Ce]||N(q.prototype,Ce,q.prototype.valueOf),Q(q,"Symbol"),$[ve]=!0},function(n,r,i){var a=i(4),o=i(16),s=i(11),l=i(14),c=i(13),f=i(15).f,u=i(119),d=s.Symbol;if(o&&typeof d=="function"&&(!("description"in d.prototype)||d().description!==void 0)){var h={},p=function(){var x=arguments.length<1||arguments[0]===void 0?void 0:String(arguments[0]),w=this instanceof p?new d(x):x===void 0?d():d(x);return x===""&&(h[w]=!0),w};u(p,d);var g=p.prototype=d.prototype;g.constructor=p;var m=g.toString,y=String(d("test"))=="Symbol(test)",v=/^Symbol\((.*)\)[^)]+$/;f(g,"description",{configurable:!0,get:function(){var x=c(this)?this.valueOf():this,w=m.call(x);if(l(h,x))return"";var S=y?w.slice(7,-1):w.replace(v,"$1");return S===""?void 0:S}}),a({global:!0,forced:!0},{Symbol:p})}},function(n,r,i){i(126)("iterator")},function(n,r,i){var a,o=this&&this.__extends||(a=function(y,v){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,w){x.__proto__=w}||function(x,w){for(var S in w)w.hasOwnProperty(S)&&(x[S]=w[S])})(y,v)},function(y,v){function x(){this.constructor=y}a(y,v),y.prototype=v===null?Object.create(v):(x.prototype=v.prototype,new x)}),s=this&&this.__values||function(y){var v=typeof Symbol=="function"&&Symbol.iterator,x=v&&y[v],w=0;if(x)return x.call(y);if(y&&typeof y.length=="number")return{next:function(){return y&&w>=y.length&&(y=void 0),{value:y&&y[w++],done:!y}}};throw new TypeError(v?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var l=i(6),c=i(2),f=i(70),u=i(3),d=i(9),h=i(0),p=i(152),g=i(12),m=(function(y){function v(){var x=y.call(this)||this;return x._parent=null,x._firstChild=null,x._lastChild=null,x._previousSibling=null,x._nextSibling=null,x}return o(v,y),Object.defineProperty(v.prototype,"_childNodes",{get:function(){return this.__childNodes||(this.__childNodes=h.create_nodeList(this))},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"_nodeDocument",{get:function(){return this._nodeDocumentOverride||l.dom.window._associatedDocument},set:function(x){this._nodeDocumentOverride=x},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"_registeredObserverList",{get:function(){return this.__registeredObserverList||(this.__registeredObserverList=[])},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"nodeType",{get:function(){return this._nodeType},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"nodeName",{get:function(){return u.Guard.isElementNode(this)?this._htmlUppercasedQualifiedName:u.Guard.isAttrNode(this)?this._qualifiedName:u.Guard.isExclusiveTextNode(this)?"#text":u.Guard.isCDATASectionNode(this)?"#cdata-section":u.Guard.isProcessingInstructionNode(this)?this._target:u.Guard.isCommentNode(this)?"#comment":u.Guard.isDocumentNode(this)?"#document":u.Guard.isDocumentTypeNode(this)?this._name:u.Guard.isDocumentFragmentNode(this)?"#document-fragment":""},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"baseURI",{get:function(){return p.urlSerializer(this._nodeDocument._URL)},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"isConnected",{get:function(){return u.Guard.isElementNode(this)&&h.shadowTree_isConnected(this)},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"ownerDocument",{get:function(){return this._nodeType===c.NodeType.Document?null:this._nodeDocument},enumerable:!0,configurable:!0}),v.prototype.getRootNode=function(x){return h.tree_rootNode(this,!!x&&x.composed)},Object.defineProperty(v.prototype,"parentNode",{get:function(){return this._nodeType===c.NodeType.Attribute?null:this._parent},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"parentElement",{get:function(){return this._parent&&u.Guard.isElementNode(this._parent)?this._parent:null},enumerable:!0,configurable:!0}),v.prototype.hasChildNodes=function(){return this._firstChild!==null},Object.defineProperty(v.prototype,"childNodes",{get:function(){return this._childNodes},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"firstChild",{get:function(){return this._firstChild},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"lastChild",{get:function(){return this._lastChild},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"previousSibling",{get:function(){return this._previousSibling},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"nextSibling",{get:function(){return this._nextSibling},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"nodeValue",{get:function(){return u.Guard.isAttrNode(this)?this._value:u.Guard.isCharacterDataNode(this)?this._data:null},set:function(x){x===null&&(x=""),u.Guard.isAttrNode(this)?h.attr_setAnExistingAttributeValue(this,x):u.Guard.isCharacterDataNode(this)&&h.characterData_replaceData(this,0,this._data.length,x)},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"textContent",{get:function(){return u.Guard.isDocumentFragmentNode(this)||u.Guard.isElementNode(this)?h.text_descendantTextContent(this):u.Guard.isAttrNode(this)?this._value:u.Guard.isCharacterDataNode(this)?this._data:null},set:function(x){x===null&&(x=""),u.Guard.isDocumentFragmentNode(this)||u.Guard.isElementNode(this)?h.node_stringReplaceAll(x,this):u.Guard.isAttrNode(this)?h.attr_setAnExistingAttributeValue(this,x):u.Guard.isCharacterDataNode(this)&&h.characterData_replaceData(this,0,h.tree_nodeLength(this),x)},enumerable:!0,configurable:!0}),v.prototype.normalize=function(){for(var x,w,S,T,_=[],D=h.tree_getFirstDescendantNode(this,!1,!1,(function(ye){return u.Guard.isExclusiveTextNode(ye)}));D!==null;)_.push(D),D=h.tree_getNextDescendantNode(this,D,!1,!1,(function(ye){return u.Guard.isExclusiveTextNode(ye)}));for(var I=0;I<_.length;I++){var R=_[I];if(R._parent!==null){var O=h.tree_nodeLength(R);if(O!==0){var P=[],N="";try{for(var A=(x=void 0,s(h.text_contiguousExclusiveTextNodes(R))),B=A.next();!B.done;B=A.next()){var V=B.value;P.push(V),N+=V._data}}catch(ye){x={error:ye}}finally{try{B&&!B.done&&(w=A.return)&&w.call(A)}finally{if(x)throw x.error}}if(h.characterData_replaceData(R,O,0,N),l.dom.rangeList.size!==0)for(var $=R._nextSibling;$!==null&&u.Guard.isExclusiveTextNode($);){var U=$,G=h.tree_index(U);try{for(var F=(S=void 0,s(l.dom.rangeList)),J=F.next();!J.done;J=F.next()){var Q=J.value;Q._start[0]===U&&(Q._start[0]=R,Q._start[1]+=O),Q._end[0]===U&&(Q._end[0]=R,Q._end[1]+=O),Q._start[0]===U._parent&&Q._start[1]===G&&(Q._start[0]=R,Q._start[1]=O),Q._end[0]===U._parent&&Q._end[1]===G&&(Q._end[0]=R,Q._end[1]=O)}}catch(ye){S={error:ye}}finally{try{J&&!J.done&&(T=F.return)&&T.call(F)}finally{if(S)throw S.error}}O+=h.tree_nodeLength($),$=$._nextSibling}for(var ne=0;ne<P.length;ne++)(V=P[ne])._parent!==null&&h.mutation_remove(V,V._parent)}else h.mutation_remove(R,R._parent)}}},v.prototype.cloneNode=function(x){if(x===void 0&&(x=!1),u.Guard.isShadowRoot(this))throw new d.NotSupportedError;return h.node_clone(this,null,x)},v.prototype.isEqualNode=function(x){return x===void 0&&(x=null),x!==null&&h.node_equals(this,x)},v.prototype.isSameNode=function(x){return x===void 0&&(x=null),this===x},v.prototype.compareDocumentPosition=function(x){if(x===this)return 0;var w=x,S=this,T=null,_=null;if(u.Guard.isAttrNode(w)&&(w=(T=w)._element),u.Guard.isAttrNode(S)&&(S=(_=S)._element,T&&w&&w===S))for(var D=0;D<S._attributeList.length;D++){var I=S._attributeList[D];if(h.node_equals(I,T))return c.Position.ImplementationSpecific|c.Position.Preceding;if(h.node_equals(I,_))return c.Position.ImplementationSpecific|c.Position.Following}return w===null||S===null||h.tree_rootNode(w)!==h.tree_rootNode(S)?c.Position.Disconnected|c.Position.ImplementationSpecific|(l.dom.compareCache.check(this,x)?c.Position.Preceding:c.Position.Following):!T&&h.tree_isAncestorOf(S,w)||_&&w===S?c.Position.Contains|c.Position.Preceding:!_&&h.tree_isDescendantOf(S,w)||T&&w===S?c.Position.ContainedBy|c.Position.Following:h.tree_isPreceding(S,w)?c.Position.Preceding:c.Position.Following},v.prototype.contains=function(x){return x!==null&&h.tree_isDescendantOf(this,x,!0)},v.prototype.lookupPrefix=function(x){return x?u.Guard.isElementNode(this)?h.node_locateANamespacePrefix(this,x):u.Guard.isDocumentNode(this)?this.documentElement===null?null:h.node_locateANamespacePrefix(this.documentElement,x):u.Guard.isDocumentTypeNode(this)||u.Guard.isDocumentFragmentNode(this)?null:u.Guard.isAttrNode(this)?this._element===null?null:h.node_locateANamespacePrefix(this._element,x):this._parent!==null&&u.Guard.isElementNode(this._parent)?h.node_locateANamespacePrefix(this._parent,x):null:null},v.prototype.lookupNamespaceURI=function(x){return h.node_locateANamespace(this,x||null)},v.prototype.isDefaultNamespace=function(x){return x||(x=null),h.node_locateANamespace(this,null)===x},v.prototype.insertBefore=function(x,w){return h.mutation_preInsert(x,this,w)},v.prototype.appendChild=function(x){return h.mutation_append(x,this)},v.prototype.replaceChild=function(x,w){return h.mutation_replace(w,x,this)},v.prototype.removeChild=function(x){return h.mutation_preRemove(x,this)},v.prototype._getTheParent=function(x){return u.Guard.isSlotable(this)&&h.shadowTree_isAssigned(this)?this._assignedSlot:this._parent},v.ELEMENT_NODE=1,v.ATTRIBUTE_NODE=2,v.TEXT_NODE=3,v.CDATA_SECTION_NODE=4,v.ENTITY_REFERENCE_NODE=5,v.ENTITY_NODE=6,v.PROCESSING_INSTRUCTION_NODE=7,v.COMMENT_NODE=8,v.DOCUMENT_NODE=9,v.DOCUMENT_TYPE_NODE=10,v.DOCUMENT_FRAGMENT_NODE=11,v.NOTATION_NODE=12,v.DOCUMENT_POSITION_DISCONNECTED=1,v.DOCUMENT_POSITION_PRECEDING=2,v.DOCUMENT_POSITION_FOLLOWING=4,v.DOCUMENT_POSITION_CONTAINS=8,v.DOCUMENT_POSITION_CONTAINED_BY=16,v.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC=32,v})(f.EventTargetImpl);r.NodeImpl=m,m.prototype._children=new u.EmptySet,g.idl_defineConst(m.prototype,"ELEMENT_NODE",1),g.idl_defineConst(m.prototype,"ATTRIBUTE_NODE",2),g.idl_defineConst(m.prototype,"TEXT_NODE",3),g.idl_defineConst(m.prototype,"CDATA_SECTION_NODE",4),g.idl_defineConst(m.prototype,"ENTITY_REFERENCE_NODE",5),g.idl_defineConst(m.prototype,"ENTITY_NODE",6),g.idl_defineConst(m.prototype,"PROCESSING_INSTRUCTION_NODE",7),g.idl_defineConst(m.prototype,"COMMENT_NODE",8),g.idl_defineConst(m.prototype,"DOCUMENT_NODE",9),g.idl_defineConst(m.prototype,"DOCUMENT_TYPE_NODE",10),g.idl_defineConst(m.prototype,"DOCUMENT_FRAGMENT_NODE",11),g.idl_defineConst(m.prototype,"NOTATION_NODE",12),g.idl_defineConst(m.prototype,"DOCUMENT_POSITION_DISCONNECTED",1),g.idl_defineConst(m.prototype,"DOCUMENT_POSITION_PRECEDING",2),g.idl_defineConst(m.prototype,"DOCUMENT_POSITION_FOLLOWING",4),g.idl_defineConst(m.prototype,"DOCUMENT_POSITION_CONTAINS",8),g.idl_defineConst(m.prototype,"DOCUMENT_POSITION_CONTAINED_BY",16),g.idl_defineConst(m.prototype,"DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC",32)},function(n,r){n.exports=function(i){if(i==null)throw TypeError("Can't call method on "+i);return i}},function(n,r,i){var a=i(87),o=i(41),s=i(27),l=i(26),c=i(128),f=[].push,u=function(d){var h=d==1,p=d==2,g=d==3,m=d==4,y=d==6,v=d==5||y;return function(x,w,S,T){for(var _,D,I=s(x),R=o(I),O=a(w,S,3),P=l(R.length),N=0,A=T||c,B=h?A(x,P):p?A(x,0):void 0;P>N;N++)if((v||N in R)&&(D=O(_=R[N],N,I),d)){if(h)B[N]=D;else if(D)switch(d){case 3:return!0;case 5:return _;case 6:return N;case 2:f.call(B,_)}else if(m)return!1}return y?-1:g||m?m:B}};n.exports={forEach:u(0),map:u(1),filter:u(2),some:u(3),every:u(4),find:u(5),findIndex:u(6)}},function(n,r,i){var a=this&&this.__values||function(I){var R=typeof Symbol=="function"&&Symbol.iterator,O=R&&I[R],P=0;if(O)return O.call(I);if(I&&typeof I.length=="number")return{next:function(){return I&&P>=I.length&&(I=void 0),{value:I&&I[P++],done:!I}}};throw new TypeError(R?"Object is not iterable.":"Symbol.iterator is not defined.")},o=this&&this.__read||function(I,R){var O=typeof Symbol=="function"&&I[Symbol.iterator];if(!O)return I;var P,N,A=O.call(I),B=[];try{for(;(R===void 0||R-- >0)&&!(P=A.next()).done;)B.push(P.value)}catch(V){N={error:V}}finally{try{P&&!P.done&&(O=A.return)&&O.call(A)}finally{if(N)throw N.error}}return B},s=this&&this.__spread||function(){for(var I=[],R=0;R<arguments.length;R++)I=I.concat(o(arguments[R]));return I};Object.defineProperty(r,"__esModule",{value:!0});var l=i(6),c=i(9),f=i(2),u=i(3),d=i(1),h=i(7),p=i(73),g=i(17),m=i(172),y=i(72),v=i(51),x=i(30),w=i(106);function S(I,R,O){var P,N,A,B,V,$,U,G,F=R._nodeType,J=I._nodeType,Q=O?O._nodeType:null;if(F!==f.NodeType.Document&&F!==f.NodeType.DocumentFragment&&F!==f.NodeType.Element)throw new c.HierarchyRequestError("Only document, document fragment and element nodes can contain child nodes. Parent node is "+R.nodeName+".");if(g.tree_isHostIncludingAncestorOf(R,I,!0))throw new c.HierarchyRequestError("The node to be inserted cannot be an inclusive ancestor of parent node. Node is "+I.nodeName+", parent node is "+R.nodeName+".");if(O!==null&&O._parent!==R)throw new c.NotFoundError("The reference child node cannot be found under parent node. Child node is "+O.nodeName+", parent node is "+R.nodeName+".");if(J!==f.NodeType.DocumentFragment&&J!==f.NodeType.DocumentType&&J!==f.NodeType.Element&&J!==f.NodeType.Text&&J!==f.NodeType.ProcessingInstruction&&J!==f.NodeType.CData&&J!==f.NodeType.Comment)throw new c.HierarchyRequestError("Only document fragment, document type, element, text, processing instruction, cdata section or comment nodes can be inserted. Node is "+I.nodeName+".");if(J===f.NodeType.Text&&F===f.NodeType.Document)throw new c.HierarchyRequestError("Cannot insert a text node as a child of a document node. Node is "+I.nodeName+".");if(J===f.NodeType.DocumentType&&F!==f.NodeType.Document)throw new c.HierarchyRequestError("A document type node can only be inserted under a document node. Parent node is "+R.nodeName+".");if(F===f.NodeType.Document){if(J===f.NodeType.DocumentFragment){var ne=0;try{for(var ye=a(I._children),ve=ye.next();!ve.done;ve=ye.next()){var Ce=ve.value;if(Ce._nodeType===f.NodeType.Element)ne++;else if(Ce._nodeType===f.NodeType.Text)throw new c.HierarchyRequestError("Cannot insert text a node as a child of a document node. Node is "+Ce.nodeName+".")}}catch(de){P={error:de}}finally{try{ve&&!ve.done&&(N=ye.return)&&N.call(ye)}finally{if(P)throw P.error}}if(ne>1)throw new c.HierarchyRequestError("A document node can only have one document element node. Document fragment to be inserted has "+ne+" element nodes.");if(ne===1){try{for(var we=a(R._children),Ae=we.next();!Ae.done;Ae=we.next())if(Ae.value._nodeType===f.NodeType.Element)throw new c.HierarchyRequestError("The document node already has a document element node.")}catch(de){A={error:de}}finally{try{Ae&&!Ae.done&&(B=we.return)&&B.call(we)}finally{if(A)throw A.error}}if(O){if(Q===f.NodeType.DocumentType)throw new c.HierarchyRequestError("Cannot insert an element node before a document type node.");for(var Me=O._nextSibling;Me;){if(Me._nodeType===f.NodeType.DocumentType)throw new c.HierarchyRequestError("Cannot insert an element node before a document type node.");Me=Me._nextSibling}}}}else if(J===f.NodeType.Element){try{for(var q=a(R._children),k=q.next();!k.done;k=q.next())if(k.value._nodeType===f.NodeType.Element)throw new c.HierarchyRequestError("Document already has a document element node. Node is "+I.nodeName+".")}catch(de){V={error:de}}finally{try{k&&!k.done&&($=q.return)&&$.call(q)}finally{if(V)throw V.error}}if(O){if(Q===f.NodeType.DocumentType)throw new c.HierarchyRequestError("Cannot insert an element node before a document type node. Node is "+I.nodeName+".");for(Me=O._nextSibling;Me;){if(Me._nodeType===f.NodeType.DocumentType)throw new c.HierarchyRequestError("Cannot insert an element node before a document type node. Node is "+I.nodeName+".");Me=Me._nextSibling}}}else if(J===f.NodeType.DocumentType){try{for(var Y=a(R._children),X=Y.next();!X.done;X=Y.next())if(X.value._nodeType===f.NodeType.DocumentType)throw new c.HierarchyRequestError("Document already has a document type node. Node is "+I.nodeName+".")}catch(de){U={error:de}}finally{try{X&&!X.done&&(G=Y.return)&&G.call(Y)}finally{if(U)throw U.error}}if(O)for(var re=O._previousSibling;re;){if(re._nodeType===f.NodeType.Element)throw new c.HierarchyRequestError("Cannot insert a document type node before an element node. Node is "+I.nodeName+".");re=re._previousSibling}else for(re=R._firstChild;re;){if(re._nodeType===f.NodeType.Element)throw new c.HierarchyRequestError("Cannot insert a document type node before an element node. Node is "+I.nodeName+".");re=re._nextSibling}}}}function T(I,R,O){S(I,R,O);var P=O;return P===I&&(P=I._nextSibling),w.document_adopt(I,R._nodeDocument),_(I,R,P),I}function _(I,R,O,P){var N,A;if(O!==null||I._nodeType===f.NodeType.DocumentFragment){var B=I._nodeType===f.NodeType.DocumentFragment?I._children.size:1;if(O!==null&&l.dom.rangeList.size!==0){var V=g.tree_index(O);try{for(var $=a(l.dom.rangeList),U=$.next();!U.done;U=$.next()){var G=U.value;G._start[0]===R&&G._start[1]>V&&(G._start[1]+=B),G._end[0]===R&&G._end[1]>V&&(G._end[1]+=B)}}catch(Ae){N={error:Ae}}finally{try{U&&!U.done&&(A=$.return)&&A.call($)}finally{if(N)throw N.error}}}var F=I._nodeType===f.NodeType.DocumentFragment?new(Array.bind.apply(Array,s([void 0],I._children))):[I];if(I._nodeType===f.NodeType.DocumentFragment)for(;I._firstChild;)D(I._firstChild,I,!0);l.dom.features.mutationObservers&&I._nodeType===f.NodeType.DocumentFragment&&v.observer_queueTreeMutationRecord(I,[],F,null,null);for(var J=O?O._previousSibling:R._lastChild,Q=O===null?-1:g.tree_index(O),ne=0;ne<F.length;ne++){var ye=F[ne];if(u.Guard.isElementNode(ye)&&(u.Guard.isDocumentNode(R)&&(R._documentElement=ye),ye._nodeDocument._hasNamespaces||ye._namespace===null&&ye._namespacePrefix===null||(ye._nodeDocument._hasNamespaces=!0)),ye._parent=R,O===null?h.set.append(R._children,ye):(h.set.insert(R._children,ye,Q),Q++),R._firstChild===null)ye._previousSibling=null,ye._nextSibling=null,R._firstChild=ye,R._lastChild=ye;else{var ve=O?O._previousSibling:R._lastChild,Ce=O||null;ye._previousSibling=ve,ye._nextSibling=Ce,ve&&(ve._nextSibling=ye),Ce&&(Ce._previousSibling=ye),ve||(R._firstChild=ye),Ce||(R._lastChild=ye)}l.dom.features.slots&&R._shadowRoot!==null&&u.Guard.isSlotable(ye)&&y.shadowTree_assignASlot(ye),l.dom.features.steps&&u.Guard.isTextNode(ye)&&x.dom_runChildTextContentChangeSteps(R),l.dom.features.slots&&u.Guard.isShadowRoot(g.tree_rootNode(R))&&u.Guard.isSlot(R)&&d.isEmpty(R._assignedNodes)&&y.shadowTree_signalASlotChange(R),l.dom.features.slots&&y.shadowTree_assignSlotablesForATree(g.tree_rootNode(ye));for(var we=g.tree_getFirstDescendantNode(ye,!0,!0);we!==null;)l.dom.features.steps&&x.dom_runInsertionSteps(we),l.dom.features.customElements&&u.Guard.isElementNode(we)&&y.shadowTree_isConnected(we)&&(u.Guard.isCustomElementNode(we)?p.customElement_enqueueACustomElementCallbackReaction(we,"connectedCallback",[]):p.customElement_tryToUpgrade(we)),we=g.tree_getNextDescendantNode(ye,we,!0,!0)}l.dom.features.mutationObservers&&(P||v.observer_queueTreeMutationRecord(R,F,[],J,O))}else(function(Ae,Me,q){var k=Me._lastChild;if(u.Guard.isElementNode(Ae)&&(u.Guard.isDocumentNode(Me)&&(Me._documentElement=Ae),Ae._nodeDocument._hasNamespaces||Ae._namespace===null&&Ae._namespacePrefix===null||(Ae._nodeDocument._hasNamespaces=!0)),Ae._parent=Me,Me._children.add(Ae),Me._firstChild===null)Ae._previousSibling=null,Ae._nextSibling=null,Me._firstChild=Ae,Me._lastChild=Ae;else{var Y=Me._lastChild;Ae._previousSibling=Y,Ae._nextSibling=null,Y&&(Y._nextSibling=Ae),Y||(Me._firstChild=Ae),Me._lastChild=Ae}l.dom.features.slots&&Me._shadowRoot!==null&&u.Guard.isSlotable(Ae)&&y.shadowTree_assignASlot(Ae),l.dom.features.steps&&u.Guard.isTextNode(Ae)&&x.dom_runChildTextContentChangeSteps(Me),l.dom.features.slots&&u.Guard.isShadowRoot(g.tree_rootNode(Me))&&u.Guard.isSlot(Me)&&d.isEmpty(Me._assignedNodes)&&y.shadowTree_signalASlotChange(Me),l.dom.features.slots&&y.shadowTree_assignSlotablesForATree(g.tree_rootNode(Ae)),l.dom.features.steps&&x.dom_runInsertionSteps(Ae),l.dom.features.customElements&&u.Guard.isElementNode(Ae)&&y.shadowTree_isConnected(Ae)&&(u.Guard.isCustomElementNode(Ae)?p.customElement_enqueueACustomElementCallbackReaction(Ae,"connectedCallback",[]):p.customElement_tryToUpgrade(Ae)),l.dom.features.mutationObservers&&(q||v.observer_queueTreeMutationRecord(Me,[Ae],[],k,null))})(I,R,P)}function D(I,R,O){var P,N,A,B,V,$,U,G;if(l.dom.rangeList.size!==0){var F=g.tree_index(I);try{for(var J=a(l.dom.rangeList),Q=J.next();!Q.done;Q=J.next()){var ne=Q.value;g.tree_isDescendantOf(I,ne._start[0],!0)&&(ne._start=[R,F]),g.tree_isDescendantOf(I,ne._end[0],!0)&&(ne._end=[R,F]),ne._start[0]===R&&ne._start[1]>F&&ne._start[1]--,ne._end[0]===R&&ne._end[1]>F&&ne._end[1]--}}catch(Oe){P={error:Oe}}finally{try{Q&&!Q.done&&(N=J.return)&&N.call(J)}finally{if(P)throw P.error}}try{for(var ye=a(l.dom.rangeList),ve=ye.next();!ve.done;ve=ye.next())(ne=ve.value)._start[0]===R&&ne._start[1]>F&&(ne._start[1]-=1),ne._end[0]===R&&ne._end[1]>F&&(ne._end[1]-=1)}catch(Oe){A={error:Oe}}finally{try{ve&&!ve.done&&(B=ye.return)&&B.call(ye)}finally{if(A)throw A.error}}}if(l.dom.features.steps)try{for(var Ce=a(m.nodeIterator_iteratorList()),we=Ce.next();!we.done;we=Ce.next()){var Ae=we.value;Ae._root._nodeDocument===I._nodeDocument&&x.dom_runNodeIteratorPreRemovingSteps(Ae,I)}}catch(Oe){V={error:Oe}}finally{try{we&&!we.done&&($=Ce.return)&&$.call(Ce)}finally{if(V)throw V.error}}var Me=I._previousSibling,q=I._nextSibling;u.Guard.isDocumentNode(R)&&u.Guard.isElementNode(I)&&(R._documentElement=null),I._parent=null,R._children.delete(I);var k=I._previousSibling,Y=I._nextSibling;I._previousSibling=null,I._nextSibling=null,k&&(k._nextSibling=Y),Y&&(Y._previousSibling=k),k||(R._firstChild=Y),Y||(R._lastChild=k),l.dom.features.slots&&u.Guard.isSlotable(I)&&I._assignedSlot!==null&&y.shadowTree_isAssigned(I)&&y.shadowTree_assignSlotables(I._assignedSlot),l.dom.features.slots&&u.Guard.isShadowRoot(g.tree_rootNode(R))&&u.Guard.isSlot(R)&&d.isEmpty(R._assignedNodes)&&y.shadowTree_signalASlotChange(R),l.dom.features.slots&&g.tree_getFirstDescendantNode(I,!0,!1,(function(Oe){return u.Guard.isSlot(Oe)}))!==null&&(y.shadowTree_assignSlotablesForATree(g.tree_rootNode(R)),y.shadowTree_assignSlotablesForATree(I)),l.dom.features.steps&&x.dom_runRemovingSteps(I,R),l.dom.features.customElements&&u.Guard.isCustomElementNode(I)&&p.customElement_enqueueACustomElementCallbackReaction(I,"disconnectedCallback",[]);for(var X=g.tree_getFirstDescendantNode(I,!1,!0);X!==null;)l.dom.features.steps&&x.dom_runRemovingSteps(X,I),l.dom.features.customElements&&u.Guard.isCustomElementNode(X)&&p.customElement_enqueueACustomElementCallbackReaction(X,"disconnectedCallback",[]),X=g.tree_getNextDescendantNode(I,X,!1,!0);if(l.dom.features.mutationObservers)for(var re=g.tree_getFirstAncestorNode(R,!0);re!==null;){try{for(var de=(U=void 0,a(re._registeredObserverList)),he=de.next();!he.done;he=de.next()){var Ee=he.value;Ee.options.subtree&&I._registeredObserverList.push({observer:Ee.observer,options:Ee.options,source:Ee})}}catch(Oe){U={error:Oe}}finally{try{he&&!he.done&&(G=de.return)&&G.call(de)}finally{if(U)throw U.error}}re=g.tree_getNextAncestorNode(R,re,!0)}l.dom.features.mutationObservers&&(O||v.observer_queueTreeMutationRecord(R,[],[I],Me,q)),l.dom.features.steps&&u.Guard.isTextNode(I)&&x.dom_runChildTextContentChangeSteps(R)}r.mutation_ensurePreInsertionValidity=S,r.mutation_preInsert=T,r.mutation_insert=_,r.mutation_append=function(I,R){return T(I,R,null)},r.mutation_replace=function(I,R,O){var P,N,A,B,V,$,U,G;if(O._nodeType!==f.NodeType.Document&&O._nodeType!==f.NodeType.DocumentFragment&&O._nodeType!==f.NodeType.Element)throw new c.HierarchyRequestError("Only document, document fragment and element nodes can contain child nodes. Parent node is "+O.nodeName+".");if(g.tree_isHostIncludingAncestorOf(O,R,!0))throw new c.HierarchyRequestError("The node to be inserted cannot be an ancestor of parent node. Node is "+R.nodeName+", parent node is "+O.nodeName+".");if(I._parent!==O)throw new c.NotFoundError("The reference child node cannot be found under parent node. Child node is "+I.nodeName+", parent node is "+O.nodeName+".");if(R._nodeType!==f.NodeType.DocumentFragment&&R._nodeType!==f.NodeType.DocumentType&&R._nodeType!==f.NodeType.Element&&R._nodeType!==f.NodeType.Text&&R._nodeType!==f.NodeType.ProcessingInstruction&&R._nodeType!==f.NodeType.CData&&R._nodeType!==f.NodeType.Comment)throw new c.HierarchyRequestError("Only document fragment, document type, element, text, processing instruction, cdata section or comment nodes can be inserted. Node is "+R.nodeName+".");if(R._nodeType===f.NodeType.Text&&O._nodeType===f.NodeType.Document)throw new c.HierarchyRequestError("Cannot insert a text node as a child of a document node. Node is "+R.nodeName+".");if(R._nodeType===f.NodeType.DocumentType&&O._nodeType!==f.NodeType.Document)throw new c.HierarchyRequestError("A document type node can only be inserted under a document node. Parent node is "+O.nodeName+".");if(O._nodeType===f.NodeType.Document){if(R._nodeType===f.NodeType.DocumentFragment){var F=0;try{for(var J=a(R._children),Q=J.next();!Q.done;Q=J.next()){var ne=Q.value;if(ne._nodeType===f.NodeType.Element)F++;else if(ne._nodeType===f.NodeType.Text)throw new c.HierarchyRequestError("Cannot insert text a node as a child of a document node. Node is "+ne.nodeName+".")}}catch(Ee){P={error:Ee}}finally{try{Q&&!Q.done&&(N=J.return)&&N.call(J)}finally{if(P)throw P.error}}if(F>1)throw new c.HierarchyRequestError("A document node can only have one document element node. Document fragment to be inserted has "+F+" element nodes.");if(F===1){try{for(var ye=a(O._children),ve=ye.next();!ve.done;ve=ye.next())if((k=ve.value)._nodeType===f.NodeType.Element&&k!==I)throw new c.HierarchyRequestError("The document node already has a document element node.")}catch(Ee){A={error:Ee}}finally{try{ve&&!ve.done&&(B=ye.return)&&B.call(ye)}finally{if(A)throw A.error}}for(var Ce=I._nextSibling;Ce;){if(Ce._nodeType===f.NodeType.DocumentType)throw new c.HierarchyRequestError("Cannot insert an element node before a document type node.");Ce=Ce._nextSibling}}}else if(R._nodeType===f.NodeType.Element){try{for(var we=a(O._children),Ae=we.next();!Ae.done;Ae=we.next())if((k=Ae.value)._nodeType===f.NodeType.Element&&k!==I)throw new c.HierarchyRequestError("Document already has a document element node. Node is "+R.nodeName+".")}catch(Ee){V={error:Ee}}finally{try{Ae&&!Ae.done&&($=we.return)&&$.call(we)}finally{if(V)throw V.error}}for(Ce=I._nextSibling;Ce;){if(Ce._nodeType===f.NodeType.DocumentType)throw new c.HierarchyRequestError("Cannot insert an element node before a document type node. Node is "+R.nodeName+".");Ce=Ce._nextSibling}}else if(R._nodeType===f.NodeType.DocumentType){try{for(var Me=a(O._children),q=Me.next();!q.done;q=Me.next()){var k;if((k=q.value)._nodeType===f.NodeType.DocumentType&&k!==I)throw new c.HierarchyRequestError("Document already has a document type node. Node is "+R.nodeName+".")}}catch(Ee){U={error:Ee}}finally{try{q&&!q.done&&(G=Me.return)&&G.call(Me)}finally{if(U)throw U.error}}for(var Y=I._previousSibling;Y;){if(Y._nodeType===f.NodeType.Element)throw new c.HierarchyRequestError("Cannot insert a document type node before an element node. Node is "+R.nodeName+".");Y=Y._previousSibling}}}var X=I._nextSibling;X===R&&(X=R._nextSibling);var re=I._previousSibling;w.document_adopt(R,O._nodeDocument);var de=[];I._parent!==null&&(de.push(I),D(I,I._parent,!0));var he=[];return R._nodeType===f.NodeType.DocumentFragment?he=Array.from(R._children):he.push(R),_(R,O,X,!0),l.dom.features.mutationObservers&&v.observer_queueTreeMutationRecord(O,he,de,re,X),I},r.mutation_replaceAll=function(I,R){var O,P;I!==null&&w.document_adopt(I,R._nodeDocument);var N=Array.from(R._children),A=[];I&&I._nodeType===f.NodeType.DocumentFragment?A=Array.from(I._children):I!==null&&A.push(I);try{for(var B=a(N),V=B.next();!V.done;V=B.next())D(V.value,R,!0)}catch($){O={error:$}}finally{try{V&&!V.done&&(P=B.return)&&P.call(B)}finally{if(O)throw O.error}}I!==null&&_(I,R,null,!0),l.dom.features.mutationObservers&&v.observer_queueTreeMutationRecord(R,A,N,null,null)},r.mutation_preRemove=function(I,R){if(I._parent!==R)throw new c.NotFoundError("The child node cannot be found under parent node. Child node is "+I.nodeName+", parent node is "+R.nodeName+".");return D(I,R),I},r.mutation_remove=D},function(n,r,i){function a(o){return o==null}n.exports.isNothing=a,n.exports.isObject=function(o){return typeof o=="object"&&o!==null},n.exports.toArray=function(o){return Array.isArray(o)?o:a(o)?[]:[o]},n.exports.repeat=function(o,s){var l,c="";for(l=0;l<s;l+=1)c+=o;return c},n.exports.isNegativeZero=function(o){return o===0&&Number.NEGATIVE_INFINITY===1/o},n.exports.extend=function(o,s){var l,c,f,u;if(s)for(l=0,c=(u=Object.keys(s)).length;l<c;l+=1)o[f=u[l]]=s[f];return o}},function(n,r,i){var a=i(38),o=i(53),s=i(10);function l(f,u,d){var h=[];return f.include.forEach((function(p){d=l(p,u,d)})),f[u].forEach((function(p){d.forEach((function(g,m){g.tag===p.tag&&g.kind===p.kind&&h.push(m)})),d.push(p)})),d.filter((function(p,g){return h.indexOf(g)===-1}))}function c(f){this.include=f.include||[],this.implicit=f.implicit||[],this.explicit=f.explicit||[],this.implicit.forEach((function(u){if(u.loadKind&&u.loadKind!=="scalar")throw new o("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.")})),this.compiledImplicit=l(this,"implicit",[]),this.compiledExplicit=l(this,"explicit",[]),this.compiledTypeMap=(function(){var u,d,h={scalar:{},sequence:{},mapping:{},fallback:{}};function p(g){h[g.kind][g.tag]=h.fallback[g.tag]=g}for(u=0,d=arguments.length;u<d;u+=1)arguments[u].forEach(p);return h})(this.compiledImplicit,this.compiledExplicit)}c.DEFAULT=null,c.create=function(){var f,u;switch(arguments.length){case 1:f=c.DEFAULT,u=arguments[0];break;case 2:f=arguments[0],u=arguments[1];break;default:throw new o("Wrong number of arguments for Schema.create function")}if(f=a.toArray(f),u=a.toArray(u),!f.every((function(d){return d instanceof c})))throw new o("Specified list of super schemas (or a single Schema object) contains a non-Schema object.");if(!u.every((function(d){return d instanceof s})))throw new o("Specified list of YAML types (or a single Type object) contains a non-Type object.");return new c({include:f,explicit:u})},n.exports=c},function(n,r){n.exports=function(i,a){return{enumerable:!(1&i),configurable:!(2&i),writable:!(4&i),value:a}}},function(n,r,i){var a=i(8),o=i(42),s="".split;n.exports=a((function(){return!Object("z").propertyIsEnumerable(0)}))?function(l){return o(l)=="String"?s.call(l,""):Object(l)}:Object},function(n,r){var i={}.toString;n.exports=function(a){return i.call(a).slice(8,-1)}},function(n,r,i){var a,o,s,l=i(186),c=i(11),f=i(13),u=i(21),d=i(14),h=i(57),p=i(45),g=c.WeakMap;if(l){var m=new g,y=m.get,v=m.has,x=m.set;a=function(S,T){return x.call(m,S,T),T},o=function(S){return y.call(m,S)||{}},s=function(S){return v.call(m,S)}}else{var w=h("state");p[w]=!0,a=function(S,T){return u(S,w,T),T},o=function(S){return d(S,w)?S[w]:{}},s=function(S){return d(S,w)}}n.exports={set:a,get:o,has:s,enforce:function(S){return s(S)?o(S):a(S,{})},getterFor:function(S){return function(T){var _;if(!f(T)||(_=o(T)).type!==S)throw TypeError("Incompatible receiver, "+S+" required");return _}}}},function(n,r){n.exports=!1},function(n,r){n.exports={}},function(n,r,i){var a=i(120),o=i(11),s=function(l){return typeof l=="function"?l:void 0};n.exports=function(l,c){return arguments.length<2?s(a[l])||s(o[l]):a[l]&&a[l][c]||o[l]&&o[l][c]}},function(n,r){var i=Math.ceil,a=Math.floor;n.exports=function(o){return isNaN(o=+o)?0:(o>0?a:i)(o)}},function(n,r,i){var a=i(8);n.exports=function(o,s){var l=[][o];return!!l&&a((function(){l.call(null,s||function(){throw 1},1)}))}},function(n,r){n.exports={}},function(n,r,i){i(31),i(32),i(33),i(220),i(64),i(19),i(65),i(20),i(68),i(66),i(92),i(144),i(22),i(94),i(23);var a=this&&this.__values||function(p){var g=typeof Symbol=="function"&&Symbol.iterator,m=g&&p[g],y=0;if(m)return m.call(p);if(p&&typeof p.length=="number")return{next:function(){return p&&y>=p.length&&(p=void 0),{value:p&&p[y++],done:!p}}};throw new TypeError(g?"Object is not iterable.":"Symbol.iterator is not defined.")},o=this&&this.__read||function(p,g){var m=typeof Symbol=="function"&&p[Symbol.iterator];if(!m)return p;var y,v,x=m.call(p),w=[];try{for(;(g===void 0||g-- >0)&&!(y=x.next()).done;)w.push(y.value)}catch(S){v={error:S}}finally{try{y&&!y.done&&(m=x.return)&&m.call(x)}finally{if(v)throw v.error}}return w},s=this&&this.__spread||function(){for(var p=[],g=0;g<arguments.length;g++)p=p.concat(o(arguments[g]));return p};Object.defineProperty(r,"__esModule",{value:!0});var l=i(2),c=i(69),f=i(95),u=i(7),d=i(0),h=(function(){function p(g){this.level=0,this._builderOptions=g}return p.prototype.declaration=function(g,m,y){},p.prototype.docType=function(g,m,y){},p.prototype.comment=function(g){},p.prototype.text=function(g){},p.prototype.instruction=function(g,m){},p.prototype.cdata=function(g){},p.prototype.openTagBegin=function(g){},p.prototype.openTagEnd=function(g,m,y){},p.prototype.closeTag=function(g){},p.prototype.attributes=function(g){var m,y;try{for(var v=a(g),x=v.next();!x.done;x=v.next()){var w=x.value;this.attribute(w[1]===null?w[2]:w[1]+":"+w[2],w[3])}}catch(S){m={error:S}}finally{try{x&&!x.done&&(y=v.return)&&y.call(v)}finally{if(m)throw m.error}}},p.prototype.attribute=function(g,m){},p.prototype.beginElement=function(g){},p.prototype.endElement=function(g){},p.prototype.serializeNode=function(g,m){var y=g._nodeDocument!==void 0&&g._nodeDocument._hasNamespaces;if(this.level=0,this.currentNode=g,y){var v=new f.NamespacePrefixMap;v.set("xml",u.namespace.XML),this._serializeNodeNS(g,null,v,{value:1},m)}else this._serializeNode(g,m)},p.prototype._serializeNodeNS=function(g,m,y,v,x){switch(this.currentNode=g,g.nodeType){case l.NodeType.Element:this._serializeElementNS(g,m,y,v,x);break;case l.NodeType.Document:this._serializeDocumentNS(g,m,y,v,x);break;case l.NodeType.Comment:this._serializeComment(g,x);break;case l.NodeType.Text:this._serializeText(g,x);break;case l.NodeType.DocumentFragment:this._serializeDocumentFragmentNS(g,m,y,v,x);break;case l.NodeType.DocumentType:this._serializeDocumentType(g,x);break;case l.NodeType.ProcessingInstruction:this._serializeProcessingInstruction(g,x);break;case l.NodeType.CData:this._serializeCData(g,x);break;default:throw new Error("Unknown node type: "+g.nodeType)}},p.prototype._serializeNode=function(g,m){switch(this.currentNode=g,g.nodeType){case l.NodeType.Element:this._serializeElement(g,m);break;case l.NodeType.Document:this._serializeDocument(g,m);break;case l.NodeType.Comment:this._serializeComment(g,m);break;case l.NodeType.Text:this._serializeText(g,m);break;case l.NodeType.DocumentFragment:this._serializeDocumentFragment(g,m);break;case l.NodeType.DocumentType:this._serializeDocumentType(g,m);break;case l.NodeType.ProcessingInstruction:this._serializeProcessingInstruction(g,m);break;case l.NodeType.CData:this._serializeCData(g,m);break;default:throw new Error("Unknown node type: "+g.nodeType)}},p.prototype._serializeElementNS=function(g,m,y,v,x){var w,S,T=[];if(x&&(g.localName.indexOf(":")!==-1||!d.xml_isName(g.localName)))throw new Error("Node local name contains invalid characters (well-formed required).");var _="",D=!1,I=!1,R=y.copy(),O={},P=this._recordNamespaceInformation(g,R,O),N=m,A=g.namespaceURI;if(N===A)P!==null&&(I=!0),_=A===u.namespace.XML?"xml:"+g.localName:g.localName,this.beginElement(_),this.openTagBegin(_);else{var B=g.prefix,V=null;if(B===null&&A===P||(V=R.get(B,A)),B==="xmlns"){if(x)throw new Error("An element cannot have the 'xmlns' prefix (well-formed required).");V=B}V!==null?(_=V+":"+g.localName,P!==null&&P!==u.namespace.XML&&(N=P||null),this.beginElement(_),this.openTagBegin(_)):B!==null?(B in O&&(B=this._generatePrefix(A,R,v)),R.set(B,A),_+=B+":"+g.localName,this.beginElement(_),this.openTagBegin(_),T.push([null,"xmlns",B,this._serializeAttributeValue(A,x)]),P!==null&&(N=P||null)):P===null||P!==null&&P!==A?(I=!0,_+=g.localName,N=A,this.beginElement(_),this.openTagBegin(_),T.push([null,null,"xmlns",this._serializeAttributeValue(A,x)])):(_+=g.localName,N=A,this.beginElement(_),this.openTagBegin(_))}T.push.apply(T,s(this._serializeAttributesNS(g,R,v,O,I,x))),this.attributes(T);var $=A===u.namespace.HTML;if($&&g.childNodes.length===0&&p._VoidElementNames.has(g.localName)?(this.openTagEnd(_,!0,!0),this.endElement(_),D=!0):$||g.childNodes.length!==0?this.openTagEnd(_,!1,!1):(this.openTagEnd(_,!0,!1),this.endElement(_),D=!0),!D){if(!($&&g.localName==="template"))try{for(var U=a(g.childNodes),G=U.next();!G.done;G=U.next()){var F=G.value;this.level++,this._serializeNodeNS(F,N,R,v,x),this.level--}}catch(J){w={error:J}}finally{try{G&&!G.done&&(S=U.return)&&S.call(U)}finally{if(w)throw w.error}}this.closeTag(_),this.endElement(_)}},p.prototype._serializeElement=function(g,m){var y,v;if(m&&(g.localName.indexOf(":")!==-1||!d.xml_isName(g.localName)))throw new Error("Node local name contains invalid characters (well-formed required).");var x=!1,w=g.localName;this.beginElement(w),this.openTagBegin(w);var S=this._serializeAttributes(g,m);if(this.attributes(S),g.hasChildNodes()?this.openTagEnd(w,!1,!1):(this.openTagEnd(w,!0,!1),this.endElement(w),x=!0),!x){try{for(var T=a(g._children),_=T.next();!_.done;_=T.next()){var D=_.value;this.level++,this._serializeNode(D,m),this.level--}}catch(I){y={error:I}}finally{try{_&&!_.done&&(v=T.return)&&v.call(T)}finally{if(y)throw y.error}}this.closeTag(w),this.endElement(w)}},p.prototype._serializeDocumentNS=function(g,m,y,v,x){var w,S;if(x&&g.documentElement===null)throw new Error("Missing document element (well-formed required).");try{for(var T=a(g.childNodes),_=T.next();!_.done;_=T.next()){var D=_.value;this._serializeNodeNS(D,m,y,v,x)}}catch(I){w={error:I}}finally{try{_&&!_.done&&(S=T.return)&&S.call(T)}finally{if(w)throw w.error}}},p.prototype._serializeDocument=function(g,m){var y,v;if(m&&g.documentElement===null)throw new Error("Missing document element (well-formed required).");try{for(var x=a(g._children),w=x.next();!w.done;w=x.next()){var S=w.value;this._serializeNode(S,m)}}catch(T){y={error:T}}finally{try{w&&!w.done&&(v=x.return)&&v.call(x)}finally{if(y)throw y.error}}},p.prototype._serializeComment=function(g,m){if(m&&(!d.xml_isLegalChar(g.data)||g.data.indexOf("--")!==-1||g.data.endsWith("-")))throw new Error("Comment data contains invalid characters (well-formed required).");this.comment(g.data)},p.prototype._serializeText=function(g,m){if(m&&!d.xml_isLegalChar(g.data))throw new Error("Text data contains invalid characters (well-formed required).");var y=g.data.replace(/(?!&([^&;]*);)&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");this.text(y)},p.prototype._serializeDocumentFragmentNS=function(g,m,y,v,x){var w,S;try{for(var T=a(g.childNodes),_=T.next();!_.done;_=T.next()){var D=_.value;this._serializeNodeNS(D,m,y,v,x)}}catch(I){w={error:I}}finally{try{_&&!_.done&&(S=T.return)&&S.call(T)}finally{if(w)throw w.error}}},p.prototype._serializeDocumentFragment=function(g,m){var y,v;try{for(var x=a(g._children),w=x.next();!w.done;w=x.next()){var S=w.value;this._serializeNode(S,m)}}catch(T){y={error:T}}finally{try{w&&!w.done&&(v=x.return)&&v.call(x)}finally{if(y)throw y.error}}},p.prototype._serializeDocumentType=function(g,m){if(m&&!d.xml_isPubidChar(g.publicId))throw new Error("DocType public identifier does not match PubidChar construct (well-formed required).");if(m&&(!d.xml_isLegalChar(g.systemId)||g.systemId.indexOf('"')!==-1&&g.systemId.indexOf("'")!==-1))throw new Error("DocType system identifier contains invalid characters (well-formed required).");this.docType(g.name,g.publicId,g.systemId)},p.prototype._serializeProcessingInstruction=function(g,m){if(m&&(g.target.indexOf(":")!==-1||/^xml$/i.test(g.target)))throw new Error("Processing instruction target contains invalid characters (well-formed required).");if(m&&(!d.xml_isLegalChar(g.data)||g.data.indexOf("?>")!==-1))throw new Error("Processing instruction data contains invalid characters (well-formed required).");this.instruction(g.target,g.data)},p.prototype._serializeCData=function(g,m){if(m&&g.data.indexOf("]]>")!==-1)throw new Error("CDATA contains invalid characters (well-formed required).");this.cdata(g.data)},p.prototype._serializeAttributesNS=function(g,m,y,v,x,w){var S,T,_=[],D=w?new c.LocalNameSet:void 0;try{for(var I=a(g.attributes),R=I.next();!R.done;R=I.next()){var O=R.value;if(w||x||O.namespaceURI!==null){if(w&&D&&D.has(O.namespaceURI,O.localName))throw new Error("Element contains duplicate attributes (well-formed required).");w&&D&&D.set(O.namespaceURI,O.localName);var P=O.namespaceURI,N=null;if(P!==null)if(N=m.get(O.prefix,P),P===u.namespace.XMLNS){if(O.value===u.namespace.XML||O.prefix===null&&x||O.prefix!==null&&(!(O.localName in v)||v[O.localName]!==O.value)&&m.has(O.localName,O.value))continue;if(w&&O.value===u.namespace.XMLNS)throw new Error("XMLNS namespace is reserved (well-formed required).");if(w&&O.value==="")throw new Error("Namespace prefix declarations cannot be used to undeclare a namespace (well-formed required).");O.prefix==="xmlns"&&(N="xmlns")}else N===null&&(N=O.prefix===null||m.hasPrefix(O.prefix)&&!m.has(O.prefix,P)?this._generatePrefix(P,m,y):O.prefix,_.push([null,"xmlns",N,this._serializeAttributeValue(P,w)]));if(w&&(O.localName.indexOf(":")!==-1||!d.xml_isName(O.localName)||O.localName==="xmlns"&&P===null))throw new Error("Attribute local name contains invalid characters (well-formed required).");_.push([P,N,O.localName,this._serializeAttributeValue(O.value,w)])}else _.push([null,null,O.localName,this._serializeAttributeValue(O.value,w)])}}catch(A){S={error:A}}finally{try{R&&!R.done&&(T=I.return)&&T.call(I)}finally{if(S)throw S.error}}return _},p.prototype._serializeAttributes=function(g,m){var y,v,x=[],w=m?{}:void 0;try{for(var S=a(g.attributes),T=S.next();!T.done;T=S.next()){var _=T.value;if(m){if(m&&w&&_.localName in w)throw new Error("Element contains duplicate attributes (well-formed required).");if(m&&w&&(w[_.localName]=!0),m&&(_.localName.indexOf(":")!==-1||!d.xml_isName(_.localName)))throw new Error("Attribute local name contains invalid characters (well-formed required).");x.push([null,null,_.localName,this._serializeAttributeValue(_.value,m)])}else x.push([null,null,_.localName,this._serializeAttributeValue(_.value,m)])}}catch(D){y={error:D}}finally{try{T&&!T.done&&(v=S.return)&&v.call(S)}finally{if(y)throw y.error}}return x},p.prototype._recordNamespaceInformation=function(g,m,y){var v,x,w=null;try{for(var S=a(g.attributes),T=S.next();!T.done;T=S.next()){var _=T.value,D=_.namespaceURI,I=_.prefix;if(D===u.namespace.XMLNS){if(I===null){w=_.value;continue}var R=_.localName,O=_.value;if(O===u.namespace.XML||(O===""&&(O=null),m.has(R,O)))continue;m.set(R,O),y[R]=O||""}}}catch(P){v={error:P}}finally{try{T&&!T.done&&(x=S.return)&&x.call(S)}finally{if(v)throw v.error}}return w},p.prototype._generatePrefix=function(g,m,y){var v="ns"+y.value.toString();return y.value++,m.set(v,g),v},p.prototype._serializeAttributeValue=function(g,m){if(m&&g!==null&&!d.xml_isLegalChar(g))throw new Error("Invalid characters in attribute value.");return g===null?"":g.replace(/(?!&([^&;]*);)&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},p._VoidElementNames=new Set(["area","base","basefont","bgsound","br","col","embed","frame","hr","img","input","keygen","link","menuitem","meta","param","source","track","wbr"]),p})();r.BaseWriter=h},function(n,r,i){var a=this&&this.__values||function(m){var y=typeof Symbol=="function"&&Symbol.iterator,v=y&&m[y],x=0;if(v)return v.call(m);if(m&&typeof m.length=="number")return{next:function(){return m&&x>=m.length&&(m=void 0),{value:m&&m[x++],done:!m}}};throw new TypeError(y?"Object is not iterable.":"Symbol.iterator is not defined.")},o=this&&this.__read||function(m,y){var v=typeof Symbol=="function"&&m[Symbol.iterator];if(!v)return m;var x,w,S=v.call(m),T=[];try{for(;(y===void 0||y-- >0)&&!(x=S.next()).done;)T.push(x.value)}catch(_){w={error:_}}finally{try{x&&!x.done&&(v=S.return)&&v.call(S)}finally{if(w)throw w.error}}return T};Object.defineProperty(r,"__esModule",{value:!0});var s=i(6),l=i(3),c=i(7),f=i(29),u=i(17),d=i(97);function h(){var m=s.dom.window;m._mutationObserverMicrotaskQueued||(m._mutationObserverMicrotaskQueued=!0,Promise.resolve().then((function(){p()})))}function p(){var m,y,v,x,w=s.dom.window;w._mutationObserverMicrotaskQueued=!1;var S=c.set.clone(w._mutationObservers),T=c.set.clone(w._signalSlots);c.set.empty(w._signalSlots);var _=function(N){var A=c.list.clone(N._recordQueue);c.list.empty(N._recordQueue);for(var B=0;B<N._nodeList.length;B++){var V=N._nodeList[B];c.list.remove(V._registeredObserverList,(function($){return l.Guard.isTransientRegisteredObserver($)&&$.observer===N}))}if(!c.list.isEmpty(A))try{N._callback.call(N,A,N)}catch{}};try{for(var D=a(S),I=D.next();!I.done;I=D.next())_(I.value)}catch(N){m={error:N}}finally{try{I&&!I.done&&(y=D.return)&&y.call(D)}finally{if(m)throw m.error}}if(s.dom.features.slots)try{for(var R=a(T),O=R.next();!O.done;O=R.next()){var P=O.value;d.event_fireAnEvent("slotchange",P,void 0,{bubbles:!0})}}catch(N){v={error:N}}finally{try{O&&!O.done&&(x=R.return)&&x.call(R)}finally{if(v)throw v.error}}}function g(m,y,v,x,w,S,T,_,D){for(var I,R,O=new Map,P=u.tree_getFirstAncestorNode(y,!0);P!==null;){for(var N=0;N<P._registeredObserverList.length;N++){var A=P._registeredObserverList[N],B=A.options;if((P===y||B.subtree)&&(m!=="attributes"||B.attributes)&&(m!=="attributes"||!B.attributeFilter||B.attributeFilter.indexOf(v||"")&&x===null)&&(m!=="characterData"||B.characterData)&&(m!=="childList"||B.childList)){var V=A.observer;O.has(V)||O.set(V,null),(m==="attributes"&&B.attributeOldValue||m==="characterData"&&B.characterDataOldValue)&&O.set(V,w)}}P=u.tree_getNextAncestorNode(y,P,!0)}try{for(var $=a(O),U=$.next();!U.done;U=$.next()){var G=o(U.value,2),F=G[0],J=G[1],Q=f.create_mutationRecord(m,y,f.create_nodeListStatic(y,S),f.create_nodeListStatic(y,T),_,D,v,x,J);F._recordQueue.push(Q)}}catch(ne){I={error:ne}}finally{try{U&&!U.done&&(R=$.return)&&R.call($)}finally{if(I)throw I.error}}h()}r.observer_queueAMutationObserverMicrotask=h,r.observer_notifyMutationObservers=p,r.observer_queueMutationRecord=g,r.observer_queueTreeMutationRecord=function(m,y,v,x,w){g("childList",m,null,null,null,y,v,x,w)},r.observer_queueAttributeMutationRecord=function(m,y,v,x){g("attributes",m,y,v,x,[],[],null,null)}},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(6),o=i(7),s=i(3),l=i(9),c=i(29),f=i(73),u=i(51),d=i(30),h=i(37),p=i(106);function g(S,T,_){a.dom.features.mutationObservers&&u.observer_queueAttributeMutationRecord(T,S._localName,S._namespace,S._value),a.dom.features.customElements&&s.Guard.isCustomElementNode(T)&&f.customElement_enqueueACustomElementCallbackReaction(T,"attributeChangedCallback",[S._localName,S._value,_,S._namespace]),a.dom.features.steps&&d.dom_runAttributeChangeSteps(T,S._localName,S._value,_,S._namespace),S._value=_}function m(S,T){a.dom.features.mutationObservers&&u.observer_queueAttributeMutationRecord(T,S._localName,S._namespace,null),a.dom.features.customElements&&s.Guard.isCustomElementNode(T)&&f.customElement_enqueueACustomElementCallbackReaction(T,"attributeChangedCallback",[S._localName,null,S._value,S._namespace]),a.dom.features.steps&&d.dom_runAttributeChangeSteps(T,S._localName,null,S._value,S._namespace),T._attributeList._asArray().push(S),S._element=T,T._nodeDocument._hasNamespaces||S._namespace===null&&S._namespacePrefix===null&&S._localName!=="xmlns"||(T._nodeDocument._hasNamespaces=!0)}function y(S,T){a.dom.features.mutationObservers&&u.observer_queueAttributeMutationRecord(T,S._localName,S._namespace,S._value),a.dom.features.customElements&&s.Guard.isCustomElementNode(T)&&f.customElement_enqueueACustomElementCallbackReaction(T,"attributeChangedCallback",[S._localName,S._value,null,S._namespace]),a.dom.features.steps&&d.dom_runAttributeChangeSteps(T,S._localName,S._value,null,S._namespace);var _=T._attributeList._asArray().indexOf(S);T._attributeList._asArray().splice(_,1),S._element=null}function v(S,T,_){a.dom.features.mutationObservers&&u.observer_queueAttributeMutationRecord(_,S._localName,S._namespace,S._value),a.dom.features.customElements&&s.Guard.isCustomElementNode(_)&&f.customElement_enqueueACustomElementCallbackReaction(_,"attributeChangedCallback",[S._localName,S._value,T._value,S._namespace]),a.dom.features.steps&&d.dom_runAttributeChangeSteps(_,S._localName,S._value,T._value,S._namespace);var D=_._attributeList._asArray().indexOf(S);D!==-1&&(_._attributeList._asArray()[D]=T),S._element=null,T._element=_,_._nodeDocument._hasNamespaces||T._namespace===null&&T._namespacePrefix===null&&T._localName!=="xmlns"||(_._nodeDocument._hasNamespaces=!0)}function x(S,T){return T._namespace===o.namespace.HTML&&T._nodeDocument._type==="html"&&(S=S.toLowerCase()),T._attributeList._asArray().find((function(_){return _._qualifiedName===S}))||null}function w(S,T,_){var D=S||null;return _._attributeList._asArray().find((function(I){return I._namespace===D&&I._localName===T}))||null}r.element_has=function(S,T){return T._attributeList._asArray().indexOf(S)!==-1},r.element_change=g,r.element_append=m,r.element_remove=y,r.element_replace=v,r.element_getAnAttributeByName=x,r.element_getAnAttributeByNamespaceAndLocalName=w,r.element_getAnAttributeValue=function(S,T,_){_===void 0&&(_="");var D=w(_,T,S);return D===null?"":D._value},r.element_setAnAttribute=function(S,T){if(S._element!==null&&S._element!==T)throw new l.InUseAttributeError("This attribute already exists in the document: "+S._qualifiedName+" as a child of "+S._element._qualifiedName+".");var _=w(S._namespace||"",S._localName,T);return _===S?S:(_!==null?v(_,S,T):m(S,T),_)},r.element_setAnAttributeValue=function(S,T,_,D,I){D===void 0&&(D=null),I===void 0&&(I=null);var R=w(I||"",T,S);if(R===null){var O=c.create_attr(S._nodeDocument,T);return O._namespace=I,O._namespacePrefix=D,O._value=_,void m(O,S)}g(R,S,_)},r.element_removeAnAttributeByName=function(S,T){var _=x(S,T);return _!==null&&y(_,T),_},r.element_removeAnAttributeByNamespaceAndLocalName=function(S,T,_){var D=w(S,T,_);return D!==null&&y(D,_),D},r.element_createAnElement=function(S,T,_,D,I,R){D===void 0&&(D=null),I===void 0&&(I=null),R===void 0&&(R=!1);var O=null;if(!a.dom.features.customElements)return(O=c.create_element(S,T,_,D))._customElementState="uncustomized",O._customElementDefinition=null,O._is=I,O;var P=f.customElement_lookUpACustomElementDefinition(S,_,T,I);if(P!==null&&P.name!==P.localName)(O=new(p.document_elementInterface(T,o.namespace.HTML)))._localName=T,O._namespace=o.namespace.HTML,O._namespacePrefix=D,O._customElementState="undefined",O._customElementDefinition=null,O._is=I,O._nodeDocument=S,R?f.customElement_upgrade(P,O):f.customElement_enqueueACustomElementUpgradeReaction(O,P);else if(P!==null)if(R)try{var N=new P.constructor;if(console.assert(N._customElementState!==void 0),console.assert(N._customElementDefinition!==void 0),console.assert(N._namespace===o.namespace.HTML),N._attributeList.length!==0)throw new l.NotSupportedError("Custom element already has attributes.");if(N._children.size!==0)throw new l.NotSupportedError("Custom element already has child nodes.");if(N._parent!==null)throw new l.NotSupportedError("Custom element already has a parent node.");if(N._nodeDocument!==S)throw new l.NotSupportedError("Custom element is already in a document.");if(N._localName!==T)throw new l.NotSupportedError("Custom element has a different local name.");N._namespacePrefix=D,N._is=null}catch{(O=c.create_htmlUnknownElement(S,T,o.namespace.HTML,D))._customElementState="failed",O._customElementDefinition=null,O._is=null}else(O=c.create_htmlElement(S,T,o.namespace.HTML,D))._customElementState="undefined",O._customElementDefinition=null,O._is=null,f.customElement_enqueueACustomElementUpgradeReaction(O,P);else(O=new(p.document_elementInterface(T,_)))._localName=T,O._namespace=_,O._namespacePrefix=D,O._customElementState="uncustomized",O._customElementDefinition=null,O._is=I,O._nodeDocument=S,_!==o.namespace.HTML||I===null&&!f.customElement_isValidCustomElementName(T)||(O._customElementState="undefined");if(O===null)throw new Error("Unable to create element.");return O},r.element_insertAdjacent=function(S,T,_){switch(T.toLowerCase()){case"beforebegin":return S._parent===null?null:h.mutation_preInsert(_,S._parent,S);case"afterbegin":return h.mutation_preInsert(_,S,S._firstChild);case"beforeend":return h.mutation_preInsert(_,S,null);case"afterend":return S._parent===null?null:h.mutation_preInsert(_,S._parent,S._nextSibling);default:throw new l.SyntaxError(`Invalid 'where' argument. "beforebegin", "afterbegin", "beforeend" or "afterend" expected`)}}},function(n,r,i){function a(o,s){Error.call(this),this.name="YAMLException",this.reason=o,this.mark=s,this.message=(this.reason||"(unknown reason)")+(this.mark?" "+this.mark.toString():""),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack||""}a.prototype=Object.create(Error.prototype),a.prototype.constructor=a,a.prototype.toString=function(o){var s=this.name+": ";return s+=this.reason||"(unknown reason)",!o&&this.mark&&(s+=" "+this.mark.toString()),s},n.exports=a},function(n,r,i){var a=i(39);n.exports=new a({include:[i(181)],implicit:[i(293),i(294)],explicit:[i(295),i(296),i(297),i(298)]})},function(n,r,i){var a=i(16),o=i(79),s=i(40),l=i(24),c=i(56),f=i(14),u=i(115),d=Object.getOwnPropertyDescriptor;r.f=a?d:function(h,p){if(h=l(h),p=c(p,!0),u)try{return d(h,p)}catch{}if(f(h,p))return s(!o.f.call(h,p),h[p])}},function(n,r,i){var a=i(13);n.exports=function(o,s){if(!a(o))return o;var l,c;if(s&&typeof(l=o.toString)=="function"&&!a(c=l.call(o))||typeof(l=o.valueOf)=="function"&&!a(c=l.call(o))||!s&&typeof(l=o.toString)=="function"&&!a(c=l.call(o)))return c;throw TypeError("Can't convert object to primitive value")}},function(n,r,i){var a=i(81),o=i(58),s=a("keys");n.exports=function(l){return s[l]||(s[l]=o(l))}},function(n,r){var i=0,a=Math.random();n.exports=function(o){return"Symbol("+String(o===void 0?"":o)+")_"+(++i+a).toString(36)}},function(n,r,i){var a=i(42);n.exports=Array.isArray||function(o){return a(o)=="Array"}},function(n,r,i){var a,o=i(18),s=i(188),l=i(84),c=i(45),f=i(189),u=i(116),d=i(57),h=d("IE_PROTO"),p=function(){},g=function(y){return"<script>"+y+"<\/script>"},m=function(){try{a=document.domain&&new ActiveXObject("htmlfile")}catch{}var y,v;m=a?(function(w){w.write(g("")),w.close();var S=w.parentWindow.Object;return w=null,S})(a):((v=u("iframe")).style.display="none",f.appendChild(v),v.src="javascript:",(y=v.contentWindow.document).open(),y.write(g("document.F=Object")),y.close(),y.F);for(var x=l.length;x--;)delete m.prototype[l[x]];return m()};c[h]=!0,n.exports=Object.create||function(y,v){var x;return y!==null?(p.prototype=o(y),x=new p,p.prototype=null,x[h]=y):x=m(),v===void 0?x:s(x,v)}},function(n,r,i){var a=i(121),o=i(84);n.exports=Object.keys||function(s){return a(s,o)}},function(n,r,i){var a=i(15).f,o=i(14),s=i(5)("toStringTag");n.exports=function(l,c,f){l&&!o(l=f?l:l.prototype,s)&&a(l,s,{configurable:!0,value:c})}},function(n,r,i){var a=i(8),o=i(5),s=i(129),l=o("species");n.exports=function(c){return s>=51||!a((function(){var f=[];return(f.constructor={})[l]=function(){return{foo:1}},f[c](Boolean).foo!==1}))}},function(n,r,i){var a=i(4),o=i(122).indexOf,s=i(48),l=i(28),c=[].indexOf,f=!!c&&1/[1].indexOf(1,-0)<0,u=s("indexOf"),d=l("indexOf",{ACCESSORS:!0,1:0});a({target:"Array",proto:!0,forced:f||!u||!d},{indexOf:function(h){return f?c.apply(this,arguments)||0:o(this,h,arguments.length>1?arguments[1]:void 0)}})},function(n,r,i){var a=i(16),o=i(15).f,s=Function.prototype,l=s.toString,c=/^\s*function ([^ (]*)/;a&&!("name"in s)&&o(s,"name",{configurable:!0,get:function(){try{return l.call(this).match(c)[1]}catch{return""}}})},function(n,r,i){var a=i(25),o=i(18),s=i(8),l=i(136),c=RegExp.prototype,f=c.toString,u=s((function(){return f.call({source:"a",flags:"b"})!="/a/b"})),d=f.name!="toString";(u||d)&&a(RegExp.prototype,"toString",(function(){var h=o(this),p=String(h.source),g=h.flags;return"/"+p+"/"+String(g===void 0&&h instanceof RegExp&&!("flags"in c)?l.call(h):g)}),{unsafe:!0})},function(n,r,i){i(31),i(32),i(33),i(19),i(138),i(20),i(66),i(22),i(23);var a,o=this&&this.__extends||(a=function(u,d){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,p){h.__proto__=p}||function(h,p){for(var g in p)p.hasOwnProperty(g)&&(h[g]=p[g])})(u,d)},function(u,d){function h(){this.constructor=u}a(u,d),u.prototype=d===null?Object.create(d):(h.prototype=d.prototype,new h)}),s=this&&this.__values||function(u){var d=typeof Symbol=="function"&&Symbol.iterator,h=d&&u[d],p=0;if(h)return h.call(u);if(u&&typeof u.length=="number")return{next:function(){return u&&p>=u.length&&(u=void 0),{value:u&&u[p++],done:!u}}};throw new TypeError(d?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var l=i(1),c=i(2),f=(function(u){function d(h,p){var g=u.call(this,h)||this;return g._writerOptions=l.applyDefaults(p,{format:"object",wellFormed:!1,group:!1,verbose:!1}),g}return o(d,u),d.prototype.serialize=function(h){return this._currentList=[],this._currentIndex=0,this._listRegister=[this._currentList],this.serializeNode(h,this._writerOptions.wellFormed),this._process(this._currentList,this._writerOptions)},d.prototype._process=function(h,p){var g,m,y,v,x,w,S;if(h.length===0)return{};for(var T={},_=!1,D=0,I=0,R=0,O=0,P=0;P<h.length;P++){var N=h[P];switch(Me=Object.keys(N)[0]){case"@":continue;case"#":D++;break;case"!":I++;break;case"?":R++;break;case"$":O++;break;default:T[Me]?_=!0:T[Me]=!0}}var A=this._getAttrKey(),B=this._getNodeKey(c.NodeType.Text),V=this._getNodeKey(c.NodeType.Comment),$=this._getNodeKey(c.NodeType.ProcessingInstruction),U=this._getNodeKey(c.NodeType.CData);if(D===1&&h.length===1&&l.isString(h[0]["#"]))return h[0]["#"];if(_){var G={};for(P=0;P<h.length;P++)if(N=h[P],(Me=Object.keys(N)[0])==="@"){var F=N["@"];(q=Object.keys(F)).length===1?G[A+q[0]]=F[q[0]]:G[A]=N["@"]}var J=[];for(P=0;P<h.length;P++)switch(N=h[P],Me=Object.keys(N)[0]){case"@":break;case"#":J.push(((g={})[B]=N["#"],g));break;case"!":J.push(((m={})[V]=N["!"],m));break;case"?":J.push(((y={})[$]=N["?"],y));break;case"$":J.push(((v={})[U]=N.$,v));break;default:if((Y=N)[Me].length!==0&&l.isArray(Y[Me][0])){for(var Q=[],ne=Y[Me],ye=0;ye<ne.length;ye++)Q.push(this._process(ne[ye],p));J.push(((x={})[Me]=Q,x))}else p.verbose?J.push(((w={})[Me]=[this._process(Y[Me],p)],w)):J.push(((S={})[Me]=this._process(Y[Me],p),S))}return G[B]=J,G}var ve=1,Ce=1,we=1,Ae=1;for(G={},P=0;P<h.length;P++){var Me;switch(N=h[P],Me=Object.keys(N)[0]){case"@":F=N["@"];var q=Object.keys(F);if(p.group&&q.length!==1)G[A]=F;else for(var k in F)G[A+k]=F[k];break;case"#":ve=this._processSpecItem(N["#"],G,p.group,B,D,ve);break;case"!":Ce=this._processSpecItem(N["!"],G,p.group,V,I,Ce);break;case"?":we=this._processSpecItem(N["?"],G,p.group,$,R,we);break;case"$":Ae=this._processSpecItem(N.$,G,p.group,U,O,Ae);break;default:var Y;if((Y=N)[Me].length!==0&&l.isArray(Y[Me][0])){Q=[],ne=Y[Me];for(var X=0;X<ne.length;X++)Q.push(this._process(ne[X],p));G[Me]=Q}else p.verbose?G[Me]=[this._process(Y[Me],p)]:G[Me]=this._process(Y[Me],p)}}return G},d.prototype._processSpecItem=function(h,p,g,m,y,v){var x,w;if(!g&&l.isArray(h)&&y+h.length>2)try{for(var S=s(h),T=S.next();!T.done;T=S.next()){var _=T.value;p[m+(v++).toString()]=_}}catch(D){x={error:D}}finally{try{T&&!T.done&&(w=S.return)&&w.call(S)}finally{if(x)throw x.error}}else p[y>1?m+(v++).toString():m]=h;return v},d.prototype.beginElement=function(h){var p,g,m=[];if(this._currentList.length===0)this._currentList.push(((p={})[h]=m,p));else{var y=this._currentList[this._currentList.length-1];this._isElementNode(y,h)?y[h].length!==0&&l.isArray(y[h][0])?y[h].push(m):y[h]=[y[h],m]:this._currentList.push(((g={})[h]=m,g))}this._currentIndex++,this._listRegister.length>this._currentIndex?this._listRegister[this._currentIndex]=m:this._listRegister.push(m),this._currentList=m},d.prototype.endElement=function(){this._currentList=this._listRegister[--this._currentIndex]},d.prototype.attribute=function(h,p){var g,m;if(this._currentList.length===0)this._currentList.push({"@":(g={},g[h]=p,g)});else{var y=this._currentList[this._currentList.length-1];this._isAttrNode(y)?y["@"][h]=p:this._currentList.push({"@":(m={},m[h]=p,m)})}},d.prototype.comment=function(h){if(this._currentList.length===0)this._currentList.push({"!":h});else{var p=this._currentList[this._currentList.length-1];this._isCommentNode(p)?l.isArray(p["!"])?p["!"].push(h):p["!"]=[p["!"],h]:this._currentList.push({"!":h})}},d.prototype.text=function(h){if(this._currentList.length===0)this._currentList.push({"#":h});else{var p=this._currentList[this._currentList.length-1];this._isTextNode(p)?l.isArray(p["#"])?p["#"].push(h):p["#"]=[p["#"],h]:this._currentList.push({"#":h})}},d.prototype.instruction=function(h,p){var g=p===""?h:h+" "+p;if(this._currentList.length===0)this._currentList.push({"?":g});else{var m=this._currentList[this._currentList.length-1];this._isInstructionNode(m)?l.isArray(m["?"])?m["?"].push(g):m["?"]=[m["?"],g]:this._currentList.push({"?":g})}},d.prototype.cdata=function(h){if(this._currentList.length===0)this._currentList.push({$:h});else{var p=this._currentList[this._currentList.length-1];this._isCDATANode(p)?l.isArray(p.$)?p.$.push(h):p.$=[p.$,h]:this._currentList.push({$:h})}},d.prototype._isAttrNode=function(h){return"@"in h},d.prototype._isTextNode=function(h){return"#"in h},d.prototype._isCommentNode=function(h){return"!"in h},d.prototype._isInstructionNode=function(h){return"?"in h},d.prototype._isCDATANode=function(h){return"$"in h},d.prototype._isElementNode=function(h,p){return p in h},d.prototype._getAttrKey=function(){return this._builderOptions.convert.att},d.prototype._getNodeKey=function(h){switch(h){case c.NodeType.Comment:return this._builderOptions.convert.comment;case c.NodeType.Text:return this._builderOptions.convert.text;case c.NodeType.ProcessingInstruction:return this._builderOptions.convert.ins;case c.NodeType.CData:return this._builderOptions.convert.cdata;default:throw new Error("Invalid node type.")}},d})(i(50).BaseWriter);r.ObjectWriter=f},function(n,r,i){var a=i(4),o=i(93);a({target:"RegExp",proto:!0,forced:/./.exec!==o},{exec:o})},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=(function(){function o(){this._items={},this._nullItems={}}return o.prototype.set=function(s,l){s===null?this._nullItems[l]=!0:(this._items[s]||(this._items[s]={}),this._items[s][l]=!0)},o.prototype.has=function(s,l){return s===null?this._nullItems[l]===!0:!!this._items[s]&&this._items[s][l]===!0},o})();r.LocalNameSet=a},function(n,r,i){var a=this&&this.__read||function(f,u){var d=typeof Symbol=="function"&&f[Symbol.iterator];if(!d)return f;var h,p,g=d.call(f),m=[];try{for(;(u===void 0||u-- >0)&&!(h=g.next()).done;)m.push(h.value)}catch(y){p={error:y}}finally{try{h&&!h.done&&(d=g.return)&&d.call(g)}finally{if(p)throw p.error}}return m};Object.defineProperty(r,"__esModule",{value:!0});var o=i(9),s=i(3),l=i(0),c=(function(){function f(){}return Object.defineProperty(f.prototype,"_eventListenerList",{get:function(){return this.__eventListenerList||(this.__eventListenerList=[])},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"_eventHandlerMap",{get:function(){return this.__eventHandlerMap||(this.__eventHandlerMap={})},enumerable:!0,configurable:!0}),f.prototype.addEventListener=function(u,d,h){h===void 0&&(h={passive:!1,once:!1,capture:!1});var p,g=a(l.eventTarget_flattenMore(h),3),m=g[0],y=g[1],v=g[2];d&&(p=s.Guard.isEventListener(d)?d:{handleEvent:d},l.eventTarget_addEventListener(this,{type:u,callback:p,capture:m,passive:y,once:v,removed:!1}))},f.prototype.removeEventListener=function(u,d,h){h===void 0&&(h={capture:!1});var p=l.eventTarget_flatten(h);if(d)for(var g=0;g<this._eventListenerList.length;g++){var m=this._eventListenerList[g];if(m.type===u&&m.capture===p){if(s.Guard.isEventListener(d)&&m.callback===d){l.eventTarget_removeEventListener(this,m,g);break}if(d&&m.callback.handleEvent===d){l.eventTarget_removeEventListener(this,m,g);break}}}},f.prototype.dispatchEvent=function(u){if(u._dispatchFlag||!u._initializedFlag)throw new o.InvalidStateError;return u._isTrusted=!1,l.event_dispatch(u,this)},f.prototype._getTheParent=function(u){return null},f})();r.EventTargetImpl=c},function(n,r,i){var a,o=this&&this.__extends||(a=function(f,u){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,h){d.__proto__=h}||function(d,h){for(var p in h)h.hasOwnProperty(p)&&(d[p]=h[p])})(f,u)},function(f,u){function d(){this.constructor=f}a(f,u),f.prototype=u===null?Object.create(u):(d.prototype=u.prototype,new d)});Object.defineProperty(r,"__esModule",{value:!0});var s=i(34),l=i(0),c=(function(f){function u(d){var h=f.call(this)||this;return h._data=d,h}return o(u,f),Object.defineProperty(u.prototype,"data",{get:function(){return this._data},set:function(d){l.characterData_replaceData(this,0,this._data.length,d)},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"length",{get:function(){return this._data.length},enumerable:!0,configurable:!0}),u.prototype.substringData=function(d,h){return l.characterData_substringData(this,d,h)},u.prototype.appendData=function(d){return l.characterData_replaceData(this,this._data.length,0,d)},u.prototype.insertData=function(d,h){l.characterData_replaceData(this,d,0,h)},u.prototype.deleteData=function(d,h){l.characterData_replaceData(this,d,h,"")},u.prototype.replaceData=function(d,h,p){l.characterData_replaceData(this,d,h,p)},Object.defineProperty(u.prototype,"previousElementSibling",{get:function(){throw new Error("Mixin: NonDocumentTypeChildNode not implemented.")},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"nextElementSibling",{get:function(){throw new Error("Mixin: NonDocumentTypeChildNode not implemented.")},enumerable:!0,configurable:!0}),u.prototype.before=function(){for(var d=[],h=0;h<arguments.length;h++)d[h]=arguments[h];throw new Error("Mixin: ChildNode not implemented.")},u.prototype.after=function(){for(var d=[],h=0;h<arguments.length;h++)d[h]=arguments[h];throw new Error("Mixin: ChildNode not implemented.")},u.prototype.replaceWith=function(){for(var d=[],h=0;h<arguments.length;h++)d[h]=arguments[h];throw new Error("Mixin: ChildNode not implemented.")},u.prototype.remove=function(){throw new Error("Mixin: ChildNode not implemented.")},u})(s.NodeImpl);r.CharacterDataImpl=c},function(n,r,i){var a=this&&this.__values||function(y){var v=typeof Symbol=="function"&&Symbol.iterator,x=v&&y[v],w=0;if(x)return x.call(y);if(y&&typeof y.length=="number")return{next:function(){return y&&w>=y.length&&(y=void 0),{value:y&&y[w++],done:!y}}};throw new TypeError(v?"Object is not iterable.":"Symbol.iterator is not defined.")},o=this&&this.__read||function(y,v){var x=typeof Symbol=="function"&&y[Symbol.iterator];if(!x)return y;var w,S,T=x.call(y),_=[];try{for(;(v===void 0||v-- >0)&&!(w=T.next()).done;)_.push(w.value)}catch(D){S={error:D}}finally{try{w&&!w.done&&(x=T.return)&&x.call(T)}finally{if(S)throw S.error}}return _},s=this&&this.__spread||function(){for(var y=[],v=0;v<arguments.length;v++)y=y.concat(o(arguments[v]));return y};Object.defineProperty(r,"__esModule",{value:!0});var l=i(6),c=i(3),f=i(1),u=i(17),d=i(51);function h(y){l.dom.window._signalSlots.add(y),d.observer_queueAMutationObserverMicrotask()}function p(y,v){v===void 0&&(v=!1);var x=c.Cast.asNode(y)._parent;if(x===null)return null;var w=x._shadowRoot||null;if(w===null||v&&w._mode!=="open")return null;for(var S=u.tree_getFirstDescendantNode(w,!1,!0,(function(T){return c.Guard.isSlot(T)}));S!==null;){if(S._name===y._name)return S;S=u.tree_getNextDescendantNode(w,S,!1,!0,(function(T){return c.Guard.isSlot(T)}))}return null}function g(y){var v,x,w=[],S=u.tree_rootNode(y);if(!c.Guard.isShadowRoot(S))return w;var T=S._host;try{for(var _=a(T._children),D=_.next();!D.done;D=_.next()){var I=D.value;c.Guard.isSlotable(I)&&p(I)===y&&w.push(I)}}catch(R){v={error:R}}finally{try{D&&!D.done&&(x=_.return)&&x.call(_)}finally{if(v)throw v.error}}return w}function m(y){var v,x,w=g(y);if(w.length===y._assignedNodes.length){for(var S=!0,T=0;T<w.length;T++)if(w[T]!==y._assignedNodes[T]){S=!1;break}S||h(y)}y._assignedNodes=w;try{for(var _=a(w),D=_.next();!D.done;D=_.next())D.value._assignedSlot=y}catch(I){v={error:I}}finally{try{D&&!D.done&&(x=_.return)&&x.call(_)}finally{if(v)throw v.error}}}r.shadowTree_signalASlotChange=h,r.shadowTree_isConnected=function(y){return c.Guard.isDocumentNode(u.tree_rootNode(y,!0))},r.shadowTree_isAssigned=function(y){return y._assignedSlot!==null},r.shadowTree_findASlot=p,r.shadowTree_findSlotables=g,r.shadowTree_findFlattenedSlotables=function y(v){var x,w,S,T,_=[],D=u.tree_rootNode(v);if(!c.Guard.isShadowRoot(D))return _;var I=g(v);if(f.isEmpty(I))try{for(var R=a(v._children),O=R.next();!O.done;O=R.next()){var P=O.value;c.Guard.isSlotable(P)&&I.push(P)}}catch($){x={error:$}}finally{try{O&&!O.done&&(w=R.return)&&w.call(R)}finally{if(x)throw x.error}}try{for(var N=a(I),A=N.next();!A.done;A=N.next()){var B=A.value;if(c.Guard.isSlot(B)&&c.Guard.isShadowRoot(u.tree_rootNode(B))){var V=y(B);_.push.apply(_,s(V))}else _.push(B)}}catch($){S={error:$}}finally{try{A&&!A.done&&(T=N.return)&&T.call(N)}finally{if(S)throw S.error}}return _},r.shadowTree_assignSlotables=m,r.shadowTree_assignSlotablesForATree=function(y){for(var v=u.tree_getFirstDescendantNode(y,!0,!1,(function(x){return c.Guard.isSlot(x)}));v!==null;)m(v),v=u.tree_getNextDescendantNode(y,v,!0,!1,(function(x){return c.Guard.isSlot(x)}))},r.shadowTree_assignASlot=function(y){var v=p(y);v!==null&&m(v)}},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=/[a-z]([\0-\t\x2D\._a-z\xB7\xC0-\xD6\xD8-\xF6\xF8-\u037D\u037F-\u1FFF\u200C\u200D\u203F\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])*-([\0-\t\x2D\._a-z\xB7\xC0-\xD6\xD8-\xF6\xF8-\u037D\u037F-\u1FFF\u200C\u200D\u203F\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])*/,o=new Set(["annotation-xml","color-profile","font-face","font-face-src","font-face-uri","font-face-format","font-face-name","missing-glyph"]),s=new Set(["article","aside","blockquote","body","div","footer","h1","h2","h3","h4","h5","h6","header","main","nav","p","section","span"]),l=new Set(["area","base","basefont","bgsound","br","col","embed","frame","hr","img","input","keygen","link","menuitem","meta","param","source","track","wbr"]),c=new Set(["article","aside","blockquote","body","div","footer","h1","h2","h3","h4","h5","h6","header","main","nav","p","section","span"]);r.customElement_isValidCustomElementName=function(f){return!!a.test(f)&&!o.has(f)},r.customElement_isValidElementName=function(f){return s.has(f)},r.customElement_isVoidElementName=function(f){return l.has(f)},r.customElement_isValidShadowHostName=function(f){return c.has(f)},r.customElement_enqueueACustomElementUpgradeReaction=function(f,u){},r.customElement_enqueueACustomElementCallbackReaction=function(f,u,d){},r.customElement_upgrade=function(f,u){},r.customElement_tryToUpgrade=function(f){},r.customElement_lookUpACustomElementDefinition=function(f,u,d,h){return null}},function(n,r,i){i(4)({target:"String",proto:!0},{repeat:i(259)})},function(n,r,i){i(278),i(68),i(179),i(94),Object.defineProperty(r,"__esModule",{value:!0});var a=i(109),o=(function(){function s(l){this._builderOptions=l,l.parser&&Object.assign(this,l.parser)}return s.prototype._docType=function(l,c,f,u){return l.dtd({name:c,pubID:f,sysID:u})},s.prototype._comment=function(l,c){return l.com(c)},s.prototype._text=function(l,c){return l.txt(c)},s.prototype._instruction=function(l,c,f){return l.ins(c,f)},s.prototype._cdata=function(l,c){return l.dat(c)},s.prototype._element=function(l,c,f){return c===void 0?l.ele(f):l.ele(c,f)},s.prototype._attribute=function(l,c,f,u){return c===void 0?l.att(f,u):l.att(c,f,u)},s.prototype._sanitize=function(l){return a.sanitizeInput(l,this._builderOptions.invalidCharReplacement)},s.prototype._decodeText=function(l){return l==null?l:l.replace(/&(quot|amp|apos|lt|gt);/g,(function(c,f){return s._entityTable[f]})).replace(/&#(?:x([a-fA-F0-9]+)|([0-9]+));/g,(function(c,f,u){return String.fromCodePoint(parseInt(f||u,f?16:10))}))},s.prototype._decodeAttributeValue=function(l){return this._decodeText(l)},s.prototype.parse=function(l,c){return this._parse(l,c)},s.prototype.docType=function(l,c,f,u){return this._docType(l,c,f,u)},s.prototype.comment=function(l,c){return this._comment(l,c)},s.prototype.text=function(l,c){return this._text(l,c)},s.prototype.instruction=function(l,c,f){return this._instruction(l,c,f)},s.prototype.cdata=function(l,c){return this._cdata(l,c)},s.prototype.element=function(l,c,f){return this._element(l,c,f)},s.prototype.attribute=function(l,c,f,u){return this._attribute(l,c,f,u)},s.prototype.sanitize=function(l){return this._sanitize(l)},s._entityTable={lt:"<",gt:">",amp:"&",quot:'"',apos:"'"},s})();r.BaseReader=o},function(n,r,i){var a=i(39);n.exports=a.DEFAULT=new a({include:[i(54)],explicit:[i(299),i(300),i(301)]})},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(185);r.XMLBuilderImpl=a.XMLBuilderImpl;var o=i(304);r.XMLBuilderCBImpl=o.XMLBuilderCBImpl;var s=i(183);r.builder=s.builder,r.create=s.create,r.fragment=s.fragment,r.convert=s.convert;var l=i(309);r.createCB=l.createCB,r.fragmentCB=l.fragmentCB},function(n,r){var i;i=(function(){return this})();try{i=i||new Function("return this")()}catch{typeof window=="object"&&(i=window)}n.exports=i},function(n,r,i){var a={}.propertyIsEnumerable,o=Object.getOwnPropertyDescriptor,s=o&&!a.call({1:2},1);r.f=s?function(l){var c=o(this,l);return!!c&&c.enumerable}:a},function(n,r,i){var a=i(11),o=i(21);n.exports=function(s,l){try{o(a,s,l)}catch{a[s]=l}return l}},function(n,r,i){var a=i(44),o=i(118);(n.exports=function(s,l){return o[s]||(o[s]=l!==void 0?l:{})})("versions",[]).push({version:"3.6.5",mode:a?"pure":"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})},function(n,r,i){var a=i(121),o=i(84).concat("length","prototype");r.f=Object.getOwnPropertyNames||function(s){return a(s,o)}},function(n,r,i){var a=i(47),o=Math.max,s=Math.min;n.exports=function(l,c){var f=a(l);return f<0?o(f+c,0):s(f,c)}},function(n,r){n.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},function(n,r){r.f=Object.getOwnPropertySymbols},function(n,r,i){var a=i(8);n.exports=!!Object.getOwnPropertySymbols&&!a((function(){return!String(Symbol())}))},function(n,r,i){var a=i(127);n.exports=function(o,s,l){if(a(o),s===void 0)return o;switch(l){case 0:return function(){return o.call(s)};case 1:return function(c){return o.call(s,c)};case 2:return function(c,f){return o.call(s,c,f)};case 3:return function(c,f,u){return o.call(s,c,f,u)}}return function(){return o.apply(s,arguments)}}},function(n,r,i){var a=i(4),o=i(195),s=i(132),l=i(133),c=i(62),f=i(21),u=i(25),d=i(5),h=i(44),p=i(49),g=i(131),m=g.IteratorPrototype,y=g.BUGGY_SAFARI_ITERATORS,v=d("iterator"),x=function(){return this};n.exports=function(w,S,T,_,D,I,R){o(T,S,_);var O,P,N,A=function(J){if(J===D&&G)return G;if(!y&&J in $)return $[J];switch(J){case"keys":case"values":case"entries":return function(){return new T(this,J)}}return function(){return new T(this)}},B=S+" Iterator",V=!1,$=w.prototype,U=$[v]||$["@@iterator"]||D&&$[D],G=!y&&U||A(D),F=S=="Array"&&$.entries||U;if(F&&(O=s(F.call(new w)),m!==Object.prototype&&O.next&&(h||s(O)===m||(l?l(O,m):typeof O[v]!="function"&&f(O,v,x)),c(O,B,!0,!0),h&&(p[B]=x))),D=="values"&&U&&U.name!=="values"&&(V=!0,G=function(){return U.call(this)}),h&&!R||$[v]===G||f($,v,G),p[S]=G,D)if(P={values:A("values"),keys:I?G:A("keys"),entries:A("entries")},R)for(N in P)(y||V||!(N in $))&&u($,N,P[N]);else a({target:S,proto:!0,forced:y||V},P);return P}},function(n,r,i){var a=i(4),o=i(13),s=i(59),l=i(83),c=i(26),f=i(24),u=i(134),d=i(5),h=i(63),p=i(28),g=h("slice"),m=p("slice",{ACCESSORS:!0,0:0,1:2}),y=d("species"),v=[].slice,x=Math.max;a({target:"Array",proto:!0,forced:!g||!m},{slice:function(w,S){var T,_,D,I=f(this),R=c(I.length),O=l(w,R),P=l(S===void 0?R:S,R);if(s(I)&&(typeof(T=I.constructor)!="function"||T!==Array&&!s(T.prototype)?o(T)&&(T=T[y])===null&&(T=void 0):T=void 0,T===Array||T===void 0))return v.call(I,O,P);for(_=new(T===void 0?Array:T)(x(P-O,0)),D=0;O<P;O++,D++)O in I&&u(_,D,I[O]);return _.length=D,_}})},function(n,r,i){var a={};a[i(5)("toStringTag")]="z",n.exports=String(a)==="[object z]"},function(n,r,i){i(19),i(138),i(20),i(92),i(22),i(23),Object.defineProperty(r,"__esModule",{value:!0}),r.DefaultBuilderOptions={version:"1.0",encoding:void 0,standalone:void 0,keepNullNodes:!1,keepNullAttributes:!1,ignoreConverters:!1,convert:{att:"@",ins:"?",text:"#",cdata:"$",comment:"!"},defaultNamespace:{ele:void 0,att:void 0},namespaceAlias:{html:"http://www.w3.org/1999/xhtml",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",mathml:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink"},invalidCharReplacement:void 0,parser:void 0},r.XMLBuilderOptionKeys=new Set(Object.keys(r.DefaultBuilderOptions)),r.DefaultXMLBuilderCBOptions={format:"xml",wellFormed:!1,prettyPrint:!1,indent:"  ",newline:`
`,offset:0,width:0,allowEmptyTags:!1,spaceBeforeSlash:!1,keepNullNodes:!1,keepNullAttributes:!1,ignoreConverters:!1,convert:{att:"@",ins:"?",text:"#",cdata:"$",comment:"!"},defaultNamespace:{ele:void 0,att:void 0},namespaceAlias:{html:"http://www.w3.org/1999/xhtml",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",mathml:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink"}}},function(n,r,i){var a=i(139),o=i(143);n.exports=a("Set",(function(s){return function(){return s(this,arguments.length?arguments[0]:void 0)}}),o)},function(n,r,i){var a,o,s=i(136),l=i(221),c=RegExp.prototype.exec,f=String.prototype.replace,u=c,d=(a=/a/,o=/b*/g,c.call(a,"a"),c.call(o,"a"),a.lastIndex!==0||o.lastIndex!==0),h=l.UNSUPPORTED_Y||l.BROKEN_CARET,p=/()??/.exec("")[1]!==void 0;(d||p||h)&&(u=function(g){var m,y,v,x,w=this,S=h&&w.sticky,T=s.call(w),_=w.source,D=0,I=g;return S&&((T=T.replace("y","")).indexOf("g")===-1&&(T+="g"),I=String(g).slice(w.lastIndex),w.lastIndex>0&&(!w.multiline||w.multiline&&g[w.lastIndex-1]!==`
`)&&(_="(?: "+_+")",I=" "+I,D++),y=new RegExp("^(?:"+_+")",T)),p&&(y=new RegExp("^"+_+"$(?!\\s)",T)),d&&(m=w.lastIndex),v=c.call(S?y:w,I),S?v?(v.input=v.input.slice(D),v[0]=v[0].slice(D),v.index=w.lastIndex,w.lastIndex+=v[0].length):w.lastIndex=0:d&&v&&(w.lastIndex=w.global?v.index+v[0].length:m),p&&v&&v.length>1&&f.call(v[0],y,(function(){for(x=1;x<arguments.length-2;x++)arguments[x]===void 0&&(v[x]=void 0)})),v}),n.exports=u},function(n,r,i){var a=i(225),o=i(18),s=i(27),l=i(26),c=i(47),f=i(35),u=i(226),d=i(227),h=Math.max,p=Math.min,g=Math.floor,m=/\$([$&'`]|\d\d?|<[^>]*>)/g,y=/\$([$&'`]|\d\d?)/g;a("replace",2,(function(v,x,w,S){var T=S.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,_=S.REPLACE_KEEPS_$0,D=T?"$":"$0";return[function(R,O){var P=f(this),N=R?.[v];return N!==void 0?N.call(R,P,O):x.call(String(P),R,O)},function(R,O){if(!T&&_||typeof O=="string"&&O.indexOf(D)===-1){var P=w(x,R,this,O);if(P.done)return P.value}var N=o(R),A=String(this),B=typeof O=="function";B||(O=String(O));var V=N.global;if(V){var $=N.unicode;N.lastIndex=0}for(var U=[];;){var G=d(N,A);if(G===null||(U.push(G),!V))break;String(G[0])===""&&(N.lastIndex=u(A,l(N.lastIndex),$))}for(var F,J="",Q=0,ne=0;ne<U.length;ne++){G=U[ne];for(var ye=String(G[0]),ve=h(p(c(G.index),A.length),0),Ce=[],we=1;we<G.length;we++)Ce.push((F=G[we])===void 0?F:String(F));var Ae=G.groups;if(B){var Me=[ye].concat(Ce,ve,A);Ae!==void 0&&Me.push(Ae);var q=String(O.apply(void 0,Me))}else q=I(ye,A,ve,Ce,Ae,O);ve>=Q&&(J+=A.slice(Q,ve)+q,Q=ve+ye.length)}return J+A.slice(Q)}];function I(R,O,P,N,A,B){var V=P+R.length,$=N.length,U=y;return A!==void 0&&(A=s(A),U=m),x.call(B,U,(function(G,F){var J;switch(F.charAt(0)){case"$":return"$";case"&":return R;case"`":return O.slice(0,P);case"'":return O.slice(V);case"<":J=A[F.slice(1,-1)];break;default:var Q=+F;if(Q===0)return G;if(Q>$){var ne=g(Q/10);return ne===0?G:ne<=$?N[ne-1]===void 0?F.charAt(1):N[ne-1]+F.charAt(1):G}J=N[Q-1]}return J===void 0?"":J}))}}))},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=(function(){function o(){this._items={},this._nullItems=[]}return o.prototype.copy=function(){var s=new o;for(var l in this._items)s._items[l]=this._items[l].slice(0);return s._nullItems=this._nullItems.slice(0),s},o.prototype.get=function(s,l){var c=l===null?this._nullItems:this._items[l]||null;if(c===null)return null;for(var f=null,u=0;u<c.length;u++)if((f=c[u])===s)return f;return f},o.prototype.has=function(s,l){var c=l===null?this._nullItems:this._items[l]||null;return c!==null&&c.indexOf(s)!==-1},o.prototype.hasPrefix=function(s){if(this._nullItems.indexOf(s)!==-1)return!0;for(var l in this._items)if(this._items[l].indexOf(s)!==-1)return!0;return!1},o.prototype.set=function(s,l){var c=l===null?this._nullItems:this._items[l]||null;l!==null&&c===null?this._items[l]=[s]:c.push(s)},o})();r.NamespacePrefixMap=a},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.Surrogate=/[\uD800-\uDFFF]/,r.ScalarValue=/[\uD800-\uDFFF]/,r.NonCharacter=/[\uFDD0-\uFDEF\uFFFE\uFFFF]|[\uD83F\uD87F\uD8BF\uD8FF\uD93F\uD97F\uD9BF\uD9FF\uDA3F\uDA7F\uDABF\uDAFF\uDB3F\uDB7F\uDBBF\uDBFF][\uDFFE\uDFFF]/,r.ASCIICodePoint=/[\u0000-\u007F]/,r.ASCIITabOrNewLine=/[\t\n\r]/,r.ASCIIWhiteSpace=/[\t\n\f\r ]/,r.C0Control=/[\u0000-\u001F]/,r.C0ControlOrSpace=/[\u0000-\u001F ]/,r.Control=/[\u0000-\u001F\u007F-\u009F]/,r.ASCIIDigit=/[0-9]/,r.ASCIIUpperHexDigit=/[0-9A-F]/,r.ASCIILowerHexDigit=/[0-9a-f]/,r.ASCIIHexDigit=/[0-9A-Fa-f]/,r.ASCIIUpperAlpha=/[A-Z]/,r.ASCIILowerAlpha=/[a-z]/,r.ASCIIAlpha=/[A-Za-z]/,r.ASCIIAlphanumeric=/[0-9A-Za-z]/},function(n,r,i){var a=this&&this.__values||function(O){var P=typeof Symbol=="function"&&Symbol.iterator,N=P&&O[P],A=0;if(N)return N.call(O);if(O&&typeof O.length=="number")return{next:function(){return O&&A>=O.length&&(O=void 0),{value:O&&O[A++],done:!O}}};throw new TypeError(P?"Object is not iterable.":"Symbol.iterator is not defined.")},o=this&&this.__read||function(O,P){var N=typeof Symbol=="function"&&O[Symbol.iterator];if(!N)return O;var A,B,V=N.call(O),$=[];try{for(;(P===void 0||P-- >0)&&!(A=V.next()).done;)$.push(A.value)}catch(U){B={error:U}}finally{try{A&&!A.done&&(N=V.return)&&N.call(V)}finally{if(B)throw B.error}}return $},s=this&&this.__spread||function(){for(var O=[],P=0;P<arguments.length;P++)O=O.concat(o(arguments[P]));return O};Object.defineProperty(r,"__esModule",{value:!0});var l=i(6),c=i(2),f=i(3),u=i(171),d=i(104),h=i(9),p=i(17),g=i(72),m=i(30);function y(O,P){P===void 0&&(P=void 0),P===void 0&&(P=null);var N=v(O,P,new Date,{});return N._isTrusted=!0,N}function v(O,P,N,A){var B=new O("");return B._initializedFlag=!0,B._timeStamp=N.getTime(),Object.assign(B,A),l.dom.features.steps&&m.dom_runEventConstructingSteps(B),B}function x(O,P,N,A){var B,V,$,U;N===void 0&&(N=!1),A===void 0&&(A={value:!1});var G=!1;O._dispatchFlag=!0;var F=P;if(N){var J=P._associatedDocument;f.Guard.isDocumentNode(J)&&(F=J)}var Q=null,ne=p.tree_retarget(O._relatedTarget,P);if(P!==ne||P===O._relatedTarget){var ye=[];try{for(var ve=a(O._touchTargetList),Ce=ve.next();!Ce.done;Ce=ve.next()){var we=Ce.value;ye.push(p.tree_retarget(we,P))}}catch(Ne){B={error:Ne}}finally{try{Ce&&!Ce.done&&(V=ve.return)&&V.call(ve)}finally{if(B)throw B.error}}w(O,P,F,ne,ye,!1);var Ae=f.Guard.isMouseEvent(O)&&O._type==="click";Ae&&P._activationBehavior!==void 0&&(Q=P);for(var Me=f.Guard.isSlotable(P)&&g.shadowTree_isAssigned(P)?P:null,q=!1,k=P._getTheParent(O);k!==null&&f.Guard.isNode(k);){if(Me!==null){if(!f.Guard.isSlot(k))throw new Error("Parent node of a slotable should be a slot.");Me=null;var Y=p.tree_rootNode(k,!0);f.Guard.isShadowRoot(Y)&&Y._mode==="closed"&&(q=!0)}f.Guard.isSlotable(k)&&g.shadowTree_isAssigned(k)&&(Me=k),ne=p.tree_retarget(O._relatedTarget,k),ye=[];try{for(var X=($=void 0,a(O._touchTargetList)),re=X.next();!re.done;re=X.next())we=re.value,ye.push(p.tree_retarget(we,k))}catch(Ne){$={error:Ne}}finally{try{re&&!re.done&&(U=X.return)&&U.call(X)}finally{if($)throw $.error}}f.Guard.isWindow(k)||f.Guard.isNode(k)&&f.Guard.isNode(P)&&p.tree_isAncestorOf(p.tree_rootNode(P,!0),k,!0,!0)?(Ae&&O._bubbles&&Q===null&&k._activationBehavior&&(Q=k),w(O,k,null,ne,ye,q)):k===ne?k=null:(P=k,Ae&&Q===null&&P._activationBehavior&&(Q=P),w(O,k,P,ne,ye,q)),k!==null&&(k=k._getTheParent(O)),q=!1}for(var de=null,he=O._path,Ee=he.length-1;Ee>=0;Ee--)if((Pe=he[Ee]).shadowAdjustedTarget!==null){de=Pe;break}if(de!==null)if(f.Guard.isNode(de.shadowAdjustedTarget)&&f.Guard.isShadowRoot(p.tree_rootNode(de.shadowAdjustedTarget,!0)))G=!0;else if(f.Guard.isNode(de.relatedTarget)&&f.Guard.isShadowRoot(p.tree_rootNode(de.relatedTarget,!0)))G=!0;else for(var Oe=0;Oe<de.touchTargetList.length;Oe++){var Pe=de.touchTargetList[Oe];if(f.Guard.isNode(Pe)&&f.Guard.isShadowRoot(p.tree_rootNode(Pe,!0))){G=!0;break}}for(Q!==null&&Q._legacyPreActivationBehavior!==void 0&&Q._legacyPreActivationBehavior(O),Ee=he.length-1;Ee>=0;Ee--)(Pe=he[Ee]).shadowAdjustedTarget!==null?O._eventPhase=c.EventPhase.AtTarget:O._eventPhase=c.EventPhase.Capturing,S(Pe,O,"capturing",A);for(Ee=0;Ee<he.length;Ee++){if((Pe=he[Ee]).shadowAdjustedTarget!==null)O._eventPhase=c.EventPhase.AtTarget;else{if(!O._bubbles)continue;O._eventPhase=c.EventPhase.Bubbling}S(Pe,O,"bubbling",A)}}return O._eventPhase=c.EventPhase.None,O._currentTarget=null,O._path=[],O._dispatchFlag=!1,O._stopPropagationFlag=!1,O._stopImmediatePropagationFlag=!1,G&&(O._target=null,O._relatedTarget=null,O._touchTargetList=[]),Q!==null&&(O._canceledFlag||Q._activationBehavior===void 0?Q._legacyCanceledActivationBehavior!==void 0&&Q._legacyCanceledActivationBehavior(O):Q._activationBehavior(O)),!O._canceledFlag}function w(O,P,N,A,B,V){var $=!1;f.Guard.isNode(P)&&f.Guard.isShadowRoot(p.tree_rootNode(P))&&($=!0);var U=!1;f.Guard.isShadowRoot(P)&&P._mode==="closed"&&(U=!0),O._path.push({invocationTarget:P,invocationTargetInShadowTree:$,shadowAdjustedTarget:N,relatedTarget:A,touchTargetList:B,rootOfClosedTree:U,slotInClosedTree:V})}function S(O,P,N,A){A===void 0&&(A={value:!1});for(var B=P._path,V=-1,$=0;$<B.length;$++)if(B[$]===O){V=$;break}if(V!==-1){var U=B[V];(U.shadowAdjustedTarget!==null||V>0&&(U=B[V-1]).shadowAdjustedTarget!==null)&&(P._target=U.shadowAdjustedTarget)}if(P._relatedTarget=O.relatedTarget,P._touchTargetList=O.touchTargetList,!P._stopPropagationFlag){P._currentTarget=O.invocationTarget;var G=P._currentTarget._eventListenerList,F=new(Array.bind.apply(Array,s([void 0],G)));if(!T(P,F,N,O,A)&&P._isTrusted){var J=P._type;J==="animationend"?P._type="webkitAnimationEnd":J==="animationiteration"?P._type="webkitAnimationIteration":J==="animationstart"?P._type="webkitAnimationStart":J==="transitionend"&&(P._type="webkitTransitionEnd"),T(P,F,N,O,A),P._type=J}}}function T(O,P,N,A,B){B===void 0&&(B={value:!1});for(var V=!1,$=0;$<P.length;$++){var U=P[$];if(!U.removed){if(O._type!==U.type||(V=!0,N==="capturing"&&!U.capture)||N==="bubbling"&&U.capture)continue;if(U.once&&O._currentTarget!==null){for(var G=O._currentTarget,F=-1,J=0;J<G._eventListenerList.length;J++)if(G._eventListenerList[J]===U){F=J;break}F!==-1&&G._eventListenerList.splice(F,1)}var Q=void 0,ne=void 0;f.Guard.isWindow(Q)&&(ne=Q._currentEvent,A.invocationTargetInShadowTree===!1&&(Q._currentEvent=O)),U.passive&&(O._inPassiveListenerFlag=!0);try{U.callback.handleEvent.call(O._currentTarget,O)}catch{B.value=!0}if(U.passive&&(O._inPassiveListenerFlag=!1),f.Guard.isWindow(Q)&&(Q._currentEvent=ne),O._stopImmediatePropagationFlag)return V}}return V}function _(O,P){return null}function D(O,P){return null}function I(O,P){}function R(O,P){}r.event_setTheCanceledFlag=function(O){O._cancelable&&!O._inPassiveListenerFlag&&(O._canceledFlag=!0)},r.event_initialize=function(O,P,N,A){O._initializedFlag=!0,O._stopPropagationFlag=!1,O._stopImmediatePropagationFlag=!1,O._canceledFlag=!1,O._isTrusted=!1,O._target=null,O._type=P,O._bubbles=N,O._cancelable=A},r.event_createAnEvent=y,r.event_innerEventCreationSteps=v,r.event_dispatch=x,r.event_appendToAnEventPath=w,r.event_invoke=S,r.event_innerInvoke=T,r.event_fireAnEvent=function(O,P,N,A,B){N===void 0&&(N=d.EventImpl);var V=y(N);if(V._type=O,A)for(var $ in A)V[$]=A[$];return x(V,P,B)},r.event_createLegacyEvent=function(O){var P=null;switch(O.toLowerCase()){case"beforeunloadevent":case"compositionevent":break;case"customevent":P=u.CustomEventImpl;break;case"devicemotionevent":case"deviceorientationevent":case"dragevent":break;case"event":case"events":P=d.EventImpl}if(P===null)throw new h.NotSupportedError("Event constructor not found for interface "+O+".");var N=new P("");return N._type="",N._timeStamp=new Date().getTime(),N._isTrusted=!1,N._initializedFlag=!1,N},r.event_getterEventHandlerIDLAttribute=function(O,P){return null},r.event_setterEventHandlerIDLAttribute=function(O,P,N){},r.event_determineTheTargetOfAnEventHandler=_,r.event_getTheCurrentValueOfAnEventHandler=D,r.event_activateAnEventHandler=I,r.event_deactivateAnEventHandler=R},function(n,r,i){var a,o=this&&this.__extends||(a=function(w,S){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(T,_){T.__proto__=_}||function(T,_){for(var D in _)_.hasOwnProperty(D)&&(T[D]=_[D])})(w,S)},function(w,S){function T(){this.constructor=w}a(w,S),w.prototype=S===null?Object.create(S):(T.prototype=S.prototype,new T)}),s=this&&this.__values||function(w){var S=typeof Symbol=="function"&&Symbol.iterator,T=S&&w[S],_=0;if(T)return T.call(w);if(w&&typeof w.length=="number")return{next:function(){return w&&_>=w.length&&(w=void 0),{value:w&&w[_++],done:!w}}};throw new TypeError(S?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(w,S){var T=typeof Symbol=="function"&&w[Symbol.iterator];if(!T)return w;var _,D,I=T.call(w),R=[];try{for(;(S===void 0||S-- >0)&&!(_=I.next()).done;)R.push(_.value)}catch(O){D={error:O}}finally{try{_&&!_.done&&(T=I.return)&&T.call(I)}finally{if(D)throw D.error}}return R};Object.defineProperty(r,"__esModule",{value:!0});var c=i(6),f=i(2),u=i(9),d=i(34),h=i(3),p=i(1),g=i(7),m=i(152),y=i(0),v=i(12),x=(function(w){function S(){var T=w.call(this)||this;return T._children=new Set,T._encoding={name:"UTF-8",labels:["unicode-1-1-utf-8","utf-8","utf8"]},T._contentType="application/xml",T._URL={scheme:"about",username:"",password:"",host:null,port:null,path:["blank"],query:null,fragment:null,_cannotBeABaseURLFlag:!0,_blobURLEntry:null},T._origin=null,T._type="xml",T._mode="no-quirks",T._documentElement=null,T._hasNamespaces=!1,T._nodeDocumentOverwrite=null,T}return o(S,w),Object.defineProperty(S.prototype,"_nodeDocument",{get:function(){return this._nodeDocumentOverwrite||this},set:function(T){this._nodeDocumentOverwrite=T},enumerable:!0,configurable:!0}),Object.defineProperty(S.prototype,"implementation",{get:function(){return this._implementation||(this._implementation=y.create_domImplementation(this))},enumerable:!0,configurable:!0}),Object.defineProperty(S.prototype,"URL",{get:function(){return m.urlSerializer(this._URL)},enumerable:!0,configurable:!0}),Object.defineProperty(S.prototype,"documentURI",{get:function(){return this.URL},enumerable:!0,configurable:!0}),Object.defineProperty(S.prototype,"origin",{get:function(){return"null"},enumerable:!0,configurable:!0}),Object.defineProperty(S.prototype,"compatMode",{get:function(){return this._mode==="quirks"?"BackCompat":"CSS1Compat"},enumerable:!0,configurable:!0}),Object.defineProperty(S.prototype,"characterSet",{get:function(){return this._encoding.name},enumerable:!0,configurable:!0}),Object.defineProperty(S.prototype,"charset",{get:function(){return this._encoding.name},enumerable:!0,configurable:!0}),Object.defineProperty(S.prototype,"inputEncoding",{get:function(){return this._encoding.name},enumerable:!0,configurable:!0}),Object.defineProperty(S.prototype,"contentType",{get:function(){return this._contentType},enumerable:!0,configurable:!0}),Object.defineProperty(S.prototype,"doctype",{get:function(){var T,_;try{for(var D=s(this._children),I=D.next();!I.done;I=D.next()){var R=I.value;if(h.Guard.isDocumentTypeNode(R))return R}}catch(O){T={error:O}}finally{try{I&&!I.done&&(_=D.return)&&_.call(D)}finally{if(T)throw T.error}}return null},enumerable:!0,configurable:!0}),Object.defineProperty(S.prototype,"documentElement",{get:function(){return this._documentElement},enumerable:!0,configurable:!0}),S.prototype.getElementsByTagName=function(T){return y.node_listOfElementsWithQualifiedName(T,this)},S.prototype.getElementsByTagNameNS=function(T,_){return y.node_listOfElementsWithNamespace(T,_,this)},S.prototype.getElementsByClassName=function(T){return y.node_listOfElementsWithClassNames(T,this)},S.prototype.createElement=function(T,_){if(!y.xml_isName(T))throw new u.InvalidCharacterError;this._type==="html"&&(T=T.toLowerCase());var D=null;_!==void 0&&(D=p.isString(_)?_:_.is);var I=this._type==="html"||this._contentType==="application/xhtml+xml"?g.namespace.HTML:null;return y.element_createAnElement(this,T,I,null,D,!0)},S.prototype.createElementNS=function(T,_,D){return y.document_internalCreateElementNS(this,T,_,D)},S.prototype.createDocumentFragment=function(){return y.create_documentFragment(this)},S.prototype.createTextNode=function(T){return y.create_text(this,T)},S.prototype.createCDATASection=function(T){if(this._type==="html")throw new u.NotSupportedError;if(T.indexOf("]]>")!==-1)throw new u.InvalidCharacterError;return y.create_cdataSection(this,T)},S.prototype.createComment=function(T){return y.create_comment(this,T)},S.prototype.createProcessingInstruction=function(T,_){if(!y.xml_isName(T))throw new u.InvalidCharacterError;if(_.indexOf("?>")!==-1)throw new u.InvalidCharacterError;return y.create_processingInstruction(this,T,_)},S.prototype.importNode=function(T,_){if(_===void 0&&(_=!1),h.Guard.isDocumentNode(T)||h.Guard.isShadowRoot(T))throw new u.NotSupportedError;return y.node_clone(T,this,_)},S.prototype.adoptNode=function(T){if(h.Guard.isDocumentNode(T))throw new u.NotSupportedError;if(h.Guard.isShadowRoot(T))throw new u.HierarchyRequestError;return y.document_adopt(T,this),T},S.prototype.createAttribute=function(T){if(!y.xml_isName(T))throw new u.InvalidCharacterError;return this._type==="html"&&(T=T.toLowerCase()),y.create_attr(this,T)},S.prototype.createAttributeNS=function(T,_){var D=l(y.namespace_validateAndExtract(T,_),3),I=D[0],R=D[1],O=D[2],P=y.create_attr(this,O);return P._namespace=I,P._namespacePrefix=R,P},S.prototype.createEvent=function(T){return y.event_createLegacyEvent(T)},S.prototype.createRange=function(){var T=y.create_range();return T._start=[this,0],T._end=[this,0],T},S.prototype.createNodeIterator=function(T,_,D){_===void 0&&(_=f.WhatToShow.All),D===void 0&&(D=null);var I=y.create_nodeIterator(T,T,!0);return I._whatToShow=_,I._iteratorCollection=y.create_nodeList(T),p.isFunction(D)?(I._filter=y.create_nodeFilter(),I._filter.acceptNode=D):I._filter=D,I},S.prototype.createTreeWalker=function(T,_,D){_===void 0&&(_=f.WhatToShow.All),D===void 0&&(D=null);var I=y.create_treeWalker(T,T);return I._whatToShow=_,p.isFunction(D)?(I._filter=y.create_nodeFilter(),I._filter.acceptNode=D):I._filter=D,I},S.prototype._getTheParent=function(T){return T._type==="load"?null:c.dom.window},S.prototype.getElementById=function(T){throw new Error("Mixin: NonElementParentNode not implemented.")},Object.defineProperty(S.prototype,"children",{get:function(){throw new Error("Mixin: ParentNode not implemented.")},enumerable:!0,configurable:!0}),Object.defineProperty(S.prototype,"firstElementChild",{get:function(){throw new Error("Mixin: ParentNode not implemented.")},enumerable:!0,configurable:!0}),Object.defineProperty(S.prototype,"lastElementChild",{get:function(){throw new Error("Mixin: ParentNode not implemented.")},enumerable:!0,configurable:!0}),Object.defineProperty(S.prototype,"childElementCount",{get:function(){throw new Error("Mixin: ParentNode not implemented.")},enumerable:!0,configurable:!0}),S.prototype.prepend=function(){for(var T=[],_=0;_<arguments.length;_++)T[_]=arguments[_];throw new Error("Mixin: ParentNode not implemented.")},S.prototype.append=function(){for(var T=[],_=0;_<arguments.length;_++)T[_]=arguments[_];throw new Error("Mixin: ParentNode not implemented.")},S.prototype.querySelector=function(T){throw new Error("Mixin: ParentNode not implemented.")},S.prototype.querySelectorAll=function(T){throw new Error("Mixin: ParentNode not implemented.")},S})(d.NodeImpl);r.DocumentImpl=x,v.idl_defineConst(x.prototype,"_nodeType",f.NodeType.Document)},function(n,r,i){var a,o=this&&this.__extends||(a=function(m,y){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,x){v.__proto__=x}||function(v,x){for(var w in x)x.hasOwnProperty(w)&&(v[w]=x[w])})(m,y)},function(m,y){function v(){this.constructor=m}a(m,y),m.prototype=y===null?Object.create(y):(v.prototype=y.prototype,new v)}),s=this&&this.__values||function(m){var y=typeof Symbol=="function"&&Symbol.iterator,v=y&&m[y],x=0;if(v)return v.call(m);if(m&&typeof m.length=="number")return{next:function(){return m&&x>=m.length&&(m=void 0),{value:m&&m[x++],done:!m}}};throw new TypeError(y?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(m,y){var v=typeof Symbol=="function"&&m[Symbol.iterator];if(!v)return m;var x,w,S=v.call(m),T=[];try{for(;(y===void 0||y-- >0)&&!(x=S.next()).done;)T.push(x.value)}catch(_){w={error:_}}finally{try{x&&!x.done&&(v=S.return)&&v.call(S)}finally{if(w)throw w.error}}return T};Object.defineProperty(r,"__esModule",{value:!0});var c=i(2),f=i(34),u=i(9),d=i(7),h=i(0),p=i(12),g=(function(m){function y(){var v=m.call(this)||this;return v._children=new Set,v._namespace=null,v._namespacePrefix=null,v._localName="",v._customElementState="undefined",v._customElementDefinition=null,v._is=null,v._shadowRoot=null,v._attributeList=h.create_namedNodeMap(v),v._attributeChangeSteps=[],v._name="",v._assignedSlot=null,v}return o(y,m),Object.defineProperty(y.prototype,"namespaceURI",{get:function(){return this._namespace},enumerable:!0,configurable:!0}),Object.defineProperty(y.prototype,"prefix",{get:function(){return this._namespacePrefix},enumerable:!0,configurable:!0}),Object.defineProperty(y.prototype,"localName",{get:function(){return this._localName},enumerable:!0,configurable:!0}),Object.defineProperty(y.prototype,"tagName",{get:function(){return this._htmlUppercasedQualifiedName},enumerable:!0,configurable:!0}),Object.defineProperty(y.prototype,"id",{get:function(){return h.element_getAnAttributeValue(this,"id")},set:function(v){h.element_setAnAttributeValue(this,"id",v)},enumerable:!0,configurable:!0}),Object.defineProperty(y.prototype,"className",{get:function(){return h.element_getAnAttributeValue(this,"class")},set:function(v){h.element_setAnAttributeValue(this,"class",v)},enumerable:!0,configurable:!0}),Object.defineProperty(y.prototype,"classList",{get:function(){var v=h.element_getAnAttributeByName("class",this);return v===null&&(v=h.create_attr(this._nodeDocument,"class")),h.create_domTokenList(this,v)},enumerable:!0,configurable:!0}),Object.defineProperty(y.prototype,"slot",{get:function(){return h.element_getAnAttributeValue(this,"slot")},set:function(v){h.element_setAnAttributeValue(this,"slot",v)},enumerable:!0,configurable:!0}),y.prototype.hasAttributes=function(){return this._attributeList.length!==0},Object.defineProperty(y.prototype,"attributes",{get:function(){return this._attributeList},enumerable:!0,configurable:!0}),y.prototype.getAttributeNames=function(){var v,x,w=[];try{for(var S=s(this._attributeList),T=S.next();!T.done;T=S.next()){var _=T.value;w.push(_._qualifiedName)}}catch(D){v={error:D}}finally{try{T&&!T.done&&(x=S.return)&&x.call(S)}finally{if(v)throw v.error}}return w},y.prototype.getAttribute=function(v){var x=h.element_getAnAttributeByName(v,this);return x?x._value:null},y.prototype.getAttributeNS=function(v,x){var w=h.element_getAnAttributeByNamespaceAndLocalName(v,x,this);return w?w._value:null},y.prototype.setAttribute=function(v,x){if(!h.xml_isName(v))throw new u.InvalidCharacterError;this._namespace===d.namespace.HTML&&this._nodeDocument._type==="html"&&(v=v.toLowerCase());for(var w=null,S=0;S<this._attributeList.length;S++){var T=this._attributeList[S];if(T._qualifiedName===v){w=T;break}}if(w===null)return(w=h.create_attr(this._nodeDocument,v))._value=x,void h.element_append(w,this);h.element_change(w,this,x)},y.prototype.setAttributeNS=function(v,x,w){var S=l(h.namespace_validateAndExtract(v,x),3),T=S[0],_=S[1],D=S[2];h.element_setAnAttributeValue(this,D,w,_,T)},y.prototype.removeAttribute=function(v){h.element_removeAnAttributeByName(v,this)},y.prototype.removeAttributeNS=function(v,x){h.element_removeAnAttributeByNamespaceAndLocalName(v,x,this)},y.prototype.hasAttribute=function(v){this._namespace===d.namespace.HTML&&this._nodeDocument._type==="html"&&(v=v.toLowerCase());for(var x=0;x<this._attributeList.length;x++)if(this._attributeList[x]._qualifiedName===v)return!0;return!1},y.prototype.toggleAttribute=function(v,x){if(!h.xml_isName(v))throw new u.InvalidCharacterError;this._namespace===d.namespace.HTML&&this._nodeDocument._type==="html"&&(v=v.toLowerCase());for(var w=null,S=0;S<this._attributeList.length;S++){var T=this._attributeList[S];if(T._qualifiedName===v){w=T;break}}return w===null?(x===void 0||x===!0)&&((w=h.create_attr(this._nodeDocument,v))._value="",h.element_append(w,this),!0):x!==void 0&&x!==!1||(h.element_removeAnAttributeByName(v,this),!1)},y.prototype.hasAttributeNS=function(v,x){for(var w=v||null,S=0;S<this._attributeList.length;S++){var T=this._attributeList[S];if(T._namespace===w&&T._localName===x)return!0}return!1},y.prototype.getAttributeNode=function(v){return h.element_getAnAttributeByName(v,this)},y.prototype.getAttributeNodeNS=function(v,x){return h.element_getAnAttributeByNamespaceAndLocalName(v,x,this)},y.prototype.setAttributeNode=function(v){return h.element_setAnAttribute(v,this)},y.prototype.setAttributeNodeNS=function(v){return h.element_setAnAttribute(v,this)},y.prototype.removeAttributeNode=function(v){for(var x=!1,w=0;w<this._attributeList.length;w++)if(this._attributeList[w]===v){x=!0;break}if(!x)throw new u.NotFoundError;return h.element_remove(v,this),v},y.prototype.attachShadow=function(v){if(this._namespace!==d.namespace.HTML)throw new u.NotSupportedError;if(!h.customElement_isValidCustomElementName(this._localName)&&!h.customElement_isValidShadowHostName(this._localName))throw new u.NotSupportedError;if(h.customElement_isValidCustomElementName(this._localName)||this._is!==null){var x=h.customElement_lookUpACustomElementDefinition(this._nodeDocument,this._namespace,this._localName,this._is);if(x!==null&&x.disableShadow===!0)throw new u.NotSupportedError}if(this._shadowRoot!==null)throw new u.NotSupportedError;var w=h.create_shadowRoot(this._nodeDocument,this);return w._mode=v.mode,this._shadowRoot=w,w},Object.defineProperty(y.prototype,"shadowRoot",{get:function(){var v=this._shadowRoot;return v===null||v.mode==="closed"?null:v},enumerable:!0,configurable:!0}),y.prototype.closest=function(v){throw new u.NotImplementedError},y.prototype.matches=function(v){throw new u.NotImplementedError},y.prototype.webkitMatchesSelector=function(v){return this.matches(v)},y.prototype.getElementsByTagName=function(v){return h.node_listOfElementsWithQualifiedName(v,this)},y.prototype.getElementsByTagNameNS=function(v,x){return h.node_listOfElementsWithNamespace(v,x,this)},y.prototype.getElementsByClassName=function(v){return h.node_listOfElementsWithClassNames(v,this)},y.prototype.insertAdjacentElement=function(v,x){return h.element_insertAdjacent(this,v,x)},y.prototype.insertAdjacentText=function(v,x){var w=h.create_text(this._nodeDocument,x);h.element_insertAdjacent(this,v,w)},Object.defineProperty(y.prototype,"_qualifiedName",{get:function(){return this._namespacePrefix?this._namespacePrefix+":"+this._localName:this._localName},enumerable:!0,configurable:!0}),Object.defineProperty(y.prototype,"_htmlUppercasedQualifiedName",{get:function(){var v=this._qualifiedName;return this._namespace===d.namespace.HTML&&this._nodeDocument._type==="html"&&(v=v.toUpperCase()),v},enumerable:!0,configurable:!0}),Object.defineProperty(y.prototype,"children",{get:function(){throw new Error("Mixin: ParentNode not implemented.")},enumerable:!0,configurable:!0}),Object.defineProperty(y.prototype,"firstElementChild",{get:function(){throw new Error("Mixin: ParentNode not implemented.")},enumerable:!0,configurable:!0}),Object.defineProperty(y.prototype,"lastElementChild",{get:function(){throw new Error("Mixin: ParentNode not implemented.")},enumerable:!0,configurable:!0}),Object.defineProperty(y.prototype,"childElementCount",{get:function(){throw new Error("Mixin: ParentNode not implemented.")},enumerable:!0,configurable:!0}),y.prototype.prepend=function(){for(var v=[],x=0;x<arguments.length;x++)v[x]=arguments[x];throw new Error("Mixin: ParentNode not implemented.")},y.prototype.append=function(){for(var v=[],x=0;x<arguments.length;x++)v[x]=arguments[x];throw new Error("Mixin: ParentNode not implemented.")},y.prototype.querySelector=function(v){throw new Error("Mixin: ParentNode not implemented.")},y.prototype.querySelectorAll=function(v){throw new Error("Mixin: ParentNode not implemented.")},Object.defineProperty(y.prototype,"previousElementSibling",{get:function(){throw new Error("Mixin: NonDocumentTypeChildNode not implemented.")},enumerable:!0,configurable:!0}),Object.defineProperty(y.prototype,"nextElementSibling",{get:function(){throw new Error("Mixin: NonDocumentTypeChildNode not implemented.")},enumerable:!0,configurable:!0}),y.prototype.before=function(){for(var v=[],x=0;x<arguments.length;x++)v[x]=arguments[x];throw new Error("Mixin: ChildNode not implemented.")},y.prototype.after=function(){for(var v=[],x=0;x<arguments.length;x++)v[x]=arguments[x];throw new Error("Mixin: ChildNode not implemented.")},y.prototype.replaceWith=function(){for(var v=[],x=0;x<arguments.length;x++)v[x]=arguments[x];throw new Error("Mixin: ChildNode not implemented.")},y.prototype.remove=function(){throw new Error("Mixin: ChildNode not implemented.")},Object.defineProperty(y.prototype,"assignedSlot",{get:function(){throw new Error("Mixin: Slotable not implemented.")},enumerable:!0,configurable:!0}),y._create=function(v,x,w,S){w===void 0&&(w=null),S===void 0&&(S=null);var T=new y;return T._localName=x,T._namespace=w,T._namespacePrefix=S,T._nodeDocument=v,T},y})(f.NodeImpl);r.ElementImpl=g,p.idl_defineConst(g.prototype,"_nodeType",c.NodeType.Element)},function(n,r,i){var a,o=this&&this.__extends||(a=function(u,d){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,p){h.__proto__=p}||function(h,p){for(var g in p)p.hasOwnProperty(g)&&(h[g]=p[g])})(u,d)},function(u,d){function h(){this.constructor=u}a(u,d),u.prototype=d===null?Object.create(d):(h.prototype=d.prototype,new h)});Object.defineProperty(r,"__esModule",{value:!0});var s=i(2),l=i(34),c=i(12),f=(function(u){function d(h){h===void 0&&(h=null);var p=u.call(this)||this;return p._children=new Set,p._host=h,p}return o(d,u),d.prototype.getElementById=function(h){throw new Error("Mixin: NonElementParentNode not implemented.")},Object.defineProperty(d.prototype,"children",{get:function(){throw new Error("Mixin: ParentNode not implemented.")},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"firstElementChild",{get:function(){throw new Error("Mixin: ParentNode not implemented.")},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"lastElementChild",{get:function(){throw new Error("Mixin: ParentNode not implemented.")},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"childElementCount",{get:function(){throw new Error("Mixin: ParentNode not implemented.")},enumerable:!0,configurable:!0}),d.prototype.prepend=function(){for(var h=[],p=0;p<arguments.length;p++)h[p]=arguments[p];throw new Error("Mixin: ParentNode not implemented.")},d.prototype.append=function(){for(var h=[],p=0;p<arguments.length;p++)h[p]=arguments[p];throw new Error("Mixin: ParentNode not implemented.")},d.prototype.querySelector=function(h){throw new Error("Mixin: ParentNode not implemented.")},d.prototype.querySelectorAll=function(h){throw new Error("Mixin: ParentNode not implemented.")},d._create=function(h,p){p===void 0&&(p=null);var g=new d(p);return g._nodeDocument=h,g},d})(l.NodeImpl);r.DocumentFragmentImpl=f,c.idl_defineConst(f.prototype,"_nodeType",s.NodeType.DocumentFragment)},function(n,r,i){var a,o=this&&this.__extends||(a=function(h,p){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(g,m){g.__proto__=m}||function(g,m){for(var y in m)m.hasOwnProperty(y)&&(g[y]=m[y])})(h,p)},function(h,p){function g(){this.constructor=h}a(h,p),h.prototype=p===null?Object.create(p):(g.prototype=p.prototype,new g)}),s=this&&this.__values||function(h){var p=typeof Symbol=="function"&&Symbol.iterator,g=p&&h[p],m=0;if(g)return g.call(h);if(h&&typeof h.length=="number")return{next:function(){return h&&m>=h.length&&(h=void 0),{value:h&&h[m++],done:!h}}};throw new TypeError(p?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var l=i(2),c=i(71),f=i(0),u=i(12),d=(function(h){function p(g){g===void 0&&(g="");var m=h.call(this,g)||this;return m._name="",m._assignedSlot=null,m}return o(p,h),Object.defineProperty(p.prototype,"wholeText",{get:function(){var g,m,y="";try{for(var v=s(f.text_contiguousTextNodes(this,!0)),x=v.next();!x.done;x=v.next())y+=x.value._data}catch(w){g={error:w}}finally{try{x&&!x.done&&(m=v.return)&&m.call(v)}finally{if(g)throw g.error}}return y},enumerable:!0,configurable:!0}),p.prototype.splitText=function(g){return f.text_split(this,g)},Object.defineProperty(p.prototype,"assignedSlot",{get:function(){throw new Error("Mixin: Slotable not implemented.")},enumerable:!0,configurable:!0}),p._create=function(g,m){m===void 0&&(m="");var y=new p(m);return y._nodeDocument=g,y},p})(c.CharacterDataImpl);r.TextImpl=d,u.idl_defineConst(d.prototype,"_nodeType",l.NodeType.Text)},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=(function(){function o(){}return Object.defineProperty(o.prototype,"_startNode",{get:function(){return this._start[0]},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"_startOffset",{get:function(){return this._start[1]},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"_endNode",{get:function(){return this._end[0]},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"_endOffset",{get:function(){return this._end[1]},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"_collapsed",{get:function(){return this._start[0]===this._end[0]&&this._start[1]===this._end[1]},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"startContainer",{get:function(){return this._startNode},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"startOffset",{get:function(){return this._startOffset},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"endContainer",{get:function(){return this._endNode},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"endOffset",{get:function(){return this._endOffset},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"collapsed",{get:function(){return this._collapsed},enumerable:!0,configurable:!0}),o})();r.AbstractRangeImpl=a},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(2),o=(function(){function s(l){this._activeFlag=!1,this._root=l,this._whatToShow=a.WhatToShow.All,this._filter=null}return Object.defineProperty(s.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"whatToShow",{get:function(){return this._whatToShow},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"filter",{get:function(){return this._filter},enumerable:!0,configurable:!0}),s})();r.TraverserImpl=o},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(2),o=i(0),s=i(12),l=(function(){function c(f,u){this._target=null,this._relatedTarget=null,this._touchTargetList=[],this._path=[],this._currentTarget=null,this._eventPhase=a.EventPhase.None,this._stopPropagationFlag=!1,this._stopImmediatePropagationFlag=!1,this._canceledFlag=!1,this._inPassiveListenerFlag=!1,this._composedFlag=!1,this._initializedFlag=!1,this._dispatchFlag=!1,this._isTrusted=!1,this._bubbles=!1,this._cancelable=!1,this._type=f,u&&(this._bubbles=u.bubbles||!1,this._cancelable=u.cancelable||!1,this._composedFlag=u.composed||!1),this._initializedFlag=!0,this._timeStamp=new Date().getTime()}return Object.defineProperty(c.prototype,"type",{get:function(){return this._type},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"target",{get:function(){return this._target},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"srcElement",{get:function(){return this._target},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"currentTarget",{get:function(){return this._currentTarget},enumerable:!0,configurable:!0}),c.prototype.composedPath=function(){var f=[],u=this._path;if(u.length===0)return f;var d=this._currentTarget;if(d===null)throw new Error("Event currentTarget is null.");f.push(d);for(var h=0,p=0,g=u.length-1;g>=0;){if(u[g].rootOfClosedTree&&p++,u[g].invocationTarget===d){h=g;break}u[g].slotInClosedTree&&p--,g--}var m=p,y=p;for(g=h-1;g>=0;)u[g].rootOfClosedTree&&m++,m<=y&&f.unshift(u[g].invocationTarget),u[g].slotInClosedTree&&--m<y&&(y=m),g--;for(m=p,y=p,g=h+1;g<u.length;)u[g].slotInClosedTree&&m++,m<=y&&f.push(u[g].invocationTarget),u[g].rootOfClosedTree&&--m<y&&(y=m),g++;return f},Object.defineProperty(c.prototype,"eventPhase",{get:function(){return this._eventPhase},enumerable:!0,configurable:!0}),c.prototype.stopPropagation=function(){this._stopPropagationFlag=!0},Object.defineProperty(c.prototype,"cancelBubble",{get:function(){return this._stopPropagationFlag},set:function(f){f&&this.stopPropagation()},enumerable:!0,configurable:!0}),c.prototype.stopImmediatePropagation=function(){this._stopPropagationFlag=!0,this._stopImmediatePropagationFlag=!0},Object.defineProperty(c.prototype,"bubbles",{get:function(){return this._bubbles},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"cancelable",{get:function(){return this._cancelable},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"returnValue",{get:function(){return!this._canceledFlag},set:function(f){f||o.event_setTheCanceledFlag(this)},enumerable:!0,configurable:!0}),c.prototype.preventDefault=function(){o.event_setTheCanceledFlag(this)},Object.defineProperty(c.prototype,"defaultPrevented",{get:function(){return this._canceledFlag},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"composed",{get:function(){return this._composedFlag},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"isTrusted",{get:function(){return this._isTrusted},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"timeStamp",{get:function(){return this._timeStamp},enumerable:!0,configurable:!0}),c.prototype.initEvent=function(f,u,d){u===void 0&&(u=!1),d===void 0&&(d=!1),this._dispatchFlag||o.event_initialize(this,f,u,d)},c.NONE=0,c.CAPTURING_PHASE=1,c.AT_TARGET=2,c.BUBBLING_PHASE=3,c})();r.EventImpl=l,s.idl_defineConst(l.prototype,"NONE",0),s.idl_defineConst(l.prototype,"CAPTURING_PHASE",1),s.idl_defineConst(l.prototype,"AT_TARGET",2),s.idl_defineConst(l.prototype,"BUBBLING_PHASE",3)},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(2),o=i(9);r.traversal_filter=function(s,l){if(s._activeFlag)throw new o.InvalidStateError;var c=1<<l._nodeType-1;if((s.whatToShow&c)==0)return a.FilterResult.Skip;if(!s.filter)return a.FilterResult.Accept;s._activeFlag=!0;var f=a.FilterResult.Reject;try{f=s.filter.acceptNode(l)}catch(u){throw s._activeFlag=!1,u}return s._activeFlag=!1,f}},function(n,r,i){var a=this&&this.__read||function(y,v){var x=typeof Symbol=="function"&&y[Symbol.iterator];if(!x)return y;var w,S,T=x.call(y),_=[];try{for(;(v===void 0||v-- >0)&&!(w=T.next()).done;)_.push(w.value)}catch(D){S={error:D}}finally{try{w&&!w.done&&(x=T.return)&&x.call(T)}finally{if(S)throw S.error}}return _},o=this&&this.__values||function(y){var v=typeof Symbol=="function"&&Symbol.iterator,x=v&&y[v],w=0;if(x)return x.call(y);if(y&&typeof y.length=="number")return{next:function(){return y&&w>=y.length&&(y=void 0),{value:y&&y[w++],done:!y}}};throw new TypeError(v?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var s=i(6),l=i(3),c=i(1),f=i(99),u=i(73),d=i(17),h=i(173),p=i(30),g=i(52),m=i(37);r.document_elementInterface=function(y,v){return f.ElementImpl},r.document_internalCreateElementNS=function(y,v,x,w){var S=a(h.namespace_validateAndExtract(v,x),3),T=S[0],_=S[1],D=S[2],I=null;return w!==void 0&&(I=c.isString(w)?w:w.is),g.element_createAnElement(y,D,T,_,I,!0)},r.document_adopt=function(y,v){var x,w;if(y._nodeDocument!==v||y._parent!==null){var S=y._nodeDocument;if(y._parent&&m.mutation_remove(y,y._parent),v!==S)for(var T=d.tree_getFirstDescendantNode(y,!0,!0);T!==null;){if(T._nodeDocument=v,l.Guard.isElementNode(T))try{for(var _=(x=void 0,o(T._attributeList._asArray())),D=_.next();!D.done;D=_.next())D.value._nodeDocument=v}catch(I){x={error:I}}finally{try{D&&!D.done&&(w=_.return)&&w.call(_)}finally{if(x)throw x.error}}s.dom.features.customElements&&l.Guard.isElementNode(T)&&T._customElementState==="custom"&&u.customElement_enqueueACustomElementCallbackReaction(T,"adoptedCallback",[S,v]),s.dom.features.steps&&p.dom_runAdoptingSteps(T,S),T=d.tree_getNextDescendantNode(y,T,!0,!0)}}}},function(n,r,i){var a=this&&this.__values||function(d){var h=typeof Symbol=="function"&&Symbol.iterator,p=h&&d[h],g=0;if(p)return p.call(d);if(d&&typeof d.length=="number")return{next:function(){return d&&g>=d.length&&(d=void 0),{value:d&&d[g++],done:!d}}};throw new TypeError(h?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var o=i(6),s=i(3),l=i(9),c=i(17),f=i(51),u=i(30);r.characterData_replaceData=function(d,h,p,g){var m,y,v=c.tree_nodeLength(d);if(h>v)throw new l.IndexSizeError("Offset exceeds character data length. Offset: "+h+", Length: "+v+", Node is "+d.nodeName+".");h+p>v&&(p=v-h),o.dom.features.mutationObservers&&f.observer_queueMutationRecord("characterData",d,null,null,d._data,[],[],null,null);var x=d._data.substring(0,h)+g+d._data.substring(h+p);d._data=x;try{for(var w=a(o.dom.rangeList),S=w.next();!S.done;S=w.next()){var T=S.value;T._start[0]===d&&T._start[1]>h&&T._start[1]<=h+p&&(T._start[1]=h),T._end[0]===d&&T._end[1]>h&&T._end[1]<=h+p&&(T._end[1]=h),T._start[0]===d&&T._start[1]>h+p&&(T._start[1]+=g.length-p),T._end[0]===d&&T._end[1]>h+p&&(T._end[1]+=g.length-p)}}catch(_){m={error:_}}finally{try{S&&!S.done&&(y=w.return)&&y.call(w)}finally{if(m)throw m.error}}o.dom.features.steps&&s.Guard.isTextNode(d)&&d._parent!==null&&u.dom_runChildTextContentChangeSteps(d._parent)},r.characterData_substringData=function(d,h,p){var g=c.tree_nodeLength(d);if(h>g)throw new l.IndexSizeError("Offset exceeds character data length. Offset: "+h+", Length: "+g+", Node is "+d.nodeName+".");return h+p>g?d._data.substr(h):d._data.substr(h,p)}},function(n,r,i){var a=this&&this.__read||function(u,d){var h=typeof Symbol=="function"&&u[Symbol.iterator];if(!h)return u;var p,g,m=h.call(u),y=[];try{for(;(d===void 0||d-- >0)&&!(p=m.next()).done;)y.push(p.value)}catch(v){g={error:v}}finally{try{p&&!p.done&&(h=m.return)&&h.call(m)}finally{if(g)throw g.error}}return y},o=this&&this.__spread||function(){for(var u=[],d=0;d<arguments.length;d++)u=u.concat(a(arguments[d]));return u},s=this&&this.__values||function(u){var d=typeof Symbol=="function"&&Symbol.iterator,h=d&&u[d],p=0;if(h)return h.call(u);if(u&&typeof u.length=="number")return{next:function(){return u&&p>=u.length&&(u=void 0),{value:u&&u[p++],done:!u}}};throw new TypeError(d?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var l=i(7);function c(u){var d=l.string.splitAStringOnASCIIWhitespace(u);return new Set(d)}function f(u){return o(u).join(" ")}r.orderedSet_parse=c,r.orderedSet_serialize=f,r.orderedSet_sanitize=function(u){return f(c(u))},r.orderedSet_contains=function(u,d,h){var p,g,m,y;try{for(var v=s(d),x=v.next();!x.done;x=v.next()){var w=x.value,S=!1;try{for(var T=(m=void 0,s(u)),_=T.next();!_.done;_=T.next()){var D=_.value;if(h){if(D===w){S=!0;break}}else if(D.toUpperCase()===w.toUpperCase()){S=!0;break}}}catch(I){m={error:I}}finally{try{_&&!_.done&&(y=T.return)&&y.call(T)}finally{if(m)throw m.error}}if(!S)return!1}}catch(I){p={error:I}}finally{try{x&&!x.done&&(g=v.return)&&g.call(v)}finally{if(p)throw p.error}}return!0}},function(n,r,i){i(179),Object.defineProperty(r,"__esModule",{value:!0});var a=i(262),o=i(110),s=i(1);o.dom.setFeatures(!1),r.createDocument=function(){var l=new a.DOMImplementation().createDocument(null,"root",null);return l.documentElement&&l.removeChild(l.documentElement),l},r.sanitizeInput=function(l,c){if(l==null)return l;if(c===void 0)return l+"";var f="";l+="";for(var u=0;u<l.length;u++){var d=l.charCodeAt(u);if(d===9||d===10||d===13||d>=32&&d<=55295||d>=57344&&d<=65533)f+=l.charAt(u);else if(d>=55296&&d<=56319&&u<l.length-1){var h=l.charCodeAt(u+1);h>=56320&&h<=57343?(d=1024*(d-55296)+h-56320+65536,f+=String.fromCodePoint(d),u++):f+=s.isString(c)?c:c(l.charAt(u),u,l)}else f+=s.isString(c)?c:c(l.charAt(u),u,l)}return f}},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(1),o=i(153);r.AbortController=o.AbortControllerImpl;var s=i(154);r.AbortSignal=s.AbortSignalImpl;var l=i(102);r.AbstractRange=l.AbstractRangeImpl;var c=i(157);r.Attr=c.AttrImpl;var f=i(158);r.CDATASection=f.CDATASectionImpl;var u=i(71);r.CharacterData=u.CharacterDataImpl;var d=i(263),h=i(159);r.Comment=h.CommentImpl;var p=i(171);r.CustomEvent=p.CustomEventImpl;var g=i(100);r.DocumentFragment=g.DocumentFragmentImpl;var m=i(98);r.Document=m.DocumentImpl;var y=i(264),v=i(155);r.DocumentType=v.DocumentTypeImpl;var x=i(6);r.dom=x.dom;var w=i(148);r.DOMImplementation=w.DOMImplementationImpl;var S=i(170);r.DOMTokenList=S.DOMTokenListImpl;var T=i(99);r.Element=T.ElementImpl;var _=i(104);r.Event=_.EventImpl;var D=i(70);r.EventTarget=D.EventTargetImpl;var I=i(161);r.HTMLCollection=I.HTMLCollectionImpl;var R=i(265);r.MutationObserver=R.MutationObserverImpl;var O=i(169);r.MutationRecord=O.MutationRecordImpl;var P=i(164);r.NamedNodeMap=P.NamedNodeMapImpl;var N=i(168);r.NodeFilter=N.NodeFilterImpl;var A=i(34);r.Node=A.NodeImpl;var B=i(166);r.NodeIterator=B.NodeIteratorImpl;var V=i(162);r.NodeList=V.NodeListImpl;var $=i(163);r.NodeListStatic=$.NodeListStaticImpl;var U=i(266),G=i(267),F=i(268),J=i(160);r.ProcessingInstruction=J.ProcessingInstructionImpl;var Q=i(165);r.Range=Q.RangeImpl;var ne=i(156);r.ShadowRoot=ne.ShadowRootImpl;var ye=i(269),ve=i(270);r.StaticRange=ve.StaticRangeImpl;var Ce=i(101);r.Text=Ce.TextImpl;var we=i(103);r.Traverser=we.TraverserImpl;var Ae=i(167);r.TreeWalker=Ae.TreeWalkerImpl;var Me=i(149);r.Window=Me.WindowImpl;var q=i(151);r.XMLDocument=q.XMLDocumentImpl,a.applyMixin(T.ElementImpl,d.ChildNodeImpl),a.applyMixin(u.CharacterDataImpl,d.ChildNodeImpl),a.applyMixin(v.DocumentTypeImpl,d.ChildNodeImpl),a.applyMixin(m.DocumentImpl,y.DocumentOrShadowRootImpl),a.applyMixin(ne.ShadowRootImpl,y.DocumentOrShadowRootImpl),a.applyMixin(T.ElementImpl,U.NonDocumentTypeChildNodeImpl),a.applyMixin(u.CharacterDataImpl,U.NonDocumentTypeChildNodeImpl),a.applyMixin(m.DocumentImpl,G.NonElementParentNodeImpl),a.applyMixin(g.DocumentFragmentImpl,G.NonElementParentNodeImpl),a.applyMixin(m.DocumentImpl,F.ParentNodeImpl),a.applyMixin(g.DocumentFragmentImpl,F.ParentNodeImpl),a.applyMixin(T.ElementImpl,F.ParentNodeImpl),a.applyMixin(Ce.TextImpl,ye.SlotableImpl),a.applyMixin(T.ElementImpl,ye.SlotableImpl)},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),(function(a){a[a.EOF=0]="EOF",a[a.Declaration=1]="Declaration",a[a.DocType=2]="DocType",a[a.Element=3]="Element",a[a.Text=4]="Text",a[a.CDATA=5]="CDATA",a[a.PI=6]="PI",a[a.Comment=7]="Comment",a[a.ClosingTag=8]="ClosingTag"})(r.TokenType||(r.TokenType={}))},function(n,r,i){i(64),i(20),i(66);var a,o=this&&this.__extends||(a=function(c,f){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,d){u.__proto__=d}||function(u,d){for(var h in d)d.hasOwnProperty(h)&&(u[h]=d[h])})(c,f)},function(c,f){function u(){this.constructor=c}a(c,f),c.prototype=f===null?Object.create(f):(u.prototype=f.prototype,new u)});Object.defineProperty(r,"__esModule",{value:!0});var s=i(1),l=(function(c){function f(){return c!==null&&c.apply(this,arguments)||this}return o(f,c),f.prototype._parse=function(u,d){var h=this,p=this._builderOptions,g=null;return s.isFunction(d)?g=this.parse(u,d.apply(this)):s.isArray(d)||s.isSet(d)?s.forEachArray(d,(function(m){return g=h.parse(u,m)}),this):s.isMap(d)||s.isObject(d)?s.forEachObject(d,(function(m,y){if(s.isFunction(y)&&(y=y.apply(h)),p.ignoreConverters||m.indexOf(p.convert.att)!==0)if(p.ignoreConverters||m.indexOf(p.convert.text)!==0)if(p.ignoreConverters||m.indexOf(p.convert.cdata)!==0)if(p.ignoreConverters||m.indexOf(p.convert.comment)!==0)if(p.ignoreConverters||m.indexOf(p.convert.ins)!==0){if(!((s.isArray(y)||s.isSet(y))&&s.isEmpty(y))){if((s.isMap(y)||s.isObject(y))&&s.isEmpty(y))g=h.element(u,void 0,h.sanitize(m))||g;else if(p.keepNullNodes||y!=null)if(s.isArray(y)||s.isSet(y))s.forEachArray(y,(function(T){var _={};_[m]=T,g=h.parse(u,_)}),h);else if(s.isMap(y)||s.isObject(y))(v=h.element(u,void 0,h.sanitize(m)))&&(g=v,h.parse(v,y));else if(y!=null&&y!==""){var v;(v=h.element(u,void 0,h.sanitize(m)))&&(g=v,h.text(v,h._decodeText(h.sanitize(y))))}else g=h.element(u,void 0,h.sanitize(m))||g}}else if(s.isString(y)){var x=y.indexOf(" "),w=x===-1?y:y.substr(0,x),S=x===-1?"":y.substr(x+1);g=h.instruction(u,h.sanitize(w),h.sanitize(S))||g}else s.isArray(y)||s.isSet(y)?s.forEachArray(y,(function(T){var _=T.indexOf(" "),D=_===-1?T:T.substr(0,_),I=_===-1?"":T.substr(_+1);g=h.instruction(u,h.sanitize(D),h.sanitize(I))||g}),h):s.forEachObject(y,(function(T,_){return g=h.instruction(u,h.sanitize(T),h.sanitize(_))||g}),h);else s.isArray(y)||s.isSet(y)?s.forEachArray(y,(function(T){return g=h.comment(u,h.sanitize(T))||g}),h):g=h.comment(u,h.sanitize(y))||g;else s.isArray(y)||s.isSet(y)?s.forEachArray(y,(function(T){return g=h.cdata(u,h.sanitize(T))||g}),h):g=h.cdata(u,h.sanitize(y))||g;else g=s.isMap(y)||s.isObject(y)?h.parse(u,y):h.text(u,h._decodeText(h.sanitize(y)))||g;else if(m===p.convert.att){if(s.isArray(y)||s.isSet(y))throw new Error("Invalid attribute: "+y.toString()+". "+u._debugInfo());s.forEachObject(y,(function(T,_){g=h.attribute(u,void 0,h.sanitize(T),h._decodeAttributeValue(h.sanitize(_)))||g}))}else g=h.attribute(u,void 0,h.sanitize(m.substr(p.convert.att.length)),h._decodeAttributeValue(h.sanitize(y)))||g}),this):(p.keepNullNodes||d!=null)&&(g=this.text(u,this._decodeText(this.sanitize(d)))||g),g||u},f})(i(75).BaseReader);r.ObjectReader=l},function(n,r,i){var a=i(39);n.exports=new a({explicit:[i(286),i(287),i(288)]})},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=function(o){this.level=0,this._builderOptions=o,this._writerOptions=o};r.BaseCBWriter=a},function(n,r,i){var a=i(16),o=i(8),s=i(116);n.exports=!a&&!o((function(){return Object.defineProperty(s("div"),"a",{get:function(){return 7}}).a!=7}))},function(n,r,i){var a=i(11),o=i(13),s=a.document,l=o(s)&&o(s.createElement);n.exports=function(c){return l?s.createElement(c):{}}},function(n,r,i){var a=i(118),o=Function.toString;typeof a.inspectSource!="function"&&(a.inspectSource=function(s){return o.call(s)}),n.exports=a.inspectSource},function(n,r,i){var a=i(11),o=i(80),s=a["__core-js_shared__"]||o("__core-js_shared__",{});n.exports=s},function(n,r,i){var a=i(14),o=i(187),s=i(55),l=i(15);n.exports=function(c,f){for(var u=o(f),d=l.f,h=s.f,p=0;p<u.length;p++){var g=u[p];a(c,g)||d(c,g,h(f,g))}}},function(n,r,i){var a=i(11);n.exports=a},function(n,r,i){var a=i(14),o=i(24),s=i(122).indexOf,l=i(45);n.exports=function(c,f){var u,d=o(c),h=0,p=[];for(u in d)!a(l,u)&&a(d,u)&&p.push(u);for(;f.length>h;)a(d,u=f[h++])&&(~s(p,u)||p.push(u));return p}},function(n,r,i){var a=i(24),o=i(26),s=i(83),l=function(c){return function(f,u,d){var h,p=a(f),g=o(p.length),m=s(d,g);if(c&&u!=u){for(;g>m;)if((h=p[m++])!=h)return!0}else for(;g>m;m++)if((c||m in p)&&p[m]===u)return c||m||0;return!c&&-1}};n.exports={includes:l(!0),indexOf:l(!1)}},function(n,r,i){var a=i(8),o=/#|\.prototype\./,s=function(d,h){var p=c[l(d)];return p==u||p!=f&&(typeof h=="function"?a(h):!!h)},l=s.normalize=function(d){return String(d).replace(o,".").toLowerCase()},c=s.data={},f=s.NATIVE="N",u=s.POLYFILL="P";n.exports=s},function(n,r,i){var a=i(86);n.exports=a&&!Symbol.sham&&typeof Symbol.iterator=="symbol"},function(n,r,i){var a=i(5);r.f=a},function(n,r,i){var a=i(120),o=i(14),s=i(125),l=i(15).f;n.exports=function(c){var f=a.Symbol||(a.Symbol={});o(f,c)||l(f,c,{value:s.f(c)})}},function(n,r){n.exports=function(i){if(typeof i!="function")throw TypeError(String(i)+" is not a function");return i}},function(n,r,i){var a=i(13),o=i(59),s=i(5)("species");n.exports=function(l,c){var f;return o(l)&&(typeof(f=l.constructor)!="function"||f!==Array&&!o(f.prototype)?a(f)&&(f=f[s])===null&&(f=void 0):f=void 0),new(f===void 0?Array:f)(c===0?0:c)}},function(n,r,i){var a,o,s=i(11),l=i(193),c=s.process,f=c&&c.versions,u=f&&f.v8;u?o=(a=u.split("."))[0]+a[1]:l&&(!(a=l.match(/Edge\/(\d+)/))||a[1]>=74)&&(a=l.match(/Chrome\/(\d+)/))&&(o=a[1]),n.exports=o&&+o},function(n,r,i){var a=i(5),o=i(60),s=i(15),l=a("unscopables"),c=Array.prototype;c[l]==null&&s.f(c,l,{configurable:!0,value:o(null)}),n.exports=function(f){c[l][f]=!0}},function(n,r,i){var a,o,s,l=i(132),c=i(21),f=i(14),u=i(5),d=i(44),h=u("iterator"),p=!1;[].keys&&("next"in(s=[].keys())?(o=l(l(s)))!==Object.prototype&&(a=o):p=!0),a==null&&(a={}),d||f(a,h)||c(a,h,(function(){return this})),n.exports={IteratorPrototype:a,BUGGY_SAFARI_ITERATORS:p}},function(n,r,i){var a=i(14),o=i(27),s=i(57),l=i(196),c=s("IE_PROTO"),f=Object.prototype;n.exports=l?Object.getPrototypeOf:function(u){return u=o(u),a(u,c)?u[c]:typeof u.constructor=="function"&&u instanceof u.constructor?u.constructor.prototype:u instanceof Object?f:null}},function(n,r,i){var a=i(18),o=i(197);n.exports=Object.setPrototypeOf||("__proto__"in{}?(function(){var s,l=!1,c={};try{(s=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(c,[]),l=c instanceof Array}catch{}return function(f,u){return a(f),o(u),l?s.call(f,u):f.__proto__=u,f}})():void 0)},function(n,r,i){var a=i(56),o=i(15),s=i(40);n.exports=function(l,c,f){var u=a(c);u in l?o.f(l,u,s(0,f)):l[u]=f}},function(n,r,i){var a=i(90),o=i(42),s=i(5)("toStringTag"),l=o((function(){return arguments})())=="Arguments";n.exports=a?o:function(c){var f,u,d;return c===void 0?"Undefined":c===null?"Null":typeof(u=(function(h,p){try{return h[p]}catch{}})(f=Object(c),s))=="string"?u:l?o(f):(d=o(f))=="Object"&&typeof f.callee=="function"?"Arguments":d}},function(n,r,i){var a=i(18);n.exports=function(){var o=a(this),s="";return o.global&&(s+="g"),o.ignoreCase&&(s+="i"),o.multiline&&(s+="m"),o.dotAll&&(s+="s"),o.unicode&&(s+="u"),o.sticky&&(s+="y"),s}},function(n,r,i){var a=i(47),o=i(35),s=function(l){return function(c,f){var u,d,h=String(o(c)),p=a(f),g=h.length;return p<0||p>=g?l?"":void 0:(u=h.charCodeAt(p))<55296||u>56319||p+1===g||(d=h.charCodeAt(p+1))<56320||d>57343?l?h.charAt(p):u:l?h.slice(p,p+2):d-56320+(u-55296<<10)+65536}};n.exports={codeAt:s(!1),charAt:s(!0)}},function(n,r,i){var a=i(4),o=i(27),s=i(61);a({target:"Object",stat:!0,forced:i(8)((function(){s(1)}))},{keys:function(l){return s(o(l))}})},function(n,r,i){var a=i(4),o=i(11),s=i(123),l=i(25),c=i(140),f=i(141),u=i(142),d=i(13),h=i(8),p=i(208),g=i(62),m=i(209);n.exports=function(y,v,x){var w=y.indexOf("Map")!==-1,S=y.indexOf("Weak")!==-1,T=w?"set":"add",_=o[y],D=_&&_.prototype,I=_,R={},O=function($){var U=D[$];l(D,$,$=="add"?function(G){return U.call(this,G===0?0:G),this}:$=="delete"?function(G){return!(S&&!d(G))&&U.call(this,G===0?0:G)}:$=="get"?function(G){return S&&!d(G)?void 0:U.call(this,G===0?0:G)}:$=="has"?function(G){return!(S&&!d(G))&&U.call(this,G===0?0:G)}:function(G,F){return U.call(this,G===0?0:G,F),this})};if(s(y,typeof _!="function"||!(S||D.forEach&&!h((function(){new _().entries().next()})))))I=x.getConstructor(v,y,w,T),c.REQUIRED=!0;else if(s(y,!0)){var P=new I,N=P[T](S?{}:-0,1)!=P,A=h((function(){P.has(1)})),B=p((function($){new _($)})),V=!S&&h((function(){for(var $=new _,U=5;U--;)$[T](U,U);return!$.has(-0)}));B||((I=v((function($,U){u($,I,y);var G=m(new _,$,I);return U!=null&&f(U,G[T],G,w),G}))).prototype=D,D.constructor=I),(A||V)&&(O("delete"),O("has"),w&&O("get")),(V||N)&&O(T),S&&D.clear&&delete D.clear}return R[y]=I,a({global:!0,forced:I!=_},R),g(I,y),S||x.setStrong(I,y,w),I}},function(n,r,i){var a=i(45),o=i(13),s=i(14),l=i(15).f,c=i(58),f=i(204),u=c("meta"),d=0,h=Object.isExtensible||function(){return!0},p=function(m){l(m,u,{value:{objectID:"O"+ ++d,weakData:{}}})},g=n.exports={REQUIRED:!1,fastKey:function(m,y){if(!o(m))return typeof m=="symbol"?m:(typeof m=="string"?"S":"P")+m;if(!s(m,u)){if(!h(m))return"F";if(!y)return"E";p(m)}return m[u].objectID},getWeakData:function(m,y){if(!s(m,u)){if(!h(m))return!0;if(!y)return!1;p(m)}return m[u].weakData},onFreeze:function(m){return f&&g.REQUIRED&&h(m)&&!s(m,u)&&p(m),m}};a[u]=!0},function(n,r,i){var a=i(18),o=i(205),s=i(26),l=i(87),c=i(206),f=i(207),u=function(d,h){this.stopped=d,this.result=h};(n.exports=function(d,h,p,g,m){var y,v,x,w,S,T,_,D=l(h,p,g?2:1);if(m)y=d;else{if(typeof(v=c(d))!="function")throw TypeError("Target is not iterable");if(o(v)){for(x=0,w=s(d.length);w>x;x++)if((S=g?D(a(_=d[x])[0],_[1]):D(d[x]))&&S instanceof u)return S;return new u(!1)}y=v.call(d)}for(T=y.next;!(_=T.call(y)).done;)if(typeof(S=f(y,D,_.value,g))=="object"&&S&&S instanceof u)return S;return new u(!1)}).stop=function(d){return new u(!0,d)}},function(n,r){n.exports=function(i,a,o){if(!(i instanceof a))throw TypeError("Incorrect "+(o?o+" ":"")+"invocation");return i}},function(n,r,i){var a=i(15).f,o=i(60),s=i(210),l=i(87),c=i(142),f=i(141),u=i(88),d=i(211),h=i(16),p=i(140).fastKey,g=i(43),m=g.set,y=g.getterFor;n.exports={getConstructor:function(v,x,w,S){var T=v((function(R,O){c(R,T,x),m(R,{type:x,index:o(null),first:void 0,last:void 0,size:0}),h||(R.size=0),O!=null&&f(O,R[S],R,w)})),_=y(x),D=function(R,O,P){var N,A,B=_(R),V=I(R,O);return V?V.value=P:(B.last=V={index:A=p(O,!0),key:O,value:P,previous:N=B.last,next:void 0,removed:!1},B.first||(B.first=V),N&&(N.next=V),h?B.size++:R.size++,A!=="F"&&(B.index[A]=V)),R},I=function(R,O){var P,N=_(R),A=p(O);if(A!=="F")return N.index[A];for(P=N.first;P;P=P.next)if(P.key==O)return P};return s(T.prototype,{clear:function(){for(var R=_(this),O=R.index,P=R.first;P;)P.removed=!0,P.previous&&(P.previous=P.previous.next=void 0),delete O[P.index],P=P.next;R.first=R.last=void 0,h?R.size=0:this.size=0},delete:function(R){var O=_(this),P=I(this,R);if(P){var N=P.next,A=P.previous;delete O.index[P.index],P.removed=!0,A&&(A.next=N),N&&(N.previous=A),O.first==P&&(O.first=N),O.last==P&&(O.last=A),h?O.size--:this.size--}return!!P},forEach:function(R){for(var O,P=_(this),N=l(R,arguments.length>1?arguments[1]:void 0,3);O=O?O.next:P.first;)for(N(O.value,O.key,this);O&&O.removed;)O=O.previous},has:function(R){return!!I(this,R)}}),s(T.prototype,w?{get:function(R){var O=I(this,R);return O&&O.value},set:function(R,O){return D(this,R===0?0:R,O)}}:{add:function(R){return D(this,R=R===0?0:R,R)}}),h&&a(T.prototype,"size",{get:function(){return _(this).size}}),T},setStrong:function(v,x,w){var S=x+" Iterator",T=y(x),_=y(S);u(v,x,(function(D,I){m(this,{type:S,target:D,state:T(D),kind:I,last:void 0})}),(function(){for(var D=_(this),I=D.kind,R=D.last;R&&R.removed;)R=R.previous;return D.target&&(D.last=R=R?R.next:D.state.first)?I=="keys"?{value:R.key,done:!1}:I=="values"?{value:R.value,done:!1}:{value:[R.key,R.value],done:!1}:(D.target=void 0,{value:void 0,done:!0})}),w?"entries":"values",!w,!0),d(x)}}},function(n,r,i){var a,o=i(4),s=i(55).f,l=i(26),c=i(222),f=i(35),u=i(224),d=i(44),h="".endsWith,p=Math.min,g=u("endsWith");o({target:"String",proto:!0,forced:!!(d||g||(a=s(String.prototype,"endsWith"),!a||a.writable))&&!g},{endsWith:function(m){var y=String(f(this));c(m);var v=arguments.length>1?arguments[1]:void 0,x=l(y.length),w=v===void 0?x:p(l(v),x),S=String(m);return h?h.call(y,S,w):y.slice(w-S.length,w)===S}})},function(n,r,i){(function(a){/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <http://feross.org>
 * @license  MIT
 */var o=i(229),s=i(230),l=i(231);function c(){return u.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function f(q,k){if(c()<k)throw new RangeError("Invalid typed array length");return u.TYPED_ARRAY_SUPPORT?(q=new Uint8Array(k)).__proto__=u.prototype:(q===null&&(q=new u(k)),q.length=k),q}function u(q,k,Y){if(!(u.TYPED_ARRAY_SUPPORT||this instanceof u))return new u(q,k,Y);if(typeof q=="number"){if(typeof k=="string")throw new Error("If encoding is specified then the first argument must be a string");return p(this,q)}return d(this,q,k,Y)}function d(q,k,Y,X){if(typeof k=="number")throw new TypeError('"value" argument must not be a number');return typeof ArrayBuffer<"u"&&k instanceof ArrayBuffer?(function(re,de,he,Ee){if(de.byteLength,he<0||de.byteLength<he)throw new RangeError("'offset' is out of bounds");if(de.byteLength<he+(Ee||0))throw new RangeError("'length' is out of bounds");return de=he===void 0&&Ee===void 0?new Uint8Array(de):Ee===void 0?new Uint8Array(de,he):new Uint8Array(de,he,Ee),u.TYPED_ARRAY_SUPPORT?(re=de).__proto__=u.prototype:re=g(re,de),re})(q,k,Y,X):typeof k=="string"?(function(re,de,he){if(typeof he=="string"&&he!==""||(he="utf8"),!u.isEncoding(he))throw new TypeError('"encoding" must be a valid string encoding');var Ee=0|y(de,he),Oe=(re=f(re,Ee)).write(de,he);return Oe!==Ee&&(re=re.slice(0,Oe)),re})(q,k,Y):(function(re,de){if(u.isBuffer(de)){var he=0|m(de.length);return(re=f(re,he)).length===0||de.copy(re,0,0,he),re}if(de){if(typeof ArrayBuffer<"u"&&de.buffer instanceof ArrayBuffer||"length"in de)return typeof de.length!="number"||(Ee=de.length)!=Ee?f(re,0):g(re,de);if(de.type==="Buffer"&&l(de.data))return g(re,de.data)}var Ee;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")})(q,k)}function h(q){if(typeof q!="number")throw new TypeError('"size" argument must be a number');if(q<0)throw new RangeError('"size" argument must not be negative')}function p(q,k){if(h(k),q=f(q,k<0?0:0|m(k)),!u.TYPED_ARRAY_SUPPORT)for(var Y=0;Y<k;++Y)q[Y]=0;return q}function g(q,k){var Y=k.length<0?0:0|m(k.length);q=f(q,Y);for(var X=0;X<Y;X+=1)q[X]=255&k[X];return q}function m(q){if(q>=c())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+c().toString(16)+" bytes");return 0|q}function y(q,k){if(u.isBuffer(q))return q.length;if(typeof ArrayBuffer<"u"&&typeof ArrayBuffer.isView=="function"&&(ArrayBuffer.isView(q)||q instanceof ArrayBuffer))return q.byteLength;typeof q!="string"&&(q=""+q);var Y=q.length;if(Y===0)return 0;for(var X=!1;;)switch(k){case"ascii":case"latin1":case"binary":return Y;case"utf8":case"utf-8":case void 0:return we(q).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*Y;case"hex":return Y>>>1;case"base64":return Ae(q).length;default:if(X)return we(q).length;k=(""+k).toLowerCase(),X=!0}}function v(q,k,Y){var X=!1;if((k===void 0||k<0)&&(k=0),k>this.length||((Y===void 0||Y>this.length)&&(Y=this.length),Y<=0)||(Y>>>=0)<=(k>>>=0))return"";for(q||(q="utf8");;)switch(q){case"hex":return V(this,k,Y);case"utf8":case"utf-8":return N(this,k,Y);case"ascii":return A(this,k,Y);case"latin1":case"binary":return B(this,k,Y);case"base64":return P(this,k,Y);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return $(this,k,Y);default:if(X)throw new TypeError("Unknown encoding: "+q);q=(q+"").toLowerCase(),X=!0}}function x(q,k,Y){var X=q[k];q[k]=q[Y],q[Y]=X}function w(q,k,Y,X,re){if(q.length===0)return-1;if(typeof Y=="string"?(X=Y,Y=0):Y>2147483647?Y=2147483647:Y<-2147483648&&(Y=-2147483648),Y=+Y,isNaN(Y)&&(Y=re?0:q.length-1),Y<0&&(Y=q.length+Y),Y>=q.length){if(re)return-1;Y=q.length-1}else if(Y<0){if(!re)return-1;Y=0}if(typeof k=="string"&&(k=u.from(k,X)),u.isBuffer(k))return k.length===0?-1:S(q,k,Y,X,re);if(typeof k=="number")return k&=255,u.TYPED_ARRAY_SUPPORT&&typeof Uint8Array.prototype.indexOf=="function"?re?Uint8Array.prototype.indexOf.call(q,k,Y):Uint8Array.prototype.lastIndexOf.call(q,k,Y):S(q,[k],Y,X,re);throw new TypeError("val must be string, number or Buffer")}function S(q,k,Y,X,re){var de,he=1,Ee=q.length,Oe=k.length;if(X!==void 0&&((X=String(X).toLowerCase())==="ucs2"||X==="ucs-2"||X==="utf16le"||X==="utf-16le")){if(q.length<2||k.length<2)return-1;he=2,Ee/=2,Oe/=2,Y/=2}function Pe(Te,me){return he===1?Te[me]:Te.readUInt16BE(me*he)}if(re){var Ne=-1;for(de=Y;de<Ee;de++)if(Pe(q,de)===Pe(k,Ne===-1?0:de-Ne)){if(Ne===-1&&(Ne=de),de-Ne+1===Oe)return Ne*he}else Ne!==-1&&(de-=de-Ne),Ne=-1}else for(Y+Oe>Ee&&(Y=Ee-Oe),de=Y;de>=0;de--){for(var ie=!0,ae=0;ae<Oe;ae++)if(Pe(q,de+ae)!==Pe(k,ae)){ie=!1;break}if(ie)return de}return-1}function T(q,k,Y,X){Y=Number(Y)||0;var re=q.length-Y;X?(X=Number(X))>re&&(X=re):X=re;var de=k.length;if(de%2!=0)throw new TypeError("Invalid hex string");X>de/2&&(X=de/2);for(var he=0;he<X;++he){var Ee=parseInt(k.substr(2*he,2),16);if(isNaN(Ee))return he;q[Y+he]=Ee}return he}function _(q,k,Y,X){return Me(we(k,q.length-Y),q,Y,X)}function D(q,k,Y,X){return Me((function(re){for(var de=[],he=0;he<re.length;++he)de.push(255&re.charCodeAt(he));return de})(k),q,Y,X)}function I(q,k,Y,X){return D(q,k,Y,X)}function R(q,k,Y,X){return Me(Ae(k),q,Y,X)}function O(q,k,Y,X){return Me((function(re,de){for(var he,Ee,Oe,Pe=[],Ne=0;Ne<re.length&&!((de-=2)<0);++Ne)he=re.charCodeAt(Ne),Ee=he>>8,Oe=he%256,Pe.push(Oe),Pe.push(Ee);return Pe})(k,q.length-Y),q,Y,X)}function P(q,k,Y){return k===0&&Y===q.length?o.fromByteArray(q):o.fromByteArray(q.slice(k,Y))}function N(q,k,Y){Y=Math.min(q.length,Y);for(var X=[],re=k;re<Y;){var de,he,Ee,Oe,Pe=q[re],Ne=null,ie=Pe>239?4:Pe>223?3:Pe>191?2:1;if(re+ie<=Y)switch(ie){case 1:Pe<128&&(Ne=Pe);break;case 2:(192&(de=q[re+1]))==128&&(Oe=(31&Pe)<<6|63&de)>127&&(Ne=Oe);break;case 3:de=q[re+1],he=q[re+2],(192&de)==128&&(192&he)==128&&(Oe=(15&Pe)<<12|(63&de)<<6|63&he)>2047&&(Oe<55296||Oe>57343)&&(Ne=Oe);break;case 4:de=q[re+1],he=q[re+2],Ee=q[re+3],(192&de)==128&&(192&he)==128&&(192&Ee)==128&&(Oe=(15&Pe)<<18|(63&de)<<12|(63&he)<<6|63&Ee)>65535&&Oe<1114112&&(Ne=Oe)}Ne===null?(Ne=65533,ie=1):Ne>65535&&(Ne-=65536,X.push(Ne>>>10&1023|55296),Ne=56320|1023&Ne),X.push(Ne),re+=ie}return(function(ae){var Te=ae.length;if(Te<=4096)return String.fromCharCode.apply(String,ae);for(var me="",Se=0;Se<Te;)me+=String.fromCharCode.apply(String,ae.slice(Se,Se+=4096));return me})(X)}r.Buffer=u,r.SlowBuffer=function(q){return+q!=q&&(q=0),u.alloc(+q)},r.INSPECT_MAX_BYTES=50,u.TYPED_ARRAY_SUPPORT=a.TYPED_ARRAY_SUPPORT!==void 0?a.TYPED_ARRAY_SUPPORT:(function(){try{var q=new Uint8Array(1);return q.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},q.foo()===42&&typeof q.subarray=="function"&&q.subarray(1,1).byteLength===0}catch{return!1}})(),r.kMaxLength=c(),u.poolSize=8192,u._augment=function(q){return q.__proto__=u.prototype,q},u.from=function(q,k,Y){return d(null,q,k,Y)},u.TYPED_ARRAY_SUPPORT&&(u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,typeof Symbol<"u"&&Symbol.species&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0})),u.alloc=function(q,k,Y){return(function(X,re,de,he){return h(re),re<=0?f(X,re):de!==void 0?typeof he=="string"?f(X,re).fill(de,he):f(X,re).fill(de):f(X,re)})(null,q,k,Y)},u.allocUnsafe=function(q){return p(null,q)},u.allocUnsafeSlow=function(q){return p(null,q)},u.isBuffer=function(q){return!(q==null||!q._isBuffer)},u.compare=function(q,k){if(!u.isBuffer(q)||!u.isBuffer(k))throw new TypeError("Arguments must be Buffers");if(q===k)return 0;for(var Y=q.length,X=k.length,re=0,de=Math.min(Y,X);re<de;++re)if(q[re]!==k[re]){Y=q[re],X=k[re];break}return Y<X?-1:X<Y?1:0},u.isEncoding=function(q){switch(String(q).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(q,k){if(!l(q))throw new TypeError('"list" argument must be an Array of Buffers');if(q.length===0)return u.alloc(0);var Y;if(k===void 0)for(k=0,Y=0;Y<q.length;++Y)k+=q[Y].length;var X=u.allocUnsafe(k),re=0;for(Y=0;Y<q.length;++Y){var de=q[Y];if(!u.isBuffer(de))throw new TypeError('"list" argument must be an Array of Buffers');de.copy(X,re),re+=de.length}return X},u.byteLength=y,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var q=this.length;if(q%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var k=0;k<q;k+=2)x(this,k,k+1);return this},u.prototype.swap32=function(){var q=this.length;if(q%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var k=0;k<q;k+=4)x(this,k,k+3),x(this,k+1,k+2);return this},u.prototype.swap64=function(){var q=this.length;if(q%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var k=0;k<q;k+=8)x(this,k,k+7),x(this,k+1,k+6),x(this,k+2,k+5),x(this,k+3,k+4);return this},u.prototype.toString=function(){var q=0|this.length;return q===0?"":arguments.length===0?N(this,0,q):v.apply(this,arguments)},u.prototype.equals=function(q){if(!u.isBuffer(q))throw new TypeError("Argument must be a Buffer");return this===q||u.compare(this,q)===0},u.prototype.inspect=function(){var q="",k=r.INSPECT_MAX_BYTES;return this.length>0&&(q=this.toString("hex",0,k).match(/.{2}/g).join(" "),this.length>k&&(q+=" ... ")),"<Buffer "+q+">"},u.prototype.compare=function(q,k,Y,X,re){if(!u.isBuffer(q))throw new TypeError("Argument must be a Buffer");if(k===void 0&&(k=0),Y===void 0&&(Y=q?q.length:0),X===void 0&&(X=0),re===void 0&&(re=this.length),k<0||Y>q.length||X<0||re>this.length)throw new RangeError("out of range index");if(X>=re&&k>=Y)return 0;if(X>=re)return-1;if(k>=Y)return 1;if(this===q)return 0;for(var de=(re>>>=0)-(X>>>=0),he=(Y>>>=0)-(k>>>=0),Ee=Math.min(de,he),Oe=this.slice(X,re),Pe=q.slice(k,Y),Ne=0;Ne<Ee;++Ne)if(Oe[Ne]!==Pe[Ne]){de=Oe[Ne],he=Pe[Ne];break}return de<he?-1:he<de?1:0},u.prototype.includes=function(q,k,Y){return this.indexOf(q,k,Y)!==-1},u.prototype.indexOf=function(q,k,Y){return w(this,q,k,Y,!0)},u.prototype.lastIndexOf=function(q,k,Y){return w(this,q,k,Y,!1)},u.prototype.write=function(q,k,Y,X){if(k===void 0)X="utf8",Y=this.length,k=0;else if(Y===void 0&&typeof k=="string")X=k,Y=this.length,k=0;else{if(!isFinite(k))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");k|=0,isFinite(Y)?(Y|=0,X===void 0&&(X="utf8")):(X=Y,Y=void 0)}var re=this.length-k;if((Y===void 0||Y>re)&&(Y=re),q.length>0&&(Y<0||k<0)||k>this.length)throw new RangeError("Attempt to write outside buffer bounds");X||(X="utf8");for(var de=!1;;)switch(X){case"hex":return T(this,q,k,Y);case"utf8":case"utf-8":return _(this,q,k,Y);case"ascii":return D(this,q,k,Y);case"latin1":case"binary":return I(this,q,k,Y);case"base64":return R(this,q,k,Y);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O(this,q,k,Y);default:if(de)throw new TypeError("Unknown encoding: "+X);X=(""+X).toLowerCase(),de=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function A(q,k,Y){var X="";Y=Math.min(q.length,Y);for(var re=k;re<Y;++re)X+=String.fromCharCode(127&q[re]);return X}function B(q,k,Y){var X="";Y=Math.min(q.length,Y);for(var re=k;re<Y;++re)X+=String.fromCharCode(q[re]);return X}function V(q,k,Y){var X=q.length;(!k||k<0)&&(k=0),(!Y||Y<0||Y>X)&&(Y=X);for(var re="",de=k;de<Y;++de)re+=Ce(q[de]);return re}function $(q,k,Y){for(var X=q.slice(k,Y),re="",de=0;de<X.length;de+=2)re+=String.fromCharCode(X[de]+256*X[de+1]);return re}function U(q,k,Y){if(q%1!=0||q<0)throw new RangeError("offset is not uint");if(q+k>Y)throw new RangeError("Trying to access beyond buffer length")}function G(q,k,Y,X,re,de){if(!u.isBuffer(q))throw new TypeError('"buffer" argument must be a Buffer instance');if(k>re||k<de)throw new RangeError('"value" argument is out of bounds');if(Y+X>q.length)throw new RangeError("Index out of range")}function F(q,k,Y,X){k<0&&(k=65535+k+1);for(var re=0,de=Math.min(q.length-Y,2);re<de;++re)q[Y+re]=(k&255<<8*(X?re:1-re))>>>8*(X?re:1-re)}function J(q,k,Y,X){k<0&&(k=4294967295+k+1);for(var re=0,de=Math.min(q.length-Y,4);re<de;++re)q[Y+re]=k>>>8*(X?re:3-re)&255}function Q(q,k,Y,X,re,de){if(Y+X>q.length)throw new RangeError("Index out of range");if(Y<0)throw new RangeError("Index out of range")}function ne(q,k,Y,X,re){return re||Q(q,0,Y,4),s.write(q,k,Y,X,23,4),Y+4}function ye(q,k,Y,X,re){return re||Q(q,0,Y,8),s.write(q,k,Y,X,52,8),Y+8}u.prototype.slice=function(q,k){var Y,X=this.length;if((q=~~q)<0?(q+=X)<0&&(q=0):q>X&&(q=X),(k=k===void 0?X:~~k)<0?(k+=X)<0&&(k=0):k>X&&(k=X),k<q&&(k=q),u.TYPED_ARRAY_SUPPORT)(Y=this.subarray(q,k)).__proto__=u.prototype;else{var re=k-q;Y=new u(re,void 0);for(var de=0;de<re;++de)Y[de]=this[de+q]}return Y},u.prototype.readUIntLE=function(q,k,Y){q|=0,k|=0,Y||U(q,k,this.length);for(var X=this[q],re=1,de=0;++de<k&&(re*=256);)X+=this[q+de]*re;return X},u.prototype.readUIntBE=function(q,k,Y){q|=0,k|=0,Y||U(q,k,this.length);for(var X=this[q+--k],re=1;k>0&&(re*=256);)X+=this[q+--k]*re;return X},u.prototype.readUInt8=function(q,k){return k||U(q,1,this.length),this[q]},u.prototype.readUInt16LE=function(q,k){return k||U(q,2,this.length),this[q]|this[q+1]<<8},u.prototype.readUInt16BE=function(q,k){return k||U(q,2,this.length),this[q]<<8|this[q+1]},u.prototype.readUInt32LE=function(q,k){return k||U(q,4,this.length),(this[q]|this[q+1]<<8|this[q+2]<<16)+16777216*this[q+3]},u.prototype.readUInt32BE=function(q,k){return k||U(q,4,this.length),16777216*this[q]+(this[q+1]<<16|this[q+2]<<8|this[q+3])},u.prototype.readIntLE=function(q,k,Y){q|=0,k|=0,Y||U(q,k,this.length);for(var X=this[q],re=1,de=0;++de<k&&(re*=256);)X+=this[q+de]*re;return X>=(re*=128)&&(X-=Math.pow(2,8*k)),X},u.prototype.readIntBE=function(q,k,Y){q|=0,k|=0,Y||U(q,k,this.length);for(var X=k,re=1,de=this[q+--X];X>0&&(re*=256);)de+=this[q+--X]*re;return de>=(re*=128)&&(de-=Math.pow(2,8*k)),de},u.prototype.readInt8=function(q,k){return k||U(q,1,this.length),128&this[q]?-1*(255-this[q]+1):this[q]},u.prototype.readInt16LE=function(q,k){k||U(q,2,this.length);var Y=this[q]|this[q+1]<<8;return 32768&Y?4294901760|Y:Y},u.prototype.readInt16BE=function(q,k){k||U(q,2,this.length);var Y=this[q+1]|this[q]<<8;return 32768&Y?4294901760|Y:Y},u.prototype.readInt32LE=function(q,k){return k||U(q,4,this.length),this[q]|this[q+1]<<8|this[q+2]<<16|this[q+3]<<24},u.prototype.readInt32BE=function(q,k){return k||U(q,4,this.length),this[q]<<24|this[q+1]<<16|this[q+2]<<8|this[q+3]},u.prototype.readFloatLE=function(q,k){return k||U(q,4,this.length),s.read(this,q,!0,23,4)},u.prototype.readFloatBE=function(q,k){return k||U(q,4,this.length),s.read(this,q,!1,23,4)},u.prototype.readDoubleLE=function(q,k){return k||U(q,8,this.length),s.read(this,q,!0,52,8)},u.prototype.readDoubleBE=function(q,k){return k||U(q,8,this.length),s.read(this,q,!1,52,8)},u.prototype.writeUIntLE=function(q,k,Y,X){q=+q,k|=0,Y|=0,X||G(this,q,k,Y,Math.pow(2,8*Y)-1,0);var re=1,de=0;for(this[k]=255&q;++de<Y&&(re*=256);)this[k+de]=q/re&255;return k+Y},u.prototype.writeUIntBE=function(q,k,Y,X){q=+q,k|=0,Y|=0,X||G(this,q,k,Y,Math.pow(2,8*Y)-1,0);var re=Y-1,de=1;for(this[k+re]=255&q;--re>=0&&(de*=256);)this[k+re]=q/de&255;return k+Y},u.prototype.writeUInt8=function(q,k,Y){return q=+q,k|=0,Y||G(this,q,k,1,255,0),u.TYPED_ARRAY_SUPPORT||(q=Math.floor(q)),this[k]=255&q,k+1},u.prototype.writeUInt16LE=function(q,k,Y){return q=+q,k|=0,Y||G(this,q,k,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[k]=255&q,this[k+1]=q>>>8):F(this,q,k,!0),k+2},u.prototype.writeUInt16BE=function(q,k,Y){return q=+q,k|=0,Y||G(this,q,k,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[k]=q>>>8,this[k+1]=255&q):F(this,q,k,!1),k+2},u.prototype.writeUInt32LE=function(q,k,Y){return q=+q,k|=0,Y||G(this,q,k,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[k+3]=q>>>24,this[k+2]=q>>>16,this[k+1]=q>>>8,this[k]=255&q):J(this,q,k,!0),k+4},u.prototype.writeUInt32BE=function(q,k,Y){return q=+q,k|=0,Y||G(this,q,k,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[k]=q>>>24,this[k+1]=q>>>16,this[k+2]=q>>>8,this[k+3]=255&q):J(this,q,k,!1),k+4},u.prototype.writeIntLE=function(q,k,Y,X){if(q=+q,k|=0,!X){var re=Math.pow(2,8*Y-1);G(this,q,k,Y,re-1,-re)}var de=0,he=1,Ee=0;for(this[k]=255&q;++de<Y&&(he*=256);)q<0&&Ee===0&&this[k+de-1]!==0&&(Ee=1),this[k+de]=(q/he>>0)-Ee&255;return k+Y},u.prototype.writeIntBE=function(q,k,Y,X){if(q=+q,k|=0,!X){var re=Math.pow(2,8*Y-1);G(this,q,k,Y,re-1,-re)}var de=Y-1,he=1,Ee=0;for(this[k+de]=255&q;--de>=0&&(he*=256);)q<0&&Ee===0&&this[k+de+1]!==0&&(Ee=1),this[k+de]=(q/he>>0)-Ee&255;return k+Y},u.prototype.writeInt8=function(q,k,Y){return q=+q,k|=0,Y||G(this,q,k,1,127,-128),u.TYPED_ARRAY_SUPPORT||(q=Math.floor(q)),q<0&&(q=255+q+1),this[k]=255&q,k+1},u.prototype.writeInt16LE=function(q,k,Y){return q=+q,k|=0,Y||G(this,q,k,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[k]=255&q,this[k+1]=q>>>8):F(this,q,k,!0),k+2},u.prototype.writeInt16BE=function(q,k,Y){return q=+q,k|=0,Y||G(this,q,k,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[k]=q>>>8,this[k+1]=255&q):F(this,q,k,!1),k+2},u.prototype.writeInt32LE=function(q,k,Y){return q=+q,k|=0,Y||G(this,q,k,4,2147483647,-2147483648),u.TYPED_ARRAY_SUPPORT?(this[k]=255&q,this[k+1]=q>>>8,this[k+2]=q>>>16,this[k+3]=q>>>24):J(this,q,k,!0),k+4},u.prototype.writeInt32BE=function(q,k,Y){return q=+q,k|=0,Y||G(this,q,k,4,2147483647,-2147483648),q<0&&(q=4294967295+q+1),u.TYPED_ARRAY_SUPPORT?(this[k]=q>>>24,this[k+1]=q>>>16,this[k+2]=q>>>8,this[k+3]=255&q):J(this,q,k,!1),k+4},u.prototype.writeFloatLE=function(q,k,Y){return ne(this,q,k,!0,Y)},u.prototype.writeFloatBE=function(q,k,Y){return ne(this,q,k,!1,Y)},u.prototype.writeDoubleLE=function(q,k,Y){return ye(this,q,k,!0,Y)},u.prototype.writeDoubleBE=function(q,k,Y){return ye(this,q,k,!1,Y)},u.prototype.copy=function(q,k,Y,X){if(Y||(Y=0),X||X===0||(X=this.length),k>=q.length&&(k=q.length),k||(k=0),X>0&&X<Y&&(X=Y),X===Y||q.length===0||this.length===0)return 0;if(k<0)throw new RangeError("targetStart out of bounds");if(Y<0||Y>=this.length)throw new RangeError("sourceStart out of bounds");if(X<0)throw new RangeError("sourceEnd out of bounds");X>this.length&&(X=this.length),q.length-k<X-Y&&(X=q.length-k+Y);var re,de=X-Y;if(this===q&&Y<k&&k<X)for(re=de-1;re>=0;--re)q[re+k]=this[re+Y];else if(de<1e3||!u.TYPED_ARRAY_SUPPORT)for(re=0;re<de;++re)q[re+k]=this[re+Y];else Uint8Array.prototype.set.call(q,this.subarray(Y,Y+de),k);return de},u.prototype.fill=function(q,k,Y,X){if(typeof q=="string"){if(typeof k=="string"?(X=k,k=0,Y=this.length):typeof Y=="string"&&(X=Y,Y=this.length),q.length===1){var re=q.charCodeAt(0);re<256&&(q=re)}if(X!==void 0&&typeof X!="string")throw new TypeError("encoding must be a string");if(typeof X=="string"&&!u.isEncoding(X))throw new TypeError("Unknown encoding: "+X)}else typeof q=="number"&&(q&=255);if(k<0||this.length<k||this.length<Y)throw new RangeError("Out of range index");if(Y<=k)return this;var de;if(k>>>=0,Y=Y===void 0?this.length:Y>>>0,q||(q=0),typeof q=="number")for(de=k;de<Y;++de)this[de]=q;else{var he=u.isBuffer(q)?q:we(new u(q,X).toString()),Ee=he.length;for(de=0;de<Y-k;++de)this[de+k]=he[de%Ee]}return this};var ve=/[^+\/0-9A-Za-z-_]/g;function Ce(q){return q<16?"0"+q.toString(16):q.toString(16)}function we(q,k){var Y;k=k||1/0;for(var X=q.length,re=null,de=[],he=0;he<X;++he){if((Y=q.charCodeAt(he))>55295&&Y<57344){if(!re){if(Y>56319){(k-=3)>-1&&de.push(239,191,189);continue}if(he+1===X){(k-=3)>-1&&de.push(239,191,189);continue}re=Y;continue}if(Y<56320){(k-=3)>-1&&de.push(239,191,189),re=Y;continue}Y=65536+(re-55296<<10|Y-56320)}else re&&(k-=3)>-1&&de.push(239,191,189);if(re=null,Y<128){if((k-=1)<0)break;de.push(Y)}else if(Y<2048){if((k-=2)<0)break;de.push(Y>>6|192,63&Y|128)}else if(Y<65536){if((k-=3)<0)break;de.push(Y>>12|224,Y>>6&63|128,63&Y|128)}else{if(!(Y<1114112))throw new Error("Invalid code point");if((k-=4)<0)break;de.push(Y>>18|240,Y>>12&63|128,Y>>6&63|128,63&Y|128)}}return de}function Ae(q){return o.toByteArray((function(k){if((k=(function(Y){return Y.trim?Y.trim():Y.replace(/^\s+|\s+$/g,"")})(k).replace(ve,"")).length<2)return"";for(;k.length%4!=0;)k+="=";return k})(q))}function Me(q,k,Y,X){for(var re=0;re<X&&!(re+Y>=k.length||re>=q.length);++re)k[re+Y]=q[re];return re}}).call(this,i(78))},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.isASCIIByte=function(a){return a>=0&&a<=127}},function(n,r,i){var a=this&&this.__read||function(s,l){var c=typeof Symbol=="function"&&s[Symbol.iterator];if(!c)return s;var f,u,d=c.call(s),h=[];try{for(;(l===void 0||l-- >0)&&!(f=d.next()).done;)h.push(f.value)}catch(p){u={error:p}}finally{try{f&&!f.done&&(c=d.return)&&c.call(d)}finally{if(u)throw u.error}}return h},o=this&&this.__spread||function(){for(var s=[],l=0;l<arguments.length;l++)s=s.concat(a(arguments[l]));return s};Object.defineProperty(r,"__esModule",{value:!0}),r.length=function(s){return s.length},r.byteLowercase=function(s){for(var l=0;l<s.length;l++){var c=s[l];c>=65&&c<=90&&(s[l]=c+32)}},r.byteUppercase=function(s){for(var l=0;l<s.length;l++){var c=s[l];c>=97&&c<=122&&(s[l]=c-32)}},r.byteCaseInsensitiveMatch=function(s,l){if(s.length!==l.length)return!1;for(var c=0;c<s.length;c++){var f=s[c],u=l[c];if(f>=65&&f<=90&&(f+=32),u>=65&&u<=90&&(u+=32),f!==u)return!1}return!0},r.startsWith=function(s,l){for(var c=0;;){if(c>=s.length)return!1;if(c>=l.length)return!0;if(s[c]!==l[c])return!1;c++}},r.byteLessThan=function(s,l){for(var c=0;;){if(c>=s.length)return!1;if(c>=l.length)return!0;var f=s[c],u=l[c];if(f<u)return!0;if(f>u)return!1;c++}},r.isomorphicDecode=function(s){return String.fromCodePoint.apply(String,o(s))}},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(6),o=i(7),s=i(0),l=i(12),c=(function(){function f(u){this._associatedDocument=u||a.dom.window.document}return f.prototype.createDocumentType=function(u,d,h){return s.namespace_validate(u),s.create_documentType(this._associatedDocument,u,d,h)},f.prototype.createDocument=function(u,d,h){h===void 0&&(h=null);var p=s.create_xmlDocument(),g=null;return d&&(g=s.document_internalCreateElementNS(p,u,d)),h&&p.appendChild(h),g&&p.appendChild(g),p._origin=this._associatedDocument._origin,u===o.namespace.HTML?p._contentType="application/xhtml+xml":u===o.namespace.SVG?p._contentType="image/svg+xml":p._contentType="application/xml",p},f.prototype.createHTMLDocument=function(u){var d=s.create_document();d._type="html",d._contentType="text/html",d.appendChild(s.create_documentType(d,"html","",""));var h=s.element_createAnElement(d,"html",o.namespace.HTML);d.appendChild(h);var p=s.element_createAnElement(d,"head",o.namespace.HTML);if(h.appendChild(p),u!==void 0){var g=s.element_createAnElement(d,"title",o.namespace.HTML);p.appendChild(g);var m=s.create_text(d,u);g.appendChild(m)}var y=s.element_createAnElement(d,"body",o.namespace.HTML);return h.appendChild(y),d._origin=this._associatedDocument._origin,d},f.prototype.hasFeature=function(){return!0},f._create=function(u){return new f(u)},f})();r.DOMImplementationImpl=c,l.idl_defineConst(c.prototype,"_ID","@oozcitak/dom")},function(n,r,i){var a,o=this&&this.__extends||(a=function(u,d){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,p){h.__proto__=p}||function(h,p){for(var g in p)p.hasOwnProperty(g)&&(h[g]=p[g])})(u,d)},function(u,d){function h(){this.constructor=u}a(u,d),u.prototype=d===null?Object.create(d):(h.prototype=d.prototype,new h)});Object.defineProperty(r,"__esModule",{value:!0});var s=i(70),l=i(1),c=i(0),f=(function(u){function d(){var h=u.call(this)||this;return h._signalSlots=new Set,h._mutationObserverMicrotaskQueued=!1,h._mutationObservers=new Set,h._iteratorList=new l.FixedSizeSet,h._associatedDocument=c.create_document(),h}return o(d,u),Object.defineProperty(d.prototype,"document",{get:function(){return this._associatedDocument},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"event",{get:function(){return this._currentEvent},enumerable:!0,configurable:!0}),d._create=function(){return new d},d})(s.EventTargetImpl);r.WindowImpl=f},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(2),o=(function(){function s(){}return s.isNode=function(l){return!!l&&l._nodeType!==void 0},s.isDocumentNode=function(l){return s.isNode(l)&&l._nodeType===a.NodeType.Document},s.isDocumentTypeNode=function(l){return s.isNode(l)&&l._nodeType===a.NodeType.DocumentType},s.isDocumentFragmentNode=function(l){return s.isNode(l)&&l._nodeType===a.NodeType.DocumentFragment},s.isAttrNode=function(l){return s.isNode(l)&&l._nodeType===a.NodeType.Attribute},s.isCharacterDataNode=function(l){if(!s.isNode(l))return!1;var c=l._nodeType;return c===a.NodeType.Text||c===a.NodeType.ProcessingInstruction||c===a.NodeType.Comment||c===a.NodeType.CData},s.isTextNode=function(l){return s.isNode(l)&&(l._nodeType===a.NodeType.Text||l._nodeType===a.NodeType.CData)},s.isExclusiveTextNode=function(l){return s.isNode(l)&&l._nodeType===a.NodeType.Text},s.isCDATASectionNode=function(l){return s.isNode(l)&&l._nodeType===a.NodeType.CData},s.isCommentNode=function(l){return s.isNode(l)&&l._nodeType===a.NodeType.Comment},s.isProcessingInstructionNode=function(l){return s.isNode(l)&&l._nodeType===a.NodeType.ProcessingInstruction},s.isElementNode=function(l){return s.isNode(l)&&l._nodeType===a.NodeType.Element},s.isCustomElementNode=function(l){return s.isElementNode(l)&&l._customElementState==="custom"},s.isShadowRoot=function(l){return!!l&&l.host!==void 0},s.isMouseEvent=function(l){return!!l&&l.screenX!==void 0&&l.screenY!=null},s.isSlotable=function(l){return!!l&&l._name!==void 0&&l._assignedSlot!==void 0&&(s.isTextNode(l)||s.isElementNode(l))},s.isSlot=function(l){return!!l&&l._name!==void 0&&l._assignedNodes!==void 0&&s.isElementNode(l)},s.isWindow=function(l){return!!l&&l.navigator!==void 0},s.isEventListener=function(l){return!!l&&l.handleEvent!==void 0},s.isRegisteredObserver=function(l){return!!l&&l.observer!==void 0&&l.options!==void 0},s.isTransientRegisteredObserver=function(l){return!!l&&l.source!==void 0&&s.isRegisteredObserver(l)},s})();r.Guard=o},function(n,r,i){var a,o=this&&this.__extends||(a=function(l,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,u){f.__proto__=u}||function(f,u){for(var d in u)u.hasOwnProperty(d)&&(f[d]=u[d])})(l,c)},function(l,c){function f(){this.constructor=l}a(l,c),l.prototype=c===null?Object.create(c):(f.prototype=c.prototype,new f)});Object.defineProperty(r,"__esModule",{value:!0});var s=(function(l){function c(){return l.call(this)||this}return o(c,l),c})(i(98).DocumentImpl);r.XMLDocumentImpl=s},function(n,r,i){var a=this&&this.__values||function(X){var re=typeof Symbol=="function"&&Symbol.iterator,de=re&&X[re],he=0;if(de)return de.call(X);if(X&&typeof X.length=="number")return{next:function(){return X&&he>=X.length&&(X=void 0),{value:X&&X[he++],done:!X}}};throw new TypeError(re?"Object is not iterable.":"Symbol.iterator is not defined.")},o=this&&this.__read||function(X,re){var de=typeof Symbol=="function"&&X[Symbol.iterator];if(!de)return X;var he,Ee,Oe=de.call(X),Pe=[];try{for(;(re===void 0||re-- >0)&&!(he=Oe.next()).done;)Pe.push(he.value)}catch(Ne){Ee={error:Ne}}finally{try{he&&!he.done&&(de=Oe.return)&&de.call(Oe)}finally{if(Ee)throw Ee.error}}return Pe};Object.defineProperty(r,"__esModule",{value:!0});var s,l=i(1),c=i(243),f=i(7),u=i(244),d={ftp:21,file:null,http:80,https:443,ws:80,wss:443},h=/[\0-\x1F\x7F-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,p=/[ "<>`]|[\0-\x1F\x7F-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,g=/[ "<>`#?{}]|[\0-\x1F\x7F-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,m=/[ "<>`#?{}/:;=@\[\]\\\^\|]|[\0-\x1F\x7F-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,y=/[0-9A-Za-z!\$&-\/:;=\?@_~\xA0-\uD7FF\uE000-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uD83E\uD840-\uD87E\uD880-\uD8BE\uD8C0-\uD8FE\uD900-\uD93E\uD940-\uD97E\uD980-\uD9BE\uD9C0-\uD9FE\uDA00-\uDA3E\uDA40-\uDA7E\uDA80-\uDABE\uDAC0-\uDAFE\uDB00-\uDB3E\uDB40-\uDB7E\uDB80-\uDBBE\uDBC0-\uDBFE][\uDC00-\uDFFF]|[\uD83F\uD87F\uD8BF\uD8FF\uD93F\uD97F\uD9BF\uD9FF\uDA3F\uDA7F\uDABF\uDAFF\uDB3F\uDB7F\uDBBF\uDBFF][\uDC00-\uDFFD]/,v=/[\0\t\f\r #%/:?@\[\\\]]/;function x(X){s!==void 0&&s.call(null,"Validation Error: "+X)}function w(){return{scheme:"",username:"",password:"",host:null,port:null,path:[],query:null,fragment:null,_cannotBeABaseURLFlag:!1,_blobURLEntry:null}}function S(X){return X in d}function T(X){return S(X.scheme)}function _(X){return d[X]||null}function D(X){return X.username!==""||X.password!==""}function I(X,re){var de,he;re===void 0&&(re=!1);var Ee=X.scheme+":";if(X.host!==null?(Ee+="//",D(X)&&(Ee+=X.username,X.password!==""&&(Ee+=":"+X.password),Ee+="@"),Ee+=R(X.host),X.port!==null&&(Ee+=":"+X.port)):X.host===null&&X.scheme==="file"&&(Ee+="//"),X._cannotBeABaseURLFlag)Ee+=X.path[0];else try{for(var Oe=a(X.path),Pe=Oe.next();!Pe.done;Pe=Oe.next())Ee+="/"+Pe.value}catch(Ne){de={error:Ne}}finally{try{Pe&&!Pe.done&&(he=Oe.return)&&he.call(Oe)}finally{if(de)throw de.error}}return X.query!==null&&(Ee+="?"+X.query),re||X.fragment===null||(Ee+="#"+X.fragment),Ee}function R(X){return l.isNumber(X)?O(X):l.isArray(X)?"["+P(X)+"]":X}function O(X){for(var re="",de=X,he=1;he<=4;he++)re=(de%256).toString()+re,he!==4&&(re="."+re),de=Math.floor(de/256);return re}function P(X){for(var re="",de=null,he=-1,Ee=0,Oe=0,Pe=0;Pe<8;Pe++)if(X[Pe]===0){Ee=1;for(var Ne=Pe+1;Ne<8&&X[Ne]===0;Ne++)Ee++;Ee>Oe&&(Oe=Ee,he=Pe)}Oe>1&&(de=he);for(var ie=!1,ae=0;ae<8;ae++)ie&&X[ae]===0||(ie&&(ie=!1),de!==ae?(re+=X[ae].toString(16),ae!==7&&(re+=":")):(re+=ae===0?"::":":",ie=!0));return re}function N(X,re,de,he,Ee){var Oe,Pe,Ne,ie;if(he===void 0){he={scheme:"",username:"",password:"",host:null,port:null,path:[],query:null,fragment:null,_cannotBeABaseURLFlag:!1,_blobURLEntry:null};var ae=/^[\u0000-\u001F\u0020]+/,Te=/[\u0000-\u001F\u0020]+$/;(ae.test(X)||Te.test(X))&&x("Input string contains leading or trailing control characters or space."),X=(X=X.replace(ae,"")).replace(Te,"")}var me=/[\u0009\u000A\u000D]/g;me.test(X)&&x("Input string contains tab or newline characters."),X=X.replace(me,"");var Se=Ee===void 0?c.ParserState.SchemeStart:Ee;re===void 0&&(re=null);for(var Ve=de===void 0||de==="replacement"||de==="UTF-16BE"||de==="UTF-16LE"?"UTF-8":de,ue="",ut=!1,ht=!1,Ot=!1,Fe=new l.StringWalker(X);;){switch(Se){case c.ParserState.SchemeStart:if(f.codePoint.ASCIIAlpha.test(Fe.c()))ue+=Fe.c().toLowerCase(),Se=c.ParserState.Scheme;else{if(Ee!==void 0)return x("Invalid scheme start character."),null;Se=c.ParserState.NoScheme,Fe.pointer--}break;case c.ParserState.Scheme:if(f.codePoint.ASCIIAlphanumeric.test(Fe.c())||Fe.c()==="+"||Fe.c()==="-"||Fe.c()===".")ue+=Fe.c().toLowerCase();else{if(Fe.c()!==":"){if(Ee===void 0){ue="",Se=c.ParserState.NoScheme,Fe.pointer=0;continue}return x("Invalid input string."),null}if(Ee!==void 0&&(S(he.scheme)&&!S(ue)||!S(he.scheme)&&S(ue)||(D(he)||he.port!==null)&&ue==="file"||he.scheme==="file"&&(he.host===""||he.host===null)))return he;if(he.scheme=ue,Ee!==void 0)return he.port===_(he.scheme)&&(he.port=null),he;ue="",he.scheme==="file"?(Fe.remaining().startsWith("//")||x("Invalid file URL scheme, '//' expected."),Se=c.ParserState.File):T(he)&&re!==null&&re.scheme===he.scheme?Se=c.ParserState.SpecialRelativeOrAuthority:T(he)?Se=c.ParserState.SpecialAuthoritySlashes:Fe.remaining().startsWith("/")?(Se=c.ParserState.PathOrAuthority,Fe.pointer++):(he._cannotBeABaseURLFlag=!0,he.path.push(""),Se=c.ParserState.CannotBeABaseURLPath)}break;case c.ParserState.NoScheme:if(re===null||re._cannotBeABaseURLFlag&&Fe.c()!=="#")return x("Invalid input string."),null;re._cannotBeABaseURLFlag&&Fe.c()==="#"?(he.scheme=re.scheme,he.path=f.list.clone(re.path),he.query=re.query,he.fragment="",he._cannotBeABaseURLFlag=!0,Se=c.ParserState.Fragment):re.scheme!=="file"?(Se=c.ParserState.Relative,Fe.pointer--):(Se=c.ParserState.File,Fe.pointer--);break;case c.ParserState.SpecialRelativeOrAuthority:Fe.c()==="/"&&Fe.remaining().startsWith("/")?(Se=c.ParserState.SpecialAuthorityIgnoreSlashes,Fe.pointer++):(x("Invalid input string."),Se=c.ParserState.Relative,Fe.pointer--);break;case c.ParserState.PathOrAuthority:Fe.c()==="/"?Se=c.ParserState.Authority:(Se=c.ParserState.Path,Fe.pointer--);break;case c.ParserState.Relative:if(re===null)throw new Error("Invalid parser state. Base URL is null.");switch(he.scheme=re.scheme,Fe.c()){case"":he.username=re.username,he.password=re.password,he.host=re.host,he.port=re.port,he.path=f.list.clone(re.path),he.query=re.query;break;case"/":Se=c.ParserState.RelativeSlash;break;case"?":he.username=re.username,he.password=re.password,he.host=re.host,he.port=re.port,he.path=f.list.clone(re.path),he.query="",Se=c.ParserState.Query;break;case"#":he.username=re.username,he.password=re.password,he.host=re.host,he.port=re.port,he.path=f.list.clone(re.path),he.query=re.query,he.fragment="",Se=c.ParserState.Fragment;break;default:T(he)&&Fe.c()==="\\"?(x("Invalid input string."),Se=c.ParserState.RelativeSlash):(he.username=re.username,he.password=re.password,he.host=re.host,he.port=re.port,he.path=f.list.clone(re.path),he.path.length!==0&&he.path.splice(he.path.length-1,1),Se=c.ParserState.Path,Fe.pointer--)}break;case c.ParserState.RelativeSlash:if(!T(he)||Fe.c()!=="/"&&Fe.c()!=="\\")if(Fe.c()==="/")Se=c.ParserState.Authority;else{if(re===null)throw new Error("Invalid parser state. Base URL is null.");he.username=re.username,he.password=re.password,he.host=re.host,he.port=re.port,Se=c.ParserState.Path,Fe.pointer--}else Fe.c()==="\\"&&x("Invalid input string."),Se=c.ParserState.SpecialAuthorityIgnoreSlashes;break;case c.ParserState.SpecialAuthoritySlashes:Fe.c()==="/"&&Fe.remaining().startsWith("/")?(Se=c.ParserState.SpecialAuthorityIgnoreSlashes,Fe.pointer++):(x("Expected '//'."),Se=c.ParserState.SpecialAuthorityIgnoreSlashes,Fe.pointer--);break;case c.ParserState.SpecialAuthorityIgnoreSlashes:Fe.c()!=="/"&&Fe.c()!=="\\"?(Se=c.ParserState.Authority,Fe.pointer--):x("Unexpected '/' or '\\'.");break;case c.ParserState.Authority:if(Fe.c()==="@"){x("Unexpected '@'."),ut&&(ue="%40"+ue),ut=!0;try{for(var Qe=(Oe=void 0,a(ue)),st=Qe.next();!st.done;st=Qe.next()){var ot=st.value;if(ot!==":"||Ot){var Mt=Me(ot,m);Ot?he.password+=Mt:he.username+=Mt}else Ot=!0}}catch(Pn){Oe={error:Pn}}finally{try{st&&!st.done&&(Pe=Qe.return)&&Pe.call(Qe)}finally{if(Oe)throw Oe.error}}ue=""}else if(Fe.c()===""||Fe.c()==="/"||Fe.c()==="?"||Fe.c()==="#"||T(he)&&Fe.c()==="\\"){if(ut&&ue==="")return x("Invalid input string."),null;Fe.pointer-=ue.length+1,ue="",Se=c.ParserState.Host}else ue+=Fe.c();break;case c.ParserState.Host:case c.ParserState.Hostname:if(Ee!==void 0&&he.scheme==="file")Fe.pointer--,Se=c.ParserState.FileHost;else if(Fe.c()!==":"||ht)if(Fe.c()===""||Fe.c()==="/"||Fe.c()==="?"||Fe.c()==="#"||T(he)&&Fe.c()==="\\"){if(Fe.pointer--,T(he)&&ue==="")return x("Invalid input string."),null;if(Ee!==void 0&&ue===""&&(D(he)||he.port!==null))return x("Invalid input string."),he;if((He=F(ue,!T(he)))===null)return null;if(he.host=He,ue="",Se=c.ParserState.PathStart,Ee!==void 0)return he}else Fe.c()==="["&&(ht=!0),Fe.c()==="]"&&(ht=!1),ue+=Fe.c();else{if(ue==="")return x("Invalid input string."),null;if((He=F(ue,!T(he)))===null)return null;if(he.host=He,ue="",Se=c.ParserState.Port,Ee===c.ParserState.Hostname)return he}break;case c.ParserState.Port:if(f.codePoint.ASCIIDigit.test(Fe.c()))ue+=Fe.c();else{if(!(Fe.c()===""||Fe.c()==="/"||Fe.c()==="?"||Fe.c()==="#"||T(he)&&Fe.c()==="\\"||Ee))return x("Invalid input string."),null;if(ue!==""&&ue!==""){var Ue=parseInt(ue,10);if(Ue>Math.pow(2,16)-1)return x("Invalid port number."),null;he.port=Ue===_(he.scheme)?null:Ue,ue=""}if(Ee!==void 0)return he;Se=c.ParserState.PathStart,Fe.pointer--}break;case c.ParserState.File:if(he.scheme="file",Fe.c()==="/"||Fe.c()==="\\")Fe.c()==="\\"&&x("Invalid input string."),Se=c.ParserState.FileSlash;else if(re!==null&&re.scheme==="file")switch(Fe.c()){case"":he.host=re.host,he.path=f.list.clone(re.path),he.query=re.query;break;case"?":he.host=re.host,he.path=f.list.clone(re.path),he.query="",Se=c.ParserState.Query;break;case"#":he.host=re.host,he.path=f.list.clone(re.path),he.query=re.query,he.fragment="",Se=c.ParserState.Fragment;break;default:G(Fe.substring())?x("Unexpected windows drive letter in input string."):(he.host=re.host,he.path=f.list.clone(re.path),V(he)),Se=c.ParserState.Path,Fe.pointer--}else Se=c.ParserState.Path,Fe.pointer--;break;case c.ParserState.FileSlash:Fe.c()==="/"||Fe.c()==="\\"?(Fe.c()==="\\"&&x("Invalid input string."),Se=c.ParserState.FileHost):(re===null||re.scheme!=="file"||G(Fe.substring())||($(re.path[0])?he.path.push(re.path[0]):he.host=re.host),Se=c.ParserState.Path,Fe.pointer--);break;case c.ParserState.FileHost:if(Fe.c()===""||Fe.c()==="/"||Fe.c()==="\\"||Fe.c()==="?"||Fe.c()==="#")if(Fe.pointer--,Ee===void 0&&U(ue))x("Unexpected windows drive letter in input string."),Se=c.ParserState.Path;else if(ue===""){if(he.host="",Ee!==void 0)return he;Se=c.ParserState.PathStart}else{var He;if((He=F(ue,!T(he)))===null)return null;if(He==="localhost"&&(He=""),he.host=He,Ee!==void 0)return he;ue="",Se=c.ParserState.PathStart}else ue+=Fe.c();break;case c.ParserState.PathStart:T(he)?(Fe.c()==="\\"&&x("Invalid input string."),Se=c.ParserState.Path,Fe.c()!=="/"&&Fe.c()!=="\\"&&Fe.pointer--):Ee===void 0&&Fe.c()==="?"?(he.query="",Se=c.ParserState.Query):Ee===void 0&&Fe.c()==="#"?(he.fragment="",Se=c.ParserState.Fragment):Fe.c()!==""&&(Se=c.ParserState.Path,Fe.c()!=="/"&&Fe.pointer--);break;case c.ParserState.Path:if(Fe.c()===""||Fe.c()==="/"||T(he)&&Fe.c()==="\\"||Ee===void 0&&(Fe.c()==="?"||Fe.c()==="#")){if(T(he)&&Fe.c()==="\\"&&x("Invalid input string."),B(ue))V(he),Fe.c()==="/"||T(he)&&Fe.c()==="\\"||he.path.push("");else if(!A(ue)||Fe.c()==="/"||T(he)&&Fe.c()==="\\"){if(!A(ue)){if(he.scheme==="file"&&he.path.length===0&&U(ue)){he.host!==null&&he.host!==""&&(x("Invalid input string."),he.host="");var Ct=Array.from(ue);ue=Ct.slice(0,1)+":"+Ct.slice(2)}he.path.push(ue)}}else he.path.push("");if(ue="",he.scheme==="file"&&(Fe.c()===""||Fe.c()==="?"||Fe.c()==="#"))for(;he.path.length>1&&he.path[0]==="";)x("Invalid input string."),he.path.splice(0,1);Fe.c()==="?"&&(he.query="",Se=c.ParserState.Query),Fe.c()==="#"&&(he.fragment="",Se=c.ParserState.Fragment)}else y.test(Fe.c())||Fe.c()==="%"||x("Character is not a URL code point or a percent encoded character."),Fe.c()!=="%"||/^[0-9a-fA-F][0-9a-fA-F]/.test(Fe.remaining())||x("Percent encoded character must be followed by two hex digits."),ue+=Me(Fe.c(),g);break;case c.ParserState.CannotBeABaseURLPath:Fe.c()==="?"?(he.query="",Se=c.ParserState.Query):Fe.c()==="#"?(he.fragment="",Se=c.ParserState.Fragment):(Fe.c()===""||y.test(Fe.c())||Fe.c()==="%"||x("Character is not a URL code point or a percent encoded character."),Fe.c()!=="%"||/^[0-9a-fA-F][0-9a-fA-F]/.test(Fe.remaining())||x("Percent encoded character must be followed by two hex digits."),Fe.c()!==""&&(he.path[0]+=Me(Fe.c(),h)));break;case c.ParserState.Query:if(Ve==="UTF-8"||T(he)&&he.scheme!=="ws"&&he.scheme!=="wss"||(Ve="UTF-8"),Ee===void 0&&Fe.c()==="#")he.fragment="",Se=c.ParserState.Fragment;else if(Fe.c()!==""){if(y.test(Fe.c())||Fe.c()==="%"||x("Character is not a URL code point or a percent encoded character."),Fe.c()!=="%"||/^[0-9a-fA-F][0-9a-fA-F]/.test(Fe.remaining())||x("Percent encoded character must be followed by two hex digits."),Ve.toUpperCase()!=="UTF-8")throw new Error("Only UTF-8 encoding is supported.");var $t=l.utf8Encode(Fe.c());if($t.length>=3&&$t[0]===38&&$t[1]===35&&$t[$t.length-1]===59)$t=$t.subarray(2,$t.length-1),he.query+="%26%23"+f.byteSequence.isomorphicDecode($t)+"%3B";else try{for(var bn=(Ne=void 0,a($t)),Tn=bn.next();!Tn.done;Tn=bn.next()){var en=Tn.value;en<33||en>126||en===34||en===35||en===60||en===62||en===39&&T(he)?he.query+=Ce(en):he.query+=String.fromCharCode(en)}}catch(Pn){Ne={error:Pn}}finally{try{Tn&&!Tn.done&&(ie=bn.return)&&ie.call(bn)}finally{if(Ne)throw Ne.error}}}break;case c.ParserState.Fragment:Fe.c()===""||(Fe.c()==="\0"?x("NULL character in input string."):(y.test(Fe.c())||Fe.c()==="%"||x("Unexpected character in fragment string."),Fe.c()!=="%"||/^[A-Za-z0-9][A-Za-z0-9]/.test(Fe.remaining())||x("Unexpected character in fragment string."),he.fragment+=Me(Fe.c(),p)))}if(Fe.eof)break;Fe.pointer++}return he}function A(X){return X==="."||X.toLowerCase()==="%2e"}function B(X){var re=X.toLowerCase();return re===".."||re===".%2e"||re==="%2e."||re==="%2e%2e"}function V(X){var re=X.path;re.length!==0&&(X.scheme==="file"&&re.length===1&&$(re[0])||X.path.splice(X.path.length-1,1))}function $(X){return X.length>=2&&f.codePoint.ASCIIAlpha.test(X[0])&&X[1]===":"}function U(X){return X.length>=2&&f.codePoint.ASCIIAlpha.test(X[0])&&(X[1]===":"||X[1]==="|")}function G(X){return X.length>=2&&U(X)&&(X.length===2||X[2]==="/"||X[2]==="\\"||X[2]==="?"||X[2]==="#")}function F(X,re){if(re===void 0&&(re=!1),X.startsWith("["))return X.endsWith("]")?ne(X.substring(1,X.length-1)):(x("Expected ']' after '['."),null);if(re)return ye(X);var de=Y(l.utf8Decode(Ae(X)));if(de===null||v.test(de))return x("Invalid domain."),null;var he=Q(de);return he===null||l.isNumber(he)?he:de}function J(X,re){re===void 0&&(re={value:!1});var de=10;return X.startsWith("0x")||X.startsWith("0X")?(re.value=!0,X=X.substr(2),de=16):X.length>=2&&X[0]==="0"&&(re.value=!0,X=X.substr(1),de=8),X===""?0:(de===10?/^[0-9]+$/:de===16?/^[0-9A-Fa-f]+$/:/^[0-7]+$/).test(X)?parseInt(X,de):null}function Q(X){var re,de,he,Ee,Oe={value:!1},Pe=X.split(".");if(Pe[Pe.length-1]===""&&(Oe.value=!0,Pe.length>1&&Pe.pop()),Pe.length>4)return X;var Ne=[];try{for(var ie=a(Pe),ae=ie.next();!ae.done;ae=ie.next()){var Te=ae.value;if(Te===""||(ht=J(Te,Oe))===null)return X;Ne.push(ht)}}catch(Ot){re={error:Ot}}finally{try{ae&&!ae.done&&(de=ie.return)&&de.call(ie)}finally{if(re)throw re.error}}Oe.value&&x("Invalid IP v4 address.");for(var me=0;me<Ne.length;me++)if(Ne[me]>255&&(x("Invalid IP v4 address."),me<Ne.length-1))return null;if(Ne[Ne.length-1]>=Math.pow(256,5-Ne.length))return x("Invalid IP v4 address."),null;var Se=Ne[Ne.length-1];Ne.pop();var Ve=0;try{for(var ue=a(Ne),ut=ue.next();!ut.done;ut=ue.next()){var ht;Se+=(ht=ut.value)*Math.pow(256,3-Ve),Ve++}}catch(Ot){he={error:Ot}}finally{try{ut&&!ut.done&&(Ee=ue.return)&&Ee.call(ue)}finally{if(he)throw he.error}}return Se}function ne(X){var re,de=[0,0,0,0,0,0,0,0],he=0,Ee=null,Oe=new l.StringWalker(X);if(Oe.c()===":"){if(!Oe.remaining().startsWith(":"))return x("Invalid IP v6 address."),null;Oe.pointer+=2,Ee=he+=1}for(;Oe.c()!=="";){if(he===8)return x("Invalid IP v6 address."),null;if(Oe.c()!==":"){for(var Pe=0,Ne=0;Ne<4&&f.codePoint.ASCIIHexDigit.test(Oe.c());)Pe=16*Pe+parseInt(Oe.c(),16),Oe.pointer++,Ne++;if(Oe.c()==="."){if(Ne===0||(Oe.pointer-=Ne,he>6))return x("Invalid IP v6 address."),null;for(var ie=0;Oe.c()!=="";){var ae=null;if(ie>0){if(!(Oe.c()==="."&&ie<4))return x("Invalid IP v6 address."),null;Oe.pointer++}if(!f.codePoint.ASCIIDigit.test(Oe.c()))return x("Invalid IP v6 address."),null;for(;f.codePoint.ASCIIDigit.test(Oe.c());){var Te=parseInt(Oe.c(),10);if(ae===null)ae=Te;else{if(ae===0)return x("Invalid IP v6 address."),null;ae=10*ae+Te}if(ae>255)return x("Invalid IP v6 address."),null;Oe.pointer++}if(ae===null)return x("Invalid IP v6 address."),null;de[he]=256*de[he]+ae,++ie!==2&&ie!==4||he++}if(ie!==4)return x("Invalid IP v6 address."),null;break}if(Oe.c()===":"){if(Oe.pointer++,Oe.c()==="")return x("Invalid IP v6 address."),null}else if(Oe.c()!=="")return x("Invalid IP v6 address."),null;de[he]=Pe,he++}else{if(Ee!==null)return x("Invalid IP v6 address."),null;Oe.pointer++,Ee=++he}}if(Ee!==null){var me=he-Ee;for(he=7;he!==0&&me>0;)re=o([de[Ee+me-1],de[he]],2),de[he]=re[0],de[Ee+me-1]=re[1],he--,me--}else if(Ee===null&&he!==8)return x("Invalid IP v6 address."),null;return de}function ye(X){var re,de;if(/[\x00\t\f\r #/:?@\[\\\]]/.test(X))return x("Invalid host string."),null;var he="";try{for(var Ee=a(X),Oe=Ee.next();!Oe.done;Oe=Ee.next())he+=Me(Oe.value,h)}catch(Pe){re={error:Pe}}finally{try{Oe&&!Oe.done&&(de=Ee.return)&&de.call(Ee)}finally{if(re)throw re.error}}return he}function ve(X){return null}function Ce(X){return"%"+("00"+X.toString(16).toUpperCase()).slice(-2)}function we(X){for(var re=function(Ne){return Ne>=48&&Ne<=57||Ne>=65&&Ne<=70||Ne>=97&&Ne<=102},de=new Uint8Array(X.length),he=0,Ee=0;Ee<X.length;Ee++){var Oe=X[Ee];if(Oe!==37)de[he]=Oe,he++;else if(Oe===37&&Ee>=X.length-2)de[he]=Oe,he++;else if(Oe!==37||re(X[Ee+1])&&re(X[Ee+2])){var Pe=parseInt(l.utf8Decode(Uint8Array.of(X[Ee+1],X[Ee+2])),16);de[he]=Pe,he++,Ee+=2}else de[he]=Oe,he++}return de.subarray(0,he)}function Ae(X){return we(l.utf8Encode(X))}function Me(X,re){var de,he;if(!re.test(X))return X;var Ee=l.utf8Encode(X),Oe="";try{for(var Pe=a(Ee),Ne=Pe.next();!Ne.done;Ne=Pe.next())Oe+=Ce(Ne.value)}catch(ie){de={error:ie}}finally{try{Ne&&!Ne.done&&(he=Pe.return)&&he.call(Pe)}finally{if(de)throw de.error}}return Oe}function q(X){var re,de,he,Ee,Oe=[],Pe=[];try{for(var Ne=a(X),ie=Ne.next();!ie.done;ie=Ne.next()){var ae=ie.value;ae===38?(Oe.push(Uint8Array.from(Pe)),Pe=[]):Pe.push(ae)}}catch(st){re={error:st}}finally{try{ie&&!ie.done&&(de=Ne.return)&&de.call(Ne)}finally{if(re)throw re.error}}Pe.length!==0&&Oe.push(Uint8Array.from(Pe));var Te=[];try{for(var me=a(Oe),Se=me.next();!Se.done;Se=me.next()){var Ve=Se.value;if(Ve.length!==0){for(var ue=Ve.indexOf(61),ut=ue!==-1?Ve.slice(0,ue):Ve,ht=ue!==-1?Ve.slice(ue+1):new Uint8Array,Ot=0;Ot<ut.length;Ot++)ut[Ot]===43&&(ut[Ot]=32);for(Ot=0;Ot<ht.length;Ot++)ht[Ot]===43&&(ht[Ot]=32);var Fe=l.utf8Decode(ut),Qe=l.utf8Decode(ht);Te.push([Fe,Qe])}}}catch(st){he={error:st}}finally{try{Se&&!Se.done&&(Ee=me.return)&&Ee.call(me)}finally{if(he)throw he.error}}return Te}function k(X){var re,de,he="";try{for(var Ee=a(X),Oe=Ee.next();!Oe.done;Oe=Ee.next()){var Pe=Oe.value;he+=Pe===32?"+":Pe===42||Pe===45||Pe===46||Pe>=48&&Pe<=57||Pe>=65&&Pe<=90||Pe===95||Pe>=97&&Pe<=122?String.fromCodePoint(Pe):Ce(Pe)}}catch(Ne){re={error:Ne}}finally{try{Oe&&!Oe.done&&(de=Ee.return)&&de.call(Ee)}finally{if(re)throw re.error}}return he}function Y(X,re){var de=u.domainToASCII(X);return de===""?(x("Invalid domain name."),null):de}r.setValidationErrorCallback=function(X){s=X},r.newURL=w,r.isSpecialScheme=S,r.isSpecial=T,r.defaultPort=_,r.includesCredentials=D,r.cannotHaveAUsernamePasswordPort=function(X){return X.host===null||X.host===""||X._cannotBeABaseURLFlag||X.scheme==="file"},r.urlSerializer=I,r.hostSerializer=R,r.iPv4Serializer=O,r.iPv6Serializer=P,r.urlParser=function(X,re,de){var he=N(X,re,de);return he===null?null:(he.scheme!=="blob"||(he._blobURLEntry=null),he)},r.basicURLParser=N,r.setTheUsername=function(X,re){var de,he,Ee="";try{for(var Oe=a(re),Pe=Oe.next();!Pe.done;Pe=Oe.next())Ee+=Me(Pe.value,m)}catch(Ne){de={error:Ne}}finally{try{Pe&&!Pe.done&&(he=Oe.return)&&he.call(Oe)}finally{if(de)throw de.error}}X.username=Ee},r.setThePassword=function(X,re){var de,he,Ee="";try{for(var Oe=a(re),Pe=Oe.next();!Pe.done;Pe=Oe.next())Ee+=Me(Pe.value,m)}catch(Ne){de={error:Ne}}finally{try{Pe&&!Pe.done&&(he=Oe.return)&&he.call(Oe)}finally{if(de)throw de.error}}X.password=Ee},r.isSingleDotPathSegment=A,r.isDoubleDotPathSegment=B,r.shorten=V,r.isNormalizedWindowsDriveLetter=$,r.isWindowsDriveLetter=U,r.startsWithAWindowsDriveLetter=G,r.hostParser=F,r.iPv4NumberParser=J,r.iPv4Parser=Q,r.iPv6Parser=ne,r.opaqueHostParser=ye,r.resolveABlobURL=ve,r.percentEncode=Ce,r.percentDecode=we,r.stringPercentDecode=Ae,r.utf8PercentEncode=Me,r.hostEquals=function(X,re){return X===re},r.urlEquals=function(X,re,de){return de===void 0&&(de=!1),I(X,de)===I(re,de)},r.urlEncodedStringParser=function(X){return q(l.utf8Encode(X))},r.urlEncodedParser=q,r.urlEncodedByteSerializer=k,r.urlEncodedSerializer=function(X,re){var de,he;if((re===void 0||re==="replacement"||re==="UTF-16BE"||re==="UTF-16LE"?"UTF-8":re).toUpperCase()!=="UTF-8")throw new Error("Only UTF-8 encoding is supported.");var Ee="";try{for(var Oe=a(X),Pe=Oe.next();!Pe.done;Pe=Oe.next()){var Ne=Pe.value,ie=k(l.utf8Encode(Ne[0])),ae=Ne[1];ae=k(l.utf8Encode(ae)),Ee!==""&&(Ee+="&"),Ee+=ie+"="+ae}}catch(Te){de={error:Te}}finally{try{Pe&&!Pe.done&&(he=Oe.return)&&he.call(Oe)}finally{if(de)throw de.error}}return Ee},r.origin=function X(re){switch(re.scheme){case"blob":re._blobURLEntry;var de=N(re.path[0]);return de===null?c.OpaqueOrigin:X(de);case"ftp":case"http":case"https":case"ws":case"wss":return[re.scheme,re.host===null?"":re.host,re.port,null];case"file":default:return c.OpaqueOrigin}},r.domainToASCII=Y,r.domainToUnicode=function(X,re){var de=u.domainToUnicode(X);return de===""&&x("Invalid domain name."),de},r.asciiSerializationOfAnOrigin=function(X){if(X[0]===""&&X[1]===""&&X[2]===null&&X[3]===null)return"null";var re=X[0]+"://"+R(X[1]);return X[2]!==null&&(re+=":"+X[2].toString()),re}},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(0),o=(function(){function s(){this._signal=a.create_abortSignal()}return Object.defineProperty(s.prototype,"signal",{get:function(){return this._signal},enumerable:!0,configurable:!0}),s.prototype.abort=function(){a.abort_signalAbort(this._signal)},s})();r.AbortControllerImpl=o},function(n,r,i){var a,o=this&&this.__extends||(a=function(f,u){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,h){d.__proto__=h}||function(d,h){for(var p in h)h.hasOwnProperty(p)&&(d[p]=h[p])})(f,u)},function(f,u){function d(){this.constructor=f}a(f,u),f.prototype=u===null?Object.create(u):(d.prototype=u.prototype,new d)});Object.defineProperty(r,"__esModule",{value:!0});var s=i(70),l=i(0),c=(function(f){function u(){var d=f.call(this)||this;return d._abortedFlag=!1,d._abortAlgorithms=new Set,d}return o(u,f),Object.defineProperty(u.prototype,"aborted",{get:function(){return this._abortedFlag},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"onabort",{get:function(){return l.event_getterEventHandlerIDLAttribute(this,"onabort")},set:function(d){l.event_setterEventHandlerIDLAttribute(this,"onabort",d)},enumerable:!0,configurable:!0}),u._create=function(){return new u},u})(s.EventTargetImpl);r.AbortSignalImpl=c},function(n,r,i){var a,o=this&&this.__extends||(a=function(u,d){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,p){h.__proto__=p}||function(h,p){for(var g in p)p.hasOwnProperty(g)&&(h[g]=p[g])})(u,d)},function(u,d){function h(){this.constructor=u}a(u,d),u.prototype=d===null?Object.create(d):(h.prototype=d.prototype,new h)});Object.defineProperty(r,"__esModule",{value:!0});var s=i(2),l=i(34),c=i(12),f=(function(u){function d(h,p,g){var m=u.call(this)||this;return m._name="",m._publicId="",m._systemId="",m._name=h,m._publicId=p,m._systemId=g,m}return o(d,u),Object.defineProperty(d.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"publicId",{get:function(){return this._publicId},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"systemId",{get:function(){return this._systemId},enumerable:!0,configurable:!0}),d.prototype.before=function(){for(var h=[],p=0;p<arguments.length;p++)h[p]=arguments[p];throw new Error("Mixin: ChildNode not implemented.")},d.prototype.after=function(){for(var h=[],p=0;p<arguments.length;p++)h[p]=arguments[p];throw new Error("Mixin: ChildNode not implemented.")},d.prototype.replaceWith=function(){for(var h=[],p=0;p<arguments.length;p++)h[p]=arguments[p];throw new Error("Mixin: ChildNode not implemented.")},d.prototype.remove=function(){throw new Error("Mixin: ChildNode not implemented.")},d._create=function(h,p,g,m){g===void 0&&(g=""),m===void 0&&(m="");var y=new d(p,g,m);return y._nodeDocument=h,y},d})(l.NodeImpl);r.DocumentTypeImpl=f,c.idl_defineConst(f.prototype,"_nodeType",s.NodeType.DocumentType)},function(n,r,i){var a,o=this&&this.__extends||(a=function(u,d){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,p){h.__proto__=p}||function(h,p){for(var g in p)p.hasOwnProperty(g)&&(h[g]=p[g])})(u,d)},function(u,d){function h(){this.constructor=u}a(u,d),u.prototype=d===null?Object.create(d):(h.prototype=d.prototype,new h)});Object.defineProperty(r,"__esModule",{value:!0});var s=i(100),l=i(1),c=i(0),f=(function(u){function d(h,p){var g=u.call(this)||this;return g._host=h,g._mode=p,g}return o(d,u),Object.defineProperty(d.prototype,"mode",{get:function(){return this._mode},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"host",{get:function(){return this._host},enumerable:!0,configurable:!0}),d.prototype._getTheParent=function(h){return h._composedFlag||l.isEmpty(h._path)||c.tree_rootNode(h._path[0].invocationTarget)!==this?this._host:null},d._create=function(h,p){return new d(p,"closed")},d})(s.DocumentFragmentImpl);r.ShadowRootImpl=f},function(n,r,i){var a,o=this&&this.__extends||(a=function(d,h){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(p,g){p.__proto__=g}||function(p,g){for(var m in g)g.hasOwnProperty(m)&&(p[m]=g[m])})(d,h)},function(d,h){function p(){this.constructor=d}a(d,h),d.prototype=h===null?Object.create(h):(p.prototype=h.prototype,new p)});Object.defineProperty(r,"__esModule",{value:!0});var s=i(2),l=i(34),c=i(0),f=i(12),u=(function(d){function h(p){var g=d.call(this)||this;return g._namespace=null,g._namespacePrefix=null,g._element=null,g._value="",g._localName=p,g}return o(h,d),Object.defineProperty(h.prototype,"ownerElement",{get:function(){return this._element},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"namespaceURI",{get:function(){return this._namespace},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"prefix",{get:function(){return this._namespacePrefix},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"localName",{get:function(){return this._localName},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"name",{get:function(){return this._qualifiedName},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"value",{get:function(){return this._value},set:function(p){c.attr_setAnExistingAttributeValue(this,p)},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"_qualifiedName",{get:function(){return this._namespacePrefix!==null?this._namespacePrefix+":"+this._localName:this._localName},enumerable:!0,configurable:!0}),h._create=function(p,g){var m=new h(g);return m._nodeDocument=p,m},h})(l.NodeImpl);r.AttrImpl=u,f.idl_defineConst(u.prototype,"_nodeType",s.NodeType.Attribute),f.idl_defineConst(u.prototype,"specified",!0)},function(n,r,i){var a,o=this&&this.__extends||(a=function(u,d){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,p){h.__proto__=p}||function(h,p){for(var g in p)p.hasOwnProperty(g)&&(h[g]=p[g])})(u,d)},function(u,d){function h(){this.constructor=u}a(u,d),u.prototype=d===null?Object.create(d):(h.prototype=d.prototype,new h)});Object.defineProperty(r,"__esModule",{value:!0});var s=i(101),l=i(2),c=i(12),f=(function(u){function d(h){return u.call(this,h)||this}return o(d,u),d._create=function(h,p){p===void 0&&(p="");var g=new d(p);return g._nodeDocument=h,g},d})(s.TextImpl);r.CDATASectionImpl=f,c.idl_defineConst(f.prototype,"_nodeType",l.NodeType.CData)},function(n,r,i){var a,o=this&&this.__extends||(a=function(u,d){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,p){h.__proto__=p}||function(h,p){for(var g in p)p.hasOwnProperty(g)&&(h[g]=p[g])})(u,d)},function(u,d){function h(){this.constructor=u}a(u,d),u.prototype=d===null?Object.create(d):(h.prototype=d.prototype,new h)});Object.defineProperty(r,"__esModule",{value:!0});var s=i(2),l=i(71),c=i(12),f=(function(u){function d(h){return h===void 0&&(h=""),u.call(this,h)||this}return o(d,u),d._create=function(h,p){p===void 0&&(p="");var g=new d(p);return g._nodeDocument=h,g},d})(l.CharacterDataImpl);r.CommentImpl=f,c.idl_defineConst(f.prototype,"_nodeType",s.NodeType.Comment)},function(n,r,i){var a,o=this&&this.__extends||(a=function(u,d){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,p){h.__proto__=p}||function(h,p){for(var g in p)p.hasOwnProperty(g)&&(h[g]=p[g])})(u,d)},function(u,d){function h(){this.constructor=u}a(u,d),u.prototype=d===null?Object.create(d):(h.prototype=d.prototype,new h)});Object.defineProperty(r,"__esModule",{value:!0});var s=i(2),l=i(71),c=i(12),f=(function(u){function d(h,p){var g=u.call(this,p)||this;return g._target=h,g}return o(d,u),Object.defineProperty(d.prototype,"target",{get:function(){return this._target},enumerable:!0,configurable:!0}),d._create=function(h,p,g){var m=new d(p,g);return m._nodeDocument=h,m},d})(l.CharacterDataImpl);r.ProcessingInstructionImpl=f,c.idl_defineConst(f.prototype,"_nodeType",s.NodeType.ProcessingInstruction)},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(7),o=i(0),s=i(3),l=i(1),c=(function(){function f(u,d){return this._live=!0,this._root=u,this._filter=d,new Proxy(this,this)}return Object.defineProperty(f.prototype,"length",{get:function(){for(var u=this,d=0,h=o.tree_getFirstDescendantNode(this._root,!1,!1,(function(p){return s.Guard.isElementNode(p)&&u._filter(p)}));h!==null;)d++,h=o.tree_getNextDescendantNode(this._root,h,!1,!1,(function(p){return s.Guard.isElementNode(p)&&u._filter(p)}));return d},enumerable:!0,configurable:!0}),f.prototype.item=function(u){for(var d=this,h=0,p=o.tree_getFirstDescendantNode(this._root,!1,!1,(function(g){return s.Guard.isElementNode(g)&&d._filter(g)}));p!==null;){if(h===u)return p;h++,p=o.tree_getNextDescendantNode(this._root,p,!1,!1,(function(g){return s.Guard.isElementNode(g)&&d._filter(g)}))}return null},f.prototype.namedItem=function(u){var d=this;if(u==="")return null;for(var h=o.tree_getFirstDescendantNode(this._root,!1,!1,(function(m){return s.Guard.isElementNode(m)&&d._filter(m)}));h!=null;){if(h._uniqueIdentifier===u)return h;if(h._namespace===a.namespace.HTML)for(var p=0;p<h._attributeList.length;p++){var g=h._attributeList[p];if(g._localName==="name"&&g._namespace===null&&g._namespacePrefix===null&&g._value===u)return h}h=o.tree_getNextDescendantNode(this._root,h,!1,!1,(function(m){return s.Guard.isElementNode(m)&&d._filter(m)}))}return null},f.prototype[Symbol.iterator]=function(){var u=this._root,d=this._filter,h=o.tree_getFirstDescendantNode(u,!1,!1,(function(p){return s.Guard.isElementNode(p)&&d(p)}));return{next:function(){if(h===null)return{done:!0,value:null};var p={done:!1,value:h};return h=o.tree_getNextDescendantNode(u,h,!1,!1,(function(g){return s.Guard.isElementNode(g)&&d(g)})),p}}},f.prototype.get=function(u,d,h){if(!l.isString(d)||f.reservedNames.indexOf(d)!==-1)return Reflect.get(u,d,h);var p=Number(d);return isNaN(p)?u.namedItem(d)||void 0:u.item(p)||void 0},f.prototype.set=function(u,d,h,p){if(!l.isString(d)||f.reservedNames.indexOf(d)!==-1)return Reflect.set(u,d,h,p);var g=Number(d),m=isNaN(g)?u.namedItem(d)||void 0:u.item(g)||void 0;return!(!m||!m._parent)&&(o.mutation_replace(m,h,m._parent),!0)},f._create=function(u,d){return d===void 0&&(d=function(){return!0}),new f(u,d)},f.reservedNames=["_root","_live","_filter","length","item","namedItem","get","set"],f})();r.HTMLCollectionImpl=c},function(n,r,i){var a=this&&this.__values||function(f){var u=typeof Symbol=="function"&&Symbol.iterator,d=u&&f[u],h=0;if(d)return d.call(f);if(f&&typeof f.length=="number")return{next:function(){return f&&h>=f.length&&(f=void 0),{value:f&&f[h++],done:!f}}};throw new TypeError(u?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var o=i(6),s=i(1),l=i(0),c=(function(){function f(u){return this._live=!0,this._filter=null,this._length=0,this._root=u,new Proxy(this,this)}return Object.defineProperty(f.prototype,"length",{get:function(){return this._root._children.size},enumerable:!0,configurable:!0}),f.prototype.item=function(u){if(u<0||u>this.length-1)return null;if(u<this.length/2){for(var d=0,h=this._root._firstChild;h!==null&&d!==u;)h=h._nextSibling,d++;return h}for(d=this.length-1,h=this._root._lastChild;h!==null&&d!==u;)h=h._previousSibling,d--;return h},f.prototype.keys=function(){var u;return(u={})[Symbol.iterator]=(function(){var d=0;return{next:(function(){return d===this.length?{done:!0,value:null}:{done:!1,value:d++}}).bind(this)}}).bind(this),u},f.prototype.values=function(){var u;return(u={})[Symbol.iterator]=(function(){var d=this[Symbol.iterator]();return{next:function(){return d.next()}}}).bind(this),u},f.prototype.entries=function(){var u;return(u={})[Symbol.iterator]=(function(){var d=this[Symbol.iterator](),h=0;return{next:function(){var p=d.next();return p.done?{done:!0,value:null}:{done:!1,value:[h++,p.value]}}}}).bind(this),u},f.prototype[Symbol.iterator]=function(){return this._root._children[Symbol.iterator]()},f.prototype.forEach=function(u,d){var h,p;d===void 0&&(d=o.dom.window);var g=0;try{for(var m=a(this._root._children),y=m.next();!y.done;y=m.next()){var v=y.value;u.call(d,v,g++,this)}}catch(x){h={error:x}}finally{try{y&&!y.done&&(p=m.return)&&p.call(m)}finally{if(h)throw h.error}}},f.prototype.get=function(u,d,h){if(!s.isString(d))return Reflect.get(u,d,h);var p=Number(d);return isNaN(p)?Reflect.get(u,d,h):u.item(p)||void 0},f.prototype.set=function(u,d,h,p){if(!s.isString(d))return Reflect.set(u,d,h,p);var g=Number(d);if(isNaN(g))return Reflect.set(u,d,h,p);var m=u.item(g)||void 0;return!!m&&!!m._parent&&(l.mutation_replace(m,h,m._parent),!0)},f._create=function(u){return new f(u)},f})();r.NodeListImpl=c},function(n,r,i){var a=this&&this.__values||function(c){var f=typeof Symbol=="function"&&Symbol.iterator,u=f&&c[f],d=0;if(u)return u.call(c);if(c&&typeof c.length=="number")return{next:function(){return c&&d>=c.length&&(c=void 0),{value:c&&c[d++],done:!c}}};throw new TypeError(f?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var o=i(6),s=i(1),l=(function(){function c(f){return this._live=!1,this._items=[],this._length=0,this._root=f,this._items=[],this._filter=function(u){return!0},new Proxy(this,this)}return Object.defineProperty(c.prototype,"length",{get:function(){return this._items.length},enumerable:!0,configurable:!0}),c.prototype.item=function(f){return f<0||f>this.length-1?null:this._items[f]},c.prototype.keys=function(){var f;return(f={})[Symbol.iterator]=(function(){var u=0;return{next:(function(){return u===this.length?{done:!0,value:null}:{done:!1,value:u++}}).bind(this)}}).bind(this),f},c.prototype.values=function(){var f;return(f={})[Symbol.iterator]=(function(){var u=this[Symbol.iterator]();return{next:function(){return u.next()}}}).bind(this),f},c.prototype.entries=function(){var f;return(f={})[Symbol.iterator]=(function(){var u=this[Symbol.iterator](),d=0;return{next:function(){var h=u.next();return h.done?{done:!0,value:null}:{done:!1,value:[d++,h.value]}}}}).bind(this),f},c.prototype[Symbol.iterator]=function(){var f=this._items[Symbol.iterator]();return{next:function(){return f.next()}}},c.prototype.forEach=function(f,u){var d,h;u===void 0&&(u=o.dom.window);var p=0;try{for(var g=a(this._items),m=g.next();!m.done;m=g.next()){var y=m.value;f.call(u,y,p++,this)}}catch(v){d={error:v}}finally{try{m&&!m.done&&(h=g.return)&&h.call(g)}finally{if(d)throw d.error}}},c.prototype.get=function(f,u,d){if(!s.isString(u))return Reflect.get(f,u,d);var h=Number(u);return isNaN(h)?Reflect.get(f,u,d):f._items[h]||void 0},c.prototype.set=function(f,u,d,h){if(!s.isString(u))return Reflect.set(f,u,d,h);var p=Number(u);return isNaN(p)?Reflect.set(f,u,d,h):p>=0&&p<f._items.length&&(f._items[p]=d,!0)},c._create=function(f,u){var d=new c(f);return d._items=u,d},c})();r.NodeListStaticImpl=l},function(n,r,i){var a,o=this&&this.__extends||(a=function(f,u){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,h){d.__proto__=h}||function(d,h){for(var p in h)h.hasOwnProperty(p)&&(d[p]=h[p])})(f,u)},function(f,u){function d(){this.constructor=f}a(f,u),f.prototype=u===null?Object.create(u):(d.prototype=u.prototype,new d)});Object.defineProperty(r,"__esModule",{value:!0});var s=i(9),l=i(0),c=(function(f){function u(d){var h=f.call(this)||this;return h._element=d,Object.setPrototypeOf(h,u.prototype),h}return o(u,f),u.prototype._asArray=function(){return this},u.prototype.item=function(d){return this[d]||null},u.prototype.getNamedItem=function(d){return l.element_getAnAttributeByName(d,this._element)},u.prototype.getNamedItemNS=function(d,h){return l.element_getAnAttributeByNamespaceAndLocalName(d||"",h,this._element)},u.prototype.setNamedItem=function(d){return l.element_setAnAttribute(d,this._element)},u.prototype.setNamedItemNS=function(d){return l.element_setAnAttribute(d,this._element)},u.prototype.removeNamedItem=function(d){var h=l.element_removeAnAttributeByName(d,this._element);if(h===null)throw new s.NotFoundError;return h},u.prototype.removeNamedItemNS=function(d,h){var p=l.element_removeAnAttributeByNamespaceAndLocalName(d||"",h,this._element);if(p===null)throw new s.NotFoundError;return p},u._create=function(d){return new u(d)},u})(Array);r.NamedNodeMapImpl=c},function(n,r,i){var a,o=this&&this.__extends||(a=function(m,y){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,x){v.__proto__=x}||function(v,x){for(var w in x)x.hasOwnProperty(w)&&(v[w]=x[w])})(m,y)},function(m,y){function v(){this.constructor=m}a(m,y),m.prototype=y===null?Object.create(y):(v.prototype=y.prototype,new v)}),s=this&&this.__values||function(m){var y=typeof Symbol=="function"&&Symbol.iterator,v=y&&m[y],x=0;if(v)return v.call(m);if(m&&typeof m.length=="number")return{next:function(){return m&&x>=m.length&&(m=void 0),{value:m&&m[x++],done:!m}}};throw new TypeError(y?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var l=i(6),c=i(2),f=i(102),u=i(9),d=i(0),h=i(12),p=i(3),g=(function(m){function y(){var v=m.call(this)||this,x=l.dom.window._associatedDocument;return v._start=[x,0],v._end=[x,0],l.dom.rangeList.add(v),v}return o(y,m),Object.defineProperty(y.prototype,"commonAncestorContainer",{get:function(){for(var v=this._start[0];!d.tree_isAncestorOf(this._end[0],v,!0);){if(v._parent===null)throw new Error("Parent node  is null.");v=v._parent}return v},enumerable:!0,configurable:!0}),y.prototype.setStart=function(v,x){d.range_setTheStart(this,v,x)},y.prototype.setEnd=function(v,x){d.range_setTheEnd(this,v,x)},y.prototype.setStartBefore=function(v){var x=v._parent;if(x===null)throw new u.InvalidNodeTypeError;d.range_setTheStart(this,x,d.tree_index(v))},y.prototype.setStartAfter=function(v){var x=v._parent;if(x===null)throw new u.InvalidNodeTypeError;d.range_setTheStart(this,x,d.tree_index(v)+1)},y.prototype.setEndBefore=function(v){var x=v._parent;if(x===null)throw new u.InvalidNodeTypeError;d.range_setTheEnd(this,x,d.tree_index(v))},y.prototype.setEndAfter=function(v){var x=v._parent;if(x===null)throw new u.InvalidNodeTypeError;d.range_setTheEnd(this,x,d.tree_index(v)+1)},y.prototype.collapse=function(v){v?this._end=this._start:this._start=this._end},y.prototype.selectNode=function(v){d.range_select(v,this)},y.prototype.selectNodeContents=function(v){if(p.Guard.isDocumentTypeNode(v))throw new u.InvalidNodeTypeError;var x=d.tree_nodeLength(v);this._start=[v,0],this._end=[v,x]},y.prototype.compareBoundaryPoints=function(v,x){if(v!==c.HowToCompare.StartToStart&&v!==c.HowToCompare.StartToEnd&&v!==c.HowToCompare.EndToEnd&&v!==c.HowToCompare.EndToStart)throw new u.NotSupportedError;if(d.range_root(this)!==d.range_root(x))throw new u.WrongDocumentError;var w,S;switch(v){case c.HowToCompare.StartToStart:w=this._start,S=x._start;break;case c.HowToCompare.StartToEnd:w=this._end,S=x._start;break;case c.HowToCompare.EndToEnd:w=this._end,S=x._end;break;case c.HowToCompare.EndToStart:w=this._start,S=x._end;break;default:throw new u.NotSupportedError}var T=d.boundaryPoint_position(w,S);return T===c.BoundaryPosition.Before?-1:T===c.BoundaryPosition.After?1:0},y.prototype.deleteContents=function(){var v,x,w,S;if(!d.range_collapsed(this)){var T=this._startNode,_=this._startOffset,D=this._endNode,I=this._endOffset;if(T===D&&p.Guard.isCharacterDataNode(T))d.characterData_replaceData(T,_,I-_,"");else{var R,O,P=[];try{for(var N=s(d.range_getContainedNodes(this)),A=N.next();!A.done;A=N.next()){var B=(G=A.value)._parent;B!==null&&d.range_isContained(B,this)||P.push(G)}}catch(F){v={error:F}}finally{try{A&&!A.done&&(x=N.return)&&x.call(N)}finally{if(v)throw v.error}}if(d.tree_isAncestorOf(D,T,!0))R=T,O=_;else{for(var V=T;V._parent!==null&&!d.tree_isAncestorOf(D,V._parent,!0);)V=V._parent;if(V._parent===null)throw new Error("Parent node is null.");R=V._parent,O=d.tree_index(V)+1}p.Guard.isCharacterDataNode(T)&&d.characterData_replaceData(T,_,d.tree_nodeLength(T)-_,"");try{for(var $=s(P),U=$.next();!U.done;U=$.next()){var G;(G=U.value)._parent&&d.mutation_remove(G,G._parent)}}catch(F){w={error:F}}finally{try{U&&!U.done&&(S=$.return)&&S.call($)}finally{if(w)throw w.error}}p.Guard.isCharacterDataNode(D)&&d.characterData_replaceData(D,0,I,""),this._start=[R,O],this._end=[R,O]}}},y.prototype.extractContents=function(){return d.range_extract(this)},y.prototype.cloneContents=function(){return d.range_cloneTheContents(this)},y.prototype.insertNode=function(v){return d.range_insert(v,this)},y.prototype.surroundContents=function(v){var x,w;try{for(var S=s(d.range_getPartiallyContainedNodes(this)),T=S.next();!T.done;T=S.next()){var _=T.value;if(!p.Guard.isTextNode(_))throw new u.InvalidStateError}}catch(I){x={error:I}}finally{try{T&&!T.done&&(w=S.return)&&w.call(S)}finally{if(x)throw x.error}}if(p.Guard.isDocumentNode(v)||p.Guard.isDocumentTypeNode(v)||p.Guard.isDocumentFragmentNode(v))throw new u.InvalidNodeTypeError;var D=d.range_extract(this);v._children.size!==0&&d.mutation_replaceAll(null,v),d.range_insert(v,this),d.mutation_append(D,v),d.range_select(v,this)},y.prototype.cloneRange=function(){return d.create_range(this._start,this._end)},y.prototype.detach=function(){l.dom.rangeList.delete(this)},y.prototype.isPointInRange=function(v,x){if(d.tree_rootNode(v)!==d.range_root(this))return!1;if(p.Guard.isDocumentTypeNode(v))throw new u.InvalidNodeTypeError;if(x>d.tree_nodeLength(v))throw new u.IndexSizeError;var w=[v,x];return d.boundaryPoint_position(w,this._start)!==c.BoundaryPosition.Before&&d.boundaryPoint_position(w,this._end)!==c.BoundaryPosition.After},y.prototype.comparePoint=function(v,x){if(d.tree_rootNode(v)!==d.range_root(this))throw new u.WrongDocumentError;if(p.Guard.isDocumentTypeNode(v))throw new u.InvalidNodeTypeError;if(x>d.tree_nodeLength(v))throw new u.IndexSizeError;var w=[v,x];return d.boundaryPoint_position(w,this._start)===c.BoundaryPosition.Before?-1:d.boundaryPoint_position(w,this._end)===c.BoundaryPosition.After?1:0},y.prototype.intersectsNode=function(v){if(d.tree_rootNode(v)!==d.range_root(this))return!1;var x=v._parent;if(x===null)return!0;var w=d.tree_index(v);return d.boundaryPoint_position([x,w],this._end)===c.BoundaryPosition.Before&&d.boundaryPoint_position([x,w+1],this._start)===c.BoundaryPosition.After},y.prototype.toString=function(){var v,x,w="";if(this._startNode===this._endNode&&p.Guard.isTextNode(this._startNode))return this._startNode._data.substring(this._startOffset,this._endOffset);p.Guard.isTextNode(this._startNode)&&(w+=this._startNode._data.substring(this._startOffset));try{for(var S=s(d.range_getContainedNodes(this)),T=S.next();!T.done;T=S.next()){var _=T.value;p.Guard.isTextNode(_)&&(w+=_._data)}}catch(D){v={error:D}}finally{try{T&&!T.done&&(x=S.return)&&x.call(S)}finally{if(v)throw v.error}}return p.Guard.isTextNode(this._endNode)&&(w+=this._endNode._data.substring(0,this._endOffset)),w},y._create=function(v,x){var w=new y;return v&&(w._start=v),x&&(w._end=x),w},y.START_TO_START=0,y.START_TO_END=1,y.END_TO_END=2,y.END_TO_START=3,y})(f.AbstractRangeImpl);r.RangeImpl=g,h.idl_defineConst(g.prototype,"START_TO_START",0),h.idl_defineConst(g.prototype,"START_TO_END",1),h.idl_defineConst(g.prototype,"END_TO_END",2),h.idl_defineConst(g.prototype,"END_TO_START",3)},function(n,r,i){var a,o=this&&this.__extends||(a=function(f,u){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,h){d.__proto__=h}||function(d,h){for(var p in h)h.hasOwnProperty(p)&&(d[p]=h[p])})(f,u)},function(f,u){function d(){this.constructor=f}a(f,u),f.prototype=u===null?Object.create(u):(d.prototype=u.prototype,new d)});Object.defineProperty(r,"__esModule",{value:!0});var s=i(103),l=i(0),c=(function(f){function u(d,h,p){var g=f.call(this,d)||this;return g._iteratorCollection=void 0,g._reference=h,g._pointerBeforeReference=p,l.nodeIterator_iteratorList().add(g),g}return o(u,f),Object.defineProperty(u.prototype,"referenceNode",{get:function(){return this._reference},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"pointerBeforeReferenceNode",{get:function(){return this._pointerBeforeReference},enumerable:!0,configurable:!0}),u.prototype.nextNode=function(){return l.nodeIterator_traverse(this,!0)},u.prototype.previousNode=function(){return l.nodeIterator_traverse(this,!1)},u.prototype.detach=function(){l.nodeIterator_iteratorList().delete(this)},u._create=function(d,h,p){return new u(d,h,p)},u})(s.TraverserImpl);r.NodeIteratorImpl=c},function(n,r,i){var a,o=this&&this.__extends||(a=function(u,d){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,p){h.__proto__=p}||function(h,p){for(var g in p)p.hasOwnProperty(g)&&(h[g]=p[g])})(u,d)},function(u,d){function h(){this.constructor=u}a(u,d),u.prototype=d===null?Object.create(d):(h.prototype=d.prototype,new h)});Object.defineProperty(r,"__esModule",{value:!0});var s=i(2),l=i(103),c=i(0),f=(function(u){function d(h,p){var g=u.call(this,h)||this;return g._current=p,g}return o(d,u),Object.defineProperty(d.prototype,"currentNode",{get:function(){return this._current},set:function(h){this._current=h},enumerable:!0,configurable:!0}),d.prototype.parentNode=function(){for(var h=this._current;h!==null&&h!==this._root;)if((h=h._parent)!==null&&c.traversal_filter(this,h)===s.FilterResult.Accept)return this._current=h,h;return null},d.prototype.firstChild=function(){return c.treeWalker_traverseChildren(this,!0)},d.prototype.lastChild=function(){return c.treeWalker_traverseChildren(this,!1)},d.prototype.nextSibling=function(){return c.treeWalker_traverseSiblings(this,!0)},d.prototype.previousNode=function(){for(var h=this._current;h!==this._root;){for(var p=h._previousSibling;p;){h=p;for(var g=c.traversal_filter(this,h);g!==s.FilterResult.Reject&&h._lastChild;)h=h._lastChild,g=c.traversal_filter(this,h);if(g===s.FilterResult.Accept)return this._current=h,h;p=h._previousSibling}if(h===this._root||h._parent===null)return null;if(h=h._parent,c.traversal_filter(this,h)===s.FilterResult.Accept)return this._current=h,h}return null},d.prototype.previousSibling=function(){return c.treeWalker_traverseSiblings(this,!1)},d.prototype.nextNode=function(){for(var h=this._current,p=s.FilterResult.Accept;;){for(;p!==s.FilterResult.Reject&&h._firstChild;)if(h=h._firstChild,(p=c.traversal_filter(this,h))===s.FilterResult.Accept)return this._current=h,h;for(var g=null,m=h;m!==null;){if(m===this._root)return null;if((g=m._nextSibling)!==null){h=g;break}m=m._parent}if((p=c.traversal_filter(this,h))===s.FilterResult.Accept)return this._current=h,h}},d._create=function(h,p){return new d(h,p)},d})(l.TraverserImpl);r.TreeWalkerImpl=f},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(2),o=i(12),s=(function(){function l(){}return l.prototype.acceptNode=function(c){return a.FilterResult.Accept},l._create=function(){return new l},l.FILTER_ACCEPT=1,l.FILTER_REJECT=2,l.FILTER_SKIP=3,l.SHOW_ALL=4294967295,l.SHOW_ELEMENT=1,l.SHOW_ATTRIBUTE=2,l.SHOW_TEXT=4,l.SHOW_CDATA_SECTION=8,l.SHOW_ENTITY_REFERENCE=16,l.SHOW_ENTITY=32,l.SHOW_PROCESSING_INSTRUCTION=64,l.SHOW_COMMENT=128,l.SHOW_DOCUMENT=256,l.SHOW_DOCUMENT_TYPE=512,l.SHOW_DOCUMENT_FRAGMENT=1024,l.SHOW_NOTATION=2048,l})();r.NodeFilterImpl=s,o.idl_defineConst(s.prototype,"FILTER_ACCEPT",1),o.idl_defineConst(s.prototype,"FILTER_REJECT",2),o.idl_defineConst(s.prototype,"FILTER_SKIP",3),o.idl_defineConst(s.prototype,"SHOW_ALL",4294967295),o.idl_defineConst(s.prototype,"SHOW_ELEMENT",1),o.idl_defineConst(s.prototype,"SHOW_ATTRIBUTE",2),o.idl_defineConst(s.prototype,"SHOW_TEXT",4),o.idl_defineConst(s.prototype,"SHOW_CDATA_SECTION",8),o.idl_defineConst(s.prototype,"SHOW_ENTITY_REFERENCE",16),o.idl_defineConst(s.prototype,"SHOW_ENTITY",32),o.idl_defineConst(s.prototype,"SHOW_PROCESSING_INSTRUCTION",64),o.idl_defineConst(s.prototype,"SHOW_COMMENT",128),o.idl_defineConst(s.prototype,"SHOW_DOCUMENT",256),o.idl_defineConst(s.prototype,"SHOW_DOCUMENT_TYPE",512),o.idl_defineConst(s.prototype,"SHOW_DOCUMENT_FRAGMENT",1024),o.idl_defineConst(s.prototype,"SHOW_NOTATION",2048)},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=(function(){function o(s,l,c,f,u,d,h,p,g){this._type=s,this._target=l,this._addedNodes=c,this._removedNodes=f,this._previousSibling=u,this._nextSibling=d,this._attributeName=h,this._attributeNamespace=p,this._oldValue=g}return Object.defineProperty(o.prototype,"type",{get:function(){return this._type},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"target",{get:function(){return this._target},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"addedNodes",{get:function(){return this._addedNodes},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"removedNodes",{get:function(){return this._removedNodes},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"previousSibling",{get:function(){return this._previousSibling},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"nextSibling",{get:function(){return this._nextSibling},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"attributeName",{get:function(){return this._attributeName},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"attributeNamespace",{get:function(){return this._attributeNamespace},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"oldValue",{get:function(){return this._oldValue},enumerable:!0,configurable:!0}),o._create=function(s,l,c,f,u,d,h,p,g){return new o(s,l,c,f,u,d,h,p,g)},o})();r.MutationRecordImpl=a},function(n,r,i){var a=this&&this.__values||function(u){var d=typeof Symbol=="function"&&Symbol.iterator,h=d&&u[d],p=0;if(h)return h.call(u);if(u&&typeof u.length=="number")return{next:function(){return u&&p>=u.length&&(u=void 0),{value:u&&u[p++],done:!u}}};throw new TypeError(d?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var o=i(6),s=i(9),l=i(7),c=i(0),f=(function(){function u(d,h){this._element=d,this._attribute=h,this._tokenSet=new Set;var p=h._localName,g=c.element_getAnAttributeValue(d,p),m=this;this._element._attributeChangeSteps.push((function(y,v,x,w,S){v===m._attribute._localName&&S===null&&(w?m._tokenSet=c.orderedSet_parse(w):m._tokenSet.clear())})),o.dom.features.steps&&c.dom_runAttributeChangeSteps(d,p,g,g,null)}return Object.defineProperty(u.prototype,"length",{get:function(){return this._tokenSet.size},enumerable:!0,configurable:!0}),u.prototype.item=function(d){var h,p,g=0;try{for(var m=a(this._tokenSet),y=m.next();!y.done;y=m.next()){var v=y.value;if(g===d)return v;g++}}catch(x){h={error:x}}finally{try{y&&!y.done&&(p=m.return)&&p.call(m)}finally{if(h)throw h.error}}return null},u.prototype.contains=function(d){return this._tokenSet.has(d)},u.prototype.add=function(){for(var d,h,p=[],g=0;g<arguments.length;g++)p[g]=arguments[g];try{for(var m=a(p),y=m.next();!y.done;y=m.next()){var v=y.value;if(v==="")throw new s.SyntaxError("Cannot add an empty token.");if(l.codePoint.ASCIIWhiteSpace.test(v))throw new s.InvalidCharacterError("Token cannot contain whitespace.");this._tokenSet.add(v)}}catch(x){d={error:x}}finally{try{y&&!y.done&&(h=m.return)&&h.call(m)}finally{if(d)throw d.error}}c.tokenList_updateSteps(this)},u.prototype.remove=function(){for(var d,h,p=[],g=0;g<arguments.length;g++)p[g]=arguments[g];try{for(var m=a(p),y=m.next();!y.done;y=m.next()){var v=y.value;if(v==="")throw new s.SyntaxError("Cannot remove an empty token.");if(l.codePoint.ASCIIWhiteSpace.test(v))throw new s.InvalidCharacterError("Token cannot contain whitespace.");this._tokenSet.delete(v)}}catch(x){d={error:x}}finally{try{y&&!y.done&&(h=m.return)&&h.call(m)}finally{if(d)throw d.error}}c.tokenList_updateSteps(this)},u.prototype.toggle=function(d,h){if(h===void 0&&(h=void 0),d==="")throw new s.SyntaxError("Cannot toggle an empty token.");if(l.codePoint.ASCIIWhiteSpace.test(d))throw new s.InvalidCharacterError("Token cannot contain whitespace.");return this._tokenSet.has(d)?h!==void 0&&h!==!1||(this._tokenSet.delete(d),c.tokenList_updateSteps(this),!1):(h===void 0||h===!0)&&(this._tokenSet.add(d),c.tokenList_updateSteps(this),!0)},u.prototype.replace=function(d,h){if(d===""||h==="")throw new s.SyntaxError("Cannot replace an empty token.");if(l.codePoint.ASCIIWhiteSpace.test(d)||l.codePoint.ASCIIWhiteSpace.test(h))throw new s.InvalidCharacterError("Token cannot contain whitespace.");return!!this._tokenSet.has(d)&&(l.set.replace(this._tokenSet,d,h),c.tokenList_updateSteps(this),!0)},u.prototype.supports=function(d){return c.tokenList_validationSteps(this,d)},Object.defineProperty(u.prototype,"value",{get:function(){return c.tokenList_serializeSteps(this)},set:function(d){c.element_setAnAttributeValue(this._element,this._attribute._localName,d)},enumerable:!0,configurable:!0}),u.prototype[Symbol.iterator]=function(){var d=this._tokenSet[Symbol.iterator]();return{next:function(){return d.next()}}},u._create=function(d,h){return new u(d,h)},u})();r.DOMTokenListImpl=f},function(n,r,i){var a,o=this&&this.__extends||(a=function(f,u){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,h){d.__proto__=h}||function(d,h){for(var p in h)h.hasOwnProperty(p)&&(d[p]=h[p])})(f,u)},function(f,u){function d(){this.constructor=f}a(f,u),f.prototype=u===null?Object.create(u):(d.prototype=u.prototype,new d)});Object.defineProperty(r,"__esModule",{value:!0});var s=i(104),l=i(0),c=(function(f){function u(d,h){var p=f.call(this,d,h)||this;return p._detail=null,p._detail=h&&h.detail||null,p}return o(u,f),Object.defineProperty(u.prototype,"detail",{get:function(){return this._detail},enumerable:!0,configurable:!0}),u.prototype.initCustomEvent=function(d,h,p,g){h===void 0&&(h=!1),p===void 0&&(p=!1),g===void 0&&(g=null),this._dispatchFlag||(l.event_initialize(this,d,h,p),this._detail=g)},u})(s.EventImpl);r.CustomEventImpl=c},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(6),o=i(2),s=i(105),l=i(17);r.nodeIterator_traverse=function(c,f){for(var u=c._reference,d=c._pointerBeforeReference;;){if(f)if(d)d=!1;else{var h=l.tree_getFollowingNode(c._root,u);if(!h)return null;u=h}else if(d){var p=l.tree_getPrecedingNode(c.root,u);if(!p)return null;u=p}else d=!0;if(s.traversal_filter(c,u)===o.FilterResult.Accept)break}return c._reference=u,c._pointerBeforeReference=d,u},r.nodeIterator_iteratorList=function(){return a.dom.window._iteratorList}},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(9),o=i(7),s=i(174);function l(c){if(!s.xml_isName(c))throw new a.InvalidCharacterError("Invalid XML name: "+c);if(!s.xml_isQName(c))throw new a.InvalidCharacterError("Invalid XML qualified name: "+c+".")}r.namespace_validate=l,r.namespace_validateAndExtract=function(c,f){c||(c=null),l(f);var u=f.split(":"),d=u.length===2?u[0]:null,h=u.length===2?u[1]:f;if(d&&c===null)throw new a.NamespaceError("Qualified name includes a prefix but the namespace is null.");if(d==="xml"&&c!==o.namespace.XML)throw new a.NamespaceError('Qualified name includes the "xml" prefix but the namespace is not the XML namespace.');if(c!==o.namespace.XMLNS&&(d==="xmlns"||f==="xmlns"))throw new a.NamespaceError('Qualified name includes the "xmlns" prefix but the namespace is not the XMLNS namespace.');if(c===o.namespace.XMLNS&&d!=="xmlns"&&f!=="xmlns")throw new a.NamespaceError('Qualified name does not include the "xmlns" prefix but the namespace is the XMLNS namespace.');return[c,d,h]},r.namespace_extractQName=function(c){l(c);var f=c.split(":");return[f.length===2?f[0]:null,f.length===2?f[1]:c]}},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.xml_isName=function(a){for(var o=0;o<a.length;o++){var s=a.charCodeAt(o);if(!(s>=97&&s<=122||s>=65&&s<=90||s===58||s===95||s>=192&&s<=214||s>=216&&s<=246||s>=248&&s<=767||s>=880&&s<=893||s>=895&&s<=8191||s>=8204&&s<=8205||s>=8304&&s<=8591||s>=11264&&s<=12271||s>=12289&&s<=55295||s>=63744&&s<=64975||s>=65008&&s<=65533)&&(o===0||!(s===45||s===46||s>=48&&s<=57||s===183||s>=768&&s<=879||s>=8255&&s<=8256))){if(s>=55296&&s<=56319&&o<a.length-1){var l=a.charCodeAt(o+1);if(l>=56320&&l<=57343&&(o++,(s=1024*(s-55296)+l-56320+65536)>=65536&&s<=983039))continue}return!1}}return!0},r.xml_isQName=function(a){for(var o=!1,s=0;s<a.length;s++){var l=a.charCodeAt(s);if(!(l>=97&&l<=122||l>=65&&l<=90||l===95||l>=192&&l<=214||l>=216&&l<=246||l>=248&&l<=767||l>=880&&l<=893||l>=895&&l<=8191||l>=8204&&l<=8205||l>=8304&&l<=8591||l>=11264&&l<=12271||l>=12289&&l<=55295||l>=63744&&l<=64975||l>=65008&&l<=65533)&&(s===0||!(l===45||l===46||l>=48&&l<=57||l===183||l>=768&&l<=879||l>=8255&&l<=8256))){if(s===0||l!==58){if(l>=55296&&l<=56319&&s<a.length-1){var c=a.charCodeAt(s+1);if(c>=56320&&c<=57343&&(s++,(l=1024*(l-55296)+c-56320+65536)>=65536&&l<=983039))continue}return!1}if(o||s===a.length-1)return!1;o=!0}}return!0},r.xml_isLegalChar=function(a){for(var o=0;o<a.length;o++){var s=a.charCodeAt(o);if(!(s===9||s===10||s===13||s>=32&&s<=55295||s>=57344&&s<=65533)){if(s>=55296&&s<=56319&&o<a.length-1){var l=a.charCodeAt(o+1);if(l>=56320&&l<=57343&&(o++,(s=1024*(s-55296)+l-56320+65536)>=65536&&s<=1114111))continue}return!1}}return!0},r.xml_isPubidChar=function(a){for(var o=0;o<a.length;o++){var s=a.charCodeAt(o);if(!(s>=97&&s<=122||s>=65&&s<=90||s>=39&&s<=59||s===32||s===13||s===10||s>=35&&s<=37||s===33||s===61||s===63||s===64||s===95))return!1}return!0}},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(2),o=i(17);r.boundaryPoint_position=function s(l,c){var f=l[0],u=l[1],d=c[0],h=c[1];if(console.assert(o.tree_rootNode(f)===o.tree_rootNode(d),"Boundary points must share the same root node."),f===d)return u===h?a.BoundaryPosition.Equal:u<h?a.BoundaryPosition.Before:a.BoundaryPosition.After;if(o.tree_isFollowing(d,f)){var p=s([d,h],[f,u]);if(p===a.BoundaryPosition.Before)return a.BoundaryPosition.After;if(p===a.BoundaryPosition.After)return a.BoundaryPosition.Before}if(o.tree_isAncestorOf(d,f)){for(var g=d;!o.tree_isChildOf(f,g);)g._parent!==null&&(g=g._parent);if(o.tree_index(g)<u)return a.BoundaryPosition.After}return a.BoundaryPosition.Before}},function(n,r,i){var a=this&&this.__values||function(p){var g=typeof Symbol=="function"&&Symbol.iterator,m=g&&p[g],y=0;if(m)return m.call(p);if(p&&typeof p.length=="number")return{next:function(){return p&&y>=p.length&&(p=void 0),{value:p&&p[y++],done:!p}}};throw new TypeError(g?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var o=i(6),s=i(3),l=i(7),c=i(29),f=i(108),u=i(30),d=i(37),h=i(52);r.node_stringReplaceAll=function(p,g){var m=null;p!==""&&(m=c.create_text(g._nodeDocument,p)),d.mutation_replaceAll(m,g)},r.node_clone=function p(g,m,y){var v,x,w,S,T;if(m===void 0&&(m=null),y===void 0&&(y=!1),m===null&&(m=g._nodeDocument),s.Guard.isElementNode(g)){T=h.element_createAnElement(m,g._localName,g._namespace,g._namespacePrefix,g._is,!1);try{for(var _=a(g._attributeList),D=_.next();!D.done;D=_.next()){var I=p(D.value,m);h.element_append(I,T)}}catch(B){v={error:B}}finally{try{D&&!D.done&&(x=_.return)&&x.call(_)}finally{if(v)throw v.error}}}else if(s.Guard.isDocumentNode(g)){var R=c.create_document();R._encoding=g._encoding,R._contentType=g._contentType,R._URL=g._URL,R._origin=g._origin,R._type=g._type,R._mode=g._mode,T=R}else if(s.Guard.isDocumentTypeNode(g))T=c.create_documentType(m,g._name,g._publicId,g._systemId);else if(s.Guard.isAttrNode(g)){var O=c.create_attr(m,g.localName);O._namespace=g._namespace,O._namespacePrefix=g._namespacePrefix,O._value=g._value,T=O}else T=s.Guard.isExclusiveTextNode(g)?c.create_text(m,g._data):s.Guard.isCDATASectionNode(g)?c.create_cdataSection(m,g._data):s.Guard.isCommentNode(g)?c.create_comment(m,g._data):s.Guard.isProcessingInstructionNode(g)?c.create_processingInstruction(m,g._target,g._data):s.Guard.isDocumentFragmentNode(g)?c.create_documentFragment(m):Object.create(g);if(s.Guard.isDocumentNode(T)?(T._nodeDocument=T,m=T):T._nodeDocument=m,o.dom.features.steps&&u.dom_runCloningSteps(T,g,m,y),y)try{for(var P=a(g._children),N=P.next();!N.done;N=P.next()){var A=p(N.value,m,!0);d.mutation_append(A,T)}}catch(B){w={error:B}}finally{try{N&&!N.done&&(S=P.return)&&S.call(P)}finally{if(w)throw w.error}}return T},r.node_equals=function p(g,m){var y,v,x,w;if(g._nodeType!==m._nodeType)return!1;if(s.Guard.isDocumentTypeNode(g)&&s.Guard.isDocumentTypeNode(m)){if(g._name!==m._name||g._publicId!==m._publicId||g._systemId!==m._systemId)return!1}else if(s.Guard.isElementNode(g)&&s.Guard.isElementNode(m)){if(g._namespace!==m._namespace||g._namespacePrefix!==m._namespacePrefix||g._localName!==m._localName||g._attributeList.length!==m._attributeList.length)return!1}else if(s.Guard.isAttrNode(g)&&s.Guard.isAttrNode(m)){if(g._namespace!==m._namespace||g._localName!==m._localName||g._value!==m._value)return!1}else if(s.Guard.isProcessingInstructionNode(g)&&s.Guard.isProcessingInstructionNode(m)){if(g._target!==m._target||g._data!==m._data)return!1}else if(s.Guard.isCharacterDataNode(g)&&s.Guard.isCharacterDataNode(m)&&g._data!==m._data)return!1;if(s.Guard.isElementNode(g)&&s.Guard.isElementNode(m)){var S={};try{for(var T=a(g._attributeList),_=T.next();!_.done;_=T.next())S[(R=_.value)._localName]=R}catch(V){y={error:V}}finally{try{_&&!_.done&&(v=T.return)&&v.call(T)}finally{if(y)throw y.error}}try{for(var D=a(m._attributeList),I=D.next();!I.done;I=D.next()){var R,O=I.value;if(!(R=S[O._localName])||!p(R,O))return!1}}catch(V){x={error:V}}finally{try{I&&!I.done&&(w=D.return)&&w.call(D)}finally{if(x)throw x.error}}}if(g._children.size!==m._children.size)return!1;for(var P=g._children[Symbol.iterator](),N=m._children[Symbol.iterator](),A=P.next(),B=N.next();!A.done&&!B.done;){if(!p(A.value,B.value))return!1;A=P.next(),B=N.next()}return!0},r.node_listOfElementsWithQualifiedName=function(p,g){return p==="*"?c.create_htmlCollection(g):g._nodeDocument._type==="html"?c.create_htmlCollection(g,(function(m){return m._namespace===l.namespace.HTML&&m._qualifiedName===p.toLowerCase()||m._namespace!==l.namespace.HTML&&m._qualifiedName===p})):c.create_htmlCollection(g,(function(m){return m._qualifiedName===p}))},r.node_listOfElementsWithNamespace=function(p,g,m){return p===""&&(p=null),p==="*"&&g==="*"?c.create_htmlCollection(m):p==="*"?c.create_htmlCollection(m,(function(y){return y._localName===g})):g==="*"?c.create_htmlCollection(m,(function(y){return y._namespace===p})):c.create_htmlCollection(m,(function(y){return y._localName===g&&y._namespace===p}))},r.node_listOfElementsWithClassNames=function(p,g){var m=f.orderedSet_parse(p);if(m.size===0)return c.create_htmlCollection(g,(function(){return!1}));var y=g._nodeDocument._mode!=="quirks";return c.create_htmlCollection(g,(function(v){var x=v.classList;return f.orderedSet_contains(x._tokenSet,m,y)}))},r.node_locateANamespacePrefix=function p(g,m){if(g._namespace===m&&g._namespacePrefix!==null)return g._namespacePrefix;for(var y=0;y<g._attributeList.length;y++){var v=g._attributeList[y];if(v._namespacePrefix==="xmlns"&&v._value===m)return v._localName}return g._parent&&s.Guard.isElementNode(g._parent)?p(g._parent,m):null},r.node_locateANamespace=function p(g,m){if(s.Guard.isElementNode(g)){if(g._namespace!==null&&g._namespacePrefix===m)return g._namespace;for(var y=0;y<g._attributeList.length;y++){var v=g._attributeList[y];if(v._namespace===l.namespace.XMLNS&&v._namespacePrefix==="xmlns"&&v._localName===m||m===null&&v._namespace===l.namespace.XMLNS&&v._namespacePrefix===null&&v._localName==="xmlns")return v._value||null}return g.parentElement===null?null:p(g.parentElement,m)}return s.Guard.isDocumentNode(g)?g.documentElement===null?null:p(g.documentElement,m):s.Guard.isDocumentTypeNode(g)||s.Guard.isDocumentFragmentNode(g)?null:s.Guard.isAttrNode(g)?g._element===null?null:p(g._element,m):g._parent&&s.Guard.isElementNode(g._parent)?p(g._parent,m):null}},function(n,r,i){var a=this&&this.__values||function(h){var p=typeof Symbol=="function"&&Symbol.iterator,g=p&&h[p],m=0;if(g)return g.call(h);if(h&&typeof h.length=="number")return{next:function(){return h&&m>=h.length&&(h=void 0),{value:h&&h[m++],done:!h}}};throw new TypeError(p?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var o=i(6),s=i(3),l=i(9),c=i(29),f=i(17),u=i(107),d=i(37);r.text_contiguousTextNodes=function(h,p){var g;return p===void 0&&(p=!1),(g={})[Symbol.iterator]=function(){for(var m=h;m&&s.Guard.isTextNode(m._previousSibling);)m=m._previousSibling;return{next:function(){if(m&&!p&&m===h&&(m=s.Guard.isTextNode(m._nextSibling)?m._nextSibling:null),m===null)return{done:!0,value:null};var y={done:!1,value:m};return m=s.Guard.isTextNode(m._nextSibling)?m._nextSibling:null,y}}},g},r.text_contiguousExclusiveTextNodes=function(h,p){var g;return p===void 0&&(p=!1),(g={})[Symbol.iterator]=function(){for(var m=h;m&&s.Guard.isExclusiveTextNode(m._previousSibling);)m=m._previousSibling;return{next:function(){if(m&&!p&&m===h&&(m=s.Guard.isExclusiveTextNode(m._nextSibling)?m._nextSibling:null),m===null)return{done:!0,value:null};var y={done:!1,value:m};return m=s.Guard.isExclusiveTextNode(m._nextSibling)?m._nextSibling:null,y}}},g},r.text_descendantTextContent=function(h){for(var p="",g=f.tree_getFirstDescendantNode(h,!1,!1,(function(m){return s.Guard.isTextNode(m)}));g!==null;)p+=g._data,g=f.tree_getNextDescendantNode(h,g,!1,!1,(function(m){return s.Guard.isTextNode(m)}));return p},r.text_split=function(h,p){var g,m,y=h._data.length;if(p>y)throw new l.IndexSizeError;var v=y-p,x=u.characterData_substringData(h,p,v),w=c.create_text(h._nodeDocument,x),S=h._parent;if(S!==null){d.mutation_insert(w,S,h._nextSibling);try{for(var T=a(o.dom.rangeList),_=T.next();!_.done;_=T.next()){var D=_.value;D._start[0]===h&&D._start[1]>p&&(D._start[0]=w,D._start[1]-=p),D._end[0]===h&&D._end[1]>p&&(D._end[0]=w,D._end[1]-=p);var I=f.tree_index(h);D._start[0]===S&&D._start[1]===I+1&&D._start[1]++,D._end[0]===S&&D._end[1]===I+1&&D._end[1]++}}catch(R){g={error:R}}finally{try{_&&!_.done&&(m=T.return)&&m.call(T)}finally{if(g)throw g.error}}}return u.characterData_replaceData(h,p,v,""),w}},function(n,r,i){var a=i(4),o=i(41),s=i(24),l=i(48),c=[].join,f=o!=Object,u=l("join",",");a({target:"Array",proto:!0,forced:f||!u},{join:function(d){return c.call(s(this),d===void 0?",":d)}})},function(n,r,i){var a=i(4),o=i(83),s=String.fromCharCode,l=String.fromCodePoint;a({target:"String",stat:!0,forced:!!l&&l.length!=1},{fromCodePoint:function(c){for(var f,u=[],d=arguments.length,h=0;d>h;){if(f=+arguments[h++],o(f,1114111)!==f)throw RangeError(f+" is not a valid code point");u.push(f<65536?s(f):s(55296+((f-=65536)>>10),f%1024+56320))}return u.join("")}})},function(n,r,i){var a=this&&this.__read||function(l,c){var f=typeof Symbol=="function"&&l[Symbol.iterator];if(!f)return l;var u,d,h=f.call(l),p=[];try{for(;(c===void 0||c-- >0)&&!(u=h.next()).done;)p.push(u.value)}catch(g){d={error:g}}finally{try{u&&!u.done&&(f=h.return)&&f.call(h)}finally{if(d)throw d.error}}return p};Object.defineProperty(r,"__esModule",{value:!0});var o=i(111),s=(function(){function l(c,f){this._options={skipWhitespaceOnlyText:!1},this.err={line:-1,col:-1,index:-1,str:""},this._str=c,this._index=0,this._length=c.length,f&&(this._options.skipWhitespaceOnlyText=f.skipWhitespaceOnlyText||!1)}return l.prototype.nextToken=function(){if(this.eof())return{type:o.TokenType.EOF};var c=this.skipIfStartsWith("<")?this.openBracket():this.text();return this._options.skipWhitespaceOnlyText&&c.type===o.TokenType.Text&&l.isWhiteSpaceToken(c)&&(c=this.nextToken()),c},l.prototype.openBracket=function(){return this.skipIfStartsWith("?")?this.skipIfStartsWith("xml")?l.isSpace(this._str[this._index])?this.declaration():(this.seek(-3),this.pi()):this.pi():this.skipIfStartsWith("!")?this.skipIfStartsWith("--")?this.comment():this.skipIfStartsWith("[CDATA[")?this.cdata():this.skipIfStartsWith("DOCTYPE")?this.doctype():void this.throwError("Invalid '!' in opening tag."):this.skipIfStartsWith("/")?this.closeTag():this.openTag()},l.prototype.declaration=function(){for(var c="",f="",u="";!this.eof();){if(this.skipSpace(),this.skipIfStartsWith("?>"))return{type:o.TokenType.Declaration,version:c,encoding:f,standalone:u};var d=a(this.attribute(),2),h=d[0],p=d[1];h==="version"?c=p:h==="encoding"?f=p:h==="standalone"?u=p:this.throwError("Invalid attribute name: "+h)}this.throwError("Missing declaration end symbol `?>`")},l.prototype.doctype=function(){var c="",f="";this.skipSpace();var u=this.takeUntil2("[",">",!0);return this.skipSpace(),this.skipIfStartsWith("PUBLIC")?(c=this.quotedString(),f=this.quotedString()):this.skipIfStartsWith("SYSTEM")&&(f=this.quotedString()),this.skipSpace(),this.skipIfStartsWith("[")&&(this.skipUntil("]"),this.skipIfStartsWith("]")||this.throwError("Missing end bracket of DTD internal subset")),this.skipSpace(),this.skipIfStartsWith(">")||this.throwError("Missing doctype end symbol `>`"),{type:o.TokenType.DocType,name:u,pubId:c,sysId:f}},l.prototype.pi=function(){var c=this.takeUntilStartsWith("?>",!0);if(this.eof()&&this.throwError("Missing processing instruction end symbol `?>`"),this.skipSpace(),this.skipIfStartsWith("?>"))return{type:o.TokenType.PI,target:c,data:""};var f=this.takeUntilStartsWith("?>");return this.eof()&&this.throwError("Missing processing instruction end symbol `?>`"),this.seek(2),{type:o.TokenType.PI,target:c,data:f}},l.prototype.text=function(){var c=this.takeUntil("<");return{type:o.TokenType.Text,data:c}},l.prototype.comment=function(){var c=this.takeUntilStartsWith("-->");return this.eof()&&this.throwError("Missing comment end symbol `-->`"),this.seek(3),{type:o.TokenType.Comment,data:c}},l.prototype.cdata=function(){var c=this.takeUntilStartsWith("]]>");return this.eof()&&this.throwError("Missing CDATA end symbol `]>`"),this.seek(3),{type:o.TokenType.CDATA,data:c}},l.prototype.openTag=function(){this.skipSpace();var c=this.takeUntil2(">","/",!0);if(this.skipSpace(),this.skipIfStartsWith(">"))return{type:o.TokenType.Element,name:c,attributes:[],selfClosing:!1};if(this.skipIfStartsWith("/>"))return{type:o.TokenType.Element,name:c,attributes:[],selfClosing:!0};for(var f=[];!this.eof();){if(this.skipSpace(),this.skipIfStartsWith(">"))return{type:o.TokenType.Element,name:c,attributes:f,selfClosing:!1};if(this.skipIfStartsWith("/>"))return{type:o.TokenType.Element,name:c,attributes:f,selfClosing:!0};var u=this.attribute();f.push(u)}this.throwError("Missing opening element tag end symbol `>`")},l.prototype.closeTag=function(){this.skipSpace();var c=this.takeUntil(">",!0);return this.skipSpace(),this.skipIfStartsWith(">")||this.throwError("Missing closing element tag end symbol `>`"),{type:o.TokenType.ClosingTag,name:c}},l.prototype.attribute=function(){this.skipSpace();var c=this.takeUntil("=",!0);return this.skipSpace(),this.skipIfStartsWith("=")||this.throwError("Missing equals sign before attribute value"),[c,this.quotedString()]},l.prototype.quotedString=function(){this.skipSpace();var c=this.take(1);l.isQuote(c)||this.throwError("Missing start quote character before quoted value");var f=this.takeUntil(c);return this.skipIfStartsWith(c)||this.throwError("Missing end quote character after quoted value"),f},l.prototype.eof=function(){return this._index>=this._length},l.prototype.skipIfStartsWith=function(c){var f=c.length;if(f===1)return this._str[this._index]===c&&(this._index++,!0);for(var u=0;u<f;u++)if(this._str[this._index+u]!==c[u])return!1;return this._index+=f,!0},l.prototype.seek=function(c){this._index+=c,this._index<0&&(this._index=0),this._index>this._length&&(this._index=this._length)},l.prototype.skipSpace=function(){for(;!this.eof()&&l.isSpace(this._str[this._index]);)this._index++},l.prototype.take=function(c){if(c===1)return this._str[this._index++];var f=this._index;return this.seek(c),this._str.slice(f,this._index)},l.prototype.takeUntil=function(c,f){f===void 0&&(f=!1);for(var u=this._index;this._index<this._length;){var d=this._str[this._index];if(d===c||f&&l.isSpace(d))break;this._index++}return this._str.slice(u,this._index)},l.prototype.takeUntil2=function(c,f,u){u===void 0&&(u=!1);for(var d=this._index;this._index<this._length;){var h=this._str[this._index];if(h===c||h===f||u&&l.isSpace(h))break;this._index++}return this._str.slice(d,this._index)},l.prototype.takeUntilStartsWith=function(c,f){f===void 0&&(f=!1);for(var u=this._index,d=c.length;this._index<this._length;){for(var h=!0,p=0;p<d;p++){var g=this._str[this._index+p],m=c[p];if(f&&l.isSpace(g))return this._str.slice(u,this._index);if(g!==m){this._index++,h=!1;break}}if(h)return this._str.slice(u,this._index)}return this._index=this._length,this._str.slice(u)},l.prototype.skipUntil=function(c){for(;this._index<this._length&&this._str[this._index]!==c;)this._index++},l.isWhiteSpaceToken=function(c){for(var f=c.data,u=0;u<f.length;u++){var d=f[u];if(d!==" "&&d!==`
`&&d!=="\r"&&d!=="	"&&d!=="\f")return!1}return!0},l.isSpace=function(c){return c===" "||c===`
`||c==="\r"||c==="	"},l.isQuote=function(c){return c==='"'||c==="'"},l.prototype.throwError=function(c){for(var f=/\r\n|\r|\n/g,u=null,d=0,h=0,p=this._str.length;(u=f.exec(this._str))!==null&&u!==null;)if(d++,u.index<this._index&&(h=f.lastIndex),u.index>this._index){p=u.index;break}throw this.err={line:d,col:this._index-h,index:this._index,str:this._str.substring(h,p)},new Error(c+`
Index: `+this.err.index+`
Ln: `+this.err.line+", Col: "+this.err.col+`
Input: `+this.err.str)},l.prototype[Symbol.iterator]=function(){return this._index=0,{next:(function(){var c=this.nextToken();return c.type===o.TokenType.EOF?{done:!0,value:null}:{done:!1,value:c}}).bind(this)}},l})();r.XMLStringLexer=s},function(n,r,i){var a=i(39);n.exports=new a({include:[i(182)]})},function(n,r,i){var a=i(39);n.exports=new a({include:[i(113)],implicit:[i(289),i(290),i(291),i(292)]})},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(91),o=i(1),s=i(3),l=i(77),c=i(109);function f(p,g){var m=d(p===void 0||u(p)?p:a.DefaultBuilderOptions),y=u(p)?g:p,v=c.createDocument();h(v,m);var x=new l.XMLBuilderImpl(v);return y!==void 0&&x.ele(y),x}function u(p){if(!o.isPlainObject(p))return!1;for(var g in p)if(p.hasOwnProperty(g)&&!a.XMLBuilderOptionKeys.has(g))return!1;return!0}function d(p){p===void 0&&(p={});var g=o.applyDefaults(p,a.DefaultBuilderOptions);if(g.convert.att.length===0||g.convert.ins.length===0||g.convert.text.length===0||g.convert.cdata.length===0||g.convert.comment.length===0)throw new Error("JS object converter strings cannot be zero length.");return g}function h(p,g,m){var y=p;y._xmlBuilderOptions=g,y._isFragment=m}r.builder=function(p,g){var m=d(u(p)?p:a.DefaultBuilderOptions),y=s.Guard.isNode(p)||o.isArray(p)?p:g;if(y===void 0)throw new Error("Invalid arguments.");if(o.isArray(y)){for(var v=[],x=0;x<y.length;x++){var w=new l.XMLBuilderImpl(y[x]);w.set(m),v.push(w)}return v}var S=new l.XMLBuilderImpl(y);return S.set(m),S},r.create=f,r.fragment=function(p,g){var m=d(p===void 0||u(p)?p:a.DefaultBuilderOptions),y=u(p)?g:p,v=c.createDocument();h(v,m,!0);var x=new l.XMLBuilderImpl(v.createDocumentFragment());return y!==void 0&&x.ele(y),x},r.convert=function(p,g,m){var y,v,x;return u(p)&&g!==void 0?(y=p,v=g,x=m):(y=a.DefaultBuilderOptions,v=p,x=g||void 0),f(y,v).end(x)}},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(77);r.builder=a.builder,r.create=a.create,r.fragment=a.fragment,r.convert=a.convert,r.createCB=a.createCB,r.fragmentCB=a.fragmentCB},function(n,r,i){i(31),i(32),i(33),i(191),i(192),i(194),i(64),i(19),i(198),i(199),i(89),i(201),i(65),i(20),i(66),i(22),i(23);var a=this&&this.__read||function(y,v){var x=typeof Symbol=="function"&&y[Symbol.iterator];if(!x)return y;var w,S,T=x.call(y),_=[];try{for(;(v===void 0||v-- >0)&&!(w=T.next()).done;)_.push(w.value)}catch(D){S={error:D}}finally{try{w&&!w.done&&(x=T.return)&&x.call(T)}finally{if(S)throw S.error}}return _},o=this&&this.__values||function(y){var v=typeof Symbol=="function"&&Symbol.iterator,x=v&&y[v],w=0;if(x)return x.call(y);if(y&&typeof y.length=="number")return{next:function(){return y&&w>=y.length&&(y=void 0),{value:y&&y[w++],done:!y}}};throw new TypeError(v?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var s=i(91),l=i(1),c=i(217),f=i(2),u=i(3),d=i(0),h=i(109),p=i(7),g=i(276),m=(function(){function y(v){this._domNode=v}return Object.defineProperty(y.prototype,"node",{get:function(){return this._domNode},enumerable:!0,configurable:!0}),Object.defineProperty(y.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0}),y.prototype.set=function(v){return this._options=l.applyDefaults(l.applyDefaults(this._options,v,!0),s.DefaultBuilderOptions),this},y.prototype.ele=function(v,x,w){var S,T,_,D,I,R;if(l.isObject(v))return new g.ObjectReader(this._options).parse(this,v);if(v!==null&&/^\s*</.test(v))return new g.XMLReader(this._options).parse(this,v);if(v!==null&&/^\s*[\{\[]/.test(v))return new g.JSONReader(this._options).parse(this,v);if(v!==null&&/^(\s*|(#.*)|(%.*))*---/.test(v))return new g.YAMLReader(this._options).parse(this,v);if((v===null||l.isString(v))&&l.isString(x))D=(S=a([v,x,w],3))[0],I=S[1],R=S[2];else{if(v===null)throw new Error("Element name cannot be null. "+this._debugInfo());D=(T=a([void 0,v,l.isObject(x)?x:void 0],3))[0],I=T[1],R=T[2]}if(R&&(R=l.getValue(R)),D=(_=a(this._extractNamespace(h.sanitizeInput(D,this._options.invalidCharReplacement),h.sanitizeInput(I,this._options.invalidCharReplacement),!0),2))[0],I=_[1],D===void 0){var O=a(d.namespace_extractQName(I),1)[0];D=this.node.lookupNamespaceURI(O)}var P=D!=null?this._doc.createElementNS(D,I):this._doc.createElement(I);this.node.appendChild(P);var N=new y(P),A=this._doc.doctype;if(P===this._doc.documentElement&&A!==null){var B=this._doc.implementation.createDocumentType(this._doc.documentElement.tagName,A.publicId,A.systemId);this._doc.replaceChild(B,A)}return R&&!l.isEmpty(R)&&N.att(R),N},y.prototype.remove=function(){var v=this.up();return v.node.removeChild(this.node),v},y.prototype.att=function(v,x,w){var S,T,_,D,I,R,O=this;if(l.isMap(v)||l.isObject(v))return l.forEachObject(v,(function(U,G){return O.att(U,G)}),this),this;if(v!=null&&(v=l.getValue(v+"")),x!=null&&(x=l.getValue(x+"")),w!=null&&(w=l.getValue(w+"")),v!==null&&!l.isString(v)||!l.isString(x)||w!==null&&!l.isString(w)){if(!l.isString(v)||x!=null&&!l.isString(x))throw new Error("Attribute name and value not specified. "+this._debugInfo());D=(T=a([void 0,v,x],3))[0],I=T[1],R=T[2]}else D=(S=a([v,x,w],3))[0],I=S[1],R=S[2];if(this._options.keepNullAttributes&&R==null)R="";else if(R==null)return this;if(!u.Guard.isElementNode(this.node))throw new Error("An attribute can only be assigned to an element node.");var P=this.node;D=(_=a(this._extractNamespace(D,I,!1),2))[0],I=_[1],I=h.sanitizeInput(I,this._options.invalidCharReplacement),D=h.sanitizeInput(D,this._options.invalidCharReplacement),R=h.sanitizeInput(R,this._options.invalidCharReplacement);var N=a(d.namespace_extractQName(I),2),A=N[0],B=N[1],V=a(d.namespace_extractQName(P.prefix?P.prefix+":"+P.localName:P.localName),1)[0],$=null;return A==="xmlns"?(D=p.namespace.XMLNS,P.namespaceURI===null&&V===B&&($=R)):A===null&&B==="xmlns"&&V===null&&(D=p.namespace.XMLNS,$=R),$!==null&&(this._updateNamespace($),P=this.node),D!==void 0?P.setAttributeNS(D,I,R):P.setAttribute(I,R),this},y.prototype.removeAtt=function(v,x){var w,S,T=this;if(!u.Guard.isElementNode(this.node))throw new Error("An attribute can only be removed from an element node.");if(v=l.getValue(v),x!==void 0&&(x=l.getValue(x)),v!==null&&x===void 0)S=v;else{if(v!==null&&!l.isString(v)||x===void 0)throw new Error("Attribute namespace must be a string. "+this._debugInfo());w=v,S=x}return l.isArray(S)||l.isSet(S)?l.forEachArray(S,(function(_){return w===void 0?T.removeAtt(_):T.removeAtt(w,_)}),this):w!==void 0?(S=h.sanitizeInput(S,this._options.invalidCharReplacement),w=h.sanitizeInput(w,this._options.invalidCharReplacement),this.node.removeAttributeNS(w,S)):(S=h.sanitizeInput(S,this._options.invalidCharReplacement),this.node.removeAttribute(S)),this},y.prototype.txt=function(v){if(v==null){if(!this._options.keepNullNodes)return this;v=""}var x=this._doc.createTextNode(h.sanitizeInput(v,this._options.invalidCharReplacement));return this.node.appendChild(x),this},y.prototype.com=function(v){if(v==null){if(!this._options.keepNullNodes)return this;v=""}var x=this._doc.createComment(h.sanitizeInput(v,this._options.invalidCharReplacement));return this.node.appendChild(x),this},y.prototype.dat=function(v){if(v==null){if(!this._options.keepNullNodes)return this;v=""}var x=this._doc.createCDATASection(h.sanitizeInput(v,this._options.invalidCharReplacement));return this.node.appendChild(x),this},y.prototype.ins=function(v,x){var w=this;if(x===void 0&&(x=""),x==null){if(!this._options.keepNullNodes)return this;x=""}if(l.isArray(v)||l.isSet(v))l.forEachArray(v,(function(T){var _=(T+="").indexOf(" "),D=_===-1?T:T.substr(0,_),I=_===-1?"":T.substr(_+1);w.ins(D,I)}),this);else if(l.isMap(v)||l.isObject(v))l.forEachObject(v,(function(T,_){return w.ins(T,_)}),this);else{var S=this._doc.createProcessingInstruction(h.sanitizeInput(v,this._options.invalidCharReplacement),h.sanitizeInput(x,this._options.invalidCharReplacement));this.node.appendChild(S)}return this},y.prototype.dec=function(v){return this._options.version=v.version||"1.0",this._options.encoding=v.encoding,this._options.standalone=v.standalone,this},y.prototype.dtd=function(v){var x=h.sanitizeInput(v&&v.name||(this._doc.documentElement?this._doc.documentElement.tagName:"ROOT"),this._options.invalidCharReplacement),w=h.sanitizeInput(v&&v.pubID||"",this._options.invalidCharReplacement),S=h.sanitizeInput(v&&v.sysID||"",this._options.invalidCharReplacement);if(this._doc.documentElement!==null&&x!==this._doc.documentElement.tagName)throw new Error("DocType name does not match document element name.");var T=this._doc.implementation.createDocumentType(x,w,S);return this._doc.doctype!==null?this._doc.replaceChild(T,this._doc.doctype):this._doc.insertBefore(T,this._doc.documentElement),this},y.prototype.import=function(v){var x,w,S=this._domNode,T=this._doc,_=v.node;if(u.Guard.isDocumentNode(_)){var D=_.documentElement;if(D===null)throw new Error("Imported document has no document element node. "+this._debugInfo());var I=T.importNode(D,!0);S.appendChild(I);var R=a(d.namespace_extractQName(I.prefix?I.prefix+":"+I.localName:I.localName),1)[0],O=S.lookupNamespaceURI(R);new y(I)._updateNamespace(O)}else if(u.Guard.isDocumentFragmentNode(_))try{for(var P=o(_.childNodes),N=P.next();!N.done;N=P.next()){var A=N.value;I=T.importNode(A,!0),S.appendChild(I),u.Guard.isElementNode(I)&&(R=a(d.namespace_extractQName(I.prefix?I.prefix+":"+I.localName:I.localName),1)[0],O=S.lookupNamespaceURI(R),new y(I)._updateNamespace(O))}}catch(B){x={error:B}}finally{try{N&&!N.done&&(w=P.return)&&w.call(P)}finally{if(x)throw x.error}}else I=T.importNode(_,!0),S.appendChild(I),u.Guard.isElementNode(I)&&(R=a(d.namespace_extractQName(I.prefix?I.prefix+":"+I.localName:I.localName),1)[0],O=S.lookupNamespaceURI(R),new y(I)._updateNamespace(O));return this},y.prototype.doc=function(){if(this._doc._isFragment){for(var v=this.node;v&&v.nodeType!==f.NodeType.DocumentFragment;)v=v.parentNode;if(v===null)throw new Error("Node has no parent node while searching for document fragment ancestor. "+this._debugInfo());return new y(v)}return new y(this._doc)},y.prototype.root=function(){var v=this._doc.documentElement;if(!v)throw new Error("Document root element is null. "+this._debugInfo());return new y(v)},y.prototype.up=function(){var v=this._domNode.parentNode;if(!v)throw new Error("Parent node is null. "+this._debugInfo());return new y(v)},y.prototype.prev=function(){var v=this._domNode.previousSibling;if(!v)throw new Error("Previous sibling node is null. "+this._debugInfo());return new y(v)},y.prototype.next=function(){var v=this._domNode.nextSibling;if(!v)throw new Error("Next sibling node is null. "+this._debugInfo());return new y(v)},y.prototype.first=function(){var v=this._domNode.firstChild;if(!v)throw new Error("First child node is null. "+this._debugInfo());return new y(v)},y.prototype.last=function(){var v=this._domNode.lastChild;if(!v)throw new Error("Last child node is null. "+this._debugInfo());return new y(v)},y.prototype.each=function(v,x,w,S){x===void 0&&(x=!1),w===void 0&&(w=!1);for(var T=this._getFirstDescendantNode(this._domNode,x,w);T[0];){var _=this._getNextDescendantNode(this._domNode,T[0],w,T[1],T[2]);v.call(S,new y(T[0]),T[1],T[2]),T=_}return this},y.prototype.map=function(v,x,w,S){x===void 0&&(x=!1),w===void 0&&(w=!1);var T=[];return this.each((function(_,D,I){return T.push(v.call(S,_,D,I))}),x,w),T},y.prototype.reduce=function(v,x,w,S,T){w===void 0&&(w=!1),S===void 0&&(S=!1);var _=x;return this.each((function(D,I,R){return _=v.call(T,_,D,I,R)}),w,S),_},y.prototype.find=function(v,x,w,S){x===void 0&&(x=!1),w===void 0&&(w=!1);for(var T=this._getFirstDescendantNode(this._domNode,x,w);T[0];){var _=new y(T[0]);if(v.call(S,_,T[1],T[2]))return _;T=this._getNextDescendantNode(this._domNode,T[0],w,T[1],T[2])}},y.prototype.filter=function(v,x,w,S){x===void 0&&(x=!1),w===void 0&&(w=!1);var T=[];return this.each((function(_,D,I){v.call(S,_,D,I)&&T.push(_)}),x,w),T},y.prototype.every=function(v,x,w,S){x===void 0&&(x=!1),w===void 0&&(w=!1);for(var T=this._getFirstDescendantNode(this._domNode,x,w);T[0];){var _=new y(T[0]);if(!v.call(S,_,T[1],T[2]))return!1;T=this._getNextDescendantNode(this._domNode,T[0],w,T[1],T[2])}return!0},y.prototype.some=function(v,x,w,S){x===void 0&&(x=!1),w===void 0&&(w=!1);for(var T=this._getFirstDescendantNode(this._domNode,x,w);T[0];){var _=new y(T[0]);if(v.call(S,_,T[1],T[2]))return!0;T=this._getNextDescendantNode(this._domNode,T[0],w,T[1],T[2])}return!1},y.prototype.toArray=function(v,x){v===void 0&&(v=!1),x===void 0&&(x=!1);var w=[];return this.each((function(S){return w.push(S)}),v,x),w},y.prototype.toString=function(v){return(v=v||{}).format===void 0&&(v.format="xml"),this._serialize(v)},y.prototype.toObject=function(v){return(v=v||{}).format===void 0&&(v.format="object"),this._serialize(v)},y.prototype.end=function(v){return(v=v||{}).format===void 0&&(v.format="xml"),this.doc()._serialize(v)},y.prototype._getFirstDescendantNode=function(v,x,w){return x?[this._domNode,0,0]:w?this._getNextDescendantNode(v,v,w,0,0):[this._domNode.firstChild,0,1]},y.prototype._getNextDescendantNode=function(v,x,w,S,T){if(!w)return v===x?[x.firstChild,0,T+1]:[x.nextSibling,S+1,T];if(x.firstChild)return[x.firstChild,0,T+1];if(x===v)return[null,-1,-1];if(x.nextSibling)return[x.nextSibling,S+1,T];for(var _=x.parentNode;_&&_!==v;){if(_.nextSibling)return[_.nextSibling,d.tree_index(_.nextSibling),T-1];_=_.parentNode,T--}return[null,-1,-1]},y.prototype._serialize=function(v){if(v.format==="xml")return new c.XMLWriter(this._options,v).serialize(this.node);if(v.format==="map")return new c.MapWriter(this._options,v).serialize(this.node);if(v.format==="object")return new c.ObjectWriter(this._options,v).serialize(this.node);if(v.format==="json")return new c.JSONWriter(this._options,v).serialize(this.node);if(v.format==="yaml")return new c.YAMLWriter(this._options,v).serialize(this.node);throw new Error("Invalid writer format: "+v.format+". "+this._debugInfo())},y.prototype._extractNamespace=function(v,x,w){var S=x.indexOf("@");if(S>0&&(v===void 0&&(v=x.slice(S+1)),x=x.slice(0,S)),v===void 0)v=w?this._options.defaultNamespace.ele:this._options.defaultNamespace.att;else if(v!==null&&v[0]==="@"){var T=v.slice(1);if((v=this._options.namespaceAlias[T])===void 0)throw new Error("Namespace alias `"+T+"` is not defined. "+this._debugInfo())}return[v,x]},y.prototype._updateNamespace=function(v){var x,w,S,T,_=this._domNode;if(u.Guard.isElementNode(_)&&v!==null&&_.namespaceURI!==v){var D=a(d.namespace_extractQName(_.prefix?_.prefix+":"+_.localName:_.localName),2),I=D[0],R=D[1],O=d.create_element(this._doc,R,v,I);try{for(var P=o(_.attributes),N=P.next();!N.done;N=P.next()){var A=N.value,B=A.prefix?A.prefix+":"+A.localName:A.localName,V=a(d.namespace_extractQName(B),1)[0],$=A.namespaceURI;$===null&&V!==null&&($=_.lookupNamespaceURI(V)),$===null?O.setAttribute(B,A.value):O.setAttributeNS($,B,A.value)}}catch(ye){x={error:ye}}finally{try{N&&!N.done&&(w=P.return)&&w.call(P)}finally{if(x)throw x.error}}var U=_.parentNode;if(U===null)throw new Error("Parent node is null."+this._debugInfo());U.replaceChild(O,_),this._domNode=O;try{for(var G=o(_.childNodes),F=G.next();!F.done;F=G.next()){var J=F.value.cloneNode(!0);if(O.appendChild(J),u.Guard.isElementNode(J)){var Q=a(d.namespace_extractQName(J.prefix?J.prefix+":"+J.localName:J.localName),1)[0],ne=O.lookupNamespaceURI(Q);new y(J)._updateNamespace(ne)}}}catch(ye){S={error:ye}}finally{try{F&&!F.done&&(T=G.return)&&T.call(G)}finally{if(S)throw S.error}}}},Object.defineProperty(y.prototype,"_doc",{get:function(){var v=this.node;if(u.Guard.isDocumentNode(v))return v;var x=v.ownerDocument;if(!x)throw new Error("Owner document is null. "+this._debugInfo());return x},enumerable:!0,configurable:!0}),y.prototype._debugInfo=function(v){var x=this.node,w=x.parentNode;v=v||x.nodeName;var S=w?w.nodeName:"";return S?"node: <"+v+">, parent: <"+S+">":"node: <"+v+">"},Object.defineProperty(y.prototype,"_options",{get:function(){var v=this._doc;if(v._xmlBuilderOptions===void 0)throw new Error("Builder options is not set.");return v._xmlBuilderOptions},set:function(v){this._doc._xmlBuilderOptions=v},enumerable:!0,configurable:!0}),y})();r.XMLBuilderImpl=m},function(n,r,i){var a=i(11),o=i(117),s=a.WeakMap;n.exports=typeof s=="function"&&/native code/.test(o(s))},function(n,r,i){var a=i(46),o=i(82),s=i(85),l=i(18);n.exports=a("Reflect","ownKeys")||function(c){var f=o.f(l(c)),u=s.f;return u?f.concat(u(c)):f}},function(n,r,i){var a=i(16),o=i(15),s=i(18),l=i(61);n.exports=a?Object.defineProperties:function(c,f){s(c);for(var u,d=l(f),h=d.length,p=0;h>p;)o.f(c,u=d[p++],f[u]);return c}},function(n,r,i){var a=i(46);n.exports=a("document","documentElement")},function(n,r,i){var a=i(24),o=i(82).f,s={}.toString,l=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];n.exports.f=function(c){return l&&s.call(c)=="[object Window]"?(function(f){try{return o(f)}catch{return l.slice()}})(c):o(a(c))}},function(n,r,i){var a=i(4),o=i(36).every,s=i(48),l=i(28),c=s("every"),f=l("every");a({target:"Array",proto:!0,forced:!c||!f},{every:function(u){return o(this,u,arguments.length>1?arguments[1]:void 0)}})},function(n,r,i){var a=i(4),o=i(36).filter,s=i(63),l=i(28),c=s("filter"),f=l("filter");a({target:"Array",proto:!0,forced:!c||!f},{filter:function(u){return o(this,u,arguments.length>1?arguments[1]:void 0)}})},function(n,r,i){var a=i(46);n.exports=a("navigator","userAgent")||""},function(n,r,i){var a=i(4),o=i(36).find,s=i(130),l=i(28),c=!0,f=l("find");"find"in[]&&Array(1).find((function(){c=!1})),a({target:"Array",proto:!0,forced:c||!f},{find:function(u){return o(this,u,arguments.length>1?arguments[1]:void 0)}}),s("find")},function(n,r,i){var a=i(131).IteratorPrototype,o=i(60),s=i(40),l=i(62),c=i(49),f=function(){return this};n.exports=function(u,d,h){var p=d+" Iterator";return u.prototype=o(a,{next:s(1,h)}),l(u,p,!1,!0),c[p]=f,u}},function(n,r,i){var a=i(8);n.exports=!a((function(){function o(){}return o.prototype.constructor=null,Object.getPrototypeOf(new o)!==o.prototype}))},function(n,r,i){var a=i(13);n.exports=function(o){if(!a(o)&&o!==null)throw TypeError("Can't set "+String(o)+" as a prototype");return o}},function(n,r,i){var a=i(4),o=i(36).map,s=i(63),l=i(28),c=s("map"),f=l("map");a({target:"Array",proto:!0,forced:!c||!f},{map:function(u){return o(this,u,arguments.length>1?arguments[1]:void 0)}})},function(n,r,i){var a=i(4),o=i(200).left,s=i(48),l=i(28),c=s("reduce"),f=l("reduce",{1:0});a({target:"Array",proto:!0,forced:!c||!f},{reduce:function(u){return o(this,u,arguments.length,arguments.length>1?arguments[1]:void 0)}})},function(n,r,i){var a=i(127),o=i(27),s=i(41),l=i(26),c=function(f){return function(u,d,h,p){a(d);var g=o(u),m=s(g),y=l(g.length),v=f?y-1:0,x=f?-1:1;if(h<2)for(;;){if(v in m){p=m[v],v+=x;break}if(v+=x,f?v<0:y<=v)throw TypeError("Reduce of empty array with no initial value")}for(;f?v>=0:y>v;v+=x)v in m&&(p=d(p,m[v],v,g));return p}};n.exports={left:c(!1),right:c(!0)}},function(n,r,i){var a=i(4),o=i(36).some,s=i(48),l=i(28),c=s("some"),f=l("some");a({target:"Array",proto:!0,forced:!c||!f},{some:function(u){return o(this,u,arguments.length>1?arguments[1]:void 0)}})},function(n,r,i){var a=i(90),o=i(135);n.exports=a?{}.toString:function(){return"[object "+o(this)+"]"}},function(n,r){n.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},function(n,r,i){var a=i(8);n.exports=!a((function(){return Object.isExtensible(Object.preventExtensions({}))}))},function(n,r,i){var a=i(5),o=i(49),s=a("iterator"),l=Array.prototype;n.exports=function(c){return c!==void 0&&(o.Array===c||l[s]===c)}},function(n,r,i){var a=i(135),o=i(49),s=i(5)("iterator");n.exports=function(l){if(l!=null)return l[s]||l["@@iterator"]||o[a(l)]}},function(n,r,i){var a=i(18);n.exports=function(o,s,l,c){try{return c?s(a(l)[0],l[1]):s(l)}catch(u){var f=o.return;throw f!==void 0&&a(f.call(o)),u}}},function(n,r,i){var a=i(5)("iterator"),o=!1;try{var s=0,l={next:function(){return{done:!!s++}},return:function(){o=!0}};l[a]=function(){return this},Array.from(l,(function(){throw 2}))}catch{}n.exports=function(c,f){if(!f&&!o)return!1;var u=!1;try{var d={};d[a]=function(){return{next:function(){return{done:u=!0}}}},c(d)}catch{}return u}},function(n,r,i){var a=i(13),o=i(133);n.exports=function(s,l,c){var f,u;return o&&typeof(f=l.constructor)=="function"&&f!==c&&a(u=f.prototype)&&u!==c.prototype&&o(s,u),s}},function(n,r,i){var a=i(25);n.exports=function(o,s,l){for(var c in s)a(o,c,s[c],l);return o}},function(n,r,i){var a=i(46),o=i(15),s=i(5),l=i(16),c=s("species");n.exports=function(f){var u=a(f),d=o.f;l&&u&&!u[c]&&d(u,c,{configurable:!0,get:function(){return this}})}},function(n,r,i){var a=this&&this.__generator||function(l,c){var f,u,d,h,p={label:0,sent:function(){if(1&d[0])throw d[1];return d[1]},trys:[],ops:[]};return h={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(h[Symbol.iterator]=function(){return this}),h;function g(m){return function(y){return(function(v){if(f)throw new TypeError("Generator is already executing.");for(;p;)try{if(f=1,u&&(d=2&v[0]?u.return:v[0]?u.throw||((d=u.return)&&d.call(u),0):u.next)&&!(d=d.call(u,v[1])).done)return d;switch(u=0,d&&(v=[2&v[0],d.value]),v[0]){case 0:case 1:d=v;break;case 4:return p.label++,{value:v[1],done:!1};case 5:p.label++,u=v[1],v=[0];continue;case 7:v=p.ops.pop(),p.trys.pop();continue;default:if(d=p.trys,!((d=d.length>0&&d[d.length-1])||v[0]!==6&&v[0]!==2)){p=0;continue}if(v[0]===3&&(!d||v[1]>d[0]&&v[1]<d[3])){p.label=v[1];break}if(v[0]===6&&p.label<d[1]){p.label=d[1],d=v;break}if(d&&p.label<d[2]){p.label=d[2],p.ops.push(v);break}d[2]&&p.ops.pop(),p.trys.pop();continue}v=c.call(l,p)}catch(x){v=[6,x],u=0}finally{f=d=0}if(5&v[0])throw v[1];return{value:v[0]?v[1]:void 0,done:!0}})([m,y])}}},o=this&&this.__values||function(l){var c=typeof Symbol=="function"&&Symbol.iterator,f=c&&l[c],u=0;if(f)return f.call(l);if(l&&typeof l.length=="number")return{next:function(){return l&&u>=l.length&&(l=void 0),{value:l&&l[u++],done:!l}}};throw new TypeError(c?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var s=(function(){function l(c){c===void 0&&(c=1e3),this._items=new Set,this._limit=c}return l.prototype.add=function(c){if(this._items.add(c),this._items.size>this._limit){var f=this._items.values().next();f.done||this._items.delete(f.value)}return this},l.prototype.delete=function(c){return this._items.delete(c)},l.prototype.has=function(c){return this._items.has(c)},l.prototype.clear=function(){this._items.clear()},Object.defineProperty(l.prototype,"size",{get:function(){return this._items.size},enumerable:!0,configurable:!0}),l.prototype.forEach=function(c,f){var u=this;this._items.forEach((function(d){return c.call(f,d,d,u)}))},l.prototype.keys=function(){return a(this,(function(c){switch(c.label){case 0:return[5,o(this._items.keys())];case 1:return c.sent(),[2]}}))},l.prototype.values=function(){return a(this,(function(c){switch(c.label){case 0:return[5,o(this._items.values())];case 1:return c.sent(),[2]}}))},l.prototype.entries=function(){return a(this,(function(c){switch(c.label){case 0:return[5,o(this._items.entries())];case 1:return c.sent(),[2]}}))},l.prototype[Symbol.iterator]=function(){return a(this,(function(c){switch(c.label){case 0:return[5,o(this._items)];case 1:return c.sent(),[2]}}))},Object.defineProperty(l.prototype,Symbol.toStringTag,{get:function(){return"FixedSizeSet"},enumerable:!0,configurable:!0}),l})();r.FixedSizeSet=s},function(n,r,i){var a=this&&this.__generator||function(l,c){var f,u,d,h,p={label:0,sent:function(){if(1&d[0])throw d[1];return d[1]},trys:[],ops:[]};return h={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(h[Symbol.iterator]=function(){return this}),h;function g(m){return function(y){return(function(v){if(f)throw new TypeError("Generator is already executing.");for(;p;)try{if(f=1,u&&(d=2&v[0]?u.return:v[0]?u.throw||((d=u.return)&&d.call(u),0):u.next)&&!(d=d.call(u,v[1])).done)return d;switch(u=0,d&&(v=[2&v[0],d.value]),v[0]){case 0:case 1:d=v;break;case 4:return p.label++,{value:v[1],done:!1};case 5:p.label++,u=v[1],v=[0];continue;case 7:v=p.ops.pop(),p.trys.pop();continue;default:if(d=p.trys,!((d=d.length>0&&d[d.length-1])||v[0]!==6&&v[0]!==2)){p=0;continue}if(v[0]===3&&(!d||v[1]>d[0]&&v[1]<d[3])){p.label=v[1];break}if(v[0]===6&&p.label<d[1]){p.label=d[1],d=v;break}if(d&&p.label<d[2]){p.label=d[2],p.ops.push(v);break}d[2]&&p.ops.pop(),p.trys.pop();continue}v=c.call(l,p)}catch(x){v=[6,x],u=0}finally{f=d=0}if(5&v[0])throw v[1];return{value:v[0]?v[1]:void 0,done:!0}})([m,y])}}},o=this&&this.__values||function(l){var c=typeof Symbol=="function"&&Symbol.iterator,f=c&&l[c],u=0;if(f)return f.call(l);if(l&&typeof l.length=="number")return{next:function(){return l&&u>=l.length&&(l=void 0),{value:l&&l[u++],done:!l}}};throw new TypeError(c?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var s=(function(){function l(c){c===void 0&&(c=1e3),this._items=new Map,this._limit=c}return l.prototype.get=function(c){return this._items.get(c)},l.prototype.set=function(c,f){if(this._items.set(c,f),this._items.size>this._limit){var u=this._items.keys().next();u.done||this._items.delete(u.value)}},l.prototype.delete=function(c){return this._items.delete(c)},l.prototype.has=function(c){return this._items.has(c)},l.prototype.clear=function(){this._items.clear()},Object.defineProperty(l.prototype,"size",{get:function(){return this._items.size},enumerable:!0,configurable:!0}),l.prototype.forEach=function(c,f){this._items.forEach((function(u,d){return c.call(f,d,u)}))},l.prototype.keys=function(){return a(this,(function(c){switch(c.label){case 0:return[5,o(this._items.keys())];case 1:return c.sent(),[2]}}))},l.prototype.values=function(){return a(this,(function(c){switch(c.label){case 0:return[5,o(this._items.values())];case 1:return c.sent(),[2]}}))},l.prototype.entries=function(){return a(this,(function(c){switch(c.label){case 0:return[5,o(this._items.entries())];case 1:return c.sent(),[2]}}))},l.prototype[Symbol.iterator]=function(){return a(this,(function(c){switch(c.label){case 0:return[5,o(this._items)];case 1:return c.sent(),[2]}}))},Object.defineProperty(l.prototype,Symbol.toStringTag,{get:function(){return"ObjectCache"},enumerable:!0,configurable:!0}),l})();r.ObjectCache=s},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=(function(){function o(s){s===void 0&&(s=1e3),this._items=new Map,this._limit=s}return o.prototype.check=function(s,l){if(this._items.get(s)===l)return!0;if(this._items.get(l)===s)return!1;var c=Math.random()<.5;if(c?this._items.set(s,l):this._items.set(l,s),this._items.size>this._limit){var f=this._items.keys().next();f.done||this._items.delete(f.value)}return c},o})();r.CompareCache=a},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=(function(){function o(s){this._initialized=!1,this._value=void 0,this._initFunc=s}return Object.defineProperty(o.prototype,"value",{get:function(){return this._initialized||(this._value=this._initFunc(),this._initialized=!0),this._value},enumerable:!0,configurable:!0}),o})();r.Lazy=a},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=(function(){function o(s){this._pointer=0,this._chars=Array.from(s),this._length=this._chars.length}return Object.defineProperty(o.prototype,"eof",{get:function(){return this._pointer>=this._length},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"length",{get:function(){return this._length},enumerable:!0,configurable:!0}),o.prototype.codePoint=function(){if(this._codePoint===void 0)if(this.eof)this._codePoint=-1;else{var s=this._chars[this._pointer].codePointAt(0);this._codePoint=s!==void 0?s:-1}return this._codePoint},o.prototype.c=function(){return this._c===void 0&&(this._c=this.eof?"":this._chars[this._pointer]),this._c},o.prototype.remaining=function(){return this._remaining===void 0&&(this._remaining=this.eof?"":this._chars.slice(this._pointer+1).join("")),this._remaining},o.prototype.substring=function(){return this._substring===void 0&&(this._substring=this.eof?"":this._chars.slice(this._pointer).join("")),this._substring},Object.defineProperty(o.prototype,"pointer",{get:function(){return this._pointer},set:function(s){s!==this._pointer&&(this._pointer=s,this._codePoint=void 0,this._c=void 0,this._remaining=void 0,this._substring=void 0)},enumerable:!0,configurable:!0}),o})();r.StringWalker=a},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(218);r.MapWriter=a.MapWriter;var o=i(258);r.XMLWriter=o.XMLWriter;var s=i(67);r.ObjectWriter=s.ObjectWriter;var l=i(260);r.JSONWriter=l.JSONWriter;var c=i(261);r.YAMLWriter=c.YAMLWriter},function(n,r,i){i(19),i(219),i(20),i(22),i(23);var a,o=this&&this.__extends||(a=function(f,u){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,h){d.__proto__=h}||function(d,h){for(var p in h)h.hasOwnProperty(p)&&(d[p]=h[p])})(f,u)},function(f,u){function d(){this.constructor=f}a(f,u),f.prototype=u===null?Object.create(u):(d.prototype=u.prototype,new d)});Object.defineProperty(r,"__esModule",{value:!0});var s=i(1),l=i(67),c=(function(f){function u(d,h){var p=f.call(this,d)||this;return p._writerOptions=s.applyDefaults(h,{format:"map",wellFormed:!1,group:!1,verbose:!1}),p}return o(u,f),u.prototype.serialize=function(d){var h=s.applyDefaults(this._writerOptions,{format:"object",wellFormed:!1,verbose:!1}),p=new l.ObjectWriter(this._builderOptions,h).serialize(d);return this._convertObject(p)},u.prototype._convertObject=function(d){if(s.isArray(d)){for(var h=0;h<d.length;h++)d[h]=this._convertObject(d[h]);return d}if(s.isObject(d)){var p=new Map;for(var g in d)p.set(g,this._convertObject(d[g]));return p}return d},u})(i(50).BaseWriter);r.MapWriter=c},function(n,r,i){var a=i(139),o=i(143);n.exports=a("Map",(function(s){return function(){return s(this,arguments.length?arguments[0]:void 0)}}),o)},function(n,r,i){var a=i(4),o=i(8),s=i(59),l=i(13),c=i(27),f=i(26),u=i(134),d=i(128),h=i(63),p=i(5),g=i(129),m=p("isConcatSpreadable"),y=g>=51||!o((function(){var w=[];return w[m]=!1,w.concat()[0]!==w})),v=h("concat"),x=function(w){if(!l(w))return!1;var S=w[m];return S!==void 0?!!S:s(w)};a({target:"Array",proto:!0,forced:!y||!v},{concat:function(w){var S,T,_,D,I,R=c(this),O=d(R,0),P=0;for(S=-1,_=arguments.length;S<_;S++)if(x(I=S===-1?R:arguments[S])){if(P+(D=f(I.length))>9007199254740991)throw TypeError("Maximum allowed index exceeded");for(T=0;T<D;T++,P++)T in I&&u(O,P,I[T])}else{if(P>=9007199254740991)throw TypeError("Maximum allowed index exceeded");u(O,P++,I)}return O.length=P,O}})},function(n,r,i){var a=i(8);function o(s,l){return RegExp(s,l)}r.UNSUPPORTED_Y=a((function(){var s=o("a","y");return s.lastIndex=2,s.exec("abcd")!=null})),r.BROKEN_CARET=a((function(){var s=o("^r","gy");return s.lastIndex=2,s.exec("str")!=null}))},function(n,r,i){var a=i(223);n.exports=function(o){if(a(o))throw TypeError("The method doesn't accept regular expressions");return o}},function(n,r,i){var a=i(13),o=i(42),s=i(5)("match");n.exports=function(l){var c;return a(l)&&((c=l[s])!==void 0?!!c:o(l)=="RegExp")}},function(n,r,i){var a=i(5)("match");n.exports=function(o){var s=/./;try{"/./"[o](s)}catch{try{return s[a]=!1,"/./"[o](s)}catch{}}return!1}},function(n,r,i){i(68);var a=i(25),o=i(8),s=i(5),l=i(93),c=i(21),f=s("species"),u=!o((function(){var m=/./;return m.exec=function(){var y=[];return y.groups={a:"7"},y},"".replace(m,"$<a>")!=="7"})),d="a".replace(/./,"$0")==="$0",h=s("replace"),p=!!/./[h]&&/./[h]("a","$0")==="",g=!o((function(){var m=/(?:)/,y=m.exec;m.exec=function(){return y.apply(this,arguments)};var v="ab".split(m);return v.length!==2||v[0]!=="a"||v[1]!=="b"}));n.exports=function(m,y,v,x){var w=s(m),S=!o((function(){var O={};return O[w]=function(){return 7},""[m](O)!=7})),T=S&&!o((function(){var O=!1,P=/a/;return m==="split"&&((P={}).constructor={},P.constructor[f]=function(){return P},P.flags="",P[w]=/./[w]),P.exec=function(){return O=!0,null},P[w](""),!O}));if(!S||!T||m==="replace"&&(!u||!d||p)||m==="split"&&!g){var _=/./[w],D=v(w,""[m],(function(O,P,N,A,B){return P.exec===l?S&&!B?{done:!0,value:_.call(P,N,A)}:{done:!0,value:O.call(N,P,A)}:{done:!1}}),{REPLACE_KEEPS_$0:d,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:p}),I=D[0],R=D[1];a(String.prototype,m,I),a(RegExp.prototype,w,y==2?function(O,P){return R.call(O,this,P)}:function(O){return R.call(O,this)})}x&&c(RegExp.prototype[w],"sham",!0)}},function(n,r,i){var a=i(137).charAt;n.exports=function(o,s,l){return s+(l?a(o,s).length:1)}},function(n,r,i){var a=i(42),o=i(93);n.exports=function(s,l){var c=s.exec;if(typeof c=="function"){var f=c.call(s,l);if(typeof f!="object")throw TypeError("RegExp exec method returned something other than an Object or null");return f}if(a(s)!=="RegExp")throw TypeError("RegExp#exec called on incompatible receiver");return o.call(s,l)}},function(n,r,i){(function(a){Object.defineProperty(r,"__esModule",{value:!0});var o=i(96);r.forgivingBase64Encode=function(s){return a.from(s).toString("base64")},r.forgivingBase64Decode=function(s){return s===""?"":((s=s.replace(o.ASCIIWhiteSpace,"")).length%4==0&&(s.endsWith("==")?s=s.substr(0,s.length-2):s.endsWith("=")&&(s=s.substr(0,s.length-1))),s.length%4==1?null:/[0-9A-Za-z+/]/.test(s)?a.from(s,"base64").toString("utf8"):null)}}).call(this,i(145).Buffer)},function(n,r,i){r.byteLength=function(h){var p=u(h),g=p[0],m=p[1];return 3*(g+m)/4-m},r.toByteArray=function(h){var p,g,m=u(h),y=m[0],v=m[1],x=new s((function(T,_,D){return 3*(_+D)/4-D})(0,y,v)),w=0,S=v>0?y-4:y;for(g=0;g<S;g+=4)p=o[h.charCodeAt(g)]<<18|o[h.charCodeAt(g+1)]<<12|o[h.charCodeAt(g+2)]<<6|o[h.charCodeAt(g+3)],x[w++]=p>>16&255,x[w++]=p>>8&255,x[w++]=255&p;return v===2&&(p=o[h.charCodeAt(g)]<<2|o[h.charCodeAt(g+1)]>>4,x[w++]=255&p),v===1&&(p=o[h.charCodeAt(g)]<<10|o[h.charCodeAt(g+1)]<<4|o[h.charCodeAt(g+2)]>>2,x[w++]=p>>8&255,x[w++]=255&p),x},r.fromByteArray=function(h){for(var p,g=h.length,m=g%3,y=[],v=0,x=g-m;v<x;v+=16383)y.push(d(h,v,v+16383>x?x:v+16383));return m===1?(p=h[g-1],y.push(a[p>>2]+a[p<<4&63]+"==")):m===2&&(p=(h[g-2]<<8)+h[g-1],y.push(a[p>>10]+a[p>>4&63]+a[p<<2&63]+"=")),y.join("")};for(var a=[],o=[],s=typeof Uint8Array<"u"?Uint8Array:Array,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",c=0,f=l.length;c<f;++c)a[c]=l[c],o[l.charCodeAt(c)]=c;function u(h){var p=h.length;if(p%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var g=h.indexOf("=");return g===-1&&(g=p),[g,g===p?0:4-g%4]}function d(h,p,g){for(var m,y,v=[],x=p;x<g;x+=3)m=(h[x]<<16&16711680)+(h[x+1]<<8&65280)+(255&h[x+2]),v.push(a[(y=m)>>18&63]+a[y>>12&63]+a[y>>6&63]+a[63&y]);return v.join("")}o[45]=62,o[95]=63},function(n,r){r.read=function(i,a,o,s,l){var c,f,u=8*l-s-1,d=(1<<u)-1,h=d>>1,p=-7,g=o?l-1:0,m=o?-1:1,y=i[a+g];for(g+=m,c=y&(1<<-p)-1,y>>=-p,p+=u;p>0;c=256*c+i[a+g],g+=m,p-=8);for(f=c&(1<<-p)-1,c>>=-p,p+=s;p>0;f=256*f+i[a+g],g+=m,p-=8);if(c===0)c=1-h;else{if(c===d)return f?NaN:1/0*(y?-1:1);f+=Math.pow(2,s),c-=h}return(y?-1:1)*f*Math.pow(2,c-s)},r.write=function(i,a,o,s,l,c){var f,u,d,h=8*c-l-1,p=(1<<h)-1,g=p>>1,m=l===23?Math.pow(2,-24)-Math.pow(2,-77):0,y=s?0:c-1,v=s?1:-1,x=a<0||a===0&&1/a<0?1:0;for(a=Math.abs(a),isNaN(a)||a===1/0?(u=isNaN(a)?1:0,f=p):(f=Math.floor(Math.log(a)/Math.LN2),a*(d=Math.pow(2,-f))<1&&(f--,d*=2),(a+=f+g>=1?m/d:m*Math.pow(2,1-g))*d>=2&&(f++,d/=2),f+g>=p?(u=0,f=p):f+g>=1?(u=(a*d-1)*Math.pow(2,l),f+=g):(u=a*Math.pow(2,g-1)*Math.pow(2,l),f=0));l>=8;i[o+y]=255&u,y+=v,u/=256,l-=8);for(f=f<<l|u,h+=l;h>0;i[o+y]=255&f,y+=v,f/=256,h-=8);i[o+y-v]|=128*x}},function(n,r){var i={}.toString;n.exports=Array.isArray||function(a){return i.call(a)=="[object Array]"}},function(n,r,i){var a=this&&this.__values||function(l){var c=typeof Symbol=="function"&&Symbol.iterator,f=c&&l[c],u=0;if(f)return f.call(l);if(l&&typeof l.length=="number")return{next:function(){return l&&u>=l.length&&(l=void 0),{value:l&&l[u++],done:!l}}};throw new TypeError(c?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var o=i(1);function s(l){var c,f;if(l===null||o.isString(l)||o.isNumber(l))return l;if(o.isArray(l)){var u=new Array;try{for(var d=a(l),h=d.next();!h.done;h=d.next()){var p=h.value;u.push(s(p))}}catch(y){c={error:y}}finally{try{h&&!h.done&&(f=d.return)&&f.call(d)}finally{if(c)throw c.error}}return u}if(o.isObject(l)){u=new Map;for(var g in l)if(l.hasOwnProperty(g)){var m=l[g];u.set(g,s(m))}return u}return l}r.parseJSONFromBytes=function(l){var c=o.utf8Decode(l);return JSON.parse.call(void 0,c)},r.serializeJSONToBytes=function(l){var c=JSON.stringify.call(void 0,l);return o.utf8Encode(c)},r.parseJSONIntoInfraValues=function(l){return s(JSON.parse.call(void 0,l))},r.convertAJSONDerivedJavaScriptValueToAnInfraValue=s},function(n,r,i){var a=this&&this.__generator||function(f,u){var d,h,p,g,m={label:0,sent:function(){if(1&p[0])throw p[1];return p[1]},trys:[],ops:[]};return g={next:y(0),throw:y(1),return:y(2)},typeof Symbol=="function"&&(g[Symbol.iterator]=function(){return this}),g;function y(v){return function(x){return(function(w){if(d)throw new TypeError("Generator is already executing.");for(;m;)try{if(d=1,h&&(p=2&w[0]?h.return:w[0]?h.throw||((p=h.return)&&p.call(h),0):h.next)&&!(p=p.call(h,w[1])).done)return p;switch(h=0,p&&(w=[2&w[0],p.value]),w[0]){case 0:case 1:p=w;break;case 4:return m.label++,{value:w[1],done:!1};case 5:m.label++,h=w[1],w=[0];continue;case 7:w=m.ops.pop(),m.trys.pop();continue;default:if(p=m.trys,!((p=p.length>0&&p[p.length-1])||w[0]!==6&&w[0]!==2)){m=0;continue}if(w[0]===3&&(!p||w[1]>p[0]&&w[1]<p[3])){m.label=w[1];break}if(w[0]===6&&m.label<p[1]){m.label=p[1],p=w;break}if(p&&m.label<p[2]){m.label=p[2],m.ops.push(w);break}p[2]&&m.ops.pop(),m.trys.pop();continue}w=u.call(f,m)}catch(S){w=[6,S],h=0}finally{d=p=0}if(5&w[0])throw w[1];return{value:w[0]?w[1]:void 0,done:!0}})([v,x])}}},o=this&&this.__read||function(f,u){var d=typeof Symbol=="function"&&f[Symbol.iterator];if(!d)return f;var h,p,g=d.call(f),m=[];try{for(;(u===void 0||u-- >0)&&!(h=g.next()).done;)m.push(h.value)}catch(y){p={error:y}}finally{try{h&&!h.done&&(d=g.return)&&d.call(g)}finally{if(p)throw p.error}}return m},s=this&&this.__spread||function(){for(var f=[],u=0;u<arguments.length;u++)f=f.concat(o(arguments[u]));return f},l=this&&this.__values||function(f){var u=typeof Symbol=="function"&&Symbol.iterator,d=u&&f[u],h=0;if(d)return d.call(f);if(f&&typeof f.length=="number")return{next:function(){return f&&h>=f.length&&(f=void 0),{value:f&&f[h++],done:!f}}};throw new TypeError(u?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var c=i(1);r.append=function(f,u){f.push(u)},r.extend=function(f,u){f.push.apply(f,s(u))},r.prepend=function(f,u){f.unshift(u)},r.replace=function(f,u,d){var h,p,g=0;try{for(var m=l(f),y=m.next();!y.done;y=m.next()){var v=y.value;if(c.isFunction(u))u.call(null,v)&&(f[g]=d);else if(v===u)return void(f[g]=d);g++}}catch(x){h={error:x}}finally{try{y&&!y.done&&(p=m.return)&&p.call(m)}finally{if(h)throw h.error}}},r.insert=function(f,u,d){f.splice(d,0,u)},r.remove=function(f,u){for(var d=f.length;d--;){var h=f[d];if(c.isFunction(u))u.call(null,h)&&f.splice(d,1);else if(h===u)return void f.splice(d,1)}},r.empty=function(f){f.length=0},r.contains=function(f,u){var d,h;try{for(var p=l(f),g=p.next();!g.done;g=p.next()){var m=g.value;if(c.isFunction(u)){if(u.call(null,m))return!0}else if(m===u)return!0}}catch(y){d={error:y}}finally{try{g&&!g.done&&(h=p.return)&&h.call(p)}finally{if(d)throw d.error}}return!1},r.size=function(f,u){var d,h;if(u===void 0)return f.length;var p=0;try{for(var g=l(f),m=g.next();!m.done;m=g.next()){var y=m.value;u.call(null,y)&&p++}}catch(v){d={error:v}}finally{try{m&&!m.done&&(h=g.return)&&h.call(g)}finally{if(d)throw d.error}}return p},r.isEmpty=function(f){return f.length===0},r.forEach=function(f,u){var d,h,p,g,m,y;return a(this,(function(v){switch(v.label){case 0:return u!==void 0?[3,2]:[5,l(f)];case 1:return v.sent(),[3,9];case 2:v.trys.push([2,7,8,9]),d=l(f),h=d.next(),v.label=3;case 3:return h.done?[3,6]:(p=h.value,u.call(null,p)?[4,p]:[3,5]);case 4:v.sent(),v.label=5;case 5:return h=d.next(),[3,3];case 6:return[3,9];case 7:return g=v.sent(),m={error:g},[3,9];case 8:try{h&&!h.done&&(y=d.return)&&y.call(d)}finally{if(m)throw m.error}return[7];case 9:return[2]}}))},r.clone=function(f){return new(Array.bind.apply(Array,s([void 0],f)))},r.sortInAscendingOrder=function(f,u){return f.sort((function(d,h){return u.call(null,d,h)?-1:1}))},r.sortInDescendingOrder=function(f,u){return f.sort((function(d,h){return u.call(null,d,h)?1:-1}))}},function(n,r,i){var a=this&&this.__generator||function(f,u){var d,h,p,g,m={label:0,sent:function(){if(1&p[0])throw p[1];return p[1]},trys:[],ops:[]};return g={next:y(0),throw:y(1),return:y(2)},typeof Symbol=="function"&&(g[Symbol.iterator]=function(){return this}),g;function y(v){return function(x){return(function(w){if(d)throw new TypeError("Generator is already executing.");for(;m;)try{if(d=1,h&&(p=2&w[0]?h.return:w[0]?h.throw||((p=h.return)&&p.call(h),0):h.next)&&!(p=p.call(h,w[1])).done)return p;switch(h=0,p&&(w=[2&w[0],p.value]),w[0]){case 0:case 1:p=w;break;case 4:return m.label++,{value:w[1],done:!1};case 5:m.label++,h=w[1],w=[0];continue;case 7:w=m.ops.pop(),m.trys.pop();continue;default:if(p=m.trys,!((p=p.length>0&&p[p.length-1])||w[0]!==6&&w[0]!==2)){m=0;continue}if(w[0]===3&&(!p||w[1]>p[0]&&w[1]<p[3])){m.label=w[1];break}if(w[0]===6&&m.label<p[1]){m.label=p[1],p=w;break}if(p&&m.label<p[2]){m.label=p[2],m.ops.push(w);break}p[2]&&m.ops.pop(),m.trys.pop();continue}w=u.call(f,m)}catch(S){w=[6,S],h=0}finally{d=p=0}if(5&w[0])throw w[1];return{value:w[0]?w[1]:void 0,done:!0}})([v,x])}}},o=this&&this.__values||function(f){var u=typeof Symbol=="function"&&Symbol.iterator,d=u&&f[u],h=0;if(d)return d.call(f);if(f&&typeof f.length=="number")return{next:function(){return f&&h>=f.length&&(f=void 0),{value:f&&f[h++],done:!f}}};throw new TypeError(u?"Object is not iterable.":"Symbol.iterator is not defined.")},s=this&&this.__read||function(f,u){var d=typeof Symbol=="function"&&f[Symbol.iterator];if(!d)return f;var h,p,g=d.call(f),m=[];try{for(;(u===void 0||u-- >0)&&!(h=g.next()).done;)m.push(h.value)}catch(y){p={error:y}}finally{try{h&&!h.done&&(d=g.return)&&d.call(g)}finally{if(p)throw p.error}}return m},l=this&&this.__spread||function(){for(var f=[],u=0;u<arguments.length;u++)f=f.concat(s(arguments[u]));return f};Object.defineProperty(r,"__esModule",{value:!0});var c=i(1);r.get=function(f,u){return f.get(u)},r.set=function(f,u,d){f.set(u,d)},r.remove=function(f,u){var d,h,p,g;if(c.isFunction(u)){var m=[];try{for(var y=o(f),v=y.next();!v.done;v=y.next()){var x=v.value;u.call(null,x)&&m.push(x[0])}}catch(_){d={error:_}}finally{try{v&&!v.done&&(h=y.return)&&h.call(y)}finally{if(d)throw d.error}}try{for(var w=o(m),S=w.next();!S.done;S=w.next()){var T=S.value;f.delete(T)}}catch(_){p={error:_}}finally{try{S&&!S.done&&(g=w.return)&&g.call(w)}finally{if(p)throw p.error}}}else f.delete(u)},r.contains=function(f,u){var d,h;if(c.isFunction(u)){try{for(var p=o(f),g=p.next();!g.done;g=p.next()){var m=g.value;if(u.call(null,m))return!0}}catch(y){d={error:y}}finally{try{g&&!g.done&&(h=p.return)&&h.call(p)}finally{if(d)throw d.error}}return!1}return f.has(u)},r.keys=function(f){return new Set(f.keys())},r.values=function(f){return l(f.values())},r.size=function(f,u){var d,h;if(u===void 0)return f.size;var p=0;try{for(var g=o(f),m=g.next();!m.done;m=g.next()){var y=m.value;u.call(null,y)&&p++}}catch(v){d={error:v}}finally{try{m&&!m.done&&(h=g.return)&&h.call(g)}finally{if(d)throw d.error}}return p},r.isEmpty=function(f){return f.size===0},r.forEach=function(f,u){var d,h,p,g,m,y;return a(this,(function(v){switch(v.label){case 0:return u!==void 0?[3,2]:[5,o(f)];case 1:return v.sent(),[3,9];case 2:v.trys.push([2,7,8,9]),d=o(f),h=d.next(),v.label=3;case 3:return h.done?[3,6]:(p=h.value,u.call(null,p)?[4,p]:[3,5]);case 4:v.sent(),v.label=5;case 5:return h=d.next(),[3,3];case 6:return[3,9];case 7:return g=v.sent(),m={error:g},[3,9];case 8:try{h&&!h.done&&(y=d.return)&&y.call(d)}finally{if(m)throw m.error}return[7];case 9:return[2]}}))},r.clone=function(f){return new Map(f)},r.sortInAscendingOrder=function(f,u){var d=new(Array.bind.apply(Array,l([void 0],f)));return d.sort((function(h,p){return u.call(null,h,p)?-1:1})),new Map(d)},r.sortInDescendingOrder=function(f,u){var d=new(Array.bind.apply(Array,l([void 0],f)));return d.sort((function(h,p){return u.call(null,h,p)?1:-1})),new Map(d)}},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.HTML="http://www.w3.org/1999/xhtml",r.XML="http://www.w3.org/XML/1998/namespace",r.XMLNS="http://www.w3.org/2000/xmlns/",r.MathML="http://www.w3.org/1998/Math/MathML",r.SVG="http://www.w3.org/2000/svg",r.XLink="http://www.w3.org/1999/xlink"},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.enqueue=function(a,o){a.push(o)},r.dequeue=function(a){return a.shift()||null}},function(n,r,i){var a=this&&this.__generator||function(u,d){var h,p,g,m,y={label:0,sent:function(){if(1&g[0])throw g[1];return g[1]},trys:[],ops:[]};return m={next:v(0),throw:v(1),return:v(2)},typeof Symbol=="function"&&(m[Symbol.iterator]=function(){return this}),m;function v(x){return function(w){return(function(S){if(h)throw new TypeError("Generator is already executing.");for(;y;)try{if(h=1,p&&(g=2&S[0]?p.return:S[0]?p.throw||((g=p.return)&&g.call(p),0):p.next)&&!(g=g.call(p,S[1])).done)return g;switch(p=0,g&&(S=[2&S[0],g.value]),S[0]){case 0:case 1:g=S;break;case 4:return y.label++,{value:S[1],done:!1};case 5:y.label++,p=S[1],S=[0];continue;case 7:S=y.ops.pop(),y.trys.pop();continue;default:if(g=y.trys,!((g=g.length>0&&g[g.length-1])||S[0]!==6&&S[0]!==2)){y=0;continue}if(S[0]===3&&(!g||S[1]>g[0]&&S[1]<g[3])){y.label=S[1];break}if(S[0]===6&&y.label<g[1]){y.label=g[1],g=S;break}if(g&&y.label<g[2]){y.label=g[2],y.ops.push(S);break}g[2]&&y.ops.pop(),y.trys.pop();continue}S=d.call(u,y)}catch(T){S=[6,T],p=0}finally{h=g=0}if(5&S[0])throw S[1];return{value:S[0]?S[1]:void 0,done:!0}})([x,w])}}},o=this&&this.__values||function(u){var d=typeof Symbol=="function"&&Symbol.iterator,h=d&&u[d],p=0;if(h)return h.call(u);if(u&&typeof u.length=="number")return{next:function(){return u&&p>=u.length&&(u=void 0),{value:u&&u[p++],done:!u}}};throw new TypeError(d?"Object is not iterable.":"Symbol.iterator is not defined.")},s=this&&this.__read||function(u,d){var h=typeof Symbol=="function"&&u[Symbol.iterator];if(!h)return u;var p,g,m=h.call(u),y=[];try{for(;(d===void 0||d-- >0)&&!(p=m.next()).done;)y.push(p.value)}catch(v){g={error:v}}finally{try{p&&!p.done&&(h=m.return)&&h.call(m)}finally{if(g)throw g.error}}return y},l=this&&this.__spread||function(){for(var u=[],d=0;d<arguments.length;d++)u=u.concat(s(arguments[d]));return u};Object.defineProperty(r,"__esModule",{value:!0});var c=i(1);function f(u,d){var h,p;try{for(var g=o(u),m=g.next();!m.done;m=g.next()){var y=m.value;if(!d.has(y))return!1}}catch(v){h={error:v}}finally{try{m&&!m.done&&(p=g.return)&&p.call(g)}finally{if(h)throw h.error}}return!0}r.append=function(u,d){u.add(d)},r.extend=function(u,d){d.forEach(u.add,u)},r.prepend=function(u,d){var h=new Set(u);u.clear(),u.add(d),h.forEach(u.add,u)},r.replace=function(u,d,h){var p,g,m=new Set;try{for(var y=o(u),v=y.next();!v.done;v=y.next()){var x=v.value;c.isFunction(d)?d.call(null,x)?m.add(h):m.add(x):x===d?m.add(h):m.add(x)}}catch(w){p={error:w}}finally{try{v&&!v.done&&(g=y.return)&&g.call(y)}finally{if(p)throw p.error}}u.clear(),m.forEach(u.add,u)},r.insert=function(u,d,h){var p,g,m=new Set,y=0;try{for(var v=o(u),x=v.next();!x.done;x=v.next()){var w=x.value;y===h&&m.add(d),m.add(w),y++}}catch(S){p={error:S}}finally{try{x&&!x.done&&(g=v.return)&&g.call(v)}finally{if(p)throw p.error}}u.clear(),m.forEach(u.add,u)},r.remove=function(u,d){var h,p,g,m;if(c.isFunction(d)){var y=[];try{for(var v=o(u),x=v.next();!x.done;x=v.next()){var w=x.value;d.call(null,w)&&y.push(w)}}catch(D){h={error:D}}finally{try{x&&!x.done&&(p=v.return)&&p.call(v)}finally{if(h)throw h.error}}try{for(var S=o(y),T=S.next();!T.done;T=S.next()){var _=T.value;u.delete(_)}}catch(D){g={error:D}}finally{try{T&&!T.done&&(m=S.return)&&m.call(S)}finally{if(g)throw g.error}}}else u.delete(d)},r.empty=function(u){u.clear()},r.contains=function(u,d){var h,p;if(!c.isFunction(d))return u.has(d);try{for(var g=o(u),m=g.next();!m.done;m=g.next()){var y=m.value;if(d.call(null,y))return!0}}catch(v){h={error:v}}finally{try{m&&!m.done&&(p=g.return)&&p.call(g)}finally{if(h)throw h.error}}return!1},r.size=function(u,d){var h,p;if(d===void 0)return u.size;var g=0;try{for(var m=o(u),y=m.next();!y.done;y=m.next()){var v=y.value;d.call(null,v)&&g++}}catch(x){h={error:x}}finally{try{y&&!y.done&&(p=m.return)&&p.call(m)}finally{if(h)throw h.error}}return g},r.isEmpty=function(u){return u.size===0},r.forEach=function(u,d){var h,p,g,m,y,v;return a(this,(function(x){switch(x.label){case 0:return d!==void 0?[3,2]:[5,o(u)];case 1:return x.sent(),[3,9];case 2:x.trys.push([2,7,8,9]),h=o(u),p=h.next(),x.label=3;case 3:return p.done?[3,6]:(g=p.value,d.call(null,g)?[4,g]:[3,5]);case 4:x.sent(),x.label=5;case 5:return p=h.next(),[3,3];case 6:return[3,9];case 7:return m=x.sent(),y={error:m},[3,9];case 8:try{p&&!p.done&&(v=h.return)&&v.call(h)}finally{if(y)throw y.error}return[7];case 9:return[2]}}))},r.clone=function(u){return new Set(u)},r.sortInAscendingOrder=function(u,d){var h=new(Array.bind.apply(Array,l([void 0],u)));return h.sort((function(p,g){return d.call(null,p,g)?-1:1})),new Set(h)},r.sortInDescendingOrder=function(u,d){var h=new(Array.bind.apply(Array,l([void 0],u)));return h.sort((function(p,g){return d.call(null,p,g)?1:-1})),new Set(h)},r.isSubsetOf=f,r.isSupersetOf=function(u,d){return f(d,u)},r.intersection=function(u,d){var h,p,g=new Set;try{for(var m=o(u),y=m.next();!y.done;y=m.next()){var v=y.value;d.has(v)&&g.add(v)}}catch(x){h={error:x}}finally{try{y&&!y.done&&(p=m.return)&&p.call(m)}finally{if(h)throw h.error}}return g},r.union=function(u,d){var h=new Set(u);return d.forEach(h.add,h),h},r.range=function(u,d){for(var h=new Set,p=u;p<=d;p++)h.add(p);return h}},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.push=function(a,o){a.push(o)},r.pop=function(a){return a.pop()||null}},function(n,r,i){var a=this&&this.__values||function(y){var v=typeof Symbol=="function"&&Symbol.iterator,x=v&&y[v],w=0;if(x)return x.call(y);if(y&&typeof y.length=="number")return{next:function(){return y&&w>=y.length&&(y=void 0),{value:y&&y[w++],done:!y}}};throw new TypeError(v?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var o=i(96),s=i(147),l=i(146),c=i(1);function f(y,v){for(var x=0;;){var w=x<y.length?y.charCodeAt(x):null,S=x<v.length?v.charCodeAt(x):null;if(w===null)return!0;if(w!==S)return!1;x++}}function u(y){var v,x,w=Array.from(y),S=new Uint8Array(w.length),T=0;try{for(var _=a(y),D=_.next();!D.done;D=_.next()){var I=D.value.codePointAt(0);console.assert(I!==void 0&&I<=255,"isomorphicEncode requires string bytes to be less than or equal to 0x00FF."),I!==void 0&&I<=255&&(S[T++]=I)}}catch(R){v={error:R}}finally{try{D&&!D.done&&(x=_.return)&&x.call(_)}finally{if(v)throw v.error}}return S}function d(y){return/^[\u0000-\u007F]*$/.test(y)}function h(y){var v,x,w="";try{for(var S=a(y),T=S.next();!T.done;T=S.next()){var _=T.value,D=_.codePointAt(0);w+=D!==void 0&&D>=65&&D<=90?String.fromCodePoint(D+32):_}}catch(I){v={error:I}}finally{try{T&&!T.done&&(x=S.return)&&x.call(S)}finally{if(v)throw v.error}}return w}function p(y){return y.replace(/^[\t\n\f\r ]+/,"").replace(/[\t\n\f\r ]+$/,"")}function g(y,v,x){if(!c.isArray(v))return g(y,Array.from(v),x);for(var w="";x.position<v.length&&y.call(null,v[x.position]);)w+=v[x.position],x.position++;return w}function m(y,v){g((function(x){return o.ASCIIWhiteSpace.test(x)}),y,v)}r.isCodeUnitPrefix=f,r.isCodeUnitLessThan=function(y,v){if(f(v,y))return!1;if(f(y,v))return!0;for(var x=0;x<Math.min(y.length,v.length);x++){var w=y.charCodeAt(x),S=v.charCodeAt(x);if(w!==S)return w<S}return!1},r.isomorphicEncode=u,r.isASCIIString=d,r.asciiLowercase=h,r.asciiUppercase=function(y){var v,x,w="";try{for(var S=a(y),T=S.next();!T.done;T=S.next()){var _=T.value,D=_.codePointAt(0);w+=D!==void 0&&D>=97&&D<=122?String.fromCodePoint(D-32):_}}catch(I){v={error:I}}finally{try{T&&!T.done&&(x=S.return)&&x.call(S)}finally{if(v)throw v.error}}return w},r.asciiCaseInsensitiveMatch=function(y,v){return h(y)===h(v)},r.asciiEncode=function(y){return console.assert(d(y),"asciiEncode requires an ASCII string."),u(y)},r.asciiDecode=function(y){var v,x;try{for(var w=a(y),S=w.next();!S.done;S=w.next()){var T=S.value;console.assert(l.isASCIIByte(T),"asciiDecode requires an ASCII byte sequence.")}}catch(_){v={error:_}}finally{try{S&&!S.done&&(x=w.return)&&x.call(w)}finally{if(v)throw v.error}}return s.isomorphicDecode(y)},r.stripNewlines=function(y){return y.replace(/[\n\r]/g,"")},r.normalizeNewlines=function(y){return y.replace(/\r\n/g,`
`).replace(/\r/g,`
`)},r.stripLeadingAndTrailingASCIIWhitespace=p,r.stripAndCollapseASCIIWhitespace=function(y){return p(y.replace(/[\t\n\f\r ]{2,}/g," "))},r.collectASequenceOfCodePoints=g,r.skipASCIIWhitespace=m,r.strictlySplit=function y(v,x){if(!c.isArray(v))return y(Array.from(v),x);var w={position:0},S=[],T=g((function(_){return x!==_}),v,w);for(S.push(T);w.position<v.length;)console.assert(v[w.position]===x,"strictlySplit found no delimiter in input string."),w.position++,T=g((function(_){return x!==_}),v,w),S.push(T);return S},r.splitAStringOnASCIIWhitespace=function y(v){if(!c.isArray(v))return y(Array.from(v));var x={position:0},w=[];for(m(v,x);x.position<v.length;){var S=g((function(T){return!o.ASCIIWhiteSpace.test(T)}),v,x);w.push(S),m(v,x)}return w},r.splitAStringOnCommas=function y(v){if(!c.isArray(v))return y(Array.from(v));for(var x={position:0},w=[];x.position<v.length;){var S=g((function(T){return T!==","}),v,x);w.push(p(S)),x.position<v.length&&(console.assert(v[x.position]===",","splitAStringOnCommas found no delimiter in input string."),x.position++)}return w},r.concatenate=function(y,v){return v===void 0&&(v=""),y.length===0?"":y.join(v)}},function(n,r,i){var a=this&&this.__values||function(s){var l=typeof Symbol=="function"&&Symbol.iterator,c=l&&s[l],f=0;if(c)return c.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&f>=s.length&&(s=void 0),{value:s&&s[f++],done:!s}}};throw new TypeError(l?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var o=i(97);r.abort_add=function(s,l){l._abortedFlag||l._abortAlgorithms.add(s)},r.abort_remove=function(s,l){l._abortAlgorithms.delete(s)},r.abort_signalAbort=function(s){var l,c;if(!s._abortedFlag){s._abortedFlag=!0;try{for(var f=a(s._abortAlgorithms),u=f.next();!u.done;u=f.next())u.value.call(s)}catch(d){l={error:d}}finally{try{u&&!u.done&&(c=f.return)&&c.call(f)}finally{if(l)throw l.error}}s._abortAlgorithms.clear(),o.event_fireAnEvent("abort",s)}}},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(150),o=(function(){function s(){}return s.asNode=function(l){if(a.Guard.isNode(l))return l;throw new Error("Invalid object. Node expected.")},s})();r.Cast=o},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=(function(){function s(){}return Object.defineProperty(s.prototype,"size",{get:function(){return 0},enumerable:!0,configurable:!0}),s.prototype.add=function(l){throw new Error("Cannot add to an empty set.")},s.prototype.clear=function(){},s.prototype.delete=function(l){return!1},s.prototype.forEach=function(l,c){},s.prototype.has=function(l){return!1},s.prototype[Symbol.iterator]=function(){return new o},s.prototype.entries=function(){return new o},s.prototype.keys=function(){return new o},s.prototype.values=function(){return new o},Object.defineProperty(s.prototype,Symbol.toStringTag,{get:function(){return"EmptySet"},enumerable:!0,configurable:!0}),s})();r.EmptySet=a;var o=(function(){function s(){}return s.prototype[Symbol.iterator]=function(){return this},s.prototype.next=function(){return{done:!0,value:null}},s})()},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),(function(a){a[a.SchemeStart=0]="SchemeStart",a[a.Scheme=1]="Scheme",a[a.NoScheme=2]="NoScheme",a[a.SpecialRelativeOrAuthority=3]="SpecialRelativeOrAuthority",a[a.PathOrAuthority=4]="PathOrAuthority",a[a.Relative=5]="Relative",a[a.RelativeSlash=6]="RelativeSlash",a[a.SpecialAuthoritySlashes=7]="SpecialAuthoritySlashes",a[a.SpecialAuthorityIgnoreSlashes=8]="SpecialAuthorityIgnoreSlashes",a[a.Authority=9]="Authority",a[a.Host=10]="Host",a[a.Hostname=11]="Hostname",a[a.Port=12]="Port",a[a.File=13]="File",a[a.FileSlash=14]="FileSlash",a[a.FileHost=15]="FileHost",a[a.PathStart=16]="PathStart",a[a.Path=17]="Path",a[a.CannotBeABaseURLPath=18]="CannotBeABaseURLPath",a[a.Query=19]="Query",a[a.Fragment=20]="Fragment"})(r.ParserState||(r.ParserState={})),r.OpaqueOrigin=["","",null,null]},function(n,r,i){var a=i(245),o=i(247);function s(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}r.parse=S,r.resolve=function(T,_){return S(T,!1,!0).resolve(_)},r.resolveObject=function(T,_){return T?S(T,!1,!0).resolveObject(_):_},r.format=function(T){return o.isString(T)&&(T=S(T)),T instanceof s?T.format():s.prototype.format.call(T)},r.Url=s;var l=/^([a-z0-9.+-]+:)/i,c=/:[0-9]*$/,f=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,u=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r",`
`,"	"]),d=["'"].concat(u),h=["%","/","?",";","#"].concat(d),p=["/","?","#"],g=/^[+a-z0-9A-Z_-]{0,63}$/,m=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,y={javascript:!0,"javascript:":!0},v={javascript:!0,"javascript:":!0},x={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},w=i(248);function S(T,_,D){if(T&&o.isObject(T)&&T instanceof s)return T;var I=new s;return I.parse(T,_,D),I}s.prototype.parse=function(T,_,D){if(!o.isString(T))throw new TypeError("Parameter 'url' must be a string, not "+typeof T);var I=T.indexOf("?"),R=I!==-1&&I<T.indexOf("#")?"?":"#",O=T.split(R);O[0]=O[0].replace(/\\/g,"/");var P=T=O.join(R);if(P=P.trim(),!D&&T.split("#").length===1){var N=f.exec(P);if(N)return this.path=P,this.href=P,this.pathname=N[1],N[2]?(this.search=N[2],this.query=_?w.parse(this.search.substr(1)):this.search.substr(1)):_&&(this.search="",this.query={}),this}var A=l.exec(P);if(A){var B=(A=A[0]).toLowerCase();this.protocol=B,P=P.substr(A.length)}if(D||A||P.match(/^\/\/[^@\/]+@[^@\/]+/)){var V=P.substr(0,2)==="//";!V||A&&v[A]||(P=P.substr(2),this.slashes=!0)}if(!v[A]&&(V||A&&!x[A])){for(var $,U,G=-1,F=0;F<p.length;F++)(J=P.indexOf(p[F]))!==-1&&(G===-1||J<G)&&(G=J);for((U=G===-1?P.lastIndexOf("@"):P.lastIndexOf("@",G))!==-1&&($=P.slice(0,U),P=P.slice(U+1),this.auth=decodeURIComponent($)),G=-1,F=0;F<h.length;F++){var J;(J=P.indexOf(h[F]))!==-1&&(G===-1||J<G)&&(G=J)}G===-1&&(G=P.length),this.host=P.slice(0,G),P=P.slice(G),this.parseHost(),this.hostname=this.hostname||"";var Q=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!Q)for(var ne=this.hostname.split(/\./),ye=(F=0,ne.length);F<ye;F++){var ve=ne[F];if(ve&&!ve.match(g)){for(var Ce="",we=0,Ae=ve.length;we<Ae;we++)ve.charCodeAt(we)>127?Ce+="x":Ce+=ve[we];if(!Ce.match(g)){var Me=ne.slice(0,F),q=ne.slice(F+1),k=ve.match(m);k&&(Me.push(k[1]),q.unshift(k[2])),q.length&&(P="/"+q.join(".")+P),this.hostname=Me.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),Q||(this.hostname=a.toASCII(this.hostname));var Y=this.port?":"+this.port:"",X=this.hostname||"";this.host=X+Y,this.href+=this.host,Q&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),P[0]!=="/"&&(P="/"+P))}if(!y[B])for(F=0,ye=d.length;F<ye;F++){var re=d[F];if(P.indexOf(re)!==-1){var de=encodeURIComponent(re);de===re&&(de=escape(re)),P=P.split(re).join(de)}}var he=P.indexOf("#");he!==-1&&(this.hash=P.substr(he),P=P.slice(0,he));var Ee=P.indexOf("?");if(Ee!==-1?(this.search=P.substr(Ee),this.query=P.substr(Ee+1),_&&(this.query=w.parse(this.query)),P=P.slice(0,Ee)):_&&(this.search="",this.query={}),P&&(this.pathname=P),x[B]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){Y=this.pathname||"";var Oe=this.search||"";this.path=Y+Oe}return this.href=this.format(),this},s.prototype.format=function(){var T=this.auth||"";T&&(T=(T=encodeURIComponent(T)).replace(/%3A/i,":"),T+="@");var _=this.protocol||"",D=this.pathname||"",I=this.hash||"",R=!1,O="";this.host?R=T+this.host:this.hostname&&(R=T+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(R+=":"+this.port)),this.query&&o.isObject(this.query)&&Object.keys(this.query).length&&(O=w.stringify(this.query));var P=this.search||O&&"?"+O||"";return _&&_.substr(-1)!==":"&&(_+=":"),this.slashes||(!_||x[_])&&R!==!1?(R="//"+(R||""),D&&D.charAt(0)!=="/"&&(D="/"+D)):R||(R=""),I&&I.charAt(0)!=="#"&&(I="#"+I),P&&P.charAt(0)!=="?"&&(P="?"+P),_+R+(D=D.replace(/[?#]/g,(function(N){return encodeURIComponent(N)})))+(P=P.replace("#","%23"))+I},s.prototype.resolve=function(T){return this.resolveObject(S(T,!1,!0)).format()},s.prototype.resolveObject=function(T){if(o.isString(T)){var _=new s;_.parse(T,!1,!0),T=_}for(var D=new s,I=Object.keys(this),R=0;R<I.length;R++){var O=I[R];D[O]=this[O]}if(D.hash=T.hash,T.href==="")return D.href=D.format(),D;if(T.slashes&&!T.protocol){for(var P=Object.keys(T),N=0;N<P.length;N++){var A=P[N];A!=="protocol"&&(D[A]=T[A])}return x[D.protocol]&&D.hostname&&!D.pathname&&(D.path=D.pathname="/"),D.href=D.format(),D}if(T.protocol&&T.protocol!==D.protocol){if(!x[T.protocol]){for(var B=Object.keys(T),V=0;V<B.length;V++){var $=B[V];D[$]=T[$]}return D.href=D.format(),D}if(D.protocol=T.protocol,T.host||v[T.protocol])D.pathname=T.pathname;else{for(var U=(T.pathname||"").split("/");U.length&&!(T.host=U.shift()););T.host||(T.host=""),T.hostname||(T.hostname=""),U[0]!==""&&U.unshift(""),U.length<2&&U.unshift(""),D.pathname=U.join("/")}if(D.search=T.search,D.query=T.query,D.host=T.host||"",D.auth=T.auth,D.hostname=T.hostname||T.host,D.port=T.port,D.pathname||D.search){var G=D.pathname||"",F=D.search||"";D.path=G+F}return D.slashes=D.slashes||T.slashes,D.href=D.format(),D}var J=D.pathname&&D.pathname.charAt(0)==="/",Q=T.host||T.pathname&&T.pathname.charAt(0)==="/",ne=Q||J||D.host&&T.pathname,ye=ne,ve=D.pathname&&D.pathname.split("/")||[],Ce=(U=T.pathname&&T.pathname.split("/")||[],D.protocol&&!x[D.protocol]);if(Ce&&(D.hostname="",D.port=null,D.host&&(ve[0]===""?ve[0]=D.host:ve.unshift(D.host)),D.host="",T.protocol&&(T.hostname=null,T.port=null,T.host&&(U[0]===""?U[0]=T.host:U.unshift(T.host)),T.host=null),ne=ne&&(U[0]===""||ve[0]==="")),Q)D.host=T.host||T.host===""?T.host:D.host,D.hostname=T.hostname||T.hostname===""?T.hostname:D.hostname,D.search=T.search,D.query=T.query,ve=U;else if(U.length)ve||(ve=[]),ve.pop(),ve=ve.concat(U),D.search=T.search,D.query=T.query;else if(!o.isNullOrUndefined(T.search))return Ce&&(D.hostname=D.host=ve.shift(),(k=!!(D.host&&D.host.indexOf("@")>0)&&D.host.split("@"))&&(D.auth=k.shift(),D.host=D.hostname=k.shift())),D.search=T.search,D.query=T.query,o.isNull(D.pathname)&&o.isNull(D.search)||(D.path=(D.pathname?D.pathname:"")+(D.search?D.search:"")),D.href=D.format(),D;if(!ve.length)return D.pathname=null,D.search?D.path="/"+D.search:D.path=null,D.href=D.format(),D;for(var we=ve.slice(-1)[0],Ae=(D.host||T.host||ve.length>1)&&(we==="."||we==="..")||we==="",Me=0,q=ve.length;q>=0;q--)(we=ve[q])==="."?ve.splice(q,1):we===".."?(ve.splice(q,1),Me++):Me&&(ve.splice(q,1),Me--);if(!ne&&!ye)for(;Me--;Me)ve.unshift("..");!ne||ve[0]===""||ve[0]&&ve[0].charAt(0)==="/"||ve.unshift(""),Ae&&ve.join("/").substr(-1)!=="/"&&ve.push("");var k,Y=ve[0]===""||ve[0]&&ve[0].charAt(0)==="/";return Ce&&(D.hostname=D.host=Y?"":ve.length?ve.shift():"",(k=!!(D.host&&D.host.indexOf("@")>0)&&D.host.split("@"))&&(D.auth=k.shift(),D.host=D.hostname=k.shift())),(ne=ne||D.host&&ve.length)&&!Y&&ve.unshift(""),ve.length?D.pathname=ve.join("/"):(D.pathname=null,D.path=null),o.isNull(D.pathname)&&o.isNull(D.search)||(D.path=(D.pathname?D.pathname:"")+(D.search?D.search:"")),D.auth=T.auth||D.auth,D.slashes=D.slashes||T.slashes,D.href=D.format(),D},s.prototype.parseHost=function(){var T=this.host,_=c.exec(T);_&&((_=_[0])!==":"&&(this.port=_.substr(1)),T=T.substr(0,T.length-_.length)),T&&(this.hostname=T)}},function(n,r,i){(function(a,o){var s;/*! https://mths.be/punycode v1.4.1 by @mathias */(function(l){r&&r.nodeType,a&&a.nodeType;var c=typeof o=="object"&&o;c.global!==c&&c.window!==c&&c.self;var f,u=2147483647,d=/^xn--/,h=/[^\x20-\x7E]/,p=/[\x2E\u3002\uFF0E\uFF61]/g,g={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},m=Math.floor,y=String.fromCharCode;function v(O){throw new RangeError(g[O])}function x(O,P){for(var N=O.length,A=[];N--;)A[N]=P(O[N]);return A}function w(O,P){var N=O.split("@"),A="";return N.length>1&&(A=N[0]+"@",O=N[1]),A+x((O=O.replace(p,".")).split("."),P).join(".")}function S(O){for(var P,N,A=[],B=0,V=O.length;B<V;)(P=O.charCodeAt(B++))>=55296&&P<=56319&&B<V?(64512&(N=O.charCodeAt(B++)))==56320?A.push(((1023&P)<<10)+(1023&N)+65536):(A.push(P),B--):A.push(P);return A}function T(O){return x(O,(function(P){var N="";return P>65535&&(N+=y((P-=65536)>>>10&1023|55296),P=56320|1023&P),N+=y(P)})).join("")}function _(O,P){return O+22+75*(O<26)-((P!=0)<<5)}function D(O,P,N){var A=0;for(O=N?m(O/700):O>>1,O+=m(O/P);O>455;A+=36)O=m(O/35);return m(A+36*O/(O+38))}function I(O){var P,N,A,B,V,$,U,G,F,J,Q,ne=[],ye=O.length,ve=0,Ce=128,we=72;for((N=O.lastIndexOf("-"))<0&&(N=0),A=0;A<N;++A)O.charCodeAt(A)>=128&&v("not-basic"),ne.push(O.charCodeAt(A));for(B=N>0?N+1:0;B<ye;){for(V=ve,$=1,U=36;B>=ye&&v("invalid-input"),((G=(Q=O.charCodeAt(B++))-48<10?Q-22:Q-65<26?Q-65:Q-97<26?Q-97:36)>=36||G>m((u-ve)/$))&&v("overflow"),ve+=G*$,!(G<(F=U<=we?1:U>=we+26?26:U-we));U+=36)$>m(u/(J=36-F))&&v("overflow"),$*=J;we=D(ve-V,P=ne.length+1,V==0),m(ve/P)>u-Ce&&v("overflow"),Ce+=m(ve/P),ve%=P,ne.splice(ve++,0,Ce)}return T(ne)}function R(O){var P,N,A,B,V,$,U,G,F,J,Q,ne,ye,ve,Ce,we=[];for(ne=(O=S(O)).length,P=128,N=0,V=72,$=0;$<ne;++$)(Q=O[$])<128&&we.push(y(Q));for(A=B=we.length,B&&we.push("-");A<ne;){for(U=u,$=0;$<ne;++$)(Q=O[$])>=P&&Q<U&&(U=Q);for(U-P>m((u-N)/(ye=A+1))&&v("overflow"),N+=(U-P)*ye,P=U,$=0;$<ne;++$)if((Q=O[$])<P&&++N>u&&v("overflow"),Q==P){for(G=N,F=36;!(G<(J=F<=V?1:F>=V+26?26:F-V));F+=36)Ce=G-J,ve=36-J,we.push(y(_(J+Ce%ve,0))),G=m(Ce/ve);we.push(y(_(G,0))),V=D(N,ye,A==B),N=0,++A}++N,++P}return we.join("")}f={version:"1.4.1",ucs2:{decode:S,encode:T},decode:I,encode:R,toASCII:function(O){return w(O,(function(P){return h.test(P)?"xn--"+R(P):P}))},toUnicode:function(O){return w(O,(function(P){return d.test(P)?I(P.slice(4).toLowerCase()):P}))}},(s=(function(){return f}).call(r,i,r,a))===void 0||(a.exports=s)})()}).call(this,i(246)(n),i(78))},function(n,r){n.exports=function(i){return i.webpackPolyfill||(i.deprecate=function(){},i.paths=[],i.children||(i.children=[]),Object.defineProperty(i,"loaded",{enumerable:!0,get:function(){return i.l}}),Object.defineProperty(i,"id",{enumerable:!0,get:function(){return i.i}}),i.webpackPolyfill=1),i}},function(n,r,i){n.exports={isString:function(a){return typeof a=="string"},isObject:function(a){return typeof a=="object"&&a!==null},isNull:function(a){return a===null},isNullOrUndefined:function(a){return a==null}}},function(n,r,i){r.decode=r.parse=i(249),r.encode=r.stringify=i(250)},function(n,r,i){function a(s,l){return Object.prototype.hasOwnProperty.call(s,l)}n.exports=function(s,l,c,f){l=l||"&",c=c||"=";var u={};if(typeof s!="string"||s.length===0)return u;var d=/\+/g;s=s.split(l);var h=1e3;f&&typeof f.maxKeys=="number"&&(h=f.maxKeys);var p=s.length;h>0&&p>h&&(p=h);for(var g=0;g<p;++g){var m,y,v,x,w=s[g].replace(d,"%20"),S=w.indexOf(c);S>=0?(m=w.substr(0,S),y=w.substr(S+1)):(m=w,y=""),v=decodeURIComponent(m),x=decodeURIComponent(y),a(u,v)?o(u[v])?u[v].push(x):u[v]=[u[v],x]:u[v]=x}return u};var o=Array.isArray||function(s){return Object.prototype.toString.call(s)==="[object Array]"}},function(n,r,i){var a=function(c){switch(typeof c){case"string":return c;case"boolean":return c?"true":"false";case"number":return isFinite(c)?c:"";default:return""}};n.exports=function(c,f,u,d){return f=f||"&",u=u||"=",c===null&&(c=void 0),typeof c=="object"?s(l(c),(function(h){var p=encodeURIComponent(a(h))+u;return o(c[h])?s(c[h],(function(g){return p+encodeURIComponent(a(g))})).join(f):p+encodeURIComponent(a(c[h]))})).join(f):d?encodeURIComponent(a(d))+u+encodeURIComponent(a(c)):""};var o=Array.isArray||function(c){return Object.prototype.toString.call(c)==="[object Array]"};function s(c,f){if(c.map)return c.map(f);for(var u=[],d=0;d<c.length;d++)u.push(f(c[d],d));return u}var l=Object.keys||function(c){var f=[];for(var u in c)Object.prototype.hasOwnProperty.call(c,u)&&f.push(u);return f}},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(52);r.attr_setAnExistingAttributeValue=function(o,s){o._element===null?o._value=s:a.element_change(o,o._element,s)}},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(108),o=i(30),s=i(52);r.tokenList_validationSteps=function(l,c){if(!o.dom_hasSupportedTokens(l._attribute._localName))throw new TypeError("There are no supported tokens defined for attribute name: '"+l._attribute._localName+"'.");return o.dom_getSupportedTokens(l._attribute._localName).has(c.toLowerCase())},r.tokenList_updateSteps=function(l){(l._element.hasAttribute(l._attribute._localName)||l._tokenSet.size!==0)&&s.element_setAnAttributeValue(l._element,l._attribute._localName,a.orderedSet_serialize(l._tokenSet))},r.tokenList_serializeSteps=function(l){return s.element_getAnAttributeValue(l._element,l._attribute._localName)}},function(n,r,i){var a=this&&this.__values||function(l){var c=typeof Symbol=="function"&&Symbol.iterator,f=c&&l[c],u=0;if(f)return f.call(l);if(l&&typeof l.length=="number")return{next:function(){return l&&u>=l.length&&(l=void 0),{value:l&&l[u++],done:!l}}};throw new TypeError(c?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var o=i(1);function s(l){return o.isBoolean(l)?l:l.capture||!1}r.eventTarget_flatten=s,r.eventTarget_flattenMore=function(l){var c=s(l),f=!1,u=!1;return o.isBoolean(l)||(f=l.once||!1,u=l.passive||!1),[c,u,f]},r.eventTarget_addEventListener=function(l,c){if(c.callback!==null){for(var f=0;f<l._eventListenerList.length;f++){var u=l._eventListenerList[f];if(u.type===c.type&&u.callback.handleEvent===c.callback.handleEvent&&u.capture===c.capture)return}l._eventListenerList.push(c)}},r.eventTarget_removeEventListener=function(l,c,f){c.removed=!0,l._eventListenerList.splice(f,1)},r.eventTarget_removeAllEventListeners=function(l){var c,f;try{for(var u=a(l._eventListenerList),d=u.next();!d.done;d=u.next())d.value.removed=!0}catch(h){c={error:h}}finally{try{d&&!d.done&&(f=u.return)&&f.call(u)}finally{if(c)throw c.error}}l._eventListenerList.length=0}},function(n,r,i){var a=this&&this.__values||function(l){var c=typeof Symbol=="function"&&Symbol.iterator,f=c&&l[c],u=0;if(f)return f.call(l);if(l&&typeof l.length=="number")return{next:function(){return l&&u>=l.length&&(l=void 0),{value:l&&l[u++],done:!l}}};throw new TypeError(c?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var o=i(1),s=i(29);r.parentNode_convertNodesIntoANode=function(l,c){for(var f,u,d=null,h=0;h<l.length;h++){var p=l[h];if(o.isString(p)){var g=s.create_text(c,p);l[h]=g}}if(l.length===1)d=l[0];else{var m=d=s.create_documentFragment(c);try{for(var y=a(l),v=y.next();!v.done;v=y.next())p=v.value,m.appendChild(p)}catch(x){f={error:x}}finally{try{v&&!v.done&&(u=y.return)&&u.call(y)}finally{if(f)throw f.error}}}return d}},function(n,r,i){var a=this&&this.__values||function(_){var D=typeof Symbol=="function"&&Symbol.iterator,I=D&&_[D],R=0;if(I)return I.call(_);if(_&&typeof _.length=="number")return{next:function(){return _&&R>=_.length&&(_=void 0),{value:_&&_[R++],done:!_}}};throw new TypeError(D?"Object is not iterable.":"Symbol.iterator is not defined.")},o=this&&this.__read||function(_,D){var I=typeof Symbol=="function"&&_[Symbol.iterator];if(!I)return _;var R,O,P=I.call(_),N=[];try{for(;(D===void 0||D-- >0)&&!(R=P.next()).done;)N.push(R.value)}catch(A){O={error:A}}finally{try{R&&!R.done&&(I=P.return)&&I.call(P)}finally{if(O)throw O.error}}return N},s=this&&this.__spread||function(){for(var _=[],D=0;D<arguments.length;D++)_=_.concat(o(arguments[D]));return _};Object.defineProperty(r,"__esModule",{value:!0});var l=i(2),c=i(9),f=i(3),u=i(29),d=i(17),h=i(175),p=i(107),g=i(176),m=i(37),y=i(177);function v(_){return _._startNode===_._endNode&&_._startOffset===_._endOffset}function x(_){return d.tree_rootNode(_._startNode)}function w(_,D){return d.tree_rootNode(_)===x(D)&&h.boundaryPoint_position([_,0],D._start)===l.BoundaryPosition.After&&h.boundaryPoint_position([_,d.tree_nodeLength(_)],D._end)===l.BoundaryPosition.Before}function S(_,D){var I=d.tree_isAncestorOf(D._startNode,_,!0),R=d.tree_isAncestorOf(D._endNode,_,!0);return I&&!R||!I&&R}function T(_){var D,I,R,O,P,N,A=u.create_documentFragment(_._startNode._nodeDocument);if(v(_))return A;var B=_._startNode,V=_._startOffset,$=_._endNode,U=_._endOffset;if(B===$&&f.Guard.isCharacterDataNode(B))return(X=g.node_clone(B))._data=p.characterData_substringData(B,V,U-V),m.mutation_append(X,A),p.characterData_replaceData(B,V,U-V,""),A;for(var G=B;!d.tree_isAncestorOf($,G,!0);){if(G._parent===null)throw new Error("Parent node  is null.");G=G._parent}var F=null;if(!d.tree_isAncestorOf($,B,!0))try{for(var J=a(G._children),Q=J.next();!Q.done;Q=J.next())if(S(Ce=Q.value,_)){F=Ce;break}}catch(Oe){D={error:Oe}}finally{try{Q&&!Q.done&&(I=J.return)&&I.call(J)}finally{if(D)throw D.error}}var ne=null;if(!d.tree_isAncestorOf(B,$,!0))for(var ye=s(G._children),ve=ye.length-1;ve>0;ve--){var Ce;if(S(Ce=ye[ve],_)){ne=Ce;break}}var we,Ae,Me=[];try{for(var q=a(G._children),k=q.next();!k.done;k=q.next())if(w(Ee=k.value,_)){if(f.Guard.isDocumentTypeNode(Ee))throw new c.HierarchyRequestError;Me.push(Ee)}}catch(Oe){R={error:Oe}}finally{try{k&&!k.done&&(O=q.return)&&O.call(q)}finally{if(R)throw R.error}}if(d.tree_isAncestorOf($,B,!0))we=B,Ae=V;else{for(var Y=B;Y._parent!==null&&!d.tree_isAncestorOf($,Y._parent);)Y=Y._parent;if(Y._parent===null)throw new Error("Parent node is null.");we=Y._parent,Ae=1+d.tree_index(Y)}if(f.Guard.isCharacterDataNode(F))(X=g.node_clone(B))._data=p.characterData_substringData(B,V,d.tree_nodeLength(B)-V),m.mutation_append(X,A),p.characterData_replaceData(B,V,d.tree_nodeLength(B)-V,"");else if(F!==null){var X=g.node_clone(F);m.mutation_append(X,A);var re=T(u.create_range([B,V],[F,d.tree_nodeLength(F)]));m.mutation_append(re,X)}try{for(var de=a(Me),he=de.next();!he.done;he=de.next()){var Ee=he.value;m.mutation_append(Ee,A)}}catch(Oe){P={error:Oe}}finally{try{he&&!he.done&&(N=de.return)&&N.call(de)}finally{if(P)throw P.error}}return f.Guard.isCharacterDataNode(ne)?((X=g.node_clone($))._data=p.characterData_substringData($,0,U),m.mutation_append(X,A),p.characterData_replaceData($,0,U,"")):ne!==null&&(X=g.node_clone(ne),m.mutation_append(X,A),re=T(u.create_range([ne,0],[$,U])),m.mutation_append(re,X)),_._start=[we,Ae],_._end=[we,Ae],A}r.range_collapsed=v,r.range_root=x,r.range_isContained=w,r.range_isPartiallyContained=S,r.range_setTheStart=function(_,D,I){if(f.Guard.isDocumentTypeNode(D))throw new c.InvalidNodeTypeError;if(I>d.tree_nodeLength(D))throw new c.IndexSizeError;var R=[D,I];x(_)===d.tree_rootNode(D)&&h.boundaryPoint_position(R,_._end)!==l.BoundaryPosition.After||(_._end=R),_._start=R},r.range_setTheEnd=function(_,D,I){if(f.Guard.isDocumentTypeNode(D))throw new c.InvalidNodeTypeError;if(I>d.tree_nodeLength(D))throw new c.IndexSizeError;var R=[D,I];x(_)===d.tree_rootNode(D)&&h.boundaryPoint_position(R,_._start)!==l.BoundaryPosition.Before||(_._start=R),_._end=R},r.range_select=function(_,D){var I=_._parent;if(I===null)throw new c.InvalidNodeTypeError;var R=d.tree_index(_);D._start=[I,R],D._end=[I,R+1]},r.range_extract=T,r.range_cloneTheContents=function _(D){var I,R,O,P,N,A,B=u.create_documentFragment(D._startNode._nodeDocument);if(v(D))return B;var V=D._startNode,$=D._startOffset,U=D._endNode,G=D._endOffset;V===U&&f.Guard.isCharacterDataNode(V)&&((k=g.node_clone(V))._data=p.characterData_substringData(V,$,G-$),m.mutation_append(k,B));for(var F=V;!d.tree_isAncestorOf(U,F,!0);){if(F._parent===null)throw new Error("Parent node  is null.");F=F._parent}var J=null;if(!d.tree_isAncestorOf(U,V,!0))try{for(var Q=a(F._children),ne=Q.next();!ne.done;ne=Q.next())if(S(we=ne.value,D)){J=we;break}}catch(he){I={error:he}}finally{try{ne&&!ne.done&&(R=Q.return)&&R.call(Q)}finally{if(I)throw I.error}}var ye=null;if(!d.tree_isAncestorOf(V,U,!0))for(var ve=s(F._children),Ce=ve.length-1;Ce>0;Ce--){var we;if(S(we=ve[Ce],D)){ye=we;break}}var Ae=[];try{for(var Me=a(F._children),q=Me.next();!q.done;q=Me.next())if(w(de=q.value,D)){if(f.Guard.isDocumentTypeNode(de))throw new c.HierarchyRequestError;Ae.push(de)}}catch(he){O={error:he}}finally{try{q&&!q.done&&(P=Me.return)&&P.call(Me)}finally{if(O)throw O.error}}if(f.Guard.isCharacterDataNode(J))(k=g.node_clone(V))._data=p.characterData_substringData(V,$,d.tree_nodeLength(V)-$),m.mutation_append(k,B);else if(J!==null){var k=g.node_clone(J);m.mutation_append(k,B);var Y=_(u.create_range([V,$],[J,d.tree_nodeLength(J)]));m.mutation_append(Y,k)}try{for(var X=a(Ae),re=X.next();!re.done;re=X.next()){var de=re.value,k=g.node_clone(de);m.mutation_append(k,B)}}catch(he){N={error:he}}finally{try{re&&!re.done&&(A=X.return)&&A.call(X)}finally{if(N)throw N.error}}return f.Guard.isCharacterDataNode(ye)?((k=g.node_clone(U))._data=p.characterData_substringData(U,0,G),m.mutation_append(k,B)):ye!==null&&(k=g.node_clone(ye),B.append(k),Y=T(u.create_range([ye,0],[U,G])),m.mutation_append(Y,k)),B},r.range_insert=function(_,D){var I,R;if(f.Guard.isProcessingInstructionNode(D._startNode)||f.Guard.isCommentNode(D._startNode)||f.Guard.isTextNode(D._startNode)&&D._startNode._parent===null||D._startNode===_)throw new c.HierarchyRequestError;var O,P=null;if(f.Guard.isTextNode(D._startNode))P=D._startNode;else{var N=0;try{for(var A=a(D._startNode._children),B=A.next();!B.done;B=A.next()){var V=B.value;if(N===D._startOffset){P=V;break}N++}}catch(U){I={error:U}}finally{try{B&&!B.done&&(R=A.return)&&R.call(A)}finally{if(I)throw I.error}}}if(P===null)O=D._startNode;else{if(P._parent===null)throw new Error("Parent node is null.");O=P._parent}m.mutation_ensurePreInsertionValidity(_,O,P),f.Guard.isTextNode(D._startNode)&&(P=y.text_split(D._startNode,D._startOffset)),_===P&&(P=_._nextSibling),_._parent!==null&&m.mutation_remove(_,_._parent);var $=P===null?d.tree_nodeLength(O):d.tree_index(P);f.Guard.isDocumentFragmentNode(_)?$+=d.tree_nodeLength(_):$++,m.mutation_preInsert(_,O,P),v(D)&&(D._end=[O,$])},r.range_getContainedNodes=function(_){var D;return(D={})[Symbol.iterator]=function(){var I=_.commonAncestorContainer,R=d.tree_getFirstDescendantNode(I);return{next:function(){for(;R&&!w(R,_);)R=d.tree_getNextDescendantNode(I,R);if(R===null)return{done:!0,value:null};var O={done:!1,value:R};return R=d.tree_getNextDescendantNode(I,R),O}}},D},r.range_getPartiallyContainedNodes=function(_){var D;return(D={})[Symbol.iterator]=function(){var I=_.commonAncestorContainer,R=d.tree_getFirstDescendantNode(I);return{next:function(){for(;R&&!S(R,_);)R=d.tree_getNextDescendantNode(I,R);if(R===null)return{done:!0,value:null};var O={done:!1,value:R};return R=d.tree_getNextDescendantNode(I,R),O}}},D}},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(9);r.selectors_scopeMatchASelectorsString=function(o,s){throw new a.NotSupportedError}},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(2),o=i(105);r.treeWalker_traverseChildren=function(s,l){for(var c=l?s._current._firstChild:s._current._lastChild;c!==null;){var f=o.traversal_filter(s,c);if(f===a.FilterResult.Accept)return s._current=c,c;if(f===a.FilterResult.Skip){var u=l?c._firstChild:c._lastChild;if(u!==null){c=u;continue}}for(;c!==null;){var d=l?c._nextSibling:c._previousSibling;if(d!==null){c=d;break}var h=c._parent;if(h===null||h===s._root||h===s._current)return null;c=h}}return null},r.treeWalker_traverseSiblings=function(s,l){var c=s._current;if(c===s._root)return null;for(;;){for(var f=l?c._nextSibling:c._previousSibling;f!==null;){c=f;var u=o.traversal_filter(s,c);if(u===a.FilterResult.Accept)return s._current=c,c;f=l?c._firstChild:c._lastChild,u!==a.FilterResult.Reject&&f!==null||(f=l?c._nextSibling:c._previousSibling)}if((c=c._parent)===null||c===s._root||o.traversal_filter(s,c)===a.FilterResult.Accept)return null}}},function(n,r,i){i(89),i(74);var a,o=this&&this.__extends||(a=function(d,h){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(p,g){p.__proto__=g}||function(p,g){for(var m in g)g.hasOwnProperty(m)&&(p[m]=g[m])})(d,h)},function(d,h){function p(){this.constructor=d}a(d,h),d.prototype=h===null?Object.create(h):(p.prototype=h.prototype,new p)});Object.defineProperty(r,"__esModule",{value:!0});var s=i(1),l=i(2),c=i(50),f=i(3),u=(function(d){function h(p,g){var m=d.call(this,p)||this;return m._indentation={},m._lengthToLastNewline=0,m._writerOptions=s.applyDefaults(g,{wellFormed:!1,headless:!1,prettyPrint:!1,indent:"  ",newline:`
`,offset:0,width:0,allowEmptyTags:!1,indentTextOnlyNodes:!1,spaceBeforeSlash:!1}),m}return o(h,d),h.prototype.serialize=function(p){return this._refs={suppressPretty:!1,emptyNode:!1,markup:""},p.nodeType!==l.NodeType.Document||this._writerOptions.headless||this.declaration(this._builderOptions.version,this._builderOptions.encoding,this._builderOptions.standalone),this.serializeNode(p,this._writerOptions.wellFormed),this._writerOptions.prettyPrint&&this._refs.markup.slice(-this._writerOptions.newline.length)===this._writerOptions.newline&&(this._refs.markup=this._refs.markup.slice(0,-this._writerOptions.newline.length)),this._refs.markup},h.prototype.declaration=function(p,g,m){this._beginLine(),this._refs.markup+='<?xml version="'+p+'"',g!==void 0&&(this._refs.markup+=' encoding="'+g+'"'),m!==void 0&&(this._refs.markup+=' standalone="'+(m?"yes":"no")+'"'),this._refs.markup+="?>",this._endLine()},h.prototype.docType=function(p,g,m){this._beginLine(),this._refs.markup+=g&&m?"<!DOCTYPE "+p+' PUBLIC "'+g+'" "'+m+'">':g?"<!DOCTYPE "+p+' PUBLIC "'+g+'">':m?"<!DOCTYPE "+p+' SYSTEM "'+m+'">':"<!DOCTYPE "+p+">",this._endLine()},h.prototype.openTagBegin=function(p){this._beginLine(),this._refs.markup+="<"+p},h.prototype.openTagEnd=function(p,g,m){if(this._refs.suppressPretty=!1,this._refs.emptyNode=!1,this._writerOptions.prettyPrint&&!g&&!m){for(var y=!0,v=!0,x=this.currentNode.firstChild,w=0,S=0;x;){if(f.Guard.isExclusiveTextNode(x))S++;else{if(!f.Guard.isCDATASectionNode(x)){y=!1,v=!1;break}w++}x.data!==""&&(v=!1),x=x.nextSibling}this._refs.suppressPretty=!this._writerOptions.indentTextOnlyNodes&&y&&(w<=1&&S===0||w===0),this._refs.emptyNode=v}(m||g||this._refs.emptyNode)&&this._writerOptions.allowEmptyTags?this._refs.markup+="></"+p+">":this._refs.markup+=m?" />":g||this._refs.emptyNode?this._writerOptions.spaceBeforeSlash?" />":"/>":">",this._endLine()},h.prototype.closeTag=function(p){this._refs.emptyNode||(this._beginLine(),this._refs.markup+="</"+p+">"),this._refs.suppressPretty=!1,this._refs.emptyNode=!1,this._endLine()},h.prototype.attribute=function(p,g){var m=p+'="'+g+'"';this._writerOptions.prettyPrint&&this._writerOptions.width>0&&this._refs.markup.length-this._lengthToLastNewline+1+m.length>this._writerOptions.width?(this._endLine(),this._beginLine(),this._refs.markup+=this._indent(1)+m):this._refs.markup+=" "+m},h.prototype.text=function(p){p!==""&&(this._beginLine(),this._refs.markup+=p,this._endLine())},h.prototype.cdata=function(p){p!==""&&(this._beginLine(),this._refs.markup+="<![CDATA["+p+"]]>",this._endLine())},h.prototype.comment=function(p){this._beginLine(),this._refs.markup+="<!--"+p+"-->",this._endLine()},h.prototype.instruction=function(p,g){this._beginLine(),this._refs.markup+="<?"+(g===""?p:p+" "+g)+"?>",this._endLine()},h.prototype._beginLine=function(){this._writerOptions.prettyPrint&&!this._refs.suppressPretty&&(this._refs.markup+=this._indent(this._writerOptions.offset+this.level))},h.prototype._endLine=function(){this._writerOptions.prettyPrint&&!this._refs.suppressPretty&&(this._refs.markup+=this._writerOptions.newline,this._lengthToLastNewline=this._refs.markup.length)},h.prototype._indent=function(p){if(p<=0)return"";if(this._indentation[p]!==void 0)return this._indentation[p];var g=this._writerOptions.indent.repeat(p);return this._indentation[p]=g,g},h})(c.BaseWriter);r.XMLWriter=u},function(n,r,i){var a=i(47),o=i(35);n.exports="".repeat||function(s){var l=String(o(this)),c="",f=a(s);if(f<0||f==1/0)throw RangeError("Wrong number of repetitions");for(;f>0;(f>>>=1)&&(l+=l))1&f&&(c+=l);return c}},function(n,r,i){i(31),i(32),i(33),i(19),i(178),i(20),i(22),i(23);var a,o=this&&this.__extends||(a=function(u,d){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,p){h.__proto__=p}||function(h,p){for(var g in p)p.hasOwnProperty(g)&&(h[g]=p[g])})(u,d)},function(u,d){function h(){this.constructor=u}a(u,d),u.prototype=d===null?Object.create(d):(h.prototype=d.prototype,new h)}),s=this&&this.__values||function(u){var d=typeof Symbol=="function"&&Symbol.iterator,h=d&&u[d],p=0;if(h)return h.call(u);if(u&&typeof u.length=="number")return{next:function(){return u&&p>=u.length&&(u=void 0),{value:u&&u[p++],done:!u}}};throw new TypeError(d?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var l=i(67),c=i(1),f=(function(u){function d(h,p){var g=u.call(this,h)||this;return g._writerOptions=c.applyDefaults(p,{wellFormed:!1,prettyPrint:!1,indent:"  ",newline:`
`,offset:0,group:!1,verbose:!1}),g}return o(d,u),d.prototype.serialize=function(h){var p=c.applyDefaults(this._writerOptions,{format:"object",wellFormed:!1}),g=new l.ObjectWriter(this._builderOptions,p).serialize(h);return this._beginLine(this._writerOptions,0)+this._convertObject(g,this._writerOptions)},d.prototype._convertObject=function(h,p,g){var m,y,v=this;g===void 0&&(g=0);var x="",w=this._isLeafNode(h);if(c.isArray(h)){x+="[";var S=h.length,T=0;try{for(var _=s(h),D=_.next();!D.done;D=_.next()){var I=D.value;x+=this._endLine(p,g+1)+this._beginLine(p,g+1)+this._convertObject(I,p,g+1),T<S-1&&(x+=","),T++}}catch(P){m={error:P}}finally{try{D&&!D.done&&(y=_.return)&&y.call(_)}finally{if(m)throw m.error}}x+=this._endLine(p,g)+this._beginLine(p,g),x+="]"}else if(c.isObject(h)){x+="{";var R=c.objectLength(h),O=0;c.forEachObject(h,(function(P,N){w&&p.prettyPrint?x+=" ":x+=v._endLine(p,g+1)+v._beginLine(p,g+1),x+=v._key(P),p.prettyPrint&&(x+=" "),x+=v._convertObject(N,p,g+1),O<R-1&&(x+=","),O++}),this),w&&p.prettyPrint?x+=" ":x+=this._endLine(p,g)+this._beginLine(p,g),x+="}"}else x+=this._val(h);return x},d.prototype._beginLine=function(h,p){if(!h.prettyPrint)return"";var g=h.offset+p+1;return g>0?new Array(g).join(h.indent):""},d.prototype._endLine=function(h,p){return h.prettyPrint?h.newline:""},d.prototype._key=function(h){return'"'+h+'":'},d.prototype._val=function(h){return JSON.stringify(h)},d.prototype._isLeafNode=function(h){return this._descendantCount(h)<=1},d.prototype._descendantCount=function(h,p){var g=this;return p===void 0&&(p=0),c.isArray(h)?c.forEachArray(h,(function(m){return p+=g._descendantCount(m,p)}),this):c.isObject(h)?c.forEachObject(h,(function(m,y){return p+=g._descendantCount(y,p)}),this):p++,p},d})(i(50).BaseWriter);r.JSONWriter=f},function(n,r,i){i(31),i(32),i(33),i(19),i(178),i(89),i(20),i(22),i(23);var a,o=this&&this.__extends||(a=function(u,d){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,p){h.__proto__=p}||function(h,p){for(var g in p)p.hasOwnProperty(g)&&(h[g]=p[g])})(u,d)},function(u,d){function h(){this.constructor=u}a(u,d),u.prototype=d===null?Object.create(d):(h.prototype=d.prototype,new h)}),s=this&&this.__values||function(u){var d=typeof Symbol=="function"&&Symbol.iterator,h=d&&u[d],p=0;if(h)return h.call(u);if(u&&typeof u.length=="number")return{next:function(){return u&&p>=u.length&&(u=void 0),{value:u&&u[p++],done:!u}}};throw new TypeError(d?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var l=i(67),c=i(1),f=(function(u){function d(h,p){var g=u.call(this,h)||this;if(g._writerOptions=c.applyDefaults(p,{wellFormed:!1,indent:"  ",newline:`
`,offset:0,group:!1,verbose:!1}),g._writerOptions.indent.length<2)throw new Error("YAML indententation string must be at least two characters long.");if(g._writerOptions.offset<0)throw new Error("YAML offset should be zero or a positive number.");return g}return o(d,u),d.prototype.serialize=function(h){var p=c.applyDefaults(this._writerOptions,{format:"object",wellFormed:!1}),g=new l.ObjectWriter(this._builderOptions,p).serialize(h),m=this._beginLine(this._writerOptions,0)+"---"+this._endLine(this._writerOptions)+this._convertObject(g,this._writerOptions,0);return m.slice(-this._writerOptions.newline.length)===this._writerOptions.newline&&(m=m.slice(0,-this._writerOptions.newline.length)),m},d.prototype._convertObject=function(h,p,g,m){var y,v,x=this;m===void 0&&(m=!1);var w="";if(c.isArray(h))try{for(var S=s(h),T=S.next();!T.done;T=S.next()){var _=T.value;w+=this._beginLine(p,g,!0),c.isObject(_)?c.isEmpty(_)?w+='""'+this._endLine(p):w+=this._convertObject(_,p,g,!0):w+=this._val(_)+this._endLine(p)}}catch(D){y={error:D}}finally{try{T&&!T.done&&(v=S.return)&&v.call(S)}finally{if(y)throw y.error}}else c.forEachObject(h,(function(D,I){m?(w+=x._key(D),m=!1):w+=x._beginLine(p,g)+x._key(D),c.isObject(I)?c.isEmpty(I)?w+=' ""'+x._endLine(p):w+=x._endLine(p)+x._convertObject(I,p,g+1):w+=" "+x._val(I)+x._endLine(p)}),this);return w},d.prototype._beginLine=function(h,p,g){g===void 0&&(g=!1);var m=h.offset+p+1,y=new Array(m).join(h.indent);return g?y.substr(0,y.length-2)+"-"+y.substr(-1,1):y},d.prototype._endLine=function(h){return h.newline},d.prototype._key=function(h){return'"'+h+'":'},d.prototype._val=function(h){return JSON.stringify(h)},d})(i(50).BaseWriter);r.YAMLWriter=f},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),i(110).dom.setFeatures(!0);var a=i(110);r.DOMImplementation=a.DOMImplementation;var o=i(271);r.DOMParser=o.DOMParser;var s=i(274);r.XMLSerializer=s.XMLSerializer},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(3),o=i(0),s=(function(){function l(){}return l.prototype.before=function(){for(var c=[],f=0;f<arguments.length;f++)c[f]=arguments[f];var u=a.Cast.asNode(this),d=u._parent;if(d!==null){for(var h=u._previousSibling,p=!0;p&&h;){p=!1;for(var g=0;g<c.length;g++){var m=c[g];if(m===h){h=h._previousSibling,p=!0;break}}}var y=o.parentNode_convertNodesIntoANode(c,u._nodeDocument);h=h===null?d._firstChild:h._nextSibling,o.mutation_preInsert(y,d,h)}},l.prototype.after=function(){for(var c=[],f=0;f<arguments.length;f++)c[f]=arguments[f];var u=a.Cast.asNode(this),d=u._parent;if(d){for(var h=u._nextSibling,p=!0;p&&h;){p=!1;for(var g=0;g<c.length;g++){var m=c[g];if(m===h){h=h._nextSibling,p=!0;break}}}var y=o.parentNode_convertNodesIntoANode(c,u._nodeDocument);o.mutation_preInsert(y,d,h)}},l.prototype.replaceWith=function(){for(var c=[],f=0;f<arguments.length;f++)c[f]=arguments[f];var u=a.Cast.asNode(this),d=u._parent;if(d){for(var h=u._nextSibling,p=!0;p&&h;){p=!1;for(var g=0;g<c.length;g++){var m=c[g];if(m===h){h=h._nextSibling,p=!0;break}}}var y=o.parentNode_convertNodesIntoANode(c,u._nodeDocument);u._parent===d?o.mutation_replace(u,y,d):o.mutation_preInsert(y,d,h)}},l.prototype.remove=function(){var c=a.Cast.asNode(this),f=c._parent;f&&o.mutation_remove(c,f)},l})();r.ChildNodeImpl=s},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=function(){};r.DocumentOrShadowRootImpl=a},function(n,r,i){var a=this&&this.__values||function(f){var u=typeof Symbol=="function"&&Symbol.iterator,d=u&&f[u],h=0;if(d)return d.call(f);if(f&&typeof f.length=="number")return{next:function(){return f&&h>=f.length&&(f=void 0),{value:f&&f[h++],done:!f}}};throw new TypeError(u?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var o=i(6),s=i(3),l=i(7),c=(function(){function f(u){this._nodeList=[],this._recordQueue=[],this._callback=u;var d=o.dom.window;l.set.append(d._mutationObservers,this)}return f.prototype.observe=function(u,d){var h,p;if((d=d||{childList:!1,subtree:!1}).attributeOldValue===void 0&&d.attributeFilter===void 0||d.attributes!==void 0||(d.attributes=!0),d.characterDataOldValue!==void 0&&d.characterData===void 0&&(d.characterData=!0),!d.childList&&!d.attributes&&!d.characterData)throw new TypeError;if(d.attributeOldValue&&!d.attributes)throw new TypeError;if(d.attributeFilter!==void 0&&!d.attributes)throw new TypeError;if(d.characterDataOldValue&&!d.characterData)throw new TypeError;var g=!1,m=d,y=function(S){var T,_;if(S.observer===v){g=!0;try{for(var D=(T=void 0,a(v._nodeList)),I=D.next();!I.done;I=D.next()){var R=I.value;l.list.remove(R._registeredObserverList,(function(O){return s.Guard.isTransientRegisteredObserver(O)&&O.source===S}))}}catch(O){T={error:O}}finally{try{I&&!I.done&&(_=D.return)&&_.call(D)}finally{if(T)throw T.error}}S.options=m}},v=this;try{for(var x=a(u._registeredObserverList),w=x.next();!w.done;w=x.next())y(w.value)}catch(S){h={error:S}}finally{try{w&&!w.done&&(p=x.return)&&p.call(x)}finally{if(h)throw h.error}}g||(u._registeredObserverList.push({observer:this,options:d}),this._nodeList.push(u))},f.prototype.disconnect=function(){var u,d,h=this;try{for(var p=a(this._nodeList),g=p.next();!g.done;g=p.next()){var m=g.value;l.list.remove(m._registeredObserverList,(function(y){return y.observer===h}))}}catch(y){u={error:y}}finally{try{g&&!g.done&&(d=p.return)&&d.call(p)}finally{if(u)throw u.error}}this._recordQueue=[]},f.prototype.takeRecords=function(){var u=this._recordQueue;return this._recordQueue=[],u},f})();r.MutationObserverImpl=c},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(3),o=(function(){function s(){}return Object.defineProperty(s.prototype,"previousElementSibling",{get:function(){for(var l=a.Cast.asNode(this)._previousSibling;l;){if(a.Guard.isElementNode(l))return l;l=l._previousSibling}return null},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"nextElementSibling",{get:function(){for(var l=a.Cast.asNode(this)._nextSibling;l;){if(a.Guard.isElementNode(l))return l;l=l._nextSibling}return null},enumerable:!0,configurable:!0}),s})();r.NonDocumentTypeChildNodeImpl=o},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(3),o=i(0),s=(function(){function l(){}return l.prototype.getElementById=function(c){for(var f=o.tree_getFirstDescendantNode(a.Cast.asNode(this),!1,!1,(function(u){return a.Guard.isElementNode(u)}));f!==null;){if(f._uniqueIdentifier===c)return f;f=o.tree_getNextDescendantNode(a.Cast.asNode(this),f,!1,!1,(function(u){return a.Guard.isElementNode(u)}))}return null},l})();r.NonElementParentNodeImpl=s},function(n,r,i){var a=this&&this.__values||function(c){var f=typeof Symbol=="function"&&Symbol.iterator,u=f&&c[f],d=0;if(u)return u.call(c);if(c&&typeof c.length=="number")return{next:function(){return c&&d>=c.length&&(c=void 0),{value:c&&c[d++],done:!c}}};throw new TypeError(f?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var o=i(3),s=i(0),l=(function(){function c(){}return Object.defineProperty(c.prototype,"children",{get:function(){return s.create_htmlCollection(o.Cast.asNode(this))},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"firstElementChild",{get:function(){for(var f=o.Cast.asNode(this)._firstChild;f;){if(o.Guard.isElementNode(f))return f;f=f._nextSibling}return null},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"lastElementChild",{get:function(){for(var f=o.Cast.asNode(this)._lastChild;f;){if(o.Guard.isElementNode(f))return f;f=f._previousSibling}return null},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"childElementCount",{get:function(){var f,u,d=0;try{for(var h=a(o.Cast.asNode(this)._children),p=h.next();!p.done;p=h.next()){var g=p.value;o.Guard.isElementNode(g)&&d++}}catch(m){f={error:m}}finally{try{p&&!p.done&&(u=h.return)&&u.call(h)}finally{if(f)throw f.error}}return d},enumerable:!0,configurable:!0}),c.prototype.prepend=function(){for(var f=[],u=0;u<arguments.length;u++)f[u]=arguments[u];var d=o.Cast.asNode(this),h=s.parentNode_convertNodesIntoANode(f,d._nodeDocument);s.mutation_preInsert(h,d,d._firstChild)},c.prototype.append=function(){for(var f=[],u=0;u<arguments.length;u++)f[u]=arguments[u];var d=o.Cast.asNode(this),h=s.parentNode_convertNodesIntoANode(f,d._nodeDocument);s.mutation_append(h,d)},c.prototype.querySelector=function(f){var u=o.Cast.asNode(this),d=s.selectors_scopeMatchASelectorsString(f,u);return d.length===0?null:d[0]},c.prototype.querySelectorAll=function(f){var u=o.Cast.asNode(this),d=s.selectors_scopeMatchASelectorsString(f,u);return s.create_nodeListStatic(u,d)},c})();r.ParentNodeImpl=l},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(0),o=(function(){function s(){}return Object.defineProperty(s.prototype,"_name",{get:function(){return this.__name||""},set:function(l){this.__name=l},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"_assignedSlot",{get:function(){return this.__assignedSlot||null},set:function(l){this.__assignedSlot=l},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"assignedSlot",{get:function(){return a.shadowTree_findASlot(this,!0)},enumerable:!0,configurable:!0}),s})();r.SlotableImpl=o},function(n,r,i){var a,o=this&&this.__extends||(a=function(u,d){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,p){h.__proto__=p}||function(h,p){for(var g in p)p.hasOwnProperty(g)&&(h[g]=p[g])})(u,d)},function(u,d){function h(){this.constructor=u}a(u,d),u.prototype=d===null?Object.create(d):(h.prototype=d.prototype,new h)});Object.defineProperty(r,"__esModule",{value:!0});var s=i(102),l=i(9),c=i(3),f=(function(u){function d(h){var p=u.call(this)||this;if(c.Guard.isDocumentTypeNode(h.startContainer)||c.Guard.isAttrNode(h.startContainer)||c.Guard.isDocumentTypeNode(h.endContainer)||c.Guard.isAttrNode(h.endContainer))throw new l.InvalidNodeTypeError;return p._start=[h.startContainer,h.startOffset],p._end=[h.endContainer,h.endOffset],p}return o(d,u),d})(s.AbstractRangeImpl);r.StaticRangeImpl=f},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(272);r.DOMParser=a.DOMParserImpl},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(0),o=i(273),s=(function(){function l(){}return l.prototype.parseFromString=function(c,f){if(f==="text/html")throw new Error("HTML parser not implemented.");try{return(u=new o.XMLParserImpl().parse(c))._contentType=f,u}catch(g){var u,d="http://www.mozilla.org/newlayout/xml/parsererror.xml",h=(u=a.create_xmlDocument()).createElementNS(d,"parsererror"),p=u.createElementNS(d,"error");return p.setAttribute("message",g.message),h.appendChild(p),u.appendChild(h),u}},l})();r.DOMParserImpl=s},function(n,r,i){var a=this&&this.__read||function(h,p){var g=typeof Symbol=="function"&&h[Symbol.iterator];if(!g)return h;var m,y,v=g.call(h),x=[];try{for(;(p===void 0||p-- >0)&&!(m=v.next()).done;)x.push(m.value)}catch(w){y={error:w}}finally{try{m&&!m.done&&(g=v.return)&&g.call(v)}finally{if(y)throw y.error}}return x},o=this&&this.__values||function(h){var p=typeof Symbol=="function"&&Symbol.iterator,g=p&&h[p],m=0;if(g)return g.call(h);if(h&&typeof h.length=="number")return{next:function(){return h&&m>=h.length&&(h=void 0),{value:h&&h[m++],done:!h}}};throw new TypeError(p?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var s=i(180),l=i(111),c=i(7),f=i(0),u=i(69),d=(function(){function h(){}return h.prototype.parse=function(p){for(var g,m,y,v,x=new s.XMLStringLexer(p,{skipWhitespaceOnlyText:!0}),w=f.create_document(),S=w,T=x.nextToken();T.type!==l.TokenType.EOF;){switch(T.type){case l.TokenType.Declaration:var _=T;if(_.version!=="1.0")throw new Error("Invalid xml version: "+_.version);break;case l.TokenType.DocType:var D=T;if(!f.xml_isPubidChar(D.pubId))throw new Error("DocType public identifier does not match PubidChar construct.");if(!f.xml_isLegalChar(D.sysId)||D.sysId.indexOf('"')!==-1&&D.sysId.indexOf("'")!==-1)throw new Error("DocType system identifier contains invalid characters.");S.appendChild(w.implementation.createDocumentType(D.name,D.pubId,D.sysId));break;case l.TokenType.CDATA:var I=T;if(!f.xml_isLegalChar(I.data)||I.data.indexOf("]]>")!==-1)throw new Error("CDATA contains invalid characters.");S.appendChild(w.createCDATASection(I.data));break;case l.TokenType.Comment:var R=T;if(!f.xml_isLegalChar(R.data)||R.data.indexOf("--")!==-1||R.data.endsWith("-"))throw new Error("Comment data contains invalid characters.");S.appendChild(w.createComment(R.data));break;case l.TokenType.PI:var O=T;if(O.target.indexOf(":")!==-1||/^xml$/i.test(O.target))throw new Error("Processing instruction target contains invalid characters.");if(!f.xml_isLegalChar(O.data)||O.data.indexOf("?>")!==-1)throw new Error("Processing instruction data contains invalid characters.");S.appendChild(w.createProcessingInstruction(O.target,O.data));break;case l.TokenType.Text:var P=T;if(!f.xml_isLegalChar(P.data))throw new Error("Text data contains invalid characters.");S.appendChild(w.createTextNode(this._decodeText(P.data)));break;case l.TokenType.Element:var N=T,A=a(f.namespace_extractQName(N.name),2),B=A[0],V=A[1];if(V.indexOf(":")!==-1||!f.xml_isName(V))throw new Error("Node local name contains invalid characters.");if(B==="xmlns")throw new Error("An element cannot have the 'xmlns' prefix.");var $=S.lookupNamespaceURI(B),U={};try{for(var G=(g=void 0,o(N.attributes)),F=G.next();!F.done;F=G.next()){var J=a(F.value,2),Q=J[0],ne=J[1];if(Q==="xmlns")$=ne;else{var ye=a(f.namespace_extractQName(Q),2),ve=ye[0],Ce=ye[1];ve==="xmlns"&&(Ce===B&&($=ne),U[Ce]=ne)}}}catch(re){g={error:re}}finally{try{F&&!F.done&&(m=G.return)&&m.call(G)}finally{if(g)throw g.error}}var we=$!==null?w.createElementNS($,N.name):w.createElement(N.name);S.appendChild(we);var Ae=new u.LocalNameSet;try{for(var Me=(y=void 0,o(N.attributes)),q=Me.next();!q.done;q=Me.next()){var k=a(q.value,2),Y=(Q=k[0],ne=k[1],a(f.namespace_extractQName(Q),2)),X=(ve=Y[0],Ce=Y[1],null);if(ve==="xmlns"||ve===null&&Ce==="xmlns"?X=c.namespace.XMLNS:(X=we.lookupNamespaceURI(ve))!==null&&we.isDefaultNamespace(X)?X=null:X===null&&ve!==null&&(X=U[ve]||null),Ae.has(X,Ce))throw new Error("Element contains duplicate attributes.");if(Ae.set(X,Ce),X===c.namespace.XMLNS&&ne===c.namespace.XMLNS)throw new Error("XMLNS namespace is reserved.");if(Ce.indexOf(":")!==-1||!f.xml_isName(Ce))throw new Error("Attribute local name contains invalid characters.");if(ve==="xmlns"&&ne==="")throw new Error("Empty XML namespace is not allowed.");X!==null?we.setAttributeNS(X,Q,this._decodeAttributeValue(ne)):we.setAttribute(Q,this._decodeAttributeValue(ne))}}catch(re){y={error:re}}finally{try{q&&!q.done&&(v=Me.return)&&v.call(Me)}finally{if(y)throw y.error}}N.selfClosing||(S=we);break;case l.TokenType.ClosingTag:if(T.name!==S.nodeName)throw new Error("Closing tag name does not match opening tag name.");S._parent&&(S=S._parent)}T=x.nextToken()}return w},h.prototype._decodeText=function(p){return p==null?p:p.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")},h.prototype._decodeAttributeValue=function(p){return p==null?p:p.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")},h})();r.XMLParserImpl=d},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(275);r.XMLSerializer=a.XMLSerializerImpl},function(n,r,i){var a=this&&this.__values||function(h){var p=typeof Symbol=="function"&&Symbol.iterator,g=p&&h[p],m=0;if(g)return g.call(h);if(h&&typeof h.length=="number")return{next:function(){return h&&m>=h.length&&(h=void 0),{value:h&&h[m++],done:!h}}};throw new TypeError(p?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var o=i(2),s=i(69),l=i(95),c=i(9),f=i(7),u=i(0),d=(function(){function h(){}return h.prototype.serializeToString=function(p){return this._xmlSerialization(p,!1)},h.prototype._xmlSerialization=function(p,g){if(p._nodeDocument===void 0||p._nodeDocument._hasNamespaces){var m=new l.NamespacePrefixMap;m.set("xml",f.namespace.XML);try{return this._serializeNodeNS(p,null,m,{value:1},g)}catch{throw new c.InvalidStateError}}else try{return this._serializeNode(p,g)}catch{throw new c.InvalidStateError}},h.prototype._serializeNodeNS=function(p,g,m,y,v){switch(p.nodeType){case o.NodeType.Element:return this._serializeElementNS(p,g,m,y,v);case o.NodeType.Document:return this._serializeDocumentNS(p,g,m,y,v);case o.NodeType.Comment:return this._serializeComment(p,v);case o.NodeType.Text:return this._serializeText(p,v);case o.NodeType.DocumentFragment:return this._serializeDocumentFragmentNS(p,g,m,y,v);case o.NodeType.DocumentType:return this._serializeDocumentType(p,v);case o.NodeType.ProcessingInstruction:return this._serializeProcessingInstruction(p,v);case o.NodeType.CData:return this._serializeCData(p,v);default:throw new Error("Unknown node type: "+p.nodeType)}},h.prototype._serializeNode=function(p,g){switch(p.nodeType){case o.NodeType.Element:return this._serializeElement(p,g);case o.NodeType.Document:return this._serializeDocument(p,g);case o.NodeType.Comment:return this._serializeComment(p,g);case o.NodeType.Text:return this._serializeText(p,g);case o.NodeType.DocumentFragment:return this._serializeDocumentFragment(p,g);case o.NodeType.DocumentType:return this._serializeDocumentType(p,g);case o.NodeType.ProcessingInstruction:return this._serializeProcessingInstruction(p,g);case o.NodeType.CData:return this._serializeCData(p,g);default:throw new Error("Unknown node type: "+p.nodeType)}},h.prototype._serializeElementNS=function(p,g,m,y,v){var x,w;if(v&&(p.localName.indexOf(":")!==-1||!u.xml_isName(p.localName)))throw new Error("Node local name contains invalid characters (well-formed required).");var S="<",T="",_=!1,D=!1,I=m.copy(),R={},O=this._recordNamespaceInformation(p,I,R),P=g,N=p.namespaceURI;if(P===N)O!==null&&(D=!0),S+=T=N===f.namespace.XML?"xml:"+p.localName:p.localName;else{var A=p.prefix,B=null;if(A===null&&N===O||(B=I.get(A,N)),A==="xmlns"){if(v)throw new Error("An element cannot have the 'xmlns' prefix (well-formed required).");B=A}B!==null?(T=B+":"+p.localName,O!==null&&O!==f.namespace.XML&&(P=O||null),S+=T):A!==null?(A in R&&(A=this._generatePrefix(N,I,y)),I.set(A,N),S+=T+=A+":"+p.localName,S+=" xmlns:"+A+'="'+this._serializeAttributeValue(N,v)+'"',O!==null&&(P=O||null)):O===null||O!==null&&O!==N?(D=!0,P=N,S+=T+=p.localName,S+=' xmlns="'+this._serializeAttributeValue(N,v)+'"'):(P=N,S+=T+=p.localName)}S+=this._serializeAttributesNS(p,I,y,R,D,v);var V=N===f.namespace.HTML;if(V&&p.childNodes.length===0&&h._VoidElementNames.has(p.localName)?(S+=" /",_=!0):V||p.childNodes.length!==0||(S+="/",_=!0),S+=">",_)return S;if(!(V&&p.localName==="template"))try{for(var $=a(p._children||p.childNodes),U=$.next();!U.done;U=$.next()){var G=U.value;S+=this._serializeNodeNS(G,P,I,y,v)}}catch(F){x={error:F}}finally{try{U&&!U.done&&(w=$.return)&&w.call($)}finally{if(x)throw x.error}}return S+="</"+T+">"},h.prototype._serializeDocumentNS=function(p,g,m,y,v){var x,w;if(v&&p.documentElement===null)throw new Error("Missing document element (well-formed required).");var S="";try{for(var T=a(p._children||p.childNodes),_=T.next();!_.done;_=T.next()){var D=_.value;S+=this._serializeNodeNS(D,g,m,y,v)}}catch(I){x={error:I}}finally{try{_&&!_.done&&(w=T.return)&&w.call(T)}finally{if(x)throw x.error}}return S},h.prototype._serializeComment=function(p,g){if(g&&(!u.xml_isLegalChar(p.data)||p.data.indexOf("--")!==-1||p.data.endsWith("-")))throw new Error("Comment data contains invalid characters (well-formed required).");return"<!--"+p.data+"-->"},h.prototype._serializeText=function(p,g){if(g&&!u.xml_isLegalChar(p.data))throw new Error("Text data contains invalid characters (well-formed required).");for(var m="",y=0;y<p.data.length;y++){var v=p.data[y];m+=v==="&"?"&amp;":v==="<"?"&lt;":v===">"?"&gt;":v}return m},h.prototype._serializeDocumentFragmentNS=function(p,g,m,y,v){var x,w,S="";try{for(var T=a(p._children||p.childNodes),_=T.next();!_.done;_=T.next()){var D=_.value;S+=this._serializeNodeNS(D,g,m,y,v)}}catch(I){x={error:I}}finally{try{_&&!_.done&&(w=T.return)&&w.call(T)}finally{if(x)throw x.error}}return S},h.prototype._serializeDocumentType=function(p,g){if(g&&!u.xml_isPubidChar(p.publicId))throw new Error("DocType public identifier does not match PubidChar construct (well-formed required).");if(g&&(!u.xml_isLegalChar(p.systemId)||p.systemId.indexOf('"')!==-1&&p.systemId.indexOf("'")!==-1))throw new Error("DocType system identifier contains invalid characters (well-formed required).");return p.publicId&&p.systemId?"<!DOCTYPE "+p.name+' PUBLIC "'+p.publicId+'" "'+p.systemId+'">':p.publicId?"<!DOCTYPE "+p.name+' PUBLIC "'+p.publicId+'">':p.systemId?"<!DOCTYPE "+p.name+' SYSTEM "'+p.systemId+'">':"<!DOCTYPE "+p.name+">"},h.prototype._serializeProcessingInstruction=function(p,g){if(g&&(p.target.indexOf(":")!==-1||/^xml$/i.test(p.target)))throw new Error("Processing instruction target contains invalid characters (well-formed required).");if(g&&(!u.xml_isLegalChar(p.data)||p.data.indexOf("?>")!==-1))throw new Error("Processing instruction data contains invalid characters (well-formed required).");return"<?"+(p.data===""?p.target:p.target+" "+p.data)+"?>"},h.prototype._serializeCData=function(p,g){if(g&&p.data.indexOf("]]>")!==-1)throw new Error("CDATA contains invalid characters (well-formed required).");return"<![CDATA["+p.data+"]]>"},h.prototype._serializeAttributesNS=function(p,g,m,y,v,x){var w,S,T="",_=x?new s.LocalNameSet:void 0;try{for(var D=a(p.attributes),I=D.next();!I.done;I=D.next()){var R=I.value;if(v||x||R.namespaceURI!==null){if(x&&_&&_.has(R.namespaceURI,R.localName))throw new Error("Element contains duplicate attributes (well-formed required).");x&&_&&_.set(R.namespaceURI,R.localName);var O=R.namespaceURI,P=null;if(O!==null)if(P=g.get(R.prefix,O),O===f.namespace.XMLNS){if(R.value===f.namespace.XML||R.prefix===null&&v||R.prefix!==null&&(!(R.localName in y)||y[R.localName]!==R.value)&&g.has(R.localName,R.value))continue;if(x&&R.value===f.namespace.XMLNS)throw new Error("XMLNS namespace is reserved (well-formed required).");if(x&&R.value==="")throw new Error("Namespace prefix declarations cannot be used to undeclare a namespace (well-formed required).");R.prefix==="xmlns"&&(P="xmlns")}else P===null&&(T+=" xmlns:"+(P=R.prefix===null||g.hasPrefix(R.prefix)&&!g.has(R.prefix,O)?this._generatePrefix(O,g,m):R.prefix)+'="'+this._serializeAttributeValue(O,x)+'"');if(T+=" ",P!==null&&(T+=P+":"),x&&(R.localName.indexOf(":")!==-1||!u.xml_isName(R.localName)||R.localName==="xmlns"&&O===null))throw new Error("Attribute local name contains invalid characters (well-formed required).");T+=R.localName+'="'+this._serializeAttributeValue(R.value,x)+'"'}else T+=" "+R.localName+'="'+this._serializeAttributeValue(R.value,x)+'"'}}catch(N){w={error:N}}finally{try{I&&!I.done&&(S=D.return)&&S.call(D)}finally{if(w)throw w.error}}return T},h.prototype._recordNamespaceInformation=function(p,g,m){var y,v,x=null;try{for(var w=a(p.attributes),S=w.next();!S.done;S=w.next()){var T=S.value,_=T.namespaceURI,D=T.prefix;if(_===f.namespace.XMLNS){if(D===null){x=T.value;continue}var I=T.localName,R=T.value;if(R===f.namespace.XML||(R===""&&(R=null),g.has(I,R)))continue;g.set(I,R),m[I]=R||""}}}catch(O){y={error:O}}finally{try{S&&!S.done&&(v=w.return)&&v.call(w)}finally{if(y)throw y.error}}return x},h.prototype._generatePrefix=function(p,g,m){var y="ns"+m.value;return m.value++,g.set(y,p),y},h.prototype._serializeAttributeValue=function(p,g){if(g&&p!==null&&!u.xml_isLegalChar(p))throw new Error("Invalid characters in attribute value.");if(p===null)return"";for(var m="",y=0;y<p.length;y++){var v=p[y];m+=v==='"'?"&quot;":v==="&"?"&amp;":v==="<"?"&lt;":v===">"?"&gt;":v}return m},h.prototype._serializeElement=function(p,g){var m,y;if(g&&(p.localName.indexOf(":")!==-1||!u.xml_isName(p.localName)))throw new Error("Node local name contains invalid characters (well-formed required).");var v=!1,x=p.localName,w="<"+x;if(w+=this._serializeAttributes(p,g),p._children.size===0&&(w+="/",v=!0),w+=">",v)return w;try{for(var S=a(p._children),T=S.next();!T.done;T=S.next()){var _=T.value;w+=this._serializeNode(_,g)}}catch(D){m={error:D}}finally{try{T&&!T.done&&(y=S.return)&&y.call(S)}finally{if(m)throw m.error}}return w+="</"+x+">"},h.prototype._serializeDocument=function(p,g){var m,y;if(g&&p.documentElement===null)throw new Error("Missing document element (well-formed required).");var v="";try{for(var x=a(p._children),w=x.next();!w.done;w=x.next()){var S=w.value;v+=this._serializeNode(S,g)}}catch(T){m={error:T}}finally{try{w&&!w.done&&(y=x.return)&&y.call(x)}finally{if(m)throw m.error}}return v},h.prototype._serializeDocumentFragment=function(p,g){var m,y,v="";try{for(var x=a(p._children),w=x.next();!w.done;w=x.next()){var S=w.value;v+=this._serializeNode(S,g)}}catch(T){m={error:T}}finally{try{w&&!w.done&&(y=x.return)&&y.call(x)}finally{if(m)throw m.error}}return v},h.prototype._serializeAttributes=function(p,g){var m,y,v="",x=g?{}:void 0;try{for(var w=a(p.attributes),S=w.next();!S.done;S=w.next()){var T=S.value;if(g&&x&&T.localName in x)throw new Error("Element contains duplicate attributes (well-formed required).");if(g&&x&&(x[T.localName]=!0),g&&(T.localName.indexOf(":")!==-1||!u.xml_isName(T.localName)))throw new Error("Attribute local name contains invalid characters (well-formed required).");v+=" "+T.localName+'="'+this._serializeAttributeValue(T.value,g)+'"'}}catch(_){m={error:_}}finally{try{S&&!S.done&&(y=w.return)&&y.call(w)}finally{if(m)throw m.error}}return v},h._VoidElementNames=new Set(["area","base","basefont","bgsound","br","col","embed","frame","hr","img","input","keygen","link","menuitem","meta","param","source","track","wbr"]),h})();r.XMLSerializerImpl=d},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(277);r.XMLReader=a.XMLReader;var o=i(112);r.ObjectReader=o.ObjectReader;var s=i(280);r.JSONReader=s.JSONReader;var l=i(281);r.YAMLReader=l.YAMLReader},function(n,r,i){i(31),i(32),i(33),i(19),i(65),i(20),i(22),i(23);var a,o=this&&this.__extends||(a=function(p,g){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,y){m.__proto__=y}||function(m,y){for(var v in y)y.hasOwnProperty(v)&&(m[v]=y[v])})(p,g)},function(p,g){function m(){this.constructor=p}a(p,g),p.prototype=g===null?Object.create(g):(m.prototype=g.prototype,new m)}),s=this&&this.__read||function(p,g){var m=typeof Symbol=="function"&&p[Symbol.iterator];if(!m)return p;var y,v,x=m.call(p),w=[];try{for(;(g===void 0||g-- >0)&&!(y=x.next()).done;)w.push(y.value)}catch(S){v={error:S}}finally{try{y&&!y.done&&(m=x.return)&&m.call(x)}finally{if(v)throw v.error}}return w},l=this&&this.__values||function(p){var g=typeof Symbol=="function"&&Symbol.iterator,m=g&&p[g],y=0;if(m)return m.call(p);if(p&&typeof p.length=="number")return{next:function(){return p&&y>=p.length&&(p=void 0),{value:p&&p[y++],done:!p}}};throw new TypeError(g?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var c=i(180),f=i(111),u=i(7),d=i(0),h=(function(p){function g(){return p!==null&&p.apply(this,arguments)||this}return o(g,p),g.prototype._parse=function(m,y){for(var v,x,w,S,T=new c.XMLStringLexer(y,{skipWhitespaceOnlyText:!0}),_=m,D=m,I=T.nextToken();I.type!==f.TokenType.EOF;){switch(I.type){case f.TokenType.Declaration:var R=I,O=this.sanitize(R.version);if(O!=="1.0")throw new Error("Invalid xml version: "+O);var P={version:O};R.encoding&&(P.encoding=this.sanitize(R.encoding)),R.standalone&&(P.standalone=this.sanitize(R.standalone)==="yes"),D.set(P);break;case f.TokenType.DocType:var N=I;D=this.docType(D,this.sanitize(N.name),this.sanitize(N.pubId),this.sanitize(N.sysId))||D;break;case f.TokenType.CDATA:var A=I;D=this.cdata(D,this.sanitize(A.data))||D;break;case f.TokenType.Comment:var B=I;D=this.comment(D,this.sanitize(B.data))||D;break;case f.TokenType.PI:var V=I;D=this.instruction(D,this.sanitize(V.target),this.sanitize(V.data))||D;break;case f.TokenType.Text:var $=I;D=this.text(D,this._decodeText(this.sanitize($.data)))||D;break;case f.TokenType.Element:var U=I,G=this.sanitize(U.name),F=s(d.namespace_extractQName(G),1)[0],J=D.node.lookupNamespaceURI(F),Q={};try{for(var ne=(v=void 0,l(U.attributes)),ye=ne.next();!ye.done;ye=ne.next()){var ve=s(ye.value,2),Ce=ve[0],we=ve[1];if(Ce=this.sanitize(Ce),we=this.sanitize(we),Ce==="xmlns")J=we;else{var Ae=s(d.namespace_extractQName(Ce),2),Me=Ae[0],q=Ae[1];Me==="xmlns"&&(q===F&&(J=we),Q[q]=we)}}}catch(Ee){v={error:Ee}}finally{try{ye&&!ye.done&&(x=ne.return)&&x.call(ne)}finally{if(v)throw v.error}}var k=J!==null?this.element(D,J,G):this.element(D,void 0,G);if(k===void 0)break;D.node===m.node&&(_=k);try{for(var Y=(w=void 0,l(U.attributes)),X=Y.next();!X.done;X=Y.next()){var re=s(X.value,2);Ce=re[0],we=re[1],Ce=this.sanitize(Ce),we=this.sanitize(we);var de=s(d.namespace_extractQName(Ce),2),he=(Me=de[0],q=de[1],null);Me==="xmlns"||Me===null&&q==="xmlns"?he=u.namespace.XMLNS:(he=k.node.lookupNamespaceURI(Me))!==null&&k.node.isDefaultNamespace(he)?he=null:he===null&&Me!==null&&(he=Q[Me]||null),he!==null?this.attribute(k,he,Ce,this._decodeAttributeValue(we)):this.attribute(k,void 0,Ce,this._decodeAttributeValue(we))}}catch(Ee){w={error:Ee}}finally{try{X&&!X.done&&(S=Y.return)&&S.call(Y)}finally{if(w)throw w.error}}U.selfClosing||(D=k);break;case f.TokenType.ClosingTag:D.node.parentNode&&(D=D.up())}I=T.nextToken()}return _},g})(i(75).BaseReader);r.XMLReader=h},function(n,r,i){var a=i(4),o=i(279);a({target:"Object",stat:!0,forced:Object.assign!==o},{assign:o})},function(n,r,i){var a=i(16),o=i(8),s=i(61),l=i(85),c=i(79),f=i(27),u=i(41),d=Object.assign,h=Object.defineProperty;n.exports=!d||o((function(){if(a&&d({b:1},d(h({},"a",{enumerable:!0,get:function(){h(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var p={},g={},m=Symbol();return p[m]=7,"abcdefghijklmnopqrst".split("").forEach((function(y){g[y]=y})),d({},p)[m]!=7||s(d({},g)).join("")!="abcdefghijklmnopqrst"}))?function(p,g){for(var m=f(p),y=arguments.length,v=1,x=l.f,w=c.f;y>v;)for(var S,T=u(arguments[v++]),_=x?s(T).concat(x(T)):s(T),D=_.length,I=0;D>I;)S=_[I++],a&&!w.call(T,S)||(m[S]=T[S]);return m}:d},function(n,r,i){var a,o=this&&this.__extends||(a=function(c,f){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,d){u.__proto__=d}||function(u,d){for(var h in d)d.hasOwnProperty(h)&&(u[h]=d[h])})(c,f)},function(c,f){function u(){this.constructor=c}a(c,f),c.prototype=f===null?Object.create(f):(u.prototype=f.prototype,new u)});Object.defineProperty(r,"__esModule",{value:!0});var s=i(112),l=(function(c){function f(){return c!==null&&c.apply(this,arguments)||this}return o(f,c),f.prototype._parse=function(u,d){return new s.ObjectReader(this._builderOptions).parse(u,JSON.parse(d))},f})(i(75).BaseReader);r.JSONReader=l},function(n,r,i){var a,o=this&&this.__extends||(a=function(u,d){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,p){h.__proto__=p}||function(h,p){for(var g in p)p.hasOwnProperty(g)&&(h[g]=p[g])})(u,d)},function(u,d){function h(){this.constructor=u}a(u,d),u.prototype=d===null?Object.create(d):(h.prototype=d.prototype,new h)});Object.defineProperty(r,"__esModule",{value:!0});var s=i(112),l=i(75),c=i(282),f=(function(u){function d(){return u!==null&&u.apply(this,arguments)||this}return o(d,u),d.prototype._parse=function(h,p){var g=c.safeLoad(p);if(g===void 0)throw new Error("Unable to parse YAML document.");return new s.ObjectReader(this._builderOptions).parse(h,g)},d})(l.BaseReader);r.YAMLReader=f},function(n,r,i){var a=i(283);n.exports=a},function(n,r,i){var a=i(284),o=i(303);function s(l){return function(){throw new Error("Function "+l+" is deprecated and cannot be used.")}}n.exports.Type=i(10),n.exports.Schema=i(39),n.exports.FAILSAFE_SCHEMA=i(113),n.exports.JSON_SCHEMA=i(182),n.exports.CORE_SCHEMA=i(181),n.exports.DEFAULT_SAFE_SCHEMA=i(54),n.exports.DEFAULT_FULL_SCHEMA=i(76),n.exports.load=a.load,n.exports.loadAll=a.loadAll,n.exports.safeLoad=a.safeLoad,n.exports.safeLoadAll=a.safeLoadAll,n.exports.dump=o.dump,n.exports.safeDump=o.safeDump,n.exports.YAMLException=i(53),n.exports.MINIMAL_SCHEMA=i(113),n.exports.SAFE_SCHEMA=i(54),n.exports.DEFAULT_SCHEMA=i(76),n.exports.scan=s("scan"),n.exports.parse=s("parse"),n.exports.compose=s("compose"),n.exports.addConstructor=s("addConstructor")},function(n,r,i){var a=i(38),o=i(53),s=i(285),l=i(54),c=i(76),f=Object.prototype.hasOwnProperty,u=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,d=/[\x85\u2028\u2029]/,h=/[,\[\]\{\}]/,p=/^(?:!|!!|![a-z\-]+!)$/i,g=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function m(k){return Object.prototype.toString.call(k)}function y(k){return k===10||k===13}function v(k){return k===9||k===32}function x(k){return k===9||k===32||k===10||k===13}function w(k){return k===44||k===91||k===93||k===123||k===125}function S(k){var Y;return 48<=k&&k<=57?k-48:97<=(Y=32|k)&&Y<=102?Y-97+10:-1}function T(k){return k===48?"\0":k===97?"\x07":k===98?"\b":k===116||k===9?"	":k===110?`
`:k===118?"\v":k===102?"\f":k===114?"\r":k===101?"\x1B":k===32?" ":k===34?'"':k===47?"/":k===92?"\\":k===78?"":k===95?" ":k===76?"\u2028":k===80?"\u2029":""}function _(k){return k<=65535?String.fromCharCode(k):String.fromCharCode(55296+(k-65536>>10),56320+(k-65536&1023))}for(var D=new Array(256),I=new Array(256),R=0;R<256;R++)D[R]=T(R)?1:0,I[R]=T(R);function O(k,Y){this.input=k,this.filename=Y.filename||null,this.schema=Y.schema||c,this.onWarning=Y.onWarning||null,this.legacy=Y.legacy||!1,this.json=Y.json||!1,this.listener=Y.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=k.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.documents=[]}function P(k,Y){return new o(Y,new s(k.filename,k.input,k.position,k.line,k.position-k.lineStart))}function N(k,Y){throw P(k,Y)}function A(k,Y){k.onWarning&&k.onWarning.call(null,P(k,Y))}var B={YAML:function(k,Y,X){var re,de,he;k.version!==null&&N(k,"duplication of %YAML directive"),X.length!==1&&N(k,"YAML directive accepts exactly one argument"),(re=/^([0-9]+)\.([0-9]+)$/.exec(X[0]))===null&&N(k,"ill-formed argument of the YAML directive"),de=parseInt(re[1],10),he=parseInt(re[2],10),de!==1&&N(k,"unacceptable YAML version of the document"),k.version=X[0],k.checkLineBreaks=he<2,he!==1&&he!==2&&A(k,"unsupported YAML version of the document")},TAG:function(k,Y,X){var re,de;X.length!==2&&N(k,"TAG directive accepts exactly two arguments"),re=X[0],de=X[1],p.test(re)||N(k,"ill-formed tag handle (first argument) of the TAG directive"),f.call(k.tagMap,re)&&N(k,'there is a previously declared suffix for "'+re+'" tag handle'),g.test(de)||N(k,"ill-formed tag prefix (second argument) of the TAG directive"),k.tagMap[re]=de}};function V(k,Y,X,re){var de,he,Ee,Oe;if(Y<X){if(Oe=k.input.slice(Y,X),re)for(de=0,he=Oe.length;de<he;de+=1)(Ee=Oe.charCodeAt(de))===9||32<=Ee&&Ee<=1114111||N(k,"expected valid JSON character");else u.test(Oe)&&N(k,"the stream contains non-printable characters");k.result+=Oe}}function $(k,Y,X,re){var de,he,Ee,Oe;for(a.isObject(X)||N(k,"cannot merge mappings; the provided source object is unacceptable"),Ee=0,Oe=(de=Object.keys(X)).length;Ee<Oe;Ee+=1)he=de[Ee],f.call(Y,he)||(Y[he]=X[he],re[he]=!0)}function U(k,Y,X,re,de,he,Ee,Oe){var Pe,Ne;if(Array.isArray(de))for(Pe=0,Ne=(de=Array.prototype.slice.call(de)).length;Pe<Ne;Pe+=1)Array.isArray(de[Pe])&&N(k,"nested arrays are not supported inside keys"),typeof de=="object"&&m(de[Pe])==="[object Object]"&&(de[Pe]="[object Object]");if(typeof de=="object"&&m(de)==="[object Object]"&&(de="[object Object]"),de=String(de),Y===null&&(Y={}),re==="tag:yaml.org,2002:merge")if(Array.isArray(he))for(Pe=0,Ne=he.length;Pe<Ne;Pe+=1)$(k,Y,he[Pe],X);else $(k,Y,he,X);else k.json||f.call(X,de)||!f.call(Y,de)||(k.line=Ee||k.line,k.position=Oe||k.position,N(k,"duplicated mapping key")),Y[de]=he,delete X[de];return Y}function G(k){var Y;(Y=k.input.charCodeAt(k.position))===10?k.position++:Y===13?(k.position++,k.input.charCodeAt(k.position)===10&&k.position++):N(k,"a line break is expected"),k.line+=1,k.lineStart=k.position}function F(k,Y,X){for(var re=0,de=k.input.charCodeAt(k.position);de!==0;){for(;v(de);)de=k.input.charCodeAt(++k.position);if(Y&&de===35)do de=k.input.charCodeAt(++k.position);while(de!==10&&de!==13&&de!==0);if(!y(de))break;for(G(k),de=k.input.charCodeAt(k.position),re++,k.lineIndent=0;de===32;)k.lineIndent++,de=k.input.charCodeAt(++k.position)}return X!==-1&&re!==0&&k.lineIndent<X&&A(k,"deficient indentation"),re}function J(k){var Y,X=k.position;return!((Y=k.input.charCodeAt(X))!==45&&Y!==46||Y!==k.input.charCodeAt(X+1)||Y!==k.input.charCodeAt(X+2)||(X+=3,(Y=k.input.charCodeAt(X))!==0&&!x(Y)))}function Q(k,Y){Y===1?k.result+=" ":Y>1&&(k.result+=a.repeat(`
`,Y-1))}function ne(k,Y){var X,re,de=k.tag,he=k.anchor,Ee=[],Oe=!1;for(k.anchor!==null&&(k.anchorMap[k.anchor]=Ee),re=k.input.charCodeAt(k.position);re!==0&&re===45&&x(k.input.charCodeAt(k.position+1));)if(Oe=!0,k.position++,F(k,!0,-1)&&k.lineIndent<=Y)Ee.push(null),re=k.input.charCodeAt(k.position);else if(X=k.line,Ce(k,Y,3,!1,!0),Ee.push(k.result),F(k,!0,-1),re=k.input.charCodeAt(k.position),(k.line===X||k.lineIndent>Y)&&re!==0)N(k,"bad indentation of a sequence entry");else if(k.lineIndent<Y)break;return!!Oe&&(k.tag=de,k.anchor=he,k.kind="sequence",k.result=Ee,!0)}function ye(k){var Y,X,re,de,he=!1,Ee=!1;if((de=k.input.charCodeAt(k.position))!==33)return!1;if(k.tag!==null&&N(k,"duplication of a tag property"),(de=k.input.charCodeAt(++k.position))===60?(he=!0,de=k.input.charCodeAt(++k.position)):de===33?(Ee=!0,X="!!",de=k.input.charCodeAt(++k.position)):X="!",Y=k.position,he){do de=k.input.charCodeAt(++k.position);while(de!==0&&de!==62);k.position<k.length?(re=k.input.slice(Y,k.position),de=k.input.charCodeAt(++k.position)):N(k,"unexpected end of the stream within a verbatim tag")}else{for(;de!==0&&!x(de);)de===33&&(Ee?N(k,"tag suffix cannot contain exclamation marks"):(X=k.input.slice(Y-1,k.position+1),p.test(X)||N(k,"named tag handle cannot contain such characters"),Ee=!0,Y=k.position+1)),de=k.input.charCodeAt(++k.position);re=k.input.slice(Y,k.position),h.test(re)&&N(k,"tag suffix cannot contain flow indicator characters")}return re&&!g.test(re)&&N(k,"tag name cannot contain such characters: "+re),he?k.tag=re:f.call(k.tagMap,X)?k.tag=k.tagMap[X]+re:X==="!"?k.tag="!"+re:X==="!!"?k.tag="tag:yaml.org,2002:"+re:N(k,'undeclared tag handle "'+X+'"'),!0}function ve(k){var Y,X;if((X=k.input.charCodeAt(k.position))!==38)return!1;for(k.anchor!==null&&N(k,"duplication of an anchor property"),X=k.input.charCodeAt(++k.position),Y=k.position;X!==0&&!x(X)&&!w(X);)X=k.input.charCodeAt(++k.position);return k.position===Y&&N(k,"name of an anchor node must contain at least one character"),k.anchor=k.input.slice(Y,k.position),!0}function Ce(k,Y,X,re,de){var he,Ee,Oe,Pe,Ne,ie,ae,Te,me=1,Se=!1,Ve=!1;if(k.listener!==null&&k.listener("open",k),k.tag=null,k.anchor=null,k.kind=null,k.result=null,he=Ee=Oe=X===4||X===3,re&&F(k,!0,-1)&&(Se=!0,k.lineIndent>Y?me=1:k.lineIndent===Y?me=0:k.lineIndent<Y&&(me=-1)),me===1)for(;ye(k)||ve(k);)F(k,!0,-1)?(Se=!0,Oe=he,k.lineIndent>Y?me=1:k.lineIndent===Y?me=0:k.lineIndent<Y&&(me=-1)):Oe=!1;if(Oe&&(Oe=Se||de),me!==1&&X!==4||(ae=X===1||X===2?Y:Y+1,Te=k.position-k.lineStart,me===1?Oe&&(ne(k,Te)||(function(ue,ut,ht){var Ot,Fe,Qe,st,ot,Mt=ue.tag,Ue=ue.anchor,He={},Ct={},$t=null,bn=null,Tn=null,en=!1,Pn=!1;for(ue.anchor!==null&&(ue.anchorMap[ue.anchor]=He),ot=ue.input.charCodeAt(ue.position);ot!==0;){if(Ot=ue.input.charCodeAt(ue.position+1),Qe=ue.line,st=ue.position,ot!==63&&ot!==58||!x(Ot)){if(!Ce(ue,ht,2,!1,!0))break;if(ue.line===Qe){for(ot=ue.input.charCodeAt(ue.position);v(ot);)ot=ue.input.charCodeAt(++ue.position);if(ot===58)x(ot=ue.input.charCodeAt(++ue.position))||N(ue,"a whitespace character is expected after the key-value separator within a block mapping"),en&&(U(ue,He,Ct,$t,bn,null),$t=bn=Tn=null),Pn=!0,en=!1,Fe=!1,$t=ue.tag,bn=ue.result;else{if(!Pn)return ue.tag=Mt,ue.anchor=Ue,!0;N(ue,"can not read an implicit mapping pair; a colon is missed")}}else{if(!Pn)return ue.tag=Mt,ue.anchor=Ue,!0;N(ue,"can not read a block mapping entry; a multiline key may not be an implicit key")}}else ot===63?(en&&(U(ue,He,Ct,$t,bn,null),$t=bn=Tn=null),Pn=!0,en=!0,Fe=!0):en?(en=!1,Fe=!0):N(ue,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),ue.position+=1,ot=Ot;if((ue.line===Qe||ue.lineIndent>ut)&&(Ce(ue,ut,4,!0,Fe)&&(en?bn=ue.result:Tn=ue.result),en||(U(ue,He,Ct,$t,bn,Tn,Qe,st),$t=bn=Tn=null),F(ue,!0,-1),ot=ue.input.charCodeAt(ue.position)),ue.lineIndent>ut&&ot!==0)N(ue,"bad indentation of a mapping entry");else if(ue.lineIndent<ut)break}return en&&U(ue,He,Ct,$t,bn,null),Pn&&(ue.tag=Mt,ue.anchor=Ue,ue.kind="mapping",ue.result=He),Pn})(k,Te,ae))||(function(ue,ut){var ht,Ot,Fe,Qe,st,ot,Mt,Ue,He,Ct,$t=!0,bn=ue.tag,Tn=ue.anchor,en={};if((Ct=ue.input.charCodeAt(ue.position))===91)Fe=93,ot=!1,Ot=[];else{if(Ct!==123)return!1;Fe=125,ot=!0,Ot={}}for(ue.anchor!==null&&(ue.anchorMap[ue.anchor]=Ot),Ct=ue.input.charCodeAt(++ue.position);Ct!==0;){if(F(ue,!0,ut),(Ct=ue.input.charCodeAt(ue.position))===Fe)return ue.position++,ue.tag=bn,ue.anchor=Tn,ue.kind=ot?"mapping":"sequence",ue.result=Ot,!0;$t||N(ue,"missed comma between flow collection entries"),He=null,Qe=st=!1,Ct===63&&x(ue.input.charCodeAt(ue.position+1))&&(Qe=st=!0,ue.position++,F(ue,!0,ut)),ht=ue.line,Ce(ue,ut,1,!1,!0),Ue=ue.tag,Mt=ue.result,F(ue,!0,ut),Ct=ue.input.charCodeAt(ue.position),!st&&ue.line!==ht||Ct!==58||(Qe=!0,Ct=ue.input.charCodeAt(++ue.position),F(ue,!0,ut),Ce(ue,ut,1,!1,!0),He=ue.result),ot?U(ue,Ot,en,Ue,Mt,He):Qe?Ot.push(U(ue,null,en,Ue,Mt,He)):Ot.push(Mt),F(ue,!0,ut),(Ct=ue.input.charCodeAt(ue.position))===44?($t=!0,Ct=ue.input.charCodeAt(++ue.position)):$t=!1}N(ue,"unexpected end of the stream within a flow collection")})(k,ae)?Ve=!0:(Ee&&(function(ue,ut){var ht,Ot,Fe,Qe,st,ot=1,Mt=!1,Ue=!1,He=ut,Ct=0,$t=!1;if((Qe=ue.input.charCodeAt(ue.position))===124)Ot=!1;else{if(Qe!==62)return!1;Ot=!0}for(ue.kind="scalar",ue.result="";Qe!==0;)if((Qe=ue.input.charCodeAt(++ue.position))===43||Qe===45)ot===1?ot=Qe===43?3:2:N(ue,"repeat of a chomping mode identifier");else{if(!((Fe=48<=(st=Qe)&&st<=57?st-48:-1)>=0))break;Fe===0?N(ue,"bad explicit indentation width of a block scalar; it cannot be less than one"):Ue?N(ue,"repeat of an indentation width identifier"):(He=ut+Fe-1,Ue=!0)}if(v(Qe)){do Qe=ue.input.charCodeAt(++ue.position);while(v(Qe));if(Qe===35)do Qe=ue.input.charCodeAt(++ue.position);while(!y(Qe)&&Qe!==0)}for(;Qe!==0;){for(G(ue),ue.lineIndent=0,Qe=ue.input.charCodeAt(ue.position);(!Ue||ue.lineIndent<He)&&Qe===32;)ue.lineIndent++,Qe=ue.input.charCodeAt(++ue.position);if(!Ue&&ue.lineIndent>He&&(He=ue.lineIndent),y(Qe))Ct++;else{if(ue.lineIndent<He){ot===3?ue.result+=a.repeat(`
`,Mt?1+Ct:Ct):ot===1&&Mt&&(ue.result+=`
`);break}for(Ot?v(Qe)?($t=!0,ue.result+=a.repeat(`
`,Mt?1+Ct:Ct)):$t?($t=!1,ue.result+=a.repeat(`
`,Ct+1)):Ct===0?Mt&&(ue.result+=" "):ue.result+=a.repeat(`
`,Ct):ue.result+=a.repeat(`
`,Mt?1+Ct:Ct),Mt=!0,Ue=!0,Ct=0,ht=ue.position;!y(Qe)&&Qe!==0;)Qe=ue.input.charCodeAt(++ue.position);V(ue,ht,ue.position,!1)}}return!0})(k,ae)||(function(ue,ut){var ht,Ot,Fe;if((ht=ue.input.charCodeAt(ue.position))!==39)return!1;for(ue.kind="scalar",ue.result="",ue.position++,Ot=Fe=ue.position;(ht=ue.input.charCodeAt(ue.position))!==0;)if(ht===39){if(V(ue,Ot,ue.position,!0),(ht=ue.input.charCodeAt(++ue.position))!==39)return!0;Ot=ue.position,ue.position++,Fe=ue.position}else y(ht)?(V(ue,Ot,Fe,!0),Q(ue,F(ue,!1,ut)),Ot=Fe=ue.position):ue.position===ue.lineStart&&J(ue)?N(ue,"unexpected end of the document within a single quoted scalar"):(ue.position++,Fe=ue.position);N(ue,"unexpected end of the stream within a single quoted scalar")})(k,ae)||(function(ue,ut){var ht,Ot,Fe,Qe,st,ot,Mt;if((ot=ue.input.charCodeAt(ue.position))!==34)return!1;for(ue.kind="scalar",ue.result="",ue.position++,ht=Ot=ue.position;(ot=ue.input.charCodeAt(ue.position))!==0;){if(ot===34)return V(ue,ht,ue.position,!0),ue.position++,!0;if(ot===92){if(V(ue,ht,ue.position,!0),y(ot=ue.input.charCodeAt(++ue.position)))F(ue,!1,ut);else if(ot<256&&D[ot])ue.result+=I[ot],ue.position++;else if((st=(Mt=ot)===120?2:Mt===117?4:Mt===85?8:0)>0){for(Fe=st,Qe=0;Fe>0;Fe--)(st=S(ot=ue.input.charCodeAt(++ue.position)))>=0?Qe=(Qe<<4)+st:N(ue,"expected hexadecimal character");ue.result+=_(Qe),ue.position++}else N(ue,"unknown escape sequence");ht=Ot=ue.position}else y(ot)?(V(ue,ht,Ot,!0),Q(ue,F(ue,!1,ut)),ht=Ot=ue.position):ue.position===ue.lineStart&&J(ue)?N(ue,"unexpected end of the document within a double quoted scalar"):(ue.position++,Ot=ue.position)}N(ue,"unexpected end of the stream within a double quoted scalar")})(k,ae)?Ve=!0:(function(ue){var ut,ht,Ot;if((Ot=ue.input.charCodeAt(ue.position))!==42)return!1;for(Ot=ue.input.charCodeAt(++ue.position),ut=ue.position;Ot!==0&&!x(Ot)&&!w(Ot);)Ot=ue.input.charCodeAt(++ue.position);return ue.position===ut&&N(ue,"name of an alias node must contain at least one character"),ht=ue.input.slice(ut,ue.position),ue.anchorMap.hasOwnProperty(ht)||N(ue,'unidentified alias "'+ht+'"'),ue.result=ue.anchorMap[ht],F(ue,!0,-1),!0})(k)?(Ve=!0,k.tag===null&&k.anchor===null||N(k,"alias node should not have any properties")):(function(ue,ut,ht){var Ot,Fe,Qe,st,ot,Mt,Ue,He,Ct=ue.kind,$t=ue.result;if(x(He=ue.input.charCodeAt(ue.position))||w(He)||He===35||He===38||He===42||He===33||He===124||He===62||He===39||He===34||He===37||He===64||He===96||(He===63||He===45)&&(x(Ot=ue.input.charCodeAt(ue.position+1))||ht&&w(Ot)))return!1;for(ue.kind="scalar",ue.result="",Fe=Qe=ue.position,st=!1;He!==0;){if(He===58){if(x(Ot=ue.input.charCodeAt(ue.position+1))||ht&&w(Ot))break}else if(He===35){if(x(ue.input.charCodeAt(ue.position-1)))break}else{if(ue.position===ue.lineStart&&J(ue)||ht&&w(He))break;if(y(He)){if(ot=ue.line,Mt=ue.lineStart,Ue=ue.lineIndent,F(ue,!1,-1),ue.lineIndent>=ut){st=!0,He=ue.input.charCodeAt(ue.position);continue}ue.position=Qe,ue.line=ot,ue.lineStart=Mt,ue.lineIndent=Ue;break}}st&&(V(ue,Fe,Qe,!1),Q(ue,ue.line-ot),Fe=Qe=ue.position,st=!1),v(He)||(Qe=ue.position+1),He=ue.input.charCodeAt(++ue.position)}return V(ue,Fe,Qe,!1),!!ue.result||(ue.kind=Ct,ue.result=$t,!1)})(k,ae,X===1)&&(Ve=!0,k.tag===null&&(k.tag="?")),k.anchor!==null&&(k.anchorMap[k.anchor]=k.result)):me===0&&(Ve=Oe&&ne(k,Te))),k.tag!==null&&k.tag!=="!")if(k.tag==="?"){for(k.result!==null&&k.kind!=="scalar"&&N(k,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+k.kind+'"'),Pe=0,Ne=k.implicitTypes.length;Pe<Ne;Pe+=1)if((ie=k.implicitTypes[Pe]).resolve(k.result)){k.result=ie.construct(k.result),k.tag=ie.tag,k.anchor!==null&&(k.anchorMap[k.anchor]=k.result);break}}else f.call(k.typeMap[k.kind||"fallback"],k.tag)?(ie=k.typeMap[k.kind||"fallback"][k.tag],k.result!==null&&ie.kind!==k.kind&&N(k,"unacceptable node kind for !<"+k.tag+'> tag; it should be "'+ie.kind+'", not "'+k.kind+'"'),ie.resolve(k.result)?(k.result=ie.construct(k.result),k.anchor!==null&&(k.anchorMap[k.anchor]=k.result)):N(k,"cannot resolve a node with !<"+k.tag+"> explicit tag")):N(k,"unknown tag !<"+k.tag+">");return k.listener!==null&&k.listener("close",k),k.tag!==null||k.anchor!==null||Ve}function we(k){var Y,X,re,de,he=k.position,Ee=!1;for(k.version=null,k.checkLineBreaks=k.legacy,k.tagMap={},k.anchorMap={};(de=k.input.charCodeAt(k.position))!==0&&(F(k,!0,-1),de=k.input.charCodeAt(k.position),!(k.lineIndent>0||de!==37));){for(Ee=!0,de=k.input.charCodeAt(++k.position),Y=k.position;de!==0&&!x(de);)de=k.input.charCodeAt(++k.position);for(re=[],(X=k.input.slice(Y,k.position)).length<1&&N(k,"directive name must not be less than one character in length");de!==0;){for(;v(de);)de=k.input.charCodeAt(++k.position);if(de===35){do de=k.input.charCodeAt(++k.position);while(de!==0&&!y(de));break}if(y(de))break;for(Y=k.position;de!==0&&!x(de);)de=k.input.charCodeAt(++k.position);re.push(k.input.slice(Y,k.position))}de!==0&&G(k),f.call(B,X)?B[X](k,X,re):A(k,'unknown document directive "'+X+'"')}F(k,!0,-1),k.lineIndent===0&&k.input.charCodeAt(k.position)===45&&k.input.charCodeAt(k.position+1)===45&&k.input.charCodeAt(k.position+2)===45?(k.position+=3,F(k,!0,-1)):Ee&&N(k,"directives end mark is expected"),Ce(k,k.lineIndent-1,4,!1,!0),F(k,!0,-1),k.checkLineBreaks&&d.test(k.input.slice(he,k.position))&&A(k,"non-ASCII line breaks are interpreted as content"),k.documents.push(k.result),k.position===k.lineStart&&J(k)?k.input.charCodeAt(k.position)===46&&(k.position+=3,F(k,!0,-1)):k.position<k.length-1&&N(k,"end of the stream or a document separator is expected")}function Ae(k,Y){Y=Y||{},(k=String(k)).length!==0&&(k.charCodeAt(k.length-1)!==10&&k.charCodeAt(k.length-1)!==13&&(k+=`
`),k.charCodeAt(0)===65279&&(k=k.slice(1)));var X=new O(k,Y),re=k.indexOf("\0");for(re!==-1&&(X.position=re,N(X,"null byte is not allowed in input")),X.input+="\0";X.input.charCodeAt(X.position)===32;)X.lineIndent+=1,X.position+=1;for(;X.position<X.length-1;)we(X);return X.documents}function Me(k,Y,X){Y!==null&&typeof Y=="object"&&X===void 0&&(X=Y,Y=null);var re=Ae(k,X);if(typeof Y!="function")return re;for(var de=0,he=re.length;de<he;de+=1)Y(re[de])}function q(k,Y){var X=Ae(k,Y);if(X.length!==0){if(X.length===1)return X[0];throw new o("expected a single document in the stream, but found more")}}n.exports.loadAll=Me,n.exports.load=q,n.exports.safeLoadAll=function(k,Y,X){return typeof Y=="object"&&Y!==null&&X===void 0&&(X=Y,Y=null),Me(k,Y,a.extend({schema:l},X))},n.exports.safeLoad=function(k,Y){return q(k,a.extend({schema:l},Y))}},function(n,r,i){var a=i(38);function o(s,l,c,f,u){this.name=s,this.buffer=l,this.position=c,this.line=f,this.column=u}o.prototype.getSnippet=function(s,l){var c,f,u,d,h;if(!this.buffer)return null;for(s=s||4,l=l||75,c="",f=this.position;f>0&&`\0\r
\u2028\u2029`.indexOf(this.buffer.charAt(f-1))===-1;)if(f-=1,this.position-f>l/2-1){c=" ... ",f+=5;break}for(u="",d=this.position;d<this.buffer.length&&`\0\r
\u2028\u2029`.indexOf(this.buffer.charAt(d))===-1;)if((d+=1)-this.position>l/2-1){u=" ... ",d-=5;break}return h=this.buffer.slice(f,d),a.repeat(" ",s)+c+h+u+`
`+a.repeat(" ",s+this.position-f+c.length)+"^"},o.prototype.toString=function(s){var l,c="";return this.name&&(c+='in "'+this.name+'" '),c+="at line "+(this.line+1)+", column "+(this.column+1),s||(l=this.getSnippet())&&(c+=`:
`+l),c},n.exports=o},function(n,r,i){var a=i(10);n.exports=new a("tag:yaml.org,2002:str",{kind:"scalar",construct:function(o){return o!==null?o:""}})},function(n,r,i){var a=i(10);n.exports=new a("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(o){return o!==null?o:[]}})},function(n,r,i){var a=i(10);n.exports=new a("tag:yaml.org,2002:map",{kind:"mapping",construct:function(o){return o!==null?o:{}}})},function(n,r,i){var a=i(10);n.exports=new a("tag:yaml.org,2002:null",{kind:"scalar",resolve:function(o){if(o===null)return!0;var s=o.length;return s===1&&o==="~"||s===4&&(o==="null"||o==="Null"||o==="NULL")},construct:function(){return null},predicate:function(o){return o===null},represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"}},defaultStyle:"lowercase"})},function(n,r,i){var a=i(10);n.exports=new a("tag:yaml.org,2002:bool",{kind:"scalar",resolve:function(o){if(o===null)return!1;var s=o.length;return s===4&&(o==="true"||o==="True"||o==="TRUE")||s===5&&(o==="false"||o==="False"||o==="FALSE")},construct:function(o){return o==="true"||o==="True"||o==="TRUE"},predicate:function(o){return Object.prototype.toString.call(o)==="[object Boolean]"},represent:{lowercase:function(o){return o?"true":"false"},uppercase:function(o){return o?"TRUE":"FALSE"},camelcase:function(o){return o?"True":"False"}},defaultStyle:"lowercase"})},function(n,r,i){var a=i(38),o=i(10);function s(c){return 48<=c&&c<=55}function l(c){return 48<=c&&c<=57}n.exports=new o("tag:yaml.org,2002:int",{kind:"scalar",resolve:function(c){if(c===null)return!1;var f,u,d=c.length,h=0,p=!1;if(!d)return!1;if((f=c[h])!=="-"&&f!=="+"||(f=c[++h]),f==="0"){if(h+1===d)return!0;if((f=c[++h])==="b"){for(h++;h<d;h++)if((f=c[h])!=="_"){if(f!=="0"&&f!=="1")return!1;p=!0}return p&&f!=="_"}if(f==="x"){for(h++;h<d;h++)if((f=c[h])!=="_"){if(!(48<=(u=c.charCodeAt(h))&&u<=57||65<=u&&u<=70||97<=u&&u<=102))return!1;p=!0}return p&&f!=="_"}for(;h<d;h++)if((f=c[h])!=="_"){if(!s(c.charCodeAt(h)))return!1;p=!0}return p&&f!=="_"}if(f==="_")return!1;for(;h<d;h++)if((f=c[h])!=="_"){if(f===":")break;if(!l(c.charCodeAt(h)))return!1;p=!0}return!(!p||f==="_")&&(f!==":"||/^(:[0-5]?[0-9])+$/.test(c.slice(h)))},construct:function(c){var f,u,d=c,h=1,p=[];return d.indexOf("_")!==-1&&(d=d.replace(/_/g,"")),(f=d[0])!=="-"&&f!=="+"||(f==="-"&&(h=-1),f=(d=d.slice(1))[0]),d==="0"?0:f==="0"?d[1]==="b"?h*parseInt(d.slice(2),2):d[1]==="x"?h*parseInt(d,16):h*parseInt(d,8):d.indexOf(":")!==-1?(d.split(":").forEach((function(g){p.unshift(parseInt(g,10))})),d=0,u=1,p.forEach((function(g){d+=g*u,u*=60})),h*d):h*parseInt(d,10)},predicate:function(c){return Object.prototype.toString.call(c)==="[object Number]"&&c%1==0&&!a.isNegativeZero(c)},represent:{binary:function(c){return c>=0?"0b"+c.toString(2):"-0b"+c.toString(2).slice(1)},octal:function(c){return c>=0?"0"+c.toString(8):"-0"+c.toString(8).slice(1)},decimal:function(c){return c.toString(10)},hexadecimal:function(c){return c>=0?"0x"+c.toString(16).toUpperCase():"-0x"+c.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}})},function(n,r,i){var a=i(38),o=i(10),s=new RegExp("^(?:[-+]?(?:0|[1-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+\\.[0-9_]*|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$"),l=/^[-+]?[0-9]+e/;n.exports=new o("tag:yaml.org,2002:float",{kind:"scalar",resolve:function(c){return c!==null&&!(!s.test(c)||c[c.length-1]==="_")},construct:function(c){var f,u,d,h;return u=(f=c.replace(/_/g,"").toLowerCase())[0]==="-"?-1:1,h=[],"+-".indexOf(f[0])>=0&&(f=f.slice(1)),f===".inf"?u===1?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:f===".nan"?NaN:f.indexOf(":")>=0?(f.split(":").forEach((function(p){h.unshift(parseFloat(p,10))})),f=0,d=1,h.forEach((function(p){f+=p*d,d*=60})),u*f):u*parseFloat(f,10)},predicate:function(c){return Object.prototype.toString.call(c)==="[object Number]"&&(c%1!=0||a.isNegativeZero(c))},represent:function(c,f){var u;if(isNaN(c))switch(f){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===c)switch(f){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===c)switch(f){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(a.isNegativeZero(c))return"-0.0";return u=c.toString(10),l.test(u)?u.replace("e",".e"):u},defaultStyle:"lowercase"})},function(n,r,i){var a=i(10),o=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),s=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");n.exports=new a("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:function(l){return l!==null&&(o.exec(l)!==null||s.exec(l)!==null)},construct:function(l){var c,f,u,d,h,p,g,m,y=0,v=null;if((c=o.exec(l))===null&&(c=s.exec(l)),c===null)throw new Error("Date resolve error");if(f=+c[1],u=+c[2]-1,d=+c[3],!c[4])return new Date(Date.UTC(f,u,d));if(h=+c[4],p=+c[5],g=+c[6],c[7]){for(y=c[7].slice(0,3);y.length<3;)y+="0";y=+y}return c[9]&&(v=6e4*(60*+c[10]+ +(c[11]||0)),c[9]==="-"&&(v=-v)),m=new Date(Date.UTC(f,u,d,h,p,g,y)),v&&m.setTime(m.getTime()-v),m},instanceOf:Date,represent:function(l){return l.toISOString()}})},function(n,r,i){var a=i(10);n.exports=new a("tag:yaml.org,2002:merge",{kind:"scalar",resolve:function(o){return o==="<<"||o===null}})},function(n,r,i){var a;try{a=i(145).Buffer}catch{}var o=i(10),s=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=
\r`;n.exports=new o("tag:yaml.org,2002:binary",{kind:"scalar",resolve:function(l){if(l===null)return!1;var c,f,u=0,d=l.length,h=s;for(f=0;f<d;f++)if(!((c=h.indexOf(l.charAt(f)))>64)){if(c<0)return!1;u+=6}return u%8==0},construct:function(l){var c,f,u=l.replace(/[\r\n=]/g,""),d=u.length,h=s,p=0,g=[];for(c=0;c<d;c++)c%4==0&&c&&(g.push(p>>16&255),g.push(p>>8&255),g.push(255&p)),p=p<<6|h.indexOf(u.charAt(c));return(f=d%4*6)===0?(g.push(p>>16&255),g.push(p>>8&255),g.push(255&p)):f===18?(g.push(p>>10&255),g.push(p>>2&255)):f===12&&g.push(p>>4&255),a?a.from?a.from(g):new a(g):g},predicate:function(l){return a&&a.isBuffer(l)},represent:function(l){var c,f,u="",d=0,h=l.length,p=s;for(c=0;c<h;c++)c%3==0&&c&&(u+=p[d>>18&63],u+=p[d>>12&63],u+=p[d>>6&63],u+=p[63&d]),d=(d<<8)+l[c];return(f=h%3)===0?(u+=p[d>>18&63],u+=p[d>>12&63],u+=p[d>>6&63],u+=p[63&d]):f===2?(u+=p[d>>10&63],u+=p[d>>4&63],u+=p[d<<2&63],u+=p[64]):f===1&&(u+=p[d>>2&63],u+=p[d<<4&63],u+=p[64],u+=p[64]),u}})},function(n,r,i){var a=i(10),o=Object.prototype.hasOwnProperty,s=Object.prototype.toString;n.exports=new a("tag:yaml.org,2002:omap",{kind:"sequence",resolve:function(l){if(l===null)return!0;var c,f,u,d,h,p=[],g=l;for(c=0,f=g.length;c<f;c+=1){if(u=g[c],h=!1,s.call(u)!=="[object Object]")return!1;for(d in u)if(o.call(u,d)){if(h)return!1;h=!0}if(!h||p.indexOf(d)!==-1)return!1;p.push(d)}return!0},construct:function(l){return l!==null?l:[]}})},function(n,r,i){var a=i(10),o=Object.prototype.toString;n.exports=new a("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:function(s){if(s===null)return!0;var l,c,f,u,d,h=s;for(d=new Array(h.length),l=0,c=h.length;l<c;l+=1){if(f=h[l],o.call(f)!=="[object Object]"||(u=Object.keys(f)).length!==1)return!1;d[l]=[u[0],f[u[0]]]}return!0},construct:function(s){if(s===null)return[];var l,c,f,u,d,h=s;for(d=new Array(h.length),l=0,c=h.length;l<c;l+=1)f=h[l],u=Object.keys(f),d[l]=[u[0],f[u[0]]];return d}})},function(n,r,i){var a=i(10),o=Object.prototype.hasOwnProperty;n.exports=new a("tag:yaml.org,2002:set",{kind:"mapping",resolve:function(s){if(s===null)return!0;var l,c=s;for(l in c)if(o.call(c,l)&&c[l]!==null)return!1;return!0},construct:function(s){return s!==null?s:{}}})},function(n,r,i){var a=i(10);n.exports=new a("tag:yaml.org,2002:js/undefined",{kind:"scalar",resolve:function(){return!0},construct:function(){},predicate:function(o){return o===void 0},represent:function(){return""}})},function(n,r,i){var a=i(10);n.exports=new a("tag:yaml.org,2002:js/regexp",{kind:"scalar",resolve:function(o){if(o===null||o.length===0)return!1;var s=o,l=/\/([gim]*)$/.exec(o),c="";return!(s[0]==="/"&&(l&&(c=l[1]),c.length>3||s[s.length-c.length-1]!=="/"))},construct:function(o){var s=o,l=/\/([gim]*)$/.exec(o),c="";return s[0]==="/"&&(l&&(c=l[1]),s=s.slice(1,s.length-c.length-1)),new RegExp(s,c)},predicate:function(o){return Object.prototype.toString.call(o)==="[object RegExp]"},represent:function(o){var s="/"+o.source+"/";return o.global&&(s+="g"),o.multiline&&(s+="m"),o.ignoreCase&&(s+="i"),s}})},function(n,r,i){var a;try{a=i(302)}catch{typeof window<"u"&&(a=window.esprima)}var o=i(10);n.exports=new o("tag:yaml.org,2002:js/function",{kind:"scalar",resolve:function(s){if(s===null)return!1;try{var l="("+s+")",c=a.parse(l,{range:!0});return c.type==="Program"&&c.body.length===1&&c.body[0].type==="ExpressionStatement"&&(c.body[0].expression.type==="ArrowFunctionExpression"||c.body[0].expression.type==="FunctionExpression")}catch{return!1}},construct:function(s){var l,c="("+s+")",f=a.parse(c,{range:!0}),u=[];if(f.type!=="Program"||f.body.length!==1||f.body[0].type!=="ExpressionStatement"||f.body[0].expression.type!=="ArrowFunctionExpression"&&f.body[0].expression.type!=="FunctionExpression")throw new Error("Failed to resolve function");return f.body[0].expression.params.forEach((function(d){u.push(d.name)})),l=f.body[0].expression.body.range,f.body[0].expression.body.type==="BlockStatement"?new Function(u,c.slice(l[0]+1,l[1]-1)):new Function(u,"return "+c.slice(l[0],l[1]))},predicate:function(s){return Object.prototype.toString.call(s)==="[object Function]"},represent:function(s){return s.toString()}})},function(n,r,i){var a;a=function(){return(function(o){var s={};function l(c){if(s[c])return s[c].exports;var f=s[c]={exports:{},id:c,loaded:!1};return o[c].call(f.exports,f,f.exports,l),f.loaded=!0,f.exports}return l.m=o,l.c=s,l.p="",l(0)})([function(o,s,l){Object.defineProperty(s,"__esModule",{value:!0});var c=l(1),f=l(3),u=l(8),d=l(15);function h(g,m,y){var v=null,x=function(R,O){y&&y(R,O),v&&v.visit(R,O)},w=typeof y=="function"?x:null,S=!1;if(m){S=typeof m.comment=="boolean"&&m.comment;var T=typeof m.attachComment=="boolean"&&m.attachComment;(S||T)&&((v=new c.CommentHandler).attach=T,m.comment=!0,w=x)}var _,D=!1;m&&typeof m.sourceType=="string"&&(D=m.sourceType==="module"),_=m&&typeof m.jsx=="boolean"&&m.jsx?new f.JSXParser(g,m,w):new u.Parser(g,m,w);var I=D?_.parseModule():_.parseScript();return S&&v&&(I.comments=v.comments),_.config.tokens&&(I.tokens=_.tokens),_.config.tolerant&&(I.errors=_.errorHandler.errors),I}s.parse=h,s.parseModule=function(g,m,y){var v=m||{};return v.sourceType="module",h(g,v,y)},s.parseScript=function(g,m,y){var v=m||{};return v.sourceType="script",h(g,v,y)},s.tokenize=function(g,m,y){var v,x=new d.Tokenizer(g,m);v=[];try{for(;;){var w=x.getNextToken();if(!w)break;y&&(w=y(w)),v.push(w)}}catch(S){x.errorHandler.tolerate(S)}return x.errorHandler.tolerant&&(v.errors=x.errors()),v};var p=l(2);s.Syntax=p.Syntax,s.version="4.0.1"},function(o,s,l){Object.defineProperty(s,"__esModule",{value:!0});var c=l(2),f=(function(){function u(){this.attach=!1,this.comments=[],this.stack=[],this.leading=[],this.trailing=[]}return u.prototype.insertInnerComments=function(d,h){if(d.type===c.Syntax.BlockStatement&&d.body.length===0){for(var p=[],g=this.leading.length-1;g>=0;--g){var m=this.leading[g];h.end.offset>=m.start&&(p.unshift(m.comment),this.leading.splice(g,1),this.trailing.splice(g,1))}p.length&&(d.innerComments=p)}},u.prototype.findTrailingComments=function(d){var h=[];if(this.trailing.length>0){for(var p=this.trailing.length-1;p>=0;--p){var g=this.trailing[p];g.start>=d.end.offset&&h.unshift(g.comment)}return this.trailing.length=0,h}var m=this.stack[this.stack.length-1];if(m&&m.node.trailingComments){var y=m.node.trailingComments[0];y&&y.range[0]>=d.end.offset&&(h=m.node.trailingComments,delete m.node.trailingComments)}return h},u.prototype.findLeadingComments=function(d){for(var h,p=[];this.stack.length>0&&(y=this.stack[this.stack.length-1])&&y.start>=d.start.offset;)h=y.node,this.stack.pop();if(h){for(var g=(h.leadingComments?h.leadingComments.length:0)-1;g>=0;--g){var m=h.leadingComments[g];m.range[1]<=d.start.offset&&(p.unshift(m),h.leadingComments.splice(g,1))}return h.leadingComments&&h.leadingComments.length===0&&delete h.leadingComments,p}for(g=this.leading.length-1;g>=0;--g){var y;(y=this.leading[g]).start<=d.start.offset&&(p.unshift(y.comment),this.leading.splice(g,1))}return p},u.prototype.visitNode=function(d,h){if(!(d.type===c.Syntax.Program&&d.body.length>0)){this.insertInnerComments(d,h);var p=this.findTrailingComments(h),g=this.findLeadingComments(h);g.length>0&&(d.leadingComments=g),p.length>0&&(d.trailingComments=p),this.stack.push({node:d,start:h.start.offset})}},u.prototype.visitComment=function(d,h){var p=d.type[0]==="L"?"Line":"Block",g={type:p,value:d.value};if(d.range&&(g.range=d.range),d.loc&&(g.loc=d.loc),this.comments.push(g),this.attach){var m={comment:{type:p,value:d.value,range:[h.start.offset,h.end.offset]},start:h.start.offset};d.loc&&(m.comment.loc=d.loc),d.type=p,this.leading.push(m),this.trailing.push(m)}},u.prototype.visit=function(d,h){d.type==="LineComment"||d.type==="BlockComment"?this.visitComment(d,h):this.attach&&this.visitNode(d,h)},u})();s.CommentHandler=f},function(o,s){Object.defineProperty(s,"__esModule",{value:!0}),s.Syntax={AssignmentExpression:"AssignmentExpression",AssignmentPattern:"AssignmentPattern",ArrayExpression:"ArrayExpression",ArrayPattern:"ArrayPattern",ArrowFunctionExpression:"ArrowFunctionExpression",AwaitExpression:"AwaitExpression",BlockStatement:"BlockStatement",BinaryExpression:"BinaryExpression",BreakStatement:"BreakStatement",CallExpression:"CallExpression",CatchClause:"CatchClause",ClassBody:"ClassBody",ClassDeclaration:"ClassDeclaration",ClassExpression:"ClassExpression",ConditionalExpression:"ConditionalExpression",ContinueStatement:"ContinueStatement",DoWhileStatement:"DoWhileStatement",DebuggerStatement:"DebuggerStatement",EmptyStatement:"EmptyStatement",ExportAllDeclaration:"ExportAllDeclaration",ExportDefaultDeclaration:"ExportDefaultDeclaration",ExportNamedDeclaration:"ExportNamedDeclaration",ExportSpecifier:"ExportSpecifier",ExpressionStatement:"ExpressionStatement",ForStatement:"ForStatement",ForOfStatement:"ForOfStatement",ForInStatement:"ForInStatement",FunctionDeclaration:"FunctionDeclaration",FunctionExpression:"FunctionExpression",Identifier:"Identifier",IfStatement:"IfStatement",ImportDeclaration:"ImportDeclaration",ImportDefaultSpecifier:"ImportDefaultSpecifier",ImportNamespaceSpecifier:"ImportNamespaceSpecifier",ImportSpecifier:"ImportSpecifier",Literal:"Literal",LabeledStatement:"LabeledStatement",LogicalExpression:"LogicalExpression",MemberExpression:"MemberExpression",MetaProperty:"MetaProperty",MethodDefinition:"MethodDefinition",NewExpression:"NewExpression",ObjectExpression:"ObjectExpression",ObjectPattern:"ObjectPattern",Program:"Program",Property:"Property",RestElement:"RestElement",ReturnStatement:"ReturnStatement",SequenceExpression:"SequenceExpression",SpreadElement:"SpreadElement",Super:"Super",SwitchCase:"SwitchCase",SwitchStatement:"SwitchStatement",TaggedTemplateExpression:"TaggedTemplateExpression",TemplateElement:"TemplateElement",TemplateLiteral:"TemplateLiteral",ThisExpression:"ThisExpression",ThrowStatement:"ThrowStatement",TryStatement:"TryStatement",UnaryExpression:"UnaryExpression",UpdateExpression:"UpdateExpression",VariableDeclaration:"VariableDeclaration",VariableDeclarator:"VariableDeclarator",WhileStatement:"WhileStatement",WithStatement:"WithStatement",YieldExpression:"YieldExpression"}},function(o,s,l){var c,f=this&&this.__extends||(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(w,S){w.__proto__=S}||function(w,S){for(var T in S)S.hasOwnProperty(T)&&(w[T]=S[T])},function(w,S){function T(){this.constructor=w}c(w,S),w.prototype=S===null?Object.create(S):(T.prototype=S.prototype,new T)});Object.defineProperty(s,"__esModule",{value:!0});var u=l(4),d=l(5),h=l(6),p=l(7),g=l(8),m=l(13),y=l(14);function v(w){var S;switch(w.type){case h.JSXSyntax.JSXIdentifier:S=w.name;break;case h.JSXSyntax.JSXNamespacedName:var T=w;S=v(T.namespace)+":"+v(T.name);break;case h.JSXSyntax.JSXMemberExpression:var _=w;S=v(_.object)+"."+v(_.property)}return S}m.TokenName[100]="JSXIdentifier",m.TokenName[101]="JSXText";var x=(function(w){function S(T,_,D){return w.call(this,T,_,D)||this}return f(S,w),S.prototype.parsePrimaryExpression=function(){return this.match("<")?this.parseJSXRoot():w.prototype.parsePrimaryExpression.call(this)},S.prototype.startJSX=function(){this.scanner.index=this.startMarker.index,this.scanner.lineNumber=this.startMarker.line,this.scanner.lineStart=this.startMarker.index-this.startMarker.column},S.prototype.finishJSX=function(){this.nextToken()},S.prototype.reenterJSX=function(){this.startJSX(),this.expectJSX("}"),this.config.tokens&&this.tokens.pop()},S.prototype.createJSXNode=function(){return this.collectComments(),{index:this.scanner.index,line:this.scanner.lineNumber,column:this.scanner.index-this.scanner.lineStart}},S.prototype.createJSXChildNode=function(){return{index:this.scanner.index,line:this.scanner.lineNumber,column:this.scanner.index-this.scanner.lineStart}},S.prototype.scanXHTMLEntity=function(T){for(var _="&",D=!0,I=!1,R=!1,O=!1;!this.scanner.eof()&&D&&!I;){var P=this.scanner.source[this.scanner.index];if(P===T)break;if(I=P===";",_+=P,++this.scanner.index,!I)switch(_.length){case 2:R=P==="#";break;case 3:R&&(D=(O=P==="x")||u.Character.isDecimalDigit(P.charCodeAt(0)),R=R&&!O);break;default:D=(D=D&&!(R&&!u.Character.isDecimalDigit(P.charCodeAt(0))))&&!(O&&!u.Character.isHexDigit(P.charCodeAt(0)))}}if(D&&I&&_.length>2){var N=_.substr(1,_.length-2);R&&N.length>1?_=String.fromCharCode(parseInt(N.substr(1),10)):O&&N.length>2?_=String.fromCharCode(parseInt("0"+N.substr(1),16)):R||O||!y.XHTMLEntities[N]||(_=y.XHTMLEntities[N])}return _},S.prototype.lexJSX=function(){var T=this.scanner.source.charCodeAt(this.scanner.index);if(T===60||T===62||T===47||T===58||T===61||T===123||T===125)return{type:7,value:P=this.scanner.source[this.scanner.index++],lineNumber:this.scanner.lineNumber,lineStart:this.scanner.lineStart,start:this.scanner.index-1,end:this.scanner.index};if(T===34||T===39){for(var _=this.scanner.index,D=this.scanner.source[this.scanner.index++],I="";!this.scanner.eof()&&(N=this.scanner.source[this.scanner.index++])!==D;)I+=N==="&"?this.scanXHTMLEntity(D):N;return{type:8,value:I,lineNumber:this.scanner.lineNumber,lineStart:this.scanner.lineStart,start:_,end:this.scanner.index}}if(T===46){var R=this.scanner.source.charCodeAt(this.scanner.index+1),O=this.scanner.source.charCodeAt(this.scanner.index+2),P=R===46&&O===46?"...":".";return _=this.scanner.index,this.scanner.index+=P.length,{type:7,value:P,lineNumber:this.scanner.lineNumber,lineStart:this.scanner.lineStart,start:_,end:this.scanner.index}}if(T===96)return{type:10,value:"",lineNumber:this.scanner.lineNumber,lineStart:this.scanner.lineStart,start:this.scanner.index,end:this.scanner.index};if(u.Character.isIdentifierStart(T)&&T!==92){for(_=this.scanner.index,++this.scanner.index;!this.scanner.eof();){var N=this.scanner.source.charCodeAt(this.scanner.index);if(u.Character.isIdentifierPart(N)&&N!==92)++this.scanner.index;else{if(N!==45)break;++this.scanner.index}}return{type:100,value:this.scanner.source.slice(_,this.scanner.index),lineNumber:this.scanner.lineNumber,lineStart:this.scanner.lineStart,start:_,end:this.scanner.index}}return this.scanner.lex()},S.prototype.nextJSXToken=function(){this.collectComments(),this.startMarker.index=this.scanner.index,this.startMarker.line=this.scanner.lineNumber,this.startMarker.column=this.scanner.index-this.scanner.lineStart;var T=this.lexJSX();return this.lastMarker.index=this.scanner.index,this.lastMarker.line=this.scanner.lineNumber,this.lastMarker.column=this.scanner.index-this.scanner.lineStart,this.config.tokens&&this.tokens.push(this.convertToken(T)),T},S.prototype.nextJSXText=function(){this.startMarker.index=this.scanner.index,this.startMarker.line=this.scanner.lineNumber,this.startMarker.column=this.scanner.index-this.scanner.lineStart;for(var T=this.scanner.index,_="";!this.scanner.eof();){var D=this.scanner.source[this.scanner.index];if(D==="{"||D==="<")break;++this.scanner.index,_+=D,u.Character.isLineTerminator(D.charCodeAt(0))&&(++this.scanner.lineNumber,D==="\r"&&this.scanner.source[this.scanner.index]===`
`&&++this.scanner.index,this.scanner.lineStart=this.scanner.index)}this.lastMarker.index=this.scanner.index,this.lastMarker.line=this.scanner.lineNumber,this.lastMarker.column=this.scanner.index-this.scanner.lineStart;var I={type:101,value:_,lineNumber:this.scanner.lineNumber,lineStart:this.scanner.lineStart,start:T,end:this.scanner.index};return _.length>0&&this.config.tokens&&this.tokens.push(this.convertToken(I)),I},S.prototype.peekJSXToken=function(){var T=this.scanner.saveState();this.scanner.scanComments();var _=this.lexJSX();return this.scanner.restoreState(T),_},S.prototype.expectJSX=function(T){var _=this.nextJSXToken();_.type===7&&_.value===T||this.throwUnexpectedToken(_)},S.prototype.matchJSX=function(T){var _=this.peekJSXToken();return _.type===7&&_.value===T},S.prototype.parseJSXIdentifier=function(){var T=this.createJSXNode(),_=this.nextJSXToken();return _.type!==100&&this.throwUnexpectedToken(_),this.finalize(T,new d.JSXIdentifier(_.value))},S.prototype.parseJSXElementName=function(){var T=this.createJSXNode(),_=this.parseJSXIdentifier();if(this.matchJSX(":")){var D=_;this.expectJSX(":");var I=this.parseJSXIdentifier();_=this.finalize(T,new d.JSXNamespacedName(D,I))}else if(this.matchJSX("."))for(;this.matchJSX(".");){var R=_;this.expectJSX(".");var O=this.parseJSXIdentifier();_=this.finalize(T,new d.JSXMemberExpression(R,O))}return _},S.prototype.parseJSXAttributeName=function(){var T,_=this.createJSXNode(),D=this.parseJSXIdentifier();if(this.matchJSX(":")){var I=D;this.expectJSX(":");var R=this.parseJSXIdentifier();T=this.finalize(_,new d.JSXNamespacedName(I,R))}else T=D;return T},S.prototype.parseJSXStringLiteralAttribute=function(){var T=this.createJSXNode(),_=this.nextJSXToken();_.type!==8&&this.throwUnexpectedToken(_);var D=this.getTokenRaw(_);return this.finalize(T,new p.Literal(_.value,D))},S.prototype.parseJSXExpressionAttribute=function(){var T=this.createJSXNode();this.expectJSX("{"),this.finishJSX(),this.match("}")&&this.tolerateError("JSX attributes must only be assigned a non-empty expression");var _=this.parseAssignmentExpression();return this.reenterJSX(),this.finalize(T,new d.JSXExpressionContainer(_))},S.prototype.parseJSXAttributeValue=function(){return this.matchJSX("{")?this.parseJSXExpressionAttribute():this.matchJSX("<")?this.parseJSXElement():this.parseJSXStringLiteralAttribute()},S.prototype.parseJSXNameValueAttribute=function(){var T=this.createJSXNode(),_=this.parseJSXAttributeName(),D=null;return this.matchJSX("=")&&(this.expectJSX("="),D=this.parseJSXAttributeValue()),this.finalize(T,new d.JSXAttribute(_,D))},S.prototype.parseJSXSpreadAttribute=function(){var T=this.createJSXNode();this.expectJSX("{"),this.expectJSX("..."),this.finishJSX();var _=this.parseAssignmentExpression();return this.reenterJSX(),this.finalize(T,new d.JSXSpreadAttribute(_))},S.prototype.parseJSXAttributes=function(){for(var T=[];!this.matchJSX("/")&&!this.matchJSX(">");){var _=this.matchJSX("{")?this.parseJSXSpreadAttribute():this.parseJSXNameValueAttribute();T.push(_)}return T},S.prototype.parseJSXOpeningElement=function(){var T=this.createJSXNode();this.expectJSX("<");var _=this.parseJSXElementName(),D=this.parseJSXAttributes(),I=this.matchJSX("/");return I&&this.expectJSX("/"),this.expectJSX(">"),this.finalize(T,new d.JSXOpeningElement(_,I,D))},S.prototype.parseJSXBoundaryElement=function(){var T=this.createJSXNode();if(this.expectJSX("<"),this.matchJSX("/")){this.expectJSX("/");var _=this.parseJSXElementName();return this.expectJSX(">"),this.finalize(T,new d.JSXClosingElement(_))}var D=this.parseJSXElementName(),I=this.parseJSXAttributes(),R=this.matchJSX("/");return R&&this.expectJSX("/"),this.expectJSX(">"),this.finalize(T,new d.JSXOpeningElement(D,R,I))},S.prototype.parseJSXEmptyExpression=function(){var T=this.createJSXChildNode();return this.collectComments(),this.lastMarker.index=this.scanner.index,this.lastMarker.line=this.scanner.lineNumber,this.lastMarker.column=this.scanner.index-this.scanner.lineStart,this.finalize(T,new d.JSXEmptyExpression)},S.prototype.parseJSXExpressionContainer=function(){var T,_=this.createJSXNode();return this.expectJSX("{"),this.matchJSX("}")?(T=this.parseJSXEmptyExpression(),this.expectJSX("}")):(this.finishJSX(),T=this.parseAssignmentExpression(),this.reenterJSX()),this.finalize(_,new d.JSXExpressionContainer(T))},S.prototype.parseJSXChildren=function(){for(var T=[];!this.scanner.eof();){var _=this.createJSXChildNode(),D=this.nextJSXText();if(D.start<D.end){var I=this.getTokenRaw(D),R=this.finalize(_,new d.JSXText(D.value,I));T.push(R)}if(this.scanner.source[this.scanner.index]!=="{")break;var O=this.parseJSXExpressionContainer();T.push(O)}return T},S.prototype.parseComplexJSXElement=function(T){for(var _=[];!this.scanner.eof();){T.children=T.children.concat(this.parseJSXChildren());var D=this.createJSXChildNode(),I=this.parseJSXBoundaryElement();if(I.type===h.JSXSyntax.JSXOpeningElement){var R=I;if(R.selfClosing){var O=this.finalize(D,new d.JSXElement(R,[],null));T.children.push(O)}else _.push(T),T={node:D,opening:R,closing:null,children:[]}}if(I.type===h.JSXSyntax.JSXClosingElement){T.closing=I;var P=v(T.opening.name);if(P!==v(T.closing.name)&&this.tolerateError("Expected corresponding JSX closing tag for %0",P),!(_.length>0))break;O=this.finalize(T.node,new d.JSXElement(T.opening,T.children,T.closing)),(T=_[_.length-1]).children.push(O),_.pop()}}return T},S.prototype.parseJSXElement=function(){var T=this.createJSXNode(),_=this.parseJSXOpeningElement(),D=[],I=null;if(!_.selfClosing){var R=this.parseComplexJSXElement({node:T,opening:_,closing:I,children:D});D=R.children,I=R.closing}return this.finalize(T,new d.JSXElement(_,D,I))},S.prototype.parseJSXRoot=function(){this.config.tokens&&this.tokens.pop(),this.startJSX();var T=this.parseJSXElement();return this.finishJSX(),T},S.prototype.isStartOfExpression=function(){return w.prototype.isStartOfExpression.call(this)||this.match("<")},S})(g.Parser);s.JSXParser=x},function(o,s){Object.defineProperty(s,"__esModule",{value:!0});var l={NonAsciiIdentifierStart:/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0-\u08B4\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309B-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AD\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF30-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC03-\uDC37\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDF00-\uDF19]|\uD806[\uDCA0-\uDCDF\uDCFF\uDEC0-\uDEF8]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50\uDF93-\uDF9F]|\uD82C[\uDC00\uDC01]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD83A[\uDC00-\uDCC4]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1]|\uD87E[\uDC00-\uDE1D]/,NonAsciiIdentifierPart:/[\xAA\xB5\xB7\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05F0-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u0800-\u082D\u0840-\u085B\u08A0-\u08B4\u08E3-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C03\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C60-\u0C63\u0C66-\u0C6F\u0C81-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1\u0CF2\u0D01-\u0D03\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D57\u0D5F-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D82\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB9\u0EBB-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1369-\u1371\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u1820-\u1877\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1B00-\u1B4B\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1CD0-\u1CD2\u1CD4-\u1CF6\u1CF8\u1CF9\u1D00-\u1DF5\u1DFC-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u200C\u200D\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AD\uA7B0-\uA7B7\uA7F7-\uA827\uA840-\uA873\uA880-\uA8C4\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA8FD\uA900-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDDFD\uDE80-\uDE9C\uDEA0-\uDED0\uDEE0\uDF00-\uDF1F\uDF30-\uDF4A\uDF50-\uDF7A\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00-\uDE03\uDE05\uDE06\uDE0C-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE38-\uDE3A\uDE3F\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE6\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC00-\uDC46\uDC66-\uDC6F\uDC7F-\uDCBA\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD00-\uDD34\uDD36-\uDD3F\uDD50-\uDD73\uDD76\uDD80-\uDDC4\uDDCA-\uDDCC\uDDD0-\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE37\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEEA\uDEF0-\uDEF9\uDF00-\uDF03\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3C-\uDF44\uDF47\uDF48\uDF4B-\uDF4D\uDF50\uDF57\uDF5D-\uDF63\uDF66-\uDF6C\uDF70-\uDF74]|\uD805[\uDC80-\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDB5\uDDB8-\uDDC0\uDDD8-\uDDDD\uDE00-\uDE40\uDE44\uDE50-\uDE59\uDE80-\uDEB7\uDEC0-\uDEC9\uDF00-\uDF19\uDF1D-\uDF2B\uDF30-\uDF39]|\uD806[\uDCA0-\uDCE9\uDCFF\uDEC0-\uDEF8]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDED0-\uDEED\uDEF0-\uDEF4\uDF00-\uDF36\uDF40-\uDF43\uDF50-\uDF59\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50-\uDF7E\uDF8F-\uDF9F]|\uD82C[\uDC00\uDC01]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99\uDC9D\uDC9E]|\uD834[\uDD65-\uDD69\uDD6D-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE9B-\uDE9F\uDEA1-\uDEAF]|\uD83A[\uDC00-\uDCC4\uDCD0-\uDCD6]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1]|\uD87E[\uDC00-\uDE1D]|\uDB40[\uDD00-\uDDEF]/};s.Character={fromCodePoint:function(c){return c<65536?String.fromCharCode(c):String.fromCharCode(55296+(c-65536>>10))+String.fromCharCode(56320+(c-65536&1023))},isWhiteSpace:function(c){return c===32||c===9||c===11||c===12||c===160||c>=5760&&[5760,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(c)>=0},isLineTerminator:function(c){return c===10||c===13||c===8232||c===8233},isIdentifierStart:function(c){return c===36||c===95||c>=65&&c<=90||c>=97&&c<=122||c===92||c>=128&&l.NonAsciiIdentifierStart.test(s.Character.fromCodePoint(c))},isIdentifierPart:function(c){return c===36||c===95||c>=65&&c<=90||c>=97&&c<=122||c>=48&&c<=57||c===92||c>=128&&l.NonAsciiIdentifierPart.test(s.Character.fromCodePoint(c))},isDecimalDigit:function(c){return c>=48&&c<=57},isHexDigit:function(c){return c>=48&&c<=57||c>=65&&c<=70||c>=97&&c<=102},isOctalDigit:function(c){return c>=48&&c<=55}}},function(o,s,l){Object.defineProperty(s,"__esModule",{value:!0});var c=l(6),f=function(S){this.type=c.JSXSyntax.JSXClosingElement,this.name=S};s.JSXClosingElement=f;var u=function(S,T,_){this.type=c.JSXSyntax.JSXElement,this.openingElement=S,this.children=T,this.closingElement=_};s.JSXElement=u;var d=function(){this.type=c.JSXSyntax.JSXEmptyExpression};s.JSXEmptyExpression=d;var h=function(S){this.type=c.JSXSyntax.JSXExpressionContainer,this.expression=S};s.JSXExpressionContainer=h;var p=function(S){this.type=c.JSXSyntax.JSXIdentifier,this.name=S};s.JSXIdentifier=p;var g=function(S,T){this.type=c.JSXSyntax.JSXMemberExpression,this.object=S,this.property=T};s.JSXMemberExpression=g;var m=function(S,T){this.type=c.JSXSyntax.JSXAttribute,this.name=S,this.value=T};s.JSXAttribute=m;var y=function(S,T){this.type=c.JSXSyntax.JSXNamespacedName,this.namespace=S,this.name=T};s.JSXNamespacedName=y;var v=function(S,T,_){this.type=c.JSXSyntax.JSXOpeningElement,this.name=S,this.selfClosing=T,this.attributes=_};s.JSXOpeningElement=v;var x=function(S){this.type=c.JSXSyntax.JSXSpreadAttribute,this.argument=S};s.JSXSpreadAttribute=x;var w=function(S,T){this.type=c.JSXSyntax.JSXText,this.value=S,this.raw=T};s.JSXText=w},function(o,s){Object.defineProperty(s,"__esModule",{value:!0}),s.JSXSyntax={JSXAttribute:"JSXAttribute",JSXClosingElement:"JSXClosingElement",JSXElement:"JSXElement",JSXEmptyExpression:"JSXEmptyExpression",JSXExpressionContainer:"JSXExpressionContainer",JSXIdentifier:"JSXIdentifier",JSXMemberExpression:"JSXMemberExpression",JSXNamespacedName:"JSXNamespacedName",JSXOpeningElement:"JSXOpeningElement",JSXSpreadAttribute:"JSXSpreadAttribute",JSXText:"JSXText"}},function(o,s,l){Object.defineProperty(s,"__esModule",{value:!0});var c=l(2),f=function(Ke){this.type=c.Syntax.ArrayExpression,this.elements=Ke};s.ArrayExpression=f;var u=function(Ke){this.type=c.Syntax.ArrayPattern,this.elements=Ke};s.ArrayPattern=u;var d=function(Ke,Et,Rt){this.type=c.Syntax.ArrowFunctionExpression,this.id=null,this.params=Ke,this.body=Et,this.generator=!1,this.expression=Rt,this.async=!1};s.ArrowFunctionExpression=d;var h=function(Ke,Et,Rt){this.type=c.Syntax.AssignmentExpression,this.operator=Ke,this.left=Et,this.right=Rt};s.AssignmentExpression=h;var p=function(Ke,Et){this.type=c.Syntax.AssignmentPattern,this.left=Ke,this.right=Et};s.AssignmentPattern=p;var g=function(Ke,Et,Rt){this.type=c.Syntax.ArrowFunctionExpression,this.id=null,this.params=Ke,this.body=Et,this.generator=!1,this.expression=Rt,this.async=!0};s.AsyncArrowFunctionExpression=g;var m=function(Ke,Et,Rt){this.type=c.Syntax.FunctionDeclaration,this.id=Ke,this.params=Et,this.body=Rt,this.generator=!1,this.expression=!1,this.async=!0};s.AsyncFunctionDeclaration=m;var y=function(Ke,Et,Rt){this.type=c.Syntax.FunctionExpression,this.id=Ke,this.params=Et,this.body=Rt,this.generator=!1,this.expression=!1,this.async=!0};s.AsyncFunctionExpression=y;var v=function(Ke){this.type=c.Syntax.AwaitExpression,this.argument=Ke};s.AwaitExpression=v;var x=function(Ke,Et,Rt){var Ft=Ke==="||"||Ke==="&&";this.type=Ft?c.Syntax.LogicalExpression:c.Syntax.BinaryExpression,this.operator=Ke,this.left=Et,this.right=Rt};s.BinaryExpression=x;var w=function(Ke){this.type=c.Syntax.BlockStatement,this.body=Ke};s.BlockStatement=w;var S=function(Ke){this.type=c.Syntax.BreakStatement,this.label=Ke};s.BreakStatement=S;var T=function(Ke,Et){this.type=c.Syntax.CallExpression,this.callee=Ke,this.arguments=Et};s.CallExpression=T;var _=function(Ke,Et){this.type=c.Syntax.CatchClause,this.param=Ke,this.body=Et};s.CatchClause=_;var D=function(Ke){this.type=c.Syntax.ClassBody,this.body=Ke};s.ClassBody=D;var I=function(Ke,Et,Rt){this.type=c.Syntax.ClassDeclaration,this.id=Ke,this.superClass=Et,this.body=Rt};s.ClassDeclaration=I;var R=function(Ke,Et,Rt){this.type=c.Syntax.ClassExpression,this.id=Ke,this.superClass=Et,this.body=Rt};s.ClassExpression=R;var O=function(Ke,Et){this.type=c.Syntax.MemberExpression,this.computed=!0,this.object=Ke,this.property=Et};s.ComputedMemberExpression=O;var P=function(Ke,Et,Rt){this.type=c.Syntax.ConditionalExpression,this.test=Ke,this.consequent=Et,this.alternate=Rt};s.ConditionalExpression=P;var N=function(Ke){this.type=c.Syntax.ContinueStatement,this.label=Ke};s.ContinueStatement=N;var A=function(){this.type=c.Syntax.DebuggerStatement};s.DebuggerStatement=A;var B=function(Ke,Et){this.type=c.Syntax.ExpressionStatement,this.expression=Ke,this.directive=Et};s.Directive=B;var V=function(Ke,Et){this.type=c.Syntax.DoWhileStatement,this.body=Ke,this.test=Et};s.DoWhileStatement=V;var $=function(){this.type=c.Syntax.EmptyStatement};s.EmptyStatement=$;var U=function(Ke){this.type=c.Syntax.ExportAllDeclaration,this.source=Ke};s.ExportAllDeclaration=U;var G=function(Ke){this.type=c.Syntax.ExportDefaultDeclaration,this.declaration=Ke};s.ExportDefaultDeclaration=G;var F=function(Ke,Et,Rt){this.type=c.Syntax.ExportNamedDeclaration,this.declaration=Ke,this.specifiers=Et,this.source=Rt};s.ExportNamedDeclaration=F;var J=function(Ke,Et){this.type=c.Syntax.ExportSpecifier,this.exported=Et,this.local=Ke};s.ExportSpecifier=J;var Q=function(Ke){this.type=c.Syntax.ExpressionStatement,this.expression=Ke};s.ExpressionStatement=Q;var ne=function(Ke,Et,Rt){this.type=c.Syntax.ForInStatement,this.left=Ke,this.right=Et,this.body=Rt,this.each=!1};s.ForInStatement=ne;var ye=function(Ke,Et,Rt){this.type=c.Syntax.ForOfStatement,this.left=Ke,this.right=Et,this.body=Rt};s.ForOfStatement=ye;var ve=function(Ke,Et,Rt,Ft){this.type=c.Syntax.ForStatement,this.init=Ke,this.test=Et,this.update=Rt,this.body=Ft};s.ForStatement=ve;var Ce=function(Ke,Et,Rt,Ft){this.type=c.Syntax.FunctionDeclaration,this.id=Ke,this.params=Et,this.body=Rt,this.generator=Ft,this.expression=!1,this.async=!1};s.FunctionDeclaration=Ce;var we=function(Ke,Et,Rt,Ft){this.type=c.Syntax.FunctionExpression,this.id=Ke,this.params=Et,this.body=Rt,this.generator=Ft,this.expression=!1,this.async=!1};s.FunctionExpression=we;var Ae=function(Ke){this.type=c.Syntax.Identifier,this.name=Ke};s.Identifier=Ae;var Me=function(Ke,Et,Rt){this.type=c.Syntax.IfStatement,this.test=Ke,this.consequent=Et,this.alternate=Rt};s.IfStatement=Me;var q=function(Ke,Et){this.type=c.Syntax.ImportDeclaration,this.specifiers=Ke,this.source=Et};s.ImportDeclaration=q;var k=function(Ke){this.type=c.Syntax.ImportDefaultSpecifier,this.local=Ke};s.ImportDefaultSpecifier=k;var Y=function(Ke){this.type=c.Syntax.ImportNamespaceSpecifier,this.local=Ke};s.ImportNamespaceSpecifier=Y;var X=function(Ke,Et){this.type=c.Syntax.ImportSpecifier,this.local=Ke,this.imported=Et};s.ImportSpecifier=X;var re=function(Ke,Et){this.type=c.Syntax.LabeledStatement,this.label=Ke,this.body=Et};s.LabeledStatement=re;var de=function(Ke,Et){this.type=c.Syntax.Literal,this.value=Ke,this.raw=Et};s.Literal=de;var he=function(Ke,Et){this.type=c.Syntax.MetaProperty,this.meta=Ke,this.property=Et};s.MetaProperty=he;var Ee=function(Ke,Et,Rt,Ft,Dn){this.type=c.Syntax.MethodDefinition,this.key=Ke,this.computed=Et,this.value=Rt,this.kind=Ft,this.static=Dn};s.MethodDefinition=Ee;var Oe=function(Ke){this.type=c.Syntax.Program,this.body=Ke,this.sourceType="module"};s.Module=Oe;var Pe=function(Ke,Et){this.type=c.Syntax.NewExpression,this.callee=Ke,this.arguments=Et};s.NewExpression=Pe;var Ne=function(Ke){this.type=c.Syntax.ObjectExpression,this.properties=Ke};s.ObjectExpression=Ne;var ie=function(Ke){this.type=c.Syntax.ObjectPattern,this.properties=Ke};s.ObjectPattern=ie;var ae=function(Ke,Et,Rt,Ft,Dn,Bt){this.type=c.Syntax.Property,this.key=Et,this.computed=Rt,this.value=Ft,this.kind=Ke,this.method=Dn,this.shorthand=Bt};s.Property=ae;var Te=function(Ke,Et,Rt,Ft){this.type=c.Syntax.Literal,this.value=Ke,this.raw=Et,this.regex={pattern:Rt,flags:Ft}};s.RegexLiteral=Te;var me=function(Ke){this.type=c.Syntax.RestElement,this.argument=Ke};s.RestElement=me;var Se=function(Ke){this.type=c.Syntax.ReturnStatement,this.argument=Ke};s.ReturnStatement=Se;var Ve=function(Ke){this.type=c.Syntax.Program,this.body=Ke,this.sourceType="script"};s.Script=Ve;var ue=function(Ke){this.type=c.Syntax.SequenceExpression,this.expressions=Ke};s.SequenceExpression=ue;var ut=function(Ke){this.type=c.Syntax.SpreadElement,this.argument=Ke};s.SpreadElement=ut;var ht=function(Ke,Et){this.type=c.Syntax.MemberExpression,this.computed=!1,this.object=Ke,this.property=Et};s.StaticMemberExpression=ht;var Ot=function(){this.type=c.Syntax.Super};s.Super=Ot;var Fe=function(Ke,Et){this.type=c.Syntax.SwitchCase,this.test=Ke,this.consequent=Et};s.SwitchCase=Fe;var Qe=function(Ke,Et){this.type=c.Syntax.SwitchStatement,this.discriminant=Ke,this.cases=Et};s.SwitchStatement=Qe;var st=function(Ke,Et){this.type=c.Syntax.TaggedTemplateExpression,this.tag=Ke,this.quasi=Et};s.TaggedTemplateExpression=st;var ot=function(Ke,Et){this.type=c.Syntax.TemplateElement,this.value=Ke,this.tail=Et};s.TemplateElement=ot;var Mt=function(Ke,Et){this.type=c.Syntax.TemplateLiteral,this.quasis=Ke,this.expressions=Et};s.TemplateLiteral=Mt;var Ue=function(){this.type=c.Syntax.ThisExpression};s.ThisExpression=Ue;var He=function(Ke){this.type=c.Syntax.ThrowStatement,this.argument=Ke};s.ThrowStatement=He;var Ct=function(Ke,Et,Rt){this.type=c.Syntax.TryStatement,this.block=Ke,this.handler=Et,this.finalizer=Rt};s.TryStatement=Ct;var $t=function(Ke,Et){this.type=c.Syntax.UnaryExpression,this.operator=Ke,this.argument=Et,this.prefix=!0};s.UnaryExpression=$t;var bn=function(Ke,Et,Rt){this.type=c.Syntax.UpdateExpression,this.operator=Ke,this.argument=Et,this.prefix=Rt};s.UpdateExpression=bn;var Tn=function(Ke,Et){this.type=c.Syntax.VariableDeclaration,this.declarations=Ke,this.kind=Et};s.VariableDeclaration=Tn;var en=function(Ke,Et){this.type=c.Syntax.VariableDeclarator,this.id=Ke,this.init=Et};s.VariableDeclarator=en;var Pn=function(Ke,Et){this.type=c.Syntax.WhileStatement,this.test=Ke,this.body=Et};s.WhileStatement=Pn;var mi=function(Ke,Et){this.type=c.Syntax.WithStatement,this.object=Ke,this.body=Et};s.WithStatement=mi;var hr=function(Ke,Et){this.type=c.Syntax.YieldExpression,this.argument=Ke,this.delegate=Et};s.YieldExpression=hr},function(o,s,l){Object.defineProperty(s,"__esModule",{value:!0});var c=l(9),f=l(10),u=l(11),d=l(7),h=l(12),p=l(2),g=l(13),m=(function(){function y(v,x,w){x===void 0&&(x={}),this.config={range:typeof x.range=="boolean"&&x.range,loc:typeof x.loc=="boolean"&&x.loc,source:null,tokens:typeof x.tokens=="boolean"&&x.tokens,comment:typeof x.comment=="boolean"&&x.comment,tolerant:typeof x.tolerant=="boolean"&&x.tolerant},this.config.loc&&x.source&&x.source!==null&&(this.config.source=String(x.source)),this.delegate=w,this.errorHandler=new f.ErrorHandler,this.errorHandler.tolerant=this.config.tolerant,this.scanner=new h.Scanner(v,this.errorHandler),this.scanner.trackComment=this.config.comment,this.operatorPrecedence={")":0,";":0,",":0,"=":0,"]":0,"||":1,"&&":2,"|":3,"^":4,"&":5,"==":6,"!=":6,"===":6,"!==":6,"<":7,">":7,"<=":7,">=":7,"<<":8,">>":8,">>>":8,"+":9,"-":9,"*":11,"/":11,"%":11},this.lookahead={type:2,value:"",lineNumber:this.scanner.lineNumber,lineStart:0,start:0,end:0},this.hasLineTerminator=!1,this.context={isModule:!1,await:!1,allowIn:!0,allowStrictDirective:!0,allowYield:!0,firstCoverInitializedNameError:null,isAssignmentTarget:!1,isBindingElement:!1,inFunctionBody:!1,inIteration:!1,inSwitch:!1,labelSet:{},strict:!1},this.tokens=[],this.startMarker={index:0,line:this.scanner.lineNumber,column:0},this.lastMarker={index:0,line:this.scanner.lineNumber,column:0},this.nextToken(),this.lastMarker={index:this.scanner.index,line:this.scanner.lineNumber,column:this.scanner.index-this.scanner.lineStart}}return y.prototype.throwError=function(v){for(var x=[],w=1;w<arguments.length;w++)x[w-1]=arguments[w];var S=Array.prototype.slice.call(arguments,1),T=v.replace(/%(\d)/g,(function(R,O){return c.assert(O<S.length,"Message reference must be in range"),S[O]})),_=this.lastMarker.index,D=this.lastMarker.line,I=this.lastMarker.column+1;throw this.errorHandler.createError(_,D,I,T)},y.prototype.tolerateError=function(v){for(var x=[],w=1;w<arguments.length;w++)x[w-1]=arguments[w];var S=Array.prototype.slice.call(arguments,1),T=v.replace(/%(\d)/g,(function(R,O){return c.assert(O<S.length,"Message reference must be in range"),S[O]})),_=this.lastMarker.index,D=this.scanner.lineNumber,I=this.lastMarker.column+1;this.errorHandler.tolerateError(_,D,I,T)},y.prototype.unexpectedTokenError=function(v,x){var w,S=x||u.Messages.UnexpectedToken;if(v?(x||(S=v.type===2?u.Messages.UnexpectedEOS:v.type===3?u.Messages.UnexpectedIdentifier:v.type===6?u.Messages.UnexpectedNumber:v.type===8?u.Messages.UnexpectedString:v.type===10?u.Messages.UnexpectedTemplate:u.Messages.UnexpectedToken,v.type===4&&(this.scanner.isFutureReservedWord(v.value)?S=u.Messages.UnexpectedReserved:this.context.strict&&this.scanner.isStrictModeReservedWord(v.value)&&(S=u.Messages.StrictReservedWord))),w=v.value):w="ILLEGAL",S=S.replace("%0",w),v&&typeof v.lineNumber=="number"){var T=v.start,_=v.lineNumber,D=this.lastMarker.index-this.lastMarker.column,I=v.start-D+1;return this.errorHandler.createError(T,_,I,S)}return T=this.lastMarker.index,_=this.lastMarker.line,I=this.lastMarker.column+1,this.errorHandler.createError(T,_,I,S)},y.prototype.throwUnexpectedToken=function(v,x){throw this.unexpectedTokenError(v,x)},y.prototype.tolerateUnexpectedToken=function(v,x){this.errorHandler.tolerate(this.unexpectedTokenError(v,x))},y.prototype.collectComments=function(){if(this.config.comment){var v=this.scanner.scanComments();if(v.length>0&&this.delegate)for(var x=0;x<v.length;++x){var w=v[x],S=void 0;S={type:w.multiLine?"BlockComment":"LineComment",value:this.scanner.source.slice(w.slice[0],w.slice[1])},this.config.range&&(S.range=w.range),this.config.loc&&(S.loc=w.loc);var T={start:{line:w.loc.start.line,column:w.loc.start.column,offset:w.range[0]},end:{line:w.loc.end.line,column:w.loc.end.column,offset:w.range[1]}};this.delegate(S,T)}}else this.scanner.scanComments()},y.prototype.getTokenRaw=function(v){return this.scanner.source.slice(v.start,v.end)},y.prototype.convertToken=function(v){var x={type:g.TokenName[v.type],value:this.getTokenRaw(v)};if(this.config.range&&(x.range=[v.start,v.end]),this.config.loc&&(x.loc={start:{line:this.startMarker.line,column:this.startMarker.column},end:{line:this.scanner.lineNumber,column:this.scanner.index-this.scanner.lineStart}}),v.type===9){var w=v.pattern,S=v.flags;x.regex={pattern:w,flags:S}}return x},y.prototype.nextToken=function(){var v=this.lookahead;this.lastMarker.index=this.scanner.index,this.lastMarker.line=this.scanner.lineNumber,this.lastMarker.column=this.scanner.index-this.scanner.lineStart,this.collectComments(),this.scanner.index!==this.startMarker.index&&(this.startMarker.index=this.scanner.index,this.startMarker.line=this.scanner.lineNumber,this.startMarker.column=this.scanner.index-this.scanner.lineStart);var x=this.scanner.lex();return this.hasLineTerminator=v.lineNumber!==x.lineNumber,x&&this.context.strict&&x.type===3&&this.scanner.isStrictModeReservedWord(x.value)&&(x.type=4),this.lookahead=x,this.config.tokens&&x.type!==2&&this.tokens.push(this.convertToken(x)),v},y.prototype.nextRegexToken=function(){this.collectComments();var v=this.scanner.scanRegExp();return this.config.tokens&&(this.tokens.pop(),this.tokens.push(this.convertToken(v))),this.lookahead=v,this.nextToken(),v},y.prototype.createNode=function(){return{index:this.startMarker.index,line:this.startMarker.line,column:this.startMarker.column}},y.prototype.startNode=function(v,x){x===void 0&&(x=0);var w=v.start-v.lineStart,S=v.lineNumber;return w<0&&(w+=x,S--),{index:v.start,line:S,column:w}},y.prototype.finalize=function(v,x){if(this.config.range&&(x.range=[v.index,this.lastMarker.index]),this.config.loc&&(x.loc={start:{line:v.line,column:v.column},end:{line:this.lastMarker.line,column:this.lastMarker.column}},this.config.source&&(x.loc.source=this.config.source)),this.delegate){var w={start:{line:v.line,column:v.column,offset:v.index},end:{line:this.lastMarker.line,column:this.lastMarker.column,offset:this.lastMarker.index}};this.delegate(x,w)}return x},y.prototype.expect=function(v){var x=this.nextToken();x.type===7&&x.value===v||this.throwUnexpectedToken(x)},y.prototype.expectCommaSeparator=function(){if(this.config.tolerant){var v=this.lookahead;v.type===7&&v.value===","?this.nextToken():v.type===7&&v.value===";"?(this.nextToken(),this.tolerateUnexpectedToken(v)):this.tolerateUnexpectedToken(v,u.Messages.UnexpectedToken)}else this.expect(",")},y.prototype.expectKeyword=function(v){var x=this.nextToken();x.type===4&&x.value===v||this.throwUnexpectedToken(x)},y.prototype.match=function(v){return this.lookahead.type===7&&this.lookahead.value===v},y.prototype.matchKeyword=function(v){return this.lookahead.type===4&&this.lookahead.value===v},y.prototype.matchContextualKeyword=function(v){return this.lookahead.type===3&&this.lookahead.value===v},y.prototype.matchAssign=function(){if(this.lookahead.type!==7)return!1;var v=this.lookahead.value;return v==="="||v==="*="||v==="**="||v==="/="||v==="%="||v==="+="||v==="-="||v==="<<="||v===">>="||v===">>>="||v==="&="||v==="^="||v==="|="},y.prototype.isolateCoverGrammar=function(v){var x=this.context.isBindingElement,w=this.context.isAssignmentTarget,S=this.context.firstCoverInitializedNameError;this.context.isBindingElement=!0,this.context.isAssignmentTarget=!0,this.context.firstCoverInitializedNameError=null;var T=v.call(this);return this.context.firstCoverInitializedNameError!==null&&this.throwUnexpectedToken(this.context.firstCoverInitializedNameError),this.context.isBindingElement=x,this.context.isAssignmentTarget=w,this.context.firstCoverInitializedNameError=S,T},y.prototype.inheritCoverGrammar=function(v){var x=this.context.isBindingElement,w=this.context.isAssignmentTarget,S=this.context.firstCoverInitializedNameError;this.context.isBindingElement=!0,this.context.isAssignmentTarget=!0,this.context.firstCoverInitializedNameError=null;var T=v.call(this);return this.context.isBindingElement=this.context.isBindingElement&&x,this.context.isAssignmentTarget=this.context.isAssignmentTarget&&w,this.context.firstCoverInitializedNameError=S||this.context.firstCoverInitializedNameError,T},y.prototype.consumeSemicolon=function(){this.match(";")?this.nextToken():this.hasLineTerminator||(this.lookahead.type===2||this.match("}")||this.throwUnexpectedToken(this.lookahead),this.lastMarker.index=this.startMarker.index,this.lastMarker.line=this.startMarker.line,this.lastMarker.column=this.startMarker.column)},y.prototype.parsePrimaryExpression=function(){var v,x,w,S=this.createNode();switch(this.lookahead.type){case 3:(this.context.isModule||this.context.await)&&this.lookahead.value==="await"&&this.tolerateUnexpectedToken(this.lookahead),v=this.matchAsyncFunction()?this.parseFunctionExpression():this.finalize(S,new d.Identifier(this.nextToken().value));break;case 6:case 8:this.context.strict&&this.lookahead.octal&&this.tolerateUnexpectedToken(this.lookahead,u.Messages.StrictOctalLiteral),this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1,x=this.nextToken(),w=this.getTokenRaw(x),v=this.finalize(S,new d.Literal(x.value,w));break;case 1:this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1,x=this.nextToken(),w=this.getTokenRaw(x),v=this.finalize(S,new d.Literal(x.value==="true",w));break;case 5:this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1,x=this.nextToken(),w=this.getTokenRaw(x),v=this.finalize(S,new d.Literal(null,w));break;case 10:v=this.parseTemplateLiteral();break;case 7:switch(this.lookahead.value){case"(":this.context.isBindingElement=!1,v=this.inheritCoverGrammar(this.parseGroupExpression);break;case"[":v=this.inheritCoverGrammar(this.parseArrayInitializer);break;case"{":v=this.inheritCoverGrammar(this.parseObjectInitializer);break;case"/":case"/=":this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1,this.scanner.index=this.startMarker.index,x=this.nextRegexToken(),w=this.getTokenRaw(x),v=this.finalize(S,new d.RegexLiteral(x.regex,w,x.pattern,x.flags));break;default:v=this.throwUnexpectedToken(this.nextToken())}break;case 4:!this.context.strict&&this.context.allowYield&&this.matchKeyword("yield")?v=this.parseIdentifierName():!this.context.strict&&this.matchKeyword("let")?v=this.finalize(S,new d.Identifier(this.nextToken().value)):(this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1,this.matchKeyword("function")?v=this.parseFunctionExpression():this.matchKeyword("this")?(this.nextToken(),v=this.finalize(S,new d.ThisExpression)):v=this.matchKeyword("class")?this.parseClassExpression():this.throwUnexpectedToken(this.nextToken()));break;default:v=this.throwUnexpectedToken(this.nextToken())}return v},y.prototype.parseSpreadElement=function(){var v=this.createNode();this.expect("...");var x=this.inheritCoverGrammar(this.parseAssignmentExpression);return this.finalize(v,new d.SpreadElement(x))},y.prototype.parseArrayInitializer=function(){var v=this.createNode(),x=[];for(this.expect("[");!this.match("]");)if(this.match(","))this.nextToken(),x.push(null);else if(this.match("...")){var w=this.parseSpreadElement();this.match("]")||(this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1,this.expect(",")),x.push(w)}else x.push(this.inheritCoverGrammar(this.parseAssignmentExpression)),this.match("]")||this.expect(",");return this.expect("]"),this.finalize(v,new d.ArrayExpression(x))},y.prototype.parsePropertyMethod=function(v){this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1;var x=this.context.strict,w=this.context.allowStrictDirective;this.context.allowStrictDirective=v.simple;var S=this.isolateCoverGrammar(this.parseFunctionSourceElements);return this.context.strict&&v.firstRestricted&&this.tolerateUnexpectedToken(v.firstRestricted,v.message),this.context.strict&&v.stricted&&this.tolerateUnexpectedToken(v.stricted,v.message),this.context.strict=x,this.context.allowStrictDirective=w,S},y.prototype.parsePropertyMethodFunction=function(){var v=this.createNode(),x=this.context.allowYield;this.context.allowYield=!0;var w=this.parseFormalParameters(),S=this.parsePropertyMethod(w);return this.context.allowYield=x,this.finalize(v,new d.FunctionExpression(null,w.params,S,!1))},y.prototype.parsePropertyMethodAsyncFunction=function(){var v=this.createNode(),x=this.context.allowYield,w=this.context.await;this.context.allowYield=!1,this.context.await=!0;var S=this.parseFormalParameters(),T=this.parsePropertyMethod(S);return this.context.allowYield=x,this.context.await=w,this.finalize(v,new d.AsyncFunctionExpression(null,S.params,T))},y.prototype.parseObjectPropertyKey=function(){var v,x=this.createNode(),w=this.nextToken();switch(w.type){case 8:case 6:this.context.strict&&w.octal&&this.tolerateUnexpectedToken(w,u.Messages.StrictOctalLiteral);var S=this.getTokenRaw(w);v=this.finalize(x,new d.Literal(w.value,S));break;case 3:case 1:case 5:case 4:v=this.finalize(x,new d.Identifier(w.value));break;case 7:w.value==="["?(v=this.isolateCoverGrammar(this.parseAssignmentExpression),this.expect("]")):v=this.throwUnexpectedToken(w);break;default:v=this.throwUnexpectedToken(w)}return v},y.prototype.isPropertyKey=function(v,x){return v.type===p.Syntax.Identifier&&v.name===x||v.type===p.Syntax.Literal&&v.value===x},y.prototype.parseObjectProperty=function(v){var x,w=this.createNode(),S=this.lookahead,T=null,_=null,D=!1,I=!1,R=!1,O=!1;if(S.type===3){var P=S.value;this.nextToken(),D=this.match("["),T=(O=!(this.hasLineTerminator||P!=="async"||this.match(":")||this.match("(")||this.match("*")||this.match(",")))?this.parseObjectPropertyKey():this.finalize(w,new d.Identifier(P))}else this.match("*")?this.nextToken():(D=this.match("["),T=this.parseObjectPropertyKey());var N=this.qualifiedPropertyName(this.lookahead);if(S.type===3&&!O&&S.value==="get"&&N)x="get",D=this.match("["),T=this.parseObjectPropertyKey(),this.context.allowYield=!1,_=this.parseGetterMethod();else if(S.type===3&&!O&&S.value==="set"&&N)x="set",D=this.match("["),T=this.parseObjectPropertyKey(),_=this.parseSetterMethod();else if(S.type===7&&S.value==="*"&&N)x="init",D=this.match("["),T=this.parseObjectPropertyKey(),_=this.parseGeneratorMethod(),I=!0;else if(T||this.throwUnexpectedToken(this.lookahead),x="init",this.match(":")&&!O)!D&&this.isPropertyKey(T,"__proto__")&&(v.value&&this.tolerateError(u.Messages.DuplicateProtoProperty),v.value=!0),this.nextToken(),_=this.inheritCoverGrammar(this.parseAssignmentExpression);else if(this.match("("))_=O?this.parsePropertyMethodAsyncFunction():this.parsePropertyMethodFunction(),I=!0;else if(S.type===3)if(P=this.finalize(w,new d.Identifier(S.value)),this.match("=")){this.context.firstCoverInitializedNameError=this.lookahead,this.nextToken(),R=!0;var A=this.isolateCoverGrammar(this.parseAssignmentExpression);_=this.finalize(w,new d.AssignmentPattern(P,A))}else R=!0,_=P;else this.throwUnexpectedToken(this.nextToken());return this.finalize(w,new d.Property(x,T,D,_,I,R))},y.prototype.parseObjectInitializer=function(){var v=this.createNode();this.expect("{");for(var x=[],w={value:!1};!this.match("}");)x.push(this.parseObjectProperty(w)),this.match("}")||this.expectCommaSeparator();return this.expect("}"),this.finalize(v,new d.ObjectExpression(x))},y.prototype.parseTemplateHead=function(){c.assert(this.lookahead.head,"Template literal must start with a template head");var v=this.createNode(),x=this.nextToken(),w=x.value,S=x.cooked;return this.finalize(v,new d.TemplateElement({raw:w,cooked:S},x.tail))},y.prototype.parseTemplateElement=function(){this.lookahead.type!==10&&this.throwUnexpectedToken();var v=this.createNode(),x=this.nextToken(),w=x.value,S=x.cooked;return this.finalize(v,new d.TemplateElement({raw:w,cooked:S},x.tail))},y.prototype.parseTemplateLiteral=function(){var v=this.createNode(),x=[],w=[],S=this.parseTemplateHead();for(w.push(S);!S.tail;)x.push(this.parseExpression()),S=this.parseTemplateElement(),w.push(S);return this.finalize(v,new d.TemplateLiteral(w,x))},y.prototype.reinterpretExpressionAsPattern=function(v){switch(v.type){case p.Syntax.Identifier:case p.Syntax.MemberExpression:case p.Syntax.RestElement:case p.Syntax.AssignmentPattern:break;case p.Syntax.SpreadElement:v.type=p.Syntax.RestElement,this.reinterpretExpressionAsPattern(v.argument);break;case p.Syntax.ArrayExpression:v.type=p.Syntax.ArrayPattern;for(var x=0;x<v.elements.length;x++)v.elements[x]!==null&&this.reinterpretExpressionAsPattern(v.elements[x]);break;case p.Syntax.ObjectExpression:for(v.type=p.Syntax.ObjectPattern,x=0;x<v.properties.length;x++)this.reinterpretExpressionAsPattern(v.properties[x].value);break;case p.Syntax.AssignmentExpression:v.type=p.Syntax.AssignmentPattern,delete v.operator,this.reinterpretExpressionAsPattern(v.left)}},y.prototype.parseGroupExpression=function(){var v;if(this.expect("("),this.match(")"))this.nextToken(),this.match("=>")||this.expect("=>"),v={type:"ArrowParameterPlaceHolder",params:[],async:!1};else{var x=this.lookahead,w=[];if(this.match("..."))v=this.parseRestElement(w),this.expect(")"),this.match("=>")||this.expect("=>"),v={type:"ArrowParameterPlaceHolder",params:[v],async:!1};else{var S=!1;if(this.context.isBindingElement=!0,v=this.inheritCoverGrammar(this.parseAssignmentExpression),this.match(",")){var T=[];for(this.context.isAssignmentTarget=!1,T.push(v);this.lookahead.type!==2&&this.match(",");){if(this.nextToken(),this.match(")")){this.nextToken();for(var _=0;_<T.length;_++)this.reinterpretExpressionAsPattern(T[_]);S=!0,v={type:"ArrowParameterPlaceHolder",params:T,async:!1}}else if(this.match("...")){for(this.context.isBindingElement||this.throwUnexpectedToken(this.lookahead),T.push(this.parseRestElement(w)),this.expect(")"),this.match("=>")||this.expect("=>"),this.context.isBindingElement=!1,_=0;_<T.length;_++)this.reinterpretExpressionAsPattern(T[_]);S=!0,v={type:"ArrowParameterPlaceHolder",params:T,async:!1}}else T.push(this.inheritCoverGrammar(this.parseAssignmentExpression));if(S)break}S||(v=this.finalize(this.startNode(x),new d.SequenceExpression(T)))}if(!S){if(this.expect(")"),this.match("=>")&&(v.type===p.Syntax.Identifier&&v.name==="yield"&&(S=!0,v={type:"ArrowParameterPlaceHolder",params:[v],async:!1}),!S)){if(this.context.isBindingElement||this.throwUnexpectedToken(this.lookahead),v.type===p.Syntax.SequenceExpression)for(_=0;_<v.expressions.length;_++)this.reinterpretExpressionAsPattern(v.expressions[_]);else this.reinterpretExpressionAsPattern(v);v={type:"ArrowParameterPlaceHolder",params:v.type===p.Syntax.SequenceExpression?v.expressions:[v],async:!1}}this.context.isBindingElement=!1}}}return v},y.prototype.parseArguments=function(){this.expect("(");var v=[];if(!this.match(")"))for(;;){var x=this.match("...")?this.parseSpreadElement():this.isolateCoverGrammar(this.parseAssignmentExpression);if(v.push(x),this.match(")")||(this.expectCommaSeparator(),this.match(")")))break}return this.expect(")"),v},y.prototype.isIdentifierName=function(v){return v.type===3||v.type===4||v.type===1||v.type===5},y.prototype.parseIdentifierName=function(){var v=this.createNode(),x=this.nextToken();return this.isIdentifierName(x)||this.throwUnexpectedToken(x),this.finalize(v,new d.Identifier(x.value))},y.prototype.parseNewExpression=function(){var v,x=this.createNode(),w=this.parseIdentifierName();if(c.assert(w.name==="new","New expression must start with `new`"),this.match("."))if(this.nextToken(),this.lookahead.type===3&&this.context.inFunctionBody&&this.lookahead.value==="target"){var S=this.parseIdentifierName();v=new d.MetaProperty(w,S)}else this.throwUnexpectedToken(this.lookahead);else{var T=this.isolateCoverGrammar(this.parseLeftHandSideExpression),_=this.match("(")?this.parseArguments():[];v=new d.NewExpression(T,_),this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1}return this.finalize(x,v)},y.prototype.parseAsyncArgument=function(){var v=this.parseAssignmentExpression();return this.context.firstCoverInitializedNameError=null,v},y.prototype.parseAsyncArguments=function(){this.expect("(");var v=[];if(!this.match(")"))for(;;){var x=this.match("...")?this.parseSpreadElement():this.isolateCoverGrammar(this.parseAsyncArgument);if(v.push(x),this.match(")")||(this.expectCommaSeparator(),this.match(")")))break}return this.expect(")"),v},y.prototype.parseLeftHandSideExpressionAllowCall=function(){var v,x=this.lookahead,w=this.matchContextualKeyword("async"),S=this.context.allowIn;for(this.context.allowIn=!0,this.matchKeyword("super")&&this.context.inFunctionBody?(v=this.createNode(),this.nextToken(),v=this.finalize(v,new d.Super),this.match("(")||this.match(".")||this.match("[")||this.throwUnexpectedToken(this.lookahead)):v=this.inheritCoverGrammar(this.matchKeyword("new")?this.parseNewExpression:this.parsePrimaryExpression);;)if(this.match(".")){this.context.isBindingElement=!1,this.context.isAssignmentTarget=!0,this.expect(".");var T=this.parseIdentifierName();v=this.finalize(this.startNode(x),new d.StaticMemberExpression(v,T))}else if(this.match("(")){var _=w&&x.lineNumber===this.lookahead.lineNumber;this.context.isBindingElement=!1,this.context.isAssignmentTarget=!1;var D=_?this.parseAsyncArguments():this.parseArguments();if(v=this.finalize(this.startNode(x),new d.CallExpression(v,D)),_&&this.match("=>")){for(var I=0;I<D.length;++I)this.reinterpretExpressionAsPattern(D[I]);v={type:"ArrowParameterPlaceHolder",params:D,async:!0}}}else if(this.match("["))this.context.isBindingElement=!1,this.context.isAssignmentTarget=!0,this.expect("["),T=this.isolateCoverGrammar(this.parseExpression),this.expect("]"),v=this.finalize(this.startNode(x),new d.ComputedMemberExpression(v,T));else{if(this.lookahead.type!==10||!this.lookahead.head)break;var R=this.parseTemplateLiteral();v=this.finalize(this.startNode(x),new d.TaggedTemplateExpression(v,R))}return this.context.allowIn=S,v},y.prototype.parseSuper=function(){var v=this.createNode();return this.expectKeyword("super"),this.match("[")||this.match(".")||this.throwUnexpectedToken(this.lookahead),this.finalize(v,new d.Super)},y.prototype.parseLeftHandSideExpression=function(){c.assert(this.context.allowIn,"callee of new expression always allow in keyword.");for(var v=this.startNode(this.lookahead),x=this.matchKeyword("super")&&this.context.inFunctionBody?this.parseSuper():this.inheritCoverGrammar(this.matchKeyword("new")?this.parseNewExpression:this.parsePrimaryExpression);;)if(this.match("[")){this.context.isBindingElement=!1,this.context.isAssignmentTarget=!0,this.expect("[");var w=this.isolateCoverGrammar(this.parseExpression);this.expect("]"),x=this.finalize(v,new d.ComputedMemberExpression(x,w))}else if(this.match("."))this.context.isBindingElement=!1,this.context.isAssignmentTarget=!0,this.expect("."),w=this.parseIdentifierName(),x=this.finalize(v,new d.StaticMemberExpression(x,w));else{if(this.lookahead.type!==10||!this.lookahead.head)break;var S=this.parseTemplateLiteral();x=this.finalize(v,new d.TaggedTemplateExpression(x,S))}return x},y.prototype.parseUpdateExpression=function(){var v,x=this.lookahead;if(this.match("++")||this.match("--")){var w=this.startNode(x),S=this.nextToken();v=this.inheritCoverGrammar(this.parseUnaryExpression),this.context.strict&&v.type===p.Syntax.Identifier&&this.scanner.isRestrictedWord(v.name)&&this.tolerateError(u.Messages.StrictLHSPrefix),this.context.isAssignmentTarget||this.tolerateError(u.Messages.InvalidLHSInAssignment);var T=!0;v=this.finalize(w,new d.UpdateExpression(S.value,v,T)),this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1}else if(v=this.inheritCoverGrammar(this.parseLeftHandSideExpressionAllowCall),!this.hasLineTerminator&&this.lookahead.type===7&&(this.match("++")||this.match("--"))){this.context.strict&&v.type===p.Syntax.Identifier&&this.scanner.isRestrictedWord(v.name)&&this.tolerateError(u.Messages.StrictLHSPostfix),this.context.isAssignmentTarget||this.tolerateError(u.Messages.InvalidLHSInAssignment),this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1;var _=this.nextToken().value;T=!1,v=this.finalize(this.startNode(x),new d.UpdateExpression(_,v,T))}return v},y.prototype.parseAwaitExpression=function(){var v=this.createNode();this.nextToken();var x=this.parseUnaryExpression();return this.finalize(v,new d.AwaitExpression(x))},y.prototype.parseUnaryExpression=function(){var v;if(this.match("+")||this.match("-")||this.match("~")||this.match("!")||this.matchKeyword("delete")||this.matchKeyword("void")||this.matchKeyword("typeof")){var x=this.startNode(this.lookahead),w=this.nextToken();v=this.inheritCoverGrammar(this.parseUnaryExpression),v=this.finalize(x,new d.UnaryExpression(w.value,v)),this.context.strict&&v.operator==="delete"&&v.argument.type===p.Syntax.Identifier&&this.tolerateError(u.Messages.StrictDelete),this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1}else v=this.context.await&&this.matchContextualKeyword("await")?this.parseAwaitExpression():this.parseUpdateExpression();return v},y.prototype.parseExponentiationExpression=function(){var v=this.lookahead,x=this.inheritCoverGrammar(this.parseUnaryExpression);if(x.type!==p.Syntax.UnaryExpression&&this.match("**")){this.nextToken(),this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1;var w=x,S=this.isolateCoverGrammar(this.parseExponentiationExpression);x=this.finalize(this.startNode(v),new d.BinaryExpression("**",w,S))}return x},y.prototype.binaryPrecedence=function(v){var x=v.value;return v.type===7?this.operatorPrecedence[x]||0:v.type===4&&(x==="instanceof"||this.context.allowIn&&x==="in")?7:0},y.prototype.parseBinaryExpression=function(){var v=this.lookahead,x=this.inheritCoverGrammar(this.parseExponentiationExpression),w=this.lookahead,S=this.binaryPrecedence(w);if(S>0){this.nextToken(),this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1;for(var T=[v,this.lookahead],_=x,D=this.isolateCoverGrammar(this.parseExponentiationExpression),I=[_,w.value,D],R=[S];!((S=this.binaryPrecedence(this.lookahead))<=0);){for(;I.length>2&&S<=R[R.length-1];){D=I.pop();var O=I.pop();R.pop(),_=I.pop(),T.pop();var P=this.startNode(T[T.length-1]);I.push(this.finalize(P,new d.BinaryExpression(O,_,D)))}I.push(this.nextToken().value),R.push(S),T.push(this.lookahead),I.push(this.isolateCoverGrammar(this.parseExponentiationExpression))}var N=I.length-1;x=I[N];for(var A=T.pop();N>1;){var B=T.pop(),V=A&&A.lineStart;P=this.startNode(B,V),O=I[N-1],x=this.finalize(P,new d.BinaryExpression(O,I[N-2],x)),N-=2,A=B}}return x},y.prototype.parseConditionalExpression=function(){var v=this.lookahead,x=this.inheritCoverGrammar(this.parseBinaryExpression);if(this.match("?")){this.nextToken();var w=this.context.allowIn;this.context.allowIn=!0;var S=this.isolateCoverGrammar(this.parseAssignmentExpression);this.context.allowIn=w,this.expect(":");var T=this.isolateCoverGrammar(this.parseAssignmentExpression);x=this.finalize(this.startNode(v),new d.ConditionalExpression(x,S,T)),this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1}return x},y.prototype.checkPatternParam=function(v,x){switch(x.type){case p.Syntax.Identifier:this.validateParam(v,x,x.name);break;case p.Syntax.RestElement:this.checkPatternParam(v,x.argument);break;case p.Syntax.AssignmentPattern:this.checkPatternParam(v,x.left);break;case p.Syntax.ArrayPattern:for(var w=0;w<x.elements.length;w++)x.elements[w]!==null&&this.checkPatternParam(v,x.elements[w]);break;case p.Syntax.ObjectPattern:for(w=0;w<x.properties.length;w++)this.checkPatternParam(v,x.properties[w].value)}v.simple=v.simple&&x instanceof d.Identifier},y.prototype.reinterpretAsCoverFormalsList=function(v){var x,w=[v],S=!1;switch(v.type){case p.Syntax.Identifier:break;case"ArrowParameterPlaceHolder":w=v.params,S=v.async;break;default:return null}x={simple:!0,paramSet:{}};for(var T=0;T<w.length;++T)(_=w[T]).type===p.Syntax.AssignmentPattern?_.right.type===p.Syntax.YieldExpression&&(_.right.argument&&this.throwUnexpectedToken(this.lookahead),_.right.type=p.Syntax.Identifier,_.right.name="yield",delete _.right.argument,delete _.right.delegate):S&&_.type===p.Syntax.Identifier&&_.name==="await"&&this.throwUnexpectedToken(this.lookahead),this.checkPatternParam(x,_),w[T]=_;if(this.context.strict||!this.context.allowYield)for(T=0;T<w.length;++T){var _;(_=w[T]).type===p.Syntax.YieldExpression&&this.throwUnexpectedToken(this.lookahead)}if(x.message===u.Messages.StrictParamDupe){var D=this.context.strict?x.stricted:x.firstRestricted;this.throwUnexpectedToken(D,x.message)}return{simple:x.simple,params:w,stricted:x.stricted,firstRestricted:x.firstRestricted,message:x.message}},y.prototype.parseAssignmentExpression=function(){var v;if(!this.context.allowYield&&this.matchKeyword("yield"))v=this.parseYieldExpression();else{var x=this.lookahead,w=x;if(v=this.parseConditionalExpression(),w.type===3&&w.lineNumber===this.lookahead.lineNumber&&w.value==="async"&&(this.lookahead.type===3||this.matchKeyword("yield"))){var S=this.parsePrimaryExpression();this.reinterpretExpressionAsPattern(S),v={type:"ArrowParameterPlaceHolder",params:[S],async:!0}}if(v.type==="ArrowParameterPlaceHolder"||this.match("=>")){this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1;var T=v.async,_=this.reinterpretAsCoverFormalsList(v);if(_){this.hasLineTerminator&&this.tolerateUnexpectedToken(this.lookahead),this.context.firstCoverInitializedNameError=null;var D=this.context.strict,I=this.context.allowStrictDirective;this.context.allowStrictDirective=_.simple;var R=this.context.allowYield,O=this.context.await;this.context.allowYield=!0,this.context.await=T;var P=this.startNode(x);this.expect("=>");var N=void 0;if(this.match("{")){var A=this.context.allowIn;this.context.allowIn=!0,N=this.parseFunctionSourceElements(),this.context.allowIn=A}else N=this.isolateCoverGrammar(this.parseAssignmentExpression);var B=N.type!==p.Syntax.BlockStatement;this.context.strict&&_.firstRestricted&&this.throwUnexpectedToken(_.firstRestricted,_.message),this.context.strict&&_.stricted&&this.tolerateUnexpectedToken(_.stricted,_.message),v=T?this.finalize(P,new d.AsyncArrowFunctionExpression(_.params,N,B)):this.finalize(P,new d.ArrowFunctionExpression(_.params,N,B)),this.context.strict=D,this.context.allowStrictDirective=I,this.context.allowYield=R,this.context.await=O}}else if(this.matchAssign()){if(this.context.isAssignmentTarget||this.tolerateError(u.Messages.InvalidLHSInAssignment),this.context.strict&&v.type===p.Syntax.Identifier){var V=v;this.scanner.isRestrictedWord(V.name)&&this.tolerateUnexpectedToken(w,u.Messages.StrictLHSAssignment),this.scanner.isStrictModeReservedWord(V.name)&&this.tolerateUnexpectedToken(w,u.Messages.StrictReservedWord)}this.match("=")?this.reinterpretExpressionAsPattern(v):(this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1);var $=(w=this.nextToken()).value,U=this.isolateCoverGrammar(this.parseAssignmentExpression);v=this.finalize(this.startNode(x),new d.AssignmentExpression($,v,U)),this.context.firstCoverInitializedNameError=null}}return v},y.prototype.parseExpression=function(){var v=this.lookahead,x=this.isolateCoverGrammar(this.parseAssignmentExpression);if(this.match(",")){var w=[];for(w.push(x);this.lookahead.type!==2&&this.match(",");)this.nextToken(),w.push(this.isolateCoverGrammar(this.parseAssignmentExpression));x=this.finalize(this.startNode(v),new d.SequenceExpression(w))}return x},y.prototype.parseStatementListItem=function(){var v;if(this.context.isAssignmentTarget=!0,this.context.isBindingElement=!0,this.lookahead.type===4)switch(this.lookahead.value){case"export":this.context.isModule||this.tolerateUnexpectedToken(this.lookahead,u.Messages.IllegalExportDeclaration),v=this.parseExportDeclaration();break;case"import":this.context.isModule||this.tolerateUnexpectedToken(this.lookahead,u.Messages.IllegalImportDeclaration),v=this.parseImportDeclaration();break;case"const":v=this.parseLexicalDeclaration({inFor:!1});break;case"function":v=this.parseFunctionDeclaration();break;case"class":v=this.parseClassDeclaration();break;case"let":v=this.isLexicalDeclaration()?this.parseLexicalDeclaration({inFor:!1}):this.parseStatement();break;default:v=this.parseStatement()}else v=this.parseStatement();return v},y.prototype.parseBlock=function(){var v=this.createNode();this.expect("{");for(var x=[];!this.match("}");)x.push(this.parseStatementListItem());return this.expect("}"),this.finalize(v,new d.BlockStatement(x))},y.prototype.parseLexicalBinding=function(v,x){var w=this.createNode(),S=this.parsePattern([],v);this.context.strict&&S.type===p.Syntax.Identifier&&this.scanner.isRestrictedWord(S.name)&&this.tolerateError(u.Messages.StrictVarName);var T=null;return v==="const"?this.matchKeyword("in")||this.matchContextualKeyword("of")||(this.match("=")?(this.nextToken(),T=this.isolateCoverGrammar(this.parseAssignmentExpression)):this.throwError(u.Messages.DeclarationMissingInitializer,"const")):(!x.inFor&&S.type!==p.Syntax.Identifier||this.match("="))&&(this.expect("="),T=this.isolateCoverGrammar(this.parseAssignmentExpression)),this.finalize(w,new d.VariableDeclarator(S,T))},y.prototype.parseBindingList=function(v,x){for(var w=[this.parseLexicalBinding(v,x)];this.match(",");)this.nextToken(),w.push(this.parseLexicalBinding(v,x));return w},y.prototype.isLexicalDeclaration=function(){var v=this.scanner.saveState();this.scanner.scanComments();var x=this.scanner.lex();return this.scanner.restoreState(v),x.type===3||x.type===7&&x.value==="["||x.type===7&&x.value==="{"||x.type===4&&x.value==="let"||x.type===4&&x.value==="yield"},y.prototype.parseLexicalDeclaration=function(v){var x=this.createNode(),w=this.nextToken().value;c.assert(w==="let"||w==="const","Lexical declaration must be either let or const");var S=this.parseBindingList(w,v);return this.consumeSemicolon(),this.finalize(x,new d.VariableDeclaration(S,w))},y.prototype.parseBindingRestElement=function(v,x){var w=this.createNode();this.expect("...");var S=this.parsePattern(v,x);return this.finalize(w,new d.RestElement(S))},y.prototype.parseArrayPattern=function(v,x){var w=this.createNode();this.expect("[");for(var S=[];!this.match("]");)if(this.match(","))this.nextToken(),S.push(null);else{if(this.match("...")){S.push(this.parseBindingRestElement(v,x));break}S.push(this.parsePatternWithDefault(v,x)),this.match("]")||this.expect(",")}return this.expect("]"),this.finalize(w,new d.ArrayPattern(S))},y.prototype.parsePropertyPattern=function(v,x){var w,S,T=this.createNode(),_=!1,D=!1;if(this.lookahead.type===3){var I=this.lookahead;w=this.parseVariableIdentifier();var R=this.finalize(T,new d.Identifier(I.value));if(this.match("=")){v.push(I),D=!0,this.nextToken();var O=this.parseAssignmentExpression();S=this.finalize(this.startNode(I),new d.AssignmentPattern(R,O))}else this.match(":")?(this.expect(":"),S=this.parsePatternWithDefault(v,x)):(v.push(I),D=!0,S=R)}else _=this.match("["),w=this.parseObjectPropertyKey(),this.expect(":"),S=this.parsePatternWithDefault(v,x);return this.finalize(T,new d.Property("init",w,_,S,!1,D))},y.prototype.parseObjectPattern=function(v,x){var w=this.createNode(),S=[];for(this.expect("{");!this.match("}");)S.push(this.parsePropertyPattern(v,x)),this.match("}")||this.expect(",");return this.expect("}"),this.finalize(w,new d.ObjectPattern(S))},y.prototype.parsePattern=function(v,x){var w;return this.match("[")?w=this.parseArrayPattern(v,x):this.match("{")?w=this.parseObjectPattern(v,x):(!this.matchKeyword("let")||x!=="const"&&x!=="let"||this.tolerateUnexpectedToken(this.lookahead,u.Messages.LetInLexicalBinding),v.push(this.lookahead),w=this.parseVariableIdentifier(x)),w},y.prototype.parsePatternWithDefault=function(v,x){var w=this.lookahead,S=this.parsePattern(v,x);if(this.match("=")){this.nextToken();var T=this.context.allowYield;this.context.allowYield=!0;var _=this.isolateCoverGrammar(this.parseAssignmentExpression);this.context.allowYield=T,S=this.finalize(this.startNode(w),new d.AssignmentPattern(S,_))}return S},y.prototype.parseVariableIdentifier=function(v){var x=this.createNode(),w=this.nextToken();return w.type===4&&w.value==="yield"?this.context.strict?this.tolerateUnexpectedToken(w,u.Messages.StrictReservedWord):this.context.allowYield||this.throwUnexpectedToken(w):w.type!==3?this.context.strict&&w.type===4&&this.scanner.isStrictModeReservedWord(w.value)?this.tolerateUnexpectedToken(w,u.Messages.StrictReservedWord):(this.context.strict||w.value!=="let"||v!=="var")&&this.throwUnexpectedToken(w):(this.context.isModule||this.context.await)&&w.type===3&&w.value==="await"&&this.tolerateUnexpectedToken(w),this.finalize(x,new d.Identifier(w.value))},y.prototype.parseVariableDeclaration=function(v){var x=this.createNode(),w=this.parsePattern([],"var");this.context.strict&&w.type===p.Syntax.Identifier&&this.scanner.isRestrictedWord(w.name)&&this.tolerateError(u.Messages.StrictVarName);var S=null;return this.match("=")?(this.nextToken(),S=this.isolateCoverGrammar(this.parseAssignmentExpression)):w.type===p.Syntax.Identifier||v.inFor||this.expect("="),this.finalize(x,new d.VariableDeclarator(w,S))},y.prototype.parseVariableDeclarationList=function(v){var x={inFor:v.inFor},w=[];for(w.push(this.parseVariableDeclaration(x));this.match(",");)this.nextToken(),w.push(this.parseVariableDeclaration(x));return w},y.prototype.parseVariableStatement=function(){var v=this.createNode();this.expectKeyword("var");var x=this.parseVariableDeclarationList({inFor:!1});return this.consumeSemicolon(),this.finalize(v,new d.VariableDeclaration(x,"var"))},y.prototype.parseEmptyStatement=function(){var v=this.createNode();return this.expect(";"),this.finalize(v,new d.EmptyStatement)},y.prototype.parseExpressionStatement=function(){var v=this.createNode(),x=this.parseExpression();return this.consumeSemicolon(),this.finalize(v,new d.ExpressionStatement(x))},y.prototype.parseIfClause=function(){return this.context.strict&&this.matchKeyword("function")&&this.tolerateError(u.Messages.StrictFunction),this.parseStatement()},y.prototype.parseIfStatement=function(){var v,x=this.createNode(),w=null;this.expectKeyword("if"),this.expect("(");var S=this.parseExpression();return!this.match(")")&&this.config.tolerant?(this.tolerateUnexpectedToken(this.nextToken()),v=this.finalize(this.createNode(),new d.EmptyStatement)):(this.expect(")"),v=this.parseIfClause(),this.matchKeyword("else")&&(this.nextToken(),w=this.parseIfClause())),this.finalize(x,new d.IfStatement(S,v,w))},y.prototype.parseDoWhileStatement=function(){var v=this.createNode();this.expectKeyword("do");var x=this.context.inIteration;this.context.inIteration=!0;var w=this.parseStatement();this.context.inIteration=x,this.expectKeyword("while"),this.expect("(");var S=this.parseExpression();return!this.match(")")&&this.config.tolerant?this.tolerateUnexpectedToken(this.nextToken()):(this.expect(")"),this.match(";")&&this.nextToken()),this.finalize(v,new d.DoWhileStatement(w,S))},y.prototype.parseWhileStatement=function(){var v,x=this.createNode();this.expectKeyword("while"),this.expect("(");var w=this.parseExpression();if(!this.match(")")&&this.config.tolerant)this.tolerateUnexpectedToken(this.nextToken()),v=this.finalize(this.createNode(),new d.EmptyStatement);else{this.expect(")");var S=this.context.inIteration;this.context.inIteration=!0,v=this.parseStatement(),this.context.inIteration=S}return this.finalize(x,new d.WhileStatement(w,v))},y.prototype.parseForStatement=function(){var v,x,w,S=null,T=null,_=null,D=!0,I=this.createNode();if(this.expectKeyword("for"),this.expect("("),this.match(";"))this.nextToken();else if(this.matchKeyword("var")){S=this.createNode(),this.nextToken();var R=this.context.allowIn;this.context.allowIn=!1;var O=this.parseVariableDeclarationList({inFor:!0});if(this.context.allowIn=R,O.length===1&&this.matchKeyword("in")){var P=O[0];P.init&&(P.id.type===p.Syntax.ArrayPattern||P.id.type===p.Syntax.ObjectPattern||this.context.strict)&&this.tolerateError(u.Messages.ForInOfLoopInitializer,"for-in"),S=this.finalize(S,new d.VariableDeclaration(O,"var")),this.nextToken(),v=S,x=this.parseExpression(),S=null}else O.length===1&&O[0].init===null&&this.matchContextualKeyword("of")?(S=this.finalize(S,new d.VariableDeclaration(O,"var")),this.nextToken(),v=S,x=this.parseAssignmentExpression(),S=null,D=!1):(S=this.finalize(S,new d.VariableDeclaration(O,"var")),this.expect(";"))}else if(this.matchKeyword("const")||this.matchKeyword("let")){S=this.createNode();var N=this.nextToken().value;this.context.strict||this.lookahead.value!=="in"?(R=this.context.allowIn,this.context.allowIn=!1,O=this.parseBindingList(N,{inFor:!0}),this.context.allowIn=R,O.length===1&&O[0].init===null&&this.matchKeyword("in")?(S=this.finalize(S,new d.VariableDeclaration(O,N)),this.nextToken(),v=S,x=this.parseExpression(),S=null):O.length===1&&O[0].init===null&&this.matchContextualKeyword("of")?(S=this.finalize(S,new d.VariableDeclaration(O,N)),this.nextToken(),v=S,x=this.parseAssignmentExpression(),S=null,D=!1):(this.consumeSemicolon(),S=this.finalize(S,new d.VariableDeclaration(O,N)))):(S=this.finalize(S,new d.Identifier(N)),this.nextToken(),v=S,x=this.parseExpression(),S=null)}else{var A=this.lookahead;if(R=this.context.allowIn,this.context.allowIn=!1,S=this.inheritCoverGrammar(this.parseAssignmentExpression),this.context.allowIn=R,this.matchKeyword("in"))this.context.isAssignmentTarget&&S.type!==p.Syntax.AssignmentExpression||this.tolerateError(u.Messages.InvalidLHSInForIn),this.nextToken(),this.reinterpretExpressionAsPattern(S),v=S,x=this.parseExpression(),S=null;else if(this.matchContextualKeyword("of"))this.context.isAssignmentTarget&&S.type!==p.Syntax.AssignmentExpression||this.tolerateError(u.Messages.InvalidLHSInForLoop),this.nextToken(),this.reinterpretExpressionAsPattern(S),v=S,x=this.parseAssignmentExpression(),S=null,D=!1;else{if(this.match(",")){for(var B=[S];this.match(",");)this.nextToken(),B.push(this.isolateCoverGrammar(this.parseAssignmentExpression));S=this.finalize(this.startNode(A),new d.SequenceExpression(B))}this.expect(";")}}if(v===void 0&&(this.match(";")||(T=this.parseExpression()),this.expect(";"),this.match(")")||(_=this.parseExpression())),!this.match(")")&&this.config.tolerant)this.tolerateUnexpectedToken(this.nextToken()),w=this.finalize(this.createNode(),new d.EmptyStatement);else{this.expect(")");var V=this.context.inIteration;this.context.inIteration=!0,w=this.isolateCoverGrammar(this.parseStatement),this.context.inIteration=V}return v===void 0?this.finalize(I,new d.ForStatement(S,T,_,w)):D?this.finalize(I,new d.ForInStatement(v,x,w)):this.finalize(I,new d.ForOfStatement(v,x,w))},y.prototype.parseContinueStatement=function(){var v=this.createNode();this.expectKeyword("continue");var x=null;if(this.lookahead.type===3&&!this.hasLineTerminator){var w=this.parseVariableIdentifier();x=w;var S="$"+w.name;Object.prototype.hasOwnProperty.call(this.context.labelSet,S)||this.throwError(u.Messages.UnknownLabel,w.name)}return this.consumeSemicolon(),x!==null||this.context.inIteration||this.throwError(u.Messages.IllegalContinue),this.finalize(v,new d.ContinueStatement(x))},y.prototype.parseBreakStatement=function(){var v=this.createNode();this.expectKeyword("break");var x=null;if(this.lookahead.type===3&&!this.hasLineTerminator){var w=this.parseVariableIdentifier(),S="$"+w.name;Object.prototype.hasOwnProperty.call(this.context.labelSet,S)||this.throwError(u.Messages.UnknownLabel,w.name),x=w}return this.consumeSemicolon(),x!==null||this.context.inIteration||this.context.inSwitch||this.throwError(u.Messages.IllegalBreak),this.finalize(v,new d.BreakStatement(x))},y.prototype.parseReturnStatement=function(){this.context.inFunctionBody||this.tolerateError(u.Messages.IllegalReturn);var v=this.createNode();this.expectKeyword("return");var x=(this.match(";")||this.match("}")||this.hasLineTerminator||this.lookahead.type===2)&&this.lookahead.type!==8&&this.lookahead.type!==10?null:this.parseExpression();return this.consumeSemicolon(),this.finalize(v,new d.ReturnStatement(x))},y.prototype.parseWithStatement=function(){this.context.strict&&this.tolerateError(u.Messages.StrictModeWith);var v,x=this.createNode();this.expectKeyword("with"),this.expect("(");var w=this.parseExpression();return!this.match(")")&&this.config.tolerant?(this.tolerateUnexpectedToken(this.nextToken()),v=this.finalize(this.createNode(),new d.EmptyStatement)):(this.expect(")"),v=this.parseStatement()),this.finalize(x,new d.WithStatement(w,v))},y.prototype.parseSwitchCase=function(){var v,x=this.createNode();this.matchKeyword("default")?(this.nextToken(),v=null):(this.expectKeyword("case"),v=this.parseExpression()),this.expect(":");for(var w=[];!(this.match("}")||this.matchKeyword("default")||this.matchKeyword("case"));)w.push(this.parseStatementListItem());return this.finalize(x,new d.SwitchCase(v,w))},y.prototype.parseSwitchStatement=function(){var v=this.createNode();this.expectKeyword("switch"),this.expect("(");var x=this.parseExpression();this.expect(")");var w=this.context.inSwitch;this.context.inSwitch=!0;var S=[],T=!1;for(this.expect("{");!this.match("}");){var _=this.parseSwitchCase();_.test===null&&(T&&this.throwError(u.Messages.MultipleDefaultsInSwitch),T=!0),S.push(_)}return this.expect("}"),this.context.inSwitch=w,this.finalize(v,new d.SwitchStatement(x,S))},y.prototype.parseLabelledStatement=function(){var v,x=this.createNode(),w=this.parseExpression();if(w.type===p.Syntax.Identifier&&this.match(":")){this.nextToken();var S=w,T="$"+S.name;Object.prototype.hasOwnProperty.call(this.context.labelSet,T)&&this.throwError(u.Messages.Redeclaration,"Label",S.name),this.context.labelSet[T]=!0;var _=void 0;if(this.matchKeyword("class"))this.tolerateUnexpectedToken(this.lookahead),_=this.parseClassDeclaration();else if(this.matchKeyword("function")){var D=this.lookahead,I=this.parseFunctionDeclaration();this.context.strict?this.tolerateUnexpectedToken(D,u.Messages.StrictFunction):I.generator&&this.tolerateUnexpectedToken(D,u.Messages.GeneratorInLegacyContext),_=I}else _=this.parseStatement();delete this.context.labelSet[T],v=new d.LabeledStatement(S,_)}else this.consumeSemicolon(),v=new d.ExpressionStatement(w);return this.finalize(x,v)},y.prototype.parseThrowStatement=function(){var v=this.createNode();this.expectKeyword("throw"),this.hasLineTerminator&&this.throwError(u.Messages.NewlineAfterThrow);var x=this.parseExpression();return this.consumeSemicolon(),this.finalize(v,new d.ThrowStatement(x))},y.prototype.parseCatchClause=function(){var v=this.createNode();this.expectKeyword("catch"),this.expect("("),this.match(")")&&this.throwUnexpectedToken(this.lookahead);for(var x=[],w=this.parsePattern(x),S={},T=0;T<x.length;T++){var _="$"+x[T].value;Object.prototype.hasOwnProperty.call(S,_)&&this.tolerateError(u.Messages.DuplicateBinding,x[T].value),S[_]=!0}this.context.strict&&w.type===p.Syntax.Identifier&&this.scanner.isRestrictedWord(w.name)&&this.tolerateError(u.Messages.StrictCatchVariable),this.expect(")");var D=this.parseBlock();return this.finalize(v,new d.CatchClause(w,D))},y.prototype.parseFinallyClause=function(){return this.expectKeyword("finally"),this.parseBlock()},y.prototype.parseTryStatement=function(){var v=this.createNode();this.expectKeyword("try");var x=this.parseBlock(),w=this.matchKeyword("catch")?this.parseCatchClause():null,S=this.matchKeyword("finally")?this.parseFinallyClause():null;return w||S||this.throwError(u.Messages.NoCatchOrFinally),this.finalize(v,new d.TryStatement(x,w,S))},y.prototype.parseDebuggerStatement=function(){var v=this.createNode();return this.expectKeyword("debugger"),this.consumeSemicolon(),this.finalize(v,new d.DebuggerStatement)},y.prototype.parseStatement=function(){var v;switch(this.lookahead.type){case 1:case 5:case 6:case 8:case 10:case 9:v=this.parseExpressionStatement();break;case 7:var x=this.lookahead.value;v=x==="{"?this.parseBlock():x==="("?this.parseExpressionStatement():x===";"?this.parseEmptyStatement():this.parseExpressionStatement();break;case 3:v=this.matchAsyncFunction()?this.parseFunctionDeclaration():this.parseLabelledStatement();break;case 4:switch(this.lookahead.value){case"break":v=this.parseBreakStatement();break;case"continue":v=this.parseContinueStatement();break;case"debugger":v=this.parseDebuggerStatement();break;case"do":v=this.parseDoWhileStatement();break;case"for":v=this.parseForStatement();break;case"function":v=this.parseFunctionDeclaration();break;case"if":v=this.parseIfStatement();break;case"return":v=this.parseReturnStatement();break;case"switch":v=this.parseSwitchStatement();break;case"throw":v=this.parseThrowStatement();break;case"try":v=this.parseTryStatement();break;case"var":v=this.parseVariableStatement();break;case"while":v=this.parseWhileStatement();break;case"with":v=this.parseWithStatement();break;default:v=this.parseExpressionStatement()}break;default:v=this.throwUnexpectedToken(this.lookahead)}return v},y.prototype.parseFunctionSourceElements=function(){var v=this.createNode();this.expect("{");var x=this.parseDirectivePrologues(),w=this.context.labelSet,S=this.context.inIteration,T=this.context.inSwitch,_=this.context.inFunctionBody;for(this.context.labelSet={},this.context.inIteration=!1,this.context.inSwitch=!1,this.context.inFunctionBody=!0;this.lookahead.type!==2&&!this.match("}");)x.push(this.parseStatementListItem());return this.expect("}"),this.context.labelSet=w,this.context.inIteration=S,this.context.inSwitch=T,this.context.inFunctionBody=_,this.finalize(v,new d.BlockStatement(x))},y.prototype.validateParam=function(v,x,w){var S="$"+w;this.context.strict?(this.scanner.isRestrictedWord(w)&&(v.stricted=x,v.message=u.Messages.StrictParamName),Object.prototype.hasOwnProperty.call(v.paramSet,S)&&(v.stricted=x,v.message=u.Messages.StrictParamDupe)):v.firstRestricted||(this.scanner.isRestrictedWord(w)?(v.firstRestricted=x,v.message=u.Messages.StrictParamName):this.scanner.isStrictModeReservedWord(w)?(v.firstRestricted=x,v.message=u.Messages.StrictReservedWord):Object.prototype.hasOwnProperty.call(v.paramSet,S)&&(v.stricted=x,v.message=u.Messages.StrictParamDupe)),typeof Object.defineProperty=="function"?Object.defineProperty(v.paramSet,S,{value:!0,enumerable:!0,writable:!0,configurable:!0}):v.paramSet[S]=!0},y.prototype.parseRestElement=function(v){var x=this.createNode();this.expect("...");var w=this.parsePattern(v);return this.match("=")&&this.throwError(u.Messages.DefaultRestParameter),this.match(")")||this.throwError(u.Messages.ParameterAfterRestParameter),this.finalize(x,new d.RestElement(w))},y.prototype.parseFormalParameter=function(v){for(var x=[],w=this.match("...")?this.parseRestElement(x):this.parsePatternWithDefault(x),S=0;S<x.length;S++)this.validateParam(v,x[S],x[S].value);v.simple=v.simple&&w instanceof d.Identifier,v.params.push(w)},y.prototype.parseFormalParameters=function(v){var x;if(x={simple:!0,params:[],firstRestricted:v},this.expect("("),!this.match(")"))for(x.paramSet={};this.lookahead.type!==2&&(this.parseFormalParameter(x),!this.match(")"))&&(this.expect(","),!this.match(")")););return this.expect(")"),{simple:x.simple,params:x.params,stricted:x.stricted,firstRestricted:x.firstRestricted,message:x.message}},y.prototype.matchAsyncFunction=function(){var v=this.matchContextualKeyword("async");if(v){var x=this.scanner.saveState();this.scanner.scanComments();var w=this.scanner.lex();this.scanner.restoreState(x),v=x.lineNumber===w.lineNumber&&w.type===4&&w.value==="function"}return v},y.prototype.parseFunctionDeclaration=function(v){var x=this.createNode(),w=this.matchContextualKeyword("async");w&&this.nextToken(),this.expectKeyword("function");var S,T=!w&&this.match("*");T&&this.nextToken();var _=null,D=null;if(!v||!this.match("(")){var I=this.lookahead;_=this.parseVariableIdentifier(),this.context.strict?this.scanner.isRestrictedWord(I.value)&&this.tolerateUnexpectedToken(I,u.Messages.StrictFunctionName):this.scanner.isRestrictedWord(I.value)?(D=I,S=u.Messages.StrictFunctionName):this.scanner.isStrictModeReservedWord(I.value)&&(D=I,S=u.Messages.StrictReservedWord)}var R=this.context.await,O=this.context.allowYield;this.context.await=w,this.context.allowYield=!T;var P=this.parseFormalParameters(D),N=P.params,A=P.stricted;D=P.firstRestricted,P.message&&(S=P.message);var B=this.context.strict,V=this.context.allowStrictDirective;this.context.allowStrictDirective=P.simple;var $=this.parseFunctionSourceElements();return this.context.strict&&D&&this.throwUnexpectedToken(D,S),this.context.strict&&A&&this.tolerateUnexpectedToken(A,S),this.context.strict=B,this.context.allowStrictDirective=V,this.context.await=R,this.context.allowYield=O,w?this.finalize(x,new d.AsyncFunctionDeclaration(_,N,$)):this.finalize(x,new d.FunctionDeclaration(_,N,$,T))},y.prototype.parseFunctionExpression=function(){var v=this.createNode(),x=this.matchContextualKeyword("async");x&&this.nextToken(),this.expectKeyword("function");var w,S=!x&&this.match("*");S&&this.nextToken();var T,_=null,D=this.context.await,I=this.context.allowYield;if(this.context.await=x,this.context.allowYield=!S,!this.match("(")){var R=this.lookahead;_=this.context.strict||S||!this.matchKeyword("yield")?this.parseVariableIdentifier():this.parseIdentifierName(),this.context.strict?this.scanner.isRestrictedWord(R.value)&&this.tolerateUnexpectedToken(R,u.Messages.StrictFunctionName):this.scanner.isRestrictedWord(R.value)?(T=R,w=u.Messages.StrictFunctionName):this.scanner.isStrictModeReservedWord(R.value)&&(T=R,w=u.Messages.StrictReservedWord)}var O=this.parseFormalParameters(T),P=O.params,N=O.stricted;T=O.firstRestricted,O.message&&(w=O.message);var A=this.context.strict,B=this.context.allowStrictDirective;this.context.allowStrictDirective=O.simple;var V=this.parseFunctionSourceElements();return this.context.strict&&T&&this.throwUnexpectedToken(T,w),this.context.strict&&N&&this.tolerateUnexpectedToken(N,w),this.context.strict=A,this.context.allowStrictDirective=B,this.context.await=D,this.context.allowYield=I,x?this.finalize(v,new d.AsyncFunctionExpression(_,P,V)):this.finalize(v,new d.FunctionExpression(_,P,V,S))},y.prototype.parseDirective=function(){var v=this.lookahead,x=this.createNode(),w=this.parseExpression(),S=w.type===p.Syntax.Literal?this.getTokenRaw(v).slice(1,-1):null;return this.consumeSemicolon(),this.finalize(x,S?new d.Directive(w,S):new d.ExpressionStatement(w))},y.prototype.parseDirectivePrologues=function(){for(var v=null,x=[];;){var w=this.lookahead;if(w.type!==8)break;var S=this.parseDirective();x.push(S);var T=S.directive;if(typeof T!="string")break;T==="use strict"?(this.context.strict=!0,v&&this.tolerateUnexpectedToken(v,u.Messages.StrictOctalLiteral),this.context.allowStrictDirective||this.tolerateUnexpectedToken(w,u.Messages.IllegalLanguageModeDirective)):!v&&w.octal&&(v=w)}return x},y.prototype.qualifiedPropertyName=function(v){switch(v.type){case 3:case 8:case 1:case 5:case 6:case 4:return!0;case 7:return v.value==="["}return!1},y.prototype.parseGetterMethod=function(){var v=this.createNode(),x=this.context.allowYield;this.context.allowYield=!0;var w=this.parseFormalParameters();w.params.length>0&&this.tolerateError(u.Messages.BadGetterArity);var S=this.parsePropertyMethod(w);return this.context.allowYield=x,this.finalize(v,new d.FunctionExpression(null,w.params,S,!1))},y.prototype.parseSetterMethod=function(){var v=this.createNode(),x=this.context.allowYield;this.context.allowYield=!0;var w=this.parseFormalParameters();w.params.length!==1?this.tolerateError(u.Messages.BadSetterArity):w.params[0]instanceof d.RestElement&&this.tolerateError(u.Messages.BadSetterRestParameter);var S=this.parsePropertyMethod(w);return this.context.allowYield=x,this.finalize(v,new d.FunctionExpression(null,w.params,S,!1))},y.prototype.parseGeneratorMethod=function(){var v=this.createNode(),x=this.context.allowYield;this.context.allowYield=!0;var w=this.parseFormalParameters();this.context.allowYield=!1;var S=this.parsePropertyMethod(w);return this.context.allowYield=x,this.finalize(v,new d.FunctionExpression(null,w.params,S,!0))},y.prototype.isStartOfExpression=function(){var v=!0,x=this.lookahead.value;switch(this.lookahead.type){case 7:v=x==="["||x==="("||x==="{"||x==="+"||x==="-"||x==="!"||x==="~"||x==="++"||x==="--"||x==="/"||x==="/=";break;case 4:v=x==="class"||x==="delete"||x==="function"||x==="let"||x==="new"||x==="super"||x==="this"||x==="typeof"||x==="void"||x==="yield"}return v},y.prototype.parseYieldExpression=function(){var v=this.createNode();this.expectKeyword("yield");var x=null,w=!1;if(!this.hasLineTerminator){var S=this.context.allowYield;this.context.allowYield=!1,(w=this.match("*"))?(this.nextToken(),x=this.parseAssignmentExpression()):this.isStartOfExpression()&&(x=this.parseAssignmentExpression()),this.context.allowYield=S}return this.finalize(v,new d.YieldExpression(x,w))},y.prototype.parseClassElement=function(v){var x=this.lookahead,w=this.createNode(),S="",T=null,_=null,D=!1,I=!1,R=!1,O=!1;if(this.match("*"))this.nextToken();else if(D=this.match("["),(T=this.parseObjectPropertyKey()).name==="static"&&(this.qualifiedPropertyName(this.lookahead)||this.match("*"))&&(x=this.lookahead,R=!0,D=this.match("["),this.match("*")?this.nextToken():T=this.parseObjectPropertyKey()),x.type===3&&!this.hasLineTerminator&&x.value==="async"){var P=this.lookahead.value;P!==":"&&P!=="("&&P!=="*"&&(O=!0,x=this.lookahead,T=this.parseObjectPropertyKey(),x.type===3&&x.value==="constructor"&&this.tolerateUnexpectedToken(x,u.Messages.ConstructorIsAsync))}var N=this.qualifiedPropertyName(this.lookahead);return x.type===3?x.value==="get"&&N?(S="get",D=this.match("["),T=this.parseObjectPropertyKey(),this.context.allowYield=!1,_=this.parseGetterMethod()):x.value==="set"&&N&&(S="set",D=this.match("["),T=this.parseObjectPropertyKey(),_=this.parseSetterMethod()):x.type===7&&x.value==="*"&&N&&(S="init",D=this.match("["),T=this.parseObjectPropertyKey(),_=this.parseGeneratorMethod(),I=!0),!S&&T&&this.match("(")&&(S="init",_=O?this.parsePropertyMethodAsyncFunction():this.parsePropertyMethodFunction(),I=!0),S||this.throwUnexpectedToken(this.lookahead),S==="init"&&(S="method"),D||(R&&this.isPropertyKey(T,"prototype")&&this.throwUnexpectedToken(x,u.Messages.StaticPrototype),!R&&this.isPropertyKey(T,"constructor")&&((S!=="method"||!I||_&&_.generator)&&this.throwUnexpectedToken(x,u.Messages.ConstructorSpecialMethod),v.value?this.throwUnexpectedToken(x,u.Messages.DuplicateConstructor):v.value=!0,S="constructor")),this.finalize(w,new d.MethodDefinition(T,D,_,S,R))},y.prototype.parseClassElementList=function(){var v=[],x={value:!1};for(this.expect("{");!this.match("}");)this.match(";")?this.nextToken():v.push(this.parseClassElement(x));return this.expect("}"),v},y.prototype.parseClassBody=function(){var v=this.createNode(),x=this.parseClassElementList();return this.finalize(v,new d.ClassBody(x))},y.prototype.parseClassDeclaration=function(v){var x=this.createNode(),w=this.context.strict;this.context.strict=!0,this.expectKeyword("class");var S=v&&this.lookahead.type!==3?null:this.parseVariableIdentifier(),T=null;this.matchKeyword("extends")&&(this.nextToken(),T=this.isolateCoverGrammar(this.parseLeftHandSideExpressionAllowCall));var _=this.parseClassBody();return this.context.strict=w,this.finalize(x,new d.ClassDeclaration(S,T,_))},y.prototype.parseClassExpression=function(){var v=this.createNode(),x=this.context.strict;this.context.strict=!0,this.expectKeyword("class");var w=this.lookahead.type===3?this.parseVariableIdentifier():null,S=null;this.matchKeyword("extends")&&(this.nextToken(),S=this.isolateCoverGrammar(this.parseLeftHandSideExpressionAllowCall));var T=this.parseClassBody();return this.context.strict=x,this.finalize(v,new d.ClassExpression(w,S,T))},y.prototype.parseModule=function(){this.context.strict=!0,this.context.isModule=!0,this.scanner.isModule=!0;for(var v=this.createNode(),x=this.parseDirectivePrologues();this.lookahead.type!==2;)x.push(this.parseStatementListItem());return this.finalize(v,new d.Module(x))},y.prototype.parseScript=function(){for(var v=this.createNode(),x=this.parseDirectivePrologues();this.lookahead.type!==2;)x.push(this.parseStatementListItem());return this.finalize(v,new d.Script(x))},y.prototype.parseModuleSpecifier=function(){var v=this.createNode();this.lookahead.type!==8&&this.throwError(u.Messages.InvalidModuleSpecifier);var x=this.nextToken(),w=this.getTokenRaw(x);return this.finalize(v,new d.Literal(x.value,w))},y.prototype.parseImportSpecifier=function(){var v,x,w=this.createNode();return this.lookahead.type===3?(x=v=this.parseVariableIdentifier(),this.matchContextualKeyword("as")&&(this.nextToken(),x=this.parseVariableIdentifier())):(x=v=this.parseIdentifierName(),this.matchContextualKeyword("as")?(this.nextToken(),x=this.parseVariableIdentifier()):this.throwUnexpectedToken(this.nextToken())),this.finalize(w,new d.ImportSpecifier(x,v))},y.prototype.parseNamedImports=function(){this.expect("{");for(var v=[];!this.match("}");)v.push(this.parseImportSpecifier()),this.match("}")||this.expect(",");return this.expect("}"),v},y.prototype.parseImportDefaultSpecifier=function(){var v=this.createNode(),x=this.parseIdentifierName();return this.finalize(v,new d.ImportDefaultSpecifier(x))},y.prototype.parseImportNamespaceSpecifier=function(){var v=this.createNode();this.expect("*"),this.matchContextualKeyword("as")||this.throwError(u.Messages.NoAsAfterImportNamespace),this.nextToken();var x=this.parseIdentifierName();return this.finalize(v,new d.ImportNamespaceSpecifier(x))},y.prototype.parseImportDeclaration=function(){this.context.inFunctionBody&&this.throwError(u.Messages.IllegalImportDeclaration);var v,x=this.createNode();this.expectKeyword("import");var w=[];if(this.lookahead.type===8)v=this.parseModuleSpecifier();else{if(this.match("{")?w=w.concat(this.parseNamedImports()):this.match("*")?w.push(this.parseImportNamespaceSpecifier()):this.isIdentifierName(this.lookahead)&&!this.matchKeyword("default")?(w.push(this.parseImportDefaultSpecifier()),this.match(",")&&(this.nextToken(),this.match("*")?w.push(this.parseImportNamespaceSpecifier()):this.match("{")?w=w.concat(this.parseNamedImports()):this.throwUnexpectedToken(this.lookahead))):this.throwUnexpectedToken(this.nextToken()),!this.matchContextualKeyword("from")){var S=this.lookahead.value?u.Messages.UnexpectedToken:u.Messages.MissingFromClause;this.throwError(S,this.lookahead.value)}this.nextToken(),v=this.parseModuleSpecifier()}return this.consumeSemicolon(),this.finalize(x,new d.ImportDeclaration(w,v))},y.prototype.parseExportSpecifier=function(){var v=this.createNode(),x=this.parseIdentifierName(),w=x;return this.matchContextualKeyword("as")&&(this.nextToken(),w=this.parseIdentifierName()),this.finalize(v,new d.ExportSpecifier(x,w))},y.prototype.parseExportDeclaration=function(){this.context.inFunctionBody&&this.throwError(u.Messages.IllegalExportDeclaration);var v,x=this.createNode();if(this.expectKeyword("export"),this.matchKeyword("default"))if(this.nextToken(),this.matchKeyword("function")){var w=this.parseFunctionDeclaration(!0);v=this.finalize(x,new d.ExportDefaultDeclaration(w))}else this.matchKeyword("class")?(w=this.parseClassDeclaration(!0),v=this.finalize(x,new d.ExportDefaultDeclaration(w))):this.matchContextualKeyword("async")?(w=this.matchAsyncFunction()?this.parseFunctionDeclaration(!0):this.parseAssignmentExpression(),v=this.finalize(x,new d.ExportDefaultDeclaration(w))):(this.matchContextualKeyword("from")&&this.throwError(u.Messages.UnexpectedToken,this.lookahead.value),w=this.match("{")?this.parseObjectInitializer():this.match("[")?this.parseArrayInitializer():this.parseAssignmentExpression(),this.consumeSemicolon(),v=this.finalize(x,new d.ExportDefaultDeclaration(w)));else if(this.match("*")){if(this.nextToken(),!this.matchContextualKeyword("from")){var S=this.lookahead.value?u.Messages.UnexpectedToken:u.Messages.MissingFromClause;this.throwError(S,this.lookahead.value)}this.nextToken();var T=this.parseModuleSpecifier();this.consumeSemicolon(),v=this.finalize(x,new d.ExportAllDeclaration(T))}else if(this.lookahead.type===4){switch(w=void 0,this.lookahead.value){case"let":case"const":w=this.parseLexicalDeclaration({inFor:!1});break;case"var":case"class":case"function":w=this.parseStatementListItem();break;default:this.throwUnexpectedToken(this.lookahead)}v=this.finalize(x,new d.ExportNamedDeclaration(w,[],null))}else if(this.matchAsyncFunction())w=this.parseFunctionDeclaration(),v=this.finalize(x,new d.ExportNamedDeclaration(w,[],null));else{var _=[],D=null,I=!1;for(this.expect("{");!this.match("}");)I=I||this.matchKeyword("default"),_.push(this.parseExportSpecifier()),this.match("}")||this.expect(",");this.expect("}"),this.matchContextualKeyword("from")?(this.nextToken(),D=this.parseModuleSpecifier(),this.consumeSemicolon()):I?(S=this.lookahead.value?u.Messages.UnexpectedToken:u.Messages.MissingFromClause,this.throwError(S,this.lookahead.value)):this.consumeSemicolon(),v=this.finalize(x,new d.ExportNamedDeclaration(null,_,D))}return v},y})();s.Parser=m},function(o,s){Object.defineProperty(s,"__esModule",{value:!0}),s.assert=function(l,c){if(!l)throw new Error("ASSERT: "+c)}},function(o,s){Object.defineProperty(s,"__esModule",{value:!0});var l=(function(){function c(){this.errors=[],this.tolerant=!1}return c.prototype.recordError=function(f){this.errors.push(f)},c.prototype.tolerate=function(f){if(!this.tolerant)throw f;this.recordError(f)},c.prototype.constructError=function(f,u){var d=new Error(f);try{throw d}catch(h){Object.create&&Object.defineProperty&&(d=Object.create(h),Object.defineProperty(d,"column",{value:u}))}return d},c.prototype.createError=function(f,u,d,h){var p="Line "+u+": "+h,g=this.constructError(p,d);return g.index=f,g.lineNumber=u,g.description=h,g},c.prototype.throwError=function(f,u,d,h){throw this.createError(f,u,d,h)},c.prototype.tolerateError=function(f,u,d,h){var p=this.createError(f,u,d,h);if(!this.tolerant)throw p;this.recordError(p)},c})();s.ErrorHandler=l},function(o,s){Object.defineProperty(s,"__esModule",{value:!0}),s.Messages={BadGetterArity:"Getter must not have any formal parameters",BadSetterArity:"Setter must have exactly one formal parameter",BadSetterRestParameter:"Setter function argument must not be a rest parameter",ConstructorIsAsync:"Class constructor may not be an async method",ConstructorSpecialMethod:"Class constructor may not be an accessor",DeclarationMissingInitializer:"Missing initializer in %0 declaration",DefaultRestParameter:"Unexpected token =",DuplicateBinding:"Duplicate binding %0",DuplicateConstructor:"A class may only have one constructor",DuplicateProtoProperty:"Duplicate __proto__ fields are not allowed in object literals",ForInOfLoopInitializer:"%0 loop variable declaration may not have an initializer",GeneratorInLegacyContext:"Generator declarations are not allowed in legacy contexts",IllegalBreak:"Illegal break statement",IllegalContinue:"Illegal continue statement",IllegalExportDeclaration:"Unexpected token",IllegalImportDeclaration:"Unexpected token",IllegalLanguageModeDirective:"Illegal 'use strict' directive in function with non-simple parameter list",IllegalReturn:"Illegal return statement",InvalidEscapedReservedWord:"Keyword must not contain escaped characters",InvalidHexEscapeSequence:"Invalid hexadecimal escape sequence",InvalidLHSInAssignment:"Invalid left-hand side in assignment",InvalidLHSInForIn:"Invalid left-hand side in for-in",InvalidLHSInForLoop:"Invalid left-hand side in for-loop",InvalidModuleSpecifier:"Unexpected token",InvalidRegExp:"Invalid regular expression",LetInLexicalBinding:"let is disallowed as a lexically bound name",MissingFromClause:"Unexpected token",MultipleDefaultsInSwitch:"More than one default clause in switch statement",NewlineAfterThrow:"Illegal newline after throw",NoAsAfterImportNamespace:"Unexpected token",NoCatchOrFinally:"Missing catch or finally after try",ParameterAfterRestParameter:"Rest parameter must be last formal parameter",Redeclaration:"%0 '%1' has already been declared",StaticPrototype:"Classes may not have static property named prototype",StrictCatchVariable:"Catch variable may not be eval or arguments in strict mode",StrictDelete:"Delete of an unqualified identifier in strict mode.",StrictFunction:"In strict mode code, functions can only be declared at top level or inside a block",StrictFunctionName:"Function name may not be eval or arguments in strict mode",StrictLHSAssignment:"Assignment to eval or arguments is not allowed in strict mode",StrictLHSPostfix:"Postfix increment/decrement may not have eval or arguments operand in strict mode",StrictLHSPrefix:"Prefix increment/decrement may not have eval or arguments operand in strict mode",StrictModeWith:"Strict mode code may not include a with statement",StrictOctalLiteral:"Octal literals are not allowed in strict mode.",StrictParamDupe:"Strict mode function may not have duplicate parameter names",StrictParamName:"Parameter name eval or arguments is not allowed in strict mode",StrictReservedWord:"Use of future reserved word in strict mode",StrictVarName:"Variable name may not be eval or arguments in strict mode",TemplateOctalLiteral:"Octal literals are not allowed in template strings.",UnexpectedEOS:"Unexpected end of input",UnexpectedIdentifier:"Unexpected identifier",UnexpectedNumber:"Unexpected number",UnexpectedReserved:"Unexpected reserved word",UnexpectedString:"Unexpected string",UnexpectedTemplate:"Unexpected quasi %0",UnexpectedToken:"Unexpected token %0",UnexpectedTokenIllegal:"Unexpected token ILLEGAL",UnknownLabel:"Undefined label '%0'",UnterminatedRegExp:"Invalid regular expression: missing /"}},function(o,s,l){Object.defineProperty(s,"__esModule",{value:!0});var c=l(9),f=l(4),u=l(11);function d(g){return"0123456789abcdef".indexOf(g.toLowerCase())}function h(g){return"01234567".indexOf(g)}var p=(function(){function g(m,y){this.source=m,this.errorHandler=y,this.trackComment=!1,this.isModule=!1,this.length=m.length,this.index=0,this.lineNumber=m.length>0?1:0,this.lineStart=0,this.curlyStack=[]}return g.prototype.saveState=function(){return{index:this.index,lineNumber:this.lineNumber,lineStart:this.lineStart}},g.prototype.restoreState=function(m){this.index=m.index,this.lineNumber=m.lineNumber,this.lineStart=m.lineStart},g.prototype.eof=function(){return this.index>=this.length},g.prototype.throwUnexpectedToken=function(m){return m===void 0&&(m=u.Messages.UnexpectedTokenIllegal),this.errorHandler.throwError(this.index,this.lineNumber,this.index-this.lineStart+1,m)},g.prototype.tolerateUnexpectedToken=function(m){m===void 0&&(m=u.Messages.UnexpectedTokenIllegal),this.errorHandler.tolerateError(this.index,this.lineNumber,this.index-this.lineStart+1,m)},g.prototype.skipSingleLineComment=function(m){var y,v,x=[];for(this.trackComment&&(x=[],y=this.index-m,v={start:{line:this.lineNumber,column:this.index-this.lineStart-m},end:{}});!this.eof();){var w=this.source.charCodeAt(this.index);if(++this.index,f.Character.isLineTerminator(w)){if(this.trackComment){v.end={line:this.lineNumber,column:this.index-this.lineStart-1};var S={multiLine:!1,slice:[y+m,this.index-1],range:[y,this.index-1],loc:v};x.push(S)}return w===13&&this.source.charCodeAt(this.index)===10&&++this.index,++this.lineNumber,this.lineStart=this.index,x}}return this.trackComment&&(v.end={line:this.lineNumber,column:this.index-this.lineStart},S={multiLine:!1,slice:[y+m,this.index],range:[y,this.index],loc:v},x.push(S)),x},g.prototype.skipMultiLineComment=function(){var m,y,v=[];for(this.trackComment&&(v=[],m=this.index-2,y={start:{line:this.lineNumber,column:this.index-this.lineStart-2},end:{}});!this.eof();){var x=this.source.charCodeAt(this.index);if(f.Character.isLineTerminator(x))x===13&&this.source.charCodeAt(this.index+1)===10&&++this.index,++this.lineNumber,++this.index,this.lineStart=this.index;else if(x===42){if(this.source.charCodeAt(this.index+1)===47){if(this.index+=2,this.trackComment){y.end={line:this.lineNumber,column:this.index-this.lineStart};var w={multiLine:!0,slice:[m+2,this.index-2],range:[m,this.index],loc:y};v.push(w)}return v}++this.index}else++this.index}return this.trackComment&&(y.end={line:this.lineNumber,column:this.index-this.lineStart},w={multiLine:!0,slice:[m+2,this.index],range:[m,this.index],loc:y},v.push(w)),this.tolerateUnexpectedToken(),v},g.prototype.scanComments=function(){var m;this.trackComment&&(m=[]);for(var y=this.index===0;!this.eof();){var v=this.source.charCodeAt(this.index);if(f.Character.isWhiteSpace(v))++this.index;else if(f.Character.isLineTerminator(v))++this.index,v===13&&this.source.charCodeAt(this.index)===10&&++this.index,++this.lineNumber,this.lineStart=this.index,y=!0;else if(v===47)if((v=this.source.charCodeAt(this.index+1))===47){this.index+=2;var x=this.skipSingleLineComment(2);this.trackComment&&(m=m.concat(x)),y=!0}else{if(v!==42)break;this.index+=2,x=this.skipMultiLineComment(),this.trackComment&&(m=m.concat(x))}else if(y&&v===45){if(this.source.charCodeAt(this.index+1)!==45||this.source.charCodeAt(this.index+2)!==62)break;this.index+=3,x=this.skipSingleLineComment(3),this.trackComment&&(m=m.concat(x))}else{if(v!==60||this.isModule||this.source.slice(this.index+1,this.index+4)!=="!--")break;this.index+=4,x=this.skipSingleLineComment(4),this.trackComment&&(m=m.concat(x))}}return m},g.prototype.isFutureReservedWord=function(m){switch(m){case"enum":case"export":case"import":case"super":return!0;default:return!1}},g.prototype.isStrictModeReservedWord=function(m){switch(m){case"implements":case"interface":case"package":case"private":case"protected":case"public":case"static":case"yield":case"let":return!0;default:return!1}},g.prototype.isRestrictedWord=function(m){return m==="eval"||m==="arguments"},g.prototype.isKeyword=function(m){switch(m.length){case 2:return m==="if"||m==="in"||m==="do";case 3:return m==="var"||m==="for"||m==="new"||m==="try"||m==="let";case 4:return m==="this"||m==="else"||m==="case"||m==="void"||m==="with"||m==="enum";case 5:return m==="while"||m==="break"||m==="catch"||m==="throw"||m==="const"||m==="yield"||m==="class"||m==="super";case 6:return m==="return"||m==="typeof"||m==="delete"||m==="switch"||m==="export"||m==="import";case 7:return m==="default"||m==="finally"||m==="extends";case 8:return m==="function"||m==="continue"||m==="debugger";case 10:return m==="instanceof";default:return!1}},g.prototype.codePointAt=function(m){var y=this.source.charCodeAt(m);if(y>=55296&&y<=56319){var v=this.source.charCodeAt(m+1);v>=56320&&v<=57343&&(y=1024*(y-55296)+v-56320+65536)}return y},g.prototype.scanHexEscape=function(m){for(var y=m==="u"?4:2,v=0,x=0;x<y;++x){if(this.eof()||!f.Character.isHexDigit(this.source.charCodeAt(this.index)))return null;v=16*v+d(this.source[this.index++])}return String.fromCharCode(v)},g.prototype.scanUnicodeCodePointEscape=function(){var m=this.source[this.index],y=0;for(m==="}"&&this.throwUnexpectedToken();!this.eof()&&(m=this.source[this.index++],f.Character.isHexDigit(m.charCodeAt(0)));)y=16*y+d(m);return(y>1114111||m!=="}")&&this.throwUnexpectedToken(),f.Character.fromCodePoint(y)},g.prototype.getIdentifier=function(){for(var m=this.index++;!this.eof();){var y=this.source.charCodeAt(this.index);if(y===92)return this.index=m,this.getComplexIdentifier();if(y>=55296&&y<57343)return this.index=m,this.getComplexIdentifier();if(!f.Character.isIdentifierPart(y))break;++this.index}return this.source.slice(m,this.index)},g.prototype.getComplexIdentifier=function(){var m,y=this.codePointAt(this.index),v=f.Character.fromCodePoint(y);for(this.index+=v.length,y===92&&(this.source.charCodeAt(this.index)!==117&&this.throwUnexpectedToken(),++this.index,this.source[this.index]==="{"?(++this.index,m=this.scanUnicodeCodePointEscape()):(m=this.scanHexEscape("u"))!==null&&m!=="\\"&&f.Character.isIdentifierStart(m.charCodeAt(0))||this.throwUnexpectedToken(),v=m);!this.eof()&&(y=this.codePointAt(this.index),f.Character.isIdentifierPart(y));)v+=m=f.Character.fromCodePoint(y),this.index+=m.length,y===92&&(v=v.substr(0,v.length-1),this.source.charCodeAt(this.index)!==117&&this.throwUnexpectedToken(),++this.index,this.source[this.index]==="{"?(++this.index,m=this.scanUnicodeCodePointEscape()):(m=this.scanHexEscape("u"))!==null&&m!=="\\"&&f.Character.isIdentifierPart(m.charCodeAt(0))||this.throwUnexpectedToken(),v+=m);return v},g.prototype.octalToDecimal=function(m){var y=m!=="0",v=h(m);return!this.eof()&&f.Character.isOctalDigit(this.source.charCodeAt(this.index))&&(y=!0,v=8*v+h(this.source[this.index++]),"0123".indexOf(m)>=0&&!this.eof()&&f.Character.isOctalDigit(this.source.charCodeAt(this.index))&&(v=8*v+h(this.source[this.index++]))),{code:v,octal:y}},g.prototype.scanIdentifier=function(){var m,y=this.index,v=this.source.charCodeAt(y)===92?this.getComplexIdentifier():this.getIdentifier();if((m=v.length===1?3:this.isKeyword(v)?4:v==="null"?5:v==="true"||v==="false"?1:3)!=3&&y+v.length!==this.index){var x=this.index;this.index=y,this.tolerateUnexpectedToken(u.Messages.InvalidEscapedReservedWord),this.index=x}return{type:m,value:v,lineNumber:this.lineNumber,lineStart:this.lineStart,start:y,end:this.index}},g.prototype.scanPunctuator=function(){var m=this.index,y=this.source[this.index];switch(y){case"(":case"{":y==="{"&&this.curlyStack.push("{"),++this.index;break;case".":++this.index,this.source[this.index]==="."&&this.source[this.index+1]==="."&&(this.index+=2,y="...");break;case"}":++this.index,this.curlyStack.pop();break;case")":case";":case",":case"[":case"]":case":":case"?":case"~":++this.index;break;default:(y=this.source.substr(this.index,4))===">>>="?this.index+=4:(y=y.substr(0,3))==="==="||y==="!=="||y===">>>"||y==="<<="||y===">>="||y==="**="?this.index+=3:(y=y.substr(0,2))==="&&"||y==="||"||y==="=="||y==="!="||y==="+="||y==="-="||y==="*="||y==="/="||y==="++"||y==="--"||y==="<<"||y===">>"||y==="&="||y==="|="||y==="^="||y==="%="||y==="<="||y===">="||y==="=>"||y==="**"?this.index+=2:(y=this.source[this.index],"<>=!+-*%&|^/".indexOf(y)>=0&&++this.index)}return this.index===m&&this.throwUnexpectedToken(),{type:7,value:y,lineNumber:this.lineNumber,lineStart:this.lineStart,start:m,end:this.index}},g.prototype.scanHexLiteral=function(m){for(var y="";!this.eof()&&f.Character.isHexDigit(this.source.charCodeAt(this.index));)y+=this.source[this.index++];return y.length===0&&this.throwUnexpectedToken(),f.Character.isIdentifierStart(this.source.charCodeAt(this.index))&&this.throwUnexpectedToken(),{type:6,value:parseInt("0x"+y,16),lineNumber:this.lineNumber,lineStart:this.lineStart,start:m,end:this.index}},g.prototype.scanBinaryLiteral=function(m){for(var y,v="";!this.eof()&&((y=this.source[this.index])==="0"||y==="1");)v+=this.source[this.index++];return v.length===0&&this.throwUnexpectedToken(),this.eof()||(y=this.source.charCodeAt(this.index),(f.Character.isIdentifierStart(y)||f.Character.isDecimalDigit(y))&&this.throwUnexpectedToken()),{type:6,value:parseInt(v,2),lineNumber:this.lineNumber,lineStart:this.lineStart,start:m,end:this.index}},g.prototype.scanOctalLiteral=function(m,y){var v="",x=!1;for(f.Character.isOctalDigit(m.charCodeAt(0))?(x=!0,v="0"+this.source[this.index++]):++this.index;!this.eof()&&f.Character.isOctalDigit(this.source.charCodeAt(this.index));)v+=this.source[this.index++];return x||v.length!==0||this.throwUnexpectedToken(),(f.Character.isIdentifierStart(this.source.charCodeAt(this.index))||f.Character.isDecimalDigit(this.source.charCodeAt(this.index)))&&this.throwUnexpectedToken(),{type:6,value:parseInt(v,8),octal:x,lineNumber:this.lineNumber,lineStart:this.lineStart,start:y,end:this.index}},g.prototype.isImplicitOctalLiteral=function(){for(var m=this.index+1;m<this.length;++m){var y=this.source[m];if(y==="8"||y==="9")return!1;if(!f.Character.isOctalDigit(y.charCodeAt(0)))return!0}return!0},g.prototype.scanNumericLiteral=function(){var m=this.index,y=this.source[m];c.assert(f.Character.isDecimalDigit(y.charCodeAt(0))||y===".","Numeric literal must start with a decimal digit or a decimal point");var v="";if(y!=="."){if(v=this.source[this.index++],y=this.source[this.index],v==="0"){if(y==="x"||y==="X")return++this.index,this.scanHexLiteral(m);if(y==="b"||y==="B")return++this.index,this.scanBinaryLiteral(m);if(y==="o"||y==="O")return this.scanOctalLiteral(y,m);if(y&&f.Character.isOctalDigit(y.charCodeAt(0))&&this.isImplicitOctalLiteral())return this.scanOctalLiteral(y,m)}for(;f.Character.isDecimalDigit(this.source.charCodeAt(this.index));)v+=this.source[this.index++];y=this.source[this.index]}if(y==="."){for(v+=this.source[this.index++];f.Character.isDecimalDigit(this.source.charCodeAt(this.index));)v+=this.source[this.index++];y=this.source[this.index]}if(y==="e"||y==="E")if(v+=this.source[this.index++],(y=this.source[this.index])!=="+"&&y!=="-"||(v+=this.source[this.index++]),f.Character.isDecimalDigit(this.source.charCodeAt(this.index)))for(;f.Character.isDecimalDigit(this.source.charCodeAt(this.index));)v+=this.source[this.index++];else this.throwUnexpectedToken();return f.Character.isIdentifierStart(this.source.charCodeAt(this.index))&&this.throwUnexpectedToken(),{type:6,value:parseFloat(v),lineNumber:this.lineNumber,lineStart:this.lineStart,start:m,end:this.index}},g.prototype.scanStringLiteral=function(){var m=this.index,y=this.source[m];c.assert(y==="'"||y==='"',"String literal must starts with a quote"),++this.index;for(var v=!1,x="";!this.eof();){var w=this.source[this.index++];if(w===y){y="";break}if(w==="\\")if((w=this.source[this.index++])&&f.Character.isLineTerminator(w.charCodeAt(0)))++this.lineNumber,w==="\r"&&this.source[this.index]===`
`&&++this.index,this.lineStart=this.index;else switch(w){case"u":if(this.source[this.index]==="{")++this.index,x+=this.scanUnicodeCodePointEscape();else{var S=this.scanHexEscape(w);S===null&&this.throwUnexpectedToken(),x+=S}break;case"x":var T=this.scanHexEscape(w);T===null&&this.throwUnexpectedToken(u.Messages.InvalidHexEscapeSequence),x+=T;break;case"n":x+=`
`;break;case"r":x+="\r";break;case"t":x+="	";break;case"b":x+="\b";break;case"f":x+="\f";break;case"v":x+="\v";break;case"8":case"9":x+=w,this.tolerateUnexpectedToken();break;default:if(w&&f.Character.isOctalDigit(w.charCodeAt(0))){var _=this.octalToDecimal(w);v=_.octal||v,x+=String.fromCharCode(_.code)}else x+=w}else{if(f.Character.isLineTerminator(w.charCodeAt(0)))break;x+=w}}return y!==""&&(this.index=m,this.throwUnexpectedToken()),{type:8,value:x,octal:v,lineNumber:this.lineNumber,lineStart:this.lineStart,start:m,end:this.index}},g.prototype.scanTemplate=function(){var m="",y=!1,v=this.index,x=this.source[v]==="`",w=!1,S=2;for(++this.index;!this.eof();){var T=this.source[this.index++];if(T==="`"){S=1,w=!0,y=!0;break}if(T==="$"){if(this.source[this.index]==="{"){this.curlyStack.push("${"),++this.index,y=!0;break}m+=T}else if(T==="\\")if(T=this.source[this.index++],f.Character.isLineTerminator(T.charCodeAt(0)))++this.lineNumber,T==="\r"&&this.source[this.index]===`
`&&++this.index,this.lineStart=this.index;else switch(T){case"n":m+=`
`;break;case"r":m+="\r";break;case"t":m+="	";break;case"u":if(this.source[this.index]==="{")++this.index,m+=this.scanUnicodeCodePointEscape();else{var _=this.index,D=this.scanHexEscape(T);D!==null?m+=D:(this.index=_,m+=T)}break;case"x":var I=this.scanHexEscape(T);I===null&&this.throwUnexpectedToken(u.Messages.InvalidHexEscapeSequence),m+=I;break;case"b":m+="\b";break;case"f":m+="\f";break;case"v":m+="\v";break;default:T==="0"?(f.Character.isDecimalDigit(this.source.charCodeAt(this.index))&&this.throwUnexpectedToken(u.Messages.TemplateOctalLiteral),m+="\0"):f.Character.isOctalDigit(T.charCodeAt(0))?this.throwUnexpectedToken(u.Messages.TemplateOctalLiteral):m+=T}else f.Character.isLineTerminator(T.charCodeAt(0))?(++this.lineNumber,T==="\r"&&this.source[this.index]===`
`&&++this.index,this.lineStart=this.index,m+=`
`):m+=T}return y||this.throwUnexpectedToken(),x||this.curlyStack.pop(),{type:10,value:this.source.slice(v+1,this.index-S),cooked:m,head:x,tail:w,lineNumber:this.lineNumber,lineStart:this.lineStart,start:v,end:this.index}},g.prototype.testRegExp=function(m,y){var v=m,x=this;y.indexOf("u")>=0&&(v=v.replace(/\\u\{([0-9a-fA-F]+)\}|\\u([a-fA-F0-9]{4})/g,(function(w,S,T){var _=parseInt(S||T,16);return _>1114111&&x.throwUnexpectedToken(u.Messages.InvalidRegExp),_<=65535?String.fromCharCode(_):"￿"})).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"￿"));try{RegExp(v)}catch{this.throwUnexpectedToken(u.Messages.InvalidRegExp)}try{return new RegExp(m,y)}catch{return null}},g.prototype.scanRegExpBody=function(){var m=this.source[this.index];c.assert(m==="/","Regular expression literal must start with a slash");for(var y=this.source[this.index++],v=!1,x=!1;!this.eof();)if(y+=m=this.source[this.index++],m==="\\")m=this.source[this.index++],f.Character.isLineTerminator(m.charCodeAt(0))&&this.throwUnexpectedToken(u.Messages.UnterminatedRegExp),y+=m;else if(f.Character.isLineTerminator(m.charCodeAt(0)))this.throwUnexpectedToken(u.Messages.UnterminatedRegExp);else if(v)m==="]"&&(v=!1);else{if(m==="/"){x=!0;break}m==="["&&(v=!0)}return x||this.throwUnexpectedToken(u.Messages.UnterminatedRegExp),y.substr(1,y.length-2)},g.prototype.scanRegExpFlags=function(){for(var m="";!this.eof();){var y=this.source[this.index];if(!f.Character.isIdentifierPart(y.charCodeAt(0)))break;if(++this.index,y!=="\\"||this.eof())m+=y;else if((y=this.source[this.index])==="u"){++this.index;var v=this.index,x=this.scanHexEscape("u");if(x!==null)for(m+=x;v<this.index;++v)this.source[v];else this.index=v,m+="u";this.tolerateUnexpectedToken()}else this.tolerateUnexpectedToken()}return m},g.prototype.scanRegExp=function(){var m=this.index,y=this.scanRegExpBody(),v=this.scanRegExpFlags();return{type:9,value:"",pattern:y,flags:v,regex:this.testRegExp(y,v),lineNumber:this.lineNumber,lineStart:this.lineStart,start:m,end:this.index}},g.prototype.lex=function(){if(this.eof())return{type:2,value:"",lineNumber:this.lineNumber,lineStart:this.lineStart,start:this.index,end:this.index};var m=this.source.charCodeAt(this.index);return f.Character.isIdentifierStart(m)?this.scanIdentifier():m===40||m===41||m===59?this.scanPunctuator():m===39||m===34?this.scanStringLiteral():m===46?f.Character.isDecimalDigit(this.source.charCodeAt(this.index+1))?this.scanNumericLiteral():this.scanPunctuator():f.Character.isDecimalDigit(m)?this.scanNumericLiteral():m===96||m===125&&this.curlyStack[this.curlyStack.length-1]==="${"?this.scanTemplate():m>=55296&&m<57343&&f.Character.isIdentifierStart(this.codePointAt(this.index))?this.scanIdentifier():this.scanPunctuator()},g})();s.Scanner=p},function(o,s){Object.defineProperty(s,"__esModule",{value:!0}),s.TokenName={},s.TokenName[1]="Boolean",s.TokenName[2]="<end>",s.TokenName[3]="Identifier",s.TokenName[4]="Keyword",s.TokenName[5]="Null",s.TokenName[6]="Numeric",s.TokenName[7]="Punctuator",s.TokenName[8]="String",s.TokenName[9]="RegularExpression",s.TokenName[10]="Template"},function(o,s){Object.defineProperty(s,"__esModule",{value:!0}),s.XHTMLEntities={quot:'"',amp:"&",apos:"'",gt:">",nbsp:" ",iexcl:"¡",cent:"¢",pound:"£",curren:"¤",yen:"¥",brvbar:"¦",sect:"§",uml:"¨",copy:"©",ordf:"ª",laquo:"«",not:"¬",shy:"­",reg:"®",macr:"¯",deg:"°",plusmn:"±",sup2:"²",sup3:"³",acute:"´",micro:"µ",para:"¶",middot:"·",cedil:"¸",sup1:"¹",ordm:"º",raquo:"»",frac14:"¼",frac12:"½",frac34:"¾",iquest:"¿",Agrave:"À",Aacute:"Á",Acirc:"Â",Atilde:"Ã",Auml:"Ä",Aring:"Å",AElig:"Æ",Ccedil:"Ç",Egrave:"È",Eacute:"É",Ecirc:"Ê",Euml:"Ë",Igrave:"Ì",Iacute:"Í",Icirc:"Î",Iuml:"Ï",ETH:"Ð",Ntilde:"Ñ",Ograve:"Ò",Oacute:"Ó",Ocirc:"Ô",Otilde:"Õ",Ouml:"Ö",times:"×",Oslash:"Ø",Ugrave:"Ù",Uacute:"Ú",Ucirc:"Û",Uuml:"Ü",Yacute:"Ý",THORN:"Þ",szlig:"ß",agrave:"à",aacute:"á",acirc:"â",atilde:"ã",auml:"ä",aring:"å",aelig:"æ",ccedil:"ç",egrave:"è",eacute:"é",ecirc:"ê",euml:"ë",igrave:"ì",iacute:"í",icirc:"î",iuml:"ï",eth:"ð",ntilde:"ñ",ograve:"ò",oacute:"ó",ocirc:"ô",otilde:"õ",ouml:"ö",divide:"÷",oslash:"ø",ugrave:"ù",uacute:"ú",ucirc:"û",uuml:"ü",yacute:"ý",thorn:"þ",yuml:"ÿ",OElig:"Œ",oelig:"œ",Scaron:"Š",scaron:"š",Yuml:"Ÿ",fnof:"ƒ",circ:"ˆ",tilde:"˜",Alpha:"Α",Beta:"Β",Gamma:"Γ",Delta:"Δ",Epsilon:"Ε",Zeta:"Ζ",Eta:"Η",Theta:"Θ",Iota:"Ι",Kappa:"Κ",Lambda:"Λ",Mu:"Μ",Nu:"Ν",Xi:"Ξ",Omicron:"Ο",Pi:"Π",Rho:"Ρ",Sigma:"Σ",Tau:"Τ",Upsilon:"Υ",Phi:"Φ",Chi:"Χ",Psi:"Ψ",Omega:"Ω",alpha:"α",beta:"β",gamma:"γ",delta:"δ",epsilon:"ε",zeta:"ζ",eta:"η",theta:"θ",iota:"ι",kappa:"κ",lambda:"λ",mu:"μ",nu:"ν",xi:"ξ",omicron:"ο",pi:"π",rho:"ρ",sigmaf:"ς",sigma:"σ",tau:"τ",upsilon:"υ",phi:"φ",chi:"χ",psi:"ψ",omega:"ω",thetasym:"ϑ",upsih:"ϒ",piv:"ϖ",ensp:" ",emsp:" ",thinsp:" ",zwnj:"‌",zwj:"‍",lrm:"‎",rlm:"‏",ndash:"–",mdash:"—",lsquo:"‘",rsquo:"’",sbquo:"‚",ldquo:"“",rdquo:"”",bdquo:"„",dagger:"†",Dagger:"‡",bull:"•",hellip:"…",permil:"‰",prime:"′",Prime:"″",lsaquo:"‹",rsaquo:"›",oline:"‾",frasl:"⁄",euro:"€",image:"ℑ",weierp:"℘",real:"ℜ",trade:"™",alefsym:"ℵ",larr:"←",uarr:"↑",rarr:"→",darr:"↓",harr:"↔",crarr:"↵",lArr:"⇐",uArr:"⇑",rArr:"⇒",dArr:"⇓",hArr:"⇔",forall:"∀",part:"∂",exist:"∃",empty:"∅",nabla:"∇",isin:"∈",notin:"∉",ni:"∋",prod:"∏",sum:"∑",minus:"−",lowast:"∗",radic:"√",prop:"∝",infin:"∞",ang:"∠",and:"∧",or:"∨",cap:"∩",cup:"∪",int:"∫",there4:"∴",sim:"∼",cong:"≅",asymp:"≈",ne:"≠",equiv:"≡",le:"≤",ge:"≥",sub:"⊂",sup:"⊃",nsub:"⊄",sube:"⊆",supe:"⊇",oplus:"⊕",otimes:"⊗",perp:"⊥",sdot:"⋅",lceil:"⌈",rceil:"⌉",lfloor:"⌊",rfloor:"⌋",loz:"◊",spades:"♠",clubs:"♣",hearts:"♥",diams:"♦",lang:"⟨",rang:"⟩"}},function(o,s,l){Object.defineProperty(s,"__esModule",{value:!0});var c=l(10),f=l(12),u=l(13),d=(function(){function p(){this.values=[],this.curly=this.paren=-1}return p.prototype.beforeFunctionExpression=function(g){return["(","{","[","in","typeof","instanceof","new","return","case","delete","throw","void","=","+=","-=","*=","**=","/=","%=","<<=",">>=",">>>=","&=","|=","^=",",","+","-","*","**","/","%","++","--","<<",">>",">>>","&","|","^","!","~","&&","||","?",":","===","==",">=","<=","<",">","!=","!=="].indexOf(g)>=0},p.prototype.isRegexStart=function(){var g=this.values[this.values.length-1],m=g!==null;switch(g){case"this":case"]":m=!1;break;case")":var y=this.values[this.paren-1];m=y==="if"||y==="while"||y==="for"||y==="with";break;case"}":if(m=!1,this.values[this.curly-3]==="function")m=!!(v=this.values[this.curly-4])&&!this.beforeFunctionExpression(v);else if(this.values[this.curly-4]==="function"){var v;m=!(v=this.values[this.curly-5])||!this.beforeFunctionExpression(v)}}return m},p.prototype.push=function(g){g.type===7||g.type===4?(g.value==="{"?this.curly=this.values.length:g.value==="("&&(this.paren=this.values.length),this.values.push(g.value)):this.values.push(null)},p})(),h=(function(){function p(g,m){this.errorHandler=new c.ErrorHandler,this.errorHandler.tolerant=!!m&&typeof m.tolerant=="boolean"&&m.tolerant,this.scanner=new f.Scanner(g,this.errorHandler),this.scanner.trackComment=!!m&&typeof m.comment=="boolean"&&m.comment,this.trackRange=!!m&&typeof m.range=="boolean"&&m.range,this.trackLoc=!!m&&typeof m.loc=="boolean"&&m.loc,this.buffer=[],this.reader=new d}return p.prototype.errors=function(){return this.errorHandler.errors},p.prototype.getNextToken=function(){if(this.buffer.length===0){var g=this.scanner.scanComments();if(this.scanner.trackComment)for(var m=0;m<g.length;++m){var y=g[m],v=this.scanner.source.slice(y.slice[0],y.slice[1]),x={type:y.multiLine?"BlockComment":"LineComment",value:v};this.trackRange&&(x.range=y.range),this.trackLoc&&(x.loc=y.loc),this.buffer.push(x)}if(!this.scanner.eof()){var w=void 0;this.trackLoc&&(w={start:{line:this.scanner.lineNumber,column:this.scanner.index-this.scanner.lineStart},end:{}});var S=this.scanner.source[this.scanner.index]==="/"&&this.reader.isRegexStart()?this.scanner.scanRegExp():this.scanner.lex();this.reader.push(S);var T={type:u.TokenName[S.type],value:this.scanner.source.slice(S.start,S.end)};if(this.trackRange&&(T.range=[S.start,S.end]),this.trackLoc&&(w.end={line:this.scanner.lineNumber,column:this.scanner.index-this.scanner.lineStart},T.loc=w),S.type===9){var _=S.pattern,D=S.flags;T.regex={pattern:_,flags:D}}this.buffer.push(T)}}return this.buffer.shift()},p})();s.Tokenizer=h}])},n.exports=a()},function(n,r,i){var a=i(38),o=i(53),s=i(76),l=i(54),c=Object.prototype.toString,f=Object.prototype.hasOwnProperty,u={0:"\\0",7:"\\a",8:"\\b",9:"\\t",10:"\\n",11:"\\v",12:"\\f",13:"\\r",27:"\\e",34:'\\"',92:"\\\\",133:"\\N",160:"\\_",8232:"\\L",8233:"\\P"},d=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"];function h(A){var B,V,$;if(B=A.toString(16).toUpperCase(),A<=255)V="x",$=2;else if(A<=65535)V="u",$=4;else{if(!(A<=4294967295))throw new o("code point within a string may not be greater than 0xFFFFFFFF");V="U",$=8}return"\\"+V+a.repeat("0",$-B.length)+B}function p(A){this.schema=A.schema||s,this.indent=Math.max(1,A.indent||2),this.noArrayIndent=A.noArrayIndent||!1,this.skipInvalid=A.skipInvalid||!1,this.flowLevel=a.isNothing(A.flowLevel)?-1:A.flowLevel,this.styleMap=(function(B,V){var $,U,G,F,J,Q,ne;if(V===null)return{};for($={},G=0,F=(U=Object.keys(V)).length;G<F;G+=1)J=U[G],Q=String(V[J]),J.slice(0,2)==="!!"&&(J="tag:yaml.org,2002:"+J.slice(2)),(ne=B.compiledTypeMap.fallback[J])&&f.call(ne.styleAliases,Q)&&(Q=ne.styleAliases[Q]),$[J]=Q;return $})(this.schema,A.styles||null),this.sortKeys=A.sortKeys||!1,this.lineWidth=A.lineWidth||80,this.noRefs=A.noRefs||!1,this.noCompatMode=A.noCompatMode||!1,this.condenseFlow=A.condenseFlow||!1,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}function g(A,B){for(var V,$=a.repeat(" ",B),U=0,G=-1,F="",J=A.length;U<J;)(G=A.indexOf(`
`,U))===-1?(V=A.slice(U),U=J):(V=A.slice(U,G+1),U=G+1),V.length&&V!==`
`&&(F+=$),F+=V;return F}function m(A,B){return`
`+a.repeat(" ",A.indent*B)}function y(A){return A===32||A===9}function v(A){return 32<=A&&A<=126||161<=A&&A<=55295&&A!==8232&&A!==8233||57344<=A&&A<=65533&&A!==65279||65536<=A&&A<=1114111}function x(A,B){return v(A)&&A!==65279&&A!==44&&A!==91&&A!==93&&A!==123&&A!==125&&A!==58&&(A!==35||B&&(function(V){return v(V)&&!y(V)&&V!==65279&&V!==13&&V!==10})(B))}function w(A){return/^\n* /.test(A)}function S(A,B,V,$,U){var G,F,J,Q,ne=!1,ye=!1,ve=$!==-1,Ce=-1,we=v(Q=A.charCodeAt(0))&&Q!==65279&&!y(Q)&&Q!==45&&Q!==63&&Q!==58&&Q!==44&&Q!==91&&Q!==93&&Q!==123&&Q!==125&&Q!==35&&Q!==38&&Q!==42&&Q!==33&&Q!==124&&Q!==61&&Q!==62&&Q!==39&&Q!==34&&Q!==37&&Q!==64&&Q!==96&&!y(A.charCodeAt(A.length-1));if(B)for(G=0;G<A.length;G++){if(!v(F=A.charCodeAt(G)))return 5;J=G>0?A.charCodeAt(G-1):null,we=we&&x(F,J)}else{for(G=0;G<A.length;G++){if((F=A.charCodeAt(G))===10)ne=!0,ve&&(ye=ye||G-Ce-1>$&&A[Ce+1]!==" ",Ce=G);else if(!v(F))return 5;J=G>0?A.charCodeAt(G-1):null,we=we&&x(F,J)}ye=ye||ve&&G-Ce-1>$&&A[Ce+1]!==" "}return ne||ye?V>9&&w(A)?5:ye?4:3:we&&!U(A)?1:2}function T(A,B,V,$){A.dump=(function(){if(B.length===0)return"''";if(!A.noCompatMode&&d.indexOf(B)!==-1)return"'"+B+"'";var U=A.indent*Math.max(1,V),G=A.lineWidth===-1?-1:Math.max(Math.min(A.lineWidth,40),A.lineWidth-U),F=$||A.flowLevel>-1&&V>=A.flowLevel;switch(S(B,F,A.indent,G,(function(J){return(function(Q,ne){var ye,ve;for(ye=0,ve=Q.implicitTypes.length;ye<ve;ye+=1)if(Q.implicitTypes[ye].resolve(ne))return!0;return!1})(A,J)}))){case 1:return B;case 2:return"'"+B.replace(/'/g,"''")+"'";case 3:return"|"+_(B,A.indent)+D(g(B,U));case 4:return">"+_(B,A.indent)+D(g((function(J,Q){for(var ne,ye,ve=/(\n+)([^\n]*)/g,Ce=(Ae=J.indexOf(`
`),Ae=Ae!==-1?Ae:J.length,ve.lastIndex=Ae,I(J.slice(0,Ae),Q)),we=J[0]===`
`||J[0]===" ",Ae;ye=ve.exec(J);){var Me=ye[1],q=ye[2];ne=q[0]===" ",Ce+=Me+(we||ne||q===""?"":`
`)+I(q,Q),we=ne}return Ce})(B,G),U));case 5:return'"'+(function(J){for(var Q,ne,ye,ve="",Ce=0;Ce<J.length;Ce++)(Q=J.charCodeAt(Ce))>=55296&&Q<=56319&&(ne=J.charCodeAt(Ce+1))>=56320&&ne<=57343?(ve+=h(1024*(Q-55296)+ne-56320+65536),Ce++):(ye=u[Q],ve+=!ye&&v(Q)?J[Ce]:ye||h(Q));return ve})(B)+'"';default:throw new o("impossible error: invalid scalar style")}})()}function _(A,B){var V=w(A)?String(B):"",$=A[A.length-1]===`
`;return V+($&&(A[A.length-2]===`
`||A===`
`)?"+":$?"":"-")+`
`}function D(A){return A[A.length-1]===`
`?A.slice(0,-1):A}function I(A,B){if(A===""||A[0]===" ")return A;for(var V,$,U=/ [^ ]/g,G=0,F=0,J=0,Q="";V=U.exec(A);)(J=V.index)-G>B&&($=F>G?F:J,Q+=`
`+A.slice(G,$),G=$+1),F=J;return Q+=`
`,A.length-G>B&&F>G?Q+=A.slice(G,F)+`
`+A.slice(F+1):Q+=A.slice(G),Q.slice(1)}function R(A,B,V){var $,U,G,F,J,Q;for(G=0,F=(U=V?A.explicitTypes:A.implicitTypes).length;G<F;G+=1)if(((J=U[G]).instanceOf||J.predicate)&&(!J.instanceOf||typeof B=="object"&&B instanceof J.instanceOf)&&(!J.predicate||J.predicate(B))){if(A.tag=V?J.tag:"?",J.represent){if(Q=A.styleMap[J.tag]||J.defaultStyle,c.call(J.represent)==="[object Function]")$=J.represent(B,Q);else{if(!f.call(J.represent,Q))throw new o("!<"+J.tag+'> tag resolver accepts not "'+Q+'" style');$=J.represent[Q](B,Q)}A.dump=$}return!0}return!1}function O(A,B,V,$,U,G){A.tag=null,A.dump=V,R(A,V,!1)||R(A,V,!0);var F=c.call(A.dump);$&&($=A.flowLevel<0||A.flowLevel>B);var J,Q,ne=F==="[object Object]"||F==="[object Array]";if(ne&&(Q=(J=A.duplicates.indexOf(V))!==-1),(A.tag!==null&&A.tag!=="?"||Q||A.indent!==2&&B>0)&&(U=!1),Q&&A.usedDuplicates[J])A.dump="*ref_"+J;else{if(ne&&Q&&!A.usedDuplicates[J]&&(A.usedDuplicates[J]=!0),F==="[object Object]")$&&Object.keys(A.dump).length!==0?((function(ve,Ce,we,Ae){var Me,q,k,Y,X,re,de="",he=ve.tag,Ee=Object.keys(we);if(ve.sortKeys===!0)Ee.sort();else if(typeof ve.sortKeys=="function")Ee.sort(ve.sortKeys);else if(ve.sortKeys)throw new o("sortKeys must be a boolean or a function");for(Me=0,q=Ee.length;Me<q;Me+=1)re="",Ae&&Me===0||(re+=m(ve,Ce)),Y=we[k=Ee[Me]],O(ve,Ce+1,k,!0,!0,!0)&&((X=ve.tag!==null&&ve.tag!=="?"||ve.dump&&ve.dump.length>1024)&&(ve.dump&&ve.dump.charCodeAt(0)===10?re+="?":re+="? "),re+=ve.dump,X&&(re+=m(ve,Ce)),O(ve,Ce+1,Y,!0,X)&&(ve.dump&&ve.dump.charCodeAt(0)===10?re+=":":re+=": ",de+=re+=ve.dump));ve.tag=he,ve.dump=de||"{}"})(A,B,A.dump,U),Q&&(A.dump="&ref_"+J+A.dump)):((function(ve,Ce,we){var Ae,Me,q,k,Y,X="",re=ve.tag,de=Object.keys(we);for(Ae=0,Me=de.length;Ae<Me;Ae+=1)Y="",Ae!==0&&(Y+=", "),ve.condenseFlow&&(Y+='"'),k=we[q=de[Ae]],O(ve,Ce,q,!1,!1)&&(ve.dump.length>1024&&(Y+="? "),Y+=ve.dump+(ve.condenseFlow?'"':"")+":"+(ve.condenseFlow?"":" "),O(ve,Ce,k,!1,!1)&&(X+=Y+=ve.dump));ve.tag=re,ve.dump="{"+X+"}"})(A,B,A.dump),Q&&(A.dump="&ref_"+J+" "+A.dump));else if(F==="[object Array]"){var ye=A.noArrayIndent&&B>0?B-1:B;$&&A.dump.length!==0?((function(ve,Ce,we,Ae){var Me,q,k="",Y=ve.tag;for(Me=0,q=we.length;Me<q;Me+=1)O(ve,Ce+1,we[Me],!0,!0)&&(Ae&&Me===0||(k+=m(ve,Ce)),ve.dump&&ve.dump.charCodeAt(0)===10?k+="-":k+="- ",k+=ve.dump);ve.tag=Y,ve.dump=k||"[]"})(A,ye,A.dump,U),Q&&(A.dump="&ref_"+J+A.dump)):((function(ve,Ce,we){var Ae,Me,q="",k=ve.tag;for(Ae=0,Me=we.length;Ae<Me;Ae+=1)O(ve,Ce,we[Ae],!1,!1)&&(Ae!==0&&(q+=","+(ve.condenseFlow?"":" ")),q+=ve.dump);ve.tag=k,ve.dump="["+q+"]"})(A,ye,A.dump),Q&&(A.dump="&ref_"+J+" "+A.dump))}else{if(F!=="[object String]"){if(A.skipInvalid)return!1;throw new o("unacceptable kind of an object to dump "+F)}A.tag!=="?"&&T(A,A.dump,B,G)}A.tag!==null&&A.tag!=="?"&&(A.dump="!<"+A.tag+"> "+A.dump)}return!0}function P(A,B){var V,$,U=[],G=[];for((function F(J,Q,ne){var ye,ve,Ce;if(J!==null&&typeof J=="object")if((ve=Q.indexOf(J))!==-1)ne.indexOf(ve)===-1&&ne.push(ve);else if(Q.push(J),Array.isArray(J))for(ve=0,Ce=J.length;ve<Ce;ve+=1)F(J[ve],Q,ne);else for(ye=Object.keys(J),ve=0,Ce=ye.length;ve<Ce;ve+=1)F(J[ye[ve]],Q,ne)})(A,U,G),V=0,$=G.length;V<$;V+=1)B.duplicates.push(U[G[V]]);B.usedDuplicates=new Array($)}function N(A,B){var V=new p(B=B||{});return V.noRefs||P(A,V),O(V,0,A,!0,!0)?V.dump+`
`:""}n.exports.dump=N,n.exports.safeDump=function(A,B){return N(A,a.extend({schema:l},B))}},function(n,r,i){i(31),i(32),i(33),i(64),i(19),i(65),i(20),i(68),i(92),i(144),i(22),i(94),i(23);var a,o=this&&this.__extends||(a=function(S,T){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(_,D){_.__proto__=D}||function(_,D){for(var I in D)D.hasOwnProperty(I)&&(_[I]=D[I])})(S,T)},function(S,T){function _(){this.constructor=S}a(S,T),S.prototype=T===null?Object.create(T):(_.prototype=T.prototype,new _)}),s=this&&this.__values||function(S){var T=typeof Symbol=="function"&&Symbol.iterator,_=T&&S[T],D=0;if(_)return _.call(S);if(S&&typeof S.length=="number")return{next:function(){return S&&D>=S.length&&(S=void 0),{value:S&&S[D++],done:!S}}};throw new TypeError(T?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(S,T){var _=typeof Symbol=="function"&&S[Symbol.iterator];if(!_)return S;var D,I,R=_.call(S),O=[];try{for(;(T===void 0||T-- >0)&&!(D=R.next()).done;)O.push(D.value)}catch(P){I={error:P}}finally{try{D&&!D.done&&(_=R.return)&&_.call(R)}finally{if(I)throw I.error}}return O};Object.defineProperty(r,"__esModule",{value:!0});var c=i(91),f=i(1),u=i(183),d=i(0),h=i(7),p=i(95),g=i(69),m=i(3),y=i(305),v=i(306),x=i(307),w=(function(S){function T(_,D){D===void 0&&(D=!1);var I=S.call(this)||this;return I._hasDeclaration=!1,I._docTypeName="",I._hasDocumentElement=!1,I._currentElementSerialized=!1,I._openTags=[],I._ended=!1,I._fragment=D,I._options=f.applyDefaults(_||{},c.DefaultXMLBuilderCBOptions),I._builderOptions={defaultNamespace:I._options.defaultNamespace,namespaceAlias:I._options.namespaceAlias},I._options.format==="json"?I._writer=new v.JSONCBWriter(I._options):I._options.format==="yaml"?I._writer=new x.YAMLCBWriter(I._options):I._writer=new y.XMLCBWriter(I._options),I._options.data!==void 0&&I.on("data",I._options.data),I._options.end!==void 0&&I.on("end",I._options.end),I._options.error!==void 0&&I.on("error",I._options.error),I._prefixMap=new p.NamespacePrefixMap,I._prefixMap.set("xml",h.namespace.XML),I._prefixIndex={value:1},I._push(I._writer.frontMatter()),I}return o(T,S),T.prototype.ele=function(_,D,I){var R,O;if(f.isObject(_)||f.isString(_)&&(/^\s*</.test(_)||/^\s*[\{\[]/.test(_)||/^(\s*|(#.*)|(%.*))*---/.test(_))){var P=u.fragment().set(this._options);try{P.ele(_)}catch(V){return this.emit("error",V),this}try{for(var N=s(P.node.childNodes),A=N.next();!A.done;A=N.next()){var B=A.value;this._fromNode(B)}}catch(V){R={error:V}}finally{try{A&&!A.done&&(O=N.return)&&O.call(N)}finally{if(R)throw R.error}}return this}if(this._serializeOpenTag(!0),!this._fragment&&this._hasDocumentElement&&this._writer.level===0)return this.emit("error",new Error("Document cannot have multiple document element nodes.")),this;try{this._currentElement=u.fragment(this._builderOptions).ele(_,D,I)}catch(V){return this.emit("error",V),this}return this._fragment||this._hasDocumentElement||this._docTypeName===""||this._currentElement.node._qualifiedName===this._docTypeName?(this._currentElementSerialized=!1,this._fragment||(this._hasDocumentElement=!0),this):(this.emit("error",new Error("Document element name does not match DocType declaration name.")),this)},T.prototype.att=function(_,D,I){if(this._currentElement===void 0)return this.emit("error",new Error("Cannot insert an attribute node as child of a document node.")),this;try{this._currentElement.att(_,D,I)}catch(R){return this.emit("error",R),this}return this},T.prototype.com=function(_){var D;this._serializeOpenTag(!0);try{D=u.fragment(this._builderOptions).com(_).first().node}catch(I){return this.emit("error",I),this}return!this._options.wellFormed||d.xml_isLegalChar(D.data)&&D.data.indexOf("--")===-1&&!D.data.endsWith("-")?(this._push(this._writer.comment(D.data)),this):(this.emit("error",new Error("Comment data contains invalid characters (well-formed required).")),this)},T.prototype.txt=function(_){if(!this._fragment&&this._currentElement===void 0)return this.emit("error",new Error("Cannot insert a text node as child of a document node.")),this;var D;this._serializeOpenTag(!0);try{D=u.fragment(this._builderOptions).txt(_).first().node}catch(R){return this.emit("error",R),this}if(this._options.wellFormed&&!d.xml_isLegalChar(D.data))return this.emit("error",new Error("Text data contains invalid characters (well-formed required).")),this;var I=D.data.replace(/(?!&(lt|gt|amp|apos|quot);)&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");return this._push(this._writer.text(I)),this},T.prototype.ins=function(_,D){var I;D===void 0&&(D=""),this._serializeOpenTag(!0);try{I=u.fragment(this._builderOptions).ins(_,D).first().node}catch(R){return this.emit("error",R),this}return this._options.wellFormed&&(I.target.indexOf(":")!==-1||/^xml$/i.test(I.target))?(this.emit("error",new Error("Processing instruction target contains invalid characters (well-formed required).")),this):this._options.wellFormed&&!d.xml_isLegalChar(I.data)?(this.emit("error",Error("Processing instruction data contains invalid characters (well-formed required).")),this):(this._push(this._writer.instruction(I.target,I.data)),this)},T.prototype.dat=function(_){var D;this._serializeOpenTag(!0);try{D=u.fragment(this._builderOptions).dat(_).first().node}catch(I){return this.emit("error",I),this}return this._push(this._writer.cdata(D.data)),this},T.prototype.dec=function(_){return _===void 0&&(_={version:"1.0"}),this._fragment?(this.emit("error",Error("Cannot insert an XML declaration into a document fragment.")),this):this._hasDeclaration?(this.emit("error",Error("XML declaration is already inserted.")),this):(this._push(this._writer.declaration(_.version||"1.0",_.encoding,_.standalone)),this._hasDeclaration=!0,this)},T.prototype.dtd=function(_){if(this._fragment)return this.emit("error",Error("Cannot insert a DocType declaration into a document fragment.")),this;if(this._docTypeName!=="")return this.emit("error",new Error("DocType declaration is already inserted.")),this;if(this._hasDocumentElement)return this.emit("error",new Error("Cannot insert DocType declaration after document element.")),this;var D;try{D=u.create().dtd(_).first().node}catch(I){return this.emit("error",I),this}return this._options.wellFormed&&!d.xml_isPubidChar(D.publicId)?(this.emit("error",new Error("DocType public identifier does not match PubidChar construct (well-formed required).")),this):this._options.wellFormed&&(!d.xml_isLegalChar(D.systemId)||D.systemId.indexOf('"')!==-1&&D.systemId.indexOf("'")!==-1)?(this.emit("error",new Error("DocType system identifier contains invalid characters (well-formed required).")),this):(this._docTypeName=_.name,this._push(this._writer.docType(_.name,D.publicId,D.systemId)),this)},T.prototype.import=function(_){var D,I,R=u.fragment().set(this._options);try{R.import(_)}catch(A){return this.emit("error",A),this}try{for(var O=s(R.node.childNodes),P=O.next();!P.done;P=O.next()){var N=P.value;this._fromNode(N)}}catch(A){D={error:A}}finally{try{P&&!P.done&&(I=O.return)&&I.call(O)}finally{if(D)throw D.error}}return this},T.prototype.up=function(){return this._serializeOpenTag(!1),this._serializeCloseTag(),this},T.prototype.end=function(){for(this._serializeOpenTag(!1);this._openTags.length>0;)this._serializeCloseTag();return this._push(null),this},T.prototype._serializeOpenTag=function(_){if(!this._currentElementSerialized&&this._currentElement!==void 0){var D=this._currentElement.node;if(!this._options.wellFormed||D.localName.indexOf(":")===-1&&d.xml_isName(D.localName)){var I="",R=!1,O=this._prefixMap.copy(),P={},N=this._recordNamespaceInformation(D,O,P),A=this._openTags.length===0?null:this._openTags[this._openTags.length-1][1],B=D.namespaceURI;if(B===null&&(B=A),A===B)N!==null&&(R=!0),I=B===h.namespace.XML?"xml:"+D.localName:D.localName,this._writer.beginElement(I),this._push(this._writer.openTagBegin(I));else{var V=D.prefix,$=null;if(V===null&&B===N||($=O.get(V,B)),V==="xmlns"){if(this._options.wellFormed)return void this.emit("error",new Error("An element cannot have the 'xmlns' prefix (well-formed required)."));$=V}$!==null?(I=$+":"+D.localName,N!==null&&N!==h.namespace.XML&&(A=N||null),this._writer.beginElement(I),this._push(this._writer.openTagBegin(I))):V!==null?(V in P&&(V=this._generatePrefix(B,O,this._prefixIndex)),O.set(V,B),I+=V+":"+D.localName,this._writer.beginElement(I),this._push(this._writer.openTagBegin(I)),this._push(this._writer.attribute("xmlns:"+V,this._serializeAttributeValue(B,this._options.wellFormed))),N!==null&&(A=N||null)):N===null||N!==null&&N!==B?(R=!0,I+=D.localName,A=B,this._writer.beginElement(I),this._push(this._writer.openTagBegin(I)),this._push(this._writer.attribute("xmlns",this._serializeAttributeValue(B,this._options.wellFormed)))):(I+=D.localName,A=B,this._writer.beginElement(I),this._push(this._writer.openTagBegin(I)))}this._serializeAttributes(D,O,this._prefixIndex,P,R,this._options.wellFormed);var U=B===h.namespace.HTML;U&&!_&&T._VoidElementNames.has(D.localName)?(this._push(this._writer.openTagEnd(I,!0,!0)),this._writer.endElement(I)):U||_?this._push(this._writer.openTagEnd(I,!1,!1)):(this._push(this._writer.openTagEnd(I,!0,!1)),this._writer.endElement(I)),this._currentElementSerialized=!0,this._openTags.push([I,A,this._prefixMap,_]),this._isPrefixMapModified(this._prefixMap,O)&&(this._prefixMap=O),this._writer.level++}else this.emit("error",new Error("Node local name contains invalid characters (well-formed required)."))}},T.prototype._serializeCloseTag=function(){this._writer.level--;var _=this._openTags.pop();if(_!==void 0){var D=l(_,4),I=D[0],R=(D[1],D[2]),O=D[3];this._prefixMap=R,O&&(this._push(this._writer.closeTag(I)),this._writer.endElement(I))}else this.emit("error",new Error("Last element is undefined."))},T.prototype._push=function(_){_===null?(this._ended=!0,this.emit("end")):this._ended?this.emit("error",new Error("Cannot push to ended stream.")):_.length!==0&&(this._writer.hasData=!0,this.emit("data",_,this._writer.level))},T.prototype._fromNode=function(_){var D,I,R,O;if(m.Guard.isElementNode(_)){var P=_.prefix?_.prefix+":"+_.localName:_.localName;_.namespaceURI!==null?this.ele(_.namespaceURI,P):this.ele(P);try{for(var N=s(_.attributes),A=N.next();!A.done;A=N.next()){var B=A.value,V=B.prefix?B.prefix+":"+B.localName:B.localName;B.namespaceURI!==null?this.att(B.namespaceURI,V,B.value):this.att(V,B.value)}}catch(F){D={error:F}}finally{try{A&&!A.done&&(I=N.return)&&I.call(N)}finally{if(D)throw D.error}}try{for(var $=s(_.childNodes),U=$.next();!U.done;U=$.next()){var G=U.value;this._fromNode(G)}}catch(F){R={error:F}}finally{try{U&&!U.done&&(O=$.return)&&O.call($)}finally{if(R)throw R.error}}this.up()}else m.Guard.isExclusiveTextNode(_)&&_.data?this.txt(_.data):m.Guard.isCommentNode(_)?this.com(_.data):m.Guard.isCDATASectionNode(_)?this.dat(_.data):m.Guard.isProcessingInstructionNode(_)&&this.ins(_.target,_.data)},T.prototype._serializeAttributes=function(_,D,I,R,O,P){var N,A,B=P?new g.LocalNameSet:void 0;try{for(var V=s(_.attributes),$=V.next();!$.done;$=V.next()){var U=$.value;if(P||O||U.namespaceURI!==null){if(P&&B&&B.has(U.namespaceURI,U.localName))return void this.emit("error",new Error("Element contains duplicate attributes (well-formed required)."));P&&B&&B.set(U.namespaceURI,U.localName);var G=U.namespaceURI,F=null;if(G!==null)if(F=D.get(U.prefix,G),G===h.namespace.XMLNS){if(U.value===h.namespace.XML||U.prefix===null&&O||U.prefix!==null&&(!(U.localName in R)||R[U.localName]!==U.value)&&D.has(U.localName,U.value))continue;if(P&&U.value===h.namespace.XMLNS)return void this.emit("error",new Error("XMLNS namespace is reserved (well-formed required)."));if(P&&U.value==="")return void this.emit("error",new Error("Namespace prefix declarations cannot be used to undeclare a namespace (well-formed required)."));U.prefix==="xmlns"&&(F="xmlns")}else F===null&&(F=U.prefix===null||D.hasPrefix(U.prefix)&&!D.has(U.prefix,G)?this._generatePrefix(G,D,I):U.prefix,this._push(this._writer.attribute("xmlns:"+F,this._serializeAttributeValue(G,this._options.wellFormed))));if(P&&(U.localName.indexOf(":")!==-1||!d.xml_isName(U.localName)||U.localName==="xmlns"&&G===null))return void this.emit("error",new Error("Attribute local name contains invalid characters (well-formed required)."));this._push(this._writer.attribute((F!==null?F+":":"")+U.localName,this._serializeAttributeValue(U.value,this._options.wellFormed)))}else this._push(this._writer.attribute(U.localName,this._serializeAttributeValue(U.value,this._options.wellFormed)))}}catch(J){N={error:J}}finally{try{$&&!$.done&&(A=V.return)&&A.call(V)}finally{if(N)throw N.error}}},T.prototype._serializeAttributeValue=function(_,D){return D&&_!==null&&!d.xml_isLegalChar(_)?(this.emit("error",new Error("Invalid characters in attribute value.")),""):_===null?"":_.replace(/(?!&(lt|gt|amp|apos|quot);)&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},T.prototype._recordNamespaceInformation=function(_,D,I){var R,O,P=null;try{for(var N=s(_.attributes),A=N.next();!A.done;A=N.next()){var B=A.value,V=B.namespaceURI,$=B.prefix;if(V===h.namespace.XMLNS){if($===null){P=B.value;continue}var U=B.localName,G=B.value;if(G===h.namespace.XML||(G===""&&(G=null),D.has(U,G)))continue;D.set(U,G),I[U]=G||""}}}catch(F){R={error:F}}finally{try{A&&!A.done&&(O=N.return)&&O.call(N)}finally{if(R)throw R.error}}return P},T.prototype._generatePrefix=function(_,D,I){var R="ns"+I.value;return I.value++,D.set(R,_),R},T.prototype._isPrefixMapModified=function(_,D){var I=_._items,R=D._items,O=_._nullItems,P=D._nullItems;for(var N in R){var A=I[N];if(A===void 0)return!0;var B=R[N];if(A.length!==B.length)return!0;for(var V=0;V<A.length;V++)if(A[V]!==B[V])return!0}if(O.length!==P.length)return!0;for(V=0;V<O.length;V++)if(O[V]!==P[V])return!0;return!1},T._VoidElementNames=new Set(["area","base","basefont","bgsound","br","col","embed","frame","hr","img","input","keygen","link","menuitem","meta","param","source","track","wbr"]),T})(i(308).EventEmitter);r.XMLBuilderCBImpl=w},function(n,r,i){i(74);var a,o=this&&this.__extends||(a=function(l,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,u){f.__proto__=u}||function(f,u){for(var d in u)u.hasOwnProperty(d)&&(f[d]=u[d])})(l,c)},function(l,c){function f(){this.constructor=l}a(l,c),l.prototype=c===null?Object.create(c):(f.prototype=c.prototype,new f)});Object.defineProperty(r,"__esModule",{value:!0});var s=(function(l){function c(f){var u=l.call(this,f)||this;return u._lineLength=0,u}return o(c,l),c.prototype.frontMatter=function(){return""},c.prototype.declaration=function(f,u,d){var h=this._beginLine()+"<?xml";return h+=' version="'+f+'"',u!==void 0&&(h+=' encoding="'+u+'"'),d!==void 0&&(h+=' standalone="'+(d?"yes":"no")+'"'),h+="?>"},c.prototype.docType=function(f,u,d){var h=this._beginLine();return h+=u&&d?"<!DOCTYPE "+f+' PUBLIC "'+u+'" "'+d+'">':u?"<!DOCTYPE "+f+' PUBLIC "'+u+'">':d?"<!DOCTYPE "+f+' SYSTEM "'+d+'">':"<!DOCTYPE "+f+">"},c.prototype.comment=function(f){return this._beginLine()+"<!--"+f+"-->"},c.prototype.text=function(f){return this._beginLine()+f},c.prototype.instruction=function(f,u){return u?this._beginLine()+"<?"+f+" "+u+"?>":this._beginLine()+"<?"+f+"?>"},c.prototype.cdata=function(f){return this._beginLine()+"<![CDATA["+f+"]]>"},c.prototype.openTagBegin=function(f){return this._lineLength+=1+f.length,this._beginLine()+"<"+f},c.prototype.openTagEnd=function(f,u,d){return d?" />":u?this._writerOptions.allowEmptyTags?"></"+f+">":this._writerOptions.spaceBeforeSlash?" />":"/>":">"},c.prototype.closeTag=function(f){return this._beginLine()+"</"+f+">"},c.prototype.attribute=function(f,u){var d=f+'="'+u+'"';return this._writerOptions.prettyPrint&&this._writerOptions.width>0&&this._lineLength+1+d.length>this._writerOptions.width?(d=this._beginLine()+this._indent(1)+d,this._lineLength=d.length,d):(this._lineLength+=1+d.length," "+d)},c.prototype.beginElement=function(f){},c.prototype.endElement=function(f){},c.prototype._beginLine=function(){if(this._writerOptions.prettyPrint){var f=(this.hasData?this._writerOptions.newline:"")+this._indent(this._writerOptions.offset+this.level);return this._lineLength=f.length,f}return""},c.prototype._indent=function(f){return f<=0?"":this._writerOptions.indent.repeat(f)},c})(i(114).BaseCBWriter);r.XMLCBWriter=s},function(n,r,i){i(74);var a,o=this&&this.__extends||(a=function(l,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,u){f.__proto__=u}||function(f,u){for(var d in u)u.hasOwnProperty(d)&&(f[d]=u[d])})(l,c)},function(l,c){function f(){this.constructor=l}a(l,c),l.prototype=c===null?Object.create(c):(f.prototype=c.prototype,new f)});Object.defineProperty(r,"__esModule",{value:!0});var s=(function(l){function c(f){var u=l.call(this,f)||this;return u._hasChildren=[],u._additionalLevel=0,u}return o(c,l),c.prototype.frontMatter=function(){return""},c.prototype.declaration=function(f,u,d){return""},c.prototype.docType=function(f,u,d){return""},c.prototype.comment=function(f){return this._comma()+this._beginLine()+"{"+this._sep()+this._key(this._builderOptions.convert.comment)+this._sep()+this._val(f)+this._sep()+"}"},c.prototype.text=function(f){return this._comma()+this._beginLine()+"{"+this._sep()+this._key(this._builderOptions.convert.text)+this._sep()+this._val(f)+this._sep()+"}"},c.prototype.instruction=function(f,u){return this._comma()+this._beginLine()+"{"+this._sep()+this._key(this._builderOptions.convert.ins)+this._sep()+this._val(u?f+" "+u:f)+this._sep()+"}"},c.prototype.cdata=function(f){return this._comma()+this._beginLine()+"{"+this._sep()+this._key(this._builderOptions.convert.cdata)+this._sep()+this._val(f)+this._sep()+"}"},c.prototype.attribute=function(f,u){return this._comma()+this._beginLine(1)+"{"+this._sep()+this._key(this._builderOptions.convert.att+f)+this._sep()+this._val(u)+this._sep()+"}"},c.prototype.openTagBegin=function(f){var u=this._comma()+this._beginLine()+"{"+this._sep()+this._key(f)+this._sep()+"{";return this._additionalLevel++,this.hasData=!0,u+=this._beginLine()+this._key(this._builderOptions.convert.text)+this._sep()+"[",this._hasChildren.push(!1),u},c.prototype.openTagEnd=function(f,u,d){if(u){var h=this._sep()+"]";return this._additionalLevel--,h+=this._beginLine()+"}"+this._sep()+"}"}return""},c.prototype.closeTag=function(f){var u=this._beginLine()+"]";return this._additionalLevel--,u+=this._beginLine()+"}"+this._sep()+"}"},c.prototype.beginElement=function(f){},c.prototype.endElement=function(f){this._hasChildren.pop()},c.prototype._beginLine=function(f){return f===void 0&&(f=0),this._writerOptions.prettyPrint?(this.hasData?this._writerOptions.newline:"")+this._indent(this._writerOptions.offset+this.level+f):""},c.prototype._indent=function(f){return f+this._additionalLevel<=0?"":this._writerOptions.indent.repeat(f+this._additionalLevel)},c.prototype._comma=function(){var f=this._hasChildren[this._hasChildren.length-1]?",":"";return this._hasChildren.length>0&&(this._hasChildren[this._hasChildren.length-1]=!0),f},c.prototype._sep=function(){return this._writerOptions.prettyPrint?" ":""},c.prototype._key=function(f){return'"'+f+'":'},c.prototype._val=function(f){return JSON.stringify(f)},c})(i(114).BaseCBWriter);r.JSONCBWriter=s},function(n,r,i){i(74);var a,o=this&&this.__extends||(a=function(l,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,u){f.__proto__=u}||function(f,u){for(var d in u)u.hasOwnProperty(d)&&(f[d]=u[d])})(l,c)},function(l,c){function f(){this.constructor=l}a(l,c),l.prototype=c===null?Object.create(c):(f.prototype=c.prototype,new f)});Object.defineProperty(r,"__esModule",{value:!0});var s=(function(l){function c(f){var u=l.call(this,f)||this;if(u._rootWritten=!1,u._additionalLevel=0,f.indent.length<2)throw new Error("YAML indententation string must be at least two characters long.");if(f.offset<0)throw new Error("YAML offset should be zero or a positive number.");return u}return o(c,l),c.prototype.frontMatter=function(){return this._beginLine()+"---"},c.prototype.declaration=function(f,u,d){return""},c.prototype.docType=function(f,u,d){return""},c.prototype.comment=function(f){return this._beginLine()+this._key(this._builderOptions.convert.comment)+" "+this._val(f)},c.prototype.text=function(f){return this._beginLine()+this._key(this._builderOptions.convert.text)+" "+this._val(f)},c.prototype.instruction=function(f,u){return this._beginLine()+this._key(this._builderOptions.convert.ins)+" "+this._val(u?f+" "+u:f)},c.prototype.cdata=function(f){return this._beginLine()+this._key(this._builderOptions.convert.cdata)+" "+this._val(f)},c.prototype.attribute=function(f,u){this._additionalLevel++;var d=this._beginLine()+this._key(this._builderOptions.convert.att+f)+" "+this._val(u);return this._additionalLevel--,d},c.prototype.openTagBegin=function(f){var u=this._beginLine()+this._key(f);return this._rootWritten||(this._rootWritten=!0),this.hasData=!0,this._additionalLevel++,u+=this._beginLine(!0)+this._key(this._builderOptions.convert.text)},c.prototype.openTagEnd=function(f,u,d){return u?" "+this._val(""):""},c.prototype.closeTag=function(f){return this._additionalLevel--,""},c.prototype.beginElement=function(f){},c.prototype.endElement=function(f){},c.prototype._beginLine=function(f){return f===void 0&&(f=!1),(this.hasData?this._writerOptions.newline:"")+this._indent(this._writerOptions.offset+this.level,f)},c.prototype._indent=function(f,u){if(f+this._additionalLevel<=0)return"";var d=this._writerOptions.indent.repeat(f+this._additionalLevel);return!u&&this._rootWritten?d.substr(0,d.length-2)+"-"+d.substr(-1,1):d},c.prototype._key=function(f){return'"'+f+'":'},c.prototype._val=function(f){return JSON.stringify(f)},c})(i(114).BaseCBWriter);r.YAMLCBWriter=s},function(n,r,i){var a,o=typeof Reflect=="object"?Reflect:null,s=o&&typeof o.apply=="function"?o.apply:function(x,w,S){return Function.prototype.apply.call(x,w,S)};a=o&&typeof o.ownKeys=="function"?o.ownKeys:Object.getOwnPropertySymbols?function(x){return Object.getOwnPropertyNames(x).concat(Object.getOwnPropertySymbols(x))}:function(x){return Object.getOwnPropertyNames(x)};var l=Number.isNaN||function(x){return x!=x};function c(){c.init.call(this)}n.exports=c,c.EventEmitter=c,c.prototype._events=void 0,c.prototype._eventsCount=0,c.prototype._maxListeners=void 0;var f=10;function u(x){if(typeof x!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof x)}function d(x){return x._maxListeners===void 0?c.defaultMaxListeners:x._maxListeners}function h(x,w,S,T){var _,D,I,R;if(u(S),(D=x._events)===void 0?(D=x._events=Object.create(null),x._eventsCount=0):(D.newListener!==void 0&&(x.emit("newListener",w,S.listener?S.listener:S),D=x._events),I=D[w]),I===void 0)I=D[w]=S,++x._eventsCount;else if(typeof I=="function"?I=D[w]=T?[S,I]:[I,S]:T?I.unshift(S):I.push(S),(_=d(x))>0&&I.length>_&&!I.warned){I.warned=!0;var O=new Error("Possible EventEmitter memory leak detected. "+I.length+" "+String(w)+" listeners added. Use emitter.setMaxListeners() to increase limit");O.name="MaxListenersExceededWarning",O.emitter=x,O.type=w,O.count=I.length,R=O,console&&console.warn&&console.warn(R)}return x}function p(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function g(x,w,S){var T={fired:!1,wrapFn:void 0,target:x,type:w,listener:S},_=p.bind(T);return _.listener=S,T.wrapFn=_,_}function m(x,w,S){var T=x._events;if(T===void 0)return[];var _=T[w];return _===void 0?[]:typeof _=="function"?S?[_.listener||_]:[_]:S?(function(D){for(var I=new Array(D.length),R=0;R<I.length;++R)I[R]=D[R].listener||D[R];return I})(_):v(_,_.length)}function y(x){var w=this._events;if(w!==void 0){var S=w[x];if(typeof S=="function")return 1;if(S!==void 0)return S.length}return 0}function v(x,w){for(var S=new Array(w),T=0;T<w;++T)S[T]=x[T];return S}Object.defineProperty(c,"defaultMaxListeners",{enumerable:!0,get:function(){return f},set:function(x){if(typeof x!="number"||x<0||l(x))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+x+".");f=x}}),c.init=function(){this._events!==void 0&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},c.prototype.setMaxListeners=function(x){if(typeof x!="number"||x<0||l(x))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+x+".");return this._maxListeners=x,this},c.prototype.getMaxListeners=function(){return d(this)},c.prototype.emit=function(x){for(var w=[],S=1;S<arguments.length;S++)w.push(arguments[S]);var T=x==="error",_=this._events;if(_!==void 0)T=T&&_.error===void 0;else if(!T)return!1;if(T){var D;if(w.length>0&&(D=w[0]),D instanceof Error)throw D;var I=new Error("Unhandled error."+(D?" ("+D.message+")":""));throw I.context=D,I}var R=_[x];if(R===void 0)return!1;if(typeof R=="function")s(R,this,w);else{var O=R.length,P=v(R,O);for(S=0;S<O;++S)s(P[S],this,w)}return!0},c.prototype.addListener=function(x,w){return h(this,x,w,!1)},c.prototype.on=c.prototype.addListener,c.prototype.prependListener=function(x,w){return h(this,x,w,!0)},c.prototype.once=function(x,w){return u(w),this.on(x,g(this,x,w)),this},c.prototype.prependOnceListener=function(x,w){return u(w),this.prependListener(x,g(this,x,w)),this},c.prototype.removeListener=function(x,w){var S,T,_,D,I;if(u(w),(T=this._events)===void 0)return this;if((S=T[x])===void 0)return this;if(S===w||S.listener===w)--this._eventsCount==0?this._events=Object.create(null):(delete T[x],T.removeListener&&this.emit("removeListener",x,S.listener||w));else if(typeof S!="function"){for(_=-1,D=S.length-1;D>=0;D--)if(S[D]===w||S[D].listener===w){I=S[D].listener,_=D;break}if(_<0)return this;_===0?S.shift():(function(R,O){for(;O+1<R.length;O++)R[O]=R[O+1];R.pop()})(S,_),S.length===1&&(T[x]=S[0]),T.removeListener!==void 0&&this.emit("removeListener",x,I||w)}return this},c.prototype.off=c.prototype.removeListener,c.prototype.removeAllListeners=function(x){var w,S,T;if((S=this._events)===void 0)return this;if(S.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):S[x]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete S[x]),this;if(arguments.length===0){var _,D=Object.keys(S);for(T=0;T<D.length;++T)(_=D[T])!=="removeListener"&&this.removeAllListeners(_);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(typeof(w=S[x])=="function")this.removeListener(x,w);else if(w!==void 0)for(T=w.length-1;T>=0;T--)this.removeListener(x,w[T]);return this},c.prototype.listeners=function(x){return m(this,x,!0)},c.prototype.rawListeners=function(x){return m(this,x,!1)},c.listenerCount=function(x,w){return typeof x.listenerCount=="function"?x.listenerCount(w):y.call(x,w)},c.prototype.listenerCount=y,c.prototype.eventNames=function(){return this._eventsCount>0?a(this._events):[]}},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(77);r.createCB=function(o){return new a.XMLBuilderCBImpl(o)},r.fragmentCB=function(o){return new a.XMLBuilderCBImpl(o,!0)}}])}))})(lw)),lw.exports}var wMe=bMe(),Qs=Uint8Array,ph=Uint16Array,VQ=Uint32Array,FQ=new Qs([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),UQ=new Qs([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),CMe=new Qs([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),BQ=function(t,e){for(var n=new ph(31),r=0;r<31;++r)n[r]=e+=1<<t[r-1];for(var i=new VQ(n[30]),r=1;r<30;++r)for(var a=n[r];a<n[r+1];++a)i[a]=a-n[r]<<5|r;return[n,i]},$Q=BQ(FQ,2),GQ=$Q[0],SMe=$Q[1];GQ[28]=258,SMe[258]=28;var TMe=BQ(UQ,0),EMe=TMe[0],q_=new ph(32768);for(var pi=0;pi<32768;++pi){var bd=(pi&43690)>>>1|(pi&21845)<<1;bd=(bd&52428)>>>2|(bd&13107)<<2,bd=(bd&61680)>>>4|(bd&3855)<<4,q_[pi]=((bd&65280)>>>8|(bd&255)<<8)>>>1}var l2=(function(t,e,n){for(var r=t.length,i=0,a=new ph(e);i<r;++i)t[i]&&++a[t[i]-1];var o=new ph(e);for(i=0;i<e;++i)o[i]=o[i-1]+a[i-1]<<1;var s;if(n){s=new ph(1<<e);var l=15-e;for(i=0;i<r;++i)if(t[i])for(var c=i<<4|t[i],f=e-t[i],u=o[t[i]-1]++<<f,d=u|(1<<f)-1;u<=d;++u)s[q_[u]>>>l]=c}else for(s=new ph(r),i=0;i<r;++i)t[i]&&(s[i]=q_[o[t[i]-1]++]>>>15-t[i]);return s}),By=new Qs(288);for(var pi=0;pi<144;++pi)By[pi]=8;for(var pi=144;pi<256;++pi)By[pi]=9;for(var pi=256;pi<280;++pi)By[pi]=7;for(var pi=280;pi<288;++pi)By[pi]=8;var jQ=new Qs(32);for(var pi=0;pi<32;++pi)jQ[pi]=5;var _Me=l2(By,9,1),DMe=l2(jQ,5,1),u8=function(t){for(var e=t[0],n=1;n<t.length;++n)t[n]>e&&(e=t[n]);return e},ac=function(t,e,n){var r=e/8|0;return(t[r]|t[r+1]<<8)>>(e&7)&n},f8=function(t,e){var n=e/8|0;return(t[n]|t[n+1]<<8|t[n+2]<<16)>>(e&7)},OMe=function(t){return(t+7)/8|0},MMe=function(t,e,n){(n==null||n>t.length)&&(n=t.length);var r=new(t.BYTES_PER_ELEMENT==2?ph:t.BYTES_PER_ELEMENT==4?VQ:Qs)(n-e);return r.set(t.subarray(e,n)),r},IMe=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],hc=function(t,e,n){var r=new Error(e||IMe[t]);if(r.code=t,Error.captureStackTrace&&Error.captureStackTrace(r,hc),!n)throw r;return r},hO=function(t,e,n){var r=t.length;if(!r||n&&n.f&&!n.l)return e||new Qs(0);var i=!e||n,a=!n||n.i;n||(n={}),e||(e=new Qs(r*3));var o=function(Ce){var we=e.length;if(Ce>we){var Ae=new Qs(Math.max(we*2,Ce));Ae.set(e),e=Ae}},s=n.f||0,l=n.p||0,c=n.b||0,f=n.l,u=n.d,d=n.m,h=n.n,p=r*8;do{if(!f){s=ac(t,l,1);var g=ac(t,l+1,3);if(l+=3,g)if(g==1)f=_Me,u=DMe,d=9,h=5;else if(g==2){var x=ac(t,l,31)+257,w=ac(t,l+10,15)+4,S=x+ac(t,l+5,31)+1;l+=14;for(var T=new Qs(S),_=new Qs(19),D=0;D<w;++D)_[CMe[D]]=ac(t,l+D*3,7);l+=w*3;for(var I=u8(_),R=(1<<I)-1,O=l2(_,I,1),D=0;D<S;){var P=O[ac(t,l,R)];l+=P&15;var m=P>>>4;if(m<16)T[D++]=m;else{var N=0,A=0;for(m==16?(A=3+ac(t,l,3),l+=2,N=T[D-1]):m==17?(A=3+ac(t,l,7),l+=3):m==18&&(A=11+ac(t,l,127),l+=7);A--;)T[D++]=N}}var B=T.subarray(0,x),V=T.subarray(x);d=u8(B),h=u8(V),f=l2(B,d,1),u=l2(V,h,1)}else hc(1);else{var m=OMe(l)+4,y=t[m-4]|t[m-3]<<8,v=m+y;if(v>r){a&&hc(0);break}i&&o(c+y),e.set(t.subarray(m,v),c),n.b=c+=y,n.p=l=v*8,n.f=s;continue}if(l>p){a&&hc(0);break}}i&&o(c+131072);for(var $=(1<<d)-1,U=(1<<h)-1,G=l;;G=l){var N=f[f8(t,l)&$],F=N>>>4;if(l+=N&15,l>p){a&&hc(0);break}if(N||hc(2),F<256)e[c++]=F;else if(F==256){G=l,f=null;break}else{var J=F-254;if(F>264){var D=F-257,Q=FQ[D];J=ac(t,l,(1<<Q)-1)+GQ[D],l+=Q}var ne=u[f8(t,l)&U],ye=ne>>>4;ne||hc(3),l+=ne&15;var V=EMe[ye];if(ye>3){var Q=UQ[ye];V+=f8(t,l)&(1<<Q)-1,l+=Q}if(l>p){a&&hc(0);break}i&&o(c+131072);for(var ve=c+J;c<ve;c+=4)e[c]=e[c-V],e[c+1]=e[c+1-V],e[c+2]=e[c+2-V],e[c+3]=e[c+3-V];c=ve}}n.l=f,n.p=G,n.b=c,n.f=s,f&&(s=1,n.m=d,n.d=u,n.n=h)}while(!s);return c==e.length?e:MMe(e,0,c)},RMe=new Qs(0),PMe=function(t){(t[0]!=31||t[1]!=139||t[2]!=8)&&hc(6,"invalid gzip data");var e=t[3],n=10;e&4&&(n+=t[10]|(t[11]<<8)+2);for(var r=(e>>3&1)+(e>>4&1);r>0;r-=!t[n++]);return n+(e&2)},AMe=function(t){var e=t.length;return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0},NMe=function(t){((t[0]&15)!=8||t[0]>>>4>7||(t[0]<<8|t[1])%31)&&hc(6,"invalid zlib data"),t[1]&32&&hc(6,"invalid zlib data: preset dictionaries not supported")};function LMe(t,e){return hO(t,e)}function kMe(t,e){return hO(t.subarray(PMe(t),-8),new Qs(AMe(t)))}function VMe(t,e){return hO((NMe(t),t.subarray(2,-4)),e)}function FMe(t,e){return t[0]==31&&t[1]==139&&t[2]==8?kMe(t):(t[0]&15)!=8||t[0]>>4>7||(t[0]<<8|t[1])%31?LMe(t,e):VMe(t,e)}var UMe=typeof TextDecoder<"u"&&new TextDecoder,BMe=0;try{UMe.decode(RMe,{stream:!0}),BMe=1}catch{}const Xs=[];Xs[45]=62;Xs[95]=63;const ug="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(let t=0;t<ug.length;t++)Xs[ug.charCodeAt(t)]=t;function Yc(t){return Xs[t.charCodeAt(0)]!==void 0}function $Me(t){const e=t.length,n=[];let r=null;for(let i=0;i<e;i++)Yc(t[i])?(r||(r={start:i,count:0}),r.count++,r.end=i):t[i]==="="&&r&&(n.push(r),r=null);return r&&n.push(r),n}function GMe(t,e,n,r){const{start:i,count:a}=e,o=a%4,s=Math.floor(a/4);let l=i,c=null,f=n;for(let u=0;u<s;u++){for(;!Yc(t[l]);)l++;for(c=Xs[t.charCodeAt(l++)]<<18;!Yc(t[l]);)l++;for(c|=Xs[t.charCodeAt(l++)]<<12;!Yc(t[l]);)l++;for(c|=Xs[t.charCodeAt(l++)]<<6;!Yc(t[l]);)l++;c|=Xs[t.charCodeAt(l++)],r[f++]=c>>16&255,r[f++]=c>>8&255,r[f++]=c&255}switch(o){case 3:for(;!Yc(t[l]);)l++;for(c=Xs[t.charCodeAt(l++)]<<10;!Yc(t[l]);)l++;for(c|=Xs[t.charCodeAt(l++)]<<4;!Yc(t[l]);)l++;c|=Xs[t.charCodeAt(l++)]>>2,r[f++]=c>>8&255,r[f++]=c&255;break;case 2:for(;!Yc(t[l]);)l++;for(c=Xs[t.charCodeAt(l++)]<<2;!Yc(t[l]);)l++;c|=Xs[t.charCodeAt(l++)]>>4,r[f++]=c&255;break;case 1:throw new Error("BASE64: remain 1 should not happen")}return f}function jMe(t){const e=$Me(t),n=e[e.length-1].end+1,r=(4-n%4)%4,i=(n+r)*3/4-r,a=new ArrayBuffer(i),o=new Uint8Array(a);let s=0;for(let l=0;l<e.length;l++)s+=GMe(t,e[l],s,o),s+=(4-e[l].count%4)%4;return a}function gF(t,e,n){const r=(t<<16)+(e<<8)+n;return ug[r>>18]+ug[r>>12&63]+ug[r>>6&63]+ug[r&63]}function zMe(t){const e=new Uint8Array(t),n=t.byteLength%3,r=t.byteLength-n,i=Array(r/3);for(let a=0;a<i.length;a++){const o=a*3;i[a]=gF(e[o],e[o+1],e[o+2])}if(n>0){const a=gF(e[r],e[r+1]||0,e[r+2]||0);n===1?i.push(`${a.substr(0,2)}==`):n===2&&i.push(`${a.substr(0,3)}=`)}return i.join("")}var pO={toArrayBuffer:jMe,fromArrayBuffer:zMe};function WMe(t,e){e.classHierarchy.push("vtkStringArray"),t.getComponent=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return e.values[n*e.numberOfComponents+r]},t.setComponent=(n,r,i)=>{i!==e.values[n*e.numberOfComponents+r]&&(e.values[n*e.numberOfComponents+r]=i,t.modified())},t.getData=()=>e.values,t.getTuple=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const i=e.numberOfComponents||1;r.length&&(r.length=i);const a=n*i;for(let o=0;o<i;o++)r[o]=e.values[a+o];return r},t.getTupleLocation=function(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:1)*e.numberOfComponents},t.getNumberOfComponents=()=>e.numberOfComponents,t.getNumberOfValues=()=>e.values.length,t.getNumberOfTuples=()=>e.values.length/e.numberOfComponents,t.getDataType=()=>e.dataType,t.newClone=()=>WQ({name:e.name,numberOfComponents:e.numberOfComponents,empty:!0}),t.getName=()=>(e.name||t.setName(`vtkStringArray${t.getMTime()}`),e.name),t.setData=(n,r)=>{e.values=n,e.size=n.length,r&&(e.numberOfComponents=r),e.size%e.numberOfComponents!==0&&(e.numberOfComponents=1),t.modified()}}const HMe={name:"",numberOfComponents:1,size:0,dataType:"string"};function zQ(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(Object.assign(e,HMe,n),!e.empty&&!e.values&&!e.size)throw new TypeError("Cannot create vtkStringArray object without: size > 0, values");e.values?Array.isArray(e.values)&&(e.values=[...e.values]):e.values=[],e.values&&(e.size=e.values.length),ce.obj(t,e),ce.set(t,e,["name"]),WMe(t,e)}const WQ=ce.newInstance(zQ,"vtkStringArray");var KMe={newInstance:WQ,extend:zQ};function qMe(t,e){return[...t.getElementsByTagName(e)]}function mF(t,e){return qMe(t,e)[0]}function XMe(t){return wMe.create(t)}function YMe(t){const e=/^\s*<AppendedData\s+encoding="raw">\s*_/m,n=/\n\s*<\/AppendedData>/m;return J2.extractBinary(t,e,n)}const jd={Int8:Int8Array,UInt8:Uint8Array,Int16:Int16Array,UInt16:Uint16Array,Int32:Int32Array,UInt32:Uint32Array,Int64:Int32Array,UInt64:Uint32Array,Float32:Float32Array,Float64:Float64Array},Z2={Int8:1,UInt8:1,Int16:2,UInt16:2,Int32:4,UInt32:4,Int64:8,UInt64:8,Float32:4,Float64:8};function X_(t){const e=t.length-1;return t.filter((n,r)=>r<e&&r%2===0)}function Y_(t,e,n){if(!["UInt64","UInt32"].includes(n))throw new Error(`Cannot handle a header type of ${n}`);let r=jd[n],i=jd[e],a=!1;n==="UInt64"&&(r=jd.UInt32),/^U?Int64$/.test(e)&&(a=!0,i=jd[e.replace("64","32")]);const{byteOffset:o}=t,s=Z2[e],l=Z2[n];let c;o%l===0?c=new r(t.buffer,o,1):c=new r(t.buffer.slice(o,o+l));const f=Number(c[0]);let u,d=f/s;a&&(d*=2);const h=o+l;return h%s===0?u=new i(t.buffer,h,d):u=new i(t.buffer.slice(h,h+f)),a&&(u=X_(u)),u}function JMe(t,e){if(e==="UInt64"){let c=new Uint32Array(t.buffer,0,6);const f=c[0],u=c[2],d=c[4],h=[8,f,u,d];c=new Uint32Array(t.buffer,24,f*2);for(let p=0;p<f;p++)h.push(c[p*2]);return h}let n=new Uint32Array(t.buffer,0,3);const r=4,i=n[0],a=n[1],o=n[2],s=[r,i,a,o];n=new Uint32Array(t.buffer,12,i);for(let l=0;l<i;l++)s.push(n[l]);return s}function ZMe(t,e){const[n]=t;return(t.length-1)*n}function QMe(t,e){const n=FMe(t);e.uint8.set(n,e.offset),e.offset+=n.length}function gO(t,e){const n=JMe(t,e),r=n[1],i=n[2],a=n[3];let o=0;r>0&&(a===0?o=r*i:o=(r-1)*i+a);const s=new ArrayBuffer(o),l={offset:0,uint8:new Uint8Array(s)};let c=ZMe(n);for(;c<t.length&&t[c]!==120;)c++;for(let f=0;f<r;f++){const u=n[4+f],d=new Uint8Array(t.buffer,c,u);QMe(d,l),c+=u}return l.uint8}function Q2(t,e,n,r,i,a){const o=e.getAttribute("type"),s=e.getAttribute("Name"),l=e.getAttribute("format"),c=Number(e.getAttribute("NumberOfComponents")||"1");let f=null;if(l==="ascii"){f=new jd[o](t*c);let u=0;e.firstChild.nodeValue.split(/[\\t \\n]+/).forEach(d=>{d.trim().length&&(f[u++]=Number(d))})}else if(l==="binary"){const u=new Uint8Array(pO.toArrayBuffer(e.firstChild.nodeValue.trim()));if(n==="vtkZLibDataCompressor"){const d=gO(u,i);f=new jd[o](d.buffer),/^U?Int64$/.test(o)&&(f=X_(f))}else f=new jd[o](u.buffer,Z2[i]),o.indexOf("Int64")!==-1&&(f=X_(f))}else if(l==="appended"){const u=Number(e.getAttribute("offset"));f=Y_(new Uint8Array(a,u),o,i)}else console.error("Format not supported",l);return{name:s,values:f,numberOfComponents:c}}function d8(t){return new TextDecoder().decode(t).split("\0").slice(0,-1)}function eIe(t,e,n,r,i){const a=t.getAttribute("Name"),o=t.getAttribute("format"),s=Number(t.getAttribute("NumberOfComponents")||"1"),c=Number(t.getAttribute("NumberOfTuples")||"1")*s,f=[];if(o==="ascii"){const u=t.firstChild.nodeValue.trim().split(/\s+/);let d=0;const h=[];for(;f.length<c;){const p=Number(u[d++]);p===0?(f.push(h.join("")),h.length=0):h.push(String.fromCharCode(p))}}else if(o==="binary"){const u=new Uint8Array(pO.toArrayBuffer(t.firstChild.nodeValue.trim()));if(e==="vtkZLibDataCompressor"){const d=gO(u,r);f.push(...d8(d))}else{const d=Y_(u,"UInt8",r);f.push(...d8(d))}}else if(o==="appended"){const u=Number(t.getAttribute("offset")),d=Y_(new Uint8Array(i,u),"UInt8",r);f.push(...d8(d))}else ce.vtkErrorMacro(`Format not supported: ${o}`);return{name:a,values:f,numberOfComponents:s}}function tIe(t,e,n,r,i,a){const o={},s=e.getElementsByTagName("DataArray");for(let p=0;p<s.length;p++){const g=s[p];o[g.getAttribute("Name")]=g}const l=Q2(t,o.offsets,n,r,i,a).values,c=l[l.length-1],f=Q2(c,o.connectivity,n,r,i,a).values,u=new Uint32Array(t+c);let d=0,h=0;return l.forEach(p=>{const g=p-h;u[d++]=g;for(let m=0;m<g;m++)u[d++]=f[h+m];h=p}),u}function nIe(t,e,n,r,i,a,o){if(e){const s=["Scalars","Vectors","Normals","Tensors","TCoords"],l={};s.forEach(u=>{const d=e.getAttribute(u);d&&(l[d]=n[`set${u}`])});const c=e.getElementsByTagName("DataArray"),f=c.length;for(let u=0;u<f;u++){const d=c[u],h=tn.newInstance(Q2(t,d,r,i,a,o)),p=h.getName();(l[p]||n.addArray)(h)}}}function rIe(t,e,n,r,i){const a=[...t.getElementsByTagName("DataArray")].map(s=>tn.newInstance(Q2(Number(s.getAttribute("NumberOfTuples")),s,e,n,r,i))),o=[...t.getElementsByTagName("Array")].filter(s=>s.getAttribute("type")==="String").map(s=>KMe.newInstance(eIe(s,e,n,r,i)));return[...a,...o]}function iIe(t,e){e.classHierarchy.push("vtkXMLReader"),e.dataAccessHelper||(e.dataAccessHelper=Uy.get("http"));function n(r){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return e.dataAccessHelper.fetchBinary(r,i)}t.setUrl=function(r){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e.url=r;const a=r.split("/");return a.pop(),e.baseURL=a.join("/"),t.loadData(i)},t.loadData=function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return n(e.url,r).then(t.parseAsArrayBuffer)},t.parseAsArrayBuffer=r=>{if(!r)return!1;if(r!==e.rawDataBuffer)t.modified();else return!0;const{text:i,binaryBuffer:a}=YMe(r);e.rawDataBuffer=r,e.binaryBuffer=a;const s=XMe(i).root(),l=s.node,c=l.getAttribute("type"),f=l.getAttribute("compressor"),u=l.getAttribute("byte_order"),d=l.getAttribute("header_type")||"UInt32";if(f&&f!=="vtkZLibDataCompressor")return console.error("Invalid compressor",f),!1;if(u&&u!=="LittleEndian")return console.error("Only LittleEndian encoding is supported"),!1;if(c!==e.dataType)return console.error("Invalid data type",c,"expecting",e.dataType),!1;if(mF(l,"AppendedData")){const g=mF(l,"AppendedData"),m=g.getAttribute("encoding"),y=s.filter(_=>{const{node:D}=_;return D.nodeType===Node.ELEMENT_NODE&&D.getAttribute("format")==="appended"&&D.hasAttribute("offset")},!1,!0).map(_=>({node:_.node,offset:Number(_.node.getAttribute("offset"))}));y.sort((_,D)=>_.offset-D.offset);let v=e.binaryBuffer;m==="base64"&&(v=g.textContent.trim().substr(1));const x=[];for(let _=0;_<y.length;++_){const D=y[_].offset;let I=0;_===y.length-1?I=v.length||v.byteLength:I=y[_+1].offset,m==="base64"?x.push(new Uint8Array(pO.toArrayBuffer(v.substring(D,I)))):x.push(new Uint8Array(v.slice(D,I)))}if(f==="vtkZLibDataCompressor")for(let _=0;_<x.length;++_){const D=x[_],I=gO(D,d),R=new Uint8Array(I.length+Z2[d]);new jd[d](R.buffer,0,1)[0]=I.length,R.set(I,Z2[d]),x[_]=R}const w=x.reduce((_,D)=>_+D.length,0),S=new ArrayBuffer(w),T=new Uint8Array(S);for(let _=0,D=0;_<x.length;++_)y[_].node.setAttribute("offset",D),T.set(x[_],D),D+=x[_].length;if(e.binaryBuffer=S,!e.binaryBuffer)return console.error("Processing appended data format: requires binaryBuffer to parse"),!1}t.parseXML(l,c,f,u,d);const p=l.getElementsByTagName(c)[0].getElementsByTagName("FieldData")[0];if(p){const g=rIe(p,f,u,d,e.binaryBuffer);for(let m=0;m<e.output.length;m++){const y=e.output[m].getFieldData();for(let v=0;v<g.length;v++)y.addArray(g[v])}}return!0},t.requestData=(r,i)=>{t.parseAsArrayBuffer(e.rawDataBuffer)}}const aIe={};function oIe(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,aIe,n),ce.obj(t,e),ce.get(t,e,["url","baseURL"]),ce.setGet(t,e,["dataAccessHelper"]),ce.algo(t,e,0,1),iIe(t,e)}var ey={extend:oIe,processDataArray:Q2,processFieldData:nIe,processCells:tIe};function sIe(t,e,n,r,i,a,o){const s=Number(n.getAttribute(`NumberOf${e}`));if(s>0){const l=n.getElementsByTagName(e)[0].getElementsByTagName("DataArray")[0],{values:c,numberOfComponents:f}=ey.processDataArray(s,l,r,i,a,o);t[`get${e}`]().setData(c,f)}return s}function lIe(t,e,n,r,i,a,o){const s=Number(n.getAttribute(`NumberOf${e}`));if(s>0){const l=ey.processCells(s,n.getElementsByTagName(e)[0],r,i,a,o);t[`get${e}`]().setData(l)}return s}function cIe(t,e){e.classHierarchy.push("vtkXMLPolyDataReader"),t.parseXML=(n,r,i,a,o)=>{const l=n.getElementsByTagName(e.dataType)[0].getElementsByTagName("Piece"),c=l.length;for(let f=0;f<c;f++){const u=ca.newInstance(),d=l[f],h=sIe(u,"Points",d,i,a,o,e.binaryBuffer);let p=0;["Verts","Lines","Strips","Polys"].forEach(g=>{p+=lIe(u,g,d,i,a,o,e.binaryBuffer)}),ey.processFieldData(h,d.getElementsByTagName("PointData")[0],u.getPointData(),i,a,o,e.binaryBuffer),ey.processFieldData(p,d.getElementsByTagName("CellData")[0],u.getCellData(),i,a,o,e.binaryBuffer),e.output[f]=u}}}const uIe={dataType:"PolyData"};function HQ(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,uIe,n),ey.extend(t,e,n),cIe(t,e)}const fIe=ce.newInstance(HQ,"vtkXMLPolyDataReader");var dIe={newInstance:fIe,extend:HQ};const On={};function h8(t,e,n,r,i){for(let a=0;a<i;a++)n[r+a]=t[e+a]}function hIe(t){On.splitOn=t,On.pieces=[],On.v=[],On.vt=[],On.vn=[],On.f=[[]],On.size=0}function pIe(t){const e=t.split("/").map(a=>Number(a));let n=e[0]-1;n=n<0?n+1+On.v.length/3:n;let r=e[1]?e[1]-1:n;r=r<0?r+1+On.vt.length/2:r;let i=e[2]?e[2]-1:n;return i=i<0?i+1+On.vn.length/3:i,[n,r,i]}function gIe(t){if(t[0]==="#")return;const e=t.split(/[ \t]+/);if(e[0]===On.splitOn)e.shift(),On.pieces.push(e.join(" ").trim()),On.f.push([]),On.size++;else if(e[0]==="v")On.v.push(Number(e[1])),On.v.push(Number(e[2])),On.v.push(Number(e[3]));else if(e[0]==="vt")On.vt.push(Number(e[1])),On.vt.push(Number(e[2]));else if(e[0]==="vn")On.vn.push(Number(e[1])),On.vn.push(Number(e[2])),On.vn.push(Number(e[3]));else if(e[0]==="f"){On.size===0&&On.size++;const n=On.f[On.size-1];e.shift();const r=e.filter(a=>a.length>0&&a!=="\r"),i=r.length;n.push(i);for(let a=0;a<i;a++)n.push(pIe(r[a]))}}function mIe(t){const e=!!On.vt.length,n=!!On.vn.length;if(t.splitMode){t.numberOfOutputs=On.size;for(let r=0;r<On.size;r++){const i=On.f[r],a=i.length,o=On.v.length/3,s={};let l;if(t.trackDuplicates){const m=[];let y=0;for(let x=0;x<a;){const w=i[x++];for(let S=0;S<w;S++){const[T,_,D]=i[x++],I=`${T}/${_}/${D}`;s[I]===void 0&&(m[T]===void 0?m[T]=[I]:(m[T].push(I),++y),s[I]=T)}}l=new Uint16Array(o+y);let v=0;for(let x=0;x<m.length;++x){const w=m[x]?m[x].length:0;l[x]=w>1?o+v:x;for(let S=1;S<w;++S){const T=o+v++;l[T]=x,s[m[x][S]]=T}}}const c={},f=ca.newInstance({name:On.pieces[r]}),u=[],d=[],h=[],p=[];let g=0;for(;g<a;){const m=i[g];p.push(m);for(let y=0;y<m;y++){const[v,x,w]=i[g+y+1],S=`${v}/${x}/${w}`;if(c[S]===void 0){const T=t.trackDuplicates?s[S]:u.length/3;c[S]=T,h8(On.v,v*3,u,T*3,3),e&&h8(On.vt,x*2,d,T*2,2),n&&h8(On.vn,w*3,h,T*3,3)}p.push(c[S])}g+=m+1}if(f.getPoints().setData(Float32Array.from(u),3),t.trackDuplicates){const m=tn.newInstance({name:"Duplicates",values:l});f.getPointData().addArray(m)}if(f.getPolys().setData(Uint32Array.from(p)),e){const m=tn.newInstance({numberOfComponents:2,values:Float32Array.from(d),name:"TextureCoordinates"});f.getPointData().setTCoords(m)}if(n){const m=tn.newInstance({numberOfComponents:3,values:Float32Array.from(h),name:"Normals"});f.getPointData().setNormals(m)}t.output[r]=f}}else{t.numberOfOutputs=1;const r=ca.newInstance();if(r.getPoints().setData(Float32Array.from(On.v),3),e&&On.v.length/3===On.vt.length/2){const l=tn.newInstance({numberOfComponents:2,values:Float32Array.from(On.vt),name:"TextureCoordinates"});r.getPointData().setTCoords(l)}if(n&&On.v.length===On.vn.length){const l=tn.newInstance({numberOfComponents:3,values:Float32Array.from(On.vn),name:"Normals"});r.getPointData().setNormals(l)}const i=[],a=On.f[0],o=a.length;let s=0;for(;s<o;){const l=a[s];i.push(l);for(let c=0;c<l;c++){const[f]=a[s+c+1];i.push(f)}s+=l+1}r.getPolys().setData(Uint32Array.from(i)),t.output[0]=r}}function vIe(t,e){const n=[],r=t.getPointData().getArrayByName("Duplicates");if(r==null)return n;const i=r.getData(),a=Math.min(e,i[e]);n.push(a);let o=i[a];if(o!==a)for(;o<i.length&&i[o]===a;)n.push(o++);return n}const yIe={getPointDuplicateIds:vIe};function xIe(t,e){e.classHierarchy.push("vtkOBJReader"),e.dataAccessHelper||(e.dataAccessHelper=Uy.get("http"));function n(r){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return e.dataAccessHelper.fetchText(t,r,i)}t.setUrl=function(r){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(r.indexOf(".obj")===-1&&!i.fullpath)e.baseURL=r,e.url=`${r}/index.obj`;else{e.url=r;const a=r.split("/");a.pop(),e.baseURL=a.join("/")}return t.loadData(i)},t.loadData=function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return n(e.url,r).then(i=>t.isDeleted()?!1:t.parseAsText(i))},t.parseAsText=r=>(r&&(r!==e.parseData&&t.modified(),e.parseData=r,e.numberOfOutputs=0,hIe(e.splitMode),r.split(`
`).forEach(gIe),mIe(e)),!0),t.requestData=(r,i)=>{t.parseAsText(e.parseData)},t.isBusy=()=>!!e.requestCount,t.getNumberOfOutputPorts=()=>e.numberOfOutputs}const bIe={numberOfOutputs:1,requestCount:0,splitMode:null,trackDuplicates:!1};function KQ(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,bIe,n),ce.obj(t,e),ce.get(t,e,["url","baseURL"]),ce.setGet(t,e,["dataAccessHelper","splitMode","trackDuplicates"]),ce.algo(t,e,0,1),ce.event(t,e,"busy"),xIe(t,e)}const wIe=ce.newInstance(KQ,"vtkOBJReader");var CIe={newInstance:wIe,extend:KQ,...yIe};function SIe(t,e){e.classHierarchy.push("vtkPolyDataNormals"),t.vtkPolyDataNormalsExecute=(n,r,i)=>{if(!i)return null;const a=new Float32Array(i.length),o=new Float32Array(3*n);let s=0,l=0;const c=r.length,f=[0,0,0],u=[0,0,0];for(let d=0;d<c;d+=l+1)if(l=r[d],!(l<3)){for(let h=1;h<=3;++h)f[h-1]=3*r[d+h];if($Y.computeNormal(i.slice(f[0],f[0]+3),i.slice(f[1],f[1]+3),i.slice(f[2],f[2]+3),u),o[s++]=u[0],o[s++]=u[1],o[s++]=u[2],e.computePointNormals)for(let h=1;h<=l;++h){let p=3*r[d+h];a[p]+=u[0],a[++p]+=u[1],a[++p]+=u[2]}}if(e.computePointNormals){const d=[0,0,0];for(let h=0;h<i.length;)d[0]=a[h],d[1]=a[h+1],d[2]=a[h+2],Zs.normalize(d),a[h++]=d[0],a[h++]=d[1],a[h++]=d[2]}return[o,a]},t.requestData=(n,r)=>{if(!t.getNumberOfInputPorts())return;const a=n[0];if(!a)return;const o=ca.newInstance();o.setPoints(a.getPoints()),o.setVerts(a.getVerts()),o.setLines(a.getLines()),o.setPolys(a.getPolys()),o.setStrips(a.getStrips()),o.getPointData().passData(a.getPointData()),o.getCellData().passData(a.getCellData()),o.getFieldData().passData(a.getFieldData());const[s,l]=t.vtkPolyDataNormalsExecute(a.getNumberOfPolys(),a.getPolys().getData(),a.getPoints().getData());if(e.computePointNormals){const c=tn.newInstance({numberOfComponents:3,name:"Normals",values:l});o.getPointData().setNormals(c)}if(e.computeCellNormals){const c=tn.newInstance({numberOfComponents:3,name:"Normals",values:s});o.getCellData().setNormals(c)}r[0]=o}}function TIe(t){return{computeCellNormals:!1,computePointNormals:!0,...t}}function qQ(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,TIe(n)),ce.obj(t,e),ce.algo(t,e,1,1),ce.setGet(t,e,["computeCellNormals","computePointNormals"]),SIe(t,e)}const EIe=ce.newInstance(qQ,"vtkPolyDataNormals");var _Ie={newInstance:EIe,extend:qQ};class DIe{constructor(e){this._color=[255,255,255],this._actors=[],this.id=e.id,this._color=e.color??this._color,this._format=e.format;const n=new TextDecoder,r=_Ie.newInstance(),i=a=>{const o=o0.newInstance();o.setMapper(a);const s=Yh.newInstance();return s.setColor(this._color[0]/255,this._color[1]/255,this._color[2]/255),o.setProperty(s),o};if(this._format===el.PLY){const a=bc.newInstance(),o=dMe.newInstance();o.parseAsArrayBuffer(e.arrayBuffer),a.setInputConnection(o.getOutputPort()),this._actors.push(i(a))}else if(this._format===el.STL){const a=bc.newInstance(),o=yMe.newInstance();o.parseAsArrayBuffer(e.arrayBuffer),r.setInputConnection(o.getOutputPort()),a.setInputConnection(r.getOutputPort()),this._actors.push(i(a))}else if(this._format===el.OBJ){const a=CIe.newInstance({splitMode:e.materialUrl?"usemtl":null});a.parseAsText(n.decode(e.arrayBuffer));const o=a.getNumberOfOutputPorts();for(let s=0;s<o;s++){const l=a.getOutputData(s),c=bc.newInstance();c.setInputData(l),this._actors.push(i(c))}}else if(this._format===el.VTP){const a=bc.newInstance(),o=dIe.newInstance();o.parseAsArrayBuffer(e.arrayBuffer),a.setInputConnection(o.getOutputPort()),this._actors.push(i(a))}this.sizeInBytes=this._getSizeInBytes()}_getSizeInBytes(){let e=0;for(let n=0;n<this._actors.length;n++){const a=this._actors[n].getMapper().getInputData(),o=a.getPoints(),s=a.getPolys(),l=o.getData().length,c=s.getData().length;e+=l*4+c*4}return e}get defaultActor(){return this._actors[0]}get actors(){return this._actors}get color(){return this._color}get format(){return this._format}}var uc;(function(t){t[t.None=0]="None",t[t.Capture=1]="Capture",t[t.Bubble=2]="Bubble"})(uc||(uc={}));class iS{constructor(e){this._eventListeners=new Map,this._children=new Map,this._target=e}get isEmpty(){return this._eventListeners.size===0&&this._children.size===0}addEventListener(e,n,r){const i=e.indexOf(".");if(i!==-1){const o=e.substring(0,i);let s=this._children.get(o);s||(s=new iS(this._target),this._children.set(o,s)),e=e.substring(i+1),s.addEventListener(e,n,r)}else this._addEventListener(e,n,r)}removeEventListener(e,n,r){const i=e.indexOf(".");if(i!==-1){const o=e.substring(0,i),s=this._children.get(o);if(!s)return;e=e.substring(i+1),s.removeEventListener(e,n,r),s.isEmpty&&this._children.delete(o)}else this._removeEventListener(e,n,r)}reset(){Array.from(this._children.entries()).forEach(([e,n])=>{if(n.reset(),n.isEmpty)this._children.delete(e);else throw new Error("Child is not empty and cannot be removed")}),this._unregisterAllEvents()}_addEventListener(e,n,r){let i=this._eventListeners.get(e);i||(i=new Map,this._eventListeners.set(e,i));const o=r?.capture??!1?uc.Capture:uc.Bubble,s=i.get(n)??uc.None;if(s&o){console.warn("A listener is already registered for this phase");return}i.set(n,s|o),this._target.addEventListener(e,n,r)}_removeEventListener(e,n,r){const a=r?.capture??!1?uc.Capture:uc.Bubble,o=this._eventListeners.get(e);if(!o)return;(n?[n]:Array.from(o.keys())).forEach(l=>{const c=o.get(l)??uc.None;if(!!!(c&a))return;this._target.removeEventListener(e,l,r);const u=c^a;u===uc.None?o.delete(l):o.set(l,u)}),o.size||this._eventListeners.delete(e)}_unregisterAllListeners(e,n){Array.from(n.entries()).forEach(([r,i])=>{const a=uc.Capture;for(let o=a;i;o<<=1){if(!(i&o))continue;const s=o===uc.Capture;this.removeEventListener(e,r,{capture:s}),i^=o}})}_unregisterAllEvents(){Array.from(this._eventListeners.entries()).forEach(([e,n])=>{this._unregisterAllListeners(e,n)})}}class OIe{constructor(){this._targetsEventListeners=new Map}addEventListener(e,n,r,i){let a=this._targetsEventListeners.get(e);a||(a=new iS(e),this._targetsEventListeners.set(e,a)),a.addEventListener(n,r,i)}removeEventListener(e,n,r,i){const a=this._targetsEventListeners.get(e);a&&(a.removeEventListener(n,r,i),a.isEmpty&&this._targetsEventListeners.delete(e))}reset(){Array.from(this._targetsEventListeners.entries()).forEach(([e,n])=>{n.reset(),this._targetsEventListeners.delete(e)})}}const MIe=Object.freeze(Object.defineProperty({__proto__:null,MultiTargetEventListenerManager:OIe,TargetEventListeners:iS},Symbol.toStringTag,{value:"Module"}));function IIe(t,e){const n=t.getSize();for(let r=0;r<n;r++){const i=[];t.getNodeValue(r,i),i[1]=i[1]*e,i[2]=i[2]*e,i[3]=i[3]*e,t.setNodeValue(r,i)}}function RIe(t){let e=t[0],n=t[0],r;const i=t.length;for(let a=1;a<i;a++)r=t[a],e=Math.min(e,r),n=Math.max(n,r);return{min:e,max:n}}const PIe=Symbol("LastRuntimeId"),AIe={},NIe=4294967295,LIe="-";function XQ(t,e,n){return kIe(t!==null&&typeof t=="object"?t:AIe,PIe,(typeof n=="number"&&n>0?n:NIe)>>>0).join(typeof e=="string"?e:LIe)}function kIe(t,e,n){let r=t[e];r instanceof Array||(r=[0],Object.defineProperty(t,e,{value:r}));for(let i=!0,a=0;i&&a<r.length;++a){let o=r[a]|0;o<n?(i=!1,o=o+1):(o=0,a+1===r.length&&r.push(0)),r[a]=o}return r}const vF={},VIe={add:(t,e)=>{const n=Ci(t);vF[n]=e},get:(t,e)=>{if(t==="calibratedPixelSpacing"){const n=Ci(e);return vF[n]}}};function FIe(t,e,n=1e-5){return Math.abs(t[0]+e[0])<n&&Math.abs(t[1]+e[1])<n&&Math.abs(t[2]+e[2])<n}function Ta(t,e){return!(t[0]<0||t[0]>=e[0]||t[1]<0||t[1]>=e[1]||t[2]<0||t[2]>=e[2])}function UIe(t,e){let n;e?n=[zf(e)]:n=jl();const r=[];return n.forEach(i=>{const a=t.getActors(),o=i.getVolumeViewports();for(const s of o){const l=s.getActors();if(l.length!==a.length)continue;a.every(({uid:f})=>l.find(u=>f===u.uid))&&r.push(s)}}),r}const YQ=t=>t.preScale.scaled&&t.preScale.scalingParameters.suvbw;function JQ(t,e,n=void 0,r="_thumbnails",i={displayArea:{imageArea:[1,1]}}){if(!t||!(t instanceof HTMLCanvasElement))throw new Error("canvas element is required");const a=!e.imageId,o=!a&&e,s=a&&e,c=`renderGPUViewport-${o.imageId||s.volumeId}`,f=document.createElement("div"),u=window.devicePixelRatio||1;i.displayArea||(i.displayArea={imageArea:[1,1]});const d=t.width,h=t.height;f.style.width=`${d/u+Zg}px`,f.style.height=`${h/u+Zg}px`,f.style.visibility="hidden",f.style.position="absolute",document.body.appendChild(f);const p=c.split(":").join("-");f.setAttribute("viewport-id-for-remove",p);const g=nl(f),m=zf(r)||new uO(r);let y=m.getViewport(c);if(!y){const v={viewportId:c,type:a?Tr.ORTHOGRAPHIC:Tr.STACK,element:f,defaultOptions:{...i,suppressEvents:!0}};m.enableElement(v),y=m.getViewport(c)}return new Promise(v=>{let x=!1,{viewReference:w}=i;const S=T=>{if(x)return;if(w){const A=w;w=null,y.setViewReference(A),y.render();return}t.getContext("2d").drawImage(g,0,0,g.width,g.height,0,0,t.width,t.height);const D=y.canvasToWorld([0,0]),I=y.canvasToWorld([g.width/u,0]),R=y.canvasToWorld([0,g.height/u]),O=dr([0,0,0],y.canvasToWorld([1/u,0]),D),P=dr([0,0,0],y.canvasToWorld([0,1/u]),D),N=1;x=!0,f.removeEventListener(mt.IMAGE_RENDERED,S),setTimeout(()=>{m.disableElement(c),document.querySelectorAll(`[viewport-id-for-remove="${p}"]`).forEach(B=>{B.remove()})},0),v({origin:D,bottomLeft:R,topRight:I,thicknessMm:N,rightVector:O,downVector:P})};f.addEventListener(mt.IMAGE_RENDERED,S),a?y.setVolumes([s],!1,!0):y.renderImageObject(e),y.resetCamera(),n==="PT"&&!YQ(o)&&y.setProperties({voiRange:{lower:o.minPixelValue,upper:o.maxPixelValue}}),y.render()})}function ZQ(t,e,n,r,i){if(e.volumeId)throw new Error("Unsupported volume rendering for CPU");const o=e,s=CQ(t,o,n),l={canvas:t,viewport:s,image:o,renderingTools:{}};l.transform=Y2(l);const c=!0;return new Promise((f,u)=>{xQ(l,c),f(null)})}function BIe(t){const{canvas:e,imageId:n,viewReference:r,requestType:i=_n.Thumbnail,priority:a=-5,renderingEngineId:o="_thumbnails",useCPURendering:s=!1,thumbnail:l=!1,imageAspect:c=!1,viewportOptions:f}=t,u=r?.volumeId,d=u&&!n,h=r&&f?{...f,viewReference:r}:f,p=s?ZQ:JQ;return new Promise((g,m)=>{function y(S,T){const{modality:_}=Ut("generalSeriesModule",T)||{},D=!d&&S,I=d&&S;D&&(D.isPreScaled=D.isPreScaled||D.preScale?.scaled),l&&(e.height=256,e.width=256),c&&D&&(e.width=D&&e.height*D.width/D.height),e.style.width=`${e.width/devicePixelRatio}px`,e.style.height=`${e.height/devicePixelRatio}px`,I&&s&&m(new Error("CPU rendering of volume not supported")),p(e,S,_,o,h).then(g)}function v(S,T){console.error(S,T),m(S)}function x(S,T,_){return s0(S,_).then(D=>{y.call(this,D,S)},D=>{v.call(this,D,S)})}const w={useRGBA:!!s,requestType:i};if(u){const S=yt.getVolume(u);S||m(new Error(`Volume id ${u} not found in cache`));const T=S.imageIds[0];y(S,T)}else is.addRequest(x.bind(null,n,null,w),i,{imageId:n},a)})}function J_(t){return Array.isArray(t)?t:[t]}const yF={HISTORY_UNDO:"CORNERSTONE_TOOLS_HISTORY_UNDO",HISTORY_REDO:"CORNERSTONE_TOOLS_HISTORY_REDO"};class QQ{constructor(e="Tools",n=50){this.position=-1,this.redoAvailable=0,this.undoAvailable=0,this.ring=new Array,this.isRecordingGrouped=!1,this.label=e,this._size=n}get size(){return this._size}set size(e){this.ring=new Array(e),this._size=e,this.position=-1,this.redoAvailable=0,this.undoAvailable=0}get canUndo(){return this.undoAvailable>0}get canRedo(){return this.redoAvailable>0}undo(e=1){for(;e>0&&this.undoAvailable>0;){const n=this.ring[this.position];for(const r of J_(n).reverse())r.restoreMemo(!0),this.dispatchHistoryEvent({item:r,isUndo:!0});e--,this.redoAvailable++,this.undoAvailable--,this.position=(this.position-1+this.size)%this.size}}undoIf(e){return this.undoAvailable>0&&e(this.ring[this.position])?(this.undo(),!0):!1}dispatchHistoryEvent({item:e,isUndo:n}){e.id&&vt.dispatchEvent(new CustomEvent(n?yF.HISTORY_UNDO:yF.HISTORY_REDO,{detail:{isUndo:n,id:e.id,operationType:e.operationType||"annotation",memo:e}}))}redo(e=1){for(;e>0&&this.redoAvailable>0;){const n=(this.position+1)%this.size,r=this.ring[n];for(const i of J_(r).reverse())i.restoreMemo(!1),this.dispatchHistoryEvent({item:i,isUndo:!1});e--,this.position=n,this.undoAvailable++,this.redoAvailable--}}initializeGroupItem(){this.redoAvailable=0,this.undoAvailable<this._size&&this.undoAvailable++,this.position=(this.position+1)%this._size,this.ring[this.position]=[]}startGroupRecording(){this.isRecordingGrouped=!0,this.initializeGroupItem()}rollbackUnusedGroupItem(){this.ring[this.position]=void 0,this.position=(this.position-1)%this._size,this.undoAvailable--}endGroupRecording(){this.isRecordingGrouped=!1;const e=this.ring[this.position];Array.isArray(e)&&e.length===0&&this.rollbackUnusedGroupItem()}pushGrouped(e){const n=this.ring[this.position];if(Array.isArray(n))return n.push(e),e;throw new Error("Last item should be an array for grouped memos.")}push(e){if(!e)return;const n=e.restoreMemo?e:e.createMemo?.();if(n)return this.isRecordingGrouped?this.pushGrouped(n):(this.redoAvailable=0,this.undoAvailable<this._size&&this.undoAvailable++,this.position=(this.position+1)%this._size,this.ring[this.position]=n,n)}}const eee=new QQ,mO=Object.freeze(Object.defineProperty({__proto__:null,DefaultHistoryMemo:eee,HistoryMemo:QQ},Symbol.toStringTag,{value:"Module"}));function $Ie(t,e){const n=Ut("imagePlaneModule",t);if(!n)throw new Error(`No imagePlaneModule found for imageId: ${t}`);const{columnCosines:r,rowCosines:i,imagePositionPatient:a}=n;let{columnPixelSpacing:o,rowPixelSpacing:s}=n;o||=1,s||=1;const l=it();Ar(l,a,r,-o/2),Ar(l,l,i,-s/2);const c=it();dr(c,e,l);const f=zt(c,i),u=zt(c,r);return[f/s,u/o]}function GIe(t,e){const n=Ut("imagePlaneModule",t);if(!n)throw new Error(`No imagePlaneModule found for imageId: ${t}`);const{columnCosines:r,rowCosines:i,imagePositionPatient:a}=n;let{columnPixelSpacing:o,rowPixelSpacing:s}=n;o||=1,s||=1;const l=it();return Ar(l,a,i,s*(e[0]-.5)),Ar(l,l,r,o*(e[1]-.5)),Array.from(l)}function E3(t){const e=jl(),n=[];return e.forEach(r=>{r.getViewports().forEach(a=>{a.hasImageURI(t)&&n.push(a)})}),n}function tee(t,e){const n=jIe(t,e);return n?n.index:null}function jIe(t,e){const n=e.getImageIds(),r=e.getCurrentImageIdIndex();if(n.length===0)return null;const i=l=>{const c=zIe(l);if(!c)return null;const f=Q7(c.planeNormal,c.imagePositionPatient);return eO(f,t)},a={distance:i(n[r])??1/0,index:r},o=n.slice(r+1);for(let l=0;l<o.length;l++){const c=o[l],f=i(c);if(f!==null)if(f<=a.distance)a.distance=f,a.index=l+r+1;else break}const s=n.slice(0,r);for(let l=s.length-1;l>=0;l--){const c=s[l],f=i(c);if(!(f===null||f===a.distance))if(f<a.distance)a.distance=f,a.index=l;else break}return a.distance===1/0?null:a}function zIe(t){const e=Ut("imagePlaneModule",t);if(!e||!(e.rowCosines instanceof Array&&e.rowCosines.length===3)||!(e.columnCosines instanceof Array&&e.columnCosines.length===3)||!(e.imagePositionPatient instanceof Array&&e.imagePositionPatient.length===3))return null;const{rowCosines:n,columnCosines:r,imagePositionPatient:i}=e,a=t3(it(),...n),o=t3(it(),...r),s=gr(it(),a,o);return{rowCosines:n,columnCosines:r,imagePositionPatient:i,planeNormal:s}}function nee(t){const{width:e,height:n}=t.getCanvas(),{sliceToIndexMatrix:r,indexToSliceMatrix:i}=t.getSliceViewInfo(),a=Ld(t,[0,0]),o=Ld(t,[e-1,0]),s=Ld(t,[0,n-1]),l=dr(it(),o,a),c=dr(it(),s,a),f=gr(it(),l,c);Lr(l,l),Lr(c,c),Lr(f,f);const u=Math.max(Math.abs(l[0]),Math.abs(l[1]),Math.abs(l[2])),d=Math.max(Math.abs(c[0]),Math.abs(c[1]),Math.abs(c[2]));if(!e3(1,u)||!e3(1,d))throw new Error("Livewire is not available for rotate/oblique viewports");const{voxelManager:h}=t.getImageData(),p=t.getSliceViewInfo(),g=h.getSliceData(p);return{width:p.width,height:p.height,scalarData:g,sliceToIndexMatrix:r,indexToSliceMatrix:i}}const j0={},_3={add:(t,e)=>{const[n,r]=t,i=`${n}_${r}`;j0[i]||(j0[i]={}),j0[i]=e},get:(t,e,n)=>{if(t!=="spatialRegistrationModule")return;const r=`${e}_${n}`;if(j0[r])return j0[r];const i=`${n}_${e}`;if(j0[i])return e7(r0(),j0[i])}};Km(_3.get.bind(_3));const WIe=.05;function HIe(t,e){const n=t.getSliceIndex(),r=e.getSliceIndex(),i=Ut("imagePlaneModule",n.toString()),a=Ut("imagePlaneModule",r.toString());if(!i||!a){console.log("Viewport spatial registration requires image plane module");return}const{imageOrientationPatient:o}=a;if(!i.imageOrientationPatient.every((d,h)=>Math.abs(d-o[h])<WIe)){console.log("Viewport spatial registration only supported for same orientation (hence translation only) for now",i?.imageOrientationPatient,a?.imageOrientationPatient);return}const l=i.imagePositionPatient,c=a.imagePositionPatient,f=Pr(it(),l,c),u=dX(r0(),f);_3.add([t.id,e.id],u)}function KIe(t){const{imageData:e,dimensions:n}=t.getImageData()||{};if(!e||!n)return[];const{canvas:r}=t,i=window.devicePixelRatio,a=[0,0],o=[r.width/i,0],s=[r.width/i,r.height/i],l=[0,r.height/i],c=t.canvasToWorld(a),f=t.canvasToWorld(o),u=t.canvasToWorld(s),d=t.canvasToWorld(l),h=e.worldToIndex(c),p=e.worldToIndex(f),g=e.worldToIndex(u),m=e.worldToIndex(d);return qIe({dimensions:n,imageData:e,topLeftImage:h,topRightImage:p,bottomRightImage:g,bottomLeftImage:m,topLeftWorld:c,topRightWorld:f,bottomRightWorld:u,bottomLeftWorld:d})}function qIe({dimensions:t,imageData:e,topLeftImage:n,topRightImage:r,bottomRightImage:i,bottomLeftImage:a,topLeftWorld:o,topRightWorld:s,bottomRightWorld:l,bottomLeftWorld:c}){const f=eb(n,t)?o:e.indexToWorld([0,0,0]),u=eb(r,t)?s:e.indexToWorld([t[0]-1,0,0]),d=eb(i,t)?l:e.indexToWorld([t[0]-1,t[1]-1,0]),h=eb(a,t)?c:e.indexToWorld([0,t[1]-1,0]);return[f,u,h,d]}function eb(t,e){return t[0]>0||t[0]<e[0]-1||t[1]>0||t[1]<e[1]-1||t[2]>0||t[2]<e[2]-1}function Xe(t){if(!t)return;const{viewportUid:e,renderingEngineUid:n}=t.dataset;return Ym(e,n)}function Ym(t,e){if(!e||!t)return;const n=zf(e);if(!n||n.hasBeenDestroyed)return;const r=n.getViewport(t);if(!r)return;const i=r.getFrameOfReferenceUID();return{viewport:r,renderingEngine:n,viewportId:t,renderingEngineId:e,FrameOfReferenceUID:i}}function xr(t){const e=jl();for(let n=0;n<e.length;n++){const r=e[n];if(r.getViewport(t))return Ym(t,r.id)}}function ree(){const t=[];return jl().forEach(n=>{n.getViewports().forEach(({element:i})=>{t.push(Xe(i))})}),t}function XIe(t){const e=Xe(t);if(!e)return;const{viewport:n}=e;if(!(n instanceof fa))throw new Error(`An image can only be fetched for a stack viewport and not for a viewport of type: ${n.type}`);return n.getCornerstoneImage()}function Jm(t){if(t.length<=1)return!1;const e=t[0],{modality:n,seriesInstanceUID:r}=Ut("generalSeriesModule",e),{imageOrientationPatient:i,pixelSpacing:a,frameOfReferenceUID:o,columns:s,rows:l,usingDefaultValues:c}=Ut("imagePlaneModule",e);if(c)return!1;const f={modality:n,imageOrientationPatient:i,pixelSpacing:a,columns:s,rows:l,seriesInstanceUID:r};let u=!0;for(let d=0;d<t.length;d++){const h=t[d],{modality:p,seriesInstanceUID:g}=Ut("generalSeriesModule",h),{imageOrientationPatient:m,pixelSpacing:y,columns:v,rows:x}=Ut("imagePlaneModule",h);if(g!==f.seriesInstanceUID){u=!1;break}if(p!==f.modality){u=!1;break}if(v!==f.columns){u=!1;break}if(x!==f.rows){u=!1;break}if(!pr(m,f.imageOrientationPatient)){u=!1;break}if(!pr(y,f.pixelSpacing)){u=!1;break}}return u}const YIe=new Set(["1.2.840.10008.1.2.4.100","1.2.840.10008.1.2.4.100.1","1.2.840.10008.1.2.4.101","1.2.840.10008.1.2.4.101.1","1.2.840.10008.1.2.4.102","1.2.840.10008.1.2.4.102.1","1.2.840.10008.1.2.4.103","1.2.840.10008.1.2.4.103.1","1.2.840.10008.1.2.4.104","1.2.840.10008.1.2.4.104.1","1.2.840.10008.1.2.4.105","1.2.840.10008.1.2.4.105.1","1.2.840.10008.1.2.4.106","1.2.840.10008.1.2.4.106.1","1.2.840.10008.1.2.4.107","1.2.840.10008.1.2.4.108"]);function iee(t){return t?(Array.isArray(t)?t:[t]).find(n=>YIe.has(n)):!1}async function JIe({viewport:t,options:e={}}){const n=t.getRenderingEngine();let r=e.volumeId||`${cr()}`;r.split(":").length===0&&(r=`${YZ()}:${r}`);const{id:i,element:a}=t,o=e.viewportId||i,s=t.getImageIds(),l=t.getViewPresentation(),c=t.getViewReference();n.enableElement({viewportId:o,type:Tr.ORTHOGRAPHIC,element:a,defaultOptions:{background:e.background,orientation:e.orientation}}),(await Y7(r,{imageIds:s})).load();const u=n.getViewport(o);await SQ(n,[{volumeId:r}],[o]);const d=()=>{u.render(),a.removeEventListener(mt.VOLUME_VIEWPORT_NEW_VOLUME,d)};return(()=>{a.addEventListener(mt.VOLUME_VIEWPORT_NEW_VOLUME,d)})(),u.setViewPresentation(l),u.setViewReference(c),u.render(),u}async function ZIe({viewport:t,options:e}){const n=t,{id:r,element:i}=n,a=t.getRenderingEngine(),{background:o}=e,s=e.viewportId||r,l=yt.getVolume(n.getVolumeId());if(!(l instanceof Hm))throw new Error("Currently, you cannot decache a volume that is not an ImageVolume. So, unfortunately, volumes such as nifti  (which are basic Volume, without imageIds) cannot be decached.");const c={viewportId:s,type:Tr.STACK,element:i,defaultOptions:{background:o}},f=n.getViewReference();a.enableElement(c);const u=a.getViewport(s);return await u.setStack(l.imageIds),u.setViewReference(f),u.render(),u}function Vn(t,e=2){if(Array.isArray(t))return t.map(i=>Vn(i,e)).join(", ");if(t==null||t==="")return"NaN";t=Number(t);const n=Math.abs(t);if(n<1e-4)return`${t}`;const r=n>=100?e-2:n>=10?e-1:n>=1?e:n>=.1?e+1:n>=.01?e+2:n>=.001?e+3:e+4;return t.toFixed(r)}function cw(t){return Math.round(t/al)*al}function aee(t,e,n){const r=t.length===e*n*4,i=t.length===e*n*3;if(r||i){const a=new Float32Array(e*n);let o=0,s=0;const l=r?4:3;for(let c=0;c<e;c++)for(let f=0;f<n;f++){const u=t[o],d=t[o+1],h=t[o+2];a[s]=(u+d+h)/3,o+=l,s++}return a}else return t}function QIe(t){if(t instanceof da)return yt.getVolume(t.getVolumeId()).imageIds;if(t.getImageIds)return t.getImageIds()}function vO(t,e){const n=[...t];return e>=n.length?(xF(n),n):(xF(n),n.slice(0,e))}function xF(t){for(let e=t.length-1;e>0;e--){const n=Math.floor(Math.random()*(e+1));[t[e],t[n]]=[t[n],t[e]]}}function p8(t){const e=t.toString(16);return e.length==1?"0"+e:e}function eRe(t,e,n){return"#"+p8(t)+p8(e)+p8(n)}function tRe(t){const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null}const nRe=Object.freeze(Object.defineProperty({__proto__:null,hexToRgb:tRe,rgbToHex:eRe},Symbol.toStringTag,{value:"Module"}));function oee(t,e){if(t===e)return!0;if(t==null||e==null)return!1;try{return JSON.stringify(t)===JSON.stringify(e)}catch(n){return console.debug("Error in JSON.stringify during deep comparison:",n),t===e}}function rRe(t,e,n){if(!n)throw new Error("getVolume is required, use the utilities export instead ");if(t.modality)return t.modality;if(t.setVolumes)return e=e??t.getVolumeId(),!e||!n?void 0:n(e).metadata.Modality;throw new Error("Invalid viewport type")}const iRe=(t,e)=>t.reduce((n,r)=>((n[r[e]]=n[r[e]]||[]).push(r),n),{});function aRe(t){const e=t.map(o=>{const{imagePositionPatient:s}=Ut("imagePlaneModule",o)||{};return{imageId:o,imagePositionPatient:s}});if(!e.every(o=>o.imagePositionPatient))return null;const n=iRe(e,"imagePositionPatient"),r=Object.keys(n),i=n[r[0]].length;return i===1||!r.every(o=>n[o].length===i)?null:n}function oRe(t,e){const n={};let r=[];const i=Object.keys(t);for(let a=0;a<i.length;a++){const o=new Set,s=t[i[a]];for(let l=0;l<s.length;l++){const c=e(s[l].imageId)||0;if(n[c]=n[c]||[],n[c].push({imageId:s[l].imageId}),o.add(c),o.size-1<l)return}if(a==0)r=Array.from(o);else if(!uRe(r,o))return}return n}function uv(t,e){const n=Ut(e,t);try{return parseFloat(n)}catch{return}}function sRe(t){const e=Ut("20011003",t);try{const{InlineBinary:n}=e;if(n){const r=atob(n),i=new ArrayBuffer(r.length),a=new DataView(i);for(let o=0;o<r.length;o++)a.setUint8(o,r.charCodeAt(o));return new Float32Array(i)[0]}return parseFloat(e)}catch{return}}function lRe(t){let e=Ut("0019100c",t)||Ut("0019100C",t);try{const{InlineBinary:n}=e;return n&&(e=atob(n)),parseFloat(e)}catch{return}}function cRe(t){let e=Ut("00431039",t);try{const{InlineBinary:n}=e;return n&&(e=atob(n).split("//")),parseFloat(e[0])%1e5}catch{return}}function uRe(t,e){if(t.length!=e.size)return!1;for(let n=0;n<t.length;n++)if(!e.has(t[n]))return!1;return!0}function fRe(t){const e=Ut("petImageModule",t);return e?e.frameReferenceTime:0}function yO(t){const e=aRe(t);if(!e)return{imageIdGroups:[t],splittingTag:null};const n=["TemporalPositionIdentifier","DiffusionBValue","TriggerTime","EchoTime","EchoNumber","PhilipsPrivateBValue","SiemensPrivateBValue","GEPrivateBValue","PetFrameReferenceTime"],r=[i=>uv(i,n[0]),i=>uv(i,n[1]),i=>uv(i,n[2]),i=>uv(i,n[3]),i=>uv(i,n[4]),sRe,lRe,cRe,fRe];for(let i=0;i<r.length;i++){const a=oRe(e,r[i]);if(a)return{imageIdGroups:Object.keys(a).map(Number.parseFloat).sort((l,c)=>l-c).map(l=>a[l].map(c=>c.imageId)),splittingTag:n[i]}}return{imageIdGroups:[t],splittingTag:null}}function dRe(t){const{imageIdGroups:e,splittingTag:n}=yO(t);return{isDynamicVolume:e.length>1,timePoints:e,splittingTag:n}}function hRe(t,e){const n=t.length,{rescaleSlope:r,rescaleIntercept:i,suvbw:a}=e;if(e.modality==="PT"&&typeof a=="number")for(let o=0;o<n;o++)t[o]=a*(t[o]*r+i);else for(let o=0;o<n;o++)t[o]=t[o]*r+i;return t}function see(t,e,n){return Math.min(Math.max(e,t),n)}function lee(t,e){if(!Xe(t.element))throw new Error("Scroll::Viewport is not enabled (it might be disabled)");if(t instanceof fa&&t.getImageIds().length===0)throw new Error("Scroll::Stack Viewport has no images");const{volumeId:r,delta:i,scrollSlabs:a}=e;if(t instanceof da)pRe(t,r,i,a);else{const o=t.getCurrentImageIdIndex();if(o+i>t.getImageIds().length-1||o+i<0){const s={imageIdIndex:o,direction:i};wt(vt,mt.STACK_SCROLL_OUT_OF_BOUNDS,s)}t.scroll(i,e.debounceLoading,e.loop)}}function pRe(t,e,n,r=!1){const i=r,{numScrollSteps:a,currentStepIndex:o,sliceRangeInfo:s}=Yg(t,e,i);if(!s)return;const{sliceRange:l,spacingInNormalDirection:c,camera:f}=s,{focalPoint:u,viewPlaneNormal:d,position:h}=f,{newFocalPoint:p,newPosition:g}=Jg(u,h,l,d,c,n);t.setCamera({focalPoint:p,position:g}),t.render();const m=o+n,y={volumeId:e,viewport:t,delta:n,desiredStepIndex:m,currentStepIndex:o,numScrollSteps:a,currentImageId:t.getCurrentImageId()};(m>a||m<0)&&t.getCurrentImageId()?wt(vt,mt.VOLUME_VIEWPORT_SCROLL_OUT_OF_BOUNDS,y):wt(vt,mt.VOLUME_VIEWPORT_SCROLL,y)}async function gRe(t,e={}){const{imageIndex:n,debounceLoading:r,volumeId:i}=e,a=Xe(t);if(!a)throw new Error("Element has been disabled");const{viewport:o}=a,{imageIndex:s,numberOfSlices:l}=mRe(o,r),f=vRe(l,n)-s;lee(o,{delta:f,debounceLoading:r,volumeId:i})}function mRe(t,e){return t instanceof fa?{numberOfSlices:t.getImageIds().length,imageIndex:e?t.getTargetImageIdIndex():t.getCurrentImageIdIndex()}:{numberOfSlices:t.getNumberOfSlices(),imageIndex:t.getSliceIndex()}}function vRe(t,e){const n=t-1;return see(e,0,n)}function yRe(t,e,n={}){const r=yt.getVolume(t);if(!r)throw new Error(`Referenced volume with id ${t} does not exist.`);const{metadata:i,spacing:a,direction:o,dimensions:s}=r,{minX:l,maxX:c,minY:f,maxY:u,minZ:d,maxZ:h}=e,p=[Math.min(l,c),Math.min(f,u),Math.min(d,h)],g=gm(r.imageData,p),m=[Math.abs(c-l)+1,Math.abs(u-f)+1,Math.abs(h-d)+1],{targetBuffer:y}=n,v={metadata:i,dimensions:m,spacing:a,origin:g,direction:o,targetBuffer:y,scalarData:y?.type==="Float32Array"?new Float32Array(m[0]*m[1]*m[2]):void 0},x=J7(cr(),v),w=x.voxelManager.getCompleteScalarDataArray(),S=m[0]*m[1],T=s[0]*s[1],_=r.voxelManager.getCompleteScalarDataArray();for(let D=0;D<m[2];D++)for(let I=0;I<m[1];I++){const R=gm(x.imageData,[0,I,D]),O=fo(r.imageData,R),P=O[2]*T+O[1]*s[0]+O[0],N=_.slice(P,P+m[0]),A=D*S+I*m[0];w.set(N,A)}return x.voxelManager.setCompleteScalarDataArray(w),x}function xRe(t,e){const{viewUp:n,viewPlaneNormal:r}=e,i=Yb(t,[0,0,0]),a=cu(it(),n),o=cu(it(),r),s=gr(it(),a,o),l=dr(it(),Yb(t,a),i),c=dr(it(),Yb(t,o),i);Lr(l,l),Lr(c,c);const f=gr(it(),l,c);return{worldVecRowDir:s,worldVecColDir:a,worldVecSliceDir:o,ijkVecRowDir:f,ijkVecColDir:l,ijkVecSliceDir:c}}function bRe(t,e,n,r){const[i,a,o]=e,s=i*a;let l=0,c=0,f=0;const[u,d,h]=n.map(Math.round);for(let y=h-r;y<=h+r;y++)if(!(y<0||y>=o)){for(let v=d-r;v<=d+r;v++)if(!(v<0||v>=a))for(let x=u-r;x<=u+r;x++){if(x<0||x>=i)continue;const w=y*s+v*i+x,S=t[w];l+=S,c+=S*S,f++}}if(f===0){const y=h*s+d*i+u;return y>=0&&y<t.length?{mean:t[y],stdDev:0,count:1}:{mean:0,stdDev:0,count:0}}const p=l/f,g=c/f-p*p,m=Math.sqrt(Math.max(0,g));return{mean:p,stdDev:m,count:f}}const wRe=new Set(["1.2.840.10008.5.1.4.1.1.1","1.2.840.10008.5.1.4.1.1.1.1","1.2.840.10008.5.1.4.1.1.1.1.1","1.2.840.10008.5.1.4.1.1.1.2","1.2.840.10008.5.1.4.1.1.1.2.1","1.2.840.10008.5.1.4.1.1.1.3","1.2.840.10008.5.1.4.1.1.1.3.1","1.2.840.10008.5.1.4.1.1.12.1","1.2.840.10008.5.1.4.1.1.12.1.1","1.2.840.10008.5.1.4.1.1.12.2","1.2.840.10008.5.1.4.1.1.12.2.1","1.2.840.10008.5.1.4.1.1.12.3"]);function CRe(t){const{PixelSpacing:e,ImagerPixelSpacing:n,EstimatedRadiographicMagnificationFactor:r,PixelSpacingCalibrationType:i,PixelSpacingCalibrationDescription:a}=t,o=!0;return n?e?pr(e,n)?{PixelSpacing:e,type:Zc.PROJECTION,isProjection:o}:i||a?{PixelSpacing:e,type:Zc.CALIBRATED,isProjection:o,PixelSpacingCalibrationType:i,PixelSpacingCalibrationDescription:a}:{PixelSpacing:e,type:Zc.UNKNOWN,isProjection:o}:r?{PixelSpacing:n.map(l=>l/r),type:Zc.ERMF,isProjection:o}:(console.warn("EstimatedRadiographicMagnificationFactor was not present. Unable to correct ImagerPixelSpacing."),{PixelSpacing:n,type:Zc.PROJECTION,isProjection:o}):{PixelSpacing:e,type:Zc.UNKNOWN,isProjection:o}}function SRe(t){const{SequenceOfUltrasoundRegions:e}=t,n=Array.isArray(e);if(n&&e.length>1){console.warn("Sequence of Ultrasound Regions > one entry. This is not yet implemented, all measurements will be shown in pixels.");return}const{PhysicalDeltaX:r,PhysicalDeltaY:i}=n?e[0]:e;return{PixelSpacing:[Math.abs(r)*10,Math.abs(i)*10]}}function TRe(t){const{PixelSpacing:e,SOPClassUID:n,SequenceOfUltrasoundRegions:r}=t;return r?SRe(t):wRe.has(n)?CRe(t):{PixelSpacing:e,type:Zc.NOT_APPLICABLE,isProjection:!1}}const ERe=(t,e)=>rRe(t,e,yt.getVolume),Yr=Object.freeze(Object.defineProperty({__proto__:null,FrameRange:Qg,HistoryMemo:mO,PointsManager:rw,ProgressiveIterator:v3,RLEVoxelMap:Zp,VoxelManager:a0,actorIsA:ns,applyPreset:rQ,asArray:J_,autoLoad:$_,buildMetadata:fQ,calculateNeighborhoodStats:bRe,calculateSpacingBetweenImageIds:FZ,calculateViewportsSpatialRegistration:HIe,calibratedPixelSpacingMetadataProvider:VIe,clamp:H_,clip:see,color:nRe,colormap:Swe,convertStackToVolumeViewport:JIe,convertToGrayscale:aee,convertVolumeToStackViewport:ZIe,createLinearRGBTransferFunction:hQ,createSigmoidRGBTransferFunction:l7,createSubVolume:yRe,decimate:$Z,deepClone:mc,deepEqual:oee,deepMerge:No,eventListener:MIe,fnv1aHash:vX,generateVolumePropsFromImageIds:YC,genericMetadataProvider:Gd,getBufferConfiguration:B7,getClosestImageId:$h,getClosestStackImageIndexForPoint:tee,getCurrentVolumeViewportSlice:nee,getDynamicVolumeInfo:dRe,getImageDataMetadata:tO,getImageLegacy:XIe,getImageSliceDataForVolumeViewport:x3,getMinMax:RIe,getPixelSpacingInformation:TRe,getRandomSampleFromArray:vO,getRuntimeId:XQ,getScalingParameters:UZ,getSliceRange:QC,getSpacingInNormalDirection:Jh,getTargetVolumeAndSpacingInNormalDir:Vy,getViewportImageCornersInWorld:KIe,getViewportImageIds:QIe,getViewportModality:ERe,getViewportsWithImageURI:E3,getViewportsWithVolumeId:JC,getVoiFromSigmoidRGBTransferFunction:nQ,getVolumeActorCorners:QZ,getVolumeDirectionVectors:xRe,getVolumeId:m0,getVolumeSliceRangeInfo:tQ,getVolumeViewportScrollInfo:Yg,getVolumeViewportsContainingSameVolumes:UIe,hasFloatScalingParameters:K7,hasNaNValues:G_,imageIdToURI:Ci,imageRetrieveMetadataProvider:pm,imageToWorldCoords:GIe,indexWithinDimensions:Ta,invertRgbTransferFunction:i2,isEqual:pr,isEqualAbs:Xb,isEqualNegative:bX,isImageActor:gc,isNumber:hi,isOpposite:FIe,isPTPrescaledWithSUV:YQ,isValidVolume:Jm,isVideoTransferSyntax:iee,jumpToSlice:gRe,loadImageToCanvas:BIe,logger:Y7e,makeVolumeMetadata:VZ,planar:u7e,pointInShapeCallback:N7,renderToCanvasCPU:ZQ,renderToCanvasGPU:JQ,roundNumber:Vn,roundToPrecision:cw,scaleArray:hRe,scaleRgbTransferFunction:IIe,scroll:lee,snapFocalPointToSlice:Jg,sortImageIdsAndGetSpacing:H7,spatialRegistrationMetadataProvider:_3,splitImageIdsBy4DTags:yO,transferFunctionUtils:Ewe,transformIndexToWorld:gm,transformWorldToIndex:fo,transformWorldToIndexContinuous:Yb,triggerEvent:wt,updatePlaneRestriction:eQ,updateVTKImageDataWithCornerstoneImage:tS,uuidv4:cr,windowLevel:Twe,worldToImageCoords:$Ie},Symbol.toStringTag,{value:"Module"}));class cee extends jZ{constructor(e,n){super(e,n),this._dimensionGroupNumber=1,this._loadedDimensionGroups=new Set,this._getImageIdRequests=(a,o)=>this.getImageIdsRequests(a,o),this.getImageLoadRequests=a=>{const o=this.getImageIdsToLoad();return this._getImageIdRequests(o,a)};const{imageIdGroups:r,splittingTag:i}=e;this._splittingTag=i,this._imageIdGroups=r,this.numDimensionGroups=this._imageIdGroups.length,this.numTimePoints=this.numDimensionGroups}_getImageIdsToLoad(){const e=this._imageIdGroups,n=this._dimensionGroupNumber-1,r=[...e[n]];let i=n-1,a=n+1;for(;i>=0||a<e.length;)i>=0&&r.push(...e[i--]),a<e.length&&r.push(...e[a++]);return r}getImageIdsToLoad(){return this._getImageIdsToLoad()}get dimensionGroupNumber(){return this._dimensionGroupNumber}set timePointIndex(e){console.warn("Warning: timePointIndex is deprecated. Please use dimensionGroupNumber instead. Note that timePointIndex is zero-based while dimensionGroupNumber starts at 1."),this.dimensionGroupNumber=e+1}set dimensionGroupNumber(e){this._dimensionGroupNumber!==e&&(this._dimensionGroupNumber=e,this.voxelManager.setDimensionGroupNumber(e),this.invalidateVolume(!0),wt(vt,mt.DYNAMIC_VOLUME_DIMENSION_GROUP_CHANGED,{volumeId:this.volumeId,dimensionGroupNumber:e,numDimensionGroups:this.numDimensionGroups,imageIdGroupIndex:e-1,numImageIdGroups:this.numDimensionGroups,splittingTag:this.splittingTag}),wt(vt,mt.DYNAMIC_VOLUME_TIME_POINT_INDEX_CHANGED,{volumeId:this.volumeId,timePointIndex:e-1,numTimePoints:this.numDimensionGroups,imageIdGroupIndex:e-1,numImageIdGroups:this.numDimensionGroups,splittingTag:this.splittingTag}))}get timePointIndex(){return console.warn("Warning: timePointIndex is deprecated. Please use dimensionGroupNumber instead. Note that timePointIndex is zero-based while dimensionGroupNumber starts at 1."),this._dimensionGroupNumber-1}scroll(e){const n=this._dimensionGroupNumber+e;n<1?this.dimensionGroupNumber=this.numDimensionGroups:n>this.numDimensionGroups?this.dimensionGroupNumber=1:this.dimensionGroupNumber=n}getCurrentDimensionGroupImageIds(){return this._imageIdGroups[this._dimensionGroupNumber-1]}getCurrentTimePointImageIds(){return console.warn("Warning: getCurrentTimePointImageIds is deprecated. Please use getCurrentDimensionGroupImageIds instead."),this.getCurrentDimensionGroupImageIds()}flatImageIdIndexToTimePointIndex(e){return console.warn("Warning: flatImageIdIndexToTimePointIndex is deprecated. Please use flatImageIdIndexToDimensionGroupNumber instead."),this.flatImageIdIndexToDimensionGroupNumber(e)-1}flatImageIdIndexToDimensionGroupNumber(e){return Math.floor(e/this._imageIdGroups[0].length)+1}flatImageIdIndexToImageIdIndex(e){return e%this._imageIdGroups[0].length}get splittingTag(){return this._splittingTag}isTimePointLoaded(e){return console.warn("Warning: isTimePointLoaded is deprecated. Please use isDimensionGroupLoaded instead. Note that timePointIndex is zero-based while dimensionGroupNumber starts at 1."),this.isDimensionGroupLoaded(e+1)}isDimensionGroupLoaded(e){return this._loadedDimensionGroups.has(e)}markDimensionGroupAsLoaded(e){this._loadedDimensionGroups.add(e),wt(vt,mt.DYNAMIC_VOLUME_DIMENSION_GROUP_LOADED,{volumeId:this.volumeId,dimensionGroupNumber:e}),wt(vt,mt.DYNAMIC_VOLUME_TIME_POINT_LOADED,{volumeId:this.volumeId,timePointIndex:e-1})}checkTimePointCompletion(e){console.warn("Warning: checkTimePointCompletion is deprecated. Please use checkDimensionGroupCompletion instead."),this.checkDimensionGroupCompletion(e)}checkDimensionGroupCompletion(e){const n=this.flatImageIdIndexToDimensionGroupNumber(e);this._imageIdGroups[n-1].every(a=>{const o=this.getImageIdIndex(a);return this.cachedFrames[o]===Ds.FULL_RESOLUTION})&&!this.isDimensionGroupLoaded(n)&&this.markDimensionGroupAsLoaded(n)}}const Zm=new LD("imageRetrievalPool");Zm.setMaxSimultaneousRequests(_n.Interaction,200);Zm.setMaxSimultaneousRequests(_n.Thumbnail,200);Zm.setMaxSimultaneousRequests(_n.Prefetch,200);Zm.grabDelay=0;const bF=Symbol("DefaultSettings"),wF=Symbol("RuntimeSettings"),CF=Symbol("ObjectSettingsMap"),lf=Symbol("Dictionary");class ei{constructor(e){const n=Object.create(e instanceof ei&&lf in e?e[lf]:null);Object.seal(Object.defineProperty(this,lf,{value:n}))}set(e,n){return D3(this[lf],e,n,null)}get(e){return ORe(this[lf],e)}unset(e){return _Re(this[lf],e+"")}forEach(e){SF(this[lf],e)}extend(){return new ei(this)}import(e){uee(e)&&Object.keys(e).forEach(n=>{D3(this[lf],n,e[n],null)})}dump(){const e={};return SF(this[lf],(n,r)=>{typeof r<"u"&&fee(e,n,r)}),e}static assert(e){return e instanceof ei?e:ei.getRuntimeSettings()}static getDefaultSettings(e=null){let n=ei[bF];if(n instanceof ei||(n=new ei,ei[bF]=n),e){const r={};return n.forEach(i=>{if(i.startsWith(e)){const a=i.split(`${e}.`)[1];r[a]=n.get(i)}}),r}return n}static getRuntimeSettings(){let e=ei[wF];return e instanceof ei||(e=new ei(ei.getDefaultSettings()),ei[wF]=e),e}static getObjectSettings(e,n){let r=null;if(e instanceof ei)r=e;else if(typeof e=="object"&&e!==null){let i=ei[CF];i instanceof WeakMap||(i=new WeakMap,ei[CF]=i),r=i.get(e),r instanceof ei||(r=new ei(ei.assert(ei.getObjectSettings(n))),i.set(e,r))}return r}static extendRuntimeSettings(){return ei.getRuntimeSettings().extend()}}function _Re(t,e){if(e.endsWith(".")){let n=0;const r=e,i=r.slice(0,-1),a=i.length===0;for(const o in t)Object.prototype.hasOwnProperty.call(t,o)&&(a||o.startsWith(r)||o===i)&&(delete t[o],++n);return n>0}return delete t[e]}function SF(t,e){for(const n in t)e(n,t[n])}function DRe(t,e,n,r){let i;if(r.has(n))return D3(t,e,null,r);r.add(n),i=0;for(const a in n)if(Object.prototype.hasOwnProperty.call(n,a)){const o=a.length===0?e:`${e}.${a}`;D3(t,o,n[a],r)||++i}return r.delete(n),i===0}function D3(t,e,n,r){return MRe(e)?uee(n)?DRe(t,e,n,r instanceof WeakSet?r:new WeakSet):(t[e]=n,!0):!1}function ORe(t,e){return t[e]}function MRe(t){let e,n,r;if(typeof t!="string"||(e=t.length-1)<0)return!1;for(r=-1;(n=t.indexOf(".",r+1))>=0;){if(n-r<2||n===e)return!1;r=n}return!0}function uee(t){if(typeof t=="object"&&t!==null){const e=Object.getPrototypeOf(t);if(e===Object.prototype||e===null)return!0}return!1}function fee(t,e,n){const r=e.indexOf(".");if(r>=0){const i=e.slice(0,r);let a=t[i];if(typeof a!="object"||a===null){const o=a;a={},typeof o<"u"&&(a[""]=o),t[i]=a}fee(a,e.slice(r+1,e.length),n)}else t[e]=n}ei.getDefaultSettings().set("useCursors",!0);function uw(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function IRe(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function dee(t){let e,n,r;t.length!==2?(e=uw,n=(s,l)=>uw(t(s),l),r=(s,l)=>t(s)-l):(e=t===uw||t===IRe?t:RRe,n=t,r=t);function i(s,l,c=0,f=s.length){if(c<f){if(e(l,l)!==0)return f;do{const u=c+f>>>1;n(s[u],l)<0?c=u+1:f=u}while(c<f)}return c}function a(s,l,c=0,f=s.length){if(c<f){if(e(l,l)!==0)return f;do{const u=c+f>>>1;n(s[u],l)<=0?c=u+1:f=u}while(c<f)}return c}function o(s,l,c=0,f=s.length){const u=i(s,l,c,f-1);return u>c&&r(s[u-1],l)>-r(s[u],l)?u-1:u}return{left:i,center:o,right:a}}function RRe(){return 0}function PRe(t){return t===null?NaN:+t}const ARe=dee(uw),NRe=ARe.right;dee(PRe).center;const LRe=Math.sqrt(50),kRe=Math.sqrt(10),VRe=Math.sqrt(2);function O3(t,e,n){const r=(e-t)/Math.max(0,n),i=Math.floor(Math.log10(r)),a=r/Math.pow(10,i),o=a>=LRe?10:a>=kRe?5:a>=VRe?2:1;let s,l,c;return i<0?(c=Math.pow(10,-i)/o,s=Math.round(t*c),l=Math.round(e*c),s/c<t&&++s,l/c>e&&--l,c=-c):(c=Math.pow(10,i)*o,s=Math.round(t/c),l=Math.round(e/c),s*c<t&&++s,l*c>e&&--l),l<s&&.5<=n&&n<2?O3(t,e,n*2):[s,l,c]}function FRe(t,e,n){if(e=+e,t=+t,n=+n,!(n>0))return[];if(t===e)return[t];const r=e<t,[i,a,o]=r?O3(e,t,n):O3(t,e,n);if(!(a>=i))return[];const s=a-i+1,l=new Array(s);if(r)if(o<0)for(let c=0;c<s;++c)l[c]=(a-c)/-o;else for(let c=0;c<s;++c)l[c]=(a-c)*o;else if(o<0)for(let c=0;c<s;++c)l[c]=(i+c)/-o;else for(let c=0;c<s;++c)l[c]=(i+c)*o;return l}function Z_(t,e,n){return e=+e,t=+t,n=+n,O3(t,e,n)[2]}function URe(t,e,n){e=+e,t=+t,n=+n;const r=e<t,i=r?Z_(e,t,n):Z_(t,e,n);return(r?-1:1)*(i<0?1/-i:i)}function BRe(t,e){let n;if(e===void 0)for(const r of t)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of t)(i=e(i,++r,t))!=null&&(n>i||n===void 0&&i>=i)&&(n=i)}return n}function $Re(t){if(!(a=t.length))return[];for(var e=-1,n=BRe(t,GRe),r=new Array(n);++e<n;)for(var i=-1,a,o=r[e]=new Array(a);++i<a;)o[i]=t[i][e];return r}function GRe(t){return t.length}function TF(){return $Re(arguments)}function jRe(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function xO(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function hee(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function $y(){}var ty=.7,M3=1/ty,em="\\s*([+-]?\\d+)\\s*",ny="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",fu="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",zRe=/^#([0-9a-f]{3,8})$/,WRe=new RegExp(`^rgb\\(${em},${em},${em}\\)$`),HRe=new RegExp(`^rgb\\(${fu},${fu},${fu}\\)$`),KRe=new RegExp(`^rgba\\(${em},${em},${em},${ny}\\)$`),qRe=new RegExp(`^rgba\\(${fu},${fu},${fu},${ny}\\)$`),XRe=new RegExp(`^hsl\\(${ny},${fu},${fu}\\)$`),YRe=new RegExp(`^hsla\\(${ny},${fu},${fu},${ny}\\)$`),EF={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};xO($y,ry,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:_F,formatHex:_F,formatHex8:JRe,formatHsl:ZRe,formatRgb:DF,toString:DF});function _F(){return this.rgb().formatHex()}function JRe(){return this.rgb().formatHex8()}function ZRe(){return pee(this).formatHsl()}function DF(){return this.rgb().formatRgb()}function ry(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=zRe.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?OF(e):n===3?new Os(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?tb(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?tb(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=WRe.exec(t))?new Os(e[1],e[2],e[3],1):(e=HRe.exec(t))?new Os(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=KRe.exec(t))?tb(e[1],e[2],e[3],e[4]):(e=qRe.exec(t))?tb(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=XRe.exec(t))?RF(e[1],e[2]/100,e[3]/100,1):(e=YRe.exec(t))?RF(e[1],e[2]/100,e[3]/100,e[4]):EF.hasOwnProperty(t)?OF(EF[t]):t==="transparent"?new Os(NaN,NaN,NaN,0):null}function OF(t){return new Os(t>>16&255,t>>8&255,t&255,1)}function tb(t,e,n,r){return r<=0&&(t=e=n=NaN),new Os(t,e,n,r)}function QRe(t){return t instanceof $y||(t=ry(t)),t?(t=t.rgb(),new Os(t.r,t.g,t.b,t.opacity)):new Os}function Q_(t,e,n,r){return arguments.length===1?QRe(t):new Os(t,e,n,r??1)}function Os(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}xO(Os,Q_,hee($y,{brighter(t){return t=t==null?M3:Math.pow(M3,t),new Os(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?ty:Math.pow(ty,t),new Os(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Os(Th(this.r),Th(this.g),Th(this.b),I3(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:MF,formatHex:MF,formatHex8:ePe,formatRgb:IF,toString:IF}));function MF(){return`#${gh(this.r)}${gh(this.g)}${gh(this.b)}`}function ePe(){return`#${gh(this.r)}${gh(this.g)}${gh(this.b)}${gh((isNaN(this.opacity)?1:this.opacity)*255)}`}function IF(){const t=I3(this.opacity);return`${t===1?"rgb(":"rgba("}${Th(this.r)}, ${Th(this.g)}, ${Th(this.b)}${t===1?")":`, ${t})`}`}function I3(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Th(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function gh(t){return t=Th(t),(t<16?"0":"")+t.toString(16)}function RF(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new vc(t,e,n,r)}function pee(t){if(t instanceof vc)return new vc(t.h,t.s,t.l,t.opacity);if(t instanceof $y||(t=ry(t)),!t)return new vc;if(t instanceof vc)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),a=Math.max(e,n,r),o=NaN,s=a-i,l=(a+i)/2;return s?(e===a?o=(n-r)/s+(n<r)*6:n===a?o=(r-e)/s+2:o=(e-n)/s+4,s/=l<.5?a+i:2-a-i,o*=60):s=l>0&&l<1?0:o,new vc(o,s,l,t.opacity)}function tPe(t,e,n,r){return arguments.length===1?pee(t):new vc(t,e,n,r??1)}function vc(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}xO(vc,tPe,hee($y,{brighter(t){return t=t==null?M3:Math.pow(M3,t),new vc(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?ty:Math.pow(ty,t),new vc(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new Os(g8(t>=240?t-240:t+120,i,r),g8(t,i,r),g8(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new vc(PF(this.h),nb(this.s),nb(this.l),I3(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=I3(this.opacity);return`${t===1?"hsl(":"hsla("}${PF(this.h)}, ${nb(this.s)*100}%, ${nb(this.l)*100}%${t===1?")":`, ${t})`}`}}));function PF(t){return t=(t||0)%360,t<0?t+360:t}function nb(t){return Math.max(0,Math.min(1,t||0))}function g8(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}function nPe(t,e,n,r,i){var a=t*t,o=a*t;return((1-3*t+3*a-o)*e+(4-6*a+3*o)*n+(1+3*t+3*a-3*o)*r+o*i)/6}function m8(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),i=t[r],a=t[r+1],o=r>0?t[r-1]:2*i-a,s=r<e-1?t[r+2]:2*a-i;return nPe((n-r/e)*e,o,i,a,s)}}const bO=t=>()=>t;function rPe(t,e){return function(n){return t+n*e}}function iPe(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function aPe(t){return(t=+t)==1?gee:function(e,n){return n-e?iPe(e,n,t):bO(isNaN(e)?n:e)}}function gee(t,e){var n=e-t;return n?rPe(t,n):bO(isNaN(t)?e:t)}const AF=(function t(e){var n=aPe(e);function r(i,a){var o=n((i=Q_(i)).r,(a=Q_(a)).r),s=n(i.g,a.g),l=n(i.b,a.b),c=gee(i.opacity,a.opacity);return function(f){return i.r=o(f),i.g=s(f),i.b=l(f),i.opacity=c(f),i+""}}return r.gamma=t,r})(1);function oPe(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,r=e.slice(),i;return function(a){for(i=0;i<n;++i)r[i]=t[i]*(1-a)+e[i]*a;return r}}function sPe(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function lPe(t,e){var n=e?e.length:0,r=t?Math.min(n,t.length):0,i=new Array(r),a=new Array(n),o;for(o=0;o<r;++o)i[o]=wO(t[o],e[o]);for(;o<n;++o)a[o]=e[o];return function(s){for(o=0;o<r;++o)a[o]=i[o](s);return a}}function cPe(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function R3(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function uPe(t,e){var n={},r={},i;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(i in e)i in t?n[i]=wO(t[i],e[i]):r[i]=e[i];return function(a){for(i in n)r[i]=n[i](a);return r}}var e9=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,v8=new RegExp(e9.source,"g");function fPe(t){return function(){return t}}function dPe(t){return function(e){return t(e)+""}}function hPe(t,e){var n=e9.lastIndex=v8.lastIndex=0,r,i,a,o=-1,s=[],l=[];for(t=t+"",e=e+"";(r=e9.exec(t))&&(i=v8.exec(e));)(a=i.index)>n&&(a=e.slice(n,a),s[o]?s[o]+=a:s[++o]=a),(r=r[0])===(i=i[0])?s[o]?s[o]+=i:s[++o]=i:(s[++o]=null,l.push({i:o,x:R3(r,i)})),n=v8.lastIndex;return n<e.length&&(a=e.slice(n),s[o]?s[o]+=a:s[++o]=a),s.length<2?l[0]?dPe(l[0].x):fPe(e):(e=l.length,function(c){for(var f=0,u;f<e;++f)s[(u=l[f]).i]=u.x(c);return s.join("")})}function wO(t,e){var n=typeof e,r;return e==null||n==="boolean"?bO(e):(n==="number"?R3:n==="string"?(r=ry(e))?(e=r,AF):hPe:e instanceof ry?AF:e instanceof Date?cPe:sPe(e)?oPe:Array.isArray(e)?lPe:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?uPe:R3)(t,e)}function pPe(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}function fv(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t(r/(e-1));return n}function gPe(t){return function(){return t}}function mPe(t){return+t}var NF=[0,1];function fg(t){return t}function t9(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:gPe(isNaN(e)?NaN:.5)}function vPe(t,e){var n;return t>e&&(n=t,t=e,e=n),function(r){return Math.max(t,Math.min(e,r))}}function yPe(t,e,n){var r=t[0],i=t[1],a=e[0],o=e[1];return i<r?(r=t9(i,r),a=n(o,a)):(r=t9(r,i),a=n(a,o)),function(s){return a(r(s))}}function xPe(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),a=new Array(r),o=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<r;)i[o]=t9(t[o],t[o+1]),a[o]=n(e[o],e[o+1]);return function(s){var l=NRe(t,s,1,r)-1;return a[l](i[l](s))}}function bPe(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function wPe(){var t=NF,e=NF,n=wO,r,i,a,o=fg,s,l,c;function f(){var d=Math.min(t.length,e.length);return o!==fg&&(o=vPe(t[0],t[d-1])),s=d>2?xPe:yPe,l=c=null,u}function u(d){return d==null||isNaN(d=+d)?a:(l||(l=s(t.map(r),e,n)))(r(o(d)))}return u.invert=function(d){return o(i((c||(c=s(e,t.map(r),R3)))(d)))},u.domain=function(d){return arguments.length?(t=Array.from(d,mPe),f()):t.slice()},u.range=function(d){return arguments.length?(e=Array.from(d),f()):e.slice()},u.rangeRound=function(d){return e=Array.from(d),n=pPe,f()},u.clamp=function(d){return arguments.length?(o=d?!0:fg,f()):o!==fg},u.interpolate=function(d){return arguments.length?(n=d,f()):n},u.unknown=function(d){return arguments.length?(a=d,u):a},function(d,h){return r=d,i=h,f()}}function CPe(){return wPe()(fg,fg)}function SPe(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function P3(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function vm(t){return t=P3(Math.abs(t)),t?t[1]:NaN}function TPe(t,e){return function(n,r){for(var i=n.length,a=[],o=0,s=t[0],l=0;i>0&&s>0&&(l+s+1>r&&(s=Math.max(1,r-l)),a.push(n.substring(i-=s,i+s)),!((l+=s+1)>r));)s=t[o=(o+1)%t.length];return a.reverse().join(e)}}function EPe(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var _Pe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function A3(t){if(!(e=_Pe.exec(t)))throw new Error("invalid format: "+t);var e;return new CO({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}A3.prototype=CO.prototype;function CO(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}CO.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function DPe(t){e:for(var e=t.length,n=1,r=-1,i;n<e;++n)switch(t[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+t[n])break e;r>0&&(r=0);break}return r>0?t.slice(0,r)+t.slice(i+1):t}var mee;function OPe(t,e){var n=P3(t,e);if(!n)return t+"";var r=n[0],i=n[1],a=i-(mee=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,o=r.length;return a===o?r:a>o?r+new Array(a-o+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+P3(t,Math.max(0,e+a-1))[0]}function LF(t,e){var n=P3(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const kF={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:SPe,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>LF(t*100,e),r:LF,s:OPe,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function VF(t){return t}var FF=Array.prototype.map,UF=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function MPe(t){var e=t.grouping===void 0||t.thousands===void 0?VF:TPe(FF.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",r=t.currency===void 0?"":t.currency[1]+"",i=t.decimal===void 0?".":t.decimal+"",a=t.numerals===void 0?VF:EPe(FF.call(t.numerals,String)),o=t.percent===void 0?"%":t.percent+"",s=t.minus===void 0?"−":t.minus+"",l=t.nan===void 0?"NaN":t.nan+"";function c(u){u=A3(u);var d=u.fill,h=u.align,p=u.sign,g=u.symbol,m=u.zero,y=u.width,v=u.comma,x=u.precision,w=u.trim,S=u.type;S==="n"?(v=!0,S="g"):kF[S]||(x===void 0&&(x=12),w=!0,S="g"),(m||d==="0"&&h==="=")&&(m=!0,d="0",h="=");var T=g==="$"?n:g==="#"&&/[boxX]/.test(S)?"0"+S.toLowerCase():"",_=g==="$"?r:/[%p]/.test(S)?o:"",D=kF[S],I=/[defgprs%]/.test(S);x=x===void 0?6:/[gprs]/.test(S)?Math.max(1,Math.min(21,x)):Math.max(0,Math.min(20,x));function R(O){var P=T,N=_,A,B,V;if(S==="c")N=D(O)+N,O="";else{O=+O;var $=O<0||1/O<0;if(O=isNaN(O)?l:D(Math.abs(O),x),w&&(O=DPe(O)),$&&+O==0&&p!=="+"&&($=!1),P=($?p==="("?p:s:p==="-"||p==="("?"":p)+P,N=(S==="s"?UF[8+mee/3]:"")+N+($&&p==="("?")":""),I){for(A=-1,B=O.length;++A<B;)if(V=O.charCodeAt(A),48>V||V>57){N=(V===46?i+O.slice(A+1):O.slice(A))+N,O=O.slice(0,A);break}}}v&&!m&&(O=e(O,1/0));var U=P.length+O.length+N.length,G=U<y?new Array(y-U+1).join(d):"";switch(v&&m&&(O=e(G+O,G.length?y-N.length:1/0),G=""),h){case"<":O=P+O+N+G;break;case"=":O=P+G+O+N;break;case"^":O=G.slice(0,U=G.length>>1)+P+O+N+G.slice(U);break;default:O=G+P+O+N;break}return a(O)}return R.toString=function(){return u+""},R}function f(u,d){var h=c((u=A3(u),u.type="f",u)),p=Math.max(-8,Math.min(8,Math.floor(vm(d)/3)))*3,g=Math.pow(10,-p),m=UF[8+p/3];return function(y){return h(g*y)+m}}return{format:c,formatPrefix:f}}var rb,vee,yee;IPe({thousands:",",grouping:[3],currency:["$",""]});function IPe(t){return rb=MPe(t),vee=rb.format,yee=rb.formatPrefix,rb}function RPe(t){return Math.max(0,-vm(Math.abs(t)))}function PPe(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(vm(e)/3)))*3-vm(Math.abs(t)))}function APe(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,vm(e)-vm(t))+1}function NPe(t,e,n,r){var i=URe(t,e,n),a;switch(r=A3(r??",f"),r.type){case"s":{var o=Math.max(Math.abs(t),Math.abs(e));return r.precision==null&&!isNaN(a=PPe(i,o))&&(r.precision=a),yee(r,o)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(a=APe(i,Math.max(Math.abs(t),Math.abs(e))))&&(r.precision=a-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(a=RPe(i))&&(r.precision=a-(r.type==="%")*2);break}}return vee(r)}function LPe(t){var e=t.domain;return t.ticks=function(n){var r=e();return FRe(r[0],r[r.length-1],n??10)},t.tickFormat=function(n,r){var i=e();return NPe(i[0],i[i.length-1],n??10,r)},t.nice=function(n){n==null&&(n=10);var r=e(),i=0,a=r.length-1,o=r[i],s=r[a],l,c,f=10;for(s<o&&(c=o,o=s,s=c,c=i,i=a,a=c);f-- >0;){if(c=Z_(o,s,n),c===l)return r[i]=o,r[a]=s,e(r);if(c>0)o=Math.floor(o/c)*c,s=Math.ceil(s/c)*c;else if(c<0)o=Math.ceil(o*c)/c,s=Math.floor(s*c)/c;else break;l=c}return t},t}function SO(){var t=CPe();return t.copy=function(){return bPe(t,SO())},jRe.apply(t,arguments),LPe(t)}function kPe(t,e){e.classHierarchy.push("vtkTexture"),t.imageLoaded=()=>{e.image.removeEventListener("load",t.imageLoaded),e.imageLoaded=!0,t.modified()},t.setJsImageData=n=>{e.jsImageData!==n&&(n!==null&&(t.setInputData(null),t.setInputConnection(null),e.image=null,e.canvas=null),e.jsImageData=n,e.imageLoaded=!0,t.modified())},t.setCanvas=n=>{e.canvas!==n&&(n!==null&&(t.setInputData(null),t.setInputConnection(null),e.image=null,e.jsImageData=null),e.canvas=n,t.modified())},t.setImage=n=>{e.image!==n&&(n!==null&&(t.setInputData(null),t.setInputConnection(null),e.canvas=null,e.jsImageData=null),e.image=n,e.imageLoaded=!1,n.complete?t.imageLoaded():n.addEventListener("load",t.imageLoaded),t.modified())},t.getDimensionality=()=>{let n=0,r=0,i=1;if(t.getInputData()){const o=t.getInputData();n=o.getDimensions()[0],r=o.getDimensions()[1],i=o.getDimensions()[2]}return e.jsImageData&&(n=e.jsImageData.width,r=e.jsImageData.height),e.canvas&&(n=e.canvas.width,r=e.canvas.height),e.image&&(n=e.image.width,r=e.image.height),(n>1)+(r>1)+(i>1)},t.getInputAsJsImageData=()=>{if(!e.imageLoaded||t.getInputData())return null;if(e.jsImageData)return e.jsImageData();if(e.canvas)return e.canvas.getContext("2d").getImageData(0,0,e.canvas.width,e.canvas.height);if(e.image){const n=document.createElement("canvas");n.width=e.image.width,n.height=e.image.height;const r=n.getContext("2d");return r.translate(0,n.height),r.scale(1,-1),r.drawImage(e.image,0,0,e.image.width,e.image.height),r.getImageData(0,0,n.width,n.height)}return null}}const VPe=(t,e,n,r)=>{const i=[1,2,1],a=4,o=i,s=a,l=t.length/(e*n);let c=e,f=n,u=t;const d=[u];for(let h=0;h<r;h++){const p=[...u];c/=2,f/=2,u=new Uint8ClampedArray(c*f*l);const g=l*c;let m=0;for(let v=0;v<u.length;v+=l){v%g===0&&(m+=2*l*c);for(let x=0;x<l;x++){let w=p[m+x];w+=p[m+l+x],w+=p[m-2*g+x],w+=p[m-2*g+l+x],w/=4,u[v+x]=w}m+=2*l}let y=[...u];for(let v=0;v<u.length;v+=l)for(let x=0;x<l;x++){let w=-(o.length-1)/2,S=s,T=0;for(let _=0;_<o.length;_++){let D=v+x+w*l;const I=D%g-(v+x)%g;I>l&&(D+=g),I<-l&&(D-=g),y[D]?T+=y[D]*o[_]:S-=o[_],w+=1}u[v+x]=T/S}y=[...u];for(let v=0;v<u.length;v+=l)for(let x=0;x<l;x++){let w=-(o.length-1)/2,S=s,T=0;for(let _=0;_<o.length;_++){const D=v+x+w*g;y[D]?T+=y[D]*o[_]:S-=o[_],w+=1}u[v+x]=T/S}d.push(u)}return d},FPe={image:null,canvas:null,jsImageData:null,imageLoaded:!1,repeat:!1,interpolate:!1,edgeClamp:!1,mipLevel:0,resizable:!1};function xee(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,FPe,n),ce.obj(t,e),ce.algo(t,e,6,0),ce.get(t,e,["canvas","image","jsImageData","imageLoaded","resizable"]),ce.setGet(t,e,["repeat","edgeClamp","interpolate","mipLevel"]),kPe(t,e)}const UPe=ce.newInstance(xee,"vtkTexture"),BPe={generateMipmaps:VPe};var Qm={newInstance:UPe,extend:xee,...BPe};const $Pe=[[-1,0,0],[1,0,0],[0,-1,0],[0,1,0],[0,0,-1],[0,0,1]],BF=[[8,7,11,3],[9,1,10,5],[4,9,0,8],[2,11,6,10],[0,3,2,1],[4,5,6,7]],ib=[[0,1],[1,3],[2,3],[0,2],[4,5],[5,7],[6,7],[4,6],[0,4],[1,5],[3,7],[2,6]],$F=[0,1,0,1,0,1,0,1,2,2,2,2],bi=[[1,2],[1,2],[0,2],[0,2],[0,1],[0,1]],En=new Float64Array(3),ab=new Float64Array(3),Ir=new Float64Array(3),rh=new Float64Array(3),z0=new Float64Array(3),ob=new Float64Array(3),y8=new Float64Array(16);function x8(t,e){t.strokeStyle=e.strokeColor,t.lineWidth=e.strokeSize,t.fillStyle=e.fontColor,t.font=`${e.fontStyle} ${e.fontSize}px ${e.fontFamily}`}function bee(t){const e=[],n=[];for(let r=0;r<3;r++){const i=SO().domain([t[r*2],t[r*2+1]]);e[r]=i.ticks(5);const a=i.tickFormat(5);n[r]=e[r].map(a)}return{ticks:e,tickStrings:n}}function GPe(t,e){e.classHierarchy.push("vtkCubeAxesActorHelper"),t.setRenderable=n=>{e.renderable!==n&&(e.renderable=n,e.tmActor.addTexture(e.renderable.getTmTexture()),e.tmActor.setProperty(n.getProperty()),e.tmActor.setParentProp(n),t.modified())},t.createPolyDataForOneLabel=(n,r,i,a,o,s,l)=>{const c=e.renderable.get_tmAtlas().get(n);if(!c)return;const f=e.renderable.getTextPolyData().getPoints().getData(),u=e.lastSize;En[0]=f[r*3],En[1]=f[r*3+1],En[2]=f[r*3+2],Gn(Ir,En,i),Ir[0]+=.1,Gn(ab,Ir,a),Bd(z0,ab,En),Ir[0]-=.1,Ir[1]+=.1,Gn(ab,Ir,a),Bd(ob,ab,En);for(let p=0;p<3;p++)z0[p]/=.5*.1*u[0],ob[p]/=.5*.1*u[1];let d=l.ptIdx,h=l.cellIdx;En[0]=f[r*3],En[1]=f[r*3+1],En[2]=f[r*3+2],o[0]<-.5?ff(Ir,z0,o[0]*s-c.width):o[0]>.5?ff(Ir,z0,o[0]*s):ff(Ir,z0,o[0]*s-c.width/2),Mv(En,En,Ir),ff(Ir,ob,o[1]*s-c.height/2),Mv(En,En,Ir),l.points[d*3]=En[0],l.points[d*3+1]=En[1],l.points[d*3+2]=En[2],l.tcoords[d*2]=c.tcoords[0],l.tcoords[d*2+1]=c.tcoords[1],d++,ff(Ir,z0,c.width),Mv(En,En,Ir),l.points[d*3]=En[0],l.points[d*3+1]=En[1],l.points[d*3+2]=En[2],l.tcoords[d*2]=c.tcoords[2],l.tcoords[d*2+1]=c.tcoords[3],d++,ff(Ir,ob,c.height),Mv(En,En,Ir),l.points[d*3]=En[0],l.points[d*3+1]=En[1],l.points[d*3+2]=En[2],l.tcoords[d*2]=c.tcoords[4],l.tcoords[d*2+1]=c.tcoords[5],d++,ff(Ir,z0,c.width),Bd(En,En,Ir),l.points[d*3]=En[0],l.points[d*3+1]=En[1],l.points[d*3+2]=En[2],l.tcoords[d*2]=c.tcoords[6],l.tcoords[d*2+1]=c.tcoords[7],d++,l.polys[h*4]=3,l.polys[h*4+1]=d-4,l.polys[h*4+2]=d-3,l.polys[h*4+3]=d-2,h++,l.polys[h*4]=3,l.polys[h*4+1]=d-4,l.polys[h*4+2]=d-2,l.polys[h*4+3]=d-1,l.ptIdx+=4,l.cellIdx+=2},t.updateTexturePolyData=()=>{const n=e.camera.getCompositeProjectionMatrix(e.lastAspectRatio,-1,1);jn(n,n);const r=e.renderable.getTextValues().length,i=r*4,a=r*2,o=new Float64Array(i*3),s=new Uint16Array(a*4),l=new Float32Array(i*2);Ea(y8,n);const c={ptIdx:0,cellIdx:0,polys:s,points:o,tcoords:l};let f=0,u=0,d=0;const h=e.renderable.getTextPolyData().getPoints().getData(),p=e.renderable.getTextValues();for(;f<h.length/3;){En[0]=h[f*3],En[1]=h[f*3+1],En[2]=h[f*3+2],Gn(Ir,En,n),En[0]=h[f*3+3],En[1]=h[f*3+4],En[2]=h[f*3+5],Gn(rh,En,n),Bd(Ir,Ir,rh);const m=[Ir[0],Ir[1]];Vq(m),t.createPolyDataForOneLabel(p[u],f,n,y8,m,e.renderable.getAxisTitlePixelOffset(),c),f+=2,u++;for(let y=0;y<e.renderable.getTickCounts()[d];y++)t.createPolyDataForOneLabel(p[u],f,n,y8,m,e.renderable.getTickLabelPixelOffset(),c),f++,u++;d++}const g=tn.newInstance({numberOfComponents:2,values:l,name:"TextureCoordinates"});e.tmPolyData.getPointData().setTCoords(g),e.tmPolyData.getPoints().setData(o,3),e.tmPolyData.getPoints().modified(),e.tmPolyData.getPolys().setData(s,1),e.tmPolyData.getPolys().modified(),e.tmPolyData.modified()},t.updateAPISpecificData=(n,r,i)=>{(e.lastSize[0]!==n[0]||e.lastSize[1]!==n[1])&&(e.lastSize[0]=n[0],e.lastSize[1]=n[1],e.lastAspectRatio=n[0]/n[1],e.forceUpdate=!0),e.camera=r,t.updateTexturePolyData()}}const jPe=ce.newInstance(function(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{renderable:null};Object.assign(e,{},n),ce.obj(t,e),e.tmPolyData=ca.newInstance(),e.tmMapper=bc.newInstance(),e.tmMapper.setInputData(e.tmPolyData),e.tmActor=o0.newInstance({parentProp:t}),e.tmActor.setMapper(e.tmMapper),ce.setGet(t,e,["renderable"]),ce.get(t,e,["lastSize","lastAspectRatio","axisTextStyle","tickTextStyle","tmActor","ticks"]),e.forceUpdate=!1,e.lastRedrawTime={},ce.obj(e.lastRedrawTime,{mtime:0}),e.lastRebuildTime={},ce.obj(e.lastRebuildTime,{mtime:0}),e.lastSize=[-1,-1],e.lastTickBounds=[],GPe(t,e)},"vtkCubeAxesActorHelper");function zPe(t,e){e.classHierarchy.push("vtkCubeAxesActor"),t.setCamera=r=>{e.camera!==r&&(e.cameraModifiedSub&&(e.cameraModifiedSub.unsubscribe(),e.cameraModifiedSub=null),e.camera=r,r&&(e.cameraModifiedSub=r.onModified(t.update)),t.update(),t.modified())},t.computeFacesToDraw=()=>{const r=e.camera.getViewMatrix();jn(r,r);let i=!1;const a=Er.getDiagonalLength(e.dataBounds),o=Math.sin(e.faceVisibilityAngle*Math.PI/180);for(let s=0;s<6;s++){let l=!1;const c=Math.floor(s/2),f=(c+1)%3,u=(c+2)%3;e.dataBounds[f*2]!==e.dataBounds[f*2+1]&&e.dataBounds[u*2]!==e.dataBounds[u*2+1]&&(En[c]=e.dataBounds[s]-.1*a*$Pe[s][c],En[f]=.5*(e.dataBounds[f*2]+e.dataBounds[f*2+1]),En[u]=.5*(e.dataBounds[u*2]+e.dataBounds[u*2+1]),Gn(Ir,En,r),En[c]=e.dataBounds[s],Gn(rh,En,r),Bd(Ir,rh,Ir),wc(Ir,Ir),l=Ir[2]>o,e.camera.getParallelProjection()||(wc(rh,rh),l=K2(rh,Ir)>o)),l!==e.lastFacesToDraw[s]&&(e.lastFacesToDraw[s]=l,i=!0)}return i},t.updatePolyData=(r,i,a)=>{let o=0,s=0;o+=8;let l=0;for(let h=0;h<12;h++)i[h]>0&&l++;if(s+=l,e.gridLines)for(let h=0;h<6;h++)r[h]&&(o+=a[bi[h][0]].length*2+a[bi[h][1]].length*2,s+=a[bi[h][0]].length+a[bi[h][1]].length);const c=new Float64Array(o*3),f=new Uint32Array(s*3);let u=0,d=0;for(let h=0;h<2;h++)for(let p=0;p<2;p++)for(let g=0;g<2;g++)c[u*3]=e.dataBounds[g],c[u*3+1]=e.dataBounds[2+p],c[u*3+2]=e.dataBounds[4+h],u++;for(let h=0;h<12;h++)i[h]>0&&(f[d*3]=2,f[d*3+1]=ib[h][0],f[d*3+2]=ib[h][1],d++);if(e.gridLines){for(let h=0;h<6;h++)if(r[h]){const p=Math.floor(h/2);let g=a[bi[h][0]];for(let m=0;m<g.length;m++)c[u*3+p]=e.dataBounds[h],c[u*3+bi[h][0]]=g[m],c[u*3+bi[h][1]]=e.dataBounds[bi[h][1]*2],u++,c[u*3+p]=e.dataBounds[h],c[u*3+bi[h][0]]=g[m],c[u*3+bi[h][1]]=e.dataBounds[bi[h][1]*2+1],u++,f[d*3]=2,f[d*3+1]=u-2,f[d*3+2]=u-1,d++;g=a[bi[h][1]];for(let m=0;m<g.length;m++)c[u*3+p]=e.dataBounds[h],c[u*3+bi[h][1]]=g[m],c[u*3+bi[h][0]]=e.dataBounds[bi[h][0]*2],u++,c[u*3+p]=e.dataBounds[h],c[u*3+bi[h][1]]=g[m],c[u*3+bi[h][0]]=e.dataBounds[bi[h][0]*2+1],u++,f[d*3]=2,f[d*3+1]=u-2,f[d*3+2]=u-1,d++}}e.polyData.getPoints().setData(c,3),e.polyData.getPoints().modified(),e.polyData.getLines().setData(f,1),e.polyData.getLines().modified(),e.polyData.modified()},t.updateTextData=(r,i,a,o)=>{let s=0;for(let h=0;h<12;h++)i[h]===1&&(s+=2,s+=a[$F[h]].length);const l=e.polyData.getPoints().getData(),c=new Float64Array(s*3);let f=0,u=0,d=0;for(let h=0;h<6;h++)if(r[h])for(let p=0;p<4;p++){const g=BF[h][p];if(i[g]===1){const m=$F[g],y=ib[g][0]*3,v=ib[g][1]*3;c[f*3]=.5*(l[y]+l[v]),c[f*3+1]=.5*(l[y+1]+l[v+1]),c[f*3+2]=.5*(l[y+2]+l[v+2]),f++;const x=Math.floor(h/2);c[f*3+x]=e.dataBounds[h],c[f*3+bi[h][0]]=.5*(e.dataBounds[bi[h][0]*2]+e.dataBounds[bi[h][0]*2+1]),c[f*3+bi[h][1]]=.5*(e.dataBounds[bi[h][1]*2]+e.dataBounds[bi[h][1]*2+1]),f++,e.textValues[u]=e.axisLabels[m],u++;const w=(m+1)%3,S=(m+2)%3,T=a[m],_=o[m];e.tickCounts[d]=T.length;for(let D=0;D<T.length;D++)c[f*3+m]=T[D],c[f*3+w]=l[y+w],c[f*3+S]=l[y+S],f++,e.textValues[u]=_[D],u++;d++}}e.textPolyData.getPoints().setData(c,3),e.textPolyData.modified()},t.update=()=>{if(!e.camera)return;const r=t.computeFacesToDraw(),i=e.lastFacesToDraw;let a=!1;for(let o=0;o<6;o++)e.dataBounds[o]!==e.lastTickBounds[o]&&(a=!0,e.lastTickBounds[o]=e.dataBounds[o]);if(r||a||e.forceUpdate){const o=new Array(12).fill(0);for(let l=0;l<6;l++)if(i[l])for(let c=0;c<4;c++)o[BF[l][c]]++;const s=e.generateTicks(e.dataBounds);t.updatePolyData(i,o,s.ticks),t.updateTextData(i,o,s.ticks,s.tickStrings),(a||e.forceUpdate)&&t.updateTextureAtlas(s.tickStrings)}e.forceUpdate=!1},t.updateTextureAtlas=r=>{e.tmContext.textBaseline="bottom",e.tmContext.textAlign="left",e._tmAtlas.clear();let i=0,a=1;for(let o=0;o<3;o++){if(!e._tmAtlas.has(e.axisLabels[o])){x8(e.tmContext,e.axisTextStyle);const s=e.tmContext.measureText(e.axisLabels[o]),l={height:s.actualBoundingBoxAscent+2,startingHeight:a,width:s.width+2,textStyle:e.axisTextStyle};e._tmAtlas.set(e.axisLabels[o],l),a+=l.height,i<l.width&&(i=l.width)}x8(e.tmContext,e.tickTextStyle);for(let s=0;s<r[o].length;s++)if(!e._tmAtlas.has(r[o][s])){const l=e.tmContext.measureText(r[o][s]),c={height:l.actualBoundingBoxAscent+2,startingHeight:a,width:l.width+2,textStyle:e.tickTextStyle};e._tmAtlas.set(r[o][s],c),a+=c.height,i<c.width&&(i=c.width)}}i=Al(i),a=Al(a),e._tmAtlas.forEach(o=>{o.tcoords=[0,(a-o.startingHeight-o.height)/a,o.width/i,(a-o.startingHeight-o.height)/a,o.width/i,(a-o.startingHeight)/a,0,(a-o.startingHeight)/a]}),e.tmCanvas.width=i,e.tmCanvas.height=a,e.tmContext.textBaseline="bottom",e.tmContext.textAlign="left",e.tmContext.clearRect(0,0,i,a),e._tmAtlas.forEach((o,s)=>{x8(e.tmContext,o.textStyle),e.tmContext.fillText(s,1,o.startingHeight+o.height-1)}),e.tmTexture.setCanvas(e.tmCanvas),e.tmTexture.modified()},t.onModified(()=>{e.forceUpdate=!0,t.update()}),t.setTickTextStyle=r=>{e.tickTextStyle={...e.tickTextStyle,...r},t.modified()},t.setAxisTextStyle=r=>{e.axisTextStyle={...e.axisTextStyle,...r},t.modified()},t.get_tmAtlas=()=>e._tmAtlas,t.getBounds=()=>(t.update(),Er.setBounds(e.bounds,e.gridActor.getBounds()),Er.scaleAboutCenter(e.bounds,e.boundsScaleFactor,e.boundsScaleFactor,e.boundsScaleFactor),e.bounds);const n=ce.chain(t.setProperty,e.gridActor.setProperty);t.setProperty=r=>n(r)[0]}function WPe(t,e,n){return{boundsScaleFactor:1.3,camera:null,dataBounds:[...Er.INIT_BOUNDS],faceVisibilityAngle:8,gridLines:!0,axisLabels:null,axisTitlePixelOffset:35,tickLabelPixelOffset:12,generateTicks:bee,...n,axisTextStyle:{fontColor:"white",fontStyle:"normal",fontSize:18,fontFamily:"serif",...n?.axisTextStyle},tickTextStyle:{fontColor:"white",fontStyle:"normal",fontSize:14,fontFamily:"serif",...n?.tickTextStyle}}}function wee(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};o0.extend(t,e,WPe(t,e,n)),e.lastFacesToDraw=[!1,!1,!1,!1,!1,!1],e.axisLabels=["X-Axis","Y-Axis","Z-Axis"],e.tickCounts=[],e.textValues=[],e.lastTickBounds=[],e.tmCanvas=document.createElement("canvas"),e.tmContext=e.tmCanvas.getContext("2d"),e._tmAtlas=new Map,e.tmTexture=Qm.newInstance({resizable:!0}),e.tmTexture.setInterpolate(!1),t.getProperty().setDiffuse(0),t.getProperty().setAmbient(1),e.gridMapper=bc.newInstance(),e.polyData=ca.newInstance(),e.gridMapper.setInputData(e.polyData),e.gridActor=o0.newInstance(),e.gridActor.setMapper(e.gridMapper),e.gridActor.setProperty(t.getProperty()),e.gridActor.setParentProp(t),e.textPolyData=ca.newInstance(),ce.setGet(t,e,["axisTitlePixelOffset","boundsScaleFactor","faceVisibilityAngle","gridLines","tickLabelPixelOffset","generateTicks"]),ce.setGetArray(t,e,["dataBounds"],6),ce.setGetArray(t,e,["axisLabels"],3),ce.get(t,e,["axisTextStyle","tickTextStyle","camera","tmTexture","textValues","textPolyData","tickCounts","gridActor"]),zPe(t,e)}const HPe=ce.newInstance(wee,"vtkCubeAxesActor");var Cee={newInstance:HPe,extend:wee,newCubeAxesActorHelper:jPe,defaultGenerateTicks:bee};function KPe(t,e){e.classHierarchy.push("vtkOpenGLCubeAxesActor"),t.buildPass=n=>{n&&(e._openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e._openGLRenderWindow=e._openGLRenderer.getParent(),e.CubeAxesActorHelper.getRenderable()||e.CubeAxesActorHelper.setRenderable(e.renderable),t.prepareNodes(),t.addMissingNode(e.CubeAxesActorHelper.getTmActor()),t.addMissingNode(e.renderable.getGridActor()),t.removeUnusedNodes())},t.opaquePass=(n,r)=>{if(n){const i=e._openGLRenderer?e._openGLRenderer.getRenderable().getActiveCamera():null,a=e._openGLRenderer.getTiledSizeAndOrigin();e.CubeAxesActorHelper.updateAPISpecificData([a.usize,a.vsize],i,e._openGLRenderWindow.getRenderable())}}}const qPe={};function XPe(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,qPe,n),kr.extend(t,e,n),e.CubeAxesActorHelper=Cee.newCubeAxesActorHelper(),KPe(t,e)}const YPe=Qn(XPe,"vtkOpenGLCubeAxesActor");ha("vtkCubeAxesActor",YPe);const{ColorMode:JPe,ScalarMode:W0,GetArray:b8}=kC;function ZPe(t,e){e.classHierarchy.push("vtkMapper2D"),t.createDefaultLookupTable=()=>{e.lookupTable=p3.newInstance()},t.getColorModeAsString=()=>ce.enumToString(JPe,e.colorMode),t.setColorModeToDefault=()=>t.setColorMode(0),t.setColorModeToMapScalars=()=>t.setColorMode(1),t.setColorModeToDirectScalars=()=>t.setColorMode(2),t.getScalarModeAsString=()=>ce.enumToString(W0,e.scalarMode),t.setScalarModeToDefault=()=>t.setScalarMode(0),t.setScalarModeToUsePointData=()=>t.setScalarMode(1),t.setScalarModeToUseCellData=()=>t.setScalarMode(2),t.setScalarModeToUsePointFieldData=()=>t.setScalarMode(3),t.setScalarModeToUseCellFieldData=()=>t.setScalarMode(4),t.setScalarModeToUseFieldData=()=>t.setScalarMode(5),t.getAbstractScalars=(n,r,i,a,o)=>{if(!n||!e.scalarVisibility)return{scalars:null,cellFLag:!1};let s=null,l=!1;if(r===W0.DEFAULT)s=n.getPointData().getScalars(),s||(s=n.getCellData().getScalars(),l=!0);else if(r===W0.USE_POINT_DATA)s=n.getPointData().getScalars();else if(r===W0.USE_CELL_DATA)s=n.getCellData().getScalars(),l=!0;else if(r===W0.USE_POINT_FIELD_DATA){const c=n.getPointData();i===b8.BY_ID?s=c.getArrayByIndex(a):s=c.getArrayByName(o)}else if(r===W0.USE_CELL_FIELD_DATA){const c=n.getCellData();l=!0,i===b8.BY_ID?s=c.getArrayByIndex(a):s=c.getArrayByName(o)}else if(r===W0.USE_FIELD_DATA){const c=n.getFieldData();i===b8.BY_ID?s=c.getArrayByIndex(a):s=c.getArrayByName(o)}return{scalars:s,cellFlag:l}},t.getLookupTable=()=>(e.lookupTable||t.createDefaultLookupTable(),e.lookupTable),t.getMTime=()=>{let n=e.mtime;if(e.lookupTable!==null){const r=e.lookupTable.getMTime();n=r>n?r:n}return n},t.mapScalars=(n,r)=>{const i=t.getAbstractScalars(n,e.scalarMode,e.arrayAccessMode,e.arrayId,e.colorByArrayName).scalars;if(!i){e.colorMapColors=null;return}const a=`${t.getMTime()}${i.getMTime()}${r}`;if(e.colorBuildString===a)return;e.useLookupTableScalarRange||t.getLookupTable().setRange(e.scalarRange[0],e.scalarRange[1]);const o=t.getLookupTable();o&&(o.build(),e.colorMapColors=o.mapScalars(i,e.colorMode,e.fieldDataTupleId)),e.colorBuildString=`${t.getMTime()}${i.getMTime()}${r}`},t.getPrimitiveCount=()=>{const n=t.getInputData();return{points:n.getPoints().getNumberOfValues()/3,verts:n.getVerts().getNumberOfValues()-n.getVerts().getNumberOfCells(),lines:n.getLines().getNumberOfValues()-2*n.getLines().getNumberOfCells(),triangles:n.getPolys().getNumberOfValues()-3*n.getPolys().getNumberOfCells()}}}const QPe={static:!1,lookupTable:null,scalarVisibility:!1,scalarRange:[0,1],useLookupTableScalarRange:!1,colorMode:0,scalarMode:0,arrayAccessMode:1,renderTime:0,colorByArrayName:null,transformCoordinate:null,viewSpecificProperties:null,customShaderAttributes:[]};function eAe(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,QPe,n),sZ.extend(t,e,n),ce.get(t,e,["colorMapColors"]),ce.setGet(t,e,["arrayAccessMode","colorByArrayName","colorMode","lookupTable","renderTime","scalarMode","scalarVisibility","static","transformCoordinate","useLookupTableScalarRange","viewSpecificProperties","customShaderAttributes"]),ce.setGetArray(t,e,["scalarRange"],2),e.viewSpecificProperties||(e.viewSpecificProperties={}),ZPe(t,e)}ce.newInstance(eAe,"vtkMapper2D");var tAe={},nAe=`//VTK::System::Dec

/*=========================================================================

  Program:   Visualization Toolkit
  Module:    vtkPolyData2DFS.glsl

  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen
  All rights reserved.
  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.

     This software is distributed WITHOUT ANY WARRANTY; without even
     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
     PURPOSE.  See the above copyright notice for more information.

=========================================================================*/

uniform int PrimitiveIDOffset;

// Texture coordinates
//VTK::TCoord::Dec

// Scalar coloring
//VTK::Color::Dec

// Depth Peeling
//VTK::DepthPeeling::Dec

// picking support
//VTK::Picking::Dec

// the output of this shader
//VTK::Output::Dec

// Apple Bug
//VTK::PrimID::Dec

void main()
{
  // Apple Bug
  //VTK::PrimID::Impl

  //VTK::Color::Impl
  //VTK::TCoord::Impl

  //VTK::DepthPeeling::Impl
  //VTK::Picking::Impl

  if (gl_FragData[0].a <= 0.0)
    {
    discard;
    }
}
`,rAe=`//VTK::System::Dec

/*=========================================================================

  Program:   Visualization Toolkit
  Module:    vtkPolyData2DVS.glsl

  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen
  All rights reserved.
  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.

     This software is distributed WITHOUT ANY WARRANTY; without even
     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
     PURPOSE.  See the above copyright notice for more information.

=========================================================================*/

// all variables that represent positions or directions have a suffix
// indicating the coordinate system they are in. The possible values are
// MC - Model Coordinates
// WC - WC world coordinates
// VC - View Coordinates
// DC - Display Coordinates

in vec4 vertexWC;

// frag position in VC
//VTK::PositionVC::Dec

// material property values
//VTK::Color::Dec

// Texture coordinates
//VTK::TCoord::Dec

// Apple Bug
//VTK::PrimID::Dec

uniform mat4 WCVCMatrix;  // World to view matrix

void main()
{
  // Apple Bug
  //VTK::PrimID::Impl

  gl_Position = WCVCMatrix*vertexWC;

  //VTK::TCoord::Impl

  //VTK::Color::Impl

  //VTK::PositionVC::Impl
}
`;const See={BACKGROUND:0,FOREGROUND:1};var Tee={DisplayLocation:See};const{primTypes:fc}=Du,{ScalarMode:sb}=tAe,{vtkErrorMacro:lb}=wo,iAe={type:"StartEvent"},aAe={type:"EndEvent"};function oAe(t,e){e.classHierarchy.push("vtkOpenGLPolyDataMapper2D"),t.buildPass=r=>{r&&(e.openGLActor2D=t.getFirstAncestorOfType("vtkOpenGLActor2D"),e._openGLRenderer=e.openGLActor2D.getFirstAncestorOfType("vtkOpenGLRenderer"),e._openGLRenderWindow=e._openGLRenderer.getLastAncestorOfType("vtkOpenGLRenderWindow"),e.openGLCamera=e._openGLRenderer.getViewNodeFor(e._openGLRenderer.getRenderable().getActiveCamera()))},t.overlayPass=r=>{r&&t.render()},t.getShaderTemplate=(r,i,a)=>{r.Vertex=rAe,r.Fragment=nAe,r.Geometry=""},t.render=()=>{const r=e._openGLRenderWindow.getContext();if(e.context!==r){e.context=r;for(let o=fc.Start;o<fc.End;o++)e.primitives[o].setOpenGLRenderWindow(e._openGLRenderWindow)}const i=e.openGLActor2D.getRenderable(),a=e._openGLRenderer.getRenderable();t.renderPiece(a,i)},t.renderPiece=(r,i)=>{if(t.invokeEvent(iAe),e.renderable.getStatic()||e.renderable.update(),e.currentInput=e.renderable.getInputData(),t.invokeEvent(aAe),!e.currentInput){lb("No input!");return}!e.currentInput.getPoints||!e.currentInput.getPoints().getNumberOfValues()||(t.renderPieceStart(r,i),t.renderPieceDraw(r,i),t.renderPieceFinish(r,i))},t.renderPieceStart=(r,i)=>{if(e.primitiveIDOffset=0,e._openGLRenderer.getSelector())switch(e._openGLRenderer.getSelector().getCurrentPass()){default:e._openGLRenderer.getSelector().renderProp(i)}t.updateBufferObjects(r,i),e.lastBoundBO=null},t.getNeedToRebuildShaders=(r,i,a)=>r.getShaderSourceTime().getMTime()<e.renderable.getMTime()||r.getShaderSourceTime().getMTime()<e.currentInput.getMTime(),t.updateBufferObjects=(r,i)=>{t.getNeedToRebuildBufferObjects(r,i)&&t.buildBufferObjects(r,i)},t.getNeedToRebuildBufferObjects=(r,i)=>{const a=e.VBOBuildTime.getMTime();return!!(a<t.getMTime()||a<e._openGLRenderWindow.getMTime()||a<e.renderable.getMTime()||a<i.getMTime()||a<e.currentInput.getMTime()||e.renderable.getTransformCoordinate()&&a<r.getMTime())},t.buildBufferObjects=(r,i)=>{const a=e.currentInput;if(a===null)return;e.renderable.mapScalars(a,i.getProperty().getOpacity());const o=e.renderable.getColorMapColors();e.haveCellScalars=!1;const s=e.renderable.getScalarMode();e.renderable.getScalarVisibility()&&(s===sb.USE_CELL_DATA||s===sb.USE_CELL_FIELD_DATA||s===sb.USE_FIELD_DATA||!a.getPointData().getScalars())&&s!==sb.USE_POINT_FIELD_DATA&&o&&(e.haveCellScalars=!0);const l=i.getProperty().getRepresentation();let c=a.getPointData().getTCoords();e.openGLActor2D.getActiveTextures()||(c=null);const f=e.renderable.getTransformCoordinate(),d=r.getRenderWindow().getViews()[0].getViewportSize(r),h=`${a.getMTime()}A${l}B${a.getMTime()}C${o?o.getMTime():1}D${c?c.getMTime():1}E${f?r.getMTime():1}F${d}`;if(e.VBOBuildString!==h){let p=a.getPoints();if(f){const m=l3.newInstance(),y=p.getNumberOfPoints();m.setNumberOfPoints(y);const v=[];for(let x=0;x<y;++x){p.getPoint(x,v),f.setValue(v);const w=f.getComputedDoubleViewportValue(r);m.setPoint(x,w[0],w[1],0)}p=m}const g={points:p,tcoords:c,colors:o,cellOffset:0,haveCellScalars:e.haveCellSCalars,customAttributes:e.renderable.getCustomShaderAttributes().map(m=>a.getPointData().getArrayByName(m))};g.cellOffset+=e.primitives[fc.Points].getCABO().createVBO(a.getVerts(),"verts",l,g),g.cellOffset+=e.primitives[fc.Lines].getCABO().createVBO(a.getLines(),"lines",l,g),g.cellOffset+=e.primitives[fc.Tris].getCABO().createVBO(a.getPolys(),"polys",l,g),g.cellOffset+=e.primitives[fc.TriStrips].getCABO().createVBO(a.getStrips(),"strips",l,g),e.VBOBuildTime.modified(),e.VBOBuildString=h}},t.renderPieceDraw=(r,i)=>{const a=i.getProperty().getRepresentation();e.context.depthMask(!0);for(let s=fc.Start;s<fc.End;s++)e.primitives[s].getCABO().getElementCount()&&(e.lastBoundBO=e.primitives[s],e.primitiveIDOffset+=e.primitives[s].drawArrays(r,i,a,t))},t.renderPieceFinish=(r,i)=>{e.lastBoundBO&&e.lastBoundBO.getVAO().release()},t.replaceShaderValues=(r,i,a)=>{t.replaceShaderColor(r,i,a),t.replaceShaderTCoord(r,i,a),t.replaceShaderPicking(r,i,a),t.replaceShaderPositionVC(r,i,a)},t.replaceShaderColor=(r,i,a)=>{let o=r.Vertex,s=r.Geometry,l=r.Fragment;e.haveCellScalars&&(l=$e.substitute(l,"//VTK::Color::Dec",["uniform samplerBuffer texture1;"]).result,l=$e.substitute(l,"//VTK::Color::Impl",["gl_FragData[0] = texelFetchBuffer(texture1, gl_PrimitiveID + PrimitiveIDOffset);"]).result),e.lastBoundBO.getCABO().getColorComponents()!==0?(o=$e.substitute(o,"//VTK::Color::Dec",["in vec4 diffuseColor;","out vec4 fcolorVSOutput;"]).result,o=$e.substitute(o,"//VTK::Color::Impl",["fcolorVSOutput = diffuseColor;"]).result,s=$e.substitute(s,"//VTK::Color::Dec",[`in vec4 fcolorVSOutput[];
`,"out vec4 fcolorGSOutput;"]).result,s=$e.substitute(s,"//VTK::Color::Impl",["fcolorGSOutput = fcolorVSOutput[i];"]).result,l=$e.substitute(l,"//VTK::Color::Dec",["in vec4 fcolorVSOutput;"]).result,l=$e.substitute(l,"//VTK::Color::Impl",["gl_FragData[0] = fcolorVSOutput;"]).result):(l=$e.substitute(l,"//VTK::Color::Dec",["uniform vec4 diffuseColor;"]).result,l=$e.substitute(l,"//VTK::Color::Impl",["gl_FragData[0] = diffuseColor;"]).result),r.Vertex=o,r.Geometry=s,r.Fragment=l},t.replaceShaderTCoord=(r,i,a)=>{if(e.lastBoundBO.getCABO().getTCoordOffset()){let o=r.Vertex,s=r.Geometry,l=r.Fragment;const c=e.lastBoundBO.getCABO().getTCoordComponents();c===1?(o=$e.substitute(o,"//VTK::TCoord::Dec",["in float tcoordMC;","out float tcoordVCVSOutput;"]).result,o=$e.substitute(o,"//VTK::TCoord::Impl",["tcoordVCVSOutput = tcoordMC;"]).result,s=$e.substitute(s,"//VTK::TCoord::Dec",[`in float tcoordVCVSOutput[];
`,"out float tcoordVCGSOutput;"]).result,s=$e.substitute(s,["//VTK::TCoord::Impl","tcoordVCGSOutput = tcoordVCVSOutput[i];"]).result,l=$e.substitute(l,"//VTK::TCoord::Dec",["in float tcoordVCVSOutput;","uniform sampler2D texture1;"]).result,l=$e.substitute(l,"//VTK::TCoord::Impl",["gl_FragData[0] = gl_FragData[0]*texture2D(texture1, vec2(tcoordVCVSOutput,0));"]).result):c===2&&(o=$e.substitute(o,"//VTK::TCoord::Dec",["in vec2 tcoordMC;","out vec2 tcoordVCVSOutput;"]).result,o=$e.substitute(o,"//VTK::TCoord::Impl",["tcoordVCVSOutput = tcoordMC;"]).result,s=$e.substitute(s,"//VTK::TCoord::Dec",[`in vec2 tcoordVCVSOutput[];
`,"out vec2 tcoordVCGSOutput;"]).result,s=$e.substitute(s,"//VTK::TCoord::Impl",["tcoordVCGSOutput = tcoordVCVSOutput[i];"]).result,l=$e.substitute(l,"//VTK::TCoord::Dec",["in vec2 tcoordVCVSOutput;","uniform sampler2D texture1;"]).result,l=$e.substitute(l,"//VTK::TCoord::Impl",["gl_FragData[0] = gl_FragData[0]*texture2D(texture1, tcoordVCVSOutput.st);"]).result),e.haveCellScalars&&(s=$e.substitute(s,"//VTK::PrimID::Impl",["gl_PrimitiveID = gl_PrimitiveIDIn;"]).result),r.Vertex=o,r.Geometry=s,r.Fragment=l}},t.replaceShaderPicking=(r,i,a)=>{let o=r.Fragment;o=$e.substitute(o,"//VTK::Picking::Dec",["uniform vec3 mapperIndex;","uniform int picking;"]).result,o=$e.substitute(o,"//VTK::Picking::Impl","  gl_FragData[0] = picking != 0 ? vec4(mapperIndex,1.0) : gl_FragData[0];").result,r.Fragment=o},t.replaceShaderPositionVC=(r,i,a)=>{e.lastBoundBO.replaceShaderPositionVC(r,i,a)},t.invokeShaderCallbacks=(r,i,a)=>{const o=e.renderable.getViewSpecificProperties().ShadersCallbacks;o&&o.forEach(s=>{s.callback(s.userData,r,i,a)})},t.setMapperShaderParameters=(r,i,a)=>{if(r.getProgram().isUniformUsed("PrimitiveIDOffset")&&r.getProgram().setUniformi("PrimitiveIDOffset",e.primitiveIDOffset),r.getProgram().isAttributeUsed("vertexWC")&&(r.getVAO().addAttributeArray(r.getProgram(),r.getCABO(),"vertexWC",r.getCABO().getVertexOffset(),r.getCABO().getStride(),e.context.FLOAT,3,!1)||lb("Error setting vertexWC in shader VAO.")),r.getCABO().getElementCount()&&(e.VBOBuildTime.getMTime()>r.getAttributeUpdateTime().getMTime()||r.getShaderSourceTime().getMTime()>r.getAttributeUpdateTime().getMTime())){e.renderable.getCustomShaderAttributes().forEach((l,c)=>{r.getProgram().isAttributeUsed(`${l}MC`)&&(r.getVAO().addAttributeArray(r.getProgram(),r.getCABO(),`${l}MC`,r.getCABO().getCustomData()[c].offset,r.getCABO().getStride(),e.context.FLOAT,r.getCABO().getCustomData()[c].components,!1)||lb(`Error setting ${l}MC in shader VAO.`))}),r.getProgram().isAttributeUsed("tcoordMC")&&r.getCABO().getTCoordOffset()?r.getVAO().addAttributeArray(r.getProgram(),r.getCABO(),"tcoordMC",r.getCABO().getTCoordOffset(),r.getCABO().getStride(),e.context.FLOAT,r.getCABO().getTCoordComponents(),!1)||lb("Error setting tcoordMC in shader VAO."):r.getVAO().removeAttributeArray("tcoordMC"),e.internalColorTexture&&r.getProgram().isUniformUsed("texture1")&&r.getProgram().setUniformi("texture1",e.internalColorTexture.getTextureUnit());const o=e.openGLActor2D.getActiveTextures();if(o)for(let l=0;l<o.length;++l){const f=o[l].getTextureUnit(),u=`texture${f+1}`;r.getProgram().isUniformUsed(u)&&r.getProgram().setUniformi(u,f)}r.setMapperShaderParameters(i,a,e._openGLRenderer.getTiledSizeAndOrigin());const s=e._openGLRenderer.getSelector();r.getProgram().setUniform3fArray("mapperIndex",s?s.getPropColorValue():[0,0,0]),r.getProgram().setUniformi("picking",s?s.getCurrentPass()+1:0)}},t.setPropertyShaderParameters=(r,i,a)=>{const o=e.renderable.getColorMapColors();if(!o||o.getNumberOfComponents()===0){const s=r.getProgram(),l=a.getProperty(),c=l.getOpacity(),f=l.getColor(),u=[f[0],f[1],f[2],c];s.setUniform4f("diffuseColor",u)}},t.setLightingShaderParameters=(r,i,a)=>{};function n(r,i,a){return i.identity(a),r.reduce((o,s,l)=>l===0?s?i.copy(o,s):i.identity(o):s?i.multiply(o,o,s):o,a)}t.setCameraShaderParameters=(r,i,a)=>{const o=r.getProgram(),l=r.getCABO().getCoordShiftAndScaleEnabled()?r.getCABO().getInverseShiftAndScaleMatrix():null,f=i.getRenderWindow().getViews()[0].getViewportSize(i),u=i.getViewport(),d=a.getActualPositionCoordinate().getComputedDoubleViewportValue(i),h=[0,0,1,1],p=[0,0,1,1];if(p[0]=u[0]>=h[0]?u[0]:h[0],p[1]=u[1]>=h[1]?u[1]:h[1],p[2]=u[2]<=h[2]?u[2]:h[2],p[3]=u[3]<=h[3]?u[3]:h[3],p[0]>=p[2]||p[1]>=p[3])return;f[0]=Ev(f[0]*(p[2]-p[0])/(u[2]-u[0])),f[1]=Ev(f[1]*(p[3]-p[1])/(u[3]-u[1]));const g=e._openGLRenderer.getParent().getSize(),m=Ev(d[0]-(p[0]-u[0])*g[0]),y=Ev(d[1]-(p[1]-u[1])*g[1]),v=-m;let x=-m+f[0];const w=-y;let S=-y+f[1];v===x&&(x=v+1),w===S&&(S=w+1);const T=on(new Float64Array(16));T[0]=2/(x-v),T[5]=2/(S-w),T[3]=-1*(x+v)/(x-v),T[7]=-1*(S+w)/(S-w),T[10]=0,T[11]=a.getProperty().getDisplayLocation()===See.FOREGROUND?-1:1,T[15]=1,jn(T,T),o.setUniformMatrix("WCVCMatrix",n([T,l],H2,e.tmpMat4))},t.getAllocatedGPUMemoryInBytes=()=>{let r=0;return e.primitives.forEach(i=>{r+=i.getAllocatedGPUMemoryInBytes()}),r}}const sAe={context:null,VBOBuildTime:0,VBOBuildString:null,primitives:null,primTypes:null,shaderRebuildString:null};function lAe(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,sAe,n),kr.extend(t,e,n),xu.implementReplaceShaderCoincidentOffset(t,e,n),xu.implementBuildShadersWithReplacements(t,e,n),e.primitives=[],e.primTypes=fc,e.tmpMat4=on(new Float64Array(16));for(let r=fc.Start;r<fc.End;r++)e.primitives[r]=Du.newInstance(),e.primitives[r].setPrimitiveType(r),e.primitives[r].set({lastLightComplexity:0,lastLightCount:0,lastSelectionPass:!1},!0);Ni(t,e,["context"]),e.VBOBuildTime={},Wr(e.VBOBuildTime,{mtime:0}),oAe(t,e)}const cAe=Qn(lAe,"vtkOpenGLPolyDataMapper2D");ha("vtkMapper2D",cAe);const{VectorMode:uAe}=VC;function w8(t,e){t.strokeStyle=e.strokeColor,t.lineWidth=e.strokeSize,t.fillStyle=e.fontColor,t.font=`${e.fontStyle} ${e.fontSize}px ${e.fontFamily}`}function Eee(t,e){return n=>{const r=n.getLastSize(),i=(r[0]/700)**.8,a=(r[1]/700)**.8,o=Math.min(i,a),s=n.getAxisTextStyle(),l=n.getTickTextStyle();Object.assign(s,e.axisTextStyle),Object.assign(l,e.tickTextStyle),s.fontSize=Math.max(24*o,12),n.getLastAspectRatio()>1?l.fontSize=Math.max(20*o,10):l.fontSize=Math.max(16*o,10);const c=n.updateTextureAtlas();n.setTopTitle(!1);const f=n.getBoxSizeByReference();if(n.getLastAspectRatio()>1)n.setTickLabelPixelOffset(.3*l.fontSize),c.titleWidth<=c.tickWidth+n.getTickLabelPixelOffset()+.8*l.fontSize?(n.setTopTitle(!0),n.setAxisTitlePixelOffset(.2*l.fontSize),f[0]=2*(c.tickWidth+n.getTickLabelPixelOffset()+.8*l.fontSize)/r[0],n.setBoxPosition([.98-f[0],-.92])):(n.setAxisTitlePixelOffset(.2*l.fontSize),f[0]=2*(c.titleHeight+n.getAxisTitlePixelOffset()+c.tickWidth+n.getTickLabelPixelOffset()+.8*l.fontSize)/r[0],n.setBoxPosition([.99-f[0],-.92])),f[1]=Math.max(1.2,Math.min(1.84/a,1.84));else{n.setAxisTitlePixelOffset(1.2*l.fontSize),n.setTickLabelPixelOffset(.1*l.fontSize);const u=2*(.8*l.fontSize+c.titleHeight+n.getAxisTitlePixelOffset())/r[1],d=2*c.tickWidth/r[0];f[0]=Math.min(1.9,Math.max(1.4,1.4*d*(n.getTicks().length+3))),f[1]=u,n.setBoxPosition([-.5*f[0],-.97])}n.recomputeBarSegments(c)}}function _ee(t,e){return n=>{const r=n.getLastTickBounds(),i=SO().domain([r[0],r[1]]),a=i.ticks(5),o=i.tickFormat(5);n.setTicks(a),n.setTickStrings(a.map(o))}}function fAe(t,e){e.classHierarchy.push("vtkScalarBarActorHelper"),t.setRenderable=i=>{e.renderable!==i&&(e.renderable=i,e.barActor.setProperty(i.getProperty()),e.barActor.setParentProp(i),e.barActor.setCoordinateSystemToDisplay(),e.tmActor.setProperty(i.getProperty()),e.tmActor.setParentProp(i),e.tmActor.setCoordinateSystemToDisplay(),e.generateTicks=i.generateTicks,e.axisTextStyle={...i.getAxisTextStyle()},e.tickTextStyle={...i.getTickTextStyle()},t.modified())},t.updateAPISpecificData=(i,a,o)=>{(e.lastSize[0]!==i[0]||e.lastSize[1]!==i[1])&&(e.lastSize[0]=i[0],e.lastSize[1]=i[1],e.lastAspectRatio=i[0]/i[1],e.forceUpdate=!0);const s=e.renderable.getScalarsToColors();if(!(!s||!e.renderable.getVisibility())&&(e.barMapper.setLookupTable(s),e.camera=a,e.renderWindow=o,e.forceUpdate||Math.max(s.getMTime(),t.getMTime(),e.renderable.getMTime())>e.lastRebuildTime.getMTime())){const l=s.getMappingRange();if(e.lastTickBounds=[...l],e.renderable.getGenerateTicks()(t),e.renderable.getAutomated())e.renderable.getAutoLayout()(t);else{e.axisTextStyle={...e.renderable.getAxisTextStyle()},e.tickTextStyle={...e.renderable.getTickTextStyle()},e.barPosition=[...e.renderable.getBarPosition()],e.barSize=[...e.renderable.getBarSize()],e.boxPosition=[...e.renderable.getBoxPosition()],e.boxSize=[...e.renderable.getBoxSize()],e.axisTitlePixelOffset=e.renderable.getAxisTitlePixelOffset(),e.tickLabelPixelOffset=e.renderable.getTickLabelPixelOffset();const c=t.updateTextureAtlas();t.recomputeBarSegments(c)}t.updatePolyDataForLabels(),t.updatePolyDataForBarSegments(),e.lastRebuildTime.modified(),e.forceUpdate=!1}},t.updateTextureAtlas=()=>{e.tmContext.textBaseline="bottom",e.tmContext.textAlign="left";const i={},a=new Map;let o=0,s=1;w8(e.tmContext,e.axisTextStyle);let l=e.tmContext.measureText(e.renderable.getAxisLabel()),c={height:l.actualBoundingBoxAscent+2,startingHeight:s,width:l.width+2,textStyle:e.axisTextStyle};a.set(e.renderable.getAxisLabel(),c),s+=c.height,o=c.width,i.titleWidth=c.width,i.titleHeight=c.height,i.tickWidth=0,i.tickHeight=0,w8(e.tmContext,e.tickTextStyle);const f=[...t.getTickStrings(),"NaN","Below","Above"];for(let u=0;u<f.length;u++)a.has(f[u])||(l=e.tmContext.measureText(f[u]),c={height:l.actualBoundingBoxAscent+2,startingHeight:s,width:l.width+2,textStyle:e.tickTextStyle},a.set(f[u],c),s+=c.height,o<c.width&&(o=c.width),i.tickWidth<c.width&&(i.tickWidth=c.width),i.tickHeight<c.height&&(i.tickHeight=c.height));return o=Al(o),s=Al(s),a.forEach(u=>{u.tcoords=[0,(s-u.startingHeight-u.height)/s,u.width/o,(s-u.startingHeight-u.height)/s,u.width/o,(s-u.startingHeight)/s,0,(s-u.startingHeight)/s]}),e.tmCanvas.width=o,e.tmCanvas.height=s,e.tmContext.textBaseline="bottom",e.tmContext.textAlign="left",e.tmContext.clearRect(0,0,o,s),a.forEach((u,d)=>{w8(e.tmContext,u.textStyle),e.tmContext.fillText(d,1,u.startingHeight+u.height-1)}),e.tmTexture.setCanvas(e.tmCanvas),e.tmTexture.modified(),e._tmAtlas=a,i},t.computeBarSize=i=>{e.vertical=e.boxSize[1]>e.boxSize[0];const a=2*i.tickHeight/e.lastSize[1],o=[1,1];if(e.vertical){const s=2*(i.tickWidth+e.tickLabelPixelOffset)/e.lastSize[0];if(e.topTitle){const l=2*(i.titleHeight+e.axisTitlePixelOffset)/e.lastSize[1];e.barSize[0]=e.boxSize[0]-s,e.barSize[1]=e.boxSize[1]-l}else{const l=2*(i.titleHeight+e.axisTitlePixelOffset)/e.lastSize[0];e.barSize[0]=e.boxSize[0]-l-s,e.barSize[1]=e.boxSize[1]}e.barPosition[0]=e.boxPosition[0]+s,e.barPosition[1]=e.boxPosition[1],o[1]=a}else{const s=(2*i.tickWidth-8)/e.lastSize[0],l=2*(i.titleHeight+e.axisTitlePixelOffset)/e.lastSize[1];e.barSize[0]=e.boxSize[0],e.barPosition[0]=e.boxPosition[0],e.barSize[1]=e.boxSize[1]-l,e.barPosition[1]=e.boxPosition[1],o[0]=s}return o},t.recomputeBarSegments=i=>{const a=t.computeBarSize(i);e.barSegments=[];const o=[0,0],s=e.vertical?1:0,l=e.vertical?.01:.02;function c(d,h){e.barSegments.push({corners:[[...o],[o[0]+a[0],o[1]],[o[0]+a[0],o[1]+a[1]],[o[0],o[1]+a[1]]],scalars:h,title:d}),o[s]+=a[s]+l}e.renderable.getDrawNanAnnotation()&&e.renderable.getScalarsToColors().getNanColor()&&c("NaN",[NaN,NaN,NaN,NaN]),e.renderable.getDrawBelowRangeSwatch()&&e.renderable.getScalarsToColors().getUseBelowRangeColor?.()&&c("Below",[-.1,-.1,-.1,-.1]);const f=e.renderable.getScalarsToColors().getUseAboveRangeColor?.();o[s]+=l;const u=a[s];a[s]=f?1-2*l-a[s]-o[s]:1-l-o[s],c("ticks",e.vertical?[0,0,.995,.995]:[0,.995,.995,0]),e.renderable.getDrawAboveRangeSwatch()&&f&&(a[s]=u,o[s]+=l,c("Above",[1.1,1.1,1.1,1.1]))};const n=new Float64Array(3);t.createPolyDataForOneLabel=(i,a,o,s,l,c)=>{const f=e._tmAtlas.get(i);if(!f)return;let u=c.ptIdx,d=c.cellIdx;n[0]=(.5*a[0]+.5)*e.lastSize[0],n[1]=(.5*a[1]+.5)*e.lastSize[1],n[2]=a[2],n[0]+=l[0],n[1]+=l[1];const h=[],p=s==="vertical"?[1,0]:[0,1];s==="vertical"?(h[0]=f.width,h[1]=-f.height,o[0]==="middle"?n[1]-=f.width/2:o[0]==="right"&&(n[1]-=f.width),o[1]==="middle"?n[0]+=f.height/2:o[1]==="top"&&(n[0]+=f.height)):(h[0]=f.width,h[1]=f.height,o[0]==="middle"?n[0]-=f.width/2:o[0]==="right"&&(n[0]-=f.width),o[1]==="middle"?n[1]-=f.height/2:o[1]==="top"&&(n[1]-=f.height)),c.points[u*3]=n[0],c.points[u*3+1]=n[1],c.points[u*3+2]=n[2],c.tcoords[u*2]=f.tcoords[0],c.tcoords[u*2+1]=f.tcoords[1],u++,n[p[0]]+=h[0],c.points[u*3]=n[0],c.points[u*3+1]=n[1],c.points[u*3+2]=n[2],c.tcoords[u*2]=f.tcoords[2],c.tcoords[u*2+1]=f.tcoords[3],u++,n[p[1]]+=h[1],c.points[u*3]=n[0],c.points[u*3+1]=n[1],c.points[u*3+2]=n[2],c.tcoords[u*2]=f.tcoords[4],c.tcoords[u*2+1]=f.tcoords[5],u++,n[p[0]]-=h[0],c.points[u*3]=n[0],c.points[u*3+1]=n[1],c.points[u*3+2]=n[2],c.tcoords[u*2]=f.tcoords[6],c.tcoords[u*2+1]=f.tcoords[7],u++,c.polys[d*4]=3,c.polys[d*4+1]=u-4,c.polys[d*4+2]=u-3,c.polys[d*4+3]=u-2,d++,c.polys[d*4]=3,c.polys[d*4+1]=u-4,c.polys[d*4+2]=u-2,c.polys[d*4+3]=u-1,c.ptIdx+=4,c.cellIdx+=2};const r=new Float64Array(3);t.updatePolyDataForLabels=()=>{const i=t.getTickStrings().length+e.barSegments.length,a=i*4,o=i*2,s=new Float64Array(a*3),l=new Uint16Array(o*4),c=new Float32Array(a*2),f={ptIdx:0,cellIdx:0,polys:l,points:s,tcoords:c},u=e.vertical?0:1,d=e.vertical?1:0;r[2]=-.99;const h=e.vertical?["right","middle"]:["middle","bottom"];let p=[0,1];const g=[0,0];e.vertical?(g[0]=-e.tickLabelPixelOffset,e.topTitle?(r[0]=e.boxPosition[0]+.5*e.boxSize[0],r[1]=e.barPosition[1]+e.barSize[1],t.createPolyDataForOneLabel(e.renderable.getAxisLabel(),r,["middle","bottom"],"horizontal",[0,e.axisTitlePixelOffset],f)):(r[0]=e.barPosition[0]+e.barSize[0],r[1]=e.barPosition[1]+.5*e.barSize[1],t.createPolyDataForOneLabel(e.renderable.getAxisLabel(),r,["middle","top"],"vertical",[e.axisTitlePixelOffset,0],f)),p=[-1,0]):(g[1]=e.tickLabelPixelOffset,r[0]=e.barPosition[0]+.5*e.barSize[0],r[1]=e.barPosition[1]+e.barSize[1],t.createPolyDataForOneLabel(e.renderable.getAxisLabel(),r,["middle","bottom"],"horizontal",[0,e.axisTitlePixelOffset],f)),r[u]=e.barPosition[u]+(.5*p[u]+.5)*e.barSize[u],r[d]=e.barPosition[d]+e.barSize[d]*.5;let m=null;for(let T=0;T<e.barSegments.length;T++){const _=e.barSegments[T];_.title==="ticks"?m=_:(r[d]=e.barPosition[d]+.5*e.barSize[d]*(_.corners[2][d]+_.corners[0][d]),t.createPolyDataForOneLabel(_.title,r,h,"horizontal",g,f))}const y=e.barPosition[d]+e.barSize[d]*m.corners[0][d],v=e.barSize[d]*(m.corners[2][d]-m.corners[0][d]),x=t.getTicks(),w=t.getTickStrings();for(let T=0;T<x.length;T++){const _=(x[T]-e.lastTickBounds[0])/(e.lastTickBounds[1]-e.lastTickBounds[0]);r[d]=y+v*_,t.createPolyDataForOneLabel(w[T],r,h,"horizontal",g,f)}const S=tn.newInstance({numberOfComponents:2,values:c,name:"TextureCoordinates"});e.tmPolyData.getPointData().setTCoords(S),e.tmPolyData.getPoints().setData(s,3),e.tmPolyData.getPoints().modified(),e.tmPolyData.getPolys().setData(l,1),e.tmPolyData.getPolys().modified(),e.tmPolyData.modified()},t.updatePolyDataForBarSegments=()=>{const i=e.renderable.getScalarsToColors();let a=0;e.renderable.getDrawNanAnnotation()&&i.getNanColor()&&(a+=1),e.renderable.getDrawBelowRangeSwatch()&&i.getUseBelowRangeColor?.()&&(a+=1),e.renderable.getDrawAboveRangeSwatch()&&i.getUseAboveRangeColor?.()&&(a+=1);const o=4*(1+a),s=o;let l=1;i.getVectorMode()===uAe.COMPONENT&&(l=i.getVectorComponent()+1);const c=new Float64Array(o*3),f=new Uint16Array(s*5),u=new Float32Array(o*l);let d=0,h=0;for(let g=0;g<e.barSegments.length;g++){const m=e.barSegments[g];for(let y=0;y<4;y++){r[0]=e.barPosition[0]+m.corners[y][0]*e.barSize[0],r[1]=e.barPosition[1]+m.corners[y][1]*e.barSize[1],c[d*3]=(.5*r[0]+.5)*e.lastSize[0],c[d*3+1]=(.5*r[1]+.5)*e.lastSize[1],c[d*3+2]=r[2];for(let v=0;v<l;v++)u[d*l+v]=e.lastTickBounds[0]+m.scalars[y]*(e.lastTickBounds[1]-e.lastTickBounds[0]);d++}f[h*5]=4,f[h*5+1]=d-4,f[h*5+2]=d-3,f[h*5+3]=d-2,f[h*5+4]=d-1,h++}const p=tn.newInstance({numberOfComponents:l,values:u,name:"Scalars"});e.polyData.getPointData().setScalars(p),e.polyData.getPoints().setData(c,3),e.polyData.getPoints().modified(),e.polyData.getPolys().setData(f,1),e.polyData.getPolys().modified(),e.polyData.modified()}}const dAe=ce.newInstance(function(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{renderable:null};Object.assign(e,{},n),ce.obj(t,e),ce.setGet(t,e,["axisTitlePixelOffset","tickLabelPixelOffset","renderable","topTitle","ticks","tickStrings"]),ce.get(t,e,["lastSize","lastAspectRatio","lastTickBounds","axisTextStyle","tickTextStyle","barActor","tmActor"]),ce.getArray(t,e,["boxPosition","boxSize"]),ce.setArray(t,e,["boxPosition","boxSize"],2),e.forceUpdate=!1,e.lastRebuildTime={},ce.obj(e.lastRebuildTime,{mtime:0}),e.lastSize=[-1,-1],e.tmCanvas=document.createElement("canvas"),e.tmContext=e.tmCanvas.getContext("2d"),e._tmAtlas=new Map,e.barMapper=bc.newInstance(),e.barMapper.setInterpolateScalarsBeforeMapping(!0),e.barMapper.setUseLookupTableScalarRange(!0),e.polyData=ca.newInstance(),e.barMapper.setInputData(e.polyData),e.barActor=o0.newInstance(),e.barActor.setMapper(e.barMapper),e.tmPolyData=ca.newInstance(),e.tmMapper=bc.newInstance(),e.tmMapper.setInputData(e.tmPolyData),e.tmTexture=Qm.newInstance({resizable:!0}),e.tmTexture.setInterpolate(!1),e.tmActor=o0.newInstance({parentProp:t}),e.tmActor.setMapper(e.tmMapper),e.tmActor.addTexture(e.tmTexture),e.barPosition=[0,0],e.barSize=[0,0],e.boxPosition=[.88,-.92],e.boxSize=[.1,1.1],e.lastTickBounds=[],fAe(t,e)},"vtkScalarBarActorHelper");function hAe(t,e){e.classHierarchy.push("vtkScalarBarActor"),t.setTickTextStyle=n=>{e.tickTextStyle={...e.tickTextStyle,...n},t.modified()},t.setAxisTextStyle=n=>{e.axisTextStyle={...e.axisTextStyle,...n},t.modified()},t.resetAutoLayoutToDefault=()=>{t.setAutoLayout(Eee(t,e))},t.resetGenerateTicksToDefault=()=>{t.setGenerateTicks(_ee())}}function pAe(t){return{automated:!0,autoLayout:null,axisLabel:"Scalar Value",barPosition:[0,0],barSize:[0,0],boxPosition:[.88,-.92],boxSize:[.1,1.1],scalarToColors:null,axisTitlePixelOffset:36,axisTextStyle:{fontColor:"white",fontStyle:"normal",fontSize:18,fontFamily:"serif"},tickLabelPixelOffset:14,tickTextStyle:{fontColor:"white",fontStyle:"normal",fontSize:14,fontFamily:"serif"},generateTicks:null,drawNanAnnotation:!0,drawBelowRangeSwatch:!0,drawAboveRangeSwatch:!0,...t}}function Dee(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,pAe(n)),e.autoLayout||(e.autoLayout=Eee(t,e)),e.generateTicks||(e.generateTicks=_ee()),o0.extend(t,e,n),t.getProperty().setDiffuse(0),t.getProperty().setAmbient(1),ce.setGet(t,e,["automated","autoLayout","axisTitlePixelOffset","axisLabel","scalarsToColors","tickLabelPixelOffset","generateTicks","drawNanAnnotation","drawBelowRangeSwatch","drawAboveRangeSwatch"]),ce.get(t,e,["axisTextStyle","tickTextStyle"]),ce.getArray(t,e,["barPosition","barSize","boxPosition","boxSize"]),ce.setArray(t,e,["barPosition","barSize","boxPosition","boxSize"],2),hAe(t,e)}const gAe=ce.newInstance(Dee,"vtkScalarBarActor");var Oee={newInstance:gAe,extend:Dee,newScalarBarActorHelper:dAe};function mAe(t,e){e.classHierarchy.push("vtkOpenGLScalarBarActor"),t.buildPass=n=>{n&&(e._openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e._openGLRenderWindow=e._openGLRenderer.getParent(),e.scalarBarActorHelper.getRenderable()||e.scalarBarActorHelper.setRenderable(e.renderable),t.prepareNodes(),t.addMissingNode(e.scalarBarActorHelper.getBarActor()),t.addMissingNode(e.scalarBarActorHelper.getTmActor()),t.removeUnusedNodes())},t.opaquePass=(n,r)=>{if(n){const i=e._openGLRenderer?e._openGLRenderer.getRenderable().getActiveCamera():null,a=e._openGLRenderer.getTiledSizeAndOrigin();e.scalarBarActorHelper.updateAPISpecificData([a.usize,a.vsize],i,e._openGLRenderWindow.getRenderable())}}}const vAe={};function yAe(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,vAe,n),kr.extend(t,e,n),e.scalarBarActorHelper=Oee.newScalarBarActorHelper(),mAe(t,e)}const xAe=Qn(yAe,"vtkOpenGLScalarBarActor");ha("vtkScalarBarActor",xAe);const{CoordinateSystem:GF}=Ny;function bAe(t,e){e.classHierarchy.push("vtkWebGPUActor"),t.buildPass=n=>{n&&(e.WebGPURenderer=t.getFirstAncestorOfType("vtkWebGPURenderer"),e.WebGPURenderWindow=e.WebGPURenderer.getFirstAncestorOfType("vtkWebGPURenderWindow"),e.propID===void 0&&(e.propID=e.WebGPURenderWindow.getUniquePropID()),t.prepareNodes(),t.addMissingNode(e.renderable.getMapper()),t.removeUnusedNodes())},t.traverseOpaquePass=n=>{!e.renderable||!e.renderable.getNestedVisibility()||!e.renderable.getIsOpaque()||e.WebGPURenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(n,!0),e.children[0]&&e.children[0].traverse(n),t.apply(n,!1))},t.traverseTranslucentPass=n=>{!e.renderable||!e.renderable.getNestedVisibility()||e.renderable.getIsOpaque()||e.WebGPURenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(n,!0),e.children[0]&&e.children[0].traverse(n),t.apply(n,!1))},t.queryPass=(n,r)=>{if(n){if(!e.renderable||!e.renderable.getVisibility())return;e.renderable.getIsOpaque()?r.incrementOpaqueActorCount():r.incrementTranslucentActorCount()}},t.getBufferShift=n=>(t.getKeyMatrices(n),e.bufferShift),t.getKeyMatrices=n=>{if(Math.max(e.renderable.getMTime(),n.getStabilizedTime())>e.keyMatricesTime.getMTime()){e.renderable.computeMatrix();const r=e.renderable.getMatrix();e.bufferShift[0]=r[3],e.bufferShift[1]=r[7],e.bufferShift[2]=r[11];const i=n.getStabilizedCenterByReference();e.renderable.getCoordinateSystem()===GF.WORLD&&(e.bufferShift[0]-=i[0],e.bufferShift[1]-=i[1],e.bufferShift[2]-=i[2]),jn(e.keyMatrices.bcwc,r),e.renderable.getIsIdentity()?on(e.keyMatrices.normalMatrix):(Ri(e.keyMatrices.normalMatrix,e.keyMatrices.bcwc),e.keyMatrices.normalMatrix[3]=0,e.keyMatrices.normalMatrix[7]=0,e.keyMatrices.normalMatrix[11]=0,Ea(e.keyMatrices.normalMatrix,e.keyMatrices.normalMatrix),jn(e.keyMatrices.normalMatrix,e.keyMatrices.normalMatrix)),di(e.keyMatrices.bcwc,e.keyMatrices.bcwc,[-e.bufferShift[0],-e.bufferShift[1],-e.bufferShift[2]]),e.renderable.getCoordinateSystem()===GF.WORLD?di(e.keyMatrices.bcsc,e.keyMatrices.bcwc,[-i[0],-i[1],-i[2]]):Ri(e.keyMatrices.bcsc,e.keyMatrices.bcwc),e.keyMatricesTime.modified()}return e.keyMatrices}}const wAe={keyMatricesTime:null,keyMatrices:null,propID:void 0,bufferShift:void 0};function CAe(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,wAe,n),kr.extend(t,e,n),e.keyMatricesTime={},ce.obj(e.keyMatricesTime,{mtime:0}),e.keyMatrices={normalMatrix:new Float64Array(16),bcwc:new Float64Array(16),bcsc:new Float64Array(16)},ce.get(t,e,["propID","keyMatricesTime"]),e.bufferShift=[0,0,0,0],bAe(t,e)}const SAe=ce.newInstance(CAe);zl("vtkActor",SAe);const{CoordinateSystem:jF}=Ny;function TAe(t,e){e.classHierarchy.push("vtkWebGPUActor2D"),t.buildPass=n=>{n&&(e.WebGPURenderer=t.getFirstAncestorOfType("vtkWebGPURenderer"),e.WebGPURenderWindow=e.WebGPURenderer.getFirstAncestorOfType("vtkWebGPURenderWindow"),e.propID===void 0&&(e.propID=e.WebGPURenderWindow.getUniquePropID()),t.prepareNodes(),t.addMissingNode(e.renderable.getMapper()),t.removeUnusedNodes())},t.traverseOpaquePass=n=>{!e.renderable||!e.renderable.getNestedVisibility()||!e.renderable.getIsOpaque()||e.WebGPURenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(n,!0),e.children[0]&&e.children[0].traverse(n),t.apply(n,!1))},t.traverseTranslucentPass=n=>{!e.renderable||!e.renderable.getNestedVisibility()||e.renderable.getIsOpaque()||e.WebGPURenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(n,!0),e.children[0]&&e.children[0].traverse(n),t.apply(n,!1))},t.queryPass=(n,r)=>{if(n){if(!e.renderable||!e.renderable.getVisibility())return;e.renderable.getIsOpaque()?r.incrementOpaqueActorCount():r.incrementTranslucentActorCount()}},t.getBufferShift=n=>(t.getKeyMatrices(n),e.bufferShift),t.getKeyMatrices=n=>{if(Math.max(e.renderable.getMTime(),n.getStabilizedTime())>e.keyMatricesTime.getMTime()){e.bufferShift[0]=0,e.bufferShift[1]=0,e.bufferShift[2]=0;const r=n.getStabilizedCenterByReference();e.renderable.getCoordinateSystem()===jF.WORLD&&(e.bufferShift[0]-=r[0],e.bufferShift[1]-=r[1],e.bufferShift[2]-=r[2]),on(e.keyMatrices.bcwc),on(e.keyMatrices.normalMatrix),di(e.keyMatrices.bcwc,e.keyMatrices.bcwc,[-e.bufferShift[0],-e.bufferShift[1],-e.bufferShift[2]]),e.renderable.getCoordinateSystem()===jF.WORLD?di(e.keyMatrices.bcsc,e.keyMatrices.bcwc,[-r[0],-r[1],-r[2]]):Ri(e.keyMatrices.bcsc,e.keyMatrices.bcwc),e.keyMatricesTime.modified()}return e.keyMatrices}}const EAe={keyMatricesTime:null,keyMatrices:null,propID:void 0,bufferShift:void 0};function _Ae(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,EAe,n),kr.extend(t,e,n),e.keyMatricesTime={},ce.obj(e.keyMatricesTime,{mtime:0}),e.keyMatrices={normalMatrix:new Float64Array(16),bcwc:new Float64Array(16),bcsc:new Float64Array(16)},ce.get(t,e,["propID","keyMatricesTime"]),e.bufferShift=[0,0,0,0],TAe(t,e)}const DAe=ce.newInstance(_Ae);zl("vtkActor2D",DAe);function OAe(t,e){e.classHierarchy.push("vtkWebGPUCubeAxesActor"),t.buildPass=n=>{n&&(e.WebGPURenderer=t.getFirstAncestorOfType("vtkWebGPURenderer"),e.WebGPURenderWindow=e.WebGPURenderer.getParent(),e.CubeAxesActorHelper.getRenderable()||e.CubeAxesActorHelper.setRenderable(e.renderable),t.prepareNodes(),t.addMissingNode(e.CubeAxesActorHelper.getTmActor()),t.addMissingNode(e.renderable.getGridActor()),t.removeUnusedNodes())},t.opaquePass=(n,r)=>{if(n){const i=e.WebGPURenderer?e.WebGPURenderer.getRenderable().getActiveCamera():null,a=e.WebGPURenderer.getTiledSizeAndOrigin();e.CubeAxesActorHelper.updateAPISpecificData([a.usize,a.vsize],i,e.WebGPURenderWindow.getRenderable())}}}const MAe={};function IAe(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,MAe,n),kr.extend(t,e,n),e.CubeAxesActorHelper=Cee.newCubeAxesActorHelper(),OAe(t,e)}const RAe=Qn(IAe,"vtkWebGPUCubeAxesActor");zl("vtkCubeAxesActor",RAe);const{DisplayLocation:n9}=Tee;function PAe(t,e){e.classHierarchy.push("vtkProperty2D"),t.setDisplayLocationToBackground=()=>t.setDisplayLocation(n9.BACKGROUND),t.setDisplayLocationToForeground=()=>t.setDisplayLocation(n9.FOREGROUND),t.setRepresentationToWireframe=()=>t.setRepresentation(go.WIREFRAME),t.setRepresentationToSurface=()=>t.setRepresentation(go.SURFACE),t.setRepresentationToPoints=()=>t.setRepresentation(go.POINTS),t.getRepresentationAsString=()=>ce.enumToString(go,e.representation)}const AAe={color:[1,1,1],opacity:1,pointSize:1,lineWidth:1,representation:go.SURFACE,displayLocation:n9.FOREGROUND};function NAe(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,AAe,n),ce.obj(t,e),ce.setGet(t,e,["opacity","lineWidth","pointSize","displayLocation","representation"]),ce.setGetArray(t,e,["color"],3),PAe(t,e)}ce.newInstance(NAe,"vtkProperty2D");var LAe={...Tee};const{BufferUsage:Xa,PrimitiveTypes:Yo}=Wm,{Representation:cb}=Yh,{ScalarMode:ub}=bc,{CoordinateSystem:kAe}=Ny,{DisplayLocation:VAe}=LAe,FAe=`
//VTK::Renderer::Dec

//VTK::Color::Dec

//VTK::Normal::Dec

//VTK::TCoord::Dec

//VTK::Select::Dec

//VTK::Mapper::Dec

//VTK::IOStructs::Dec

@vertex
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var output : vertexOutput;

  var vertex: vec4<f32> = vertexBC;

  //VTK::Color::Impl

  //VTK::Normal::Impl

  //VTK::TCoord::Impl

  //VTK::Select::Impl

  //VTK::Position::Impl

  return output;
}
`,UAe=`
struct PBRData {
  diffuse: vec3<f32>,
  specular: vec3<f32>,
}

// Dot product with the max already in it
fn mdot(a: vec3<f32>, b: vec3<f32>) -> f32 {
  return max(0.0, dot(a, b));
}
// Dot product with a max in it that does not allow for negative values
// Physically based rendering is accurate as long as normals are accurate,
// however this is pretty often not the case. In order to prevent negative
// values from ruining light calculations and creating zones of zero light,
// this remapping is used, which smoothly clamps the dot product between
// zero and one while still maintaining a good amount of accuracy.
fn cdot(a: vec3<f32>, b: vec3<f32>) -> f32 {
  var d: f32 = max(0.0, dot(a, b));
  d = pow((d + 1.0) / 2.0, 2.6);
  return d;
}

// Lambertian diffuse model
fn lambertDiffuse(base: vec3<f32>, N: vec3<f32>, L: vec3<f32>) -> vec3<f32> {
  var pi: f32 = 3.14159265359; 
  var NdotL: f32 = mdot(N, L);
  NdotL = pow(NdotL, 1.5);
  return (base/pi)*NdotL;
}

// Yasuhiro Fujii improvement on the Oren-Nayar model
// https://mimosa-pudica.net/improved-oren-nayar.html
// p is surface color, o is roughness
fn fujiiOrenNayar(p: vec3<f32>, o: f32, N: vec3<f32>, L: vec3<f32>, V: vec3<f32>) -> vec3<f32> {
  var invpi: f32 = 0.31830988618; // 1/pi

  var o2 = o*o;
  var NdotL: f32 = mdot(N, L);
  NdotL = pow(NdotL, 1.5); // Less physically accurate, but hides the "seams" between lights better

  var NdotV: f32 = mdot(N, V);
  var LdotV: f32 = mdot(L, V);

  var s: f32 = LdotV - NdotL*NdotV;
  var t: f32 = mix(1.0, max(NdotL, NdotV), step(0.0, s)); // Mix with step is the equivalent of an if statement
  var A: vec3<f32> = 0.5*(o2 / (o2 + 0.33)) + 0.17*p*(o2 / (o2 + 0.13));
  A = invpi*(1 - A);
  var B: f32 = 0.45*(o2 / (o2 + 0.09));
  B = invpi*B;

  return p*NdotL*(A + B*(s/t));
}

// Fresnel portion of BRDF (IOR only, simplified)
fn schlickFresnelIOR(V: vec3<f32>, N: vec3<f32>, ior: f32, k: f32) -> f32 {
  var NdotV: f32 = mdot(V, N);
  var F0: f32 = (pow((ior - 1.0), 2.0) + k*k) / (pow((ior + 1.0), 2.0) + k*k); // This takes into account the roughness, which the other one does not
  return F0 + (1.0 - F0) * pow((1.0-NdotV), 5.0);
}

// Fresnel portion of BRDF (Color ior, better)
fn schlickFresnelRGB(V: vec3<f32>, N: vec3<f32>, F0: vec3<f32>) -> vec3<f32> {
  var NdotV: f32 = mdot(V, N);
  return F0 + (1.0 - F0) * pow((1-NdotV), 5.0);
}

// Normal portion of BRDF
// https://learnopengl.com/PBR/Theory
// Trowbridge-Reitz GGX functions: normal, halfway, roughness^2
fn trGGX(N: vec3<f32>, H: vec3<f32>, a: f32) -> f32 {
  var pi: f32 = 3.14159265359; 

  var a2: f32 = a*a;
  var NdotH = mdot(N, H);
  var NdotH2 = NdotH*NdotH;
  
  var denom: f32 = NdotH2 * (a2 - 1.0) + 1.0;

  return a2 / max((pi*denom*denom), 0.000001);
}

// A VERY bad approximation of anisotropy. Real anisotropic calculations require tangent and bitangent
fn anisotrophicTrGGX(N: vec3<f32>, H: vec3<f32>, O: vec3<f32>, s: f32, a: f32) -> f32 {
  var Op: vec3<f32> = (rendererUBO.WCVCNormals * vec4<f32>(normalize(O) * s, 0.)).xyz;

  var ggx1: f32 = trGGX(N + Op*s, H, a);
  var ggx2: f32 = trGGX(N - Op*s, H, a);
  return (0.5 * ggx1 + 0.5 * ggx2);
}

// Geometry portion of BRDF
fn schlickGGX(N: vec3<f32>, X: vec3<f32>, k: f32) -> f32 {
  var NdotX = cdot(N, X);
  return NdotX / max(0.000001, (NdotX*(1.0-k) + k));
}

fn smithSurfaceRoughness(N: vec3<f32>, V: vec3<f32>, L: vec3<f32>, k: f32) -> f32 {
  var ggx1: f32 = min(1.0, schlickGGX(N, V, k));
  var ggx2: f32 = min(1.0, schlickGGX(N, L, k));
  return ggx1*ggx2;
}

// BRDF Combination
fn cookTorrance(D: f32, F: f32, G: f32, N: vec3<f32>, V: vec3<f32>, L: vec3<f32>) -> f32 {
  var num: f32 = D*F*G;
  var denom: f32 = 4*cdot(V, N)*cdot(L, N);

  return num / max(denom, 0.000001);
}

// Different lighting calculations for different light sources
fn calcDirectionalLight(N: vec3<f32>, V: vec3<f32>, ior: f32, roughness: f32, metallic: f32, direction: vec3<f32>, color: vec3<f32>, base: vec3<f32>) -> PBRData {  
  var L: vec3<f32> = normalize(direction); // Light Vector
  var H: vec3<f32> = normalize(L + V); // Halfway Vector

  var alpha = roughness*roughness;
  var k: f32 = alpha*alpha / 2;

  var D: f32 = trGGX(N, H, alpha); // Distribution
  // var F: f32 = schlickFresnelIOR(V, N, ior, k); // Fresnel
  var G: f32 = smithSurfaceRoughness(N, V, L, k); // Geometry

  var brdf: f32 = cookTorrance(D, 1.0, G, N, V, L); // Fresnel term is replaced with 1 because it is added later
  var incoming: vec3<f32> = color;
  var angle: f32 = mdot(L, N);
  angle = pow(angle, 1.5);

  var specular: vec3<f32> = brdf*incoming*angle;
  // Oren-Nayar gives a clay-like effect when fully rough which some people may not want, so it might be better to give a separate
  // control property for the diffuse vs specular roughness
  var diffuse: vec3<f32> = incoming*fujiiOrenNayar(base, roughness, N, L, V); 
  // Stores the specular and diffuse separately to allow for finer post processing
  var out = PBRData(diffuse, specular);
  
  return out; // Returns angle along with color of light so the final color can be multiplied by angle as well (creates black areas)
}

// TODO: find some way to reduce the number of arguments going in here
fn calcPointLight(N: vec3<f32>, V: vec3<f32>, fragPos: vec3<f32>, ior: f32, roughness: f32, metallic: f32, position: vec3<f32>, color: vec3<f32>, base: vec3<f32>) -> PBRData {
  var L: vec3<f32> = normalize(position - fragPos); // Light Vector
  var H: vec3<f32> = normalize(L + V); // Halfway Vector
  var dist = distance(position, fragPos);

  var alpha = roughness*roughness;
  var k: f32 = alpha*alpha / 2.0; // could also be pow(alpha + 1.0, 2) / 8

  var D: f32 = trGGX(N, H, alpha); // Distribution
  // var F: f32 = schlickFresnelIOR(V, N, ior, k); // Fresnel
  var G: f32 = smithSurfaceRoughness(N, V, L, k); // Geometry

  var brdf: f32 = cookTorrance(D, 1.0, G, N, V, L);
  var incoming: vec3<f32> = color * (1.0 / (dist*dist));
  var angle: f32 = mdot(L, N);
  angle = pow(angle, 1.5); // Smoothing factor makes it less accurate, but reduces ugly "seams" bewteen light sources

  var specular: vec3<f32> = brdf*incoming*angle;
  var diffuse: vec3<f32> = incoming*fujiiOrenNayar(base, roughness, N, L, V);

  // Stores the specular and diffuse separately to allow for finer post processing
  // Could also be done (propably more properly) with a struct
  var out = PBRData(diffuse, specular);
  
  return out; // Returns angle along with color of light so the final color can be multiplied by angle as well (creates black areas)
}

// For a reason unknown to me, spheres dont seem to behave propperly with head-on spot lights
fn calcSpotLight(N: vec3<f32>, V: vec3<f32>, fragPos: vec3<f32>, ior: f32, roughness: f32, metallic: f32, position: vec3<f32>, direction: vec3<f32>, cones: vec2<f32>, color: vec3<f32>, base: vec3<f32>) -> PBRData {
  var L: vec3<f32> = normalize(position - fragPos);
  var H: vec3<f32> = normalize(L + V); // Halfway Vector
  var dist = distance(position, fragPos);

  var alpha = roughness*roughness;
  var k: f32 = alpha*alpha / 2.0; // could also be pow(alpha + 1.0, 2) / 8

  var D: f32 = trGGX(N, H, alpha); // Distribution
  // var F: f32 = schlickFresnelIOR(V, N, ior, k); // Fresnel
  var G: f32 = smithSurfaceRoughness(N, V, L, k); // Geometry

  var brdf: f32 = cookTorrance(D, 1.0, G, N, V, L);
  
  // Cones.x is the inner phi and cones.y is the outer phi
  var theta: f32 = mdot(normalize(direction), L);
  var epsilon: f32 = cones.x - cones.y;
  var intensity: f32 = (theta - cones.y) / epsilon;
  intensity = clamp(intensity, 0.0, 1.0);
  intensity /= dist*dist;

  var incoming: vec3<f32> = color * intensity;

  var angle: f32 = mdot(L, N);
  angle = pow(angle, 1.5); // Smoothing factor makes it less accurate, but reduces ugly "seams" bewteen light sources

  var specular: vec3<f32> = brdf*incoming*angle;
  var diffuse: vec3<f32> = incoming*fujiiOrenNayar(base, roughness, N, L, V);

  // Stores the specular and diffuse separately to allow for finer post processing
  // Could also be done (propably more properly) with a struct
  var out = PBRData(diffuse, specular);
  
  return out; // Returns angle along with color of light so the final color can be multiplied by angle as well (creates black areas)
}

// Environment mapping stuff
// Takes in a vector and converts it to an equivalent coordinate in a rectilinear texture. Should be replaced with cubemaps at some point
fn vecToRectCoord(dir: vec3<f32>) -> vec2<f32> {
  var tau: f32 = 6.28318530718;
  var pi: f32 = 3.14159265359;
  var out: vec2<f32> = vec2<f32>(0.0);

  out.x = atan2(dir.z, dir.x) / tau;
  out.x += 0.5;

  var phix: f32 = length(vec2(dir.x, dir.z));
  out.y = atan2(dir.y, phix) / pi + 0.5;

  return out;
}

//VTK::Renderer::Dec

//VTK::Color::Dec

//VTK::TCoord::Dec

// optional surface normal declaration
//VTK::Normal::Dec

//VTK::Select::Dec

//VTK::RenderEncoder::Dec

//VTK::Mapper::Dec

//VTK::IOStructs::Dec

@fragment
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var output : fragmentOutput;

  // Temporary ambient, diffuse, and opacity
  var ambientColor: vec4<f32> = mapperUBO.AmbientColor;
  var diffuseColor: vec4<f32> = mapperUBO.DiffuseColor;
  var opacity: f32 = mapperUBO.Opacity;

  // This should be declared somewhere else
  var _diffuseMap: vec4<f32> = vec4<f32>(1.0);
  var _roughnessMap: vec4<f32> = vec4<f32>(1.0);
  var _metallicMap: vec4<f32> = vec4<f32>(1.0);
  var _normalMap: vec4<f32> = vec4<f32>(0.0, 0.0, 1.0, 0.0); // normal map was setting off the normal vector detection in fragment
  var _ambientOcclusionMap: vec4<f32> = vec4<f32>(1.);
  var _emissionMap: vec4<f32> = vec4<f32>(0.);

  //VTK::Color::Impl

  //VTK::TCoord::Impl

  //VTK::Normal::Impl

  var computedColor: vec4<f32> = vec4<f32>(diffuseColor.rgb, 1.0);

  //VTK::Light::Impl

  //VTK::Select::Impl

  if (computedColor.a == 0.0) { discard; };

  //VTK::Position::Impl

  //VTK::RenderEncoder::Impl

  return output;
}
`;function zF(t){return t.indexOf("edge")>=0}function BAe(t,e){e.classHierarchy.push("vtkWebGPUCellArrayMapper"),t.buildPass=n=>{n&&(e.is2D?(e.WebGPUActor=t.getFirstAncestorOfType("vtkWebGPUActor2D"),e.forceZValue=!0):(e.WebGPUActor=t.getFirstAncestorOfType("vtkWebGPUActor"),e.forceZValue=!1),e.coordinateSystem=e.WebGPUActor.getRenderable().getCoordinateSystem(),e.useRendererMatrix=e.coordinateSystem!==kAe.DISPLAY,e.WebGPURenderer=e.WebGPUActor.getFirstAncestorOfType("vtkWebGPURenderer"),e.WebGPURenderWindow=e.WebGPURenderer.getParent(),e.device=e.WebGPURenderWindow.getDevice())},t.translucentPass=n=>{n&&(t.prepareToDraw(e.WebGPURenderer.getRenderEncoder()),e.renderEncoder.registerDrawCallback(e.pipeline,t.draw))},t.opaquePass=n=>{n&&(t.prepareToDraw(e.WebGPURenderer.getRenderEncoder()),e.renderEncoder.registerDrawCallback(e.pipeline,t.draw))},t.updateUBO=()=>{const r=e.WebGPUActor.getRenderable().getProperty(),i=e.UBO.getSendTime();if(t.getMTime()>i||r.getMTime()>i||e.renderable.getMTime()>i){const a=e.WebGPUActor.getKeyMatrices(e.WebGPURenderer);if(e.UBO.setArray("BCWCMatrix",a.bcwc),e.UBO.setArray("BCSCMatrix",a.bcsc),e.UBO.setArray("MCWCNormals",a.normalMatrix),e.is2D){e.UBO.setValue("ZValue",e.WebGPUActor.getRenderable().getProperty().getDisplayLocation()===VAe.FOREGROUND?1:0);const l=r.getColorByReference();e.UBO.setValue("AmbientIntensity",1),e.UBO.setArray("DiffuseColor",[l[0],l[1],l[2],1]),e.UBO.setValue("DiffuseIntensity",0),e.UBO.setValue("SpecularIntensity",0)}else{let l=r.getAmbientColorByReference();e.UBO.setValue("AmbientIntensity",r.getAmbient()),e.UBO.setArray("AmbientColor",[l[0],l[1],l[2],1]),e.UBO.setValue("DiffuseIntensity",r.getDiffuse()),l=r.getDiffuseColorByReference(),e.UBO.setArray("DiffuseColor",[l[0],l[1],l[2],1]),e.UBO.setValue("Roughness",r.getRoughness()),e.UBO.setValue("BaseIOR",r.getBaseIOR()),e.UBO.setValue("Metallic",r.getMetallic()),e.UBO.setValue("NormalStrength",r.getNormalStrength()),e.UBO.setValue("Emission",r.getEmission()),e.UBO.setValue("SpecularIntensity",r.getSpecular()),l=r.getSpecularColorByReference(),e.UBO.setArray("SpecularColor",[l[0],l[1],l[2],1])}const o=r.getEdgeColorByReference?.();o&&e.UBO.setArray("EdgeColor",[o[0],o[1],o[2],1]),e.UBO.setValue("LineWidth",r.getLineWidth()),e.UBO.setValue("Opacity",r.getOpacity()),e.UBO.setValue("PropID",e.WebGPUActor.getPropID());const s=e.WebGPURenderWindow.getDevice();e.UBO.sendIfNeeded(s)}},t.haveWideLines=()=>{const n=e.WebGPUActor.getRenderable(),r=n.getProperty().getRepresentation();return n.getProperty().getLineWidth()<=1||e.primitiveType===Yo.Verts?!1:e.primitiveType===Yo.Triangles||e.primitiveType===Yo.TriangleStrips?r===cb.WIREFRAME:!0},t.replaceShaderPosition=(n,r,i)=>{const a=r.getShaderDescription("vertex");a.addBuiltinOutput("vec4<f32>","@builtin(position) Position"),a.hasOutput("vertexVC")||a.addOutput("vec4<f32>","vertexVC");let o=a.getCode();e.useRendererMatrix?(o=Rr.substitute(o,"//VTK::Position::Impl",["    var pCoord: vec4<f32> = rendererUBO.SCPCMatrix*mapperUBO.BCSCMatrix*vertexBC;","    output.vertexVC = rendererUBO.SCVCMatrix * mapperUBO.BCSCMatrix * vec4<f32>(vertexBC.xyz, 1.0);","//VTK::Position::Impl"]).result,e.forceZValue&&(o=Rr.substitute(o,"//VTK::Position::Impl",["pCoord = vec4<f32>(pCoord.xyz/pCoord.w, 1.0);","pCoord.z = mapperUBO.ZValue;","//VTK::Position::Impl"]).result)):(o=Rr.substitute(o,"//VTK::Position::Impl",["    var pCoord: vec4<f32> = mapperUBO.BCSCMatrix*vertexBC;","    pCoord.x = 2.0* pCoord.x / rendererUBO.viewportSize.x - 1.0;","    pCoord.y = 2.0* pCoord.y / rendererUBO.viewportSize.y - 1.0;","    pCoord.z = 0.5 - 0.5 * pCoord.z;","//VTK::Position::Impl"]).result,e.forceZValue&&(o=Rr.substitute(o,"//VTK::Position::Impl",["    pCoord.z = mapperUBO.ZValue;","//VTK::Position::Impl"]).result)),t.haveWideLines()&&(a.addBuiltinInput("u32","@builtin(instance_index) instanceIndex"),o=Rr.substitute(o,"//VTK::Position::Impl",["    var tmpPos: vec4<f32> = pCoord;","    var numSteps: f32 = ceil(mapperUBO.LineWidth - 1.0);","    var offset: f32 = (mapperUBO.LineWidth - 1.0) * (f32(input.instanceIndex / 2u) - numSteps/2.0) / numSteps;","    var tmpPos2: vec3<f32> = tmpPos.xyz / tmpPos.w;","    tmpPos2.x = tmpPos2.x + 2.0 * (f32(input.instanceIndex) % 2.0) * offset / rendererUBO.viewportSize.x;","    tmpPos2.y = tmpPos2.y + 2.0 * (f32(input.instanceIndex + 1u) % 2.0) * offset / rendererUBO.viewportSize.y;","    tmpPos2.z = min(1.0, tmpPos2.z + 0.00001);","    pCoord = vec4<f32>(tmpPos2.xyz * tmpPos.w, tmpPos.w);","//VTK::Position::Impl"]).result),o=Rr.substitute(o,"//VTK::Position::Impl",["    output.Position = pCoord;"]).result,a.setCode(o)},e.shaderReplacements.set("replaceShaderPosition",t.replaceShaderPosition),t.replaceShaderNormal=(n,r,i)=>{const a=i.getBuffer("normalMC"),o=e.WebGPUActor.getRenderable();if(a){const s=r.getShaderDescription("vertex");s.hasOutput("normalVC")||s.addOutput("vec3<f32>","normalVC",a.getArrayInformation()[0].interpolation),s.hasOutput("tangentVC")||s.addOutput("vec3<f32>","tangentVC",a.getArrayInformation()[0].interpolation),s.hasOutput("bitangentVC")||s.addOutput("vec3<f32>","bitangentVC",a.getArrayInformation()[0].interpolation);let l=s.getCode();l=Rr.substitute(l,"//VTK::Normal::Impl",["  output.normalVC = normalize((rendererUBO.WCVCNormals * mapperUBO.MCWCNormals * normalMC).xyz);","  var c1: vec3<f32> = cross(output.normalVC, vec3<f32>(0, 0, 1));","  var c2: vec3<f32> = cross(output.normalVC, vec3<f32>(0, 1, 0));","  var tangent: vec3<f32> = mix(c1, c2, distance(c1, c2));","  output.tangentVC = normalize(tangent);","  output.bitangentVC = normalize(cross(output.normalVC, tangent));"]).result,s.setCode(l);const c=r.getShaderDescription("fragment");l=c.getCode(),o.getProperty().getNormalTexture()?l=Rr.substitute(l,"//VTK::Normal::Impl",["  var normal: vec3<f32> = input.normalVC;","  if (!input.frontFacing) { normal = -normal; }","  var tangent: vec3<f32> = input.tangentVC;","  var bitangent: vec3<f32> = input.bitangentVC;","  var TCVCMatrix: mat3x3<f32> = mat3x3<f32>(","    tangent.x, bitangent.x, normal.x,","    tangent.y, bitangent.y, normal.y,","    tangent.z, bitangent.z, normal.z,","  );","  var mappedNormal: vec3<f32> = TCVCMatrix * (_normalMap.xyz * 2 - 1);","  normal = mix(normal, mappedNormal, mapperUBO.NormalStrength);","  normal = normalize(normal);"]).result:l=Rr.substitute(l,"//VTK::Normal::Impl",["  var normal: vec3<f32> = input.normalVC;","  if (!input.frontFacing) { normal = -normal; }","  normal = normalize(normal);"]).result,c.setCode(l)}},e.shaderReplacements.set("replaceShaderNormal",t.replaceShaderNormal),t.replaceShaderLight=(n,r,i)=>{if(n.includes("sel"))return;const a=r.getShaderDescription("vertex");a.hasOutput("vertexVC")||a.addOutput("vec4<f32>","vertexVC");const o=e.WebGPURenderer.getRenderable(),s=r.getShaderDescription("fragment");let l=s.getCode();if(l.includes("var normal:")&&e.useRendererMatrix&&!zF(n)&&!e.is2D&&!n.includes("sel")){const c=["  var pi: f32 = 3.14159265359;","  var fragPos: vec3<f32> = vec3<f32>(input.vertexVC.xyz);","  var V: vec3<f32> = mix(normalize(-fragPos), vec3<f32>(0, 0, 1), f32(rendererUBO.cameraParallel)); // View Vector","  var baseColor: vec3<f32> = _diffuseMap.rgb * diffuseColor.rgb;","  var roughness: f32 = max(0.000001, mapperUBO.Roughness * _roughnessMap.r);","  var metallic: f32 = mapperUBO.Metallic * _metallicMap.r;","  var alpha: f32 = roughness*roughness;","  var ior: f32 = mapperUBO.BaseIOR;","  var k: f32 = alpha*alpha / 2;","  var diffuse: vec3<f32> = vec3<f32>(0.);","  var specular: vec3<f32> = vec3<f32>(0.);","  var emission: vec3<f32> = _emissionMap.rgb * mapperUBO.Emission;","  {","    var i: i32 = 0;","    loop {","      if !(i < rendererUBO.LightCount) { break; }","      switch (i32(rendererLightSSBO.values[i].LightData.x)) {","         // Point Light","         case 0 {","           var color: vec3<f32> = rendererLightSSBO.values[i].LightColor.rgb * rendererLightSSBO.values[i].LightColor.w;","           var pos: vec3<f32> = (rendererLightSSBO.values[i].LightPos).xyz;","           var calculated: PBRData = calcPointLight(normal, V, fragPos, ior, roughness, metallic, pos, color, baseColor);","           diffuse += max(vec3<f32>(0), calculated.diffuse);","           specular += max(vec3<f32>(0), calculated.specular);","          }","         // Directional light","         case 1 {","           var dir: vec3<f32> = (rendererUBO.WCVCNormals * vec4<f32>(normalize(rendererLightSSBO.values[i].LightDir.xyz), 0.)).xyz;","           dir = normalize(dir);","           var color: vec3<f32> = rendererLightSSBO.values[i].LightColor.rgb * rendererLightSSBO.values[i].LightColor.w;","           var calculated: PBRData = calcDirectionalLight(normal, V, ior, roughness, metallic, dir, color, baseColor); // diffuseColor.rgb needs to be fixed with a more dynamic diffuse color","           diffuse += max(vec3<f32>(0), calculated.diffuse);","           specular += max(vec3<f32>(0), calculated.specular);","         }","         // Spot Light","         case 2 {","           var color: vec3<f32> = rendererLightSSBO.values[i].LightColor.rgb * rendererLightSSBO.values[i].LightColor.w;","           var pos: vec3<f32> = (rendererLightSSBO.values[i].LightPos).xyz;","           var dir: vec3<f32> = (rendererUBO.WCVCNormals * vec4<f32>(normalize(rendererLightSSBO.values[i].LightDir.xyz), 0.)).xyz;","           dir = normalize(dir);","           var cones: vec2<f32> = vec2<f32>(rendererLightSSBO.values[i].LightData.y, rendererLightSSBO.values[i].LightData.z);","           var calculated: PBRData = calcSpotLight(normal, V, fragPos, ior, roughness, metallic, pos, dir, cones, color, baseColor);","           diffuse += max(vec3<f32>(0), calculated.diffuse);","           specular += max(vec3<f32>(0), calculated.specular);","         }","         default { continue; }","       }","      continuing { i++; }","    }","  }","  var fresnel: f32 = schlickFresnelIOR(V, normal, ior, k); // Fresnel","  fresnel = min(1.0, fresnel);","  // This could be controlled with its own variable (that isnt base color) for better artistic control","  var fresnelMetallic: vec3<f32> = schlickFresnelRGB(V, normal, baseColor); // Fresnel for metal, takes color into account","  var kS: vec3<f32> = mix(vec3<f32>(fresnel), fresnelMetallic, metallic);","  kS = min(vec3<f32>(1.0), kS);","  var kD: vec3<f32> = (1.0 - kS) * (1.0 - metallic);","  var PBR: vec3<f32> = mapperUBO.DiffuseIntensity*kD*diffuse + kS*specular;","  PBR += emission;","  computedColor = vec4<f32>(PBR, mapperUBO.Opacity);"];o.getEnvironmentTexture()?.getImageLoaded()&&c.push("  // To get diffuse IBL, the texture is sampled with normals in worldspace","  var diffuseIBLCoords: vec3<f32> = (transpose(rendererUBO.WCVCNormals) * vec4<f32>(normal, 1.)).xyz;","  var diffuseCoords: vec2<f32> = vecToRectCoord(diffuseIBLCoords);","  // To get specular IBL, the texture is sampled as the worldspace reflection between the normal and view vectors","  // Reflections are first calculated in viewspace, then converted to worldspace to sample the environment","  var VreflN: vec3<f32> = normalize(reflect(-V, normal));","  var reflectionIBLCoords = (transpose(rendererUBO.WCVCNormals) * vec4<f32>(VreflN, 1.)).xyz;","  var specularCoords: vec2<f32> = vecToRectCoord(reflectionIBLCoords);","  var diffuseIBL = textureSampleLevel(EnvironmentTexture, EnvironmentTextureSampler, diffuseCoords, rendererUBO.MaxEnvironmentMipLevel);","  var level = roughness * rendererUBO.MaxEnvironmentMipLevel;","  var specularIBL = textureSampleLevel(EnvironmentTexture, EnvironmentTextureSampler, specularCoords, level);","  var specularIBLContribution: vec3<f32> = specularIBL.rgb*rendererUBO.BackgroundSpecularStrength;","  computedColor += vec4<f32>(specularIBLContribution*kS, 0);","  var diffuseIBLContribution: vec3<f32> = diffuseIBL.rgb*rendererUBO.BackgroundDiffuseStrength;","  diffuseIBLContribution *= baseColor * _ambientOcclusionMap.rgb;","  computedColor += vec4<f32>(diffuseIBLContribution*kD, 0);"),l=Rr.substitute(l,"//VTK::Light::Impl",c).result,s.setCode(l)}else l=Rr.substitute(l,"//VTK::Light::Impl",["  var diffuse: vec3<f32> = diffuseColor.rgb;","  var specular: vec3<f32> = mapperUBO.SpecularColor.rgb * mapperUBO.SpecularColor.a;","  computedColor = vec4<f32>(diffuse * _diffuseMap.rgb, mapperUBO.Opacity);"]).result,s.setCode(l)},e.shaderReplacements.set("replaceShaderLight",t.replaceShaderLight),t.replaceShaderColor=(n,r,i)=>{if(zF(n)){const c=r.getShaderDescription("fragment");let f=c.getCode();f=Rr.substitute(f,"//VTK::Color::Impl",["ambientColor = mapperUBO.EdgeColor;","diffuseColor = mapperUBO.EdgeColor;"]).result,c.setCode(f);return}const a=i.getBuffer("colorVI");if(!a)return;const o=r.getShaderDescription("vertex");o.addOutput("vec4<f32>","color",a.getArrayInformation()[0].interpolation);let s=o.getCode();s=Rr.substitute(s,"//VTK::Color::Impl",["  output.color = colorVI;"]).result,o.setCode(s);const l=r.getShaderDescription("fragment");s=l.getCode(),s=Rr.substitute(s,"//VTK::Color::Impl",["ambientColor = input.color;","diffuseColor = input.color;","opacity = mapperUBO.Opacity * input.color.a;"]).result,l.setCode(s)},e.shaderReplacements.set("replaceShaderColor",t.replaceShaderColor),t.replaceShaderTCoord=(n,r,i)=>{if(!i.hasAttribute("tcoord"))return;const a=r.getShaderDescription("vertex"),o=i.getBuffer("tcoord"),s=ho.getNumberOfComponentsFromBufferFormat(o.getArrayInformation()[0].format);let l=a.getCode();a.addOutput(`vec${s}<f32>`,"tcoordVS"),l=Rr.substitute(l,"//VTK::TCoord::Impl",["  output.tcoordVS = tcoord;"]).result,a.setCode(l);const c=r.getShaderDescription("fragment");l=c.getCode();const f=e.WebGPUActor.getRenderable(),u=h=>h?h.getDimensionality()===s:!1,d=[];(f.getProperty().getDiffuseTexture?.()?.getImageLoaded()||f.getTextures()[0]||e.colorTexture)&&(u(f.getProperty().getDiffuseTexture?.())||u(f.getTextures()[0])||u(e.colorTexture))&&d.push("_diffuseMap = textureSample(DiffuseTexture, DiffuseTextureSampler, input.tcoordVS);"),f.getProperty().getRoughnessTexture?.()?.getImageLoaded()&&u(f.getProperty().getRoughnessTexture())&&d.push("_roughnessMap = textureSample(RoughnessTexture, RoughnessTextureSampler, input.tcoordVS);"),f.getProperty().getMetallicTexture?.()?.getImageLoaded()&&u(f.getProperty().getMetallicTexture())&&d.push("_metallicMap = textureSample(MetallicTexture, MetallicTextureSampler, input.tcoordVS);"),f.getProperty().getNormalTexture?.()?.getImageLoaded()&&u(f.getProperty().getNormalTexture())&&d.push("_normalMap = textureSample(NormalTexture, NormalTextureSampler, input.tcoordVS);"),f.getProperty().getAmbientOcclusionTexture?.()?.getImageLoaded()&&u(f.getProperty().getAmbientOcclusionTexture())&&d.push("_ambientOcclusionMap = textureSample(AmbientOcclusionTexture, AmbientOcclusionTextureSampler, input.tcoordVS);"),f.getProperty().getEmissionTexture?.()?.getImageLoaded()&&u(f.getProperty().getEmissionTexture())&&d.push("_emissionMap = textureSample(EmissionTexture, EmissionTextureSampler, input.tcoordVS);"),l=Rr.substitute(l,"//VTK::TCoord::Impl",d).result,c.setCode(l)},e.shaderReplacements.set("replaceShaderTCoord",t.replaceShaderTCoord),t.replaceShaderSelect=(n,r,i)=>{if(n.includes("sel")){const a=r.getShaderDescription("fragment");let o=a.getCode();o=Rr.substitute(o,"//VTK::Select::Impl",["  var compositeID: u32 = 0u;"]).result,a.setCode(o)}},e.shaderReplacements.set("replaceShaderSelect",t.replaceShaderSelect),t.getUsage=(n,r)=>n===cb.POINTS||r===Yo.Points?Xa.Verts:r===Yo.Lines?Xa.Lines:n===cb.WIREFRAME?r===Yo.Triangles?Xa.LinesFromTriangles:Xa.LinesFromStrips:r===Yo.Triangles?Xa.Triangles:r===Yo.TriangleStrips?Xa.Strips:r===Yo.TriangleEdges?Xa.LinesFromTriangles:Xa.LinesFromStrips,t.getHashFromUsage=n=>`pt${n}`,t.getTopologyFromUsage=n=>{switch(n){case Xa.Triangles:return"triangle-list";case Xa.Verts:return"point-list";case Xa.Lines:default:return"line-list"}},t.buildVertexInput=()=>{const n=e.currentInput,r=e.cellArray,i=e.primitiveType;let o=e.WebGPUActor.getRenderable().getProperty().getRepresentation();const s=e.WebGPURenderWindow.getDevice();let l=!1;i===Yo.TriangleEdges&&(l=!0,o=cb.WIREFRAME);const c=e.vertexInput,f=n.getPoints();let u;if(r){const g={hash:`R${o}P${i}${r.getMTime()}`,usage:Xa.Index,cells:r,numberOfPoints:f.getNumberOfPoints(),primitiveType:i,representation:o};u=s.getBufferManager().getBuffer(g),c.setIndexBuffer(u)}else c.setIndexBuffer(null);if(f){const g=e.WebGPUActor.getBufferShift(e.WebGPURenderer),m={hash:`${f.getMTime()}I${u.getMTime()}${g.join()}float32x4`,usage:Xa.PointArray,format:"float32x4",dataArray:f,indexBuffer:u,shift:g,packExtra:!0},y=s.getBufferManager().getBuffer(m);c.addBuffer(y,["vertexBC"])}else c.removeBufferIfPresent("vertexBC");const d=t.getUsage(o,i);if(e._usesCellNormals=!1,!e.is2D&&(d===Xa.Triangles||d===Xa.Strips)){const g=n.getPointData().getNormals(),m={format:"snorm8x4",indexBuffer:u,packExtra:!0,shift:0,scale:127};if(g){m.hash=`${g.getMTime()}I${u.getMTime()}snorm8x4`,m.dataArray=g,m.usage=Xa.PointArray;const y=s.getBufferManager().getBuffer(m);c.addBuffer(y,["normalMC"])}else if(i===Yo.Triangles){e._usesCellNormals=!0,m.hash=`PFN${f.getMTime()}I${u.getMTime()}snorm8x4`,m.dataArray=f,m.cells=r,m.usage=Xa.NormalsFromPoints;const y=s.getBufferManager().getBuffer(m);c.addBuffer(y,["normalMC"])}else c.removeBufferIfPresent("normalMC")}else c.removeBufferIfPresent("normalMC");let h=!1;if(e.renderable.getScalarVisibility()){const g=e.renderable.getColorMapColors();if(g&&!l){const m=e.renderable.getScalarMode();let y=!1;(m===ub.USE_CELL_DATA||m===ub.USE_CELL_FIELD_DATA||m===ub.USE_FIELD_DATA||!n.getPointData().getScalars())&&m!==ub.USE_POINT_FIELD_DATA&&g&&(y=!0);const v={usage:Xa.PointArray,format:"unorm8x4",hash:`${y}${g.getMTime()}I${u.getMTime()}unorm8x4`,dataArray:g,indexBuffer:u,cellData:y,cellOffset:0},x=s.getBufferManager().getBuffer(v);c.addBuffer(x,["colorVI"]),h=!0}}h||c.removeBufferIfPresent("colorVI");let p=null;if(e.renderable.getInterpolateScalarsBeforeMapping?.()&&e.renderable.getColorCoordinates()?p=e.renderable.getColorCoordinates():p=n.getPointData().getTCoords(),p&&!l){const g=s.getBufferManager().getBufferForPointArray(p,c.getIndexBuffer());c.addBuffer(g,["tcoord"])}else c.removeBufferIfPresent("tcoord")},t.updateTextures=()=>{const n=[],r=[],i=e.renderable.getColorTextureMap?.();i&&(e.colorTexture||(e.colorTexture=Qm.newInstance({label:"polyDataColor"})),e.colorTexture.setInputData(i),r.push(["Diffuse",e.colorTexture]));const a=e.WebGPUActor.getRenderable(),o=e.WebGPURenderer.getRenderable(),s=[];if(a.getProperty().getDiffuseTexture?.()){const l=["Diffuse",a.getProperty().getDiffuseTexture()];s.push(l)}if(a.getTextures()[0]){const l=["Diffuse",a.getTextures()[0]];s.push(l)}if(e.colorTexture){const l=["Diffuse",e.colorTexture];s.push(l)}if(a.getProperty().getRoughnessTexture?.()){const l=["Roughness",a.getProperty().getRoughnessTexture()];s.push(l)}if(a.getProperty().getMetallicTexture?.()){const l=["Metallic",a.getProperty().getMetallicTexture()];s.push(l)}if(a.getProperty().getNormalTexture?.()){const l=["Normal",a.getProperty().getNormalTexture()];s.push(l)}if(a.getProperty().getAmbientOcclusionTexture?.()){const l=["AmbientOcclusion",a.getProperty().getAmbientOcclusionTexture()];s.push(l)}if(a.getProperty().getEmissionTexture?.()){const l=["Emission",a.getProperty().getEmissionTexture()];s.push(l)}if(o.getEnvironmentTexture?.()){const l=["Environment",o.getEnvironmentTexture()];s.push(l)}for(let l=0;l<s.length;l++)(s[l][1].getInputData()||s[l][1].getJsImageData()||s[l][1].getCanvas())&&r.push(s[l]),s[l][1].getImage()&&s[l][1].getImageLoaded()&&r.push(s[l]);for(let l=0;l<r.length;l++){const c=r[l][1],f=r[l][0],u=e.device.getTextureManager().getTextureForVTKTexture(c);if(u.getReady()){let d=!1;for(let h=0;h<e.textures.length;h++)e.textures[h]===u&&(d=!0,n[h]=!0);if(!d){n[e.textures.length]=!0;const h=u.createView(`${f}Texture`);e.textures.push(u),e.textureViews.push(h);const p=c.getInterpolate()?"linear":"nearest";let g=null;!g&&c.getEdgeClamp()&&c.getRepeat()&&(g="mirror-repeat"),!g&&c.getEdgeClamp()&&(g="clamp-to-edge"),!g&&c.getRepeat()&&(g="repeat"),f!=="Environment"?h.addSampler(e.device,{addressModeU:g,addressModeV:g,addressModeW:g,minFilter:p,magFilter:p}):h.addSampler(e.device,{addressModeU:"repeat",addressModeV:"clamp-to-edge",addressModeW:"repeat",minFilter:p,magFilter:p,mipmapFilter:"linear"})}}}for(let l=e.textures.length-1;l>=0;l--)n[l]||(e.textures.splice(l,1),e.textureViews.splice(l,1))},t.computePipelineHash=()=>{let n=`pd${e.useRendererMatrix?"r":""}${e.forceZValue?"z":""}`;if(e.primitiveType===Yo.TriangleEdges||e.primitiveType===Yo.TriangleStripEdges)n+="edge";else{if(e.vertexInput.hasAttribute("normalMC")&&(n+="n"),e.vertexInput.hasAttribute("colorVI")&&(n+="c"),e.vertexInput.hasAttribute("tcoord")){const i=e.vertexInput.getBuffer("tcoord"),a=ho.getNumberOfComponentsFromBufferFormat(i.getArrayInformation()[0].format);n+=`t${a}`}e.textures.length&&(n+=`tx${e.textures.length}`)}e._usesCellNormals&&(n+="cn"),e.SSBO&&(n+="ssbo");const r=t.getHashFromUsage(e.usage);n+=r,n+=e.renderEncoder.getPipelineHash(),e.pipelineHash=n},t.updateBuffers=()=>{e.primitiveType!==Yo.TriangleEdges&&e.primitiveType!==Yo.TriangleStripEdges&&t.updateTextures();const n=e.WebGPUActor.getRenderable(),r=n.getProperty().getRepresentation();e.usage=t.getUsage(r,e.primitiveType),t.buildVertexInput();const i=e.vertexInput.getBuffer("vertexBC");if(t.setNumberOfVertices(i.getSizeInBytes()/i.getStrideInBytes()),t.setTopology(t.getTopologyFromUsage(e.usage)),t.updateUBO(),t.haveWideLines()){const a=n.getProperty();t.setNumberOfInstances(Math.ceil(a.getLineWidth()*2))}else t.setNumberOfInstances(1)}}const $Ae={is2D:!1,cellArray:null,currentInput:null,cellOffset:0,primitiveType:0,colorTexture:null,renderEncoder:null,textures:null};function Mee(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,$Ae,n),DJ.extend(t,e,n),e.fragmentShaderTemplate=UAe,e.vertexShaderTemplate=FAe,e._tmpMat3=Bl(new Float64Array(9)),e._tmpMat4=on(new Float64Array(16)),e.UBO=Kg.newInstance({label:"mapperUBO"}),e.UBO.addEntry("BCWCMatrix","mat4x4<f32>"),e.UBO.addEntry("BCSCMatrix","mat4x4<f32>"),e.UBO.addEntry("MCWCNormals","mat4x4<f32>"),e.UBO.addEntry("AmbientColor","vec4<f32>"),e.UBO.addEntry("DiffuseColor","vec4<f32>"),e.UBO.addEntry("EdgeColor","vec4<f32>"),e.UBO.addEntry("SpecularColor","vec4<f32>"),e.UBO.addEntry("AmbientIntensity","f32"),e.UBO.addEntry("DiffuseIntensity","f32"),e.UBO.addEntry("Roughness","f32"),e.UBO.addEntry("Metallic","f32"),e.UBO.addEntry("Ambient","f32"),e.UBO.addEntry("Normal","f32"),e.UBO.addEntry("Emission","f32"),e.UBO.addEntry("NormalStrength","f32"),e.UBO.addEntry("BaseIOR","f32"),e.UBO.addEntry("SpecularIntensity","f32"),e.UBO.addEntry("LineWidth","f32"),e.UBO.addEntry("Opacity","f32"),e.UBO.addEntry("ZValue","f32"),e.UBO.addEntry("PropID","u32"),e.UBO.addEntry("ClipNear","f32"),e.UBO.addEntry("ClipFar","f32"),e.UBO.addEntry("Time","u32"),Ni(t,e,["cellArray","currentInput","cellOffset","is2D","primitiveType","renderEncoder"]),e.textures=[],BAe(t,e)}const GAe=Qn(Mee,"vtkWebGPUCellArrayMapper");var Iee={newInstance:GAe,extend:Mee};const{PrimitiveTypes:fb}=Wm;function jAe(t,e){e.classHierarchy.push("vtkWebGPUPolyDataMapper"),t.createCellArrayMapper=()=>Iee.newInstance(),t.buildPass=n=>{if(n){e.WebGPUActor=t.getFirstAncestorOfType("vtkWebGPUActor"),e.renderable.getStatic()||e.renderable.update();const r=e.renderable.getInputData();e.renderable.mapScalars(r,1),t.updateCellArrayMappers(r)}},t.updateCellArrayMappers=n=>{const r=[n.getVerts(),n.getLines(),n.getPolys(),n.getStrips()],i=[];let a=0;for(let o=fb.Points;o<=fb.Triangles;o++)if(r[o].getNumberOfValues()>0){e.primitives[o]||(e.primitives[o]=t.createCellArrayMapper());const s=e.primitives[o];s.setCellArray(r[o]),s.setCurrentInput(n),s.setCellOffset(a),s.setPrimitiveType(o),s.setRenderable(e.renderable),a+=r[o].getNumberOfCells(),i.push(s)}else e.primitives[o]=null;if(e.WebGPUActor.getRenderable().getProperty().getEdgeVisibility())for(let o=fb.TriangleEdges;o<=fb.TriangleStripEdges;o++)if(r[o-2].getNumberOfValues()>0){e.primitives[o]||(e.primitives[o]=t.createCellArrayMapper());const s=e.primitives[o];s.setCellArray(r[o-2]),s.setCurrentInput(n),s.setCellOffset(e.primitives[o-2].getCellOffset()),s.setPrimitiveType(o),s.setRenderable(e.renderable),i.push(s)}else e.primitives[o]=null;t.prepareNodes(),t.addMissingChildren(i),t.removeUnusedNodes()}}const zAe={primitives:null};function WAe(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,zAe,n),kr.extend(t,e,n),e.primitives=[],jAe(t,e)}const HAe=Qn(WAe,"vtkWebGPUPolyDataMapper");zl("vtkMapper",HAe);const{PrimitiveTypes:WF}=Wm;function KAe(t,e){e.classHierarchy.push("vtkWebGPUPolyDataMapper2D"),t.createCellArrayMapper=()=>Iee.newInstance(),t.buildPass=n=>{if(n){e.WebGPUActor=t.getFirstAncestorOfType("vtkWebGPUActor2D"),e.renderable.getStatic()||e.renderable.update();const r=e.renderable.getInputData();e.renderable.mapScalars(r,1),t.updateCellArrayMappers(r)}},t.updateCellArrayMappers=n=>{const r=[n.getVerts(),n.getLines(),n.getPolys(),n.getStrips()],i=[];let a=0;for(let o=WF.Points;o<=WF.Triangles;o++)if(r[o].getNumberOfValues()>0){e.primitives[o]||(e.primitives[o]=t.createCellArrayMapper());const s=e.primitives[o];s.setCellArray(r[o]),s.setCurrentInput(n),s.setCellOffset(a),s.setPrimitiveType(o),s.setRenderable(e.renderable),s.setIs2D(!0),a+=r[o].getNumberOfCells(),i.push(s)}else e.primitives[o]=null;t.prepareNodes(),t.addMissingChildren(i),t.removeUnusedNodes()}}function qAe(t){return{primitives:[],...t}}function XAe(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,qAe(n)),kr.extend(t,e,n),e.primitives=[],KAe(t,e)}const YAe=Qn(XAe,"vtkWebGPUPolyDataMapper2D");zl("vtkMapper2D",YAe);function JAe(t,e){e.classHierarchy.push("vtkWebGPUScalarBarActor"),t.buildPass=n=>{n&&(e.WebGPURenderer=t.getFirstAncestorOfType("vtkWebGPURenderer"),e.WebGPURenderWindow=e.WebGPURenderer.getParent(),e.scalarBarActorHelper.getRenderable()||e.scalarBarActorHelper.setRenderable(e.renderable),t.prepareNodes(),t.addMissingNode(e.scalarBarActorHelper.getBarActor()),t.addMissingNode(e.scalarBarActorHelper.getTmActor()),t.removeUnusedNodes())},t.opaquePass=(n,r)=>{if(n){const i=e.WebGPURenderer?e.WebGPURenderer.getRenderable().getActiveCamera():null,a=e.WebGPURenderer.getTiledSizeAndOrigin();e.scalarBarActorHelper.updateAPISpecificData([a.usize,a.vsize],i,e.WebGPURenderWindow.getRenderable())}}}const ZAe={};function QAe(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,ZAe,n),kr.extend(t,e,n),e.scalarBarActorHelper=Oee.newScalarBarActorHelper(),JAe(t,e)}const eNe=Qn(QAe,"vtkWebGPUScalarBarActor");zl("vtkScalarBarActor",eNe);function tNe(t,e){e.classHierarchy.push("vtkWebGPUTextureView"),t.create=(n,r)=>{e.texture=n,e.options=r,e.options.dimension=e.options.dimension||"2d",e.options.label=e.label,e.textureHandle=n.getHandle(),e.handle=e.textureHandle.createView(e.options),e.bindGroupLayoutEntry.texture.viewDimension=e.options.dimension;const i=ho.getDetailsFromTextureFormat(e.texture.getFormat());e.bindGroupLayoutEntry.texture.sampleType=i.sampleType},t.createFromTextureHandle=(n,r)=>{e.texture=null,e.options=r,e.options.dimension=e.options.dimension||"2d",e.options.label=e.label,e.textureHandle=n,e.handle=e.textureHandle.createView(e.options),e.bindGroupLayoutEntry.texture.viewDimension=e.options.dimension;const i=ho.getDetailsFromTextureFormat(r.format);e.bindGroupLayoutEntry.texture.sampleType=i.sampleType,e.bindGroupTime.modified()},t.getBindGroupEntry=()=>({resource:t.getHandle()}),t.getShaderCode=(n,r)=>{let i="f32";e.bindGroupLayoutEntry.texture.sampleType==="sint"?i="i32":e.bindGroupLayoutEntry.texture.sampleType==="uint"&&(i="u32");let a=`@binding(${n}) @group(${r}) var ${e.label}: texture_${e.options.dimension}<${i}>;`;return e.bindGroupLayoutEntry.texture.sampleType==="depth"&&(a=`@binding(${n}) @group(${r}) var ${e.label}: texture_depth_${e.options.dimension};`),a},t.addSampler=(n,r)=>{const i=LJ.newInstance({label:`${e.label}Sampler`});i.create(n,r),t.setSampler(i)},t.getBindGroupTime=()=>(e.texture&&e.texture.getHandle()!==e.textureHandle&&(e.textureHandle=e.texture.getHandle(),e.handle=e.textureHandle.createView(e.options),e.bindGroupTime.modified()),e.bindGroupTime),t.getHandle=()=>(e.texture&&e.texture.getHandle()!==e.textureHandle&&(e.textureHandle=e.texture.getHandle(),e.handle=e.textureHandle.createView(e.options),e.bindGroupTime.modified()),e.handle)}const nNe={texture:null,handle:null,sampler:null,label:null};function Ree(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,nNe,n),ce.obj(t,e),e.bindGroupLayoutEntry={visibility:GPUShaderStage.VERTEX|GPUShaderStage.FRAGMENT,texture:{sampleType:"float",viewDimension:"2d"}},e.bindGroupTime={},ce.obj(e.bindGroupTime,{mtime:0}),ce.get(t,e,["bindGroupTime","texture"]),ce.setGet(t,e,["bindGroupLayoutEntry","label","sampler"]),tNe(t,e)}const rNe=ce.newInstance(Ree);var iNe={newInstance:rNe,extend:Ree};const{BufferUsage:HF}=Wm;function aNe(t,e){e.classHierarchy.push("vtkWebGPUTexture"),t.create=(n,r)=>{e.device=n,e.width=r.width,e.height=r.height,e.depth=r.depth?r.depth:1;const i=e.depth===1?"2d":"3d";e.format=r.format?r.format:"rgba8unorm",e.mipLevel=r.mipLevel?r.mipLevel:0,e.usage=r.usage?r.usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST,e.handle=e.device.getHandle().createTexture({size:[e.width,e.height,e.depth],format:e.format,usage:e.usage,label:e.label,dimension:i,mipLevelCount:e.mipLevel+1})},t.assignFromHandle=(n,r,i)=>{e.device=n,e.handle=r,e.width=i.width,e.height=i.height,e.depth=i.depth?i.depth:1,e.format=i.format?i.format:"rgba8unorm",e.usage=i.usage?i.usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST},t.writeImageData=n=>{let r=[];if(n.canvas){e.device.getHandle().queue.copyExternalImageToTexture({source:n.canvas,flipY:n.flip},{texture:e.handle,premultipliedAlpha:!0},[e.width,e.height,e.depth]),e.ready=!0;return}n.jsImageData&&!n.nativeArray&&(n.width=n.jsImageData.width,n.height=n.jsImageData.height,n.depth=1,n.format="rgba8unorm",n.flip=!0,n.nativeArray=n.jsImageData.data);const i=ho.getDetailsFromTextureFormat(e.format);let a=e.width*i.stride;const o=(l,c,f)=>{const u=l.length/(c*f)*l.BYTES_PER_ELEMENT,d=i.elementSize===2&&i.sampleType==="float";if(d||u%256){const h=l,p=u/h.BYTES_PER_ELEMENT,g=i.elementSize,m=256*Math.floor((p*g+255)/256),y=m/g,v=ce.newTypedArray(d?"Uint16Array":h.constructor.name,y*c*f);for(let x=0;x<c*f;x++)if(d)for(let w=0;w<p;w++)v[x*y+w]=th.toHalf(h[x*p+w]);else v.set(h.subarray(x*p,(x+1)*p),x*y);return[v,m]}return[l,u]};if(n.nativeArray&&(r=n.nativeArray),n.image){const l=document.createElement("canvas");l.width=n.image.width,l.height=n.image.height;const c=l.getContext("2d");c.translate(0,l.height),c.scale(1,-1),c.drawImage(n.image,0,0,n.image.width,n.image.height,0,0,l.width,l.height),r=c.getImageData(0,0,n.image.width,n.image.height).data}const s=e.device.createCommandEncoder();if(t.getDimensionality()!==3){const l=Qm.generateMipmaps(r,e.width,e.height,e.mipLevel);let c=e.width,f=e.height;for(let u=0;u<=e.mipLevel;u++){const d=o(l[u],f,1);a=d[1];const h={dataArray:n.dataArray?n.dataArray:null,nativeArray:d[0],usage:HF.Texture},p=e.device.getBufferManager().getBuffer(h);s.copyBufferToTexture({buffer:p.getHandle(),offset:0,bytesPerRow:a,rowsPerImage:f},{texture:e.handle,mipLevel:u},[c,f,1]),c/=2,f/=2}e.device.submitCommandEncoder(s),e.ready=!0}else{const l=o(r,e.height,e.depth);a=l[1];const c={dataArray:n.dataArray?n.dataArray:null,usage:HF.Texture};c.nativeArray=l[0];const f=e.device.getBufferManager().getBuffer(c);s.copyBufferToTexture({buffer:f.getHandle(),offset:0,bytesPerRow:a,rowsPerImage:e.height},{texture:e.handle},[e.width,e.height,e.depth]),e.device.submitCommandEncoder(s),e.ready=!0}},t.getScale=()=>{const n=ho.getDetailsFromTextureFormat(e.format);return n.elementSize===2&&n.sampleType==="float"?1:255},t.getNumberOfComponents=()=>ho.getDetailsFromTextureFormat(e.format).numComponents,t.getDimensionality=()=>{let n=0;return e.width>1&&n++,e.height>1&&n++,e.depth>1&&n++,n},t.resizeToMatch=n=>{(n.getWidth()!==e.width||n.getHeight()!==e.height||n.getDepth()!==e.depth)&&(e.width=n.getWidth(),e.height=n.getHeight(),e.depth=n.getDepth(),e.handle=e.device.getHandle().createTexture({size:[e.width,e.height,e.depth],format:e.format,usage:e.usage,label:e.label}))},t.resize=function(n,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;(n!==e.width||r!==e.height||i!==e.depth)&&(e.width=n,e.height=r,e.depth=i,e.handle=e.device.getHandle().createTexture({size:[e.width,e.height,e.depth],format:e.format,usage:e.usage,label:e.label}))},t.createView=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};r.dimension||(r.dimension=e.depth===1?"2d":"3d");const i=iNe.newInstance({label:n});return i.create(t,r),i}}const oNe={device:null,handle:null,buffer:null,ready:!1,label:null};function sNe(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,oNe,n),ce.obj(t,e),ce.get(t,e,["handle","ready","width","height","depth","format","usage"]),ce.setGet(t,e,["device","label"]),aNe(t,e)}ce.newInstance(sNe);function lNe(t){if(!t||t.data.length===0)throw new Error("Invalid contour set data, see publicContourSetData type for more info");if(!t.id)throw new Error("Invalid contour set data, each contour set must have an id");if(!t.data||!Array.isArray(t.data))throw new Error("Invalid contour set data, each contour set must have an array of contours");t.data.forEach(e=>{if(!e.points||!Array.isArray(e.points))throw new Error("Invalid contour set data, each contour must have an array of points");e.points.forEach(n=>{if(!n||!Array.isArray(n)||n.length!==3)throw new Error("Invalid contour set data, each point must be an array of length 3")})})}class KF{constructor(e){const{points:n,type:r}=e.data;this.id=e.id,this._points=n,this._type=r,this._color=e.color,this._segmentIndex=e.segmentIndex,this.sizeInBytes=this._getSizeInBytes()}_getSizeInBytes(){return this._points.length*3}get points(){return this._points}set points(e){this._points=e}get color(){return this._color}set color(e){this._color=e}get type(){return this._type}set type(e){this._type=e}get segmentIndex(){return this._segmentIndex}set segmentIndex(e){this._segmentIndex=e}get flatPointsArray(){return this._points.map(e=>[...e]).flat()}}class cNe{constructor(e){this._color=[200,0,0],this.id=e.id,this._contours=[],this._color=e.color??this._color,this.frameOfReferenceUID=e.frameOfReferenceUID,this._segmentIndex=e.segmentIndex,this._createEachContour(e.data),this.sizeInBytes=this._getSizeInBytes()}_createEachContour(e){e.forEach(n=>{const{points:r,type:i,color:a}=n,o=new KF({id:`${this.id}-segment-${this._segmentIndex}`,data:{points:r,type:i,segmentIndex:this._segmentIndex,color:a??this._color},segmentIndex:this._segmentIndex,color:a??this._color});this._contours.push(o)}),this._updateContourSetCentroid()}_updateContourSetCentroid(){const e=this.totalNumberOfPoints,n=this.flatPointsArray,r=n.reduce((o,s)=>[o[0]+s[0],o[1]+s[1],o[2]+s[2]],[0,0,0]),i=[r[0]/e,r[1]/e,r[2]/e],a=n.reduce((o,s)=>{const l=this._getDistance(i,s),c=this._getDistance(i,o);return l<c?s:o},n[0]);this._centroid=a}_getSizeInBytes(){return this._contours.reduce((e,n)=>e+n.sizeInBytes,0)}_getDistance(e,n){return Math.sqrt((e[0]-n[0])**2+(e[1]-n[1])**2+(e[2]-n[2])**2)}get centroid(){return this._centroid}get segmentIndex(){return this._segmentIndex}get color(){return this._color}set color(e){this._color=e,this._contours.forEach(n=>{n instanceof KF&&(n.color=e)})}get contours(){return this._contours}get flatPointsArray(){return this._contours.flatMap(e=>e.points)}get numberOfContours(){return this._contours.length}get totalNumberOfPoints(){return this._contours.reduce((e,n)=>e+n.points.length,0)}get numberOfPointsArray(){return this._contours.map(e=>e.points.length)}getPointsInContour(e){return this._contours[e].points}getNumberOfPointsInAContour(e){return this.getPointsInContour(e).length}}function uNe(t,e){lNe(e);const n=new cNe({id:e.id,data:e.data,color:e.color,frameOfReferenceUID:e.frameOfReferenceUID,segmentIndex:e.segmentIndex??1});return{id:t,type:lu.CONTOUR,data:n,sizeInBytes:n.sizeInBytes}}function fNe(t){if(!t.id)throw new Error("Surface must have an id");if(t.points?.length===0)throw new Error("Surface must have non-empty points array");if(t.polys?.length===0)throw new Error("Surface must have non-empty polys array");if(!t.frameOfReferenceUID)throw new Error("Surface must have a frameOfReferenceUID")}function dNe(t,e){fNe(e);const n=new OQ({id:e.id,points:e.points,polys:e.polys,color:e.color,frameOfReferenceUID:e.frameOfReferenceUID,segmentIndex:e.segmentIndex??1});return{id:t,type:lu.SURFACE,data:n,sizeInBytes:n.sizeInBytes}}function hNe(t){if(!t.id)throw new Error("Mesh must have an id");if(!t.arrayBuffer)throw new Error("Mesh must have an arrayBuffer");if(!(t.format in el))throw new Error(`Mesh format must be one of the following: ${Object.values(el).join(", ")}`)}function pNe(t,e){e.classHierarchy.push("vtkMTLReader");function n(){e.requestCount--,e.requestCount===0&&t.invokeBusy(!1)}function r(a){if(a[0]==="#"||a.length===0)return;const o=a.split(/[ \t]+/).map(s=>s.trim()).filter(s=>s.length);if(o[0]==="newmtl")o.shift(),e.currentMaterial=o.join(" ").trim();else if(e.currentMaterial){if(o.length<2)return;if(e.materials[e.currentMaterial]||(e.materials[e.currentMaterial]={}),e.materials[e.currentMaterial][o[0]]=o.slice(1),o[0]==="map_Kd"){const s=new Image;s.onload=()=>setTimeout(n,0),s.src=[e.baseURL,o[1]].join("/"),e.materials[e.currentMaterial].image=s,e.requestCount++}}}e.dataAccessHelper||(e.dataAccessHelper=Uy.get("http"));function i(a,o){return e.dataAccessHelper.fetchText(t,a,o)}t.setUrl=function(a){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(a.indexOf(".mtl")===-1&&!o.fullpath)e.baseURL=a,e.url=`${a}/index.mtl`;else{e.url=a;const s=a.split("/");s.pop(),e.baseURL=s.join("/")}return t.loadData(o)},t.loadData=a=>new Promise((o,s)=>{i(e.url,a).then(l=>{t.parseAsText(l),o()},l=>{s()})}),t.parseAsText=a=>{t.modified(),e.materials={},a.split(`
`).forEach(r)},t.isBusy=()=>!!e.requestCount,t.getMaterialNames=()=>Object.keys(e.materials),t.getMaterial=a=>e.materials[a],t.listImages=()=>Object.keys(e.materials).map(a=>e.materials[a].map_Kd).filter(a=>!!a).map(a=>a[0].trim()),t.setImageSrc=(a,o)=>new Promise((s,l)=>{const c=Object.keys(e.materials).find(u=>e.materials[u].map_Kd&&e.materials[u].map_Kd[0].trim()===a.trim()),f=e.materials[c];f&&f.image?(f.image.src=o,f.image.onload=()=>setTimeout(s,0)):s()}),t.applyMaterialToActor=(a,o)=>{const s=e.materials[a];if(s&&o){const l=[1,1,1],c={ambientColor:s.Ka?s.Ka.map(u=>Number(u)):l,specularColor:s.Ks?s.Ks.map(u=>Number(u)):l,diffuseColor:s.Kd?s.Kd.map(u=>Number(u)):l,opacity:s.d?Number(s.d):1,specularPower:s.Ns?Number(s.Ns):1},f=Number(s.illum||2);if(["ambient","diffuse","specular"].forEach((u,d)=>{c[u]=d<=f?1:0}),s.image){const u=Qm.newInstance({interpolate:e.interpolateTextures});u.setImage(s.image),o.addTexture(u)}o.getProperty().set(c)}}}const gNe={numberOfOutputs:1,requestCount:0,materials:{},interpolateTextures:!0};function Pee(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,gNe,n),Wr(t,e),Fo(t,e,["url","baseURL"]),Ni(t,e,["dataAccessHelper","interpolateTextures","splitGroup"]),GD(t,e,"busy"),pNe(t,e)}const mNe=Qn(Pee,"vtkMTLReader");var vNe={newInstance:mNe,extend:Pee};function Aee(t,e){hNe(e);const n=new DIe({...e}),r={id:t,type:lu.MESH,data:n,sizeInBytes:n.sizeInBytes};switch(e.format){case el.PLY:if(e.materialUrl){const i=new Image;return new Promise((a,o)=>{i.onload=()=>{try{const s=Qm.newInstance();s.setInterpolate(!0),s.setImage(i),n.defaultActor.addTexture(s),a(r)}catch(s){o(s)}},i.onerror=s=>o(s),i.src=e.materialUrl})}return Promise.resolve(r);case el.OBJ:if(e.materialUrl){const i=vNe.newInstance();return i.setUrl(e.materialUrl).then(()=>{for(let a=0;a<n.actors.length;a++){const o=n.actors[a],s=o.getMapper();if(s){const l=s.getInputData();if(l){const c=l.get("name").name;i.applyMaterialToActor(c,o)}}}return r}).catch(a=>{throw new Error(`Failed to load material: ${a}`)})}return Promise.resolve(r);case el.STL:case el.VTP:return Promise.resolve(r);default:return Promise.reject(new Error(`Unsupported format: ${e.format}`))}}function yNe({url:t,signal:e,onload:n,loaderOptions:r}){return new Promise((i,a)=>{const o=new XMLHttpRequest;o.open("GET",t,!0);const s={},l=r.beforeSend(o,s),c=Object.assign({},s,l);o.responseType="arraybuffer",Object.keys(c).forEach(function(h){c[h]!==null&&o.setRequestHeader(h,c[h])});const f=function(h){n&&typeof n=="function"&&n(),e&&e.removeEventListener("abort",u),i(o.response)},u=()=>{o.abort(),o.removeEventListener("load",f),a(new Error("Request aborted"))};o.addEventListener("load",f);const d=(h,p)=>{const g={url:t,loaded:h,total:p};wt(vt,mt.GEOMETRY_LOAD_PROGRESS,{data:g})};o.onprogress=function(h){d(h.loaded,h.total)},e&&e.aborted?(o.abort(),a(new Error("Request aborted"))):e&&e.addEventListener("abort",u),o.send()})}function Nee(t,e,n){return{promise:new Promise((i,a)=>{xNe(t,e,n).then(i).catch(a)}),cancelFn:void 0,decache:()=>{}}}async function xNe(t,e,n){const i=t.split(":").slice(1).join(":"),a=await yNe({url:i,loaderOptions:n});if(!e||!("geometryData"in e))throw new Error("Mesh must have a geometryData");return Aee(i,{...e.geometryData,arrayBuffer:a})}let N3={beforeSend(t){}};function bNe(t){N3=Object.assign(N3,t)}function wNe(){return N3}const Lee={};let c2;function kee(t,e){const n=t.indexOf(":"),r=t.substring(0,n);let i=Lee[r];if(i==null){if(c2==null||typeof c2!="function")throw new Error(`No geometry loader for scheme ${r} has been registered`);i=c2}const a=i(t,e,N3);return a.promise.then(function(o){wt(vt,mt.GEOMETRY_LOADED,{geometry:o})},function(o){const s={geometryId:t,error:o};wt(vt,mt.GEOMETRY_LOADED_FAILED,s)}),a}function CNe(t,e){if(t===void 0)throw new Error("loadGeometry: parameter geometryId must not be undefined");let n=yt.getGeometryLoadObject(t);return n!==void 0||(n=kee(t,e)),n.promise}async function SNe(t,e){if(t===void 0)throw new Error("createAndCacheGeometry: parameter geometryId must not be undefined");let n=yt.getGeometryLoadObject(t);return n!==void 0||(n=kee(t,e),await yt.putGeometryLoadObject(t,n)),n.promise}function TNe(t,e){if(t===void 0)throw new Error("createAndCacheGeometry: parameter geometryId must not be undefined");let n=yt.getGeometry(t);if(n)return n;if(e.type===lu.CONTOUR)n=uNe(t,e.geometryData);else if(e.type===lu.SURFACE)n=dNe(t,e.geometryData);else if(e.type===lu.MESH)Aee(t,e.geometryData).then(r=>{n=r});else throw new Error(`Unknown geometry type: ${e.type}`);return yt.putGeometrySync(t,n),n}function Vee(t,e){Lee[t]=e}function ENe(t){const e=c2;return c2=t,e}Vee("mesh",Nee);const _Ne=Object.freeze(Object.defineProperty({__proto__:null,createAndCacheGeometry:TNe,getOptions:wNe,loadAndCacheGeometry:SNe,loadGeometry:CNe,registerGeometryLoader:Vee,registerUnknownGeometryLoader:ENe,setOptions:bNe},Symbol.toStringTag,{value:"Module"}));function DNe(t,e){if(!e||!e.imageIds||!e.imageIds.length)throw new Error("ImageIds must be provided to create a 4D streaming image volume");const{imageIds:n}=e,{splittingTag:r,imageIdGroups:i}=yO(n),a=Math.floor(i.length/2),o=YC(i[a],t),{metadata:s,dimensions:l,spacing:c,direction:f,sizeInBytes:u,origin:d,numberOfComponents:h,dataType:p}=o,g=f.slice(6,9),m=i.map(w=>H7(w,g).sortedImageIds),y=m.flat(),v=a0.createScalarDynamicVolumeVoxelManager({dimensions:l,imageIdGroups:m,dimensionGroupNumber:1,numberOfComponents:h});let x=new cee({volumeId:t,metadata:s,dimensions:l,spacing:c,origin:d,direction:f,sizeInBytes:u,imageIds:y,imageIdGroups:m,splittingTag:r,voxelManager:v,numberOfComponents:h,dataType:p},{imageIds:y,loadStatus:{loaded:!1,loading:!1,cancelled:!1,cachedFrames:[],callbacks:[]}});return{promise:Promise.resolve(x),decache:()=>{x.destroy(),x=null},cancel:()=>{x.cancelLoading()}}}const ONe=Object.freeze(Object.defineProperty({__proto__:null,BaseRenderingEngine:cO,BaseVolumeViewport:mo,CONSTANTS:Xh,ContextPoolRenderingEngine:K_,EPSILON:Zg,EVENTS:mt,Enums:ll,ImageVolume:Hm,ProgressiveRetrieveImages:X2,RenderingEngine:DQ,Settings:ei,StackViewport:fa,StreamingDynamicImageVolume:cee,StreamingImageVolume:zZ,Surface:OQ,TiledRenderingEngine:uO,VideoViewport:C3,Viewport:Bh,VolumeViewport:da,VolumeViewport3D:nS,WSIViewport:S3,addImageSlicesToViewports:EQ,addVolumesToViewports:TQ,cache:yt,canRenderFloatTextures:IC,convertMapperToNotSharedMapper:ZZ,cornerstoneMeshLoader:Nee,cornerstoneStreamingDynamicImageVolumeLoader:DNe,cornerstoneStreamingImageVolumeLoader:WZ,createCanvas:Fy,createViewportElement:vQ,createVolumeActor:y3,createVolumeMapper:JZ,eventTarget:vt,geometryLoader:_Ne,getConfiguration:Vf,getEnabledElement:Xe,getEnabledElementByIds:Ym,getEnabledElementByViewportId:xr,getEnabledElements:ree,getOrCreateCanvas:nl,getRenderingEngine:zf,getRenderingEngines:jl,getShouldUseCPURendering:Gg,getWebWorkerManager:Bm,imageLoadPoolManager:is,imageLoader:kDe,imageRetrievalPoolManager:Zm,init:iq,isCornerstoneInitialized:aq,metaData:AZ,peerImport:oq,registerImageLoader:qg,requestPoolManager:is,resetInitialization:$5e,resetUseCPURendering:B5e,setCanvasCreator:nOe,setConfiguration:G5e,setPreferSizeOverAccuracy:U5e,setUseCPURendering:F5e,setVolumesForViewports:SQ,triggerEvent:wt,utilities:Yr,version:XOe,volumeLoader:qDe},Symbol.toStringTag,{value:"Module"}));var wu;(function(t){t[t.Primary=1]="Primary",t[t.Secondary=2]="Secondary",t[t.Primary_And_Secondary=3]="Primary_And_Secondary",t[t.Auxiliary=4]="Auxiliary",t[t.Primary_And_Auxiliary=5]="Primary_And_Auxiliary",t[t.Secondary_And_Auxiliary=6]="Secondary_And_Auxiliary",t[t.Primary_And_Secondary_And_Auxiliary=7]="Primary_And_Secondary_And_Auxiliary",t[t.Fourth_Button=8]="Fourth_Button",t[t.Fifth_Button=16]="Fifth_Button",t[t.Wheel=524288]="Wheel",t[t.Wheel_Primary=524289]="Wheel_Primary"})(wu||(wu={}));var La;(function(t){t[t.Shift=16]="Shift",t[t.Ctrl=17]="Ctrl",t[t.Alt=18]="Alt",t[t.Meta=91]="Meta",t[t.ShiftCtrl=1617]="ShiftCtrl",t[t.ShiftAlt=1618]="ShiftAlt",t[t.ShiftMeta=1691]="ShiftMeta",t[t.CtrlAlt=1718]="CtrlAlt",t[t.CtrlMeta=1791]="CtrlMeta",t[t.AltMeta=1891]="AltMeta"})(La||(La={}));var br;(function(t){t.Active="Active",t.Passive="Passive",t.Enabled="Enabled",t.Disabled="Disabled"})(br||(br={}));var xf;(function(t){t.Default="",t.Highlighted="Highlighted",t.Selected="Selected",t.Locked="Locked",t.AutoGenerated="AutoGenerated"})(xf||(xf={}));var ee;(function(t){t.TOOL_ACTIVATED="CORNERSTONE_TOOLS_TOOL_ACTIVATED",t.TOOLGROUP_VIEWPORT_ADDED="CORNERSTONE_TOOLS_TOOLGROUP_VIEWPORT_ADDED",t.TOOLGROUP_VIEWPORT_REMOVED="CORNERSTONE_TOOLS_TOOLGROUP_VIEWPORT_REMOVED",t.TOOL_MODE_CHANGED="CORNERSTONE_TOOLS_TOOL_MODE_CHANGED",t.CROSSHAIR_TOOL_CENTER_CHANGED="CORNERSTONE_TOOLS_CROSSHAIR_TOOL_CENTER_CHANGED",t.VOLUMECROPPINGCONTROL_TOOL_CHANGED="CORNERSTONE_TOOLS_VOLUMECROPPINGCONTROL_TOOL_CHANGED",t.VOLUMECROPPING_TOOL_CHANGED="CORNERSTONE_TOOLS_VOLUMECROPPING_TOOL_CHANGED",t.ANNOTATION_ADDED="CORNERSTONE_TOOLS_ANNOTATION_ADDED",t.ANNOTATION_COMPLETED="CORNERSTONE_TOOLS_ANNOTATION_COMPLETED",t.ANNOTATION_MODIFIED="CORNERSTONE_TOOLS_ANNOTATION_MODIFIED",t.ANNOTATION_REMOVED="CORNERSTONE_TOOLS_ANNOTATION_REMOVED",t.ANNOTATION_SELECTION_CHANGE="CORNERSTONE_TOOLS_ANNOTATION_SELECTION_CHANGE",t.ANNOTATION_LOCK_CHANGE="CORNERSTONE_TOOLS_ANNOTATION_LOCK_CHANGE",t.ANNOTATION_VISIBILITY_CHANGE="CORNERSTONE_TOOLS_ANNOTATION_VISIBILITY_CHANGE",t.ANNOTATION_RENDERED="CORNERSTONE_TOOLS_ANNOTATION_RENDERED",t.ANNOTATION_CUT_MERGE_PROCESS_COMPLETED="CORNERSTONE_TOOLS_ANNOTATION_CUT_MERGE_PROCESS_COMPLETED",t.ANNOTATION_INTERPOLATION_PROCESS_COMPLETED="CORNERSTONE_TOOLS_ANNOTATION_INTERPOLATION_PROCESS_COMPLETED",t.INTERPOLATED_ANNOTATIONS_REMOVED="CORNERSTONE_TOOLS_INTERPOLATED_ANNOTATIONS_REMOVED",t.SEGMENTATION_MODIFIED="CORNERSTONE_TOOLS_SEGMENTATION_MODIFIED",t.SEGMENTATION_RENDERED="CORNERSTONE_TOOLS_SEGMENTATION_RENDERED",t.SEGMENTATION_REPRESENTATION_ADDED="CORNERSTONE_TOOLS_SEGMENTATION_REPRESENTATION_ADDED",t.SEGMENTATION_ADDED="CORNERSTONE_TOOLS_SEGMENTATION_ADDED",t.SEGMENTATION_REPRESENTATION_MODIFIED="CORNERSTONE_TOOLS_SEGMENTATION_REPRESENTATION_MODIFIED",t.SEGMENTATION_REMOVED="CORNERSTONE_TOOLS_SEGMENTATION_REMOVED",t.SEGMENTATION_REPRESENTATION_REMOVED="CORNERSTONE_TOOLS_SEGMENTATION_REPRESENTATION_REMOVED",t.SEGMENTATION_DATA_MODIFIED="CORNERSTONE_TOOLS_SEGMENTATION_DATA_MODIFIED",t.HISTORY_UNDO="CORNERSTONE_TOOLS_HISTORY_UNDO",t.HISTORY_REDO="CORNERSTONE_TOOLS_HISTORY_REDO",t.KEY_DOWN="CORNERSTONE_TOOLS_KEY_DOWN",t.KEY_UP="CORNERSTONE_TOOLS_KEY_UP",t.MOUSE_DOWN="CORNERSTONE_TOOLS_MOUSE_DOWN",t.MOUSE_UP="CORNERSTONE_TOOLS_MOUSE_UP",t.MOUSE_DOWN_ACTIVATE="CORNERSTONE_TOOLS_MOUSE_DOWN_ACTIVATE",t.MOUSE_DRAG="CORNERSTONE_TOOLS_MOUSE_DRAG",t.MOUSE_MOVE="CORNERSTONE_TOOLS_MOUSE_MOVE",t.MOUSE_CLICK="CORNERSTONE_TOOLS_MOUSE_CLICK",t.MOUSE_DOUBLE_CLICK="CORNERSTONE_TOOLS_MOUSE_DOUBLE_CLICK",t.MOUSE_WHEEL="CORNERSTONE_TOOLS_MOUSE_WHEEL",t.TOUCH_START="CORNERSTONE_TOOLS_TOUCH_START",t.TOUCH_START_ACTIVATE="CORNERSTONE_TOOLS_TOUCH_START_ACTIVATE",t.TOUCH_PRESS="CORNERSTONE_TOOLS_TOUCH_PRESS",t.TOUCH_DRAG="CORNERSTONE_TOOLS_TOUCH_DRAG",t.TOUCH_END="CORNERSTONE_TOOLS_TOUCH_END",t.TOUCH_TAP="CORNERSTONE_TOOLS_TAP",t.TOUCH_SWIPE="CORNERSTONE_TOOLS_SWIPE"})(ee||(ee={}));var hn;(function(t){t.Labelmap="Labelmap",t.Contour="Contour",t.Surface="Surface"})(hn||(hn={}));var mh;(function(t){t.UP="UP",t.DOWN="DOWN",t.LEFT="LEFT",t.RIGHT="RIGHT"})(mh||(mh={}));var jt;(function(t){t.OnInteractionStart="onInteractionStart",t.OnInteractionEnd="onInteractionEnd",t.Preview="preview",t.RejectPreview="rejectPreview",t.AcceptPreview="acceptPreview",t.Fill="fill",t.Interpolate="interpolate",t.StrategyFunction="strategyFunction",t.CreateIsInThreshold="createIsInThreshold",t.Initialize="initialize",t.INTERNAL_setValue="setValue",t.AddPreview="addPreview",t.ComputeInnerCircleRadius="computeInnerCircleRadius",t.GetStatistics="getStatistics",t.EnsureImageVolumeFor3DManipulation="ensureImageVolumeFor3DManipulation",t.EnsureSegmentationVolumeFor3DManipulation="ensureSegmentationVolumeFor3DManipulation"})(jt||(jt={}));var xn;(function(t){t.Interaction="Interaction",t.HandlesUpdated="HandlesUpdated",t.StatsUpdated="StatsUpdated",t.InitialSetup="InitialSetup",t.Completed="Completed",t.InterpolationUpdated="InterpolationUpdated",t.History="History",t.MetadataReferenceModified="MetadataReferenceModified",t.LabelChange="LabelChange"})(xn||(xn={}));var Gh;(function(t){t.POLYSEG_CONTOUR_TO_LABELMAP="Converting Contour to Labelmap",t.POLYSEG_SURFACE_TO_LABELMAP="Converting Surfaces to Labelmap",t.POLYSEG_CONTOUR_TO_SURFACE="Converting Contour to Surface",t.POLYSEG_LABELMAP_TO_SURFACE="Converting Labelmap to Surface",t.SURFACE_CLIPPING="Clipping Surfaces",t.COMPUTE_STATISTICS="Computing Statistics",t.INTERPOLATE_LABELMAP="Interpolating Labelmap",t.COMPUTE_LARGEST_BIDIRECTIONAL="Computing Largest Bidirectional",t.GENERATE_CONTOUR_SETS="Generating Contour Sets"})(Gh||(Gh={}));const MNe=Object.freeze(Object.defineProperty({__proto__:null,AnnotationStyleStates:xf,ChangeTypes:xn,Events:ee,get KeyboardBindings(){return La},get MouseBindings(){return wu},SegmentationRepresentations:hn,StrategyCallbacks:jt,get Swipe(){return mh},ToolModes:br,WorkerTypes:Gh},Symbol.toStringTag,{value:"Module"}));let INe={},Dt={isInteractingWithTool:!1,isMultiPartToolActive:!1,tools:{},toolGroups:[],synchronizers:[],svgNodeCache:INe,enabledElements:[]};var C8,qF;function RNe(){if(qF)return C8;qF=1;var t="Expected a function",e="__lodash_hash_undefined__",n="[object Function]",r="[object GeneratorFunction]",i="[object Symbol]",a=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,o=/^\w*$/,s=/^\./,l=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,c=/[\\^$.*+?()[\]{}|]/g,f=/\\(\\)?/g,u=/^\[object .+?Constructor\]$/,d=typeof vf=="object"&&vf&&vf.Object===Object&&vf,h=typeof self=="object"&&self&&self.Object===Object&&self,p=d||h||Function("return this")();function g(Ue,He){return Ue?.[He]}function m(Ue){var He=!1;if(Ue!=null&&typeof Ue.toString!="function")try{He=!!(Ue+"")}catch{}return He}var y=Array.prototype,v=Function.prototype,x=Object.prototype,w=p["__core-js_shared__"],S=(function(){var Ue=/[^.]+$/.exec(w&&w.keys&&w.keys.IE_PROTO||"");return Ue?"Symbol(src)_1."+Ue:""})(),T=v.toString,_=x.hasOwnProperty,D=x.toString,I=RegExp("^"+T.call(_).replace(c,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),R=p.Symbol,O=y.splice,P=Ne(p,"Map"),N=Ne(Object,"create"),A=R?R.prototype:void 0,B=A?A.toString:void 0;function V(Ue){var He=-1,Ct=Ue?Ue.length:0;for(this.clear();++He<Ct;){var $t=Ue[He];this.set($t[0],$t[1])}}function $(){this.__data__=N?N(null):{}}function U(Ue){return this.has(Ue)&&delete this.__data__[Ue]}function G(Ue){var He=this.__data__;if(N){var Ct=He[Ue];return Ct===e?void 0:Ct}return _.call(He,Ue)?He[Ue]:void 0}function F(Ue){var He=this.__data__;return N?He[Ue]!==void 0:_.call(He,Ue)}function J(Ue,He){var Ct=this.__data__;return Ct[Ue]=N&&He===void 0?e:He,this}V.prototype.clear=$,V.prototype.delete=U,V.prototype.get=G,V.prototype.has=F,V.prototype.set=J;function Q(Ue){var He=-1,Ct=Ue?Ue.length:0;for(this.clear();++He<Ct;){var $t=Ue[He];this.set($t[0],$t[1])}}function ne(){this.__data__=[]}function ye(Ue){var He=this.__data__,Ct=re(He,Ue);if(Ct<0)return!1;var $t=He.length-1;return Ct==$t?He.pop():O.call(He,Ct,1),!0}function ve(Ue){var He=this.__data__,Ct=re(He,Ue);return Ct<0?void 0:He[Ct][1]}function Ce(Ue){return re(this.__data__,Ue)>-1}function we(Ue,He){var Ct=this.__data__,$t=re(Ct,Ue);return $t<0?Ct.push([Ue,He]):Ct[$t][1]=He,this}Q.prototype.clear=ne,Q.prototype.delete=ye,Q.prototype.get=ve,Q.prototype.has=Ce,Q.prototype.set=we;function Ae(Ue){var He=-1,Ct=Ue?Ue.length:0;for(this.clear();++He<Ct;){var $t=Ue[He];this.set($t[0],$t[1])}}function Me(){this.__data__={hash:new V,map:new(P||Q),string:new V}}function q(Ue){return Pe(this,Ue).delete(Ue)}function k(Ue){return Pe(this,Ue).get(Ue)}function Y(Ue){return Pe(this,Ue).has(Ue)}function X(Ue,He){return Pe(this,Ue).set(Ue,He),this}Ae.prototype.clear=Me,Ae.prototype.delete=q,Ae.prototype.get=k,Ae.prototype.has=Y,Ae.prototype.set=X;function re(Ue,He){for(var Ct=Ue.length;Ct--;)if(ut(Ue[Ct][0],He))return Ct;return-1}function de(Ue,He){He=ie(He,Ue)?[He]:Oe(He);for(var Ct=0,$t=He.length;Ue!=null&&Ct<$t;)Ue=Ue[Se(He[Ct++])];return Ct&&Ct==$t?Ue:void 0}function he(Ue){if(!Fe(Ue)||Te(Ue))return!1;var He=Ot(Ue)||m(Ue)?I:u;return He.test(Ve(Ue))}function Ee(Ue){if(typeof Ue=="string")return Ue;if(st(Ue))return B?B.call(Ue):"";var He=Ue+"";return He=="0"&&1/Ue==-1/0?"-0":He}function Oe(Ue){return ht(Ue)?Ue:me(Ue)}function Pe(Ue,He){var Ct=Ue.__data__;return ae(He)?Ct[typeof He=="string"?"string":"hash"]:Ct.map}function Ne(Ue,He){var Ct=g(Ue,He);return he(Ct)?Ct:void 0}function ie(Ue,He){if(ht(Ue))return!1;var Ct=typeof Ue;return Ct=="number"||Ct=="symbol"||Ct=="boolean"||Ue==null||st(Ue)?!0:o.test(Ue)||!a.test(Ue)||He!=null&&Ue in Object(He)}function ae(Ue){var He=typeof Ue;return He=="string"||He=="number"||He=="symbol"||He=="boolean"?Ue!=="__proto__":Ue===null}function Te(Ue){return!!S&&S in Ue}var me=ue(function(Ue){Ue=ot(Ue);var He=[];return s.test(Ue)&&He.push(""),Ue.replace(l,function(Ct,$t,bn,Tn){He.push(bn?Tn.replace(f,"$1"):$t||Ct)}),He});function Se(Ue){if(typeof Ue=="string"||st(Ue))return Ue;var He=Ue+"";return He=="0"&&1/Ue==-1/0?"-0":He}function Ve(Ue){if(Ue!=null){try{return T.call(Ue)}catch{}try{return Ue+""}catch{}}return""}function ue(Ue,He){if(typeof Ue!="function"||He&&typeof He!="function")throw new TypeError(t);var Ct=function(){var $t=arguments,bn=He?He.apply(this,$t):$t[0],Tn=Ct.cache;if(Tn.has(bn))return Tn.get(bn);var en=Ue.apply(this,$t);return Ct.cache=Tn.set(bn,en),en};return Ct.cache=new(ue.Cache||Ae),Ct}ue.Cache=Ae;function ut(Ue,He){return Ue===He||Ue!==Ue&&He!==He}var ht=Array.isArray;function Ot(Ue){var He=Fe(Ue)?D.call(Ue):"";return He==n||He==r}function Fe(Ue){var He=typeof Ue;return!!Ue&&(He=="object"||He=="function")}function Qe(Ue){return!!Ue&&typeof Ue=="object"}function st(Ue){return typeof Ue=="symbol"||Qe(Ue)&&D.call(Ue)==i}function ot(Ue){return Ue==null?"":Ee(Ue)}function Mt(Ue,He,Ct){var $t=Ue==null?void 0:de(Ue,He);return $t===void 0?Ct:$t}return C8=Mt,C8}var PNe=RNe();const ANe=sl(PNe),XF=Symbol("DefinedCursors"),Fee=new Set(["alias","all-scroll","auto","cell","col-resize","context-menu","copy","crosshair","default","e-resize","ew-resize","grab","grabbing","help","move","ne-resize","nesw-resize","no-drop","none","not-allowed","n-resize","ns-resize","nw-resize","nwse-resize","pointer","progress","row-resize","se-resize","s-resize","sw-resize","text","vertical-text","wait","w-resize","zoom-in","zoom-out"]);class Js{constructor(e,n){this.name=e+"",this.fallback=n}getName(){return this.name+""}addFallbackStyleProperty(e){const{fallback:n}=this;return n instanceof Js?`${e}, ${n.getStyleProperty()}`:e+""}getStyleProperty(){return this.addFallbackStyleProperty(this.name)+""}static getDefinedCursor(e){const n=YF(Js,XF);let r=n.get(e);if(r instanceof Js)return r;if(Fee.has(e))return r=new Js(e),n.set(e,r),r}static setDefinedCursor(e,n){return n instanceof Js?(YF(Js,XF).set(e,n),!0):!1}}function YF(t,e){let n=t[e];return n instanceof Map||(n=new Map,Object.defineProperty(t,e,{value:n})),n}const NNe=Fee.values(),LNe="image-cursor";class L3 extends Js{constructor(e,n,r,i,a){super(i||L3.getUniqueInstanceName(LNe),a),this.url=e,this.x=Number(n)||0,this.y=Number(r)||0}getStyleProperty(){const{url:e,x:n,y:r}=this;let i=`url('${e}')`;return n>=0&&r>=0&&(n>0||r>0)&&(i+=` ${n} ${r}`),this.addFallbackStyleProperty(i)}static getUniqueInstanceName(e){return`${e}-${XQ(L3)}`}}const tr={iconContent:"",iconSize:16,viewBox:{x:16,y:16},mousePoint:{x:8,y:8},mousePointerGroupString:`
    <path stroke="{{color}}" d="M8 16L8 0"></path>
    <path stroke="{{color}}" d="M16 8L0 8"></path>
  `},bs={x:127,y:60},jp=`
<rect fill="{{color}}" x="80.19" y="25.03" width="47.14" height="15.85"/>
`,wd=`
<rect fill="{{color}}" x="80.19" y="25.03" width="47.14" height="15.85"/>
<rect fill="{{color}}" x="95.84" y="9.38" width="15.85" height="47.14"/>
`,db='<path fill="{{color}}" d="M82.89,10a12.09,12.09,0,0,0-16.8-2.5l-27.5,20.4-8.5-6.3a2.93,2.93,0,0,1-1.1-3,14.66,14.66,0,0,0,.1-6.6,14.08,14.08,0,1,0-6.5,15.2,2.87,2.87,0,0,1,3.2.2l8.2,6.1-8.2,6.1a2.87,2.87,0,0,1-3.2.2,14.16,14.16,0,1,0,6.7,14.4,14,14,0,0,0-.3-5.8,2.93,2.93,0,0,1,1.1-3l8.5-6.3,27.5,20.4A11.91,11.91,0,0,0,82.89,57l-31.7-23.5ZM15.29,21a5.9,5.9,0,1,1,5.9-5.9A5.91,5.91,0,0,1,15.29,21Zm0,36.8a5.9,5.9,0,1,1,5.9-5.9A5.91,5.91,0,0,1,15.29,57.77Zm28.3-21.5a2.8,2.8,0,1,1,2.8-2.8A2.8,2.8,0,0,1,43.59,36.27Z" transform="translate(-1.17 -0.96)"/>',zp='<path fill="{{color}}" d="M8.86,2.25V66.08H72.69V2.25H8.86ZM65.28,58.67h-49v-49h49v49Z" transform="translate(-8.86 -2.25)"/>',hb='<path fill="{{color}}" d="M40.77,2.25A31.92,31.92,0,1,0,72.69,34.16,31.92,31.92,0,0,0,40.77,2.25Zm0,57.63A25.71,25.71,0,1,1,66.48,34.16,25.71,25.71,0,0,1,40.77,59.87Z" transform="translate(-8.86 -2.25)"/>',Uee={Angle:nr(tr,{name:"Angle",iconContent:`<path fill="{{color}}" d="M1203 544q0 13-10 23l-393 393 393 393q10 10 10 23t-10 23l-50
    50q-10 10-23 10t-23-10l-466-466q-10-10-10-23t10-23l466-466q10-10 23-10t23
    10l50 50q10 10 10 23z" />`,viewBox:{x:1792,y:1792}}),ArrowAnnotate:nr(tr,{name:"ArrowAnnotate",iconContent:`<g id="arrowAnnotate-group" fill="none" stroke-width="1" stroke="{{color}}" stroke-linecap="round" stroke-linejoin="round">
    <path id="arrowAnnotate-arrow" d="M23,7 l-15,15 M7,17 l0,6 6,0" stroke-width="2" />
  </g>`,viewBox:{x:24,y:24}}),Bidirectional:nr(tr,{name:"Bidirectional",iconContent:`<g fill="{{color}}" stroke-width="3" stroke="{{color}}">
    <path d="M27.63 3.21L3.12 28.81"></path>
    <path d="M27.63 15.75L15.27 4.43"></path>
    <path d="M16.5 4.28C16.5 4.96 15.95 5.51 15.27 5.51C14.59 5.51 14.03 4.96 14.03 4.28C14.03 3.59 14.59 3.04 15.27 3.04C15.95 3.04 16.5 3.59 16.5 4.28Z" ></path>
    <path d="M28.87 3.19C28.87 3.87 28.31 4.43 27.63 4.43C26.95 4.43 26.4 3.87 26.4 3.19C26.4 2.51 26.95 1.95 27.63 1.95C28.31 1.95 28.87 2.51 28.87 3.19Z"></path>
    <path d="M28.87 15.75C28.87 16.43 28.31 16.99 27.63 16.99C26.95 16.99 26.4 16.43 26.4 15.75C26.4 15.07 26.95 14.51 27.63 14.51C28.31 14.51 28.87 15.07 28.87 15.75Z"></path>
    <path d="M4.73 28.44C4.73 29.12 4.17 29.68 3.49 29.68C2.81 29.68 2.25 29.12 2.25 28.44C2.25 27.76 2.81 27.2 3.49 27.2C4.17 27.2 4.73 27.76 4.73 28.44Z"></path>
  </g>`,viewBox:{x:48,y:48}}),CobbAngle:nr(tr,{name:"CobbAngle",iconContent:`<g stroke="{{color}}" stroke-width="3">
    <path d="M28.59 2.34L3.82 12.32"></path>
    <path d="M28.59 29.66L3.82 19.68"></path>
    <path stroke-dasharray="2" fill-opacity="0" d="M12.37
      23.06C12.67 22.36 12.85 21.93 12.92 21.76C14.6 17.8 14.68 13.35 13.15
      9.33C13.11 9.24 13.02 9 12.88 8.63">
    </path>
  </g>`,viewBox:{x:32,y:32}}),CircleROI:nr(tr,{name:"CircleROI",iconContent:'<circle stroke="{{color}}" fill="none" stroke-width="3" cx="16" cy="16" r="14" />',viewBox:{x:32,y:32}}),EllipticalROI:nr(tr,{name:"EllipticalROI",iconContent:`<path stroke="{{color}}" fill="none" stroke-width="3" d="M30.74 15.76C30.74 20.99 24.14 25.23 16
    25.23C7.86 25.23 1.26 20.99 1.26 15.76C1.26 10.54 7.86 6.3 16 6.3C24.14
    6.3 30.74 10.54 30.74 15.76Z" />`,viewBox:{x:32,y:32}}),FreehandROI:nr(tr,{name:"FreehandROI",iconContent:`<g fill="{{color}}" stroke="{{color}}" stroke-width="2">
    <ellipse ry="1" rx="1" id="svg_3" cy="4.240343" cx="14.306499"/>
    <line id="svg_4" y2="3.58462" x2="12.242186" y1="3.997482" x1="13.432202"/>
    <line id="svg_5" y2="3.268901" x2="10.857882" y1="3.608906" x1="12.387902"/>
    <line id="svg_6" y2="3.147471" x2="9.740724" y1="3.293187" x1="10.955026"/>
    <line id="svg_7" y2="3.147471" x2="8.089274" y1="3.196043" x1="9.983585"/>
    <line id="svg_8" y2="3.268901" x2="6.874972" y1="3.123185" x1="8.307848"/>
    <line id="svg_9" y2="3.657478" x2="5.587812" y1="3.220329" x1="7.020688"/>
    <line id="svg_10" y2="4.046054" x2="4.737801" y1="3.560334" x1="5.854959"/>
    <line id="svg_11" y2="4.337487" x2="4.300652" y1="3.997482" x1="4.834945"/>
    <line id="svg_12" y2="4.726063" x2="3.88779" y1="4.191771" x1="4.470655"/>
    <line id="svg_15" y2="5.3575" x2="3.377783" y1="4.604633" x1="3.960648"/>
    <line id="svg_16" y2="6.183226" x2="2.916348" y1="5.138926" x1="3.547785"/>
    <line id="svg_17" y2="6.960379" x2="2.770632" y1="5.867507" x1="3.037779"/>
    <line id="svg_18" y2="7.713246" x2="2.673488" y1="6.741804" x1="2.819204"/>
    <line id="svg_19" y2="8.684687" x2="2.697774" y1="7.616102" x1="2.673488"/>
    <line id="svg_20" y2="9.753273" x2="2.892062" y1="8.611829" x1="2.697774"/>
    <line id="svg_21" y2="10.724714" x2="3.134923" y1="9.534698" x1="2.84349"/>
    <line id="svg_23" y2="11.647583" x2="3.596357" y1="10.578998" x1="3.086351"/>
    <line id="svg_25" y2="12.521881" x2="4.276366" y1="11.501867" x1="3.499213"/>
    <line id="svg_26" y2="13.930471" x2="5.830673" y1="12.376165" x1="4.13065"/>
    <line id="svg_28" y2="14.707624" x2="7.263549" y1="13.881899" x1="5.733528"/>
    <line id="svg_29" y2="15.339061" x2="8.963571" y1="14.61048" x1="7.06926"/>
    <line id="svg_30" y2="15.581921" x2="10.882168" y1="15.314775" x1="8.817855"/>
    <line id="svg_31" y2="15.460491" x2="12.023612" y1="15.581921" x1="10.785024"/>
    <line id="svg_33" y2="15.120487" x2="13.092197" y1="15.484777" x1="11.877895"/>
    <line id="svg_34" y2="14.586194" x2="13.86935" y1="15.217631" x1="12.897909"/>
    <line id="svg_35" y2="13.833327" x2="14.597931" y1="14.756196" x1="13.699348"/>
    <line id="svg_37" y2="12.716169" x2="15.180796" y1="13.881899" x1="14.549359"/>
    <line id="svg_39" y2="11.429009" x2="15.520801" y1="12.813313" x1="15.15651"/>
    <ellipse ry="1" rx="1" id="svg_40" cy="10.967574" cx="15.520801"/>
  </g>`,viewBox:{x:18,y:18}}),FreehandROISculptor:nr(tr,{name:"FreehandROISculptor",iconContent:`<g id="icon-freehand-sculpt" fill="none" stroke-width="1.5" stroke="{{color}}" stroke-linecap="round" stroke-linejoin="round">
    <line id="svg_1" y2="2.559367" x2="10.184807" y1="4.467781" x1="8.81711"/>
    <line id="svg_4" y2="1.493836" x2="11.727442" y1="2.766112" x1="10.089386"/>
    <line id="svg_7" y2="1.080346" x2="13.047428" y1="1.748291" x1="11.345759"/>
    <line id="svg_8" y2="1.000829" x2="14.351511" y1="1.112153" x1="12.77707"/>
    <line id="svg_9" y2="1.350705" x2="15.242104" y1="0.905408" x1="13.969828"/>
    <line id="svg_10" y2="2.098167" x2="15.862339" y1="1.14396" x1="14.955842"/>
    <line id="svg_11" y2="3.195505" x2="16.41896" y1="1.939133" x1="15.766918"/>
    <line id="svg_12" y2="4.292843" x2="16.530284" y1="2.925147" x1="16.387153"/>
    <line id="svg_16" y2="5.644637" x2="16.196311" y1="3.831643" x1="16.593898"/>
    <line id="svg_18" y2="7.266789" x2="15.623787" y1="5.19934" x1="16.275829"/>
    <line id="svg_19" y2="10.813258" x2="14.526449" y1="6.726071" x1="15.766918"/>
    <line id="svg_20" y2="5.056209" x2="8.085552" y1="4.181519" x1="8.976145"/>
    <line id="svg_23" y2="5.326568" x2="7.481221" y1="4.78585" x1="8.403621"/>
    <line id="svg_24" y2="5.565119" x2="6.749662" y1="5.294761" x1="7.624352"/>
    <line id="svg_25" y2="5.994512" x2="5.429675" y1="5.533312" x1="6.956407"/>
    <line id="svg_27" y2="6.551133" x2="4.284627" y1="5.962706" x1="5.572807"/>
    <line id="svg_28" y2="7.584858" x2="3.044158" y1="6.392099" x1="4.427758"/>
    <line id="svg_29" y2="8.84123" x2="2.185372" y1="7.489437" x1="3.219096"/>
    <line id="svg_31" y2="10.606513" x2="1.644654" y1="8.602678" x1="2.280792"/>
    <line id="svg_32" y2="13.214679" x2="1.48562" y1="10.352058" x1="1.724171"/>
    <line id="svg_33" y2="14.375631" x2="1.676461" y1="12.992031" x1="1.453813"/>
    <line id="svg_34" y2="15.298031" x2="2.264889" y1="14.152983" x1="1.517427"/>
    <line id="svg_35" y2="16.172721" x2="3.521261" y1="14.948155" x1="1.915013"/>
    <line id="svg_36" y2="16.824762" x2="5.207027" y1="15.997783" x1="3.28271"/>
    <line id="svg_38" y2="17.063314" x2="7.035924" y1="16.745245" x1="4.968475"/>
    <line id="svg_39" y2="16.888376" x2="9.278311" y1="17.047411" x1="6.733758"/>
    <line id="svg_40" y2="16.284045" x2="10.661911" y1="16.983797" x1="8.992048"/>
    <line id="svg_41" y2="15.313934" x2="11.647925" y1="16.395369" x1="10.455166"/>
    <line id="svg_44" y2="13.898527" x2="12.82478" y1="15.425259" x1="11.504794"/>
    <line id="svg_45" y2="12.037824" x2="14.144766" y1="14.312017" x1="12.522614"/>
    <line id="svg_47" y2="10.59061" x2="14.605966" y1="12.228665" x1="13.953925"/>
    <ellipse ry="1" rx="1" id="svg_48" cy="3.982726" cx="13.460918"/>
  </g>`,viewBox:{x:18,y:18}}),Length:nr(tr,{name:"Length",iconContent:`<g id="length-group" fill="none" stroke-width="1" stroke="{{color}}" stroke-linecap="round" stroke-linejoin="round">
    <path id="length-dashes" d="m22.5,6 -16.5,16.5" stroke-width="3" stroke-dasharray="0.6666,5" />
  </g>`,viewBox:{x:24,y:24}}),Height:nr(tr,{name:"Height",iconContent:'<path d="m 6 22 l 8.5 0 v -16 h 8" stroke-width="3" fill="none" stroke="{{color}}" />',viewBox:{x:24,y:24}}),Probe:nr(tr,{name:"Probe",iconContent:`<path fill="{{color}}" d="M1152 896q0 106-75 181t-181 75-181-75-75-181 75-181 181-75 181 75
    75 181zm-256-544q-148 0-273 73t-198 198-73 273 73 273 198 198 273 73 273-73
    198-198 73-273-73-273-198-198-273-73zm768 544q0 209-103 385.5t-279.5
    279.5-385.5 103-385.5-103-279.5-279.5-103-385.5 103-385.5 279.5-279.5
    385.5-103 385.5 103 279.5 279.5 103 385.5z" />`,viewBox:{x:1792,y:1792}}),RectangleROI:nr(tr,{name:"RectangleROI",iconContent:`<path fill="{{color}}" d="M1312 256h-832q-66 0-113 47t-47 113v832q0 66 47
    113t113 47h832q66 0 113-47t47-113v-832q0-66-47-113t-113-47zm288 160v832q0
    119-84.5 203.5t-203.5 84.5h-832q-119 0-203.5-84.5t-84.5-203.5v-832q0-119
    84.5-203.5t203.5-84.5h832q119 0 203.5 84.5t84.5 203.5z" />`,viewBox:{x:1792,y:1792}}),Label:nr(tr,{name:"Label",iconContent:`<path fill="{{color}}" d="M789 559l-170 450q33 0 136.5 2t160.5 2q19 0
    57-2-87-253-184-452zm-725 1105l2-79q23-7 56-12.5t57-10.5 49.5-14.5 44.5-29
    31-50.5l237-616 280-724h128q8 14 11 21l205 480q33 78 106 257.5t114 274.5q15
    34 58 144.5t72 168.5q20 45 35 57 19 15 88 29.5t84 20.5q6 38 6 57 0 5-.5
    13.5t-.5 12.5q-63 0-190-8t-191-8q-76 0-215 7t-178 8q0-43 4-78l131-28q1 0
    12.5-2.5t15.5-3.5 14.5-4.5 15-6.5 11-8 9-11
    2.5-14q0-16-31-96.5t-72-177.5-42-100l-450-2q-26 58-76.5 195.5t-50.5 162.5q0
    22 14 37.5t43.5 24.5 48.5 13.5 57 8.5 41 4q1 19 1 58 0 9-2 27-58
    0-174.5-10t-174.5-10q-8 0-26.5 4t-21.5 4q-80 14-188 14z" />`,viewBox:{x:1792,y:1792}}),Crosshairs:nr(tr,{name:"Crosshairs",iconContent:`<path fill="{{color}}" d="M1325 1024h-109q-26 0-45-19t-19-45v-128q0-26
    19-45t45-19h109q-32-108-112.5-188.5t-188.5-112.5v109q0 26-19 45t-45
    19h-128q-26 0-45-19t-19-45v-109q-108 32-188.5 112.5t-112.5 188.5h109q26
    0 45 19t19 45v128q0 26-19 45t-45 19h-109q32 108 112.5 188.5t188.5
    112.5v-109q0-26 19-45t45-19h128q26 0 45 19t19 45v109q108-32
    188.5-112.5t112.5-188.5zm339-192v128q0 26-19 45t-45 19h-143q-37 161-154.5
    278.5t-278.5 154.5v143q0 26-19 45t-45 19h-128q-26
    0-45-19t-19-45v-143q-161-37-278.5-154.5t-154.5-278.5h-143q-26
    0-45-19t-19-45v-128q0-26 19-45t45-19h143q37-161
    154.5-278.5t278.5-154.5v-143q0-26 19-45t45-19h128q26 0 45 19t19 45v143q161
    37 278.5 154.5t154.5 278.5h143q26 0 45 19t19 45z" />`,viewBox:{x:1792,y:1792}}),Eraser:nr(tr,{name:"Eraser",iconContent:`<path transform="translate(0,1792) scale(1,-1)" fill="{{color}}" d="M960 1408l336-384h-768l-336 384h768zm1013-1077q15
    34 9.5 71.5t-30.5 65.5l-896 1024q-38 44-96 44h-768q-38
    0-69.5-20.5t-47.5-54.5q-15-34-9.5-71.5t30.5-65.5l896-1024q38-44 96-44h768q38
    0 69.5 20.5t47.5 54.5z" />`,viewBox:{x:2048,y:1792}}),Magnify:nr(tr,{name:"Magnify",iconContent:`<path fill="{{color}}" d="M508.5 481.6l-129-129c-2.3-2.3-5.3-3.5-8.5-3.5h-10.3C395
    312 416 262.5 416 208 416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c54.5
    0 104-21 141.1-55.2V371c0 3.2 1.3 6.2 3.5 8.5l129 129c4.7 4.7 12.3 4.7 17
    0l9.9-9.9c4.7-4.7 4.7-12.3 0-17zM208 384c-97.3 0-176-78.7-176-176S110.7 32 208
    32s176 78.7 176 176-78.7 176-176 176z" />`,viewBox:{x:512,y:512}}),Pan:nr(tr,{name:"Pan",iconContent:`<path fill="{{color}}" d="M1411 541l-355 355 355 355 144-144q29-31 70-14 39 17
    39 59v448q0 26-19 45t-45 19h-448q-42 0-59-40-17-39 14-69l144-144-355-355-355
    355 144 144q31 30 14 69-17 40-59 40h-448q-26 0-45-19t-19-45v-448q0-42 40-59
    39-17 69 14l144 144 355-355-355-355-144 144q-19 19-45 19-12
    0-24-5-40-17-40-59v-448q0-26 19-45t45-19h448q42 0 59 40 17 39-14 69l-144
    144 355 355 355-355-144-144q-31-30-14-69 17-40 59-40h448q26 0 45 19t19
    45v448q0 42-39 59-13 5-25 5-26 0-45-19z" />`,viewBox:{x:1792,y:1792}}),Rotate:nr(tr,{name:"Rotate",iconContent:`<path fill="{{color}}" d="M1664 256v448q0 26-19 45t-45 19h-448q-42 0-59-40-17-39
    14-69l138-138q-148-137-349-137-104 0-198.5 40.5t-163.5 109.5-109.5
    163.5-40.5 198.5 40.5 198.5 109.5 163.5 163.5 109.5 198.5 40.5q119 0
    225-52t179-147q7-10 23-12 15 0 25 9l137 138q9 8 9.5 20.5t-7.5 22.5q-109
    132-264 204.5t-327 72.5q-156 0-298-61t-245-164-164-245-61-298 61-298
    164-245 245-164 298-61q147 0 284.5 55.5t244.5 156.5l130-129q29-31 70-14
    39 17 39 59z" />`,viewBox:{x:1792,y:1792}}),StackScroll:nr(tr,{name:"StackScroll",iconContent:`<path fill="{{color}}" d="M24 21v2c0 0.547-0.453 1-1 1h-22c-0.547
    0-1-0.453-1-1v-2c0-0.547 0.453-1 1-1h22c0.547 0 1 0.453 1 1zM24 13v2c0
    0.547-0.453 1-1 1h-22c-0.547 0-1-0.453-1-1v-2c0-0.547 0.453-1 1-1h22c0.547
    0 1 0.453 1 1zM24 5v2c0 0.547-0.453 1-1 1h-22c-0.547
    0-1-0.453-1-1v-2c0-0.547 0.453-1 1-1h22c0.547 0 1 0.453 1 1z" />`,viewBox:{x:24,y:28}}),WindowLevelRegion:nr(tr,{name:"WindowLevelRegion",iconContent:`<path fill="{{color}}" d="M1664 416v960q0 119-84.5 203.5t-203.5 84.5h-960q-119
    0-203.5-84.5t-84.5-203.5v-960q0-119 84.5-203.5t203.5-84.5h960q119 0 203.5
    84.5t84.5 203.5z" />`,viewBox:{x:1792,y:1792}}),WindowLevel:nr(tr,{name:"WindowLevel",iconContent:`
    <path fill="{{color}}" d="M14.5,3.5 a1 1 0 0 1 -11,11 Z" stroke="none" opacity="0.8" />
    <circle cx="9" cy="9" r="8" fill="none" stroke-width="2" stroke="{{color}}" />`,viewBox:{x:18,y:18}}),Zoom:nr(tr,{name:"Zoom",iconContent:`
  <path fill="{{color}}" d="M508.5 481.6l-129-129c-2.3-2.3-5.3-3.5-8.5-3.5h-10.3C395
    312 416 262.5 416 208 416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c54.5
    0 104-21 141.1-55.2V371c0 3.2 1.3 6.2 3.5 8.5l129 129c4.7 4.7 12.3 4.7 17
    0l9.9-9.9c4.7-4.7 4.7-12.3 0-17zM208 384c-97.3 0-176-78.7-176-176S110.7 32 208
    32s176 78.7 176 176-78.7 176-176 176z" />
  <path fill="{{color}}" transform="scale(0.22,0.22) translate(1400,0)" d="M1216
    320q0 26-19 45t-45 19h-128v1024h128q26 0 45 19t19 45-19 45l-256 256q-19
    19-45 19t-45-19l-256-256q-19-19-19-45t19-45 45-19h128v-1024h-128q-26
    0-45-19t-19-45 19-45l256-256q19-19 45-19t45 19l256 256q19 19 19 45z" />`,viewBox:{x:640,y:512}}),SegmentationFreeHandEraseInside:nr(tr,{name:"SegmentationFreeHandEraseInside",iconContent:`${db} ${jp}`,viewBox:bs}),SegmentationFreeHandFillInside:nr(tr,{name:"SegmentationFreeHandFillInside",iconContent:`${db} ${wd}`,viewBox:bs}),SegmentationFreeHandEraseOutside:nr(tr,{name:"SegmentationFreeHandEraseOutside",iconContent:`${db} ${jp}`,viewBox:bs}),SegmentationFreeHandFillOutside:nr(tr,{name:"SegmentationFreeHandFillOutside",iconContent:`${db} ${wd}`,viewBox:bs}),SegmentationRectangleEraseInside:nr(tr,{name:"SegmentationRectangleEraseInside",iconContent:`${zp} ${jp}`,viewBox:bs}),RectangleScissor:nr(tr,{name:"RectangleScissor",iconContent:`${zp} ${wd}`,viewBox:bs}),"RectangleScissor.FILL_INSIDE":nr(tr,{name:"RectangleScissor.FILL_INSIDE",iconContent:`${zp} ${wd}`,viewBox:bs}),"RectangleScissor.FILL_OUTSIDE":nr(tr,{name:"RectangleScissor.FILL_OUTSIDE",iconContent:`${zp} ${wd}`,viewBox:bs}),"RectangleScissor.ERASE_OUTSIDE":nr(tr,{name:"RectangleScissor.ERASE_OUTSIDE",iconContent:`${zp} ${jp}`,viewBox:bs}),"RectangleScissor.ERASE_INSIDE":nr(tr,{name:"RectangleScissor.ERASE_INSIDE",iconContent:`${zp} ${jp}`,viewBox:bs}),CircleScissor:nr(tr,{name:"CircleScissor",iconContent:`${hb} ${wd}`,viewBox:bs}),"CircleScissor.FILL_INSIDE":nr(tr,{name:"CircleScissor.FILL_INSIDE",iconContent:`${hb} ${wd}`,viewBox:bs}),"CircleScissor.ERASE_OUTSIDE":nr(tr,{name:"CircleScissor.ERASE_OUTSIDE",iconContent:`${hb} ${jp}`,viewBox:bs}),"CircleScissor.FILL_OUTSIDE":nr(tr,{name:"CircleScissor.FILL_OUTSIDE",iconContent:`${hb} ${wd}`,viewBox:bs})};function nr(t,e){return Object.assign(Object.create(t),{...e,name:e.name||t.name})}function kNe(t){return Uee[t]}const VNe=Object.keys(Uee);class FNe{constructor(){const e={color:"rgb(255, 255, 0)",colorHighlighted:"rgb(0, 255, 0)",colorSelected:"rgb(0, 220, 0)",colorLocked:"rgb(209, 193, 90)",lineWidth:"1",lineDash:"",shadow:!0,textBoxVisibility:!0,textBoxFontFamily:"Helvetica Neue, Helvetica, Arial, sans-serif",textBoxFontSize:"14px",textBoxColor:"rgb(255, 255, 0)",textBoxColorHighlighted:"rgb(0, 255, 0)",textBoxColorSelected:"rgb(0, 255, 0)",textBoxColorLocked:"rgb(209, 193, 90)",textBoxBackground:"",textBoxLinkLineWidth:"1",textBoxLinkLineDash:"2,3",textBoxShadow:!0,markerSize:"10",angleArcLineDash:""};this._initializeConfig(e)}getAnnotationToolStyles(e){return this.config.annotations&&this.config.annotations[e]}getViewportToolStyles(e){return this.config.viewports&&this.config.viewports[e]}getToolGroupToolStyles(e){return this.config.toolGroups&&this.config.toolGroups[e]}getDefaultToolStyles(){return this.config.default}setAnnotationStyles(e,n){let r=this.config.annotations;r||(this.config={...this.config,annotations:{}},r=this.config.annotations),r[e]=n}setViewportToolStyles(e,n){let r=this.config.viewports;r||(this.config={...this.config,viewports:{}},r=this.config.viewports),r[e]=n}setToolGroupToolStyles(e,n){let r=this.config.toolGroups;r||(this.config={...this.config,toolGroups:{}},r=this.config.toolGroups),r[e]=n}setDefaultToolStyles(e){this.config.default=e}getStyleProperty(e,n){const{annotationUID:r,viewportId:i,toolGroupId:a,toolName:o}=n;return this._getToolStyle(e,r,i,a,o)}_getToolStyle(e,n,r,i,a){if(n){const s=this.getAnnotationToolStyles(n);if(s&&s[e]!==void 0)return s[e]}if(r){const s=this.getViewportToolStyles(r);if(s){if(s[a]&&s[a][e]!==void 0)return s[a][e];if(s.global&&s.global[e]!==void 0)return s.global[e]}}if(i){const s=this.getToolGroupToolStyles(i);if(s){if(s[a]&&s[a][e]!==void 0)return s[a][e];if(s.global&&s.global[e]!==void 0)return s.global[e]}}const o=this.getDefaultToolStyles();if(o[a]&&o[a][e]!==void 0)return o[a][e];if(o.global&&o.global[e]!==void 0)return o.global[e]}_initializeConfig(e){const n={};for(const r in e)n[r]=e[r];this.config={default:{global:n}}}}const fw=new FNe;function UNe(t,e,n){const r=[`${t}`];return e&&r.push(`${r[0]}${e}`),n&&r.push(`${r[r.length-1]}${n}`),r}function Bee(t,e,n,r){const i=UNe(t,n,r);for(let a=i.length-1;a>=0;--a){const o=fw.getStyleProperty(i[a],e);if(o!==void 0)return o}}const BNe="color",$Ne=xf.Highlighted,GNe=br.Active;class dw extends L3{constructor(e,n,r,i,a){super(e,n,r,i,a)}static getDefinedCursor(e,n=!1,r){r||(r=Bee(BNe,{},$Ne,GNe));const i=jNe(e,n,r);let a=super.getDefinedCursor(i);if(!a){const o=kNe(e);o&&(a=zNe(o,i,n,r,super.getDefinedCursor("default")),super.setDefinedCursor(i,a))}return a}}function $ee(t,e){const n=Object(e),r=Object.prototype.hasOwnProperty.bind(n);return(t+"").replace(/\{\{(\w+)\}\}/g,(i,a)=>r(a)?n[a]+"":"")}function jNe(t,e,n){return`${e?"pointer":"cursor"}:${t}/${n}`}function zNe(t,e,n,r,i){const{x:a,y:o}=t.mousePoint;return new dw(WNe(t,n,{color:r}),a,o,e,i)}function WNe(t,e,n){const r=HNe(t,e,n);return`${URL.createObjectURL(r)}#${t.name||"unknown"}-${e?"pointer":"cursor"}`}function HNe(t,e,n){const r=(e?qNe:KNe)(t,n);return new Blob([r],{type:"image/svg+xml"})}function KNe(t,e){const{iconContent:n,iconSize:r,viewBox:i}=t,a=`
    <svg data-icon="cursor" role="img" xmlns="http://www.w3.org/2000/svg"
      width="${r}" height="${r}" viewBox="0 0
      ${i.x} ${i.y}">
      ${n}
    </svg>`;return $ee(a,e)}function qNe(t,e){const{iconContent:n,iconSize:r,viewBox:i,mousePointerGroupString:a}=t,o=r/Math.max(i.x,i.y,1),s=16+r,l=`
    <svg data-icon="cursor" role="img" xmlns="http://www.w3.org/2000/svg"
      width="${s}" height="${s}" viewBox="0 0 ${s} ${s}">
      <g>${a}</g>
      <g transform="translate(16, 16) scale(${o})">${n}</g>
    </svg>`;return $ee(l,e)}const JF=Symbol("ElementCursorsMap");function XNe(t,e){iy(t)[0]=e,TO(t,e)}function TO(t,e){const n=iy(t);n[1]=n[0],n[0]=e,t.style.cursor=(e instanceof Js?e:Js.getDefinedCursor("auto")).getStyleProperty()}function qn(t){TO(t,iy(t)[1])}function Rn(t){TO(t,Js.getDefinedCursor("none"))}function iy(t){let e=iy[JF];e instanceof WeakMap||(e=new WeakMap,Object.defineProperty(iy,JF,{value:e}));let n=e.get(t);return n||(n=[null,null],e.set(t,n)),n}[...VNe,...NNe];function jh(t){return Dt.toolGroups.find(e=>e.id===t)}const{Active:dv,Passive:S8,Enabled:T8,Disabled:E8}=br,YNe=[{mouseButton:wu.Primary}];class EO{constructor(e){this.viewportsInfo=[],this.toolOptions={},this.currentActivePrimaryToolName=null,this.prevActivePrimaryToolName=null,this.restoreToolOptions={},this._toolInstances={},this.id=e}getViewportIds(){return this.viewportsInfo.map(({viewportId:e})=>e)}getViewportsInfo(){return this.viewportsInfo.slice()}getToolInstance(e){const n=this._toolInstances[e];if(!n){console.warn(`'${e}' is not registered with this toolGroup (${this.id}).`);return}return n}getToolInstances(){return this._toolInstances}hasTool(e){return!!this._toolInstances[e]}addTool(e,n={}){const r=Dt.tools[e],i=typeof e<"u"&&e!=="",a=this.toolOptions[e];if(!i){console.warn("Tool with configuration did not produce a toolName: ",n);return}if(!r){console.warn(`'${e}' is not registered with the library. You need to use cornerstoneTools.addTool to register it.`);return}if(a){console.warn(`'${e}' is already registered for ToolGroup ${this.id}.`);return}const{toolClass:o}=r,s={name:e,toolGroupId:this.id,configuration:n},l=new o(s);this._toolInstances[e]=l}addToolInstance(e,n,r={}){let i=Dt.tools[e]?.toolClass;if(!i){const a=Dt.tools[n].toolClass;class o extends a{}o.toolName=e,i=o,Dt.tools[e]={toolClass:o}}this.addTool(i.toolName,r)}addViewport(e,n){if(typeof e!="string")throw new Error("viewportId must be defined and be a string");const r=this._findRenderingEngine(e,n);this.viewportsInfo.some(({viewportId:o})=>o===e)||this.viewportsInfo.push({viewportId:e,renderingEngineId:r});const i=this.getActivePrimaryMouseButtonTool();this.setViewportsCursorByToolName(i);const a={toolGroupId:this.id,viewportId:e,renderingEngineId:r};wt(vt,ee.TOOLGROUP_VIEWPORT_ADDED,a)}removeViewports(e,n){const r=[];if(this.viewportsInfo.forEach((a,o)=>{let s=!1;a.renderingEngineId===e&&(s=!0,n&&a.viewportId!==n&&(s=!1)),s&&r.push(o)}),r.length)for(let a=r.length-1;a>=0;a--)this.viewportsInfo.splice(r[a],1);const i={toolGroupId:this.id,viewportId:n,renderingEngineId:e};wt(vt,ee.TOOLGROUP_VIEWPORT_REMOVED,i)}setActiveStrategy(e,n){const r=this._toolInstances[e];if(r===void 0){console.warn(`Tool ${e} not added to toolGroup, can't set tool configuration.`);return}r.setActiveStrategy(n)}setToolMode(e,n,r={}){if(!e){console.warn("setToolMode: toolName must be defined");return}if(n===br.Active){this.setToolActive(e,r||this.restoreToolOptions[e]);return}if(n===br.Passive){this.setToolPassive(e);return}if(n===br.Enabled){this.setToolEnabled(e);return}if(n===br.Disabled){this.setToolDisabled(e);return}console.warn("setToolMode: mode must be defined")}setToolActive(e,n={}){const r=this._toolInstances[e];if(r===void 0){console.warn(`Tool ${e} not added to toolGroup, can't set tool mode.`);return}if(!r){console.warn(`'${e}' instance ${r} is not registered with this toolGroup, can't set tool mode.`);return}const i=this.toolOptions[e]?this.toolOptions[e].bindings:[],a=n.bindings?n.bindings:[],s={bindings:[...i,...a].reduce((c,f)=>{const u=f.numTouchPoints!==void 0,d=f.mouseButton!==void 0;return!c.some(h=>_8(h,f))&&(u||d)&&c.push(f),c},[]),mode:dv};if(this.toolOptions[e]=s,this._toolInstances[e].mode=dv,this._hasMousePrimaryButtonBinding(n))this.setViewportsCursorByToolName(e);else if(!this.getActivePrimaryMouseButtonTool()){const f=Js.getDefinedCursor("default");this._setCursorForViewports(f)}this._hasMousePrimaryButtonBinding(n)&&(this.prevActivePrimaryToolName===null?this.prevActivePrimaryToolName=e:this.prevActivePrimaryToolName=this.currentActivePrimaryToolName,this.currentActivePrimaryToolName=e),typeof r.onSetToolActive=="function"&&r.onSetToolActive(),this._renderViewports();const l={toolGroupId:this.id,toolName:e,toolBindingsOptions:n};wt(vt,ee.TOOL_ACTIVATED,l),this._triggerToolModeChangedEvent(e,dv,n)}setToolPassive(e,n){const r=this._toolInstances[e];if(r===void 0){console.warn(`Tool ${e} not added to toolGroup, can't set tool mode.`);return}const i=this.getToolOptions(e),a=Object.assign({bindings:i?i.bindings:[]},i,{mode:S8}),o=Array.isArray(n?.removeAllBindings)?n.removeAllBindings:this.getDefaultPrimaryBindings();a.bindings=a.bindings.filter(l=>n?.removeAllBindings!==!0&&!o.some(c=>_8(l,c)));let s=S8;a.bindings.length!==0&&(s=dv,a.mode=s),this.toolOptions[e]=a,r.mode=s,typeof r.onSetToolPassive=="function"&&r.onSetToolPassive(),this._renderViewports(),this._triggerToolModeChangedEvent(e,S8)}setToolEnabled(e){const n=this._toolInstances[e];if(n===void 0){console.warn(`Tool ${e} not added to toolGroup, can't set tool mode.`);return}const r={bindings:[],mode:T8};this.toolOptions[e]=r,n.mode=T8,typeof n.onSetToolEnabled=="function"&&n.onSetToolEnabled(),this._renderViewports(),this._triggerToolModeChangedEvent(e,T8)}setToolDisabled(e){const n=this._toolInstances[e];if(n===void 0){console.warn(`Tool ${e} not added to toolGroup, can't set tool mode.`);return}const r={bindings:[],mode:E8};this.restoreToolOptions[e]=this.toolOptions[e],this.toolOptions[e]=r,n.mode=E8,typeof n.onSetToolDisabled=="function"&&n.onSetToolDisabled(),this._renderViewports(),this._triggerToolModeChangedEvent(e,E8)}getToolOptions(e){const n=this.toolOptions[e];if(n!==void 0)return n}getActivePrimaryMouseButtonTool(){return Object.keys(this.toolOptions).find(e=>{const n=this.toolOptions[e];return n.mode===dv&&this._hasMousePrimaryButtonBinding(n)})}setViewportsCursorByToolName(e,n){const r=this._getCursor(e,n);this._setCursorForViewports(r)}_getCursor(e,n){let r,i;return n&&(r=`${e}.${n}`,i=dw.getDefinedCursor(r,!0),i)||(r=`${e}`,i=dw.getDefinedCursor(r,!0),i)||(r=e,i=dw.getDefinedCursor(r,!0),i)?i:Js.getDefinedCursor("default")}_setCursorForViewports(e){ei.getRuntimeSettings().get("useCursors")&&this.viewportsInfo.forEach(({renderingEngineId:r,viewportId:i})=>{const a=Ym(i,r);if(!a)return;const{viewport:o}=a;XNe(o.element,e)})}setToolConfiguration(e,n,r){const i=this._toolInstances[e];if(i===void 0)return console.warn(`Tool ${e} not present, can't set tool configuration.`),!1;let a;return r?a=n:a=Object.assign(i.configuration,n),i.configuration=a,typeof i.onSetToolConfiguration=="function"&&i.onSetToolConfiguration(),this._renderViewports(),!0}getDefaultMousePrimary(){return wu.Primary}getDefaultPrimaryBindings(){return YNe}getToolConfiguration(e,n){if(this._toolInstances[e]===void 0){console.warn(`Tool ${e} not present, can't set tool configuration.`);return}const r=ANe(this._toolInstances[e].configuration,n)||this._toolInstances[e].configuration;return mc(r)}getPrevActivePrimaryToolName(){return this.prevActivePrimaryToolName}setActivePrimaryTool(e){const n=this.getCurrentActivePrimaryToolName();this.setToolDisabled(n),this.setToolActive(e,{bindings:[{mouseButton:wu.Primary}]})}getCurrentActivePrimaryToolName(){return this.currentActivePrimaryToolName}clone(e,n=null){let r=jh(e);return r?(console.debug(`ToolGroup ${e} already exists`),r):(r=new EO(e),Dt.toolGroups.push(r),n=n??(()=>!0),Object.keys(this._toolInstances).filter(n).forEach(i=>{const a=this._toolInstances[i],o=this.toolOptions[i],s=a.mode;r.addTool(i),r.setToolMode(i,s,{bindings:o.bindings??[]})}),r)}_hasMousePrimaryButtonBinding(e){const n=this.getDefaultPrimaryBindings();return e?.bindings?.some(r=>n.some(i=>_8(r,i)))}_renderViewports(){this.viewportsInfo.forEach(({renderingEngineId:e,viewportId:n})=>{zf(e).renderViewport(n)})}_triggerToolModeChangedEvent(e,n,r){const i={toolGroupId:this.id,toolName:e,mode:n,toolBindingsOptions:r};wt(vt,ee.TOOL_MODE_CHANGED,i)}_findRenderingEngine(e,n){const r=jl();if(r?.length===0)throw new Error("No rendering engines found.");if(n)return n;const i=r.filter(a=>a.getViewport(e));if(i.length===0){if(r.length===1)return r[0].id;throw new Error("No rendering engines found that contain the viewport with the same viewportId, you must specify a renderingEngineId.")}if(i.length>1)throw new Error("Multiple rendering engines found that contain the viewport with the same viewportId, you must specify a renderingEngineId.");return i[0].id}}function _8(t,e){return t.mouseButton!==e.mouseButton||t.numTouchPoints!==e.numTouchPoints?!1:t.modifierKey===e.modifierKey}function JNe(t){if(Dt.toolGroups.some(r=>r.id===t)){console.warn(`'${t}' already exists.`);return}const n=new EO(t);return Dt.toolGroups.push(n),n}function ZF(t){const e=Dt.toolGroups.findIndex(n=>n.id===t);e>-1&&Dt.toolGroups.splice(e,1)}function to(t,e){e||(e=jl().find(r=>r.getViewports().find(i=>i.id===t))?.id);const n=Dt.toolGroups.filter(r=>r.viewportsInfo.some(i=>i.renderingEngineId===e&&(!i.viewportId||i.viewportId===t)));if(n.length){if(n.length>1)throw new Error(`Multiple tool groups found for renderingEngineId: ${e} and viewportId: ${t}. You should only
      have one tool group per viewport in a renderingEngine.`);return n[0]}}const ZNe=[br.Active,br.Passive,br.Enabled];function QNe(t){return Dt.toolGroups.filter(({toolOptions:e})=>{const n=Object.keys(e);for(let r=0;r<n.length;r++)if(t===n[r]&&e[t]&&ZNe.includes(e[t].mode))return!0;return!1})}function Gee(t,e){const n=Xe(e),{renderingEngine:r,viewportId:i}=n,a=ee.ANNOTATION_ADDED,o={annotation:t,viewportId:i,renderingEngineId:r.id};wt(vt,a,o)}function jee(t){const{toolName:e}=t.metadata,n=QNe(e);if(!n.length)return;const r=[];n.forEach(o=>{o.viewportsInfo.forEach(s=>{const{renderingEngineId:l,viewportId:c}=s,{FrameOfReferenceUID:f}=Ym(c,l);t.metadata.FrameOfReferenceUID===f&&r.push(s)})});const i=ee.ANNOTATION_ADDED,a={annotation:t};if(!r.length){wt(vt,i,a);return}r.forEach(({renderingEngineId:o,viewportId:s})=>{a.viewportId=s,a.renderingEngineId=o,wt(vt,i,a)})}function aS(t){const e=ee.ANNOTATION_REMOVED;wt(vt,e,t)}function Un(t,e,n=xn.HandlesUpdated){const r=e&&Xe(e),{viewportId:i,renderingEngineId:a}=r||{},o=ee.ANNOTATION_MODIFIED;wt(vt,o,{annotation:t,viewportId:i,renderingEngineId:a,changeType:n})}function Xr(t){zee({annotation:t})}function oS(t,e=!1){zee({annotation:t,contourHoleProcessingEnabled:e})}function zee(t){const e=ee.ANNOTATION_COMPLETED;wt(vt,e,t)}const eLe=Object.freeze(Object.defineProperty({__proto__:null,triggerAnnotationAddedForElement:Gee,triggerAnnotationAddedForFOR:jee,triggerAnnotationCompleted:Xr,triggerAnnotationModified:Un,triggerAnnotationRemoved:aS,triggerContourAnnotationCompleted:oS},Symbol.toStringTag,{value:"Module"}));let Wee;function Ou(){return Wee}function _O(t){Wee=t}function Zi(t,e){const n=Ou(),r=n.getGroupKey(e);return n.getAnnotations(r,t)}function vo(t){return Ou().getAnnotation(t)}function sS(){return Ou().getAllAnnotations()}function lS(t){const{annotationUID:e,parentAnnotationUID:n}=t;if(!n)return;const r=vo(n),i=r.childAnnotationUIDs.indexOf(e);r.childAnnotationUIDs.splice(i,1),t.parentAnnotationUID=void 0}function Gy(t,e){const{annotationUID:n}=t,{annotationUID:r}=e;lS(e),t.childAnnotationUIDs||(t.childAnnotationUIDs=[]),!t.childAnnotationUIDs.includes(r)&&(t.childAnnotationUIDs.push(r),e.parentAnnotationUID=n)}function Hee(t){return t.parentAnnotationUID?vo(t.parentAnnotationUID):void 0}function jy(t){return t.childAnnotationUIDs?.map(e=>vo(e))??[]}function mr(t,e){t.annotationUID||(t.annotationUID=cr());const n=Ou();if(e instanceof HTMLDivElement){const r=n.getGroupKey(e);n.addAnnotation(t,r),Gee(t,e)}else n.addAnnotation(t,void 0),jee(t);return t.annotationUID}function tLe(t,e){const n=Ou(),r=n.getGroupKey(e);return n.getNumberOfAnnotations(r,t)}function _r(t){if(!t)return;const e=Ou(),n=e.getAnnotation(t);n&&(n.childAnnotationUIDs?.forEach(r=>_r(r)),e.removeAnnotation(t),aS({annotation:n,annotationManagerUID:e.uid}))}function nLe(){const t=Ou(),e=t.removeAllAnnotations();for(const n of e)aS({annotation:n,annotationManagerUID:t.uid})}function rLe(t,e){const n=Ou(),r=n.getGroupKey(e),i=n.removeAnnotations(r,t);for(const a of i)aS({annotation:a,annotationManagerUID:n.uid})}function Kee(t){let e=t;for(;e;)e.invalidated=!0,e=e.parentAnnotationUID?vo(e.parentAnnotationUID):void 0}const iLe=Object.freeze(Object.defineProperty({__proto__:null,addAnnotation:mr,addChildAnnotation:Gy,clearParentAnnotation:lS,getAllAnnotations:sS,getAnnotation:vo,getAnnotationManager:Ou,getAnnotations:Zi,getChildAnnotations:jy,getNumberOfAnnotations:tLe,getParentAnnotation:Hee,invalidateAnnotation:Kee,removeAllAnnotations:nLe,removeAnnotation:_r,removeAnnotations:rLe,setAnnotationManager:_O},Symbol.toStringTag,{value:"Module"}));function Qr(t){const e=t.toolName;if(!e)throw new Error(`No Tool Found for the ToolClass ${t.name}`);Dt.tools[e]||(Dt.tools[e]={toolClass:t})}function cS(t){return!!(t&&Dt.tools[t])}function Zh(t,e){const n=e||t.currentTarget,{viewport:r}=Xe(n)||{};if(!r)return;const i=sLe(t),a=oLe(t),o=aLe(n,a),s=r.canvasToWorld(o);return{page:a,client:i,canvas:o,world:s}}function aLe(t,e){const n=t.getBoundingClientRect();return[e[0]-n.left-window.pageXOffset,e[1]-n.top-window.pageYOffset]}function oLe(t){return[t.pageX,t.pageY]}function sLe(t){return[t.clientX,t.clientY]}function qee(t){const e=t.currentTarget,{viewportId:n,renderingEngineId:r}=Xe(e),i=Zh(t,e),a={page:[0,0],client:[0,0],canvas:[0,0],world:[0,0,0]},o={event:t,eventName:ee.MOUSE_DOUBLE_CLICK,viewportId:n,renderingEngineId:r,camera:{},element:e,startPoints:i,lastPoints:i,currentPoints:i,deltaPoints:a};!wt(e,ee.MOUSE_DOUBLE_CLICK,o)&&(t.stopImmediatePropagation(),t.preventDefault())}const QF=ee.MOUSE_MOVE;function zy(t){const e=t.currentTarget,n=Xe(e);if(!n)return;const{renderingEngineId:r,viewportId:i}=n,a=Zh(t);!wt(e,QF,{renderingEngineId:r,viewportId:i,camera:{},element:e,currentPoints:a,eventName:QF,event:t})&&(t.stopImmediatePropagation(),t.preventDefault())}const{MOUSE_DOWN:eU,MOUSE_DOWN_ACTIVATE:lLe,MOUSE_CLICK:cLe,MOUSE_UP:uLe,MOUSE_DRAG:tU}=ee,fLe=400,dLe=150,hLe=3,pLe={mouseButton:void 0,element:null,renderingEngineId:void 0,viewportId:void 0,isClickEvent:!0,clickDelay:200,preventClickTimeout:null,startPoints:{page:[0,0],client:[0,0],canvas:[0,0],world:[0,0,0]},lastPoints:{page:[0,0],client:[0,0],canvas:[0,0],world:[0,0,0]}};let mn={mouseButton:void 0,renderingEngineId:void 0,viewportId:void 0,isClickEvent:!0,clickDelay:200,element:null,preventClickTimeout:null,startPoints:{page:[0,0],client:[0,0],canvas:[0,0],world:[0,0,0]},lastPoints:{page:[0,0],client:[0,0],canvas:[0,0],world:[0,0,0]}};const Sa={doubleClickTimeout:null,mouseDownEvent:null,mouseUpEvent:null,ignoreDoubleClick:!1};function Xee(t){if(Sa.doubleClickTimeout){if(t.buttons===Sa.mouseDownEvent.buttons)return;Sa.mouseDownEvent=t,k3();return}Sa.doubleClickTimeout=setTimeout(k3,t.buttons===1?fLe:dLe),Sa.mouseDownEvent=t,Sa.ignoreDoubleClick=!1,mn.element=t.currentTarget,mn.mouseButton=t.buttons;const e=Xe(mn.element),{renderingEngineId:n,viewportId:r}=e;mn.renderingEngineId=n,mn.viewportId=r,mn.preventClickTimeout=setTimeout(mLe,mn.clickDelay),mn.element.removeEventListener("mousemove",zy);const i=Zh(t,mn.element);mn.startPoints=Xd(i),mn.lastPoints=Xd(i),document.addEventListener("mouseup",DO),document.addEventListener("mousemove",Yee)}function gLe(t){const e=uS(mn.startPoints,mn.startPoints),n={event:t,eventName:eU,element:mn.element,mouseButton:mn.mouseButton,renderingEngineId:mn.renderingEngineId,viewportId:mn.viewportId,camera:{},startPoints:mn.startPoints,lastPoints:mn.startPoints,currentPoints:mn.startPoints,deltaPoints:e};mn.lastPoints=Xd(n.lastPoints),wt(n.element,eU,n)&&wt(n.element,lLe,n)}function Yee(t){if(!Xe(mn.element)?.viewport)return;const n=Zh(t,mn.element),r=ete(mn.element,mn.lastPoints),i=uS(n,r);if(Sa.doubleClickTimeout)if(Zee(i.canvas))k3();else return;const a={event:t,eventName:tU,mouseButton:mn.mouseButton,renderingEngineId:mn.renderingEngineId,viewportId:mn.viewportId,camera:{},element:mn.element,startPoints:Xd(mn.startPoints),lastPoints:Xd(r),currentPoints:n,deltaPoints:i};!wt(mn.element,tU,a)&&(t.stopImmediatePropagation(),t.preventDefault()),mn.lastPoints=Xd(n)}function DO(t){if(clearTimeout(mn.preventClickTimeout),Sa.doubleClickTimeout)Sa.mouseUpEvent?r9():(Sa.mouseUpEvent=t,mn.element.addEventListener("mousemove",Jee));else{const e=mn.isClickEvent?cLe:uLe,n=Zh(t,mn.element),r=uS(n,mn.lastPoints),i={event:t,eventName:e,mouseButton:mn.mouseButton,element:mn.element,renderingEngineId:mn.renderingEngineId,viewportId:mn.viewportId,camera:{},startPoints:Xd(mn.startPoints),lastPoints:Xd(mn.lastPoints),currentPoints:n,deltaPoints:r};wt(i.element,e,i),r9()}document.removeEventListener("mousemove",Yee)}function Jee(t){const e=Zh(t,mn.element),n=ete(mn.element,mn.lastPoints),r=uS(e,n);Zee(r.canvas)&&(k3(),zy(t))}function Zee(t){return Math.abs(t[0])+Math.abs(t[1])>hLe}function mLe(){mn.isClickEvent=!1}function k3(){Sa.ignoreDoubleClick=!0;const t=Sa.mouseDownEvent,e=Sa.mouseUpEvent;Qee(),gLe(t),e&&DO(e)}function Qee(){Sa.doubleClickTimeout&&(clearTimeout(Sa.doubleClickTimeout),Sa.doubleClickTimeout=null),Sa.mouseDownEvent=null,Sa.mouseUpEvent=null}function r9(){document.removeEventListener("mouseup",DO),mn.element?.removeEventListener("mousemove",Jee),mn.element?.addEventListener("mousemove",zy),Qee(),mn=JSON.parse(JSON.stringify(pLe))}function Xd(t){return JSON.parse(JSON.stringify(t))}function ete(t,e){const{viewport:n}=Xe(t)||{};if(!n)return e;const r=n.canvasToWorld(e.canvas);return{page:e.page,client:e.client,canvas:e.canvas,world:r}}function uS(t,e){return!t||!e?{page:[0,0],client:[0,0],canvas:[0,0],world:[0,0,0]}:{page:D8(t.page,e.page),client:D8(t.client,e.client),canvas:D8(t.canvas,e.canvas),world:vLe(t.world,e.world)}}function D8(t,e){return[t[0]-e[0],t[1]-e[1]]}function vLe(t,e){return[t[0]-e[0],t[1]-e[1],t[2]-e[2]]}function yLe(){return mn.mouseButton}function tte(t){Sa.ignoreDoubleClick?(Sa.ignoreDoubleClick=!1,t.stopImmediatePropagation(),t.preventDefault()):r9()}function nte(t){t.removeEventListener("dblclick",qee),t.removeEventListener("mousedown",Xee),t.removeEventListener("mousemove",zy),t.removeEventListener("dblclick",tte,{capture:!0})}function xLe(t){nte(t),t.addEventListener("dblclick",qee),t.addEventListener("mousedown",Xee),t.addEventListener("mousemove",zy),t.addEventListener("dblclick",tte,{capture:!0})}const rte={enable:xLe,disable:nte},bLe=2e3,ym={mouse:0,touch:1};let nU,rU;function ite(t,e){const n=Date.now();if(t!==nU){if(n-rU<=bLe)return e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),!1;nU=t}rU=n}const ate=ite.bind(null,ym.mouse),ote=ite.bind(null,ym.touch);function iU(t,e,n){const r=n?ate:ote;e.forEach(function(i){t.addEventListener(i,r,{passive:!1})})}function aU(t,e,n){const r=n?ate:ote;e.forEach(function(i){t.removeEventListener(i,r)})}const ste=["mousedown","mouseup","mousemove"],lte=["touchstart","touchend"];function cte(t){aU(t,ste,ym.mouse),aU(t,lte,ym.touch)}function wLe(t){cte(t),iU(t,ste,ym.mouse),iU(t,lte,ym.touch)}const ute={enable:wLe,disable:cte};function fS(t,e){const n=e||t.currentTarget,r=t.type==="touchend"?t.changedTouches:t.touches;return Object.keys(r).map(i=>{const a=TLe(r[i]),o=SLe(r[i]),s=CLe(n,o),{viewport:l}=Xe(n),c=l.canvasToWorld(s);return{page:o,client:a,canvas:s,world:c,touch:{identifier:i,radiusX:r[i].radiusX,radiusY:r[i].radiusY,force:r[i].force,rotationAngle:r[i].rotationAngle}}})}function CLe(t,e){const n=t.getBoundingClientRect();return[e[0]-n.left-window.pageXOffset,e[1]-n.top-window.pageYOffset]}function SLe(t){return[t.pageX,t.pageY]}function TLe(t){return[t.clientX,t.clientY]}function i9(t,e){const n=V3(t),r=V3(e);return{page:O8(n.page,r.page),client:O8(n.client,r.client),canvas:O8(n.canvas,r.canvas),world:ELe(n.world,r.world)}}function fte(t,e){const n=V3(t),r=V3(e);return{page:tm(n.page,r.page),client:tm(n.client,r.client),canvas:tm(n.canvas,r.canvas),world:dte(n.world,r.world)}}function a9(t,e){const n=sU(t),r=sU(e);return{page:n.page-r.page,client:n.client-r.client,canvas:n.canvas-r.canvas,world:n.world-r.world}}function Mf(t){return JSON.parse(JSON.stringify(t))}function oU(t){return JSON.parse(JSON.stringify(t))}function V3(t){return t.reduce((e,n)=>({page:[e.page[0]+n.page[0]/t.length,e.page[1]+n.page[1]/t.length],client:[e.client[0]+n.client[0]/t.length,e.client[1]+n.client[1]/t.length],canvas:[e.canvas[0]+n.canvas[0]/t.length,e.canvas[1]+n.canvas[1]/t.length],world:[e.world[0]+n.world[0]/t.length,e.world[1]+n.world[1]/t.length,e.world[2]+n.world[2]/t.length]}),{page:[0,0],client:[0,0],canvas:[0,0],world:[0,0,0]})}function du(t){return t.reduce((e,n)=>({page:[e.page[0]+n.page[0]/t.length,e.page[1]+n.page[1]/t.length],client:[e.client[0]+n.client[0]/t.length,e.client[1]+n.client[1]/t.length],canvas:[e.canvas[0]+n.canvas[0]/t.length,e.canvas[1]+n.canvas[1]/t.length],world:[e.world[0]+n.world[0]/t.length,e.world[1]+n.world[1]/t.length,e.world[2]+n.world[2]/t.length],touch:{identifier:null,radiusX:e.touch.radiusX+n.touch.radiusX/t.length,radiusY:e.touch.radiusY+n.touch.radiusY/t.length,force:e.touch.force+n.touch.force/t.length,rotationAngle:e.touch.rotationAngle+n.touch.rotationAngle/t.length}}),{page:[0,0],client:[0,0],canvas:[0,0],world:[0,0,0],touch:{identifier:null,radiusX:0,radiusY:0,force:0,rotationAngle:0}})}function O8(t,e){return[t[0]-e[0],t[1]-e[1]]}function ELe(t,e){return[t[0]-e[0],t[1]-e[1],t[2]-e[2]]}function sU(t){const e=[];for(let n=0;n<t.length;n++)for(let r=0;r<t.length;r++)n<r&&e.push({page:tm(t[n].page,t[r].page),client:tm(t[n].client,t[r].client),canvas:tm(t[n].canvas,t[r].canvas),world:dte(t[n].world,t[r].world)});return e.reduce((n,r)=>({page:n.page+r.page/e.length,client:n.client+r.client/e.length,canvas:n.canvas+r.canvas/e.length,world:n.world+r.world/e.length}),{page:0,client:0,canvas:0,world:0})}function tm(t,e){return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2))}function dte(t,e){return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2)+Math.pow(t[2]-e[2],2))}ei.getRuntimeSettings();const{TOUCH_START:lU,TOUCH_START_ACTIVATE:_Le,TOUCH_PRESS:cU,TOUCH_DRAG:uU,TOUCH_END:fU,TOUCH_TAP:dU,TOUCH_SWIPE:M8}=ee,ay={page:[0,0],client:[0,0],canvas:[0,0],world:[0,0,0]},F3={page:0,client:0,canvas:0,world:0},hte={renderingEngineId:void 0,viewportId:void 0,element:null,startPointsList:[{...ay,touch:null}],lastPointsList:[{...ay,touch:null}],isTouchStart:!1,startTime:null,pressTimeout:null,pressDelay:700,pressMaxDistance:5,accumulatedDistance:F3,swipeDistanceThreshold:48,swiped:!1,swipeToleranceMs:300},pte={renderingEngineId:void 0,viewportId:void 0,element:null,startPointsList:[{...ay,touch:null}],taps:0,tapTimeout:null,tapMaxDistance:24,tapToleranceMs:300};let Kt=JSON.parse(JSON.stringify(hte)),Hi=JSON.parse(JSON.stringify(pte));function l0(t,e,n){return wt(t,e,n)}function gte(t){Kt.element=t.currentTarget;const e=Xe(Kt.element),{renderingEngineId:n,viewportId:r}=e;Kt.renderingEngineId=n,Kt.viewportId=r,!Kt.isTouchStart&&(clearTimeout(Kt.pressTimeout),Kt.pressTimeout=setTimeout(()=>DLe(t),Kt.pressDelay),OLe(t),document.addEventListener("touchmove",mte),document.addEventListener("touchend",vte))}function DLe(t){if(Kt.accumulatedDistance.canvas>Kt.pressMaxDistance)return;const n={event:t,eventName:cU,renderingEngineId:Kt.renderingEngineId,viewportId:Kt.viewportId,camera:{},element:Kt.element,startPointsList:Mf(Kt.startPointsList),lastPointsList:Mf(Kt.lastPointsList),startPoints:oU(du(Kt.startPointsList)),lastPoints:oU(du(Kt.lastPointsList))};l0(n.element,cU,n)}function OLe(t){Kt.isTouchStart=!0,Kt.startTime=new Date;const e=fS(t,Kt.element),n=du(e),r=ay,i=F3,a={event:t,eventName:lU,element:Kt.element,renderingEngineId:Kt.renderingEngineId,viewportId:Kt.viewportId,camera:{},startPointsList:e,lastPointsList:e,currentPointsList:e,startPoints:n,lastPoints:n,currentPoints:n,deltaPoints:r,deltaDistance:i};Kt.startPointsList=Mf(a.startPointsList),Kt.lastPointsList=Mf(a.lastPointsList),l0(a.element,lU,a)&&l0(a.element,_Le,a)}function mte(t){const e=fS(t,Kt.element),n=yte(Kt.element,Kt.lastPointsList),r=e.length===n.length?i9(e,n):ay,i=e.length===n.length?a9(e,n):F3,a=e.length===n.length?fte(e,Kt.lastPointsList):F3;Kt.accumulatedDistance={page:Kt.accumulatedDistance.page+a.page,client:Kt.accumulatedDistance.client+a.client,canvas:Kt.accumulatedDistance.canvas+a.canvas,world:Kt.accumulatedDistance.world+a.world};const o={event:t,eventName:uU,renderingEngineId:Kt.renderingEngineId,viewportId:Kt.viewportId,camera:{},element:Kt.element,startPoints:du(Kt.startPointsList),lastPoints:du(n),currentPoints:du(e),startPointsList:Mf(Kt.startPointsList),lastPointsList:Mf(n),currentPointsList:e,deltaPoints:r,deltaDistance:i};l0(Kt.element,uU,o),ILe(t,r),Kt.lastPointsList=Mf(e)}function vte(t){clearTimeout(Kt.pressTimeout);const e=fS(t,Kt.element),n=yte(Kt.element,Kt.lastPointsList),r=e.length===n.length?i9(e,n):i9(e,e),i=e.length===n.length?a9(e,n):a9(e,e),a={event:t,eventName:fU,element:Kt.element,renderingEngineId:Kt.renderingEngineId,viewportId:Kt.viewportId,camera:{},startPointsList:Mf(Kt.startPointsList),lastPointsList:Mf(n),currentPointsList:e,startPoints:du(Kt.startPointsList),lastPoints:du(n),currentPoints:du(e),deltaPoints:r,deltaDistance:i};l0(a.element,fU,a),MLe(t),Kt=JSON.parse(JSON.stringify(hte)),document.removeEventListener("touchmove",mte),document.removeEventListener("touchend",vte)}function MLe(t){const e=new Date().getTime(),n=Kt.startTime.getTime();if(e-n>Hi.tapToleranceMs||(Hi.taps===0&&(Hi.element=Kt.element,Hi.renderingEngineId=Kt.renderingEngineId,Hi.viewportId=Kt.viewportId,Hi.startPointsList=Kt.startPointsList),Hi.taps>0&&!(Hi.element==Kt.element&&Hi.renderingEngineId==Kt.renderingEngineId&&Hi.viewportId==Kt.viewportId)))return;const r=fS(t,Hi.element);fte(r,Hi.startPointsList).canvas>Hi.tapMaxDistance||(clearTimeout(Hi.tapTimeout),Hi.taps+=1,Hi.tapTimeout=setTimeout(()=>{const a={event:t,eventName:dU,element:Hi.element,renderingEngineId:Hi.renderingEngineId,viewportId:Hi.viewportId,camera:{},currentPointsList:r,currentPoints:du(r),taps:Hi.taps};l0(a.element,dU,a),Hi=JSON.parse(JSON.stringify(pte))},Hi.tapToleranceMs))}function ILe(t,e){const n=new Date().getTime(),r=Kt.startTime.getTime();if(Kt.swiped||n-r>Kt.swipeToleranceMs)return;const[i,a]=e.canvas,o={event:t,eventName:M8,renderingEngineId:Kt.renderingEngineId,viewportId:Kt.viewportId,camera:{},element:Kt.element,swipe:null};Math.abs(i)>Kt.swipeDistanceThreshold&&(o.swipe=i>0?mh.RIGHT:mh.LEFT,l0(o.element,M8,o),Kt.swiped=!0),Math.abs(a)>Kt.swipeDistanceThreshold&&(o.swipe=a>0?mh.DOWN:mh.UP,l0(o.element,M8,o),Kt.swiped=!0)}function yte(t,e){const{viewport:n}=Xe(t);return e.map(r=>{const i=n.canvasToWorld(r.canvas);return{page:r.page,client:r.client,canvas:r.canvas,world:i,touch:r.touch}})}function xte(t){ute.disable(t),t.removeEventListener("touchstart",gte)}function RLe(t){xte(t),ute.enable(t),t.addEventListener("touchstart",gte,{passive:!1})}const bte={enable:RLe,disable:xte},hU=10,pU=40,gU=800;function PLe(t){let e=0,n=0,r=0,i=0;return"detail"in t&&(n=t.detail),"wheelDelta"in t&&(n=-t.wheelDelta/120),"wheelDeltaY"in t&&(n=-t.wheelDeltaY/120),"wheelDeltaX"in t&&(e=-t.wheelDeltaX/120),r=e*hU,i=n*hU,"deltaY"in t&&(i=t.deltaY),"deltaX"in t&&(r=t.deltaX),(r||i)&&t.deltaMode&&(t.deltaMode===1?(r*=pU,i*=pU):(r*=gU,i*=gU)),r&&!e&&(e=r<1?-1:1),i&&!n&&(n=i<1?-1:1),{spinX:e,spinY:n,pixelX:r,pixelY:i}}function wte(t){const e=t.currentTarget,n=Xe(e),{renderingEngineId:r,viewportId:i}=n;if(t.deltaY>-1&&t.deltaY<1)return;t.preventDefault();const{spinX:a,spinY:o,pixelX:s,pixelY:l}=PLe(t),c=o<0?-1:1,f={event:t,eventName:ee.MOUSE_WHEEL,renderingEngineId:r,viewportId:i,element:e,camera:{},detail:t,wheel:{spinX:a,spinY:o,pixelX:s,pixelY:l,direction:c},points:Zh(t)};wt(e,ee.MOUSE_WHEEL,f)}function ALe(t){Cte(t),t.addEventListener("wheel",wte,{passive:!1})}function Cte(t){t.removeEventListener("wheel",wte)}const Ste={enable:ALe,disable:Cte},NLe={renderingEngineId:void 0,viewportId:void 0,key:void 0,keyCode:void 0,element:null};let sa={renderingEngineId:void 0,viewportId:void 0,key:void 0,keyCode:void 0,element:null};function dS(t){sa.element=t.currentTarget;const e=Xe(sa.element),{renderingEngineId:n,viewportId:r}=e;sa.renderingEngineId=n,sa.viewportId=r,sa.key=t.key,sa.keyCode=t.keyCode,t.preventDefault();const i={renderingEngineId:sa.renderingEngineId,viewportId:sa.viewportId,element:sa.element,key:sa.key,keyCode:sa.keyCode};wt(i.element,ee.KEY_DOWN,i),document.addEventListener("keyup",Tte),document.addEventListener("visibilitychange",OO),sa.element.removeEventListener("keydown",dS)}function OO(){document.removeEventListener("visibilitychange",OO),document.visibilityState==="hidden"&&Ete()}function Tte(t){const e={renderingEngineId:sa.renderingEngineId,viewportId:sa.viewportId,element:sa.element,key:sa.key,keyCode:sa.keyCode};document.removeEventListener("keyup",Tte),document.removeEventListener("visibilitychange",OO),sa.element.addEventListener("keydown",dS),sa=structuredClone(NLe),wt(e.element,ee.KEY_UP,e)}function LLe(){return sa.keyCode}function Ete(){sa.keyCode=void 0}function kLe(t){_te(t),t.addEventListener("keydown",dS)}function _te(t){t.removeEventListener("keydown",dS)}const e1={enable:kLe,disable:_te,getModifierKey:LLe},{EPSILON:Wp}=Xh;function VLe(t,e,n=!1){let r=1/0,i=n?-1/0:0,a=1/0,o=n?-1/0:0,s=1/0,l=n?-1/0:0;const c=t[0]?.length===3;for(let f=0;f<t.length;f++){const u=t[f];r=Math.min(u[0],r),i=Math.max(u[0],i),a=Math.min(u[1],a),o=Math.max(u[1],o),c&&(s=Math.min(u[2]??s,s),l=Math.max(u[2]??l,l))}return e?(r=Math.max(n?e[0]+Wp:0,r),i=Math.min(n?e[0]-Wp:e[0]-1,i),a=Math.max(n?e[1]+Wp:0,a),o=Math.min(n?e[1]-Wp:e[1]-1,o),c&&e.length===3&&(s=Math.max(n?e[2]+Wp:0,s),l=Math.min(n?e[2]-Wp:e[2]-1,l))):n||(r=Math.max(0,r),i=Math.min(1/0,i),a=Math.max(0,a),o=Math.min(1/0,o),c&&(s=Math.max(0,s),l=Math.min(1/0,l))),c?[[r,i],[a,o],[s,l]]:[[r,i],[a,o],null]}function MO(t,e){return VLe(t,e,!1)}const IO=new Map,FLe=t=>{const e=IO.get(t);e&&(e.isDirty=!0)},ULe=t=>{const e=IO.get(t);return e&&!e.isDirty?e.indices:null},BLe=(t,e)=>{IO.set(t,{indices:e,isDirty:!1})};function Wf(t,e,n){const r={segmentationId:t,modifiedSlicesToUse:e,segmentIndex:n};FLe(t),wt(vt,ee.SEGMENTATION_DATA_MODIFIED,r)}function t1(t){const e={segmentationId:t};wt(vt,ee.SEGMENTATION_MODIFIED,e)}function $Le(t){const e={segmentationId:t};wt(vt,ee.SEGMENTATION_REMOVED,e)}function Lv(t,e,n){const r={segmentationId:e,type:n,viewportId:t};wt(vt,ee.SEGMENTATION_REPRESENTATION_MODIFIED,r)}function mU(t,e,n){const r={viewportId:t,segmentationId:e,type:n};wt(vt,ee.SEGMENTATION_REPRESENTATION_REMOVED,r)}const GLe={renderOutline:!0,outlineWidthAutoGenerated:3,outlineWidth:1,outlineWidthInactive:1,outlineOpacity:1,outlineOpacityInactive:.85,outlineDash:void 0,outlineDashInactive:void 0,outlineDashAutoGenerated:"5,3",activeSegmentOutlineWidthDelta:0,renderFill:!0,fillAlpha:.5,fillAlphaInactive:.3,fillAlphaAutoGenerated:.3};function jLe(){return GLe}const zLe={renderOutline:!0,renderOutlineInactive:!0,outlineWidth:3,outlineWidthInactive:2,activeSegmentOutlineWidthDelta:0,renderFill:!0,renderFillInactive:!0,fillAlpha:.5,fillAlphaInactive:.4,outlineOpacity:1,outlineOpacityInactive:.85};function WLe(){return zLe}class HLe{constructor(){this.config={global:{},segmentations:{},viewportsStyle:{}}}setStyle(e,n){const{viewportId:r,segmentationId:i,type:a,segmentIndex:o}=e,s=this.getStyle(e);let l;if(!r&&!i?l={...s,...n}:l=this.copyActiveToInactiveIfNotProvided({...s,...n},a),!a)throw new Error("Type is required to set a style");if(r){this.config.viewportsStyle[r]||(this.config.viewportsStyle[r]={renderInactiveSegmentations:!1,representations:{}});const c=this.config.viewportsStyle[r].representations;if(i){c[i]||(c[i]={}),c[i][a]||(c[i][a]={});const f=c[i][a];o!==void 0?(f.perSegment||(f.perSegment={}),f.perSegment[o]=l):f.allSegments=l}else{const f="__allSegmentations__";c[f]||(c[f]={}),c[f][a]||(c[f][a]={}),c[f][a].allSegments=l}}else if(i){this.config.segmentations[i]||(this.config.segmentations[i]={}),this.config.segmentations[i][a]||(this.config.segmentations[i][a]={});const c=this.config.segmentations[i][a];o!==void 0?(c.perSegment||(c.perSegment={}),c.perSegment[o]=l):c.allSegments=l}else this.config.global[a]=l}copyActiveToInactiveIfNotProvided(e,n){const r={...e};if(n===hn.Labelmap){const i=r;i.renderOutlineInactive??=i.renderOutline,i.outlineWidthInactive??=i.outlineWidth,i.renderFillInactive??=i.renderFill,i.fillAlphaInactive??=i.fillAlpha,i.outlineOpacityInactive??=i.outlineOpacity}else if(n===hn.Contour){const i=r;i.outlineWidthInactive??=i.outlineWidth,i.outlineOpacityInactive??=i.outlineOpacity,i.outlineDashInactive??=i.outlineDash,i.renderOutlineInactive??=i.renderOutline,i.renderFillInactive??=i.renderFill,i.fillAlphaInactive??=i.fillAlpha}return r}getStyle(e){const{viewportId:n,segmentationId:r,type:i,segmentIndex:a}=e;let o=this.getDefaultStyle(i);if(this.config.global[i]&&(o={...o,...this.config.global[i]}),this.config.segmentations[r]?.[i]&&(o={...o,...this.config.segmentations[r][i].allSegments},a!==void 0&&this.config.segmentations[r][i].perSegment?.[a]&&(o={...o,...this.config.segmentations[r][i].perSegment[a]})),n&&this.config.viewportsStyle[n]){this.config.viewportsStyle[n].renderInactiveSegmentations;const s="__allSegmentations__";this.config.viewportsStyle[n].representations[s]?.[i]&&(o={...o,...this.config.viewportsStyle[n].representations[s][i].allSegments}),r&&this.config.viewportsStyle[n].representations[r]?.[i]&&(o={...o,...this.config.viewportsStyle[n].representations[r][i].allSegments},a!==void 0&&this.config.viewportsStyle[n].representations[r][i].perSegment?.[a]&&(o={...o,...this.config.viewportsStyle[n].representations[r][i].perSegment[a]}))}return o}getRenderInactiveSegmentations(e){return this.config.viewportsStyle[e]?.renderInactiveSegmentations}setRenderInactiveSegmentations(e,n){this.config.viewportsStyle[e]||(this.config.viewportsStyle[e]={renderInactiveSegmentations:!1,representations:{}}),this.config.viewportsStyle[e].renderInactiveSegmentations=n}getDefaultStyle(e){switch(e){case hn.Labelmap:return WLe();case hn.Contour:return jLe();case hn.Surface:return{};default:throw new Error(`Unknown representation type: ${e}`)}}clearSegmentationStyle(e){this.config.segmentations[e]&&delete this.config.segmentations[e]}clearAllSegmentationStyles(){this.config.segmentations={}}clearViewportStyle(e){this.config.viewportsStyle[e]&&delete this.config.viewportsStyle[e]}clearAllViewportStyles(){for(const e in this.config.viewportsStyle){const r=this.config.viewportsStyle[e].renderInactiveSegmentations;this.config.viewportsStyle[e]={renderInactiveSegmentations:r,representations:{}}}}resetToGlobalStyle(){this.clearAllSegmentationStyles(),this.clearAllViewportStyles()}hasCustomStyle(e){const{type:n}=e,r=this.getStyle(e),i=this.getDefaultStyle(n);return!oee(r,i)}}const nm=new HLe;function KLe(t){const e={segmentationId:t};wt(vt,ee.SEGMENTATION_ADDED,e)}const vU={colorLUT:[],segmentations:[],viewportSegRepresentations:{}};class qLe{constructor(e){this._stackLabelmapImageIdReferenceMap=new Map,this._labelmapImageIdReferenceMap=new Map,e||=cr(),this.state=Object.freeze(mc(vU)),this.uid=e}getState(){return this.state}updateState(e){const n=mc(this.state);e(n),this.state=Object.freeze(n)}getColorLUT(e){return this.state.colorLUT[e]}getNextColorLUTIndex(){return this.state.colorLUT.length}resetState(){this._stackLabelmapImageIdReferenceMap.clear(),this._labelmapImageIdReferenceMap.clear(),this.state=Object.freeze(mc(vU))}getSegmentation(e){return this.state.segmentations.find(n=>n.segmentationId===e)}updateSegmentation(e,n){this.updateState(r=>{const i=r.segmentations.find(a=>a.segmentationId===e);if(!i){console.warn(`Segmentation with id ${e} not found. Update aborted.`);return}Object.assign(i,n)}),t1(e)}addSegmentation(e){if(this.getSegmentation(e.segmentationId))throw new Error(`Segmentation with id ${e.segmentationId} already exists`);this.updateState(n=>{const r=mc(e);if(r.representationData.Labelmap&&"volumeId"in r.representationData.Labelmap&&!("imageIds"in r.representationData.Labelmap)){const i=this.getLabelmapImageIds(r.representationData);r.representationData.Labelmap.imageIds=i}n.segmentations.push(r)}),KLe(e.segmentationId)}removeSegmentation(e){this.updateState(n=>{const r=n.segmentations.filter(i=>i.segmentationId!==e);n.segmentations.splice(0,n.segmentations.length,...r)}),$Le(e)}addSegmentationRepresentation(e,n,r,i){if(!xr(e))return;if(this.getSegmentationRepresentations(e,{type:r,segmentationId:n}).length>0){console.debug("A segmentation representation of type",r,"already exists in viewport",e,"for segmentation",n);return}this.updateState(s=>{s.viewportSegRepresentations[e]||(s.viewportSegRepresentations[e]=[],nm.setRenderInactiveSegmentations(e,!0)),r!==hn.Labelmap?this.addDefaultSegmentationRepresentation(s,e,n,r,i):this.addLabelmapRepresentation(s,e,n,i)}),Lv(e,n,r)}addDefaultSegmentationRepresentation(e,n,r,i,a){const o=e.segmentations.find(l=>l.segmentationId===r);if(!o)return;const s={};Object.keys(o.segments).forEach(l=>{s[Number(l)]={visible:!0}}),e.viewportSegRepresentations[n].push({segmentationId:r,type:i,active:!0,visible:!0,colorLUTIndex:a?.colorLUTIndex||0,segments:s,config:{...yU(i),...a}}),this._setActiveSegmentation(e,n,r)}addLabelmapRepresentation(e,n,r,i=yU(hn.Labelmap)){if(!xr(n))return;const o=this.getSegmentation(r);if(!o)return;const{representationData:s}=o;if(!s.Labelmap)return this.addDefaultSegmentationRepresentation(e,n,r,hn.Labelmap,i);this.processLabelmapRepresentationAddition(n,r),this.addDefaultSegmentationRepresentation(e,n,r,hn.Labelmap,i)}async processLabelmapRepresentationAddition(e,n){const r=xr(e);if(!r)return;const i=this.getSegmentation(n);if(!i)return;const a=r.viewport instanceof mo,{representationData:o}=i,s="volumeId"in o.Labelmap;r.viewport,!a&&!s&&this.updateLabelmapSegmentationImageReferences(e,i.segmentationId)}_updateLabelmapSegmentationReferences(e,n,r,i){const a=n.getCurrentImageId();let o=!1;for(const s of r)n.isReferenceViewable({referencedImageId:s},{asOverlay:!0})&&(o=!0,this._stackLabelmapImageIdReferenceMap.get(e).set(a,s),this._updateLabelmapImageIdReferenceMap({segmentationId:e,referenceImageId:a,labelmapImageId:s}));return i&&i(n,e,r),o?this._stackLabelmapImageIdReferenceMap.get(e).get(a):void 0}updateLabelmapSegmentationImageReferences(e,n){const r=this.getSegmentation(n);if(!r)return;this._stackLabelmapImageIdReferenceMap.has(n)||this._stackLabelmapImageIdReferenceMap.set(n,new Map);const{representationData:i}=r;if(!i.Labelmap)return;const a=this.getLabelmapImageIds(i),s=xr(e).viewport;return this._updateLabelmapSegmentationReferences(n,s,a,null)}_updateAllLabelmapSegmentationImageReferences(e,n){const r=this.getSegmentation(n);if(!r)return;this._stackLabelmapImageIdReferenceMap.has(n)||this._stackLabelmapImageIdReferenceMap.set(n,new Map);const{representationData:i}=r;if(!i.Labelmap)return;const a=this.getLabelmapImageIds(i),s=xr(e).viewport;this._updateLabelmapSegmentationReferences(n,s,a,(l,c,f)=>{l.getImageIds().forEach((d,h)=>{for(const p of f)l.isReferenceViewable({referencedImageId:p,sliceIndex:h},{asOverlay:!0,withNavigation:!0})&&(this._stackLabelmapImageIdReferenceMap.get(c).set(d,p),this._updateLabelmapImageIdReferenceMap({segmentationId:c,referenceImageId:d,labelmapImageId:p}))})})}getLabelmapImageIds(e){const n=e.Labelmap;let r;if(n.imageIds)r=n.imageIds;else if(!r&&n.volumeId){const i=n.volumeId;r=yt.getVolume(i).imageIds}return r}getLabelmapImageIdsForImageId(e,n){const r=this._generateMapKey({segmentationId:n,referenceImageId:e});return this._labelmapImageIdReferenceMap.get(r)}getCurrentLabelmapImageIdsForViewport(e,n){const r=xr(e);if(!r)return;const a=r.viewport.getCurrentImageId();return this.getLabelmapImageIdsForImageId(a,n)}getCurrentLabelmapImageIdForViewport(e,n){const r=xr(e);if(!r||!this._stackLabelmapImageIdReferenceMap.has(n))return;const a=r.viewport.getCurrentImageId();return this._stackLabelmapImageIdReferenceMap.get(n).get(a)}getStackSegmentationImageIdsForViewport(e,n){if(!this.getSegmentation(n))return[];this._updateAllLabelmapSegmentationImageReferences(e,n);const{viewport:i}=xr(e),a=i.getImageIds(),o=this._stackLabelmapImageIdReferenceMap.get(n);return a.map(s=>o.get(s))}removeSegmentationRepresentationsInternal(e,n){const r=[];return this.updateState(i=>{if(!i.viewportSegRepresentations[e])return;const a=i.viewportSegRepresentations[e];let o=!1;if(!n||Object.values(n).every(s=>s===void 0))r.push(...a),delete i.viewportSegRepresentations[e];else{const{segmentationId:s,type:l}=n;i.viewportSegRepresentations[e]=a.filter(c=>{const f=s&&l&&c.segmentationId===s&&c.type===l||s&&!l&&c.segmentationId===s||!s&&l&&c.type===l;return f&&(r.push(c),c.active&&(o=!0)),!f}),i.viewportSegRepresentations[e].length===0?delete i.viewportSegRepresentations[e]:o&&(i.viewportSegRepresentations[e][0].active=!0)}}),r}removeSegmentationRepresentations(e,n){const r=this.removeSegmentationRepresentationsInternal(e,n);r.forEach(a=>{mU(e,a.segmentationId,a.type)});const i=this.getSegmentationRepresentations(e);return i.length>0&&i[0].active&&Lv(e,i[0].segmentationId,i[0].type),r}removeSegmentationRepresentation(e,n,r){const i=this.removeSegmentationRepresentationsInternal(e,n);return r||i.forEach(({segmentationId:a,type:o})=>{mU(e,a,o)}),i}_updateLabelmapImageIdReferenceMap({segmentationId:e,referenceImageId:n,labelmapImageId:r}){const i=this._generateMapKey({segmentationId:e,referenceImageId:n});if(!this._labelmapImageIdReferenceMap.has(i)){this._labelmapImageIdReferenceMap.set(i,[r]);return}const a=this._labelmapImageIdReferenceMap.get(i),o=Array.from(new Set([...a,r]));this._labelmapImageIdReferenceMap.set(i,o)}_setActiveSegmentation(e,n,r){const i=e.viewportSegRepresentations[n];i&&i.forEach(a=>{a.active=a.segmentationId===r})}setActiveSegmentation(e,n){this.updateState(r=>{const i=r.viewportSegRepresentations[e];i&&i.forEach(a=>{a.active=a.segmentationId===n})}),Lv(e,n)}getActiveSegmentation(e){if(!this.state.viewportSegRepresentations[e])return;const n=this.state.viewportSegRepresentations[e].find(r=>r.active);if(n)return this.getSegmentation(n.segmentationId)}getSegmentationRepresentations(e,n={}){const r=this.state.viewportSegRepresentations[e];return r?!n.type&&!n.segmentationId?r:r.filter(i=>{const a=n.type?i.type===n.type:!0,o=n.segmentationId?i.segmentationId===n.segmentationId:!0;return a&&o}):[]}getSegmentationRepresentation(e,n){return this.getSegmentationRepresentations(e,n)[0]}getSegmentationRepresentationVisibility(e,n){return this.getSegmentationRepresentation(e,n)?.visible}setSegmentationRepresentationVisibility(e,n,r){this.updateState(i=>{const a=this.getSegmentationRepresentations(e,n);a&&a.forEach(o=>{o.visible=r,Object.entries(o.segments).forEach(([s,l])=>{l.visible=r})})}),Lv(e,n.segmentationId,n.type)}addColorLUT(e,n){this.updateState(r=>{r.colorLUT[n]&&console.warn("Color LUT table already exists, overwriting"),r.colorLUT[n]=mc(e)})}removeColorLUT(e){this.updateState(n=>{delete n.colorLUT[e]})}_getStackIdForImageIds(e){return e.map(n=>n.slice(-Math.round(n.length*.15))).join("_")}getAllViewportSegmentationRepresentations(){return Object.entries(this.state.viewportSegRepresentations).map(([e,n])=>({viewportId:e,representations:n}))}getSegmentationRepresentationsBySegmentationId(e){const n=[];return Object.entries(this.state.viewportSegRepresentations).forEach(([r,i])=>{const a=i.filter(o=>o.segmentationId===e);a.length>0&&n.push({viewportId:r,representations:a})}),n}_generateMapKey({segmentationId:e,referenceImageId:n}){return`${e}-${n}`}}function yU(t){const e=Uf.newInstance(),n=kh.newInstance();return n.addPoint(0,0),t===hn.Labelmap?{cfun:e,ofun:n}:{}}const Ps=new qLe("DEFAULT");function Yd(t,e={}){return Ps.getSegmentationRepresentations(t,e)}function XLe(t,e){const n=Ps;if(!e.segmentationId||!e.type)throw new Error("getSegmentationRepresentation: No segmentationId or type provided, you need to provide at least one of them");return n.getSegmentationRepresentations(t,e)?.[0]}function YLe(t,e){const n=Xe(t),{viewport:r}=n,a=r.getActors().filter(o=>o.representationUID&&typeof o.representationUID=="string"&&o.representationUID.startsWith(e));r.removeActors(a.map(o=>o.uid))}function Dte(t,e,n){const r=xr(t);if(!r)return;const{renderingEngine:i,viewport:a}=r;if(!i||!a)return;const s=a.getActors().filter(n);return s.length>0?s[0]:void 0}function JLe(t,e){const n=xr(t);if(!n)return;const{renderingEngine:r,viewport:i}=n;if(!r||!i)return;const o=i.getActors().filter(e);return o.length>0?o:void 0}function ZLe(t,e){return Ote(t,e)?.uid}function u2(t,e){return JLe(t,n=>n.representationUID?.startsWith(`${e}-${hn.Labelmap}`))}function Ote(t,e){return Dte(t,e,n=>n.representationUID?.startsWith(`${e}-${hn.Labelmap}`))}function QLe(t,e,n){return Dte(t,e,r=>r.representationUID===Mte(e,n))}function Mte(t,e){return`${t}-${hn.Surface}-${e}`}function eke(t,e,n){const r=Xe(t),{viewport:i}=r,o=QLe(i.id,n,e.segmentIndex)?.actor,s=e.visible;if(o){if(o.setVisibility(s),!s)return;const y=o.getMapper(),v=y.getInputData(),x=e.points,w=e.polys,S=v.getPoints().getData(),T=v.getPolys().getData();if(x.length===S.length&&w.length===T.length)return;const _=ca.newInstance();_.getPoints().setData(x,3);const D=Uh.newInstance({values:Float32Array.from(w)});_.setPolys(D),y.setInputData(_),y.modified(),i.getRenderer().resetCameraClippingRange();return}const l=e.points,c=e.polys,f=e.color,u=ca.newInstance();u.getPoints().setData(l,3);const d=Uh.newInstance({values:Float32Array.from(c)});u.setPolys(d);const h=bc.newInstance({});let p;h.setInputData(u);const g=o0.newInstance();g.setMapper(h),g.getProperty().setColor(f[0]/255,f[1]/255,f[2]/255),g.getProperty().setLineWidth(2);const m=Mte(n,e.segmentIndex);i.addActor({uid:cr(),actor:g,clippingFilter:p,representationUID:m}),i.resetCamera(),i.getRenderer().resetCameraClippingRange(),i.render()}function ea(t){return Ps.getSegmentation(t)}function RO(t){return Ps.getColorLUT(t)}let U3={};function tke(){return U3}function nke(t){U3=t}let xU=!1;function If(){if(!U3.addons?.polySeg)return console.warn("PolySeg add-on not configured. This will prevent automatic conversion between segmentation representations (labelmap, contour, surface). To enable these features, install @cornerstonejs/polymorphic-segmentation and register it during initialization: cornerstoneTools.init({ addons: { polySeg } })."),null;const t=U3.addons.polySeg;return xU||(t.init(),xU=!0),t}function rke({segmentationId:t,type:e,data:n}){const r=ea(t);if(!r)throw new Error(`Segmentation ${t} not found`);switch(r.representationData[e]&&console.warn(`Representation data of type ${e} already exists for segmentation ${t}, overwriting it.`),e){case hn.Labelmap:n&&(r.representationData[e]=n);break;case hn.Contour:n&&(r.representationData[e]=n);break;case hn.Surface:n&&(r.representationData[e]=n);break;default:throw new Error(`Invalid representation type ${e}`)}}function Ite(t){const e=typeof t;return t!==null&&(e==="object"||e==="function")}function hS(t,e,n){let r,i,a,o,s,l,c=0,f=!1,u=!1,d=!0;const h=!e&&e!==0&&typeof window.requestAnimationFrame=="function";if(typeof t!="function")throw new TypeError("Expected a function");e=Number(e)||0,Ite(n)&&(f=!!n.leading,u="maxWait"in n,a=u?Math.max(Number(n.maxWait)||0,e):a,d="trailing"in n?!!n.trailing:d);function p(R){const O=r,P=i;return r=i=void 0,c=R,o=t.apply(P,O),o}function g(R,O){return h?window.requestAnimationFrame(R):setTimeout(R,O)}function m(R){if(h)return window.cancelAnimationFrame(R);clearTimeout(R)}function y(R){return c=R,s=g(w,e),f?p(R):o}function v(R){const O=R-l,P=R-c,N=e-O;return u?Math.min(N,a-P):N}function x(R){const O=R-l,P=R-c;return l===void 0||O>=e||O<0||u&&P>=a}function w(){const R=Date.now();if(x(R))return S(R);s=g(w,v(R))}function S(R){return s=void 0,d&&r?p(R):(r=i=void 0,o)}function T(){s!==void 0&&m(s),c=0,r=l=i=s=void 0}function _(){return s===void 0?o:S(Date.now())}function D(){return s!==void 0}function I(...R){const O=Date.now(),P=x(O);if(r=R,i=this,l=O,P){if(s===void 0)return y(l);if(u)return s=g(w,e),p(l)}return s===void 0&&(s=g(w,e)),o}return I.cancel=T,I.flush=_,I.pending=D,I}const hw=new Map;async function PO(t,e,n,r,i){const a=await n();rke({segmentationId:t,type:e,data:a}),i?.(),hw.has(t)||hw.set(t,[]);const o=hw.get(t);return o.includes(e)||o.push(e),ike(r),t1(t),a}function ike(t){const e=n=>{ake(n,t)};t._debouncedUpdateFunction=e,vt.removeEventListener(ee.SEGMENTATION_DATA_MODIFIED,t._debouncedUpdateFunction),vt.addEventListener(ee.SEGMENTATION_DATA_MODIFIED,t._debouncedUpdateFunction)}const ake=hS((t,e)=>{const n=t.detail.segmentationId,r=hw.get(n);!r||!r.length||(e(n),r.length&&t1(n))},300);function AO(t,e){const n=XLe(t,e);return n?Object.entries(n.segments).reduce((i,[a,o])=>(o.visible||i.add(Number(a)),i),new Set):new Set}function oke(t,e,n=!1){const r=xr(t);if(!r)return;const{viewport:i}=r;YLe(i.element,e),n&&i.render()}async function ske(t,e){const{segmentationId:n,type:r}=e,i=ea(n);if(!i)return;let a=i.representationData[hn.Surface];if(!a&&If()?.canComputeRequestedRepresentation(n,hn.Surface)){const c=If();if(a=await PO(n,hn.Surface,()=>c.computeSurfaceData(n,{viewport:t}),()=>c.updateSurfaceData(n,{viewport:t})),!a)throw new Error(`No Surface data found for segmentationId ${n} even we tried to compute it`)}else!a&&!If()&&console.debug(`No surface data found for segmentationId ${n} and PolySeg add-on is not configured. Unable to convert from other representations to surface. Please register PolySeg using cornerstoneTools.init({ addons: { polySeg } }) to enable automatic conversion.`);if(!a){console.warn(`No Surface data found for segmentationId ${n}. Skipping render.`);return}const{geometryIds:o}=a;o?.size||console.warn(`No Surfaces found for segmentationId ${n}. Skipping render.`);const{colorLUTIndex:s}=e,l=RO(s);o.forEach(c=>{const f=yt.getGeometry(c);if(!f?.data){console.warn(`No Surfaces found for geometryId ${c}. Skipping render.`);return}const{segmentIndex:u}=f.data,h=AO(t.id,{segmentationId:n,type:r}).has(u),p=f.data,g=l[u];p.color=g.slice(0,3),p.visible=!h,eke(t.element,p,n)}),t.render()}const lke={render:ske,removeRepresentation:oke};function cke(t,e,n){const r=t.getImageIds();if(!r||!r.length)return;const i=r.map(a=>{const{imagePositionPatient:o}=Ut("imagePlaneModule",a),s=uke(e,o,n);return{imageId:a,distance:s}});return i.sort((a,o)=>a.distance-o.distance),i[0].imageId}function uke(t,e,n){const r=it();dr(r,t,e);const i=zt(r,n);return Math.abs(i)}function fke(t,e){const{segmentation:n}=t.data,{segmentation:r}=e.data;return n.segmentationId===r.segmentationId&&n.segmentIndex===r.segmentIndex}class dke{constructor(e){this.getGroupKey=n=>{if(typeof n=="string")return n;const i=Xe(n);if(!i)throw new Error("Element not enabled, you must have an enabled element if you are not providing a FrameOfReferenceUID");return i.FrameOfReferenceUID},this._imageVolumeModifiedHandler=n=>{const r=n.detail,{FrameOfReferenceUID:i}=r,o=this.annotations[i];o&&Object.keys(o).forEach(s=>{o[s].forEach(c=>{c.invalidated!==void 0&&(c.invalidated=!0)})})},this.getFramesOfReference=()=>Object.keys(this.annotations),this.getAnnotations=(n,r)=>{const i=this.annotations;return i[n]?r?i[n][r]?i[n][r]:[]:i[n]:[]},this.getAnnotation=n=>{const r=this.annotations;for(const i in r){const a=r[i];for(const o in a){const s=a[o];for(const l of s)if(n===l.annotationUID)return l}}},this.getNumberOfAnnotations=(n,r)=>{const i=this.getAnnotations(n,r);if(!i.length)return 0;if(r)return i.length;let a=0;for(const o in i)a+=i[o].length;return a},this.addAnnotation=(n,r)=>{const{metadata:i}=n,{FrameOfReferenceUID:a,toolName:o}=i;r=r||a;const s=this.annotations;let l=s[r];l||(s[r]={},l=s[r]);let c=l[o];c||(l[o]=[],c=l[o]),this.preprocessingFn&&(n=this.preprocessingFn(n)),c.push(n)},this.removeAnnotation=n=>{const{annotations:r}=this;for(const i in r){const a=r[i];for(const o in a){const s=a[o],l=s.findIndex(c=>c.annotationUID===n);l!==-1&&(s.splice(l,1),s.length===0&&delete a[o])}Object.keys(a).length===0&&delete r[i]}},this.removeAnnotations=(n,r)=>{const i=this.annotations,a=[];if(!i[n])return a;if(r){const o=i[n][r];for(const s of o)this.removeAnnotation(s.annotationUID),a.push(s)}else for(const o in i[n]){const s=i[n][o];for(const l of s)this.removeAnnotation(l.annotationUID),a.push(l)}return a},this.saveAnnotations=(n,r)=>{const i=this.annotations;if(n&&r){const a=i[n];if(!a)return;const o=a[r];return structuredClone(o)}else if(n){const a=i[n];return structuredClone(a)}return structuredClone(i)},this.restoreAnnotations=(n,r,i)=>{const a=this.annotations;if(r&&i){let o=a[r];o||(a[r]={},o=a[r]),o[i]=n}else r?a[r]=n:this.annotations=structuredClone(n)},this.getAllAnnotations=()=>Object.values(this.annotations).map(n=>Object.values(n)).flat(2),this.getNumberOfAllAnnotations=()=>{let n=0;const r=this.annotations;for(const i in r){const a=r[i];for(const o in a){const s=a[o];n+=s.length}}return n},this.removeAllAnnotations=()=>{const n=[];for(const r of this.getAllAnnotations())this.removeAnnotation(r.annotationUID),n.push(r);return n},e||(e=cr()),this.annotations={},this.uid=e,vt.addEventListener(mt.IMAGE_VOLUME_MODIFIED,this._imageVolumeModifiedHandler)}setPreprocessingFn(e){this.preprocessingFn=e}}const hke=new dke("DEFAULT"),pw=new Set;function pke(t,e=!0){const n=mke();t&&(e?vke(t,pw,n):yke(t,pw,n)),xke(n,pw)}function yo(t){return pw.has(t)}function gke(t){const e=yo(t);return pke(t,e),e}function mke(){return Object.freeze({added:[],removed:[],locked:[]})}function vke(t,e,n){if(!e.has(t)){e.add(t),n.added.push(t);const r=vo(t);r&&(r.isLocked=!0)}}function yke(t,e,n){if(e.delete(t)){n.removed.push(t);const r=vo(t);r&&(r.isLocked=!1)}}function xke(t,e){(t.added.length>0||t.removed.length>0)&&(e.forEach(n=>void t.locked.push(n)),wt(vt,ee.ANNOTATION_LOCK_CHANGE,t))}const zd=new Set;function hu(t,e=!0,n=!1){e?bke(t,n):Rte(t)}function bke(t,e=!1){const n=Pte();if(!e){Ate(zd,n);const r=vo(t);r&&(r.isSelected=!0)}if(t&&!zd.has(t)){zd.add(t),n.added.push(t);const r=vo(t);r&&(r.isSelected=!0)}Nte(n,zd)}function Rte(t){const e=Pte();if(t){if(zd.delete(t)){e.removed.push(t);const n=vo(t);n.isSelected=!1}}else Ate(zd,e);Nte(e,zd)}function pS(t){return zd.has(t)}function Pte(){return Object.freeze({added:[],removed:[],selection:[]})}function Ate(t,e){t.forEach(n=>{if(t.delete(n)){e.removed.push(n);const r=vo(n);r&&(r.isSelected=!1)}})}function Nte(t,e){(t.added.length>0||t.removed.length>0)&&(e.forEach(n=>void t.selection.push(n)),wt(vt,ee.ANNOTATION_SELECTION_CHANGE,t))}const wke=t=>(t.data||(t.data={}),t.data.handles||(t.data.handles={}),t.data.handles.textBox||(t.data.handles.textBox={}),t),Cke=t=>(t.data||(t.data={}),t.data.cachedStats||(t.data.cachedStats={}),t),oy=new Set;function Ske(t,e=!0){const n=Tke();t&&(e?Eke(t,oy,n):_ke(t,oy,n)),Dke(n)}function xo(t){if(vo(t))return!oy.has(t)}function Tke(){return Object.freeze({lastVisible:[],lastHidden:[],hidden:[]})}function Eke(t,e,n){if(e.delete(t)){n.lastVisible.push(t);const r=vo(t);r.isVisible=!0}}function _ke(t,e,n){if(!e.has(t)){e.add(t),pS(t)&&Rte(t),n.lastHidden.push(t);const r=vo(t);r.isVisible=!1}}function Dke(t){(t.lastHidden.length>0||t.lastVisible.length>0)&&(oy.forEach(e=>void t.hidden.push(e)),wt(vt,ee.ANNOTATION_VISIBILITY_CHANGE,t))}function Oke(t){const e=!oy.has(t);return Ske(t,e),e}const NO=hke,Mke=t=>{t=wke(t),t=Cke(t);const e=t.annotationUID,n=gke(e);t.isLocked=n;const r=Oke(e);return t.isVisible=r,t};NO.setPreprocessingFn(Mke);_O(NO);function Ike(){_O(NO)}function c0(t){if(!t.data.segmentation)throw new Error("removeContourSegmentationAnnotation: annotation does not have a segmentation data");const{segmentationId:e,segmentIndex:n}=t.data.segmentation,r=ea(e),{annotationUIDsMap:i}=r?.representationData.Contour||{},a=i?.get(n);a&&(a.delete(t.annotationUID),a.size||i.delete(n))}function u0(t){if(t.parentAnnotationUID)return;if(!t.data.segmentation)throw new Error("addContourSegmentationAnnotation: annotation does not have a segmentation data");const{segmentationId:e,segmentIndex:n}=t.data.segmentation,r=ea(e);r.representationData.Contour||(r.representationData.Contour={annotationUIDsMap:new Map});let{annotationUIDsMap:i}=r.representationData.Contour;i||(i=new Map);let a=i?.get(n);a||(a=new Set,i.set(n,a)),i.set(n,a.add(t.annotationUID))}const Rke="PlanarFreehandContourSegmentationTool";function Pke(t){const{polyline:e}=t.data?.contour||{};if(!e||e.length<3){console.warn("Skipping creation of new annotation due to invalid polyline:",e);return}_r(t.annotationUID),c0(t);const n=e[0],r=e[e.length-1],i={metadata:{...t.metadata,toolName:Rke,originalToolName:t.metadata.originalToolName||t.metadata.toolName},data:{cachedStats:{},handles:{points:[n,r],textBox:t.data.handles.textBox?{...t.data.handles.textBox}:void 0},contour:{...t.data.contour},spline:t.data.spline,segmentation:{...t.data.segmentation}},annotationUID:cr(),highlighted:!0,invalidated:!0,isLocked:!1,isVisible:void 0,interpolationUID:t.interpolationUID,interpolationCompleted:t.interpolationCompleted};return mr(i,t.metadata.FrameOfReferenceUID),u0(i),i}function gS(t){const r=Ps.getState().viewportSegRepresentations;return Object.entries(r).filter(([,a])=>a.some(o=>o.segmentationId===t)).map(([a])=>a)}var rs;(function(t){t[t.CounterClockwise=-1]="CounterClockwise",t[t.Unknown=0]="Unknown",t[t.Clockwise=1]="Clockwise"})(rs||(rs={}));function Ake(t,e){return t.minX<=e.maxX&&t.maxX>=e.minX&&t.minY<=e.maxY&&t.maxY>=e.minY}function bU(t,e){const n=t.maxX-t.minX,r=t.maxY-t.minY,i=[n,r],a=[t.minX+n/2,t.minY+r/2],o=[Math.abs(e[0]-a[0]),Math.abs(e[1]-a[1])],s=o[0]-i[0]*.5,l=o[1]-i[1]*.5;if(s>0&&l>0)return s*s+l*l;const c=Math.max(s,0)+Math.max(l,0);return c*c}class Nke{}const{PointsManager:Lke}=Yr;function o9(t){return{max:[-1/0],min:[1/0],sum:[0],count:0,maxIJK:null,maxLPS:null,minIJK:null,minLPS:null,runMean:[0],m2:[0],m3:[0],m4:[0],allValues:[[]],pointsInShape:t?Lke.create3(1024):null,sumLPS:[0,0,0]}}function kke(t,e,n=null,r=null){Array.isArray(e)&&e.length>1&&t.max.length===1&&(t.max.push(t.max[0],t.max[0]),t.min.push(t.min[0],t.min[0]),t.sum.push(t.sum[0],t.sum[0]),t.runMean.push(0,0),t.m2.push(t.m2[0],t.m2[0]),t.m3.push(t.m3[0],t.m3[0]),t.m4.push(t.m4[0],t.m4[0]),t.allValues.push([],[])),t?.pointsInShape&&n&&t.pointsInShape.push(n);const i=Array.isArray(e)?e:[e];t.count+=1,n&&(t.sumLPS[0]+=n[0],t.sumLPS[1]+=n[1],t.sumLPS[2]+=n[2]),t.max.forEach((a,o)=>{const s=i[o];t.allValues[o].push(s);const l=t.count,c=s-t.runMean[o],f=c/l,u=c*f*(l-1);t.sum[o]+=s,t.runMean[o]+=f,t.m4[o]+=u*f*f*(l*l-3*l+3)+6*f*f*t.m2[o]-4*f*t.m3[o],t.m3[o]+=u*f*(l-2)-3*f*t.m2[o],t.m2[o]+=u,s<t.min[o]&&(t.min[o]=s,o===0&&(t.minIJK=r?[...r]:null,t.minLPS=n?[...n]:null)),s>t.max[o]&&(t.max[o]=s,o===0&&(t.maxIJK=r?[...r]:null,t.maxLPS=n?[...n]:null))})}function Vke(t){if(t.length===0)return 0;const e=[...t].sort((r,i)=>r-i),n=Math.floor(e.length/2);return e.length%2===0?(e[n-1]+e[n])/2:e[n]}function Fke(t,e){const n=t.sum.map(u=>u/t.count),r=t.m2.map(u=>Math.sqrt(u/t.count)),i=t.sumLPS.map(u=>u/t.count),a=t.m3.map((u,d)=>{const h=t.m2[d]/t.count;return h===0?0:u/(t.count*Math.pow(h,1.5))}),o=t.m4.map((u,d)=>{const h=t.m2[d]/t.count;return h===0?0:u/(t.count*h*h)-3}),s=t.allValues.map(u=>Vke(u)),l={max:{name:"max",label:"Max Pixel",value:t.max.length===1?t.max[0]:t.max,unit:e,pointIJK:t.maxIJK?[...t.maxIJK]:null,pointLPS:t.maxLPS?[...t.maxLPS]:null},min:{name:"min",label:"Min Pixel",value:t.min.length===1?t.min[0]:t.min,unit:e,pointIJK:t.minIJK?[...t.minIJK]:null,pointLPS:t.minLPS?[...t.minLPS]:null},mean:{name:"mean",label:"Mean Pixel",value:n.length===1?n[0]:n,unit:e},stdDev:{name:"stdDev",label:"Standard Deviation",value:r.length===1?r[0]:r,unit:e},count:{name:"count",label:"Voxel Count",value:t.count,unit:null},median:{name:"median",label:"Median",value:s.length===1?s[0]:s,unit:e},skewness:{name:"skewness",label:"Skewness",value:a.length===1?a[0]:a,unit:null},kurtosis:{name:"kurtosis",label:"Kurtosis",value:o.length===1?o[0]:o,unit:null},maxLPS:{name:"maxLPS",label:"Max LPS",value:t.maxLPS?Array.from(t.maxLPS):null,unit:null},minLPS:{name:"minLPS",label:"Min LPS",value:t.minLPS?Array.from(t.minLPS):null,unit:null},pointsInShape:t.pointsInShape,center:{name:"center",label:"Center",value:i?[...i]:null,unit:null},array:[]};l.array.push(l.min,l.max,l.mean,l.stdDev,l.median,l.skewness,l.kurtosis,l.count,l.maxLPS,l.minLPS),l.center.value&&l.array.push(l.center);const c=t.pointsInShape!==null,f=o9(c);return t.max=f.max,t.min=f.min,t.sum=f.sum,t.count=f.count,t.maxIJK=f.maxIJK,t.maxLPS=f.maxLPS,t.minIJK=f.minIJK,t.minLPS=f.minLPS,t.runMean=f.runMean,t.m2=f.m2,t.m3=f.m3,t.m4=f.m4,t.allValues=f.allValues,t.pointsInShape=f.pointsInShape,t.sumLPS=f.sumLPS,l}const ih=class ih extends Nke{static statsInit(e){e.storePointData||(this.state.pointsInShape=null),this.state=o9(e.storePointData)}};ih.state=o9(!0),ih.statsCallback=({value:e,pointLPS:n=null,pointIJK:r=null})=>{kke(ih.state,e,n,r)},ih.getStatistics=e=>Fke(ih.state,e?.unit);let f0=ih;function d0(t,e){if(t.length!==e.length)throw Error("Both points should have the same dimensionality");const[n,r,i=0]=t,[a,o,s=0]=e,l=a-n,c=o-r,f=s-i;return l*l+c*c+f*f}function Qh(t,e){return Math.sqrt(d0(t,e))}function wU(t,e){const[n,r]=t,[i,a]=e,o=2*i-n,s=2*a-r;return[o,s]}function f2(t){const[e,n]=t;return Qh(e,n)}function CU(t){const[e,n]=t,r=Qh(e,n),i=[e[0]-r,e[1]-r],a=[e[0]+r,e[1]+r];return[i,a]}function Lte(t,e,n={}){return n.precalculated||Uke(t,n),n.precalculated(e)}const Uke=(t,e={})=>{const{xRadius:n,yRadius:r,zRadius:i}=t;(e.invXRadiusSq===void 0||e.invYRadiusSq===void 0||e.invZRadiusSq===void 0)&&(e.invXRadiusSq=n!==0?1/n**2:0,e.invYRadiusSq=r!==0?1/r**2:0,e.invZRadiusSq=i!==0?1/i**2:0);const{invXRadiusSq:a,invYRadiusSq:o,invZRadiusSq:s}=e,{center:l}=t,[c,f,u]=l;return e.precalculated=d=>{const h=d[0]-c;let p=h*h*a;if(p>1)return!1;const g=d[1]-f;if(p+=g*g*o,p>1)return!1;const m=d[2]-u;return p+=m*m*s,p<=1},e};function SU(t){const[e,n,r,i]=t,a=[r[0],n[1]],o=[i[0],e[1]];return[a,o]}function s9(t,e,n){let r;const i=d0(t,e);if(t[0]===e[0]&&t[1]===e[1]&&(r=t),!r){const a=((n[0]-t[0])*(e[0]-t[0])+(n[1]-t[1])*(e[1]-t[1]))/i;a<0?r=t:a>1?r=e:r=[t[0]+a*(e[0]-t[0]),t[1]+a*(e[1]-t[1])]}return{point:[...r],distanceSquared:d0(n,r)}}function mS(t,e,n){return s9(t,e,n).distanceSquared}function Ll(t,e,n){if(t.length!==2||e.length!==2||n.length!==2)throw Error("lineStart, lineEnd, and point should have 2 elements of [x, y]");return Math.sqrt(mS(t,e,n))}function pb(t){return typeof t=="number"?t?t<0?-1:1:t===t?0:NaN:NaN}function TU(t,e,n,r,i=!1){const[a,o]=t,[s,l]=e,[c,f]=n,[u,d]=r;if(i){const P=(a-s)*(f-d)-(o-l)*(c-u);if(Math.abs(P)<1e-10)return;const N=((a-c)*(f-d)-(o-f)*(c-u))/P,A=a+N*(s-a),B=o+N*(l-o);return[A,B]}const h=l-o,p=a-s,g=s*o-a*l,m=h*c+p*f+g,y=h*u+p*d+g;if(m!==0&&y!==0&&pb(m)===pb(y))return;const v=d-f,x=c-u,w=u*f-c*d,S=v*a+x*o+w,T=v*s+x*l+w;if(S!==0&&T!==0&&pb(S)===pb(T))return;const _=h*x-v*p;let D;D=p*w-x*g;const I=D/_;D=v*g-h*w;const R=D/_;return[I,R]}const hv=.01;function I8(t,e,n){const r=t[0]<=e[0]?t[0]:e[0],i=t[0]>=e[0]?t[0]:e[0],a=t[1]<=e[1]?t[1]:e[1],o=t[1]>=e[1]?t[1]:e[1];if(!(n[0]>=r-hv&&n[0]<=i+hv&&n[1]>=a-hv&&n[1]<=o+hv))return!1;const l=(e[1]-t[1])*(n[0]-e[0])-(e[0]-t[0])*(n[1]-e[1]);return(l>=0?l:-l)<=hv}function kte(t){if(t.length<3)return!1;const e=t.length,n=t[0],r=t[e-1],i=d0(n,r);return e3(0,i)}function Qo(t,e,n={closed:void 0}){if(t.length<3)return!1;const r=t.length;let i=0;const{closed:a,holes:o}=n;if(o?.length){for(const c of o)if(Qo(c,e))return!1}const s=!(a===void 0?kte(t):a),l=t.length-(s?1:2);for(let c=0;c<=l;c++){const f=t[c],u=c===r-1?0:c+1,d=t[u],h=f[0]>=d[0]?f[0]:d[0],p=f[1]>=d[1]?f[1]:d[1],g=f[1]<=d[1]?f[1]:d[1];if(e[0]<=h&&e[1]>=g&&e[1]<p){let v=f[0]===d[0];if(!v){const x=(e[1]-f[1])*(d[0]-f[0])/(d[1]-f[1])+f[0];v=e[0]<=x}i+=v?1:0}}return!!(i%2)}function Wy(t,e){for(let n=0,r=e.length;n<r;n++)if(!Qo(t,e[n]))return!1;return!0}function xm(t,e){let n=t;const r=e?.numDimensions||2,i=r===3;if(!Array.isArray(t[0])){const u=t,d=u.length/r;n=new Array(u.length/r);for(let h=0,p=d;h<p;h++)n[h]=[u[h*r],u[h*r+1]],i&&n[h].push(u[h*r+2])}let a=1/0,o=1/0,s=-1/0,l=-1/0,c=1/0,f=-1/0;n=n;for(let u=0,d=n.length;u<d;u++){const[h,p,g]=n[u];a=a<h?a:h,o=o<p?o:p,s=s>h?s:h,l=l>p?l:p,i&&(c=c<g?c:g,f=f>g?f:g)}return i?{minX:a,maxX:s,minY:o,maxY:l,minZ:c,maxZ:f}:{minX:a,maxX:s,minY:o,maxY:l}}function Hy(t){const e=t.length;let n=0,r=e-1;for(let i=0;i<e;i++)n+=(t[r][0]+t[i][0])*(t[r][1]-t[i][1]),r=i;return Math.abs(n/2)}function Jd(t){if(t.length<3)return 0;const e=t[0];let n=0;for(let r=0,i=t.length;r<i;r++){const a=t[r],o=r===i-1?0:r+1,s=t[o],l=a[0]-e[0],c=a[1]-e[1],f=s[0]-e[0],u=s[1]-e[1];n+=l*u-c*f}return n*=.5,n}function gw(t){return Jd(t)>=0?1:-1}function Bke(t){const e=it(),n=t[0];for(let r=0,i=t.length;r<i;r++){const a=t[r],o=r===i-1?0:r+1,s=t[o],l=a[0]-n[0],c=a[1]-n[1],f=a[2]-n[2],u=s[0]-n[0],d=s[1]-n[1],h=s[2]-n[2];e[0]+=c*h-f*d,e[1]+=f*u-l*h,e[2]+=l*d-c*u}return tl(e,e,.5),e}function $ke(t){const e=Bke(t);return Lr(e,e)}function l9(t){const e=Jd(t);return[0,0,e/Math.abs(e)]}const Ca=1e-7;function R8(t,e){return t[0]*e[1]-t[1]*e[0]}function Ii(t,e){return pr(t,e,Ca)}function Vte(t,e,n,r){const i=ka(Kn(),e,t),a=ka(Kn(),r,n),o=R8(i,a),s=ka(Kn(),n,t),l=R8(s,i);if(Math.abs(o)<Ca){if(Math.abs(l)<Ca){const u=pf(i,i),d=pf(a,a);if(u<Ca||d<Ca)return Ii(t,n)||Ii(t,r)?t:Ii(e,n)||Ii(e,r)?e:null;const h=pf(ka(Kn(),n,t),i)/u,p=pf(ka(Kn(),r,t),i)/u,g=pf(ka(Kn(),t,n),a)/d,m=pf(ka(Kn(),e,n),a)/d,y=v=>v>=-Ca&&v<=1+Ca;if(y(h)){const v=Ov(Kn(),t,i,h);if(Ii(n,v))return n}if(y(p)){const v=Ov(Kn(),t,i,p);if(Ii(r,v))return r}if(y(g)){const v=Ov(Kn(),n,a,g);if(Ii(t,v))return t}if(y(m)){const v=Ov(Kn(),n,a,m);if(Ii(e,v))return e}}return null}const c=R8(s,a)/o,f=l/o;return c>=-Ca&&c<=1+Ca&&f>=-Ca&&f<=1+Ca?[t[0]+c*i[0],t[1]+c*i[1]]:null}var bf;(function(t){t[t.Vertex=0]="Vertex",t[t.Intersection=1]="Intersection"})(bf||(bf={}));var Oo;(function(t){t[t.Entering=0]="Entering",t[t.Exiting=1]="Exiting",t[t.Unknown=2]="Unknown"})(Oo||(Oo={}));function Fte(t,e){if(t.length!==e.length)return!1;const n=t.length;if(n===0)return!0;let r=!0;for(let a=0;a<n;a++)if(!Ii(t[a],e[a])){r=!1;break}if(r)return!0;let i=!0;for(let a=0;a<n;a++)if(!Ii(t[a],e[n-1-a])){i=!1;break}if(i)return!0;for(let a=1;a<n;a++){let o=!0;for(let l=0;l<n;l++)if(!Ii(t[l],e[(l+a)%n])){o=!1;break}if(o)return!0;let s=!0;for(let l=0;l<n;l++)if(!Ii(t[l],e[(n-1-l+a)%n])){s=!1;break}if(s)return!0}return!1}function LO(t,e){if(t.length<3)return[];if(e.length<3)return[t.slice()];const n=e.slice();if(Fte(t,e))return[];const r=Jd(t),i=Jd(n);Math.sign(r)===Math.sign(i)&&Math.abs(i)>Ca&&n.reverse();const a=[];for(let f=0;f<t.length;f++){const u=t[f],d=t[(f+1)%t.length];for(let h=0;h<n.length;h++){const p=n[h],g=n[(h+1)%n.length],m=Vte(u,d,p,g);if(m){const y=Math.sqrt(Ud(u,d)),v=Math.sqrt(Ud(p,g));a.push({coord:m,seg1Idx:f,seg2Idx:h,alpha1:y<Ca?0:Math.sqrt(Ud(u,m))/y,alpha2:v<Ca?0:Math.sqrt(Ud(p,m))/v})}}}const o=(f,u,d)=>{const h=[];let p=0;for(let m=0;m<f.length;m++){const y=f[m];h.push({id:`${u}_v${p++}`,coordinates:y,type:bf.Vertex,originalPolyIndex:u,originalVertexIndex:m,next:null,prev:null,isIntersection:!1,visited:!1});const v=d.filter(x=>(u===0?x.seg1Idx:x.seg2Idx)===m).sort((x,w)=>(u===0?x.alpha1:x.alpha2)-(u===0?w.alpha1:w.alpha2));for(const x of v){if(h.length>0&&Ii(h[h.length-1].coordinates,x.coord)){h[h.length-1].isIntersection||(h[h.length-1].isIntersection=!0,h[h.length-1].intersectionInfo=x,h[h.length-1].alpha=u===0?x.alpha1:x.alpha2);continue}h.push({id:`${u}_i${p++}`,coordinates:x.coord,type:bf.Intersection,originalPolyIndex:u,next:null,prev:null,isIntersection:!0,visited:!1,alpha:u===0?x.alpha1:x.alpha2,intersectionInfo:x})}}const g=[];if(h.length>0){g.push(h[0]);for(let m=1;m<h.length;m++)Ii(h[m].coordinates,g[g.length-1].coordinates)?h[m].isIntersection&&(g[g.length-1].isIntersection=!0,g[g.length-1].intersectionInfo=h[m].intersectionInfo,g[g.length-1].alpha=h[m].alpha):g.push(h[m])}if(g.length>0)for(let m=0;m<g.length;m++)g[m].next=g[(m+1)%g.length],g[m].prev=g[(m-1+g.length)%g.length];return g},s=o(t,0,a),l=o(n,1,a);s.forEach(f=>{if(f.isIntersection){const u=f.intersectionInfo,d=l.find(h=>h.isIntersection&&Ii(h.coordinates,f.coordinates)&&h.intersectionInfo.seg1Idx===u.seg1Idx&&h.intersectionInfo.seg2Idx===u.seg2Idx);if(d){f.partnerNode=d,d.partnerNode=f;const h=f.prev.coordinates,p=f.coordinates,g=d.next.coordinates;ka(Kn(),p,h),ka(Kn(),g,p);const m=[(f.prev.coordinates[0]+f.coordinates[0])/2,(f.prev.coordinates[1]+f.coordinates[1])/2];Qo(e,m)?f.intersectionDir=Oo.Exiting:f.intersectionDir=Oo.Entering}else f.isIntersection=!1}}),s.forEach(f=>delete f.intersectionInfo),l.forEach(f=>delete f.intersectionInfo);const c=[];for(let f=0;f<s.length;f++){const u=s[f];if(u.visited||u.isIntersection||Qo(e,u.coordinates))continue;const d=[];let h=u,p=!0,g=0;const m=(s.length+l.length)*2;do{if(g++>m){console.warn("Subtraction: Max iterations reached, possible infinite loop.");break}h.visited=!0,(d.length===0||!Ii(d[d.length-1],h.coordinates))&&d.push(h.coordinates),h.isIntersection&&(p?h.intersectionDir===Oo.Entering&&h.partnerNode&&(h=h.partnerNode,p=!1):h.partnerNode?(h=h.partnerNode,p=!0):console.warn("Subtraction: Intersection on source without partner.")),h=h.next}while(h!==u||!p);d.length>=3&&(Ii(d[0],d[d.length-1])&&d.pop(),d.length>=3&&c.push(d))}return c}function Gke(t,e){if(t.length<3||e.length<3)return[];let n=e.slice();const r=Jd(t),i=Jd(n);if(Math.abs(r)<Ca||Math.abs(i)<Ca)return[];r<0&&(t=t.slice().reverse()),i<0&&(n=n.slice().reverse());const a=n,o=[];for(let u=0;u<t.length;u++){const d=t[u],h=t[(u+1)%t.length];for(let p=0;p<n.length;p++){const g=n[p],m=n[(p+1)%n.length],y=Vte(d,h,g,m);if(y){const v=Math.sqrt(Ud(d,h)),x=Math.sqrt(Ud(g,m));o.push({coord:[...y],seg1Idx:u,seg2Idx:p,alpha1:v<Ca?0:Math.sqrt(Ud(d,y))/v,alpha2:x<Ca?0:Math.sqrt(Ud(g,y))/x})}}}if(o.length===0)return Qo(a,t[0])&&t.every(u=>Qo(a,u))?[[...t.map(u=>[...u])]]:Qo(t,n[0])&&n.every(u=>Qo(t,u))?[[...n.map(u=>[...u])]]:[];const s=(u,d,h)=>{const p=[];let g=0;for(let y=0;y<u.length;y++){const v=u[y];p.push({id:`${d}_v${g++}`,coordinates:[...v],type:bf.Vertex,originalPolyIndex:d,originalVertexIndex:y,next:null,prev:null,isIntersection:!1,visited:!1,processedInPath:!1,intersectionDir:Oo.Unknown});const x=h.filter(w=>(d===0?w.seg1Idx:w.seg2Idx)===y).sort((w,S)=>(d===0?w.alpha1:w.alpha2)-(d===0?S.alpha1:S.alpha2));for(const w of x){if(p.length>0&&Ii(p[p.length-1].coordinates,w.coord)){const S=p[p.length-1];S.isIntersection||(S.isIntersection=!0,S.intersectionInfo=w,S.alpha=d===0?w.alpha1:w.alpha2,S.type=bf.Intersection);continue}p.push({id:`${d}_i${g++}`,coordinates:[...w.coord],type:bf.Intersection,originalPolyIndex:d,next:null,prev:null,isIntersection:!0,visited:!1,processedInPath:!1,alpha:d===0?w.alpha1:w.alpha2,intersectionInfo:w,intersectionDir:Oo.Unknown})}}const m=[];if(p.length>0){m.push(p[0]);for(let y=1;y<p.length;y++)if(!Ii(p[y].coordinates,m[m.length-1].coordinates))m.push(p[y]);else{const v=m[m.length-1];p[y].isIntersection&&p[y].intersectionInfo&&(v.isIntersection=!0,v.intersectionInfo=p[y].intersectionInfo,v.alpha=p[y].alpha,v.type=bf.Intersection)}}if(m.length>1&&Ii(m[0].coordinates,m[m.length-1].coordinates)){const y=m[0],v=m.pop();v.isIntersection&&!y.isIntersection&&v.intersectionInfo&&(y.isIntersection=!0,y.intersectionInfo=v.intersectionInfo,y.alpha=v.alpha,y.type=bf.Intersection)}if(m.length>0)for(let y=0;y<m.length;y++)m[y].next=m[(y+1)%m.length],m[y].prev=m[(y-1+m.length)%m.length];return m},l=s(t,0,o),c=s(n,1,o);if(l.length===0||c.length===0)return[];l.forEach(u=>{if(u.isIntersection&&u.intersectionInfo){const d=u.intersectionInfo,h=c.find(p=>p.isIntersection&&p.intersectionInfo&&Ii(p.coordinates,u.coordinates)&&p.intersectionInfo.seg1Idx===d.seg1Idx&&p.intersectionInfo.seg2Idx===d.seg2Idx);if(h){u.partnerNode=h,h.partnerNode=u;const p=ka(Kn(),u.coordinates,u.prev.coordinates),g=ka(Kn(),h.next.coordinates,h.coordinates),m=p[0]*g[1]-p[1]*g[0];if(m>Ca)u.intersectionDir=Oo.Entering,h.intersectionDir=Oo.Exiting;else if(m<-Ca)u.intersectionDir=Oo.Exiting,h.intersectionDir=Oo.Entering;else{const y=[(u.prev.coordinates[0]+u.coordinates[0])/2,(u.prev.coordinates[1]+u.coordinates[1])/2];Qo(a,y)?(u.intersectionDir=Oo.Exiting,h.intersectionDir=Oo.Entering):(u.intersectionDir=Oo.Entering,h.intersectionDir=Oo.Exiting)}}else u.isIntersection=!1,u.intersectionInfo=void 0}});const f=[];for(const u of l){if(!u.isIntersection||u.visited||u.intersectionDir!==Oo.Entering)continue;let d=[],h=u,p=!0;const g=u;let m=0;const y=(l.length+c.length)*2;l.forEach(v=>v.processedInPath=!1),c.forEach(v=>v.processedInPath=!1);do{if(m++>y){console.warn("Intersection: Max iterations in path tracing.",g.id,h.id),d=[];break}if(h.processedInPath&&h!==g){console.warn("Intersection: Path processing loop detected, discarding path segment.",g.id,h.id),d=[];break}h.processedInPath=!0,h.visited=!0,(d.length===0||!Ii(d[d.length-1],h.coordinates))&&d.push([...h.coordinates]);let v=!1;h.isIntersection&&h.partnerNode&&(p?(h=h.partnerNode,p=!1,v=!0):(h=h.partnerNode,p=!0,v=!0)),h=h.next}while(h!==g||p&&h.originalPolyIndex!==0||!p&&h.originalPolyIndex!==1);if(m>y||d.length===0||d.length>0&&Ii(d[0],d[d.length-1])&&d.pop(),d.length>=3){const v=Jd(d);(r>0&&v<0||r<0&&v>0)&&d.reverse(),f.push(d.map(x=>[...x]))}}return f}function kO(t,e,n,r){let i=!1;const a=t[0]<e[0]?t[0]:e[0],o=t[1]<e[1]?t[1]:e[1],s=t[0]>e[0]?t[0]:e[0],l=t[1]>e[1]?t[1]:e[1],c=n[0]<r[0]?n[0]:r[0],f=n[1]<r[1]?n[1]:r[1],u=n[0]>r[0]?n[0]:r[0],d=n[1]>r[1]?n[1]:r[1];if(a>u||s<c||o>d||l<f)return!1;const h=[gb(t,e,n),gb(t,e,r),gb(n,r,t),gb(n,r,e)];return h[0]!==h[1]&&h[2]!==h[3]?!0:((h[0]===0&&mb(t,n,e)||h[1]===0&&mb(t,r,e)||h[2]===0&&mb(n,t,r)||h[3]===0&&mb(n,e,r))&&(i=!0),i)}function gb(t,e,n){const r=(e[1]-t[1])*(n[0]-e[0])-(e[0]-t[0])*(n[1]-e[1]);return r===0?0:r>0?1:2}function mb(t,e,n){return e[0]<=Math.max(t[0],n[0])&&e[0]>=Math.min(t[0],n[0])&&e[1]<=Math.max(t[1],n[1])&&e[1]>=Math.min(t[1],n[1])}function VO(t,e,n,r=!0){const i=[],a=t.length,o=a-(r?1:2);for(let s=0;s<=o;s++){const l=t[s],c=s===a-1?0:s+1,f=t[c];kO(e,n,l,f)&&i.push([s,c])}return i}function Ute(t,e,n,r=!0){let i,a;r?(a=t.length-1,i=0):(a=0,i=1);for(let o=i;o<t.length;o++){const s=t[a],l=t[o];if(kO(e,n,s,l))return[a,o];a=o}}function FO(t,e){for(let n=0,r=t.length;n<r;n++){const i=t[n],a=n===r-1?0:n+1,o=t[a];if(Ute(e,i,o)?.length===2)return!0}return!1}const jke=.01;function Bte(t,e,n,r){const i=[e[0]-t[0],e[1]-t[1]],a=[r[0]-n[0],r[1]-n[1]],o=a[1]*i[0]-a[0]*i[1];if((o>=0?o:-o)<jke){const p=[t[0]<e[0]?t[0]:e[0],t[0]>e[0]?t[0]:e[0],t[1]<e[1]?t[1]:e[1],t[1]>e[1]?t[1]:e[1]],g=[n[0]<r[0]?n[0]:r[0],n[0]>r[0]?n[0]:r[0],n[1]<r[1]?n[1]:r[1],n[1]>r[1]?n[1]:r[1]];if(!(p[0]<=g[1]&&p[1]>=g[0]&&p[2]<=g[3]&&p[3]>=g[2])||!(I8(t,e,n)||I8(t,e,r)||I8(n,r,t)))return;const v=p[0]>g[0]?p[0]:g[0],x=p[1]<g[1]?p[1]:g[1],w=p[2]>g[2]?p[2]:g[2],S=p[3]<g[3]?p[3]:g[3],T=(v+x)*.5,_=(w+S)*.5;return[T,_]}let l=t[1]-n[1],c=t[0]-n[0];const f=a[0]*l-a[1]*c,u=i[0]*l-i[1]*c;l=f/o,c=u/o;const d=t[0]+l*i[0],h=t[1]+l*i[1];return[d,h]}var Eh;(function(t){t[t.Vertex=0]="Vertex",t[t.Intersection=1]="Intersection"})(Eh||(Eh={}));var _h;(function(t){t[t.Outside=-1]="Outside",t[t.Edge=0]="Edge",t[t.Inside=1]="Inside"})(_h||(_h={}));var dg;(function(t){t[t.Exiting=-1]="Exiting",t[t.Unknown=0]="Unknown",t[t.Entering=1]="Entering"})(dg||(dg={}));function EU(t){for(let e=0,n=t.length;e<n;e++){const r=t[e];r.next||(r.next=t[e===n-1?0:e+1])}}function zke(t,e){const n=[],r=[],i=new Map;let o=Qo(e,t[0])?dg.Exiting:dg.Entering;for(let s=0,l=t.length;s<l;s++){const c=t[s],f=Qo(e,c),u={type:Eh.Vertex,coordinates:c,position:f?_h.Inside:_h.Outside,visited:!1,next:null};n.push(u);const d=t[s===l-1?0:s+1],h=VO(e,c,d).map(p=>{const g=p[0],m=e[p[0]],y=e[p[1]],v=Bte(c,d,m,y),x=d0(c,v);return{sourceLineSegmentId:g,coordinate:v,targetStartPointDistSquared:x}});h.sort((p,g)=>p.targetStartPointDistSquared-g.targetStartPointDistSquared),h.forEach(p=>{const{sourceLineSegmentId:g,coordinate:m}=p,y={type:Eh.Intersection,coordinates:m,position:_h.Edge,direction:o,visited:!1,next:null},v={...y,direction:dg.Unknown,cloned:!0};o===dg.Entering?y.next=v:v.next=y;let x=i.get(g);x||(x=[],i.set(g,x)),n.push(y),x.push(v),o*=-1})}for(let s=0,l=e.length;s<l;s++){const c=s,f=e[s],u={type:Eh.Vertex,coordinates:f,visited:!1,next:null};r.push(u);const d=i.get(c);d?.length&&d.map(h=>({intersectionPoint:h,lineSegStartDistSquared:d0(f,h.coordinates)})).sort((h,p)=>h.lineSegStartDistSquared-p.lineSegStartDistSquared).map(({intersectionPoint:h})=>h).forEach(h=>r.push(h))}return EU(n),EU(r),{targetPolylinePoints:n,sourcePolylinePoints:r}}function Wke(t){for(let e=0,n=t.length;e<n;e++){const r=t[e];if(!r.visited&&r.position===_h.Outside&&r.type===Eh.Vertex)return r}for(let e=0,n=t.length;e<n;e++){const r=t[e];if(!r.visited&&r.position===_h.Outside)return r}}function UO(t,e){const n=l9(t),r=l9(e),i=zt(r,n);if(e3(1,i)||(e=e.slice().reverse()),!FO(e,t)&&Wy(e,t))return e.slice();const{targetPolylinePoints:s}=zke(t,e),l=Wke(s);if(!l)return t.slice();const c=[l.coordinates];let f=l.next,u=0;const d=t.length+e.length+1e3;for(;f!==l&&u<d;){if(u++,f.type===Eh.Intersection&&f.cloned){f=f.next;continue}if(c.push(f.coordinates),f=f.next,!f){console.warn("Broken linked list detected in mergePolylines, breaking loop");break}}return u>=d&&console.warn("Maximum iterations reached in mergePolylines, possible infinite loop detected"),c}const Hke=.1;function $te(t,e=Hke){const n=t.length;if(n<3)return t;const r=e*e,i=[[0,n-1]],a=new Array(n).fill(!1);let o=2;for(a[0]=!0,a[n-1]=!0;i.length;){const[l,c]=i.pop();if(c-l===1)continue;const f=t[l],u=t[c];let d=-1/0,h=-1;for(let p=l+1;p<c;p++){const g=t[p],m=mS(f,u,g);m>d&&(d=m,h=p)}d<r||(a[h]=!0,o++,i.push([h,c]),i.push([l,h]))}const s=new Array(o);for(let l=0,c=0;l<n;l++)a[l]&&(s[c++]=t[l]);return s}function Gte(t,e,n,r=!0){const i=[],a=VO(t,e,n,r);for(let o=0;o<a.length;o++){const s=t[a[o][0]],l=t[a[o][1]],c=Bte(e,n,s,l);i.push(c)}return i}function Kke(t,e,n,r=!0){let i,a;r?(a=t.length-1,i=0):(a=0,i=1);const o=[];for(let f=i;f<t.length;f++){const u=t[a],d=t[f];kO(e,n,u,d)&&o.push([a,f]),a=f}if(o.length===0)return;const s=[];o.forEach(f=>{const u=[t[f[0]],t[f[1]]],d=[(u[0][0]+u[1][0])/2,(u[0][1]+u[1][1])/2];s.push(ii(d,e))});const l=Math.min(...s),c=s.indexOf(l);return{segment:o[c],distance:l}}const Hp=.001,qke=(t,e)=>{let n,r,i;if(t instanceof fa){const o=t.getImageData();if(!o)return;r=o.direction.slice(0,3),i=o.direction.slice(3,6),n=o.spacing}else{const o=t.getImageData(),{direction:s,spacing:l}=o,{viewPlaneNormal:c,viewUp:f}=t.getCamera(),u=s.slice(0,3),d=s.slice(3,6),h=s.slice(6,9),p=it();gr(p,f,c);const g=Math.abs(zt(p,u)),m=Math.abs(zt(p,d)),y=Math.abs(zt(p,h));let v;if(Math.abs(1-g)<Hp)v=l[0],r=u;else if(Math.abs(1-m)<Hp)v=l[1],r=d;else if(Math.abs(1-y)<Hp)v=l[2],r=h;else throw new Error("No support yet for oblique plane planar contours");const x=Math.abs(zt(f,u)),w=Math.abs(zt(f,d)),S=Math.abs(zt(f,h));let T;if(Math.abs(1-x)<Hp)T=l[0],i=u;else if(Math.abs(1-w)<Hp)T=l[1],i=d;else if(Math.abs(1-S)<Hp)T=l[2],i=h;else throw new Error("No support yet for oblique plane planar contours");n=[v,T]}return{spacing:[n[0]/e,n[1]/e],xDir:r,yDir:i}},Xke=(t,e,n)=>n7(t,e)<n,Yke=(t,e,n,r)=>{const{xDir:i,yDir:a,spacing:o}=r,s=Xe(t),{viewport:l}=s;if(!e.length)return e.push(n),console.log(">>>>> !canvasPoints. :: RETURN"),1;const c=l.canvasToWorld(e[e.length-1]),f=l.canvasToWorld(n),u=it();Pr(u,f,c);const d=Math.abs(zt(u,i)),h=Math.abs(zt(u,a)),p=Math.max(Math.floor(d/o[0]),Math.floor(h/o[0]));if(p>1){const g=e[e.length-1],m=n7(g,n),y=Kn();ka(y,n,g),Nl(y,y[0]/m,y[1]/m);const v=m/p;for(let x=1;x<=p;x++)e.push([g[0]+v*y[0]*x,g[1]+v*y[1]*x])}else e.push(n);return p},Jke=(t,e,n,r)=>{const i=[t[0]-e[0],t[1]-e[1]],a=[n[0]-e[0],n[1]-e[1]],o=i[0]*a[0]+i[1]*a[1];if(o<0)return!1;const s=Math.sqrt(a[0]*a[0]+a[1]*a[1]);if(s===0)return!1;const l=o/s,c=[a[0]/s,a[1]/s],f=[c[0]*l,c[1]*l],u=[e[0]+f[0],e[1]+f[1]];return!(ii(t,u)>r||ii(e,u)>ii(e,n))},Zke=1e-6;function jte(t){let e;const n=vO(t,50);for(let o=0;o<3;o++)if(n.every((s,l,c)=>Math.abs(s[o]-c[0][o])<Zke)){e=o;break}if(e===void 0)throw new Error("Cannot find a shared dimension index for polyline, probably oblique plane");const r=[],i=(e+1)%3,a=(e+2)%3;for(let o=0;o<t.length;o++)r.push([t[o][i],t[o][a]]);return{sharedDimensionIndex:e,projectedPolyline:r}}function zte(t,e,n={}){const{sharedDimensionIndex:r,projectedPolyline:i}=jte(e),{holes:a}=n,o=[];if(a)for(let l=0;l<a.length;l++){const c=a[l],f=[];for(let u=0;u<c.length;u++)f.push([c[u][(r+1)%3],c[u][(r+2)%3]]);o.push(f)}const s=[t[(r+1)%3],t[(r+2)%3]];return Qo(i,s,{holes:o})}function Qke(t){if(t.length<3)return t.slice();const e=t.map(a=>[a[0],a[1]]).sort((a,o)=>a[0]===o[0]?a[1]-o[1]:a[0]-o[0]);function n(a,o,s){return(o[0]-a[0])*(s[1]-a[1])-(o[1]-a[1])*(s[0]-a[0])}const r=[];for(const a of e){for(;r.length>=2&&n(r[r.length-2],r[r.length-1],a)<=0;)r.pop();r.push(a)}const i=[];for(let a=e.length-1;a>=0;a--){const o=e[a];for(;i.length>=2&&n(i[i.length-2],i[i.length-1],o)<=0;)i.pop();i.push(o)}return r.pop(),i.pop(),r.concat(i)}const ep=Object.freeze(Object.defineProperty({__proto__:null,addCanvasPointsToArray:Yke,arePolylinesIdentical:Fte,containsPoint:Qo,containsPoints:Wy,convexHull:Qke,decimate:$te,getAABB:xm,getArea:Hy,getClosestLineSegmentIntersection:Kke,getFirstLineSegmentIntersectionIndexes:Ute,getLineSegmentIntersectionsCoordinates:Gte,getLineSegmentIntersectionsIndexes:VO,getNormal2:l9,getNormal3:$ke,getSignedArea:Jd,getSubPixelSpacingAndXYDirections:qke,getWindingDirection:gw,intersectPolyline:FO,intersectPolylines:Gke,isClosed:kte,isPointInsidePolyline3D:zte,mergePolylines:UO,pointCanProjectOnLine:Jke,pointsAreWithinCloseContourProximity:Xke,projectTo2D:jte,subtractPolylines:LO},Symbol.toStringTag,{value:"Module"}));function eVe(t,e,n,r){const i=[t,e],a=[t+n,e],o=[t+n,e],s=[t+n,e+r],l=[t+n,e+r],c=[t,e+r],f=[t,e+r];return{top:[i,a],right:[o,s],bottom:[l,c],left:[f,[t,e]]}}function tVe(t,e){if(t.length!==4||e.length!==2)throw Error("rectangle:[left, top, width, height] or point: [x,y] not defined correctly");const[n,r,i,a]=t;let o=655535;const s=eVe(n,r,i,a);return Object.keys(s).forEach(l=>{const[c,f]=s[l],u=Ll(c,f,e);u<o&&(o=u)}),o}function _U(t,e){let n=[0,0],r=Number.MAX_SAFE_INTEGER;return t.forEach(function(i){const a=nVe(e,i);a<r&&(r=a,n=[...i])}),n}function nVe(t,e){const[n,r]=t,[i,a]=e;return Math.sqrt(Math.pow(n-i,2)+Math.pow(r-a,2))}function rVe(t,e){const[n,r]=t,[i,a]=e,o=dr(it(),r,n),s=dr(it(),i,a),l=zt(o,s),c=Vo(o),f=Vo(s),u=l/(c*f);return Math.acos(u)*180/Math.PI}function iVe(t,e){const[n,r]=t,[i,a]=e,o=Vh(Kn(),r,n),s=Vh(Kn(),i,a),l=pf(o,s),c=D_(o),f=D_(s),u=l/(c*f);return Math.acos(u)*(180/Math.PI)}function mw(t,e){return t[0].length===3?rVe(t,e):iVe(t,e)}function Mu(t,e,n,r){const{canvasToWorld:i,worldToCanvas:a}=n,{data:o}=t,{targetWindingDirection:s}=e;let{points:l}=e,c=gw(l);r?.decimate?.enabled&&(l=$te(e.points,r?.decimate?.epsilon));let{closed:f}=e;const u=l.length,d=new Array(u);gw(l);const h=Hee(t);if(f===void 0){let p=!1;if(l.length>3){const g=d0(l[0],l[u-1]);p=pr(0,g)}f=p}if(r?.updateWindingDirection!==!1){let p=h?h.data.contour.windingDirection*-1:s;p===void 0&&(p=c),p!==c&&l.reverse();const g=(o.handles?.points??[]).map(a);g.length>2&&gw(g)!==p&&o.handles.points.reverse(),c=p}for(let p=0;p<u;p++)d[p]=i(l[p]);o.contour.polyline=d,o.contour.closed=f,o.contour.windingDirection=c,Kee(t)}const aVe="viewport-element";function oVe(t){const e=Xe(t),{viewportId:n,renderingEngineId:r}=e,i=`${n}:${r}`,a=sVe(t);return Object.keys(Dt.svgNodeCache[i]).forEach(o=>{Dt.svgNodeCache[i][o].touched=!1}),{svgLayerElement:a,svgNodeCacheForCanvas:Dt.svgNodeCache,getSvgNode:lVe.bind(this,i),appendNode:cVe.bind(this,a,i),setNodeTouched:uVe.bind(this,i),clearUntouched:fVe.bind(this,a,i)}}function sVe(t){const e=`.${aVe}`;return t.querySelector(e)?.querySelector(":scope > .svg-layer")}function lVe(t,e){if(Dt.svgNodeCache[t]&&Dt.svgNodeCache[t][e])return Dt.svgNodeCache[t][e].domRef}function cVe(t,e,n,r){if(!Dt.svgNodeCache[e])return null;Dt.svgNodeCache[e][r]={touched:!0,domRef:n},t.appendChild(n)}function uVe(t,e){Dt.svgNodeCache[t]&&Dt.svgNodeCache[t][e]&&(Dt.svgNodeCache[t][e].touched=!0)}function fVe(t,e){Dt.svgNodeCache[e]&&Object.keys(Dt.svgNodeCache[e]).forEach(n=>{const r=Dt.svgNodeCache[e][n];!r.touched&&r.domRef&&(t.removeChild(r.domRef),delete Dt.svgNodeCache[e][n])})}function dVe(t,e){const n=oVe(t);e(n),n.clearUntouched()}function v0(t,e,n){return`${t}::${e}::${n}`}function Cu(t,e){Object.keys(t).forEach(n=>{const r=e.getAttribute(n),i=t[n];i===void 0||i===""?e.removeAttribute(n):r!==i&&e.setAttribute(n,i)})}function tp(t,e){Object.keys(t).forEach(n=>{const r=t[n];r!==void 0&&r!==""&&e.setAttribute(n,r)})}function h0(t,e,n,r,i,a={},o=""){const{color:s,fill:l,width:c,lineWidth:f,lineDash:u,fillOpacity:d,strokeOpacity:h}=Object.assign({color:"rgb(0, 255, 0)",fill:"transparent",width:"2",lineDash:void 0,lineWidth:void 0,strokeOpacity:1,fillOpacity:1},a),p=f||c,g="http://www.w3.org/2000/svg",m=v0(e,"circle",n),y=t.getSvgNode(m),v={cx:`${r[0]}`,cy:`${r[1]}`,r:`${i}`,stroke:s,fill:l,"stroke-width":p,"stroke-dasharray":u,"fill-opacity":d,"stroke-opacity":h};if(y)Cu(v,y),t.setNodeTouched(m);else{const x=document.createElementNS(g,"circle");o!==""&&x.setAttribute("data-id",o),tp(v,x),t.appendNode(x,m)}}function hVe(t,e,n,r,i={},a=""){const{color:o,width:s,lineWidth:l,lineDash:c}=Object.assign({color:"rgb(0, 255, 0)",width:"2",lineWidth:void 0,lineDash:void 0},i),f=l||s,u="http://www.w3.org/2000/svg",d=v0(e,"ellipse",n),h=t.getSvgNode(d),[p,g,m,y]=r,v=Math.hypot(m[0]-y[0],m[1]-y[1]),x=Math.hypot(g[0]-p[0],g[1]-p[1]),w=Math.atan2(m[1]-y[1],m[0]-y[0])*180/Math.PI,S=[(m[0]+y[0])/2,(g[1]+p[1])/2],T=v/2,_=x/2,D={cx:`${S[0]}`,cy:`${S[1]}`,rx:`${T}`,ry:`${_}`,stroke:o,fill:"transparent",transform:`rotate(${w} ${S[0]} ${S[1]})`,"stroke-width":f,"stroke-dasharray":c};if(h)Cu(D,h),t.setNodeTouched(d);else{const I=document.createElementNS(u,"ellipse");a!==""&&I.setAttribute("data-id",a),tp(D,I),t.appendNode(I,d)}}function c9(t,e,n,r,i={},a){const{color:o,handleRadius:s,width:l,lineWidth:c,fill:f,type:u,opacity:d}=Object.assign({color:"rgb(0, 255, 0)",handleRadius:"6",width:"2",lineWidth:void 0,fill:"transparent",type:"circle",opacity:1},i),h=c||l,p="http://www.w3.org/2000/svg",g=v0(e,"handle",`hg-${n}-index-${a}`);let m;if(u==="circle")m={cx:`${r[0]}`,cy:`${r[1]}`,r:s,stroke:o,fill:f,"stroke-width":h,opacity:d};else if(u==="rect"){const x=parseFloat(s)*1.5,w=r[0]-x*.5,S=r[1]-x*.5;m={x:`${w}`,y:`${S}`,width:`${x}`,height:`${x}`,stroke:o,fill:f,"stroke-width":h,rx:`${x*.1}`,opacity:d}}else throw new Error(`Unsupported handle type: ${u}`);const y=t.getSvgNode(g);if(y)Cu(m,y),t.setNodeTouched(g);else{const v=document.createElementNS(p,u);tp(m,v),t.appendNode(v,g)}}function bo(t,e,n,r,i={}){r.forEach((a,o)=>{c9(t,e,n,a,i,o)})}function Va(t,e,n,r,i,a={},o=""){if(isNaN(r[0])||isNaN(r[1])||isNaN(i[0])||isNaN(i[1]))return;const{color:s="rgb(0, 255, 0)",width:l=10,lineWidth:c,lineDash:f,markerStartId:u=null,markerEndId:d=null,shadow:h=!1,strokeOpacity:p=1}=a,g=c||l,m="http://www.w3.org/2000/svg",y=v0(e,"line",n),v=t.getSvgNode(y),x=t.svgLayerElement.id,w=h?`filter:url(#shadow-${x});`:"",S={x1:`${r[0]}`,y1:`${r[1]}`,x2:`${i[0]}`,y2:`${i[1]}`,stroke:s,style:w,"stroke-width":g,"stroke-dasharray":f,"marker-start":u?`url(#${u})`:"","marker-end":d?`url(#${d})`:"","stroke-opacity":p};if(v)Cu(S,v),t.setNodeTouched(y);else{const T=document.createElementNS(m,"line");o!==""&&T.setAttribute("data-id",o),tp(S,T),t.appendNode(T,y)}}function Rf(t,e,n,r,i){if(r.length<2)return;const{color:a="rgb(0, 255, 0)",width:o=10,fillColor:s="none",fillOpacity:l=0,lineWidth:c,lineDash:f,closePath:u=!1,markerStartId:d=null,markerEndId:h=null}=i,p=c||o,g="http://www.w3.org/2000/svg",m=v0(e,"polyline",n),y=t.getSvgNode(m);let v="";for(const w of r)v+=`${w[0].toFixed(1)}, ${w[1].toFixed(1)} `;if(u){const w=r[0];v+=`${w[0]}, ${w[1]}`}const x={points:v,stroke:a,fill:s,"fill-opacity":l,"stroke-width":p,"stroke-dasharray":f,"marker-start":d?`url(#${d})`:"","marker-end":h?`url(#${h})`:""};if(y)Cu(x,y),t.setNodeTouched(m);else{const w=document.createElementNS(g,"polyline");tp(x,w),t.appendNode(w,m)}}function Dh(t,e,n,r,i){const o=r.length&&r[0].length&&Array.isArray(r[0][0])?r:[r],{color:s="rgb(0, 255, 0)",width:l=10,fillColor:c="none",fillOpacity:f=0,lineWidth:u,lineDash:d,closePath:h=!1}=i,p=u||l,g="http://www.w3.org/2000/svg",m=v0(e,"path",n),y=t.getSvgNode(m);let v="";for(let w=0,S=o.length;w<S;w++){const T=o[w],_=T.length;if(!(_<2)){for(let D=0;D<_;D++){const I=T[D];v+=`${D?"L":"M"} ${I[0].toFixed(1)}, ${I[1].toFixed(1)} `}h&&(v+="Z ")}}if(!v)return;const x={d:v,stroke:s,fill:c,"fill-opacity":f,"stroke-width":p,"stroke-dasharray":d};if(y)Cu(x,y),t.setNodeTouched(m);else{const w=document.createElementNS(g,"path");tp(x,w),t.appendNode(w,m)}}function sy(t,e,n,r,i,a={}){const o=Object.assign({fontFamily:"Helvetica, Arial, sans-serif",fontSize:"14px",color:"rgb(255, 255, 0)",background:"",padding:25,centerX:!1,centerY:!0},a);return pVe(t,e,n,r,i,o)}function pVe(t,e,n,r=[""],i,a){const{padding:o,color:s,fontFamily:l,fontSize:c,background:f}=a;let u;const[d,h]=[i[0]+o,i[1]+o],p="http://www.w3.org/2000/svg",g=v0(e,"text",n),m=t.getSvgNode(g);if(m){const y=m.querySelector("text"),v=Array.from(y.children);for(let S=0;S<v.length;S++){const T=v[S],_=r[S]||"";T.textContent=_}if(r.length>v.length){for(let S=0;S<r.length-v.length;S++){const T=r[S+v.length],_=DU(T);y.appendChild(_)}m.appendChild(y),t.appendNode(m,g)}const x={fill:s,"font-size":c,"font-family":l},w={transform:`translate(${d} ${h})`};Cu(x,y),Cu(w,m),m.setAttribute("data-annotation-uid",e),u=OU(m,f),t.setNodeTouched(g)}else{const y=document.createElementNS(p,"g");y.setAttribute("data-annotation-uid",e),y.setAttribute("transform",`translate(${d} ${h})`);const v=gVe(t,a);for(let x=0;x<r.length;x++){const w=r[x],S=DU(w);v.appendChild(S)}y.appendChild(v),t.appendNode(y,g),u=OU(y,f)}return Object.assign({},u,{x:d,y:h,height:u.height+o,width:u.width+o})}function gVe(t,e){const{color:n,fontFamily:r,fontSize:i}=e,o=document.createElementNS("http://www.w3.org/2000/svg","text"),s="user-select: none; pointer-events: none; -webkit-tap-highlight-color:  rgba(255, 255, 255, 0);",l=`filter:url(#shadow-${t.svgLayerElement.id});`,c=`${s}${l}`;return o.setAttribute("x","0"),o.setAttribute("y","0"),o.setAttribute("fill",n),o.setAttribute("font-family",r),o.setAttribute("font-size",i),o.setAttribute("style",c),o.setAttribute("pointer-events","visible"),o}function DU(t){const n=document.createElementNS("http://www.w3.org/2000/svg","tspan");return n.setAttribute("x","0"),n.setAttribute("dy","1.2em"),n.textContent=t,n}function OU(t,e){let n=t.querySelector("rect.background");if(!e)return n&&t.removeChild(n),t.getBBox();n||(n=document.createElementNS("http://www.w3.org/2000/svg","rect"),n.setAttribute("class","background"),t.insertBefore(n,t.firstChild));const r=t.getBBox(),i={x:`${r.x}`,y:`${r.y}`,width:`${r.width}`,height:`${r.height}`,fill:e};return Cu(i,n),r}function mVe(t,e,n,r,i,a,o={}){const s=r.length>0?_U(r,i):i,l=vVe(a),c=_U(l,s),f=Object.assign({color:"rgb(255, 255, 0)",lineWidth:"1",lineDash:"2,3"},o);Va(t,e,`link-${n}`,s,c,f)}function vVe(t){const{x:e,y:n,height:r,width:i}=t,a=i/2,o=r/2,s=[e+a,n],l=[e,n+o],c=[e+a,n+r],f=[e+i,n+o];return[s,l,c,f]}function cl(t,e,n,r,i,a,o,s={}){const l=Object.assign({handleRadius:"6",centering:{x:!1,y:!0}},s),c=sy(t,e,n,r,i,l);return mVe(t,e,n,a,i,c,l),c}function Wte(t,e,n,r,i={},a=""){const{color:o,width:s,lineWidth:l,lineDash:c}=Object.assign({color:"rgb(0, 255, 0)",width:"2",lineWidth:void 0,lineDash:void 0},i),f=l||s,u="http://www.w3.org/2000/svg",d=v0(e,"rect",n),h=t.getSvgNode(d),[p,g,m,y]=r,v=Math.hypot(p[0]-g[0],p[1]-g[1]),x=Math.hypot(p[0]-m[0],p[1]-m[1]),w=[(y[0]+p[0])/2,(y[1]+p[1])/2],S=[(m[0]+p[0])/2,(m[1]+p[1])/2],T=Math.atan2(w[1]-S[1],w[0]-S[0])*180/Math.PI,_={x:`${w[0]-v/2}`,y:`${w[1]-x/2}`,width:`${v}`,height:`${x}`,stroke:o,fill:"transparent",transform:`rotate(${T} ${w[0]} ${w[1]})`,"stroke-width":f,"stroke-dasharray":c};if(h)Cu(_,h),t.setNodeTouched(d);else{const D=document.createElementNS(u,"rect");a!==""&&D.setAttribute("data-id",a),tp(_,D),t.appendNode(D,d)}}function BO(t,e,n,r,i,a={},o=""){const s=[r[0],r[1]],l=[i[0],r[1]],c=[r[0],i[1]],f=[i[0],i[1]];Wte(t,e,n,[s,l,c,f],a,o)}const MU="http://www.w3.org/2000/svg";function IU(t,e,n,r,i,a={}){if(isNaN(r[0])||isNaN(r[1])||isNaN(i[0])||isNaN(i[1]))return;const{viaMarker:o=!1,color:s="rgb(0, 255, 0)",markerSize:l=10}=a;if(!o){yVe(t,e,n,r,i,a);return}const c=t.svgLayerElement.id,u=`${`arrow-${e}`}-${c}`,d=t.svgLayerElement.querySelector("defs");let h=d.querySelector(`#${u}`);if(h){h.setAttribute("markerWidth",`${l}`),h.setAttribute("markerHeight",`${l}`);const p=h.querySelector("path");p&&p.setAttribute("fill",s)}else{h=document.createElementNS(MU,"marker"),h.setAttribute("id",u),h.setAttribute("viewBox","0 0 10 10"),h.setAttribute("refX","8"),h.setAttribute("refY","5"),h.setAttribute("markerWidth",`${l}`),h.setAttribute("markerHeight",`${l}`),h.setAttribute("orient","auto");const p=document.createElementNS(MU,"path");p.setAttribute("d","M 0 0 L 10 5 L 0 10 z"),p.setAttribute("fill",s),h.appendChild(p),d.appendChild(h)}a.markerEndId=u,Va(t,e,n,r,i,a)}function yVe(t,e,n,r,i,a={}){const{color:o="rgb(0, 255, 0)",width:s=2,lineWidth:l,lineDash:c}=a,f=10,u=Math.atan2(i[1]-r[1],i[0]-r[0]),d={start:[i[0]-f*Math.cos(u-Math.PI/7),i[1]-f*Math.sin(u-Math.PI/7)],end:i},h={start:[i[0]-f*Math.cos(u+Math.PI/7),i[1]-f*Math.sin(u+Math.PI/7)],end:i};Va(t,e,n,r,i,{color:o,width:s,lineWidth:l,lineDash:c}),Va(t,e,"2",d.start,d.end,{color:o,width:s,lineWidth:l,lineDash:c}),Va(t,e,"3",h.start,h.end,{color:o,width:s,lineWidth:l,lineDash:c})}function xVe(t,e){const n=Xe(t),{renderingEngineId:r,viewportId:i}=n,a=to(i,r);if(!a)return[];const o=[],s=Object.keys(a.toolOptions);for(let l=0;l<s.length;l++){const c=s[l],f=a.toolOptions[c];if(f&&e.includes(f.mode)){const u=a.getToolInstance(c);o.push(u)}}return o}const{Active:bVe,Passive:wVe,Enabled:CVe}=br;class SVe{constructor(){this._needsRender=new Set,this._animationFrameSet=!1,this._animationFrameHandle=null,this._renderFlaggedViewports=()=>{this._throwIfDestroyed();const e=Array.from(this._viewportElements.values());for(let n=0;n<e.length;n++){const r=e[n];if(this._needsRender.has(r)&&(this._triggerRender(r),this._needsRender.delete(r),this._needsRender.size===0))break}this._animationFrameSet=!1,this._animationFrameHandle=null,this._render()},this._viewportElements=new Map}addViewportElement(e,n){this._viewportElements.set(e,n)}removeViewportElement(e,n){this._viewportElements.delete(e),this._needsRender.delete(n),this._reset()}renderViewport(e){this._setViewportsToBeRenderedNextFrame([e])}_throwIfDestroyed(){if(this.hasBeenDestroyed)throw new Error("this.destroy() has been manually called to free up memory, can not longer use this instance. Instead make a new one.")}_setAllViewportsToBeRenderedNextFrame(){[...this._viewportElements.values()].forEach(n=>{this._needsRender.add(n)}),this._renderFlaggedViewports()}_setViewportsToBeRenderedNextFrame(e){const n=[...this._viewportElements.values()];e.forEach(r=>{n.indexOf(r)!==-1&&this._needsRender.add(r)}),this._render()}_render(){this._needsRender.size>0&&this._animationFrameSet===!1&&(this._animationFrameHandle=window.requestAnimationFrame(this._renderFlaggedViewports),this._animationFrameSet=!0)}_triggerRender(e){const n=Xe(e);if(!n)return;if(!zf(n.renderingEngineId)){console.warn("rendering Engine has been destroyed");return}const i=xVe(e,[bVe,wVe,CVe]),{renderingEngineId:a,viewportId:o}=n,s={element:e,renderingEngineId:a,viewportId:o};dVe(e,l=>{let c=!1;const f=u=>{if(u.renderAnnotation){const d=u.renderAnnotation(n,l);c=c||d}};i.forEach(f),c&&wt(e,ee.ANNOTATION_RENDERED,{...s})})}_reset(){window.cancelAnimationFrame(this._animationFrameHandle),this._needsRender.clear(),this._animationFrameSet=!1,this._animationFrameHandle=null,this._setAllViewportsToBeRenderedNextFrame()}}const $O=new SVe;function Ky(t){$O.renderViewport(t)}function at(t){t.length&&t.forEach(e=>{const n=xr(e);if(!n){console.warn(`Viewport not available for ${e}`);return}const{viewport:r}=n;if(!r){console.warn(`Viewport not available for ${e}`);return}const i=r.element;Ky(i)})}function TVe(t,e){const n=t.length,r=[];for(let i=0;i<n;i++){const a=t[i];a.getFrameOfReferenceUID()===e&&r.push(a)}return r}const{Active:EVe,Passive:_Ve,Enabled:DVe}=br;function OVe(t,e){const n=t.length,r=[];for(let i=0;i<n;i++){const a=t[i],o=to(a.id,a.renderingEngineId);if(!o)continue;MVe(o,e)&&r.push(a)}return r}function MVe(t,e){const{toolOptions:n}=t,r=n[e];if(!r)return!1;const i=r.mode;return i===EVe||i===_Ve||i===DVe}function IVe(t,e,n=.999){return t.filter(r=>{const i=r.getCamera();return Math.abs(zt(i.viewPlaneNormal,e.viewPlaneNormal))>n})}function fn(t,e,n=!0){const r=Xe(t),{renderingEngine:i,FrameOfReferenceUID:a}=r;let o=i.getViewports();o=TVe(o,a),o=OVe(o,e);const s=i.getViewport(r.viewportId);return n&&(o=IVe(o,s.getCamera())),o.map(c=>c.id)}const B3="PlanarFreehandContourSegmentationTool";function GO(t,e){const n=t.length,r=new Array(n);for(let i=0;i<n;i++)r[i]=e.worldToCanvas(t[i]);return r}function RVe(t,e){return jy(e).map(n=>{const r=n,i=GO(r.data.contour.polyline,t);return{annotation:r,polyline:i}})}function Hte(t,e,n){Gy(e,n),c0(n);const{contour:r}=n.data,i=GO(r.polyline,t);Mu(n,{points:i,closed:r.closed,targetWindingDirection:e.data.contour.windingDirection===rs.Clockwise?rs.CounterClockwise:rs.Clockwise},t);const{element:a}=t;Kte(t,[e,n])}function PVe(t,e,n,r,i){if(!cS(B3)){console.warn(`${B3} is not registered in cornerstone. Cannot combine polylines.`);return}const a=i[0],o=Qo(n,a),s=RVe(t,e),l=new Set(s),c=new Map,f=(v,x)=>{let w=c.get(v);w||(w=[],c.set(v,w)),w.push(x),l.delete(x)},u=[];if(o){const v=UO(n,i);u.push(v),Array.from(l.keys()).forEach(x=>f(v,x))}else LO(n,i).forEach(x=>{u.push(x),Array.from(l.keys()).forEach(w=>{Wy(x,w.polyline)&&f(x,w)})});Array.from(c.values()).forEach(v=>v.forEach(x=>lS(x.annotation)));const{element:d}=t,{metadata:h,data:p}=e,{handles:g,segmentation:m}=p,{textBox:y}=g;_r(r.annotationUID),_r(e.annotationUID),c0(r),c0(e);for(let v=0;v<u.length;v++){const x=u[v];if(!x||x.length<3){console.warn("Skipping creation of new annotation due to invalid polyline:",x);continue}const w=AVe(t,e,x);mr(w,d),u0(w),Un(w,t.element),c.get(x)?.forEach(S=>Gy(w,S.annotation))}Kte(t,[e,r])}function AVe(t,e,n){const r=t.canvasToWorld(n[0]),i=t.canvasToWorld(n[n.length-1]),a={metadata:{...e.metadata,toolName:B3,originalToolName:e.metadata.originalToolName||e.metadata.toolName},data:{cachedStats:{},handles:{points:[r,i],textBox:e.data.handles.textBox?{...e.data.handles.textBox}:void 0},contour:{polyline:[],closed:!0},spline:e.data.spline,segmentation:{...e.data.segmentation}},annotationUID:cr(),highlighted:!0,invalidated:!0,isLocked:!1,isVisible:void 0,interpolationUID:e.interpolationUID,interpolationCompleted:e.interpolationCompleted};return Mu(a,{points:n,closed:!0,targetWindingDirection:rs.Clockwise},t),a}function Kte(t,e){const{element:n}=t,r=new Set([B3]);e.forEach(i=>{r.add(i.metadata.toolName)});for(const i of r.values())if(cS(i)){const a=fn(n,i);at(a)}}function vS(t){return!!t.data?.segmentation}function NVe(t,e,n){const r=[],i=xm(e);for(let a=0;a<n.length;a++){const o=n[a],s=LVe(o.data.contour.polyline,t),l=xm(s);if(!Ake(i,l))continue;const f=FO(e,s),u=!f&&Wy(s,e);(f||u)&&r.push({targetAnnotation:o,targetPolyline:s,isContourHole:u})}return r}function LVe(t,e){const n=t.length,r=new Array(n);for(let i=0;i<n;i++)r[i]=e.worldToCanvas(t[i]);return r}const $3="PlanarFreehandContourSegmentationTool";function kVe(t,e,n,r){const i=r.filter(o=>o.isContourHole),a=r.filter(o=>!o.isContourHole);if(i.length>0){const o=i[0];$Ve(t,o.targetAnnotation,e),qte(t,[e,o.targetAnnotation]);return}if(a.length!==0){if(!cS($3)){console.warn(`${$3} is not registered in cornerstone. Cannot process multiple intersections.`);return}VVe(t,e,n,a)}}function VVe(t,e,n,r){const{element:i}=t,a=[e],o=[],s=[];r.forEach(({targetAnnotation:d})=>{const h=BVe(t,d);s.push(...h),a.push(d)});const l=n[0];if(r.some(({targetPolyline:d})=>Qo(d,l))){let d=n;r.forEach(({targetPolyline:h})=>{d=UO(d,h)}),o.push(d)}else r.forEach(({targetPolyline:d})=>{const h=LO(d,n);o.push(...h)});a.forEach(d=>{_r(d.annotationUID),c0(d)}),s.forEach(d=>lS(d.annotation));const f=r[0].targetAnnotation,u=[];o.forEach(d=>{if(!d||d.length<3){console.warn("Skipping creation of new annotation due to invalid polyline:",d);return}const h=FVe(t,f,d);mr(h,i),u0(h),Un(h,t.element),u.push(h)}),UVe(t,s,u),qte(t,a)}function FVe(t,e,n){const r=t.canvasToWorld(n[0]),i=t.canvasToWorld(n[n.length-1]),a={metadata:{...e.metadata,toolName:$3,originalToolName:e.metadata.originalToolName||e.metadata.toolName},data:{cachedStats:{},handles:{points:[r,i],textBox:e.data.handles.textBox?{...e.data.handles.textBox}:void 0},contour:{polyline:[],closed:!0},spline:e.data.spline,segmentation:{...e.data.segmentation}},annotationUID:cr(),highlighted:!0,invalidated:!0,isLocked:!1,isVisible:void 0,interpolationUID:e.interpolationUID,interpolationCompleted:e.interpolationCompleted};return Mu(a,{points:n,closed:!0,targetWindingDirection:rs.Clockwise},t),a}function UVe(t,e,n){e.forEach(r=>{const i=n.find(a=>{const o=jO(a.data.contour.polyline,t);return Wy(o,r.polyline)});i&&Gy(i,r.annotation)})}function BVe(t,e){return jy(e).map(n=>{const r=n,i=jO(r.data.contour.polyline,t);return{annotation:r,polyline:i}})}function $Ve(t,e,n){Gy(e,n),c0(n);const{contour:r}=n.data,i=jO(r.polyline,t);Mu(n,{points:i,closed:r.closed,targetWindingDirection:e.data.contour.windingDirection===rs.Clockwise?rs.CounterClockwise:rs.Clockwise},t)}function jO(t,e){const n=t.length,r=new Array(n);for(let i=0;i<n;i++)r[i]=e.worldToCanvas(t[i]);return r}function qte(t,e){const{element:n}=t,r=new Set([$3]);e.forEach(i=>{r.add(i.metadata.toolName)});for(const i of r.values())if(cS(i)){const a=fn(n,i);at(a)}}const{isEqual:RU}=Yr;function Xte(t){const{metadata:e}=t;return ree().filter(n=>{if(n.FrameOfReferenceUID===e.FrameOfReferenceUID){const r=n.viewport,{viewPlaneNormal:i,viewUp:a}=r.getCamera();return RU(i,e.viewPlaneNormal)&&(!e.viewUp||RU(a,e.viewUp))}}).map(n=>n.viewport)}function GVe(t){if(!t)throw new Error(`No contours found for geometryId ${t.id}`);const e=t.id;if(t.type!==lu.CONTOUR)throw new Error(`Geometry type ${t.type} not supported for rendering.`);if(!t.data){console.warn(`No contours found for geometryId ${e}. Skipping render.`);return}}function jVe(t,e,n,r){n.size?t.render():zVe(t,e,r)}function zVe(t,e,n){const{segmentationId:r}=n,i=new Map;e.forEach(a=>{const o=yt.getGeometry(a);if(!o){console.warn(`No geometry found for geometryId ${a}. Skipping render.`);return}const s=o.data.segmentIndex;GVe(o);const l=nm.getStyle({viewportId:t.id,segmentationId:r,type:hn.Contour,segmentIndex:s}),c=o.data,f=t.getCamera().viewPlaneNormal;c.contours.forEach(u=>{const{points:d,color:h,id:p}=u,g=cke(t,d[0],f),m={annotationUID:cr(),data:{contour:{closed:!0,polyline:d},segmentation:{segmentationId:r,segmentIndex:s,color:h,id:p},handles:{}},handles:{},highlighted:!1,autoGenerated:!1,invalidated:!1,isLocked:!0,isVisible:!0,metadata:{referencedImageId:g,toolName:"PlanarFreehandContourSegmentationTool",FrameOfReferenceUID:t.getFrameOfReferenceUID(),viewPlaneNormal:t.getCamera().viewPlaneNormal}},y=t.element;mr(m,y),u0(m)}),l&&i.set(s,l)}),t.render()}function WVe(t,e,n=!1){const r=ea(e),{annotationUIDsMap:i}=r.representationData.Contour;i.forEach(a=>{a.forEach(o=>{_r(o)})})}function HVe(t){const e=ULe(t);if(e)return e;const n=ea(t);if(!n)throw new Error(`No segmentation found for segmentationId ${t}`);let r;if(n.representationData.Labelmap)r=KVe(n,t);else if(n.representationData.Contour)r=YVe(n);else if(n.representationData.Surface)r=JVe(n);else throw new Error(`Unsupported segmentation type: ${n.representationData}`);return BLe(t,r),r}function KVe(t,e){const n=t.representationData[hn.Labelmap],r=new Set;return n.imageIds?XVe(r,n.imageIds):qVe(r,e),Array.from(r).map(Number).sort((i,a)=>i-a)}function qVe(t,e){yt.getVolume(e).voxelManager.forEach(({value:r})=>{r!==0&&t.add(r)})}function XVe(t,e){e.forEach(n=>{yt.getImage(n).voxelManager.getScalarData().forEach(a=>{a!==0&&t.add(a)})})}function YVe(t){const{annotationUIDsMap:e,geometryIds:n}=t.representationData.Contour||{};if(!n)throw new Error(`No geometryIds found for segmentationId ${t.segmentationId}`);const r=new Set([...e.keys()]);return n.forEach(i=>{const a=yt.getGeometry(i);r.add(a.data.segmentIndex)}),Array.from(r).sort((i,a)=>i-a)}function JVe(t){const e=t.representationData.Surface?.geometryIds??[];return Array.from(e.keys()).map(Number).sort((n,r)=>n-r)}const Kp=new Map,PU=new Map;function ZVe(t,e,n=!1){const r=xr(t);if(!r)return;const{viewport:i}=r;WVe(t,e),n&&i.render()}async function QVe(t,e){const{segmentationId:n}=e,r=ea(n);if(!r)return;let i=r.representationData[hn.Contour];const a=If();if(!i&&If()?.canComputeRequestedRepresentation(n,hn.Contour)&&!Kp.get(t.id)?(Kp.set(t.id,!0),i=await PO(n,hn.Contour,()=>a.computeContourData(n,{viewport:t}),()=>{}),Kp.set(t.id,!1)):!i&&!If()&&console.debug(`No contour data found for segmentationId ${n} and PolySeg add-on is not configured. Unable to convert from other representations to contour. Please register PolySeg using cornerstoneTools.init({ addons: { polySeg } }) to enable automatic conversion.`),!i||!i.geometryIds?.length)return;let o=!1;const s=t.getCamera().viewPlaneNormal;i.annotationUIDsMap&&(o=!tFe(i.annotationUIDsMap,s)),i.geometryIds.length>0&&(o=!eFe(i.geometryIds,s));const l=PU.get(t.id)||new Set;if(o&&!Kp.get(t.id)&&!l.has(n)&&t.viewportStatus===Io.RENDERED){Kp.set(t.id,!0);const c=HVe(n),u=(await a.computeSurfaceData(n,{segmentIndices:c,viewport:t})).geometryIds,d=[];for(const m of u.values()){const v=yt.getGeometry(m).data;d.push({points:v.points,polys:v.polys,segmentIndex:v.segmentIndex,id:v.segmentIndex})}const h=await a.clipAndCacheSurfacesForViewport(d,t),p=a.extractContourData(h),g=a.createAndAddContourSegmentationsFromClippedSurfaces(p,t,n);i.annotationUIDsMap=new Map([...i.annotationUIDsMap,...g]),l.add(n),PU.set(t.id,l),Kp.set(t.id,!1)}jVe(t,i.geometryIds,i.annotationUIDsMap,e)}function eFe(t,e){let n=null,r=null;for(const u of t){const d=yt.getGeometry(u);if(!d)continue;const h=d.data;if(h.contours?.[0]?.points?.length>=3){n=d,r=h;break}}if(!n||!r)return!1;const a=r.contours[0].points,o=a[0],s=a[1],l=a[2];let c=gr(it(),dr(it(),s,o),dr(it(),l,o));c=Lr(it(),c);const f=zt(c,e);return Math.abs(f)>.9}function tFe(t,e){const n=Array.from(t.values()).flat().map(i=>Array.from(i)).flat(),r=vO(n,3);for(const i of r){const a=vo(i);if(a?.metadata){if(!a.metadata.viewPlaneNormal)continue;const o=a.metadata.viewPlaneNormal,s=Math.abs(e[0]*o[0]+e[1]*o[1]+e[2]*o[2]);if(Math.abs(s-1)>.01)return!1}}return!0}const nFe={render:QVe,removeRepresentation:ZVe};function yS(t,e){return bm(t,e)[0]}function bm(t,e){return Ps.getCurrentLabelmapImageIdsForViewport(t,e)}const AU=new Map,rFe=({cfun:t,ofun:e,actor:n})=>{n.getProperty().setRGBTransferFunction(1,t),n.getProperty().setScalarOpacity(1,e)};async function iFe({viewport:t,volumeInputs:e,segmentationId:n}){const r=t.getDefaultActor(),{actor:i}=r,{uid:a,callback:o}=r,s=t.getVolumeId();if(AU.get(a)?.added)return{uid:a,actor:i};const l=e,c=yt.getVolume(l[0].volumeId);if(!c)throw new Error(`imageVolume with id: ${c.volumeId} does not exist`);const{volumeId:f}=l[0],u=await X7(f);if(!u)throw new Error(`segImageVolume with id: ${u.volumeId} does not exist`);const h=u.voxelManager.getCompleteScalarDataArray(),{imageData:p}=u,g=yt.getVolume(s),y=g.voxelManager.getCompleteScalarDataArray(),v=2,x=new Float32Array(v*g.voxelManager.getScalarDataLength()),w=p.getDimensions();for(let I=0;I<w[2];++I)for(let R=0;R<w[1];++R)for(let O=0;O<w[0];++O){const P=O+w[0]*(R+w[1]*I);x[P*v+0]=y[P],x[P*v+1]=h[P]}t.removeActors([a]);const S=i.getMapper(),T=ZZ(S);i.setMapper(T),T.setBlendMode(Kd.LABELMAP_EDGE_PROJECTION_BLEND);const _=T.getInputData().getPointData().getArray(0);_.setData(x),_.setNumberOfComponents(2),i.getProperty().setColorMixPreset(1),i.getProperty().setForceNearestInterpolation(1,!0),i.getProperty().setIndependentComponents(!0),t.addActor({actor:i,uid:a,callback:o,referencedId:s,representationUID:`${n}-${hn.Labelmap}`}),AU.set(a,{added:!0,segmentationRepresentationUID:`${n}`,originalBlendMode:t.getBlendMode()}),i.set({preLoad:rFe});function D(I){const{segmentationId:R}=I.detail,{representationData:O}=ea(R),{volumeId:P}=O.Labelmap;if(P!==u.volumeId)return;const A=yt.getVolume(P).voxelManager,B=T.getInputData(),V=B.getPointData().getArray(0),$=V.getData(),U=2,G=p.getDimensions(),F=Array.from({length:G[2]},(J,Q)=>Q);for(const J of F)for(let Q=0;Q<G[1];++Q)for(let ne=0;ne<G[0];++ne){const ye=ne+G[0]*(Q+G[1]*J);$[ye*U+1]=A.getAtIndex(ye)}V.setData($),B.modified(),t.render()}return vt.addEventListenerDebounced(ee.SEGMENTATION_DATA_MODIFIED,D,200),vt.addEventListener(ee.SEGMENTATION_REPRESENTATION_REMOVED,async I=>{vt.removeEventListener(ee.SEGMENTATION_DATA_MODIFIED,D);const R=t.getActor(a),{element:O,id:P}=t;t.removeActors([a]);const N=await y3({volumeId:a,blendMode:Kd.MAXIMUM_INTENSITY_BLEND,callback:({volumeActor:A})=>{R.callback&&R.callback({volumeActor:A,volumeId:f})}},O,P);t.addActor({actor:N,uid:a}),t.render()}),{uid:a,actor:i}}const{uuidv4:Yte}=Yr;async function aFe(t,e,n,r){const i=Xe(t),{renderingEngine:a,viewport:o}=i,{id:s}=o,l=!0,c=!1,f=!0;if(o instanceof mo){const d=oFe(e,n);yt.getVolume(d)||await sFe(e);let h=r?.blendMode??Kd.MAXIMUM_INTENSITY_BLEND,p=h===Kd.LABELMAP_EDGE_PROJECTION_BLEND;if(p){const m=o.getVolumeId(),y=yt.getVolume(m),x=yt.getVolume(d).dimensions,w=y.dimensions;(x[0]!==w[0]||x[1]!==w[1]||x[2]!==w[2])&&(p=!1,h=Kd.MAXIMUM_INTENSITY_BLEND,console.debug("Dimensions mismatch - falling back to regular volume addition"))}const g=[{volumeId:d,visibility:l,representationUID:`${n}-${hn.Labelmap}`,useIndependentComponents:p,blendMode:h}];if(!g[0].useIndependentComponents)await TQ(a,g,[s],c,f);else return await iFe({viewport:o,volumeInputs:g,segmentationId:n})}else{const d=bm(o.id,n).map(h=>({imageId:h,representationUID:`${n}-${hn.Labelmap}-${h}`}));EQ(a,d,[s])}Wf(n)}function oFe(t,e){let{volumeId:n}=t;if(!n){n=Yte();const r=ea(e);r.representationData.Labelmap={...r.representationData.Labelmap,volumeId:n},t.volumeId=n,t1(e)}return n}async function sFe(t){const e=t;if(!(e.imageIds.length>0))throw new Error("cannot create labelmap, no imageIds found for the volume labelmap");return await qZ(t.volumeId||Yte(),e.imageIds)}function lFe(t,e){const n=Xe(t),{viewport:r}=n;r.removeActors([ZLe(r.id,e)])}function ly(t){return Ps.getActiveSegmentation(t)}function xS(t){return ly(t)}function Su(t){const e=ea(t);if(e){const n=Object.keys(e.segments).find(r=>e.segments[r].active);return n?Number(n):void 0}}const P8=255,d2=new Map;let A8=!1;function cFe(t,e,n=!1){const r=xr(t);if(d2.forEach((a,o)=>{o.includes(e)&&d2.delete(o)}),!r)return;const{viewport:i}=r;lFe(i.element,e),n&&i.render()}async function uFe(t,e){const{segmentationId:n,config:r}=e,i=ea(n);if(!i){console.warn("No segmentation found for segmentationId: ",n);return}let a=i.representationData[hn.Labelmap],o=u2(t.id,n);if(!a&&If()?.canComputeRequestedRepresentation(n,hn.Labelmap)&&!A8){A8=!0;const s=If();if(a=await PO(n,hn.Labelmap,()=>s.computeLabelmapData(n,{viewport:t}),()=>null,()=>{Ps.processLabelmapRepresentationAddition(t.id,n),setTimeout(()=>{Wf(n)},0)}),!a)throw new Error(`No labelmap data found for segmentationId ${n}.`);A8=!1}else!a&&!If()&&console.debug(`No labelmap data found for segmentationId ${n} and PolySeg add-on is not configured. Unable to convert from other representations to labelmap. Please register PolySeg using cornerstoneTools.init({ addons: { polySeg } }) to enable automatic conversion.`);if(a){if(t instanceof da)o?.length||await LU(t,a,n,r),o=u2(t.id,n);else{if(!bm(t.id,n)?.length)return;o||await LU(t,a,n,r),o=u2(t.id,n)}if(o?.length)for(const s of o)fFe(t.id,s,e)}}function fFe(t,e,n){const{segmentationId:r}=n,{cfun:i,ofun:a}=n.config,{colorLUTIndex:o}=n,l=xS(t)?.segmentationId===r,c=nm.getStyle({viewportId:t,type:hn.Labelmap,segmentationId:r}),f=nm.getRenderInactiveSegmentations(t),u=RO(o),d=Math.min(256,u.length),{outlineWidth:h,renderOutline:p,outlineOpacity:g,activeSegmentOutlineWidthDelta:m}=NU(c,l),y=AO(t,{segmentationId:r,type:hn.Labelmap});for(let S=0;S<d;S++){const T=S,_=u[T],I=nm.getStyle({viewportId:t,type:hn.Labelmap,segmentationId:r,segmentIndex:T}),{fillAlpha:R,outlineWidth:O,renderFill:P,renderOutline:N}=NU(c,l,I),{forceOpacityUpdate:A,forceColorUpdate:B}=dFe(t,r,T,{fillAlpha:R,renderFill:P,renderOutline:N,segmentColor:_,outlineWidth:O,segmentsHidden:y,cfun:i,ofun:a});if(B&&i.addRGBPoint(T,_[0]/P8,_[1]/P8,_[2]/P8),A)if(P){const V=y.has(T)?0:_[3]/255*R;a.removePoint(T),a.addPointLong(T,V,.5,1)}else a.addPointLong(T,.01,.5,1)}a.setClamping(!1);const v=e.actor,{preLoad:x}=v.get?.("preLoad")||{preLoad:null};if(x?x({cfun:i,ofun:a,actor:v}):(v.getProperty().setRGBTransferFunction(0,i),v.getProperty().setScalarOpacity(0,a),v.getProperty().setInterpolationTypeToNearest()),p){v.getProperty().setUseLabelOutline(p),v.getProperty().setLabelOutlineOpacity(g);const S=Su(n.segmentationId),T=new Array(d-1);for(let _=1;_<d;_++){if(y.has(_)){T[_-1]=0;continue}T[_-1]=_===S?h+m:h}v.getProperty().setLabelOutlineThickness(T),v.modified(),v.getProperty().modified(),v.getMapper().modified()}else v.getProperty().setLabelOutlineThickness(new Array(d-1).fill(0));const w=l||f;v.setVisibility(w)}function NU(t,e,n){const i={...t,...n||{}},a=e?i.fillAlpha:i.fillAlphaInactive,o=e?i.outlineWidth:i.outlineWidthInactive,s=e?i.renderFill:i.renderFillInactive,l=e?i.renderOutline:i.renderOutlineInactive,c=e?i.outlineOpacity:i.outlineOpacityInactive,f=i.activeSegmentOutlineWidthDelta;return{fillAlpha:a,outlineWidth:o,renderFill:s,renderOutline:l,outlineOpacity:c,activeSegmentOutlineWidthDelta:f}}function dFe(t,e,n,{fillAlpha:r,renderFill:i,renderOutline:a,segmentColor:o,outlineWidth:s,segmentsHidden:l,cfun:c,ofun:f}){const u=`${t}-${e}-${n}`,d=d2.get(u);if(!d)return d2.set(u,{fillAlpha:r,renderFill:i,renderOutline:a,outlineWidth:s,segmentColor:o.slice(),segmentsHidden:new Set(l),cfunMTime:c.getMTime(),ofunMTime:f.getMTime()}),{forceOpacityUpdate:!0,forceColorUpdate:!0};const{fillAlpha:h,renderFill:p,renderOutline:g,outlineWidth:m,segmentColor:y,segmentsHidden:v,cfunMTime:x,ofunMTime:w}=d,S=y[0]!==o[0]||y[1]!==o[1]||y[2]!==o[2],T=y[3]!==o[3]||h!==r||p!==i||g!==a||m!==s||v!==l;return(T||S)&&d2.set(u,{fillAlpha:r,renderFill:i,renderOutline:a,outlineWidth:s,segmentColor:o.slice(),segmentsHidden:new Set(l),cfunMTime:c.getMTime(),ofunMTime:f.getMTime()}),{forceOpacityUpdate:T,forceColorUpdate:S}}async function LU(t,e,n,r){return await aFe(t.element,e,n,r)||void 0}const hFe={render:uFe,removeRepresentation:cFe},{DefaultHistoryMemo:qp}=mO,y2=class y2{constructor(e,n){const r=y2.mergeDefaultProps(y2.defaults,n),i=No(r,e),{configuration:a={},supportedInteractionTypes:o,toolGroupId:s}=i;this.toolGroupId=s,this.supportedInteractionTypes=o||[],this.configuration=Object.assign({},a),this.mode=br.Disabled}static mergeDefaultProps(e={},n){return n?No(e,n):e}get toolName(){return this.getToolName()}getToolName(){return this.constructor.toolName}applyActiveStrategy(e,n){const{strategies:r,activeStrategy:i}=this.configuration;return r[i]?.call(this,e,n)}applyActiveStrategyCallback(e,n,r,...i){const{strategies:a,activeStrategy:o}=this.configuration;if(!a[o])throw new Error(`applyActiveStrategyCallback: active strategy ${o} not found, check tool configuration or spellings`);return a[o][r]?.call(this,e,n,...i)}setConfiguration(e){this.configuration=No(this.configuration,e)}setActiveStrategy(e){this.setConfiguration({activeStrategy:e})}getTargetImageData(e){if(e.startsWith("imageId:")){const n=e.split("imageId:")[1],r=Ci(n);let i=E3(r);return!i||!i.length||(i=i.filter(a=>a.getCurrentImageId()===n),!i||!i.length)?void 0:i[0].getImageData()}else if(e.startsWith("volumeId:")){const n=m0(e),r=JC(n);return!r||!r.length?void 0:r[0].getImageData()}else if(e.startsWith("videoId:")){const n=Ci(e),r=E3(n);return!r||!r.length?void 0:r[0].getImageData()}else throw new Error('getTargetIdImage: targetId must start with "imageId:" or "volumeId:"')}getTargetId(e){const n=e.getViewReferenceId?.();if(n)return n;throw new Error("getTargetId: viewport must have a getViewReferenceId method")}undo(){this.doneEditMemo(),qp.undo()}redo(){qp.redo()}static createZoomPanMemo(e){const n={pan:e.getPan(),zoom:e.getZoom()},r={restoreMemo:()=>{const i=e.getPan(),a=e.getZoom();e.setZoom(n.zoom),e.setPan(n.pan),e.render(),n.pan=i,n.zoom=a}};return qp.push(r),r}doneEditMemo(){this.memo?.commitMemo?.()&&qp.push(this.memo),this.memo=null}static startGroupRecording(){qp.startGroupRecording()}static endGroupRecording(){qp.endGroupRecording()}};y2.defaults={configuration:{strategies:{},defaultStrategy:void 0,activeStrategy:void 0,strategyOptions:{}}};let $f=y2;$f.toolName="BaseTool";const{isEqual:N8}=Yr,{EPSILON:pFe}=Xh,gFe=1-pFe;function mFe(t,e,n){const{viewPlaneNormal:r}=e,i=t.filter(l=>{const{planeRestriction:c,referencedImageId:f}=l.metadata;let{viewPlaneNormal:u}=l.metadata;if(c){const{inPlaneVector1:h,inPlaneVector2:p}=c;return!(h&&!N8(0,zt(r,h))||p&&!N8(0,zt(r,p)))}if(!l.metadata.referencedImageId&&!u&&l.metadata.FrameOfReferenceUID){for(const h of l.data.handles.points){const p=dr(it(),h,e.focalPoint),g=zt(p,r);if(!N8(g,0))return!1}return l.metadata.viewPlaneNormal=r,l.metadata.cameraFocalPoint=e.focalPoint,!0}if(!u&&f){const{imageOrientationPatient:h}=Ut("imagePlaneModule",f),p=Sn(h[0],h[1],h[2]),g=Sn(h[3],h[4],h[5]);u=it(),gr(u,p,g),l.metadata.viewPlaneNormal=u}const d=Math.abs(zt(r,u))>gFe;return u&&d});if(!i.length)return[];const a=n/2,{focalPoint:o}=e,s=[];for(const l of i){const c=l.data,f=c.handles.points[0]||c.contour?.polyline[0];if(!l.isVisible)continue;const u=it();if(!f){s.push(l);continue}dr(u,o,f);const d=zt(u,r);Math.abs(d)<a&&s.push(l)}return s}function zO(t,e,n={}){if(t instanceof da){const r=t.getCamera(),{spacingInNormalDirection:i}=Vy(t,r);return mFe(e,r,i)}if(t instanceof fa){const r=t.getCurrentImageId();if(!r)return[];const i=r.indexOf(":");n.imageURI=r.substring(i+1)}return e.filter(r=>r.isVisible?r.data.isCanvasAnnotation?!0:t.isReferenceViewable(r.metadata,n):!1)}function vFe(t){if(t){if(t.data&&t.highlighted)return xf.Highlighted;if(pS(t.annotationUID))return xf.Selected;if(yo(t.annotationUID))return xf.Locked;if(t.data&&t.autoGenerated)return xf.AutoGenerated}return xf.Default}class WO extends $f{constructor(){super(...arguments),this.onImageSpacingCalibrated=e=>{const{element:n,imageId:r}=e.detail,i=Ci(r),a=Ou();a.getFramesOfReference().forEach(s=>{const c=a.getAnnotations(s)[this.getToolName()];!c||!c.length||(c.forEach(f=>{if(!f.metadata?.referencedImageId)return;Ci(f.metadata.referencedImageId)===i&&(f.invalidated=!0,f.data.cachedStats={})}),Ky(n))})}}filterInteractableAnnotationsForElement(e,n){if(!n?.length)return[];const r=Xe(e),{viewport:i}=r;return zO(i,n)}createAnnotation(e){const n=e.detail,{currentPoints:r,element:i}=n,{world:a}=r,o=Xe(i),{viewport:s}=o,l=s.getCamera(),{viewPlaneNormal:c,viewUp:f,position:u}=l,d=this.getReferencedImageId(s,a,c,f),h=s.getViewReference({points:[a]});return{highlighted:!0,invalidated:!0,metadata:{toolName:this.getToolName(),...h,referencedImageId:d,viewUp:f,cameraPosition:u},data:{cachedStats:{},handles:{points:[],activeHandleIndex:null,textBox:{hasMoved:!1,worldPosition:[0,0,0],worldBoundingBox:{topLeft:[0,0,0],topRight:[0,0,0],bottomLeft:[0,0,0],bottomRight:[0,0,0]}}}}}}getReferencedImageId(e,n,r,i){const a=this.getTargetId(e);let o=a.split(/^[a-zA-Z]+:/)[1];if(e instanceof mo){const s=m0(a),l=yt.getVolume(s);o=$h(l,n,r)}return o}getStyle(e,n,r){return Bee(e,n,vFe(r),this.mode)}}WO.toolName="AnnotationDisplayTool";const{DefaultHistoryMemo:yFe}=mO,{PointsManager:xFe}=Yr;class la extends WO{static createAnnotation(...e){let n={annotationUID:null,highlighted:!0,invalidated:!0,metadata:{toolName:this.toolName},data:{text:"",handles:{points:new Array,textBox:{hasMoved:!1,worldPosition:[0,0,0],worldBoundingBox:{topLeft:[0,0,0],topRight:[0,0,0],bottomLeft:[0,0,0],bottomRight:[0,0,0]}}},label:""}};for(const r of e)n=No(n,r);return n}static createAnnotationForViewport(e,...n){return this.createAnnotation({metadata:e.getViewReference()},...n)}static createAndAddAnnotation(e,...n){const r=this.createAnnotationForViewport(e,...n);mr(r,e.element),Un(r,e.element)}constructor(e,n){super(e,n),this.mouseMoveCallback=(r,i)=>{if(!i)return!1;const{element:a,currentPoints:o}=r.detail,s=o.canvas;let l=!1;for(const c of i){if(yo(c.annotationUID)||!xo(c.annotationUID))continue;const{data:f}=c,u=f.handles?f.handles.activeHandleIndex:void 0,d=this._imagePointNearToolOrHandle(a,c,s,6),h=d&&!c.highlighted,p=!d&&c.highlighted;h||p?(c.highlighted=!c.highlighted,l=!0):f.handles&&f.handles.activeHandleIndex!==u&&(l=!0)}return l},this.isSuvScaled=la.isSuvScaled,e.configuration?.getTextLines&&(this.configuration.getTextLines=e.configuration.getTextLines),e.configuration?.statsCalculator&&(this.configuration.statsCalculator=e.configuration.statsCalculator)}getHandleNearImagePoint(e,n,r,i){const a=Xe(e),{viewport:o}=a,{data:s}=n,{isCanvasAnnotation:l}=s,{points:c,textBox:f}=s.handles;if(f){const{worldBoundingBox:u}=f;if(u){const d={topLeft:o.worldToCanvas(u.topLeft),topRight:o.worldToCanvas(u.topRight),bottomLeft:o.worldToCanvas(u.bottomLeft),bottomRight:o.worldToCanvas(u.bottomRight)};if(r[0]>=d.topLeft[0]&&r[0]<=d.bottomRight[0]&&r[1]>=d.topLeft[1]&&r[1]<=d.bottomRight[1])return s.handles.activeHandleIndex=null,f}}for(let u=0;u<c?.length;u++){const d=c[u],h=l?d.slice(0,2):o.worldToCanvas(d);if(ii(r,h)<i===!0)return s.handles.activeHandleIndex=u,d}s.handles.activeHandleIndex=null}getLinkedTextBoxStyle(e,n){return{visibility:this.getStyle("textBoxVisibility",e,n),fontFamily:this.getStyle("textBoxFontFamily",e,n),fontSize:this.getStyle("textBoxFontSize",e,n),color:this.getStyle("textBoxColor",e,n),shadow:this.getStyle("textBoxShadow",e,n),background:this.getStyle("textBoxBackground",e,n),lineWidth:this.getStyle("textBoxLinkLineWidth",e,n),lineDash:this.getStyle("textBoxLinkLineDash",e,n)}}static isSuvScaled(e,n,r){if(e instanceof mo){const a=m0(n);return yt.getVolume(a)?.scaling?.PT!==void 0}return typeof(r&&Ut("scalingModule",r))?.suvbw=="number"}getAnnotationStyle(e){const{annotation:n,styleSpecifier:r}=e,i=g=>this.getStyle(g,r,n),{annotationUID:a}=n,o=xo(a),s=yo(a),l=i("lineWidth"),c=i("lineDash"),f=i("angleArcLineDash"),u=i("color"),d=i("markerSize"),h=i("shadow"),p=this.getLinkedTextBoxStyle(r,n);return{visibility:o,locked:s,color:u,lineWidth:l,lineDash:c,lineOpacity:1,fillColor:u,fillOpacity:0,shadow:h,textbox:p,markerSize:d,angleArcLineDash:f}}_imagePointNearToolOrHandle(e,n,r,i){if(this.getHandleNearImagePoint(e,n,r,i)||this.isPointNearTool(e,n,r,i,"mouse"))return!0}static createAnnotationState(e,n){const{data:r,annotationUID:i}=e,a={...r,cachedStats:{}};delete a.contour,delete a.spline;const o={annotationUID:i,data:structuredClone(a),deleting:n},s=r.contour;return s&&(o.data.contour={...s,polyline:null,pointsManager:xFe.create3(s.polyline.length,s.polyline)}),o}static createAnnotationMemo(e,n,r){if(!n)return;const{newAnnotation:i,deleting:a=i?!1:void 0}=r||{},{annotationUID:o}=n,s=la.createAnnotationState(n,a),l={restoreMemo:()=>{const c=la.createAnnotationState(n,a),{viewport:f}=Xe(e)||{};if(f?.setViewReference(n.metadata),s.deleting===!0){if(s.deleting=!1,Object.assign(n.data,s.data),n.data.contour){const d=n.data;d.contour.polyline=s.data.contour.pointsManager.points,delete s.data.contour.pointsManager,d.segmentation&&u0(n)}s.data=c.data,mr(n,e),hu(n.annotationUID,!0),f?.render();return}if(s.deleting===!1){s.deleting=!0,s.data=c.data,hu(n.annotationUID),_r(n.annotationUID),f?.render();return}const u=vo(o);if(!u){console.warn("No current annotation");return}Object.assign(u.data,s.data),u.data.contour&&(u.data.contour.polyline=s.data.contour.pointsManager.points),s.data=c.data,u.invalidated=!0,Un(u,e,xn.History)},id:o,operationType:"annotation"};return yFe.push(l),l}createMemo(e,n,r){this.memo||=la.createAnnotationMemo(e,n,r)}static hydrateBase(e,n,r,i={}){if(!n)return null;const{viewport:a}=n,o=a.getFrameOfReferenceUID(),s=a.getCamera(),l=i.viewplaneNormal??s.viewPlaneNormal,c=i.viewUp??s.viewUp,f=i.toolInstance||new e;let u,d=l,h=c;if(i.referencedImageId)u=i.referencedImageId,d=void 0,h=void 0;else if(a instanceof fa){const p=tee(r[0],a);p!==void 0&&(u=a.getImageIds()[p])}else if(a instanceof mo)u=f.getReferencedImageId(a,r[0],l,c);else throw new Error("Unsupported viewport type");return{FrameOfReferenceUID:o,referencedImageId:u,viewPlaneNormal:d,viewUp:h,instance:f,viewport:a}}}la.toolName="AnnotationTool";const{CalibrationTypes:H0}=ll,K0="px",vb="voxels",Jte=[1,2,3,4],bFe=["3,3","4,7"],wFe=["4,3","4,7"],u9={0:"px",1:"percent",2:"dB",3:"cm",4:"seconds",5:"hertz",6:"dB/seconds",7:"cm/sec",8:"cm²",9:"cm²/s",12:"degrees"},CFe=.001,pv="²",Cc=(t,e)=>{const{calibration:n,hasPixelSpacing:r}=t;let i=r?"mm":K0;const a=r?"mm³":vb;let o=i+pv,s=1,l="";if(!n||!n.type&&!n.sequenceOfUltrasoundRegions)return{unit:i,areaUnit:o,scale:s,volumeUnit:a};if(n.type===H0.UNCALIBRATED)return{unit:K0,areaUnit:K0+pv,scale:s,volumeUnit:vb};if(n.sequenceOfUltrasoundRegions){let f,u;if(Array.isArray(e)&&e.length===2)[f,u]=e;else if(typeof e=="function"){const y=e();f=y[0],u=y[1]}let d=n.sequenceOfUltrasoundRegions.filter(y=>f[0]>=y.regionLocationMinX0&&f[0]<=y.regionLocationMaxX1&&f[1]>=y.regionLocationMinY0&&f[1]<=y.regionLocationMaxY1&&u[0]>=y.regionLocationMinX0&&u[0]<=y.regionLocationMaxX1&&u[1]>=y.regionLocationMinY0&&u[1]<=y.regionLocationMaxY1);if(!d?.length)return{unit:i,areaUnit:o,scale:s,volumeUnit:a};if(d=d.filter(y=>Jte.includes(y.regionDataType)&&bFe.includes(`${y.physicalUnitsXDirection},${y.physicalUnitsYDirection}`)),!d.length)return{unit:K0,areaUnit:K0+pv,scale:s,volumeUnit:vb};const h=d[0],p=Math.abs(h.physicalDeltaX),g=Math.abs(h.physicalDeltaY);if(pr(p,g,CFe))s=1/p,l="US Region",i=u9[h.physicalUnitsXDirection]||"unknown",o=i+pv;else return{unit:K0,areaUnit:K0+pv,scale:s,volumeUnit:vb}}else n.scale&&(s=n.scale);return[H0.ERMF,H0.USER,H0.ERROR,H0.PROJECTION,H0.CALIBRATED,H0.UNKNOWN].includes(n?.type)&&(l=n.type),{unit:i+(l?` ${l}`:""),areaUnit:o+(l?` ${l}`:""),scale:s,volumeUnit:a+(l?` ${l}`:"")}},f9=(t,e)=>{const[n]=e,{calibration:r}=t;let i=["raw"],a=[null],o="";if(!r||!r.type&&!r.sequenceOfUltrasoundRegions)return{units:i,values:a};if(r.sequenceOfUltrasoundRegions){const s=r.sequenceOfUltrasoundRegions.filter(g=>Jte.includes(g.regionDataType)&&wFe.includes(`${g.physicalUnitsXDirection},${g.physicalUnitsYDirection}`));if(!s?.length)return{units:i,values:a};const l=s.find(g=>n[0]>=g.regionLocationMinX0&&n[0]<=g.regionLocationMaxX1&&n[1]>=g.regionLocationMinY0&&n[1]<=g.regionLocationMaxY1);if(!l)return{units:i,values:a};const{referencePixelX0:c=0,referencePixelY0:f=0}=l,{physicalDeltaX:u,physicalDeltaY:d}=l,h=(n[1]-l.regionLocationMinY0-f)*d,p=(n[0]-l.regionLocationMinX0-c)*u;o="US Region",a=[p,h],i=[u9[l.physicalUnitsXDirection],u9[l.physicalUnitsYDirection]]}return{units:i,values:a,calibrationType:o}},SFe=t=>t.calibration?.aspect||1;function Zte(t,e,n,r){const i=it();gr(i,e,t);const a=Sn(...n),o=Sn(...r),s=it();Pr(s,a,o);const l=Vo(s);if(l<1e-4)return{worldWidth:0,worldHeight:0};const c=zt(s,i)/(l*Vo(i)),u=Math.sqrt(1-c*c)*l,d=c*l;return{worldWidth:u,worldHeight:d}}function Qte(t,e,n,r){const i=it();gr(i,e,t);const a=Sn(...n),o=Sn(...r),s=it();Pr(s,a,o);const l=Vo(s);if(l<1e-4)return{worldWidth:0,worldHeight:0};const c=zt(s,i)/(l*Vo(i)),u=Math.sqrt(1-c*c)*l,d=c*l;return{worldWidth:u,worldHeight:d}}const{EPSILON:TFe}=Xh,EFe=1-TFe;function _Fe(t,e){const{viewPlaneNormal:n}=e,r=t.filter(i=>{let a=i.metadata.viewPlaneNormal;if(!a){const{referencedImageId:s}=i.metadata,{imageOrientationPatient:l}=Ut("imagePlaneModule",s),c=Sn(l[0],l[1],l[2]),f=Sn(l[3],l[4],l[5]);a=it(),gr(a,c,f),i.metadata.viewPlaneNormal=a}const o=Math.abs(zt(n,a))>EFe;return a&&o});return r.length?r:[]}function Wl(t,e,n){let r=!0,i=!0;if(typeof t!="function")throw new TypeError("Expected a function");return Ite(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),hS(t,e,{leading:r,trailing:i,maxWait:e})}function DFe(t){return t[0]?.length===3}function OFe(t,e){if(!e||e.length===0||e.length===t.length)return t;const n=e[e.length-1]-e[0]+1,r=m8(e.map(a=>t[a][0])),i=m8(e.map(a=>t[a][1]));if(DFe(t)){const a=m8(e.map(o=>t[o][2]));return TF(fv(r,n),fv(i,n),fv(a,n))}else return TF(fv(r,n),fv(i,n))}function MFe(t,e){const n=[],[r,i]=e,a=i-r+1,o=Math.floor(a/t);let s=0,l=Math.round((a-1)/(o-1)*s)+r;for(;l<=i;)n.push(l),s++,l=Math.round((a-1)/(o-1)*s)+r;return n}function IFe(t,e,n,r){const i=n-e+1,a=Math.floor(r/100*i)??1,o=Math.floor(i/a)??1;if(isNaN(i)||!i||!o||i/o<2)return t;const s=Math.max(0,e),l=Math.min(t.length-1,n),c=t.slice(0,s),f=t.slice(l+1,t.length),u=MFe(o,[s,l]),d=OFe(t,u);return[...c,...d,...f]}function bS(t,e){return e?.autoGenerated?!1:t?.smoothing?.smoothOnAdd===!0||t?.smoothing?.smoothOnEdit===!0}function RFe(t,e){return Qh(t,e)<.001}function PFe(t,e){return Qh(t,e)===0}function AFe(t,e){for(let n=0;n<t.length;n++)for(let r=0;r<e.length;r++)if(PFe(t[n],e[r]))return[n,r]}function hg(t,e,n){return(t+e+n)%e}function kU(t,e,n,r){const[,i,a]=t,[,o,s]=e,l=a.length,c=s.length;let f=t[0],u=e[0];if(!a[f]||!s[u]||!a[i]||!s[o])return[void 0,void 0];for(;f!==i&&u!==o;){if(n(s[u],a[f]))return[f,u];f=hg(f,l,r),u=hg(u,c,r)}return[void 0,void 0]}function NFe(t,e){const[n,r]=AFe(t,e)||[],i=(l,c)=>RFe(l,c)===!1,[a,o]=kU([hg(n,t.length,1),n,t],[hg(r,e.length,1),r,e],i,1),[s]=kU([hg(a,t.length,-1),a,t],[hg(o,e.length,-1),o,e],i,-1);return[a,s]}function wS(t,e,n){const{interpolation:r,smoothing:i}=t,a=e;if(r){const{knotsRatioPercentageOnAdd:o,knotsRatioPercentageOnEdit:s,smoothOnAdd:l=!1,smoothOnEdit:c=!1}=i,f=n?s:o;if(n?c:l){const[d,h]=n?NFe(e,n):[0,e.length-1];return!e[d]||!e[h]?e:IFe(e,d,h,f)}}return a}const n1=t=>{if(t.shiftKey)return t.ctrlKey?La.ShiftCtrl:t.altKey?La.ShiftAlt:t.metaKey?La.ShiftMeta:La.Shift;if(t.ctrlKey)return t.altKey?La.CtrlAlt:t.metaKey?La.CtrlMeta:La.Ctrl;if(t.altKey)return t.metaKey&&La.AltMeta||La.Alt;if(t.metaKey)return La.Meta};function HO(t,e){const n=t[0],r=t[t.length-1],i=Kn();Nl(i,r[0]-n[0],r[1]-n[1]),dh(i,i);const a=Kn(),o=Kn();Nl(a,-i[1],i[0]),Nl(o,i[1],-i[0]);const s=[(n[0]+r[0])/2,(n[1]+r[1])/2],l={dist:0,index:null};for(let u=0;u<t.length;u++){const d=t[u],h=n7(d,s);h>l.dist&&(l.dist=h,l.index=u)}return[t[l.index],s].map(e.canvasToWorld)}function LFe(t,e){const{viewport:n}=t,r=e.data.contour.polyline.map(n.worldToCanvas);return HO(r,n)}const{addCanvasPointsToArray:KO,pointsAreWithinCloseContourProximity:ene,getFirstLineSegmentIntersectionIndexes:tne,getSubPixelSpacingAndXYDirections:kFe}=ep;function VFe(t,e,n){this.isDrawing=!0;const r=t.detail,{currentPoints:i,element:a}=r,o=i.canvas,s=Xe(a),{viewport:l}=s,c=n1(t.detail.event)===this.configuration.contourHoleAdditionModifierKey,{spacing:f,xDir:u,yDir:d}=kFe(l,this.configuration.subPixelResolution)||{};!f||!u||!d||(this.drawData={canvasPoints:[o],polylineIndex:0,contourHoleProcessingEnabled:c,newAnnotation:!0},this.commonData={annotation:e,viewportIdsToRender:n,spacing:f,xDir:u,yDir:d,movingTextBox:!1},Dt.isInteractingWithTool=!0,a.addEventListener(ee.MOUSE_UP,this.mouseUpDrawCallback),a.addEventListener(ee.MOUSE_DRAG,this.mouseDragDrawCallback),a.addEventListener(ee.MOUSE_CLICK,this.mouseUpDrawCallback),a.addEventListener(ee.TOUCH_END,this.mouseUpDrawCallback),a.addEventListener(ee.TOUCH_DRAG,this.mouseDragDrawCallback),a.addEventListener(ee.TOUCH_TAP,this.mouseUpDrawCallback),Rn(a))}function FFe(t){Dt.isInteractingWithTool=!1,t.removeEventListener(ee.MOUSE_UP,this.mouseUpDrawCallback),t.removeEventListener(ee.MOUSE_DRAG,this.mouseDragDrawCallback),t.removeEventListener(ee.MOUSE_CLICK,this.mouseUpDrawCallback),t.removeEventListener(ee.TOUCH_END,this.mouseUpDrawCallback),t.removeEventListener(ee.TOUCH_DRAG,this.mouseDragDrawCallback),t.removeEventListener(ee.TOUCH_TAP,this.mouseUpDrawCallback),qn(t)}function UFe(t){const e=t.detail,{currentPoints:n,element:r}=e,i=n.world,a=n.canvas,o=Xe(r),{viewport:s}=o,{annotation:l,viewportIdsToRender:c,xDir:f,yDir:u,spacing:d,movingTextBox:h}=this.commonData,{polylineIndex:p,canvasPoints:g,newAnnotation:m}=this.drawData;this.createMemo(r,l,{newAnnotation:m});const y=g[g.length-1],v=s.canvasToWorld(y),x=it();Pr(x,i,v);const w=Math.abs(zt(x,f)),S=Math.abs(zt(x,u));if(!(w<=d[0]&&S<=d[1])){if(h){this.isDrawing=!1;const{deltaPoints:T}=e,_=T.world,{textBox:D}=l.data.handles,{worldPosition:I}=D;I[0]+=_[0],I[1]+=_[1],I[2]+=_[2],D.hasMoved=!0}else{const T=this.findCrossingIndexDuringCreate(t);if(T!==void 0)this.applyCreateOnCross(t,T);else{const _=KO(r,g,a,this.commonData);this.drawData.polylineIndex=p+_}l.invalidated=!0}at(c),l.invalidated&&Un(l,r,xn.HandlesUpdated)}}function BFe(t){const{allowOpenContours:e}=this.configuration,{canvasPoints:n,contourHoleProcessingEnabled:r}=this.drawData,i=n[0],a=n[n.length-1],o=t.detail,{element:s}=o;this.doneEditMemo(),this.drawData.newAnnotation=!1,e&&!ene(i,a,this.configuration.closeContourProximity)?this.completeDrawOpenContour(s,{contourHoleProcessingEnabled:r}):this.completeDrawClosedContour(s,{contourHoleProcessingEnabled:r})}function $Fe(t,e){this.removeCrossedLinesOnCompleteDraw();const{canvasPoints:n}=this.drawData,{contourHoleProcessingEnabled:r,minPointsToSave:i}=e??{};if(i&&n.length<i||this.haltDrawing(t,n))return!1;const{annotation:a,viewportIdsToRender:o}=this.commonData,s=Xe(t),{viewport:l,renderingEngine:c}=s;KO(t,n,n[0],this.commonData),n.pop();const f=bS(this.configuration,a)?wS(this.configuration,n):n;this.updateContourPolyline(a,{points:f,closed:!0,targetWindingDirection:rs.Clockwise},l);const{textBox:u}=a.data.handles;return u?.hasMoved||oS(a,r),this.isDrawing=!1,this.drawData=void 0,this.commonData=void 0,at(o),this.deactivateDraw(t),!0}function GFe(){const{canvasPoints:t}=this.drawData,e=t.length,n=[t[0],t[e-1]],r=t.slice(0,-1).slice(1),i=tne(r,n[0],n[1],!1);if(i){const a=i[1];a===1?this.drawData.canvasPoints=t.splice(1):this.drawData.canvasPoints=t.splice(0,a)}}function jFe(t,e){const{canvasPoints:n}=this.drawData,{contourHoleProcessingEnabled:r}=e??{};if(this.haltDrawing(t,n))return!1;const{annotation:i,viewportIdsToRender:a}=this.commonData,o=Xe(t),{viewport:s,renderingEngine:l}=o,c=bS(this.configuration,i)?wS(this.configuration,n):n;this.updateContourPolyline(i,{points:c,closed:!1},s);const{textBox:f}=i.data.handles,u=i.data.contour.polyline;return i.data.handles.points=[u[0],u[u.length-1]],i.data.isOpenUShapeContour&&(i.data.openUShapeContourVectorToPeak=HO(n,s)),f.hasMoved||oS(i,r),this.isDrawing=!1,this.drawData=void 0,this.commonData=void 0,at(a),this.deactivateDraw(t),!0}function zFe(t){const e=t.detail,{currentPoints:n,lastPoints:r}=e,i=n.canvas,a=r.canvas,{canvasPoints:o}=this.drawData,s=o.slice(0,-1),l=tne(s,i,a,!1);return l===void 0?void 0:l[0]}function WFe(t,e){const n=t.detail,{element:r}=n,{canvasPoints:i,contourHoleProcessingEnabled:a}=this.drawData,{annotation:o,viewportIdsToRender:s}=this.commonData;KO(r,i,i[e],this.commonData),i.pop();const l=i.slice(e),c=Hy(l);if(pr(c,0)){i.splice(e+1);return}i.splice(0,e);const f={contourHoleProcessingEnabled:a,minPointsToSave:3};this.completeDrawClosedContour(r,f)&&this.activateClosedContourEdit(t,o,s)}function HFe(t){const{allowOpenContours:e}=this.configuration,{canvasPoints:n,contourHoleProcessingEnabled:r}=this.drawData,i=n[0],a=n[n.length-1];e&&!ene(i,a,this.configuration.closeContourProximity)?this.completeDrawOpenContour(t,{contourHoleProcessingEnabled:r}):this.completeDrawClosedContour(t,{contourHoleProcessingEnabled:r})}function KFe(t,e){const n=Math.max(e*3,3);return t.length<n}function qFe(t,e){const{subPixelResolution:n}=this.configuration;if(KFe(e,n)){const{annotation:r,viewportIdsToRender:i}=this.commonData,a=Xe(t),{renderingEngine:o}=a;return _r(r.annotationUID),this.isDrawing=!1,this.drawData=void 0,this.commonData=void 0,at(i),this.deactivateDraw(t),!0}return!1}function XFe(t){t.activateDraw=VFe.bind(t),t.deactivateDraw=FFe.bind(t),t.applyCreateOnCross=WFe.bind(t),t.findCrossingIndexDuringCreate=zFe.bind(t),t.completeDrawOpenContour=jFe.bind(t),t.removeCrossedLinesOnCompleteDraw=GFe.bind(t),t.mouseDragDrawCallback=UFe.bind(t),t.mouseUpDrawCallback=BFe.bind(t),t.completeDrawClosedContour=$Fe.bind(t),t.cancelDrawing=HFe.bind(t),t.haltDrawing=qFe.bind(t)}const{addCanvasPointsToArray:YFe,getFirstLineSegmentIntersectionIndexes:zh}=ep;function JFe(t,e){const n=t.detail,{element:r,currentPoints:i,lastPoints:a}=n,o=i.canvas,s=a.canvas,{editCanvasPoints:l,prevCanvasPoints:c}=this.editData,f=zh(c,o,s,e);if(f)this.editData.startCrossingIndex=f[0],this.removePointsUpUntilFirstCrossing(e);else if(c.length>=2)if(l.length>this.configuration.checkCanvasEditFallbackProximity){const u=l[0],d=[];for(let g=0;g<c.length;g++){const m=c[g],y=ii(m,u);d.push({distance:y,index:g})}d.sort((g,m)=>g.distance-m.distance);const h=[d[0],d[1]],p=Math.min(h[0].index,h[1].index);this.editData.startCrossingIndex=p}else{const u=Kn();ka(u,l[1],l[0]),dh(u,u);const d=6,h=[l[0][0]-u[0]*d,l[0][1]-u[1]*d],p=zh(c,h,l[0],e);if(p){const g=[h];YFe(r,g,l[0],this.commonData),l.unshift(...g),this.removePointsUpUntilFirstCrossing(e),this.editData.editIndex=l.length-1,this.editData.startCrossingIndex=p[0]}}}function ZFe(t){const{editCanvasPoints:e,prevCanvasPoints:n}=this.editData;let r=0;for(let i=0;i<e.length-1;i++){const a=[e[i],e[i+1]],o=!!zh(n,a[0],a[1],t);if(r++,o)break}e.splice(0,r),this.editData.editIndex=e.length-1}function QFe(t,e){const n=t.detail,{currentPoints:r,lastPoints:i}=n,a=r.canvas,o=i.canvas,{prevCanvasPoints:s}=this.editData;return!!zh(s,a,o,e)}function eUe(t){const{prevCanvasPoints:e,editCanvasPoints:n}=this.editData;for(let r=n.length-1;r>0;r--){const i=[n[r],n[r-1]],a=!!zh(e,i[0],i[1],t);if(n.pop(),a)break}}function tUe(){const{editCanvasPoints:t,prevCanvasPoints:e,startCrossingIndex:n}=this.editData;if(n===void 0)return;const r=t[t.length-1],i=[];for(let o=0;o<e.length;o++){const s=e[o],l=ii(s,r);i.push({distance:l,index:o})}i.sort((o,s)=>o.distance-s.distance);const a=t.slice(0,-1);for(let o=0;o<i.length;o++){const{index:s}=i[o],l=e[s],c=t[t.length-1];if(!zh(a,l,c,!1))return s}return-1}function nUe(t){const e=t.detail,{currentPoints:n,lastPoints:r}=e,i=n.canvas,a=r.canvas,{editCanvasPoints:o}=this.editData,s=o.slice(0,-2),l=zh(s,i,a,!1);if(!l)return;const c=l[0],f=o.length-c;for(let u=0;u<f;u++)o.pop()}function rUe(t){t.checkForFirstCrossing=JFe.bind(t),t.removePointsUpUntilFirstCrossing=ZFe.bind(t),t.checkForSecondCrossing=QFe.bind(t),t.findSnapIndex=tUe.bind(t),t.removePointsAfterSecondCrossing=eUe.bind(t),t.checkAndRemoveCrossesOnEditLine=nUe.bind(t)}const{getSubPixelSpacingAndXYDirections:iUe,addCanvasPointsToArray:nne,getArea:VU}=ep;function aUe(t,e,n){this.isEditingClosed=!0;const r=t.detail,{currentPoints:i,element:a}=r,o=i.canvas,s=Xe(a);if(!s)return;const{viewport:l}=s,c=e.data.contour.polyline.map(l.worldToCanvas),{spacing:f,xDir:u,yDir:d}=iUe(l,this.configuration.subPixelResolution);this.editData={prevCanvasPoints:c,editCanvasPoints:[o],startCrossingIndex:void 0,editIndex:0,annotation:e},this.commonData={annotation:e,viewportIdsToRender:n,spacing:f,xDir:u,yDir:d,movingTextBox:!1},Dt.isInteractingWithTool=!0,a.addEventListener(ee.MOUSE_UP,this.mouseUpClosedContourEditCallback),a.addEventListener(ee.MOUSE_DRAG,this.mouseDragClosedContourEditCallback),a.addEventListener(ee.MOUSE_CLICK,this.mouseUpClosedContourEditCallback),a.addEventListener(ee.TOUCH_END,this.mouseUpClosedContourEditCallback),a.addEventListener(ee.TOUCH_DRAG,this.mouseDragClosedContourEditCallback),a.addEventListener(ee.TOUCH_TAP,this.mouseUpClosedContourEditCallback),Rn(a)}function oUe(t){Dt.isInteractingWithTool=!1,t.removeEventListener(ee.MOUSE_UP,this.mouseUpClosedContourEditCallback),t.removeEventListener(ee.MOUSE_DRAG,this.mouseDragClosedContourEditCallback),t.removeEventListener(ee.MOUSE_CLICK,this.mouseUpClosedContourEditCallback),t.removeEventListener(ee.TOUCH_END,this.mouseUpClosedContourEditCallback),t.removeEventListener(ee.TOUCH_DRAG,this.mouseDragClosedContourEditCallback),t.removeEventListener(ee.TOUCH_TAP,this.mouseUpClosedContourEditCallback),qn(t)}function sUe(t){const e=t.detail,{currentPoints:n,element:r}=e,i=n.world,a=n.canvas,o=Xe(r),{viewport:s}=o,{viewportIdsToRender:l,xDir:c,yDir:f,spacing:u}=this.commonData,{editIndex:d,editCanvasPoints:h,startCrossingIndex:p,annotation:g}=this.editData;this.createMemo(r,g);const m=h[h.length-1],y=s.canvasToWorld(m),v=it();Pr(v,i,y);const x=Math.abs(zt(v,c)),w=Math.abs(zt(v,f));if(x<=u[0]&&w<=u[1])return;p!==void 0&&this.checkAndRemoveCrossesOnEditLine(t);const S=nne(r,h,a,this.commonData),T=d+S;if(this.editData.editIndex=T,p===void 0&&h.length>1&&this.checkForFirstCrossing(t,!0),this.editData.snapIndex=this.findSnapIndex(),this.editData.snapIndex===-1){this.finishEditAndStartNewEdit(t);return}this.editData.fusedCanvasPoints=this.fuseEditPointsWithClosedContour(t),p!==void 0&&this.checkForSecondCrossing(t,!0)&&(this.removePointsAfterSecondCrossing(!0),this.finishEditAndStartNewEdit(t)),at(l)}function lUe(t){const e=t.detail,{element:n}=e,r=Xe(n),{viewport:i,renderingEngine:a}=r,{annotation:o,viewportIdsToRender:s}=this.commonData,{fusedCanvasPoints:l,editCanvasPoints:c}=this.editData;Mu(o,{points:l,closed:!0,targetWindingDirection:rs.Clockwise},i),o.autoGenerated&&(o.autoGenerated=!1),Un(o,n);const f=c.pop();this.editData={prevCanvasPoints:l,editCanvasPoints:[f],startCrossingIndex:void 0,editIndex:0,snapIndex:void 0,annotation:o},at(s)}function cUe(t){const{prevCanvasPoints:e,editCanvasPoints:n,startCrossingIndex:r,snapIndex:i}=this.editData;if(r===void 0||i===void 0)return;const a=t.detail,{element:o}=a,s=[...n];nne(o,s,e[i],this.commonData),s.length>n.length&&s.pop();let l,c;r>i?(l=i,c=r):(l=r,c=i);const f=ii(e[l],s[0]),u=ii(e[l],s[s.length-1]),d=ii(e[c],s[0]),h=ii(e[c],s[s.length-1]),p=[];for(let S=0;S<l;S++){const T=e[S];p.push([T[0],T[1]])}let g=f+h,m=u+d;if(g<m)for(let S=0;S<s.length;S++){const T=s[S];p.push([T[0],T[1]])}else for(let S=s.length-1;S>=0;S--){const T=s[S];p.push([T[0],T[1]])}for(let S=c;S<e.length;S++){const T=e[S];p.push([T[0],T[1]])}const y=[];for(let S=l;S<c;S++){const T=e[S];y.push([T[0],T[1]])}if(g=d+u,m=h+f,g<m)for(let S=0;S<s.length;S++){const T=s[S];y.push([T[0],T[1]])}else for(let S=s.length-1;S>=0;S--){const T=s[S];y.push([T[0],T[1]])}const v=VU(p),x=VU(y);return v>x?p:y}function uUe(t){const e=t.detail,{element:n}=e;this.completeClosedContourEdit(n)}function fUe(t){const e=Xe(t),{viewport:n}=e,{annotation:r,viewportIdsToRender:i}=this.commonData;this.doneEditMemo();const{fusedCanvasPoints:a,prevCanvasPoints:o}=this.editData;if(a){const s=bS(this.configuration,r)?wS(this.configuration,a,o):a,l=this.configuration?.decimate||{};Mu(r,{points:s,closed:!0,targetWindingDirection:rs.Clockwise},n,{decimate:{enabled:!!l.enabled,epsilon:l.epsilon}}),r.autoGenerated&&(r.autoGenerated=!1),Un(r,t)}this.isEditingClosed=!1,this.editData=void 0,this.commonData=void 0,at(i),this.deactivateClosedContourEdit(t)}function dUe(t){this.completeClosedContourEdit(t)}function hUe(t){t.activateClosedContourEdit=aUe.bind(t),t.deactivateClosedContourEdit=oUe.bind(t),t.mouseDragClosedContourEditCallback=sUe.bind(t),t.mouseUpClosedContourEditCallback=uUe.bind(t),t.finishEditAndStartNewEdit=lUe.bind(t),t.fuseEditPointsWithClosedContour=cUe.bind(t),t.cancelClosedContourEdit=dUe.bind(t),t.completeClosedContourEdit=fUe.bind(t)}const{addCanvasPointsToArray:rne,getSubPixelSpacingAndXYDirections:pUe}=ep;function gUe(t,e,n){this.isEditingOpen=!0;const r=t.detail,{currentPoints:i,element:a}=r,o=i.canvas,s=Xe(a),{viewport:l}=s;this.doneEditMemo();const c=e.data.contour.polyline.map(l.worldToCanvas),{spacing:f,xDir:u,yDir:d}=pUe(l,this.configuration.subPixelResolution);this.editData={prevCanvasPoints:c,editCanvasPoints:[o],startCrossingIndex:void 0,editIndex:0},this.commonData={annotation:e,viewportIdsToRender:n,spacing:f,xDir:u,yDir:d,movingTextBox:!1},Dt.isInteractingWithTool=!0,a.addEventListener(ee.MOUSE_UP,this.mouseUpOpenContourEditCallback),a.addEventListener(ee.MOUSE_DRAG,this.mouseDragOpenContourEditCallback),a.addEventListener(ee.MOUSE_CLICK,this.mouseUpOpenContourEditCallback),a.addEventListener(ee.TOUCH_END,this.mouseUpOpenContourEditCallback),a.addEventListener(ee.TOUCH_DRAG,this.mouseDragOpenContourEditCallback),a.addEventListener(ee.TOUCH_TAP,this.mouseUpOpenContourEditCallback),Rn(a)}function mUe(t){Dt.isInteractingWithTool=!1,t.removeEventListener(ee.MOUSE_UP,this.mouseUpOpenContourEditCallback),t.removeEventListener(ee.MOUSE_DRAG,this.mouseDragOpenContourEditCallback),t.removeEventListener(ee.MOUSE_CLICK,this.mouseUpOpenContourEditCallback),t.removeEventListener(ee.TOUCH_END,this.mouseUpOpenContourEditCallback),t.removeEventListener(ee.TOUCH_DRAG,this.mouseDragOpenContourEditCallback),t.removeEventListener(ee.TOUCH_TAP,this.mouseUpOpenContourEditCallback),qn(t)}function vUe(t){const e=t.detail,{currentPoints:n,element:r}=e,i=n.world,a=n.canvas,o=Xe(r),{viewport:s}=o,{viewportIdsToRender:l,xDir:c,yDir:f,spacing:u}=this.commonData,{editIndex:d,editCanvasPoints:h,startCrossingIndex:p}=this.editData,g=h[h.length-1],m=s.canvasToWorld(g),y=it();this.createMemo(r,this.commonData.annotation),Pr(y,i,m);const v=Math.abs(zt(y,c)),x=Math.abs(zt(y,f));if(v<=u[0]&&x<=u[1])return;p!==void 0&&this.checkAndRemoveCrossesOnEditLine(t);const w=rne(r,h,a,this.commonData),S=d+w;this.editData.editIndex=S,p===void 0&&h.length>1&&this.checkForFirstCrossing(t,!1),this.editData.snapIndex=this.findSnapIndex(),this.editData.fusedCanvasPoints=this.fuseEditPointsWithOpenContour(t),p!==void 0&&this.checkForSecondCrossing(t,!1)?(this.removePointsAfterSecondCrossing(!1),this.finishEditOpenOnSecondCrossing(t)):this.checkIfShouldOverwriteAnEnd(t)&&this.openContourEditOverwriteEnd(t),at(l)}function yUe(t){const e=t.detail,{element:n}=e,r=Xe(n),{viewport:i}=r,{annotation:a,viewportIdsToRender:o}=this.commonData,s=this.fuseEditPointsForOpenContourEndEdit();Mu(a,{points:s,closed:!1},i);const l=a.data.contour.polyline;a.data.handles.points=[l[0],l[l.length-1]],a.data.handles.activeHandleIndex=1,Un(a,n),this.isEditingOpen=!1,this.editData=void 0,this.commonData=void 0,this.doneEditMemo(),this.deactivateOpenContourEdit(n),this.activateOpenContourEndEdit(t,a,o,null)}function xUe(t){const e=t.detail,{currentPoints:n,lastPoints:r}=e,i=n.canvas,a=r.canvas,{snapIndex:o,prevCanvasPoints:s,startCrossingIndex:l}=this.editData;if(l===void 0||o===void 0)return!1;if(o===-1)return!0;if(o!==0&&o!==s.length-1)return!1;const c=i,f=a,u=s[o],d=Kn(),h=Kn();Nl(d,c[0]-f[0],c[1]-f[1]),Nl(h,c[0]-u[0],c[1]-u[1]);const p=pf(d,h),g=Math.sqrt(d[0]*d[0]+d[1]*d[1]),m=Math.sqrt(h[0]*h[0]+h[1]*h[1]);return Math.acos(p/(g*m))<Math.PI/2}function bUe(){const{snapIndex:t,prevCanvasPoints:e,editCanvasPoints:n,startCrossingIndex:r}=this.editData,i=[];if(t===0)for(let s=e.length-1;s>=r;s--){const l=e[s];i.push([l[0],l[1]])}else for(let s=0;s<r;s++){const l=e[s];i.push([l[0],l[1]])}const a=ii(e[r],n[0]),o=ii(e[r],n[n.length-1]);if(a<o)for(let s=0;s<n.length;s++){const l=n[s];i.push([l[0],l[1]])}else for(let s=n.length-1;s>=0;s--){const l=n[s];i.push([l[0],l[1]])}return i}function wUe(t){const{prevCanvasPoints:e,editCanvasPoints:n,startCrossingIndex:r,snapIndex:i}=this.editData;if(r===void 0||i===void 0)return;const a=t.detail,{element:o}=a,s=[...n];rne(o,s,e[i],this.commonData),s.length>n.length&&s.pop();let l,c;r>i?(l=i,c=r):(l=r,c=i);const f=ii(e[l],s[0]),u=ii(e[l],s[s.length-1]),d=ii(e[c],s[0]),h=ii(e[c],s[s.length-1]),p=[];for(let y=0;y<l;y++){const v=e[y];p.push([v[0],v[1]])}const g=f+h,m=u+d;if(g<m)for(let y=0;y<s.length;y++){const v=s[y];p.push([v[0],v[1]])}else for(let y=s.length-1;y>=0;y--){const v=s[y];p.push([v[0],v[1]])}for(let y=c;y<e.length;y++){const v=e[y];p.push([v[0],v[1]])}return p}function CUe(t){const e=t.detail,{element:n}=e,r=Xe(n),{viewport:i,renderingEngine:a}=r,{annotation:o,viewportIdsToRender:s}=this.commonData,{fusedCanvasPoints:l,editCanvasPoints:c}=this.editData;Mu(o,{points:l,closed:!1},i);const f=o.data.contour.polyline;o.data.handles.points=[f[0],f[f.length-1]],Un(o,n);const u=c.pop();this.editData={prevCanvasPoints:l,editCanvasPoints:[u],startCrossingIndex:void 0,editIndex:0},at(s)}function SUe(t){const e=t.detail,{element:n}=e;this.completeOpenContourEdit(n)}function TUe(t){const e=Xe(t),{viewport:n}=e,{annotation:r,viewportIdsToRender:i}=this.commonData;this.doneEditMemo();const{fusedCanvasPoints:a,prevCanvasPoints:o}=this.editData;if(a){const s=bS(this.configuration)?wS(this.configuration,a,o):a,l=this.configuration?.decimate||{};Mu(r,{points:s,closed:!1},n,{decimate:{enabled:!!l.enabled,epsilon:l.epsilon}});const c=r.data.contour.polyline;r.data.handles.points=[c[0],c[c.length-1]],r.data.isOpenUShapeContour&&(r.data.openUShapeContourVectorToPeak=HO(a,n)),Un(r,t)}this.isEditingOpen=!1,this.editData=void 0,this.commonData=void 0,at(i),this.deactivateOpenContourEdit(t)}function EUe(t){this.completeOpenContourEdit(t)}function _Ue(t){t.activateOpenContourEdit=gUe.bind(t),t.deactivateOpenContourEdit=mUe.bind(t),t.mouseDragOpenContourEditCallback=vUe.bind(t),t.mouseUpOpenContourEditCallback=SUe.bind(t),t.fuseEditPointsWithOpenContour=wUe.bind(t),t.finishEditOpenOnSecondCrossing=CUe.bind(t),t.checkIfShouldOverwriteAnEnd=xUe.bind(t),t.fuseEditPointsForOpenContourEndEdit=bUe.bind(t),t.openContourEditOverwriteEnd=yUe.bind(t),t.cancelOpenContourEdit=EUe.bind(t),t.completeOpenContourEdit=TUe.bind(t)}const{getSubPixelSpacingAndXYDirections:DUe}=ep;function OUe(t,e,n,r){this.isDrawing=!0;const i=t.detail,{element:a}=i,o=Xe(a),{viewport:s}=o,{spacing:l,xDir:c,yDir:f}=DUe(s,this.configuration.subPixelResolution),u=e.data.contour.polyline.map(s.worldToCanvas);e.data.handles.activeHandleIndex===0&&u.reverse();let h=!1;r?.worldPosition&&(h=!0),this.drawData={canvasPoints:u,polylineIndex:u.length-1},this.commonData={annotation:e,viewportIdsToRender:n,spacing:l,xDir:c,yDir:f,movingTextBox:h},Dt.isInteractingWithTool=!0,a.addEventListener(ee.MOUSE_UP,this.mouseUpDrawCallback),a.addEventListener(ee.MOUSE_DRAG,this.mouseDragDrawCallback),a.addEventListener(ee.MOUSE_CLICK,this.mouseUpDrawCallback),a.addEventListener(ee.TOUCH_END,this.mouseUpDrawCallback),a.addEventListener(ee.TOUCH_DRAG,this.mouseDragDrawCallback),a.addEventListener(ee.TOUCH_TAP,this.mouseUpDrawCallback),Rn(a)}function MUe(t){t.activateOpenContourEndEdit=OUe.bind(t)}function IUe(t){return(t.childAnnotationUIDs??[]).map(n=>vo(n).data.contour.polyline)}function CS(t,e){const n=IUe(t),r=[];return n.forEach(i=>{const a=i.length,o=new Array(a);for(let s=0;s<a;s++)o[s]=e.worldToCanvas(i[s]);r.push(o)}),r}const{pointsAreWithinCloseContourProximity:RUe}=ep;function PUe(t,e){const n={toolGroupId:this.toolGroupId,toolName:this.getToolName(),viewportId:t.viewport.id,annotationUID:e.annotationUID},{lineWidth:r,lineDash:i,color:a,fillColor:o,fillOpacity:s}=this.getAnnotationStyle({annotation:e,styleSpecifier:n}),{closed:l}=e.data.contour;return{color:a,width:r,lineDash:i,fillColor:o,fillOpacity:s,closePath:l}}function AUe(t,e,n){t?.viewport?.getImageData()&&(n.data.contour.closed?this.renderClosedContour(t,e,n):n.data.isOpenUShapeContour?(NUe(t,n),this.renderOpenUShapedContour(t,e,n)):this.renderOpenContour(t,e,n))}function NUe(t,e){e.data.openUShapeContourVectorToPeak||(e.data.openUShapeContourVectorToPeak=LFe(t,e))}function LUe(t,e,n){if(n.parentAnnotationUID)return;const{viewport:r}=t,i=this._getRenderingOptions(t,n),a=n.data.contour.polyline.map(c=>r.worldToCanvas(c)),o=CS(n,r),s=[a,...o];Dh(e,n.annotationUID,"1",s,i)}function kUe(t,e,n){const{viewport:r}=t,i=this._getRenderingOptions(t,n),a=n.data.contour.polyline.map(l=>r.worldToCanvas(l));Rf(e,n.annotationUID,"1",a,i);const s=n.data.handles.activeHandleIndex;if(this.configuration.alwaysRenderOpenContourHandles?.enabled===!0){const l=this.configuration.alwaysRenderOpenContourHandles.radius,c="0",f=[a[0],a[a.length-1]];s===0?f.shift():s===1&&f.pop(),bo(e,n.annotationUID,c,f,{color:i.color,handleRadius:l})}if(s!==null){const c=s===0?0:a.length-1,f=a[c];bo(e,n.annotationUID,"1",[f],{color:i.color})}}function VUe(t,e,n){const{viewport:r}=t,{openUShapeContourVectorToPeak:i}=n.data,{polyline:a}=n.data.contour;if(this.renderOpenContour(t,e,n),!i)return;const o=r.worldToCanvas(a[0]),s=r.worldToCanvas(a[a.length-1]),l=[r.worldToCanvas(i[0]),r.worldToCanvas(i[1])],c=this._getRenderingOptions(t,n);Rf(e,n.annotationUID,"first-to-last",[o,s],{color:c.color,width:c.width,closePath:!1,lineDash:"2,2"}),Rf(e,n.annotationUID,"midpoint-to-open-contour",[l[0],l[1]],{color:c.color,width:c.width,closePath:!1,lineDash:"2,2"})}function FUe(t,e,n){const r=this._getRenderingOptions(t,n),{allowOpenContours:i}=this.configuration,{canvasPoints:a}=this.drawData;if(r.closePath=!1,Rf(e,n.annotationUID,"1",a,r),i){const o=a[0],s=a[a.length-1];RUe(o,s,this.configuration.closeContourProximity)?Rf(e,n.annotationUID,"2",[s,o],r):bo(e,n.annotationUID,"0",[o],{color:r.color,handleRadius:2})}}function UUe(t,e,n){const{viewport:r}=t,{fusedCanvasPoints:i}=this.editData;if(i===void 0){this.renderClosedContour(t,e,n);return}const a=CS(n,r),o=[i,...a],s=this._getRenderingOptions(t,n),l="preview-1";n.parentAnnotationUID&&s.fillOpacity&&(s.fillOpacity=0),Dh(e,n.annotationUID,l,o,s)}function BUe(t,e,n){const{fusedCanvasPoints:r}=this.editData;if(r===void 0){this.renderOpenContour(t,e,n);return}const i=this._getRenderingOptions(t,n);Rf(e,n.annotationUID,"preview-1",r,i)}function $Ue(t,e,n){if(n.parentAnnotationUID)return;const{viewport:r}=t,i=this._getRenderingOptions(t,n),a=n.data.contour.polyline.map(p=>r.worldToCanvas(p)),o=CS(n,r),s="1",l=a[0],c=6,f=100,u=[];for(let p=0;p<f;p++){const g=p/f*2*Math.PI,m=l[0]+c*Math.cos(g),y=l[1]+c*Math.sin(g);u.push([m,y])}const d=[[l[0]-c*2,l[1]],[l[0]+c*2,l[1]],[l[0],l[1]-c*2],[l[0],l[1]+c*2]];Dh(e,n.annotationUID,s+"-crosshair_v",[d[0],d[1]],i),Dh(e,n.annotationUID,s+"-crosshair_h",[d[2],d[3]],i);const h=[u,...o];Dh(e,n.annotationUID,s,h,i)}function GUe(t){t.renderContour=AUe.bind(t),t.renderClosedContour=LUe.bind(t),t.renderOpenContour=kUe.bind(t),t.renderPointContourWithMarker=$Ue.bind(t),t.renderOpenUShapedContour=VUe.bind(t),t.renderContourBeingDrawn=FUe.bind(t),t.renderClosedContourBeingEdited=UUe.bind(t),t.renderOpenContourBeingEdited=BUe.bind(t),t._getRenderingOptions=PUe.bind(t)}function Iu(t){const e=jUe(t),n=(e.top[1]+e.bottom[1])/2;return[e.right[0],n]}function jUe(t){const e=[t[0],t[1]].sort(o),n=[t[0],t[1]].sort(s),r=e[e.length-1],i=n[0],a=n[n.length-1];return{top:i,bottom:a,right:r};function o(l,c){return l[0]<c[0]?-1:1}function s(l,c){return l[1]<c[1]?-1:1}}function r1(t,e){if(t instanceof mo){const n=m0(e),r=yt.getVolume(n);return!!r?.scaling&&Object.keys(r.scaling).length>0}else if(t instanceof fa){const{preScale:n}=t.getImageData()||{};return!!n?.scaled}else return!1}function FU(t,e){let n=0;for(let r=0;r<t.length-1;r++){const i=t[r],a=t[r+1];n+=Math.sqrt(Math.pow(a[0]-i[0],2)+Math.pow(a[1]-i[1],2))}if(e){const r=t[0],i=t[t.length-1];n+=Math.sqrt(Math.pow(i[0]-r[0],2)+Math.pow(i[1]-r[1],2))}return n}class zUe extends la{constructor(e,n){super(e,n)}renderAnnotation(e,n){let r=!1;const{viewport:i}=e,{element:a}=i;if(!i.getRenderingEngine())return console.warn("Rendering Engine has been destroyed"),r;let o=Zi(this.getToolName(),a);if(!o?.length||(o=this.filterInteractableAnnotationsForElement(a,o),!o?.length))return r;const s=this.getTargetId(i),l={toolGroupId:this.toolGroupId,toolName:this.getToolName(),viewportId:e.viewport.id};for(let c=0;c<o.length;c++){const f=o[c];l.annotationUID=f.annotationUID;const u=this.getAnnotationStyle({annotation:f,styleSpecifier:l});if(!u.visibility)continue;const d=this.renderAnnotationInstance({enabledElement:e,targetId:s,annotation:f,annotationStyle:u,svgDrawingHelper:n});r||=d,f.invalidated=!1}return r}createAnnotation(e){const n=super.createAnnotation(e);return Object.assign(n.data,{contour:{polyline:[],closed:!1}}),Object.assign(n,{interpolationUID:"",autoGenerated:!1}),n}addAnnotation(e,n){return mr(e,n)}cancelAnnotation(e){}moveAnnotation(e,n){const{points:r}=e.data.handles;for(let i=0,a=r.length;i<a;i++){const o=r[i];o[0]+=n[0],o[1]+=n[1],o[2]+=n[2]}e.invalidated=!0,jy(e).forEach(i=>this.moveAnnotation(i,n))}updateContourPolyline(e,n,r,i){const a=this.configuration?.decimate||{};Mu(e,n,r,{decimate:{enabled:!!a.enabled,epsilon:a.epsilon},updateWindingDirection:i?.updateWindingDirection})}getPolylinePoints(e){return e.data.contour?.polyline??e.data.polyline}renderAnnotationInstance(e){const{enabledElement:n,annotationStyle:r,svgDrawingHelper:i}=e,a=e.annotation;if(a.parentAnnotationUID)return;const{annotationUID:o}=a,{viewport:s}=n,{worldToCanvas:l}=s,c=this.getPolylinePoints(a).map(y=>l(y)),{lineWidth:f,lineDash:u,color:d,fillColor:h,fillOpacity:p}=r,g=CS(a,s),m=[c,...g];return Dh(i,o,"contourPolyline",m,{color:d,lineDash:u,lineWidth:Math.max(.1,f),fillColor:h,fillOpacity:p}),!0}}const Ts={...iLe,...eLe,resetAnnotationManager:Ike},UU="PlanarFreehandContourSegmentationTool";function qO(t,e=[]){const{viewport:n,sliceData:r,annotation:i}=t,a=new Map,{toolName:o,originalToolName:s}=i.metadata,l=s||o,c=(Zi(l,n.element)||[]).filter(f=>!f.metadata.originalToolName||f.metadata.originalToolName===l);if(l!==UU){const f=Zi(UU,n.element);f?.length&&f.forEach(u=>{const{metadata:d}=u;d.originalToolName===l&&d.originalToolName!==d.toolName&&c.push(u)})}if(!c?.length)return a;for(let f=0;f<r.numberOfSlices;f++){const u=c.filter(h=>h.metadata.sliceIndex===f);if(!u?.length)continue;const d=u.filter(h=>e.every(p=>{const m=(p.parentKey?p.parentKey(h):h)?.[p.key];return Array.isArray(m)?m.every((y,v)=>y===p.value[v]):m===p.value}));d.length&&a.set(f,d)}return a}function WUe(t,e){const n=qO(t,e),r=[];if(!n?.size)return r;for(const i of n.values())i.forEach(a=>{r.push(a)});return r}function ine(t,e,n){const r=No({data:{},metadata:{}},n);return Object.assign(r,{highlighted:!1,invalidated:!0,autoGenerated:!0,annotationUID:void 0,cachedStats:{},childAnnotationUIDs:[],parentAnnotationUID:void 0}),Object.assign(r.data,{handles:{points:e.points||e||[],interpolationSources:e.sources,activeHandleIndex:null,textBox:{hasMoved:!1,worldPosition:[0,0,0],worldBoundingBox:{topLeft:[0,0,0],topRight:[0,0,0],bottomLeft:[0,0,0],bottomRight:[0,0,0]}}},contour:{...n.data.contour,polyline:t}}),r}function HUe(t,e){const n=qO(e,[{key:"interpolationUID",value:e.interpolationUID}]),r=KUe(n);if(!r){console.warn("No annotations found to interpolate",n);return}const i=qUe(n,t.annotationUID),a=[];for(let o=r[0]+1;o<r[1];o++)if(XUe(n,o)){const s=JUe(o,r,n);(s?.[0]===i||s?.[1]===i)&&YUe(s,a,o)}return{interpolationData:n,interpolationList:a}}function KUe(t){let e=1/0,n=-1/0,r=!1;for(const[i,a]of t.entries())a.length&&(e=Math.min(i,e),n=Math.max(i,n),r=!0);if(r)return[e,n]}function qUe(t,e){for(const[n,r]of t)for(let i=0;i<r.length;i++)if(r[i].annotationUID===e)return n}function XUe(t,e){const n=t.get(e);return!n?.length||n.length===1&&n[0].autoGenerated}function YUe(t,e,n){const[r]=t;e[r]||={pair:t,list:[]},e[r].list.push(n)}function JUe(t,e,n){const r=[];let i=!0;for(let a=t-1;a>=e[0];a--){const o=n.get(a);if(o?.length){if(o[0].autoGenerated)continue;o.length>1&&(i=!1),r.push(a);break}}if(!(!i||!r.length)){for(let a=t+1;a<=e[1];a++){const o=n.get(a);if(o?.length){if(o[0].autoGenerated)continue;o.length>1&&(i=!1),r.push(a);break}}if(!(!i||r.length<2))return r}}const{PointsManager:BU}=Yr;function ZUe(t,e=12){const n=BU.create3(e);n.sources=[];const{sources:r}=n,{length:i,sources:a=[]}=t,o=5;if(i<o*3)return t.subselect(e);const s=Math.floor(Math.max(2*i/e,o*2));a.forEach(()=>r.push(BU.create3(e)));const l=QUe(t,o),c=eBe(l,e),f=[];if(c?.length>2){let u=-1;const d=s/3;c.forEach(g=>{const[m,,y]=g,v=Math.ceil((m+y)/2);y-u<d||(v-m>2*d?(Xp(f,u,m,s,i),u=Xp(f,m,v,s,i)):u=Xp(f,u,v,s,i),y-u>d&&(u=Xp(f,u,y,s,i)))});const h=f[0];d9(h+i-u,i)>2*d&&Xp(f,u,h-d,s,i)}else{const u=Math.floor(i/e);Xp(f,-1,i-u,u,i)}return f.forEach(u=>{const d=t.getPointArray(u);n.push(d),a.forEach((h,p)=>r[p].push(h.getPoint(u)))}),n}function QUe(t,e=6){const{length:n}=t,r=it(),i=it(),a=new Float32Array(n);for(let o=0;o<n;o++){const s=t.getPoint(o),l=t.getPoint(o-e),c=t.getPoint((o+e)%n);dr(r,s,l),dr(i,c,s);const f=zt(r,i)/(E_(r)*E_(i));a[o]=f}return a}function eBe(t,e){const{max:n,deviation:r}=tBe(t),{length:i}=t;if(r<.01||i<e*3)return[];const a=[];let o=null,s,l=0;for(let c=0;c<i;c++){const f=t[c];f<n-r?o?(o[2]=c,f<s&&(s=f,l=c),o[1]=l):(s=f,l=c,o=[c,c,c]):o&&(a.push(o),o=null)}return o&&(a[0][0]===0?a[0][0]=o[0]:(o[1]=l,o[2]=i-1,a.push(o))),a}function Xp(t,e,n,r,i){n<e&&(n+=i);const a=n-e,o=Math.ceil(a/r);if(o<=0)return t[t.length-1]!==n&&t.push(d9(n,i)),n;for(let s=1;s<=o;s++){const l=d9(e+s*a/o,i);t.push(l)}return t[t.length-1]}function d9(t,e){return(Math.round(t)+e)%e}function tBe(t){const{length:e}=t;let n=0,r=1/0,i=-1/0,a=0;for(let s=0;s<e;s++){const l=t[s];n+=l,r=Math.min(r,l),i=Math.max(i,l)}const o=n/e;for(let s=0;s<e;s++){const l=t[s]-o;a+=l*l}return{mean:o,max:i,min:r,sumSq:a,deviation:Math.sqrt(a/e)}}function nBe(t){const{parentAnnotationUID:e,annotationUID:n}=t;if(!e)return t.interpolationUID;const r=Ts.getAnnotation(e),{interpolationUID:i}=r,a=r.childAnnotationUIDs.indexOf(n);return t.interpolationUID=`${i}-${a}`,t.interpolationUID}const{PointsManager:gv}=Yr,$U=.2;function vw(t){if(!t.annotation)return;const{isInterpolationUpdate:e,annotation:n}=t;queueMicrotask(()=>{try{e&&(n.isInterpolationUpdate=!0,n.autoGenerated=!1),rBe(t)}finally{e&&(n.autoGenerated=!0)}})}function rBe(t){const{annotation:e}=t;nBe(e);const{interpolationData:n,interpolationList:r}=HUe(e,t)||{};if(!n||!r)return;const i={toolName:e.metadata.toolName,toolType:e.metadata.toolName,viewport:t.viewport};for(let c=0;c<r.length;c++)r[c]&&iBe(r[c].list,r[c].pair,n,i);const{id:a,renderingEngineId:o,element:s}=t.viewport,l={annotation:e,element:s,viewportId:a,renderingEngineId:o};r.length&&wt(t.viewport.element,ee.ANNOTATION_INTERPOLATION_PROCESS_COMPLETED,l)}function iBe(t,e,n,r){const i=n.get(e[0])[0],a=n.get(e[1])[0],o=qU(i.data.contour.polyline),s=qU(a.data.contour.polyline),{c1Interp:l,c2Interp:c}=cBe(o,s);l.kIndex=e[0],c.kIndex=e[1],t.forEach(function(f){aBe(l,c,f,e,n,o.x.length>s.x.length,r)})}function aBe(t,e,n,r,i,a,o){const[s,l]=r,c=(n-s)/(l-s),f=i.get(s)[0],u=i.get(l)[0],d=lBe(t,e,c,a),h=c>.5?u:f,p=ZUe(d);i.has(n)?sBe(d,p,n,h,o):oBe(d,p,n,h,o)}function oBe(t,e,n,r,i){const a=t.points,{viewport:o}=i,s=ine(a,e,r),l=o.getViewReference({sliceIndex:n});if(!l)throw new Error(`Can't find slice ${n}`);Object.assign(s.metadata,l),Ts.addAnnotation(s,o.element),r.onInterpolationComplete?.(s,r);const{parentAnnotationUID:c}=r;if(c){const f=Ts.getAnnotation(c),u=ane(f,n,i);Hte(o,u,s)}}function ane(t,e,n){const{viewport:r}=n,i=Ts.getAnnotations(t.metadata.toolName,r.element);for(let a=0;a<i.length;a++){const o=i[a];if(o.interpolationUID===t.interpolationUID&&o.metadata.sliceIndex===e)return o}}function sBe(t,e,n,r,i){const a=ane(r,n,i),o=t.points,s=ine(o,e,a);Object.assign(a,{metadata:s.metadata,data:s.data})}function lBe(t,e,n,r){const i=r?t.I:e.I,a=gv.fromXYZ(t),o=gv.fromXYZ(e),{length:s}=a,l=gv.create3(s),c=it(),f=it(),u=gv.create3(s);u.kIndex=t.kIndex;const d=gv.create3(s);d.kIndex=e.kIndex;for(let h=0;h<t.x.length;h++)if(i[h]){const p=a.getPoint(h),g=o.getPoint(h);u.push(p),d.push(g),dr(c,g,p),l.push(Ar(f,p,c,n))}return l.sources=[u,d],l}function cBe(t,e){const n=KU(t),r=KU(e),i=Math.max(Math.ceil(n[n.length-1]/$U),Math.ceil(r[r.length-1]/$U)),a=HU(n),o=HU(r),s=i+e.x.length,l=i+t.x.length,c=WU(s,a),f=WU(l,o),u=zU(s-2,t.x.length),d=zU(l-2,e.x.length),h=jU(c,u),p=jU(f,d),g=GU(t,h),m=GU(e,p);return fBe(g,m),uBe(g,m)}function uBe(t,e){const n={x:[],y:[],z:[],I:[]},r={x:[],y:[],z:[],I:[]};for(let i=0;i<t.x.length;i++)(t.I[i]||e.I[i])&&(n.x.push(t.x[i]),n.y.push(t.y[i]),n.z.push(t.z[i]),n.I.push(t.I[i]),r.x.push(e.x[i]),r.y.push(e.y[i]),r.z.push(e.z[i]),r.I.push(e.I[i]));return{c1Interp:n,c2Interp:r}}function fBe(t,e){const n=t.x.length,r={startingNode:0,totalSquaredXYLengths:1/0};for(let a=0;a<n;a++){let o=a,s=0;for(let l=0;l<n;l++)s+=(t.x[o]-e.x[l])**2+(t.y[o]-e.y[l])**2+(t.z[o]-e.z[l])**2,o++,o===n&&(o=0);s<r.totalSquaredXYLengths&&(r.totalSquaredXYLengths=s,r.startingNode=a)}const i=r.startingNode;yb(t.x,i),yb(t.y,i),yb(t.z,i),yb(t.I,i)}function yb(t,e){e-=t.length*Math.floor(e/t.length);const n=t.splice(0,e);return t.push(...n),t}function GU(t,e){const n={x:[],y:[],z:[],I:[]};for(let r=0;r<t.x.length-1;r++){n.x.push(t.x[r]),n.y.push(t.y[r]),n.z.push(t.z[r]),n.I.push(!0);const i=(t.x[r+1]-t.x[r])/(e[r]+1),a=(t.y[r+1]-t.y[r])/(e[r]+1),o=(t.z[r+1]-t.z[r])/(e[r]+1);for(let s=0;s<e[r]-1;s++)n.x.push(n.x[n.x.length-1]+i),n.y.push(n.y[n.y.length-1]+a),n.z.push(n.z[n.z.length-1]+o),n.I.push(!1)}return n}function jU(t,e){const n=[];for(let o=0;o<t.length;++o)n[o]=o;n.sort(function(o,s){return t[o]<t[s]?-1:1});const r=[];for(let o=0;o<e.length;o++)r.push(e[n[o]]);const i=r.reduce(function(o,s,l){return s&&o.push(l),o},[]),a=[];for(let o=0;o<i.length-1;o++)a.push(i[o+1]-i[o]);return a}function zU(t,e){const n=new Array(t+e);return n.fill(!1,0,t),n.fill(!0,t,t+e),n}function WU(t,e){const n=1/(t-1),r=[n];for(let i=1;i<t-2;i++)r.push(r[r.length-1]+n);return r.concat(e)}function HU(t){const e=[];for(let n=0;n<t.length;n++)e.push(t[n]/t[t.length-1]);return e}function KU(t){const e=[0];for(let n=1;n<t.x.length;n++){const r=Math.sqrt((t.x[n]-t.x[n-1])**2+(t.y[n]-t.y[n-1])**2+(t.z[n]-t.z[n-1])**2);e.push(e[n-1]+r)}return e}function qU(t){const e={x:[],y:[],z:[]};for(let n=0;n<t.length;n++)e.x[n]=t[n][0],e.y[n]=t[n][1],e.z[n]=t[n][2];return e.x.push(e.x[0]),e.y.push(e.y[0]),e.z.push(e.z[0]),e}function XU(t){const{annotation:e}=t,n=qO(t,[{key:"interpolationUID",value:t.interpolationUID}]),r=e.metadata.sliceIndex;let i=-1,a=t.sliceData.numberOfSlices;for(const[s,l]of n.entries())s===r||!l.find(f=>!f.autoGenerated)||(s<r?i=Math.max(s,i):a=Math.min(s,a));const o=[];for(const[s,l]of n.entries())s<=i||s>=a||s===r||l.forEach(c=>{c.autoGenerated&&(Ts.removeAnnotation(c.annotationUID),o.push(c))});if(o.length){const s={annotations:o,element:t.viewport.element,viewportId:t.viewport.id,renderingEngineId:t.viewport.getRenderingEngine().id};wt(t.viewport.element,ee.INTERPOLATED_ANNOTATIONS_REMOVED,s)}if(i>=0&&a<t.sliceData.numberOfSlices){const s=n.get(a)[0],l={viewport:t.viewport,sliceData:{numberOfSlices:t.sliceData.numberOfSlices,imageIndex:s.metadata.sliceIndex},annotation:s,interpolationUID:s.interpolationUID};vw(l)}}function L8(t){const e=Xte(t);return e.length?e[0]:void 0}const{uuidv4:dBe}=Yr,hBe=[xn.HandlesUpdated,xn.InterpolationUpdated],Pl=class Pl{static addTool(e){this.toolNames.includes(e)||this.toolNames.push(e)}static acceptAutoGenerated(e,n={}){const{toolNames:r,segmentationId:i,segmentIndex:a,sliceIndex:o}=n;for(const s of r||Pl.toolNames){const l=Ts.getAnnotations(s,e);if(l?.length)for(const c of l){const{interpolationUID:f,data:u,autoGenerated:d,metadata:h}=c;f&&(c.interpolationCompleted=!0),d&&(a&&a!==u.segmentation.segmentIndex||o!==void 0&&h&&o!==h.sliceIndex||i&&i!==u.segmentation.segmentationId||(u0(c),c.autoGenerated=!1))}}}};Pl.toolNames=[],Pl.handleAnnotationCompleted=e=>{const n=e.detail.annotation;if(!n?.metadata)return;const{toolName:r,originalToolName:i}=n.metadata;if(!Pl.toolNames.includes(r)&&!Pl.toolNames.includes(i))return;const a=L8(n);if(!a){console.warn("Unable to find viewport for",n);return}const o=k8(a),s={viewport:a,sliceData:o,annotation:n,interpolationUID:n.interpolationUID},l=!!n.interpolationUID;if(n.autoGenerated=!1,l){XU(s),vw(s);return}const c=[{key:"segmentIndex",value:n.data.segmentation.segmentIndex,parentKey:h=>h.data.segmentation},{key:"viewPlaneNormal",value:n.metadata.viewPlaneNormal,parentKey:h=>h.metadata},{key:"viewUp",value:n.metadata.viewUp,parentKey:h=>h.metadata}];let f=WUe(s,c);const{sliceIndex:u}=n.metadata,d=new Set;f.forEach(h=>{if(h.interpolationCompleted||h.metadata.sliceIndex===u){const{interpolationUID:p}=h;d.add(p)}}),f=f.filter(h=>!d.has(h.interpolationUID)),n.interpolationUID=f[0]?.interpolationUID||dBe(),s.interpolationUID=n.interpolationUID,vw(s)},Pl.handleAnnotationUpdate=e=>{const n=e.detail.annotation,{changeType:r=xn.HandlesUpdated}=e.detail;if(!n?.metadata)return;const{toolName:i,originalToolName:a}=n.metadata;if(!Pl.toolNames.includes(i)&&!Pl.toolNames.includes(a)||!hBe.includes(r))return;const o=L8(n);if(!o){console.warn("Unable to find matching viewport for annotation interpolation",n);return}n.autoGenerated&&(u0(n),n.autoGenerated=!1);const s=k8(o),l={viewport:o,sliceData:s,annotation:n,interpolationUID:n.interpolationUID,isInterpolationUpdate:r===xn.InterpolationUpdated};vw(l)},Pl.handleAnnotationDelete=e=>{const n=e.detail.annotation;if(!n?.metadata)return;const{toolName:r}=n.metadata;if(!Pl.toolNames.includes(r)||n.autoGenerated)return;const i=L8(n);if(!i){console.warn("No viewport, can't delete interpolated results",n);return}const a=k8(i),o={viewport:i,sliceData:a,annotation:n,interpolationUID:n.interpolationUID};n.autoGenerated=!1,XU(o)};let Pf=Pl;function k8(t){return{numberOfSlices:t.getNumberOfSlices(),imageIndex:t.getCurrentImageIdIndex()}}function pBe(t){t.forEach(e=>{const n=jh(e);if(!n){console.warn(`ToolGroup not available for ${e}`);return}n.getViewportsInfo().forEach(i=>{const{renderingEngineId:a,viewportId:o}=i,s=zf(a);if(!s){console.warn(`RenderingEngine not available for ${a}`);return}const l=s.getViewport(o);Ky(l.element)})})}function qy(t){const e=ea(t);if(!e)throw new Error(`No segmentation state found for ${t}`);const{segments:n}=e;return Object.keys(n).filter(i=>n[i].locked).map(i=>parseInt(i))}function gBe(){return Ps.getNextColorLUTIndex()}const h9=[[0,0,0,0],[221,84,84,255],[77,228,121,255],[166,70,235,255],[189,180,116,255],[109,182,196,255],[204,101,157,255],[123,211,94,255],[93,87,218,255],[225,128,80,255],[73,232,172,255],[181,119,186,255],[176,193,112,255],[105,153,200,255],[208,97,120,255],[90,215,101,255],[135,83,222,255],[229,178,76,255],[122,183,181,255],[190,115,171,255],[149,197,108,255],[100,118,205,255],[212,108,93,255],[86,219,141,255],[183,79,226,255],[233,233,72,255],[118,167,187,255],[194,111,146,255],[116,201,104,255],[115,96,209,255],[216,147,89,255],[82,223,188,255],[230,75,224,255],[163,184,121,255],[114,143,191,255],[198,107,114,255],[99,206,122,255],[153,92,213,255],[220,192,85,255],[78,215,227,255],[234,71,173,255],[141,188,117,255],[110,113,195,255],[202,128,103,255],[95,210,157,255],[195,88,217,255],[206,224,81,255],[74,166,231,255],[185,120,139,255],[113,192,113,255],[133,106,199,255],[207,162,98,255],[91,214,198,255],[221,84,198,255],[159,228,77,255],[70,111,235,255],[189,119,116,255],[109,196,138,255],[165,101,204,255],[211,201,94,255],[87,191,218,255],[225,80,153,255],[106,232,73,255],[124,119,186,255],[193,142,112,255],[105,200,168,255],[203,97,208,255],[184,215,90,255],[83,147,222,255],[229,76,101,255],[122,183,130,255],[146,115,190,255],[197,171,108,255],[100,205,205,255],[212,93,177,255],[141,219,86,255],[79,97,226,255],[233,99,72,255],[118,187,150,255],[173,111,194,255],[197,201,104,255],[96,171,209,255],[216,89,137,255],[94,223,82,255],[107,75,230,255],[184,153,121,255],[114,191,175,255],[198,107,191,255],[166,206,99,255],[92,132,213,255],[220,85,91,255],[78,227,115,255],[159,71,234,255],[188,176,117,255],[110,185,195,255],[202,103,161,255],[129,210,95,255],[88,88,217,255],[224,123,81,255],[74,231,166,255],[177,120,185,255],[179,192,113,255],[106,156,199,255],[207,98,125,255],[91,214,96,255],[130,84,221,255],[228,171,77,255],[70,235,221,255],[189,116,174,255],[153,196,109,255],[101,123,204,255],[211,104,94,255],[87,218,136,255],[177,80,225,255],[232,225,73,255],[119,169,186,255],[193,112,149,255],[121,200,105,255],[111,97,208,255],[215,142,90,255],[83,222,181,255],[229,76,229,255],[165,183,122,255],[115,146,190,255],[197,108,119,255],[100,205,118,255],[148,93,212,255],[219,186,86,255],[79,220,226,255],[233,72,179,255],[144,187,118,255],[111,118,194,255],[201,124,104,255],[96,209,153,255],[189,89,216,255],[211,223,82,255],[75,172,230,255],[184,121,142,255],[117,191,114,255],[130,107,198,255],[206,157,99,255],[92,213,193,255],[220,85,203,255],[165,227,78,255],[71,118,234,255],[188,117,117,255],[110,195,135,255],[161,103,202,255],[210,195,95,255],[88,195,217,255],[224,81,158,255],[113,231,74,255],[123,120,185,255],[192,139,113,255],[106,199,164,255],[198,98,207,255],[188,214,91,255],[84,153,221,255],[228,77,108,255],[70,235,84,255],[143,116,189,255],[196,167,109,255],[101,204,199,255],[211,94,182,255],[147,218,87,255],[80,104,225,255],[232,93,73,255],[119,186,147,255],[170,112,193,255],[200,200,105,255],[97,175,208,255],[215,90,142,255],[100,222,83,255],[101,76,229,255],[183,150,122,255],[115,190,171,255],[197,108,194,255],[170,205,100,255],[93,138,212,255],[219,86,97,255],[79,226,110,255],[153,72,233,255],[187,173,118,255],[111,187,194,255],[201,104,165,255],[134,209,96,255],[89,95,216,255],[223,117,82,255],[75,230,159,255],[174,121,184,255],[182,191,114,255],[107,160,198,255],[206,99,130,255],[92,213,92,255],[124,85,220,255],[227,165,78,255],[71,234,214,255],[188,117,176,255],[156,195,110,255],[103,128,202,255],[210,100,95,255],[88,217,131,255],[170,81,224,255],[231,218,74,255],[120,172,185,255],[192,113,153,255],[125,199,106,255],[107,98,207,255],[214,137,91,255],[84,221,175,255],[222,77,228,255],[194,235,70,255],[116,149,189,255],[196,109,123,255],[101,204,114,255],[143,94,211,255],[218,180,87,255],[80,225,225,255],[232,73,186,255],[147,186,119,255],[112,122,193,255],[200,121,105,255],[97,208,148,255],[184,90,215,255],[216,222,83,255],[76,178,229,255],[183,122,145,255],[121,190,115,255],[126,108,197,255],[205,153,100,255],[93,212,187,255],[219,86,208,255],[171,226,79,255],[72,126,233,255],[187,118,121,255],[111,194,132,255],[157,104,201,255],[209,190,96,255],[89,200,216,255],[223,82,164,255],[120,230,75,255],[121,121,184,255],[191,136,114,255],[107,198,160,255],[192,99,206,255],[193,213,92,255],[85,158,220,255],[227,78,115,255],[71,234,78,255],[141,117,188,255],[195,163,110,255],[103,202,194,255],[210,95,186,255],[153,217,88,255],[81,111,224,255]];function V8(t,e){const n=Ps,r=e??gBe();let i=[...t];if(pr(i[0],[0,0,0,0])||(console.warn("addColorLUT: [0, 0, 0, 0] color is not provided for the background color (segmentIndex =0), automatically adding it"),i=[[0,0,0,0],...i]),i=i.map(a=>a.length===3?[a[0],a[1],a[2],255]:a),i.length<255){const a=h9.slice(i.length);i=[...i,...a]}return n.addColorLUT(i,r),r}function Wh(t,e,n){const r=Yd(t,{segmentationId:e});if(!r||r.length===0)return null;const i=r[0],{colorLUTIndex:a}=i,o=RO(a);let s=o[n];if(!s){if(typeof n!="number")return console.warn(`Can't create colour for LUT index ${n}`),null;s=o[n]=[0,0,0,0]}return s}function mBe(t,e,n,r){const i=Wh(t,e,n);for(let a=0;a<r.length;a++)i[a]=r[a];Lv(t,e)}function vBe(t,e){return Ps.getSegmentationRepresentationVisibility(t,e)}function yBe({segmentationId:t,segmentIndex:e,viewportId:n,autoGenerated:r=!1}){const i=Wh(n,t,e),a=vBe(n,{segmentationId:t,type:hn.Contour}),s=ly(n)?.segmentationId===t,c=nm.getStyle({viewportId:n,segmentationId:t,type:hn.Contour,segmentIndex:e});let f=1,u,d=1,h=0;r?(f=c.outlineWidthAutoGenerated??f,u=c.outlineDashAutoGenerated??u,d=c.outlineOpacity??d,h=c.fillAlphaAutoGenerated??h):s?(f=c.outlineWidth??f,u=c.outlineDash??u,d=c.outlineOpacity??d,h=c.fillAlpha??h):(f=c.outlineWidthInactive??f,u=c.outlineDashInactive??u,d=c.outlineOpacityInactive??d,h=c.fillAlphaInactive??h),Su(t)===e&&(f+=c.activeSegmentOutlineWidthDelta),f=c.renderOutline?f:0,h=c.renderFill?h:0;const p=`rgba(${i[0]}, ${i[1]}, ${i[2]}, ${d})`,g=`rgb(${i[0]}, ${i[1]}, ${i[2]})`,y=!AO(n,{segmentationId:t,type:hn.Contour}).has(e);return{color:p,fillColor:g,lineWidth:f,fillOpacity:h,lineDash:u,textbox:{color:p},visibility:a&&y}}const dM=class dM extends zUe{constructor(e,n){super(e,n),this.configuration.interpolation?.enabled&&Pf.addTool(this.getToolName())}isContourSegmentationTool(){return!0}createAnnotation(e){const n=e.detail,{element:r}=n,i=Xe(r);if(!i)return;const{viewport:a}=i,o=super.createAnnotation(e);if(!this.isContourSegmentationTool())return o;const s=ly(a.id);if(!s)throw new Error("No active segmentation detected, create one before using scissors tool");if(!s.representationData.Contour)throw new Error("A contour segmentation must be active");const{segmentationId:l}=s,c=Su(l);return No(o,{data:{segmentation:{segmentationId:l,segmentIndex:c}}})}addAnnotation(e,n){const r=super.addAnnotation(e,n);return this.isContourSegmentationTool()&&u0(e),r}cancelAnnotation(e){this.isContourSegmentationTool()&&c0(e),super.cancelAnnotation(e)}getAnnotationStyle(e){const n=super.getAnnotationStyle(e);if(!this.isContourSegmentationTool())return n;const r=this._getContourSegmentationStyle(e);return No(n,r)}renderAnnotationInstance(e){const{annotation:n}=e,{invalidated:r}=n,i=super.renderAnnotationInstance(e);if(r&&this.isContourSegmentationTool()){const{segmentationId:a}=n.data.segmentation;Wf(a);const s=gS(a).map(l=>to(l).id);pBe(s)}return i}_getContourSegmentationStyle(e){const n=e.annotation,{segmentationId:r,segmentIndex:i}=n.data.segmentation,{viewportId:a}=e.styleSpecifier,o=Yd(a,{segmentationId:r});if(!o?.length)return{};o.length>1?o.find(m=>m.segmentationId===r&&m.type===hn.Contour):o[0];const{autoGenerated:s}=n,c=qy(r).includes(i),{color:f,fillColor:u,lineWidth:d,fillOpacity:h,lineDash:p,visibility:g}=yBe({segmentationId:r,segmentIndex:i,viewportId:a,autoGenerated:s});return{color:f,fillColor:u,lineWidth:d,fillOpacity:h,lineDash:p,textbox:{color:f},visibility:g,locked:c}}};dM.PreviewSegmentIndex=255;let cy=dM;function xBe(t,e){const n=Ut("generalSeriesModule",t);return np(n.modality,t,e)}function np(t,e,n){return t==="CT"?"HU":t==="PT"?bBe(e,n):""}function bBe(t,e){return e.isPreScaled?e.isSuvScaled?"SUV":Ut("generalSeriesModule",t)?.modality==="PT"?Ut("petSeriesModule",t)?.units||"unitless":"unknown":"raw"}const{pointCanProjectOnLine:YU}=ep,{EPSILON:wBe}=Xh,CBe=1-wBe,hM=class hM extends cy{constructor(e={},n={supportedInteractionTypes:["Mouse","Touch"],configuration:{storePointData:!1,shadow:!0,preventHandleOutsideImage:!1,contourHoleAdditionModifierKey:La.Shift,alwaysRenderOpenContourHandles:{enabled:!1,radius:2},allowOpenContours:!0,closeContourProximity:10,checkCanvasEditFallbackProximity:6,makeClockWise:!0,subPixelResolution:4,smoothing:{smoothOnAdd:!1,smoothOnEdit:!1,knotsRatioPercentageOnAdd:40,knotsRatioPercentageOnEdit:40},interpolation:{enabled:!1,onInterpolationComplete:null},decimate:{enabled:!1,epsilon:.1},displayOnePointAsCrosshairs:!1,calculateStats:!0,getTextLines:SBe,statsCalculator:f0}}){super(e,n),this.isDrawing=!1,this.isEditingClosed=!1,this.isEditingOpen=!1,this.addNewAnnotation=r=>{const i=r.detail,{element:a}=i,o=this.createAnnotation(r);this.addAnnotation(o,a);const s=fn(a,this.getToolName());return this.activateDraw(r,o,s),r.preventDefault(),at(s),o},this.handleSelectedCallback=(r,i,a)=>{const o=r.detail,{element:s}=o,l=fn(s,this.getToolName());this.activateOpenContourEndEdit(r,i,l,a)},this.toolSelectedCallback=(r,i)=>{const a=r.detail,{element:o}=a,s=fn(o,this.getToolName());i.data.contour.closed?this.activateClosedContourEdit(r,i,s):this.activateOpenContourEdit(r,i,s),r.preventDefault()},this.isPointNearTool=(r,i,a,o)=>{const s=Xe(r),{viewport:l}=s,{polyline:c}=i.data.contour;let f=l.worldToCanvas(c[0]);for(let h=1;h<c.length;h++){const p=f,g=l.worldToCanvas(c[h]);if(YU(a,p,g,o))return!0;f=g}if(!i.data.contour.closed)return!1;const u=l.worldToCanvas(c[0]),d=l.worldToCanvas(c[c.length-1]);return YU(a,u,d,o)},this.cancel=r=>{const i=this.isDrawing,a=this.isEditingOpen,o=this.isEditingClosed;i?this.cancelDrawing(r):a?this.cancelOpenContourEdit(r):o&&this.cancelClosedContourEdit(r)},this._calculateCachedStats=(r,i,a,o)=>{const{data:s}=r,{cachedStats:l}=s,{polyline:c,closed:f}=s.contour,u=Object.keys(l);for(let h=0;h<u.length;h++){const p=u[h],g=this.getTargetImageData(p);if(!g)continue;const{imageData:m,metadata:y}=g,v=c.map(P=>i.worldToCanvas(P)),x={isPreScaled:r1(i,p),isSuvScaled:this.isSuvScaled(i,p,r.metadata.referencedImageId)},w=np(y.Modality,r.metadata.referencedImageId,x),S=Cc(g,()=>{const P=s.contour.polyline,N=P.length,A=new Array(N);for(let ne=0;ne<N;ne++)A[ne]=i.worldToCanvas(P[ne]);const{maxX:B,maxY:V,minX:$,minY:U}=xm(A),G=i.canvasToWorld([$,U]),F=fo(m,G),J=i.canvasToWorld([B,V]),Q=fo(m,J);return[F,Q]}),T=v[0],_=i.canvasToWorld(T),D=i.canvasToWorld([T[0]+1,T[1]]),I=i.canvasToWorld([T[0],T[1]+1]),R=ol(_,D),O=ol(_,I);f?this.updateClosedCachedStats({targetId:p,viewport:i,canvasCoordinates:v,points:c,imageData:m,metadata:y,cachedStats:l,modalityUnit:w,calibratedScale:S,deltaInX:R,deltaInY:O}):this.updateOpenCachedStats({metadata:y,canvasCoordinates:v,targetId:p,cachedStats:l,modalityUnit:w,calibratedScale:S,deltaInX:R,deltaInY:O})}const d=r.invalidated;return r.invalidated=!1,d&&Un(r,o.viewport.element,xn.StatsUpdated),l},this._renderStats=(r,i,a,o)=>{const{data:s}=r,l=this.getTargetId(i),c={toolGroupId:this.toolGroupId,toolName:this.getToolName(),viewportId:a.viewport.id,annotationUID:r.annotationUID},f=this.getLinkedTextBoxStyle(c,r);if(!f.visibility)return;const u=this.configuration.getTextLines(s,l);if(!u||u.length===0)return;const d=s.contour.polyline.map(w=>i.worldToCanvas(w));if(!s.handles.textBox.hasMoved){const w=Iu(d);s.handles.textBox.worldPosition=i.canvasToWorld(w)}const h=i.worldToCanvas(s.handles.textBox.worldPosition),g=cl(o,r.annotationUID??"","1",u,h,d,{},f),{x:m,y,width:v,height:x}=g;s.handles.textBox.worldBoundingBox={topLeft:i.canvasToWorld([m,y]),topRight:i.canvasToWorld([m+v,y]),bottomLeft:i.canvasToWorld([m,y+x]),bottomRight:i.canvasToWorld([m+v,y+x])}},XFe(this),rUe(this),hUe(this),_Ue(this),MUe(this),GUe(this),this._throttledCalculateCachedStats=Wl(this._calculateCachedStats,100,{trailing:!0})}filterInteractableAnnotationsForElement(e,n){if(!n||!n.length)return;const r=Xe(e),{viewport:i}=r;let a;if(i instanceof da){const o=i.getCamera(),{spacingInNormalDirection:s}=Vy(i,o);a=this.filterAnnotationsWithinSlice(n,o,s)}else a=zO(i,n);return a}filterAnnotationsWithinSlice(e,n,r){const{viewPlaneNormal:i}=n,a=e.filter(c=>{let f=c.metadata.viewPlaneNormal;if(!c.metadata.referencedImageId&&!f&&c.metadata.FrameOfReferenceUID){for(const d of c.data.contour.polyline){const h=dr(it(),d,n.focalPoint),p=zt(h,n.viewPlaneNormal);if(!pr(p,0))return!1}return c.metadata.viewPlaneNormal=n.viewPlaneNormal,c.metadata.cameraFocalPoint=n.focalPoint,!0}if(!f){const{referencedImageId:d}=c.metadata,{imageOrientationPatient:h}=Ut("imagePlaneModule",d),p=Sn(h[0],h[1],h[2]),g=Sn(h[3],h[4],h[5]);f=it(),gr(f,p,g),c.metadata.viewPlaneNormal=f}const u=Math.abs(zt(i,f))>CBe;return f&&u});if(!a.length)return[];const o=r/2,{focalPoint:s}=n,l=[];for(const c of a){const u=c.data.contour.polyline[0];if(!c.isVisible)continue;const d=it();dr(d,s,u);const h=zt(d,i);Math.abs(h)<o&&l.push(c)}return l}isContourSegmentationTool(){return!1}createAnnotation(e){const n=e.detail.currentPoints.world,r=super.createAnnotation(e),i=o=>{o.data.handles.points.length=0};return No(r,{data:{contour:{polyline:[[...n]]},label:"",cachedStats:{}},onInterpolationComplete:i})}getAnnotationStyle(e){return super.getAnnotationStyle(e)}renderAnnotationInstance(e){const{enabledElement:n,targetId:r,svgDrawingHelper:i}=e,a=e.annotation;let o=!1;const{viewport:s,renderingEngine:l}=n,c=this.isDrawing,f=this.isEditingOpen,u=this.isEditingClosed;if(!(c||f||u))this.configuration.displayOnePointAsCrosshairs&&a.data.contour.polyline.length===1?this.renderPointContourWithMarker(n,i,a):this.renderContour(n,i,a);else{const d=this.commonData.annotation.annotationUID;if(a.annotationUID===d)if(c)this.renderContourBeingDrawn(n,i,a);else if(u)this.renderClosedContourBeingEdited(n,i,a);else if(f)this.renderOpenContourBeingEdited(n,i,a);else throw new Error(`Unknown ${this.getToolName()} annotation rendering state`);else this.configuration.displayOnePointAsCrosshairs&&a.data.contour.polyline.length===1?this.renderPointContourWithMarker(n,i,a):this.renderContour(n,i,a);o=!0}if(this.configuration.calculateStats)return this._calculateStatsIfActive(a,r,s,l,n),this._renderStats(a,s,n,i),o}_calculateStatsIfActive(e,n,r,i,a){const o=this.commonData?.annotation.annotationUID;if(!(e.annotationUID===o&&!this.commonData?.movingTextBox)&&!this.commonData?.movingTextBox){const{data:s}=e;s.cachedStats[n]?.unit?e.invalidated&&this._throttledCalculateCachedStats(e,r,i,a):(s.cachedStats[n]={Modality:null,area:null,max:null,mean:null,stdDev:null,areaUnit:null,unit:null},this._calculateCachedStats(e,r,i,a))}}updateClosedCachedStats({viewport:e,points:n,imageData:r,metadata:i,cachedStats:a,targetId:o,modalityUnit:s,canvasCoordinates:l,calibratedScale:c,deltaInX:f,deltaInY:u}){const{scale:d,areaUnit:h,unit:p}=c,{voxelManager:g}=e.getImageData(),m=fo(r,n[0]);m[0]=Math.floor(m[0]),m[1]=Math.floor(m[1]),m[2]=Math.floor(m[2]);let y=m[0],v=m[0],x=m[1],w=m[1],S=m[2],T=m[2];for(let J=1;J<n.length;J++){const Q=fo(r,n[J]);Q[0]=Math.floor(Q[0]),Q[1]=Math.floor(Q[1]),Q[2]=Math.floor(Q[2]),y=Math.min(y,Q[0]),v=Math.max(v,Q[0]),x=Math.min(x,Q[1]),w=Math.max(w,Q[1]),S=Math.min(S,Q[2]),T=Math.max(T,Q[2])}const _=fo(r,n[1]);_[0]=Math.floor(_[0]),_[1]=Math.floor(_[1]),_[2]=Math.floor(_[2]);let D=Hy(l)/d/d;D*=f*u;let I=FU(l,closed)/d;I*=Math.sqrt(Math.pow(f,2)+Math.pow(u,2));const R=.01*(v-y),O=.01*(w-x),P=.01*(T-S);y=Math.floor(y-R),v=Math.ceil(v+R),x=Math.floor(x-O),w=Math.ceil(w+O),S=Math.floor(S-P),T=Math.ceil(T+P);const N=[[y,v],[x,w],[S,T]],A=r.indexToWorld([v,w,T]),B=e.worldToCanvas(A);let V=0,$=[],U=0,G;g&&(G=g.forEach(this.configuration.statsCalculator.statsCallback,{imageData:r,isInObject:(J,Q)=>{let ne=!0;const ye=e.worldToCanvas(J);return ye[1]!=V&&(U=0,V=ye[1],$=Gte(l,ye,[B[0],ye[1]]),$.sort((function(ve){return function(Ce,we){return Ce[ve]===we[ve]?0:Ce[ve]<we[ve]?-1:1}})(0))),$.length&&ye[0]>$[0][0]&&($.shift(),U++),U%2===0&&(ne=!1),ne},boundsIJK:N,returnPoints:this.configuration.storePointData}));const F=this.configuration.statsCalculator.getStatistics();a[o]={Modality:i.Modality,area:D,perimeter:I,mean:F.mean?.value,max:F.max?.value,min:F.min?.value,stdDev:F.stdDev?.value,statsArray:F.array,pointsInShape:G,areaUnit:h,modalityUnit:s,unit:p}}updateOpenCachedStats({targetId:e,metadata:n,canvasCoordinates:r,cachedStats:i,modalityUnit:a,calibratedScale:o,deltaInX:s,deltaInY:l}){const{scale:c,unit:f}=o;let u=FU(r,closed)/c;u*=Math.sqrt(Math.pow(s,2)+Math.pow(l,2)),i[e]={Modality:n.Modality,length:u,modalityUnit:a,unit:f}}};hM.toolName="PlanarFreehandROI";let vh=hM;function SBe(t,e){const n=t.cachedStats[e],{area:r,mean:i,stdDev:a,length:o,perimeter:s,max:l,min:c,isEmptyArea:f,unit:u,areaUnit:d,modalityUnit:h}=n||{},p=[];if(hi(r)){const g=f?"Area: Oblique not supported":`Area: ${Vn(r)} ${d}`;p.push(g)}return hi(i)&&p.push(`Mean: ${Vn(i)} ${h}`),hi(l)&&p.push(`Max: ${Vn(l)} ${h}`),hi(c)&&p.push(`Min: ${Vn(c)} ${h}`),hi(a)&&p.push(`Std Dev: ${Vn(a)} ${h}`),hi(s)&&p.push(`Perimeter: ${Vn(s)} ${u}`),hi(o)&&p.push(`${Vn(o)} ${u}`),p}const pM=class pM extends vh{constructor(e){const n=No({configuration:{calculateStats:!1,allowOpenContours:!1}},e);super(n)}isContourSegmentationTool(){return!0}renderAnnotationInstance(e){const n=e.annotation,{invalidated:r}=n,i=super.renderAnnotationInstance(e);if(r){const{segmentationId:a}=n.data.segmentation;Wf(a)}return i}};pM.toolName="PlanarFreehandContourSegmentationTool";let G3=pM;const TBe={[hn.Labelmap]:hFe,[hn.Contour]:nFe,[hn.Surface]:lke},xb=G3.toolName;class EBe{constructor(){this._needsRender=new Set,this._pendingRenderQueue=[],this._animationFrameSet=!1,this._animationFrameHandle=null,this._getAllViewports=()=>jl().flatMap(n=>n.getViewports()),this._renderFlaggedSegmentations=()=>{if(this._throwIfDestroyed(),Array.from(this._needsRender).forEach(n=>{this._triggerRender(n)}),this._needsRender.clear(),this._animationFrameSet=!1,this._animationFrameHandle=null,this._pendingRenderQueue.length>0){const n=this._pendingRenderQueue.shift();n&&n.length>0&&this._setViewportsToBeRenderedNextFrame(n)}}}renderSegmentationsForViewport(e){const n=e?[e]:this._getViewportIdsForSegmentation();this._setViewportsToBeRenderedNextFrame(n)}renderSegmentation(e){const n=this._getViewportIdsForSegmentation(e);this._setViewportsToBeRenderedNextFrame(n)}_getViewportIdsForSegmentation(e){const n=this._getAllViewports(),r=[];for(const i of n){const a=i.id;e?Yd(a,{segmentationId:e})?.length>0&&r.push(a):Yd(a)?.length>0&&r.push(a)}return r}_throwIfDestroyed(){if(this.hasBeenDestroyed)throw new Error("this.destroy() has been manually called to free up memory, can not longer use this instance. Instead make a new one.")}_setViewportsToBeRenderedNextFrame(e){if(this._animationFrameSet){this._pendingRenderQueue.push(e);return}e.forEach(n=>{this._needsRender.add(n)}),this._render()}_render(){this._needsRender.size>0&&this._animationFrameSet===!1&&(this._animationFrameHandle=window.requestAnimationFrame(this._renderFlaggedSegmentations),this._animationFrameSet=!0)}_triggerRender(e){const n=Yd(e);if(!n?.length)return;const{viewport:r}=xr(e)||{};if(!r)return;const i=[],a=n.map(o=>{o.type===hn.Contour&&this._addPlanarFreeHandToolIfAbsent(r);const s=TBe[o.type];try{const l=s.render(r,o);i.push(l)}catch(l){console.error(l)}return Promise.resolve({segmentationId:o.segmentationId,type:o.type})});Promise.allSettled(a).then(o=>{const s=o.filter(f=>f.status==="fulfilled").map(f=>f.value);function l(f){const{element:u,viewportId:d}=f.detail;u.removeEventListener(mt.IMAGE_RENDERED,l),s.forEach(h=>{const p={viewportId:d,segmentationId:h.segmentationId,type:h.type};wt(vt,ee.SEGMENTATION_RENDERED,{...p})})}r.element.addEventListener(mt.IMAGE_RENDERED,l),r.render()})}_addPlanarFreeHandToolIfAbsent(e){xb in Dt.tools||Qr(G3);const n=to(e.id);n.hasTool(xb)||(n.addTool(xb),n.setToolPassive(xb))}}function one(t){lne.renderSegmentationsForViewport(t)}function sne(t){lne.renderSegmentation(t)}const lne=new EBe;function _Be({modifiedSlicesToUse:t,representationData:e,type:n}){const r=yt.getVolume(e[n].volumeId);if(!r){console.warn("segmentation not found in cache");return}const{imageData:i,vtkOpenGLTexture:a}=r;let o;if(t?.length>0)o=t;else{const s=i.getDimensions()[2];o=[...Array(s).keys()]}o.forEach(s=>{a.setUpdatedFrame(s)}),i.modified()}function DBe({viewportIds:t,segmentationId:e}){t.forEach(n=>{let r=Yd(n,{segmentationId:e});r=r.filter(i=>i.type===hn.Labelmap),r.forEach(i=>{if(i.segmentationId!==e)return;const a=xr(n);if(!a)return;const{viewport:o}=a;if(o instanceof da)return;const s=u2(n,e);s?.length&&s.forEach((l,c)=>{const f=l.actor.getMapper().getInputData(),u=bm(n,e),d=yt.getImage(u[c]);f.modified(),tS(f,d)})})})}const OBe=function(t){const{segmentationId:e,modifiedSlicesToUse:n}=t.detail,{representationData:r}=ea(e),i=gS(e),a=i.some(l=>{const{viewport:c}=xr(l);return c instanceof da}),o=i.some(l=>{const{viewport:c}=xr(l);return c instanceof fa}),s=a&&o;i.forEach(l=>{const{viewport:c}=xr(l);c instanceof da&&_Be({modifiedSlicesToUse:s?[]:n,representationData:r,type:hn.Labelmap}),c instanceof fa&&DBe({viewportIds:i,segmentationId:e})})},cne=function(t){const{segmentationId:e}=t.detail,{representationData:n}=ea(e);n.Labelmap&&OBe(t),sne(e)},une=function(t){const{segmentationId:e}=t.detail;sne(e)};function MBe(t,e){return Ps.updateLabelmapSegmentationImageReferences(t,e)}const IBe=function(t){if(!t)return;const e=Xe(t);if(!e)return;const{viewport:n}=e;n instanceof mo||(t.addEventListener(mt.PRE_STACK_NEW_IMAGE,uy),t.addEventListener(mt.IMAGE_RENDERED,uy))},RBe=function(t){t.removeEventListener(mt.PRE_STACK_NEW_IMAGE,uy),t.removeEventListener(mt.IMAGE_RENDERED,uy)};function uy(t){const e=t.detail,{viewportId:n,renderingEngineId:r}=e,{viewport:i}=Ym(n,r),a=Yd(n);if(!a?.length)return;const o=a.filter(c=>c.type===hn.Labelmap),s=i.getActors();o.forEach(c=>{const{segmentationId:f}=c;MBe(n,f)});const l=o.flatMap(c=>u2(n,c.segmentationId)).filter(c=>c!==void 0);l.length&&(l.forEach(c=>{o.find(u=>bm(n,u.segmentationId)?.includes(c.referencedId))||i.removeActors([c.uid])}),o.forEach(c=>{const{segmentationId:f}=c,u=i.getCurrentImageId(),d=bm(n,f);if(!d)return;let h=!1;const p=g=>{const m=yt.getImage(g);if(!m){console.warn("No derived image found in the cache for segmentation representation",c);return}const y=s.find(v=>v.referencedId===g);if(y){const v=y.actor.getMapper().getInputData();v.setDerivedImage?v.setDerivedImage(m):tS(v,m)}else{const{dimensions:v,spacing:x,direction:w}=i.getImageDataMetadata(m),S=yt.getImage(u)||{imageId:u},{origin:T}=i.getImageDataMetadata(S),_=T,D=m.voxelManager.getConstructor(),I=m.voxelManager.getScalarData(),R=tn.newInstance({name:"Pixels",numberOfComponents:1,values:new D(I)}),O=KC.newInstance();O.setDimensions(v[0],v[1],1),O.setSpacing(x),O.setDirection(w),O.setOrigin(_),O.getPointData().setScalars(R),O.modified(),i.addImages([{imageId:g,representationUID:`${f}-${hn.Labelmap}-${m.imageId}`,callback:({imageActor:P})=>{P.getMapper().setInputData(O)}}]),h=!0;return}};d.forEach(p),h&&one(n),i.render(),t.type===mt.IMAGE_RENDERED&&i.element.removeEventListener(mt.IMAGE_RENDERED,uy)}))}const fne={enable:IBe,disable:RBe};async function PBe(t){const e=t.detail.annotation;if(!vS(e))return;const n=NBe(e),r=LBe(n,e);if(!r.length){wt(vt,ee.ANNOTATION_CUT_MERGE_PROCESS_COMPLETED,{element:n.element,sourceAnnotation:e});return}const i=GO(e.data.contour.polyline,n),a=NVe(n,i,r);if(!a.length){wt(vt,ee.ANNOTATION_CUT_MERGE_PROCESS_COMPLETED,{element:n.element,sourceAnnotation:e});return}if(a.length>1){kVe(n,e,i,a);return}const{targetAnnotation:o,targetPolyline:s,isContourHole:l}=a[0];if(l){const{contourHoleProcessingEnabled:c=!1}=t.detail;if(!c)return;Hte(n,o,e)}else PVe(n,o,s,e,i)}function ABe(t,e=!1){const n="PlanarFreehandContourSegmentationTool",r=to(t.id,t.renderingEngineId);let i;return r?r.hasTool(n)?r.getToolOptions(n)||(i=`Tool ${n} must be in active/passive state in ${r.id} toolGroup`):i=`Tool ${n} not added to ${r.id} toolGroup`:i=`ToolGroup not found for viewport ${t.id}`,i&&!e&&console.warn(i),!i}function NBe(t){const e=Xte(t);return e.find(r=>ABe(r,!0))??e[0]}function LBe(t,e){const{annotationUID:n}=e;return sS().filter(i=>i.annotationUID&&i.annotationUID!==n&&vS(i)&&fke(i,e)&&t.isReferenceViewable(i.metadata))}function kBe(t){const e=t.detail.annotation;c0(e)}function dne(t){const e=t.detail.annotation;vS(e)&&PBe(t)}function j3(t){if(!t.detail.removed.length)return;jl().forEach(r=>{const a=r.getViewports().map(o=>o.id);at(a)})}function hne(t){const{viewportId:e}=t.detail;at([e])}function VBe(t){const e=t.detail.annotation;vS(e)&&kBe(t)}const pne=function(t){Ky(t.detail.element)},FBe=function(t){t.addEventListener(mt.IMAGE_RENDERED,pne)},UBe=function(t){t.removeEventListener(mt.IMAGE_RENDERED,pne)},gne={enable:FBe,disable:UBe},{Active:BBe}=br;function i1(t,e,n){if(Dt.isInteractingWithTool)return!1;const{renderingEngineId:r,viewportId:i}=n.detail,a=to(i,r);if(!a)return!1;let o;const s=Object.keys(a.toolOptions);for(let l=0;l<s.length;l++){const c=s[l],f=a.toolOptions[c],u=a.getToolInstance(c);if(f.mode===BBe&&typeof u[e]=="function"){o=a.getToolInstance(c);break}}o&&o[e](n)}const mne=i1.bind(null,"Mouse","mouseClickCallback"),vne=i1.bind(null,"Mouse","doubleClickCallback");function yne(t,e,n,r="mouse"){const i=r==="touch"?36:6,a=[];return e.forEach(({tool:o,annotations:s})=>{for(const l of s){if(l.isLocked||!l.isVisible)continue;const c=o.getHandleNearImagePoint(t,l,n,i);if(c){a.push({tool:o,annotation:l,handle:c});break}}}),a}function SS(t,e){const n=[];for(let r=0;r<e.length;r++){const i=e[r];if(!i){console.warn("undefined tool in filterToolsWithAnnotationsForElement");continue}let a=Zi(i.constructor.toolName,t);a?.length&&(typeof i.filterInteractableAnnotationsForElement=="function"&&(a=i.filterInteractableAnnotationsForElement(t,a)),a?.length>0&&n.push({tool:i,annotations:a}))}return n}function XO(t,e,n,r="mouse"){const i=r==="touch"?36:6,a=[];return e.forEach(({tool:o,annotations:s})=>{for(const l of s){if(l.isLocked||!l.isVisible)continue;if(o.isPointNearTool(t,l,n,i,r)){a.push({tool:o,annotation:l});break}}}),a}const{Active:$Be}=br;function TS(t){const{renderingEngineId:e,viewportId:n,event:r}=t.detail,i=n1(r)||e1.getModifierKey(),a=to(n,e);if(!a)return null;const o=Object.keys(a.toolOptions),s=a.getDefaultMousePrimary(),l=t.detail.buttons??r?.buttons??s;for(let c=0;c<o.length;c++){const f=o[c],u=a.toolOptions[f],d=u.bindings.length&&u.bindings.some(h=>h.mouseButton===l&&h.modifierKey===i);if(u.mode===$Be&&d)return a.getToolInstance(f)}}function wm(t,e,n){const{renderingEngineId:r,viewportId:i}=t.detail,a=to(i,r);if(!a)return[];const o=[],s=Object.keys(a.toolOptions);for(let l=0;l<s.length;l++){const c=s[l],f=a.toolOptions[c],u=n!=null&&f.bindings.length&&f.bindings.some(d=>d.mouseButton===n);if(e.includes(f.mode)&&(!n||u)){const d=a.getToolInstance(c);o.push(d)}}return o}function GBe(t,e){const n=new Map,{renderingEngineId:r,viewportId:i}=t.detail,a=to(i,r);if(!a)return n;const o=Object.keys(a.toolOptions),s=a.getDefaultMousePrimary(),l=t.detail.event,c=l?.buttons??s,f=n1(l)||e1.getModifierKey();for(let u=0;u<o.length;u++){const d=o[u],h=a.getToolInstance(d),p=h.configuration?.actions??{},g=Object.values(p);if(!g?.length||!e.includes(h.mode))continue;const m=g.find(y=>y.bindings?.length&&y.bindings.some(v=>v.mouseButton===c&&v.modifierKey===f));m&&n.set(h,m)}return n}const{Active:jBe,Passive:zBe}=br;function WBe(t){if(Dt.isInteractingWithTool)return!1;const e=t.detail,{element:n}=e,r=Xe(n),{canvas:i}=e.currentPoints;if(!r)return!1;const a=GBe(t,[jBe,zBe]),o=Array.from(a.keys()),s=SS(n,o),l=XO(n,s,i);if(l.length>0){const{tool:c,annotation:f}=l[0],u=a.get(c);return(typeof u.method=="string"?c[u.method]:u.method).call(c,t,f),!0}return!1}const{Active:HBe,Passive:KBe}=br;function xne(t){if(Dt.isInteractingWithTool)return;const e=TS(t);if(e&&typeof e.preMouseDownCallback=="function"&&e.preMouseDownCallback(t))return;const n=t.detail.event.buttons===1,r=wm(t,[HBe],t.detail.event.buttons),i=n?wm(t,[KBe]):void 0,a=[...r||[],...i||[]];if(WBe(t))return;const s=t.detail,{element:l}=s,c=SS(l,a),f=s.currentPoints.canvas,u=yne(l,c,f,"mouse"),d=!!t.detail.event.shiftKey;if(u.length>0){const{tool:p,annotation:g,handle:m}=JU(u);ZU(g.annotationUID,d),p.handleSelectedCallback(t,g,m,"Mouse");return}const h=XO(l,c,f,"mouse");if(h.length>0){const{tool:p,annotation:g}=JU(h);ZU(g.annotationUID,d),p.toolSelectedCallback(t,g,"Mouse",f);return}e&&typeof e.postMouseDownCallback=="function"&&e.postMouseDownCallback(t)}function JU(t){if(t.length>1){const e=t.find(n=>{const r=!yo(n.annotation.annotationUID),i=xo(n.annotation.annotationUID);return r&&i});if(e)return e}return t[0]}function ZU(t,e=!1){e?pS(t)?hu(t,!1):hu(t,!0,!0):hu(t,!0,!1)}function bne(t){if(Dt.isInteractingWithTool)return;const e=TS(t);if(e&&e.addNewAnnotation){const n=e.addNewAnnotation(t,"mouse");hu(n.annotationUID)}}function wne(t){if(Dt.isInteractingWithTool)return;const e=TS(t);!e||typeof e.mouseDragCallback!="function"||e.mouseDragCallback(t)}const{Active:qBe,Passive:XBe}=br;function Cne(t){if(Dt.isInteractingWithTool||Dt.isMultiPartToolActive)return;const e=wm(t,[qBe,XBe]),n=t.detail,{element:r}=n,i=SS(r,e),a=e.filter(s=>!i.some(c=>c.tool.getToolName()===s.getToolName()));let o=!1;for(const{tool:s,annotations:l}of i)typeof s.mouseMoveCallback=="function"&&(o=s.mouseMoveCallback(t,l)||o);a.forEach(s=>{typeof s.mouseMoveCallback=="function"&&s.mouseMoveCallback(t)}),o===!0&&Ky(r)}const Sne=i1.bind(null,"Mouse","mouseUpCallback");function Tne(t){if(Dt.isInteractingWithTool)return;t.detail.buttons=wu.Wheel|(t.detail.event.buttons||0);const e=TS(t);if(e)return e.mouseWheelCallback(t)}const YBe=function(t){t.addEventListener(ee.MOUSE_CLICK,mne),t.addEventListener(ee.MOUSE_DOWN,xne),t.addEventListener(ee.MOUSE_DOWN_ACTIVATE,bne),t.addEventListener(ee.MOUSE_DOUBLE_CLICK,vne),t.addEventListener(ee.MOUSE_DRAG,wne),t.addEventListener(ee.MOUSE_MOVE,Cne),t.addEventListener(ee.MOUSE_UP,Sne),t.addEventListener(ee.MOUSE_WHEEL,Tne)},JBe=function(t){t.removeEventListener(ee.MOUSE_CLICK,mne),t.removeEventListener(ee.MOUSE_DOWN,xne),t.removeEventListener(ee.MOUSE_DOWN_ACTIVATE,bne),t.removeEventListener(ee.MOUSE_DOUBLE_CLICK,vne),t.removeEventListener(ee.MOUSE_DRAG,wne),t.removeEventListener(ee.MOUSE_MOVE,Cne),t.removeEventListener(ee.MOUSE_UP,Sne),t.removeEventListener(ee.MOUSE_WHEEL,Tne)},Ene={enable:YBe,disable:JBe},{Active:ZBe}=br;function _ne(t){const{renderingEngineId:e,viewportId:n}=t.detail,r=yLe(),i=e1.getModifierKey(),a=to(n,e);if(!a)return null;const o=Object.keys(a.toolOptions),s=a.getDefaultMousePrimary();for(let l=0;l<o.length;l++){const c=o[l],f=a.toolOptions[c];if(f.mode!==ZBe)continue;if(f.bindings.length&&f.bindings.some(d=>d.mouseButton===(r??s)&&d.modifierKey===i))return a.getToolInstance(c)}}function QBe(t,e){const n=new Map,{renderingEngineId:r,viewportId:i}=t.detail,a=to(i,r);if(!a)return n;const o=Object.keys(a.toolOptions),s=t.detail.key;for(let l=0;l<o.length;l++){const c=o[l],f=a.getToolInstance(c),u=f.configuration?.actions;if(!u)continue;const d=Object.values(u);if(!d?.length||!e.includes(f.mode))continue;const h=d.find(p=>p.bindings?.some(g=>g.key===s));h&&n.set(f,h)}return n}function Dne(t){const e=_ne(t);if(e){const{renderingEngineId:r,viewportId:i}=t.detail,a=to(i,r),o=e.getToolName();Object.keys(a.toolOptions).includes(o)&&a.setViewportsCursorByToolName(o)}const n=QBe(t,[br.Active]);if(n?.size){const{element:r}=t.detail;for(const[i,a]of[...n.entries()])(typeof a.method=="function"?a.method:i[a.method]).call(i,r,a,t)}}function One(t){const e=_ne(t);if(!e)return;const{renderingEngineId:n,viewportId:r}=t.detail,i=to(r,n);Ete();const a=e.getToolName();Object.keys(i.toolOptions).includes(a)&&i.setViewportsCursorByToolName(a)}const e$e=function(t){t.addEventListener(ee.KEY_DOWN,Dne),t.addEventListener(ee.KEY_UP,One)},t$e=function(t){t.removeEventListener(ee.KEY_DOWN,Dne),t.removeEventListener(ee.KEY_UP,One)},Mne={enable:e$e,disable:t$e},{Active:n$e,Passive:r$e,Enabled:i$e}=br,Ine=function(t){wm(t,[n$e,r$e,i$e]).forEach(n=>{n.onCameraModified&&n.onCameraModified(t)})},a$e=function(t){t.addEventListener(mt.CAMERA_MODIFIED,Ine)},o$e=function(t){t.removeEventListener(mt.CAMERA_MODIFIED,Ine)},Rne={enable:a$e,disable:o$e},{Active:s$e,Passive:l$e,Enabled:c$e}=br,Pne=function(t){wm(t,[s$e,l$e,c$e]).forEach(n=>{n.onImageSpacingCalibrated&&n.onImageSpacingCalibrated(t)})},u$e=function(t){t.addEventListener(mt.IMAGE_SPACING_CALIBRATED,Pne)},f$e=function(t){t.removeEventListener(mt.IMAGE_SPACING_CALIBRATED,Pne)},Ane={enable:u$e,disable:f$e},{Active:d$e}=br;function YO(t){const{renderingEngineId:e,viewportId:n}=t.detail,r=t.detail.event,i=to(n,e);if(!i)return null;const a=Object.keys(i.toolOptions),o=Object.keys(r.touches).length,s=n1(r)||e1.getModifierKey(),l=i.getDefaultMousePrimary();for(let c=0;c<a.length;c++){const f=a[c],u=i.toolOptions[f],d=u.bindings.length&&u.bindings.some(h=>(h.numTouchPoints===o||o===1&&h.mouseButton===l)&&h.modifierKey===s);if(u.mode===d$e&&d)return i.getToolInstance(f)}}function QU(t,e,n){const{renderingEngineId:r,viewportId:i}=t.detail,a=to(i,r);if(!a)return[];const o=[],s=Object.keys(a.toolOptions);for(let l=0;l<s.length;l++){const c=s[l],f=a.toolOptions[c],u=n!=null&&f.bindings.length&&f.bindings.some(d=>d.numTouchPoints===n);if(e.includes(f.mode)&&(!n||u)){const d=a.getToolInstance(c);o.push(d)}}return o}const{Active:h$e,Passive:p$e}=br;function Nne(t){if(Dt.isInteractingWithTool)return;const e=YO(t);if(e&&typeof e.preTouchStartCallback=="function"&&e.preTouchStartCallback(t))return;const n=Object.keys(t.detail.event.touches).length===1,r=QU(t,[h$e],Object.keys(t.detail.event.touches).length),i=n?QU(t,[p$e]):void 0,a=[...r||[],...i||[],e],o=t.detail,{element:s}=o,l=SS(s,a),c=o.currentPoints.canvas,f=yne(s,l,c,"touch"),u=!1;if(f.length>0){const{tool:h,annotation:p,handle:g}=eB(f);tB(p.annotationUID,u),h.handleSelectedCallback(t,p,g,"Touch");return}const d=XO(s,l,c,"touch");if(d.length>0){const{tool:h,annotation:p}=eB(d);tB(p.annotationUID,u),h.toolSelectedCallback(t,p,"Touch",c);return}e&&typeof e.postTouchStartCallback=="function"&&e.postTouchStartCallback(t)}function eB(t){return t.length>1&&t.find(e=>!yo(e.annotation.annotationUID)&&xo(e.annotation.annotationUID))||t[0]}function tB(t,e=!1){e?pS(t)?hu(t,!1):hu(t,!0,!0):hu(t,!0,!1)}function Lne(t){if(Dt.isInteractingWithTool)return;const e=YO(t);if(e&&e.addNewAnnotation){const n=e.addNewAnnotation(t,"touch");hu(n.annotationUID)}}function kne(t){if(Dt.isInteractingWithTool)return;const e=YO(t);!e||typeof e.touchDragCallback!="function"||e.touchDragCallback(t)}const Vne=i1.bind(null,"Touch","touchEndCallback"),g$e=i1.bind(null,"Touch","touchTapCallback"),Fne=i1.bind(null,"Touch","touchPressCallback"),m$e=function(t){t.addEventListener(ee.TOUCH_START,Nne),t.addEventListener(ee.TOUCH_START_ACTIVATE,Lne),t.addEventListener(ee.TOUCH_DRAG,kne),t.addEventListener(ee.TOUCH_END,Vne),t.addEventListener(ee.TOUCH_TAP,g$e),t.addEventListener(ee.TOUCH_PRESS,Fne)},v$e=function(t){t.removeEventListener(ee.TOUCH_START,Nne),t.removeEventListener(ee.TOUCH_START_ACTIVATE,Lne),t.removeEventListener(ee.TOUCH_DRAG,kne),t.removeEventListener(ee.TOUCH_END,Vne),t.removeEventListener(ee.TOUCH_PRESS,Fne)},Une={enable:m$e,disable:v$e},y$e=function(){vt.addEventListener(ee.ANNOTATION_COMPLETED,Pf.handleAnnotationCompleted),vt.addEventListener(ee.ANNOTATION_MODIFIED,Pf.handleAnnotationUpdate),vt.addEventListener(ee.ANNOTATION_REMOVED,Pf.handleAnnotationDelete)},x$e=function(){vt.removeEventListener(ee.ANNOTATION_COMPLETED,Pf.handleAnnotationCompleted),vt.removeEventListener(ee.ANNOTATION_MODIFIED,Pf.handleAnnotationUpdate),vt.removeEventListener(ee.ANNOTATION_REMOVED,Pf.handleAnnotationDelete)},Bne={enable:y$e,disable:x$e},{Active:b$e,Passive:w$e,Enabled:C$e}=br,$ne=function(t){wm(t,[b$e,w$e,C$e]).forEach(n=>{n.onResetCamera&&n.onResetCamera(t)})},S$e=function(t){t.addEventListener(mt.CAMERA_RESET,$ne)},T$e=function(t){t.removeEventListener(mt.CAMERA_RESET,$ne)},Gne={enable:S$e,disable:T$e};function jne(t){const{element:e,viewportId:n}=t.detail,r=E$e(n);_$e(e),D$e(r,e),$O.addViewportElement(n,e),rte.enable(e),Ste.enable(e),bte.enable(e),e1.enable(e),fne.enable(e),gne.enable(e),Rne.enable(e),Ane.enable(e),Gne.enable(e),Ene.enable(e),Mne.enable(e),Une.enable(e),Dt.enabledElements.push(e)}function E$e(t){const e="http://www.w3.org/2000/svg",n=document.createElementNS(e,"svg"),r=`svg-layer-${t}`;n.classList.add("svg-layer"),n.setAttribute("id",r),n.setAttribute("xmlns","http://www.w3.org/2000/svg"),n.style.width="100%",n.style.height="100%",n.style.pointerEvents="none",n.style.position="absolute";const i=document.createElementNS(e,"defs"),a=document.createElementNS(e,"filter"),o=document.createElementNS(e,"feOffset"),s=document.createElementNS(e,"feColorMatrix"),l=document.createElementNS(e,"feBlend");return a.setAttribute("id",`shadow-${r}`),a.setAttribute("filterUnits","userSpaceOnUse"),o.setAttribute("result","offOut"),o.setAttribute("in","SourceGraphic"),o.setAttribute("dx","0.5"),o.setAttribute("dy","0.5"),s.setAttribute("result","matrixOut"),s.setAttribute("in","offOut"),s.setAttribute("in2","matrix"),s.setAttribute("values","0.2 0 0 0 0 0 0.2 0 0 0 0 0 0.2 0 0 0 0 0 1 0"),l.setAttribute("in","SourceGraphic"),l.setAttribute("in2","matrixOut"),l.setAttribute("mode","normal"),a.appendChild(o),a.appendChild(s),a.appendChild(l),i.appendChild(a),n.appendChild(i),n}function _$e(t){const{viewportUid:e,renderingEngineUid:n}=t.dataset,r=`${e}:${n}`;Dt.svgNodeCache[r]={}}function D$e(t,e){e.querySelector("div.viewport-element").appendChild(t)}function O$e(t,e){const n=[];if(!e&&!t)throw new Error("At least one of renderingEngineId or viewportId should be given");for(let r=0;r<Dt.synchronizers.length;r++){const i=Dt.synchronizers[r],a=!i.isDisabled(),o=i.hasSourceViewport(e,t),s=i.hasTargetViewport(e,t);a&&(o||s)&&n.push(i)}return n}const M$e="viewport-element";function zne(t){const{element:e,viewportId:n}=t.detail;P$e(e),A$e(e),$O.removeViewportElement(n,e),rte.disable(e),Ste.disable(e),bte.disable(e),e1.disable(e),fne.disable(e),gne.disable(e),Rne.disable(e),Ane.disable(e),Gne.disable(e),Ene.disable(e),Mne.disable(e),Une.disable(e),I$e(e),R$e(e),N$e(e)}const I$e=t=>{const e=Xe(t);if(!e)return;O$e(e.viewportId,e.renderingEngineId).forEach(r=>{r.remove(e)})},R$e=t=>{const e=Xe(t);if(!e)return;const{renderingEngineId:n,viewportId:r}=e,i=to(r,n);i&&i.removeViewports(n,r)};function P$e(t){const{viewportUid:e,renderingEngineUid:n}=t.dataset,r=`${e}:${n}`;delete Dt.svgNodeCache[r]}function A$e(t){const e=t.querySelector(`div.${M$e}`),n=e.querySelector("svg");n&&e.removeChild(n)}const N$e=function(t){const e=Dt.enabledElements.findIndex(n=>n===t);e>-1&&Dt.enabledElements.splice(e,1)},z3=function(t){const{viewportId:e}=t.detail;one(e)};let nB=!1;function L$e(t={}){nB||(nke(t),k$e(),F$e(),nB=!0)}function k$e(){V$e();const t=mt.ELEMENT_ENABLED,e=mt.ELEMENT_DISABLED;vt.addEventListener(t,jne),vt.addEventListener(e,zne),Bne.enable()}function V$e(){const t=mt.ELEMENT_ENABLED,e=mt.ELEMENT_DISABLED;vt.removeEventListener(t,jne),vt.removeEventListener(e,zne),Bne.disable()}function F$e(){U$e(),vt.addEventListener(ee.ANNOTATION_COMPLETED,dne),vt.addEventListener(ee.ANNOTATION_MODIFIED,hne),vt.addEventListener(ee.ANNOTATION_SELECTION_CHANGE,j3),vt.addEventListener(ee.ANNOTATION_SELECTION_CHANGE,j3),vt.addEventListener(ee.ANNOTATION_REMOVED,VBe),vt.addEventListener(ee.SEGMENTATION_MODIFIED,une),vt.addEventListener(ee.SEGMENTATION_DATA_MODIFIED,cne),vt.addEventListener(ee.SEGMENTATION_REPRESENTATION_MODIFIED,z3),vt.addEventListener(ee.SEGMENTATION_REPRESENTATION_ADDED,z3)}function U$e(){vt.removeEventListener(ee.ANNOTATION_COMPLETED,dne),vt.removeEventListener(ee.ANNOTATION_MODIFIED,hne),vt.removeEventListener(ee.ANNOTATION_SELECTION_CHANGE,j3),vt.removeEventListener(ee.ANNOTATION_SELECTION_CHANGE,j3),vt.removeEventListener(ee.SEGMENTATION_MODIFIED,une),vt.removeEventListener(ee.SEGMENTATION_DATA_MODIFIED,cne),vt.removeEventListener(ee.SEGMENTATION_REPRESENTATION_MODIFIED,z3),vt.removeEventListener(ee.SEGMENTATION_REPRESENTATION_ADDED,z3)}const{transformWorldToIndex:F8}=Yr;function B$e(t,e,n){const[r,i]=t,a=Sn((r[0]+i[0])/2,(r[1]+i[1])/2,(r[2]+i[2])/2),o=ol(r,i)/2,{boundsIJK:s,topLeftWorld:l,bottomRightWorld:c}=G$e(e,n,t,a,o);return{boundsIJK:s,centerWorld:a,radiusWorld:o,topLeftWorld:l,bottomRightWorld:c}}function $$e(t,e,n){if(!n)throw new Error("viewport is required in order to calculate the sphere bounds");const r=n.getCamera(),i=Sn(r.viewUp[0],r.viewUp[1],r.viewUp[2]),a=Sn(r.viewPlaneNormal[0],r.viewPlaneNormal[1],r.viewPlaneNormal[2]),o=it();gr(o,i,a);const s={row:o,normal:a,column:cu(it(),i)};return B$e(t,e,s)}function G$e(t,e,n,r,i){const a=t.getDimensions(),{row:o,column:s,normal:l}=e,c=it(),f=it();Ar(c,r,l,i),Ar(f,r,l,-i),Ar(c,c,s,-i),Ar(f,f,s,i),Ar(c,c,o,-i),Ar(f,f,o,i);const u=F8(t,c),d=F8(t,f),h=n.map(g=>F8(t,g));return{boundsIJK:MO([u,d,...h],a),topLeftWorld:c,bottomRightWorld:f}}let rB=!1;function j$e(){if(rB)return;rB=!0;const t=()=>new Worker(new URL("/assets/computeWorker-DVcDvZFV.js",import.meta.url),{name:"compute",type:"module"}),e=Bm(),i={maxWorkerInstances:1,autoTerminateOnIdle:tke().computeWorker?.autoTerminateOnIdle??{enabled:!0,idleTimeThreshold:2e3}};e.registerWorker("compute",t,i)}function z$e(t){const e=yt.getVolume(t);if(!e)return null;const n=e.referencedVolumeId;let r;if(n)r=yt.getVolume(n);else{const i=e.imageIds,o=yt.getImage(i[0]).referencedImageId;r=yt.getVolumeContainingImageId(o)?.volume}return r}function W$e({operationData:t}){const{volumeId:e}=t;if(!e){const l=new CustomEvent(mt.ERROR_EVENT,{detail:{type:"Segmentation",message:"No volume id found for the segmentation"},cancelable:!0});return vt.dispatchEvent(l),null}const n=yt.getVolume(e),r=z$e(e);if(!n||!r)return null;const{imageData:i}=n,{voxelManager:a}=n,{voxelManager:o,imageData:s}=r;return{segmentationImageData:i,segmentationVoxelManager:a,segmentationScalarData:null,imageScalarData:null,imageVoxelManager:o,imageData:s}}function H$e({operationData:t,viewport:e,strategy:n}){const{segmentationId:r}=t;let i,a,o,s,l,c;if(n.ensureSegmentationVolumeFor3DManipulation)n.ensureSegmentationVolumeFor3DManipulation({operationData:t,viewport:e}),a=t.segmentationVoxelManager,i=t.segmentationImageData,o=null;else{const f=yS(e.id,r);if(!f)return null;const u=Ote(e.id,r);if(!u)return null;const d=yt.getImage(f);i=u.actor.getMapper().getInputData(),a=d.voxelManager;const h=t.imageId,p=yt.getImage(h);if(!p)return null;o=p.getPixelData?.()}if(n.ensureImageVolumeFor3DManipulation)n.ensureImageVolumeFor3DManipulation({operationData:t,viewport:e}),l=t.imageVoxelManager,s=t.imageScalarData,c=t.imageData;else{const f=e.getCurrentImageId();if(!f)return null;const u=yt.getImage(f);c=u?null:e.getImageData(),s=u?.getPixelData()||c.getScalarData(),l=u?.voxelManager}return{segmentationImageData:i,segmentationScalarData:o,imageScalarData:s,segmentationVoxelManager:a,imageVoxelManager:l,imageData:c}}function JO({operationData:t,viewport:e,strategy:n}){return t?"volumeId"in t&&t.volumeId!=null||"referencedVolumeId"in t&&t.referencedVolumeId!=null?W$e({operationData:t}):H$e({operationData:t,viewport:e,strategy:n}):null}function K$e(t){const{representationData:e}=ea(t);let{volumeId:n}=e.Labelmap,r;if(n&&(r=yt.getVolume(n),r))return r;const{imageIds:i}=e.Labelmap;if(n=yt.generateVolumeId(i),!(!i||i.length===1||!Jm(i)))return r=ZC(n,i),r}const Wne={[jt.EnsureSegmentationVolumeFor3DManipulation]:t=>{const{operationData:e,viewport:n}=t,{segmentationId:r,imageIds:i}=e,a=n?n.getImageIds():i.map(l=>yt.getImage(l).referencedImageId);if(!Jm(a))throw new Error("Volume is not reconstructable for sphere manipulation");const s=K$e(r);s&&(e.segmentationVoxelManager=s.voxelManager,e.segmentationImageData=s.imageData)}};function q$e(t){if(!t||t.length<=1||!Jm(t))return;const n=yt.generateVolumeId(t);let r=yt.getVolume(n);return r||(r=ZC(n,t),r)}const Hne={[jt.EnsureImageVolumeFor3DManipulation]:t=>{const{operationData:e,viewport:n}=t;let r;if(n){if(r=n.getImageIds(),!Jm(r))throw new Error("Volume is not reconstructable for sphere manipulation")}else r=ea(e.segmentationId).representationData.Labelmap.imageIds.map(s=>yt.getImage(s).referencedImageId);const i=q$e(r);if(!i)throw new Error("Failed to create or get image volume");e.imageVoxelManager=i.voxelManager,e.imageData=i.imageData}},W3=(t,e)=>{wt(vt,mt.WEB_WORKER_PROGRESS,{progress:e,type:t})},X$e=(t,e)=>{const n=ea(t),{representationData:r}=n,{Labelmap:i}=r;if(!i)return console.debug("No labelmap found for segmentation",t),null;const a=i.volumeId,o=i.imageIds,s={segmentationId:t,volumeId:a,imageIds:o};let l=!1;if(o){const f=o.map(u=>yt.getImage(u).referencedImageId);l=Jm(f)}let c=e;return c?Array.isArray(c)||(c=[c,255]):c=[Su(t)],{operationData:s,segVolumeId:a,segImageIds:o,reconstructableVolume:l,indices:c}},Y$e=t=>JO({operationData:t,strategy:{ensureSegmentationVolumeFor3DManipulation:Wne.ensureSegmentationVolumeFor3DManipulation,ensureImageVolumeFor3DManipulation:Hne.ensureImageVolumeFor3DManipulation}}),J$e=t=>{const e=[],n=[];for(const r of t){const i=yt.getImage(r),a=i.getPixelData(),{origin:o,direction:s,spacing:l,dimensions:c}=tO(i);e.push({scalarData:a,dimensions:c,spacing:l,origin:o,direction:s});const f=i.referencedImageId;if(f){const u=yt.getImage(f);if(!u)continue;const d=u.getPixelData(),h=u.voxelManager,p=[u.rowPixelSpacing,u.columnPixelSpacing];n.push({scalarData:d,dimensions:h?h.dimensions:[u.columns,u.rows,1],spacing:p})}}return{segmentationInfo:e,imageInfo:n}},Z$e=(t,e)=>{let n;if(t){const s=yt.getVolume(t).imageIds,l=yt.getImage(s[0]);l&&(n=l.referencedImageId)}else e?.length&&(n=yt.getImage(e[0]).referencedImageId);const r=yt.getImage(n),i=Ut("scalingModule",n),a={isPreScaled:!!r?.preScale?.scaled,isSuvScaled:typeof i?.suvbw=="number"};return{refImageId:n,modalityUnitOptions:a}},{isEqual:Q$e}=Yr;function iB(t,e){const{polyline:n}=t.data.contour,{points:r}=t.data.handles,{length:i}=r;if(e===i)return n.length;if(e<0&&(e=(e+i)%i),e===0)return 0;const a=r[e],o=n.findIndex(l=>Q$e(a,l));if(o!==-1)return o;let s=1/0;return n.reduce((l,c,f)=>{const u=pX(c,a);return u<s?(s=u,f):l},-1)}const{transformWorldToIndex:aB}=Yr,Mg=class Mg extends la{constructor(e={},n={supportedInteractionTypes:["Mouse","Touch"],configuration:{storePointData:!1,shadow:!0,preventHandleOutsideImage:!1,calculateStats:!0,getTextLines:eGe,statsCalculator:f0}}){super(e,n),this.addNewAnnotation=r=>{const i=r.detail,{currentPoints:a,element:o}=i,s=a.world,l=Xe(o),{viewport:c}=l;this.isDrawing=!0;const f=this.constructor.createAnnotationForViewport(c,{data:{handles:{points:[[...s],[...s],[...s],[...s]],textBox:{hasMoved:!1,worldPosition:[0,0,0],worldBoundingBox:{topLeft:[0,0,0],topRight:[0,0,0],bottomLeft:[0,0,0],bottomRight:[0,0,0]}}},cachedStats:{}}});mr(f,o);const u=fn(o,this.getToolName());return this.editData={annotation:f,viewportIdsToRender:u,handleIndex:3,movingTextBox:!1,newAnnotation:!0,hasMoved:!1},this._activateDraw(o),Rn(o),r.preventDefault(),at(u),f},this.isPointNearTool=(r,i,a,o)=>{const s=Xe(r),{viewport:l}=s,{data:c}=i,{points:f}=c.handles,u=l.worldToCanvas(f[0]),d=l.worldToCanvas(f[3]),h=this._getRectangleImageCoordinates([u,d]),p=[a[0],a[1]],{left:g,top:m,width:y,height:v}=h;return tVe([g,m,y,v],p)<=o},this.toolSelectedCallback=(r,i)=>{const a=r.detail,{element:o}=a;i.highlighted=!0;const s=fn(o,this.getToolName());this.editData={annotation:i,viewportIdsToRender:s,movingTextBox:!1},this._activateModify(o),Rn(o);const l=Xe(o),{renderingEngine:c}=l;at(s),r.preventDefault()},this.handleSelectedCallback=(r,i,a)=>{const o=r.detail,{element:s}=o,{data:l}=i;i.highlighted=!0;let c=!1,f;a.worldPosition?c=!0:f=l.handles.points.findIndex(p=>p===a);const u=fn(s,this.getToolName());this.editData={annotation:i,viewportIdsToRender:u,handleIndex:f,movingTextBox:c},this._activateModify(s),Rn(s);const d=Xe(s),{renderingEngine:h}=d;at(u),r.preventDefault()},this._endCallback=r=>{const i=r.detail,{element:a}=i,{annotation:o,viewportIdsToRender:s,newAnnotation:l,hasMoved:c}=this.editData,{data:f}=o;l&&!c||(f.handles.activeHandleIndex=null,this._deactivateModify(a),this._deactivateDraw(a),qn(a),this.doneEditMemo(),this.editData=null,this.isDrawing=!1,this.isHandleOutsideImage&&this.configuration.preventHandleOutsideImage&&_r(o.annotationUID),at(s),l&&Xr(o))},this._dragCallback=r=>{this.isDrawing=!0;const i=r.detail,{element:a}=i,{annotation:o,viewportIdsToRender:s,handleIndex:l,movingTextBox:c,newAnnotation:f}=this.editData;this.createMemo(a,o,{newAnnotation:f});const{data:u}=o;if(c){const{deltaPoints:d}=i,h=d.world,{textBox:p}=u.handles,{worldPosition:g}=p;g[0]+=h[0],g[1]+=h[1],g[2]+=h[2],p.hasMoved=!0}else if(l===void 0){const{deltaPoints:d}=i,h=d.world,{points:p}=u.handles;p.forEach(g=>{g[0]+=h[0],g[1]+=h[1],g[2]+=h[2]}),o.invalidated=!0}else{const{currentPoints:d}=i,h=Xe(a),{worldToCanvas:p,canvasToWorld:g}=h.viewport,m=d.world,{points:y}=u.handles;y[l]=[...m];let v,x,w,S,T,_,D,I;switch(l){case 0:case 3:v=p(y[0]),S=p(y[3]),x=[S[0],v[1]],w=[v[0],S[1]],_=g(x),D=g(w),y[1]=_,y[2]=D;break;case 1:case 2:x=p(y[1]),w=p(y[2]),v=[w[0],x[1]],S=[x[0],w[1]],T=g(v),I=g(S),y[0]=T,y[3]=I;break}o.invalidated=!0}this.editData.hasMoved=!0,Xe(a),at(s),o.invalidated&&Un(o,a,xn.HandlesUpdated)},this.cancel=r=>{if(this.isDrawing){this.isDrawing=!1,this._deactivateDraw(r),this._deactivateModify(r),qn(r);const{annotation:i,viewportIdsToRender:a,newAnnotation:o}=this.editData,{data:s}=i;return i.highlighted=!1,s.handles.activeHandleIndex=null,at(a),o&&Xr(i),this.editData=null,i.annotationUID}},this._activateDraw=r=>{Dt.isInteractingWithTool=!0,r.addEventListener(ee.MOUSE_UP,this._endCallback),r.addEventListener(ee.MOUSE_DRAG,this._dragCallback),r.addEventListener(ee.MOUSE_MOVE,this._dragCallback),r.addEventListener(ee.MOUSE_CLICK,this._endCallback),r.addEventListener(ee.TOUCH_END,this._endCallback),r.addEventListener(ee.TOUCH_DRAG,this._dragCallback),r.addEventListener(ee.TOUCH_TAP,this._endCallback)},this._deactivateDraw=r=>{Dt.isInteractingWithTool=!1,r.removeEventListener(ee.MOUSE_UP,this._endCallback),r.removeEventListener(ee.MOUSE_DRAG,this._dragCallback),r.removeEventListener(ee.MOUSE_MOVE,this._dragCallback),r.removeEventListener(ee.MOUSE_CLICK,this._endCallback),r.removeEventListener(ee.TOUCH_END,this._endCallback),r.removeEventListener(ee.TOUCH_DRAG,this._dragCallback),r.removeEventListener(ee.TOUCH_TAP,this._endCallback)},this._activateModify=r=>{Dt.isInteractingWithTool=!0,r.addEventListener(ee.MOUSE_UP,this._endCallback),r.addEventListener(ee.MOUSE_DRAG,this._dragCallback),r.addEventListener(ee.MOUSE_CLICK,this._endCallback),r.addEventListener(ee.TOUCH_END,this._endCallback),r.addEventListener(ee.TOUCH_DRAG,this._dragCallback),r.addEventListener(ee.TOUCH_TAP,this._endCallback)},this._deactivateModify=r=>{Dt.isInteractingWithTool=!1,r.removeEventListener(ee.MOUSE_UP,this._endCallback),r.removeEventListener(ee.MOUSE_DRAG,this._dragCallback),r.removeEventListener(ee.MOUSE_CLICK,this._endCallback),r.removeEventListener(ee.TOUCH_END,this._endCallback),r.removeEventListener(ee.TOUCH_DRAG,this._dragCallback),r.removeEventListener(ee.TOUCH_TAP,this._endCallback)},this.renderAnnotation=(r,i)=>{let a=!1;const{viewport:o}=r,{element:s}=o;let l=Zi(this.getToolName(),s);if(!l?.length||(l=this.filterInteractableAnnotationsForElement(s,l),!l?.length))return a;const c=this.getTargetId(o),f=o.getRenderingEngine(),u={toolGroupId:this.toolGroupId,toolName:this.getToolName(),viewportId:r.viewport.id};for(let d=0;d<l.length;d++){const h=l[d],{annotationUID:p,data:g}=h,{points:m,activeHandleIndex:y}=g.handles,v=m.map(F=>o.worldToCanvas(F));u.annotationUID=p;const{color:x,lineWidth:w,lineDash:S}=this.getAnnotationStyle({annotation:h,styleSpecifier:u}),{viewPlaneNormal:T,viewUp:_}=o.getCamera();if(!g.cachedStats[c]||g.cachedStats[c].areaUnit==null)g.cachedStats[c]={Modality:null,area:null,max:null,mean:null,stdDev:null,areaUnit:null},this._calculateCachedStats(h,T,_,f,r);else if(h.invalidated&&(this._throttledCalculateCachedStats(h,T,_,f,r),o instanceof da)){const{referencedImageId:F}=h.metadata;for(const J in g.cachedStats)J.startsWith("imageId")&&f.getStackViewports().find(ye=>{const ve=Ci(F),Ce=ye.hasImageURI(ve),we=Ci(ye.getCurrentImageId());return Ce&&we!==ve})&&delete g.cachedStats[J]}if(!o.getRenderingEngine())return console.warn("Rendering Engine has been destroyed"),a;let D;if(!xo(p))continue;!yo(p)&&!this.editData&&y!==null&&y!==void 0&&(D=[v[y]]),D&&bo(i,p,"0",D,{color:x});const I=`${p}-rect`;Wte(i,p,"0",v,{color:x,lineDash:S,lineWidth:w},I),a=!0;const O=this.getLinkedTextBoxStyle(u,h);if(!O.visibility){g.handles.textBox={hasMoved:!1,worldPosition:[0,0,0],worldBoundingBox:{topLeft:[0,0,0],topRight:[0,0,0],bottomLeft:[0,0,0],bottomRight:[0,0,0]}};continue}const P=this.configuration.getTextLines(g,c);if(!P||P.length===0)continue;if(!g.handles.textBox.hasMoved){const F=Iu(v);g.handles.textBox.worldPosition=o.canvasToWorld(F)}const N=o.worldToCanvas(g.handles.textBox.worldPosition),B=cl(i,p,"1",P,N,v,{},O),{x:V,y:$,width:U,height:G}=B;g.handles.textBox.worldBoundingBox={topLeft:o.canvasToWorld([V,$]),topRight:o.canvasToWorld([V+U,$]),bottomLeft:o.canvasToWorld([V,$+G]),bottomRight:o.canvasToWorld([V+U,$+G])}}return a},this._getRectangleImageCoordinates=r=>{const[i,a]=r;return{left:Math.min(i[0],a[0]),top:Math.min(i[1],a[1]),width:Math.abs(i[0]-a[0]),height:Math.abs(i[1]-a[1])}},this._calculateCachedStats=(r,i,a,o,s)=>{if(!this.configuration.calculateStats)return;const{data:l}=r,{viewport:c}=s,{element:f}=c,u=l.handles.points[0],d=l.handles.points[3],{cachedStats:h}=l,p=Object.keys(h);for(let m=0;m<p.length;m++){const y=p[m],v=this.getTargetImageData(y);if(!v)continue;const{dimensions:x,imageData:w,metadata:S,voxelManager:T}=v,_=aB(w,u);_[0]=Math.floor(_[0]),_[1]=Math.floor(_[1]),_[2]=Math.floor(_[2]);const D=aB(w,d);if(D[0]=Math.floor(D[0]),D[1]=Math.floor(D[1]),D[2]=Math.floor(D[2]),this._isInsideVolume(_,D,x)){this.isHandleOutsideImage=!1;const I=Math.min(_[0],D[0]),R=Math.max(_[0],D[0]),O=Math.min(_[1],D[1]),P=Math.max(_[1],D[1]),N=Math.min(_[2],D[2]),A=Math.max(_[2],D[2]),B=[[I,R],[O,P],[N,A]],{worldWidth:V,worldHeight:$}=Zte(i,a,u,d),U=[_,D],{scale:G,areaUnit:F}=Cc(v,U),J=Math.abs(V*$)/(G*G),Q={isPreScaled:r1(c,y),isSuvScaled:this.isSuvScaled(c,y,r.metadata.referencedImageId)},ne=np(S.Modality,r.metadata.referencedImageId,Q);let ye;T&&(ye=T.forEach(this.configuration.statsCalculator.statsCallback,{boundsIJK:B,imageData:w,returnPoints:this.configuration.storePointData}));const ve=this.configuration.statsCalculator.getStatistics();h[y]={Modality:S.Modality,area:J,mean:ve.mean?.value,stdDev:ve.stdDev?.value,max:ve.max?.value,min:ve.min?.value,statsArray:ve.array,pointsInShape:ye,areaUnit:F,modalityUnit:ne}}else this.isHandleOutsideImage=!0,h[y]={Modality:S.Modality}}const g=r.invalidated;return r.invalidated=!1,g&&Un(r,f,xn.StatsUpdated),h},this._isInsideVolume=(r,i,a)=>Ta(r,a)&&Ta(i,a),this._throttledCalculateCachedStats=Wl(this._calculateCachedStats,100,{trailing:!0})}};Mg.toolName="RectangleROI",Mg.hydrate=(e,n,r)=>{const i=xr(e);if(!i)return;const{FrameOfReferenceUID:a,referencedImageId:o,viewPlaneNormal:s,instance:l,viewport:c}=Mg.hydrateBase(Mg,i,n,r),{toolInstance:f,...u}=r||{},d={annotationUID:r?.annotationUID||cr(),data:{handles:{points:n,activeHandleIndex:null},label:"",cachedStats:{}},highlighted:!1,autoGenerated:!1,invalidated:!1,isLocked:!1,isVisible:!0,metadata:{toolName:l.getToolName(),viewPlaneNormal:s,FrameOfReferenceUID:a,referencedImageId:o,...u}};mr(d,c.element),at([c.id])};let Wd=Mg;function eGe(t,e){const n=t.cachedStats[e],{area:r,mean:i,max:a,stdDev:o,areaUnit:s,modalityUnit:l,min:c}=n;if(i==null)return;const f=[];return hi(r)&&f.push(`Area: ${Vn(r)} ${s}`),hi(i)&&f.push(`Mean: ${Vn(i)} ${l}`),hi(a)&&f.push(`Max: ${Vn(a)} ${l}`),hi(c)&&f.push(`Max: ${Vn(c)} ${l}`),hi(o)&&f.push(`Std Dev: ${Vn(o)} ${l}`),f}const{transformWorldToIndex:mv}=Yr;class kv extends Wd{constructor(e={},n={configuration:{storePointData:!1,numSlicesToPropagate:10,calculatePointsInsideVolume:!0,getTextLines:tGe,statsCalculator:f0,showTextBox:!1,throttleTimeout:100}}){super(e,n),this.addNewAnnotation=r=>{const i=r.detail,{currentPoints:a,element:o}=i,s=a.world,l=Xe(o),{viewport:c,renderingEngine:f}=l;this.isDrawing=!0;const u=c.getCamera(),{viewPlaneNormal:d,viewUp:h}=u;let p,g,m;if(c instanceof fa)throw new Error("Stack Viewport Not implemented");{const _=this.getTargetId(c);m=m0(_),g=yt.getVolume(m),p=$h(g,s,d)}const y=Jh(g,d),v=this._getStartCoordinate(s,d),x=this._getEndCoordinate(s,y,d),w=c.getFrameOfReferenceUID(),S={highlighted:!0,invalidated:!0,metadata:{viewPlaneNormal:[...d],enabledElement:l,viewUp:[...h],FrameOfReferenceUID:w,referencedImageId:p,toolName:this.getToolName(),volumeId:m,spacingInNormal:y},data:{label:"",startCoordinate:v,endCoordinate:x,cachedStats:{pointsInVolume:[],projectionPoints:[],projectionPointsImageIds:[p],statistics:[]},handles:{textBox:{hasMoved:!1,worldPosition:[0,0,0],worldBoundingBox:{topLeft:[0,0,0],topRight:[0,0,0],bottomLeft:[0,0,0],bottomRight:[0,0,0]}},points:[[...s],[...s],[...s],[...s]],activeHandleIndex:null},labelmapUID:null}};this._computeProjectionPoints(S,g),mr(S,o);const T=fn(o,this.getToolName());return this.editData={annotation:S,viewportIdsToRender:T,handleIndex:3,newAnnotation:!0,hasMoved:!1},this._activateDraw(o),Rn(o),r.preventDefault(),at(T),S},this._endCallback=r=>{const i=r.detail,{element:a}=i,{annotation:o,viewportIdsToRender:s,newAnnotation:l,hasMoved:c}=this.editData,{data:f}=o;if(l&&!c)return;f.handles.activeHandleIndex=null,this._deactivateModify(a),this._deactivateDraw(a),qn(a);const{metadata:u}=o,{enabledElement:d}=u;this.editData=null,this.isDrawing=!1,this.isHandleOutsideImage&&this.configuration.preventHandleOutsideImage&&_r(o.annotationUID);const h=this.getTargetId(d.viewport),p=yt.getVolume(h.split(/volumeId:|\?/)[1]);this._computePointsInsideVolume(o,h,p,d),at(s),l?Xr(o):Un(o,a)},this.renderAnnotation=(r,i)=>{let a=!1;const{viewport:o}=r;let s=Zi(this.getToolName(),o.element);if(!s?.length)return a;s=_Fe(s,o.getCamera());const l={toolGroupId:this.toolGroupId,toolName:this.getToolName(),viewportId:r.viewport.id};for(let c=0;c<s.length;c++){const f=s[c],{annotationUID:u,data:d,metadata:h}=f,{startCoordinate:p,endCoordinate:g}=d,{points:m,activeHandleIndex:y}=d.handles,{enabledElement:v}=h,x=m.map(F=>o.worldToCanvas(F));l.annotationUID=u;const w=this.getStyle("lineWidth",l,f),S=this.getStyle("lineDash",l,f),T=this.getStyle("color",l,f),_=o.getCamera().focalPoint,D=o.getCamera().viewPlaneNormal;let I=p,R=g;if(Array.isArray(p)){I=this._getCoordinateForViewplaneNormal(I,D);const F=this._getIndexOfCoordinatesForViewplaneNormal(D);d.handles.points.forEach(J=>{J[F]=I}),d.startCoordinate=I}Array.isArray(g)&&(R=this._getCoordinateForViewplaneNormal(R,D),d.endCoordinate=R,d.endCoordinate=R);const O=cw(I),P=cw(R),N=this._getCoordinateForViewplaneNormal(_,D),A=cw(N);if(A<Math.min(O,P)||A>Math.max(O,P))continue;const B=v.viewport?.volumeIds.values();for(const F of B)f.invalidated&&f.metadata.volumeId===F&&this._throttledCalculateCachedStats(f,v);let V=!1;if((A===O||A===P)&&(V=!0),!o.getRenderingEngine())return console.warn("Rendering Engine has been destroyed"),a;let $;if(!xo(u))continue;!yo(u)&&!this.editData&&y!==null&&V&&($=[x[y]]),$&&bo(i,u,"0",$,{color:T});let U=S;if(V||(U=2),BO(i,u,"0",x[0],x[3],{color:T,lineDash:U,lineWidth:w}),a=!0,this.configuration.showTextBox){const F=this.getLinkedTextBoxStyle(l,f);if(!F.visibility){d.handles.textBox={hasMoved:!1,worldPosition:[0,0,0],worldBoundingBox:{topLeft:[0,0,0],topRight:[0,0,0],bottomLeft:[0,0,0],bottomRight:[0,0,0]}};continue}const J=this.configuration.getTextLines(d,{metadata:h});if(!J||J.length===0)continue;if(!d.handles.textBox.hasMoved){const Me=Iu(x);d.handles.textBox.worldPosition=o.canvasToWorld(Me)}const Q=o.worldToCanvas(d.handles.textBox.worldPosition),ye=cl(i,u,"1",J,Q,x,{},F),{x:ve,y:Ce,width:we,height:Ae}=ye;d.handles.textBox.worldBoundingBox={topLeft:o.canvasToWorld([ve,Ce]),topRight:o.canvasToWorld([ve+we,Ce]),bottomLeft:o.canvasToWorld([ve,Ce+Ae]),bottomRight:o.canvasToWorld([ve+we,Ce+Ae])}}}return a},this.configuration.calculatePointsInsideVolume?this._throttledCalculateCachedStats=Wl(this._calculateCachedStatsTool,this.configuration.throttleTimeout,{trailing:!0}):this._throttledCalculateCachedStats=hS(this._calculateCachedStatsTool,this.configuration.throttleTimeout)}_computeProjectionPoints(e,n){const{data:r,metadata:i}=e,{viewPlaneNormal:a,spacingInNormal:o}=i,{imageData:s}=n,{startCoordinate:l,endCoordinate:c}=r,{points:f}=r.handles,u=mv(s,f[0]),d=mv(s,f[0]),h=it();s.indexToWorldVec3(u,h);const p=it();s.indexToWorldVec3(d,p);const g=this._getIndexOfCoordinatesForViewplaneNormal(a);g==2?(h[2]=l,p[2]=c):g==0?(h[0]=l,p[0]=c):g==1&&(h[1]=l,p[1]=c);const m=it();Pr(m,p,h);const y=Vo(m);Lr(m,m);const v=[];for(let x=0;x<y;x+=o)v.push(f.map(w=>{const S=it();return Ar(S,w,m,x),Array.from(S)}));r.cachedStats.projectionPoints=v}_computePointsInsideVolume(e,n,r,i){const{data:a,metadata:o}=e,{viewPlaneNormal:s,viewUp:l}=o,{viewport:c}=i,f=a.cachedStats.projectionPoints,u=[[]],d=this.getTargetImageData(n),h=a.handles.points[0],p=a.handles.points[3],{worldWidth:g,worldHeight:m}=Zte(s,l,h,p),y=Cc(d,a.habdles),v=Math.abs(g*m)/(y.scale*y.scale),x={isPreScaled:r1(c,n),isSuvScaled:this.isSuvScaled(c,n,e.metadata.referencedImageId)},w=np(o.Modality,e.metadata.referencedImageId,x);for(let T=0;T<f.length;T++){if(!r)continue;const _=f[T][0],{dimensions:D,imageData:I,voxelManager:R}=r,O=mv(I,h),P=mv(I,_),N=this._getIndexOfCoordinatesForViewplaneNormal(s);O[0]=Math.floor(O[0]),O[1]=Math.floor(O[1]),O[2]=Math.floor(O[2]),O[N]=P[N];const A=mv(I,p);if(A[0]=Math.floor(A[0]),A[1]=Math.floor(A[1]),A[2]=Math.floor(A[2]),A[N]=P[N],this._isInsideVolume(O,A,D)){this.isHandleOutsideImage=!1;const B=Math.min(O[0],A[0]),V=Math.max(O[0],A[0]),$=Math.min(O[1],A[1]),U=Math.max(O[1],A[1]),G=Math.min(O[2],A[2]),F=Math.max(O[2],A[2]),J=[[B,V],[$,U],[G,F]],Q=R.forEach(this.configuration.statsCalculator.statsCallback,{boundsIJK:J,imageData:I,returnPoints:this.configuration.storePointData});u.push(Q)}}const S=this.configuration.statsCalculator.getStatistics();a.cachedStats.pointsInVolume=u,a.cachedStats.statistics={Modality:o.Modality,area:v,mean:S.mean?.value,stdDev:S.stdDev?.value,max:S.max?.value,statsArray:S.array,areaUnit:y.areaUnit,modalityUnit:w}}_calculateCachedStatsTool(e,n){const r=e.data,{viewport:i}=n,{cachedStats:a}=r,o=this.getTargetId(i),s=yt.getVolume(o.split(/volumeId:|\?/)[1]);return this._computeProjectionPoints(e,s),this._computePointsInsideVolume(e,o,s,n),e.invalidated=!1,Un(e,i.element),a}_getStartCoordinate(e,n){const r=e;return this._getCoordinateForViewplaneNormal(r,n)}_getEndCoordinate(e,n,r){const i=this.configuration.numSlicesToPropagate,a=it();return Ar(a,e,r,i*n),this._getCoordinateForViewplaneNormal(a,r)}_getIndexOfCoordinatesForViewplaneNormal(e){const n=[Math.abs(e[0]),Math.abs(e[1]),Math.abs(e[2])];return n.indexOf(Math.max(...n))}_getCoordinateForViewplaneNormal(e,n){const r=this._getIndexOfCoordinatesForViewplaneNormal(n);return e[r]}}function tGe(t,e={}){const n=t.cachedStats.statistics,{area:r,mean:i,max:a,stdDev:o,areaUnit:s,modalityUnit:l}=n;if(i===void 0)return;const c=[];return c.push(`Area: ${Vn(r)} ${s}`),c.push(`Mean: ${Vn(i)} ${l}`),c.push(`Max: ${Vn(a)} ${l}`),c.push(`Std Dev: ${Vn(o)} ${l}`),c}kv.toolName="RectangleROIStartEndThreshold";class Vv extends Wd{constructor(e={},n={supportedInteractionTypes:["Mouse","Touch"],configuration:{shadow:!0,preventHandleOutsideImage:!1}}){super(e,n),this.addNewAnnotation=r=>{const i=r.detail,{currentPoints:a,element:o}=i,s=a.world,l=Xe(o),{viewport:c,renderingEngine:f}=l;this.isDrawing=!0;const u=c.getCamera(),{viewPlaneNormal:d,viewUp:h}=u,p=this.getTargetId(c);let g,m;if(c instanceof fa)g=p.split("imageId:")[1];else{m=m0(p);const w=yt.getVolume(m);g=$h(w,s,d)}const y=c.getFrameOfReferenceUID(),v={highlighted:!0,invalidated:!0,metadata:{viewPlaneNormal:[...d],enabledElement:l,viewUp:[...h],FrameOfReferenceUID:y,referencedImageId:g,toolName:this.getToolName(),volumeId:m},data:{label:"",handles:{textBox:{hasMoved:!1,worldPosition:null,worldBoundingBox:null},points:[[...s],[...s],[...s],[...s]],activeHandleIndex:null},segmentationId:null}};mr(v,o);const x=fn(o,this.getToolName());return this.editData={annotation:v,viewportIdsToRender:x,handleIndex:3,newAnnotation:!0,hasMoved:!1},this._activateDraw(o),Rn(o),r.preventDefault(),at(x),v},this.renderAnnotation=(r,i)=>{let a=!1;const{viewport:o}=r,{element:s}=o;let l=Zi(this.getToolName(),s);if(!l?.length||(l=this.filterInteractableAnnotationsForElement(s,l),!l?.length))return a;const c={toolGroupId:this.toolGroupId,toolName:this.getToolName(),viewportId:r.viewport.id};for(let f=0;f<l.length;f++){const u=l[f],{annotationUID:d,data:h}=u,{points:p,activeHandleIndex:g}=h.handles,m=p.map(T=>o.worldToCanvas(T));c.annotationUID=d;const y=this.getStyle("lineWidth",c,u),v=this.getStyle("lineDash",c,u),x=this.getStyle("color",c,u);if(!o.getRenderingEngine())return console.warn("Rendering Engine has been destroyed"),a;Un(u,s);let w;if(!xo(d))continue;!yo(d)&&!this.editData&&g!==null&&(w=[m[g]]),w&&bo(i,d,"0",w,{color:x}),BO(i,d,"0",m[0],m[3],{color:x,lineDash:v,lineWidth:y}),a=!0}return a}}}Vv.toolName="RectangleROIThreshold";const nGe={[jt.OnInteractionStart]:t=>{const{segmentIndex:e,previewSegmentIndex:n,segmentationVoxelManager:r,centerIJK:i,viewPlaneNormal:a,segmentationImageData:o,configuration:s}=t;if(!s?.useCenterSegmentIndex)return;let l=!1,c=!1;const f=[...r.getBoundsIJK()];Math.abs(a[0])>.8?f[0]=[i[0],i[0]]:Math.abs(a[1])>.8?f[1]=[i[1],i[1]]:Math.abs(a[2])>.8&&(f[2]=[i[2],i[2]]);const u=({value:h})=>{l||=h===e,c||=h===n};if(r.forEach(u,{imageData:o,isInObject:t.isInObject,boundsIJK:f}),!l&&!c){t.centerSegmentIndexInfo.segmentIndex=null;return}const d=r.getAtIJKPoint(i);t.centerSegmentIndexInfo.segmentIndex=d,t.centerSegmentIndexInfo.hasSegmentIndex=l,t.centerSegmentIndexInfo.hasPreviewIndex=c}},rGe={[jt.Initialize]:t=>{const{operationName:e,centerIJK:n,segmentationVoxelManager:r,imageVoxelManager:i,configuration:a,segmentIndex:o,viewport:s}=t;if(!a?.threshold?.isDynamic||!n||!o||e===jt.RejectPreview||e===jt.OnInteractionEnd)return;const l=r.getBoundsIJK(),{range:c,dynamicRadius:f=0}=a.threshold,u=c?0:f,{viewPlaneNormal:d}=s.getCamera(),h=l.map((y,v)=>{const[x,w]=y;return[Math.max(x,n[v]-u),Math.min(w,n[v]+u)]});Math.abs(d[0])>.8?h[0]=[n[0],n[0]]:Math.abs(d[1])>.8?h[1]=[n[1],n[1]]:Math.abs(d[2])>.8&&(h[2]=[n[2],n[2]]);const p=c||[1/0,-1/0],g=u*u,m=({value:y,pointIJK:v})=>{if(gwe(n,v)>g)return;const w=Array.isArray(y)?E_(y):y;p[0]=Math.min(w,p[0]),p[1]=Math.max(w,p[1])};i.forEach(m,{boundsIJK:h}),a.threshold.range=p},[jt.OnInteractionStart]:t=>{const{configuration:e}=t;e?.threshold?.isDynamic&&(e.threshold.range=null)},[jt.ComputeInnerCircleRadius]:t=>{const{configuration:e,viewport:n}=t,{dynamicRadius:r=0,isDynamic:i}=e.threshold;if(!i){e.threshold.dynamicRadiusInCanvas=0;return}if(r===0)return;const a=n.getImageData();if(!a)return;const{spacing:o}=a,s=[n.element.clientWidth/2,n.element.clientHeight/2],l=r*o[0],f=n.canvasToWorld(s).map(h=>h+l),u=n.worldToCanvas(f),d=Math.abs(s[0]-u[0]);e.threshold.dynamicRadiusInCanvas||(e.threshold.dynamicRadiusInCanvas=0),e.threshold.dynamicRadiusInCanvas=3+d}},iGe={[jt.Initialize]:t=>{t.segmentIndex=0}},{isEqual:U8}=Yr,oB={toIJK:t=>t,fromIJK:t=>t,type:"acquistion"},aGe={toIJK:([t,e,n])=>[n,t,e],fromIJK:([t,e,n])=>[e,n,t],type:"jk"},oGe={toIJK:([t,e,n])=>[t,n,e],fromIJK:([t,e,n])=>[t,n,e],type:"ik"};function sGe(t,e){if(!(t instanceof mo))return{...oB,boundsIJKPrime:e};const{viewPlaneNormal:n}=t.getCamera(),r=U8(Math.abs(n[0]),1)&&aGe||U8(Math.abs(n[1]),1)&&oGe||U8(Math.abs(n[2]),1)&&oB;return r?{...r,boundsIJKPrime:r.fromIJK(e)}:{toIJK:null,boundsIJKPrime:null,fromIJK:null,error:`Only mappings orthogonal to acquisition plane are permitted, but requested ${n}`}}const{RLEVoxelMap:lGe,VoxelManager:cGe}=Yr,uGe=65535;var co;(function(t){t[t.SEGMENT=-1]="SEGMENT",t[t.ISLAND=-2]="ISLAND",t[t.INTERIOR=-3]="INTERIOR",t[t.EXTERIOR=-4]="EXTERIOR",t[t.INTERIOR_SMALL=-5]="INTERIOR_SMALL",t[t.INTERIOR_TEST=-6]="INTERIOR_TEST"})(co||(co={}));class H3{constructor(e){this.fillInternalEdge=!1,this.maxInternalRemove=128,this.maxInternalRemove=e?.maxInternalRemove??this.maxInternalRemove,this.fillInternalEdge=e?.fillInternalEdge??this.fillInternalEdge}initialize(e,n,r){const i=!!n.sourceVoxelManager,a=i?n.sourceVoxelManager:n,o=i?n:cGe.createRLEHistoryVoxelManager(a),{segmentIndex:s=1,previewSegmentIndex:l=1}=r,c=r.points||a.getPoints();if(!c?.length)return;const f=a.getBoundsIJK().map((w,S)=>[Math.min(w[0],...c.map(T=>T[S])),Math.max(w[1],...c.map(T=>T[S]))]);if(f.find(w=>w[0]<0||w[1]>uGe))return;const{toIJK:u,fromIJK:d,boundsIJKPrime:h,error:p}=sGe(e,f);if(p){console.warn("Not performing island removal for planes not orthogonal to acquisition plane",p);return}const[g,m,y]=d(a.dimensions),v=new lGe(g,m,y),x=(w,S,T)=>{const _=a.toIndex(u([w,S,T])),D=a.getAtIndex(_);if(D===l||D===s)return co.SEGMENT};return v.fillFrom(x,h),v.normalizer={toIJK:u,fromIJK:d,boundsIJKPrime:h},this.segmentSet=v,this.previewVoxelManager=o,this.segmentIndex=s,this.previewSegmentIndex=l??s,this.selectedPoints=c,!0}floodFillSegmentIsland(){const{selectedPoints:e,segmentSet:n}=this;let r=0;const{fromIJK:i}=n.normalizer;return e.forEach(a=>{const o=i(a),s=n.toIndex(o),[l,c,f]=o;n.get(s)===co.SEGMENT&&(r+=n.floodFill(l,c,f,co.ISLAND))}),r}removeExternalIslands(){const{previewVoxelManager:e,segmentSet:n}=this,{toIJK:r}=n.normalizer,i=(a,o)=>{const[,s,l]=n.toIJK(a);if(o.value!==co.ISLAND)for(let c=o.start;c<o.end;c++){const f=r([c,s,l]),u=e.getAtIJKPoint(f);e.setAtIJKPoint(f,u===void 0?0:null)}};n.forEach(i,{rowModified:!0})}removeInternalIslands(){const{segmentSet:e,previewVoxelManager:n,previewSegmentIndex:r}=this,{height:i,normalizer:a,width:o}=e,{toIJK:s}=a;return e.forEachRow((l,c)=>{let f;for(const u of[...c])if(u.value===co.ISLAND){if(!f){if(this.fillInternalEdge&&u.start>0)for(let d=0;d<u.start;d++)e.set(l+d,co.INTERIOR);f=u;continue}for(let d=f.end;d<u.start;d++)e.set(l+d,co.INTERIOR);f=u}if(this.fillInternalEdge&&f?.end<o)for(let u=f.end;u<o;u++)e.set(l+u,co.INTERIOR)}),e.forEach((l,c)=>{if(c.value!==co.INTERIOR)return;const[,f,u]=e.toIJK(l),d=f>0?e.getRun(f-1,u):null,h=f+1<i?e.getRun(f+1,u):null,p=f===i-1,g=f===0,m=H3.covers(c,d)||g&&this.fillInternalEdge,y=H3.covers(c,h)||p&&this.fillInternalEdge;c.end-c.start>2&&(!m||!y)&&e.floodFill(c.start,f,u,co.EXTERIOR,{singlePlane:!0})}),e.forEach((l,c)=>{if(c.value!==co.INTERIOR)return;const[,f,u]=e.toIJK(l),p=e.floodFill(c.start,f,u,co.INTERIOR_TEST)>this.maxInternalRemove?co.EXTERIOR:co.INTERIOR_SMALL;e.floodFill(c.start,f,u,p)}),e.forEach((l,c)=>{if(c.value===co.INTERIOR_SMALL)for(let f=c.start;f<c.end;f++){const u=s(e.toIJK(l+f));n.setAtIJKPoint(u,r)}}),n.getArrayOfModifiedSlices()}static covers(e,n){if(!n)return!1;let{start:r}=e;const{end:i}=e;for(const a of n)if(r>=a.start&&r<a.end&&(r=a.end,r>=i))return!0;return!1}}const fGe={[jt.OnInteractionEnd]:t=>{const{previewSegmentIndex:e,segmentIndex:n,viewport:r,segmentationVoxelManager:i,activeStrategy:a,memo:o}=t;if(a!=="THRESHOLD_INSIDE_SPHERE_WITH_ISLAND_REMOVAL"||n===null)return;const s=new H3,l=o?.voxelManager||i;if(!s.initialize(r,l,{previewSegmentIndex:e,segmentIndex:n}))return;s.floodFillSegmentIsland(),s.removeExternalIslands(),s.removeInternalIslands();const c=l.getArrayOfModifiedSlices();c&&Wf(t.segmentationId,c,e)}},dGe={[jt.Preview]:function(t){const{previewSegmentIndex:e,configuration:n,enabledElement:r}=t;if(!e||!n)return;this.onInteractionStart?.(r,t);const i=this.fill(r,t);return i&&this.onInteractionEnd?.(r,t),i},[jt.Initialize]:t=>{const{segmentIndex:e,previewColor:n,previewSegmentIndex:r}=t;if(t.modified=!1,r==null||e==null)return;gS(t.segmentationId)?.forEach(a=>{mBe(a,t.segmentationId,r,n)}),t.modified=!0},[jt.AcceptPreview]:t=>{const{previewSegmentIndex:e,segmentationVoxelManager:n,memo:r,segmentIndex:i,centerSegmentIndexInfo:a}=t||{},{changedIndices:o}=a||{},s=r,l=({index:c})=>{const f=n.getAtIndex(c);o?.length>0?o.includes(c)&&s.voxelManager.setAtIndex(c,0):f===e&&s.voxelManager.setAtIndex(c,i)};n.forEach(l),Wf(t.segmentationId,n.getArrayOfModifiedSlices(),i),t.centerSegmentIndexInfo.changedIndices=[]},[jt.RejectPreview]:t=>{t&&eee.undoIf(e=>{const n=e;if(!n?.voxelManager)return!1;const{segmentationVoxelManager:r}=n;let i=!1;const a=({value:o})=>{o===t.previewSegmentIndex&&(i=!0)};return r.forEach(a),i})}},hGe={[jt.Fill]:t=>{const{segmentsLocked:e,segmentationImageData:n,segmentationVoxelManager:r,brushStrategy:i,centerIJK:a}=t,o=i.createIsInThreshold?.(t),{setValue:s}=i,l=o?c=>{const{value:f,index:u}=c;e.includes(f)||!o(u)||s(t,c)}:c=>s(t,c);r.forEach(l,{imageData:n,isInObject:t.isInObject,boundsIJK:t.isInObjectBoundsIJK}),r.addPoint(a)}};function pGe({operationData:t,existingValue:e,index:n}){const{previewSegmentIndex:r,memo:i,centerSegmentIndexInfo:a,previewOnHover:o,segmentIndex:s}=t,{hasPreviewIndex:l,hasSegmentIndex:c,segmentIndex:f}=a;if(f===0&&c&&l){if(e===s||o)return;if(e===r){i.voxelManager.setAtIndex(n,0);return}return}if(f===0&&c&&!l){if(e===0||e!==s)return;i.voxelManager.setAtIndex(n,r),a.changedIndices.push(n);return}if(f===0&&!c&&l){if(e===s||o)return;if(e===r){i.voxelManager.setAtIndex(n,0);return}return}if(f===0&&!c&&!l){if(e===s)return;if(e===r){i.voxelManager.setAtIndex(n,r);return}return}if(f===r&&c&&l){if(e===s)return;i.voxelManager.setAtIndex(n,r);return}if(f===r&&!c&&l){if(e===s)return;i.voxelManager.setAtIndex(n,r);return}if(f===s&&c&&l){if(e===s)return;i.voxelManager.setAtIndex(n,r);return}if(f===s&&c&&!l){if(e===s)return;i.voxelManager.setAtIndex(n,r);return}}const gGe={[jt.INTERNAL_setValue]:(t,{value:e,index:n})=>{const{segmentsLocked:r,previewSegmentIndex:i,memo:a,segmentationVoxelManager:o,centerSegmentIndexInfo:s,segmentIndex:l}=t,c=o.getAtIndex(n);if(!r.includes(e)&&!(!s&&c===l)&&!(s?.segmentIndex!==0&&c===l)){if(s?.segmentIndex===null){a.voxelManager.setAtIndex(n,i??l);return}if(!i){let f=l;s&&(f=s.segmentIndex),a.voxelManager.setAtIndex(n,f);return}pGe({operationData:t,existingValue:c,index:n})}}},mGe={[jt.CreateIsInThreshold]:t=>{const{imageVoxelManager:e,segmentIndex:n,configuration:r}=t;if(!(!r||!n))return i=>{const a=e.getAtIndex(i),o=Array.isArray(a)?Vo(a):a,{threshold:s}=r||{};return s?.range?.length?s.range[0]<=o&&o<=s.range[1]:!0}}},sB=10;function lB(){return{maxIJKs:[]}}function vGe(t,e){const{value:n}=e,{maxIJKs:r}=t,i=r.length;if(typeof n!="number"||i>=sB&&n<r[0].value)return;const a={value:e.value,pointLPS:e.pointLPS?[e.pointLPS[0],e.pointLPS[1],e.pointLPS[2]]:void 0,pointIJK:e.pointIJK?[e.pointIJK[0],e.pointIJK[1],e.pointIJK[2]]:void 0};if(!i||n>=r[i-1].value)r.push(a);else for(let o=0;o<i;o++)if(n<=r[o].value){r.splice(o,0,a);break}i>=sB&&r.splice(0,1)}function yGe(t,e,n){const{spacing:r,calibration:i}=n,{volumeUnit:a}=Cc({calibration:i,hasPixelSpacing:!0},[]),o=r?r[0]*r[1]*r[2]:1;return e.volume={value:Array.isArray(e.count.value)?e.count.value.map(s=>s*o):e.count.value*o,unit:a,name:"volume",label:"Volume"},e.maxIJKs=t.maxIJKs.filter(s=>s.pointIJK!==void 0),e.array.push(e.volume),t.maxIJKs=[],e}const gM=class gM extends f0{static statsInit(e){super.statsInit(e),this.volumetricState=lB()}static statsCallback(e){super.statsCallback(e),vGe(this.volumetricState,e)}static getStatistics(e){const n={...e,unit:e?.unit||"none",calibration:e?.calibration,hasPixelSpacing:e?.hasPixelSpacing},r=super.getStatistics(n);return yGe(this.volumetricState,r,n)}};gM.volumetricState=lB();let rm=gM;const xGe=Math.pow(3*1e3/(4*Math.PI),1/3);async function bGe({segmentationId:t,segmentIndices:e,mode:n="collective"}){j$e(),W3(Gh.COMPUTE_STATISTICS,0);const r=X$e(t,e);if(!r)return;const{operationData:i,segVolumeId:a,segImageIds:o,reconstructableVolume:s,indices:l}=r,{refImageId:c,modalityUnitOptions:f}=Z$e(a,o),u=xBe(c,f);return s?await wGe({operationData:i,indices:l,unit:u,mode:n}):await CGe({segImageIds:o,indices:l,unit:u,mode:n})}async function wGe({operationData:t,indices:e,unit:n,mode:r}){const i=Y$e(t),{segmentationVoxelManager:a,imageVoxelManager:o,segmentationImageData:s,imageData:l}=i;if(!a||!s)return;const c=s.getSpacing(),{boundsIJK:f}=a;if(!f)return rm.getStatistics({spacing:c});const d={scalarData:a.getCompleteScalarDataArray(),dimensions:s.getDimensions(),spacing:s.getSpacing(),origin:s.getOrigin(),direction:s.getDirection()},h={scalarData:o.getCompleteScalarDataArray(),dimensions:l.getDimensions(),spacing:l.getSpacing(),origin:l.getOrigin(),direction:l.getDirection()};if(!h.scalarData?.length)return;const p=await Bm().executeTask("compute","calculateSegmentsStatisticsVolume",{segmentationInfo:d,imageInfo:h,indices:e,unit:n,mode:r});if(W3(Gh.COMPUTE_STATISTICS,100),r==="collective")return K3({stats:p,unit:n,spacing:c,segmentationImageData:s,imageVoxelManager:o});{const g={};return Object.entries(p).forEach(([m,y])=>{g[m]=K3({stats:y,unit:n,spacing:c,segmentationImageData:s,imageVoxelManager:o})}),g}}const B8=(t,e)=>{if(!t.array)return;const n=t.array.findIndex(r=>r.name===e.name);n!==-1?t.array[n]=e:t.array.push(e)},K3=({stats:t,unit:e,spacing:n,segmentationImageData:r,imageVoxelManager:i})=>{if(t.mean.unit=e,t.max.unit=e,t.min.unit=e,e!=="SUV")return t;const a=n.map(o=>Math.max(1,Math.round(1.1*xGe/o)));for(const o of t.maxIJKs){const s=SGe(o,a,r,i,n);if(!s)continue;const{mean:l}=s;(!t.peakValue||t.peakValue.value<=l.value)&&(t.peakValue={name:"peakValue",label:"Peak Value",value:l.value,unit:e},t.peakPoint={name:"peakLPS",label:"Peak SUV Point",value:o.pointLPS?[...o.pointLPS]:null,unit:null},B8(t,t.peakValue),B8(t,t.peakPoint))}if(t.volume&&t.mean){const o=t.volume.value,s=t.mean.value;t.lesionGlycolysis={name:"lesionGlycolysis",label:"Lesion Glycolysis",value:o*s,unit:`${t.volume.unit}·${e}`},B8(t,t.lesionGlycolysis)}return t};async function CGe({segImageIds:t,indices:e,unit:n,mode:r}){W3(Gh.COMPUTE_STATISTICS,0);const{segmentationInfo:i,imageInfo:a}=J$e(t),o=await Bm().executeTask("compute","calculateSegmentsStatisticsStack",{segmentationInfo:i,imageInfo:a,indices:e,mode:r});W3(Gh.COMPUTE_STATISTICS,100);const s=i[0].spacing,l=i[0],c=a[0].voxelManager;if(r==="collective")return K3({stats:o,unit:n,spacing:s,segmentationImageData:l,imageVoxelManager:c});{const f={};return Object.entries(o).forEach(([u,d])=>{f[u]=K3({stats:d,unit:n,spacing:s,segmentationImageData:l,imageVoxelManager:c})}),f}}function SGe(t,e,n,r,i){const{pointIJK:a,pointLPS:o}=t;if(!a)return;const s=a.map((f,u)=>[f-e[u],f+e[u]]),l=(f,u)=>{const d=(u[0]-a[0])/e[0],h=(u[1]-a[1])/e[1],p=(u[2]-a[2])/e[2];return d*d+h*h+p*p<=1},c=({pointIJK:f,pointLPS:u})=>{const d=r.getAtIJKPoint(f);d!==void 0&&rm.statsCallback({value:d,pointLPS:u,pointIJK:f})};return rm.statsInit({storePointData:!1}),N7(n,{pointInShapeFn:l,callback:c,boundsIJK:s}),rm.getStatistics({spacing:i})}const TGe={[jt.GetStatistics]:function(t,e,n){const{indices:r}=n,{segmentationId:i,viewport:a}=e;bGe({segmentationId:i,segmentIndices:r})}},Mn={determineSegmentIndex:nGe,dynamicThreshold:rGe,erase:iGe,islandRemoval:fGe,preview:dGe,regionFill:hGe,setValue:gGe,threshold:mGe,labelmapStatistics:TGe,ensureSegmentationVolumeFor3DManipulation:Wne,ensureImageVolumeFor3DManipulation:Hne},ah=class ah{constructor(e,...n){this._initialize=[],this._fill=[],this._onInteractionStart=[],this.fill=(r,i)=>{const a=this.initialize(r,i,jt.Fill);if(!a)return;this._fill.forEach(l=>l(a));const{segmentationVoxelManager:o,segmentIndex:s}=a;return Wf(a.segmentationId,o.getArrayOfModifiedSlices(),s),a},this.onInteractionStart=(r,i)=>{const a=this.initialize(r,i);a&&this._onInteractionStart.forEach(o=>o.call(this,a))},this.addPreview=(r,i)=>{const a=this.initialize(r,i,jt.AddPreview);if(a)return a},this.configurationName=e,this.compositions=n,n.forEach(r=>{const i=typeof r=="function"?r():r;if(i)for(const a in i){if(!ah.childFunctions[a])throw new Error(`Didn't find ${a} as a brush strategy`);ah.childFunctions[a](this,i[a])}}),this.strategyFunction=(r,i)=>this.fill(r,i);for(const r of Object.keys(ah.childFunctions))this.strategyFunction[r]=this[r]}initialize(e,n,r){const{viewport:i}=e,a=JO({operationData:n,viewport:i,strategy:this});if(!a)return null;const{imageVoxelManager:o,segmentationVoxelManager:s,segmentationImageData:l}=a,c=n.createMemo(n.segmentationId,s),f={operationName:r,...n,segmentIndex:n.segmentIndex,enabledElement:e,imageVoxelManager:o,segmentationVoxelManager:s,segmentationImageData:l,viewport:i,centerWorld:null,isInObject:null,isInObjectBoundsIJK:null,brushStrategy:this,memo:c};return this._initialize.forEach(u=>u(f)),f}};ah.COMPOSITIONS=Mn,ah.childFunctions={[jt.OnInteractionStart]:oc(jt.OnInteractionStart,jt.Initialize),[jt.OnInteractionEnd]:oc(jt.OnInteractionEnd,jt.Initialize),[jt.Fill]:oc(jt.Fill),[jt.Initialize]:oc(jt.Initialize),[jt.CreateIsInThreshold]:bb(jt.CreateIsInThreshold),[jt.Interpolate]:oc(jt.Interpolate,jt.Initialize),[jt.AcceptPreview]:oc(jt.AcceptPreview,jt.Initialize),[jt.RejectPreview]:oc(jt.RejectPreview,jt.Initialize),[jt.INTERNAL_setValue]:bb(jt.INTERNAL_setValue),[jt.Preview]:bb(jt.Preview,!1),[jt.ComputeInnerCircleRadius]:oc(jt.ComputeInnerCircleRadius),[jt.EnsureSegmentationVolumeFor3DManipulation]:oc(jt.EnsureSegmentationVolumeFor3DManipulation),[jt.EnsureImageVolumeFor3DManipulation]:oc(jt.EnsureImageVolumeFor3DManipulation),[jt.AddPreview]:oc(jt.AddPreview),[jt.GetStatistics]:bb(jt.GetStatistics),compositions:null};let Sc=ah;function oc(t,e){const n=`_${t}`;return(r,i)=>{r[n]||=[],r[n].push(i),r[t]||=e?(a,o,...s)=>{const l=r[e](a,o,t);let c;return r[n].forEach(f=>{const u=f.call(r,l,...s);c||=u}),c}:(a,...o)=>{r[n].forEach(s=>s.call(r,a,...o))}}}function bb(t,e=!0){return(n,r)=>{if(n[t])throw new Error(`The singleton method ${t} already exists`);n[t]=e?r:(i,a,...o)=>(a.enabledElement=i,r.call(n,a,...o))}}function EGe(t,e){const{center:n,radius:r}=t,i=t.radius2||r*r;return(e[0]-n[0])*(e[0]-n[0])+(e[1]-n[1])*(e[1]-n[1])+(e[2]-n[2])*(e[2]-n[2])<=i}const{transformWorldToIndex:cB,isEqual:_Ge}=Yr;function Kne(t){const[e,n,r,i]=t,a=[r[0],n[1]],o=[i[0],e[1]],s=[r[0],e[1]],l=[i[0],n[1]];return[a,o,s,l]}const qne={[jt.Initialize]:t=>{const{points:e,viewport:n,segmentationImageData:r}=t;if(!e)return;const i=it();e.length>=2?(Ul(i,e[0],e[1]),tl(i,i,.5)):t7(i,e[0]),t.centerWorld=i,t.centerIJK=cB(r,i);const a=e.map(f=>n.worldToCanvas(f)),s=Kne(a).map(f=>n.canvasToWorld(f)),l=e.map(f=>cB(r,f)),c=MO(l,r.getDimensions());t.isInObject=Xne(s),t.isInObjectBoundsIJK=c}};function Xne(t=[]){if(!t||t.length!==4)throw new Error("createPointInEllipse: cornersInWorld must have 4 points");const[e,n,r,i]=t,a=it();Ul(a,e,n),tl(a,a,.5);const o=it();Pr(o,i,e);const s=Vo(o)/2;Lr(o,o);const l=it();Pr(l,r,e);const c=Vo(l)/2;Lr(l,l);const f=it();if(gr(f,o,l),Lr(f,f),_Ge(s,c)){const u=s,d={center:a,radius:u,radius2:u*u};return h=>EGe(d,h)}return u=>{const d=it();Pr(d,u,a);const h=zt(d,f),p=it();Ar(p,d,f,-h);const g=it(),m=it();Pr(m,a,e),Pr(g,p,m);const y=zt(g,o),v=zt(g,l);return y*y/(s*s)+v*v/(c*c)<=1}}const Yne=new Sc("Circle",Mn.regionFill,Mn.setValue,qne,Mn.determineSegmentIndex,Mn.preview,Mn.labelmapStatistics),DGe=new Sc("CircleThreshold",Mn.regionFill,Mn.setValue,qne,Mn.determineSegmentIndex,Mn.dynamicThreshold,Mn.threshold,Mn.preview,Mn.islandRemoval,Mn.labelmapStatistics),ZO=Yne.strategyFunction,OGe=DGe.strategyFunction,{transformWorldToIndex:MGe}=Yr,IGe={[jt.Initialize]:t=>{const{points:e,viewport:n,segmentationImageData:r}=t;if(!e)return;const i=it();e.length>=2?(Ul(i,e[0],e[1]),tl(i,i,.5)):t7(i,e[0]),t.centerWorld=i,t.centerIJK=MGe(r,i);const{boundsIJK:a}=$$e(e.slice(0,2),r,n),o=e.map(c=>n.worldToCanvas(c)),l=Kne(o).map(c=>n.canvasToWorld(c));t.isInObjectBoundsIJK=a,t.isInObject=Xne(l)}},ES=new Sc("Sphere",Mn.regionFill,Mn.setValue,IGe,Mn.determineSegmentIndex,Mn.preview,Mn.labelmapStatistics,Mn.ensureSegmentationVolumeFor3DManipulation),Jne=ES.strategyFunction,RGe=new Sc("SphereThreshold",...ES.compositions,Mn.dynamicThreshold,Mn.threshold,Mn.ensureSegmentationVolumeFor3DManipulation,Mn.ensureImageVolumeFor3DManipulation),PGe=new Sc("SphereThreshold",...ES.compositions,Mn.dynamicThreshold,Mn.threshold,Mn.islandRemoval,Mn.ensureSegmentationVolumeFor3DManipulation,Mn.ensureImageVolumeFor3DManipulation),AGe=RGe.strategyFunction,NGe=PGe.strategyFunction,LGe=new Sc("EraseSphere",Mn.erase,...ES.compositions),Zne=LGe.strategyFunction,kGe=new Sc("EraseCircle",Mn.erase,...Yne.compositions),Qne=kGe.strategyFunction,{VoxelManager:p9,RLEVoxelMap:VGe}=Yr;function uB(t,e){return UGe(t,e)}function FGe(t){const{segmentationVoxelManager:e,undoVoxelManager:n,redoVoxelManager:r}=this,i=t===!1?r:n;i.forEach(({value:o,pointIJK:s})=>{e.setAtIJKPoint(s,o)});const a=i.getArrayOfModifiedSlices();Wf(this.segmentationId,a)}function UGe(t,e){const n=p9.createRLEHistoryVoxelManager(e);return{segmentationId:t,restoreMemo:FGe,commitMemo:BGe,segmentationVoxelManager:e,voxelManager:n,id:cr(),operationType:"labelmap"}}function BGe(){if(this.redoVoxelManager)return!0;if(!this.voxelManager.modifiedSlices.size)return!1;const{segmentationVoxelManager:t}=this,e=p9.createRLEHistoryVoxelManager(t);VGe.copyMap(e.map,this.voxelManager.map);for(const r of this.voxelManager.modifiedSlices.keys())e.modifiedSlices.add(r);this.undoVoxelManager=e;const n=p9.createRLEVolumeVoxelManager({dimensions:this.segmentationVoxelManager.dimensions});return this.redoVoxelManager=n,e.forEach(({index:r,pointIJK:i,value:a})=>{const o=t.getAtIJKPoint(i);o!==a&&n.setAtIndex(r,o)}),!0}const{transformWorldToIndex:ere}=Yr,tre={[jt.Initialize]:t=>{const{points:e,viewport:n,segmentationImageData:r}=t;if(!e)return;const i=Sn(0,0,0);e.forEach(s=>{Ul(i,i,s)}),tl(i,i,1/e.length),t.centerWorld=i,t.centerIJK=ere(r,i);const{boundsIJK:a,pointInShapeFn:o}=$Ge(n,e,r);t.isInObject=o,t.isInObjectBoundsIJK=a}};function $Ge(t,e,n){let r=e.map(x=>ere(n,x));r=r.map(x=>x.map(w=>Math.round(w)));const i=MO(r,n.getDimensions()),[a,o,s,l]=e,c=it(),f=it();Pr(c,o,a),Pr(f,l,a);const u=Vo(c),d=Vo(f);Lr(c,c),Lr(f,f);const h=it();gr(h,c,f),Lr(h,h);const p=n.getDirection(),g=n.getSpacing(),{viewPlaneNormal:m}=t.getCamera(),y=Jh({direction:p,spacing:g},m);return{boundsIJK:i,pointInShapeFn:x=>{const w=it();Pr(w,x,a);const S=zt(w,c),T=zt(w,f),_=Math.abs(zt(w,h));return S>=-y&&S<=u+y&&T>=-y&&T<=d+y&&_<=y}}}const GGe=new Sc("Rectangle",Mn.regionFill,Mn.setValue,tre,Mn.determineSegmentIndex,Mn.preview,Mn.labelmapStatistics),jGe=new Sc("RectangleThreshold",Mn.regionFill,Mn.setValue,tre,Mn.determineSegmentIndex,Mn.dynamicThreshold,Mn.threshold,Mn.preview,Mn.islandRemoval,Mn.labelmapStatistics),nre=GGe.strategyFunction;jGe.strategyFunction;const x2=class x2 extends $f{constructor(e,n){super(e,n),this.memoMap=new Map,this.acceptedMemoIds=new Map,this.centerSegmentIndexInfo={segmentIndex:null,hasSegmentIndex:!1,hasPreviewIndex:!1,changedIndices:[]}}_historyRedoHandler(e){const{id:n,operationType:r}=e.detail;if(r==="labelmap"){if(this.acceptedMemoIds.has(n)){this._hoverData=null;const i=this.acceptedMemoIds.get(n),a=i?.element,o=this.getOperationData(a);o.segmentIndex=i?.segmentIndex,a&&this.applyActiveStrategyCallback(Xe(a),o,jt.AcceptPreview)}this._previewData.isDrag=!0}}get _previewData(){return x2.previewData}hasPreviewData(){return!!this._previewData.preview}shouldResolvePreviewRequests(){return(this.mode==="Active"||this.mode==="Enabled")&&this.hasPreviewData()}createMemo(e,n){const r=n.id;if(this.memo&&this.memo.segmentationVoxelManager===n)return this.memo;let i=this.memoMap.get(r);return i?i.redoVoxelManager&&(i=uB(e,n),this.memoMap.set(r,i)):(i=uB(e,n),this.memoMap.set(r,i)),this.memo=i,i}createEditData(e){const n=Xe(e),{viewport:r}=n,i=ly(r.id);if(!i){const c=new CustomEvent(mt.ERROR_EVENT,{detail:{type:"Segmentation",message:"No active segmentation detected, create a segmentation representation before using the brush tool"},cancelable:!0});return vt.dispatchEvent(c),null}const{segmentationId:a}=i,o=qy(a),{representationData:s}=ea(a);return this.getEditData({viewport:r,representationData:s,segmentsLocked:o,segmentationId:a})}getEditData({viewport:e,representationData:n,segmentsLocked:r,segmentationId:i}){if(e instanceof mo){const{volumeId:a}=n[hn.Labelmap],o=e.getActors();if(e instanceof fa){const u=new CustomEvent(mt.ERROR_EVENT,{detail:{type:"Segmentation",message:"Cannot perform brush operation on the selected viewport"},cancelable:!0});return vt.dispatchEvent(u),null}const l=o.map(u=>yt.getVolume(u.referencedId)),c=yt.getVolume(a),f=l.find(u=>pr(u.dimensions,c.dimensions))?.volumeId||l[0]?.volumeId;return{volumeId:a,referencedVolumeId:this.configuration.threshold?.volumeId??f,segmentsLocked:r}}else{const a=yS(e.id,i);return a?{imageId:a,segmentsLocked:r}:void 0}}createHoverData(e,n){const r=Xe(e),{viewport:i}=r,a=i.getCamera(),{viewPlaneNormal:o,viewUp:s}=a,l=[i.id],{segmentIndex:c,segmentationId:f,segmentColor:u}=this.getActiveSegmentationData(i)||{};return{brushCursor:{metadata:{viewPlaneNormal:[...o],viewUp:[...s],FrameOfReferenceUID:i.getFrameOfReferenceUID(),referencedImageId:"",toolName:this.getToolName(),segmentColor:u},data:{}},centerCanvas:n,segmentIndex:c,viewport:i,segmentationId:f,segmentColor:u,viewportIdsToRender:l}}getActiveSegmentationData(e){const n=e.id,r=ly(n);if(!r)return;const{segmentationId:i}=r,a=Su(i);if(!a)return;const o=Wh(n,i,a);return{segmentIndex:a,segmentationId:i,segmentColor:o}}getOperationData(e){const n=this._editData||this.createEditData(e),{segmentIndex:r,segmentationId:i,brushCursor:a}=this._hoverData||this.createHoverData(e),{data:o,metadata:s={}}=a||{},{viewPlaneNormal:l,viewUp:c}=s,f=this.configuration.preview?.previewColors?.[r],{viewport:u}=Xe(e),d=Wh(u.id,i,r);if(!f&&!d)return;let h=null,p=null;return this.configuration.preview?.enabled&&(h=f||zGe(...d),p=255),{...n,points:o?.handles?.points,segmentIndex:r,viewPlaneNormal:l,previewOnHover:!this._previewData.isDrag,toolGroupId:this.toolGroupId,segmentationId:i,viewUp:c,centerSegmentIndexInfo:this.centerSegmentIndexInfo,activeStrategy:this.configuration.activeStrategy,configuration:this.configuration,previewColor:h,previewSegmentIndex:p,createMemo:this.createMemo.bind(this)}}addPreview(e=this._previewData.element,n){const{_previewData:r}=this,i=n?.acceptReject;i===!0?this.acceptPreview(e):i===!1&&this.rejectPreview(e);const a=Xe(e),o=this.applyActiveStrategyCallback(a,this.getOperationData(e),jt.AddPreview);return r.isDrag=!0,o?.modified&&(r.preview=o,r.element=e),o}rejectPreview(e=this._previewData.element){if(!e)return;this.doneEditMemo();const n=Xe(e);this.applyActiveStrategyCallback(n,this.getOperationData(e),jt.RejectPreview),this._previewData.preview=null,this._previewData.isDrag=!1}acceptPreview(e=this._previewData.element){if(!e)return;const n=this.getOperationData(e);this.memo&&this.memo.id&&this.acceptedMemoIds.set(this.memo.id,{element:e,segmentIndex:n.segmentIndex});const r=Xe(e);this.applyActiveStrategyCallback(r,n,jt.AcceptPreview),this.doneEditMemo(),this._previewData.preview=null,this._previewData.isDrag=!1}static viewportContoursToLabelmap(e,n){const r=n?.removeContours??!0,i=sS(),a=zO(e,i);if(!a?.length)return;const o=a.filter(m=>m.data.contour?.polyline?.length);if(!o.length)return;const l=new x2({},{configuration:{strategies:{FILL_INSIDE_CIRCLE:ZO},activeStrategy:"FILL_INSIDE_CIRCLE"}}).addPreview(e.element),{memo:c,segmentationId:f}=l,u=c?.voxelManager,d=u.sourceVoxelManager||u,{dimensions:h}=u,p=e.getDefaultActor().actor.getMapper().getInputData();for(const m of o){const y=[[1/0,-1/0],[1/0,-1/0],[1/0,-1/0]],{polyline:v}=m.data.contour;for(const O of v)p.worldToIndex(O).forEach((N,A)=>{y[A][0]=Math.min(y[A][0],N),y[A][1]=Math.max(y[A][1],N)});y.forEach((O,P)=>{O[0]=Math.round(Math.max(0,O[0])),O[1]=Math.round(Math.min(h[P]-1,O[1]))});const x=Su(f),w=m.data.handles?.[0]||v[0],S=p.worldToIndex(w).map(Math.round),T=d.getAtIJKPoint(S)||0;let _=!1,D=!1;for(const O of v){const P=p.worldToIndex(O).map(Math.round),N=d.getAtIJKPoint(P);N===T?_=!0:N>=0&&(D=!0)}const R=_&&D?T:T===0?x:0;for(let O=y[0][0];O<=y[0][1];O++)for(let P=y[1][0];P<=y[1][1];P++)for(let N=y[2][0];N<=y[2][1];N++){const A=p.indexToWorld([O,P,N]);zte(A,v)&&u.setAtIJK(O,P,N,R)}r&&_r(m.annotationUID)}const g=u.getArrayOfModifiedSlices();Wf(f,g)}};x2.previewData={preview:null,element:null,timerStart:0,timer:null,startPoint:[NaN,NaN],isDrag:!1};let Cm=x2;function zGe(t,e,n,r,i=.4){return[Math.round(t+(255-t)*i),Math.round(e+(255-e)*i),Math.round(n+(255-n)*i),r]}class rre extends Cm{constructor(e={},n={supportedInteractionTypes:["Mouse","Touch"],configuration:{strategies:{FILL_INSIDE_CIRCLE:ZO,ERASE_INSIDE_CIRCLE:Qne,FILL_INSIDE_SPHERE:Jne,ERASE_INSIDE_SPHERE:Zne,THRESHOLD_INSIDE_CIRCLE:OGe,THRESHOLD_INSIDE_SPHERE:AGe,THRESHOLD_INSIDE_SPHERE_WITH_ISLAND_REMOVAL:NGe},defaultStrategy:"FILL_INSIDE_CIRCLE",activeStrategy:"FILL_INSIDE_CIRCLE",brushSize:25,useCenterSegmentIndex:!1,preview:{enabled:!1,previewColors:{0:[255,255,255,128]},previewTimeMs:250,previewMoveDistance:8,dragMoveDistance:4,dragTimeMs:500},actions:{[jt.AcceptPreview]:{method:jt.AcceptPreview,bindings:[{key:"Enter"}]},[jt.RejectPreview]:{method:jt.RejectPreview,bindings:[{key:"Escape"}]},[jt.Interpolate]:{method:jt.Interpolate,bindings:[{key:"i"}],configuration:{useBallStructuringElement:!0,noUseDistanceTransform:!0,noUseExtrapolation:!0}},interpolateExtrapolation:{method:jt.Interpolate,bindings:[{key:"e"}],configuration:{}}}}}){super(e,n),this.onSetToolPassive=r=>{this.disableCursor()},this.onSetToolEnabled=()=>{this.disableCursor()},this.onSetToolDisabled=r=>{this.disableCursor()},this.preMouseDownCallback=r=>{const i=r.detail,{element:a}=i,o=Xe(a);this._editData=this.createEditData(a),this._activateDraw(a),Rn(a),r.preventDefault(),this._previewData.isDrag=!1,this._previewData.timerStart=Date.now();const s=this._hoverData||this.createHoverData(a);at(s.viewportIdsToRender);const l=this.getOperationData(a);return this.applyActiveStrategyCallback(o,l,jt.OnInteractionStart),!0},this.mouseMoveCallback=r=>{if(this.mode===br.Active){if(this.updateCursor(r),!this.configuration.preview.enabled)return;const{previewTimeMs:i,previewMoveDistance:a,dragMoveDistance:o}=this.configuration.preview,{currentPoints:s,element:l}=r.detail,{canvas:c}=s,{startPoint:f,timer:u,timerStart:d,isDrag:h}=this._previewData;if(h)return;const p=ii(c,f),g=Date.now()-d;if((p>a||g>i&&p>o)&&(u&&(window.clearTimeout(u),this._previewData.timer=null),h||this.rejectPreview(l)),!this._previewData.timer){const m=window.setTimeout(this.previewCallback,250);Object.assign(this._previewData,{timerStart:Date.now(),timer:m,startPoint:c,element:l})}}},this.previewCallback=()=>{if(this._previewData.isDrag){this._previewData.timer=null;return}this._previewData.timer=null;const r=this.getOperationData(this._previewData.element),i=Xe(this._previewData.element);if(!i)return;const{viewport:a}=i,o=this.configuration.activeStrategy,s=JO({operationData:r,viewport:a,strategy:o});if(!r)return;const l=this.createMemo(r.segmentationId,s.segmentationVoxelManager);this._previewData.preview=this.applyActiveStrategyCallback(Xe(this._previewData.element),{...r,...s,memo:l},jt.Preview)},this._dragCallback=r=>{const i=r.detail,{element:a,currentPoints:o}=i,s=Xe(a);this.updateCursor(r);const{viewportIdsToRender:l}=this._hoverData;at(l);const c=ii(o.canvas,this._previewData.startPoint),{dragTimeMs:f,dragMoveDistance:u}=this.configuration.preview;!this._previewData.isDrag&&Date.now()-this._previewData.timerStart<f&&c<u||(this._previewData.timer&&(window.clearTimeout(this._previewData.timer),this._previewData.timer=null),this._previewData.preview=this.applyActiveStrategy(s,this.getOperationData(a)),this._previewData.element=a,this._previewData.timerStart=Date.now()+f,this._previewData.isDrag=!0,this._previewData.startPoint=o.canvas)},this._endCallback=r=>{const i=r.detail,{element:a}=i,o=Xe(a),s=this.getOperationData(a);!this._previewData.preview&&!this._previewData.isDrag&&this.applyActiveStrategy(o,s),this.doneEditMemo(),this._deactivateDraw(a),qn(a),this.updateCursor(r),this._editData=null,this.applyActiveStrategyCallback(o,s,jt.OnInteractionEnd),this._previewData.isDrag||this.acceptPreview(a)},this._activateDraw=r=>{r.addEventListener(ee.MOUSE_UP,this._endCallback),r.addEventListener(ee.MOUSE_DRAG,this._dragCallback),r.addEventListener(ee.MOUSE_CLICK,this._endCallback)},this._deactivateDraw=r=>{r.removeEventListener(ee.MOUSE_UP,this._endCallback),r.removeEventListener(ee.MOUSE_DRAG,this._dragCallback),r.removeEventListener(ee.MOUSE_CLICK,this._endCallback)}}disableCursor(){this._hoverData=void 0,this.rejectPreview()}updateCursor(e){const n=e.detail,{element:r}=n,{currentPoints:i}=n,a=i.canvas;this._hoverData=this.createHoverData(r,a),this._calculateCursor(r,a),this._hoverData&&at(this._hoverData.viewportIdsToRender)}_calculateCursor(e,n){const r=Xe(e),{viewport:i}=r,{canvasToWorld:a}=i,o=i.getCamera(),{brushSize:s}=this.configuration,l=Sn(o.viewUp[0],o.viewUp[1],o.viewUp[2]),c=Sn(o.viewPlaneNormal[0],o.viewPlaneNormal[1],o.viewPlaneNormal[2]),f=it();gr(f,l,c);const u=a([n[0],n[1]]),d=it(),h=it(),p=it(),g=it();for(let w=0;w<=2;w++)d[w]=u[w]-l[w]*s,h[w]=u[w]+l[w]*s,p[w]=u[w]-f[w]*s,g[w]=u[w]+f[w]*s;if(!this._hoverData)return;const{brushCursor:m}=this._hoverData,{data:y}=m;y.handles===void 0&&(y.handles={}),y.handles.points=[d,h,p,g];const v=this.configuration.activeStrategy,x=this.configuration.strategies[v];typeof x?.computeInnerCircleRadius=="function"&&x.computeInnerCircleRadius({configuration:this.configuration,viewport:i}),y.invalidated=!1}getStatistics(e,n){if(!e)return;const r=Xe(e);return this.applyActiveStrategyCallback(r,this.getOperationData(e),jt.GetStatistics,n)}rejectPreview(e=this._previewData.element){if(!e)return;this.doneEditMemo();const n=Xe(e);n&&(this.applyActiveStrategyCallback(n,this.getOperationData(e),jt.RejectPreview),this._previewData.preview=null,this._previewData.isDrag=!1)}acceptPreview(e=this._previewData.element){e&&super.acceptPreview(e)}interpolate(e,n){if(!e)return;const r=Xe(e);this._previewData.preview=this.applyActiveStrategyCallback(r,this.getOperationData(e),jt.Interpolate,n.configuration),this._previewData.isDrag=!0}invalidateBrushCursor(){if(this._hoverData===void 0)return;const{data:e}=this._hoverData.brushCursor,{viewport:n}=this._hoverData;e.invalidated=!0;const{segmentColor:r}=this.getActiveSegmentationData(n)||{};this._hoverData.brushCursor.metadata.segmentColor=r}renderAnnotation(e,n){if(!this._hoverData)return;const{viewport:r}=e;if(!this._hoverData.viewportIdsToRender.includes(r.id))return;const a=this._hoverData.brushCursor;if(a.data.invalidated===!0){const{centerCanvas:v}=this._hoverData,{element:x}=r;this._calculateCursor(x,v)}const o=a.metadata;if(!o)return;const s=o.brushCursorUID,l=a.data,{points:c}=l.handles,f=c.map(v=>r.worldToCanvas(v)),u=f[0],d=f[1],h=[Math.floor((u[0]+d[0])/2),Math.floor((u[1]+d[1])/2)],p=Math.abs(u[1]-Math.floor((u[1]+d[1])/2)),g=`rgb(${o.segmentColor?.slice(0,3)||[0,0,0]})`;if(!r.getRenderingEngine()){console.warn("Rendering Engine has been destroyed");return}h0(n,s,"0",h,p,{color:g,lineDash:this.centerSegmentIndexInfo.segmentIndex===0?[1,2]:null});const{dynamicRadiusInCanvas:y}=this.configuration?.threshold||{dynamicRadiusInCanvas:0};y&&h0(n,s,"1",h,y,{color:g})}}rre.toolName="Brush";function WGe(t,e){const n=jh(t);if(n===void 0)return[];const r=n._toolInstances;return Object.keys(r).length?Object.values(r).filter(a=>a instanceof rre):[]}const{transformWorldToIndex:wb}=Yr,Ig=class Ig extends la{constructor(e={},n={supportedInteractionTypes:["Mouse","Touch"],configuration:{preventHandleOutsideImage:!1,getTextLines:HGe}}){super(e,n),this.isPointNearTool=(r,i,a,o)=>{const s=Xe(r),{viewport:l}=s,{data:c}=i,{points:f}=c.handles;let u=l.worldToCanvas(f[0]),d=l.worldToCanvas(f[1]),h={start:{x:u[0],y:u[1]},end:{x:d[0],y:d[1]}},p=Ll([h.start.x,h.start.y],[h.end.x,h.end.y],[a[0],a[1]]);return p<=o||(u=l.worldToCanvas(f[2]),d=l.worldToCanvas(f[3]),h={start:{x:u[0],y:u[1]},end:{x:d[0],y:d[1]}},p=Ll([h.start.x,h.start.y],[h.end.x,h.end.y],[a[0],a[1]]),p<=o)},this.toolSelectedCallback=(r,i)=>{const a=r.detail,{element:o}=a;i.highlighted=!0;const s=fn(o,this.getToolName());this.editData={annotation:i,viewportIdsToRender:s,movingTextBox:!1},this._activateModify(o);const l=Xe(o),{renderingEngine:c}=l;at(s),Rn(o),r.preventDefault()},this.handleSelectedCallback=(r,i,a)=>{const o=r.detail,{element:s}=o,l=i.data;i.highlighted=!0;let c=!1,f;a.worldPosition?c=!0:f=l.handles.points.findIndex(p=>p===a);const u=fn(s,this.getToolName());Rn(s),this.editData={annotation:i,viewportIdsToRender:u,handleIndex:f,movingTextBox:c},this._activateModify(s);const d=Xe(s),{renderingEngine:h}=d;at(u),r.preventDefault()},this._endCallback=r=>{const i=r.detail,{element:a}=i,{annotation:o,viewportIdsToRender:s,newAnnotation:l,hasMoved:c}=this.editData,{data:f}=o;if(l&&!c)return;this.doneEditMemo(),f.handles.activeHandleIndex=null,this._deactivateModify(a),this._deactivateDraw(a),qn(a);const{renderingEngine:u}=Xe(a);if(this.editData.handleIndex!==void 0){const{points:d}=f.handles,h=ol(d[0],d[1]);if(ol(d[2],d[3])>h){const g=[[...d[2]],[...d[3]]],m=[...d[0]],y=[...d[1]],v=Kn();Nl(v,g[1][0]-g[0][0],g[1][1]-g[1][0]);const x=Kn();Nl(x,-v[1],v[0]);const w=Kn();Nl(w,y[0]-m[0],y[1]-m[0]);let S;pf(w,x)>0?S=[m,y]:S=[y,m],f.handles.points=[g[0],g[1],S[0],S[1]]}}this.isHandleOutsideImage&&this.configuration.preventHandleOutsideImage&&_r(o.annotationUID),at(s),l&&Xr(o),this.editData=null,this.isDrawing=!1},this._dragDrawCallback=r=>{this.isDrawing=!0;const i=r.detail,{currentPoints:a,element:o}=i,s=Xe(o),{viewport:l}=s,{worldToCanvas:c}=l,{annotation:f,viewportIdsToRender:u,handleIndex:d,newAnnotation:h}=this.editData;this.createMemo(o,f,{newAnnotation:h});const{data:p}=f,g=a.world;p.handles.points[d]=[...g];const m=p.handles.points.map(c),y={longLineSegment:{start:{x:m[0][0],y:m[0][1]},end:{x:m[1][0],y:m[1][1]}},shortLineSegment:{start:{x:m[2][0],y:m[2][1]},end:{x:m[3][0],y:m[3][1]}}},x=ii(m[0],m[1])/3,w=y.longLineSegment.start.x-y.longLineSegment.end.x,S=y.longLineSegment.start.y-y.longLineSegment.end.y,T=Math.sqrt(w*w+S*S),_=w/T,D=S/T,I=(y.longLineSegment.start.x+y.longLineSegment.end.x)/2,R=(y.longLineSegment.start.y+y.longLineSegment.end.y)/2,O=I+x*D,P=R-x*_,N=I-x*D,A=R+x*_;p.handles.points[2]=l.canvasToWorld([O,P]),p.handles.points[3]=l.canvasToWorld([N,A]),f.invalidated=!0,at(u),Un(f,o,xn.HandlesUpdated),this.editData.hasMoved=!0},this._dragModifyCallback=r=>{this.isDrawing=!0;const i=r.detail,{element:a}=i,{annotation:o,viewportIdsToRender:s,handleIndex:l,movingTextBox:c,newAnnotation:f}=this.editData;this.createMemo(a,o,{newAnnotation:f});const{data:u}=o;if(c){const{deltaPoints:d}=i,h=d.world,{textBox:p}=u.handles,{worldPosition:g}=p;g[0]+=h[0],g[1]+=h[1],g[2]+=h[2],p.hasMoved=!0}else if(l===void 0){const{deltaPoints:d}=i,h=d.world;u.handles.points.forEach(g=>{g[0]+=h[0],g[1]+=h[1],g[2]+=h[2]}),o.invalidated=!0}else this._dragModifyHandle(r),o.invalidated=!0;at(s),o.invalidated&&Un(o,a,xn.HandlesUpdated)},this._dragModifyHandle=r=>{const i=r.detail,{currentPoints:a,element:o}=i,s=Xe(o),{viewport:l}=s,{annotation:c,handleIndex:f}=this.editData,{data:u}=c,d=a.world,h=[l.worldToCanvas(u.handles.points[0]),l.worldToCanvas(u.handles.points[1]),l.worldToCanvas(u.handles.points[2]),l.worldToCanvas(u.handles.points[3])],p={start:{x:h[0][0],y:h[0][1]},end:{x:h[1][0],y:h[1][1]}},g={start:{x:h[2][0],y:h[2][1]},end:{x:h[3][0],y:h[3][1]}},m=[...d],y=l.worldToCanvas(m);if(f===0||f===1){const x=h[f===0?1:0],w=Nl(Kn(),y[0]-x[0],y[1]-x[1]),S=Nl(Kn(),h[f][0]-x[0],h[f][1]-x[1]);dh(w,w),dh(S,S);const T={start:{x:x[0],y:x[1]},end:{x:y[0],y:y[1]}};if(this._movingLongAxisWouldPutItThroughShortAxis(T,g))return;const _=x,D=this._getSignedAngle(S,w);let I=h[2][0],R=h[2][1],O=h[3][0],P=h[3][1];I-=_[0],R-=_[1],O-=_[0],P-=_[1];const N=I*Math.cos(D)-R*Math.sin(D),A=I*Math.sin(D)+R*Math.cos(D),B=O*Math.cos(D)-P*Math.sin(D),V=O*Math.sin(D)+P*Math.cos(D);I=N+_[0],R=A+_[1],O=B+_[0],P=V+_[1];const $=l.canvasToWorld([I,R]),U=l.canvasToWorld([O,P]);u.handles.points[f]=m,u.handles.points[2]=$,u.handles.points[3]=U}else{const v=f===2?3:2,x={longLineSegment:{start:p.start,end:p.end},shortLineSegment:{start:g.start,end:g.end}},w=ka(Kn(),[x.longLineSegment.end.x,x.longLineSegment.end.y],[x.longLineSegment.start.x,x.longLineSegment.start.y]),S=dh(Kn(),w),T=ka(Kn(),[y[0],y[1]],[h[f][0],h[f][1]]),_=D_(T),D=this._getSignedAngle(S,T),I=Math.cos(D)*_,R=Ov(Kn(),[h[v][0],h[v][1]],S,I);if(this._movingLongAxisWouldPutItThroughShortAxis({start:{x:y[0],y:y[1]},end:{x:R[0],y:R[1]}},{start:{x:x.longLineSegment.start.x,y:x.longLineSegment.start.y},end:{x:x.longLineSegment.end.x,y:x.longLineSegment.end.y}})||!TU([y[0],y[1]],[R[0],R[1]],[p.start.x,p.start.y],[p.end.x,p.end.y]))return;u.handles.points[v]=l.canvasToWorld(R),u.handles.points[f]=m}},this.cancel=r=>{if(this.isDrawing){this.isDrawing=!1,this._deactivateDraw(r),this._deactivateModify(r),qn(r);const{annotation:i,viewportIdsToRender:a,newAnnotation:o}=this.editData,{data:s}=i;return i.highlighted=!1,s.handles.activeHandleIndex=null,at(a),o&&Xr(i),this.editData=null,i.annotationUID}},this._activateDraw=r=>{Dt.isInteractingWithTool=!0,r.addEventListener(ee.MOUSE_UP,this._endCallback),r.addEventListener(ee.MOUSE_DRAG,this._dragDrawCallback),r.addEventListener(ee.MOUSE_MOVE,this._dragDrawCallback),r.addEventListener(ee.MOUSE_CLICK,this._endCallback),r.addEventListener(ee.TOUCH_TAP,this._endCallback),r.addEventListener(ee.TOUCH_END,this._endCallback),r.addEventListener(ee.TOUCH_DRAG,this._dragDrawCallback)},this._deactivateDraw=r=>{Dt.isInteractingWithTool=!1,r.removeEventListener(ee.MOUSE_UP,this._endCallback),r.removeEventListener(ee.MOUSE_DRAG,this._dragDrawCallback),r.removeEventListener(ee.MOUSE_MOVE,this._dragDrawCallback),r.removeEventListener(ee.MOUSE_CLICK,this._endCallback),r.removeEventListener(ee.TOUCH_TAP,this._endCallback),r.removeEventListener(ee.TOUCH_END,this._endCallback),r.removeEventListener(ee.TOUCH_DRAG,this._dragDrawCallback)},this._activateModify=r=>{Dt.isInteractingWithTool=!0,r.addEventListener(ee.MOUSE_UP,this._endCallback),r.addEventListener(ee.MOUSE_DRAG,this._dragModifyCallback),r.addEventListener(ee.MOUSE_CLICK,this._endCallback),r.addEventListener(ee.TOUCH_END,this._endCallback),r.addEventListener(ee.TOUCH_DRAG,this._dragModifyCallback),r.addEventListener(ee.TOUCH_TAP,this._endCallback)},this._deactivateModify=r=>{Dt.isInteractingWithTool=!1,r.removeEventListener(ee.MOUSE_UP,this._endCallback),r.removeEventListener(ee.MOUSE_DRAG,this._dragModifyCallback),r.removeEventListener(ee.MOUSE_CLICK,this._endCallback),r.removeEventListener(ee.TOUCH_END,this._endCallback),r.removeEventListener(ee.TOUCH_DRAG,this._dragModifyCallback),r.removeEventListener(ee.TOUCH_TAP,this._endCallback)},this.renderAnnotation=(r,i)=>{let a=!0;const{viewport:o}=r,{element:s}=o;let l=Zi(this.getToolName(),s);if(!l?.length||(l=this.filterInteractableAnnotationsForElement(s,l),!l?.length))return a;const c=this.getTargetId(o),f=o.getRenderingEngine(),u={toolGroupId:this.toolGroupId,toolName:this.getToolName(),viewportId:r.viewport.id};for(let d=0;d<l.length;d++){const h=l[d],{annotationUID:p,data:g}=h,{points:m,activeHandleIndex:y}=g.handles,v=m.map(Q=>o.worldToCanvas(Q));u.annotationUID=p;const{color:x,lineWidth:w,lineDash:S,shadow:T}=this.getAnnotationStyle({annotation:h,styleSpecifier:u});if(!g.cachedStats[c]||g.cachedStats[c].unit==null?(g.cachedStats[c]={length:null,width:null,unit:null},this._calculateCachedStats(h,f,r)):h.invalidated&&this._throttledCalculateCachedStats(h,f,r),!o.getRenderingEngine())return console.warn("Rendering Engine has been destroyed"),a;let _;if(!xo(p))continue;!yo(p)&&!this.editData&&y!==null&&(_=[v[y]]),_&&bo(i,p,"0",_,{color:x});const D=`${p}-line-1`,I=`${p}-line-2`;Va(i,p,"0",v[0],v[1],{color:x,lineDash:S,lineWidth:w,shadow:T},D),Va(i,p,"1",v[2],v[3],{color:x,lineDash:S,lineWidth:w,shadow:T},I),a=!0;const P=this.getLinkedTextBoxStyle(u,h);if(!P.visibility){g.handles.textBox={hasMoved:!1,worldPosition:[0,0,0],worldBoundingBox:{topLeft:[0,0,0],topRight:[0,0,0],bottomLeft:[0,0,0],bottomRight:[0,0,0]}};continue}const N=this.configuration.getTextLines(g,c);if(!N||N.length===0)continue;let A;g.handles.textBox.hasMoved||(A=Iu(v),g.handles.textBox.worldPosition=o.canvasToWorld(A));const B=o.worldToCanvas(g.handles.textBox.worldPosition),$=cl(i,p,"1",N,B,v,{},P),{x:U,y:G,width:F,height:J}=$;g.handles.textBox.worldBoundingBox={topLeft:o.canvasToWorld([U,G]),topRight:o.canvasToWorld([U+F,G]),bottomLeft:o.canvasToWorld([U,G+J]),bottomRight:o.canvasToWorld([U+F,G+J])}}return a},this._movingLongAxisWouldPutItThroughShortAxis=(r,i)=>{const a=Kn();Nl(a,i.end.x-i.start.x,i.end.y-i.start.y),dh(a,a);const o={start:{x:i.start.x-a[0]*10,y:i.start.y-a[1]*10},end:{x:i.end.x+a[0]*10,y:i.end.y+a[1]*10}};return!TU([o.start.x,o.start.y],[o.end.x,o.end.y],[r.start.x,r.start.y],[r.end.x,r.end.y])},this._calculateCachedStats=(r,i,a)=>{const{data:o}=r,{element:s}=a.viewport,l=o.handles.points[0],c=o.handles.points[1],f=o.handles.points[2],u=o.handles.points[3],{cachedStats:d}=o,h=Object.keys(d);for(let g=0;g<h.length;g++){const m=h[g],y=this.getTargetImageData(m);if(!y)continue;const{imageData:v,dimensions:x}=y,w=wb(v,l),S=wb(v,c),T=wb(v,f),_=wb(v,u),D=[w,S],I=[T,_],{scale:R,unit:O}=Cc(y,D),{scale:P,unit:N}=Cc(y,I),A=this._calculateLength(l,c)/R,B=this._calculateLength(f,u)/P,V=A>B?A:B,$=A>B?B:A,U=A>B?O:N,G=A>B?N:O;this._isInsideVolume(w,S,T,_,x)?this.isHandleOutsideImage=!1:this.isHandleOutsideImage=!0,d[m]={length:V,width:$,unit:U,widthUnit:G}}const p=r.invalidated;return r.invalidated=!1,p&&Un(r,s,xn.StatsUpdated),d},this._isInsideVolume=(r,i,a,o,s)=>Ta(r,s)&&Ta(i,s)&&Ta(a,s)&&Ta(o,s),this._getSignedAngle=(r,i)=>Math.atan2(r[0]*i[1]-r[1]*i[0],r[0]*i[0]+r[1]*i[1]),this._throttledCalculateCachedStats=Wl(this._calculateCachedStats,100,{trailing:!0})}addNewAnnotation(e){const n=e.detail,{currentPoints:r,element:i}=n,a=r.world,o=Xe(i),{viewport:s,renderingEngine:l}=o;this.isDrawing=!0;const c=s.getCamera(),{viewPlaneNormal:f,viewUp:u}=c,d=this.getReferencedImageId(s,a,f,u),h=s.getFrameOfReferenceUID(),p={highlighted:!0,invalidated:!0,metadata:{toolName:this.getToolName(),viewPlaneNormal:[...f],viewUp:[...u],FrameOfReferenceUID:h,referencedImageId:d,...s.getViewReference({points:[a]})},data:{handles:{points:[[...a],[...a],[...a],[...a]],textBox:{hasMoved:!1,worldPosition:[0,0,0],worldBoundingBox:{topLeft:[0,0,0],topRight:[0,0,0],bottomLeft:[0,0,0],bottomRight:[0,0,0]}},activeHandleIndex:null},label:"",cachedStats:{}}};mr(p,i);const g=fn(i,this.getToolName());return this.editData={annotation:p,viewportIdsToRender:g,handleIndex:1,movingTextBox:!1,newAnnotation:!0,hasMoved:!1},this._activateDraw(i),Rn(i),e.preventDefault(),at(g),p}_calculateLength(e,n){const r=e[0]-n[0],i=e[1]-n[1],a=e[2]-n[2];return Math.sqrt(r*r+i*i+a*a)}};Ig.toolName="Bidirectional",Ig.hydrate=(e,n,r)=>{const i=xr(e);if(!i)return;const{FrameOfReferenceUID:a,referencedImageId:o,viewPlaneNormal:s,instance:l,viewport:c}=Ig.hydrateBase(Ig,i,n[0],r),[f,u]=n,[d,h]=f,[p,g]=u,m=[d,h,p,g],{toolInstance:y,...v}=r||{},x={annotationUID:r?.annotationUID||cr(),data:{handles:{points:m,activeHandleIndex:null,textBox:{hasMoved:!1,worldPosition:[0,0,0],worldBoundingBox:{topLeft:[0,0,0],topRight:[0,0,0],bottomLeft:[0,0,0],bottomRight:[0,0,0]}}},cachedStats:{}},highlighted:!1,autoGenerated:!1,invalidated:!1,isLocked:!1,isVisible:!0,metadata:{toolName:l.getToolName(),viewPlaneNormal:s,FrameOfReferenceUID:a,referencedImageId:o,...v}};return mr(x,c.element),at([c.id]),x};let pg=Ig;function HGe(t,e){const{cachedStats:n,label:r}=t,{length:i,width:a,unit:o}=n[e],s=[];return r&&s.push(r),i===void 0||s.push(`L: ${Vn(i)} ${o||o}`,`W: ${Vn(a)} ${o}`),s}function KGe(t){const e=jh(t);if(e===void 0)return;WGe(t).forEach(o=>{o.invalidateBrushCursor()});const r=e.getViewportsInfo();if(!Object.keys(r).map(o=>r[o]).length)return;const a=e.getViewportIds();at(a)}function qGe(t,e){const n=ea(t);typeof e=="string"&&(console.warn("segmentIndex is a string, converting to number"),e=Number(e)),Object.values(n.segments).forEach(i=>{i.active=!1}),n.segments[e]||(n.segments[e]={segmentIndex:e,label:"",locked:!1,cachedStats:{},active:!1}),n.segments[e].active!==!0&&(n.segments[e].active=!0,t1(t));const r=gS(t);r.forEach(i=>{Yd(i,{segmentationId:t}).forEach(o=>{o.segments[e]||(o.segments[e]={visible:!0})})}),r.forEach(i=>{const a=to(i);KGe(a.id)})}function XGe(t,e){const{segmentationId:n,config:r}=e,i={colorLUTIndex:YGe(r),...r};if(Ps.addSegmentationRepresentation(t,n,e.type,i),!Su(n)){const a=Ps.getSegmentation(n);if(a){const o=Object.keys(a.segments);if(o.length>0){const s=o.map(l=>Number(l)).sort()[0];qGe(n,s)}}}e.type===hn.Contour&&at([t]),t1(n)}function YGe(t){const{colorLUTOrIndex:e}=t||{};return e===void 0?V8(JSON.parse(JSON.stringify(h9))):typeof e=="number"?e:Array.isArray(e)&&e.every(r=>Array.isArray(r)&&r.length===4)?V8(e):V8(JSON.parse(JSON.stringify(h9)))}function JGe(t,e){e.map(n=>XGe(t,n))}function ZGe(t,e,n){t.data.label=n,Un(t,e,xn.LabelChange)}class QGe{constructor(e){this._controlPoints=[],this._invalidated=!1,this._length=0,this._controlPoints=[],this._resolution=e?.resolution??20,this._fixedResolution=e?.fixedResolution??!1,this._closed=e?.closed??!1,this._invalidated=!0}get controlPoints(){return this._controlPoints}get numControlPoints(){return this._controlPoints.length}get resolution(){return this._resolution}set resolution(e){this._fixedResolution||this._resolution===e||(this._resolution=e,this.invalidated=!0)}get fixedResolution(){return this._fixedResolution}get closed(){return this._closed}set closed(e){this._closed!==e&&(this._closed=e,this.invalidated=!0)}get aabb(){return this._update(),this._aabb}get length(){return this._update(),this._length}get invalidated(){return this._invalidated}set invalidated(e){this._invalidated=e}hasTangentPoints(){return!1}addControlPoint(e){this._controlPoints.push([e[0],e[1]]),this.invalidated=!0}addControlPoints(e){e.forEach(n=>this.addControlPoint(n))}addControlPointAtU(e){const n=this._getLineSegmentAt(e),{start:r,end:i}=n.points,a=Math.floor(e),o=this._curveSegments[a],s=e-Math.floor(a),l=[r[0]+s*(i[0]-r[0]),r[1]+s*(i[1]-r[1])],c=this._controlPoints.indexOf(o.controlPoints.p1)+1;return this._controlPoints.splice(c,0,l),this.invalidated=!0,{index:c,point:l}}deleteControlPointByIndex(e){const n=this._closed?3:1;return e>=0&&e<this._controlPoints.length&&this._controlPoints.length>n?(this._controlPoints.splice(e,1),this.invalidated=!0,!0):!1}clearControlPoints(){this._controlPoints=[],this.invalidated=!0}setControlPoints(e){this.clearControlPoints(),this.addControlPoints(e)}updateControlPoint(e,n){if(e<0||e>=this._controlPoints.length)throw new Error("Index out of bounds");this._controlPoints[e]=[...n],this.invalidated=!0}getControlPoints(){return this._controlPoints.map(e=>[e[0],e[1]])}getClosestControlPoint(e){const n=this._controlPoints;let r=1/0,i=-1;for(let a=0,o=n.length;a<o;a++){const s=n[a],l=e[0]-s[0],c=e[1]-s[1],f=l*l+c*c;f<r&&(r=f,i=a)}return{index:i,point:i===-1?void 0:[...n[i]],distance:Math.sqrt(r)}}getClosestControlPointWithinDistance(e,n){const r=this.getClosestControlPoint(e);return r.distance<=n?r:void 0}getClosestPoint(e){this._update();const n=this._getCurveSegmmentsDistanceSquaredInfo(e);if(!n.length)return;n.sort((u,d)=>u.distanceSquared-d.distanceSquared);let r,i=-1,a=1/0,o,s;for(let u=0;u<n.length;u++){const d=n[u];if(d.distanceSquared>a)continue;const{curveSegmentIndex:h,curveSegment:p}=d,{lineSegments:g}=p;for(let m=0;m<g.length;m++){const y=g[m],{point:v,distanceSquared:x}=s9(y.points.start,y.points.end,e);x<a&&(s=y,i=h,o=d.curveSegment,r=v,a=x)}}const c=(s.previousLineSegmentsLength+Qh(s.points.start,r))/o.length,f=i+c;return{point:r,uValue:f,distance:Math.sqrt(a)}}getClosestPointOnControlPointLines(e){const n=[...this._controlPoints];if(this._closed&&n.push(this._controlPoints[0]),!n.length)return;let r,i=1/0,a=n[0];for(let o=1,s=n.length;o<s;o++){const l=n[o],{point:c,distanceSquared:f}=s9(a,l,e);f<i&&(r=c,i=f),a=l}return{point:r,distance:Math.sqrt(i)}}getPolylinePoints(){return this._update(),this._convertCurveSegmentsToPolyline(this._curveSegments)}getPreviewPolylinePoints(e,n){if(this._closed)return[];this._update();const i=this.getClosestControlPointWithinDistance(e,n)?.index===0,a=this.getPreviewCurveSegments(e,i);return a?.length?this._convertCurveSegmentsToPolyline(a):[]}isPointNearCurve(e,n){this._update();const r=this._getCurveSegmmentsWithinDistance(e,n),i=n*n;for(let a=0;a<r.length;a++){const{lineSegments:o}=r[a];for(let s=0;s<o.length;s++){const l=o[s];if(mS(l.points.start,l.points.end,e)<=i)return!0}}return!1}containsPoint(e){if(this._update(),this._controlPoints.length<3)return!1;const r=[...this._curveSegments],i=this._getClosingCurveSegmentWithStraightLineSegment();i&&r.push(i);let a=0;for(let o=0;o<r.length;o++){const s=r[o],{aabb:l}=s;if(!(e[0]<=l.maxX&&e[1]>=l.minY&&e[1]<l.maxY))continue;const{lineSegments:f}=s;for(let u=0;u<f.length;u++){const d=f[u],{aabb:h}=d;if(e[0]<=h.maxX&&e[1]>=h.minY&&e[1]<h.maxY){const{start:g,end:m}=d.points,y=g[0]===m[0],v=(e[1]-g[1])*(m[0]-g[0])/(m[1]-g[1])+g[0];a+=y||e[0]<=v?1:0}}}return a%2===1}_update(){if(!this._invalidated)return;const e=this.getSplineCurves();let n=0,r=1/0,i=1/0,a=-1/0,o=-1/0;for(let s=0,l=e.length;s<l;s++){const{aabb:c,length:f}=e[s];r=r<=c.minX?r:c.minX,i=i<=c.minY?i:c.minY,a=a>=c.maxX?a:c.maxX,o=o>=c.maxY?o:c.maxY,n+=f}this._curveSegments=e,this._aabb={minX:r,minY:i,maxX:a,maxY:o},this._length=n,this._invalidated=!1}_convertCurveSegmentsToPolyline(e){this._update();const n=[];return e.forEach(({lineSegments:r},i)=>{r.forEach((a,o)=>{i===0&&o===0&&n.push([...a.points.start]),n.push([...a.points.end])})}),n}_getCurveSegmmentsDistanceSquaredInfo(e){this._update();const n=[],{_curveSegments:r}=this;for(let i=0;i<r.length;i++){const a=r[i],o=bU(a.aabb,e);n.push({curveSegmentIndex:i,curveSegment:a,distanceSquared:o})}return n}_getCurveSegmmentsWithinDistance(e,n){this._update();const r=n*n;if(bU(this.aabb,e)>r)return[];const i=this._getCurveSegmmentsDistanceSquaredInfo(e),a=[];for(let o=0,s=i.length;o<s;o++){const{curveSegment:l,distanceSquared:c}=i[o];c<=r&&a.push(l)}return a}_getLineSegmentAt(e){this._update();const n=Math.floor(e),r=e-n,i=this._curveSegments[n],{lineSegments:a}=i,o=i.length*r;for(let s=0;s<a.length;s++){const l=a[s],c=l.previousLineSegmentsLength+l.length;if(o>=l.previousLineSegmentsLength&&o<=c)return l}}_getClosingCurveSegmentWithStraightLineSegment(){if(this.closed)return;const e=this._controlPoints,n=e[0],r=e[e.length-1],i={points:{start:[...n],end:[...r]},aabb:{minX:Math.min(n[0],r[0]),minY:Math.min(n[1],r[1]),maxX:Math.max(n[0],r[0]),maxY:Math.max(n[1],r[1])}};return{aabb:{minX:i.aabb.minX,minY:i.aabb.minY,maxX:i.aabb.maxX,maxY:i.aabb.maxY},lineSegments:[i]}}}const eje=1e-8;class ire extends QGe{getPreviewCurveSegments(e,n){const r=this._getNumCurveSegments()+1,i=Math.max(0,r-2),a=n?r:r-1,o=this.getTransformMatrix(),s=[...this.controlPoints],l=[];n||s.push(e);for(let c=i;c<=a;c++){const f=this._getCurveSegment(c,o,s,n);l.push(f)}return l}getSplineCurves(){const e=this._getNumCurveSegments(),n=new Array(e);if(e<=0)return[];const r=this.getTransformMatrix();let i=0;for(let a=0;a<e;a++){const o=this._getCurveSegment(a,r);o.previousCurveSegmentsLength=i,n[a]=o,i+=o.length}return n}_getNumCurveSegments(e=this.controlPoints,n=this.closed){return n?e.length:Math.max(0,e.length-1)}_getPoint(e,n,r=this.controlPoints,i=this.closed){const a=this._getNumCurveSegments(r,i),o=Math.floor(e);let s=o%a;const l=e-o;if(s<0||s>=a)if(this.closed)s=(a+s)%a;else return;const{p0:f,p1:u,p2:d,p3:h}=this._getCurveSegmentPoints(s,r,i),p=l*l,g=p*l,m=FE(1,l,p,g),y=mwe(mX(),m,n);return[Zk(y,FE(f[0],u[0],d[0],h[0])),Zk(y,FE(f[1],u[1],d[1],h[1]))]}_getCurveSegmentPoints(e,n=this.controlPoints,r=this.closed){const i=this._getNumCurveSegments(n,r),a=e,o=a-1,s=r?(a+1)%i:a+1,l=s+1,c=n[a],f=n[s];let u,d;return o>=0?u=n[o]:u=r?n[n.length-1]:wU(f,c),l<n.length?d=n[l]:d=r?n[0]:wU(c,f),{p0:u,p1:c,p2:f,p3:d}}_getLineSegments(e,n,r=this.controlPoints,i=this.closed){const a=this._getNumCurveSegments(r,i),o=this.resolution+1,s=1/o,l=e;let c=l+1;!i&&e===a-1&&(c-=eje);const f=[];let u,d,h=0;for(let p=0,g=l;p<=o;p++,g+=s){g=g>c?c:g;const m=this._getPoint(g,n,r,i);if(!p){u=m;continue}d=m;const y=d[0]-u[0],v=d[1]-u[1],x=Math.sqrt(y**2+v**2),w={minX:u[0]<=d[0]?u[0]:d[0],maxX:u[0]>=d[0]?u[0]:d[0],minY:u[1]<=d[1]?u[1]:d[1],maxY:u[1]>=d[1]?u[1]:d[1]};f.push({points:{start:u,end:d},aabb:w,length:x,previousLineSegmentsLength:h}),u=d,h+=x}return f}_getCurveSegment(e,n=this.getTransformMatrix(),r=this.controlPoints,i=this.closed){const{p0:a,p1:o,p2:s,p3:l}=this._getCurveSegmentPoints(e,r,i),c=this._getLineSegments(e,n,r,i);let f=0,u=1/0,d=1/0,h=-1/0,p=-1/0;return c.forEach(({aabb:g,length:m})=>{u=Math.min(u,g.minX),d=Math.min(d,g.minY),h=Math.max(h,g.maxX),p=Math.max(p,g.maxY),f+=m}),{controlPoints:{p0:a,p1:o,p2:s,p3:l},aabb:{minX:u,minY:d,maxX:h,maxY:p},length:f,previousCurveSegmentsLength:0,lineSegments:c}}}const tje=hwe(r0(),uX(1,4,1,0,-3,0,3,0,3,-6,3,0,-1,3,-3,1),1/6);class nje extends ire{getTransformMatrix(){return tje}}class q3 extends ire{constructor(e){super(e),this._scale=e?.scale??.5,this._fixedScale=e?.fixedScale??!1}get scale(){return this._scale}set scale(e){this._fixedScale||this._scale===e||(this._scale=e,this.invalidated=!0)}get fixedScale(){return this._fixedScale}getTransformMatrix(){const{scale:e}=this,n=2*e;return[0,1,0,0,-e,0,e,0,n,e-3,3-n,-e,-e,2-e,e-2,e]}}class rje extends q3{constructor(){super({scale:.5,fixedScale:!0})}}class ije extends q3{constructor(){super({resolution:0,fixedResolution:!0,scale:0,fixedScale:!0})}}class Qp extends $f{constructor(e={},n={supportedInteractionTypes:["Mouse","Touch"]}){super(e,n)}touchDragCallback(e){this._dragCallback(e)}mouseDragCallback(e){this._dragCallback(e)}_dragCallback(e){const{element:n,deltaPoints:r}=e.detail,i=Xe(n),a=r.world;if(a[0]===0&&a[1]===0&&a[2]===0)return;const o=i.viewport.getCamera(),{focalPoint:s,position:l}=o,c=[l[0]-a[0],l[1]-a[1],l[2]-a[2]],f=[s[0]-a[0],s[1]-a[1],s[2]-a[2]];i.viewport.setCamera({focalPoint:f,position:c}),i.viewport.render()}}Qp.toolName="Pan";const $8=4,aje=1024,oje="PT";class Fv extends $f{constructor(e={},n={supportedInteractionTypes:["Mouse","Touch"]}){super(e,n),this._getImageDynamicRangeFromMiddleSlice=(r,i)=>{const a=Math.floor(i[2]/2),o=i[0]*i[1];let s,l;r instanceof Float32Array?(s=4,l=Float32Array):r instanceof Uint8Array?(s=1,l=Uint8Array):r instanceof Uint16Array?(s=2,l=Uint16Array):r instanceof Int16Array&&(s=2,l=Int16Array);const c=r.buffer,f=a*o*s,u=new l(c,f,o),{max:d,min:h}=this._getMinMax(u,o);return d-h}}touchDragCallback(e){this.mouseDragCallback(e)}mouseDragCallback(e){const{element:n,deltaPoints:r}=e.detail,i=Xe(n),{viewport:a}=i;let o,s,l,c,f,u,d=!1;const h=a.getProperties();if(a instanceof da){o=a.getVolumeId(),u=JC(o),{lower:s,upper:l}=h.voiRange;const p=yt.getVolume(o);if(!p)throw new Error("Volume not found "+o);c=p.metadata.Modality,d=p.scaling&&Object.keys(p.scaling).length>0}else if(h.voiRange){c=a.modality,{lower:s,upper:l}=h.voiRange;const{preScale:p={scaled:!1}}=a.getImageData?.()||{};d=p.scaled&&p.scalingParameters?.suvbw!==void 0}else throw new Error("Viewport is not a valid type");if(c===oje&&d?f=this.getPTScaledNewRange({deltaPointsCanvas:r.canvas,lower:s,upper:l,clientHeight:n.clientHeight,isPreScaled:d,viewport:a,volumeId:o}):f=this.getNewRange({viewport:a,deltaPointsCanvas:r.canvas,volumeId:o,lower:s,upper:l}),!(f.lower>=f.upper)&&(a.setProperties({voiRange:f}),a.render(),a instanceof da)){u.forEach(p=>{a!==p&&p.render()});return}}getPTScaledNewRange({deltaPointsCanvas:e,lower:n,upper:r,clientHeight:i,viewport:a,volumeId:o,isPreScaled:s}){let l=$8;s?l=5/i:l=this._getMultiplierFromDynamicRange(a,o)||$8;const f=e[1]*l;return r-=f,r=s?Math.max(r,.1):r,{lower:n,upper:r}}getNewRange({viewport:e,deltaPointsCanvas:n,volumeId:r,lower:i,upper:a}){const o=this._getMultiplierFromDynamicRange(e,r)||$8,s=n[0]*o,l=n[1]*o;let{windowWidth:c,windowCenter:f}=Py(i,a);c+=s,f+=l,c=Math.max(c,1);const u=e.getProperties().VOILUTFunction;return zg(c,f,u)}_getMultiplierFromDynamicRange(e,n){let r;if(n){const a=yt.getVolume(n),{voxelManager:o}=e.getImageData(),l=o.getMiddleSliceData().reduce((u,d)=>[Math.min(u[0],d),Math.max(u[1],d)],[1/0,-1/0]),c=a?.metadata?.BitsStored,f=c?2**c:1/0;r=Math.min(l[1]-l[0],f)}else r=this._getImageDynamicRangeFromViewport(e);const i=r/aje;return i>1?Math.round(i):i}_getImageDynamicRangeFromViewport(e){const{imageData:n,voxelManager:r}=e.getImageData();if(r?.getRange){const s=r.getRange();return s[1]-s[0]}const i=n.getDimensions();if(n.getRange){const s=n.getRange();return s[1]-s[0]}let a;if(n.getScalarData?a=n.getScalarData():a=n.getPointData().getScalars().getData(),i[2]!==1)return this._getImageDynamicRangeFromMiddleSlice(a,i);let o;if(a.getRange)o=a.getRange();else{const{min:s,max:l}=this._getMinMax(a,a.length);o=[s,l]}return o[1]-o[0]}_getMinMax(e,n){let r=1/0,i=-1/0;for(let a=0;a<n;a++){const o=e[a];o<r&&(r=o),o>i&&(i=o)}return{max:i,min:r}}}Fv.toolName="WindowLevel";class eg extends $f{constructor(e={},n={supportedInteractionTypes:["Mouse","Touch"],configuration:{zoomToCenter:!1,minZoomScale:.001,maxZoomScale:3e3,pinchToZoom:!0,pan:!0,invert:!1}}){super(e,n),this.preMouseDownCallback=r=>{const i=r.detail,{element:a,currentPoints:o}=i,s=o.world,c=Xe(a).viewport.getCamera(),{focalPoint:f}=c;this.initialMousePosWorld=s;let u=Sn(f[0]-s[0],f[1]-s[1],f[2]-s[2]);return u=Lr(it(),u),this.dirVec=u,!1},this.preTouchStartCallback=r=>{if(!this.configuration.pinchToZoom)return this.preMouseDownCallback(r)},this._dragParallelProjection=(r,i,a,o=!1)=>{const{element:s,deltaPoints:l}=r.detail,c=o?r.detail.deltaDistance.canvas:l.canvas[1],f=[s.clientWidth,s.clientHeight],{parallelScale:u,focalPoint:d,position:h}=a,p=5/f[1],g=c*p*(this.configuration.invert?-1:1),m=(1-g)*u;let y=d,v=h;if(!this.configuration.zoomToCenter){const _=ol(d,this.initialMousePosWorld);v=Ar(it(),h,this.dirVec,-_*g),y=Ar(it(),d,this.dirVec,-_*g)}const x=i.getImageData();let w=[1,1,1],S=m,T=!1;if(x){w=x.spacing;const{dimensions:_}=x,D=_[0]*w[0],I=_[1]*w[1],R=f[0]/f[1],O=i.options?.displayArea,P=O?.imageArea?.[0]??1.1,N=O?.imageArea?.[1]??1.1,A=D*P,B=I*N,V=A/B;let $;V>R?$=A/R*.5:$=B*.5;const{minZoomScale:U,maxZoomScale:G}=this.configuration,F=$/G,J=$/U;m<F?(S=F,T=!0):m>J&&(S=J,T=!0)}i.setCamera({parallelScale:S,focalPoint:T?d:y,position:T?h:v})},this._dragPerspectiveProjection=(r,i,a,o=!1)=>{const{element:s,deltaPoints:l}=r.detail,c=o?r.detail.deltaDistance.canvas:l.canvas[1],f=[s.clientWidth,s.clientHeight],{position:u,focalPoint:d,viewPlaneNormal:h}=a,p=Zs.distance2BetweenPoints(u,d),g=Math.sqrt(p)/f[1],m=[-h[0],-h[1],-h[2]],y=this.configuration.invert?c/g:c*g;let v=y*m[0];u[0]+=v,d[0]+=v,v=y*m[1],u[1]+=v,d[1]+=v,v=y*m[2],u[2]+=v,d[2]+=v,i.setCamera({position:u,focalPoint:d})},this.initialMousePosWorld=[0,0,0],this.dirVec=[0,0,0],this.configuration.pinchToZoom?this.touchDragCallback=this._pinchCallback.bind(this):this.touchDragCallback=this._dragCallback.bind(this),this.mouseDragCallback=this._dragCallback.bind(this)}mouseWheelCallback(e){this._zoom(e)}_pinchCallback(e){if(e.detail.currentPointsList.length>1){const{element:r,currentPoints:i}=e.detail,a=Xe(r),{viewport:o}=a,s=o.getCamera(),l=i.world,{focalPoint:c}=s;this.initialMousePosWorld=l;let f=Sn(c[0]-l[0],c[1]-l[1],c[2]-l[2]);f=Lr(it(),f),this.dirVec=f,s.parallelProjection?this._dragParallelProjection(e,o,s,!0):this._dragPerspectiveProjection(e,o,s,!0),o.render()}this.configuration.pan&&this._panCallback(e)}_dragCallback(e){const{element:n}=e.detail,r=Xe(n),{viewport:i}=r,a=i.getCamera();a.parallelProjection?this._dragParallelProjection(e,i,a):this._dragPerspectiveProjection(e,i,a),i.render()}_zoom(e){const{element:n,points:r}=e.detail,i=Xe(n),{viewport:a}=i;a.getCamera();const s=e.detail.wheel.direction,l={detail:{element:n,eventName:ee.MOUSE_WHEEL,renderingEngineId:i.renderingEngineId,viewportId:a.id,camera:{},deltaPoints:{page:r.page,client:r.client,world:r.world,canvas:[0,-s*5]},startPoints:r,lastPoints:r,currentPoints:r}};a.type===Tr.STACK&&this.preMouseDownCallback(l),this._dragCallback(l)}_panCallback(e){const{element:n,deltaPoints:r}=e.detail,i=Xe(n),a=r.world,o=i.viewport.getCamera(),{focalPoint:s,position:l}=o,c=[l[0]-a[0],l[1]-a[1],l[2]-a[2]],f=[s[0]-a[0],s[1]-a[1],s[2]-a[2]];i.viewport.setCamera({focalPoint:f,position:c}),i.viewport.render()}}eg.toolName="Zoom";const Cb="magnify-viewport";class Uv extends $f{constructor(e={},n={supportedInteractionTypes:["Mouse","Touch"],configuration:{magnifySize:10,magnifyWidth:250,magnifyHeight:250}}){super(e,n),this._hasBeenRemoved=!1,this.preMouseDownCallback=r=>{const i=r.detail,{element:a,currentPoints:o}=i,s=Xe(a),{viewport:l,renderingEngine:c}=s;if(!(l instanceof fa))throw new Error("MagnifyTool only works on StackViewports");const f=this._getReferencedImageId(l);if(!f)throw new Error("MagnifyTool: No referenced image id found, reconstructed planes not supported yet");const u=fn(a,this.getToolName());return this.editData={referencedImageId:f,viewportIdsToRender:u,enabledElement:s,renderingEngine:c,currentPoints:o},this._createMagnificationViewport(),this._activateDraw(a),Rn(a),r.preventDefault(),at(u),!0},this.preTouchStartCallback=r=>{this.preMouseDownCallback(r)},this._createMagnificationViewport=()=>{const{enabledElement:r,referencedImageId:i,viewportIdsToRender:a,renderingEngine:o,currentPoints:s}=this.editData,{viewport:l}=r,{element:c}=l,f=l.getProperties(),{rotation:u}=l.getViewPresentation(),{canvas:d,world:h}=s;let p;if(p=c.querySelector(".magnifyTool"),p===null){const m=document.createElement("div");m.classList.add("magnifyTool"),m.style.display="block",m.style.width=`${this.configuration.magnifyWidth}px`,m.style.height=`${this.configuration.magnifyHeight}px`,m.style.position="absolute",p=m,c.querySelector(".viewport-element").appendChild(m);const v={viewportId:Cb,type:Tr.STACK,element:p};o.enableElement(v)}p.style.top=`${d[1]-this.configuration.magnifyHeight/2}px`,p.style.left=`${d[0]-this.configuration.magnifyWidth/2}px`;const g=o.getViewport(Cb);g.setStack([i]).then(()=>{if(this._hasBeenRemoved)return;g.setProperties(f),g.setViewPresentation({rotation:u});const{parallelScale:m}=l.getCamera(),{focalPoint:y,position:v,viewPlaneNormal:x}=g.getCamera(),w=Math.sqrt(Math.pow(y[0]-v[0],2)+Math.pow(y[1]-v[1],2)+Math.pow(y[2]-v[2],2)),S=[h[0],h[1],h[2]],T=[S[0]+w*x[0],S[1]+w*x[1],S[2]+w*x[2]];g.setCamera({parallelScale:m*(1/this.configuration.magnifySize),focalPoint:S,position:T}),g.render()}),p.style.display="block",at(a)},this._dragCallback=r=>{const i=r.detail,{deltaPoints:a,element:o,currentPoints:s}=i,l=a.world,c=s.canvas,f=Xe(o),{renderingEngine:u}=f,d=u.getViewport(Cb),h=o.querySelector(".magnifyTool");if(!h)return;h.style.top=`${c[1]-this.configuration.magnifyHeight/2}px`,h.style.left=`${c[0]-this.configuration.magnifyWidth/2}px`;const{focalPoint:p,position:g}=d.getCamera(),m=[g[0]+l[0],g[1]+l[1],g[2]+l[2]],y=[p[0]+l[0],p[1]+l[1],p[2]+l[2]];d.setCamera({focalPoint:y,position:m}),d.render()},this._dragEndCallback=r=>{const{element:i}=r.detail,a=Xe(i),{renderingEngine:o}=a;o.disableElement(Cb);const s=i.querySelector(".viewport-element"),l=s.querySelector(".magnifyTool");s.removeChild(l),this._deactivateDraw(i),qn(i),this._hasBeenRemoved=!0},this._activateDraw=r=>{Dt.isInteractingWithTool=!0,this._hasBeenRemoved=!1,r.addEventListener(ee.MOUSE_UP,this._dragEndCallback),r.addEventListener(ee.MOUSE_DRAG,this._dragCallback),r.addEventListener(ee.MOUSE_CLICK,this._dragEndCallback),r.addEventListener(ee.TOUCH_END,this._dragEndCallback),r.addEventListener(ee.TOUCH_DRAG,this._dragCallback)},this._deactivateDraw=r=>{Dt.isInteractingWithTool=!1,r.removeEventListener(ee.MOUSE_UP,this._dragEndCallback),r.removeEventListener(ee.MOUSE_DRAG,this._dragCallback),r.removeEventListener(ee.MOUSE_CLICK,this._dragEndCallback),r.removeEventListener(ee.TOUCH_END,this._dragEndCallback),r.removeEventListener(ee.TOUCH_DRAG,this._dragCallback)}}_getReferencedImageId(e){const n=this.getTargetId(e);let r;return e instanceof fa&&(r=n.split("imageId:")[1]),r}}Uv.toolName="Magnify";const sje="advancedMagnifyTool",lje=125,{Events:Cd}=ll,fB=t=>t.uid!==t.referencedId;var g9;(function(t){t.ShowZoomFactorsList="showZoomFactorsList"})(g9||(g9={}));const cje="AdvancedMagnify",uje=1-al,mM=class mM extends la{constructor(e={},n={supportedInteractionTypes:["Mouse","Touch"],configuration:{shadow:!0,magnifyingGlass:{radius:125,zoomFactor:3,zoomFactorList:[1.5,2,2.5,3,3.5,4,4.5,5],autoPan:{enabled:!0,padding:10}},actions:{showZoomFactorsList:{method:"showZoomFactorsList",bindings:[{mouseButton:wu.Secondary,modifierKey:La.Shift}]}}}}){super(e,n),this.addNewAnnotation=r=>{const i=r.detail,{currentPoints:a,element:o}=i,s=Xe(o),{viewport:l,renderingEngine:c}=s,f=a.world,u=a.canvas,{magnifyingGlass:d}=this.configuration,{radius:h,zoomFactor:p,autoPan:g}=d,m=this._getCanvasHandlePoints(u,h),y=l.getCamera(),{viewPlaneNormal:v,viewUp:x}=y,w=this.getReferencedImageId(l,f,v,x),S=cr(),T=cr(),_=l.getFrameOfReferenceUID(),D={annotationUID:S,highlighted:!0,invalidated:!0,metadata:{toolName:this.getToolName(),viewPlaneNormal:[...v],viewUp:[...x],FrameOfReferenceUID:_,referencedImageId:w},data:{sourceViewportId:l.id,magnifyViewportId:T,zoomFactor:p,isCanvasAnnotation:!0,handles:{points:m,activeHandleIndex:null}}};this.magnifyViewportManager.createViewport(D,{magnifyViewportId:T,sourceEnabledElement:s,position:u,radius:h,zoomFactor:p,autoPan:{enabled:g.enabled,padding:g.padding,callback:R=>{const O=D.data.handles.points,{canvas:P}=R.delta;for(let N=0,A=O.length;N<A;N++){const B=O[N];B[0]+=P[0],B[1]+=P[1],D.invalidated=!0}}}}),mr(D,o);const I=fn(o,this.getToolName());return r.preventDefault(),at(I),D},this.onSetToolDisabled=()=>{this.magnifyViewportManager.dispose(),sS().forEach(i=>{i.metadata.toolName===this.getToolName()&&_r(i.annotationUID)})},this.isPointNearTool=(r,i,a,o)=>{const{data:s}=i,{points:l}=s.handles,c=l,f=c[0],u=c[2],d=c[3],h=Math.abs(u[1]-f[1])*.5,p=[d[0]+h,f[1]+h],g=f2([p,a]);return Math.abs(g-h)<o*2},this.toolSelectedCallback=(r,i)=>{const a=r.detail,{element:o}=a;i.highlighted=!0;const s=fn(o,this.getToolName());this.editData={annotation:i,viewportIdsToRender:s},Rn(o),this._activateModify(o),at(s),r.preventDefault()},this.handleSelectedCallback=(r,i,a)=>{const o=r.detail,{element:s}=o,{data:l}=i;i.highlighted=!0;const{points:c}=l.handles,f=c.findIndex(d=>d===a),u=fn(s,this.getToolName());this.editData={annotation:i,viewportIdsToRender:u,handleIndex:f},this._activateModify(s),Rn(s),at(u),r.preventDefault()},this._endCallback=r=>{const i=r.detail,{element:a}=i,{annotation:o,viewportIdsToRender:s,newAnnotation:l}=this.editData,{data:c}=o;c.handles.activeHandleIndex=null,this._deactivateModify(a),qn(a),this.editData=null,this.isDrawing=!1,at(s),l&&Xr(o)},this._dragDrawCallback=r=>{this.isDrawing=!0;const i=r.detail,{deltaPoints:a}=i,o=a?.canvas??[0,0,0],{annotation:s,viewportIdsToRender:l}=this.editData,{points:c}=s.data.handles;c.forEach(f=>{f[0]+=o[0],f[1]+=o[1]}),s.invalidated=!0,this.editData.hasMoved=!0,at(l)},this._dragModifyCallback=r=>{this.isDrawing=!0;const i=r.detail,{element:a}=i,{annotation:o,viewportIdsToRender:s,handleIndex:l}=this.editData,{data:c}=o;if(l===void 0){const{deltaPoints:f}=i,u=f.canvas;c.handles.points.forEach(h=>{h[0]+=u[0],h[1]+=u[1]}),o.invalidated=!0}else this._dragHandle(r),o.invalidated=!0;at(s)},this._dragHandle=r=>{const i=r.detail,{annotation:a}=this.editData,{data:o}=a,{points:s}=o.handles,l=s,c=l[0],f=l[2],u=l[3],d=Math.abs(f[1]-c[1])*.5,h=[u[0]+d,c[1]+d],{currentPoints:p}=i,g=p.canvas,m=f2([h,g]),y=this._getCanvasHandlePoints(h,m);s[0]=y[0],s[1]=y[1],s[2]=y[2],s[3]=y[3]},this.cancel=r=>{if(!this.isDrawing)return;this.isDrawing=!1,this._deactivateModify(r),qn(r);const{annotation:i,viewportIdsToRender:a,newAnnotation:o}=this.editData,{data:s}=i;return i.highlighted=!1,s.handles.activeHandleIndex=null,at(a),o&&Xr(i),this.editData=null,i.annotationUID},this._activateModify=r=>{Dt.isInteractingWithTool=!0,r.addEventListener(ee.MOUSE_UP,this._endCallback),r.addEventListener(ee.MOUSE_DRAG,this._dragModifyCallback),r.addEventListener(ee.MOUSE_CLICK,this._endCallback),r.addEventListener(ee.TOUCH_END,this._endCallback),r.addEventListener(ee.TOUCH_DRAG,this._dragModifyCallback),r.addEventListener(ee.TOUCH_TAP,this._endCallback)},this._deactivateModify=r=>{Dt.isInteractingWithTool=!1,r.removeEventListener(ee.MOUSE_UP,this._endCallback),r.removeEventListener(ee.MOUSE_DRAG,this._dragModifyCallback),r.removeEventListener(ee.MOUSE_CLICK,this._endCallback),r.removeEventListener(ee.TOUCH_END,this._endCallback),r.removeEventListener(ee.TOUCH_DRAG,this._dragModifyCallback),r.removeEventListener(ee.TOUCH_TAP,this._endCallback)},this.renderAnnotation=(r,i)=>{let a=!1;const{viewport:o}=r,{element:s}=o;let l=Zi(this.getToolName(),s);if(!l?.length)return a;l=l?.filter(u=>u.data.sourceViewportId===o.id);const c=this.filterInteractableAnnotationsForElement(s,l);if(!c?.length)return a;const f={toolGroupId:this.toolGroupId,toolName:this.getToolName(),viewportId:r.viewport.id};for(let u=0;u<c.length;u++){const d=c[u],{annotationUID:h,data:p}=d,{magnifyViewportId:g,zoomFactor:m,handles:y}=p,{points:v,activeHandleIndex:x}=y;f.annotationUID=h,this.getStyle("lineWidth",f,d),this.getStyle("lineDash",f,d);const w=this.getStyle("color",f,d),S=v,T=S[0],_=S[2],D=S[3],I=Math.abs(_[1]-T[1])*.5,R=[D[0]+I,T[1]+I];if(!o.getRenderingEngine())return console.warn("Rendering Engine has been destroyed"),a;let O;if(!xo(h))continue;!yo(h)&&!this.editData&&x!==null&&(O=[S[x]]),O&&bo(i,h,"0",O,{color:w});const P=`${h}-advancedMagnify`;h0(i,h,"0",R,I,{color:w,lineWidth:5},P);const A=this.magnifyViewportManager.getViewport(g);A.position=R,A.radius=I,A.zoomFactor=m,A.update(),a=!0}return a},this._getCanvasHandlePoints=(r,i)=>[[r[0],r[1]-i,0],[r[0]+i,r[1],0],[r[0],r[1]+i,0],[r[0]-i,r[1],0]],this.magnifyViewportManager=gg.getInstance()}showZoomFactorsList(e,n){const{element:r,currentPoints:i}=e.detail,a=Xe(r),{viewport:o}=a,{canvas:s}=i,l=r.querySelector(":scope .viewport-element"),c=n.data.zoomFactor,f=()=>u.parentElement.removeChild(u),u=this._getZoomFactorsListDropdown(c,d=>{d!==void 0&&(n.data.zoomFactor=Number.parseFloat(d),n.invalidated=!0),f(),o.render()});Object.assign(u.style,{left:`${s[0]}px`,top:`${s[1]}px`}),l.appendChild(u),u.focus()}_getZoomFactorsListDropdown(e,n){const{zoomFactorList:r}=this.configuration.magnifyingGlass,i=document.createElement("select");return i.size=5,Object.assign(i.style,{width:"50px",position:"absolute"}),["mousedown","mouseup","mousemove","click"].forEach(a=>{i.addEventListener(a,o=>o.stopPropagation())}),i.addEventListener("change",a=>{a.stopPropagation(),n(i.value)}),i.addEventListener("keydown",a=>{((a.keyCode??a.which===27)||a.key?.toLowerCase()==="escape")&&(a.stopPropagation(),n())}),r.forEach(a=>{const o=document.createElement("option");o.label=a,o.title=`Zoom factor ${a.toFixed(1)}`,o.value=a,o.defaultSelected=a===e,i.add(o)}),i}};mM.Actions=g9;let Hd=mM;class gg{constructor(){this.createViewport=(e,n)=>{const{magnifyViewportId:r,sourceEnabledElement:i,position:a,radius:o,zoomFactor:s,autoPan:l}=n,{viewport:c}=i,{element:f}=c,u=new fje({magnifyViewportId:r,sourceEnabledElement:i,radius:o,position:a,zoomFactor:s,autoPan:l});return this._addSourceElementEventListener(f),this._magnifyViewportsMap.set(u.viewportId,{annotation:e,magnifyViewport:u,magnifyViewportInfo:n}),u},this._annotationRemovedCallback=e=>{const{annotation:n}=e.detail;n.metadata.toolName===cje&&this.destroyViewport(n.data.magnifyViewportId)},this._newStackImageCallback=e=>{const{viewportId:n,imageId:r}=e.detail,i=this._getMagnifyViewportsMapEntriesBySourceViewportId(n),{viewport:a}=xr(n);a.stackActorReInitialized&&this._reset(n),i.forEach(({annotation:o})=>{o.metadata.referencedImageId=r,o.invalidated=!0})},this._newVolumeImageCallback=e=>{const{renderingEngineId:n,viewportId:r}=e.detail,a=zf(n).getViewport(r),{viewPlaneNormal:o}=a.getCamera();this._getMagnifyViewportsMapEntriesBySourceViewportId(r).forEach(({annotation:l})=>{const{viewPlaneNormal:c}=l.metadata;if(!(Math.abs(zt(c,o))>uje))return;const{handles:u}=l.data,d=a.canvasToWorld([0,0]),h=dr(it(),d,u.points[0]),p=zt(h,o),g=tl(it(),o,p);for(let m=0,y=u.points.length;m<y;m++){const v=u.points[m];v[0]+=g[0],v[1]+=g[1],v[2]+=g[2]}l.invalidated=!0})},this._magnifyViewportsMap=new Map,this._initialize()}static getInstance(){return gg._singleton=gg._singleton??new gg,gg._singleton}getViewport(e){return this._magnifyViewportsMap.get(e)?.magnifyViewport}dispose(){this._removeEventListeners(),this._destroyViewports()}destroyViewport(e){const n=this._magnifyViewportsMap.get(e);if(n){const{magnifyViewport:r}=n,{viewport:i}=r.sourceEnabledElement,{element:a}=i;this._removeSourceElementEventListener(a),r.dispose(),this._magnifyViewportsMap.delete(e)}}_destroyViewports(){Array.from(this._magnifyViewportsMap.keys()).forEach(n=>this.destroyViewport(n))}_getMagnifyViewportsMapEntriesBySourceViewportId(e){return Array.from(this._magnifyViewportsMap.values()).filter(({magnifyViewport:r})=>{const{viewport:i}=r.sourceEnabledElement;return i.id===e})}_reset(e){this._getMagnifyViewportsMapEntriesBySourceViewportId(e).forEach(({magnifyViewport:r,annotation:i,magnifyViewportInfo:a})=>{this.destroyViewport(r.viewportId);const o=xr(e);this.createViewport(i,{...a,sourceEnabledElement:{...o}})})}_addEventListeners(){vt.addEventListener(ee.ANNOTATION_REMOVED,this._annotationRemovedCallback)}_removeEventListeners(){vt.removeEventListener(ee.ANNOTATION_REMOVED,this._annotationRemovedCallback)}_addSourceElementEventListener(e){e.addEventListener(Cd.STACK_NEW_IMAGE,this._newStackImageCallback);const n=i=>{const{viewportId:a}=i.detail;this._reset(a)};e.addEventListener(Cd.VIEWPORT_NEW_IMAGE_SET,n);const r=i=>{const{viewportId:a}=i.detail;this._reset(a)};e.addEventListener(Cd.VOLUME_VIEWPORT_NEW_VOLUME,r),e.addEventListener(Cd.VOLUME_NEW_IMAGE,this._newVolumeImageCallback),e.newStackHandler=n,e.newVolumeHandler=r}_removeSourceElementEventListener(e){e.removeEventListener(Cd.STACK_NEW_IMAGE,this._newStackImageCallback),e.removeEventListener(Cd.VOLUME_NEW_IMAGE,this._newVolumeImageCallback),e.removeEventListener(Cd.VIEWPORT_NEW_IMAGE_SET,e.newStackHandler),e.removeEventListener(Cd.VOLUME_VIEWPORT_NEW_VOLUME,e.newVolumeHandler),delete e.newStackHandler,delete e.newVolumeHandler}_initialize(){this._addEventListeners()}}class fje{constructor({magnifyViewportId:e,sourceEnabledElement:n,radius:r=lje,position:i=[0,0],zoomFactor:a,autoPan:o}){this._enabledElement=null,this._sourceToolGroup=null,this._magnifyToolGroup=null,this._isViewportReady=!1,this._radius=0,this._resized=!1,this._canAutoPan=!1,this._viewportId=e??cr(),this._sourceEnabledElement=n,this._autoPan=o,this.radius=r,this.position=i,this.zoomFactor=a,this.visible=!0,this._browserMouseDownCallback=this._browserMouseDownCallback.bind(this),this._browserMouseUpCallback=this._browserMouseUpCallback.bind(this),this._handleToolModeChanged=this._handleToolModeChanged.bind(this),this._mouseDragCallback=this._mouseDragCallback.bind(this),this._resizeViewportAsync=hS(this._resizeViewport.bind(this),1),this._initialize()}get sourceEnabledElement(){return this._sourceEnabledElement}get viewportId(){return this._viewportId}get radius(){return this._radius}set radius(e){Math.abs(this._radius-e)>1e-5&&(this._radius=e,this._resized=!0)}update(){const{radius:e,position:n,visible:r}=this,{viewport:i}=this._enabledElement,{element:a}=i,o=2*e,[s,l]=n;this._resized&&(this._resizeViewportAsync(),this._resized=!1),Object.assign(a.style,{display:r?"block":"hidden",width:`${o}px`,height:`${o}px`,left:`${-e}px`,top:`${-e}px`,transform:`translate(${s}px, ${l}px)`}),this._isViewportReady&&(this._syncViewports(),i.render())}dispose(){const{viewport:e}=this._enabledElement,{element:n}=e,r=e.getRenderingEngine();this._removeEventListeners(n),r.disableElement(e.id),n.parentNode&&n.parentNode.removeChild(n)}_handleToolModeChanged(e){const{_magnifyToolGroup:n}=this,{toolGroupId:r,toolName:i,mode:a,toolBindingsOptions:o}=e.detail;if(this._sourceToolGroup?.id===r)switch(a){case br.Active:n.setToolActive(i,o);break;case br.Passive:n.setToolPassive(i);break;case br.Enabled:n.setToolEnabled(i);break;case br.Disabled:n.setToolDisabled(i);break;default:throw new Error(`Unknow tool mode (${a})`)}}_inheritBorderRadius(e){const n=e.querySelector(".viewport-element"),r=e.querySelector(".cornerstone-canvas");n.style.borderRadius="inherit",r.style.borderRadius="inherit"}_createViewportNode(){const e=document.createElement("div"),{radius:n}=this,r=n*2;return e.classList.add(sje),Object.assign(e.style,{display:"block",width:`${r}px`,height:`${r}px`,position:"absolute",overflow:"hidden",borderRadius:"50%",boxSizing:"border-box",left:`${-n}px`,top:`${-n}px`,transform:"translate(-1000px, -1000px)"}),e}_convertZoomFactorToParallelScale(e,n,r){const{parallelScale:i}=e.getCamera(),a=n.canvas.offsetWidth/e.canvas.offsetWidth;return i*(1/r)*a}_isStackViewport(e){return"setStack"in e}_isVolumeViewport(e){return"addVolumes"in e}_cloneToolGroups(e,n){const r=e.getActors(),i=`${n.id}-toolGroup`,a=to(e.id,e.renderingEngineId),o=a.clone(i,s=>{const l=a.getToolInstance(s);return l instanceof la&&!(l instanceof Hd)});return o.addViewport(n.id,n.renderingEngineId),r.filter(fB).forEach(s=>{JGe(this.viewportId,[{segmentationId:s.referencedId,type:hn.Labelmap}])}),{sourceToolGroup:a,magnifyToolGroup:o}}_cloneStack(e,n){const r=e.getImageIds();n.setStack(r).then(()=>{this._isViewportReady=!0,this.update()})}_cloneVolumes(e,n){const i=e.getActors().filter(a=>!fB(a)).map(a=>({volumeId:a.uid}));return n.setVolumes(i).then(()=>{this._isViewportReady=!0,this.update()}),n}_cloneViewport(e,n){const{viewportId:r}=this,i=e.getRenderingEngine(),{options:a}=e,o={element:n,viewportId:r,type:e.type,defaultOptions:{...a}};i.enableElement(o);const s=i.getViewport(r);this._isStackViewport(e)?this._cloneStack(e,s):this._isVolumeViewport(e)&&this._cloneVolumes(e,s),this._inheritBorderRadius(n);const l=this._cloneToolGroups(e,s);this._sourceToolGroup=l.sourceToolGroup,this._magnifyToolGroup=l.magnifyToolGroup}_cancelMouseEventCallback(e){e.stopPropagation(),e.preventDefault()}_browserMouseUpCallback(e){const{element:n}=this._enabledElement.viewport;document.removeEventListener("mouseup",this._browserMouseUpCallback),n.addEventListener("mouseup",this._cancelMouseEventCallback),n.addEventListener("mousemove",this._cancelMouseEventCallback)}_browserMouseDownCallback(e){const{element:n}=this._enabledElement.viewport;this._canAutoPan=!!e.target?.closest(".advancedMagnifyTool"),document.addEventListener("mouseup",this._browserMouseUpCallback),n.removeEventListener("mouseup",this._cancelMouseEventCallback),n.removeEventListener("mousemove",this._cancelMouseEventCallback)}_mouseDragCallback(e){if(!Dt.isInteractingWithTool)return;const{_autoPan:n}=this;if(!n.enabled||!this._canAutoPan)return;const{currentPoints:r}=e.detail,{viewport:i}=this._enabledElement,{canvasToWorld:a}=i,{canvas:o}=r,{radius:s}=this,l=[s,s],c=Qh(l,o),f=s-n.padding;if(c<=f)return;const u=c-f,d=Vh(Kn(),o,l);dh(d,d),__(d,d,u);const h=FC(Kn(),this.position,d),p=a(this.position),g=a(h),m=dr(it(),g,p),y={points:{currentPosition:{canvas:this.position,world:p},newPosition:{canvas:h,world:g}},delta:{canvas:d,world:m}};n.callback(y)}_addBrowserEventListeners(e){document.addEventListener("mousedown",this._browserMouseDownCallback,!0),e.addEventListener("mousedown",this._cancelMouseEventCallback),e.addEventListener("mouseup",this._cancelMouseEventCallback),e.addEventListener("mousemove",this._cancelMouseEventCallback),e.addEventListener("dblclick",this._cancelMouseEventCallback)}_removeBrowserEventListeners(e){document.removeEventListener("mousedown",this._browserMouseDownCallback,!0),document.removeEventListener("mouseup",this._browserMouseUpCallback),e.removeEventListener("mousedown",this._cancelMouseEventCallback),e.removeEventListener("mouseup",this._cancelMouseEventCallback),e.removeEventListener("mousemove",this._cancelMouseEventCallback),e.removeEventListener("dblclick",this._cancelMouseEventCallback)}_addEventListeners(e){vt.addEventListener(ee.TOOL_MODE_CHANGED,this._handleToolModeChanged),e.addEventListener(ee.MOUSE_MOVE,this._mouseDragCallback),e.addEventListener(ee.MOUSE_DRAG,this._mouseDragCallback),this._addBrowserEventListeners(e)}_removeEventListeners(e){vt.removeEventListener(ee.TOOL_MODE_CHANGED,this._handleToolModeChanged),e.addEventListener(ee.MOUSE_MOVE,this._mouseDragCallback),e.addEventListener(ee.MOUSE_DRAG,this._mouseDragCallback),this._removeBrowserEventListeners(e)}_initialize(){const{_sourceEnabledElement:e}=this,{viewport:n}=e,{canvas:r}=n,i=this._createViewportNode();r.parentNode.appendChild(i),this._addEventListeners(i),this._cloneViewport(n,i),this._enabledElement=Xe(i)}_syncViewportsCameras(e,n){const r=e.canvasToWorld(this.position),i=this._convertZoomFactorToParallelScale(e,n,this.zoomFactor),{focalPoint:a,position:o,viewPlaneNormal:s}=n.getCamera(),l=Math.sqrt(Math.pow(a[0]-o[0],2)+Math.pow(a[1]-o[1],2)+Math.pow(a[2]-o[2],2)),c=[r[0],r[1],r[2]],f=[c[0]+l*s[0],c[1]+l*s[1],c[2]+l*s[2]];n.setCamera({parallelScale:i,focalPoint:c,position:f})}_syncStackViewports(e,n){n.setImageIdIndex(e.getCurrentImageIdIndex())}_syncViewports(){const{viewport:e}=this._sourceEnabledElement,{viewport:n}=this._enabledElement,r=e.getProperties();n.getImageData()&&(n.setProperties(r),this._syncViewportsCameras(e,n),this._isStackViewport(e)&&this._syncStackViewports(e,n),this._syncViewportsCameras(e,n),n.render())}_resizeViewport(){const{viewport:e}=this._enabledElement;e.getRenderingEngine().resize()}}Hd.toolName="AdvancedMagnify";const{EPSILON:dB}=Xh;class Bv extends WO{constructor(e={},n={supportedInteractionTypes:["Mouse","Touch"],configuration:{sourceImageIds:[]}}){super(e,n),this.onSetToolEnabled=()=>{this._init()},this.onSetToolActive=()=>{this._init()},this._init=()=>{const r=this.configuration.sourceImageIds;if(!r?.length){console.warn("OverlayGridTool: No sourceImageIds provided in configuration");return}const i=Ut("imagePlaneModule",r[0]);if(!i){console.warn("OverlayGridTool: No imagePlaneModule found for sourceImageIds");return}const{frameOfReferenceUID:a}=i,o=jh(this.toolGroupId).viewportsInfo;if(!o?.length){console.warn("OverlayGridTool: No viewports found");return}if(!Zi(this.getToolName(),a)?.length){const l=r.map(f=>this.calculateImageIdPointSets(f)),c={highlighted:!0,invalidated:!0,metadata:{toolName:this.getToolName(),FrameOfReferenceUID:a,referencedImageId:null},data:{viewportData:new Map,pointSets:l}};mr(c,a)}at(o.map(({viewportId:l})=>l))},this.calculateImageIdPointSets=r=>{const{imagePositionPatient:i,rows:a,columns:o,rowCosines:s,columnCosines:l,rowPixelSpacing:c,columnPixelSpacing:f}=Ut("imagePlaneModule",r),u=[...i],d=[...i],h=[...i],p=[...i];return Ar(d,i,l,o*f),Ar(h,i,s,a*c),Ar(p,h,l,o*f),{pointSet1:[u,h,d,p],pointSet2:[u,d,h,p]}},this.renderAnnotation=(r,i)=>{const a=this.configuration.sourceImageIds;let o=!1;if(!a?.length)return o;const{viewport:s,FrameOfReferenceUID:l}=r;if(s.getImageIds().length<2)return o;const f=Zi(this.getToolName(),l);if(!f?.length)return o;const u=f[0],{annotationUID:d}=u,{focalPoint:h,viewPlaneNormal:p}=s.getCamera(),g={toolGroupId:this.toolGroupId,toolName:this.getToolName(),viewportId:r.viewport.id},m=this.getImageIdNormal(a[0]);if(this.isParallel(p,m))return o;const y=Q7(p,h),v=u.data.pointSets,x=u.data.viewportData;for(let w=0;w<a.length;w++){const{pointSet1:S,pointSet2:T}=v[w],_=x.get(s.id)||this.initializeViewportData(x,s.id);if(!_.pointSetsToUse[w]){let $=S,U=Pr(it(),S[0],S[1]);U=Lr(it(),U),this.isPerpendicular(U,p)&&($=T),_.pointSetsToUse[w]=$,_.lineStartsWorld[w]=b3($[0],$[1],y),_.lineEndsWorld[w]=b3($[2],$[3],y)}const D=_.lineStartsWorld[w],I=_.lineEndsWorld[w];g.annotationUID=d;const R=this.getStyle("lineWidth",g,u),O=this.getStyle("lineDash",g,u),P=this.getStyle("color",g,u),N=this.getStyle("shadow",g,u),A=[D,I].map($=>s.worldToCanvas($)),B=`${d}-line`,V=`${w}`;Va(i,d,V,A[0],A[1],{color:P,width:R,lineDash:O,shadow:N},B)}return o=!0,o},this.initializeViewportData=(r,i)=>(r.set(i,{pointSetsToUse:[],lineStartsWorld:[],lineEndsWorld:[]}),r.get(i)),this.isPerpendicular=(r,i)=>{const a=zt(r,i);return Math.abs(a)<dB}}isParallel(e,n){return Math.abs(zt(e,n))>1-dB}getImageIdNormal(e){const{imageOrientationPatient:n}=Ut("imagePlaneModule",e),r=Sn(n[0],n[1],n[2]),i=Sn(n[3],n[4],n[5]);return gr(it(),r,i)}}Bv.toolName="OverlayGrid";const b2=class b2 extends la{constructor(e={},n={supportedInteractionTypes:["Mouse","Touch"],configuration:{shadow:!0,getTextCallback:dje,changeTextCallback:hje,preventHandleOutsideImage:!1}}){super(e,n),this.isPointNearTool=(r,i,a,o)=>{const s=Xe(r),{viewport:l}=s,{annotationUID:c}=i,f=i.data.handles.points[0],u=l.worldToCanvas(f);if(ii(a,u)<o)return!0;const h=r.querySelector("svg");if(!h)return!1;const p=h.querySelector(`g[data-annotation-uid="${c}"]`);if(!p)return!1;const g=p,m=g.getBBox(),y=g.getAttribute("transform");let v=0,x=0;if(y){const _=y.match(/translate\(([-\d.]+)\s+([-\d.]+)\)/);_&&(v=parseFloat(_[1]),x=parseFloat(_[2]))}const w=m.x+v,S=m.y+x;return a[0]>=w&&a[0]<=w+m.width&&a[1]>=S&&a[1]<=S+m.height},this.addNewAnnotation=r=>{const i=r.detail,{currentPoints:a,element:o}=i,s=a.world,l=Xe(o),{viewport:c}=l;Rn(o),this.isDrawing=!0;const f=c.getCamera(),{viewPlaneNormal:u,viewUp:d}=f,h=this.getReferencedImageId(c,s,u,d),p=c.getFrameOfReferenceUID(),g={annotationUID:null,highlighted:!0,invalidated:!0,metadata:{toolName:this.getToolName(),viewPlaneNormal:[...u],viewUp:[...d],FrameOfReferenceUID:p,referencedImageId:h,...c.getViewReference({points:[s]})},data:{text:"",handles:{points:[[...s],[...s]]},label:""}};mr(g,o);const m=fn(o,this.getToolName());return this.editData={annotation:g,newAnnotation:!0,viewportIdsToRender:m,offset:[0,0,0]},r.preventDefault(),at(m),this.configuration.getTextCallback(y=>{if(!y){_r(g.annotationUID),at(m),this.isDrawing=!1;return}qn(o),g.data.text=y,Xr(g),at(m)}),this.createMemo(o,g,{newAnnotation:!0}),g},this.toolSelectedCallback=(r,i)=>{const a=r.detail,{element:o,currentPoints:s}=a;i.highlighted=!0;const l=fn(o,this.getToolName());let c=[0,0,0];if(s&&s.world){const f=s.world,u=i.data.handles.points[0];c=[u[0]-f[0],u[1]-f[1],u[2]-f[2]]}this.editData={annotation:i,viewportIdsToRender:l,offset:c},this._activateModify(o),Rn(o),at(l),r.preventDefault()},this._endCallback=r=>{const i=r.detail,{element:a}=i,{annotation:o,viewportIdsToRender:s,newAnnotation:l}=this.editData;this._deactivateDraw(a),this._deactivateModify(a),qn(a),l&&this.createMemo(a,o,{newAnnotation:l}),this.editData=null,this.isDrawing=!1,this.doneEditMemo(),this.isHandleOutsideImage&&this.configuration.preventHandleOutsideImage&&_r(o.annotationUID),at(s),l&&Xr(o)},this._dragCallback=r=>{const i=r.detail,{currentPoints:a,element:o}=i,s=a.world,{annotation:l,viewportIdsToRender:c,offset:f}=this.editData;f?l.data.handles.points[0]=[s[0]+f[0],s[1]+f[1],s[2]+f[2]]:l.data.handles.points[0]=[...s],l.invalidated=!0,at(c),Un(l,o,xn.LabelChange)},this.cancel=r=>{if(this.isDrawing){this.isDrawing=!1,this._deactivateModify(r),qn(r);const{annotation:i,viewportIdsToRender:a,newAnnotation:o}=this.editData,{data:s}=i;return i.highlighted=!1,s.handles.activeHandleIndex=null,at(a),o&&Xr(i),this.editData=null,i.annotationUID}},this._activateModify=r=>{Dt.isInteractingWithTool=!0,r.addEventListener(ee.MOUSE_UP,this._endCallback),r.addEventListener(ee.MOUSE_DRAG,this._dragCallback),r.addEventListener(ee.MOUSE_CLICK,this._endCallback),r.addEventListener(ee.TOUCH_TAP,this._endCallback),r.addEventListener(ee.TOUCH_END,this._endCallback),r.addEventListener(ee.TOUCH_DRAG,this._dragCallback)},this._deactivateModify=r=>{Dt.isInteractingWithTool=!1,r.removeEventListener(ee.MOUSE_UP,this._endCallback),r.removeEventListener(ee.MOUSE_DRAG,this._dragCallback),r.removeEventListener(ee.MOUSE_CLICK,this._endCallback),r.removeEventListener(ee.TOUCH_TAP,this._endCallback),r.removeEventListener(ee.TOUCH_DRAG,this._dragCallback),r.removeEventListener(ee.TOUCH_END,this._endCallback)},this._activateDraw=r=>{Dt.isInteractingWithTool=!0,r.addEventListener(ee.MOUSE_UP,this._endCallback),r.addEventListener(ee.MOUSE_DRAG,this._dragCallback),r.addEventListener(ee.MOUSE_MOVE,this._dragCallback),r.addEventListener(ee.MOUSE_CLICK,this._endCallback),r.addEventListener(ee.TOUCH_TAP,this._endCallback),r.addEventListener(ee.TOUCH_END,this._endCallback),r.addEventListener(ee.TOUCH_DRAG,this._dragCallback)},this._deactivateDraw=r=>{Dt.isInteractingWithTool=!1,r.removeEventListener(ee.MOUSE_UP,this._endCallback),r.removeEventListener(ee.MOUSE_DRAG,this._dragCallback),r.removeEventListener(ee.MOUSE_MOVE,this._dragCallback),r.removeEventListener(ee.MOUSE_CLICK,this._endCallback),r.removeEventListener(ee.TOUCH_TAP,this._endCallback),r.removeEventListener(ee.TOUCH_END,this._endCallback),r.removeEventListener(ee.TOUCH_DRAG,this._dragCallback)},this.renderAnnotation=(r,i)=>{let a=!1;const{viewport:o}=r,{element:s}=o;let l=Zi(this.getToolName(),s);if(!l?.length)return a;l=this.filterInteractableAnnotationsForElement(s,l);const c={toolGroupId:this.toolGroupId,toolName:this.getToolName(),viewportId:r.viewport.id};for(let f=0;f<l.length;f++){const u=l[f],{annotationUID:d,data:h}=u,p=h.handles.points[0];c.annotationUID=d;const g=o.worldToCanvas(p);if(a=!0,!o.getRenderingEngine())return console.warn("Rendering Engine has been destroyed"),a;if(!xo(d)||!h.text)continue;const m=this.getLinkedTextBoxStyle(c,u);sy(i,d,"1",[h.text],g,{...m,padding:0})}return a}}handleSelectedCallback(e,n,r,i){}_doneChangingTextCallback(e,n,r){n.data.text=r;const i=fn(e,this.getToolName());at(i),Un(n,e)}_isInsideVolume(e,n,r){return Ta(e,r)&&Ta(n,r)}};b2.toolName="Label",b2.hydrate=(e,n,r,i)=>{const a=xr(e);if(!a)return;const{viewport:o}=a,s=o.getFrameOfReferenceUID(),{viewPlaneNormal:l,viewUp:c}=o.getCamera(),f=new b2,u=f.getReferencedImageId(o,n,l,c),d={annotationUID:i?.annotationUID||cr(),data:{text:r,handles:{points:[n]}},highlighted:!1,autoGenerated:!1,invalidated:!1,isLocked:!1,isVisible:!0,metadata:{toolName:f.getToolName(),viewPlaneNormal:l,FrameOfReferenceUID:s,referencedImageId:u,...i}};mr(d,o.element),at([o.id])};let yh=b2;function dje(t){return t(prompt("Enter your annotation:"))}function hje(t,e,n){return n(prompt("Enter your annotation:"))}yh.toolName="Label";const{transformWorldToIndex:hB}=Yr,Rg=class Rg extends la{constructor(e={},n={supportedInteractionTypes:["Mouse","Touch"],configuration:{preventHandleOutsideImage:!1,getTextLines:pje,actions:{undo:{method:"undo",bindings:[{key:"z"}]},redo:{method:"redo",bindings:[{key:"y"}]}}}}){super(e,n),this.addNewAnnotation=r=>{const i=r.detail,{currentPoints:a,element:o}=i,s=a.world,l=Xe(o),{viewport:c}=l;Rn(o),this.isDrawing=!0;const{viewPlaneNormal:f,viewUp:u,position:d}=c.getCamera(),h=this.getReferencedImageId(c,s,f,u),p={highlighted:!0,invalidated:!0,metadata:{...c.getViewReference({points:[s]}),toolName:this.getToolName(),referencedImageId:h,viewUp:u,cameraPosition:d},data:{handles:{points:[[...s],[...s]],activeHandleIndex:null,textBox:{hasMoved:!1,worldPosition:[0,0,0],worldBoundingBox:{topLeft:[0,0,0],topRight:[0,0,0],bottomLeft:[0,0,0],bottomRight:[0,0,0]}}},label:"",cachedStats:{}}};mr(p,o);const g=fn(o,this.getToolName());return this.editData={annotation:p,viewportIdsToRender:g,handleIndex:1,movingTextBox:!1,newAnnotation:!0,hasMoved:!1},this._activateDraw(o),r.preventDefault(),at(g),p},this.isPointNearTool=(r,i,a,o)=>{const s=Xe(r),{viewport:l}=s,{data:c}=i,[f,u]=c.handles.points,d=l.worldToCanvas(f),h=l.worldToCanvas(u),p={start:{x:d[0],y:d[1]},end:{x:h[0],y:h[1]}};return Ll([p.start.x,p.start.y],[p.end.x,p.end.y],[a[0],a[1]])<=o},this.toolSelectedCallback=(r,i)=>{const a=r.detail,{element:o}=a;i.highlighted=!0;const s=fn(o,this.getToolName());this.editData={annotation:i,viewportIdsToRender:s,movingTextBox:!1},this._activateModify(o),Rn(o),at(s),r.preventDefault()},this._endCallback=r=>{const i=r.detail,{element:a}=i,{annotation:o,viewportIdsToRender:s,newAnnotation:l,hasMoved:c}=this.editData,{data:f}=o;l&&!c||(f.handles.activeHandleIndex=null,this._deactivateModify(a),this._deactivateDraw(a),qn(a),this.isHandleOutsideImage&&this.configuration.preventHandleOutsideImage&&_r(o.annotationUID),at(s),this.doneEditMemo(),l&&Xr(o),this.editData=null,this.isDrawing=!1)},this._dragCallback=r=>{this.isDrawing=!0;const i=r.detail,{element:a}=i,{annotation:o,viewportIdsToRender:s,handleIndex:l,movingTextBox:c,newAnnotation:f}=this.editData,{data:u}=o;if(this.createMemo(a,o,{newAnnotation:f}),c){const{deltaPoints:d}=i,h=d.world,{textBox:p}=u.handles,{worldPosition:g}=p;g[0]+=h[0],g[1]+=h[1],g[2]+=h[2],p.hasMoved=!0}else if(l===void 0){const{deltaPoints:d}=i,h=d.world;u.handles.points.forEach(g=>{g[0]+=h[0],g[1]+=h[1],g[2]+=h[2]}),o.invalidated=!0}else{const{currentPoints:d}=i,h=d.world;u.handles.points[l]=[...h],o.invalidated=!0}this.editData.hasMoved=!0,at(s),o.invalidated&&Un(o,a,xn.HandlesUpdated)},this.cancel=r=>{if(this.isDrawing){this.isDrawing=!1,this._deactivateDraw(r),this._deactivateModify(r),qn(r);const{annotation:i,viewportIdsToRender:a,newAnnotation:o}=this.editData,{data:s}=i;return i.highlighted=!1,s.handles.activeHandleIndex=null,at(a),o&&Xr(i),this.editData=null,i.annotationUID}},this._activateModify=r=>{Dt.isInteractingWithTool=!0,r.addEventListener(ee.MOUSE_UP,this._endCallback),r.addEventListener(ee.MOUSE_DRAG,this._dragCallback),r.addEventListener(ee.MOUSE_CLICK,this._endCallback),r.addEventListener(ee.TOUCH_END,this._endCallback),r.addEventListener(ee.TOUCH_DRAG,this._dragCallback),r.addEventListener(ee.TOUCH_TAP,this._endCallback)},this._deactivateModify=r=>{Dt.isInteractingWithTool=!1,r.removeEventListener(ee.MOUSE_UP,this._endCallback),r.removeEventListener(ee.MOUSE_DRAG,this._dragCallback),r.removeEventListener(ee.MOUSE_CLICK,this._endCallback),r.removeEventListener(ee.TOUCH_END,this._endCallback),r.removeEventListener(ee.TOUCH_DRAG,this._dragCallback),r.removeEventListener(ee.TOUCH_TAP,this._endCallback)},this._activateDraw=r=>{Dt.isInteractingWithTool=!0,r.addEventListener(ee.MOUSE_UP,this._endCallback),r.addEventListener(ee.MOUSE_DRAG,this._dragCallback),r.addEventListener(ee.MOUSE_MOVE,this._dragCallback),r.addEventListener(ee.MOUSE_CLICK,this._endCallback),r.addEventListener(ee.TOUCH_END,this._endCallback),r.addEventListener(ee.TOUCH_DRAG,this._dragCallback),r.addEventListener(ee.TOUCH_TAP,this._endCallback)},this._deactivateDraw=r=>{Dt.isInteractingWithTool=!1,r.removeEventListener(ee.MOUSE_UP,this._endCallback),r.removeEventListener(ee.MOUSE_DRAG,this._dragCallback),r.removeEventListener(ee.MOUSE_MOVE,this._dragCallback),r.removeEventListener(ee.MOUSE_CLICK,this._endCallback),r.removeEventListener(ee.TOUCH_END,this._endCallback),r.removeEventListener(ee.TOUCH_DRAG,this._dragCallback),r.removeEventListener(ee.TOUCH_TAP,this._endCallback)},this.renderAnnotation=(r,i)=>{let a=!1;const{viewport:o}=r,{element:s}=o;let l=Zi(this.getToolName(),s);if(!l?.length||(l=this.filterInteractableAnnotationsForElement(s,l),!l?.length))return a;const c=this.getTargetId(o),f=o.getRenderingEngine(),u={toolGroupId:this.toolGroupId,toolName:this.getToolName(),viewportId:r.viewport.id};for(let d=0;d<l.length;d++){const h=l[d],{annotationUID:p,data:g}=h,{points:m,activeHandleIndex:y}=g.handles;u.annotationUID=p;const{color:v,lineWidth:x,lineDash:w,shadow:S}=this.getAnnotationStyle({annotation:h,styleSpecifier:u}),T=m.map(G=>o.worldToCanvas(G));if(!g.cachedStats[c]||g.cachedStats[c].unit==null?(g.cachedStats[c]={length:null,unit:null},this._calculateCachedStats(h,f,r)):h.invalidated&&this._throttledCalculateCachedStats(h,f,r),!o.getRenderingEngine())return console.warn("Rendering Engine has been destroyed"),a;let _;if(!xo(p))continue;!yo(p)&&!this.editData&&y!==null&&(_=[T[y]]),_&&bo(i,p,"0",T,{color:v,lineDash:w,lineWidth:x});const D=`${p}-line`;if(Va(i,p,"1",T[0],T[1],{color:v,width:x,lineDash:w,shadow:S},D),a=!0,!o.getRenderingEngine())return console.warn("Rendering Engine has been destroyed"),a;const R=this.getLinkedTextBoxStyle(u,h);if(!R.visibility){g.handles.textBox={hasMoved:!1,worldPosition:[0,0,0],worldBoundingBox:{topLeft:[0,0,0],topRight:[0,0,0],bottomLeft:[0,0,0],bottomRight:[0,0,0]}};continue}const O=this.configuration.getTextLines(g,c);if(!g.handles.textBox.hasMoved){const G=Iu(T);g.handles.textBox.worldPosition=o.canvasToWorld(G)}const P=o.worldToCanvas(g.handles.textBox.worldPosition),A=cl(i,p,"1",O,P,T,{},R),{x:B,y:V,width:$,height:U}=A;g.handles.textBox.worldBoundingBox={topLeft:o.canvasToWorld([B,V]),topRight:o.canvasToWorld([B+$,V]),bottomLeft:o.canvasToWorld([B,V+U]),bottomRight:o.canvasToWorld([B+$,V+U])}}return a},this._throttledCalculateCachedStats=Wl(this._calculateCachedStats,100,{trailing:!0})}handleSelectedCallback(e,n,r){const i=e.detail,{element:a}=i,{data:o}=n;n.highlighted=!0;let s=!1,l;r.worldPosition?s=!0:l=o.handles.points.findIndex(f=>f===r);const c=fn(a,this.getToolName());this.editData={annotation:n,viewportIdsToRender:c,handleIndex:l,movingTextBox:s},this._activateModify(a),Rn(a),at(c),e.preventDefault()}_calculateLength(e,n){const r=e[0]-n[0],i=e[1]-n[1],a=e[2]-n[2];return Math.sqrt(r*r+i*i+a*a)}_calculateCachedStats(e,n,r){const i=e.data,{element:a}=r.viewport,o=i.handles.points[0],s=i.handles.points[1],{cachedStats:l}=i,c=Object.keys(l);for(let u=0;u<c.length;u++){const d=c[u],h=this.getTargetImageData(d);if(!h)continue;const{imageData:p,dimensions:g}=h,m=hB(p,o),y=hB(p,s),v=[m,y],{scale:x,unit:w}=Cc(h,v),S=this._calculateLength(o,s)/x;this._isInsideVolume(m,y,g)?this.isHandleOutsideImage=!1:this.isHandleOutsideImage=!0,l[d]={length:S,unit:w}}const f=e.invalidated;return e.invalidated=!1,f&&Un(e,a,xn.StatsUpdated),l}_isInsideVolume(e,n,r){return Ta(e,r)&&Ta(n,r)}};Rg.toolName="Length",Rg.hydrate=(e,n,r)=>{const i=xr(e);if(!i)return;const{FrameOfReferenceUID:a,referencedImageId:o,viewPlaneNormal:s,instance:l,viewport:c}=Rg.hydrateBase(Rg,i,n,r),{toolInstance:f,...u}=r||{},d={annotationUID:r?.annotationUID||cr(),data:{handles:{points:n}},highlighted:!1,autoGenerated:!1,invalidated:!1,isLocked:!1,isVisible:!0,metadata:{toolName:l.getToolName(),viewPlaneNormal:s,FrameOfReferenceUID:a,referencedImageId:o,...u}};mr(d,c.element),at([c.id])};let mg=Rg;function pje(t,e){const n=t.cachedStats[e],{length:r,unit:i}=n;return r==null||isNaN(r)?void 0:[`${Vn(r)} ${i}`]}const{transformWorldToIndex:gje}=Yr,Rd=class Rd extends la{constructor(e={},n){super(e,la.mergeDefaultProps(Rd.probeDefaults,n)),this.addNewAnnotation=r=>{const i=r.detail,{currentPoints:a,element:o}=i,s=a.world,l=Xe(o),{viewport:c}=l;this.isDrawing=!0;const f=this.constructor.createAnnotationForViewport(c,{data:{handles:{points:[[...s]]}}});mr(f,o);const u=fn(o,this.getToolName());return this.editData={annotation:f,newAnnotation:!0,viewportIdsToRender:u},this._activateModify(o),Rn(o),r.preventDefault(),at(u),f},this._endCallback=r=>{const i=r.detail,{element:a}=i,{annotation:o,viewportIdsToRender:s,newAnnotation:l}=this.editData,{viewportId:c,renderingEngine:f}=Xe(a);this.eventDispatchDetail={viewportId:c,renderingEngineId:f.id},this._deactivateModify(a),qn(a),l&&this.createMemo(a,o,{newAnnotation:l}),this.editData=null,this.isDrawing=!1,this.doneEditMemo(),this.isHandleOutsideImage&&this.configuration.preventHandleOutsideImage&&_r(o.annotationUID),at(s),l&&Xr(o)},this._dragCallback=r=>{this.isDrawing=!0;const i=r.detail,{currentPoints:a,element:o}=i,s=a.world,{annotation:l,viewportIdsToRender:c,newAnnotation:f}=this.editData,{data:u}=l;this.createMemo(o,l,{newAnnotation:f}),u.handles.points[0]=[...s],l.invalidated=!0,at(c)},this.cancel=r=>{if(this.isDrawing){this.isDrawing=!1,this._deactivateModify(r),qn(r);const{annotation:i,viewportIdsToRender:a,newAnnotation:o}=this.editData,{data:s}=i;return i.highlighted=!1,s.handles.activeHandleIndex=null,at(a),o&&Xr(i),this.editData=null,i.annotationUID}},this._activateModify=r=>{Dt.isInteractingWithTool=!0,r.addEventListener(ee.MOUSE_UP,this._endCallback),r.addEventListener(ee.MOUSE_DRAG,this._dragCallback),r.addEventListener(ee.MOUSE_CLICK,this._endCallback),r.addEventListener(ee.TOUCH_END,this._endCallback),r.addEventListener(ee.TOUCH_DRAG,this._dragCallback),r.addEventListener(ee.TOUCH_TAP,this._endCallback)},this._deactivateModify=r=>{Dt.isInteractingWithTool=!1,r.removeEventListener(ee.MOUSE_UP,this._endCallback),r.removeEventListener(ee.MOUSE_DRAG,this._dragCallback),r.removeEventListener(ee.MOUSE_CLICK,this._endCallback),r.removeEventListener(ee.TOUCH_END,this._endCallback),r.removeEventListener(ee.TOUCH_DRAG,this._dragCallback),r.removeEventListener(ee.TOUCH_TAP,this._endCallback)},this.renderAnnotation=(r,i)=>{let a=!1;const{viewport:o}=r,{element:s}=o;let l=Zi(this.getToolName(),s);if(!l?.length||(l=this.filterInteractableAnnotationsForElement(s,l),!l?.length))return a;const c=this.getTargetId(o),f=o.getRenderingEngine(),u={toolGroupId:this.toolGroupId,toolName:this.getToolName(),viewportId:r.viewport.id};for(let d=0;d<l.length;d++){const h=l[d],p=h.annotationUID,g=h.data,m=g.handles.points[0],y=o.worldToCanvas(m);u.annotationUID=p;const{color:v,lineWidth:x}=this.getAnnotationStyle({annotation:h,styleSpecifier:u});if(g.cachedStats||(g.cachedStats={}),!g.cachedStats[c]||g.cachedStats[c].value===null)g.cachedStats[c]={Modality:null,index:null,value:null},this._calculateCachedStats(h,f,r,xn.StatsUpdated);else if(h.invalidated&&(this._calculateCachedStats(h,f,r),o instanceof da)){const{referencedImageId:_}=h.metadata;for(const D in g.cachedStats)D.startsWith("imageId")&&f.getStackViewports().find(O=>{const P=Ci(_),N=O.hasImageURI(P),A=Ci(O.getCurrentImageId());return N&&A!==P})&&delete g.cachedStats[D]}if(!o.getRenderingEngine())return console.warn("Rendering Engine has been destroyed"),a;if(!xo(p))continue;bo(i,p,"0",[y],{color:v,lineWidth:x,handleRadius:this.configuration.handleRadius}),a=!0;const S=this.getLinkedTextBoxStyle(u,h);if(!S.visibility)continue;const T=this.configuration.getTextLines(g,c);if(T){const _=[y[0]+this.configuration.textCanvasOffset.x,y[1]+this.configuration.textCanvasOffset.y];sy(i,p,"0",T,[_[0],_[1]],S)}}return a}}isPointNearTool(e,n,r,i){const a=Xe(e),{viewport:o}=a,{data:s}=n,l=s.handles.points[0],c=o.worldToCanvas(l);return ii(r,c)<i}toolSelectedCallback(){}getHandleNearImagePoint(e,n,r,i){const a=Xe(e),{viewport:o}=a,{data:s}=n,l=s.handles.points[0],c=o.worldToCanvas(l);if(ii(r,c)<i===!0)return l}handleSelectedCallback(e,n){const r=e.detail,{element:i}=r;n.highlighted=!0;const a=fn(i,this.getToolName());this.editData={annotation:n,viewportIdsToRender:a},this._activateModify(i),Rn(i),at(a),e.preventDefault()}_calculateCachedStats(e,n,r,i=xn.StatsUpdated){const a=e.data,{renderingEngineId:o,viewport:s}=r,{element:l}=s,c=a.handles.points[0],{cachedStats:f}=a,u=Object.keys(f);for(let h=0;h<u.length;h++){const p=u[h],g={isPreScaled:r1(s,p),isSuvScaled:this.isSuvScaled(s,p,e.metadata.referencedImageId)},m=this.getTargetImageData(p);if(!m)continue;const{dimensions:y,imageData:v,metadata:x,voxelManager:w}=m,S=x.Modality;let T=gje(v,c);if(T=pwe(T,T),Ta(T,y)){this.isHandleOutsideImage=!1;let _=w.getAtIJKPoint(T);if(p.startsWith("imageId:")){const I=p.split("imageId:")[1],R=Ci(I),P=E3(R)[0];T[2]=P.getCurrentImageIdIndex()}let D;if(S==="US"){const I=f9(m,[T]),R=I.values.every(O=>O!==null);_=R?I.values:_,D=R?I.units:"raw"}else D=np(S,e.metadata.referencedImageId,g);f[p]={index:T,value:_,Modality:S,modalityUnit:D},e.invalidated=!0}else this.isHandleOutsideImage=!0,f[p]={index:T,Modality:S}}const d=e.invalidated;return e.invalidated=!1,d&&Un(e,l,i),f}};Rd.toolName="Probe",Rd.probeDefaults={supportedInteractionTypes:["Mouse","Touch"],configuration:{shadow:!0,preventHandleOutsideImage:!1,getTextLines:mje,handleRadius:"6",textCanvasOffset:{x:6,y:-6}}},Rd.hydrate=(e,n,r)=>{const i=xr(e);if(!i)return;const{FrameOfReferenceUID:a,referencedImageId:o,viewPlaneNormal:s,viewUp:l,instance:c,viewport:f}=Rd.hydrateBase(Rd,i,n,r),{toolInstance:u,...d}=r||{},h={annotationUID:r?.annotationUID||cr(),data:{handles:{points:n}},highlighted:!1,autoGenerated:!1,invalidated:!1,isLocked:!1,isVisible:!0,metadata:{toolName:c.getToolName(),viewPlaneNormal:s,FrameOfReferenceUID:a,referencedImageId:o,...d}};mr(h,f.element),at([f.id])};let vg=Rd;function mje(t,e){const n=t.cachedStats[e],{index:r,value:i,modalityUnit:a}=n;if(i===void 0||!r)return;const o=[];if(o.push(`(${r[0]}, ${r[1]}, ${r[2]})`),i instanceof Array&&a instanceof Array)for(let s=0;s<i.length;s++)o.push(`${Vn(i[s])} ${a[s]}`);else o.push(`${Vn(i)} ${a}`);return o}const{transformWorldToIndex:pB}=Yr,Pg=class Pg extends la{constructor(e={},n={supportedInteractionTypes:["Mouse","Touch"],configuration:{shadow:!0,preventHandleOutsideImage:!1,storePointData:!1,centerPointRadius:0,calculateStats:!0,getTextLines:vje,statsCalculator:f0}}){super(e,n),this.isHandleOutsideImage=!1,this.addNewAnnotation=r=>{const i=r.detail,{currentPoints:a,element:o}=i,s=a.world;a.canvas;const l=Xe(o),{viewport:c,renderingEngine:f}=l;this.isDrawing=!0;const u=c.getCamera(),{viewPlaneNormal:d,viewUp:h}=u,p=this.getReferencedImageId(c,s,d,h),g=c.getFrameOfReferenceUID(),m={highlighted:!0,invalidated:!0,metadata:{toolName:this.getToolName(),viewPlaneNormal:[...d],viewUp:[...h],FrameOfReferenceUID:g,referencedImageId:p,...c.getViewReference({points:[s]})},data:{label:"",handles:{textBox:{hasMoved:!1,worldPosition:[0,0,0],worldBoundingBox:{topLeft:[0,0,0],topRight:[0,0,0],bottomLeft:[0,0,0],bottomRight:[0,0,0]}},points:[[...s],[...s],[...s],[...s]],activeHandleIndex:null},cachedStats:{},initialRotation:c.getRotation()}};mr(m,o);const y=fn(o,this.getToolName());return this.editData={annotation:m,viewportIdsToRender:y,centerWorld:s,newAnnotation:!0,hasMoved:!1},this._activateDraw(o),Rn(o),r.preventDefault(),at(y),m},this.isPointNearTool=(r,i,a,o)=>{const s=Xe(r),{viewport:l}=s,{data:c}=i,{points:f}=c.handles,u=f.map(D=>l.worldToCanvas(D)),[d,h,p,g]=u,m=Math.hypot(p[0]-g[0],p[1]-g[1]),y=Math.hypot(h[0]-d[0],h[1]-d[1]),v=Math.atan2(p[1]-g[1],p[0]-g[0]),x=[(p[0]+g[0])/2,(h[1]+d[1])/2],w={center:x,xRadius:(m-o)/2,yRadius:(y-o)/2,angle:v},S={center:x,xRadius:(m+o)/2,yRadius:(y+o)/2,angle:v},T=this._pointInEllipseCanvas(w,a);return!!(this._pointInEllipseCanvas(S,a)&&!T)},this.toolSelectedCallback=(r,i)=>{const a=r.detail,{element:o}=a;i.highlighted=!0;const s=fn(o,this.getToolName());this.editData={annotation:i,viewportIdsToRender:s,movingTextBox:!1},Rn(o),this._activateModify(o);const l=Xe(o),{renderingEngine:c}=l;at(s),r.preventDefault()},this.handleSelectedCallback=(r,i,a)=>{const o=r.detail,{element:s}=o,{data:l}=i;i.highlighted=!0;let c=!1,f,u,d,h,p,g;if(a.worldPosition)c=!0;else{const{points:y}=l.handles,{viewport:v}=Xe(s),{worldToCanvas:x,canvasToWorld:w}=v;f=y.findIndex(T=>T===a);const S=y.map(x);g=S[f],h=Math.abs(S[2][0]-S[3][0]),p=Math.abs(S[0][1]-S[1][1]),u=[(S[2][0]+S[3][0])/2,(S[0][1]+S[1][1])/2],d=w(u)}const m=fn(s,this.getToolName());this.editData={annotation:i,viewportIdsToRender:m,handleIndex:f,canvasWidth:h,canvasHeight:p,centerWorld:d,originalHandleCanvas:g,movingTextBox:c},this._activateModify(s),Rn(s),at(m),r.preventDefault()},this._endCallback=r=>{const i=r.detail,{element:a}=i,{annotation:o,viewportIdsToRender:s,newAnnotation:l,hasMoved:c}=this.editData,{data:f}=o;l&&!c||(this.doneEditMemo(),o.highlighted=!1,f.handles.activeHandleIndex=null,this._deactivateModify(a),this._deactivateDraw(a),qn(a),this.editData=null,this.isDrawing=!1,this.isHandleOutsideImage&&this.configuration.preventHandleOutsideImage&&_r(o.annotationUID),at(s),l&&Xr(o))},this._dragDrawCallback=r=>{this.isDrawing=!0;const i=r.detail,{element:a}=i,{currentPoints:o}=i,s=o.canvas,l=Xe(a),{viewport:c}=l,{canvasToWorld:f}=c,{annotation:u,viewportIdsToRender:d,centerWorld:h,newAnnotation:p}=this.editData;this.createMemo(a,u,{newAnnotation:p});const g=c.worldToCanvas(h),{data:m}=u,y=Math.abs(s[0]-g[0]),v=Math.abs(s[1]-g[1]),x=[g[0],g[1]-v],w=[g[0],g[1]+v],S=[g[0]-y,g[1]],T=[g[0]+y,g[1]];m.handles.points=[f(x),f(w),f(S),f(T)],u.invalidated=!0,this.editData.hasMoved=!0,at(d),Un(u,a,xn.HandlesUpdated)},this._dragModifyCallback=r=>{this.isDrawing=!0;const i=r.detail,{element:a}=i,{annotation:o,viewportIdsToRender:s,handleIndex:l,movingTextBox:c,newAnnotation:f}=this.editData;this.createMemo(a,o,{newAnnotation:f});const{data:u}=o;if(c){const{deltaPoints:p}=i,g=p.world,{textBox:m}=u.handles,{worldPosition:y}=m;y[0]+=g[0],y[1]+=g[1],y[2]+=g[2],m.hasMoved=!0}else if(l===void 0){const{deltaPoints:p}=i,g=p.world;u.handles.points.forEach(y=>{y[0]+=g[0],y[1]+=g[1],y[2]+=g[2]}),o.invalidated=!0}else this._dragHandle(r),o.invalidated=!0;const d=Xe(a),{renderingEngine:h}=d;at(s),o.invalidated&&Un(o,a,xn.HandlesUpdated)},this._dragHandle=r=>{const i=r.detail,{element:a}=i,{viewport:o}=Xe(a),{canvasToWorld:s,worldToCanvas:l}=o,{annotation:c,canvasWidth:f,canvasHeight:u,handleIndex:d,centerWorld:h,originalHandleCanvas:p}=this.editData,g=o.worldToCanvas(h),{data:m}=c,{points:y}=m.handles,{currentPoints:v}=i,x=v.canvas;if(d===0||d===1){const w=Math.abs(x[1]-g[1]),S=[g[0],g[1]-w],T=[g[0],g[1]+w];y[0]=s(S),y[1]=s(T);const _=x[0]-p[0],D=f/2+_,I=[g[0]-D,g[1]],R=[g[0]+D,g[1]];y[2]=s(I),y[3]=s(R)}else{const w=Math.abs(x[0]-g[0]),S=[g[0]-w,g[1]],T=[g[0]+w,g[1]];y[2]=s(S),y[3]=s(T);const _=x[1]-p[1],D=u/2+_,I=[g[0],g[1]-D],R=[g[0],g[1]+D];y[0]=s(I),y[1]=s(R)}},this.cancel=r=>{if(this.isDrawing){this.isDrawing=!1,this._deactivateDraw(r),this._deactivateModify(r),qn(r);const{annotation:i,viewportIdsToRender:a,newAnnotation:o}=this.editData,{data:s}=i;return i.highlighted=!1,s.handles.activeHandleIndex=null,at(a),o&&Xr(i),this.editData=null,i.annotationUID}},this._activateModify=r=>{Dt.isInteractingWithTool=!0,r.addEventListener(ee.MOUSE_UP,this._endCallback),r.addEventListener(ee.MOUSE_DRAG,this._dragModifyCallback),r.addEventListener(ee.MOUSE_CLICK,this._endCallback),r.addEventListener(ee.TOUCH_END,this._endCallback),r.addEventListener(ee.TOUCH_DRAG,this._dragModifyCallback),r.addEventListener(ee.TOUCH_TAP,this._endCallback)},this._deactivateModify=r=>{Dt.isInteractingWithTool=!1,r.removeEventListener(ee.MOUSE_UP,this._endCallback),r.removeEventListener(ee.MOUSE_DRAG,this._dragModifyCallback),r.removeEventListener(ee.MOUSE_CLICK,this._endCallback),r.removeEventListener(ee.TOUCH_END,this._endCallback),r.removeEventListener(ee.TOUCH_DRAG,this._dragModifyCallback),r.removeEventListener(ee.TOUCH_TAP,this._endCallback)},this._activateDraw=r=>{Dt.isInteractingWithTool=!0,r.addEventListener(ee.MOUSE_UP,this._endCallback),r.addEventListener(ee.MOUSE_DRAG,this._dragDrawCallback),r.addEventListener(ee.MOUSE_MOVE,this._dragDrawCallback),r.addEventListener(ee.MOUSE_CLICK,this._endCallback),r.addEventListener(ee.TOUCH_END,this._endCallback),r.addEventListener(ee.TOUCH_DRAG,this._dragDrawCallback),r.addEventListener(ee.TOUCH_TAP,this._endCallback)},this._deactivateDraw=r=>{Dt.isInteractingWithTool=!1,r.removeEventListener(ee.MOUSE_UP,this._endCallback),r.removeEventListener(ee.MOUSE_DRAG,this._dragDrawCallback),r.removeEventListener(ee.MOUSE_MOVE,this._dragDrawCallback),r.removeEventListener(ee.MOUSE_CLICK,this._endCallback),r.removeEventListener(ee.TOUCH_END,this._endCallback),r.removeEventListener(ee.TOUCH_DRAG,this._dragDrawCallback),r.removeEventListener(ee.TOUCH_TAP,this._endCallback)},this.renderAnnotation=(r,i)=>{let a=!1;const{viewport:o}=r,{element:s}=o;let l=Zi(this.getToolName(),s);if(!l?.length||(l=this.filterInteractableAnnotationsForElement(s,l),!l?.length))return a;const c=this.getTargetId(o),f=o.getRenderingEngine(),u={toolGroupId:this.toolGroupId,toolName:this.getToolName(),viewportId:r.viewport.id};for(let d=0;d<l.length;d++){const h=l[d],{annotationUID:p,data:g}=h,{handles:m}=g,{points:y,activeHandleIndex:v}=m;u.annotationUID=p;const{color:x,lineWidth:w,lineDash:S}=this.getAnnotationStyle({annotation:h,styleSpecifier:u}),T=y.map(Q=>o.worldToCanvas(Q)),_=SU(T),{centerPointRadius:D}=this.configuration;if(!g.cachedStats[c]||g.cachedStats[c].areaUnit==null)g.cachedStats[c]={Modality:null,area:null,max:null,mean:null,stdDev:null,areaUnit:null},this._calculateCachedStats(h,o,f);else if(h.invalidated&&(this._throttledCalculateCachedStats(h,o,f,r),o instanceof da)){const{referencedImageId:Q}=h.metadata;for(const ne in g.cachedStats)ne.startsWith("imageId")&&f.getStackViewports().find(Ce=>{const we=Ci(Q),Ae=Ce.hasImageURI(we),Me=Ci(Ce.getCurrentImageId());return Ae&&Me!==we})&&delete g.cachedStats[ne]}if(!o.getRenderingEngine())return console.warn("Rendering Engine has been destroyed"),a;let I;if(!xo(p))continue;!yo(p)&&!this.editData&&v!==null&&(I=[T[v]]),I&&bo(i,p,"0",I,{color:x});const R=`${p}-ellipse`,O="0";if(hVe(i,p,O,T,{color:x,lineDash:S,lineWidth:w},R),D>0&&Math.min(Math.abs(_[0][0]-_[1][0])/2,Math.abs(_[0][1]-_[1][1])/2)>3*D){const ne=this._getCanvasEllipseCenter(T);h0(i,p,`${O}-center`,ne,D,{color:x,lineDash:S,lineWidth:w})}a=!0;const P=this.getLinkedTextBoxStyle(u,h);if(!P.visibility){g.handles.textBox={hasMoved:!1,worldPosition:[0,0,0],worldBoundingBox:{topLeft:[0,0,0],topRight:[0,0,0],bottomLeft:[0,0,0],bottomRight:[0,0,0]}};continue}const N=this.configuration.getTextLines(g,c);if(!N||N.length===0)continue;let A;g.handles.textBox.hasMoved||(A=Iu(_),g.handles.textBox.worldPosition=o.canvasToWorld(A));const B=o.worldToCanvas(g.handles.textBox.worldPosition),$=cl(i,p,"1",N,B,T,{},P),{x:U,y:G,width:F,height:J}=$;g.handles.textBox.worldBoundingBox={topLeft:o.canvasToWorld([U,G]),topRight:o.canvasToWorld([U+F,G]),bottomLeft:o.canvasToWorld([U,G+J]),bottomRight:o.canvasToWorld([U+F,G+J])}}return a},this._calculateCachedStats=(r,i,a)=>{if(!this.configuration.calculateStats)return;const o=r.data,{element:s}=i,{points:l}=o.handles,c=l.map(S=>i.worldToCanvas(S)),{viewPlaneNormal:f,viewUp:u}=i.getCamera(),[d,h]=SU(c),p=i.canvasToWorld(d),g=i.canvasToWorld(h),{cachedStats:m}=o,y=Object.keys(m),v=p,x=g;for(let S=0;S<y.length;S++){const T=y[S],_=this.getTargetImageData(T);if(!_)continue;const{dimensions:D,imageData:I,metadata:R,voxelManager:O}=_,P=pB(I,v);P[0]=Math.floor(P[0]),P[1]=Math.floor(P[1]),P[2]=Math.floor(P[2]);const N=pB(I,x);N[0]=Math.floor(N[0]),N[1]=Math.floor(N[1]),N[2]=Math.floor(N[2]),this.isHandleOutsideImage=!this._isInsideVolume(P,N,D);const A=Math.min(P[0],N[0]),B=Math.max(P[0],N[0]),V=Math.min(P[1],N[1]),$=Math.max(P[1],N[1]),U=Math.min(P[2],N[2]),G=Math.max(P[2],N[2]),F=[[A,B],[V,$],[U,G]],Q={center:[(p[0]+g[0])/2,(p[1]+g[1])/2,(p[2]+g[2])/2],xRadius:Math.abs(p[0]-g[0])/2,yRadius:Math.abs(p[1]-g[1])/2,zRadius:Math.abs(p[2]-g[2])/2},{worldWidth:ne,worldHeight:ye}=Qte(f,u,v,x),ve=ne===0&&ye===0,Ce=[P,N],{scale:we,areaUnit:Ae}=Cc(_,Ce),Me=Math.abs(Math.PI*(ne/2)*(ye/2))/we/we,q={isPreScaled:r1(i,T),isSuvScaled:this.isSuvScaled(i,T,r.metadata.referencedImageId)},k=np(R.Modality,r.metadata.referencedImageId,q);let Y;O&&O.forEach(this.configuration.statsCalculator.statsCallback,{boundsIJK:F,imageData:I,isInObject:re=>Lte(Q,re,{fast:!0}),returnPoints:this.configuration.storePointData});const X=this.configuration.statsCalculator.getStatistics();m[T]={Modality:R.Modality,area:Me,mean:X.mean?.value,max:X.max?.value,min:X.min?.value,stdDev:X.stdDev?.value,statsArray:X.array,pointsInShape:Y,isEmptyArea:ve,areaUnit:Ae,modalityUnit:k}}const w=r.invalidated;return r.invalidated=!1,w&&Un(r,s,xn.StatsUpdated),m},this._isInsideVolume=(r,i,a)=>Ta(r,a)&&Ta(i,a),this._throttledCalculateCachedStats=Wl(this._calculateCachedStats,100,{trailing:!0})}_pointInEllipseCanvas(e,n){const{xRadius:r,yRadius:i,center:a,angle:o}=e,s=vwe(Kn(),n,a,-o);if(r<=0||i<=0)return!1;const l=[s[0]-a[0],s[1]-a[1]];return l[0]*l[0]/(r*r)+l[1]*l[1]/(i*i)<=1}_getCanvasEllipseCenter(e){const[n,r,i,a]=e,o=[i[0],r[1]],s=[a[0],n[1]];return[(o[0]+s[0])/2,(o[1]+s[1])/2]}};Pg.toolName="EllipticalROI",Pg.hydrate=(e,n,r)=>{const i=xr(e);if(!i)return;const{FrameOfReferenceUID:a,referencedImageId:o,viewPlaneNormal:s,instance:l,viewport:c}=Pg.hydrateBase(Pg,i,n,r),{toolInstance:f,...u}=r||{},d={annotationUID:r?.annotationUID||cr(),data:{handles:{points:n,activeHandleIndex:null},label:"",cachedStats:{}},highlighted:!1,autoGenerated:!1,invalidated:!1,isLocked:!1,isVisible:!0,metadata:{toolName:l.getToolName(),viewPlaneNormal:s,FrameOfReferenceUID:a,referencedImageId:o,...u}};mr(d,c.element),at([c.id])};let yg=Pg;function vje(t,e){const n=t.cachedStats[e],{area:r,mean:i,stdDev:a,max:o,isEmptyArea:s,areaUnit:l,modalityUnit:c,min:f}=n,u=[];if(hi(r)){const d=s?"Area: Oblique not supported":`Area: ${Vn(r)} ${l}`;u.push(d)}return hi(i)&&u.push(`Mean: ${Vn(i)} ${c}`),hi(o)&&u.push(`Max: ${Vn(o)} ${c}`),hi(f)&&u.push(`Min: ${Vn(f)} ${c}`),hi(a)&&u.push(`Std Dev: ${Vn(a)} ${c}`),u}const{transformWorldToIndex:gB}=Yr,Ag=class Ag extends la{constructor(e={},n={supportedInteractionTypes:["Mouse","Touch"],configuration:{shadow:!0,preventHandleOutsideImage:!1,storePointData:!1,centerPointRadius:0,calculateStats:!0,getTextLines:yje,statsCalculator:f0,simplified:!0}}){super(e,n),this.isHandleOutsideImage=!1,this.addNewAnnotation=r=>{const i=r.detail,{currentPoints:a,element:o}=i,s=a.world,l=Xe(o),{viewport:c}=l;this.isDrawing=!0;const f=c.getCamera(),{viewPlaneNormal:u,viewUp:d}=f,h=this.getReferencedImageId(c,s,u,d),p=c.getFrameOfReferenceUID();let g;this.configuration.simplified?g=[[...s],[...s]]:g=[[...s],[...s],[...s],[...s],[...s]];const m={highlighted:!0,invalidated:!0,metadata:{toolName:this.getToolName(),viewPlaneNormal:[...u],viewUp:[...d],FrameOfReferenceUID:p,referencedImageId:h,...c.getViewReference({points:[s]})},data:{label:"",handles:{textBox:{hasMoved:!1,worldPosition:[0,0,0],worldBoundingBox:{topLeft:[0,0,0],topRight:[0,0,0],bottomLeft:[0,0,0],bottomRight:[0,0,0]}},points:g,activeHandleIndex:null},cachedStats:{}}};mr(m,o);const y=fn(o,this.getToolName());return this.editData={annotation:m,viewportIdsToRender:y,newAnnotation:!0,hasMoved:!1},this._activateDraw(o),Rn(o),r.preventDefault(),at(y),m},this.isPointNearTool=(r,i,a,o)=>{const s=Xe(r),{viewport:l}=s,{points:c}=i.data.handles,f=c.map(p=>l.worldToCanvas(p)),u=f[0],d=f2([u,f[1]]),h=f2([u,a]);return Math.abs(h-d)<o/2},this.toolSelectedCallback=(r,i)=>{const a=r.detail,{element:o}=a;i.highlighted=!0;const s=fn(o,this.getToolName());this.editData={annotation:i,viewportIdsToRender:s,movingTextBox:!1},Rn(o),this._activateModify(o),at(s),r.preventDefault()},this.handleSelectedCallback=(r,i,a)=>{const o=r.detail,{element:s}=o,{data:l}=i;i.highlighted=!0;let c=!1,f;if(a.worldPosition)c=!0;else{const{points:d}=l.handles;f=d.findIndex(h=>h===a)}const u=fn(s,this.getToolName());this.editData={annotation:i,viewportIdsToRender:u,handleIndex:f,movingTextBox:c},this._activateModify(s),Rn(s),at(u),r.preventDefault()},this._endCallback=r=>{const i=r.detail,{element:a}=i,{annotation:o,viewportIdsToRender:s,newAnnotation:l,hasMoved:c}=this.editData,{data:f}=o;l&&!c||(this.doneEditMemo(),o.highlighted=!1,f.handles.activeHandleIndex=null,this._deactivateModify(a),this._deactivateDraw(a),qn(a),this.editData=null,this.isDrawing=!1,this.isHandleOutsideImage&&this.configuration.preventHandleOutsideImage&&_r(o.annotationUID),at(s),l&&Xr(o))},this._dragDrawCallback=r=>{this.isDrawing=!0;const i=r.detail,{element:a,currentPoints:o}=i,{world:s,canvas:l}=o,c=Xe(a),{viewport:f}=c,{canvasToWorld:u}=f,{annotation:d,viewportIdsToRender:h,newAnnotation:p}=this.editData;this.createMemo(a,d,{newAnnotation:p});const{data:g}=d,m=g.handles.points[0],y=f.worldToCanvas(m);if(this.configuration.simplified)g.handles.points[1]=s;else{const v=ii(y,l);g.handles.points[0]=[...m],g.handles.points[1]=u([y[0],y[1]-v]),g.handles.points[2]=u([y[0],y[1]+v]),g.handles.points[3]=u([y[0]-v,y[1]]),g.handles.points[4]=u([y[0]+v,y[1]])}d.invalidated=!0,this.editData.hasMoved=!0,at(h),Un(d,a,xn.HandlesUpdated)},this._dragModifyCallback=r=>{this.isDrawing=!0;const i=r.detail,{element:a}=i,{annotation:o,viewportIdsToRender:s,handleIndex:l,movingTextBox:c,newAnnotation:f}=this.editData;this.createMemo(a,o,{newAnnotation:f});const{data:u}=o;if(c){const{deltaPoints:d}=i,h=d.world,{textBox:p}=u.handles,{worldPosition:g}=p;g[0]+=h[0],g[1]+=h[1],g[2]+=h[2],p.hasMoved=!0}else if(l===void 0){const{deltaPoints:d}=i,h=d.world;u.handles.points.forEach(g=>{g[0]+=h[0],g[1]+=h[1],g[2]+=h[2]}),o.invalidated=!0}else this._dragHandle(r),o.invalidated=!0;at(s),o.invalidated&&Un(o,a,xn.HandlesUpdated)},this._dragHandle=r=>{const i=r.detail,{element:a}=i,o=Xe(a),{canvasToWorld:s,worldToCanvas:l}=o.viewport,{annotation:c,handleIndex:f}=this.editData,{data:u}=c,{points:d}=u.handles,{currentPoints:h,deltaPoints:p}=i;if(f===0){const g=p.world;d.forEach(m=>{Ul(m,m,g)})}else{const g=d[0],m=l(g),y=h.canvas,v=ii(m,y);d[1]=s([m[0],m[1]-v]),d[2]=s([m[0],m[1]+v]),d[3]=s([m[0]-v,m[1]]),d[4]=s([m[0]+v,m[1]])}c.invalidated=!0},this.cancel=r=>{if(this.isDrawing){this.isDrawing=!1,this._deactivateDraw(r),this._deactivateModify(r),qn(r);const{annotation:i,viewportIdsToRender:a,newAnnotation:o}=this.editData;return i.highlighted=!1,i.data.handles.activeHandleIndex=null,at(a),o&&Xr(i),this.editData=null,i.annotationUID}},this._activateModify=r=>{Dt.isInteractingWithTool=!0,r.addEventListener(ee.MOUSE_UP,this._endCallback),r.addEventListener(ee.MOUSE_DRAG,this._dragModifyCallback),r.addEventListener(ee.MOUSE_CLICK,this._endCallback),r.addEventListener(ee.TOUCH_END,this._endCallback),r.addEventListener(ee.TOUCH_DRAG,this._dragModifyCallback),r.addEventListener(ee.TOUCH_TAP,this._endCallback)},this._deactivateModify=r=>{Dt.isInteractingWithTool=!1,r.removeEventListener(ee.MOUSE_UP,this._endCallback),r.removeEventListener(ee.MOUSE_DRAG,this._dragModifyCallback),r.removeEventListener(ee.MOUSE_CLICK,this._endCallback),r.removeEventListener(ee.TOUCH_END,this._endCallback),r.removeEventListener(ee.TOUCH_DRAG,this._dragModifyCallback),r.removeEventListener(ee.TOUCH_TAP,this._endCallback)},this._activateDraw=r=>{Dt.isInteractingWithTool=!0,r.addEventListener(ee.MOUSE_UP,this._endCallback),r.addEventListener(ee.MOUSE_DRAG,this._dragDrawCallback),r.addEventListener(ee.MOUSE_MOVE,this._dragDrawCallback),r.addEventListener(ee.MOUSE_CLICK,this._endCallback),r.addEventListener(ee.TOUCH_END,this._endCallback),r.addEventListener(ee.TOUCH_DRAG,this._dragDrawCallback),r.addEventListener(ee.TOUCH_TAP,this._endCallback)},this._deactivateDraw=r=>{Dt.isInteractingWithTool=!1,r.removeEventListener(ee.MOUSE_UP,this._endCallback),r.removeEventListener(ee.MOUSE_DRAG,this._dragDrawCallback),r.removeEventListener(ee.MOUSE_MOVE,this._dragDrawCallback),r.removeEventListener(ee.MOUSE_CLICK,this._endCallback),r.removeEventListener(ee.TOUCH_END,this._endCallback),r.removeEventListener(ee.TOUCH_DRAG,this._dragDrawCallback),r.removeEventListener(ee.TOUCH_TAP,this._endCallback)},this.renderAnnotation=(r,i)=>{let a=!1;const{viewport:o}=r,{element:s}=o;let l=Zi(this.getToolName(),s);if(!l?.length||(l=this.filterInteractableAnnotationsForElement(s,l),!l?.length))return a;const c=this.getTargetId(o),f=o.getRenderingEngine(),u={toolGroupId:this.toolGroupId,toolName:this.getToolName(),viewportId:r.viewport.id};for(let d=0;d<l.length;d++){const h=l[d],{annotationUID:p,data:g}=h,{handles:m}=g,{points:y,activeHandleIndex:v}=m;u.annotationUID=p;const{color:x,lineWidth:w,lineDash:S}=this.getAnnotationStyle({annotation:h,styleSpecifier:u}),T=y.map(A=>o.worldToCanvas(A)),_=T[0],D=f2([_,T[1]]),I=CU([_,T[1]]),{centerPointRadius:R}=this.configuration;if(!g.cachedStats[c]||g.cachedStats[c].areaUnit==null)g.cachedStats[c]={Modality:null,area:null,max:null,mean:null,stdDev:null,areaUnit:null,radius:null,radiusUnit:null,perimeter:null},this._calculateCachedStats(h,o,f,r);else if(h.invalidated&&(this._throttledCalculateCachedStats(h,o,f,r),o instanceof da)){const{referencedImageId:A}=h.metadata;for(const B in g.cachedStats)B.startsWith("imageId")&&f.getStackViewports().find(U=>{const G=Ci(A),F=U.hasImageURI(G),J=Ci(U.getCurrentImageId());return F&&J!==G})&&delete g.cachedStats[B]}if(!o.getRenderingEngine())return console.warn("Rendering Engine has been destroyed"),a;let O;if(!xo(p))continue;!yo(p)&&!this.editData&&v!==null&&(this.configuration.simplified?O=[T[v]]:O=T),O&&bo(i,p,"0",O,{color:x});const P=`${p}-circle`,N="0";if(h0(i,p,N,_,D,{color:x,lineDash:S,lineWidth:w},P),R>0&&D>3*R&&h0(i,p,`${N}-center`,_,R,{color:x,lineDash:S,lineWidth:w}),a=!0,this.configuration.calculateStats){const A=this.getLinkedTextBoxStyle(u,h);if(!A.visibility){g.handles.textBox={hasMoved:!1,worldPosition:[0,0,0],worldBoundingBox:{topLeft:[0,0,0],topRight:[0,0,0],bottomLeft:[0,0,0],bottomRight:[0,0,0]}};continue}const B=this.configuration.getTextLines(g,c);if(!B||B.length===0)continue;let V;g.handles.textBox.hasMoved||(V=Iu(I),g.handles.textBox.worldPosition=o.canvasToWorld(V));const $=o.worldToCanvas(g.handles.textBox.worldPosition),G=cl(i,p,"1",B,$,[_,T[1]],{},A),{x:F,y:J,width:Q,height:ne}=G;g.handles.textBox.worldBoundingBox={topLeft:o.canvasToWorld([F,J]),topRight:o.canvasToWorld([F+Q,J]),bottomLeft:o.canvasToWorld([F,J+ne]),bottomRight:o.canvasToWorld([F+Q,J+ne])}}}return a},this._calculateCachedStats=(r,i,a,o)=>{if(!this.configuration.calculateStats)return;const s=r.data,{element:l}=i,c=r.invalidated,{points:f}=s.handles,u=f.map(D=>i.worldToCanvas(D)),d=u[0],h=u[1],{viewPlaneNormal:p,viewUp:g}=i.getCamera(),[m,y]=CU([d,h]),v=i.canvasToWorld(m),x=i.canvasToWorld(y),{cachedStats:w}=s,S=Object.keys(w),T=v,_=x;for(let D=0;D<S.length;D++){const I=S[D],R=this.getTargetImageData(I);if(!R)continue;const{dimensions:O,imageData:P,metadata:N,voxelManager:A}=R,B=gB(P,T);B[0]=Math.floor(B[0]),B[1]=Math.floor(B[1]),B[2]=Math.floor(B[2]);const V=gB(P,_);if(V[0]=Math.floor(V[0]),V[1]=Math.floor(V[1]),V[2]=Math.floor(V[2]),this._isInsideVolume(B,V,O)){const $=Math.min(B[0],V[0]),U=Math.max(B[0],V[0]),G=Math.min(B[1],V[1]),F=Math.max(B[1],V[1]),J=Math.min(B[2],V[2]),Q=Math.max(B[2],V[2]),ne=[[$,U],[G,F],[J,Q]],ye=f[0],ve=Math.abs(v[0]-x[0])/2,Ce=Math.abs(v[1]-x[1])/2,we=Math.abs(v[2]-x[2])/2,Ae={center:ye,xRadius:ve<Zg/2?0:ve,yRadius:Ce<Zg/2?0:Ce,zRadius:we<Zg/2?0:we},{worldWidth:Me,worldHeight:q}=Qte(p,g,T,_),k=Me===0&&q===0,Y=[B,V],{scale:X,unit:re,areaUnit:de}=Cc(R,Y),he=SFe(R),Ee=Math.abs(Math.PI*(Me/X/2)*(q/he/X/2)),Oe={isPreScaled:r1(i,I),isSuvScaled:this.isSuvScaled(i,I,r.metadata.referencedImageId)},Pe=np(N.Modality,r.metadata.referencedImageId,Oe);let Ne;A&&(Ne=A.forEach(this.configuration.statsCalculator.statsCallback,{isInObject:ae=>Lte(Ae,ae,{fast:!0}),boundsIJK:ne,imageData:P,returnPoints:this.configuration.storePointData}));const ie=this.configuration.statsCalculator.getStatistics();w[I]={Modality:N.Modality,area:Ee,mean:ie.mean?.value,max:ie.max?.value,min:ie.min?.value,pointsInShape:Ne,stdDev:ie.stdDev?.value,statsArray:ie.array,isEmptyArea:k,areaUnit:de,radius:Me/2/X,radiusUnit:re,perimeter:2*Math.PI*(Me/2)/X,modalityUnit:Pe}}else this.isHandleOutsideImage=!0,w[I]={Modality:N.Modality}}return r.invalidated=!1,c&&Un(r,l,xn.StatsUpdated),w},this._isInsideVolume=(r,i,a)=>Ta(r,a)&&Ta(i,a),this._throttledCalculateCachedStats=Wl(this._calculateCachedStats,100,{trailing:!0})}};Ag.toolName="CircleROI",Ag.hydrate=(e,n,r)=>{const i=xr(e);if(!i)return;const{FrameOfReferenceUID:a,referencedImageId:o,viewPlaneNormal:s,instance:l,viewport:c}=Ag.hydrateBase(Ag,i,n,r),{toolInstance:f,...u}=r||{},d={annotationUID:r?.annotationUID||cr(),data:{handles:{points:n,textBox:{hasMoved:!1,worldPosition:[0,0,0],worldBoundingBox:{topLeft:[0,0,0],topRight:[0,0,0],bottomLeft:[0,0,0],bottomRight:[0,0,0]}},activeHandleIndex:null},label:"",cachedStats:{}},highlighted:!1,autoGenerated:!1,invalidated:!1,isLocked:!1,isVisible:!0,metadata:{toolName:l.getToolName(),viewPlaneNormal:s,FrameOfReferenceUID:a,referencedImageId:o,...u}};mr(d,c.element),at([c.id])};let xg=Ag;function yje(t,e){const n=t.cachedStats[e],{radius:r,radiusUnit:i,area:a,mean:o,stdDev:s,max:l,min:c,isEmptyArea:f,areaUnit:u,modalityUnit:d}=n,h=[];if(hi(r)){const p=f?"Radius: Oblique not supported":`Radius: ${Vn(r)} ${i}`;h.push(p)}if(hi(a)){const p=f?"Area: Oblique not supported":`Area: ${Vn(a)} ${u}`;h.push(p)}return hi(o)&&h.push(`Mean: ${Vn(o)} ${d}`),hi(l)&&h.push(`Max: ${Vn(l)} ${d}`),hi(c)&&h.push(`Min: ${Vn(c)} ${d}`),hi(s)&&h.push(`Std Dev: ${Vn(s)} ${d}`),h}const mB=3,vB=10,xje={resolution:20,controlPointAdditionDistance:6,controlPointDeletionDistance:6,showControlPointsConnectors:!1,controlPointAdditionEnabled:!0,controlPointDeletionEnabled:!0};var hf;(function(t){t.Cardinal="CARDINAL",t.Linear="LINEAR",t.CatmullRom="CATMULLROM",t.BSpline="BSPLINE"})(hf||(hf={}));var h2;(function(t){t.AddControlPoint="addControlPoint",t.DeleteControlPoint="deleteControlPoint"})(h2||(h2={}));const bje=["CatmullRomSplineROI","LinearSplineROI","BSplineROI","CardinalSplineROI"],Pd=class Pd extends cy{constructor(e={},n={supportedInteractionTypes:["Mouse","Touch"],configuration:{preventHandleOutsideImage:!1,calculateStats:!0,simplifiedSpline:!1,getTextLines:wje,contourHoleAdditionModifierKey:La.Shift,decimate:{enabled:!1,epsilon:.1},spline:{configuration:{[hf.Cardinal]:{Class:q3,scale:.5},[hf.CatmullRom]:{Class:rje},[hf.Linear]:{Class:ije},[hf.BSpline]:{Class:nje,controlPointAdditionEnabled:!1,controlPointDeletionEnabled:!1,showControlPointsConnectors:!0}},type:hf.CatmullRom,drawPreviewEnabled:!0,enableTwoPointPreview:!1,lastControlPointDeletionKeys:["Backspace","Delete"]},actions:{[h2.AddControlPoint]:{method:"addControlPointCallback",bindings:[{mouseButton:wu.Primary,modifierKey:La.Shift}]},[h2.DeleteControlPoint]:{method:"deleteControlPointCallback",bindings:[{mouseButton:wu.Primary,modifierKey:La.Ctrl}]}}}}){super(e,n),this.splineToolNames=["CatmullRomSplineROI","LinearSplineROI","BSplineROI","CardinalSplineROI"],this.isHandleOutsideImage=!1,this.fireChangeOnUpdate=null,this.isPointNearTool=(r,i,a,o)=>{const{instance:s}=i.data.spline;return s.isPointNearCurve(a,o)},this.toolSelectedCallback=(r,i)=>{const a=r.detail,{element:o}=a;i.highlighted=!0;const s=fn(o,this.getToolName());this.editData={annotation:i,viewportIdsToRender:s,movingTextBox:!1},this._activateModify(o),at(s),r.preventDefault()},this.handleSelectedCallback=(r,i,a)=>{const o=r.detail,{element:s}=o,{data:l}=i;i.highlighted=!0;let c=!1,f;if(a.worldPosition)c=!0;else{const{points:d}=l.handles;f=d.findIndex(h=>h===a)}const u=fn(s,this.getToolName());this.editData={annotation:i,viewportIdsToRender:u,handleIndex:f,movingTextBox:c},this._activateModify(s),at(u),r.preventDefault()},this._endCallback=r=>{const i=r.detail,{element:a}=i,{annotation:o,viewportIdsToRender:s,newAnnotation:l,contourHoleProcessingEnabled:c}=this.editData,{data:f}=o;o.autoGenerated=!1,f.handles.activeHandleIndex=null,this._deactivateModify(a),this._deactivateDraw(a),qn(a);const u=Xe(a),d=this.getTargetImageData(this.getTargetId(u.viewport)),{imageData:h,dimensions:p}=d;this.isHandleOutsideImage=f.handles.points.map(m=>fo(h,m)).some(m=>!Ta(m,p)),this.isHandleOutsideImage&&this.configuration.preventHandleOutsideImage&&_r(o.annotationUID);const g=l?xn.Completed:xn.HandlesUpdated;this.fireChangeOnUpdate?(this.fireChangeOnUpdate.annotationUID=o.annotationUID,this.fireChangeOnUpdate.changeType=g):this.fireChangeOnUpdate={annotationUID:o.annotationUID,changeType:g,contourHoleProcessingEnabled:c},at(s),this.doneEditMemo(),this.editData=null,this.isDrawing=!1},this._keyDownCallback=r=>{const i=r.detail,{element:a}=i,o=i.key??"",{lastControlPointDeletionKeys:s}=this.configuration.spline;if(!s.includes(o))return;const{annotation:c}=this.editData,{data:f}=c;if(f.handles.points.length===mB){this.cancel(a);return}else{const u=f.handles.points.length-1;this._deleteControlPointByIndex(a,c,u)}r.preventDefault()},this._mouseMoveCallback=r=>{const{drawPreviewEnabled:i}=this.configuration.spline;if(!i)return;const{element:a}=r.detail,{renderingEngine:o}=Xe(a),s=fn(a,this.getToolName());this.editData.lastCanvasPoint=r.detail.currentPoints.canvas,at(s),r.preventDefault()},this._mouseDownCallback=r=>{const i=r.type===ee.MOUSE_DOUBLE_CLICK,{annotation:a,viewportIdsToRender:o}=this.editData,{data:s}=a;if(s.contour.closed)return;this.doneEditMemo();const l=r.detail,{currentPoints:c,element:f}=l,{canvas:u,world:d}=c;let h=s.handles.points.length>=2&&i,p=!0;if(s.handles.points.length&&this.createMemo(f,a,{newAnnotation:s.handles.points.length===1}),s.handles.points.length>=3){this.createMemo(f,a);const{instance:g}=s.spline;g.getClosestControlPointWithinDistance(u,vB)?.index===0&&(p=!1,h=!0)}p&&s.handles.points.push(d),s.contour.closed=s.contour.closed||h,a.invalidated=!0,at(o),s.contour.closed&&this._endCallback(r),r.preventDefault()},this._dragCallback=r=>{this.isDrawing=!0;const i=r.detail,{element:a}=i,{annotation:o,viewportIdsToRender:s,handleIndex:l,movingTextBox:c,newAnnotation:f}=this.editData,{data:u}=o;if(this.createMemo(a,o,{newAnnotation:f}),c){const{deltaPoints:p}=i,g=p.world,{textBox:m}=u.handles,{worldPosition:y}=m;y[0]+=g[0],y[1]+=g[1],y[2]+=g[2],m.hasMoved=!0}else if(l===void 0){const{deltaPoints:p}=i,g=p.world;this.moveAnnotation(o,g)}else{const{currentPoints:p}=i,g=p.world;u.handles.points[l]=[...g],o.invalidated=!0}this.editData.hasMoved=!0;const d=Xe(a),{renderingEngine:h}=d;at(s)},this.triggerAnnotationCompleted=(r,i)=>{const a=ee.ANNOTATION_COMPLETED,o={annotation:r,changeType:xn.Completed,contourHoleProcessingEnabled:i};wt(vt,a,o)},this.triggerAnnotationModified=(r,i,a=xn.StatsUpdated)=>{const{viewportId:o,renderingEngineId:s}=i,l=ee.ANNOTATION_MODIFIED;wt(vt,l,{annotation:r,viewportId:o,renderingEngineId:s,changeType:a})},this.triggerChangeEvent=(r,i,a=xn.StatsUpdated,o)=>{a===xn.Completed?this.triggerAnnotationCompleted(r,o):this.triggerAnnotationModified(r,i,a)},this._activateModify=r=>{Dt.isInteractingWithTool=!0,r.addEventListener(ee.MOUSE_UP,this._endCallback),r.addEventListener(ee.MOUSE_DRAG,this._dragCallback),r.addEventListener(ee.MOUSE_CLICK,this._endCallback),r.addEventListener(ee.TOUCH_END,this._endCallback),r.addEventListener(ee.TOUCH_DRAG,this._dragCallback),r.addEventListener(ee.TOUCH_TAP,this._endCallback)},this._deactivateModify=r=>{Dt.isInteractingWithTool=!1,r.removeEventListener(ee.MOUSE_UP,this._endCallback),r.removeEventListener(ee.MOUSE_DRAG,this._dragCallback),r.removeEventListener(ee.MOUSE_CLICK,this._endCallback),r.removeEventListener(ee.TOUCH_END,this._endCallback),r.removeEventListener(ee.TOUCH_DRAG,this._dragCallback),r.removeEventListener(ee.TOUCH_TAP,this._endCallback)},this._activateDraw=r=>{Dt.isInteractingWithTool=!0,r.addEventListener(ee.KEY_DOWN,this._keyDownCallback),r.addEventListener(ee.MOUSE_MOVE,this._mouseMoveCallback),r.addEventListener(ee.MOUSE_DOWN,this._mouseDownCallback),r.addEventListener(ee.MOUSE_DOUBLE_CLICK,this._mouseDownCallback),r.addEventListener(ee.TOUCH_TAP,this._mouseDownCallback)},this._deactivateDraw=r=>{Dt.isInteractingWithTool=!1,r.removeEventListener(ee.KEY_DOWN,this._keyDownCallback),r.removeEventListener(ee.MOUSE_MOVE,this._mouseMoveCallback),r.removeEventListener(ee.MOUSE_DOWN,this._mouseDownCallback),r.removeEventListener(ee.MOUSE_DOUBLE_CLICK,this._mouseDownCallback),r.removeEventListener(ee.TOUCH_TAP,this._mouseDownCallback)},this._renderStats=(r,i,a,o)=>{const s=r.data,l=this.getTargetId(i);if(!s.spline.instance.closed||!o.visibility)return;const c=this.configuration.getTextLines(s,l);if(!c||c.length===0)return;const f=s.handles.points.map(v=>i.worldToCanvas(v));if(!s.handles.textBox.hasMoved){const v=Iu(f);s.handles.textBox.worldPosition=i.canvasToWorld(v)}const u=i.worldToCanvas(s.handles.textBox.worldPosition),h=cl(a,r.annotationUID??"","textBox",c,u,f,{},o),{x:p,y:g,width:m,height:y}=h;s.handles.textBox.worldBoundingBox={topLeft:i.canvasToWorld([p,g]),topRight:i.canvasToWorld([p+m,g]),bottomLeft:i.canvasToWorld([p,g+y]),bottomRight:i.canvasToWorld([p+m,g+y])}},this.addControlPointCallback=(r,i)=>{const{data:a}=i,o=a.spline.type,s=this._getSplineConfig(o),l=s.controlPointAdditionDistance;if(s.controlPointAdditionEnabled===!1)return;const c=r.detail,{element:f}=c,u=Xe(f),{renderingEngine:d,viewport:h}=u,{canvasToWorld:p}=h,{instance:g}=a.spline,m=r.detail.currentPoints.canvas,y=g.getClosestPoint(m);if(y.distance>l)return;const{index:v,point:x}=g.addControlPointAtU(y.uValue);a.handles.points.splice(v,0,p(x)),i.invalidated=!0;const w=fn(f,this.getToolName());at(w)},this.deleteControlPointCallback=(r,i)=>{const a=i.data.spline.type,o=this._getSplineConfig(a),s=o.controlPointDeletionDistance;if(o.controlPointDeletionEnabled===!1)return;const l=r.detail,{element:c,currentPoints:f}=l,{canvas:u}=f,{instance:d}=i.data.spline,h=d.getClosestControlPointWithinDistance(u,s);h&&this._deleteControlPointByIndex(c,i,h.index)},this._calculateCachedStats=(r,i)=>{if(!this.configuration.calculateStats)return;const a=r.data;if(!a.contour.closed)return;const o=Xe(i);if(!o)return;const{viewport:s}=o,{cachedStats:l}=a,{polyline:c}=a.contour,f=Object.keys(l);for(let d=0;d<f.length;d++){const h=f[d],p=this.getTargetImageData(h);if(!p)continue;const{metadata:g}=p,m=c.map(O=>s.worldToCanvas(O)),y=m[0],v=s.canvasToWorld(y),x=s.canvasToWorld([y[0]+1,y[1]]),w=s.canvasToWorld([y[0],y[1]+1]),S=ol(v,x),T=ol(v,w),{imageData:_}=p,{scale:D,areaUnit:I}=Cc(p,()=>{const{maxX:O,maxY:P,minX:N,minY:A}=xm(m),B=s.canvasToWorld([N,A]),V=fo(_,B),$=s.canvasToWorld([O,P]),U=fo(_,$);return[V,U]});let R=Hy(m)/D/D;R*=S*T,l[h]={Modality:g.Modality,area:R,areaUnit:I}}const u=r.invalidated;return r.invalidated=!1,u&&this.triggerAnnotationModified(r,o,xn.StatsUpdated),l},this._throttledCalculateCachedStats=Wl(this._calculateCachedStats,100,{trailing:!0}),this.annotationCompletedBinded=this.annotationCompleted.bind(this)}annotationCompleted(e){const{sourceAnnotation:n}=e.detail;!this.splineToolNames.includes(n?.metadata?.toolName)||!this.configuration.simplifiedSpline||!this.isContourSegmentationTool()||Pke(n)}initializeListeners(){vt.addEventListener(ee.ANNOTATION_COMPLETED,this.annotationCompletedBinded)}removeListeners(){vt.removeEventListener(ee.ANNOTATION_COMPLETED,this.annotationCompletedBinded)}onSetToolEnabled(){this.initializeListeners()}onSetToolActive(){this.initializeListeners()}onSetToolDisabled(){this.removeListeners()}addNewAnnotation(e){const n=e.detail,{currentPoints:r,element:i}=n,{canvas:a}=r,o=n1(e.detail.event)===this.configuration.contourHoleAdditionModifierKey,s=Xe(i),{renderingEngine:l}=s,c=this.createAnnotation(e);this.isDrawing=!0,this.addAnnotation(c,i);const f=fn(i,this.getToolName());return this.editData={annotation:c,viewportIdsToRender:f,movingTextBox:!1,newAnnotation:!0,hasMoved:!1,lastCanvasPoint:a,contourHoleProcessingEnabled:o},this._activateDraw(i),e.preventDefault(),at(f),c}cancel(e){if(!this.isDrawing)return;this.isDrawing=!1,this._deactivateDraw(e),this._deactivateModify(e),qn(e);const{annotation:n,viewportIdsToRender:r,newAnnotation:i}=this.editData;i&&_r(n.annotationUID),super.cancelAnnotation(n);const a=Xe(e),{renderingEngine:o}=a;return at(r),this.editData=null,n.annotationUID}isContourSegmentationTool(){return!1}renderAnnotationInstance(e){const{enabledElement:n,targetId:r,svgDrawingHelper:i,annotationStyle:a}=e,{viewport:o}=n,{worldToCanvas:s}=o,{element:l}=o,c=e.annotation,{annotationUID:f,data:u,highlighted:d}=c,{handles:h}=u,{points:p,activeHandleIndex:g}=h,m=this.editData?.newAnnotation,{lineWidth:y,lineDash:v,color:x,locked:w}=a,S=p.map(A=>s(A)),{drawPreviewEnabled:T}=this.configuration.spline,_=c.data.spline.type,D=this._getSplineConfig(_),I=c.data.spline.instance,R=jy(c);if(R.findIndex(A=>!A)!==-1)throw new Error(`Can't find annotation for child ${c.childAnnotationUIDs.join()}`);[c,...R].filter(A=>this._isSplineROIAnnotation(A)).forEach(A=>{const V=this._updateSplineInstance(l,A).getPolylinePoints();this.updateContourPolyline(A,{points:V,closed:u.contour.closed,targetWindingDirection:rs.Clockwise},o,{updateWindingDirection:u.contour.closed})}),super.renderAnnotationInstance(e),!u.cachedStats[r]||u.cachedStats[r].areaUnit==null?(u.cachedStats[r]={Modality:null,area:null,areaUnit:null},this._calculateCachedStats(c,l)):c.invalidated&&this._throttledCalculateCachedStats(c,l);let N;if(!w&&!this.editData&&g!==null&&(N=[S[g]]),(N||m||d)&&bo(i,f,"0",S,{color:x,lineWidth:y,handleRadius:"3"}),T&&I.numControlPoints>=1&&this.editData?.lastCanvasPoint&&!I.closed){const{lastCanvasPoint:A}=this.editData,{enableTwoPointPreview:B}=this.configuration.spline;if(I.numControlPoints===1&&B){const $=[S[0],A];Rf(i,f,"previewSplineChange",$,{color:"#9EA0CA",lineDash:v,lineWidth:1})}else if(I.numControlPoints>1){const V=I.getPreviewPolylinePoints(A,vB);Rf(i,f,"previewSplineChange",V,{color:"#9EA0CA",lineDash:v,lineWidth:1})}}if(D.showControlPointsConnectors){const A=[...S];I.closed&&A.push(S[0]),Rf(i,f,"controlPointsConnectors",A,{color:"rgba(255, 255, 255, 0.5)",lineWidth:1})}return this._renderStats(c,o,i,a.textbox),this.fireChangeOnUpdate?.annotationUID===f&&(this.triggerChangeEvent(c,n,this.fireChangeOnUpdate.changeType,this.fireChangeOnUpdate.contourHoleProcessingEnabled),this.fireChangeOnUpdate=null),c.invalidated=!1,!0}createInterpolatedSplineControl(e){if(e.data.handles.points?.length)return;const{polyline:n}=e.data.contour;if(!n||!n.length)return;e.data.handles.points=[];const{points:r}=e.data.handles,i=Math.max(10,Math.floor(n.length/20));for(let a=0;a<n.length-i;a+=i)r.push(n[a]);r.push(n[n.length-1])}isSplineAnnotation(e){return bje.includes(e?.metadata?.toolName)}createSplineObjectFromType(e,n){const r=this._getSplineConfig(n),i=new r.Class;e.data.spline={type:r.type,instance:i,resolution:r.resolution}}createAnnotation(e){const n=super.createAnnotation(e),{world:r}=e.detail.currentPoints,{type:i}=this.configuration.spline,a=this._getSplineConfig(i),o=new a.Class,s=()=>({type:a.type,instance:o,resolution:a.resolution});let l;return this.configuration.interpolation?.enabled&&(l=c=>{c.data.spline||=s(),this.createInterpolatedSplineControl(c)}),No(n,{data:{handles:{points:[[...r]]},spline:s(),cachedStats:{}},onInterpolationComplete:l})}_deleteControlPointByIndex(e,n,r){const i=Xe(e),{points:a}=n.data.handles;a.length===3?_r(n.annotationUID):a.splice(r,1);const{renderingEngine:o}=i,s=fn(e,this.getToolName());n.invalidated=!0,at(s)}_isSplineROIAnnotation(e){return!!e.data?.spline}_getSplineConfig(e){const{configuration:n}=this,r=n.spline.configuration;return Object.assign({type:e},xje,r[e])}_updateSplineInstance(e,n){const r=Xe(e),{viewport:i}=r,{worldToCanvas:a}=i,{data:o}=n,{type:s,instance:l}=n.data.spline,c=this._getSplineConfig(s),u=o.handles.points.map(a),d=c.resolution!==void 0?parseInt(c.resolution):void 0,h=c.scale!==void 0?parseFloat(c.scale):void 0;return l.setControlPoints(u),l.closed=!!o.contour.closed,!l.fixedResolution&&d!==void 0&&l.resolution!==d&&(l.resolution=d,n.invalidated=!0),l instanceof q3&&!l.fixedScale&&h!==void 0&&l.scale!==h&&(l.scale=h,n.invalidated=!0),l}};Pd.toolName="SplineROI",Pd.SplineTypes=hf,Pd.Actions=h2,Pd.hydrate=(e,n,r)=>{const i=xr(e);if(!i)return;if(n.length<mB){console.warn("Spline requires at least 3 control points");return}const{FrameOfReferenceUID:a,referencedImageId:o,viewPlaneNormal:s,viewUp:l,instance:c,viewport:f}=Pd.hydrateBase(Pd,i,n,r),u=r?.splineType||hf.CatmullRom,h=c._getSplineConfig(u).Class,p=new h,{toolInstance:g,...m}=r||{},y={annotationUID:r?.annotationUID||cr(),data:{handles:{points:n},label:"",cachedStats:{},spline:{type:u,instance:p},contour:{closed:!0}},highlighted:!1,autoGenerated:!1,invalidated:!0,isLocked:!1,isVisible:!0,metadata:{toolName:c.getToolName(),viewPlaneNormal:s,FrameOfReferenceUID:a,referencedImageId:o,...m}};mr(y,f.element),at([f.id])};let bg=Pd;function wje(t,e){const n=t.cachedStats[e],{area:r,isEmptyArea:i,areaUnit:a}=n,o=[];if(r){const s=i?"Area: Oblique not supported":`Area: ${Vn(r)} ${a}`;o.push(s)}return o}class Cje{constructor({numBits:e,getPriority:n,areEqual:r}){this._bucketCount=1<<e,this._mask=this._bucketCount-1,this._size=0,this._currentBucketIndex=0,this._buckets=this._buildArray(this._bucketCount),this._getPriority=typeof n<"u"?n:i=>i,this._areEqual=typeof r=="function"?r:(i,a)=>i===a}push(e){const n=this._getBucketIndex(e),r=this._buckets[n],i={value:e,next:r};this._buckets[n]=i,this._size++}pop(){if(this._size===0)throw new Error("Cannot pop because the queue is empty.");for(;this._buckets[this._currentBucketIndex]===null;)this._currentBucketIndex=(this._currentBucketIndex+1)%this._bucketCount;const e=this._buckets[this._currentBucketIndex];return this._buckets[this._currentBucketIndex]=e.next,this._size--,e.value}remove(e){if(!e)return!1;const n=this._getBucketIndex(e),r=this._buckets[n];let i=r,a;for(;i!==null&&!this._areEqual(e,i.value);)a=i,i=i.next;return i===null?!1:(i===r?this._buckets[n]=i.next:a.next=i.next,this._size--,!0)}isEmpty(){return this._size===0}_getBucketIndex(e){return this._getPriority(e)&this._mask}_buildArray(e){const n=new Array(e);return n.fill(null),n}}const G8=4294967295,Sje=2/(3*Math.PI);class X3{constructor(e,n,r){this._getPointIndex=(a,o)=>{const{width:s}=this;return a*s+o},this._getPointCoordinate=a=>{const o=a%this.width,s=Math.floor(a/this.width);return[o,s]},this._getPointCost=a=>Math.round(this.searchGranularity*this.costs[a]);const i=e.length;this.searchGranularityBits=8,this.searchGranularity=1<<this.searchGranularityBits,this.width=n,this.height=r,this.grayscalePixelData=e,this.laplace=null,this.gradXNew=null,this.gradYNew=null,this.laplace=this._computeLaplace(),this.gradMagnitude=this._computeGradient(),this.gradXNew=this._computeGradientX(),this.gradYNew=this._computeGradientY(),this.visited=new Array(i),this.parents=new Uint32Array(i),this.costs=new Float32Array(i)}startSearch(e){const n=this._getPointIndex(e[1],e[0]);this.startPoint=null,this.visited.fill(!1),this.parents.fill(G8),this.costs.fill(1/0),this.priorityQueueNew=new Cje({numBits:this.searchGranularityBits,getPriority:this._getPointCost}),this.startPoint=e,this.costs[n]=0,this.priorityQueueNew.push(n)}findMinNearby(e,n=2){const[r,i]=e,{costs:a}=this,o=[Math.max(0,r-n),Math.min(r+n+1,this.width)],s=[Math.max(0,i-n),Math.min(i+n+1,this.height)];let l=a[this._getPointIndex(i,r)]*.8,c=e;for(let f=o[0];f<o[1];f++)for(let u=s[0];u<s[1];u++){const d=1-(Math.abs(f-e[0])+Math.abs(u-e[1]))/n/2,p=a[this._getPointIndex(u,f)]*.8+d*.2;p<l&&(c=[f,u],l=p)}return c}findPathToPoint(e){if(!this.startPoint)throw new Error("There is no search in progress");const{startPoint:n,_getPointIndex:r,_getPointCoordinate:i}=this,a=r(n[1],n[0]),o=r(e[1],e[0]),{visited:s,parents:l,costs:c,priorityQueueNew:f}=this;if(o===a)return[];for(;!f.isEmpty()&&l[o]===G8;){const h=f.pop();if(s[h])continue;const p=i(h),g=this._getNeighborPoints(p);s[h]=!0;for(let m=0,y=g.length;m<y;m++){const v=g[m],x=r(v[1],v[0]),w=this._getWeightedDistance(p,v),S=c[h]+w;S<c[x]&&(c[x]!==1/0&&f.remove(x),c[x]=S,l[x]=h,f.push(x))}}const u=[];let d=o;for(;d!==G8;)u.push(i(d)),d=l[d];return u.reverse()}_getDeltaX(e,n){const{grayscalePixelData:r,width:i}=this;let a=this._getPointIndex(n,e);return e+1===i&&a--,r[a+1]-r[a]}_getDeltaY(e,n){const{grayscalePixelData:r,width:i,height:a}=this;let o=this._getPointIndex(n,e);return n+1===a&&(o-=i),r[o]-r[o+i]}_getGradientMagnitude(e,n){const r=this._getDeltaX(e,n),i=this._getDeltaY(e,n);return Math.sqrt(r*r+i*i)}_getLaplace(e,n){const{grayscalePixelData:r,_getPointIndex:i}=this,a=r[i(n-2,e)],o=r[i(n-1,e-1)],s=r[i(n-1,e)],l=r[i(n-1,e+1)],c=r[i(n,e-2)],f=r[i(n,e-1)],u=r[i(n,e)],d=r[i(n,e+1)],h=r[i(n,e+2)],p=r[i(n+1,e-1)],g=r[i(n+1,e)],m=r[i(n+1,e+1)],y=r[i(n+2,e)];let v=a;return v+=o+2*s+l,v+=c+2*f-16*u+2*d+h,v+=p+2*g+m,v+=y,v}_computeGradient(){const{width:e,height:n}=this,r=new Float32Array(e*n);let i=0,a=0,o=0,s=0;for(s=0;s<n-1;s++){for(o=0;o<e-1;o++)r[i]=this._getGradientMagnitude(o,s),a=Math.max(r[i],a),i++;r[i]=r[i-1],i++}for(let l=r.length;i<l;i++)r[i]=r[i-e];for(let l=0,c=r.length;l<c;l++)r[l]=1-r[l]/a;return r}_computeLaplace(){const{width:e,height:n,_getPointIndex:r}=this,i=new Float32Array(e*n);i.fill(1,0,r(2,0));for(let a=2;a<n-2;a++){i[r(a,0)]=1,i[r(a,1)]=1;for(let o=2;o<e-2;o++)i[r(a,o)]=this._getLaplace(o,a)>.33?0:1;i[r(a,e-2)]=1,i[r(a,e-1)]=1}return i.fill(1,r(n-2,0)),i}_computeGradientX(){const{width:e,height:n}=this,r=new Float32Array(e*n);let i=0;for(let a=0;a<n;a++)for(let o=0;o<e;o++)r[i++]=this._getDeltaX(o,a);return r}_computeGradientY(){const{width:e,height:n}=this,r=new Float32Array(e*n);let i=0;for(let a=0;a<n;a++)for(let o=0;o<e;o++)r[i++]=this._getDeltaY(o,a);return r}_getGradientUnitVector(e,n){const{gradXNew:r,gradYNew:i,_getPointIndex:a}=this,o=r[a(n,e)],s=i[a(n,e)];let l=Math.sqrt(o*o+s*s);return l=Math.max(l,1e-100),[o/l,s/l]}_getGradientDirection(e,n,r,i){const a=this._getGradientUnitVector(e,n),o=this._getGradientUnitVector(r,i);let s=a[1]*(r-e)-a[0]*(i-n),l=o[1]*(r-e)-o[0]*(i-n);s<0&&(s=-s,l=-l),e!==r&&n!==i&&(s*=Math.SQRT1_2,l*=Math.SQRT1_2),l=Math.min(Math.max(l,-1),1);const c=Sje*(Math.acos(Math.min(s,1))+Math.acos(l));return isNaN(c)||!isFinite(c)?(console.warn("Found non-direction:",e,n,r,i,s,l,c),1):c}getCost(e,n){return this._getWeightedDistance(e,n)}_getWeightedDistance(e,n){const{_getPointIndex:r,width:i,height:a}=this,[o,s]=e,[l,c]=n;if(l<0||l>=i||c<0||c>=a)return 1;if(o<0||s<0||o>=i||s>=a)return 0;const f=r(c,l);let u=this.gradMagnitude[f];(o===l||s===c)&&(u*=Math.SQRT1_2);const d=this.laplace[f],h=this._getGradientDirection(o,s,l,c);return .43*u+.43*d+.11*h}_getNeighborPoints(e){const{width:n,height:r}=this,i=[],a=Math.max(e[0]-1,0),o=Math.max(e[1]-1,0),s=Math.min(e[0]+1,n-1),l=Math.min(e[1]+1,r-1);for(let c=o;c<=l;c++)for(let f=a;f<=s;f++)(f!==e[0]||c!==e[1])&&i.push([f,c]);return i}static createInstanceFromRawPixelData(e,n,r,i){const a=e.length,o=new Float32Array(a),{lower:s,upper:l}=i,c=l-s;for(let f=0,u=e.length;f<u;f++)o[f]=Math.max(0,Math.min(1,(e[f]-s)/c));return new X3(o,n,r)}}class Sd{constructor(e,n){this.pointArray=e?e.slice():[],this._controlPointIndexes=n?n.slice():[]}getPoint(e){return this.pointArray[e]}getLastPoint(){return this.pointArray[this.pointArray.length-1]}isControlPoint(e){const n=this.pointArray.indexOf(e);if(n!==-1)return this._controlPointIndexes.indexOf(n)!==-1;throw new Error("Error: isControlPoint called with not in list point.")}addPoint(e){this.pointArray.push(e)}addControlPoint(e){const n=this.pointArray.indexOf(e);if(n!==-1)this._controlPointIndexes.push(n);else throw new Error("Cannot mark a non registered point as control point.")}getControlPoints(){return this._controlPointIndexes.map(e=>this.pointArray[e])}getNumControlPoints(){return this._controlPointIndexes.length}removeLastControlPoint(){this._controlPointIndexes.length&&this._controlPointIndexes.pop()}getLastControlPoint(){if(this._controlPointIndexes.length)return this.pointArray[this._controlPointIndexes[this._controlPointIndexes.length-1]]}removeLastPoints(e){this.pointArray.splice(this.pointArray.length-e,e)}addPoints(e){this.pointArray=this.pointArray.concat(e)}prependPath(e){const n=e.pointArray.length,r=[];this.pointArray=e.pointArray.concat(this.pointArray);for(let i=0;i<this._controlPointIndexes.length;++i)r[i]=this._controlPointIndexes[i]+n;this._controlPointIndexes=e._controlPointIndexes.concat(r)}appendPath(e){this.addPoints(e.pointArray),e._controlPointIndexes.forEach(n=>this._controlPointIndexes.push(n))}}const Tje=10**2,vM=class vM extends cy{constructor(e={},n={supportedInteractionTypes:["Mouse","Touch"],configuration:{getTextLines:Eje,calculateStats:!0,preventHandleOutsideImage:!1,contourHoleAdditionModifierKey:La.Shift,snapHandleNearby:2,interpolation:{enabled:!1,nearestEdge:2,showInterpolationPolyline:!1},decimate:{enabled:!1,epsilon:.1},actions:{cancelInProgress:{method:"cancelInProgress",bindings:[{key:"Escape"}]}}}}){super(e,n),this.isHandleOutsideImage=!1,this.isPointNearTool=(r,i,a,o)=>{const s=Xe(r),{viewport:l}=s,c=o*o,f=i.data.contour.polyline.map(d=>l.worldToCanvas(d));let u=f[f.length-1];for(let d=0;d<f.length;d++){const h=f[d];if(mS(u,h,a)<=c)return!0;u=h}return!1},this.toolSelectedCallback=(r,i)=>{const a=r.detail,{element:o}=a;i.highlighted=!0;const s=fn(o,this.getToolName());this.editData={annotation:i,viewportIdsToRender:s,movingTextBox:!1};const l=Xe(o),{renderingEngine:c}=l;this._activateModify(o),at(s),r.preventDefault()},this.handleSelectedCallback=(r,i,a)=>{const o=r.detail,{element:s}=o,{data:l}=i;i.highlighted=!0;let c=!1,f;if(a.worldPosition)c=!0;else{const{points:p}=l.handles;f=p.findIndex(g=>g===a)}const u=fn(s,this.getToolName());this.editData={annotation:i,viewportIdsToRender:u,handleIndex:f,movingTextBox:c},this._activateModify(s);const d=Xe(s),{renderingEngine:h}=d;at(u),r.preventDefault()},this._endCallback=(r,i=!1)=>{const a=r.detail,{element:o}=a,{annotation:s,viewportIdsToRender:l,newAnnotation:c,contourHoleProcessingEnabled:f}=this.editData,{data:u}=s;this.doneEditMemo(),u.handles.activeHandleIndex=null,this._deactivateModify(o),this._deactivateDraw(o),qn(o);const d=Xe(o);if(this.isHandleOutsideImage&&this.configuration.preventHandleOutsideImage||i){_r(s.annotationUID),this.clearEditData(),at(l);return}at(l);const h=c?xn.Completed:xn.HandlesUpdated;this.triggerChangeEvent(s,d,h,f),this.clearEditData()},this.triggerChangeEvent=(r,i,a=xn.StatsUpdated,o=!1)=>{a===xn.Completed?oS(r,o):Un(r,i.viewport.element,a)},this._mouseDownCallback=r=>{const i=r.type===ee.MOUSE_DOUBLE_CLICK,{annotation:a,viewportIdsToRender:o,worldToSlice:s,sliceToWorld:l,newAnnotation:c}=this.editData;if(this.editData.closed)return;const f=r.detail,{element:u}=f,{currentPoints:d}=f,{canvas:h,world:p}=d;let g=p;const m=Xe(u),{viewport:y,renderingEngine:v}=m,x=this.editData.currentPath.getControlPoints();let w=x.length>=2&&i;if(this.doneEditMemo(),this.createMemo(u,a,{newAnnotation:c&&x.length===1}),x.length>=2){const _={index:-1,distSquared:1/0};for(let D=0,I=x.length;D<I;D++){const R=x[D],O=l(R),P=y.worldToCanvas(O),N=d0(h,P);N<=Tje&&N<_.distSquared&&(_.distSquared=N,_.index=D)}_.index===0&&(w=!0)}const{snapHandleNearby:S}=this.configuration;if(S&&!this.editData.closed){const _=new Sd,D=this.scissors.findMinNearby(s(p),1),I=this.scissors.findPathToPoint(D);_.addPoints(I),_.prependPath(this.editData.confirmedPath),g=l(D),this.editData.currentPath=_}this.editData.closed=this.editData.closed||w,this.editData.confirmedPath=this.editData.currentPath;const T=this.editData.currentPath.getLastPoint();this.editData.confirmedPath.addControlPoint(T),a.data.handles.points.push(l(T)),this.scissors.startSearch(s(g)),a.invalidated=!0,at(o),this.editData.closed&&(this.updateAnnotation(this.editData.confirmedPath),this._endCallback(r)),r.preventDefault()},this._mouseMoveCallback=r=>{const{element:i,currentPoints:a}=r.detail,{world:o,canvas:s}=a,{renderingEngine:l}=Xe(i),c=fn(i,this.getToolName());this.editData.lastCanvasPoint=s;const{width:f,height:u}=this.scissors,{worldToSlice:d}=this.editData,h=d(o);if(h[0]<0||h[1]<0||h[0]>=f||h[1]>=u)return;const p=this.scissors.findPathToPoint(h),g=new Sd;g.addPoints(p),g.prependPath(this.editData.confirmedPath),this.editData.currentPath=g,at(c),r.preventDefault()},this._dragCallback=r=>{this.isDrawing=!0;const i=r.detail,{element:a}=i,{annotation:o,viewportIdsToRender:s,movingTextBox:l,handleIndex:c,newAnnotation:f}=this.editData;this.createMemo(a,o,{newAnnotation:f});const{data:u}=o;if(l){const{deltaPoints:p}=i,g=p.world,{textBox:m}=u.handles,{worldPosition:y}=m;y[0]+=g[0],y[1]+=g[1],y[2]+=g[2],m.hasMoved=!0}else if(c===void 0)console.warn("Drag annotation not implemented");else{const{currentPoints:p}=i,g=p.world;this.editHandle(g,a,o,c)}this.editData.hasMoved=!0;const d=Xe(a),{renderingEngine:h}=d;at(s)},this.cancel=r=>{if(!this.isDrawing)return;this.isDrawing=!1,this._deactivateDraw(r),this._deactivateModify(r),qn(r);const{annotation:i,viewportIdsToRender:a,newAnnotation:o}=this.editData;return o&&_r(i.annotationUID),at(a),this.doneEditMemo(),this.scissors=null,i.annotationUID},this._activateModify=r=>{Dt.isInteractingWithTool=!0,r.addEventListener(ee.MOUSE_UP,this._endCallback),r.addEventListener(ee.MOUSE_DRAG,this._dragCallback),r.addEventListener(ee.MOUSE_CLICK,this._endCallback),r.addEventListener(ee.TOUCH_END,this._endCallback),r.addEventListener(ee.TOUCH_DRAG,this._dragCallback),r.addEventListener(ee.TOUCH_TAP,this._endCallback)},this._deactivateModify=r=>{Dt.isInteractingWithTool=!1,r.removeEventListener(ee.MOUSE_UP,this._endCallback),r.removeEventListener(ee.MOUSE_DRAG,this._dragCallback),r.removeEventListener(ee.MOUSE_CLICK,this._endCallback),r.removeEventListener(ee.TOUCH_END,this._endCallback),r.removeEventListener(ee.TOUCH_DRAG,this._dragCallback),r.removeEventListener(ee.TOUCH_TAP,this._endCallback)},this._activateDraw=r=>{Dt.isInteractingWithTool=!0,r.addEventListener(ee.MOUSE_MOVE,this._mouseMoveCallback),r.addEventListener(ee.MOUSE_DOWN,this._mouseDownCallback),r.addEventListener(ee.MOUSE_DOUBLE_CLICK,this._mouseDownCallback),r.addEventListener(ee.TOUCH_TAP,this._mouseDownCallback)},this._deactivateDraw=r=>{Dt.isInteractingWithTool=!1,r.removeEventListener(ee.MOUSE_MOVE,this._mouseMoveCallback),r.removeEventListener(ee.MOUSE_DOWN,this._mouseDownCallback),r.removeEventListener(ee.MOUSE_DOUBLE_CLICK,this._mouseDownCallback),r.removeEventListener(ee.TOUCH_TAP,this._mouseDownCallback)},this._calculateCachedStats=(r,i)=>{if(!this.configuration.calculateStats)return;const a=r.data;if(!a.contour.closed)return;const o=Xe(i),{viewport:s,renderingEngine:l}=o,{cachedStats:c}=a,{polyline:f}=a.contour,u=Object.keys(c);for(let h=0;h<u.length;h++){const p=u[h],g=this.getTargetImageData(p);if(!g)continue;const{metadata:m}=g,y=f.map(P=>s.worldToCanvas(P)),v=y[0],x=s.canvasToWorld(v),w=s.canvasToWorld([v[0]+1,v[1]]),S=s.canvasToWorld([v[0],v[1]+1]),T=ol(x,w),_=ol(x,S),{imageData:D}=g,{scale:I,areaUnit:R}=Cc(g,()=>{const{maxX:P,maxY:N,minX:A,minY:B}=xm(y),V=s.canvasToWorld([A,B]),$=fo(D,V),U=s.canvasToWorld([P,N]),G=fo(D,U);return[$,G]});let O=Hy(y)/I/I;O*=T*_,c[p]={Modality:m.Modality,area:O,areaUnit:R}}const d=r.invalidated;return r.invalidated=!1,d&&this.triggerAnnotationModified(r,o,xn.StatsUpdated),c},this._renderStats=(r,i,a,o)=>{const s=r.data,l=this.getTargetId(i);if(!s.contour.closed||!o.visibility)return;const c=this.configuration.getTextLines(s,l);if(!c||c.length===0)return;const f=s.handles.points.map(v=>i.worldToCanvas(v));if(!s.handles.textBox.hasMoved){const v=Iu(f);s.handles.textBox.worldPosition=i.canvasToWorld(v)}const u=i.worldToCanvas(s.handles.textBox.worldPosition),h=cl(a,r.annotationUID??"","textBox",c,u,f,{},o),{x:p,y:g,width:m,height:y}=h;s.handles.textBox.worldBoundingBox={topLeft:i.canvasToWorld([p,g]),topRight:i.canvasToWorld([p+m,g]),bottomLeft:i.canvasToWorld([p,g+y]),bottomRight:i.canvasToWorld([p+m,g+y])}},this.triggerAnnotationModified=(r,i,a=xn.StatsUpdated)=>{const{viewportId:o,renderingEngineId:s}=i,l=ee.ANNOTATION_MODIFIED;wt(vt,l,{annotation:r,viewportId:o,renderingEngineId:s,changeType:a})},this._throttledCalculateCachedStats=Wl(this._calculateCachedStats,100,{trailing:!0})}setupBaseEditData(e,n,r,i,a){const o=Xe(n),{viewport:s}=o;this.isDrawing=!0;const l=s.getImageData(),{imageData:c}=l;let f,u,d,h,p;if(!(s instanceof da))d=l.dimensions[0],h=l.dimensions[1],f=_=>{const D=fo(c,_);return[D[0],D[1]]},u=_=>gm(c,[_[0],_[1],0]),p=l.scalarData;else if(s instanceof da){const _=nee(s),{sliceToIndexMatrix:D,indexToSliceMatrix:I}=_;f=R=>{const O=fo(c,R),P=z2([0,0,0],O,I);return[P[0],P[1]]},u=R=>{const O=z2([0,0,0],[R[0],R[1],0],D);return gm(c,O)},p=_.scalarData,d=_.width,h=_.height}else throw new Error("Viewport not supported");p=aee(p,d,h);const{voiRange:g}=s.getProperties(),m=f(e);this.scissors=X3.createInstanceFromRawPixelData(p,d,h,g),i&&(this.scissorsNext=X3.createInstanceFromRawPixelData(p,d,h,g),this.scissorsNext.startSearch(f(i))),this.scissors.startSearch(m);const y=!i,v=new Sd,x=new Sd,w=y?void 0:new Sd;v.addPoint(m),v.addControlPoint(m);const S=fn(n,this.getToolName()),T=s.worldToCanvas(e);this.editData={annotation:r,viewportIdsToRender:S,newAnnotation:y,hasMoved:!1,lastCanvasPoint:T,confirmedPath:v,currentPath:x,confirmedPathNext:w,closed:!1,handleIndex:this.editData?.handleIndex??r.handles?.activeHandleIndex,worldToSlice:f,sliceToWorld:u,contourHoleProcessingEnabled:a}}addNewAnnotation(e){const n=e.detail,{currentPoints:r,element:i}=n,{world:a}=r,o=this.createAnnotation(e),s=n1(e.detail.event)===this.configuration.contourHoleAdditionModifierKey;return this.setupBaseEditData(a,i,o,void 0,s),this.addAnnotation(o,i),this._activateDraw(i),e.preventDefault(),at(this.editData.viewportIdsToRender),o}clearEditData(){this.editData=null,this.scissors=null,this.scissorsNext=null,this.isDrawing=!1}editHandle(e,n,r,i){const{data:a}=r,{points:o}=a.handles,{length:s}=o,l=o[(i-1+s)%s],c=o[(i+1)%s];if(!this.editData?.confirmedPathNext){this.setupBaseEditData(l,n,r,c);const{polyline:x}=a.contour,w=new Sd,S=new Sd,{worldToSlice:T}=this.editData,_=iB(r,i-1),D=iB(r,i+1);if(D===-1||_===-1)throw new Error(`Can't find handle index ${D===-1&&c} ${_===-1&&l}`);i===0?S.addPoints(x.slice(D+1,_).map(T)):(w.addPoints(x.slice(0,_+1).map(T)),S.addPoints(x.slice(D,x.length).map(T))),this.editData.confirmedPath=w,this.editData.confirmedPathNext=S}const{editData:f,scissors:u}=this,{worldToSlice:d,sliceToWorld:h}=f,{activeHandleIndex:p}=a.handles;if(p==null)a.handles.activeHandleIndex=i;else if(p!==i)throw new Error(`Trying to edit a different handle than the one currently being edited ${i}!==${a.handles.activeHandleIndex}`);const g=d(e);if(g[0]<0||g[0]>=u.width||g[1]<0||g[1]>=u.height)return;o[i]=h(g);const m=u.findPathToPoint(g),y=this.scissorsNext.findPathToPoint(g),v=new Sd;v.prependPath(f.confirmedPath),i!==0&&v.addPoints(m),v.addPoints(y.reverse()),v.appendPath(f.confirmedPathNext),i===0&&v.addPoints(m),f.currentPath=v,r.invalidated=!0,f.hasMoved=!0,f.closed=!0}renderAnnotation(e,n){return this.updateAnnotation(this.editData?.currentPath),super.renderAnnotation(e,n)}isContourSegmentationTool(){return!1}createAnnotation(e){const n=super.createAnnotation(e),{world:r}=e.detail.currentPoints;return No(n,{data:{handles:{points:[[...r]]}}})}cancelInProgress(e,n,r){if(!this.editData){this.undo();return}this._endCallback(r,!0)}renderAnnotationInstance(e){const{annotation:n,enabledElement:r,svgDrawingHelper:i,annotationStyle:a,targetId:o}=e,{viewport:s}=r,{element:l}=s,{worldToCanvas:c}=s,{annotationUID:f,data:u,highlighted:d}=n,{handles:h}=u,p=this.editData?.newAnnotation,{lineWidth:g,lineDash:m,color:y}=a;if(d||p&&n.annotationUID===this.editData?.annotation?.annotationUID){const x=h.points.map(c);bo(i,f,"0",x,{color:y,lineDash:m,lineWidth:g})}return super.renderAnnotationInstance(e),!u.cachedStats[o]||u.cachedStats[o]?.areaUnit===null?(u.cachedStats[o]={Modality:null,area:null,areaUnit:null},this._calculateCachedStats(n,l)):n.invalidated&&this._throttledCalculateCachedStats(n,l),this._renderStats(n,s,i,a.textbox),!0}updateAnnotation(e){if(!this.editData||!e)return;const{annotation:n,sliceToWorld:r,worldToSlice:i,closed:a,newAnnotation:o}=this.editData;let{pointArray:s}=e;s.length>1&&(s=[...s,s[0]]);const l=o&&a?rs.Clockwise:void 0;this.updateContourPolyline(n,{points:s,closed:a,targetWindingDirection:l},{canvasToWorld:r,worldToCanvas:i})}};vM.toolName="LivewireContour";let wg=vM;function Eje(t,e){const n=t.cachedStats[e],{area:r,areaUnit:i}=n,a=[];if(r){const o=`Area: ${Vn(r)} ${i}`;a.push(o)}return a}const Ng=class Ng extends la{constructor(e={},n={supportedInteractionTypes:["Mouse","Touch"],configuration:{shadow:!0,getTextCallback:_je,changeTextCallback:Dje,preventHandleOutsideImage:!1,arrowFirst:!0,arrowHeadStyle:"legacy"}}){super(e,n),this.addNewAnnotation=r=>{const i=r.detail,{currentPoints:a,element:o}=i,s=a.world,l=Xe(o),{viewport:c,renderingEngine:f}=l;Rn(o),this.isDrawing=!0;const u=c.getCamera(),{viewPlaneNormal:d,viewUp:h}=u,p=this.getReferencedImageId(c,s,d,h),{arrowFirst:g}=this.configuration,m=c.getFrameOfReferenceUID(),y={highlighted:!0,invalidated:!0,metadata:{toolName:this.getToolName(),viewPlaneNormal:[...d],viewUp:[...h],FrameOfReferenceUID:m,referencedImageId:p,...c.getViewReference({points:[s]})},data:{text:"",handles:{points:[[...s],[...s]],activeHandleIndex:null,arrowFirst:g,textBox:{hasMoved:!1,worldPosition:[0,0,0],worldBoundingBox:{topLeft:[0,0,0],topRight:[0,0,0],bottomLeft:[0,0,0],bottomRight:[0,0,0]}}},label:""}};mr(y,o);const v=fn(o,this.getToolName());return this.editData={annotation:y,viewportIdsToRender:v,handleIndex:1,movingTextBox:!1,newAnnotation:!0,hasMoved:!1},this._activateDraw(o),r.preventDefault(),at(v),y},this.isPointNearTool=(r,i,a,o)=>{const s=Xe(r),{viewport:l}=s,{data:c}=i,[f,u]=c.handles.points,d=l.worldToCanvas(f),h=l.worldToCanvas(u),p={start:{x:d[0],y:d[1]},end:{x:h[0],y:h[1]}};return Ll([p.start.x,p.start.y],[p.end.x,p.end.y],[a[0],a[1]])<=o},this.toolSelectedCallback=(r,i)=>{const a=r.detail,{element:o}=a;i.highlighted=!0;const s=fn(o,this.getToolName());this.editData={annotation:i,viewportIdsToRender:s,movingTextBox:!1},this._activateModify(o),Rn(o);const l=Xe(o),{renderingEngine:c}=l;at(s),r.preventDefault()},this._endCallback=r=>{const i=r.detail,{element:a}=i,{annotation:o,viewportIdsToRender:s,newAnnotation:l,hasMoved:c,movingTextBox:f}=this.editData,{data:u}=o;l&&!c||(u.handles.activeHandleIndex=null,this._deactivateModify(a),this._deactivateDraw(a),qn(a),this.isHandleOutsideImage&&this.configuration.preventHandleOutsideImage&&_r(o.annotationUID),l?this.configuration.getTextCallback(d=>{if(!d){_r(o.annotationUID),at(s),this.editData=null,this.isDrawing=!1;return}o.data.text=d,Un(o,a,xn.HandlesUpdated),Xr(o),this.createMemo(a,o,{newAnnotation:!!this.memo}),ZGe(o,a,d),at(s)}):f||Un(o,a,xn.HandlesUpdated),this.doneEditMemo(),this.editData=null,this.isDrawing=!1)},this._dragCallback=r=>{this.isDrawing=!0;const i=r.detail,{element:a}=i,{annotation:o,viewportIdsToRender:s,handleIndex:l,movingTextBox:c,newAnnotation:f}=this.editData;this.createMemo(a,o,{newAnnotation:f});const{data:u}=o;if(c){const{deltaPoints:d}=i,h=d.world,{textBox:p}=u.handles,{worldPosition:g}=p;g[0]+=h[0],g[1]+=h[1],g[2]+=h[2],p.hasMoved=!0}else if(l===void 0){const{deltaPoints:d}=i,h=d.world;u.handles.points.forEach(g=>{g[0]+=h[0],g[1]+=h[1],g[2]+=h[2]}),o.invalidated=!0}else{const{currentPoints:d}=i,h=d.world;u.handles.points[l]=[...h],o.invalidated=!0}this.editData.hasMoved=!0,at(s),o.invalidated&&Un(o,a,xn.HandlesUpdated)},this.touchTapCallback=r=>{r.detail.taps==2&&this.doubleClickCallback(r)},this.doubleClickCallback=r=>{const i=r.detail,{element:a}=i;let o=Zi(this.getToolName(),a);if(o=this.filterInteractableAnnotationsForElement(a,o),!o?.length)return;const s=o.find(c=>this.isPointNearTool(a,c,i.currentPoints.canvas,6));if(!s)return;const l=s;this.configuration.changeTextCallback(s,r.detail,this._doneChangingTextCallback.bind(this,a,l)),this.editData=null,this.isDrawing=!1,r.stopImmediatePropagation(),r.preventDefault()},this.cancel=r=>{if(this.isDrawing){this.isDrawing=!1,this._deactivateDraw(r),this._deactivateModify(r),qn(r);const{annotation:i,viewportIdsToRender:a,newAnnotation:o}=this.editData,{data:s}=i;return i.highlighted=!1,s.handles.activeHandleIndex=null,at(a),o&&Xr(i),this.editData=null,i.annotationUID}},this._activateModify=r=>{Dt.isInteractingWithTool=!0,r.addEventListener(ee.MOUSE_UP,this._endCallback),r.addEventListener(ee.MOUSE_DRAG,this._dragCallback),r.addEventListener(ee.MOUSE_CLICK,this._endCallback),r.addEventListener(ee.TOUCH_TAP,this._endCallback),r.addEventListener(ee.TOUCH_END,this._endCallback),r.addEventListener(ee.TOUCH_DRAG,this._dragCallback)},this._deactivateModify=r=>{Dt.isInteractingWithTool=!1,r.removeEventListener(ee.MOUSE_UP,this._endCallback),r.removeEventListener(ee.MOUSE_DRAG,this._dragCallback),r.removeEventListener(ee.MOUSE_CLICK,this._endCallback),r.removeEventListener(ee.TOUCH_TAP,this._endCallback),r.removeEventListener(ee.TOUCH_DRAG,this._dragCallback),r.removeEventListener(ee.TOUCH_END,this._endCallback)},this._activateDraw=r=>{Dt.isInteractingWithTool=!0,r.addEventListener(ee.MOUSE_UP,this._endCallback),r.addEventListener(ee.MOUSE_DRAG,this._dragCallback),r.addEventListener(ee.MOUSE_MOVE,this._dragCallback),r.addEventListener(ee.MOUSE_CLICK,this._endCallback),r.addEventListener(ee.TOUCH_TAP,this._endCallback),r.addEventListener(ee.TOUCH_END,this._endCallback),r.addEventListener(ee.TOUCH_DRAG,this._dragCallback)},this._deactivateDraw=r=>{Dt.isInteractingWithTool=!1,r.removeEventListener(ee.MOUSE_UP,this._endCallback),r.removeEventListener(ee.MOUSE_DRAG,this._dragCallback),r.removeEventListener(ee.MOUSE_MOVE,this._dragCallback),r.removeEventListener(ee.MOUSE_CLICK,this._endCallback),r.removeEventListener(ee.TOUCH_TAP,this._endCallback),r.removeEventListener(ee.TOUCH_END,this._endCallback),r.removeEventListener(ee.TOUCH_DRAG,this._dragCallback)},this.renderAnnotation=(r,i)=>{let a=!1;const{viewport:o}=r,{element:s}=o;let l=Zi(this.getToolName(),s);if(!l?.length||(l=this.filterInteractableAnnotationsForElement(s,l),!l?.length))return a;const c={toolGroupId:this.toolGroupId,toolName:this.getToolName(),viewportId:r.viewport.id};for(let f=0;f<l.length;f++){const u=l[f],{annotationUID:d,data:h}=u,{handles:p,text:g}=h,{points:m,activeHandleIndex:y}=p;c.annotationUID=d;const{color:v,lineWidth:x,lineDash:w,markerSize:S}=this.getAnnotationStyle({annotation:u,styleSpecifier:c}),T=m.map($=>o.worldToCanvas($));let _;if(!yo(d)&&!this.editData&&y!==null&&(_=[T[y]]),!o.getRenderingEngine())return console.warn("Rendering Engine has been destroyed"),a;if(!xo(d))continue;_&&bo(i,d,"0",T,{color:v,lineWidth:x});const D="1";if(this.configuration.arrowFirst?IU(i,d,D,T[1],T[0],{color:v,width:x,lineDash:w,viaMarker:this.configuration.arrowHeadStyle!=="legacy",markerSize:S}):IU(i,d,D,T[0],T[1],{color:v,width:x,lineDash:w,viaMarker:this.configuration.arrowHeadStyle!=="legacy",markerSize:S}),a=!0,!g)continue;const I=this.getLinkedTextBoxStyle(c,u);if(!I.visibility){h.handles.textBox={hasMoved:!1,worldPosition:[0,0,0],worldBoundingBox:{topLeft:[0,0,0],topRight:[0,0,0],bottomLeft:[0,0,0],bottomRight:[0,0,0]}};continue}if(!h.handles.textBox.hasMoved){const $=T[1];h.handles.textBox.worldPosition=o.canvasToWorld($)}const R=o.worldToCanvas(h.handles.textBox.worldPosition),P=cl(i,d,"1",[g],R,T,{},I),{x:N,y:A,width:B,height:V}=P;h.handles.textBox.worldBoundingBox={topLeft:o.canvasToWorld([N,A]),topRight:o.canvasToWorld([N+B,A]),bottomLeft:o.canvasToWorld([N,A+V]),bottomRight:o.canvasToWorld([N+B,A+V])}}return a}}handleSelectedCallback(e,n,r){const i=e.detail,{element:a}=i,{data:o}=n;n.highlighted=!0;let s=!1,l;r.worldPosition?s=!0:l=o.handles.points.findIndex(d=>d===r);const c=fn(a,this.getToolName());this.editData={annotation:n,viewportIdsToRender:c,handleIndex:l,movingTextBox:s},this._activateModify(a),Rn(a);const f=Xe(a),{renderingEngine:u}=f;at(c),e.preventDefault()}_doneChangingTextCallback(e,n,r){n.data.text=r,Xe(e);const i=fn(e,this.getToolName());at(i),Un(n,e)}_isInsideVolume(e,n,r){return Ta(e,r)&&Ta(n,r)}};Ng.toolName="ArrowAnnotate",Ng.hydrate=(e,n,r,i)=>{const a=xr(e);if(!a)return;const{FrameOfReferenceUID:o,referencedImageId:s,viewPlaneNormal:l,instance:c,viewport:f}=Ng.hydrateBase(Ng,a,n,i),{toolInstance:u,...d}=i||{},h={annotationUID:i?.annotationUID||cr(),data:{text:r||"",handles:{points:n}},highlighted:!1,autoGenerated:!1,invalidated:!1,isLocked:!1,isVisible:!0,metadata:{toolName:c.getToolName(),viewPlaneNormal:l,FrameOfReferenceUID:o,referencedImageId:s,...d}};mr(h,f.element),at([f.id])};let Cg=Ng;function _je(t){return t(prompt("Enter your annotation:"))}function Dje(t,e,n){return n(prompt("Enter your annotation:"))}const Lg=class Lg extends la{constructor(e={},n={supportedInteractionTypes:["Mouse","Touch"],configuration:{shadow:!0,showAngleArc:!1,arcOffset:5,preventHandleOutsideImage:!1,getTextLines:Oje}}){super(e,n),this.addNewAnnotation=r=>{if(this.angleStartedNotYetCompleted)return;this.angleStartedNotYetCompleted=!0;const i=r.detail,{currentPoints:a,element:o}=i,s=a.world,l=Xe(o),{viewport:c,renderingEngine:f}=l;Rn(o),this.isDrawing=!0;const u=c.getCamera(),{viewPlaneNormal:d,viewUp:h}=u,p=this.getReferencedImageId(c,s,d,h),g=c.getFrameOfReferenceUID(),m={highlighted:!0,invalidated:!0,metadata:{toolName:this.getToolName(),viewPlaneNormal:[...d],viewUp:[...h],FrameOfReferenceUID:g,referencedImageId:p,...c.getViewReference({points:[s]})},data:{handles:{points:[[...s],[...s]],activeHandleIndex:null,textBox:{hasMoved:!1,worldPosition:[0,0,0],worldBoundingBox:{topLeft:[0,0,0],topRight:[0,0,0],bottomLeft:[0,0,0],bottomRight:[0,0,0]}}},label:"",cachedStats:{}}};mr(m,o);const y=fn(o,this.getToolName());return this.editData={annotation:m,viewportIdsToRender:y,handleIndex:1,movingTextBox:!1,newAnnotation:!0,hasMoved:!1},this._activateDraw(o),r.preventDefault(),at(y),m},this.isPointNearTool=(r,i,a,o)=>{const s=Xe(r),{viewport:l}=s,{data:c}=i,[f,u,d]=c.handles.points,h=l.worldToCanvas(f),p=l.worldToCanvas(u),g={start:{x:h[0],y:h[1]},end:{x:p[0],y:p[1]}};if(Ll([g.start.x,g.start.y],[g.end.x,g.end.y],[a[0],a[1]])<=o)return!0;if(!d)return!1;const y=l.worldToCanvas(d),v={start:{x:p[0],y:p[1]},end:{x:y[0],y:y[1]}};return Ll([v.start.x,v.start.y],[v.end.x,v.end.y],[a[0],a[1]])<=o},this.toolSelectedCallback=(r,i)=>{const a=r.detail,{element:o}=a;i.highlighted=!0;const s=fn(o,this.getToolName());this.editData={annotation:i,viewportIdsToRender:s,movingTextBox:!1},this._activateModify(o),Rn(o);const l=Xe(o),{renderingEngine:c}=l;at(s),r.preventDefault()},this._endCallback=r=>{const i=r.detail,{element:a}=i,{annotation:o,viewportIdsToRender:s,newAnnotation:l,hasMoved:c}=this.editData,{data:f}=o;if(l&&!c)return;if(this.angleStartedNotYetCompleted&&f.handles.points.length===2){this.editData.handleIndex=2;return}this.angleStartedNotYetCompleted=!1,f.handles.activeHandleIndex=null,this._deactivateModify(a),this._deactivateDraw(a),qn(a);const u=Xe(a),{renderingEngine:d}=u;this.isHandleOutsideImage&&this.configuration.preventHandleOutsideImage&&_r(o.annotationUID),at(s),this.doneEditMemo(),l&&Xr(o),this.editData=null,this.isDrawing=!1},this._dragCallback=r=>{this.isDrawing=!0;const i=r.detail,{element:a}=i,{annotation:o,viewportIdsToRender:s,handleIndex:l,movingTextBox:c,newAnnotation:f}=this.editData,{data:u}=o;if(this.createMemo(a,o,{newAnnotation:f}),c){const{deltaPoints:p}=i,g=p.world,{textBox:m}=u.handles,{worldPosition:y}=m;y[0]+=g[0],y[1]+=g[1],y[2]+=g[2],m.hasMoved=!0}else if(l===void 0){const{deltaPoints:p}=i,g=p.world;u.handles.points.forEach(y=>{y[0]+=g[0],y[1]+=g[1],y[2]+=g[2]}),o.invalidated=!0}else{const{currentPoints:p}=i,g=p.world;u.handles.points[l]=[...g],o.invalidated=!0}this.editData.hasMoved=!0;const d=Xe(a),{renderingEngine:h}=d;at(s),o.invalidated&&Un(o,a,xn.HandlesUpdated)},this.cancel=r=>{if(this.isDrawing){this.isDrawing=!1,this._deactivateDraw(r),this._deactivateModify(r),qn(r);const{annotation:i,viewportIdsToRender:a,newAnnotation:o}=this.editData,{data:s}=i;return i.highlighted=!1,s.handles.activeHandleIndex=null,at(a),o&&Xr(i),this.editData=null,this.angleStartedNotYetCompleted=!1,i.annotationUID}},this._activateModify=r=>{Dt.isInteractingWithTool=!0,r.addEventListener(ee.MOUSE_UP,this._endCallback),r.addEventListener(ee.MOUSE_DRAG,this._dragCallback),r.addEventListener(ee.MOUSE_CLICK,this._endCallback),r.addEventListener(ee.TOUCH_TAP,this._endCallback),r.addEventListener(ee.TOUCH_END,this._endCallback),r.addEventListener(ee.TOUCH_DRAG,this._dragCallback)},this._deactivateModify=r=>{Dt.isInteractingWithTool=!1,r.removeEventListener(ee.MOUSE_UP,this._endCallback),r.removeEventListener(ee.MOUSE_DRAG,this._dragCallback),r.removeEventListener(ee.MOUSE_CLICK,this._endCallback),r.removeEventListener(ee.TOUCH_TAP,this._endCallback),r.removeEventListener(ee.TOUCH_END,this._endCallback),r.removeEventListener(ee.TOUCH_DRAG,this._dragCallback)},this._activateDraw=r=>{Dt.isInteractingWithTool=!0,r.addEventListener(ee.MOUSE_UP,this._endCallback),r.addEventListener(ee.MOUSE_DRAG,this._dragCallback),r.addEventListener(ee.MOUSE_MOVE,this._dragCallback),r.addEventListener(ee.MOUSE_CLICK,this._endCallback),r.addEventListener(ee.TOUCH_TAP,this._endCallback),r.addEventListener(ee.TOUCH_END,this._endCallback),r.addEventListener(ee.TOUCH_DRAG,this._dragCallback)},this._deactivateDraw=r=>{Dt.isInteractingWithTool=!1,r.removeEventListener(ee.MOUSE_UP,this._endCallback),r.removeEventListener(ee.MOUSE_DRAG,this._dragCallback),r.removeEventListener(ee.MOUSE_MOVE,this._dragCallback),r.removeEventListener(ee.MOUSE_CLICK,this._endCallback),r.removeEventListener(ee.TOUCH_TAP,this._endCallback),r.removeEventListener(ee.TOUCH_END,this._endCallback),r.removeEventListener(ee.TOUCH_DRAG,this._dragCallback)},this.renderAnnotation=(r,i)=>{let a=!1;const{viewport:o}=r,{element:s}=o;let l=Zi(this.getToolName(),s);if(!l?.length||(l=this.filterInteractableAnnotationsForElement(s,l),!l?.length))return a;const c=this.getTargetId(o),f=o.getRenderingEngine(),u={toolGroupId:this.toolGroupId,toolName:this.getToolName(),viewportId:r.viewport.id};for(let d=0;d<l.length;d++){const h=l[d],{annotationUID:p,data:g}=h,{points:m,activeHandleIndex:y}=g.handles;u.annotationUID=p;const{color:v,lineWidth:x,lineDash:w,angleArcLineDash:S}=this.getAnnotationStyle({annotation:h,styleSpecifier:u}),T=m.map(U=>o.worldToCanvas(U));!g.cachedStats[c]||g.cachedStats[c].angle==null?(g.cachedStats[c]={angle:null},this._calculateCachedStats(h,f,r)):h.invalidated&&this._throttledCalculateCachedStats(h,f,r);let _;if(!yo(h.annotationUID)&&!this.editData&&y!==null&&(_=[T[y]]),!o.getRenderingEngine())return console.warn("Rendering Engine has been destroyed"),a;if(!xo(p))continue;_&&bo(i,p,"0",T,{color:v,lineDash:w,lineWidth:x});let D="1";if(Va(i,p,D,T[0],T[1],{color:v,width:x,lineDash:w}),a=!0,T.length!==3)return a;if(D="2",Va(i,p,D,T[1],T[2],{color:v,width:x,lineDash:w}),this.configuration.showAngleArc){const U=T[1],G=this.configuration.arcOffset,F=Math.min(Ll([U[0],U[1]],[T[0][0],T[0][1]],[T[2][0],T[2][1]]),Ll([U[0],U[1]],[T[2][0],T[2][1]],[T[0][0],T[0][1]]))/G,J=[];let Q=Math.atan2(T[0][1]-U[1],T[0][0]-U[0]),ne=Math.atan2(T[2][1]-U[1],T[2][0]-U[0]);if(ne<Q&&(ne+=2*Math.PI),ne-Q>Math.PI){const Ce=Q;Q=ne,ne=Ce+2*Math.PI}const ve=32;for(let Ce=0;Ce<=ve;Ce++){const we=Q+Ce/ve*(ne-Q);J.push([U[0]+F*Math.cos(we),U[1]+F*Math.sin(we)])}Dh(i,p,"3",J,{color:v,width:x,lineDash:S})}if(!g.cachedStats[c]?.angle)continue;const I=this.getLinkedTextBoxStyle(u,h);if(!I.visibility){g.handles.textBox={hasMoved:!1,worldPosition:[0,0,0],worldBoundingBox:{topLeft:[0,0,0],topRight:[0,0,0],bottomLeft:[0,0,0],bottomRight:[0,0,0]}};continue}const R=this.configuration.getTextLines(g,c);if(!g.handles.textBox.hasMoved){const U=T[1];g.handles.textBox.worldPosition=o.canvasToWorld(U)}const O=o.worldToCanvas(g.handles.textBox.worldPosition),N=cl(i,p,"1",R,O,T,{},I),{x:A,y:B,width:V,height:$}=N;g.handles.textBox.worldBoundingBox={topLeft:o.canvasToWorld([A,B]),topRight:o.canvasToWorld([A+V,B]),bottomLeft:o.canvasToWorld([A,B+$]),bottomRight:o.canvasToWorld([A+V,B+$])}}return a},this._throttledCalculateCachedStats=Wl(this._calculateCachedStats,100,{trailing:!0})}handleSelectedCallback(e,n,r){const i=e.detail,{element:a}=i,{data:o}=n;n.highlighted=!0;let s=!1,l;r.worldPosition?s=!0:l=o.handles.points.findIndex(d=>d===r);const c=fn(a,this.getToolName());this.editData={annotation:n,viewportIdsToRender:c,handleIndex:l,movingTextBox:s},this._activateModify(a),Rn(a);const f=Xe(a),{renderingEngine:u}=f;at(c),e.preventDefault()}_calculateCachedStats(e,n,r){const i=e.data,{element:a}=r.viewport;if(i.handles.points.length!==3)return;const o=i.handles.points[0],s=i.handles.points[1],l=i.handles.points[2],{cachedStats:c}=i,f=Object.keys(c);for(let d=0;d<f.length;d++){const h=f[d],p=mw([o,s],[s,l]),{dimensions:g,imageData:m}=this.getTargetImageData(h);this.isHandleOutsideImage=[o,s,l].map(y=>fo(m,y)).some(y=>!Ta(y,g)),c[h]={angle:isNaN(p)?"Incomplete Angle":p}}const u=e.invalidated;return e.invalidated=!1,u&&Un(e,a,xn.StatsUpdated),c}};Lg.toolName="Angle",Lg.hydrate=(e,n,r)=>{const i=xr(e);if(!i)return;const{FrameOfReferenceUID:a,referencedImageId:o,viewPlaneNormal:s,instance:l,viewport:c}=Lg.hydrateBase(Lg,i,n,r),{toolInstance:f,...u}=r||{},d={annotationUID:r?.annotationUID||cr(),data:{handles:{points:n}},highlighted:!1,autoGenerated:!1,invalidated:!1,isLocked:!1,isVisible:!0,metadata:{toolName:l.getToolName(),viewPlaneNormal:s,FrameOfReferenceUID:a,referencedImageId:o,...u}};mr(d,c.element),at([c.id])};let Sg=Lg;function Oje(t,e){const n=t.cachedStats[e],{angle:r}=n;return r===void 0?void 0:isNaN(r)?[`${r}`]:[`${Vn(r)} °`]}const Mje=(...t)=>{const e=t[0].length===2?[0,0]:[0,0,0],n=t.length;for(const r of t)e[0]+=r[0]/n,e[1]+=r[1]/n,e.length===3&&(e[2]+=r[2]/n);return e},cf=Mje,yM=class yM extends la{constructor(e={},n={supportedInteractionTypes:["Mouse","Touch"],configuration:{shadow:!0,preventHandleOutsideImage:!1,getTextLines:Ije,showArcLines:!1}}){super(e,n),this.addNewAnnotation=r=>{if(this.angleStartedNotYetCompleted)return;this.angleStartedNotYetCompleted=!0;const i=r.detail,{currentPoints:a,element:o}=i,s=a.world,l=Xe(o),{viewport:c,renderingEngine:f}=l;Rn(o),this.isDrawing=!0;const u=c.getCamera(),{viewPlaneNormal:d,viewUp:h}=u,p=this.getReferencedImageId(c,s,d,h),g=c.getFrameOfReferenceUID(),m={highlighted:!0,invalidated:!0,metadata:{toolName:this.getToolName(),viewPlaneNormal:[...d],viewUp:[...h],FrameOfReferenceUID:g,referencedImageId:p,...c.getViewReference({points:[s]})},data:{handles:{points:[[...s],[...s]],activeHandleIndex:null,textBox:{hasMoved:!1,worldPosition:[0,0,0],worldBoundingBox:{topLeft:[0,0,0],topRight:[0,0,0],bottomLeft:[0,0,0],bottomRight:[0,0,0]}}},label:"",cachedStats:{}}};mr(m,o);const y=fn(o,this.getToolName());return this.editData={annotation:m,viewportIdsToRender:y,handleIndex:1,movingTextBox:!1,newAnnotation:!0,hasMoved:!1},this._activateDraw(o),r.preventDefault(),at(y),m},this.isPointNearTool=(r,i,a,o)=>{const s=Xe(r),{viewport:l}=s,{data:c}=i,{distanceToPoint:f,distanceToPoint2:u}=this.distanceToLines({viewport:l,points:c.handles.points,canvasCoords:a,proximity:o});return f<=o||u<=o},this.toolSelectedCallback=(r,i,a,o,s=6)=>{const l=r.detail,{element:c}=l;i.highlighted=!0;const f=fn(c,this.getToolName()),u=Xe(c),{renderingEngine:d,viewport:h}=u,{isNearFirstLine:p,isNearSecondLine:g}=this.distanceToLines({viewport:h,points:i.data.handles.points,canvasCoords:o,proximity:s});this.editData={annotation:i,viewportIdsToRender:f,movingTextBox:!1,isNearFirstLine:p,isNearSecondLine:g},this._activateModify(c),Rn(c),at(f),r.preventDefault()},this._endCallback=r=>{const i=r.detail,{element:a}=i,{annotation:o,viewportIdsToRender:s,newAnnotation:l,hasMoved:c}=this.editData,{data:f}=o;if(l&&!c)return;if(this.doneEditMemo(),this.angleStartedNotYetCompleted&&f.handles.points.length<4){qn(a),this.editData.handleIndex=f.handles.points.length;return}this.angleStartedNotYetCompleted=!1,f.handles.activeHandleIndex=null,this._deactivateModify(a),this._deactivateDraw(a),qn(a);const u=Xe(a),{renderingEngine:d}=u;this.isHandleOutsideImage&&this.configuration.preventHandleOutsideImage&&_r(o.annotationUID),at(s),l&&Xr(o),this.editData=null,this.isDrawing=!1},this._mouseDownCallback=r=>{const{annotation:i,handleIndex:a}=this.editData,o=r.detail,{element:s,currentPoints:l}=o,c=l.world,{data:f}=i;if(a===1){f.handles.points[1]=c,this.editData.hasMoved=f.handles.points[1][0]!==f.handles.points[0][0]||f.handles.points[1][1]!==f.handles.points[0][0];return}if(a===3){f.handles.points[3]=c,this.editData.hasMoved=f.handles.points[3][0]!==f.handles.points[2][0]||f.handles.points[3][1]!==f.handles.points[2][0],this.angleStartedNotYetCompleted=!1;return}this.editData.hasMoved=!1,Rn(s),f.handles.points[2]=f.handles.points[3]=c,this.editData.handleIndex=f.handles.points.length-1},this._dragCallback=r=>{this.isDrawing=!0;const i=r.detail,{element:a}=i,{annotation:o,viewportIdsToRender:s,handleIndex:l,movingTextBox:c,isNearFirstLine:f,isNearSecondLine:u,newAnnotation:d}=this.editData;this.createMemo(a,o,{newAnnotation:d});const{data:h}=o;if(c){const{deltaPoints:m}=i,y=m.world,{textBox:v}=h.handles,{worldPosition:x}=v;x[0]+=y[0],x[1]+=y[1],x[2]+=y[2],v.hasMoved=!0}else if(l===void 0&&(f||u)){const{deltaPoints:m}=i,y=m.world,v=h.handles.points;f?[v[0],v[1]].forEach(w=>{w[0]+=y[0],w[1]+=y[1],w[2]+=y[2]}):u&&[v[2],v[3]].forEach(w=>{w[0]+=y[0],w[1]+=y[1],w[2]+=y[2]}),o.invalidated=!0}else{const{currentPoints:m}=i,y=m.world;h.handles.points[l]=[...y],o.invalidated=!0}this.editData.hasMoved=!0;const p=Xe(a),{renderingEngine:g}=p;at(s),o.invalidated&&Un(o,a,xn.HandlesUpdated)},this.cancel=r=>{if(!this.isDrawing)return;this.isDrawing=!1,this._deactivateDraw(r),this._deactivateModify(r),qn(r);const{annotation:i,viewportIdsToRender:a,newAnnotation:o}=this.editData,{data:s}=i;s.handles.points.length<4&&_r(i.annotationUID),i.highlighted=!1,s.handles.activeHandleIndex=null;const l=Xe(r),{renderingEngine:c}=l;return at(a),o&&Xr(i),this.editData=null,this.angleStartedNotYetCompleted=!1,i.annotationUID},this._activateModify=r=>{Dt.isInteractingWithTool=!0,r.addEventListener(ee.MOUSE_UP,this._endCallback),r.addEventListener(ee.MOUSE_DRAG,this._dragCallback),r.addEventListener(ee.MOUSE_CLICK,this._endCallback),r.addEventListener(ee.TOUCH_END,this._endCallback),r.addEventListener(ee.TOUCH_DRAG,this._dragCallback),r.addEventListener(ee.TOUCH_START,this._mouseDownCallback),r.addEventListener(ee.TOUCH_TAP,this._endCallback)},this._deactivateModify=r=>{Dt.isInteractingWithTool=!1,r.removeEventListener(ee.MOUSE_UP,this._endCallback),r.removeEventListener(ee.MOUSE_DRAG,this._dragCallback),r.removeEventListener(ee.MOUSE_CLICK,this._endCallback),r.removeEventListener(ee.TOUCH_END,this._endCallback),r.removeEventListener(ee.TOUCH_DRAG,this._dragCallback),r.removeEventListener(ee.TOUCH_START,this._mouseDownCallback),r.removeEventListener(ee.TOUCH_TAP,this._endCallback)},this._activateDraw=r=>{Dt.isInteractingWithTool=!0,r.addEventListener(ee.MOUSE_UP,this._endCallback),r.addEventListener(ee.MOUSE_DRAG,this._dragCallback),r.addEventListener(ee.MOUSE_MOVE,this._dragCallback),r.addEventListener(ee.MOUSE_CLICK,this._endCallback),r.addEventListener(ee.MOUSE_DOWN,this._mouseDownCallback),r.addEventListener(ee.TOUCH_END,this._endCallback),r.addEventListener(ee.TOUCH_DRAG,this._dragCallback),r.addEventListener(ee.TOUCH_START,this._mouseDownCallback),r.addEventListener(ee.TOUCH_TAP,this._endCallback)},this._deactivateDraw=r=>{Dt.isInteractingWithTool=!1,r.removeEventListener(ee.MOUSE_UP,this._endCallback),r.removeEventListener(ee.MOUSE_DRAG,this._dragCallback),r.removeEventListener(ee.MOUSE_MOVE,this._dragCallback),r.removeEventListener(ee.MOUSE_CLICK,this._endCallback),r.removeEventListener(ee.MOUSE_DOWN,this._mouseDownCallback),r.removeEventListener(ee.TOUCH_END,this._endCallback),r.removeEventListener(ee.TOUCH_DRAG,this._dragCallback),r.removeEventListener(ee.TOUCH_START,this._mouseDownCallback),r.removeEventListener(ee.TOUCH_TAP,this._endCallback)},this.renderAnnotation=(r,i)=>{let a=!1;const{viewport:o}=r,{element:s}=o;let l=Zi(this.getToolName(),s);if(!l?.length||(l=this.filterInteractableAnnotationsForElement(s,l),!l?.length))return a;const c=this.getTargetId(o),f=o.getRenderingEngine(),u={toolGroupId:this.toolGroupId,toolName:this.getToolName(),viewportId:r.viewport.id};for(let d=0;d<l.length;d++){const h=l[d],{annotationUID:p,data:g}=h,{points:m,activeHandleIndex:y}=g.handles;u.annotationUID=p;const{color:v,lineWidth:x,lineDash:w}=this.getAnnotationStyle({annotation:h,styleSpecifier:u}),S=m.map(we=>o.worldToCanvas(we));!g.cachedStats[c]||g.cachedStats[c].angle==null?(g.cachedStats[c]={angle:null,arc1Angle:null,arc2Angle:null,points:{world:{arc1Start:null,arc1End:null,arc2Start:null,arc2End:null,arc1Angle:null,arc2Angle:null},canvas:{arc1Start:null,arc1End:null,arc2Start:null,arc2End:null,arc1Angle:null,arc2Angle:null}}},this._calculateCachedStats(h,f,r)):h.invalidated&&this._throttledCalculateCachedStats(h,f,r);let T;if(!yo(p)&&!this.editData&&y!==null&&(T=[S[y]]),!o.getRenderingEngine())return console.warn("Rendering Engine has been destroyed"),a;if(!xo(p))continue;T&&bo(i,p,"0",S,{color:v,lineDash:w,lineWidth:x});const _=[S[0],S[1]],D=[S[2],S[3]];let I="line1";if(Va(i,p,I,_[0],_[1],{color:v,width:x,lineDash:w}),a=!0,S.length<4)return a;I="line2",Va(i,p,I,D[0],D[1],{color:v,width:x,lineDash:w}),I="linkLine";const R=cf(_[0],_[1]),O=cf(D[0],D[1]);Va(i,p,I,R,O,{color:v,lineWidth:"1",lineDash:"1,4"});const{arc1Start:P,arc1End:N,arc2End:A,arc2Start:B}=g.cachedStats[c].points.canvas,{arc1Angle:V,arc2Angle:$}=g.cachedStats[c];if(this.configuration.showArcLines&&(I="arc1",Va(i,p,I,P,N,{color:v,lineWidth:"1"}),I="arc2",Va(i,p,I,B,A,{color:v,lineWidth:"1"})),!g.cachedStats[c]?.angle)continue;const U=this.getLinkedTextBoxStyle(u,h);if(!U.visibility){g.handles.textBox={hasMoved:!1,worldPosition:[0,0,0],worldBoundingBox:{topLeft:[0,0,0],topRight:[0,0,0],bottomLeft:[0,0,0],bottomRight:[0,0,0]}};continue}const G=this.configuration.getTextLines(g,c);if(!g.handles.textBox.hasMoved){const we=Iu(S);g.handles.textBox.worldPosition=o.canvasToWorld(we)}const F=o.worldToCanvas(g.handles.textBox.worldPosition),Q=cl(i,p,"cobbAngleText",G,F,S,{},U),{x:ne,y:ye,width:ve,height:Ce}=Q;if(g.handles.textBox.worldBoundingBox={topLeft:o.canvasToWorld([ne,ye]),topRight:o.canvasToWorld([ne+ve,ye]),bottomLeft:o.canvasToWorld([ne,ye+Ce]),bottomRight:o.canvasToWorld([ne+ve,ye+Ce])},this.configuration.showArcLines){const we="arcAngle1",Ae=[`${V.toFixed(2)} °`],Me=cf(P,N);sy(i,p,we,Ae,Me,{...U,padding:3});const q="arcAngle2",k=[`${$.toFixed(2)} °`],Y=cf(B,A);sy(i,p,q,k,Y,{...U,padding:3})}}return a},this.distanceToLines=({viewport:r,points:i,canvasCoords:a,proximity:o})=>{const[s,l,c,f]=i,u=r.worldToCanvas(s),d=r.worldToCanvas(l),h=r.worldToCanvas(c),p=r.worldToCanvas(f),g={start:{x:u[0],y:u[1]},end:{x:d[0],y:d[1]}},m={start:{x:h[0],y:h[1]},end:{x:p[0],y:p[1]}},y=Ll([g.start.x,g.start.y],[g.end.x,g.end.y],[a[0],a[1]]),v=Ll([m.start.x,m.start.y],[m.end.x,m.end.y],[a[0],a[1]]);let x=!1,w=!1;return y<=o?x=!0:v<=o&&(w=!0),{distanceToPoint:y,distanceToPoint2:v,isNearFirstLine:x,isNearSecondLine:w}},this.getArcsStartEndPoints=({firstLine:r,secondLine:i,mid1:a,mid2:o})=>{const s=[a,o],l=mw(r,s),c=mw(i,s),f=l>90?1:0,u=c>90?0:1,d=cf(s[0],s[1]),h=Math.sqrt((s[1][0]-s[0][0])**2+(s[1][1]-s[0][1])**2),p=.1,g=cf(r[0],r[1]),m=cf(i[0],i[1]),y=[r[f][0]-g[0],r[f][1]-g[1]],v=Math.sqrt(y[0]**2+y[1]**2),x=[y[0]/v,y[1]/v],w=[g[0]+x[0]*h*p,g[1]+x[1]*h*p],S=[d[0]-a[0],d[1]-a[1]],T=Math.sqrt(S[0]**2+S[1]**2),_=[S[0]/T,S[1]/T],D=[a[0]+_[0]*h*p,a[1]+_[1]*h*p],I=[i[u][0]-m[0],i[u][1]-m[1]],R=Math.sqrt(I[0]**2+I[1]**2),O=[I[0]/R,I[1]/R],P=[m[0]+O[0]*h*p,m[1]+O[1]*h*p],N=[d[0]-o[0],d[1]-o[1]],A=Math.sqrt(N[0]**2+N[1]**2),B=[N[0]/A,N[1]/A],V=[o[0]+B[0]*h*p,o[1]+B[1]*h*p];return{arc1Start:w,arc1End:D,arc2Start:P,arc2End:V,arc1Angle:l>90?180-l:l,arc2Angle:c>90?180-c:c}},this._throttledCalculateCachedStats=Wl(this._calculateCachedStats,25,{trailing:!0})}handleSelectedCallback(e,n,r,i="mouse"){const a=e.detail,{element:o}=a,{data:s}=n;n.highlighted=!0;let l=!1,c;r.worldPosition?l=!0:c=s.handles.points.findIndex(u=>u===r);const f=fn(o,this.getToolName());this.editData={annotation:n,viewportIdsToRender:f,handleIndex:c,movingTextBox:l},this._activateModify(o),Rn(o),at(f),e.preventDefault()}_calculateCachedStats(e,n,r){const i=e.data;if(i.handles.points.length!==4)return;const a=[null,null],o=[null,null];let s=Number.MAX_VALUE;for(let D=0;D<2;D+=1)for(let I=2;I<4;I+=1){const R=ol(i.handles.points[D],i.handles.points[I]);R<s&&(s=R,a[1]=i.handles.points[D],a[0]=i.handles.points[(D+1)%2],o[0]=i.handles.points[I],o[1]=i.handles.points[2+(I-1)%2])}const{viewport:l}=r,{element:c}=l,f=i.handles.points.map(D=>l.worldToCanvas(D)),u=[f[0],f[1]],d=[f[2],f[3]],h=cf(u[0],u[1]),p=cf(d[0],d[1]),{arc1Start:g,arc1End:m,arc2End:y,arc2Start:v,arc1Angle:x,arc2Angle:w}=this.getArcsStartEndPoints({firstLine:u,secondLine:d,mid1:h,mid2:p}),{cachedStats:S}=i,T=Object.keys(S);for(let D=0;D<T.length;D++){const I=T[D];S[I]={angle:mw(a,o),arc1Angle:x,arc2Angle:w,points:{canvas:{arc1Start:g,arc1End:m,arc2End:y,arc2Start:v},world:{arc1Start:l.canvasToWorld(g),arc1End:l.canvasToWorld(m),arc2End:l.canvasToWorld(y),arc2Start:l.canvasToWorld(v)}}}}const _=e.invalidated;return e.invalidated=!1,_&&Un(e,c,xn.StatsUpdated),S}};yM.toolName="CobbAngle";let Tg=yM;function Ije(t,e){const n=t.cachedStats[e],{angle:r}=n;return r===void 0?void 0:[`${r.toFixed(2)} °`]}const{transformWorldToIndex:yB}=Yr,xM=class xM extends la{constructor(e={},n={supportedInteractionTypes:["Mouse","Touch"],configuration:{shadow:!0,preventHandleOutsideImage:!1,getTextLines:Rje,displayBothAxesDistances:!1}}){super(e,n),this.addNewAnnotation=r=>{if(this.startedDrawing)return;this.startedDrawing=!0;const i=r.detail,{currentPoints:a,element:o}=i,s=a.world,l=Xe(o),{viewport:c,renderingEngine:f}=l;if(!(c instanceof fa))throw new Error("UltrasoundDirectionalTool can only be used on a StackViewport");Rn(o),this.isDrawing=!0;const u=c.getCamera(),{viewPlaneNormal:d,viewUp:h}=u,p=this.getReferencedImageId(c,s,d,h),g=c.getFrameOfReferenceUID(),m={highlighted:!0,invalidated:!0,metadata:{toolName:this.getToolName(),viewPlaneNormal:[...d],viewUp:[...h],FrameOfReferenceUID:g,referencedImageId:p},data:{handles:{points:[[...s],[...s]],activeHandleIndex:null,textBox:{hasMoved:!1,worldPosition:[0,0,0],worldBoundingBox:{topLeft:[0,0,0],topRight:[0,0,0],bottomLeft:[0,0,0],bottomRight:[0,0,0]}}},label:"",cachedStats:{}}};mr(m,o);const y=fn(o,this.getToolName());return this.editData={annotation:m,viewportIdsToRender:y,handleIndex:1,movingTextBox:!1,newAnnotation:!0,hasMoved:!1},this._activateDraw(o),r.preventDefault(),at(y),m},this.isPointNearTool=(r,i,a,o)=>{const s=Xe(r),{viewport:l}=s,{data:c}=i,[f,u]=c.handles.points,d=l.worldToCanvas(f),h=l.worldToCanvas(u),p={start:{x:d[0],y:d[1]},end:{x:h[0],y:h[1]}};return Ll([p.start.x,p.start.y],[p.end.x,p.end.y],[a[0],a[1]])<=o},this._endCallback=r=>{const i=r.detail,{element:a}=i,{annotation:o,viewportIdsToRender:s,newAnnotation:l,hasMoved:c}=this.editData,{data:f}=o;if(l&&!c)return;if(this.startedDrawing&&f.handles.points.length===1){this.editData.handleIndex=1;return}this.startedDrawing=!1,f.handles.activeHandleIndex=null,this._deactivateModify(a),this._deactivateDraw(a),qn(a);const u=Xe(a),{renderingEngine:d}=u;this.isHandleOutsideImage&&this.configuration.preventHandleOutsideImage&&_r(o.annotationUID),at(s),l&&Xr(o),this.editData=null,this.isDrawing=!1},this._dragCallback=r=>{this.isDrawing=!0;const i=r.detail,{element:a}=i,{annotation:o,viewportIdsToRender:s,handleIndex:l,movingTextBox:c}=this.editData,{data:f}=o;if(c){const{deltaPoints:h}=i,p=h.world,{textBox:g}=f.handles,{worldPosition:m}=g;m[0]+=p[0],m[1]+=p[1],m[2]+=p[2],g.hasMoved=!0}else if(l===void 0){const{deltaPoints:h}=i,p=h.world;f.handles.points.forEach(m=>{m[0]+=p[0],m[1]+=p[1],m[2]+=p[2]}),o.invalidated=!0}else{const{currentPoints:h}=i,p=h.world;f.handles.points[l]=[...p],o.invalidated=!0}this.editData.hasMoved=!0;const u=Xe(a),{renderingEngine:d}=u;at(s)},this.cancel=r=>{if(this.isDrawing){this.isDrawing=!1,this._deactivateDraw(r),this._deactivateModify(r),qn(r);const{annotation:i,viewportIdsToRender:a,newAnnotation:o}=this.editData,{data:s}=i;return i.highlighted=!1,s.handles.activeHandleIndex=null,at(a),o&&Xr(i),this.editData=null,this.startedDrawing=!1,i.annotationUID}},this._activateModify=r=>{Dt.isInteractingWithTool=!0,r.addEventListener(ee.MOUSE_UP,this._endCallback),r.addEventListener(ee.MOUSE_DRAG,this._dragCallback),r.addEventListener(ee.MOUSE_CLICK,this._endCallback),r.addEventListener(ee.TOUCH_TAP,this._endCallback),r.addEventListener(ee.TOUCH_END,this._endCallback),r.addEventListener(ee.TOUCH_DRAG,this._dragCallback)},this._deactivateModify=r=>{Dt.isInteractingWithTool=!1,r.removeEventListener(ee.MOUSE_UP,this._endCallback),r.removeEventListener(ee.MOUSE_DRAG,this._dragCallback),r.removeEventListener(ee.MOUSE_CLICK,this._endCallback),r.removeEventListener(ee.TOUCH_TAP,this._endCallback),r.removeEventListener(ee.TOUCH_END,this._endCallback),r.removeEventListener(ee.TOUCH_DRAG,this._dragCallback)},this._activateDraw=r=>{Dt.isInteractingWithTool=!0,r.addEventListener(ee.MOUSE_UP,this._endCallback),r.addEventListener(ee.MOUSE_DRAG,this._dragCallback),r.addEventListener(ee.MOUSE_MOVE,this._dragCallback),r.addEventListener(ee.MOUSE_CLICK,this._endCallback),r.addEventListener(ee.TOUCH_TAP,this._endCallback),r.addEventListener(ee.TOUCH_END,this._endCallback),r.addEventListener(ee.TOUCH_DRAG,this._dragCallback)},this._deactivateDraw=r=>{Dt.isInteractingWithTool=!1,r.removeEventListener(ee.MOUSE_UP,this._endCallback),r.removeEventListener(ee.MOUSE_DRAG,this._dragCallback),r.removeEventListener(ee.MOUSE_MOVE,this._dragCallback),r.removeEventListener(ee.MOUSE_CLICK,this._endCallback),r.removeEventListener(ee.TOUCH_TAP,this._endCallback),r.removeEventListener(ee.TOUCH_END,this._endCallback),r.removeEventListener(ee.TOUCH_DRAG,this._dragCallback)},this.renderAnnotation=(r,i)=>{let a=!1;const{viewport:o}=r,{element:s}=o;let l=Zi(this.getToolName(),s);if(!l?.length||(l=this.filterInteractableAnnotationsForElement(s,l),!l?.length))return a;const c=this.getTargetId(o),f=o.getRenderingEngine(),u={toolGroupId:this.toolGroupId,toolName:this.getToolName(),viewportId:r.viewport.id};for(let d=0;d<l.length;d++){const h=l[d],{annotationUID:p,data:g}=h,{points:m}=g.handles;u.annotationUID=p;const y=this.getStyle("color",u,h),v=m.map(A=>o.worldToCanvas(A));if(!g.cachedStats[c]||g.cachedStats[c].xValues==null?(g.cachedStats[c]={xValues:[0,0],yValues:[0,0],isHorizontal:!1,units:[""],isUnitless:!1},this._calculateCachedStats(h,f,r)):h.invalidated&&this._throttledCalculateCachedStats(h,f,r),!o.getRenderingEngine())return console.warn("Rendering Engine has been destroyed"),a;let x="0";if(c9(i,p,x,v[0],{color:y},0),a=!0,v.length!==2)return a;if(x="1",c9(i,p,x,v[1],{color:y},1),g.cachedStats[c].isUnitless){const A=`${p}-line-1`;Va(i,p,"1",v[0],v[1],{color:y,width:1,shadow:this.configuration.shadow},A)}else{const A=v[0],B=v[1],V=B[1]-A[1],$=B[0]-A[0],U=g.cachedStats[c].isHorizontal;let G=[0,0];U?G=[A[0]+$,A[1]]:G=[A[0],A[1]+V];let F=`${p}-line-1`,J="1";Va(i,p,J,v[0],G,{color:y,width:1,shadow:this.configuration.shadow},F),F=`${p}-line-2`,J="2",Va(i,p,J,v[1],G,{color:y,width:1,lineDash:[1,1],shadow:this.configuration.shadow},F)}const S=this.getLinkedTextBoxStyle(u,h);if(!S.visibility){g.handles.textBox={hasMoved:!1,worldPosition:[0,0,0],worldBoundingBox:{topLeft:[0,0,0],topRight:[0,0,0],bottomLeft:[0,0,0],bottomRight:[0,0,0]}};continue}const T=this.configuration.getTextLines(g,c,this.configuration);if(!g.handles.textBox.hasMoved){const A=v[1];g.handles.textBox.worldPosition=o.canvasToWorld(A)}const _=o.worldToCanvas(g.handles.textBox.worldPosition),I=cl(i,p,"1",T,_,v,{},S),{x:R,y:O,width:P,height:N}=I;g.handles.textBox.worldBoundingBox={topLeft:o.canvasToWorld([R,O]),topRight:o.canvasToWorld([R+P,O]),bottomLeft:o.canvasToWorld([R,O+N]),bottomRight:o.canvasToWorld([R+P,O+N])}}return a},this._throttledCalculateCachedStats=Wl(this._calculateCachedStats,100,{trailing:!0})}toolSelectedCallback(e,n,r,i){}handleSelectedCallback(e,n,r){const i=e.detail,{element:a}=i,{data:o}=n;n.highlighted=!0;const s=fn(a,this.getToolName());let l;r.worldPosition||(l=o.handles.points.findIndex(u=>u===r)),this.editData={handleIndex:l,annotation:n,viewportIdsToRender:s},this._activateModify(a),Rn(a);const c=Xe(a),{renderingEngine:f}=c;at(s),e.preventDefault()}_calculateCachedStats(e,n,r){const i=e.data,{element:a}=r.viewport;if(i.handles.points.length!==2)return;const{cachedStats:o}=i,s=Object.keys(o);for(let c=0;c<s.length;c++){const f=s[c],u=this.getTargetImageData(f);if(!u)continue;const{imageData:d}=u,h=i.handles.points[0],p=i.handles.points[1],g=yB(d,h),m=yB(d,p),{values:y,units:v}=f9(u,[g]),{values:x,units:w}=f9(u,[m]);let S,T,_,D,I=!1;if(v[0]!==w[0]||v[1]!==w[1]||v[0]==="raw"&&w[0]==="raw"){const R=Qh(h,p);S=[R,0],T=[R,0],_=["px"],I=!0}else{const R=r.viewport.worldToCanvas(h),O=r.viewport.worldToCanvas(p),P=O[1]-R[1],N=O[0]-R[0];D=Math.abs(N)>Math.abs(P),S=[y[0],x[0]],T=[y[1],x[1]],_=[v[0],v[1]]}o[f]={xValues:S,yValues:T,isHorizontal:D,units:_,isUnitless:I}}const l=e.invalidated;return e.invalidated=!1,l&&Un(e,a,xn.StatsUpdated),o}};xM.toolName="UltrasoundDirectionalTool";let Eg=xM;function Rje(t,e,n){const r=t.cachedStats[e],{xValues:i,yValues:a,units:o,isUnitless:s,isHorizontal:l}=r;if(s)return[`${Vn(i[0])} px`];if(n.displayBothAxesDistances){const c=Math.abs(i[1]-i[0]),f=Math.abs(a[1]-a[0]);return[`${Vn(c)} ${o[0]}`,`${Vn(f)} ${o[1]}`]}if(l){const c=Math.abs(i[1]-i[0]);return[`${Vn(c)} ${o[0]}`]}else{const c=Math.abs(a[1]-a[0]);return[`${Vn(c)} ${o[1]}`]}}function Pje(t,e,n=!0){const r=Object.assign({},e,{segmentIndex:0});nre(t,r)}function Aje(t,e){Pje(t,e,!0)}class $v extends Cm{constructor(e={},n={supportedInteractionTypes:["Mouse","Touch"],configuration:{strategies:{FILL_INSIDE:nre,ERASE_INSIDE:Aje},defaultStrategy:"FILL_INSIDE",activeStrategy:"FILL_INSIDE"}}){super(e,n),this.preMouseDownCallback=r=>{if(this.isDrawing===!0)return;const i=r.detail,{currentPoints:a,element:o}=i,s=a.world,l=Xe(o),{viewport:c}=l;this.isDrawing=!0;const f=c.getCamera(),{viewPlaneNormal:u,viewUp:d}=f,h=xS(c.id);if(!h)throw new Error("No active segmentation detected, create one before using scissors tool");const{segmentationId:p}=h,g=Su(p),m=qy(p),y=Wh(c.id,p,g),{representationData:v}=ea(p),x=v[hn.Labelmap],w={highlighted:!0,invalidated:!0,metadata:{viewPlaneNormal:[...u],viewUp:[...d],FrameOfReferenceUID:c.getFrameOfReferenceUID(),referencedImageId:"",toolName:this.getToolName(),segmentColor:y},data:{handles:{points:[[...s],[...s],[...s],[...s]],activeHandleIndex:null}}},S=fn(o,this.getToolName());if(this.editData={annotation:w,segmentIndex:g,segmentationId:p,segmentsLocked:m,segmentColor:y,viewportIdsToRender:S,handleIndex:3,movingTextBox:!1,newAnnotation:!0,hasMoved:!1,volumeId:null,referencedVolumeId:null,imageId:null},c instanceof mo){const{volumeId:T}=x,_=yt.getVolume(T);this.editData={...this.editData,volumeId:T,referencedVolumeId:_.referencedVolumeId}}else{const T=yS(c.id,p);this.editData={...this.editData,imageId:T}}return this._activateDraw(o),Rn(o),r.preventDefault(),at(S),!0},this._dragCallback=r=>{this.isDrawing=!0;const i=r.detail,{element:a}=i,{annotation:o,viewportIdsToRender:s,handleIndex:l}=this.editData,{data:c}=o,{currentPoints:f}=i,u=Xe(a),{worldToCanvas:d,canvasToWorld:h}=u.viewport,p=f.world,{points:g}=c.handles;g[l]=[...p];let m,y,v,x,w,S,T,_;switch(l){case 0:case 3:m=d(g[0]),x=d(g[3]),y=[x[0],m[1]],v=[m[0],x[1]],S=h(y),T=h(v),g[1]=S,g[2]=T;break;case 1:case 2:y=d(g[1]),v=d(g[2]),m=[v[0],y[1]],x=[y[0],v[1]],w=h(m),_=h(x),g[0]=w,g[3]=_;break}o.invalidated=!0,this.editData.hasMoved=!0,at(s)},this._endCallback=r=>{const i=r.detail,{element:a}=i,{annotation:o,newAnnotation:s,hasMoved:l}=this.editData,{data:c}=o;if(s&&!l)return;c.handles.activeHandleIndex=null,this._deactivateDraw(a),qn(a);const f=Xe(a),u={...this.editData,points:c.handles.points,createMemo:this.createMemo.bind(this)};this.editData=null,this.isDrawing=!1,this.applyActiveStrategy(f,u),this.doneEditMemo()},this._activateDraw=r=>{r.addEventListener(ee.MOUSE_UP,this._endCallback),r.addEventListener(ee.MOUSE_DRAG,this._dragCallback),r.addEventListener(ee.MOUSE_MOVE,this._dragCallback),r.addEventListener(ee.MOUSE_CLICK,this._endCallback),r.addEventListener(ee.TOUCH_END,this._endCallback),r.addEventListener(ee.TOUCH_DRAG,this._dragCallback),r.addEventListener(ee.TOUCH_TAP,this._endCallback)},this._deactivateDraw=r=>{r.removeEventListener(ee.MOUSE_UP,this._endCallback),r.removeEventListener(ee.MOUSE_DRAG,this._dragCallback),r.removeEventListener(ee.MOUSE_MOVE,this._dragCallback),r.removeEventListener(ee.MOUSE_CLICK,this._endCallback),r.removeEventListener(ee.TOUCH_TAP,this._endCallback),r.removeEventListener(ee.TOUCH_END,this._endCallback),r.removeEventListener(ee.TOUCH_DRAG,this._dragCallback)},this.renderAnnotation=(r,i)=>{let a=!1;if(!this.editData)return a;const{viewport:o}=r,{annotation:s}=this.editData,l=s.metadata,c=s.annotationUID,f=s.data,{points:u}=f.handles,d=u.map(g=>o.worldToCanvas(g)),h=`rgb(${l.segmentColor.slice(0,3)})`;return o.getRenderingEngine()?(BO(i,c,"0",d[0],d[3],{color:h}),a=!0,a):(console.warn("Rendering Engine has been destroyed"),a)}}}$v.toolName="RectangleScissor";class Gv extends Cm{constructor(e={},n={supportedInteractionTypes:["Mouse","Touch"],configuration:{strategies:{FILL_INSIDE:ZO,ERASE_INSIDE:Qne},defaultStrategy:"FILL_INSIDE",activeStrategy:"FILL_INSIDE"}}){super(e,n),this.preMouseDownCallback=r=>{if(this.isDrawing===!0)return;const i=r.detail,{currentPoints:a,element:o}=i,s=a.world,l=a.canvas,c=Xe(o),{viewport:f}=c;this.isDrawing=!0;const u=f.getCamera(),{viewPlaneNormal:d,viewUp:h}=u,p=xS(f.id);if(!p)throw new Error("No active segmentation detected, create one before using scissors tool");const{segmentationId:g}=p,m=Su(g),y=qy(g),v=Wh(f.id,g,m),{representationData:x}=ea(g),w=x.Labelmap;if(!w)throw new Error("No labelmap data found for the active segmentation, create one before using scissors tool");const S={invalidated:!0,highlighted:!0,metadata:{viewPlaneNormal:[...d],viewUp:[...h],FrameOfReferenceUID:f.getFrameOfReferenceUID(),referencedImageId:"",toolName:this.getToolName(),segmentColor:v},data:{handles:{points:[[...s],[...s],[...s],[...s]],activeHandleIndex:null},isDrawing:!0,cachedStats:{}}},T=[f.id];if(this.editData={annotation:S,centerCanvas:l,segmentIndex:m,segmentationId:g,segmentsLocked:y,segmentColor:v,viewportIdsToRender:T,handleIndex:3,movingTextBox:!1,newAnnotation:!0,hasMoved:!1,volumeId:null,referencedVolumeId:null,imageId:null},f instanceof mo){const{volumeId:_}=w,D=yt.getVolume(_);this.editData={...this.editData,volumeId:_,referencedVolumeId:D.referencedVolumeId}}else{const _=yS(f.id,g);this.editData={...this.editData,imageId:_}}return this._activateDraw(o),Rn(o),r.preventDefault(),at(T),!0},this._dragCallback=r=>{this.isDrawing=!0;const i=r.detail,{element:a}=i,{currentPoints:o}=i,s=o.canvas,l=Xe(a),{renderingEngine:c,viewport:f}=l,{canvasToWorld:u}=f,{annotation:d,viewportIdsToRender:h,centerCanvas:p}=this.editData,{data:g}=d,m=Math.abs(s[0]-p[0]),y=Math.abs(s[1]-p[1]),v=Math.sqrt(m*m+y*y),x=[p[0],p[1]+v],w=[p[0],p[1]-v],S=[p[0]-v,p[1]],T=[p[0]+v,p[1]];g.handles.points=[u(x),u(w),u(S),u(T)],d.invalidated=!0,this.editData.hasMoved=!0,at(h)},this._endCallback=r=>{const i=r.detail,{element:a}=i,{annotation:o,newAnnotation:s,hasMoved:l}=this.editData,{data:c}=o,{viewPlaneNormal:f,viewUp:u}=o.metadata;if(s&&!l)return;c.handles.activeHandleIndex=null,this._deactivateDraw(a),qn(a);const d=Xe(a),h={...this.editData,points:c.handles.points,viewPlaneNormal:f,viewUp:u,createMemo:this.createMemo.bind(this)};this.editData=null,this.isDrawing=!1,this.applyActiveStrategy(d,h),this.doneEditMemo()},this._activateDraw=r=>{r.addEventListener(ee.MOUSE_UP,this._endCallback),r.addEventListener(ee.MOUSE_DRAG,this._dragCallback),r.addEventListener(ee.MOUSE_CLICK,this._endCallback),r.addEventListener(ee.MOUSE_MOVE,this._dragCallback),r.addEventListener(ee.TOUCH_TAP,this._endCallback),r.addEventListener(ee.TOUCH_DRAG,this._dragCallback),r.addEventListener(ee.TOUCH_END,this._endCallback)},this._deactivateDraw=r=>{r.removeEventListener(ee.MOUSE_UP,this._endCallback),r.removeEventListener(ee.MOUSE_DRAG,this._dragCallback),r.removeEventListener(ee.MOUSE_CLICK,this._endCallback),r.removeEventListener(ee.MOUSE_MOVE,this._dragCallback),r.removeEventListener(ee.TOUCH_END,this._endCallback),r.removeEventListener(ee.TOUCH_DRAG,this._dragCallback),r.removeEventListener(ee.TOUCH_TAP,this._endCallback)},this.renderAnnotation=(r,i)=>{let a=!1;if(!this.editData)return a;const{viewport:o}=r,{viewportIdsToRender:s}=this.editData;if(!s.includes(o.id))return a;const{annotation:l}=this.editData,c=l.metadata,f=l.annotationUID,u=l.data,{points:d}=u.handles,h=d.map(w=>o.worldToCanvas(w)),p=h[0],g=h[1],m=[Math.floor((p[0]+g[0])/2),Math.floor((p[1]+g[1])/2)],y=Math.abs(p[1]-Math.floor((p[1]+g[1])/2)),v=`rgb(${c.segmentColor.slice(0,3)})`;return o.getRenderingEngine()?(h0(i,f,"0",m,y,{color:v}),a=!0,a):(console.warn("Rendering Engine has been destroyed"),a)}}}Gv.toolName="CircleScissor";class jv extends Cm{constructor(e={},n={supportedInteractionTypes:["Mouse","Touch"],configuration:{strategies:{FILL_INSIDE:Jne,ERASE_INSIDE:Zne},defaultStrategy:"FILL_INSIDE",activeStrategy:"FILL_INSIDE"}}){super(e,n),this.preMouseDownCallback=r=>{if(this.isDrawing===!0)return;this.doneEditMemo();const i=r.detail,{currentPoints:a,element:o}=i,s=a.world,l=a.canvas,c=Xe(o),{viewport:f}=c;this.isDrawing=!0;const u=f.getCamera(),{viewPlaneNormal:d,viewUp:h}=u,p=xS(f.id);if(!p)throw new Error("No active segmentation detected, create one before using scissors tool");const{segmentationId:g}=p,m=Su(g),y=qy(g),v=Wh(f.id,g,m);this.isDrawing=!0;const x={metadata:{viewPlaneNormal:[...d],viewUp:[...h],FrameOfReferenceUID:f.getFrameOfReferenceUID(),referencedImageId:"",toolName:this.getToolName(),segmentColor:v},data:{invalidated:!0,handles:{points:[[...s],[...s],[...s],[...s]],activeHandleIndex:null},cachedStats:{},highlighted:!0}},w=[f.id];this.editData={annotation:x,centerCanvas:l,segmentIndex:m,segmentationId:g,segmentsLocked:y,segmentColor:v,toolGroupId:this.toolGroupId,viewportIdsToRender:w,handleIndex:3,movingTextBox:!1,newAnnotation:!0,hasMoved:!1,volumeId:null,referencedVolumeId:null,imageId:null};const{representationData:S}=ea(g),T=this.getEditData({viewport:f,representationData:S,segmentsLocked:y,segmentationId:g});return this.editData={...this.editData,...T},this._activateDraw(o),Rn(o),r.preventDefault(),at(w),!0},this._dragCallback=r=>{this.isDrawing=!0;const i=r.detail,{element:a}=i,{currentPoints:o}=i,s=o.canvas,l=Xe(a),{renderingEngine:c,viewport:f}=l,{canvasToWorld:u}=f,{annotation:d,viewportIdsToRender:h,centerCanvas:p}=this.editData,{data:g}=d,m=Math.abs(s[0]-p[0]),y=Math.abs(s[1]-p[1]),v=Math.sqrt(m*m+y*y),x=[p[0],p[1]+v],w=[p[0],p[1]-v],S=[p[0]-v,p[1]],T=[p[0]+v,p[1]];g.handles.points=[u(x),u(w),u(S),u(T)],d.invalidated=!0,this.editData.hasMoved=!0,at(h)},this._endCallback=r=>{const i=r.detail,{element:a}=i,{annotation:o,newAnnotation:s,hasMoved:l,segmentIndex:c,segmentsLocked:f}=this.editData,{data:u}=o,{viewPlaneNormal:d,viewUp:h}=o.metadata;if(s&&!l)return;o.highlighted=!1,u.handles.activeHandleIndex=null,this._deactivateDraw(a),qn(a);const p=Xe(a),g={...this.editData,points:u.handles.points,segmentIndex:c,segmentsLocked:f,viewPlaneNormal:d,viewUp:h,createMemo:this.createMemo.bind(this)};this.editData=null,this.isDrawing=!1,this.applyActiveStrategy(p,g),this.doneEditMemo()},this._activateDraw=r=>{r.addEventListener(ee.MOUSE_UP,this._endCallback),r.addEventListener(ee.MOUSE_DRAG,this._dragCallback),r.addEventListener(ee.MOUSE_CLICK,this._endCallback),r.addEventListener(ee.MOUSE_MOVE,this._dragCallback),r.addEventListener(ee.TOUCH_END,this._endCallback),r.addEventListener(ee.TOUCH_TAP,this._endCallback),r.addEventListener(ee.TOUCH_DRAG,this._dragCallback)},this._deactivateDraw=r=>{r.removeEventListener(ee.MOUSE_UP,this._endCallback),r.removeEventListener(ee.MOUSE_DRAG,this._dragCallback),r.removeEventListener(ee.MOUSE_CLICK,this._endCallback),r.removeEventListener(ee.MOUSE_MOVE,this._dragCallback),r.removeEventListener(ee.TOUCH_END,this._endCallback),r.removeEventListener(ee.TOUCH_DRAG,this._dragCallback),r.removeEventListener(ee.TOUCH_TAP,this._endCallback)},this.renderAnnotation=(r,i)=>{let a=!1;if(!this.editData)return a;const{viewport:o}=r,{viewportIdsToRender:s}=this.editData;if(!s.includes(o.id))return a;const{annotation:l}=this.editData,c=l.metadata,f=l.annotationUID,u=l.data,{points:d}=u.handles,h=d.map(w=>o.worldToCanvas(w)),p=h[0],g=h[1],m=[Math.floor((p[0]+g[0])/2),Math.floor((p[1]+g[1])/2)],y=Math.abs(p[1]-Math.floor((p[1]+g[1])/2)),v=`rgb(${c.segmentColor.slice(0,3)})`;return o.getRenderingEngine()?(h0(i,f,"0",m,y,{color:v}),a=!0,a):(console.warn("Rendering Engine has been destroyed"),a)}}}jv.toolName="SphereScissor";function are(t,e,n){if(t===void 0)throw new Error("decodeRGB: rgbBuffer must be defined");if(t.length%3!==0)throw new Error(`decodeRGB: rgbBuffer length ${t.length} must be divisible by 3`);const r=t.length/3;let i=0,a=0;if(n){for(let o=0;o<r;o++)e[a++]=t[i++],e[a++]=t[i++],e[a++]=t[i++],e[a++]=255;return}e.set(t)}function ore(t,e,n){if(t===void 0)throw new Error("decodeRGB: rgbBuffer must be defined");if(t.length%3!==0)throw new Error(`decodeRGB: rgbBuffer length ${t.length} must be divisible by 3`);const r=t.length/3;let i=0,a=0,o=r,s=r*2;if(n)for(let l=0;l<r;l++)e[i++]=t[a++],e[i++]=t[o++],e[i++]=t[s++],e[i++]=255;else for(let l=0;l<r;l++)e[i++]=t[a++],e[i++]=t[o++],e[i++]=t[s++]}function sre(t,e,n){if(t===void 0)throw new Error("convertYBRFullByPixel: ybrBuffer must be defined");if(t.length%3!==0)throw new Error(`convertYBRFullByPixel: ybrBuffer length ${t.length} must be divisible by 3`);const r=t.length/3;let i=0,a=0;if(n){for(let o=0;o<r;o++){const s=t[i++],l=t[i++],c=t[i++];e[a++]=s+1.402*(c-128),e[a++]=s-.34414*(l-128)-.71414*(c-128),e[a++]=s+1.772*(l-128),e[a++]=255}return}for(let o=0;o<r;o++){const s=t[i++],l=t[i++],c=t[i++];e[a++]=s+1.402*(c-128),e[a++]=s-.34414*(l-128)-.71414*(c-128),e[a++]=s+1.772*(l-128)}}function lre(t,e,n){if(t===void 0)throw new Error("convertYBRFullByPlane: ybrBuffer must be defined");if(t.length%3!==0)throw new Error(`convertYBRFullByPlane: ybrBuffer length ${t.length} must be divisible by 3`);const r=t.length/3;let i=0,a=0,o=r,s=r*2;if(n){for(let l=0;l<r;l++){const c=t[a++],f=t[o++],u=t[s++];e[i++]=c+1.402*(u-128),e[i++]=c-.34414*(f-128)-.71414*(u-128),e[i++]=c+1.772*(f-128),e[i++]=255}return}for(let l=0;l<r;l++){const c=t[a++],f=t[o++],u=t[s++];e[i++]=c+1.402*(u-128),e[i++]=c-.34414*(f-128)-.71414*(u-128),e[i++]=c+1.772*(f-128)}}function Nje(t,e,n){if(t===void 0)throw new Error("convertYBRFull422ByPixel: ybrBuffer must be defined");if(t.length%2!==0)throw new Error(`convertYBRFull422ByPixel: ybrBuffer length ${t.length} must be divisible by 2`);const r=t.length/2;let i=0,a=0;if(n){for(let o=0;o<r;o+=2){const s=t[i++],l=t[i++],c=t[i++],f=t[i++];e[a++]=s+1.402*(f-128),e[a++]=s-.34414*(c-128)-.71414*(f-128),e[a++]=s+1.772*(c-128),e[a++]=255,e[a++]=l+1.402*(f-128),e[a++]=l-.34414*(c-128)-.71414*(f-128),e[a++]=l+1.772*(c-128),e[a++]=255}return}for(let o=0;o<r;o+=2){const s=t[i++],l=t[i++],c=t[i++],f=t[i++];e[a++]=s+1.402*(f-128),e[a++]=s-.34414*(c-128)-.71414*(f-128),e[a++]=s+1.772*(c-128),e[a++]=l+1.402*(f-128),e[a++]=l-.34414*(c-128)-.71414*(f-128),e[a++]=l+1.772*(c-128)}}function j8(t,e){const n=t.length,r=new Uint8ClampedArray(n);for(let i=0;i<n;++i)r[i]=t[i]>>e;return r}function z8(t,e,n){const r=t[`${e}PaletteColorLookupTableData`];if(r)return Promise.resolve(r);const i=Ut("imagePixelModule",t.imageId);return i&&typeof i.then=="function"?i.then(a=>a?a[`${e}PaletteColorLookupTableData`]:n):Promise.resolve(i?i[`${e}PaletteColorLookupTableData`]:n)}function cre(t,e,n){const r=t.columns*t.rows,i=t.pixelData;Promise.all([z8(t,"red",null),z8(t,"green",null),z8(t,"blue",null)]).then(([a,o,s])=>{if(!a||!o||!s)throw new Error("The image does not have a complete color palette. R, G, and B palette data are required.");const l=a.length;let c=0,f=0;const u=t.redPaletteColorLookupTableDescriptor[1],d=t.redPaletteColorLookupTableDescriptor[2]===8?0:8,h=j8(a,d),p=j8(o,d),g=j8(s,d);if(n){for(let m=0;m<r;++m){let y=i[c++];y<u?y=0:y>u+l-1?y=l-1:y-=u,e[f++]=h[y],e[f++]=p[y],e[f++]=g[y],e[f++]=255}return}for(let m=0;m<r;++m){let y=i[c++];y<u?y=0:y>u+l-1?y=l-1:y-=u,e[f++]=h[y],e[f++]=p[y],e[f++]=g[y]}})}function W8(t,e){if(!(!t.elements[e]||t.elements[e].length!==6))return[t.uint16(e,0),t.uint16(e,1),t.uint16(e,2)]}function H8(t,e,n){const r=[],i=t.elements[e];for(let a=0;a<n[0];a++)n[2]===16?r[a]=t.uint16(e,a):r[a]=t.byteArray[a+i.dataOffset];return r}function Lje(t,e){e.redPaletteColorLookupTableDescriptor=W8(t,"x00281101"),e.greenPaletteColorLookupTableDescriptor=W8(t,"x00281102"),e.bluePaletteColorLookupTableDescriptor=W8(t,"x00281103"),e.redPaletteColorLookupTableDescriptor[0]===0&&(e.redPaletteColorLookupTableDescriptor[0]=65536,e.greenPaletteColorLookupTableDescriptor[0]=65536,e.bluePaletteColorLookupTableDescriptor[0]=65536);const n=e.redPaletteColorLookupTableDescriptor[0],i=t.elements.x00281201.length===n?8:16;e.redPaletteColorLookupTableDescriptor[2]!==i&&(e.redPaletteColorLookupTableDescriptor[2]=i,e.greenPaletteColorLookupTableDescriptor[2]=i,e.bluePaletteColorLookupTableDescriptor[2]=i),e.redPaletteColorLookupTableData=H8(t,"x00281201",e.redPaletteColorLookupTableDescriptor),e.greenPaletteColorLookupTableData=H8(t,"x00281202",e.greenPaletteColorLookupTableDescriptor),e.bluePaletteColorLookupTableData=H8(t,"x00281203",e.bluePaletteColorLookupTableDescriptor)}function kje(t,e){t.uint16("x00280103")===0?(e.smallestPixelValue=t.uint16("x00280106"),e.largestPixelValue=t.uint16("x00280107")):(e.smallestPixelValue=t.int16("x00280106"),e.largestPixelValue=t.int16("x00280107"))}function ure(t){const e={samplesPerPixel:t.uint16("x00280002"),photometricInterpretation:t.string("x00280004"),rows:t.uint16("x00280010"),columns:t.uint16("x00280011"),bitsAllocated:t.uint16("x00280100"),bitsStored:t.uint16("x00280101"),highBit:t.uint16("x00280102"),pixelRepresentation:t.uint16("x00280103"),planarConfiguration:t.uint16("x00280006"),pixelAspectRatio:t.string("x00280034")};return kje(t,e),e.photometricInterpretation==="PALETTE COLOR"&&t.elements.x00281101&&Lje(t,e),e}function Vje(t,e){let n=e.uint16("x00283002",0);n===0&&(n=65535);let r=0;t===0?r=e.uint16("x00283002",1):r=e.int16("x00283002",1);const i=e.uint16("x00283002",2),a={id:"1",firstValueMapped:r,numBitsPerEntry:i,lut:[]};for(let o=0;o<n;o++)t===0?a.lut[o]=e.uint16("x00283006",o):a.lut[o]=e.int16("x00283006",o);return a}function m9(t,e){if(!e||!e.items||!e.items.length)return;const n=[];for(let r=0;r<e.items.length;r++){const i=e.items[r].dataSet,a=Vje(t,i);a&&n.push(a)}return n}function Fje(t){const e=t.uint16("x00280103"),n=t.uint16("x00280101");return e===0?0:-1<<n-1}function fre(t){const e=t.string("x00080016");if(e==="1.2.840.10008.5.1.4.1.1.2"||e==="1.2.840.10008.5.1.4.1.1.2.1")return 1;const n=t.floatString("x00281052"),r=t.floatString("x00281053");return n!==void 0&&r!==void 0?Fje(t)*r+n<0?1:0:t.elements.x00283000&&t.elements.x00283000.length>0?0:t.uint16("x00280103")}function Tc(t,e,n){const r=[],i=t.string(e);if(!i)return;const a=i.split("\\");if(!(n&&a.length<n)){for(let o=0;o<a.length;o++)r.push(parseFloat(a[o]));return r}}var yw={exports:{}};function dre(t){return t}function hre(t){return t}const Uje={inflateRawSync:dre,inflateRaw:hre},Bje=Object.freeze(Object.defineProperty({__proto__:null,default:Uje,inflateRaw:hre,inflateRawSync:dre},Symbol.toStringTag,{value:"Module"})),$je=jB(Bje);/*! dicom-parser - 1.8.12 - 2023-02-20 | (c) 2017 Chris Hafey | https://github.com/cornerstonejs/dicomParser */var Gje=yw.exports,xB;function jje(){return xB||(xB=1,(function(t,e){(function(n,r){t.exports=r($je)})(Gje,function(n){return i=[function(o,s){o.exports=n},function(o,s,l){l.r(s),l.d(s,"isStringVr",function(){return f}),l.d(s,"isPrivateTag",function(){return u}),l.d(s,"parsePN",function(){return d}),l.d(s,"parseTM",function(){return h}),l.d(s,"parseDA",function(){return g}),l.d(s,"explicitElementToString",function(){return m}),l.d(s,"explicitDataSetToJS",function(){return y}),l.d(s,"createJPEGBasicOffsetTable",function(){return w}),l.d(s,"parseDicomDataSetExplicit",function(){return Q}),l.d(s,"parseDicomDataSetImplicit",function(){return ne}),l.d(s,"readFixedString",function(){return D}),l.d(s,"alloc",function(){return ye}),l.d(s,"version",function(){return ve}),l.d(s,"bigEndianByteArrayParser",function(){return Ce}),l.d(s,"ByteStream",function(){return Me}),l.d(s,"sharedCopy",function(){return we}),l.d(s,"DataSet",function(){return O}),l.d(s,"findAndSetUNElementLength",function(){return _}),l.d(s,"findEndOfEncapsulatedElement",function(){return T}),l.d(s,"findItemDelimitationItemAndSetElementLength",function(){return P}),l.d(s,"littleEndianByteArrayParser",function(){return q}),l.d(s,"parseDicom",function(){return X}),l.d(s,"readDicomElementExplicit",function(){return J}),l.d(s,"readDicomElementImplicit",function(){return A}),l.d(s,"readEncapsulatedImageFrame",function(){return Oe}),l.d(s,"readEncapsulatedPixelData",function(){return Ne}),l.d(s,"readEncapsulatedPixelDataFromFragments",function(){return de}),l.d(s,"readPart10Header",function(){return k}),l.d(s,"readSequenceItemsExplicit",function(){return G}),l.d(s,"readSequenceItemsImplicit",function(){return $}),l.d(s,"readSequenceItem",function(){return B}),l.d(s,"readTag",function(){return S});var c={AE:!0,AS:!0,AT:!1,CS:!0,DA:!0,DS:!0,DT:!0,FL:!1,FD:!1,IS:!0,LO:!0,LT:!0,OB:!1,OD:!1,OF:!1,OW:!1,PN:!0,SH:!0,SL:!1,SQ:!1,SS:!1,ST:!0,TM:!0,UI:!0,UL:!1,UN:void 0,UR:!0,US:!1,UT:!0},f=function(ie){return c[ie]},u=function(ie){if(ie=parseInt(ie[4],16),isNaN(ie))throw"dicomParser.isPrivateTag: cannot parse last character of group";return ie%2==1},d=function(ie){if(ie!==void 0)return ie=ie.split("^"),{familyName:ie[0],givenName:ie[1],middleName:ie[2],prefix:ie[3],suffix:ie[4]}};function h(ie,ae){if(2<=ie.length){var Te=parseInt(ie.substring(0,2),10),me=4<=ie.length?parseInt(ie.substring(2,4),10):void 0,Se=6<=ie.length?parseInt(ie.substring(4,6),10):void 0,Ve=8<=ie.length?ie.substring(7,13):void 0,Ve=Ve?parseInt(Ve,10)*Math.pow(10,6-Ve.length):void 0;if(ae&&(isNaN(Te)||me!==void 0&&isNaN(me)||Se!==void 0&&isNaN(Se)||Ve!==void 0&&isNaN(Ve)||Te<0||23<Te||me&&(me<0||59<me)||Se&&(Se<0||59<Se)||Ve&&(Ve<0||999999<Ve)))throw"invalid TM '".concat(ie,"'");return{hours:Te,minutes:me,seconds:Se,fractionalSeconds:Ve}}if(ae)throw"invalid TM '".concat(ie,"'")}function p(ie,ae,Te){return!isNaN(Te)&&0<ae&&ae<=12&&0<ie&&ie<=(function(me,Se){switch(me){case 2:return Se%4==0&&Se%100||Se%400==0?29:28;case 9:case 4:case 6:case 11:return 30;default:return 31}})(ae,Te)}function g(ie,ae){if(ie&&ie.length===8){var Te=parseInt(ie.substring(0,4),10),me=parseInt(ie.substring(4,6),10),Se=parseInt(ie.substring(6,8),10);if(ae&&p(Se,me,Te)!==!0)throw"invalid DA '".concat(ie,"'");return{year:Te,month:me,day:Se}}if(ae)throw"invalid DA '".concat(ie,"'")}function m(ie,ae){if(ie===void 0||ae===void 0)throw"dicomParser.explicitElementToString: missing required parameters";if(ae.vr===void 0)throw"dicomParser.explicitElementToString: cannot convert implicit element to string";var Te,me=ae.vr,Se=ae.tag;function Ve(ut,ht){for(var Ot="",Fe=0;Fe<ut;Fe++)Fe!==0&&(Ot+="/"),Ot+=ht.call(ie,Se,Fe).toString();return Ot}if(f(me)===!0)Te=ie.string(Se);else{if(me==="AT"){var ue=ie.uint32(Se);return ue===void 0?void 0:"x".concat((ue=ue<0?4294967295+ue+1:ue).toString(16).toUpperCase())}me==="US"?Te=Ve(ae.length/2,ie.uint16):me==="SS"?Te=Ve(ae.length/2,ie.int16):me==="UL"?Te=Ve(ae.length/4,ie.uint32):me==="SL"?Te=Ve(ae.length/4,ie.int32):me==="FD"?Te=Ve(ae.length/8,ie.double):me==="FL"&&(Te=Ve(ae.length/4,ie.float))}return Te}function y(ie,ae){if(ie===void 0)throw"dicomParser.explicitDataSetToJS: missing required parameter dataSet";ae=ae||{omitPrivateAttibutes:!0,maxElementLength:128};var Te,me={};for(Te in ie.elements){var Se=ie.elements[Te];if(ae.omitPrivateAttibutes!==!0||!u(Te))if(Se.items){for(var Ve=[],ue=0;ue<Se.items.length;ue++)Ve.push(y(Se.items[ue].dataSet,ae));me[Te]=Ve}else{var ut=void 0;Se.length<ae.maxElementLength&&(ut=m(ie,Se)),me[Te]=ut!==void 0?ut:{dataOffset:Se.dataOffset,length:Se.length}}}return me}function v(ie,ae){return ie.byteArray[ae]===255&&ie.byteArray[ae+1]===217}function x(ie,ae,Te){for(var me,Se,Ve=Te;Ve<ae.fragments.length;Ve++)if(me=ie,Se=Ve,Se=ae.fragments[Se],!(!v(me,Se.position+Se.length-2)&&!v(me,Se.position+Se.length-3)))return Ve}function w(ie,ae,Te){if(ie===void 0)throw"dicomParser.createJPEGBasicOffsetTable: missing required parameter dataSet";if(ae===void 0)throw"dicomParser.createJPEGBasicOffsetTable: missing required parameter pixelDataElement";if(ae.tag!=="x7fe00010")throw"dicomParser.createJPEGBasicOffsetTable: parameter 'pixelDataElement' refers to non pixel data tag (expected tag = x7fe00010'";if(ae.encapsulatedPixelData!==!0||ae.hadUndefinedLength!==!0||ae.basicOffsetTable===void 0||ae.fragments===void 0||ae.fragments.length<=0)throw"dicomParser.createJPEGBasicOffsetTable: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(Te&&Te.length<=0)throw"dicomParser.createJPEGBasicOffsetTable: parameter 'fragments' must not be zero length";Te=Te||ae.fragments;for(var me=[],Se=0;;){me.push(ae.fragments[Se].offset);var Ve=x(ie,ae,Se);if(Ve===void 0||Ve===ae.fragments.length-1)return me;Se=Ve+1}}function S(Te){if(Te===void 0)throw"dicomParser.readTag: missing required parameter 'byteStream'";var ae=256*Te.readUint16()*256,Te=Te.readUint16();return"x".concat("00000000".concat((ae+Te).toString(16)).substr(-8))}function T(ie,ae,Te){if(ie===void 0)throw"dicomParser.findEndOfEncapsulatedElement: missing required parameter 'byteStream'";if(ae===void 0)throw"dicomParser.findEndOfEncapsulatedElement: missing required parameter 'element'";if(ae.encapsulatedPixelData=!0,ae.basicOffsetTable=[],ae.fragments=[],S(ie)!=="xfffee000")throw"dicomParser.findEndOfEncapsulatedElement: basic offset table not found";for(var me=ie.readUint32()/4,Se=0;Se<me;Se++){var Ve=ie.readUint32();ae.basicOffsetTable.push(Ve)}for(var ue=ie.position;ie.position<ie.byteArray.length;){var ut=S(ie),ht=ie.readUint32();if(ut==="xfffee0dd")return ie.seek(ht),void(ae.length=ie.position-ae.dataOffset);if(ut!=="xfffee000")return Te&&Te.push("unexpected tag ".concat(ut," while searching for end of pixel data element with undefined length")),ht>ie.byteArray.length-ie.position&&(ht=ie.byteArray.length-ie.position),ae.fragments.push({offset:ie.position-ue-8,position:ie.position,length:ht}),ie.seek(ht),void(ae.length=ie.position-ae.dataOffset);ae.fragments.push({offset:ie.position-ue-8,position:ie.position,length:ht}),ie.seek(ht)}Te&&Te.push("pixel data element ".concat(ae.tag," missing sequence delimiter tag xfffee0dd"))}function _(ie,ae){if(ie===void 0)throw"dicomParser.findAndSetUNElementLength: missing required parameter 'byteStream'";for(var Te=ie.byteArray.length-8;ie.position<=Te;)if(ie.readUint16()===65534){var me=ie.readUint16();if(me===57565)return ie.readUint32()!==0&&ie.warnings("encountered non zero length following item delimiter at position ".concat(ie.position-4," while reading element of undefined length with tag ").concat(ae.tag)),void(ae.length=ie.position-ae.dataOffset)}ae.length=ie.byteArray.length-ae.dataOffset,ie.seek(ie.byteArray.length-ie.position)}function D(ie,ae,Te){if(Te<0)throw"dicomParser.readFixedString - length cannot be less than 0";if(ae+Te>ie.length)throw"dicomParser.readFixedString: attempt to read past end of buffer";for(var me,Se="",Ve=0;Ve<Te;Ve++){if((me=ie[ae+Ve])===0)return ae+=Te,Se;Se+=String.fromCharCode(me)}return Se}function I(ie,ae){for(var Te=0;Te<ae.length;Te++){var me=ae[Te];me.enumerable=me.enumerable||!1,me.configurable=!0,"value"in me&&(me.writable=!0),Object.defineProperty(ie,me.key,me)}}function R(ie,ae){return ie.parser!==void 0?ie.parser:ae}var O=(function(){function ie(me,Se,Ve){(function(ue,ut){if(!(ue instanceof ut))throw new TypeError("Cannot call a class as a function")})(this,ie),this.byteArrayParser=me,this.byteArray=Se,this.elements=Ve}var ae,Te;return ae=ie,(Te=[{key:"uint16",value:function(me,Se){if(me=this.elements[me],Se=Se!==void 0?Se:0,me&&me.length!==0)return R(me,this.byteArrayParser).readUint16(this.byteArray,me.dataOffset+2*Se)}},{key:"int16",value:function(me,Se){if(me=this.elements[me],Se=Se!==void 0?Se:0,me&&me.length!==0)return R(me,this.byteArrayParser).readInt16(this.byteArray,me.dataOffset+2*Se)}},{key:"uint32",value:function(me,Se){if(me=this.elements[me],Se=Se!==void 0?Se:0,me&&me.length!==0)return R(me,this.byteArrayParser).readUint32(this.byteArray,me.dataOffset+4*Se)}},{key:"int32",value:function(me,Se){if(me=this.elements[me],Se=Se!==void 0?Se:0,me&&me.length!==0)return R(me,this.byteArrayParser).readInt32(this.byteArray,me.dataOffset+4*Se)}},{key:"float",value:function(me,Se){if(me=this.elements[me],Se=Se!==void 0?Se:0,me&&me.length!==0)return R(me,this.byteArrayParser).readFloat(this.byteArray,me.dataOffset+4*Se)}},{key:"double",value:function(me,Se){if(me=this.elements[me],Se=Se!==void 0?Se:0,me&&me.length!==0)return R(me,this.byteArrayParser).readDouble(this.byteArray,me.dataOffset+8*Se)}},{key:"numStringValues",value:function(me){if(me=this.elements[me],me&&0<me.length)return me=D(this.byteArray,me.dataOffset,me.length).match(/\\/g),me===null?1:me.length+1}},{key:"string",value:function(me,Se){if(me=this.elements[me],me&&me.Value)return me.Value;if(me&&0<me.length)return me=D(this.byteArray,me.dataOffset,me.length),0<=Se?me.split("\\")[Se].trim():me.trim()}},{key:"text",value:function(me,Se){if(me=this.elements[me],me&&0<me.length)return me=D(this.byteArray,me.dataOffset,me.length),0<=Se?me.split("\\")[Se].replace(/ +$/,""):me.replace(/ +$/,"")}},{key:"floatString",value:function(me,Se){var Ve=this.elements[me];if(Ve&&0<Ve.length&&(Se=this.string(me,Se=Se!==void 0?Se:0),Se!==void 0))return parseFloat(Se)}},{key:"intString",value:function(me,Se){var Ve=this.elements[me];if(Ve&&0<Ve.length&&(Se=this.string(me,Se=Se!==void 0?Se:0),Se!==void 0))return parseInt(Se)}},{key:"attributeTag",value:function(me){var Se=this.elements[me];if(Se&&Se.length===4){var Ve=R(Se,this.byteArrayParser).readUint16,me=this.byteArray,Se=Se.dataOffset;return"x".concat("00000000".concat((256*Ve(me,Se)*256+Ve(me,Se+2)).toString(16)).substr(-8))}}}])&&I(ae.prototype,Te),Object.defineProperty(ae,"prototype",{writable:!1}),ie})();function P(ie,ae){if(ie===void 0)throw"dicomParser.readDicomElementImplicit: missing required parameter 'byteStream'";for(var Te=ie.byteArray.length-8;ie.position<=Te;)if(ie.readUint16()===65534){var me=ie.readUint16();if(me===57357)return ie.readUint32()!==0&&ie.warnings("encountered non zero length following item delimiter at position ".concat(ie.position-4," while reading element of undefined length with tag ").concat(ae.tag)),void(ae.length=ie.position-ae.dataOffset)}ae.length=ie.byteArray.length-ae.dataOffset,ie.seek(ie.byteArray.length-ie.position)}var N=function(ie,ae){return ie.vr!==void 0?ie.vr==="SQ":ae.position+4<=ae.byteArray.length?(ie=S(ae),ae.seek(-4),ie==="xfffee000"||ie==="xfffee0dd"):(ae.warnings.push("eof encountered before finding sequence item tag or sequence delimiter tag in peeking to determine VR"),!1)};function A(ie,ae,Te){if(ie===void 0)throw"dicomParser.readDicomElementImplicit: missing required parameter 'byteStream'";var me=S(ie),me={tag:me,vr:Te!==void 0?Te(me):void 0,length:ie.readUint32(),dataOffset:ie.position};return me.length===4294967295&&(me.hadUndefinedLength=!0),me.tag===ae||(!N(me,ie)||u(me.tag)&&!me.hadUndefinedLength?me.hadUndefinedLength?P(ie,me):ie.seek(me.length):($(ie,me,Te),u(me.tag)&&(me.items=void 0))),me}function B(ie){if(ie===void 0)throw"dicomParser.readSequenceItem: missing required parameter 'byteStream'";var ae={tag:S(ie),length:ie.readUint32(),dataOffset:ie.position};if(ae.tag!=="xfffee000")throw"dicomParser.readSequenceItem: item tag (FFFE,E000) not found at offset ".concat(ie.position);return ae}function V(ie,ae){var Te=B(ie);return Te.length===4294967295?(Te.hadUndefinedLength=!0,Te.dataSet=(function(me,Se){for(var Ve={};me.position<me.byteArray.length;){var ue=A(me,void 0,Se);if((Ve[ue.tag]=ue).tag==="xfffee00d")return new O(me.byteArrayParser,me.byteArray,Ve)}return me.warnings.push("eof encountered before finding sequence item delimiter in sequence item of undefined length"),new O(me.byteArrayParser,me.byteArray,Ve)})(ie,ae),Te.length=ie.position-Te.dataOffset):(Te.dataSet=new O(ie.byteArrayParser,ie.byteArray,{}),ne(Te.dataSet,ie,ie.position+Te.length,{vrCallback:ae})),Te}function $(ie,ae,Te){if(ie===void 0)throw"dicomParser.readSequenceItemsImplicit: missing required parameter 'byteStream'";if(ae===void 0)throw"dicomParser.readSequenceItemsImplicit: missing required parameter 'element'";ae.items=[],(ae.length===4294967295?function(me,Se,Ve){for(;me.position+4<=me.byteArray.length;){var ue=S(me);if(me.seek(-4),ue==="xfffee0dd")return Se.length=me.position-Se.dataOffset,me.seek(8);ue=V(me,Ve),Se.items.push(ue)}me.warnings.push("eof encountered before finding sequence delimiter in sequence of undefined length"),Se.length=me.byteArray.length-Se.dataOffset}:function(me,Se,Ve){for(var ue=Se.dataOffset+Se.length;me.position<ue;){var ut=V(me,Ve);Se.items.push(ut)}})(ie,ae,Te)}function U(ie,ae){var Te=B(ie);return Te.length===4294967295?(Te.hadUndefinedLength=!0,Te.dataSet=(function(me,Se){for(var Ve={};me.position<me.byteArray.length;){var ue=J(me,Se);if((Ve[ue.tag]=ue).tag==="xfffee00d")return new O(me.byteArrayParser,me.byteArray,Ve)}return Se.push("eof encountered before finding item delimiter tag while reading sequence item of undefined length"),new O(me.byteArrayParser,me.byteArray,Ve)})(ie,ae),Te.length=ie.position-Te.dataOffset):(Te.dataSet=new O(ie.byteArrayParser,ie.byteArray,{}),Q(Te.dataSet,ie,ie.position+Te.length)),Te}function G(ie,ae,Te){if(ie===void 0)throw"dicomParser.readSequenceItemsExplicit: missing required parameter 'byteStream'";if(ae===void 0)throw"dicomParser.readSequenceItemsExplicit: missing required parameter 'element'";ae.items=[],(ae.length===4294967295?function(me,Se,Ve){for(;me.position+4<=me.byteArray.length;){var ue=S(me);if(me.seek(-4),ue==="xfffee0dd")return Se.length=me.position-Se.dataOffset,me.seek(8);ue=U(me,Ve),Se.items.push(ue)}Ve.push("eof encountered before finding sequence delimitation tag while reading sequence of undefined length"),Se.length=me.position-Se.dataOffset}:function(me,Se,Ve){for(var ue=Se.dataOffset+Se.length;me.position<ue;){var ut=U(me,Ve);Se.items.push(ut)}})(ie,ae,Te)}var F=function(ie){return ie==="OB"||ie==="OD"||ie==="OL"||ie==="OW"||ie==="SQ"||ie==="OF"||ie==="UC"||ie==="UR"||ie==="UT"||ie==="UN"?4:2};function J(ie,ae,Te){if(ie===void 0)throw"dicomParser.readDicomElementExplicit: missing required parameter 'byteStream'";var me={tag:S(ie),vr:ie.readFixedString(2)};return F(me.vr)===2?me.length=ie.readUint16():(ie.seek(2),me.length=ie.readUint32()),me.dataOffset=ie.position,me.length===4294967295&&(me.hadUndefinedLength=!0),me.tag===Te||(me.vr==="SQ"?G(ie,me,ae):me.length===4294967295?me.tag==="x7fe00010"?T(ie,me,ae):(me.vr==="UN"?$:P)(ie,me):ie.seek(me.length)),me}function Q(ie,ae,Te){var me=3<arguments.length&&arguments[3]!==void 0?arguments[3]:{};if(Te=Te===void 0?ae.byteArray.length:Te,ae===void 0)throw"dicomParser.parseDicomDataSetExplicit: missing required parameter 'byteStream'";if(Te<ae.position||Te>ae.byteArray.length)throw"dicomParser.parseDicomDataSetExplicit: invalid value for parameter 'maxP osition'";for(var Se=ie.elements;ae.position<Te;){var Ve=J(ae,ie.warnings,me.untilTag);if((Se[Ve.tag]=Ve).tag===me.untilTag)return}if(ae.position>Te)throw"dicomParser:parseDicomDataSetExplicit: buffer overrun"}function ne(ie,ae,Te){var me=3<arguments.length&&arguments[3]!==void 0?arguments[3]:{};if(Te=Te===void 0?ie.byteArray.length:Te,ae===void 0)throw"dicomParser.parseDicomDataSetImplicit: missing required parameter 'byteStream'";if(Te<ae.position||Te>ae.byteArray.length)throw"dicomParser.parseDicomDataSetImplicit: invalid value for parameter 'maxPosition'";for(var Se=ie.elements;ae.position<Te;){var Ve=A(ae,me.untilTag,me.vrCallback);if((Se[Ve.tag]=Ve).tag===me.untilTag)return}}function ye(ie,ae){if(typeof Buffer<"u"&&ie instanceof Buffer)return Buffer.alloc(ae);if(ie instanceof Uint8Array)return new Uint8Array(ae);throw"dicomParser.alloc: unknown type for byteArray"}var ve="1.8.12",Ce={readUint16:function(ie,ae){if(ae<0)throw"bigEndianByteArrayParser.readUint16: position cannot be less than 0";if(ae+2>ie.length)throw"bigEndianByteArrayParser.readUint16: attempt to read past end of buffer";return(ie[ae]<<8)+ie[ae+1]},readInt16:function(ie,ae){if(ae<0)throw"bigEndianByteArrayParser.readInt16: position cannot be less than 0";if(ae+2>ie.length)throw"bigEndianByteArrayParser.readInt16: attempt to read past end of buffer";return ae=(ie[ae]<<8)+ie[ae+1],ae=32768&ae?ae-65535-1:ae},readUint32:function(ie,ae){if(ae<0)throw"bigEndianByteArrayParser.readUint32: position cannot be less than 0";if(ae+4>ie.length)throw"bigEndianByteArrayParser.readUint32: attempt to read past end of buffer";return 256*(256*(256*ie[ae]+ie[ae+1])+ie[ae+2])+ie[ae+3]},readInt32:function(ie,ae){if(ae<0)throw"bigEndianByteArrayParser.readInt32: position cannot be less than 0";if(ae+4>ie.length)throw"bigEndianByteArrayParser.readInt32: attempt to read past end of buffer";return(ie[ae]<<24)+(ie[ae+1]<<16)+(ie[ae+2]<<8)+ie[ae+3]},readFloat:function(ie,ae){if(ae<0)throw"bigEndianByteArrayParser.readFloat: position cannot be less than 0";if(ae+4>ie.length)throw"bigEndianByteArrayParser.readFloat: attempt to read past end of buffer";var Te=new Uint8Array(4);return Te[3]=ie[ae],Te[2]=ie[ae+1],Te[1]=ie[ae+2],Te[0]=ie[ae+3],new Float32Array(Te.buffer)[0]},readDouble:function(ie,ae){if(ae<0)throw"bigEndianByteArrayParser.readDouble: position cannot be less than 0";if(ae+8>ie.length)throw"bigEndianByteArrayParser.readDouble: attempt to read past end of buffer";var Te=new Uint8Array(8);return Te[7]=ie[ae],Te[6]=ie[ae+1],Te[5]=ie[ae+2],Te[4]=ie[ae+3],Te[3]=ie[ae+4],Te[2]=ie[ae+5],Te[1]=ie[ae+6],Te[0]=ie[ae+7],new Float64Array(Te.buffer)[0]}};function we(ie,ae,Te){if(typeof Buffer<"u"&&ie instanceof Buffer)return ie.slice(ae,ae+Te);if(ie instanceof Uint8Array)return new Uint8Array(ie.buffer,ie.byteOffset+ae,Te);throw"dicomParser.from: unknown type for byteArray"}function Ae(ie,ae){for(var Te=0;Te<ae.length;Te++){var me=ae[Te];me.enumerable=me.enumerable||!1,me.configurable=!0,"value"in me&&(me.writable=!0),Object.defineProperty(ie,me.key,me)}}var Me=(function(){function ie(me,Se,Ve){if((function(ue,ut){if(!(ue instanceof ut))throw new TypeError("Cannot call a class as a function")})(this,ie),me===void 0)throw"dicomParser.ByteStream: missing required parameter 'byteArrayParser'";if(Se===void 0)throw"dicomParser.ByteStream: missing required parameter 'byteArray'";if(!(Se instanceof Uint8Array)&&(typeof Buffer>"u"||!(Se instanceof Buffer)))throw"dicomParser.ByteStream: parameter byteArray is not of type Uint8Array or Buffer";if(Ve<0)throw"dicomParser.ByteStream: parameter 'position' cannot be less than 0";if(Ve>=Se.length)throw"dicomParser.ByteStream: parameter 'position' cannot be greater than or equal to 'byteArray' length";this.byteArrayParser=me,this.byteArray=Se,this.position=Ve||0,this.warnings=[]}var ae,Te;return ae=ie,(Te=[{key:"seek",value:function(me){if(this.position+me<0)throw"dicomParser.ByteStream.prototype.seek: cannot seek to position < 0";this.position+=me}},{key:"readByteStream",value:function(me){if(this.position+me>this.byteArray.length)throw"dicomParser.ByteStream.prototype.readByteStream: readByteStream - buffer overread";var Se=we(this.byteArray,this.position,me);return this.position+=me,new ie(this.byteArrayParser,Se)}},{key:"getSize",value:function(){return this.byteArray.length}},{key:"readUint16",value:function(){var me=this.byteArrayParser.readUint16(this.byteArray,this.position);return this.position+=2,me}},{key:"readUint32",value:function(){var me=this.byteArrayParser.readUint32(this.byteArray,this.position);return this.position+=4,me}},{key:"readFixedString",value:function(me){var Se=D(this.byteArray,this.position,me);return this.position+=me,Se}}])&&Ae(ae.prototype,Te),Object.defineProperty(ae,"prototype",{writable:!1}),ie})(),q={readUint16:function(ie,ae){if(ae<0)throw"littleEndianByteArrayParser.readUint16: position cannot be less than 0";if(ae+2>ie.length)throw"littleEndianByteArrayParser.readUint16: attempt to read past end of buffer";return ie[ae]+256*ie[ae+1]},readInt16:function(ie,ae){if(ae<0)throw"littleEndianByteArrayParser.readInt16: position cannot be less than 0";if(ae+2>ie.length)throw"littleEndianByteArrayParser.readInt16: attempt to read past end of buffer";return ae=ie[ae]+(ie[ae+1]<<8),ae=32768&ae?ae-65535-1:ae},readUint32:function(ie,ae){if(ae<0)throw"littleEndianByteArrayParser.readUint32: position cannot be less than 0";if(ae+4>ie.length)throw"littleEndianByteArrayParser.readUint32: attempt to read past end of buffer";return ie[ae]+256*ie[ae+1]+256*ie[ae+2]*256+256*ie[ae+3]*256*256},readInt32:function(ie,ae){if(ae<0)throw"littleEndianByteArrayParser.readInt32: position cannot be less than 0";if(ae+4>ie.length)throw"littleEndianByteArrayParser.readInt32: attempt to read past end of buffer";return ie[ae]+(ie[ae+1]<<8)+(ie[ae+2]<<16)+(ie[ae+3]<<24)},readFloat:function(ie,ae){if(ae<0)throw"littleEndianByteArrayParser.readFloat: position cannot be less than 0";if(ae+4>ie.length)throw"littleEndianByteArrayParser.readFloat: attempt to read past end of buffer";var Te=new Uint8Array(4);return Te[0]=ie[ae],Te[1]=ie[ae+1],Te[2]=ie[ae+2],Te[3]=ie[ae+3],new Float32Array(Te.buffer)[0]},readDouble:function(ie,ae){if(ae<0)throw"littleEndianByteArrayParser.readDouble: position cannot be less than 0";if(ae+8>ie.length)throw"littleEndianByteArrayParser.readDouble: attempt to read past end of buffer";var Te=new Uint8Array(8);return Te[0]=ie[ae],Te[1]=ie[ae+1],Te[2]=ie[ae+2],Te[3]=ie[ae+3],Te[4]=ie[ae+4],Te[5]=ie[ae+5],Te[6]=ie[ae+6],Te[7]=ie[ae+7],new Float64Array(Te.buffer)[0]}};function k(ie){var ae=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};if(ie===void 0)throw"dicomParser.readPart10Header: missing required parameter 'byteArray'";var Te=ae.TransferSyntaxUID,me=new Me(q,ie);return(function(){var Se=(function(){if(me.getSize()<=132&&Te)return!1;if(me.seek(128),me.readFixedString(4)==="DICM")return!0;if(!(ae||{}).TransferSyntaxUID)throw"dicomParser.readPart10Header: DICM prefix not found at location 132 - this is not a valid DICOM P10 file.";return me.seek(0),!1})(),Ve=[],ue={};if(!Se)return me.position=0,{elements:{x00020010:{tag:"x00020010",vr:"UI",Value:Te}},warnings:Ve};for(;me.position<me.byteArray.length;){var ut=me.position,ht=J(me,Ve);if("x0002ffff"<ht.tag){me.position=ut;break}ht.parser=q,ue[ht.tag]=ht}return(Se=new O(me.byteArrayParser,me.byteArray,ue)).warnings=me.warnings,Se.position=me.position,Se})()}var Y="1.2.840.10008.1.2.2";function X(ie){var ae=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};if(ie===void 0)throw new Error("dicomParser.parseDicom: missing required parameter 'byteArray'");var Te,me=function(Ve){if(Ve.elements.x00020010===void 0)throw new Error("dicomParser.parseDicom: missing required meta header attribute 0002,0010");return Ve=Ve.elements.x00020010,Ve&&Ve.Value||D(ie,Ve.dataOffset,Ve.length)};function Se(ht){var ut=me(ht),ue=ut!=="1.2.840.10008.1.2",ut=(function(Ot,Fe){var Qe=Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]";if(Ot!=="1.2.840.10008.1.2.1.99")return new Me(Ot===Y?Ce:q,ie,Fe);if(ae&&ae.inflater)return Ot=ae.inflater(ie,Fe),new Me(q,Ot,0);if(Qe==!0){var st=l(0),ot=we(ie,Fe,ie.length-Fe),st=st.inflateRawSync(ot),ot=ye(ie,st.length+Fe);return ie.copy(ot,0,0,Fe),st.copy(ot,Fe),new Me(q,ot,0)}if(typeof pako>"u")throw"dicomParser.parseDicom: no inflater available to handle deflate transfer syntax";return st=ie.slice(Fe),ot=pako.inflateRaw(st),(st=ye(ie,ot.length+Fe)).set(ie.slice(0,Fe),0),st.set(ot,Fe),new Me(q,st,0)})(ut,ht.position),ht=new O(ut.byteArrayParser,ut.byteArray,{});ht.warnings=ut.warnings;try{(ue?Q:ne)(ht,ut,ut.byteArray.length,ae)}catch(Ot){throw{exception:Ot,dataSet:ht}}return ht}return(function(Ve,ue){for(var ut in Ve.elements)Ve.elements.hasOwnProperty(ut)&&(ue.elements[ut]=Ve.elements[ut]);return Ve.warnings!==void 0&&(ue.warnings=Ve.warnings.concat(ue.warnings)),ue})(Te=k(ie,ae),Se(Te))}var re=function(ie,ae,Te){for(var me=0,Se=ae;Se<ae+Te;Se++)me+=ie[Se].length;return me};function de(ie,ue,Te,me,Se){if(Se=Se||ue.fragments,ie===void 0)throw"dicomParser.readEncapsulatedPixelDataFromFragments: missing required parameter 'dataSet'";if(ue===void 0)throw"dicomParser.readEncapsulatedPixelDataFromFragments: missing required parameter 'pixelDataElement'";if(Te===void 0)throw"dicomParser.readEncapsulatedPixelDataFromFragments: missing required parameter 'startFragmentIndex'";if((me=me||1)===void 0)throw"dicomParser.readEncapsulatedPixelDataFromFragments: missing required parameter 'numFragments'";if(ue.tag!=="x7fe00010")throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'pixelDataElement' refers to non pixel data tag (expected tag = x7fe00010";if(ue.encapsulatedPixelData!==!0||ue.hadUndefinedLength!==!0||ue.basicOffsetTable===void 0||ue.fragments===void 0||ue.fragments.length<=0)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(Te<0)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'startFragmentIndex' must be >= 0";if(Te>=ue.fragments.length)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'startFragmentIndex' must be < number of fragments";if(me<1)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'numFragments' must be > 0";if(Te+me>ue.fragments.length)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'startFragment' + 'numFragments' < number of fragments";var Ve=new Me(ie.byteArrayParser,ie.byteArray,ue.dataOffset),ue=B(Ve);if(ue.tag!=="xfffee000")throw"dicomParser.readEncapsulatedPixelData: missing basic offset table xfffee000";Ve.seek(ue.length);var ut=Ve.position;if(me===1)return we(Ve.byteArray,ut+Se[Te].offset+8,Se[Te].length);for(var ue=re(Se,Te,me),ht=ye(Ve.byteArray,ue),Ot=0,Fe=Te;Fe<Te+me;Fe++)for(var Qe=ut+Se[Fe].offset+8,st=0;st<Se[Fe].length;st++)ht[Ot++]=Ve.byteArray[Qe++];return ht}var he=function(ie,ae){for(var Te=0;Te<ie.length;Te++)if(ie[Te].offset===ae)return Te},Ee=function(ie,ae,Te,me){if(ie===ae.length-1)return Te.length-me;for(var Se=ae[ie+1],Ve=me+1;Ve<Te.length;Ve++)if(Te[Ve].offset===Se)return Ve-me;throw"dicomParser.calculateNumberOfFragmentsForFrame: could not find fragment with offset matching basic offset table"};function Oe(ie,ae,Te,me,Se){if(me=me||ae.basicOffsetTable,Se=Se||ae.fragments,ie===void 0)throw"dicomParser.readEncapsulatedImageFrame: missing required parameter 'dataSet'";if(ae===void 0)throw"dicomParser.readEncapsulatedImageFrame: missing required parameter 'pixelDataElement'";if(Te===void 0)throw"dicomParser.readEncapsulatedImageFrame: missing required parameter 'frameIndex'";if(me===void 0)throw"dicomParser.readEncapsulatedImageFrame: parameter 'pixelDataElement' does not have basicOffsetTable";if(ae.tag!=="x7fe00010")throw"dicomParser.readEncapsulatedImageFrame: parameter 'pixelDataElement' refers to non pixel data tag (expected tag = x7fe00010)";if(ae.encapsulatedPixelData!==!0)throw"dicomParser.readEncapsulatedImageFrame: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(ae.hadUndefinedLength!==!0)throw"dicomParser.readEncapsulatedImageFrame: parameter 'pixelDataElement' refers to pixel data element that does not have undefined length";if(ae.fragments===void 0)throw"dicomParser.readEncapsulatedImageFrame: parameter 'pixelDataElement' refers to pixel data element that does not have fragments";if(me.length===0)throw"dicomParser.readEncapsulatedImageFrame: basicOffsetTable has zero entries";if(Te<0)throw"dicomParser.readEncapsulatedImageFrame: parameter 'frameIndex' must be >= 0";if(Te>=me.length)throw"dicomParser.readEncapsulatedImageFrame: parameter 'frameIndex' must be < basicOffsetTable.length";var Ve=me[Te],Ve=he(Se,Ve);if(Ve===void 0)throw"dicomParser.readEncapsulatedImageFrame: unable to find fragment that matches basic offset table entry";return de(ie,ae,Ve,Ee(Te,me,Se,Ve),Se)}var Pe=!1;function Ne(ie,ae,Te){if(Pe||(Pe=!0,console&&console.log&&console.log("WARNING: dicomParser.readEncapsulatedPixelData() has been deprecated")),ie===void 0)throw"dicomParser.readEncapsulatedPixelData: missing required parameter 'dataSet'";if(ae===void 0)throw"dicomParser.readEncapsulatedPixelData: missing required parameter 'element'";if(Te===void 0)throw"dicomParser.readEncapsulatedPixelData: missing required parameter 'frame'";if(ae.tag!=="x7fe00010")throw"dicomParser.readEncapsulatedPixelData: parameter 'element' refers to non pixel data tag (expected tag = x7fe00010)";if(ae.encapsulatedPixelData!==!0||ae.hadUndefinedLength!==!0||ae.basicOffsetTable===void 0||ae.fragments===void 0)throw"dicomParser.readEncapsulatedPixelData: parameter 'element' refers to pixel data element that does not have encapsulated pixel data";if(Te<0)throw"dicomParser.readEncapsulatedPixelData: parameter 'frame' must be >= 0";return ae.basicOffsetTable.length!==0?Oe(ie,ae,Te):de(ie,ae,0,ae.fragments.length)}s.default={isStringVr:f,isPrivateTag:u,parsePN:d,parseTM:h,parseDA:g,explicitElementToString:m,explicitDataSetToJS:y,createJPEGBasicOffsetTable:w,parseDicomDataSetExplicit:Q,parseDicomDataSetImplicit:ne,readFixedString:D,alloc:ye,version:ve,bigEndianByteArrayParser:Ce,ByteStream:Me,sharedCopy:we,DataSet:O,findAndSetUNElementLength:_,findEndOfEncapsulatedElement:T,findItemDelimitationItemAndSetElementLength:P,littleEndianByteArrayParser:q,parseDicom:X,readDicomElementExplicit:J,readDicomElementImplicit:A,readEncapsulatedImageFrame:Oe,readEncapsulatedPixelData:Ne,readEncapsulatedPixelDataFromFragments:de,readPart10Header:k,readSequenceItemsExplicit:G,readSequenceItemsImplicit:$,readSequenceItem:B,readTag:S,LEI:"1.2.840.10008.1.2",LEE:"1.2.840.10008.1.2.1"}}],a={},r.m=i,r.c=a,r.d=function(o,s,l){r.o(o,s)||Object.defineProperty(o,s,{enumerable:!0,get:l})},r.r=function(o){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})},r.t=function(o,s){if(1&s&&(o=r(o)),8&s||4&s&&typeof o=="object"&&o&&o.__esModule)return o;var l=Object.create(null);if(r.r(l),Object.defineProperty(l,"default",{enumerable:!0,value:o}),2&s&&typeof o!="string")for(var c in o)r.d(l,c,(function(f){return o[f]}).bind(null,c));return l},r.n=function(o){var s=o&&o.__esModule?function(){return o.default}:function(){return o};return r.d(s,"a",s),s},r.o=function(o,s){return Object.prototype.hasOwnProperty.call(o,s)},r.p="",r(r.s=1);function r(o){if(a[o])return a[o].exports;var s=a[o]={i:o,l:!1,exports:{}};return i[o].call(s.exports,s,s.exports,r),s.l=!0,s.exports}var i,a})})(yw)),yw.exports}var wi=jje();const zje=sl(wi),Wje=fae({__proto__:null,default:zje},[wi]);function Xy(t){const e=t.indexOf(":");let n=t.substring(e+1);const r=n.indexOf("frame=");let i;if(r!==-1){const s=n.substring(r+6);i=parseInt(s,10),n=n.substring(0,r-1)}const a=t.substring(0,e),o=i!==void 0?i-1:void 0;return{scheme:a,url:n,frame:i,pixelDataFrame:o}}let v9={open(t,e){t.open("get",e,!0)},beforeSend(){},beforeProcessing(t){return Promise.resolve(t.response)},imageCreated(){},strict:!1};function pre(t){v9=Object.assign(v9,t)}function Yy(){return v9}function _S(t,e,n={},r={}){const i=Yy(),a=l=>{if(typeof i.errorInterceptor=="function"){const c=new Error("request failed");c.request=l,c.response=l.response,c.status=l.status,i.errorInterceptor(c)}},o=new XMLHttpRequest,s=new Promise((l,c)=>{i.open(o,t,n,r);const f=i.beforeSend(o,e,n,r);o.responseType="arraybuffer";const u=Object.assign({},n,f);Object.keys(u).forEach(function(d){u[d]!==null&&(d==="Accept"&&t.indexOf("accept=")!==-1||o.setRequestHeader(d,u[d]))}),r.deferred={resolve:l,reject:c},r.url=t,r.imageId=e,o.onloadstart=function(d){i.onloadstart&&i.onloadstart(d,r),wt(vt,"cornerstoneimageloadstart",{url:t,imageId:e})},o.onloadend=function(d){i.onloadend&&i.onloadend(d,r),wt(vt,"cornerstoneimageloadend",{url:t,imageId:e})},o.onreadystatechange=function(d){i.onreadystatechange&&i.onreadystatechange(d,r),o.readyState===4&&(o.status===200||o.status===206?i.beforeProcessing(o).then(l).catch(()=>{a(o),c(o)}):(a(o),c(o)))},o.onprogress=function(d){const h=d.loaded;let p,g;d.lengthComputable&&(p=d.total,g=Math.round(h/p*100)),wt(vt,"cornerstoneimageloadprogress",{url:t,imageId:e,loaded:h,total:p,percentComplete:g}),i.onprogress&&i.onprogress(d,r)},o.onerror=function(){a(o),c(o)},o.onabort=function(){a(o),c(o)},o.send()});return s.xhr=o,s}function Hje(t,e,n){if(n+t.length>e.length)return!1;let r=n;for(let i=0;i<t.length;i++)if(t[i]!==e[r++])return!1;return!0}function Kje(t){const e=new Uint8Array(t.length);for(let n=0,r=t.length;n<r;n++)e[n]=t.charCodeAt(n);return e}function y9(t,e,n){n=n||0;const r=Kje(e);for(let i=n;i<t.length;i++)if(r[0]===t[i]&&Hje(r,t,i))return i;return-1}const{ImageQualityStatus:bB}=ll;function QO(t,e,n){n||={};const r=new Uint8Array(e),i=!!n?.isPartial;if(t.indexOf("multipart")===-1)return{contentType:t,imageQualityStatus:i?bB.SUBRESOLUTION:bB.FULL_RESOLUTION,pixelData:r};let{tokenIndex:a,responseHeaders:o,boundary:s,multipartContentType:l}=n;if(a||=y9(r,`\r
\r
`),a===-1)throw new Error("invalid response - no multipart mime header");if(!s&&(o=Yje(r,0,a).split(`\r
`),s=qje(o),!s))throw new Error("invalid response - no boundary marker");const c=a+4,f=y9(r,s,c);if(f===-1&&!i)throw new Error("invalid response - terminating boundary not found");return l||=Xje(o),n.tokenIndex=a,n.boundary=s,n.responseHeaders=o,n.multipartContentType=l,n.isPartial=f===-1,{contentType:l,extractDone:!i||f!==-1,tokenIndex:a,responseHeaders:o,boundary:s,multipartContentType:l,pixelData:e.slice(c,f-2)}}function qje(t){for(let e=0;e<t.length;e++)if(t[e].substr(0,2)==="--")return t[e]}function Xje(t){for(let e=0;e<t.length;e++)if(t[e].substr(0,13)==="Content-Type:")return t[e].substr(13).trim()}function Yje(t,e,n){e=e||0,n=n||t.length-e;let r="";for(let i=e;i<e+n;i++)r+=String.fromCharCode(t[i]);return r}const{ImageQualityStatus:wB}=ll;function eM(t,e=!0){return e?t.imageQualityStatus??wB.FULL_RESOLUTION:wB.SUBRESOLUTION}const{ProgressiveIterator:Jje}=Yr;function gre(t,e,n={},r={}){const i=Yy(),{retrieveOptions:a={},streamingData:o={}}=r,s=a.minChunkSize||128*1024,l=f=>{if(typeof i.errorInterceptor=="function"){const u=new Error("request failed");i.errorInterceptor(u)}},c=new Jje("streamRequest");return c.generate(async(f,u)=>{const d=i.beforeSend?.(null,t,n,{}),h=Object.assign({},n,d);Object.keys(h).forEach(function(p){h[p]===null&&(h[p]=void 0),p==="Accept"&&t.indexOf("accept=")!==-1&&(h[p]=void 0)});try{const p=await fetch(t,{headers:h,signal:void 0});if(p.status!==200)throw new Error(`Couldn't retrieve ${t} got status ${p.status}`);const g=p.body.getReader(),m=p.headers,y=m.get("content-type"),v=Number(m.get("Content-Length"));let x=!1,w=o.encodedData,S=o.lastSize||0;for(o.isPartial=!0;!x;){const{done:T,value:_}=await g.read();if(w=Zje(w,_),!w){if(x)throw new Error(`Done but no image frame available ${e}`);continue}if(x=T||w.byteLength===v,!x&&w.length<S+s)continue;S=w.length,o.isPartial=!T;const D=QO(y,w,o),I=eM(a,x),R={url:t,imageId:e,...D,percentComplete:T?100:D.pixelData?.length*100/v,imageQualityStatus:I,done:x};f.add(R,x)}}catch(p){l(),console.error(p),u(p)}}),c.getNextPromise()}function Zje(t,e){if(!t)return e;if(!e)return t;const n=new Uint8Array(t.length+e.length);return n.set(t,0),n.set(e,t.length),n}const Qje={xhrRequest:_S,streamRequest:gre,setOptions:pre,getOptions:Yy};function eze(t){const e=t.elements.x7fe00010.fragments,n=t.byteArray.length;for(const r of e){const{position:i,length:a}=r;a>n-i&&(console.log(`Truncated fragment, changing fragment length from ${r.length} to ${n-i}`),r.length=n-i)}return t}function tze(t){let e=wi.parseDicom(t,{untilTag:"x7fe00010"});e.elements.x7fe00010||console.warn("Pixel data not found!");let n;try{n=wi.parseDicom(t)}catch(r){console.error(r),console.log("pixel data dataset:",r.dataSet),n=r.dataSet}return e.elements.x7fe00010=n.elements.x7fe00010,e=eze(e),e}async function mre(t,e,n){const r=tze(t),{uri:i,imageId:a,fileTotalLength:o}=n;return r.fetchMore=async function(s){const l=Object.assign({uri:i,imageId:a,fetchedLength:t.length,lengthToFetch:o-t.length},s),{fetchedLength:c,lengthToFetch:f}=l,{arrayBuffer:u}=await e(i,a,{byteRange:`${c}-${c+f}`}),d=new Uint8Array(u),h=new Uint8Array(r.byteArray.length+d.length);return h.set(r.byteArray),h.set(d,r.byteArray.length),mre(h,e,n)},r}function nze(t,e){if(!t)return;const{NumberOfFrames:n,PerFrameFunctionalGroupsSequence:r,SharedFunctionalGroupsSequence:i}=yre(t);if(r||n>1){const{shared:a,perFrame:o}=vre(r,i,e);return{NumberOfFrames:n,PerFrameFunctionalInformation:o,SharedFunctionalInformation:a}}return{NumberOfFrames:n}}function vre(t,e,n){const r={};(e?Object.values(e.items[0].dataSet.elements):[]).map(a=>r[a.tag]=a);const i={};return(t?Object.values(t.items[n-1].dataSet.elements):[]).map(a=>i[a.tag]=a),{shared:r,perFrame:i}}function yre(t){if(!t)return;const{elements:e,...n}=t,{x52009230:r,x52009229:i,...a}=e;return{NumberOfFrames:t.intString("x00280008"),PerFrameFunctionalGroupsSequence:r,SharedFunctionalGroupsSequence:i,otherElements:a,otherAttributtes:n}}function rze(t,e){if(!e)return;const{NumberOfFrames:n,PerFrameFunctionalGroupsSequence:r,SharedFunctionalGroupsSequence:i,otherElements:a}=yre(e);if(r||n>1){const{shared:o,perFrame:s}=vre(r,i,t),l={elements:{...a,...o,...s}},c=Object.create(e);return Object.assign(c,l)}return e}let Fa={};const ize=()=>{Fa={}};function tM(t){if(Fa[t])return Fa[t]}function aze(t){const e=tM(t);return xre(e)}function xre(t){if(!t)return!1;const e=t.intString("x00280008");return e&&e>1}function oze(t){return t.indexOf("&frame=")}function sze(t){const e=oze(t),n=e===-1?t:t.slice(0,e),r=parseInt(t.slice(e+7),10)||1;let i;return Fa[n]?i=Fa[n].dataSet:i=void 0,{dataSet:i,frame:r}}function lze(t){const e=[],n=tM(t);if(xre(n)){const r=n.intString("x00280008");for(let i=1;i<=r;i++)e.push(`${t}&frame=${i}`)}else e.push(t);return e}const bre={_get:tM,generateMultiframeWADOURIs:lze,retrieveMultiframeDataset:sze,isMultiframeDataset:aze};let Sm=0,J0={};function cze(t){return Fa[t]!==void 0}function uze(t){let e;if(t.includes("&frame=")){const{frame:n,dataSet:r}=bre.retrieveMultiframeDataset(t);e=rze(n,r)}else Fa[t]&&(e=Fa[t].dataSet);return e}function fze(t,e){const n=Fa[t];if(!n){console.error(`No loaded dataSet for uri ${t}`);return}Sm-=n.dataSet.byteArray.length,n.dataSet=e,Sm+=e.byteArray.length,wt(vt,"datasetscachechanged",{uri:t,action:"updated",cacheInfo:DS()})}function dze(t,e=_S,n){if(Fa[t])return new Promise(a=>{Fa[t].cacheCount++,a(Fa[t].dataSet)});if(J0[t])return J0[t].cacheCount++,J0[t];const r=e(t,n),i=new Promise((a,o)=>{r.then(async function(s){const l={isPartialContent:!1,fileTotalLength:null};if(!(s instanceof ArrayBuffer)){if(!s.arrayBuffer)return o(new Error("If not returning ArrayBuffer, must return object with `arrayBuffer` parameter"));l.isPartialContent=s.flags.isPartialContent,l.fileTotalLength=s.flags.fileTotalLength,s=s.arrayBuffer}const c=new Uint8Array(s);let f;try{l.isPartialContent?f=await mre(c,e,{uri:t,imageId:n,fileTotalLength:l.fileTotalLength}):f=wi.parseDicom(c)}catch(u){return o(u)}Fa[t]={dataSet:f,cacheCount:i.cacheCount},Sm+=f.byteArray.length,a(f),wt(vt,"datasetscachechanged",{uri:t,action:"loaded",cacheInfo:DS()})},o).then(()=>{delete J0[t]},()=>{delete J0[t]})});return i.cacheCount=1,J0[t]=i,i}function hze(t){Fa[t]&&(Fa[t].cacheCount--,Fa[t].cacheCount===0&&(Sm-=Fa[t].dataSet.byteArray.length,delete Fa[t],wt(vt,"datasetscachechanged",{uri:t,action:"unloaded",cacheInfo:DS()})))}function DS(){return{cacheSizeInBytes:Sm,numberOfDataSetsCached:Object.keys(Fa).length}}function pze(){ize(),J0={},Sm=0}const im={isLoaded:cze,load:dze,unload:hze,getInfo:DS,purge:pze,get:uze,update:fze};function gze(t){const e=[];for(let n=0;n<=30;n+=2){let r=`x60${n.toString(16)}`;r.length===4&&(r=`x600${n.toString(16)}`);const i=t.elements[`${r}3000`];if(!i)continue;const a=[];for(let o=0;o<i.length;o++)for(let s=0;s<8;s++){const l=t.byteArray[i.dataOffset+o];a[o*8+s]=l>>s&1}e.push({rows:t.uint16(`${r}0010`),columns:t.uint16(`${r}0011`),type:t.string(`${r}0040`),x:t.int16(`${r}0050`,1)-1,y:t.int16(`${r}0050`,0)-1,pixelData:a,description:t.string(`${r}0022`),label:t.string(`${r}1500`),roiArea:t.string(`${r}1301`),roiMean:t.string(`${r}1302`),roiStandardDeviation:t.string(`${r}1303`)})}return{overlays:e}}function a1(t){return t==="RECON TOMO"||t==="RECON GATED TOMO"}function nM(t,e){const n=t.string("x00080008");if(n){const r=n.split("\\");if(r.length>e)return r[e]}}function mze(t){let e;if(t.string("x00080060")?.includes("NM")){const r=nM(t,2);r&&a1(r)&&t.elements.x00540022&&(e=Tc(t.elements.x00540022.items[0].dataSet,"x00200037",6))}return e}function vze(t){let e;if(t.string("x00080060")?.includes("NM")){const r=nM(t,2);r&&a1(r)&&t.elements.x00540022&&(e=Tc(t.elements.x00540022.items[0].dataSet,"x00200032",3))}return e}function CB(t){let e=Tc(t,"x00200037",6);return!e&&t.elements.x00209116&&(e=Tc(t.elements.x00209116.items[0].dataSet,"x00200037",6)),e||(e=mze(t)),e}function SB(t){let e=Tc(t,"x00200032",3);return!e&&t.elements.x00209113&&(e=Tc(t.elements.x00209113.items[0].dataSet,"x00200032",3)),e||(e=vze(t)),e}function TB(t){let e=Tc(t,"x00280030",2);return!e&&t.elements.x00289110&&(e=Tc(t.elements.x00289110.items[0].dataSet,"x00280030",2)),e}function EB(t){let e;return t.elements.x00180050?e=t.floatString("x00180050"):t.elements.x00289110&&t.elements.x00289110.items.length&&t.elements.x00289110.items[0].dataSet.elements.x00180050&&(e=t.elements.x00289110.items[0].dataSet.floatString("x00180050")),e}function wre(t,e,n){const r={};for(const i of n)try{const a=e(i,t);if(a){const o={};for(const s in a)if(s in a){const l=yze(s);o[l]=a[s]}Object.assign(r,o)}}catch(a){console.error(`Error retrieving ${i} data:`,a)}return r}const yze=t=>t.charAt(0).toUpperCase()+t.slice(1),Cre=["multiframeModule","generalSeriesModule","patientStudyModule","imagePlaneModule","nmMultiframeGeometryModule","imagePixelModule","modalityLutModule","voiLutModule","sopCommonModule","petIsotopeModule","overlayPlaneModule","transferSyntax","petSeriesModule","petImageModule"];function _B(t){const e=t.elements.x00186011;return!e||!e.items?[]:e.items.map(r=>{const i=r.dataSet.double("x0018602c"),a=r.dataSet.double("x0018602e"),o=r.dataSet.uint16("x00186024"),s=r.dataSet.uint16("x00186026"),l=r.dataSet.uint16("x0018601a"),c=r.dataSet.uint16("x0018601e"),f=r.dataSet.uint16("x00186018"),u=r.dataSet.uint16("x0018601c"),d=r.dataSet.int32("x00186020")||null,h=r.dataSet.int32("x00186022")||null,p=r.dataSet.uint16("x0018602a"),g=r.dataSet.uint16("x00186028"),m=r.dataSet.uint16("x00186012"),y=r.dataSet.uint16("x00186014"),v=r.dataSet.uint16("x00186016"),x=r.dataSet.uint16("x00186030");return{regionLocationMinY0:l,regionLocationMaxY1:c,regionLocationMinX0:f,regionLocationMaxX1:u,referencePixelX0:d,referencePixelY0:h,physicalDeltaX:i,physicalDeltaY:a,physicalUnitsXDirection:o,physicalUnitsYDirection:s,referencePhysicalPixelValueY:p,referencePhysicalPixelValueX:g,regionSpatialFormat:m,regionDataType:y,regionFlags:v,transducerFrequency:x}})}function rM(t,e){const{MetadataModules:n}=ll;if(Array.isArray(e))return;const r=Xy(e);if(t===n.MULTIFRAME){const o=bre.retrieveMultiframeDataset(r.url);return o.dataSet?nze(o.dataSet,o.frame):void 0}let i=r.url;r.frame&&(i=`${i}&frame=${r.frame}`);const a=im.get(i);if(a)return Sre(t,e,a)}function Sre(t,e,n){const{MetadataModules:r}=ll;if(t===r.GENERAL_STUDY)return{studyDescription:n.string("x00081030"),studyDate:wi.parseDA(n.string("x00080020")),studyTime:wi.parseTM(n.string("x00080030")||""),accessionNumber:n.string("x00080050")};if(t===r.GENERAL_SERIES)return{modality:n.string("x00080060"),seriesInstanceUID:n.string("x0020000e"),seriesDescription:n.string("x0008103e"),seriesNumber:n.intString("x00200011"),studyInstanceUID:n.string("x0020000d"),seriesDate:wi.parseDA(n.string("x00080021")),seriesTime:wi.parseTM(n.string("x00080031")||""),acquisitionDate:wi.parseDA(n.string("x00080022")),acquisitionTime:wi.parseTM(n.string("x00080032")||"")};if(t===r.GENERAL_IMAGE)return{sopInstanceUID:n.string("x00080018"),instanceNumber:n.intString("x00200013"),lossyImageCompression:n.string("x00282110"),lossyImageCompressionRatio:n.floatString("x00282112"),lossyImageCompressionMethod:n.string("x00282114")};if(t===r.PATIENT)return{patientID:n.string("x00100020"),patientName:n.string("x00100010")};if(t===r.PATIENT_STUDY)return{patientAge:n.intString("x00101010"),patientSize:n.floatString("x00101020"),patientSex:n.string("x00100040"),patientWeight:n.floatString("x00101030")};if(t===r.NM_MULTIFRAME_GEOMETRY){const i=n.string("x00080060"),a=nM(n,2);return{modality:i,imageType:n.string("x00080008"),imageSubType:a,imageOrientationPatient:CB(n),imagePositionPatient:SB(n),sliceThickness:EB(n),pixelSpacing:TB(n),numberOfFrames:n.uint16("x00280008"),isNMReconstructable:a1(a)&&i.includes("NM")}}if(t===r.IMAGE_PLANE){const i=CB(n),a=SB(n),o=TB(n),s=EB(n);let l=null,c=null;o&&(c=o[0],l=o[1]);let f=null,u=null;return i&&(f=[parseFloat(i[0]),parseFloat(i[1]),parseFloat(i[2])],u=[parseFloat(i[3]),parseFloat(i[4]),parseFloat(i[5])]),{frameOfReferenceUID:n.string("x00200052"),rows:n.uint16("x00280010"),columns:n.uint16("x00280011"),imageOrientationPatient:i,rowCosines:f,columnCosines:u,imagePositionPatient:a,sliceThickness:s,sliceLocation:n.floatString("x00201041"),pixelSpacing:o,rowPixelSpacing:c,columnPixelSpacing:l}}if(t===r.CINE)return{frameTime:n.floatString("x00181063")};if(t===r.IMAGE_PIXEL)return ure(n);if(t===r.VOI_LUT){const i=fre(n);return{windowCenter:Tc(n,"x00281050",1),windowWidth:Tc(n,"x00281051",1),voiLUTSequence:m9(i,n.elements.x00283010),voiLUTFunction:n.string("x00281056")}}if(t===r.MODALITY_LUT)return{rescaleIntercept:n.floatString("x00281052"),rescaleSlope:n.floatString("x00281053"),rescaleType:n.string("x00281054"),modalityLUTSequence:m9(n.uint16("x00280103"),n.elements.x00283000)};if(t===r.SOP_COMMON)return{sopClassUID:n.string("x00080016"),sopInstanceUID:n.string("x00080018")};if(t===r.PET_ISOTOPE){const i=n.elements.x00540016;if(i===void 0)return;const a=i.items[0].dataSet;return{radiopharmaceuticalInfo:{radiopharmaceuticalStartTime:wi.parseTM(a.string("x00181072")||""),radionuclideTotalDose:a.floatString("x00181074"),radionuclideHalfLife:a.floatString("x00181075")}}}if(t===r.OVERLAY_PLANE)return gze(n);if(t==="transferSyntax"){let i;try{i=n.string("x00020010")}catch{}return{transferSyntaxUID:i}}if(t===r.PET_SERIES)return{correctedImage:n.string("x00280051"),units:n.string("x00541001"),decayCorrection:n.string("x00541102")};if(t===r.PET_IMAGE)return{frameReferenceTime:n.floatString(n.string("x00541300")||""),actualFrameDuration:n.intString(n.string("x00181242"))};if(t===r.ULTRASOUND_ENHANCED_REGION)return _B(n);if(t===r.CALIBRATION&&n.string("x00080060")==="US")return{sequenceOfUltrasoundRegions:_B(n)};if(t==="instance")return wre(e,rM,Cre)}let OS=[];function xze(t){return`dicomfile:${OS.push(t)-1}`}function bze(t){return OS[t]}function wze(t){OS[t]=void 0}function Cze(){OS=[]}const Tre={add:xze,get:bze,remove:wze,purge:Cze};function Sze(t){const e=t.intString("x00280008"),n=t.elements.x7fe00010;return e!==n.fragments.length}function Ere(t,e){if(t.elements.x7fe00010&&t.elements.x7fe00010.basicOffsetTable.length)return wi.readEncapsulatedImageFrame(t,t.elements.x7fe00010,e);if(Sze(t)){const c=wi.createJPEGBasicOffsetTable(t,t.elements.x7fe00010);return wi.readEncapsulatedImageFrame(t,t.elements.x7fe00010,e,c)}const n=t.elements.x7fe00010.fragments,r=new wi.ByteStream(t.byteArrayParser,t.byteArray,t.elements.x7fe00010.dataOffset),i=wi.readSequenceItem(r);if(i.tag!=="xfffee000")throw"dicomParser.readEncapsulatedPixelData: missing basic offset table xfffee000";r.seek(i.length);const a=r.position;if(e+1>n.length)throw"dicomParser.readEncapsulatedPixelData: frame exceeds number of fragments";const s=a+n[e].offset+8,l=n[e].length;return new Uint8Array(r.byteArray.buffer.slice(r.byteArray.byteOffset+s,r.byteArray.byteOffset+s+l))}function Tze(t,e){return t&1<<e}function _re(t,e,n){const r=new Uint8Array(n);for(let i=0;i<n;i++){const a=Math.floor(i/8),o=t[a+e],s=i%8;r[i]=Tze(o,s)?1:0}return r}function Dre(t,e){const n=t.elements.x7fe00010||t.elements.x7fe00008,r=t.uint16("x00280100"),i=t.uint16("x00280010"),a=t.uint16("x00280011");let o=t.uint16("x00280002");t.string("x00280004")==="YBR_FULL_422"&&(o=2,console.warn(`Using SamplesPerPixel of 2 for YBR_FULL_422 photometric interpretation.
      See http://dicom.nema.org/medical/dicom/current/output/chtml/part03/sect_C.7.6.3.html for more information.`));const l=n.dataOffset,c=i*a*o;let f;if(r===8){if(f=l+e*c,f>=t.byteArray.length)throw new Error("frame exceeds size of pixelData");return new Uint8Array(t.byteArray.buffer.slice(f,f+c))}else if(r===16){if(f=l+e*c*2,f>=t.byteArray.length)throw new Error("frame exceeds size of pixelData");return new Uint8Array(t.byteArray.buffer.slice(f,f+c*2))}else if(r===1){if(f=l+e*c*.125,f>=t.byteArray.length)throw new Error("frame exceeds size of pixelData");return _re(t.byteArray,f,c)}else if(r===32){if(f=l+e*c*4,f>=t.byteArray.length)throw new Error("frame exceeds size of pixelData");return new Uint8Array(t.byteArray.buffer.slice(f,f+c*4))}throw new Error("unsupported pixel format")}function Ore(t){const e=Xy(t),n=parseInt(e.url,10),r=Tre.get(n);return new Promise((i,a)=>{const o=new FileReader;o.onload=s=>{const l=s.target.result;i(l)},o.onerror=a,o.readAsArrayBuffer(r)})}function iM(t,e=0){const n=t.elements.x7fe00010||t.elements.x7fe00008;return n?n.encapsulatedPixelData?Ere(t,e):Dre(t,e):null}function MS(t){let e=t[0],n=t[0],r;const i=t.length;for(let a=1;a<i;a++)r=t[a],e=Math.min(e,r),n=Math.max(n,r);return{min:e,max:n}}function K8(t,e,n){t.planarConfiguration===0?are(t.pixelData,e,n):ore(t.pixelData,e,n)}function Eze(t,e,n){t.planarConfiguration===0?sre(t.pixelData,e,n):lre(t.pixelData,e,n)}function Mre(t,e,n){if(t.photometricInterpretation==="RGB")K8(t,e,n);else if(t.photometricInterpretation==="YBR_RCT")K8(t,e,n);else if(t.photometricInterpretation==="YBR_ICT")K8(t,e,n);else if(t.photometricInterpretation==="PALETTE COLOR")cre(t,e,n);else if(t.photometricInterpretation==="YBR_FULL_422")Nje(t.pixelData,e,n);else if(t.photometricInterpretation==="YBR_FULL")Eze(t,e,n);else throw new Error(`No color space conversion for photometric interpretation ${t.photometricInterpretation}`)}function _ze(t){if(t===void 0)return!1;const{rows:e,columns:n,photometricInterpretation:r,pixelDataLength:i,planarConfiguration:a}=t;return i===4*n*e?!1:r==="PALETTE COLOR"?!0:r.endsWith("420")?i===(3*Math.ceil(n/2)+Math.floor(n/2))*e:r.endsWith("422")?i===(3*Math.ceil(n/2)+Math.floor(n/2))*Math.ceil(e/2)+Math.floor(e/2)*n:r!=="RGB"||a===1}function Dze(t){return Oze(String.fromCharCode.apply(null,Array.prototype.slice.apply(new Uint8Array(t))))}function Oze(t){let e;try{return decodeURIComponent(escape(t))}catch(n){if(e=n,e instanceof URIError)return t;throw e}}function Ire(t,e,n){const r=new Date().getTime(),i=new Blob([e],{type:"image/jpeg"});return new Promise((a,o)=>{const s=new FileReader;s.readAsBinaryString===void 0?s.readAsArrayBuffer(i):s.readAsBinaryString(i),s.onload=function(){const l=new Image;l.onload=function(){n.height=l.height,n.width=l.width,t.rows=l.height,t.columns=l.width;const c=n.getContext("2d");c.drawImage(this,0,0);const f=c.getImageData(0,0,l.width,l.height),u=new Date().getTime();t.pixelData=new Uint8Array(f.data.buffer),t.imageData=f,t.decodeTimeInMS=u-r;const d=MS(t.pixelData);t.smallestPixelValue=d.min,t.largestPixelValue=d.max,t.pixelDataLength=t.pixelData.length,a(t)},l.onerror=function(c){o(c)},s.readAsBinaryString===void 0?l.src=`data:image/jpeg;base64,${window.btoa(Dze(s.result))}`:l.src=`data:image/jpeg;base64,${window.btoa(s.result)}`},s.onerror=l=>{o(l)}})}function ws(t,e,n,r,i){const a={...r};delete a.loader,delete a.streamingData;const o=Bm(),s=a.priority||void 0;return a.transferPixelData&&n.buffer,o.executeTask("dicomImageLoader","decodeTask",{imageFrame:t,transferSyntax:e,pixelData:n,options:a,decodeConfig:i},{priority:s,requestType:a?.requestType})}function Mze(t,e,n,r,i={},a){switch(e){case"1.2.840.10008.1.2":return ws(t,e,n,i,a);case"1.2.840.10008.1.2.1":return ws(t,e,n,i,a);case"1.2.840.10008.1.2.2":return ws(t,e,n,i,a);case"1.2.840.10008.1.2.1.99":return ws(t,e,n,i,a);case"1.2.840.10008.1.2.5":return ws(t,e,n,i,a);case"1.2.840.10008.1.2.4.50":return t.bitsAllocated===8&&(t.samplesPerPixel===3||t.samplesPerPixel===4)?Ire(t,n,r):ws(t,e,n,i,a);case"1.2.840.10008.1.2.4.51":return ws(t,e,n,i,a);case"1.2.840.10008.1.2.4.57":return ws(t,e,n,i,a);case"1.2.840.10008.1.2.4.70":return ws(t,e,n,i,a);case"1.2.840.10008.1.2.4.80":return ws(t,e,n,i,a);case"1.2.840.10008.1.2.4.81":return ws(t,e,n,i,a);case"1.2.840.10008.1.2.4.90":return ws(t,e,n,i,a);case"1.2.840.10008.1.2.4.91":return ws(t,e,n,i,a);case"3.2.840.10008.1.2.4.96":case"1.2.840.10008.1.2.4.201":case"1.2.840.10008.1.2.4.202":case"1.2.840.10008.1.2.4.203":return ws(t,e,n,i,a)}return Promise.reject(new Error(`No decoder for transfer syntax ${e}`))}function Rre(t){const e=Ut("imagePixelModule",t);return{samplesPerPixel:e.samplesPerPixel,photometricInterpretation:e.photometricInterpretation,planarConfiguration:e.planarConfiguration,rows:e.rows,columns:e.columns,bitsAllocated:e.bitsAllocated,bitsStored:e.bitsStored,pixelRepresentation:e.pixelRepresentation,smallestPixelValue:e.smallestPixelValue,largestPixelValue:e.largestPixelValue,redPaletteColorLookupTableDescriptor:e.redPaletteColorLookupTableDescriptor,greenPaletteColorLookupTableDescriptor:e.greenPaletteColorLookupTableDescriptor,bluePaletteColorLookupTableDescriptor:e.bluePaletteColorLookupTableDescriptor,redPaletteColorLookupTableData:e.redPaletteColorLookupTableData,greenPaletteColorLookupTableData:e.greenPaletteColorLookupTableData,bluePaletteColorLookupTableData:e.bluePaletteColorLookupTableData,pixelData:void 0,imageId:t}}function Ize(t,e){const n=t.get("modalityLutModule",e)||{},r=t.get("generalSeriesModule",e)||{},{modality:i}=r,a={rescaleSlope:n.rescaleSlope,rescaleIntercept:n.rescaleIntercept,modality:i},o=t.get("scalingModule",e)||{};return{...a,...i==="PT"&&{suvbw:o.suvbw},...i==="RTDOSE"&&{doseGridScaling:o.DoseGridScaling,doseSummation:o.DoseSummation,doseType:o.DoseType,doseUnit:o.DoseUnit}}}function aM(t){return t==="RGB"||t==="PALETTE COLOR"||t==="YBR_FULL"||t==="YBR_FULL_422"||t==="YBR_PARTIAL_422"||t==="YBR_PARTIAL_420"||t==="YBR_RCT"||t==="YBR_ICT"}function Rze(t,e){const n=t.length/4;let r=0,i=0;for(let a=0;a<n;a++)e[i++]=t[r++],e[i++]=t[r++],e[i++]=t[r++],r++;return e}function Pze(t){return t!=="1.2.840.10008.5.1.4.1.1.12.1"&&t!=="1.2.840.10008.5.1.4.1.1.12.2.1"}function oM(t,e){let n;return Number.isInteger(t)&&Number.isInteger(e)&&(t>=0?e<=255?n=Uint8Array:e<=65535?n=Uint16Array:e<=4294967295&&(n=Uint32Array):t>=-128&&e<=127?n=Int8Array:t>=-32768&&e<=32767&&(n=Int16Array)),n||Float32Array}function Aze(t,e,n){return oM(t,e)===n}function Nze(t){const e=t.smallestPixelValue,n=t.largestPixelValue,r=oM(e,n);if(r){const i=new r(t.pixelData);t.pixelData=i}else throw new Error("Could not apply a typed array to the pixel data")}let DB="";function IS(t,e,n,r={}){const i=r.useRGBA;if(r.preScale={enabled:r.preScale&&r.preScale.enabled!==void 0?r.preScale.enabled:!0},!e?.length)return Promise.reject(new Error("The pixel data is missing"));const{MetadataModules:a}=ll,o=document.createElement("canvas"),s=Rre(t);if(s.decodeLevel=r.decodeLevel,r.allowFloatRendering=IC(),r.preScale.enabled){const u=Ize(AZ,t);u&&(r.preScale={...r.preScale,scalingParameters:u})}const{decodeConfig:l}=Yy();Object.keys(s).forEach(u=>{(typeof s[u]=="function"||s[u]instanceof Promise)&&delete s[u]});const c=Mze(s,n,e,o,r,l),f=aM(s.photometricInterpretation);return new Promise((u,d)=>{c.then(function(h){let p=!1;if(r.targetBuffer&&r.targetBuffer.type&&!f){const{arrayBuffer:I,type:R,offset:O=0,length:P}=r.targetBuffer,N=h.pixelDataLength,A=O,B=P??N-A,V={Uint8Array,Uint16Array,Int16Array,Float32Array,Uint32Array};if(B!==h.pixelDataLength)throw new Error(`target array for image does not have the same length (${B}) as the decoded image length (${h.pixelDataLength}).`);const $=V[R],U=I?new $(I,A,B):new $(h.pixelData);if(B!==h.pixelDataLength)throw new Error("target array for image does not have the same length as the decoded image length.");h.pixelData=U,p=!0}p||Nze(h);const g=Ut(a.IMAGE_PLANE,t)||{},m=Ut(a.VOI_LUT,t)||{},y=Ut(a.MODALITY_LUT,t)||{},v=Ut(a.SOP_COMMON,t)||{},x=Ut(a.CALIBRATION,t)||{},{rows:w,columns:S}=h;if(f){if(_ze(h)){o.height=h.rows,o.width=h.columns;let O=o.getContext("2d").createImageData(h.columns,h.rows);i||(O={...O,data:new Uint8ClampedArray(3*h.columns*h.rows)}),Mre(h,O.data,i),h.imageData=O,h.pixelData=O.data,h.pixelDataLength=O.data.length}else if(!i&&h.pixelDataLength===4*w*S){const R=new Uint8Array(h.pixelData.length/4*3);h.pixelData=Rze(h.pixelData,R),h.pixelDataLength=h.pixelData.length}const I=MS(h.pixelData);h.smallestPixelValue=I.min,h.largestPixelValue=I.max}let T=h.samplesPerPixel;h.photometricInterpretation==="PALETTE COLOR"&&(T=i?4:3);const _=a0.createImageVoxelManager({scalarData:h.pixelData,width:h.columns,height:h.rows,numberOfComponents:T}),D={imageId:t,dataType:h.pixelData.constructor.name,color:f,calibration:x,columnPixelSpacing:g.columnPixelSpacing,columns:h.columns,height:h.rows,preScale:h.preScale,intercept:y.rescaleIntercept?y.rescaleIntercept:0,slope:y.rescaleSlope?y.rescaleSlope:1,invert:h.photometricInterpretation==="MONOCHROME1",minPixelValue:h.smallestPixelValue,maxPixelValue:h.largestPixelValue,rowPixelSpacing:g.rowPixelSpacing,rows:h.rows,sizeInBytes:h.pixelData.byteLength,width:h.columns,windowCenter:m.windowCenter?m.windowCenter[0]:void 0,windowWidth:m.windowWidth?m.windowWidth[0]:void 0,voiLUTFunction:m.voiLUTFunction?m.voiLUTFunction:void 0,decodeTimeInMS:h.decodeTimeInMS,floatPixelData:void 0,imageFrame:h,voxelManager:_,rgba:f&&i,getPixelData:()=>h.pixelData,getCanvas:void 0,numberOfComponents:T};if(D.color&&(D.getCanvas=function(){if(DB===t)return o;const I=D.columns,R=D.rows;o.height=R,o.width=I;const O=o.getContext("2d"),P=O.createImageData(I,R),N=h.pixelData;if(N.length===I*R*4)for(let A=0;A<N.length;A++)P.data[A]=N[A];else if(N.length===I*R*3){let A=0;for(let B=0;B<N.length;B+=3)P.data[A++]=N[B],P.data[A++]=N[B+1],P.data[A++]=N[B+2],P.data[A++]=255}return h.pixelData=P.data,h.pixelDataLength=P.data.length,h.imageData=P,O.putImageData(h.imageData,0,0),DB=t,o}),y.modalityLUTSequence&&y.modalityLUTSequence.length>0&&Pze(v.sopClassUID)&&(D.modalityLUT=y.modalityLUTSequence[0]),m.voiLUTSequence&&m.voiLUTSequence.length>0&&(D.voiLUT=m.voiLUTSequence[0]),D.color&&(D.windowWidth=256,D.windowCenter=128),D.windowCenter===void 0||D.windowWidth===void 0){const I=Py(D.imageFrame.smallestPixelValue,D.imageFrame.largestPixelValue);D.windowWidth=I.windowWidth,D.windowCenter=I.windowCenter}u(D)},d)})}const{ImageQualityStatus:Pre}=ll;function Lze(t,e){t.decache=function(){const n=Xy(e);im.unload(n.url)}}function Are(t,e,n=0,r,i,a){const o=new Date().getTime(),s={cancelFn:void 0,promise:void 0};return s.promise=new Promise((l,c)=>{t.then(f=>{const u=iM(f,n),d=f.string("x00020010"),h=new Date().getTime(),p=IS(e,u,d,i);Lze(s,e),p.then(g=>{g=g,g.data=f,g.sharedCacheKey=r;const m=new Date().getTime();g.loadTimeInMS=h-o,g.totalTimeInMS=m-o,g.imageQualityStatus=Pre.FULL_RESOLUTION,a!==void 0&&a.imageDoneCallback!==void 0&&a.imageDoneCallback(g),l(g)},function(g){c({error:g,dataSet:f})})},function(f){c({error:f})})}),s}function kze(t,e,n=0,r,i){const a=new Date().getTime();return{promise:new Promise((s,l)=>{const c=new Date().getTime();let f;try{const u=iM(t,n),d=t.string("x00020010");f=IS(e,u,d,i)}catch(u){l({error:u,dataSet:t});return}f.then(u=>{u=u,u.data=t;const d=new Date().getTime();u.loadTimeInMS=c-a,u.totalTimeInMS=d-a,u.imageQualityStatus=Pre.FULL_RESOLUTION,s(u)},l)}),cancelFn:void 0}}function Nre(t){if(t==="dicomweb"||t==="wadouri")return _S;if(t==="dicomfile")return Ore}function xw(t,e={}){const n=Xy(t);e=Object.assign({},e),delete e.loader;const r=Nre(n.scheme);if(im.isLoaded(n.url)){const a=im.get(n.url,r,t);return kze(a,t,n.pixelDataFrame,n.url,e)}const i=im.load(n.url,r,t);return Are(i,t,n.frame,n.url,e)}function Lre(){qg("dicomweb",xw),qg("wadouri",xw),qg("dicomfile",xw),Km(rM)}const Vze={getImagePixelModule:ure,getLUTs:m9,getModalityLUTOutputPixelRepresentation:fre,getNumberValues:Tc,metaDataProvider:rM,metadataForDataset:Sre},Fze={metaData:Vze,dataSetCacheManager:im,fileManager:Tre,getEncapsulatedImageFrame:Ere,getUncompressedImageFrame:Dre,loadFileRequest:Ore,loadImageFromPromise:Are,getLoaderForScheme:Nre,getPixelData:iM,loadImage:xw,parseImageId:Xy,unpackBinaryFrame:_re,register:Lre};function yn(t,e,n){return e=e||0,!t||!t.Value||Array.isArray(t.Value)&&t.Value.length<=e?n:t.Value[e]}function Uze(t,e,n){const r=yn(t,e,n);if(r!==void 0)return parseFloat(String(r))}function fr(t,e){const n=yn(t,e);if(n!==void 0)return parseFloat(n)}function Mo(t,e){if(!t||!t.Value||!Array.isArray(t.Value)||e&&t.Value.length<e)return;const n=[];for(let r=0;r<t.Value.length;r++)n.push(parseFloat(t.Value[r]));return n}function Bze(t){const e=[];for(let n=0;n<=30;n+=2){let r=`x60${n.toString(16)}`;r.length===4&&(r=`x600${n.toString(16)}`);const i=yn(t[`${r}3000`]);if(!i)continue;const a=[];for(let o=0;o<i.length;o++)for(let s=0;s<8;s++){const l=t.Value[i.dataOffset+o];a[o*8+s]=l>>s&1}e.push({rows:fr(t[`${r}0010`]),columns:fr(t[`${r}0011`]),type:yn(t[`${r}0040`]),x:fr(t[`${r}0050`],1)-1,y:fr(t[`${r}0050`],0)-1,pixelData:a,description:yn(t[`${r}0022`]),label:yn(t[`${r}1500`]),roiArea:yn(t[`${r}1301`]),roiMean:yn(t[`${r}1302`]),roiStandardDeviation:yn(t[`${r}1303`])})}return{overlays:e}}function RS(t){const e=t.indexOf(":");return t.substring(e+1)}function am(t,e=!0){return t&&t.Value?t.Value[0]&&e?t.Value[0]:t.Value:t}function kre(t,e,n){const r=(e?Object.values(e[0]):[]).map(a=>a.Value?.[0]).filter(a=>a!==void 0&&typeof a=="object"),i=(t?Object.values(t[n-1]):[]).map(a=>a.Value?.[0]).filter(a=>a!==void 0&&typeof a=="object");return{shared:r,perFrame:i}}function Vre(t){let{52009230:e,52009229:n,"00280008":r,...i}=t;return e=am(e,!1),n=am(n,!1),r=am(r),{PerFrameFunctionalGroupsSequence:e,SharedFunctionalGroupsSequence:n,NumberOfFrames:r,rest:i}}function $ze(t,e){const{PerFrameFunctionalGroupsSequence:n,SharedFunctionalGroupsSequence:r,NumberOfFrames:i,rest:a}=Vre(e);if(n||i>1){const{shared:o,perFrame:s}=kre(n,r,t),l=Object.assign(e,{frameNumber:t});return[...o,...s].forEach(c=>{Object.entries(c).forEach(([f,u])=>{l[f]=u})}),Object.assign(a,{"00280008":i},l)}return e}let Jy=[],Y3={};function Fre(t){const e=t.indexOf("/frames/")+8,n=t.slice(0,e),r=parseInt(t.slice(e),10);return{metadata:Jy[`${n}1`],frame:r}}function Gze(t){const e=RS(t);return Fre(e)}function jze(t){if(t[52009230]!==void 0||t[52009229]!==void 0)return!0;const e=yn(t["00280008"]);return e&&e>1}function zze(t,e){const n=RS(t);Object.defineProperty(e,"isMultiframe",{value:jze(e),enumerable:!1}),Jy[n]=e}function Wze(t){const e=RS(t),n=Jy[e];if(n&&!n?.isMultiframe)return n;const r=Y3[e];if(r)return r;const i=Fre(e);if(!i||!i.metadata)return;const{metadata:a,frame:o}=i;if(a){const s=$ze(o,a);return Y3[e]=s,s}}function Hze(t){const e=RS(t);Jy[e]=void 0,Y3[e]=void 0}function Kze(){Jy=[],Y3={}}const sM={add:zze,get:Wze,remove:Hze,purge:Kze};function Ure(t){return yn(t["00080060"]).includes("NM")}function lM(t,e){const n=am(t["00080008"],!1);if(n)return n[e]}function qze(t){let e;const n=lM(t,2);if(n&&a1(n)){const r=am(t["00540022"]);r&&(e=Mo(r["00200037"],6))}return e}function Xze(t){let e;const n=lM(t,2);if(n&&a1(n)){const r=am(t["00540022"]);r&&(e=Mo(r["00200032"],3))}return e}function OB(t){let e=Mo(t["00200037"],6);return!e&&Ure(t)&&(e=qze(t)),e}function MB(t){let e=Mo(t["00200032"],3);return!e&&Ure(t)&&(e=Xze(t)),e}function Do(t,e){const n=Mo(t[e]);return n?n[0]:null}function Yze(t){return t?.Value?.length?Array.isArray(t.Value)?t.Value:typeof t.Value=="object"?(console.warn("Warning: Value should be an array, but an object was found. Encapsulating the object in an array."),[t.Value]):[]:[]}function IB(t){const e=Yze(t["00186011"]);return!e||!e.length?null:e.map(r=>{const i=Do(r,"0018602C"),a=Do(r,"0018602E"),o=Do(r,"00186024"),s=Do(r,"00186026"),l=Do(r,"0018601A"),c=Do(r,"0018601E"),f=Do(r,"00186018"),u=Do(r,"0018601C"),d=Do(r,"00186020"),h=Do(r,"00186022"),p=Do(r,"0018602A"),g=Do(r,"00186028"),m=Do(r,"00186012"),y=Do(r,"00186014"),v=Do(r,"00186016"),x=Do(r,"00186030");return{regionLocationMinY0:l,regionLocationMaxY1:c,regionLocationMinX0:f,regionLocationMaxX1:u,referencePixelX0:d,referencePixelY0:h,physicalDeltaX:i,physicalDeltaY:a,physicalUnitsXDirection:o,physicalUnitsYDirection:s,referencePhysicalPixelValueY:p,referencePhysicalPixelValueX:g,regionSpatialFormat:m,regionDataType:y,regionFlags:v,transducerFrequency:x}})}function cM(t,e){const{MetadataModules:n}=ll;if(t===n.MULTIFRAME){const{metadata:i,frame:a}=Gze(e);if(!i)return;const{PerFrameFunctionalGroupsSequence:o,SharedFunctionalGroupsSequence:s,NumberOfFrames:l}=Vre(i);if(o||l>1){const{shared:c,perFrame:f}=kre(o,s,a);return{NumberOfFrames:l,PerFrameFunctionalInformation:f,SharedFunctionalInformation:c}}return{NumberOfFrames:l}}const r=sM.get(e);if(r){if(t===n.GENERAL_STUDY)return{studyDescription:yn(r["00081030"]),studyDate:wi.parseDA(yn(r["00080020"])),studyTime:wi.parseTM(yn(r["00080030"],0,"")),accessionNumber:yn(r["00080050"])};if(t===n.GENERAL_SERIES)return{modality:yn(r["00080060"]),seriesInstanceUID:yn(r["0020000E"]),seriesDescription:yn(r["0008103E"]),seriesNumber:fr(r["00200011"]),studyInstanceUID:yn(r["0020000D"]),seriesDate:wi.parseDA(yn(r["00080021"])),seriesTime:wi.parseTM(yn(r["00080031"],0,"")),acquisitionDate:wi.parseDA(yn(r["00080022"])),acquisitionTime:wi.parseTM(yn(r["00080032"],0,""))};if(t===n.GENERAL_IMAGE)return{sopInstanceUID:yn(r["00080018"]),instanceNumber:fr(r["00200013"]),lossyImageCompression:yn(r["00282110"]),lossyImageCompressionRatio:fr(r["00282112"]),lossyImageCompressionMethod:yn(r["00282114"])};if(t===n.PATIENT)return{patientID:yn(r["00100020"]),patientName:yn(r["00100010"])};if(t===n.PATIENT_STUDY)return{patientAge:fr(r["00101010"]),patientSize:fr(r["00101020"]),patientSex:yn(r["00100040"]),patientWeight:fr(r["00101030"])};if(t===n.NM_MULTIFRAME_GEOMETRY){const i=yn(r["00080060"]),a=lM(r,2);return{modality:i,imageType:yn(r["00080008"]),imageSubType:a,imageOrientationPatient:OB(r),imagePositionPatient:MB(r),sliceThickness:fr(r["00180050"]),spacingBetweenSlices:fr(r["00180088"]),pixelSpacing:Mo(r["00280030"],2),numberOfFrames:fr(r["00280008"]),isNMReconstructable:a1(a)&&i.includes("NM")}}if(t===n.IMAGE_PLANE){let i=OB(r),a=MB(r);const o=Mo(r["00280030"],2);let s=null,l=null,c=null,f=null,u=!1;return o?(l=o[0],s=o[1]):(u=!0,l=1,s=1),i?(c=[parseFloat(i[0]),parseFloat(i[1]),parseFloat(i[2])],f=[parseFloat(i[3]),parseFloat(i[4]),parseFloat(i[5])]):(c=[1,0,0],f=[0,1,0],u=!0,i=[...c,...f]),a||(a=[0,0,0],u=!0),{frameOfReferenceUID:yn(r["00200052"]),rows:fr(r["00280010"]),columns:fr(r["00280011"]),imageOrientationPatient:i,rowCosines:c,columnCosines:f,imagePositionPatient:a,sliceThickness:fr(r["00180050"]),sliceLocation:fr(r["00201041"]),pixelSpacing:o,rowPixelSpacing:l,columnPixelSpacing:s,usingDefaultValues:u}}if(t===n.ULTRASOUND_ENHANCED_REGION)return IB(r);if(t===n.CALIBRATION&&yn(r["00080060"])==="US")return{sequenceOfUltrasoundRegions:IB(r)};if(t===n.IMAGE_URL)return Jze(e,r);if(t===n.CINE)return Zze(e,r);if(t===n.IMAGE_PIXEL)return{samplesPerPixel:fr(r["00280002"]),photometricInterpretation:yn(r["00280004"]),rows:fr(r["00280010"]),columns:fr(r["00280011"]),bitsAllocated:fr(r["00280100"]),bitsStored:fr(r["00280101"]),highBit:yn(r["00280102"]),pixelRepresentation:fr(r["00280103"]),planarConfiguration:fr(r["00280006"]),pixelAspectRatio:yn(r["00280034"]),smallestPixelValue:fr(r["00280106"]),largestPixelValue:fr(r["00280107"]),redPaletteColorLookupTableDescriptor:Mo(r["00281101"]),greenPaletteColorLookupTableDescriptor:Mo(r["00281102"]),bluePaletteColorLookupTableDescriptor:Mo(r["00281103"]),redPaletteColorLookupTableData:Mo(r["00281201"]),greenPaletteColorLookupTableData:Mo(r["00281202"]),bluePaletteColorLookupTableData:Mo(r["00281203"])};if(t===n.VOI_LUT)return{windowCenter:Mo(r["00281050"],1),windowWidth:Mo(r["00281051"],1),voiLUTFunction:yn(r["00281056"])};if(t===n.MODALITY_LUT)return{rescaleIntercept:fr(r["00281052"]),rescaleSlope:fr(r["00281053"]),rescaleType:yn(r["00281054"])};if(t===n.SOP_COMMON)return{sopClassUID:yn(r["00080016"]),sopInstanceUID:yn(r["00080018"])};if(t===n.PET_ISOTOPE){const i=yn(r["00540016"]);return i===void 0?void 0:{radiopharmaceuticalInfo:{radiopharmaceuticalStartTime:wi.parseTM(yn(i["00181072"],0,"")),radiopharmaceuticalStartDateTime:yn(i["00181078"],0,""),radionuclideTotalDose:fr(i["00181074"]),radionuclideHalfLife:fr(i["00181075"])}}}if(t===n.OVERLAY_PLANE)return Bze(r);if(t==="transferSyntax")return Bre(e,r);if(t===n.PET_SERIES)return{correctedImage:yn(r["00280051"]),units:yn(r["00541001"]),decayCorrection:yn(r["00541102"])};if(t===n.PET_IMAGE)return{frameReferenceTime:fr(r["00541300"]),actualFrameDuration:fr(r["00181242"])};if(t==="instance")return wre(e,cM,Cre)}}function Jze(t,e){const{transferSyntaxUID:n}=Bre(t,e),r=iee(n),i=t.substring(7),a=i.replace("/frames/","/thumbnail/");let o=i.replace("/frames/","/rendered/");return r&&(o=o.replace("/rendered/1","/rendered")),{isVideo:r,rendered:o,thumbnail:a}}function Zze(t,e){return{cineRate:yn(e["00180040"]),numberOfFrames:fr(e["00280008"])}}function Bre(t,e){return{transferSyntaxUID:yn(e["00020010"])||yn(e["00083002"])}}function Qze(t,e,n={},r={}){const i=Yy(),{retrieveOptions:a={},streamingData:o}=r,s=o.chunkSize||tWe(e,a,"chunkSize")||65536,l=f=>{if(typeof i.errorInterceptor=="function"){const u=new Error("request failed");i.errorInterceptor(u)}else console.warn("rangeRequest:Caught",f)};return new Promise(async(f,u)=>{const d=Object.assign({},n);Object.keys(d).forEach(function(h){(d[h]===null||d[h]===void 0)&&delete d[h]});try{o.encodedData||(o.chunkSize=s,o.rangesFetched=0);const h=nWe(o,a),{encodedData:p,responseHeaders:g}=await eWe(t,d,h,o),m=g.get("content-type"),{totalBytes:y}=o,v=y===p.byteLength,x=QO(m,p,{isPartial:!0}),w=eM(a,v||x.extractDone===!0);f({...x,imageQualityStatus:w,percentComplete:x.extractDone?100:s*100/y})}catch(h){l(h),console.error(h),u(h)}})}async function eWe(t,e,n,r){n&&(e=Object.assign(e,{Range:`bytes=${n[0]}-${n[1]}`}));let{encodedData:i}=r;if(n[1]&&i?.byteLength>n[1])return r;const a=await fetch(t,{headers:e,signal:void 0}),o=await a.arrayBuffer(),s=new Uint8Array(o),{status:l}=a;let c;i?(c=new Uint8Array(i.length+s.length),c.set(i,0),c.set(s,i.length),r.rangesFetched=1):(c=new Uint8Array(s.length),c.set(s,0),r.rangesFetched++),r.encodedData=i=c,r.responseHeaders=a.headers;const f=a.headers.get("Content-Range");return f?r.totalBytes=Number(f.split("/")[1]):l!==206||!n?r.totalBytes=i?.byteLength:n[1]===""||i?.length<n[1]?r.totalBytes=i.byteLength:r.totalBytes=Number.MAX_SAFE_INTEGER,r}function tWe(t,e,n){const r=e[n];if(typeof r!="function")return r;const i=sM.get(t);return r(i,t)}function nWe(t,e){const{totalBytes:n,encodedData:r,chunkSize:i=65536}=t,{rangeIndex:a=0}=e;return a===-1&&(!n||!r)?[0,""]:a===-1||r?.byteLength>n-i?[r?.byteLength||0,""]:[r?.byteLength||0,i*(a+1)-1]}function uM(t,e,n="application/octet-stream",r){const{streamingData:i,retrieveOptions:a={}}=r||{},o={Accept:n};let s=a.urlArguments?`${t}${t.indexOf("?")===-1?"?":"&"}${a.urlArguments}`:t;if(a.framesPath&&(s=s.replace("/frames/",a.framesPath)),i?.url!==s&&(r.streamingData={url:s}),a.rangeIndex!==void 0)return Qze(s,e,o,r);if(a.streaming)return gre(s,e,o,r);const l=_S(s,e,o),{xhr:c}=l;return l.then(function(f){const u=c.getResponseHeader("Content-Type")||"application/octet-stream",d=QO(u,new Uint8Array(f));return d.imageQualityStatus=eM(a,!0),d})}const{ProgressiveIterator:RB}=Yr,{ImageQualityStatus:PB}=ll,rWe=new Set(["3.2.840.10008.1.2.4.96","1.2.840.10008.1.2.4.202","1.2.840.10008.1.2.4.203"]);function iWe(t){const e="1.2.840.10008.1.2";if(!t)return e;const n=t.split(";"),r={};n.forEach(a=>{const o=a.split("=");if(o.length!==2)return;const s=o[1].trim().replace(/"/g,"");r[o[0].trim()]=s});const i={"image/jpeg":"1.2.840.10008.1.2.4.50","image/x-dicom-rle":"1.2.840.10008.1.2.5","image/x-jls":"1.2.840.10008.1.2.4.80","image/jls":"1.2.840.10008.1.2.4.80","image/jll":"1.2.840.10008.1.2.4.70","image/jp2":"1.2.840.10008.1.2.4.90","image/jpx":"1.2.840.10008.1.2.4.92","image/jphc":"3.2.840.10008.1.2.4.96","image/jxl":"1.2.840.10008.1.2.4.140"};return r["transfer-syntax"]?r["transfer-syntax"]:t&&!Object.keys(r).length&&i[t]?i[t]:r.type&&i[r.type]?i[r.type]:i[t]?i[t]:e}function aWe(){return Zm}const oWe="multipart/related; type=application/octet-stream; transfer-syntax=*";function $re(t,e={}){const n=aWe(),r=new Date().getTime(),i=new RB("decompress");async function a(f,u,d){i.generate(async h=>{const p=RB.as(uM(f,u,d,e));let g=10;for await(const m of p){const{pixelData:y,imageQualityStatus:v=PB.FULL_RESOLUTION,percentComplete:x,done:w=!0,extractDone:S=!0}=m,T=iWe(m.contentType);if(!S&&!rWe.has(T))continue;const _=m.decodeLevel??(v===PB.FULL_RESOLUTION?0:sWe(x,e.retrieveOptions?.decodeLevel));if(!(!w&&g<=_))try{const D={...e,decodeLevel:_},I=await IS(u,y,T,D),R=new Date().getTime();I.loadTimeInMS=R-r,I.transferSyntaxUID=T,I.imageQualityStatus=v,h.add(I,w),g=_}catch(D){if(S)throw console.warn("Couldn't decode",D),D}}})}const o=e.requestType||_n.Interaction,s=e.additionalDetails||{imageId:t},l=e.priority===void 0?5:e.priority,c=t.substring(7);return n.addRequest(a.bind(this,c,t,oWe),o,s,l),{promise:i.getDonePromise(),cancelFn:void 0}}function sWe(t,e=4){const n=t/100-.02;return n>1/4?Math.min(e,0):n>1/16?Math.min(e,1):n>1/64?Math.min(e,2):Math.min(e,3)}function Gre(){qg("wadors",$re),Km(cM)}const lWe={getNumberString:Uze,getNumberValue:fr,getNumberValues:Mo,getValue:yn,metaDataProvider:cM},cWe={metaData:lWe,findIndexOfString:y9,getPixelData:uM,loadImage:$re,metaDataManager:sM,register:Gre};function uWe(){Gre(),Lre()}const fWe=()=>new Worker(new URL("/assets/decodeImageFrameWorker-CfQCdrMB.js",import.meta.url),{type:"module"});function jre(t={}){pre(t),uWe();const e=Bm(),n=t?.maxWebWorkers||dWe();e.registerWorker("dicomImageLoader",fWe,{maxWorkerInstances:n})}function dWe(){return typeof navigator<"u"&&navigator.hardwareConcurrency?Math.max(1,Math.floor(navigator.hardwareConcurrency/2)):1}function hWe(t,e){if(e=e||t.transferSyntax,t.bitsAllocated===8&&e==="1.2.840.10008.1.2.4.50"&&(t.samplesPerPixel===3||t.samplesPerPixel===4))return!0}const pWe={IMPLICIT_VR_LITTLE_ENDIAN:"1.2.840.10008.1.2",EXPLICIT_VR_LITTLE_ENDIAN:"1.2.840.10008.1.2.1",DEFLATED_EXPLICIT_VR_LITTLE_ENDIAN:"1.2.840.10008.1.2.1.99",EXPLICIT_VR_BIG_ENDIAN:"1.2.840.10008.1.2.2",JPEG_BASELINE_PROCESS_1:"1.2.840.10008.1.2.4.50",JPEG_EXTENDED_PROCESS_2_4:"1.2.840.10008.1.2.4.51",JPEG_EXTENDED_PROCESSES_3_5:"1.2.840.10008.1.2.4.52",JPEG_SPECTRAL_SELECTION_NONHIERARCHICAL_PROCESSES_6_8:"1.2.840.10008.1.2.4.53",JPEG_SPECTRAL_SELECTION_NONHIERARCHICAL_PROCESSES_7_9:"1.2.840.10008.1.2.4.54",JPEG_FULL_PROGRESSION_NONHIERARCHICAL_PROCESSES_10_12:"1.2.840.10008.1.2.4.55",JPEG_FULL_PROGRESSION_NONHIERARCHICAL_PROCESSES_11_13:"1.2.840.10008.1.2.4.56",JPEG_LOSSLESS_NONHIERARCHICAL_PROCESS_14:"1.2.840.10008.1.2.4.57",JPEG_LOSSLESS_NONHIERARCHICAL_PROCESS_15:"1.2.840.10008.1.2.4.58",JPEG_EXTENDED_HIERARCHICAL_PROCESSES_16_18:"1.2.840.10008.1.2.4.59",JPEG_EXTENDED_HIERARCHICAL_PROCESSES_17_19:"1.2.840.10008.1.2.4.60",JPEG_SPECTRAL_SELECTION_HIERARCHICAL_PROCESSES_20_22:"1.2.840.10008.1.2.4.61",JPEG_SPECTRAL_SELECTION_HIERARCHICAL_PROCESSES_21_23:"1.2.840.10008.1.2.4.62",JPEG_FULL_PROGRESSION_HIERARCHICAL_PROCESSES_24_26:"1.2.840.10008.1.2.4.63",JPEG_FULL_PROGRESSION_HIERARCHICAL_PROCESSES_25_27:"1.2.840.10008.1.2.4.64",JPEG_LOSSLESS_NONHIERARCHICAL_PROCESS_28:"1.2.840.10008.1.2.4.65",JPEG_LOSSLESS_NONHIERARCHICAL_PROCESS_29:"1.2.840.10008.1.2.4.66",JPEG_LOSSLESS_NONHIERARCHICAL_FIRST_ORDER_PREDICTION_PROCESS_14:"1.2.840.10008.1.2.4.70",JPEG_LS_LOSSLESS_IMAGE_COMPRESSION:"1.2.840.10008.1.2.4.80",JPEG_LS_LOSSY_NEAR_LOSSLESS_IMAGE_COMPRESSION:"1.2.840.10008.1.2.4.81",JPEG_2000_IMAGE_COMPRESSION_LOSSLESS_ONLY:"1.2.840.10008.1.2.4.90",JPEG_2000_IMAGE_COMPRESSION:"1.2.840.10008.1.2.4.91",JPEG_2000_PART_2_MULTICOMPONENT_IMAGE_COMPRESSION_LOSSLESS_ONLY:"1.2.840.10008.1.2.4.92",JPEG_2000_PART_2_MULTICOMPONENT_IMAGE_COMPRESSION:"1.2.840.10008.1.2.4.93",JPIP_REFERENCED:"1.2.840.10008.1.2.4.94",JPIP_REFERENCED_DEFLATE:"1.2.840.10008.1.2.4.95",MPEG2_MAIN_PROFILE_MAIN_LEVEL:"1.2.840.10008.1.2.4.100",MPEG4_AVC_H264_HIGH_PROFILE_LEVEL_4_1:"1.2.840.10008.1.2.4.101",MPEG4_AVC_H264_BD_COMPATIBLE_HIGH_PROFILE_LEVEL_4_1:"1.2.840.10008.1.2.4.102",MPEG4_AVC_H264_HIGH_PROFILE_FOR_2D_VIDEO:"1.2.840.10008.1.2.4.103",MPEG4_AVC_H264_HIGH_PROFILE_FOR_3D_VIDEO:"1.2.840.10008.1.2.4.104",JPIP_LOSSLESS:"1.2.840.10008.1.2.4.96",JPIP_PART2_MULTICOMPONENT_IMAGE_COMPRESSION:"1.2.840.10008.1.2.4.97",RFC_2557_MIME_ENCAPSULATION:"1.2.840.10008.1.2.6.1",JPEG_XR_IMAGE_COMPRESSION:"1.2.840.10008.1.2.6.2",JPEG_2000_IMAGE_COMPRESSION_LOSSLESS_ONLY_RETIRED:"1.2.840.10008.1.2.4.90R",JPEG_2000_IMAGE_COMPRESSION_RETIRED:"1.2.840.10008.1.2.4.91R",JPEG_2000_PART_2_MULTICOMPONENT_IMAGE_COMPRESSION_LOSSLESS_ONLY_RETIRED:"1.2.840.10008.1.2.4.92R",JPEG_2000_PART_2_MULTICOMPONENT_IMAGE_COMPRESSION_RETIRED:"1.2.840.10008.1.2.4.93R"},gWe=Object.freeze(Object.defineProperty({__proto__:null,transferSyntaxes:pWe},Symbol.toStringTag,{value:"Module"}));function mWe(t,e){const{rows:n,columns:r,data:i}=t,{rows:a,columns:o,data:s}=e,l=[],c=[],f=[];for(let u=0;u<o;u++){const d=u*(r-1)/(o-1);l[u]=Math.floor(d),c[u]=Math.min(l[u]+1,r-1),f[u]=d-l[u]}for(let u=0;u<a;u++){const d=u*(n-1)/(a-1),h=Math.floor(d)*r,p=Math.min(h+r,(n-1)*r),g=d-Math.floor(d),m=1-g,y=u*o;for(let v=0;v<o;v++){const x=i[h+l[v]],w=i[h+c[v]],S=i[p+l[v]],T=i[p+c[v]],_=1-f[v];s[y+v]=(x*_+w*f[v])*m+(S*_+T*f[v])*g}}return s}function vWe(t,e){const{rows:n,columns:r,pixelData:i,samplesPerPixel:a=1}=t,{rows:o,columns:s,pixelData:l}=e,c=[];for(let f=0;f<s;f++){const u=f*(r-1)/(s-1);c[f]=Math.floor(u)*a}for(let f=0;f<o;f++){const u=f*(n-1)/(o-1),d=Math.floor(u)*r*a,h=f*s;for(let p=0;p<s;p++)for(let g=0;g<a;g++)l[h+p+g]=i[d+c[p]+g]}return l}async function AB(t,e){let n=e.buffer,r=e.byteOffset;const i=e.length;if(t.bitsAllocated===16)r%2&&(n=n.slice(r),r=0),t.pixelRepresentation===0?t.pixelData=new Uint16Array(n,r,i/2):t.pixelData=new Int16Array(n,r,i/2);else if(t.bitsAllocated===8||t.bitsAllocated===1)t.pixelData=e;else if(t.bitsAllocated===32){if(r%2&&(n=n.slice(r),r=0),t.floatPixelData||t.doubleFloatPixelData)throw new Error("Float pixel data is not supported for parsing into ImageFrame");t.pixelRepresentation===0?t.pixelData=new Uint32Array(n,r,i/4):t.pixelRepresentation===1?t.pixelData=new Int32Array(n,r,i/4):t.pixelData=new Float32Array(n,r,i/4)}return t}function yWe(t){return(t&255)<<8|t>>8&255}async function xWe(t,e){if(t.bitsAllocated===16){let n=e.buffer,r=e.byteOffset;const i=e.length;r%2&&(n=n.slice(r),r=0),t.pixelRepresentation===0?t.pixelData=new Uint16Array(n,r,i/2):t.pixelData=new Int16Array(n,r,i/2);for(let a=0;a<t.pixelData.length;a++)t.pixelData[a]=yWe(t.pixelData[a])}else t.bitsAllocated===8&&(t.pixelData=e);return t}async function bWe(t,e){if(t.bitsAllocated===8)return t.planarConfiguration?CWe(t,e):wWe(t,e);if(t.bitsAllocated===16)return SWe(t,e);throw new Error("unsupported pixel format for RLE")}function wWe(t,e){const n=e,r=t.rows*t.columns,i=new ArrayBuffer(r*t.samplesPerPixel),a=new DataView(n.buffer,n.byteOffset),o=new Int8Array(n.buffer,n.byteOffset),s=new Int8Array(i);let l=0;const c=a.getInt32(0,!0);for(let f=0;f<c;++f){l=f;let u=a.getInt32((f+1)*4,!0),d=a.getInt32((f+2)*4,!0);d===0&&(d=n.length);const h=r*c;for(;u<d;){const p=o[u++];if(p>=0&&p<=127)for(let g=0;g<p+1&&l<h;++g)s[l]=o[u++],l+=t.samplesPerPixel;else if(p<=-1&&p>=-127){const g=o[u++];for(let m=0;m<-p+1&&l<h;++m)s[l]=g,l+=t.samplesPerPixel}}}return t.pixelData=new Uint8Array(i),t}function CWe(t,e){const n=e,r=t.rows*t.columns,i=new ArrayBuffer(r*t.samplesPerPixel),a=new DataView(n.buffer,n.byteOffset),o=new Int8Array(n.buffer,n.byteOffset),s=new Int8Array(i);let l=0;const c=a.getInt32(0,!0);for(let f=0;f<c;++f){l=f*r;let u=a.getInt32((f+1)*4,!0),d=a.getInt32((f+2)*4,!0);d===0&&(d=n.length);const h=r*c;for(;u<d;){const p=o[u++];if(p>=0&&p<=127)for(let g=0;g<p+1&&l<h;++g)s[l]=o[u++],l++;else if(p<=-1&&p>=-127){const g=o[u++];for(let m=0;m<-p+1&&l<h;++m)s[l]=g,l++}}}return t.pixelData=new Uint8Array(i),t}function SWe(t,e){const n=e,r=t.rows*t.columns,i=new ArrayBuffer(r*t.samplesPerPixel*2),a=new DataView(n.buffer,n.byteOffset),o=new Int8Array(n.buffer,n.byteOffset),s=new Int8Array(i),l=a.getInt32(0,!0);for(let c=0;c<l;++c){let f=0;const u=c===0?1:0;let d=a.getInt32((c+1)*4,!0),h=a.getInt32((c+2)*4,!0);for(h===0&&(h=n.length);d<h;){const p=o[d++];if(p>=0&&p<=127)for(let g=0;g<p+1&&f<r;++g)s[f*2+u]=o[d++],f++;else if(p<=-1&&p>=-127){const g=o[d++];for(let m=0;m<-p+1&&f<r;++m)s[f*2+u]=g,f++}}}return t.pixelRepresentation===0?t.pixelData=new Uint16Array(i):t.pixelData=new Int16Array(i),t}var q8={exports:{}},NB;function TWe(){return NB||(NB=1,(function(t,e){var n=(()=>{var r=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename<"u"&&(r=r||__filename),(function(i){i=i||{};var a=typeof i<"u"?i:{},o,s;a.ready=new Promise(function(W,K){o=W,s=K});var l=Object.assign({},a),c="./this.program",f=(W,K)=>{throw K},u=typeof window=="object",d=typeof importScripts=="function",h=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",p="";function g(W){return a.locateFile?a.locateFile(W,p):p+W}var m,y,v;if(h){var x=Ff,w=Ff;d?p=w.dirname(p)+"/":p=__dirname+"/",m=(W,K)=>(W=me(W)?new URL(W):w.normalize(W),x.readFileSync(W,K?void 0:"utf8")),v=W=>{var K=m(W,!0);return K.buffer||(K=new Uint8Array(K)),K},y=(W,K,oe)=>{W=me(W)?new URL(W):w.normalize(W),x.readFile(W,function(be,De){be?oe(be):K(De.buffer)})},process.argv.length>1&&(c=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2),process.on("uncaughtException",function(W){if(!(W instanceof ht))throw W}),process.on("unhandledRejection",function(W){throw W}),f=(W,K)=>{throw process.exitCode=W,K},a.inspect=function(){return"[Emscripten Module object]"}}else(u||d)&&(d?p=self.location.href:typeof document<"u"&&document.currentScript&&(p=document.currentScript.src),r&&(p=r),p.indexOf("blob:")!==0?p=p.substr(0,p.replace(/[?#].*/,"").lastIndexOf("/")+1):p="",m=W=>{var K=new XMLHttpRequest;return K.open("GET",W,!1),K.send(null),K.responseText},d&&(v=W=>{var K=new XMLHttpRequest;return K.open("GET",W,!1),K.responseType="arraybuffer",K.send(null),new Uint8Array(K.response)}),y=(W,K,oe)=>{var be=new XMLHttpRequest;be.open("GET",W,!0),be.responseType="arraybuffer",be.onload=()=>{if(be.status==200||be.status==0&&be.response){K(be.response);return}oe()},be.onerror=oe,be.send(null)});var S=a.print||console.log.bind(console),T=a.printErr||console.warn.bind(console);Object.assign(a,l),l=null,a.arguments&&a.arguments,a.thisProgram&&(c=a.thisProgram),a.quit&&(f=a.quit);var _;a.wasmBinary&&(_=a.wasmBinary),a.noExitRuntime,typeof WebAssembly!="object"&&ie("no native wasm support detected");var D,I=!1;function R(W,K){W||ie(K)}var O=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function P(W,K,oe){for(var be=K+oe,De=K;W[De]&&!(De>=be);)++De;if(De-K>16&&W.buffer&&O)return O.decode(W.subarray(K,De));for(var Re="";K<De;){var Le=W[K++];if(!(Le&128)){Re+=String.fromCharCode(Le);continue}var Be=W[K++]&63;if((Le&224)==192){Re+=String.fromCharCode((Le&31)<<6|Be);continue}var qe=W[K++]&63;if((Le&240)==224?Le=(Le&15)<<12|Be<<6|qe:Le=(Le&7)<<18|Be<<12|qe<<6|W[K++]&63,Le<65536)Re+=String.fromCharCode(Le);else{var ft=Le-65536;Re+=String.fromCharCode(55296|ft>>10,56320|ft&1023)}}return Re}function N(W,K){return W?P(G,W,K):""}function A(W,K,oe,be){if(!(be>0))return 0;for(var De=oe,Re=oe+be-1,Le=0;Le<W.length;++Le){var Be=W.charCodeAt(Le);if(Be>=55296&&Be<=57343){var qe=W.charCodeAt(++Le);Be=65536+((Be&1023)<<10)|qe&1023}if(Be<=127){if(oe>=Re)break;K[oe++]=Be}else if(Be<=2047){if(oe+1>=Re)break;K[oe++]=192|Be>>6,K[oe++]=128|Be&63}else if(Be<=65535){if(oe+2>=Re)break;K[oe++]=224|Be>>12,K[oe++]=128|Be>>6&63,K[oe++]=128|Be&63}else{if(oe+3>=Re)break;K[oe++]=240|Be>>18,K[oe++]=128|Be>>12&63,K[oe++]=128|Be>>6&63,K[oe++]=128|Be&63}}return K[oe]=0,oe-De}function B(W,K,oe){return A(W,G,K,oe)}function V(W){for(var K=0,oe=0;oe<W.length;++oe){var be=W.charCodeAt(oe);be<=127?K++:be<=2047?K+=2:be>=55296&&be<=57343?(K+=4,++oe):K+=3}return K}var $,U,G,F,J,Q,ne,ye,ve;function Ce(W){$=W,a.HEAP8=U=new Int8Array(W),a.HEAP16=F=new Int16Array(W),a.HEAP32=Q=new Int32Array(W),a.HEAPU8=G=new Uint8Array(W),a.HEAPU16=J=new Uint16Array(W),a.HEAPU32=ne=new Uint32Array(W),a.HEAPF32=ye=new Float32Array(W),a.HEAPF64=ve=new Float64Array(W)}a.INITIAL_MEMORY;var we,Ae=[],Me=[],q=[];function k(){if(a.preRun)for(typeof a.preRun=="function"&&(a.preRun=[a.preRun]);a.preRun.length;)re(a.preRun.shift());Ot(Ae)}function Y(){Ot(Me)}function X(){if(a.postRun)for(typeof a.postRun=="function"&&(a.postRun=[a.postRun]);a.postRun.length;)he(a.postRun.shift());Ot(q)}function re(W){Ae.unshift(W)}function de(W){Me.unshift(W)}function he(W){q.unshift(W)}var Ee=0,Oe=null;function Pe(W){Ee++,a.monitorRunDependencies&&a.monitorRunDependencies(Ee)}function Ne(W){if(Ee--,a.monitorRunDependencies&&a.monitorRunDependencies(Ee),Ee==0&&Oe){var K=Oe;Oe=null,K()}}function ie(W){a.onAbort&&a.onAbort(W),W="Aborted("+W+")",T(W),I=!0,W+=". Build with -sASSERTIONS for more info.";var K=new WebAssembly.RuntimeError(W);throw s(K),K}var ae="data:application/octet-stream;base64,";function Te(W){return W.startsWith(ae)}function me(W){return W.startsWith("file://")}var Se;Se="libjpegturbowasm_decode.wasm",Te(Se)||(Se=g(Se));function Ve(W){try{if(W==Se&&_)return new Uint8Array(_);if(v)return v(W);throw"both async and sync fetching of the wasm failed"}catch(K){ie(K)}}function ue(){if(!_&&(u||d)){if(typeof fetch=="function"&&!me(Se))return fetch(Se,{credentials:"same-origin"}).then(function(W){if(!W.ok)throw"failed to load wasm binary file at '"+Se+"'";return W.arrayBuffer()}).catch(function(){return Ve(Se)});if(y)return new Promise(function(W,K){y(Se,function(oe){W(new Uint8Array(oe))},K)})}return Promise.resolve().then(function(){return Ve(Se)})}function ut(){var W={a:rt};function K(Le,Be){var qe=Le.exports;a.asm=qe,D=a.asm.K,Ce(D.buffer),we=a.asm.M,de(a.asm.L),Ne()}Pe();function oe(Le){K(Le.instance)}function be(Le){return ue().then(function(Be){return WebAssembly.instantiate(Be,W)}).then(function(Be){return Be}).then(Le,function(Be){T("failed to asynchronously prepare wasm: "+Be),ie(Be)})}function De(){return!_&&typeof WebAssembly.instantiateStreaming=="function"&&!Te(Se)&&!me(Se)&&!h&&typeof fetch=="function"?fetch(Se,{credentials:"same-origin"}).then(function(Le){var Be=WebAssembly.instantiateStreaming(Le,W);return Be.then(oe,function(qe){return T("wasm streaming compile failed: "+qe),T("falling back to ArrayBuffer instantiation"),be(oe)})}):be(oe)}if(a.instantiateWasm)try{var Re=a.instantiateWasm(W,K);return Re}catch(Le){T("Module.instantiateWasm callback failed with error: "+Le),s(Le)}return De().catch(s),{}}function ht(W){this.name="ExitStatus",this.message="Program terminated with exit("+W+")",this.status=W}function Ot(W){for(;W.length>0;)W.shift()(a)}function Fe(W){this.excPtr=W,this.ptr=W-24,this.set_type=function(K){ne[this.ptr+4>>2]=K},this.get_type=function(){return ne[this.ptr+4>>2]},this.set_destructor=function(K){ne[this.ptr+8>>2]=K},this.get_destructor=function(){return ne[this.ptr+8>>2]},this.set_refcount=function(K){Q[this.ptr>>2]=K},this.set_caught=function(K){K=K?1:0,U[this.ptr+12>>0]=K},this.get_caught=function(){return U[this.ptr+12>>0]!=0},this.set_rethrown=function(K){K=K?1:0,U[this.ptr+13>>0]=K},this.get_rethrown=function(){return U[this.ptr+13>>0]!=0},this.init=function(K,oe){this.set_adjusted_ptr(0),this.set_type(K),this.set_destructor(oe),this.set_refcount(0),this.set_caught(!1),this.set_rethrown(!1)},this.add_ref=function(){var K=Q[this.ptr>>2];Q[this.ptr>>2]=K+1},this.release_ref=function(){var K=Q[this.ptr>>2];return Q[this.ptr>>2]=K-1,K===1},this.set_adjusted_ptr=function(K){ne[this.ptr+16>>2]=K},this.get_adjusted_ptr=function(){return ne[this.ptr+16>>2]},this.get_exception_ptr=function(){var K=_e(this.get_type());if(K)return ne[this.excPtr>>2];var oe=this.get_adjusted_ptr();return oe!==0?oe:this.excPtr}}function Qe(W,K,oe){var be=new Fe(W);throw be.init(K,oe),W}var st={};function ot(W){for(;W.length;){var K=W.pop(),oe=W.pop();oe(K)}}function Mt(W){return this.fromWireType(Q[W>>2])}var Ue={},He={},Ct={},$t=48,bn=57;function Tn(W){if(W===void 0)return"_unknown";W=W.replace(/[^a-zA-Z0-9_]/g,"$");var K=W.charCodeAt(0);return K>=$t&&K<=bn?"_"+W:W}function en(W,K){return W=Tn(W),new Function("body","return function "+W+`() {
    "use strict";    return body.apply(this, arguments);
};
`)(K)}function Pn(W,K){var oe=en(K,function(be){this.name=K,this.message=be;var De=new Error(be).stack;De!==void 0&&(this.stack=this.toString()+`
`+De.replace(/^Error(:[^\n]*)?\n/,""))});return oe.prototype=Object.create(W.prototype),oe.prototype.constructor=oe,oe.prototype.toString=function(){return this.message===void 0?this.name:this.name+": "+this.message},oe}var mi=void 0;function hr(W){throw new mi(W)}function Ke(W,K,oe){W.forEach(function(Be){Ct[Be]=K});function be(Be){var qe=oe(Be);qe.length!==W.length&&hr("Mismatched type converter count");for(var ft=0;ft<W.length;++ft)wr(W[ft],qe[ft])}var De=new Array(K.length),Re=[],Le=0;K.forEach((Be,qe)=>{He.hasOwnProperty(Be)?De[qe]=He[Be]:(Re.push(Be),Ue.hasOwnProperty(Be)||(Ue[Be]=[]),Ue[Be].push(()=>{De[qe]=He[Be],++Le,Le===Re.length&&be(De)}))}),Re.length===0&&be(De)}function Et(W){var K=st[W];delete st[W];var oe=K.rawConstructor,be=K.rawDestructor,De=K.fields,Re=De.map(Le=>Le.getterReturnType).concat(De.map(Le=>Le.setterArgumentType));Ke([W],Re,Le=>{var Be={};return De.forEach((qe,ft)=>{var At=qe.fieldName,Wt=Le[ft],Gt=qe.getter,dn=qe.getterContext,pn=Le[ft+De.length],er=qe.setter,Vr=qe.setterContext;Be[At]={read:Hr=>Wt.fromWireType(Gt(dn,Hr)),write:(Hr,tc)=>{var Ko=[];er(Vr,Hr,pn.toWireType(Ko,tc)),ot(Ko)}}}),[{name:K.name,fromWireType:function(qe){var ft={};for(var At in Be)ft[At]=Be[At].read(qe);return be(qe),ft},toWireType:function(qe,ft){for(var At in Be)if(!(At in ft))throw new TypeError('Missing field:  "'+At+'"');var Wt=oe();for(At in Be)Be[At].write(Wt,ft[At]);return qe!==null&&qe.push(be,Wt),Wt},argPackAdvance:8,readValueFromPointer:Mt,destructorFunction:be}]})}function Rt(W,K,oe,be,De){}function Ft(W){switch(W){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+W)}}function Dn(){for(var W=new Array(256),K=0;K<256;++K)W[K]=String.fromCharCode(K);Bt=W}var Bt=void 0;function qt(W){for(var K="",oe=W;G[oe];)K+=Bt[G[oe++]];return K}var kt=void 0;function Zt(W){throw new kt(W)}function wr(W,K,oe={}){if(!("argPackAdvance"in K))throw new TypeError("registerType registeredInstance requires argPackAdvance");var be=K.name;if(W||Zt('type "'+be+'" must have a positive integer typeid pointer'),He.hasOwnProperty(W)){if(oe.ignoreDuplicateRegistrations)return;Zt("Cannot register type '"+be+"' twice")}if(He[W]=K,delete Ct[W],Ue.hasOwnProperty(W)){var De=Ue[W];delete Ue[W],De.forEach(Re=>Re())}}function $r(W,K,oe,be,De){var Re=Ft(oe);K=qt(K),wr(W,{name:K,fromWireType:function(Le){return!!Le},toWireType:function(Le,Be){return Be?be:De},argPackAdvance:8,readValueFromPointer:function(Le){var Be;if(oe===1)Be=U;else if(oe===2)Be=F;else if(oe===4)Be=Q;else throw new TypeError("Unknown boolean type size: "+K);return this.fromWireType(Be[Le>>Re])},destructorFunction:null})}function oi(W){if(!(this instanceof Ga)||!(W instanceof Ga))return!1;for(var K=this.$$.ptrType.registeredClass,oe=this.$$.ptr,be=W.$$.ptrType.registeredClass,De=W.$$.ptr;K.baseClass;)oe=K.upcast(oe),K=K.baseClass;for(;be.baseClass;)De=be.upcast(De),be=be.baseClass;return K===be&&oe===De}function Li(W){return{count:W.count,deleteScheduled:W.deleteScheduled,preservePointerOnDelete:W.preservePointerOnDelete,ptr:W.ptr,ptrType:W.ptrType,smartPtr:W.smartPtr,smartPtrType:W.smartPtrType}}function vi(W){function K(oe){return oe.$$.ptrType.registeredClass.name}Zt(K(W)+" instance already deleted")}var ki=!1;function nn(W){}function Yn(W){W.smartPtr?W.smartPtrType.rawDestructor(W.smartPtr):W.ptrType.registeredClass.rawDestructor(W.ptr)}function Si(W){W.count.value-=1;var K=W.count.value===0;K&&Yn(W)}function rn(W,K,oe){if(K===oe)return W;if(oe.baseClass===void 0)return null;var be=rn(W,K,oe.baseClass);return be===null?null:oe.downcast(be)}var si={};function os(){return Object.keys(Ui).length}function li(){var W=[];for(var K in Ui)Ui.hasOwnProperty(K)&&W.push(Ui[K]);return W}var Vi=[];function _a(){for(;Vi.length;){var W=Vi.pop();W.$$.deleteScheduled=!1,W.delete()}}var Fi=void 0;function As(W){Fi=W,Vi.length&&Fi&&Fi(_a)}function Uo(){a.getInheritedInstanceCount=os,a.getLiveInheritedInstances=li,a.flushPendingDeletes=_a,a.setDelayFunction=As}var Ui={};function Bo(W,K){for(K===void 0&&Zt("ptr should not be undefined");W.baseClass;)K=W.upcast(K),W=W.baseClass;return K}function Pt(W,K){return K=Bo(W,K),Ui[K]}function Bi(W,K){(!K.ptrType||!K.ptr)&&hr("makeClassHandle requires ptr and ptrType");var oe=!!K.smartPtrType,be=!!K.smartPtr;return oe!==be&&hr("Both smartPtrType and smartPtr must be specified"),K.count={value:1},yi(Object.create(W,{$$:{value:K}}))}function no(W){var K=this.getPointee(W);if(!K)return this.destructor(W),null;var oe=Pt(this.registeredClass,K);if(oe!==void 0){if(oe.$$.count.value===0)return oe.$$.ptr=K,oe.$$.smartPtr=W,oe.clone();var be=oe.clone();return this.destructor(W),be}function De(){return this.isSmartPointer?Bi(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:K,smartPtrType:this,smartPtr:W}):Bi(this.registeredClass.instancePrototype,{ptrType:this,ptr:W})}var Re=this.registeredClass.getActualType(K),Le=si[Re];if(!Le)return De.call(this);var Be;this.isConst?Be=Le.constPointerType:Be=Le.pointerType;var qe=rn(K,this.registeredClass,Be.registeredClass);return qe===null?De.call(this):this.isSmartPointer?Bi(Be.registeredClass.instancePrototype,{ptrType:Be,ptr:qe,smartPtrType:this,smartPtr:W}):Bi(Be.registeredClass.instancePrototype,{ptrType:Be,ptr:qe})}function yi(W){return typeof FinalizationRegistry>"u"?(yi=K=>K,W):(ki=new FinalizationRegistry(K=>{Si(K.$$)}),yi=K=>{var oe=K.$$,be=!!oe.smartPtr;if(be){var De={$$:oe};ki.register(K,De,K)}return K},nn=K=>ki.unregister(K),yi(W))}function Ns(){if(this.$$.ptr||vi(this),this.$$.preservePointerOnDelete)return this.$$.count.value+=1,this;var W=yi(Object.create(Object.getPrototypeOf(this),{$$:{value:Li(this.$$)}}));return W.$$.count.value+=1,W.$$.deleteScheduled=!1,W}function $o(){this.$$.ptr||vi(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&Zt("Object already scheduled for deletion"),nn(this),Si(this.$$),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)}function Co(){return!this.$$.ptr}function Hl(){return this.$$.ptr||vi(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&Zt("Object already scheduled for deletion"),Vi.push(this),Vi.length===1&&Fi&&Fi(_a),this.$$.deleteScheduled=!0,this}function vr(){Ga.prototype.isAliasOf=oi,Ga.prototype.clone=Ns,Ga.prototype.delete=$o,Ga.prototype.isDeleted=Co,Ga.prototype.deleteLater=Hl}function Ga(){}function ul(W,K,oe){if(W[K].overloadTable===void 0){var be=W[K];W[K]=function(){return W[K].overloadTable.hasOwnProperty(arguments.length)||Zt("Function '"+oe+"' called with an invalid number of arguments ("+arguments.length+") - expects one of ("+W[K].overloadTable+")!"),W[K].overloadTable[arguments.length].apply(this,arguments)},W[K].overloadTable=[],W[K].overloadTable[be.argCount]=be}}function Go(W,K,oe){a.hasOwnProperty(W)?(Zt("Cannot register public name '"+W+"' twice"),ul(a,W,W),a.hasOwnProperty(oe)&&Zt("Cannot register multiple overloads of a function with the same number of arguments ("+oe+")!"),a[W].overloadTable[oe]=K):a[W]=K}function fl(W,K,oe,be,De,Re,Le,Be){this.name=W,this.constructor=K,this.instancePrototype=oe,this.rawDestructor=be,this.baseClass=De,this.getActualType=Re,this.upcast=Le,this.downcast=Be,this.pureVirtualFunctions=[]}function ja(W,K,oe){for(;K!==oe;)K.upcast||Zt("Expected null or instance of "+oe.name+", got an instance of "+K.name),W=K.upcast(W),K=K.baseClass;return W}function Ru(W,K){if(K===null)return this.isReference&&Zt("null is not a valid "+this.name),0;K.$$||Zt('Cannot pass "'+To(K)+'" as a '+this.name),K.$$.ptr||Zt("Cannot pass deleted object as a pointer of type "+this.name);var oe=K.$$.ptrType.registeredClass,be=ja(K.$$.ptr,oe,this.registeredClass);return be}function pa(W,K){var oe;if(K===null)return this.isReference&&Zt("null is not a valid "+this.name),this.isSmartPointer?(oe=this.rawConstructor(),W!==null&&W.push(this.rawDestructor,oe),oe):0;K.$$||Zt('Cannot pass "'+To(K)+'" as a '+this.name),K.$$.ptr||Zt("Cannot pass deleted object as a pointer of type "+this.name),!this.isConst&&K.$$.ptrType.isConst&&Zt("Cannot convert argument of type "+(K.$$.smartPtrType?K.$$.smartPtrType.name:K.$$.ptrType.name)+" to parameter type "+this.name);var be=K.$$.ptrType.registeredClass;if(oe=ja(K.$$.ptr,be,this.registeredClass),this.isSmartPointer)switch(K.$$.smartPtr===void 0&&Zt("Passing raw pointer to smart pointer is illegal"),this.sharingPolicy){case 0:K.$$.smartPtrType===this?oe=K.$$.smartPtr:Zt("Cannot convert argument of type "+(K.$$.smartPtrType?K.$$.smartPtrType.name:K.$$.ptrType.name)+" to parameter type "+this.name);break;case 1:oe=K.$$.smartPtr;break;case 2:if(K.$$.smartPtrType===this)oe=K.$$.smartPtr;else{var De=K.clone();oe=this.rawShare(oe,io.toHandle(function(){De.delete()})),W!==null&&W.push(this.rawDestructor,oe)}break;default:Zt("Unsupporting sharing policy")}return oe}function Kl(W,K){if(K===null)return this.isReference&&Zt("null is not a valid "+this.name),0;K.$$||Zt('Cannot pass "'+To(K)+'" as a '+this.name),K.$$.ptr||Zt("Cannot pass deleted object as a pointer of type "+this.name),K.$$.ptrType.isConst&&Zt("Cannot convert argument of type "+K.$$.ptrType.name+" to parameter type "+this.name);var oe=K.$$.ptrType.registeredClass,be=ja(K.$$.ptr,oe,this.registeredClass);return be}function Oc(W){return this.rawGetPointee&&(W=this.rawGetPointee(W)),W}function Da(W){this.rawDestructor&&this.rawDestructor(W)}function $i(W){W!==null&&W.delete()}function Oa(){Gi.prototype.getPointee=Oc,Gi.prototype.destructor=Da,Gi.prototype.argPackAdvance=8,Gi.prototype.readValueFromPointer=Mt,Gi.prototype.deleteObject=$i,Gi.prototype.fromWireType=no}function Gi(W,K,oe,be,De,Re,Le,Be,qe,ft,At){this.name=W,this.registeredClass=K,this.isReference=oe,this.isConst=be,this.isSmartPointer=De,this.pointeeType=Re,this.sharingPolicy=Le,this.rawGetPointee=Be,this.rawConstructor=qe,this.rawShare=ft,this.rawDestructor=At,!De&&K.baseClass===void 0?be?(this.toWireType=Ru,this.destructorFunction=null):(this.toWireType=Kl,this.destructorFunction=null):this.toWireType=pa}function jo(W,K,oe){a.hasOwnProperty(W)||hr("Replacing nonexistant public symbol"),a[W].overloadTable!==void 0&&oe!==void 0||(a[W]=K,a[W].argCount=oe)}function ss(W,K,oe){var be=a["dynCall_"+W];return oe&&oe.length?be.apply(null,[K].concat(oe)):be.call(null,K)}var ls=[];function Jr(W){var K=ls[W];return K||(W>=ls.length&&(ls.length=W+1),ls[W]=K=we.get(W)),K}function dl(W,K,oe){if(W.includes("j"))return ss(W,K,oe);var be=Jr(K).apply(null,oe);return be}function Ma(W,K){var oe=[];return function(){return oe.length=0,Object.assign(oe,arguments),dl(W,K,oe)}}function ji(W,K){W=qt(W);function oe(){return W.includes("j")?Ma(W,K):Jr(K)}var be=oe();return typeof be!="function"&&Zt("unknown function pointer with signature "+W+": "+K),be}var cs=void 0;function So(W){var K=Ht(W),oe=qt(K);return Vt(K),oe}function ta(W,K){var oe=[],be={};function De(Re){if(!be[Re]&&!He[Re]){if(Ct[Re]){Ct[Re].forEach(De);return}oe.push(Re),be[Re]=!0}}throw K.forEach(De),new cs(W+": "+oe.map(So).join([", "]))}function za(W,K,oe,be,De,Re,Le,Be,qe,ft,At,Wt,Gt){At=qt(At),Re=ji(De,Re),Be&&(Be=ji(Le,Be)),ft&&(ft=ji(qe,ft)),Gt=ji(Wt,Gt);var dn=Tn(At);Go(dn,function(){ta("Cannot construct "+At+" due to unbound types",[be])}),Ke([W,K,oe],be?[be]:[],function(pn){pn=pn[0];var er,Vr;be?(er=pn.registeredClass,Vr=er.instancePrototype):Vr=Ga.prototype;var Hr=en(dn,function(){if(Object.getPrototypeOf(this)!==tc)throw new kt("Use 'new' to construct "+At);if(Ko.constructor_body===void 0)throw new kt(At+" has no accessible constructor");var s1=Ko.constructor_body[arguments.length];if(s1===void 0)throw new kt("Tried to invoke ctor of "+At+" with invalid number of parameters ("+arguments.length+") - expected ("+Object.keys(Ko.constructor_body).toString()+") parameters instead!");return s1.apply(this,arguments)}),tc=Object.create(Vr,{constructor:{value:Hr}});Hr.prototype=tc;var Ko=new fl(At,Hr,tc,Gt,er,Re,Be,ft),xl=new Gi(At,Ko,!0,!1,!1),Hf=new Gi(At+"*",Ko,!1,!1,!1),o1=new Gi(At+" const*",Ko,!1,!0,!1);return si[W]={pointerType:Hf,constPointerType:o1},jo(dn,Hr),[xl,Hf,o1]})}function zo(W,K){for(var oe=[],be=0;be<W;be++)oe.push(ne[K+be*4>>2]);return oe}function ql(W,K){if(!(W instanceof Function))throw new TypeError("new_ called with constructor type "+typeof W+" which is not a function");var oe=en(W.name||"unknownFunctionName",function(){});oe.prototype=W.prototype;var be=new oe,De=W.apply(be,K);return De instanceof Object?De:be}function us(W,K,oe,be,De){var Re=K.length;Re<2&&Zt("argTypes array size mismatch! Must at least get return value and 'this' types!");for(var Le=K[1]!==null&&oe!==null,Be=!1,qe=1;qe<K.length;++qe)if(K[qe]!==null&&K[qe].destructorFunction===void 0){Be=!0;break}for(var ft=K[0].name!=="void",At="",Wt="",qe=0;qe<Re-2;++qe)At+=(qe!==0?", ":"")+"arg"+qe,Wt+=(qe!==0?", ":"")+"arg"+qe+"Wired";var Gt="return function "+Tn(W)+"("+At+`) {
if (arguments.length !== `+(Re-2)+`) {
throwBindingError('function `+W+" called with ' + arguments.length + ' arguments, expected "+(Re-2)+` args!');
}
`;Be&&(Gt+=`var destructors = [];
`);var dn=Be?"destructors":"null",pn=["throwBindingError","invoker","fn","runDestructors","retType","classParam"],er=[Zt,be,De,ot,K[0],K[1]];Le&&(Gt+="var thisWired = classParam.toWireType("+dn+`, this);
`);for(var qe=0;qe<Re-2;++qe)Gt+="var arg"+qe+"Wired = argType"+qe+".toWireType("+dn+", arg"+qe+"); // "+K[qe+2].name+`
`,pn.push("argType"+qe),er.push(K[qe+2]);if(Le&&(Wt="thisWired"+(Wt.length>0?", ":"")+Wt),Gt+=(ft?"var rv = ":"")+"invoker(fn"+(Wt.length>0?", ":"")+Wt+`);
`,Be)Gt+=`runDestructors(destructors);
`;else for(var qe=Le?1:2;qe<K.length;++qe){var Vr=qe===1?"thisWired":"arg"+(qe-2)+"Wired";K[qe].destructorFunction!==null&&(Gt+=Vr+"_dtor("+Vr+"); // "+K[qe].name+`
`,pn.push(Vr+"_dtor"),er.push(K[qe].destructorFunction))}ft&&(Gt+=`var ret = retType.fromWireType(rv);
return ret;
`),Gt+=`}
`,pn.push(Gt);var Hr=ql(Function,pn).apply(null,er);return Hr}function Dr(W,K,oe,be,De,Re){R(K>0);var Le=zo(K,oe);De=ji(be,De),Ke([],[W],function(Be){Be=Be[0];var qe="constructor "+Be.name;if(Be.registeredClass.constructor_body===void 0&&(Be.registeredClass.constructor_body=[]),Be.registeredClass.constructor_body[K-1]!==void 0)throw new kt("Cannot register multiple constructors with identical number of parameters ("+(K-1)+") for class '"+Be.name+"'! Overload resolution is currently only performed using the parameter count, not actual type info!");return Be.registeredClass.constructor_body[K-1]=()=>{ta("Cannot construct "+Be.name+" due to unbound types",Le)},Ke([],Le,function(ft){return ft.splice(1,0,null),Be.registeredClass.constructor_body[K-1]=us(qe,ft,null,De,Re),[]}),[]})}function ro(W,K,oe,be,De,Re,Le,Be){var qe=zo(oe,be);K=qt(K),Re=ji(De,Re),Ke([],[W],function(ft){ft=ft[0];var At=ft.name+"."+K;K.startsWith("@@")&&(K=Symbol[K.substring(2)]),Be&&ft.registeredClass.pureVirtualFunctions.push(K);function Wt(){ta("Cannot call "+At+" due to unbound types",qe)}var Gt=ft.registeredClass.instancePrototype,dn=Gt[K];return dn===void 0||dn.overloadTable===void 0&&dn.className!==ft.name&&dn.argCount===oe-2?(Wt.argCount=oe-2,Wt.className=ft.name,Gt[K]=Wt):(ul(Gt,K,At),Gt[K].overloadTable[oe-2]=Wt),Ke([],qe,function(pn){var er=us(At,pn,ft,Re,Le);return Gt[K].overloadTable===void 0?(er.argCount=oe-2,Gt[K]=er):Gt[K].overloadTable[oe-2]=er,[]}),[]})}var Or=[],ci=[{},{value:void 0},{value:null},{value:!0},{value:!1}];function fs(W){W>4&&--ci[W].refcount===0&&(ci[W]=void 0,Or.push(W))}function ui(){for(var W=0,K=5;K<ci.length;++K)ci[K]!==void 0&&++W;return W}function Xl(){for(var W=5;W<ci.length;++W)if(ci[W]!==void 0)return ci[W];return null}function Ti(){a.count_emval_handles=ui,a.get_first_emval=Xl}var io={toValue:W=>(W||Zt("Cannot use deleted val. handle = "+W),ci[W].value),toHandle:W=>{switch(W){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:{var K=Or.length?Or.pop():ci.length;return ci[K]={refcount:1,value:W},K}}}};function ds(W,K){K=qt(K),wr(W,{name:K,fromWireType:function(oe){var be=io.toValue(oe);return fs(oe),be},toWireType:function(oe,be){return io.toHandle(be)},argPackAdvance:8,readValueFromPointer:Mt,destructorFunction:null})}function To(W){if(W===null)return"null";var K=typeof W;return K==="object"||K==="array"||K==="function"?W.toString():""+W}function ga(W,K){switch(K){case 2:return function(oe){return this.fromWireType(ye[oe>>2])};case 3:return function(oe){return this.fromWireType(ve[oe>>3])};default:throw new TypeError("Unknown float type: "+W)}}function Ei(W,K,oe){var be=Ft(oe);K=qt(K),wr(W,{name:K,fromWireType:function(De){return De},toWireType:function(De,Re){return Re},argPackAdvance:8,readValueFromPointer:ga(K,be),destructorFunction:null})}function Wo(W,K,oe){switch(K){case 0:return oe?function(De){return U[De]}:function(De){return G[De]};case 1:return oe?function(De){return F[De>>1]}:function(De){return J[De>>1]};case 2:return oe?function(De){return Q[De>>2]}:function(De){return ne[De>>2]};default:throw new TypeError("Unknown integer type: "+W)}}function hl(W,K,oe,be,De){K=qt(K);var Re=Ft(oe),Le=Wt=>Wt;if(be===0){var Be=32-8*oe;Le=Wt=>Wt<<Be>>>Be}var qe=K.includes("unsigned"),ft=(Wt,Gt)=>{},At;qe?At=function(Wt,Gt){return ft(Gt,this.name),Gt>>>0}:At=function(Wt,Gt){return ft(Gt,this.name),Gt},wr(W,{name:K,fromWireType:Le,toWireType:At,argPackAdvance:8,readValueFromPointer:Wo(K,Re,be!==0),destructorFunction:null})}function hs(W,K,oe){var be=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],De=be[K];function Re(Le){Le=Le>>2;var Be=ne,qe=Be[Le],ft=Be[Le+1];return new De($,ft,qe)}oe=qt(oe),wr(W,{name:oe,fromWireType:Re,argPackAdvance:8,readValueFromPointer:Re},{ignoreDuplicateRegistrations:!0})}function Ls(W,K){K=qt(K);var oe=K==="std::string";wr(W,{name:K,fromWireType:function(be){var De=ne[be>>2],Re=be+4,Le;if(oe)for(var Be=Re,qe=0;qe<=De;++qe){var ft=Re+qe;if(qe==De||G[ft]==0){var At=ft-Be,Wt=N(Be,At);Le===void 0?Le=Wt:(Le+="\0",Le+=Wt),Be=ft+1}}else{for(var Gt=new Array(De),qe=0;qe<De;++qe)Gt[qe]=String.fromCharCode(G[Re+qe]);Le=Gt.join("")}return Vt(be),Le},toWireType:function(be,De){De instanceof ArrayBuffer&&(De=new Uint8Array(De));var Re,Le=typeof De=="string";Le||De instanceof Uint8Array||De instanceof Uint8ClampedArray||De instanceof Int8Array||Zt("Cannot pass non-string to std::string"),oe&&Le?Re=V(De):Re=De.length;var Be=xt(4+Re+1),qe=Be+4;if(ne[Be>>2]=Re,oe&&Le)B(De,qe,Re+1);else if(Le)for(var ft=0;ft<Re;++ft){var At=De.charCodeAt(ft);At>255&&(Vt(qe),Zt("String has UTF-16 code units that do not fit in 8 bits")),G[qe+ft]=At}else for(var ft=0;ft<Re;++ft)G[qe+ft]=De[ft];return be!==null&&be.push(Vt,Be),Be},argPackAdvance:8,readValueFromPointer:Mt,destructorFunction:function(be){Vt(be)}})}var pl=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0;function ks(W,K){for(var oe=W,be=oe>>1,De=be+K/2;!(be>=De)&&J[be];)++be;if(oe=be<<1,oe-W>32&&pl)return pl.decode(G.subarray(W,oe));for(var Re="",Le=0;!(Le>=K/2);++Le){var Be=F[W+Le*2>>1];if(Be==0)break;Re+=String.fromCharCode(Be)}return Re}function Vs(W,K,oe){if(oe===void 0&&(oe=2147483647),oe<2)return 0;oe-=2;for(var be=K,De=oe<W.length*2?oe/2:W.length,Re=0;Re<De;++Re){var Le=W.charCodeAt(Re);F[K>>1]=Le,K+=2}return F[K>>1]=0,K-be}function gl(W){return W.length*2}function Mc(W,K){for(var oe=0,be="";!(oe>=K/4);){var De=Q[W+oe*4>>2];if(De==0)break;if(++oe,De>=65536){var Re=De-65536;be+=String.fromCharCode(55296|Re>>10,56320|Re&1023)}else be+=String.fromCharCode(De)}return be}function Pu(W,K,oe){if(oe===void 0&&(oe=2147483647),oe<4)return 0;for(var be=K,De=be+oe-4,Re=0;Re<W.length;++Re){var Le=W.charCodeAt(Re);if(Le>=55296&&Le<=57343){var Be=W.charCodeAt(++Re);Le=65536+((Le&1023)<<10)|Be&1023}if(Q[K>>2]=Le,K+=4,K+4>De)break}return Q[K>>2]=0,K-be}function Au(W){for(var K=0,oe=0;oe<W.length;++oe){var be=W.charCodeAt(oe);be>=55296&&be<=57343&&++oe,K+=4}return K}function Nu(W,K,oe){oe=qt(oe);var be,De,Re,Le,Be;K===2?(be=ks,De=Vs,Le=gl,Re=()=>J,Be=1):K===4&&(be=Mc,De=Pu,Le=Au,Re=()=>ne,Be=2),wr(W,{name:oe,fromWireType:function(qe){for(var ft=ne[qe>>2],At=Re(),Wt,Gt=qe+4,dn=0;dn<=ft;++dn){var pn=qe+4+dn*K;if(dn==ft||At[pn>>Be]==0){var er=pn-Gt,Vr=be(Gt,er);Wt===void 0?Wt=Vr:(Wt+="\0",Wt+=Vr),Gt=pn+K}}return Vt(qe),Wt},toWireType:function(qe,ft){typeof ft!="string"&&Zt("Cannot pass non-string to C++ string type "+oe);var At=Le(ft),Wt=xt(4+At+K);return ne[Wt>>2]=At>>Be,De(ft,Wt+4,At+K),qe!==null&&qe.push(Vt,Wt),Wt},argPackAdvance:8,readValueFromPointer:Mt,destructorFunction:function(qe){Vt(qe)}})}function Yl(W,K,oe,be,De,Re){st[W]={name:qt(K),rawConstructor:ji(oe,be),rawDestructor:ji(De,Re),fields:[]}}function Ic(W,K,oe,be,De,Re,Le,Be,qe,ft){st[W].fields.push({fieldName:qt(K),getterReturnType:oe,getter:ji(be,De),getterContext:Re,setterArgumentType:Le,setter:ji(Be,qe),setterContext:ft})}function Lu(W,K){K=qt(K),wr(W,{isVoid:!0,name:K,argPackAdvance:0,fromWireType:function(){},toWireType:function(oe,be){}})}function Rc(){throw 1/0}var Pc={};function ku(W){var K=Pc[W];return K===void 0?qt(W):K}function ml(){return typeof globalThis=="object"?globalThis:(function(){return Function})()("return this")()}function Ac(W){return W===0?io.toHandle(ml()):(W=ku(W),io.toHandle(ml()[W]))}function Nc(W){W>4&&(ci[W].refcount+=1)}function Jl(W,K){var oe=He[W];return oe===void 0&&Zt(K+" has unknown type "+So(W)),oe}function Vu(W){for(var K="",oe=0;oe<W;++oe)K+=(oe!==0?", ":"")+"arg"+oe;for(var be=()=>ne,De="return function emval_allocator_"+W+`(constructor, argTypes, args) {
  var HEAPU32 = getMemory();
`,oe=0;oe<W;++oe)De+="var argType"+oe+" = requireRegisteredType(HEAPU32[((argTypes)>>2)], 'parameter "+oe+`');
var arg`+oe+" = argType"+oe+`.readValueFromPointer(args);
args += argType`+oe+`['argPackAdvance'];
argTypes += 4;
`;return De+="var obj = new constructor("+K+`);
return valueToHandle(obj);
}
`,new Function("requireRegisteredType","Module","valueToHandle","getMemory",De)(Jl,a,io.toHandle,be)}var vl={};function Fu(W,K,oe,be){W=io.toValue(W);var De=vl[K];return De||(De=Vu(K),vl[K]=De),De(W,oe,be)}function Lc(W,K){W=Jl(W,"_emval_take_value");var oe=W.readValueFromPointer(K);return io.toHandle(oe)}function Uu(){ie("")}function kc(W,K,oe){G.copyWithin(W,K,K+oe)}function Bu(){return 2147483648}function $u(W){try{return D.grow(W-$.byteLength+65535>>>16),Ce(D.buffer),1}catch{}}function Zl(W){var K=G.length;W=W>>>0;var oe=Bu();if(W>oe)return!1;let be=(qe,ft)=>qe+(ft-qe%ft)%ft;for(var De=1;De<=4;De*=2){var Re=K*(1+.2/De);Re=Math.min(Re,W+100663296);var Le=Math.min(oe,be(Math.max(W,Re),65536)),Be=$u(Le);if(Be)return!0}return!1}var Ql={};function Ho(){return c||"./this.program"}function ps(){if(!ps.strings){var W=(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",K={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:W,_:Ho()};for(var oe in Ql)Ql[oe]===void 0?delete K[oe]:K[oe]=Ql[oe];var be=[];for(var oe in K)be.push(oe+"="+K[oe]);ps.strings=be}return ps.strings}function ao(W,K,oe){for(var be=0;be<W.length;++be)U[K++>>0]=W.charCodeAt(be);U[K>>0]=0}function Vc(W,K){var oe=0;return ps().forEach(function(be,De){var Re=K+oe;ne[W+De*4>>2]=Re,ao(be,Re),oe+=be.length+1}),0}function Fc(W,K){var oe=ps();ne[W>>2]=oe.length;var be=0;return oe.forEach(function(De){be+=De.length+1}),ne[K>>2]=be,0}function Fs(W){f(W,new ht(W))}function gs(W,K){Fs(W)}var yl=gs;function ec(W){return 52}function pe(W,K,oe,be,De){return 70}var ge=[null,[],[]];function Ie(W,K){var oe=ge[W];K===0||K===10?((W===1?S:T)(P(oe,0)),oe.length=0):oe.push(K)}function We(W,K,oe,be){for(var De=0,Re=0;Re<oe;Re++){var Le=ne[K>>2],Be=ne[K+4>>2];K+=8;for(var qe=0;qe<Be;qe++)Ie(W,G[Le+qe]);De+=Be}return ne[be>>2]=De,0}function tt(W){var K=a["_"+W];return K}function pt(W,K){U.set(W,K)}function gt(W,K,oe,be,De){var Re={string:pn=>{var er=0;if(pn!=null&&pn!==0){var Vr=(pn.length<<2)+1;er=se(Vr),B(pn,er,Vr)}return er},array:pn=>{var er=se(pn.length);return pt(pn,er),er}};function Le(pn){return K==="string"?N(pn):K==="boolean"?!!pn:pn}var Be=tt(W),qe=[],ft=0;if(be)for(var At=0;At<be.length;At++){var Wt=Re[oe[At]];Wt?(ft===0&&(ft=cn()),qe[At]=Wt(be[At])):qe[At]=be[At]}var Gt=Be.apply(null,qe);function dn(pn){return ft!==0&&le(ft),Le(pn)}return Gt=dn(Gt),Gt}mi=a.InternalError=Pn(Error,"InternalError"),Dn(),kt=a.BindingError=Pn(Error,"BindingError"),vr(),Uo(),Oa(),cs=a.UnboundTypeError=Pn(Error,"UnboundTypeError"),Ti();var rt={g:Qe,A:Et,w:Rt,F:$r,u:za,t:Dr,c:ro,E:ds,m:Ei,b:hl,a:hs,l:Ls,h:Nu,J:Yl,d:Ic,G:Lu,x:Rc,i:fs,r:Ac,p:Nc,q:Fu,s:Lc,j:Uu,D:kc,y:Zl,z:Vc,B:Fc,I:yl,C:ec,v:pe,k:We,o:Ze,n:ct,H:dt,f:Ge,e:St};ut(),a.___wasm_call_ctors=function(){return(a.___wasm_call_ctors=a.asm.L).apply(null,arguments)};var xt=a._malloc=function(){return(xt=a._malloc=a.asm.N).apply(null,arguments)},Vt=a._free=function(){return(Vt=a._free=a.asm.O).apply(null,arguments)},Ht=a.___getTypeName=function(){return(Ht=a.___getTypeName=a.asm.P).apply(null,arguments)};a.__embind_initialize_bindings=function(){return(a.__embind_initialize_bindings=a.asm.Q).apply(null,arguments)};var Qt=a._setThrew=function(){return(Qt=a._setThrew=a.asm.R).apply(null,arguments)},cn=a.stackSave=function(){return(cn=a.stackSave=a.asm.S).apply(null,arguments)},le=a.stackRestore=function(){return(le=a.stackRestore=a.asm.T).apply(null,arguments)},se=a.stackAlloc=function(){return(se=a.stackAlloc=a.asm.U).apply(null,arguments)},_e=a.___cxa_is_pointer_type=function(){return(_e=a.___cxa_is_pointer_type=a.asm.V).apply(null,arguments)};a.dynCall_jiji=function(){return(a.dynCall_jiji=a.asm.W).apply(null,arguments)};function Ge(W,K){var oe=cn();try{Jr(W)(K)}catch(be){if(le(oe),be!==be+0)throw be;Qt(1,0)}}function Ze(W,K){var oe=cn();try{return Jr(W)(K)}catch(be){if(le(oe),be!==be+0)throw be;Qt(1,0)}}function St(W,K,oe,be){var De=cn();try{Jr(W)(K,oe,be)}catch(Re){if(le(De),Re!==Re+0)throw Re;Qt(1,0)}}function dt(W,K,oe,be){var De=cn();try{return Jr(W)(K,oe,be)}catch(Re){if(le(De),Re!==Re+0)throw Re;Qt(1,0)}}function ct(W,K,oe){var be=cn();try{return Jr(W)(K,oe)}catch(De){if(le(be),De!==De+0)throw De;Qt(1,0)}}a.ccall=gt;var Z;Oe=function W(){Z||te(),Z||(Oe=W)};function te(W){if(Ee>0||(k(),Ee>0))return;function K(){Z||(Z=!0,a.calledRun=!0,!I&&(Y(),o(a),a.onRuntimeInitialized&&a.onRuntimeInitialized(),X()))}a.setStatus?(a.setStatus("Running..."),setTimeout(function(){setTimeout(function(){a.setStatus("")},1),K()},1)):K()}if(a.preInit)for(typeof a.preInit=="function"&&(a.preInit=[a.preInit]);a.preInit.length>0;)a.preInit.pop()();return te(),i.ready})})();t.exports=n})(q8)),q8.exports}var EWe=TWe();const _We=sl(EWe),DWe=new URL("/assets/libjpegturbowasm_decode-daqMmuVl.wasm",import.meta.url),bw={codec:void 0,decoder:void 0};function OWe(){if(bw.codec)return Promise.resolve();const t=_We({locateFile:e=>e.endsWith(".wasm")?DWe.toString():e});return new Promise((e,n)=>{t.then(r=>{bw.codec=r,bw.decoder=new r.JPEGDecoder,e()},n)})}async function MWe(t,e){await OWe();const n=bw.decoder;n.getEncodedBuffer(t.length).set(t),n.decode();const i=n.getFrameInfo(),a=n.getDecodedBuffer(),o={columns:i.width,rows:i.height,bitsPerPixel:i.bitsPerSample,signed:e.signed,bytesPerPixel:e.bytesPerPixel,componentsPerPixel:i.componentCount},s=IWe(i,a),l={frameInfo:i};return{...e,pixelData:s,imageInfo:o,encodeOptions:l,...l,...o}}function IWe(t,e){return t.isSigned?new Int8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}const p2={JpegImage:void 0,decodeConfig:{}};function RWe(t){return p2.decodeConfig=t,p2.JpegImage?Promise.resolve():new Promise((e,n)=>{Em(()=>import("./jpeg-B-x1txLf.js"),[]).then(r=>{p2.JpegImage=r.default,e()}).catch(n)})}async function PWe(t,e){if(await RWe(),typeof p2.JpegImage>"u")throw new Error("No JPEG Baseline decoder loaded");const n=new p2.JpegImage;if(n.parse(e),n.colorTransform=!1,t.bitsAllocated===8)return t.pixelData=n.getData(t.columns,t.rows),t;if(t.bitsAllocated===16)return t.pixelData=n.getData16(t.columns,t.rows),t}const g2={DecoderClass:void 0,decodeConfig:{}};function AWe(t){return g2.decodeConfig=t,g2.DecoderClass?Promise.resolve():new Promise((e,n)=>{Em(async()=>{const{Decoder:r}=await import("./lossless-CyYqoyFe.js");return{Decoder:r}},[]).then(({Decoder:r})=>{g2.DecoderClass=r,e()},n)})}async function LB(t,e){if(await AWe(),typeof g2.DecoderClass>"u")throw new Error("No JPEG Lossless decoder loaded");const n=new g2.DecoderClass,r=t.bitsAllocated<=8?1:2,i=e.buffer,a=n.decode(i,e.byteOffset,e.length,r);return t.pixelRepresentation===0?t.bitsAllocated===16?(t.pixelData=new Uint16Array(a.buffer),t):(t.pixelData=new Uint8Array(a.buffer),t):(t.pixelData=new Int16Array(a.buffer),t)}var X8={exports:{}},kB;function NWe(){return kB||(kB=1,(function(t,e){var n=(()=>{var r=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename<"u"&&(r=r||__filename),(function(i){i=i||{};var a=typeof i<"u"?i:{},o,s;a.ready=new Promise(function(pe,ge){o=pe,s=ge});var l=Object.assign({},a),c=typeof window=="object",f=typeof importScripts=="function",u=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",d="";function h(pe){return a.locateFile?a.locateFile(pe,d):d+pe}var p,g,m;if(u){var y=Ff,v=Ff;f?d=v.dirname(d)+"/":d=__dirname+"/",p=(pe,ge)=>(pe=ie(pe)?new URL(pe):v.normalize(pe),y.readFileSync(pe,ge?void 0:"utf8")),m=pe=>{var ge=p(pe,!0);return ge.buffer||(ge=new Uint8Array(ge)),ge},g=(pe,ge,Ie)=>{pe=ie(pe)?new URL(pe):v.normalize(pe),y.readFile(pe,function(We,tt){We?Ie(We):ge(tt.buffer)})},process.argv.length>1&&process.argv[1].replace(/\\/g,"/"),process.argv.slice(2),process.on("uncaughtException",function(pe){if(!(pe instanceof Ve))throw pe}),process.on("unhandledRejection",function(pe){throw pe}),a.inspect=function(){return"[Emscripten Module object]"}}else(c||f)&&(f?d=self.location.href:typeof document<"u"&&document.currentScript&&(d=document.currentScript.src),r&&(d=r),d.indexOf("blob:")!==0?d=d.substr(0,d.replace(/[?#].*/,"").lastIndexOf("/")+1):d="",p=pe=>{var ge=new XMLHttpRequest;return ge.open("GET",pe,!1),ge.send(null),ge.responseText},f&&(m=pe=>{var ge=new XMLHttpRequest;return ge.open("GET",pe,!1),ge.responseType="arraybuffer",ge.send(null),new Uint8Array(ge.response)}),g=(pe,ge,Ie)=>{var We=new XMLHttpRequest;We.open("GET",pe,!0),We.responseType="arraybuffer",We.onload=()=>{if(We.status==200||We.status==0&&We.response){ge(We.response);return}Ie()},We.onerror=Ie,We.send(null)});a.print||console.log.bind(console);var x=a.printErr||console.warn.bind(console);Object.assign(a,l),l=null,a.arguments&&a.arguments,a.thisProgram&&a.thisProgram,a.quit&&a.quit;var w;a.wasmBinary&&(w=a.wasmBinary),a.noExitRuntime,typeof WebAssembly!="object"&&Oe("no native wasm support detected");var S,T=!1;function _(pe,ge){pe||Oe(ge)}var D=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function I(pe,ge,Ie){for(var We=ge+Ie,tt=ge;pe[tt]&&!(tt>=We);)++tt;if(tt-ge>16&&pe.buffer&&D)return D.decode(pe.subarray(ge,tt));for(var pt="";ge<tt;){var gt=pe[ge++];if(!(gt&128)){pt+=String.fromCharCode(gt);continue}var rt=pe[ge++]&63;if((gt&224)==192){pt+=String.fromCharCode((gt&31)<<6|rt);continue}var xt=pe[ge++]&63;if((gt&240)==224?gt=(gt&15)<<12|rt<<6|xt:gt=(gt&7)<<18|rt<<12|xt<<6|pe[ge++]&63,gt<65536)pt+=String.fromCharCode(gt);else{var Vt=gt-65536;pt+=String.fromCharCode(55296|Vt>>10,56320|Vt&1023)}}return pt}function R(pe,ge){return pe?I(V,pe,ge):""}function O(pe,ge,Ie,We){if(!(We>0))return 0;for(var tt=Ie,pt=Ie+We-1,gt=0;gt<pe.length;++gt){var rt=pe.charCodeAt(gt);if(rt>=55296&&rt<=57343){var xt=pe.charCodeAt(++gt);rt=65536+((rt&1023)<<10)|xt&1023}if(rt<=127){if(Ie>=pt)break;ge[Ie++]=rt}else if(rt<=2047){if(Ie+1>=pt)break;ge[Ie++]=192|rt>>6,ge[Ie++]=128|rt&63}else if(rt<=65535){if(Ie+2>=pt)break;ge[Ie++]=224|rt>>12,ge[Ie++]=128|rt>>6&63,ge[Ie++]=128|rt&63}else{if(Ie+3>=pt)break;ge[Ie++]=240|rt>>18,ge[Ie++]=128|rt>>12&63,ge[Ie++]=128|rt>>6&63,ge[Ie++]=128|rt&63}}return ge[Ie]=0,Ie-tt}function P(pe,ge,Ie){return O(pe,V,ge,Ie)}function N(pe){for(var ge=0,Ie=0;Ie<pe.length;++Ie){var We=pe.charCodeAt(Ie);We<=127?ge++:We<=2047?ge+=2:We>=55296&&We<=57343?(ge+=4,++Ie):ge+=3}return ge}var A,B,V,$,U,G,F,J,Q;function ne(pe){A=pe,a.HEAP8=B=new Int8Array(pe),a.HEAP16=$=new Int16Array(pe),a.HEAP32=G=new Int32Array(pe),a.HEAPU8=V=new Uint8Array(pe),a.HEAPU16=U=new Uint16Array(pe),a.HEAPU32=F=new Uint32Array(pe),a.HEAPF32=J=new Float32Array(pe),a.HEAPF64=Q=new Float64Array(pe)}a.INITIAL_MEMORY;var ye,ve=[],Ce=[],we=[];function Ae(){if(a.preRun)for(typeof a.preRun=="function"&&(a.preRun=[a.preRun]);a.preRun.length;)k(a.preRun.shift());ue(ve)}function Me(){ue(Ce)}function q(){if(a.postRun)for(typeof a.postRun=="function"&&(a.postRun=[a.postRun]);a.postRun.length;)X(a.postRun.shift());ue(we)}function k(pe){ve.unshift(pe)}function Y(pe){Ce.unshift(pe)}function X(pe){we.unshift(pe)}var re=0,de=null;function he(pe){re++,a.monitorRunDependencies&&a.monitorRunDependencies(re)}function Ee(pe){if(re--,a.monitorRunDependencies&&a.monitorRunDependencies(re),re==0&&de){var ge=de;de=null,ge()}}function Oe(pe){a.onAbort&&a.onAbort(pe),pe="Aborted("+pe+")",x(pe),T=!0,pe+=". Build with -sASSERTIONS for more info.";var ge=new WebAssembly.RuntimeError(pe);throw s(ge),ge}var Pe="data:application/octet-stream;base64,";function Ne(pe){return pe.startsWith(Pe)}function ie(pe){return pe.startsWith("file://")}var ae;ae="charlswasm_decode.wasm",Ne(ae)||(ae=h(ae));function Te(pe){try{if(pe==ae&&w)return new Uint8Array(w);if(m)return m(pe);throw"both async and sync fetching of the wasm failed"}catch(ge){Oe(ge)}}function me(){if(!w&&(c||f)){if(typeof fetch=="function"&&!ie(ae))return fetch(ae,{credentials:"same-origin"}).then(function(pe){if(!pe.ok)throw"failed to load wasm binary file at '"+ae+"'";return pe.arrayBuffer()}).catch(function(){return Te(ae)});if(g)return new Promise(function(pe,ge){g(ae,function(Ie){pe(new Uint8Array(Ie))},ge)})}return Promise.resolve().then(function(){return Te(ae)})}function Se(){var pe={a:Ql};function ge(gt,rt){var xt=gt.exports;a.asm=xt,S=a.asm.z,ne(S.buffer),ye=a.asm.C,Y(a.asm.A),Ee()}he();function Ie(gt){ge(gt.instance)}function We(gt){return me().then(function(rt){return WebAssembly.instantiate(rt,pe)}).then(function(rt){return rt}).then(gt,function(rt){x("failed to asynchronously prepare wasm: "+rt),Oe(rt)})}function tt(){return!w&&typeof WebAssembly.instantiateStreaming=="function"&&!Ne(ae)&&!ie(ae)&&!u&&typeof fetch=="function"?fetch(ae,{credentials:"same-origin"}).then(function(gt){var rt=WebAssembly.instantiateStreaming(gt,pe);return rt.then(Ie,function(xt){return x("wasm streaming compile failed: "+xt),x("falling back to ArrayBuffer instantiation"),We(Ie)})}):We(Ie)}if(a.instantiateWasm)try{var pt=a.instantiateWasm(pe,ge);return pt}catch(gt){x("Module.instantiateWasm callback failed with error: "+gt),s(gt)}return tt().catch(s),{}}function Ve(pe){this.name="ExitStatus",this.message="Program terminated with exit("+pe+")",this.status=pe}function ue(pe){for(;pe.length>0;)pe.shift()(a)}function ut(pe){this.excPtr=pe,this.ptr=pe-24,this.set_type=function(ge){F[this.ptr+4>>2]=ge},this.get_type=function(){return F[this.ptr+4>>2]},this.set_destructor=function(ge){F[this.ptr+8>>2]=ge},this.get_destructor=function(){return F[this.ptr+8>>2]},this.set_refcount=function(ge){G[this.ptr>>2]=ge},this.set_caught=function(ge){ge=ge?1:0,B[this.ptr+12>>0]=ge},this.get_caught=function(){return B[this.ptr+12>>0]!=0},this.set_rethrown=function(ge){ge=ge?1:0,B[this.ptr+13>>0]=ge},this.get_rethrown=function(){return B[this.ptr+13>>0]!=0},this.init=function(ge,Ie){this.set_adjusted_ptr(0),this.set_type(ge),this.set_destructor(Ie),this.set_refcount(0),this.set_caught(!1),this.set_rethrown(!1)},this.add_ref=function(){var ge=G[this.ptr>>2];G[this.ptr>>2]=ge+1},this.release_ref=function(){var ge=G[this.ptr>>2];return G[this.ptr>>2]=ge-1,ge===1},this.set_adjusted_ptr=function(ge){F[this.ptr+16>>2]=ge},this.get_adjusted_ptr=function(){return F[this.ptr+16>>2]},this.get_exception_ptr=function(){var ge=gs(this.get_type());if(ge)return F[this.excPtr>>2];var Ie=this.get_adjusted_ptr();return Ie!==0?Ie:this.excPtr}}function ht(pe,ge,Ie){var We=new ut(pe);throw We.init(ge,Ie),pe}var Ot={};function Fe(pe){for(;pe.length;){var ge=pe.pop(),Ie=pe.pop();Ie(ge)}}function Qe(pe){return this.fromWireType(G[pe>>2])}var st={},ot={},Mt={},Ue=48,He=57;function Ct(pe){if(pe===void 0)return"_unknown";pe=pe.replace(/[^a-zA-Z0-9_]/g,"$");var ge=pe.charCodeAt(0);return ge>=Ue&&ge<=He?"_"+pe:pe}function $t(pe,ge){return pe=Ct(pe),new Function("body","return function "+pe+`() {
    "use strict";    return body.apply(this, arguments);
};
`)(ge)}function bn(pe,ge){var Ie=$t(ge,function(We){this.name=ge,this.message=We;var tt=new Error(We).stack;tt!==void 0&&(this.stack=this.toString()+`
`+tt.replace(/^Error(:[^\n]*)?\n/,""))});return Ie.prototype=Object.create(pe.prototype),Ie.prototype.constructor=Ie,Ie.prototype.toString=function(){return this.message===void 0?this.name:this.name+": "+this.message},Ie}var Tn=void 0;function en(pe){throw new Tn(pe)}function Pn(pe,ge,Ie){pe.forEach(function(rt){Mt[rt]=ge});function We(rt){var xt=Ie(rt);xt.length!==pe.length&&en("Mismatched type converter count");for(var Vt=0;Vt<pe.length;++Vt)qt(pe[Vt],xt[Vt])}var tt=new Array(ge.length),pt=[],gt=0;ge.forEach((rt,xt)=>{ot.hasOwnProperty(rt)?tt[xt]=ot[rt]:(pt.push(rt),st.hasOwnProperty(rt)||(st[rt]=[]),st[rt].push(()=>{tt[xt]=ot[rt],++gt,gt===pt.length&&We(tt)}))}),pt.length===0&&We(tt)}function mi(pe){var ge=Ot[pe];delete Ot[pe];var Ie=ge.rawConstructor,We=ge.rawDestructor,tt=ge.fields,pt=tt.map(gt=>gt.getterReturnType).concat(tt.map(gt=>gt.setterArgumentType));Pn([pe],pt,gt=>{var rt={};return tt.forEach((xt,Vt)=>{var Ht=xt.fieldName,Qt=gt[Vt],cn=xt.getter,le=xt.getterContext,se=gt[Vt+tt.length],_e=xt.setter,Ge=xt.setterContext;rt[Ht]={read:Ze=>Qt.fromWireType(cn(le,Ze)),write:(Ze,St)=>{var dt=[];_e(Ge,Ze,se.toWireType(dt,St)),Fe(dt)}}}),[{name:ge.name,fromWireType:function(xt){var Vt={};for(var Ht in rt)Vt[Ht]=rt[Ht].read(xt);return We(xt),Vt},toWireType:function(xt,Vt){for(var Ht in rt)if(!(Ht in Vt))throw new TypeError('Missing field:  "'+Ht+'"');var Qt=Ie();for(Ht in rt)rt[Ht].write(Qt,Vt[Ht]);return xt!==null&&xt.push(We,Qt),Qt},argPackAdvance:8,readValueFromPointer:Qe,destructorFunction:We}]})}function hr(pe,ge,Ie,We,tt){}function Ke(pe){switch(pe){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+pe)}}function Et(){for(var pe=new Array(256),ge=0;ge<256;++ge)pe[ge]=String.fromCharCode(ge);Rt=pe}var Rt=void 0;function Ft(pe){for(var ge="",Ie=pe;V[Ie];)ge+=Rt[V[Ie++]];return ge}var Dn=void 0;function Bt(pe){throw new Dn(pe)}function qt(pe,ge,Ie={}){if(!("argPackAdvance"in ge))throw new TypeError("registerType registeredInstance requires argPackAdvance");var We=ge.name;if(pe||Bt('type "'+We+'" must have a positive integer typeid pointer'),ot.hasOwnProperty(pe)){if(Ie.ignoreDuplicateRegistrations)return;Bt("Cannot register type '"+We+"' twice")}if(ot[pe]=ge,delete Mt[pe],st.hasOwnProperty(pe)){var tt=st[pe];delete st[pe],tt.forEach(pt=>pt())}}function kt(pe,ge,Ie,We,tt){var pt=Ke(Ie);ge=Ft(ge),qt(pe,{name:ge,fromWireType:function(gt){return!!gt},toWireType:function(gt,rt){return rt?We:tt},argPackAdvance:8,readValueFromPointer:function(gt){var rt;if(Ie===1)rt=B;else if(Ie===2)rt=$;else if(Ie===4)rt=G;else throw new TypeError("Unknown boolean type size: "+ge);return this.fromWireType(rt[gt>>pt])},destructorFunction:null})}function Zt(pe){if(!(this instanceof Co)||!(pe instanceof Co))return!1;for(var ge=this.$$.ptrType.registeredClass,Ie=this.$$.ptr,We=pe.$$.ptrType.registeredClass,tt=pe.$$.ptr;ge.baseClass;)Ie=ge.upcast(Ie),ge=ge.baseClass;for(;We.baseClass;)tt=We.upcast(tt),We=We.baseClass;return ge===We&&Ie===tt}function wr(pe){return{count:pe.count,deleteScheduled:pe.deleteScheduled,preservePointerOnDelete:pe.preservePointerOnDelete,ptr:pe.ptr,ptrType:pe.ptrType,smartPtr:pe.smartPtr,smartPtrType:pe.smartPtrType}}function $r(pe){function ge(Ie){return Ie.$$.ptrType.registeredClass.name}Bt(ge(pe)+" instance already deleted")}var oi=!1;function Li(pe){}function vi(pe){pe.smartPtr?pe.smartPtrType.rawDestructor(pe.smartPtr):pe.ptrType.registeredClass.rawDestructor(pe.ptr)}function ki(pe){pe.count.value-=1;var ge=pe.count.value===0;ge&&vi(pe)}function nn(pe,ge,Ie){if(ge===Ie)return pe;if(Ie.baseClass===void 0)return null;var We=nn(pe,ge,Ie.baseClass);return We===null?null:Ie.downcast(We)}var Yn={};function Si(){return Object.keys(Fi).length}function rn(){var pe=[];for(var ge in Fi)Fi.hasOwnProperty(ge)&&pe.push(Fi[ge]);return pe}var si=[];function os(){for(;si.length;){var pe=si.pop();pe.$$.deleteScheduled=!1,pe.delete()}}var li=void 0;function Vi(pe){li=pe,si.length&&li&&li(os)}function _a(){a.getInheritedInstanceCount=Si,a.getLiveInheritedInstances=rn,a.flushPendingDeletes=os,a.setDelayFunction=Vi}var Fi={};function As(pe,ge){for(ge===void 0&&Bt("ptr should not be undefined");pe.baseClass;)ge=pe.upcast(ge),pe=pe.baseClass;return ge}function Uo(pe,ge){return ge=As(pe,ge),Fi[ge]}function Ui(pe,ge){(!ge.ptrType||!ge.ptr)&&en("makeClassHandle requires ptr and ptrType");var Ie=!!ge.smartPtrType,We=!!ge.smartPtr;return Ie!==We&&en("Both smartPtrType and smartPtr must be specified"),ge.count={value:1},Pt(Object.create(pe,{$$:{value:ge}}))}function Bo(pe){var ge=this.getPointee(pe);if(!ge)return this.destructor(pe),null;var Ie=Uo(this.registeredClass,ge);if(Ie!==void 0){if(Ie.$$.count.value===0)return Ie.$$.ptr=ge,Ie.$$.smartPtr=pe,Ie.clone();var We=Ie.clone();return this.destructor(pe),We}function tt(){return this.isSmartPointer?Ui(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:ge,smartPtrType:this,smartPtr:pe}):Ui(this.registeredClass.instancePrototype,{ptrType:this,ptr:pe})}var pt=this.registeredClass.getActualType(ge),gt=Yn[pt];if(!gt)return tt.call(this);var rt;this.isConst?rt=gt.constPointerType:rt=gt.pointerType;var xt=nn(ge,this.registeredClass,rt.registeredClass);return xt===null?tt.call(this):this.isSmartPointer?Ui(rt.registeredClass.instancePrototype,{ptrType:rt,ptr:xt,smartPtrType:this,smartPtr:pe}):Ui(rt.registeredClass.instancePrototype,{ptrType:rt,ptr:xt})}function Pt(pe){return typeof FinalizationRegistry>"u"?(Pt=ge=>ge,pe):(oi=new FinalizationRegistry(ge=>{ki(ge.$$)}),Pt=ge=>{var Ie=ge.$$,We=!!Ie.smartPtr;if(We){var tt={$$:Ie};oi.register(ge,tt,ge)}return ge},Li=ge=>oi.unregister(ge),Pt(pe))}function Bi(){if(this.$$.ptr||$r(this),this.$$.preservePointerOnDelete)return this.$$.count.value+=1,this;var pe=Pt(Object.create(Object.getPrototypeOf(this),{$$:{value:wr(this.$$)}}));return pe.$$.count.value+=1,pe.$$.deleteScheduled=!1,pe}function no(){this.$$.ptr||$r(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&Bt("Object already scheduled for deletion"),Li(this),ki(this.$$),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)}function yi(){return!this.$$.ptr}function Ns(){return this.$$.ptr||$r(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&Bt("Object already scheduled for deletion"),si.push(this),si.length===1&&li&&li(os),this.$$.deleteScheduled=!0,this}function $o(){Co.prototype.isAliasOf=Zt,Co.prototype.clone=Bi,Co.prototype.delete=no,Co.prototype.isDeleted=yi,Co.prototype.deleteLater=Ns}function Co(){}function Hl(pe,ge,Ie){if(pe[ge].overloadTable===void 0){var We=pe[ge];pe[ge]=function(){return pe[ge].overloadTable.hasOwnProperty(arguments.length)||Bt("Function '"+Ie+"' called with an invalid number of arguments ("+arguments.length+") - expects one of ("+pe[ge].overloadTable+")!"),pe[ge].overloadTable[arguments.length].apply(this,arguments)},pe[ge].overloadTable=[],pe[ge].overloadTable[We.argCount]=We}}function vr(pe,ge,Ie){a.hasOwnProperty(pe)?((Ie===void 0||a[pe].overloadTable!==void 0&&a[pe].overloadTable[Ie]!==void 0)&&Bt("Cannot register public name '"+pe+"' twice"),Hl(a,pe,pe),a.hasOwnProperty(Ie)&&Bt("Cannot register multiple overloads of a function with the same number of arguments ("+Ie+")!"),a[pe].overloadTable[Ie]=ge):(a[pe]=ge,Ie!==void 0&&(a[pe].numArguments=Ie))}function Ga(pe,ge,Ie,We,tt,pt,gt,rt){this.name=pe,this.constructor=ge,this.instancePrototype=Ie,this.rawDestructor=We,this.baseClass=tt,this.getActualType=pt,this.upcast=gt,this.downcast=rt,this.pureVirtualFunctions=[]}function ul(pe,ge,Ie){for(;ge!==Ie;)ge.upcast||Bt("Expected null or instance of "+Ie.name+", got an instance of "+ge.name),pe=ge.upcast(pe),ge=ge.baseClass;return pe}function Go(pe,ge){if(ge===null)return this.isReference&&Bt("null is not a valid "+this.name),0;ge.$$||Bt('Cannot pass "'+Ti(ge)+'" as a '+this.name),ge.$$.ptr||Bt("Cannot pass deleted object as a pointer of type "+this.name);var Ie=ge.$$.ptrType.registeredClass,We=ul(ge.$$.ptr,Ie,this.registeredClass);return We}function fl(pe,ge){var Ie;if(ge===null)return this.isReference&&Bt("null is not a valid "+this.name),this.isSmartPointer?(Ie=this.rawConstructor(),pe!==null&&pe.push(this.rawDestructor,Ie),Ie):0;ge.$$||Bt('Cannot pass "'+Ti(ge)+'" as a '+this.name),ge.$$.ptr||Bt("Cannot pass deleted object as a pointer of type "+this.name),!this.isConst&&ge.$$.ptrType.isConst&&Bt("Cannot convert argument of type "+(ge.$$.smartPtrType?ge.$$.smartPtrType.name:ge.$$.ptrType.name)+" to parameter type "+this.name);var We=ge.$$.ptrType.registeredClass;if(Ie=ul(ge.$$.ptr,We,this.registeredClass),this.isSmartPointer)switch(ge.$$.smartPtr===void 0&&Bt("Passing raw pointer to smart pointer is illegal"),this.sharingPolicy){case 0:ge.$$.smartPtrType===this?Ie=ge.$$.smartPtr:Bt("Cannot convert argument of type "+(ge.$$.smartPtrType?ge.$$.smartPtrType.name:ge.$$.ptrType.name)+" to parameter type "+this.name);break;case 1:Ie=ge.$$.smartPtr;break;case 2:if(ge.$$.smartPtrType===this)Ie=ge.$$.smartPtr;else{var tt=ge.clone();Ie=this.rawShare(Ie,ui.toHandle(function(){tt.delete()})),pe!==null&&pe.push(this.rawDestructor,Ie)}break;default:Bt("Unsupporting sharing policy")}return Ie}function ja(pe,ge){if(ge===null)return this.isReference&&Bt("null is not a valid "+this.name),0;ge.$$||Bt('Cannot pass "'+Ti(ge)+'" as a '+this.name),ge.$$.ptr||Bt("Cannot pass deleted object as a pointer of type "+this.name),ge.$$.ptrType.isConst&&Bt("Cannot convert argument of type "+ge.$$.ptrType.name+" to parameter type "+this.name);var Ie=ge.$$.ptrType.registeredClass,We=ul(ge.$$.ptr,Ie,this.registeredClass);return We}function Ru(pe){return this.rawGetPointee&&(pe=this.rawGetPointee(pe)),pe}function pa(pe){this.rawDestructor&&this.rawDestructor(pe)}function Kl(pe){pe!==null&&pe.delete()}function Oc(){Da.prototype.getPointee=Ru,Da.prototype.destructor=pa,Da.prototype.argPackAdvance=8,Da.prototype.readValueFromPointer=Qe,Da.prototype.deleteObject=Kl,Da.prototype.fromWireType=Bo}function Da(pe,ge,Ie,We,tt,pt,gt,rt,xt,Vt,Ht){this.name=pe,this.registeredClass=ge,this.isReference=Ie,this.isConst=We,this.isSmartPointer=tt,this.pointeeType=pt,this.sharingPolicy=gt,this.rawGetPointee=rt,this.rawConstructor=xt,this.rawShare=Vt,this.rawDestructor=Ht,!tt&&ge.baseClass===void 0?We?(this.toWireType=Go,this.destructorFunction=null):(this.toWireType=ja,this.destructorFunction=null):this.toWireType=fl}function $i(pe,ge,Ie){a.hasOwnProperty(pe)||en("Replacing nonexistant public symbol"),a[pe].overloadTable!==void 0&&Ie!==void 0?a[pe].overloadTable[Ie]=ge:(a[pe]=ge,a[pe].argCount=Ie)}function Oa(pe,ge,Ie){var We=a["dynCall_"+pe];return Ie&&Ie.length?We.apply(null,[ge].concat(Ie)):We.call(null,ge)}var Gi=[];function jo(pe){var ge=Gi[pe];return ge||(pe>=Gi.length&&(Gi.length=pe+1),Gi[pe]=ge=ye.get(pe)),ge}function ss(pe,ge,Ie){if(pe.includes("j"))return Oa(pe,ge,Ie);var We=jo(ge).apply(null,Ie);return We}function ls(pe,ge){var Ie=[];return function(){return Ie.length=0,Object.assign(Ie,arguments),ss(pe,ge,Ie)}}function Jr(pe,ge){pe=Ft(pe);function Ie(){return pe.includes("j")?ls(pe,ge):jo(ge)}var We=Ie();return typeof We!="function"&&Bt("unknown function pointer with signature "+pe+": "+ge),We}var dl=void 0;function Ma(pe){var ge=ps(pe),Ie=Ft(ge);return ao(ge),Ie}function ji(pe,ge){var Ie=[],We={};function tt(pt){if(!We[pt]&&!ot[pt]){if(Mt[pt]){Mt[pt].forEach(tt);return}Ie.push(pt),We[pt]=!0}}throw ge.forEach(tt),new dl(pe+": "+Ie.map(Ma).join([", "]))}function cs(pe,ge,Ie,We,tt,pt,gt,rt,xt,Vt,Ht,Qt,cn){Ht=Ft(Ht),pt=Jr(tt,pt),rt&&(rt=Jr(gt,rt)),Vt&&(Vt=Jr(xt,Vt)),cn=Jr(Qt,cn);var le=Ct(Ht);vr(le,function(){ji("Cannot construct "+Ht+" due to unbound types",[We])}),Pn([pe,ge,Ie],We?[We]:[],function(se){se=se[0];var _e,Ge;We?(_e=se.registeredClass,Ge=_e.instancePrototype):Ge=Co.prototype;var Ze=$t(le,function(){if(Object.getPrototypeOf(this)!==St)throw new Dn("Use 'new' to construct "+Ht);if(dt.constructor_body===void 0)throw new Dn(Ht+" has no accessible constructor");var W=dt.constructor_body[arguments.length];if(W===void 0)throw new Dn("Tried to invoke ctor of "+Ht+" with invalid number of parameters ("+arguments.length+") - expected ("+Object.keys(dt.constructor_body).toString()+") parameters instead!");return W.apply(this,arguments)}),St=Object.create(Ge,{constructor:{value:Ze}});Ze.prototype=St;var dt=new Ga(Ht,Ze,St,cn,_e,pt,rt,Vt),ct=new Da(Ht,dt,!0,!1,!1),Z=new Da(Ht+"*",dt,!1,!1,!1),te=new Da(Ht+" const*",dt,!1,!0,!1);return Yn[pe]={pointerType:Z,constPointerType:te},$i(le,Ze),[ct,Z,te]})}function So(pe,ge){for(var Ie=[],We=0;We<pe;We++)Ie.push(F[ge+We*4>>2]);return Ie}function ta(pe,ge){if(!(pe instanceof Function))throw new TypeError("new_ called with constructor type "+typeof pe+" which is not a function");var Ie=$t(pe.name||"unknownFunctionName",function(){});Ie.prototype=pe.prototype;var We=new Ie,tt=pe.apply(We,ge);return tt instanceof Object?tt:We}function za(pe,ge,Ie,We,tt){var pt=ge.length;pt<2&&Bt("argTypes array size mismatch! Must at least get return value and 'this' types!");for(var gt=ge[1]!==null&&Ie!==null,rt=!1,xt=1;xt<ge.length;++xt)if(ge[xt]!==null&&ge[xt].destructorFunction===void 0){rt=!0;break}for(var Vt=ge[0].name!=="void",Ht="",Qt="",xt=0;xt<pt-2;++xt)Ht+=(xt!==0?", ":"")+"arg"+xt,Qt+=(xt!==0?", ":"")+"arg"+xt+"Wired";var cn="return function "+Ct(pe)+"("+Ht+`) {
if (arguments.length !== `+(pt-2)+`) {
throwBindingError('function `+pe+" called with ' + arguments.length + ' arguments, expected "+(pt-2)+` args!');
}
`;rt&&(cn+=`var destructors = [];
`);var le=rt?"destructors":"null",se=["throwBindingError","invoker","fn","runDestructors","retType","classParam"],_e=[Bt,We,tt,Fe,ge[0],ge[1]];gt&&(cn+="var thisWired = classParam.toWireType("+le+`, this);
`);for(var xt=0;xt<pt-2;++xt)cn+="var arg"+xt+"Wired = argType"+xt+".toWireType("+le+", arg"+xt+"); // "+ge[xt+2].name+`
`,se.push("argType"+xt),_e.push(ge[xt+2]);if(gt&&(Qt="thisWired"+(Qt.length>0?", ":"")+Qt),cn+=(Vt?"var rv = ":"")+"invoker(fn"+(Qt.length>0?", ":"")+Qt+`);
`,rt)cn+=`runDestructors(destructors);
`;else for(var xt=gt?1:2;xt<ge.length;++xt){var Ge=xt===1?"thisWired":"arg"+(xt-2)+"Wired";ge[xt].destructorFunction!==null&&(cn+=Ge+"_dtor("+Ge+"); // "+ge[xt].name+`
`,se.push(Ge+"_dtor"),_e.push(ge[xt].destructorFunction))}Vt&&(cn+=`var ret = retType.fromWireType(rv);
return ret;
`),cn+=`}
`,se.push(cn);var Ze=ta(Function,se).apply(null,_e);return Ze}function zo(pe,ge,Ie,We,tt,pt){_(ge>0);var gt=So(ge,Ie);tt=Jr(We,tt),Pn([],[pe],function(rt){rt=rt[0];var xt="constructor "+rt.name;if(rt.registeredClass.constructor_body===void 0&&(rt.registeredClass.constructor_body=[]),rt.registeredClass.constructor_body[ge-1]!==void 0)throw new Dn("Cannot register multiple constructors with identical number of parameters ("+(ge-1)+") for class '"+rt.name+"'! Overload resolution is currently only performed using the parameter count, not actual type info!");return rt.registeredClass.constructor_body[ge-1]=()=>{ji("Cannot construct "+rt.name+" due to unbound types",gt)},Pn([],gt,function(Vt){return Vt.splice(1,0,null),rt.registeredClass.constructor_body[ge-1]=za(xt,Vt,null,tt,pt),[]}),[]})}function ql(pe,ge,Ie,We,tt,pt,gt,rt){var xt=So(Ie,We);ge=Ft(ge),pt=Jr(tt,pt),Pn([],[pe],function(Vt){Vt=Vt[0];var Ht=Vt.name+"."+ge;ge.startsWith("@@")&&(ge=Symbol[ge.substring(2)]),rt&&Vt.registeredClass.pureVirtualFunctions.push(ge);function Qt(){ji("Cannot call "+Ht+" due to unbound types",xt)}var cn=Vt.registeredClass.instancePrototype,le=cn[ge];return le===void 0||le.overloadTable===void 0&&le.className!==Vt.name&&le.argCount===Ie-2?(Qt.argCount=Ie-2,Qt.className=Vt.name,cn[ge]=Qt):(Hl(cn,ge,Ht),cn[ge].overloadTable[Ie-2]=Qt),Pn([],xt,function(se){var _e=za(Ht,se,Vt,pt,gt);return cn[ge].overloadTable===void 0?(_e.argCount=Ie-2,cn[ge]=_e):cn[ge].overloadTable[Ie-2]=_e,[]}),[]})}var us=[],Dr=[{},{value:void 0},{value:null},{value:!0},{value:!1}];function ro(pe){pe>4&&--Dr[pe].refcount===0&&(Dr[pe]=void 0,us.push(pe))}function Or(){for(var pe=0,ge=5;ge<Dr.length;++ge)Dr[ge]!==void 0&&++pe;return pe}function ci(){for(var pe=5;pe<Dr.length;++pe)if(Dr[pe]!==void 0)return Dr[pe];return null}function fs(){a.count_emval_handles=Or,a.get_first_emval=ci}var ui={toValue:pe=>(pe||Bt("Cannot use deleted val. handle = "+pe),Dr[pe].value),toHandle:pe=>{switch(pe){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:{var ge=us.length?us.pop():Dr.length;return Dr[ge]={refcount:1,value:pe},ge}}}};function Xl(pe,ge){ge=Ft(ge),qt(pe,{name:ge,fromWireType:function(Ie){var We=ui.toValue(Ie);return ro(Ie),We},toWireType:function(Ie,We){return ui.toHandle(We)},argPackAdvance:8,readValueFromPointer:Qe,destructorFunction:null})}function Ti(pe){if(pe===null)return"null";var ge=typeof pe;return ge==="object"||ge==="array"||ge==="function"?pe.toString():""+pe}function io(pe,ge){switch(ge){case 2:return function(Ie){return this.fromWireType(J[Ie>>2])};case 3:return function(Ie){return this.fromWireType(Q[Ie>>3])};default:throw new TypeError("Unknown float type: "+pe)}}function ds(pe,ge,Ie){var We=Ke(Ie);ge=Ft(ge),qt(pe,{name:ge,fromWireType:function(tt){return tt},toWireType:function(tt,pt){return pt},argPackAdvance:8,readValueFromPointer:io(ge,We),destructorFunction:null})}function To(pe,ge,Ie,We,tt,pt){var gt=So(ge,Ie);pe=Ft(pe),tt=Jr(We,tt),vr(pe,function(){ji("Cannot call "+pe+" due to unbound types",gt)},ge-1),Pn([],gt,function(rt){var xt=[rt[0],null].concat(rt.slice(1));return $i(pe,za(pe,xt,null,tt,pt),ge-1),[]})}function ga(pe,ge,Ie){switch(ge){case 0:return Ie?function(tt){return B[tt]}:function(tt){return V[tt]};case 1:return Ie?function(tt){return $[tt>>1]}:function(tt){return U[tt>>1]};case 2:return Ie?function(tt){return G[tt>>2]}:function(tt){return F[tt>>2]};default:throw new TypeError("Unknown integer type: "+pe)}}function Ei(pe,ge,Ie,We,tt){ge=Ft(ge);var pt=Ke(Ie),gt=Qt=>Qt;if(We===0){var rt=32-8*Ie;gt=Qt=>Qt<<rt>>>rt}var xt=ge.includes("unsigned"),Vt=(Qt,cn)=>{},Ht;xt?Ht=function(Qt,cn){return Vt(cn,this.name),cn>>>0}:Ht=function(Qt,cn){return Vt(cn,this.name),cn},qt(pe,{name:ge,fromWireType:gt,toWireType:Ht,argPackAdvance:8,readValueFromPointer:ga(ge,pt,We!==0),destructorFunction:null})}function Wo(pe,ge,Ie){var We=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],tt=We[ge];function pt(gt){gt=gt>>2;var rt=F,xt=rt[gt],Vt=rt[gt+1];return new tt(A,Vt,xt)}Ie=Ft(Ie),qt(pe,{name:Ie,fromWireType:pt,argPackAdvance:8,readValueFromPointer:pt},{ignoreDuplicateRegistrations:!0})}function hl(pe,ge){ge=Ft(ge);var Ie=ge==="std::string";qt(pe,{name:ge,fromWireType:function(We){var tt=F[We>>2],pt=We+4,gt;if(Ie)for(var rt=pt,xt=0;xt<=tt;++xt){var Vt=pt+xt;if(xt==tt||V[Vt]==0){var Ht=Vt-rt,Qt=R(rt,Ht);gt===void 0?gt=Qt:(gt+="\0",gt+=Qt),rt=Vt+1}}else{for(var cn=new Array(tt),xt=0;xt<tt;++xt)cn[xt]=String.fromCharCode(V[pt+xt]);gt=cn.join("")}return ao(We),gt},toWireType:function(We,tt){tt instanceof ArrayBuffer&&(tt=new Uint8Array(tt));var pt,gt=typeof tt=="string";gt||tt instanceof Uint8Array||tt instanceof Uint8ClampedArray||tt instanceof Int8Array||Bt("Cannot pass non-string to std::string"),Ie&&gt?pt=N(tt):pt=tt.length;var rt=Ho(4+pt+1),xt=rt+4;if(F[rt>>2]=pt,Ie&&gt)P(tt,xt,pt+1);else if(gt)for(var Vt=0;Vt<pt;++Vt){var Ht=tt.charCodeAt(Vt);Ht>255&&(ao(xt),Bt("String has UTF-16 code units that do not fit in 8 bits")),V[xt+Vt]=Ht}else for(var Vt=0;Vt<pt;++Vt)V[xt+Vt]=tt[Vt];return We!==null&&We.push(ao,rt),rt},argPackAdvance:8,readValueFromPointer:Qe,destructorFunction:function(We){ao(We)}})}var hs=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0;function Ls(pe,ge){for(var Ie=pe,We=Ie>>1,tt=We+ge/2;!(We>=tt)&&U[We];)++We;if(Ie=We<<1,Ie-pe>32&&hs)return hs.decode(V.subarray(pe,Ie));for(var pt="",gt=0;!(gt>=ge/2);++gt){var rt=$[pe+gt*2>>1];if(rt==0)break;pt+=String.fromCharCode(rt)}return pt}function pl(pe,ge,Ie){if(Ie===void 0&&(Ie=2147483647),Ie<2)return 0;Ie-=2;for(var We=ge,tt=Ie<pe.length*2?Ie/2:pe.length,pt=0;pt<tt;++pt){var gt=pe.charCodeAt(pt);$[ge>>1]=gt,ge+=2}return $[ge>>1]=0,ge-We}function ks(pe){return pe.length*2}function Vs(pe,ge){for(var Ie=0,We="";!(Ie>=ge/4);){var tt=G[pe+Ie*4>>2];if(tt==0)break;if(++Ie,tt>=65536){var pt=tt-65536;We+=String.fromCharCode(55296|pt>>10,56320|pt&1023)}else We+=String.fromCharCode(tt)}return We}function gl(pe,ge,Ie){if(Ie===void 0&&(Ie=2147483647),Ie<4)return 0;for(var We=ge,tt=We+Ie-4,pt=0;pt<pe.length;++pt){var gt=pe.charCodeAt(pt);if(gt>=55296&&gt<=57343){var rt=pe.charCodeAt(++pt);gt=65536+((gt&1023)<<10)|rt&1023}if(G[ge>>2]=gt,ge+=4,ge+4>tt)break}return G[ge>>2]=0,ge-We}function Mc(pe){for(var ge=0,Ie=0;Ie<pe.length;++Ie){var We=pe.charCodeAt(Ie);We>=55296&&We<=57343&&++Ie,ge+=4}return ge}function Pu(pe,ge,Ie){Ie=Ft(Ie);var We,tt,pt,gt,rt;ge===2?(We=Ls,tt=pl,gt=ks,pt=()=>U,rt=1):ge===4&&(We=Vs,tt=gl,gt=Mc,pt=()=>F,rt=2),qt(pe,{name:Ie,fromWireType:function(xt){for(var Vt=F[xt>>2],Ht=pt(),Qt,cn=xt+4,le=0;le<=Vt;++le){var se=xt+4+le*ge;if(le==Vt||Ht[se>>rt]==0){var _e=se-cn,Ge=We(cn,_e);Qt===void 0?Qt=Ge:(Qt+="\0",Qt+=Ge),cn=se+ge}}return ao(xt),Qt},toWireType:function(xt,Vt){typeof Vt!="string"&&Bt("Cannot pass non-string to C++ string type "+Ie);var Ht=gt(Vt),Qt=Ho(4+Ht+ge);return F[Qt>>2]=Ht>>rt,tt(Vt,Qt+4,Ht+ge),xt!==null&&xt.push(ao,Qt),Qt},argPackAdvance:8,readValueFromPointer:Qe,destructorFunction:function(xt){ao(xt)}})}function Au(pe,ge,Ie,We,tt,pt){Ot[pe]={name:Ft(ge),rawConstructor:Jr(Ie,We),rawDestructor:Jr(tt,pt),fields:[]}}function Nu(pe,ge,Ie,We,tt,pt,gt,rt,xt,Vt){Ot[pe].fields.push({fieldName:Ft(ge),getterReturnType:Ie,getter:Jr(We,tt),getterContext:pt,setterArgumentType:gt,setter:Jr(rt,xt),setterContext:Vt})}function Yl(pe,ge){ge=Ft(ge),qt(pe,{isVoid:!0,name:ge,argPackAdvance:0,fromWireType:function(){},toWireType:function(Ie,We){}})}var Ic={};function Lu(pe){var ge=Ic[pe];return ge===void 0?Ft(pe):ge}function Rc(){return typeof globalThis=="object"?globalThis:(function(){return Function})()("return this")()}function Pc(pe){return pe===0?ui.toHandle(Rc()):(pe=Lu(pe),ui.toHandle(Rc()[pe]))}function ku(pe){pe>4&&(Dr[pe].refcount+=1)}function ml(pe,ge){var Ie=ot[pe];return Ie===void 0&&Bt(ge+" has unknown type "+Ma(pe)),Ie}function Ac(pe){for(var ge="",Ie=0;Ie<pe;++Ie)ge+=(Ie!==0?", ":"")+"arg"+Ie;for(var We=()=>F,tt="return function emval_allocator_"+pe+`(constructor, argTypes, args) {
  var HEAPU32 = getMemory();
`,Ie=0;Ie<pe;++Ie)tt+="var argType"+Ie+" = requireRegisteredType(HEAPU32[((argTypes)>>2)], 'parameter "+Ie+`');
var arg`+Ie+" = argType"+Ie+`.readValueFromPointer(args);
args += argType`+Ie+`['argPackAdvance'];
argTypes += 4;
`;return tt+="var obj = new constructor("+ge+`);
return valueToHandle(obj);
}
`,new Function("requireRegisteredType","Module","valueToHandle","getMemory",tt)(ml,a,ui.toHandle,We)}var Nc={};function Jl(pe,ge,Ie,We){pe=ui.toValue(pe);var tt=Nc[ge];return tt||(tt=Ac(ge),Nc[ge]=tt),tt(pe,Ie,We)}function Vu(pe,ge){pe=ml(pe,"_emval_take_value");var Ie=pe.readValueFromPointer(ge);return ui.toHandle(Ie)}function vl(){Oe("")}function Fu(pe,ge,Ie){V.copyWithin(pe,ge,ge+Ie)}function Lc(){return 2147483648}function Uu(pe){try{return S.grow(pe-A.byteLength+65535>>>16),ne(S.buffer),1}catch{}}function kc(pe){var ge=V.length;pe=pe>>>0;var Ie=Lc();if(pe>Ie)return!1;let We=(xt,Vt)=>xt+(Vt-xt%Vt)%Vt;for(var tt=1;tt<=4;tt*=2){var pt=ge*(1+.2/tt);pt=Math.min(pt,pe+100663296);var gt=Math.min(Ie,We(Math.max(pe,pt),65536)),rt=Uu(gt);if(rt)return!0}return!1}function Bu(pe){var ge=a["_"+pe];return ge}function $u(pe,ge){B.set(pe,ge)}function Zl(pe,ge,Ie,We,tt){var pt={string:se=>{var _e=0;if(se!=null&&se!==0){var Ge=(se.length<<2)+1;_e=Fs(Ge),P(se,_e,Ge)}return _e},array:se=>{var _e=Fs(se.length);return $u(se,_e),_e}};function gt(se){return ge==="string"?R(se):ge==="boolean"?!!se:se}var rt=Bu(pe),xt=[],Vt=0;if(We)for(var Ht=0;Ht<We.length;Ht++){var Qt=pt[Ie[Ht]];Qt?(Vt===0&&(Vt=Vc()),xt[Ht]=Qt(We[Ht])):xt[Ht]=We[Ht]}var cn=rt.apply(null,xt);function le(se){return Vt!==0&&Fc(Vt),gt(se)}return cn=le(cn),cn}Tn=a.InternalError=bn(Error,"InternalError"),Et(),Dn=a.BindingError=bn(Error,"BindingError"),$o(),_a(),Oc(),dl=a.UnboundTypeError=bn(Error,"UnboundTypeError"),fs();var Ql={h:ht,q:mi,r:hr,w:kt,p:cs,o:zo,c:ql,v:Xl,k:ds,e:To,b:Ei,a:Wo,j:hl,g:Pu,u:Au,d:Nu,x:Yl,i:ro,m:Pc,l:ku,y:Jl,n:Vu,f:vl,t:Fu,s:kc};Se(),a.___wasm_call_ctors=function(){return(a.___wasm_call_ctors=a.asm.A).apply(null,arguments)};var Ho=a._malloc=function(){return(Ho=a._malloc=a.asm.B).apply(null,arguments)},ps=a.___getTypeName=function(){return(ps=a.___getTypeName=a.asm.D).apply(null,arguments)};a.__embind_initialize_bindings=function(){return(a.__embind_initialize_bindings=a.asm.E).apply(null,arguments)};var ao=a._free=function(){return(ao=a._free=a.asm.F).apply(null,arguments)},Vc=a.stackSave=function(){return(Vc=a.stackSave=a.asm.G).apply(null,arguments)},Fc=a.stackRestore=function(){return(Fc=a.stackRestore=a.asm.H).apply(null,arguments)},Fs=a.stackAlloc=function(){return(Fs=a.stackAlloc=a.asm.I).apply(null,arguments)},gs=a.___cxa_is_pointer_type=function(){return(gs=a.___cxa_is_pointer_type=a.asm.J).apply(null,arguments)};a.ccall=Zl;var yl;de=function pe(){yl||ec(),yl||(de=pe)};function ec(pe){if(re>0||(Ae(),re>0))return;function ge(){yl||(yl=!0,a.calledRun=!0,!T&&(Me(),o(a),a.onRuntimeInitialized&&a.onRuntimeInitialized(),q()))}a.setStatus?(a.setStatus("Running..."),setTimeout(function(){setTimeout(function(){a.setStatus("")},1),ge()},1)):ge()}if(a.preInit)for(typeof a.preInit=="function"&&(a.preInit=[a.preInit]);a.preInit.length>0;)a.preInit.pop()();return ec(),i.ready})})();t.exports=n})(X8)),X8.exports}var LWe=NWe();const kWe=sl(LWe),VWe=new URL("/assets/charlswasm_decode-484ovEoR.wasm",import.meta.url),_g={codec:void 0,decoder:void 0,decodeConfig:{}};function FWe(t){return typeof t=="number"?_g.codec.getExceptionMessage(t):t}function UWe(t){if(_g.decodeConfig=t,_g.codec)return Promise.resolve();const e=kWe({locateFile:n=>n.endsWith(".wasm")?VWe.toString():n});return new Promise((n,r)=>{e.then(i=>{_g.codec=i,_g.decoder=new i.JpegLSDecoder,n()},r)})}async function VB(t,e){try{await UWe();const n=_g.decoder;n.getEncodedBuffer(t.length).set(t),n.decode();const i=n.getFrameInfo(),a=n.getInterleaveMode(),o=n.getNearLossless(),s=n.getDecodedBuffer(),l={columns:i.width,rows:i.height,bitsPerPixel:i.bitsPerSample,signed:e.signed,bytesPerPixel:e.bytesPerPixel,componentsPerPixel:i.componentCount},c=BWe(i,s,e.signed),f={nearLossless:o,interleaveMode:a,frameInfo:i};return{...e,pixelData:c,imageInfo:l,encodeOptions:f,...f,...l}}catch(n){throw FWe(n)}}function BWe(t,e,n){return t.bitsPerSample>8?n?new Int16Array(e.buffer,e.byteOffset,e.byteLength/2):new Uint16Array(e.buffer,e.byteOffset,e.byteLength/2):n?new Int8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}var Y8={exports:{}},FB;function $We(){return FB||(FB=1,(function(t,e){var n=(()=>{var r=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename<"u"&&(r=r||__filename),(function(i){i=i||{};var a=typeof i<"u"?i:{},o,s;a.ready=new Promise(function(le,se){o=le,s=se});var l=Object.assign({},a),c="./this.program",f=typeof window=="object",u=typeof importScripts=="function",d=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",h="";function p(le){return a.locateFile?a.locateFile(le,h):h+le}var g,m,y;if(d){var v=Ff,x=Ff;u?h=x.dirname(h)+"/":h=__dirname+"/",g=(le,se)=>(le=Te(le)?new URL(le):x.normalize(le),v.readFileSync(le,se?void 0:"utf8")),y=le=>{var se=g(le,!0);return se.buffer||(se=new Uint8Array(se)),se},m=(le,se,_e)=>{le=Te(le)?new URL(le):x.normalize(le),v.readFile(le,function(Ge,Ze){Ge?_e(Ge):se(Ze.buffer)})},process.argv.length>1&&(c=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2),process.on("uncaughtException",function(le){if(!(le instanceof ut))throw le}),process.on("unhandledRejection",function(le){throw le}),a.inspect=function(){return"[Emscripten Module object]"}}else(f||u)&&(u?h=self.location.href:typeof document<"u"&&document.currentScript&&(h=document.currentScript.src),r&&(h=r),h.indexOf("blob:")!==0?h=h.substr(0,h.replace(/[?#].*/,"").lastIndexOf("/")+1):h="",g=le=>{var se=new XMLHttpRequest;return se.open("GET",le,!1),se.send(null),se.responseText},u&&(y=le=>{var se=new XMLHttpRequest;return se.open("GET",le,!1),se.responseType="arraybuffer",se.send(null),new Uint8Array(se.response)}),m=(le,se,_e)=>{var Ge=new XMLHttpRequest;Ge.open("GET",le,!0),Ge.responseType="arraybuffer",Ge.onload=()=>{if(Ge.status==200||Ge.status==0&&Ge.response){se(Ge.response);return}_e()},Ge.onerror=_e,Ge.send(null)});var w=a.print||console.log.bind(console),S=a.printErr||console.warn.bind(console);Object.assign(a,l),l=null,a.arguments&&a.arguments,a.thisProgram&&(c=a.thisProgram),a.quit&&a.quit;var T;a.wasmBinary&&(T=a.wasmBinary),a.noExitRuntime,typeof WebAssembly!="object"&&Ne("no native wasm support detected");var _,D=!1;function I(le,se){le||Ne(se)}var R=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function O(le,se,_e){for(var Ge=se+_e,Ze=se;le[Ze]&&!(Ze>=Ge);)++Ze;if(Ze-se>16&&le.buffer&&R)return R.decode(le.subarray(se,Ze));for(var St="";se<Ze;){var dt=le[se++];if(!(dt&128)){St+=String.fromCharCode(dt);continue}var ct=le[se++]&63;if((dt&224)==192){St+=String.fromCharCode((dt&31)<<6|ct);continue}var Z=le[se++]&63;if((dt&240)==224?dt=(dt&15)<<12|ct<<6|Z:dt=(dt&7)<<18|ct<<12|Z<<6|le[se++]&63,dt<65536)St+=String.fromCharCode(dt);else{var te=dt-65536;St+=String.fromCharCode(55296|te>>10,56320|te&1023)}}return St}function P(le,se){return le?O(U,le,se):""}function N(le,se,_e,Ge){if(!(Ge>0))return 0;for(var Ze=_e,St=_e+Ge-1,dt=0;dt<le.length;++dt){var ct=le.charCodeAt(dt);if(ct>=55296&&ct<=57343){var Z=le.charCodeAt(++dt);ct=65536+((ct&1023)<<10)|Z&1023}if(ct<=127){if(_e>=St)break;se[_e++]=ct}else if(ct<=2047){if(_e+1>=St)break;se[_e++]=192|ct>>6,se[_e++]=128|ct&63}else if(ct<=65535){if(_e+2>=St)break;se[_e++]=224|ct>>12,se[_e++]=128|ct>>6&63,se[_e++]=128|ct&63}else{if(_e+3>=St)break;se[_e++]=240|ct>>18,se[_e++]=128|ct>>12&63,se[_e++]=128|ct>>6&63,se[_e++]=128|ct&63}}return se[_e]=0,_e-Ze}function A(le,se,_e){return N(le,U,se,_e)}function B(le){for(var se=0,_e=0;_e<le.length;++_e){var Ge=le.charCodeAt(_e);Ge<=127?se++:Ge<=2047?se+=2:Ge>=55296&&Ge<=57343?(se+=4,++_e):se+=3}return se}var V,$,U,G,F,J,Q,ne,ye;function ve(le){V=le,a.HEAP8=$=new Int8Array(le),a.HEAP16=G=new Int16Array(le),a.HEAP32=J=new Int32Array(le),a.HEAPU8=U=new Uint8Array(le),a.HEAPU16=F=new Uint16Array(le),a.HEAPU32=Q=new Uint32Array(le),a.HEAPF32=ne=new Float32Array(le),a.HEAPF64=ye=new Float64Array(le)}a.INITIAL_MEMORY;var Ce,we=[],Ae=[],Me=[];function q(){if(a.preRun)for(typeof a.preRun=="function"&&(a.preRun=[a.preRun]);a.preRun.length;)X(a.preRun.shift());ht(we)}function k(){ht(Ae)}function Y(){if(a.postRun)for(typeof a.postRun=="function"&&(a.postRun=[a.postRun]);a.postRun.length;)de(a.postRun.shift());ht(Me)}function X(le){we.unshift(le)}function re(le){Ae.unshift(le)}function de(le){Me.unshift(le)}var he=0,Ee=null;function Oe(le){he++,a.monitorRunDependencies&&a.monitorRunDependencies(he)}function Pe(le){if(he--,a.monitorRunDependencies&&a.monitorRunDependencies(he),he==0&&Ee){var se=Ee;Ee=null,se()}}function Ne(le){a.onAbort&&a.onAbort(le),le="Aborted("+le+")",S(le),D=!0,le+=". Build with -sASSERTIONS for more info.";var se=new WebAssembly.RuntimeError(le);throw s(se),se}var ie="data:application/octet-stream;base64,";function ae(le){return le.startsWith(ie)}function Te(le){return le.startsWith("file://")}var me;me="openjpegwasm_decode.wasm",ae(me)||(me=p(me));function Se(le){try{if(le==me&&T)return new Uint8Array(T);if(y)return y(le);throw"both async and sync fetching of the wasm failed"}catch(se){Ne(se)}}function Ve(){if(!T&&(f||u)){if(typeof fetch=="function"&&!Te(me))return fetch(me,{credentials:"same-origin"}).then(function(le){if(!le.ok)throw"failed to load wasm binary file at '"+me+"'";return le.arrayBuffer()}).catch(function(){return Se(me)});if(m)return new Promise(function(le,se){m(me,function(_e){le(new Uint8Array(_e))},se)})}return Promise.resolve().then(function(){return Se(me)})}function ue(){var le={a:We};function se(dt,ct){var Z=dt.exports;a.asm=Z,_=a.asm.E,ve(_.buffer),Ce=a.asm.G,re(a.asm.F),Pe()}Oe();function _e(dt){se(dt.instance)}function Ge(dt){return Ve().then(function(ct){return WebAssembly.instantiate(ct,le)}).then(function(ct){return ct}).then(dt,function(ct){S("failed to asynchronously prepare wasm: "+ct),Ne(ct)})}function Ze(){return!T&&typeof WebAssembly.instantiateStreaming=="function"&&!ae(me)&&!Te(me)&&!d&&typeof fetch=="function"?fetch(me,{credentials:"same-origin"}).then(function(dt){var ct=WebAssembly.instantiateStreaming(dt,le);return ct.then(_e,function(Z){return S("wasm streaming compile failed: "+Z),S("falling back to ArrayBuffer instantiation"),Ge(_e)})}):Ge(_e)}if(a.instantiateWasm)try{var St=a.instantiateWasm(le,se);return St}catch(dt){S("Module.instantiateWasm callback failed with error: "+dt),s(dt)}return Ze().catch(s),{}}function ut(le){this.name="ExitStatus",this.message="Program terminated with exit("+le+")",this.status=le}function ht(le){for(;le.length>0;)le.shift()(a)}function Ot(le){this.excPtr=le,this.ptr=le-24,this.set_type=function(se){Q[this.ptr+4>>2]=se},this.get_type=function(){return Q[this.ptr+4>>2]},this.set_destructor=function(se){Q[this.ptr+8>>2]=se},this.get_destructor=function(){return Q[this.ptr+8>>2]},this.set_refcount=function(se){J[this.ptr>>2]=se},this.set_caught=function(se){se=se?1:0,$[this.ptr+12>>0]=se},this.get_caught=function(){return $[this.ptr+12>>0]!=0},this.set_rethrown=function(se){se=se?1:0,$[this.ptr+13>>0]=se},this.get_rethrown=function(){return $[this.ptr+13>>0]!=0},this.init=function(se,_e){this.set_adjusted_ptr(0),this.set_type(se),this.set_destructor(_e),this.set_refcount(0),this.set_caught(!1),this.set_rethrown(!1)},this.add_ref=function(){var se=J[this.ptr>>2];J[this.ptr>>2]=se+1},this.release_ref=function(){var se=J[this.ptr>>2];return J[this.ptr>>2]=se-1,se===1},this.set_adjusted_ptr=function(se){Q[this.ptr+16>>2]=se},this.get_adjusted_ptr=function(){return Q[this.ptr+16>>2]},this.get_exception_ptr=function(){var se=Ht(this.get_type());if(se)return Q[this.excPtr>>2];var _e=this.get_adjusted_ptr();return _e!==0?_e:this.excPtr}}function Fe(le,se,_e){var Ge=new Ot(le);throw Ge.init(se,_e),le}var Qe={};function st(le){for(;le.length;){var se=le.pop(),_e=le.pop();_e(se)}}function ot(le){return this.fromWireType(J[le>>2])}var Mt={},Ue={},He={},Ct=48,$t=57;function bn(le){if(le===void 0)return"_unknown";le=le.replace(/[^a-zA-Z0-9_]/g,"$");var se=le.charCodeAt(0);return se>=Ct&&se<=$t?"_"+le:le}function Tn(le,se){return le=bn(le),new Function("body","return function "+le+`() {
    "use strict";    return body.apply(this, arguments);
};
`)(se)}function en(le,se){var _e=Tn(se,function(Ge){this.name=se,this.message=Ge;var Ze=new Error(Ge).stack;Ze!==void 0&&(this.stack=this.toString()+`
`+Ze.replace(/^Error(:[^\n]*)?\n/,""))});return _e.prototype=Object.create(le.prototype),_e.prototype.constructor=_e,_e.prototype.toString=function(){return this.message===void 0?this.name:this.name+": "+this.message},_e}var Pn=void 0;function mi(le){throw new Pn(le)}function hr(le,se,_e){le.forEach(function(ct){He[ct]=se});function Ge(ct){var Z=_e(ct);Z.length!==le.length&&mi("Mismatched type converter count");for(var te=0;te<le.length;++te)Zt(le[te],Z[te])}var Ze=new Array(se.length),St=[],dt=0;se.forEach((ct,Z)=>{Ue.hasOwnProperty(ct)?Ze[Z]=Ue[ct]:(St.push(ct),Mt.hasOwnProperty(ct)||(Mt[ct]=[]),Mt[ct].push(()=>{Ze[Z]=Ue[ct],++dt,dt===St.length&&Ge(Ze)}))}),St.length===0&&Ge(Ze)}function Ke(le){var se=Qe[le];delete Qe[le];var _e=se.rawConstructor,Ge=se.rawDestructor,Ze=se.fields,St=Ze.map(dt=>dt.getterReturnType).concat(Ze.map(dt=>dt.setterArgumentType));hr([le],St,dt=>{var ct={};return Ze.forEach((Z,te)=>{var W=Z.fieldName,K=dt[te],oe=Z.getter,be=Z.getterContext,De=dt[te+Ze.length],Re=Z.setter,Le=Z.setterContext;ct[W]={read:Be=>K.fromWireType(oe(be,Be)),write:(Be,qe)=>{var ft=[];Re(Le,Be,De.toWireType(ft,qe)),st(ft)}}}),[{name:se.name,fromWireType:function(Z){var te={};for(var W in ct)te[W]=ct[W].read(Z);return Ge(Z),te},toWireType:function(Z,te){for(var W in ct)if(!(W in te))throw new TypeError('Missing field:  "'+W+'"');var K=_e();for(W in ct)ct[W].write(K,te[W]);return Z!==null&&Z.push(Ge,K),K},argPackAdvance:8,readValueFromPointer:ot,destructorFunction:Ge}]})}function Et(le,se,_e,Ge,Ze){}function Rt(le){switch(le){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+le)}}function Ft(){for(var le=new Array(256),se=0;se<256;++se)le[se]=String.fromCharCode(se);Dn=le}var Dn=void 0;function Bt(le){for(var se="",_e=le;U[_e];)se+=Dn[U[_e++]];return se}var qt=void 0;function kt(le){throw new qt(le)}function Zt(le,se,_e={}){if(!("argPackAdvance"in se))throw new TypeError("registerType registeredInstance requires argPackAdvance");var Ge=se.name;if(le||kt('type "'+Ge+'" must have a positive integer typeid pointer'),Ue.hasOwnProperty(le)){if(_e.ignoreDuplicateRegistrations)return;kt("Cannot register type '"+Ge+"' twice")}if(Ue[le]=se,delete He[le],Mt.hasOwnProperty(le)){var Ze=Mt[le];delete Mt[le],Ze.forEach(St=>St())}}function wr(le,se,_e,Ge,Ze){var St=Rt(_e);se=Bt(se),Zt(le,{name:se,fromWireType:function(dt){return!!dt},toWireType:function(dt,ct){return ct?Ge:Ze},argPackAdvance:8,readValueFromPointer:function(dt){var ct;if(_e===1)ct=$;else if(_e===2)ct=G;else if(_e===4)ct=J;else throw new TypeError("Unknown boolean type size: "+se);return this.fromWireType(ct[dt>>St])},destructorFunction:null})}function $r(le){if(!(this instanceof vr)||!(le instanceof vr))return!1;for(var se=this.$$.ptrType.registeredClass,_e=this.$$.ptr,Ge=le.$$.ptrType.registeredClass,Ze=le.$$.ptr;se.baseClass;)_e=se.upcast(_e),se=se.baseClass;for(;Ge.baseClass;)Ze=Ge.upcast(Ze),Ge=Ge.baseClass;return se===Ge&&_e===Ze}function oi(le){return{count:le.count,deleteScheduled:le.deleteScheduled,preservePointerOnDelete:le.preservePointerOnDelete,ptr:le.ptr,ptrType:le.ptrType,smartPtr:le.smartPtr,smartPtrType:le.smartPtrType}}function Li(le){function se(_e){return _e.$$.ptrType.registeredClass.name}kt(se(le)+" instance already deleted")}var vi=!1;function ki(le){}function nn(le){le.smartPtr?le.smartPtrType.rawDestructor(le.smartPtr):le.ptrType.registeredClass.rawDestructor(le.ptr)}function Yn(le){le.count.value-=1;var se=le.count.value===0;se&&nn(le)}function Si(le,se,_e){if(se===_e)return le;if(_e.baseClass===void 0)return null;var Ge=Si(le,se,_e.baseClass);return Ge===null?null:_e.downcast(Ge)}var rn={};function si(){return Object.keys(Uo).length}function os(){var le=[];for(var se in Uo)Uo.hasOwnProperty(se)&&le.push(Uo[se]);return le}var li=[];function Vi(){for(;li.length;){var le=li.pop();le.$$.deleteScheduled=!1,le.delete()}}var _a=void 0;function Fi(le){_a=le,li.length&&_a&&_a(Vi)}function As(){a.getInheritedInstanceCount=si,a.getLiveInheritedInstances=os,a.flushPendingDeletes=Vi,a.setDelayFunction=Fi}var Uo={};function Ui(le,se){for(se===void 0&&kt("ptr should not be undefined");le.baseClass;)se=le.upcast(se),le=le.baseClass;return se}function Bo(le,se){return se=Ui(le,se),Uo[se]}function Pt(le,se){(!se.ptrType||!se.ptr)&&mi("makeClassHandle requires ptr and ptrType");var _e=!!se.smartPtrType,Ge=!!se.smartPtr;return _e!==Ge&&mi("Both smartPtrType and smartPtr must be specified"),se.count={value:1},no(Object.create(le,{$$:{value:se}}))}function Bi(le){var se=this.getPointee(le);if(!se)return this.destructor(le),null;var _e=Bo(this.registeredClass,se);if(_e!==void 0){if(_e.$$.count.value===0)return _e.$$.ptr=se,_e.$$.smartPtr=le,_e.clone();var Ge=_e.clone();return this.destructor(le),Ge}function Ze(){return this.isSmartPointer?Pt(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:se,smartPtrType:this,smartPtr:le}):Pt(this.registeredClass.instancePrototype,{ptrType:this,ptr:le})}var St=this.registeredClass.getActualType(se),dt=rn[St];if(!dt)return Ze.call(this);var ct;this.isConst?ct=dt.constPointerType:ct=dt.pointerType;var Z=Si(se,this.registeredClass,ct.registeredClass);return Z===null?Ze.call(this):this.isSmartPointer?Pt(ct.registeredClass.instancePrototype,{ptrType:ct,ptr:Z,smartPtrType:this,smartPtr:le}):Pt(ct.registeredClass.instancePrototype,{ptrType:ct,ptr:Z})}function no(le){return typeof FinalizationRegistry>"u"?(no=se=>se,le):(vi=new FinalizationRegistry(se=>{Yn(se.$$)}),no=se=>{var _e=se.$$,Ge=!!_e.smartPtr;if(Ge){var Ze={$$:_e};vi.register(se,Ze,se)}return se},ki=se=>vi.unregister(se),no(le))}function yi(){if(this.$$.ptr||Li(this),this.$$.preservePointerOnDelete)return this.$$.count.value+=1,this;var le=no(Object.create(Object.getPrototypeOf(this),{$$:{value:oi(this.$$)}}));return le.$$.count.value+=1,le.$$.deleteScheduled=!1,le}function Ns(){this.$$.ptr||Li(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&kt("Object already scheduled for deletion"),ki(this),Yn(this.$$),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)}function $o(){return!this.$$.ptr}function Co(){return this.$$.ptr||Li(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&kt("Object already scheduled for deletion"),li.push(this),li.length===1&&_a&&_a(Vi),this.$$.deleteScheduled=!0,this}function Hl(){vr.prototype.isAliasOf=$r,vr.prototype.clone=yi,vr.prototype.delete=Ns,vr.prototype.isDeleted=$o,vr.prototype.deleteLater=Co}function vr(){}function Ga(le,se,_e){if(le[se].overloadTable===void 0){var Ge=le[se];le[se]=function(){return le[se].overloadTable.hasOwnProperty(arguments.length)||kt("Function '"+_e+"' called with an invalid number of arguments ("+arguments.length+") - expects one of ("+le[se].overloadTable+")!"),le[se].overloadTable[arguments.length].apply(this,arguments)},le[se].overloadTable=[],le[se].overloadTable[Ge.argCount]=Ge}}function ul(le,se,_e){a.hasOwnProperty(le)?(kt("Cannot register public name '"+le+"' twice"),Ga(a,le,le),a.hasOwnProperty(_e)&&kt("Cannot register multiple overloads of a function with the same number of arguments ("+_e+")!"),a[le].overloadTable[_e]=se):a[le]=se}function Go(le,se,_e,Ge,Ze,St,dt,ct){this.name=le,this.constructor=se,this.instancePrototype=_e,this.rawDestructor=Ge,this.baseClass=Ze,this.getActualType=St,this.upcast=dt,this.downcast=ct,this.pureVirtualFunctions=[]}function fl(le,se,_e){for(;se!==_e;)se.upcast||kt("Expected null or instance of "+_e.name+", got an instance of "+se.name),le=se.upcast(le),se=se.baseClass;return le}function ja(le,se){if(se===null)return this.isReference&&kt("null is not a valid "+this.name),0;se.$$||kt('Cannot pass "'+ds(se)+'" as a '+this.name),se.$$.ptr||kt("Cannot pass deleted object as a pointer of type "+this.name);var _e=se.$$.ptrType.registeredClass,Ge=fl(se.$$.ptr,_e,this.registeredClass);return Ge}function Ru(le,se){var _e;if(se===null)return this.isReference&&kt("null is not a valid "+this.name),this.isSmartPointer?(_e=this.rawConstructor(),le!==null&&le.push(this.rawDestructor,_e),_e):0;se.$$||kt('Cannot pass "'+ds(se)+'" as a '+this.name),se.$$.ptr||kt("Cannot pass deleted object as a pointer of type "+this.name),!this.isConst&&se.$$.ptrType.isConst&&kt("Cannot convert argument of type "+(se.$$.smartPtrType?se.$$.smartPtrType.name:se.$$.ptrType.name)+" to parameter type "+this.name);var Ge=se.$$.ptrType.registeredClass;if(_e=fl(se.$$.ptr,Ge,this.registeredClass),this.isSmartPointer)switch(se.$$.smartPtr===void 0&&kt("Passing raw pointer to smart pointer is illegal"),this.sharingPolicy){case 0:se.$$.smartPtrType===this?_e=se.$$.smartPtr:kt("Cannot convert argument of type "+(se.$$.smartPtrType?se.$$.smartPtrType.name:se.$$.ptrType.name)+" to parameter type "+this.name);break;case 1:_e=se.$$.smartPtr;break;case 2:if(se.$$.smartPtrType===this)_e=se.$$.smartPtr;else{var Ze=se.clone();_e=this.rawShare(_e,Ti.toHandle(function(){Ze.delete()})),le!==null&&le.push(this.rawDestructor,_e)}break;default:kt("Unsupporting sharing policy")}return _e}function pa(le,se){if(se===null)return this.isReference&&kt("null is not a valid "+this.name),0;se.$$||kt('Cannot pass "'+ds(se)+'" as a '+this.name),se.$$.ptr||kt("Cannot pass deleted object as a pointer of type "+this.name),se.$$.ptrType.isConst&&kt("Cannot convert argument of type "+se.$$.ptrType.name+" to parameter type "+this.name);var _e=se.$$.ptrType.registeredClass,Ge=fl(se.$$.ptr,_e,this.registeredClass);return Ge}function Kl(le){return this.rawGetPointee&&(le=this.rawGetPointee(le)),le}function Oc(le){this.rawDestructor&&this.rawDestructor(le)}function Da(le){le!==null&&le.delete()}function $i(){Oa.prototype.getPointee=Kl,Oa.prototype.destructor=Oc,Oa.prototype.argPackAdvance=8,Oa.prototype.readValueFromPointer=ot,Oa.prototype.deleteObject=Da,Oa.prototype.fromWireType=Bi}function Oa(le,se,_e,Ge,Ze,St,dt,ct,Z,te,W){this.name=le,this.registeredClass=se,this.isReference=_e,this.isConst=Ge,this.isSmartPointer=Ze,this.pointeeType=St,this.sharingPolicy=dt,this.rawGetPointee=ct,this.rawConstructor=Z,this.rawShare=te,this.rawDestructor=W,!Ze&&se.baseClass===void 0?Ge?(this.toWireType=ja,this.destructorFunction=null):(this.toWireType=pa,this.destructorFunction=null):this.toWireType=Ru}function Gi(le,se,_e){a.hasOwnProperty(le)||mi("Replacing nonexistant public symbol"),a[le].overloadTable!==void 0&&_e!==void 0||(a[le]=se,a[le].argCount=_e)}function jo(le,se,_e){var Ge=a["dynCall_"+le];return _e&&_e.length?Ge.apply(null,[se].concat(_e)):Ge.call(null,se)}var ss=[];function ls(le){var se=ss[le];return se||(le>=ss.length&&(ss.length=le+1),ss[le]=se=Ce.get(le)),se}function Jr(le,se,_e){if(le.includes("j"))return jo(le,se,_e);var Ge=ls(se).apply(null,_e);return Ge}function dl(le,se){var _e=[];return function(){return _e.length=0,Object.assign(_e,arguments),Jr(le,se,_e)}}function Ma(le,se){le=Bt(le);function _e(){return le.includes("j")?dl(le,se):ls(se)}var Ge=_e();return typeof Ge!="function"&&kt("unknown function pointer with signature "+le+": "+se),Ge}var ji=void 0;function cs(le){var se=gt(le),_e=Bt(se);return pt(se),_e}function So(le,se){var _e=[],Ge={};function Ze(St){if(!Ge[St]&&!Ue[St]){if(He[St]){He[St].forEach(Ze);return}_e.push(St),Ge[St]=!0}}throw se.forEach(Ze),new ji(le+": "+_e.map(cs).join([", "]))}function ta(le,se,_e,Ge,Ze,St,dt,ct,Z,te,W,K,oe){W=Bt(W),St=Ma(Ze,St),ct&&(ct=Ma(dt,ct)),te&&(te=Ma(Z,te)),oe=Ma(K,oe);var be=bn(W);ul(be,function(){So("Cannot construct "+W+" due to unbound types",[Ge])}),hr([le,se,_e],Ge?[Ge]:[],function(De){De=De[0];var Re,Le;Ge?(Re=De.registeredClass,Le=Re.instancePrototype):Le=vr.prototype;var Be=Tn(be,function(){if(Object.getPrototypeOf(this)!==qe)throw new qt("Use 'new' to construct "+W);if(ft.constructor_body===void 0)throw new qt(W+" has no accessible constructor");var dn=ft.constructor_body[arguments.length];if(dn===void 0)throw new qt("Tried to invoke ctor of "+W+" with invalid number of parameters ("+arguments.length+") - expected ("+Object.keys(ft.constructor_body).toString()+") parameters instead!");return dn.apply(this,arguments)}),qe=Object.create(Le,{constructor:{value:Be}});Be.prototype=qe;var ft=new Go(W,Be,qe,oe,Re,St,ct,te),At=new Oa(W,ft,!0,!1,!1),Wt=new Oa(W+"*",ft,!1,!1,!1),Gt=new Oa(W+" const*",ft,!1,!0,!1);return rn[le]={pointerType:Wt,constPointerType:Gt},Gi(be,Be),[At,Wt,Gt]})}function za(le,se){for(var _e=[],Ge=0;Ge<le;Ge++)_e.push(Q[se+Ge*4>>2]);return _e}function zo(le,se){if(!(le instanceof Function))throw new TypeError("new_ called with constructor type "+typeof le+" which is not a function");var _e=Tn(le.name||"unknownFunctionName",function(){});_e.prototype=le.prototype;var Ge=new _e,Ze=le.apply(Ge,se);return Ze instanceof Object?Ze:Ge}function ql(le,se,_e,Ge,Ze){var St=se.length;St<2&&kt("argTypes array size mismatch! Must at least get return value and 'this' types!");for(var dt=se[1]!==null&&_e!==null,ct=!1,Z=1;Z<se.length;++Z)if(se[Z]!==null&&se[Z].destructorFunction===void 0){ct=!0;break}for(var te=se[0].name!=="void",W="",K="",Z=0;Z<St-2;++Z)W+=(Z!==0?", ":"")+"arg"+Z,K+=(Z!==0?", ":"")+"arg"+Z+"Wired";var oe="return function "+bn(le)+"("+W+`) {
if (arguments.length !== `+(St-2)+`) {
throwBindingError('function `+le+" called with ' + arguments.length + ' arguments, expected "+(St-2)+` args!');
}
`;ct&&(oe+=`var destructors = [];
`);var be=ct?"destructors":"null",De=["throwBindingError","invoker","fn","runDestructors","retType","classParam"],Re=[kt,Ge,Ze,st,se[0],se[1]];dt&&(oe+="var thisWired = classParam.toWireType("+be+`, this);
`);for(var Z=0;Z<St-2;++Z)oe+="var arg"+Z+"Wired = argType"+Z+".toWireType("+be+", arg"+Z+"); // "+se[Z+2].name+`
`,De.push("argType"+Z),Re.push(se[Z+2]);if(dt&&(K="thisWired"+(K.length>0?", ":"")+K),oe+=(te?"var rv = ":"")+"invoker(fn"+(K.length>0?", ":"")+K+`);
`,ct)oe+=`runDestructors(destructors);
`;else for(var Z=dt?1:2;Z<se.length;++Z){var Le=Z===1?"thisWired":"arg"+(Z-2)+"Wired";se[Z].destructorFunction!==null&&(oe+=Le+"_dtor("+Le+"); // "+se[Z].name+`
`,De.push(Le+"_dtor"),Re.push(se[Z].destructorFunction))}te&&(oe+=`var ret = retType.fromWireType(rv);
return ret;
`),oe+=`}
`,De.push(oe);var Be=zo(Function,De).apply(null,Re);return Be}function us(le,se,_e,Ge,Ze,St){I(se>0);var dt=za(se,_e);Ze=Ma(Ge,Ze),hr([],[le],function(ct){ct=ct[0];var Z="constructor "+ct.name;if(ct.registeredClass.constructor_body===void 0&&(ct.registeredClass.constructor_body=[]),ct.registeredClass.constructor_body[se-1]!==void 0)throw new qt("Cannot register multiple constructors with identical number of parameters ("+(se-1)+") for class '"+ct.name+"'! Overload resolution is currently only performed using the parameter count, not actual type info!");return ct.registeredClass.constructor_body[se-1]=()=>{So("Cannot construct "+ct.name+" due to unbound types",dt)},hr([],dt,function(te){return te.splice(1,0,null),ct.registeredClass.constructor_body[se-1]=ql(Z,te,null,Ze,St),[]}),[]})}function Dr(le,se,_e,Ge,Ze,St,dt,ct){var Z=za(_e,Ge);se=Bt(se),St=Ma(Ze,St),hr([],[le],function(te){te=te[0];var W=te.name+"."+se;se.startsWith("@@")&&(se=Symbol[se.substring(2)]),ct&&te.registeredClass.pureVirtualFunctions.push(se);function K(){So("Cannot call "+W+" due to unbound types",Z)}var oe=te.registeredClass.instancePrototype,be=oe[se];return be===void 0||be.overloadTable===void 0&&be.className!==te.name&&be.argCount===_e-2?(K.argCount=_e-2,K.className=te.name,oe[se]=K):(Ga(oe,se,W),oe[se].overloadTable[_e-2]=K),hr([],Z,function(De){var Re=ql(W,De,te,St,dt);return oe[se].overloadTable===void 0?(Re.argCount=_e-2,oe[se]=Re):oe[se].overloadTable[_e-2]=Re,[]}),[]})}var ro=[],Or=[{},{value:void 0},{value:null},{value:!0},{value:!1}];function ci(le){le>4&&--Or[le].refcount===0&&(Or[le]=void 0,ro.push(le))}function fs(){for(var le=0,se=5;se<Or.length;++se)Or[se]!==void 0&&++le;return le}function ui(){for(var le=5;le<Or.length;++le)if(Or[le]!==void 0)return Or[le];return null}function Xl(){a.count_emval_handles=fs,a.get_first_emval=ui}var Ti={toValue:le=>(le||kt("Cannot use deleted val. handle = "+le),Or[le].value),toHandle:le=>{switch(le){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:{var se=ro.length?ro.pop():Or.length;return Or[se]={refcount:1,value:le},se}}}};function io(le,se){se=Bt(se),Zt(le,{name:se,fromWireType:function(_e){var Ge=Ti.toValue(_e);return ci(_e),Ge},toWireType:function(_e,Ge){return Ti.toHandle(Ge)},argPackAdvance:8,readValueFromPointer:ot,destructorFunction:null})}function ds(le){if(le===null)return"null";var se=typeof le;return se==="object"||se==="array"||se==="function"?le.toString():""+le}function To(le,se){switch(se){case 2:return function(_e){return this.fromWireType(ne[_e>>2])};case 3:return function(_e){return this.fromWireType(ye[_e>>3])};default:throw new TypeError("Unknown float type: "+le)}}function ga(le,se,_e){var Ge=Rt(_e);se=Bt(se),Zt(le,{name:se,fromWireType:function(Ze){return Ze},toWireType:function(Ze,St){return St},argPackAdvance:8,readValueFromPointer:To(se,Ge),destructorFunction:null})}function Ei(le,se,_e){switch(se){case 0:return _e?function(Ze){return $[Ze]}:function(Ze){return U[Ze]};case 1:return _e?function(Ze){return G[Ze>>1]}:function(Ze){return F[Ze>>1]};case 2:return _e?function(Ze){return J[Ze>>2]}:function(Ze){return Q[Ze>>2]};default:throw new TypeError("Unknown integer type: "+le)}}function Wo(le,se,_e,Ge,Ze){se=Bt(se);var St=Rt(_e),dt=K=>K;if(Ge===0){var ct=32-8*_e;dt=K=>K<<ct>>>ct}var Z=se.includes("unsigned"),te=(K,oe)=>{},W;Z?W=function(K,oe){return te(oe,this.name),oe>>>0}:W=function(K,oe){return te(oe,this.name),oe},Zt(le,{name:se,fromWireType:dt,toWireType:W,argPackAdvance:8,readValueFromPointer:Ei(se,St,Ge!==0),destructorFunction:null})}function hl(le,se,_e){var Ge=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],Ze=Ge[se];function St(dt){dt=dt>>2;var ct=Q,Z=ct[dt],te=ct[dt+1];return new Ze(V,te,Z)}_e=Bt(_e),Zt(le,{name:_e,fromWireType:St,argPackAdvance:8,readValueFromPointer:St},{ignoreDuplicateRegistrations:!0})}function hs(le,se){se=Bt(se);var _e=se==="std::string";Zt(le,{name:se,fromWireType:function(Ge){var Ze=Q[Ge>>2],St=Ge+4,dt;if(_e)for(var ct=St,Z=0;Z<=Ze;++Z){var te=St+Z;if(Z==Ze||U[te]==0){var W=te-ct,K=P(ct,W);dt===void 0?dt=K:(dt+="\0",dt+=K),ct=te+1}}else{for(var oe=new Array(Ze),Z=0;Z<Ze;++Z)oe[Z]=String.fromCharCode(U[St+Z]);dt=oe.join("")}return pt(Ge),dt},toWireType:function(Ge,Ze){Ze instanceof ArrayBuffer&&(Ze=new Uint8Array(Ze));var St,dt=typeof Ze=="string";dt||Ze instanceof Uint8Array||Ze instanceof Uint8ClampedArray||Ze instanceof Int8Array||kt("Cannot pass non-string to std::string"),_e&&dt?St=B(Ze):St=Ze.length;var ct=tt(4+St+1),Z=ct+4;if(Q[ct>>2]=St,_e&&dt)A(Ze,Z,St+1);else if(dt)for(var te=0;te<St;++te){var W=Ze.charCodeAt(te);W>255&&(pt(Z),kt("String has UTF-16 code units that do not fit in 8 bits")),U[Z+te]=W}else for(var te=0;te<St;++te)U[Z+te]=Ze[te];return Ge!==null&&Ge.push(pt,ct),ct},argPackAdvance:8,readValueFromPointer:ot,destructorFunction:function(Ge){pt(Ge)}})}var Ls=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0;function pl(le,se){for(var _e=le,Ge=_e>>1,Ze=Ge+se/2;!(Ge>=Ze)&&F[Ge];)++Ge;if(_e=Ge<<1,_e-le>32&&Ls)return Ls.decode(U.subarray(le,_e));for(var St="",dt=0;!(dt>=se/2);++dt){var ct=G[le+dt*2>>1];if(ct==0)break;St+=String.fromCharCode(ct)}return St}function ks(le,se,_e){if(_e===void 0&&(_e=2147483647),_e<2)return 0;_e-=2;for(var Ge=se,Ze=_e<le.length*2?_e/2:le.length,St=0;St<Ze;++St){var dt=le.charCodeAt(St);G[se>>1]=dt,se+=2}return G[se>>1]=0,se-Ge}function Vs(le){return le.length*2}function gl(le,se){for(var _e=0,Ge="";!(_e>=se/4);){var Ze=J[le+_e*4>>2];if(Ze==0)break;if(++_e,Ze>=65536){var St=Ze-65536;Ge+=String.fromCharCode(55296|St>>10,56320|St&1023)}else Ge+=String.fromCharCode(Ze)}return Ge}function Mc(le,se,_e){if(_e===void 0&&(_e=2147483647),_e<4)return 0;for(var Ge=se,Ze=Ge+_e-4,St=0;St<le.length;++St){var dt=le.charCodeAt(St);if(dt>=55296&&dt<=57343){var ct=le.charCodeAt(++St);dt=65536+((dt&1023)<<10)|ct&1023}if(J[se>>2]=dt,se+=4,se+4>Ze)break}return J[se>>2]=0,se-Ge}function Pu(le){for(var se=0,_e=0;_e<le.length;++_e){var Ge=le.charCodeAt(_e);Ge>=55296&&Ge<=57343&&++_e,se+=4}return se}function Au(le,se,_e){_e=Bt(_e);var Ge,Ze,St,dt,ct;se===2?(Ge=pl,Ze=ks,dt=Vs,St=()=>F,ct=1):se===4&&(Ge=gl,Ze=Mc,dt=Pu,St=()=>Q,ct=2),Zt(le,{name:_e,fromWireType:function(Z){for(var te=Q[Z>>2],W=St(),K,oe=Z+4,be=0;be<=te;++be){var De=Z+4+be*se;if(be==te||W[De>>ct]==0){var Re=De-oe,Le=Ge(oe,Re);K===void 0?K=Le:(K+="\0",K+=Le),oe=De+se}}return pt(Z),K},toWireType:function(Z,te){typeof te!="string"&&kt("Cannot pass non-string to C++ string type "+_e);var W=dt(te),K=tt(4+W+se);return Q[K>>2]=W>>ct,Ze(te,K+4,W+se),Z!==null&&Z.push(pt,K),K},argPackAdvance:8,readValueFromPointer:ot,destructorFunction:function(Z){pt(Z)}})}function Nu(le,se,_e,Ge,Ze,St){Qe[le]={name:Bt(se),rawConstructor:Ma(_e,Ge),rawDestructor:Ma(Ze,St),fields:[]}}function Yl(le,se,_e,Ge,Ze,St,dt,ct,Z,te){Qe[le].fields.push({fieldName:Bt(se),getterReturnType:_e,getter:Ma(Ge,Ze),getterContext:St,setterArgumentType:dt,setter:Ma(ct,Z),setterContext:te})}function Ic(le,se){se=Bt(se),Zt(le,{isVoid:!0,name:se,argPackAdvance:0,fromWireType:function(){},toWireType:function(_e,Ge){}})}var Lu={};function Rc(le){var se=Lu[le];return se===void 0?Bt(le):se}function Pc(){return typeof globalThis=="object"?globalThis:(function(){return Function})()("return this")()}function ku(le){return le===0?Ti.toHandle(Pc()):(le=Rc(le),Ti.toHandle(Pc()[le]))}function ml(le){le>4&&(Or[le].refcount+=1)}function Ac(le,se){var _e=Ue[le];return _e===void 0&&kt(se+" has unknown type "+cs(le)),_e}function Nc(le){for(var se="",_e=0;_e<le;++_e)se+=(_e!==0?", ":"")+"arg"+_e;for(var Ge=()=>Q,Ze="return function emval_allocator_"+le+`(constructor, argTypes, args) {
  var HEAPU32 = getMemory();
`,_e=0;_e<le;++_e)Ze+="var argType"+_e+" = requireRegisteredType(HEAPU32[((argTypes)>>2)], 'parameter "+_e+`');
var arg`+_e+" = argType"+_e+`.readValueFromPointer(args);
args += argType`+_e+`['argPackAdvance'];
argTypes += 4;
`;return Ze+="var obj = new constructor("+se+`);
return valueToHandle(obj);
}
`,new Function("requireRegisteredType","Module","valueToHandle","getMemory",Ze)(Ac,a,Ti.toHandle,Ge)}var Jl={};function Vu(le,se,_e,Ge){le=Ti.toValue(le);var Ze=Jl[se];return Ze||(Ze=Nc(se),Jl[se]=Ze),Ze(le,_e,Ge)}function vl(le,se){le=Ac(le,"_emval_take_value");var _e=le.readValueFromPointer(se);return Ti.toHandle(_e)}function Fu(){Ne("")}function Lc(){return 2147483648}function Uu(){return Lc()}function kc(le,se,_e){U.copyWithin(le,se,se+_e)}function Bu(le){try{return _.grow(le-V.byteLength+65535>>>16),ve(_.buffer),1}catch{}}function $u(le){var se=U.length;le=le>>>0;var _e=Lc();if(le>_e)return!1;let Ge=(Z,te)=>Z+(te-Z%te)%te;for(var Ze=1;Ze<=4;Ze*=2){var St=se*(1+.2/Ze);St=Math.min(St,le+100663296);var dt=Math.min(_e,Ge(Math.max(le,St),65536)),ct=Bu(dt);if(ct)return!0}return!1}var Zl={};function Ql(){return c||"./this.program"}function Ho(){if(!Ho.strings){var le=(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",se={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:le,_:Ql()};for(var _e in Zl)Zl[_e]===void 0?delete se[_e]:se[_e]=Zl[_e];var Ge=[];for(var _e in se)Ge.push(_e+"="+se[_e]);Ho.strings=Ge}return Ho.strings}function ps(le,se,_e){for(var Ge=0;Ge<le.length;++Ge)$[se++>>0]=le.charCodeAt(Ge);$[se>>0]=0}function ao(le,se){var _e=0;return Ho().forEach(function(Ge,Ze){var St=se+_e;Q[le+Ze*4>>2]=St,ps(Ge,St),_e+=Ge.length+1}),0}function Vc(le,se){var _e=Ho();Q[le>>2]=_e.length;var Ge=0;return _e.forEach(function(Ze){Ge+=Ze.length+1}),Q[se>>2]=Ge,0}function Fc(le){return 52}function Fs(le,se,_e,Ge,Ze){return 70}var gs=[null,[],[]];function yl(le,se){var _e=gs[le];se===0||se===10?((le===1?w:S)(O(_e,0)),_e.length=0):_e.push(se)}function ec(le,se,_e,Ge){for(var Ze=0,St=0;St<_e;St++){var dt=Q[se>>2],ct=Q[se+4>>2];se+=8;for(var Z=0;Z<ct;Z++)yl(le,U[dt+Z]);Ze+=ct}return Q[Ge>>2]=Ze,0}function pe(le){var se=a["_"+le];return se}function ge(le,se){$.set(le,se)}function Ie(le,se,_e,Ge,Ze){var St={string:De=>{var Re=0;if(De!=null&&De!==0){var Le=(De.length<<2)+1;Re=Vt(Le),A(De,Re,Le)}return Re},array:De=>{var Re=Vt(De.length);return ge(De,Re),Re}};function dt(De){return se==="string"?P(De):se==="boolean"?!!De:De}var ct=pe(le),Z=[],te=0;if(Ge)for(var W=0;W<Ge.length;W++){var K=St[_e[W]];K?(te===0&&(te=rt()),Z[W]=K(Ge[W])):Z[W]=Ge[W]}var oe=ct.apply(null,Z);function be(De){return te!==0&&xt(te),dt(De)}return oe=be(oe),oe}Pn=a.InternalError=en(Error,"InternalError"),Ft(),qt=a.BindingError=en(Error,"BindingError"),Hl(),As(),$i(),ji=a.UnboundTypeError=en(Error,"UnboundTypeError"),Xl();var We={D:Fe,e:Ke,t:Et,B:wr,r:ta,q:us,b:Dr,A:io,l:ga,d:Wo,a:hl,k:hs,f:Au,g:Nu,c:Yl,C:Ic,h:ci,o:ku,m:ml,n:Vu,p:vl,i:Fu,v:Uu,z:kc,u:$u,w:ao,x:Vc,y:Fc,s:Fs,j:ec};ue(),a.___wasm_call_ctors=function(){return(a.___wasm_call_ctors=a.asm.F).apply(null,arguments)};var tt=a._malloc=function(){return(tt=a._malloc=a.asm.H).apply(null,arguments)},pt=a._free=function(){return(pt=a._free=a.asm.I).apply(null,arguments)},gt=a.___getTypeName=function(){return(gt=a.___getTypeName=a.asm.J).apply(null,arguments)};a.__embind_initialize_bindings=function(){return(a.__embind_initialize_bindings=a.asm.K).apply(null,arguments)};var rt=a.stackSave=function(){return(rt=a.stackSave=a.asm.L).apply(null,arguments)},xt=a.stackRestore=function(){return(xt=a.stackRestore=a.asm.M).apply(null,arguments)},Vt=a.stackAlloc=function(){return(Vt=a.stackAlloc=a.asm.N).apply(null,arguments)},Ht=a.___cxa_is_pointer_type=function(){return(Ht=a.___cxa_is_pointer_type=a.asm.O).apply(null,arguments)};a.dynCall_iji=function(){return(a.dynCall_iji=a.asm.P).apply(null,arguments)},a.dynCall_jji=function(){return(a.dynCall_jji=a.asm.Q).apply(null,arguments)},a.dynCall_iiji=function(){return(a.dynCall_iiji=a.asm.R).apply(null,arguments)},a.dynCall_jiji=function(){return(a.dynCall_jiji=a.asm.S).apply(null,arguments)},a.ccall=Ie;var Qt;Ee=function le(){Qt||cn(),Qt||(Ee=le)};function cn(le){if(he>0||(q(),he>0))return;function se(){Qt||(Qt=!0,a.calledRun=!0,!D&&(k(),o(a),a.onRuntimeInitialized&&a.onRuntimeInitialized(),Y()))}a.setStatus?(a.setStatus("Running..."),setTimeout(function(){setTimeout(function(){a.setStatus("")},1),se()},1)):se()}if(a.preInit)for(typeof a.preInit=="function"&&(a.preInit=[a.preInit]);a.preInit.length>0;)a.preInit.pop()();return cn(),i.ready})})();t.exports=n})(Y8)),Y8.exports}var GWe=$We();const jWe=sl(GWe),zWe=new URL("/assets/openjpegwasm_decode-C4nnCcr6.wasm",import.meta.url),zv={codec:void 0,decoder:void 0,decodeConfig:{}};function WWe(t){if(zv.decodeConfig=t,zv.codec)return Promise.resolve();const e=jWe({locateFile:n=>n.endsWith(".wasm")?zWe.toString():n});return new Promise((n,r)=>{e.then(i=>{zv.codec=i,zv.decoder=new i.J2KDecoder,n()},r)})}async function UB(t,e){await WWe();const n=zv.decoder,r=n.getEncodedBuffer(t.length);r.set(t),n.decode();const i=n.getFrameInfo(),a=n.getDecodedBuffer();new Uint8Array(a.length).set(a);const s=`x: ${n.getImageOffset().x}, y: ${n.getImageOffset().y}`,l=n.getNumDecompositions(),c=n.getNumLayers(),f=["unknown","LRCP","RLCP","RPCL","PCRL","CPRL"][n.getProgressionOrder()+1],u=n.getIsReversible(),d=`${n.getBlockDimensions().width} x ${n.getBlockDimensions().height}`,h=`${n.getTileSize().width} x ${n.getTileSize().height}`,p=`${n.getTileOffset().x}, ${n.getTileOffset().y}`,g=n.getColorSpace(),m=`${a.length.toLocaleString()} bytes`,y=`${(a.length/r.length).toFixed(2)}:1`,v={columns:i.width,rows:i.height,bitsPerPixel:i.bitsPerSample,signed:i.isSigned,bytesPerPixel:e.bytesPerPixel,componentsPerPixel:i.componentCount},x=HWe(i,a),w={imageOffset:s,numDecompositions:l,numLayers:c,progessionOrder:f,reversible:u,blockDimensions:d,tileSize:h,tileOffset:p,colorTransform:g,decodedSize:m,compressionRatio:y};return{...e,pixelData:x,imageInfo:v,encodeOptions:w,...w,...v}}function HWe(t,e){return t.bitsPerSample>8?t.isSigned?new Int16Array(e.buffer,e.byteOffset,e.byteLength/2):new Uint16Array(e.buffer,e.byteOffset,e.byteLength/2):t.isSigned?new Int8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}var J8={exports:{}},BB;function KWe(){return BB||(BB=1,(function(t,e){var n=(()=>{var r=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename<"u"&&(r=r||__filename),(function(a){a=a||{};var a=typeof a<"u"?a:{},o,s;a.ready=new Promise(function(Z,te){o=Z,s=te});var l=Object.assign({},a),c=typeof window=="object",f=typeof importScripts=="function",u=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",d="";function h(Z){return a.locateFile?a.locateFile(Z,d):d+Z}var p,g,m;if(u){var y=Ff,v=Ff;f?d=v.dirname(d)+"/":d=__dirname+"/",p=(Z,te)=>(Z=ae(Z)?new URL(Z):v.normalize(Z),y.readFileSync(Z,te?void 0:"utf8")),m=Z=>{var te=p(Z,!0);return te.buffer||(te=new Uint8Array(te)),te},g=(Z,te,W)=>{Z=ae(Z)?new URL(Z):v.normalize(Z),y.readFile(Z,function(K,oe){K?W(K):te(oe.buffer)})},process.argv.length>1&&process.argv[1].replace(/\\/g,"/"),process.argv.slice(2),process.on("uncaughtException",function(Z){if(!(Z instanceof ue))throw Z}),process.on("unhandledRejection",function(Z){throw Z}),a.inspect=function(){return"[Emscripten Module object]"}}else(c||f)&&(f?d=self.location.href:typeof document<"u"&&document.currentScript&&(d=document.currentScript.src),r&&(d=r),d.indexOf("blob:")!==0?d=d.substr(0,d.replace(/[?#].*/,"").lastIndexOf("/")+1):d="",p=Z=>{var te=new XMLHttpRequest;return te.open("GET",Z,!1),te.send(null),te.responseText},f&&(m=Z=>{var te=new XMLHttpRequest;return te.open("GET",Z,!1),te.responseType="arraybuffer",te.send(null),new Uint8Array(te.response)}),g=(Z,te,W)=>{var K=new XMLHttpRequest;K.open("GET",Z,!0),K.responseType="arraybuffer",K.onload=()=>{if(K.status==200||K.status==0&&K.response){te(K.response);return}W()},K.onerror=W,K.send(null)});var x=a.print||console.log.bind(console),w=a.printErr||console.warn.bind(console);Object.assign(a,l),l=null,a.arguments&&a.arguments,a.thisProgram&&a.thisProgram,a.quit&&a.quit;var S;a.wasmBinary&&(S=a.wasmBinary),a.noExitRuntime,typeof WebAssembly!="object"&&Pe("no native wasm support detected");var T,_=!1;function D(Z,te){Z||Pe(te)}var I=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function R(Z,te,W){for(var K=te+W,oe=te;Z[oe]&&!(oe>=K);)++oe;if(oe-te>16&&Z.buffer&&I)return I.decode(Z.subarray(te,oe));for(var be="";te<oe;){var De=Z[te++];if(!(De&128)){be+=String.fromCharCode(De);continue}var Re=Z[te++]&63;if((De&224)==192){be+=String.fromCharCode((De&31)<<6|Re);continue}var Le=Z[te++]&63;if((De&240)==224?De=(De&15)<<12|Re<<6|Le:De=(De&7)<<18|Re<<12|Le<<6|Z[te++]&63,De<65536)be+=String.fromCharCode(De);else{var Be=De-65536;be+=String.fromCharCode(55296|Be>>10,56320|Be&1023)}}return be}function O(Z,te){return Z?R($,Z,te):""}function P(Z,te,W,K){if(!(K>0))return 0;for(var oe=W,be=W+K-1,De=0;De<Z.length;++De){var Re=Z.charCodeAt(De);if(Re>=55296&&Re<=57343){var Le=Z.charCodeAt(++De);Re=65536+((Re&1023)<<10)|Le&1023}if(Re<=127){if(W>=be)break;te[W++]=Re}else if(Re<=2047){if(W+1>=be)break;te[W++]=192|Re>>6,te[W++]=128|Re&63}else if(Re<=65535){if(W+2>=be)break;te[W++]=224|Re>>12,te[W++]=128|Re>>6&63,te[W++]=128|Re&63}else{if(W+3>=be)break;te[W++]=240|Re>>18,te[W++]=128|Re>>12&63,te[W++]=128|Re>>6&63,te[W++]=128|Re&63}}return te[W]=0,W-oe}function N(Z,te,W){return P(Z,$,te,W)}function A(Z){for(var te=0,W=0;W<Z.length;++W){var K=Z.charCodeAt(W);K<=127?te++:K<=2047?te+=2:K>=55296&&K<=57343?(te+=4,++W):te+=3}return te}var B,V,$,U,G,F,J,Q,ne;function ye(Z){B=Z,a.HEAP8=V=new Int8Array(Z),a.HEAP16=U=new Int16Array(Z),a.HEAP32=F=new Int32Array(Z),a.HEAPU8=$=new Uint8Array(Z),a.HEAPU16=G=new Uint16Array(Z),a.HEAPU32=J=new Uint32Array(Z),a.HEAPF32=Q=new Float32Array(Z),a.HEAPF64=ne=new Float64Array(Z)}a.INITIAL_MEMORY;var ve,Ce=[],we=[],Ae=[];function Me(){if(a.preRun)for(typeof a.preRun=="function"&&(a.preRun=[a.preRun]);a.preRun.length;)Y(a.preRun.shift());ut(Ce)}function q(){ut(we)}function k(){if(a.postRun)for(typeof a.postRun=="function"&&(a.postRun=[a.postRun]);a.postRun.length;)re(a.postRun.shift());ut(Ae)}function Y(Z){Ce.unshift(Z)}function X(Z){we.unshift(Z)}function re(Z){Ae.unshift(Z)}var de=0,he=null;function Ee(Z){de++,a.monitorRunDependencies&&a.monitorRunDependencies(de)}function Oe(Z){if(de--,a.monitorRunDependencies&&a.monitorRunDependencies(de),de==0&&he){var te=he;he=null,te()}}function Pe(Z){a.onAbort&&a.onAbort(Z),Z="Aborted("+Z+")",w(Z),_=!0,Z+=". Build with -sASSERTIONS for more info.";var te=new WebAssembly.RuntimeError(Z);throw s(te),te}var Ne="data:application/octet-stream;base64,";function ie(Z){return Z.startsWith(Ne)}function ae(Z){return Z.startsWith("file://")}var Te;Te="openjphjs.wasm",ie(Te)||(Te=h(Te));function me(Z){try{if(Z==Te&&S)return new Uint8Array(S);if(m)return m(Z);throw"both async and sync fetching of the wasm failed"}catch(te){Pe(te)}}function Se(){if(!S&&(c||f)){if(typeof fetch=="function"&&!ae(Te))return fetch(Te,{credentials:"same-origin"}).then(function(Z){if(!Z.ok)throw"failed to load wasm binary file at '"+Te+"'";return Z.arrayBuffer()}).catch(function(){return me(Te)});if(g)return new Promise(function(Z,te){g(Te,function(W){Z(new Uint8Array(W))},te)})}return Promise.resolve().then(function(){return me(Te)})}function Ve(){var Z={env:pe,wasi_snapshot_preview1:pe};function te(De,Re){var Le=De.exports;a.asm=Le,T=a.asm.memory,ye(T.buffer),ve=a.asm.__indirect_function_table,X(a.asm.__wasm_call_ctors),Oe()}Ee();function W(De){te(De.instance)}function K(De){return Se().then(function(Re){return WebAssembly.instantiate(Re,Z)}).then(function(Re){return Re}).then(De,function(Re){w("failed to asynchronously prepare wasm: "+Re),Pe(Re)})}function oe(){return!S&&typeof WebAssembly.instantiateStreaming=="function"&&!ie(Te)&&!ae(Te)&&!u&&typeof fetch=="function"?fetch(Te,{credentials:"same-origin"}).then(function(De){var Re=WebAssembly.instantiateStreaming(De,Z);return Re.then(W,function(Le){return w("wasm streaming compile failed: "+Le),w("falling back to ArrayBuffer instantiation"),K(W)})}):K(W)}if(a.instantiateWasm)try{var be=a.instantiateWasm(Z,te);return be}catch(De){w("Module.instantiateWasm callback failed with error: "+De),s(De)}return oe().catch(s),{}}function ue(Z){this.name="ExitStatus",this.message="Program terminated with exit("+Z+")",this.status=Z}function ut(Z){for(;Z.length>0;)Z.shift()(a)}function ht(Z,te,W,K){Pe("Assertion failed: "+O(Z)+", at: "+[te?O(te):"unknown filename",W,K?O(K):"unknown function"])}var Ot=[];function Fe(Z){Z.add_ref()}function Qe(Z){var te=new Ct(Z);return te.get_caught()||te.set_caught(!0),te.set_rethrown(!1),Ot.push(te),Fe(te),te.get_exception_ptr()}var st=0,ot=[];function Mt(Z){var te=ot[Z];return te||(Z>=ot.length&&(ot.length=Z+1),ot[Z]=te=ve.get(Z)),te}function Ue(Z){if(Z.release_ref()&&!Z.get_rethrown()){var te=Z.get_destructor();te&&Mt(te)(Z.excPtr),We(Z.excPtr)}}function He(){_setThrew(0);var Z=Ot.pop();Ue(Z),st=0}function Ct(Z){this.excPtr=Z,this.ptr=Z-24,this.set_type=function(te){J[this.ptr+4>>2]=te},this.get_type=function(){return J[this.ptr+4>>2]},this.set_destructor=function(te){J[this.ptr+8>>2]=te},this.get_destructor=function(){return J[this.ptr+8>>2]},this.set_refcount=function(te){F[this.ptr>>2]=te},this.set_caught=function(te){te=te?1:0,V[this.ptr+12>>0]=te},this.get_caught=function(){return V[this.ptr+12>>0]!=0},this.set_rethrown=function(te){te=te?1:0,V[this.ptr+13>>0]=te},this.get_rethrown=function(){return V[this.ptr+13>>0]!=0},this.init=function(te,W){this.set_adjusted_ptr(0),this.set_type(te),this.set_destructor(W),this.set_refcount(0),this.set_caught(!1),this.set_rethrown(!1)},this.add_ref=function(){var te=F[this.ptr>>2];F[this.ptr>>2]=te+1},this.release_ref=function(){var te=F[this.ptr>>2];return F[this.ptr>>2]=te-1,te===1},this.set_adjusted_ptr=function(te){J[this.ptr+16>>2]=te},this.get_adjusted_ptr=function(){return J[this.ptr+16>>2]},this.get_exception_ptr=function(){var te=Ht(this.get_type());if(te)return J[this.excPtr>>2];var W=this.get_adjusted_ptr();return W!==0?W:this.excPtr}}function $t(Z){throw st||(st=Z),Z}function bn(){var Z=st;if(!Z)return pt(0),0;var te=new Ct(Z);te.set_adjusted_ptr(Z);var W=te.get_type();if(!W)return pt(0),Z;for(var K=0;K<arguments.length;K++){var oe=arguments[K];if(oe===0||oe===W)break;var be=te.ptr+16;if(Vt(oe,W,be))return pt(oe),Z}return pt(W),Z}function Tn(){var Z=st;if(!Z)return pt(0),0;var te=new Ct(Z);te.set_adjusted_ptr(Z);var W=te.get_type();if(!W)return pt(0),Z;for(var K=0;K<arguments.length;K++){var oe=arguments[K];if(oe===0||oe===W)break;var be=te.ptr+16;if(Vt(oe,W,be))return pt(oe),Z}return pt(W),Z}function en(Z,te,W){var K=new Ct(Z);throw K.init(te,W),st=Z,Z}var Pn={};function mi(Z){for(;Z.length;){var te=Z.pop(),W=Z.pop();W(te)}}function hr(Z){return this.fromWireType(F[Z>>2])}var Ke={},Et={},Rt={},Ft=48,Dn=57;function Bt(Z){if(Z===void 0)return"_unknown";Z=Z.replace(/[^a-zA-Z0-9_]/g,"$");var te=Z.charCodeAt(0);return te>=Ft&&te<=Dn?"_"+Z:Z}function qt(Z,te){return Z=Bt(Z),new Function("body","return function "+Z+`() {
    "use strict";    return body.apply(this, arguments);
};
`)(te)}function kt(Z,te){var W=qt(te,function(K){this.name=te,this.message=K;var oe=new Error(K).stack;oe!==void 0&&(this.stack=this.toString()+`
`+oe.replace(/^Error(:[^\n]*)?\n/,""))});return W.prototype=Object.create(Z.prototype),W.prototype.constructor=W,W.prototype.toString=function(){return this.message===void 0?this.name:this.name+": "+this.message},W}var Zt=void 0;function wr(Z){throw new Zt(Z)}function $r(Z,te,W){Z.forEach(function(Re){Rt[Re]=te});function K(Re){var Le=W(Re);Le.length!==Z.length&&wr("Mismatched type converter count");for(var Be=0;Be<Z.length;++Be)si(Z[Be],Le[Be])}var oe=new Array(te.length),be=[],De=0;te.forEach((Re,Le)=>{Et.hasOwnProperty(Re)?oe[Le]=Et[Re]:(be.push(Re),Ke.hasOwnProperty(Re)||(Ke[Re]=[]),Ke[Re].push(()=>{oe[Le]=Et[Re],++De,De===be.length&&K(oe)}))}),be.length===0&&K(oe)}function oi(Z){var te=Pn[Z];delete Pn[Z];var W=te.rawConstructor,K=te.rawDestructor,oe=te.fields,be=oe.map(De=>De.getterReturnType).concat(oe.map(De=>De.setterArgumentType));$r([Z],be,De=>{var Re={};return oe.forEach((Le,Be)=>{var qe=Le.fieldName,ft=De[Be],At=Le.getter,Wt=Le.getterContext,Gt=De[Be+oe.length],dn=Le.setter,pn=Le.setterContext;Re[qe]={read:er=>ft.fromWireType(At(Wt,er)),write:(er,Vr)=>{var Hr=[];dn(pn,er,Gt.toWireType(Hr,Vr)),mi(Hr)}}}),[{name:te.name,fromWireType:function(Le){var Be={};for(var qe in Re)Be[qe]=Re[qe].read(Le);return K(Le),Be},toWireType:function(Le,Be){for(var qe in Re)if(!(qe in Be))throw new TypeError('Missing field:  "'+qe+'"');var ft=W();for(qe in Re)Re[qe].write(ft,Be[qe]);return Le!==null&&Le.push(K,ft),ft},argPackAdvance:8,readValueFromPointer:hr,destructorFunction:K}]})}function Li(Z,te,W,K,oe){}function vi(Z){switch(Z){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+Z)}}function ki(){for(var Z=new Array(256),te=0;te<256;++te)Z[te]=String.fromCharCode(te);nn=Z}var nn=void 0;function Yn(Z){for(var te="",W=Z;$[W];)te+=nn[$[W++]];return te}var Si=void 0;function rn(Z){throw new Si(Z)}function si(Z,te,W={}){if(!("argPackAdvance"in te))throw new TypeError("registerType registeredInstance requires argPackAdvance");var K=te.name;if(Z||rn('type "'+K+'" must have a positive integer typeid pointer'),Et.hasOwnProperty(Z)){if(W.ignoreDuplicateRegistrations)return;rn("Cannot register type '"+K+"' twice")}if(Et[Z]=te,delete Rt[Z],Ke.hasOwnProperty(Z)){var oe=Ke[Z];delete Ke[Z],oe.forEach(be=>be())}}function os(Z,te,W,K,oe){var be=vi(W);te=Yn(te),si(Z,{name:te,fromWireType:function(De){return!!De},toWireType:function(De,Re){return Re?K:oe},argPackAdvance:8,readValueFromPointer:function(De){var Re;if(W===1)Re=V;else if(W===2)Re=U;else if(W===4)Re=F;else throw new TypeError("Unknown boolean type size: "+te);return this.fromWireType(Re[De>>be])},destructorFunction:null})}function li(Z){if(!(this instanceof $i)||!(Z instanceof $i))return!1;for(var te=this.$$.ptrType.registeredClass,W=this.$$.ptr,K=Z.$$.ptrType.registeredClass,oe=Z.$$.ptr;te.baseClass;)W=te.upcast(W),te=te.baseClass;for(;K.baseClass;)oe=K.upcast(oe),K=K.baseClass;return te===K&&W===oe}function Vi(Z){return{count:Z.count,deleteScheduled:Z.deleteScheduled,preservePointerOnDelete:Z.preservePointerOnDelete,ptr:Z.ptr,ptrType:Z.ptrType,smartPtr:Z.smartPtr,smartPtrType:Z.smartPtrType}}function _a(Z){function te(W){return W.$$.ptrType.registeredClass.name}rn(te(Z)+" instance already deleted")}var Fi=!1;function As(Z){}function Uo(Z){Z.smartPtr?Z.smartPtrType.rawDestructor(Z.smartPtr):Z.ptrType.registeredClass.rawDestructor(Z.ptr)}function Ui(Z){Z.count.value-=1;var te=Z.count.value===0;te&&Uo(Z)}function Bo(Z,te,W){if(te===W)return Z;if(W.baseClass===void 0)return null;var K=Bo(Z,te,W.baseClass);return K===null?null:W.downcast(K)}var Pt={};function Bi(){return Object.keys(vr).length}function no(){var Z=[];for(var te in vr)vr.hasOwnProperty(te)&&Z.push(vr[te]);return Z}var yi=[];function Ns(){for(;yi.length;){var Z=yi.pop();Z.$$.deleteScheduled=!1,Z.delete()}}var $o=void 0;function Co(Z){$o=Z,yi.length&&$o&&$o(Ns)}function Hl(){a.getInheritedInstanceCount=Bi,a.getLiveInheritedInstances=no,a.flushPendingDeletes=Ns,a.setDelayFunction=Co}var vr={};function Ga(Z,te){for(te===void 0&&rn("ptr should not be undefined");Z.baseClass;)te=Z.upcast(te),Z=Z.baseClass;return te}function ul(Z,te){return te=Ga(Z,te),vr[te]}function Go(Z,te){(!te.ptrType||!te.ptr)&&wr("makeClassHandle requires ptr and ptrType");var W=!!te.smartPtrType,K=!!te.smartPtr;return W!==K&&wr("Both smartPtrType and smartPtr must be specified"),te.count={value:1},ja(Object.create(Z,{$$:{value:te}}))}function fl(Z){var te=this.getPointee(Z);if(!te)return this.destructor(Z),null;var W=ul(this.registeredClass,te);if(W!==void 0){if(W.$$.count.value===0)return W.$$.ptr=te,W.$$.smartPtr=Z,W.clone();var K=W.clone();return this.destructor(Z),K}function oe(){return this.isSmartPointer?Go(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:te,smartPtrType:this,smartPtr:Z}):Go(this.registeredClass.instancePrototype,{ptrType:this,ptr:Z})}var be=this.registeredClass.getActualType(te),De=Pt[be];if(!De)return oe.call(this);var Re;this.isConst?Re=De.constPointerType:Re=De.pointerType;var Le=Bo(te,this.registeredClass,Re.registeredClass);return Le===null?oe.call(this):this.isSmartPointer?Go(Re.registeredClass.instancePrototype,{ptrType:Re,ptr:Le,smartPtrType:this,smartPtr:Z}):Go(Re.registeredClass.instancePrototype,{ptrType:Re,ptr:Le})}function ja(Z){return typeof FinalizationRegistry>"u"?(ja=te=>te,Z):(Fi=new FinalizationRegistry(te=>{Ui(te.$$)}),ja=te=>{var W=te.$$,K=!!W.smartPtr;if(K){var oe={$$:W};Fi.register(te,oe,te)}return te},As=te=>Fi.unregister(te),ja(Z))}function Ru(){if(this.$$.ptr||_a(this),this.$$.preservePointerOnDelete)return this.$$.count.value+=1,this;var Z=ja(Object.create(Object.getPrototypeOf(this),{$$:{value:Vi(this.$$)}}));return Z.$$.count.value+=1,Z.$$.deleteScheduled=!1,Z}function pa(){this.$$.ptr||_a(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&rn("Object already scheduled for deletion"),As(this),Ui(this.$$),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)}function Kl(){return!this.$$.ptr}function Oc(){return this.$$.ptr||_a(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&rn("Object already scheduled for deletion"),yi.push(this),yi.length===1&&$o&&$o(Ns),this.$$.deleteScheduled=!0,this}function Da(){$i.prototype.isAliasOf=li,$i.prototype.clone=Ru,$i.prototype.delete=pa,$i.prototype.isDeleted=Kl,$i.prototype.deleteLater=Oc}function $i(){}function Oa(Z,te,W){if(Z[te].overloadTable===void 0){var K=Z[te];Z[te]=function(){return Z[te].overloadTable.hasOwnProperty(arguments.length)||rn("Function '"+W+"' called with an invalid number of arguments ("+arguments.length+") - expects one of ("+Z[te].overloadTable+")!"),Z[te].overloadTable[arguments.length].apply(this,arguments)},Z[te].overloadTable=[],Z[te].overloadTable[K.argCount]=K}}function Gi(Z,te,W){a.hasOwnProperty(Z)?((W===void 0||a[Z].overloadTable!==void 0&&a[Z].overloadTable[W]!==void 0)&&rn("Cannot register public name '"+Z+"' twice"),Oa(a,Z,Z),a.hasOwnProperty(W)&&rn("Cannot register multiple overloads of a function with the same number of arguments ("+W+")!"),a[Z].overloadTable[W]=te):(a[Z]=te,W!==void 0&&(a[Z].numArguments=W))}function jo(Z,te,W,K,oe,be,De,Re){this.name=Z,this.constructor=te,this.instancePrototype=W,this.rawDestructor=K,this.baseClass=oe,this.getActualType=be,this.upcast=De,this.downcast=Re,this.pureVirtualFunctions=[]}function ss(Z,te,W){for(;te!==W;)te.upcast||rn("Expected null or instance of "+W.name+", got an instance of "+te.name),Z=te.upcast(Z),te=te.baseClass;return Z}function ls(Z,te){if(te===null)return this.isReference&&rn("null is not a valid "+this.name),0;te.$$||rn('Cannot pass "'+ks(te)+'" as a '+this.name),te.$$.ptr||rn("Cannot pass deleted object as a pointer of type "+this.name);var W=te.$$.ptrType.registeredClass,K=ss(te.$$.ptr,W,this.registeredClass);return K}function Jr(Z,te){var W;if(te===null)return this.isReference&&rn("null is not a valid "+this.name),this.isSmartPointer?(W=this.rawConstructor(),Z!==null&&Z.push(this.rawDestructor,W),W):0;te.$$||rn('Cannot pass "'+ks(te)+'" as a '+this.name),te.$$.ptr||rn("Cannot pass deleted object as a pointer of type "+this.name),!this.isConst&&te.$$.ptrType.isConst&&rn("Cannot convert argument of type "+(te.$$.smartPtrType?te.$$.smartPtrType.name:te.$$.ptrType.name)+" to parameter type "+this.name);var K=te.$$.ptrType.registeredClass;if(W=ss(te.$$.ptr,K,this.registeredClass),this.isSmartPointer)switch(te.$$.smartPtr===void 0&&rn("Passing raw pointer to smart pointer is illegal"),this.sharingPolicy){case 0:te.$$.smartPtrType===this?W=te.$$.smartPtr:rn("Cannot convert argument of type "+(te.$$.smartPtrType?te.$$.smartPtrType.name:te.$$.ptrType.name)+" to parameter type "+this.name);break;case 1:W=te.$$.smartPtr;break;case 2:if(te.$$.smartPtrType===this)W=te.$$.smartPtr;else{var oe=te.clone();W=this.rawShare(W,Ls.toHandle(function(){oe.delete()})),Z!==null&&Z.push(this.rawDestructor,W)}break;default:rn("Unsupporting sharing policy")}return W}function dl(Z,te){if(te===null)return this.isReference&&rn("null is not a valid "+this.name),0;te.$$||rn('Cannot pass "'+ks(te)+'" as a '+this.name),te.$$.ptr||rn("Cannot pass deleted object as a pointer of type "+this.name),te.$$.ptrType.isConst&&rn("Cannot convert argument of type "+te.$$.ptrType.name+" to parameter type "+this.name);var W=te.$$.ptrType.registeredClass,K=ss(te.$$.ptr,W,this.registeredClass);return K}function Ma(Z){return this.rawGetPointee&&(Z=this.rawGetPointee(Z)),Z}function ji(Z){this.rawDestructor&&this.rawDestructor(Z)}function cs(Z){Z!==null&&Z.delete()}function So(){ta.prototype.getPointee=Ma,ta.prototype.destructor=ji,ta.prototype.argPackAdvance=8,ta.prototype.readValueFromPointer=hr,ta.prototype.deleteObject=cs,ta.prototype.fromWireType=fl}function ta(Z,te,W,K,oe,be,De,Re,Le,Be,qe){this.name=Z,this.registeredClass=te,this.isReference=W,this.isConst=K,this.isSmartPointer=oe,this.pointeeType=be,this.sharingPolicy=De,this.rawGetPointee=Re,this.rawConstructor=Le,this.rawShare=Be,this.rawDestructor=qe,!oe&&te.baseClass===void 0?K?(this.toWireType=ls,this.destructorFunction=null):(this.toWireType=dl,this.destructorFunction=null):this.toWireType=Jr}function za(Z,te,W){a.hasOwnProperty(Z)||wr("Replacing nonexistant public symbol"),a[Z].overloadTable!==void 0&&W!==void 0?a[Z].overloadTable[W]=te:(a[Z]=te,a[Z].argCount=W)}function zo(Z,te,W){var K=a["dynCall_"+Z];return W&&W.length?K.apply(null,[te].concat(W)):K.call(null,te)}function ql(Z,te,W){if(Z.includes("j"))return zo(Z,te,W);var K=Mt(te).apply(null,W);return K}function us(Z,te){var W=[];return function(){return W.length=0,Object.assign(W,arguments),ql(Z,te,W)}}function Dr(Z,te){Z=Yn(Z);function W(){return Z.includes("j")?us(Z,te):Mt(te)}var K=W();return typeof K!="function"&&rn("unknown function pointer with signature "+Z+": "+te),K}var ro=void 0;function Or(Z){var te=tt(Z),W=Yn(te);return Ie(te),W}function ci(Z,te){var W=[],K={};function oe(be){if(!K[be]&&!Et[be]){if(Rt[be]){Rt[be].forEach(oe);return}W.push(be),K[be]=!0}}throw te.forEach(oe),new ro(Z+": "+W.map(Or).join([", "]))}function fs(Z,te,W,K,oe,be,De,Re,Le,Be,qe,ft,At){qe=Yn(qe),be=Dr(oe,be),Re&&(Re=Dr(De,Re)),Be&&(Be=Dr(Le,Be)),At=Dr(ft,At);var Wt=Bt(qe);Gi(Wt,function(){ci("Cannot construct "+qe+" due to unbound types",[K])}),$r([Z,te,W],K?[K]:[],function(Gt){Gt=Gt[0];var dn,pn;K?(dn=Gt.registeredClass,pn=dn.instancePrototype):pn=$i.prototype;var er=qt(Wt,function(){if(Object.getPrototypeOf(this)!==Vr)throw new Si("Use 'new' to construct "+qe);if(Hr.constructor_body===void 0)throw new Si(qe+" has no accessible constructor");var Hf=Hr.constructor_body[arguments.length];if(Hf===void 0)throw new Si("Tried to invoke ctor of "+qe+" with invalid number of parameters ("+arguments.length+") - expected ("+Object.keys(Hr.constructor_body).toString()+") parameters instead!");return Hf.apply(this,arguments)}),Vr=Object.create(pn,{constructor:{value:er}});er.prototype=Vr;var Hr=new jo(qe,er,Vr,At,dn,be,Re,Be),tc=new ta(qe,Hr,!0,!1,!1),Ko=new ta(qe+"*",Hr,!1,!1,!1),xl=new ta(qe+" const*",Hr,!1,!0,!1);return Pt[Z]={pointerType:Ko,constPointerType:xl},za(Wt,er),[tc,Ko,xl]})}function ui(Z,te){for(var W=[],K=0;K<Z;K++)W.push(J[te+K*4>>2]);return W}function Xl(Z,te){if(!(Z instanceof Function))throw new TypeError("new_ called with constructor type "+typeof Z+" which is not a function");var W=qt(Z.name||"unknownFunctionName",function(){});W.prototype=Z.prototype;var K=new W,oe=Z.apply(K,te);return oe instanceof Object?oe:K}function Ti(Z,te,W,K,oe){var be=te.length;be<2&&rn("argTypes array size mismatch! Must at least get return value and 'this' types!");for(var De=te[1]!==null&&W!==null,Re=!1,Le=1;Le<te.length;++Le)if(te[Le]!==null&&te[Le].destructorFunction===void 0){Re=!0;break}for(var Be=te[0].name!=="void",qe="",ft="",Le=0;Le<be-2;++Le)qe+=(Le!==0?", ":"")+"arg"+Le,ft+=(Le!==0?", ":"")+"arg"+Le+"Wired";var At="return function "+Bt(Z)+"("+qe+`) {
if (arguments.length !== `+(be-2)+`) {
throwBindingError('function `+Z+" called with ' + arguments.length + ' arguments, expected "+(be-2)+` args!');
}
`;Re&&(At+=`var destructors = [];
`);var Wt=Re?"destructors":"null",Gt=["throwBindingError","invoker","fn","runDestructors","retType","classParam"],dn=[rn,K,oe,mi,te[0],te[1]];De&&(At+="var thisWired = classParam.toWireType("+Wt+`, this);
`);for(var Le=0;Le<be-2;++Le)At+="var arg"+Le+"Wired = argType"+Le+".toWireType("+Wt+", arg"+Le+"); // "+te[Le+2].name+`
`,Gt.push("argType"+Le),dn.push(te[Le+2]);if(De&&(ft="thisWired"+(ft.length>0?", ":"")+ft),At+=(Be?"var rv = ":"")+"invoker(fn"+(ft.length>0?", ":"")+ft+`);
`,Re)At+=`runDestructors(destructors);
`;else for(var Le=De?1:2;Le<te.length;++Le){var pn=Le===1?"thisWired":"arg"+(Le-2)+"Wired";te[Le].destructorFunction!==null&&(At+=pn+"_dtor("+pn+"); // "+te[Le].name+`
`,Gt.push(pn+"_dtor"),dn.push(te[Le].destructorFunction))}Be&&(At+=`var ret = retType.fromWireType(rv);
return ret;
`),At+=`}
`,Gt.push(At);var er=Xl(Function,Gt).apply(null,dn);return er}function io(Z,te,W,K,oe,be){D(te>0);var De=ui(te,W);oe=Dr(K,oe),$r([],[Z],function(Re){Re=Re[0];var Le="constructor "+Re.name;if(Re.registeredClass.constructor_body===void 0&&(Re.registeredClass.constructor_body=[]),Re.registeredClass.constructor_body[te-1]!==void 0)throw new Si("Cannot register multiple constructors with identical number of parameters ("+(te-1)+") for class '"+Re.name+"'! Overload resolution is currently only performed using the parameter count, not actual type info!");return Re.registeredClass.constructor_body[te-1]=()=>{ci("Cannot construct "+Re.name+" due to unbound types",De)},$r([],De,function(Be){return Be.splice(1,0,null),Re.registeredClass.constructor_body[te-1]=Ti(Le,Be,null,oe,be),[]}),[]})}function ds(Z,te,W,K,oe,be,De,Re){var Le=ui(W,K);te=Yn(te),be=Dr(oe,be),$r([],[Z],function(Be){Be=Be[0];var qe=Be.name+"."+te;te.startsWith("@@")&&(te=Symbol[te.substring(2)]),Re&&Be.registeredClass.pureVirtualFunctions.push(te);function ft(){ci("Cannot call "+qe+" due to unbound types",Le)}var At=Be.registeredClass.instancePrototype,Wt=At[te];return Wt===void 0||Wt.overloadTable===void 0&&Wt.className!==Be.name&&Wt.argCount===W-2?(ft.argCount=W-2,ft.className=Be.name,At[te]=ft):(Oa(At,te,qe),At[te].overloadTable[W-2]=ft),$r([],Le,function(Gt){var dn=Ti(qe,Gt,Be,be,De);return At[te].overloadTable===void 0?(dn.argCount=W-2,At[te]=dn):At[te].overloadTable[W-2]=dn,[]}),[]})}var To=[],ga=[{},{value:void 0},{value:null},{value:!0},{value:!1}];function Ei(Z){Z>4&&--ga[Z].refcount===0&&(ga[Z]=void 0,To.push(Z))}function Wo(){for(var Z=0,te=5;te<ga.length;++te)ga[te]!==void 0&&++Z;return Z}function hl(){for(var Z=5;Z<ga.length;++Z)if(ga[Z]!==void 0)return ga[Z];return null}function hs(){a.count_emval_handles=Wo,a.get_first_emval=hl}var Ls={toValue:Z=>(Z||rn("Cannot use deleted val. handle = "+Z),ga[Z].value),toHandle:Z=>{switch(Z){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:{var te=To.length?To.pop():ga.length;return ga[te]={refcount:1,value:Z},te}}}};function pl(Z,te){te=Yn(te),si(Z,{name:te,fromWireType:function(W){var K=Ls.toValue(W);return Ei(W),K},toWireType:function(W,K){return Ls.toHandle(K)},argPackAdvance:8,readValueFromPointer:hr,destructorFunction:null})}function ks(Z){if(Z===null)return"null";var te=typeof Z;return te==="object"||te==="array"||te==="function"?Z.toString():""+Z}function Vs(Z,te){switch(te){case 2:return function(W){return this.fromWireType(Q[W>>2])};case 3:return function(W){return this.fromWireType(ne[W>>3])};default:throw new TypeError("Unknown float type: "+Z)}}function gl(Z,te,W){var K=vi(W);te=Yn(te),si(Z,{name:te,fromWireType:function(oe){return oe},toWireType:function(oe,be){return be},argPackAdvance:8,readValueFromPointer:Vs(te,K),destructorFunction:null})}function Mc(Z,te,W,K,oe,be){var De=ui(te,W);Z=Yn(Z),oe=Dr(K,oe),Gi(Z,function(){ci("Cannot call "+Z+" due to unbound types",De)},te-1),$r([],De,function(Re){var Le=[Re[0],null].concat(Re.slice(1));return za(Z,Ti(Z,Le,null,oe,be),te-1),[]})}function Pu(Z,te,W){switch(te){case 0:return W?function(oe){return V[oe]}:function(oe){return $[oe]};case 1:return W?function(oe){return U[oe>>1]}:function(oe){return G[oe>>1]};case 2:return W?function(oe){return F[oe>>2]}:function(oe){return J[oe>>2]};default:throw new TypeError("Unknown integer type: "+Z)}}function Au(Z,te,W,K,oe){te=Yn(te);var be=vi(W),De=ft=>ft;if(K===0){var Re=32-8*W;De=ft=>ft<<Re>>>Re}var Le=te.includes("unsigned"),Be=(ft,At)=>{},qe;Le?qe=function(ft,At){return Be(At,this.name),At>>>0}:qe=function(ft,At){return Be(At,this.name),At},si(Z,{name:te,fromWireType:De,toWireType:qe,argPackAdvance:8,readValueFromPointer:Pu(te,be,K!==0),destructorFunction:null})}function Nu(Z,te,W){var K=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],oe=K[te];function be(De){De=De>>2;var Re=J,Le=Re[De],Be=Re[De+1];return new oe(B,Be,Le)}W=Yn(W),si(Z,{name:W,fromWireType:be,argPackAdvance:8,readValueFromPointer:be},{ignoreDuplicateRegistrations:!0})}function Yl(Z,te){te=Yn(te);var W=te==="std::string";si(Z,{name:te,fromWireType:function(K){var oe=J[K>>2],be=K+4,De;if(W)for(var Re=be,Le=0;Le<=oe;++Le){var Be=be+Le;if(Le==oe||$[Be]==0){var qe=Be-Re,ft=O(Re,qe);De===void 0?De=ft:(De+="\0",De+=ft),Re=Be+1}}else{for(var At=new Array(oe),Le=0;Le<oe;++Le)At[Le]=String.fromCharCode($[be+Le]);De=At.join("")}return Ie(K),De},toWireType:function(K,oe){oe instanceof ArrayBuffer&&(oe=new Uint8Array(oe));var be,De=typeof oe=="string";De||oe instanceof Uint8Array||oe instanceof Uint8ClampedArray||oe instanceof Int8Array||rn("Cannot pass non-string to std::string"),W&&De?be=A(oe):be=oe.length;var Re=ge(4+be+1),Le=Re+4;if(J[Re>>2]=be,W&&De)N(oe,Le,be+1);else if(De)for(var Be=0;Be<be;++Be){var qe=oe.charCodeAt(Be);qe>255&&(Ie(Le),rn("String has UTF-16 code units that do not fit in 8 bits")),$[Le+Be]=qe}else for(var Be=0;Be<be;++Be)$[Le+Be]=oe[Be];return K!==null&&K.push(Ie,Re),Re},argPackAdvance:8,readValueFromPointer:hr,destructorFunction:function(K){Ie(K)}})}var Ic=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0;function Lu(Z,te){for(var W=Z,K=W>>1,oe=K+te/2;!(K>=oe)&&G[K];)++K;if(W=K<<1,W-Z>32&&Ic)return Ic.decode($.subarray(Z,W));for(var be="",De=0;!(De>=te/2);++De){var Re=U[Z+De*2>>1];if(Re==0)break;be+=String.fromCharCode(Re)}return be}function Rc(Z,te,W){if(W===void 0&&(W=2147483647),W<2)return 0;W-=2;for(var K=te,oe=W<Z.length*2?W/2:Z.length,be=0;be<oe;++be){var De=Z.charCodeAt(be);U[te>>1]=De,te+=2}return U[te>>1]=0,te-K}function Pc(Z){return Z.length*2}function ku(Z,te){for(var W=0,K="";!(W>=te/4);){var oe=F[Z+W*4>>2];if(oe==0)break;if(++W,oe>=65536){var be=oe-65536;K+=String.fromCharCode(55296|be>>10,56320|be&1023)}else K+=String.fromCharCode(oe)}return K}function ml(Z,te,W){if(W===void 0&&(W=2147483647),W<4)return 0;for(var K=te,oe=K+W-4,be=0;be<Z.length;++be){var De=Z.charCodeAt(be);if(De>=55296&&De<=57343){var Re=Z.charCodeAt(++be);De=65536+((De&1023)<<10)|Re&1023}if(F[te>>2]=De,te+=4,te+4>oe)break}return F[te>>2]=0,te-K}function Ac(Z){for(var te=0,W=0;W<Z.length;++W){var K=Z.charCodeAt(W);K>=55296&&K<=57343&&++W,te+=4}return te}function Nc(Z,te,W){W=Yn(W);var K,oe,be,De,Re;te===2?(K=Lu,oe=Rc,De=Pc,be=()=>G,Re=1):te===4&&(K=ku,oe=ml,De=Ac,be=()=>J,Re=2),si(Z,{name:W,fromWireType:function(Le){for(var Be=J[Le>>2],qe=be(),ft,At=Le+4,Wt=0;Wt<=Be;++Wt){var Gt=Le+4+Wt*te;if(Wt==Be||qe[Gt>>Re]==0){var dn=Gt-At,pn=K(At,dn);ft===void 0?ft=pn:(ft+="\0",ft+=pn),At=Gt+te}}return Ie(Le),ft},toWireType:function(Le,Be){typeof Be!="string"&&rn("Cannot pass non-string to C++ string type "+W);var qe=De(Be),ft=ge(4+qe+te);return J[ft>>2]=qe>>Re,oe(Be,ft+4,qe+te),Le!==null&&Le.push(Ie,ft),ft},argPackAdvance:8,readValueFromPointer:hr,destructorFunction:function(Le){Ie(Le)}})}function Jl(Z,te,W,K,oe,be){Pn[Z]={name:Yn(te),rawConstructor:Dr(W,K),rawDestructor:Dr(oe,be),fields:[]}}function Vu(Z,te,W,K,oe,be,De,Re,Le,Be){Pn[Z].fields.push({fieldName:Yn(te),getterReturnType:W,getter:Dr(K,oe),getterContext:be,setterArgumentType:De,setter:Dr(Re,Le),setterContext:Be})}function vl(Z,te){te=Yn(te),si(Z,{isVoid:!0,name:te,argPackAdvance:0,fromWireType:function(){},toWireType:function(W,K){}})}function Fu(Z){Z>4&&(ga[Z].refcount+=1)}function Lc(Z,te){var W=Et[Z];return W===void 0&&rn(te+" has unknown type "+Or(Z)),W}function Uu(Z,te){Z=Lc(Z,"_emval_take_value");var W=Z.readValueFromPointer(te);return Ls.toHandle(W)}function kc(){Pe("")}function Bu(Z,te,W){$.copyWithin(Z,te,te+W)}function $u(){return 2147483648}function Zl(Z){try{return T.grow(Z-B.byteLength+65535>>>16),ye(T.buffer),1}catch{}}function Ql(Z){var te=$.length;Z=Z>>>0;var W=$u();if(Z>W)return!1;let K=(Le,Be)=>Le+(Be-Le%Be)%Be;for(var oe=1;oe<=4;oe*=2){var be=te*(1+.2/oe);be=Math.min(be,Z+100663296);var De=Math.min(W,K(Math.max(Z,be),65536)),Re=Zl(De);if(Re)return!0}return!1}function Ho(Z){return 52}function ps(Z,te,W,K,oe){return 70}var ao=[null,[],[]];function Vc(Z,te){var W=ao[Z];te===0||te===10?((Z===1?x:w)(R(W,0)),W.length=0):W.push(te)}function Fc(Z,te,W,K){for(var oe=0,be=0;be<W;be++){var De=J[te>>2],Re=J[te+4>>2];te+=8;for(var Le=0;Le<Re;Le++)Vc(Z,$[De+Le]);oe+=Re}return J[K>>2]=oe,0}function Fs(Z){return Z}function gs(Z){var te=a["_"+Z];return te}function yl(Z,te){V.set(Z,te)}function ec(Z,te,W,K,oe){var be={string:Gt=>{var dn=0;if(Gt!=null&&Gt!==0){var pn=(Gt.length<<2)+1;dn=xt(pn),N(Gt,dn,pn)}return dn},array:Gt=>{var dn=xt(Gt.length);return yl(Gt,dn),dn}};function De(Gt){return te==="string"?O(Gt):te==="boolean"?!!Gt:Gt}var Re=gs(Z),Le=[],Be=0;if(K)for(var qe=0;qe<K.length;qe++){var ft=be[W[qe]];ft?(Be===0&&(Be=gt()),Le[qe]=ft(K[qe])):Le[qe]=K[qe]}var At=Re.apply(null,Le);function Wt(Gt){return Be!==0&&rt(Be),De(Gt)}return At=Wt(At),At}Zt=a.InternalError=kt(Error,"InternalError"),ki(),Si=a.BindingError=kt(Error,"BindingError"),Da(),Hl(),So(),ro=a.UnboundTypeError=kt(Error,"UnboundTypeError"),hs();var pe={__assert_fail:ht,__cxa_begin_catch:Qe,__cxa_end_catch:He,__cxa_find_matching_catch_2:bn,__cxa_find_matching_catch_3:Tn,__cxa_throw:en,__resumeException:$t,_embind_finalize_value_object:oi,_embind_register_bigint:Li,_embind_register_bool:os,_embind_register_class:fs,_embind_register_class_constructor:io,_embind_register_class_function:ds,_embind_register_emval:pl,_embind_register_float:gl,_embind_register_function:Mc,_embind_register_integer:Au,_embind_register_memory_view:Nu,_embind_register_std_string:Yl,_embind_register_std_wstring:Nc,_embind_register_value_object:Jl,_embind_register_value_object_field:Vu,_embind_register_void:vl,_emval_decref:Ei,_emval_incref:Fu,_emval_take_value:Uu,abort:kc,emscripten_memcpy_big:Bu,emscripten_resize_heap:Ql,fd_close:Ho,fd_seek:ps,fd_write:Fc,invoke_i:Ge,invoke_ii:Qt,invoke_iii:St,invoke_iiii:_e,invoke_v:se,invoke_vi:cn,invoke_viiii:le,invoke_viiiiii:Ze,llvm_eh_typeid_for:Fs};Ve(),a.___wasm_call_ctors=function(){return(a.___wasm_call_ctors=a.asm.__wasm_call_ctors).apply(null,arguments)};var ge=a._malloc=function(){return(ge=a._malloc=a.asm.malloc).apply(null,arguments)},Ie=a._free=function(){return(Ie=a._free=a.asm.free).apply(null,arguments)},We=a.___cxa_free_exception=function(){return(We=a.___cxa_free_exception=a.asm.__cxa_free_exception).apply(null,arguments)},tt=a.___getTypeName=function(){return(tt=a.___getTypeName=a.asm.__getTypeName).apply(null,arguments)};a.__embind_initialize_bindings=function(){return(a.__embind_initialize_bindings=a.asm._embind_initialize_bindings).apply(null,arguments)},a.___errno_location=function(){return(a.___errno_location=a.asm.__errno_location).apply(null,arguments)};var pt=a.setTempRet0=function(){return(pt=a.setTempRet0=a.asm.setTempRet0).apply(null,arguments)},gt=a.stackSave=function(){return(gt=a.stackSave=a.asm.stackSave).apply(null,arguments)},rt=a.stackRestore=function(){return(rt=a.stackRestore=a.asm.stackRestore).apply(null,arguments)},xt=a.stackAlloc=function(){return(xt=a.stackAlloc=a.asm.stackAlloc).apply(null,arguments)},Vt=a.___cxa_can_catch=function(){return(Vt=a.___cxa_can_catch=a.asm.__cxa_can_catch).apply(null,arguments)},Ht=a.___cxa_is_pointer_type=function(){return(Ht=a.___cxa_is_pointer_type=a.asm.__cxa_is_pointer_type).apply(null,arguments)};a.dynCall_ji=function(){return(a.dynCall_ji=a.asm.dynCall_ji).apply(null,arguments)},a.dynCall_iiji=function(){return(a.dynCall_iiji=a.asm.dynCall_iiji).apply(null,arguments)},a.dynCall_jiji=function(){return(a.dynCall_jiji=a.asm.dynCall_jiji).apply(null,arguments)};function Qt(Z,te){var W=gt();try{return Mt(Z)(te)}catch(K){if(rt(W),K!==K+0)throw K;_setThrew(1,0)}}function cn(Z,te){var W=gt();try{Mt(Z)(te)}catch(K){if(rt(W),K!==K+0)throw K;_setThrew(1,0)}}function le(Z,te,W,K,oe){var be=gt();try{Mt(Z)(te,W,K,oe)}catch(De){if(rt(be),De!==De+0)throw De;_setThrew(1,0)}}function se(Z){var te=gt();try{Mt(Z)()}catch(W){if(rt(te),W!==W+0)throw W;_setThrew(1,0)}}function _e(Z,te,W,K){var oe=gt();try{return Mt(Z)(te,W,K)}catch(be){if(rt(oe),be!==be+0)throw be;_setThrew(1,0)}}function Ge(Z){var te=gt();try{return Mt(Z)()}catch(W){if(rt(te),W!==W+0)throw W;_setThrew(1,0)}}function Ze(Z,te,W,K,oe,be,De){var Re=gt();try{Mt(Z)(te,W,K,oe,be,De)}catch(Le){if(rt(Re),Le!==Le+0)throw Le;_setThrew(1,0)}}function St(Z,te,W){var K=gt();try{return Mt(Z)(te,W)}catch(oe){if(rt(K),oe!==oe+0)throw oe;_setThrew(1,0)}}a.ccall=ec;var dt;he=function Z(){dt||ct(),dt||(he=Z)};function ct(Z){if(de>0||(Me(),de>0))return;function te(){dt||(dt=!0,a.calledRun=!0,!_&&(q(),o(a),a.onRuntimeInitialized&&a.onRuntimeInitialized(),k()))}a.setStatus?(a.setStatus("Running..."),setTimeout(function(){setTimeout(function(){a.setStatus("")},1),te()},1)):te()}if(a.preInit)for(typeof a.preInit=="function"&&(a.preInit=[a.preInit]);a.preInit.length>0;)a.preInit.pop()();return ct(),a.ready})})();t.exports=n})(J8)),J8.exports}var qWe=KWe();const XWe=sl(qWe),YWe=new URL("/assets/openjphjs-C-BUUy4a.wasm",import.meta.url),Wv={codec:void 0,decoder:void 0,decodeConfig:{}};function JWe(t,e,n){const r={width:e,height:n};for(;t>0;)r.width=Math.ceil(r.width/2),r.height=Math.ceil(r.height/2),t--;return r}function ZWe(t){if(Wv.decodeConfig=t,Wv.codec)return Promise.resolve();const e=XWe({locateFile:n=>n.endsWith(".wasm")?YWe.toString():n});return new Promise((n,r)=>{e.then(i=>{Wv.codec=i,Wv.decoder=new i.HTJ2KDecoder,n()},r)})}async function QWe(t,e){await ZWe();const n=new Wv.codec.HTJ2KDecoder,r=n.getEncodedBuffer(t.length);r.set(t);const i=e.decodeLevel||0;n.decodeSubResolution(i);const a=n.getFrameInfo();if(e.decodeLevel>0){const{width:I,height:R}=JWe(e.decodeLevel,a.width,a.height);a.width=I,a.height=R}const o=n.getDecodedBuffer();new Uint8Array(o.length).set(o);const l=`x: ${n.getImageOffset().x}, y: ${n.getImageOffset().y}`,c=n.getNumDecompositions(),f=n.getNumLayers(),u=["unknown","LRCP","RLCP","RPCL","PCRL","CPRL"][n.getProgressionOrder()+1],d=n.getIsReversible(),h=`${n.getBlockDimensions().width} x ${n.getBlockDimensions().height}`,p=`${n.getTileSize().width} x ${n.getTileSize().height}`,g=`${n.getTileOffset().x}, ${n.getTileOffset().y}`,m=`${o.length.toLocaleString()} bytes`,y=`${(o.length/r.length).toFixed(2)}:1`,v={columns:a.width,rows:a.height,bitsPerPixel:a.bitsPerSample,signed:a.isSigned,bytesPerPixel:e.bytesPerPixel,componentsPerPixel:a.componentCount};let x=eHe(a,o);const{buffer:w,byteOffset:S,byteLength:T}=x,_=w.slice(S,S+T);x=new x.constructor(_);const D={imageOffset:l,numDecompositions:c,numLayers:f,progessionOrder:u,reversible:d,blockDimensions:h,tileSize:p,tileOffset:g,decodedSize:m,compressionRatio:y};return{...e,pixelData:x,imageInfo:v,encodeOptions:D,...D,...v}}function eHe(t,e){return t.bitsPerSample>8?t.isSigned?new Int16Array(e.buffer,e.byteOffset,e.byteLength/2):new Uint16Array(e.buffer,e.byteOffset,e.byteLength/2):t.isSigned?new Int8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}function tHe(t,e){const n=t.length,{rescaleSlope:r,rescaleIntercept:i,suvbw:a,doseGridScaling:o}=e;if(e.modality==="PT"&&typeof a=="number"&&!isNaN(a))for(let s=0;s<n;s++)t[s]=a*(t[s]*r+i);else if(e.modality==="RTDOSE"&&typeof o=="number"&&!isNaN(o))for(let s=0;s<n;s++)t[s]=t[s]*o;else for(let s=0;s<n;s++)t[s]=t[s]*r+i;return!0}const nHe={bilinear:mWe,replicate:vWe},$B={Uint8Array,Uint16Array,Int16Array,Float32Array,Uint32Array};function rHe(t,e,n,r){const i=t.pixelRepresentation!==void 0&&t.pixelRepresentation===1,a=i&&t.bitsStored!==void 0?32-t.bitsStored:void 0;if(i&&a!==void 0)for(let v=0;v<t.pixelData.length;v++)t.pixelData[v]=t.pixelData[v]<<a>>a;let o=t.pixelData;t.pixelDataLength=t.pixelData.length;const{min:s,max:l}=MS(t.pixelData),c=typeof e.allowFloatRendering<"u"?e.allowFloatRendering:!0;let f=aM(t.photometricInterpretation)&&e.targetBuffer?.offset===void 0;const d=e.preScale?.enabled&&Object.values(e.preScale.scalingParameters).some(v=>typeof v=="number"&&!Number.isInteger(v)),h=!e.preScale.enabled||!c&&d,p=e.targetBuffer?.type;if(p&&e.preScale.enabled&&!h){const v=e.preScale.scalingParameters,x=x9(s,l,v);f=!Aze(x.min,x.max,$B[p])}p&&!f?o=aHe(e,t,$B,o):e.preScale.enabled&&!h?o=oHe(e,s,l,t):o=zre(s,l,t);let g=s,m=l;if(e.preScale.enabled&&!h){const v=e.preScale.scalingParameters;if(Wre(v),iHe(v)){tHe(o,v),t.preScale={...e.preScale,scaled:!0};const w=x9(s,l,v);g=w.min,m=w.max}}else h&&(t.preScale={enabled:!0,scaled:!1},g=s,m=l);t.pixelData=o,t.smallestPixelValue=g,t.largestPixelValue=m;const y=new Date().getTime();return t.decodeTimeInMS=y-n,t}function iHe(t){const{rescaleSlope:e,rescaleIntercept:n,modality:r,doseGridScaling:i,suvbw:a}=t;return typeof e=="number"&&typeof n=="number"||r==="RTDOSE"&&typeof i=="number"||r==="PT"&&typeof a=="number"}function aHe(t,e,n,r){const{arrayBuffer:i,type:a,offset:o=0,length:s,rows:l}=t.targetBuffer,c=n[a];if(!c)throw new Error(`target array ${a} is not supported, or doesn't exist.`);l&&l!=e.rows&&lHe(e,t.targetBuffer,c);const f=e.pixelDataLength,u=o,d=s??f-u,h=e.pixelData;if(d!==h.length)throw new Error(`target array for image does not have the same length (${d}) as the decoded image length (${h.length}).`);const p=i?new c(i,u,d):new c(d);return p.set(h,0),r=p,r}function oHe(t,e,n,r){const i=t.preScale.scalingParameters;Wre(i);const a=x9(e,n,i);return zre(a.min,a.max,r)}function zre(t,e,n){const r=oM(t,e),i=new r(n.pixelData.length);return i.set(n.pixelData,0),i}function x9(t,e,n){const{rescaleSlope:r,rescaleIntercept:i,modality:a,doseGridScaling:o,suvbw:s}=n;return a==="PT"&&typeof s=="number"&&!isNaN(s)?{min:s*(t*r+i),max:s*(e*r+i)}:a==="RTDOSE"&&typeof o=="number"&&!isNaN(o)?{min:t*o,max:e*o}:typeof r=="number"&&typeof i=="number"?{min:r*t+i,max:r*e+i}:{min:t,max:e}}function Wre(t){if(!t)throw new Error("options.preScale.scalingParameters must be defined if preScale.enabled is true, and scalingParameters cannot be derived from the metadata providers.")}function sHe(t,e,n){const{samplesPerPixel:r}=t,{rows:i,columns:a}=e,o=i*a*r,s=new n(o),l=s.byteLength/o;return{pixelData:s,rows:i,columns:a,frameInfo:{...t.frameInfo,rows:i,columns:a},imageInfo:{...t.imageInfo,rows:i,columns:a,bytesPerPixel:l}}}function lHe(t,e,n){const r=sHe(t,e,n),{scalingType:i="replicate"}=e;return nHe[i](t,r),Object.assign(t,r),t.pixelDataLength=t.pixelData.length,t}async function Hre(t,e,n,r,i,a){const o=new Date().getTime();let s=null,l;switch(e){case"1.2.840.10008.1.2":case"1.2.840.10008.1.2.1":s=AB(t,n);break;case"1.2.840.10008.1.2.2":s=xWe(t,n);break;case"1.2.840.10008.1.2.1.99":s=AB(t,n);break;case"1.2.840.10008.1.2.5":s=bWe(t,n);break;case"1.2.840.10008.1.2.4.50":l={...t},s=MWe(n,l);break;case"1.2.840.10008.1.2.4.51":s=PWe(t,n);break;case"1.2.840.10008.1.2.4.57":s=LB(t,n);break;case"1.2.840.10008.1.2.4.70":s=LB(t,n);break;case"1.2.840.10008.1.2.4.80":l={signed:t.pixelRepresentation===1,bytesPerPixel:t.bitsAllocated<=8?1:2,...t},s=VB(n,l);break;case"1.2.840.10008.1.2.4.81":l={signed:t.pixelRepresentation===1,bytesPerPixel:t.bitsAllocated<=8?1:2,...t},s=VB(n,l);break;case"1.2.840.10008.1.2.4.90":l={...t},s=UB(n,l);break;case"1.2.840.10008.1.2.4.91":l={...t},s=UB(n,l);break;case"3.2.840.10008.1.2.4.96":case"1.2.840.10008.1.2.4.201":case"1.2.840.10008.1.2.4.202":case"1.2.840.10008.1.2.4.203":l={...t},s=QWe(n,l);break;default:throw new Error(`no decoder for transfer syntax ${e}`)}if(!s)throw new Error("decodePromise not defined");const c=await s,f=rHe(c,i,o);return a?.(f),f}const cHe={decodeTask({imageFrame:t,transferSyntax:e,decodeConfig:n,options:r,pixelData:i,callbackFn:a}){return Hre(t,e,i,n,r,a)}};ND(cHe);const uf={constants:gWe,convertRGBColorByPixel:are,convertRGBColorByPlane:ore,convertYBRFullByPixel:sre,convertYBRFullByPlane:lre,convertPALETTECOLOR:cre,wadouri:Fze,wadors:cWe,init:jre,convertColorSpace:Mre,createImage:IS,decodeJPEGBaseline8BitColor:Ire,getImageFrame:Rre,getPixelData:uM,getMinMax:MS,isColorImage:aM,isJPEGBaseline8BitColor:hWe,internal:Qje,decodeImageFrame:Hre},uHe=async t=>(await Zo.post("/admin/original-data/store",t)).data,fHe=async t=>(await Zo.get(`/admin/original-data/detail?original_id=${t}`)).data,dHe=async t=>(await Zo.post("/student/copy",t)).data,hHe=async t=>(await Zo.get(`/student/copy/detail?user_copy_id=${t}`)).data;function pHe({title:t,isInitialized:e,isLoading:n,hasData:r,onBack:i,onReload:a,onConsoleEditData:o,onClearData:s,onCopyData:l}){const{userInfo:c}=jf(),f=_u().pathname,u=H.useMemo(()=>f.includes("original"),[f]);return j.jsx("div",{className:"bg-gray-800 text-white px-4 pt-4 flex-shrink-0",children:j.jsxs("div",{className:"flex items-center justify-between mb-3",children:[j.jsxs("div",{className:"flex items-center gap-3",children:[j.jsx(qr,{onClick:i,className:"bg-gray-600 hover:bg-gray-700 text-white",size:"sm",children:"← 返回列表"}),j.jsx("h1",{className:"text-xl font-bold",children:t})]}),j.jsxs("div",{className:"flex items-center gap-2",children:[c?.role===3&&u&&j.jsx("div",{className:"flex items-center gap-2",children:j.jsx(qr,{onClick:l,size:"sm",variant:"solid",color:"success",className:"font-medium text-white px-4 py-2 rounded-lg shadow-md transition-all duration-200 transform",startContent:n?j.jsx("div",{className:"w-4 h-4 border-2 border-current border-t-transparent rounded-full animate-spin"}):j.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:j.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),children:"拷贝数据"})}),(c?.role===1||c?.role===2||!u&&c?.role===3)&&o&&j.jsx(qr,{onClick:o,disabled:!r,size:"sm",variant:"solid",color:r?"success":"default",className:"font-medium px-4 py-2 rounded-lg shadow-md transition-all duration-200 transform text-white",startContent:j.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:j.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"})}),children:"保存数据"}),(c?.role===1||c?.role===2||!u&&c?.role===3)&&s&&j.jsx(qr,{onClick:s,disabled:!r,size:"sm",variant:"solid",color:r?"danger":"default",className:"font-medium px-4 py-2 rounded-lg shadow-md transition-all duration-200 transform text-white",startContent:j.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:j.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m2 0h10M9 7V4h6v3M10 11v6m4-6v6"})}),children:"清空数据"}),j.jsx(qr,{onClick:a,disabled:!e||n||!r,size:"sm",variant:"solid",color:e&&r?"primary":"default",className:"font-medium px-4 py-2 rounded-lg shadow-md transition-all duration-200 transform",startContent:n?j.jsx("div",{className:"w-4 h-4 border-2 border-current border-t-transparent rounded-full animate-spin"}):j.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:j.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),children:n?"加载中...":"重新加载"})]})]})})}const gHe=t=>{switch(t){case"WindowLevel":return"窗位/窗宽";case"Pan":return"平移";case"Zoom":return"缩放";case"Length":return"测量长度";case"RectangleROI":return"矩形标注";case"EllipticalROI":return"椭圆标注";case"CircleROI":return"圆形标注";case"FreehandROI":return"自由画线";case"ArrowAnnotate":return"箭头标注";case"Probe":return"探针";case"Angle":return"角度测量";case"Bidirectional":return"双向测量";case"PlanarFreehandROI":return"平面自由绘制";case"CobbAngle":return"Cobb角度测量";case"RectangleROIStartEndThreshold":return"矩形阈值标注";case"RectangleROIThreshold":return"矩形阈值工具";case"SplineROI":return"样条线标注";case"LivewireContour":return"活线轮廓";case"Magnify":return"放大镜";case"ReferenceLines":return"参考线";case"OverlayGrid":return"网格覆盖";case"Crosshairs":return"十字线";case"ScaleOverlay":return"比例尺";case"AdvancedMagnify":return"高级放大镜";case"UltrasoundDirectional":return"超声方向工具";case"RectangleScissors":return"矩形剪切";case"CircleScissors":return"圆形剪切";case"SphereScissors":return"球形剪切";case"Label":return"文字标注";case"DeleteAnnotation":return"删除标注";default:return t}},mHe=t=>{switch(t){case"WindowLevel":return"拖动鼠标调节亮度和对比度";case"Pan":return"拖动鼠标移动图像";case"Zoom":return"拖动鼠标缩放图像";case"Length":return"点击两点测量距离";case"RectangleROI":return"拖动画出矩形区域";case"EllipticalROI":return"拖动画出椭圆区域";case"CircleROI":return"拖动画出圆形区域";case"FreehandROI":return"拖动鼠标自由画线";case"ArrowAnnotate":return"点击两点放置箭头标注";case"Probe":return"点击查看像素值";case"Angle":return"点击三点测量角度";case"Bidirectional":return"拖动测量两个方向的距离";case"PlanarFreehandROI":return"拖动鼠标平面自由绘制";case"CobbAngle":return"测量Cobb角，常用于脊柱弯曲分析";case"RectangleROIStartEndThreshold":return"画矩形区域并设置阈值范围";case"RectangleROIThreshold":return"矩形阈值分割工具";case"SplineROI":return"绘制样条曲线区域";case"LivewireContour":return"智能边缘检测轮廓绘制";case"Magnify":return"点击显示局部放大镜";case"ReferenceLines":return"显示切面参考线";case"OverlayGrid":return"显示网格覆盖层";case"Crosshairs":return"显示十字线定位";case"ScaleOverlay":return"显示比例尺标记";case"AdvancedMagnify":return"高级放大镜功能";case"UltrasoundDirectional":return"超声图像方向标注";case"RectangleScissors":return"矩形区域剪切工具";case"CircleScissors":return"圆形区域剪切工具";case"SphereScissors":return"球形区域剪切工具";case"Label":return"点击插入文字标注";case"DeleteAnnotation":return"删除当前选中的标注";default:return"选择工具进行操作"}};function vHe({isInitialized:t,activeTool:e,onSwitch:n,annotationColor:r,onColorChange:i}){if(!t)return null;const a=({name:o,label:s})=>j.jsx("button",{onClick:()=>n(o),className:`px-2 py-1 text-xs rounded transition-all cursor-pointer ${e===o?"bg-blue-600 text-white":"bg-gray-600 text-gray-200"}`,children:s});return j.jsxs("div",{className:"space-y-2 bg-gray-800 px-2",children:[j.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[j.jsx("span",{className:"text-xs font-medium text-blue-300 mr-1",children:"基本:"}),j.jsx(a,{name:"WindowLevel",label:"🌅 窗位"}),j.jsx(a,{name:"Pan",label:"✋ 平移"}),j.jsx(a,{name:"Zoom",label:"🔍 缩放"}),j.jsx(a,{name:"Probe",label:"🔎 探针"}),j.jsx("span",{className:"text-xs font-medium text-green-300 mr-1 ml-3",children:"测量:"}),j.jsx(a,{name:"Length",label:"📏 长度"}),j.jsx(a,{name:"Angle",label:"📐 角度"}),j.jsx(a,{name:"Bidirectional",label:"↔️ 双向"}),j.jsx("span",{className:"text-xs font-medium text-purple-300 mr-1 ml-3",children:"标注:"}),j.jsx(a,{name:"RectangleROI",label:"▭ 矩形"}),j.jsx(a,{name:"EllipticalROI",label:"⚬ 椭圆"}),j.jsx(a,{name:"CircleROI",label:"◯ 圆形"}),j.jsx(a,{name:"PlanarFreehandROI",label:"🎨 绘制"}),j.jsx(a,{name:"ArrowAnnotate",label:"➡️ 箭头"}),j.jsx(a,{name:"BrushTool",label:"🖌️ 画笔"}),j.jsx(a,{name:"Label",label:"📝 文字"}),j.jsx("span",{className:"text-xs font-medium text-red-300 mr-1 ml-3",children:"操作:"}),j.jsx(a,{name:"DeleteAnnotation",label:"🗑️ 删除"}),j.jsx("span",{className:"text-yellow-300 text-xs mr-1 ml-3",children:"颜色:"}),j.jsxs("div",{className:"flex items-center gap-2",children:[j.jsx("input",{type:"color",value:r,onChange:o=>i(o.target.value),className:"w-8 h-8 rounded border-2 border-gray-400 cursor-pointer",title:"选择标注颜色"}),j.jsx("button",{onClick:()=>i("#ff0000"),className:"px-2 py-1 text-xs rounded bg-red-600 text-white hover:bg-red-700 transition-all",title:"测试红色",children:"🔴 红"}),j.jsx("button",{onClick:()=>i("#00ff00"),className:"px-2 py-1 text-xs rounded bg-green-600 text-white hover:bg-green-700 transition-all",title:"测试绿色",children:"🟢 绿"})]})]}),j.jsxs("div",{className:"text-xs text-gray-300 py-1 rounded",children:[j.jsx("span",{className:"text-yellow-300",children:"当前:"})," ",j.jsx("span",{className:"font-medium",children:gHe(e)}),j.jsx("span",{className:"mx-1 text-gray-500",children:"|"}),j.jsx("span",{className:"text-blue-300",children:mHe(e)})]})]})}function yHe({error:t,dataLoading:e,isInitialized:n}){return j.jsxs(j.Fragment,{children:[t&&j.jsxs("div",{className:"p-3 bg-red-100 text-red-800 border-b border-red-300",children:["错误: ",t]}),e&&j.jsx("div",{className:"p-3 bg-blue-100 text-blue-800 border-b border-blue-300",children:"正在加载数据..."}),!n&&j.jsx("div",{className:"p-3 bg-cyan-100 text-cyan-800 border-b border-cyan-300",children:"正在初始化 Cornerstone..."})]})}function xHe({elementRef:t,isLoading:e,isInitialized:n,hasData:r,showSwitchHint:i,children:a}){return j.jsx("div",{className:"flex-1 relative overflow-hidden ",children:j.jsxs("div",{ref:t,className:"w-full h-full bg-black",style:{minHeight:"400px"},children:[!e&&n&&r&&j.jsxs(j.Fragment,{children:[j.jsx("div",{className:"absolute top-1 left-4 text-gray-400 text-sm bg-black bg-opacity-50 px-2 py-1 rounded z-10",children:"图像将自动加载，或点击按钮重新加载"}),i&&j.jsx("div",{className:"absolute top-1 right-4 text-gray-400 text-sm bg-black bg-opacity-50 px-2 py-1 rounded z-10",children:"使用 ← → 键切换图像"})]}),!r&&!e&&j.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-gray-500",children:j.jsxs("div",{className:"text-center",children:[j.jsx("div",{className:"text-2xl mb-2",children:"📁"}),j.jsx("div",{children:"数据加载失败"})]})}),e&&j.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-gray-500",children:j.jsxs("div",{className:"text-center",children:[j.jsx("div",{className:"text-2xl mb-2",children:"🔄"}),j.jsx("div",{children:"正在加载数据..."})]})}),a]})})}function bHe({visible:t,isLoading:e,imageCount:n,currentIndex:r,expanded:i,onToggleExpanded:a,onPrev:o,onNext:s,onJump:l}){return t?j.jsxs("div",{className:"fixed bottom-4 left-4 z-50",children:[j.jsx("div",{className:"mb-2",children:j.jsxs(qr,{size:"sm",onClick:a,className:"bg-gray-800 bg-opacity-90 backdrop-blur-sm hover:bg-gray-700 text-white border border-gray-600 shadow-lg",children:[i?"🔽":"🖼️"," ",r+1,"/",n]})}),i&&j.jsxs("div",{className:"bg-gray-800 w-[320px] bg-opacity-95 backdrop-blur-sm border border-gray-600 rounded-lg shadow-xl p-4 min-w-72",children:[j.jsxs("div",{className:"flex items-center justify-between mb-3",children:[j.jsx("span",{className:"text-sm font-medium text-orange-300",children:"图像切换:"}),j.jsxs("div",{className:"flex items-center gap-1",children:[j.jsx(qr,{size:"sm",onClick:o,disabled:n<=1||e,className:"bg-gray-600 hover:bg-gray-500 text-white min-w-unit-8 h-8",children:"◀"}),j.jsxs("span",{className:"text-sm text-gray-300 px-3 min-w-16 text-center",children:[r+1," / ",n]}),j.jsx(qr,{size:"sm",onClick:s,disabled:n<=1||e,className:"bg-gray-600 hover:bg-gray-500 text-white min-w-unit-8 h-8",children:"▶"})]})]}),n>2&&j.jsxs("div",{children:[j.jsx("div",{className:"text-xs text-gray-400 mb-2",children:"快速跳转:"}),j.jsx("div",{className:"flex gap-1 overflow-x-auto pb-2 max-w-64",children:Array.from({length:n}).map((c,f)=>j.jsx("button",{onClick:()=>l(f),disabled:e,className:`
                          flex-shrink-0 w-8 h-6 text-xs rounded transition-all
                          ${f===r?"bg-orange-600 text-white":"bg-gray-600 text-gray-300 hover:bg-gray-500"}
                          ${e?"opacity-50 cursor-not-allowed":""}
                        `,children:f+1},f))})]}),j.jsx("div",{className:"mt-3 pt-3 border-t border-gray-600",children:j.jsx("div",{className:"text-xs text-gray-500",children:"💡 快捷键: ← → 切换图像"})})]})]}):null}const{ViewportType:wHe}=ll,{MouseBindings:Sb}=MNe;function CHe(t){const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?`rgb(${parseInt(e[1],16)}, ${parseInt(e[2],16)}, ${parseInt(e[3],16)})`:t}function GB(){const{id:t}=e$(),e=Ec(),{userInfo:n}=jf(),r=_u().pathname,i=H.useRef(null),[a,o]=H.useState(!1),[s,l]=H.useState(!0),[c,f]=H.useState(null),[u,d]=H.useState(!1),[h,p]=H.useState("WindowLevel"),[g,m]=H.useState(null),[y,v]=H.useState(0),[x,w]=H.useState([]),[S,T]=H.useState(!0),[_,D]=H.useState(1),[I,R]=H.useState([]),[O,P]=H.useState("#00ff00"),N=H.useRef(null),A=H.useRef(null),B=H.useRef(0),V=H.useRef(null),$=H.useRef(()=>{}),U=H.useRef(null),G=H.useRef(null),F=H.useMemo(()=>r.includes("original"),[r]),[J,Q]=H.useState(!1),ne=H.useCallback(async()=>{try{let Oe=Ts.getAllAnnotations()||[],Ne=JSON.parse(JSON.stringify(Oe)).map(me=>{if(JSON.stringify(me.data.cachedStats)!=="{}"){let Se=Object.keys(me.data.cachedStats)[0].split("?")[0],Ve=Object.values(me.data.cachedStats)[0],ue={[Se]:Ve};me.data.cachedStats=ue}me.metadata.referencedImageId=me.metadata.referencedImageId.split("?")[0];try{const Se=me?.metadata?.toolName||me?.toolName;let Ve=fw.getStyleProperty("color",{annotationUID:me.annotationUID,toolName:Se});Ve||(Ve=CHe(O)),me.data={...me.data||{},style:{...me.data?.style,color:Ve,textBoxColor:Ve,textbox:{...me.data?.style?.textbox,color:Ve}}}}catch{}return me});const ie=new Set,ae=()=>`anno_${Date.now()}_${Math.floor(Math.random()*1e9)}`;Ne=Ne.map(me=>{const Se=me?.annotationUID;return(!Se||ie.has(Se))&&(me.annotationUID=ae()),ie.add(me.annotationUID),me});const Te=JSON.stringify(Ne);if(console.log("🚀 ~ printAnnotations ~ annotationsAll:",Ne),F){const me=await fye(g.original_id,Te);me.success?Nt({color:"success",description:"标注保存成功"}):Nt({color:"danger",description:me.message||"保存失败"})}else{const me=await dye(g.user_copy_id,Te);me.success?Nt({color:"success",description:"标注保存成功"}):Nt({color:"danger",description:me.message||"保存失败"})}}catch(Oe){console.warn("导出标注数据失败",Oe),Nt({color:"danger",description:"导出失败"})}},[x,g]),ye=H.useCallback(()=>{try{Ts.removeAllAnnotations(),R([]);const Oe=N.current;Oe&&Oe.getViewport("CT_SAGITTAL_STACK")?.render?.(),Nt({color:"success",description:"已清空所有标注"})}catch(Oe){console.warn("清空标注失败",Oe),Nt({color:"danger",description:"清空失败"})}},[]);H.useEffect(()=>{const Oe=Pe=>{const{annotation:Ne}=Pe.detail||{};try{fw.setAnnotationStyles(Ne.annotationUID,{color:O,textBoxColor:O,textbox:{color:O}})}catch(ie){console.warn("设置新标注颜色失败",ie)}try{Ne?.annotationUID&&(G.current=Ne.annotationUID)}catch{}};return vt.addEventListener(ee.ANNOTATION_ADDED,Oe),()=>{vt.removeEventListener(ee.ANNOTATION_ADDED,Oe)}},[O]),H.useEffect(()=>{try{const Oe=ee||{},Pe=ie=>{const ae=ie?.detail?.annotation?.annotationUID||ie?.detail?.annotationUID;ae&&(U.current=ae)},Ne=ie=>{U.current=null};return Oe.ANNOTATION_SELECTED&&vt.addEventListener(Oe.ANNOTATION_SELECTED,Pe),Oe.ANNOTATION_DESELECTED&&vt.addEventListener(Oe.ANNOTATION_DESELECTED,Ne),()=>{try{Oe.ANNOTATION_SELECTED&&vt.removeEventListener(Oe.ANNOTATION_SELECTED,Pe),Oe.ANNOTATION_DESELECTED&&vt.removeEventListener(Oe.ANNOTATION_DESELECTED,Ne)}catch{}}}catch{return()=>{}}},[]);const ve=H.useCallback(async Oe=>{if(!(a||!N.current||!x[Oe]))try{o(!0);const Pe=N.current,Ne=Pe.getViewport("CT_SAGITTAL_STACK");if(Ne&&typeof Ne.setStack=="function"){await Ne.setStack([x[Oe]]),typeof Ne.resetCamera=="function"&&Ne.resetCamera();try{const ie=Ne?.getCamera?.(),ae=ie?.parallelScale;typeof ae=="number"&&ae>0&&(V.current=ae,Ne?.setCamera?.({...ie}))}catch{}Pe.render(),v(Oe),console.log(`已切换到第 ${Oe+1} 张图像`)}}catch(Pe){console.error("切换图像失败:",Pe),f("切换图像失败: "+Pe.message)}finally{o(!1)}},[x,a]),Ce=H.useCallback(()=>{if(a||x.length<=1)return;const Oe=y>0?y-1:x.length-1;ve(Oe)},[y,x.length,a,ve]),we=H.useCallback(()=>{if(a||x.length<=1)return;const Oe=y<x.length-1?y+1:0;ve(Oe)},[y,x.length,a,ve]);H.useEffect(()=>{(async()=>{if(!t){Nt({color:"danger",description:"数据ID无效"}),e("/list");return}l(!0);try{const Pe=F?await fHe(Number(t)):await hHe(Number(t));if(Pe.success&&Pe.data){m(Pe.data);let Ne=Pe.data.last_annotation?.annotation||Pe.data?.original_data?.last_annotation?.annotation;if(Ne)try{const ae=JSON.parse(Ne);console.log("🚀解析保存的标注数据:",ae),R(ae)}catch(ae){console.warn("解析保存的标注数据失败:",ae)}const ie=Pe.data.files||Pe.data.original_data?.files;if(ie&&ie.length>0){const ae=ie.map(Te=>`wadouri:${Te.fresh_url}`);w(ae),v(0)}}else Nt({color:"danger",description:Pe.message||"加载数据失败"}),e("/list")}catch(Pe){console.error("加载数据错误:",Pe),Nt({color:"danger",description:"加载数据失败"}),e("/list")}finally{l(!1)}})()},[t,e]),H.useEffect(()=>((async()=>{try{await iq(),uf.external||(uf.external={}),uf.external.cornerstone=ONe,uf.external.dicomParser=Wje,jre();try{uf?.wadouri?.register&&uf.wadouri.register()}catch(Pe){console.warn("注册 wadouri 加载器时出错（可忽略）",Pe)}try{uf?.internal?.setOptions&&uf.internal.setOptions({onloadstart:(Pe,Ne)=>{},onprogress:(Pe,Ne)=>{},onreadystatechange:(Pe,Ne)=>{const ie=Pe?.target},onloadend:(Pe,Ne)=>{},beforeProcessing:Pe=>Promise.resolve(Pe.response),errorInterceptor:Pe=>{console.error("请求错误",Pe)}})}catch(Pe){console.warn("设置 dicomImageLoader 调试选项失败（可忽略）",Pe)}try{uf.configure({useWebWorkers:!1})}catch(Pe){console.warn("配置 dicomImageLoader 失败（可忽略）",Pe)}await L$e(),Qr(Qp),Qr(Fv),Qr(eg),Qr(mg),Qr(Wd),Qr(yg),Qr(xg),Qr(Cg),Qr(vg),Qr(Sg),Qr(pg),Qr(vh),Qr(Tg),Qr(kv),Qr(Vv),Qr(bg),Qr(wg),Qr(Uv),Qr(Bv),Qr(Hd),Qr(Eg),Qr($v),Qr(Gv),Qr(jv),Qr(yh),d(!0),console.log("Cornerstone 初始化成功")}catch(Pe){console.error("Cornerstone 初始化失败:",Pe),f("初始化失败: "+Pe.message)}})(),()=>{try{N.current&&(N.current.destroy(),N.current=null);const Pe="STACK_TOOL_GROUP_ID";try{jh(Pe)&&ZF(Pe)}catch(Ne){console.warn("清理工具组时出错（可忽略）:",Ne)}}catch(Pe){console.warn("组件清理时出错（可忽略）:",Pe)}}),[]);const Ae=H.useCallback(()=>{if(!A.current)return;const Oe=h;if(!(!Oe||Oe==="DeleteAnnotation"))try{const Pe=A.current,Ne=Te=>{try{Pe.setToolPassive(Te.toolName)}catch{}};[Fv,Qp,eg,mg,Wd,yg,xg,Cg,vg,Sg,pg,vh,Tg,kv,Vv,bg,wg,Uv,Bv,Hd,Eg,$v,Gv,jv,yh].forEach(Ne);const ie=[{mouseButton:Sb.Primary}],ae=(Te,me)=>{try{Pe.setToolActive(Te.toolName,{bindings:me})}catch{}};switch(Oe){case"WindowLevel":ae(Fv,ie);try{Q(!1)}catch{}break;case"Pan":ae(Qp,ie);try{Q(!1)}catch{}break;case"Zoom":ae(eg,ie);try{Q(!1)}catch{}break;case"Length":ae(mg,ie);try{Q(!1)}catch{}break;case"RectangleROI":ae(Wd,ie);try{Q(!1)}catch{}break;case"EllipticalROI":ae(yg,ie);try{Q(!1)}catch{}break;case"CircleROI":ae(xg,ie);try{Q(!1)}catch{}break;case"ArrowAnnotate":ae(Cg,ie);try{Q(!1)}catch{}break;case"BrushTool":{try{Q(!0)}catch{}break}case"Probe":ae(vg,ie);try{Q(!1)}catch{}break;case"Angle":ae(Sg,ie);try{Q(!1)}catch{}break;case"Bidirectional":ae(pg,ie);try{Q(!1)}catch{}break;case"PlanarFreehandROI":ae(vh,ie);try{Q(!1)}catch{}break;case"CobbAngle":ae(Tg,ie);try{Q(!1)}catch{}break;case"RectangleROIStartEndThreshold":ae(kv,ie);try{Q(!1)}catch{}break;case"RectangleROIThreshold":ae(Vv,ie);try{Q(!1)}catch{}break;case"SplineROI":ae(bg,ie);try{Q(!1)}catch{}break;case"LivewireContour":ae(wg,ie);try{Q(!1)}catch{}break;case"Magnify":ae(Uv,ie);try{Q(!1)}catch{}break;case"OverlayGrid":ae(Bv,ie);try{Q(!1)}catch{}break;case"AdvancedMagnify":ae(Hd,ie);try{Q(!1)}catch{}break;case"UltrasoundDirectional":ae(Eg,ie);try{Q(!1)}catch{}break;case"RectangleScissors":ae($v,ie);try{Q(!1)}catch{}break;case"CircleScissors":ae(Gv,ie);try{Q(!1)}catch{}break;case"SphereScissors":ae(jv,ie);try{Q(!1)}catch{}break;case"Label":ae(yh,ie);try{Q(!1)}catch{}break}try{Pe.setToolActive(Qp.toolName,{bindings:[{mouseButton:Sb.Auxiliary}]})}catch{}try{Pe.setToolActive(eg.toolName,{bindings:[{mouseButton:Sb.Secondary}]})}catch{}}catch(Pe){console.warn("重新应用工具失败",Pe)}},[h]);H.useEffect(()=>{$.current=Ae},[Ae]),H.useEffect(()=>{try{$.current?.()}catch{}},[h]);const Me=H.useCallback(async()=>{if(!u||!i.current||!g)return;o(!0),f(null);const Oe=++B.current;try{const Pe=i.current;if(N.current){try{N.current.destroy()}catch(ut){console.warn("清理渲染引擎时出错（可忽略）:",ut)}N.current=null}const Ne="myRenderingEngine",ie=new DQ(Ne);N.current=ie;const ae="CT_SAGITTAL_STACK",Te={viewportId:ae,type:wHe.STACK,element:Pe,defaultOptions:{background:[0,0,0]}};ie.enableElement(Te);const me=ie.getViewport(ae),Se="STACK_TOOL_GROUP_ID";let Ve;try{Ve=jh(Se),Ve&&ZF(Se)}catch{console.log("工具组不存在，将创建新的")}Ve=JNe(Se),A.current=Ve,Ve.addTool(Fv.toolName),Ve.addTool(Qp.toolName),Ve.addTool(eg.toolName),Ve.addTool(mg.toolName),Ve.addTool(Wd.toolName),Ve.addTool(yg.toolName),Ve.addTool(xg.toolName),Ve.addTool(Cg.toolName),Ve.addTool(vg.toolName),Ve.addTool(Sg.toolName),Ve.addTool(pg.toolName),Ve.addTool(vh.toolName),Ve.addTool(Tg.toolName),Ve.addTool(kv.toolName),Ve.addTool(Vv.toolName),Ve.addTool(bg.toolName),Ve.addTool(wg.toolName),Ve.addTool(Uv.toolName),Ve.addTool(Bv.toolName),Ve.addTool(Hd.toolName),Ve.addTool(Eg.toolName),Ve.addTool($v.toolName),Ve.addTool(Gv.toolName),Ve.addTool(jv.toolName),Ve.addTool(yh.toolName),Ve.addViewport(ae,Ne);let ue=[];if(x.length>0)ue=[x[y]];else if(g.files&&g.files.length>0){const ut=g.files.map(ht=>`wadouri:${ht.fresh_url}`);w(ut),ue=[ut[0]]}else ue=["wadouri:/3.dcm"];if(Oe!==B.current)return;await me.setStack(ue),typeof me.resetCamera=="function"&&me.resetCamera();try{const ut=me?.getCamera?.(),ht=ut?.parallelScale;typeof ht=="number"&&ht>0&&(V.current=ht,me?.setCamera?.({...ut}))}catch{}if(Oe!==B.current)return;ie.render();try{$.current?.()}catch{}try{const ht=me?.getCamera?.()?.parallelScale;typeof ht=="number"&&ht>0&&(V.current=ht,D(1))}catch{}I.length>0&&(console.log("🚀开始恢复标注数据..."),de(I),R([]))}catch(Pe){console.error("加载 DICOM 文件失败:",Pe),f("加载失败: "+Pe.message)}finally{Oe===B.current&&o(!1)}},[u,g,x,y]),q=H.useCallback(Oe=>{if(!A.current)return;const Pe=n?.role;if(F&&Pe===3){Nt({color:"danger",description:"您没有权限编辑原始数据"});return}p(Oe)},[F,n]),k=H.useCallback(()=>{try{const Oe=Ts;if(!Oe){Nt({color:"danger",description:"标注模块不可用"});return}let Pe;try{Pe=Oe.getSelectedAnnotation?.()?.annotationUID}catch{}if(!Pe&&U.current&&(Pe=U.current||void 0),!Pe){let Ne=[];const ie=Oe.getAllAnnotations?.();Array.isArray(ie)?Ne=ie.flat?ie.flat(2):ie:ie&&typeof ie=="object"&&Object.values(ie).forEach(me=>{Array.isArray(me)&&Ne.push(...me)});const ae=Ne.filter(Te=>Te?.isSelected||Te?.isHighlighted||Te?.highlighted||Te?.selection?.isSelected);if(ae.length===1)Pe=ae[0]?.annotationUID;else if(ae.length>1){ae.forEach(Te=>{Te?.annotationUID&&X(Te.annotationUID)}),Nt({color:"success",description:"已删除多条选中标注"});return}}if(!Pe){const Ne=Ve=>Ve&&Ve.split("?")[0],ie=Ne(x[y]||"");let ae=[];const Te=Oe.getAllAnnotations?.();Array.isArray(Te)?ae=Te.flat?Te.flat(2):Te:Te&&typeof Te=="object"&&Object.values(Te).forEach(ue=>{Array.isArray(ue)&&ae.push(...ue)});const me=ae.filter(Ve=>Ne(Ve?.metadata?.referencedImageId||"").includes(ie)),Se=me.filter(Ve=>Ve?.isSelected||Ve?.isHighlighted||Ve?.highlighted||Ve?.selection?.isSelected);if(Se.length===1)Pe=Se[0]?.annotationUID;else if(Se.length>1){Se.forEach(Ve=>{Ve?.annotationUID&&X(Ve.annotationUID)}),Nt({color:"success",description:"已删除多条选中标注"});return}else if(me.length===1)Pe=me[0]?.annotationUID;else{Nt({color:"warning",description:"请先选中需要删除的标注"});return}}if(!Pe){Nt({color:"warning",description:"请先选中要删除的标注"});return}X(Pe)}catch(Oe){console.error("删除标注失败:",Oe),Nt({color:"danger",description:"删除标注失败"})}},[]),Y=H.useCallback(Oe=>{P(Oe)},[]),X=H.useCallback(Oe=>{try{if(Ts?.removeAnnotation){if(Ts.removeAnnotation(Oe),console.log("标注已删除:",Oe),N.current){try{N.current.getViewport("CT_SAGITTAL_STACK")?.render?.()}catch{}N.current.render?.()}U.current===Oe&&(U.current=null),G.current===Oe&&(G.current=null)}else console.warn("无法删除标注，API 不可用"),Nt({color:"danger",description:"删除标注失败"})}catch(Pe){console.error("删除标注失败:",Pe),Nt({color:"danger",description:"删除标注失败"})}},[]),re=H.useCallback(Oe=>{try{const Pe=Ts;if(!Pe?.getAllAnnotations)return;let Ne=[];const ie=Pe.getAllAnnotations();Array.isArray(ie)?Ne=ie.flat?ie.flat(2):ie:ie&&typeof ie=="object"&&Object.values(ie).forEach(Te=>{Array.isArray(Te)&&Ne.push(...Te)}),Ne.forEach(ae=>{ae&&(Oe&&ae.annotationUID===Oe||(ae.selection&&typeof ae.selection=="object"&&(ae.selection.isSelected=!1),ae.isSelected=!1,ae.isHighlighted=!1,ae.highlighted=!1))});try{N.current?.getViewport?.("CT_SAGITTAL_STACK")?.render?.()}catch{}N.current?.render?.()}catch{}},[]),de=Oe=>{const Pe=g.files||g.original_data?.files;try{let Ne=Pe.map(ae=>({name:ae.file_name,url:ae.fresh_url}));Oe.map(ae=>(Ne.map(Te=>{if(ae.metadata.referencedImageId.includes(Te.name)&&(ae.metadata.referencedImageId=`wadouri:${Te.url}`,JSON.stringify(ae.data.cachedStats)!=="{}")){let me=Object.values(ae.data.cachedStats)[0];ae.data.cachedStats={[`imageId:wadouri:${Te.url}`]:me}}}),ae)).forEach(ae=>{console.log("🚀 ~ data.forEach ~ annotation:",ae);try{try{ae.selection&&(ae.selection.isSelected=!1),ae.isSelected=!1,ae.isHighlighted=!1,ae.highlighted=!1}catch{}console.log("🚀添加标注:",ae);const Te=Ts.addAnnotation(ae,i.current);console.log(`🚀标注 ${Te} 已添加到状态`);try{const me=ae?.data?.style,Se=me?.color,Ve=me?.textBoxColor||me?.textbox?.color;Te&&(Se||Ve)&&fw.setAnnotationStyles(Te,{...Se?{color:Se}:{},...Ve?{textBoxColor:Ve,textbox:{color:Ve}}:{}})}catch{}console.log("🚀添加标注成功:",ae.annotationUID)}catch(Te){console.warn("🚀添加单个标注失败:",Te,ae)}}),N.current&&setTimeout(()=>{try{const ae=A.current;if(ae){const me=h;me&&me!=="DeleteAnnotation"&&ae.setToolActive(me,{bindings:[{mouseButton:Sb.Primary}]})}const Te=N.current.getViewport("CT_SAGITTAL_STACK");Te&&Te.render(),re(),N.current.render(),console.log("🚀标注恢复完成，已强制重新渲染"),setTimeout(()=>{const me=Ts.getAllAnnotations();console.log("🚀恢复后的所有标注:",me)},200)}catch(ae){console.warn("强制渲染失败:",ae)}},100)}catch(Ne){console.error("🚀恢复标注数据失败:",Ne)}};H.useEffect(()=>{u&&g&&!s&&setTimeout(()=>{B.current++,Me()},100)},[u,g,s,Me]),H.useEffect(()=>{const Oe=Ne=>{if(!(a||x.length<=1))switch(Ne.key){case"ArrowLeft":Ne.preventDefault(),Ce();break;case"ArrowRight":Ne.preventDefault(),we();break}},Pe=Ne=>{(Ne.key==="Delete"||Ne.key==="Backspace")&&(Ne.preventDefault(),k())};return window.addEventListener("keydown",Oe),window.addEventListener("keydown",Pe),()=>{window.removeEventListener("keydown",Oe),window.removeEventListener("keydown",Pe)}},[x.length,Ce,we,k]),H.useEffect(()=>{const Oe=()=>{if(N.current&&i.current)try{setTimeout(()=>{const Pe=N.current;Pe&&(Pe.resize(!0),Pe.render())},100)}catch(Pe){console.warn("调整视口尺寸失败:",Pe)}};return window.addEventListener("resize",Oe),u&&setTimeout(Oe,200),()=>{window.removeEventListener("resize",Oe)}},[u]),H.useEffect(()=>{A.current&&u&&Y(O)},[O,u,Y]);const he=Oe=>"name"in Oe?Oe.name:"copy_name"in Oe?Oe.copy_name:"未知数据",Ee=async()=>{if(!n?.user_id){Nt({color:"danger",description:"用户信息错误，请重新登录"});return}try{const Oe=await dHe({original_id:g.original_id,copy_name:`${he(g)} - 复制`});Oe.success?Nt({color:"success",description:"复制成功！数据已添加到您的账户"}):Od.handleApiError(new Error(Oe.message),"复制失败")}catch(Oe){Od.handleApiError(Oe,"复制失败")}finally{}};return j.jsxs("div",{className:"h-[calc(100vh-64px)] flex flex-col",children:[j.jsx(pHe,{title:s?"DICOM 图像查看器":g?.name||g?.copy_name||"DICOM 图像查看器",isInitialized:!!u,isLoading:!!a,hasData:!!g,onBack:()=>e("/list"),onReload:Me,onCopyData:Ee,onConsoleEditData:ne,onClearData:ye}),j.jsx(vHe,{isInitialized:!!u,activeTool:h,onSwitch:q,annotationColor:O,onColorChange:Y}),j.jsx(yHe,{error:c,dataLoading:s,isInitialized:u}),j.jsx(xHe,{elementRef:i,isLoading:a,isInitialized:u,hasData:!!g,showSwitchHint:x.length>1}),j.jsx(bHe,{visible:!!g,isLoading:a,imageCount:x.length,currentIndex:y,expanded:S,onToggleExpanded:()=>T(!S),onPrev:Ce,onNext:we,onJump:Oe=>ve(Oe),currentFileName:g?.files?.[y]?.file_name||g?.original_data?.files?.[y]?.file_name,currentFile:g?.files?.[y]||g?.original_data?.files?.[y]}),j.jsx(vye,{currentImageIndex:y+1,totalImages:x.length,zoom:_,isVisible:!!g&&u}),j.jsx(h5e,{open:J,title:g?.name||g?.copy_name||"DICOM",imageIndex:y,onClose:()=>{try{Q(!1),q("WindowLevel")}catch{}}})]})}const SHe=()=>{const t=Ec(),{setAccessToken:e}=jf(),[n,r]=H.useState(""),[i,a]=H.useState(""),[o,s]=H.useState(!1),l=f=>{f.key==="Enter"&&!o&&c()},c=async()=>{if(!n||!i){Nt({color:"danger",description:"请输入邮箱和密码"});return}s(!0);try{const f=await w1e({email:n,password:i});f.success&&f.data?.access_token?(Nt({color:"success",description:"登录成功"}),e(f.data.access_token),t("/list")):Nt({color:"danger",description:f.message})}catch{Nt({color:"danger",description:"登录失败，请重试"})}finally{s(!1)}};return j.jsxs("div",{className:"space-y-6",children:[j.jsxs("div",{children:[j.jsx("div",{className:"block text-sm font-medium text-white mb-2",children:"用户"}),j.jsx("input",{type:"email",value:n,onChange:f=>r(f.target.value),onKeyPress:l,className:"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"请输入用户",disabled:o})]}),j.jsxs("div",{children:[j.jsx("div",{className:"block text-sm font-medium text-white mb-2",children:"密码"}),j.jsx("input",{type:"password",value:i,onChange:f=>a(f.target.value),onKeyPress:l,className:"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"请输入密码",disabled:o})]}),j.jsx("div",{onClick:c,className:`flex items-center cursor-pointer justify-center w-full font-medium py-3 px-4 rounded-lg transition-colors duration-200 ${o?"bg-gray-600 text-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 text-white"}`,children:o?"登录中...":"登录"})]})},THe=async t=>(await Zo.post("/register/check-email",t)).data,EHe=async t=>(await Zo.post("/register/send-code",t)).data,_He=async t=>(await Zo.post("/register/verify-code",t)).data,DHe=async t=>(await Zo.post("/register/submit",t)).data,OHe=({onRegisterSuccess:t})=>{const[e,n]=H.useState(1),[r,i]=H.useState(""),[a,o]=H.useState(""),[s,l]=H.useState(!1),[c,f]=H.useState(!1),[u,d]=H.useState(!1),[h,p]=H.useState(""),[g,m]=H.useState(0),[y,v]=H.useState(""),[x,w]=H.useState(""),[S,T]=H.useState(""),[_,D]=H.useState(!1);H.useEffect(()=>{let B;return g>0&&(B=setTimeout(()=>{m(g-1)},1e3)),()=>{B&&clearTimeout(B)}},[g]);const I=B=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(B),R=async()=>{if(!I(r)){Nt({color:"danger",description:"请输入有效的邮箱地址"});return}f(!0);try{const B=await THe({email:r});if(B.success&&B.data?.exists){Nt({color:"danger",description:"该邮箱已被注册，请使用其他邮箱"}),f(!1);return}const V=await EHe({email:r,name:y||"User",password:x||"temp123"});V.success?(Nt({color:"success",description:V.data?.message||"验证码已发送"}),l(!0),m(60)):Nt({color:"danger",description:V.message||"发送验证码失败"})}catch{Nt({color:"danger",description:"发送验证码失败，请重试"})}finally{f(!1)}},O=async()=>{if(!a||a.length!==6){Nt({color:"danger",description:"请输入6位验证码"});return}d(!0);try{const B=await _He({email:r,code:a});B.success&&(B.data?.verification_token||B.data?.verified)?(Nt({color:"success",description:B.message||"邮箱验证成功"}),p(B.data?.verification_token||`verified_${r}`),n(2)):Nt({color:"danger",description:B.message||"验证码错误"})}catch{Nt({color:"danger",description:"验证失败，请重试"})}finally{d(!1)}},P=async()=>{if(!y||y.length<3){Nt({color:"danger",description:"用户名至少需要3个字符"});return}if(!x||x.length<6){Nt({color:"danger",description:"密码至少需要6个字符"});return}if(x!==S){Nt({color:"danger",description:"两次输入的密码不一致"});return}D(!0);try{const B=await DHe({email:r,username:y,password:x,password_confirmation:S,code:a});B.success?(Nt({color:"success",description:"注册成功，请登录"}),n(1),i(""),o(""),l(!1),m(0),p(""),v(""),w(""),T(""),t()):Nt({color:"danger",description:B.message||"注册失败"})}catch{Nt({color:"danger",description:"注册失败，请重试"})}finally{D(!1)}},N=B=>{B.key==="Enter"&&(e===1?s?O():R():P())},A=()=>{n(1),l(!1),o(""),m(0),p("")};return j.jsxs("div",{className:"space-y-6",children:[j.jsx("div",{className:"flex items-center justify-center mb-6",children:j.jsxs("div",{className:"flex items-center space-x-4",children:[j.jsx("div",{className:`flex items-center justify-center w-8 h-8 rounded-full text-sm font-medium ${e===1?"bg-blue-600 text-white":"bg-green-600 text-white"}`,children:"1"}),j.jsx("div",{className:"w-16 h-0.5 bg-gray-600"}),j.jsx("div",{className:`flex items-center justify-center w-8 h-8 rounded-full text-sm font-medium ${e===2?"bg-blue-600 text-white":"bg-gray-600 text-gray-400"}`,children:"2"})]})}),j.jsxs("div",{className:"text-center",children:[j.jsx("h3",{className:"text-lg font-medium text-white",children:e===1?"邮箱验证":"设置用户信息"}),j.jsx("p",{className:"text-sm text-gray-400 mt-1",children:e===1?"请输入邮箱地址并验证":"请设置您的用户名和密码"})]}),e===1?j.jsxs(j.Fragment,{children:[j.jsxs("div",{children:[j.jsx("div",{className:"block text-sm font-medium text-white mb-2",children:"邮箱"}),j.jsxs("div",{className:"flex space-x-2",children:[j.jsx("input",{type:"email",value:r,onChange:B=>i(B.target.value),onKeyPress:N,className:"flex-1 px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"请输入邮箱地址",disabled:c||s}),j.jsx("div",{onClick:s?void 0:R,className:`px-4 py-3 rounded-lg font-medium transition-colors duration-200 whitespace-nowrap ${c?"bg-gray-600 text-gray-400 cursor-not-allowed":s?"bg-green-600 text-white cursor-default":"bg-blue-600 hover:bg-blue-700 text-white cursor-pointer"}`,children:c?"发送中...":s?"已发送":"获取验证码"})]})]}),s&&j.jsxs("div",{children:[j.jsx("div",{className:"block text-sm font-medium text-white mb-2",children:"验证码"}),j.jsx("input",{type:"text",value:a,onChange:B=>o(B.target.value.replace(/\D/g,"").slice(0,6)),onKeyPress:N,className:"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-center text-lg tracking-widest",placeholder:"请输入6位验证码",maxLength:6,disabled:u})]}),s&&j.jsxs("div",{className:"flex space-x-3",children:[j.jsx("div",{onClick:()=>{g===0&&(l(!1),o(""),R())},className:`flex-1 flex items-center justify-center py-3 px-4 font-medium rounded-lg transition-colors duration-200 ${g>0?"bg-gray-600 text-gray-400 cursor-not-allowed":"bg-gray-600 hover:bg-gray-700 text-white cursor-pointer"}`,children:g>0?`重新发送(${g}s)`:"重新发送"}),j.jsx("div",{onClick:O,className:`flex-1 flex items-center justify-center font-medium py-3 px-4 rounded-lg transition-colors duration-200 ${u?"bg-gray-600 text-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 text-white cursor-pointer"}`,children:u?"验证中...":"验证"})]})]}):j.jsxs(j.Fragment,{children:[j.jsxs("div",{children:[j.jsx("div",{className:"block text-sm font-medium text-white mb-2",children:"用户名"}),j.jsx("input",{type:"text",value:y,onChange:B=>v(B.target.value),onKeyPress:N,className:"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"请输入用户名（至少3个字符）",disabled:_})]}),j.jsxs("div",{children:[j.jsx("div",{className:"block text-sm font-medium text-white mb-2",children:"密码"}),j.jsx("input",{type:"password",value:x,onChange:B=>w(B.target.value),onKeyPress:N,className:"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"请输入密码（至少6个字符）",disabled:_})]}),j.jsxs("div",{children:[j.jsx("div",{className:"block text-sm font-medium text-white mb-2",children:"确认密码"}),j.jsx("input",{type:"password",value:S,onChange:B=>T(B.target.value),onKeyPress:N,className:"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"请再次输入密码",disabled:_})]}),j.jsxs("div",{className:"flex space-x-3",children:[j.jsx("div",{onClick:A,className:"flex-1 flex items-center justify-center py-3 px-4 bg-gray-600 hover:bg-gray-700 text-white font-medium rounded-lg cursor-pointer transition-colors duration-200",children:"返回上一步"}),j.jsx("div",{onClick:P,className:`flex-1 flex items-center justify-center font-medium py-3 px-4 rounded-lg transition-colors duration-200 ${_?"bg-gray-600 text-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 text-white cursor-pointer"}`,children:_?"注册中...":"完成注册"})]})]})]})};function MHe(){const[t,e]=H.useState(!1),n=()=>{e(!1)};return j.jsx("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center",children:j.jsxs("div",{className:"max-w-xl w-full mx-auto p-8",children:[j.jsx("div",{className:"text-center mb-4",children:j.jsx("h1",{className:"text-3xl font-bold text-white",children:"医学图像信息管理与标注系统"})}),j.jsxs("div",{className:"bg-gray-800 rounded-lg p-6",children:[j.jsxs("div",{className:"flex mb-6",children:[j.jsx("button",{onClick:()=>e(!1),className:`flex-1 py-2 px-4 cursor-pointer text-sm font-medium rounded-l-lg transition-colors ${t?"bg-gray-700 text-gray-300 hover:bg-gray-600":"bg-blue-600 text-white"}`,children:"登录"}),j.jsx("button",{onClick:()=>e(!0),className:`flex-1 py-2 px-4 cursor-pointer text-sm font-medium rounded-r-lg transition-colors ${t?"bg-blue-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,children:"注册"})]}),t?j.jsx(OHe,{onRegisterSuccess:n}):j.jsx(SHe,{})]})]})})}const IHe=()=>{const t=Ec(),{userInfo:e}=jf();return H.useEffect(()=>{e&&e?.role!==1&&(Nt({color:"danger",description:"您没有权限访问管理端"}),t("/list"))},[e,t]),{isAdmin:e?.role===1,userInfo:e}},RHe=({students:t,loading:e,onRoleChange:n,onResetPassword:r})=>{const i=o=>{switch(o){case 1:return"bg-red-500 text-white";case 2:return"bg-blue-500 text-white";case 3:return"bg-green-500 text-white";default:return"bg-gray-500 text-white"}},a=o=>{switch(o){case 1:return"管理员";case 2:return"老师";case 3:return"学生";default:return"未知"}};return e?j.jsx("div",{className:"p-6 text-center",children:j.jsx("div",{className:"text-gray-500",children:"加载中..."})}):j.jsxs("div",{className:"overflow-x-auto",children:[j.jsxs("table",{className:"w-full",children:[j.jsx("thead",{className:"bg-gray-50",children:j.jsxs("tr",{children:[j.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"用户信息"}),j.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"邮箱"}),j.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"角色"}),j.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"创建时间"}),j.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"操作"})]})}),j.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t?.map(o=>j.jsxs("tr",{className:"hover:bg-gray-50",children:[j.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:j.jsxs("div",{className:"flex items-center",children:[j.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center",children:j.jsx("span",{className:"text-white text-sm font-semibold",children:o.username.charAt(0)})}),j.jsxs("div",{className:"ml-4",children:[j.jsx("div",{className:"text-sm font-medium text-gray-900",children:o.username}),j.jsxs("div",{className:"text-sm text-gray-500",children:["ID: ",o.user_id]})]})]})}),j.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:j.jsx("div",{className:"text-sm text-gray-900",children:o.email})}),j.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:j.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${i(o.role)}`,children:a(o.role)})}),j.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(o.created_at).toLocaleDateString()}),j.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:j.jsxs("div",{className:"flex items-center space-x-2",children:[j.jsx("button",{onClick:()=>n?.(o.user_id,2),className:"px-3 py-1 bg-blue-500 text-white text-xs rounded-md hover:bg-blue-600 transition-colors",children:"设为老师"}),j.jsx("button",{onClick:()=>r?.(o.user_id),className:"px-3 py-1 bg-yellow-500 text-white text-xs rounded-md hover:bg-yellow-600 transition-colors",children:"重置密码"})]})})]},o.user_id))})]}),(!t||t.length===0)&&j.jsx("div",{className:"p-6 text-center text-gray-500",children:"暂无学生用户"})]})},PHe=()=>{const{isAdmin:t}=IHe(),[e,n]=H.useState([]),[r,i]=H.useState(!0),[a,o]=H.useState(""),[s,l]=H.useState("all"),[c,f]=H.useState(1),[u]=H.useState(10),[d,h]=H.useState(0),[p,g]=H.useState(0);if(!t)return j.jsx("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:j.jsx("div",{className:"text-center",children:j.jsx("div",{className:"text-gray-500",children:"检查权限中..."})})});const m=async(S=a,T=s,_=c)=>{i(!0);try{const D={page:_,per_page:u};S&&(D.keyword=S);const I=await yye(D);console.log("API Response:",I),I.success&&I.data?(n(I.data.list||[]),h(I.data.pagination.total||0),g(I.data.pagination.last_page||0),f(I.data.pagination.current_page||1)):(n([]),h(0),g(0),Nt({color:"danger",description:I.message||"获取学生用户列表失败"}))}catch{n([]),h(0),g(0),Nt({color:"danger",description:"网络错误，请重试"})}finally{i(!1)}},y=S=>{o(S),f(1)},v=S=>{f(S)},x=async(S,T)=>{try{const _=await xye(S,T);_.success?(Nt({color:"success",description:`用户 ${_.data.username} 的角色已从 ${_.data.old_role_name} 修改为 ${_.data.new_role_name}`}),m()):Nt({color:"danger",description:_.message||"权限更新失败"})}catch{Nt({color:"danger",description:"网络错误，请重试"})}},w=async S=>{if(confirm(`确定要重置用户 ID: ${S} 的密码吗？`))try{const T=await bye(S);T.success?(Nt({color:"success",description:"密码重置成功"}),alert(`用户 ${T.data.username} (${T.data.email}) 的密码已重置为: ${T.data.new_password}`)):Nt({color:"danger",description:T.message||"密码重置失败"})}catch{Nt({color:"danger",description:"密码重置失败，请重试"})}};return H.useEffect(()=>{const S=setTimeout(()=>{m(a,s,c)},300);return()=>clearTimeout(S)},[a,s,c]),j.jsx("div",{className:"min-h-screen bg-gray-100 p-6",children:j.jsxs("div",{className:"max-w-7xl mx-auto",children:[j.jsx("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:j.jsx("div",{className:"flex flex-col md:flex-row gap-4",children:j.jsxs("div",{className:"flex-1",children:[j.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"搜索用户"}),j.jsx("input",{type:"text",value:a,onChange:S=>y(S.target.value),className:"w-full px-4 outline-none py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"输入关键词搜索用户..."})]})})}),j.jsxs("div",{className:"bg-white rounded-lg shadow",children:[j.jsx("div",{className:"p-6 border-b border-gray-200",children:j.jsxs("h2",{className:"text-lg font-semibold text-gray-800",children:["学生用户列表 (",d,")"]})}),j.jsx(RHe,{students:e,loading:r,onRoleChange:x,onResetPassword:w}),!r&&j.jsx("div",{className:"flex flex-col sm:flex-row justify-center items-center px-6 py-5 border-t border-gray-200",children:j.jsx(OC,{total:p,page:c,onChange:v,showControls:!0,size:"md",color:"primary",variant:"flat",radius:"md",classNames:{wrapper:"gap-4 overflow-visible h-12",item:"w-12 h-12 text-base cursor-pointer",cursor:"w-12 h-12 text-base cursor-pointer",prev:"w-12 h-12 text-base cursor-pointer",next:"w-12 h-12 text-base cursor-pointer",ellipsis:"w-12 h-12 text-base cursor-pointer"}})})]})]})})};function AHe(){const t=Ec(),{userInfo:e,canUpload:n}=qh(),r=H.useRef(null),[i,a]=H.useState(""),[o,s]=H.useState("1"),[l,c]=H.useState([]),[f,u]=H.useState(""),[d,h]=H.useState([]),[p,g]=H.useState(!1),[m,y]=H.useState(!1),[v,x]=H.useState(null),w=async()=>{try{const U=await wye();U.success?x(!0):(x(!1),Nt({color:"warning",description:U.message||"OSS连接异常"}))}catch{x(!1),Nt({color:"danger",description:"OSS连接检查失败"})}};H.useEffect(()=>{n&&(console.log("canUpload",n),w())},[n]);const S=U=>{if(!U)return;const G=Array.from(U).filter(Q=>Q.name.toLowerCase().endsWith(".dcm")||Q.name.toLowerCase().endsWith(".dicom"));if(G.length===0){Nt({color:"warning",description:"请选择有效的 DICOM 文件（.dcm 或 .dicom 格式）"});return}const F=G.filter(Q=>Q.size>10*1024*1024);if(F.length>0){Nt({color:"danger",description:`以下文件超过1MB限制：${F.map(Q=>Q.name).join(", ")}`});return}const J=G.map(Q=>({file:Q,id:`${Date.now()}-${Math.random()}`,status:"pending"}));h(Q=>[...Q,...J]),J.forEach(Q=>O(Q))},T=U=>{U.preventDefault(),U.stopPropagation(),U.type==="dragenter"||U.type==="dragover"?y(!0):U.type==="dragleave"&&y(!1)},_=U=>{U.preventDefault(),U.stopPropagation(),y(!1),U.dataTransfer.files&&U.dataTransfer.files[0]&&S(U.dataTransfer.files)},D=[{key:"1",label:"X光影像"},{key:"2",label:"CT"},{key:"3",label:"MRI"},{key:"4",label:"超声"},{key:"5",label:"PET"},{key:"6",label:"病理图像"}],I=()=>{f.trim()&&!l.includes(f.trim())&&l.length<3&&(c([...l,f.trim()]),u(""))},R=U=>{c(l.filter(G=>G!==U))},O=async U=>{h(G=>G.map(F=>F.id===U.id?{...F,status:"uploading"}:F));try{const G=await Cye(U.file);if(G.success)h(F=>F.map(J=>J.id===U.id?{...J,status:"success",uploadedUrl:G.file_url,uploadedData:G}:J));else throw new Error("上传失败")}catch(G){h(F=>F.map(J=>J.id===U.id?{...J,status:"error"}:J)),Nt({color:"danger",description:`文件 ${U.file.name} 上传失败: ${G instanceof Error?G.message:"未知错误"}`})}},P=async()=>{if(!i.trim()){Nt({color:"danger",description:"请输入数据集名称"});return}if(!o){Nt({color:"danger",description:"请选择大分类"});return}if(d.length===0){Nt({color:"danger",description:"请选择要上传的文件"});return}if(d.filter(F=>F.status==="uploading").length>0){Nt({color:"warning",description:"有文件正在上传中，请等待上传完成"});return}if(d.filter(F=>F.status==="error").length>0){Nt({color:"danger",description:"有文件上传失败，请重新上传或删除失败的文件"});return}if(!e?.user_id){Nt({color:"danger",description:"用户信息错误，请重新登录"});return}v===!1&&Nt({color:"warning",description:"OSS连接异常，但仍可尝试提交"}),g(!0);try{const F=d.filter(ve=>ve.status==="success");if(F.length===0){Nt({color:"danger",description:"没有成功上传的文件"});return}if(F.filter(ve=>!ve.uploadedData).length>0){Nt({color:"danger",description:"有文件上传数据不完整，请重新上传"});return}const Q=Number(o),ne={name:i,category:Q,remark:l.join(","),files:F.map(ve=>({file_name:ve.uploadedData.file_name,file_path:ve.uploadedData.file_path,file_url:ve.uploadedData.file_url,file_size:ve.uploadedData.file_size,original_annotation:""}))};console.log("🚀 ~ handleSubmit ~ str:",ne);const ye=await uHe(ne);ye.success?(Nt({color:"success",description:"数据集创建成功！已可供学生使用"}),setTimeout(()=>{t("/list")},2e3)):Nt({color:"danger",description:ye.message||"数据集创建失败"})}catch(F){console.error("提交错误:",F),Nt({color:"danger",description:"网络错误，请重试"})}finally{g(!1)}},N=U=>{p||h(G=>G.filter(F=>F.id!==U))},A=()=>{p||h([])},B=U=>{if(U===0)return"0 Bytes";const G=1024,F=["Bytes","KB","MB","GB"],J=Math.floor(Math.log(U)/Math.log(G));return parseFloat((U/Math.pow(G,J)).toFixed(2))+" "+F[J]},V=U=>{switch(U){case"pending":return"default";case"uploading":return"primary";case"success":return"success";case"error":return"danger";default:return"default"}},$=U=>{switch(U){case"pending":return"等待上传";case"uploading":return"上传中";case"success":return"上传成功";case"error":return"上传失败";default:return"未知状态"}};return j.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 p-4 sm:p-6",children:j.jsxs("div",{className:"max-w-6xl mx-auto",children:[j.jsxs("div",{className:"mb-8",children:[j.jsxs("div",{className:"text-center mb-8",children:[j.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full mb-4",children:j.jsx("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:j.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})})}),j.jsx("h1",{className:"text-4xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent mb-3",children:"上传 DICOM 数据集"})]}),j.jsx(tu,{className:"mb-8 shadow-lg border-0 bg-white/80 backdrop-blur-sm",children:j.jsx(eu,{className:"py-4",children:j.jsxs("div",{className:"flex items-center justify-between",children:[j.jsx("div",{className:"flex items-center space-x-4",children:j.jsxs("div",{className:"flex items-center space-x-3",children:[j.jsx("div",{className:`w-4 h-4 rounded-full shadow-sm ${v===!0?"bg-green-500 animate-pulse":v===!1?"bg-red-500":"bg-yellow-500 animate-pulse"}`}),j.jsxs("span",{className:"text-sm font-semibold text-gray-700",children:["OSS存储状态：",v===!0&&j.jsx("span",{className:"text-green-600 ml-2 font-medium",children:"✓ 连接正常"}),v===!1&&j.jsx("span",{className:"text-red-600 ml-2 font-medium",children:"✗ 连接异常"}),v===null&&j.jsx("span",{className:"text-yellow-600 ml-2 font-medium",children:"⏳ 检查中..."})]})]})}),j.jsx(qr,{size:"sm",variant:"flat",color:"primary",onClick:w,isLoading:v===null,className:"shadow-md hover:shadow-lg transition-all duration-200","aria-label":"重新检测OSS连接状态",children:"重新检测"})]})})})]}),j.jsxs("div",{className:"grid gap-8 lg:grid-cols-2",children:[j.jsx("div",{className:"space-y-6",children:j.jsxs(tu,{className:"shadow-lg border-0 bg-white/90 backdrop-blur-sm hover:shadow-xl transition-all duration-300",children:[j.jsx(e_,{className:"pb-4",children:j.jsxs("div",{className:"flex items-center space-x-3",children:[j.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-purple-600 rounded-lg flex items-center justify-center",children:j.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:j.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),j.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"数据集信息"})]})}),j.jsxs(eu,{className:"space-y-6",children:[j.jsxs("div",{className:"space-y-2",children:[j.jsxs("label",{className:"text-sm font-medium text-gray-700",htmlFor:"dataset-name",children:["数据集名称 ",j.jsx("span",{className:"text-red-500",children:"*"})]}),j.jsx(U2,{id:"dataset-name",placeholder:"请输入数据集名称，例如：胸部CT影像-案例01",value:i,onValueChange:a,variant:"bordered","aria-label":"数据集名称"}),j.jsx("p",{className:"text-xs text-gray-500",children:"给您的数据集起一个清晰、描述性的名称"})]}),j.jsxs("div",{className:"space-y-2",children:[j.jsxs("label",{className:"text-sm font-medium text-gray-700",htmlFor:"image-type",children:["医学影像类型 ",j.jsx("span",{className:"text-red-500",children:"*"})]}),j.jsx(AK,{id:"image-type",placeholder:"请选择医学影像类型",selectedKeys:o?[o]:[],onSelectionChange:U=>{const G=Array.from(U)[0];s(G||"")},variant:"bordered","aria-label":"医学影像类型",classNames:{trigger:"min-h-12",value:"text-foreground"},children:D.map(U=>j.jsx(MK,{children:U.label},U.key))}),j.jsx("p",{className:"text-xs text-gray-500",children:"选择此数据集的医学影像类型"})]}),j.jsx("div",{className:"space-y-3",children:j.jsxs("div",{className:"space-y-2",children:[j.jsxs("label",{className:"text-sm font-medium text-gray-700",htmlFor:"tag-input",children:["添加标签 ",j.jsx("span",{className:"text-gray-400",children:"(可选)"})]}),j.jsxs("div",{className:"flex items-center space-x-2",children:[j.jsx(U2,{id:"tag-input",placeholder:"输入标签名称",value:f,onValueChange:u,onKeyDown:U=>{U.key==="Enter"&&(U.preventDefault(),I())},variant:"bordered",className:"flex-1","aria-label":"添加标签"}),j.jsx(qr,{size:"lg",color:"primary",variant:"flat",onClick:I,isDisabled:!f.trim()||l.length>=3,"aria-label":"添加标签到列表",children:"添加"})]}),j.jsxs("p",{className:"text-xs text-gray-500",children:["最多可添加3个标签，当前已添加",l.length,"个 (可选)"]})]})}),l.length>0&&j.jsx("div",{className:"flex flex-wrap gap-2",children:l.map(U=>j.jsx(F2,{color:"primary",variant:"flat",onClose:()=>R(U),children:U},U))})]})]})}),j.jsx("div",{className:"space-y-6",children:j.jsxs(tu,{className:"shadow-lg border-0 bg-white/90 backdrop-blur-sm hover:shadow-xl transition-all duration-300",children:[j.jsx(e_,{className:"pb-4",children:j.jsxs("div",{className:"flex justify-between items-center w-full",children:[j.jsxs("div",{className:"flex items-center space-x-3",children:[j.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-green-500 to-blue-600 rounded-lg flex items-center justify-center",children:j.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:j.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})})}),j.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"文件上传"})]}),d.length>0&&j.jsx(qr,{size:"sm",color:"danger",variant:"flat",onClick:A,isDisabled:p,className:"shadow-md hover:shadow-lg transition-all duration-200","aria-label":"清空所有已选择的文件",children:"清空所有文件"})]})}),j.jsxs(eu,{children:[j.jsx("div",{className:`border-2 border-dashed rounded-xl p-8 text-center transition-all duration-300 ${m?"border-blue-500 bg-blue-50 shadow-lg scale-105":d.length===0?"border-gray-300 hover:border-blue-400 hover:bg-blue-50/50":"border-gray-200 bg-gray-50"}`,onDragEnter:T,onDragLeave:T,onDragOver:T,onDrop:_,children:j.jsxs("div",{className:"space-y-6",children:[j.jsx("div",{className:`mx-auto w-20 h-20 rounded-full flex items-center justify-center transition-all duration-300 ${m?"bg-gradient-to-r from-blue-500 to-purple-600 scale-110":"bg-gradient-to-r from-gray-100 to-gray-200"}`,children:j.jsx("svg",{className:`w-10 h-10 transition-all duration-300 ${m?"text-white":"text-gray-400"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:j.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})})}),j.jsxs("div",{children:[j.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-3",children:m?"放开以选择文件":"选择 DICOM 文件"}),j.jsxs("p",{className:"text-gray-600 mb-6 leading-relaxed",children:["支持"," ",j.jsx("span",{className:"font-semibold text-blue-600",children:".dcm"})," ","和"," ",j.jsx("span",{className:"font-semibold text-blue-600",children:".dicom"})," ","格式",j.jsx("br",{}),"可选择多个文件，单个文件大小不超过 10MB"]}),j.jsx(qr,{color:"primary",size:"lg",onClick:()=>r.current?.click(),isDisabled:p,className:"shadow-lg hover:shadow-xl transition-all duration-200 bg-gradient-to-r from-blue-500 to-purple-600","aria-label":"选择DICOM文件上传",startContent:j.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:j.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),children:"选择文件"}),j.jsx("p",{className:"text-sm text-gray-500 mt-4 font-medium",children:"💡 或拖拽文件到此区域"})]})]})}),j.jsx("input",{ref:r,type:"file",multiple:!0,accept:".dcm,.dicom",onChange:U=>S(U.target.files),className:"hidden","aria-label":"选择DICOM文件上传"}),d.length>0&&j.jsxs("div",{className:"mt-8",children:[j.jsxs("div",{className:"flex justify-between items-center mb-6",children:[j.jsxs("div",{className:"flex items-center space-x-3",children:[j.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-green-500 to-blue-600 rounded-lg flex items-center justify-center",children:j.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:j.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),j.jsxs("h3",{className:"text-lg font-bold text-gray-800",children:["已选择的文件 (",d.length,")"]})]}),j.jsxs("div",{className:"text-sm font-semibold text-gray-600 bg-gray-100 px-3 py-1 rounded-full",children:["总大小:"," ",B(d.reduce((U,G)=>U+G.file.size,0))]})]}),j.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:d.map(U=>j.jsx(tu,{className:"border border-gray-200 shadow-sm hover:shadow-md transition-all duration-200 bg-white/80 backdrop-blur-sm",children:j.jsx(eu,{className:"p-2",children:j.jsxs("div",{className:"flex items-center justify-between",children:[j.jsxs("div",{className:"flex-1 min-w-0",children:[j.jsxs("div",{className:"flex items-center space-x-3",children:[j.jsx("div",{className:"w-6 h-6 bg-primary-100 rounded-md flex items-center justify-center",children:j.jsx("svg",{className:"w-3 h-3 text-primary-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:j.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),j.jsxs("div",{children:[j.jsx("p",{className:"text-xs font-medium text-gray-900 truncate",children:U.file.name}),j.jsx("p",{className:"text-xs text-gray-500",children:B(U.file.size)})]})]}),U.status==="uploading"&&j.jsx("div",{className:"mt-1",children:j.jsxs("div",{className:"flex items-center space-x-1",children:[j.jsx("div",{className:"w-3 h-3 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"}),j.jsx("span",{className:"text-xs text-blue-600",children:"上传中..."})]})})]}),j.jsxs("div",{className:"flex items-center space-x-1",children:[j.jsx(F2,{color:V(U.status),size:"sm",variant:"flat",children:$(U.status)}),U.status==="pending"&&j.jsx(qr,{size:"sm",color:"danger",variant:"light",onClick:()=>N(U.id),isDisabled:p,isIconOnly:!0,"aria-label":`删除文件 ${U.file.name}`,children:j.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:j.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}),U.status==="error"&&j.jsxs("div",{className:"flex space-x-0.5",children:[j.jsx(qr,{size:"sm",color:"primary",variant:"flat",onClick:()=>O(U),isDisabled:p,isIconOnly:!0,"aria-label":`重新上传文件 ${U.file.name}`,children:j.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:j.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),j.jsx(qr,{size:"sm",color:"danger",variant:"light",onClick:()=>N(U.id),isDisabled:p,isIconOnly:!0,"aria-label":`删除文件 ${U.file.name}`,children:j.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:j.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]})]})})},U.id))})]})]})]})})]}),j.jsx(tu,{className:"mt-8 shadow-xl border-0 bg-white/90 backdrop-blur-sm",children:j.jsx(eu,{className:"p-6",children:j.jsxs("div",{className:"flex flex-col space-y-6",children:[p&&j.jsx("div",{className:"p-6 bg-gradient-to-r from-blue-50 to-purple-50 border border-blue-200 rounded-xl shadow-lg",children:j.jsxs("div",{className:"flex items-center space-x-4",children:[j.jsx("div",{className:"w-6 h-6 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"}),j.jsxs("div",{children:[j.jsx("p",{className:"text-sm font-bold text-blue-800",children:"🚀 正在创建数据集，请不要关闭页面..."}),j.jsx("p",{className:"text-xs text-blue-600 mt-2",children:"创建完成后您可以在列表中查看，学生也可以访问此数据集"})]})]})}),v===!1&&!p&&j.jsx("div",{className:"p-6 bg-gradient-to-r from-yellow-50 to-orange-50 border border-yellow-200 rounded-xl shadow-lg",children:j.jsxs("div",{className:"flex items-center space-x-4",children:[j.jsx("div",{className:"w-10 h-10 bg-yellow-100 rounded-full flex items-center justify-center",children:j.jsx("svg",{className:"w-5 h-5 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:j.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),j.jsxs("div",{children:[j.jsx("p",{className:"text-sm font-bold text-yellow-800",children:"⚠️ OSS连接异常，但仍可尝试创建数据集"}),j.jsx("p",{className:"text-xs text-yellow-600 mt-2",children:"请检查网络连接或联系管理员"})]})]})}),j.jsxs("div",{className:"flex justify-between items-center",children:[j.jsx(qr,{color:"default",variant:"flat",onClick:()=>t("/list"),isDisabled:p,className:"shadow-md hover:shadow-lg transition-all duration-200","aria-label":"返回数据集列表页面",children:"← 返回列表"}),j.jsx(qr,{color:"primary",size:"lg",onClick:P,isLoading:p,isDisabled:!i.trim()||!o||d.length===0||p||d.length>0&&d[0].status==="uploading"||d.length>0&&d[0].status==="error",className:"shadow-lg hover:shadow-xl transition-all duration-200 bg-gradient-to-r from-blue-500 to-purple-600","aria-label":p?"正在创建数据集":"创建数据集",startContent:!p&&j.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:j.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),children:p?"🚀 创建中...":"✨ 创建数据集"})]})]})})})]})})}function NHe(){const t=Ec(),{id:e}=e$(),{hasTeacherPermission:n}=qh(),{userInfo:r}=jf(),[i,a]=H.useState(null),[o,s]=H.useState(!0),[l,c]=H.useState(!1),[f,u]=H.useState(""),[d,h]=H.useState(""),[p,g]=H.useState([]),[m,y]=H.useState("");H.useEffect(()=>{if(!n){Nt({color:"danger",description:"您没有权限访问此页面"}),t("/list");return}},[n,t]);const v=[{key:"1",label:"X光影像"},{key:"2",label:"CT"},{key:"3",label:"MRI"},{key:"4",label:"超声"},{key:"5",label:"PET"},{key:"6",label:"病理图像"}];H.useEffect(()=>{(async()=>{if(!e){Nt({color:"danger",description:"数据ID无效"}),t("/list");return}s(!0);try{const _=await oye(Number(e));if(_.success&&_.data){const D=_.data;a(D),u(D.name),h(D.category?.toString()||"1");const I=D.remark?D.remark.split(",").filter(R=>R.trim()):[];g(I)}else Nt({color:"danger",description:_.message||"加载数据失败"}),t("/list")}catch(_){console.error("加载数据错误:",_),Nt({color:"danger",description:"加载数据失败"}),t("/list")}finally{s(!1)}})()},[e,t]);const x=()=>{m.trim()&&!p.includes(m.trim())&&p.length<3&&(g([...p,m.trim()]),y(""))},w=T=>{g(p.filter(_=>_!==T))},S=async()=>{if(!f.trim()){Nt({color:"danger",description:"请输入数据集名称"});return}if(!d){Nt({color:"danger",description:"请选择分类"});return}if(!e||!r){Nt({color:"danger",description:"缺少必要参数"});return}c(!0);try{const T=Number(d),_=await sye(Number(e),{name:f.trim(),category:T,remark:p.join(",")});_.success?(Nt({color:"success",description:"保存成功"}),t("/list")):Nt({color:"danger",description:_.message||"保存失败"})}catch(T){console.error("保存错误:",T),Nt({color:"danger",description:"保存失败，请重试"})}finally{c(!1)}};return o?j.jsx("div",{className:"container mx-auto px-4 py-8",children:j.jsx("div",{className:"flex justify-center items-center h-64",children:j.jsx("div",{className:"text-gray-500",children:"加载中..."})})}):i?j.jsx("div",{className:"container mx-auto px-4 py-8",children:j.jsx("div",{className:"max-w-2xl mx-auto",children:j.jsxs(tu,{children:[j.jsx(e_,{className:"pb-4",children:j.jsx("div",{className:"w-full",children:j.jsx("h1",{className:"text-2xl font-bold",children:"编辑数据集"})})}),j.jsxs(eu,{className:"space-y-6",children:[j.jsxs("div",{children:[j.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"数据集名称"}),j.jsx(U2,{value:f,onChange:T=>u(T.target.value),placeholder:"请输入数据集名称",disabled:l})]}),j.jsxs("div",{children:[j.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"文件信息"}),j.jsx("div",{className:"p-3 bg-gray-50 rounded-lg border",children:j.jsxs("div",{className:"flex items-center space-x-2",children:[j.jsx("svg",{className:"w-5 h-5 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:j.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),j.jsxs("span",{className:"text-gray-700",children:["包含"," ",j.jsx("span",{className:"font-semibold text-blue-600",children:i.files?.length||0})," ","个文件"]})]})})]}),j.jsxs("div",{children:[j.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"大分类"}),j.jsx(AK,{selectedKeys:d?[d]:[],onSelectionChange:T=>{const _=Array.from(T)[0];h(_||"")},placeholder:"请选择分类",disabled:l,children:v.map(T=>j.jsx(MK,{children:T.label},T.key))})]}),j.jsxs("div",{children:[j.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"标签 (最多3个)"}),p.length>0&&j.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:p.map((T,_)=>j.jsx(F2,{color:"secondary",variant:"flat",onClose:()=>w(T),size:"sm",children:T},_))}),p.length<3&&j.jsxs("div",{className:"flex space-x-2",children:[j.jsx(U2,{value:m,onChange:T=>y(T.target.value),onKeyPress:T=>{T.key==="Enter"&&x()},placeholder:"输入标签并按回车",disabled:l,className:"flex-1"}),j.jsx(qr,{color:"secondary",variant:"flat",onClick:x,disabled:!m.trim()||l,children:"添加"})]})]}),j.jsxs("div",{className:"flex justify-end space-x-4 pt-4",children:[j.jsx(qr,{color:"default",variant:"flat",onClick:()=>t("/list"),disabled:l,children:"取消"}),j.jsx(qr,{color:"primary",isLoading:l,onClick:S,children:"保存修改"})]})]})]})})}):j.jsx("div",{className:"container mx-auto px-4 py-8",children:j.jsx("div",{className:"flex justify-center items-center h-64",children:j.jsx("div",{className:"text-gray-500",children:"数据不存在"})})})}const Tb=({children:t})=>{const{isAuthenticated:e,getUserInfo:n,accessToken:r,userInfo:i}=jf(),a=Ec();return H.useEffect(()=>{const o=r||localStorage.getItem("access_token");if(o&&!i&&n(),!o){a("/",{replace:!0});return}},[r,i,n,a]),e()?j.jsx(j.Fragment,{children:t}):null},LHe=[{path:"/",element:j.jsx(MHe,{})},{path:"/list",element:j.jsx(Tb,{children:j.jsx(Pp,{children:j.jsx(Eye,{})})})},{path:"/detail/:id",element:j.jsx(Pp,{children:j.jsx(GB,{})})},{path:"/original/:id",element:j.jsx(Pp,{children:j.jsx(GB,{})})},{path:"/admin",element:j.jsx(Tb,{children:j.jsx(Pp,{children:j.jsx(PHe,{})})})},{path:"/upload",element:j.jsx(Tb,{children:j.jsx(Pp,{children:j.jsx(AHe,{})})})},{path:"/edit/:id",element:j.jsx(Tb,{children:j.jsx(Pp,{children:j.jsx(NHe,{})})})}];class kHe{constructor(){this.listeners=[]}subscribe(e){return this.listeners.push(e),()=>{const n=this.listeners.indexOf(e);n>-1&&this.listeners.splice(n,1)}}navigate(e){this.listeners.forEach(n=>n(e))}}const VHe=new kHe,FHe=({children:t})=>{const e=Ec();return H.useEffect(()=>VHe.subscribe(r=>{e(r)}),[e]),j.jsx(j.Fragment,{children:t})};function UHe(){return j.jsx(Poe,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:j.jsx(FHe,{children:j.jsx(BHe,{})})})}const BHe=()=>{const{getUserInfo:t,accessToken:e,userInfo:n}=jf();return H.useEffect(()=>{(e||localStorage.getItem("access_token"))&&!n&&t()},[t,e,n]),j.jsx($He,{})},$He=()=>Yae(LHe);bae.createRoot(document.getElementById("root")).render(j.jsx(H.StrictMode,{children:j.jsxs(Phe,{children:[j.jsx(Rge,{placement:"top-center"}),j.jsx(UHe,{})]})}));export{y6 as $,au as A,mce as B,uG as C,tD as D,F9 as E,kl as F,tx as G,Fde as H,_de as I,uC as J,Vde as K,Sfe as L,Gce as M,vce as N,Uue as O,Zue as P,H as Q,T2 as R,F$ as S,Xle as T,dce as U,cC as V,k9 as W,U9 as X,D2 as Y,zG as Z,zue as _,eA as a,z$ as a$,hfe as a0,tfe as a1,Pi as a2,Fle as a3,qle as a4,fG as a5,Kue as a6,aa as a7,Xce as a8,Jue as a9,es as aA,uue as aB,L9 as aC,Ude as aD,Bde as aE,Mb as aF,HHe as aG,EG as aH,_w as aI,pue as aJ,vue as aK,VG as aL,S2 as aM,FG as aN,Yfe as aO,rue as aP,Jfe as aQ,DA as aR,Rfe as aS,V9 as aT,jHe as aU,L$ as aV,k$ as aW,V$ as aX,my as aY,$9 as aZ,ou as a_,Xue as aa,Wue as ab,qfe as ac,XG as ad,Ew as ae,tce as af,gy as ag,I2 as ah,Rue as ai,GT as aj,mu as ak,aue as al,Aue as am,gce as an,qG as ao,LG as ap,j as aq,lue as ar,dC as as,GHe as at,fC as au,Pm as av,fue as aw,Oh as ax,qv as ay,Tfe as az,q$ as b,oh as b$,G9 as b0,j$ as b1,G$ as b2,j9 as b3,H$ as b4,W$ as b5,vy as b6,ole as b7,K$ as b8,sle as b9,sc as bA,jce as bB,zce as bC,qce as bD,SG as bE,nD as bF,l6 as bG,c6 as bH,ice as bI,fce as bJ,pG as bK,rG as bL,qP as bM,RT as bN,q9 as bO,nG as bP,kle as bQ,Nle as bR,Sw as bS,r6 as bT,Ple as bU,hce as bV,ba as bW,n6 as bX,tg as bY,Mle as bZ,MT as b_,B$ as ba,$$ as bb,Dce as bc,zHe as bd,bce as be,hG as bf,Mce as bg,z9 as bh,W9 as bi,h6 as bj,a6 as bk,Jle as bl,Kv as bm,X9 as bn,Tw as bo,Uce as bp,Z9 as bq,cce as br,Yle as bs,xv as bt,Ece as bu,iG as bv,X$ as bw,WHe as bx,Es as by,wG as bz,kf as c,_2 as c0,e0 as c1,mG as c2,rA as c3,kce as c4,vG as c5,Lce as c6,E2 as c7,Mm as c8,nx as c9,Td as ca,su as cb,WP as cc,ble as cd,wle as ce,gG as cf,yG as cg,Jce as ch,OT as ci,Qd as d,Rm as e,gi as f,xG as g,bG as h,lle as i,uce as j,TG as k,Qc as l,B9 as m,eD as n,uo as o,Cn as p,xh as q,Bce as r,cG as s,Im as t,zP as u,Kle as v,oA as w,lm as x,Po as y,Q9 as z};
