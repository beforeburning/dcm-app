function ere(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const a=Object.getOwnPropertyDescriptor(r,i);a&&Object.defineProperty(t,i,a.get?a:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(i){if(i.ep)return;i.ep=!0;const a=n(i);fetch(i.href,a)}})();var gf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function tl(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function nU(t){if(Object.prototype.hasOwnProperty.call(t,"__esModule"))return t;var e=t.default;if(typeof e=="function"){var n=function r(){var i=!1;try{i=this instanceof r}catch{}return i?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var i=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return t[r]}})}),n}var wS={exports:{}},k1={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nR;function tre(){if(nR)return k1;nR=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function n(r,i,a){var o=null;if(a!==void 0&&(o=""+a),i.key!==void 0&&(o=""+i.key),"key"in i){a={};for(var s in i)s!=="key"&&(a[s]=i[s])}else a=i;return i=a.ref,{$$typeof:t,type:r,key:o,ref:i!==void 0?i:null,props:a}}return k1.Fragment=e,k1.jsx=n,k1.jsxs=n,k1}var rR;function nre(){return rR||(rR=1,wS.exports=tre()),wS.exports}var j=nre(),CS={exports:{}},Un={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var iR;function rre(){if(iR)return Un;iR=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),o=Symbol.for("react.context"),s=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),c=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),u=Symbol.iterator;function d(V){return V===null||typeof V!="object"?null:(V=u&&V[u]||V["@@iterator"],typeof V=="function"?V:null)}var h={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},p=Object.assign,g={};function m(V,X,Q){this.props=V,this.context=X,this.refs=g,this.updater=Q||h}m.prototype.isReactComponent={},m.prototype.setState=function(V,X){if(typeof V!="object"&&typeof V!="function"&&V!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,V,X,"setState")},m.prototype.forceUpdate=function(V){this.updater.enqueueForceUpdate(this,V,"forceUpdate")};function y(){}y.prototype=m.prototype;function v(V,X,Q){this.props=V,this.context=X,this.refs=g,this.updater=Q||h}var x=v.prototype=new y;x.constructor=v,p(x,m.prototype),x.isPureReactComponent=!0;var w=Array.isArray,S={H:null,A:null,T:null,S:null,V:null},T=Object.prototype.hasOwnProperty;function _(V,X,Q,re,ye,me){return Q=me.ref,{$$typeof:t,type:V,key:X,ref:Q!==void 0?Q:null,props:me}}function D(V,X){return _(V.type,X,void 0,void 0,void 0,V.props)}function I(V){return typeof V=="object"&&V!==null&&V.$$typeof===t}function R(V){var X={"=":"=0",":":"=2"};return"$"+V.replace(/[=:]/g,function(Q){return X[Q]})}var M=/\/+/g;function A(V,X){return typeof V=="object"&&V!==null&&V.key!=null?R(""+V.key):X.toString(36)}function L(){}function P(V){switch(V.status){case"fulfilled":return V.value;case"rejected":throw V.reason;default:switch(typeof V.status=="string"?V.then(L,L):(V.status="pending",V.then(function(X){V.status==="pending"&&(V.status="fulfilled",V.value=X)},function(X){V.status==="pending"&&(V.status="rejected",V.reason=X)})),V.status){case"fulfilled":return V.value;case"rejected":throw V.reason}}throw V}function B(V,X,Q,re,ye){var me=typeof V;(me==="undefined"||me==="boolean")&&(V=null);var Ce=!1;if(V===null)Ce=!0;else switch(me){case"bigint":case"string":case"number":Ce=!0;break;case"object":switch(V.$$typeof){case t:case e:Ce=!0;break;case f:return Ce=V._init,B(Ce(V._payload),X,Q,re,ye)}}if(Ce)return ye=ye(V),Ce=re===""?"."+A(V,0):re,w(ye)?(Q="",Ce!=null&&(Q=Ce.replace(M,"$&/")+"/"),B(ye,X,Q,"",function(De){return De})):ye!=null&&(I(ye)&&(ye=D(ye,Q+(ye.key==null||V&&V.key===ye.key?"":(""+ye.key).replace(M,"$&/")+"/")+Ce)),X.push(ye)),1;Ce=0;var we=re===""?".":re+":";if(w(V))for(var Ae=0;Ae<V.length;Ae++)re=V[Ae],me=we+A(re,Ae),Ce+=B(re,X,Q,me,ye);else if(Ae=d(V),typeof Ae=="function")for(V=Ae.call(V),Ae=0;!(re=V.next()).done;)re=re.value,me=we+A(re,Ae++),Ce+=B(re,X,Q,me,ye);else if(me==="object"){if(typeof V.then=="function")return B(P(V),X,Q,re,ye);throw X=String(V),Error("Objects are not valid as a React child (found: "+(X==="[object Object]"?"object with keys {"+Object.keys(V).join(", ")+"}":X)+"). If you meant to render a collection of children, use an array instead.")}return Ce}function U(V,X,Q){if(V==null)return V;var re=[],ye=0;return B(V,re,"","",function(me){return X.call(Q,me,ye++)}),re}function G(V){if(V._status===-1){var X=V._result;X=X(),X.then(function(Q){(V._status===0||V._status===-1)&&(V._status=1,V._result=Q)},function(Q){(V._status===0||V._status===-1)&&(V._status=2,V._result=Q)}),V._status===-1&&(V._status=0,V._result=X)}if(V._status===1)return V._result.default;throw V._result}var F=typeof reportError=="function"?reportError:function(V){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var X=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof V=="object"&&V!==null&&typeof V.message=="string"?String(V.message):String(V),error:V});if(!window.dispatchEvent(X))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",V);return}console.error(V)};function $(){}return Un.Children={map:U,forEach:function(V,X,Q){U(V,function(){X.apply(this,arguments)},Q)},count:function(V){var X=0;return U(V,function(){X++}),X},toArray:function(V){return U(V,function(X){return X})||[]},only:function(V){if(!I(V))throw Error("React.Children.only expected to receive a single React element child.");return V}},Un.Component=m,Un.Fragment=n,Un.Profiler=i,Un.PureComponent=v,Un.StrictMode=r,Un.Suspense=l,Un.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=S,Un.__COMPILER_RUNTIME={__proto__:null,c:function(V){return S.H.useMemoCache(V)}},Un.cache=function(V){return function(){return V.apply(null,arguments)}},Un.cloneElement=function(V,X,Q){if(V==null)throw Error("The argument must be a React element, but you passed "+V+".");var re=p({},V.props),ye=V.key,me=void 0;if(X!=null)for(Ce in X.ref!==void 0&&(me=void 0),X.key!==void 0&&(ye=""+X.key),X)!T.call(X,Ce)||Ce==="key"||Ce==="__self"||Ce==="__source"||Ce==="ref"&&X.ref===void 0||(re[Ce]=X[Ce]);var Ce=arguments.length-2;if(Ce===1)re.children=Q;else if(1<Ce){for(var we=Array(Ce),Ae=0;Ae<Ce;Ae++)we[Ae]=arguments[Ae+2];re.children=we}return _(V.type,ye,void 0,void 0,me,re)},Un.createContext=function(V){return V={$$typeof:o,_currentValue:V,_currentValue2:V,_threadCount:0,Provider:null,Consumer:null},V.Provider=V,V.Consumer={$$typeof:a,_context:V},V},Un.createElement=function(V,X,Q){var re,ye={},me=null;if(X!=null)for(re in X.key!==void 0&&(me=""+X.key),X)T.call(X,re)&&re!=="key"&&re!=="__self"&&re!=="__source"&&(ye[re]=X[re]);var Ce=arguments.length-2;if(Ce===1)ye.children=Q;else if(1<Ce){for(var we=Array(Ce),Ae=0;Ae<Ce;Ae++)we[Ae]=arguments[Ae+2];ye.children=we}if(V&&V.defaultProps)for(re in Ce=V.defaultProps,Ce)ye[re]===void 0&&(ye[re]=Ce[re]);return _(V,me,void 0,void 0,null,ye)},Un.createRef=function(){return{current:null}},Un.forwardRef=function(V){return{$$typeof:s,render:V}},Un.isValidElement=I,Un.lazy=function(V){return{$$typeof:f,_payload:{_status:-1,_result:V},_init:G}},Un.memo=function(V,X){return{$$typeof:c,type:V,compare:X===void 0?null:X}},Un.startTransition=function(V){var X=S.T,Q={};S.T=Q;try{var re=V(),ye=S.S;ye!==null&&ye(Q,re),typeof re=="object"&&re!==null&&typeof re.then=="function"&&re.then($,F)}catch(me){F(me)}finally{S.T=X}},Un.unstable_useCacheRefresh=function(){return S.H.useCacheRefresh()},Un.use=function(V){return S.H.use(V)},Un.useActionState=function(V,X,Q){return S.H.useActionState(V,X,Q)},Un.useCallback=function(V,X){return S.H.useCallback(V,X)},Un.useContext=function(V){return S.H.useContext(V)},Un.useDebugValue=function(){},Un.useDeferredValue=function(V,X){return S.H.useDeferredValue(V,X)},Un.useEffect=function(V,X,Q){var re=S.H;if(typeof Q=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return re.useEffect(V,X)},Un.useId=function(){return S.H.useId()},Un.useImperativeHandle=function(V,X,Q){return S.H.useImperativeHandle(V,X,Q)},Un.useInsertionEffect=function(V,X){return S.H.useInsertionEffect(V,X)},Un.useLayoutEffect=function(V,X){return S.H.useLayoutEffect(V,X)},Un.useMemo=function(V,X){return S.H.useMemo(V,X)},Un.useOptimistic=function(V,X){return S.H.useOptimistic(V,X)},Un.useReducer=function(V,X,Q){return S.H.useReducer(V,X,Q)},Un.useRef=function(V){return S.H.useRef(V)},Un.useState=function(V){return S.H.useState(V)},Un.useSyncExternalStore=function(V,X,Q){return S.H.useSyncExternalStore(V,X,Q)},Un.useTransition=function(){return S.H.useTransition()},Un.version="19.1.1",Un}var aR;function aw(){return aR||(aR=1,CS.exports=rre()),CS.exports}var H=aw();const Tn=tl(H);var SS={exports:{}},V1={},TS={exports:{}},ES={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oR;function ire(){return oR||(oR=1,(function(t){function e(U,G){var F=U.length;U.push(G);e:for(;0<F;){var $=F-1>>>1,V=U[$];if(0<i(V,G))U[$]=G,U[F]=V,F=$;else break e}}function n(U){return U.length===0?null:U[0]}function r(U){if(U.length===0)return null;var G=U[0],F=U.pop();if(F!==G){U[0]=F;e:for(var $=0,V=U.length,X=V>>>1;$<X;){var Q=2*($+1)-1,re=U[Q],ye=Q+1,me=U[ye];if(0>i(re,F))ye<V&&0>i(me,re)?(U[$]=me,U[ye]=F,$=ye):(U[$]=re,U[Q]=F,$=Q);else if(ye<V&&0>i(me,F))U[$]=me,U[ye]=F,$=ye;else break e}}return G}function i(U,G){var F=U.sortIndex-G.sortIndex;return F!==0?F:U.id-G.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;t.unstable_now=function(){return a.now()}}else{var o=Date,s=o.now();t.unstable_now=function(){return o.now()-s}}var l=[],c=[],f=1,u=null,d=3,h=!1,p=!1,g=!1,m=!1,y=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;function w(U){for(var G=n(c);G!==null;){if(G.callback===null)r(c);else if(G.startTime<=U)r(c),G.sortIndex=G.expirationTime,e(l,G);else break;G=n(c)}}function S(U){if(g=!1,w(U),!p)if(n(l)!==null)p=!0,T||(T=!0,A());else{var G=n(c);G!==null&&B(S,G.startTime-U)}}var T=!1,_=-1,D=5,I=-1;function R(){return m?!0:!(t.unstable_now()-I<D)}function M(){if(m=!1,T){var U=t.unstable_now();I=U;var G=!0;try{e:{p=!1,g&&(g=!1,v(_),_=-1),h=!0;var F=d;try{t:{for(w(U),u=n(l);u!==null&&!(u.expirationTime>U&&R());){var $=u.callback;if(typeof $=="function"){u.callback=null,d=u.priorityLevel;var V=$(u.expirationTime<=U);if(U=t.unstable_now(),typeof V=="function"){u.callback=V,w(U),G=!0;break t}u===n(l)&&r(l),w(U)}else r(l);u=n(l)}if(u!==null)G=!0;else{var X=n(c);X!==null&&B(S,X.startTime-U),G=!1}}break e}finally{u=null,d=F,h=!1}G=void 0}}finally{G?A():T=!1}}}var A;if(typeof x=="function")A=function(){x(M)};else if(typeof MessageChannel<"u"){var L=new MessageChannel,P=L.port2;L.port1.onmessage=M,A=function(){P.postMessage(null)}}else A=function(){y(M,0)};function B(U,G){_=y(function(){U(t.unstable_now())},G)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(U){U.callback=null},t.unstable_forceFrameRate=function(U){0>U||125<U?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<U?Math.floor(1e3/U):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_next=function(U){switch(d){case 1:case 2:case 3:var G=3;break;default:G=d}var F=d;d=G;try{return U()}finally{d=F}},t.unstable_requestPaint=function(){m=!0},t.unstable_runWithPriority=function(U,G){switch(U){case 1:case 2:case 3:case 4:case 5:break;default:U=3}var F=d;d=U;try{return G()}finally{d=F}},t.unstable_scheduleCallback=function(U,G,F){var $=t.unstable_now();switch(typeof F=="object"&&F!==null?(F=F.delay,F=typeof F=="number"&&0<F?$+F:$):F=$,U){case 1:var V=-1;break;case 2:V=250;break;case 5:V=1073741823;break;case 4:V=1e4;break;default:V=5e3}return V=F+V,U={id:f++,callback:G,priorityLevel:U,startTime:F,expirationTime:V,sortIndex:-1},F>$?(U.sortIndex=F,e(c,U),n(l)===null&&U===n(c)&&(g?(v(_),_=-1):g=!0,B(S,F-$))):(U.sortIndex=V,e(l,U),p||h||(p=!0,T||(T=!0,A()))),U},t.unstable_shouldYield=R,t.unstable_wrapCallback=function(U){var G=d;return function(){var F=d;d=G;try{return U.apply(this,arguments)}finally{d=F}}}})(ES)),ES}var sR;function are(){return sR||(sR=1,TS.exports=ire()),TS.exports}var _S={exports:{}},xo={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lR;function ore(){if(lR)return xo;lR=1;var t=aw();function e(l){var c="https://react.dev/errors/"+l;if(1<arguments.length){c+="?args[]="+encodeURIComponent(arguments[1]);for(var f=2;f<arguments.length;f++)c+="&args[]="+encodeURIComponent(arguments[f])}return"Minified React error #"+l+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var r={d:{f:n,r:function(){throw Error(e(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},i=Symbol.for("react.portal");function a(l,c,f){var u=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:u==null?null:""+u,children:l,containerInfo:c,implementation:f}}var o=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function s(l,c){if(l==="font")return"";if(typeof c=="string")return c==="use-credentials"?c:""}return xo.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,xo.createPortal=function(l,c){var f=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11)throw Error(e(299));return a(l,c,null,f)},xo.flushSync=function(l){var c=o.T,f=r.p;try{if(o.T=null,r.p=2,l)return l()}finally{o.T=c,r.p=f,r.d.f()}},xo.preconnect=function(l,c){typeof l=="string"&&(c?(c=c.crossOrigin,c=typeof c=="string"?c==="use-credentials"?c:"":void 0):c=null,r.d.C(l,c))},xo.prefetchDNS=function(l){typeof l=="string"&&r.d.D(l)},xo.preinit=function(l,c){if(typeof l=="string"&&c&&typeof c.as=="string"){var f=c.as,u=s(f,c.crossOrigin),d=typeof c.integrity=="string"?c.integrity:void 0,h=typeof c.fetchPriority=="string"?c.fetchPriority:void 0;f==="style"?r.d.S(l,typeof c.precedence=="string"?c.precedence:void 0,{crossOrigin:u,integrity:d,fetchPriority:h}):f==="script"&&r.d.X(l,{crossOrigin:u,integrity:d,fetchPriority:h,nonce:typeof c.nonce=="string"?c.nonce:void 0})}},xo.preinitModule=function(l,c){if(typeof l=="string")if(typeof c=="object"&&c!==null){if(c.as==null||c.as==="script"){var f=s(c.as,c.crossOrigin);r.d.M(l,{crossOrigin:f,integrity:typeof c.integrity=="string"?c.integrity:void 0,nonce:typeof c.nonce=="string"?c.nonce:void 0})}}else c==null&&r.d.M(l)},xo.preload=function(l,c){if(typeof l=="string"&&typeof c=="object"&&c!==null&&typeof c.as=="string"){var f=c.as,u=s(f,c.crossOrigin);r.d.L(l,f,{crossOrigin:u,integrity:typeof c.integrity=="string"?c.integrity:void 0,nonce:typeof c.nonce=="string"?c.nonce:void 0,type:typeof c.type=="string"?c.type:void 0,fetchPriority:typeof c.fetchPriority=="string"?c.fetchPriority:void 0,referrerPolicy:typeof c.referrerPolicy=="string"?c.referrerPolicy:void 0,imageSrcSet:typeof c.imageSrcSet=="string"?c.imageSrcSet:void 0,imageSizes:typeof c.imageSizes=="string"?c.imageSizes:void 0,media:typeof c.media=="string"?c.media:void 0})}},xo.preloadModule=function(l,c){if(typeof l=="string")if(c){var f=s(c.as,c.crossOrigin);r.d.m(l,{as:typeof c.as=="string"&&c.as!=="script"?c.as:void 0,crossOrigin:f,integrity:typeof c.integrity=="string"?c.integrity:void 0})}else r.d.m(l)},xo.requestFormReset=function(l){r.d.r(l)},xo.unstable_batchedUpdates=function(l,c){return l(c)},xo.useFormState=function(l,c,f){return o.H.useFormState(l,c,f)},xo.useFormStatus=function(){return o.H.useHostTransitionStatus()},xo.version="19.1.1",xo}var cR;function rU(){if(cR)return _S.exports;cR=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),_S.exports=ore(),_S.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var uR;function sre(){if(uR)return V1;uR=1;var t=are(),e=aw(),n=rU();function r(b){var C="https://react.dev/errors/"+b;if(1<arguments.length){C+="?args[]="+encodeURIComponent(arguments[1]);for(var E=2;E<arguments.length;E++)C+="&args[]="+encodeURIComponent(arguments[E])}return"Minified React error #"+b+"; visit "+C+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(b){return!(!b||b.nodeType!==1&&b.nodeType!==9&&b.nodeType!==11)}function a(b){var C=b,E=b;if(b.alternate)for(;C.return;)C=C.return;else{b=C;do C=b,(C.flags&4098)!==0&&(E=C.return),b=C.return;while(b)}return C.tag===3?E:null}function o(b){if(b.tag===13){var C=b.memoizedState;if(C===null&&(b=b.alternate,b!==null&&(C=b.memoizedState)),C!==null)return C.dehydrated}return null}function s(b){if(a(b)!==b)throw Error(r(188))}function l(b){var C=b.alternate;if(!C){if(C=a(b),C===null)throw Error(r(188));return C!==b?null:b}for(var E=b,O=C;;){var N=E.return;if(N===null)break;var z=N.alternate;if(z===null){if(O=N.return,O!==null){E=O;continue}break}if(N.child===z.child){for(z=N.child;z;){if(z===E)return s(N),b;if(z===O)return s(N),C;z=z.sibling}throw Error(r(188))}if(E.return!==O.return)E=N,O=z;else{for(var ce=!1,xe=N.child;xe;){if(xe===E){ce=!0,E=N,O=z;break}if(xe===O){ce=!0,O=N,E=z;break}xe=xe.sibling}if(!ce){for(xe=z.child;xe;){if(xe===E){ce=!0,E=z,O=N;break}if(xe===O){ce=!0,O=z,E=N;break}xe=xe.sibling}if(!ce)throw Error(r(189))}}if(E.alternate!==O)throw Error(r(190))}if(E.tag!==3)throw Error(r(188));return E.stateNode.current===E?b:C}function c(b){var C=b.tag;if(C===5||C===26||C===27||C===6)return b;for(b=b.child;b!==null;){if(C=c(b),C!==null)return C;b=b.sibling}return null}var f=Object.assign,u=Symbol.for("react.element"),d=Symbol.for("react.transitional.element"),h=Symbol.for("react.portal"),p=Symbol.for("react.fragment"),g=Symbol.for("react.strict_mode"),m=Symbol.for("react.profiler"),y=Symbol.for("react.provider"),v=Symbol.for("react.consumer"),x=Symbol.for("react.context"),w=Symbol.for("react.forward_ref"),S=Symbol.for("react.suspense"),T=Symbol.for("react.suspense_list"),_=Symbol.for("react.memo"),D=Symbol.for("react.lazy"),I=Symbol.for("react.activity"),R=Symbol.for("react.memo_cache_sentinel"),M=Symbol.iterator;function A(b){return b===null||typeof b!="object"?null:(b=M&&b[M]||b["@@iterator"],typeof b=="function"?b:null)}var L=Symbol.for("react.client.reference");function P(b){if(b==null)return null;if(typeof b=="function")return b.$$typeof===L?null:b.displayName||b.name||null;if(typeof b=="string")return b;switch(b){case p:return"Fragment";case m:return"Profiler";case g:return"StrictMode";case S:return"Suspense";case T:return"SuspenseList";case I:return"Activity"}if(typeof b=="object")switch(b.$$typeof){case h:return"Portal";case x:return(b.displayName||"Context")+".Provider";case v:return(b._context.displayName||"Context")+".Consumer";case w:var C=b.render;return b=b.displayName,b||(b=C.displayName||C.name||"",b=b!==""?"ForwardRef("+b+")":"ForwardRef"),b;case _:return C=b.displayName||null,C!==null?C:P(b.type)||"Memo";case D:C=b._payload,b=b._init;try{return P(b(C))}catch{}}return null}var B=Array.isArray,U=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,G=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,F={pending:!1,data:null,method:null,action:null},$=[],V=-1;function X(b){return{current:b}}function Q(b){0>V||(b.current=$[V],$[V]=null,V--)}function re(b,C){V++,$[V]=b.current,b.current=C}var ye=X(null),me=X(null),Ce=X(null),we=X(null);function Ae(b,C){switch(re(Ce,C),re(me,b),re(ye,null),C.nodeType){case 9:case 11:b=(b=C.documentElement)&&(b=b.namespaceURI)?II(b):0;break;default:if(b=C.tagName,C=C.namespaceURI)C=II(C),b=RI(C,b);else switch(b){case"svg":b=1;break;case"math":b=2;break;default:b=0}}Q(ye),re(ye,b)}function De(){Q(ye),Q(me),Q(Ce)}function q(b){b.memoizedState!==null&&re(we,b);var C=ye.current,E=RI(C,b.type);C!==E&&(re(me,b),re(ye,E))}function k(b){me.current===b&&(Q(ye),Q(me)),we.current===b&&(Q(we),R1._currentValue=F)}var J=Object.prototype.hasOwnProperty,Y=t.unstable_scheduleCallback,ie=t.unstable_cancelCallback,ue=t.unstable_shouldYield,fe=t.unstable_requestPaint,Se=t.unstable_now,Fe=t.unstable_getCurrentPriorityLevel,Ke=t.unstable_ImmediatePriority,He=t.unstable_UserBlockingPriority,pe=t.unstable_NormalPriority,ge=t.unstable_LowPriority,Ie=t.unstable_IdlePriority,ve=t.log,_e=t.unstable_setDisableYieldValue,Pe=null,ne=null;function Je(b){if(typeof ve=="function"&&_e(b),ne&&typeof ne.setStrictMode=="function")try{ne.setStrictMode(Pe,b)}catch{}}var $e=Math.clz32?Math.clz32:ze,ke=Math.log,Re=Math.LN2;function ze(b){return b>>>=0,b===0?32:31-(ke(b)/Re|0)|0}var st=256,Qe=4194304;function _t(b){var C=b&42;if(C!==0)return C;switch(b&-b){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return b&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return b&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return b}}function Le(b,C,E){var O=b.pendingLanes;if(O===0)return 0;var N=0,z=b.suspendedLanes,ce=b.pingedLanes;b=b.warmLanes;var xe=O&134217727;return xe!==0?(O=xe&~z,O!==0?N=_t(O):(ce&=xe,ce!==0?N=_t(ce):E||(E=xe&~b,E!==0&&(N=_t(E))))):(xe=O&~z,xe!==0?N=_t(xe):ce!==0?N=_t(ce):E||(E=O&~b,E!==0&&(N=_t(E)))),N===0?0:C!==0&&C!==N&&(C&z)===0&&(z=N&-N,E=C&-C,z>=E||z===32&&(E&4194048)!==0)?C:N}function We(b,C){return(b.pendingLanes&~(b.suspendedLanes&~b.pingedLanes)&C)===0}function xt(b,C){switch(b){case 1:case 2:case 4:case 8:case 64:return C+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return C+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ut(){var b=st;return st<<=1,(st&4194048)===0&&(st=256),b}function gn(){var b=Qe;return Qe<<=1,(Qe&62914560)===0&&(Qe=4194304),b}function tn(b){for(var C=[],E=0;31>E;E++)C.push(b);return C}function Ht(b,C){b.pendingLanes|=C,C!==268435456&&(b.suspendedLanes=0,b.pingedLanes=0,b.warmLanes=0)}function dn(b,C,E,O,N,z){var ce=b.pendingLanes;b.pendingLanes=E,b.suspendedLanes=0,b.pingedLanes=0,b.warmLanes=0,b.expiredLanes&=E,b.entangledLanes&=E,b.errorRecoveryDisabledLanes&=E,b.shellSuspendCounter=0;var xe=b.entanglements,Ve=b.expirationTimes,nt=b.hiddenUpdates;for(E=ce&~E;0<E;){var wt=31-$e(E),Ot=1<<wt;xe[wt]=0,Ve[wt]=-1;var it=nt[wt];if(it!==null)for(nt[wt]=null,wt=0;wt<it.length;wt++){var ot=it[wt];ot!==null&&(ot.lane&=-536870913)}E&=~Ot}O!==0&&sr(b,O,0),z!==0&&N===0&&b.tag!==0&&(b.suspendedLanes|=z&~(ce&~C))}function sr(b,C,E){b.pendingLanes|=C,b.suspendedLanes&=~C;var O=31-$e(C);b.entangledLanes|=C,b.entanglements[O]=b.entanglements[O]|1073741824|E&4194090}function Qn(b,C){var E=b.entangledLanes|=C;for(b=b.entanglements;E;){var O=31-$e(E),N=1<<O;N&C|b[O]&C&&(b[O]|=C),E&=~N}}function qe(b){switch(b){case 2:b=1;break;case 8:b=4;break;case 32:b=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:b=128;break;case 268435456:b=134217728;break;default:b=0}return b}function Dt(b){return b&=-b,2<b?8<b?(b&134217727)!==0?32:268435456:8:2}function Rt(){var b=G.p;return b!==0?b:(b=window.event,b===void 0?32:YI(b.type))}function Bt(b,C){var E=G.p;try{return G.p=b,C()}finally{G.p=E}}var On=Math.random().toString(36).slice(2),$t="__reactFiber$"+On,Xt="__reactProps$"+On,Lt="__reactContainer$"+On,Qt="__reactEvents$"+On,yr="__reactListeners$"+On,kr="__reactHandles$"+On,ni="__reactResources$"+On,Ii="__reactMarker$"+On;function fi(b){delete b[$t],delete b[Xt],delete b[Qt],delete b[yr],delete b[kr]}function Ri(b){var C=b[$t];if(C)return C;for(var E=b.parentNode;E;){if(C=E[Lt]||E[$t]){if(E=C.alternate,C.child!==null||E!==null&&E.child!==null)for(b=LI(b);b!==null;){if(E=b[$t])return E;b=LI(b)}return C}b=E,E=b.parentNode}return null}function rn(b){if(b=b[$t]||b[Lt]){var C=b.tag;if(C===5||C===6||C===13||C===26||C===27||C===3)return b}return null}function Xn(b){var C=b.tag;if(C===5||C===26||C===27||C===6)return b.stateNode;throw Error(r(33))}function vi(b){var C=b[ni];return C||(C=b[ni]={hoistableStyles:new Map,hoistableScripts:new Map}),C}function an(b){b[Ii]=!0}var ri=new Set,ts={};function ii(b,C){Ai(b,C),Ai(b+"Capture",C)}function Ai(b,C){for(ts[b]=C,b=0;b<C.length;b++)ri.add(C[b])}var wa=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Pi={},Os={};function No(b){return J.call(Os,b)?!0:J.call(Pi,b)?!1:wa.test(b)?Os[b]=!0:(Pi[b]=!0,!1)}function Ni(b,C,E){if(No(C))if(E===null)b.removeAttribute(C);else{switch(typeof E){case"undefined":case"function":case"symbol":b.removeAttribute(C);return;case"boolean":var O=C.toLowerCase().slice(0,5);if(O!=="data-"&&O!=="aria-"){b.removeAttribute(C);return}}b.setAttribute(C,""+E)}}function Lo(b,C,E){if(E===null)b.removeAttribute(C);else{switch(typeof E){case"undefined":case"function":case"symbol":case"boolean":b.removeAttribute(C);return}b.setAttribute(C,""+E)}}function At(b,C,E,O){if(O===null)b.removeAttribute(E);else{switch(typeof O){case"undefined":case"function":case"symbol":case"boolean":b.removeAttribute(E);return}b.setAttributeNS(C,E,""+O)}}var Li,Xa;function di(b){if(Li===void 0)try{throw Error()}catch(E){var C=E.stack.trim().match(/\n( *(at )?)/);Li=C&&C[1]||"",Xa=-1<E.stack.indexOf(`
    at`)?" (<anonymous>)":-1<E.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Li+b+Xa}var Ms=!1;function ko(b,C){if(!b||Ms)return"";Ms=!0;var E=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var O={DetermineComponentFrameRoot:function(){try{if(C){var Ot=function(){throw Error()};if(Object.defineProperty(Ot.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ot,[])}catch(ot){var it=ot}Reflect.construct(b,[],Ot)}else{try{Ot.call()}catch(ot){it=ot}b.call(Ot.prototype)}}else{try{throw Error()}catch(ot){it=ot}(Ot=b())&&typeof Ot.catch=="function"&&Ot.catch(function(){})}}catch(ot){if(ot&&it&&typeof ot.stack=="string")return[ot.stack,it.stack]}return[null,null]}};O.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var N=Object.getOwnPropertyDescriptor(O.DetermineComponentFrameRoot,"name");N&&N.configurable&&Object.defineProperty(O.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var z=O.DetermineComponentFrameRoot(),ce=z[0],xe=z[1];if(ce&&xe){var Ve=ce.split(`
`),nt=xe.split(`
`);for(N=O=0;O<Ve.length&&!Ve[O].includes("DetermineComponentFrameRoot");)O++;for(;N<nt.length&&!nt[N].includes("DetermineComponentFrameRoot");)N++;if(O===Ve.length||N===nt.length)for(O=Ve.length-1,N=nt.length-1;1<=O&&0<=N&&Ve[O]!==nt[N];)N--;for(;1<=O&&0<=N;O--,N--)if(Ve[O]!==nt[N]){if(O!==1||N!==1)do if(O--,N--,0>N||Ve[O]!==nt[N]){var wt=`
`+Ve[O].replace(" at new "," at ");return b.displayName&&wt.includes("<anonymous>")&&(wt=wt.replace("<anonymous>",b.displayName)),wt}while(1<=O&&0<=N);break}}}finally{Ms=!1,Error.prepareStackTrace=E}return(E=b?b.displayName||b.name:"")?di(E):""}function go(b){switch(b.tag){case 26:case 27:case 5:return di(b.type);case 16:return di("Lazy");case 13:return di("Suspense");case 19:return di("SuspenseList");case 0:case 15:return ko(b.type,!1);case 11:return ko(b.type.render,!1);case 1:return ko(b.type,!0);case 31:return di("Activity");default:return""}}function $l(b){try{var C="";do C+=go(b),b=b.return;while(b);return C}catch(E){return`
Error generating stack: `+E.message+`
`+E.stack}}function pr(b){switch(typeof b){case"bigint":case"boolean":case"number":case"string":case"undefined":return b;case"object":return b;default:return""}}function ka(b){var C=b.type;return(b=b.nodeName)&&b.toLowerCase()==="input"&&(C==="checkbox"||C==="radio")}function il(b){var C=ka(b)?"checked":"value",E=Object.getOwnPropertyDescriptor(b.constructor.prototype,C),O=""+b[C];if(!b.hasOwnProperty(C)&&typeof E<"u"&&typeof E.get=="function"&&typeof E.set=="function"){var N=E.get,z=E.set;return Object.defineProperty(b,C,{configurable:!0,get:function(){return N.call(this)},set:function(ce){O=""+ce,z.call(this,ce)}}),Object.defineProperty(b,C,{enumerable:E.enumerable}),{getValue:function(){return O},setValue:function(ce){O=""+ce},stopTracking:function(){b._valueTracker=null,delete b[C]}}}}function Vo(b){b._valueTracker||(b._valueTracker=il(b))}function al(b){if(!b)return!1;var C=b._valueTracker;if(!C)return!0;var E=C.getValue(),O="";return b&&(O=ka(b)?b.checked?"true":"false":b.value),b=O,b!==E?(C.setValue(b),!0):!1}function Va(b){if(b=b||(typeof document<"u"?document:void 0),typeof b>"u")return null;try{return b.activeElement||b.body}catch{return b.body}}var Ou=/[\n"\\]/g;function la(b){return b.replace(Ou,function(C){return"\\"+C.charCodeAt(0).toString(16)+" "})}function Gl(b,C,E,O,N,z,ce,xe){b.name="",ce!=null&&typeof ce!="function"&&typeof ce!="symbol"&&typeof ce!="boolean"?b.type=ce:b.removeAttribute("type"),C!=null?ce==="number"?(C===0&&b.value===""||b.value!=C)&&(b.value=""+pr(C)):b.value!==""+pr(C)&&(b.value=""+pr(C)):ce!=="submit"&&ce!=="reset"||b.removeAttribute("value"),C!=null?Ca(b,ce,pr(C)):E!=null?Ca(b,ce,pr(E)):O!=null&&b.removeAttribute("value"),N==null&&z!=null&&(b.defaultChecked=!!z),N!=null&&(b.checked=N&&typeof N!="function"&&typeof N!="symbol"),xe!=null&&typeof xe!="function"&&typeof xe!="symbol"&&typeof xe!="boolean"?b.name=""+pr(xe):b.removeAttribute("name")}function Sc(b,C,E,O,N,z,ce,xe){if(z!=null&&typeof z!="function"&&typeof z!="symbol"&&typeof z!="boolean"&&(b.type=z),C!=null||E!=null){if(!(z!=="submit"&&z!=="reset"||C!=null))return;E=E!=null?""+pr(E):"",C=C!=null?""+pr(C):E,xe||C===b.value||(b.value=C),b.defaultValue=C}O=O??N,O=typeof O!="function"&&typeof O!="symbol"&&!!O,b.checked=xe?b.checked:!!O,b.defaultChecked=!!O,ce!=null&&typeof ce!="function"&&typeof ce!="symbol"&&typeof ce!="boolean"&&(b.name=ce)}function Ca(b,C,E){C==="number"&&Va(b.ownerDocument)===b||b.defaultValue===""+E||(b.defaultValue=""+E)}function ki(b,C,E,O){if(b=b.options,C){C={};for(var N=0;N<E.length;N++)C["$"+E[N]]=!0;for(E=0;E<b.length;E++)N=C.hasOwnProperty("$"+b[E].value),b[E].selected!==N&&(b[E].selected=N),N&&O&&(b[E].defaultSelected=!0)}else{for(E=""+pr(E),C=null,N=0;N<b.length;N++){if(b[N].value===E){b[N].selected=!0,O&&(b[N].defaultSelected=!0);return}C!==null||b[N].disabled||(C=b[N])}C!==null&&(C.selected=!0)}}function Sa(b,C,E){if(C!=null&&(C=""+pr(C),C!==b.value&&(b.value=C),E==null)){b.defaultValue!==C&&(b.defaultValue=C);return}b.defaultValue=E!=null?""+pr(E):""}function Vi(b,C,E,O){if(C==null){if(O!=null){if(E!=null)throw Error(r(92));if(B(O)){if(1<O.length)throw Error(r(93));O=O[0]}E=O}E==null&&(E=""),C=E}E=pr(C),b.defaultValue=E,O=b.textContent,O===E&&O!==""&&O!==null&&(b.value=O)}function Fo(b,C){if(C){var E=b.firstChild;if(E&&E===b.lastChild&&E.nodeType===3){E.nodeValue=C;return}}b.textContent=C}var ns=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function rs(b,C,E){var O=C.indexOf("--")===0;E==null||typeof E=="boolean"||E===""?O?b.setProperty(C,""):C==="float"?b.cssFloat="":b[C]="":O?b.setProperty(C,E):typeof E!="number"||E===0||ns.has(C)?C==="float"?b.cssFloat=E:b[C]=(""+E).trim():b[C]=E+"px"}function Kr(b,C,E){if(C!=null&&typeof C!="object")throw Error(r(62));if(b=b.style,E!=null){for(var O in E)!E.hasOwnProperty(O)||C!=null&&C.hasOwnProperty(O)||(O.indexOf("--")===0?b.setProperty(O,""):O==="float"?b.cssFloat="":b[O]="");for(var N in C)O=C[N],C.hasOwnProperty(N)&&E[N]!==O&&rs(b,N,O)}else for(var z in C)C.hasOwnProperty(z)&&rs(b,z,C[z])}function ol(b){if(b.indexOf("-")===-1)return!1;switch(b){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ta=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Fi=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function is(b){return Fi.test(""+b)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":b}var mo=null;function qi(b){return b=b.target||b.srcElement||window,b.correspondingUseElement&&(b=b.correspondingUseElement),b.nodeType===3?b.parentNode:b}var Fa=null,Uo=null;function jl(b){var C=rn(b);if(C&&(b=C.stateNode)){var E=b[Xt]||null;e:switch(b=C.stateNode,C.type){case"input":if(Gl(b,E.value,E.defaultValue,E.defaultValue,E.checked,E.defaultChecked,E.type,E.name),C=E.name,E.type==="radio"&&C!=null){for(E=b;E.parentNode;)E=E.parentNode;for(E=E.querySelectorAll('input[name="'+la(""+C)+'"][type="radio"]'),C=0;C<E.length;C++){var O=E[C];if(O!==b&&O.form===b.form){var N=O[Xt]||null;if(!N)throw Error(r(90));Gl(O,N.value,N.defaultValue,N.defaultValue,N.checked,N.defaultChecked,N.type,N.name)}}for(C=0;C<E.length;C++)O=E[C],O.form===b.form&&al(O)}break e;case"textarea":Sa(b,E.value,E.defaultValue);break e;case"select":C=E.value,C!=null&&ki(b,!!E.multiple,C,!1)}}}var as=!1;function Sr(b,C,E){if(as)return b(C,E);as=!0;try{var O=b(C);return O}finally{if(as=!1,(Fa!==null||Uo!==null)&&(t5(),Fa&&(C=Fa,b=Uo,Uo=Fa=null,jl(C),b)))for(C=0;C<b.length;C++)jl(b[C])}}function Ya(b,C){var E=b.stateNode;if(E===null)return null;var O=E[Xt]||null;if(O===null)return null;E=O[C];e:switch(C){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(O=!O.disabled)||(b=b.type,O=!(b==="button"||b==="input"||b==="select"||b==="textarea")),b=!O;break e;default:b=!1}if(b)return null;if(E&&typeof E!="function")throw Error(r(231,C,typeof E));return E}var Tr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ai=!1;if(Tr)try{var os={};Object.defineProperty(os,"passive",{get:function(){ai=!0}}),window.addEventListener("test",os,os),window.removeEventListener("test",os,os)}catch{ai=!1}var oi=null,zl=null,yi=null;function Ja(){if(yi)return yi;var b,C=zl,E=C.length,O,N="value"in oi?oi.value:oi.textContent,z=N.length;for(b=0;b<E&&C[b]===N[b];b++);var ce=E-b;for(O=1;O<=ce&&C[E-O]===N[z-O];O++);return yi=N.slice(b,1<O?1-O:void 0)}function ss(b){var C=b.keyCode;return"charCode"in b?(b=b.charCode,b===0&&C===13&&(b=13)):b=C,b===10&&(b=13),32<=b||b===13?b:0}function vo(){return!0}function ca(){return!1}function xi(b){function C(E,O,N,z,ce){this._reactName=E,this._targetInst=N,this.type=O,this.nativeEvent=z,this.target=ce,this.currentTarget=null;for(var xe in b)b.hasOwnProperty(xe)&&(E=b[xe],this[xe]=E?E(z):z[xe]);return this.isDefaultPrevented=(z.defaultPrevented!=null?z.defaultPrevented:z.returnValue===!1)?vo:ca,this.isPropagationStopped=ca,this}return f(C.prototype,{preventDefault:function(){this.defaultPrevented=!0;var E=this.nativeEvent;E&&(E.preventDefault?E.preventDefault():typeof E.returnValue!="unknown"&&(E.returnValue=!1),this.isDefaultPrevented=vo)},stopPropagation:function(){var E=this.nativeEvent;E&&(E.stopPropagation?E.stopPropagation():typeof E.cancelBubble!="unknown"&&(E.cancelBubble=!0),this.isPropagationStopped=vo)},persist:function(){},isPersistent:vo}),C}var Bo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(b){return b.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},sl=xi(Bo),ls=f({},Bo,{view:0,detail:0}),Is=xi(ls),ll,Rs,As,cl=f({},ls,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:fl,button:0,buttons:0,relatedTarget:function(b){return b.relatedTarget===void 0?b.fromElement===b.srcElement?b.toElement:b.fromElement:b.relatedTarget},movementX:function(b){return"movementX"in b?b.movementX:(b!==As&&(As&&b.type==="mousemove"?(ll=b.screenX-As.screenX,Rs=b.screenY-As.screenY):Rs=ll=0,As=b),ll)},movementY:function(b){return"movementY"in b?b.movementY:Rs}}),Tc=xi(cl),Mu=f({},cl,{dataTransfer:0}),Iu=xi(Mu),Ru=f({},ls,{relatedTarget:0}),Wl=xi(Ru),Ec=f({},Bo,{animationName:0,elapsedTime:0,pseudoElement:0}),Au=xi(Ec),_c=f({},Bo,{clipboardData:function(b){return"clipboardData"in b?b.clipboardData:window.clipboardData}}),Dc=xi(_c),Pu=f({},Bo,{data:0}),ul=xi(Pu),Oc={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Mc={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Hl={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Nu(b){var C=this.nativeEvent;return C.getModifierState?C.getModifierState(b):(b=Hl[b])?!!C[b]:!1}function fl(){return Nu}var Lu=f({},ls,{key:function(b){if(b.key){var C=Oc[b.key]||b.key;if(C!=="Unidentified")return C}return b.type==="keypress"?(b=ss(b),b===13?"Enter":String.fromCharCode(b)):b.type==="keydown"||b.type==="keyup"?Mc[b.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:fl,charCode:function(b){return b.type==="keypress"?ss(b):0},keyCode:function(b){return b.type==="keydown"||b.type==="keyup"?b.keyCode:0},which:function(b){return b.type==="keypress"?ss(b):b.type==="keydown"||b.type==="keyup"?b.keyCode:0}}),Ic=xi(Lu),ku=f({},cl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Rc=xi(ku),Vu=f({},ls,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:fl}),Fu=xi(Vu),Kl=f({},Bo,{propertyName:0,elapsedTime:0,pseudoElement:0}),ql=xi(Kl),$o=f({},cl,{deltaX:function(b){return"deltaX"in b?b.deltaX:"wheelDeltaX"in b?-b.wheelDeltaX:0},deltaY:function(b){return"deltaY"in b?b.deltaY:"wheelDeltaY"in b?-b.wheelDeltaY:"wheelDelta"in b?-b.wheelDelta:0},deltaZ:0,deltaMode:0}),cs=xi($o),Za=f({},Bo,{newState:0,oldState:0}),Ac=xi(Za),Pc=[9,13,27,32],Ps=Tr&&"CompositionEvent"in window,us=null;Tr&&"documentMode"in document&&(us=document.documentMode);var dl=Tr&&"TextEvent"in window&&!us,Xl=Tr&&(!Ps||us&&8<us&&11>=us),de=" ",he=!1;function Oe(b,C){switch(b){case"keyup":return Pc.indexOf(C.keyCode)!==-1;case"keydown":return C.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ye(b){return b=b.detail,typeof b=="object"&&"data"in b?b.data:null}var at=!1;function gt(b,C){switch(b){case"compositionend":return Ye(C);case"keypress":return C.which!==32?null:(he=!0,de);case"textInput":return b=C.data,b===de&&he?null:b;default:return null}}function mt(b,C){if(at)return b==="compositionend"||!Ps&&Oe(b,C)?(b=Ja(),yi=zl=oi=null,at=!1,b):null;switch(b){case"paste":return null;case"keypress":if(!(C.ctrlKey||C.altKey||C.metaKey)||C.ctrlKey&&C.altKey){if(C.char&&1<C.char.length)return C.char;if(C.which)return String.fromCharCode(C.which)}return null;case"compositionend":return Xl&&C.locale!=="ko"?null:C.data;default:return null}}var lt={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function bt(b){var C=b&&b.nodeName&&b.nodeName.toLowerCase();return C==="input"?!!lt[b.type]:C==="textarea"}function kt(b,C,E,O){Fa?Uo?Uo.push(O):Uo=[O]:Fa=O,C=s5(C,"onChange"),0<C.length&&(E=new sl("onChange","change",null,E,O),b.push({event:E,listeners:C}))}var Kt=null,en=null;function un(b){EI(b,0)}function se(b){var C=Xn(b);if(al(C))return b}function oe(b,C){if(b==="change")return C}var Te=!1;if(Tr){var Ge;if(Tr){var rt="oninput"in document;if(!rt){var Tt=document.createElement("div");Tt.setAttribute("oninput","return;"),rt=typeof Tt.oninput=="function"}Ge=rt}else Ge=!1;Te=Ge&&(!document.documentMode||9<document.documentMode)}function pt(){Kt&&(Kt.detachEvent("onpropertychange",dt),en=Kt=null)}function dt(b){if(b.propertyName==="value"&&se(en)){var C=[];kt(C,en,b,qi(b)),Sr(un,C)}}function Z(b,C,E){b==="focusin"?(pt(),Kt=C,en=E,Kt.attachEvent("onpropertychange",dt)):b==="focusout"&&pt()}function te(b){if(b==="selectionchange"||b==="keyup"||b==="keydown")return se(en)}function W(b,C){if(b==="click")return se(C)}function K(b,C){if(b==="input"||b==="change")return se(C)}function ae(b,C){return b===C&&(b!==0||1/b===1/C)||b!==b&&C!==C}var be=typeof Object.is=="function"?Object.is:ae;function Ee(b,C){if(be(b,C))return!0;if(typeof b!="object"||b===null||typeof C!="object"||C===null)return!1;var E=Object.keys(b),O=Object.keys(C);if(E.length!==O.length)return!1;for(O=0;O<E.length;O++){var N=E[O];if(!J.call(C,N)||!be(b[N],C[N]))return!1}return!0}function Me(b){for(;b&&b.firstChild;)b=b.firstChild;return b}function Ne(b,C){var E=Me(b);b=0;for(var O;E;){if(E.nodeType===3){if(O=b+E.textContent.length,b<=C&&O>=C)return{node:E,offset:C-b};b=O}e:{for(;E;){if(E.nextSibling){E=E.nextSibling;break e}E=E.parentNode}E=void 0}E=Me(E)}}function Ue(b,C){return b&&C?b===C?!0:b&&b.nodeType===3?!1:C&&C.nodeType===3?Ue(b,C.parentNode):"contains"in b?b.contains(C):b.compareDocumentPosition?!!(b.compareDocumentPosition(C)&16):!1:!1}function Ze(b){b=b!=null&&b.ownerDocument!=null&&b.ownerDocument.defaultView!=null?b.ownerDocument.defaultView:window;for(var C=Va(b.document);C instanceof b.HTMLIFrameElement;){try{var E=typeof C.contentWindow.location.href=="string"}catch{E=!1}if(E)b=C.contentWindow;else break;C=Va(b.document)}return C}function ht(b){var C=b&&b.nodeName&&b.nodeName.toLowerCase();return C&&(C==="input"&&(b.type==="text"||b.type==="search"||b.type==="tel"||b.type==="url"||b.type==="password")||C==="textarea"||b.contentEditable==="true")}var Pt=Tr&&"documentMode"in document&&11>=document.documentMode,Wt=null,Gt=null,hn=null,mn=!1;function er(b,C,E){var O=E.window===E?E.document:E.nodeType===9?E:E.ownerDocument;mn||Wt==null||Wt!==Va(O)||(O=Wt,"selectionStart"in O&&ht(O)?O={start:O.selectionStart,end:O.selectionEnd}:(O=(O.ownerDocument&&O.ownerDocument.defaultView||window).getSelection(),O={anchorNode:O.anchorNode,anchorOffset:O.anchorOffset,focusNode:O.focusNode,focusOffset:O.focusOffset}),hn&&Ee(hn,O)||(hn=O,O=s5(Gt,"onSelect"),0<O.length&&(C=new sl("onSelect","select",null,C,E),b.push({event:C,listeners:O}),C.target=Wt)))}function Ar(b,C){var E={};return E[b.toLowerCase()]=C.toLowerCase(),E["Webkit"+b]="webkit"+C,E["Moz"+b]="moz"+C,E}var Gr={animationend:Ar("Animation","AnimationEnd"),animationiteration:Ar("Animation","AnimationIteration"),animationstart:Ar("Animation","AnimationStart"),transitionrun:Ar("Transition","TransitionRun"),transitionstart:Ar("Transition","TransitionStart"),transitioncancel:Ar("Transition","TransitionCancel"),transitionend:Ar("Transition","TransitionEnd")},Yl={},Go={};Tr&&(Go=document.createElement("div").style,"AnimationEvent"in window||(delete Gr.animationend.animation,delete Gr.animationiteration.animation,delete Gr.animationstart.animation),"TransitionEvent"in window||delete Gr.transitionend.transition);function hl(b){if(Yl[b])return Yl[b];if(!Gr[b])return b;var C=Gr[b],E;for(E in C)if(C.hasOwnProperty(E)&&E in Go)return Yl[b]=C[E];return b}var jf=hl("animationend"),Jm=hl("animationiteration"),Zm=hl("animationstart"),kte=hl("transitionrun"),Vte=hl("transitionstart"),Fte=hl("transitioncancel"),oO=hl("transitionend"),sO=new Map,VC="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");VC.push("scrollEnd");function Jl(b,C){sO.set(b,C),ii(C,[b])}var lO=new WeakMap;function pl(b,C){if(typeof b=="object"&&b!==null){var E=lO.get(b);return E!==void 0?E:(C={value:b,source:C,stack:$l(C)},lO.set(b,C),C)}return{value:b,source:C,stack:$l(C)}}var gl=[],vp=0,FC=0;function Sy(){for(var b=vp,C=FC=vp=0;C<b;){var E=gl[C];gl[C++]=null;var O=gl[C];gl[C++]=null;var N=gl[C];gl[C++]=null;var z=gl[C];if(gl[C++]=null,O!==null&&N!==null){var ce=O.pending;ce===null?N.next=N:(N.next=ce.next,ce.next=N),O.pending=N}z!==0&&cO(E,N,z)}}function Ty(b,C,E,O){gl[vp++]=b,gl[vp++]=C,gl[vp++]=E,gl[vp++]=O,FC|=O,b.lanes|=O,b=b.alternate,b!==null&&(b.lanes|=O)}function UC(b,C,E,O){return Ty(b,C,E,O),Ey(b)}function yp(b,C){return Ty(b,null,null,C),Ey(b)}function cO(b,C,E){b.lanes|=E;var O=b.alternate;O!==null&&(O.lanes|=E);for(var N=!1,z=b.return;z!==null;)z.childLanes|=E,O=z.alternate,O!==null&&(O.childLanes|=E),z.tag===22&&(b=z.stateNode,b===null||b._visibility&1||(N=!0)),b=z,z=z.return;return b.tag===3?(z=b.stateNode,N&&C!==null&&(N=31-$e(E),b=z.hiddenUpdates,O=b[N],O===null?b[N]=[C]:O.push(C),C.lane=E|536870912),z):null}function Ey(b){if(50<S1)throw S1=0,W4=null,Error(r(185));for(var C=b.return;C!==null;)b=C,C=b.return;return b.tag===3?b.stateNode:null}var xp={};function Ute(b,C,E,O){this.tag=b,this.key=E,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=C,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=O,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ns(b,C,E,O){return new Ute(b,C,E,O)}function BC(b){return b=b.prototype,!(!b||!b.isReactComponent)}function Uu(b,C){var E=b.alternate;return E===null?(E=Ns(b.tag,C,b.key,b.mode),E.elementType=b.elementType,E.type=b.type,E.stateNode=b.stateNode,E.alternate=b,b.alternate=E):(E.pendingProps=C,E.type=b.type,E.flags=0,E.subtreeFlags=0,E.deletions=null),E.flags=b.flags&65011712,E.childLanes=b.childLanes,E.lanes=b.lanes,E.child=b.child,E.memoizedProps=b.memoizedProps,E.memoizedState=b.memoizedState,E.updateQueue=b.updateQueue,C=b.dependencies,E.dependencies=C===null?null:{lanes:C.lanes,firstContext:C.firstContext},E.sibling=b.sibling,E.index=b.index,E.ref=b.ref,E.refCleanup=b.refCleanup,E}function uO(b,C){b.flags&=65011714;var E=b.alternate;return E===null?(b.childLanes=0,b.lanes=C,b.child=null,b.subtreeFlags=0,b.memoizedProps=null,b.memoizedState=null,b.updateQueue=null,b.dependencies=null,b.stateNode=null):(b.childLanes=E.childLanes,b.lanes=E.lanes,b.child=E.child,b.subtreeFlags=0,b.deletions=null,b.memoizedProps=E.memoizedProps,b.memoizedState=E.memoizedState,b.updateQueue=E.updateQueue,b.type=E.type,C=E.dependencies,b.dependencies=C===null?null:{lanes:C.lanes,firstContext:C.firstContext}),b}function _y(b,C,E,O,N,z){var ce=0;if(O=b,typeof b=="function")BC(b)&&(ce=1);else if(typeof b=="string")ce=$ne(b,E,ye.current)?26:b==="html"||b==="head"||b==="body"?27:5;else e:switch(b){case I:return b=Ns(31,E,C,N),b.elementType=I,b.lanes=z,b;case p:return O0(E.children,N,z,C);case g:ce=8,N|=24;break;case m:return b=Ns(12,E,C,N|2),b.elementType=m,b.lanes=z,b;case S:return b=Ns(13,E,C,N),b.elementType=S,b.lanes=z,b;case T:return b=Ns(19,E,C,N),b.elementType=T,b.lanes=z,b;default:if(typeof b=="object"&&b!==null)switch(b.$$typeof){case y:case x:ce=10;break e;case v:ce=9;break e;case w:ce=11;break e;case _:ce=14;break e;case D:ce=16,O=null;break e}ce=29,E=Error(r(130,b===null?"null":typeof b,"")),O=null}return C=Ns(ce,E,C,N),C.elementType=b,C.type=O,C.lanes=z,C}function O0(b,C,E,O){return b=Ns(7,b,O,C),b.lanes=E,b}function $C(b,C,E){return b=Ns(6,b,null,C),b.lanes=E,b}function GC(b,C,E){return C=Ns(4,b.children!==null?b.children:[],b.key,C),C.lanes=E,C.stateNode={containerInfo:b.containerInfo,pendingChildren:null,implementation:b.implementation},C}var bp=[],wp=0,Dy=null,Oy=0,ml=[],vl=0,M0=null,Bu=1,$u="";function I0(b,C){bp[wp++]=Oy,bp[wp++]=Dy,Dy=b,Oy=C}function fO(b,C,E){ml[vl++]=Bu,ml[vl++]=$u,ml[vl++]=M0,M0=b;var O=Bu;b=$u;var N=32-$e(O)-1;O&=~(1<<N),E+=1;var z=32-$e(C)+N;if(30<z){var ce=N-N%5;z=(O&(1<<ce)-1).toString(32),O>>=ce,N-=ce,Bu=1<<32-$e(C)+N|E<<N|O,$u=z+b}else Bu=1<<z|E<<N|O,$u=b}function jC(b){b.return!==null&&(I0(b,1),fO(b,1,0))}function zC(b){for(;b===Dy;)Dy=bp[--wp],bp[wp]=null,Oy=bp[--wp],bp[wp]=null;for(;b===M0;)M0=ml[--vl],ml[vl]=null,$u=ml[--vl],ml[vl]=null,Bu=ml[--vl],ml[vl]=null}var jo=null,Ui=null,xr=!1,R0=null,Nc=!1,WC=Error(r(519));function A0(b){var C=Error(r(418,""));throw t1(pl(C,b)),WC}function dO(b){var C=b.stateNode,E=b.type,O=b.memoizedProps;switch(C[$t]=b,C[Xt]=O,E){case"dialog":Jn("cancel",C),Jn("close",C);break;case"iframe":case"object":case"embed":Jn("load",C);break;case"video":case"audio":for(E=0;E<E1.length;E++)Jn(E1[E],C);break;case"source":Jn("error",C);break;case"img":case"image":case"link":Jn("error",C),Jn("load",C);break;case"details":Jn("toggle",C);break;case"input":Jn("invalid",C),Sc(C,O.value,O.defaultValue,O.checked,O.defaultChecked,O.type,O.name,!0),Vo(C);break;case"select":Jn("invalid",C);break;case"textarea":Jn("invalid",C),Vi(C,O.value,O.defaultValue,O.children),Vo(C)}E=O.children,typeof E!="string"&&typeof E!="number"&&typeof E!="bigint"||C.textContent===""+E||O.suppressHydrationWarning===!0||MI(C.textContent,E)?(O.popover!=null&&(Jn("beforetoggle",C),Jn("toggle",C)),O.onScroll!=null&&Jn("scroll",C),O.onScrollEnd!=null&&Jn("scrollend",C),O.onClick!=null&&(C.onclick=l5),C=!0):C=!1,C||A0(b)}function hO(b){for(jo=b.return;jo;)switch(jo.tag){case 5:case 13:Nc=!1;return;case 27:case 3:Nc=!0;return;default:jo=jo.return}}function Qm(b){if(b!==jo)return!1;if(!xr)return hO(b),xr=!0,!1;var C=b.tag,E;if((E=C!==3&&C!==27)&&((E=C===5)&&(E=b.type,E=!(E!=="form"&&E!=="button")||sS(b.type,b.memoizedProps)),E=!E),E&&Ui&&A0(b),hO(b),C===13){if(b=b.memoizedState,b=b!==null?b.dehydrated:null,!b)throw Error(r(317));e:{for(b=b.nextSibling,C=0;b;){if(b.nodeType===8)if(E=b.data,E==="/$"){if(C===0){Ui=Ql(b.nextSibling);break e}C--}else E!=="$"&&E!=="$!"&&E!=="$?"||C++;b=b.nextSibling}Ui=null}}else C===27?(C=Ui,ad(b.type)?(b=fS,fS=null,Ui=b):Ui=C):Ui=jo?Ql(b.stateNode.nextSibling):null;return!0}function e1(){Ui=jo=null,xr=!1}function pO(){var b=R0;return b!==null&&(hs===null?hs=b:hs.push.apply(hs,b),R0=null),b}function t1(b){R0===null?R0=[b]:R0.push(b)}var HC=X(null),P0=null,Gu=null;function zf(b,C,E){re(HC,C._currentValue),C._currentValue=E}function ju(b){b._currentValue=HC.current,Q(HC)}function KC(b,C,E){for(;b!==null;){var O=b.alternate;if((b.childLanes&C)!==C?(b.childLanes|=C,O!==null&&(O.childLanes|=C)):O!==null&&(O.childLanes&C)!==C&&(O.childLanes|=C),b===E)break;b=b.return}}function qC(b,C,E,O){var N=b.child;for(N!==null&&(N.return=b);N!==null;){var z=N.dependencies;if(z!==null){var ce=N.child;z=z.firstContext;e:for(;z!==null;){var xe=z;z=N;for(var Ve=0;Ve<C.length;Ve++)if(xe.context===C[Ve]){z.lanes|=E,xe=z.alternate,xe!==null&&(xe.lanes|=E),KC(z.return,E,b),O||(ce=null);break e}z=xe.next}}else if(N.tag===18){if(ce=N.return,ce===null)throw Error(r(341));ce.lanes|=E,z=ce.alternate,z!==null&&(z.lanes|=E),KC(ce,E,b),ce=null}else ce=N.child;if(ce!==null)ce.return=N;else for(ce=N;ce!==null;){if(ce===b){ce=null;break}if(N=ce.sibling,N!==null){N.return=ce.return,ce=N;break}ce=ce.return}N=ce}}function n1(b,C,E,O){b=null;for(var N=C,z=!1;N!==null;){if(!z){if((N.flags&524288)!==0)z=!0;else if((N.flags&262144)!==0)break}if(N.tag===10){var ce=N.alternate;if(ce===null)throw Error(r(387));if(ce=ce.memoizedProps,ce!==null){var xe=N.type;be(N.pendingProps.value,ce.value)||(b!==null?b.push(xe):b=[xe])}}else if(N===we.current){if(ce=N.alternate,ce===null)throw Error(r(387));ce.memoizedState.memoizedState!==N.memoizedState.memoizedState&&(b!==null?b.push(R1):b=[R1])}N=N.return}b!==null&&qC(C,b,E,O),C.flags|=262144}function My(b){for(b=b.firstContext;b!==null;){if(!be(b.context._currentValue,b.memoizedValue))return!0;b=b.next}return!1}function N0(b){P0=b,Gu=null,b=b.dependencies,b!==null&&(b.firstContext=null)}function yo(b){return gO(P0,b)}function Iy(b,C){return P0===null&&N0(b),gO(b,C)}function gO(b,C){var E=C._currentValue;if(C={context:C,memoizedValue:E,next:null},Gu===null){if(b===null)throw Error(r(308));Gu=C,b.dependencies={lanes:0,firstContext:C},b.flags|=524288}else Gu=Gu.next=C;return E}var Bte=typeof AbortController<"u"?AbortController:function(){var b=[],C=this.signal={aborted:!1,addEventListener:function(E,O){b.push(O)}};this.abort=function(){C.aborted=!0,b.forEach(function(E){return E()})}},$te=t.unstable_scheduleCallback,Gte=t.unstable_NormalPriority,Ea={$$typeof:x,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function XC(){return{controller:new Bte,data:new Map,refCount:0}}function r1(b){b.refCount--,b.refCount===0&&$te(Gte,function(){b.controller.abort()})}var i1=null,YC=0,Cp=0,Sp=null;function jte(b,C){if(i1===null){var E=i1=[];YC=0,Cp=Z4(),Sp={status:"pending",value:void 0,then:function(O){E.push(O)}}}return YC++,C.then(mO,mO),C}function mO(){if(--YC===0&&i1!==null){Sp!==null&&(Sp.status="fulfilled");var b=i1;i1=null,Cp=0,Sp=null;for(var C=0;C<b.length;C++)(0,b[C])()}}function zte(b,C){var E=[],O={status:"pending",value:null,reason:null,then:function(N){E.push(N)}};return b.then(function(){O.status="fulfilled",O.value=C;for(var N=0;N<E.length;N++)(0,E[N])(C)},function(N){for(O.status="rejected",O.reason=N,N=0;N<E.length;N++)(0,E[N])(void 0)}),O}var vO=U.S;U.S=function(b,C){typeof C=="object"&&C!==null&&typeof C.then=="function"&&jte(b,C),vO!==null&&vO(b,C)};var L0=X(null);function JC(){var b=L0.current;return b!==null?b:qr.pooledCache}function Ry(b,C){C===null?re(L0,L0.current):re(L0,C.pool)}function yO(){var b=JC();return b===null?null:{parent:Ea._currentValue,pool:b}}var a1=Error(r(460)),xO=Error(r(474)),Ay=Error(r(542)),ZC={then:function(){}};function bO(b){return b=b.status,b==="fulfilled"||b==="rejected"}function Py(){}function wO(b,C,E){switch(E=b[E],E===void 0?b.push(C):E!==C&&(C.then(Py,Py),C=E),C.status){case"fulfilled":return C.value;case"rejected":throw b=C.reason,SO(b),b;default:if(typeof C.status=="string")C.then(Py,Py);else{if(b=qr,b!==null&&100<b.shellSuspendCounter)throw Error(r(482));b=C,b.status="pending",b.then(function(O){if(C.status==="pending"){var N=C;N.status="fulfilled",N.value=O}},function(O){if(C.status==="pending"){var N=C;N.status="rejected",N.reason=O}})}switch(C.status){case"fulfilled":return C.value;case"rejected":throw b=C.reason,SO(b),b}throw o1=C,a1}}var o1=null;function CO(){if(o1===null)throw Error(r(459));var b=o1;return o1=null,b}function SO(b){if(b===a1||b===Ay)throw Error(r(483))}var Wf=!1;function QC(b){b.updateQueue={baseState:b.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function e4(b,C){b=b.updateQueue,C.updateQueue===b&&(C.updateQueue={baseState:b.baseState,firstBaseUpdate:b.firstBaseUpdate,lastBaseUpdate:b.lastBaseUpdate,shared:b.shared,callbacks:null})}function Hf(b){return{lane:b,tag:0,payload:null,callback:null,next:null}}function Kf(b,C,E){var O=b.updateQueue;if(O===null)return null;if(O=O.shared,(Pr&2)!==0){var N=O.pending;return N===null?C.next=C:(C.next=N.next,N.next=C),O.pending=C,C=Ey(b),cO(b,null,E),C}return Ty(b,O,C,E),Ey(b)}function s1(b,C,E){if(C=C.updateQueue,C!==null&&(C=C.shared,(E&4194048)!==0)){var O=C.lanes;O&=b.pendingLanes,E|=O,C.lanes=E,Qn(b,E)}}function t4(b,C){var E=b.updateQueue,O=b.alternate;if(O!==null&&(O=O.updateQueue,E===O)){var N=null,z=null;if(E=E.firstBaseUpdate,E!==null){do{var ce={lane:E.lane,tag:E.tag,payload:E.payload,callback:null,next:null};z===null?N=z=ce:z=z.next=ce,E=E.next}while(E!==null);z===null?N=z=C:z=z.next=C}else N=z=C;E={baseState:O.baseState,firstBaseUpdate:N,lastBaseUpdate:z,shared:O.shared,callbacks:O.callbacks},b.updateQueue=E;return}b=E.lastBaseUpdate,b===null?E.firstBaseUpdate=C:b.next=C,E.lastBaseUpdate=C}var n4=!1;function l1(){if(n4){var b=Sp;if(b!==null)throw b}}function c1(b,C,E,O){n4=!1;var N=b.updateQueue;Wf=!1;var z=N.firstBaseUpdate,ce=N.lastBaseUpdate,xe=N.shared.pending;if(xe!==null){N.shared.pending=null;var Ve=xe,nt=Ve.next;Ve.next=null,ce===null?z=nt:ce.next=nt,ce=Ve;var wt=b.alternate;wt!==null&&(wt=wt.updateQueue,xe=wt.lastBaseUpdate,xe!==ce&&(xe===null?wt.firstBaseUpdate=nt:xe.next=nt,wt.lastBaseUpdate=Ve))}if(z!==null){var Ot=N.baseState;ce=0,wt=nt=Ve=null,xe=z;do{var it=xe.lane&-536870913,ot=it!==xe.lane;if(ot?(lr&it)===it:(O&it)===it){it!==0&&it===Cp&&(n4=!0),wt!==null&&(wt=wt.next={lane:0,tag:xe.tag,payload:xe.payload,callback:null,next:null});e:{var Cn=b,vn=xe;it=C;var Ur=E;switch(vn.tag){case 1:if(Cn=vn.payload,typeof Cn=="function"){Ot=Cn.call(Ur,Ot,it);break e}Ot=Cn;break e;case 3:Cn.flags=Cn.flags&-65537|128;case 0:if(Cn=vn.payload,it=typeof Cn=="function"?Cn.call(Ur,Ot,it):Cn,it==null)break e;Ot=f({},Ot,it);break e;case 2:Wf=!0}}it=xe.callback,it!==null&&(b.flags|=64,ot&&(b.flags|=8192),ot=N.callbacks,ot===null?N.callbacks=[it]:ot.push(it))}else ot={lane:it,tag:xe.tag,payload:xe.payload,callback:xe.callback,next:null},wt===null?(nt=wt=ot,Ve=Ot):wt=wt.next=ot,ce|=it;if(xe=xe.next,xe===null){if(xe=N.shared.pending,xe===null)break;ot=xe,xe=ot.next,ot.next=null,N.lastBaseUpdate=ot,N.shared.pending=null}}while(!0);wt===null&&(Ve=Ot),N.baseState=Ve,N.firstBaseUpdate=nt,N.lastBaseUpdate=wt,z===null&&(N.shared.lanes=0),td|=ce,b.lanes=ce,b.memoizedState=Ot}}function TO(b,C){if(typeof b!="function")throw Error(r(191,b));b.call(C)}function EO(b,C){var E=b.callbacks;if(E!==null)for(b.callbacks=null,b=0;b<E.length;b++)TO(E[b],C)}var Tp=X(null),Ny=X(0);function _O(b,C){b=Yu,re(Ny,b),re(Tp,C),Yu=b|C.baseLanes}function r4(){re(Ny,Yu),re(Tp,Tp.current)}function i4(){Yu=Ny.current,Q(Tp),Q(Ny)}var qf=0,zn=null,Vr=null,ua=null,Ly=!1,Ep=!1,k0=!1,ky=0,u1=0,_p=null,Wte=0;function Xi(){throw Error(r(321))}function a4(b,C){if(C===null)return!1;for(var E=0;E<C.length&&E<b.length;E++)if(!be(b[E],C[E]))return!1;return!0}function o4(b,C,E,O,N,z){return qf=z,zn=C,C.memoizedState=null,C.updateQueue=null,C.lanes=0,U.H=b===null||b.memoizedState===null?cM:uM,k0=!1,z=E(O,N),k0=!1,Ep&&(z=OO(C,E,O,N)),DO(b),z}function DO(b){U.H=Gy;var C=Vr!==null&&Vr.next!==null;if(qf=0,ua=Vr=zn=null,Ly=!1,u1=0,_p=null,C)throw Error(r(300));b===null||Ua||(b=b.dependencies,b!==null&&My(b)&&(Ua=!0))}function OO(b,C,E,O){zn=b;var N=0;do{if(Ep&&(_p=null),u1=0,Ep=!1,25<=N)throw Error(r(301));if(N+=1,ua=Vr=null,b.updateQueue!=null){var z=b.updateQueue;z.lastEffect=null,z.events=null,z.stores=null,z.memoCache!=null&&(z.memoCache.index=0)}U.H=Zte,z=C(E,O)}while(Ep);return z}function Hte(){var b=U.H,C=b.useState()[0];return C=typeof C.then=="function"?f1(C):C,b=b.useState()[0],(Vr!==null?Vr.memoizedState:null)!==b&&(zn.flags|=1024),C}function s4(){var b=ky!==0;return ky=0,b}function l4(b,C,E){C.updateQueue=b.updateQueue,C.flags&=-2053,b.lanes&=~E}function c4(b){if(Ly){for(b=b.memoizedState;b!==null;){var C=b.queue;C!==null&&(C.pending=null),b=b.next}Ly=!1}qf=0,ua=Vr=zn=null,Ep=!1,u1=ky=0,_p=null}function fs(){var b={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ua===null?zn.memoizedState=ua=b:ua=ua.next=b,ua}function fa(){if(Vr===null){var b=zn.alternate;b=b!==null?b.memoizedState:null}else b=Vr.next;var C=ua===null?zn.memoizedState:ua.next;if(C!==null)ua=C,Vr=b;else{if(b===null)throw zn.alternate===null?Error(r(467)):Error(r(310));Vr=b,b={memoizedState:Vr.memoizedState,baseState:Vr.baseState,baseQueue:Vr.baseQueue,queue:Vr.queue,next:null},ua===null?zn.memoizedState=ua=b:ua=ua.next=b}return ua}function u4(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function f1(b){var C=u1;return u1+=1,_p===null&&(_p=[]),b=wO(_p,b,C),C=zn,(ua===null?C.memoizedState:ua.next)===null&&(C=C.alternate,U.H=C===null||C.memoizedState===null?cM:uM),b}function Vy(b){if(b!==null&&typeof b=="object"){if(typeof b.then=="function")return f1(b);if(b.$$typeof===x)return yo(b)}throw Error(r(438,String(b)))}function f4(b){var C=null,E=zn.updateQueue;if(E!==null&&(C=E.memoCache),C==null){var O=zn.alternate;O!==null&&(O=O.updateQueue,O!==null&&(O=O.memoCache,O!=null&&(C={data:O.data.map(function(N){return N.slice()}),index:0})))}if(C==null&&(C={data:[],index:0}),E===null&&(E=u4(),zn.updateQueue=E),E.memoCache=C,E=C.data[C.index],E===void 0)for(E=C.data[C.index]=Array(b),O=0;O<b;O++)E[O]=R;return C.index++,E}function zu(b,C){return typeof C=="function"?C(b):C}function Fy(b){var C=fa();return d4(C,Vr,b)}function d4(b,C,E){var O=b.queue;if(O===null)throw Error(r(311));O.lastRenderedReducer=E;var N=b.baseQueue,z=O.pending;if(z!==null){if(N!==null){var ce=N.next;N.next=z.next,z.next=ce}C.baseQueue=N=z,O.pending=null}if(z=b.baseState,N===null)b.memoizedState=z;else{C=N.next;var xe=ce=null,Ve=null,nt=C,wt=!1;do{var Ot=nt.lane&-536870913;if(Ot!==nt.lane?(lr&Ot)===Ot:(qf&Ot)===Ot){var it=nt.revertLane;if(it===0)Ve!==null&&(Ve=Ve.next={lane:0,revertLane:0,action:nt.action,hasEagerState:nt.hasEagerState,eagerState:nt.eagerState,next:null}),Ot===Cp&&(wt=!0);else if((qf&it)===it){nt=nt.next,it===Cp&&(wt=!0);continue}else Ot={lane:0,revertLane:nt.revertLane,action:nt.action,hasEagerState:nt.hasEagerState,eagerState:nt.eagerState,next:null},Ve===null?(xe=Ve=Ot,ce=z):Ve=Ve.next=Ot,zn.lanes|=it,td|=it;Ot=nt.action,k0&&E(z,Ot),z=nt.hasEagerState?nt.eagerState:E(z,Ot)}else it={lane:Ot,revertLane:nt.revertLane,action:nt.action,hasEagerState:nt.hasEagerState,eagerState:nt.eagerState,next:null},Ve===null?(xe=Ve=it,ce=z):Ve=Ve.next=it,zn.lanes|=Ot,td|=Ot;nt=nt.next}while(nt!==null&&nt!==C);if(Ve===null?ce=z:Ve.next=xe,!be(z,b.memoizedState)&&(Ua=!0,wt&&(E=Sp,E!==null)))throw E;b.memoizedState=z,b.baseState=ce,b.baseQueue=Ve,O.lastRenderedState=z}return N===null&&(O.lanes=0),[b.memoizedState,O.dispatch]}function h4(b){var C=fa(),E=C.queue;if(E===null)throw Error(r(311));E.lastRenderedReducer=b;var O=E.dispatch,N=E.pending,z=C.memoizedState;if(N!==null){E.pending=null;var ce=N=N.next;do z=b(z,ce.action),ce=ce.next;while(ce!==N);be(z,C.memoizedState)||(Ua=!0),C.memoizedState=z,C.baseQueue===null&&(C.baseState=z),E.lastRenderedState=z}return[z,O]}function MO(b,C,E){var O=zn,N=fa(),z=xr;if(z){if(E===void 0)throw Error(r(407));E=E()}else E=C();var ce=!be((Vr||N).memoizedState,E);ce&&(N.memoizedState=E,Ua=!0),N=N.queue;var xe=AO.bind(null,O,N,b);if(d1(2048,8,xe,[b]),N.getSnapshot!==C||ce||ua!==null&&ua.memoizedState.tag&1){if(O.flags|=2048,Dp(9,Uy(),RO.bind(null,O,N,E,C),null),qr===null)throw Error(r(349));z||(qf&124)!==0||IO(O,C,E)}return E}function IO(b,C,E){b.flags|=16384,b={getSnapshot:C,value:E},C=zn.updateQueue,C===null?(C=u4(),zn.updateQueue=C,C.stores=[b]):(E=C.stores,E===null?C.stores=[b]:E.push(b))}function RO(b,C,E,O){C.value=E,C.getSnapshot=O,PO(C)&&NO(b)}function AO(b,C,E){return E(function(){PO(C)&&NO(b)})}function PO(b){var C=b.getSnapshot;b=b.value;try{var E=C();return!be(b,E)}catch{return!0}}function NO(b){var C=yp(b,2);C!==null&&Us(C,b,2)}function p4(b){var C=fs();if(typeof b=="function"){var E=b;if(b=E(),k0){Je(!0);try{E()}finally{Je(!1)}}}return C.memoizedState=C.baseState=b,C.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:zu,lastRenderedState:b},C}function LO(b,C,E,O){return b.baseState=E,d4(b,Vr,typeof O=="function"?O:zu)}function Kte(b,C,E,O,N){if($y(b))throw Error(r(485));if(b=C.action,b!==null){var z={payload:N,action:b,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(ce){z.listeners.push(ce)}};U.T!==null?E(!0):z.isTransition=!1,O(z),E=C.pending,E===null?(z.next=C.pending=z,kO(C,z)):(z.next=E.next,C.pending=E.next=z)}}function kO(b,C){var E=C.action,O=C.payload,N=b.state;if(C.isTransition){var z=U.T,ce={};U.T=ce;try{var xe=E(N,O),Ve=U.S;Ve!==null&&Ve(ce,xe),VO(b,C,xe)}catch(nt){g4(b,C,nt)}finally{U.T=z}}else try{z=E(N,O),VO(b,C,z)}catch(nt){g4(b,C,nt)}}function VO(b,C,E){E!==null&&typeof E=="object"&&typeof E.then=="function"?E.then(function(O){FO(b,C,O)},function(O){return g4(b,C,O)}):FO(b,C,E)}function FO(b,C,E){C.status="fulfilled",C.value=E,UO(C),b.state=E,C=b.pending,C!==null&&(E=C.next,E===C?b.pending=null:(E=E.next,C.next=E,kO(b,E)))}function g4(b,C,E){var O=b.pending;if(b.pending=null,O!==null){O=O.next;do C.status="rejected",C.reason=E,UO(C),C=C.next;while(C!==O)}b.action=null}function UO(b){b=b.listeners;for(var C=0;C<b.length;C++)(0,b[C])()}function BO(b,C){return C}function $O(b,C){if(xr){var E=qr.formState;if(E!==null){e:{var O=zn;if(xr){if(Ui){t:{for(var N=Ui,z=Nc;N.nodeType!==8;){if(!z){N=null;break t}if(N=Ql(N.nextSibling),N===null){N=null;break t}}z=N.data,N=z==="F!"||z==="F"?N:null}if(N){Ui=Ql(N.nextSibling),O=N.data==="F!";break e}}A0(O)}O=!1}O&&(C=E[0])}}return E=fs(),E.memoizedState=E.baseState=C,O={pending:null,lanes:0,dispatch:null,lastRenderedReducer:BO,lastRenderedState:C},E.queue=O,E=oM.bind(null,zn,O),O.dispatch=E,O=p4(!1),z=b4.bind(null,zn,!1,O.queue),O=fs(),N={state:C,dispatch:null,action:b,pending:null},O.queue=N,E=Kte.bind(null,zn,N,z,E),N.dispatch=E,O.memoizedState=b,[C,E,!1]}function GO(b){var C=fa();return jO(C,Vr,b)}function jO(b,C,E){if(C=d4(b,C,BO)[0],b=Fy(zu)[0],typeof C=="object"&&C!==null&&typeof C.then=="function")try{var O=f1(C)}catch(ce){throw ce===a1?Ay:ce}else O=C;C=fa();var N=C.queue,z=N.dispatch;return E!==C.memoizedState&&(zn.flags|=2048,Dp(9,Uy(),qte.bind(null,N,E),null)),[O,z,b]}function qte(b,C){b.action=C}function zO(b){var C=fa(),E=Vr;if(E!==null)return jO(C,E,b);fa(),C=C.memoizedState,E=fa();var O=E.queue.dispatch;return E.memoizedState=b,[C,O,!1]}function Dp(b,C,E,O){return b={tag:b,create:E,deps:O,inst:C,next:null},C=zn.updateQueue,C===null&&(C=u4(),zn.updateQueue=C),E=C.lastEffect,E===null?C.lastEffect=b.next=b:(O=E.next,E.next=b,b.next=O,C.lastEffect=b),b}function Uy(){return{destroy:void 0,resource:void 0}}function WO(){return fa().memoizedState}function By(b,C,E,O){var N=fs();O=O===void 0?null:O,zn.flags|=b,N.memoizedState=Dp(1|C,Uy(),E,O)}function d1(b,C,E,O){var N=fa();O=O===void 0?null:O;var z=N.memoizedState.inst;Vr!==null&&O!==null&&a4(O,Vr.memoizedState.deps)?N.memoizedState=Dp(C,z,E,O):(zn.flags|=b,N.memoizedState=Dp(1|C,z,E,O))}function HO(b,C){By(8390656,8,b,C)}function KO(b,C){d1(2048,8,b,C)}function qO(b,C){return d1(4,2,b,C)}function XO(b,C){return d1(4,4,b,C)}function YO(b,C){if(typeof C=="function"){b=b();var E=C(b);return function(){typeof E=="function"?E():C(null)}}if(C!=null)return b=b(),C.current=b,function(){C.current=null}}function JO(b,C,E){E=E!=null?E.concat([b]):null,d1(4,4,YO.bind(null,C,b),E)}function m4(){}function ZO(b,C){var E=fa();C=C===void 0?null:C;var O=E.memoizedState;return C!==null&&a4(C,O[1])?O[0]:(E.memoizedState=[b,C],b)}function QO(b,C){var E=fa();C=C===void 0?null:C;var O=E.memoizedState;if(C!==null&&a4(C,O[1]))return O[0];if(O=b(),k0){Je(!0);try{b()}finally{Je(!1)}}return E.memoizedState=[O,C],O}function v4(b,C,E){return E===void 0||(qf&1073741824)!==0?b.memoizedState=C:(b.memoizedState=E,b=nI(),zn.lanes|=b,td|=b,E)}function eM(b,C,E,O){return be(E,C)?E:Tp.current!==null?(b=v4(b,E,O),be(b,C)||(Ua=!0),b):(qf&42)===0?(Ua=!0,b.memoizedState=E):(b=nI(),zn.lanes|=b,td|=b,C)}function tM(b,C,E,O,N){var z=G.p;G.p=z!==0&&8>z?z:8;var ce=U.T,xe={};U.T=xe,b4(b,!1,C,E);try{var Ve=N(),nt=U.S;if(nt!==null&&nt(xe,Ve),Ve!==null&&typeof Ve=="object"&&typeof Ve.then=="function"){var wt=zte(Ve,O);h1(b,C,wt,Fs(b))}else h1(b,C,O,Fs(b))}catch(Ot){h1(b,C,{then:function(){},status:"rejected",reason:Ot},Fs())}finally{G.p=z,U.T=ce}}function Xte(){}function y4(b,C,E,O){if(b.tag!==5)throw Error(r(476));var N=nM(b).queue;tM(b,N,C,F,E===null?Xte:function(){return rM(b),E(O)})}function nM(b){var C=b.memoizedState;if(C!==null)return C;C={memoizedState:F,baseState:F,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:zu,lastRenderedState:F},next:null};var E={};return C.next={memoizedState:E,baseState:E,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:zu,lastRenderedState:E},next:null},b.memoizedState=C,b=b.alternate,b!==null&&(b.memoizedState=C),C}function rM(b){var C=nM(b).next.queue;h1(b,C,{},Fs())}function x4(){return yo(R1)}function iM(){return fa().memoizedState}function aM(){return fa().memoizedState}function Yte(b){for(var C=b.return;C!==null;){switch(C.tag){case 24:case 3:var E=Fs();b=Hf(E);var O=Kf(C,b,E);O!==null&&(Us(O,C,E),s1(O,C,E)),C={cache:XC()},b.payload=C;return}C=C.return}}function Jte(b,C,E){var O=Fs();E={lane:O,revertLane:0,action:E,hasEagerState:!1,eagerState:null,next:null},$y(b)?sM(C,E):(E=UC(b,C,E,O),E!==null&&(Us(E,b,O),lM(E,C,O)))}function oM(b,C,E){var O=Fs();h1(b,C,E,O)}function h1(b,C,E,O){var N={lane:O,revertLane:0,action:E,hasEagerState:!1,eagerState:null,next:null};if($y(b))sM(C,N);else{var z=b.alternate;if(b.lanes===0&&(z===null||z.lanes===0)&&(z=C.lastRenderedReducer,z!==null))try{var ce=C.lastRenderedState,xe=z(ce,E);if(N.hasEagerState=!0,N.eagerState=xe,be(xe,ce))return Ty(b,C,N,0),qr===null&&Sy(),!1}catch{}finally{}if(E=UC(b,C,N,O),E!==null)return Us(E,b,O),lM(E,C,O),!0}return!1}function b4(b,C,E,O){if(O={lane:2,revertLane:Z4(),action:O,hasEagerState:!1,eagerState:null,next:null},$y(b)){if(C)throw Error(r(479))}else C=UC(b,E,O,2),C!==null&&Us(C,b,2)}function $y(b){var C=b.alternate;return b===zn||C!==null&&C===zn}function sM(b,C){Ep=Ly=!0;var E=b.pending;E===null?C.next=C:(C.next=E.next,E.next=C),b.pending=C}function lM(b,C,E){if((E&4194048)!==0){var O=C.lanes;O&=b.pendingLanes,E|=O,C.lanes=E,Qn(b,E)}}var Gy={readContext:yo,use:Vy,useCallback:Xi,useContext:Xi,useEffect:Xi,useImperativeHandle:Xi,useLayoutEffect:Xi,useInsertionEffect:Xi,useMemo:Xi,useReducer:Xi,useRef:Xi,useState:Xi,useDebugValue:Xi,useDeferredValue:Xi,useTransition:Xi,useSyncExternalStore:Xi,useId:Xi,useHostTransitionStatus:Xi,useFormState:Xi,useActionState:Xi,useOptimistic:Xi,useMemoCache:Xi,useCacheRefresh:Xi},cM={readContext:yo,use:Vy,useCallback:function(b,C){return fs().memoizedState=[b,C===void 0?null:C],b},useContext:yo,useEffect:HO,useImperativeHandle:function(b,C,E){E=E!=null?E.concat([b]):null,By(4194308,4,YO.bind(null,C,b),E)},useLayoutEffect:function(b,C){return By(4194308,4,b,C)},useInsertionEffect:function(b,C){By(4,2,b,C)},useMemo:function(b,C){var E=fs();C=C===void 0?null:C;var O=b();if(k0){Je(!0);try{b()}finally{Je(!1)}}return E.memoizedState=[O,C],O},useReducer:function(b,C,E){var O=fs();if(E!==void 0){var N=E(C);if(k0){Je(!0);try{E(C)}finally{Je(!1)}}}else N=C;return O.memoizedState=O.baseState=N,b={pending:null,lanes:0,dispatch:null,lastRenderedReducer:b,lastRenderedState:N},O.queue=b,b=b.dispatch=Jte.bind(null,zn,b),[O.memoizedState,b]},useRef:function(b){var C=fs();return b={current:b},C.memoizedState=b},useState:function(b){b=p4(b);var C=b.queue,E=oM.bind(null,zn,C);return C.dispatch=E,[b.memoizedState,E]},useDebugValue:m4,useDeferredValue:function(b,C){var E=fs();return v4(E,b,C)},useTransition:function(){var b=p4(!1);return b=tM.bind(null,zn,b.queue,!0,!1),fs().memoizedState=b,[!1,b]},useSyncExternalStore:function(b,C,E){var O=zn,N=fs();if(xr){if(E===void 0)throw Error(r(407));E=E()}else{if(E=C(),qr===null)throw Error(r(349));(lr&124)!==0||IO(O,C,E)}N.memoizedState=E;var z={value:E,getSnapshot:C};return N.queue=z,HO(AO.bind(null,O,z,b),[b]),O.flags|=2048,Dp(9,Uy(),RO.bind(null,O,z,E,C),null),E},useId:function(){var b=fs(),C=qr.identifierPrefix;if(xr){var E=$u,O=Bu;E=(O&~(1<<32-$e(O)-1)).toString(32)+E,C="«"+C+"R"+E,E=ky++,0<E&&(C+="H"+E.toString(32)),C+="»"}else E=Wte++,C="«"+C+"r"+E.toString(32)+"»";return b.memoizedState=C},useHostTransitionStatus:x4,useFormState:$O,useActionState:$O,useOptimistic:function(b){var C=fs();C.memoizedState=C.baseState=b;var E={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return C.queue=E,C=b4.bind(null,zn,!0,E),E.dispatch=C,[b,C]},useMemoCache:f4,useCacheRefresh:function(){return fs().memoizedState=Yte.bind(null,zn)}},uM={readContext:yo,use:Vy,useCallback:ZO,useContext:yo,useEffect:KO,useImperativeHandle:JO,useInsertionEffect:qO,useLayoutEffect:XO,useMemo:QO,useReducer:Fy,useRef:WO,useState:function(){return Fy(zu)},useDebugValue:m4,useDeferredValue:function(b,C){var E=fa();return eM(E,Vr.memoizedState,b,C)},useTransition:function(){var b=Fy(zu)[0],C=fa().memoizedState;return[typeof b=="boolean"?b:f1(b),C]},useSyncExternalStore:MO,useId:iM,useHostTransitionStatus:x4,useFormState:GO,useActionState:GO,useOptimistic:function(b,C){var E=fa();return LO(E,Vr,b,C)},useMemoCache:f4,useCacheRefresh:aM},Zte={readContext:yo,use:Vy,useCallback:ZO,useContext:yo,useEffect:KO,useImperativeHandle:JO,useInsertionEffect:qO,useLayoutEffect:XO,useMemo:QO,useReducer:h4,useRef:WO,useState:function(){return h4(zu)},useDebugValue:m4,useDeferredValue:function(b,C){var E=fa();return Vr===null?v4(E,b,C):eM(E,Vr.memoizedState,b,C)},useTransition:function(){var b=h4(zu)[0],C=fa().memoizedState;return[typeof b=="boolean"?b:f1(b),C]},useSyncExternalStore:MO,useId:iM,useHostTransitionStatus:x4,useFormState:zO,useActionState:zO,useOptimistic:function(b,C){var E=fa();return Vr!==null?LO(E,Vr,b,C):(E.baseState=b,[b,E.queue.dispatch])},useMemoCache:f4,useCacheRefresh:aM},Op=null,p1=0;function jy(b){var C=p1;return p1+=1,Op===null&&(Op=[]),wO(Op,b,C)}function g1(b,C){C=C.props.ref,b.ref=C!==void 0?C:null}function zy(b,C){throw C.$$typeof===u?Error(r(525)):(b=Object.prototype.toString.call(C),Error(r(31,b==="[object Object]"?"object with keys {"+Object.keys(C).join(", ")+"}":b)))}function fM(b){var C=b._init;return C(b._payload)}function dM(b){function C(Xe,je){if(b){var tt=Xe.deletions;tt===null?(Xe.deletions=[je],Xe.flags|=16):tt.push(je)}}function E(Xe,je){if(!b)return null;for(;je!==null;)C(Xe,je),je=je.sibling;return null}function O(Xe){for(var je=new Map;Xe!==null;)Xe.key!==null?je.set(Xe.key,Xe):je.set(Xe.index,Xe),Xe=Xe.sibling;return je}function N(Xe,je){return Xe=Uu(Xe,je),Xe.index=0,Xe.sibling=null,Xe}function z(Xe,je,tt){return Xe.index=tt,b?(tt=Xe.alternate,tt!==null?(tt=tt.index,tt<je?(Xe.flags|=67108866,je):tt):(Xe.flags|=67108866,je)):(Xe.flags|=1048576,je)}function ce(Xe){return b&&Xe.alternate===null&&(Xe.flags|=67108866),Xe}function xe(Xe,je,tt,Et){return je===null||je.tag!==6?(je=$C(tt,Xe.mode,Et),je.return=Xe,je):(je=N(je,tt),je.return=Xe,je)}function Ve(Xe,je,tt,Et){var Yt=tt.type;return Yt===p?wt(Xe,je,tt.props.children,Et,tt.key):je!==null&&(je.elementType===Yt||typeof Yt=="object"&&Yt!==null&&Yt.$$typeof===D&&fM(Yt)===je.type)?(je=N(je,tt.props),g1(je,tt),je.return=Xe,je):(je=_y(tt.type,tt.key,tt.props,null,Xe.mode,Et),g1(je,tt),je.return=Xe,je)}function nt(Xe,je,tt,Et){return je===null||je.tag!==4||je.stateNode.containerInfo!==tt.containerInfo||je.stateNode.implementation!==tt.implementation?(je=GC(tt,Xe.mode,Et),je.return=Xe,je):(je=N(je,tt.children||[]),je.return=Xe,je)}function wt(Xe,je,tt,Et,Yt){return je===null||je.tag!==7?(je=O0(tt,Xe.mode,Et,Yt),je.return=Xe,je):(je=N(je,tt),je.return=Xe,je)}function Ot(Xe,je,tt){if(typeof je=="string"&&je!==""||typeof je=="number"||typeof je=="bigint")return je=$C(""+je,Xe.mode,tt),je.return=Xe,je;if(typeof je=="object"&&je!==null){switch(je.$$typeof){case d:return tt=_y(je.type,je.key,je.props,null,Xe.mode,tt),g1(tt,je),tt.return=Xe,tt;case h:return je=GC(je,Xe.mode,tt),je.return=Xe,je;case D:var Et=je._init;return je=Et(je._payload),Ot(Xe,je,tt)}if(B(je)||A(je))return je=O0(je,Xe.mode,tt,null),je.return=Xe,je;if(typeof je.then=="function")return Ot(Xe,jy(je),tt);if(je.$$typeof===x)return Ot(Xe,Iy(Xe,je),tt);zy(Xe,je)}return null}function it(Xe,je,tt,Et){var Yt=je!==null?je.key:null;if(typeof tt=="string"&&tt!==""||typeof tt=="number"||typeof tt=="bigint")return Yt!==null?null:xe(Xe,je,""+tt,Et);if(typeof tt=="object"&&tt!==null){switch(tt.$$typeof){case d:return tt.key===Yt?Ve(Xe,je,tt,Et):null;case h:return tt.key===Yt?nt(Xe,je,tt,Et):null;case D:return Yt=tt._init,tt=Yt(tt._payload),it(Xe,je,tt,Et)}if(B(tt)||A(tt))return Yt!==null?null:wt(Xe,je,tt,Et,null);if(typeof tt.then=="function")return it(Xe,je,jy(tt),Et);if(tt.$$typeof===x)return it(Xe,je,Iy(Xe,tt),Et);zy(Xe,tt)}return null}function ot(Xe,je,tt,Et,Yt){if(typeof Et=="string"&&Et!==""||typeof Et=="number"||typeof Et=="bigint")return Xe=Xe.get(tt)||null,xe(je,Xe,""+Et,Yt);if(typeof Et=="object"&&Et!==null){switch(Et.$$typeof){case d:return Xe=Xe.get(Et.key===null?tt:Et.key)||null,Ve(je,Xe,Et,Yt);case h:return Xe=Xe.get(Et.key===null?tt:Et.key)||null,nt(je,Xe,Et,Yt);case D:var qn=Et._init;return Et=qn(Et._payload),ot(Xe,je,tt,Et,Yt)}if(B(Et)||A(Et))return Xe=Xe.get(tt)||null,wt(je,Xe,Et,Yt,null);if(typeof Et.then=="function")return ot(Xe,je,tt,jy(Et),Yt);if(Et.$$typeof===x)return ot(Xe,je,tt,Iy(je,Et),Yt);zy(je,Et)}return null}function Cn(Xe,je,tt,Et){for(var Yt=null,qn=null,cn=je,xn=je=0,$a=null;cn!==null&&xn<tt.length;xn++){cn.index>xn?($a=cn,cn=null):$a=cn.sibling;var gr=it(Xe,cn,tt[xn],Et);if(gr===null){cn===null&&(cn=$a);break}b&&cn&&gr.alternate===null&&C(Xe,cn),je=z(gr,je,xn),qn===null?Yt=gr:qn.sibling=gr,qn=gr,cn=$a}if(xn===tt.length)return E(Xe,cn),xr&&I0(Xe,xn),Yt;if(cn===null){for(;xn<tt.length;xn++)cn=Ot(Xe,tt[xn],Et),cn!==null&&(je=z(cn,je,xn),qn===null?Yt=cn:qn.sibling=cn,qn=cn);return xr&&I0(Xe,xn),Yt}for(cn=O(cn);xn<tt.length;xn++)$a=ot(cn,Xe,xn,tt[xn],Et),$a!==null&&(b&&$a.alternate!==null&&cn.delete($a.key===null?xn:$a.key),je=z($a,je,xn),qn===null?Yt=$a:qn.sibling=$a,qn=$a);return b&&cn.forEach(function(ud){return C(Xe,ud)}),xr&&I0(Xe,xn),Yt}function vn(Xe,je,tt,Et){if(tt==null)throw Error(r(151));for(var Yt=null,qn=null,cn=je,xn=je=0,$a=null,gr=tt.next();cn!==null&&!gr.done;xn++,gr=tt.next()){cn.index>xn?($a=cn,cn=null):$a=cn.sibling;var ud=it(Xe,cn,gr.value,Et);if(ud===null){cn===null&&(cn=$a);break}b&&cn&&ud.alternate===null&&C(Xe,cn),je=z(ud,je,xn),qn===null?Yt=ud:qn.sibling=ud,qn=ud,cn=$a}if(gr.done)return E(Xe,cn),xr&&I0(Xe,xn),Yt;if(cn===null){for(;!gr.done;xn++,gr=tt.next())gr=Ot(Xe,gr.value,Et),gr!==null&&(je=z(gr,je,xn),qn===null?Yt=gr:qn.sibling=gr,qn=gr);return xr&&I0(Xe,xn),Yt}for(cn=O(cn);!gr.done;xn++,gr=tt.next())gr=ot(cn,Xe,xn,gr.value,Et),gr!==null&&(b&&gr.alternate!==null&&cn.delete(gr.key===null?xn:gr.key),je=z(gr,je,xn),qn===null?Yt=gr:qn.sibling=gr,qn=gr);return b&&cn.forEach(function(Qne){return C(Xe,Qne)}),xr&&I0(Xe,xn),Yt}function Ur(Xe,je,tt,Et){if(typeof tt=="object"&&tt!==null&&tt.type===p&&tt.key===null&&(tt=tt.props.children),typeof tt=="object"&&tt!==null){switch(tt.$$typeof){case d:e:{for(var Yt=tt.key;je!==null;){if(je.key===Yt){if(Yt=tt.type,Yt===p){if(je.tag===7){E(Xe,je.sibling),Et=N(je,tt.props.children),Et.return=Xe,Xe=Et;break e}}else if(je.elementType===Yt||typeof Yt=="object"&&Yt!==null&&Yt.$$typeof===D&&fM(Yt)===je.type){E(Xe,je.sibling),Et=N(je,tt.props),g1(Et,tt),Et.return=Xe,Xe=Et;break e}E(Xe,je);break}else C(Xe,je);je=je.sibling}tt.type===p?(Et=O0(tt.props.children,Xe.mode,Et,tt.key),Et.return=Xe,Xe=Et):(Et=_y(tt.type,tt.key,tt.props,null,Xe.mode,Et),g1(Et,tt),Et.return=Xe,Xe=Et)}return ce(Xe);case h:e:{for(Yt=tt.key;je!==null;){if(je.key===Yt)if(je.tag===4&&je.stateNode.containerInfo===tt.containerInfo&&je.stateNode.implementation===tt.implementation){E(Xe,je.sibling),Et=N(je,tt.children||[]),Et.return=Xe,Xe=Et;break e}else{E(Xe,je);break}else C(Xe,je);je=je.sibling}Et=GC(tt,Xe.mode,Et),Et.return=Xe,Xe=Et}return ce(Xe);case D:return Yt=tt._init,tt=Yt(tt._payload),Ur(Xe,je,tt,Et)}if(B(tt))return Cn(Xe,je,tt,Et);if(A(tt)){if(Yt=A(tt),typeof Yt!="function")throw Error(r(150));return tt=Yt.call(tt),vn(Xe,je,tt,Et)}if(typeof tt.then=="function")return Ur(Xe,je,jy(tt),Et);if(tt.$$typeof===x)return Ur(Xe,je,Iy(Xe,tt),Et);zy(Xe,tt)}return typeof tt=="string"&&tt!==""||typeof tt=="number"||typeof tt=="bigint"?(tt=""+tt,je!==null&&je.tag===6?(E(Xe,je.sibling),Et=N(je,tt),Et.return=Xe,Xe=Et):(E(Xe,je),Et=$C(tt,Xe.mode,Et),Et.return=Xe,Xe=Et),ce(Xe)):E(Xe,je)}return function(Xe,je,tt,Et){try{p1=0;var Yt=Ur(Xe,je,tt,Et);return Op=null,Yt}catch(cn){if(cn===a1||cn===Ay)throw cn;var qn=Ns(29,cn,null,Xe.mode);return qn.lanes=Et,qn.return=Xe,qn}finally{}}}var Mp=dM(!0),hM=dM(!1),yl=X(null),Lc=null;function Xf(b){var C=b.alternate;re(_a,_a.current&1),re(yl,b),Lc===null&&(C===null||Tp.current!==null||C.memoizedState!==null)&&(Lc=b)}function pM(b){if(b.tag===22){if(re(_a,_a.current),re(yl,b),Lc===null){var C=b.alternate;C!==null&&C.memoizedState!==null&&(Lc=b)}}else Yf()}function Yf(){re(_a,_a.current),re(yl,yl.current)}function Wu(b){Q(yl),Lc===b&&(Lc=null),Q(_a)}var _a=X(0);function Wy(b){for(var C=b;C!==null;){if(C.tag===13){var E=C.memoizedState;if(E!==null&&(E=E.dehydrated,E===null||E.data==="$?"||uS(E)))return C}else if(C.tag===19&&C.memoizedProps.revealOrder!==void 0){if((C.flags&128)!==0)return C}else if(C.child!==null){C.child.return=C,C=C.child;continue}if(C===b)break;for(;C.sibling===null;){if(C.return===null||C.return===b)return null;C=C.return}C.sibling.return=C.return,C=C.sibling}return null}function w4(b,C,E,O){C=b.memoizedState,E=E(O,C),E=E==null?C:f({},C,E),b.memoizedState=E,b.lanes===0&&(b.updateQueue.baseState=E)}var C4={enqueueSetState:function(b,C,E){b=b._reactInternals;var O=Fs(),N=Hf(O);N.payload=C,E!=null&&(N.callback=E),C=Kf(b,N,O),C!==null&&(Us(C,b,O),s1(C,b,O))},enqueueReplaceState:function(b,C,E){b=b._reactInternals;var O=Fs(),N=Hf(O);N.tag=1,N.payload=C,E!=null&&(N.callback=E),C=Kf(b,N,O),C!==null&&(Us(C,b,O),s1(C,b,O))},enqueueForceUpdate:function(b,C){b=b._reactInternals;var E=Fs(),O=Hf(E);O.tag=2,C!=null&&(O.callback=C),C=Kf(b,O,E),C!==null&&(Us(C,b,E),s1(C,b,E))}};function gM(b,C,E,O,N,z,ce){return b=b.stateNode,typeof b.shouldComponentUpdate=="function"?b.shouldComponentUpdate(O,z,ce):C.prototype&&C.prototype.isPureReactComponent?!Ee(E,O)||!Ee(N,z):!0}function mM(b,C,E,O){b=C.state,typeof C.componentWillReceiveProps=="function"&&C.componentWillReceiveProps(E,O),typeof C.UNSAFE_componentWillReceiveProps=="function"&&C.UNSAFE_componentWillReceiveProps(E,O),C.state!==b&&C4.enqueueReplaceState(C,C.state,null)}function V0(b,C){var E=C;if("ref"in C){E={};for(var O in C)O!=="ref"&&(E[O]=C[O])}if(b=b.defaultProps){E===C&&(E=f({},E));for(var N in b)E[N]===void 0&&(E[N]=b[N])}return E}var Hy=typeof reportError=="function"?reportError:function(b){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var C=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof b=="object"&&b!==null&&typeof b.message=="string"?String(b.message):String(b),error:b});if(!window.dispatchEvent(C))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",b);return}console.error(b)};function vM(b){Hy(b)}function yM(b){console.error(b)}function xM(b){Hy(b)}function Ky(b,C){try{var E=b.onUncaughtError;E(C.value,{componentStack:C.stack})}catch(O){setTimeout(function(){throw O})}}function bM(b,C,E){try{var O=b.onCaughtError;O(E.value,{componentStack:E.stack,errorBoundary:C.tag===1?C.stateNode:null})}catch(N){setTimeout(function(){throw N})}}function S4(b,C,E){return E=Hf(E),E.tag=3,E.payload={element:null},E.callback=function(){Ky(b,C)},E}function wM(b){return b=Hf(b),b.tag=3,b}function CM(b,C,E,O){var N=E.type.getDerivedStateFromError;if(typeof N=="function"){var z=O.value;b.payload=function(){return N(z)},b.callback=function(){bM(C,E,O)}}var ce=E.stateNode;ce!==null&&typeof ce.componentDidCatch=="function"&&(b.callback=function(){bM(C,E,O),typeof N!="function"&&(nd===null?nd=new Set([this]):nd.add(this));var xe=O.stack;this.componentDidCatch(O.value,{componentStack:xe!==null?xe:""})})}function Qte(b,C,E,O,N){if(E.flags|=32768,O!==null&&typeof O=="object"&&typeof O.then=="function"){if(C=E.alternate,C!==null&&n1(C,E,N,!0),E=yl.current,E!==null){switch(E.tag){case 13:return Lc===null?K4():E.alternate===null&&Bi===0&&(Bi=3),E.flags&=-257,E.flags|=65536,E.lanes=N,O===ZC?E.flags|=16384:(C=E.updateQueue,C===null?E.updateQueue=new Set([O]):C.add(O),X4(b,O,N)),!1;case 22:return E.flags|=65536,O===ZC?E.flags|=16384:(C=E.updateQueue,C===null?(C={transitions:null,markerInstances:null,retryQueue:new Set([O])},E.updateQueue=C):(E=C.retryQueue,E===null?C.retryQueue=new Set([O]):E.add(O)),X4(b,O,N)),!1}throw Error(r(435,E.tag))}return X4(b,O,N),K4(),!1}if(xr)return C=yl.current,C!==null?((C.flags&65536)===0&&(C.flags|=256),C.flags|=65536,C.lanes=N,O!==WC&&(b=Error(r(422),{cause:O}),t1(pl(b,E)))):(O!==WC&&(C=Error(r(423),{cause:O}),t1(pl(C,E))),b=b.current.alternate,b.flags|=65536,N&=-N,b.lanes|=N,O=pl(O,E),N=S4(b.stateNode,O,N),t4(b,N),Bi!==4&&(Bi=2)),!1;var z=Error(r(520),{cause:O});if(z=pl(z,E),C1===null?C1=[z]:C1.push(z),Bi!==4&&(Bi=2),C===null)return!0;O=pl(O,E),E=C;do{switch(E.tag){case 3:return E.flags|=65536,b=N&-N,E.lanes|=b,b=S4(E.stateNode,O,b),t4(E,b),!1;case 1:if(C=E.type,z=E.stateNode,(E.flags&128)===0&&(typeof C.getDerivedStateFromError=="function"||z!==null&&typeof z.componentDidCatch=="function"&&(nd===null||!nd.has(z))))return E.flags|=65536,N&=-N,E.lanes|=N,N=wM(N),CM(N,b,E,O),t4(E,N),!1}E=E.return}while(E!==null);return!1}var SM=Error(r(461)),Ua=!1;function Qa(b,C,E,O){C.child=b===null?hM(C,null,E,O):Mp(C,b.child,E,O)}function TM(b,C,E,O,N){E=E.render;var z=C.ref;if("ref"in O){var ce={};for(var xe in O)xe!=="ref"&&(ce[xe]=O[xe])}else ce=O;return N0(C),O=o4(b,C,E,ce,z,N),xe=s4(),b!==null&&!Ua?(l4(b,C,N),Hu(b,C,N)):(xr&&xe&&jC(C),C.flags|=1,Qa(b,C,O,N),C.child)}function EM(b,C,E,O,N){if(b===null){var z=E.type;return typeof z=="function"&&!BC(z)&&z.defaultProps===void 0&&E.compare===null?(C.tag=15,C.type=z,_M(b,C,z,O,N)):(b=_y(E.type,null,O,C,C.mode,N),b.ref=C.ref,b.return=C,C.child=b)}if(z=b.child,!R4(b,N)){var ce=z.memoizedProps;if(E=E.compare,E=E!==null?E:Ee,E(ce,O)&&b.ref===C.ref)return Hu(b,C,N)}return C.flags|=1,b=Uu(z,O),b.ref=C.ref,b.return=C,C.child=b}function _M(b,C,E,O,N){if(b!==null){var z=b.memoizedProps;if(Ee(z,O)&&b.ref===C.ref)if(Ua=!1,C.pendingProps=O=z,R4(b,N))(b.flags&131072)!==0&&(Ua=!0);else return C.lanes=b.lanes,Hu(b,C,N)}return T4(b,C,E,O,N)}function DM(b,C,E){var O=C.pendingProps,N=O.children,z=b!==null?b.memoizedState:null;if(O.mode==="hidden"){if((C.flags&128)!==0){if(O=z!==null?z.baseLanes|E:E,b!==null){for(N=C.child=b.child,z=0;N!==null;)z=z|N.lanes|N.childLanes,N=N.sibling;C.childLanes=z&~O}else C.childLanes=0,C.child=null;return OM(b,C,O,E)}if((E&536870912)!==0)C.memoizedState={baseLanes:0,cachePool:null},b!==null&&Ry(C,z!==null?z.cachePool:null),z!==null?_O(C,z):r4(),pM(C);else return C.lanes=C.childLanes=536870912,OM(b,C,z!==null?z.baseLanes|E:E,E)}else z!==null?(Ry(C,z.cachePool),_O(C,z),Yf(),C.memoizedState=null):(b!==null&&Ry(C,null),r4(),Yf());return Qa(b,C,N,E),C.child}function OM(b,C,E,O){var N=JC();return N=N===null?null:{parent:Ea._currentValue,pool:N},C.memoizedState={baseLanes:E,cachePool:N},b!==null&&Ry(C,null),r4(),pM(C),b!==null&&n1(b,C,O,!0),null}function qy(b,C){var E=C.ref;if(E===null)b!==null&&b.ref!==null&&(C.flags|=4194816);else{if(typeof E!="function"&&typeof E!="object")throw Error(r(284));(b===null||b.ref!==E)&&(C.flags|=4194816)}}function T4(b,C,E,O,N){return N0(C),E=o4(b,C,E,O,void 0,N),O=s4(),b!==null&&!Ua?(l4(b,C,N),Hu(b,C,N)):(xr&&O&&jC(C),C.flags|=1,Qa(b,C,E,N),C.child)}function MM(b,C,E,O,N,z){return N0(C),C.updateQueue=null,E=OO(C,O,E,N),DO(b),O=s4(),b!==null&&!Ua?(l4(b,C,z),Hu(b,C,z)):(xr&&O&&jC(C),C.flags|=1,Qa(b,C,E,z),C.child)}function IM(b,C,E,O,N){if(N0(C),C.stateNode===null){var z=xp,ce=E.contextType;typeof ce=="object"&&ce!==null&&(z=yo(ce)),z=new E(O,z),C.memoizedState=z.state!==null&&z.state!==void 0?z.state:null,z.updater=C4,C.stateNode=z,z._reactInternals=C,z=C.stateNode,z.props=O,z.state=C.memoizedState,z.refs={},QC(C),ce=E.contextType,z.context=typeof ce=="object"&&ce!==null?yo(ce):xp,z.state=C.memoizedState,ce=E.getDerivedStateFromProps,typeof ce=="function"&&(w4(C,E,ce,O),z.state=C.memoizedState),typeof E.getDerivedStateFromProps=="function"||typeof z.getSnapshotBeforeUpdate=="function"||typeof z.UNSAFE_componentWillMount!="function"&&typeof z.componentWillMount!="function"||(ce=z.state,typeof z.componentWillMount=="function"&&z.componentWillMount(),typeof z.UNSAFE_componentWillMount=="function"&&z.UNSAFE_componentWillMount(),ce!==z.state&&C4.enqueueReplaceState(z,z.state,null),c1(C,O,z,N),l1(),z.state=C.memoizedState),typeof z.componentDidMount=="function"&&(C.flags|=4194308),O=!0}else if(b===null){z=C.stateNode;var xe=C.memoizedProps,Ve=V0(E,xe);z.props=Ve;var nt=z.context,wt=E.contextType;ce=xp,typeof wt=="object"&&wt!==null&&(ce=yo(wt));var Ot=E.getDerivedStateFromProps;wt=typeof Ot=="function"||typeof z.getSnapshotBeforeUpdate=="function",xe=C.pendingProps!==xe,wt||typeof z.UNSAFE_componentWillReceiveProps!="function"&&typeof z.componentWillReceiveProps!="function"||(xe||nt!==ce)&&mM(C,z,O,ce),Wf=!1;var it=C.memoizedState;z.state=it,c1(C,O,z,N),l1(),nt=C.memoizedState,xe||it!==nt||Wf?(typeof Ot=="function"&&(w4(C,E,Ot,O),nt=C.memoizedState),(Ve=Wf||gM(C,E,Ve,O,it,nt,ce))?(wt||typeof z.UNSAFE_componentWillMount!="function"&&typeof z.componentWillMount!="function"||(typeof z.componentWillMount=="function"&&z.componentWillMount(),typeof z.UNSAFE_componentWillMount=="function"&&z.UNSAFE_componentWillMount()),typeof z.componentDidMount=="function"&&(C.flags|=4194308)):(typeof z.componentDidMount=="function"&&(C.flags|=4194308),C.memoizedProps=O,C.memoizedState=nt),z.props=O,z.state=nt,z.context=ce,O=Ve):(typeof z.componentDidMount=="function"&&(C.flags|=4194308),O=!1)}else{z=C.stateNode,e4(b,C),ce=C.memoizedProps,wt=V0(E,ce),z.props=wt,Ot=C.pendingProps,it=z.context,nt=E.contextType,Ve=xp,typeof nt=="object"&&nt!==null&&(Ve=yo(nt)),xe=E.getDerivedStateFromProps,(nt=typeof xe=="function"||typeof z.getSnapshotBeforeUpdate=="function")||typeof z.UNSAFE_componentWillReceiveProps!="function"&&typeof z.componentWillReceiveProps!="function"||(ce!==Ot||it!==Ve)&&mM(C,z,O,Ve),Wf=!1,it=C.memoizedState,z.state=it,c1(C,O,z,N),l1();var ot=C.memoizedState;ce!==Ot||it!==ot||Wf||b!==null&&b.dependencies!==null&&My(b.dependencies)?(typeof xe=="function"&&(w4(C,E,xe,O),ot=C.memoizedState),(wt=Wf||gM(C,E,wt,O,it,ot,Ve)||b!==null&&b.dependencies!==null&&My(b.dependencies))?(nt||typeof z.UNSAFE_componentWillUpdate!="function"&&typeof z.componentWillUpdate!="function"||(typeof z.componentWillUpdate=="function"&&z.componentWillUpdate(O,ot,Ve),typeof z.UNSAFE_componentWillUpdate=="function"&&z.UNSAFE_componentWillUpdate(O,ot,Ve)),typeof z.componentDidUpdate=="function"&&(C.flags|=4),typeof z.getSnapshotBeforeUpdate=="function"&&(C.flags|=1024)):(typeof z.componentDidUpdate!="function"||ce===b.memoizedProps&&it===b.memoizedState||(C.flags|=4),typeof z.getSnapshotBeforeUpdate!="function"||ce===b.memoizedProps&&it===b.memoizedState||(C.flags|=1024),C.memoizedProps=O,C.memoizedState=ot),z.props=O,z.state=ot,z.context=Ve,O=wt):(typeof z.componentDidUpdate!="function"||ce===b.memoizedProps&&it===b.memoizedState||(C.flags|=4),typeof z.getSnapshotBeforeUpdate!="function"||ce===b.memoizedProps&&it===b.memoizedState||(C.flags|=1024),O=!1)}return z=O,qy(b,C),O=(C.flags&128)!==0,z||O?(z=C.stateNode,E=O&&typeof E.getDerivedStateFromError!="function"?null:z.render(),C.flags|=1,b!==null&&O?(C.child=Mp(C,b.child,null,N),C.child=Mp(C,null,E,N)):Qa(b,C,E,N),C.memoizedState=z.state,b=C.child):b=Hu(b,C,N),b}function RM(b,C,E,O){return e1(),C.flags|=256,Qa(b,C,E,O),C.child}var E4={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function _4(b){return{baseLanes:b,cachePool:yO()}}function D4(b,C,E){return b=b!==null?b.childLanes&~E:0,C&&(b|=xl),b}function AM(b,C,E){var O=C.pendingProps,N=!1,z=(C.flags&128)!==0,ce;if((ce=z)||(ce=b!==null&&b.memoizedState===null?!1:(_a.current&2)!==0),ce&&(N=!0,C.flags&=-129),ce=(C.flags&32)!==0,C.flags&=-33,b===null){if(xr){if(N?Xf(C):Yf(),xr){var xe=Ui,Ve;if(Ve=xe){e:{for(Ve=xe,xe=Nc;Ve.nodeType!==8;){if(!xe){xe=null;break e}if(Ve=Ql(Ve.nextSibling),Ve===null){xe=null;break e}}xe=Ve}xe!==null?(C.memoizedState={dehydrated:xe,treeContext:M0!==null?{id:Bu,overflow:$u}:null,retryLane:536870912,hydrationErrors:null},Ve=Ns(18,null,null,0),Ve.stateNode=xe,Ve.return=C,C.child=Ve,jo=C,Ui=null,Ve=!0):Ve=!1}Ve||A0(C)}if(xe=C.memoizedState,xe!==null&&(xe=xe.dehydrated,xe!==null))return uS(xe)?C.lanes=32:C.lanes=536870912,null;Wu(C)}return xe=O.children,O=O.fallback,N?(Yf(),N=C.mode,xe=Xy({mode:"hidden",children:xe},N),O=O0(O,N,E,null),xe.return=C,O.return=C,xe.sibling=O,C.child=xe,N=C.child,N.memoizedState=_4(E),N.childLanes=D4(b,ce,E),C.memoizedState=E4,O):(Xf(C),O4(C,xe))}if(Ve=b.memoizedState,Ve!==null&&(xe=Ve.dehydrated,xe!==null)){if(z)C.flags&256?(Xf(C),C.flags&=-257,C=M4(b,C,E)):C.memoizedState!==null?(Yf(),C.child=b.child,C.flags|=128,C=null):(Yf(),N=O.fallback,xe=C.mode,O=Xy({mode:"visible",children:O.children},xe),N=O0(N,xe,E,null),N.flags|=2,O.return=C,N.return=C,O.sibling=N,C.child=O,Mp(C,b.child,null,E),O=C.child,O.memoizedState=_4(E),O.childLanes=D4(b,ce,E),C.memoizedState=E4,C=N);else if(Xf(C),uS(xe)){if(ce=xe.nextSibling&&xe.nextSibling.dataset,ce)var nt=ce.dgst;ce=nt,O=Error(r(419)),O.stack="",O.digest=ce,t1({value:O,source:null,stack:null}),C=M4(b,C,E)}else if(Ua||n1(b,C,E,!1),ce=(E&b.childLanes)!==0,Ua||ce){if(ce=qr,ce!==null&&(O=E&-E,O=(O&42)!==0?1:qe(O),O=(O&(ce.suspendedLanes|E))!==0?0:O,O!==0&&O!==Ve.retryLane))throw Ve.retryLane=O,yp(b,O),Us(ce,b,O),SM;xe.data==="$?"||K4(),C=M4(b,C,E)}else xe.data==="$?"?(C.flags|=192,C.child=b.child,C=null):(b=Ve.treeContext,Ui=Ql(xe.nextSibling),jo=C,xr=!0,R0=null,Nc=!1,b!==null&&(ml[vl++]=Bu,ml[vl++]=$u,ml[vl++]=M0,Bu=b.id,$u=b.overflow,M0=C),C=O4(C,O.children),C.flags|=4096);return C}return N?(Yf(),N=O.fallback,xe=C.mode,Ve=b.child,nt=Ve.sibling,O=Uu(Ve,{mode:"hidden",children:O.children}),O.subtreeFlags=Ve.subtreeFlags&65011712,nt!==null?N=Uu(nt,N):(N=O0(N,xe,E,null),N.flags|=2),N.return=C,O.return=C,O.sibling=N,C.child=O,O=N,N=C.child,xe=b.child.memoizedState,xe===null?xe=_4(E):(Ve=xe.cachePool,Ve!==null?(nt=Ea._currentValue,Ve=Ve.parent!==nt?{parent:nt,pool:nt}:Ve):Ve=yO(),xe={baseLanes:xe.baseLanes|E,cachePool:Ve}),N.memoizedState=xe,N.childLanes=D4(b,ce,E),C.memoizedState=E4,O):(Xf(C),E=b.child,b=E.sibling,E=Uu(E,{mode:"visible",children:O.children}),E.return=C,E.sibling=null,b!==null&&(ce=C.deletions,ce===null?(C.deletions=[b],C.flags|=16):ce.push(b)),C.child=E,C.memoizedState=null,E)}function O4(b,C){return C=Xy({mode:"visible",children:C},b.mode),C.return=b,b.child=C}function Xy(b,C){return b=Ns(22,b,null,C),b.lanes=0,b.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},b}function M4(b,C,E){return Mp(C,b.child,null,E),b=O4(C,C.pendingProps.children),b.flags|=2,C.memoizedState=null,b}function PM(b,C,E){b.lanes|=C;var O=b.alternate;O!==null&&(O.lanes|=C),KC(b.return,C,E)}function I4(b,C,E,O,N){var z=b.memoizedState;z===null?b.memoizedState={isBackwards:C,rendering:null,renderingStartTime:0,last:O,tail:E,tailMode:N}:(z.isBackwards=C,z.rendering=null,z.renderingStartTime=0,z.last=O,z.tail=E,z.tailMode=N)}function NM(b,C,E){var O=C.pendingProps,N=O.revealOrder,z=O.tail;if(Qa(b,C,O.children,E),O=_a.current,(O&2)!==0)O=O&1|2,C.flags|=128;else{if(b!==null&&(b.flags&128)!==0)e:for(b=C.child;b!==null;){if(b.tag===13)b.memoizedState!==null&&PM(b,E,C);else if(b.tag===19)PM(b,E,C);else if(b.child!==null){b.child.return=b,b=b.child;continue}if(b===C)break e;for(;b.sibling===null;){if(b.return===null||b.return===C)break e;b=b.return}b.sibling.return=b.return,b=b.sibling}O&=1}switch(re(_a,O),N){case"forwards":for(E=C.child,N=null;E!==null;)b=E.alternate,b!==null&&Wy(b)===null&&(N=E),E=E.sibling;E=N,E===null?(N=C.child,C.child=null):(N=E.sibling,E.sibling=null),I4(C,!1,N,E,z);break;case"backwards":for(E=null,N=C.child,C.child=null;N!==null;){if(b=N.alternate,b!==null&&Wy(b)===null){C.child=N;break}b=N.sibling,N.sibling=E,E=N,N=b}I4(C,!0,E,null,z);break;case"together":I4(C,!1,null,null,void 0);break;default:C.memoizedState=null}return C.child}function Hu(b,C,E){if(b!==null&&(C.dependencies=b.dependencies),td|=C.lanes,(E&C.childLanes)===0)if(b!==null){if(n1(b,C,E,!1),(E&C.childLanes)===0)return null}else return null;if(b!==null&&C.child!==b.child)throw Error(r(153));if(C.child!==null){for(b=C.child,E=Uu(b,b.pendingProps),C.child=E,E.return=C;b.sibling!==null;)b=b.sibling,E=E.sibling=Uu(b,b.pendingProps),E.return=C;E.sibling=null}return C.child}function R4(b,C){return(b.lanes&C)!==0?!0:(b=b.dependencies,!!(b!==null&&My(b)))}function ene(b,C,E){switch(C.tag){case 3:Ae(C,C.stateNode.containerInfo),zf(C,Ea,b.memoizedState.cache),e1();break;case 27:case 5:q(C);break;case 4:Ae(C,C.stateNode.containerInfo);break;case 10:zf(C,C.type,C.memoizedProps.value);break;case 13:var O=C.memoizedState;if(O!==null)return O.dehydrated!==null?(Xf(C),C.flags|=128,null):(E&C.child.childLanes)!==0?AM(b,C,E):(Xf(C),b=Hu(b,C,E),b!==null?b.sibling:null);Xf(C);break;case 19:var N=(b.flags&128)!==0;if(O=(E&C.childLanes)!==0,O||(n1(b,C,E,!1),O=(E&C.childLanes)!==0),N){if(O)return NM(b,C,E);C.flags|=128}if(N=C.memoizedState,N!==null&&(N.rendering=null,N.tail=null,N.lastEffect=null),re(_a,_a.current),O)break;return null;case 22:case 23:return C.lanes=0,DM(b,C,E);case 24:zf(C,Ea,b.memoizedState.cache)}return Hu(b,C,E)}function LM(b,C,E){if(b!==null)if(b.memoizedProps!==C.pendingProps)Ua=!0;else{if(!R4(b,E)&&(C.flags&128)===0)return Ua=!1,ene(b,C,E);Ua=(b.flags&131072)!==0}else Ua=!1,xr&&(C.flags&1048576)!==0&&fO(C,Oy,C.index);switch(C.lanes=0,C.tag){case 16:e:{b=C.pendingProps;var O=C.elementType,N=O._init;if(O=N(O._payload),C.type=O,typeof O=="function")BC(O)?(b=V0(O,b),C.tag=1,C=IM(null,C,O,b,E)):(C.tag=0,C=T4(null,C,O,b,E));else{if(O!=null){if(N=O.$$typeof,N===w){C.tag=11,C=TM(null,C,O,b,E);break e}else if(N===_){C.tag=14,C=EM(null,C,O,b,E);break e}}throw C=P(O)||O,Error(r(306,C,""))}}return C;case 0:return T4(b,C,C.type,C.pendingProps,E);case 1:return O=C.type,N=V0(O,C.pendingProps),IM(b,C,O,N,E);case 3:e:{if(Ae(C,C.stateNode.containerInfo),b===null)throw Error(r(387));O=C.pendingProps;var z=C.memoizedState;N=z.element,e4(b,C),c1(C,O,null,E);var ce=C.memoizedState;if(O=ce.cache,zf(C,Ea,O),O!==z.cache&&qC(C,[Ea],E,!0),l1(),O=ce.element,z.isDehydrated)if(z={element:O,isDehydrated:!1,cache:ce.cache},C.updateQueue.baseState=z,C.memoizedState=z,C.flags&256){C=RM(b,C,O,E);break e}else if(O!==N){N=pl(Error(r(424)),C),t1(N),C=RM(b,C,O,E);break e}else{switch(b=C.stateNode.containerInfo,b.nodeType){case 9:b=b.body;break;default:b=b.nodeName==="HTML"?b.ownerDocument.body:b}for(Ui=Ql(b.firstChild),jo=C,xr=!0,R0=null,Nc=!0,E=hM(C,null,O,E),C.child=E;E;)E.flags=E.flags&-3|4096,E=E.sibling}else{if(e1(),O===N){C=Hu(b,C,E);break e}Qa(b,C,O,E)}C=C.child}return C;case 26:return qy(b,C),b===null?(E=UI(C.type,null,C.pendingProps,null))?C.memoizedState=E:xr||(E=C.type,b=C.pendingProps,O=c5(Ce.current).createElement(E),O[$t]=C,O[Xt]=b,to(O,E,b),an(O),C.stateNode=O):C.memoizedState=UI(C.type,b.memoizedProps,C.pendingProps,b.memoizedState),null;case 27:return q(C),b===null&&xr&&(O=C.stateNode=kI(C.type,C.pendingProps,Ce.current),jo=C,Nc=!0,N=Ui,ad(C.type)?(fS=N,Ui=Ql(O.firstChild)):Ui=N),Qa(b,C,C.pendingProps.children,E),qy(b,C),b===null&&(C.flags|=4194304),C.child;case 5:return b===null&&xr&&((N=O=Ui)&&(O=One(O,C.type,C.pendingProps,Nc),O!==null?(C.stateNode=O,jo=C,Ui=Ql(O.firstChild),Nc=!1,N=!0):N=!1),N||A0(C)),q(C),N=C.type,z=C.pendingProps,ce=b!==null?b.memoizedProps:null,O=z.children,sS(N,z)?O=null:ce!==null&&sS(N,ce)&&(C.flags|=32),C.memoizedState!==null&&(N=o4(b,C,Hte,null,null,E),R1._currentValue=N),qy(b,C),Qa(b,C,O,E),C.child;case 6:return b===null&&xr&&((b=E=Ui)&&(E=Mne(E,C.pendingProps,Nc),E!==null?(C.stateNode=E,jo=C,Ui=null,b=!0):b=!1),b||A0(C)),null;case 13:return AM(b,C,E);case 4:return Ae(C,C.stateNode.containerInfo),O=C.pendingProps,b===null?C.child=Mp(C,null,O,E):Qa(b,C,O,E),C.child;case 11:return TM(b,C,C.type,C.pendingProps,E);case 7:return Qa(b,C,C.pendingProps,E),C.child;case 8:return Qa(b,C,C.pendingProps.children,E),C.child;case 12:return Qa(b,C,C.pendingProps.children,E),C.child;case 10:return O=C.pendingProps,zf(C,C.type,O.value),Qa(b,C,O.children,E),C.child;case 9:return N=C.type._context,O=C.pendingProps.children,N0(C),N=yo(N),O=O(N),C.flags|=1,Qa(b,C,O,E),C.child;case 14:return EM(b,C,C.type,C.pendingProps,E);case 15:return _M(b,C,C.type,C.pendingProps,E);case 19:return NM(b,C,E);case 31:return O=C.pendingProps,E=C.mode,O={mode:O.mode,children:O.children},b===null?(E=Xy(O,E),E.ref=C.ref,C.child=E,E.return=C,C=E):(E=Uu(b.child,O),E.ref=C.ref,C.child=E,E.return=C,C=E),C;case 22:return DM(b,C,E);case 24:return N0(C),O=yo(Ea),b===null?(N=JC(),N===null&&(N=qr,z=XC(),N.pooledCache=z,z.refCount++,z!==null&&(N.pooledCacheLanes|=E),N=z),C.memoizedState={parent:O,cache:N},QC(C),zf(C,Ea,N)):((b.lanes&E)!==0&&(e4(b,C),c1(C,null,null,E),l1()),N=b.memoizedState,z=C.memoizedState,N.parent!==O?(N={parent:O,cache:O},C.memoizedState=N,C.lanes===0&&(C.memoizedState=C.updateQueue.baseState=N),zf(C,Ea,O)):(O=z.cache,zf(C,Ea,O),O!==N.cache&&qC(C,[Ea],E,!0))),Qa(b,C,C.pendingProps.children,E),C.child;case 29:throw C.pendingProps}throw Error(r(156,C.tag))}function Ku(b){b.flags|=4}function kM(b,C){if(C.type!=="stylesheet"||(C.state.loading&4)!==0)b.flags&=-16777217;else if(b.flags|=16777216,!zI(C)){if(C=yl.current,C!==null&&((lr&4194048)===lr?Lc!==null:(lr&62914560)!==lr&&(lr&536870912)===0||C!==Lc))throw o1=ZC,xO;b.flags|=8192}}function Yy(b,C){C!==null&&(b.flags|=4),b.flags&16384&&(C=b.tag!==22?gn():536870912,b.lanes|=C,Pp|=C)}function m1(b,C){if(!xr)switch(b.tailMode){case"hidden":C=b.tail;for(var E=null;C!==null;)C.alternate!==null&&(E=C),C=C.sibling;E===null?b.tail=null:E.sibling=null;break;case"collapsed":E=b.tail;for(var O=null;E!==null;)E.alternate!==null&&(O=E),E=E.sibling;O===null?C||b.tail===null?b.tail=null:b.tail.sibling=null:O.sibling=null}}function bi(b){var C=b.alternate!==null&&b.alternate.child===b.child,E=0,O=0;if(C)for(var N=b.child;N!==null;)E|=N.lanes|N.childLanes,O|=N.subtreeFlags&65011712,O|=N.flags&65011712,N.return=b,N=N.sibling;else for(N=b.child;N!==null;)E|=N.lanes|N.childLanes,O|=N.subtreeFlags,O|=N.flags,N.return=b,N=N.sibling;return b.subtreeFlags|=O,b.childLanes=E,C}function tne(b,C,E){var O=C.pendingProps;switch(zC(C),C.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return bi(C),null;case 1:return bi(C),null;case 3:return E=C.stateNode,O=null,b!==null&&(O=b.memoizedState.cache),C.memoizedState.cache!==O&&(C.flags|=2048),ju(Ea),De(),E.pendingContext&&(E.context=E.pendingContext,E.pendingContext=null),(b===null||b.child===null)&&(Qm(C)?Ku(C):b===null||b.memoizedState.isDehydrated&&(C.flags&256)===0||(C.flags|=1024,pO())),bi(C),null;case 26:return E=C.memoizedState,b===null?(Ku(C),E!==null?(bi(C),kM(C,E)):(bi(C),C.flags&=-16777217)):E?E!==b.memoizedState?(Ku(C),bi(C),kM(C,E)):(bi(C),C.flags&=-16777217):(b.memoizedProps!==O&&Ku(C),bi(C),C.flags&=-16777217),null;case 27:k(C),E=Ce.current;var N=C.type;if(b!==null&&C.stateNode!=null)b.memoizedProps!==O&&Ku(C);else{if(!O){if(C.stateNode===null)throw Error(r(166));return bi(C),null}b=ye.current,Qm(C)?dO(C):(b=kI(N,O,E),C.stateNode=b,Ku(C))}return bi(C),null;case 5:if(k(C),E=C.type,b!==null&&C.stateNode!=null)b.memoizedProps!==O&&Ku(C);else{if(!O){if(C.stateNode===null)throw Error(r(166));return bi(C),null}if(b=ye.current,Qm(C))dO(C);else{switch(N=c5(Ce.current),b){case 1:b=N.createElementNS("http://www.w3.org/2000/svg",E);break;case 2:b=N.createElementNS("http://www.w3.org/1998/Math/MathML",E);break;default:switch(E){case"svg":b=N.createElementNS("http://www.w3.org/2000/svg",E);break;case"math":b=N.createElementNS("http://www.w3.org/1998/Math/MathML",E);break;case"script":b=N.createElement("div"),b.innerHTML="<script><\/script>",b=b.removeChild(b.firstChild);break;case"select":b=typeof O.is=="string"?N.createElement("select",{is:O.is}):N.createElement("select"),O.multiple?b.multiple=!0:O.size&&(b.size=O.size);break;default:b=typeof O.is=="string"?N.createElement(E,{is:O.is}):N.createElement(E)}}b[$t]=C,b[Xt]=O;e:for(N=C.child;N!==null;){if(N.tag===5||N.tag===6)b.appendChild(N.stateNode);else if(N.tag!==4&&N.tag!==27&&N.child!==null){N.child.return=N,N=N.child;continue}if(N===C)break e;for(;N.sibling===null;){if(N.return===null||N.return===C)break e;N=N.return}N.sibling.return=N.return,N=N.sibling}C.stateNode=b;e:switch(to(b,E,O),E){case"button":case"input":case"select":case"textarea":b=!!O.autoFocus;break e;case"img":b=!0;break e;default:b=!1}b&&Ku(C)}}return bi(C),C.flags&=-16777217,null;case 6:if(b&&C.stateNode!=null)b.memoizedProps!==O&&Ku(C);else{if(typeof O!="string"&&C.stateNode===null)throw Error(r(166));if(b=Ce.current,Qm(C)){if(b=C.stateNode,E=C.memoizedProps,O=null,N=jo,N!==null)switch(N.tag){case 27:case 5:O=N.memoizedProps}b[$t]=C,b=!!(b.nodeValue===E||O!==null&&O.suppressHydrationWarning===!0||MI(b.nodeValue,E)),b||A0(C)}else b=c5(b).createTextNode(O),b[$t]=C,C.stateNode=b}return bi(C),null;case 13:if(O=C.memoizedState,b===null||b.memoizedState!==null&&b.memoizedState.dehydrated!==null){if(N=Qm(C),O!==null&&O.dehydrated!==null){if(b===null){if(!N)throw Error(r(318));if(N=C.memoizedState,N=N!==null?N.dehydrated:null,!N)throw Error(r(317));N[$t]=C}else e1(),(C.flags&128)===0&&(C.memoizedState=null),C.flags|=4;bi(C),N=!1}else N=pO(),b!==null&&b.memoizedState!==null&&(b.memoizedState.hydrationErrors=N),N=!0;if(!N)return C.flags&256?(Wu(C),C):(Wu(C),null)}if(Wu(C),(C.flags&128)!==0)return C.lanes=E,C;if(E=O!==null,b=b!==null&&b.memoizedState!==null,E){O=C.child,N=null,O.alternate!==null&&O.alternate.memoizedState!==null&&O.alternate.memoizedState.cachePool!==null&&(N=O.alternate.memoizedState.cachePool.pool);var z=null;O.memoizedState!==null&&O.memoizedState.cachePool!==null&&(z=O.memoizedState.cachePool.pool),z!==N&&(O.flags|=2048)}return E!==b&&E&&(C.child.flags|=8192),Yy(C,C.updateQueue),bi(C),null;case 4:return De(),b===null&&nS(C.stateNode.containerInfo),bi(C),null;case 10:return ju(C.type),bi(C),null;case 19:if(Q(_a),N=C.memoizedState,N===null)return bi(C),null;if(O=(C.flags&128)!==0,z=N.rendering,z===null)if(O)m1(N,!1);else{if(Bi!==0||b!==null&&(b.flags&128)!==0)for(b=C.child;b!==null;){if(z=Wy(b),z!==null){for(C.flags|=128,m1(N,!1),b=z.updateQueue,C.updateQueue=b,Yy(C,b),C.subtreeFlags=0,b=E,E=C.child;E!==null;)uO(E,b),E=E.sibling;return re(_a,_a.current&1|2),C.child}b=b.sibling}N.tail!==null&&Se()>Qy&&(C.flags|=128,O=!0,m1(N,!1),C.lanes=4194304)}else{if(!O)if(b=Wy(z),b!==null){if(C.flags|=128,O=!0,b=b.updateQueue,C.updateQueue=b,Yy(C,b),m1(N,!0),N.tail===null&&N.tailMode==="hidden"&&!z.alternate&&!xr)return bi(C),null}else 2*Se()-N.renderingStartTime>Qy&&E!==536870912&&(C.flags|=128,O=!0,m1(N,!1),C.lanes=4194304);N.isBackwards?(z.sibling=C.child,C.child=z):(b=N.last,b!==null?b.sibling=z:C.child=z,N.last=z)}return N.tail!==null?(C=N.tail,N.rendering=C,N.tail=C.sibling,N.renderingStartTime=Se(),C.sibling=null,b=_a.current,re(_a,O?b&1|2:b&1),C):(bi(C),null);case 22:case 23:return Wu(C),i4(),O=C.memoizedState!==null,b!==null?b.memoizedState!==null!==O&&(C.flags|=8192):O&&(C.flags|=8192),O?(E&536870912)!==0&&(C.flags&128)===0&&(bi(C),C.subtreeFlags&6&&(C.flags|=8192)):bi(C),E=C.updateQueue,E!==null&&Yy(C,E.retryQueue),E=null,b!==null&&b.memoizedState!==null&&b.memoizedState.cachePool!==null&&(E=b.memoizedState.cachePool.pool),O=null,C.memoizedState!==null&&C.memoizedState.cachePool!==null&&(O=C.memoizedState.cachePool.pool),O!==E&&(C.flags|=2048),b!==null&&Q(L0),null;case 24:return E=null,b!==null&&(E=b.memoizedState.cache),C.memoizedState.cache!==E&&(C.flags|=2048),ju(Ea),bi(C),null;case 25:return null;case 30:return null}throw Error(r(156,C.tag))}function nne(b,C){switch(zC(C),C.tag){case 1:return b=C.flags,b&65536?(C.flags=b&-65537|128,C):null;case 3:return ju(Ea),De(),b=C.flags,(b&65536)!==0&&(b&128)===0?(C.flags=b&-65537|128,C):null;case 26:case 27:case 5:return k(C),null;case 13:if(Wu(C),b=C.memoizedState,b!==null&&b.dehydrated!==null){if(C.alternate===null)throw Error(r(340));e1()}return b=C.flags,b&65536?(C.flags=b&-65537|128,C):null;case 19:return Q(_a),null;case 4:return De(),null;case 10:return ju(C.type),null;case 22:case 23:return Wu(C),i4(),b!==null&&Q(L0),b=C.flags,b&65536?(C.flags=b&-65537|128,C):null;case 24:return ju(Ea),null;case 25:return null;default:return null}}function VM(b,C){switch(zC(C),C.tag){case 3:ju(Ea),De();break;case 26:case 27:case 5:k(C);break;case 4:De();break;case 13:Wu(C);break;case 19:Q(_a);break;case 10:ju(C.type);break;case 22:case 23:Wu(C),i4(),b!==null&&Q(L0);break;case 24:ju(Ea)}}function v1(b,C){try{var E=C.updateQueue,O=E!==null?E.lastEffect:null;if(O!==null){var N=O.next;E=N;do{if((E.tag&b)===b){O=void 0;var z=E.create,ce=E.inst;O=z(),ce.destroy=O}E=E.next}while(E!==N)}}catch(xe){jr(C,C.return,xe)}}function Jf(b,C,E){try{var O=C.updateQueue,N=O!==null?O.lastEffect:null;if(N!==null){var z=N.next;O=z;do{if((O.tag&b)===b){var ce=O.inst,xe=ce.destroy;if(xe!==void 0){ce.destroy=void 0,N=C;var Ve=E,nt=xe;try{nt()}catch(wt){jr(N,Ve,wt)}}}O=O.next}while(O!==z)}}catch(wt){jr(C,C.return,wt)}}function FM(b){var C=b.updateQueue;if(C!==null){var E=b.stateNode;try{EO(C,E)}catch(O){jr(b,b.return,O)}}}function UM(b,C,E){E.props=V0(b.type,b.memoizedProps),E.state=b.memoizedState;try{E.componentWillUnmount()}catch(O){jr(b,C,O)}}function y1(b,C){try{var E=b.ref;if(E!==null){switch(b.tag){case 26:case 27:case 5:var O=b.stateNode;break;case 30:O=b.stateNode;break;default:O=b.stateNode}typeof E=="function"?b.refCleanup=E(O):E.current=O}}catch(N){jr(b,C,N)}}function kc(b,C){var E=b.ref,O=b.refCleanup;if(E!==null)if(typeof O=="function")try{O()}catch(N){jr(b,C,N)}finally{b.refCleanup=null,b=b.alternate,b!=null&&(b.refCleanup=null)}else if(typeof E=="function")try{E(null)}catch(N){jr(b,C,N)}else E.current=null}function BM(b){var C=b.type,E=b.memoizedProps,O=b.stateNode;try{e:switch(C){case"button":case"input":case"select":case"textarea":E.autoFocus&&O.focus();break e;case"img":E.src?O.src=E.src:E.srcSet&&(O.srcset=E.srcSet)}}catch(N){jr(b,b.return,N)}}function A4(b,C,E){try{var O=b.stateNode;Sne(O,b.type,E,C),O[Xt]=C}catch(N){jr(b,b.return,N)}}function $M(b){return b.tag===5||b.tag===3||b.tag===26||b.tag===27&&ad(b.type)||b.tag===4}function P4(b){e:for(;;){for(;b.sibling===null;){if(b.return===null||$M(b.return))return null;b=b.return}for(b.sibling.return=b.return,b=b.sibling;b.tag!==5&&b.tag!==6&&b.tag!==18;){if(b.tag===27&&ad(b.type)||b.flags&2||b.child===null||b.tag===4)continue e;b.child.return=b,b=b.child}if(!(b.flags&2))return b.stateNode}}function N4(b,C,E){var O=b.tag;if(O===5||O===6)b=b.stateNode,C?(E.nodeType===9?E.body:E.nodeName==="HTML"?E.ownerDocument.body:E).insertBefore(b,C):(C=E.nodeType===9?E.body:E.nodeName==="HTML"?E.ownerDocument.body:E,C.appendChild(b),E=E._reactRootContainer,E!=null||C.onclick!==null||(C.onclick=l5));else if(O!==4&&(O===27&&ad(b.type)&&(E=b.stateNode,C=null),b=b.child,b!==null))for(N4(b,C,E),b=b.sibling;b!==null;)N4(b,C,E),b=b.sibling}function Jy(b,C,E){var O=b.tag;if(O===5||O===6)b=b.stateNode,C?E.insertBefore(b,C):E.appendChild(b);else if(O!==4&&(O===27&&ad(b.type)&&(E=b.stateNode),b=b.child,b!==null))for(Jy(b,C,E),b=b.sibling;b!==null;)Jy(b,C,E),b=b.sibling}function GM(b){var C=b.stateNode,E=b.memoizedProps;try{for(var O=b.type,N=C.attributes;N.length;)C.removeAttributeNode(N[0]);to(C,O,E),C[$t]=b,C[Xt]=E}catch(z){jr(b,b.return,z)}}var qu=!1,Yi=!1,L4=!1,jM=typeof WeakSet=="function"?WeakSet:Set,Ba=null;function rne(b,C){if(b=b.containerInfo,aS=g5,b=Ze(b),ht(b)){if("selectionStart"in b)var E={start:b.selectionStart,end:b.selectionEnd};else e:{E=(E=b.ownerDocument)&&E.defaultView||window;var O=E.getSelection&&E.getSelection();if(O&&O.rangeCount!==0){E=O.anchorNode;var N=O.anchorOffset,z=O.focusNode;O=O.focusOffset;try{E.nodeType,z.nodeType}catch{E=null;break e}var ce=0,xe=-1,Ve=-1,nt=0,wt=0,Ot=b,it=null;t:for(;;){for(var ot;Ot!==E||N!==0&&Ot.nodeType!==3||(xe=ce+N),Ot!==z||O!==0&&Ot.nodeType!==3||(Ve=ce+O),Ot.nodeType===3&&(ce+=Ot.nodeValue.length),(ot=Ot.firstChild)!==null;)it=Ot,Ot=ot;for(;;){if(Ot===b)break t;if(it===E&&++nt===N&&(xe=ce),it===z&&++wt===O&&(Ve=ce),(ot=Ot.nextSibling)!==null)break;Ot=it,it=Ot.parentNode}Ot=ot}E=xe===-1||Ve===-1?null:{start:xe,end:Ve}}else E=null}E=E||{start:0,end:0}}else E=null;for(oS={focusedElem:b,selectionRange:E},g5=!1,Ba=C;Ba!==null;)if(C=Ba,b=C.child,(C.subtreeFlags&1024)!==0&&b!==null)b.return=C,Ba=b;else for(;Ba!==null;){switch(C=Ba,z=C.alternate,b=C.flags,C.tag){case 0:break;case 11:case 15:break;case 1:if((b&1024)!==0&&z!==null){b=void 0,E=C,N=z.memoizedProps,z=z.memoizedState,O=E.stateNode;try{var Cn=V0(E.type,N,E.elementType===E.type);b=O.getSnapshotBeforeUpdate(Cn,z),O.__reactInternalSnapshotBeforeUpdate=b}catch(vn){jr(E,E.return,vn)}}break;case 3:if((b&1024)!==0){if(b=C.stateNode.containerInfo,E=b.nodeType,E===9)cS(b);else if(E===1)switch(b.nodeName){case"HEAD":case"HTML":case"BODY":cS(b);break;default:b.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((b&1024)!==0)throw Error(r(163))}if(b=C.sibling,b!==null){b.return=C.return,Ba=b;break}Ba=C.return}}function zM(b,C,E){var O=E.flags;switch(E.tag){case 0:case 11:case 15:Zf(b,E),O&4&&v1(5,E);break;case 1:if(Zf(b,E),O&4)if(b=E.stateNode,C===null)try{b.componentDidMount()}catch(ce){jr(E,E.return,ce)}else{var N=V0(E.type,C.memoizedProps);C=C.memoizedState;try{b.componentDidUpdate(N,C,b.__reactInternalSnapshotBeforeUpdate)}catch(ce){jr(E,E.return,ce)}}O&64&&FM(E),O&512&&y1(E,E.return);break;case 3:if(Zf(b,E),O&64&&(b=E.updateQueue,b!==null)){if(C=null,E.child!==null)switch(E.child.tag){case 27:case 5:C=E.child.stateNode;break;case 1:C=E.child.stateNode}try{EO(b,C)}catch(ce){jr(E,E.return,ce)}}break;case 27:C===null&&O&4&&GM(E);case 26:case 5:Zf(b,E),C===null&&O&4&&BM(E),O&512&&y1(E,E.return);break;case 12:Zf(b,E);break;case 13:Zf(b,E),O&4&&KM(b,E),O&64&&(b=E.memoizedState,b!==null&&(b=b.dehydrated,b!==null&&(E=dne.bind(null,E),Ine(b,E))));break;case 22:if(O=E.memoizedState!==null||qu,!O){C=C!==null&&C.memoizedState!==null||Yi,N=qu;var z=Yi;qu=O,(Yi=C)&&!z?Qf(b,E,(E.subtreeFlags&8772)!==0):Zf(b,E),qu=N,Yi=z}break;case 30:break;default:Zf(b,E)}}function WM(b){var C=b.alternate;C!==null&&(b.alternate=null,WM(C)),b.child=null,b.deletions=null,b.sibling=null,b.tag===5&&(C=b.stateNode,C!==null&&fi(C)),b.stateNode=null,b.return=null,b.dependencies=null,b.memoizedProps=null,b.memoizedState=null,b.pendingProps=null,b.stateNode=null,b.updateQueue=null}var hi=null,ds=!1;function Xu(b,C,E){for(E=E.child;E!==null;)HM(b,C,E),E=E.sibling}function HM(b,C,E){if(ne&&typeof ne.onCommitFiberUnmount=="function")try{ne.onCommitFiberUnmount(Pe,E)}catch{}switch(E.tag){case 26:Yi||kc(E,C),Xu(b,C,E),E.memoizedState?E.memoizedState.count--:E.stateNode&&(E=E.stateNode,E.parentNode.removeChild(E));break;case 27:Yi||kc(E,C);var O=hi,N=ds;ad(E.type)&&(hi=E.stateNode,ds=!1),Xu(b,C,E),D1(E.stateNode),hi=O,ds=N;break;case 5:Yi||kc(E,C);case 6:if(O=hi,N=ds,hi=null,Xu(b,C,E),hi=O,ds=N,hi!==null)if(ds)try{(hi.nodeType===9?hi.body:hi.nodeName==="HTML"?hi.ownerDocument.body:hi).removeChild(E.stateNode)}catch(z){jr(E,C,z)}else try{hi.removeChild(E.stateNode)}catch(z){jr(E,C,z)}break;case 18:hi!==null&&(ds?(b=hi,NI(b.nodeType===9?b.body:b.nodeName==="HTML"?b.ownerDocument.body:b,E.stateNode),L1(b)):NI(hi,E.stateNode));break;case 4:O=hi,N=ds,hi=E.stateNode.containerInfo,ds=!0,Xu(b,C,E),hi=O,ds=N;break;case 0:case 11:case 14:case 15:Yi||Jf(2,E,C),Yi||Jf(4,E,C),Xu(b,C,E);break;case 1:Yi||(kc(E,C),O=E.stateNode,typeof O.componentWillUnmount=="function"&&UM(E,C,O)),Xu(b,C,E);break;case 21:Xu(b,C,E);break;case 22:Yi=(O=Yi)||E.memoizedState!==null,Xu(b,C,E),Yi=O;break;default:Xu(b,C,E)}}function KM(b,C){if(C.memoizedState===null&&(b=C.alternate,b!==null&&(b=b.memoizedState,b!==null&&(b=b.dehydrated,b!==null))))try{L1(b)}catch(E){jr(C,C.return,E)}}function ine(b){switch(b.tag){case 13:case 19:var C=b.stateNode;return C===null&&(C=b.stateNode=new jM),C;case 22:return b=b.stateNode,C=b._retryCache,C===null&&(C=b._retryCache=new jM),C;default:throw Error(r(435,b.tag))}}function k4(b,C){var E=ine(b);C.forEach(function(O){var N=hne.bind(null,b,O);E.has(O)||(E.add(O),O.then(N,N))})}function Ls(b,C){var E=C.deletions;if(E!==null)for(var O=0;O<E.length;O++){var N=E[O],z=b,ce=C,xe=ce;e:for(;xe!==null;){switch(xe.tag){case 27:if(ad(xe.type)){hi=xe.stateNode,ds=!1;break e}break;case 5:hi=xe.stateNode,ds=!1;break e;case 3:case 4:hi=xe.stateNode.containerInfo,ds=!0;break e}xe=xe.return}if(hi===null)throw Error(r(160));HM(z,ce,N),hi=null,ds=!1,z=N.alternate,z!==null&&(z.return=null),N.return=null}if(C.subtreeFlags&13878)for(C=C.child;C!==null;)qM(C,b),C=C.sibling}var Zl=null;function qM(b,C){var E=b.alternate,O=b.flags;switch(b.tag){case 0:case 11:case 14:case 15:Ls(C,b),ks(b),O&4&&(Jf(3,b,b.return),v1(3,b),Jf(5,b,b.return));break;case 1:Ls(C,b),ks(b),O&512&&(Yi||E===null||kc(E,E.return)),O&64&&qu&&(b=b.updateQueue,b!==null&&(O=b.callbacks,O!==null&&(E=b.shared.hiddenCallbacks,b.shared.hiddenCallbacks=E===null?O:E.concat(O))));break;case 26:var N=Zl;if(Ls(C,b),ks(b),O&512&&(Yi||E===null||kc(E,E.return)),O&4){var z=E!==null?E.memoizedState:null;if(O=b.memoizedState,E===null)if(O===null)if(b.stateNode===null){e:{O=b.type,E=b.memoizedProps,N=N.ownerDocument||N;t:switch(O){case"title":z=N.getElementsByTagName("title")[0],(!z||z[Ii]||z[$t]||z.namespaceURI==="http://www.w3.org/2000/svg"||z.hasAttribute("itemprop"))&&(z=N.createElement(O),N.head.insertBefore(z,N.querySelector("head > title"))),to(z,O,E),z[$t]=b,an(z),O=z;break e;case"link":var ce=GI("link","href",N).get(O+(E.href||""));if(ce){for(var xe=0;xe<ce.length;xe++)if(z=ce[xe],z.getAttribute("href")===(E.href==null||E.href===""?null:E.href)&&z.getAttribute("rel")===(E.rel==null?null:E.rel)&&z.getAttribute("title")===(E.title==null?null:E.title)&&z.getAttribute("crossorigin")===(E.crossOrigin==null?null:E.crossOrigin)){ce.splice(xe,1);break t}}z=N.createElement(O),to(z,O,E),N.head.appendChild(z);break;case"meta":if(ce=GI("meta","content",N).get(O+(E.content||""))){for(xe=0;xe<ce.length;xe++)if(z=ce[xe],z.getAttribute("content")===(E.content==null?null:""+E.content)&&z.getAttribute("name")===(E.name==null?null:E.name)&&z.getAttribute("property")===(E.property==null?null:E.property)&&z.getAttribute("http-equiv")===(E.httpEquiv==null?null:E.httpEquiv)&&z.getAttribute("charset")===(E.charSet==null?null:E.charSet)){ce.splice(xe,1);break t}}z=N.createElement(O),to(z,O,E),N.head.appendChild(z);break;default:throw Error(r(468,O))}z[$t]=b,an(z),O=z}b.stateNode=O}else jI(N,b.type,b.stateNode);else b.stateNode=$I(N,O,b.memoizedProps);else z!==O?(z===null?E.stateNode!==null&&(E=E.stateNode,E.parentNode.removeChild(E)):z.count--,O===null?jI(N,b.type,b.stateNode):$I(N,O,b.memoizedProps)):O===null&&b.stateNode!==null&&A4(b,b.memoizedProps,E.memoizedProps)}break;case 27:Ls(C,b),ks(b),O&512&&(Yi||E===null||kc(E,E.return)),E!==null&&O&4&&A4(b,b.memoizedProps,E.memoizedProps);break;case 5:if(Ls(C,b),ks(b),O&512&&(Yi||E===null||kc(E,E.return)),b.flags&32){N=b.stateNode;try{Fo(N,"")}catch(ot){jr(b,b.return,ot)}}O&4&&b.stateNode!=null&&(N=b.memoizedProps,A4(b,N,E!==null?E.memoizedProps:N)),O&1024&&(L4=!0);break;case 6:if(Ls(C,b),ks(b),O&4){if(b.stateNode===null)throw Error(r(162));O=b.memoizedProps,E=b.stateNode;try{E.nodeValue=O}catch(ot){jr(b,b.return,ot)}}break;case 3:if(d5=null,N=Zl,Zl=u5(C.containerInfo),Ls(C,b),Zl=N,ks(b),O&4&&E!==null&&E.memoizedState.isDehydrated)try{L1(C.containerInfo)}catch(ot){jr(b,b.return,ot)}L4&&(L4=!1,XM(b));break;case 4:O=Zl,Zl=u5(b.stateNode.containerInfo),Ls(C,b),ks(b),Zl=O;break;case 12:Ls(C,b),ks(b);break;case 13:Ls(C,b),ks(b),b.child.flags&8192&&b.memoizedState!==null!=(E!==null&&E.memoizedState!==null)&&(G4=Se()),O&4&&(O=b.updateQueue,O!==null&&(b.updateQueue=null,k4(b,O)));break;case 22:N=b.memoizedState!==null;var Ve=E!==null&&E.memoizedState!==null,nt=qu,wt=Yi;if(qu=nt||N,Yi=wt||Ve,Ls(C,b),Yi=wt,qu=nt,ks(b),O&8192)e:for(C=b.stateNode,C._visibility=N?C._visibility&-2:C._visibility|1,N&&(E===null||Ve||qu||Yi||F0(b)),E=null,C=b;;){if(C.tag===5||C.tag===26){if(E===null){Ve=E=C;try{if(z=Ve.stateNode,N)ce=z.style,typeof ce.setProperty=="function"?ce.setProperty("display","none","important"):ce.display="none";else{xe=Ve.stateNode;var Ot=Ve.memoizedProps.style,it=Ot!=null&&Ot.hasOwnProperty("display")?Ot.display:null;xe.style.display=it==null||typeof it=="boolean"?"":(""+it).trim()}}catch(ot){jr(Ve,Ve.return,ot)}}}else if(C.tag===6){if(E===null){Ve=C;try{Ve.stateNode.nodeValue=N?"":Ve.memoizedProps}catch(ot){jr(Ve,Ve.return,ot)}}}else if((C.tag!==22&&C.tag!==23||C.memoizedState===null||C===b)&&C.child!==null){C.child.return=C,C=C.child;continue}if(C===b)break e;for(;C.sibling===null;){if(C.return===null||C.return===b)break e;E===C&&(E=null),C=C.return}E===C&&(E=null),C.sibling.return=C.return,C=C.sibling}O&4&&(O=b.updateQueue,O!==null&&(E=O.retryQueue,E!==null&&(O.retryQueue=null,k4(b,E))));break;case 19:Ls(C,b),ks(b),O&4&&(O=b.updateQueue,O!==null&&(b.updateQueue=null,k4(b,O)));break;case 30:break;case 21:break;default:Ls(C,b),ks(b)}}function ks(b){var C=b.flags;if(C&2){try{for(var E,O=b.return;O!==null;){if($M(O)){E=O;break}O=O.return}if(E==null)throw Error(r(160));switch(E.tag){case 27:var N=E.stateNode,z=P4(b);Jy(b,z,N);break;case 5:var ce=E.stateNode;E.flags&32&&(Fo(ce,""),E.flags&=-33);var xe=P4(b);Jy(b,xe,ce);break;case 3:case 4:var Ve=E.stateNode.containerInfo,nt=P4(b);N4(b,nt,Ve);break;default:throw Error(r(161))}}catch(wt){jr(b,b.return,wt)}b.flags&=-3}C&4096&&(b.flags&=-4097)}function XM(b){if(b.subtreeFlags&1024)for(b=b.child;b!==null;){var C=b;XM(C),C.tag===5&&C.flags&1024&&C.stateNode.reset(),b=b.sibling}}function Zf(b,C){if(C.subtreeFlags&8772)for(C=C.child;C!==null;)zM(b,C.alternate,C),C=C.sibling}function F0(b){for(b=b.child;b!==null;){var C=b;switch(C.tag){case 0:case 11:case 14:case 15:Jf(4,C,C.return),F0(C);break;case 1:kc(C,C.return);var E=C.stateNode;typeof E.componentWillUnmount=="function"&&UM(C,C.return,E),F0(C);break;case 27:D1(C.stateNode);case 26:case 5:kc(C,C.return),F0(C);break;case 22:C.memoizedState===null&&F0(C);break;case 30:F0(C);break;default:F0(C)}b=b.sibling}}function Qf(b,C,E){for(E=E&&(C.subtreeFlags&8772)!==0,C=C.child;C!==null;){var O=C.alternate,N=b,z=C,ce=z.flags;switch(z.tag){case 0:case 11:case 15:Qf(N,z,E),v1(4,z);break;case 1:if(Qf(N,z,E),O=z,N=O.stateNode,typeof N.componentDidMount=="function")try{N.componentDidMount()}catch(nt){jr(O,O.return,nt)}if(O=z,N=O.updateQueue,N!==null){var xe=O.stateNode;try{var Ve=N.shared.hiddenCallbacks;if(Ve!==null)for(N.shared.hiddenCallbacks=null,N=0;N<Ve.length;N++)TO(Ve[N],xe)}catch(nt){jr(O,O.return,nt)}}E&&ce&64&&FM(z),y1(z,z.return);break;case 27:GM(z);case 26:case 5:Qf(N,z,E),E&&O===null&&ce&4&&BM(z),y1(z,z.return);break;case 12:Qf(N,z,E);break;case 13:Qf(N,z,E),E&&ce&4&&KM(N,z);break;case 22:z.memoizedState===null&&Qf(N,z,E),y1(z,z.return);break;case 30:break;default:Qf(N,z,E)}C=C.sibling}}function V4(b,C){var E=null;b!==null&&b.memoizedState!==null&&b.memoizedState.cachePool!==null&&(E=b.memoizedState.cachePool.pool),b=null,C.memoizedState!==null&&C.memoizedState.cachePool!==null&&(b=C.memoizedState.cachePool.pool),b!==E&&(b!=null&&b.refCount++,E!=null&&r1(E))}function F4(b,C){b=null,C.alternate!==null&&(b=C.alternate.memoizedState.cache),C=C.memoizedState.cache,C!==b&&(C.refCount++,b!=null&&r1(b))}function Vc(b,C,E,O){if(C.subtreeFlags&10256)for(C=C.child;C!==null;)YM(b,C,E,O),C=C.sibling}function YM(b,C,E,O){var N=C.flags;switch(C.tag){case 0:case 11:case 15:Vc(b,C,E,O),N&2048&&v1(9,C);break;case 1:Vc(b,C,E,O);break;case 3:Vc(b,C,E,O),N&2048&&(b=null,C.alternate!==null&&(b=C.alternate.memoizedState.cache),C=C.memoizedState.cache,C!==b&&(C.refCount++,b!=null&&r1(b)));break;case 12:if(N&2048){Vc(b,C,E,O),b=C.stateNode;try{var z=C.memoizedProps,ce=z.id,xe=z.onPostCommit;typeof xe=="function"&&xe(ce,C.alternate===null?"mount":"update",b.passiveEffectDuration,-0)}catch(Ve){jr(C,C.return,Ve)}}else Vc(b,C,E,O);break;case 13:Vc(b,C,E,O);break;case 23:break;case 22:z=C.stateNode,ce=C.alternate,C.memoizedState!==null?z._visibility&2?Vc(b,C,E,O):x1(b,C):z._visibility&2?Vc(b,C,E,O):(z._visibility|=2,Ip(b,C,E,O,(C.subtreeFlags&10256)!==0)),N&2048&&V4(ce,C);break;case 24:Vc(b,C,E,O),N&2048&&F4(C.alternate,C);break;default:Vc(b,C,E,O)}}function Ip(b,C,E,O,N){for(N=N&&(C.subtreeFlags&10256)!==0,C=C.child;C!==null;){var z=b,ce=C,xe=E,Ve=O,nt=ce.flags;switch(ce.tag){case 0:case 11:case 15:Ip(z,ce,xe,Ve,N),v1(8,ce);break;case 23:break;case 22:var wt=ce.stateNode;ce.memoizedState!==null?wt._visibility&2?Ip(z,ce,xe,Ve,N):x1(z,ce):(wt._visibility|=2,Ip(z,ce,xe,Ve,N)),N&&nt&2048&&V4(ce.alternate,ce);break;case 24:Ip(z,ce,xe,Ve,N),N&&nt&2048&&F4(ce.alternate,ce);break;default:Ip(z,ce,xe,Ve,N)}C=C.sibling}}function x1(b,C){if(C.subtreeFlags&10256)for(C=C.child;C!==null;){var E=b,O=C,N=O.flags;switch(O.tag){case 22:x1(E,O),N&2048&&V4(O.alternate,O);break;case 24:x1(E,O),N&2048&&F4(O.alternate,O);break;default:x1(E,O)}C=C.sibling}}var b1=8192;function Rp(b){if(b.subtreeFlags&b1)for(b=b.child;b!==null;)JM(b),b=b.sibling}function JM(b){switch(b.tag){case 26:Rp(b),b.flags&b1&&b.memoizedState!==null&&jne(Zl,b.memoizedState,b.memoizedProps);break;case 5:Rp(b);break;case 3:case 4:var C=Zl;Zl=u5(b.stateNode.containerInfo),Rp(b),Zl=C;break;case 22:b.memoizedState===null&&(C=b.alternate,C!==null&&C.memoizedState!==null?(C=b1,b1=16777216,Rp(b),b1=C):Rp(b));break;default:Rp(b)}}function ZM(b){var C=b.alternate;if(C!==null&&(b=C.child,b!==null)){C.child=null;do C=b.sibling,b.sibling=null,b=C;while(b!==null)}}function w1(b){var C=b.deletions;if((b.flags&16)!==0){if(C!==null)for(var E=0;E<C.length;E++){var O=C[E];Ba=O,eI(O,b)}ZM(b)}if(b.subtreeFlags&10256)for(b=b.child;b!==null;)QM(b),b=b.sibling}function QM(b){switch(b.tag){case 0:case 11:case 15:w1(b),b.flags&2048&&Jf(9,b,b.return);break;case 3:w1(b);break;case 12:w1(b);break;case 22:var C=b.stateNode;b.memoizedState!==null&&C._visibility&2&&(b.return===null||b.return.tag!==13)?(C._visibility&=-3,Zy(b)):w1(b);break;default:w1(b)}}function Zy(b){var C=b.deletions;if((b.flags&16)!==0){if(C!==null)for(var E=0;E<C.length;E++){var O=C[E];Ba=O,eI(O,b)}ZM(b)}for(b=b.child;b!==null;){switch(C=b,C.tag){case 0:case 11:case 15:Jf(8,C,C.return),Zy(C);break;case 22:E=C.stateNode,E._visibility&2&&(E._visibility&=-3,Zy(C));break;default:Zy(C)}b=b.sibling}}function eI(b,C){for(;Ba!==null;){var E=Ba;switch(E.tag){case 0:case 11:case 15:Jf(8,E,C);break;case 23:case 22:if(E.memoizedState!==null&&E.memoizedState.cachePool!==null){var O=E.memoizedState.cachePool.pool;O!=null&&O.refCount++}break;case 24:r1(E.memoizedState.cache)}if(O=E.child,O!==null)O.return=E,Ba=O;else e:for(E=b;Ba!==null;){O=Ba;var N=O.sibling,z=O.return;if(WM(O),O===E){Ba=null;break e}if(N!==null){N.return=z,Ba=N;break e}Ba=z}}}var ane={getCacheForType:function(b){var C=yo(Ea),E=C.data.get(b);return E===void 0&&(E=b(),C.data.set(b,E)),E}},one=typeof WeakMap=="function"?WeakMap:Map,Pr=0,qr=null,Yn=null,lr=0,Nr=0,Vs=null,ed=!1,Ap=!1,U4=!1,Yu=0,Bi=0,td=0,U0=0,B4=0,xl=0,Pp=0,C1=null,hs=null,$4=!1,G4=0,Qy=1/0,e5=null,nd=null,eo=0,rd=null,Np=null,Lp=0,j4=0,z4=null,tI=null,S1=0,W4=null;function Fs(){if((Pr&2)!==0&&lr!==0)return lr&-lr;if(U.T!==null){var b=Cp;return b!==0?b:Z4()}return Rt()}function nI(){xl===0&&(xl=(lr&536870912)===0||xr?Ut():536870912);var b=yl.current;return b!==null&&(b.flags|=32),xl}function Us(b,C,E){(b===qr&&(Nr===2||Nr===9)||b.cancelPendingCommit!==null)&&(kp(b,0),id(b,lr,xl,!1)),Ht(b,E),((Pr&2)===0||b!==qr)&&(b===qr&&((Pr&2)===0&&(U0|=E),Bi===4&&id(b,lr,xl,!1)),Fc(b))}function rI(b,C,E){if((Pr&6)!==0)throw Error(r(327));var O=!E&&(C&124)===0&&(C&b.expiredLanes)===0||We(b,C),N=O?cne(b,C):q4(b,C,!0),z=O;do{if(N===0){Ap&&!O&&id(b,C,0,!1);break}else{if(E=b.current.alternate,z&&!sne(E)){N=q4(b,C,!1),z=!1;continue}if(N===2){if(z=C,b.errorRecoveryDisabledLanes&z)var ce=0;else ce=b.pendingLanes&-536870913,ce=ce!==0?ce:ce&536870912?536870912:0;if(ce!==0){C=ce;e:{var xe=b;N=C1;var Ve=xe.current.memoizedState.isDehydrated;if(Ve&&(kp(xe,ce).flags|=256),ce=q4(xe,ce,!1),ce!==2){if(U4&&!Ve){xe.errorRecoveryDisabledLanes|=z,U0|=z,N=4;break e}z=hs,hs=N,z!==null&&(hs===null?hs=z:hs.push.apply(hs,z))}N=ce}if(z=!1,N!==2)continue}}if(N===1){kp(b,0),id(b,C,0,!0);break}e:{switch(O=b,z=N,z){case 0:case 1:throw Error(r(345));case 4:if((C&4194048)!==C)break;case 6:id(O,C,xl,!ed);break e;case 2:hs=null;break;case 3:case 5:break;default:throw Error(r(329))}if((C&62914560)===C&&(N=G4+300-Se(),10<N)){if(id(O,C,xl,!ed),Le(O,0,!0)!==0)break e;O.timeoutHandle=AI(iI.bind(null,O,E,hs,e5,$4,C,xl,U0,Pp,ed,z,2,-0,0),N);break e}iI(O,E,hs,e5,$4,C,xl,U0,Pp,ed,z,0,-0,0)}}break}while(!0);Fc(b)}function iI(b,C,E,O,N,z,ce,xe,Ve,nt,wt,Ot,it,ot){if(b.timeoutHandle=-1,Ot=C.subtreeFlags,(Ot&8192||(Ot&16785408)===16785408)&&(I1={stylesheets:null,count:0,unsuspend:Gne},JM(C),Ot=zne(),Ot!==null)){b.cancelPendingCommit=Ot(fI.bind(null,b,C,z,E,O,N,ce,xe,Ve,wt,1,it,ot)),id(b,z,ce,!nt);return}fI(b,C,z,E,O,N,ce,xe,Ve)}function sne(b){for(var C=b;;){var E=C.tag;if((E===0||E===11||E===15)&&C.flags&16384&&(E=C.updateQueue,E!==null&&(E=E.stores,E!==null)))for(var O=0;O<E.length;O++){var N=E[O],z=N.getSnapshot;N=N.value;try{if(!be(z(),N))return!1}catch{return!1}}if(E=C.child,C.subtreeFlags&16384&&E!==null)E.return=C,C=E;else{if(C===b)break;for(;C.sibling===null;){if(C.return===null||C.return===b)return!0;C=C.return}C.sibling.return=C.return,C=C.sibling}}return!0}function id(b,C,E,O){C&=~B4,C&=~U0,b.suspendedLanes|=C,b.pingedLanes&=~C,O&&(b.warmLanes|=C),O=b.expirationTimes;for(var N=C;0<N;){var z=31-$e(N),ce=1<<z;O[z]=-1,N&=~ce}E!==0&&sr(b,E,C)}function t5(){return(Pr&6)===0?(T1(0),!1):!0}function H4(){if(Yn!==null){if(Nr===0)var b=Yn.return;else b=Yn,Gu=P0=null,c4(b),Op=null,p1=0,b=Yn;for(;b!==null;)VM(b.alternate,b),b=b.return;Yn=null}}function kp(b,C){var E=b.timeoutHandle;E!==-1&&(b.timeoutHandle=-1,Ene(E)),E=b.cancelPendingCommit,E!==null&&(b.cancelPendingCommit=null,E()),H4(),qr=b,Yn=E=Uu(b.current,null),lr=C,Nr=0,Vs=null,ed=!1,Ap=We(b,C),U4=!1,Pp=xl=B4=U0=td=Bi=0,hs=C1=null,$4=!1,(C&8)!==0&&(C|=C&32);var O=b.entangledLanes;if(O!==0)for(b=b.entanglements,O&=C;0<O;){var N=31-$e(O),z=1<<N;C|=b[N],O&=~z}return Yu=C,Sy(),E}function aI(b,C){zn=null,U.H=Gy,C===a1||C===Ay?(C=CO(),Nr=3):C===xO?(C=CO(),Nr=4):Nr=C===SM?8:C!==null&&typeof C=="object"&&typeof C.then=="function"?6:1,Vs=C,Yn===null&&(Bi=1,Ky(b,pl(C,b.current)))}function oI(){var b=U.H;return U.H=Gy,b===null?Gy:b}function sI(){var b=U.A;return U.A=ane,b}function K4(){Bi=4,ed||(lr&4194048)!==lr&&yl.current!==null||(Ap=!0),(td&134217727)===0&&(U0&134217727)===0||qr===null||id(qr,lr,xl,!1)}function q4(b,C,E){var O=Pr;Pr|=2;var N=oI(),z=sI();(qr!==b||lr!==C)&&(e5=null,kp(b,C)),C=!1;var ce=Bi;e:do try{if(Nr!==0&&Yn!==null){var xe=Yn,Ve=Vs;switch(Nr){case 8:H4(),ce=6;break e;case 3:case 2:case 9:case 6:yl.current===null&&(C=!0);var nt=Nr;if(Nr=0,Vs=null,Vp(b,xe,Ve,nt),E&&Ap){ce=0;break e}break;default:nt=Nr,Nr=0,Vs=null,Vp(b,xe,Ve,nt)}}lne(),ce=Bi;break}catch(wt){aI(b,wt)}while(!0);return C&&b.shellSuspendCounter++,Gu=P0=null,Pr=O,U.H=N,U.A=z,Yn===null&&(qr=null,lr=0,Sy()),ce}function lne(){for(;Yn!==null;)lI(Yn)}function cne(b,C){var E=Pr;Pr|=2;var O=oI(),N=sI();qr!==b||lr!==C?(e5=null,Qy=Se()+500,kp(b,C)):Ap=We(b,C);e:do try{if(Nr!==0&&Yn!==null){C=Yn;var z=Vs;t:switch(Nr){case 1:Nr=0,Vs=null,Vp(b,C,z,1);break;case 2:case 9:if(bO(z)){Nr=0,Vs=null,cI(C);break}C=function(){Nr!==2&&Nr!==9||qr!==b||(Nr=7),Fc(b)},z.then(C,C);break e;case 3:Nr=7;break e;case 4:Nr=5;break e;case 7:bO(z)?(Nr=0,Vs=null,cI(C)):(Nr=0,Vs=null,Vp(b,C,z,7));break;case 5:var ce=null;switch(Yn.tag){case 26:ce=Yn.memoizedState;case 5:case 27:var xe=Yn;if(!ce||zI(ce)){Nr=0,Vs=null;var Ve=xe.sibling;if(Ve!==null)Yn=Ve;else{var nt=xe.return;nt!==null?(Yn=nt,n5(nt)):Yn=null}break t}}Nr=0,Vs=null,Vp(b,C,z,5);break;case 6:Nr=0,Vs=null,Vp(b,C,z,6);break;case 8:H4(),Bi=6;break e;default:throw Error(r(462))}}une();break}catch(wt){aI(b,wt)}while(!0);return Gu=P0=null,U.H=O,U.A=N,Pr=E,Yn!==null?0:(qr=null,lr=0,Sy(),Bi)}function une(){for(;Yn!==null&&!ue();)lI(Yn)}function lI(b){var C=LM(b.alternate,b,Yu);b.memoizedProps=b.pendingProps,C===null?n5(b):Yn=C}function cI(b){var C=b,E=C.alternate;switch(C.tag){case 15:case 0:C=MM(E,C,C.pendingProps,C.type,void 0,lr);break;case 11:C=MM(E,C,C.pendingProps,C.type.render,C.ref,lr);break;case 5:c4(C);default:VM(E,C),C=Yn=uO(C,Yu),C=LM(E,C,Yu)}b.memoizedProps=b.pendingProps,C===null?n5(b):Yn=C}function Vp(b,C,E,O){Gu=P0=null,c4(C),Op=null,p1=0;var N=C.return;try{if(Qte(b,N,C,E,lr)){Bi=1,Ky(b,pl(E,b.current)),Yn=null;return}}catch(z){if(N!==null)throw Yn=N,z;Bi=1,Ky(b,pl(E,b.current)),Yn=null;return}C.flags&32768?(xr||O===1?b=!0:Ap||(lr&536870912)!==0?b=!1:(ed=b=!0,(O===2||O===9||O===3||O===6)&&(O=yl.current,O!==null&&O.tag===13&&(O.flags|=16384))),uI(C,b)):n5(C)}function n5(b){var C=b;do{if((C.flags&32768)!==0){uI(C,ed);return}b=C.return;var E=tne(C.alternate,C,Yu);if(E!==null){Yn=E;return}if(C=C.sibling,C!==null){Yn=C;return}Yn=C=b}while(C!==null);Bi===0&&(Bi=5)}function uI(b,C){do{var E=nne(b.alternate,b);if(E!==null){E.flags&=32767,Yn=E;return}if(E=b.return,E!==null&&(E.flags|=32768,E.subtreeFlags=0,E.deletions=null),!C&&(b=b.sibling,b!==null)){Yn=b;return}Yn=b=E}while(b!==null);Bi=6,Yn=null}function fI(b,C,E,O,N,z,ce,xe,Ve){b.cancelPendingCommit=null;do r5();while(eo!==0);if((Pr&6)!==0)throw Error(r(327));if(C!==null){if(C===b.current)throw Error(r(177));if(z=C.lanes|C.childLanes,z|=FC,dn(b,E,z,ce,xe,Ve),b===qr&&(Yn=qr=null,lr=0),Np=C,rd=b,Lp=E,j4=z,z4=N,tI=O,(C.subtreeFlags&10256)!==0||(C.flags&10256)!==0?(b.callbackNode=null,b.callbackPriority=0,pne(pe,function(){return mI(),null})):(b.callbackNode=null,b.callbackPriority=0),O=(C.flags&13878)!==0,(C.subtreeFlags&13878)!==0||O){O=U.T,U.T=null,N=G.p,G.p=2,ce=Pr,Pr|=4;try{rne(b,C,E)}finally{Pr=ce,G.p=N,U.T=O}}eo=1,dI(),hI(),pI()}}function dI(){if(eo===1){eo=0;var b=rd,C=Np,E=(C.flags&13878)!==0;if((C.subtreeFlags&13878)!==0||E){E=U.T,U.T=null;var O=G.p;G.p=2;var N=Pr;Pr|=4;try{qM(C,b);var z=oS,ce=Ze(b.containerInfo),xe=z.focusedElem,Ve=z.selectionRange;if(ce!==xe&&xe&&xe.ownerDocument&&Ue(xe.ownerDocument.documentElement,xe)){if(Ve!==null&&ht(xe)){var nt=Ve.start,wt=Ve.end;if(wt===void 0&&(wt=nt),"selectionStart"in xe)xe.selectionStart=nt,xe.selectionEnd=Math.min(wt,xe.value.length);else{var Ot=xe.ownerDocument||document,it=Ot&&Ot.defaultView||window;if(it.getSelection){var ot=it.getSelection(),Cn=xe.textContent.length,vn=Math.min(Ve.start,Cn),Ur=Ve.end===void 0?vn:Math.min(Ve.end,Cn);!ot.extend&&vn>Ur&&(ce=Ur,Ur=vn,vn=ce);var Xe=Ne(xe,vn),je=Ne(xe,Ur);if(Xe&&je&&(ot.rangeCount!==1||ot.anchorNode!==Xe.node||ot.anchorOffset!==Xe.offset||ot.focusNode!==je.node||ot.focusOffset!==je.offset)){var tt=Ot.createRange();tt.setStart(Xe.node,Xe.offset),ot.removeAllRanges(),vn>Ur?(ot.addRange(tt),ot.extend(je.node,je.offset)):(tt.setEnd(je.node,je.offset),ot.addRange(tt))}}}}for(Ot=[],ot=xe;ot=ot.parentNode;)ot.nodeType===1&&Ot.push({element:ot,left:ot.scrollLeft,top:ot.scrollTop});for(typeof xe.focus=="function"&&xe.focus(),xe=0;xe<Ot.length;xe++){var Et=Ot[xe];Et.element.scrollLeft=Et.left,Et.element.scrollTop=Et.top}}g5=!!aS,oS=aS=null}finally{Pr=N,G.p=O,U.T=E}}b.current=C,eo=2}}function hI(){if(eo===2){eo=0;var b=rd,C=Np,E=(C.flags&8772)!==0;if((C.subtreeFlags&8772)!==0||E){E=U.T,U.T=null;var O=G.p;G.p=2;var N=Pr;Pr|=4;try{zM(b,C.alternate,C)}finally{Pr=N,G.p=O,U.T=E}}eo=3}}function pI(){if(eo===4||eo===3){eo=0,fe();var b=rd,C=Np,E=Lp,O=tI;(C.subtreeFlags&10256)!==0||(C.flags&10256)!==0?eo=5:(eo=0,Np=rd=null,gI(b,b.pendingLanes));var N=b.pendingLanes;if(N===0&&(nd=null),Dt(E),C=C.stateNode,ne&&typeof ne.onCommitFiberRoot=="function")try{ne.onCommitFiberRoot(Pe,C,void 0,(C.current.flags&128)===128)}catch{}if(O!==null){C=U.T,N=G.p,G.p=2,U.T=null;try{for(var z=b.onRecoverableError,ce=0;ce<O.length;ce++){var xe=O[ce];z(xe.value,{componentStack:xe.stack})}}finally{U.T=C,G.p=N}}(Lp&3)!==0&&r5(),Fc(b),N=b.pendingLanes,(E&4194090)!==0&&(N&42)!==0?b===W4?S1++:(S1=0,W4=b):S1=0,T1(0)}}function gI(b,C){(b.pooledCacheLanes&=C)===0&&(C=b.pooledCache,C!=null&&(b.pooledCache=null,r1(C)))}function r5(b){return dI(),hI(),pI(),mI()}function mI(){if(eo!==5)return!1;var b=rd,C=j4;j4=0;var E=Dt(Lp),O=U.T,N=G.p;try{G.p=32>E?32:E,U.T=null,E=z4,z4=null;var z=rd,ce=Lp;if(eo=0,Np=rd=null,Lp=0,(Pr&6)!==0)throw Error(r(331));var xe=Pr;if(Pr|=4,QM(z.current),YM(z,z.current,ce,E),Pr=xe,T1(0,!1),ne&&typeof ne.onPostCommitFiberRoot=="function")try{ne.onPostCommitFiberRoot(Pe,z)}catch{}return!0}finally{G.p=N,U.T=O,gI(b,C)}}function vI(b,C,E){C=pl(E,C),C=S4(b.stateNode,C,2),b=Kf(b,C,2),b!==null&&(Ht(b,2),Fc(b))}function jr(b,C,E){if(b.tag===3)vI(b,b,E);else for(;C!==null;){if(C.tag===3){vI(C,b,E);break}else if(C.tag===1){var O=C.stateNode;if(typeof C.type.getDerivedStateFromError=="function"||typeof O.componentDidCatch=="function"&&(nd===null||!nd.has(O))){b=pl(E,b),E=wM(2),O=Kf(C,E,2),O!==null&&(CM(E,O,C,b),Ht(O,2),Fc(O));break}}C=C.return}}function X4(b,C,E){var O=b.pingCache;if(O===null){O=b.pingCache=new one;var N=new Set;O.set(C,N)}else N=O.get(C),N===void 0&&(N=new Set,O.set(C,N));N.has(E)||(U4=!0,N.add(E),b=fne.bind(null,b,C,E),C.then(b,b))}function fne(b,C,E){var O=b.pingCache;O!==null&&O.delete(C),b.pingedLanes|=b.suspendedLanes&E,b.warmLanes&=~E,qr===b&&(lr&E)===E&&(Bi===4||Bi===3&&(lr&62914560)===lr&&300>Se()-G4?(Pr&2)===0&&kp(b,0):B4|=E,Pp===lr&&(Pp=0)),Fc(b)}function yI(b,C){C===0&&(C=gn()),b=yp(b,C),b!==null&&(Ht(b,C),Fc(b))}function dne(b){var C=b.memoizedState,E=0;C!==null&&(E=C.retryLane),yI(b,E)}function hne(b,C){var E=0;switch(b.tag){case 13:var O=b.stateNode,N=b.memoizedState;N!==null&&(E=N.retryLane);break;case 19:O=b.stateNode;break;case 22:O=b.stateNode._retryCache;break;default:throw Error(r(314))}O!==null&&O.delete(C),yI(b,E)}function pne(b,C){return Y(b,C)}var i5=null,Fp=null,Y4=!1,a5=!1,J4=!1,B0=0;function Fc(b){b!==Fp&&b.next===null&&(Fp===null?i5=Fp=b:Fp=Fp.next=b),a5=!0,Y4||(Y4=!0,mne())}function T1(b,C){if(!J4&&a5){J4=!0;do for(var E=!1,O=i5;O!==null;){if(b!==0){var N=O.pendingLanes;if(N===0)var z=0;else{var ce=O.suspendedLanes,xe=O.pingedLanes;z=(1<<31-$e(42|b)+1)-1,z&=N&~(ce&~xe),z=z&201326741?z&201326741|1:z?z|2:0}z!==0&&(E=!0,CI(O,z))}else z=lr,z=Le(O,O===qr?z:0,O.cancelPendingCommit!==null||O.timeoutHandle!==-1),(z&3)===0||We(O,z)||(E=!0,CI(O,z));O=O.next}while(E);J4=!1}}function gne(){xI()}function xI(){a5=Y4=!1;var b=0;B0!==0&&(Tne()&&(b=B0),B0=0);for(var C=Se(),E=null,O=i5;O!==null;){var N=O.next,z=bI(O,C);z===0?(O.next=null,E===null?i5=N:E.next=N,N===null&&(Fp=E)):(E=O,(b!==0||(z&3)!==0)&&(a5=!0)),O=N}T1(b)}function bI(b,C){for(var E=b.suspendedLanes,O=b.pingedLanes,N=b.expirationTimes,z=b.pendingLanes&-62914561;0<z;){var ce=31-$e(z),xe=1<<ce,Ve=N[ce];Ve===-1?((xe&E)===0||(xe&O)!==0)&&(N[ce]=xt(xe,C)):Ve<=C&&(b.expiredLanes|=xe),z&=~xe}if(C=qr,E=lr,E=Le(b,b===C?E:0,b.cancelPendingCommit!==null||b.timeoutHandle!==-1),O=b.callbackNode,E===0||b===C&&(Nr===2||Nr===9)||b.cancelPendingCommit!==null)return O!==null&&O!==null&&ie(O),b.callbackNode=null,b.callbackPriority=0;if((E&3)===0||We(b,E)){if(C=E&-E,C===b.callbackPriority)return C;switch(O!==null&&ie(O),Dt(E)){case 2:case 8:E=He;break;case 32:E=pe;break;case 268435456:E=Ie;break;default:E=pe}return O=wI.bind(null,b),E=Y(E,O),b.callbackPriority=C,b.callbackNode=E,C}return O!==null&&O!==null&&ie(O),b.callbackPriority=2,b.callbackNode=null,2}function wI(b,C){if(eo!==0&&eo!==5)return b.callbackNode=null,b.callbackPriority=0,null;var E=b.callbackNode;if(r5()&&b.callbackNode!==E)return null;var O=lr;return O=Le(b,b===qr?O:0,b.cancelPendingCommit!==null||b.timeoutHandle!==-1),O===0?null:(rI(b,O,C),bI(b,Se()),b.callbackNode!=null&&b.callbackNode===E?wI.bind(null,b):null)}function CI(b,C){if(r5())return null;rI(b,C,!0)}function mne(){_ne(function(){(Pr&6)!==0?Y(Ke,gne):xI()})}function Z4(){return B0===0&&(B0=Ut()),B0}function SI(b){return b==null||typeof b=="symbol"||typeof b=="boolean"?null:typeof b=="function"?b:is(""+b)}function TI(b,C){var E=C.ownerDocument.createElement("input");return E.name=C.name,E.value=C.value,b.id&&E.setAttribute("form",b.id),C.parentNode.insertBefore(E,C),b=new FormData(b),E.parentNode.removeChild(E),b}function vne(b,C,E,O,N){if(C==="submit"&&E&&E.stateNode===N){var z=SI((N[Xt]||null).action),ce=O.submitter;ce&&(C=(C=ce[Xt]||null)?SI(C.formAction):ce.getAttribute("formAction"),C!==null&&(z=C,ce=null));var xe=new sl("action","action",null,O,N);b.push({event:xe,listeners:[{instance:null,listener:function(){if(O.defaultPrevented){if(B0!==0){var Ve=ce?TI(N,ce):new FormData(N);y4(E,{pending:!0,data:Ve,method:N.method,action:z},null,Ve)}}else typeof z=="function"&&(xe.preventDefault(),Ve=ce?TI(N,ce):new FormData(N),y4(E,{pending:!0,data:Ve,method:N.method,action:z},z,Ve))},currentTarget:N}]})}}for(var Q4=0;Q4<VC.length;Q4++){var eS=VC[Q4],yne=eS.toLowerCase(),xne=eS[0].toUpperCase()+eS.slice(1);Jl(yne,"on"+xne)}Jl(jf,"onAnimationEnd"),Jl(Jm,"onAnimationIteration"),Jl(Zm,"onAnimationStart"),Jl("dblclick","onDoubleClick"),Jl("focusin","onFocus"),Jl("focusout","onBlur"),Jl(kte,"onTransitionRun"),Jl(Vte,"onTransitionStart"),Jl(Fte,"onTransitionCancel"),Jl(oO,"onTransitionEnd"),Ai("onMouseEnter",["mouseout","mouseover"]),Ai("onMouseLeave",["mouseout","mouseover"]),Ai("onPointerEnter",["pointerout","pointerover"]),Ai("onPointerLeave",["pointerout","pointerover"]),ii("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ii("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ii("onBeforeInput",["compositionend","keypress","textInput","paste"]),ii("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ii("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ii("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var E1="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),bne=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(E1));function EI(b,C){C=(C&4)!==0;for(var E=0;E<b.length;E++){var O=b[E],N=O.event;O=O.listeners;e:{var z=void 0;if(C)for(var ce=O.length-1;0<=ce;ce--){var xe=O[ce],Ve=xe.instance,nt=xe.currentTarget;if(xe=xe.listener,Ve!==z&&N.isPropagationStopped())break e;z=xe,N.currentTarget=nt;try{z(N)}catch(wt){Hy(wt)}N.currentTarget=null,z=Ve}else for(ce=0;ce<O.length;ce++){if(xe=O[ce],Ve=xe.instance,nt=xe.currentTarget,xe=xe.listener,Ve!==z&&N.isPropagationStopped())break e;z=xe,N.currentTarget=nt;try{z(N)}catch(wt){Hy(wt)}N.currentTarget=null,z=Ve}}}}function Jn(b,C){var E=C[Qt];E===void 0&&(E=C[Qt]=new Set);var O=b+"__bubble";E.has(O)||(_I(C,b,2,!1),E.add(O))}function tS(b,C,E){var O=0;C&&(O|=4),_I(E,b,O,C)}var o5="_reactListening"+Math.random().toString(36).slice(2);function nS(b){if(!b[o5]){b[o5]=!0,ri.forEach(function(E){E!=="selectionchange"&&(bne.has(E)||tS(E,!1,b),tS(E,!0,b))});var C=b.nodeType===9?b:b.ownerDocument;C===null||C[o5]||(C[o5]=!0,tS("selectionchange",!1,C))}}function _I(b,C,E,O){switch(YI(C)){case 2:var N=Kne;break;case 8:N=qne;break;default:N=mS}E=N.bind(null,C,E,b),N=void 0,!ai||C!=="touchstart"&&C!=="touchmove"&&C!=="wheel"||(N=!0),O?N!==void 0?b.addEventListener(C,E,{capture:!0,passive:N}):b.addEventListener(C,E,!0):N!==void 0?b.addEventListener(C,E,{passive:N}):b.addEventListener(C,E,!1)}function rS(b,C,E,O,N){var z=O;if((C&1)===0&&(C&2)===0&&O!==null)e:for(;;){if(O===null)return;var ce=O.tag;if(ce===3||ce===4){var xe=O.stateNode.containerInfo;if(xe===N)break;if(ce===4)for(ce=O.return;ce!==null;){var Ve=ce.tag;if((Ve===3||Ve===4)&&ce.stateNode.containerInfo===N)return;ce=ce.return}for(;xe!==null;){if(ce=Ri(xe),ce===null)return;if(Ve=ce.tag,Ve===5||Ve===6||Ve===26||Ve===27){O=z=ce;continue e}xe=xe.parentNode}}O=O.return}Sr(function(){var nt=z,wt=qi(E),Ot=[];e:{var it=sO.get(b);if(it!==void 0){var ot=sl,Cn=b;switch(b){case"keypress":if(ss(E)===0)break e;case"keydown":case"keyup":ot=Ic;break;case"focusin":Cn="focus",ot=Wl;break;case"focusout":Cn="blur",ot=Wl;break;case"beforeblur":case"afterblur":ot=Wl;break;case"click":if(E.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ot=Tc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ot=Iu;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ot=Fu;break;case jf:case Jm:case Zm:ot=Au;break;case oO:ot=ql;break;case"scroll":case"scrollend":ot=Is;break;case"wheel":ot=cs;break;case"copy":case"cut":case"paste":ot=Dc;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ot=Rc;break;case"toggle":case"beforetoggle":ot=Ac}var vn=(C&4)!==0,Ur=!vn&&(b==="scroll"||b==="scrollend"),Xe=vn?it!==null?it+"Capture":null:it;vn=[];for(var je=nt,tt;je!==null;){var Et=je;if(tt=Et.stateNode,Et=Et.tag,Et!==5&&Et!==26&&Et!==27||tt===null||Xe===null||(Et=Ya(je,Xe),Et!=null&&vn.push(_1(je,Et,tt))),Ur)break;je=je.return}0<vn.length&&(it=new ot(it,Cn,null,E,wt),Ot.push({event:it,listeners:vn}))}}if((C&7)===0){e:{if(it=b==="mouseover"||b==="pointerover",ot=b==="mouseout"||b==="pointerout",it&&E!==mo&&(Cn=E.relatedTarget||E.fromElement)&&(Ri(Cn)||Cn[Lt]))break e;if((ot||it)&&(it=wt.window===wt?wt:(it=wt.ownerDocument)?it.defaultView||it.parentWindow:window,ot?(Cn=E.relatedTarget||E.toElement,ot=nt,Cn=Cn?Ri(Cn):null,Cn!==null&&(Ur=a(Cn),vn=Cn.tag,Cn!==Ur||vn!==5&&vn!==27&&vn!==6)&&(Cn=null)):(ot=null,Cn=nt),ot!==Cn)){if(vn=Tc,Et="onMouseLeave",Xe="onMouseEnter",je="mouse",(b==="pointerout"||b==="pointerover")&&(vn=Rc,Et="onPointerLeave",Xe="onPointerEnter",je="pointer"),Ur=ot==null?it:Xn(ot),tt=Cn==null?it:Xn(Cn),it=new vn(Et,je+"leave",ot,E,wt),it.target=Ur,it.relatedTarget=tt,Et=null,Ri(wt)===nt&&(vn=new vn(Xe,je+"enter",Cn,E,wt),vn.target=tt,vn.relatedTarget=Ur,Et=vn),Ur=Et,ot&&Cn)t:{for(vn=ot,Xe=Cn,je=0,tt=vn;tt;tt=Up(tt))je++;for(tt=0,Et=Xe;Et;Et=Up(Et))tt++;for(;0<je-tt;)vn=Up(vn),je--;for(;0<tt-je;)Xe=Up(Xe),tt--;for(;je--;){if(vn===Xe||Xe!==null&&vn===Xe.alternate)break t;vn=Up(vn),Xe=Up(Xe)}vn=null}else vn=null;ot!==null&&DI(Ot,it,ot,vn,!1),Cn!==null&&Ur!==null&&DI(Ot,Ur,Cn,vn,!0)}}e:{if(it=nt?Xn(nt):window,ot=it.nodeName&&it.nodeName.toLowerCase(),ot==="select"||ot==="input"&&it.type==="file")var Yt=oe;else if(bt(it))if(Te)Yt=K;else{Yt=te;var qn=Z}else ot=it.nodeName,!ot||ot.toLowerCase()!=="input"||it.type!=="checkbox"&&it.type!=="radio"?nt&&ol(nt.elementType)&&(Yt=oe):Yt=W;if(Yt&&(Yt=Yt(b,nt))){kt(Ot,Yt,E,wt);break e}qn&&qn(b,it,nt),b==="focusout"&&nt&&it.type==="number"&&nt.memoizedProps.value!=null&&Ca(it,"number",it.value)}switch(qn=nt?Xn(nt):window,b){case"focusin":(bt(qn)||qn.contentEditable==="true")&&(Wt=qn,Gt=nt,hn=null);break;case"focusout":hn=Gt=Wt=null;break;case"mousedown":mn=!0;break;case"contextmenu":case"mouseup":case"dragend":mn=!1,er(Ot,E,wt);break;case"selectionchange":if(Pt)break;case"keydown":case"keyup":er(Ot,E,wt)}var cn;if(Ps)e:{switch(b){case"compositionstart":var xn="onCompositionStart";break e;case"compositionend":xn="onCompositionEnd";break e;case"compositionupdate":xn="onCompositionUpdate";break e}xn=void 0}else at?Oe(b,E)&&(xn="onCompositionEnd"):b==="keydown"&&E.keyCode===229&&(xn="onCompositionStart");xn&&(Xl&&E.locale!=="ko"&&(at||xn!=="onCompositionStart"?xn==="onCompositionEnd"&&at&&(cn=Ja()):(oi=wt,zl="value"in oi?oi.value:oi.textContent,at=!0)),qn=s5(nt,xn),0<qn.length&&(xn=new ul(xn,b,null,E,wt),Ot.push({event:xn,listeners:qn}),cn?xn.data=cn:(cn=Ye(E),cn!==null&&(xn.data=cn)))),(cn=dl?gt(b,E):mt(b,E))&&(xn=s5(nt,"onBeforeInput"),0<xn.length&&(qn=new ul("onBeforeInput","beforeinput",null,E,wt),Ot.push({event:qn,listeners:xn}),qn.data=cn)),vne(Ot,b,nt,E,wt)}EI(Ot,C)})}function _1(b,C,E){return{instance:b,listener:C,currentTarget:E}}function s5(b,C){for(var E=C+"Capture",O=[];b!==null;){var N=b,z=N.stateNode;if(N=N.tag,N!==5&&N!==26&&N!==27||z===null||(N=Ya(b,E),N!=null&&O.unshift(_1(b,N,z)),N=Ya(b,C),N!=null&&O.push(_1(b,N,z))),b.tag===3)return O;b=b.return}return[]}function Up(b){if(b===null)return null;do b=b.return;while(b&&b.tag!==5&&b.tag!==27);return b||null}function DI(b,C,E,O,N){for(var z=C._reactName,ce=[];E!==null&&E!==O;){var xe=E,Ve=xe.alternate,nt=xe.stateNode;if(xe=xe.tag,Ve!==null&&Ve===O)break;xe!==5&&xe!==26&&xe!==27||nt===null||(Ve=nt,N?(nt=Ya(E,z),nt!=null&&ce.unshift(_1(E,nt,Ve))):N||(nt=Ya(E,z),nt!=null&&ce.push(_1(E,nt,Ve)))),E=E.return}ce.length!==0&&b.push({event:C,listeners:ce})}var wne=/\r\n?/g,Cne=/\u0000|\uFFFD/g;function OI(b){return(typeof b=="string"?b:""+b).replace(wne,`
`).replace(Cne,"")}function MI(b,C){return C=OI(C),OI(b)===C}function l5(){}function Fr(b,C,E,O,N,z){switch(E){case"children":typeof O=="string"?C==="body"||C==="textarea"&&O===""||Fo(b,O):(typeof O=="number"||typeof O=="bigint")&&C!=="body"&&Fo(b,""+O);break;case"className":Lo(b,"class",O);break;case"tabIndex":Lo(b,"tabindex",O);break;case"dir":case"role":case"viewBox":case"width":case"height":Lo(b,E,O);break;case"style":Kr(b,O,z);break;case"data":if(C!=="object"){Lo(b,"data",O);break}case"src":case"href":if(O===""&&(C!=="a"||E!=="href")){b.removeAttribute(E);break}if(O==null||typeof O=="function"||typeof O=="symbol"||typeof O=="boolean"){b.removeAttribute(E);break}O=is(""+O),b.setAttribute(E,O);break;case"action":case"formAction":if(typeof O=="function"){b.setAttribute(E,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof z=="function"&&(E==="formAction"?(C!=="input"&&Fr(b,C,"name",N.name,N,null),Fr(b,C,"formEncType",N.formEncType,N,null),Fr(b,C,"formMethod",N.formMethod,N,null),Fr(b,C,"formTarget",N.formTarget,N,null)):(Fr(b,C,"encType",N.encType,N,null),Fr(b,C,"method",N.method,N,null),Fr(b,C,"target",N.target,N,null)));if(O==null||typeof O=="symbol"||typeof O=="boolean"){b.removeAttribute(E);break}O=is(""+O),b.setAttribute(E,O);break;case"onClick":O!=null&&(b.onclick=l5);break;case"onScroll":O!=null&&Jn("scroll",b);break;case"onScrollEnd":O!=null&&Jn("scrollend",b);break;case"dangerouslySetInnerHTML":if(O!=null){if(typeof O!="object"||!("__html"in O))throw Error(r(61));if(E=O.__html,E!=null){if(N.children!=null)throw Error(r(60));b.innerHTML=E}}break;case"multiple":b.multiple=O&&typeof O!="function"&&typeof O!="symbol";break;case"muted":b.muted=O&&typeof O!="function"&&typeof O!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(O==null||typeof O=="function"||typeof O=="boolean"||typeof O=="symbol"){b.removeAttribute("xlink:href");break}E=is(""+O),b.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",E);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":O!=null&&typeof O!="function"&&typeof O!="symbol"?b.setAttribute(E,""+O):b.removeAttribute(E);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":O&&typeof O!="function"&&typeof O!="symbol"?b.setAttribute(E,""):b.removeAttribute(E);break;case"capture":case"download":O===!0?b.setAttribute(E,""):O!==!1&&O!=null&&typeof O!="function"&&typeof O!="symbol"?b.setAttribute(E,O):b.removeAttribute(E);break;case"cols":case"rows":case"size":case"span":O!=null&&typeof O!="function"&&typeof O!="symbol"&&!isNaN(O)&&1<=O?b.setAttribute(E,O):b.removeAttribute(E);break;case"rowSpan":case"start":O==null||typeof O=="function"||typeof O=="symbol"||isNaN(O)?b.removeAttribute(E):b.setAttribute(E,O);break;case"popover":Jn("beforetoggle",b),Jn("toggle",b),Ni(b,"popover",O);break;case"xlinkActuate":At(b,"http://www.w3.org/1999/xlink","xlink:actuate",O);break;case"xlinkArcrole":At(b,"http://www.w3.org/1999/xlink","xlink:arcrole",O);break;case"xlinkRole":At(b,"http://www.w3.org/1999/xlink","xlink:role",O);break;case"xlinkShow":At(b,"http://www.w3.org/1999/xlink","xlink:show",O);break;case"xlinkTitle":At(b,"http://www.w3.org/1999/xlink","xlink:title",O);break;case"xlinkType":At(b,"http://www.w3.org/1999/xlink","xlink:type",O);break;case"xmlBase":At(b,"http://www.w3.org/XML/1998/namespace","xml:base",O);break;case"xmlLang":At(b,"http://www.w3.org/XML/1998/namespace","xml:lang",O);break;case"xmlSpace":At(b,"http://www.w3.org/XML/1998/namespace","xml:space",O);break;case"is":Ni(b,"is",O);break;case"innerText":case"textContent":break;default:(!(2<E.length)||E[0]!=="o"&&E[0]!=="O"||E[1]!=="n"&&E[1]!=="N")&&(E=Ta.get(E)||E,Ni(b,E,O))}}function iS(b,C,E,O,N,z){switch(E){case"style":Kr(b,O,z);break;case"dangerouslySetInnerHTML":if(O!=null){if(typeof O!="object"||!("__html"in O))throw Error(r(61));if(E=O.__html,E!=null){if(N.children!=null)throw Error(r(60));b.innerHTML=E}}break;case"children":typeof O=="string"?Fo(b,O):(typeof O=="number"||typeof O=="bigint")&&Fo(b,""+O);break;case"onScroll":O!=null&&Jn("scroll",b);break;case"onScrollEnd":O!=null&&Jn("scrollend",b);break;case"onClick":O!=null&&(b.onclick=l5);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!ts.hasOwnProperty(E))e:{if(E[0]==="o"&&E[1]==="n"&&(N=E.endsWith("Capture"),C=E.slice(2,N?E.length-7:void 0),z=b[Xt]||null,z=z!=null?z[E]:null,typeof z=="function"&&b.removeEventListener(C,z,N),typeof O=="function")){typeof z!="function"&&z!==null&&(E in b?b[E]=null:b.hasAttribute(E)&&b.removeAttribute(E)),b.addEventListener(C,O,N);break e}E in b?b[E]=O:O===!0?b.setAttribute(E,""):Ni(b,E,O)}}}function to(b,C,E){switch(C){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Jn("error",b),Jn("load",b);var O=!1,N=!1,z;for(z in E)if(E.hasOwnProperty(z)){var ce=E[z];if(ce!=null)switch(z){case"src":O=!0;break;case"srcSet":N=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,C));default:Fr(b,C,z,ce,E,null)}}N&&Fr(b,C,"srcSet",E.srcSet,E,null),O&&Fr(b,C,"src",E.src,E,null);return;case"input":Jn("invalid",b);var xe=z=ce=N=null,Ve=null,nt=null;for(O in E)if(E.hasOwnProperty(O)){var wt=E[O];if(wt!=null)switch(O){case"name":N=wt;break;case"type":ce=wt;break;case"checked":Ve=wt;break;case"defaultChecked":nt=wt;break;case"value":z=wt;break;case"defaultValue":xe=wt;break;case"children":case"dangerouslySetInnerHTML":if(wt!=null)throw Error(r(137,C));break;default:Fr(b,C,O,wt,E,null)}}Sc(b,z,xe,Ve,nt,ce,N,!1),Vo(b);return;case"select":Jn("invalid",b),O=ce=z=null;for(N in E)if(E.hasOwnProperty(N)&&(xe=E[N],xe!=null))switch(N){case"value":z=xe;break;case"defaultValue":ce=xe;break;case"multiple":O=xe;default:Fr(b,C,N,xe,E,null)}C=z,E=ce,b.multiple=!!O,C!=null?ki(b,!!O,C,!1):E!=null&&ki(b,!!O,E,!0);return;case"textarea":Jn("invalid",b),z=N=O=null;for(ce in E)if(E.hasOwnProperty(ce)&&(xe=E[ce],xe!=null))switch(ce){case"value":O=xe;break;case"defaultValue":N=xe;break;case"children":z=xe;break;case"dangerouslySetInnerHTML":if(xe!=null)throw Error(r(91));break;default:Fr(b,C,ce,xe,E,null)}Vi(b,O,N,z),Vo(b);return;case"option":for(Ve in E)if(E.hasOwnProperty(Ve)&&(O=E[Ve],O!=null))switch(Ve){case"selected":b.selected=O&&typeof O!="function"&&typeof O!="symbol";break;default:Fr(b,C,Ve,O,E,null)}return;case"dialog":Jn("beforetoggle",b),Jn("toggle",b),Jn("cancel",b),Jn("close",b);break;case"iframe":case"object":Jn("load",b);break;case"video":case"audio":for(O=0;O<E1.length;O++)Jn(E1[O],b);break;case"image":Jn("error",b),Jn("load",b);break;case"details":Jn("toggle",b);break;case"embed":case"source":case"link":Jn("error",b),Jn("load",b);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(nt in E)if(E.hasOwnProperty(nt)&&(O=E[nt],O!=null))switch(nt){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,C));default:Fr(b,C,nt,O,E,null)}return;default:if(ol(C)){for(wt in E)E.hasOwnProperty(wt)&&(O=E[wt],O!==void 0&&iS(b,C,wt,O,E,void 0));return}}for(xe in E)E.hasOwnProperty(xe)&&(O=E[xe],O!=null&&Fr(b,C,xe,O,E,null))}function Sne(b,C,E,O){switch(C){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var N=null,z=null,ce=null,xe=null,Ve=null,nt=null,wt=null;for(ot in E){var Ot=E[ot];if(E.hasOwnProperty(ot)&&Ot!=null)switch(ot){case"checked":break;case"value":break;case"defaultValue":Ve=Ot;default:O.hasOwnProperty(ot)||Fr(b,C,ot,null,O,Ot)}}for(var it in O){var ot=O[it];if(Ot=E[it],O.hasOwnProperty(it)&&(ot!=null||Ot!=null))switch(it){case"type":z=ot;break;case"name":N=ot;break;case"checked":nt=ot;break;case"defaultChecked":wt=ot;break;case"value":ce=ot;break;case"defaultValue":xe=ot;break;case"children":case"dangerouslySetInnerHTML":if(ot!=null)throw Error(r(137,C));break;default:ot!==Ot&&Fr(b,C,it,ot,O,Ot)}}Gl(b,ce,xe,Ve,nt,wt,z,N);return;case"select":ot=ce=xe=it=null;for(z in E)if(Ve=E[z],E.hasOwnProperty(z)&&Ve!=null)switch(z){case"value":break;case"multiple":ot=Ve;default:O.hasOwnProperty(z)||Fr(b,C,z,null,O,Ve)}for(N in O)if(z=O[N],Ve=E[N],O.hasOwnProperty(N)&&(z!=null||Ve!=null))switch(N){case"value":it=z;break;case"defaultValue":xe=z;break;case"multiple":ce=z;default:z!==Ve&&Fr(b,C,N,z,O,Ve)}C=xe,E=ce,O=ot,it!=null?ki(b,!!E,it,!1):!!O!=!!E&&(C!=null?ki(b,!!E,C,!0):ki(b,!!E,E?[]:"",!1));return;case"textarea":ot=it=null;for(xe in E)if(N=E[xe],E.hasOwnProperty(xe)&&N!=null&&!O.hasOwnProperty(xe))switch(xe){case"value":break;case"children":break;default:Fr(b,C,xe,null,O,N)}for(ce in O)if(N=O[ce],z=E[ce],O.hasOwnProperty(ce)&&(N!=null||z!=null))switch(ce){case"value":it=N;break;case"defaultValue":ot=N;break;case"children":break;case"dangerouslySetInnerHTML":if(N!=null)throw Error(r(91));break;default:N!==z&&Fr(b,C,ce,N,O,z)}Sa(b,it,ot);return;case"option":for(var Cn in E)if(it=E[Cn],E.hasOwnProperty(Cn)&&it!=null&&!O.hasOwnProperty(Cn))switch(Cn){case"selected":b.selected=!1;break;default:Fr(b,C,Cn,null,O,it)}for(Ve in O)if(it=O[Ve],ot=E[Ve],O.hasOwnProperty(Ve)&&it!==ot&&(it!=null||ot!=null))switch(Ve){case"selected":b.selected=it&&typeof it!="function"&&typeof it!="symbol";break;default:Fr(b,C,Ve,it,O,ot)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var vn in E)it=E[vn],E.hasOwnProperty(vn)&&it!=null&&!O.hasOwnProperty(vn)&&Fr(b,C,vn,null,O,it);for(nt in O)if(it=O[nt],ot=E[nt],O.hasOwnProperty(nt)&&it!==ot&&(it!=null||ot!=null))switch(nt){case"children":case"dangerouslySetInnerHTML":if(it!=null)throw Error(r(137,C));break;default:Fr(b,C,nt,it,O,ot)}return;default:if(ol(C)){for(var Ur in E)it=E[Ur],E.hasOwnProperty(Ur)&&it!==void 0&&!O.hasOwnProperty(Ur)&&iS(b,C,Ur,void 0,O,it);for(wt in O)it=O[wt],ot=E[wt],!O.hasOwnProperty(wt)||it===ot||it===void 0&&ot===void 0||iS(b,C,wt,it,O,ot);return}}for(var Xe in E)it=E[Xe],E.hasOwnProperty(Xe)&&it!=null&&!O.hasOwnProperty(Xe)&&Fr(b,C,Xe,null,O,it);for(Ot in O)it=O[Ot],ot=E[Ot],!O.hasOwnProperty(Ot)||it===ot||it==null&&ot==null||Fr(b,C,Ot,it,O,ot)}var aS=null,oS=null;function c5(b){return b.nodeType===9?b:b.ownerDocument}function II(b){switch(b){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function RI(b,C){if(b===0)switch(C){case"svg":return 1;case"math":return 2;default:return 0}return b===1&&C==="foreignObject"?0:b}function sS(b,C){return b==="textarea"||b==="noscript"||typeof C.children=="string"||typeof C.children=="number"||typeof C.children=="bigint"||typeof C.dangerouslySetInnerHTML=="object"&&C.dangerouslySetInnerHTML!==null&&C.dangerouslySetInnerHTML.__html!=null}var lS=null;function Tne(){var b=window.event;return b&&b.type==="popstate"?b===lS?!1:(lS=b,!0):(lS=null,!1)}var AI=typeof setTimeout=="function"?setTimeout:void 0,Ene=typeof clearTimeout=="function"?clearTimeout:void 0,PI=typeof Promise=="function"?Promise:void 0,_ne=typeof queueMicrotask=="function"?queueMicrotask:typeof PI<"u"?function(b){return PI.resolve(null).then(b).catch(Dne)}:AI;function Dne(b){setTimeout(function(){throw b})}function ad(b){return b==="head"}function NI(b,C){var E=C,O=0,N=0;do{var z=E.nextSibling;if(b.removeChild(E),z&&z.nodeType===8)if(E=z.data,E==="/$"){if(0<O&&8>O){E=O;var ce=b.ownerDocument;if(E&1&&D1(ce.documentElement),E&2&&D1(ce.body),E&4)for(E=ce.head,D1(E),ce=E.firstChild;ce;){var xe=ce.nextSibling,Ve=ce.nodeName;ce[Ii]||Ve==="SCRIPT"||Ve==="STYLE"||Ve==="LINK"&&ce.rel.toLowerCase()==="stylesheet"||E.removeChild(ce),ce=xe}}if(N===0){b.removeChild(z),L1(C);return}N--}else E==="$"||E==="$?"||E==="$!"?N++:O=E.charCodeAt(0)-48;else O=0;E=z}while(E);L1(C)}function cS(b){var C=b.firstChild;for(C&&C.nodeType===10&&(C=C.nextSibling);C;){var E=C;switch(C=C.nextSibling,E.nodeName){case"HTML":case"HEAD":case"BODY":cS(E),fi(E);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(E.rel.toLowerCase()==="stylesheet")continue}b.removeChild(E)}}function One(b,C,E,O){for(;b.nodeType===1;){var N=E;if(b.nodeName.toLowerCase()!==C.toLowerCase()){if(!O&&(b.nodeName!=="INPUT"||b.type!=="hidden"))break}else if(O){if(!b[Ii])switch(C){case"meta":if(!b.hasAttribute("itemprop"))break;return b;case"link":if(z=b.getAttribute("rel"),z==="stylesheet"&&b.hasAttribute("data-precedence"))break;if(z!==N.rel||b.getAttribute("href")!==(N.href==null||N.href===""?null:N.href)||b.getAttribute("crossorigin")!==(N.crossOrigin==null?null:N.crossOrigin)||b.getAttribute("title")!==(N.title==null?null:N.title))break;return b;case"style":if(b.hasAttribute("data-precedence"))break;return b;case"script":if(z=b.getAttribute("src"),(z!==(N.src==null?null:N.src)||b.getAttribute("type")!==(N.type==null?null:N.type)||b.getAttribute("crossorigin")!==(N.crossOrigin==null?null:N.crossOrigin))&&z&&b.hasAttribute("async")&&!b.hasAttribute("itemprop"))break;return b;default:return b}}else if(C==="input"&&b.type==="hidden"){var z=N.name==null?null:""+N.name;if(N.type==="hidden"&&b.getAttribute("name")===z)return b}else return b;if(b=Ql(b.nextSibling),b===null)break}return null}function Mne(b,C,E){if(C==="")return null;for(;b.nodeType!==3;)if((b.nodeType!==1||b.nodeName!=="INPUT"||b.type!=="hidden")&&!E||(b=Ql(b.nextSibling),b===null))return null;return b}function uS(b){return b.data==="$!"||b.data==="$?"&&b.ownerDocument.readyState==="complete"}function Ine(b,C){var E=b.ownerDocument;if(b.data!=="$?"||E.readyState==="complete")C();else{var O=function(){C(),E.removeEventListener("DOMContentLoaded",O)};E.addEventListener("DOMContentLoaded",O),b._reactRetry=O}}function Ql(b){for(;b!=null;b=b.nextSibling){var C=b.nodeType;if(C===1||C===3)break;if(C===8){if(C=b.data,C==="$"||C==="$!"||C==="$?"||C==="F!"||C==="F")break;if(C==="/$")return null}}return b}var fS=null;function LI(b){b=b.previousSibling;for(var C=0;b;){if(b.nodeType===8){var E=b.data;if(E==="$"||E==="$!"||E==="$?"){if(C===0)return b;C--}else E==="/$"&&C++}b=b.previousSibling}return null}function kI(b,C,E){switch(C=c5(E),b){case"html":if(b=C.documentElement,!b)throw Error(r(452));return b;case"head":if(b=C.head,!b)throw Error(r(453));return b;case"body":if(b=C.body,!b)throw Error(r(454));return b;default:throw Error(r(451))}}function D1(b){for(var C=b.attributes;C.length;)b.removeAttributeNode(C[0]);fi(b)}var bl=new Map,VI=new Set;function u5(b){return typeof b.getRootNode=="function"?b.getRootNode():b.nodeType===9?b:b.ownerDocument}var Ju=G.d;G.d={f:Rne,r:Ane,D:Pne,C:Nne,L:Lne,m:kne,X:Fne,S:Vne,M:Une};function Rne(){var b=Ju.f(),C=t5();return b||C}function Ane(b){var C=rn(b);C!==null&&C.tag===5&&C.type==="form"?rM(C):Ju.r(b)}var Bp=typeof document>"u"?null:document;function FI(b,C,E){var O=Bp;if(O&&typeof C=="string"&&C){var N=la(C);N='link[rel="'+b+'"][href="'+N+'"]',typeof E=="string"&&(N+='[crossorigin="'+E+'"]'),VI.has(N)||(VI.add(N),b={rel:b,crossOrigin:E,href:C},O.querySelector(N)===null&&(C=O.createElement("link"),to(C,"link",b),an(C),O.head.appendChild(C)))}}function Pne(b){Ju.D(b),FI("dns-prefetch",b,null)}function Nne(b,C){Ju.C(b,C),FI("preconnect",b,C)}function Lne(b,C,E){Ju.L(b,C,E);var O=Bp;if(O&&b&&C){var N='link[rel="preload"][as="'+la(C)+'"]';C==="image"&&E&&E.imageSrcSet?(N+='[imagesrcset="'+la(E.imageSrcSet)+'"]',typeof E.imageSizes=="string"&&(N+='[imagesizes="'+la(E.imageSizes)+'"]')):N+='[href="'+la(b)+'"]';var z=N;switch(C){case"style":z=$p(b);break;case"script":z=Gp(b)}bl.has(z)||(b=f({rel:"preload",href:C==="image"&&E&&E.imageSrcSet?void 0:b,as:C},E),bl.set(z,b),O.querySelector(N)!==null||C==="style"&&O.querySelector(O1(z))||C==="script"&&O.querySelector(M1(z))||(C=O.createElement("link"),to(C,"link",b),an(C),O.head.appendChild(C)))}}function kne(b,C){Ju.m(b,C);var E=Bp;if(E&&b){var O=C&&typeof C.as=="string"?C.as:"script",N='link[rel="modulepreload"][as="'+la(O)+'"][href="'+la(b)+'"]',z=N;switch(O){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":z=Gp(b)}if(!bl.has(z)&&(b=f({rel:"modulepreload",href:b},C),bl.set(z,b),E.querySelector(N)===null)){switch(O){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(E.querySelector(M1(z)))return}O=E.createElement("link"),to(O,"link",b),an(O),E.head.appendChild(O)}}}function Vne(b,C,E){Ju.S(b,C,E);var O=Bp;if(O&&b){var N=vi(O).hoistableStyles,z=$p(b);C=C||"default";var ce=N.get(z);if(!ce){var xe={loading:0,preload:null};if(ce=O.querySelector(O1(z)))xe.loading=5;else{b=f({rel:"stylesheet",href:b,"data-precedence":C},E),(E=bl.get(z))&&dS(b,E);var Ve=ce=O.createElement("link");an(Ve),to(Ve,"link",b),Ve._p=new Promise(function(nt,wt){Ve.onload=nt,Ve.onerror=wt}),Ve.addEventListener("load",function(){xe.loading|=1}),Ve.addEventListener("error",function(){xe.loading|=2}),xe.loading|=4,f5(ce,C,O)}ce={type:"stylesheet",instance:ce,count:1,state:xe},N.set(z,ce)}}}function Fne(b,C){Ju.X(b,C);var E=Bp;if(E&&b){var O=vi(E).hoistableScripts,N=Gp(b),z=O.get(N);z||(z=E.querySelector(M1(N)),z||(b=f({src:b,async:!0},C),(C=bl.get(N))&&hS(b,C),z=E.createElement("script"),an(z),to(z,"link",b),E.head.appendChild(z)),z={type:"script",instance:z,count:1,state:null},O.set(N,z))}}function Une(b,C){Ju.M(b,C);var E=Bp;if(E&&b){var O=vi(E).hoistableScripts,N=Gp(b),z=O.get(N);z||(z=E.querySelector(M1(N)),z||(b=f({src:b,async:!0,type:"module"},C),(C=bl.get(N))&&hS(b,C),z=E.createElement("script"),an(z),to(z,"link",b),E.head.appendChild(z)),z={type:"script",instance:z,count:1,state:null},O.set(N,z))}}function UI(b,C,E,O){var N=(N=Ce.current)?u5(N):null;if(!N)throw Error(r(446));switch(b){case"meta":case"title":return null;case"style":return typeof E.precedence=="string"&&typeof E.href=="string"?(C=$p(E.href),E=vi(N).hoistableStyles,O=E.get(C),O||(O={type:"style",instance:null,count:0,state:null},E.set(C,O)),O):{type:"void",instance:null,count:0,state:null};case"link":if(E.rel==="stylesheet"&&typeof E.href=="string"&&typeof E.precedence=="string"){b=$p(E.href);var z=vi(N).hoistableStyles,ce=z.get(b);if(ce||(N=N.ownerDocument||N,ce={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},z.set(b,ce),(z=N.querySelector(O1(b)))&&!z._p&&(ce.instance=z,ce.state.loading=5),bl.has(b)||(E={rel:"preload",as:"style",href:E.href,crossOrigin:E.crossOrigin,integrity:E.integrity,media:E.media,hrefLang:E.hrefLang,referrerPolicy:E.referrerPolicy},bl.set(b,E),z||Bne(N,b,E,ce.state))),C&&O===null)throw Error(r(528,""));return ce}if(C&&O!==null)throw Error(r(529,""));return null;case"script":return C=E.async,E=E.src,typeof E=="string"&&C&&typeof C!="function"&&typeof C!="symbol"?(C=Gp(E),E=vi(N).hoistableScripts,O=E.get(C),O||(O={type:"script",instance:null,count:0,state:null},E.set(C,O)),O):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,b))}}function $p(b){return'href="'+la(b)+'"'}function O1(b){return'link[rel="stylesheet"]['+b+"]"}function BI(b){return f({},b,{"data-precedence":b.precedence,precedence:null})}function Bne(b,C,E,O){b.querySelector('link[rel="preload"][as="style"]['+C+"]")?O.loading=1:(C=b.createElement("link"),O.preload=C,C.addEventListener("load",function(){return O.loading|=1}),C.addEventListener("error",function(){return O.loading|=2}),to(C,"link",E),an(C),b.head.appendChild(C))}function Gp(b){return'[src="'+la(b)+'"]'}function M1(b){return"script[async]"+b}function $I(b,C,E){if(C.count++,C.instance===null)switch(C.type){case"style":var O=b.querySelector('style[data-href~="'+la(E.href)+'"]');if(O)return C.instance=O,an(O),O;var N=f({},E,{"data-href":E.href,"data-precedence":E.precedence,href:null,precedence:null});return O=(b.ownerDocument||b).createElement("style"),an(O),to(O,"style",N),f5(O,E.precedence,b),C.instance=O;case"stylesheet":N=$p(E.href);var z=b.querySelector(O1(N));if(z)return C.state.loading|=4,C.instance=z,an(z),z;O=BI(E),(N=bl.get(N))&&dS(O,N),z=(b.ownerDocument||b).createElement("link"),an(z);var ce=z;return ce._p=new Promise(function(xe,Ve){ce.onload=xe,ce.onerror=Ve}),to(z,"link",O),C.state.loading|=4,f5(z,E.precedence,b),C.instance=z;case"script":return z=Gp(E.src),(N=b.querySelector(M1(z)))?(C.instance=N,an(N),N):(O=E,(N=bl.get(z))&&(O=f({},E),hS(O,N)),b=b.ownerDocument||b,N=b.createElement("script"),an(N),to(N,"link",O),b.head.appendChild(N),C.instance=N);case"void":return null;default:throw Error(r(443,C.type))}else C.type==="stylesheet"&&(C.state.loading&4)===0&&(O=C.instance,C.state.loading|=4,f5(O,E.precedence,b));return C.instance}function f5(b,C,E){for(var O=E.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),N=O.length?O[O.length-1]:null,z=N,ce=0;ce<O.length;ce++){var xe=O[ce];if(xe.dataset.precedence===C)z=xe;else if(z!==N)break}z?z.parentNode.insertBefore(b,z.nextSibling):(C=E.nodeType===9?E.head:E,C.insertBefore(b,C.firstChild))}function dS(b,C){b.crossOrigin==null&&(b.crossOrigin=C.crossOrigin),b.referrerPolicy==null&&(b.referrerPolicy=C.referrerPolicy),b.title==null&&(b.title=C.title)}function hS(b,C){b.crossOrigin==null&&(b.crossOrigin=C.crossOrigin),b.referrerPolicy==null&&(b.referrerPolicy=C.referrerPolicy),b.integrity==null&&(b.integrity=C.integrity)}var d5=null;function GI(b,C,E){if(d5===null){var O=new Map,N=d5=new Map;N.set(E,O)}else N=d5,O=N.get(E),O||(O=new Map,N.set(E,O));if(O.has(b))return O;for(O.set(b,null),E=E.getElementsByTagName(b),N=0;N<E.length;N++){var z=E[N];if(!(z[Ii]||z[$t]||b==="link"&&z.getAttribute("rel")==="stylesheet")&&z.namespaceURI!=="http://www.w3.org/2000/svg"){var ce=z.getAttribute(C)||"";ce=b+ce;var xe=O.get(ce);xe?xe.push(z):O.set(ce,[z])}}return O}function jI(b,C,E){b=b.ownerDocument||b,b.head.insertBefore(E,C==="title"?b.querySelector("head > title"):null)}function $ne(b,C,E){if(E===1||C.itemProp!=null)return!1;switch(b){case"meta":case"title":return!0;case"style":if(typeof C.precedence!="string"||typeof C.href!="string"||C.href==="")break;return!0;case"link":if(typeof C.rel!="string"||typeof C.href!="string"||C.href===""||C.onLoad||C.onError)break;switch(C.rel){case"stylesheet":return b=C.disabled,typeof C.precedence=="string"&&b==null;default:return!0}case"script":if(C.async&&typeof C.async!="function"&&typeof C.async!="symbol"&&!C.onLoad&&!C.onError&&C.src&&typeof C.src=="string")return!0}return!1}function zI(b){return!(b.type==="stylesheet"&&(b.state.loading&3)===0)}var I1=null;function Gne(){}function jne(b,C,E){if(I1===null)throw Error(r(475));var O=I1;if(C.type==="stylesheet"&&(typeof E.media!="string"||matchMedia(E.media).matches!==!1)&&(C.state.loading&4)===0){if(C.instance===null){var N=$p(E.href),z=b.querySelector(O1(N));if(z){b=z._p,b!==null&&typeof b=="object"&&typeof b.then=="function"&&(O.count++,O=h5.bind(O),b.then(O,O)),C.state.loading|=4,C.instance=z,an(z);return}z=b.ownerDocument||b,E=BI(E),(N=bl.get(N))&&dS(E,N),z=z.createElement("link"),an(z);var ce=z;ce._p=new Promise(function(xe,Ve){ce.onload=xe,ce.onerror=Ve}),to(z,"link",E),C.instance=z}O.stylesheets===null&&(O.stylesheets=new Map),O.stylesheets.set(C,b),(b=C.state.preload)&&(C.state.loading&3)===0&&(O.count++,C=h5.bind(O),b.addEventListener("load",C),b.addEventListener("error",C))}}function zne(){if(I1===null)throw Error(r(475));var b=I1;return b.stylesheets&&b.count===0&&pS(b,b.stylesheets),0<b.count?function(C){var E=setTimeout(function(){if(b.stylesheets&&pS(b,b.stylesheets),b.unsuspend){var O=b.unsuspend;b.unsuspend=null,O()}},6e4);return b.unsuspend=C,function(){b.unsuspend=null,clearTimeout(E)}}:null}function h5(){if(this.count--,this.count===0){if(this.stylesheets)pS(this,this.stylesheets);else if(this.unsuspend){var b=this.unsuspend;this.unsuspend=null,b()}}}var p5=null;function pS(b,C){b.stylesheets=null,b.unsuspend!==null&&(b.count++,p5=new Map,C.forEach(Wne,b),p5=null,h5.call(b))}function Wne(b,C){if(!(C.state.loading&4)){var E=p5.get(b);if(E)var O=E.get(null);else{E=new Map,p5.set(b,E);for(var N=b.querySelectorAll("link[data-precedence],style[data-precedence]"),z=0;z<N.length;z++){var ce=N[z];(ce.nodeName==="LINK"||ce.getAttribute("media")!=="not all")&&(E.set(ce.dataset.precedence,ce),O=ce)}O&&E.set(null,O)}N=C.instance,ce=N.getAttribute("data-precedence"),z=E.get(ce)||O,z===O&&E.set(null,N),E.set(ce,N),this.count++,O=h5.bind(this),N.addEventListener("load",O),N.addEventListener("error",O),z?z.parentNode.insertBefore(N,z.nextSibling):(b=b.nodeType===9?b.head:b,b.insertBefore(N,b.firstChild)),C.state.loading|=4}}var R1={$$typeof:x,Provider:null,Consumer:null,_currentValue:F,_currentValue2:F,_threadCount:0};function Hne(b,C,E,O,N,z,ce,xe){this.tag=1,this.containerInfo=b,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=tn(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=tn(0),this.hiddenUpdates=tn(null),this.identifierPrefix=O,this.onUncaughtError=N,this.onCaughtError=z,this.onRecoverableError=ce,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=xe,this.incompleteTransitions=new Map}function WI(b,C,E,O,N,z,ce,xe,Ve,nt,wt,Ot){return b=new Hne(b,C,E,ce,xe,Ve,nt,Ot),C=1,z===!0&&(C|=24),z=Ns(3,null,null,C),b.current=z,z.stateNode=b,C=XC(),C.refCount++,b.pooledCache=C,C.refCount++,z.memoizedState={element:O,isDehydrated:E,cache:C},QC(z),b}function HI(b){return b?(b=xp,b):xp}function KI(b,C,E,O,N,z){N=HI(N),O.context===null?O.context=N:O.pendingContext=N,O=Hf(C),O.payload={element:E},z=z===void 0?null:z,z!==null&&(O.callback=z),E=Kf(b,O,C),E!==null&&(Us(E,b,C),s1(E,b,C))}function qI(b,C){if(b=b.memoizedState,b!==null&&b.dehydrated!==null){var E=b.retryLane;b.retryLane=E!==0&&E<C?E:C}}function gS(b,C){qI(b,C),(b=b.alternate)&&qI(b,C)}function XI(b){if(b.tag===13){var C=yp(b,67108864);C!==null&&Us(C,b,67108864),gS(b,67108864)}}var g5=!0;function Kne(b,C,E,O){var N=U.T;U.T=null;var z=G.p;try{G.p=2,mS(b,C,E,O)}finally{G.p=z,U.T=N}}function qne(b,C,E,O){var N=U.T;U.T=null;var z=G.p;try{G.p=8,mS(b,C,E,O)}finally{G.p=z,U.T=N}}function mS(b,C,E,O){if(g5){var N=vS(O);if(N===null)rS(b,C,O,m5,E),JI(b,O);else if(Yne(N,b,C,E,O))O.stopPropagation();else if(JI(b,O),C&4&&-1<Xne.indexOf(b)){for(;N!==null;){var z=rn(N);if(z!==null)switch(z.tag){case 3:if(z=z.stateNode,z.current.memoizedState.isDehydrated){var ce=_t(z.pendingLanes);if(ce!==0){var xe=z;for(xe.pendingLanes|=2,xe.entangledLanes|=2;ce;){var Ve=1<<31-$e(ce);xe.entanglements[1]|=Ve,ce&=~Ve}Fc(z),(Pr&6)===0&&(Qy=Se()+500,T1(0))}}break;case 13:xe=yp(z,2),xe!==null&&Us(xe,z,2),t5(),gS(z,2)}if(z=vS(O),z===null&&rS(b,C,O,m5,E),z===N)break;N=z}N!==null&&O.stopPropagation()}else rS(b,C,O,null,E)}}function vS(b){return b=qi(b),yS(b)}var m5=null;function yS(b){if(m5=null,b=Ri(b),b!==null){var C=a(b);if(C===null)b=null;else{var E=C.tag;if(E===13){if(b=o(C),b!==null)return b;b=null}else if(E===3){if(C.stateNode.current.memoizedState.isDehydrated)return C.tag===3?C.stateNode.containerInfo:null;b=null}else C!==b&&(b=null)}}return m5=b,null}function YI(b){switch(b){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Fe()){case Ke:return 2;case He:return 8;case pe:case ge:return 32;case Ie:return 268435456;default:return 32}default:return 32}}var xS=!1,od=null,sd=null,ld=null,A1=new Map,P1=new Map,cd=[],Xne="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function JI(b,C){switch(b){case"focusin":case"focusout":od=null;break;case"dragenter":case"dragleave":sd=null;break;case"mouseover":case"mouseout":ld=null;break;case"pointerover":case"pointerout":A1.delete(C.pointerId);break;case"gotpointercapture":case"lostpointercapture":P1.delete(C.pointerId)}}function N1(b,C,E,O,N,z){return b===null||b.nativeEvent!==z?(b={blockedOn:C,domEventName:E,eventSystemFlags:O,nativeEvent:z,targetContainers:[N]},C!==null&&(C=rn(C),C!==null&&XI(C)),b):(b.eventSystemFlags|=O,C=b.targetContainers,N!==null&&C.indexOf(N)===-1&&C.push(N),b)}function Yne(b,C,E,O,N){switch(C){case"focusin":return od=N1(od,b,C,E,O,N),!0;case"dragenter":return sd=N1(sd,b,C,E,O,N),!0;case"mouseover":return ld=N1(ld,b,C,E,O,N),!0;case"pointerover":var z=N.pointerId;return A1.set(z,N1(A1.get(z)||null,b,C,E,O,N)),!0;case"gotpointercapture":return z=N.pointerId,P1.set(z,N1(P1.get(z)||null,b,C,E,O,N)),!0}return!1}function ZI(b){var C=Ri(b.target);if(C!==null){var E=a(C);if(E!==null){if(C=E.tag,C===13){if(C=o(E),C!==null){b.blockedOn=C,Bt(b.priority,function(){if(E.tag===13){var O=Fs();O=qe(O);var N=yp(E,O);N!==null&&Us(N,E,O),gS(E,O)}});return}}else if(C===3&&E.stateNode.current.memoizedState.isDehydrated){b.blockedOn=E.tag===3?E.stateNode.containerInfo:null;return}}}b.blockedOn=null}function v5(b){if(b.blockedOn!==null)return!1;for(var C=b.targetContainers;0<C.length;){var E=vS(b.nativeEvent);if(E===null){E=b.nativeEvent;var O=new E.constructor(E.type,E);mo=O,E.target.dispatchEvent(O),mo=null}else return C=rn(E),C!==null&&XI(C),b.blockedOn=E,!1;C.shift()}return!0}function QI(b,C,E){v5(b)&&E.delete(C)}function Jne(){xS=!1,od!==null&&v5(od)&&(od=null),sd!==null&&v5(sd)&&(sd=null),ld!==null&&v5(ld)&&(ld=null),A1.forEach(QI),P1.forEach(QI)}function y5(b,C){b.blockedOn===C&&(b.blockedOn=null,xS||(xS=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,Jne)))}var x5=null;function eR(b){x5!==b&&(x5=b,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){x5===b&&(x5=null);for(var C=0;C<b.length;C+=3){var E=b[C],O=b[C+1],N=b[C+2];if(typeof O!="function"){if(yS(O||E)===null)continue;break}var z=rn(E);z!==null&&(b.splice(C,3),C-=3,y4(z,{pending:!0,data:N,method:E.method,action:O},O,N))}}))}function L1(b){function C(Ve){return y5(Ve,b)}od!==null&&y5(od,b),sd!==null&&y5(sd,b),ld!==null&&y5(ld,b),A1.forEach(C),P1.forEach(C);for(var E=0;E<cd.length;E++){var O=cd[E];O.blockedOn===b&&(O.blockedOn=null)}for(;0<cd.length&&(E=cd[0],E.blockedOn===null);)ZI(E),E.blockedOn===null&&cd.shift();if(E=(b.ownerDocument||b).$$reactFormReplay,E!=null)for(O=0;O<E.length;O+=3){var N=E[O],z=E[O+1],ce=N[Xt]||null;if(typeof z=="function")ce||eR(E);else if(ce){var xe=null;if(z&&z.hasAttribute("formAction")){if(N=z,ce=z[Xt]||null)xe=ce.formAction;else if(yS(N)!==null)continue}else xe=ce.action;typeof xe=="function"?E[O+1]=xe:(E.splice(O,3),O-=3),eR(E)}}}function bS(b){this._internalRoot=b}b5.prototype.render=bS.prototype.render=function(b){var C=this._internalRoot;if(C===null)throw Error(r(409));var E=C.current,O=Fs();KI(E,O,b,C,null,null)},b5.prototype.unmount=bS.prototype.unmount=function(){var b=this._internalRoot;if(b!==null){this._internalRoot=null;var C=b.containerInfo;KI(b.current,2,null,b,null,null),t5(),C[Lt]=null}};function b5(b){this._internalRoot=b}b5.prototype.unstable_scheduleHydration=function(b){if(b){var C=Rt();b={blockedOn:null,target:b,priority:C};for(var E=0;E<cd.length&&C!==0&&C<cd[E].priority;E++);cd.splice(E,0,b),E===0&&ZI(b)}};var tR=e.version;if(tR!=="19.1.1")throw Error(r(527,tR,"19.1.1"));G.findDOMNode=function(b){var C=b._reactInternals;if(C===void 0)throw typeof b.render=="function"?Error(r(188)):(b=Object.keys(b).join(","),Error(r(268,b)));return b=l(C),b=b!==null?c(b):null,b=b===null?null:b.stateNode,b};var Zne={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:U,reconcilerVersion:"19.1.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var w5=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!w5.isDisabled&&w5.supportsFiber)try{Pe=w5.inject(Zne),ne=w5}catch{}}return V1.createRoot=function(b,C){if(!i(b))throw Error(r(299));var E=!1,O="",N=vM,z=yM,ce=xM,xe=null;return C!=null&&(C.unstable_strictMode===!0&&(E=!0),C.identifierPrefix!==void 0&&(O=C.identifierPrefix),C.onUncaughtError!==void 0&&(N=C.onUncaughtError),C.onCaughtError!==void 0&&(z=C.onCaughtError),C.onRecoverableError!==void 0&&(ce=C.onRecoverableError),C.unstable_transitionCallbacks!==void 0&&(xe=C.unstable_transitionCallbacks)),C=WI(b,1,!1,null,null,E,O,N,z,ce,xe,null),b[Lt]=C.current,nS(b),new bS(C)},V1.hydrateRoot=function(b,C,E){if(!i(b))throw Error(r(299));var O=!1,N="",z=vM,ce=yM,xe=xM,Ve=null,nt=null;return E!=null&&(E.unstable_strictMode===!0&&(O=!0),E.identifierPrefix!==void 0&&(N=E.identifierPrefix),E.onUncaughtError!==void 0&&(z=E.onUncaughtError),E.onCaughtError!==void 0&&(ce=E.onCaughtError),E.onRecoverableError!==void 0&&(xe=E.onRecoverableError),E.unstable_transitionCallbacks!==void 0&&(Ve=E.unstable_transitionCallbacks),E.formState!==void 0&&(nt=E.formState)),C=WI(b,1,!0,C,E??null,O,N,z,ce,xe,Ve,nt),C.context=HI(null),E=C.current,O=Fs(),O=qe(O),N=Hf(O),N.callback=null,Kf(E,N,O),E=O,C.current.lanes=E,Ht(C,E),Fc(C),b[Lt]=C.current,nS(b),new b5(C)},V1.version="19.1.1",V1}var fR;function lre(){if(fR)return SS.exports;fR=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),SS.exports=sre(),SS.exports}var cre=lre();/**
 * react-router v7.8.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var dR="popstate";function ure(t={}){function e(r,i){let{pathname:a,search:o,hash:s}=r.location;return Z8("",{pathname:a,search:o,hash:s},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(r,i){return typeof i=="string"?i:Zv(i)}return dre(e,n,null,t)}function Na(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function du(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function fre(){return Math.random().toString(36).substring(2,10)}function hR(t,e){return{usr:t.state,key:t.key,idx:e}}function Z8(t,e,n=null,r){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?F2(e):e,state:n,key:e&&e.key||r||fre()}}function Zv({pathname:t="/",search:e="",hash:n=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function F2(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substring(n),t=t.substring(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substring(r),t=t.substring(0,r)),t&&(e.pathname=t)}return e}function dre(t,e,n,r={}){let{window:i=document.defaultView,v5Compat:a=!1}=r,o=i.history,s="POP",l=null,c=f();c==null&&(c=0,o.replaceState({...o.state,idx:c},""));function f(){return(o.state||{idx:null}).idx}function u(){s="POP";let m=f(),y=m==null?null:m-c;c=m,l&&l({action:s,location:g.location,delta:y})}function d(m,y){s="PUSH";let v=Z8(g.location,m,y);c=f()+1;let x=hR(v,c),w=g.createHref(v);try{o.pushState(x,"",w)}catch(S){if(S instanceof DOMException&&S.name==="DataCloneError")throw S;i.location.assign(w)}a&&l&&l({action:s,location:g.location,delta:1})}function h(m,y){s="REPLACE";let v=Z8(g.location,m,y);c=f();let x=hR(v,c),w=g.createHref(v);o.replaceState(x,"",w),a&&l&&l({action:s,location:g.location,delta:0})}function p(m){return hre(m)}let g={get action(){return s},get location(){return t(i,o)},listen(m){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(dR,u),l=m,()=>{i.removeEventListener(dR,u),l=null}},createHref(m){return e(i,m)},createURL:p,encodeLocation(m){let y=p(m);return{pathname:y.pathname,search:y.search,hash:y.hash}},push:d,replace:h,go(m){return o.go(m)}};return g}function hre(t,e=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),Na(n,"No window.location.(origin|href) available to create URL");let r=typeof t=="string"?t:Zv(t);return r=r.replace(/ $/,"%20"),!e&&r.startsWith("//")&&(r=n+r),new URL(r,n)}function iU(t,e,n="/"){return pre(t,e,n,!1)}function pre(t,e,n,r){let i=typeof e=="string"?F2(e):e,a=If(i.pathname||"/",n);if(a==null)return null;let o=aU(t);gre(o);let s=null;for(let l=0;s==null&&l<o.length;++l){let c=_re(a);s=Tre(o[l],c,r)}return s}function aU(t,e=[],n=[],r="",i=!1){let a=(o,s,l=i,c)=>{let f={relativePath:c===void 0?o.path||"":c,caseSensitive:o.caseSensitive===!0,childrenIndex:s,route:o};if(f.relativePath.startsWith("/")){if(!f.relativePath.startsWith(r)&&l)return;Na(f.relativePath.startsWith(r),`Absolute route path "${f.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),f.relativePath=f.relativePath.slice(r.length)}let u=Sf([r,f.relativePath]),d=n.concat(f);o.children&&o.children.length>0&&(Na(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${u}".`),aU(o.children,e,d,u,l)),!(o.path==null&&!o.index)&&e.push({path:u,score:Cre(u,o.index),routesMeta:d})};return t.forEach((o,s)=>{if(o.path===""||!o.path?.includes("?"))a(o,s);else for(let l of oU(o.path))a(o,s,!0,l)}),e}function oU(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,i=n.endsWith("?"),a=n.replace(/\?$/,"");if(r.length===0)return i?[a,""]:[a];let o=oU(r.join("/")),s=[];return s.push(...o.map(l=>l===""?a:[a,l].join("/"))),i&&s.push(...o),s.map(l=>t.startsWith("/")&&l===""?"/":l)}function gre(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:Sre(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}var mre=/^:[\w-]+$/,vre=3,yre=2,xre=1,bre=10,wre=-2,pR=t=>t==="*";function Cre(t,e){let n=t.split("/"),r=n.length;return n.some(pR)&&(r+=wre),e&&(r+=yre),n.filter(i=>!pR(i)).reduce((i,a)=>i+(mre.test(a)?vre:a===""?xre:bre),r)}function Sre(t,e){return t.length===e.length&&t.slice(0,-1).every((r,i)=>r===e[i])?t[t.length-1]-e[e.length-1]:0}function Tre(t,e,n=!1){let{routesMeta:r}=t,i={},a="/",o=[];for(let s=0;s<r.length;++s){let l=r[s],c=s===r.length-1,f=a==="/"?e:e.slice(a.length)||"/",u=Nb({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},f),d=l.route;if(!u&&c&&n&&!r[r.length-1].route.index&&(u=Nb({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},f)),!u)return null;Object.assign(i,u.params),o.push({params:i,pathname:Sf([a,u.pathname]),pathnameBase:Ire(Sf([a,u.pathnameBase])),route:d}),u.pathnameBase!=="/"&&(a=Sf([a,u.pathnameBase]))}return o}function Nb(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=Ere(t.path,t.caseSensitive,t.end),i=e.match(n);if(!i)return null;let a=i[0],o=a.replace(/(.)\/+$/,"$1"),s=i.slice(1);return{params:r.reduce((c,{paramName:f,isOptional:u},d)=>{if(f==="*"){let p=s[d]||"";o=a.slice(0,a.length-p.length).replace(/(.)\/+$/,"$1")}const h=s[d];return u&&!h?c[f]=void 0:c[f]=(h||"").replace(/%2F/g,"/"),c},{}),pathname:a,pathnameBase:o,pattern:t}}function Ere(t,e=!1,n=!0){du(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let r=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,s,l)=>(r.push({paramName:s,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(r.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function _re(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return du(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function If(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function Dre(t,e="/"){let{pathname:n,search:r="",hash:i=""}=typeof t=="string"?F2(t):t;return{pathname:n?n.startsWith("/")?n:Ore(n,e):e,search:Rre(r),hash:Are(i)}}function Ore(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function DS(t,e,n,r){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function Mre(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function sU(t){let e=Mre(t);return e.map((n,r)=>r===e.length-1?n.pathname:n.pathnameBase)}function lU(t,e,n,r=!1){let i;typeof t=="string"?i=F2(t):(i={...t},Na(!i.pathname||!i.pathname.includes("?"),DS("?","pathname","search",i)),Na(!i.pathname||!i.pathname.includes("#"),DS("#","pathname","hash",i)),Na(!i.search||!i.search.includes("#"),DS("#","search","hash",i)));let a=t===""||i.pathname==="",o=a?"/":i.pathname,s;if(o==null)s=n;else{let u=e.length-1;if(!r&&o.startsWith("..")){let d=o.split("/");for(;d[0]==="..";)d.shift(),u-=1;i.pathname=d.join("/")}s=u>=0?e[u]:"/"}let l=Dre(i,s),c=o&&o!=="/"&&o.endsWith("/"),f=(a||o===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(c||f)&&(l.pathname+="/"),l}var Sf=t=>t.join("/").replace(/\/\/+/g,"/"),Ire=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),Rre=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,Are=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function Pre(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}var cU=["POST","PUT","PATCH","DELETE"];new Set(cU);var Nre=["GET",...cU];new Set(Nre);var wm=H.createContext(null);wm.displayName="DataRouter";var ow=H.createContext(null);ow.displayName="DataRouterState";H.createContext(!1);var uU=H.createContext({isTransitioning:!1});uU.displayName="ViewTransition";var Lre=H.createContext(new Map);Lre.displayName="Fetchers";var kre=H.createContext(null);kre.displayName="Await";var wu=H.createContext(null);wu.displayName="Navigation";var sw=H.createContext(null);sw.displayName="Location";var Cu=H.createContext({outlet:null,matches:[],isDataRoute:!1});Cu.displayName="Route";var u_=H.createContext(null);u_.displayName="RouteError";function Vre(t,{relative:e}={}){Na(U2(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=H.useContext(wu),{hash:i,pathname:a,search:o}=B2(t,{relative:e}),s=a;return n!=="/"&&(s=a==="/"?n:Sf([n,a])),r.createHref({pathname:s,search:o,hash:i})}function U2(){return H.useContext(sw)!=null}function Su(){return Na(U2(),"useLocation() may be used only in the context of a <Router> component."),H.useContext(sw).location}var fU="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function dU(t){H.useContext(wu).static||H.useLayoutEffect(t)}function bc(){let{isDataRoute:t}=H.useContext(Cu);return t?Yre():Fre()}function Fre(){Na(U2(),"useNavigate() may be used only in the context of a <Router> component.");let t=H.useContext(wm),{basename:e,navigator:n}=H.useContext(wu),{matches:r}=H.useContext(Cu),{pathname:i}=Su(),a=JSON.stringify(sU(r)),o=H.useRef(!1);return dU(()=>{o.current=!0}),H.useCallback((l,c={})=>{if(du(o.current,fU),!o.current)return;if(typeof l=="number"){n.go(l);return}let f=lU(l,JSON.parse(a),i,c.relative==="path");t==null&&e!=="/"&&(f.pathname=f.pathname==="/"?e:Sf([e,f.pathname])),(c.replace?n.replace:n.push)(f,c.state,c)},[e,n,a,i,t])}H.createContext(null);function hU(){let{matches:t}=H.useContext(Cu),e=t[t.length-1];return e?e.params:{}}function B2(t,{relative:e}={}){let{matches:n}=H.useContext(Cu),{pathname:r}=Su(),i=JSON.stringify(sU(n));return H.useMemo(()=>lU(t,JSON.parse(i),r,e==="path"),[t,i,r,e])}function Ure(t,e){return pU(t)}function pU(t,e,n,r,i){Na(U2(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=H.useContext(wu),{matches:o}=H.useContext(Cu),s=o[o.length-1],l=s?s.params:{},c=s?s.pathname:"/",f=s?s.pathnameBase:"/",u=s&&s.route;{let v=u&&u.path||"";gU(c,!u||v.endsWith("*")||v.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${c}" (under <Route path="${v}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${v}"> to <Route path="${v==="/"?"*":`${v}/*`}">.`)}let d=Su(),h;h=d;let p=h.pathname||"/",g=p;if(f!=="/"){let v=f.replace(/^\//,"").split("/");g="/"+p.replace(/^\//,"").split("/").slice(v.length).join("/")}let m=iU(t,{pathname:g});return du(u||m!=null,`No routes matched location "${h.pathname}${h.search}${h.hash}" `),du(m==null||m[m.length-1].route.element!==void 0||m[m.length-1].route.Component!==void 0||m[m.length-1].route.lazy!==void 0,`Matched leaf route at location "${h.pathname}${h.search}${h.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`),zre(m&&m.map(v=>Object.assign({},v,{params:Object.assign({},l,v.params),pathname:Sf([f,a.encodeLocation?a.encodeLocation(v.pathname).pathname:v.pathname]),pathnameBase:v.pathnameBase==="/"?f:Sf([f,a.encodeLocation?a.encodeLocation(v.pathnameBase).pathname:v.pathnameBase])})),o,n,r,i)}function Bre(){let t=Xre(),e=Pre(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:r},a={padding:"2px 4px",backgroundColor:r},o=null;return console.error("Error handled by React Router default ErrorBoundary:",t),o=H.createElement(H.Fragment,null,H.createElement("p",null,"💿 Hey developer 👋"),H.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",H.createElement("code",{style:a},"ErrorBoundary")," or"," ",H.createElement("code",{style:a},"errorElement")," prop on your route.")),H.createElement(H.Fragment,null,H.createElement("h2",null,"Unexpected Application Error!"),H.createElement("h3",{style:{fontStyle:"italic"}},e),n?H.createElement("pre",{style:i},n):null,o)}var $re=H.createElement(Bre,null),Gre=class extends H.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){this.props.unstable_onError?this.props.unstable_onError(t,e):console.error("React Router caught the following error during render",t)}render(){return this.state.error!==void 0?H.createElement(Cu.Provider,{value:this.props.routeContext},H.createElement(u_.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function jre({routeContext:t,match:e,children:n}){let r=H.useContext(wm);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),H.createElement(Cu.Provider,{value:t},n)}function zre(t,e=[],n=null,r=null,i=null){if(t==null){if(!n)return null;if(n.errors)t=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let a=t,o=n?.errors;if(o!=null){let c=a.findIndex(f=>f.route.id&&o?.[f.route.id]!==void 0);Na(c>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),a=a.slice(0,Math.min(a.length,c+1))}let s=!1,l=-1;if(n)for(let c=0;c<a.length;c++){let f=a[c];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(l=c),f.route.id){let{loaderData:u,errors:d}=n,h=f.route.loader&&!u.hasOwnProperty(f.route.id)&&(!d||d[f.route.id]===void 0);if(f.route.lazy||h){s=!0,l>=0?a=a.slice(0,l+1):a=[a[0]];break}}}return a.reduceRight((c,f,u)=>{let d,h=!1,p=null,g=null;n&&(d=o&&f.route.id?o[f.route.id]:void 0,p=f.route.errorElement||$re,s&&(l<0&&u===0?(gU("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),h=!0,g=null):l===u&&(h=!0,g=f.route.hydrateFallbackElement||null)));let m=e.concat(a.slice(0,u+1)),y=()=>{let v;return d?v=p:h?v=g:f.route.Component?v=H.createElement(f.route.Component,null):f.route.element?v=f.route.element:v=c,H.createElement(jre,{match:f,routeContext:{outlet:c,matches:m,isDataRoute:n!=null},children:v})};return n&&(f.route.ErrorBoundary||f.route.errorElement||u===0)?H.createElement(Gre,{location:n.location,revalidation:n.revalidation,component:p,error:d,children:y(),routeContext:{outlet:null,matches:m,isDataRoute:!0},unstable_onError:r}):y()},null)}function f_(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Wre(t){let e=H.useContext(wm);return Na(e,f_(t)),e}function Hre(t){let e=H.useContext(ow);return Na(e,f_(t)),e}function Kre(t){let e=H.useContext(Cu);return Na(e,f_(t)),e}function d_(t){let e=Kre(t),n=e.matches[e.matches.length-1];return Na(n.route.id,`${t} can only be used on routes that contain a unique "id"`),n.route.id}function qre(){return d_("useRouteId")}function Xre(){let t=H.useContext(u_),e=Hre("useRouteError"),n=d_("useRouteError");return t!==void 0?t:e.errors?.[n]}function Yre(){let{router:t}=Wre("useNavigate"),e=d_("useNavigate"),n=H.useRef(!1);return dU(()=>{n.current=!0}),H.useCallback(async(i,a={})=>{du(n.current,fU),n.current&&(typeof i=="number"?t.navigate(i):await t.navigate(i,{fromRouteId:e,...a}))},[t,e])}var gR={};function gU(t,e,n){!e&&!gR[t]&&(gR[t]=!0,du(!1,n))}H.memo(Jre);function Jre({routes:t,future:e,state:n,unstable_onError:r}){return pU(t,void 0,n,r,e)}function Zre({basename:t="/",children:e=null,location:n,navigationType:r="POP",navigator:i,static:a=!1}){Na(!U2(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=t.replace(/^\/*/,"/"),s=H.useMemo(()=>({basename:o,navigator:i,static:a,future:{}}),[o,i,a]);typeof n=="string"&&(n=F2(n));let{pathname:l="/",search:c="",hash:f="",state:u=null,key:d="default"}=n,h=H.useMemo(()=>{let p=If(l,o);return p==null?null:{location:{pathname:p,search:c,hash:f,state:u,key:d},navigationType:r}},[o,l,c,f,u,d,r]);return du(h!=null,`<Router basename="${o}"> is not able to match the URL "${l}${c}${f}" because it does not start with the basename, so the <Router> won't render anything.`),h==null?null:H.createElement(wu.Provider,{value:s},H.createElement(sw.Provider,{children:e,value:h}))}var Ux="get",Bx="application/x-www-form-urlencoded";function lw(t){return t!=null&&typeof t.tagName=="string"}function Qre(t){return lw(t)&&t.tagName.toLowerCase()==="button"}function eie(t){return lw(t)&&t.tagName.toLowerCase()==="form"}function tie(t){return lw(t)&&t.tagName.toLowerCase()==="input"}function nie(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function rie(t,e){return t.button===0&&(!e||e==="_self")&&!nie(t)}var C5=null;function iie(){if(C5===null)try{new FormData(document.createElement("form"),0),C5=!1}catch{C5=!0}return C5}var aie=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function OS(t){return t!=null&&!aie.has(t)?(du(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Bx}"`),null):t}function oie(t,e){let n,r,i,a,o;if(eie(t)){let s=t.getAttribute("action");r=s?If(s,e):null,n=t.getAttribute("method")||Ux,i=OS(t.getAttribute("enctype"))||Bx,a=new FormData(t)}else if(Qre(t)||tie(t)&&(t.type==="submit"||t.type==="image")){let s=t.form;if(s==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let l=t.getAttribute("formaction")||s.getAttribute("action");if(r=l?If(l,e):null,n=t.getAttribute("formmethod")||s.getAttribute("method")||Ux,i=OS(t.getAttribute("formenctype"))||OS(s.getAttribute("enctype"))||Bx,a=new FormData(s,t),!iie()){let{name:c,type:f,value:u}=t;if(f==="image"){let d=c?`${c}.`:"";a.append(`${d}x`,"0"),a.append(`${d}y`,"0")}else c&&a.append(c,u)}}else{if(lw(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=Ux,r=null,i=Bx,o=t}return a&&i==="text/plain"&&(o=a,a=void 0),{action:r,method:n.toLowerCase(),encType:i,formData:a,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function h_(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function sie(t,e,n){let r=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return r.pathname==="/"?r.pathname=`_root.${n}`:e&&If(r.pathname,e)==="/"?r.pathname=`${e.replace(/\/$/,"")}/_root.${n}`:r.pathname=`${r.pathname.replace(/\/$/,"")}.${n}`,r}async function lie(t,e){if(t.id in e)return e[t.id];try{let n=await import(t.module);return e[t.id]=n,n}catch(n){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function cie(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function uie(t,e,n){let r=await Promise.all(t.map(async i=>{let a=e.routes[i.route.id];if(a){let o=await lie(a,n);return o.links?o.links():[]}return[]}));return pie(r.flat(1).filter(cie).filter(i=>i.rel==="stylesheet"||i.rel==="preload").map(i=>i.rel==="stylesheet"?{...i,rel:"prefetch",as:"style"}:{...i,rel:"prefetch"}))}function mR(t,e,n,r,i,a){let o=(l,c)=>n[c]?l.route.id!==n[c].route.id:!0,s=(l,c)=>n[c].pathname!==l.pathname||n[c].route.path?.endsWith("*")&&n[c].params["*"]!==l.params["*"];return a==="assets"?e.filter((l,c)=>o(l,c)||s(l,c)):a==="data"?e.filter((l,c)=>{let f=r.routes[l.route.id];if(!f||!f.hasLoader)return!1;if(o(l,c)||s(l,c))return!0;if(l.route.shouldRevalidate){let u=l.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:n[0]?.params||{},nextUrl:new URL(t,window.origin),nextParams:l.params,defaultShouldRevalidate:!0});if(typeof u=="boolean")return u}return!0}):[]}function fie(t,e,{includeHydrateFallback:n}={}){return die(t.map(r=>{let i=e.routes[r.route.id];if(!i)return[];let a=[i.module];return i.clientActionModule&&(a=a.concat(i.clientActionModule)),i.clientLoaderModule&&(a=a.concat(i.clientLoaderModule)),n&&i.hydrateFallbackModule&&(a=a.concat(i.hydrateFallbackModule)),i.imports&&(a=a.concat(i.imports)),a}).flat(1))}function die(t){return[...new Set(t)]}function hie(t){let e={},n=Object.keys(t).sort();for(let r of n)e[r]=t[r];return e}function pie(t,e){let n=new Set;return new Set(e),t.reduce((r,i)=>{let a=JSON.stringify(hie(i));return n.has(a)||(n.add(a),r.push({key:a,link:i})),r},[])}function mU(){let t=H.useContext(wm);return h_(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function gie(){let t=H.useContext(ow);return h_(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var p_=H.createContext(void 0);p_.displayName="FrameworkContext";function vU(){let t=H.useContext(p_);return h_(t,"You must render this element inside a <HydratedRouter> element"),t}function mie(t,e){let n=H.useContext(p_),[r,i]=H.useState(!1),[a,o]=H.useState(!1),{onFocus:s,onBlur:l,onMouseEnter:c,onMouseLeave:f,onTouchStart:u}=e,d=H.useRef(null);H.useEffect(()=>{if(t==="render"&&o(!0),t==="viewport"){let g=y=>{y.forEach(v=>{o(v.isIntersecting)})},m=new IntersectionObserver(g,{threshold:.5});return d.current&&m.observe(d.current),()=>{m.disconnect()}}},[t]),H.useEffect(()=>{if(r){let g=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(g)}}},[r]);let h=()=>{i(!0)},p=()=>{i(!1),o(!1)};return n?t!=="intent"?[a,d,{}]:[a,d,{onFocus:F1(s,h),onBlur:F1(l,p),onMouseEnter:F1(c,h),onMouseLeave:F1(f,p),onTouchStart:F1(u,h)}]:[!1,d,{}]}function F1(t,e){return n=>{t&&t(n),n.defaultPrevented||e(n)}}function vie({page:t,...e}){let{router:n}=mU(),r=H.useMemo(()=>iU(n.routes,t,n.basename),[n.routes,t,n.basename]);return r?H.createElement(xie,{page:t,matches:r,...e}):null}function yie(t){let{manifest:e,routeModules:n}=vU(),[r,i]=H.useState([]);return H.useEffect(()=>{let a=!1;return uie(t,e,n).then(o=>{a||i(o)}),()=>{a=!0}},[t,e,n]),r}function xie({page:t,matches:e,...n}){let r=Su(),{manifest:i,routeModules:a}=vU(),{basename:o}=mU(),{loaderData:s,matches:l}=gie(),c=H.useMemo(()=>mR(t,e,l,i,r,"data"),[t,e,l,i,r]),f=H.useMemo(()=>mR(t,e,l,i,r,"assets"),[t,e,l,i,r]),u=H.useMemo(()=>{if(t===r.pathname+r.search+r.hash)return[];let p=new Set,g=!1;if(e.forEach(y=>{let v=i.routes[y.route.id];!v||!v.hasLoader||(!c.some(x=>x.route.id===y.route.id)&&y.route.id in s&&a[y.route.id]?.shouldRevalidate||v.hasClientLoader?g=!0:p.add(y.route.id))}),p.size===0)return[];let m=sie(t,o,"data");return g&&p.size>0&&m.searchParams.set("_routes",e.filter(y=>p.has(y.route.id)).map(y=>y.route.id).join(",")),[m.pathname+m.search]},[o,s,r,i,c,e,t,a]),d=H.useMemo(()=>fie(f,i),[f,i]),h=yie(f);return H.createElement(H.Fragment,null,u.map(p=>H.createElement("link",{key:p,rel:"prefetch",as:"fetch",href:p,...n})),d.map(p=>H.createElement("link",{key:p,rel:"modulepreload",href:p,...n})),h.map(({key:p,link:g})=>H.createElement("link",{key:p,nonce:n.nonce,...g})))}function bie(...t){return e=>{t.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var yU=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{yU&&(window.__reactRouterVersion="7.8.2")}catch{}function wie({basename:t,children:e,window:n}){let r=H.useRef();r.current==null&&(r.current=ure({window:n,v5Compat:!0}));let i=r.current,[a,o]=H.useState({action:i.action,location:i.location}),s=H.useCallback(l=>{H.startTransition(()=>o(l))},[o]);return H.useLayoutEffect(()=>i.listen(s),[i,s]),H.createElement(Zre,{basename:t,children:e,location:a.location,navigationType:a.action,navigator:i})}var xU=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,bU=H.forwardRef(function({onClick:e,discover:n="render",prefetch:r="none",relative:i,reloadDocument:a,replace:o,state:s,target:l,to:c,preventScrollReset:f,viewTransition:u,...d},h){let{basename:p}=H.useContext(wu),g=typeof c=="string"&&xU.test(c),m,y=!1;if(typeof c=="string"&&g&&(m=c,yU))try{let I=new URL(window.location.href),R=c.startsWith("//")?new URL(I.protocol+c):new URL(c),M=If(R.pathname,p);R.origin===I.origin&&M!=null?c=M+R.search+R.hash:y=!0}catch{du(!1,`<Link to="${c}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let v=Vre(c,{relative:i}),[x,w,S]=mie(r,d),T=Eie(c,{replace:o,state:s,target:l,preventScrollReset:f,relative:i,viewTransition:u});function _(I){e&&e(I),I.defaultPrevented||T(I)}let D=H.createElement("a",{...d,...S,href:m||v,onClick:y||a?e:_,ref:bie(h,w),target:l,"data-discover":!g&&n==="render"?"true":void 0});return x&&!g?H.createElement(H.Fragment,null,D,H.createElement(vie,{page:v})):D});bU.displayName="Link";var Cie=H.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:r="",end:i=!1,style:a,to:o,viewTransition:s,children:l,...c},f){let u=B2(o,{relative:c.relative}),d=Su(),h=H.useContext(ow),{navigator:p,basename:g}=H.useContext(wu),m=h!=null&&Iie(u)&&s===!0,y=p.encodeLocation?p.encodeLocation(u).pathname:u.pathname,v=d.pathname,x=h&&h.navigation&&h.navigation.location?h.navigation.location.pathname:null;n||(v=v.toLowerCase(),x=x?x.toLowerCase():null,y=y.toLowerCase()),x&&g&&(x=If(x,g)||x);const w=y!=="/"&&y.endsWith("/")?y.length-1:y.length;let S=v===y||!i&&v.startsWith(y)&&v.charAt(w)==="/",T=x!=null&&(x===y||!i&&x.startsWith(y)&&x.charAt(y.length)==="/"),_={isActive:S,isPending:T,isTransitioning:m},D=S?e:void 0,I;typeof r=="function"?I=r(_):I=[r,S?"active":null,T?"pending":null,m?"transitioning":null].filter(Boolean).join(" ");let R=typeof a=="function"?a(_):a;return H.createElement(bU,{...c,"aria-current":D,className:I,ref:f,style:R,to:o,viewTransition:s},typeof l=="function"?l(_):l)});Cie.displayName="NavLink";var Sie=H.forwardRef(({discover:t="render",fetcherKey:e,navigate:n,reloadDocument:r,replace:i,state:a,method:o=Ux,action:s,onSubmit:l,relative:c,preventScrollReset:f,viewTransition:u,...d},h)=>{let p=Oie(),g=Mie(s,{relative:c}),m=o.toLowerCase()==="get"?"get":"post",y=typeof s=="string"&&xU.test(s),v=x=>{if(l&&l(x),x.defaultPrevented)return;x.preventDefault();let w=x.nativeEvent.submitter,S=w?.getAttribute("formmethod")||o;p(w||x.currentTarget,{fetcherKey:e,method:S,navigate:n,replace:i,state:a,relative:c,preventScrollReset:f,viewTransition:u})};return H.createElement("form",{ref:h,method:m,action:g,onSubmit:r?l:v,...d,"data-discover":!y&&t==="render"?"true":void 0})});Sie.displayName="Form";function Tie(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function wU(t){let e=H.useContext(wm);return Na(e,Tie(t)),e}function Eie(t,{target:e,replace:n,state:r,preventScrollReset:i,relative:a,viewTransition:o}={}){let s=bc(),l=Su(),c=B2(t,{relative:a});return H.useCallback(f=>{if(rie(f,e)){f.preventDefault();let u=n!==void 0?n:Zv(l)===Zv(c);s(t,{replace:u,state:r,preventScrollReset:i,relative:a,viewTransition:o})}},[l,s,c,n,r,e,t,i,a,o])}var _ie=0,Die=()=>`__${String(++_ie)}__`;function Oie(){let{router:t}=wU("useSubmit"),{basename:e}=H.useContext(wu),n=qre();return H.useCallback(async(r,i={})=>{let{action:a,method:o,encType:s,formData:l,body:c}=oie(r,e);if(i.navigate===!1){let f=i.fetcherKey||Die();await t.fetch(f,n,i.action||a,{preventScrollReset:i.preventScrollReset,formData:l,body:c,formMethod:i.method||o,formEncType:i.encType||s,flushSync:i.flushSync})}else await t.navigate(i.action||a,{preventScrollReset:i.preventScrollReset,formData:l,body:c,formMethod:i.method||o,formEncType:i.encType||s,replace:i.replace,state:i.state,fromRouteId:n,flushSync:i.flushSync,viewTransition:i.viewTransition})},[t,e,n])}function Mie(t,{relative:e}={}){let{basename:n}=H.useContext(wu),r=H.useContext(Cu);Na(r,"useFormAction must be used inside a RouteContext");let[i]=r.matches.slice(-1),a={...B2(t||".",{relative:e})},o=Su();if(t==null){a.search=o.search;let s=new URLSearchParams(a.search),l=s.getAll("index");if(l.some(f=>f==="")){s.delete("index"),l.filter(u=>u).forEach(u=>s.append("index",u));let f=s.toString();a.search=f?`?${f}`:""}}return(!t||t===".")&&i.route.index&&(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(a.pathname=a.pathname==="/"?n:Sf([n,a.pathname])),Zv(a)}function Iie(t,{relative:e}={}){let n=H.useContext(uU);Na(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=wU("useViewTransitionState"),i=B2(t,{relative:e});if(!n.isTransitioning)return!1;let a=If(n.currentLocation.pathname,r)||n.currentLocation.pathname,o=If(n.nextLocation.pathname,r)||n.nextLocation.pathname;return Nb(i.pathname,o)!=null||Nb(i.pathname,a)!=null}var g_=rU();const Rie=tl(g_),Aie="modulepreload",Pie=function(t){return"/"+t},vR={},Cm=function(e,n,r){let i=Promise.resolve();if(n&&n.length>0){let l=function(c){return Promise.all(c.map(f=>Promise.resolve(f).then(u=>({status:"fulfilled",value:u}),u=>({status:"rejected",reason:u}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),s=o?.nonce||o?.getAttribute("nonce");i=l(n.map(c=>{if(c=Pie(c),c in vR)return;vR[c]=!0;const f=c.endsWith(".css"),u=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${u}`))return;const d=document.createElement("link");if(d.rel=f?"stylesheet":Aie,f||(d.as="script"),d.crossOrigin="",d.href=c,s&&d.setAttribute("nonce",s),document.head.appendChild(d),f)return new Promise((h,p)=>{d.addEventListener("load",h),d.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${c}`)))})}))}function a(o){const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=o,window.dispatchEvent(s),!s.defaultPrevented)throw o}return i.then(o=>{for(const s of o||[])s.status==="rejected"&&a(s.reason);return e().catch(a)})};function cw(t={}){const{strict:e=!0,errorMessage:n="useContext: `context` is undefined. Seems you forgot to wrap component within the Provider",name:r}=t,i=H.createContext(void 0);i.displayName=r;function a(){var o;const s=H.useContext(i);if(!s&&e){const l=new Error(n);throw l.name="ContextError",(o=Error.captureStackTrace)==null||o.call(Error,l,a),l}return s}return[i.Provider,a,i]}function Di(t){const e=H.useRef(null);return H.useImperativeHandle(t,()=>e.current),e}var Nie=t=>t?"":void 0;function m_(t){return Array.isArray(t)}function Lie(t){return m_(t)&&t.length===0}function CU(t){const e=typeof t;return t!=null&&(e==="object"||e==="function")&&!m_(t)}function kie(t){return CU(t)&&Object.keys(t).length===0}function Lb(t){return m_(t)?Lie(t):CU(t)?kie(t):t==null||t===""}function Vie(t){return typeof t=="function"}var Nt=t=>t?"true":void 0;function SU(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t))for(e=0;e<t.length;e++)t[e]&&(n=SU(t[e]))&&(r&&(r+=" "),r+=n);else for(e in t)t[e]&&(r&&(r+=" "),r+=e);return r}function ln(...t){for(var e=0,n,r,i="";e<t.length;)(n=t[e++])&&(r=SU(n))&&(i&&(i+=" "),i+=r);return i}var Fie=(...t)=>{let e=" ";for(const n of t)if(typeof n=="string"&&n.length>0){e=n;break}return e},TU=t=>t?t.charAt(0).toUpperCase()+t.slice(1).toLowerCase():"";function EU(t){return`${t}-${Math.floor(Math.random()*1e6)}`}function Uie(t){for(const e in t)e.startsWith("on")&&delete t[e];return t}function kl(t){if(!t||typeof t!="object")return"";try{return JSON.stringify(t)}catch{return""}}function fd(t,e){const n=e-t+1;return Array.from({length:n},(r,i)=>i+t)}function _U(t,e,n){return Math.min(Math.max(t,e),n)}function Rf(...t){return(...e)=>{for(let n of t)typeof n=="function"&&n(...e)}}var yR=new Map;function Bie(t,e){if(t===e)return t;let n=yR.get(t);if(n)return n.forEach(i=>i.current=e),e;let r=yR.get(e);return r?(r.forEach(i=>i.current=t),t):e}function Pn(...t){let e={...t[0]};for(let n=1;n<t.length;n++){let r=t[n];for(let i in r){let a=e[i],o=r[i];typeof a=="function"&&typeof o=="function"&&i[0]==="o"&&i[1]==="n"&&i.charCodeAt(2)>=65&&i.charCodeAt(2)<=90?e[i]=Rf(a,o):(i==="className"||i==="UNSAFE_className")&&typeof a=="string"&&typeof o=="string"?e[i]=ln(a,o):i==="id"&&a&&o?e.id=Bie(a,o):e[i]=o!==void 0?o:a}}return e}function DU(...t){return t.length===1&&t[0]?t[0]:e=>{let n=!1;const r=t.map(i=>{const a=xR(i,e);return n||(n=typeof a=="function"),a});if(n)return()=>{r.forEach((i,a)=>{typeof i=="function"?i?.():xR(t[a],null)})}}}function xR(t,e){if(typeof t=="function")return()=>t(e);t!=null&&"current"in t&&(t.current=e)}function $ie(t,e){if(t!=null){if(Vie(t)){t(e);return}try{t.current=e}catch{throw new Error(`Cannot assign value '${e}' to ref '${t}'`)}}}function Gie(...t){return e=>{t.forEach(n=>$ie(n,e))}}var jie=new Set(["id","type","style","title","role","tabIndex","htmlFor","width","height","abbr","accept","acceptCharset","accessKey","action","allowFullScreen","allowTransparency","alt","async","autoComplete","autoFocus","autoPlay","cellPadding","cellSpacing","challenge","charset","checked","cite","class","className","cols","colSpan","command","content","contentEditable","contextMenu","controls","coords","crossOrigin","data","dateTime","default","defer","dir","disabled","download","draggable","dropzone","encType","enterKeyHint","for","form","formAction","formEncType","formMethod","formNoValidate","formTarget","frameBorder","headers","hidden","high","href","hrefLang","httpEquiv","icon","inputMode","isMap","itemId","itemProp","itemRef","itemScope","itemType","kind","label","lang","list","loop","manifest","max","maxLength","media","mediaGroup","method","min","minLength","multiple","muted","name","noValidate","open","optimum","pattern","ping","placeholder","poster","preload","radioGroup","referrerPolicy","readOnly","rel","required","rows","rowSpan","sandbox","scope","scoped","scrolling","seamless","selected","shape","size","sizes","slot","sortable","span","spellCheck","src","srcDoc","srcSet","start","step","target","translate","typeMustMatch","useMap","value","wmode","wrap"]),zie=new Set(["onCopy","onCut","onPaste","onLoad","onError","onWheel","onScroll","onCompositionEnd","onCompositionStart","onCompositionUpdate","onKeyDown","onKeyPress","onKeyUp","onFocus","onBlur","onChange","onInput","onSubmit","onClick","onContextMenu","onDoubleClick","onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onPointerDown","onPointerEnter","onPointerLeave","onPointerUp","onSelect","onTouchCancel","onTouchEnd","onTouchMove","onTouchStart","onAnimationStart","onAnimationEnd","onAnimationIteration","onTransitionEnd"]),bR=/^(data-.*)$/,Wie=/^(aria-.*)$/,S5=/^(on[A-Z].*)$/;function Io(t,e={}){let{labelable:n=!0,enabled:r=!0,propNames:i,omitPropNames:a,omitEventNames:o,omitDataProps:s,omitEventProps:l}=e,c={};if(!r)return t;for(const f in t)a?.has(f)||o?.has(f)&&S5.test(f)||S5.test(f)&&!zie.has(f)||s&&bR.test(f)||l&&S5.test(f)||(Object.prototype.hasOwnProperty.call(t,f)&&(jie.has(f)||n&&Wie.test(f)||i?.has(f)||bR.test(f))||S5.test(f))&&(c[f]=t[f]);return c}var[Hie,es]=cw({name:"ProviderContext",strict:!1});const Kie=new Set(["Arab","Syrc","Samr","Mand","Thaa","Mend","Nkoo","Adlm","Rohg","Hebr"]),qie=new Set(["ae","ar","arc","bcc","bqi","ckb","dv","fa","glk","he","ku","mzn","nqo","pnb","ps","sd","ug","ur","yi"]);function OU(t){if(Intl.Locale){let n=new Intl.Locale(t).maximize(),r=typeof n.getTextInfo=="function"?n.getTextInfo():n.textInfo;if(r)return r.direction==="rtl";if(n.script)return Kie.has(n.script)}let e=t.split("-")[0];return qie.has(e)}const MU={prefix:String(Math.round(Math.random()*1e10)),current:0},IU=Tn.createContext(MU),Xie=Tn.createContext(!1);let MS=new WeakMap;function Yie(t=!1){let e=H.useContext(IU),n=H.useRef(null);if(n.current===null&&!t){var r,i;let a=(i=Tn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED)===null||i===void 0||(r=i.ReactCurrentOwner)===null||r===void 0?void 0:r.current;if(a){let o=MS.get(a);o==null?MS.set(a,{id:e.current,state:a.memoizedState}):a.memoizedState!==o.state&&(e.current=o.id,MS.delete(a))}n.current=++e.current}return n.current}function Jie(t){let e=H.useContext(IU),n=Yie(!!t),r=`react-aria${e.prefix}`;return t||`${r}-${n}`}function Zie(t){let e=Tn.useId(),[n]=H.useState(uw()),r=n?"react-aria":`react-aria${MU.prefix}`;return t||`${r}-${e}`}const Qie=typeof Tn.useId=="function"?Zie:Jie;function eae(){return!1}function tae(){return!0}function nae(t){return()=>{}}function uw(){return typeof Tn.useSyncExternalStore=="function"?Tn.useSyncExternalStore(nae,eae,tae):H.useContext(Xie)}const rae=Symbol.for("react-aria.i18n.locale");function RU(){let t=typeof window<"u"&&window[rae]||typeof navigator<"u"&&(navigator.language||navigator.userLanguage)||"en-US";try{Intl.DateTimeFormat.supportedLocalesOf([t])}catch{t="en-US"}return{locale:t,direction:OU(t)?"rtl":"ltr"}}let Q8=RU(),sv=new Set;function wR(){Q8=RU();for(let t of sv)t(Q8)}function AU(){let t=uw(),[e,n]=H.useState(Q8);return H.useEffect(()=>(sv.size===0&&window.addEventListener("languagechange",wR),sv.add(n),()=>{sv.delete(n),sv.size===0&&window.removeEventListener("languagechange",wR)}),[]),t?{locale:"en-US",direction:"ltr"}:e}const PU=Tn.createContext(null);function iae(t){let{locale:e,children:n}=t,r=AU(),i=Tn.useMemo(()=>e?{locale:e,direction:OU(e)?"rtl":"ltr"}:r,[r,e]);return Tn.createElement(PU.Provider,{value:i},n)}function ap(){let t=AU();return H.useContext(PU)||t}const aae=Symbol.for("react-aria.i18n.locale"),oae=Symbol.for("react-aria.i18n.strings");let jp;class fw{getStringForLocale(e,n){let i=this.getStringsForLocale(n)[e];if(!i)throw new Error(`Could not find intl message ${e} in ${n} locale`);return i}getStringsForLocale(e){let n=this.strings[e];return n||(n=sae(e,this.strings,this.defaultLocale),this.strings[e]=n),n}static getGlobalDictionaryForPackage(e){if(typeof window>"u")return null;let n=window[aae];if(jp===void 0){let i=window[oae];if(!i)return null;jp={};for(let a in i)jp[a]=new fw({[n]:i[a]},n)}let r=jp?.[e];if(!r)throw new Error(`Strings for package "${e}" were not included by LocalizedStringProvider. Please add it to the list passed to createLocalizedStringDictionary.`);return r}constructor(e,n="en-US"){this.strings=Object.fromEntries(Object.entries(e).filter(([,r])=>r)),this.defaultLocale=n}}function sae(t,e,n="en-US"){if(e[t])return e[t];let r=lae(t);if(e[r])return e[r];for(let i in e)if(i.startsWith(r+"-"))return e[i];return e[n]}function lae(t){return Intl.Locale?new Intl.Locale(t).language:t.split("-")[0]}const CR=new Map,SR=new Map;class cae{format(e,n){let r=this.strings.getStringForLocale(e,this.locale);return typeof r=="function"?r(n,this):r}plural(e,n,r="cardinal"){let i=n["="+e];if(i)return typeof i=="function"?i():i;let a=this.locale+":"+r,o=CR.get(a);o||(o=new Intl.PluralRules(this.locale,{type:r}),CR.set(a,o));let s=o.select(e);return i=n[s]||n.other,typeof i=="function"?i():i}number(e){let n=SR.get(this.locale);return n||(n=new Intl.NumberFormat(this.locale),SR.set(this.locale,n)),n.format(e)}select(e,n){let r=e[n]||e.other;return typeof r=="function"?r():r}constructor(e,n){this.locale=e,this.strings=n}}const TR=new WeakMap;function uae(t){let e=TR.get(t);return e||(e=new fw(t),TR.set(t,e)),e}function fae(t,e){return e&&fw.getGlobalDictionaryForPackage(e)||uae(t)}function dw(t,e){let{locale:n}=ap(),r=fae(t,e);return H.useMemo(()=>new cae(n,r),[n,r])}function dae(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hae(t,e,n){dae(t,e),e.set(t,n)}const Br=typeof document<"u"?Tn.useLayoutEffect:()=>{};var IS;const pae=(IS=Tn.useInsertionEffect)!==null&&IS!==void 0?IS:Br;function va(t){const e=H.useRef(null);return pae(()=>{e.current=t},[t]),H.useCallback((...n)=>{const r=e.current;return r?.(...n)},[])}function gae(t){let[e,n]=H.useState(t),r=H.useRef(null),i=va(()=>{if(!r.current)return;let o=r.current.next();if(o.done){r.current=null;return}e===o.value?i():n(o.value)});Br(()=>{r.current&&i()});let a=va(o=>{r.current=o(e),i()});return[e,a]}let mae=!!(typeof window<"u"&&window.document&&window.document.createElement),kg=new Map,lv;typeof FinalizationRegistry<"u"&&(lv=new FinalizationRegistry(t=>{kg.delete(t)}));function Js(t){let[e,n]=H.useState(t),r=H.useRef(null),i=Qie(e),a=H.useRef(null);if(lv&&lv.register(a,i),mae){const o=kg.get(i);o&&!o.includes(r)?o.push(r):kg.set(i,[r])}return Br(()=>{let o=i;return()=>{lv&&lv.unregister(a),kg.delete(o)}},[i]),H.useEffect(()=>{let o=r.current;return o&&n(o),()=>{o&&(r.current=null)}}),i}function vae(t,e){if(t===e)return t;let n=kg.get(t);if(n)return n.forEach(i=>i.current=e),e;let r=kg.get(e);return r?(r.forEach(i=>i.current=t),t):e}function am(t=[]){let e=Js(),[n,r]=gae(e),i=H.useCallback(()=>{r(function*(){yield e,yield document.getElementById(e)?e:void 0})},[e,r]);return Br(i,[e,i,...t]),n}function o0(...t){return(...e)=>{for(let n of t)typeof n=="function"&&n(...e)}}const Mr=t=>{var e;return(e=t?.ownerDocument)!==null&&e!==void 0?e:document},Ml=t=>t&&"window"in t&&t.window===t?t:Mr(t).defaultView||window;function yae(t){return t!==null&&typeof t=="object"&&"nodeType"in t&&typeof t.nodeType=="number"}function xae(t){return yae(t)&&t.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&"host"in t}let bae=!1;function hw(){return bae}function xs(t,e){if(!hw())return e&&t?t.contains(e):!1;if(!t||!e)return!1;let n=e;for(;n!==null;){if(n===t)return!0;n.tagName==="SLOT"&&n.assignedSlot?n=n.assignedSlot.parentNode:xae(n)?n=n.host:n=n.parentNode}return!1}const Oo=(t=document)=>{var e;if(!hw())return t.activeElement;let n=t.activeElement;for(;n&&"shadowRoot"in n&&(!((e=n.shadowRoot)===null||e===void 0)&&e.activeElement);)n=n.shadowRoot.activeElement;return n};function ea(t){return hw()&&t.target.shadowRoot&&t.composedPath?t.composedPath()[0]:t.target}class wae{get currentNode(){return this._currentNode}set currentNode(e){if(!xs(this.root,e))throw new Error("Cannot set currentNode to a node that is not contained by the root node.");const n=[];let r=e,i=e;for(this._currentNode=e;r&&r!==this.root;)if(r.nodeType===Node.DOCUMENT_FRAGMENT_NODE){const o=r,s=this._doc.createTreeWalker(o,this.whatToShow,{acceptNode:this._acceptNode});n.push(s),s.currentNode=i,this._currentSetFor.add(s),r=i=o.host}else r=r.parentNode;const a=this._doc.createTreeWalker(this.root,this.whatToShow,{acceptNode:this._acceptNode});n.push(a),a.currentNode=i,this._currentSetFor.add(a),this._walkerStack=n}get doc(){return this._doc}firstChild(){let e=this.currentNode,n=this.nextNode();return xs(e,n)?(n&&(this.currentNode=n),n):(this.currentNode=e,null)}lastChild(){let n=this._walkerStack[0].lastChild();return n&&(this.currentNode=n),n}nextNode(){const e=this._walkerStack[0].nextNode();if(e){if(e.shadowRoot){var n;let i;if(typeof this.filter=="function"?i=this.filter(e):!((n=this.filter)===null||n===void 0)&&n.acceptNode&&(i=this.filter.acceptNode(e)),i===NodeFilter.FILTER_ACCEPT)return this.currentNode=e,e;let a=this.nextNode();return a&&(this.currentNode=a),a}return e&&(this.currentNode=e),e}else if(this._walkerStack.length>1){this._walkerStack.shift();let r=this.nextNode();return r&&(this.currentNode=r),r}else return null}previousNode(){const e=this._walkerStack[0];if(e.currentNode===e.root){if(this._currentSetFor.has(e))if(this._currentSetFor.delete(e),this._walkerStack.length>1){this._walkerStack.shift();let i=this.previousNode();return i&&(this.currentNode=i),i}else return null;return null}const n=e.previousNode();if(n){if(n.shadowRoot){var r;let a;if(typeof this.filter=="function"?a=this.filter(n):!((r=this.filter)===null||r===void 0)&&r.acceptNode&&(a=this.filter.acceptNode(n)),a===NodeFilter.FILTER_ACCEPT)return n&&(this.currentNode=n),n;let o=this.lastChild();return o&&(this.currentNode=o),o}return n&&(this.currentNode=n),n}else if(this._walkerStack.length>1){this._walkerStack.shift();let i=this.previousNode();return i&&(this.currentNode=i),i}else return null}nextSibling(){return null}previousSibling(){return null}parentNode(){return null}constructor(e,n,r,i){this._walkerStack=[],this._currentSetFor=new Set,this._acceptNode=o=>{if(o.nodeType===Node.ELEMENT_NODE){const l=o.shadowRoot;if(l){const c=this._doc.createTreeWalker(l,this.whatToShow,{acceptNode:this._acceptNode});return this._walkerStack.unshift(c),NodeFilter.FILTER_ACCEPT}else{var s;if(typeof this.filter=="function")return this.filter(o);if(!((s=this.filter)===null||s===void 0)&&s.acceptNode)return this.filter.acceptNode(o);if(this.filter===null)return NodeFilter.FILTER_ACCEPT}}return NodeFilter.FILTER_SKIP},this._doc=e,this.root=n,this.filter=i??null,this.whatToShow=r??NodeFilter.SHOW_ALL,this._currentNode=n,this._walkerStack.unshift(e.createTreeWalker(n,r,this._acceptNode));const a=n.shadowRoot;if(a){const o=this._doc.createTreeWalker(a,this.whatToShow,{acceptNode:this._acceptNode});this._walkerStack.unshift(o)}}}function Cae(t,e,n,r){return hw()?new wae(t,e,n,r):t.createTreeWalker(e,n,r)}function NU(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(e=0;e<i;e++)t[e]&&(n=NU(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function Sae(){for(var t,e,n=0,r="",i=arguments.length;n<i;n++)(t=arguments[n])&&(e=NU(t))&&(r&&(r+=" "),r+=e);return r}function Oi(...t){let e={...t[0]};for(let n=1;n<t.length;n++){let r=t[n];for(let i in r){let a=e[i],o=r[i];typeof a=="function"&&typeof o=="function"&&i[0]==="o"&&i[1]==="n"&&i.charCodeAt(2)>=65&&i.charCodeAt(2)<=90?e[i]=o0(a,o):(i==="className"||i==="UNSAFE_className")&&typeof a=="string"&&typeof o=="string"?e[i]=Sae(a,o):i==="id"&&a&&o?e.id=vae(a,o):e[i]=o!==void 0?o:a}}return e}const Tae=new Set(["id"]),Eae=new Set(["aria-label","aria-labelledby","aria-describedby","aria-details"]),_ae=new Set(["href","hrefLang","target","rel","download","ping","referrerPolicy"]),Dae=new Set(["dir","lang","hidden","inert","translate"]),ER=new Set(["onClick","onAuxClick","onContextMenu","onDoubleClick","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onTouchCancel","onTouchEnd","onTouchMove","onTouchStart","onPointerDown","onPointerMove","onPointerUp","onPointerCancel","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut","onGotPointerCapture","onLostPointerCapture","onScroll","onWheel","onAnimationStart","onAnimationEnd","onAnimationIteration","onTransitionCancel","onTransitionEnd","onTransitionRun","onTransitionStart"]),Oae=/^(data-.*)$/;function T0(t,e={}){let{labelable:n,isLink:r,global:i,events:a=i,propNames:o}=e,s={};for(const l in t)Object.prototype.hasOwnProperty.call(t,l)&&(Tae.has(l)||n&&Eae.has(l)||r&&_ae.has(l)||i&&Dae.has(l)||a&&ER.has(l)||l.endsWith("Capture")&&ER.has(l.slice(0,-7))||o?.has(l)||Oae.test(l))&&(s[l]=t[l]);return s}function To(t){if(Mae())t.focus({preventScroll:!0});else{let e=Iae(t);t.focus(),Rae(e)}}let T5=null;function Mae(){if(T5==null){T5=!1;try{document.createElement("div").focus({get preventScroll(){return T5=!0,!0}})}catch{}}return T5}function Iae(t){let e=t.parentNode,n=[],r=document.scrollingElement||document.documentElement;for(;e instanceof HTMLElement&&e!==r;)(e.offsetHeight<e.scrollHeight||e.offsetWidth<e.scrollWidth)&&n.push({element:e,scrollTop:e.scrollTop,scrollLeft:e.scrollLeft}),e=e.parentNode;return r instanceof HTMLElement&&n.push({element:r,scrollTop:r.scrollTop,scrollLeft:r.scrollLeft}),n}function Rae(t){for(let{element:e,scrollTop:n,scrollLeft:r}of t)e.scrollTop=n,e.scrollLeft=r}function pw(t){var e;if(typeof window>"u"||window.navigator==null)return!1;let n=(e=window.navigator.userAgentData)===null||e===void 0?void 0:e.brands;return Array.isArray(n)&&n.some(r=>t.test(r.brand))||t.test(window.navigator.userAgent)}function v_(t){var e;return typeof window<"u"&&window.navigator!=null?t.test(((e=window.navigator.userAgentData)===null||e===void 0?void 0:e.platform)||window.navigator.platform):!1}function Ff(t){let e=null;return()=>(e==null&&(e=t()),e)}const s0=Ff(function(){return v_(/^Mac/i)}),Aae=Ff(function(){return v_(/^iPhone/i)}),LU=Ff(function(){return v_(/^iPad/i)||s0()&&navigator.maxTouchPoints>1}),gw=Ff(function(){return Aae()||LU()}),Pae=Ff(function(){return s0()||gw()}),y_=Ff(function(){return pw(/AppleWebKit/i)&&!kU()}),kU=Ff(function(){return pw(/Chrome/i)}),x_=Ff(function(){return pw(/Android/i)}),Nae=Ff(function(){return pw(/Firefox/i)}),VU=H.createContext({isNative:!0,open:kae,useHref:t=>t});function Lae(t){let{children:e,navigate:n,useHref:r}=t,i=H.useMemo(()=>({isNative:!1,open:(a,o,s,l)=>{UU(a,c=>{FU(c,o)?n(s,l):l0(c,o)})},useHref:r||(a=>a)}),[n,r]);return Tn.createElement(VU.Provider,{value:i},e)}function mw(){return H.useContext(VU)}function FU(t,e){let n=t.getAttribute("target");return(!n||n==="_self")&&t.origin===location.origin&&!t.hasAttribute("download")&&!e.metaKey&&!e.ctrlKey&&!e.altKey&&!e.shiftKey}function l0(t,e,n=!0){var r,i;let{metaKey:a,ctrlKey:o,altKey:s,shiftKey:l}=e;Nae()&&(!((i=window.event)===null||i===void 0||(r=i.type)===null||r===void 0)&&r.startsWith("key"))&&t.target==="_blank"&&(s0()?a=!0:o=!0);let c=y_()&&s0()&&!LU()?new KeyboardEvent("keydown",{keyIdentifier:"Enter",metaKey:a,ctrlKey:o,altKey:s,shiftKey:l}):new MouseEvent("click",{metaKey:a,ctrlKey:o,altKey:s,shiftKey:l,bubbles:!0,cancelable:!0});l0.isOpening=n,To(t),t.dispatchEvent(c),l0.isOpening=!1}l0.isOpening=!1;function UU(t,e){if(t instanceof HTMLAnchorElement)e(t);else if(t.hasAttribute("data-href")){let n=document.createElement("a");n.href=t.getAttribute("data-href"),t.hasAttribute("data-target")&&(n.target=t.getAttribute("data-target")),t.hasAttribute("data-rel")&&(n.rel=t.getAttribute("data-rel")),t.hasAttribute("data-download")&&(n.download=t.getAttribute("data-download")),t.hasAttribute("data-ping")&&(n.ping=t.getAttribute("data-ping")),t.hasAttribute("data-referrer-policy")&&(n.referrerPolicy=t.getAttribute("data-referrer-policy")),t.appendChild(n),e(n),t.removeChild(n)}}function kae(t,e){UU(t,n=>l0(n,e))}function BU(t){let e=mw();var n;const r=e.useHref((n=t?.href)!==null&&n!==void 0?n:"");return{href:t?.href?r:void 0,target:t?.target,rel:t?.rel,download:t?.download,ping:t?.ping,referrerPolicy:t?.referrerPolicy}}let jd=new Map,eE=new Set;function _R(){if(typeof window>"u")return;function t(r){return"propertyName"in r}let e=r=>{if(!t(r)||!r.target)return;let i=jd.get(r.target);i||(i=new Set,jd.set(r.target,i),r.target.addEventListener("transitioncancel",n,{once:!0})),i.add(r.propertyName)},n=r=>{if(!t(r)||!r.target)return;let i=jd.get(r.target);if(i&&(i.delete(r.propertyName),i.size===0&&(r.target.removeEventListener("transitioncancel",n),jd.delete(r.target)),jd.size===0)){for(let a of eE)a();eE.clear()}};document.body.addEventListener("transitionrun",e),document.body.addEventListener("transitionend",n)}typeof document<"u"&&(document.readyState!=="loading"?_R():document.addEventListener("DOMContentLoaded",_R));function Vae(){for(const[t]of jd)"isConnected"in t&&!t.isConnected&&jd.delete(t)}function $U(t){requestAnimationFrame(()=>{Vae(),jd.size===0?t():eE.add(t)})}function vw(){let t=H.useRef(new Map),e=H.useCallback((i,a,o,s)=>{let l=s?.once?(...c)=>{t.current.delete(o),o(...c)}:o;t.current.set(o,{type:a,eventTarget:i,fn:l,options:s}),i.addEventListener(a,l,s)},[]),n=H.useCallback((i,a,o,s)=>{var l;let c=((l=t.current.get(o))===null||l===void 0?void 0:l.fn)||o;i.removeEventListener(a,c,s),t.current.delete(o)},[]),r=H.useCallback(()=>{t.current.forEach((i,a)=>{n(i.eventTarget,i.type,a,i.options)})},[n]);return H.useEffect(()=>r,[r]),{addGlobalListener:e,removeGlobalListener:n,removeAllGlobalListeners:r}}function yw(t,e){let{id:n,"aria-label":r,"aria-labelledby":i}=t;return n=Js(n),i&&r?i=[...new Set([n,...i.trim().split(/\s+/)])].join(" "):i&&(i=i.trim().split(/\s+/).join(" ")),!r&&!i&&e&&(r=e),{id:n,"aria-label":r,"aria-labelledby":i}}function DR(t,e){const n=H.useRef(!0),r=H.useRef(null);Br(()=>(n.current=!0,()=>{n.current=!1}),[]),Br(()=>{n.current?n.current=!1:(!r.current||e.some((i,a)=>!Object.is(i,r[a])))&&t(),r.current=e},e)}function Fae(){return typeof window.ResizeObserver<"u"}function OR(t){const{ref:e,box:n,onResize:r}=t;H.useEffect(()=>{let i=e?.current;if(i)if(Fae()){const a=new window.ResizeObserver(o=>{o.length&&r()});return a.observe(i,{box:n}),()=>{i&&a.unobserve(i)}}else return window.addEventListener("resize",r,!1),()=>{window.removeEventListener("resize",r,!1)}},[r,e,n])}function GU(t,e){Br(()=>{if(t&&t.ref&&e)return t.ref.current=e.current,()=>{t.ref&&(t.ref.current=null)}})}function Qv(t,e){if(!t)return!1;let n=window.getComputedStyle(t),r=/(auto|scroll)/.test(n.overflow+n.overflowX+n.overflowY);return r&&e&&(r=t.scrollHeight!==t.clientHeight||t.scrollWidth!==t.clientWidth),r}function jU(t,e){let n=t;for(Qv(n,e)&&(n=n.parentElement);n&&!Qv(n,e);)n=n.parentElement;return n||document.scrollingElement||document.documentElement}function Uae(t,e){const n=[];for(;t&&t!==document.documentElement;)Qv(t,e)&&n.push(t),t=t.parentElement;return n}let Bae=0;const RS=new Map;function $ae(t){let[e,n]=H.useState();return Br(()=>{if(!t)return;let r=RS.get(t);if(r)n(r.element.id);else{let i=`react-aria-description-${Bae++}`;n(i);let a=document.createElement("div");a.id=i,a.style.display="none",a.textContent=t,document.body.appendChild(a),r={refCount:0,element:a},RS.set(t,r)}return r.refCount++,()=>{r&&--r.refCount===0&&(r.element.remove(),RS.delete(t))}},[t]),{"aria-describedby":t?e:void 0}}function E5(t,e,n,r){let i=va(n),a=n==null;H.useEffect(()=>{if(a||!t.current)return;let o=t.current;return o.addEventListener(e,i,r),()=>{o.removeEventListener(e,i,r)}},[t,e,r,a,i])}function zU(t,e){let n=MR(t,e,"left"),r=MR(t,e,"top"),i=e.offsetWidth,a=e.offsetHeight,o=t.scrollLeft,s=t.scrollTop,{borderTopWidth:l,borderLeftWidth:c,scrollPaddingTop:f,scrollPaddingRight:u,scrollPaddingBottom:d,scrollPaddingLeft:h}=getComputedStyle(t),p=o+parseInt(c,10),g=s+parseInt(l,10),m=p+t.clientWidth,y=g+t.clientHeight,v=parseInt(f,10)||0,x=parseInt(d,10)||0,w=parseInt(u,10)||0,S=parseInt(h,10)||0;n<=o+S?o=n-parseInt(c,10)-S:n+i>m-w&&(o+=n+i-m+w),r<=g+v?s=r-parseInt(l,10)-v:r+a>y-x&&(s+=r+a-y+x),t.scrollLeft=o,t.scrollTop=s}function MR(t,e,n){const r=n==="left"?"offsetLeft":"offsetTop";let i=0;for(;e.offsetParent&&(i+=e[r],e.offsetParent!==t);){if(e.offsetParent.contains(t)){i-=t[r];break}e=e.offsetParent}return i}function IR(t,e){if(t&&document.contains(t)){let o=document.scrollingElement||document.documentElement;if(window.getComputedStyle(o).overflow==="hidden"){let l=Uae(t);for(let c of l)zU(c,t)}else{var n;let{left:l,top:c}=t.getBoundingClientRect();t==null||(n=t.scrollIntoView)===null||n===void 0||n.call(t,{block:"nearest"});let{left:f,top:u}=t.getBoundingClientRect();if(Math.abs(l-f)>1||Math.abs(c-u)>1){var r,i,a;e==null||(i=e.containingElement)===null||i===void 0||(r=i.scrollIntoView)===null||r===void 0||r.call(i,{block:"center",inline:"center"}),(a=t.scrollIntoView)===null||a===void 0||a.call(t,{block:"nearest"})}}}}function WU(t){return t.mozInputSource===0&&t.isTrusted?!0:x_()&&t.pointerType?t.type==="click"&&t.buttons===1:t.detail===0&&!t.pointerType}function Gae(t){return!x_()&&t.width===0&&t.height===0||t.width===1&&t.height===1&&t.pressure===0&&t.detail===0&&t.pointerType==="mouse"}function jae(t,e,n){let r=va(()=>{n&&n(e)});H.useEffect(()=>{var i;let a=t==null||(i=t.current)===null||i===void 0?void 0:i.form;return a?.addEventListener("reset",r),()=>{a?.removeEventListener("reset",r)}},[t,r])}const zae="react-aria-clear-focus",Wae="react-aria-focus";function ug(t){return s0()?t.metaKey:t.ctrlKey}const Hae=typeof Element<"u"&&"checkVisibility"in Element.prototype;function Kae(t){const e=Ml(t);if(!(t instanceof e.HTMLElement)&&!(t instanceof e.SVGElement))return!1;let{display:n,visibility:r}=t.style,i=n!=="none"&&r!=="hidden"&&r!=="collapse";if(i){const{getComputedStyle:a}=t.ownerDocument.defaultView;let{display:o,visibility:s}=a(t);i=o!=="none"&&s!=="hidden"&&s!=="collapse"}return i}function qae(t,e){return!t.hasAttribute("hidden")&&!t.hasAttribute("data-react-aria-prevent-focus")&&(t.nodeName==="DETAILS"&&e&&e.nodeName!=="SUMMARY"?t.hasAttribute("open"):!0)}function b_(t,e){return Hae?t.checkVisibility():t.nodeName!=="#comment"&&Kae(t)&&qae(t,e)&&(!t.parentElement||b_(t.parentElement,t))}const w_=["input:not([disabled]):not([type=hidden])","select:not([disabled])","textarea:not([disabled])","button:not([disabled])","a[href]","area[href]","summary","iframe","object","embed","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable^="false"])',"permission"],Xae=w_.join(":not([hidden]),")+",[tabindex]:not([disabled]):not([hidden])";w_.push('[tabindex]:not([tabindex="-1"]):not([disabled])');const Yae=w_.join(':not([hidden]):not([tabindex="-1"]),');function HU(t){return t.matches(Xae)&&b_(t)&&!KU(t)}function Jae(t){return t.matches(Yae)&&b_(t)&&!KU(t)}function KU(t){let e=t;for(;e!=null;){if(e instanceof e.ownerDocument.defaultView.HTMLElement&&e.inert)return!0;e=e.parentElement}return!1}function $2(t,e,n){let[r,i]=H.useState(t||e),a=H.useRef(t!==void 0),o=t!==void 0;H.useEffect(()=>{a.current,a.current=o},[o]);let s=o?t:r,l=H.useCallback((c,...f)=>{let u=(d,...h)=>{n&&(Object.is(s,d)||n(d,...h)),o||(s=d)};typeof c=="function"?i((h,...p)=>{let g=c(o?s:h,...p);return u(g,...f),o?h:g}):(o||i(c),u(c,...f))},[o,s,n]);return[s,l]}function tE(t,e=-1/0,n=1/0){return Math.min(Math.max(t,e),n)}let AS=new Map;function qU(t){let{locale:e}=ap(),n=e+(t?Object.entries(t).sort((i,a)=>i[0]<a[0]?-1:1).join():"");if(AS.has(n))return AS.get(n);let r=new Intl.Collator(e,t);return AS.set(n,r),r}const e2=H.createContext({});function xw(t){const e=H.useRef(null);return e.current===null&&(e.current=t()),e.current}const C_=typeof window<"u",S_=C_?H.useLayoutEffect:H.useEffect,G2=H.createContext(null);function T_(t,e){t.indexOf(e)===-1&&t.push(e)}function E_(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}function AGe([...t],e,n){const r=e<0?t.length+e:e;if(r>=0&&r<t.length){const i=n<0?t.length+n:n,[a]=t.splice(e,1);t.splice(i,0,a)}return t}const Af=(t,e,n)=>n>e?e:n<t?t:n;let PGe=()=>{},__=()=>{};const hu={},XU=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t);function YU(t){return typeof t=="object"&&t!==null}const JU=t=>/^0[^.\s]+$/u.test(t);function D_(t){let e;return()=>(e===void 0&&(e=t()),e)}const Rl=t=>t,Zae=(t,e)=>n=>e(t(n)),j2=(...t)=>t.reduce(Zae),t2=(t,e,n)=>{const r=e-t;return r===0?1:(n-t)/r};class O_{constructor(){this.subscriptions=[]}add(e){return T_(this.subscriptions,e),()=>E_(this.subscriptions,e)}notify(e,n,r){const i=this.subscriptions.length;if(i)if(i===1)this.subscriptions[0](e,n,r);else for(let a=0;a<i;a++){const o=this.subscriptions[a];o&&o(e,n,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const ru=t=>t*1e3,iu=t=>t/1e3;function ZU(t,e){return e?t*(1e3/e):0}const QU=(t,e,n)=>(((1-3*n+3*e)*t+(3*n-6*e))*t+3*e)*t,Qae=1e-7,eoe=12;function toe(t,e,n,r,i){let a,o,s=0;do o=e+(n-e)/2,a=QU(o,r,i)-t,a>0?n=o:e=o;while(Math.abs(a)>Qae&&++s<eoe);return o}function z2(t,e,n,r){if(t===e&&n===r)return Rl;const i=a=>toe(a,0,1,t,n);return a=>a===0||a===1?a:QU(i(a),e,r)}const eB=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,tB=t=>e=>1-t(1-e),nB=z2(.33,1.53,.69,.99),M_=tB(nB),rB=eB(M_),iB=t=>(t*=2)<1?.5*M_(t):.5*(2-Math.pow(2,-10*(t-1))),I_=t=>1-Math.sin(Math.acos(t)),aB=tB(I_),oB=eB(I_),noe=z2(.42,0,1,1),roe=z2(0,0,.58,1),sB=z2(.42,0,.58,1),ioe=t=>Array.isArray(t)&&typeof t[0]!="number",lB=t=>Array.isArray(t)&&typeof t[0]=="number",aoe={linear:Rl,easeIn:noe,easeInOut:sB,easeOut:roe,circIn:I_,circInOut:oB,circOut:aB,backIn:M_,backInOut:rB,backOut:nB,anticipate:iB},ooe=t=>typeof t=="string",RR=t=>{if(lB(t)){__(t.length===4);const[e,n,r,i]=t;return z2(e,n,r,i)}else if(ooe(t))return aoe[t];return t},_5=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"],Yc={value:null,addProjectionMetrics:null};function soe(t,e){let n=new Set,r=new Set,i=!1,a=!1;const o=new WeakSet;let s={delta:0,timestamp:0,isProcessing:!1},l=0;function c(u){o.has(u)&&(f.schedule(u),t()),l++,u(s)}const f={schedule:(u,d=!1,h=!1)=>{const g=h&&i?n:r;return d&&o.add(u),g.has(u)||g.add(u),u},cancel:u=>{r.delete(u),o.delete(u)},process:u=>{if(s=u,i){a=!0;return}i=!0,[n,r]=[r,n],n.forEach(c),e&&Yc.value&&Yc.value.frameloop[e].push(l),l=0,n.clear(),i=!1,a&&(a=!1,f.process(u))}};return f}const loe=40;function cB(t,e){let n=!1,r=!0;const i={delta:0,timestamp:0,isProcessing:!1},a=()=>n=!0,o=_5.reduce((x,w)=>(x[w]=soe(a,e?w:void 0),x),{}),{setup:s,read:l,resolveKeyframes:c,preUpdate:f,update:u,preRender:d,render:h,postRender:p}=o,g=()=>{const x=hu.useManualTiming?i.timestamp:performance.now();n=!1,hu.useManualTiming||(i.delta=r?1e3/60:Math.max(Math.min(x-i.timestamp,loe),1)),i.timestamp=x,i.isProcessing=!0,s.process(i),l.process(i),c.process(i),f.process(i),u.process(i),d.process(i),h.process(i),p.process(i),i.isProcessing=!1,n&&e&&(r=!1,t(g))},m=()=>{n=!0,r=!0,i.isProcessing||t(g)};return{schedule:_5.reduce((x,w)=>{const S=o[w];return x[w]=(T,_=!1,D=!1)=>(n||m(),S.schedule(T,_,D)),x},{}),cancel:x=>{for(let w=0;w<_5.length;w++)o[_5[w]].cancel(x)},state:i,steps:o}}const{schedule:ui,cancel:c0,state:ro,steps:PS}=cB(typeof requestAnimationFrame<"u"?requestAnimationFrame:Rl,!0);let $x;function coe(){$x=void 0}const ws={now:()=>($x===void 0&&ws.set(ro.isProcessing||hu.useManualTiming?ro.timestamp:performance.now()),$x),set:t=>{$x=t,queueMicrotask(coe)}},Ah={layout:0,mainThread:0,waapi:0},uB=t=>e=>typeof e=="string"&&e.startsWith(t),R_=uB("--"),uoe=uB("var(--"),A_=t=>uoe(t)?foe.test(t.split("/*")[0].trim()):!1,foe=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,Sm={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},n2={...Sm,transform:t=>Af(0,1,t)},D5={...Sm,default:1},_v=t=>Math.round(t*1e5)/1e5,P_=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function doe(t){return t==null}const hoe=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,N_=(t,e)=>n=>!!(typeof n=="string"&&hoe.test(n)&&n.startsWith(t)||e&&!doe(n)&&Object.prototype.hasOwnProperty.call(n,e)),fB=(t,e,n)=>r=>{if(typeof r!="string")return r;const[i,a,o,s]=r.match(P_);return{[t]:parseFloat(i),[e]:parseFloat(a),[n]:parseFloat(o),alpha:s!==void 0?parseFloat(s):1}},poe=t=>Af(0,255,t),NS={...Sm,transform:t=>Math.round(poe(t))},wh={test:N_("rgb","red"),parse:fB("red","green","blue"),transform:({red:t,green:e,blue:n,alpha:r=1})=>"rgba("+NS.transform(t)+", "+NS.transform(e)+", "+NS.transform(n)+", "+_v(n2.transform(r))+")"};function goe(t){let e="",n="",r="",i="";return t.length>5?(e=t.substring(1,3),n=t.substring(3,5),r=t.substring(5,7),i=t.substring(7,9)):(e=t.substring(1,2),n=t.substring(2,3),r=t.substring(3,4),i=t.substring(4,5),e+=e,n+=n,r+=r,i+=i),{red:parseInt(e,16),green:parseInt(n,16),blue:parseInt(r,16),alpha:i?parseInt(i,16)/255:1}}const nE={test:N_("#"),parse:goe,transform:wh.transform},W2=t=>({test:e=>typeof e=="string"&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),wd=W2("deg"),au=W2("%"),Sn=W2("px"),moe=W2("vh"),voe=W2("vw"),AR={...au,parse:t=>au.parse(t)/100,transform:t=>au.transform(t*100)},hg={test:N_("hsl","hue"),parse:fB("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:n,alpha:r=1})=>"hsla("+Math.round(t)+", "+au.transform(_v(e))+", "+au.transform(_v(n))+", "+_v(n2.transform(r))+")"},pa={test:t=>wh.test(t)||nE.test(t)||hg.test(t),parse:t=>wh.test(t)?wh.parse(t):hg.test(t)?hg.parse(t):nE.parse(t),transform:t=>typeof t=="string"?t:t.hasOwnProperty("red")?wh.transform(t):hg.transform(t),getAnimatableNone:t=>{const e=pa.parse(t);return e.alpha=0,pa.transform(e)}},yoe=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function xoe(t){return isNaN(t)&&typeof t=="string"&&(t.match(P_)?.length||0)+(t.match(yoe)?.length||0)>0}const dB="number",hB="color",boe="var",woe="var(",PR="${}",Coe=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function r2(t){const e=t.toString(),n=[],r={color:[],number:[],var:[]},i=[];let a=0;const s=e.replace(Coe,l=>(pa.test(l)?(r.color.push(a),i.push(hB),n.push(pa.parse(l))):l.startsWith(woe)?(r.var.push(a),i.push(boe),n.push(l)):(r.number.push(a),i.push(dB),n.push(parseFloat(l))),++a,PR)).split(PR);return{values:n,split:s,indexes:r,types:i}}function pB(t){return r2(t).values}function gB(t){const{split:e,types:n}=r2(t),r=e.length;return i=>{let a="";for(let o=0;o<r;o++)if(a+=e[o],i[o]!==void 0){const s=n[o];s===dB?a+=_v(i[o]):s===hB?a+=pa.transform(i[o]):a+=i[o]}return a}}const Soe=t=>typeof t=="number"?0:pa.test(t)?pa.getAnimatableNone(t):t;function Toe(t){const e=pB(t);return gB(t)(e.map(Soe))}const u0={test:xoe,parse:pB,createTransformer:gB,getAnimatableNone:Toe};function LS(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function Eoe({hue:t,saturation:e,lightness:n,alpha:r}){t/=360,e/=100,n/=100;let i=0,a=0,o=0;if(!e)i=a=o=n;else{const s=n<.5?n*(1+e):n+e-n*e,l=2*n-s;i=LS(l,s,t+1/3),a=LS(l,s,t),o=LS(l,s,t-1/3)}return{red:Math.round(i*255),green:Math.round(a*255),blue:Math.round(o*255),alpha:r}}function kb(t,e){return n=>n>0?e:t}const _i=(t,e,n)=>t+(e-t)*n,kS=(t,e,n)=>{const r=t*t,i=n*(e*e-r)+r;return i<0?0:Math.sqrt(i)},_oe=[nE,wh,hg],Doe=t=>_oe.find(e=>e.test(t));function NR(t){const e=Doe(t);if(!e)return!1;let n=e.parse(t);return e===hg&&(n=Eoe(n)),n}const LR=(t,e)=>{const n=NR(t),r=NR(e);if(!n||!r)return kb(t,e);const i={...n};return a=>(i.red=kS(n.red,r.red,a),i.green=kS(n.green,r.green,a),i.blue=kS(n.blue,r.blue,a),i.alpha=_i(n.alpha,r.alpha,a),wh.transform(i))},rE=new Set(["none","hidden"]);function Ooe(t,e){return rE.has(t)?n=>n<=0?t:e:n=>n>=1?e:t}function Moe(t,e){return n=>_i(t,e,n)}function L_(t){return typeof t=="number"?Moe:typeof t=="string"?A_(t)?kb:pa.test(t)?LR:Aoe:Array.isArray(t)?mB:typeof t=="object"?pa.test(t)?LR:Ioe:kb}function mB(t,e){const n=[...t],r=n.length,i=t.map((a,o)=>L_(a)(a,e[o]));return a=>{for(let o=0;o<r;o++)n[o]=i[o](a);return n}}function Ioe(t,e){const n={...t,...e},r={};for(const i in n)t[i]!==void 0&&e[i]!==void 0&&(r[i]=L_(t[i])(t[i],e[i]));return i=>{for(const a in r)n[a]=r[a](i);return n}}function Roe(t,e){const n=[],r={color:0,var:0,number:0};for(let i=0;i<e.values.length;i++){const a=e.types[i],o=t.indexes[a][r[a]],s=t.values[o]??0;n[i]=s,r[a]++}return n}const Aoe=(t,e)=>{const n=u0.createTransformer(e),r=r2(t),i=r2(e);return r.indexes.var.length===i.indexes.var.length&&r.indexes.color.length===i.indexes.color.length&&r.indexes.number.length>=i.indexes.number.length?rE.has(t)&&!i.values.length||rE.has(e)&&!r.values.length?Ooe(t,e):j2(mB(Roe(r,i),i.values),n):kb(t,e)};function vB(t,e,n){return typeof t=="number"&&typeof e=="number"&&typeof n=="number"?_i(t,e,n):L_(t)(t,e)}const Poe=t=>{const e=({timestamp:n})=>t(n);return{start:(n=!0)=>ui.update(e,n),stop:()=>c0(e),now:()=>ro.isProcessing?ro.timestamp:ws.now()}},yB=(t,e,n=10)=>{let r="";const i=Math.max(Math.round(e/n),2);for(let a=0;a<i;a++)r+=Math.round(t(a/(i-1))*1e4)/1e4+", ";return`linear(${r.substring(0,r.length-2)})`},Vb=2e4;function k_(t){let e=0;const n=50;let r=t.next(e);for(;!r.done&&e<Vb;)e+=n,r=t.next(e);return e>=Vb?1/0:e}function Noe(t,e=100,n){const r=n({...t,keyframes:[0,e]}),i=Math.min(k_(r),Vb);return{type:"keyframes",ease:a=>r.next(i*a).value/e,duration:iu(i)}}const Loe=5;function xB(t,e,n){const r=Math.max(e-Loe,0);return ZU(n-t(r),e-r)}const ji={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},VS=.001;function koe({duration:t=ji.duration,bounce:e=ji.bounce,velocity:n=ji.velocity,mass:r=ji.mass}){let i,a,o=1-e;o=Af(ji.minDamping,ji.maxDamping,o),t=Af(ji.minDuration,ji.maxDuration,iu(t)),o<1?(i=c=>{const f=c*o,u=f*t,d=f-n,h=iE(c,o),p=Math.exp(-u);return VS-d/h*p},a=c=>{const u=c*o*t,d=u*n+n,h=Math.pow(o,2)*Math.pow(c,2)*t,p=Math.exp(-u),g=iE(Math.pow(c,2),o);return(-i(c)+VS>0?-1:1)*((d-h)*p)/g}):(i=c=>{const f=Math.exp(-c*t),u=(c-n)*t+1;return-VS+f*u},a=c=>{const f=Math.exp(-c*t),u=(n-c)*(t*t);return f*u});const s=5/t,l=Foe(i,a,s);if(t=ru(t),isNaN(l))return{stiffness:ji.stiffness,damping:ji.damping,duration:t};{const c=Math.pow(l,2)*r;return{stiffness:c,damping:o*2*Math.sqrt(r*c),duration:t}}}const Voe=12;function Foe(t,e,n){let r=n;for(let i=1;i<Voe;i++)r=r-t(r)/e(r);return r}function iE(t,e){return t*Math.sqrt(1-e*e)}const Uoe=["duration","bounce"],Boe=["stiffness","damping","mass"];function kR(t,e){return e.some(n=>t[n]!==void 0)}function $oe(t){let e={velocity:ji.velocity,stiffness:ji.stiffness,damping:ji.damping,mass:ji.mass,isResolvedFromDuration:!1,...t};if(!kR(t,Boe)&&kR(t,Uoe))if(t.visualDuration){const n=t.visualDuration,r=2*Math.PI/(n*1.2),i=r*r,a=2*Af(.05,1,1-(t.bounce||0))*Math.sqrt(i);e={...e,mass:ji.mass,stiffness:i,damping:a}}else{const n=koe(t);e={...e,...n,mass:ji.mass},e.isResolvedFromDuration=!0}return e}function Fb(t=ji.visualDuration,e=ji.bounce){const n=typeof t!="object"?{visualDuration:t,keyframes:[0,1],bounce:e}:t;let{restSpeed:r,restDelta:i}=n;const a=n.keyframes[0],o=n.keyframes[n.keyframes.length-1],s={done:!1,value:a},{stiffness:l,damping:c,mass:f,duration:u,velocity:d,isResolvedFromDuration:h}=$oe({...n,velocity:-iu(n.velocity||0)}),p=d||0,g=c/(2*Math.sqrt(l*f)),m=o-a,y=iu(Math.sqrt(l/f)),v=Math.abs(m)<5;r||(r=v?ji.restSpeed.granular:ji.restSpeed.default),i||(i=v?ji.restDelta.granular:ji.restDelta.default);let x;if(g<1){const S=iE(y,g);x=T=>{const _=Math.exp(-g*y*T);return o-_*((p+g*y*m)/S*Math.sin(S*T)+m*Math.cos(S*T))}}else if(g===1)x=S=>o-Math.exp(-y*S)*(m+(p+y*m)*S);else{const S=y*Math.sqrt(g*g-1);x=T=>{const _=Math.exp(-g*y*T),D=Math.min(S*T,300);return o-_*((p+g*y*m)*Math.sinh(D)+S*m*Math.cosh(D))/S}}const w={calculatedDuration:h&&u||null,next:S=>{const T=x(S);if(h)s.done=S>=u;else{let _=S===0?p:0;g<1&&(_=S===0?ru(p):xB(x,S,T));const D=Math.abs(_)<=r,I=Math.abs(o-T)<=i;s.done=D&&I}return s.value=s.done?o:T,s},toString:()=>{const S=Math.min(k_(w),Vb),T=yB(_=>w.next(S*_).value,S,30);return S+"ms "+T},toTransition:()=>{}};return w}Fb.applyToOptions=t=>{const e=Noe(t,100,Fb);return t.ease=e.ease,t.duration=ru(e.duration),t.type="keyframes",t};function aE({keyframes:t,velocity:e=0,power:n=.8,timeConstant:r=325,bounceDamping:i=10,bounceStiffness:a=500,modifyTarget:o,min:s,max:l,restDelta:c=.5,restSpeed:f}){const u=t[0],d={done:!1,value:u},h=D=>s!==void 0&&D<s||l!==void 0&&D>l,p=D=>s===void 0?l:l===void 0||Math.abs(s-D)<Math.abs(l-D)?s:l;let g=n*e;const m=u+g,y=o===void 0?m:o(m);y!==m&&(g=y-u);const v=D=>-g*Math.exp(-D/r),x=D=>y+v(D),w=D=>{const I=v(D),R=x(D);d.done=Math.abs(I)<=c,d.value=d.done?y:R};let S,T;const _=D=>{h(d.value)&&(S=D,T=Fb({keyframes:[d.value,p(d.value)],velocity:xB(x,D,d.value),damping:i,stiffness:a,restDelta:c,restSpeed:f}))};return _(0),{calculatedDuration:null,next:D=>{let I=!1;return!T&&S===void 0&&(I=!0,w(D),_(D)),S!==void 0&&D>=S?T.next(D-S):(!I&&w(D),d)}}}function Goe(t,e,n){const r=[],i=n||hu.mix||vB,a=t.length-1;for(let o=0;o<a;o++){let s=i(t[o],t[o+1]);if(e){const l=Array.isArray(e)?e[o]||Rl:e;s=j2(l,s)}r.push(s)}return r}function joe(t,e,{clamp:n=!0,ease:r,mixer:i}={}){const a=t.length;if(__(a===e.length),a===1)return()=>e[0];if(a===2&&e[0]===e[1])return()=>e[1];const o=t[0]===t[1];t[0]>t[a-1]&&(t=[...t].reverse(),e=[...e].reverse());const s=Goe(e,r,i),l=s.length,c=f=>{if(o&&f<t[0])return e[0];let u=0;if(l>1)for(;u<t.length-2&&!(f<t[u+1]);u++);const d=t2(t[u],t[u+1],f);return s[u](d)};return n?f=>c(Af(t[0],t[a-1],f)):c}function zoe(t,e){const n=t[t.length-1];for(let r=1;r<=e;r++){const i=t2(0,e,r);t.push(_i(n,1,i))}}function Woe(t){const e=[0];return zoe(e,t.length-1),e}function Hoe(t,e){return t.map(n=>n*e)}function Koe(t,e){return t.map(()=>e||sB).splice(0,t.length-1)}function Dv({duration:t=300,keyframes:e,times:n,ease:r="easeInOut"}){const i=ioe(r)?r.map(RR):RR(r),a={done:!1,value:e[0]},o=Hoe(n&&n.length===e.length?n:Woe(e),t),s=joe(o,e,{ease:Array.isArray(i)?i:Koe(e,i)});return{calculatedDuration:t,next:l=>(a.value=s(l),a.done=l>=t,a)}}const qoe=t=>t!==null;function V_(t,{repeat:e,repeatType:n="loop"},r,i=1){const a=t.filter(qoe),s=i<0||e&&n!=="loop"&&e%2===1?0:a.length-1;return!s||r===void 0?a[s]:r}const Xoe={decay:aE,inertia:aE,tween:Dv,keyframes:Dv,spring:Fb};function bB(t){typeof t.type=="string"&&(t.type=Xoe[t.type])}class F_{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(e=>{this.resolve=e})}notifyFinished(){this.resolve()}then(e,n){return this.finished.then(e,n)}}const Yoe=t=>t/100;class bw extends F_{constructor(e){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:n}=this.options;n&&n.updatedAt!==ws.now()&&this.tick(ws.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),this.options.onStop?.())},Ah.mainThread++,this.options=e,this.initAnimation(),this.play(),e.autoplay===!1&&this.pause()}initAnimation(){const{options:e}=this;bB(e);const{type:n=Dv,repeat:r=0,repeatDelay:i=0,repeatType:a,velocity:o=0}=e;let{keyframes:s}=e;const l=n||Dv;l!==Dv&&typeof s[0]!="number"&&(this.mixKeyframes=j2(Yoe,vB(s[0],s[1])),s=[0,100]);const c=l({...e,keyframes:s});a==="mirror"&&(this.mirroredGenerator=l({...e,keyframes:[...s].reverse(),velocity:-o})),c.calculatedDuration===null&&(c.calculatedDuration=k_(c));const{calculatedDuration:f}=c;this.calculatedDuration=f,this.resolvedDuration=f+i,this.totalDuration=this.resolvedDuration*(r+1)-i,this.generator=c}updateTime(e){const n=Math.round(e-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=n}tick(e,n=!1){const{generator:r,totalDuration:i,mixKeyframes:a,mirroredGenerator:o,resolvedDuration:s,calculatedDuration:l}=this;if(this.startTime===null)return r.next(0);const{delay:c=0,keyframes:f,repeat:u,repeatType:d,repeatDelay:h,type:p,onUpdate:g,finalKeyframe:m}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-i/this.speed,this.startTime)),n?this.currentTime=e:this.updateTime(e);const y=this.currentTime-c*(this.playbackSpeed>=0?1:-1),v=this.playbackSpeed>=0?y<0:y>i;this.currentTime=Math.max(y,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=i);let x=this.currentTime,w=r;if(u){const D=Math.min(this.currentTime,i)/s;let I=Math.floor(D),R=D%1;!R&&D>=1&&(R=1),R===1&&I--,I=Math.min(I,u+1),!!(I%2)&&(d==="reverse"?(R=1-R,h&&(R-=h/s)):d==="mirror"&&(w=o)),x=Af(0,1,R)*s}const S=v?{done:!1,value:f[0]}:w.next(x);a&&(S.value=a(S.value));let{done:T}=S;!v&&l!==null&&(T=this.playbackSpeed>=0?this.currentTime>=i:this.currentTime<=0);const _=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&T);return _&&p!==aE&&(S.value=V_(f,this.options,m,this.speed)),g&&g(S.value),_&&this.finish(),S}then(e,n){return this.finished.then(e,n)}get duration(){return iu(this.calculatedDuration)}get time(){return iu(this.currentTime)}set time(e){e=ru(e),this.currentTime=e,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.playbackSpeed),this.driver?.start(!1)}get speed(){return this.playbackSpeed}set speed(e){this.updateTime(ws.now());const n=this.playbackSpeed!==e;this.playbackSpeed=e,n&&(this.time=iu(this.currentTime))}play(){if(this.isStopped)return;const{driver:e=Poe,startTime:n}=this.options;this.driver||(this.driver=e(i=>this.tick(i))),this.options.onPlay?.();const r=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=r):this.holdTime!==null?this.startTime=r-this.holdTime:this.startTime||(this.startTime=n??r),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(ws.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished",this.options.onComplete?.()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),this.options.onCancel?.()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null,Ah.mainThread--}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}attachTimeline(e){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),this.driver?.stop(),e.observe(this)}}function NGe(t){return new bw(t)}function Joe(t){for(let e=1;e<t.length;e++)t[e]??(t[e]=t[e-1])}const Ch=t=>t*180/Math.PI,oE=t=>{const e=Ch(Math.atan2(t[1],t[0]));return sE(e)},Zoe={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:t=>(Math.abs(t[0])+Math.abs(t[3]))/2,rotate:oE,rotateZ:oE,skewX:t=>Ch(Math.atan(t[1])),skewY:t=>Ch(Math.atan(t[2])),skew:t=>(Math.abs(t[1])+Math.abs(t[2]))/2},sE=t=>(t=t%360,t<0&&(t+=360),t),VR=oE,FR=t=>Math.sqrt(t[0]*t[0]+t[1]*t[1]),UR=t=>Math.sqrt(t[4]*t[4]+t[5]*t[5]),Qoe={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:FR,scaleY:UR,scale:t=>(FR(t)+UR(t))/2,rotateX:t=>sE(Ch(Math.atan2(t[6],t[5]))),rotateY:t=>sE(Ch(Math.atan2(-t[2],t[0]))),rotateZ:VR,rotate:VR,skewX:t=>Ch(Math.atan(t[4])),skewY:t=>Ch(Math.atan(t[1])),skew:t=>(Math.abs(t[1])+Math.abs(t[4]))/2};function lE(t){return t.includes("scale")?1:0}function cE(t,e){if(!t||t==="none")return lE(e);const n=t.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let r,i;if(n)r=Qoe,i=n;else{const s=t.match(/^matrix\(([-\d.e\s,]+)\)$/u);r=Zoe,i=s}if(!i)return lE(e);const a=r[e],o=i[1].split(",").map(tse);return typeof a=="function"?a(o):o[a]}const ese=(t,e)=>{const{transform:n="none"}=getComputedStyle(t);return cE(n,e)};function tse(t){return parseFloat(t.trim())}const Tm=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Em=new Set(Tm),BR=t=>t===Sm||t===Sn,nse=new Set(["x","y","z"]),rse=Tm.filter(t=>!nse.has(t));function ise(t){const e=[];return rse.forEach(n=>{const r=t.getValue(n);r!==void 0&&(e.push([n,r.get()]),r.set(n.startsWith("scale")?1:0))}),e}const Ph={width:({x:t},{paddingLeft:e="0",paddingRight:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),height:({y:t},{paddingTop:e="0",paddingBottom:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:(t,{transform:e})=>cE(e,"x"),y:(t,{transform:e})=>cE(e,"y")};Ph.translateX=Ph.x;Ph.translateY=Ph.y;const Nh=new Set;let uE=!1,fE=!1,dE=!1;function wB(){if(fE){const t=Array.from(Nh).filter(r=>r.needsMeasurement),e=new Set(t.map(r=>r.element)),n=new Map;e.forEach(r=>{const i=ise(r);i.length&&(n.set(r,i),r.render())}),t.forEach(r=>r.measureInitialState()),e.forEach(r=>{r.render();const i=n.get(r);i&&i.forEach(([a,o])=>{r.getValue(a)?.set(o)})}),t.forEach(r=>r.measureEndState()),t.forEach(r=>{r.suspendedScrollY!==void 0&&window.scrollTo(0,r.suspendedScrollY)})}fE=!1,uE=!1,Nh.forEach(t=>t.complete(dE)),Nh.clear()}function CB(){Nh.forEach(t=>{t.readKeyframes(),t.needsMeasurement&&(fE=!0)})}function ase(){dE=!0,CB(),wB(),dE=!1}class U_{constructor(e,n,r,i,a,o=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...e],this.onComplete=n,this.name=r,this.motionValue=i,this.element=a,this.isAsync=o}scheduleResolve(){this.state="scheduled",this.isAsync?(Nh.add(this),uE||(uE=!0,ui.read(CB),ui.resolveKeyframes(wB))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:n,element:r,motionValue:i}=this;if(e[0]===null){const a=i?.get(),o=e[e.length-1];if(a!==void 0)e[0]=a;else if(r&&n){const s=r.readValue(n,o);s!=null&&(e[0]=s)}e[0]===void 0&&(e[0]=o),i&&a===void 0&&i.set(e[0])}Joe(e)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(e=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,e),Nh.delete(this)}cancel(){this.state==="scheduled"&&(Nh.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const ose=t=>t.startsWith("--");function sse(t,e,n){ose(e)?t.style.setProperty(e,n):t.style[e]=n}const lse=D_(()=>window.ScrollTimeline!==void 0),cse={};function use(t,e){const n=D_(t);return()=>cse[e]??n()}const SB=use(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),cv=([t,e,n,r])=>`cubic-bezier(${t}, ${e}, ${n}, ${r})`,$R={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:cv([0,.65,.55,1]),circOut:cv([.55,0,1,.45]),backIn:cv([.31,.01,.66,-.59]),backOut:cv([.33,1.53,.69,.99])};function TB(t,e){if(t)return typeof t=="function"?SB()?yB(t,e):"ease-out":lB(t)?cv(t):Array.isArray(t)?t.map(n=>TB(n,e)||$R.easeOut):$R[t]}function fse(t,e,n,{delay:r=0,duration:i=300,repeat:a=0,repeatType:o="loop",ease:s="easeOut",times:l}={},c=void 0){const f={[e]:n};l&&(f.offset=l);const u=TB(s,i);Array.isArray(u)&&(f.easing=u),Yc.value&&Ah.waapi++;const d={delay:r,duration:i,easing:Array.isArray(u)?"linear":u,fill:"both",iterations:a+1,direction:o==="reverse"?"alternate":"normal"};c&&(d.pseudoElement=c);const h=t.animate(f,d);return Yc.value&&h.finished.finally(()=>{Ah.waapi--}),h}function EB(t){return typeof t=="function"&&"applyToOptions"in t}function dse({type:t,...e}){return EB(t)&&SB()?t.applyToOptions(e):(e.duration??(e.duration=300),e.ease??(e.ease="easeOut"),e)}class hse extends F_{constructor(e){if(super(),this.finishedTime=null,this.isStopped=!1,!e)return;const{element:n,name:r,keyframes:i,pseudoElement:a,allowFlatten:o=!1,finalKeyframe:s,onComplete:l}=e;this.isPseudoElement=!!a,this.allowFlatten=o,this.options=e,__(typeof e.type!="string");const c=dse(e);this.animation=fse(n,r,i,c,a),c.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!a){const f=V_(i,this.options,s,this.speed);this.updateMotionValue?this.updateMotionValue(f):sse(n,r,f),this.animation.cancel()}l?.(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){this.animation.finish?.()}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:e}=this;e==="idle"||e==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){this.isPseudoElement||this.animation.commitStyles?.()}get duration(){const e=this.animation.effect?.getComputedTiming?.().duration||0;return iu(Number(e))}get time(){return iu(Number(this.animation.currentTime)||0)}set time(e){this.finishedTime=null,this.animation.currentTime=ru(e)}get speed(){return this.animation.playbackRate}set speed(e){e<0&&(this.finishedTime=null),this.animation.playbackRate=e}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(e){this.animation.startTime=e}attachTimeline({timeline:e,observe:n}){return this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"}),this.animation.onfinish=null,e&&lse()?(this.animation.timeline=e,Rl):n(this)}}const _B={anticipate:iB,backInOut:rB,circInOut:oB};function pse(t){return t in _B}function gse(t){typeof t.ease=="string"&&pse(t.ease)&&(t.ease=_B[t.ease])}const GR=10;class mse extends hse{constructor(e){gse(e),bB(e),super(e),e.startTime&&(this.startTime=e.startTime),this.options=e}updateMotionValue(e){const{motionValue:n,onUpdate:r,onComplete:i,element:a,...o}=this.options;if(!n)return;if(e!==void 0){n.set(e);return}const s=new bw({...o,autoplay:!1}),l=ru(this.finishedTime??this.time);n.setWithVelocity(s.sample(l-GR).value,s.sample(l).value,GR),s.stop()}}const jR=(t,e)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(u0.test(t)||t==="0")&&!t.startsWith("url("));function vse(t){const e=t[0];if(t.length===1)return!0;for(let n=0;n<t.length;n++)if(t[n]!==e)return!0}function yse(t,e,n,r){const i=t[0];if(i===null)return!1;if(e==="display"||e==="visibility")return!0;const a=t[t.length-1],o=jR(i,e),s=jR(a,e);return!o||!s?!1:vse(t)||(n==="spring"||EB(n))&&r}function hE(t){t.duration=0,t.type}const xse=new Set(["opacity","clipPath","filter","transform"]),bse=D_(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function wse(t){const{motionValue:e,name:n,repeatDelay:r,repeatType:i,damping:a,type:o}=t;if(!(e?.owner?.current instanceof HTMLElement))return!1;const{onUpdate:l,transformTemplate:c}=e.owner.getProps();return bse()&&n&&xse.has(n)&&(n!=="transform"||!c)&&!l&&!r&&i!=="mirror"&&a!==0&&o!=="inertia"}const Cse=40;class Sse extends F_{constructor({autoplay:e=!0,delay:n=0,type:r="keyframes",repeat:i=0,repeatDelay:a=0,repeatType:o="loop",keyframes:s,name:l,motionValue:c,element:f,...u}){super(),this.stop=()=>{this._animation&&(this._animation.stop(),this.stopTimeline?.()),this.keyframeResolver?.cancel()},this.createdAt=ws.now();const d={autoplay:e,delay:n,type:r,repeat:i,repeatDelay:a,repeatType:o,name:l,motionValue:c,element:f,...u},h=f?.KeyframeResolver||U_;this.keyframeResolver=new h(s,(p,g,m)=>this.onKeyframesResolved(p,g,d,!m),l,c,f),this.keyframeResolver?.scheduleResolve()}onKeyframesResolved(e,n,r,i){this.keyframeResolver=void 0;const{name:a,type:o,velocity:s,delay:l,isHandoff:c,onUpdate:f}=r;this.resolvedAt=ws.now(),yse(e,a,o,s)||((hu.instantAnimations||!l)&&f?.(V_(e,r,n)),e[0]=e[e.length-1],hE(r),r.repeat=0);const d={startTime:i?this.resolvedAt?this.resolvedAt-this.createdAt>Cse?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:n,...r,keyframes:e},h=!c&&wse(d)?new mse({...d,element:d.motionValue.owner.current}):new bw(d);h.finished.then(()=>this.notifyFinished()).catch(Rl),this.pendingTimeline&&(this.stopTimeline=h.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=h}get finished(){return this._animation?this.animation.finished:this._finished}then(e,n){return this.finished.finally(e).then(()=>{})}get animation(){return this._animation||(this.keyframeResolver?.resume(),ase()),this._animation}get duration(){return this.animation.duration}get time(){return this.animation.time}set time(e){this.animation.time=e}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(e){this.animation.speed=e}get startTime(){return this.animation.startTime}attachTimeline(e){return this._animation?this.stopTimeline=this.animation.attachTimeline(e):this.pendingTimeline=e,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this._animation&&this.animation.cancel(),this.keyframeResolver?.cancel()}}const Tse=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function Ese(t){const e=Tse.exec(t);if(!e)return[,];const[,n,r,i]=e;return[`--${n??r}`,i]}function DB(t,e,n=1){const[r,i]=Ese(t);if(!r)return;const a=window.getComputedStyle(e).getPropertyValue(r);if(a){const o=a.trim();return XU(o)?parseFloat(o):o}return A_(i)?DB(i,e,n+1):i}function B_(t,e){return t?.[e]??t?.default??t}const OB=new Set(["width","height","top","left","right","bottom",...Tm]),_se={test:t=>t==="auto",parse:t=>t},MB=t=>e=>e.test(t),IB=[Sm,Sn,au,wd,voe,moe,_se],zR=t=>IB.find(MB(t));function Dse(t){return typeof t=="number"?t===0:t!==null?t==="none"||t==="0"||JU(t):!0}const Ose=new Set(["brightness","contrast","saturate","opacity"]);function Mse(t){const[e,n]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[r]=n.match(P_)||[];if(!r)return t;const i=n.replace(r,"");let a=Ose.has(e)?1:0;return r!==n&&(a*=100),e+"("+a+i+")"}const Ise=/\b([a-z-]*)\(.*?\)/gu,pE={...u0,getAnimatableNone:t=>{const e=t.match(Ise);return e?e.map(Mse).join(" "):t}},WR={...Sm,transform:Math.round},Rse={rotate:wd,rotateX:wd,rotateY:wd,rotateZ:wd,scale:D5,scaleX:D5,scaleY:D5,scaleZ:D5,skew:wd,skewX:wd,skewY:wd,distance:Sn,translateX:Sn,translateY:Sn,translateZ:Sn,x:Sn,y:Sn,z:Sn,perspective:Sn,transformPerspective:Sn,opacity:n2,originX:AR,originY:AR,originZ:Sn},$_={borderWidth:Sn,borderTopWidth:Sn,borderRightWidth:Sn,borderBottomWidth:Sn,borderLeftWidth:Sn,borderRadius:Sn,radius:Sn,borderTopLeftRadius:Sn,borderTopRightRadius:Sn,borderBottomRightRadius:Sn,borderBottomLeftRadius:Sn,width:Sn,maxWidth:Sn,height:Sn,maxHeight:Sn,top:Sn,right:Sn,bottom:Sn,left:Sn,padding:Sn,paddingTop:Sn,paddingRight:Sn,paddingBottom:Sn,paddingLeft:Sn,margin:Sn,marginTop:Sn,marginRight:Sn,marginBottom:Sn,marginLeft:Sn,backgroundPositionX:Sn,backgroundPositionY:Sn,...Rse,zIndex:WR,fillOpacity:n2,strokeOpacity:n2,numOctaves:WR},Ase={...$_,color:pa,backgroundColor:pa,outlineColor:pa,fill:pa,stroke:pa,borderColor:pa,borderTopColor:pa,borderRightColor:pa,borderBottomColor:pa,borderLeftColor:pa,filter:pE,WebkitFilter:pE},RB=t=>Ase[t];function AB(t,e){let n=RB(t);return n!==pE&&(n=u0),n.getAnimatableNone?n.getAnimatableNone(e):void 0}const Pse=new Set(["auto","none","0"]);function Nse(t,e,n){let r=0,i;for(;r<t.length&&!i;){const a=t[r];typeof a=="string"&&!Pse.has(a)&&r2(a).values.length&&(i=t[r]),r++}if(i&&n)for(const a of e)t[a]=AB(n,i)}class Lse extends U_{constructor(e,n,r,i,a){super(e,n,r,i,a,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:n,name:r}=this;if(!n||!n.current)return;super.readKeyframes();for(let l=0;l<e.length;l++){let c=e[l];if(typeof c=="string"&&(c=c.trim(),A_(c))){const f=DB(c,n.current);f!==void 0&&(e[l]=f),l===e.length-1&&(this.finalKeyframe=c)}}if(this.resolveNoneKeyframes(),!OB.has(r)||e.length!==2)return;const[i,a]=e,o=zR(i),s=zR(a);if(o!==s)if(BR(o)&&BR(s))for(let l=0;l<e.length;l++){const c=e[l];typeof c=="string"&&(e[l]=parseFloat(c))}else Ph[r]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:n}=this,r=[];for(let i=0;i<e.length;i++)(e[i]===null||Dse(e[i]))&&r.push(i);r.length&&Nse(e,r,n)}measureInitialState(){const{element:e,unresolvedKeyframes:n,name:r}=this;if(!e||!e.current)return;r==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Ph[r](e.measureViewportBox(),window.getComputedStyle(e.current)),n[0]=this.measuredOrigin;const i=n[n.length-1];i!==void 0&&e.getValue(r,i).jump(i,!1)}measureEndState(){const{element:e,name:n,unresolvedKeyframes:r}=this;if(!e||!e.current)return;const i=e.getValue(n);i&&i.jump(this.measuredOrigin,!1);const a=r.length-1,o=r[a];r[a]=Ph[n](e.measureViewportBox(),window.getComputedStyle(e.current)),o!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=o),this.removedTransforms?.length&&this.removedTransforms.forEach(([s,l])=>{e.getValue(s).set(l)}),this.resolveNoneKeyframes()}}function kse(t,e,n){if(t instanceof EventTarget)return[t];if(typeof t=="string"){let r=document;e&&(r=e.current);const i=n?.[t]??r.querySelectorAll(t);return i?Array.from(i):[]}return Array.from(t)}const PB=(t,e)=>e&&typeof t=="number"?e.transform(t):t;function NB(t){return YU(t)&&"offsetHeight"in t}const HR=30,Vse=t=>!isNaN(parseFloat(t)),KR={current:void 0};class Fse{constructor(e,n={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=r=>{const i=ws.now();if(this.updatedAt!==i&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(r),this.current!==this.prev&&(this.events.change?.notify(this.current),this.dependents))for(const a of this.dependents)a.dirty()},this.hasAnimated=!1,this.setCurrent(e),this.owner=n.owner}setCurrent(e){this.current=e,this.updatedAt=ws.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=Vse(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,n){this.events[e]||(this.events[e]=new O_);const r=this.events[e].add(n);return e==="change"?()=>{r(),ui.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,n){this.passiveEffect=e,this.stopPassiveEffect=n}set(e){this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e)}setWithVelocity(e,n,r){this.set(n),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-r}jump(e,n=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,n&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){this.events.change?.notify(this.current)}addDependent(e){this.dependents||(this.dependents=new Set),this.dependents.add(e)}removeDependent(e){this.dependents&&this.dependents.delete(e)}get(){return KR.current&&KR.current.push(this),this.current}getPrevious(){return this.prev}getVelocity(){const e=ws.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>HR)return 0;const n=Math.min(this.updatedAt-this.prevUpdatedAt,HR);return ZU(parseFloat(this.current)-parseFloat(this.prevFrameValue),n)}start(e){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=e(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.dependents?.clear(),this.events.destroy?.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function om(t,e){return new Fse(t,e)}const{schedule:G_,cancel:LGe}=cB(queueMicrotask,!1),nc={x:!1,y:!1};function LB(){return nc.x||nc.y}function Use(t){return t==="x"||t==="y"?nc[t]?null:(nc[t]=!0,()=>{nc[t]=!1}):nc.x||nc.y?null:(nc.x=nc.y=!0,()=>{nc.x=nc.y=!1})}function kB(t,e){const n=kse(t),r=new AbortController,i={passive:!0,...e,signal:r.signal};return[n,i,()=>r.abort()]}function qR(t){return!(t.pointerType==="touch"||LB())}function Bse(t,e,n={}){const[r,i,a]=kB(t,n),o=s=>{if(!qR(s))return;const{target:l}=s,c=e(l,s);if(typeof c!="function"||!l)return;const f=u=>{qR(u)&&(c(u),l.removeEventListener("pointerleave",f))};l.addEventListener("pointerleave",f,i)};return r.forEach(s=>{s.addEventListener("pointerenter",o,i)}),a}const VB=(t,e)=>e?t===e?!0:VB(t,e.parentElement):!1,j_=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1,$se=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function Gse(t){return $se.has(t.tagName)||t.tabIndex!==-1}const Gx=new WeakSet;function XR(t){return e=>{e.key==="Enter"&&t(e)}}function FS(t,e){t.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const jse=(t,e)=>{const n=t.currentTarget;if(!n)return;const r=XR(()=>{if(Gx.has(n))return;FS(n,"down");const i=XR(()=>{FS(n,"up")}),a=()=>FS(n,"cancel");n.addEventListener("keyup",i,e),n.addEventListener("blur",a,e)});n.addEventListener("keydown",r,e),n.addEventListener("blur",()=>n.removeEventListener("keydown",r),e)};function YR(t){return j_(t)&&!LB()}function zse(t,e,n={}){const[r,i,a]=kB(t,n),o=s=>{const l=s.currentTarget;if(!YR(s))return;Gx.add(l);const c=e(l,s),f=(h,p)=>{window.removeEventListener("pointerup",u),window.removeEventListener("pointercancel",d),Gx.has(l)&&Gx.delete(l),YR(h)&&typeof c=="function"&&c(h,{success:p})},u=h=>{f(h,l===window||l===document||n.useGlobalTarget||VB(l,h.target))},d=h=>{f(h,!1)};window.addEventListener("pointerup",u,i),window.addEventListener("pointercancel",d,i)};return r.forEach(s=>{(n.useGlobalTarget?window:s).addEventListener("pointerdown",o,i),NB(s)&&(s.addEventListener("focus",c=>jse(c,i)),!Gse(s)&&!s.hasAttribute("tabindex")&&(s.tabIndex=0))}),a}function FB(t){return YU(t)&&"ownerSVGElement"in t}function Wse(t){return FB(t)&&t.tagName==="svg"}const _o=t=>!!(t&&t.getVelocity),Hse=[...IB,pa,u0],Kse=t=>Hse.find(MB(t)),i2=H.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"});class qse extends H.Component{getSnapshotBeforeUpdate(e){const n=this.props.childRef.current;if(n&&e.isPresent&&!this.props.isPresent){const r=n.offsetParent,i=NB(r)&&r.offsetWidth||0,a=this.props.sizeRef.current;a.height=n.offsetHeight||0,a.width=n.offsetWidth||0,a.top=n.offsetTop,a.left=n.offsetLeft,a.right=i-a.width-a.left}return null}componentDidUpdate(){}render(){return this.props.children}}function Xse({children:t,isPresent:e,anchorX:n,root:r}){const i=H.useId(),a=H.useRef(null),o=H.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:s}=H.useContext(i2);return H.useInsertionEffect(()=>{const{width:l,height:c,top:f,left:u,right:d}=o.current;if(e||!a.current||!l||!c)return;const h=n==="left"?`left: ${u}`:`right: ${d}`;a.current.dataset.motionPopId=i;const p=document.createElement("style");s&&(p.nonce=s);const g=r??document.head;return g.appendChild(p),p.sheet&&p.sheet.insertRule(`
          [data-motion-pop-id="${i}"] {
            position: absolute !important;
            width: ${l}px !important;
            height: ${c}px !important;
            ${h}px !important;
            top: ${f}px !important;
          }
        `),()=>{g.contains(p)&&g.removeChild(p)}},[e]),j.jsx(qse,{isPresent:e,childRef:a,sizeRef:o,children:H.cloneElement(t,{ref:a})})}const Yse=({children:t,initial:e,isPresent:n,onExitComplete:r,custom:i,presenceAffectsLayout:a,mode:o,anchorX:s,root:l})=>{const c=xw(Jse),f=H.useId();let u=!0,d=H.useMemo(()=>(u=!1,{id:f,initial:e,isPresent:n,custom:i,onExitComplete:h=>{c.set(h,!0);for(const p of c.values())if(!p)return;r&&r()},register:h=>(c.set(h,!1),()=>c.delete(h))}),[n,c,r]);return a&&u&&(d={...d}),H.useMemo(()=>{c.forEach((h,p)=>c.set(p,!1))},[n]),H.useEffect(()=>{!n&&!c.size&&r&&r()},[n]),o==="popLayout"&&(t=j.jsx(Xse,{isPresent:n,anchorX:s,root:l,children:t})),j.jsx(G2.Provider,{value:d,children:t})};function Jse(){return new Map}function UB(t=!0){const e=H.useContext(G2);if(e===null)return[!0,null];const{isPresent:n,onExitComplete:r,register:i}=e,a=H.useId();H.useEffect(()=>{if(t)return i(a)},[t]);const o=H.useCallback(()=>t&&r&&r(a),[a,r,t]);return!n&&r?[!1,o]:[!0]}function kGe(){return Zse(H.useContext(G2))}function Zse(t){return t===null?!0:t.isPresent}const O5=t=>t.key||"";function JR(t){const e=[];return H.Children.forEach(t,n=>{H.isValidElement(n)&&e.push(n)}),e}const ww=({children:t,custom:e,initial:n=!0,onExitComplete:r,presenceAffectsLayout:i=!0,mode:a="sync",propagate:o=!1,anchorX:s="left",root:l})=>{const[c,f]=UB(o),u=H.useMemo(()=>JR(t),[t]),d=o&&!c?[]:u.map(O5),h=H.useRef(!0),p=H.useRef(u),g=xw(()=>new Map),[m,y]=H.useState(u),[v,x]=H.useState(u);S_(()=>{h.current=!1,p.current=u;for(let T=0;T<v.length;T++){const _=O5(v[T]);d.includes(_)?g.delete(_):g.get(_)!==!0&&g.set(_,!1)}},[v,d.length,d.join("-")]);const w=[];if(u!==m){let T=[...u];for(let _=0;_<v.length;_++){const D=v[_],I=O5(D);d.includes(I)||(T.splice(_,0,D),w.push(D))}return a==="wait"&&w.length&&(T=w),x(JR(T)),y(u),null}const{forceRender:S}=H.useContext(e2);return j.jsx(j.Fragment,{children:v.map(T=>{const _=O5(T),D=o&&!c?!1:u===v||d.includes(_),I=()=>{if(g.has(_))g.set(_,!0);else return;let R=!0;g.forEach(M=>{M||(R=!1)}),R&&(S?.(),x(p.current),o&&f?.(),r&&r())};return j.jsx(Yse,{isPresent:D,initial:!h.current||n?void 0:!1,custom:e,presenceAffectsLayout:i,mode:a,root:l,onExitComplete:D?void 0:I,anchorX:s,children:T},_)})})},Qse=H.createContext(null);function ele(){const t=H.useRef(!1);return S_(()=>(t.current=!0,()=>{t.current=!1}),[]),t}function tle(){const t=ele(),[e,n]=H.useState(0),r=H.useCallback(()=>{t.current&&n(e+1)},[e]);return[H.useCallback(()=>ui.postRender(r),[r]),e]}const nle=t=>!t.isLayoutDirty&&t.willUpdate(!1);function ZR(){const t=new Set,e=new WeakMap,n=()=>t.forEach(nle);return{add:r=>{t.add(r),e.set(r,r.addEventListener("willUpdate",n))},remove:r=>{t.delete(r);const i=e.get(r);i&&(i(),e.delete(r)),n()},dirty:n}}const BB=t=>t===!0,rle=t=>BB(t===!0)||t==="id",ile=({children:t,id:e,inherit:n=!0})=>{const r=H.useContext(e2),i=H.useContext(Qse),[a,o]=tle(),s=H.useRef(null),l=r.id||i;s.current===null&&(rle(n)&&l&&(e=e?l+"-"+e:l),s.current={id:e,group:BB(n)&&r.group||ZR()});const c=H.useMemo(()=>({...s.current,forceRender:a}),[o]);return j.jsx(e2.Provider,{value:c,children:t})},z_=H.createContext({strict:!1}),QR={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},sm={};for(const t in QR)sm[t]={isEnabled:e=>QR[t].some(n=>!!e[n])};function gE(t){for(const e in t)sm[e]={...sm[e],...t[e]}}function _m({children:t,features:e,strict:n=!1}){const[,r]=H.useState(!US(e)),i=H.useRef(void 0);if(!US(e)){const{renderer:a,...o}=e;i.current=a,gE(o)}return H.useEffect(()=>{US(e)&&e().then(({renderer:a,...o})=>{gE(o),i.current=a,r(!0)})},[]),j.jsx(z_.Provider,{value:{renderer:i.current,strict:n},children:t})}function US(t){return typeof t=="function"}const ale=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Ub(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||ale.has(t)}let $B=t=>!Ub(t);function GB(t){typeof t=="function"&&($B=e=>e.startsWith("on")?!Ub(e):t(e))}try{GB(require("@emotion/is-prop-valid").default)}catch{}function ole(t,e,n){const r={};for(const i in t)i==="values"&&typeof t.values=="object"||($B(i)||n===!0&&Ub(i)||!e&&!Ub(i)||t.draggable&&i.startsWith("onDrag"))&&(r[i]=t[i]);return r}function sle({children:t,isValidProp:e,...n}){e&&GB(e),n={...H.useContext(i2),...n},n.isStatic=xw(()=>n.isStatic);const r=H.useMemo(()=>n,[JSON.stringify(n.transition),n.transformPagePoint,n.reducedMotion]);return j.jsx(i2.Provider,{value:r,children:t})}const Cw=H.createContext({});function Sw(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}function a2(t){return typeof t=="string"||Array.isArray(t)}const W_=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],H_=["initial",...W_];function Tw(t){return Sw(t.animate)||H_.some(e=>a2(t[e]))}function jB(t){return!!(Tw(t)||t.variants)}function lle(t,e){if(Tw(t)){const{initial:n,animate:r}=t;return{initial:n===!1||a2(n)?n:void 0,animate:a2(r)?r:void 0}}return t.inherit!==!1?e:{}}function cle(t){const{initial:e,animate:n}=lle(t,H.useContext(Cw));return H.useMemo(()=>({initial:e,animate:n}),[eA(e),eA(n)])}function eA(t){return Array.isArray(t)?t.join(" "):t}const o2={};function ule(t){for(const e in t)o2[e]=t[e],R_(e)&&(o2[e].isCSSVariable=!0)}function zB(t,{layout:e,layoutId:n}){return Em.has(t)||t.startsWith("origin")||(e||n!==void 0)&&(!!o2[t]||t==="opacity")}const fle={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},dle=Tm.length;function hle(t,e,n){let r="",i=!0;for(let a=0;a<dle;a++){const o=Tm[a],s=t[o];if(s===void 0)continue;let l=!0;if(typeof s=="number"?l=s===(o.startsWith("scale")?1:0):l=parseFloat(s)===0,!l||n){const c=PB(s,$_[o]);if(!l){i=!1;const f=fle[o]||o;r+=`${f}(${c}) `}n&&(e[o]=c)}}return r=r.trim(),n?r=n(e,i?"":r):i&&(r="none"),r}function K_(t,e,n){const{style:r,vars:i,transformOrigin:a}=t;let o=!1,s=!1;for(const l in e){const c=e[l];if(Em.has(l)){o=!0;continue}else if(R_(l)){i[l]=c;continue}else{const f=PB(c,$_[l]);l.startsWith("origin")?(s=!0,a[l]=f):r[l]=f}}if(e.transform||(o||n?r.transform=hle(e,t.transform,n):r.transform&&(r.transform="none")),s){const{originX:l="50%",originY:c="50%",originZ:f=0}=a;r.transformOrigin=`${l} ${c} ${f}`}}const q_=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function WB(t,e,n){for(const r in e)!_o(e[r])&&!zB(r,n)&&(t[r]=e[r])}function ple({transformTemplate:t},e){return H.useMemo(()=>{const n=q_();return K_(n,e,t),Object.assign({},n.vars,n.style)},[e])}function gle(t,e){const n=t.style||{},r={};return WB(r,n,t),Object.assign(r,ple(t,e)),r}function mle(t,e){const n={},r=gle(t,e);return t.drag&&t.dragListener!==!1&&(n.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(n.tabIndex=0),n.style=r,n}const vle={offset:"stroke-dashoffset",array:"stroke-dasharray"},yle={offset:"strokeDashoffset",array:"strokeDasharray"};function xle(t,e,n=1,r=0,i=!0){t.pathLength=1;const a=i?vle:yle;t[a.offset]=Sn.transform(-r);const o=Sn.transform(e),s=Sn.transform(n);t[a.array]=`${o} ${s}`}function HB(t,{attrX:e,attrY:n,attrScale:r,pathLength:i,pathSpacing:a=1,pathOffset:o=0,...s},l,c,f){if(K_(t,s,c),l){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:u,style:d}=t;u.transform&&(d.transform=u.transform,delete u.transform),(d.transform||u.transformOrigin)&&(d.transformOrigin=u.transformOrigin??"50% 50%",delete u.transformOrigin),d.transform&&(d.transformBox=f?.transformBox??"fill-box",delete u.transformBox),e!==void 0&&(u.x=e),n!==void 0&&(u.y=n),r!==void 0&&(u.scale=r),i!==void 0&&xle(u,i,a,o,!1)}const KB=()=>({...q_(),attrs:{}}),qB=t=>typeof t=="string"&&t.toLowerCase()==="svg";function ble(t,e,n,r){const i=H.useMemo(()=>{const a=KB();return HB(a,e,qB(r),t.transformTemplate,t.style),{...a.attrs,style:{...a.style}}},[e]);if(t.style){const a={};WB(a,t.style,t),i.style={...a,...i.style}}return i}const wle=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function X_(t){return typeof t!="string"||t.includes("-")?!1:!!(wle.indexOf(t)>-1||/[A-Z]/u.test(t))}function Cle(t,e,n,{latestValues:r},i,a=!1){const s=(X_(t)?ble:mle)(e,r,i,t),l=ole(e,typeof t=="string",a),c=t!==H.Fragment?{...l,...s,ref:n}:{},{children:f}=e,u=H.useMemo(()=>_o(f)?f.get():f,[f]);return H.createElement(t,{...c,children:u})}function tA(t){const e=[{},{}];return t?.values.forEach((n,r)=>{e[0][r]=n.get(),e[1][r]=n.getVelocity()}),e}function Y_(t,e,n,r){if(typeof e=="function"){const[i,a]=tA(r);e=e(n!==void 0?n:t.custom,i,a)}if(typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"){const[i,a]=tA(r);e=e(n!==void 0?n:t.custom,i,a)}return e}function jx(t){return _o(t)?t.get():t}function Sle({scrapeMotionValuesFromProps:t,createRenderState:e},n,r,i){return{latestValues:Tle(n,r,i,t),renderState:e()}}function Tle(t,e,n,r){const i={},a=r(t,{});for(const d in a)i[d]=jx(a[d]);let{initial:o,animate:s}=t;const l=Tw(t),c=jB(t);e&&c&&!l&&t.inherit!==!1&&(o===void 0&&(o=e.initial),s===void 0&&(s=e.animate));let f=n?n.initial===!1:!1;f=f||o===!1;const u=f?s:o;if(u&&typeof u!="boolean"&&!Sw(u)){const d=Array.isArray(u)?u:[u];for(let h=0;h<d.length;h++){const p=Y_(t,d[h]);if(p){const{transitionEnd:g,transition:m,...y}=p;for(const v in y){let x=y[v];if(Array.isArray(x)){const w=f?x.length-1:0;x=x[w]}x!==null&&(i[v]=x)}for(const v in g)i[v]=g[v]}}}return i}const XB=t=>(e,n)=>{const r=H.useContext(Cw),i=H.useContext(G2),a=()=>Sle(t,e,r,i);return n?a():xw(a)};function J_(t,e,n){const{style:r}=t,i={};for(const a in r)(_o(r[a])||e.style&&_o(e.style[a])||zB(a,t)||n?.getValue(a)?.liveStyle!==void 0)&&(i[a]=r[a]);return i}const Ele=XB({scrapeMotionValuesFromProps:J_,createRenderState:q_});function YB(t,e,n){const r=J_(t,e,n);for(const i in t)if(_o(t[i])||_o(e[i])){const a=Tm.indexOf(i)!==-1?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i;r[a]=t[i]}return r}const _le=XB({scrapeMotionValuesFromProps:YB,createRenderState:KB}),Dle=Symbol.for("motionComponentSymbol");function pg(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function Ole(t,e,n){return H.useCallback(r=>{r&&t.onMount&&t.onMount(r),e&&(r?e.mount(r):e.unmount()),n&&(typeof n=="function"?n(r):pg(n)&&(n.current=r))},[e])}const Z_=t=>t.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),Mle="framerAppearId",JB="data-"+Z_(Mle),ZB=H.createContext({});function Ile(t,e,n,r,i){const{visualElement:a}=H.useContext(Cw),o=H.useContext(z_),s=H.useContext(G2),l=H.useContext(i2).reducedMotion,c=H.useRef(null);r=r||o.renderer,!c.current&&r&&(c.current=r(t,{visualState:e,parent:a,props:n,presenceContext:s,blockInitialAnimation:s?s.initial===!1:!1,reducedMotionConfig:l}));const f=c.current,u=H.useContext(ZB);f&&!f.projection&&i&&(f.type==="html"||f.type==="svg")&&Rle(c.current,n,i,u);const d=H.useRef(!1);H.useInsertionEffect(()=>{f&&d.current&&f.update(n,s)});const h=n[JB],p=H.useRef(!!h&&!window.MotionHandoffIsComplete?.(h)&&window.MotionHasOptimisedAnimation?.(h));return S_(()=>{f&&(d.current=!0,window.MotionIsMounted=!0,f.updateFeatures(),f.scheduleRenderMicrotask(),p.current&&f.animationState&&f.animationState.animateChanges())}),H.useEffect(()=>{f&&(!p.current&&f.animationState&&f.animationState.animateChanges(),p.current&&(queueMicrotask(()=>{window.MotionHandoffMarkAsComplete?.(h)}),p.current=!1),f.enteringChildren=void 0)}),f}function Rle(t,e,n,r){const{layoutId:i,layout:a,drag:o,dragConstraints:s,layoutScroll:l,layoutRoot:c,layoutCrossfade:f}=e;t.projection=new n(t.latestValues,e["data-framer-portal-id"]?void 0:QB(t.parent)),t.projection.setOptions({layoutId:i,layout:a,alwaysMeasureLayout:!!o||s&&pg(s),visualElement:t,animationType:typeof a=="string"?a:"both",initialPromotionConfig:r,crossfade:f,layoutScroll:l,layoutRoot:c})}function QB(t){if(t)return t.options.allowProjection!==!1?t.projection:QB(t.parent)}function BS(t,{forwardMotionProps:e=!1}={},n,r){n&&gE(n);const i=X_(t)?_le:Ele;function a(s,l){let c;const f={...H.useContext(i2),...s,layoutId:Ale(s)},{isStatic:u}=f,d=cle(s),h=i(s,u);if(!u&&C_){Ple();const p=Nle(f);c=p.MeasureLayout,d.visualElement=Ile(t,h,f,r,p.ProjectionNode)}return j.jsxs(Cw.Provider,{value:d,children:[c&&d.visualElement?j.jsx(c,{visualElement:d.visualElement,...f}):null,Cle(t,s,Ole(h,d.visualElement,l),h,u,e)]})}a.displayName=`motion.${typeof t=="string"?t:`create(${t.displayName??t.name??""})`}`;const o=H.forwardRef(a);return o[Dle]=t,o}function Ale({layoutId:t}){const e=H.useContext(e2).id;return e&&t!==void 0?e+"-"+t:t}function Ple(t,e){H.useContext(z_).strict}function Nle(t){const{drag:e,layout:n}=sm;if(!e&&!n)return{};const r={...e,...n};return{MeasureLayout:e?.isEnabled(t)||n?.isEnabled(t)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}function Lle(t,e){if(typeof Proxy>"u")return BS;const n=new Map,r=(a,o)=>BS(a,o,t,e),i=(a,o)=>r(a,o);return new Proxy(i,{get:(a,o)=>o==="create"?r:(n.has(o)||n.set(o,BS(o,void 0,t,e)),n.get(o))})}const Gh=Lle();function e$({top:t,left:e,right:n,bottom:r}){return{x:{min:e,max:n},y:{min:t,max:r}}}function kle({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}function Vle(t,e){if(!e)return t;const n=e({x:t.left,y:t.top}),r=e({x:t.right,y:t.bottom});return{top:n.y,left:n.x,bottom:r.y,right:r.x}}function $S(t){return t===void 0||t===1}function mE({scale:t,scaleX:e,scaleY:n}){return!$S(t)||!$S(e)||!$S(n)}function nh(t){return mE(t)||t$(t)||t.z||t.rotate||t.rotateX||t.rotateY||t.skewX||t.skewY}function t$(t){return nA(t.x)||nA(t.y)}function nA(t){return t&&t!=="0%"}function Bb(t,e,n){const r=t-n,i=e*r;return n+i}function rA(t,e,n,r,i){return i!==void 0&&(t=Bb(t,i,r)),Bb(t,n,r)+e}function vE(t,e=0,n=1,r,i){t.min=rA(t.min,e,n,r,i),t.max=rA(t.max,e,n,r,i)}function n$(t,{x:e,y:n}){vE(t.x,e.translate,e.scale,e.originPoint),vE(t.y,n.translate,n.scale,n.originPoint)}const iA=.999999999999,aA=1.0000000000001;function Fle(t,e,n,r=!1){const i=n.length;if(!i)return;e.x=e.y=1;let a,o;for(let s=0;s<i;s++){a=n[s],o=a.projectionDelta;const{visualElement:l}=a.options;l&&l.props.style&&l.props.style.display==="contents"||(r&&a.options.layoutScroll&&a.scroll&&a!==a.root&&mg(t,{x:-a.scroll.offset.x,y:-a.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,n$(t,o)),r&&nh(a.latestValues)&&mg(t,a.latestValues))}e.x<aA&&e.x>iA&&(e.x=1),e.y<aA&&e.y>iA&&(e.y=1)}function gg(t,e){t.min=t.min+e,t.max=t.max+e}function oA(t,e,n,r,i=.5){const a=_i(t.min,t.max,i);vE(t,e,n,a,r)}function mg(t,e){oA(t.x,e.x,e.scaleX,e.scale,e.originX),oA(t.y,e.y,e.scaleY,e.scale,e.originY)}function r$(t,e){return e$(Vle(t.getBoundingClientRect(),e))}function Ule(t,e,n){const r=r$(t,n),{scroll:i}=e;return i&&(gg(r.x,i.offset.x),gg(r.y,i.offset.y)),r}const sA=()=>({translate:0,scale:1,origin:0,originPoint:0}),vg=()=>({x:sA(),y:sA()}),lA=()=>({min:0,max:0}),Zi=()=>({x:lA(),y:lA()}),yE={current:null},i$={current:!1};function Ble(){if(i$.current=!0,!!C_)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>yE.current=t.matches;t.addEventListener("change",e),e()}else yE.current=!1}const $le=new WeakMap;function Gle(t,e,n){for(const r in e){const i=e[r],a=n[r];if(_o(i))t.addValue(r,i);else if(_o(a))t.addValue(r,om(i,{owner:t}));else if(a!==i)if(t.hasValue(r)){const o=t.getValue(r);o.liveStyle===!0?o.jump(i):o.hasAnimated||o.set(i)}else{const o=t.getStaticValue(r);t.addValue(r,om(o!==void 0?o:i,{owner:t}))}}for(const r in n)e[r]===void 0&&t.removeValue(r);return e}const cA=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class jle{scrapeMotionValuesFromProps(e,n,r){return{}}constructor({parent:e,props:n,presenceContext:r,reducedMotionConfig:i,blockInitialAnimation:a,visualState:o},s={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=U_,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const d=ws.now();this.renderScheduledAt<d&&(this.renderScheduledAt=d,ui.render(this.render,!1,!0))};const{latestValues:l,renderState:c}=o;this.latestValues=l,this.baseTarget={...l},this.initialValues=n.initial?{...l}:{},this.renderState=c,this.parent=e,this.props=n,this.presenceContext=r,this.depth=e?e.depth+1:0,this.reducedMotionConfig=i,this.options=s,this.blockInitialAnimation=!!a,this.isControllingVariants=Tw(n),this.isVariantNode=jB(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:f,...u}=this.scrapeMotionValuesFromProps(n,{},this);for(const d in u){const h=u[d];l[d]!==void 0&&_o(h)&&h.set(l[d])}}mount(e){this.current=e,$le.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,r)=>this.bindToMotionValue(r,n)),i$.current||Ble(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:yE.current,this.parent?.addChild(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),c0(this.notifyUpdate),c0(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent?.removeChild(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const n=this.features[e];n&&(n.unmount(),n.isMounted=!1)}this.current=null}addChild(e){this.children.add(e),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(e)}removeChild(e){this.children.delete(e),this.enteringChildren&&this.enteringChildren.delete(e)}bindToMotionValue(e,n){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const r=Em.has(e);r&&this.onBindTransform&&this.onBindTransform();const i=n.on("change",o=>{this.latestValues[e]=o,this.props.onUpdate&&ui.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,e,n)),this.valueSubscriptions.set(e,()=>{i(),a&&a(),n.owner&&n.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in sm){const n=sm[e];if(!n)continue;const{isEnabled:r,Feature:i}=n;if(!this.features[e]&&i&&r(this.props)&&(this.features[e]=new i(this)),this.features[e]){const a=this.features[e];a.isMounted?a.update():(a.mount(),a.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Zi()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,n){this.latestValues[e]=n}update(e,n){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let r=0;r<cA.length;r++){const i=cA[r];this.propEventSubscriptions[i]&&(this.propEventSubscriptions[i](),delete this.propEventSubscriptions[i]);const a="on"+i,o=e[a];o&&(this.propEventSubscriptions[i]=this.on(i,o))}this.prevMotionValues=Gle(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(e),()=>n.variantChildren.delete(e)}addValue(e,n){const r=this.values.get(e);n!==r&&(r&&this.removeValue(e),this.bindToMotionValue(e,n),this.values.set(e,n),this.latestValues[e]=n.get())}removeValue(e){this.values.delete(e);const n=this.valueSubscriptions.get(e);n&&(n(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,n){if(this.props.values&&this.props.values[e])return this.props.values[e];let r=this.values.get(e);return r===void 0&&n!==void 0&&(r=om(n===null?void 0:n,{owner:this}),this.addValue(e,r)),r}readValue(e,n){let r=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:this.getBaseTargetFromProps(this.props,e)??this.readValueFromInstance(this.current,e,this.options);return r!=null&&(typeof r=="string"&&(XU(r)||JU(r))?r=parseFloat(r):!Kse(r)&&u0.test(n)&&(r=AB(e,n)),this.setBaseTarget(e,_o(r)?r.get():r)),_o(r)?r.get():r}setBaseTarget(e,n){this.baseTarget[e]=n}getBaseTarget(e){const{initial:n}=this.props;let r;if(typeof n=="string"||typeof n=="object"){const a=Y_(this.props,n,this.presenceContext?.custom);a&&(r=a[e])}if(n&&r!==void 0)return r;const i=this.getBaseTargetFromProps(this.props,e);return i!==void 0&&!_o(i)?i:this.initialValues[e]!==void 0&&r===void 0?void 0:this.baseTarget[e]}on(e,n){return this.events[e]||(this.events[e]=new O_),this.events[e].add(n)}notify(e,...n){this.events[e]&&this.events[e].notify(...n)}scheduleRenderMicrotask(){G_.render(this.render)}}class a$ extends jle{constructor(){super(...arguments),this.KeyframeResolver=Lse}sortInstanceNodePosition(e,n){return e.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(e,n){return e.style?e.style[n]:void 0}removeValueFromRenderState(e,{vars:n,style:r}){delete n[e],delete r[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;_o(e)&&(this.childSubscription=e.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}}function o$(t,{style:e,vars:n},r,i){const a=t.style;let o;for(o in e)a[o]=e[o];i?.applyProjectionStyles(a,r);for(o in n)a.setProperty(o,n[o])}function zle(t){return window.getComputedStyle(t)}class Wle extends a${constructor(){super(...arguments),this.type="html",this.renderInstance=o$}readValueFromInstance(e,n){if(Em.has(n))return this.projection?.isProjecting?lE(n):ese(e,n);{const r=zle(e),i=(R_(n)?r.getPropertyValue(n):r[n])||0;return typeof i=="string"?i.trim():i}}measureInstanceViewportBox(e,{transformPagePoint:n}){return r$(e,n)}build(e,n,r){K_(e,n,r.transformTemplate)}scrapeMotionValuesFromProps(e,n,r){return J_(e,n,r)}}const s$=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function Hle(t,e,n,r){o$(t,e,void 0,r);for(const i in e.attrs)t.setAttribute(s$.has(i)?i:Z_(i),e.attrs[i])}class Kle extends a${constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Zi}getBaseTargetFromProps(e,n){return e[n]}readValueFromInstance(e,n){if(Em.has(n)){const r=RB(n);return r&&r.default||0}return n=s$.has(n)?n:Z_(n),e.getAttribute(n)}scrapeMotionValuesFromProps(e,n,r){return YB(e,n,r)}build(e,n,r){HB(e,n,this.isSVGTag,r.transformTemplate,r.style)}renderInstance(e,n,r,i){Hle(e,n,r,i)}mount(e){this.isSVGTag=qB(e.tagName),super.mount(e)}}const qle=(t,e)=>X_(t)?new Kle(e):new Wle(e,{allowProjection:t!==H.Fragment});function Vg(t,e,n){const r=t.getProps();return Y_(r,e,n!==void 0?n:r.custom,t)}const xE=t=>Array.isArray(t);function Xle(t,e,n){t.hasValue(e)?t.getValue(e).set(n):t.addValue(e,om(n))}function Yle(t){return xE(t)?t[t.length-1]||0:t}function Jle(t,e){const n=Vg(t,e);let{transitionEnd:r={},transition:i={},...a}=n||{};a={...a,...r};for(const o in a){const s=Yle(a[o]);Xle(t,o,s)}}function Zle(t){return!!(_o(t)&&t.add)}function bE(t,e){const n=t.getValue("willChange");if(Zle(n))return n.add(e);if(!n&&hu.WillChange){const r=new hu.WillChange("auto");t.addValue("willChange",r),r.add(e)}}function l$(t){return t.props[JB]}const Qle=t=>t!==null;function ece(t,{repeat:e,repeatType:n="loop"},r){const i=t.filter(Qle),a=e&&n!=="loop"&&e%2===1?0:i.length-1;return i[a]}const tce={type:"spring",stiffness:500,damping:25,restSpeed:10},nce=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),rce={type:"keyframes",duration:.8},ice={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},ace=(t,{keyframes:e})=>e.length>2?rce:Em.has(t)?t.startsWith("scale")?nce(e[1]):tce:ice;function oce({when:t,delay:e,delayChildren:n,staggerChildren:r,staggerDirection:i,repeat:a,repeatType:o,repeatDelay:s,from:l,elapsed:c,...f}){return!!Object.keys(f).length}const Q_=(t,e,n,r={},i,a)=>o=>{const s=B_(r,t)||{},l=s.delay||r.delay||0;let{elapsed:c=0}=r;c=c-ru(l);const f={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:e.getVelocity(),...s,delay:-c,onUpdate:d=>{e.set(d),s.onUpdate&&s.onUpdate(d)},onComplete:()=>{o(),s.onComplete&&s.onComplete()},name:t,motionValue:e,element:a?void 0:i};oce(s)||Object.assign(f,ace(t,f)),f.duration&&(f.duration=ru(f.duration)),f.repeatDelay&&(f.repeatDelay=ru(f.repeatDelay)),f.from!==void 0&&(f.keyframes[0]=f.from);let u=!1;if((f.type===!1||f.duration===0&&!f.repeatDelay)&&(hE(f),f.delay===0&&(u=!0)),(hu.instantAnimations||hu.skipAnimations)&&(u=!0,hE(f),f.delay=0),f.allowFlatten=!s.type&&!s.ease,u&&!a&&e.get()!==void 0){const d=ece(f.keyframes,s);if(d!==void 0){ui.update(()=>{f.onUpdate(d),f.onComplete()});return}}return s.isSync?new bw(f):new Sse(f)};function sce({protectedKeys:t,needsAnimating:e},n){const r=t.hasOwnProperty(n)&&e[n]!==!0;return e[n]=!1,r}function c$(t,e,{delay:n=0,transitionOverride:r,type:i}={}){let{transition:a=t.getDefaultTransition(),transitionEnd:o,...s}=e;r&&(a=r);const l=[],c=i&&t.animationState&&t.animationState.getState()[i];for(const f in s){const u=t.getValue(f,t.latestValues[f]??null),d=s[f];if(d===void 0||c&&sce(c,f))continue;const h={delay:n,...B_(a||{},f)},p=u.get();if(p!==void 0&&!u.isAnimating&&!Array.isArray(d)&&d===p&&!h.velocity)continue;let g=!1;if(window.MotionHandoffAnimation){const y=l$(t);if(y){const v=window.MotionHandoffAnimation(y,f,ui);v!==null&&(h.startTime=v,g=!0)}}bE(t,f),u.start(Q_(f,u,d,t.shouldReduceMotion&&OB.has(f)?{type:!1}:h,t,g));const m=u.animation;m&&l.push(m)}return o&&Promise.all(l).then(()=>{ui.update(()=>{o&&Jle(t,o)})}),l}function u$(t,e,n,r=0,i=1){const a=Array.from(t).sort((c,f)=>c.sortNodePosition(f)).indexOf(e),o=t.size,s=(o-1)*r;return typeof n=="function"?n(a,o):i===1?a*r:s-a*r}function wE(t,e,n={}){const r=Vg(t,e,n.type==="exit"?t.presenceContext?.custom:void 0);let{transition:i=t.getDefaultTransition()||{}}=r||{};n.transitionOverride&&(i=n.transitionOverride);const a=r?()=>Promise.all(c$(t,r,n)):()=>Promise.resolve(),o=t.variantChildren&&t.variantChildren.size?(l=0)=>{const{delayChildren:c=0,staggerChildren:f,staggerDirection:u}=i;return lce(t,e,l,c,f,u,n)}:()=>Promise.resolve(),{when:s}=i;if(s){const[l,c]=s==="beforeChildren"?[a,o]:[o,a];return l().then(()=>c())}else return Promise.all([a(),o(n.delay)])}function lce(t,e,n=0,r=0,i=0,a=1,o){const s=[];for(const l of t.variantChildren)l.notify("AnimationStart",e),s.push(wE(l,e,{...o,delay:n+(typeof r=="function"?0:r)+u$(t.variantChildren,l,r,i,a)}).then(()=>l.notify("AnimationComplete",e)));return Promise.all(s)}function cce(t,e,n={}){t.notify("AnimationStart",e);let r;if(Array.isArray(e)){const i=e.map(a=>wE(t,a,n));r=Promise.all(i)}else if(typeof e=="string")r=wE(t,e,n);else{const i=typeof e=="function"?Vg(t,e,n.custom):e;r=Promise.all(c$(t,i,n))}return r.then(()=>{t.notify("AnimationComplete",e)})}function f$(t,e){if(!Array.isArray(e))return!1;const n=e.length;if(n!==t.length)return!1;for(let r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}const uce=H_.length;function d$(t){if(!t)return;if(!t.isControllingVariants){const n=t.parent?d$(t.parent)||{}:{};return t.props.initial!==void 0&&(n.initial=t.props.initial),n}const e={};for(let n=0;n<uce;n++){const r=H_[n],i=t.props[r];(a2(i)||i===!1)&&(e[r]=i)}return e}const fce=[...W_].reverse(),dce=W_.length;function hce(t){return e=>Promise.all(e.map(({animation:n,options:r})=>cce(t,n,r)))}function pce(t){let e=hce(t),n=uA(),r=!0;const i=l=>(c,f)=>{const u=Vg(t,f,l==="exit"?t.presenceContext?.custom:void 0);if(u){const{transition:d,transitionEnd:h,...p}=u;c={...c,...p,...h}}return c};function a(l){e=l(t)}function o(l){const{props:c}=t,f=d$(t.parent)||{},u=[],d=new Set;let h={},p=1/0;for(let m=0;m<dce;m++){const y=fce[m],v=n[y],x=c[y]!==void 0?c[y]:f[y],w=a2(x),S=y===l?v.isActive:null;S===!1&&(p=m);let T=x===f[y]&&x!==c[y]&&w;if(T&&r&&t.manuallyAnimateOnMount&&(T=!1),v.protectedKeys={...h},!v.isActive&&S===null||!x&&!v.prevProp||Sw(x)||typeof x=="boolean")continue;const _=gce(v.prevProp,x);let D=_||y===l&&v.isActive&&!T&&w||m>p&&w,I=!1;const R=Array.isArray(x)?x:[x];let M=R.reduce(i(y),{});S===!1&&(M={});const{prevResolvedValues:A={}}=v,L={...A,...M},P=G=>{D=!0,d.has(G)&&(I=!0,d.delete(G)),v.needsAnimating[G]=!0;const F=t.getValue(G);F&&(F.liveStyle=!1)};for(const G in L){const F=M[G],$=A[G];if(h.hasOwnProperty(G))continue;let V=!1;xE(F)&&xE($)?V=!f$(F,$):V=F!==$,V?F!=null?P(G):d.add(G):F!==void 0&&d.has(G)?P(G):v.protectedKeys[G]=!0}v.prevProp=x,v.prevResolvedValues=M,v.isActive&&(h={...h,...M}),r&&t.blockInitialAnimation&&(D=!1);const B=T&&_;D&&(!B||I)&&u.push(...R.map(G=>{const F={type:y};if(typeof G=="string"&&r&&!B&&t.manuallyAnimateOnMount&&t.parent){const{parent:$}=t,V=Vg($,G);if($.enteringChildren&&V){const{delayChildren:X}=V.transition||{};F.delay=u$($.enteringChildren,t,X)}}return{animation:G,options:F}}))}if(d.size){const m={};if(typeof c.initial!="boolean"){const y=Vg(t,Array.isArray(c.initial)?c.initial[0]:c.initial);y&&y.transition&&(m.transition=y.transition)}d.forEach(y=>{const v=t.getBaseTarget(y),x=t.getValue(y);x&&(x.liveStyle=!0),m[y]=v??null}),u.push({animation:m})}let g=!!u.length;return r&&(c.initial===!1||c.initial===c.animate)&&!t.manuallyAnimateOnMount&&(g=!1),r=!1,g?e(u):Promise.resolve()}function s(l,c){if(n[l].isActive===c)return Promise.resolve();t.variantChildren?.forEach(u=>u.animationState?.setActive(l,c)),n[l].isActive=c;const f=o(l);for(const u in n)n[u].protectedKeys={};return f}return{animateChanges:o,setActive:s,setAnimateFunction:a,getState:()=>n,reset:()=>{n=uA(),r=!0}}}function gce(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!f$(e,t):!1}function $0(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function uA(){return{animate:$0(!0),whileInView:$0(),whileHover:$0(),whileTap:$0(),whileDrag:$0(),whileFocus:$0(),exit:$0()}}class E0{constructor(e){this.isMounted=!1,this.node=e}update(){}}class mce extends E0{constructor(e){super(e),e.animationState||(e.animationState=pce(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();Sw(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:n}=this.node.prevProps||{};e!==n&&this.updateAnimationControlsSubscription()}unmount(){this.node.animationState.reset(),this.unmountControls?.()}}let vce=0;class yce extends E0{constructor(){super(...arguments),this.id=vce++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:n}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===r)return;const i=this.node.animationState.setActive("exit",!e);n&&!e&&i.then(()=>{n(this.id)})}mount(){const{register:e,onExitComplete:n}=this.node.presenceContext||{};n&&n(this.id),e&&(this.unmount=e(this.id))}unmount(){}}const xce={animation:{Feature:mce},exit:{Feature:yce}};function s2(t,e,n,r={passive:!0}){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n)}function H2(t){return{point:{x:t.pageX,y:t.pageY}}}const bce=t=>e=>j_(e)&&t(e,H2(e));function Ov(t,e,n,r){return s2(t,e,bce(n),r)}const h$=1e-4,wce=1-h$,Cce=1+h$,p$=.01,Sce=0-p$,Tce=0+p$;function Xo(t){return t.max-t.min}function Ece(t,e,n){return Math.abs(t-e)<=n}function fA(t,e,n,r=.5){t.origin=r,t.originPoint=_i(e.min,e.max,t.origin),t.scale=Xo(n)/Xo(e),t.translate=_i(n.min,n.max,t.origin)-t.originPoint,(t.scale>=wce&&t.scale<=Cce||isNaN(t.scale))&&(t.scale=1),(t.translate>=Sce&&t.translate<=Tce||isNaN(t.translate))&&(t.translate=0)}function Mv(t,e,n,r){fA(t.x,e.x,n.x,r?r.originX:void 0),fA(t.y,e.y,n.y,r?r.originY:void 0)}function dA(t,e,n){t.min=n.min+e.min,t.max=t.min+Xo(e)}function _ce(t,e,n){dA(t.x,e.x,n.x),dA(t.y,e.y,n.y)}function hA(t,e,n){t.min=e.min-n.min,t.max=t.min+Xo(e)}function Iv(t,e,n){hA(t.x,e.x,n.x),hA(t.y,e.y,n.y)}function Sl(t){return[t("x"),t("y")]}const g$=({current:t})=>t?t.ownerDocument.defaultView:null,pA=(t,e)=>Math.abs(t-e);function Dce(t,e){const n=pA(t.x,e.x),r=pA(t.y,e.y);return Math.sqrt(n**2+r**2)}class m${constructor(e,n,{transformPagePoint:r,contextWindow:i=window,dragSnapToOrigin:a=!1,distanceThreshold:o=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const d=jS(this.lastMoveEventInfo,this.history),h=this.startEvent!==null,p=Dce(d.offset,{x:0,y:0})>=this.distanceThreshold;if(!h&&!p)return;const{point:g}=d,{timestamp:m}=ro;this.history.push({...g,timestamp:m});const{onStart:y,onMove:v}=this.handlers;h||(y&&y(this.lastMoveEvent,d),this.startEvent=this.lastMoveEvent),v&&v(this.lastMoveEvent,d)},this.handlePointerMove=(d,h)=>{this.lastMoveEvent=d,this.lastMoveEventInfo=GS(h,this.transformPagePoint),ui.update(this.updatePoint,!0)},this.handlePointerUp=(d,h)=>{this.end();const{onEnd:p,onSessionEnd:g,resumeAnimation:m}=this.handlers;if(this.dragSnapToOrigin&&m&&m(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const y=jS(d.type==="pointercancel"?this.lastMoveEventInfo:GS(h,this.transformPagePoint),this.history);this.startEvent&&p&&p(d,y),g&&g(d,y)},!j_(e))return;this.dragSnapToOrigin=a,this.handlers=n,this.transformPagePoint=r,this.distanceThreshold=o,this.contextWindow=i||window;const s=H2(e),l=GS(s,this.transformPagePoint),{point:c}=l,{timestamp:f}=ro;this.history=[{...c,timestamp:f}];const{onSessionStart:u}=n;u&&u(e,jS(l,this.history)),this.removeListeners=j2(Ov(this.contextWindow,"pointermove",this.handlePointerMove),Ov(this.contextWindow,"pointerup",this.handlePointerUp),Ov(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),c0(this.updatePoint)}}function GS(t,e){return e?{point:e(t.point)}:t}function gA(t,e){return{x:t.x-e.x,y:t.y-e.y}}function jS({point:t},e){return{point:t,delta:gA(t,v$(e)),offset:gA(t,Oce(e)),velocity:Mce(e,.1)}}function Oce(t){return t[0]}function v$(t){return t[t.length-1]}function Mce(t,e){if(t.length<2)return{x:0,y:0};let n=t.length-1,r=null;const i=v$(t);for(;n>=0&&(r=t[n],!(i.timestamp-r.timestamp>ru(e)));)n--;if(!r)return{x:0,y:0};const a=iu(i.timestamp-r.timestamp);if(a===0)return{x:0,y:0};const o={x:(i.x-r.x)/a,y:(i.y-r.y)/a};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function Ice(t,{min:e,max:n},r){return e!==void 0&&t<e?t=r?_i(e,t,r.min):Math.max(t,e):n!==void 0&&t>n&&(t=r?_i(n,t,r.max):Math.min(t,n)),t}function mA(t,e,n){return{min:e!==void 0?t.min+e:void 0,max:n!==void 0?t.max+n-(t.max-t.min):void 0}}function Rce(t,{top:e,left:n,bottom:r,right:i}){return{x:mA(t.x,n,i),y:mA(t.y,e,r)}}function vA(t,e){let n=e.min-t.min,r=e.max-t.max;return e.max-e.min<t.max-t.min&&([n,r]=[r,n]),{min:n,max:r}}function Ace(t,e){return{x:vA(t.x,e.x),y:vA(t.y,e.y)}}function Pce(t,e){let n=.5;const r=Xo(t),i=Xo(e);return i>r?n=t2(e.min,e.max-r,t.min):r>i&&(n=t2(t.min,t.max-i,e.min)),Af(0,1,n)}function Nce(t,e){const n={};return e.min!==void 0&&(n.min=e.min-t.min),e.max!==void 0&&(n.max=e.max-t.min),n}const CE=.35;function Lce(t=CE){return t===!1?t=0:t===!0&&(t=CE),{x:yA(t,"left","right"),y:yA(t,"top","bottom")}}function yA(t,e,n){return{min:xA(t,e),max:xA(t,n)}}function xA(t,e){return typeof t=="number"?t:t[e]||0}const kce=new WeakMap;class Vce{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Zi(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=e}start(e,{snapToCursor:n=!1,distanceThreshold:r}={}){const{presenceContext:i}=this.visualElement;if(i&&i.isPresent===!1)return;const a=u=>{const{dragSnapToOrigin:d}=this.getProps();d?this.pauseAnimation():this.stopAnimation(),n&&this.snapToCursor(H2(u).point)},o=(u,d)=>{const{drag:h,dragPropagation:p,onDragStart:g}=this.getProps();if(h&&!p&&(this.openDragLock&&this.openDragLock(),this.openDragLock=Use(h),!this.openDragLock))return;this.latestPointerEvent=u,this.latestPanInfo=d,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Sl(y=>{let v=this.getAxisMotionValue(y).get()||0;if(au.test(v)){const{projection:x}=this.visualElement;if(x&&x.layout){const w=x.layout.layoutBox[y];w&&(v=Xo(w)*(parseFloat(v)/100))}}this.originPoint[y]=v}),g&&ui.postRender(()=>g(u,d)),bE(this.visualElement,"transform");const{animationState:m}=this.visualElement;m&&m.setActive("whileDrag",!0)},s=(u,d)=>{this.latestPointerEvent=u,this.latestPanInfo=d;const{dragPropagation:h,dragDirectionLock:p,onDirectionLock:g,onDrag:m}=this.getProps();if(!h&&!this.openDragLock)return;const{offset:y}=d;if(p&&this.currentDirection===null){this.currentDirection=Fce(y),this.currentDirection!==null&&g&&g(this.currentDirection);return}this.updateAxis("x",d.point,y),this.updateAxis("y",d.point,y),this.visualElement.render(),m&&m(u,d)},l=(u,d)=>{this.latestPointerEvent=u,this.latestPanInfo=d,this.stop(u,d),this.latestPointerEvent=null,this.latestPanInfo=null},c=()=>Sl(u=>this.getAnimationState(u)==="paused"&&this.getAxisMotionValue(u).animation?.play()),{dragSnapToOrigin:f}=this.getProps();this.panSession=new m$(e,{onSessionStart:a,onStart:o,onMove:s,onSessionEnd:l,resumeAnimation:c},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:f,distanceThreshold:r,contextWindow:g$(this.visualElement)})}stop(e,n){const r=e||this.latestPointerEvent,i=n||this.latestPanInfo,a=this.isDragging;if(this.cancel(),!a||!i||!r)return;const{velocity:o}=i;this.startAnimation(o);const{onDragEnd:s}=this.getProps();s&&ui.postRender(()=>s(r,i))}cancel(){this.isDragging=!1;const{projection:e,animationState:n}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(e,n,r){const{drag:i}=this.getProps();if(!r||!M5(e,i,this.currentDirection))return;const a=this.getAxisMotionValue(e);let o=this.originPoint[e]+r[e];this.constraints&&this.constraints[e]&&(o=Ice(o,this.constraints[e],this.elastic[e])),a.set(o)}resolveConstraints(){const{dragConstraints:e,dragElastic:n}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):this.visualElement.projection?.layout,i=this.constraints;e&&pg(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):e&&r?this.constraints=Rce(r.layoutBox,e):this.constraints=!1,this.elastic=Lce(n),i!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&Sl(a=>{this.constraints!==!1&&this.getAxisMotionValue(a)&&(this.constraints[a]=Nce(r.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:n}=this.getProps();if(!e||!pg(e))return!1;const r=e.current,{projection:i}=this.visualElement;if(!i||!i.layout)return!1;const a=Ule(r,i.root,this.visualElement.getTransformPagePoint());let o=Ace(i.layout.layoutBox,a);if(n){const s=n(kle(o));this.hasMutatedConstraints=!!s,s&&(o=e$(s))}return o}startAnimation(e){const{drag:n,dragMomentum:r,dragElastic:i,dragTransition:a,dragSnapToOrigin:o,onDragTransitionEnd:s}=this.getProps(),l=this.constraints||{},c=Sl(f=>{if(!M5(f,n,this.currentDirection))return;let u=l&&l[f]||{};o&&(u={min:0,max:0});const d=i?200:1e6,h=i?40:1e7,p={type:"inertia",velocity:r?e[f]:0,bounceStiffness:d,bounceDamping:h,timeConstant:750,restDelta:1,restSpeed:10,...a,...u};return this.startAxisValueAnimation(f,p)});return Promise.all(c).then(s)}startAxisValueAnimation(e,n){const r=this.getAxisMotionValue(e);return bE(this.visualElement,e),r.start(Q_(e,r,0,n,this.visualElement,!1))}stopAnimation(){Sl(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){Sl(e=>this.getAxisMotionValue(e).animation?.pause())}getAnimationState(e){return this.getAxisMotionValue(e).animation?.state}getAxisMotionValue(e){const n=`_drag${e.toUpperCase()}`,r=this.visualElement.getProps(),i=r[n];return i||this.visualElement.getValue(e,(r.initial?r.initial[e]:void 0)||0)}snapToCursor(e){Sl(n=>{const{drag:r}=this.getProps();if(!M5(n,r,this.currentDirection))return;const{projection:i}=this.visualElement,a=this.getAxisMotionValue(n);if(i&&i.layout){const{min:o,max:s}=i.layout.layoutBox[n];a.set(e[n]-_i(o,s,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:n}=this.getProps(),{projection:r}=this.visualElement;if(!pg(n)||!r||!this.constraints)return;this.stopAnimation();const i={x:0,y:0};Sl(o=>{const s=this.getAxisMotionValue(o);if(s&&this.constraints!==!1){const l=s.get();i[o]=Pce({min:l,max:l},this.constraints[o])}});const{transformTemplate:a}=this.visualElement.getProps();this.visualElement.current.style.transform=a?a({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),Sl(o=>{if(!M5(o,e,null))return;const s=this.getAxisMotionValue(o),{min:l,max:c}=this.constraints[o];s.set(_i(l,c,i[o]))})}addListeners(){if(!this.visualElement.current)return;kce.set(this.visualElement,this);const e=this.visualElement.current,n=Ov(e,"pointerdown",l=>{const{drag:c,dragListener:f=!0}=this.getProps();c&&f&&this.start(l)}),r=()=>{const{dragConstraints:l}=this.getProps();pg(l)&&l.current&&(this.constraints=this.resolveRefConstraints())},{projection:i}=this.visualElement,a=i.addEventListener("measure",r);i&&!i.layout&&(i.root&&i.root.updateScroll(),i.updateLayout()),ui.read(r);const o=s2(window,"resize",()=>this.scalePositionWithinConstraints()),s=i.addEventListener("didUpdate",(({delta:l,hasLayoutChanged:c})=>{this.isDragging&&c&&(Sl(f=>{const u=this.getAxisMotionValue(f);u&&(this.originPoint[f]+=l[f].translate,u.set(u.get()+l[f].translate))}),this.visualElement.render())}));return()=>{o(),n(),a(),s&&s()}}getProps(){const e=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:r=!1,dragPropagation:i=!1,dragConstraints:a=!1,dragElastic:o=CE,dragMomentum:s=!0}=e;return{...e,drag:n,dragDirectionLock:r,dragPropagation:i,dragConstraints:a,dragElastic:o,dragMomentum:s}}}function M5(t,e,n){return(e===!0||e===t)&&(n===null||n===t)}function Fce(t,e=10){let n=null;return Math.abs(t.y)>e?n="y":Math.abs(t.x)>e&&(n="x"),n}class Uce extends E0{constructor(e){super(e),this.removeGroupControls=Rl,this.removeListeners=Rl,this.controls=new Vce(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Rl}unmount(){this.removeGroupControls(),this.removeListeners()}}const bA=t=>(e,n)=>{t&&ui.postRender(()=>t(e,n))};class Bce extends E0{constructor(){super(...arguments),this.removePointerDownListener=Rl}onPointerDown(e){this.session=new m$(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:g$(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:n,onPan:r,onPanEnd:i}=this.node.getProps();return{onSessionStart:bA(e),onStart:bA(n),onMove:r,onEnd:(a,o)=>{delete this.session,i&&ui.postRender(()=>i(a,o))}}}mount(){this.removePointerDownListener=Ov(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const zx={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function wA(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const U1={correct:(t,e)=>{if(!e.target)return t;if(typeof t=="string")if(Sn.test(t))t=parseFloat(t);else return t;const n=wA(t,e.target.x),r=wA(t,e.target.y);return`${n}% ${r}%`}},$ce={correct:(t,{treeScale:e,projectionDelta:n})=>{const r=t,i=u0.parse(t);if(i.length>5)return r;const a=u0.createTransformer(t),o=typeof i[0]!="number"?1:0,s=n.x.scale*e.x,l=n.y.scale*e.y;i[0+o]/=s,i[1+o]/=l;const c=_i(s,l,.5);return typeof i[2+o]=="number"&&(i[2+o]/=c),typeof i[3+o]=="number"&&(i[3+o]/=c),a(i)}};let zS=!1;class Gce extends H.Component{componentDidMount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:r,layoutId:i}=this.props,{projection:a}=e;ule(jce),a&&(n.group&&n.group.add(a),r&&r.register&&i&&r.register(a),zS&&a.root.didUpdate(),a.addEventListener("animationComplete",()=>{this.safeToRemove()}),a.setOptions({...a.options,onExitComplete:()=>this.safeToRemove()})),zx.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:n,visualElement:r,drag:i,isPresent:a}=this.props,{projection:o}=r;return o&&(o.isPresent=a,zS=!0,i||e.layoutDependency!==n||n===void 0||e.isPresent!==a?o.willUpdate():this.safeToRemove(),e.isPresent!==a&&(a?o.promote():o.relegate()||ui.postRender(()=>{const s=o.getStack();(!s||!s.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),G_.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:r}=this.props,{projection:i}=e;zS=!0,i&&(i.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(i),r&&r.deregister&&r.deregister(i))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function y$(t){const[e,n]=UB(),r=H.useContext(e2);return j.jsx(Gce,{...t,layoutGroup:r,switchLayoutGroup:H.useContext(ZB),isPresent:e,safeToRemove:n})}const jce={borderRadius:{...U1,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:U1,borderTopRightRadius:U1,borderBottomLeftRadius:U1,borderBottomRightRadius:U1,boxShadow:$ce};function zce(t,e,n){const r=_o(t)?t:om(t);return r.start(Q_("",r,e,n)),r.animation}const Wce=(t,e)=>t.depth-e.depth;class Hce{constructor(){this.children=[],this.isDirty=!1}add(e){T_(this.children,e),this.isDirty=!0}remove(e){E_(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(Wce),this.isDirty=!1,this.children.forEach(e)}}function Kce(t,e){const n=ws.now(),r=({timestamp:i})=>{const a=i-n;a>=e&&(c0(r),t(a-e))};return ui.setup(r,!0),()=>c0(r)}const x$=["TopLeft","TopRight","BottomLeft","BottomRight"],qce=x$.length,CA=t=>typeof t=="string"?parseFloat(t):t,SA=t=>typeof t=="number"||Sn.test(t);function Xce(t,e,n,r,i,a){i?(t.opacity=_i(0,n.opacity??1,Yce(r)),t.opacityExit=_i(e.opacity??1,0,Jce(r))):a&&(t.opacity=_i(e.opacity??1,n.opacity??1,r));for(let o=0;o<qce;o++){const s=`border${x$[o]}Radius`;let l=TA(e,s),c=TA(n,s);if(l===void 0&&c===void 0)continue;l||(l=0),c||(c=0),l===0||c===0||SA(l)===SA(c)?(t[s]=Math.max(_i(CA(l),CA(c),r),0),(au.test(c)||au.test(l))&&(t[s]+="%")):t[s]=c}(e.rotate||n.rotate)&&(t.rotate=_i(e.rotate||0,n.rotate||0,r))}function TA(t,e){return t[e]!==void 0?t[e]:t.borderRadius}const Yce=b$(0,.5,aB),Jce=b$(.5,.95,Rl);function b$(t,e,n){return r=>r<t?0:r>e?1:n(t2(t,e,r))}function EA(t,e){t.min=e.min,t.max=e.max}function wl(t,e){EA(t.x,e.x),EA(t.y,e.y)}function _A(t,e){t.translate=e.translate,t.scale=e.scale,t.originPoint=e.originPoint,t.origin=e.origin}function DA(t,e,n,r,i){return t-=e,t=Bb(t,1/n,r),i!==void 0&&(t=Bb(t,1/i,r)),t}function Zce(t,e=0,n=1,r=.5,i,a=t,o=t){if(au.test(e)&&(e=parseFloat(e),e=_i(o.min,o.max,e/100)-o.min),typeof e!="number")return;let s=_i(a.min,a.max,r);t===a&&(s-=e),t.min=DA(t.min,e,n,s,i),t.max=DA(t.max,e,n,s,i)}function OA(t,e,[n,r,i],a,o){Zce(t,e[n],e[r],e[i],e.scale,a,o)}const Qce=["x","scaleX","originX"],eue=["y","scaleY","originY"];function MA(t,e,n,r){OA(t.x,e,Qce,n?n.x:void 0,r?r.x:void 0),OA(t.y,e,eue,n?n.y:void 0,r?r.y:void 0)}function IA(t){return t.translate===0&&t.scale===1}function w$(t){return IA(t.x)&&IA(t.y)}function RA(t,e){return t.min===e.min&&t.max===e.max}function tue(t,e){return RA(t.x,e.x)&&RA(t.y,e.y)}function AA(t,e){return Math.round(t.min)===Math.round(e.min)&&Math.round(t.max)===Math.round(e.max)}function C$(t,e){return AA(t.x,e.x)&&AA(t.y,e.y)}function PA(t){return Xo(t.x)/Xo(t.y)}function NA(t,e){return t.translate===e.translate&&t.scale===e.scale&&t.originPoint===e.originPoint}class nue{constructor(){this.members=[]}add(e){T_(this.members,e),e.scheduleRender()}remove(e){if(E_(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(e){const n=this.members.findIndex(i=>e===i);if(n===0)return!1;let r;for(let i=n;i>=0;i--){const a=this.members[i];if(a.isPresent!==!1){r=a;break}}return r?(this.promote(r),!0):!1}promote(e,n){const r=this.lead;if(e!==r&&(this.prevLead=r,this.lead=e,e.show(),r)){r.instance&&r.scheduleRender(),e.scheduleRender(),e.resumeFrom=r,n&&(e.resumeFrom.preserveOpacity=!0),r.snapshot&&(e.snapshot=r.snapshot,e.snapshot.latestValues=r.animationValues||r.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:i}=e.options;i===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:n,resumingFrom:r}=e;n.onExitComplete&&n.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function rue(t,e,n){let r="";const i=t.x.translate/e.x,a=t.y.translate/e.y,o=n?.z||0;if((i||a||o)&&(r=`translate3d(${i}px, ${a}px, ${o}px) `),(e.x!==1||e.y!==1)&&(r+=`scale(${1/e.x}, ${1/e.y}) `),n){const{transformPerspective:c,rotate:f,rotateX:u,rotateY:d,skewX:h,skewY:p}=n;c&&(r=`perspective(${c}px) ${r}`),f&&(r+=`rotate(${f}deg) `),u&&(r+=`rotateX(${u}deg) `),d&&(r+=`rotateY(${d}deg) `),h&&(r+=`skewX(${h}deg) `),p&&(r+=`skewY(${p}deg) `)}const s=t.x.scale*e.x,l=t.y.scale*e.y;return(s!==1||l!==1)&&(r+=`scale(${s}, ${l})`),r||"none"}const rh={nodes:0,calculatedTargetDeltas:0,calculatedProjections:0},WS=["","X","Y","Z"],iue=1e3;let aue=0;function HS(t,e,n,r){const{latestValues:i}=e;i[t]&&(n[t]=i[t],e.setStaticValue(t,0),r&&(r[t]=0))}function S$(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return;const{visualElement:e}=t.options;if(!e)return;const n=l$(e);if(window.MotionHasOptimisedAnimation(n,"transform")){const{layout:i,layoutId:a}=t.options;window.MotionCancelOptimisedAnimation(n,"transform",ui,!(i||a))}const{parent:r}=t;r&&!r.hasCheckedOptimisedAppear&&S$(r)}function T$({attachResizeListener:t,defaultParent:e,measureScroll:n,checkIsScrollRoot:r,resetTransform:i}){return class{constructor(o={},s=e?.()){this.id=aue++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,Yc.value&&(rh.nodes=rh.calculatedTargetDeltas=rh.calculatedProjections=0),this.nodes.forEach(lue),this.nodes.forEach(due),this.nodes.forEach(hue),this.nodes.forEach(cue),Yc.addProjectionMetrics&&Yc.addProjectionMetrics(rh)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=s?s.root||s:this,this.path=s?[...s.path,s]:[],this.parent=s,this.depth=s?s.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new Hce)}addEventListener(o,s){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new O_),this.eventHandlers.get(o).add(s)}notifyListeners(o,...s){const l=this.eventHandlers.get(o);l&&l.notify(...s)}hasListeners(o){return this.eventHandlers.has(o)}mount(o){if(this.instance)return;this.isSVG=FB(o)&&!Wse(o),this.instance=o;const{layoutId:s,layout:l,visualElement:c}=this.options;if(c&&!c.current&&c.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(l||s)&&(this.isLayoutDirty=!0),t){let f,u=0;const d=()=>this.root.updateBlockedByResize=!1;ui.read(()=>{u=window.innerWidth}),t(o,()=>{const h=window.innerWidth;h!==u&&(u=h,this.root.updateBlockedByResize=!0,f&&f(),f=Kce(d,250),zx.hasAnimatedSinceResize&&(zx.hasAnimatedSinceResize=!1,this.nodes.forEach(VA)))})}s&&this.root.registerSharedNode(s,this),this.options.animate!==!1&&c&&(s||l)&&this.addEventListener("didUpdate",({delta:f,hasLayoutChanged:u,hasRelativeLayoutChanged:d,layout:h})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const p=this.options.transition||c.getDefaultTransition()||yue,{onLayoutAnimationStart:g,onLayoutAnimationComplete:m}=c.getProps(),y=!this.targetLayout||!C$(this.targetLayout,h),v=!u&&d;if(this.options.layoutRoot||this.resumeFrom||v||u&&(y||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const x={...B_(p,"layout"),onPlay:g,onComplete:m};(c.shouldReduceMotion||this.options.layoutRoot)&&(x.delay=0,x.type=!1),this.startAnimation(x),this.setAnimationOrigin(f,v)}else u||VA(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=h})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),c0(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(pue),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&S$(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let f=0;f<this.path.length;f++){const u=this.path[f];u.shouldResetTransform=!0,u.updateScroll("snapshot"),u.options.layoutRoot&&u.willUpdate(!1)}const{layoutId:s,layout:l}=this.options;if(s===void 0&&!l)return;const c=this.getTransformTemplate();this.prevTransformTemplateValue=c?c(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(LA);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(kA);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(fue),this.nodes.forEach(oue),this.nodes.forEach(sue)):this.nodes.forEach(kA),this.clearAllSnapshots();const s=ws.now();ro.delta=Af(0,1e3/60,s-ro.timestamp),ro.timestamp=s,ro.isProcessing=!0,PS.update.process(ro),PS.preRender.process(ro),PS.render.process(ro),ro.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,G_.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(uue),this.sharedNodes.forEach(gue)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,ui.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){ui.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!Xo(this.snapshot.measuredBox.x)&&!Xo(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Zi(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:s}=this.options;s&&s.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let s=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(s=!1),s&&this.instance){const l=r(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:l,offset:n(this.instance),wasRoot:this.scroll?this.scroll.isRoot:l}}}resetTransform(){if(!i)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,s=this.projectionDelta&&!w$(this.projectionDelta),l=this.getTransformTemplate(),c=l?l(this.latestValues,""):void 0,f=c!==this.prevTransformTemplateValue;o&&this.instance&&(s||nh(this.latestValues)||f)&&(i(this.instance,c),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const s=this.measurePageBox();let l=this.removeElementScroll(s);return o&&(l=this.removeTransform(l)),xue(l),{animationId:this.root.animationId,measuredBox:s,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:o}=this.options;if(!o)return Zi();const s=o.measureViewportBox();if(!(this.scroll?.wasRoot||this.path.some(bue))){const{scroll:c}=this.root;c&&(gg(s.x,c.offset.x),gg(s.y,c.offset.y))}return s}removeElementScroll(o){const s=Zi();if(wl(s,o),this.scroll?.wasRoot)return s;for(let l=0;l<this.path.length;l++){const c=this.path[l],{scroll:f,options:u}=c;c!==this.root&&f&&u.layoutScroll&&(f.wasRoot&&wl(s,o),gg(s.x,f.offset.x),gg(s.y,f.offset.y))}return s}applyTransform(o,s=!1){const l=Zi();wl(l,o);for(let c=0;c<this.path.length;c++){const f=this.path[c];!s&&f.options.layoutScroll&&f.scroll&&f!==f.root&&mg(l,{x:-f.scroll.offset.x,y:-f.scroll.offset.y}),nh(f.latestValues)&&mg(l,f.latestValues)}return nh(this.latestValues)&&mg(l,this.latestValues),l}removeTransform(o){const s=Zi();wl(s,o);for(let l=0;l<this.path.length;l++){const c=this.path[l];if(!c.instance||!nh(c.latestValues))continue;mE(c.latestValues)&&c.updateSnapshot();const f=Zi(),u=c.measurePageBox();wl(f,u),MA(s,c.latestValues,c.snapshot?c.snapshot.layoutBox:void 0,f)}return nh(this.latestValues)&&MA(s,this.latestValues),s}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==ro.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){const s=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=s.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=s.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=s.isSharedProjectionDirty);const l=!!this.resumingFrom||this!==s;if(!(o||l&&this.isSharedProjectionDirty||this.isProjectionDirty||this.parent?.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:f,layoutId:u}=this.options;if(!(!this.layout||!(f||u))){if(this.resolvedRelativeTargetAt=ro.timestamp,!this.targetDelta&&!this.relativeTarget){const d=this.getClosestProjectingParent();d&&d.layout&&this.animationProgress!==1?(this.relativeParent=d,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Zi(),this.relativeTargetOrigin=Zi(),Iv(this.relativeTargetOrigin,this.layout.layoutBox,d.layout.layoutBox),wl(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=Zi(),this.targetWithTransforms=Zi()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),_ce(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):wl(this.target,this.layout.layoutBox),n$(this.target,this.targetDelta)):wl(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const d=this.getClosestProjectingParent();d&&!!d.resumingFrom==!!this.resumingFrom&&!d.options.layoutScroll&&d.target&&this.animationProgress!==1?(this.relativeParent=d,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Zi(),this.relativeTargetOrigin=Zi(),Iv(this.relativeTargetOrigin,this.target,d.target),wl(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}Yc.value&&rh.calculatedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||mE(this.parent.latestValues)||t$(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){const o=this.getLead(),s=!!this.resumingFrom||this!==o;let l=!0;if((this.isProjectionDirty||this.parent?.isProjectionDirty)&&(l=!1),s&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(l=!1),this.resolvedRelativeTargetAt===ro.timestamp&&(l=!1),l)return;const{layout:c,layoutId:f}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(c||f))return;wl(this.layoutCorrected,this.layout.layoutBox);const u=this.treeScale.x,d=this.treeScale.y;Fle(this.layoutCorrected,this.treeScale,this.path,s),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox,o.targetWithTransforms=Zi());const{target:h}=o;if(!h){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(_A(this.prevProjectionDelta.x,this.projectionDelta.x),_A(this.prevProjectionDelta.y,this.projectionDelta.y)),Mv(this.projectionDelta,this.layoutCorrected,h,this.latestValues),(this.treeScale.x!==u||this.treeScale.y!==d||!NA(this.projectionDelta.x,this.prevProjectionDelta.x)||!NA(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",h)),Yc.value&&rh.calculatedProjections++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){if(this.options.visualElement?.scheduleRender(),o){const s=this.getStack();s&&s.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=vg(),this.projectionDelta=vg(),this.projectionDeltaWithTransform=vg()}setAnimationOrigin(o,s=!1){const l=this.snapshot,c=l?l.latestValues:{},f={...this.latestValues},u=vg();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!s;const d=Zi(),h=l?l.source:void 0,p=this.layout?this.layout.source:void 0,g=h!==p,m=this.getStack(),y=!m||m.members.length<=1,v=!!(g&&!y&&this.options.crossfade===!0&&!this.path.some(vue));this.animationProgress=0;let x;this.mixTargetDelta=w=>{const S=w/1e3;FA(u.x,o.x,S),FA(u.y,o.y,S),this.setTargetDelta(u),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Iv(d,this.layout.layoutBox,this.relativeParent.layout.layoutBox),mue(this.relativeTarget,this.relativeTargetOrigin,d,S),x&&tue(this.relativeTarget,x)&&(this.isProjectionDirty=!1),x||(x=Zi()),wl(x,this.relativeTarget)),g&&(this.animationValues=f,Xce(f,c,this.latestValues,S,v,y)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=S},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation?.stop(),this.resumingFrom?.currentAnimation?.stop(),this.pendingAnimation&&(c0(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=ui.update(()=>{zx.hasAnimatedSinceResize=!0,Ah.layout++,this.motionValue||(this.motionValue=om(0)),this.currentAnimation=zce(this.motionValue,[0,1e3],{...o,velocity:0,isSync:!0,onUpdate:s=>{this.mixTargetDelta(s),o.onUpdate&&o.onUpdate(s)},onStop:()=>{Ah.layout--},onComplete:()=>{Ah.layout--,o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(iue),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:s,target:l,layout:c,latestValues:f}=o;if(!(!s||!l||!c)){if(this!==o&&this.layout&&c&&E$(this.options.animationType,this.layout.layoutBox,c.layoutBox)){l=this.target||Zi();const u=Xo(this.layout.layoutBox.x);l.x.min=o.target.x.min,l.x.max=l.x.min+u;const d=Xo(this.layout.layoutBox.y);l.y.min=o.target.y.min,l.y.max=l.y.min+d}wl(s,l),mg(s,f),Mv(this.projectionDeltaWithTransform,this.layoutCorrected,s,f)}}registerSharedNode(o,s){this.sharedNodes.has(o)||this.sharedNodes.set(o,new nue),this.sharedNodes.get(o).add(s);const c=s.options.initialPromotionConfig;s.promote({transition:c?c.transition:void 0,preserveFollowOpacity:c&&c.shouldPreserveFollowOpacity?c.shouldPreserveFollowOpacity(s):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){const{layoutId:o}=this.options;return o?this.getStack()?.lead||this:this}getPrevLead(){const{layoutId:o}=this.options;return o?this.getStack()?.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:s,preserveFollowOpacity:l}={}){const c=this.getStack();c&&c.promote(this,l),o&&(this.projectionDelta=void 0,this.needsReset=!0),s&&this.setOptions({transition:s})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let s=!1;const{latestValues:l}=o;if((l.z||l.rotate||l.rotateX||l.rotateY||l.rotateZ||l.skewX||l.skewY)&&(s=!0),!s)return;const c={};l.z&&HS("z",o,c,this.animationValues);for(let f=0;f<WS.length;f++)HS(`rotate${WS[f]}`,o,c,this.animationValues),HS(`skew${WS[f]}`,o,c,this.animationValues);o.render();for(const f in c)o.setStaticValue(f,c[f]),this.animationValues&&(this.animationValues[f]=c[f]);o.scheduleRender()}applyProjectionStyles(o,s){if(!this.instance||this.isSVG)return;if(!this.isVisible){o.visibility="hidden";return}const l=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,o.visibility="",o.opacity="",o.pointerEvents=jx(s?.pointerEvents)||"",o.transform=l?l(this.latestValues,""):"none";return}const c=this.getLead();if(!this.projectionDelta||!this.layout||!c.target){this.options.layoutId&&(o.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,o.pointerEvents=jx(s?.pointerEvents)||""),this.hasProjected&&!nh(this.latestValues)&&(o.transform=l?l({},""):"none",this.hasProjected=!1);return}o.visibility="";const f=c.animationValues||c.latestValues;this.applyTransformsToTarget();let u=rue(this.projectionDeltaWithTransform,this.treeScale,f);l&&(u=l(f,u)),o.transform=u;const{x:d,y:h}=this.projectionDelta;o.transformOrigin=`${d.origin*100}% ${h.origin*100}% 0`,c.animationValues?o.opacity=c===this?f.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:f.opacityExit:o.opacity=c===this?f.opacity!==void 0?f.opacity:"":f.opacityExit!==void 0?f.opacityExit:0;for(const p in o2){if(f[p]===void 0)continue;const{correct:g,applyTo:m,isCSSVariable:y}=o2[p],v=u==="none"?f[p]:g(f[p],c);if(m){const x=m.length;for(let w=0;w<x;w++)o[m[w]]=v}else y?this.options.visualElement.renderState.vars[p]=v:o[p]=v}this.options.layoutId&&(o.pointerEvents=c===this?jx(s?.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>o.currentAnimation?.stop()),this.root.nodes.forEach(LA),this.root.sharedNodes.clear()}}}function oue(t){t.updateLayout()}function sue(t){const e=t.resumeFrom?.snapshot||t.snapshot;if(t.isLead()&&t.layout&&e&&t.hasListeners("didUpdate")){const{layoutBox:n,measuredBox:r}=t.layout,{animationType:i}=t.options,a=e.source!==t.layout.source;i==="size"?Sl(f=>{const u=a?e.measuredBox[f]:e.layoutBox[f],d=Xo(u);u.min=n[f].min,u.max=u.min+d}):E$(i,e.layoutBox,n)&&Sl(f=>{const u=a?e.measuredBox[f]:e.layoutBox[f],d=Xo(n[f]);u.max=u.min+d,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[f].max=t.relativeTarget[f].min+d)});const o=vg();Mv(o,n,e.layoutBox);const s=vg();a?Mv(s,t.applyTransform(r,!0),e.measuredBox):Mv(s,n,e.layoutBox);const l=!w$(o);let c=!1;if(!t.resumeFrom){const f=t.getClosestProjectingParent();if(f&&!f.resumeFrom){const{snapshot:u,layout:d}=f;if(u&&d){const h=Zi();Iv(h,e.layoutBox,u.layoutBox);const p=Zi();Iv(p,n,d.layoutBox),C$(h,p)||(c=!0),f.options.layoutRoot&&(t.relativeTarget=p,t.relativeTargetOrigin=h,t.relativeParent=f)}}}t.notifyListeners("didUpdate",{layout:n,snapshot:e,delta:s,layoutDelta:o,hasLayoutChanged:l,hasRelativeLayoutChanged:c})}else if(t.isLead()){const{onExitComplete:n}=t.options;n&&n()}t.options.transition=void 0}function lue(t){Yc.value&&rh.nodes++,t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function cue(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function uue(t){t.clearSnapshot()}function LA(t){t.clearMeasurements()}function kA(t){t.isLayoutDirty=!1}function fue(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function VA(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function due(t){t.resolveTargetDelta()}function hue(t){t.calcProjection()}function pue(t){t.resetSkewAndRotation()}function gue(t){t.removeLeadSnapshot()}function FA(t,e,n){t.translate=_i(e.translate,0,n),t.scale=_i(e.scale,1,n),t.origin=e.origin,t.originPoint=e.originPoint}function UA(t,e,n,r){t.min=_i(e.min,n.min,r),t.max=_i(e.max,n.max,r)}function mue(t,e,n,r){UA(t.x,e.x,n.x,r),UA(t.y,e.y,n.y,r)}function vue(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const yue={duration:.45,ease:[.4,0,.1,1]},BA=t=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(t),$A=BA("applewebkit/")&&!BA("chrome/")?Math.round:Rl;function GA(t){t.min=$A(t.min),t.max=$A(t.max)}function xue(t){GA(t.x),GA(t.y)}function E$(t,e,n){return t==="position"||t==="preserve-aspect"&&!Ece(PA(e),PA(n),.2)}function bue(t){return t!==t.root&&t.scroll?.wasRoot}const wue=T$({attachResizeListener:(t,e)=>s2(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),KS={current:void 0},_$=T$({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!KS.current){const t=new wue({});t.mount(window),t.setOptions({layoutScroll:!0}),KS.current=t}return KS.current},resetTransform:(t,e)=>{t.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),Cue={pan:{Feature:Bce},drag:{Feature:Uce,ProjectionNode:_$,MeasureLayout:y$}};function jA(t,e,n){const{props:r}=t;t.animationState&&r.whileHover&&t.animationState.setActive("whileHover",n==="Start");const i="onHover"+n,a=r[i];a&&ui.postRender(()=>a(e,H2(e)))}class Sue extends E0{mount(){const{current:e}=this.node;e&&(this.unmount=Bse(e,(n,r)=>(jA(this.node,r,"Start"),i=>jA(this.node,i,"End"))))}unmount(){}}class Tue extends E0{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=j2(s2(this.node.current,"focus",()=>this.onFocus()),s2(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function zA(t,e,n){const{props:r}=t;if(t.current instanceof HTMLButtonElement&&t.current.disabled)return;t.animationState&&r.whileTap&&t.animationState.setActive("whileTap",n==="Start");const i="onTap"+(n==="End"?"":n),a=r[i];a&&ui.postRender(()=>a(e,H2(e)))}class Eue extends E0{mount(){const{current:e}=this.node;e&&(this.unmount=zse(e,(n,r)=>(zA(this.node,r,"Start"),(i,{success:a})=>zA(this.node,i,a?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const SE=new WeakMap,qS=new WeakMap,_ue=t=>{const e=SE.get(t.target);e&&e(t)},Due=t=>{t.forEach(_ue)};function Oue({root:t,...e}){const n=t||document;qS.has(n)||qS.set(n,{});const r=qS.get(n),i=JSON.stringify(e);return r[i]||(r[i]=new IntersectionObserver(Due,{root:t,...e})),r[i]}function Mue(t,e,n){const r=Oue(e);return SE.set(t,n),r.observe(t),()=>{SE.delete(t),r.unobserve(t)}}const Iue={some:0,all:1};class Rue extends E0{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:n,margin:r,amount:i="some",once:a}=e,o={root:n?n.current:void 0,rootMargin:r,threshold:typeof i=="number"?i:Iue[i]},s=l=>{const{isIntersecting:c}=l;if(this.isInView===c||(this.isInView=c,a&&!c&&this.hasEnteredView))return;c&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",c);const{onViewportEnter:f,onViewportLeave:u}=this.node.getProps(),d=c?f:u;d&&d(l)};return Mue(this.node.current,o,s)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:n}=this.node;["amount","margin","root"].some(Aue(e,n))&&this.startObserver()}unmount(){}}function Aue({viewport:t={}},{viewport:e={}}={}){return n=>t[n]!==e[n]}const Pue={inView:{Feature:Rue},tap:{Feature:Eue},focus:{Feature:Tue},hover:{Feature:Sue}},Nue={layout:{ProjectionNode:_$,MeasureLayout:y$}},Lue={renderer:qle,...xce,...Pue},kue={...Lue,...Cue,...Nue},eu={top:"top",bottom:"top",left:"left",right:"left"},$b={top:"bottom",bottom:"top",left:"right",right:"left"},Vue={top:"left",left:"top"},TE={top:"height",left:"width"},D$={width:"totalWidth",height:"totalHeight"},I5={};let Ga=typeof document<"u"?window.visualViewport:null;function WA(t){let e=0,n=0,r=0,i=0,a=0,o=0,s={};var l;let c=((l=Ga?.scale)!==null&&l!==void 0?l:1)>1;if(t.tagName==="BODY"){let p=document.documentElement;r=p.clientWidth,i=p.clientHeight;var f;e=(f=Ga?.width)!==null&&f!==void 0?f:r;var u;n=(u=Ga?.height)!==null&&u!==void 0?u:i,s.top=p.scrollTop||t.scrollTop,s.left=p.scrollLeft||t.scrollLeft,Ga&&(a=Ga.offsetTop,o=Ga.offsetLeft)}else({width:e,height:n,top:a,left:o}=Fg(t)),s.top=t.scrollTop,s.left=t.scrollLeft,r=e,i=n;if(y_()&&(t.tagName==="BODY"||t.tagName==="HTML")&&c){s.top=0,s.left=0;var d;a=(d=Ga?.pageTop)!==null&&d!==void 0?d:0;var h;o=(h=Ga?.pageLeft)!==null&&h!==void 0?h:0}return{width:e,height:n,totalWidth:r,totalHeight:i,scroll:s,top:a,left:o}}function Fue(t){return{top:t.scrollTop,left:t.scrollLeft,width:t.scrollWidth,height:t.scrollHeight}}function HA(t,e,n,r,i,a,o){var s;let l=(s=i.scroll[t])!==null&&s!==void 0?s:0,c=r[TE[t]],f=r.scroll[eu[t]]+a,u=c+r.scroll[eu[t]]-a,d=e-l+o[t]-r[eu[t]],h=e-l+n+o[t]-r[eu[t]];return d<f?f-d:h>u?Math.max(u-h,f-d):0}function Uue(t){let e=window.getComputedStyle(t);return{top:parseInt(e.marginTop,10)||0,bottom:parseInt(e.marginBottom,10)||0,left:parseInt(e.marginLeft,10)||0,right:parseInt(e.marginRight,10)||0}}function KA(t){if(I5[t])return I5[t];let[e,n]=t.split(" "),r=eu[e]||"right",i=Vue[r];eu[n]||(n="center");let a=TE[r],o=TE[i];return I5[t]={placement:e,crossPlacement:n,axis:r,crossAxis:i,size:a,crossSize:o},I5[t]}function XS(t,e,n,r,i,a,o,s,l,c){let{placement:f,crossPlacement:u,axis:d,crossAxis:h,size:p,crossSize:g}=r,m={};var y;m[h]=(y=t[h])!==null&&y!==void 0?y:0;var v,x,w,S;u==="center"?m[h]+=(((v=t[g])!==null&&v!==void 0?v:0)-((x=n[g])!==null&&x!==void 0?x:0))/2:u!==h&&(m[h]+=((w=t[g])!==null&&w!==void 0?w:0)-((S=n[g])!==null&&S!==void 0?S:0)),m[h]+=a;const T=t[h]-n[g]+l+c,_=t[h]+t[g]-l-c;if(m[h]=tE(m[h],T,_),f===d){const D=s?o[p]:e[D$[p]];m[$b[d]]=Math.floor(D-t[d]+i)}else m[d]=Math.floor(t[d]+t[p]+i);return m}function Bue(t,e,n,r,i,a,o,s){const l=r?n.height:e[D$.height];var c;let f=t.top!=null?n.top+t.top:n.top+(l-((c=t.bottom)!==null&&c!==void 0?c:0)-o);var u,d,h,p,g,m;let y=s!=="top"?Math.max(0,e.height+e.top+((u=e.scroll.top)!==null&&u!==void 0?u:0)-f-(((d=i.top)!==null&&d!==void 0?d:0)+((h=i.bottom)!==null&&h!==void 0?h:0)+a)):Math.max(0,f+o-(e.top+((p=e.scroll.top)!==null&&p!==void 0?p:0))-(((g=i.top)!==null&&g!==void 0?g:0)+((m=i.bottom)!==null&&m!==void 0?m:0)+a));return Math.min(e.height-a*2,y)}function qA(t,e,n,r,i,a){let{placement:o,axis:s,size:l}=a;var c,f;if(o===s)return Math.max(0,n[s]-t[s]-((c=t.scroll[s])!==null&&c!==void 0?c:0)+e[s]-((f=r[s])!==null&&f!==void 0?f:0)-r[$b[s]]-i);var u;return Math.max(0,t[l]+t[s]+t.scroll[s]-e[s]-n[s]-n[l]-((u=r[s])!==null&&u!==void 0?u:0)-r[$b[s]]-i)}function $ue(t,e,n,r,i,a,o,s,l,c,f,u,d,h,p,g){let m=KA(t),{size:y,crossAxis:v,crossSize:x,placement:w,crossPlacement:S}=m,T=XS(e,s,n,m,f,u,c,d,p,g),_=f,D=qA(s,c,e,i,a+f,m);if(o&&r[y]>D){let ye=KA(`${$b[w]} ${S}`),me=XS(e,s,n,ye,f,u,c,d,p,g);qA(s,c,e,i,a+f,ye)>D&&(m=ye,T=me,_=f)}let I="bottom";m.axis==="top"?m.placement==="top"?I="top":m.placement==="bottom"&&(I="bottom"):m.crossAxis==="top"&&(m.crossPlacement==="top"?I="bottom":m.crossPlacement==="bottom"&&(I="top"));let R=HA(v,T[v],n[x],s,l,a,c);T[v]+=R;let M=Bue(T,s,c,d,i,a,n.height,I);h&&h<M&&(M=h),n.height=Math.min(n.height,M),T=XS(e,s,n,m,_,u,c,d,p,g),R=HA(v,T[v],n[x],s,l,a,c),T[v]+=R;let A={},L=e[v]+.5*e[x]-T[v]-i[eu[v]];const P=p/2+g;var B,U,G,F;const $=eu[v]==="left"?((B=i.left)!==null&&B!==void 0?B:0)+((U=i.right)!==null&&U!==void 0?U:0):((G=i.top)!==null&&G!==void 0?G:0)+((F=i.bottom)!==null&&F!==void 0?F:0),V=n[x]-$-p/2-g,X=e[v]+p/2-(T[v]+i[eu[v]]),Q=e[v]+e[x]-p/2-(T[v]+i[eu[v]]),re=tE(L,X,Q);return A[v]=tE(re,P,V),{position:T,maxHeight:M,arrowOffsetLeft:A.left,arrowOffsetTop:A.top,placement:m.placement}}function Gue(t){let{placement:e,targetNode:n,overlayNode:r,scrollNode:i,padding:a,shouldFlip:o,boundaryElement:s,offset:l,crossOffset:c,maxHeight:f,arrowSize:u=0,arrowBoundaryOffset:d=0}=t,h=r instanceof HTMLElement?jue(r):document.documentElement,p=h===document.documentElement;const g=window.getComputedStyle(h).position;let m=!!g&&g!=="static",y=p?Fg(n):XA(n,h);if(!p){let{marginTop:A,marginLeft:L}=window.getComputedStyle(n);y.top+=parseInt(A,10)||0,y.left+=parseInt(L,10)||0}let v=Fg(r),x=Uue(r);var w,S;v.width+=((w=x.left)!==null&&w!==void 0?w:0)+((S=x.right)!==null&&S!==void 0?S:0);var T,_;v.height+=((T=x.top)!==null&&T!==void 0?T:0)+((_=x.bottom)!==null&&_!==void 0?_:0);let D=Fue(i),I=WA(s),R=WA(h),M=s.tagName==="BODY"?Fg(h):XA(h,s);return h.tagName==="HTML"&&s.tagName==="BODY"&&(R.scroll.top=0,R.scroll.left=0),$ue(e,y,v,D,x,a,o,I,R,M,l,c,m,f,u,d)}function Fg(t){let{top:e,left:n,width:r,height:i}=t.getBoundingClientRect(),{scrollTop:a,scrollLeft:o,clientTop:s,clientLeft:l}=document.documentElement;return{top:e+a-s,left:n+o-l,width:r,height:i}}function XA(t,e){let n=window.getComputedStyle(t),r;if(n.position==="fixed"){let{top:i,left:a,width:o,height:s}=t.getBoundingClientRect();r={top:i,left:a,width:o,height:s}}else{r=Fg(t);let i=Fg(e),a=window.getComputedStyle(e);i.top+=(parseInt(a.borderTopWidth,10)||0)-e.scrollTop,i.left+=(parseInt(a.borderLeftWidth,10)||0)-e.scrollLeft,r.top-=i.top,r.left-=i.left}return r.top-=parseInt(n.marginTop,10)||0,r.left-=parseInt(n.marginLeft,10)||0,r}function jue(t){let e=t.offsetParent;if(e&&e===document.body&&window.getComputedStyle(e).position==="static"&&!YA(e)&&(e=document.documentElement),e==null)for(e=t.parentElement;e&&!YA(e);)e=e.parentElement;return e||document.documentElement}function YA(t){let e=window.getComputedStyle(t);return e.transform!=="none"||/transform|perspective/.test(e.willChange)||e.filter!=="none"||e.contain==="paint"||"backdropFilter"in e&&e.backdropFilter!=="none"||"WebkitBackdropFilter"in e&&e.WebkitBackdropFilter!=="none"}const O$=new WeakMap;function zue(t){let{triggerRef:e,isOpen:n,onClose:r}=t;H.useEffect(()=>{if(!n||r===null)return;let i=a=>{let o=a.target;if(!e.current||o instanceof Node&&!o.contains(e.current)||a.target instanceof HTMLInputElement||a.target instanceof HTMLTextAreaElement)return;let s=r||O$.get(e.current);s&&s()};return window.addEventListener("scroll",i,!0),()=>{window.removeEventListener("scroll",i,!0)}},[n,r,e])}let Ji=typeof document<"u"?window.visualViewport:null;function Wue(t){let{direction:e}=ap(),{arrowSize:n=0,targetRef:r,overlayRef:i,scrollRef:a=i,placement:o="bottom",containerPadding:s=12,shouldFlip:l=!0,boundaryElement:c=typeof document<"u"?document.body:null,offset:f=0,crossOffset:u=0,shouldUpdatePosition:d=!0,isOpen:h=!0,onClose:p,maxHeight:g,arrowBoundaryOffset:m=0}=t,[y,v]=H.useState(null),x=[d,o,i.current,r.current,a.current,s,l,c,f,u,h,e,g,m,n],w=H.useRef(Ji?.scale);H.useEffect(()=>{h&&(w.current=Ji?.scale)},[h]);let S=H.useCallback(()=>{if(d===!1||!h||!i.current||!r.current||!c||Ji?.scale!==w.current)return;let R=null;if(a.current&&a.current.contains(document.activeElement)){var M;let F=(M=document.activeElement)===null||M===void 0?void 0:M.getBoundingClientRect(),$=a.current.getBoundingClientRect();var A;if(R={type:"top",offset:((A=F?.top)!==null&&A!==void 0?A:0)-$.top},R.offset>$.height/2){R.type="bottom";var L;R.offset=((L=F?.bottom)!==null&&L!==void 0?L:0)-$.bottom}}let P=i.current;if(!g&&i.current){var B;P.style.top="0px",P.style.bottom="";var U;P.style.maxHeight=((U=(B=window.visualViewport)===null||B===void 0?void 0:B.height)!==null&&U!==void 0?U:window.innerHeight)+"px"}let G=Gue({placement:Kue(o,e),overlayNode:i.current,targetNode:r.current,scrollNode:a.current||i.current,padding:s,shouldFlip:l,boundaryElement:c,offset:f,crossOffset:u,maxHeight:g,arrowSize:n,arrowBoundaryOffset:m});if(G.position){if(P.style.top="",P.style.bottom="",P.style.left="",P.style.right="",Object.keys(G.position).forEach(F=>P.style[F]=G.position[F]+"px"),P.style.maxHeight=G.maxHeight!=null?G.maxHeight+"px":"",R&&document.activeElement&&a.current){let F=document.activeElement.getBoundingClientRect(),$=a.current.getBoundingClientRect(),V=F[R.type]-$[R.type];a.current.scrollTop+=V-R.offset}v(G)}},x);Br(S,x),Hue(S),OR({ref:i,onResize:S}),OR({ref:r,onResize:S});let T=H.useRef(!1);Br(()=>{let R,M=()=>{T.current=!0,clearTimeout(R),R=setTimeout(()=>{T.current=!1},500),S()},A=()=>{T.current&&M()};return Ji?.addEventListener("resize",M),Ji?.addEventListener("scroll",A),()=>{Ji?.removeEventListener("resize",M),Ji?.removeEventListener("scroll",A)}},[S]);let _=H.useCallback(()=>{T.current||p?.()},[p,T]);zue({triggerRef:r,isOpen:h,onClose:p&&_});var D,I;return{overlayProps:{style:{position:"absolute",zIndex:1e5,...y?.position,maxHeight:(D=y?.maxHeight)!==null&&D!==void 0?D:"100vh"}},placement:(I=y?.placement)!==null&&I!==void 0?I:null,arrowProps:{"aria-hidden":"true",role:"presentation",style:{left:y?.arrowOffsetLeft,top:y?.arrowOffsetTop}},updatePosition:S}}function Hue(t){Br(()=>(window.addEventListener("resize",t,!1),()=>{window.removeEventListener("resize",t,!1)}),[t])}function Kue(t,e){return e==="rtl"?t.replace("start","right").replace("end","left"):t.replace("start","left").replace("end","right")}function e9(t){let e=t;return e.nativeEvent=t,e.isDefaultPrevented=()=>e.defaultPrevented,e.isPropagationStopped=()=>e.cancelBubble,e.persist=()=>{},e}function M$(t,e){Object.defineProperty(t,"target",{value:e}),Object.defineProperty(t,"currentTarget",{value:e})}function I$(t){let e=H.useRef({isFocused:!1,observer:null});Br(()=>{const r=e.current;return()=>{r.observer&&(r.observer.disconnect(),r.observer=null)}},[]);let n=va(r=>{t?.(r)});return H.useCallback(r=>{if(r.target instanceof HTMLButtonElement||r.target instanceof HTMLInputElement||r.target instanceof HTMLTextAreaElement||r.target instanceof HTMLSelectElement){e.current.isFocused=!0;let i=r.target,a=o=>{if(e.current.isFocused=!1,i.disabled){let s=e9(o);n(s)}e.current.observer&&(e.current.observer.disconnect(),e.current.observer=null)};i.addEventListener("focusout",a,{once:!0}),e.current.observer=new MutationObserver(()=>{if(e.current.isFocused&&i.disabled){var o;(o=e.current.observer)===null||o===void 0||o.disconnect();let s=i===document.activeElement?null:document.activeElement;i.dispatchEvent(new FocusEvent("blur",{relatedTarget:s})),i.dispatchEvent(new FocusEvent("focusout",{bubbles:!0,relatedTarget:s}))}}),e.current.observer.observe(i,{attributes:!0,attributeFilter:["disabled"]})}},[n])}let Gb=!1;function que(t){for(;t&&!HU(t);)t=t.parentElement;let e=Ml(t),n=e.document.activeElement;if(!n||n===t)return;Gb=!0;let r=!1,i=f=>{(f.target===n||r)&&f.stopImmediatePropagation()},a=f=>{(f.target===n||r)&&(f.stopImmediatePropagation(),!t&&!r&&(r=!0,To(n),l()))},o=f=>{(f.target===t||r)&&f.stopImmediatePropagation()},s=f=>{(f.target===t||r)&&(f.stopImmediatePropagation(),r||(r=!0,To(n),l()))};e.addEventListener("blur",i,!0),e.addEventListener("focusout",a,!0),e.addEventListener("focusin",s,!0),e.addEventListener("focus",o,!0);let l=()=>{cancelAnimationFrame(c),e.removeEventListener("blur",i,!0),e.removeEventListener("focusout",a,!0),e.removeEventListener("focusin",s,!0),e.removeEventListener("focus",o,!0),Gb=!1,r=!1},c=requestAnimationFrame(l);return l}let yg="default",EE="",Wx=new WeakMap;function Xue(t){if(gw()){if(yg==="default"){const e=Mr(t);EE=e.documentElement.style.webkitUserSelect,e.documentElement.style.webkitUserSelect="none"}yg="disabled"}else if(t instanceof HTMLElement||t instanceof SVGElement){let e="userSelect"in t.style?"userSelect":"webkitUserSelect";Wx.set(t,t.style[e]),t.style[e]="none"}}function JA(t){if(gw()){if(yg!=="disabled")return;yg="restoring",setTimeout(()=>{$U(()=>{if(yg==="restoring"){const e=Mr(t);e.documentElement.style.webkitUserSelect==="none"&&(e.documentElement.style.webkitUserSelect=EE||""),EE="",yg="default"}})},300)}else if((t instanceof HTMLElement||t instanceof SVGElement)&&t&&Wx.has(t)){let e=Wx.get(t),n="userSelect"in t.style?"userSelect":"webkitUserSelect";t.style[n]==="none"&&(t.style[n]=e),t.getAttribute("style")===""&&t.removeAttribute("style"),Wx.delete(t)}}const t9=Tn.createContext({register:()=>{}});t9.displayName="PressResponderContext";function Yue(t,e){return e.get?e.get.call(t):e.value}function R$(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Jue(t,e){var n=R$(t,e,"get");return Yue(t,n)}function Zue(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function ZA(t,e,n){var r=R$(t,e,"set");return Zue(t,r,n),n}function Que(t){let e=H.useContext(t9);if(e){let{register:n,...r}=e;t=Oi(r,t),n()}return GU(e,t.ref),t}var R5=new WeakMap;class A5{continuePropagation(){ZA(this,R5,!1)}get shouldStopPropagation(){return Jue(this,R5)}constructor(e,n,r,i){hae(this,R5,{writable:!0,value:void 0}),ZA(this,R5,!0);var a;let o=(a=i?.target)!==null&&a!==void 0?a:r.currentTarget;const s=o?.getBoundingClientRect();let l,c=0,f,u=null;r.clientX!=null&&r.clientY!=null&&(f=r.clientX,u=r.clientY),s&&(f!=null&&u!=null?(l=f-s.left,c=u-s.top):(l=s.width/2,c=s.height/2)),this.type=e,this.pointerType=n,this.target=r.currentTarget,this.shiftKey=r.shiftKey,this.metaKey=r.metaKey,this.ctrlKey=r.ctrlKey,this.altKey=r.altKey,this.x=l,this.y=c}}const QA=Symbol("linkClicked"),eP="react-aria-pressable-style",tP="data-react-aria-pressable";function Uf(t){let{onPress:e,onPressChange:n,onPressStart:r,onPressEnd:i,onPressUp:a,onClick:o,isDisabled:s,isPressed:l,preventFocusOnPress:c,shouldCancelOnPointerExit:f,allowTextSelectionOnPress:u,ref:d,...h}=Que(t),[p,g]=H.useState(!1),m=H.useRef({isPressed:!1,ignoreEmulatedMouseEvents:!1,didFirePressStart:!1,isTriggeringEvent:!1,activePointerId:null,target:null,isOverTarget:!1,pointerType:null,disposables:[]}),{addGlobalListener:y,removeAllGlobalListeners:v}=vw(),x=va((M,A)=>{let L=m.current;if(s||L.didFirePressStart)return!1;let P=!0;if(L.isTriggeringEvent=!0,r){let B=new A5("pressstart",A,M);r(B),P=B.shouldStopPropagation}return n&&n(!0),L.isTriggeringEvent=!1,L.didFirePressStart=!0,g(!0),P}),w=va((M,A,L=!0)=>{let P=m.current;if(!P.didFirePressStart)return!1;P.didFirePressStart=!1,P.isTriggeringEvent=!0;let B=!0;if(i){let U=new A5("pressend",A,M);i(U),B=U.shouldStopPropagation}if(n&&n(!1),g(!1),e&&L&&!s){let U=new A5("press",A,M);e(U),B&&(B=U.shouldStopPropagation)}return P.isTriggeringEvent=!1,B}),S=va((M,A)=>{let L=m.current;if(s)return!1;if(a){L.isTriggeringEvent=!0;let P=new A5("pressup",A,M);return a(P),L.isTriggeringEvent=!1,P.shouldStopPropagation}return!0}),T=va(M=>{let A=m.current;if(A.isPressed&&A.target){A.didFirePressStart&&A.pointerType!=null&&w(G0(A.target,M),A.pointerType,!1),A.isPressed=!1,A.isOverTarget=!1,A.activePointerId=null,A.pointerType=null,v(),u||JA(A.target);for(let L of A.disposables)L();A.disposables=[]}}),_=va(M=>{f&&T(M)}),D=va(M=>{o?.(M)}),I=va((M,A)=>{if(o){let L=new MouseEvent("click",M);M$(L,A),o(e9(L))}}),R=H.useMemo(()=>{let M=m.current,A={onKeyDown(P){if(YS(P.nativeEvent,P.currentTarget)&&xs(P.currentTarget,ea(P.nativeEvent))){var B;nP(ea(P.nativeEvent),P.key)&&P.preventDefault();let U=!0;if(!M.isPressed&&!P.repeat){M.target=P.currentTarget,M.isPressed=!0,M.pointerType="keyboard",U=x(P,"keyboard");let G=P.currentTarget,F=$=>{YS($,G)&&!$.repeat&&xs(G,ea($))&&M.target&&S(G0(M.target,$),"keyboard")};y(Mr(P.currentTarget),"keyup",o0(F,L),!0)}U&&P.stopPropagation(),P.metaKey&&s0()&&((B=M.metaKeyEvents)===null||B===void 0||B.set(P.key,P.nativeEvent))}else P.key==="Meta"&&(M.metaKeyEvents=new Map)},onClick(P){if(!(P&&!xs(P.currentTarget,ea(P.nativeEvent)))&&P&&P.button===0&&!M.isTriggeringEvent&&!l0.isOpening){let B=!0;if(s&&P.preventDefault(),!M.ignoreEmulatedMouseEvents&&!M.isPressed&&(M.pointerType==="virtual"||WU(P.nativeEvent))){let U=x(P,"virtual"),G=S(P,"virtual"),F=w(P,"virtual");D(P),B=U&&G&&F}else if(M.isPressed&&M.pointerType!=="keyboard"){let U=M.pointerType||P.nativeEvent.pointerType||"virtual",G=S(G0(P.currentTarget,P),U),F=w(G0(P.currentTarget,P),U,!0);B=G&&F,M.isOverTarget=!1,D(P),T(P)}M.ignoreEmulatedMouseEvents=!1,B&&P.stopPropagation()}}},L=P=>{var B;if(M.isPressed&&M.target&&YS(P,M.target)){var U;nP(ea(P),P.key)&&P.preventDefault();let F=ea(P),$=xs(M.target,ea(P));w(G0(M.target,P),"keyboard",$),$&&I(P,M.target),v(),P.key!=="Enter"&&n9(M.target)&&xs(M.target,F)&&!P[QA]&&(P[QA]=!0,l0(M.target,P,!1)),M.isPressed=!1,(U=M.metaKeyEvents)===null||U===void 0||U.delete(P.key)}else if(P.key==="Meta"&&(!((B=M.metaKeyEvents)===null||B===void 0)&&B.size)){var G;let F=M.metaKeyEvents;M.metaKeyEvents=void 0;for(let $ of F.values())(G=M.target)===null||G===void 0||G.dispatchEvent(new KeyboardEvent("keyup",$))}};if(typeof PointerEvent<"u"){A.onPointerDown=U=>{if(U.button!==0||!xs(U.currentTarget,ea(U.nativeEvent)))return;if(Gae(U.nativeEvent)){M.pointerType="virtual";return}M.pointerType=U.pointerType;let G=!0;if(!M.isPressed){M.isPressed=!0,M.isOverTarget=!0,M.activePointerId=U.pointerId,M.target=U.currentTarget,u||Xue(M.target),G=x(U,M.pointerType);let F=ea(U.nativeEvent);"releasePointerCapture"in F&&F.releasePointerCapture(U.pointerId),y(Mr(U.currentTarget),"pointerup",P,!1),y(Mr(U.currentTarget),"pointercancel",B,!1)}G&&U.stopPropagation()},A.onMouseDown=U=>{if(xs(U.currentTarget,ea(U.nativeEvent))&&U.button===0){if(c){let G=que(U.target);G&&M.disposables.push(G)}U.stopPropagation()}},A.onPointerUp=U=>{!xs(U.currentTarget,ea(U.nativeEvent))||M.pointerType==="virtual"||U.button===0&&!M.isPressed&&S(U,M.pointerType||U.pointerType)},A.onPointerEnter=U=>{U.pointerId===M.activePointerId&&M.target&&!M.isOverTarget&&M.pointerType!=null&&(M.isOverTarget=!0,x(G0(M.target,U),M.pointerType))},A.onPointerLeave=U=>{U.pointerId===M.activePointerId&&M.target&&M.isOverTarget&&M.pointerType!=null&&(M.isOverTarget=!1,w(G0(M.target,U),M.pointerType,!1),_(U))};let P=U=>{if(U.pointerId===M.activePointerId&&M.isPressed&&U.button===0&&M.target){if(xs(M.target,ea(U))&&M.pointerType!=null){let G=!1,F=setTimeout(()=>{M.isPressed&&M.target instanceof HTMLElement&&(G?T(U):(To(M.target),M.target.click()))},80);y(U.currentTarget,"click",()=>G=!0,!0),M.disposables.push(()=>clearTimeout(F))}else T(U);M.isOverTarget=!1}},B=U=>{T(U)};A.onDragStart=U=>{xs(U.currentTarget,ea(U.nativeEvent))&&T(U)}}return A},[y,s,c,v,u,T,_,w,x,S,D,I]);return H.useEffect(()=>{if(!d)return;const M=Mr(d.current);if(!M||!M.head||M.getElementById(eP))return;const A=M.createElement("style");A.id=eP,A.textContent=`
@layer {
  [${tP}] {
    touch-action: pan-x pan-y pinch-zoom;
  }
}
    `.trim(),M.head.prepend(A)},[d]),H.useEffect(()=>{let M=m.current;return()=>{var A;u||JA((A=M.target)!==null&&A!==void 0?A:void 0);for(let L of M.disposables)L();M.disposables=[]}},[u]),{isPressed:l||p,pressProps:Oi(h,R,{[tP]:!0})}}function n9(t){return t.tagName==="A"&&t.hasAttribute("href")}function YS(t,e){const{key:n,code:r}=t,i=e,a=i.getAttribute("role");return(n==="Enter"||n===" "||n==="Spacebar"||r==="Space")&&!(i instanceof Ml(i).HTMLInputElement&&!A$(i,n)||i instanceof Ml(i).HTMLTextAreaElement||i.isContentEditable)&&!((a==="link"||!a&&n9(i))&&n!=="Enter")}function G0(t,e){let n=e.clientX,r=e.clientY;return{currentTarget:t,shiftKey:e.shiftKey,ctrlKey:e.ctrlKey,metaKey:e.metaKey,altKey:e.altKey,clientX:n,clientY:r}}function efe(t){return t instanceof HTMLInputElement?!1:t instanceof HTMLButtonElement?t.type!=="submit"&&t.type!=="reset":!n9(t)}function nP(t,e){return t instanceof HTMLInputElement?!A$(t,e):efe(t)}const tfe=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);function A$(t,e){return t.type==="checkbox"||t.type==="radio"?e===" ":tfe.has(t.type)}let op=null,_E=new Set,Rv=new Map,jh=!1,DE=!1;const nfe={Tab:!0,Escape:!0};function Ew(t,e){for(let n of _E)n(t,e)}function rfe(t){return!(t.metaKey||!s0()&&t.altKey||t.ctrlKey||t.key==="Control"||t.key==="Shift"||t.key==="Meta")}function jb(t){jh=!0,rfe(t)&&(op="keyboard",Ew("keyboard",t))}function Ug(t){op="pointer",(t.type==="mousedown"||t.type==="pointerdown")&&(jh=!0,Ew("pointer",t))}function P$(t){WU(t)&&(jh=!0,op="virtual")}function N$(t){t.target===window||t.target===document||Gb||!t.isTrusted||(!jh&&!DE&&(op="virtual",Ew("virtual",t)),jh=!1,DE=!1)}function L$(){Gb||(jh=!1,DE=!0)}function OE(t){if(typeof window>"u"||typeof document>"u"||Rv.get(Ml(t)))return;const e=Ml(t),n=Mr(t);let r=e.HTMLElement.prototype.focus;e.HTMLElement.prototype.focus=function(){jh=!0,r.apply(this,arguments)},n.addEventListener("keydown",jb,!0),n.addEventListener("keyup",jb,!0),n.addEventListener("click",P$,!0),e.addEventListener("focus",N$,!0),e.addEventListener("blur",L$,!1),typeof PointerEvent<"u"&&(n.addEventListener("pointerdown",Ug,!0),n.addEventListener("pointermove",Ug,!0),n.addEventListener("pointerup",Ug,!0)),e.addEventListener("beforeunload",()=>{k$(t)},{once:!0}),Rv.set(e,{focus:r})}const k$=(t,e)=>{const n=Ml(t),r=Mr(t);e&&r.removeEventListener("DOMContentLoaded",e),Rv.has(n)&&(n.HTMLElement.prototype.focus=Rv.get(n).focus,r.removeEventListener("keydown",jb,!0),r.removeEventListener("keyup",jb,!0),r.removeEventListener("click",P$,!0),n.removeEventListener("focus",N$,!0),n.removeEventListener("blur",L$,!1),typeof PointerEvent<"u"&&(r.removeEventListener("pointerdown",Ug,!0),r.removeEventListener("pointermove",Ug,!0),r.removeEventListener("pointerup",Ug,!0)),Rv.delete(n))};function ife(t){const e=Mr(t);let n;return e.readyState!=="loading"?OE(t):(n=()=>{OE(t)},e.addEventListener("DOMContentLoaded",n)),()=>k$(t,n)}typeof document<"u"&&ife();function l2(){return op!=="pointer"}function Lh(){return op}function V$(t){op=t,Ew(t,null)}const afe=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);function ofe(t,e,n){let r=Mr(n?.target);const i=typeof window<"u"?Ml(n?.target).HTMLInputElement:HTMLInputElement,a=typeof window<"u"?Ml(n?.target).HTMLTextAreaElement:HTMLTextAreaElement,o=typeof window<"u"?Ml(n?.target).HTMLElement:HTMLElement,s=typeof window<"u"?Ml(n?.target).KeyboardEvent:KeyboardEvent;return t=t||r.activeElement instanceof i&&!afe.has(r.activeElement.type)||r.activeElement instanceof a||r.activeElement instanceof o&&r.activeElement.isContentEditable,!(t&&e==="keyboard"&&n instanceof s&&!nfe[n.key])}function F$(t,e,n){OE(),H.useEffect(()=>{let r=(i,a)=>{ofe(!!n?.isTextInput,i,a)&&t(l2())};return _E.add(r),()=>{_E.delete(r)}},e)}function zh(t){const e=Mr(t),n=Oo(e);if(Lh()==="virtual"){let r=n;$U(()=>{Oo(e)===r&&t.isConnected&&To(t)})}else To(t)}function r9(t){let{isDisabled:e,onFocus:n,onBlur:r,onFocusChange:i}=t;const a=H.useCallback(l=>{if(l.target===l.currentTarget)return r&&r(l),i&&i(!1),!0},[r,i]),o=I$(a),s=H.useCallback(l=>{const c=Mr(l.target),f=c?Oo(c):Oo();l.target===l.currentTarget&&f===ea(l.nativeEvent)&&(n&&n(l),i&&i(!0),o(l))},[i,n,o]);return{focusProps:{onFocus:!e&&(n||i||r)?s:void 0,onBlur:!e&&(r||i)?a:void 0}}}function rP(t){if(!t)return;let e=!0;return n=>{let r={...n,preventDefault(){n.preventDefault()},isDefaultPrevented(){return n.isDefaultPrevented()},stopPropagation(){e=!0},continuePropagation(){e=!1},isPropagationStopped(){return e}};t(r),e&&n.stopPropagation()}}function sfe(t){return{keyboardProps:t.isDisabled?{}:{onKeyDown:rP(t.onKeyDown),onKeyUp:rP(t.onKeyUp)}}}let lfe=Tn.createContext(null);function cfe(t){let e=H.useContext(lfe)||{};GU(e,t);let{ref:n,...r}=e;return r}function _w(t,e){let{focusProps:n}=r9(t),{keyboardProps:r}=sfe(t),i=Oi(n,r),a=cfe(e),o=t.isDisabled?{}:a,s=H.useRef(t.autoFocus);H.useEffect(()=>{s.current&&e.current&&zh(e.current),s.current=!1},[e]);let l=t.excludeFromTabOrder?-1:0;return t.isDisabled&&(l=void 0),{focusableProps:Oi({...i,tabIndex:l},o)}}function ufe({children:t}){let e=H.useMemo(()=>({register:()=>{}}),[]);return Tn.createElement(t9.Provider,{value:e},t)}function sp(t){let{isDisabled:e,onBlurWithin:n,onFocusWithin:r,onFocusWithinChange:i}=t,a=H.useRef({isFocusWithin:!1}),{addGlobalListener:o,removeAllGlobalListeners:s}=vw(),l=H.useCallback(u=>{u.currentTarget.contains(u.target)&&a.current.isFocusWithin&&!u.currentTarget.contains(u.relatedTarget)&&(a.current.isFocusWithin=!1,s(),n&&n(u),i&&i(!1))},[n,i,a,s]),c=I$(l),f=H.useCallback(u=>{if(!u.currentTarget.contains(u.target))return;const d=Mr(u.target),h=Oo(d);if(!a.current.isFocusWithin&&h===ea(u.nativeEvent)){r&&r(u),i&&i(!0),a.current.isFocusWithin=!0,c(u);let p=u.currentTarget;o(d,"focus",g=>{if(a.current.isFocusWithin&&!xs(p,g.target)){let m=new d.defaultView.FocusEvent("blur",{relatedTarget:g.target});M$(m,p);let y=e9(m);l(y)}},{capture:!0})}},[r,i,c,o,l]);return e?{focusWithinProps:{onFocus:void 0,onBlur:void 0}}:{focusWithinProps:{onFocus:f,onBlur:l}}}let ME=!1,P5=0;function ffe(){ME=!0,setTimeout(()=>{ME=!1},50)}function iP(t){t.pointerType==="touch"&&ffe()}function dfe(){if(!(typeof document>"u"))return P5===0&&typeof PointerEvent<"u"&&document.addEventListener("pointerup",iP),P5++,()=>{P5--,!(P5>0)&&typeof PointerEvent<"u"&&document.removeEventListener("pointerup",iP)}}function Zs(t){let{onHoverStart:e,onHoverChange:n,onHoverEnd:r,isDisabled:i}=t,[a,o]=H.useState(!1),s=H.useRef({isHovered:!1,ignoreEmulatedMouseEvents:!1,pointerType:"",target:null}).current;H.useEffect(dfe,[]);let{addGlobalListener:l,removeAllGlobalListeners:c}=vw(),{hoverProps:f,triggerHoverEnd:u}=H.useMemo(()=>{let d=(g,m)=>{if(s.pointerType=m,i||m==="touch"||s.isHovered||!g.currentTarget.contains(g.target))return;s.isHovered=!0;let y=g.currentTarget;s.target=y,l(Mr(g.target),"pointerover",v=>{s.isHovered&&s.target&&!xs(s.target,v.target)&&h(v,v.pointerType)},{capture:!0}),e&&e({type:"hoverstart",target:y,pointerType:m}),n&&n(!0),o(!0)},h=(g,m)=>{let y=s.target;s.pointerType="",s.target=null,!(m==="touch"||!s.isHovered||!y)&&(s.isHovered=!1,c(),r&&r({type:"hoverend",target:y,pointerType:m}),n&&n(!1),o(!1))},p={};return typeof PointerEvent<"u"&&(p.onPointerEnter=g=>{ME&&g.pointerType==="mouse"||d(g,g.pointerType)},p.onPointerLeave=g=>{!i&&g.currentTarget.contains(g.target)&&h(g,g.pointerType)}),{hoverProps:p,triggerHoverEnd:h}},[e,n,r,i,s,l,c]);return H.useEffect(()=>{i&&u({currentTarget:s.target},s.pointerType)},[i]),{hoverProps:f,isHovered:a}}function hfe(t){let{ref:e,onInteractOutside:n,isDisabled:r,onInteractOutsideStart:i}=t,a=H.useRef({isPointerDown:!1,ignoreEmulatedMouseEvents:!1}),o=va(l=>{n&&aP(l,e)&&(i&&i(l),a.current.isPointerDown=!0)}),s=va(l=>{n&&n(l)});H.useEffect(()=>{let l=a.current;if(r)return;const c=e.current,f=Mr(c);if(typeof PointerEvent<"u"){let u=d=>{l.isPointerDown&&aP(d,e)&&s(d),l.isPointerDown=!1};return f.addEventListener("pointerdown",o,!0),f.addEventListener("click",u,!0),()=>{f.removeEventListener("pointerdown",o,!0),f.removeEventListener("click",u,!0)}}},[e,r,o,s])}function aP(t,e){if(t.button>0)return!1;if(t.target){const n=t.target.ownerDocument;if(!n||!n.documentElement.contains(t.target)||t.target.closest("[data-react-aria-top-layer]"))return!1}return e.current?!t.composedPath().includes(e.current):!1}const pfe=500;function U$(t){let{isDisabled:e,onLongPressStart:n,onLongPressEnd:r,onLongPress:i,threshold:a=pfe,accessibilityDescription:o}=t;const s=H.useRef(void 0);let{addGlobalListener:l,removeGlobalListener:c}=vw(),{pressProps:f}=Uf({isDisabled:e,onPressStart(d){if(d.continuePropagation(),(d.pointerType==="mouse"||d.pointerType==="touch")&&(n&&n({...d,type:"longpressstart"}),s.current=setTimeout(()=>{d.target.dispatchEvent(new PointerEvent("pointercancel",{bubbles:!0})),Mr(d.target).activeElement!==d.target&&To(d.target),i&&i({...d,type:"longpress"}),s.current=void 0},a),d.pointerType==="touch")){let h=p=>{p.preventDefault()};l(d.target,"contextmenu",h,{once:!0}),l(window,"pointerup",()=>{setTimeout(()=>{c(d.target,"contextmenu",h)},30)},{once:!0})}},onPressEnd(d){s.current&&clearTimeout(s.current),r&&(d.pointerType==="mouse"||d.pointerType==="touch")&&r({...d,type:"longpressend"})}}),u=$ae(i&&!e?o:void 0);return{longPressProps:Oi(f,u)}}const oP=Tn.createContext(null),IE="react-aria-focus-scope-restore";let Zr=null;function gfe(t){let{children:e,contain:n,restoreFocus:r,autoFocus:i}=t,a=H.useRef(null),o=H.useRef(null),s=H.useRef([]),{parentNode:l}=H.useContext(oP)||{},c=H.useMemo(()=>new AE({scopeRef:s}),[s]);Br(()=>{let d=l||ga.root;if(ga.getTreeNode(d.scopeRef)&&Zr&&!zb(Zr,d.scopeRef)){let h=ga.getTreeNode(Zr);h&&(d=h)}d.addChild(c),ga.addNode(c)},[c,l]),Br(()=>{let d=ga.getTreeNode(s);d&&(d.contain=!!n)},[n]),Br(()=>{var d;let h=(d=a.current)===null||d===void 0?void 0:d.nextSibling,p=[],g=m=>m.stopPropagation();for(;h&&h!==o.current;)p.push(h),h.addEventListener(IE,g),h=h.nextSibling;return s.current=p,()=>{for(let m of p)m.removeEventListener(IE,g)}},[e]),wfe(s,r,n),yfe(s,n),Cfe(s,r,n),bfe(s,i),H.useEffect(()=>{const d=Oo(Mr(s.current?s.current[0]:void 0));let h=null;if(Al(d,s.current)){for(let p of ga.traverse())p.scopeRef&&Al(d,p.scopeRef.current)&&(h=p);h===ga.getTreeNode(s)&&(Zr=h.scopeRef)}},[s]),Br(()=>()=>{var d,h,p;let g=(p=(h=ga.getTreeNode(s))===null||h===void 0||(d=h.parent)===null||d===void 0?void 0:d.scopeRef)!==null&&p!==void 0?p:null;(s===Zr||zb(s,Zr))&&(!g||ga.getTreeNode(g))&&(Zr=g),ga.removeTreeNode(s)},[s]);let f=H.useMemo(()=>mfe(s),[]),u=H.useMemo(()=>({focusManager:f,parentNode:c}),[c,f]);return Tn.createElement(oP.Provider,{value:u},Tn.createElement("span",{"data-focus-scope-start":!0,hidden:!0,ref:a}),e,Tn.createElement("span",{"data-focus-scope-end":!0,hidden:!0,ref:o}))}function mfe(t){return{focusNext(e={}){let n=t.current,{from:r,tabbable:i,wrap:a,accept:o}=e;var s;let l=r||Oo(Mr((s=n[0])!==null&&s!==void 0?s:void 0)),c=n[0].previousElementSibling,f=Sh(n),u=tu(f,{tabbable:i,accept:o},n);u.currentNode=Al(l,n)?l:c;let d=u.nextNode();return!d&&a&&(u.currentNode=c,d=u.nextNode()),d&&xf(d,!0),d},focusPrevious(e={}){let n=t.current,{from:r,tabbable:i,wrap:a,accept:o}=e;var s;let l=r||Oo(Mr((s=n[0])!==null&&s!==void 0?s:void 0)),c=n[n.length-1].nextElementSibling,f=Sh(n),u=tu(f,{tabbable:i,accept:o},n);u.currentNode=Al(l,n)?l:c;let d=u.previousNode();return!d&&a&&(u.currentNode=c,d=u.previousNode()),d&&xf(d,!0),d},focusFirst(e={}){let n=t.current,{tabbable:r,accept:i}=e,a=Sh(n),o=tu(a,{tabbable:r,accept:i},n);o.currentNode=n[0].previousElementSibling;let s=o.nextNode();return s&&xf(s,!0),s},focusLast(e={}){let n=t.current,{tabbable:r,accept:i}=e,a=Sh(n),o=tu(a,{tabbable:r,accept:i},n);o.currentNode=n[n.length-1].nextElementSibling;let s=o.previousNode();return s&&xf(s,!0),s}}}function Sh(t){return t[0].parentElement}function uv(t){let e=ga.getTreeNode(Zr);for(;e&&e.scopeRef!==t;){if(e.contain)return!1;e=e.parent}return!0}function vfe(t){if(t.checked)return!0;let e=[];if(!t.form)e=[...Mr(t).querySelectorAll(`input[type="radio"][name="${CSS.escape(t.name)}"]`)].filter(a=>!a.form);else{var n,r;let a=(r=t.form)===null||r===void 0||(n=r.elements)===null||n===void 0?void 0:n.namedItem(t.name);e=[...a??[]]}return e?!e.some(a=>a.checked):!1}function yfe(t,e){let n=H.useRef(void 0),r=H.useRef(void 0);Br(()=>{let i=t.current;if(!e){r.current&&(cancelAnimationFrame(r.current),r.current=void 0);return}const a=Mr(i?i[0]:void 0);let o=c=>{if(c.key!=="Tab"||c.altKey||c.ctrlKey||c.metaKey||!uv(t)||c.isComposing)return;let f=Oo(a),u=t.current;if(!u||!Al(f,u))return;let d=Sh(u),h=tu(d,{tabbable:!0},u);if(!f)return;h.currentNode=f;let p=c.shiftKey?h.previousNode():h.nextNode();p||(h.currentNode=c.shiftKey?u[u.length-1].nextElementSibling:u[0].previousElementSibling,p=c.shiftKey?h.previousNode():h.nextNode()),c.preventDefault(),p&&xf(p,!0)},s=c=>{(!Zr||zb(Zr,t))&&Al(ea(c),t.current)?(Zr=t,n.current=ea(c)):uv(t)&&!Hd(ea(c),t)?n.current?n.current.focus():Zr&&Zr.current&&RE(Zr.current):uv(t)&&(n.current=ea(c))},l=c=>{r.current&&cancelAnimationFrame(r.current),r.current=requestAnimationFrame(()=>{let f=Lh(),u=(f==="virtual"||f===null)&&x_()&&kU(),d=Oo(a);if(!u&&d&&uv(t)&&!Hd(d,t)){Zr=t;let p=ea(c);if(p&&p.isConnected){var h;n.current=p,(h=n.current)===null||h===void 0||h.focus()}else Zr.current&&RE(Zr.current)}})};return a.addEventListener("keydown",o,!1),a.addEventListener("focusin",s,!1),i?.forEach(c=>c.addEventListener("focusin",s,!1)),i?.forEach(c=>c.addEventListener("focusout",l,!1)),()=>{a.removeEventListener("keydown",o,!1),a.removeEventListener("focusin",s,!1),i?.forEach(c=>c.removeEventListener("focusin",s,!1)),i?.forEach(c=>c.removeEventListener("focusout",l,!1))}},[t,e]),Br(()=>()=>{r.current&&cancelAnimationFrame(r.current)},[r])}function B$(t){return Hd(t)}function Al(t,e){return!t||!e?!1:e.some(n=>n.contains(t))}function Hd(t,e=null){if(t instanceof Element&&t.closest("[data-react-aria-top-layer]"))return!0;for(let{scopeRef:n}of ga.traverse(ga.getTreeNode(e)))if(n&&Al(t,n.current))return!0;return!1}function xfe(t){return Hd(t,Zr)}function zb(t,e){var n;let r=(n=ga.getTreeNode(e))===null||n===void 0?void 0:n.parent;for(;r;){if(r.scopeRef===t)return!0;r=r.parent}return!1}function xf(t,e=!1){if(t!=null&&!e)try{zh(t)}catch{}else if(t!=null)try{t.focus()}catch{}}function $$(t,e=!0){let n=t[0].previousElementSibling,r=Sh(t),i=tu(r,{tabbable:e},t);i.currentNode=n;let a=i.nextNode();return e&&!a&&(r=Sh(t),i=tu(r,{tabbable:!1},t),i.currentNode=n,a=i.nextNode()),a}function RE(t,e=!0){xf($$(t,e))}function bfe(t,e){const n=Tn.useRef(e);H.useEffect(()=>{if(n.current){Zr=t;const r=Mr(t.current?t.current[0]:void 0);!Al(Oo(r),Zr.current)&&t.current&&RE(t.current)}n.current=!1},[t])}function wfe(t,e,n){Br(()=>{if(e||n)return;let r=t.current;const i=Mr(r?r[0]:void 0);let a=o=>{let s=ea(o);Al(s,t.current)?Zr=t:B$(s)||(Zr=null)};return i.addEventListener("focusin",a,!1),r?.forEach(o=>o.addEventListener("focusin",a,!1)),()=>{i.removeEventListener("focusin",a,!1),r?.forEach(o=>o.removeEventListener("focusin",a,!1))}},[t,e,n])}function sP(t){let e=ga.getTreeNode(Zr);for(;e&&e.scopeRef!==t;){if(e.nodeToRestore)return!1;e=e.parent}return e?.scopeRef===t}function Cfe(t,e,n){const r=H.useRef(typeof document<"u"?Oo(Mr(t.current?t.current[0]:void 0)):null);Br(()=>{let i=t.current;const a=Mr(i?i[0]:void 0);if(!e||n)return;let o=()=>{(!Zr||zb(Zr,t))&&Al(Oo(a),t.current)&&(Zr=t)};return a.addEventListener("focusin",o,!1),i?.forEach(s=>s.addEventListener("focusin",o,!1)),()=>{a.removeEventListener("focusin",o,!1),i?.forEach(s=>s.removeEventListener("focusin",o,!1))}},[t,n]),Br(()=>{const i=Mr(t.current?t.current[0]:void 0);if(!e)return;let a=o=>{if(o.key!=="Tab"||o.altKey||o.ctrlKey||o.metaKey||!uv(t)||o.isComposing)return;let s=i.activeElement;if(!Hd(s,t)||!sP(t))return;let l=ga.getTreeNode(t);if(!l)return;let c=l.nodeToRestore,f=tu(i.body,{tabbable:!0});f.currentNode=s;let u=o.shiftKey?f.previousNode():f.nextNode();if((!c||!c.isConnected||c===i.body)&&(c=void 0,l.nodeToRestore=void 0),(!u||!Hd(u,t))&&c){f.currentNode=c;do u=o.shiftKey?f.previousNode():f.nextNode();while(Hd(u,t));o.preventDefault(),o.stopPropagation(),u?xf(u,!0):B$(c)?xf(c,!0):s.blur()}};return n||i.addEventListener("keydown",a,!0),()=>{n||i.removeEventListener("keydown",a,!0)}},[t,e,n]),Br(()=>{const i=Mr(t.current?t.current[0]:void 0);if(!e)return;let a=ga.getTreeNode(t);if(a){var o;return a.nodeToRestore=(o=r.current)!==null&&o!==void 0?o:void 0,()=>{let s=ga.getTreeNode(t);if(!s)return;let l=s.nodeToRestore,c=Oo(i);if(e&&l&&(c&&Hd(c,t)||c===i.body&&sP(t))){let f=ga.clone();requestAnimationFrame(()=>{if(i.activeElement===i.body){let u=f.getTreeNode(t);for(;u;){if(u.nodeToRestore&&u.nodeToRestore.isConnected){lP(u.nodeToRestore);return}u=u.parent}for(u=f.getTreeNode(t);u;){if(u.scopeRef&&u.scopeRef.current&&ga.getTreeNode(u.scopeRef)){let d=$$(u.scopeRef.current,!0);lP(d);return}u=u.parent}}})}}}},[t,e])}function lP(t){t.dispatchEvent(new CustomEvent(IE,{bubbles:!0,cancelable:!0}))&&xf(t)}function tu(t,e,n){let r=e?.tabbable?Jae:HU,i=t?.nodeType===Node.ELEMENT_NODE?t:null,a=Mr(i),o=Cae(a,t||a,NodeFilter.SHOW_ELEMENT,{acceptNode(s){var l;return!(e==null||(l=e.from)===null||l===void 0)&&l.contains(s)||e?.tabbable&&s.tagName==="INPUT"&&s.getAttribute("type")==="radio"&&(!vfe(s)||o.currentNode.tagName==="INPUT"&&o.currentNode.type==="radio"&&o.currentNode.name===s.name)?NodeFilter.FILTER_REJECT:r(s)&&(!n||Al(s,n))&&(!e?.accept||e.accept(s))?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});return e?.from&&(o.currentNode=e.from),o}class i9{get size(){return this.fastMap.size}getTreeNode(e){return this.fastMap.get(e)}addTreeNode(e,n,r){let i=this.fastMap.get(n??null);if(!i)return;let a=new AE({scopeRef:e});i.addChild(a),a.parent=i,this.fastMap.set(e,a),r&&(a.nodeToRestore=r)}addNode(e){this.fastMap.set(e.scopeRef,e)}removeTreeNode(e){if(e===null)return;let n=this.fastMap.get(e);if(!n)return;let r=n.parent;for(let a of this.traverse())a!==n&&n.nodeToRestore&&a.nodeToRestore&&n.scopeRef&&n.scopeRef.current&&Al(a.nodeToRestore,n.scopeRef.current)&&(a.nodeToRestore=n.nodeToRestore);let i=n.children;r&&(r.removeChild(n),i.size>0&&i.forEach(a=>r&&r.addChild(a))),this.fastMap.delete(n.scopeRef)}*traverse(e=this.root){if(e.scopeRef!=null&&(yield e),e.children.size>0)for(let n of e.children)yield*this.traverse(n)}clone(){var e;let n=new i9;var r;for(let i of this.traverse())n.addTreeNode(i.scopeRef,(r=(e=i.parent)===null||e===void 0?void 0:e.scopeRef)!==null&&r!==void 0?r:null,i.nodeToRestore);return n}constructor(){this.fastMap=new Map,this.root=new AE({scopeRef:null}),this.fastMap.set(null,this.root)}}class AE{addChild(e){this.children.add(e),e.parent=this}removeChild(e){this.children.delete(e),e.parent=void 0}constructor(e){this.children=new Set,this.contain=!1,this.scopeRef=e.scopeRef}}let ga=new i9;function Pl(t={}){let{autoFocus:e=!1,isTextInput:n,within:r}=t,i=H.useRef({isFocused:!1,isFocusVisible:e||l2()}),[a,o]=H.useState(!1),[s,l]=H.useState(()=>i.current.isFocused&&i.current.isFocusVisible),c=H.useCallback(()=>l(i.current.isFocused&&i.current.isFocusVisible),[]),f=H.useCallback(h=>{i.current.isFocused=h,o(h),c()},[c]);F$(h=>{i.current.isFocusVisible=h,c()},[],{isTextInput:n});let{focusProps:u}=r9({isDisabled:r,onFocusChange:f}),{focusWithinProps:d}=sp({isDisabled:!r,onFocusWithinChange:f});return{isFocused:a,isFocusVisible:s,focusProps:r?d:u}}function Sfe(t,e){let n=e?.isDisabled,[r,i]=H.useState(!1);return Br(()=>{if(t?.current&&!n){let a=()=>{if(t.current){let s=tu(t.current,{tabbable:!0});i(!!s.nextNode())}};a();let o=new MutationObserver(a);return o.observe(t.current,{subtree:!0,childList:!0,attributes:!0,attributeFilter:["tabIndex","disabled"]}),()=>{o.disconnect()}}}),n?!1:r}function G$(t){let e=Efe(Mr(t));e!==t&&(e&&Tfe(e,t),t&&j$(t,e))}function Tfe(t,e){t.dispatchEvent(new FocusEvent("blur",{relatedTarget:e})),t.dispatchEvent(new FocusEvent("focusout",{bubbles:!0,relatedTarget:e}))}function j$(t,e){t.dispatchEvent(new FocusEvent("focus",{relatedTarget:e})),t.dispatchEvent(new FocusEvent("focusin",{bubbles:!0,relatedTarget:e}))}function Efe(t){let e=Oo(t),n=e?.getAttribute("aria-activedescendant");return n&&t.getElementById(n)||e}function z$(t,e,n){let{type:r}=t,{isOpen:i}=e;H.useEffect(()=>{n&&n.current&&O$.set(n.current,e.close)});let a;r==="menu"?a=!0:r==="listbox"&&(a="listbox");let o=Js();return{triggerProps:{"aria-haspopup":a,"aria-expanded":i,"aria-controls":i?o:void 0,onPress:e.toggle},overlayProps:{id:o}}}const JS=typeof document<"u"&&window.visualViewport,_fe=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);let N5=0,ZS;function W$(t={}){let{isDisabled:e}=t;Br(()=>{if(!e)return N5++,N5===1&&(gw()?ZS=Ofe():ZS=Dfe()),()=>{N5--,N5===0&&ZS()}},[e])}function Dfe(){let t=window.innerWidth-document.documentElement.clientWidth;return o0(t>0&&("scrollbarGutter"in document.documentElement.style?Th(document.documentElement,"scrollbarGutter","stable"):Th(document.documentElement,"paddingRight",`${t}px`)),Th(document.documentElement,"overflow","hidden"))}function Ofe(){let t,e,n=c=>{t=jU(c.target,!0),!(t===document.documentElement&&t===document.body)&&t instanceof HTMLElement&&window.getComputedStyle(t).overscrollBehavior==="auto"&&(e=Th(t,"overscrollBehavior","contain"))},r=c=>{if(!t||t===document.documentElement||t===document.body){c.preventDefault();return}t.scrollHeight===t.clientHeight&&t.scrollWidth===t.clientWidth&&c.preventDefault()},i=()=>{e&&e()},a=c=>{let f=c.target;Mfe(f)&&(s(),f.style.transform="translateY(-2000px)",requestAnimationFrame(()=>{f.style.transform="",JS&&(JS.height<window.innerHeight?requestAnimationFrame(()=>{cP(f)}):JS.addEventListener("resize",()=>cP(f),{once:!0}))}))},o=null,s=()=>{if(o)return;let c=()=>{window.scrollTo(0,0)},f=window.pageXOffset,u=window.pageYOffset;o=o0(B1(window,"scroll",c),Th(document.documentElement,"paddingRight",`${window.innerWidth-document.documentElement.clientWidth}px`),Th(document.documentElement,"overflow","hidden"),Th(document.body,"marginTop",`-${u}px`),()=>{window.scrollTo(f,u)}),window.scrollTo(0,0)},l=o0(B1(document,"touchstart",n,{passive:!1,capture:!0}),B1(document,"touchmove",r,{passive:!1,capture:!0}),B1(document,"touchend",i,{passive:!1,capture:!0}),B1(document,"focus",a,!0));return()=>{e?.(),o?.(),l()}}function Th(t,e,n){let r=t.style[e];return t.style[e]=n,()=>{t.style[e]=r}}function B1(t,e,n,r){return t.addEventListener(e,n,r),()=>{t.removeEventListener(e,n,r)}}function cP(t){let e=document.scrollingElement||document.documentElement,n=t;for(;n&&n!==e;){let r=jU(n);if(r!==document.documentElement&&r!==document.body&&r!==n){let i=r.getBoundingClientRect().top,a=n.getBoundingClientRect().top;a>i+n.clientHeight&&(r.scrollTop+=a-i)}n=r.parentElement}}function Mfe(t){return t instanceof HTMLInputElement&&!_fe.has(t.type)||t instanceof HTMLTextAreaElement||t instanceof HTMLElement&&t.isContentEditable}const Ife=H.createContext({});function Rfe(){var t;return(t=H.useContext(Ife))!==null&&t!==void 0?t:{}}const PE=Tn.createContext(null);function Afe(t){let{children:e}=t,n=H.useContext(PE),[r,i]=H.useState(0),a=H.useMemo(()=>({parent:n,modalCount:r,addModal(){i(o=>o+1),n&&n.addModal()},removeModal(){i(o=>o-1),n&&n.removeModal()}}),[n,r]);return Tn.createElement(PE.Provider,{value:a},e)}function Pfe(){let t=H.useContext(PE);return{modalProviderProps:{"aria-hidden":t&&t.modalCount>0?!0:void 0}}}function Nfe(t){let{modalProviderProps:e}=Pfe();return Tn.createElement("div",{"data-overlay-container":!0,...t,...e})}function Lfe(t){return Tn.createElement(Afe,null,Tn.createElement(Nfe,t))}var H$={};H$={dismiss:"تجاهل"};var K$={};K$={dismiss:"Отхвърляне"};var q$={};q$={dismiss:"Odstranit"};var X$={};X$={dismiss:"Luk"};var Y$={};Y$={dismiss:"Schließen"};var J$={};J$={dismiss:"Απόρριψη"};var Z$={};Z$={dismiss:"Dismiss"};var Q$={};Q$={dismiss:"Descartar"};var eG={};eG={dismiss:"Lõpeta"};var tG={};tG={dismiss:"Hylkää"};var nG={};nG={dismiss:"Rejeter"};var rG={};rG={dismiss:"התעלם"};var iG={};iG={dismiss:"Odbaci"};var aG={};aG={dismiss:"Elutasítás"};var oG={};oG={dismiss:"Ignora"};var sG={};sG={dismiss:"閉じる"};var lG={};lG={dismiss:"무시"};var cG={};cG={dismiss:"Atmesti"};var uG={};uG={dismiss:"Nerādīt"};var fG={};fG={dismiss:"Lukk"};var dG={};dG={dismiss:"Negeren"};var hG={};hG={dismiss:"Zignoruj"};var pG={};pG={dismiss:"Descartar"};var gG={};gG={dismiss:"Dispensar"};var mG={};mG={dismiss:"Revocare"};var vG={};vG={dismiss:"Пропустить"};var yG={};yG={dismiss:"Zrušiť"};var xG={};xG={dismiss:"Opusti"};var bG={};bG={dismiss:"Odbaci"};var wG={};wG={dismiss:"Avvisa"};var CG={};CG={dismiss:"Kapat"};var SG={};SG={dismiss:"Скасувати"};var TG={};TG={dismiss:"取消"};var EG={};EG={dismiss:"關閉"};var _G={};_G={"ar-AE":H$,"bg-BG":K$,"cs-CZ":q$,"da-DK":X$,"de-DE":Y$,"el-GR":J$,"en-US":Z$,"es-ES":Q$,"et-EE":eG,"fi-FI":tG,"fr-FR":nG,"he-IL":rG,"hr-HR":iG,"hu-HU":aG,"it-IT":oG,"ja-JP":sG,"ko-KR":lG,"lt-LT":cG,"lv-LV":uG,"nb-NO":fG,"nl-NL":dG,"pl-PL":hG,"pt-BR":pG,"pt-PT":gG,"ro-RO":mG,"ru-RU":vG,"sk-SK":yG,"sl-SI":xG,"sr-SP":bG,"sv-SE":wG,"tr-TR":CG,"uk-UA":SG,"zh-CN":TG,"zh-TW":EG};const uP={border:0,clip:"rect(0 0 0 0)",clipPath:"inset(50%)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap"};function DG(t={}){let{style:e,isFocusable:n}=t,[r,i]=H.useState(!1),{focusWithinProps:a}=sp({isDisabled:!n,onFocusWithinChange:s=>i(s)}),o=H.useMemo(()=>r?e:e?{...uP,...e}:uP,[r]);return{visuallyHiddenProps:{...a,style:o}}}function OG(t){let{children:e,elementType:n="div",isFocusable:r,style:i,...a}=t,{visuallyHiddenProps:o}=DG(t);return Tn.createElement(n,Oi(a,o),e)}function kfe(t){return t&&t.__esModule?t.default:t}function fP(t){let{onDismiss:e,...n}=t,r=dw(kfe(_G),"@react-aria/overlays"),i=yw(n,r.format("dismiss")),a=()=>{e&&e()};return Tn.createElement(OG,null,Tn.createElement("button",{...i,tabIndex:-1,onClick:a,style:{width:1,height:1}}))}const MG=Tn.createContext(null);function Vfe(t){let e=uw(),{portalContainer:n=e?null:document.body,isExiting:r}=t,[i,a]=H.useState(!1),o=H.useMemo(()=>({contain:i,setContain:a}),[i,a]),{getContainer:s}=Rfe();if(!t.portalContainer&&s&&(n=s()),!n)return null;let l=t.children;return t.disableFocusManagement||(l=Tn.createElement(gfe,{restoreFocus:!0,contain:(t.shouldContainFocus||i)&&!r},l)),l=Tn.createElement(MG.Provider,{value:o},Tn.createElement(ufe,null,l)),Rie.createPortal(l,n)}function Ffe(){let t=H.useContext(MG),e=t?.setContain;Br(()=>{e?.(!0)},[e])}var Ufe=({children:t,navigate:e,disableAnimation:n,useHref:r,disableRipple:i=!1,skipFramerMotionAnimations:a=n,reducedMotion:o="never",validationBehavior:s,locale:l="en-US",labelPlacement:c,defaultDates:f,createCalendar:u,spinnerVariant:d,...h})=>{let p=t;e&&(p=j.jsx(Lae,{navigate:e,useHref:r,children:p}));const g=H.useMemo(()=>(n&&a&&(hu.skipAnimations=!0),{createCalendar:u,defaultDates:f,disableAnimation:n,disableRipple:i,validationBehavior:s,labelPlacement:c,spinnerVariant:d}),[u,f?.maxDate,f?.minDate,n,i,s,c,d]);return j.jsx(Hie,{value:g,children:j.jsx(iae,{locale:l,children:j.jsx(sle,{reducedMotion:o,children:j.jsx(Lfe,{...h,children:p})})})})};function Bfe(t){const e=es(),n=e?.labelPlacement;return H.useMemo(()=>{var r,i;const a=(i=(r=t.labelPlacement)!=null?r:n)!=null?i:"inside";return a==="inside"&&!t.label?"outside":a},[t.labelPlacement,n,t.label])}function $fe(t){const e=es(),n=e?.labelPlacement;return H.useMemo(()=>{var r,i;const a=(i=(r=t.labelPlacement)!=null?r:n)!=null?i:"inside";return a==="inside"&&!t.label?"outside":a},[t.labelPlacement,n,t.label])}function Hi(t){return H.forwardRef(t)}var Vl=(t,e,n=!0)=>{if(!e)return[t,{}];const r=e.reduce((i,a)=>a in t?{...i,[a]:t[a]}:i,{});return n?[Object.keys(t).filter(a=>!e.includes(a)).reduce((a,o)=>({...a,[o]:t[o]}),{}),r]:[t,r]},Gfe={default:"bg-default text-default-foreground",primary:"bg-primary text-primary-foreground",secondary:"bg-secondary text-secondary-foreground",success:"bg-success text-success-foreground",warning:"bg-warning text-warning-foreground",danger:"bg-danger text-danger-foreground",foreground:"bg-foreground text-background"},jfe={default:"shadow-lg shadow-default/50 bg-default text-default-foreground",primary:"shadow-lg shadow-primary/40 bg-primary text-primary-foreground",secondary:"shadow-lg shadow-secondary/40 bg-secondary text-secondary-foreground",success:"shadow-lg shadow-success/40 bg-success text-success-foreground",warning:"shadow-lg shadow-warning/40 bg-warning text-warning-foreground",danger:"shadow-lg shadow-danger/40 bg-danger text-danger-foreground"},zfe={default:"bg-transparent border-default text-foreground",primary:"bg-transparent border-primary text-primary",secondary:"bg-transparent border-secondary text-secondary",success:"bg-transparent border-success text-success",warning:"bg-transparent border-warning text-warning",danger:"bg-transparent border-danger text-danger"},Wfe={default:"bg-default/40 text-default-700",primary:"bg-primary/20 text-primary-600",secondary:"bg-secondary/20 text-secondary-600",success:"bg-success/20 text-success-700 dark:text-success",warning:"bg-warning/20 text-warning-700 dark:text-warning",danger:"bg-danger/20 text-danger-600 dark:text-danger-500"},Hfe={default:"border-default bg-default-100 text-default-foreground",primary:"border-default bg-default-100 text-primary",secondary:"border-default bg-default-100 text-secondary",success:"border-default bg-default-100 text-success",warning:"border-default bg-default-100 text-warning",danger:"border-default bg-default-100 text-danger"},Kfe={default:"bg-transparent text-default-foreground",primary:"bg-transparent text-primary",secondary:"bg-transparent text-secondary",success:"bg-transparent text-success",warning:"bg-transparent text-warning",danger:"bg-transparent text-danger"},qfe={default:"border-default text-default-foreground",primary:"border-primary text-primary",secondary:"border-secondary text-secondary",success:"border-success text-success",warning:"border-warning text-warning",danger:"border-danger text-danger"},It={solid:Gfe,shadow:jfe,bordered:zfe,flat:Wfe,faded:Hfe,light:Kfe,ghost:qfe},Xfe={".spinner-bar-animation":{"animation-delay":"calc(-1.2s + (0.1s * var(--bar-index)))",transform:"rotate(calc(30deg * var(--bar-index)))translate(140%)"},".spinner-dot-animation":{"animation-delay":"calc(250ms * var(--dot-index))"},".spinner-dot-blink-animation":{"animation-delay":"calc(200ms * var(--dot-index))"}},Yfe={".leading-inherit":{"line-height":"inherit"},".bg-img-inherit":{"background-image":"inherit"},".bg-clip-inherit":{"background-clip":"inherit"},".text-fill-inherit":{"-webkit-text-fill-color":"inherit"},".tap-highlight-transparent":{"-webkit-tap-highlight-color":"transparent"},".input-search-cancel-button-none":{"&::-webkit-search-cancel-button":{"-webkit-appearance":"none"}}},Jfe={".scrollbar-hide":{"-ms-overflow-style":"none","scrollbar-width":"none","&::-webkit-scrollbar":{display:"none"}},".scrollbar-default":{"-ms-overflow-style":"auto","scrollbar-width":"auto","&::-webkit-scrollbar":{display:"block"}}},Zfe={".text-tiny":{"font-size":"var(--heroui-font-size-tiny)","line-height":"var(--heroui-line-height-tiny)"},".text-small":{"font-size":"var(--heroui-font-size-small)","line-height":"var(--heroui-line-height-small)"},".text-medium":{"font-size":"var(--heroui-font-size-medium)","line-height":"var(--heroui-line-height-medium)"},".text-large":{"font-size":"var(--heroui-font-size-large)","line-height":"var(--heroui-line-height-large)"}},Uc="250ms",Qfe={".transition-background":{"transition-property":"background","transition-timing-function":"ease","transition-duration":Uc},".transition-colors-opacity":{"transition-property":"color, background-color, border-color, text-decoration-color, fill, stroke, opacity","transition-timing-function":"ease","transition-duration":Uc},".transition-width":{"transition-property":"width","transition-timing-function":"ease","transition-duration":Uc},".transition-height":{"transition-property":"height","transition-timing-function":"ease","transition-duration":Uc},".transition-size":{"transition-property":"width, height","transition-timing-function":"ease","transition-duration":Uc},".transition-left":{"transition-property":"left","transition-timing-function":"ease","transition-duration":Uc},".transition-transform-opacity":{"transition-property":"transform, scale, opacity rotate","transition-timing-function":"ease","transition-duration":Uc},".transition-transform-background":{"transition-property":"transform, scale, background","transition-timing-function":"ease","transition-duration":Uc},".transition-transform-colors":{"transition-property":"transform, scale, color, background, background-color, border-color, text-decoration-color, fill, stroke","transition-timing-function":"ease","transition-duration":Uc},".transition-transform-colors-opacity":{"transition-property":"transform, scale, color, background, background-color, border-color, text-decoration-color, fill, stroke, opacity","transition-timing-function":"ease","transition-duration":Uc}},ede={...Yfe,...Qfe,...Jfe,...Zfe,...Xfe},L5=["small","medium","large"],dP={theme:{spacing:["divider"],radius:L5},classGroups:{shadow:[{shadow:L5}],opacity:[{opacity:["disabled"]}],"font-size":[{text:["tiny",...L5]}],"border-w":[{border:L5}],"bg-image":["bg-stripe-gradient-default","bg-stripe-gradient-primary","bg-stripe-gradient-secondary","bg-stripe-gradient-success","bg-stripe-gradient-warning","bg-stripe-gradient-danger"],transition:Object.keys(ede).filter(t=>t.includes(".transition")).map(t=>t.replace(".",""))}},hP=t=>t===!1?"false":t===!0?"true":t===0?"0":t,vs=t=>{if(!t||typeof t!="object")return!0;for(let e in t)return!1;return!0},tde=(t,e)=>{if(t===e)return!0;if(!t||!e)return!1;let n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++){let a=n[i];if(!r.includes(a)||t[a]!==e[a])return!1}return!0};function IG(t,e){for(let n=0;n<t.length;n++){let r=t[n];Array.isArray(r)?IG(r,e):e.push(r)}}var RG=(...t)=>{let e=[];IG(t,e);let n=[];for(let r=0;r<e.length;r++)e[r]&&n.push(e[r]);return n},AG=(t,e)=>{let n={};for(let r in t){let i=t[r];if(r in e){let a=e[r];Array.isArray(i)||Array.isArray(a)?n[r]=RG(a,i):typeof i=="object"&&typeof a=="object"&&i&&a?n[r]=AG(i,a):n[r]=a+" "+i}else n[r]=i}for(let r in e)r in t||(n[r]=e[r]);return n},nde=/\s+/g,pP=t=>!t||typeof t!="string"?t:t.replace(nde," ").trim();const a9="-",rde=t=>{const e=ade(t),{conflictingClassGroups:n,conflictingClassGroupModifiers:r}=t;return{getClassGroupId:o=>{const s=o.split(a9);return s[0]===""&&s.length!==1&&s.shift(),PG(s,e)||ide(o)},getConflictingClassGroupIds:(o,s)=>{const l=n[o]||[];return s&&r[o]?[...l,...r[o]]:l}}},PG=(t,e)=>{if(t.length===0)return e.classGroupId;const n=t[0],r=e.nextPart.get(n),i=r?PG(t.slice(1),r):void 0;if(i)return i;if(e.validators.length===0)return;const a=t.join(a9);return e.validators.find(({validator:o})=>o(a))?.classGroupId},gP=/^\[(.+)\]$/,ide=t=>{if(gP.test(t)){const e=gP.exec(t)[1],n=e?.substring(0,e.indexOf(":"));if(n)return"arbitrary.."+n}},ade=t=>{const{theme:e,classGroups:n}=t,r={nextPart:new Map,validators:[]};for(const i in n)NE(n[i],r,i,e);return r},NE=(t,e,n,r)=>{t.forEach(i=>{if(typeof i=="string"){const a=i===""?e:mP(e,i);a.classGroupId=n;return}if(typeof i=="function"){if(ode(i)){NE(i(r),e,n,r);return}e.validators.push({validator:i,classGroupId:n});return}Object.entries(i).forEach(([a,o])=>{NE(o,mP(e,a),n,r)})})},mP=(t,e)=>{let n=t;return e.split(a9).forEach(r=>{n.nextPart.has(r)||n.nextPart.set(r,{nextPart:new Map,validators:[]}),n=n.nextPart.get(r)}),n},ode=t=>t.isThemeGetter,sde=t=>{if(t<1)return{get:()=>{},set:()=>{}};let e=0,n=new Map,r=new Map;const i=(a,o)=>{n.set(a,o),e++,e>t&&(e=0,r=n,n=new Map)};return{get(a){let o=n.get(a);if(o!==void 0)return o;if((o=r.get(a))!==void 0)return i(a,o),o},set(a,o){n.has(a)?n.set(a,o):i(a,o)}}},LE="!",kE=":",lde=kE.length,cde=t=>{const{prefix:e,experimentalParseClassName:n}=t;let r=i=>{const a=[];let o=0,s=0,l=0,c;for(let p=0;p<i.length;p++){let g=i[p];if(o===0&&s===0){if(g===kE){a.push(i.slice(l,p)),l=p+lde;continue}if(g==="/"){c=p;continue}}g==="["?o++:g==="]"?o--:g==="("?s++:g===")"&&s--}const f=a.length===0?i:i.substring(l),u=ude(f),d=u!==f,h=c&&c>l?c-l:void 0;return{modifiers:a,hasImportantModifier:d,baseClassName:u,maybePostfixModifierPosition:h}};if(e){const i=e+kE,a=r;r=o=>o.startsWith(i)?a(o.substring(i.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:o,maybePostfixModifierPosition:void 0}}if(n){const i=r;r=a=>n({className:a,parseClassName:i})}return r},ude=t=>t.endsWith(LE)?t.substring(0,t.length-1):t.startsWith(LE)?t.substring(1):t,fde=t=>{const e=Object.fromEntries(t.orderSensitiveModifiers.map(r=>[r,!0]));return r=>{if(r.length<=1)return r;const i=[];let a=[];return r.forEach(o=>{o[0]==="["||e[o]?(i.push(...a.sort(),o),a=[]):a.push(o)}),i.push(...a.sort()),i}},dde=t=>({cache:sde(t.cacheSize),parseClassName:cde(t),sortModifiers:fde(t),...rde(t)}),hde=/\s+/,pde=(t,e)=>{const{parseClassName:n,getClassGroupId:r,getConflictingClassGroupIds:i,sortModifiers:a}=e,o=[],s=t.trim().split(hde);let l="";for(let c=s.length-1;c>=0;c-=1){const f=s[c],{isExternal:u,modifiers:d,hasImportantModifier:h,baseClassName:p,maybePostfixModifierPosition:g}=n(f);if(u){l=f+(l.length>0?" "+l:l);continue}let m=!!g,y=r(m?p.substring(0,g):p);if(!y){if(!m){l=f+(l.length>0?" "+l:l);continue}if(y=r(p),!y){l=f+(l.length>0?" "+l:l);continue}m=!1}const v=a(d).join(":"),x=h?v+LE:v,w=x+y;if(o.includes(w))continue;o.push(w);const S=i(y,m);for(let T=0;T<S.length;++T){const _=S[T];o.push(x+_)}l=f+(l.length>0?" "+l:l)}return l};function gde(){let t=0,e,n,r="";for(;t<arguments.length;)(e=arguments[t++])&&(n=NG(e))&&(r&&(r+=" "),r+=n);return r}const NG=t=>{if(typeof t=="string")return t;let e,n="";for(let r=0;r<t.length;r++)t[r]&&(e=NG(t[r]))&&(n&&(n+=" "),n+=e);return n};function VE(t,...e){let n,r,i,a=o;function o(l){const c=e.reduce((f,u)=>u(f),t());return n=dde(c),r=n.cache.get,i=n.cache.set,a=s,s(l)}function s(l){const c=r(l);if(c)return c;const f=pde(l,n);return i(l,f),f}return function(){return a(gde.apply(null,arguments))}}const Da=t=>{const e=n=>n[t]||[];return e.isThemeGetter=!0,e},LG=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,kG=/^\((?:(\w[\w-]*):)?(.+)\)$/i,mde=/^\d+\/\d+$/,vde=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,yde=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,xde=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,bde=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,wde=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,zp=t=>mde.test(t),Wn=t=>!!t&&!Number.isNaN(Number(t)),dd=t=>!!t&&Number.isInteger(Number(t)),QS=t=>t.endsWith("%")&&Wn(t.slice(0,-1)),Zu=t=>vde.test(t),Cde=()=>!0,Sde=t=>yde.test(t)&&!xde.test(t),VG=()=>!1,Tde=t=>bde.test(t),Ede=t=>wde.test(t),_de=t=>!Jt(t)&&!Zt(t),Dde=t=>Dm(t,BG,VG),Jt=t=>LG.test(t),j0=t=>Dm(t,$G,Sde),eT=t=>Dm(t,Ade,Wn),vP=t=>Dm(t,FG,VG),Ode=t=>Dm(t,UG,Ede),k5=t=>Dm(t,GG,Tde),Zt=t=>kG.test(t),$1=t=>Om(t,$G),Mde=t=>Om(t,Pde),yP=t=>Om(t,FG),Ide=t=>Om(t,BG),Rde=t=>Om(t,UG),V5=t=>Om(t,GG,!0),Dm=(t,e,n)=>{const r=LG.exec(t);return r?r[1]?e(r[1]):n(r[2]):!1},Om=(t,e,n=!1)=>{const r=kG.exec(t);return r?r[1]?e(r[1]):n:!1},FG=t=>t==="position"||t==="percentage",UG=t=>t==="image"||t==="url",BG=t=>t==="length"||t==="size"||t==="bg-size",$G=t=>t==="length",Ade=t=>t==="number",Pde=t=>t==="family-name",GG=t=>t==="shadow",FE=()=>{const t=Da("color"),e=Da("font"),n=Da("text"),r=Da("font-weight"),i=Da("tracking"),a=Da("leading"),o=Da("breakpoint"),s=Da("container"),l=Da("spacing"),c=Da("radius"),f=Da("shadow"),u=Da("inset-shadow"),d=Da("text-shadow"),h=Da("drop-shadow"),p=Da("blur"),g=Da("perspective"),m=Da("aspect"),y=Da("ease"),v=Da("animate"),x=()=>["auto","avoid","all","avoid-page","page","left","right","column"],w=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],S=()=>[...w(),Zt,Jt],T=()=>["auto","hidden","clip","visible","scroll"],_=()=>["auto","contain","none"],D=()=>[Zt,Jt,l],I=()=>[zp,"full","auto",...D()],R=()=>[dd,"none","subgrid",Zt,Jt],M=()=>["auto",{span:["full",dd,Zt,Jt]},dd,Zt,Jt],A=()=>[dd,"auto",Zt,Jt],L=()=>["auto","min","max","fr",Zt,Jt],P=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],B=()=>["start","end","center","stretch","center-safe","end-safe"],U=()=>["auto",...D()],G=()=>[zp,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...D()],F=()=>[t,Zt,Jt],$=()=>[...w(),yP,vP,{position:[Zt,Jt]}],V=()=>["no-repeat",{repeat:["","x","y","space","round"]}],X=()=>["auto","cover","contain",Ide,Dde,{size:[Zt,Jt]}],Q=()=>[QS,$1,j0],re=()=>["","none","full",c,Zt,Jt],ye=()=>["",Wn,$1,j0],me=()=>["solid","dashed","dotted","double"],Ce=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],we=()=>[Wn,QS,yP,vP],Ae=()=>["","none",p,Zt,Jt],De=()=>["none",Wn,Zt,Jt],q=()=>["none",Wn,Zt,Jt],k=()=>[Wn,Zt,Jt],J=()=>[zp,"full",...D()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[Zu],breakpoint:[Zu],color:[Cde],container:[Zu],"drop-shadow":[Zu],ease:["in","out","in-out"],font:[_de],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[Zu],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[Zu],shadow:[Zu],spacing:["px",Wn],text:[Zu],"text-shadow":[Zu],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",zp,Jt,Zt,m]}],container:["container"],columns:[{columns:[Wn,Jt,Zt,s]}],"break-after":[{"break-after":x()}],"break-before":[{"break-before":x()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:S()}],overflow:[{overflow:T()}],"overflow-x":[{"overflow-x":T()}],"overflow-y":[{"overflow-y":T()}],overscroll:[{overscroll:_()}],"overscroll-x":[{"overscroll-x":_()}],"overscroll-y":[{"overscroll-y":_()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:I()}],"inset-x":[{"inset-x":I()}],"inset-y":[{"inset-y":I()}],start:[{start:I()}],end:[{end:I()}],top:[{top:I()}],right:[{right:I()}],bottom:[{bottom:I()}],left:[{left:I()}],visibility:["visible","invisible","collapse"],z:[{z:[dd,"auto",Zt,Jt]}],basis:[{basis:[zp,"full","auto",s,...D()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[Wn,zp,"auto","initial","none",Jt]}],grow:[{grow:["",Wn,Zt,Jt]}],shrink:[{shrink:["",Wn,Zt,Jt]}],order:[{order:[dd,"first","last","none",Zt,Jt]}],"grid-cols":[{"grid-cols":R()}],"col-start-end":[{col:M()}],"col-start":[{"col-start":A()}],"col-end":[{"col-end":A()}],"grid-rows":[{"grid-rows":R()}],"row-start-end":[{row:M()}],"row-start":[{"row-start":A()}],"row-end":[{"row-end":A()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":L()}],"auto-rows":[{"auto-rows":L()}],gap:[{gap:D()}],"gap-x":[{"gap-x":D()}],"gap-y":[{"gap-y":D()}],"justify-content":[{justify:[...P(),"normal"]}],"justify-items":[{"justify-items":[...B(),"normal"]}],"justify-self":[{"justify-self":["auto",...B()]}],"align-content":[{content:["normal",...P()]}],"align-items":[{items:[...B(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...B(),{baseline:["","last"]}]}],"place-content":[{"place-content":P()}],"place-items":[{"place-items":[...B(),"baseline"]}],"place-self":[{"place-self":["auto",...B()]}],p:[{p:D()}],px:[{px:D()}],py:[{py:D()}],ps:[{ps:D()}],pe:[{pe:D()}],pt:[{pt:D()}],pr:[{pr:D()}],pb:[{pb:D()}],pl:[{pl:D()}],m:[{m:U()}],mx:[{mx:U()}],my:[{my:U()}],ms:[{ms:U()}],me:[{me:U()}],mt:[{mt:U()}],mr:[{mr:U()}],mb:[{mb:U()}],ml:[{ml:U()}],"space-x":[{"space-x":D()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":D()}],"space-y-reverse":["space-y-reverse"],size:[{size:G()}],w:[{w:[s,"screen",...G()]}],"min-w":[{"min-w":[s,"screen","none",...G()]}],"max-w":[{"max-w":[s,"screen","none","prose",{screen:[o]},...G()]}],h:[{h:["screen","lh",...G()]}],"min-h":[{"min-h":["screen","lh","none",...G()]}],"max-h":[{"max-h":["screen","lh",...G()]}],"font-size":[{text:["base",n,$1,j0]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[r,Zt,eT]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",QS,Jt]}],"font-family":[{font:[Mde,Jt,e]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[i,Zt,Jt]}],"line-clamp":[{"line-clamp":[Wn,"none",Zt,eT]}],leading:[{leading:[a,...D()]}],"list-image":[{"list-image":["none",Zt,Jt]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",Zt,Jt]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:F()}],"text-color":[{text:F()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...me(),"wavy"]}],"text-decoration-thickness":[{decoration:[Wn,"from-font","auto",Zt,j0]}],"text-decoration-color":[{decoration:F()}],"underline-offset":[{"underline-offset":[Wn,"auto",Zt,Jt]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:D()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Zt,Jt]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Zt,Jt]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:$()}],"bg-repeat":[{bg:V()}],"bg-size":[{bg:X()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},dd,Zt,Jt],radial:["",Zt,Jt],conic:[dd,Zt,Jt]},Rde,Ode]}],"bg-color":[{bg:F()}],"gradient-from-pos":[{from:Q()}],"gradient-via-pos":[{via:Q()}],"gradient-to-pos":[{to:Q()}],"gradient-from":[{from:F()}],"gradient-via":[{via:F()}],"gradient-to":[{to:F()}],rounded:[{rounded:re()}],"rounded-s":[{"rounded-s":re()}],"rounded-e":[{"rounded-e":re()}],"rounded-t":[{"rounded-t":re()}],"rounded-r":[{"rounded-r":re()}],"rounded-b":[{"rounded-b":re()}],"rounded-l":[{"rounded-l":re()}],"rounded-ss":[{"rounded-ss":re()}],"rounded-se":[{"rounded-se":re()}],"rounded-ee":[{"rounded-ee":re()}],"rounded-es":[{"rounded-es":re()}],"rounded-tl":[{"rounded-tl":re()}],"rounded-tr":[{"rounded-tr":re()}],"rounded-br":[{"rounded-br":re()}],"rounded-bl":[{"rounded-bl":re()}],"border-w":[{border:ye()}],"border-w-x":[{"border-x":ye()}],"border-w-y":[{"border-y":ye()}],"border-w-s":[{"border-s":ye()}],"border-w-e":[{"border-e":ye()}],"border-w-t":[{"border-t":ye()}],"border-w-r":[{"border-r":ye()}],"border-w-b":[{"border-b":ye()}],"border-w-l":[{"border-l":ye()}],"divide-x":[{"divide-x":ye()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":ye()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...me(),"hidden","none"]}],"divide-style":[{divide:[...me(),"hidden","none"]}],"border-color":[{border:F()}],"border-color-x":[{"border-x":F()}],"border-color-y":[{"border-y":F()}],"border-color-s":[{"border-s":F()}],"border-color-e":[{"border-e":F()}],"border-color-t":[{"border-t":F()}],"border-color-r":[{"border-r":F()}],"border-color-b":[{"border-b":F()}],"border-color-l":[{"border-l":F()}],"divide-color":[{divide:F()}],"outline-style":[{outline:[...me(),"none","hidden"]}],"outline-offset":[{"outline-offset":[Wn,Zt,Jt]}],"outline-w":[{outline:["",Wn,$1,j0]}],"outline-color":[{outline:F()}],shadow:[{shadow:["","none",f,V5,k5]}],"shadow-color":[{shadow:F()}],"inset-shadow":[{"inset-shadow":["none",u,V5,k5]}],"inset-shadow-color":[{"inset-shadow":F()}],"ring-w":[{ring:ye()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:F()}],"ring-offset-w":[{"ring-offset":[Wn,j0]}],"ring-offset-color":[{"ring-offset":F()}],"inset-ring-w":[{"inset-ring":ye()}],"inset-ring-color":[{"inset-ring":F()}],"text-shadow":[{"text-shadow":["none",d,V5,k5]}],"text-shadow-color":[{"text-shadow":F()}],opacity:[{opacity:[Wn,Zt,Jt]}],"mix-blend":[{"mix-blend":[...Ce(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":Ce()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[Wn]}],"mask-image-linear-from-pos":[{"mask-linear-from":we()}],"mask-image-linear-to-pos":[{"mask-linear-to":we()}],"mask-image-linear-from-color":[{"mask-linear-from":F()}],"mask-image-linear-to-color":[{"mask-linear-to":F()}],"mask-image-t-from-pos":[{"mask-t-from":we()}],"mask-image-t-to-pos":[{"mask-t-to":we()}],"mask-image-t-from-color":[{"mask-t-from":F()}],"mask-image-t-to-color":[{"mask-t-to":F()}],"mask-image-r-from-pos":[{"mask-r-from":we()}],"mask-image-r-to-pos":[{"mask-r-to":we()}],"mask-image-r-from-color":[{"mask-r-from":F()}],"mask-image-r-to-color":[{"mask-r-to":F()}],"mask-image-b-from-pos":[{"mask-b-from":we()}],"mask-image-b-to-pos":[{"mask-b-to":we()}],"mask-image-b-from-color":[{"mask-b-from":F()}],"mask-image-b-to-color":[{"mask-b-to":F()}],"mask-image-l-from-pos":[{"mask-l-from":we()}],"mask-image-l-to-pos":[{"mask-l-to":we()}],"mask-image-l-from-color":[{"mask-l-from":F()}],"mask-image-l-to-color":[{"mask-l-to":F()}],"mask-image-x-from-pos":[{"mask-x-from":we()}],"mask-image-x-to-pos":[{"mask-x-to":we()}],"mask-image-x-from-color":[{"mask-x-from":F()}],"mask-image-x-to-color":[{"mask-x-to":F()}],"mask-image-y-from-pos":[{"mask-y-from":we()}],"mask-image-y-to-pos":[{"mask-y-to":we()}],"mask-image-y-from-color":[{"mask-y-from":F()}],"mask-image-y-to-color":[{"mask-y-to":F()}],"mask-image-radial":[{"mask-radial":[Zt,Jt]}],"mask-image-radial-from-pos":[{"mask-radial-from":we()}],"mask-image-radial-to-pos":[{"mask-radial-to":we()}],"mask-image-radial-from-color":[{"mask-radial-from":F()}],"mask-image-radial-to-color":[{"mask-radial-to":F()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":w()}],"mask-image-conic-pos":[{"mask-conic":[Wn]}],"mask-image-conic-from-pos":[{"mask-conic-from":we()}],"mask-image-conic-to-pos":[{"mask-conic-to":we()}],"mask-image-conic-from-color":[{"mask-conic-from":F()}],"mask-image-conic-to-color":[{"mask-conic-to":F()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:$()}],"mask-repeat":[{mask:V()}],"mask-size":[{mask:X()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",Zt,Jt]}],filter:[{filter:["","none",Zt,Jt]}],blur:[{blur:Ae()}],brightness:[{brightness:[Wn,Zt,Jt]}],contrast:[{contrast:[Wn,Zt,Jt]}],"drop-shadow":[{"drop-shadow":["","none",h,V5,k5]}],"drop-shadow-color":[{"drop-shadow":F()}],grayscale:[{grayscale:["",Wn,Zt,Jt]}],"hue-rotate":[{"hue-rotate":[Wn,Zt,Jt]}],invert:[{invert:["",Wn,Zt,Jt]}],saturate:[{saturate:[Wn,Zt,Jt]}],sepia:[{sepia:["",Wn,Zt,Jt]}],"backdrop-filter":[{"backdrop-filter":["","none",Zt,Jt]}],"backdrop-blur":[{"backdrop-blur":Ae()}],"backdrop-brightness":[{"backdrop-brightness":[Wn,Zt,Jt]}],"backdrop-contrast":[{"backdrop-contrast":[Wn,Zt,Jt]}],"backdrop-grayscale":[{"backdrop-grayscale":["",Wn,Zt,Jt]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[Wn,Zt,Jt]}],"backdrop-invert":[{"backdrop-invert":["",Wn,Zt,Jt]}],"backdrop-opacity":[{"backdrop-opacity":[Wn,Zt,Jt]}],"backdrop-saturate":[{"backdrop-saturate":[Wn,Zt,Jt]}],"backdrop-sepia":[{"backdrop-sepia":["",Wn,Zt,Jt]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":D()}],"border-spacing-x":[{"border-spacing-x":D()}],"border-spacing-y":[{"border-spacing-y":D()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",Zt,Jt]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[Wn,"initial",Zt,Jt]}],ease:[{ease:["linear","initial",y,Zt,Jt]}],delay:[{delay:[Wn,Zt,Jt]}],animate:[{animate:["none",v,Zt,Jt]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[g,Zt,Jt]}],"perspective-origin":[{"perspective-origin":S()}],rotate:[{rotate:De()}],"rotate-x":[{"rotate-x":De()}],"rotate-y":[{"rotate-y":De()}],"rotate-z":[{"rotate-z":De()}],scale:[{scale:q()}],"scale-x":[{"scale-x":q()}],"scale-y":[{"scale-y":q()}],"scale-z":[{"scale-z":q()}],"scale-3d":["scale-3d"],skew:[{skew:k()}],"skew-x":[{"skew-x":k()}],"skew-y":[{"skew-y":k()}],transform:[{transform:[Zt,Jt,"","none","gpu","cpu"]}],"transform-origin":[{origin:S()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:J()}],"translate-x":[{"translate-x":J()}],"translate-y":[{"translate-y":J()}],"translate-z":[{"translate-z":J()}],"translate-none":["translate-none"],accent:[{accent:F()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:F()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Zt,Jt]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":D()}],"scroll-mx":[{"scroll-mx":D()}],"scroll-my":[{"scroll-my":D()}],"scroll-ms":[{"scroll-ms":D()}],"scroll-me":[{"scroll-me":D()}],"scroll-mt":[{"scroll-mt":D()}],"scroll-mr":[{"scroll-mr":D()}],"scroll-mb":[{"scroll-mb":D()}],"scroll-ml":[{"scroll-ml":D()}],"scroll-p":[{"scroll-p":D()}],"scroll-px":[{"scroll-px":D()}],"scroll-py":[{"scroll-py":D()}],"scroll-ps":[{"scroll-ps":D()}],"scroll-pe":[{"scroll-pe":D()}],"scroll-pt":[{"scroll-pt":D()}],"scroll-pr":[{"scroll-pr":D()}],"scroll-pb":[{"scroll-pb":D()}],"scroll-pl":[{"scroll-pl":D()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Zt,Jt]}],fill:[{fill:["none",...F()]}],"stroke-w":[{stroke:[Wn,$1,j0,eT]}],stroke:[{stroke:["none",...F()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},Nde=(t,{cacheSize:e,prefix:n,experimentalParseClassName:r,extend:i={},override:a={}})=>(fv(t,"cacheSize",e),fv(t,"prefix",n),fv(t,"experimentalParseClassName",r),F5(t.theme,a.theme),F5(t.classGroups,a.classGroups),F5(t.conflictingClassGroups,a.conflictingClassGroups),F5(t.conflictingClassGroupModifiers,a.conflictingClassGroupModifiers),fv(t,"orderSensitiveModifiers",a.orderSensitiveModifiers),U5(t.theme,i.theme),U5(t.classGroups,i.classGroups),U5(t.conflictingClassGroups,i.conflictingClassGroups),U5(t.conflictingClassGroupModifiers,i.conflictingClassGroupModifiers),jG(t,i,"orderSensitiveModifiers"),t),fv=(t,e,n)=>{n!==void 0&&(t[e]=n)},F5=(t,e)=>{if(e)for(const n in e)fv(t,n,e[n])},U5=(t,e)=>{if(e)for(const n in e)jG(t,e,n)},jG=(t,e,n)=>{const r=e[n];r!==void 0&&(t[n]=t[n]?t[n].concat(r):r)},Lde=(t,...e)=>typeof t=="function"?VE(FE,t,...e):VE(()=>Nde(FE(),t),...e),kde=VE(FE);var Vde=t=>vs(t)?kde:Lde({...t,extend:{theme:t.theme,classGroups:t.classGroups,conflictingClassGroupModifiers:t.conflictingClassGroupModifiers,conflictingClassGroups:t.conflictingClassGroups,...t.extend}}),Fde={twMerge:!0,twMergeConfig:{},responsiveVariants:!1},Wb=(...t)=>{let e=[];zG(t,e);let n="";for(let r=0;r<e.length;r++)e[r]&&(n&&(n+=" "),n+=e[r]);return n||void 0};function zG(t,e){for(let n=0;n<t.length;n++){let r=t[n];Array.isArray(r)?zG(r,e):r&&e.push(r)}}var tT=null,UE={},BE=!1,B5=(...t)=>e=>{let n=Wb(t);return!n||!e.twMerge?n:((!tT||BE)&&(BE=!1,tT=Vde(UE)),tT(n)||void 0)},xP=(t,e)=>{for(let n in e)n in t?t[n]=Wb(t[n],e[n]):t[n]=e[n];return t},Ude=(t,e)=>{let{extend:n=null,slots:r={},variants:i={},compoundVariants:a=[],compoundSlots:o=[],defaultVariants:s={}}=t,l={...Fde,...e},c=n?.base?Wb(n.base,t?.base):t?.base,f=n?.variants&&!vs(n.variants)?AG(i,n.variants):i,u=n?.defaultVariants&&!vs(n.defaultVariants)?{...n.defaultVariants,...s}:s;!vs(l.twMergeConfig)&&!tde(l.twMergeConfig,UE)&&(BE=!0,UE=l.twMergeConfig);let d=vs(n?.slots),h=vs(r)?{}:{base:Wb(t?.base,d&&n?.base),...r},p=d?h:xP({...n?.slots},vs(h)?{base:t?.base}:h),g=vs(n?.compoundVariants)?a:RG(n?.compoundVariants,a),m=v=>{if(vs(f)&&vs(r)&&d)return B5(c,v?.class,v?.className)(l);if(g&&!Array.isArray(g))throw new TypeError(`The "compoundVariants" prop must be an array. Received: ${typeof g}`);if(o&&!Array.isArray(o))throw new TypeError(`The "compoundSlots" prop must be an array. Received: ${typeof o}`);let x=(A,L,P=[],B)=>{let U=P;if(typeof L=="string"){let G=pP(L).split(" ");for(let F=0;F<G.length;F++)U.push(`${A}:${G[F]}`)}else if(Array.isArray(L))for(let G=0;G<L.length;G++)U.push(`${A}:${L[G]}`);else if(typeof L=="object"&&typeof B=="string"&&B in L){let G=L[B];if(G&&typeof G=="string"){let F=pP(G).split(" "),$=[];for(let V=0;V<F.length;V++)$.push(`${A}:${F[V]}`);U[B]=U[B]?U[B].concat($):$}else if(Array.isArray(G)&&G.length>0){let F=[];for(let $=0;$<G.length;$++)F.push(`${A}:${G[$]}`);U[B]=F}}return U},w=(A,L=f,P=null,B=null)=>{let U=L[A];if(!U||vs(U))return null;let G=B?.[A]??v?.[A];if(G===null)return null;let F=hP(G),$=Array.isArray(l.responsiveVariants)&&l.responsiveVariants.length>0||l.responsiveVariants===!0,V=u?.[A],X=[];if(typeof F=="object"&&$)for(let[ye,me]of Object.entries(F)){let Ce=U[me];if(ye==="initial"){V=me;continue}Array.isArray(l.responsiveVariants)&&!l.responsiveVariants.includes(ye)||(X=x(ye,Ce,X,P))}let Q=F!=null&&typeof F!="object"?F:hP(V),re=U[Q||"false"];return typeof X=="object"&&typeof P=="string"&&X[P]?xP(X,re):X.length>0?(X.push(re),P==="base"?X.join(" "):X):re},S=()=>{if(!f)return null;let A=Object.keys(f),L=[];for(let P=0;P<A.length;P++){let B=w(A[P],f);B&&L.push(B)}return L},T=(A,L)=>{if(!f||typeof f!="object")return null;let P=[];for(let B in f){let U=w(B,f,A,L),G=A==="base"&&typeof U=="string"?U:U&&U[A];G&&P.push(G)}return P},_={};for(let A in v){let L=v[A];L!==void 0&&(_[A]=L)}let D=(A,L)=>{let P=typeof v?.[A]=="object"?{[A]:v[A]?.initial}:{};return{...u,..._,...P,...L}},I=(A=[],L)=>{let P=[],B=A.length;for(let U=0;U<B;U++){let{class:G,className:F,...$}=A[U],V=!0,X=D(null,L);for(let Q in $){let re=$[Q],ye=X[Q];if(Array.isArray(re)){if(!re.includes(ye)){V=!1;break}}else{if((re==null||re===!1)&&(ye==null||ye===!1))continue;if(ye!==re){V=!1;break}}}V&&(G&&P.push(G),F&&P.push(F))}return P},R=A=>{let L=I(g,A);if(!Array.isArray(L))return L;let P={},B=B5;for(let U=0;U<L.length;U++){let G=L[U];if(typeof G=="string")P.base=B(P.base,G)(l);else if(typeof G=="object")for(let F in G)P[F]=B(P[F],G[F])(l)}return P},M=A=>{if(o.length<1)return null;let L={},P=D(null,A);for(let B=0;B<o.length;B++){let{slots:U=[],class:G,className:F,...$}=o[B];if(!vs($)){let V=!0;for(let X in $){let Q=P[X],re=$[X];if(Q===void 0||(Array.isArray(re)?!re.includes(Q):re!==Q)){V=!1;break}}if(!V)continue}for(let V=0;V<U.length;V++){let X=U[V];L[X]||(L[X]=[]),L[X].push([G,F])}}return L};if(!vs(r)||!d){let A={};if(typeof p=="object"&&!vs(p)){let L=B5;for(let P in p)A[P]=B=>{let U=R(B),G=M(B);return L(p[P],T(P,B),U?U[P]:void 0,G?G[P]:void 0,B?.class,B?.className)(l)}}return A}return B5(c,S(),I(g),v?.class,v?.className)(l)},y=()=>{if(!(!f||typeof f!="object"))return Object.keys(f)};return m.variantKeys=y(),m.extend=n,m.base=c,m.slots=p,m.variants=f,m.defaultVariants=u,m.compoundSlots=o,m.compoundVariants=g,m},Ka=(t,e)=>{var n,r,i;return Ude(t,{...e,twMerge:(n=void 0)!=null?n:!0,twMergeConfig:{theme:{...(r=void 0)==null?void 0:r.theme,...dP.theme},classGroups:{...(i=void 0)==null?void 0:i.classGroups,...dP.classGroups}}})},bP=Ka({slots:{base:"relative inline-flex flex-col gap-2 items-center justify-center",wrapper:"relative flex",label:"text-foreground dark:text-foreground-dark font-regular",circle1:"absolute w-full h-full rounded-full",circle2:"absolute w-full h-full rounded-full",dots:"relative rounded-full mx-auto",spinnerBars:["absolute","animate-fade-out","rounded-full","w-[25%]","h-[8%]","left-[calc(37.5%)]","top-[calc(46%)]","spinner-bar-animation"]},variants:{size:{sm:{wrapper:"w-5 h-5",circle1:"border-2",circle2:"border-2",dots:"size-1",label:"text-small"},md:{wrapper:"w-8 h-8",circle1:"border-3",circle2:"border-3",dots:"size-1.5",label:"text-medium"},lg:{wrapper:"w-10 h-10",circle1:"border-3",circle2:"border-3",dots:"size-2",label:"text-large"}},color:{current:{circle1:"border-b-current",circle2:"border-b-current",dots:"bg-current",spinnerBars:"bg-current"},white:{circle1:"border-b-white",circle2:"border-b-white",dots:"bg-white",spinnerBars:"bg-white"},default:{circle1:"border-b-default",circle2:"border-b-default",dots:"bg-default",spinnerBars:"bg-default"},primary:{circle1:"border-b-primary",circle2:"border-b-primary",dots:"bg-primary",spinnerBars:"bg-primary"},secondary:{circle1:"border-b-secondary",circle2:"border-b-secondary",dots:"bg-secondary",spinnerBars:"bg-secondary"},success:{circle1:"border-b-success",circle2:"border-b-success",dots:"bg-success",spinnerBars:"bg-success"},warning:{circle1:"border-b-warning",circle2:"border-b-warning",dots:"bg-warning",spinnerBars:"bg-warning"},danger:{circle1:"border-b-danger",circle2:"border-b-danger",dots:"bg-danger",spinnerBars:"bg-danger"}},labelColor:{foreground:{label:"text-foreground"},primary:{label:"text-primary"},secondary:{label:"text-secondary"},success:{label:"text-success"},warning:{label:"text-warning"},danger:{label:"text-danger"}},variant:{default:{circle1:["animate-spinner-ease-spin","border-solid","border-t-transparent","border-l-transparent","border-r-transparent"],circle2:["opacity-75","animate-spinner-linear-spin","border-dotted","border-t-transparent","border-l-transparent","border-r-transparent"]},gradient:{circle1:["border-0","bg-gradient-to-b","from-transparent","via-transparent","to-primary","animate-spinner-linear-spin","[animation-duration:1s]","[-webkit-mask:radial-gradient(closest-side,rgba(0,0,0,0.0)calc(100%-3px),rgba(0,0,0,1)calc(100%-3px))]"],circle2:["hidden"]},wave:{wrapper:"translate-y-3/4",dots:["animate-sway","spinner-dot-animation"]},dots:{wrapper:"translate-y-2/4",dots:["animate-blink","spinner-dot-blink-animation"]},spinner:{},simple:{wrapper:"text-foreground h-5 w-5 animate-spin",circle1:"opacity-25",circle2:"opacity-75"}}},defaultVariants:{size:"md",color:"primary",labelColor:"foreground",variant:"default"},compoundVariants:[{variant:"gradient",color:"current",class:{circle1:"to-current"}},{variant:"gradient",color:"white",class:{circle1:"to-white"}},{variant:"gradient",color:"default",class:{circle1:"to-default"}},{variant:"gradient",color:"primary",class:{circle1:"to-primary"}},{variant:"gradient",color:"secondary",class:{circle1:"to-secondary"}},{variant:"gradient",color:"success",class:{circle1:"to-success"}},{variant:"gradient",color:"warning",class:{circle1:"to-warning"}},{variant:"gradient",color:"danger",class:{circle1:"to-danger"}},{variant:"wave",size:"sm",class:{wrapper:"w-5 h-5"}},{variant:"wave",size:"md",class:{wrapper:"w-8 h-8"}},{variant:"wave",size:"lg",class:{wrapper:"w-12 h-12"}},{variant:"dots",size:"sm",class:{wrapper:"w-5 h-5"}},{variant:"dots",size:"md",class:{wrapper:"w-8 h-8"}},{variant:"dots",size:"lg",class:{wrapper:"w-12 h-12"}},{variant:"simple",size:"sm",class:{wrapper:"w-5 h-5"}},{variant:"simple",size:"md",class:{wrapper:"w-8 h-8"}},{variant:"simple",size:"lg",class:{wrapper:"w-12 h-12"}},{variant:"simple",color:"current",class:{wrapper:"text-current"}},{variant:"simple",color:"white",class:{wrapper:"text-white"}},{variant:"simple",color:"default",class:{wrapper:"text-default"}},{variant:"simple",color:"primary",class:{wrapper:"text-primary"}},{variant:"simple",color:"secondary",class:{wrapper:"text-secondary"}},{variant:"simple",color:"success",class:{wrapper:"text-success"}},{variant:"simple",color:"warning",class:{wrapper:"text-warning"}},{variant:"simple",color:"danger",class:{wrapper:"text-danger"}}]}),pu=["outline-solid outline-transparent","data-[focus-visible=true]:z-10","data-[focus-visible=true]:outline-2","data-[focus-visible=true]:outline-focus","data-[focus-visible=true]:outline-offset-2"],Bde=["outline-solid outline-transparent","group-data-[focus-visible=true]:z-10","group-data-[focus-visible=true]:ring-2","group-data-[focus-visible=true]:ring-focus","group-data-[focus-visible=true]:ring-offset-2","group-data-[focus-visible=true]:ring-offset-background"],$de=["outline-solid outline-transparent","ring-2","ring-focus","ring-offset-2","ring-offset-background"],Wp={default:["[&+.border-medium.border-default]:ms-[calc(var(--heroui-border-width-medium)*-1)]"],primary:["[&+.border-medium.border-primary]:ms-[calc(var(--heroui-border-width-medium)*-1)]"],secondary:["[&+.border-medium.border-secondary]:ms-[calc(var(--heroui-border-width-medium)*-1)]"],success:["[&+.border-medium.border-success]:ms-[calc(var(--heroui-border-width-medium)*-1)]"],warning:["[&+.border-medium.border-warning]:ms-[calc(var(--heroui-border-width-medium)*-1)]"],danger:["[&+.border-medium.border-danger]:ms-[calc(var(--heroui-border-width-medium)*-1)]"]},wP=Ka({slots:{base:"inline-flex",tabList:["flex","p-1","h-fit","gap-2","items-center","flex-nowrap","overflow-x-scroll","scrollbar-hide","bg-default-100"],tab:["z-0","w-full","px-3","py-1","flex","group","relative","justify-center","items-center","outline-solid outline-transparent","cursor-pointer","transition-opacity","tap-highlight-transparent","data-[disabled=true]:cursor-not-allowed","data-[disabled=true]:opacity-30","data-[hover-unselected=true]:opacity-disabled",...pu],tabContent:["relative","z-10","text-inherit","whitespace-nowrap","transition-colors","text-default-500","group-data-[selected=true]:text-foreground"],cursor:["absolute","z-0","bg-white"],panel:["py-3","px-1","outline-solid outline-transparent","data-[inert=true]:hidden",...pu],tabWrapper:[]},variants:{variant:{solid:{cursor:"inset-0"},light:{tabList:"bg-transparent dark:bg-transparent",cursor:"inset-0"},underlined:{tabList:"bg-transparent dark:bg-transparent",cursor:"h-[2px] w-[80%] bottom-0 shadow-[0_1px_0px_0_rgba(0,0,0,0.05)]"},bordered:{tabList:"bg-transparent dark:bg-transparent border-medium border-default-200 shadow-xs",cursor:"inset-0"}},color:{default:{},primary:{},secondary:{},success:{},warning:{},danger:{}},size:{sm:{tabList:"rounded-medium",tab:"h-7 text-tiny rounded-small",cursor:"rounded-small"},md:{tabList:"rounded-medium",tab:"h-8 text-small rounded-small",cursor:"rounded-small"},lg:{tabList:"rounded-large",tab:"h-9 text-medium rounded-medium",cursor:"rounded-medium"}},radius:{none:{tabList:"rounded-none",tab:"rounded-none",cursor:"rounded-none"},sm:{tabList:"rounded-medium",tab:"rounded-small",cursor:"rounded-small"},md:{tabList:"rounded-medium",tab:"rounded-small",cursor:"rounded-small"},lg:{tabList:"rounded-large",tab:"rounded-medium",cursor:"rounded-medium"},full:{tabList:"rounded-full",tab:"rounded-full",cursor:"rounded-full"}},fullWidth:{true:{base:"w-full",tabList:"w-full"}},isDisabled:{true:{tabList:"opacity-disabled pointer-events-none"}},disableAnimation:{true:{tab:"transition-none",tabContent:"transition-none"}},placement:{top:{},start:{tabList:"flex-col",panel:"py-0 px-3",tabWrapper:"flex"},end:{tabList:"flex-col",panel:"py-0 px-3",tabWrapper:"flex flex-row-reverse"},bottom:{tabWrapper:"flex flex-col-reverse"}}},defaultVariants:{color:"default",variant:"solid",size:"md",fullWidth:!1,isDisabled:!1},compoundVariants:[{variant:["solid","bordered","light"],color:"default",class:{cursor:["bg-background","dark:bg-default","shadow-small"],tabContent:"group-data-[selected=true]:text-default-foreground"}},{variant:["solid","bordered","light"],color:"primary",class:{cursor:It.solid.primary,tabContent:"group-data-[selected=true]:text-primary-foreground"}},{variant:["solid","bordered","light"],color:"secondary",class:{cursor:It.solid.secondary,tabContent:"group-data-[selected=true]:text-secondary-foreground"}},{variant:["solid","bordered","light"],color:"success",class:{cursor:It.solid.success,tabContent:"group-data-[selected=true]:text-success-foreground"}},{variant:["solid","bordered","light"],color:"warning",class:{cursor:It.solid.warning,tabContent:"group-data-[selected=true]:text-warning-foreground"}},{variant:["solid","bordered","light"],color:"danger",class:{cursor:It.solid.danger,tabContent:"group-data-[selected=true]:text-danger-foreground"}},{variant:"underlined",color:"default",class:{cursor:"bg-foreground",tabContent:"group-data-[selected=true]:text-foreground"}},{variant:"underlined",color:"primary",class:{cursor:"bg-primary",tabContent:"group-data-[selected=true]:text-primary"}},{variant:"underlined",color:"secondary",class:{cursor:"bg-secondary",tabContent:"group-data-[selected=true]:text-secondary"}},{variant:"underlined",color:"success",class:{cursor:"bg-success",tabContent:"group-data-[selected=true]:text-success"}},{variant:"underlined",color:"warning",class:{cursor:"bg-warning",tabContent:"group-data-[selected=true]:text-warning"}},{variant:"underlined",color:"danger",class:{cursor:"bg-danger",tabContent:"group-data-[selected=true]:text-danger"}},{disableAnimation:!0,variant:"underlined",class:{tab:["after:content-['']","after:absolute","after:bottom-0","after:h-[2px]","after:w-[80%]","after:opacity-0","after:shadow-[0_1px_0px_0_rgba(0,0,0,0.05)]","data-[selected=true]:after:opacity-100"]}},{disableAnimation:!0,color:"default",variant:["solid","bordered","light"],class:{tab:"data-[selected=true]:bg-default data-[selected=true]:text-default-foreground"}},{disableAnimation:!0,color:"primary",variant:["solid","bordered","light"],class:{tab:"data-[selected=true]:bg-primary data-[selected=true]:text-primary-foreground"}},{disableAnimation:!0,color:"secondary",variant:["solid","bordered","light"],class:{tab:"data-[selected=true]:bg-secondary data-[selected=true]:text-secondary-foreground"}},{disableAnimation:!0,color:"success",variant:["solid","bordered","light"],class:{tab:"data-[selected=true]:bg-success data-[selected=true]:text-success-foreground"}},{disableAnimation:!0,color:"warning",variant:["solid","bordered","light"],class:{tab:"data-[selected=true]:bg-warning data-[selected=true]:text-warning-foreground"}},{disableAnimation:!0,color:"danger",variant:["solid","bordered","light"],class:{tab:"data-[selected=true]:bg-danger data-[selected=true]:text-danger-foreground"}},{disableAnimation:!0,color:"default",variant:"underlined",class:{tab:"data-[selected=true]:after:bg-foreground"}},{disableAnimation:!0,color:"primary",variant:"underlined",class:{tab:"data-[selected=true]:after:bg-primary"}},{disableAnimation:!0,color:"secondary",variant:"underlined",class:{tab:"data-[selected=true]:after:bg-secondary"}},{disableAnimation:!0,color:"success",variant:"underlined",class:{tab:"data-[selected=true]:after:bg-success"}},{disableAnimation:!0,color:"warning",variant:"underlined",class:{tab:"data-[selected=true]:after:bg-warning"}},{disableAnimation:!0,color:"danger",variant:"underlined",class:{tab:"data-[selected=true]:after:bg-danger"}}],compoundSlots:[{variant:"underlined",slots:["tab","tabList","cursor"],class:["rounded-none"]}]}),Gde=Ka({slots:{base:"relative z-[100]"},variants:{disableAnimation:{false:{base:""},true:{base:["data-[placement=bottom-right]:bottom-0 data-[placement=bottom-right]:right-0 w-full px-2 sm:w-auto sm:px-0 data-[placement=bottom-right]:fixed data-[placement=bottom-right]:flex data-[placement=bottom-right]:flex-col","data-[placement=bottom-left]:bottom-0 data-[placement=bottom-left]:left-0 w-full px-2 sm:w-auto sm:px-0 data-[placement=bottom-left]:fixed data-[placement=bottom-left]:flex data-[placement=bottom-left]:flex-col","data-[placement=bottom-center]:bottom-0 data-[placement=bottom-center]:fixed w-full px-2 sm:w-auto sm:px-0 data-[placement=bottom-center]:flex data-[placement=bottom-center]:flex-col data-[placement=bottom-center]:left-1/2 data-[placement=bottom-center]:-translate-x-1/2","data-[placement=top-right]:top-0 data-[placement=top-right]:right-0 w-full px-2 sm:w-auto sm:px-0 data-[placement=top-right]:fixed data-[placement=top-right]:flex data-[placement=top-right]:flex-col","data-[placement=top-left]:top-0 data-[placement=top-left]:left-0 w-full px-2 sm:w-auto sm:px-0 data-[placement=top-left]:fixed data-[placement=top-left]:flex data-[placement=top-left]:flex-col","data-[placement=top-center]:top-0 data-[placement=top-center]:fixed w-full px-2 sm:w-auto sm:px-0 data-[placement=top-center]:flex data-[placement=top-center]:flex-col data-[placement=top-center]:left-1/2 data-[placement=top-center]:-translate-x-1/2"]}}},defaultVariants:{disableAnimation:!1}}),CP=Ka({slots:{base:["flex gap-x-4 items-center","group","cursor-pointer","relative","z-50","box-border","outline-solid outline-transparent","p-3 sm:mx-1","my-1","w-full sm:w-[356px]","min-h-4","before:content-['']","before:absolute","before:left-0","before:right-0","data-[placement=bottom-right]:before:h-[var(--top-extension,16px)]","data-[placement=bottom-left]:before:h-[var(--top-extension,16px)]","data-[placement=bottom-center]:before:h-[var(--top-extension,16px)]","data-[placement=bottom-right]:before:top-[calc(-1*var(--top-extension,16px))]","data-[placement=bottom-left]:before:top-[calc(-1*var(--top-extension,16px))]","data-[placement=bottom-center]:before:top-[calc(-1*var(--top-extension,16px))]","before:z-[-1]","before:pointer-events-auto","before:bg-transparent","after:content-['']","after:absolute","after:left-0","after:right-0","data-[placement=bottom-right]:after:h-[var(--bottom-extension,16px)]","data-[placement=bottom-left]:after:h-[var(--bottom-extension,16px)]","data-[placement=bottom-center]:after:h-[var(--bottom-extension,16px)]","data-[placement=bottom-right]:after:bottom-[calc(-1*var(--bottom-extension,16px))]","data-[placement=bottom-left]:after:bottom-[calc(-1*var(--bottom-extension,16px))]","data-[placement=bottom-center]:after:bottom-[calc(-1*var(--bottom-extension,16px))]","after:z-[-1]","after:pointer-events-auto","after:bg-transparent","transform-gpu","will-change-transform","backface-visibility-hidden"],wrapper:["flex flex-col gap-y-0"],title:["text-sm","me-4","font-medium","text-foreground"],description:["text-sm","me-4","text-default-500"],icon:["w-6 h-6 flex-none fill-current"],loadingComponent:["w-6 h-6 flex-none fill-current"],content:["flex flex-grow flex-row gap-x-4 items-center relative"],progressTrack:["absolute inset-0 pointer-events-none bg-transparent overflow-hidden"],progressIndicator:["h-full bg-default-400 opacity-20"],motionDiv:["fixed","px-4 sm:px-0","data-[placement=bottom-right]:bottom-0 data-[placement=bottom-right]:right-0 data-[placement=bottom-right]:mx-auto w-full sm:data-[placement=bottom-right]:w-max mb-1 sm:data-[placement=bottom-right]:mr-2","data-[placement=bottom-left]:bottom-0 data-[placement=bottom-left]:left-0 data-[placement=bottom-left]:mx-auto w-full sm:data-[placement=bottom-left]:w-max mb-1 sm:data-[placement=bottom-left]:ml-2","data-[placement=bottom-center]:bottom-0 data-[placement=bottom-center]:left-0 data-[placement=bottom-center]:right-0 w-full sm:data-[placement=bottom-center]:w-max sm:data-[placement=bottom-center]:mx-auto","data-[placement=top-right]:top-0 data-[placement=top-right]:right-0 data-[placement=top-right]:mx-auto w-full sm:data-[placement=top-right]:w-max sm:data-[placement=top-right]:mr-2","data-[placement=top-left]:top-0 data-[placement=top-left]:left-0 data-[placement=top-left]:mx-auto w-full sm:data-[placement=top-left]:w-max sm:data-[placement=top-left]:ml-2","data-[placement=top-center]:top-0 data-[placement=top-center]:left-0 data-[placement=top-center]:right-0 w-full sm:data-[placement=top-center]:w-max sm:data-[placement=top-center]:mx-auto"],closeButton:["opacity-0 group-hover:opacity-100","transform-gpu","transition-all duration-200 ease-out","will-change-opacity will-change-transform","p-0 group-hover:pointer-events-auto w-6 h-6 min-w-4 absolute -right-2 -top-2 items-center justify-center bg-transparent text-default-400 hover:text-default-600 border border-3 border-transparent","data-[hidden=true]:hidden"],closeIcon:["rounded-full w-full h-full p-0.5 border border-default-400 bg-default-100"]},variants:{size:{sm:{icon:"w-5 h-5",loadingComponent:"w-5 h-5"},md:{},lg:{}},variant:{flat:"bg-content1 border border-default-100",solid:It.solid.default,bordered:"bg-background border border-default-200"},color:{default:"",foreground:{progressIndicator:"h-full opacity-20 bg-foreground-400"},primary:{progressIndicator:"h-full opacity-20 bg-primary-400"},secondary:{progressIndicator:"h-full opacity-20 bg-secondary-400"},success:{progressIndicator:"h-full opacity-20 bg-success-400"},warning:{progressIndicator:"h-full opacity-20 bg-warning-400"},danger:{progressIndicator:"h-full opacity-20 bg-danger-400"}},radius:{none:{base:"rounded-none",progressTrack:"rounded-none"},sm:{base:"rounded-small",progressTrack:"rounded-small"},md:{base:"rounded-medium",progressTrack:"rounded-medium"},lg:{base:"rounded-large",progressTrack:"rounded-large"},full:{base:"rounded-full",closeButton:"-top-px -right-px",progressTrack:"rounded-full"}},disableAnimation:{true:{closeButton:"transition-none",base:"data-[animation=exiting]:opacity-0 transition-none"},false:{closeButton:"transition-all ease-out duration-200",base:["data-[toast-exiting=true]:transform-gpu","data-[toast-exiting=true]:will-change-transform","data-[toast-exiting=true]:transition-all","data-[toast-exiting=true]:ease-out","data-[toast-exiting=true]:data-[placement=bottom-right]:translate-x-full","data-[toast-exiting=true]:data-[placement=bottom-left]:-translate-x-full","data-[toast-exiting=true]:data-[placement=bottom-center]:translate-y-full","data-[toast-exiting=true]:data-[placement=top-right]:translate-x-full","data-[toast-exiting=true]:data-[placement=top-left]:-translate-x-full","data-[toast-exiting=true]:data-[placement=top-center]:-translate-y-full","data-[toast-exiting=true]:opacity-0","data-[toast-exiting=true]:duration-300","data-[toast-exiting=true]:ease-out"]}},shadow:{none:{base:"shadow-none"},sm:{base:"shadow-small"},md:{base:"shadow-medium"},lg:{base:"shadow-large"}}},defaultVariants:{size:"md",variant:"flat",radius:"md",shadow:"sm"},compoundVariants:[{variant:"flat",color:"foreground",class:{base:"bg-foreground text-background",closeButton:"text-foreground-400 hover:text-foreground-600",closeIcon:"border border-foreground-400 bg-foreground-100",title:"text-background-600",description:"text-background-500"}},{variant:"flat",color:"primary",class:{base:"bg-primary-50 text-primary-600 border-primary-100",closeButton:"text-primary-400 hover:text-primary-600",closeIcon:"border border-primary-400 bg-primary-100",title:"text-primary-600",description:"text-primary-500"}},{variant:"flat",color:"secondary",class:{base:"bg-secondary-50 text-secondary-600 border-secondary-100",closeButton:"text-secondary-400 hover:text-secondary-600",closeIcon:"border border-secondary-400 bg-secondary-100",title:"text-secondary-600",description:"text-secondary-500"}},{variant:"flat",color:"success",class:{base:"bg-success-50 text-success-600 border-success-100",closeButton:"text-success-400 hover:text-success-600",closeIcon:"border border-success-400 bg-success-100",title:"text-success-600",description:"text-success-500"}},{variant:"flat",color:"warning",class:{base:"bg-warning-50 text-warning-600 border-warning-100",closeButton:"text-warning-400 hover:text-warning-600",closeIcon:"border border-warning-400 bg-warning-100",title:"text-warning-600",description:"text-warning-500"}},{variant:"flat",color:"danger",class:{base:"bg-danger-50 text-danger-600 border-danger-100",closeButton:"text-danger-400 hover:text-danger-600",closeIcon:"border border-danger-400 bg-danger-100",title:"text-danger-600",description:"text-danger-500"}},{variant:"bordered",color:"foreground",class:{base:"bg-foreground border-foreground-400 text-background",closeButton:"text-foreground-400 hover:text-foreground-600",closeIcon:"border border-foreground-400 bg-foreground-100",title:"text-background-600",description:"text-background-500"}},{variant:"bordered",color:"primary",class:{base:"border-primary-400 text-primary-600",closeButton:"text-primary-400 hover:text-primary-600",closeIcon:"border border-primary-400 bg-primary-100",title:"text-primary-600",description:"text-primary-500"}},{variant:"bordered",color:"secondary",class:{base:"border-secondary-400 text-secondary-600",closeButton:"text-secondary-400 hover:text-secondary-600",closeIcon:"border border-secondary-400 bg-secondary-100",title:"text-secondary-600",description:"text-secondary-500"}},{variant:"bordered",color:"success",class:{base:"border-success-400 text-success-600",closeButton:"text-success-400 hover:text-success-600",closeIcon:"border border-success-400 bg-success-100",title:"text-success-600",description:"text-success-500"}},{variant:"bordered",color:"warning",class:{base:"border-warning-400 text-warning-600",closeButton:"text-warning-400 hover:text-warning-600",closeIcon:"border border-warning-400 bg-warning-100",title:"text-warning-600",description:"text-warning-500"}},{variant:"bordered",color:"danger",class:{base:"border-danger-400 text-danger-600",closeButton:"text-danger-400 hover:text-danger-600",closeIcon:"border border-danger-400 bg-danger-100",title:"text-danger-600",description:"text-danger-500"}},{variant:"solid",color:"foreground",class:{base:It.solid.foreground,closeButton:"text-foreground-400 hover:text-foreground-600",closeIcon:"border border-foreground-400 bg-foreground-100",title:"text-background",description:"text-background"}},{variant:"solid",color:"primary",class:{base:It.solid.primary,closeButton:"text-primary-400 hover:text-primary-600",closeIcon:"border border-primary-400 bg-primary-100",title:"text-primary-foreground",description:"text-primary-foreground"}},{variant:"solid",color:"secondary",class:{base:It.solid.secondary,closeButton:"text-secondary-400 hover:text-secondary-600",closeIcon:"border border-secondary-400 bg-secondary-100",title:"text-secondary-foreground",description:"text-secondary-foreground"}},{variant:"solid",color:"success",class:{base:It.solid.success,closeButton:"text-success-400 hover:text-success-600",closeIcon:"border border-success-400 bg-success-100",title:"text-success-foreground",description:"text-success-foreground"}},{variant:"solid",color:"warning",class:{base:It.solid.warning,closeButton:"text-warning-400 hover:text-warning-600",closeIcon:"border border-warning-400 bg-warning-100",title:"text-warning-foreground",description:"text-warning-foreground"}},{variant:"solid",color:"danger",class:{base:It.solid.danger,closeButton:"text-danger-400 hover:text-danger-600",closeIcon:"border border-danger-400 bg-danger-100",title:"text-danger-foreground",description:"text-danger-foreground"}}]}),SP=Ka({slots:{base:["p-2.5","-m-2.5","overflow-x-scroll","scrollbar-hide"],wrapper:["flex","flex-nowrap","h-fit","max-w-fit","relative","gap-1","items-center","overflow-visible"],item:["tap-highlight-transparent","select-none","touch-none"],prev:"",next:"",cursor:["absolute","flex","overflow-visible","items-center","justify-center","origin-center","left-0","select-none","touch-none","pointer-events-none","z-20"],forwardIcon:["hidden","group-hover:block","group-data-[focus-visible=true]:block","data-[before=true]:rotate-180"],ellipsis:"group-hover:hidden group-data-[focus-visible=true]:hidden",chevronNext:"rotate-180"},variants:{variant:{bordered:{item:["border-medium","border-default","bg-transparent","data-[hover=true]:bg-default-100"]},light:{item:"bg-transparent"},flat:{},faded:{item:["border-medium","border-default"]}},color:{default:{cursor:It.solid.default},primary:{cursor:It.solid.primary},secondary:{cursor:It.solid.secondary},success:{cursor:It.solid.success},warning:{cursor:It.solid.warning},danger:{cursor:It.solid.danger}},size:{sm:{},md:{},lg:{}},radius:{none:{},sm:{},md:{},lg:{},full:{}},isCompact:{true:{wrapper:"gap-0 shadow-xs",item:["shadow-none","first-of-type:rounded-e-none","last-of-type:rounded-s-none","[&:not(:first-of-type):not(:last-of-type)]:rounded-none"],prev:"!rounded-e-none",next:"!rounded-s-none"}},isDisabled:{true:{base:"opacity-disabled pointer-events-none"}},showShadow:{true:{}},disableCursorAnimation:{true:{cursor:"hidden"}},disableAnimation:{true:{item:"transition-none",cursor:"transition-none"},false:{item:["data-[pressed=true]:scale-[0.97]","transition-transform-background"],cursor:["data-[moving=true]:transition-transform","!data-[moving=true]:duration-300","opacity-0","data-[moving]:opacity-100"]}}},defaultVariants:{variant:"flat",color:"primary",size:"md",radius:"md",isCompact:!1,isDisabled:!1,showShadow:!1,disableCursorAnimation:!1},compoundVariants:[{showShadow:!0,color:"default",class:{cursor:[It.shadow.default,"shadow-md"]}},{showShadow:!0,color:"primary",class:{cursor:[It.shadow.primary,"shadow-md"]}},{showShadow:!0,color:"secondary",class:{cursor:[It.shadow.secondary,"shadow-md"]}},{showShadow:!0,color:"success",class:{cursor:[It.shadow.success,"shadow-md"]}},{showShadow:!0,color:"warning",class:{cursor:[It.shadow.warning,"shadow-md"]}},{showShadow:!0,color:"danger",class:{cursor:[It.shadow.danger,"shadow-md"]}},{isCompact:!0,variant:"bordered",class:{item:"[&:not(:first-of-type)]:ms-[calc(theme(borderWidth.2)*-1)]"}},{disableCursorAnimation:!0,color:"default",class:{item:["data-[active=true]:bg-default-400","data-[active=true]:border-default-400","data-[active=true]:text-default-foreground"]}},{disableCursorAnimation:!0,color:"primary",class:{item:["data-[active=true]:bg-primary","data-[active=true]:border-primary","data-[active=true]:text-primary-foreground"]}},{disableCursorAnimation:!0,color:"secondary",class:{item:["data-[active=true]:bg-secondary","data-[active=true]:border-secondary","data-[active=true]:text-secondary-foreground"]}},{disableCursorAnimation:!0,color:"success",class:{item:["data-[active=true]:bg-success","data-[active=true]:border-success","data-[active=true]:text-success-foreground"]}},{disableCursorAnimation:!0,color:"warning",class:{item:["data-[active=true]:bg-warning","data-[active=true]:border-warning","data-[active=true]:text-warning-foreground"]}},{disableCursorAnimation:!0,color:"danger",class:{item:["data-[active=true]:bg-danger","data-[active=true]:border-danger","data-[active=true]:text-danger-foreground"]}},{disableCursorAnimation:!0,showShadow:!0,color:"default",class:{item:["data-[active=true]:shadow-md","data-[active=true]:shadow-default/50"]}},{disableCursorAnimation:!0,showShadow:!0,color:"primary",class:{item:["data-[active=true]:shadow-md","data-[active=true]:shadow-primary/40"]}},{disableCursorAnimation:!0,showShadow:!0,color:"secondary",class:{item:["data-[active=true]:shadow-md","data-[active=true]:shadow-secondary/40"]}},{disableCursorAnimation:!0,showShadow:!0,color:"success",class:{item:["data-[active=true]:shadow-md","data-[active=true]:shadow-success/40"]}},{disableCursorAnimation:!0,showShadow:!0,color:"warning",class:{item:["data-[active=true]:shadow-md","data-[active=true]:shadow-warning/40"]}},{disableCursorAnimation:!0,showShadow:!0,color:"danger",class:{item:["data-[active=true]:shadow-md","data-[active=true]:shadow-danger/40"]}}],compoundSlots:[{slots:["item","prev","next"],class:["flex","flex-wrap","truncate","box-border","outline-solid outline-transparent","items-center","justify-center","text-default-foreground",...pu,"data-[disabled=true]:text-default-300","data-[disabled=true]:pointer-events-none"]},{slots:["item","prev","next"],variant:["flat","bordered","faded"],class:["shadow-xs"]},{slots:["item","prev","next"],variant:"flat",class:["bg-default-100","[&[data-hover=true]:not([data-active=true])]:bg-default-200","active:bg-default-300"]},{slots:["item","prev","next"],variant:"faded",class:["bg-default-50","[&[data-hover=true]:not([data-active=true])]:bg-default-100","active:bg-default-200"]},{slots:["item","prev","next"],variant:"light",class:["[&[data-hover=true]:not([data-active=true])]:bg-default-100","active:bg-default-200"]},{slots:["item","cursor","prev","next"],size:"sm",class:"min-w-8 w-8 h-8 text-tiny"},{slots:["item","cursor","prev","next"],size:"md",class:"min-w-9 w-9 h-9 text-small"},{slots:["item","cursor","prev","next"],size:"lg",class:"min-w-10 w-10 h-10 text-medium"},{slots:["wrapper","item","cursor","prev","next"],radius:"none",class:"rounded-none"},{slots:["wrapper","item","cursor","prev","next"],radius:"sm",class:"rounded-small"},{slots:["wrapper","item","cursor","prev","next"],radius:"md",class:"rounded-medium"},{slots:["wrapper","item","cursor","prev","next"],radius:"lg",class:"rounded-large"},{slots:["wrapper","item","cursor","prev","next"],radius:"full",class:"rounded-full"}]}),TP=Ka({slots:{base:["z-0","relative","bg-transparent","before:content-['']","before:hidden","before:z-[-1]","before:absolute","before:rotate-45","before:w-2.5","before:h-2.5","before:rounded-sm","data-[arrow=true]:before:block","data-[placement=top]:before:-bottom-[calc(theme(spacing.5)/4_-_1.5px)]","data-[placement=top]:before:left-1/2","data-[placement=top]:before:-translate-x-1/2","data-[placement=top-start]:before:-bottom-[calc(theme(spacing.5)/4_-_1.5px)]","data-[placement=top-start]:before:left-3","data-[placement=top-end]:before:-bottom-[calc(theme(spacing.5)/4_-_1.5px)]","data-[placement=top-end]:before:right-3","data-[placement=bottom]:before:-top-[calc(theme(spacing.5)/4_-_1.5px)]","data-[placement=bottom]:before:left-1/2","data-[placement=bottom]:before:-translate-x-1/2","data-[placement=bottom-start]:before:-top-[calc(theme(spacing.5)/4_-_1.5px)]","data-[placement=bottom-start]:before:left-3","data-[placement=bottom-end]:before:-top-[calc(theme(spacing.5)/4_-_1.5px)]","data-[placement=bottom-end]:before:right-3","data-[placement=left]:before:-right-[calc(theme(spacing.5)/4_-_2px)]","data-[placement=left]:before:top-1/2","data-[placement=left]:before:-translate-y-1/2","data-[placement=left-start]:before:-right-[calc(theme(spacing.5)/4_-_3px)]","data-[placement=left-start]:before:top-1/4","data-[placement=left-end]:before:-right-[calc(theme(spacing.5)/4_-_3px)]","data-[placement=left-end]:before:bottom-1/4","data-[placement=right]:before:-left-[calc(theme(spacing.5)/4_-_2px)]","data-[placement=right]:before:top-1/2","data-[placement=right]:before:-translate-y-1/2","data-[placement=right-start]:before:-left-[calc(theme(spacing.5)/4_-_3px)]","data-[placement=right-start]:before:top-1/4","data-[placement=right-end]:before:-left-[calc(theme(spacing.5)/4_-_3px)]","data-[placement=right-end]:before:bottom-1/4",...pu],content:["z-10","px-2.5","py-1","w-full","inline-flex","flex-col","items-center","justify-center","box-border","subpixel-antialiased","outline-solid outline-transparent","box-border"],trigger:["z-10"],backdrop:["hidden"],arrow:[]},variants:{size:{sm:{content:"text-tiny"},md:{content:"text-small"},lg:{content:"text-medium"}},color:{default:{base:"before:bg-content1 before:shadow-small",content:"bg-content1"},foreground:{base:"before:bg-foreground",content:It.solid.foreground},primary:{base:"before:bg-primary",content:It.solid.primary},secondary:{base:"before:bg-secondary",content:It.solid.secondary},success:{base:"before:bg-success",content:It.solid.success},warning:{base:"before:bg-warning",content:It.solid.warning},danger:{base:"before:bg-danger",content:It.solid.danger}},radius:{none:{content:"rounded-none"},sm:{content:"rounded-small"},md:{content:"rounded-medium"},lg:{content:"rounded-large"},full:{content:"rounded-full"}},shadow:{none:{content:"shadow-none"},sm:{content:"shadow-small"},md:{content:"shadow-medium"},lg:{content:"shadow-large"}},backdrop:{transparent:{},opaque:{backdrop:"bg-overlay/50 backdrop-opacity-disabled"},blur:{backdrop:"backdrop-blur-sm backdrop-saturate-150 bg-overlay/30"}},triggerScaleOnOpen:{true:{trigger:["aria-expanded:scale-[0.97]","aria-expanded:opacity-70","subpixel-antialiased"]},false:{}},disableAnimation:{true:{base:"animate-none"}},isTriggerDisabled:{true:{trigger:"opacity-disabled pointer-events-none"},false:{}}},defaultVariants:{color:"default",radius:"lg",size:"md",shadow:"md",backdrop:"transparent",triggerScaleOnOpen:!0},compoundVariants:[{backdrop:["opaque","blur"],class:{backdrop:"block w-full h-full fixed inset-0 -z-30"}}]}),jde=["data-[top-scroll=true]:[mask-image:linear-gradient(0deg,#000_calc(100%_-_var(--scroll-shadow-size)),transparent)]","data-[bottom-scroll=true]:[mask-image:linear-gradient(180deg,#000_calc(100%_-_var(--scroll-shadow-size)),transparent)]","data-[top-bottom-scroll=true]:[mask-image:linear-gradient(#000,#000,transparent_0,#000_var(--scroll-shadow-size),#000_calc(100%_-_var(--scroll-shadow-size)),transparent)]"],zde=["data-[left-scroll=true]:[mask-image:linear-gradient(270deg,#000_calc(100%_-_var(--scroll-shadow-size)),transparent)]","data-[right-scroll=true]:[mask-image:linear-gradient(90deg,#000_calc(100%_-_var(--scroll-shadow-size)),transparent)]","data-[left-right-scroll=true]:[mask-image:linear-gradient(to_right,#000,#000,transparent_0,#000_var(--scroll-shadow-size),#000_calc(100%_-_var(--scroll-shadow-size)),transparent)]"],Hb=Ka({base:[],variants:{orientation:{vertical:["overflow-y-auto",...jde],horizontal:["overflow-x-auto",...zde]},hideScrollBar:{true:"scrollbar-hide",false:""}},defaultVariants:{orientation:"vertical",hideScrollBar:!1}}),EP=Ka({slots:{base:["group inline-flex flex-col relative"],label:["block","absolute","z-10","origin-top-left","flex-shrink-0","rtl:origin-top-right","subpixel-antialiased","text-small","text-foreground-500","pointer-events-none","group-data-[has-label-outside=true]:pointer-events-auto"],mainWrapper:"w-full flex flex-col",trigger:"relative px-3 gap-3 w-full inline-flex flex-row items-center shadow-xs outline-solid outline-transparent tap-highlight-transparent",innerWrapper:"inline-flex h-fit w-[calc(100%_-theme(spacing.6))] min-h-4 items-center gap-1.5 box-border",selectorIcon:"absolute end-3 w-4 h-4",spinner:"absolute end-3",value:["text-foreground-500","font-normal","w-full","text-start"],listboxWrapper:"scroll-py-6 w-full",listbox:"",popoverContent:"w-full p-1 overflow-hidden",clearButton:["w-4","h-4","z-10","mb-4","relative","start-auto","appearance-none","outline-none","select-none","opacity-70","hover:!opacity-100","cursor-pointer","active:!opacity-70","rounded-full",...pu],helperWrapper:"p-1 flex relative flex-col gap-1.5 group-data-[has-helper=true]:flex",description:"text-tiny text-foreground-400",errorMessage:"text-tiny text-danger",endWrapper:"flex end-18",endContent:"mb-4"},variants:{variant:{flat:{trigger:["bg-default-100","data-[hover=true]:bg-default-200","group-data-[focus=true]:bg-default-200"],clearButton:"mb-4"},faded:{trigger:["bg-default-100","border-medium","border-default-200","data-[hover=true]:border-default-400 data-[focus=true]:border-default-400 data-[open=true]:border-default-400"],value:"group-data-[has-value=true]:text-default-foreground",clearButton:"mb-4"},bordered:{trigger:["border-medium","border-default-200","data-[hover=true]:border-default-400","data-[open=true]:border-default-foreground","data-[focus=true]:border-default-foreground"],value:"group-data-[has-value=true]:text-default-foreground",clearButton:"mb-4"},underlined:{trigger:["!px-1","!pb-0","!gap-0","relative","box-border","border-b-medium","shadow-[0_1px_0px_0_rgba(0,0,0,0.05)]","border-default-200","!rounded-none","hover:border-default-300","after:content-['']","after:w-0","after:origin-center","after:bg-default-foreground","after:absolute","after:left-1/2","after:-translate-x-1/2","after:-bottom-[2px]","after:h-[2px]","data-[open=true]:after:w-full","data-[focus=true]:after:w-full"],value:"group-data-[has-value=true]:text-default-foreground",clearButton:"mb-4 me-2"}},color:{default:{},primary:{selectorIcon:"text-primary"},secondary:{selectorIcon:"text-secondary"},success:{selectorIcon:"text-success"},warning:{selectorIcon:"text-warning"},danger:{selectorIcon:"text-danger"}},size:{sm:{label:"text-tiny",trigger:"h-8 min-h-8 px-2 rounded-small",value:"text-small",clearButton:"text-medium"},md:{trigger:"h-10 min-h-10 rounded-medium",value:"text-small",clearButton:"text-large"},lg:{trigger:"h-12 min-h-12 rounded-large",value:"text-medium",clearButton:"mb-5 text-large"}},radius:{none:{trigger:"rounded-none"},sm:{trigger:"rounded-small"},md:{trigger:"rounded-medium"},lg:{trigger:"rounded-large"},full:{trigger:"rounded-full"}},labelPlacement:{outside:{base:"flex flex-col",clearButton:"mb-0"},"outside-left":{base:"flex-row items-center flex-nowrap data-[has-helper=true]:items-start",label:"relative pe-2 text-foreground",clearButton:"mb-0"},inside:{label:"text-tiny cursor-pointer",trigger:"flex-col items-start justify-center gap-0"}},fullWidth:{true:{base:"w-full"},false:{base:"min-w-40"}},isClearable:{true:{clearButton:"peer-data-[filled=true]:opacity-70 peer-data-[filled=true]:block",endContent:"ms-3"}},isDisabled:{true:{base:"opacity-disabled pointer-events-none",trigger:"pointer-events-none"}},isInvalid:{true:{label:"!text-danger",value:"!text-danger",selectorIcon:"text-danger"}},isRequired:{true:{label:"after:content-['*'] after:text-danger after:ms-0.5"}},isMultiline:{true:{label:"relative",trigger:"!h-auto"},false:{value:"truncate"}},disableAnimation:{true:{trigger:"after:transition-none",base:"transition-none",label:"transition-none",selectorIcon:"transition-none"},false:{base:"transition-background motion-reduce:transition-none !duration-150",label:["will-change-auto","origin-top-left","rtl:origin-top-right","!duration-200","!ease-out","transition-[transform,color,left,opacity,translate,scale]","motion-reduce:transition-none"],selectorIcon:"transition-transform duration-150 ease motion-reduce:transition-none",clearButton:["transition-opacity","motion-reduce:transition-none"]}},disableSelectorIconRotation:{true:{},false:{selectorIcon:"data-[open=true]:rotate-180"}}},defaultVariants:{variant:"flat",color:"default",size:"md",fullWidth:!0,isDisabled:!1,isMultiline:!1,disableSelectorIconRotation:!1},compoundVariants:[{variant:"flat",color:"default",class:{value:"group-data-[has-value=true]:text-default-foreground",trigger:["bg-default-100","data-[hover=true]:bg-default-200"]}},{variant:"flat",color:"primary",class:{trigger:["bg-primary-100","text-primary","data-[hover=true]:bg-primary-50","group-data-[focus=true]:bg-primary-50"],value:"text-primary",label:"text-primary"}},{variant:"flat",color:"secondary",class:{trigger:["bg-secondary-100","text-secondary","data-[hover=true]:bg-secondary-50","group-data-[focus=true]:bg-secondary-50"],value:"text-secondary",label:"text-secondary"}},{variant:"flat",color:"success",class:{trigger:["bg-success-100","text-success-600","dark:text-success","data-[hover=true]:bg-success-50","group-data-[focus=true]:bg-success-50"],value:"text-success-600 dark:text-success",label:"text-success-600 dark:text-success"}},{variant:"flat",color:"warning",class:{trigger:["bg-warning-100","text-warning-600","dark:text-warning","data-[hover=true]:bg-warning-50","group-data-[focus=true]:bg-warning-50"],value:"text-warning-600 dark:text-warning",label:"text-warning-600 dark:text-warning"}},{variant:"flat",color:"danger",class:{trigger:["bg-danger-100","text-danger","dark:text-danger-500","data-[hover=true]:bg-danger-50","group-data-[focus=true]:bg-danger-50"],value:"text-danger dark:text-danger-500",label:"text-danger dark:text-danger-500"}},{variant:"faded",color:"primary",class:{trigger:"data-[hover=true]:border-primary data-[focus=true]:border-primary data-[open=true]:border-primary",label:"text-primary"}},{variant:"faded",color:"secondary",class:{trigger:"data-[hover=true]:border-secondary data-[focus=true]:border-secondary data-[open=true]:border-secondary",label:"text-secondary"}},{variant:"faded",color:"success",class:{trigger:"data-[hover=true]:border-success data-[focus=true]:border-success data-[open=true]:border-success",label:"text-success"}},{variant:"faded",color:"warning",class:{trigger:"data-[hover=true]:border-warning data-[focus=true]:border-warning data-[open=true]:border-warning",label:"text-warning"}},{variant:"faded",color:"danger",class:{trigger:"data-[hover=true]:border-danger data-[focus=true]:border-danger data-[open=true]:border-danger",label:"text-danger"}},{variant:"underlined",color:"default",class:{value:"group-data-[has-value=true]:text-foreground"}},{variant:"underlined",color:"primary",class:{trigger:"after:bg-primary",label:"text-primary"}},{variant:"underlined",color:"secondary",class:{trigger:"after:bg-secondary",label:"text-secondary"}},{variant:"underlined",color:"success",class:{trigger:"after:bg-success",label:"text-success"}},{variant:"underlined",color:"warning",class:{trigger:"after:bg-warning",label:"text-warning"}},{variant:"underlined",color:"danger",class:{trigger:"after:bg-danger",label:"text-danger"}},{variant:"bordered",color:"primary",class:{trigger:["data-[open=true]:border-primary","data-[focus=true]:border-primary"],label:"text-primary"}},{variant:"bordered",color:"secondary",class:{trigger:["data-[open=true]:border-secondary","data-[focus=true]:border-secondary"],label:"text-secondary"}},{variant:"bordered",color:"success",class:{trigger:["data-[open=true]:border-success","data-[focus=true]:border-success"],label:"text-success"}},{variant:"bordered",color:"warning",class:{trigger:["data-[open=true]:border-warning","data-[focus=true]:border-warning"],label:"text-warning"}},{variant:"bordered",color:"danger",class:{trigger:["data-[open=true]:border-danger","data-[focus=true]:border-danger"],label:"text-danger"}},{labelPlacement:"inside",color:"default",class:{label:"group-data-[filled=true]:text-default-600"}},{labelPlacement:"outside",color:"default",class:{label:"group-data-[filled=true]:text-foreground"}},{radius:"full",size:["sm"],class:{trigger:"px-3"}},{radius:"full",size:"md",class:{trigger:"px-4"}},{radius:"full",size:"lg",class:{trigger:"px-5"}},{disableAnimation:!1,variant:["faded","bordered"],class:{trigger:"transition-colors motion-reduce:transition-none"}},{disableAnimation:!1,variant:"underlined",class:{trigger:"after:transition-width motion-reduce:after:transition-none"}},{variant:["flat","faded"],class:{trigger:[...pu]}},{isInvalid:!0,variant:"flat",class:{trigger:["bg-danger-50","data-[hover=true]:bg-danger-100","group-data-[focus=true]:bg-danger-50"]}},{isInvalid:!0,variant:"bordered",class:{trigger:"!border-danger group-data-[focus=true]:border-danger"}},{isInvalid:!0,variant:"underlined",class:{trigger:"after:bg-danger"}},{labelPlacement:"inside",size:"sm",class:{trigger:"h-12 min-h-12 py-1.5 px-3"}},{labelPlacement:"inside",size:"md",class:{trigger:"h-14 min-h-14 py-2"}},{labelPlacement:"inside",size:"lg",class:{label:"text-medium",trigger:"h-16 min-h-16 py-2.5 gap-0"}},{labelPlacement:"outside",isMultiline:!1,class:{base:"group relative justify-end",label:["pb-0","z-20","top-1/2","-translate-y-1/2","group-data-[filled=true]:start-0"]}},{labelPlacement:["inside"],class:{label:"group-data-[filled=true]:scale-85"}},{labelPlacement:"inside",size:["sm","md"],class:{label:"text-small"}},{labelPlacement:"inside",isMultiline:!1,size:"sm",class:{label:["group-data-[filled=true]:-translate-y-[calc(50%_+_var(--heroui-font-size-tiny)/2_-_8px)]"],innerWrapper:"group-data-[has-label=true]:pt-4"}},{labelPlacement:"inside",isMultiline:!1,size:"md",class:{label:["group-data-[filled=true]:-translate-y-[calc(50%_+_var(--heroui-font-size-small)/2_-_6px)]"],innerWrapper:"group-data-[has-label=true]:pt-4"}},{labelPlacement:"inside",isMultiline:!1,size:"lg",class:{label:["text-medium","group-data-[filled=true]:-translate-y-[calc(50%_+_var(--heroui-font-size-small)/2_-_8px)]"],innerWrapper:"group-data-[has-label=true]:pt-5"}},{labelPlacement:"inside",variant:["faded","bordered"],isMultiline:!1,size:"sm",class:{label:["group-data-[filled=true]:-translate-y-[calc(50%_+_var(--heroui-font-size-tiny)/2_-_8px_-_var(--heroui-border-width-medium))]"]}},{labelPlacement:"inside",variant:["faded","bordered"],isMultiline:!1,size:"md",class:{label:["group-data-[filled=true]:-translate-y-[calc(50%_+_var(--heroui-font-size-small)/2_-_6px_-_var(--heroui-border-width-medium))]"]}},{labelPlacement:"inside",variant:["faded","bordered"],isMultiline:!1,size:"lg",class:{label:["text-medium","group-data-[filled=true]:-translate-y-[calc(50%_+_var(--heroui-font-size-small)/2_-_8px_-_var(--heroui-border-width-medium))]"]}},{labelPlacement:"inside",variant:"underlined",isMultiline:!1,size:"sm",class:{label:["group-data-[filled=true]:-translate-y-[calc(50%_+_var(--heroui-font-size-tiny)/2_-_5px)]"]}},{labelPlacement:"inside",variant:"underlined",isMultiline:!1,size:"md",class:{label:["group-data-[filled=true]:-translate-y-[calc(50%_+_var(--heroui-font-size-small)/2_-_3.5px)]"]}},{labelPlacement:"inside",variant:"underlined",isMultiline:!1,size:"lg",class:{label:["text-medium","group-data-[filled=true]:-translate-y-[calc(50%_+_var(--heroui-font-size-small)/2_-_4px)]"]}},{labelPlacement:"outside",size:"sm",isMultiline:!1,class:{label:["start-2","text-tiny","group-data-[filled=true]:-translate-y-[calc(100%_+var(--heroui-font-size-tiny)/2_+_16px)]","group-data-[has-helper=true]:-translate-y-[calc(100%_+_var(--heroui-font-size-small)/2_+_26px)]"],base:"data-[has-label=true]:mt-[calc(var(--heroui-font-size-small)_+_8px)]"}},{labelPlacement:"outside",isMultiline:!1,size:"md",class:{label:["start-3","text-small","group-data-[filled=true]:-translate-y-[calc(100%_+_var(--heroui-font-size-small)/2_+_20px)]","group-data-[has-helper=true]:-translate-y-[calc(100%_+_var(--heroui-font-size-small)/2_+_30px)]"],base:"data-[has-label=true]:mt-[calc(var(--heroui-font-size-small)_+_10px)]"}},{labelPlacement:"outside",isMultiline:!1,size:"lg",class:{label:["start-3","text-medium","group-data-[filled=true]:-translate-y-[calc(100%_+_var(--heroui-font-size-small)/2_+_24px)]","group-data-[has-helper=true]:-translate-y-[calc(100%_+_var(--heroui-font-size-small)/2_+_34px)]"],base:"data-[has-label=true]:mt-[calc(var(--heroui-font-size-small)_+_12px)]"}},{labelPlacement:"outside-left",size:"sm",class:{label:"group-data-[has-helper=true]:pt-2"}},{labelPlacement:"outside-left",size:"md",class:{label:"group-data-[has-helper=true]:pt-3"}},{labelPlacement:"outside-left",size:"lg",class:{label:"group-data-[has-helper=true]:pt-4"}},{labelPlacement:"outside",isMultiline:!0,class:{label:"pb-1.5"}},{labelPlacement:["inside","outside"],class:{label:["pe-2","max-w-full","text-ellipsis","overflow-hidden"]}},{labelPlacement:["outside","outside-left"],isClearable:!0,class:{endContent:["mt-4"],clearButton:["group-data-[has-end-content=true]:mt-4"]}},{isClearable:!1,labelPlacement:["outside","outside-left"],class:{endContent:["mt-4"]}},{isClearable:!0,variant:["underlined"],class:{clearButton:["relative group-data-[has-end-content=true]:left-2"],endContent:["me-2"]}},{isClearable:!1,variant:["underlined"],class:{endContent:["me-2"]}},{isClearable:!0,size:"sm",class:{endContent:"ms-2"}}]}),_P=Ka({slots:{base:"group flex flex-col data-[hidden=true]:hidden",label:["absolute","z-10","pointer-events-none","origin-top-left","shrink-0","rtl:origin-top-right","subpixel-antialiased","block","text-small","text-foreground-500"],mainWrapper:"h-full",inputWrapper:"relative w-full inline-flex tap-highlight-transparent flex-row items-center shadow-xs px-3 gap-3",innerWrapper:"inline-flex w-full items-center h-full box-border",input:["w-full font-normal bg-transparent !outline-solid outline-transparent placeholder:text-foreground-500 focus-visible:outline-solid outline-transparent","data-[has-start-content=true]:ps-1.5","data-[has-end-content=true]:pe-1.5","data-[type=color]:rounded-none","file:cursor-pointer file:bg-transparent file:border-0","autofill:bg-transparent bg-clip-text"],clearButton:["p-2","-m-2","z-10","absolute","end-3","start-auto","pointer-events-none","appearance-none","outline-solid outline-transparent","select-none","opacity-0","cursor-pointer","active:!opacity-70","rounded-full",...pu],helperWrapper:"hidden group-data-[has-helper=true]:flex p-1 relative flex-col gap-1.5",description:"text-tiny text-foreground-400",errorMessage:"text-tiny text-danger"},variants:{variant:{flat:{inputWrapper:["bg-default-100","data-[hover=true]:bg-default-200","group-data-[focus=true]:bg-default-100"]},faded:{inputWrapper:["bg-default-100","border-medium","border-default-200","data-[hover=true]:border-default-400 focus-within:border-default-400"],value:"group-data-[has-value=true]:text-default-foreground"},bordered:{inputWrapper:["border-medium","border-default-200","data-[hover=true]:border-default-400","group-data-[focus=true]:border-default-foreground"]},underlined:{inputWrapper:["!px-1","!pb-0","!gap-0","relative","box-border","border-b-medium","shadow-[0_1px_0px_0_rgba(0,0,0,0.05)]","border-default-200","!rounded-none","hover:border-default-300","after:content-['']","after:w-0","after:origin-center","after:bg-default-foreground","after:absolute","after:left-1/2","after:-translate-x-1/2","after:-bottom-[2px]","after:h-[2px]","group-data-[focus=true]:after:w-full"],innerWrapper:"pb-1",label:"group-data-[filled-within=true]:text-foreground"}},color:{default:{},primary:{},secondary:{},success:{},warning:{},danger:{}},size:{sm:{label:"text-tiny",inputWrapper:"h-8 min-h-8 px-2 rounded-small",input:"text-small",clearButton:"text-medium"},md:{inputWrapper:"h-10 min-h-10 rounded-medium",input:"text-small",clearButton:"text-large hover:!opacity-100"},lg:{label:"text-medium",inputWrapper:"h-12 min-h-12 rounded-large",input:"text-medium",clearButton:"text-large hover:!opacity-100"}},radius:{none:{inputWrapper:"rounded-none"},sm:{inputWrapper:"rounded-small"},md:{inputWrapper:"rounded-medium"},lg:{inputWrapper:"rounded-large"},full:{inputWrapper:"rounded-full"}},labelPlacement:{outside:{mainWrapper:"flex flex-col"},"outside-left":{base:"flex-row items-center flex-nowrap data-[has-helper=true]:items-start",inputWrapper:"flex-1",mainWrapper:"flex flex-col",label:"relative text-foreground pe-2 ps-2 pointer-events-auto"},"outside-top":{mainWrapper:"flex flex-col",label:"relative text-foreground pb-2 pointer-events-auto"},inside:{label:"cursor-text",inputWrapper:"flex-col items-start justify-center gap-0",innerWrapper:"group-data-[has-label=true]:items-end"}},fullWidth:{true:{base:"w-full"},false:{}},isClearable:{true:{input:"peer pe-6 input-search-cancel-button-none",clearButton:["peer-data-[filled=true]:pointer-events-auto","peer-data-[filled=true]:opacity-70 peer-data-[filled=true]:block","peer-data-[filled=true]:scale-100"]}},isDisabled:{true:{base:"opacity-disabled pointer-events-none",inputWrapper:"pointer-events-none",label:"pointer-events-none"}},isInvalid:{true:{label:"!text-danger",input:"!placeholder:text-danger !text-danger"}},isRequired:{true:{label:"after:content-['*'] after:text-danger after:ms-0.5"}},isMultiline:{true:{label:"relative",inputWrapper:"!h-auto",innerWrapper:"items-start group-data-[has-label=true]:items-start",input:"resize-none data-[hide-scroll=true]:scrollbar-hide",clearButton:"absolute top-2 right-2 rtl:right-auto rtl:left-2 z-10"}},disableAnimation:{true:{input:"transition-none",inputWrapper:"transition-none",label:"transition-none"},false:{inputWrapper:"transition-background motion-reduce:transition-none !duration-150",label:["will-change-auto","!duration-200","!ease-out","motion-reduce:transition-none","transition-[transform,color,left,opacity,translate,scale]"],clearButton:["scale-90","ease-out","duration-150","transition-[opacity,transform]","motion-reduce:transition-none","motion-reduce:scale-100"]}}},defaultVariants:{variant:"flat",color:"default",size:"md",fullWidth:!0,isDisabled:!1,isMultiline:!1},compoundVariants:[{variant:"flat",color:"default",class:{input:"group-data-[has-value=true]:text-default-foreground"}},{variant:"flat",color:"primary",class:{inputWrapper:["bg-primary-100","data-[hover=true]:bg-primary-50","text-primary","group-data-[focus=true]:bg-primary-50","placeholder:text-primary"],input:"placeholder:text-primary",label:"text-primary"}},{variant:"flat",color:"secondary",class:{inputWrapper:["bg-secondary-100","text-secondary","data-[hover=true]:bg-secondary-50","group-data-[focus=true]:bg-secondary-50","placeholder:text-secondary"],input:"placeholder:text-secondary",label:"text-secondary"}},{variant:"flat",color:"success",class:{inputWrapper:["bg-success-100","text-success-600","dark:text-success","placeholder:text-success-600","dark:placeholder:text-success","data-[hover=true]:bg-success-50","group-data-[focus=true]:bg-success-50"],input:"placeholder:text-success-600 dark:placeholder:text-success",label:"text-success-600 dark:text-success"}},{variant:"flat",color:"warning",class:{inputWrapper:["bg-warning-100","text-warning-600","dark:text-warning","placeholder:text-warning-600","dark:placeholder:text-warning","data-[hover=true]:bg-warning-50","group-data-[focus=true]:bg-warning-50"],input:"placeholder:text-warning-600 dark:placeholder:text-warning",label:"text-warning-600 dark:text-warning"}},{variant:"flat",color:"danger",class:{inputWrapper:["bg-danger-100","text-danger","dark:text-danger-500","placeholder:text-danger","dark:placeholder:text-danger-500","data-[hover=true]:bg-danger-50","group-data-[focus=true]:bg-danger-50"],input:"placeholder:text-danger dark:placeholder:text-danger-500",label:"text-danger dark:text-danger-500"}},{variant:"faded",color:"primary",class:{label:"text-primary",inputWrapper:"data-[hover=true]:border-primary focus-within:border-primary"}},{variant:"faded",color:"secondary",class:{label:"text-secondary",inputWrapper:"data-[hover=true]:border-secondary focus-within:border-secondary"}},{variant:"faded",color:"success",class:{label:"text-success",inputWrapper:"data-[hover=true]:border-success focus-within:border-success"}},{variant:"faded",color:"warning",class:{label:"text-warning",inputWrapper:"data-[hover=true]:border-warning focus-within:border-warning"}},{variant:"faded",color:"danger",class:{label:"text-danger",inputWrapper:"data-[hover=true]:border-danger focus-within:border-danger"}},{variant:"underlined",color:"default",class:{input:"group-data-[has-value=true]:text-foreground"}},{variant:"underlined",color:"primary",class:{inputWrapper:"after:bg-primary",label:"text-primary"}},{variant:"underlined",color:"secondary",class:{inputWrapper:"after:bg-secondary",label:"text-secondary"}},{variant:"underlined",color:"success",class:{inputWrapper:"after:bg-success",label:"text-success"}},{variant:"underlined",color:"warning",class:{inputWrapper:"after:bg-warning",label:"text-warning"}},{variant:"underlined",color:"danger",class:{inputWrapper:"after:bg-danger",label:"text-danger"}},{variant:"bordered",color:"primary",class:{inputWrapper:"group-data-[focus=true]:border-primary",label:"text-primary"}},{variant:"bordered",color:"secondary",class:{inputWrapper:"group-data-[focus=true]:border-secondary",label:"text-secondary"}},{variant:"bordered",color:"success",class:{inputWrapper:"group-data-[focus=true]:border-success",label:"text-success"}},{variant:"bordered",color:"warning",class:{inputWrapper:"group-data-[focus=true]:border-warning",label:"text-warning"}},{variant:"bordered",color:"danger",class:{inputWrapper:"group-data-[focus=true]:border-danger",label:"text-danger"}},{labelPlacement:"inside",color:"default",class:{label:"group-data-[filled-within=true]:text-default-600"}},{labelPlacement:"outside",color:"default",class:{label:"group-data-[filled-within=true]:text-foreground"}},{radius:"full",size:["sm"],class:{inputWrapper:"px-3"}},{radius:"full",size:"md",class:{inputWrapper:"px-4"}},{radius:"full",size:"lg",class:{inputWrapper:"px-5"}},{disableAnimation:!1,variant:["faded","bordered"],class:{inputWrapper:"transition-colors motion-reduce:transition-none"}},{disableAnimation:!1,variant:"underlined",class:{inputWrapper:"after:transition-width motion-reduce:after:transition-none"}},{variant:["flat","faded"],class:{inputWrapper:[...Bde]}},{isInvalid:!0,variant:"flat",class:{inputWrapper:["!bg-danger-50","data-[hover=true]:!bg-danger-100","group-data-[focus=true]:!bg-danger-50"]}},{isInvalid:!0,variant:"bordered",class:{inputWrapper:"!border-danger group-data-[focus=true]:!border-danger"}},{isInvalid:!0,variant:"underlined",class:{inputWrapper:"after:!bg-danger"}},{labelPlacement:"inside",size:"sm",class:{inputWrapper:"h-12 py-1.5 px-3"}},{labelPlacement:"inside",size:"md",class:{inputWrapper:"h-14 py-2"}},{labelPlacement:"inside",size:"lg",class:{inputWrapper:"h-16 py-2.5 gap-0"}},{labelPlacement:"inside",size:"sm",variant:["bordered","faded"],class:{inputWrapper:"py-1"}},{labelPlacement:["inside","outside"],class:{label:["group-data-[filled-within=true]:pointer-events-auto"]}},{labelPlacement:"outside",isMultiline:!1,class:{base:"relative justify-end",label:["pb-0","z-20","top-1/2","-translate-y-1/2","group-data-[filled-within=true]:start-0"]}},{labelPlacement:["inside"],class:{label:["group-data-[filled-within=true]:scale-85"]}},{labelPlacement:["inside"],variant:"flat",class:{innerWrapper:"pb-0.5"}},{variant:"underlined",size:"sm",class:{innerWrapper:"pb-1"}},{variant:"underlined",size:["md","lg"],class:{innerWrapper:"pb-1.5"}},{labelPlacement:"inside",size:["sm","md"],class:{label:"text-small"}},{labelPlacement:"inside",isMultiline:!1,size:"sm",class:{label:["group-data-[filled-within=true]:-translate-y-[calc(50%_+_var(--heroui-font-size-tiny)/2_-_8px)]"]}},{labelPlacement:"inside",isMultiline:!1,size:"md",class:{label:["group-data-[filled-within=true]:-translate-y-[calc(50%_+_var(--heroui-font-size-small)/2_-_6px)]"]}},{labelPlacement:"inside",isMultiline:!1,size:"lg",class:{label:["text-medium","group-data-[filled-within=true]:-translate-y-[calc(50%_+_var(--heroui-font-size-small)/2_-_8px)]"]}},{labelPlacement:"inside",variant:["faded","bordered"],isMultiline:!1,size:"sm",class:{label:["group-data-[filled-within=true]:-translate-y-[calc(50%_+_var(--heroui-font-size-tiny)/2_-_8px_-_var(--heroui-border-width-medium))]"]}},{labelPlacement:"inside",variant:["faded","bordered"],isMultiline:!1,size:"md",class:{label:["group-data-[filled-within=true]:-translate-y-[calc(50%_+_var(--heroui-font-size-small)/2_-_6px_-_var(--heroui-border-width-medium))]"]}},{labelPlacement:"inside",variant:["faded","bordered"],isMultiline:!1,size:"lg",class:{label:["text-medium","group-data-[filled-within=true]:-translate-y-[calc(50%_+_var(--heroui-font-size-small)/2_-_8px_-_var(--heroui-border-width-medium))]"]}},{labelPlacement:"inside",variant:"underlined",isMultiline:!1,size:"sm",class:{label:["group-data-[filled-within=true]:-translate-y-[calc(50%_+_var(--heroui-font-size-tiny)/2_-_5px)]"]}},{labelPlacement:"inside",variant:"underlined",isMultiline:!1,size:"md",class:{label:["group-data-[filled-within=true]:-translate-y-[calc(50%_+_var(--heroui-font-size-small)/2_-_3.5px)]"]}},{labelPlacement:"inside",variant:"underlined",size:"lg",isMultiline:!1,class:{label:["text-medium","group-data-[filled-within=true]:-translate-y-[calc(50%_+_var(--heroui-font-size-small)/2_-_4px)]"]}},{labelPlacement:"outside",size:"sm",isMultiline:!1,class:{label:["start-2","text-tiny","group-data-[filled-within=true]:-translate-y-[calc(100%_+_var(--heroui-font-size-tiny)/2_+_16px)]"],base:"data-[has-label=true]:mt-[calc(var(--heroui-font-size-small)_+_8px)]"}},{labelPlacement:"outside",size:"md",isMultiline:!1,class:{label:["start-3","end-auto","text-small","group-data-[filled-within=true]:-translate-y-[calc(100%_+_var(--heroui-font-size-small)/2_+_20px)]"],base:"data-[has-label=true]:mt-[calc(var(--heroui-font-size-small)_+_10px)]"}},{labelPlacement:"outside",size:"lg",isMultiline:!1,class:{label:["start-3","end-auto","text-medium","group-data-[filled-within=true]:-translate-y-[calc(100%_+_var(--heroui-font-size-small)/2_+_24px)]"],base:"data-[has-label=true]:mt-[calc(var(--heroui-font-size-small)_+_12px)]"}},{labelPlacement:"outside-left",size:"sm",class:{label:"group-data-[has-helper=true]:pt-2"}},{labelPlacement:"outside-left",size:"md",class:{label:"group-data-[has-helper=true]:pt-3"}},{labelPlacement:"outside-left",size:"lg",class:{label:"group-data-[has-helper=true]:pt-4"}},{labelPlacement:["outside","outside-left"],isMultiline:!0,class:{inputWrapper:"py-2"}},{labelPlacement:"outside",isMultiline:!0,class:{label:"pb-1.5"}},{labelPlacement:"inside",isMultiline:!0,class:{label:"pb-0.5",input:"pt-0"}},{isMultiline:!0,disableAnimation:!1,class:{input:"transition-height !duration-100 motion-reduce:transition-none"}},{labelPlacement:["inside","outside"],class:{label:["pe-2","max-w-full","text-ellipsis","overflow-hidden"]}},{isMultiline:!0,radius:"full",class:{inputWrapper:"data-[has-multiple-rows=true]:rounded-large"}},{isClearable:!0,isMultiline:!0,class:{clearButton:["group-data-[has-value=true]:opacity-70 group-data-[has-value=true]:block","group-data-[has-value=true]:scale-100","group-data-[has-value=true]:pointer-events-auto"]}}]}),Wde=Ka({slots:{base:"w-full relative flex flex-col gap-1 p-1 overflow-clip",list:"w-full flex flex-col gap-0.5 outline-solid outline-transparent",emptyContent:["h-10","px-2","py-1.5","w-full","h-full","text-foreground-400","text-start"]}}),DP=Ka({slots:{base:["flex","group","gap-2","items-center","justify-between","relative","px-2","py-1.5","w-full","h-full","box-border","rounded-small","subpixel-antialiased","outline-solid outline-transparent","cursor-pointer","tap-highlight-transparent",...pu,"data-[focus-visible=true]:dark:ring-offset-background-content1"],wrapper:"w-full flex flex-col items-start justify-center",title:"flex-1 text-small font-normal",description:["w-full","text-tiny","text-foreground-500","group-hover:text-current"],selectedIcon:["text-inherit","w-3","h-3","shrink-0"],shortcut:["px-1","py-0.5","rounded-sm","font-sans","text-foreground-500","text-tiny","border-small","border-default-300","group-hover:border-current"]},variants:{variant:{solid:{base:""},bordered:{base:"border-medium border-transparent bg-transparent"},light:{base:"bg-transparent"},faded:{base:["border-small border-transparent hover:border-default data-[hover=true]:bg-default-100","data-[selectable=true]:focus:border-default data-[selectable=true]:focus:bg-default-100"]},flat:{base:""},shadow:{base:"data-[hover=true]:shadow-lg"}},color:{default:{},primary:{},secondary:{},success:{},warning:{},danger:{}},showDivider:{true:{base:["mb-1.5","after:content-['']","after:absolute","after:-bottom-1","after:left-0","after:right-0","after:h-divider","after:bg-divider"]},false:{}},isDisabled:{true:{base:"opacity-disabled pointer-events-none"}},disableAnimation:{true:{},false:{base:"data-[hover=true]:transition-colors"}},hasTitleTextChild:{true:{title:"truncate"}},hasDescriptionTextChild:{true:{description:"truncate"}}},defaultVariants:{variant:"solid",color:"default",showDivider:!1},compoundVariants:[{variant:"solid",color:"default",class:{base:["data-[hover=true]:bg-default","data-[hover=true]:text-default-foreground","data-[selectable=true]:focus:bg-default","data-[selectable=true]:focus:text-default-foreground"]}},{variant:"solid",color:"primary",class:{base:["data-[hover=true]:bg-primary data-[hover=true]:text-primary-foreground","data-[selectable=true]:focus:bg-primary data-[selectable=true]:focus:text-primary-foreground"]}},{variant:"solid",color:"secondary",class:{base:["data-[hover=true]:bg-secondary data-[hover=true]:text-secondary-foreground","data-[selectable=true]:focus:bg-secondary data-[selectable=true]:focus:text-secondary-foreground"]}},{variant:"solid",color:"success",class:{base:["data-[hover=true]:bg-success data-[hover=true]:text-success-foreground","data-[selectable=true]:focus:bg-success data-[selectable=true]:focus:text-success-foreground"]}},{variant:"solid",color:"warning",class:{base:["data-[hover=true]:bg-warning data-[hover=true]:text-warning-foreground","data-[selectable=true]:focus:bg-warning data-[selectable=true]:focus:text-warning-foreground"]}},{variant:"solid",color:"danger",class:{base:["data-[hover=true]:bg-danger data-[hover=true]:text-danger-foreground","data-[selectable=true]:focus:bg-danger data-[selectable=true]:focus:text-danger-foreground"]}},{variant:"shadow",color:"default",class:{base:["data-[hover=true]:shadow-default/50 data-[hover=true]:bg-default data-[hover=true]:text-default-foreground","data-[selectable=true]:focus:shadow-default/50 data-[selectable=true]:focus:bg-default data-[selectable=true]:focus:text-default-foreground"]}},{variant:"shadow",color:"primary",class:{base:["data-[hover=true]:shadow-primary/30 data-[hover=true]:bg-primary data-[hover=true]:text-primary-foreground","data-[selectable=true]:focus:shadow-primary/30 data-[selectable=true]:focus:bg-primary data-[selectable=true]:focus:text-primary-foreground"]}},{variant:"shadow",color:"secondary",class:{base:["data-[hover=true]:shadow-secondary/30 data-[hover=true]:bg-secondary data-[hover=true]:text-secondary-foreground","data-[selectable=true]:focus:shadow-secondary/30 data-[selectable=true]:focus:bg-secondary data-[selectable=true]:focus:text-secondary-foreground"]}},{variant:"shadow",color:"success",class:{base:["data-[hover=true]:shadow-success/30 data-[hover=true]:bg-success data-[hover=true]:text-success-foreground","data-[selectable=true]:focus:shadow-success/30 data-[selectable=true]:focus:bg-success data-[selectable=true]:focus:text-success-foreground"]}},{variant:"shadow",color:"warning",class:{base:["data-[hover=true]:shadow-warning/30 data-[hover=true]:bg-warning data-[hover=true]:text-warning-foreground","data-[selectable=true]:focus:shadow-warning/30 data-[selectable=true]:focus:bg-warning data-[selectable=true]:focus:text-warning-foreground"]}},{variant:"shadow",color:"danger",class:{base:["data-[hover=true]:shadow-danger/30 data-[hover=true]:bg-danger data-[hover=true]:text-danger-foreground","data-[selectable=true]:focus:shadow-danger/30 data-[selectable=true]:focus:bg-danger data-[selectable=true]:focus:text-danger-foreground"]}},{variant:"bordered",color:"default",class:{base:["data-[hover=true]:border-default","data-[selectable=true]:focus:border-default"]}},{variant:"bordered",color:"primary",class:{base:["data-[hover=true]:border-primary data-[hover=true]:text-primary","data-[selectable=true]:focus:border-primary data-[selectable=true]:focus:text-primary"]}},{variant:"bordered",color:"secondary",class:{base:["data-[hover=true]:border-secondary data-[hover=true]:text-secondary","data-[selectable=true]:focus:border-secondary data-[selectable=true]:focus:text-secondary"]}},{variant:"bordered",color:"success",class:{base:["data-[hover=true]:border-success data-[hover=true]:text-success","data-[selectable=true]:focus:border-success data-[selectable=true]:focus:text-success"]}},{variant:"bordered",color:"warning",class:{base:["data-[hover=true]:border-warning data-[hover=true]:text-warning","data-[selectable=true]:focus:border-warning data-[selectable=true]:focus:text-warning"]}},{variant:"bordered",color:"danger",class:{base:["data-[hover=true]:border-danger data-[hover=true]:text-danger","data-[selectable=true]:focus:border-danger data-[selectable=true]:focus:text-danger"]}},{variant:"flat",color:"default",class:{base:["data-[hover=true]:bg-default/40","data-[hover=true]:text-default-foreground","data-[selectable=true]:focus:bg-default/40","data-[selectable=true]:focus:text-default-foreground"]}},{variant:"flat",color:"primary",class:{base:["data-[hover=true]:bg-primary/20 data-[hover=true]:text-primary","data-[selectable=true]:focus:bg-primary/20 data-[selectable=true]:focus:text-primary"]}},{variant:"flat",color:"secondary",class:{base:["data-[hover=true]:bg-secondary/20 data-[hover=true]:text-secondary","data-[selectable=true]:focus:bg-secondary/20 data-[selectable=true]:focus:text-secondary"]}},{variant:"flat",color:"success",class:{base:["data-[hover=true]:bg-success/20 data-[hover=true]:text-success","data-[selectable=true]:focus:bg-success/20 data-[selectable=true]:focus:text-success"]}},{variant:"flat",color:"warning",class:{base:["data-[hover=true]:bg-warning/20 data-[hover=true]:text-warning","data-[selectable=true]:focus:bg-warning/20 data-[selectable=true]:focus:text-warning"]}},{variant:"flat",color:"danger",class:{base:["data-[hover=true]:bg-danger/20 data-[hover=true]:text-danger","data-[selectable=true]:focus:bg-danger/20 data-[selectable=true]:focus:text-danger"]}},{variant:"faded",color:"default",class:{base:["data-[hover=true]:text-default-foreground","data-[selectable=true]:focus:text-default-foreground"]}},{variant:"faded",color:"primary",class:{base:["data-[hover=true]:text-primary","data-[selectable=true]:focus:text-primary"]}},{variant:"faded",color:"secondary",class:{base:["data-[hover=true]:text-secondary","data-[selectable=true]:focus:text-secondary"]}},{variant:"faded",color:"success",class:{base:["data-[hover=true]:text-success","data-[selectable=true]:focus:text-success"]}},{variant:"faded",color:"warning",class:{base:["data-[hover=true]:text-warning","data-[selectable=true]:focus:text-warning"]}},{variant:"faded",color:"danger",class:{base:["data-[hover=true]:text-danger","data-[selectable=true]:focus:text-danger"]}},{variant:"light",color:"default",class:{base:["data-[hover=true]:text-default-500","data-[selectable=true]:focus:text-default-500"]}},{variant:"light",color:"primary",class:{base:["data-[hover=true]:text-primary","data-[selectable=true]:focus:text-primary"]}},{variant:"light",color:"secondary",class:{base:["data-[hover=true]:text-secondary","data-[selectable=true]:focus:text-secondary"]}},{variant:"light",color:"success",class:{base:["data-[hover=true]:text-success","data-[selectable=true]:focus:text-success"]}},{variant:"light",color:"warning",class:{base:["data-[hover=true]:text-warning","data-[selectable=true]:focus:text-warning"]}},{variant:"light",color:"danger",class:{base:["data-[hover=true]:text-danger","data-[selectable=true]:focus:text-danger"]}}]}),Hde=Ka({slots:{base:"relative mb-2",heading:"pl-1 text-tiny text-foreground-500",group:"data-[has-title=true]:pt-1",divider:"mt-2"}}),Kde=Ka({base:"shrink-0 bg-divider border-none",variants:{orientation:{horizontal:"w-full h-divider",vertical:"h-full w-divider"}},defaultVariants:{orientation:"horizontal"}}),qde=Ka({base:"flex flex-col gap-2 items-start"}),WG=Ka({base:["z-0","group","relative","inline-flex","items-center","justify-center","box-border","appearance-none","outline-solid outline-transparent","select-none","whitespace-nowrap","min-w-max","font-normal","subpixel-antialiased","overflow-hidden","tap-highlight-transparent","transform-gpu data-[pressed=true]:scale-[0.97]","cursor-pointer",...pu],variants:{variant:{solid:"",bordered:"border-medium bg-transparent",light:"bg-transparent",flat:"",faded:"border-medium",shadow:"",ghost:"border-medium bg-transparent"},size:{sm:"px-3 min-w-16 h-8 text-tiny gap-2 rounded-small",md:"px-4 min-w-20 h-10 text-small gap-2 rounded-medium",lg:"px-6 min-w-24 h-12 text-medium gap-3 rounded-large"},color:{default:"",primary:"",secondary:"",success:"",warning:"",danger:""},radius:{none:"rounded-none",sm:"rounded-small",md:"rounded-medium",lg:"rounded-large",full:"rounded-full"},fullWidth:{true:"w-full"},isDisabled:{true:"opacity-disabled pointer-events-none"},isInGroup:{true:"[&:not(:first-child):not(:last-child)]:rounded-none"},isIconOnly:{true:"px-0 !gap-0",false:"[&>svg]:max-w-[theme(spacing.8)]"},disableAnimation:{true:"!transition-none data-[pressed=true]:scale-100",false:"transition-transform-colors-opacity motion-reduce:transition-none"}},defaultVariants:{size:"md",variant:"solid",color:"default",fullWidth:!1,isDisabled:!1,isInGroup:!1},compoundVariants:[{variant:"solid",color:"default",class:It.solid.default},{variant:"solid",color:"primary",class:It.solid.primary},{variant:"solid",color:"secondary",class:It.solid.secondary},{variant:"solid",color:"success",class:It.solid.success},{variant:"solid",color:"warning",class:It.solid.warning},{variant:"solid",color:"danger",class:It.solid.danger},{variant:"shadow",color:"default",class:It.shadow.default},{variant:"shadow",color:"primary",class:It.shadow.primary},{variant:"shadow",color:"secondary",class:It.shadow.secondary},{variant:"shadow",color:"success",class:It.shadow.success},{variant:"shadow",color:"warning",class:It.shadow.warning},{variant:"shadow",color:"danger",class:It.shadow.danger},{variant:"bordered",color:"default",class:It.bordered.default},{variant:"bordered",color:"primary",class:It.bordered.primary},{variant:"bordered",color:"secondary",class:It.bordered.secondary},{variant:"bordered",color:"success",class:It.bordered.success},{variant:"bordered",color:"warning",class:It.bordered.warning},{variant:"bordered",color:"danger",class:It.bordered.danger},{variant:"flat",color:"default",class:It.flat.default},{variant:"flat",color:"primary",class:It.flat.primary},{variant:"flat",color:"secondary",class:It.flat.secondary},{variant:"flat",color:"success",class:It.flat.success},{variant:"flat",color:"warning",class:It.flat.warning},{variant:"flat",color:"danger",class:It.flat.danger},{variant:"faded",color:"default",class:It.faded.default},{variant:"faded",color:"primary",class:It.faded.primary},{variant:"faded",color:"secondary",class:It.faded.secondary},{variant:"faded",color:"success",class:It.faded.success},{variant:"faded",color:"warning",class:It.faded.warning},{variant:"faded",color:"danger",class:It.faded.danger},{variant:"light",color:"default",class:[It.light.default,"data-[hover=true]:bg-default/40"]},{variant:"light",color:"primary",class:[It.light.primary,"data-[hover=true]:bg-primary/20"]},{variant:"light",color:"secondary",class:[It.light.secondary,"data-[hover=true]:bg-secondary/20"]},{variant:"light",color:"success",class:[It.light.success,"data-[hover=true]:bg-success/20"]},{variant:"light",color:"warning",class:[It.light.warning,"data-[hover=true]:bg-warning/20"]},{variant:"light",color:"danger",class:[It.light.danger,"data-[hover=true]:bg-danger/20"]},{variant:"ghost",color:"default",class:[It.ghost.default,"data-[hover=true]:!bg-default"]},{variant:"ghost",color:"primary",class:[It.ghost.primary,"data-[hover=true]:!bg-primary data-[hover=true]:!text-primary-foreground"]},{variant:"ghost",color:"secondary",class:[It.ghost.secondary,"data-[hover=true]:!bg-secondary data-[hover=true]:!text-secondary-foreground"]},{variant:"ghost",color:"success",class:[It.ghost.success,"data-[hover=true]:!bg-success data-[hover=true]:!text-success-foreground"]},{variant:"ghost",color:"warning",class:[It.ghost.warning,"data-[hover=true]:!bg-warning data-[hover=true]:!text-warning-foreground"]},{variant:"ghost",color:"danger",class:[It.ghost.danger,"data-[hover=true]:!bg-danger data-[hover=true]:!text-danger-foreground"]},{isInGroup:!0,class:"rounded-none first:rounded-s-medium last:rounded-e-medium"},{isInGroup:!0,size:"sm",class:"rounded-none first:rounded-s-small last:rounded-e-small"},{isInGroup:!0,size:"md",class:"rounded-none first:rounded-s-medium last:rounded-e-medium"},{isInGroup:!0,size:"lg",class:"rounded-none first:rounded-s-large last:rounded-e-large"},{isInGroup:!0,isRounded:!0,class:"rounded-none first:rounded-s-full last:rounded-e-full"},{isInGroup:!0,radius:"none",class:"rounded-none first:rounded-s-none last:rounded-e-none"},{isInGroup:!0,radius:"sm",class:"rounded-none first:rounded-s-small last:rounded-e-small"},{isInGroup:!0,radius:"md",class:"rounded-none first:rounded-s-medium last:rounded-e-medium"},{isInGroup:!0,radius:"lg",class:"rounded-none first:rounded-s-large last:rounded-e-large"},{isInGroup:!0,radius:"full",class:"rounded-none first:rounded-s-full last:rounded-e-full"},{isInGroup:!0,variant:["ghost","bordered"],color:"default",className:Wp.default},{isInGroup:!0,variant:["ghost","bordered"],color:"primary",className:Wp.primary},{isInGroup:!0,variant:["ghost","bordered"],color:"secondary",className:Wp.secondary},{isInGroup:!0,variant:["ghost","bordered"],color:"success",className:Wp.success},{isInGroup:!0,variant:["ghost","bordered"],color:"warning",className:Wp.warning},{isInGroup:!0,variant:["ghost","bordered"],color:"danger",className:Wp.danger},{isIconOnly:!0,size:"sm",class:"min-w-8 w-8 h-8"},{isIconOnly:!0,size:"md",class:"min-w-10 w-10 h-10"},{isIconOnly:!0,size:"lg",class:"min-w-12 w-12 h-12"},{variant:["solid","faded","flat","bordered","shadow"],class:"data-[hover=true]:opacity-hover"}]});Ka({base:"inline-flex items-center justify-center h-auto",variants:{fullWidth:{true:"w-full"}},defaultVariants:{fullWidth:!1}});var OP=Ka({slots:{base:["flex","flex-col","relative","overflow-hidden","h-auto","outline-solid outline-transparent","text-foreground","box-border","bg-content1",...pu],header:["flex","p-3","z-10","w-full","justify-start","items-center","shrink-0","overflow-inherit","color-inherit","subpixel-antialiased"],body:["relative","flex","flex-1","w-full","p-3","flex-auto","flex-col","place-content-inherit","align-items-inherit","h-auto","break-words","text-left","overflow-y-auto","subpixel-antialiased"],footer:["p-3","h-auto","flex","w-full","items-center","overflow-hidden","color-inherit","subpixel-antialiased"]},variants:{shadow:{none:{base:"shadow-none"},sm:{base:"shadow-small"},md:{base:"shadow-medium"},lg:{base:"shadow-large"}},radius:{none:{base:"rounded-none",header:"rounded-none",footer:"rounded-none"},sm:{base:"rounded-small",header:"rounded-t-small",footer:"rounded-b-small"},md:{base:"rounded-medium",header:"rounded-t-medium",footer:"rounded-b-medium"},lg:{base:"rounded-large",header:"rounded-t-large",footer:"rounded-b-large"}},fullWidth:{true:{base:"w-full"}},isHoverable:{true:{base:"data-[hover=true]:bg-content2 dark:data-[hover=true]:bg-content2"}},isPressable:{true:{base:"cursor-pointer"}},isBlurred:{true:{base:["bg-background/80","dark:bg-background/20","backdrop-blur-md","backdrop-saturate-150"]}},isFooterBlurred:{true:{footer:["bg-background/10","backdrop-blur","backdrop-saturate-150"]}},isDisabled:{true:{base:"opacity-disabled cursor-not-allowed"}},disableAnimation:{true:"",false:{base:"transition-transform-background motion-reduce:transition-none"}}},compoundVariants:[{isPressable:!0,class:"data-[pressed=true]:scale-[0.97] tap-highlight-transparent"}],defaultVariants:{radius:"lg",shadow:"md",fullWidth:!1,isHoverable:!1,isPressable:!1,isDisabled:!1,isFooterBlurred:!1}}),MP=Ka({slots:{base:["relative","max-w-fit","min-w-min","inline-flex","items-center","justify-between","box-border","whitespace-nowrap"],content:"flex-1 text-inherit font-normal",dot:["w-2","h-2","ml-1","rounded-full"],avatar:"shrink-0",closeButton:["z-10","appearance-none","outline-solid outline-transparent","select-none","transition-opacity","opacity-70","hover:opacity-100","cursor-pointer","active:opacity-disabled","tap-highlight-transparent"]},variants:{variant:{solid:{},bordered:{base:"border-medium bg-transparent"},light:{base:"bg-transparent"},flat:{},faded:{base:"border-medium"},shadow:{},dot:{base:"border-medium border-default text-foreground bg-transparent"}},color:{default:{dot:"bg-default-400"},primary:{dot:"bg-primary"},secondary:{dot:"bg-secondary"},success:{dot:"bg-success"},warning:{dot:"bg-warning"},danger:{dot:"bg-danger"}},size:{sm:{base:"px-1 h-6 text-tiny",content:"px-1",closeButton:"text-medium",avatar:"w-4 h-4"},md:{base:"px-1 h-7 text-small",content:"px-2",closeButton:"text-large",avatar:"w-5 h-5"},lg:{base:"px-2 h-8 text-medium",content:"px-2",closeButton:"text-xl",avatar:"w-6 h-6"}},radius:{none:{base:"rounded-none"},sm:{base:"rounded-small"},md:{base:"rounded-medium"},lg:{base:"rounded-large"},full:{base:"rounded-full"}},isOneChar:{true:{},false:{}},isCloseable:{true:{},false:{}},hasStartContent:{true:{}},hasEndContent:{true:{}},isDisabled:{true:{base:"opacity-disabled pointer-events-none"}},isCloseButtonFocusVisible:{true:{closeButton:[...$de,"ring-1","rounded-full"]}}},defaultVariants:{variant:"solid",color:"default",size:"md",radius:"full",isDisabled:!1},compoundVariants:[{variant:"solid",color:"default",class:{base:It.solid.default}},{variant:"solid",color:"primary",class:{base:It.solid.primary}},{variant:"solid",color:"secondary",class:{base:It.solid.secondary}},{variant:"solid",color:"success",class:{base:It.solid.success}},{variant:"solid",color:"warning",class:{base:It.solid.warning}},{variant:"solid",color:"danger",class:{base:It.solid.danger}},{variant:"shadow",color:"default",class:{base:It.shadow.default}},{variant:"shadow",color:"primary",class:{base:It.shadow.primary}},{variant:"shadow",color:"secondary",class:{base:It.shadow.secondary}},{variant:"shadow",color:"success",class:{base:It.shadow.success}},{variant:"shadow",color:"warning",class:{base:It.shadow.warning}},{variant:"shadow",color:"danger",class:{base:It.shadow.danger}},{variant:"bordered",color:"default",class:{base:It.bordered.default}},{variant:"bordered",color:"primary",class:{base:It.bordered.primary}},{variant:"bordered",color:"secondary",class:{base:It.bordered.secondary}},{variant:"bordered",color:"success",class:{base:It.bordered.success}},{variant:"bordered",color:"warning",class:{base:It.bordered.warning}},{variant:"bordered",color:"danger",class:{base:It.bordered.danger}},{variant:"flat",color:"default",class:{base:It.flat.default}},{variant:"flat",color:"primary",class:{base:It.flat.primary}},{variant:"flat",color:"secondary",class:{base:It.flat.secondary}},{variant:"flat",color:"success",class:{base:It.flat.success}},{variant:"flat",color:"warning",class:{base:It.flat.warning}},{variant:"flat",color:"danger",class:{base:It.flat.danger}},{variant:"faded",color:"default",class:{base:It.faded.default}},{variant:"faded",color:"primary",class:{base:It.faded.primary}},{variant:"faded",color:"secondary",class:{base:It.faded.secondary}},{variant:"faded",color:"success",class:{base:It.faded.success}},{variant:"faded",color:"warning",class:{base:It.faded.warning}},{variant:"faded",color:"danger",class:{base:It.faded.danger}},{variant:"light",color:"default",class:{base:It.light.default}},{variant:"light",color:"primary",class:{base:It.light.primary}},{variant:"light",color:"secondary",class:{base:It.light.secondary}},{variant:"light",color:"success",class:{base:It.light.success}},{variant:"light",color:"warning",class:{base:It.light.warning}},{variant:"light",color:"danger",class:{base:It.light.danger}},{isOneChar:!0,hasStartContent:!1,hasEndContent:!1,size:"sm",class:{base:"w-5 h-5 min-w-5 min-h-5"}},{isOneChar:!0,hasStartContent:!1,hasEndContent:!1,size:"md",class:{base:"w-6 h-6 min-w-6 min-h-6"}},{isOneChar:!0,hasStartContent:!1,hasEndContent:!1,size:"lg",class:{base:"w-7 h-7 min-w-7 min-h-7"}},{isOneChar:!0,isCloseable:!1,hasStartContent:!1,hasEndContent:!1,class:{base:"px-0 justify-center",content:"px-0 flex-none"}},{isOneChar:!0,isCloseable:!0,hasStartContent:!1,hasEndContent:!1,class:{base:"w-auto"}},{isOneChar:!0,variant:"dot",class:{base:"w-auto h-7 px-1 items-center",content:"px-2"}},{hasStartContent:!0,size:"sm",class:{content:"pl-0.5"}},{hasStartContent:!0,size:["md","lg"],class:{content:"pl-1"}},{hasEndContent:!0,size:"sm",class:{content:"pr-0.5"}},{hasEndContent:!0,size:["md","lg"],class:{content:"pr-1"}}]}),HG={};HG={close:"إغلاق",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} إشعار`,other:()=>`${e.number(t.count)} إشعارات`})}.`};var KG={};KG={close:"Затвори",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} известие`,other:()=>`${e.number(t.count)} известия`})}.`};var qG={};qG={close:"Zavřít",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} oznámení`,other:()=>`${e.number(t.count)} oznámení`})}.`};var XG={};XG={close:"Luk",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} besked`,other:()=>`${e.number(t.count)} beskeder`})}.`};var YG={};YG={close:"Schließen",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} Benachrichtigung`,other:()=>`${e.number(t.count)} Benachrichtigungen`})}.`};var JG={};JG={close:"Κλείσιμο",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} ειδοποίηση`,other:()=>`${e.number(t.count)} ειδοποιήσεις`})}.`};var ZG={};ZG={close:"Close",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} notification`,other:()=>`${e.number(t.count)} notifications`})}.`};var QG={};QG={close:"Cerrar",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} notificación`,other:()=>`${e.number(t.count)} notificaciones`})}.`};var ej={};ej={close:"Sule",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} teatis`,other:()=>`${e.number(t.count)} teatist`})}.`};var tj={};tj={close:"Sulje",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} ilmoitus`,other:()=>`${e.number(t.count)} ilmoitusta`})}.`};var nj={};nj={close:"Fermer",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} notification`,other:()=>`${e.number(t.count)} notifications`})}.`};var rj={};rj={close:"סגור",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} התראה`,other:()=>`${e.number(t.count)} התראות`})}.`};var ij={};ij={close:"Zatvori",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} obavijest`,other:()=>`${e.number(t.count)} obavijesti`})}.`};var aj={};aj={close:"Bezárás",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} értesítés`,other:()=>`${e.number(t.count)} értesítés`})}.`};var oj={};oj={close:"Chiudi",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} notifica`,other:()=>`${e.number(t.count)} notifiche`})}.`};var sj={};sj={close:"閉じる",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} 個の通知`,other:()=>`${e.number(t.count)} 個の通知`})}。`};var lj={};lj={close:"닫기",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)}개 알림`,other:()=>`${e.number(t.count)}개 알림`})}.`};var cj={};cj={close:"Uždaryti",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} pranešimas`,other:()=>`${e.number(t.count)} pranešimai`})}.`};var uj={};uj={close:"Aizvērt",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} paziņojums`,other:()=>`${e.number(t.count)} paziņojumi`})}.`};var fj={};fj={close:"Lukk",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} varsling`,other:()=>`${e.number(t.count)} varsler`})}.`};var dj={};dj={close:"Sluiten",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} melding`,other:()=>`${e.number(t.count)} meldingen`})}.`};var hj={};hj={close:"Zamknij",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} powiadomienie`,few:()=>`${e.number(t.count)} powiadomienia`,many:()=>`${e.number(t.count)} powiadomień`,other:()=>`${e.number(t.count)} powiadomienia`})}.`};var pj={};pj={close:"Fechar",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} notificação`,other:()=>`${e.number(t.count)} notificações`})}.`};var gj={};gj={close:"Fechar",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} notificação`,other:()=>`${e.number(t.count)} notificações`})}.`};var mj={};mj={close:"Închideţi",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} notificare`,other:()=>`${e.number(t.count)} notificări`})}.`};var vj={};vj={close:"Закрыть",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} уведомление`,other:()=>`${e.number(t.count)} уведомления`})}.`};var yj={};yj={close:"Zatvoriť",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} oznámenie`,few:()=>`${e.number(t.count)} oznámenia`,other:()=>`${e.number(t.count)} oznámení`})}.`};var xj={};xj={close:"Zapri",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} obvestilo`,two:()=>`${e.number(t.count)} obvestili`,few:()=>`${e.number(t.count)} obvestila`,other:()=>`${e.number(t.count)} obvestil`})}.`};var bj={};bj={close:"Zatvori",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} obaveštenje`,other:()=>`${e.number(t.count)} obaveštenja`})}.`};var wj={};wj={close:"Stäng",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} meddelande`,other:()=>`${e.number(t.count)} meddelanden`})}.`};var Cj={};Cj={close:"Kapat",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} bildirim`,other:()=>`${e.number(t.count)} bildirim`})}.`};var Sj={};Sj={close:"Закрити",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} сповіщення`,other:()=>`${e.number(t.count)} сповіщення`})}.`};var Tj={};Tj={close:"关闭",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} 个通知`,other:()=>`${e.number(t.count)} 个通知`})}。`};var Ej={};Ej={close:"關閉",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} 個通知`,other:()=>`${e.number(t.count)} 個通知`})}。`};var o9={};o9={"ar-AE":HG,"bg-BG":KG,"cs-CZ":qG,"da-DK":XG,"de-DE":YG,"el-GR":JG,"en-US":ZG,"es-ES":QG,"et-EE":ej,"fi-FI":tj,"fr-FR":nj,"he-IL":rj,"hr-HR":ij,"hu-HU":aj,"it-IT":oj,"ja-JP":sj,"ko-KR":lj,"lt-LT":cj,"lv-LV":uj,"nb-NO":fj,"nl-NL":dj,"pl-PL":hj,"pt-BR":pj,"pt-PT":gj,"ro-RO":mj,"ru-RU":vj,"sk-SK":yj,"sl-SI":xj,"sr-SP":bj,"sv-SE":wj,"tr-TR":Cj,"uk-UA":Sj,"zh-CN":Tj,"zh-TW":Ej};function Xde(t){return t&&t.__esModule?t.default:t}function Yde(t,e,n){let{key:r,timer:i,timeout:a}=t.toast;H.useEffect(()=>{if(!(i==null||a==null))return i.reset(a),()=>{i.pause()}},[i,a]);let o=Js(),s=am(),l=dw(Xde(o9),"@react-aria/toast"),[c,f]=H.useState(!1);return H.useEffect(()=>{f(!0)},[]),{toastProps:{...T0(t,{labelable:!0}),role:"alertdialog","aria-modal":"false","aria-labelledby":t["aria-labelledby"]||o,"aria-describedby":t["aria-describedby"]||s,tabIndex:0},contentProps:{role:"alert","aria-atomic":"true","aria-hidden":c?void 0:"true"},titleProps:{id:o},descriptionProps:{id:s},closeButtonProps:{"aria-label":l.format("close"),onPress:()=>e.close(r)}}}var nT={exports:{}},rT={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var IP;function Jde(){if(IP)return rT;IP=1;var t=aw();function e(u,d){return u===d&&(u!==0||1/u===1/d)||u!==u&&d!==d}var n=typeof Object.is=="function"?Object.is:e,r=t.useState,i=t.useEffect,a=t.useLayoutEffect,o=t.useDebugValue;function s(u,d){var h=d(),p=r({inst:{value:h,getSnapshot:d}}),g=p[0].inst,m=p[1];return a(function(){g.value=h,g.getSnapshot=d,l(g)&&m({inst:g})},[u,h,d]),i(function(){return l(g)&&m({inst:g}),u(function(){l(g)&&m({inst:g})})},[u]),o(h),h}function l(u){var d=u.getSnapshot;u=u.value;try{var h=d();return!n(u,h)}catch{return!0}}function c(u,d){return d()}var f=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?c:s;return rT.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:f,rT}var RP;function Zde(){return RP||(RP=1,nT.exports=Jde()),nT.exports}var _j=Zde();const Dj=1,iT=Symbol.for("react-aria-landmark-manager");function Qde(t){return document.addEventListener("react-aria-landmark-manager-change",t),()=>document.removeEventListener("react-aria-landmark-manager-change",t)}function AP(){if(typeof document>"u")return null;let t=document[iT];return t&&t.version>=Dj?t:(document[iT]=new t0e,document.dispatchEvent(new CustomEvent("react-aria-landmark-manager-change")),document[iT])}function e0e(){return _j.useSyncExternalStore(Qde,AP,AP)}class t0e{setupIfNeeded(){this.isListening||(document.addEventListener("keydown",this.f6Handler,{capture:!0}),document.addEventListener("focusin",this.focusinHandler,{capture:!0}),document.addEventListener("focusout",this.focusoutHandler,{capture:!0}),this.isListening=!0)}teardownIfNeeded(){!this.isListening||this.landmarks.length>0||this.refCount>0||(document.removeEventListener("keydown",this.f6Handler,{capture:!0}),document.removeEventListener("focusin",this.focusinHandler,{capture:!0}),document.removeEventListener("focusout",this.focusoutHandler,{capture:!0}),this.isListening=!1)}focusLandmark(e,n){var r,i;(i=this.landmarks.find(a=>a.ref.current===e))===null||i===void 0||(r=i.focus)===null||r===void 0||r.call(i,n)}getLandmarksByRole(e){return new Set(this.landmarks.filter(n=>n.role===e))}getLandmarkByRole(e){return this.landmarks.find(n=>n.role===e)}addLandmark(e){if(this.setupIfNeeded(),this.landmarks.find(i=>i.ref===e.ref)||!e.ref.current)return;if(this.landmarks.filter(i=>i.role==="main").length>1,this.landmarks.length===0){this.landmarks=[e],this.checkLabels(e.role);return}let n=0,r=this.landmarks.length-1;for(;n<=r;){let i=Math.floor((n+r)/2),a=e.ref.current.compareDocumentPosition(this.landmarks[i].ref.current);!!(a&Node.DOCUMENT_POSITION_PRECEDING||a&Node.DOCUMENT_POSITION_CONTAINS)?n=i+1:r=i-1}this.landmarks.splice(n,0,e),this.checkLabels(e.role)}updateLandmark(e){let n=this.landmarks.findIndex(r=>r.ref===e.ref);n>=0&&(this.landmarks[n]={...this.landmarks[n],...e},this.checkLabels(this.landmarks[n].role))}removeLandmark(e){this.landmarks=this.landmarks.filter(n=>n.ref!==e),this.teardownIfNeeded()}checkLabels(e){let n=this.getLandmarksByRole(e);n.size>1&&[...n].filter(r=>!r.label)}closestLandmark(e){let n=new Map(this.landmarks.map(i=>[i.ref.current,i])),r=e;for(;r&&!n.has(r)&&r!==document.body&&r.parentElement;)r=r.parentElement;return n.get(r)}getNextLandmark(e,{backward:n}){var r;let i=this.closestLandmark(e),a=n?this.landmarks.length-1:0;i&&(a=this.landmarks.indexOf(i)+(n?-1:1));let o=()=>{if(a<0){if(!e.dispatchEvent(new CustomEvent("react-aria-landmark-navigation",{detail:{direction:"backward"},bubbles:!0,cancelable:!0})))return!0;a=this.landmarks.length-1}else if(a>=this.landmarks.length){if(!e.dispatchEvent(new CustomEvent("react-aria-landmark-navigation",{detail:{direction:"forward"},bubbles:!0,cancelable:!0})))return!0;a=0}return a<0||a>=this.landmarks.length};if(o())return;let s=a;for(;!((r=this.landmarks[a].ref.current)===null||r===void 0)&&r.closest("[aria-hidden=true]");){if(a+=n?-1:1,o())return;if(a===s)break}return this.landmarks[a]}f6Handler(e){e.key==="F6"&&(e.altKey?this.focusMain():this.navigate(e.target,e.shiftKey))&&(e.preventDefault(),e.stopPropagation())}focusMain(){let e=this.getLandmarkByRole("main");return e&&e.ref.current&&document.contains(e.ref.current)?(this.focusLandmark(e.ref.current,"forward"),!0):!1}navigate(e,n){let r=this.getNextLandmark(e,{backward:n});if(!r)return!1;if(r.lastFocused){let i=r.lastFocused;if(document.body.contains(i))return i.focus(),!0}return r.ref.current&&document.contains(r.ref.current)?(this.focusLandmark(r.ref.current,n?"backward":"forward"),!0):!1}focusinHandler(e){let n=this.closestLandmark(e.target);n&&n.ref.current!==e.target&&this.updateLandmark({ref:n.ref,lastFocused:e.target});let r=e.relatedTarget;if(r){let i=this.closestLandmark(r);i&&i.ref.current===r&&i.blur()}}focusoutHandler(e){let n=e.target,r=e.relatedTarget;if(!r||r===document){let i=this.closestLandmark(n);i&&i.ref.current===n&&i.blur()}}createLandmarkController(){let e=this;return e.refCount++,e.setupIfNeeded(),{navigate(n,r){let i=r?.from||document.activeElement;return e.navigate(i,n==="backward")},focusNext(n){let r=n?.from||document.activeElement;return e.navigate(r,!1)},focusPrevious(n){let r=n?.from||document.activeElement;return e.navigate(r,!0)},focusMain(){return e.focusMain()},dispose(){e&&(e.refCount--,e.teardownIfNeeded(),e=null)}}}registerLandmark(e){return this.landmarks.find(n=>n.ref===e.ref)?this.updateLandmark(e):this.addLandmark(e),()=>this.removeLandmark(e.ref)}constructor(){this.landmarks=[],this.isListening=!1,this.refCount=0,this.version=Dj,this.f6Handler=this.f6Handler.bind(this),this.focusinHandler=this.focusinHandler.bind(this),this.focusoutHandler=this.focusoutHandler.bind(this)}}function n0e(t,e){const{role:n,"aria-label":r,"aria-labelledby":i,focus:a}=t;let o=e0e(),s=r||i,[l,c]=H.useState(!1),f=H.useCallback(()=>{c(!0)},[c]),u=H.useCallback(()=>{c(!1)},[c]);return Br(()=>{if(o)return o.registerLandmark({ref:e,label:s,role:n,focus:a||f,blur:u})},[o,s,e,n,a,f,u]),H.useEffect(()=>{var d;l&&((d=e.current)===null||d===void 0||d.focus())},[l,e]),{landmarkProps:{role:n,tabIndex:l?-1:void 0,"aria-label":r,"aria-labelledby":i}}}function r0e(t){return t&&t.__esModule?t.default:t}function i0e(t,e,n){let r=dw(r0e(o9),"@react-aria/toast"),{landmarkProps:i}=n0e({role:"region","aria-label":t["aria-label"]||r.format("notifications",{count:e.visibleToasts.length})},n),a=H.useRef(!1),o=H.useRef(!1),s=va(()=>{a.current||o.current?e.pauseAll():e.resumeAll()}),{hoverProps:l}=Zs({onHoverStart:()=>{a.current=!0,s()},onHoverEnd:()=>{a.current=!1,s()}}),c=H.useRef([]),f=H.useRef(e.visibleToasts),u=H.useRef(null);Br(()=>{if(u.current===-1||e.visibleToasts.length===0||!n.current){c.current=[],f.current=e.visibleToasts;return}if(c.current=[...n.current.querySelectorAll('[role="alertdialog"]')],f.current.length===e.visibleToasts.length&&e.visibleToasts.every((y,v)=>y.key===f.current[v].key)){f.current=e.visibleToasts;return}let p=f.current.map((y,v)=>({...y,i:v,isRemoved:!e.visibleToasts.some(x=>y.key===x.key)})),g=p.findIndex(y=>y.i===u.current&&y.isRemoved);if(g>-1){var m;if(Lh()==="pointer"&&(!((m=d.current)===null||m===void 0)&&m.isConnected))To(d.current);else{let y=0,v,x;for(;y<=g;)p[y].isRemoved||(x=Math.max(0,y-1)),y++;for(;y<p.length;){if(!p[y].isRemoved){v=y-1;break}y++}x===void 0&&v===void 0&&(x=0),x>=0&&x<c.current.length?To(c.current[x]):v>=0&&v<c.current.length&&To(c.current[v])}}f.current=e.visibleToasts},[e.visibleToasts,n,s]);let d=H.useRef(null),{focusWithinProps:h}=sp({onFocusWithin:p=>{o.current=!0,d.current=p.relatedTarget,s()},onBlurWithin:()=>{o.current=!1,d.current=null,s()}});return H.useEffect(()=>{var p;e.visibleToasts.length===0&&(!((p=d.current)===null||p===void 0)&&p.isConnected)&&(Lh()==="pointer"?To(d.current):d.current.focus(),d.current=null)},[n,e.visibleToasts.length]),H.useEffect(()=>()=>{var p;!((p=d.current)===null||p===void 0)&&p.isConnected&&(Lh()==="pointer"?To(d.current):d.current.focus(),d.current=null)},[n]),{regionProps:Oi(i,l,h,{tabIndex:-1,"data-react-aria-top-layer":!0,onFocus:p=>{let g=p.target.closest('[role="alertdialog"]');u.current=c.current.findIndex(m=>m===g)},onBlur:()=>{u.current=-1}})}}var a0e=700;function Oj(){return uw()||typeof window>"u"?!1:window.screen.width<=a0e}var aT=100,oT=20;function o0e(t){var e,n;const[r,i]=Vl(t,CP.variantKeys),{ref:a,as:o,title:s,description:l,className:c,classNames:f,toast:u,endContent:d,closeIcon:h,hideIcon:p=!1,placement:g="bottom-right",isRegionExpanded:m,hideCloseButton:y=!1,state:v,total:x=1,index:w=0,heights:S,promise:T,setHeights:_,toastOffset:D=0,motionProps:I,timeout:R=6e3,shouldShowTimeoutProgress:M=!1,icon:A,onClose:L,severity:P,maxVisibleToasts:B,loadingComponent:U,...G}=r,{isHovered:F,hoverProps:$}=Zs({isDisabled:!1}),V=es(),X=(n=(e=t?.disableAnimation)!=null?e:V?.disableAnimation)!=null?n:!1,Q=Oj();let re=g;Q&&(g.includes("top")?re="top-center":re="bottom-center");const ye=H.useRef(null),me=H.useRef(null),Ce=H.useRef(0),we=H.useRef(null),Ae=H.useRef(0),De=H.useRef(0);H.useEffect(()=>{we.current&&(we.current.style.width="0%")},[]);const[q,k]=H.useState(!!T),[J,Y]=H.useState(!1);H.useEffect(()=>{T&&T.finally(()=>{k(!1)})},[T]),H.useEffect(()=>{const Rt=Bt=>{if(!R||q)return;if(me.current===null&&(me.current=Bt),F||m){Ae.current+=Bt-me.current,me.current=null,ye.current=requestAnimationFrame(Rt);return}const On=Bt-me.current+Ae.current;De.current=On,De.current>=R&&Y(!0),Ce.current=Math.min(On/R*100,100),we.current&&(we.current.style.width=`${M?Ce.current:0}%`),Ce.current<100&&(ye.current=requestAnimationFrame(Rt))};return ye.current=requestAnimationFrame(Rt),()=>{ye.current!==null&&cancelAnimationFrame(ye.current)}},[R,M,v,F,w,x,m,q,Y]);const ie=o||"div",ue=Di(a),fe=ln(c,f?.base),{toastProps:Se,contentProps:Fe,titleProps:Ke,descriptionProps:He}=Yde(r,v),[pe,ge]=H.useState(!1);H.useEffect(()=>{ge(!0)},[]);const[Ie,ve]=H.useState(0);H.useLayoutEffect(()=>{if(!ue.current||!pe||J)return;const Rt=ue.current,Bt=Rt.style.height;Rt.style.height="auto";const On=getComputedStyle(Rt),$t=parseFloat(On.marginTop),Xt=parseFloat(On.marginBottom),Lt=Rt.getBoundingClientRect().height+$t+Xt;Rt.style.height=Bt,ve(yr=>yr!==Lt?Lt:yr);const Qt=[...S];Qt.length>w?Qt[w]=Lt:Qt.push(Lt),_(Qt)},[pe,x,_,w,J]);let _e=4;for(let Rt=w+1;Rt<x;Rt++)_e+=S[Rt];const Pe=S[S.length-1],ne=H.useMemo(()=>CP({...i,disableAnimation:X}),[kl(i)]),Je=re.includes("top")?1:-1,$e={hidden:{opacity:0,y:-50*Je},visible:{opacity:1,y:0},exit:{opacity:0,y:-50*Je}},[ke,Re]=H.useState(!1),[ze,st]=H.useState(0),Qe=(Rt,Bt)=>{const On=re.includes("right"),$t=re.includes("left"),Xt=re==="top-center",Lt=re==="bottom-center";if(On&&Rt>=aT||$t&&Rt<=-aT||Xt&&Bt<=-oT||Lt&&Bt>=oT)return!0},_t=Rt=>{const Bt={top:0,bottom:0,right:0,left:0};return Rt==="bottom-center"?(Bt.bottom=1,Bt):Rt==="top-center"?(Bt.top=1,Bt):Rt.includes("right")?(Bt.right=1,Bt):Rt.includes("left")?(Bt.left=1,Bt):(Bt.left=1,Bt.right=1,Bt)};let Le;ke&&re==="bottom-center"||re==="top-center"?Le=Math.max(0,1-ze/(oT+5)):ke&&(Le=Math.max(0,1-ze/(aT+20)));const We=H.useCallback((Rt={})=>{const $t={"--top-extension":"16px","--bottom-extension":"16px"};return{ref:ue,className:ne.base({class:ln(fe,f?.base)}),"data-has-title":Nt(!Lb(s)),"data-has-description":Nt(!Lb(l)),"data-placement":re,"data-drag-value":ze,"data-toast":!0,"aria-label":"toast","data-toast-exiting":Nt(J),onTransitionEnd:()=>{if(J){const Xt=S;Xt.splice(w,1),_([...Xt]),v.close(u.key)}},style:{opacity:Le,...$t},...Pn(Rt,G,Se,$)}},[ne,f,Se,$,u,u.key,Le,J,v,u.key]),xt=H.useCallback((Rt={})=>({className:ne.wrapper({class:f?.wrapper}),...Rt}),[]),Ut=H.useCallback((Rt={})=>({"aria-label":"descriptionIcon",className:ne.icon({class:f?.icon}),...Rt}),[]),gn=H.useCallback((Rt={})=>({className:ne.loadingComponent({class:f?.loadingComponent}),"aria-label":"loadingIcon",color:"current",...Rt}),[]),tn=H.useCallback((Rt={})=>({classNames:{wrapper:ne.loadingComponent({class:f?.loadingComponent})},"aria-label":"loadingIcon",color:"current",...Rt}),[]),Ht=H.useCallback((Rt={})=>({className:ne.content({class:f?.content}),...Pn(Rt,G,Fe)}),[Fe]),dn=H.useCallback((Rt={})=>({className:ne.title({class:f?.title}),...Pn(Rt,G,Ke)}),[Ke]),sr=H.useCallback((Rt={})=>({className:ne.description({class:f?.description}),...Pn(Rt,G,He)}),[He]),Qn=H.useCallback((Rt={})=>({className:ne.closeButton({class:f?.closeButton}),"aria-label":"closeButton","data-hidden":Nt(y),...Pn(Rt,{onPress:Rf(()=>{Y(!0),setTimeout(()=>document.body.focus(),0)},L)})}),[Y,L,v,u]),qe=H.useCallback((Rt={})=>({className:ne.closeIcon({class:f?.closeIcon}),"aria-label":"closeIcon",...Rt}),[]),Dt=H.useCallback((Rt={})=>{const Bt=m?B-1:Math.min(2,B-1),On=x-w-1<=Bt,$t=re==="bottom-center"||re==="top-center"?"y":"x",Xt={left:0,right:0,top:0,bottom:0},Lt=_t(re),Qt=re.includes("top")?{top:m||ke?_e+D:(x-1-w)*8+D,bottom:"auto"}:re.includes("bottom")?{bottom:m||ke?_e+D:(x-1-w)*8+D,top:"auto"}:{};return{animate:{opacity:On?1:0,pointerEvents:On?"all":"none",scaleX:m||ke?1:1-(x-1-w)*.1,height:m||ke?Ie:Pe,y:0,...Qt},drag:$t,dragConstraints:Xt,exit:{opacity:0},initial:{opacity:0,scale:1,y:-40*Je},transition:{duration:.3,ease:"easeOut"},variants:$e,dragElastic:Lt,onDragEnd:(yr,kr)=>{const{x:ni,y:Ii}=kr.offset;if(Re(!1),Qe(ni,Ii)){const fi=S;fi.splice(w,1),_([...fi]),v.close(u.key);return}st(0)},onDrag:(yr,kr)=>{let ni=0;re==="top-center"?ni=-kr.offset.y:re==="bottom-center"?ni=kr.offset.y:re.includes("right")?ni=kr.offset.x:re.includes("left")&&(ni=-kr.offset.x),ni>=0&&st(ni)},onDragStart:()=>{Re(!0)},"data-drag":Nt(ke),"data-placement":re,"data-drag-value":ze,className:ne.motionDiv({class:f?.motionDiv}),...Rt,...I}},[x,w,re,m,J,_e,Je,Ie,Pe,$e,f,ke,Nt,Re,Qe,ne,D,B]);return{Component:ie,title:s,description:l,icon:A,loadingComponent:U,domRef:ue,severity:P,closeIcon:h,classNames:f,color:i.color,hideIcon:p,placement:re,state:v,toast:u,disableAnimation:X,isProgressBarVisible:!!R,total:x,index:w,getWrapperProps:xt,getToastProps:We,getTitleProps:dn,getContentProps:Ht,getDescriptionProps:sr,getCloseButtonProps:Qn,getIconProps:Ut,getMotionDivProps:Dt,getCloseIconProps:qe,getLoadingComponentProps:gn,getSpinnerComponentProps:tn,progressBarRef:we,endContent:d,slots:ne,isRegionExpanded:m,liftHeight:_e,frontHeight:Pe,initialHeight:Ie,isLoading:q}}function s0e(t){var e,n;const[r,i]=Vl(t,bP.variantKeys),a=es(),o=(n=(e=t?.variant)!=null?e:a?.spinnerVariant)!=null?n:"default",{children:s,className:l,classNames:c,label:f,...u}=r,d=H.useMemo(()=>bP({...i}),[kl(i)]),h=ln(c?.base,l),p=f||s,g=H.useMemo(()=>p&&typeof p=="string"?p:u["aria-label"]?"":"Loading",[s,p,u["aria-label"]]),m=H.useCallback(()=>({"aria-label":g,className:d.base({class:h}),...u}),[g,d,h,u]);return{label:p,slots:d,classNames:c,variant:o,getSpinnerProps:m}}var Mj=Hi((t,e)=>{const{slots:n,classNames:r,label:i,variant:a,getSpinnerProps:o}=s0e({...t});return a==="wave"||a==="dots"?j.jsxs("div",{ref:e,...o(),children:[j.jsx("div",{className:n.wrapper({class:r?.wrapper}),children:[...new Array(3)].map((s,l)=>j.jsx("i",{className:n.dots({class:r?.dots}),style:{"--dot-index":l}},`dot-${l}`))}),i&&j.jsx("span",{className:n.label({class:r?.label}),children:i})]}):a==="simple"?j.jsxs("div",{ref:e,...o(),children:[j.jsxs("svg",{className:n.wrapper({class:r?.wrapper}),fill:"none",viewBox:"0 0 24 24",children:[j.jsx("circle",{className:n.circle1({class:r?.circle1}),cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),j.jsx("path",{className:n.circle2({class:r?.circle2}),d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",fill:"currentColor"})]}),i&&j.jsx("span",{className:n.label({class:r?.label}),children:i})]}):a==="spinner"?j.jsxs("div",{ref:e,...o(),children:[j.jsx("div",{className:n.wrapper({class:r?.wrapper}),children:[...new Array(12)].map((s,l)=>j.jsx("i",{className:n.spinnerBars({class:r?.spinnerBars}),style:{"--bar-index":l}},`star-${l}`))}),i&&j.jsx("span",{className:n.label({class:r?.label}),children:i})]}):j.jsxs("div",{ref:e,...o(),children:[j.jsxs("div",{className:n.wrapper({class:r?.wrapper}),children:[j.jsx("i",{className:n.circle1({class:r?.circle1})}),j.jsx("i",{className:n.circle2({class:r?.circle2})})]}),i&&j.jsx("span",{className:n.label({class:r?.label}),children:i})]})});Mj.displayName="HeroUI.Spinner";var Dw=Mj,l0e=t=>j.jsx("svg",{fill:"none",height:"24",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg",...t,children:j.jsx("path",{d:`
          M12 2C6.49 2 2 6.49 2 12C2 17.51 6.49 22 12 22C17.51 22 22 17.51 22 12C22 6.49 17.51 2 12 2Z
          M16.78 9.7L11.11 15.37C10.97 15.51 10.78 15.59 10.58 15.59C10.38 15.59 10.19 15.51 10.05 15.37L7.22 12.54
          C6.93 12.25 6.93 11.77 7.22 11.48C7.51 11.19 7.99 11.19 8.28 11.48L10.58 13.78L15.72 8.64
          C16.01 8.35 16.49 8.35 16.78 8.64C17.07 8.93 17.07 9.4 16.78 9.7Z
        `})}),c0e=t=>j.jsx("svg",{className:"fill-current",fill:"none",height:"24",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg",...t,children:j.jsx("path",{clipRule:"evenodd",d:"M3 10.417C3 7.219 3 5.62 3.378 5.082C3.755 4.545 5.258 4.03 8.265 3.001L8.838 2.805C10.405 2.268 11.188 2 12 2C12.812 2 13.595 2.268 15.162 2.805L15.735 3.001C18.742 4.03 20.245 4.545 20.622 5.082C21 5.62 21 7.22 21 10.417V11.991C21 17.629 16.761 20.366 14.101 21.527C13.38 21.842 13.02 22 12 22C10.98 22 10.62 21.842 9.899 21.527C7.239 20.365 3 17.63 3 11.991V10.417ZM12 7.25C12.1989 7.25 12.3897 7.32902 12.5303 7.46967C12.671 7.61032 12.75 7.80109 12.75 8V12C12.75 12.1989 12.671 12.3897 12.5303 12.5303C12.3897 12.671 12.1989 12.75 12 12.75C11.8011 12.75 11.6103 12.671 11.4697 12.5303C11.329 12.3897 11.25 12.1989 11.25 12V8C11.25 7.80109 11.329 7.61032 11.4697 7.46967C11.6103 7.32902 11.8011 7.25 12 7.25ZM12 16C12.2652 16 12.5196 15.8946 12.7071 15.7071C12.8946 15.5196 13 15.2652 13 15C13 14.7348 12.8946 14.4804 12.7071 14.2929C12.5196 14.1054 12.2652 14 12 14C11.7348 14 11.4804 14.1054 11.2929 14.2929C11.1054 14.4804 11 14.7348 11 15C11 15.2652 11.1054 15.5196 11.2929 15.7071C11.4804 15.8946 11.7348 16 12 16Z",fill:"currentColor",fillRule:"evenodd"})}),sT=t=>j.jsx("svg",{fill:"none",height:"24",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg",...t,children:j.jsx("path",{d:"M12 22C17.51 22 22 17.51 22 12C22 6.49 17.51 2 12 2C6.49 2 2 6.49 2 12C2 17.51 6.49 22 12 22ZM12.75 16C12.75 16.41 12.41 16.75 12 16.75C11.59 16.75 11.25 16.41 11.25 16L11.25 11C11.25 10.59 11.59 10.25 12 10.25C12.41 10.25 12.75 10.59 12.75 11L12.75 16ZM11.08 7.62C11.13 7.49 11.2 7.39 11.29 7.29C11.39 7.2 11.5 7.13 11.62 7.08C11.74 7.03 11.87 7 12 7C12.13 7 12.26 7.03 12.38 7.08C12.5 7.13 12.61 7.2 12.71 7.29C12.8 7.39 12.87 7.49 12.92 7.62C12.97 7.74 13 7.87 13 8C13 8.13 12.97 8.26 12.92 8.38C12.87 8.5 12.8 8.61 12.71 8.71C12.61 8.8 12.5 8.87 12.38 8.92C12.14 9.02 11.86 9.02 11.62 8.92C11.5 8.87 11.39 8.8 11.29 8.71C11.2 8.61 11.13 8.5 11.08 8.38C11.03 8.26 11 8.13 11 8C11 7.87 11.03 7.74 11.08 7.62Z"})}),PP=t=>j.jsxs("svg",{"aria-hidden":"true",fill:"none",height:"1em",shapeRendering:"geometricPrecision",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",viewBox:"0 0 24 24",width:"1em",...t,children:[j.jsx("circle",{cx:"12",cy:"12",fill:"currentColor",r:"1"}),j.jsx("circle",{cx:"19",cy:"12",fill:"currentColor",r:"1"}),j.jsx("circle",{cx:"5",cy:"12",fill:"currentColor",r:"1"})]}),NP=t=>j.jsxs("svg",{"aria-hidden":"true",fill:"none",focusable:"false",height:"1em",role:"presentation",shapeRendering:"geometricPrecision",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",viewBox:"0 0 24 24",width:"1em",...t,children:[j.jsx("path",{d:"M13 17l5-5-5-5"}),j.jsx("path",{d:"M6 17l5-5-5-5"})]}),LP=t=>j.jsx("svg",{"aria-hidden":"true",fill:"none",focusable:"false",height:"1em",role:"presentation",viewBox:"0 0 24 24",width:"1em",...t,children:j.jsx("path",{d:"M15.5 19l-7-7 7-7",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5"})}),s9=t=>j.jsx("svg",{"aria-hidden":"true",focusable:"false",height:"1em",role:"presentation",viewBox:"0 0 24 24",width:"1em",...t,children:j.jsx("path",{d:"M12 2a10 10 0 1010 10A10.016 10.016 0 0012 2zm3.36 12.3a.754.754 0 010 1.06.748.748 0 01-1.06 0l-2.3-2.3-2.3 2.3a.748.748 0 01-1.06 0 .754.754 0 010-1.06l2.3-2.3-2.3-2.3A.75.75 0 019.7 8.64l2.3 2.3 2.3-2.3a.75.75 0 011.06 1.06l-2.3 2.3z",fill:"currentColor"})}),u0e=t=>{const{isSelected:e,isIndeterminate:n,disableAnimation:r,...i}=t;return j.jsx("svg",{"aria-hidden":"true",className:"fill-current",fill:"none",focusable:"false",height:"1em",role:"presentation",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,viewBox:"0 0 24 24",width:"1em",...i,children:j.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})},f0e=t=>j.jsx("svg",{className:"fill-current",fill:"none",height:"20",viewBox:"0 0 20 20",width:"20",xmlns:"http://www.w3.org/2000/svg",...t,children:j.jsx("path",{d:"M17.51 3.85L11.57 0.42C10.6 -0.14 9.4 -0.14 8.42 0.42L2.49 3.85C1.52 4.41 0.919998 5.45 0.919998 6.58V13.42C0.919998 14.54 1.52 15.58 2.49 16.15L8.43 19.58C9.4 20.14 10.6 20.14 11.58 19.58L17.52 16.15C18.49 15.59 19.09 14.55 19.09 13.42V6.58C19.08 5.45 18.48 4.42 17.51 3.85ZM9.25 5.75C9.25 5.34 9.59 5 10 5C10.41 5 10.75 5.34 10.75 5.75V11C10.75 11.41 10.41 11.75 10 11.75C9.59 11.75 9.25 11.41 9.25 11V5.75ZM10.92 14.63C10.87 14.75 10.8 14.86 10.71 14.96C10.52 15.15 10.27 15.25 10 15.25C9.87 15.25 9.74 15.22 9.62 15.17C9.49 15.12 9.39 15.05 9.29 14.96C9.2 14.86 9.13 14.75 9.07 14.63C9.02 14.51 9 14.38 9 14.25C9 13.99 9.1 13.73 9.29 13.54C9.39 13.45 9.49 13.38 9.62 13.33C9.99 13.17 10.43 13.26 10.71 13.54C10.8 13.64 10.87 13.74 10.92 13.87C10.97 13.99 11 14.12 11 14.25C11 14.38 10.97 14.51 10.92 14.63Z"})}),d0e=({strokeWidth:t=1.5,...e})=>j.jsx("svg",{"aria-hidden":"true",fill:"none",focusable:"false",height:"1em",role:"presentation",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:t,viewBox:"0 0 24 24",width:"1em",...e,children:j.jsx("path",{d:"m6 9 6 6 6-6"})}),h0e=()=>Cm(()=>import("./src-UW24ZMRV-BgB_mmr9.js"),[]).then(t=>t.default),Ij=t=>{const{ripples:e=[],motionProps:n,color:r="currentColor",style:i,onClear:a}=t;return j.jsx(j.Fragment,{children:e.map(o=>{const s=_U(.01*o.size,.2,o.size>100?.75:.5);return j.jsx(_m,{features:h0e,children:j.jsx(ww,{mode:"popLayout",children:j.jsx(Gh.span,{animate:{transform:"scale(2)",opacity:0},className:"heroui-ripple",exit:{opacity:0},initial:{transform:"scale(0)",opacity:.35},style:{position:"absolute",backgroundColor:r,borderRadius:"100%",transformOrigin:"center",pointerEvents:"none",overflow:"hidden",inset:0,zIndex:0,top:o.y,left:o.x,width:`${o.size}px`,height:`${o.size}px`,...i},transition:{duration:s},onAnimationComplete:()=>{a(o.key)},...n})})},o.key)})})};Ij.displayName="HeroUI.Ripple";var p0e=Ij;function g0e(t={}){const[e,n]=H.useState([]),r=H.useCallback(a=>{const o=a.target,s=Math.max(o.clientWidth,o.clientHeight);n(l=>[...l,{key:EU(l.length.toString()),size:s,x:a.x-s/2,y:a.y-s/2}])},[]),i=H.useCallback(a=>{n(o=>o.filter(s=>s.key!==a))},[]);return{ripples:e,onClear:i,onPress:r,...t}}var $E=new Map;typeof FinalizationRegistry<"u"&&new FinalizationRegistry(t=>{$E.delete(t)});function m0e(t,e){if(t===e)return t;let n=$E.get(t);if(n)return n.forEach(i=>i.current=e),e;let r=$E.get(e);return r?(r.forEach(i=>i.current=t),t):e}function v0e(...t){return(...e)=>{for(let n of t)typeof n=="function"&&n(...e)}}function Rj(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(e=0;e<i;e++)t[e]&&(n=Rj(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function y0e(){for(var t,e,n=0,r="",i=arguments.length;n<i;n++)(t=arguments[n])&&(e=Rj(t))&&(r&&(r+=" "),r+=e);return r}var x0e=y0e;function kP(...t){let e={...t[0]};for(let n=1;n<t.length;n++){let r=t[n];for(let i in r){let a=e[i],o=r[i];typeof a=="function"&&typeof o=="function"&&i[0]==="o"&&i[1]==="n"&&i.charCodeAt(2)>=65&&i.charCodeAt(2)<=90?e[i]=v0e(a,o):(i==="className"||i==="UNSAFE_className")&&typeof a=="string"&&typeof o=="string"?e[i]=x0e(a,o):i==="id"&&a&&o?e.id=m0e(a,o):e[i]=o!==void 0?o:a}}return e}var b0e=new Set(["id"]),w0e=new Set(["aria-label","aria-labelledby","aria-describedby","aria-details"]),C0e=new Set(["href","hrefLang","target","rel","download","ping","referrerPolicy"]),S0e=new Set(["dir","lang","hidden","inert","translate"]),VP=new Set(["onClick","onAuxClick","onContextMenu","onDoubleClick","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onTouchCancel","onTouchEnd","onTouchMove","onTouchStart","onPointerDown","onPointerMove","onPointerUp","onPointerCancel","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut","onGotPointerCapture","onLostPointerCapture","onScroll","onWheel","onAnimationStart","onAnimationEnd","onAnimationIteration","onTransitionCancel","onTransitionEnd","onTransitionRun","onTransitionStart"]),T0e=/^(data-.*)$/;function E0e(t,e={}){let{labelable:n,isLink:r,global:i,events:a=i,propNames:o}=e,s={};for(const l in t)Object.prototype.hasOwnProperty.call(t,l)&&(b0e.has(l)||n&&w0e.has(l)||r&&C0e.has(l)||i&&S0e.has(l)||a&&VP.has(l)||l.endsWith("Capture")&&VP.has(l.slice(0,-7))||o?.has(l)||T0e.test(l))&&(s[l]=t[l]);return s}function _0e(t={}){let{autoFocus:e=!1,isTextInput:n,within:r}=t,i=H.useRef({isFocused:!1,isFocusVisible:e||l2()}),[a,o]=H.useState(!1),[s,l]=H.useState(()=>i.current.isFocused&&i.current.isFocusVisible),c=H.useCallback(()=>l(i.current.isFocused&&i.current.isFocusVisible),[]),f=H.useCallback(h=>{i.current.isFocused=h,o(h),c()},[c]);F$(h=>{i.current.isFocusVisible=h,c()},[],{isTextInput:n});let{focusProps:u}=r9({isDisabled:r,onFocusChange:f}),{focusWithinProps:d}=sp({isDisabled:!r,onFocusWithinChange:f});return{isFocused:a,isFocusVisible:s,focusProps:r?d:u}}function D0e(t,e){let{elementType:n="button",isDisabled:r,onPress:i,onPressStart:a,onPressEnd:o,onPressUp:s,onPressChange:l,preventFocusOnPress:c,allowFocusWhenDisabled:f,onClick:u,href:d,target:h,rel:p,type:g="button",allowTextSelectionOnPress:m}=t,y;n==="button"?y={type:g,disabled:r}:y={role:"button",href:n==="a"&&!r?d:void 0,target:n==="a"?h:void 0,type:n==="input"?g:void 0,disabled:n==="input"?r:void 0,"aria-disabled":!r||n==="input"?void 0:r,rel:n==="a"?p:void 0};let{pressProps:v,isPressed:x}=Uf({onClick:u,onPressStart:a,onPressEnd:o,onPressUp:s,onPressChange:l,onPress:i,isDisabled:r,preventFocusOnPress:c,allowTextSelectionOnPress:m,ref:e}),{focusableProps:w}=_w(t,e);f&&(w.tabIndex=r?-1:w.tabIndex);let S=kP(w,v,E0e(t,{labelable:!0}));return{isPressed:x,buttonProps:kP(y,S,{"aria-haspopup":t["aria-haspopup"],"aria-expanded":t["aria-expanded"],"aria-controls":t["aria-controls"],"aria-pressed":t["aria-pressed"],"aria-current":t["aria-current"]})}}var[FGe,O0e]=cw({name:"ButtonGroupContext",strict:!1});function M0e(t){var e,n,r,i,a,o,s,l,c;const f=O0e(),u=es(),d=!!f,{ref:h,as:p,children:g,startContent:m,endContent:y,autoFocus:v,className:x,spinner:w,isLoading:S=!1,disableRipple:T=!1,fullWidth:_=(e=f?.fullWidth)!=null?e:!1,radius:D=f?.radius,size:I=(n=f?.size)!=null?n:"md",color:R=(r=f?.color)!=null?r:"default",variant:M=(i=f?.variant)!=null?i:"solid",disableAnimation:A=(o=(a=f?.disableAnimation)!=null?a:u?.disableAnimation)!=null?o:!1,isDisabled:L=(s=f?.isDisabled)!=null?s:!1,isIconOnly:P=(l=f?.isIconOnly)!=null?l:!1,spinnerPlacement:B="start",onPress:U,onClick:G,...F}=t,$=p||"button",V=typeof $=="string",X=Di(h),Q=(c=T||u?.disableRipple)!=null?c:A,{isFocusVisible:re,isFocused:ye,focusProps:me}=_0e({autoFocus:v}),Ce=L||S,we=H.useMemo(()=>WG({size:I,color:R,variant:M,radius:D,fullWidth:_,isDisabled:Ce,isInGroup:d,disableAnimation:A,isIconOnly:P,className:x}),[I,R,M,D,_,Ce,d,P,A,x]),{onPress:Ae,onClear:De,ripples:q}=g0e(),k=H.useCallback(ge=>{Q||Ce||A||X.current&&Ae(ge)},[Q,Ce,A,X,Ae]),{buttonProps:J,isPressed:Y}=D0e({elementType:p,isDisabled:Ce,onPress:Rf(U,k),onClick:G,...F},X),{isHovered:ie,hoverProps:ue}=Zs({isDisabled:Ce}),fe=H.useCallback((ge={})=>({"data-disabled":Nt(Ce),"data-focus":Nt(ye),"data-pressed":Nt(Y),"data-focus-visible":Nt(re),"data-hover":Nt(ie),"data-loading":Nt(S),...Pn(J,me,ue,Io(F,{enabled:V}),Io(ge)),className:we}),[S,Ce,ye,Y,V,re,ie,J,me,ue,F,we]),Se=ge=>H.isValidElement(ge)?H.cloneElement(ge,{"aria-hidden":!0,focusable:!1}):null,Fe=Se(m),Ke=Se(y),He=H.useMemo(()=>({sm:"sm",md:"sm",lg:"md"})[I],[I]),pe=H.useCallback(()=>({ripples:q,onClear:De}),[q,De]);return{Component:$,children:g,domRef:X,spinner:w,styles:we,startContent:Fe,endContent:Ke,isLoading:S,spinnerPlacement:B,spinnerSize:He,disableRipple:Q,getButtonProps:fe,getRippleProps:pe,isIconOnly:P}}var Aj=Hi((t,e)=>{const{Component:n,domRef:r,children:i,spinnerSize:a,spinner:o=j.jsx(Dw,{color:"current",size:a}),spinnerPlacement:s,startContent:l,endContent:c,isLoading:f,disableRipple:u,getButtonProps:d,getRippleProps:h,isIconOnly:p}=M0e({...t,ref:e});return j.jsxs(n,{ref:r,...d(),children:[l,f&&s==="start"&&o,f&&p?null:i,f&&s==="end"&&o,c,!u&&j.jsx(p0e,{...h()})]})});Aj.displayName="HeroUI.Button";var I0e=Aj,lT={default:sT,primary:sT,secondary:sT,success:l0e,warning:c0e,danger:f0e},Pj=Hi((t,e)=>{const{severity:n,Component:r,icon:i,loadingComponent:a,domRef:o,endContent:s,color:l,hideIcon:c,closeIcon:f,disableAnimation:u,progressBarRef:d,classNames:h,slots:p,getWrapperProps:g,isProgressBarVisible:m,getToastProps:y,getContentProps:v,getTitleProps:x,getDescriptionProps:w,getCloseButtonProps:S,getIconProps:T,getMotionDivProps:_,getCloseIconProps:D,getLoadingComponentProps:I,getSpinnerComponentProps:R,isLoading:M}=o0e({...t,ref:e}),A=typeof i=="function"?i(T()):H.isValidElement(i)&&H.cloneElement(i,T()),L=n?lT[n]:lT[l]||lT.default,P=a&&H.isValidElement(a)?H.cloneElement(a,I()):null,B=M?P||j.jsx(Dw,{...R()}):null,U=typeof f=="function"?f({}):H.isValidElement(f)&&H.cloneElement(f,{}),G=j.jsxs(r,{ref:o,...y(),children:[j.jsxs("div",{...v(),children:[c&&!M?null:B||A||j.jsx(L,{...T()}),j.jsxs("div",{...g(),children:[j.jsx("div",{...x(),children:t.toast.content.title}),j.jsx("div",{...w(),children:t.toast.content.description})]})]}),m&&j.jsx("div",{className:p.progressTrack({class:h?.progressTrack}),children:j.jsx("div",{ref:d,className:p.progressIndicator({class:h?.progressIndicator})})}),j.jsx(I0e,{isIconOnly:!0,...S(),children:U||j.jsx(u0e,{...D()})}),s]});return j.jsx(j.Fragment,{children:u?G:j.jsx(Gh.div,{..._(),children:j.jsx(Gh.div,{animate:{opacity:1},exit:{opacity:0},initial:{opacity:0},transition:{duration:.25,ease:"easeOut",delay:.1},children:G},"inner-div")})})});Pj.displayName="HeroUI.Toast";var R0e=Pj;function A0e({toastQueue:t,placement:e,disableAnimation:n,maxVisibleToasts:r,toastOffset:i,toastProps:a={},className:o,classNames:s,...l}){var c,f;const u=H.useRef(null),{regionProps:d}=i0e(l,t,u),{hoverProps:h,isHovered:p}=Zs({isDisabled:!1}),[g,m]=H.useState(!1),y=H.useMemo(()=>Gde({disableAnimation:n}),[n]),v=ln(s?.base,o);H.useEffect(()=>{function _(D){u.current&&!u.current.contains(D.target)&&m(!1)}return document.addEventListener("touchstart",_),()=>{document.removeEventListener("touchstart",_)}},[]);const[x,w]=H.useState([]),S=(f=(c=t.visibleToasts)==null?void 0:c.length)!=null?f:0,T=H.useCallback(()=>{m(!0)},[]);return j.jsx("div",{...Pn(d,h),ref:u,className:y.base({class:v}),"data-placement":e,onTouchStart:T,children:j.jsx(ww,{children:[...t.visibleToasts].reverse().map((_,D)=>n&&S-D>r?null:n||S-D<=4||p&&S-D<=r+1?j.jsx(R0e,{state:t,toast:_,...Pn(a,_.content),disableAnimation:n,heights:x,index:D,isRegionExpanded:p||g,maxVisibleToasts:r,placement:e,setHeights:w,toastOffset:i,total:S},_.key):null)})})}function P0e(t){let e=H.useCallback(i=>t.subscribe(i),[t]),n=H.useCallback(()=>t.visibleToasts,[t]);return{visibleToasts:_j.useSyncExternalStore(e,n,n),add:(i,a)=>t.add(i,a),close:i=>t.close(i),pauseAll:()=>t.pauseAll(),resumeAll:()=>t.resumeAll()}}class N0e{runWithWrapUpdate(e,n){this.wrapUpdate?this.wrapUpdate(e,n):e()}subscribe(e){return this.subscriptions.add(e),()=>this.subscriptions.delete(e)}add(e,n={}){let r="_"+Math.random().toString(36).slice(2),i={...n,content:e,key:r,timer:n.timeout?new L0e(()=>this.close(r),n.timeout):void 0};return this.queue.unshift(i),this.updateVisibleToasts("add"),r}close(e){let n=this.queue.findIndex(a=>a.key===e);if(n>=0){var r,i;(r=(i=this.queue[n]).onClose)===null||r===void 0||r.call(i),this.queue.splice(n,1)}this.updateVisibleToasts("remove")}updateVisibleToasts(e){this.visibleToasts=this.queue.slice(0,this.maxVisibleToasts),this.runWithWrapUpdate(()=>{for(let n of this.subscriptions)n()},e)}pauseAll(){for(let e of this.visibleToasts)e.timer&&e.timer.pause()}resumeAll(){for(let e of this.visibleToasts)e.timer&&e.timer.resume()}clear(){this.queue=[],this.updateVisibleToasts("clear")}constructor(e){this.queue=[],this.subscriptions=new Set,this.visibleToasts=[];var n;this.maxVisibleToasts=(n=e?.maxVisibleToasts)!==null&&n!==void 0?n:1/0,this.wrapUpdate=e?.wrapUpdate}}class L0e{reset(e){this.remaining=e,this.resume()}pause(){this.timerId!=null&&(clearTimeout(this.timerId),this.timerId=null,this.remaining-=Date.now()-this.startTime)}resume(){this.remaining<=0||(this.startTime=Date.now(),this.timerId=setTimeout(()=>{this.timerId=null,this.remaining=0,this.callback()},this.remaining))}constructor(e,n){this.startTime=null,this.remaining=n,this.callback=e}}var k0e=()=>Cm(()=>import("./index-CRDEnqP7.js"),[]).then(t=>t.domMax),Av=null,V0e=()=>(Av||(Av=new N0e({maxVisibleToasts:1/0})),Av),F0e=({placement:t="bottom-right",disableAnimation:e=!1,maxVisibleToasts:n=3,toastOffset:r=0,toastProps:i={},regionProps:a})=>{var o;const s=P0e(V0e()),l=es(),c=(o=e??l?.disableAnimation)!=null?o:!1;return j.jsx(_m,{features:k0e,children:s.visibleToasts.length>0&&j.jsx(A0e,{disableAnimation:c,maxVisibleToasts:n,placement:t,toastOffset:r,toastProps:i,toastQueue:s,...a})})},Vt=({...t})=>Av?Av.add(t):null;const FP=t=>{let e;const n=new Set,r=(c,f)=>{const u=typeof c=="function"?c(e):c;if(!Object.is(u,e)){const d=e;e=f??(typeof u!="object"||u===null)?u:Object.assign({},e,u),n.forEach(h=>h(e,d))}},i=()=>e,s={setState:r,getState:i,getInitialState:()=>l,subscribe:c=>(n.add(c),()=>n.delete(c))},l=e=t(r,i,s);return s},U0e=(t=>t?FP(t):FP),B0e=t=>t;function $0e(t,e=B0e){const n=Tn.useSyncExternalStore(t.subscribe,Tn.useCallback(()=>e(t.getState()),[t,e]),Tn.useCallback(()=>e(t.getInitialState()),[t,e]));return Tn.useDebugValue(n),n}const G0e=t=>{const e=U0e(t),n=r=>$0e(e,r);return Object.assign(n,e),n},j0e=(t=>G0e),UP={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1},c2=new Map,$5=t=>{const e=c2.get(t);return e?Object.fromEntries(Object.entries(e.stores).map(([n,r])=>[n,r.getState()])):{}},z0e=(t,e,n)=>{if(t===void 0)return{type:"untracked",connection:e.connect(n)};const r=c2.get(n.name);if(r)return{type:"tracked",store:t,...r};const i={connection:e.connect(n),stores:{}};return c2.set(n.name,i),{type:"tracked",store:t,...i}},W0e=(t,e)=>{if(e===void 0)return;const n=c2.get(t);n&&(delete n.stores[e],Object.keys(n.stores).length===0&&c2.delete(t))},H0e=t=>{var e,n;if(!t)return;const r=t.split(`
`),i=r.findIndex(o=>o.includes("api.setState"));if(i<0)return;const a=((e=r[i+1])==null?void 0:e.trim())||"";return(n=/.+ (.+) .+/.exec(a))==null?void 0:n[1]},K0e=(t,e={})=>(n,r,i)=>{const{enabled:a,anonymousActionType:o,store:s,...l}=e;let c;try{c=(a??(UP?"production":void 0)!=="production")&&window.__REDUX_DEVTOOLS_EXTENSION__}catch{}if(!c)return t(n,r,i);const{connection:f,...u}=z0e(s,c,l);let d=!0;i.setState=((g,m,y)=>{const v=n(g,m);if(!d)return v;const x=y===void 0?{type:o||H0e(new Error().stack)||"anonymous"}:typeof y=="string"?{type:y}:y;return s===void 0?(f?.send(x,r()),v):(f?.send({...x,type:`${s}/${x.type}`},{...$5(l.name),[s]:i.getState()}),v)}),i.devtools={cleanup:()=>{f&&typeof f.unsubscribe=="function"&&f.unsubscribe(),W0e(l.name,s)}};const h=(...g)=>{const m=d;d=!1,n(...g),d=m},p=t(i.setState,r,i);if(u.type==="untracked"?f?.init(p):(u.stores[u.store]=i,f?.init(Object.fromEntries(Object.entries(u.stores).map(([g,m])=>[g,g===u.store?p:m.getState()])))),i.dispatchFromDevtools&&typeof i.dispatch=="function"){let g=!1;const m=i.dispatch;i.dispatch=(...y)=>{(UP?"production":void 0)!=="production"&&y[0].type==="__setState"&&!g&&(console.warn('[zustand devtools middleware] "__setState" action type is reserved to set state from the devtools. Avoid using it.'),g=!0),m(...y)}}return f.subscribe(g=>{var m;switch(g.type){case"ACTION":if(typeof g.payload!="string"){console.error("[zustand devtools middleware] Unsupported action format");return}return cT(g.payload,y=>{if(y.type==="__setState"){if(s===void 0){h(y.state);return}Object.keys(y.state).length!==1&&console.error(`
                    [zustand devtools middleware] Unsupported __setState action format.
                    When using 'store' option in devtools(), the 'state' should have only one key, which is a value of 'store' that was passed in devtools(),
                    and value of this only key should be a state object. Example: { "type": "__setState", "state": { "abc123Store": { "foo": "bar" } } }
                    `);const v=y.state[s];if(v==null)return;JSON.stringify(i.getState())!==JSON.stringify(v)&&h(v);return}i.dispatchFromDevtools&&typeof i.dispatch=="function"&&i.dispatch(y)});case"DISPATCH":switch(g.payload.type){case"RESET":return h(p),s===void 0?f?.init(i.getState()):f?.init($5(l.name));case"COMMIT":if(s===void 0){f?.init(i.getState());return}return f?.init($5(l.name));case"ROLLBACK":return cT(g.state,y=>{if(s===void 0){h(y),f?.init(i.getState());return}h(y[s]),f?.init($5(l.name))});case"JUMP_TO_STATE":case"JUMP_TO_ACTION":return cT(g.state,y=>{if(s===void 0){h(y);return}JSON.stringify(i.getState())!==JSON.stringify(y[s])&&h(y[s])});case"IMPORT_STATE":{const{nextLiftedState:y}=g.payload,v=(m=y.computedStates.slice(-1)[0])==null?void 0:m.state;if(!v)return;h(s===void 0?v:v[s]),f?.send(null,y);return}case"PAUSE_RECORDING":return d=!d}return}}),p},q0e=K0e,cT=(t,e)=>{let n;try{n=JSON.parse(t)}catch(r){console.error("[zustand devtools middleware] Could not parse the received json",r)}n!==void 0&&e(n)};function X0e(t,e){let n;try{n=t()}catch{return}return{getItem:i=>{var a;const o=l=>l===null?null:JSON.parse(l,void 0),s=(a=n.getItem(i))!=null?a:null;return s instanceof Promise?s.then(o):o(s)},setItem:(i,a)=>n.setItem(i,JSON.stringify(a,void 0)),removeItem:i=>n.removeItem(i)}}const GE=t=>e=>{try{const n=t(e);return n instanceof Promise?n:{then(r){return GE(r)(n)},catch(r){return this}}}catch(n){return{then(r){return this},catch(r){return GE(r)(n)}}}},Y0e=(t,e)=>(n,r,i)=>{let a={storage:X0e(()=>localStorage),partialize:g=>g,version:0,merge:(g,m)=>({...m,...g}),...e},o=!1;const s=new Set,l=new Set;let c=a.storage;if(!c)return t((...g)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),n(...g)},r,i);const f=()=>{const g=a.partialize({...r()});return c.setItem(a.name,{state:g,version:a.version})},u=i.setState;i.setState=(g,m)=>(u(g,m),f());const d=t((...g)=>(n(...g),f()),r,i);i.getInitialState=()=>d;let h;const p=()=>{var g,m;if(!c)return;o=!1,s.forEach(v=>{var x;return v((x=r())!=null?x:d)});const y=((m=a.onRehydrateStorage)==null?void 0:m.call(a,(g=r())!=null?g:d))||void 0;return GE(c.getItem.bind(c))(a.name).then(v=>{if(v)if(typeof v.version=="number"&&v.version!==a.version){if(a.migrate){const x=a.migrate(v.state,v.version);return x instanceof Promise?x.then(w=>[!0,w]):[!0,x]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,v.state];return[!1,void 0]}).then(v=>{var x;const[w,S]=v;if(h=a.merge(S,(x=r())!=null?x:d),n(h,!0),w)return f()}).then(()=>{y?.(h,void 0),h=r(),o=!0,l.forEach(v=>v(h))}).catch(v=>{y?.(void 0,v)})};return i.persist={setOptions:g=>{a={...a,...g},g.storage&&(c=g.storage)},clearStorage:()=>{c?.removeItem(a.name)},getOptions:()=>a,rehydrate:()=>p(),hasHydrated:()=>o,onHydrate:g=>(s.add(g),()=>{s.delete(g)}),onFinishHydration:g=>(l.add(g),()=>{l.delete(g)})},a.skipHydration||p(),h||d},J0e=Y0e;function Nj(t,e){return function(){return t.apply(e,arguments)}}const{toString:Z0e}=Object.prototype,{getPrototypeOf:l9}=Object,{iterator:Ow,toStringTag:Lj}=Symbol,Mw=(t=>e=>{const n=Z0e.call(e);return t[n]||(t[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),wc=t=>(t=t.toLowerCase(),e=>Mw(e)===t),Iw=t=>e=>typeof e===t,{isArray:Mm}=Array,u2=Iw("undefined");function K2(t){return t!==null&&!u2(t)&&t.constructor!==null&&!u2(t.constructor)&&Ts(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const kj=wc("ArrayBuffer");function Q0e(t){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&kj(t.buffer),e}const ehe=Iw("string"),Ts=Iw("function"),Vj=Iw("number"),q2=t=>t!==null&&typeof t=="object",the=t=>t===!0||t===!1,Hx=t=>{if(Mw(t)!=="object")return!1;const e=l9(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Lj in t)&&!(Ow in t)},nhe=t=>{if(!q2(t)||K2(t))return!1;try{return Object.keys(t).length===0&&Object.getPrototypeOf(t)===Object.prototype}catch{return!1}},rhe=wc("Date"),ihe=wc("File"),ahe=wc("Blob"),ohe=wc("FileList"),she=t=>q2(t)&&Ts(t.pipe),lhe=t=>{let e;return t&&(typeof FormData=="function"&&t instanceof FormData||Ts(t.append)&&((e=Mw(t))==="formdata"||e==="object"&&Ts(t.toString)&&t.toString()==="[object FormData]"))},che=wc("URLSearchParams"),[uhe,fhe,dhe,hhe]=["ReadableStream","Request","Response","Headers"].map(wc),phe=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function X2(t,e,{allOwnKeys:n=!1}={}){if(t===null||typeof t>"u")return;let r,i;if(typeof t!="object"&&(t=[t]),Mm(t))for(r=0,i=t.length;r<i;r++)e.call(null,t[r],r,t);else{if(K2(t))return;const a=n?Object.getOwnPropertyNames(t):Object.keys(t),o=a.length;let s;for(r=0;r<o;r++)s=a[r],e.call(null,t[s],s,t)}}function Fj(t,e){if(K2(t))return null;e=e.toLowerCase();const n=Object.keys(t);let r=n.length,i;for(;r-- >0;)if(i=n[r],e===i.toLowerCase())return i;return null}const Eh=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Uj=t=>!u2(t)&&t!==Eh;function jE(){const{caseless:t}=Uj(this)&&this||{},e={},n=(r,i)=>{const a=t&&Fj(e,i)||i;Hx(e[a])&&Hx(r)?e[a]=jE(e[a],r):Hx(r)?e[a]=jE({},r):Mm(r)?e[a]=r.slice():e[a]=r};for(let r=0,i=arguments.length;r<i;r++)arguments[r]&&X2(arguments[r],n);return e}const ghe=(t,e,n,{allOwnKeys:r}={})=>(X2(e,(i,a)=>{n&&Ts(i)?t[a]=Nj(i,n):t[a]=i},{allOwnKeys:r}),t),mhe=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),vhe=(t,e,n,r)=>{t.prototype=Object.create(e.prototype,r),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),n&&Object.assign(t.prototype,n)},yhe=(t,e,n,r)=>{let i,a,o;const s={};if(e=e||{},t==null)return e;do{for(i=Object.getOwnPropertyNames(t),a=i.length;a-- >0;)o=i[a],(!r||r(o,t,e))&&!s[o]&&(e[o]=t[o],s[o]=!0);t=n!==!1&&l9(t)}while(t&&(!n||n(t,e))&&t!==Object.prototype);return e},xhe=(t,e,n)=>{t=String(t),(n===void 0||n>t.length)&&(n=t.length),n-=e.length;const r=t.indexOf(e,n);return r!==-1&&r===n},bhe=t=>{if(!t)return null;if(Mm(t))return t;let e=t.length;if(!Vj(e))return null;const n=new Array(e);for(;e-- >0;)n[e]=t[e];return n},whe=(t=>e=>t&&e instanceof t)(typeof Uint8Array<"u"&&l9(Uint8Array)),Che=(t,e)=>{const r=(t&&t[Ow]).call(t);let i;for(;(i=r.next())&&!i.done;){const a=i.value;e.call(t,a[0],a[1])}},She=(t,e)=>{let n;const r=[];for(;(n=t.exec(e))!==null;)r.push(n);return r},The=wc("HTMLFormElement"),Ehe=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,r,i){return r.toUpperCase()+i}),BP=(({hasOwnProperty:t})=>(e,n)=>t.call(e,n))(Object.prototype),_he=wc("RegExp"),Bj=(t,e)=>{const n=Object.getOwnPropertyDescriptors(t),r={};X2(n,(i,a)=>{let o;(o=e(i,a,t))!==!1&&(r[a]=o||i)}),Object.defineProperties(t,r)},Dhe=t=>{Bj(t,(e,n)=>{if(Ts(t)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const r=t[n];if(Ts(r)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},Ohe=(t,e)=>{const n={},r=i=>{i.forEach(a=>{n[a]=!0})};return Mm(t)?r(t):r(String(t).split(e)),n},Mhe=()=>{},Ihe=(t,e)=>t!=null&&Number.isFinite(t=+t)?t:e;function Rhe(t){return!!(t&&Ts(t.append)&&t[Lj]==="FormData"&&t[Ow])}const Ahe=t=>{const e=new Array(10),n=(r,i)=>{if(q2(r)){if(e.indexOf(r)>=0)return;if(K2(r))return r;if(!("toJSON"in r)){e[i]=r;const a=Mm(r)?[]:{};return X2(r,(o,s)=>{const l=n(o,i+1);!u2(l)&&(a[s]=l)}),e[i]=void 0,a}}return r};return n(t,0)},Phe=wc("AsyncFunction"),Nhe=t=>t&&(q2(t)||Ts(t))&&Ts(t.then)&&Ts(t.catch),$j=((t,e)=>t?setImmediate:e?((n,r)=>(Eh.addEventListener("message",({source:i,data:a})=>{i===Eh&&a===n&&r.length&&r.shift()()},!1),i=>{r.push(i),Eh.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",Ts(Eh.postMessage)),Lhe=typeof queueMicrotask<"u"?queueMicrotask.bind(Eh):typeof process<"u"&&process.nextTick||$j,khe=t=>t!=null&&Ts(t[Ow]),ft={isArray:Mm,isArrayBuffer:kj,isBuffer:K2,isFormData:lhe,isArrayBufferView:Q0e,isString:ehe,isNumber:Vj,isBoolean:the,isObject:q2,isPlainObject:Hx,isEmptyObject:nhe,isReadableStream:uhe,isRequest:fhe,isResponse:dhe,isHeaders:hhe,isUndefined:u2,isDate:rhe,isFile:ihe,isBlob:ahe,isRegExp:_he,isFunction:Ts,isStream:she,isURLSearchParams:che,isTypedArray:whe,isFileList:ohe,forEach:X2,merge:jE,extend:ghe,trim:phe,stripBOM:mhe,inherits:vhe,toFlatObject:yhe,kindOf:Mw,kindOfTest:wc,endsWith:xhe,toArray:bhe,forEachEntry:Che,matchAll:She,isHTMLForm:The,hasOwnProperty:BP,hasOwnProp:BP,reduceDescriptors:Bj,freezeMethods:Dhe,toObjectSet:Ohe,toCamelCase:Ehe,noop:Mhe,toFiniteNumber:Ihe,findKey:Fj,global:Eh,isContextDefined:Uj,isSpecCompliantForm:Rhe,toJSONObject:Ahe,isAsyncFn:Phe,isThenable:Nhe,setImmediate:$j,asap:Lhe,isIterable:khe};function Ln(t,e,n,r,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",e&&(this.code=e),n&&(this.config=n),r&&(this.request=r),i&&(this.response=i,this.status=i.status?i.status:null)}ft.inherits(Ln,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:ft.toJSONObject(this.config),code:this.code,status:this.status}}});const Gj=Ln.prototype,jj={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{jj[t]={value:t}});Object.defineProperties(Ln,jj);Object.defineProperty(Gj,"isAxiosError",{value:!0});Ln.from=(t,e,n,r,i,a)=>{const o=Object.create(Gj);return ft.toFlatObject(t,o,function(l){return l!==Error.prototype},s=>s!=="isAxiosError"),Ln.call(o,t.message,e,n,r,i),o.cause=t,o.name=t.name,a&&Object.assign(o,a),o};const Vhe=null;function zE(t){return ft.isPlainObject(t)||ft.isArray(t)}function zj(t){return ft.endsWith(t,"[]")?t.slice(0,-2):t}function $P(t,e,n){return t?t.concat(e).map(function(i,a){return i=zj(i),!n&&a?"["+i+"]":i}).join(n?".":""):e}function Fhe(t){return ft.isArray(t)&&!t.some(zE)}const Uhe=ft.toFlatObject(ft,{},null,function(e){return/^is[A-Z]/.test(e)});function Rw(t,e,n){if(!ft.isObject(t))throw new TypeError("target must be an object");e=e||new FormData,n=ft.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(g,m){return!ft.isUndefined(m[g])});const r=n.metaTokens,i=n.visitor||f,a=n.dots,o=n.indexes,l=(n.Blob||typeof Blob<"u"&&Blob)&&ft.isSpecCompliantForm(e);if(!ft.isFunction(i))throw new TypeError("visitor must be a function");function c(p){if(p===null)return"";if(ft.isDate(p))return p.toISOString();if(ft.isBoolean(p))return p.toString();if(!l&&ft.isBlob(p))throw new Ln("Blob is not supported. Use a Buffer instead.");return ft.isArrayBuffer(p)||ft.isTypedArray(p)?l&&typeof Blob=="function"?new Blob([p]):Buffer.from(p):p}function f(p,g,m){let y=p;if(p&&!m&&typeof p=="object"){if(ft.endsWith(g,"{}"))g=r?g:g.slice(0,-2),p=JSON.stringify(p);else if(ft.isArray(p)&&Fhe(p)||(ft.isFileList(p)||ft.endsWith(g,"[]"))&&(y=ft.toArray(p)))return g=zj(g),y.forEach(function(x,w){!(ft.isUndefined(x)||x===null)&&e.append(o===!0?$P([g],w,a):o===null?g:g+"[]",c(x))}),!1}return zE(p)?!0:(e.append($P(m,g,a),c(p)),!1)}const u=[],d=Object.assign(Uhe,{defaultVisitor:f,convertValue:c,isVisitable:zE});function h(p,g){if(!ft.isUndefined(p)){if(u.indexOf(p)!==-1)throw Error("Circular reference detected in "+g.join("."));u.push(p),ft.forEach(p,function(y,v){(!(ft.isUndefined(y)||y===null)&&i.call(e,y,ft.isString(v)?v.trim():v,g,d))===!0&&h(y,g?g.concat(v):[v])}),u.pop()}}if(!ft.isObject(t))throw new TypeError("data must be an object");return h(t),e}function GP(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(r){return e[r]})}function c9(t,e){this._pairs=[],t&&Rw(t,this,e)}const Wj=c9.prototype;Wj.append=function(e,n){this._pairs.push([e,n])};Wj.toString=function(e){const n=e?function(r){return e.call(this,r,GP)}:GP;return this._pairs.map(function(i){return n(i[0])+"="+n(i[1])},"").join("&")};function Bhe(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Hj(t,e,n){if(!e)return t;const r=n&&n.encode||Bhe;ft.isFunction(n)&&(n={serialize:n});const i=n&&n.serialize;let a;if(i?a=i(e,n):a=ft.isURLSearchParams(e)?e.toString():new c9(e,n).toString(r),a){const o=t.indexOf("#");o!==-1&&(t=t.slice(0,o)),t+=(t.indexOf("?")===-1?"?":"&")+a}return t}class jP{constructor(){this.handlers=[]}use(e,n,r){return this.handlers.push({fulfilled:e,rejected:n,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){ft.forEach(this.handlers,function(r){r!==null&&e(r)})}}const Kj={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},$he=typeof URLSearchParams<"u"?URLSearchParams:c9,Ghe=typeof FormData<"u"?FormData:null,jhe=typeof Blob<"u"?Blob:null,zhe={isBrowser:!0,classes:{URLSearchParams:$he,FormData:Ghe,Blob:jhe},protocols:["http","https","file","blob","url","data"]},u9=typeof window<"u"&&typeof document<"u",WE=typeof navigator=="object"&&navigator||void 0,Whe=u9&&(!WE||["ReactNative","NativeScript","NS"].indexOf(WE.product)<0),Hhe=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",Khe=u9&&window.location.href||"http://localhost",qhe=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:u9,hasStandardBrowserEnv:Whe,hasStandardBrowserWebWorkerEnv:Hhe,navigator:WE,origin:Khe},Symbol.toStringTag,{value:"Module"})),Eo={...qhe,...zhe};function Xhe(t,e){return Rw(t,new Eo.classes.URLSearchParams,{visitor:function(n,r,i,a){return Eo.isNode&&ft.isBuffer(n)?(this.append(r,n.toString("base64")),!1):a.defaultVisitor.apply(this,arguments)},...e})}function Yhe(t){return ft.matchAll(/\w+|\[(\w*)]/g,t).map(e=>e[0]==="[]"?"":e[1]||e[0])}function Jhe(t){const e={},n=Object.keys(t);let r;const i=n.length;let a;for(r=0;r<i;r++)a=n[r],e[a]=t[a];return e}function qj(t){function e(n,r,i,a){let o=n[a++];if(o==="__proto__")return!0;const s=Number.isFinite(+o),l=a>=n.length;return o=!o&&ft.isArray(i)?i.length:o,l?(ft.hasOwnProp(i,o)?i[o]=[i[o],r]:i[o]=r,!s):((!i[o]||!ft.isObject(i[o]))&&(i[o]=[]),e(n,r,i[o],a)&&ft.isArray(i[o])&&(i[o]=Jhe(i[o])),!s)}if(ft.isFormData(t)&&ft.isFunction(t.entries)){const n={};return ft.forEachEntry(t,(r,i)=>{e(Yhe(r),i,n,0)}),n}return null}function Zhe(t,e,n){if(ft.isString(t))try{return(e||JSON.parse)(t),ft.trim(t)}catch(r){if(r.name!=="SyntaxError")throw r}return(n||JSON.stringify)(t)}const Y2={transitional:Kj,adapter:["xhr","http","fetch"],transformRequest:[function(e,n){const r=n.getContentType()||"",i=r.indexOf("application/json")>-1,a=ft.isObject(e);if(a&&ft.isHTMLForm(e)&&(e=new FormData(e)),ft.isFormData(e))return i?JSON.stringify(qj(e)):e;if(ft.isArrayBuffer(e)||ft.isBuffer(e)||ft.isStream(e)||ft.isFile(e)||ft.isBlob(e)||ft.isReadableStream(e))return e;if(ft.isArrayBufferView(e))return e.buffer;if(ft.isURLSearchParams(e))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let s;if(a){if(r.indexOf("application/x-www-form-urlencoded")>-1)return Xhe(e,this.formSerializer).toString();if((s=ft.isFileList(e))||r.indexOf("multipart/form-data")>-1){const l=this.env&&this.env.FormData;return Rw(s?{"files[]":e}:e,l&&new l,this.formSerializer)}}return a||i?(n.setContentType("application/json",!1),Zhe(e)):e}],transformResponse:[function(e){const n=this.transitional||Y2.transitional,r=n&&n.forcedJSONParsing,i=this.responseType==="json";if(ft.isResponse(e)||ft.isReadableStream(e))return e;if(e&&ft.isString(e)&&(r&&!this.responseType||i)){const o=!(n&&n.silentJSONParsing)&&i;try{return JSON.parse(e)}catch(s){if(o)throw s.name==="SyntaxError"?Ln.from(s,Ln.ERR_BAD_RESPONSE,this,null,this.response):s}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Eo.classes.FormData,Blob:Eo.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};ft.forEach(["delete","get","head","post","put","patch"],t=>{Y2.headers[t]={}});const Qhe=ft.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),epe=t=>{const e={};let n,r,i;return t&&t.split(`
`).forEach(function(o){i=o.indexOf(":"),n=o.substring(0,i).trim().toLowerCase(),r=o.substring(i+1).trim(),!(!n||e[n]&&Qhe[n])&&(n==="set-cookie"?e[n]?e[n].push(r):e[n]=[r]:e[n]=e[n]?e[n]+", "+r:r)}),e},zP=Symbol("internals");function G1(t){return t&&String(t).trim().toLowerCase()}function Kx(t){return t===!1||t==null?t:ft.isArray(t)?t.map(Kx):String(t)}function tpe(t){const e=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(t);)e[r[1]]=r[2];return e}const npe=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function uT(t,e,n,r,i){if(ft.isFunction(r))return r.call(this,e,n);if(i&&(e=n),!!ft.isString(e)){if(ft.isString(r))return e.indexOf(r)!==-1;if(ft.isRegExp(r))return r.test(e)}}function rpe(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,n,r)=>n.toUpperCase()+r)}function ipe(t,e){const n=ft.toCamelCase(" "+e);["get","set","has"].forEach(r=>{Object.defineProperty(t,r+n,{value:function(i,a,o){return this[r].call(this,e,i,a,o)},configurable:!0})})}let Es=class{constructor(e){e&&this.set(e)}set(e,n,r){const i=this;function a(s,l,c){const f=G1(l);if(!f)throw new Error("header name must be a non-empty string");const u=ft.findKey(i,f);(!u||i[u]===void 0||c===!0||c===void 0&&i[u]!==!1)&&(i[u||l]=Kx(s))}const o=(s,l)=>ft.forEach(s,(c,f)=>a(c,f,l));if(ft.isPlainObject(e)||e instanceof this.constructor)o(e,n);else if(ft.isString(e)&&(e=e.trim())&&!npe(e))o(epe(e),n);else if(ft.isObject(e)&&ft.isIterable(e)){let s={},l,c;for(const f of e){if(!ft.isArray(f))throw TypeError("Object iterator must return a key-value pair");s[c=f[0]]=(l=s[c])?ft.isArray(l)?[...l,f[1]]:[l,f[1]]:f[1]}o(s,n)}else e!=null&&a(n,e,r);return this}get(e,n){if(e=G1(e),e){const r=ft.findKey(this,e);if(r){const i=this[r];if(!n)return i;if(n===!0)return tpe(i);if(ft.isFunction(n))return n.call(this,i,r);if(ft.isRegExp(n))return n.exec(i);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,n){if(e=G1(e),e){const r=ft.findKey(this,e);return!!(r&&this[r]!==void 0&&(!n||uT(this,this[r],r,n)))}return!1}delete(e,n){const r=this;let i=!1;function a(o){if(o=G1(o),o){const s=ft.findKey(r,o);s&&(!n||uT(r,r[s],s,n))&&(delete r[s],i=!0)}}return ft.isArray(e)?e.forEach(a):a(e),i}clear(e){const n=Object.keys(this);let r=n.length,i=!1;for(;r--;){const a=n[r];(!e||uT(this,this[a],a,e,!0))&&(delete this[a],i=!0)}return i}normalize(e){const n=this,r={};return ft.forEach(this,(i,a)=>{const o=ft.findKey(r,a);if(o){n[o]=Kx(i),delete n[a];return}const s=e?rpe(a):String(a).trim();s!==a&&delete n[a],n[s]=Kx(i),r[s]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const n=Object.create(null);return ft.forEach(this,(r,i)=>{r!=null&&r!==!1&&(n[i]=e&&ft.isArray(r)?r.join(", "):r)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,n])=>e+": "+n).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...n){const r=new this(e);return n.forEach(i=>r.set(i)),r}static accessor(e){const r=(this[zP]=this[zP]={accessors:{}}).accessors,i=this.prototype;function a(o){const s=G1(o);r[s]||(ipe(i,o),r[s]=!0)}return ft.isArray(e)?e.forEach(a):a(e),this}};Es.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);ft.reduceDescriptors(Es.prototype,({value:t},e)=>{let n=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(r){this[n]=r}}});ft.freezeMethods(Es);function fT(t,e){const n=this||Y2,r=e||n,i=Es.from(r.headers);let a=r.data;return ft.forEach(t,function(s){a=s.call(n,a,i.normalize(),e?e.status:void 0)}),i.normalize(),a}function Xj(t){return!!(t&&t.__CANCEL__)}function Im(t,e,n){Ln.call(this,t??"canceled",Ln.ERR_CANCELED,e,n),this.name="CanceledError"}ft.inherits(Im,Ln,{__CANCEL__:!0});function Yj(t,e,n){const r=n.config.validateStatus;!n.status||!r||r(n.status)?t(n):e(new Ln("Request failed with status code "+n.status,[Ln.ERR_BAD_REQUEST,Ln.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function ape(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}function ope(t,e){t=t||10;const n=new Array(t),r=new Array(t);let i=0,a=0,o;return e=e!==void 0?e:1e3,function(l){const c=Date.now(),f=r[a];o||(o=c),n[i]=l,r[i]=c;let u=a,d=0;for(;u!==i;)d+=n[u++],u=u%t;if(i=(i+1)%t,i===a&&(a=(a+1)%t),c-o<e)return;const h=f&&c-f;return h?Math.round(d*1e3/h):void 0}}function spe(t,e){let n=0,r=1e3/e,i,a;const o=(c,f=Date.now())=>{n=f,i=null,a&&(clearTimeout(a),a=null),t(...c)};return[(...c)=>{const f=Date.now(),u=f-n;u>=r?o(c,f):(i=c,a||(a=setTimeout(()=>{a=null,o(i)},r-u)))},()=>i&&o(i)]}const Kb=(t,e,n=3)=>{let r=0;const i=ope(50,250);return spe(a=>{const o=a.loaded,s=a.lengthComputable?a.total:void 0,l=o-r,c=i(l),f=o<=s;r=o;const u={loaded:o,total:s,progress:s?o/s:void 0,bytes:l,rate:c||void 0,estimated:c&&s&&f?(s-o)/c:void 0,event:a,lengthComputable:s!=null,[e?"download":"upload"]:!0};t(u)},n)},WP=(t,e)=>{const n=t!=null;return[r=>e[0]({lengthComputable:n,total:t,loaded:r}),e[1]]},HP=t=>(...e)=>ft.asap(()=>t(...e)),lpe=Eo.hasStandardBrowserEnv?((t,e)=>n=>(n=new URL(n,Eo.origin),t.protocol===n.protocol&&t.host===n.host&&(e||t.port===n.port)))(new URL(Eo.origin),Eo.navigator&&/(msie|trident)/i.test(Eo.navigator.userAgent)):()=>!0,cpe=Eo.hasStandardBrowserEnv?{write(t,e,n,r,i,a){const o=[t+"="+encodeURIComponent(e)];ft.isNumber(n)&&o.push("expires="+new Date(n).toGMTString()),ft.isString(r)&&o.push("path="+r),ft.isString(i)&&o.push("domain="+i),a===!0&&o.push("secure"),document.cookie=o.join("; ")},read(t){const e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function upe(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function fpe(t,e){return e?t.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):t}function Jj(t,e,n){let r=!upe(e);return t&&(r||n==!1)?fpe(t,e):e}const KP=t=>t instanceof Es?{...t}:t;function Wh(t,e){e=e||{};const n={};function r(c,f,u,d){return ft.isPlainObject(c)&&ft.isPlainObject(f)?ft.merge.call({caseless:d},c,f):ft.isPlainObject(f)?ft.merge({},f):ft.isArray(f)?f.slice():f}function i(c,f,u,d){if(ft.isUndefined(f)){if(!ft.isUndefined(c))return r(void 0,c,u,d)}else return r(c,f,u,d)}function a(c,f){if(!ft.isUndefined(f))return r(void 0,f)}function o(c,f){if(ft.isUndefined(f)){if(!ft.isUndefined(c))return r(void 0,c)}else return r(void 0,f)}function s(c,f,u){if(u in e)return r(c,f);if(u in t)return r(void 0,c)}const l={url:a,method:a,data:a,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:s,headers:(c,f,u)=>i(KP(c),KP(f),u,!0)};return ft.forEach(Object.keys({...t,...e}),function(f){const u=l[f]||i,d=u(t[f],e[f],f);ft.isUndefined(d)&&u!==s||(n[f]=d)}),n}const Zj=t=>{const e=Wh({},t);let{data:n,withXSRFToken:r,xsrfHeaderName:i,xsrfCookieName:a,headers:o,auth:s}=e;e.headers=o=Es.from(o),e.url=Hj(Jj(e.baseURL,e.url,e.allowAbsoluteUrls),t.params,t.paramsSerializer),s&&o.set("Authorization","Basic "+btoa((s.username||"")+":"+(s.password?unescape(encodeURIComponent(s.password)):"")));let l;if(ft.isFormData(n)){if(Eo.hasStandardBrowserEnv||Eo.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if((l=o.getContentType())!==!1){const[c,...f]=l?l.split(";").map(u=>u.trim()).filter(Boolean):[];o.setContentType([c||"multipart/form-data",...f].join("; "))}}if(Eo.hasStandardBrowserEnv&&(r&&ft.isFunction(r)&&(r=r(e)),r||r!==!1&&lpe(e.url))){const c=i&&a&&cpe.read(a);c&&o.set(i,c)}return e},dpe=typeof XMLHttpRequest<"u",hpe=dpe&&function(t){return new Promise(function(n,r){const i=Zj(t);let a=i.data;const o=Es.from(i.headers).normalize();let{responseType:s,onUploadProgress:l,onDownloadProgress:c}=i,f,u,d,h,p;function g(){h&&h(),p&&p(),i.cancelToken&&i.cancelToken.unsubscribe(f),i.signal&&i.signal.removeEventListener("abort",f)}let m=new XMLHttpRequest;m.open(i.method.toUpperCase(),i.url,!0),m.timeout=i.timeout;function y(){if(!m)return;const x=Es.from("getAllResponseHeaders"in m&&m.getAllResponseHeaders()),S={data:!s||s==="text"||s==="json"?m.responseText:m.response,status:m.status,statusText:m.statusText,headers:x,config:t,request:m};Yj(function(_){n(_),g()},function(_){r(_),g()},S),m=null}"onloadend"in m?m.onloadend=y:m.onreadystatechange=function(){!m||m.readyState!==4||m.status===0&&!(m.responseURL&&m.responseURL.indexOf("file:")===0)||setTimeout(y)},m.onabort=function(){m&&(r(new Ln("Request aborted",Ln.ECONNABORTED,t,m)),m=null)},m.onerror=function(){r(new Ln("Network Error",Ln.ERR_NETWORK,t,m)),m=null},m.ontimeout=function(){let w=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const S=i.transitional||Kj;i.timeoutErrorMessage&&(w=i.timeoutErrorMessage),r(new Ln(w,S.clarifyTimeoutError?Ln.ETIMEDOUT:Ln.ECONNABORTED,t,m)),m=null},a===void 0&&o.setContentType(null),"setRequestHeader"in m&&ft.forEach(o.toJSON(),function(w,S){m.setRequestHeader(S,w)}),ft.isUndefined(i.withCredentials)||(m.withCredentials=!!i.withCredentials),s&&s!=="json"&&(m.responseType=i.responseType),c&&([d,p]=Kb(c,!0),m.addEventListener("progress",d)),l&&m.upload&&([u,h]=Kb(l),m.upload.addEventListener("progress",u),m.upload.addEventListener("loadend",h)),(i.cancelToken||i.signal)&&(f=x=>{m&&(r(!x||x.type?new Im(null,t,m):x),m.abort(),m=null)},i.cancelToken&&i.cancelToken.subscribe(f),i.signal&&(i.signal.aborted?f():i.signal.addEventListener("abort",f)));const v=ape(i.url);if(v&&Eo.protocols.indexOf(v)===-1){r(new Ln("Unsupported protocol "+v+":",Ln.ERR_BAD_REQUEST,t));return}m.send(a||null)})},ppe=(t,e)=>{const{length:n}=t=t?t.filter(Boolean):[];if(e||n){let r=new AbortController,i;const a=function(c){if(!i){i=!0,s();const f=c instanceof Error?c:this.reason;r.abort(f instanceof Ln?f:new Im(f instanceof Error?f.message:f))}};let o=e&&setTimeout(()=>{o=null,a(new Ln(`timeout ${e} of ms exceeded`,Ln.ETIMEDOUT))},e);const s=()=>{t&&(o&&clearTimeout(o),o=null,t.forEach(c=>{c.unsubscribe?c.unsubscribe(a):c.removeEventListener("abort",a)}),t=null)};t.forEach(c=>c.addEventListener("abort",a));const{signal:l}=r;return l.unsubscribe=()=>ft.asap(s),l}},gpe=function*(t,e){let n=t.byteLength;if(n<e){yield t;return}let r=0,i;for(;r<n;)i=r+e,yield t.slice(r,i),r=i},mpe=async function*(t,e){for await(const n of vpe(t))yield*gpe(n,e)},vpe=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const e=t.getReader();try{for(;;){const{done:n,value:r}=await e.read();if(n)break;yield r}}finally{await e.cancel()}},qP=(t,e,n,r)=>{const i=mpe(t,e);let a=0,o,s=l=>{o||(o=!0,r&&r(l))};return new ReadableStream({async pull(l){try{const{done:c,value:f}=await i.next();if(c){s(),l.close();return}let u=f.byteLength;if(n){let d=a+=u;n(d)}l.enqueue(new Uint8Array(f))}catch(c){throw s(c),c}},cancel(l){return s(l),i.return()}},{highWaterMark:2})},Aw=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",Qj=Aw&&typeof ReadableStream=="function",ype=Aw&&(typeof TextEncoder=="function"?(t=>e=>t.encode(e))(new TextEncoder):async t=>new Uint8Array(await new Response(t).arrayBuffer())),ez=(t,...e)=>{try{return!!t(...e)}catch{return!1}},xpe=Qj&&ez(()=>{let t=!1;const e=new Request(Eo.origin,{body:new ReadableStream,method:"POST",get duplex(){return t=!0,"half"}}).headers.has("Content-Type");return t&&!e}),XP=64*1024,HE=Qj&&ez(()=>ft.isReadableStream(new Response("").body)),qb={stream:HE&&(t=>t.body)};Aw&&(t=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!qb[e]&&(qb[e]=ft.isFunction(t[e])?n=>n[e]():(n,r)=>{throw new Ln(`Response type '${e}' is not supported`,Ln.ERR_NOT_SUPPORT,r)})})})(new Response);const bpe=async t=>{if(t==null)return 0;if(ft.isBlob(t))return t.size;if(ft.isSpecCompliantForm(t))return(await new Request(Eo.origin,{method:"POST",body:t}).arrayBuffer()).byteLength;if(ft.isArrayBufferView(t)||ft.isArrayBuffer(t))return t.byteLength;if(ft.isURLSearchParams(t)&&(t=t+""),ft.isString(t))return(await ype(t)).byteLength},wpe=async(t,e)=>{const n=ft.toFiniteNumber(t.getContentLength());return n??bpe(e)},Cpe=Aw&&(async t=>{let{url:e,method:n,data:r,signal:i,cancelToken:a,timeout:o,onDownloadProgress:s,onUploadProgress:l,responseType:c,headers:f,withCredentials:u="same-origin",fetchOptions:d}=Zj(t);c=c?(c+"").toLowerCase():"text";let h=ppe([i,a&&a.toAbortSignal()],o),p;const g=h&&h.unsubscribe&&(()=>{h.unsubscribe()});let m;try{if(l&&xpe&&n!=="get"&&n!=="head"&&(m=await wpe(f,r))!==0){let S=new Request(e,{method:"POST",body:r,duplex:"half"}),T;if(ft.isFormData(r)&&(T=S.headers.get("content-type"))&&f.setContentType(T),S.body){const[_,D]=WP(m,Kb(HP(l)));r=qP(S.body,XP,_,D)}}ft.isString(u)||(u=u?"include":"omit");const y="credentials"in Request.prototype;p=new Request(e,{...d,signal:h,method:n.toUpperCase(),headers:f.normalize().toJSON(),body:r,duplex:"half",credentials:y?u:void 0});let v=await fetch(p,d);const x=HE&&(c==="stream"||c==="response");if(HE&&(s||x&&g)){const S={};["status","statusText","headers"].forEach(I=>{S[I]=v[I]});const T=ft.toFiniteNumber(v.headers.get("content-length")),[_,D]=s&&WP(T,Kb(HP(s),!0))||[];v=new Response(qP(v.body,XP,_,()=>{D&&D(),g&&g()}),S)}c=c||"text";let w=await qb[ft.findKey(qb,c)||"text"](v,t);return!x&&g&&g(),await new Promise((S,T)=>{Yj(S,T,{data:w,headers:Es.from(v.headers),status:v.status,statusText:v.statusText,config:t,request:p})})}catch(y){throw g&&g(),y&&y.name==="TypeError"&&/Load failed|fetch/i.test(y.message)?Object.assign(new Ln("Network Error",Ln.ERR_NETWORK,t,p),{cause:y.cause||y}):Ln.from(y,y&&y.code,t,p)}}),KE={http:Vhe,xhr:hpe,fetch:Cpe};ft.forEach(KE,(t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch{}Object.defineProperty(t,"adapterName",{value:e})}});const YP=t=>`- ${t}`,Spe=t=>ft.isFunction(t)||t===null||t===!1,tz={getAdapter:t=>{t=ft.isArray(t)?t:[t];const{length:e}=t;let n,r;const i={};for(let a=0;a<e;a++){n=t[a];let o;if(r=n,!Spe(n)&&(r=KE[(o=String(n)).toLowerCase()],r===void 0))throw new Ln(`Unknown adapter '${o}'`);if(r)break;i[o||"#"+a]=r}if(!r){const a=Object.entries(i).map(([s,l])=>`adapter ${s} `+(l===!1?"is not supported by the environment":"is not available in the build"));let o=e?a.length>1?`since :
`+a.map(YP).join(`
`):" "+YP(a[0]):"as no adapter specified";throw new Ln("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return r},adapters:KE};function dT(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new Im(null,t)}function JP(t){return dT(t),t.headers=Es.from(t.headers),t.data=fT.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),tz.getAdapter(t.adapter||Y2.adapter)(t).then(function(r){return dT(t),r.data=fT.call(t,t.transformResponse,r),r.headers=Es.from(r.headers),r},function(r){return Xj(r)||(dT(t),r&&r.response&&(r.response.data=fT.call(t,t.transformResponse,r.response),r.response.headers=Es.from(r.response.headers))),Promise.reject(r)})}const nz="1.11.0",Pw={};["object","boolean","number","function","string","symbol"].forEach((t,e)=>{Pw[t]=function(r){return typeof r===t||"a"+(e<1?"n ":" ")+t}});const ZP={};Pw.transitional=function(e,n,r){function i(a,o){return"[Axios v"+nz+"] Transitional option '"+a+"'"+o+(r?". "+r:"")}return(a,o,s)=>{if(e===!1)throw new Ln(i(o," has been removed"+(n?" in "+n:"")),Ln.ERR_DEPRECATED);return n&&!ZP[o]&&(ZP[o]=!0,console.warn(i(o," has been deprecated since v"+n+" and will be removed in the near future"))),e?e(a,o,s):!0}};Pw.spelling=function(e){return(n,r)=>(console.warn(`${r} is likely a misspelling of ${e}`),!0)};function Tpe(t,e,n){if(typeof t!="object")throw new Ln("options must be an object",Ln.ERR_BAD_OPTION_VALUE);const r=Object.keys(t);let i=r.length;for(;i-- >0;){const a=r[i],o=e[a];if(o){const s=t[a],l=s===void 0||o(s,a,t);if(l!==!0)throw new Ln("option "+a+" must be "+l,Ln.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new Ln("Unknown option "+a,Ln.ERR_BAD_OPTION)}}const qx={assertOptions:Tpe,validators:Pw},Bc=qx.validators;let kh=class{constructor(e){this.defaults=e||{},this.interceptors={request:new jP,response:new jP}}async request(e,n){try{return await this._request(e,n)}catch(r){if(r instanceof Error){let i={};Error.captureStackTrace?Error.captureStackTrace(i):i=new Error;const a=i.stack?i.stack.replace(/^.+\n/,""):"";try{r.stack?a&&!String(r.stack).endsWith(a.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+a):r.stack=a}catch{}}throw r}}_request(e,n){typeof e=="string"?(n=n||{},n.url=e):n=e||{},n=Wh(this.defaults,n);const{transitional:r,paramsSerializer:i,headers:a}=n;r!==void 0&&qx.assertOptions(r,{silentJSONParsing:Bc.transitional(Bc.boolean),forcedJSONParsing:Bc.transitional(Bc.boolean),clarifyTimeoutError:Bc.transitional(Bc.boolean)},!1),i!=null&&(ft.isFunction(i)?n.paramsSerializer={serialize:i}:qx.assertOptions(i,{encode:Bc.function,serialize:Bc.function},!0)),n.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?n.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:n.allowAbsoluteUrls=!0),qx.assertOptions(n,{baseUrl:Bc.spelling("baseURL"),withXsrfToken:Bc.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let o=a&&ft.merge(a.common,a[n.method]);a&&ft.forEach(["delete","get","head","post","put","patch","common"],p=>{delete a[p]}),n.headers=Es.concat(o,a);const s=[];let l=!0;this.interceptors.request.forEach(function(g){typeof g.runWhen=="function"&&g.runWhen(n)===!1||(l=l&&g.synchronous,s.unshift(g.fulfilled,g.rejected))});const c=[];this.interceptors.response.forEach(function(g){c.push(g.fulfilled,g.rejected)});let f,u=0,d;if(!l){const p=[JP.bind(this),void 0];for(p.unshift(...s),p.push(...c),d=p.length,f=Promise.resolve(n);u<d;)f=f.then(p[u++],p[u++]);return f}d=s.length;let h=n;for(u=0;u<d;){const p=s[u++],g=s[u++];try{h=p(h)}catch(m){g.call(this,m);break}}try{f=JP.call(this,h)}catch(p){return Promise.reject(p)}for(u=0,d=c.length;u<d;)f=f.then(c[u++],c[u++]);return f}getUri(e){e=Wh(this.defaults,e);const n=Jj(e.baseURL,e.url,e.allowAbsoluteUrls);return Hj(n,e.params,e.paramsSerializer)}};ft.forEach(["delete","get","head","options"],function(e){kh.prototype[e]=function(n,r){return this.request(Wh(r||{},{method:e,url:n,data:(r||{}).data}))}});ft.forEach(["post","put","patch"],function(e){function n(r){return function(a,o,s){return this.request(Wh(s||{},{method:e,headers:r?{"Content-Type":"multipart/form-data"}:{},url:a,data:o}))}}kh.prototype[e]=n(),kh.prototype[e+"Form"]=n(!0)});let Epe=class rz{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(a){n=a});const r=this;this.promise.then(i=>{if(!r._listeners)return;let a=r._listeners.length;for(;a-- >0;)r._listeners[a](i);r._listeners=null}),this.promise.then=i=>{let a;const o=new Promise(s=>{r.subscribe(s),a=s}).then(i);return o.cancel=function(){r.unsubscribe(a)},o},e(function(a,o,s){r.reason||(r.reason=new Im(a,o,s),n(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const n=this._listeners.indexOf(e);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const e=new AbortController,n=r=>{e.abort(r)};return this.subscribe(n),e.signal.unsubscribe=()=>this.unsubscribe(n),e.signal}static source(){let e;return{token:new rz(function(i){e=i}),cancel:e}}};function _pe(t){return function(n){return t.apply(null,n)}}function Dpe(t){return ft.isObject(t)&&t.isAxiosError===!0}const qE={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(qE).forEach(([t,e])=>{qE[e]=t});function iz(t){const e=new kh(t),n=Nj(kh.prototype.request,e);return ft.extend(n,kh.prototype,e,{allOwnKeys:!0}),ft.extend(n,e,null,{allOwnKeys:!0}),n.create=function(i){return iz(Wh(t,i))},n}const ia=iz(Y2);ia.Axios=kh;ia.CanceledError=Im;ia.CancelToken=Epe;ia.isCancel=Xj;ia.VERSION=nz;ia.toFormData=Rw;ia.AxiosError=Ln;ia.Cancel=ia.CanceledError;ia.all=function(e){return Promise.all(e)};ia.spread=_pe;ia.isAxiosError=Dpe;ia.mergeConfig=Wh;ia.AxiosHeaders=Es;ia.formToJSON=t=>qj(ft.isHTMLForm(t)?new FormData(t):t);ia.getAdapter=tz.getAdapter;ia.HttpStatusCode=qE;ia.default=ia;const{Axios:$Ge,AxiosError:GGe,CanceledError:jGe,isCancel:zGe,CancelToken:WGe,VERSION:HGe,all:KGe,Cancel:qGe,isAxiosError:XGe,spread:YGe,toFormData:JGe,AxiosHeaders:ZGe,HttpStatusCode:QGe,formToJSON:eje,getAdapter:tje,mergeConfig:nje}=ia,Ko=ia.create({baseURL:"/api",timeout:1e4,headers:{"Content-Type":"application/json"}});Ko.interceptors.request.use(t=>{const e=localStorage.getItem("access_token");return e&&(t.headers.Authorization=`Bearer ${e}`),t},t=>Promise.reject(t));Ko.interceptors.response.use(t=>t,t=>(t.response?.status===401&&(localStorage.removeItem("access_token"),window.location.href="/"),Promise.reject(t)));const La={get:(t,e)=>Ko.get(t,{params:e}).then(n=>n.data),post:(t,e,n)=>Ko.post(t,e,n).then(r=>r.data),put:(t,e)=>Ko.put(t,e).then(n=>n.data),delete:t=>Ko.delete(t).then(e=>e.data),upload:(t,e)=>{const n=new FormData;return n.append("file",e),Ko.post(t,n,{headers:{"Content-Type":"multipart/form-data"}}).then(r=>r.data)}},Ope=async t=>{const e=await La.post("/auth/login",t);return e.success&&e.data?.access_token&&localStorage.setItem("access_token",e.data.access_token),e},Mpe=async()=>La.get("/auth/me"),Ipe=async()=>{const t=await La.post("/auth/logout");return localStorage.removeItem("access_token"),t},Rpe=async t=>La.post("/user/change-password",t),Ape=!1,Ppe="AuthStore",Bf=j0e()(q0e(J0e((t,e)=>({accessToken:"",userInfo:void 0,isGettingUserInfo:!1,isAuthenticated:()=>{const{accessToken:n,userInfo:r}=e();return!!(n||localStorage.getItem("access_token"))&&!!r},setAccessToken:n=>{const{getUserInfo:r}=e();t({accessToken:n}),n?(localStorage.setItem("access_token",n),r()):localStorage.removeItem("access_token")},setUserInfo:n=>{t({userInfo:n})},getUserInfo:async()=>{const{accessToken:n,logout:r,isGettingUserInfo:i}=e();if(!i&&!(!n&&!localStorage.getItem("access_token"))){t({isGettingUserInfo:!0});try{const a=await Mpe();if(!a.success){Vt({color:"danger",description:a.message}),await r();return}a.data?.user&&t({userInfo:a.data.user})}catch(a){console.error("Get user info failed:",a),await r()}finally{t({isGettingUserInfo:!1})}}},logout:async()=>{try{await Ipe()}catch(n){console.error("Logout API failed:",n)}finally{e().clearAuth()}},clearAuth:()=>{t({accessToken:"",userInfo:void 0,isGettingUserInfo:!1}),localStorage.removeItem("access_token")}}),{name:Ppe,partialize:t=>({accessToken:t.accessToken})}),{enabled:Ape,name:"AuthStore"})),Npe=()=>{const{logout:t,userInfo:e}=Bf(),n=Su(),r=bc(),[i,a]=H.useState(!1),[o,s]=H.useState(""),[l,c]=H.useState(""),[f,u]=H.useState(""),[d,h]=H.useState(!1),p=n.pathname.startsWith("/detail/"),g=n.pathname==="/admin",m=n.pathname==="/upload",y=n.pathname.startsWith("/edit/"),v=e?.role===1,x=e?.role===2;e?.role;const w=v||x,S=!!e?.user_id,T=()=>{Vt({color:"success",description:"已退出登录"}),t(),r("/")},_=()=>{r(-1)},D=()=>{r("/admin")},I=()=>{r("/upload")},R=()=>{r("/list")},M=async()=>{if(!o||!l||!f){Vt({color:"danger",description:"请填写所有密码字段"});return}if(l!==f){Vt({color:"danger",description:"新密码与确认密码不一致"});return}if(l.length<6){Vt({color:"danger",description:"新密码长度至少6位"});return}h(!0);try{const A=await Rpe({current_password:o,new_password:l,new_password_confirmation:f});A.success?(Vt({color:"success",description:"密码修改成功"}),a(!1),s(""),c(""),u("")):Vt({color:"danger",description:A.message||"密码修改失败"})}catch{Vt({color:"danger",description:"网络错误，请重试"})}finally{h(!1)}};return j.jsxs("header",{className:"bg-gray-800 shadow-lg fixed top-0 left-0 right-0 z-50",children:[j.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-6",children:j.jsxs("div",{className:"flex justify-between items-center h-16",children:[j.jsxs("div",{className:"flex items-center space-x-3",children:[(p||g||m||y)&&j.jsx("button",{onClick:p?_:R,className:"group flex cursor-pointer items-center justify-center w-9 h-9 bg-gray-700 hover:bg-gray-600 text-gray-300 hover:text-white rounded-lg transition-all duration-200",children:j.jsx("svg",{className:"w-5 h-5 transition-transform duration-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p?j.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"}):j.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})})}),j.jsxs("div",{className:"flex items-center space-x-2 cursor-pointer",onClick:R,children:[j.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-blue-500 to-purple-600 rounded-lg flex items-center justify-center",children:j.jsx("span",{className:"text-white text-sm font-bold",children:"智"})}),j.jsx("h1",{className:"text-xl font-bold text-white",children:"智慧诊疗 v1.5"})]})]}),j.jsxs("div",{className:"flex items-center space-x-6",children:[S?j.jsxs("div",{className:"flex items-center space-x-3",children:[j.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center",children:j.jsx("span",{className:"text-white text-sm font-semibold",children:e?.username?.charAt(0)||"U"})}),j.jsxs("div",{className:"flex flex-col",children:[j.jsx("span",{className:"text-white font-medium text-sm",children:e?.username||"用户"}),j.jsx("span",{className:"text-gray-400 text-xs",children:e?.role_name||""})]})]}):j.jsxs("div",{className:"flex items-center space-x-3",children:[j.jsx("div",{className:"w-8 h-8 bg-gray-600 rounded-full flex items-center justify-center",children:j.jsx("span",{className:"text-white text-sm font-semibold",children:"?"})}),j.jsxs("div",{className:"flex flex-col",children:[j.jsx("span",{className:"text-gray-300 font-medium text-sm",children:"未登录"}),j.jsx("span",{className:"text-gray-500 text-xs",children:"请先登录"})]})]}),S&&j.jsxs("div",{className:"flex items-center space-x-2",children:[w&&!m&&j.jsxs("button",{onClick:I,className:"group cursor-pointer flex items-center space-x-2 px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-all duration-200 ease-in-out transform hover:scale-105",children:[j.jsx("svg",{className:"w-4 h-4 transition-transform duration-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:j.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),j.jsx("span",{className:"text-sm font-medium",children:"上传"})]}),v&&!g&&j.jsxs("button",{onClick:D,className:"group cursor-pointer flex items-center space-x-2 px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg transition-all duration-200 ease-in-out transform hover:scale-105",children:[j.jsx("svg",{className:"w-4 h-4 transition-transform duration-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:j.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"})}),j.jsx("span",{className:"text-sm font-medium",children:"管理端"})]}),j.jsxs("button",{onClick:()=>a(!0),className:"group relative flex items-center space-x-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-all duration-200 ease-in-out transform hover:scale-105",children:[j.jsx("svg",{className:"w-4 h-4 transition-transform duration-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:j.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"})}),j.jsx("span",{className:"text-sm font-medium",children:"修改密码"})]}),j.jsxs("button",{onClick:T,className:"group relative flex items-center space-x-2 px-4 py-2 bg-gray-700 hover:bg-red-600 text-gray-300 hover:text-white rounded-lg transition-all duration-200 ease-in-out transform hover:scale-105",children:[j.jsx("svg",{className:"w-4 h-4 transition-transform duration-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:j.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),j.jsx("span",{className:"text-sm font-medium",children:"退出"})]})]})]})]})}),i&&j.jsx("div",{className:"fixed inset-0 bg-black/70 bg-opacity-50 flex items-center justify-center z-50",children:j.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[j.jsxs("div",{className:"flex justify-between items-center mb-4",children:[j.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"修改密码"}),j.jsx("button",{onClick:()=>a(!1),className:"text-gray-400 hover:text-gray-600",children:j.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:j.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),j.jsxs("div",{className:"space-y-4",children:[j.jsxs("div",{children:[j.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"当前密码"}),j.jsx("input",{type:"password",value:o,onChange:A=>s(A.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"请输入当前密码"})]}),j.jsxs("div",{children:[j.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"新密码"}),j.jsx("input",{type:"password",value:l,onChange:A=>c(A.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"请输入新密码"})]}),j.jsxs("div",{children:[j.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"确认新密码"}),j.jsx("input",{type:"password",value:f,onChange:A=>u(A.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"请再次输入新密码"})]})]}),j.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[j.jsx("button",{onClick:()=>a(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800 transition-colors",disabled:d,children:"取消"}),j.jsx("button",{onClick:M,disabled:d,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:d?"修改中...":"确认修改"})]})]})})]})},Lpe=()=>j.jsx(j.Fragment,{});function Hp({children:t}){return j.jsxs("div",{className:"min-h-screen flex w-full flex-col",children:[j.jsx(Npe,{}),j.jsx("main",{className:"flex-1 pt-16",children:t}),j.jsx(Lpe,{})]})}function XE(t){return Pae()?t.altKey:t.ctrlKey}function Xx(t,e){var n,r;let i=`[data-key="${CSS.escape(String(e))}"]`,a=(n=t.current)===null||n===void 0?void 0:n.dataset.collection;return a&&(i=`[data-collection="${CSS.escape(a)}"]${i}`),(r=t.current)===null||r===void 0?void 0:r.querySelector(i)}const az=new WeakMap;function kpe(t){let e=Js();return az.set(t,e),e}function Vpe(t){return az.get(t)}const Fpe=1e3;function oz(t){let{keyboardDelegate:e,selectionManager:n,onTypeSelect:r}=t,i=H.useRef({search:"",timeout:void 0}).current,a=o=>{let s=Upe(o.key);if(!(!s||o.ctrlKey||o.metaKey||!o.currentTarget.contains(o.target)||i.search.length===0&&s===" ")){if(s===" "&&i.search.trim().length>0&&(o.preventDefault(),"continuePropagation"in o||o.stopPropagation()),i.search+=s,e.getKeyForSearch!=null){let l=e.getKeyForSearch(i.search,n.focusedKey);l==null&&(l=e.getKeyForSearch(i.search)),l!=null&&(n.setFocusedKey(l),r&&r(l))}clearTimeout(i.timeout),i.timeout=setTimeout(()=>{i.search=""},Fpe)}};return{typeSelectProps:{onKeyDownCapture:e.getKeyForSearch?a:void 0}}}function Upe(t){return t.length===1||!/^[A-Z]/i.test(t)?t:""}function sz(t){let{selectionManager:e,keyboardDelegate:n,ref:r,autoFocus:i=!1,shouldFocusWrap:a=!1,disallowEmptySelection:o=!1,disallowSelectAll:s=!1,escapeKeyBehavior:l="clearSelection",selectOnFocus:c=e.selectionBehavior==="replace",disallowTypeAhead:f=!1,shouldUseVirtualFocus:u,allowsTabNavigation:d=!1,isVirtualized:h,scrollRef:p=r,linkBehavior:g="action"}=t,{direction:m}=ap(),y=mw(),v=G=>{var F;if(G.altKey&&G.key==="Tab"&&G.preventDefault(),!(!((F=r.current)===null||F===void 0)&&F.contains(G.target)))return;const $=(J,Y)=>{if(J!=null){if(e.isLink(J)&&g==="selection"&&c&&!XE(G)){g_.flushSync(()=>{e.setFocusedKey(J,Y)});let ie=Xx(r,J),ue=e.getItemProps(J);ie&&y.open(ie,G,ue.href,ue.routerOptions);return}if(e.setFocusedKey(J,Y),e.isLink(J)&&g==="override")return;G.shiftKey&&e.selectionMode==="multiple"?e.extendSelection(J):c&&!XE(G)&&e.replaceSelection(J)}};switch(G.key){case"ArrowDown":if(n.getKeyBelow){var V,X,Q;let J=e.focusedKey!=null?(V=n.getKeyBelow)===null||V===void 0?void 0:V.call(n,e.focusedKey):(X=n.getFirstKey)===null||X===void 0?void 0:X.call(n);J==null&&a&&(J=(Q=n.getFirstKey)===null||Q===void 0?void 0:Q.call(n,e.focusedKey)),J!=null&&(G.preventDefault(),$(J))}break;case"ArrowUp":if(n.getKeyAbove){var re,ye,me;let J=e.focusedKey!=null?(re=n.getKeyAbove)===null||re===void 0?void 0:re.call(n,e.focusedKey):(ye=n.getLastKey)===null||ye===void 0?void 0:ye.call(n);J==null&&a&&(J=(me=n.getLastKey)===null||me===void 0?void 0:me.call(n,e.focusedKey)),J!=null&&(G.preventDefault(),$(J))}break;case"ArrowLeft":if(n.getKeyLeftOf){var Ce,we,Ae;let J=e.focusedKey!=null?(Ce=n.getKeyLeftOf)===null||Ce===void 0?void 0:Ce.call(n,e.focusedKey):null;J==null&&a&&(J=m==="rtl"?(we=n.getFirstKey)===null||we===void 0?void 0:we.call(n,e.focusedKey):(Ae=n.getLastKey)===null||Ae===void 0?void 0:Ae.call(n,e.focusedKey)),J!=null&&(G.preventDefault(),$(J,m==="rtl"?"first":"last"))}break;case"ArrowRight":if(n.getKeyRightOf){var De,q,k;let J=e.focusedKey!=null?(De=n.getKeyRightOf)===null||De===void 0?void 0:De.call(n,e.focusedKey):null;J==null&&a&&(J=m==="rtl"?(q=n.getLastKey)===null||q===void 0?void 0:q.call(n,e.focusedKey):(k=n.getFirstKey)===null||k===void 0?void 0:k.call(n,e.focusedKey)),J!=null&&(G.preventDefault(),$(J,m==="rtl"?"last":"first"))}break;case"Home":if(n.getFirstKey){if(e.focusedKey===null&&G.shiftKey)return;G.preventDefault();let J=n.getFirstKey(e.focusedKey,ug(G));e.setFocusedKey(J),J!=null&&(ug(G)&&G.shiftKey&&e.selectionMode==="multiple"?e.extendSelection(J):c&&e.replaceSelection(J))}break;case"End":if(n.getLastKey){if(e.focusedKey===null&&G.shiftKey)return;G.preventDefault();let J=n.getLastKey(e.focusedKey,ug(G));e.setFocusedKey(J),J!=null&&(ug(G)&&G.shiftKey&&e.selectionMode==="multiple"?e.extendSelection(J):c&&e.replaceSelection(J))}break;case"PageDown":if(n.getKeyPageBelow&&e.focusedKey!=null){let J=n.getKeyPageBelow(e.focusedKey);J!=null&&(G.preventDefault(),$(J))}break;case"PageUp":if(n.getKeyPageAbove&&e.focusedKey!=null){let J=n.getKeyPageAbove(e.focusedKey);J!=null&&(G.preventDefault(),$(J))}break;case"a":ug(G)&&e.selectionMode==="multiple"&&s!==!0&&(G.preventDefault(),e.selectAll());break;case"Escape":l==="clearSelection"&&!o&&e.selectedKeys.size!==0&&(G.stopPropagation(),G.preventDefault(),e.clearSelection());break;case"Tab":if(!d){if(G.shiftKey)r.current.focus();else{let J=tu(r.current,{tabbable:!0}),Y,ie;do ie=J.lastChild(),ie&&(Y=ie);while(ie);Y&&!Y.contains(document.activeElement)&&To(Y)}break}}},x=H.useRef({top:0,left:0});E5(p,"scroll",h?void 0:()=>{var G,F,$,V;x.current={top:($=(G=p.current)===null||G===void 0?void 0:G.scrollTop)!==null&&$!==void 0?$:0,left:(V=(F=p.current)===null||F===void 0?void 0:F.scrollLeft)!==null&&V!==void 0?V:0}});let w=G=>{if(e.isFocused){G.currentTarget.contains(G.target)||e.setFocused(!1);return}if(G.currentTarget.contains(G.target)){if(e.setFocused(!0),e.focusedKey==null){var F,$;let Q=ye=>{ye!=null&&(e.setFocusedKey(ye),c&&!e.isSelected(ye)&&e.replaceSelection(ye))},re=G.relatedTarget;var V,X;re&&G.currentTarget.compareDocumentPosition(re)&Node.DOCUMENT_POSITION_FOLLOWING?Q((V=e.lastSelectedKey)!==null&&V!==void 0?V:(F=n.getLastKey)===null||F===void 0?void 0:F.call(n)):Q((X=e.firstSelectedKey)!==null&&X!==void 0?X:($=n.getFirstKey)===null||$===void 0?void 0:$.call(n))}else!h&&p.current&&(p.current.scrollTop=x.current.top,p.current.scrollLeft=x.current.left);if(e.focusedKey!=null&&p.current){let Q=Xx(r,e.focusedKey);Q instanceof HTMLElement&&(!Q.contains(document.activeElement)&&!u&&To(Q),Lh()==="keyboard"&&IR(Q,{containingElement:r.current}))}}},S=G=>{G.currentTarget.contains(G.relatedTarget)||e.setFocused(!1)},T=H.useRef(!1);E5(r,Wae,u?G=>{let{detail:F}=G;G.stopPropagation(),e.setFocused(!0),F?.focusStrategy==="first"&&(T.current=!0)}:void 0);let _=va(()=>{var G,F;let $=(F=(G=n.getFirstKey)===null||G===void 0?void 0:G.call(n))!==null&&F!==void 0?F:null;if($==null){let V=Oo();G$(r.current),j$(V,null),e.collection.size>0&&(T.current=!1)}else e.setFocusedKey($),T.current=!1});DR(()=>{T.current&&_()},[e.collection,_]);let D=va(()=>{e.collection.size>0&&(T.current=!1)});DR(()=>{D()},[e.focusedKey,D]),E5(r,zae,u?G=>{var F;G.stopPropagation(),e.setFocused(!1),!((F=G.detail)===null||F===void 0)&&F.clearFocusKey&&e.setFocusedKey(null)}:void 0);const I=H.useRef(i),R=H.useRef(!1);H.useEffect(()=>{if(I.current){var G,F;let X=null;var $;i==="first"&&(X=($=(G=n.getFirstKey)===null||G===void 0?void 0:G.call(n))!==null&&$!==void 0?$:null);var V;i==="last"&&(X=(V=(F=n.getLastKey)===null||F===void 0?void 0:F.call(n))!==null&&V!==void 0?V:null);let Q=e.selectedKeys;if(Q.size){for(let re of Q)if(e.canSelectItem(re)){X=re;break}}e.setFocused(!0),e.setFocusedKey(X),X==null&&!u&&r.current&&zh(r.current),e.collection.size>0&&(I.current=!1,R.current=!0)}});let M=H.useRef(e.focusedKey),A=H.useRef(null);H.useEffect(()=>{if(e.isFocused&&e.focusedKey!=null&&(e.focusedKey!==M.current||R.current)&&p.current&&r.current){let G=Lh(),F=Xx(r,e.focusedKey);if(!(F instanceof HTMLElement))return;(G==="keyboard"||R.current)&&(A.current&&cancelAnimationFrame(A.current),A.current=requestAnimationFrame(()=>{p.current&&(zU(p.current,F),G!=="virtual"&&IR(F,{containingElement:r.current}))}))}!u&&e.isFocused&&e.focusedKey==null&&M.current!=null&&r.current&&zh(r.current),M.current=e.focusedKey,R.current=!1}),H.useEffect(()=>()=>{A.current&&cancelAnimationFrame(A.current)},[]),E5(r,"react-aria-focus-scope-restore",G=>{G.preventDefault(),e.setFocused(!0)});let L={onKeyDown:v,onFocus:w,onBlur:S,onMouseDown(G){p.current===G.target&&G.preventDefault()}},{typeSelectProps:P}=oz({keyboardDelegate:n,selectionManager:e});f||(L=Oi(P,L));let B;u||(B=e.focusedKey==null?0:-1);let U=kpe(e.collection);return{collectionProps:Oi(L,{tabIndex:B,"data-collection":U})}}function lz(t){let{id:e,selectionManager:n,key:r,ref:i,shouldSelectOnPressUp:a,shouldUseVirtualFocus:o,focus:s,isDisabled:l,onAction:c,allowsDifferentPressOrigin:f,linkBehavior:u="action"}=t,d=mw();e=Js(e);let h=$=>{if($.pointerType==="keyboard"&&XE($))n.toggleSelection(r);else{if(n.selectionMode==="none")return;if(n.isLink(r)){if(u==="selection"&&i.current){let V=n.getItemProps(r);d.open(i.current,$,V.href,V.routerOptions),n.setSelectedKeys(n.selectedKeys);return}else if(u==="override"||u==="none")return}n.selectionMode==="single"?n.isSelected(r)&&!n.disallowEmptySelection?n.toggleSelection(r):n.replaceSelection(r):$&&$.shiftKey?n.extendSelection(r):n.selectionBehavior==="toggle"||$&&(ug($)||$.pointerType==="touch"||$.pointerType==="virtual")?n.toggleSelection(r):n.replaceSelection(r)}};H.useEffect(()=>{r===n.focusedKey&&n.isFocused&&(o?G$(i.current):s?s():document.activeElement!==i.current&&i.current&&zh(i.current))},[i,r,n.focusedKey,n.childFocusStrategy,n.isFocused,o]),l=l||n.isDisabled(r);let p={};!o&&!l?p={tabIndex:r===n.focusedKey?0:-1,onFocus($){$.target===i.current&&n.setFocusedKey(r)}}:l&&(p.onMouseDown=$=>{$.preventDefault()});let g=n.isLink(r)&&u==="override",m=n.isLink(r)&&u!=="selection"&&u!=="none",y=!l&&n.canSelectItem(r)&&!g,v=(c||m)&&!l,x=v&&(n.selectionBehavior==="replace"?!y:!y||n.isEmpty),w=v&&y&&n.selectionBehavior==="replace",S=x||w,T=H.useRef(null),_=S&&y,D=H.useRef(!1),I=H.useRef(!1),R=n.getItemProps(r),M=$=>{c&&c(),m&&i.current&&d.open(i.current,$,R.href,R.routerOptions)},A={ref:i};if(a?(A.onPressStart=$=>{T.current=$.pointerType,D.current=_,$.pointerType==="keyboard"&&(!S||eN())&&h($)},f?(A.onPressUp=x?void 0:$=>{$.pointerType==="mouse"&&y&&h($)},A.onPress=x?M:$=>{$.pointerType!=="keyboard"&&$.pointerType!=="mouse"&&y&&h($)}):A.onPress=$=>{if(x||w&&$.pointerType!=="mouse"){if($.pointerType==="keyboard"&&!QP())return;M($)}else $.pointerType!=="keyboard"&&y&&h($)}):(A.onPressStart=$=>{T.current=$.pointerType,D.current=_,I.current=x,y&&($.pointerType==="mouse"&&!x||$.pointerType==="keyboard"&&(!v||eN()))&&h($)},A.onPress=$=>{($.pointerType==="touch"||$.pointerType==="pen"||$.pointerType==="virtual"||$.pointerType==="keyboard"&&S&&QP()||$.pointerType==="mouse"&&I.current)&&(S?M($):y&&h($))}),p["data-collection"]=Vpe(n.collection),p["data-key"]=r,A.preventFocusOnPress=o,o&&(A=Oi(A,{onPressStart($){$.pointerType!=="touch"&&(n.setFocused(!0),n.setFocusedKey(r))},onPress($){$.pointerType==="touch"&&(n.setFocused(!0),n.setFocusedKey(r))}})),R)for(let $ of["onPressStart","onPressEnd","onPressChange","onPress","onPressUp","onClick"])R[$]&&(A[$]=o0(A[$],R[$]));let{pressProps:L,isPressed:P}=Uf(A),B=w?$=>{T.current==="mouse"&&($.stopPropagation(),$.preventDefault(),M($))}:void 0,{longPressProps:U}=U$({isDisabled:!_,onLongPress($){$.pointerType==="touch"&&(h($),n.setSelectionBehavior("toggle"))}}),G=$=>{T.current==="touch"&&D.current&&$.preventDefault()},F=u!=="none"&&n.isLink(r)?$=>{l0.isOpening||$.preventDefault()}:void 0;return{itemProps:Oi(p,y||x||o&&!l?L:{},_?U:{},{onDoubleClick:B,onDragStartCapture:G,onClick:F,id:e},o?{onMouseDown:$=>$.preventDefault()}:void 0),isPressed:P,isSelected:n.isSelected(r),isFocused:n.isFocused&&n.focusedKey===r,isDisabled:l,allowsSelection:y,hasAction:S}}function QP(){let t=window.event;return t?.key==="Enter"}function eN(){let t=window.event;return t?.key===" "||t?.code==="Space"}class tN{getItemRect(e){let n=this.ref.current;if(!n)return null;let r=e!=null?Xx(this.ref,e):null;if(!r)return null;let i=n.getBoundingClientRect(),a=r.getBoundingClientRect();return{x:a.left-i.left+n.scrollLeft,y:a.top-i.top+n.scrollTop,width:a.width,height:a.height}}getContentSize(){let e=this.ref.current;var n,r;return{width:(n=e?.scrollWidth)!==null&&n!==void 0?n:0,height:(r=e?.scrollHeight)!==null&&r!==void 0?r:0}}getVisibleRect(){let e=this.ref.current;var n,r,i,a;return{x:(n=e?.scrollLeft)!==null&&n!==void 0?n:0,y:(r=e?.scrollTop)!==null&&r!==void 0?r:0,width:(i=e?.offsetWidth)!==null&&i!==void 0?i:0,height:(a=e?.offsetHeight)!==null&&a!==void 0?a:0}}constructor(e){this.ref=e}}class cz{isDisabled(e){var n;return this.disabledBehavior==="all"&&(((n=e.props)===null||n===void 0?void 0:n.isDisabled)||this.disabledKeys.has(e.key))}findNextNonDisabled(e,n){let r=e;for(;r!=null;){let i=this.collection.getItem(r);if(i?.type==="item"&&!this.isDisabled(i))return r;r=n(r)}return null}getNextKey(e){let n=e;return n=this.collection.getKeyAfter(n),this.findNextNonDisabled(n,r=>this.collection.getKeyAfter(r))}getPreviousKey(e){let n=e;return n=this.collection.getKeyBefore(n),this.findNextNonDisabled(n,r=>this.collection.getKeyBefore(r))}findKey(e,n,r){let i=e,a=this.layoutDelegate.getItemRect(i);if(!a||i==null)return null;let o=a;do{if(i=n(i),i==null)break;a=this.layoutDelegate.getItemRect(i)}while(a&&r(o,a)&&i!=null);return i}isSameRow(e,n){return e.y===n.y||e.x!==n.x}isSameColumn(e,n){return e.x===n.x||e.y!==n.y}getKeyBelow(e){return this.layout==="grid"&&this.orientation==="vertical"?this.findKey(e,n=>this.getNextKey(n),this.isSameRow):this.getNextKey(e)}getKeyAbove(e){return this.layout==="grid"&&this.orientation==="vertical"?this.findKey(e,n=>this.getPreviousKey(n),this.isSameRow):this.getPreviousKey(e)}getNextColumn(e,n){return n?this.getPreviousKey(e):this.getNextKey(e)}getKeyRightOf(e){let n=this.direction==="ltr"?"getKeyRightOf":"getKeyLeftOf";return this.layoutDelegate[n]?(e=this.layoutDelegate[n](e),this.findNextNonDisabled(e,r=>this.layoutDelegate[n](r))):this.layout==="grid"?this.orientation==="vertical"?this.getNextColumn(e,this.direction==="rtl"):this.findKey(e,r=>this.getNextColumn(r,this.direction==="rtl"),this.isSameColumn):this.orientation==="horizontal"?this.getNextColumn(e,this.direction==="rtl"):null}getKeyLeftOf(e){let n=this.direction==="ltr"?"getKeyLeftOf":"getKeyRightOf";return this.layoutDelegate[n]?(e=this.layoutDelegate[n](e),this.findNextNonDisabled(e,r=>this.layoutDelegate[n](r))):this.layout==="grid"?this.orientation==="vertical"?this.getNextColumn(e,this.direction==="ltr"):this.findKey(e,r=>this.getNextColumn(r,this.direction==="ltr"),this.isSameColumn):this.orientation==="horizontal"?this.getNextColumn(e,this.direction==="ltr"):null}getFirstKey(){let e=this.collection.getFirstKey();return this.findNextNonDisabled(e,n=>this.collection.getKeyAfter(n))}getLastKey(){let e=this.collection.getLastKey();return this.findNextNonDisabled(e,n=>this.collection.getKeyBefore(n))}getKeyPageAbove(e){let n=this.ref.current,r=this.layoutDelegate.getItemRect(e);if(!r)return null;if(n&&!Qv(n))return this.getFirstKey();let i=e;if(this.orientation==="horizontal"){let a=Math.max(0,r.x+r.width-this.layoutDelegate.getVisibleRect().width);for(;r&&r.x>a&&i!=null;)i=this.getKeyAbove(i),r=i==null?null:this.layoutDelegate.getItemRect(i)}else{let a=Math.max(0,r.y+r.height-this.layoutDelegate.getVisibleRect().height);for(;r&&r.y>a&&i!=null;)i=this.getKeyAbove(i),r=i==null?null:this.layoutDelegate.getItemRect(i)}return i??this.getFirstKey()}getKeyPageBelow(e){let n=this.ref.current,r=this.layoutDelegate.getItemRect(e);if(!r)return null;if(n&&!Qv(n))return this.getLastKey();let i=e;if(this.orientation==="horizontal"){let a=Math.min(this.layoutDelegate.getContentSize().width,r.y-r.width+this.layoutDelegate.getVisibleRect().width);for(;r&&r.x<a&&i!=null;)i=this.getKeyBelow(i),r=i==null?null:this.layoutDelegate.getItemRect(i)}else{let a=Math.min(this.layoutDelegate.getContentSize().height,r.y-r.height+this.layoutDelegate.getVisibleRect().height);for(;r&&r.y<a&&i!=null;)i=this.getKeyBelow(i),r=i==null?null:this.layoutDelegate.getItemRect(i)}return i??this.getLastKey()}getKeyForSearch(e,n){if(!this.collator)return null;let r=this.collection,i=n||this.getFirstKey();for(;i!=null;){let a=r.getItem(i);if(!a)return null;let o=a.textValue.slice(0,e.length);if(a.textValue&&this.collator.compare(o,e)===0)return i;i=this.getNextKey(i)}return null}constructor(...e){if(e.length===1){let n=e[0];this.collection=n.collection,this.ref=n.ref,this.collator=n.collator,this.disabledKeys=n.disabledKeys||new Set,this.disabledBehavior=n.disabledBehavior||"all",this.orientation=n.orientation||"vertical",this.direction=n.direction,this.layout=n.layout||"stack",this.layoutDelegate=n.layoutDelegate||new tN(n.ref)}else this.collection=e[0],this.disabledKeys=e[1],this.ref=e[2],this.collator=e[3],this.layout="stack",this.orientation="vertical",this.disabledBehavior="all",this.layoutDelegate=new tN(this.ref);this.layout==="stack"&&this.orientation==="vertical"&&(this.getKeyLeftOf=void 0,this.getKeyRightOf=void 0)}}function Bpe(t){let{selectionManager:e,collection:n,disabledKeys:r,ref:i,keyboardDelegate:a,layoutDelegate:o}=t,s=qU({usage:"search",sensitivity:"base"}),l=e.disabledBehavior,c=H.useMemo(()=>a||new cz({collection:n,disabledKeys:r,disabledBehavior:l,ref:i,collator:s,layoutDelegate:o}),[a,o,n,r,i,s,l]),{collectionProps:f}=sz({...t,ref:i,selectionManager:e,keyboardDelegate:c});return{listProps:f}}var nN={ease:[.36,.66,.4,1]},uz={scaleSpringOpacity:{initial:{opacity:0,transform:"scale(0.8)"},enter:{opacity:1,transform:"scale(1)",transition:{type:"spring",bounce:0,duration:.3}},exit:{opacity:0,transform:"scale(0.96)",transition:{type:"easeOut",bounce:0,duration:.15}}},fade:{enter:{opacity:1,transition:{duration:.4,ease:nN.ease}},exit:{opacity:0,transition:{duration:.3,ease:nN.ease}}}};class sc extends Set{constructor(e,n,r){super(e),e instanceof sc?(this.anchorKey=n??e.anchorKey,this.currentKey=r??e.currentKey):(this.anchorKey=n??null,this.currentKey=r??null)}}function $pe(t,e){if(t.size!==e.size)return!1;for(let n of t)if(!e.has(n))return!1;return!0}function Gpe(t){let{selectionMode:e="none",disallowEmptySelection:n=!1,allowDuplicateSelectionEvents:r,selectionBehavior:i="toggle",disabledBehavior:a="all"}=t,o=H.useRef(!1),[,s]=H.useState(!1),l=H.useRef(null),c=H.useRef(null),[,f]=H.useState(null),u=H.useMemo(()=>rN(t.selectedKeys),[t.selectedKeys]),d=H.useMemo(()=>rN(t.defaultSelectedKeys,new sc),[t.defaultSelectedKeys]),[h,p]=$2(u,d,t.onSelectionChange),g=H.useMemo(()=>t.disabledKeys?new Set(t.disabledKeys):new Set,[t.disabledKeys]),[m,y]=H.useState(i);i==="replace"&&m==="toggle"&&typeof h=="object"&&h.size===0&&y("replace");let v=H.useRef(i);return H.useEffect(()=>{i!==v.current&&(y(i),v.current=i)},[i]),{selectionMode:e,disallowEmptySelection:n,selectionBehavior:m,setSelectionBehavior:y,get isFocused(){return o.current},setFocused(x){o.current=x,s(x)},get focusedKey(){return l.current},get childFocusStrategy(){return c.current},setFocusedKey(x,w="first"){l.current=x,c.current=w,f(x)},selectedKeys:h,setSelectedKeys(x){(r||!$pe(x,h))&&p(x)},disabledKeys:g,disabledBehavior:a}}function rN(t,e){return t?t==="all"?"all":new sc(t):e}function fz(t){return null}fz.getCollectionNode=function*(e,n){let{childItems:r,title:i,children:a}=e,o=e.title||e.children,s=e.textValue||(typeof o=="string"?o:"")||e["aria-label"]||"";!s&&n?.suppressTextValueWarning,yield{type:"item",props:e,rendered:o,textValue:s,"aria-label":e["aria-label"],hasChildNodes:jpe(e),*childNodes(){if(r)for(let l of r)yield{type:"item",value:l};else if(i){let l=[];Tn.Children.forEach(a,c=>{l.push({type:"item",element:c})}),yield*l}}}};function jpe(t){return t.hasChildItems!=null?t.hasChildItems:!!(t.childItems||t.title&&Tn.Children.count(t.children)>0)}let dz=fz;class zpe{build(e,n){return this.context=n,iN(()=>this.iterateCollection(e))}*iterateCollection(e){let{children:n,items:r}=e;if(Tn.isValidElement(n)&&n.type===Tn.Fragment)yield*this.iterateCollection({children:n.props.children,items:r});else if(typeof n=="function"){if(!r)throw new Error("props.children was a function but props.items is missing");let i=0;for(let a of r)yield*this.getFullNode({value:a,index:i},{renderer:n}),i++}else{let i=[];Tn.Children.forEach(n,o=>{o&&i.push(o)});let a=0;for(let o of i){let s=this.getFullNode({element:o,index:a},{});for(let l of s)a++,yield l}}}getKey(e,n,r,i){if(e.key!=null)return e.key;if(n.type==="cell"&&n.key!=null)return`${i}${n.key}`;let a=n.value;if(a!=null){var o;let s=(o=a.key)!==null&&o!==void 0?o:a.id;if(s==null)throw new Error("No key found for item");return s}return i?`${i}.${n.index}`:`$.${n.index}`}getChildState(e,n){return{renderer:n.renderer||e.renderer}}*getFullNode(e,n,r,i){if(Tn.isValidElement(e.element)&&e.element.type===Tn.Fragment){let m=[];Tn.Children.forEach(e.element.props.children,v=>{m.push(v)});var a;let y=(a=e.index)!==null&&a!==void 0?a:0;for(const v of m)yield*this.getFullNode({element:v,index:y++},n,r,i);return}let o=e.element;if(!o&&e.value&&n&&n.renderer){let m=this.cache.get(e.value);if(m&&(!m.shouldInvalidate||!m.shouldInvalidate(this.context))){m.index=e.index,m.parentKey=i?i.key:null,yield m;return}o=n.renderer(e.value)}if(Tn.isValidElement(o)){let m=o.type;if(typeof m!="function"&&typeof m.getCollectionNode!="function"){let w=o.type;throw new Error(`Unknown element <${w}> in collection.`)}let y=m.getCollectionNode(o.props,this.context);var s;let v=(s=e.index)!==null&&s!==void 0?s:0,x=y.next();for(;!x.done&&x.value;){let w=x.value;e.index=v;var l;let S=(l=w.key)!==null&&l!==void 0?l:null;S==null&&(S=w.element?null:this.getKey(o,e,n,r));let _=[...this.getFullNode({...w,key:S,index:v,wrapper:Wpe(e.wrapper,w.wrapper)},this.getChildState(n,w),r?`${r}${o.key}`:o.key,i)];for(let D of _){var c,f;D.value=(f=(c=w.value)!==null&&c!==void 0?c:e.value)!==null&&f!==void 0?f:null,D.value&&this.cache.set(D.value,D);var u;if(e.type&&D.type!==e.type)throw new Error(`Unsupported type <${hT(D.type)}> in <${hT((u=i?.type)!==null&&u!==void 0?u:"unknown parent type")}>. Only <${hT(e.type)}> is supported.`);v++,yield D}x=y.next(_)}return}if(e.key==null||e.type==null)return;let d=this;var h,p;let g={type:e.type,props:e.props,key:e.key,parentKey:i?i.key:null,value:(h=e.value)!==null&&h!==void 0?h:null,level:i?i.level+1:0,index:e.index,rendered:e.rendered,textValue:(p=e.textValue)!==null&&p!==void 0?p:"","aria-label":e["aria-label"],wrapper:e.wrapper,shouldInvalidate:e.shouldInvalidate,hasChildNodes:e.hasChildNodes||!1,childNodes:iN(function*(){if(!e.hasChildNodes||!e.childNodes)return;let m=0;for(let y of e.childNodes()){y.key!=null&&(y.key=`${g.key}${y.key}`);let v=d.getFullNode({...y,index:m},d.getChildState(n,y),g.key,g);for(let x of v)m++,yield x}})};yield g}constructor(){this.cache=new WeakMap}}function iN(t){let e=[],n=null;return{*[Symbol.iterator](){for(let r of e)yield r;n||(n=t());for(let r of n)e.push(r),yield r}}}function Wpe(t,e){if(t&&e)return n=>t(e(n));if(t)return t;if(e)return e}function hT(t){return t[0].toUpperCase()+t.slice(1)}function Hpe(t,e,n){let r=H.useMemo(()=>new zpe,[]),{children:i,items:a,collection:o}=t;return H.useMemo(()=>{if(o)return o;let l=r.build({children:i,items:a},n);return e(l)},[r,i,a,o,n,e])}function hz(t,e){return typeof e.getChildren=="function"?e.getChildren(t.key):t.childNodes}function Kpe(t){return qpe(t)}function qpe(t,e){for(let n of t)return n}function pT(t,e,n){if(e.parentKey===n.parentKey)return e.index-n.index;let r=[...aN(t,e),e],i=[...aN(t,n),n],a=r.slice(0,i.length).findIndex((o,s)=>o!==i[s]);return a!==-1?(e=r[a],n=i[a],e.index-n.index):r.findIndex(o=>o===n)>=0?1:(i.findIndex(o=>o===e)>=0,-1)}function aN(t,e){let n=[],r=e;for(;r?.parentKey!=null;)r=t.getItem(r.parentKey),r&&n.unshift(r);return n}const oN=new WeakMap;function Xpe(t){let e=oN.get(t);if(e!=null)return e;let n=0,r=i=>{for(let a of i)a.type==="section"?r(hz(a,t)):a.type==="item"&&n++};return r(t),oN.set(t,n),n}class f9{get selectionMode(){return this.state.selectionMode}get disallowEmptySelection(){return this.state.disallowEmptySelection}get selectionBehavior(){return this.state.selectionBehavior}setSelectionBehavior(e){this.state.setSelectionBehavior(e)}get isFocused(){return this.state.isFocused}setFocused(e){this.state.setFocused(e)}get focusedKey(){return this.state.focusedKey}get childFocusStrategy(){return this.state.childFocusStrategy}setFocusedKey(e,n){(e==null||this.collection.getItem(e))&&this.state.setFocusedKey(e,n)}get selectedKeys(){return this.state.selectedKeys==="all"?new Set(this.getSelectAllKeys()):this.state.selectedKeys}get rawSelection(){return this.state.selectedKeys}isSelected(e){if(this.state.selectionMode==="none")return!1;let n=this.getKey(e);return n==null?!1:this.state.selectedKeys==="all"?this.canSelectItem(n):this.state.selectedKeys.has(n)}get isEmpty(){return this.state.selectedKeys!=="all"&&this.state.selectedKeys.size===0}get isSelectAll(){if(this.isEmpty)return!1;if(this.state.selectedKeys==="all")return!0;if(this._isSelectAll!=null)return this._isSelectAll;let e=this.getSelectAllKeys(),n=this.state.selectedKeys;return this._isSelectAll=e.every(r=>n.has(r)),this._isSelectAll}get firstSelectedKey(){let e=null;for(let r of this.state.selectedKeys){let i=this.collection.getItem(r);(!e||i&&pT(this.collection,i,e)<0)&&(e=i)}var n;return(n=e?.key)!==null&&n!==void 0?n:null}get lastSelectedKey(){let e=null;for(let r of this.state.selectedKeys){let i=this.collection.getItem(r);(!e||i&&pT(this.collection,i,e)>0)&&(e=i)}var n;return(n=e?.key)!==null&&n!==void 0?n:null}get disabledKeys(){return this.state.disabledKeys}get disabledBehavior(){return this.state.disabledBehavior}extendSelection(e){if(this.selectionMode==="none")return;if(this.selectionMode==="single"){this.replaceSelection(e);return}let n=this.getKey(e);if(n==null)return;let r;if(this.state.selectedKeys==="all")r=new sc([n],n,n);else{let o=this.state.selectedKeys;var i;let s=(i=o.anchorKey)!==null&&i!==void 0?i:n;r=new sc(o,s,n);var a;for(let l of this.getKeyRange(s,(a=o.currentKey)!==null&&a!==void 0?a:n))r.delete(l);for(let l of this.getKeyRange(n,s))this.canSelectItem(l)&&r.add(l)}this.state.setSelectedKeys(r)}getKeyRange(e,n){let r=this.collection.getItem(e),i=this.collection.getItem(n);return r&&i?pT(this.collection,r,i)<=0?this.getKeyRangeInternal(e,n):this.getKeyRangeInternal(n,e):[]}getKeyRangeInternal(e,n){var r;if(!((r=this.layoutDelegate)===null||r===void 0)&&r.getKeyRange)return this.layoutDelegate.getKeyRange(e,n);let i=[],a=e;for(;a!=null;){let o=this.collection.getItem(a);if(o&&(o.type==="item"||o.type==="cell"&&this.allowsCellSelection)&&i.push(a),a===n)return i;a=this.collection.getKeyAfter(a)}return[]}getKey(e){let n=this.collection.getItem(e);if(!n||n.type==="cell"&&this.allowsCellSelection)return e;for(;n&&n.type!=="item"&&n.parentKey!=null;)n=this.collection.getItem(n.parentKey);return!n||n.type!=="item"?null:n.key}toggleSelection(e){if(this.selectionMode==="none")return;if(this.selectionMode==="single"&&!this.isSelected(e)){this.replaceSelection(e);return}let n=this.getKey(e);if(n==null)return;let r=new sc(this.state.selectedKeys==="all"?this.getSelectAllKeys():this.state.selectedKeys);r.has(n)?r.delete(n):this.canSelectItem(n)&&(r.add(n),r.anchorKey=n,r.currentKey=n),!(this.disallowEmptySelection&&r.size===0)&&this.state.setSelectedKeys(r)}replaceSelection(e){if(this.selectionMode==="none")return;let n=this.getKey(e);if(n==null)return;let r=this.canSelectItem(n)?new sc([n],n,n):new sc;this.state.setSelectedKeys(r)}setSelectedKeys(e){if(this.selectionMode==="none")return;let n=new sc;for(let r of e){let i=this.getKey(r);if(i!=null&&(n.add(i),this.selectionMode==="single"))break}this.state.setSelectedKeys(n)}getSelectAllKeys(){let e=[],n=r=>{for(;r!=null;){if(this.canSelectItem(r)){var i;let o=this.collection.getItem(r);o?.type==="item"&&e.push(r);var a;o?.hasChildNodes&&(this.allowsCellSelection||o.type!=="item")&&n((a=(i=Kpe(hz(o,this.collection)))===null||i===void 0?void 0:i.key)!==null&&a!==void 0?a:null)}r=this.collection.getKeyAfter(r)}};return n(this.collection.getFirstKey()),e}selectAll(){!this.isSelectAll&&this.selectionMode==="multiple"&&this.state.setSelectedKeys("all")}clearSelection(){!this.disallowEmptySelection&&(this.state.selectedKeys==="all"||this.state.selectedKeys.size>0)&&this.state.setSelectedKeys(new sc)}toggleSelectAll(){this.isSelectAll?this.clearSelection():this.selectAll()}select(e,n){this.selectionMode!=="none"&&(this.selectionMode==="single"?this.isSelected(e)&&!this.disallowEmptySelection?this.toggleSelection(e):this.replaceSelection(e):this.selectionBehavior==="toggle"||n&&(n.pointerType==="touch"||n.pointerType==="virtual")?this.toggleSelection(e):this.replaceSelection(e))}isSelectionEqual(e){if(e===this.state.selectedKeys)return!0;let n=this.selectedKeys;if(e.size!==n.size)return!1;for(let r of e)if(!n.has(r))return!1;for(let r of n)if(!e.has(r))return!1;return!0}canSelectItem(e){var n;if(this.state.selectionMode==="none"||this.state.disabledKeys.has(e))return!1;let r=this.collection.getItem(e);return!(!r||!(r==null||(n=r.props)===null||n===void 0)&&n.isDisabled||r.type==="cell"&&!this.allowsCellSelection)}isDisabled(e){var n,r;return this.state.disabledBehavior==="all"&&(this.state.disabledKeys.has(e)||!!(!((r=this.collection.getItem(e))===null||r===void 0||(n=r.props)===null||n===void 0)&&n.isDisabled))}isLink(e){var n,r;return!!(!((r=this.collection.getItem(e))===null||r===void 0||(n=r.props)===null||n===void 0)&&n.href)}getItemProps(e){var n;return(n=this.collection.getItem(e))===null||n===void 0?void 0:n.props}withCollection(e){return new f9(e,this.state,{allowsCellSelection:this.allowsCellSelection,layoutDelegate:this.layoutDelegate||void 0})}constructor(e,n,r){this.collection=e,this.state=n;var i;this.allowsCellSelection=(i=r?.allowsCellSelection)!==null&&i!==void 0?i:!1,this._isSelectAll=null,this.layoutDelegate=r?.layoutDelegate||null}}function Ype(t){let e=Io(t,{enabled:typeof t.elementType=="string"}),n;return t.orientation==="vertical"&&(n="vertical"),t.elementType!=="hr"?{separatorProps:{...e,role:"separator","aria-orientation":n}}:{separatorProps:e}}function Jpe(t){const{as:e,className:n,orientation:r,...i}=t;let a=e||"hr";a==="hr"&&r==="vertical"&&(a="div");const{separatorProps:o}=Ype({elementType:typeof a=="string"?a:"hr",orientation:r}),s=H.useMemo(()=>Kde({orientation:r,className:n}),[r,n]),l=H.useCallback((c={})=>({className:s,role:"separator","data-orientation":r,...o,...i,...c}),[s,r,o,i]);return{Component:a,getDividerProps:l}}var pz=Hi((t,e)=>{const{Component:n,getDividerProps:r}=Jpe({...t});return j.jsx(n,{ref:e,...r()})});pz.displayName="HeroUI.Divider";var Zpe=pz,Qpe=t=>{const e={top:{originY:1},bottom:{originY:0},left:{originX:1},right:{originX:0},"top-start":{originX:0,originY:1},"top-end":{originX:1,originY:1},"bottom-start":{originX:0,originY:0},"bottom-end":{originX:1,originY:0},"right-start":{originX:0,originY:0},"right-end":{originX:0,originY:1},"left-start":{originX:1,originY:0},"left-end":{originX:1,originY:1}};return e?.[t]||{}},ege=t=>({top:"top",bottom:"bottom",left:"left",right:"right","top-start":"top start","top-end":"top end","bottom-start":"bottom start","bottom-end":"bottom end","left-start":"left top","left-end":"left bottom","right-start":"right top","right-end":"right bottom"})[t],tge=(t,e)=>{if(e.includes("-")){const[n]=e.split("-");if(n.includes(t))return!1}return!0},sN=(t,e)=>{if(e.includes("-")){const[,n]=e.split("-");return`${t}-${n}`}return t},j1=new WeakMap,ys=[];function nge(t,e=document.body){let n=new Set(t),r=new Set,i=l=>{for(let d of l.querySelectorAll("[data-live-announcer], [data-react-aria-top-layer]"))n.add(d);let c=d=>{if(n.has(d)||d.parentElement&&r.has(d.parentElement)&&d.parentElement.getAttribute("role")!=="row")return NodeFilter.FILTER_REJECT;for(let h of n)if(d.contains(h))return NodeFilter.FILTER_SKIP;return NodeFilter.FILTER_ACCEPT},f=document.createTreeWalker(l,NodeFilter.SHOW_ELEMENT,{acceptNode:c}),u=c(l);if(u===NodeFilter.FILTER_ACCEPT&&a(l),u!==NodeFilter.FILTER_REJECT){let d=f.nextNode();for(;d!=null;)a(d),d=f.nextNode()}},a=l=>{var c;let f=(c=j1.get(l))!=null?c:0;l.getAttribute("aria-hidden")==="true"&&f===0||(f===0&&l.setAttribute("aria-hidden","true"),r.add(l),j1.set(l,f+1))};ys.length&&ys[ys.length-1].disconnect(),i(e);let o=new MutationObserver(l=>{for(let c of l)if(!(c.type!=="childList"||c.addedNodes.length===0)&&![...n,...r].some(f=>f.contains(c.target))){for(let f of c.removedNodes)f instanceof Element&&(n.delete(f),r.delete(f));for(let f of c.addedNodes)(f instanceof HTMLElement||f instanceof SVGElement)&&(f.dataset.liveAnnouncer==="true"||f.dataset.reactAriaTopLayer==="true")?n.add(f):f instanceof Element&&i(f)}});o.observe(e,{childList:!0,subtree:!0});let s={visibleNodes:n,hiddenNodes:r,observe(){o.observe(e,{childList:!0,subtree:!0})},disconnect(){o.disconnect()}};return ys.push(s),()=>{o.disconnect();for(let l of r){let c=j1.get(l);c!=null&&(c===1?(l.removeAttribute("aria-hidden"),j1.delete(l)):j1.set(l,c-1))}s===ys[ys.length-1]?(ys.pop(),ys.length&&ys[ys.length-1].observe()):ys.splice(ys.indexOf(s),1)}}function rge(t){let e=ys[ys.length-1];if(e&&!e.visibleNodes.has(t))return e.visibleNodes.add(t),()=>{e.visibleNodes.delete(t)}}var d9=globalThis?.document?H.useLayoutEffect:H.useEffect,[rje,ige]=cw({name:"ButtonGroupContext",strict:!1});function h9(t,e){let{elementType:n="button",isDisabled:r,onPress:i,onPressStart:a,onPressEnd:o,onPressUp:s,onPressChange:l,preventFocusOnPress:c,allowFocusWhenDisabled:f,onClick:u,href:d,target:h,rel:p,type:g="button",allowTextSelectionOnPress:m}=t,y;n==="button"?y={type:g,disabled:r}:y={role:"button",href:n==="a"&&!r?d:void 0,target:n==="a"?h:void 0,type:n==="input"?g:void 0,disabled:n==="input"?r:void 0,"aria-disabled":!r||n==="input"?void 0:r,rel:n==="a"?p:void 0};let{pressProps:v,isPressed:x}=Uf({onClick:u,onPressStart:a,onPressEnd:o,onPressUp:s,onPressChange:l,onPress:i,isDisabled:r,preventFocusOnPress:c,allowTextSelectionOnPress:m,ref:e}),{focusableProps:w}=_w(t,e);f&&(w.tabIndex=r?-1:w.tabIndex);let S=Oi(w,v,T0(t,{labelable:!0}));return{isPressed:x,buttonProps:Oi(y,S,{"aria-haspopup":t["aria-haspopup"],"aria-expanded":t["aria-expanded"],"aria-controls":t["aria-controls"],"aria-pressed":t["aria-pressed"],"aria-current":t["aria-current"]})}}var age=()=>Cm(()=>import("./index-DOsZaCpu.js"),[]).then(t=>t.default),gz=t=>{const{ripples:e=[],motionProps:n,color:r="currentColor",style:i,onClear:a}=t;return j.jsx(j.Fragment,{children:e.map(o=>{const s=_U(.01*o.size,.2,o.size>100?.75:.5);return j.jsx(_m,{features:age,children:j.jsx(ww,{mode:"popLayout",children:j.jsx(Gh.span,{animate:{transform:"scale(2)",opacity:0},className:"heroui-ripple",exit:{opacity:0},initial:{transform:"scale(0)",opacity:.35},style:{position:"absolute",backgroundColor:r,borderRadius:"100%",transformOrigin:"center",pointerEvents:"none",overflow:"hidden",inset:0,zIndex:0,top:o.y,left:o.x,width:`${o.size}px`,height:`${o.size}px`,...i},transition:{duration:s},onAnimationComplete:()=>{a(o.key)},...n})})},o.key)})})};gz.displayName="HeroUI.Ripple";var mz=gz;function vz(t={}){const[e,n]=H.useState([]),r=H.useCallback(a=>{const o=a.target,s=Math.max(o.clientWidth,o.clientHeight);n(l=>[...l,{key:EU(l.length.toString()),size:s,x:a.x-s/2,y:a.y-s/2}])},[]),i=H.useCallback(a=>{n(o=>o.filter(s=>s.key!==a))},[]);return{ripples:e,onClear:i,onPress:r,...t}}function oge(t){var e,n,r,i,a,o,s,l,c;const f=ige(),u=es(),d=!!f,{ref:h,as:p,children:g,startContent:m,endContent:y,autoFocus:v,className:x,spinner:w,isLoading:S=!1,disableRipple:T=!1,fullWidth:_=(e=f?.fullWidth)!=null?e:!1,radius:D=f?.radius,size:I=(n=f?.size)!=null?n:"md",color:R=(r=f?.color)!=null?r:"default",variant:M=(i=f?.variant)!=null?i:"solid",disableAnimation:A=(o=(a=f?.disableAnimation)!=null?a:u?.disableAnimation)!=null?o:!1,isDisabled:L=(s=f?.isDisabled)!=null?s:!1,isIconOnly:P=(l=f?.isIconOnly)!=null?l:!1,spinnerPlacement:B="start",onPress:U,onClick:G,...F}=t,$=p||"button",V=typeof $=="string",X=Di(h),Q=(c=T||u?.disableRipple)!=null?c:A,{isFocusVisible:re,isFocused:ye,focusProps:me}=Pl({autoFocus:v}),Ce=L||S,we=H.useMemo(()=>WG({size:I,color:R,variant:M,radius:D,fullWidth:_,isDisabled:Ce,isInGroup:d,disableAnimation:A,isIconOnly:P,className:x}),[I,R,M,D,_,Ce,d,P,A,x]),{onPress:Ae,onClear:De,ripples:q}=vz(),k=H.useCallback(ge=>{Q||Ce||A||X.current&&Ae(ge)},[Q,Ce,A,X,Ae]),{buttonProps:J,isPressed:Y}=h9({elementType:p,isDisabled:Ce,onPress:Rf(U,k),onClick:G,...F},X),{isHovered:ie,hoverProps:ue}=Zs({isDisabled:Ce}),fe=H.useCallback((ge={})=>({"data-disabled":Nt(Ce),"data-focus":Nt(ye),"data-pressed":Nt(Y),"data-focus-visible":Nt(re),"data-hover":Nt(ie),"data-loading":Nt(S),...Pn(J,me,ue,Io(F,{enabled:V}),Io(ge)),className:we}),[S,Ce,ye,Y,V,re,ie,J,me,ue,F,we]),Se=ge=>H.isValidElement(ge)?H.cloneElement(ge,{"aria-hidden":!0,focusable:!1}):null,Fe=Se(m),Ke=Se(y),He=H.useMemo(()=>({sm:"sm",md:"sm",lg:"md"})[I],[I]),pe=H.useCallback(()=>({ripples:q,onClear:De}),[q,De]);return{Component:$,children:g,domRef:X,spinner:w,styles:we,startContent:Fe,endContent:Ke,isLoading:S,spinnerPlacement:B,spinnerSize:He,disableRipple:Q,getButtonProps:fe,getRippleProps:pe,isIconOnly:P}}var yz=Hi((t,e)=>{const{Component:n,domRef:r,children:i,spinnerSize:a,spinner:o=j.jsx(Dw,{color:"current",size:a}),spinnerPlacement:s,startContent:l,endContent:c,isLoading:f,disableRipple:u,getButtonProps:d,getRippleProps:h,isIconOnly:p}=oge({...t,ref:e});return j.jsxs(n,{ref:r,...d(),children:[l,f&&s==="start"&&o,f&&p?null:i,f&&s==="end"&&o,c,!u&&j.jsx(mz,{...h()})]})});yz.displayName="HeroUI.Button";var zr=yz,[sge,xz]=cw({name:"CardContext",strict:!0,errorMessage:"useCardContext: `context` is undefined. Seems you forgot to wrap component within <Card />"}),bz=Hi((t,e)=>{var n;const{as:r,className:i,children:a,...o}=t,s=r||"div",l=Di(e),{slots:c,classNames:f}=xz(),u=ln(f?.body,i);return j.jsx(s,{ref:l,className:(n=c.body)==null?void 0:n.call(c,{class:u}),...o,children:a})});bz.displayName="HeroUI.CardBody";var Jc=bz,wz=Hi((t,e)=>{var n;const{as:r,className:i,children:a,...o}=t,s=r||"div",l=Di(e),{slots:c,classNames:f}=xz(),u=ln(f?.header,i);return j.jsx(s,{ref:l,className:(n=c.header)==null?void 0:n.call(c,{class:u}),...o,children:a})});wz.displayName="HeroUI.CardHeader";var YE=wz;function lge(t){var e,n,r,i;const a=es(),[o,s]=Vl(t,OP.variantKeys),{ref:l,as:c,children:f,onClick:u,onPress:d,autoFocus:h,className:p,classNames:g,allowTextSelectionOnPress:m=!0,...y}=o,v=Di(l),x=c||(t.isPressable?"button":"div"),w=typeof x=="string",S=(n=(e=t.disableAnimation)!=null?e:a?.disableAnimation)!=null?n:!1,T=(i=(r=t.disableRipple)!=null?r:a?.disableRipple)!=null?i:!1,_=ln(g?.base,p),{onClear:D,onPress:I,ripples:R}=vz(),M=H.useCallback(re=>{T||S||v.current&&I(re)},[T,S,v,I]),{buttonProps:A,isPressed:L}=h9({onPress:Rf(d,M),elementType:c,isDisabled:!t.isPressable,onClick:u,allowTextSelectionOnPress:m,...y},v),{hoverProps:P,isHovered:B}=Zs({isDisabled:!t.isHoverable,...y}),{isFocusVisible:U,isFocused:G,focusProps:F}=Pl({autoFocus:h}),$=H.useMemo(()=>OP({...s,disableAnimation:S}),[kl(s),S]),V=H.useMemo(()=>({slots:$,classNames:g,disableAnimation:S,isDisabled:t.isDisabled,isFooterBlurred:t.isFooterBlurred,fullWidth:t.fullWidth}),[$,g,t.isDisabled,t.isFooterBlurred,S,t.fullWidth]),X=H.useCallback((re={})=>({ref:v,className:$.base({class:_}),tabIndex:t.isPressable?0:-1,"data-hover":Nt(B),"data-pressed":Nt(L),"data-focus":Nt(G),"data-focus-visible":Nt(U),"data-disabled":Nt(t.isDisabled),...Pn(t.isPressable?{...A,...F,role:"button"}:{},t.isHoverable?P:{},Io(y,{enabled:w}),Io(re))}),[v,$,_,w,t.isPressable,t.isHoverable,t.isDisabled,B,L,U,A,F,P,y]),Q=H.useCallback(()=>({ripples:R,onClear:D}),[R,D]);return{context:V,domRef:v,Component:x,classNames:g,children:f,isHovered:B,isPressed:L,disableAnimation:S,isPressable:t.isPressable,isHoverable:t.isHoverable,disableRipple:T,handlePress:M,isFocusVisible:U,getCardProps:X,getRippleProps:Q}}var Cz=Hi((t,e)=>{const{children:n,context:r,Component:i,isPressable:a,disableAnimation:o,disableRipple:s,getCardProps:l,getRippleProps:c}=lge({...t,ref:e});return j.jsxs(i,{...l(),children:[j.jsx(sge,{value:r,children:n}),a&&!o&&!s&&j.jsx(mz,{...c()})]})});Cz.displayName="HeroUI.Card";var Zc=Cz;function cge(t){const[e,n]=Vl(t,MP.variantKeys),{ref:r,as:i,children:a,avatar:o,startContent:s,endContent:l,onClose:c,classNames:f,className:u,...d}=e,h=i||"div",p=Di(r),g=ln(f?.base,u),m=!!c,y=t.variant==="dot",{focusProps:v,isFocusVisible:x}=Pl(),w=H.useMemo(()=>typeof a=="string"&&a?.length===1,[a]),S=H.useMemo(()=>!!o||!!s,[o,s]),T=H.useMemo(()=>!!l||m,[l,m]),_=H.useMemo(()=>MP({...n,hasStartContent:S,hasEndContent:T,isOneChar:w,isCloseable:m,isCloseButtonFocusVisible:x}),[kl(n),x,S,T,w,m]),{pressProps:D}=Uf({isDisabled:!!t?.isDisabled,onPress:c}),I=()=>({ref:p,className:_.base({class:g}),...d}),R=()=>({role:"button",tabIndex:0,className:_.closeButton({class:f?.closeButton}),"aria-label":"close chip",...Pn(D,v)}),M=L=>H.isValidElement(L)?H.cloneElement(L,{className:_.avatar({class:f?.avatar})}):null,A=L=>H.isValidElement(L)?H.cloneElement(L,{className:ln("max-h-[80%]",L.props.className)}):null;return{Component:h,children:a,slots:_,classNames:f,isDot:y,isCloseable:m,startContent:M(o)||A(s),endContent:A(l),getCloseButtonProps:R,getChipProps:I}}var Sz=Hi((t,e)=>{const{Component:n,children:r,slots:i,classNames:a,isDot:o,isCloseable:s,startContent:l,endContent:c,getCloseButtonProps:f,getChipProps:u}=cge({...t,ref:e}),d=H.useMemo(()=>o&&!l?j.jsx("span",{className:i.dot({class:a?.dot})}):l,[i,l,o]),h=H.useMemo(()=>s?j.jsx("span",{...f(),children:c||j.jsx(s9,{})}):c,[c,s,f]);return j.jsxs(n,{...u(),children:[d,j.jsx("span",{className:i.content({class:a?.content}),children:r}),h]})});Sz.displayName="HeroUI.Chip";var f2=Sz;const Tz={badInput:!1,customError:!1,patternMismatch:!1,rangeOverflow:!1,rangeUnderflow:!1,stepMismatch:!1,tooLong:!1,tooShort:!1,typeMismatch:!1,valueMissing:!1,valid:!0},Ez={...Tz,customError:!0,valid:!1},z1={isInvalid:!1,validationDetails:Tz,validationErrors:[]},_z=H.createContext({}),lN="__formValidationState"+Date.now();function Dz(t){if(t[lN]){let{realtimeValidation:e,displayValidation:n,updateValidation:r,resetValidation:i,commitValidation:a}=t[lN];return{realtimeValidation:e,displayValidation:n,updateValidation:r,resetValidation:i,commitValidation:a}}return uge(t)}function uge(t){let{isInvalid:e,validationState:n,name:r,value:i,builtinValidation:a,validate:o,validationBehavior:s="aria"}=t;n&&(e||(e=n==="invalid"));let l=e!==void 0?{isInvalid:e,validationErrors:[],validationDetails:Ez}:null,c=H.useMemo(()=>{if(!o||i==null)return null;let R=fge(o,i);return cN(R)},[o,i]);a?.validationDetails.valid&&(a=void 0);let f=H.useContext(_z),u=H.useMemo(()=>r?Array.isArray(r)?r.flatMap(R=>JE(f[R])):JE(f[r]):[],[f,r]),[d,h]=H.useState(f),[p,g]=H.useState(!1);f!==d&&(h(f),g(!1));let m=H.useMemo(()=>cN(p?[]:u),[p,u]),y=H.useRef(z1),[v,x]=H.useState(z1),w=H.useRef(z1),S=()=>{if(!T)return;_(!1);let R=c||a||y.current;gT(R,w.current)||(w.current=R,x(R))},[T,_]=H.useState(!1);return H.useEffect(S),{realtimeValidation:l||m||c||a||z1,displayValidation:s==="native"?l||m||v:l||m||c||a||v,updateValidation(R){s==="aria"&&!gT(v,R)?x(R):y.current=R},resetValidation(){let R=z1;gT(R,w.current)||(w.current=R,x(R)),s==="native"&&_(!1),g(!0)},commitValidation(){s==="native"&&_(!0),g(!0)}}}function JE(t){return t?Array.isArray(t)?t:[t]:[]}function fge(t,e){if(typeof t=="function"){let n=t(e);if(n&&typeof n!="boolean")return JE(n)}return[]}function cN(t){return t.length?{isInvalid:!0,validationErrors:t,validationDetails:Ez}:null}function gT(t,e){return t===e?!0:!!t&&!!e&&t.isInvalid===e.isInvalid&&t.validationErrors.length===e.validationErrors.length&&t.validationErrors.every((n,r)=>n===e.validationErrors[r])&&Object.entries(t.validationDetails).every(([n,r])=>e.validationDetails[n]===r)}function Oz(t,e,n){let{validationBehavior:r,focus:i}=t;Br(()=>{if(r==="native"&&n?.current&&!n.current.disabled){let c=e.realtimeValidation.isInvalid?e.realtimeValidation.validationErrors.join(" ")||"Invalid value.":"";n.current.setCustomValidity(c),n.current.hasAttribute("title")||(n.current.title=""),e.realtimeValidation.isInvalid||e.updateValidation(hge(n.current))}});let a=H.useRef(!1),o=va(()=>{a.current||e.resetValidation()}),s=va(c=>{var f;e.displayValidation.isInvalid||e.commitValidation();let u=n==null||(f=n.current)===null||f===void 0?void 0:f.form;if(!c.defaultPrevented&&n&&u&&pge(u)===n.current){var d;i?i():(d=n.current)===null||d===void 0||d.focus(),V$("keyboard")}c.preventDefault()}),l=va(()=>{e.commitValidation()});H.useEffect(()=>{let c=n?.current;if(!c)return;let f=c.form,u=f?.reset;return f&&(f.reset=()=>{a.current=!window.event||window.event.type==="message"&&window.event.target instanceof MessagePort,u?.call(f),a.current=!1}),c.addEventListener("invalid",s),c.addEventListener("change",l),f?.addEventListener("reset",o),()=>{c.removeEventListener("invalid",s),c.removeEventListener("change",l),f?.removeEventListener("reset",o),f&&(f.reset=u)}},[n,s,l,o,r])}function dge(t){let e=t.validity;return{badInput:e.badInput,customError:e.customError,patternMismatch:e.patternMismatch,rangeOverflow:e.rangeOverflow,rangeUnderflow:e.rangeUnderflow,stepMismatch:e.stepMismatch,tooLong:e.tooLong,tooShort:e.tooShort,typeMismatch:e.typeMismatch,valueMissing:e.valueMissing,valid:e.valid}}function hge(t){return{isInvalid:!t.validity.valid,validationDetails:dge(t),validationErrors:t.validationMessage?[t.validationMessage]:[]}}function pge(t){for(let e=0;e<t.elements.length;e++){let n=t.elements[e];if(!n.validity.valid)return n}return null}function Mz(t){let{id:e,label:n,"aria-labelledby":r,"aria-label":i,labelElementType:a="label"}=t;e=Js(e);let o=Js(),s={};n&&(r=r?`${o} ${r}`:o,s={id:o,htmlFor:a==="label"?e:void 0});let l=yw({id:e,"aria-label":i,"aria-labelledby":r});return{labelProps:s,fieldProps:l}}function Iz(t){let{description:e,errorMessage:n,isInvalid:r,validationState:i}=t,{labelProps:a,fieldProps:o}=Mz(t),s=am([!!e,!!n,r,i]),l=am([!!e,!!n,r,i]);return o=Oi(o,{"aria-describedby":[s,l,t["aria-describedby"]].filter(Boolean).join(" ")||void 0}),{labelProps:a,fieldProps:o,descriptionProps:{id:s},errorMessageProps:{id:l}}}var uN=Symbol("default");function gge(t){const e=H.useRef(null),n=H.useRef(void 0),r=H.useCallback(i=>{if(typeof t=="function"){const a=t,o=a(i);return()=>{typeof o=="function"?o():a(null)}}else if(t)return t.current=i,()=>{t.current=null}},[t]);return H.useMemo(()=>({get current(){return e.current},set current(i){e.current=i,n.current&&(n.current(),n.current=void 0),i!=null&&(n.current=r(i))}}),[r])}function p9(t,e){let n=H.useContext(t);if(e===null)return null;if(n&&typeof n=="object"&&"slots"in n&&n.slots){let r=new Intl.ListFormat().format(Object.keys(n.slots).map(a=>`"${a}"`));if(!e&&!n.slots[uN])throw new Error(`A slot prop is required. Valid slot names are ${r}.`);let i=e||uN;if(!n.slots[i])throw new Error(`Invalid slot "${e}". Valid slot names are ${r}.`);return n.slots[i]}return n}function mge(t,e,n){let r=p9(n,t.slot)||{},{ref:i,...a}=r,o=gge(H.useMemo(()=>DU(e,i),[e,i])),s=Pn(a,t);return"style"in a&&a.style&&"style"in t&&t.style&&(typeof a.style=="function"||typeof t.style=="function"?s.style=l=>{let c=typeof a.style=="function"?a.style(l):a.style,f={...l.defaultStyle,...c},u=typeof t.style=="function"?t.style({...l,defaultStyle:f}):t.style;return{...f,...u}}:s.style={...a.style,...t.style}),[s,o]}var Xb=H.createContext(null);H.forwardRef(function(e,n){[e,n]=mge(e,n,Xb);let{validationErrors:r,validationBehavior:i="native",children:a,className:o,...s}=e;const l=H.useMemo(()=>qde({className:o}),[o]);return j.jsx("form",{noValidate:i!=="native",...s,ref:n,className:l,children:j.jsx(Xb.Provider,{value:{...e,validationBehavior:i},children:j.jsx(_z.Provider,{value:r??{},children:a})})})});var Rz=Hi((t,e)=>{const{as:n,activePage:r,...i}=t,a=n||"span",o=Di(e);return j.jsx(a,{ref:o,"aria-hidden":!0,...i,children:r})});Rz.displayName="HeroUI.PaginationCursor";var vge=Rz;function yge(t){const{as:e,ref:n,value:r,children:i,isActive:a,isDisabled:o,onPress:s,onClick:l,getAriaLabel:c,className:f,...u}=t,d=!!t?.href,h=e||d?"a":"li",p=typeof h=="string",g=Di(n),m=mw(),y=H.useMemo(()=>a?`${c?.(r)} active`:c?.(r),[r,a]),{isPressed:v,pressProps:x}=Uf({isDisabled:o,onPress:s}),{focusProps:w,isFocused:S,isFocusVisible:T}=Pl({}),{isHovered:_,hoverProps:D}=Zs({isDisabled:o});return{Component:h,children:i,ariaLabel:y,isFocused:S,isFocusVisible:T,getItemProps:(R={})=>({ref:g,role:"button",tabIndex:o?-1:0,"aria-label":y,"aria-current":Nt(a),"aria-disabled":Nt(o),"data-disabled":Nt(o),"data-active":Nt(a),"data-focus":Nt(S),"data-hover":Nt(_),"data-pressed":Nt(v),"data-focus-visible":Nt(T),...Pn(R,x,w,D,Io(u,{enabled:p})),className:ln(f,R.className),onClick:M=>{Rf(x?.onClick,l)(M),!m.isNative&&M.currentTarget instanceof HTMLAnchorElement&&M.currentTarget.href&&!M.isDefaultPrevented()&&FU(M.currentTarget,M)&&R.href&&(M.preventDefault(),m.open(M.currentTarget,M,R.href,R.routerOptions))}})}}var Az=Hi((t,e)=>{const{Component:n,children:r,getItemProps:i}=yge({...t,ref:e});return j.jsx(n,{...i(),children:r})});Az.displayName="HeroUI.PaginationItem";var G5=Az,Gi=(t=>(t.DOTS="dots",t.PREV="prev",t.NEXT="next",t))(Gi||{});function xge(t){const{page:e,total:n,siblings:r=1,boundaries:i=1,initialPage:a=1,showControls:o=!1,onChange:s}=t,[l,c]=H.useState(e||a),{direction:f}=ap(),u=f==="rtl",d=w=>{c(w),s&&s(w)};H.useEffect(()=>{e&&e!==l&&c(e)},[e]);const h=H.useCallback(w=>{w<=0?d(1):w>n?d(n):d(w)},[n,l,d]),p=()=>h(l+1),g=()=>h(l-1),m=()=>h(1),y=()=>h(n),v=H.useCallback(w=>o?["prev",...w,"next"]:w,[u,o]);return{range:H.useMemo(()=>{if(r*2+3+i*2>=n)return v(fd(1,n));const S=Math.max(l-r,i),T=Math.min(l+r,n-i),_=S>i+2,D=T<n-(i+1);if(!_&&D){const I=r*2+i+2;return v([...fd(1,I),"dots",...fd(n-(i-1),n)])}if(_&&!D){const I=i+1+2*r;return v([...fd(1,i),"dots",...fd(n-I,n)])}return v([...fd(1,i),"dots",...fd(S,T),"dots",...fd(n-i+1,n)])},[n,l,r,i,v]),activePage:l,setPage:h,next:p,previous:g,first:m,last:y}}const fN=t=>typeof t=="object"&&t!=null&&t.nodeType===1,dN=(t,e)=>(!e||t!=="hidden")&&t!=="visible"&&t!=="clip",j5=(t,e)=>{if(t.clientHeight<t.scrollHeight||t.clientWidth<t.scrollWidth){const n=getComputedStyle(t,null);return dN(n.overflowY,e)||dN(n.overflowX,e)||(r=>{const i=(a=>{if(!a.ownerDocument||!a.ownerDocument.defaultView)return null;try{return a.ownerDocument.defaultView.frameElement}catch{return null}})(r);return!!i&&(i.clientHeight<r.scrollHeight||i.clientWidth<r.scrollWidth)})(t)}return!1},z5=(t,e,n,r,i,a,o,s)=>a<t&&o>e||a>t&&o<e?0:a<=t&&s<=n||o>=e&&s>=n?a-t-r:o>e&&s<n||a<t&&s>n?o-e+i:0,bge=t=>{const e=t.parentElement;return e??(t.getRootNode().host||null)},hN=(t,e)=>{var n,r,i,a;if(typeof document>"u")return[];const{scrollMode:o,block:s,inline:l,boundary:c,skipOverflowHiddenElements:f}=e,u=typeof c=="function"?c:U=>U!==c;if(!fN(t))throw new TypeError("Invalid target");const d=document.scrollingElement||document.documentElement,h=[];let p=t;for(;fN(p)&&u(p);){if(p=bge(p),p===d){h.push(p);break}p!=null&&p===document.body&&j5(p)&&!j5(document.documentElement)||p!=null&&j5(p,f)&&h.push(p)}const g=(r=(n=window.visualViewport)==null?void 0:n.width)!=null?r:innerWidth,m=(a=(i=window.visualViewport)==null?void 0:i.height)!=null?a:innerHeight,{scrollX:y,scrollY:v}=window,{height:x,width:w,top:S,right:T,bottom:_,left:D}=t.getBoundingClientRect(),{top:I,right:R,bottom:M,left:A}=(U=>{const G=window.getComputedStyle(U);return{top:parseFloat(G.scrollMarginTop)||0,right:parseFloat(G.scrollMarginRight)||0,bottom:parseFloat(G.scrollMarginBottom)||0,left:parseFloat(G.scrollMarginLeft)||0}})(t);let L=s==="start"||s==="nearest"?S-I:s==="end"?_+M:S+x/2-I+M,P=l==="center"?D+w/2-A+R:l==="end"?T+R:D-A;const B=[];for(let U=0;U<h.length;U++){const G=h[U],{height:F,width:$,top:V,right:X,bottom:Q,left:re}=G.getBoundingClientRect();if(o==="if-needed"&&S>=0&&D>=0&&_<=m&&T<=g&&(G===d&&!j5(G)||S>=V&&_<=Q&&D>=re&&T<=X))return B;const ye=getComputedStyle(G),me=parseInt(ye.borderLeftWidth,10),Ce=parseInt(ye.borderTopWidth,10),we=parseInt(ye.borderRightWidth,10),Ae=parseInt(ye.borderBottomWidth,10);let De=0,q=0;const k="offsetWidth"in G?G.offsetWidth-G.clientWidth-me-we:0,J="offsetHeight"in G?G.offsetHeight-G.clientHeight-Ce-Ae:0,Y="offsetWidth"in G?G.offsetWidth===0?0:$/G.offsetWidth:0,ie="offsetHeight"in G?G.offsetHeight===0?0:F/G.offsetHeight:0;if(d===G)De=s==="start"?L:s==="end"?L-m:s==="nearest"?z5(v,v+m,m,Ce,Ae,v+L,v+L+x,x):L-m/2,q=l==="start"?P:l==="center"?P-g/2:l==="end"?P-g:z5(y,y+g,g,me,we,y+P,y+P+w,w),De=Math.max(0,De+v),q=Math.max(0,q+y);else{De=s==="start"?L-V-Ce:s==="end"?L-Q+Ae+J:s==="nearest"?z5(V,Q,F,Ce,Ae+J,L,L+x,x):L-(V+F/2)+J/2,q=l==="start"?P-re-me:l==="center"?P-(re+$/2)+k/2:l==="end"?P-X+we+k:z5(re,X,$,me,we+k,P,P+w,w);const{scrollLeft:ue,scrollTop:fe}=G;De=ie===0?0:Math.max(0,Math.min(fe+De/ie,G.scrollHeight-F/ie+J)),q=Y===0?0:Math.max(0,Math.min(ue+q/Y,G.scrollWidth-$/Y+k)),L+=fe-De,P+=ue-q}B.push({el:G,top:De,left:q})}return B},wge=t=>t===!1?{block:"end",inline:"nearest"}:(e=>e===Object(e)&&Object.keys(e).length!==0)(t)?t:{block:"start",inline:"nearest"};function Pz(t,e){if(!t.isConnected||!(r=>{let i=r;for(;i&&i.parentNode;){if(i.parentNode===document)return!0;i=i.parentNode instanceof ShadowRoot?i.parentNode.host:i.parentNode}return!1})(t))return;if((r=>typeof r=="object"&&typeof r.behavior=="function")(e))return e.behavior(hN(t,e));const n=typeof e=="boolean"||e==null?void 0:e.behavior;for(const{el:r,top:i,left:a}of hN(t,wge(e)))r.scroll({top:i,left:a,behavior:n})}function Cge({threshold:t=0,root:e=null,rootMargin:n="0%",isEnabled:r=!0,freezeOnceVisible:i=!1,initialIsIntersecting:a=!1,onChange:o}={}){var s;const[l,c]=H.useState(null),[f,u]=H.useState(()=>({isIntersecting:a,entry:void 0})),d=H.useRef();d.current=o;const h=((s=f.entry)==null?void 0:s.isIntersecting)&&i;H.useEffect(()=>{if(!r||!l||!("IntersectionObserver"in window)||h)return;const m=new IntersectionObserver(y=>{const v=Array.isArray(m.thresholds)?m.thresholds:[m.thresholds];y.forEach(x=>{const w=x.isIntersecting&&v.some(S=>x.intersectionRatio>=S);u({isIntersecting:w,entry:x}),d.current&&d.current(w,x)})},{threshold:t,root:e,rootMargin:n});return m.observe(l),()=>{m.disconnect()}},[l,r,JSON.stringify(t),e,n,h,i]);const p=H.useRef(null);H.useEffect(()=>{var m;!l&&((m=f.entry)!=null&&m.target)&&!i&&!h&&p.current!==f.entry.target&&(p.current=f.entry.target,u({isIntersecting:a,entry:void 0}))},[l,f.entry,i,h,a]);const g=[c,!!f.isIntersecting,f.entry];return g.ref=g[0],g.isIntersecting=g[1],g.entry=g[2],g}var pN=300;function Sge(t){var e,n,r,i;const a=es(),[o,s]=Vl(t,SP.variantKeys),{as:l,ref:c,classNames:f,dotsJump:u=5,loop:d=!1,showControls:h=!1,total:p=1,initialPage:g=1,page:m,siblings:y,boundaries:v,onChange:x,className:w,renderItem:S,getItemAriaLabel:T,..._}=o,D=l||"nav",I=Di(c),R=H.useRef(null),M=H.useRef(),A=H.useRef(),L=(n=(e=t?.disableAnimation)!=null?e:a?.disableAnimation)!=null?n:!1,P=(i=(r=t?.disableCursorAnimation)!=null?r:L)!=null?i:!1;function B(){return M.current||(M.current=new Map),M.current}function U(Se,Fe){const Ke=B();Se?Ke.set(Fe,Se):Ke.delete(Fe)}function G(Se,Fe){const He=B().get(Se);if(!He||!R.current)return;A.current&&clearTimeout(A.current),Pz(He,{scrollMode:"always",behavior:"smooth",block:"start",inline:"start",boundary:I.current});const{offsetLeft:pe}=He;if(Fe){R.current.setAttribute("data-moving","false"),R.current.style.transform=`translateX(${pe}px) scale(1)`;return}R.current.setAttribute("data-moving","true"),R.current.style.transform=`translateX(${pe}px) scale(1.1)`,A.current=setTimeout(()=>{R.current&&(R.current.style.transform=`translateX(${pe}px) scale(1)`),A.current=setTimeout(()=>{var ge;(ge=R.current)==null||ge.setAttribute("data-moving","false"),A.current&&clearTimeout(A.current)},pN)},pN)}const{range:F,activePage:$,setPage:V,previous:X,next:Q,first:re,last:ye}=xge({page:m,total:p,initialPage:g,siblings:y,boundaries:v,showControls:h,onChange:x}),[me,Ce]=Cge();H.useEffect(()=>{I.current&&me(I.current)},[I.current]);const we=H.useRef($);H.useEffect(()=>{$&&!L&&Ce&&G($,$===we.current),we.current=$},[m,$,L,P,Ce,t.dotsJump,t.isCompact,t.showControls]);const Ae=H.useMemo(()=>SP({...s,disableAnimation:L,disableCursorAnimation:P}),[kl(s),P,L]),De=ln(f?.base,w);return{Component:D,showControls:h,dotsJump:u,slots:Ae,classNames:f,loop:d,total:p,range:F,activePage:$,getItemRef:U,disableAnimation:L,disableCursorAnimation:P,setPage:V,onPrevious:()=>d&&$===1?ye():X(),onNext:()=>d&&$===p?re():Q(),renderItem:S,getBaseProps:(Se={})=>({...Se,ref:I,role:"navigation","aria-label":Se["aria-label"]||"pagination navigation","data-slot":"base","data-controls":Nt(h),"data-loop":Nt(d),"data-dots-jump":u,"data-total":p,"data-active-page":$,className:Ae.base({class:ln(De,Se?.className)}),..._}),getWrapperProps:(Se={})=>({...Se,"data-slot":"wrapper",className:Ae.wrapper({class:ln(f?.wrapper,Se?.className)})}),getItemProps:(Se={})=>({...Se,ref:Fe=>U(Fe,Se.value),"data-slot":"item",isActive:Se.value===$,className:Ae.item({class:ln(f?.item,Se?.className)}),onPress:()=>{Se.value!==$&&V(Se.value)}}),getCursorProps:(Se={})=>({...Se,ref:R,activePage:$,"data-slot":"cursor",className:Ae.cursor({class:ln(f?.cursor,Se?.className)})}),getItemAriaLabel:Se=>{if(Se){if(T)return T(Se);switch(Se){case Gi.DOTS:return"dots element";case Gi.PREV:return"previous page button";case Gi.NEXT:return"next page button";case"first":return"first page button";case"last":return"last page button";default:return`pagination item ${Se}`}}}}}var Nz=Hi((t,e)=>{const{Component:n,dotsJump:r,slots:i,classNames:a,total:o,range:s,loop:l,activePage:c,disableCursorAnimation:f,disableAnimation:u,renderItem:d,onNext:h,onPrevious:p,setPage:g,getItemAriaLabel:m,getItemRef:y,getBaseProps:v,getWrapperProps:x,getItemProps:w,getCursorProps:S}=Sge({...t,ref:e}),{direction:T}=ap(),_=T==="rtl",D=H.useCallback(A=>A===Gi.PREV&&!_||A===Gi.NEXT&&_?j.jsx(LP,{}):j.jsx(LP,{className:i.chevronNext({class:a?.chevronNext})}),[i,_]),I=H.useCallback(A=>j.jsx(G5,{className:i.prev({class:a?.prev}),"data-slot":"prev",getAriaLabel:m,isDisabled:!l&&c===1,value:A,onPress:p,children:D(Gi.PREV)},Gi.PREV),[i,a,l,c,_,o,m,p]),R=H.useCallback(A=>j.jsx(G5,{className:i.next({class:ln(a?.next)}),"data-slot":"next",getAriaLabel:m,isDisabled:!l&&c===o,value:A,onPress:h,children:D(Gi.NEXT)},Gi.NEXT),[i,a,l,c,_,o,m,h]),M=H.useCallback((A,L)=>{const P=L<s.indexOf(c);if(d&&typeof d=="function"){let B=typeof A=="number"?A:L;A===Gi.NEXT&&(B=c+1),A===Gi.PREV&&(B=c-1),A===Gi.DOTS&&(B=P?c-r>=1?c-r:1:c+r<=o?c+r:o);const U={[Gi.PREV]:D(Gi.PREV),[Gi.NEXT]:D(Gi.NEXT),[Gi.DOTS]:j.jsxs(j.Fragment,{children:[j.jsx(PP,{className:i?.ellipsis({class:a?.ellipsis})}),j.jsx(NP,{className:i?.forwardIcon({class:a?.forwardIcon}),"data-before":Nt(P)})]})};return d({value:A,index:L,key:`${A}-${L}`,page:B,total:o,children:typeof A=="number"?A:U[A],activePage:c,dotsJump:r,isBefore:P,isActive:A===c,isPrevious:A===c-1,isNext:A===c+1,isFirst:A===1,isLast:A===o,onNext:h,onPrevious:p,setPage:g,onPress:()=>g(B),ref:typeof A=="number"?G=>y(G,A):void 0,className:i.item({class:a?.item}),getAriaLabel:m})}return A===Gi.PREV?I(A):A===Gi.NEXT?R(A):A===Gi.DOTS?j.jsxs(G5,{className:i.item({class:ln(a?.item,"group")}),"data-slot":"item",getAriaLabel:m,value:A,onPress:()=>g(P?c-r>=1?c-r:1:c+r<=o?c+r:o),children:[j.jsx(PP,{className:i?.ellipsis({class:a?.ellipsis})}),j.jsx(NP,{className:i?.forwardIcon({class:a?.forwardIcon}),"data-before":Nt(_?!P:P)})]},Gi.DOTS+P):H.createElement(G5,{...w({value:A}),key:A,getAriaLabel:m},A)},[_,c,r,w,l,s,d,i,a,o,m,h,p,g,I,R]);return j.jsx(n,{...v(),children:j.jsxs("ul",{...x(),children:[!f&&!u&&j.jsx(vge,{...S()}),s.map(M)]})})});Nz.displayName="HeroUI.Pagination";var Nw=Nz;function Lz(t){let[e,n]=$2(t.isOpen,t.defaultOpen||!1,t.onOpenChange);const r=H.useCallback(()=>{n(!0)},[n]),i=H.useCallback(()=>{n(!1)},[n]),a=H.useCallback(()=>{n(!e)},[n,e]);return{isOpen:e,setOpen:n,open:r,close:i,toggle:a}}var $c=[];function Tge(t,e){const{disableOutsideEvents:n=!0,isDismissable:r=!1,isKeyboardDismissDisabled:i=!1,isOpen:a,onClose:o,shouldCloseOnBlur:s,shouldCloseOnInteractOutside:l}=t;H.useEffect(()=>{if(a&&!$c.includes(e))return $c.push(e),()=>{let g=$c.indexOf(e);g>=0&&$c.splice(g,1)}},[a,e]);const c=()=>{$c[$c.length-1]===e&&o&&o()},f=g=>{(!l||l(g.target))&&($c[$c.length-1]===e&&n&&(g.stopPropagation(),g.preventDefault()),c())},u=g=>{(!l||l(g.target))&&($c[$c.length-1]===e&&n&&(g.stopPropagation(),g.preventDefault()),c())},d=g=>{g.key==="Escape"&&!i&&!g.nativeEvent.isComposing&&(g.stopPropagation(),g.preventDefault(),c())};hfe({isDisabled:!(r&&a),onInteractOutside:r&&a?u:void 0,onInteractOutsideStart:f,ref:e});const{focusWithinProps:h}=sp({isDisabled:!s,onBlurWithin:g=>{!g.relatedTarget||xfe(g.relatedTarget)||(!l||l(g.relatedTarget))&&c()}}),p=g=>{g.target===g.currentTarget&&g.preventDefault()};return{overlayProps:{onKeyDown:d,...h},underlayProps:{onPointerDown:p}}}function Ege(t={}){const{rerender:e=!1,delay:n=0}=t,r=H.useRef(!1),[i,a]=H.useState(!1);return H.useEffect(()=>{r.current=!0;let o=null;return e&&(n>0?o=setTimeout(()=>{a(!0)},n):a(!0)),()=>{r.current=!1,e&&a(!1),o&&clearTimeout(o)}},[e]),[H.useCallback(()=>r.current,[]),i]}function _ge(t,e){let{inputElementType:n="input",isDisabled:r=!1,isRequired:i=!1,isReadOnly:a=!1,type:o="text",validationBehavior:s="aria"}=t,[l,c]=$2(t.value,t.defaultValue||"",t.onChange),{focusableProps:f}=_w(t,e),u=Dz({...t,value:l}),{isInvalid:d,validationErrors:h,validationDetails:p}=u.displayValidation,{labelProps:g,fieldProps:m,descriptionProps:y,errorMessageProps:v}=Iz({...t,isInvalid:d,errorMessage:t.errorMessage||h}),x=T0(t,{labelable:!0});const w={type:o,pattern:t.pattern};let[S]=H.useState(l);var T;return jae(e,(T=t.defaultValue)!==null&&T!==void 0?T:S,c),Oz(t,u,e),H.useEffect(()=>{if(e.current instanceof Ml(e.current).HTMLTextAreaElement){let _=e.current;Object.defineProperty(_,"defaultValue",{get:()=>_.value,set:()=>{},configurable:!0})}},[e]),{labelProps:g,inputProps:Oi(x,n==="input"?w:void 0,{disabled:r,readOnly:a,required:i&&s==="native","aria-required":i&&s==="aria"||void 0,"aria-invalid":d||void 0,"aria-errormessage":t["aria-errormessage"],"aria-activedescendant":t["aria-activedescendant"],"aria-autocomplete":t["aria-autocomplete"],"aria-haspopup":t["aria-haspopup"],"aria-controls":t["aria-controls"],value:l,onChange:_=>c(_.target.value),autoComplete:t.autoComplete,autoCapitalize:t.autoCapitalize,maxLength:t.maxLength,minLength:t.minLength,name:t.name,form:t.form,placeholder:t.placeholder,inputMode:t.inputMode,autoCorrect:t.autoCorrect,spellCheck:t.spellCheck,[parseInt(Tn.version,10)>=17?"enterKeyHint":"enterkeyhint"]:t.enterKeyHint,onCopy:t.onCopy,onCut:t.onCut,onPaste:t.onPaste,onCompositionEnd:t.onCompositionEnd,onCompositionStart:t.onCompositionStart,onCompositionUpdate:t.onCompositionUpdate,onSelect:t.onSelect,onBeforeInput:t.onBeforeInput,onInput:t.onInput,...f,...m}),descriptionProps:y,errorMessageProps:v,isInvalid:d,validationErrors:h,validationDetails:p}}function Dge(t){var e,n,r,i,a,o,s;const l=es(),{validationBehavior:c}=p9(Xb)||{},[f,u]=Vl(t,_P.variantKeys),{ref:d,as:h,type:p,label:g,baseRef:m,wrapperRef:y,description:v,className:x,classNames:w,autoFocus:S,startContent:T,endContent:_,onClear:D,onChange:I,validationState:R,validationBehavior:M=(e=c??l?.validationBehavior)!=null?e:"native",innerWrapperRef:A,onValueChange:L=()=>{},...P}=f,B=H.useCallback(rn=>{L(rn??"")},[L]),[U,G]=H.useState(!1),F=h||"div",$=(r=(n=t.disableAnimation)!=null?n:l?.disableAnimation)!=null?r:!1,V=Di(d),X=Di(m),Q=Di(y),re=Di(A),[ye,me]=$2(f.value,(i=f.defaultValue)!=null?i:"",B),Ce=p==="file",we=((s=(o=(a=V?.current)==null?void 0:a.files)==null?void 0:o.length)!=null?s:0)>0,Ae=["date","time","month","week","range"].includes(p),De=!Lb(ye)||Ae||we,q=De||U,k=p==="hidden",J=t.isMultiline,Y=ln(w?.base,x,De?"is-filled":""),ie=H.useCallback(()=>{var rn;Ce?V.current.value="":me(""),D?.(),(rn=V.current)==null||rn.focus()},[me,D,Ce]);d9(()=>{V.current&&me(V.current.value)},[V.current]);const{labelProps:ue,inputProps:fe,isInvalid:Se,validationErrors:Fe,validationDetails:Ke,descriptionProps:He,errorMessageProps:pe}=_ge({...t,validationBehavior:M,autoCapitalize:t.autoCapitalize,value:ye,"aria-label":t.label?t["aria-label"]:Fie(t["aria-label"],t.placeholder),inputElementType:J?"textarea":"input",onChange:me},V);Ce&&(delete fe.value,delete fe.onChange);const{isFocusVisible:ge,isFocused:Ie,focusProps:ve}=Pl({autoFocus:S,isTextInput:!0}),{isHovered:_e,hoverProps:Pe}=Zs({isDisabled:!!t?.isDisabled}),{isHovered:ne,hoverProps:Je}=Zs({isDisabled:!!t?.isDisabled}),{focusProps:$e,isFocusVisible:ke}=Pl(),{focusWithinProps:Re}=sp({onFocusWithinChange:G}),{pressProps:ze}=Uf({isDisabled:!!t?.isDisabled||!!t?.isReadOnly,onPress:ie}),st=R==="invalid"||Se,Qe=$fe({labelPlacement:t.labelPlacement,label:g}),_t=typeof f.errorMessage=="function"?f.errorMessage({isInvalid:st,validationErrors:Fe,validationDetails:Ke}):f.errorMessage||Fe?.join(" "),Le=!!D||t.isClearable,We=!!g||!!v||!!_t,xt=!!f.placeholder,Ut=!!g,gn=!!v||!!_t,tn=Qe==="outside-left",Ht=Qe==="outside-top",dn=Qe==="outside"||tn||Ht,sr=Qe==="inside",Qn=V.current?(!V.current.value||V.current.value===""||!ye||ye==="")&&xt:!1,qe=!!T,Dt=dn?tn||Ht||xt||Qe==="outside"&&qe:!1,Rt=Qe==="outside"&&!xt&&!qe,Bt=H.useMemo(()=>_P({...u,isInvalid:st,labelPlacement:Qe,isClearable:Le,disableAnimation:$}),[kl(u),st,Qe,Le,qe,$]),On=H.useCallback((rn={})=>({ref:X,className:Bt.base({class:Y}),"data-slot":"base","data-filled":Nt(De||xt||qe||Qn||Ce),"data-filled-within":Nt(q||xt||qe||Qn||Ce),"data-focus-within":Nt(U),"data-focus-visible":Nt(ge),"data-readonly":Nt(t.isReadOnly),"data-focus":Nt(Ie),"data-hover":Nt(_e||ne),"data-required":Nt(t.isRequired),"data-invalid":Nt(st),"data-disabled":Nt(t.isDisabled),"data-has-elements":Nt(We),"data-has-helper":Nt(gn),"data-has-label":Nt(Ut),"data-has-value":Nt(!Qn),"data-hidden":Nt(k),...Re,...rn}),[Bt,Y,De,Ie,_e,ne,st,gn,Ut,We,Qn,qe,U,ge,q,xt,Re,k,t.isReadOnly,t.isRequired,t.isDisabled]),$t=H.useCallback((rn={})=>({"data-slot":"label",className:Bt.label({class:w?.label}),...Pn(ue,Je,rn)}),[Bt,ne,ue,w?.label]),Xt=H.useCallback(rn=>{rn.key==="Escape"&&ye&&(Le||D)&&!t.isReadOnly&&(me(""),D?.())},[ye,me,D,Le,t.isReadOnly]),Lt=H.useCallback((rn={})=>({"data-slot":"input","data-filled":Nt(De),"data-filled-within":Nt(q),"data-has-start-content":Nt(qe),"data-has-end-content":Nt(!!_),"data-type":p,className:Bt.input({class:ln(w?.input,De?"is-filled":"",J?"pe-0":"",p==="password"?"[&::-ms-reveal]:hidden":"")}),...Pn(ve,fe,Io(P,{enabled:!0,labelable:!0,omitEventNames:new Set(Object.keys(fe))}),rn),"aria-readonly":Nt(t.isReadOnly),onChange:Rf(fe.onChange,I),onKeyDown:Rf(fe.onKeyDown,rn.onKeyDown,Xt),ref:V}),[Bt,ye,ve,fe,P,De,q,qe,_,w?.input,t.isReadOnly,t.isRequired,I,Xt]),Qt=H.useCallback((rn={})=>({ref:Q,"data-slot":"input-wrapper","data-hover":Nt(_e||ne),"data-focus-visible":Nt(ge),"data-focus":Nt(Ie),className:Bt.inputWrapper({class:ln(w?.inputWrapper,De?"is-filled":"")}),...Pn(rn,Pe),onClick:Xn=>{V.current&&Xn.currentTarget===Xn.target&&V.current.focus()},style:{cursor:"text",...rn.style}}),[Bt,_e,ne,ge,Ie,ye,w?.inputWrapper]),yr=H.useCallback((rn={})=>({...rn,ref:re,"data-slot":"inner-wrapper",onClick:Xn=>{V.current&&Xn.currentTarget===Xn.target&&V.current.focus()},className:Bt.innerWrapper({class:ln(w?.innerWrapper,rn?.className)})}),[Bt,w?.innerWrapper]),kr=H.useCallback((rn={})=>({...rn,"data-slot":"main-wrapper",className:Bt.mainWrapper({class:ln(w?.mainWrapper,rn?.className)})}),[Bt,w?.mainWrapper]),ni=H.useCallback((rn={})=>({...rn,"data-slot":"helper-wrapper",className:Bt.helperWrapper({class:ln(w?.helperWrapper,rn?.className)})}),[Bt,w?.helperWrapper]),Ii=H.useCallback((rn={})=>({...rn,...He,"data-slot":"description",className:Bt.description({class:ln(w?.description,rn?.className)})}),[Bt,w?.description]),fi=H.useCallback((rn={})=>({...rn,...pe,"data-slot":"error-message",className:Bt.errorMessage({class:ln(w?.errorMessage,rn?.className)})}),[Bt,pe,w?.errorMessage]),Ri=H.useCallback((rn={})=>({...rn,type:"button",tabIndex:-1,disabled:t.isDisabled,"aria-label":"clear input","data-slot":"clear-button","data-focus-visible":Nt(ke),className:Bt.clearButton({class:ln(w?.clearButton,rn?.className)}),...Pn(ze,$e)}),[Bt,ke,ze,$e,w?.clearButton]);return{Component:F,classNames:w,domRef:V,label:g,description:v,startContent:T,endContent:_,labelPlacement:Qe,isClearable:Le,hasHelper:gn,hasStartContent:qe,isLabelOutside:Dt,isOutsideLeft:tn,isOutsideTop:Ht,isLabelOutsideAsPlaceholder:Rt,shouldLabelBeOutside:dn,shouldLabelBeInside:sr,hasPlaceholder:xt,isInvalid:st,errorMessage:_t,getBaseProps:On,getLabelProps:$t,getInputProps:Lt,getMainWrapperProps:kr,getInputWrapperProps:Qt,getInnerWrapperProps:yr,getHelperWrapperProps:ni,getDescriptionProps:Ii,getErrorMessageProps:fi,getClearButtonProps:Ri}}var kz=Hi((t,e)=>{const{Component:n,label:r,description:i,isClearable:a,startContent:o,endContent:s,labelPlacement:l,hasHelper:c,isOutsideLeft:f,isOutsideTop:u,shouldLabelBeOutside:d,errorMessage:h,isInvalid:p,getBaseProps:g,getLabelProps:m,getInputProps:y,getInnerWrapperProps:v,getInputWrapperProps:x,getMainWrapperProps:w,getHelperWrapperProps:S,getDescriptionProps:T,getErrorMessageProps:_,getClearButtonProps:D}=Dge({...t,ref:e}),I=r?j.jsx("label",{...m(),children:r}):null,R=H.useMemo(()=>a?j.jsx("button",{...D(),children:s||j.jsx(s9,{})}):s,[a,D]),M=H.useMemo(()=>{const P=p&&h;return!c||!(P||i)?null:j.jsx("div",{...S(),children:P?j.jsx("div",{..._(),children:h}):j.jsx("div",{...T(),children:i})})},[c,p,h,i,S,_,T]),A=H.useMemo(()=>j.jsxs("div",{...v(),children:[o,j.jsx("input",{...y()}),R]}),[o,R,y,v]),L=H.useMemo(()=>d?j.jsxs("div",{...w(),children:[j.jsxs("div",{...x(),children:[!f&&!u?I:null,A]}),M]}):j.jsxs(j.Fragment,{children:[j.jsxs("div",{...x(),children:[I,A]}),M]}),[l,M,d,I,A,h,i,w,x,_,T]);return j.jsxs(n,{...g(),children:[f||u?I:null,L]})});kz.displayName="HeroUI.Input";var d2=kz;function Oge(t,e){const{groupRef:n,triggerRef:r,popoverRef:i,showArrow:a,offset:o=7,crossOffset:s=0,scrollRef:l,shouldFlip:c,boundaryElement:f,isDismissable:u=!0,shouldCloseOnBlur:d=!0,shouldCloseOnScroll:h=!0,placement:p="top",containerPadding:g,shouldCloseOnInteractOutside:m,isNonModal:y,isKeyboardDismissDisabled:v,updatePositionDeps:x=[],...w}=t,S=y??!0,T=w.trigger==="SubmenuTrigger",{overlayProps:_,underlayProps:D}=Tge({isOpen:e.isOpen,onClose:e.close,shouldCloseOnBlur:d,isDismissable:u||T,isKeyboardDismissDisabled:v,shouldCloseOnInteractOutside:m||(L=>{var P;return!((P=r.current)!=null&&P.contains(L))}),disableOutsideEvents:!S},i),{overlayProps:I,arrowProps:R,placement:M,updatePosition:A}=Wue({...w,shouldFlip:c,crossOffset:s,targetRef:r,overlayRef:i,isOpen:e.isOpen,scrollRef:l,boundaryElement:f,containerPadding:g,placement:ege(p),offset:a?o+3:o,onClose:S&&!T&&h?e.close:()=>{}});return d9(()=>{x.length&&A()},x),H.useEffect(()=>{var L,P;if(e.isOpen&&i.current)return S?rge((L=n?.current)!=null?L:i.current):nge([(P=n?.current)!=null?P:i.current])},[S,e.isOpen,i,n]),{popoverProps:Pn(_,I),arrowProps:R,underlayProps:D,placement:M}}var Mge="top";function Ige(t){var e,n,r;const i=es(),[a,o]=Vl(t,TP.variantKeys),{as:s,ref:l,children:c,state:f,triggerRef:u,scrollRef:d,defaultOpen:h,onOpenChange:p,isOpen:g,isNonModal:m=!0,shouldFlip:y=!0,containerPadding:v=12,shouldBlockScroll:x=!1,isDismissable:w=!0,shouldCloseOnBlur:S,portalContainer:T,updatePositionDeps:_,dialogProps:D,placement:I=Mge,triggerType:R="dialog",showArrow:M=!1,offset:A=7,crossOffset:L=0,boundaryElement:P,isKeyboardDismissDisabled:B,shouldCloseOnInteractOutside:U,shouldCloseOnScroll:G,motionProps:F,className:$,classNames:V,onClose:X,...Q}=a,re=s||"div",ye=Di(l),me=H.useRef(null),Ce=H.useRef(!1),we=u||me,Ae=(n=(e=t.disableAnimation)!=null?e:i?.disableAnimation)!=null?n:!1,De=Lz({isOpen:g,defaultOpen:h,onOpenChange:ne=>{p?.(ne),ne||X?.()}}),q=f||De,{popoverProps:k,underlayProps:J,placement:Y}=Oge({triggerRef:we,isNonModal:m,popoverRef:ye,placement:I,offset:A,scrollRef:d,isDismissable:w,shouldCloseOnBlur:S,boundaryElement:P,crossOffset:L,shouldFlip:y,containerPadding:v,updatePositionDeps:_,isKeyboardDismissDisabled:B,shouldCloseOnScroll:G,shouldCloseOnInteractOutside:U},q),ie=H.useMemo(()=>Y?tge(Y,I)?Y:I:null,[Y,I]),{triggerProps:ue}=z$({type:R},q,we),{isFocusVisible:fe,isFocused:Se,focusProps:Fe}=Pl(),Ke=H.useMemo(()=>TP({...o}),[kl(o)]),He=ln(V?.base,$);W$({isDisabled:!(x&&q.isOpen)});const pe=(ne={})=>({ref:ye,...Pn(k,Q,ne),style:Pn(k.style,Q.style,ne.style)}),ge=(ne={})=>({"data-slot":"base","data-open":Nt(q.isOpen),"data-focus":Nt(Se),"data-arrow":Nt(M),"data-focus-visible":Nt(fe),"data-placement":Y?sN(Y,I):void 0,...Pn(Fe,D,ne),className:Ke.base({class:ln(He)}),style:{outline:"none"}}),Ie=H.useCallback((ne={})=>({"data-slot":"content","data-open":Nt(q.isOpen),"data-arrow":Nt(M),"data-placement":Y?sN(Y,I):void 0,className:Ke.content({class:ln(V?.content,ne.className)})}),[Ke,q.isOpen,M,ie,I,V,Y]),ve=H.useCallback(ne=>{var Je;let $e;return ne.pointerType==="touch"&&(t?.backdrop==="blur"||t?.backdrop==="opaque")?$e=setTimeout(()=>{Ce.current=!0},100):Ce.current=!0,(Je=ue.onPress)==null||Je.call(ue,ne),()=>{clearTimeout($e)}},[ue?.onPress]),_e=H.useCallback((ne={},Je=null)=>{const{isDisabled:$e,...ke}=ne;return{"data-slot":"trigger",...Pn({"aria-haspopup":"dialog"},ue,ke),onPress:ve,isDisabled:$e,className:Ke.trigger({class:ln(V?.trigger,ne.className),isTriggerDisabled:$e}),ref:DU(Je,we)}},[q,ue,ve,we]),Pe=H.useCallback((ne={})=>({"data-slot":"backdrop",className:Ke.backdrop({class:V?.backdrop}),onClick:Je=>{if(!Ce.current){Je.preventDefault();return}q.close(),Ce.current=!1},...J,...ne}),[Ke,q.isOpen,V,J]);return{state:q,Component:re,children:c,classNames:V,showArrow:M,triggerRef:we,placement:ie,isNonModal:m,popoverRef:ye,portalContainer:T,isOpen:q.isOpen,onClose:q.close,disableAnimation:Ae,shouldBlockScroll:x,backdrop:(r=t.backdrop)!=null?r:"transparent",motionProps:F,getBackdropProps:Pe,getPopoverProps:pe,getTriggerProps:_e,getDialogProps:ge,getContentProps:Ie}}function Rge(t,e){let{role:n="dialog"}=t,r=am();r=t["aria-label"]?void 0:r;let i=H.useRef(!1);return H.useEffect(()=>{if(e.current&&!e.current.contains(document.activeElement)){zh(e.current);let a=setTimeout(()=>{(document.activeElement===e.current||document.activeElement===document.body)&&(i.current=!0,e.current&&(e.current.blur(),zh(e.current)),i.current=!1)},500);return()=>{clearTimeout(a)}}},[e]),Ffe(),{dialogProps:{...T0(t,{labelable:!0}),role:n,tabIndex:-1,"aria-labelledby":t["aria-labelledby"]||r,onBlur:a=>{i.current&&a.stopPropagation()}},titleProps:{id:r}}}var Vz=()=>Cm(()=>import("./index-DOsZaCpu.js"),[]).then(t=>t.default),Fz=Hi(({children:t,motionProps:e,placement:n,disableAnimation:r,style:i={},transformOrigin:a={},...o},s)=>{let l=i;return a.originX!==void 0||a.originY!==void 0?l={...l,transformOrigin:a}:n&&(l={...l,...Qpe(n==="center"?"top":n)}),r?j.jsx("div",{...o,ref:s,children:t}):j.jsx(_m,{features:Vz,children:j.jsx(Gh.div,{ref:s,animate:"enter",exit:"exit",initial:"initial",style:l,variants:uz.scaleSpringOpacity,...Pn(o,e),children:t})})});Fz.displayName="HeroUI.FreeSoloPopoverWrapper";var Uz=Hi(({children:t,transformOrigin:e,disableDialogFocus:n=!1,...r},i)=>{const{Component:a,state:o,placement:s,backdrop:l,portalContainer:c,disableAnimation:f,motionProps:u,isNonModal:d,getPopoverProps:h,getBackdropProps:p,getDialogProps:g,getContentProps:m}=Ige({...r,ref:i}),y=H.useRef(null),{dialogProps:v,titleProps:x}=Rge({},y),w=g({...!n&&{ref:y},...v}),S=H.useMemo(()=>l==="transparent"?null:f?j.jsx("div",{...p()}):j.jsx(_m,{features:Vz,children:j.jsx(Gh.div,{animate:"enter",exit:"exit",initial:"exit",variants:uz.fade,...p()})}),[l,f,p]);return j.jsxs(Vfe,{portalContainer:c,children:[!d&&S,j.jsx(a,{...h(),children:j.jsxs(Fz,{disableAnimation:f,motionProps:u,placement:s,tabIndex:-1,transformOrigin:e,...w,children:[!d&&j.jsx(fP,{onDismiss:o.close}),j.jsx("div",{...m(),children:typeof t=="function"?t(x):t}),j.jsx(fP,{onDismiss:o.close})]})})]})});Uz.displayName="HeroUI.FreeSoloPopover";var Age=Uz,Bz={};Bz={longPressMessage:"اضغط مطولاً أو اضغط على Alt + السهم لأسفل لفتح القائمة"};var $z={};$z={longPressMessage:"Натиснете продължително или натиснете Alt+ стрелка надолу, за да отворите менюто"};var Gz={};Gz={longPressMessage:"Dlouhým stiskem nebo stisknutím kláves Alt + šipka dolů otevřete nabídku"};var jz={};jz={longPressMessage:"Langt tryk eller tryk på Alt + pil ned for at åbne menuen"};var zz={};zz={longPressMessage:"Drücken Sie lange oder drücken Sie Alt + Nach-unten, um das Menü zu öffnen"};var Wz={};Wz={longPressMessage:"Πιέστε παρατεταμένα ή πατήστε Alt + κάτω βέλος για να ανοίξετε το μενού"};var Hz={};Hz={longPressMessage:"Long press or press Alt + ArrowDown to open menu"};var Kz={};Kz={longPressMessage:"Mantenga pulsado o pulse Alt + flecha abajo para abrir el menú"};var qz={};qz={longPressMessage:"Menüü avamiseks vajutage pikalt või vajutage klahve Alt + allanool"};var Xz={};Xz={longPressMessage:"Avaa valikko painamalla pohjassa tai näppäinyhdistelmällä Alt + Alanuoli"};var Yz={};Yz={longPressMessage:"Appuyez de manière prolongée ou appuyez sur Alt + Flèche vers le bas pour ouvrir le menu."};var Jz={};Jz={longPressMessage:"לחץ לחיצה ארוכה או הקש Alt + ArrowDown כדי לפתוח את התפריט"};var Zz={};Zz={longPressMessage:"Dugo pritisnite ili pritisnite Alt + strelicu prema dolje za otvaranje izbornika"};var Qz={};Qz={longPressMessage:"Nyomja meg hosszan, vagy nyomja meg az Alt + lefele nyíl gombot a menü megnyitásához"};var eW={};eW={longPressMessage:"Premere a lungo o premere Alt + Freccia giù per aprire il menu"};var tW={};tW={longPressMessage:"長押しまたは Alt+下矢印キーでメニューを開く"};var nW={};nW={longPressMessage:"길게 누르거나 Alt + 아래쪽 화살표를 눌러 메뉴 열기"};var rW={};rW={longPressMessage:"Norėdami atidaryti meniu, nuspaudę palaikykite arba paspauskite „Alt + ArrowDown“."};var iW={};iW={longPressMessage:"Lai atvērtu izvēlni, turiet nospiestu vai nospiediet taustiņu kombināciju Alt + lejupvērstā bultiņa"};var aW={};aW={longPressMessage:"Langt trykk eller trykk Alt + PilNed for å åpne menyen"};var oW={};oW={longPressMessage:"Druk lang op Alt + pijl-omlaag of druk op Alt om het menu te openen"};var sW={};sW={longPressMessage:"Naciśnij i przytrzymaj lub naciśnij klawisze Alt + Strzałka w dół, aby otworzyć menu"};var lW={};lW={longPressMessage:"Pressione e segure ou pressione Alt + Seta para baixo para abrir o menu"};var cW={};cW={longPressMessage:"Prima continuamente ou prima Alt + Seta Para Baixo para abrir o menu"};var uW={};uW={longPressMessage:"Apăsați lung sau apăsați pe Alt + săgeată în jos pentru a deschide meniul"};var fW={};fW={longPressMessage:"Нажмите и удерживайте или нажмите Alt + Стрелка вниз, чтобы открыть меню"};var dW={};dW={longPressMessage:"Ponuku otvoríte dlhým stlačením alebo stlačením klávesu Alt + klávesu so šípkou nadol"};var hW={};hW={longPressMessage:"Za odprtje menija pritisnite in držite gumb ali pritisnite Alt+puščica navzdol"};var pW={};pW={longPressMessage:"Dugo pritisnite ili pritisnite Alt + strelicu prema dole da otvorite meni"};var gW={};gW={longPressMessage:"Håll nedtryckt eller tryck på Alt + pil nedåt för att öppna menyn"};var mW={};mW={longPressMessage:"Menüyü açmak için uzun basın veya Alt + Aşağı Ok tuşuna basın"};var vW={};vW={longPressMessage:"Довго або звичайно натисніть комбінацію клавіш Alt і стрілка вниз, щоб відкрити меню"};var yW={};yW={longPressMessage:"长按或按 Alt + 向下方向键以打开菜单"};var xW={};xW={longPressMessage:"長按或按 Alt+向下鍵以開啟功能表"};var bW={};bW={"ar-AE":Bz,"bg-BG":$z,"cs-CZ":Gz,"da-DK":jz,"de-DE":zz,"el-GR":Wz,"en-US":Hz,"es-ES":Kz,"et-EE":qz,"fi-FI":Xz,"fr-FR":Yz,"he-IL":Jz,"hr-HR":Zz,"hu-HU":Qz,"it-IT":eW,"ja-JP":tW,"ko-KR":nW,"lt-LT":rW,"lv-LV":iW,"nb-NO":aW,"nl-NL":oW,"pl-PL":sW,"pt-BR":lW,"pt-PT":cW,"ro-RO":uW,"ru-RU":fW,"sk-SK":dW,"sl-SI":hW,"sr-SP":pW,"sv-SE":gW,"tr-TR":mW,"uk-UA":vW,"zh-CN":yW,"zh-TW":xW};function Pge(t){return t&&t.__esModule?t.default:t}function Nge(t,e,n){let{type:r="menu",isDisabled:i,trigger:a="press"}=t,o=Js(),{triggerProps:s,overlayProps:l}=z$({type:r},e,n),c=h=>{if(!i&&!(a==="longPress"&&!h.altKey)&&n&&n.current)switch(h.key){case"Enter":case" ":if(a==="longPress"||h.isDefaultPrevented())return;case"ArrowDown":"continuePropagation"in h||h.stopPropagation(),h.preventDefault(),e.toggle("first");break;case"ArrowUp":"continuePropagation"in h||h.stopPropagation(),h.preventDefault(),e.toggle("last");break;default:"continuePropagation"in h&&h.continuePropagation()}},f=dw(Pge(bW),"@react-aria/menu"),{longPressProps:u}=U$({isDisabled:i||a!=="longPress",accessibilityDescription:f.format("longPressMessage"),onLongPressStart(){e.close()},onLongPress(){e.open("first")}}),d={preventFocusOnPress:!0,onPressStart(h){h.pointerType!=="touch"&&h.pointerType!=="keyboard"&&!i&&(To(h.target),e.open(h.pointerType==="virtual"?"first":null))},onPress(h){h.pointerType==="touch"&&!i&&(To(h.target),e.toggle())}};return delete s.onPress,{menuTriggerProps:{...s,...a==="press"?d:u,id:o,onKeyDown:c},menuProps:{...l,"aria-labelledby":o,autoFocus:e.focusStrategy||!0,onClose:e.close}}}function Lge(t){let e=Lz(t),[n,r]=H.useState(null),[i,a]=H.useState([]),o=()=>{a([]),e.close()};return{focusStrategy:n,...e,open(c=null){r(c),e.open()},toggle(c=null){r(c),e.toggle()},close(){o()},expandedKeysStack:i,openSubmenu:(c,f)=>{a(u=>f>u.length?u:[...u.slice(0,f),c])},closeSubmenu:(c,f)=>{a(u=>u[f]===c?u.slice(0,f):u)}}}function Kp(t,e,n){let r=n.initialDeps??[],i;return()=>{var a,o,s,l;let c;n.key&&((a=n.debug)!=null&&a.call(n))&&(c=Date.now());const f=t();if(!(f.length!==r.length||f.some((h,p)=>r[p]!==h)))return i;r=f;let d;if(n.key&&((o=n.debug)!=null&&o.call(n))&&(d=Date.now()),i=e(...f),n.key&&((s=n.debug)!=null&&s.call(n))){const h=Math.round((Date.now()-c)*100)/100,p=Math.round((Date.now()-d)*100)/100,g=p/16,m=(y,v)=>{for(y=String(y);y.length<v;)y=" "+y;return y};console.info(`%c⏱ ${m(p,5)} /${m(h,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*g,120))}deg 100% 31%);`,n?.key)}return(l=n?.onChange)==null||l.call(n,i),i}}function mT(t,e){if(t===void 0)throw new Error("Unexpected undefined");return t}const kge=(t,e)=>Math.abs(t-e)<1,Vge=(t,e,n)=>{let r;return function(...i){t.clearTimeout(r),r=t.setTimeout(()=>e.apply(this,i),n)}},Fge=t=>t,Uge=t=>{const e=Math.max(t.startIndex-t.overscan,0),n=Math.min(t.endIndex+t.overscan,t.count-1),r=[];for(let i=e;i<=n;i++)r.push(i);return r},Bge=(t,e)=>{const n=t.scrollElement;if(!n)return;const r=t.targetWindow;if(!r)return;const i=o=>{const{width:s,height:l}=o;e({width:Math.round(s),height:Math.round(l)})};if(i(n.getBoundingClientRect()),!r.ResizeObserver)return()=>{};const a=new r.ResizeObserver(o=>{const s=o[0];if(s?.borderBoxSize){const l=s.borderBoxSize[0];if(l){i({width:l.inlineSize,height:l.blockSize});return}}i(n.getBoundingClientRect())});return a.observe(n,{box:"border-box"}),()=>{a.unobserve(n)}},gN={passive:!0},$ge=typeof window>"u"?!0:"onscrollend"in window,Gge=(t,e)=>{const n=t.scrollElement;if(!n)return;const r=t.targetWindow;if(!r)return;let i=0;const a=t.options.useScrollendEvent&&$ge?()=>{}:Vge(r,()=>{e(i,!1)},t.options.isScrollingResetDelay),o=c=>()=>{const{horizontal:f,isRtl:u}=t.options;i=f?n.scrollLeft*(u&&-1||1):n.scrollTop,a(),e(i,c)},s=o(!0),l=o(!1);return l(),n.addEventListener("scroll",s,gN),n.addEventListener("scrollend",l,gN),()=>{n.removeEventListener("scroll",s),n.removeEventListener("scrollend",l)}},jge=(t,e,n)=>{if(e?.borderBoxSize){const r=e.borderBoxSize[0];if(r)return Math.round(r[n.options.horizontal?"inlineSize":"blockSize"])}return Math.round(t.getBoundingClientRect()[n.options.horizontal?"width":"height"])},zge=(t,{adjustments:e=0,behavior:n},r)=>{var i,a;const o=t+e;(a=(i=r.scrollElement)==null?void 0:i.scrollTo)==null||a.call(i,{[r.options.horizontal?"left":"top"]:o,behavior:n})};class Wge{constructor(e){this.unsubs=[],this.scrollElement=null,this.targetWindow=null,this.isScrolling=!1,this.scrollToIndexTimeoutId=null,this.measurementsCache=[],this.itemSizeCache=new Map,this.pendingMeasuredCacheIndexes=[],this.scrollRect=null,this.scrollOffset=null,this.scrollDirection=null,this.scrollAdjustments=0,this.elementsCache=new Map,this.observer=(()=>{let n=null;const r=()=>n||(!this.targetWindow||!this.targetWindow.ResizeObserver?null:n=new this.targetWindow.ResizeObserver(i=>{i.forEach(a=>{this._measureElement(a.target,a)})}));return{disconnect:()=>{var i;(i=r())==null||i.disconnect(),n=null},observe:i=>{var a;return(a=r())==null?void 0:a.observe(i,{box:"border-box"})},unobserve:i=>{var a;return(a=r())==null?void 0:a.unobserve(i)}}})(),this.range=null,this.setOptions=n=>{Object.entries(n).forEach(([r,i])=>{typeof i>"u"&&delete n[r]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:Fge,rangeExtractor:Uge,onChange:()=>{},measureElement:jge,initialRect:{width:0,height:0},scrollMargin:0,gap:0,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,isScrollingResetDelay:150,enabled:!0,isRtl:!1,useScrollendEvent:!0,...n}},this.notify=n=>{var r,i;(i=(r=this.options).onChange)==null||i.call(r,this,n)},this.maybeNotify=Kp(()=>(this.calculateRange(),[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]),n=>{this.notify(n)},{key:!1,debug:()=>this.options.debug,initialDeps:[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]}),this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(n=>n()),this.unsubs=[],this.observer.disconnect(),this.scrollElement=null,this.targetWindow=null},this._didMount=()=>()=>{this.cleanup()},this._willUpdate=()=>{var n;const r=this.options.enabled?this.options.getScrollElement():null;if(this.scrollElement!==r){if(this.cleanup(),!r){this.maybeNotify();return}this.scrollElement=r,this.scrollElement&&"ownerDocument"in this.scrollElement?this.targetWindow=this.scrollElement.ownerDocument.defaultView:this.targetWindow=((n=this.scrollElement)==null?void 0:n.window)??null,this.elementsCache.forEach(i=>{this.observer.observe(i)}),this._scrollToOffset(this.getScrollOffset(),{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,i=>{this.scrollRect=i,this.maybeNotify()})),this.unsubs.push(this.options.observeElementOffset(this,(i,a)=>{this.scrollAdjustments=0,this.scrollDirection=a?this.getScrollOffset()<i?"forward":"backward":null,this.scrollOffset=i,this.isScrolling=a,this.maybeNotify()}))}},this.getSize=()=>this.options.enabled?(this.scrollRect=this.scrollRect??this.options.initialRect,this.scrollRect[this.options.horizontal?"width":"height"]):(this.scrollRect=null,0),this.getScrollOffset=()=>this.options.enabled?(this.scrollOffset=this.scrollOffset??(typeof this.options.initialOffset=="function"?this.options.initialOffset():this.options.initialOffset),this.scrollOffset):(this.scrollOffset=null,0),this.getFurthestMeasurement=(n,r)=>{const i=new Map,a=new Map;for(let o=r-1;o>=0;o--){const s=n[o];if(i.has(s.lane))continue;const l=a.get(s.lane);if(l==null||s.end>l.end?a.set(s.lane,s):s.end<l.end&&i.set(s.lane,!0),i.size===this.options.lanes)break}return a.size===this.options.lanes?Array.from(a.values()).sort((o,s)=>o.end===s.end?o.index-s.index:o.end-s.end)[0]:void 0},this.getMeasurementOptions=Kp(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey,this.options.enabled],(n,r,i,a,o)=>(this.pendingMeasuredCacheIndexes=[],{count:n,paddingStart:r,scrollMargin:i,getItemKey:a,enabled:o}),{key:!1}),this.getMeasurements=Kp(()=>[this.getMeasurementOptions(),this.itemSizeCache],({count:n,paddingStart:r,scrollMargin:i,getItemKey:a,enabled:o},s)=>{if(!o)return this.measurementsCache=[],this.itemSizeCache.clear(),[];this.measurementsCache.length===0&&(this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(f=>{this.itemSizeCache.set(f.key,f.size)}));const l=this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[];const c=this.measurementsCache.slice(0,l);for(let f=l;f<n;f++){const u=a(f),d=this.options.lanes===1?c[f-1]:this.getFurthestMeasurement(c,f),h=d?d.end+this.options.gap:r+i,p=s.get(u),g=typeof p=="number"?p:this.options.estimateSize(f),m=h+g,y=d?d.lane:f%this.options.lanes;c[f]={index:f,start:h,size:g,end:m,key:u,lane:y}}return this.measurementsCache=c,c},{key:!1,debug:()=>this.options.debug}),this.calculateRange=Kp(()=>[this.getMeasurements(),this.getSize(),this.getScrollOffset()],(n,r,i)=>this.range=n.length>0&&r>0?Hge({measurements:n,outerSize:r,scrollOffset:i}):null,{key:!1,debug:()=>this.options.debug}),this.getIndexes=Kp(()=>{let n=null,r=null;const i=this.calculateRange();return i&&(n=i.startIndex,r=i.endIndex),[this.options.rangeExtractor,this.options.overscan,this.options.count,n,r]},(n,r,i,a,o)=>a===null||o===null?[]:n({startIndex:a,endIndex:o,overscan:r,count:i}),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=n=>{const r=this.options.indexAttribute,i=n.getAttribute(r);return i?parseInt(i,10):(console.warn(`Missing attribute name '${r}={index}' on measured element.`),-1)},this._measureElement=(n,r)=>{const i=this.indexFromElement(n),a=this.measurementsCache[i];if(!a)return;const o=a.key,s=this.elementsCache.get(o);s!==n&&(s&&this.observer.unobserve(s),this.observer.observe(n),this.elementsCache.set(o,n)),n.isConnected&&this.resizeItem(i,this.options.measureElement(n,r,this))},this.resizeItem=(n,r)=>{const i=this.measurementsCache[n];if(!i)return;const a=this.itemSizeCache.get(i.key)??i.size,o=r-a;o!==0&&((this.shouldAdjustScrollPositionOnItemSizeChange!==void 0?this.shouldAdjustScrollPositionOnItemSizeChange(i,o,this):i.start<this.getScrollOffset()+this.scrollAdjustments)&&this._scrollToOffset(this.getScrollOffset(),{adjustments:this.scrollAdjustments+=o,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(i.index),this.itemSizeCache=new Map(this.itemSizeCache.set(i.key,r)),this.notify(!1))},this.measureElement=n=>{if(!n){this.elementsCache.forEach((r,i)=>{r.isConnected||(this.observer.unobserve(r),this.elementsCache.delete(i))});return}this._measureElement(n,void 0)},this.getVirtualItems=Kp(()=>[this.getIndexes(),this.getMeasurements()],(n,r)=>{const i=[];for(let a=0,o=n.length;a<o;a++){const s=n[a],l=r[s];i.push(l)}return i},{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=n=>{const r=this.getMeasurements();if(r.length!==0)return mT(r[wW(0,r.length-1,i=>mT(r[i]).start,n)])},this.getOffsetForAlignment=(n,r)=>{const i=this.getSize(),a=this.getScrollOffset();r==="auto"&&n>=a+i&&(r="end"),r==="end"&&(n-=i);const o=this.options.horizontal?"scrollWidth":"scrollHeight",l=(this.scrollElement?"document"in this.scrollElement?this.scrollElement.document.documentElement[o]:this.scrollElement[o]:0)-i;return Math.max(Math.min(l,n),0)},this.getOffsetForIndex=(n,r="auto")=>{n=Math.max(0,Math.min(n,this.options.count-1));const i=this.measurementsCache[n];if(!i)return;const a=this.getSize(),o=this.getScrollOffset();if(r==="auto")if(i.end>=o+a-this.options.scrollPaddingEnd)r="end";else if(i.start<=o+this.options.scrollPaddingStart)r="start";else return[o,r];const s=i.start-this.options.scrollPaddingStart+(i.size-a)/2;switch(r){case"center":return[this.getOffsetForAlignment(s,r),r];case"end":return[this.getOffsetForAlignment(i.end+this.options.scrollPaddingEnd,r),r];default:return[this.getOffsetForAlignment(i.start-this.options.scrollPaddingStart,r),r]}},this.isDynamicMode=()=>this.elementsCache.size>0,this.cancelScrollToIndex=()=>{this.scrollToIndexTimeoutId!==null&&this.targetWindow&&(this.targetWindow.clearTimeout(this.scrollToIndexTimeoutId),this.scrollToIndexTimeoutId=null)},this.scrollToOffset=(n,{align:r="start",behavior:i}={})=>{this.cancelScrollToIndex(),i==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(n,r),{adjustments:void 0,behavior:i})},this.scrollToIndex=(n,{align:r="auto",behavior:i}={})=>{n=Math.max(0,Math.min(n,this.options.count-1)),this.cancelScrollToIndex(),i==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size.");const a=this.getOffsetForIndex(n,r);if(!a)return;const[o,s]=a;this._scrollToOffset(o,{adjustments:void 0,behavior:i}),i!=="smooth"&&this.isDynamicMode()&&this.targetWindow&&(this.scrollToIndexTimeoutId=this.targetWindow.setTimeout(()=>{if(this.scrollToIndexTimeoutId=null,this.elementsCache.has(this.options.getItemKey(n))){const[c]=mT(this.getOffsetForIndex(n,s));kge(c,this.getScrollOffset())||this.scrollToIndex(n,{align:s,behavior:i})}else this.scrollToIndex(n,{align:s,behavior:i})}))},this.scrollBy=(n,{behavior:r}={})=>{this.cancelScrollToIndex(),r==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getScrollOffset()+n,{adjustments:void 0,behavior:r})},this.getTotalSize=()=>{var n;const r=this.getMeasurements();let i;return r.length===0?i=this.options.paddingStart:i=this.options.lanes===1?((n=r[r.length-1])==null?void 0:n.end)??0:Math.max(...r.slice(-this.options.lanes).map(a=>a.end)),Math.max(i-this.options.scrollMargin+this.options.paddingEnd,0)},this._scrollToOffset=(n,{adjustments:r,behavior:i})=>{this.options.scrollToFn(n,{behavior:i,adjustments:r},this)},this.measure=()=>{this.itemSizeCache=new Map,this.notify(!1)},this.setOptions(e)}}const wW=(t,e,n,r)=>{for(;t<=e;){const i=(t+e)/2|0,a=n(i);if(a<r)t=i+1;else if(a>r)e=i-1;else return i}return t>0?t-1:0};function Hge({measurements:t,outerSize:e,scrollOffset:n}){const r=t.length-1,a=wW(0,r,s=>t[s].start,n);let o=a;for(;o<r&&t[o].end<n+e;)o++;return{startIndex:a,endIndex:o}}const mN=typeof document<"u"?H.useLayoutEffect:H.useEffect;function Kge(t){const e=H.useReducer(()=>({}),{})[1],n={...t,onChange:(i,a)=>{var o;a?g_.flushSync(e):e(),(o=t.onChange)==null||o.call(t,i,a)}},[r]=H.useState(()=>new Wge(n));return r.setOptions(n),mN(()=>r._didMount(),[]),mN(()=>r._willUpdate()),r}function qge(t){return Kge({observeElementRect:Bge,observeElementOffset:Gge,scrollToFn:zge,...t})}const CW=new WeakMap;function Yb(t,e,n){return t?(typeof e=="string"&&(e=e.replace(/\s+/g,"")),`${CW.get(t)}-${n}-${e}`):""}function Xge(t,e,n){let{key:r,isDisabled:i,shouldSelectOnPressUp:a}=t,{selectionManager:o,selectedKey:s}=e,l=r===s,c=i||e.isDisabled||e.selectionManager.isDisabled(r),{itemProps:f,isPressed:u}=lz({selectionManager:o,key:r,ref:n,isDisabled:c,shouldSelectOnPressUp:a,linkBehavior:"selection"}),d=Yb(e,r,"tab"),h=Yb(e,r,"tabpanel"),{tabIndex:p}=f,g=e.collection.getItem(r),m=T0(g?.props,{labelable:!0});delete m.id;let y=BU(g?.props),{focusableProps:v}=_w({isDisabled:c},n);return{tabProps:Oi(m,v,y,f,{id:d,"aria-selected":l,"aria-disabled":c||void 0,"aria-controls":l?h:void 0,tabIndex:c?void 0:p,role:"tab"}),isSelected:l,isDisabled:c,isPressed:u}}function Yge(t,e,n){let r=Sfe(n)?void 0:0;var i;const a=Yb(e,(i=t.id)!==null&&i!==void 0?i:e?.selectedKey,"tabpanel"),o=yw({...t,id:a,"aria-labelledby":Yb(e,e?.selectedKey,"tab")});return{tabPanelProps:Oi(o,{tabIndex:r,role:"tabpanel","aria-describedby":t["aria-describedby"],"aria-details":t["aria-details"]})}}class Jge{getKeyLeftOf(e){return this.flipDirection?this.getNextKey(e):this.getPreviousKey(e)}getKeyRightOf(e){return this.flipDirection?this.getPreviousKey(e):this.getNextKey(e)}isDisabled(e){var n,r;return this.disabledKeys.has(e)||!!(!((r=this.collection.getItem(e))===null||r===void 0||(n=r.props)===null||n===void 0)&&n.isDisabled)}getFirstKey(){let e=this.collection.getFirstKey();return e!=null&&this.isDisabled(e)&&(e=this.getNextKey(e)),e}getLastKey(){let e=this.collection.getLastKey();return e!=null&&this.isDisabled(e)&&(e=this.getPreviousKey(e)),e}getKeyAbove(e){return this.tabDirection?null:this.getPreviousKey(e)}getKeyBelow(e){return this.tabDirection?null:this.getNextKey(e)}getNextKey(e){let n=e;do n=this.collection.getKeyAfter(n),n==null&&(n=this.collection.getFirstKey());while(n!=null&&this.isDisabled(n));return n}getPreviousKey(e){let n=e;do n=this.collection.getKeyBefore(n),n==null&&(n=this.collection.getLastKey());while(n!=null&&this.isDisabled(n));return n}constructor(e,n,r,i=new Set){this.collection=e,this.flipDirection=n==="rtl"&&r==="horizontal",this.disabledKeys=i,this.tabDirection=r==="horizontal"}}function Zge(t,e,n){let{orientation:r="horizontal",keyboardActivation:i="automatic"}=t,{collection:a,selectionManager:o,disabledKeys:s}=e,{direction:l}=ap(),c=H.useMemo(()=>new Jge(a,l,r,s),[a,s,r,l]),{collectionProps:f}=sz({ref:n,selectionManager:o,keyboardDelegate:c,selectOnFocus:i==="automatic",disallowEmptySelection:!0,scrollRef:n,linkBehavior:"selection"}),u=Js();CW.set(e,u);let d=yw({...t,id:u});return{tabListProps:{...Oi(f,d),role:"tablist","aria-orientation":r,tabIndex:void 0}}}var SW=Hi((t,e)=>{var n,r;const{as:i,tabKey:a,destroyInactiveTabPanel:o,state:s,className:l,slots:c,classNames:f,...u}=t,d=i||"div",h=Di(e),{tabPanelProps:p}=Yge({...t,id:String(a)},s,h),{focusProps:g,isFocused:m,isFocusVisible:y}=Pl(),v=s.selectedItem,x=s.collection.getItem(a).props.children,w=ln(f?.panel,l,(n=v?.props)==null?void 0:n.className),S=a===v?.key;return!x||!S&&o?null:j.jsx(d,{ref:h,"data-focus":m,"data-focus-visible":y,"data-inert":S?void 0:"true",inert:Nie(!S),...S&&Pn(p,g,u),className:(r=c.panel)==null?void 0:r.call(c,{class:w}),"data-slot":"panel",children:x})});SW.displayName="HeroUI.TabPanel";var Qge=SW,TW=Hi((t,e)=>{var n;const{className:r,as:i,item:a,state:o,classNames:s,isDisabled:l,listRef:c,slots:f,motionProps:u,disableAnimation:d,disableCursorAnimation:h,shouldSelectOnPressUp:p,tabRef:g,...m}=t,{key:y}=a,v=Di(e),x=i||(t.href?"a":"button"),w=typeof x=="string",{tabProps:S,isSelected:T,isDisabled:_,isPressed:D}=Xge({key:y,isDisabled:l,shouldSelectOnPressUp:p},o,v);t.children==null&&delete S["aria-controls"];const I=l||_,{focusProps:R,isFocused:M,isFocusVisible:A}=Pl(),{hoverProps:L,isHovered:P}=Zs({isDisabled:I}),B=ln(s?.tab,r),[,U]=Ege({rerender:!0}),G=()=>{!v?.current||!c?.current||Pz(v.current,{scrollMode:"if-needed",behavior:"smooth",block:"end",inline:"end",boundary:c?.current})};return j.jsxs(x,{ref:Gie(v,g),"data-disabled":Nt(_),"data-focus":Nt(M),"data-focus-visible":Nt(A),"data-hover":Nt(P),"data-hover-unselected":Nt((P||D)&&!T),"data-pressed":Nt(D),"data-selected":Nt(T),"data-slot":"tab",...Pn(S,I?{}:{...R,...L},Io(m,{enabled:w,omitPropNames:new Set(["title"]),omitEventNames:new Set(["onClick"])}),{onClick:Rf(G,S.onClick)}),className:(n=f.tab)==null?void 0:n.call(f,{class:B}),title:m?.titleValue,type:x==="button"?"button":void 0,children:[T&&!d&&!h&&U?j.jsx(_m,{features:kue,children:j.jsx(Gh.span,{className:f.cursor({class:s?.cursor}),"data-slot":"cursor",layoutDependency:!1,layoutId:"cursor",transition:{type:"spring",bounce:.15,duration:.5},...u})}):null,j.jsx("div",{className:f.tabContent({class:s?.tabContent}),"data-slot":"tabContent",children:a.rendered})]})});TW.displayName="HeroUI.Tab";var eme=TW;class vN{*[Symbol.iterator](){yield*this.iterable}get size(){return this.keyMap.size}getKeys(){return this.keyMap.keys()}getKeyBefore(e){let n=this.keyMap.get(e);var r;return n&&(r=n.prevKey)!==null&&r!==void 0?r:null}getKeyAfter(e){let n=this.keyMap.get(e);var r;return n&&(r=n.nextKey)!==null&&r!==void 0?r:null}getFirstKey(){return this.firstKey}getLastKey(){return this.lastKey}getItem(e){var n;return(n=this.keyMap.get(e))!==null&&n!==void 0?n:null}at(e){const n=[...this.getKeys()];return this.getItem(n[e])}getChildren(e){let n=this.keyMap.get(e);return n?.childNodes||[]}constructor(e){this.keyMap=new Map,this.firstKey=null,this.lastKey=null,this.iterable=e;let n=o=>{if(this.keyMap.set(o.key,o),o.childNodes&&o.type==="section")for(let s of o.childNodes)n(s)};for(let o of e)n(o);let r=null,i=0;for(let[o,s]of this.keyMap)r?(r.nextKey=o,s.prevKey=r.key):(this.firstKey=o,s.prevKey=void 0),s.type==="item"&&(s.index=i++),r=s,r.nextKey=void 0;var a;this.lastKey=(a=r?.key)!==null&&a!==void 0?a:null}}function g9(t){let{filter:e,layoutDelegate:n}=t,r=Gpe(t),i=H.useMemo(()=>t.disabledKeys?new Set(t.disabledKeys):new Set,[t.disabledKeys]),a=H.useCallback(c=>e?new vN(e(c)):new vN(c),[e]),o=H.useMemo(()=>({suppressTextValueWarning:t.suppressTextValueWarning}),[t.suppressTextValueWarning]),s=Hpe(t,a,o),l=H.useMemo(()=>new f9(s,r,{layoutDelegate:n}),[s,r,n]);return tme(s,l),{collection:s,disabledKeys:i,selectionManager:l}}function tme(t,e){const n=H.useRef(null);H.useEffect(()=>{if(e.focusedKey!=null&&!t.getItem(e.focusedKey)&&n.current){const f=n.current.getItem(e.focusedKey),u=[...n.current.getKeys()].map(y=>{const v=n.current.getItem(y);return v?.type==="item"?v:null}).filter(y=>y!==null),d=[...t.getKeys()].map(y=>{const v=t.getItem(y);return v?.type==="item"?v:null}).filter(y=>y!==null);var r,i;const h=((r=u?.length)!==null&&r!==void 0?r:0)-((i=d?.length)!==null&&i!==void 0?i:0);var a,o,s;let p=Math.min(h>1?Math.max(((a=f?.index)!==null&&a!==void 0?a:0)-h+1,0):(o=f?.index)!==null&&o!==void 0?o:0,((s=d?.length)!==null&&s!==void 0?s:0)-1),g=null,m=!1;for(;p>=0;){if(!e.isDisabled(d[p].key)){g=d[p];break}if(p<d.length-1&&!m)p++;else{m=!0;var l,c;p>((l=f?.index)!==null&&l!==void 0?l:0)&&(p=(c=f?.index)!==null&&c!==void 0?c:0),p--}}e.setFocusedKey(g?g.key:null)}n.current=t},[t,e])}function nme(t){var e;let[n,r]=$2(t.selectedKey,(e=t.defaultSelectedKey)!==null&&e!==void 0?e:null,t.onSelectionChange),i=H.useMemo(()=>n!=null?[n]:[],[n]),{collection:a,disabledKeys:o,selectionManager:s}=g9({...t,selectionMode:"single",disallowEmptySelection:!0,allowDuplicateSelectionEvents:!0,selectedKeys:i,onSelectionChange:c=>{if(c==="all")return;var f;let u=(f=c.values().next().value)!==null&&f!==void 0?f:null;u===n&&t.onSelectionChange&&t.onSelectionChange(u),r(u)}}),l=n!=null?a.getItem(n):null;return{collection:a,disabledKeys:o,selectionManager:s,selectedKey:n,setSelectedKey:r,selectedItem:l}}function rme(t){var e,n;let r=nme({...t,onSelectionChange:t.onSelectionChange?l=>{var c;l!=null&&((c=t.onSelectionChange)===null||c===void 0||c.call(t,l))}:void 0,suppressTextValueWarning:!0,defaultSelectedKey:(n=(e=t.defaultSelectedKey)!==null&&e!==void 0?e:yN(t.collection,t.disabledKeys?new Set(t.disabledKeys):new Set))!==null&&n!==void 0?n:void 0}),{selectionManager:i,collection:a,selectedKey:o}=r,s=H.useRef(o);return H.useEffect(()=>{let l=o;t.selectedKey==null&&(i.isEmpty||l==null||!a.getItem(l))&&(l=yN(a,r.disabledKeys),l!=null&&i.setSelectedKeys([l])),(l!=null&&i.focusedKey==null||!i.isFocused&&l!==s.current)&&i.setFocusedKey(l),s.current=l}),{...r,isDisabled:t.isDisabled||!1}}function yN(t,e){let n=null;if(t){var r,i,a,o;for(n=t.getFirstKey();n!=null&&(e.has(n)||!((i=t.getItem(n))===null||i===void 0||(r=i.props)===null||r===void 0)&&r.isDisabled)&&n!==t.getLastKey();)n=t.getKeyAfter(n);n!=null&&(e.has(n)||!((o=t.getItem(n))===null||o===void 0||(a=o.props)===null||a===void 0)&&a.isDisabled)&&n===t.getLastKey()&&(n=t.getFirstKey())}return n}function ime(t){var e,n,r;const i=es(),[a,o]=Vl(t,wP.variantKeys),{ref:s,as:l,className:c,classNames:f,children:u,disableCursorAnimation:d,motionProps:h,isVertical:p=!1,shouldSelectOnPressUp:g=!0,destroyInactiveTabPanel:m=!0,...y}=a,v=l||"div",x=typeof v=="string",w=Di(s),S=(n=(e=t?.disableAnimation)!=null?e:i?.disableAnimation)!=null?n:!1,T=rme({children:u,...y}),{tabListProps:_}=Zge(y,T,w),D=H.useMemo(()=>wP({...o,disableAnimation:S,...p?{placement:"start"}:{}}),[kl(o),S,p]),I=ln(f?.base,c),R=H.useMemo(()=>({state:T,slots:D,classNames:f,motionProps:h,disableAnimation:S,listRef:w,shouldSelectOnPressUp:g,disableCursorAnimation:d,isDisabled:t?.isDisabled}),[T,D,w,h,S,d,g,t?.isDisabled,f]),M=H.useCallback(B=>({"data-slot":"base",className:D.base({class:ln(I,B?.className)}),...Pn(Io(y,{enabled:x}),B)}),[I,y,D]),A=(r=o.placement)!=null?r:p?"start":"top",L=H.useCallback(B=>({"data-slot":"tabWrapper",className:D.tabWrapper({class:ln(f?.tabWrapper,B?.className)}),"data-placement":A,"data-vertical":p||A==="start"||A==="end"?"vertical":"horizontal"}),[f,D,A,p]),P=H.useCallback(B=>({ref:w,"data-slot":"tabList",className:D.tabList({class:ln(f?.tabList,B?.className)}),...Pn(_,B)}),[w,_,f,D]);return{Component:v,domRef:w,state:T,values:R,destroyInactiveTabPanel:m,getBaseProps:M,getTabListProps:P,getWrapperProps:L}}var ame=Hi(function(e,n){const{Component:r,values:i,state:a,destroyInactiveTabPanel:o,getBaseProps:s,getTabListProps:l,getWrapperProps:c}=ime({...e,ref:n}),f=H.useId(),u=!e.disableAnimation&&!e.disableCursorAnimation,d={state:a,listRef:i.listRef,slots:i.slots,classNames:i.classNames,isDisabled:i.isDisabled,motionProps:i.motionProps,disableAnimation:i.disableAnimation,shouldSelectOnPressUp:i.shouldSelectOnPressUp,disableCursorAnimation:i.disableCursorAnimation},h=[...a.collection].map(g=>j.jsx(eme,{item:g,...d,...g.props},g.key)),p=j.jsxs(j.Fragment,{children:[j.jsx("div",{...s(),children:j.jsx(r,{...l(),children:u?j.jsx(ile,{id:f,children:h}):h})}),[...a.collection].map(g=>j.jsx(Qge,{classNames:i.classNames,destroyInactiveTabPanel:o,slots:i.slots,state:i.state,tabKey:g.key},g.key))]});return"placement"in e||"isVertical"in e?j.jsx("div",{...c(),children:p}):p}),ome=ame,sme=dz,vT=sme;function lme(t={}){const{domRef:e,isEnabled:n=!0,overflowCheck:r="vertical",visibility:i="auto",offset:a=0,onVisibilityChange:o,updateDeps:s=[]}=t,l=H.useRef(i);H.useEffect(()=>{const c=e?.current;if(!c||!n)return;const f=(h,p,g,m,y)=>{if(i==="auto"){const v=`${m}${TU(y)}Scroll`;p&&g?(c.dataset[v]="true",c.removeAttribute(`data-${m}-scroll`),c.removeAttribute(`data-${y}-scroll`)):(c.dataset[`${m}Scroll`]=p.toString(),c.dataset[`${y}Scroll`]=g.toString(),c.removeAttribute(`data-${m}-${y}-scroll`))}else{const v=p&&g?"both":p?m:g?y:"none";v!==l.current&&(o?.(v),l.current=v)}},u=()=>{var h,p;const g=[{type:"vertical",prefix:"top",suffix:"bottom"},{type:"horizontal",prefix:"left",suffix:"right"}],m=c.querySelector('ul[data-slot="list"]'),y=+((h=m?.getAttribute("data-virtual-scroll-height"))!=null?h:c.scrollHeight),v=+((p=m?.getAttribute("data-virtual-scroll-top"))!=null?p:c.scrollTop);for(const{type:x,prefix:w,suffix:S}of g)if(r===x||r==="both"){const T=x==="vertical"?v>a:c.scrollLeft>a,_=x==="vertical"?v+c.clientHeight+a<y:c.scrollLeft+c.clientWidth+a<c.scrollWidth;f(x,T,_,w,S)}},d=()=>{["top","bottom","top-bottom","left","right","left-right"].forEach(h=>{c.removeAttribute(`data-${h}-scroll`)})};return u(),c.addEventListener("scroll",u,!0),i!=="auto"&&(d(),i==="both"?(c.dataset.topBottomScroll=String(r==="vertical"),c.dataset.leftRightScroll=String(r==="horizontal")):(c.dataset.topBottomScroll="false",c.dataset.leftRightScroll="false",["top","bottom","left","right"].forEach(h=>{c.dataset[`${h}Scroll`]=String(i===h)}))),()=>{c.removeEventListener("scroll",u,!0),d()}},[...s,n,i,r,o,e])}function cme(t){var e;const[n,r]=Vl(t,Hb.variantKeys),{ref:i,as:a,children:o,className:s,style:l,size:c=40,offset:f=0,visibility:u="auto",isEnabled:d=!0,onVisibilityChange:h,...p}=n,g=a||"div",m=Di(i);lme({domRef:m,offset:f,visibility:u,isEnabled:d,onVisibilityChange:h,updateDeps:[o],overflowCheck:(e=t.orientation)!=null?e:"vertical"});const y=H.useMemo(()=>Hb({...r,className:s}),[kl(r),s]);return{Component:g,styles:y,domRef:m,children:o,getBaseProps:(x={})=>{var w;return{ref:m,className:y,"data-orientation":(w=t.orientation)!=null?w:"vertical",style:{"--scroll-shadow-size":`${c}px`,...l,...x.style},...p,...x}}}}var EW=Hi((t,e)=>{const{Component:n,children:r,getBaseProps:i}=cme({...t,ref:e});return j.jsx(n,{...i(),children:r})});EW.displayName="HeroUI.ScrollShadow";var ume=EW;function fme(t){const{collection:e,disabledKeys:n,selectionManager:r,selectionManager:{setSelectedKeys:i,selectedKeys:a,selectionMode:o}}=g9(t),s=H.useMemo(()=>!t.isLoading&&a.size!==0?Array.from(a).filter(Boolean).filter(c=>!e.getItem(c)):[],[a,e]),l=a.size!==0?Array.from(a).map(c=>e.getItem(c)).filter(Boolean):null;return s.length&&console.warn(`Select: Keys "${s.join(", ")}" passed to "selectedKeys" are not present in the collection.`),{collection:e,disabledKeys:n,selectionManager:r,selectionMode:o,selectedKeys:a,setSelectedKeys:i.bind(r),selectedItems:l}}function dme({validate:t,validationBehavior:e,...n}){const[r,i]=H.useState(!1),[a,o]=H.useState(null),s=Lge(n),l=fme({...n,onSelectionChange:u=>{n.onSelectionChange!=null&&(u==="all"?n.onSelectionChange(new Set(l.collection.getKeys())):n.onSelectionChange(u)),n.selectionMode==="single"&&s.close()}}),c=Dz({...n,validationBehavior:e,validate:u=>{if(!t)return;const d=Array.from(u);return t(n.selectionMode==="single"?d[0]:d)},value:l.selectedKeys}),f=l.collection.size===0&&n.hideEmptyContent;return{...c,...l,...s,focusStrategy:a,close(){s.close()},open(u=null){f||(o(u),s.open())},toggle(u=null){f||(o(u),s.toggle())},isFocused:r,setFocused:i}}function hme(t,e,n){const{disallowEmptySelection:r,isDisabled:i}=t,a=qU({usage:"search",sensitivity:"base"}),o=H.useMemo(()=>new cz(e.collection,e.disabledKeys,null,a),[e.collection,e.disabledKeys,a]),{menuTriggerProps:s,menuProps:l}=Nge({isDisabled:i,type:"listbox"},e,n),c=S=>{if(e.selectionMode==="single")switch(S.key){case"ArrowLeft":{S.preventDefault();const T=e.selectedKeys.size>0?o.getKeyAbove(e.selectedKeys.values().next().value):o.getFirstKey();T&&e.setSelectedKeys([T]);break}case"ArrowRight":{S.preventDefault();const T=e.selectedKeys.size>0?o.getKeyBelow(e.selectedKeys.values().next().value):o.getFirstKey();T&&e.setSelectedKeys([T]);break}}},{typeSelectProps:f}=oz({keyboardDelegate:o,selectionManager:e.selectionManager,onTypeSelect(S){e.setSelectedKeys([S])}}),{isInvalid:u,validationErrors:d,validationDetails:h}=e.displayValidation,{labelProps:p,fieldProps:g,descriptionProps:m,errorMessageProps:y}=Iz({...t,labelElementType:"span",isInvalid:u,errorMessage:t.errorMessage||d});f.onKeyDown=f.onKeyDownCapture,delete f.onKeyDownCapture,s.onPressStart=S=>{S.pointerType!=="touch"&&S.pointerType!=="keyboard"&&!i&&e.toggle(S.pointerType==="virtual"?"first":null)};const v=T0(t,{labelable:!0}),x=Oi(f,s,g),w=Js();return{labelProps:{...p,onClick:()=>{var S;t.isDisabled||((S=n.current)==null||S.focus(),V$("keyboard"))}},triggerProps:Oi(v,{...x,onKeyDown:o0(x.onKeyDown,c,t.onKeyDown),onKeyUp:t.onKeyUp,"aria-labelledby":[w,x["aria-labelledby"],x["aria-label"]&&!x["aria-labelledby"]?x.id:null].join(","),onFocus(S){e.isFocused||(t.onFocus&&t.onFocus(S),e.setFocused(!0))},onBlur(S){e.isOpen||(t.onBlur&&t.onBlur(S),e.setFocused(!1))}}),valueProps:{id:w},menuProps:{...l,disallowEmptySelection:r,autoFocus:e.focusStrategy||!0,shouldSelectOnPressUp:!0,shouldFocusOnHover:!0,onBlur:S=>{S.currentTarget.contains(S.relatedTarget)||(t.onBlur&&t.onBlur(S),e.setFocused(!1))},onFocus:l?.onFocus,"aria-labelledby":[g["aria-labelledby"],x["aria-label"]&&!g["aria-labelledby"]?x.id:null].filter(Boolean).join(" ")},descriptionProps:m,errorMessageProps:y,isInvalid:u,validationErrors:d,validationDetails:h}}var _W=new WeakMap;function pme(t){var e,n,r,i,a,o;const s=es(),{validationBehavior:l}=p9(Xb)||{},[c,f]=Vl(t,EP.variantKeys),u=(n=(e=t.disableAnimation)!=null?e:s?.disableAnimation)!=null?n:!1,{ref:d,as:h,label:p,name:g,isLoading:m,selectorIcon:y,isOpen:v,defaultOpen:x,onOpenChange:w,startContent:S,endContent:T,description:_,renderValue:D,onSelectionChange:I,placeholder:R,isVirtualized:M,itemHeight:A=36,maxListboxHeight:L=256,children:P,disallowEmptySelection:B=!1,selectionMode:U="single",spinnerRef:G,scrollRef:F,popoverProps:$={},scrollShadowProps:V={},listboxProps:X={},spinnerProps:Q={},validationState:re,onChange:ye,onClose:me,className:Ce,classNames:we,validationBehavior:Ae=(r=l??s?.validationBehavior)!=null?r:"native",hideEmptyContent:De=!1,onClear:q,...k}=c,J=Di(F),Y={popoverProps:Pn({placement:"bottom",triggerScaleOnOpen:!1,offset:5,disableAnimation:u},$),scrollShadowProps:Pn({ref:J,isEnabled:(i=t.showScrollIndicators)!=null?i:!0,hideScrollBar:!0,offset:15},V),listboxProps:Pn({disableAnimation:u},X)},ie=h||"button",ue=typeof ie=="string",fe=Di(d),Se=H.useRef(null),Fe=H.useRef(null),Ke=H.useRef(null);let He=dme({...c,isOpen:v,selectionMode:U,disallowEmptySelection:B,validationBehavior:Ae,children:P,isRequired:t.isRequired,isDisabled:t.isDisabled,isInvalid:t.isInvalid,defaultOpen:x,hideEmptyContent:De,onOpenChange:At=>{w?.(At),At||me?.()},onSelectionChange:At=>{I?.(At),ye&&typeof ye=="function"&&ye({target:{...fe.current&&{...fe.current,name:fe.current.name},value:Array.from(At).join(",")}}),He.commitValidation()}});He={...He,...t.isDisabled&&{disabledKeys:new Set([...He.collection.getKeys()])}},d9(()=>{var At;(At=fe.current)!=null&&At.value&&He.setSelectedKeys(new Set([...He.selectedKeys,fe.current.value]))},[fe.current]);const{labelProps:pe,triggerProps:ge,valueProps:Ie,menuProps:ve,descriptionProps:_e,errorMessageProps:Pe,isInvalid:ne,validationErrors:Je,validationDetails:$e}=hme({...c,disallowEmptySelection:B,isDisabled:t.isDisabled},He,Se),ke=H.useCallback(()=>{var At;He.setSelectedKeys(new Set([])),q?.(),(At=Se.current)==null||At.focus()},[q,He]),{pressProps:Re}=Uf({isDisabled:!!t?.isDisabled,onPress:ke}),ze=t.isInvalid||re==="invalid"||ne,{isPressed:st,buttonProps:Qe}=h9(ge,Se),{focusProps:_t,isFocused:Le,isFocusVisible:We}=Pl(),{focusProps:xt,isFocusVisible:Ut}=Pl(),{isHovered:gn,hoverProps:tn}=Zs({isDisabled:t.isDisabled}),Ht=Bfe({labelPlacement:t.labelPlacement,label:p}),dn=!!R,sr=Ht==="outside-left"||Ht==="outside",Qn=Ht==="inside",qe=Ht==="outside-left",Dt=t.isClearable,Rt=He.isOpen||dn||!!((a=He.selectedItems)!=null&&a.length)||!!S||!!T||!!t.isMultiline,Bt=!!((o=He.selectedItems)!=null&&o.length),On=!!p,$t=On&&(qe||sr&&dn),Xt=ln(we?.base,Ce),Lt=H.useMemo(()=>EP({...f,isInvalid:ze,isClearable:Dt,labelPlacement:Ht,disableAnimation:u}),[kl(f),ze,Ht,u]);W$({isDisabled:!He.isOpen});const Qt=typeof c.errorMessage=="function"?c.errorMessage({isInvalid:ze,validationErrors:Je,validationDetails:$e}):c.errorMessage||Je?.join(" "),yr=!!_||!!Qt,kr=!!T;H.useEffect(()=>{if(He.isOpen&&Ke.current&&Se.current){let At=Se.current.getBoundingClientRect(),Li=Ke.current;Li.style.width=At.width+"px"}},[He.isOpen]);const ni=H.useCallback((At={})=>({"data-slot":"base","data-filled":Nt(Rt),"data-has-value":Nt(Bt),"data-has-label":Nt(On),"data-has-helper":Nt(yr),"data-has-end-content":Nt(kr),"data-invalid":Nt(ze),"data-has-label-outside":Nt($t),className:Lt.base({class:ln(Xt,At.className)}),...At}),[Lt,yr,Bt,On,$t,Rt,Xt]),Ii=H.useCallback((At={})=>({ref:Se,"data-slot":"trigger","data-open":Nt(He.isOpen),"data-disabled":Nt(t?.isDisabled),"data-focus":Nt(Le),"data-pressed":Nt(st),"data-focus-visible":Nt(We),"data-hover":Nt(gn),className:Lt.trigger({class:we?.trigger}),...Pn(Qe,_t,tn,Io(k,{enabled:ue}),Io(At))}),[Lt,Se,He.isOpen,we?.trigger,t?.isDisabled,Le,st,We,gn,Qe,_t,tn,k,ue]),fi=H.useCallback((At={})=>({state:He,triggerRef:Se,selectRef:fe,selectionMode:U,label:t?.label,name:t?.name,isRequired:t?.isRequired,autoComplete:t?.autoComplete,isDisabled:t?.isDisabled,form:t?.form,onChange:ye,...At}),[He,U,t?.label,t?.autoComplete,t?.name,t?.isDisabled,Se]),Ri=H.useCallback((At={})=>({"data-slot":"label",className:Lt.label({class:ln(we?.label,At.className)}),...pe,...At}),[Lt,we?.label,pe]),rn=H.useCallback((At={})=>({"data-slot":"value",className:Lt.value({class:ln(we?.value,At.className)}),...Ie,...At}),[Lt,we?.value,Ie]),Xn=H.useCallback((At={})=>({"data-slot":"listboxWrapper",className:Lt.listboxWrapper({class:ln(we?.listboxWrapper,At?.className)}),style:{maxHeight:L??256,...At.style},...Pn(Y.scrollShadowProps,At)}),[Lt.listboxWrapper,we?.listboxWrapper,Y.scrollShadowProps,L]),vi=(At={})=>{const Li=M??He.collection.size>50;return{state:He,ref:Fe,isVirtualized:Li,virtualization:Li?{maxListboxHeight:L,itemHeight:A}:void 0,"data-slot":"listbox",className:Lt.listbox({class:ln(we?.listbox,At?.className)}),scrollShadowProps:Y.scrollShadowProps,...Pn(Y.listboxProps,At,ve)}},an=H.useCallback((At={})=>{var Li,Xa;const di=Pn(Y.popoverProps,At);return{state:He,triggerRef:Se,ref:Ke,"data-slot":"popover",scrollRef:Fe,triggerType:"listbox",classNames:{content:Lt.popoverContent({class:ln(we?.popoverContent,At.className)})},...di,offset:He.selectedItems&&He.selectedItems.length>0?He.selectedItems.length*1e-8+(((Li=Y.popoverProps)==null?void 0:Li.offset)||0):(Xa=Y.popoverProps)==null?void 0:Xa.offset}},[Lt,we?.popoverContent,Y.popoverProps,Se,He,He.selectedItems]),ri=H.useCallback(()=>({"data-slot":"selectorIcon","aria-hidden":Nt(!0),"data-open":Nt(He.isOpen),className:Lt.selectorIcon({class:we?.selectorIcon})}),[Lt,we?.selectorIcon,He.isOpen]),ts=H.useCallback((At={})=>({...At,"data-slot":"innerWrapper",className:Lt.innerWrapper({class:ln(we?.innerWrapper,At?.className)})}),[Lt,we?.innerWrapper]),ii=H.useCallback((At={})=>({...At,"data-slot":"helperWrapper",className:Lt.helperWrapper({class:ln(we?.helperWrapper,At?.className)})}),[Lt,we?.helperWrapper]),Ai=H.useCallback((At={})=>({...At,..._e,"data-slot":"description",className:Lt.description({class:ln(we?.description,At?.className)})}),[Lt,we?.description]),wa=H.useCallback((At={})=>({...At,"data-slot":"mainWrapper",className:Lt.mainWrapper({class:ln(we?.mainWrapper,At?.className)})}),[Lt,we?.mainWrapper]),Pi=H.useCallback((At={})=>({...At,"data-slot":"end-wrapper",className:Lt.endWrapper({class:ln(we?.endWrapper,At?.className)})}),[Lt,we?.endWrapper]),Os=H.useCallback((At={})=>({...At,"data-slot":"end-content",className:Lt.endContent({class:ln(we?.endContent,At?.className)})}),[Lt,we?.endContent]),No=H.useCallback((At={})=>({...At,...Pe,"data-slot":"error-message",className:Lt.errorMessage({class:ln(we?.errorMessage,At?.className)})}),[Lt,Pe,we?.errorMessage]),Ni=H.useCallback((At={})=>({"aria-hidden":Nt(!0),"data-slot":"spinner",color:"current",size:"sm",...Q,...At,ref:G,className:Lt.spinner({class:ln(we?.spinner,At?.className)})}),[Lt,G,Q,we?.spinner]),Lo=H.useCallback((At={})=>({...At,type:"button",tabIndex:-1,"aria-label":"clear selection","data-slot":"clear-button","data-focus-visible":Nt(Ut),className:Lt.clearButton({class:ln(we?.clearButton,At?.className)}),...Pn(Re,xt)}),[Lt,Ut,Re,xt,we?.clearButton]);return _W.set(He,{isDisabled:t?.isDisabled,isRequired:t?.isRequired,name:t?.name,isInvalid:ze,validationBehavior:Ae}),{Component:ie,domRef:fe,state:He,label:p,name:g,triggerRef:Se,isLoading:m,placeholder:R,startContent:S,endContent:T,description:_,selectorIcon:y,hasHelper:yr,labelPlacement:Ht,hasPlaceholder:dn,renderValue:D,selectionMode:U,disableAnimation:u,isOutsideLeft:qe,shouldLabelBeOutside:sr,shouldLabelBeInside:Qn,isInvalid:ze,errorMessage:Qt,isClearable:Dt,getClearButtonProps:Lo,getBaseProps:ni,getTriggerProps:Ii,getLabelProps:Ri,getValueProps:rn,getListboxProps:vi,getPopoverProps:an,getSpinnerProps:Ni,getMainWrapperProps:wa,getListboxWrapperProps:Xn,getHiddenSelectProps:fi,getInnerWrapperProps:ts,getHelperWrapperProps:ii,getDescriptionProps:Ai,getErrorMessageProps:No,getSelectorIconProps:ri,getEndWrapperProps:Pi,getEndContentProps:Os}}var gme=typeof document<"u"?Tn.useLayoutEffect:()=>{};function mme(t){const e=H.useRef(null);return gme(()=>{e.current=t},[t]),H.useCallback((...n)=>{const r=e.current;return r?.(...n)},[])}function vme(t,e,n){let r=H.useRef(e),i=mme(()=>{n&&n(r.current)});H.useEffect(()=>{var a;let o=(a=t?.current)==null?void 0:a.form;return o?.addEventListener("reset",i),()=>{o?.removeEventListener("reset",i)}},[t,i])}function yme(t,e,n){var r;let i=_W.get(e)||{},{autoComplete:a,name:o=i.name,isDisabled:s=i.isDisabled,selectionMode:l,onChange:c,form:f}=t,{validationBehavior:u,isRequired:d,isInvalid:h}=i,{visuallyHiddenProps:p}=DG();return vme(t.selectRef,e.selectedKeys,e.setSelectedKeys),Oz({validationBehavior:u,focus:()=>{var g;return(g=n.current)==null?void 0:g.focus()}},e,t.selectRef),{containerProps:{...p,"aria-hidden":!0,"data-a11y-ignore":"aria-hidden-focus"},inputProps:{style:{display:"none"}},selectProps:{form:f,autoComplete:a,disabled:s,"aria-invalid":h||void 0,"aria-required":d&&u==="aria"||void 0,required:d&&u==="native",name:o,tabIndex:-1,value:l==="multiple"?[...e.selectedKeys].map(g=>String(g)):(r=[...e.selectedKeys][0])!=null?r:"",multiple:l==="multiple",onChange:g=>{e.setSelectedKeys(g.target.value),c?.(g)}}}}function xme(t){var e;let{state:n,triggerRef:r,selectRef:i,label:a,name:o,isDisabled:s,form:l}=t,{containerProps:c,selectProps:f}=yme({...t,selectRef:i},n,r);return n.collection.size<=300?j.jsx("div",{...c,"data-testid":"hidden-select-container",children:j.jsxs("label",{children:[a,j.jsxs("select",{...f,ref:i,children:[j.jsx("option",{}),[...n.collection.getKeys()].map(u=>{let d=n.collection.getItem(u);if(d?.type==="item")return j.jsx("option",{value:d.key,children:d.textValue},d.key)})]})]})}):o?j.jsx("input",{autoComplete:f.autoComplete,disabled:s,form:l,name:o,type:"hidden",value:(e=[...n.selectedKeys].join(","))!=null?e:""}):null}var bme=dz,DW=bme;const m9=new WeakMap;function wme(t){return typeof t=="string"?t.replace(/\s*/g,""):""+t}function Cme(t,e){let n=m9.get(t);if(!n)throw new Error("Unknown list");return`${n.id}-option-${wme(e)}`}function Sme(t,e,n){let r=T0(t,{labelable:!0}),i=t.selectionBehavior||"toggle",a=t.linkBehavior||(i==="replace"?"action":"override");i==="toggle"&&a==="action"&&(a="override");let{listProps:o}=Bpe({...t,ref:n,selectionManager:e.selectionManager,collection:e.collection,disabledKeys:e.disabledKeys,linkBehavior:a}),{focusWithinProps:s}=sp({onFocusWithin:t.onFocus,onBlurWithin:t.onBlur,onFocusWithinChange:t.onFocusChange}),l=Js(t.id);m9.set(e,{id:l,shouldUseVirtualFocus:t.shouldUseVirtualFocus,shouldSelectOnPressUp:t.shouldSelectOnPressUp,shouldFocusOnHover:t.shouldFocusOnHover,isVirtualized:t.isVirtualized,onAction:t.onAction,linkBehavior:a});let{labelProps:c,fieldProps:f}=Mz({...t,id:l,labelElementType:"span"});return{labelProps:c,listBoxProps:Oi(r,s,e.selectionManager.selectionMode==="multiple"?{"aria-multiselectable":"true"}:{},{role:"listbox",...Oi(f,o)})}}function Tme(t,e,n){var r,i;let{key:a}=t,o=m9.get(e);var s;let l=(s=t.isDisabled)!==null&&s!==void 0?s:e.selectionManager.isDisabled(a);var c;let f=(c=t.isSelected)!==null&&c!==void 0?c:e.selectionManager.isSelected(a);var u;let d=(u=t.shouldSelectOnPressUp)!==null&&u!==void 0?u:o?.shouldSelectOnPressUp;var h;let p=(h=t.shouldFocusOnHover)!==null&&h!==void 0?h:o?.shouldFocusOnHover;var g;let m=(g=t.shouldUseVirtualFocus)!==null&&g!==void 0?g:o?.shouldUseVirtualFocus;var y;let v=(y=t.isVirtualized)!==null&&y!==void 0?y:o?.isVirtualized,x=am(),w=am(),S={role:"option","aria-disabled":l||void 0,"aria-selected":e.selectionManager.selectionMode!=="none"?f:void 0};s0()&&y_()||(S["aria-label"]=t["aria-label"],S["aria-labelledby"]=x,S["aria-describedby"]=w);let T=e.collection.getItem(a);if(v){let G=Number(T?.index);S["aria-posinset"]=Number.isNaN(G)?void 0:G+1,S["aria-setsize"]=Xpe(e.collection)}let _=o?.onAction?()=>{var G;return o==null||(G=o.onAction)===null||G===void 0?void 0:G.call(o,a)}:void 0,D=Cme(e,a),{itemProps:I,isPressed:R,isFocused:M,hasAction:A,allowsSelection:L}=lz({selectionManager:e.selectionManager,key:a,ref:n,shouldSelectOnPressUp:d,allowsDifferentPressOrigin:d&&p,isVirtualized:v,shouldUseVirtualFocus:m,isDisabled:l,onAction:_||!(T==null||(r=T.props)===null||r===void 0)&&r.onAction?o0(T==null||(i=T.props)===null||i===void 0?void 0:i.onAction,_):void 0,linkBehavior:o?.linkBehavior,id:D}),{hoverProps:P}=Zs({isDisabled:l||!p,onHoverStart(){l2()||(e.selectionManager.setFocused(!0),e.selectionManager.setFocusedKey(a))}}),B=T0(T?.props);delete B.id;let U=BU(T?.props);return{optionProps:{...S,...Oi(B,I,P,U),id:D},labelProps:{id:x},descriptionProps:{id:w},isFocused:M,isFocusVisible:M&&e.selectionManager.isFocused&&l2(),isSelected:f,isDisabled:l,isPressed:R,allowsSelection:L,hasAction:A}}function Eme(t){let{heading:e,"aria-label":n}=t,r=Js();return{itemProps:{role:"presentation"},headingProps:e?{id:r,role:"presentation"}:{},groupProps:{role:"group","aria-label":n,"aria-labelledby":e?r:void 0}}}function _me(t){var e;const n=es(),{ref:r,as:i,state:a,variant:o,color:s,onAction:l,children:c,onSelectionChange:f,disableAnimation:u=(e=n?.disableAnimation)!=null?e:!1,itemClasses:d,className:h,topContent:p,bottomContent:g,emptyContent:m="No items.",hideSelectedIcon:y=!1,hideEmptyContent:v=!1,shouldHighlightOnFocus:x=!1,classNames:w,...S}=t,T=i||"ul",_=typeof T=="string",D=Di(r),I=g9({...t,children:c,onSelectionChange:f}),R=a||I,{listBoxProps:M}=Sme({...t,onAction:l},R,D),A=H.useMemo(()=>Wde(),[]),L=ln(w?.base,h);return{Component:T,state:R,variant:o,color:s,slots:A,classNames:w,topContent:p,bottomContent:g,emptyContent:m,hideEmptyContent:v,shouldHighlightOnFocus:x,hideSelectedIcon:y,disableAnimation:u,className:h,itemClasses:d,getBaseProps:(G={})=>({ref:D,"data-slot":"base",className:A.base({class:L}),...Io(S,{enabled:_}),...G}),getListProps:(G={})=>({"data-slot":"list",className:A.list({class:w?.list}),...M,...G}),getEmptyContentProps:(G={})=>({"data-slot":"empty-content",children:m,className:A.emptyContent({class:w?.emptyContent}),...G})}}function Dme(t){const{isSelected:e,disableAnimation:n,...r}=t;return j.jsx("svg",{"aria-hidden":"true","data-selected":e,role:"presentation",viewBox:"0 0 17 18",...r,children:j.jsx("polyline",{fill:"none",points:"1 9 7 14 15 4",stroke:"currentColor",strokeDasharray:22,strokeDashoffset:e?44:66,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,style:n?{}:{transition:"stroke-dashoffset 200ms ease"}})})}function Ome(t){var e,n;const r=es(),[i,a]=Vl(t,DP.variantKeys),{as:o,item:s,state:l,description:c,startContent:f,endContent:u,isVirtualized:d,selectedIcon:h,className:p,classNames:g,autoFocus:m,onPress:y,onPressUp:v,onPressStart:x,onPressEnd:w,onPressChange:S,onClick:T,shouldHighlightOnFocus:_,hideSelectedIcon:D=!1,isReadOnly:I=!1,...R}=i,M=(n=(e=t.disableAnimation)!=null?e:r?.disableAnimation)!=null?n:!1,A=H.useRef(null),L=o||(t.href?"a":"li"),P=typeof L=="string",{rendered:B,key:U}=s,G=l.disabledKeys.has(U)||t.isDisabled,F=l.selectionManager.selectionMode!=="none",$=Oj(),{pressProps:V,isPressed:X}=Uf({ref:A,isDisabled:G,onClick:T,onPress:y,onPressUp:v,onPressStart:x,onPressEnd:w,onPressChange:S}),{isHovered:Q,hoverProps:re}=Zs({isDisabled:G}),{isFocusVisible:ye,focusProps:me}=Pl({autoFocus:m}),{isFocused:Ce,isSelected:we,optionProps:Ae,labelProps:De,descriptionProps:q}=Tme({key:U,isDisabled:G,"aria-label":i["aria-label"],isVirtualized:d},l,A);let k=Ae;const J=H.useMemo(()=>DP({...a,isDisabled:G,disableAnimation:M,hasTitleTextChild:typeof B=="string",hasDescriptionTextChild:typeof c=="string"}),[kl(a),G,M,B,c]),Y=ln(g?.base,p);I&&(k=Uie(k));const ie=_&&Ce||($?Q||X:Q||Ce&&!ye),ue=(He={})=>({ref:A,...Pn(k,I?{}:Pn(me,V),re,Io(R,{enabled:P}),He),"data-selectable":Nt(F),"data-focus":Nt(Ce),"data-hover":Nt(ie),"data-disabled":Nt(G),"data-selected":Nt(we),"data-pressed":Nt(X),"data-focus-visible":Nt(ye),className:J.base({class:ln(Y,He.className)})}),fe=(He={})=>({...Pn(De,He),"data-label":Nt(!0),className:J.title({class:g?.title})}),Se=(He={})=>({...Pn(q,He),className:J.description({class:g?.description})}),Fe=(He={})=>({...Pn(He),className:J.wrapper({class:g?.wrapper})}),Ke=H.useCallback((He={})=>({"aria-hidden":Nt(!0),"data-disabled":Nt(G),className:J.selectedIcon({class:g?.selectedIcon}),...He}),[G,J,g]);return{Component:L,domRef:A,slots:J,classNames:g,isSelectable:F,isSelected:we,isDisabled:G,rendered:B,description:c,startContent:f,endContent:u,selectedIcon:h,hideSelectedIcon:D,disableAnimation:M,getItemProps:ue,getLabelProps:fe,getWrapperProps:Fe,getDescriptionProps:Se,getSelectedIconProps:Ke}}var OW=t=>{const{Component:e,rendered:n,description:r,isSelectable:i,isSelected:a,isDisabled:o,selectedIcon:s,startContent:l,endContent:c,hideSelectedIcon:f,disableAnimation:u,getItemProps:d,getLabelProps:h,getWrapperProps:p,getDescriptionProps:g,getSelectedIconProps:m}=Ome(t),y=H.useMemo(()=>{const v=j.jsx(Dme,{disableAnimation:u,isSelected:a});return typeof s=="function"?s({icon:v,isSelected:a,isDisabled:o}):s||v},[s,a,o,u]);return j.jsxs(e,{...d(),children:[l,r?j.jsxs("div",{...p(),children:[j.jsx("span",{...h(),children:n}),j.jsx("span",{...g(),children:r})]}):j.jsx("span",{...h(),children:n}),i&&!f&&j.jsx("span",{...m(),children:y}),c]})};OW.displayName="HeroUI.ListboxItem";var v9=OW,MW=Hi(({item:t,state:e,as:n,variant:r,color:i,disableAnimation:a,className:o,classNames:s,hideSelectedIcon:l,showDivider:c=!1,dividerProps:f={},itemClasses:u,title:d,items:h,...p},g)=>{const m=n||"li",y=H.useMemo(()=>Hde(),[]),v=ln(s?.base,o),x=ln(s?.divider,f?.className),{itemProps:w,headingProps:S,groupProps:T}=Eme({heading:t.rendered,"aria-label":t["aria-label"]});return j.jsxs(m,{"data-slot":"base",...Pn(w,p),className:y.base({class:v}),children:[t.rendered&&j.jsx("span",{...S,className:y.heading({class:s?.heading}),"data-slot":"heading",children:t.rendered}),j.jsxs("ul",{...T,className:y.group({class:s?.group}),"data-has-title":!!t.rendered,"data-slot":"group",children:[[...t.childNodes].map(_=>{const{key:D,props:I}=_;let R=j.jsx(v9,{classNames:u,color:i,disableAnimation:a,hideSelectedIcon:l,item:_,state:e,variant:r,...I},D);return _.wrapper&&(R=_.wrapper(R)),R}),c&&j.jsx(Zpe,{as:"li",className:y.divider({class:x}),...f})]})]},t.key)});MW.displayName="HeroUI.ListboxSection";var IW=MW;function Mme(t={}){const{domRef:e,isEnabled:n=!0,overflowCheck:r="vertical",visibility:i="auto",offset:a=0,onVisibilityChange:o,updateDeps:s=[]}=t,l=H.useRef(i);H.useEffect(()=>{const c=e?.current;if(!c||!n)return;const f=(h,p,g,m,y)=>{if(i==="auto"){const v=`${m}${TU(y)}Scroll`;p&&g?(c.dataset[v]="true",c.removeAttribute(`data-${m}-scroll`),c.removeAttribute(`data-${y}-scroll`)):(c.dataset[`${m}Scroll`]=p.toString(),c.dataset[`${y}Scroll`]=g.toString(),c.removeAttribute(`data-${m}-${y}-scroll`))}else{const v=p&&g?"both":p?m:g?y:"none";v!==l.current&&(o?.(v),l.current=v)}},u=()=>{var h,p;const g=[{type:"vertical",prefix:"top",suffix:"bottom"},{type:"horizontal",prefix:"left",suffix:"right"}],m=c.querySelector('ul[data-slot="list"]'),y=+((h=m?.getAttribute("data-virtual-scroll-height"))!=null?h:c.scrollHeight),v=+((p=m?.getAttribute("data-virtual-scroll-top"))!=null?p:c.scrollTop);for(const{type:x,prefix:w,suffix:S}of g)if(r===x||r==="both"){const T=x==="vertical"?v>a:c.scrollLeft>a,_=x==="vertical"?v+c.clientHeight+a<y:c.scrollLeft+c.clientWidth+a<c.scrollWidth;f(x,T,_,w,S)}},d=()=>{["top","bottom","top-bottom","left","right","left-right"].forEach(h=>{c.removeAttribute(`data-${h}-scroll`)})};return u(),c.addEventListener("scroll",u,!0),i!=="auto"&&(d(),i==="both"?(c.dataset.topBottomScroll=String(r==="vertical"),c.dataset.leftRightScroll=String(r==="horizontal")):(c.dataset.topBottomScroll="false",c.dataset.leftRightScroll="false",["top","bottom","left","right"].forEach(h=>{c.dataset[`${h}Scroll`]=String(i===h)}))),()=>{c.removeEventListener("scroll",u,!0),d()}},[...s,n,i,r,o,e])}function Ime(t){var e;const[n,r]=Vl(t,Hb.variantKeys),{ref:i,as:a,children:o,className:s,style:l,size:c=40,offset:f=0,visibility:u="auto",isEnabled:d=!0,onVisibilityChange:h,...p}=n,g=a||"div",m=Di(i);Mme({domRef:m,offset:f,visibility:u,isEnabled:d,onVisibilityChange:h,updateDeps:[o],overflowCheck:(e=t.orientation)!=null?e:"vertical"});const y=H.useMemo(()=>Hb({...r,className:s}),[kl(r),s]);return{Component:g,styles:y,domRef:m,children:o,getBaseProps:(x={})=>{var w;return{ref:m,className:y,"data-orientation":(w=t.orientation)!=null?w:"vertical",style:{"--scroll-shadow-size":`${c}px`,...l,...x.style},...p,...x}}}}var Rme=(t,e)=>{const n=[];for(const r of t)r.type==="section"?n.push(([...r.childNodes].length+1)*e):n.push(e);return n},Ame=t=>{if(!t||t.scrollTop===void 0||t.clientHeight===void 0||t.scrollHeight===void 0)return{isTop:!1,isBottom:!1,isMiddle:!1};const e=t.scrollTop===0,n=Math.ceil(t.scrollTop+t.clientHeight)>=t.scrollHeight;return{isTop:e,isBottom:n,isMiddle:!e&&!n}},Pme=t=>{var e;const{Component:n,state:r,color:i,variant:a,itemClasses:o,getBaseProps:s,topContent:l,bottomContent:c,hideEmptyContent:f,hideSelectedIcon:u,shouldHighlightOnFocus:d,disableAnimation:h,getEmptyContentProps:p,getListProps:g,scrollShadowProps:m}=t,{virtualization:y}=t;if(!y||!Lb(y)&&!y.maxListboxHeight&&!y.itemHeight)throw new Error("You are using a virtualized listbox. VirtualizedListbox requires 'virtualization' props with 'maxListboxHeight' and 'itemHeight' properties. This error might have originated from autocomplete components that use VirtualizedListbox. Please provide these props to use the virtualized listbox.");const{maxListboxHeight:v,itemHeight:x}=y,w=Math.min(v,x*r.collection.size),S=H.useRef(null),T=H.useMemo(()=>Rme([...r.collection],x),[r.collection,x]),_=qge({count:[...r.collection].length,getScrollElement:()=>S.current,estimateSize:B=>T[B]}),D=_.getVirtualItems(),I=_.getTotalSize(),{getBaseProps:R}=Ime({...m}),M=B=>{var U;const G=[...r.collection][B.index];if(!G)return null;const F={color:i,item:G,state:r,variant:a,disableAnimation:h,hideSelectedIcon:u,...G.props},$={position:"absolute",top:0,left:0,width:"100%",height:`${B.size}px`,transform:`translateY(${B.start}px)`};if(G.type==="section")return j.jsx(IW,{...F,itemClasses:o,style:{...$,...F.style}},G.key);let V=j.jsx(v9,{...F,classNames:Pn(o,(U=G.props)==null?void 0:U.classNames),shouldHighlightOnFocus:d,style:{...$,...F.style}},G.key);return G.wrapper&&(V=G.wrapper(V)),V},[A,L]=H.useState({isTop:!1,isBottom:!0,isMiddle:!1}),P=j.jsxs(n,{...g(),"data-virtual-scroll-height":I,"data-virtual-scroll-top":(e=S?.current)==null?void 0:e.scrollTop,children:[!r.collection.size&&!f&&j.jsx("li",{children:j.jsx("div",{...p()})}),j.jsx("div",{...Io(R()),ref:S,style:{height:v,overflow:"auto"},onScroll:B=>{L(Ame(B.target))},children:w>0&&x>0&&j.jsx("div",{style:{height:`${I}px`,width:"100%",position:"relative"},children:D.map(B=>M(B))})})]});return j.jsxs("div",{...s(),children:[l,P,c]})},Nme=Pme,Lme=Hi(function(e,n){const{isVirtualized:r,...i}=e,a=_me({...i,ref:n}),{Component:o,state:s,color:l,variant:c,itemClasses:f,getBaseProps:u,topContent:d,bottomContent:h,hideEmptyContent:p,hideSelectedIcon:g,shouldHighlightOnFocus:m,disableAnimation:y,getEmptyContentProps:v,getListProps:x}=a;if(r)return j.jsx(Nme,{...e,...a});const w=j.jsxs(o,{...x(),children:[!s.collection.size&&!p&&j.jsx("li",{children:j.jsx("div",{...v()})}),[...s.collection].map(S=>{var T;const _={color:l,item:S,state:s,variant:c,disableAnimation:y,hideSelectedIcon:g,...S.props};if(S.type==="section")return j.jsx(IW,{..._,itemClasses:f},S.key);let D=j.jsx(v9,{..._,classNames:Pn(f,(T=S.props)==null?void 0:T.classNames),shouldHighlightOnFocus:m},S.key);return S.wrapper&&(D=S.wrapper(D)),D})]});return j.jsxs("div",{...u(),children:[d,w,h]})}),kme=Lme,Vme=Hi(function(e,n){var r;const{Component:i,state:a,label:o,hasHelper:s,isLoading:l,triggerRef:c,selectorIcon:f=j.jsx(d0e,{}),description:u,errorMessage:d,isInvalid:h,startContent:p,endContent:g,placeholder:m,renderValue:y,shouldLabelBeOutside:v,disableAnimation:x,getBaseProps:w,getLabelProps:S,getTriggerProps:T,getValueProps:_,getListboxProps:D,getPopoverProps:I,getSpinnerProps:R,getMainWrapperProps:M,getInnerWrapperProps:A,getHiddenSelectProps:L,getHelperWrapperProps:P,getListboxWrapperProps:B,getDescriptionProps:U,getErrorMessageProps:G,getSelectorIconProps:F,isClearable:$,getClearButtonProps:V,getEndWrapperProps:X,getEndContentProps:Q}=pme({...e,ref:n}),re=o?j.jsx("label",{...S(),children:o}):null,ye=H.cloneElement(f,F()),me=H.useMemo(()=>{var k;return $&&((k=a.selectedItems)!=null&&k.length)?j.jsx("span",{...V(),children:j.jsx(s9,{})}):null},[$,V,(r=a.selectedItems)==null?void 0:r.length]),Ce=H.useMemo(()=>me?j.jsxs("div",{...X(),children:[me,g&&j.jsx("span",{...Q(),children:g})]}):g&&j.jsx("span",{...Q(),children:g}),[me,g,X,Q]),we=H.useMemo(()=>{const k=h&&d;return!s||!(k||u)?null:j.jsx("div",{...P(),children:k?j.jsx("div",{...G(),children:d}):j.jsx("div",{...U(),children:u})})},[s,h,d,u,P,G,U]),Ae=H.useMemo(()=>{var k;if(!((k=a.selectedItems)!=null&&k.length))return m;if(y&&typeof y=="function"){const J=[...a.selectedItems].map(Y=>({key:Y.key,data:Y.value,type:Y.type,props:Y.props,textValue:Y.textValue,rendered:Y.rendered,"aria-label":Y["aria-label"]}));return y(J)}return a.selectedItems.map(J=>J.textValue).join(", ")},[a.selectedItems,y,m]),De=H.useMemo(()=>l?j.jsx(Dw,{...R()}):ye,[l,ye,R]),q=H.useMemo(()=>a.isOpen?j.jsx(Age,{...I(),children:j.jsx(ume,{...B(),children:j.jsx(kme,{...D()})})}):null,[a.isOpen,I,a,c,B,D]);return j.jsxs("div",{...w(),children:[j.jsx(xme,{...L()}),v?re:null,j.jsxs("div",{...M(),children:[j.jsxs(i,{...T(),children:[v?null:re,j.jsxs("div",{...A(),children:[p,j.jsx("span",{..._(),children:Ae}),g&&a.selectedItems&&j.jsx(OG,{elementType:"span",children:","}),Ce]}),De]}),we]}),x?q:j.jsx(ww,{children:q})]})}),RW=Vme;const lp=()=>{const{userInfo:t,isAuthenticated:e}=Bf(),n=t?.role===1,r=t?.role===2,i=t?.role===3,a=n,o=n||r,s=e(),l=o,c=o,f=i,u=i;return{userInfo:t,role:t?.role,isAuthenticated:e(),isAdmin:n,isTeacher:r,isStudent:i,hasAdminPermission:a,hasTeacherPermission:o,hasStudentPermission:s,canUpload:l,canViewAllStudentData:c,canCopyData:f,canEditOwnData:u}},Fme=async(t=1,e=10,n,r,i)=>{const a={page:t,per_page:e};return r&&(a.category=r),La.get("/admin/original-data",a)},Ume=async t=>La.get(`/admin/original-data/detail?original_id=${t}`),Bme=async(t,e)=>La.post("/admin/original-data/update",{original_id:t,...e}),$me=async t=>La.post("/student/copy",t),Gme=async t=>La.post("/student/del",{user_copy_id:t}),jme=async(t,e)=>La.post("/student/update-copy-name",{user_copy_id:t,copy_name:e}),zme=async(t,e)=>La.post("/admin/original-data/updateOriginalAnnotation",{original_id:t,annotation:e}),Wme=async(t,e)=>La.post("/student/updateAnnotation",{user_copy_id:t,annotation:e});class xN extends Error{constructor(e,n,r){super(e),this.name="AppError",this.status=n,this.code=r}}const Od={handleApiError:(t,e="操作失败，请重试")=>{console.error("API Error:",t);let n=e;return t instanceof xN?n=t.message:t?.response?.data?.message?n=t.response.data.message:t?.message&&(n=t.message),Vt({color:"danger",description:n}),n},handleNetworkError:t=>{console.error("Network Error:",t);const e="网络连接失败，请检查网络设置";return Vt({color:"danger",description:e}),e},handleValidationError:t=>{const n=Object.values(t).flat().join(", ");return Vt({color:"warning",description:n}),n},createApiError:(t,e,n)=>new xN(t,e,n),isNetworkError:t=>!t.response||t.code==="NETWORK_ERROR",isAuthError:t=>t.response?.status===401||t.response?.status===403},Hme=({dcm:t,showOwnerInfo:e=!1})=>{const n=o=>"name"in o?o.name:o.copy_name||o.original_data.name,r=o=>"category"in o?o.category:o.original_data.category,i=o=>"remark"in o?o.remark:o.original_data.remark,a=o=>o&&{1:"X光影像",2:"CT",3:"MRI",4:"超声",5:"PET",6:"病理图像"}[o]||"未分类";return j.jsxs("div",{className:"flex-1 min-h-[120px] flex flex-col",onClick:()=>{},children:[j.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2 line-clamp-2",children:n(t)}),j.jsxs("div",{className:"space-y-2 text-sm text-gray-600 flex-1",children:[j.jsxs("p",{className:"text-xs",children:["创建时间: ",new Date(t.created_at).toLocaleDateString("zh-CN")," | 更新时间: ",new Date(t.updated_at).toLocaleDateString("zh-CN")]}),e&&t.original_id&&j.jsxs("p",{className:"text-blue-600 text-xs",children:["数据ID: ",t.original_id]}),r(t)&&j.jsxs("div",{className:"flex items-center space-x-2",children:[j.jsx("span",{className:"text-gray-500 text-xs",children:"分类:"}),j.jsx(f2,{size:"sm",color:"primary",variant:"flat",className:"text-xs h-[20px]",children:a(r(t))})]}),i(t)&&i(t).trim()&&j.jsxs("div",{className:"flex items-center w-full space-x-2 h-[20px] overflow-hidden",children:[j.jsx("span",{className:"text-gray-500 text-xs flex-shrink-0",children:"标签:"}),j.jsx("div",{className:"flex flex-wrap gap-1 h-[20px]",children:i(t).split(",").filter(o=>o.trim()).map((o,s)=>j.jsx(f2,{size:"sm",color:"secondary",variant:"flat",className:"text-xs h-full max-w-[120px] truncate",children:o.trim()},s))})]})]})]})},Kme=({dcm:t,loading:e,isPublicData:n=!1,isStudentData:r=!1,showCopyButton:i=!0,showEditButton:a=!1,onCopy:o,onDelete:s,onEditName:l})=>{const c=bc(),{isAdmin:f,isTeacher:u,isStudent:d}=lp(),h=p=>{p.stopPropagation(),n?c(`/edit/${t.original_id}`):"user_copy_id"in t&&l()};return j.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[n&&j.jsxs(j.Fragment,{children:[d&&i&&j.jsx(zr,{size:"sm",color:"primary",variant:"flat",isLoading:e.copy,onClick:p=>{p.stopPropagation(),o()},children:"拷贝"}),a&&(u||f)&&j.jsx(zr,{size:"sm",color:"secondary",variant:"flat",onClick:h,children:"编辑"})]}),r&&d&&j.jsxs(j.Fragment,{children:[j.jsx(zr,{size:"sm",color:"secondary",variant:"flat",onClick:h,children:"修改名称"}),j.jsx(zr,{size:"sm",color:"danger",variant:"flat",isLoading:e.delete,onClick:p=>{p.stopPropagation(),s()},children:"删除"})]})]})},qme=({isOpen:t,currentName:e,onClose:n,onSave:r,title:i="修改名称",placeholder:a="请输入新的名称"})=>{const[o,s]=H.useState(e),[l,c]=H.useState(!1),f=async()=>{if(o.trim()){c(!0);try{await r(o.trim()),n()}finally{c(!1)}}},u=()=>{s(e),n()};return t?j.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50",children:j.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[j.jsxs("div",{className:"flex justify-between items-center mb-4",children:[j.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:i}),j.jsx("button",{onClick:u,className:"text-gray-400 hover:text-gray-600",children:j.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:j.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),j.jsx("div",{className:"space-y-4",children:j.jsxs("div",{children:[j.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"新的名称"}),j.jsx("input",{type:"text",value:o,onChange:d=>s(d.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:a})]})}),j.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[j.jsx("button",{onClick:u,className:"px-4 py-2 text-gray-600 hover:text-gray-800 transition-colors",disabled:l,children:"取消"}),j.jsx("button",{onClick:f,disabled:l||!o.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:l?"保存中...":"确认保存"})]})]})}):null},Xme=({isOpen:t,title:e,message:n,confirmText:r="确认",cancelText:i="取消",confirmColor:a="primary",onConfirm:o,onCancel:s,isLoading:l=!1})=>t?j.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:j.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[j.jsxs("div",{className:"mb-4",children:[j.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:e}),j.jsx("p",{className:"text-gray-600 mt-2",children:n})]}),j.jsxs("div",{className:"flex justify-end space-x-3",children:[j.jsx(zr,{color:"default",variant:"flat",onClick:s,disabled:l,children:i}),j.jsx(zr,{color:a,onClick:o,isLoading:l,children:r})]})]})}):null;function Yme({currentImageIndex:t,totalImages:e,frameRate:n=0,zoom:r=1,windowWidth:i=0,windowCenter:a=0,renderTime:o=0,isVisible:s=!0}){return s?j.jsx("div",{className:"fixed bottom-4 right-4 z-50 bg-black bg-opacity-80 text-white p-3 rounded-lg shadow-lg border border-gray-600 min-w-[200px]",children:j.jsxs("div",{className:"space-y-2 text-sm",children:[j.jsxs("div",{className:"flex justify-between items-center",children:[j.jsx("span",{className:"text-gray-300",children:"Img:"}),j.jsxs("em",{className:"text-white font-mono",children:[t||1,"/",e]})]}),j.jsxs("div",{className:"flex justify-between items-center",children:[j.jsx("span",{className:"text-gray-300",children:"FPS:"}),j.jsx("em",{className:"text-white font-mono",children:n?n.toFixed(1):"0.0"})]}),j.jsxs("div",{className:"flex justify-between items-center",children:[j.jsx("span",{className:"text-gray-300",children:"Zoom:"}),j.jsx("em",{className:"text-white font-mono",children:r?r.toFixed(2):"1.00"})]}),j.jsxs("div",{className:"flex justify-between items-center",children:[j.jsx("span",{className:"text-gray-300",children:"WW/WL:"}),j.jsxs("em",{className:"text-white font-mono",children:[i?i.toFixed(0):"0","/",a?a.toFixed(0):"0"]})]}),j.jsxs("div",{className:"flex justify-between items-center",children:[j.jsx("span",{className:"text-gray-300",children:"Render:"}),j.jsxs("em",{className:"text-white font-mono",children:[o?o.toFixed(1):"0.0","ms"]})]})]})}):null}function y9({dcm:t,onFileClick:e,onDataChange:n,onCopySuccess:r,showOwnerInfo:i=!1,isPublicData:a=!1,isStudentData:o=!1,showCopyButton:s=!0,showEditButton:l=!1}){const{userInfo:c}=lp(),[f,u]=H.useState({copy:!1,delete:!1}),[d,h]=H.useState(!1),[p,g]=H.useState(!1),m=w=>"name"in w?w.name:w.copy_name||w.original_data.name,y=async()=>{if(!c?.user_id){Vt({color:"danger",description:"用户信息错误，请重新登录"});return}u(w=>({...w,copy:!0}));try{const w=await $me({original_id:t.original_id,copy_name:`${m(t)} - 复制`});w.success?(Vt({color:"success",description:"复制成功！数据已添加到您的账户"}),n?.(),r?.()):Od.handleApiError(new Error(w.message),"复制失败")}catch(w){Od.handleApiError(w,"复制失败")}finally{u(w=>({...w,copy:!1}))}},v=async w=>{if(!("user_copy_id"in t)){Vt({color:"danger",description:"只能修改复制的数据名称"});return}try{const S=await jme(t.user_copy_id,w);S.success?(Vt({color:"success",description:"复制名称修改成功"}),n?.()):Od.handleApiError(new Error(S.message),"修改失败")}catch(S){Od.handleApiError(S,"修改失败")}},x=async()=>{if(!c?.user_id){Vt({color:"danger",description:"用户信息错误，请重新登录"});return}if(!("user_copy_id"in t)){Vt({color:"danger",description:"只能删除复制的数据"});return}u(w=>({...w,delete:!0}));try{const w=await Gme(t.user_copy_id);w.success?(Vt({color:"success",description:"删除成功"}),n?.()):Od.handleApiError(new Error(w.message),"删除失败")}catch(w){Od.handleApiError(w,"删除失败")}finally{u(w=>({...w,delete:!1})),g(!1)}};return j.jsxs(j.Fragment,{children:[j.jsx(Zc,{className:"hover:shadow-md transition-shadow cursor-pointer",children:j.jsx(Jc,{className:"p-4",children:j.jsxs("div",{className:"flex items-center justify-between",children:[j.jsx("div",{className:"flex flex-1",onClick:()=>{e(t?.user_copy_id?t?.user_copy_id.toString():t.original_id.toString())},children:j.jsx(Hme,{dcm:t,showOwnerInfo:i})}),j.jsx(Kme,{dcm:t,loading:f,isPublicData:a,isStudentData:o,showCopyButton:s,showEditButton:l,onCopy:y,onDelete:()=>g(!0),onEditName:()=>h(!0)})]})})}),j.jsx(qme,{isOpen:d,currentName:m(t),onClose:()=>h(!1),onSave:v,title:"修改复制名称",placeholder:"请输入新的复制名称"}),j.jsx(Xme,{isOpen:p,title:"确认删除",message:`确定要删除数据集 "${m(t)}" 吗？此操作不可撤销。`,confirmText:"删除",cancelText:"取消",confirmColor:"danger",onConfirm:x,onCancel:()=>g(!1),isLoading:f.delete})]})}const Jme=async(t={})=>{const{page:e=1,per_page:n=10,keyword:r,...i}=t,a={page:e,per_page:n,...i};return r&&(a.keyword=r),La.get("/admin/users/students",a)},Zme=async(t,e)=>La.post("/admin/users/change-role",{user_id:t,new_role:e}),Qme=async t=>La.post("/admin/users/reset-password",{user_id:t}),e1e=async()=>La.get("/admin/original-data/test-oss/connection"),t1e=async t=>La.upload("/admin/oss/upload",t);function n1e({onFileClick:t,onCopySuccess:e}){const{isStudent:n,hasTeacherPermission:r}=lp(),[i,a]=H.useState([]),[o,s]=H.useState(!0),[l,c]=H.useState(1),[f,u]=H.useState(0),[d,h]=H.useState(0),[p,g]=H.useState(10),[m,y]=H.useState(void 0),v=async(w=l,S)=>{s(!0);try{const _=await Fme(w,p,void 0,(S===null?void 0:S??m)||void 0);_.success&&_.data?(a(_.data.list||[]),u(_.data.pagination.total||0),h(_.data.pagination.last_page||0),c(_.data.pagination.current_page||w),g(_.data.pagination.per_page||p)):Vt({color:"danger",description:_.message||"获取数据失败"})}catch(T){console.error("获取公共数据失败:",T),Vt({color:"danger",description:"网络错误，请稍后重试"})}finally{s(!1)}};H.useEffect(()=>{v()},[]);const x=w=>{c(w),v(w)};return o?j.jsx("div",{className:"flex items-center justify-center h-64",children:j.jsxs("div",{className:"flex items-center space-x-2",children:[j.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),j.jsx("div",{className:"text-gray-500",children:"加载中..."})]})}):j.jsxs("div",{className:"pb-6",children:[j.jsxs("div",{className:"flex justify-between items-center mb-6 gap-4 flex-wrap",children:[j.jsxs("h2",{className:"text-lg font-semibold text-gray-800",children:["公共数据列表 (",f,")"]}),j.jsxs("div",{className:"flex gap-x-2",children:[j.jsxs("div",{className:"flex items-center gap-2",children:[j.jsx("label",{className:"text-sm text-gray-600",children:"按分类筛选:"}),j.jsxs("select",{value:m??"",onChange:w=>{const S=w.target.value;if(!S){y(void 0),c(1),v(1,null);return}y(S),c(1),v(1,S)},className:"px-2 py-1 border rounded text-sm bg-white",children:[j.jsx("option",{value:"",children:"所有"}),j.jsx("option",{value:"1",children:"X光影像"}),j.jsx("option",{value:"2",children:"CT"}),j.jsx("option",{value:"3",children:"MRI"}),j.jsx("option",{value:"4",children:"超声"}),j.jsx("option",{value:"5",children:"PET"}),j.jsx("option",{value:"6",children:"病理图像"})]})]}),j.jsx("button",{onClick:()=>v(1,m??void 0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"刷新"})]})]}),j.jsx(Zc,{children:j.jsxs(Jc,{className:"p-6",children:[i.length===0?j.jsx("div",{className:"text-center py-16 text-gray-500",children:"暂无数据，试试更改筛选条件"}):j.jsx("div",{className:"space-y-4",children:i.map(w=>j.jsx(y9,{dcm:w,onFileClick:t,onDataChange:v,onCopySuccess:e,isPublicData:!0,showCopyButton:n,showEditButton:r},`PublicDataList${w.original_id}`))}),d>1&&j.jsx("div",{className:"flex flex-col sm:flex-row justify-center items-center px-6 py-5",children:j.jsx(Nw,{total:d,page:l,onChange:x,showControls:!0,size:"md",color:"primary",variant:"flat",radius:"md",classNames:{wrapper:"gap-4 overflow-visible h-12",item:"w-12 h-12 text-base cursor-pointer",cursor:"w-12 h-12 text-base cursor-pointer",prev:"w-12 h-12 text-base cursor-pointer",next:"w-12 h-12 text-base cursor-pointer",ellipsis:"w-12 h-12 text-base cursor-pointer"}})})]})})]})}const AW=H.forwardRef(({userId:t,onFileClick:e},n)=>{lp();const[r,i]=H.useState([]),[a,o]=H.useState(!1),[s,l]=H.useState(1),[c,f]=H.useState(0),[u,d]=H.useState(0),h=10,p=async()=>{o(!0);try{const m=await La.get("/student/userCopyList",{user_id:Number(t),page:s,per_page:h});m.success&&m.data?(i(m.data.list||[]),f(m.data.pagination.total||0),d(m.data.pagination.last_page||0),l(m.data.pagination.current_page||s)):Vt({color:"danger",description:m.message||"获取数据失败"})}catch(m){console.error("获取学生数据失败:",m),Vt({color:"danger",description:"网络错误，请稍后重试"})}finally{o(!1)}};H.useEffect(()=>{t&&p()},[t]);const g=m=>{l(m),p()};return H.useImperativeHandle(n,()=>({refresh:()=>p()}),[t]),a?j.jsx("div",{className:"flex items-center justify-center h-64",children:j.jsxs("div",{className:"flex items-center space-x-2",children:[j.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),j.jsx("div",{className:"text-gray-500",children:"加载中..."})]})}):j.jsxs("div",{className:"pb-6",children:[j.jsx("div",{className:"mb-6",children:j.jsxs("div",{className:"flex justify-between items-center",children:[j.jsxs("div",{children:[j.jsxs("h2",{className:"text-lg font-semibold text-gray-800",children:["我的数据列表 (",c,")"]}),j.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"您复制的数据，可以编辑名称"})]}),j.jsx("button",{onClick:()=>p(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"刷新"})]})}),j.jsx(Zc,{children:j.jsx(Jc,{className:"p-6",children:r.length===0?j.jsx("div",{className:"text-center py-8 text-gray-500",children:"暂无数据"}):j.jsxs(j.Fragment,{children:[j.jsx("div",{className:"space-y-4",children:r.map(m=>j.jsx(y9,{dcm:m,onFileClick:e,onDataChange:p,isPublicData:!1,isStudentData:!0,showCopyButton:!1,showEditButton:!1},`StudentDataList${m.user_copy_id}`))}),j.jsx("div",{className:"flex justify-center mt-6 w-full",children:j.jsx(Nw,{total:u,page:s,onChange:g,showControls:!0,size:"md",color:"primary",classNames:{wrapper:"gap-4 overflow-visible h-12",item:"w-12 h-12 text-base cursor-pointer",cursor:"w-12 h-12 text-base cursor-pointer",prev:"w-12 h-12 text-base cursor-pointer",next:"w-12 h-12 text-base cursor-pointer",ellipsis:"w-12 h-12 text-base cursor-pointer"}})})]})})})]})});AW.displayName="StudentDataList";function r1e({onFileClick:t}){const[e,n]=H.useState([]),[r,i]=H.useState(!1),[a,o]=H.useState(1),[s,l]=H.useState(0),[c,f]=H.useState(0),[u,d]=H.useState(""),h=10,p=async(y=a,v=u)=>{i(!0);try{const x=await La.get("/student/userCopyList",{keyword:v,per_page:h,page:y});x.success&&x.data?(n(x.data.list||[]),l(x.data.pagination.total||0),f(x.data.pagination.last_page||0),o(x.data.pagination.current_page||y)):Vt({color:"danger",description:x.message||"获取数据失败"})}catch(x){console.error("获取学生数据失败:",x),Vt({color:"danger",description:"网络错误，请稍后重试"})}finally{i(!1)}},g=()=>{o(1),p(1,u)},m=y=>{o(y),p(y,u)};return H.useEffect(()=>{p()},[]),r?j.jsx("div",{className:"flex items-center justify-center h-64",children:j.jsx("div",{className:"text-gray-500",children:"加载中..."})}):j.jsxs("div",{children:[j.jsx("div",{className:"mb-6",children:j.jsxs("h2",{className:"text-lg font-semibold text-gray-800",children:["所有学生数据 (",s,")"]})}),j.jsx("div",{className:"mb-6",children:j.jsx(d2,{placeholder:"搜索数据名称、拥有者、分类、标签",value:u,onValueChange:d,className:"max-w-md",endContent:j.jsx(zr,{size:"sm",color:"primary",variant:"flat",onClick:g,children:"搜索"}),onKeyDown:y=>{y.key==="Enter"&&g()}})}),j.jsx(Zc,{children:j.jsx(Jc,{className:"p-6",children:e.length===0?j.jsx("div",{className:"text-center py-8 text-gray-500",children:"暂无数据"}):j.jsxs(j.Fragment,{children:[j.jsx("div",{className:"space-y-4",children:e.map(y=>j.jsx(y9,{dcm:y,onFileClick:t,onDataChange:p,showOwnerInfo:!0,isStudentData:!0,showCopyButton:!1,showEditButton:!1},`AllStudentDataList${y.user_copy_id}`))}),j.jsx("div",{className:"flex justify-center mt-6 w-full",children:j.jsx(Nw,{total:c,page:a,onChange:m,showControls:!0,size:"md",color:"primary",classNames:{wrapper:"gap-4 overflow-visible h-12",item:"w-12 h-12 text-base cursor-pointer",cursor:"w-12 h-12 text-base cursor-pointer",prev:"w-12 h-12 text-base cursor-pointer",next:"w-12 h-12 text-base cursor-pointer",ellipsis:"w-12 h-12 text-base cursor-pointer"}})})]})})})]})}function i1e(){const t=bc(),{userInfo:e,isStudent:n,canViewAllStudentData:r}=lp(),[i,a]=H.useState("public"),o=H.useRef(null),s=()=>{n&&(a("student"),o.current&&o.current.refresh())},l=c=>{t(i==="public"?`/original/${c}`:`/detail/${c}`)};return j.jsx("div",{className:"min-h-screen bg-gray-50",children:j.jsx("div",{className:"max-w-7xl mx-auto p-6 pt-3",children:j.jsxs(ome,{selectedKey:i,onSelectionChange:c=>a(c),variant:"underlined",classNames:{tabList:"gap-6 w-full relative rounded-none p-0 border-b border-divider",cursor:"w-full bg-primary-500",tab:"max-w-fit px-0 h-12"},children:[j.jsx(vT,{title:"公共数据",children:j.jsx(n1e,{onFileClick:l,onCopySuccess:s})},"public"),n&&j.jsx(vT,{title:"我的数据",children:j.jsx(AW,{ref:o,userId:e?.user_id?.toString()||"",onFileClick:l})},"student"),r&&j.jsx(vT,{title:"所有学生数据",children:j.jsx(r1e,{onFileClick:l})},"allStudent")]})})})}var vt;(function(t){t.ERROR_EVENT="CORNERSTONE_ERROR",t.CACHE_SIZE_EXCEEDED="CACHE_SIZE_EXCEEDED",t.IMAGE_LOAD_ERROR="IMAGE_LOAD_ERROR",t.CAMERA_MODIFIED="CORNERSTONE_CAMERA_MODIFIED",t.CAMERA_RESET="CORNERSTONE_CAMERA_RESET",t.VOI_MODIFIED="CORNERSTONE_VOI_MODIFIED",t.PRESET_MODIFIED="CORNERSTONE_VIEWPORT_RENDERING_PRESET_MODIFIED",t.DISPLAY_AREA_MODIFIED="CORNERSTONE_DISPLAY_AREA_MODIFIED",t.ELEMENT_DISABLED="CORNERSTONE_ELEMENT_DISABLED",t.ELEMENT_ENABLED="CORNERSTONE_ELEMENT_ENABLED",t.IMAGE_RENDERED="CORNERSTONE_IMAGE_RENDERED",t.IMAGE_VOLUME_MODIFIED="CORNERSTONE_IMAGE_VOLUME_MODIFIED",t.IMAGE_VOLUME_LOADING_COMPLETED="CORNERSTONE_IMAGE_VOLUME_LOADING_COMPLETED",t.IMAGE_LOADED="CORNERSTONE_IMAGE_LOADED",t.IMAGE_RETRIEVAL_STAGE="CORNERSTONE_IMAGE_RETRIEVAL_STAGE",t.IMAGE_LOAD_FAILED="CORNERSTONE_IMAGE_LOAD_FAILED",t.VOLUME_VIEWPORT_NEW_VOLUME="CORNERSTONE_VOLUME_VIEWPORT_NEW_VOLUME",t.VOLUME_LOADED="CORNERSTONE_VOLUME_LOADED",t.VOLUME_LOADED_FAILED="CORNERSTONE_VOLUME_LOADED_FAILED",t.IMAGE_CACHE_IMAGE_ADDED="CORNERSTONE_IMAGE_CACHE_IMAGE_ADDED",t.IMAGE_CACHE_IMAGE_REMOVED="CORNERSTONE_IMAGE_CACHE_IMAGE_REMOVED",t.VOLUME_CACHE_VOLUME_ADDED="CORNERSTONE_VOLUME_CACHE_VOLUME_ADDED",t.VOLUME_CACHE_VOLUME_REMOVED="CORNERSTONE_VOLUME_CACHE_VOLUME_REMOVED",t.STACK_NEW_IMAGE="CORNERSTONE_STACK_NEW_IMAGE",t.VOLUME_NEW_IMAGE="CORNERSTONE_VOLUME_NEW_IMAGE",t.PRE_STACK_NEW_IMAGE="CORNERSTONE_PRE_STACK_NEW_IMAGE",t.IMAGE_SPACING_CALIBRATED="CORNERSTONE_IMAGE_SPACING_CALIBRATED",t.VIEWPORT_NEW_IMAGE_SET="CORNERSTONE_VIEWPORT_NEW_IMAGE_SET",t.STACK_VIEWPORT_SCROLL="CORNERSTONE_STACK_VIEWPORT_SCROLL",t.STACK_SCROLL_OUT_OF_BOUNDS="STACK_SCROLL_OUT_OF_BOUNDS",t.GEOMETRY_CACHE_GEOMETRY_ADDED="CORNERSTONE_GEOMETRY_CACHE_GEOMETRY_ADDED",t.GEOMETRY_CACHE_GEOMETRY_REMOVED="CORNERSTONE_GEOMETRY_CACHE_GEOMETRY_REMOVED",t.VOLUME_VIEWPORT_SCROLL_OUT_OF_BOUNDS="VOLUME_VIEWPORT_SCROLL_OUT_OF_BOUNDS",t.VOLUME_VIEWPORT_SCROLL="VOLUME_VIEWPORT_SCROLL",t.CLIPPING_PLANES_UPDATED="CORNERSTONE_CLIPPING_PLANES_UPDATED",t.WEB_WORKER_PROGRESS="CORNERSTONE_WEB_WORKER_PROGRESS",t.COLORMAP_MODIFIED="CORNERSTONE_COLORMAP_MODIFIED",t.DYNAMIC_VOLUME_DIMENSION_GROUP_CHANGED="DYNAMIC_VOLUME_DIMENSION_GROUP_CHANGED",t.DYNAMIC_VOLUME_TIME_POINT_INDEX_CHANGED="DYNAMIC_VOLUME_TIME_POINT_INDEX_CHANGED",t.DYNAMIC_VOLUME_DIMENSION_GROUP_LOADED="DYNAMIC_VOLUME_DIMENSION_GROUP_LOADED",t.DYNAMIC_VOLUME_TIME_POINT_LOADED="DYNAMIC_VOLUME_TIME_POINT_LOADED",t.GEOMETRY_LOADED="GEOMETRY_LOADED",t.GEOMETRY_LOAD_PROGRESS="GEOMETRY_LOAD_PROGRESS",t.GEOMETRY_LOADED_FAILED="GEOMETRY_LOADED_FAILED",t.ACTORS_CHANGED="CORNERSTONE_ACTORS_CHANGED"})(vt||(vt={}));var Dn;(function(t){t.Interaction="interaction",t.Thumbnail="thumbnail",t.Prefetch="prefetch",t.Compute="compute"})(Dn||(Dn={}));var br;(function(t){t.STACK="stack",t.ORTHOGRAPHIC="orthographic",t.PERSPECTIVE="perspective",t.VOLUME_3D="volume3d",t.VIDEO="video",t.WHOLE_SLIDE="wholeSlide"})(br||(br={}));var bf;(function(t){t[t.NEAREST=0]="NEAREST",t[t.LINEAR=1]="LINEAR",t[t.FAST_LINEAR=2]="FAST_LINEAR"})(bf||(bf={}));const Yx={COMPOSITE_BLEND:0,MAXIMUM_INTENSITY_BLEND:1,MINIMUM_INTENSITY_BLEND:2,AVERAGE_INTENSITY_BLEND:3,ADDITIVE_INTENSITY_BLEND:4,RADON_TRANSFORM_BLEND:5,LABELMAP_EDGE_PROJECTION_BLEND:6},a1e={OFF:0,NORMALIZED:1,RAW:2};var PW={BlendMode:Yx,FilterMode:a1e};const{BlendMode:W1}=PW;var t0;(function(t){t[t.COMPOSITE=W1.COMPOSITE_BLEND]="COMPOSITE",t[t.MAXIMUM_INTENSITY_BLEND=W1.MAXIMUM_INTENSITY_BLEND]="MAXIMUM_INTENSITY_BLEND",t[t.MINIMUM_INTENSITY_BLEND=W1.MINIMUM_INTENSITY_BLEND]="MINIMUM_INTENSITY_BLEND",t[t.AVERAGE_INTENSITY_BLEND=W1.AVERAGE_INTENSITY_BLEND]="AVERAGE_INTENSITY_BLEND",t[t.LABELMAP_EDGE_PROJECTION_BLEND=W1.LABELMAP_EDGE_PROJECTION_BLEND]="LABELMAP_EDGE_PROJECTION_BLEND"})(t0||(t0={}));var n0;(function(t){t.AXIAL="axial",t.CORONAL="coronal",t.SAGITTAL="sagittal",t.ACQUISITION="acquisition",t.AXIAL_REFORMAT="axial_reformat",t.CORONAL_REFORMAT="coronal_reformat",t.SAGITTAL_REFORMAT="sagittal_reformat",t.REFORMAT="reformat"})(n0||(n0={}));var ou;(function(t){t.CONTOUR="CONTOUR",t.SURFACE="SURFACE",t.MESH="MESH"})(ou||(ou={}));var ZE;(function(t){t.CLOSED_PLANAR="CLOSED_PLANAR",t.OPEN_PLANAR="OPEN_PLANAR"})(ZE||(ZE={}));const o1e=ZE;var qs;(function(t){t.PLY="PLY",t.STL="STL",t.OBJ="OBJ",t.VTP="VTP"})(qs||(qs={}));var oo;(function(t){t.LINEAR="LINEAR",t.SAMPLED_SIGMOID="SIGMOID",t.LINEAR_EXACT="LINEAR_EXACT"})(oo||(oo={}));var QE;(function(t){t.SUM="SUM",t.AVERAGE="AVERAGE",t.SUBTRACT="SUBTRACT"})(QE||(QE={}));const s1e=QE;var Kc;(function(t){t.NOT_APPLICABLE="",t.ERMF="ERMF",t.USER="User",t.PROJECTION="Proj",t.REGION="Region",t.ERROR="Error",t.UNCALIBRATED="Uncalibrated",t.CALIBRATED="Calibrated",t.UNKNOWN="Unknown"})(Kc||(Kc={}));var So;(function(t){t.NO_DATA="noData",t.LOADING="loading",t.PRE_RENDER="preRender",t.RESIZE="resize",t.RENDERED="rendered"})(So||(So={}));var Cs;(function(t){t[t.FAR_REPLICATE=1]="FAR_REPLICATE",t[t.ADJACENT_REPLICATE=3]="ADJACENT_REPLICATE",t[t.SUBRESOLUTION=6]="SUBRESOLUTION",t[t.LOSSY=7]="LOSSY",t[t.FULL_RESOLUTION=8]="FULL_RESOLUTION"})(Cs||(Cs={}));var h2;(function(t){t.FRAME="f",t.SECOND="s"})(h2||(h2={}));const l1e=Object.freeze(Object.defineProperty({__proto__:null,get SpeedUnit(){return h2}},Symbol.toStringTag,{value:"Module"}));var Yo;(function(t){t.CALIBRATION="calibrationModule",t.CINE="cineModule",t.GENERAL_IMAGE="generalImageModule",t.GENERAL_SERIES="generalSeriesModule",t.GENERAL_STUDY="generalStudyModule",t.IMAGE_PIXEL="imagePixelModule",t.IMAGE_PLANE="imagePlaneModule",t.IMAGE_URL="imageUrlModule",t.MODALITY_LUT="modalityLutModule",t.MULTIFRAME="multiframeModule",t.NM_MULTIFRAME_GEOMETRY="nmMultiframeGeometryModule",t.OVERLAY_PLANE="overlayPlaneModule",t.PATIENT="patientModule",t.PATIENT_STUDY="patientStudyModule",t.PET_IMAGE="petImageModule",t.PET_ISOTOPE="petIsotopeModule",t.PET_SERIES="petSeriesModule",t.SOP_COMMON="sopCommonModule",t.ULTRASOUND_ENHANCED_REGION="ultrasoundEnhancedRegionModule",t.VOI_LUT="voiLutModule",t.WADO_WEB_CLIENT="wadoWebClient"})(Yo||(Yo={}));var e6;(function(t){t.SUM="SUM",t.SUBTRACT="SUBTRACT",t.AVERAGE="AVERAGE"})(e6||(e6={}));var Jb;(function(t){t.RLE="RLE",t.Volume="Volume"})(Jb||(Jb={}));var Hh;(function(t){t.Tiled="tiled",t.ContextPool="contextPool"})(Hh||(Hh={}));const nl=Object.freeze(Object.defineProperty({__proto__:null,BlendModes:t0,CalibrationTypes:Kc,ContourType:o1e,DynamicOperatorType:s1e,Events:vt,get GenerateImageType(){return e6},GeometryType:ou,ImageQualityStatus:Cs,InterpolationType:bf,MeshType:qs,MetadataModules:Yo,OrientationAxis:n0,RenderingEngineModeEnum:Hh,RequestType:Dn,VOILUTFunctionType:oo,VideoEnums:l1e,ViewportStatus:So,ViewportType:br,VoxelManagerEnum:Jb},Symbol.toStringTag,{value:"Module"})),t6={hotIron:{name:"Hot Iron",numOfColors:256,colors:[[0,0,0,255],[2,0,0,255],[4,0,0,255],[6,0,0,255],[8,0,0,255],[10,0,0,255],[12,0,0,255],[14,0,0,255],[16,0,0,255],[18,0,0,255],[20,0,0,255],[22,0,0,255],[24,0,0,255],[26,0,0,255],[28,0,0,255],[30,0,0,255],[32,0,0,255],[34,0,0,255],[36,0,0,255],[38,0,0,255],[40,0,0,255],[42,0,0,255],[44,0,0,255],[46,0,0,255],[48,0,0,255],[50,0,0,255],[52,0,0,255],[54,0,0,255],[56,0,0,255],[58,0,0,255],[60,0,0,255],[62,0,0,255],[64,0,0,255],[66,0,0,255],[68,0,0,255],[70,0,0,255],[72,0,0,255],[74,0,0,255],[76,0,0,255],[78,0,0,255],[80,0,0,255],[82,0,0,255],[84,0,0,255],[86,0,0,255],[88,0,0,255],[90,0,0,255],[92,0,0,255],[94,0,0,255],[96,0,0,255],[98,0,0,255],[100,0,0,255],[102,0,0,255],[104,0,0,255],[106,0,0,255],[108,0,0,255],[110,0,0,255],[112,0,0,255],[114,0,0,255],[116,0,0,255],[118,0,0,255],[120,0,0,255],[122,0,0,255],[124,0,0,255],[126,0,0,255],[128,0,0,255],[130,0,0,255],[132,0,0,255],[134,0,0,255],[136,0,0,255],[138,0,0,255],[140,0,0,255],[142,0,0,255],[144,0,0,255],[146,0,0,255],[148,0,0,255],[150,0,0,255],[152,0,0,255],[154,0,0,255],[156,0,0,255],[158,0,0,255],[160,0,0,255],[162,0,0,255],[164,0,0,255],[166,0,0,255],[168,0,0,255],[170,0,0,255],[172,0,0,255],[174,0,0,255],[176,0,0,255],[178,0,0,255],[180,0,0,255],[182,0,0,255],[184,0,0,255],[186,0,0,255],[188,0,0,255],[190,0,0,255],[192,0,0,255],[194,0,0,255],[196,0,0,255],[198,0,0,255],[200,0,0,255],[202,0,0,255],[204,0,0,255],[206,0,0,255],[208,0,0,255],[210,0,0,255],[212,0,0,255],[214,0,0,255],[216,0,0,255],[218,0,0,255],[220,0,0,255],[222,0,0,255],[224,0,0,255],[226,0,0,255],[228,0,0,255],[230,0,0,255],[232,0,0,255],[234,0,0,255],[236,0,0,255],[238,0,0,255],[240,0,0,255],[242,0,0,255],[244,0,0,255],[246,0,0,255],[248,0,0,255],[250,0,0,255],[252,0,0,255],[254,0,0,255],[255,0,0,255],[255,2,0,255],[255,4,0,255],[255,6,0,255],[255,8,0,255],[255,10,0,255],[255,12,0,255],[255,14,0,255],[255,16,0,255],[255,18,0,255],[255,20,0,255],[255,22,0,255],[255,24,0,255],[255,26,0,255],[255,28,0,255],[255,30,0,255],[255,32,0,255],[255,34,0,255],[255,36,0,255],[255,38,0,255],[255,40,0,255],[255,42,0,255],[255,44,0,255],[255,46,0,255],[255,48,0,255],[255,50,0,255],[255,52,0,255],[255,54,0,255],[255,56,0,255],[255,58,0,255],[255,60,0,255],[255,62,0,255],[255,64,0,255],[255,66,0,255],[255,68,0,255],[255,70,0,255],[255,72,0,255],[255,74,0,255],[255,76,0,255],[255,78,0,255],[255,80,0,255],[255,82,0,255],[255,84,0,255],[255,86,0,255],[255,88,0,255],[255,90,0,255],[255,92,0,255],[255,94,0,255],[255,96,0,255],[255,98,0,255],[255,100,0,255],[255,102,0,255],[255,104,0,255],[255,106,0,255],[255,108,0,255],[255,110,0,255],[255,112,0,255],[255,114,0,255],[255,116,0,255],[255,118,0,255],[255,120,0,255],[255,122,0,255],[255,124,0,255],[255,126,0,255],[255,128,4,255],[255,130,8,255],[255,132,12,255],[255,134,16,255],[255,136,20,255],[255,138,24,255],[255,140,28,255],[255,142,32,255],[255,144,36,255],[255,146,40,255],[255,148,44,255],[255,150,48,255],[255,152,52,255],[255,154,56,255],[255,156,60,255],[255,158,64,255],[255,160,68,255],[255,162,72,255],[255,164,76,255],[255,166,80,255],[255,168,84,255],[255,170,88,255],[255,172,92,255],[255,174,96,255],[255,176,100,255],[255,178,104,255],[255,180,108,255],[255,182,112,255],[255,184,116,255],[255,186,120,255],[255,188,124,255],[255,190,128,255],[255,192,132,255],[255,194,136,255],[255,196,140,255],[255,198,144,255],[255,200,148,255],[255,202,152,255],[255,204,156,255],[255,206,160,255],[255,208,164,255],[255,210,168,255],[255,212,172,255],[255,214,176,255],[255,216,180,255],[255,218,184,255],[255,220,188,255],[255,222,192,255],[255,224,196,255],[255,226,200,255],[255,228,204,255],[255,230,208,255],[255,232,212,255],[255,234,216,255],[255,236,220,255],[255,238,224,255],[255,240,228,255],[255,242,232,255],[255,244,236,255],[255,246,240,255],[255,248,244,255],[255,250,248,255],[255,252,252,255],[255,255,255,255]]},pet:{name:"PET",numColors:256,colors:[[0,0,0,255],[0,2,1,255],[0,4,3,255],[0,6,5,255],[0,8,7,255],[0,10,9,255],[0,12,11,255],[0,14,13,255],[0,16,15,255],[0,18,17,255],[0,20,19,255],[0,22,21,255],[0,24,23,255],[0,26,25,255],[0,28,27,255],[0,30,29,255],[0,32,31,255],[0,34,33,255],[0,36,35,255],[0,38,37,255],[0,40,39,255],[0,42,41,255],[0,44,43,255],[0,46,45,255],[0,48,47,255],[0,50,49,255],[0,52,51,255],[0,54,53,255],[0,56,55,255],[0,58,57,255],[0,60,59,255],[0,62,61,255],[0,65,63,255],[0,67,65,255],[0,69,67,255],[0,71,69,255],[0,73,71,255],[0,75,73,255],[0,77,75,255],[0,79,77,255],[0,81,79,255],[0,83,81,255],[0,85,83,255],[0,87,85,255],[0,89,87,255],[0,91,89,255],[0,93,91,255],[0,95,93,255],[0,97,95,255],[0,99,97,255],[0,101,99,255],[0,103,101,255],[0,105,103,255],[0,107,105,255],[0,109,107,255],[0,111,109,255],[0,113,111,255],[0,115,113,255],[0,117,115,255],[0,119,117,255],[0,121,119,255],[0,123,121,255],[0,125,123,255],[0,128,125,255],[1,126,127,255],[3,124,129,255],[5,122,131,255],[7,120,133,255],[9,118,135,255],[11,116,137,255],[13,114,139,255],[15,112,141,255],[17,110,143,255],[19,108,145,255],[21,106,147,255],[23,104,149,255],[25,102,151,255],[27,100,153,255],[29,98,155,255],[31,96,157,255],[33,94,159,255],[35,92,161,255],[37,90,163,255],[39,88,165,255],[41,86,167,255],[43,84,169,255],[45,82,171,255],[47,80,173,255],[49,78,175,255],[51,76,177,255],[53,74,179,255],[55,72,181,255],[57,70,183,255],[59,68,185,255],[61,66,187,255],[63,64,189,255],[65,63,191,255],[67,61,193,255],[69,59,195,255],[71,57,197,255],[73,55,199,255],[75,53,201,255],[77,51,203,255],[79,49,205,255],[81,47,207,255],[83,45,209,255],[85,43,211,255],[86,41,213,255],[88,39,215,255],[90,37,217,255],[92,35,219,255],[94,33,221,255],[96,31,223,255],[98,29,225,255],[100,27,227,255],[102,25,229,255],[104,23,231,255],[106,21,233,255],[108,19,235,255],[110,17,237,255],[112,15,239,255],[114,13,241,255],[116,11,243,255],[118,9,245,255],[120,7,247,255],[122,5,249,255],[124,3,251,255],[126,1,253,255],[128,0,255,255],[130,2,252,255],[132,4,248,255],[134,6,244,255],[136,8,240,255],[138,10,236,255],[140,12,232,255],[142,14,228,255],[144,16,224,255],[146,18,220,255],[148,20,216,255],[150,22,212,255],[152,24,208,255],[154,26,204,255],[156,28,200,255],[158,30,196,255],[160,32,192,255],[162,34,188,255],[164,36,184,255],[166,38,180,255],[168,40,176,255],[170,42,172,255],[171,44,168,255],[173,46,164,255],[175,48,160,255],[177,50,156,255],[179,52,152,255],[181,54,148,255],[183,56,144,255],[185,58,140,255],[187,60,136,255],[189,62,132,255],[191,64,128,255],[193,66,124,255],[195,68,120,255],[197,70,116,255],[199,72,112,255],[201,74,108,255],[203,76,104,255],[205,78,100,255],[207,80,96,255],[209,82,92,255],[211,84,88,255],[213,86,84,255],[215,88,80,255],[217,90,76,255],[219,92,72,255],[221,94,68,255],[223,96,64,255],[225,98,60,255],[227,100,56,255],[229,102,52,255],[231,104,48,255],[233,106,44,255],[235,108,40,255],[237,110,36,255],[239,112,32,255],[241,114,28,255],[243,116,24,255],[245,118,20,255],[247,120,16,255],[249,122,12,255],[251,124,8,255],[253,126,4,255],[255,128,0,255],[255,130,4,255],[255,132,8,255],[255,134,12,255],[255,136,16,255],[255,138,20,255],[255,140,24,255],[255,142,28,255],[255,144,32,255],[255,146,36,255],[255,148,40,255],[255,150,44,255],[255,152,48,255],[255,154,52,255],[255,156,56,255],[255,158,60,255],[255,160,64,255],[255,162,68,255],[255,164,72,255],[255,166,76,255],[255,168,80,255],[255,170,85,255],[255,172,89,255],[255,174,93,255],[255,176,97,255],[255,178,101,255],[255,180,105,255],[255,182,109,255],[255,184,113,255],[255,186,117,255],[255,188,121,255],[255,190,125,255],[255,192,129,255],[255,194,133,255],[255,196,137,255],[255,198,141,255],[255,200,145,255],[255,202,149,255],[255,204,153,255],[255,206,157,255],[255,208,161,255],[255,210,165,255],[255,212,170,255],[255,214,174,255],[255,216,178,255],[255,218,182,255],[255,220,186,255],[255,222,190,255],[255,224,194,255],[255,226,198,255],[255,228,202,255],[255,230,206,255],[255,232,210,255],[255,234,214,255],[255,236,218,255],[255,238,222,255],[255,240,226,255],[255,242,230,255],[255,244,234,255],[255,246,238,255],[255,248,242,255],[255,250,246,255],[255,252,250,255],[255,255,255,255]]},hotMetalBlue:{name:"Hot Metal Blue",numColors:256,colors:[[0,0,0,255],[0,0,2,255],[0,0,4,255],[0,0,6,255],[0,0,8,255],[0,0,10,255],[0,0,12,255],[0,0,14,255],[0,0,16,255],[0,0,17,255],[0,0,19,255],[0,0,21,255],[0,0,23,255],[0,0,25,255],[0,0,27,255],[0,0,29,255],[0,0,31,255],[0,0,33,255],[0,0,35,255],[0,0,37,255],[0,0,39,255],[0,0,41,255],[0,0,43,255],[0,0,45,255],[0,0,47,255],[0,0,49,255],[0,0,51,255],[0,0,53,255],[0,0,55,255],[0,0,57,255],[0,0,59,255],[0,0,61,255],[0,0,63,255],[0,0,65,255],[0,0,67,255],[0,0,69,255],[0,0,71,255],[0,0,73,255],[0,0,75,255],[0,0,77,255],[0,0,79,255],[0,0,81,255],[0,0,83,255],[0,0,84,255],[0,0,86,255],[0,0,88,255],[0,0,90,255],[0,0,92,255],[0,0,94,255],[0,0,96,255],[0,0,98,255],[0,0,100,255],[0,0,102,255],[0,0,104,255],[0,0,106,255],[0,0,108,255],[0,0,110,255],[0,0,112,255],[0,0,114,255],[0,0,116,255],[0,0,117,255],[0,0,119,255],[0,0,121,255],[0,0,123,255],[0,0,125,255],[0,0,127,255],[0,0,129,255],[0,0,131,255],[0,0,133,255],[0,0,135,255],[0,0,137,255],[0,0,139,255],[0,0,141,255],[0,0,143,255],[0,0,145,255],[0,0,147,255],[0,0,149,255],[0,0,151,255],[0,0,153,255],[0,0,155,255],[0,0,157,255],[0,0,159,255],[0,0,161,255],[0,0,163,255],[0,0,165,255],[0,0,167,255],[3,0,169,255],[6,0,171,255],[9,0,173,255],[12,0,175,255],[15,0,177,255],[18,0,179,255],[21,0,181,255],[24,0,183,255],[26,0,184,255],[29,0,186,255],[32,0,188,255],[35,0,190,255],[38,0,192,255],[41,0,194,255],[44,0,196,255],[47,0,198,255],[50,0,200,255],[52,0,197,255],[55,0,194,255],[57,0,191,255],[59,0,188,255],[62,0,185,255],[64,0,182,255],[66,0,179,255],[69,0,176,255],[71,0,174,255],[74,0,171,255],[76,0,168,255],[78,0,165,255],[81,0,162,255],[83,0,159,255],[85,0,156,255],[88,0,153,255],[90,0,150,255],[93,2,144,255],[96,4,138,255],[99,6,132,255],[102,8,126,255],[105,9,121,255],[108,11,115,255],[111,13,109,255],[114,15,103,255],[116,17,97,255],[119,19,91,255],[122,21,85,255],[125,23,79,255],[128,24,74,255],[131,26,68,255],[134,28,62,255],[137,30,56,255],[140,32,50,255],[143,34,47,255],[146,36,44,255],[149,38,41,255],[152,40,38,255],[155,41,35,255],[158,43,32,255],[161,45,29,255],[164,47,26,255],[166,49,24,255],[169,51,21,255],[172,53,18,255],[175,55,15,255],[178,56,12,255],[181,58,9,255],[184,60,6,255],[187,62,3,255],[190,64,0,255],[194,66,0,255],[198,68,0,255],[201,70,0,255],[205,72,0,255],[209,73,0,255],[213,75,0,255],[217,77,0,255],[221,79,0,255],[224,81,0,255],[228,83,0,255],[232,85,0,255],[236,87,0,255],[240,88,0,255],[244,90,0,255],[247,92,0,255],[251,94,0,255],[255,96,0,255],[255,98,3,255],[255,100,6,255],[255,102,9,255],[255,104,12,255],[255,105,15,255],[255,107,18,255],[255,109,21,255],[255,111,24,255],[255,113,26,255],[255,115,29,255],[255,117,32,255],[255,119,35,255],[255,120,38,255],[255,122,41,255],[255,124,44,255],[255,126,47,255],[255,128,50,255],[255,130,53,255],[255,132,56,255],[255,134,59,255],[255,136,62,255],[255,137,65,255],[255,139,68,255],[255,141,71,255],[255,143,74,255],[255,145,76,255],[255,147,79,255],[255,149,82,255],[255,151,85,255],[255,152,88,255],[255,154,91,255],[255,156,94,255],[255,158,97,255],[255,160,100,255],[255,162,103,255],[255,164,106,255],[255,166,109,255],[255,168,112,255],[255,169,115,255],[255,171,118,255],[255,173,121,255],[255,175,124,255],[255,177,126,255],[255,179,129,255],[255,181,132,255],[255,183,135,255],[255,184,138,255],[255,186,141,255],[255,188,144,255],[255,190,147,255],[255,192,150,255],[255,194,153,255],[255,196,156,255],[255,198,159,255],[255,200,162,255],[255,201,165,255],[255,203,168,255],[255,205,171,255],[255,207,174,255],[255,209,176,255],[255,211,179,255],[255,213,182,255],[255,215,185,255],[255,216,188,255],[255,218,191,255],[255,220,194,255],[255,222,197,255],[255,224,200,255],[255,226,203,255],[255,228,206,255],[255,229,210,255],[255,231,213,255],[255,233,216,255],[255,235,219,255],[255,237,223,255],[255,239,226,255],[255,240,229,255],[255,242,232,255],[255,244,236,255],[255,246,239,255],[255,248,242,255],[255,250,245,255],[255,251,249,255],[255,253,252,255],[255,255,255,255]]},pet20Step:{name:"PET 20 Step",numColors:256,colors:[[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255]]},gray:{name:"Gray",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[1,1,1]],green:[[0,0,0],[1,1,1]],blue:[[0,0,0],[1,1,1]]}},jet:{name:"Jet",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[.35,0,0],[.66,1,1],[.89,1,1],[1,.5,.5]],green:[[0,0,0],[.125,0,0],[.375,1,1],[.64,1,1],[.91,0,0],[1,0,0]],blue:[[0,.5,.5],[.11,1,1],[.34,1,1],[.65,0,0],[1,0,0]]}},hsv:{name:"HSV",numColors:256,gamma:1,segmentedData:{red:[[0,1,1],[.15873,1,1],[.174603,.96875,.96875],[.333333,.03125,.03125],[.349206,0,0],[.666667,0,0],[.68254,.03125,.03125],[.84127,.96875,.96875],[.857143,1,1],[1,1,1]],green:[[0,0,0],[.15873,.9375,.9375],[.174603,1,1],[.507937,1,1],[.666667,.0625,.0625],[.68254,0,0],[1,0,0]],blue:[[0,0,0],[.333333,0,0],[.349206,.0625,.0625],[.507937,1,1],[.84127,1,1],[.857143,.9375,.9375],[1,.09375,.09375]]}},hot:{name:"Hot",numColors:256,gamma:1,segmentedData:{red:[[0,.0416,.0416],[.365079,1,1],[1,1,1]],green:[[0,0,0],[.365079,0,0],[.746032,1,1],[1,1,1]],blue:[[0,0,0],[.746032,0,0],[1,1,1]]}},cool:{name:"Cool",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[1,1,1]],green:[[0,1,1],[1,0,0]],blue:[[0,1,1],[1,1,1]]}},spring:{name:"Spring",numColors:256,gamma:1,segmentedData:{red:[[0,1,1],[1,1,1]],green:[[0,0,0],[1,1,1]],blue:[[0,1,1],[1,0,0]]}},summer:{name:"Summer",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[1,1,1]],green:[[0,.5,.5],[1,1,1]],blue:[[0,.4,.4],[1,.4,.4]]}},autumn:{name:"Autumn",numColors:256,gamma:1,segmentedData:{red:[[0,1,1],[1,1,1]],green:[[0,0,0],[1,1,1]],blue:[[0,0,0],[1,0,0]]}},winter:{name:"Winter",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[1,0,0]],green:[[0,0,0],[1,1,1]],blue:[[0,1,1],[1,.5,.5]]}},bone:{name:"Bone",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[.746032,.652778,.652778],[1,1,1]],green:[[0,0,0],[.365079,.319444,.319444],[.746032,.777778,.777778],[1,1,1]],blue:[[0,0,0],[.365079,.444444,.444444],[1,1,1]]}},copper:{name:"Copper",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[.809524,1,1],[1,1,1]],green:[[0,0,0],[1,.7812,.7812]],blue:[[0,0,0],[1,.4975,.4975]]}},spectral:{name:"Spectral",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[.05,.4667,.4667],[.1,.5333,.5333],[.15,0,0],[.2,0,0],[.25,0,0],[.3,0,0],[.35,0,0],[.4,0,0],[.45,0,0],[.5,0,0],[.55,0,0],[.6,0,0],[.65,.7333,.7333],[.7,.9333,.9333],[.75,1,1],[.8,1,1],[.85,1,1],[.9,.8667,.8667],[.95,.8,.8],[1,.8,.8]],green:[[0,0,0],[.05,0,0],[.1,0,0],[.15,0,0],[.2,0,0],[.25,.4667,.4667],[.3,.6,.6],[.35,.6667,.6667],[.4,.6667,.6667],[.45,.6,.6],[.5,.7333,.7333],[.55,.8667,.8667],[.6,1,1],[.65,1,1],[.7,.9333,.9333],[.75,.8,.8],[.8,.6,.6],[.85,0,0],[.9,0,0],[.95,0,0],[1,.8,.8]],blue:[[0,0,0],[.05,.5333,.5333],[.1,.6,.6],[.15,.6667,.6667],[.2,.8667,.8667],[.25,.8667,.8667],[.3,.8667,.8667],[.35,.6667,.6667],[.4,.5333,.5333],[.45,0,0],[.5,0,0],[.55,0,0],[.6,0,0],[.65,0,0],[.7,0,0],[.75,0,0],[.8,0,0],[.85,0,0],[.9,0,0],[.95,0,0],[1,.8,.8]]}},coolwarm:{name:"CoolWarm",numColors:256,gamma:1,segmentedData:{red:[[0,.2298057,.2298057],[.03125,.26623388,.26623388],[.0625,.30386891,.30386891],[.09375,.342804478,.342804478],[.125,.38301334,.38301334],[.15625,.424369608,.424369608],[.1875,.46666708,.46666708],[.21875,.509635204,.509635204],[.25,.552953156,.552953156],[.28125,.596262162,.596262162],[.3125,.639176211,.639176211],[.34375,.681291281,.681291281],[.375,.722193294,.722193294],[.40625,.761464949,.761464949],[.4375,.798691636,.798691636],[.46875,.833466556,.833466556],[.5,.865395197,.865395197],[.53125,.897787179,.897787179],[.5625,.924127593,.924127593],[.59375,.944468518,.944468518],[.625,.958852946,.958852946],[.65625,.96732803,.96732803],[.6875,.969954137,.969954137],[.71875,.966811177,.966811177],[.75,.958003065,.958003065],[.78125,.943660866,.943660866],[.8125,.923944917,.923944917],[.84375,.89904617,.89904617],[.875,.869186849,.869186849],[.90625,.834620542,.834620542],[.9375,.795631745,.795631745],[.96875,.752534934,.752534934],[1,.705673158,.705673158]],green:[[0,.298717966,.298717966],[.03125,.353094838,.353094838],[.0625,.406535296,.406535296],[.09375,.458757618,.458757618],[.125,.50941904,.50941904],[.15625,.558148092,.558148092],[.1875,.604562568,.604562568],[.21875,.648280772,.648280772],[.25,.688929332,.688929332],[.28125,.726149107,.726149107],[.3125,.759599947,.759599947],[.34375,.788964712,.788964712],[.375,.813952739,.813952739],[.40625,.834302879,.834302879],[.4375,.849786142,.849786142],[.46875,.860207984,.860207984],[.5,.86541021,.86541021],[.53125,.848937047,.848937047],[.5625,.827384882,.827384882],[.59375,.800927443,.800927443],[.625,.769767752,.769767752],[.65625,.734132809,.734132809],[.6875,.694266682,.694266682],[.71875,.650421156,.650421156],[.75,.602842431,.602842431],[.78125,.551750968,.551750968],[.8125,.49730856,.49730856],[.84375,.439559467,.439559467],[.875,.378313092,.378313092],[.90625,.312874446,.312874446],[.9375,.24128379,.24128379],[.96875,.157246067,.157246067],[1,.01555616,.01555616]],blue:[[0,.753683153,.753683153],[.03125,.801466763,.801466763],[.0625,.84495867,.84495867],[.09375,.883725899,.883725899],[.125,.917387822,.917387822],[.15625,.945619588,.945619588],[.1875,.968154911,.968154911],[.21875,.98478814,.98478814],[.25,.995375608,.995375608],[.28125,.999836203,.999836203],[.3125,.998151185,.998151185],[.34375,.990363227,.990363227],[.375,.976574709,.976574709],[.40625,.956945269,.956945269],[.4375,.931688648,.931688648],[.46875,.901068838,.901068838],[.5,.865395561,.865395561],[.53125,.820880546,.820880546],[.5625,.774508472,.774508472],[.59375,.726736146,.726736146],[.625,.678007945,.678007945],[.65625,.628751763,.628751763],[.6875,.579375448,.579375448],[.71875,.530263762,.530263762],[.75,.481775914,.481775914],[.78125,.434243684,.434243684],[.8125,.387970225,.387970225],[.84375,.343229596,.343229596],[.875,.300267182,.300267182],[.90625,.259301199,.259301199],[.9375,.220525627,.220525627],[.96875,.184115123,.184115123],[1,.150232812,.150232812]]}},blues:{name:"Blues",numColors:256,gamma:1,segmentedData:{red:[[0,.9686274528503418,.9686274528503418],[.125,.8705882430076599,.8705882430076599],[.25,.7764706015586853,.7764706015586853],[.375,.6196078658103943,.6196078658103943],[.5,.41960784792900085,.41960784792900085],[.625,.25882354378700256,.25882354378700256],[.75,.12941177189350128,.12941177189350128],[.875,.0313725508749485,.0313725508749485],[1,.0313725508749485,.0313725508749485]],green:[[0,.9843137264251709,.9843137264251709],[.125,.9215686321258545,.9215686321258545],[.25,.8588235378265381,.8588235378265381],[.375,.7921568751335144,.7921568751335144],[.5,.6823529601097107,.6823529601097107],[.625,.572549045085907,.572549045085907],[.75,.4431372582912445,.4431372582912445],[.875,.3176470696926117,.3176470696926117],[1,.1882352977991104,.1882352977991104]],blue:[[0,1,1],[.125,.9686274528503418,.9686274528503418],[.25,.9372549057006836,.9372549057006836],[.375,.8823529481887817,.8823529481887817],[.5,.8392156958580017,.8392156958580017],[.625,.7764706015586853,.7764706015586853],[.75,.7098039388656616,.7098039388656616],[.875,.6117647290229797,.6117647290229797],[1,.41960784792900085,.41960784792900085]]}}},Ci={MINIMUM_SLAB_THICKNESS:.05,MAXIMUM_RAY_DISTANCE:1e6};Object.freeze(Ci);const Qs=.001;function NW(t){const e=Object.getOwnPropertyNames(t);for(const n of e){const r=t[n];r&&typeof r=="object"&&NW(r)}return Object.freeze(t)}const c1e={axial:{viewPlaneNormal:[0,0,-1],viewUp:[0,-1,0],viewRight:[1,0,0]},sagittal:{viewPlaneNormal:[1,0,0],viewUp:[0,0,1],viewRight:[0,1,0]},coronal:{viewPlaneNormal:[0,-1,0],viewUp:[0,0,1],viewRight:[1,0,0]}},wf=NW(c1e),LW=[{name:"CT-AAA",gradientOpacity:"4 0 1 255 1",specularPower:"10",scalarOpacity:"12 -3024 0 143.556 0 166.222 0.686275 214.389 0.696078 419.736 0.833333 3071 0.803922",specular:"0.2",shade:"1",ambient:"0.1",colorTransfer:"24 -3024 0 0 0 143.556 0.615686 0.356863 0.184314 166.222 0.882353 0.603922 0.290196 214.389 1 1 1 419.736 1 0.937033 0.954531 3071 0.827451 0.658824 1",diffuse:"0.9",interpolation:"1"},{name:"CT-AAA2",gradientOpacity:"4 0 1 255 1",specularPower:"10",scalarOpacity:"16 -3024 0 129.542 0 145.244 0.166667 157.02 0.5 169.918 0.627451 395.575 0.8125 1578.73 0.8125 3071 0.8125",specular:"0.2",shade:"1",ambient:"0.1",colorTransfer:"32 -3024 0 0 0 129.542 0.54902 0.25098 0.14902 145.244 0.6 0.627451 0.843137 157.02 0.890196 0.47451 0.6 169.918 0.992157 0.870588 0.392157 395.575 1 0.886275 0.658824 1578.73 1 0.829256 0.957922 3071 0.827451 0.658824 1",diffuse:"0.9",interpolation:"1"},{name:"CT-Bone",gradientOpacity:"4 0 1 255 1",specularPower:"10",scalarOpacity:"8 -3024 0 -16.4458 0 641.385 0.715686 3071 0.705882",specular:"0.2",shade:"1",ambient:"0.1",colorTransfer:"16 -3024 0 0 0 -16.4458 0.729412 0.254902 0.301961 641.385 0.905882 0.815686 0.552941 3071 1 1 1",diffuse:"0.9",interpolation:"1"},{name:"CT-Bones",gradientOpacity:"4 0 1 985.12 1",specularPower:"1",scalarOpacity:"8 -1000 0 152.19 0 278.93 0.190476 952 0.2",specular:"0",shade:"1",ambient:"0.2",colorTransfer:"20 -1000 0.3 0.3 1 -488 0.3 1 0.3 463.28 1 0 0 659.15 1 0.912535 0.0374849 953 1 0.3 0.3",diffuse:"1",interpolation:"1"},{name:"CT-Cardiac",gradientOpacity:"4 0 1 255 1",specularPower:"10",scalarOpacity:"12 -3024 0 -77.6875 0 94.9518 0.285714 179.052 0.553571 260.439 0.848214 3071 0.875",specular:"0.2",shade:"1",ambient:"0.1",colorTransfer:"24 -3024 0 0 0 -77.6875 0.54902 0.25098 0.14902 94.9518 0.882353 0.603922 0.290196 179.052 1 0.937033 0.954531 260.439 0.615686 0 0 3071 0.827451 0.658824 1",diffuse:"0.9",interpolation:"1"},{name:"CT-Cardiac2",gradientOpacity:"4 0 1 255 1",specularPower:"10",scalarOpacity:"12 -3024 0 42.8964 0 163.488 0.428571 277.642 0.776786 1587 0.754902 3071 0.754902",specular:"0.2",shade:"1",ambient:"0.1",colorTransfer:"24 -3024 0 0 0 42.8964 0.54902 0.25098 0.14902 163.488 0.917647 0.639216 0.0588235 277.642 1 0.878431 0.623529 1587 1 1 1 3071 0.827451 0.658824 1",diffuse:"0.9",interpolation:"1"},{name:"CT-Cardiac3",gradientOpacity:"4 0 1 255 1",specularPower:"10",scalarOpacity:"14 -3024 0 -86.9767 0 45.3791 0.169643 139.919 0.589286 347.907 0.607143 1224.16 0.607143 3071 0.616071",specular:"0.2",shade:"1",ambient:"0.1",colorTransfer:"28 -3024 0 0 0 -86.9767 0 0.25098 1 45.3791 1 0 0 139.919 1 0.894893 0.894893 347.907 1 1 0.25098 1224.16 1 1 1 3071 0.827451 0.658824 1",diffuse:"0.9",interpolation:"1"},{name:"CT-Chest-Contrast-Enhanced",gradientOpacity:"4 0 1 255 1",specularPower:"10",scalarOpacity:"10 -3024 0 67.0106 0 251.105 0.446429 439.291 0.625 3071 0.616071",specular:"0.2",shade:"1",ambient:"0.1",colorTransfer:"20 -3024 0 0 0 67.0106 0.54902 0.25098 0.14902 251.105 0.882353 0.603922 0.290196 439.291 1 0.937033 0.954531 3071 0.827451 0.658824 1",diffuse:"0.9",interpolation:"1"},{name:"CT-Chest-Vessels",gradientOpacity:"4 0 1 255 1",specularPower:"1",scalarOpacity:"10 -3024 0 -1278.35 0 22.8277 0.428571 439.291 0.625 3071 0.616071",specular:"0",shade:"1",ambient:"0.2",colorTransfer:"20 -3024 0 0 0 -1278.35 0.54902 0.25098 0.14902 22.8277 0.882353 0.603922 0.290196 439.291 1 0.937033 0.954531 3071 0.827451 0.658824 1",diffuse:"1",interpolation:"1"},{name:"CT-Coronary-Arteries",gradientOpacity:"4 0 1 255 1",specularPower:"1",scalarOpacity:"12 -2048 0 136.47 0 159.215 0.258929 318.43 0.571429 478.693 0.776786 3661 1",specular:"0",shade:"0",ambient:"0.2",colorTransfer:"24 -2048 0 0 0 136.47 0 0 0 159.215 0.159804 0.159804 0.159804 318.43 0.764706 0.764706 0.764706 478.693 1 1 1 3661 1 1 1",diffuse:"1",interpolation:"1"},{name:"CT-Coronary-Arteries-2",gradientOpacity:"4 0 1 255 1",specularPower:"1",scalarOpacity:"14 -2048 0 142.677 0 145.016 0.116071 192.174 0.5625 217.24 0.776786 384.347 0.830357 3661 0.830357",specular:"0",shade:"1",ambient:"0.2",colorTransfer:"28 -2048 0 0 0 142.677 0 0 0 145.016 0.615686 0 0.0156863 192.174 0.909804 0.454902 0 217.24 0.972549 0.807843 0.611765 384.347 0.909804 0.909804 1 3661 1 1 1",diffuse:"1",interpolation:"1"},{name:"CT-Coronary-Arteries-3",gradientOpacity:"4 0 1 255 1",specularPower:"10",scalarOpacity:"14 -2048 0 128.643 0 129.982 0.0982143 173.636 0.669643 255.884 0.857143 584.878 0.866071 3661 1",specular:"0.2",shade:"1",ambient:"0.1",colorTransfer:"28 -2048 0 0 0 128.643 0 0 0 129.982 0.615686 0 0.0156863 173.636 0.909804 0.454902 0 255.884 0.886275 0.886275 0.886275 584.878 0.968627 0.968627 0.968627 3661 1 1 1",diffuse:"0.9",interpolation:"1"},{name:"CT-Cropped-Volume-Bone",gradientOpacity:"4 0 1 255 1",specularPower:"1",scalarOpacity:"10 -2048 0 -451 0 -450 1 1050 1 3661 1",specular:"0",shade:"0",ambient:"0.2",colorTransfer:"20 -2048 0 0 0 -451 0 0 0 -450 0.0556356 0.0556356 0.0556356 1050 1 1 1 3661 1 1 1",diffuse:"1",interpolation:"1"},{name:"CT-Fat",gradientOpacity:"6 0 1 985.12 1 988 1",specularPower:"1",scalarOpacity:"14 -1000 0 -100 0 -99 0.15 -60 0.15 -59 0 101.2 0 952 0",specular:"0",shade:"0",ambient:"0.2",colorTransfer:"36 -1000 0.3 0.3 1 -497.5 0.3 1 0.3 -99 0 0 1 -76.946 0 1 0 -65.481 0.835431 0.888889 0.0165387 83.89 1 0 0 463.28 1 0 0 659.15 1 0.912535 0.0374849 2952 1 0.300267 0.299886",diffuse:"1",interpolation:"1"},{name:"CT-Liver-Vasculature",gradientOpacity:"4 0 1 255 1",specularPower:"1",scalarOpacity:"14 -2048 0 149.113 0 157.884 0.482143 339.96 0.660714 388.526 0.830357 1197.95 0.839286 3661 0.848214",specular:"0",shade:"0",ambient:"0.2",colorTransfer:"28 -2048 0 0 0 149.113 0 0 0 157.884 0.501961 0.25098 0 339.96 0.695386 0.59603 0.36886 388.526 0.854902 0.85098 0.827451 1197.95 1 1 1 3661 1 1 1",diffuse:"1",interpolation:"1"},{name:"CT-Lung",gradientOpacity:"6 0 1 985.12 1 988 1",specularPower:"1",scalarOpacity:"12 -1000 0 -600 0 -599 0.15 -400 0.15 -399 0 2952 0",specular:"0",shade:"1",ambient:"0.2",colorTransfer:"24 -1000 0.3 0.3 1 -600 0 0 1 -530 0.134704 0.781726 0.0724558 -460 0.929244 1 0.109473 -400 0.888889 0.254949 0.0240258 2952 1 0.3 0.3",diffuse:"1",interpolation:"1"},{name:"CT-MIP",gradientOpacity:"4 0 1 255 1",specularPower:"10",scalarOpacity:"8 -3024 0 -637.62 0 700 1 3071 1",specular:"0.2",shade:"1",ambient:"0.1",colorTransfer:"16 -3024 0 0 0 -637.62 1 1 1 700 1 1 1 3071 1 1 1",diffuse:"0.9",interpolation:"1"},{name:"CT-Muscle",gradientOpacity:"4 0 1 255 1",specularPower:"10",scalarOpacity:"10 -3024 0 -155.407 0 217.641 0.676471 419.736 0.833333 3071 0.803922",specular:"0.2",shade:"1",ambient:"0.1",colorTransfer:"20 -3024 0 0 0 -155.407 0.54902 0.25098 0.14902 217.641 0.882353 0.603922 0.290196 419.736 1 0.937033 0.954531 3071 0.827451 0.658824 1",diffuse:"0.9",interpolation:"1"},{name:"CT-Pulmonary-Arteries",gradientOpacity:"4 0 1 255 1",specularPower:"1",scalarOpacity:"14 -2048 0 -568.625 0 -364.081 0.0714286 -244.813 0.401786 18.2775 0.607143 447.798 0.830357 3592.73 0.839286",specular:"0",shade:"1",ambient:"0.2",colorTransfer:"28 -2048 0 0 0 -568.625 0 0 0 -364.081 0.396078 0.301961 0.180392 -244.813 0.611765 0.352941 0.0705882 18.2775 0.843137 0.0156863 0.156863 447.798 0.752941 0.752941 0.752941 3592.73 1 1 1",diffuse:"1",interpolation:"1"},{name:"CT-Soft-Tissue",gradientOpacity:"4 0 1 255 1",specularPower:"1",scalarOpacity:"10 -2048 0 -167.01 0 -160 1 240 1 3661 1",specular:"0",shade:"0",ambient:"0.2",colorTransfer:"20 -2048 0 0 0 -167.01 0 0 0 -160 0.0556356 0.0556356 0.0556356 240 1 1 1 3661 1 1 1",diffuse:"1",interpolation:"1"},{name:"CT-Air",gradientOpacity:"4 0 1 255 1",specularPower:"10",scalarOpacity:"8 -3024 0.705882 -900.0 0.715686 -500.0 0 3071 0",specular:"0.2",shade:"1",ambient:"0.1",colorTransfer:"16 -3024 1 1 1 -900.0 0.2 1.0 1.0 -500.0 0.3 0.3 1.0 3071 0 0 0 ",diffuse:"0.9",interpolation:"1"},{name:"MR-Angio",gradientOpacity:"4 0 1 255 1",specularPower:"1",scalarOpacity:"12 -2048 0 151.354 0 158.279 0.4375 190.112 0.580357 200.873 0.732143 3661 0.741071",specular:"0",shade:"1",ambient:"0.2",colorTransfer:"24 -2048 0 0 0 151.354 0 0 0 158.279 0.74902 0.376471 0 190.112 1 0.866667 0.733333 200.873 0.937255 0.937255 0.937255 3661 1 1 1",diffuse:"1",interpolation:"1"},{name:"MR-Default",gradientOpacity:"4 0 1 255 1",specularPower:"1",scalarOpacity:"12 0 0 20 0 40 0.15 120 0.3 220 0.375 1024 0.5",specular:"0",shade:"1",ambient:"0.2",colorTransfer:"24 0 0 0 0 20 0.168627 0 0 40 0.403922 0.145098 0.0784314 120 0.780392 0.607843 0.380392 220 0.847059 0.835294 0.788235 1024 1 1 1",diffuse:"1",interpolation:"1"},{name:"MR-MIP",gradientOpacity:"4 0 1 255 1",specularPower:"1",scalarOpacity:"8 0 0 98.3725 0 416.637 1 2800 1",specular:"0",shade:"0",ambient:"0.2",colorTransfer:"16 0 1 1 1 98.3725 1 1 1 416.637 1 1 1 2800 1 1 1",diffuse:"1",interpolation:"1"},{name:"MR-T2-Brain",gradientOpacity:"4 0 1 160.25 1",specularPower:"40",scalarOpacity:"10 0 0 36.05 0 218.302 0.171429 412.406 1 641 1",specular:"0.5",shade:"1",ambient:"0.3",colorTransfer:"16 0 0 0 0 98.7223 0.956863 0.839216 0.192157 412.406 0 0.592157 0.807843 641 1 1 1",diffuse:"0.6",interpolation:"1"},{name:"DTI-FA-Brain",gradientOpacity:"4 0 1 0.9950 1",specularPower:"40",scalarOpacity:"16 0 0 0 0 0.3501 0.0158 0.49379 0.7619 0.6419 1 0.9920 1 0.9950 0 0.9950 0",specular:"0.5",shade:"1",ambient:"0.3",colorTransfer:"28 0 1 0 0 0 1 0 0 0.24974 0.4941 1 0 0.49949 0 0.9882 1 0.7492 0.51764 0 1 0.9950 1 0 0 0.9950 1 0 0",diffuse:"0.9",interpolation:"1"}],u1e={slicer3D:[160/255,164/255,217/255]},cp=Object.freeze(Object.defineProperty({__proto__:null,BACKGROUND_COLORS:u1e,CPU_COLORMAPS:t6,EPSILON:Qs,MPR_CAMERA_VALUES:wf,RENDERING_DEFAULTS:Ci,VIEWPORT_PRESETS:LW},Symbol.toStringTag,{value:"Module"})),H1={},p2={get:t=>H1[t],set:t=>{const e=t.id;H1[e]=t},delete:t=>delete H1[t],getAll:()=>{const e=Object.keys(H1).map(n=>H1[n]);return e.sort((n,r)=>n.id[0]==="_"&&r.id[0]!=="_"?1:n.id[0]!=="_"&&r.id[0]==="_"?-1:0),e}};function $f(t){return p2.get(t)}function Fl(){return p2.getAll()}const Zb=t=>t&&typeof t=="object"&&Object.prototype.toString.call(t)!=="[object RegExp]"&&Object.prototype.toString.call(t)!=="[object Date]",f1e=t=>Array.isArray(t)?[]:{},g2=(t,e)=>e&&e.clone===!0&&Zb(t)?Mo(f1e(t),t,e):t,bN=(t,e,n)=>{const r=t.slice();return e.forEach(function(i,a){typeof r[a]>"u"?r[a]=g2(i,n):Zb(i)?r[a]=Mo(t[a],i,n):t.indexOf(i)===-1&&(r[a]=g2(i,n))}),r},d1e=(t,e,n)=>{const r={};return Zb(t)&&Object.keys(t).forEach(function(i){r[i]=g2(t[i],n)}),Object.keys(e).forEach(function(i){!Zb(e[i])||!t[i]?r[i]=g2(e[i],n):r[i]=Mo(t[i],e[i],n)}),r},Mo=(t={},e={},n=void 0)=>{const r=Array.isArray(e),a=(n||{arrayMerge:bN}).arrayMerge||bN;return r?Array.isArray(t)?a(t,e,n):g2(e,n):d1e(t,e,n)};/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const kW=Symbol("Comlink.proxy"),h1e=Symbol("Comlink.endpoint"),VW=Symbol("Comlink.releaseProxy"),yT=Symbol("Comlink.finalizer"),Jx=Symbol("Comlink.thrown"),FW=t=>typeof t=="object"&&t!==null||typeof t=="function",p1e={canHandle:t=>FW(t)&&t[kW],serialize(t){const{port1:e,port2:n}=new MessageChannel;return x9(t,e),[n,[n]]},deserialize(t){return t.start(),n6(t)}},g1e={canHandle:t=>FW(t)&&Jx in t,serialize({value:t}){let e;return t instanceof Error?e={isError:!0,value:{message:t.message,name:t.name,stack:t.stack}}:e={isError:!1,value:t},[e,[]]},deserialize(t){throw t.isError?Object.assign(new Error(t.value.message),t.value):t.value}},UW=new Map([["proxy",p1e],["throw",g1e]]);function m1e(t,e){for(const n of t)if(e===n||n==="*"||n instanceof RegExp&&n.test(e))return!0;return!1}function x9(t,e=globalThis,n=["*"]){e.addEventListener("message",function r(i){if(!i||!i.data)return;if(!m1e(n,i.origin)){console.warn(`Invalid origin '${i.origin}' for comlink proxy`);return}const{id:a,type:o,path:s}=Object.assign({path:[]},i.data),l=(i.data.argumentList||[]).map(hh);let c;try{const f=s.slice(0,-1).reduce((d,h)=>d[h],t),u=s.reduce((d,h)=>d[h],t);switch(o){case"GET":c=u;break;case"SET":f[s.slice(-1)[0]]=hh(i.data.value),c=!0;break;case"APPLY":c=u.apply(f,l);break;case"CONSTRUCT":{const d=new u(...l);c=jW(d)}break;case"ENDPOINT":{const{port1:d,port2:h}=new MessageChannel;x9(t,h),c=w1e(d,[d])}break;case"RELEASE":c=void 0;break;default:return}}catch(f){c={value:f,[Jx]:0}}Promise.resolve(c).catch(f=>({value:f,[Jx]:0})).then(f=>{const[u,d]=t3(f);e.postMessage(Object.assign(Object.assign({},u),{id:a}),d),o==="RELEASE"&&(e.removeEventListener("message",r),BW(e),yT in t&&typeof t[yT]=="function"&&t[yT]())}).catch(f=>{const[u,d]=t3({value:new TypeError("Unserializable return value"),[Jx]:0});e.postMessage(Object.assign(Object.assign({},u),{id:a}),d)})}),e.start&&e.start()}function v1e(t){return t.constructor.name==="MessagePort"}function BW(t){v1e(t)&&t.close()}function n6(t,e){const n=new Map;return t.addEventListener("message",function(i){const{data:a}=i;if(!a||!a.id)return;const o=n.get(a.id);if(o)try{o(a)}finally{n.delete(a.id)}}),r6(t,n,[],e)}function W5(t){if(t)throw new Error("Proxy has been released and is not useable")}function $W(t){return fg(t,new Map,{type:"RELEASE"}).then(()=>{BW(t)})}const Qb=new WeakMap,e3="FinalizationRegistry"in globalThis&&new FinalizationRegistry(t=>{const e=(Qb.get(t)||0)-1;Qb.set(t,e),e===0&&$W(t)});function y1e(t,e){const n=(Qb.get(e)||0)+1;Qb.set(e,n),e3&&e3.register(t,e,t)}function x1e(t){e3&&e3.unregister(t)}function r6(t,e,n=[],r=function(){}){let i=!1;const a=new Proxy(r,{get(o,s){if(W5(i),s===VW)return()=>{x1e(a),$W(t),e.clear(),i=!0};if(s==="then"){if(n.length===0)return{then:()=>a};const l=fg(t,e,{type:"GET",path:n.map(c=>c.toString())}).then(hh);return l.then.bind(l)}return r6(t,e,[...n,s])},set(o,s,l){W5(i);const[c,f]=t3(l);return fg(t,e,{type:"SET",path:[...n,s].map(u=>u.toString()),value:c},f).then(hh)},apply(o,s,l){W5(i);const c=n[n.length-1];if(c===h1e)return fg(t,e,{type:"ENDPOINT"}).then(hh);if(c==="bind")return r6(t,e,n.slice(0,-1));const[f,u]=wN(l);return fg(t,e,{type:"APPLY",path:n.map(d=>d.toString()),argumentList:f},u).then(hh)},construct(o,s){W5(i);const[l,c]=wN(s);return fg(t,e,{type:"CONSTRUCT",path:n.map(f=>f.toString()),argumentList:l},c).then(hh)}});return y1e(a,t),a}function b1e(t){return Array.prototype.concat.apply([],t)}function wN(t){const e=t.map(t3);return[e.map(n=>n[0]),b1e(e.map(n=>n[1]))]}const GW=new WeakMap;function w1e(t,e){return GW.set(t,e),t}function jW(t){return Object.assign(t,{[kW]:!0})}function t3(t){for(const[e,n]of UW)if(n.canHandle(t)){const[r,i]=n.serialize(t);return[{type:"HANDLER",name:e,value:r},i]}return[{type:"RAW",value:t},GW.get(t)||[]]}function hh(t){switch(t.type){case"HANDLER":return UW.get(t.name).deserialize(t.value);case"RAW":return t.value}}function fg(t,e,n,r){return new Promise(i=>{const a=C1e();e.set(a,i),t.start&&t.start(),t.postMessage(Object.assign({id:a},n),r)})}function C1e(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}function or(){return typeof crypto.randomUUID=="function"?crypto.randomUUID():("10000000-1000-4000-8000"+-1e11).replace(/[018]/g,t=>(t^crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16))}class b9{constructor(e){this.numRequests={[Dn.Interaction]:0,[Dn.Thumbnail]:0,[Dn.Prefetch]:0,[Dn.Compute]:0},this.id=e||or(),this.requestPool={[Dn.Interaction]:{0:[]},[Dn.Thumbnail]:{0:[]},[Dn.Prefetch]:{0:[]},[Dn.Compute]:{0:[]}},this.grabDelay=5,this.awake=!1,this.numRequests={[Dn.Interaction]:0,[Dn.Thumbnail]:0,[Dn.Prefetch]:0,[Dn.Compute]:0},this.maxNumRequests={[Dn.Interaction]:6,[Dn.Thumbnail]:6,[Dn.Prefetch]:5,[Dn.Compute]:1e3}}setMaxSimultaneousRequests(e,n){this.maxNumRequests[e]=n}getMaxSimultaneousRequests(e){return this.maxNumRequests[e]}destroy(){this.timeoutHandle&&window.clearTimeout(this.timeoutHandle)}addRequest(e,n,r,i=0){const a={requestFn:e,type:n,additionalDetails:r};this.requestPool[n][i]===void 0&&(this.requestPool[n][i]=[]),this.requestPool[n][i].push(a),this.startGrabbing()}filterRequests(e){Object.keys(this.requestPool).forEach(n=>{const r=this.requestPool[n];Object.keys(r).forEach(i=>{r[i]=r[i].filter(a=>e(a))})})}clearRequestStack(e){if(!this.requestPool[e])throw new Error(`No category for the type ${e} found`);this.requestPool[e]={0:[]}}sendRequests(e){const n=this.maxNumRequests[e]-this.numRequests[e];let r=0;for(let i=0;i<n;i++){const a=this.getNextRequest(e);if(a===null)return!1;if(a){this.numRequests[e]++,this.awake=!0;let o;try{o=a.requestFn()}catch(s){console.warn("sendRequest failed",s)}o?.finally?o.finally(()=>{this.numRequests[e]--,this.startAgain()}):(this.numRequests[e]--,r++)}}return r&&this.startAgain(),!0}getNextRequest(e){const n=this.getSortedPriorityGroups(e);for(const r of n)if(this.requestPool[e][r].length)return this.requestPool[e][r].shift();return null}startGrabbing(){const e=this.sendRequests(Dn.Interaction),n=this.sendRequests(Dn.Thumbnail),r=this.sendRequests(Dn.Prefetch),i=this.sendRequests(Dn.Compute);!e&&!n&&!r&&!i&&(this.awake=!1)}startAgain(){this.awake&&(this.grabDelay!==void 0?this.timeoutHandle||(this.timeoutHandle=window.setTimeout(()=>{this.timeoutHandle=null,this.startGrabbing()},this.grabDelay)):this.startGrabbing())}getSortedPriorityGroups(e){return Object.keys(this.requestPool[e]).map(Number).filter(r=>this.requestPool[e][r].length).sort((r,i)=>r-i)}getRequestPool(){return this.requestPool}}class zW{constructor(){this.workerRegistry={},this.workerPoolManager=new b9("webworker")}registerWorker(e,n,r={}){const{maxWorkerInstances:i=1,overwrite:a=!1,autoTerminateOnIdle:o={enabled:!1,idleTimeThreshold:3e3}}=r;if(this.workerRegistry[e]&&!a){console.warn(`Worker type '${e}' is already registered...`);return}a&&this.workerRegistry[e]?.idleCheckIntervalId&&clearInterval(this.workerRegistry[e].idleCheckIntervalId);const s={workerFn:null,instances:[],loadCounters:[],lastActiveTime:[],nativeWorkers:[],autoTerminateOnIdle:o.enabled,idleCheckIntervalId:null,idleTimeThreshold:o.idleTimeThreshold};s.loadCounters=Array(i).fill(0),s.lastActiveTime=Array(i).fill(null);for(let l=0;l<i;l++){const c=n();s.instances.push(n6(c)),s.nativeWorkers.push(c),s.workerFn=n}this.workerRegistry[e]=s}getNextWorkerAPI(e){const n=this.workerRegistry[e];if(!n)return console.error(`Worker type '${e}' is not registered.`),null;const r=n.instances.filter(o=>o!==null);let i=0,a=n.loadCounters[0]||0;for(let o=1;o<r.length;o++){const s=n.loadCounters[o]||0;s<a&&(i=o,a=s)}if(n.instances[i]===null){const o=n.workerFn();n.instances[i]=n6(o),n.nativeWorkers[i]=o}return n.loadCounters[i]+=1,{api:n.instances[i],index:i}}executeTask(e,n,r={},{requestType:i=Dn.Compute,priority:a=0,options:o={},callbacks:s=[]}={}){return new Promise((l,c)=>{const f=async()=>{const{api:u,index:d}=this.getNextWorkerAPI(e);if(!u){const h=new Error(`No available worker instance for '${e}'`);console.error(h),c(h);return}try{let h=[];s.length&&(h=s.map(m=>jW(m)));const p=this.workerRegistry[e];p.processing=!0;const g=await u[n](r,...h);p.processing=!1,p.lastActiveTime[d]=Date.now(),p.autoTerminateOnIdle&&!p.idleCheckIntervalId&&p.idleTimeThreshold&&(p.idleCheckIntervalId=setInterval(()=>{this.terminateIdleWorkers(e,p.idleTimeThreshold)},p.idleTimeThreshold)),l(g)}catch(h){console.error(`Error executing method '${n}' on worker '${e}':`,h),c(h)}finally{this.workerRegistry[e].loadCounters[d]--}};this.workerPoolManager.addRequest(f,i,o,a)})}terminateIdleWorkers(e,n){const r=this.workerRegistry[e];if(r.processing)return;const i=Date.now();r.instances.forEach((a,o)=>{const s=r.lastActiveTime[o],l=s!==null&&r.loadCounters[o]>0,c=i-s;!l&&c>n&&this.terminateWorkerInstance(e,o)})}terminate(e){const n=this.workerRegistry[e];if(!n){console.error(`Worker type '${e}' is not registered.`);return}n.instances.forEach((r,i)=>{this.terminateWorkerInstance(e,i)})}terminateWorkerInstance(e,n){const r=this.workerRegistry[e],i=r.instances[n];i!==null&&(i[VW](),r.nativeWorkers[n].terminate(),r.instances[n]=null,r.lastActiveTime[n]=null)}}const xT=4,S1e=5,T1e=1,CN=[1,1];function SN({ext:t,filterType:e,texData:n,internalFormat:r,glDataType:i}){try{const a=document.createElement("canvas");a.width=xT,a.height=xT;const o=a.getContext("webgl2");if(!o)return!1;const s=`#version 300 es
    void main() {
      gl_PointSize = ${xT.toFixed(1)};
      gl_Position = vec4(0, 0, 0, 1);
    }
  `,l=`#version 300 es
    precision highp float;
    precision highp int;
    precision highp sampler2D;

    uniform sampler2D u_image;

    out vec4 color;

    void main() {
        vec4 intColor = texture(u_image, gl_PointCoord.xy);
        color = vec4(vec3(intColor.rrr), 1);
    }
    `;let c;if(t&&(c=o.getExtension(t),!c))return!1;const f=o.createShader(o.VERTEX_SHADER);if(o.shaderSource(f,s),o.compileShader(f),!o.getShaderParameter(f,o.COMPILE_STATUS))return!1;const u=o.createShader(o.FRAGMENT_SHADER);if(o.shaderSource(u,l),o.compileShader(u),!o.getShaderParameter(u,o.COMPILE_STATUS))return!1;const d=o.createProgram();if(o.attachShader(d,f),o.attachShader(d,u),o.linkProgram(d),!o.getProgramParameter(d,o.LINK_STATUS))return!1;const h=o.createTexture();o.bindTexture(o.TEXTURE_2D,h),o.texImage2D(o.TEXTURE_2D,0,r(o,c),S1e,T1e,0,o.RED,i(o,c),n);const p=e==="LINEAR"?o.LINEAR:o.NEAREST;o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,p),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,p),o.useProgram(d),o.drawArrays(o.POINTS,0,1);const g=new Uint8Array(4);o.readPixels(CN[0],CN[1],1,1,o.RGBA,o.UNSIGNED_BYTE,g);const[m,y,v]=g,x=o.getExtension("WEBGL_lose_context");return x&&x.loseContext(),m===y&&y===v&&m!==0}catch{return!1}}function E1e(){const t=new Int16Array([32767,2e3,3e3,4e3,5e3,16784,7e3,8e3,9e3,32767]);return{norm16:SN({ext:"EXT_texture_norm16",filterType:"NEAREST",texData:t,internalFormat:(e,n)=>n.R16_SNORM_EXT,glDataType:e=>e.SHORT}),norm16Linear:SN({ext:"EXT_texture_norm16",filterType:"LINEAR",texData:t,internalFormat:(e,n)=>n.R16_SNORM_EXT,glDataType:e=>e.SHORT})}}let Kd=!1;const i6={gpuTier:{tier:2},isMobile:!1,rendering:{useCPURendering:!1,preferSizeOverAccuracy:!1,strictZSpacingForVolumeViewport:!0,renderingEngineMode:Hh.ContextPool,webGlContextCount:7,volumeRendering:{sampleDistanceMultiplier:1}},debug:{statsOverlay:!1},peerImport:t=>null};let zs={...i6,rendering:{...i6.rendering}},Pv=null,WW=!1;function _1e(){const t=document.createElement("canvas");return t.getContext("webgl2")||t.getContext("webgl")||t.getContext("experimental-webgl")}function HW(){const t=_1e();return t instanceof WebGLRenderingContext||t instanceof WebGL2RenderingContext}function D1e(){const t=E1e();return t.norm16&&t.norm16Linear}function KW(){return/iPad|iPhone|iPod/.test(navigator.platform)?!0:navigator.maxTouchPoints&&navigator.maxTouchPoints>2&&navigator.platform.includes("MacIntel")}function qW(t=zs){return Kd||(WW=D1e(),zs=Mo(i6,t),zs.isMobile&&(zs.rendering.webGlContextCount=1),KW()&&(t.rendering?.preferSizeOverAccuracy?zs.rendering.preferSizeOverAccuracy=!0:console.log("norm16 texture not supported, you can turn on the preferSizeOverAccuracy flag to use native data type, but be aware of the inaccuracy of the rendering in high bits")),HW()?console.log("CornerstoneRender: using GPU rendering"):(console.log("CornerstoneRender: GPU not detected, using CPU rendering"),zs.rendering.useCPURendering=!0),Kd=!0,Pv||(Pv=new zW),Kd)}function O1e(){return WW}function M1e(t,e=!0){zs.rendering.useCPURendering=t,Kd=!0,e&&kw()}function I1e(t){zs.rendering.preferSizeOverAccuracy=t,Kd=!0,kw()}function Lw(){return!KW()}function R1e(){zs.rendering.useCPURendering=!HW(),kw()}function Bg(){return zs.rendering.useCPURendering}function XW(){return Kd}function A1e(){Kd=!1}function Pf(){return zs}function P1e(t){zs=t,kw()}function kw(){Fl().forEach(t=>{t.getViewports().forEach(e=>{e.updateRenderingPipeline()})})}function Rm(){return Pv||(Pv=new zW),Pv}async function YW(t){return zs.peerImport(t)}class N1e{constructor(){this.listeners={},this.debouncedListeners={}}reset(){this.listeners={},this.debouncedListeners={}}addEventListenerOnce(e,n){const r=i=>{this.removeEventListener(e,r),n.call(this,i)};this.addEventListener(e,r)}addEventListener(e,n){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].indexOf(n)===-1&&this.listeners[e].push(n)}addEventListenerDebounced(e,n,r){this.debouncedListeners[e]=this.debouncedListeners[e]||{};const i=this.debouncedListeners[e];if(!i[n]){const a=o=>{i[n]&&clearTimeout(i[n].timeoutId),i[n].timeoutId=setTimeout(()=>{n.call(this,o)},r)};i[n]={original:n,handle:a,timeoutId:null},this.addEventListener(e,a)}}removeEventListenerDebounced(e,n){if(this.debouncedListeners[e]?.[n]){const r=this.debouncedListeners[e][n];this.removeEventListener(e,r.handle),clearTimeout(r.timeoutId),delete this.debouncedListeners[e][n]}}removeEventListener(e,n){if(!this.listeners[e])return;const r=this.listeners[e],i=r.length;for(let a=0;a<i;a++)if(r[a]===n){r.splice(a,1);return}}dispatchEvent(e){if(!this.listeners[e.type])return!e.defaultPrevented;const n=this.listeners[e.type].slice(),r=n.length;for(let i=0;i<r;i++)try{n[i].call(this,e)}catch(a){console.error(`error in event listener of type:  ${e.type}`,a)}return!e.defaultPrevented}}const St=new N1e;function Ct(t=St,e,n=null){if(!e)throw new Error("Event type was not defined");const r=new CustomEvent(e,{detail:n,cancelable:!0});return t?.dispatchEvent(r)}var bT,TN;function L1e(){return TN||(TN=1,bT=function t(e,n){if(e===n)return!0;if(e&&n&&typeof e=="object"&&typeof n=="object"){if(e.constructor!==n.constructor)return!1;var r,i,a;if(Array.isArray(e)){if(r=e.length,r!=n.length)return!1;for(i=r;i--!==0;)if(!t(e[i],n[i]))return!1;return!0}if(e.constructor===RegExp)return e.source===n.source&&e.flags===n.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===n.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===n.toString();if(a=Object.keys(e),r=a.length,r!==Object.keys(n).length)return!1;for(i=r;i--!==0;)if(!Object.prototype.hasOwnProperty.call(n,a[i]))return!1;for(i=r;i--!==0;){var o=a[i];if(!t(e[o],n[o]))return!1}return!0}return e!==e&&n!==n}),bT}var k1e=L1e();const w9=tl(k1e);var wT,EN;function JW(){if(EN)return wT;EN=1;var t=Object.prototype.toString;return wT=function(n){var r=t.call(n),i=r==="[object Arguments]";return i||(i=r!=="[object Array]"&&n!==null&&typeof n=="object"&&typeof n.length=="number"&&n.length>=0&&t.call(n.callee)==="[object Function]"),i},wT}var CT,_N;function V1e(){if(_N)return CT;_N=1;var t;if(!Object.keys){var e=Object.prototype.hasOwnProperty,n=Object.prototype.toString,r=JW(),i=Object.prototype.propertyIsEnumerable,a=!i.call({toString:null},"toString"),o=i.call(function(){},"prototype"),s=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],l=function(d){var h=d.constructor;return h&&h.prototype===d},c={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},f=(function(){if(typeof window>"u")return!1;for(var d in window)try{if(!c["$"+d]&&e.call(window,d)&&window[d]!==null&&typeof window[d]=="object")try{l(window[d])}catch{return!0}}catch{return!0}return!1})(),u=function(d){if(typeof window>"u"||!f)return l(d);try{return l(d)}catch{return!1}};t=function(h){var p=h!==null&&typeof h=="object",g=n.call(h)==="[object Function]",m=r(h),y=p&&n.call(h)==="[object String]",v=[];if(!p&&!g&&!m)throw new TypeError("Object.keys called on a non-object");var x=o&&g;if(y&&h.length>0&&!e.call(h,0))for(var w=0;w<h.length;++w)v.push(String(w));if(m&&h.length>0)for(var S=0;S<h.length;++S)v.push(String(S));else for(var T in h)!(x&&T==="prototype")&&e.call(h,T)&&v.push(String(T));if(a)for(var _=u(h),D=0;D<s.length;++D)!(_&&s[D]==="constructor")&&e.call(h,s[D])&&v.push(s[D]);return v}}return CT=t,CT}var ST,DN;function F1e(){if(DN)return ST;DN=1;var t=Array.prototype.slice,e=JW(),n=Object.keys,r=n?function(o){return n(o)}:V1e(),i=Object.keys;return r.shim=function(){if(Object.keys){var o=(function(){var s=Object.keys(arguments);return s&&s.length===arguments.length})(1,2);o||(Object.keys=function(l){return e(l)?i(t.call(l)):i(l)})}else Object.keys=r;return Object.keys||r},ST=r,ST}var TT,ON;function ZW(){if(ON)return TT;ON=1;var t=Object.defineProperty||!1;if(t)try{t({},"a",{value:1})}catch{t=!1}return TT=t,TT}var ET,MN;function U1e(){return MN||(MN=1,ET=SyntaxError),ET}var _T,IN;function B1e(){return IN||(IN=1,_T=TypeError),_T}var DT,RN;function $1e(){return RN||(RN=1,DT=Object.getOwnPropertyDescriptor),DT}var OT,AN;function G1e(){if(AN)return OT;AN=1;var t=$1e();if(t)try{t([],"length")}catch{t=null}return OT=t,OT}var MT,PN;function j1e(){if(PN)return MT;PN=1;var t=ZW(),e=U1e(),n=B1e(),r=G1e();return MT=function(a,o,s){if(!a||typeof a!="object"&&typeof a!="function")throw new n("`obj` must be an object or a function`");if(typeof o!="string"&&typeof o!="symbol")throw new n("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new n("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new n("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new n("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new n("`loose`, if provided, must be a boolean");var l=arguments.length>3?arguments[3]:null,c=arguments.length>4?arguments[4]:null,f=arguments.length>5?arguments[5]:null,u=arguments.length>6?arguments[6]:!1,d=!!r&&r(a,o);if(t)t(a,o,{configurable:f===null&&d?d.configurable:!f,enumerable:l===null&&d?d.enumerable:!l,value:s,writable:c===null&&d?d.writable:!c});else if(u||!l&&!c&&!f)a[o]=s;else throw new e("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},MT}var IT,NN;function z1e(){if(NN)return IT;NN=1;var t=ZW(),e=function(){return!!t};return e.hasArrayLengthDefineBug=function(){if(!t)return null;try{return t([],"length",{value:1}).length!==1}catch{return!0}},IT=e,IT}var RT,LN;function QW(){if(LN)return RT;LN=1;var t=F1e(),e=typeof Symbol=="function"&&typeof Symbol("foo")=="symbol",n=Object.prototype.toString,r=Array.prototype.concat,i=j1e(),a=function(c){return typeof c=="function"&&n.call(c)==="[object Function]"},o=z1e()(),s=function(c,f,u,d){if(f in c){if(d===!0){if(c[f]===u)return}else if(!a(d)||!d())return}o?i(c,f,u,!0):i(c,f,u)},l=function(c,f){var u=arguments.length>2?arguments[2]:{},d=t(f);e&&(d=r.call(d,Object.getOwnPropertySymbols(f)));for(var h=0;h<d.length;h+=1)s(c,d[h],f[d[h]],u[d[h]])};return l.supportsDescriptors=!!o,RT=l,RT}var K1={exports:{}},kN;function eH(){return kN||(kN=1,typeof self<"u"?K1.exports=self:typeof window<"u"?K1.exports=window:K1.exports=Function("return this")()),K1.exports}var AT,VN;function tH(){if(VN)return AT;VN=1;var t=eH();return AT=function(){return typeof gf!="object"||!gf||gf.Math!==Math||gf.Array!==Array?t:gf},AT}var PT,FN;function W1e(){if(FN)return PT;FN=1;var t=QW(),e=tH();return PT=function(){var r=e();if(t.supportsDescriptors){var i=Object.getOwnPropertyDescriptor(r,"globalThis");(!i||i.configurable&&(i.enumerable||!i.writable||globalThis!==r))&&Object.defineProperty(r,"globalThis",{configurable:!0,enumerable:!1,value:r,writable:!0})}else(typeof globalThis!="object"||globalThis!==r)&&(r.globalThis=r);return r},PT}var NT,UN;function H1e(){if(UN)return NT;UN=1;var t=QW(),e=eH(),n=tH(),r=W1e(),i=n(),a=function(){return i};return t(a,{getPolyfill:n,implementation:e,shim:r}),NT=a,NT}var K1e=H1e();const q1e=tl(K1e),cc=q1e(),nH={vtkObject:()=>null};function hc(t){if(t==null||t.isA)return t;if(!t.vtkClass)return cc.console&&cc.console.error&&cc.console.error("Invalid VTK object"),null;const e=nH[t.vtkClass];if(!e)return cc.console&&cc.console.error&&cc.console.error(`No vtk class found for Object of type ${t.vtkClass}`),null;const n={...t};Object.keys(n).forEach(i=>{n[i]&&typeof n[i]=="object"&&n[i].vtkClass&&(n[i]=hc(n[i]))});const r=e(n);return r&&r.modified&&r.modified(),r}function X1e(t,e){nH[t]=e}hc.register=X1e;class LT extends Array{push(){for(let e=0;e<arguments.length;e++)this.includes(arguments[e])||super.push(arguments[e]);return this.length}}let a6=0;const rH=Symbol("void");function Y1e(){return a6}const iH={};function ph(){}const J1e=["log","debug","info","warn","error","time","timeEnd","group","groupEnd"];J1e.forEach(t=>{iH[t]=ph});cc.console=console.hasOwnProperty("log")?console:iH;const f0={debug:ph,error:cc.console.error||ph,info:cc.console.info||ph,log:cc.console.log||ph,warn:cc.console.warn||ph};function aH(t,e){f0[t]&&(f0[t]=e||ph)}function oH(){f0.log(...arguments)}function sH(){f0.info(...arguments)}function n3(){f0.debug(...arguments)}function Bn(){f0.error(...arguments)}function Vw(){f0.warn(...arguments)}const BN={};function lH(t){BN[t]||(f0.error(t),BN[t]=!0)}const Ro=Object.create(null);Ro.Float32Array=Float32Array;Ro.Float64Array=Float64Array;Ro.Uint8Array=Uint8Array;Ro.Int8Array=Int8Array;Ro.Uint16Array=Uint16Array;Ro.Int16Array=Int16Array;Ro.Uint32Array=Uint32Array;Ro.Int32Array=Int32Array;Ro.Uint8ClampedArray=Uint8ClampedArray;try{Ro.BigInt64Array=BigInt64Array,Ro.BigUint64Array=BigUint64Array}catch{}function Am(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return new(Ro[t]||Float64Array)(...n)}function Fw(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return(Ro[t]||Float64Array).from(...n)}function Uw(t){return t.charAt(0).toUpperCase()+t.slice(1)}function zi(t){return Uw(t[0]==="_"?t.slice(1):t)}function cH(t){return t.charAt(0).toLowerCase()+t.slice(1)}function uH(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1e3;const r=["TB","GB","MB","KB"];let i=Number(t),a="B";for(;i>n;)i/=n,a=r.pop();return`${i.toFixed(e)} ${a}`}function fH(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";const n=[];let r=t;for(;r>1e3;)n.push(`000${r%1e3}`.slice(-3)),r=Math.floor(r/1e3);return r>0&&n.push(r),n.reverse(),n.join(e)}function dH(t){Object.keys(t).forEach(e=>{Array.isArray(t[e])&&(t[e]=[].concat(t[e]))})}function Z1e(t){return Object.values(Ro).some(e=>t instanceof e)}function Q1e(t,e){if(t===e)return!0;if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}return!1}function eve(t,e){return Object.keys(t).find(n=>t[n]===e)}function hH(t){return t&&t.isA?t.getState():t}function C9(t){setTimeout(t,0)}function pH(t,e){const n=performance.now();t.finally(()=>{const r=performance.now()-n;e(r)})}function $r(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};dH(e);const n=[];if(Number.isInteger(e.mtime)||(e.mtime=++a6),!("classHierarchy"in e))e.classHierarchy=new LT("vtkObject");else if(!(e.classHierarchy instanceof LT)){const a=new LT;for(let o=0;o<e.classHierarchy.length;o++)a.push(e.classHierarchy[o]);e.classHierarchy=a}function r(a){n[a]=null}function i(a){function o(){r(a)}return Object.freeze({unsubscribe:o})}return t.isDeleted=()=>!!e.deleted,t.modified=a=>{if(e.deleted){Bn("instance deleted - cannot call any method");return}a&&a<t.getMTime()||(e.mtime=++a6,n.forEach(o=>o&&o(t)))},t.onModified=a=>{if(e.deleted)return Bn("instance deleted - cannot call any method"),null;const o=n.length;return n.push(a),i(o)},t.getMTime=()=>e.mtime,t.isA=a=>{let o=e.classHierarchy.length;for(;o--;)if(e.classHierarchy[o]===a)return!0;return!1},t.getClassName=function(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return e.classHierarchy[e.classHierarchy.length-1-a]},t.set=function(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,l=!1;return Object.keys(a).forEach(c=>{const f=s?null:t[`set${Uw(c)}`];f&&Array.isArray(a[c])&&f.length>1?l=f(...a[c])||l:f?l=f(a[c])||l:(["mtime"].indexOf(c)===-1&&!o&&Vw(`Warning: Set value to model directly ${c}, ${a[c]}`),l=e[c]!==a[c]||l,e[c]=a[c])}),l},t.get=function(){for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];if(!o.length)return e;const l={};return o.forEach(c=>{l[c]=e[c]}),l},t.getReferenceByName=a=>e[a],t.delete=()=>{Object.keys(e).forEach(a=>delete e[a]),n.forEach((a,o)=>r(o)),e.deleted=!0},t.getState=()=>{if(e.deleted)return null;const a={...e,vtkClass:t.getClassName()};Object.keys(a).forEach(s=>{a[s]===null||a[s]===void 0||s[0]==="_"?delete a[s]:a[s].isA?a[s]=a[s].getState():Array.isArray(a[s])?a[s]=a[s].map(hH):Z1e(a[s])&&(a[s]=Array.from(a[s]))});const o={};return Object.keys(a).sort().forEach(s=>{o[s]=a[s]}),o.mtime&&delete o.mtime,o},t.shallowCopy=function(a){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(a.getClassName()!==t.getClassName())throw new Error(`Cannot ShallowCopy ${a.getClassName()} into ${t.getClassName()}`);const s=a.get(),l=Object.keys(e).sort();Object.keys(s).sort().forEach(f=>{const u=l.indexOf(f);u===-1?o&&n3(`add ${f} in shallowCopy`):l.splice(u,1),e[f]=s[f]}),l.length&&o&&n3(`Untouched keys: ${l.join(", ")}`),t.modified()},t.toJSON=function(){return t.getState()},t}const tve={object(t,e,n){return function(){return{...e[n.name]}}}};function Po(t,e,n){n.forEach(r=>{if(typeof r=="object"){const i=tve[r.type];i?t[`get${zi(r.name)}`]=i(t,e,r):t[`get${zi(r.name)}`]=()=>e[r.name]}else t[`get${zi(r)}`]=()=>e[r]})}const gH={enum(t,e,n){const r=`_on${zi(n.name)}Changed`;return i=>{if(typeof i=="string"){if(n.enum[i]!==void 0)return e[n.name]!==n.enum[i]?(e[n.name]=n.enum[i],t.modified(),!0):!1;throw Bn(`Set Enum with invalid argument ${n}, ${i}`),new RangeError("Set Enum with invalid string argument")}if(typeof i=="number"){if(e[n.name]!==i){if(Object.keys(n.enum).map(a=>n.enum[a]).indexOf(i)!==-1){const a=e[n.name];return e[n.name]=i,e[r]?.(t,e,i,a),t.modified(),!0}throw Bn(`Set Enum outside numeric range ${n}, ${i}`),new RangeError("Set Enum outside numeric range")}return!1}throw Bn(`Set Enum with invalid argument (String/Number) ${n}, ${i}`),new TypeError("Set Enum with invalid argument (String/Number)")}},object(t,e,n){n.params?.length===1&&Vw('Setter of type "object" with a single "param" field is not supported');const r=`_on${zi(n.name)}Changed`;return function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];let s;if(a.length>1&&n.params?.length?s=n.params.reduce((l,c,f)=>Object.assign(l,{[c]:a[f]}),{}):s=a[0],!w9(e[n.name],s)){const l=e[n.name];return e[n.name]=s,e[r]?.(t,e,s,l),t.modified(),!0}return!1}}};function $N(t){if(typeof t=="object"){const e=gH[t.type];if(e)return(n,r)=>e(n,r,t);throw Bn(`No setter for field ${t}`),new TypeError("No setter for field")}return function(n,r){const i=`_on${zi(t)}Changed`;return function(o){if(r.deleted)return Bn("instance deleted - cannot call any method"),!1;if(r[t]!==o){const s=r[t.name];return r[t]=o,r[i]?.(n,r,o,s),n.modified(),!0}return!1}}}function J2(t,e,n){n.forEach(r=>{typeof r=="object"?t[`set${zi(r.name)}`]=$N(r)(t,e):t[`set${zi(r)}`]=$N(r)(t,e)})}function Mi(t,e,n){Po(t,e,n),J2(t,e,n)}function Pm(t,e,n){n.forEach(r=>{t[`get${zi(r)}`]=()=>e[r]?Array.from(e[r]):e[r],t[`get${zi(r)}ByReference`]=()=>e[r]})}function S9(t,e,n,r){let i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:void 0;n.forEach(a=>{if(e[a]&&r&&e[a].length!==r)throw new RangeError(`Invalid initial number of values for array (${a})`);const o=`_on${zi(a)}Changed`;t[`set${zi(a)}`]=function(){if(e.deleted)return Bn("instance deleted - cannot call any method"),!1;for(var s=arguments.length,l=new Array(s),c=0;c<s;c++)l[c]=arguments[c];let f=l,u,d=!1;if(f.length===1&&(f[0]==null||f[0].length>=0)&&(f=f[0],d=!0),f==null)u=e[a]!==f;else{if(r&&f.length!==r)if(f.length<r&&i!==void 0)for(f=Array.from(f),d=!1;f.length<r;)f.push(i);else throw new RangeError(`Invalid number of values for array setter (${a})`);u=e[a]==null||e[a].length!==f.length;for(let h=0;!u&&h<f.length;++h)u=e[a][h]!==f[h];u&&d&&(f=Array.from(f))}if(u){const h=e[a.name];e[a]=f,e[o]?.(t,e,f,h),t.modified()}return u},t[`set${zi(a)}From`]=s=>{const l=e[a];s.forEach((c,f)=>{l[f]=c})}})}function T9(t,e,n,r){let i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:void 0;Pm(t,e,n),S9(t,e,n,r,i)}function Z2(t,e,n){for(let r=0;r<n.length;r++){const i=n[r];e[i]!==void 0&&(e[`_${i}`]=e[i],delete e[i])}}function E9(t,e,n,r){e.inputData?e.inputData=e.inputData.map(hc):e.inputData=[],e.inputConnection?e.inputConnection=e.inputConnection.map(hc):e.inputConnection=[],e.output?e.output=e.output.map(hc):e.output=[],e.inputArrayToProcess?e.inputArrayToProcess=e.inputArrayToProcess.map(hc):e.inputArrayToProcess=[],e.numberOfInputs=n;function i(h){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(e.deleted){Bn("instance deleted - cannot call any method");return}if(p>=e.numberOfInputs){Bn(`algorithm ${t.getClassName()} only has ${e.numberOfInputs} input ports. To add more input ports, use addInputData()`);return}(e.inputData[p]!==h||e.inputConnection[p])&&(e.inputData[p]=h,e.inputConnection[p]=null,t.modified&&t.modified())}function a(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return e.inputConnection[h]&&(e.inputData[h]=e.inputConnection[h]()),e.inputData[h]}function o(h){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(e.deleted){Bn("instance deleted - cannot call any method");return}if(p>=e.numberOfInputs){let g=`algorithm ${t.getClassName()} only has `;g+=`${e.numberOfInputs}`,g+=" input ports. To add more input ports, use addInputConnection()",Bn(g);return}e.inputData[p]=null,e.inputConnection[p]=h}function s(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return e.inputConnection[h]}function l(){let h=e.numberOfInputs;for(;h&&!e.inputData[h-1]&&!e.inputConnection[h-1];)h--;return h===e.numberOfInputs&&e.numberOfInputs++,h}function c(h){if(e.deleted){Bn("instance deleted - cannot call any method");return}o(h,l())}function f(h){if(e.deleted){Bn("instance deleted - cannot call any method");return}i(h,l())}function u(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return e.deleted?(Bn("instance deleted - cannot call any method"),null):(t.shouldUpdate()&&t.update(),e.output[h])}t.shouldUpdate=()=>{const h=t.getMTime();let p=1/0,g=r;for(;g--;){if(!e.output[g]||e.output[g].isDeleted())return!0;const m=e.output[g].getMTime();if(m<h)return!0;m<p&&(p=m)}for(g=e.numberOfInputs;g--;)if(e.inputConnection[g]?.filter.shouldUpdate()||t.getInputData(g)?.getMTime()>p)return!0;return!1};function d(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;const p=()=>u(h);return p.filter=t,p}if(e.numberOfInputs){let h=e.numberOfInputs;for(;h--;)e.inputData.push(null),e.inputConnection.push(null);t.setInputData=i,t.setInputConnection=o,t.addInputData=f,t.addInputConnection=c,t.getInputData=a,t.getInputConnection=s}r&&(t.getOutputData=u,t.getOutputPort=d),t.update=()=>{const h=[];if(e.numberOfInputs){let p=0;for(;p<e.numberOfInputs;)h[p]=t.getInputData(p),p++}t.shouldUpdate()&&t.requestData&&t.requestData(h,e.output)},t.getNumberOfInputPorts=()=>e.numberOfInputs,t.getNumberOfOutputPorts=()=>r||e.output.length,t.getInputArrayToProcess=h=>{const p=e.inputArrayToProcess[h],g=e.inputData[h];return p&&g?g[`get${p.fieldAssociation}`]().getArray(p.arrayName):null},t.setInputArrayToProcess=function(h,p,g){let m=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"Scalars";for(;e.inputArrayToProcess.length<h;)e.inputArrayToProcess.push(null);e.inputArrayToProcess[h]={arrayName:p,fieldAssociation:g,attributeType:m}}}const _9=Symbol("Event abort");function D9(t,e,n){const r=[],i=t.delete;let a=1;function o(c){for(let f=0;f<r.length;++f){const[u]=r[f];if(u===c){r.splice(f,1);return}}}function s(c){function f(){o(c)}return Object.freeze({unsubscribe:f})}function l(){if(e.deleted){Bn("instance deleted - cannot call any method");return}const c=r.slice();for(let f=0;f<c.length;++f){const[,u,d]=c[f];if(u){if(d<0)setTimeout(()=>u.apply(t,arguments),1-d);else if(u.apply(t,arguments)===_9)break}}}t[`invoke${zi(n)}`]=l,t[`on${zi(n)}`]=function(c){let f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(!c.apply)return console.error(`Invalid callback for event ${n}`),null;if(e.deleted)return Bn("instance deleted - cannot call any method"),null;const u=a++;return r.push([u,c,f]),r.sort((d,h)=>h[2]-d[2]),s(u)},t.delete=()=>{i(),r.forEach(c=>{let[f]=c;return o(f)})}}function Zn(t,e){const n=function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const i={},a={};return t(a,i,r),Object.freeze(a)};return e&&hc.register(e,n),n}function Q2(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(){for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return e.filter(o=>!!o).map(o=>o(...i))}}function O9(t){return t&&t.isA&&t.isA("vtkObject")}function r3(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[];if(O9(t)){if(r.indexOf(t)>=0)return n;r.push(t);const i=e(t);i!==void 0&&n.push(i);const a=t.get();Object.keys(a).forEach(o=>{const s=a[o];Array.isArray(s)?s.forEach(l=>{r3(l,e,n,r)}):r3(s,e,n,r)})}return n}function mH(t,e,n){var r=this;let i;const a=function(){for(var o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];const c=r,f=()=>{i=null,n||t.apply(c,s)},u=n&&!i;clearTimeout(i),i=setTimeout(f,e),u&&t.apply(c,s)};return a.cancel=()=>clearTimeout(i),a}function vH(t,e){let n=!1,r=null;function i(){n=!1,r!==null&&(a(...r),r=null)}function a(){for(var o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];if(n){r=s;return}n=!0,t(...s),setTimeout(i,e)}return a}function M9(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};e.keystore=Object.assign(e.keystore||{},n),t.setKey=(r,i)=>{e.keystore[r]=i},t.getKey=r=>e.keystore[r],t.getAllKeys=()=>Object.keys(e.keystore),t.deleteKey=r=>delete e.keystore[r],t.clearKeystore=()=>t.getAllKeys().forEach(r=>delete e.keystore[r])}let nve=1;const H5="__root__";function yH(t,e){M9(t,e);const n=t.delete;e.proxyId=`${nve++}`,e.ui=JSON.parse(JSON.stringify(e.ui||[])),Po(t,e,["proxyId","proxyGroup","proxyName"]),Mi(t,e,["proxyManager"]);const r={},i={};function a(c,f){i[f]||(i[f]=[]);const u=i[f];for(let d=0;d<c.length;d++)u.push(c[d].name),r[c[d].name]=c[d],c[d].children&&c[d].children.length&&a(c[d].children,c[d].name)}a(e.ui,H5),t.updateUI=c=>{e.ui=JSON.parse(JSON.stringify(c||[])),Object.keys(r).forEach(f=>delete r[f]),Object.keys(i).forEach(f=>delete i[f]),a(e.ui,H5),t.modified()};function o(){let c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:H5;return i[c]}t.updateProxyProperty=(c,f)=>{const u=r[c];u?Object.assign(u,f):r[c]={...f}},t.activate=()=>{if(e.proxyManager){const c=`setActive${zi(t.getProxyGroup().slice(0,-1))}`;e.proxyManager[c]&&e.proxyManager[c](t)}},e.propertyLinkSubscribers={},t.registerPropertyLinkForGC=(c,f)=>{f in e.propertyLinkSubscribers||(e.propertyLinkSubscribers[f]=[]),e.propertyLinkSubscribers[f].push(c)},t.gcPropertyLinks=c=>{const f=e.propertyLinkSubscribers[c]||[];for(;f.length;)f.pop().unbind(t)},e.propertyLinkMap={},t.getPropertyLink=function(c){let f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(e.propertyLinkMap[c])return e.propertyLinkMap[c];let u=null;const d=[];let h=0,p=!1;function g(w){let S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(p)return null;const T=[];let _=null;for(h=d.length;h--;){const I=d[h];I.instance===w?_=I:T.push(I)}if(!_)return null;const D=_.instance[`get${zi(_.propertyName)}`]();if(!Q1e(D,u)||S){for(u=D,p=!0;T.length;){const I=T.pop();I.instance.set({[I.propertyName]:u})}p=!1}return e.propertyLinkMap[c].persistent&&(e.propertyLinkMap[c].value=D),D}function m(w,S){const T=[];for(h=d.length;h--;){const _=d[h];_.instance===w&&(_.propertyName===S||S===void 0)&&(_.subscription.unsubscribe(),T.push(h))}for(;T.length;)d.splice(T.pop(),1)}function y(w,S){let T=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const _=w.onModified(g),D=d[0];return d.push({instance:w,propertyName:S,subscription:_}),T&&(e.propertyLinkMap[c].persistent&&e.propertyLinkMap[c].value!==void 0?w.set({[S]:e.propertyLinkMap[c].value}):D&&g(D.instance,!0)),{unsubscribe:()=>m(w,S)}}function v(){for(;d.length;)d.pop().subscription.unsubscribe()}const x={bind:y,unbind:m,unsubscribe:v,persistent:f};return e.propertyLinkMap[c]=x,x};function s(){let c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:H5;const f=[],u=e.proxyId,d=o(c)||[];for(let h=0;h<d.length;h++){const p=d[h],g=t[`get${zi(p)}`],m=g?g():void 0,y={id:u,name:p,value:m},v=s(p);v.length&&(y.children=v),f.push(y)}return f}t.listPropertyNames=()=>s().map(c=>c.name),t.getPropertyByName=c=>s().find(f=>f.name===c),t.getPropertyDomainByName=c=>(r[c]||{}).domain,t.getProxySection=()=>({id:e.proxyId,name:e.proxyGroup,ui:e.ui,properties:s()}),t.delete=()=>{const c=Object.keys(e.propertyLinkMap);let f=c.length;for(;f--;)e.propertyLinkMap[c[f]].unsubscribe();Object.keys(e.propertyLinkSubscribers).forEach(t.gcPropertyLinks),n()},t.getState=()=>null;function l(){if(e.links)for(let c=0;c<e.links.length;c++){const{link:f,property:u,persistent:d,updateOnBind:h,type:p}=e.links[c];if(p==="application"){const g=e.proxyManager.getPropertyLink(f,d);t.registerPropertyLinkForGC(g,"application"),g.bind(t,u,h)}}}C9(l)}function xH(t,e,n){const r=t.delete,i=[],a=Object.keys(n);let o=a.length;for(;o--;){const s=a[o],{modelKey:l,property:c,modified:f=!0}=n[s],u=zi(c),d=zi(s);t[`get${d}`]=e[l][`get${u}`],t[`set${d}`]=e[l][`set${u}`],f&&i.push(e[l].onModified(t.modified))}t.delete=()=>{for(;i.length;)i.pop().unsubscribe();r()}}function bH(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};e.this=t;function i(s){const l=Object.keys(s);let c=l.length;for(;c--;){const f=l[c];e[f].set(s[f])}}const a=Object.keys(r);let o=a.length;for(;o--;){const s=a[o];e[s]=r[s];const l=n[s];t[`set${zi(s)}`]=c=>{if(c!==e[s]){e[s]=c;const f=l[c];i(f),t.modified()}}}a.length&&Po(t,e,a)}const GN=10,jN=40,zN=800;function wH(t){let e=0,n=0,r=0,i=0;return"detail"in t&&(n=t.detail),"wheelDelta"in t&&(n=-t.wheelDelta/120),"wheelDeltaY"in t&&(n=-t.wheelDeltaY/120),"wheelDeltaX"in t&&(e=-t.wheelDeltaX/120),"axis"in t&&t.axis===t.HORIZONTAL_AXIS&&(e=n,n=0),r=e*GN,i=n*GN,"deltaY"in t&&(i=t.deltaY),"deltaX"in t&&(r=t.deltaX),(r||i)&&t.deltaMode&&(t.deltaMode===1?(r*=jN,i*=jN):(r*=zN,i*=zN)),r&&!e&&(e=r<1?-1:1),i&&!n&&(n=i<1?-1:1),{spinX:e,spinY:n||e,pixelX:r,pixelY:i||r}}var le={algo:E9,capitalize:Uw,chain:Q2,debounce:mH,enumToString:eve,event:D9,EVENT_ABORT:_9,formatBytesToProperUnit:uH,formatNumbersWithThousandSeparator:fH,get:Po,getArray:Pm,getCurrentGlobalMTime:Y1e,getStateArrayMapFunc:hH,isVtkObject:O9,keystore:M9,measurePromiseExecution:pH,moveToProtected:Z2,newInstance:Zn,newTypedArray:Am,newTypedArrayFrom:Fw,normalizeWheel:wH,obj:$r,proxy:yH,proxyPropertyMapping:xH,proxyPropertyState:bH,safeArrays:dH,set:J2,setArray:S9,setGet:Mi,setGetArray:T9,setImmediate:C9,setLoggerFunction:aH,throttle:vH,traverseInstanceTree:r3,TYPED_ARRAYS:Ro,uncapitalize:cH,VOID:rH,vtkDebugMacro:n3,vtkErrorMacro:Bn,vtkInfoMacro:sH,vtkLogMacro:oH,vtkOnceErrorMacro:lH,vtkWarningMacro:Vw,objectSetterMap:gH},po=Object.freeze({__proto__:null,VOID:rH,setLoggerFunction:aH,vtkLogMacro:oH,vtkInfoMacro:sH,vtkDebugMacro:n3,vtkErrorMacro:Bn,vtkWarningMacro:Vw,vtkOnceErrorMacro:lH,TYPED_ARRAYS:Ro,newTypedArray:Am,newTypedArrayFrom:Fw,capitalize:Uw,_capitalize:zi,uncapitalize:cH,formatBytesToProperUnit:uH,formatNumbersWithThousandSeparator:fH,setImmediateVTK:C9,measurePromiseExecution:pH,obj:$r,get:Po,set:J2,setGet:Mi,getArray:Pm,setArray:S9,setGetArray:T9,moveToProtected:Z2,algo:E9,EVENT_ABORT:_9,event:D9,newInstance:Zn,chain:Q2,isVtkObject:O9,traverseInstanceTree:r3,debounce:mH,throttle:vH,keystore:M9,proxy:yH,proxyPropertyMapping:xH,proxyPropertyState:bH,normalizeWheel:wH,default:le}),Zx={exports:{}},rve=Zx.exports,WN;function ive(){return WN||(WN=1,(function(t){(function(e,n,r){function i(l){var c=this,f=s();c.next=function(){var u=2091639*c.s0+c.c*23283064365386963e-26;return c.s0=c.s1,c.s1=c.s2,c.s2=u-(c.c=u|0)},c.c=1,c.s0=f(" "),c.s1=f(" "),c.s2=f(" "),c.s0-=f(l),c.s0<0&&(c.s0+=1),c.s1-=f(l),c.s1<0&&(c.s1+=1),c.s2-=f(l),c.s2<0&&(c.s2+=1),f=null}function a(l,c){return c.c=l.c,c.s0=l.s0,c.s1=l.s1,c.s2=l.s2,c}function o(l,c){var f=new i(l),u=c&&c.state,d=f.next;return d.int32=function(){return f.next()*4294967296|0},d.double=function(){return d()+(d()*2097152|0)*11102230246251565e-32},d.quick=d,u&&(typeof u=="object"&&a(u,f),d.state=function(){return a(f,{})}),d}function s(){var l=4022871197,c=function(f){f=String(f);for(var u=0;u<f.length;u++){l+=f.charCodeAt(u);var d=.02519603282416938*l;l=d>>>0,d-=l,d*=l,l=d>>>0,d-=l,l+=d*4294967296}return(l>>>0)*23283064365386963e-26};return c}n&&n.exports?n.exports=o:this.alea=o})(rve,t)})(Zx)),Zx.exports}var Qx={exports:{}},ave=Qx.exports,HN;function ove(){return HN||(HN=1,(function(t){(function(e,n,r){function i(s){var l=this,c="";l.x=0,l.y=0,l.z=0,l.w=0,l.next=function(){var u=l.x^l.x<<11;return l.x=l.y,l.y=l.z,l.z=l.w,l.w^=l.w>>>19^u^u>>>8},s===(s|0)?l.x=s:c+=s;for(var f=0;f<c.length+64;f++)l.x^=c.charCodeAt(f)|0,l.next()}function a(s,l){return l.x=s.x,l.y=s.y,l.z=s.z,l.w=s.w,l}function o(s,l){var c=new i(s),f=l&&l.state,u=function(){return(c.next()>>>0)/4294967296};return u.double=function(){do var d=c.next()>>>11,h=(c.next()>>>0)/4294967296,p=(d+h)/(1<<21);while(p===0);return p},u.int32=c.next,u.quick=u,f&&(typeof f=="object"&&a(f,c),u.state=function(){return a(c,{})}),u}n&&n.exports?n.exports=o:this.xor128=o})(ave,t)})(Qx)),Qx.exports}var eb={exports:{}},sve=eb.exports,KN;function lve(){return KN||(KN=1,(function(t){(function(e,n,r){function i(s){var l=this,c="";l.next=function(){var u=l.x^l.x>>>2;return l.x=l.y,l.y=l.z,l.z=l.w,l.w=l.v,(l.d=l.d+362437|0)+(l.v=l.v^l.v<<4^(u^u<<1))|0},l.x=0,l.y=0,l.z=0,l.w=0,l.v=0,s===(s|0)?l.x=s:c+=s;for(var f=0;f<c.length+64;f++)l.x^=c.charCodeAt(f)|0,f==c.length&&(l.d=l.x<<10^l.x>>>4),l.next()}function a(s,l){return l.x=s.x,l.y=s.y,l.z=s.z,l.w=s.w,l.v=s.v,l.d=s.d,l}function o(s,l){var c=new i(s),f=l&&l.state,u=function(){return(c.next()>>>0)/4294967296};return u.double=function(){do var d=c.next()>>>11,h=(c.next()>>>0)/4294967296,p=(d+h)/(1<<21);while(p===0);return p},u.int32=c.next,u.quick=u,f&&(typeof f=="object"&&a(f,c),u.state=function(){return a(c,{})}),u}n&&n.exports?n.exports=o:this.xorwow=o})(sve,t)})(eb)),eb.exports}var tb={exports:{}},cve=tb.exports,qN;function uve(){return qN||(qN=1,(function(t){(function(e,n,r){function i(s){var l=this;l.next=function(){var f=l.x,u=l.i,d,h;return d=f[u],d^=d>>>7,h=d^d<<24,d=f[u+1&7],h^=d^d>>>10,d=f[u+3&7],h^=d^d>>>3,d=f[u+4&7],h^=d^d<<7,d=f[u+7&7],d=d^d<<13,h^=d^d<<9,f[u]=h,l.i=u+1&7,h};function c(f,u){var d,h=[];if(u===(u|0))h[0]=u;else for(u=""+u,d=0;d<u.length;++d)h[d&7]=h[d&7]<<15^u.charCodeAt(d)+h[d+1&7]<<13;for(;h.length<8;)h.push(0);for(d=0;d<8&&h[d]===0;++d);for(d==8?h[7]=-1:h[d],f.x=h,f.i=0,d=256;d>0;--d)f.next()}c(l,s)}function a(s,l){return l.x=s.x.slice(),l.i=s.i,l}function o(s,l){s==null&&(s=+new Date);var c=new i(s),f=l&&l.state,u=function(){return(c.next()>>>0)/4294967296};return u.double=function(){do var d=c.next()>>>11,h=(c.next()>>>0)/4294967296,p=(d+h)/(1<<21);while(p===0);return p},u.int32=c.next,u.quick=u,f&&(f.x&&a(f,c),u.state=function(){return a(c,{})}),u}n&&n.exports?n.exports=o:this.xorshift7=o})(cve,t)})(tb)),tb.exports}var nb={exports:{}},fve=nb.exports,XN;function dve(){return XN||(XN=1,(function(t){(function(e,n,r){function i(s){var l=this;l.next=function(){var f=l.w,u=l.X,d=l.i,h,p;return l.w=f=f+1640531527|0,p=u[d+34&127],h=u[d=d+1&127],p^=p<<13,h^=h<<17,p^=p>>>15,h^=h>>>12,p=u[d]=p^h,l.i=d,p+(f^f>>>16)|0};function c(f,u){var d,h,p,g,m,y=[],v=128;for(u===(u|0)?(h=u,u=null):(u=u+"\0",h=0,v=Math.max(v,u.length)),p=0,g=-32;g<v;++g)u&&(h^=u.charCodeAt((g+32)%u.length)),g===0&&(m=h),h^=h<<10,h^=h>>>15,h^=h<<4,h^=h>>>13,g>=0&&(m=m+1640531527|0,d=y[g&127]^=h+m,p=d==0?p+1:0);for(p>=128&&(y[(u&&u.length||0)&127]=-1),p=127,g=512;g>0;--g)h=y[p+34&127],d=y[p=p+1&127],h^=h<<13,d^=d<<17,h^=h>>>15,d^=d>>>12,y[p]=h^d;f.w=m,f.X=y,f.i=p}c(l,s)}function a(s,l){return l.i=s.i,l.w=s.w,l.X=s.X.slice(),l}function o(s,l){s==null&&(s=+new Date);var c=new i(s),f=l&&l.state,u=function(){return(c.next()>>>0)/4294967296};return u.double=function(){do var d=c.next()>>>11,h=(c.next()>>>0)/4294967296,p=(d+h)/(1<<21);while(p===0);return p},u.int32=c.next,u.quick=u,f&&(f.X&&a(f,c),u.state=function(){return a(c,{})}),u}n&&n.exports?n.exports=o:this.xor4096=o})(fve,t)})(nb)),nb.exports}var rb={exports:{}},hve=rb.exports,YN;function pve(){return YN||(YN=1,(function(t){(function(e,n,r){function i(s){var l=this,c="";l.next=function(){var u=l.b,d=l.c,h=l.d,p=l.a;return u=u<<25^u>>>7^d,d=d-h|0,h=h<<24^h>>>8^p,p=p-u|0,l.b=u=u<<20^u>>>12^d,l.c=d=d-h|0,l.d=h<<16^d>>>16^p,l.a=p-u|0},l.a=0,l.b=0,l.c=-1640531527,l.d=1367130551,s===Math.floor(s)?(l.a=s/4294967296|0,l.b=s|0):c+=s;for(var f=0;f<c.length+20;f++)l.b^=c.charCodeAt(f)|0,l.next()}function a(s,l){return l.a=s.a,l.b=s.b,l.c=s.c,l.d=s.d,l}function o(s,l){var c=new i(s),f=l&&l.state,u=function(){return(c.next()>>>0)/4294967296};return u.double=function(){do var d=c.next()>>>11,h=(c.next()>>>0)/4294967296,p=(d+h)/(1<<21);while(p===0);return p},u.int32=c.next,u.quick=u,f&&(typeof f=="object"&&a(f,c),u.state=function(){return a(c,{})}),u}n&&n.exports?n.exports=o:this.tychei=o})(hve,t)})(rb)),rb.exports}var ib={exports:{}};const gve={},mve=Object.freeze(Object.defineProperty({__proto__:null,default:gve},Symbol.toStringTag,{value:"Module"})),Nf=nU(mve);var vve=ib.exports,JN;function yve(){return JN||(JN=1,(function(t){(function(e,n,r){var i=256,a=6,o=52,s="random",l=r.pow(i,a),c=r.pow(2,o),f=c*2,u=i-1,d;function h(w,S,T){var _=[];S=S==!0?{entropy:!0}:S||{};var D=y(m(S.entropy?[w,x(n)]:w??v(),3),_),I=new p(_),R=function(){for(var M=I.g(a),A=l,L=0;M<c;)M=(M+L)*i,A*=i,L=I.g(1);for(;M>=f;)M/=2,A/=2,L>>>=1;return(M+L)/A};return R.int32=function(){return I.g(4)|0},R.quick=function(){return I.g(4)/4294967296},R.double=R,y(x(I.S),n),(S.pass||T||function(M,A,L,P){return P&&(P.S&&g(P,I),M.state=function(){return g(I,{})}),L?(r[s]=M,A):M})(R,D,"global"in S?S.global:this==r,S.state)}function p(w){var S,T=w.length,_=this,D=0,I=_.i=_.j=0,R=_.S=[];for(T||(w=[T++]);D<i;)R[D]=D++;for(D=0;D<i;D++)R[D]=R[I=u&I+w[D%T]+(S=R[D])],R[I]=S;(_.g=function(M){for(var A,L=0,P=_.i,B=_.j,U=_.S;M--;)A=U[P=u&P+1],L=L*i+U[u&(U[P]=U[B=u&B+A])+(U[B]=A)];return _.i=P,_.j=B,L})(i)}function g(w,S){return S.i=w.i,S.j=w.j,S.S=w.S.slice(),S}function m(w,S){var T=[],_=typeof w,D;if(S&&_=="object")for(D in w)try{T.push(m(w[D],S-1))}catch{}return T.length?T:_=="string"?w:w+"\0"}function y(w,S){for(var T=w+"",_,D=0;D<T.length;)S[u&D]=u&(_^=S[u&D]*19)+T.charCodeAt(D++);return x(S)}function v(){try{var w;return d&&(w=d.randomBytes)?w=w(i):(w=new Uint8Array(i),(e.crypto||e.msCrypto).getRandomValues(w)),x(w)}catch{var S=e.navigator,T=S&&S.plugins;return[+new Date,e,T,e.screen,x(n)]}}function x(w){return String.fromCharCode.apply(0,w)}if(y(r.random(),n),t.exports){t.exports=h;try{d=Nf}catch{}}else r["seed"+s]=h})(typeof self<"u"?self:vve,[],Math)})(ib)),ib.exports}var kT,ZN;function xve(){if(ZN)return kT;ZN=1;var t=ive(),e=ove(),n=lve(),r=uve(),i=dve(),a=pve(),o=yve();return o.alea=t,o.xor128=e,o.xorwow=n,o.xorshift7=r,o.xor4096=i,o.tychei=a,kT=o,kT}var bve=xve();const wve=tl(bve),I9=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Cve=[1,0,0,0,1,0,0,0,1],R9=1e-6,A9=1e-12,{vtkErrorMacro:CH,vtkWarningMacro:Kh}=le;let SH=0;const QN=20;function ey(t){return()=>CH(`vtkMath::${t} - NOT IMPLEMENTED`)}function Nv(t,e,n,r){let i;for(let a=0;a<e;a++)i=t[n*e+a],t[n*e+a]=t[r*e+a],t[r*e+a]=i}function dv(t,e,n,r){let i;for(let a=0;a<e;a++)i=t[a*e+n],t[a*e+n]=t[a*e+r],t[a*e+r]=i}function Qr(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:3;const e=Array(t);for(let n=0;n<t;++n)e[n]=0;return e}const Sve=()=>Math.PI;function Tve(t,e){return e>1023?t*2**1023*2**(e-1023):e<-1074?t*2**-1074*2**(e+1074):t*2**e}function wi(t){return t/180*Math.PI}function i3(t){return t*180/Math.PI}const{round:hv,floor:P9,ceil:Eve,min:_ve,max:Dve}=Math;function Ove(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,r=1/0;for(let i=e,a=t.length;i<a;i+=n)t[i]<r&&(r=t[i]);return r}function Mve(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,r=-1/0;for(let i=e,a=t.length;i<a;i+=n)r<t[i]&&(r=t[i]);return r}function Ive(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,r=1/0,i=-1/0;for(let a=e,o=t.length;a<o;a+=n)t[a]<r&&(r=t[a]),i<t[a]&&(i=t[a]);return[r,i]}const Rve=ey("ceilLog2"),Ave=ey("factorial");function Dl(t){let e=1;for(;e<t;)e*=2;return e}function pv(t){return t===Dl(t)}function Pve(t,e){let n=1;for(let r=1;r<=e;++r)n*=(t-r+1)/r;return Math.floor(n)}function Nve(t,e){if(t<e)return 0;const n=Qr(e);for(let r=0;r<e;++r)n[r]=r;return n}function Lve(t,e,n){let r=0;for(let i=e-1;i>=0;--i)if(n[i]<t-e+i){let a=n[i]+1;for(;i<e;)n[i++]=a++;r=1;break}return r}function kve(t){wve(`${t}`,{global:!0}),SH=t}function Vve(){return SH}function Fve(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;const n=(arguments.length>1&&arguments[1]!==void 0?arguments[1]:1)-t;return t+n*Math.random()}const Uve=ey("gaussian");function a3(t,e,n){return n[0]=t[0]+e[0],n[1]=t[1]+e[1],n[2]=t[2]+e[2],n}function Tf(t,e,n){return n[0]=t[0]-e[0],n[1]=t[1]-e[1],n[2]=t[2]-e[2],n}function TH(t,e){return t[0]*=e,t[1]*=e,t[2]*=e,t}function EH(t,e){return t[0]*=e,t[1]*=e,t}function o6(t,e,n,r){return r[0]=t[0]+e[0]*n,r[1]=t[1]+e[1]*n,r[2]=t[2]+e[2]*n,r}function Bve(t,e,n,r){return r[0]=t[0]+e[0]*n,r[1]=t[1]+e[1]*n,r}function An(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function $ve(t,e,n){n[0]=t[0]*e[0],n[1]=t[0]*e[1],n[2]=t[0]*e[2],n[3]=t[1]*e[0],n[4]=t[1]*e[1],n[5]=t[1]*e[2],n[6]=t[2]*e[0],n[7]=t[2]*e[1],n[8]=t[2]*e[2]}function gu(t,e,n){const r=t[1]*e[2]-t[2]*e[1],i=t[2]*e[0]-t[0]*e[2],a=t[0]*e[1]-t[1]*e[0];return n[0]=r,n[1]=i,n[2]=a,n}function qd(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:3;switch(e){case 1:return Math.abs(t);case 2:return Math.sqrt(t[0]*t[0]+t[1]*t[1]);case 3:return Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);default:{let n=0;for(let r=0;r<e;r++)n+=t[r]*t[r];return Math.sqrt(n)}}}function qh(t){const e=qd(t);return e!==0&&(t[0]/=e,t[1]/=e,t[2]/=e),e}function Gve(t,e,n,r){const i=t[0]*t[0],a=t[1]*t[1],o=t[2]*t[2],s=Math.sqrt(i+a+o);let l,c,f;i>a&&i>o?(l=0,c=1,f=2):a>o?(l=1,c=2,f=0):(l=2,c=0,f=1);const u=t[l]/s,d=t[c]/s,h=t[f]/s,p=Math.sqrt(u*u+h*h);if(r!==0){const g=Math.sin(r),m=Math.cos(r);e&&(e[l]=(h*m-u*d*g)/p,e[c]=g*p,e[f]=(-(u*m)-d*h*g)/p),n&&(n[l]=(-(h*g)-u*d*m)/p,n[c]=m*p,n[f]=(u*g-d*h*m)/p)}else e&&(e[l]=h/p,e[c]=0,e[f]=-u/p),n&&(n[l]=-u*d/p,n[c]=p,n[f]=-d*h/p)}function jve(t,e,n){const r=An(e,e);if(r===0)return n[0]=0,n[1]=0,n[2]=0,!1;const i=An(t,e)/r;for(let a=0;a<3;a++)n[a]=e[a];return TH(n,i),!0}function s6(t,e){return t[0]*e[0]+t[1]*e[1]}function zve(t,e,n){const r=s6(e,e);if(r===0)return n[0]=0,n[1]=0,!1;const i=s6(t,e)/r;for(let a=0;a<2;a++)n[a]=e[a];return EH(n,i),!0}function Hc(t,e){return(t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1])+(t[2]-e[2])*(t[2]-e[2])}function Wve(t,e){const n=[0,0,0];return gu(t,e,n),Math.atan2(qd(n),An(t,e))}function Hve(t,e,n){const r=Math.abs(t-n);return 1/Math.sqrt(2*Math.PI*e)*Math.exp(-(r**2)/(2*e))}function Kve(t,e,n){const r=Math.abs(t-n);return Math.exp(-(r**2)/(2*e))}function qve(t,e,n){n[0]=t[0]*e[0],n[1]=t[0]*e[1],n[2]=t[1]*e[0],n[3]=t[1]*e[1]}function _H(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function DH(t){const e=_H(t);return e!==0&&(t[0]/=e,t[1]/=e),e}function Si(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.length===2?e[0][0]*e[1][1]-e[1][0]*e[0][1]:e.length===4?e[0]*e[3]-e[1]*e[2]:Number.NaN}function Xve(t,e){let n,r,i;const a=[0,0,0];for(let o=0;o<3;o++)i=Math.abs(t[o*3]),(r=Math.abs(t[o*3+1]))>i&&(i=r),(r=Math.abs(t[o*3+2]))>i&&(i=r),a[o]=1/i;i=a[0]*Math.abs(t[0]),n=0,(r=a[1]*Math.abs(t[3]))>=i&&(i=r,n=1),(r=a[2]*Math.abs(t[6]))>=i&&(n=2),n!==0&&(Nv(t,3,n,0),a[n]=a[0]),e[0]=n,t[3]/=t[0],t[6]/=t[0],t[4]-=t[3]*t[1],t[7]-=t[6]*t[1],i=a[1]*Math.abs(t[4]),n=1,(r=a[2]*Math.abs(t[7]))>=i&&(n=2,Nv(t,3,1,2),a[2]=a[1]),e[1]=n,t[7]/=t[4],t[5]-=t[3]*t[2],t[8]-=t[6]*t[2]+t[7]*t[5],e[2]=2}function Yve(t,e,n){let r=n[e[0]];n[e[0]]=n[0],n[0]=r,r=n[e[1]],n[e[1]]=n[1],n[1]=r-t[3]*n[0],r=n[e[2]],n[e[2]]=n[2],n[2]=r-t[6]*n[0]-t[7]*n[1],n[2]/=t[8],n[1]=(n[1]-t[5]*n[2])/t[4],n[0]=(n[0]-t[1]*n[1]-t[2]*n[2])/t[0]}function Jve(t,e,n){const r=t[0],i=t[1],a=t[2],o=t[3],s=t[4],l=t[5],c=t[6],f=t[7],u=t[8],d=+Si(s,f,l,u),h=-Si(o,c,l,u),p=+Si(o,c,s,f),g=-Si(i,f,a,u),m=+Si(r,c,a,u),y=-Si(r,c,i,f),v=+Si(i,s,a,l),x=-Si(r,o,a,l),w=+Si(r,o,i,s),S=r*d+i*h+a*p,T=d*e[0]+g*e[1]+v*e[2],_=h*e[0]+m*e[1]+x*e[2],D=p*e[0]+y*e[1]+w*e[2];n[0]=T/S,n[1]=_/S,n[2]=D/S}function ab(t,e,n){const r=t[0]*e[0]+t[1]*e[1]+t[2]*e[2],i=t[3]*e[0]+t[4]*e[1]+t[5]*e[2],a=t[6]*e[0]+t[7]*e[1]+t[8]*e[2];n[0]=r,n[1]=i,n[2]=a}function l6(t,e,n){const r=[...t],i=[...e];for(let a=0;a<3;a++)n[a]=r[0]*i[a]+r[1]*i[a+3]+r[2]*i[a+6],n[a+3]=r[3]*i[a]+r[4]*i[a+3]+r[5]*i[a+6],n[a+6]=r[6]*i[a]+r[7]*i[a+3]+r[8]*i[a+6]}function Zve(t,e,n,r,i,a,o){r!==i&&CH("Number of columns of A must match number of rows of B.");const s=[...t],l=[...e];for(let c=0;c<n;c++)for(let f=0;f<a;f++){o[c*a+f]=0;for(let u=0;u<r;u++)o[c*a+f]+=s[c*r+u]*l[f+a*u]}}function $g(t,e){let n;n=t[3],e[3]=t[1],e[1]=n,n=t[6],e[6]=t[2],e[2]=n,n=t[7],e[7]=t[5],e[5]=n,e[0]=t[0],e[4]=t[4],e[8]=t[8]}function Qve(t,e){const n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],s=t[5],l=t[6],c=t[7],f=t[8],u=+Si(o,c,s,f),d=-Si(a,l,s,f),h=+Si(a,l,o,c),p=-Si(r,c,i,f),g=+Si(n,l,i,f),m=-Si(n,l,r,c),y=+Si(r,o,i,s),v=-Si(n,a,i,s),x=+Si(n,a,r,o),w=n*u+r*d+i*h;w===0&&Kh("Matrix has 0 determinant"),e[0]=u/w,e[3]=d/w,e[6]=h/w,e[1]=p/w,e[4]=g/w,e[7]=m/w,e[2]=y/w,e[5]=v/w,e[8]=x/w}function Bw(t){return t[0]*t[4]*t[8]+t[3]*t[7]*t[2]+t[6]*t[1]*t[5]-t[0]*t[7]*t[5]-t[3]*t[1]*t[8]-t[6]*t[4]*t[2]}function OH(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:R9;if(t.length!==e.length)return!1;function r(i,a){return Math.abs(i-e[a])<=n}return t.every(r)}const ty=OH;function MH(t){for(let e=0;e<3;e++)t[e*3]=t[e*3+1]=t[e*3+2]=0,t[e*3+e]=1}function IH(t,e){for(let n=0;n<t;n++){for(let r=0;r<t;r++)e[n*t+r]=0;e[n*t+n]=1}return e}function e2e(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:R9;return ty(t,I9,e)}function t2e(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:R9;return ty(t,Cve,e)}function RH(t,e){const n=t[0]*t[0],r=t[0]*t[1],i=t[0]*t[2],a=t[0]*t[3],o=t[1]*t[1],s=t[2]*t[2],l=t[3]*t[3],c=t[1]*t[2],f=t[1]*t[3],u=t[2]*t[3],d=o+s+l;let h=1/(n+d);const p=(n-d)*h;h*=2,e[0]=o*h+p,e[3]=(c+a)*h,e[6]=(f-i)*h,e[1]=(c-a)*h,e[4]=s*h+p,e[7]=(u+r)*h,e[2]=(f+i)*h,e[5]=(u-r)*h,e[8]=l*h+p}function ob(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(!`${t}`.includes("e"))return+`${Math.round(`${t}e+${e}`)}e-${e}`;const n=`${t}`.split("e");let r="";return+n[1]+e>0&&(r="+"),+`${Math.round(`${+n[0]}e${r}${+n[1]+e}`)}e-${e}`}function c6(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return e[0]=ob(t[0],n),e[1]=ob(t[1],n),e[2]=ob(t[2],n),e}function ny(t,e,n,r){let i,a,o,s,l,c,f,u,d,h,p,g,m,y,v,x;const w=Qr(e),S=Qr(e),T=(D,I,R)=>{y=D[I],m=D[R],D[I]=y-g*(m+y*h),D[R]=m+g*(y-m*h)};for(IH(e,r),l=0;l<e;l++)w[l]=n[l]=t[l+l*e],S[l]=0;for(i=0;i<QN;i++){for(p=0,l=0;l<e-1;l++)for(s=l+1;s<e;s++)p+=Math.abs(t[l*e+s]);if(p===0)break;for(i<3?f=.2*p/(e*e):f=0,l=0;l<e-1;l++)for(s=l+1;s<e;s++)if(y=100*Math.abs(t[l*e+s]),i>3&&Math.abs(n[l])+y===Math.abs(n[l])&&Math.abs(n[s])+y===Math.abs(n[s]))t[l*e+s]=0;else if(Math.abs(t[l*e+s])>f){for(m=n[s]-n[l],Math.abs(m)+y===Math.abs(m)?d=t[l*e+s]/m:(u=.5*m/t[l*e+s],d=1/(Math.abs(u)+Math.sqrt(1+u*u)),u<0&&(d=-d)),v=1/Math.sqrt(1+d*d),g=d*v,h=g/(1+v),m=d*t[l*e+s],S[l]-=m,S[s]+=m,n[l]-=m,n[s]+=m,t[l*e+s]=0,a=0;a<=l-1;a++)T(t,a*e+l,a*e+s);for(a=l+1;a<=s-1;a++)T(t,l*e+a,a*e+s);for(a=s+1;a<e;a++)T(t,l*e+a,s*e+a);for(a=0;a<e;a++)T(r,a*e+l,a*e+s)}for(l=0;l<e;l++)w[l]+=S[l],n[l]=w[l],S[l]=0}if(i>=QN)return Kh("vtkMath::Jacobi: Error extracting eigenfunctions"),0;for(a=0;a<e-1;a++){for(o=a,x=n[o],i=a+1;i<e;i++)(n[i]>=x||Math.abs(n[i]-x)<A9)&&(o=i,x=n[o]);o!==a&&(n[o]=n[a],n[a]=x,dv(r,e,a,o))}const _=(e>>1)+(e&1);for(c=0,i=0;i<e*e;i++)r[i]>=0&&c++;if(c<_)for(i=0;i<e;i++)r[i*e+a]*=-1;return 1}function AH(t,e){const n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];n[0]=t[0]+t[4]+t[8],n[5]=t[0]-t[4]-t[8],n[10]=-t[0]+t[4]-t[8],n[15]=-t[0]-t[4]+t[8],n[1]=n[4]=t[7]-t[5],n[2]=n[8]=t[2]-t[6],n[3]=n[12]=t[3]-t[1],n[6]=n[9]=t[3]+t[1],n[7]=n[13]=t[2]+t[6],n[11]=n[14]=t[7]+t[5];const r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],i=[0,0,0,0],a=[...n];ny(a,4,i,r),e[0]=r[0],e[1]=r[4],e[2]=r[8],e[3]=r[12]}function n2e(t,e,n){const r=t[0]*e[0],i=t[0]*e[1],a=t[0]*e[2],o=t[0]*e[3],s=t[1]*e[0],l=t[1]*e[1],c=t[1]*e[2],f=t[1]*e[3],u=t[2]*e[0],d=t[2]*e[1],h=t[2]*e[2],p=t[2]*e[3],g=t[3]*e[0],m=t[3]*e[1],y=t[3]*e[2],v=t[3]*e[3];n[0]=r-l-h-v,n[1]=i+s+p-y,n[2]=a-f+u+m,n[3]=o+c-d+g}function PH(t,e){for(let d=0;d<9;d++)e[d]=t[d];const n=Qr(3),r=Qr(3);let i;for(let d=0;d<3;d++){const h=Math.abs(e[d*3]),p=Math.abs(e[d*3+1]),g=Math.abs(e[d*3+2]);i=p>h?p:h,i=g>i?g:i,n[d]=1,i!==0&&(n[d]/=i)}const a=Math.abs(e[0])*n[0],o=Math.abs(e[3])*n[1],s=Math.abs(e[6])*n[2];r[0]=0,i=a,o>=i&&(i=o,r[0]=1),s>=i&&(r[0]=2),r[0]!==0&&(dv(e,3,r[0],0),n[r[0]]=n[0]);const l=Math.abs(e[4])*n[1],c=Math.abs(e[7])*n[2];r[1]=1,i=l,c>=i&&(r[1]=2,dv(e,3,1,2)),r[2]=2;let f=0;if(Bw(e)<0){f=1;for(let d=0;d<9;d++)e[d]=-e[d]}const u=Qr(4);if(AH(e,u),RH(u,e),f)for(let d=0;d<9;d++)e[d]=-e[d];r[1]!==1&&dv(e,3,r[1],1),r[0]!==0&&dv(e,3,r[0],0)}function NH(t,e,n){let r,i,a,o,s,l;const c=[...t];if(ny(c,3,e,n),e[0]===e[1]&&e[0]===e[2]){MH(n);return}for($g(n,n),r=0;r<3;r++)if(e[(r+1)%3]===e[(r+2)%3]){for(l=Math.abs(n[r*3]),o=0,i=1;i<3;i++)l<(s=Math.abs(n[r*3+i]))&&(l=s,o=i);o!==r&&(s=e[o],e[o]=e[r],e[r]=s,Nv(n,3,r,o)),n[o*3+o]<0&&(n[o*3]=-n[o*3],n[o*3+1]=-n[o*3+1],n[o*3+2]=-n[o*3+2]),i=(o+1)%3,a=(o+2)%3,n[i*3]=0,n[i*3+1]=0,n[i*3+2]=0,n[i*3+i]=1;const f=gu([n[o*3],n[o*3+1],n[o*3+2]],[n[i*3],n[i*3+1],n[i*3+2]],[]);qh(f);const u=gu(f,[n[o*3],n[o*3+1],n[o*3+2]],[]);for(let d=0;d<3;d++)n[a*3+d]=f[d],n[i*3+d]=u[d];$g(n,n);return}for(l=Math.abs(n[0]),o=0,r=1;r<3;r++)l<(s=Math.abs(n[r*3]))&&(l=s,o=r);if(o!==0){const f=e[o];e[o]=e[0],e[0]=f,Nv(n,3,o,0)}if(Math.abs(n[4])<Math.abs(n[7])){const f=e[2];e[2]=e[1],e[1]=f,Nv(n,3,1,2)}for(r=0;r<2;r++)n[r*3+r]<0&&(n[r*3]=-n[r*3],n[r*3+1]=-n[r*3+1],n[r*3+2]=-n[r*3+2]);Bw(n)<0&&(n[6]=-n[6],n[7]=-n[7],n[8]=-n[8]),$g(n,n)}function r2e(t,e,n,r){let i;const a=[...t],o=Bw(a);if(o<0)for(i=0;i<9;i++)a[i]=-a[i];PH(a,e),$g(a,a),l6(a,e,r),NH(r,n,r),l6(e,r,e),$g(r,r),o<0&&(n[0]=-n[0],n[1]=-n[1],n[2]=-n[2])}function N9(t,e,n){let r,i,a,o,s=0,l,c,f;const u=Qr(n);for(r=0;r<n;r++){for(o=0,i=0;i<n;i++)(f=Math.abs(t[r*n+i]))>o&&(o=f);if(o===0)return Kh("Unable to factor linear system"),0;u[r]=1/o}for(i=0;i<n;i++){for(r=0;r<i;r++){for(l=t[r*n+i],a=0;a<r;a++)l-=t[r*n+a]*t[a*n+i];t[r*n+i]=l}for(o=0,r=i;r<n;r++){for(l=t[r*n+i],a=0;a<i;a++)l-=t[r*n+a]*t[a*n+i];t[r*n+i]=l,(c=u[r]*Math.abs(l))>=o&&(o=c,s=r)}if(i!==s){for(a=0;a<n;a++)c=t[s*n+a],t[s*n+a]=t[i*n+a],t[i*n+a]=c;u[s]=u[i]}if(e[i]=s,Math.abs(t[i*n+i])<=A9)return Kh("Unable to factor linear system"),0;if(i!==n-1)for(c=1/t[i*n+i],r=i+1;r<n;r++)t[r*n+i]*=c}return 1}function L9(t,e,n,r){let i,a,o,s,l;for(o=-1,i=0;i<r;i++){if(s=e[i],l=n[s],n[s]=n[i],o>=0)for(a=o;a<=i-1;a++)l-=t[i*r+a]*n[a];else l!==0&&(o=i);n[i]=l}for(i=r-1;i>=0;i--){for(l=n[i],a=i+1;a<r;a++)l-=t[i*r+a]*n[a];n[i]=l/t[i*r+i]}}function LH(t,e,n){if(n===2){const i=Qr(2),a=Si(t[0],t[1],t[2],t[3]);return a===0?0:(i[0]=(t[3]*e[0]-t[1]*e[1])/a,i[1]=(-(t[2]*e[0])+t[0]*e[1])/a,e[0]=i[0],e[1]=i[1],1)}if(n===1)return t[0]===0?0:(e[0]/=t[0],1);const r=Qr(n);return N9(t,r,n)===0?0:(L9(t,r,e,n),1)}function kH(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null;const a=r||Qr(n),o=i||Qr(n);if(N9(t,a,n)===0)return null;for(let s=0;s<n;s++){for(let l=0;l<n;l++)o[l]=0;o[s]=1,L9(t,a,o,n);for(let l=0;l<n;l++)e[l*n+s]=o[l]}return e}function i2e(t,e){let n=+Number.MAX_VALUE,r=-Number.MAX_VALUE;for(let i=0;i<e;i++)for(let a=i;a<e;a++)Math.abs(t[i*e+a])>r&&(r=Math.abs(t[i*e+a]));for(let i=0;i<e;i++)Math.abs(t[i*e+i])<n&&(n=Math.abs(t[i*e+i]));return n===0?Number.MAX_VALUE:r/n}function a2e(t,e,n){return ny(t,3,e,n)}function u6(t,e,n,r){if(t<n)return Kh("Insufficient number of samples. Underdetermined."),0;let i,a,o;const s=Qr(n*n),l=Qr(n),c=Qr(n*n);for(o=0;o<t;o++)for(i=0;i<n;i++)for(a=i;a<n;a++)s[i*n+a]+=e[o*n+i]*e[o*n+a];for(i=0;i<n;i++)for(a=0;a<i;a++)s[i*n+a]=s[a*n+i];for(ny(s,n,l,c),i=0;i<n;i++)r[i]=c[i*n+n-1];return 1}function o2e(t,e,n,r,i,a){let o=arguments.length>6&&arguments[6]!==void 0?arguments[6]:!0;if(t<n||t<i)return Kh("Insufficient number of samples. Underdetermined."),0;const s=Qr(i);let l=1,c,f=0,u,d,h,p=0;if(o){for(d=0;d<i;d++)s[d]=1;for(u=0;u<t;u++)for(d=0;d<i;d++)Math.abs(r[u*i+d])>A9&&(l=0,s[d]=0);if(l&&i===1)return Kh("Detected homogeneous system (Y=0), calling SolveHomogeneousLeastSquares()"),u6(t,e,n,a);if(l)p=1;else for(d=0;d<i;d++)s[d]&&(p=1)}p&&(c=Qr(n),f=u6(t,e,n,c));const g=Qr(n*n),m=Qr(n*n),y=Qr(n*i);for(h=0;h<t;h++)for(u=0;u<n;u++){for(d=u;d<n;d++)g[u*n+d]+=e[h*n+u]*e[h*n+d];for(d=0;d<i;d++)y[u*i+d]+=e[h*n+u]*r[h*i+d]}for(u=0;u<n;u++)for(d=0;d<u;d++)g[u*n+d]=g[d*n+u];const v=kH(g,m,n);if(v)for(u=0;u<n;u++)for(d=0;d<i;d++)for(a[u*i+d]=0,h=0;h<n;h++)a[u*i+d]+=m[u*n+h]*y[h*i+d];if(p){for(d=0;d<i;d++)if(s[d])for(u=0;u<n;u++)a[u*i+d]=c[u*i]}return p?f&&v:v}function s2e(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,.5,1];switch(t.length){case 3:return e[0]=parseInt(t[0],16)*17/255,e[1]=parseInt(t[1],16)*17/255,e[2]=parseInt(t[2],16)*17/255,e;case 4:return e[0]=parseInt(t[1],16)*17/255,e[1]=parseInt(t[2],16)*17/255,e[2]=parseInt(t[3],16)*17/255,e;case 6:return e[0]=parseInt(t.substr(0,2),16)/255,e[1]=parseInt(t.substr(2,2),16)/255,e[2]=parseInt(t.substr(4,2),16)/255,e;case 7:return e[0]=parseInt(t.substr(1,2),16)/255,e[1]=parseInt(t.substr(3,2),16)/255,e[2]=parseInt(t.substr(5,2),16)/255,e;case 9:return e[0]=parseInt(t.substr(1,2),16)/255,e[1]=parseInt(t.substr(3,2),16)/255,e[2]=parseInt(t.substr(5,2),16)/255,e[3]=parseInt(t.substr(7,2),16)/255,e;default:return e}}function gv(t,e){let n,r;const[i,a,o]=t,s=1/3,l=1/6,c=2/3;let f=i,u=i;a>f?f=a:a<u&&(u=a),o>f?f=o:o<u&&(u=o);const d=f;d>0?r=(f-u)/f:r=0,r>0?(i===f?n=l*(a-o)/(f-u):a===f?n=s+l*(o-i)/(f-u):n=c+l*(i-a)/(f-u),n<0&&(n+=1)):n=0,e[0]=n,e[1]=r,e[2]=d}function gh(t,e){const[n,r,i]=t,a=1/3,o=1/6,s=2/3,l=5/6;let c,f,u;n>o&&n<=a?(f=1,c=(a-n)/o,u=0):n>a&&n<=.5?(f=1,u=(n-a)/o,c=0):n>.5&&n<=s?(u=1,f=(s-n)/o,c=0):n>s&&n<=l?(u=1,c=(n-s)/o,f=0):n>l&&n<=1?(c=1,u=(1-n)/o,f=0):(c=1,f=n/o,u=0),c=r*c+(1-r),f=r*f+(1-r),u=r*u+(1-r),c*=i,f*=i,u*=i,e[0]=c,e[1]=f,e[2]=u}function VH(t,e){const[n,r,i]=t;let a=(n+16)/116,o=r/500+a,s=a-i/200;a**3>.008856?a**=3:a=(a-16/116)/7.787,o**3>.008856?o**=3:o=(o-16/116)/7.787,s**3>.008856?s**=3:s=(s-16/116)/7.787;const l=.9505,c=1,f=1.089;e[0]=l*o,e[1]=c*a,e[2]=f*s}function FH(t,e){const[n,r,i]=t,a=.9505,o=1,s=1.089;let l=n/a,c=r/o,f=i/s;l>.008856?l**=1/3:l=7.787*l+16/116,c>.008856?c**=1/3:c=7.787*c+16/116,f>.008856?f**=1/3:f=7.787*f+16/116,e[0]=116*c-16,e[1]=500*(l-c),e[2]=200*(c-f)}function UH(t,e){const[n,r,i]=t;let a=n*3.2406+r*-1.5372+i*-.4986,o=n*-.9689+r*1.8758+i*.0415,s=n*.0557+r*-.204+i*1.057;a>.0031308?a=1.055*a**(1/2.4)-.055:a*=12.92,o>.0031308?o=1.055*o**(1/2.4)-.055:o*=12.92,s>.0031308?s=1.055*s**(1/2.4)-.055:s*=12.92;let l=a;l<o&&(l=o),l<s&&(l=s),l>1&&(a/=l,o/=l,s/=l),a<0&&(a=0),o<0&&(o=0),s<0&&(s=0),e[0]=a,e[1]=o,e[2]=s}function BH(t,e){let[n,r,i]=t;n>.04045?n=((n+.055)/1.055)**2.4:n/=12.92,r>.04045?r=((r+.055)/1.055)**2.4:r/=12.92,i>.04045?i=((i+.055)/1.055)**2.4:i/=12.92,e[0]=n*.4124+r*.3576+i*.1805,e[1]=n*.2126+r*.7152+i*.0722,e[2]=n*.0193+r*.1192+i*.9505}function _h(t,e){const n=[0,0,0];BH(t,n),FH(n,e)}function o3(t,e){const n=[0,0,0];VH(t,n),UH(n,e)}function Nm(t){return t[0]=1,t[1]=-1,t[2]=1,t[3]=-1,t[4]=1,t[5]=-1,t}function sb(t){return!(t[1]-t[0]<0)}function l2e(t,e,n){return n[0]=Math.min(t[0],e[0]),n[1]=Math.max(t[0],e[0]),n[2]=Math.min(t[1],e[1]),n[3]=Math.max(t[1],e[1]),n[4]=Math.min(t[2],e[2]),n[5]=Math.max(t[2],e[2]),n}function pc(t,e,n){return t<e?e:t>n?n:t}function f6(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[0,0,0];return r[0]=pc(t[0],e[0],n[0]),r[1]=pc(t[1],e[1],n[1]),r[2]=pc(t[2],e[2],n[2]),r}function c2e(t,e){let n=0;return e[0]!==e[1]&&(t<e[0]?n=e[0]:t>e[1]?n=e[1]:n=t,n=(n-e[0])/(e[1]-e[0])),n}const u2e=ey("GetScalarTypeFittingRange"),f2e=ey("GetAdjustedScalarRange");function d2e(t,e){if(!t||!e)return 0;for(let n=0;n<6;n+=2)if(t[n]<e[n]||t[n]>e[n+1]||t[n+1]<e[n]||t[n+1]>e[n+1])return 0;return 1}function h2e(t,e,n){if(!t||!e)return 0;for(let r=0;r<6;r+=2)if(t[r]+n[r/2]<e[r]||t[r]-n[r/2]>e[r+1]||t[r+1]+n[r/2]<e[r]||t[r+1]-n[r/2]>e[r+1])return 0;return 1}function p2e(t,e,n){if(!t||!e||!n)return 0;for(let r=0;r<3;r++)if(t[r]+n[r]<e[2*r]||t[r]-n[r]>e[2*r+1])return 0;return 1}function g2e(t,e,n,r){const i=Qr(3),a=Qr(3),o=Qr(3),s=Qr(3),l=Qr(3),c=Qr(3);for(let w=0;w<3;++w)i[w]=t[w]-e[w],a[w]=e[w]-n[w],o[w]=n[w]-t[w],s[w]=-i[w],l[w]=-a[w],c[w]=-o[w];const f=qd(s),u=qd(l),d=qd(o),h=Qr(3);gu(i,a,h);const p=qd(h),g=f*u*d/(2*p),m=2*p*p,y=u*u*An(i,c)/m,v=d*d*An(s,a)/m,x=f*f*An(o,l)/m;for(let w=0;w<3;++w)r[w]=y*t[w]+v*e[w]+x*n[w];return g}const m2e=1/0,v2e=-1/0,$H=t=>!Number.isFinite(t),{isFinite:y2e,isNaN:d6}=Number,s3=d6;function d0(){return[].concat([Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE])}function x2e(t){let e=-1,n=-1;for(let r=0;r<t.length;r++){const i=Math.abs(t[r]);i>e&&(n=r,e=i)}return n}function GH(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:3;const n=new Array(e),r=new Array(e);for(let a=0;a<e;++a)n[a]=a,r[a]=a;for(let a=e-1;a>0;a--){let o=-1/0,s=0,l=0;for(let c=0;c<=a;++c){const f=n[c];for(let u=0;u<=a;++u){const d=r[u],h=Math.abs(t[f+e*d]);h>o&&(o=h,s=c,l=u)}}[n[a],n[s]]=[n[s],n[a]],[r[a],r[l]]=[r[l],r[a]]}const i=new Array(e*e).fill(0);for(let a=0;a<e;++a){const o=n[a]+e*r[a];i[o]=t[o]<0?-1:1}return i}function jH(t){const e=Math.floor(t*255);return e>15?e.toString(16):`0${e.toString(16)}`}function b2e(t){return`${arguments.length>1&&arguments[1]!==void 0?arguments[1]:"#"}${t.map(jH).join("")}`}function K5(t){return Math.round(t*255)}function w2e(t){return t.length===3?`rgb(${t.map(K5).join(", ")})`:`rgba(${K5(t[0]||0)}, ${K5(t[1]||0)}, ${K5(t[2]||0)}, ${t[3]||0})`}var Hs={Pi:Sve,ldexp:Tve,radiansFromDegrees:wi,degreesFromRadians:i3,round:hv,floor:P9,ceil:Eve,ceilLog2:Rve,min:_ve,max:Dve,arrayMin:Ove,arrayMax:Mve,arrayRange:Ive,isPowerOfTwo:pv,nearestPowerOfTwo:Dl,factorial:Ave,binomial:Pve,beginCombination:Nve,nextCombination:Lve,randomSeed:kve,getSeed:Vve,random:Fve,gaussian:Uve,add:a3,subtract:Tf,multiplyScalar:TH,multiplyScalar2D:EH,multiplyAccumulate:o6,multiplyAccumulate2D:Bve,dot:An,outer:$ve,cross:gu,norm:qd,normalize:qh,perpendiculars:Gve,projectVector:jve,projectVector2D:zve,distance2BetweenPoints:Hc,angleBetweenVectors:Wve,gaussianAmplitude:Hve,gaussianWeight:Kve,dot2D:s6,outer2D:qve,norm2D:_H,normalize2D:DH,determinant2x2:Si,LUFactor3x3:Xve,LUSolve3x3:Yve,linearSolve3x3:Jve,multiply3x3_vect3:ab,multiply3x3_mat3:l6,multiplyMatrix:Zve,transpose3x3:$g,invert3x3:Qve,identity3x3:MH,identity:IH,isIdentity:e2e,isIdentity3x3:t2e,determinant3x3:Bw,quaternionToMatrix3x3:RH,areEquals:OH,areMatricesEqual:ty,roundNumber:ob,roundVector:c6,matrix3x3ToQuaternion:AH,multiplyQuaternion:n2e,orthogonalize3x3:PH,diagonalize3x3:NH,singularValueDecomposition3x3:r2e,solveLinearSystem:LH,invertMatrix:kH,luFactorLinearSystem:N9,luSolveLinearSystem:L9,estimateMatrixCondition:i2e,jacobi:a2e,jacobiN:ny,solveHomogeneousLeastSquares:u6,solveLeastSquares:o2e,hex2float:s2e,rgb2hsv:gv,hsv2rgb:gh,lab2xyz:VH,xyz2lab:FH,xyz2rgb:UH,rgb2xyz:BH,rgb2lab:_h,lab2rgb:o3,uninitializeBounds:Nm,areBoundsInitialized:sb,computeBoundsFromPoints:l2e,clampValue:pc,clampVector:f6,clampAndNormalizeValue:c2e,getScalarTypeFittingRange:u2e,getAdjustedScalarRange:f2e,extentIsWithinOtherExtent:d2e,boundsIsWithinOtherBounds:h2e,pointIsWithinBounds:p2e,solve3PointCircle:g2e,inf:m2e,negInf:v2e,isInf:$H,isNan:d6,isNaN:d6,isFinite:y2e,createUninitializedBounds:d0,getMajorAxisIndex:x2e,getSparseOrthogonalMatrix:GH,floatToHex2:jH,floatRGB2HexCode:b2e,float2CssRGBA:w2e};const zH={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},Nn={VOID:"",CHAR:"Int8Array",SIGNED_CHAR:"Int8Array",UNSIGNED_CHAR:"Uint8Array",UNSIGNED_CHAR_CLAMPED:"Uint8ClampedArray",SHORT:"Int16Array",UNSIGNED_SHORT:"Uint16Array",INT:"Int32Array",UNSIGNED_INT:"Uint32Array",FLOAT:"Float32Array",DOUBLE:"Float64Array"},C2e=Nn.FLOAT;var WH={DefaultDataType:C2e,DataTypeByteSize:zH,VtkDataTypes:Nn};const{vtkErrorMacro:S2e}=po,{DefaultDataType:T2e}=WH,E2e=1e-6;function h6(t,e,n){const r=t.length;let i=Number.MAX_VALUE,a=-Number.MAX_VALUE,o,s;for(s=e;s<r;s+=n)if(!Number.isNaN(t[s])){i=t[s],a=i;break}for(;s<r;s+=n)o=t[s],o<i?i=o:o>a&&(a=o);return{min:i,max:a}}function _2e(){let t=Number.MAX_VALUE,e=-Number.MAX_VALUE,n=0,r=0;return{add(i){t>i&&(t=i),e<i&&(e=i),n++,r+=i},get(){return{min:t,max:e,count:n,sum:r,mean:r/n}},getRange(){return{min:t,max:e}}}}function HH(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;if(e<0&&n>1){const i=t.length/n,a=new Float64Array(i);for(let o=0,s=0;o<i;++o){for(let l=s+n;s<l;++s)a[o]+=t[s]*t[s];a[o]**=.5}return h6(a,0,1)}return h6(t,e<0?0:e,n)}function eL(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const n=t||[];for(;n.length<=e;)n.push(null);return n}function k9(t){return Object.prototype.toString.call(t).slice(8,-1)}function D2e(t){const e=t.getNumberOfComponents();let n=0;const r=new Array(e);for(let i=0;i<t.getNumberOfTuples();++i){t.getTuple(i,r);const a=qd(r,e);a>n&&(n=a)}return n}const O2e={computeRange:HH,createRangeHelper:_2e,fastComputeRange:h6,getDataType:k9,getMaxNorm:D2e};function M2e(t,e){e.classHierarchy.push("vtkDataArray");function n(r){if(r<0)return!1;const i=t.getNumberOfComponents(),a=e.values.length/(i>0?i:1);if(r===a)return!0;if(r>a){const o=e.values;return e.values=Am(e.dataType,(r+a)*i),e.values.set(o),!0}return e.size>r*i&&(e.size=r*i,t.dataChange()),!0}t.dataChange=()=>{e.ranges=null,t.modified()},t.resize=r=>{n(r);const i=r*t.getNumberOfComponents();return e.size!==i?(e.size=i,t.dataChange(),!0):!1},t.initialize=()=>{t.resize(0)},t.getElementComponentSize=()=>e.values.BYTES_PER_ELEMENT,t.getComponent=function(r){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return e.values[r*e.numberOfComponents+i]},t.setComponent=(r,i,a)=>{a!==e.values[r*e.numberOfComponents+i]&&(e.values[r*e.numberOfComponents+i]=a,t.dataChange())},t.getValue=r=>{const i=r/e.numberOfComponents,a=r%e.numberOfComponents;return t.getComponent(i,a)},t.setValue=(r,i)=>{const a=r/e.numberOfComponents,o=r%e.numberOfComponents;t.setComponent(a,o,i)},t.getData=()=>e.size===e.values.length?e.values:e.values.subarray(0,e.size),t.getRange=function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:-1,i=r;i<0&&(i=e.numberOfComponents===1?0:e.numberOfComponents);let a=null;return e.ranges||(e.ranges=eL(e.ranges,e.numberOfComponents)),a=e.ranges[i],a?(e.rangeTuple[0]=a.min,e.rangeTuple[1]=a.max,e.rangeTuple):(a=HH(t.getData(),r,e.numberOfComponents),e.ranges[i]=a,e.rangeTuple[0]=a.min,e.rangeTuple[1]=a.max,e.rangeTuple)},t.setRange=(r,i)=>{e.ranges||(e.ranges=eL(e.ranges,e.numberOfComponents));const a={min:r.min,max:r.max};return e.ranges[i]=a,e.rangeTuple[0]=a.min,e.rangeTuple[1]=a.max,e.rangeTuple},t.getRanges=function(){if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0))return structuredClone(e.ranges);const i=[];for(let a=0;a<e.numberOfComponents;a++){const[o,s]=t.getRange(a),l={min:o,max:s};i.push(l)}if(e.numberOfComponents>1){const[a,o]=t.getRange(-1),s={min:a,max:o};i.push(s)}return i},t.setTuple=(r,i)=>{const a=r*e.numberOfComponents;for(let o=0;o<e.numberOfComponents;o++)e.values[a+o]=i[o]},t.setTuples=(r,i)=>{let a=r*e.numberOfComponents;const o=Math.min(i.length,e.size-a);for(let s=0;s<o;)e.values[a++]=i[s++]},t.insertTuple=(r,i)=>(e.size<=r*e.numberOfComponents&&(e.size=(r+1)*e.numberOfComponents,n(r+1)),t.setTuple(r,i),r),t.insertTuples=(r,i)=>{const a=r+i.length/e.numberOfComponents;return e.size<a*e.numberOfComponents&&(e.size=a*e.numberOfComponents,n(a)),t.setTuples(r,i),a},t.insertNextTuple=r=>{const i=e.size/e.numberOfComponents;return t.insertTuple(i,r)},t.insertNextTuples=r=>{const i=e.size/e.numberOfComponents;return t.insertTuples(i,r)},t.findTuple=function(r){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:E2e;for(let a=0;a<e.size;a+=e.numberOfComponents)if(Math.abs(r[0]-e.values[a])<=i){let o=!0;for(let s=1;s<e.numberOfComponents;++s)if(Math.abs(r[s]-e.values[a+s])>i){o=!1;break}if(o)return a/e.numberOfComponents}return-1},t.getTuple=function(r){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const a=e.numberOfComponents||1,o=r*a;switch(a){case 4:i[3]=e.values[o+3];case 3:i[2]=e.values[o+2];case 2:i[1]=e.values[o+1];case 1:i[0]=e.values[o];break;default:for(let s=a-1;s>=0;--s)i[s]=e.values[o+s]}return i},t.getTuples=(r,i)=>{const a=(r??0)*e.numberOfComponents,o=(i??t.getNumberOfTuples())*e.numberOfComponents,s=t.getData().subarray(a,o);return s.length>0?s:null},t.getTupleLocation=function(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:1)*e.numberOfComponents},t.getNumberOfComponents=()=>e.numberOfComponents,t.getNumberOfValues=()=>e.size,t.getNumberOfTuples=()=>e.size/e.numberOfComponents,t.getDataType=()=>e.dataType,t.newClone=()=>qH({empty:!0,name:e.name,dataType:e.dataType,numberOfComponents:e.numberOfComponents}),t.getName=()=>(e.name||(t.modified(),e.name=`vtkDataArray${t.getMTime()}`),e.name),t.setData=(r,i)=>{e.values=r,e.size=r.length,e.dataType=k9(r),i&&(e.numberOfComponents=i),e.size%e.numberOfComponents!==0&&(e.numberOfComponents=1),t.dataChange()},t.getState=()=>{if(e.deleted)return null;const r={...e,vtkClass:t.getClassName()};r.values=Array.from(r.values),delete r.buffer,Object.keys(r).forEach(a=>{r[a]||delete r[a]});const i={};return Object.keys(r).sort().forEach(a=>{i[a]=r[a]}),i.mtime&&delete i.mtime,i},t.deepCopy=r=>{const i=t.getDataType(),a=e.values;t.shallowCopy(r),e.ranges=structuredClone(r.getRanges()),a?.length>=r.getNumberOfValues()&&i===r.getDataType()?(a.set(r.getData()),e.values=a,t.dataChange()):t.setData(r.getData().slice())},t.interpolateTuple=(r,i,a,o,s,l)=>{const c=e.numberOfComponents||1;(c!==i.getNumberOfComponents()||c!==o.getNumberOfComponents())&&S2e("numberOfComponents must match");const f=i.getTuple(a),u=o.getTuple(s),d=[];switch(d.length=c,c){case 4:d[3]=f[3]+(u[3]-f[3])*l;case 3:d[2]=f[2]+(u[2]-f[2])*l;case 2:d[1]=f[1]+(u[1]-f[1])*l;case 1:d[0]=f[0]+(u[0]-f[0])*l;break;default:for(let h=0;h<c;h++)d[h]=f[h]+(u[h]-f[h])*l}return t.insertTuple(r,d)}}const I2e={name:"",numberOfComponents:1,dataType:T2e,rangeTuple:[0,0]};function KH(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(Object.assign(e,I2e,n),Array.isArray(n.values)&&n.dataType===void 0&&console.warn("vtkDataArray.newInstance: no dataType provided, converting to Float32Array"),!e.empty&&!e.values&&!e.size)throw new TypeError("Cannot create vtkDataArray object without: size > 0, values");if(e.values?Array.isArray(e.values)&&(e.values=Fw(e.dataType,e.values)):e.values=Am(e.dataType,e.size),e.values&&(e.size=e.size??e.values.length,e.dataType=k9(e.values)),$r(t,e),J2(t,e,["name","numberOfComponents"]),e.size%e.numberOfComponents!==0)throw new RangeError("model.size is not a multiple of model.numberOfComponents");M2e(t,e)}const qH=Zn(KH,"vtkDataArray");var nn={newInstance:qH,extend:KH,...O2e,...WH};const R2e={MAGNITUDE:0,COMPONENT:1,RGBCOLORS:2},p6={LUMINANCE:1,LUMINANCE_ALPHA:2,RGB:3,RGBA:4};var V9={VectorMode:R2e,ScalarMappingTarget:p6};const A2e={DEFAULT:0,MAP_SCALARS:1,DIRECT_SCALARS:2},P2e={DEFAULT:0,USE_POINT_DATA:1,USE_CELL_DATA:2,USE_POINT_FIELD_DATA:3,USE_CELL_FIELD_DATA:4,USE_FIELD_DATA:5},N2e={BY_ID:0,BY_NAME:1};var $w={ColorMode:A2e,GetArray:N2e,ScalarMode:P2e};const{ScalarMappingTarget:tL,VectorMode:zc}=V9,{VtkDataTypes:hd}=nn,{ColorMode:q5}=$w,{vtkErrorMacro:nL}=le;function L2e(t){return t}function rL(t){return Math.floor(t*255+.5)}function k2e(t,e){e.classHierarchy.push("vtkScalarsToColors"),t.setVectorModeToMagnitude=()=>t.setVectorMode(zc.MAGNITUDE),t.setVectorModeToComponent=()=>t.setVectorMode(zc.COMPONENT),t.setVectorModeToRGBColors=()=>t.setVectorMode(zc.RGBCOLORS),t.build=()=>{},t.isOpaque=()=>!0,t.setAnnotations=(n,r)=>{if(!(n&&!r||!n&&r)){if(n&&r&&n.length!==r.length){nL("Values and annotations do not have the same number of tuples so ignoring");return}if(e.annotationArray=[],r&&n){const i=r.length;for(let a=0;a<i;a++)e.annotationArray.push({value:n[a],annotation:String(r[a])})}t.updateAnnotatedValueMap(),t.modified()}},t.setAnnotation=(n,r)=>{let i=t.checkForAnnotatedValue(n),a=!1;return i>=0?e.annotationArray[i].annotation!==r&&(e.annotationArray[i].annotation=r,a=!0):(e.annotationArray.push({value:n,annotation:r}),i=e.annotationArray.length-1,a=!0),a&&(t.updateAnnotatedValueMap(),t.modified()),i},t.getNumberOfAnnotatedValues=()=>e.annotationArray.length,t.getAnnotatedValue=n=>n<0||n>=e.annotationArray.length?null:e.annotationArray[n].value,t.getAnnotation=n=>e.annotationArray[n]===void 0?null:e.annotationArray[n].annotation,t.getAnnotatedValueIndex=n=>e.annotationArray.length?t.checkForAnnotatedValue(n):-1,t.removeAnnotation=n=>{const r=t.checkForAnnotatedValue(n),i=r>=0;return i&&(e.annotationArray.splice(r,1),t.updateAnnotatedValueMap(),t.modified()),i},t.resetAnnotations=()=>{e.annotationArray=[],e.annotatedValueMap=[],t.modified()},t.getAnnotationColor=(n,r)=>{if(e.indexedLookup){const i=t.getAnnotatedValueIndex(n);t.getIndexedColor(i,r)}else t.getColor(parseFloat(n),r),r[3]=1},t.checkForAnnotatedValue=n=>t.getAnnotatedValueIndexInternal(n),t.getAnnotatedValueIndexInternal=n=>{if(e.annotatedValueMap[n]!==void 0){const r=e.annotationArray.length;return e.annotatedValueMap[n]%r}return-1},t.getIndexedColor=(n,r)=>{r[0]=0,r[1]=0,r[2]=0,r[3]=0},t.updateAnnotatedValueMap=()=>{e.annotatedValueMap=[];const n=e.annotationArray.length;for(let r=0;r<n;r++)e.annotatedValueMap[e.annotationArray[r].value]=r},t.mapScalars=(n,r,i)=>{const a=n.getNumberOfComponents();let o=null;if(r===q5.DEFAULT&&(n.getDataType()===hd.UNSIGNED_CHAR||n.getDataType()===hd.UNSIGNED_CHAR_CLAMPED)||r===q5.DIRECT_SCALARS&&n)o=t.convertToRGBA(n,a,n.getNumberOfTuples());else{const s={type:"vtkDataArray",name:"temp",numberOfComponents:4,dataType:hd.UNSIGNED_CHAR},l=le.newTypedArray(s.dataType,4*n.getNumberOfTuples());s.values=l,s.size=l.length,o=nn.newInstance(s);let c=i;c<0&&a>1?t.mapVectorsThroughTable(n,o,tL.RGBA,-1,-1):(c<0&&(c=0),c>=a&&(c=a-1),t.mapScalarsThroughTable(n,o,tL.RGBA,c))}return o},t.mapVectorsToMagnitude=(n,r,i)=>{const a=n.getNumberOfTuples(),o=n.getNumberOfComponents(),s=r.getData(),l=n.getData();for(let c=0;c<a;c++){let f=0;for(let u=0;u<i;u++)f+=l[c*o+u]*l[c*o+u];s[c]=Math.sqrt(f)}},t.mapVectorsThroughTable=(n,r,i,a,o)=>{let s=t.getVectorMode(),l=o,c=a;const f=n.getNumberOfComponents();s===zc.COMPONENT?(c===-1&&(c=t.getVectorComponent()),c<0&&(c=0),c>=f&&(c=f-1)):(l===-1&&(l=t.getVectorSize()),l<=0?(c=0,l=f):(c<0&&(c=0),c>=f&&(c=f-1),c+l>f&&(l=f-c)),s===zc.MAGNITUDE&&(f===1||l===1)&&(s=zc.COMPONENT));let u=0;switch(c>0&&(u=c),s){case zc.COMPONENT:{t.mapScalarsThroughTable(n,r,i,u);break}case zc.RGBCOLORS:break;case zc.MAGNITUDE:default:{const d=nn.newInstance({numberOfComponents:1,values:new Float32Array(n.getNumberOfTuples())});t.mapVectorsToMagnitude(n,d,l),t.mapScalarsThroughTable(d,r,i,0);break}}},t.luminanceToRGBA=(n,r,i,a)=>{const o=a(i),s=r.getData(),l=n.getData(),c=s.length,f=0,u=1;let d=0;for(let h=f;h<c;h+=u){const p=a(s[h]);l[d*4]=p,l[d*4+1]=p,l[d*4+2]=p,l[d*4+3]=o,d++}},t.luminanceAlphaToRGBA=(n,r,i,a)=>{const o=r.getData(),s=n.getData(),l=o.length,c=0,f=2;let u=0;for(let d=c;d<l;d+=f){const h=a(o[d]);s[u]=h,s[u+1]=h,s[u+2]=h,s[u+3]=a(o[d+1])*i,u+=4}},t.rGBToRGBA=(n,r,i,a)=>{const o=rL(i),s=r.getData(),l=n.getData(),c=s.length,f=0,u=3;let d=0;for(let h=f;h<c;h+=u)l[d*4]=a(s[h]),l[d*4+1]=a(s[h+1]),l[d*4+2]=a(s[h+2]),l[d*4+3]=o,d++},t.rGBAToRGBA=(n,r,i,a)=>{const o=r.getData(),s=n.getData(),l=o.length,c=0,f=4;let u=0;for(let d=c;d<l;d+=f)s[u*4]=a(o[d]),s[u*4+1]=a(o[d+1]),s[u*4+2]=a(o[d+2]),s[u*4+3]=a(o[d+3])*i,u++},t.convertToRGBA=(n,r,i)=>{let{alpha:a}=e;if(r===4&&a>=1&&n.getDataType()===hd.UNSIGNED_CHAR)return n;const o=nn.newInstance({numberOfComponents:4,empty:!0,size:4*i,dataType:hd.UNSIGNED_CHAR});if(i<=0)return o;a=a>0?a:0,a=a<1?a:1;let s=L2e;switch((n.getDataType()===hd.FLOAT||n.getDataType()===hd.DOUBLE)&&(s=rL),r){case 1:t.luminanceToRGBA(o,n,a,s);break;case 2:t.luminanceAlphaToRGBA(o,n,s);break;case 3:t.rGBToRGBA(o,n,a,s);break;case 4:t.rGBAToRGBA(o,n,a,s);break;default:return nL("Cannot convert colors"),null}return o},t.usingLogScale=()=>!1,t.getNumberOfAvailableColors=()=>256*256*256,t.setRange=(n,r)=>t.setMappingRange(n,r),t.getRange=()=>t.getMappingRange(),t.areScalarsOpaque=(n,r,i)=>{if(!n)return t.isOpaque();const a=n.getNumberOfComponents();return r===q5.DEFAULT&&n.getDataType()===hd.UNSIGNED_CHAR||r===q5.DIRECT_SCALARS?a===3||a===1?e.alpha>=1:n.getRange(a-1)[0]===255:!0}}const V2e={alpha:1,vectorComponent:0,vectorSize:-1,vectorMode:zc.COMPONENT,mappingRange:null,annotationArray:null,annotatedValueMap:null,indexedLookup:!1};function XH(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,V2e,n),le.obj(t,e),e.mappingRange=[0,255],e.annotationArray=[],e.annotatedValueMap=[],le.setGet(t,e,["vectorSize","vectorComponent","vectorMode","alpha","indexedLookup"]),le.setArray(t,e,["mappingRange"],2),le.getArray(t,e,["mappingRange"]),k2e(t,e)}const F2e=le.newInstance(XH,"vtkScalarsToColors");var Gw={newInstance:F2e,extend:XH,...V9};const U2e={RGB:0,HSV:1,LAB:2,DIVERGING:3},B2e={LINEAR:0,LOG10:1};var YH={ColorSpace:U2e,Scale:B2e};const{ColorSpace:Tl,Scale:F9}=YH,{ScalarMappingTarget:X5}=Gw,{vtkDebugMacro:$2e,vtkErrorMacro:Qu,vtkWarningMacro:G2e}=le;function iL(t,e){const n=t[0],r=t[1],i=t[2],a=Math.sqrt(n*n+r*r+i*i),o=a>.001?Math.acos(n/a):0,s=o>.001?Math.atan2(i,r):0;e[0]=a,e[1]=o,e[2]=s}function j2e(t,e){const n=t[0],r=t[1],i=t[2];e[0]=n*Math.cos(r),e[1]=n*Math.sin(r)*Math.cos(i),e[2]=n*Math.sin(r)*Math.sin(i)}function aL(t,e){if(t[0]>=e-.1)return t[2];const n=t[1]*Math.sqrt(e*e-t[0]*t[0])/(t[0]*Math.sin(t[1]));return t[2]>-.3*Math.PI?t[2]+n:t[2]-n}function z2e(t,e){let n=t-e;for(n<0&&(n=-n);n>=2*Math.PI;)n-=2*Math.PI;return n>Math.PI&&(n=2*Math.PI-n),n}function oL(t,e,n,r){const i=[],a=[];_h(e,i),_h(n,a);const o=[],s=[];iL(i,o),iL(a,s);let l=t;if(o[1]>.05&&s[1]>.05&&z2e(o[2],s[2])>.33*Math.PI){let u=Math.max(o[0],s[0]);u=Math.max(88,u),t<.5?(s[0]=u,s[1]=0,s[2]=0,l*=2):(o[0]=u,o[1]=0,o[2]=0,l=2*l-1)}o[1]<.05&&s[1]>.05?o[2]=aL(s,o[0]):s[1]<.05&&o[1]>.05&&(s[2]=aL(o,s[0]));const c=[];c[0]=(1-l)*o[0]+l*s[0],c[1]=(1-l)*o[1]+l*s[1],c[2]=(1-l)*o[2]+l*s[2];const f=[];j2e(c,f),o3(f,r)}function W2e(t,e){e.classHierarchy.push("vtkColorTransferFunction"),t.getSize=()=>e.nodes.length,t.addRGBPoint=(n,r,i,a)=>t.addRGBPointLong(n,r,i,a,.5,0),t.addRGBPointLong=function(n,r,i,a){let o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:.5,s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:0;if(o<0||o>1)return Qu("Midpoint outside range [0.0, 1.0]"),-1;if(s<0||s>1)return Qu("Sharpness outside range [0.0, 1.0]"),-1;e.allowDuplicateScalars||t.removePoint(n);const l={x:n,r,g:i,b:a,midpoint:o,sharpness:s};e.nodes.push(l),t.sortAndUpdateRange();let c=0;for(;c<e.nodes.length&&e.nodes[c].x!==n;c++);return c<e.nodes.length?c:-1},t.addHSVPoint=(n,r,i,a)=>t.addHSVPointLong(n,r,i,a,.5,0),t.addHSVPointLong=function(n,r,i,a){let o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:.5,s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:0;const l=[];return gh([r,i,a],l),t.addRGBPoint(n,l[0],l[1],l[2],o,s)},t.setNodes=n=>{if(e.nodes!==n){const r=JSON.stringify(e.nodes);e.nodes=n;const i=JSON.stringify(e.nodes);if(t.sortAndUpdateRange()||r!==i)return t.modified(),!0}return!1},t.sortAndUpdateRange=()=>{const n=JSON.stringify(e.nodes);e.nodes.sort((a,o)=>a.x-o.x);const r=JSON.stringify(e.nodes),i=t.updateRange();return!i&&n!==r?(t.modified(),!0):i},t.updateRange=()=>{const n=[2];n[0]=e.mappingRange[0],n[1]=e.mappingRange[1];const r=e.nodes.length;return r?(e.mappingRange[0]=e.nodes[0].x,e.mappingRange[1]=e.nodes[r-1].x):(e.mappingRange[0]=0,e.mappingRange[1]=0),n[0]===e.mappingRange[0]&&n[1]===e.mappingRange[1]?!1:(t.modified(),!0)},t.removePoint=n=>{let r=0;for(;r<e.nodes.length&&e.nodes[r].x!==n;r++);const i=r;if(r>=e.nodes.length)return-1;let a=!1;return e.nodes.splice(r,1),(r===0||r===e.nodes.length)&&(a=t.updateRange()),a||t.modified(),i},t.movePoint=(n,r)=>{if(n!==r){t.removePoint(r);for(let i=0;i<e.nodes.length;i++)if(e.nodes[i].x===n){e.nodes[i].x=r,t.sortAndUpdateRange();break}}},t.removeAllPoints=()=>{e.nodes=[],t.sortAndUpdateRange()},t.addRGBSegment=(n,r,i,a,o,s,l,c)=>{t.sortAndUpdateRange();for(let f=0;f<e.nodes.length;)e.nodes[f].x>=n&&e.nodes[f].x<=o?e.nodes.splice(f,1):f++;t.addRGBPointLong(n,r,i,a,.5,0),t.addRGBPointLong(o,s,l,c,.5,0),t.modified()},t.addHSVSegment=(n,r,i,a,o,s,l,c)=>{const f=[r,i,a],u=[s,l,c],d=[],h=[];gh(f,d),gh(u,h),t.addRGBSegment(n,d[0],d[1],d[2],o,h[0],h[1],h[2])},t.mapValue=n=>{const r=[];return t.getColor(n,r),[Math.floor(255*r[0]+.5),Math.floor(255*r[1]+.5),Math.floor(255*r[2]+.5),255]},t.getColor=(n,r)=>{if(e.indexedLookup){const i=t.getSize(),a=t.getAnnotatedValueIndexInternal(n);if(a<0||i===0){const o=t.getNanColorByReference();r[0]=o[0],r[1]=o[1],r[2]=o[2]}else{const o=[];t.getNodeValue(a%i,o),r[0]=o[1],r[1]=o[2],r[2]=o[3]}return}t.getTable(n,n,1,r)},t.getRedValue=n=>{const r=[];return t.getColor(n,r),r[0]},t.getGreenValue=n=>{const r=[];return t.getColor(n,r),r[1]},t.getBlueValue=n=>{const r=[];return t.getColor(n,r),r[2]},t.getTable=(n,r,i,a)=>{const o=Number(n),s=Number(r);if(s3(o)||s3(s)){for(let I=0;I<i;I++)a[I*3+0]=e.nanColor[0],a[I*3+1]=e.nanColor[1],a[I*3+2]=e.nanColor[2];return}let l=0;const c=e.nodes.length;let f=0,u=0,d=0;c!==0&&(f=e.nodes[c-1].r,u=e.nodes[c-1].g,d=e.nodes[c-1].b);let h=0,p=0,g=0;const m=[0,0,0],y=[0,0,0];let v=0,x=0;const w=[];let S=e.scale===F9.LOG10;S&&(S=e.mappingRange[0]>0);let T=0,_=0,D=0;S&&(T=Math.log10(o),_=Math.log10(s));for(let I=0;I<i;I++){const R=3*I;if(i>1?S?(D=T+I/(i-1)*(_-T),h=10**D):h=o+I/(i-1)*(s-o):S?(D=.5*(T+_),h=10**D):h=.5*(o+s),e.discretize){const M=e.mappingRange;if(h>=M[0]&&h<=M[1]){const A=e.numberOfValues,L=M[1]-M[0];if(A<=1)h=M[0]+L/2;else{const P=(h-M[0])/L,B=P9(A*P);h=M[0]+B/(A-1)*L}}}for(;l<c&&h>e.nodes[l].x;)l++,l<c&&(p=e.nodes[l-1].x,g=e.nodes[l].x,S&&(p=Math.log10(p),g=Math.log10(g)),m[0]=e.nodes[l-1].r,y[0]=e.nodes[l].r,m[1]=e.nodes[l-1].g,y[1]=e.nodes[l].g,m[2]=e.nodes[l-1].b,y[2]=e.nodes[l].b,v=e.nodes[l-1].midpoint,x=e.nodes[l-1].sharpness,v<1e-5&&(v=1e-5),v>.99999&&(v=.99999));if(h>e.mappingRange[1])a[R]=0,a[R+1]=0,a[R+2]=0,e.clamping&&(t.getUseAboveRangeColor()?(a[R]=e.aboveRangeColor[0],a[R+1]=e.aboveRangeColor[1],a[R+2]=e.aboveRangeColor[2]):(a[R]=f,a[R+1]=u,a[R+2]=d));else if(h<e.mappingRange[0]||$H(h)&&h<0)a[R]=0,a[R+1]=0,a[R+2]=0,e.clamping&&(t.getUseBelowRangeColor()?(a[R]=e.belowRangeColor[0],a[R+1]=e.belowRangeColor[1],a[R+2]=e.belowRangeColor[2]):c>0&&(a[R]=e.nodes[0].r,a[R+1]=e.nodes[0].g,a[R+2]=e.nodes[0].b));else if(l===0&&(Math.abs(h-o)<1e-6||e.discretize))c>0?(a[R]=e.nodes[0].r,a[R+1]=e.nodes[0].g,a[R+2]=e.nodes[0].b):(a[R]=0,a[R+1]=0,a[R+2]=0);else{let M=0;if(S?M=(D-p)/(g-p):M=(h-p)/(g-p),M<v?M=.5*M/v:M=.5+.5*(M-v)/(1-v),x>.99)if(M<.5){a[R]=m[0],a[R+1]=m[1],a[R+2]=m[2];continue}else{a[R]=y[0],a[R+1]=y[1],a[R+2]=y[2];continue}if(x<.01){if(e.colorSpace===Tl.RGB)a[R]=(1-M)*m[0]+M*y[0],a[R+1]=(1-M)*m[1]+M*y[1],a[R+2]=(1-M)*m[2]+M*y[2];else if(e.colorSpace===Tl.HSV){const V=[],X=[];gv(m,V),gv(y,X),e.hSVWrap&&(V[0]-X[0]>.5||X[0]-V[0]>.5)&&(V[0]>X[0]?V[0]-=1:X[0]-=1);const Q=[];Q[0]=(1-M)*V[0]+M*X[0],Q[0]<0&&(Q[0]+=1),Q[1]=(1-M)*V[1]+M*X[1],Q[2]=(1-M)*V[2]+M*X[2],gh(Q,w),a[R]=w[0],a[R+1]=w[1],a[R+2]=w[2]}else if(e.colorSpace===Tl.LAB){const V=[],X=[];_h(m,V),_h(y,X);const Q=[];Q[0]=(1-M)*V[0]+M*X[0],Q[1]=(1-M)*V[1]+M*X[1],Q[2]=(1-M)*V[2]+M*X[2],o3(Q,w),a[R]=w[0],a[R+1]=w[1],a[R+2]=w[2]}else e.colorSpace===Tl.DIVERGING?(oL(M,m,y,w),a[R]=w[0],a[R+1]=w[1],a[R+2]=w[2]):Qu("ColorSpace set to invalid value.",e.colorSpace);continue}M<.5?M=.5*(M*2)**(1+10*x):M>.5&&(M=1-.5*((1-M)*2)**(1+10*x));const A=M*M,L=A*M,P=2*L-3*A+1,B=-2*L+3*A,U=L-2*A+M,G=L-A;let F,$;if(e.colorSpace===Tl.RGB)for(let V=0;V<3;V++)F=y[V]-m[V],$=(1-x)*F,a[R+V]=P*m[V]+B*y[V]+U*$+G*$;else if(e.colorSpace===Tl.HSV){const V=[],X=[];gv(m,V),gv(y,X),e.hSVWrap&&(V[0]-X[0]>.5||X[0]-V[0]>.5)&&(V[0]>X[0]?V[0]-=1:X[0]-=1);const Q=[];for(let re=0;re<3;re++)F=X[re]-V[re],$=(1-x)*F,Q[re]=P*V[re]+B*X[re]+U*$+G*$,re===0&&Q[re]<0&&(Q[re]+=1);gh(Q,w),a[R]=w[0],a[R+1]=w[1],a[R+2]=w[2]}else if(e.colorSpace===Tl.LAB){const V=[],X=[];_h(m,V),_h(y,X);const Q=[];for(let re=0;re<3;re++)F=X[re]-V[re],$=(1-x)*F,Q[re]=P*V[re]+B*X[re]+U*$+G*$;o3(Q,w),a[R]=w[0],a[R+1]=w[1],a[R+2]=w[2]}else e.colorSpace===Tl.DIVERGING?(oL(M,m,y,w),a[R]=w[0],a[R+1]=w[1],a[R+2]=w[2]):Qu("ColorSpace set to invalid value.");for(let V=0;V<3;V++)a[R+V]=a[R+V]<0?0:a[R+V],a[R+V]=a[R+V]>1?1:a[R+V]}}},t.getUint8Table=function(n,r,i){let a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(t.getMTime()<=e.buildTime&&e.tableSize===i&&e.tableWithAlpha!==a)return e.table;if(e.nodes.length===0)return Qu("Attempting to lookup a value with no points in the function"),e.table;const o=a?4:3;(e.tableSize!==i||e.tableWithAlpha!==a)&&(e.table=new Uint8Array(i*o),e.tableSize=i,e.tableWithAlpha=a);const s=[];t.getTable(n,r,i,s);for(let l=0;l<i;l++)e.table[l*o+0]=Math.floor(s[l*3+0]*255+.5),e.table[l*o+1]=Math.floor(s[l*3+1]*255+.5),e.table[l*o+2]=Math.floor(s[l*3+2]*255+.5),a&&(e.table[l*o+3]=255);return e.buildTime.modified(),e.table},t.buildFunctionFromArray=n=>{t.removeAllPoints();const r=n.getNumberOfComponents();for(let i=0;i<n.getNumberOfTuples();i++)switch(r){case 3:{e.nodes.push({x:i,r:n.getComponent(i,0),g:n.getComponent(i,1),b:n.getComponent(i,2),midpoint:.5,sharpness:0});break}case 4:{e.nodes.push({x:n.getComponent(i,0),r:n.getComponent(i,1),g:n.getComponent(i,2),b:n.getComponent(i,3),midpoint:.5,sharpness:0});break}case 5:{e.nodes.push({x:i,r:n.getComponent(i,0),g:n.getComponent(i,1),b:n.getComponent(i,2),midpoint:n.getComponent(i,4),sharpness:n.getComponent(i,5)});break}case 6:{e.nodes.push({x:n.getComponent(i,0),r:n.getComponent(i,1),g:n.getComponent(i,2),b:n.getComponent(i,3),midpoint:n.getComponent(i,4),sharpness:n.getComponent(i,5)});break}}t.sortAndUpdateRange()},t.buildFunctionFromTable=(n,r,i,a)=>{let o=0;t.removeAllPoints(),i>1&&(o=(r-n)/(i-1));for(let s=0;s<i;s++){const l={x:n+o*s,r:a[s*3],g:a[s*3+1],b:a[s*3+2],sharpness:0,midpoint:.5};e.nodes.push(l)}t.sortAndUpdateRange()},t.getNodeValue=(n,r)=>n<0||n>=e.nodes.length?(Qu("Index out of range!"),-1):(r[0]=e.nodes[n].x,r[1]=e.nodes[n].r,r[2]=e.nodes[n].g,r[3]=e.nodes[n].b,r[4]=e.nodes[n].midpoint,r[5]=e.nodes[n].sharpness,1),t.setNodeValue=(n,r)=>{if(n<0||n>=e.nodes.length)return Qu("Index out of range!"),-1;const i=e.nodes[n].x;return e.nodes[n].x=r[0],e.nodes[n].r=r[1],e.nodes[n].g=r[2],e.nodes[n].b=r[3],e.nodes[n].midpoint=r[4],e.nodes[n].sharpness=r[5],i!==r[0]?t.sortAndUpdateRange():t.modified(),1},t.getNumberOfAvailableColors=()=>{if(e.indexedLookup&&t.getSize())return t.getSize();if(e.tableSize)return e.tableSize;const n=e.nodes?.length??0;return Math.max(4094,n)},t.getIndexedColor=(n,r)=>{const i=t.getSize();if(i>0&&n>=0){const o=[];t.getNodeValue(n%i,o);for(let s=0;s<3;++s)r[s]=o[s+1];r[3]=1;return}const a=t.getNanColorByReference();r[0]=a[0],r[1]=a[1],r[2]=a[2],r[3]=1},t.fillFromDataPointer=(n,r)=>{if(!(n<=0||!r)){t.removeAllPoints();for(let i=0;i<n;i++)t.addRGBPoint(r[i*4],r[i*4+1],r[i*4+2],r[i*4+3])}},t.setMappingRange=(n,r)=>{const i=[n,r],a=t.getRange();if(a[1]===i[1]&&a[0]===i[0])return;if(i[1]===i[0]){Qu("attempt to set zero width color range");return}const o=(i[1]-i[0])/(a[1]-a[0]),s=i[0]-a[0]*o;for(let l=0;l<e.nodes.length;++l)e.nodes[l].x=e.nodes[l].x*o+s;e.mappingRange[0]=i[0],e.mappingRange[1]=i[1],t.modified()},t.adjustRange=n=>{const r=t.getRange(),i=[];r[0]<n[0]?(t.getColor(n[0],i),t.addRGBPoint(n[0],i[0],i[1],i[2])):(t.getColor(r[0],i),t.addRGBPoint(n[0],i[0],i[1],i[2])),r[1]>n[1]?(t.getColor(n[1],i),t.addRGBPoint(n[1],i[0],i[1],i[2])):(t.getColor(r[1],i),t.addRGBPoint(n[1],i[0],i[1],i[2])),t.sortAndUpdateRange();for(let a=0;a<e.nodes.length;)e.nodes[a].x>=n[0]&&e.nodes[a].x<=n[1]?e.nodes.splice(a,1):++a;return 1},t.estimateMinNumberOfSamples=(n,r)=>{const i=t.findMinimumXDistance();return Math.ceil((r-n)/i)},t.findMinimumXDistance=()=>{if(e.nodes.length<2)return-1;let n=Number.MAX_VALUE;for(let r=0;r<e.nodes.length-1;r++){const i=e.nodes[r+1].x-e.nodes[r].x;i<n&&(n=i)}return n},t.mapScalarsThroughTable=(n,r,i,a)=>{if(t.getSize()===0){$2e("Transfer Function Has No Points!");return}e.indexedLookup?t.mapDataIndexed(n,r,i,a):t.mapData(n,r,i,a)},t.mapData=(n,r,i,a)=>{if(t.getSize()===0){G2e("Transfer Function Has No Points!");return}const o=Math.floor(t.getAlpha()*255+.5),s=n.getNumberOfTuples(),l=n.getNumberOfComponents(),c=r.getData(),f=n.getData(),u=[];if(i===X5.RGBA)for(let d=0;d<s;d++){const h=f[d*l+a];t.getColor(h,u),c[d*4]=Math.floor(u[0]*255+.5),c[d*4+1]=Math.floor(u[1]*255+.5),c[d*4+2]=Math.floor(u[2]*255+.5),c[d*4+3]=o}if(i===X5.RGB)for(let d=0;d<s;d++){const h=f[d*l+a];t.getColor(h,u),c[d*3]=Math.floor(u[0]*255+.5),c[d*3+1]=Math.floor(u[1]*255+.5),c[d*3+2]=Math.floor(u[2]*255+.5)}if(i===X5.LUMINANCE)for(let d=0;d<s;d++){const h=f[d*l+a];t.getColor(h,u),c[d]=Math.floor(u[0]*76.5+u[1]*150.45+u[2]*28.05+.5)}if(i===X5.LUMINANCE_ALPHA)for(let d=0;d<s;d++){const h=f[d*l+a];t.getColor(h,u),c[d*2]=Math.floor(u[0]*76.5+u[1]*150.45+u[2]*28.05+.5),c[d*2+1]=o}},t.applyColorMap=n=>{const r=JSON.stringify(e.colorSpace);n.ColorSpace&&(e.colorSpace=Tl[n.ColorSpace.toUpperCase()],e.colorSpace===void 0&&(Qu(`ColorSpace ${n.ColorSpace} not supported, using RGB instead`),e.colorSpace=Tl.RGB));let i=r!==JSON.stringify(e.colorSpace);const a=i||JSON.stringify(e.nanColor);if(n.NanColor)for(e.nanColor=[].concat(n.NanColor);e.nanColor.length<4;)e.nanColor.push(1);i=i||a!==JSON.stringify(e.nanColor);const o=i||JSON.stringify(e.nodes);if(n.RGBPoints){const c=n.RGBPoints.length;e.nodes=[];const f=.5,u=0;for(let d=0;d<c;d+=4)e.nodes.push({x:n.RGBPoints[d],r:n.RGBPoints[d+1],g:n.RGBPoints[d+2],b:n.RGBPoints[d+3],midpoint:f,sharpness:u})}const s=t.sortAndUpdateRange(),l=!s&&(i||o!==JSON.stringify(e.nodes));return l&&t.modified(),s||l}}const H2e={clamping:!0,colorSpace:Tl.RGB,hSVWrap:!0,scale:F9.LINEAR,nanColor:null,belowRangeColor:null,aboveRangeColor:null,useAboveRangeColor:!1,useBelowRangeColor:!1,allowDuplicateScalars:!1,table:null,tableSize:0,buildTime:null,nodes:null,discretize:!1,numberOfValues:256};function JH(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,H2e,n),Gw.extend(t,e,n),e.table=[],e.nodes=[],e.nanColor=[.5,0,0,1],e.belowRangeColor=[0,0,0,1],e.aboveRangeColor=[1,1,1,1],e.buildTime={},le.obj(e.buildTime),le.get(t,e,["buildTime","mappingRange"]),le.setGet(t,e,["useAboveRangeColor","useBelowRangeColor","discretize","numberOfValues",{type:"enum",name:"colorSpace",enum:Tl},{type:"enum",name:"scale",enum:F9}]),le.setArray(t,e,["nanColor","belowRangeColor","aboveRangeColor"],4),le.getArray(t,e,["nanColor","belowRangeColor","aboveRangeColor"]),W2e(t,e)}const K2e=le.newInstance(JH,"vtkColorTransferFunction");var Lf={newInstance:K2e,extend:JH,...YH},q2e=[{Name:"KAAMS",IndexedColors:[1,1,1,1,0,0,0,1,0,0,0,1,1,1,0,1,0,1,0,1,1,.63,.63,1,.67,.5,.33,1,.5,.75,.53,.35,.7,1,.75,.5],Annotations:[0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11]},{ColorSpace:"Diverging",Name:"Cool to Warm",NanColor:[1,1,0],RGBPoints:[0,.23137254902,.298039215686,.752941176471,.5,.865,.865,.865,1,.705882352941,.0156862745098,.149019607843]},{ColorSpace:"Lab",Creator:"Francesca Samsel",Name:"Cool to Warm (Extended)",NanColor:[.25,0,0],RGBPoints:[0,0,0,.34902,.03125,.039216,.062745,.380392,.0625,.062745,.117647,.411765,.09375,.090196,.184314,.45098,.125,.12549,.262745,.501961,.15625,.160784,.337255,.541176,.1875,.2,.396078,.568627,.21875,.239216,.454902,.6,.25,.286275,.521569,.65098,.28125,.337255,.592157,.701961,.3125,.388235,.654902,.74902,.34375,.466667,.737255,.819608,.375,.572549,.819608,.878431,.40625,.654902,.866667,.909804,.4375,.752941,.917647,.941176,.46875,.823529,.956863,.968627,.5,.988235,.960784,.901961,.5,.941176,.984314,.988235,.52,.988235,.945098,.85098,.54,.980392,.898039,.784314,.5625,.968627,.835294,.698039,.59375,.94902,.733333,.588235,.625,.929412,.65098,.509804,.65625,.909804,.564706,.435294,.6875,.878431,.458824,.352941,.71875,.839216,.388235,.286275,.75,.760784,.294118,.211765,.78125,.701961,.211765,.168627,.8125,.65098,.156863,.129412,.84375,.6,.094118,.094118,.875,.54902,.066667,.098039,.90625,.501961,.05098,.12549,.9375,.45098,.054902,.172549,.96875,.4,.054902,.192157,1,.34902,.070588,.211765]},{ColorSpace:"Diverging",Name:"Warm to Cool",NanColor:[1,1,0],RGBPoints:[0,.705882352941,.0156862745098,.149019607843,.5,.865,.865,.865,1,.23137254902,.298039215686,.752941176471]},{ColorSpace:"Lab",Creator:"Francesca Samsel",Name:"Warm to Cool (Extended)",NanColor:[.250004,0,0],RGBPoints:[0,.34902,0,.129412,.025,.4,.00392157,.101961,.05,.470588,.0156863,.0901961,.075,.54902,.027451,.0705882,.1,.619608,.0627451,.0431373,.125,.690196,.12549,.0627451,.15,.741176,.184314,.0745098,.175,.788235,.266667,.0941176,.2,.811765,.345098,.113725,.225,.831373,.411765,.133333,.25,.85098,.47451,.145098,.275,.870588,.54902,.156863,.3,.878431,.619608,.168627,.325,.890196,.658824,.196078,.35,.909804,.717647,.235294,.375,.929412,.776471,.278431,.395522,.94902,.823529,.321569,.418905,.968627,.87451,.407843,.444278,.980392,.917647,.509804,.470149,.988235,.956863,.643137,.483582,.992157,.964706,.713725,.499,.988235,.980392,.870588,.5,1,1,1,.501,.913725,.988235,.937255,.516418,.827451,.980392,.886275,.531343,.764706,.980392,.866667,.546766,.658824,.980392,.843137,.564179,.572549,.964706,.835294,.587562,.423529,.941176,.87451,.60597,.262745,.901961,.862745,.629851,.0705882,.854902,.870588,.651741,.0509804,.8,.85098,.681592,.0235294,.709804,.831373,.712935,.0313725,.615686,.811765,.75,.0313725,.537255,.788235,.775,.0392157,.466667,.768627,.8,.0509804,.396078,.741176,.825,.054902,.317647,.709804,.85,.054902,.243137,.678431,.875,.0431373,.164706,.639216,.9,.0313725,.0980392,.6,.925,.0392157,.0392157,.560784,.95,.105882,.0509804,.509804,.975,.113725,.0235294,.45098,1,.12549,0,.380392]},{ColorSpace:"RGB",Name:"Rainbow Desaturated",NanColor:[1,1,0],RGBPoints:[0,.278431372549,.278431372549,.858823529412,.143,0,0,.360784313725,.285,0,1,1,.429,0,.501960784314,0,.571,1,1,0,.714,1,.380392156863,0,.857,.419607843137,0,0,1,.878431372549,.301960784314,.301960784314]},{ColorSpace:"RGB",Name:"Cold and Hot",NanColor:[1,1,0],RGBPoints:[0,0,1,1,.45,0,0,1,.5,0,0,.501960784314,.55,1,0,0,1,1,1,0]},{ColorSpace:"RGB",Name:"Black-Body Radiation",NanColor:[0,.498039215686,1],RGBPoints:[0,0,0,0,.4,.901960784314,0,0,.8,.901960784314,.901960784314,0,1,1,1,1]},{ColorSpace:"RGB",Name:"X Ray",NanColor:[1,0,0],RGBPoints:[0,1,1,1,1,0,0,0]},{ColorSpace:"RGB",Name:"Grayscale",NanColor:[1,0,0],RGBPoints:[0,0,0,0,1,1,1,1]},{ColorSpace:"RGB",Name:"BkRd",NanColor:[0,1,1],RGBPoints:[0,0,0,0,1,1,0,0]},{ColorSpace:"RGB",Name:"BkGn",NanColor:[1,0,1],RGBPoints:[0,0,0,0,1,0,1,0]},{ColorSpace:"RGB",Name:"BkBu",NanColor:[1,1,0],RGBPoints:[0,0,0,0,1,0,0,1]},{ColorSpace:"RGB",Name:"BkMa",NanColor:[0,1,0],RGBPoints:[0,0,0,0,1,1,0,1]},{ColorSpace:"RGB",Name:"BkCy",NanColor:[0,1,1],RGBPoints:[0,0,0,0,1,0,1,1]},{ColorSpace:"RGB",Name:"Black, Blue and White",NanColor:[1,1,0],RGBPoints:[0,0,0,0,.333,0,0,.501960784314,.666,0,.501960784314,1,1,1,1,1]},{ColorSpace:"RGB",Name:"Black, Orange and White",NanColor:[1,1,0],RGBPoints:[0,0,0,0,.333,.501960784314,0,0,.666,1,.501960784314,0,1,1,1,1]},{ColorSpace:"Lab",Creator:"Francesca Samsel",Name:"Linear YGB 1211g",NanColor:[.25,0,0],RGBPoints:[0,1,.988235,.968627,.02,1,.952941,.878431,.05,.968627,.905882,.776471,.1,.94902,.898039,.647059,.15,.901961,.878431,.556863,.2,.847059,.858824,.482353,.25,.690196,.819608,.435294,.3,.513725,.768627,.384314,.35,.337255,.721569,.337255,.4,.278431,.658824,.392157,.45,.231373,.639216,.435294,.5,.203922,.6,.486275,.55,.172549,.568627,.537255,.6,.141176,.517647,.54902,.65,.133333,.458824,.541176,.7,.12549,.396078,.529412,.75,.117647,.321569,.521569,.8,.121569,.258824,.509804,.85,.133333,.227451,.501961,.9,.145098,.192157,.490196,.95,.188235,.164706,.470588,1,.258824,.196078,.439216]},{ColorSpace:"CIELAB",Creator:"Francesca Samsel",Name:"Linear Green (Gr4L)",NanColor:[.25,0,0],RGBPoints:[0,.054902,.109804,.121569,.05,.07451,.172549,.180392,.1,.086275,.231373,.219608,.15,.094118,.278431,.25098,.2,.109804,.34902,.278431,.25,.113725,.4,.278431,.3,.117647,.45098,.270588,.35,.117647,.490196,.243137,.4,.113725,.521569,.203922,.45,.109804,.54902,.152941,.5,.082353,.588235,.082353,.55,.109804,.631373,.05098,.6,.211765,.678431,.082353,.65,.317647,.721569,.113725,.7,.431373,.760784,.160784,.75,.556863,.8,.239216,.8,.666667,.839216,.294118,.85,.784314,.878431,.396078,.9,.886275,.921569,.533333,.95,.960784,.94902,.670588,1,1,.984314,.901961]},{ColorSpace:"Lab",Creator:"Francesca Samsel",Name:"Linear Blue (8_31f)",NanColor:[.25,0,0],RGBPoints:[0,.960784,1,.980392,.05,.815686,.960784,.913725,.1,.670588,.929412,.870588,.15,.556863,.901961,.843137,.2,.478431,.870588,.823529,.25,.439216,.831373,.803922,.3,.4,.8,.788235,.35,.376471,.768627,.768627,.4,.34902,.709804,.729412,.45,.32549,.654902,.690196,.5,.301961,.607843,.658824,.55,.247059,.545098,.619608,.6,.239216,.494118,.580392,.65,.227451,.439216,.541176,.7,.227451,.403922,.521569,.75,.231373,.368627,.501961,.8,.227451,.321569,.470588,.85,.219608,.282353,.439216,.9,.192157,.235294,.4,.95,.160784,.184314,.34902,1,.133333,.12549,.301961]},{ColorSpace:"HSV",Name:"Blue to Red Rainbow",NanColor:[.498039215686,.498039215686,.498039215686],RGBPoints:[0,0,0,1,1,1,0,0]},{ColorSpace:"HSV",Name:"Red to Blue Rainbow",NanColor:[.498039215686,.498039215686,.498039215686],RGBPoints:[0,1,0,0,1,0,0,1]},{ColorSpace:"RGB",Name:"Rainbow Blended White",NanColor:[1,1,0],RGBPoints:[0,1,1,1,.17,0,0,1,.34,0,1,1,.5,0,1,0,.67,1,1,0,.84,1,0,0,1,.878431372549,0,1]},{ColorSpace:"RGB",Name:"Rainbow Blended Grey",NanColor:[1,1,0],RGBPoints:[0,.317647058824,.341176470588,.43137254902,.17,0,0,1,.34,0,1,1,.5,0,1,0,.67,1,1,0,.84,1,0,0,1,.878431372549,0,1]},{ColorSpace:"RGB",Name:"Rainbow Blended Black",NanColor:[1,1,0],RGBPoints:[0,0,0,0,.17,0,0,1,.34,0,1,1,.5,0,1,0,.67,1,1,0,.84,1,0,0,1,.878431372549,0,1]},{ColorSpace:"RGB",Name:"Blue to Yellow",NanColor:[1,0,0],RGBPoints:[0,.0392156862745,.0392156862745,.949019607843,1,.949019607843,.949019607843,.0392156862745]},{ColorSpace:"HSV",Name:"blot",RGBPoints:[0,0,0,1,.166,0,0,1,.167,1,0,1,.332,1,0,1,.333,0,1,1,.5,0,1,1,.501,0,1,0,.666,0,1,0,.667,1,1,0,.832,1,1,0,.833,1,0,0,1,1,0,0]},{ColorSpace:"Lab",Name:"CIELab Blue to Red",NanColor:[1,1,0],RGBPoints:[0,0,.6,.749019607843,1,.76862745098,.466666666667,.341176470588]},{ColorSpace:"RGB",Name:"jet",RGBPoints:[-1,0,0,.5625,-.777778,0,0,1,-.269841,0,1,1,-.015873,.5,1,.5,.238095,1,1,0,.746032,1,0,0,1,.5,0,0]},{ColorSpace:"RGB",Name:"rainbow",RGBPoints:[-1,0,0,1,-.5,0,1,1,0,0,1,0,.5,1,1,0,1,1,0,0]},{ColorSpace:"Lab",Name:"erdc_rainbow_bright",RGBPoints:[-1,.32549,.14902,.960784,-.866221,.297047,.375586,.963836,-.732441,.180302,.536818,.964627,-.598662,.1302,.649207,.929647,-.464883,.0445143,.749654,.855998,-.331104,.0271325,.830713,.721527,-.197324,.259504,.866145,.543555,-.0635452,.428364,.890725,.329819,.0702341,.568503,.898508,.187623,.204013,.738259,.890317,.0825461,.337793,.84546,.86136,.0147555,.471572,.912191,.808018,0,.605351,.962848,.710445,0,.73913,.999469,.600258,.0176284,.87291,.994156,.445975,.193912,1,.980407,.247105,.262699]},{ColorSpace:"Lab",Name:"erdc_rainbow_dark",RGBPoints:[-1,0,0,.423499,-.866221,0,.119346,.529237,-.732441,0,.238691,.634976,-.598662,0,.346852,.68788,-.464883,0,.45022,.718141,-.331104,0,.553554,.664839,-.197324,0,.651082,.519303,-.0635452,.115841,.72479,.352857,.0702341,.326771,.781195,.140187,.204013,.522765,.798524,.0284624,.337793,.703162,.788685,.00885756,.471572,.845118,.751133,0,.605351,.955734,.690825,0,.73913,.995402,.567916,.0618524,.87291,.987712,.403398,.164851,1,.980407,.247105,.262699]},{ColorSpace:"Lab",Name:"nic_CubicL",RGBPoints:[-1,.479965,.0118108,.5307,-.87451,.522213,.0551282,.706919,-.74902,.50839,.237278,.867764,-.623529,.451617,.373834,.987255,-.498039,.39365,.497255,.97506,-.372549,.328631,.599639,.891843,-.247059,.250043,.690286,.778553,-.121569,.249656,.764905,.645857,.00392157,.297954,.821466,.50449,.129412,.337509,.872595,.358447,.254902,.430011,.913789,.297079,.380392,.587191,.931381,.333353,.505882,.727937,.93591,.353742,.631373,.826403,.921081,.365066,.756863,.893201,.846317,.372662,.882353,.965347,.73884,.378506,1,.983235,.597451,.366856]},{ColorSpace:"Lab",Name:"nic_CubicYF",RGBPoints:[-1,.5151,.0482,.6697,-.87451,.520711,.168955,.800574,-.74902,.493694,.278596,.911824,-.623529,.440026,.369475,.984978,-.498039,.398932,.457593,.987053,-.372549,.350651,.540644,.929608,-.247059,.298827,.615625,.857729,-.121569,.239928,.685061,.769531,.00392157,.228832,.739349,.673287,.129412,.263297,.78608,.569988,.254902,.298107,.828337,.460214,.380392,.33092,.864071,.352674,.505882,.38306,.898169,.287309,.631373,.49023,.917481,.307961,.756863,.62372,.926026,.332309,.882353,.717458,.92527,.342476,1,.8,.9255,.3529]},{ColorSpace:"Lab",Name:"gist_earth",RGBPoints:[-1,0,0,0,-.87451,.239216,.027451,.415686,-.74902,.0901961,.254902,.556863,-.623529,.0941176,.352941,.54902,-.498039,.105882,.435294,.533333,-.372549,.12549,.52549,.501961,-.247059,.156863,.596078,.443137,-.121569,.196078,.65098,.380392,.00392157,.282353,.717647,.301961,.129412,.466667,.772549,.27451,.254902,.678431,.784314,.309804,.380392,.901961,.756863,.376471,.505882,.992157,.705882,.521569,.631373,1,.721569,.701961,.756863,1,.784314,.784314,.882353,1,.866667,.866667,1,1,1,1]},{ColorSpace:"Lab",Name:"2hot",RGBPoints:[-1,.0416667,0,0,-.873016,.208333,0,0,-.746032,.375,0,0,-.619048,.541667,0,0,-.492063,.708333,0,0,-.365079,.854137,0,0,-.238095,.937488,.039062,0,-.111111,1,.208333,0,.015873,1,.375,0,.142857,1,.541667,0,.269841,1,.708333,0,.396825,1,.858805,.03125,.52381,1,.947392,.15625,.650794,1,1,.3125,.777778,1,1,.5625,.904762,1,1,.8125,1,1,1,1]},{ColorSpace:"Lab",Name:"erdc_red2yellow_BW",RGBPoints:[-1,754296e-12,0,109827e-10,-.87451,.18285,.0264094,0,-.74902,.3066,0,0,-.623529,.422841,0,0,-.498039,.522945,0,0,-.372549,.605721,0,0,-.247059,.672502,.14168,0,-.121569,.728167,.244025,0,.00392157,.781215,.333454,0,.129412,.825,.423586,0,.254902,.855893,.516793,0,.380392,.880491,.608846,0,.505882,.910305,.695505,0,.631373,.94109,.779067,.223528,.756863,.967873,.858572,.473521,.882353,.986815,.933211,.751583,1,1,1,.999997]},{ColorSpace:"Lab",Name:"erdc_marine2gold_BW",RGBPoints:[-1,111641e-12,0,162551e-11,-.87451,.0413146,.0619808,.209857,-.74902,.0185557,.101341,.350684,-.623529,.00486405,.149847,.461054,-.498039,.0836345,.210845,.517906,-.372549,.173222,.276134,.541793,-.247059,.259857,.343877,.535869,-.121569,.362299,.408124,.504293,.00392157,.468266,.468276,.468257,.129412,.582781,.527545,.374914,.254902,.691591,.585251,.274266,.380392,.784454,.645091,.247332,.505882,.862299,.710383,.27518,.631373,.920863,.782923,.351563,.756863,.955792,.859699,.533541,.882353,.976162,.93433,.780671,1,1,1,.999983]},{ColorSpace:"Lab",Name:"erdc_blue2gold_BW",RGBPoints:[-1,0,0,0,-.87451,.0742735,.0440331,.230013,-.74902,.125276,.0258685,.415826,-.623529,.143879,.0163031,.591346,-.498039,.212261,.0627855,.705239,-.372549,.306048,.141178,.763636,-.247059,.391537,.232286,.773263,-.121569,.461734,.336633,.708321,.00392157,.54209,.427581,.590007,.129412,.61704,.508623,.460978,.254902,.702703,.579586,.309117,.380392,.790336,.644811,.170397,.505882,.870173,.710733,.117134,.631373,.93656,.781991,.157144,.756863,.965672,.862068,.409836,.882353,.985751,.936296,.714162,1,1,1,.999999]},{ColorSpace:"Lab",Name:"erdc_sapphire2gold_BW",RGBPoints:[-1,.107704,.107708,.107694,-.87451,.1851,.112354,.308554,-.74902,.236782,.114233,.48788,-.623529,.28296,.126187,.639464,-.498039,.344787,.171643,.739713,-.372549,.413325,.242371,.76913,-.247059,.481863,.3131,.719841,-.121569,.550402,.383829,.612222,.00392157,.61894,.454558,.51126,.129412,.687478,.525287,.39993,.254902,.756017,.596016,.289923,.380392,.824555,.666745,.255498,.505882,.892979,.736822,.27696,.631373,.938851,.804966,.351734,.756863,.966491,.874853,.53572,.882353,.982105,.94153,.782579,1,1,1,.999986]},{ColorSpace:"Lab",Name:"erdc_red2purple_BW",RGBPoints:[-1,0,0,0,-.87451,.167793,.0166271,.0431278,-.74902,.262608,.0107595,.0791181,-.623529,.351902,.0101858,.100926,-.498039,.441257,.0160835,.131919,-.372549,.5221,.0555972,.195625,-.247059,.593852,.104294,.310234,-.121569,.654628,.158115,.448486,.00392157,.707443,.220914,.570253,.129412,.749504,.293268,.67897,.254902,.781587,.370517,.779269,.380392,.809951,.451099,.855831,.505882,.84424,.531462,.900451,.631373,.865174,.620901,.91606,.756863,.875041,.714054,.910284,.882353,.880764,.80554,.896276,1,.887572,.887591,.887556]},{ColorSpace:"Lab",Name:"erdc_purple2pink_BW",RGBPoints:[-1,0,0,0,-.87451,.117562,.0291202,.175876,-.74902,.178368,.0458476,.285454,-.623529,.237731,.0680173,.387717,-.498039,.300877,.0956291,.484802,-.372549,.370929,.136858,.554985,-.247059,.449033,.189273,.58863,-.121569,.529971,.245796,.598587,.00392157,.609914,.300643,.610244,.129412,.697079,.351286,.616371,.254902,.785858,.401991,.617376,.380392,.862517,.45745,.64463,.505882,.91359,.525462,.705336,.631373,.932583,.61064,.767412,.756863,.922478,.706966,.817522,.882353,.901302,.803071,.856311,1,.887571,.887591,.887549]},{ColorSpace:"Lab",Name:"erdc_pbj_lin",RGBPoints:[-1,0,0,0,-.87451,.091821,.0611476,.10617,-.74902,.160311,.0900022,.192713,-.623529,.22484,.12126,.272128,-.498039,.291263,.157469,.340828,-.372549,.360015,.200388,.388903,-.247059,.437497,.250058,.387201,-.121569,.512636,.304969,.355955,.00392157,.582603,.360874,.33488,.129412,.655126,.416374,.306351,.254902,.725889,.473329,.279051,.380392,.778125,.537928,.302697,.505882,.815894,.606931,.382431,.631373,.839159,.679308,.497608,.756863,.854748,.751666,.631792,.882353,.869483,.822508,.768592,1,.887572,.887589,.887565]},{ColorSpace:"Lab",Name:"erdc_blue2green_muted",RGBPoints:[-1,.107704,.107708,.107695,-.87451,.141522,.13066,.270741,-.74902,.180123,.146119,.42308,-.623529,.210161,.169674,.551795,-.498039,.239701,.212939,.634969,-.372549,.253916,.282947,.653641,-.247059,.242791,.366933,.608521,-.121569,.226302,.446776,.52693,.00392157,.236237,.514689,.458798,.129412,.274641,.577589,.376069,.254902,.349625,.633993,.288131,.380392,.4437,.683677,.260497,.505882,.536247,.731214,.285424,.631373,.628472,.777128,.349151,.756863,.718259,.819287,.496825,.882353,.804768,.856164,.703299,1,.887571,.887591,.887548]},{ColorSpace:"Lab",Name:"erdc_blue2green_BW",RGBPoints:[-1,363578e-12,0,529374e-11,-.87451,.0539915,.0577948,.212806,-.74902,.0620393,.0758942,.388959,-.623529,.0697499,.102032,.54177,-.498039,.113295,.156156,.64334,-.372549,.152047,.243196,.670283,-.247059,.158096,.344084,.622864,-.121569,.151142,.43922,.532767,.00392157,.17155,.521588,.457719,.129412,.225861,.599141,.363997,.254902,.32328,.67007,.259083,.380392,.442344,.733697,.223754,.505882,.558409,.794941,.257411,.631373,.673875,.854344,.340822,.756863,.787244,.909326,.524717,.882353,.896483,.958063,.775914,1,1,1,.999982]},{ColorSpace:"Lab",Name:"GREEN-WHITE_LINEAR",RGBPoints:[-1,0,0,0,-.87451,0,.062745,0,-.74902,0,.12549,0,-.623529,0,.188235,0,-.498039,0,.25098,0,-.372549,0,.313725,0,-.247059,0,.376471,0,-.121569,.094118,.439216,0,.00392157,.196078,.501961,0,.129412,.294118,.564706,0,.254902,.396078,.627451,0,.380392,.498039,.690196,0,.505882,.6,.752941,.145098,.631373,.701961,.815686,.364706,.756863,.8,.878431,.580392,.882353,.901961,.941176,.796078,1,1,1,1]},{ColorSpace:"Lab",Name:"erdc_green2yellow_BW",RGBPoints:[-1,0,0,0,-.87451,0,.105542,.0603919,-.74902,0,.159454,.104148,-.623529,0,.219502,.15542,-.498039,0,.282276,.203811,-.372549,0,.346331,.235652,-.247059,0,.411765,.235428,-.121569,0,.477177,.217977,.00392157,.0593644,.541635,.21361,.129412,.233081,.604722,.210591,.254902,.369803,.664942,.226536,.380392,.498446,.722367,.288237,.505882,.601929,.782244,.380815,.631373,.703207,.840497,.512134,.756863,.803186,.896433,.674462,.882353,.903834,.950266,.846715,1,1,1,.999981]},{ColorSpace:"Lab",Name:"blue2cyan",RGBPoints:[-1,0,0,0,-.87451,0,.152941,.364706,-.74902,0,.254902,.470588,-.623529,0,.34902,.572549,-.498039,0,.443137,.670588,-.372549,0,.537255,.772549,-.247059,0,.627451,.870588,-.121569,0,.717647,.964706,.00392157,.0784314,.772549,1,.129412,.207843,.858824,1,.254902,.32549,.941176,1,.380392,.45098,1,1,.505882,.560784,1,1,.631373,.662745,1,1,.756863,.760784,1,1,.882353,.870588,1,1,1,1,1,1]},{ColorSpace:"Lab",Name:"erdc_blue2cyan_BW",RGBPoints:[-1,405298e-12,0,59012e-10,-.87451,.0207526,.0740933,.18093,-.74902,0,.121033,.30343,-.623529,0,.166892,.416095,-.498039,0,.216768,.524796,-.372549,.0164769,.275471,.608585,-.247059,.0544527,.344824,.659267,-.121569,.0880643,.419118,.688675,.00392157,.127938,.492556,.720256,.129412,.149476,.566946,.756918,.254902,.188961,.641333,.792122,.380392,.245482,.715336,.827609,.505882,.329216,.786235,.874761,.631373,.453558,.852803,.918466,.756863,.626281,.910493,.954,.882353,.82257,.958709,.980146,1,1,1,.999989]},{ColorSpace:"Lab",Name:"erdc_blue_BW",RGBPoints:[-1,0,0,0,-.87451,.0425591,.0763529,.150682,-.74902,.0569472,.119154,.275403,-.623529,.0635978,.164772,.395427,-.498039,.0774342,.213851,.510014,-.372549,.106815,.267034,.615102,-.247059,.122093,.324649,.720068,-.121569,.160851,.387068,.806956,.00392157,.213754,.453516,.878012,.129412,.26722,.524656,.932436,.254902,.326844,.599279,.968038,.380392,.403403,.674712,.984784,.505882,.499703,.745519,1,.631373,.615055,.813983,1,.756863,.74405,.879228,1,.882353,.877909,.941913,1,1,1,1,.999996]},{ColorSpace:"Lab",Name:"BLUE-WHITE",RGBPoints:[-1,0,0,0,-.87451,0,0,.082353,-.74902,0,0,.168627,-.623529,0,0,.254902,-.498039,0,0,.337255,-.372549,0,0,.423529,-.247059,0,0,.509804,-.121569,0,.101961,.592157,.00392157,0,.203922,.678431,.129412,0,.301961,.764706,.254902,0,.403922,.85098,.380392,0,.505882,.933333,.505882,0,.603922,1,.631373,.254902,.705882,1,.756863,.509804,.807843,1,.882353,.764706,.905882,1,1,1,1,1]},{ColorSpace:"Lab",Name:"erdc_purple_BW",RGBPoints:[-1,4264e-11,0,620844e-12,-.87451,.100579,.0593111,.145666,-.74902,.167794,.0889224,.254953,-.623529,.231446,.123339,.360511,-.498039,.296699,.163027,.461278,-.372549,.363211,.209286,.55306,-.247059,.431136,.260776,.637195,-.121569,.498202,.320012,.705799,.00392157,.567456,.380459,.778091,.129412,.629381,.445284,.8448,.254902,.688373,.517374,.895694,.380392,.74891,.590906,.93976,.505882,.805017,.667956,.977626,.631373,.850914,.752618,.992396,.756863,.89724,.838454,.994093,.882353,.948461,.922603,.994449,1,1,1,.999967]},{ColorSpace:"Lab",Name:"erdc_magenta_BW",RGBPoints:[-1,0,0,254023e-10,-.87451,.128696,.0456782,.11635,-.74902,.228133,.0476299,.201452,-.623529,.327273,.0374065,.282107,-.498039,.420953,.0408166,.35709,-.372549,.511562,.0642203,.430511,-.247059,.599552,.102686,.504257,-.121569,.684646,.150536,.579429,.00392157,.765817,.205978,.656062,.129412,.839176,.27229,.731807,.254902,.89536,.357594,.797309,.380392,.930238,.457825,.846984,.505882,.945921,.564536,.880571,.631373,.948995,.670753,.902279,.756863,.947124,.772819,.918171,.882353,.947265,.869424,.934352,1,.954719,.95475,.954726]},{ColorSpace:"Lab",Name:"magenta",RGBPoints:[-1,0,0,0,-.87451,.364706,0,.152941,-.74902,.470588,0,.254902,-.623529,.572549,0,.34902,-.498039,.670588,0,.443137,-.372549,.772549,0,.537255,-.247059,.870588,0,.627451,-.121569,.964706,0,.717647,.00392157,1,.0784314,.772549,.129412,1,.207843,.858824,.254902,1,.32549,.941176,.380392,1,.45098,1,.505882,1,.560784,1,.631373,1,.662745,1,.756863,1,.760784,1,.882353,1,.870588,1,1,1,1,1]},{ColorSpace:"Lab",Name:"RED-PURPLE",RGBPoints:[-1,0,0,0,-.87451,.188235,0,.007843,-.74902,.345098,0,.035294,-.623529,.439216,0,.098039,-.498039,.533333,0,.152941,-.372549,.627451,.015686,.211765,-.247059,.721569,.031373,.266667,-.121569,.8,.047059,.329412,.00392157,.862745,.047059,.403922,.129412,.941176,.062745,.466667,.254902,.988235,.078431,.54902,.380392,.988235,.141176,.643137,.505882,.988235,.25098,.729412,.631373,.988235,.376471,.811765,.756863,.988235,.54902,.886275,.882353,.988235,.752941,.952941,1,.996078,.996078,.996078]},{ColorSpace:"Lab",Name:"erdc_red_BW",RGBPoints:[-1,0,0,0,-.87451,.147204,.0480135,.0401815,-.74902,.253411,.0617478,.0301333,-.623529,.356059,.0746331,.0446897,-.498039,.457731,.0934935,.0636931,-.372549,.557199,.122714,.0860013,-.247059,.665179,.144238,.105585,-.121569,.763833,.187056,.138326,.00392157,.847035,.254558,.189407,.129412,.905663,.345937,.258215,.254902,.941431,.447111,.346277,.380392,.962608,.546927,.457571,.505882,.987833,.637276,.569944,.631373,.994202,.732176,.687958,.756863,.993304,.826268,.800567,.882353,.994413,.917205,.906393,1,1,1,.999979]},{ColorSpace:"Lab",Name:"RED_TEMPERATURE",RGBPoints:[-1,0,0,0,-.87451,.090196,0,0,-.74902,.180392,0,0,-.623529,.270588,0,0,-.498039,.360784,0,0,-.372549,.45098,0,0,-.247059,.545098,0,0,-.121569,.635294,0,0,.00392157,.72549,.058824,0,.129412,.815686,.176471,0,.254902,.905882,.294118,0,.380392,1,.411765,0,.505882,1,.533333,.027451,.631373,1,.65098,.27451,.756863,1,.768627,.521569,.882353,1,.886275,.768627,1,1,1,1]},{ColorSpace:"Lab",Name:"erdc_orange_BW",RGBPoints:[-1,0,0,253806e-10,-.87451,.135871,.0593824,0,-.74902,.224328,.0907216,0,-.623529,.318083,.119647,0,-.498039,.414443,.150246,0,-.372549,.511077,.184884,0,-.247059,.605501,.226033,0,-.121569,.695274,.275491,0,.00392157,.777826,.334445,0,.129412,.851498,.402441,0,.254902,.915899,.47759,602975e-9,.380392,.971984,.557882,.0361443,.505882,1,.641287,.135967,.631373,1,.725198,.27997,.756863,1,.808205,.438135,.882353,1,.89306,.587036,1,1,.977928,.721599]},{ColorSpace:"Lab",Name:"heated_object",RGBPoints:[-1,0,0,0,-.87451,.34902,.0862745,0,-.74902,.45098,.172549,0,-.623529,.52549,.231373,0,-.498039,.580392,.278431,0,-.372549,.623529,.313725,0,-.247059,.670588,.352941,0,-.121569,.717647,.392157,0,.00392157,.772549,.439216,0,.129412,.839216,.494118,0,.254902,.901961,.541176,0,.380392,.968627,.6,0,.505882,1,.658824,0,.631373,1,.721569,0,.756863,1,.827451,.298039,.882353,1,.976471,.72549,1,1,1,1]},{ColorSpace:"Lab",Name:"erdc_gold_BW",RGBPoints:[-1,0,0,190933e-10,-.87451,.128363,.0636265,0,-.74902,.193795,.111057,0,-.623529,.25976,.15987,0,-.498039,.328546,.210589,0,-.372549,.399726,.26332,0,-.247059,.472969,.318261,0,-.121569,.546245,.375827,0,.00392157,.61745,.436719,0,.129412,.685545,.501113,0,.254902,.749578,.568799,0,.380392,.80962,.6394,0,.505882,.865572,.712699,.10257,.631373,.917709,.787569,.233665,.756863,.966914,.863138,.369608,.882353,1,.939405,.496104,1,.999225,1,.612275]},{ColorSpace:"Lab",Name:"erdc_brown_BW",RGBPoints:[-1,33216e-11,0,483629e-11,-.87451,.14693,.0518172,0,-.74902,.225806,.0814996,0,-.623529,.301681,.111452,0,-.498039,.370487,.150664,0,-.372549,.43108,.199477,0,-.247059,.4849,.255107,0,-.121569,.536798,.313486,0,.00392157,.59286,.371167,0,.129412,.653119,.428135,0,.254902,.714589,.485917,.0379541,.380392,.774667,.54565,.116634,.505882,.831222,.608047,.183895,.631373,.880305,.674199,.260298,.756863,.922314,.742472,.367086,.882353,.959408,.811222,.497258,1,.993548,.875183,.622093]},{ColorSpace:"Lab",Name:"copper_Matlab",RGBPoints:[-1,0,0,0,-.87451,.0784314,.0501961,.0313725,-.74902,.156863,.100392,.0627451,-.623529,.235294,.150588,.0941176,-.498039,.313725,.200784,.12549,-.372549,.392157,.25098,.156863,-.247059,.470588,.301176,.188235,-.121569,.54902,.351373,.219608,.00392157,.627451,.401569,.25098,.129412,.705882,.451765,.282353,.254902,.784314,.501961,.313725,.380392,.862745,.552157,.345098,.505882,.941176,.602353,.376471,.631373,1,.652549,.407843,.756863,1,.702745,.439216,.882353,1,.752941,.470588,1,1,.8,.5]},{ColorSpace:"Lab",Name:"pink_Matlab",RGBPoints:[-1,0,0,0,-.87451,.312416,.204524,.204524,-.74902,.441822,.289241,.289241,-.623529,.54112,.354246,.354246,-.498039,.624831,.409048,.409048,-.372549,.698582,.45733,.45733,-.247059,.764404,.502282,.500979,-.121569,.791292,.591516,.54112,.00392157,.817297,.66895,.578481,.129412,.842499,.738308,.613572,.254902,.866968,.801687,.646762,.380392,.890766,.86041,.678329,.505882,.913944,.913944,.711254,.631373,.936549,.936549,.79459,.756863,.958621,.958621,.869979,.882353,.980196,.980196,.939336,1,1,1,1]},{ColorSpace:"Lab",Name:"bone_Matlab",RGBPoints:[-1,0,0,0,-.87451,.054902,.054902,.075817,-.74902,.109804,.109804,.151634,-.623529,.164706,.164706,.227451,-.498039,.219608,.219608,.303268,-.372549,.27451,.27451,.379085,-.247059,.329412,.329902,.454412,-.121569,.384314,.405719,.509314,.00392157,.439216,.481536,.564216,.129412,.494118,.557353,.619118,.254902,.54902,.63317,.67402,.380392,.603922,.708987,.728922,.505882,.660294,.783824,.783824,.631373,.746569,.838725,.838725,.756863,.832843,.893627,.893627,.882353,.919118,.948529,.948529,1,1,1,1]},{ColorSpace:"Lab",Name:"gray_Matlab",RGBPoints:[-1,0,0,0,-.87451,.0627451,.0627451,.0627451,-.74902,.12549,.12549,.12549,-.623529,.188235,.188235,.188235,-.498039,.25098,.25098,.25098,-.372549,.313725,.313725,.313725,-.247059,.376471,.376471,.376471,-.121569,.439216,.439216,.439216,.00392157,.501961,.501961,.501961,.129412,.564706,.564706,.564706,.254902,.627451,.627451,.627451,.380392,.690196,.690196,.690196,.505882,.752941,.752941,.752941,.631373,.815686,.815686,.815686,.756863,.878431,.878431,.878431,.882353,.941176,.941176,.941176,1,1,1,1]},{ColorSpace:"Lab",Name:"Purples",RGBPoints:[-1,.247059,0,.490196,-.87451,.288397,.07677,.525629,-.74902,.32975,.153587,.561092,-.623529,.373057,.236263,.600461,-.498039,.416363,.319,.639923,-.372549,.459669,.405613,.685198,-.247059,.503345,.491534,.730058,-.121569,.562399,.54862,.757616,.00392157,.621453,.606075,.785544,.129412,.680508,.674971,.824914,.254902,.739562,.743406,.863899,.380392,.798616,.800492,.893426,.505882,.85684,.856655,.922491,.631373,.898178,.894056,.942176,.756863,.938654,.930919,.961646,.882353,.964245,.958478,.977393,1,.988235,.984314,.992157]},{ColorSpace:"Lab",Name:"Blues",RGBPoints:[-1,.031373,.188235,.419608,-.87451,.031373,.253195,.516063,-.74902,.031757,.318139,.612149,-.623529,.080969,.38113,.661361,-.498039,.130427,.444152,.710327,-.372549,.195386,.509112,.743791,-.247059,.260715,.573841,.777209,-.121569,.341423,.628958,.808704,.00392157,.422745,.684075,.839892,.129412,.523137,.739193,.861546,.254902,.622684,.793464,.883429,.380392,.701423,.826928,.910988,.505882,.778685,.8603,.937993,.631373,.825928,.891795,.953741,.756863,.87328,.923291,.969489,.882353,.922491,.954787,.985236,1,.968627,.984314,1]},{ColorSpace:"Lab",Name:"Greens",RGBPoints:[-1,0,.266667,.105882,-.87451,0,.347374,.139346,-.74902,538e-6,.427912,.172933,-.623529,.069435,.486967,.222145,-.498039,.138178,.546082,.271326,-.372549,.197232,.609073,.31857,-.247059,.257255,.671742,.365859,-.121569,.357647,.720953,.415071,.00392157,.45767,.769919,.465021,.129412,.546251,.811257,.537855,.254902,.634295,.852211,.610688,.380392,.709097,.883706,.683522,.505882,.78316,.914833,.755894,.631373,.842215,.938454,.818885,.756863,.899977,.961538,.880692,.882353,.935409,.975317,.92203,1,.968627,.988235,.960784]},{ColorSpace:"Lab",Name:"PuBu",RGBPoints:[-1,.301961,0,.294118,-.87451,.404321,.029527,.390573,-.74902,.50599,.059592,.486782,-.623529,.519769,.158016,.551742,-.498039,.533456,.256194,.616301,-.372549,.54133,.33887,.655671,-.247059,.54902,.421592,.695087,-.121569,.54902,.506236,.736424,.00392157,.550127,.590573,.777701,.129412,.585559,.665375,.81707,.254902,.622145,.739023,.855825,.380392,.687105,.784298,.879446,.505882,.752065,.829758,.903253,.631373,.817024,.87897,.930811,.756863,.880907,.927213,.957832,.882353,.926182,.958708,.975548,1,.968627,.988235,.992157]},{ColorSpace:"Lab",Name:"BuPu",RGBPoints:[-1,.007843,.219608,.345098,-.87451,.01178,.286536,.449427,-.74902,.015702,.35328,.553479,-.623529,.01767,.396586,.622376,-.498039,.021115,.4402,.690688,-.372549,.11757,.503191,.722184,-.247059,.214625,.565859,.753633,-.121569,.336671,.615071,.78316,.00392157,.457978,.663975,.812503,.129412,.556401,.703345,.836125,.254902,.65421,.742714,.859669,.380392,.736886,.782084,.881323,.505882,.81827,.821638,.903068,.631373,.873387,.864944,.92669,.756863,.927536,.907605,.949988,.882353,.964937,.9391,.967705,1,1,.968627,.984314]},{ColorSpace:"Lab",Name:"BuGn",RGBPoints:[-1,.031373,.25098,.505882,-.87451,.031373,.329719,.590527,-.74902,.031911,.408397,.674787,-.623529,.100807,.479262,.710219,-.498039,.169704,.550219,.745744,-.372549,.238601,.62699,.787082,-.247059,.307958,.703114,.826759,-.121569,.39654,.752326,.797232,.00392157,.485121,.801046,.767705,.129412,.573702,.83451,.738178,.254902,.661592,.867743,.711034,.380392,.732457,.895302,.74253,.505882,.801845,.922307,.774579,.631373,.841215,.938055,.817885,.756863,.880907,.95391,.861084,.882353,.926182,.971626,.902422,1,.968627,.988235,.941176]},{ColorSpace:"Lab",Name:"GnBu",RGBPoints:[-1,0,.266667,.105882,-.87451,0,.347374,.139346,-.74902,538e-6,.427912,.172933,-.623529,.069435,.486967,.222145,-.498039,.138178,.546175,.272095,-.372549,.197232,.615071,.368551,-.247059,.256609,.683276,.464867,-.121569,.329443,.722645,.555417,.00392157,.403137,.762138,.645413,.129412,.503529,.805444,.718247,.254902,.603922,.848597,.790465,.380392,.704314,.887966,.847551,.505882,.802307,.926321,.903714,.631373,.851519,.944037,.941115,.756863,.899977,.961538,.976901,.882353,.935409,.975317,.984775,1,.968627,.988235,.992157]},{ColorSpace:"Lab",Name:"GnBuPu",RGBPoints:[-1,.003922,.27451,.211765,-.87451,.003922,.349312,.280661,-.74902,.003937,.423852,.349773,-.623529,.005905,.46519,.446228,-.498039,.009443,.506344,.542837,-.372549,.111803,.535871,.649135,-.247059,.214025,.565859,.753633,-.121569,.310481,.615071,.78316,.00392157,.407797,.663975,.812503,.129412,.531811,.703345,.836125,.254902,.65421,.742714,.859669,.380392,.736886,.782084,.881323,.505882,.81827,.821176,.902884,.631373,.873387,.854641,.922568,.756863,.927536,.888535,.942361,.882353,.964937,.929873,.964014,1,1,.968627,.984314]},{ColorSpace:"Lab",Name:"BuGnYl",RGBPoints:[-1,.031373,.113725,.345098,-.87451,.088458,.159,.463206,-.74902,.145052,.204567,.5807,-.623529,.139146,.287243,.620069,-.498039,.13318,.370196,.659562,-.372549,.123337,.470588,.706805,-.247059,.115386,.570335,.753126,-.121569,.186251,.643168,.761,.00392157,.258716,.71514,.768074,.129412,.380761,.760415,.750358,.254902,.503576,.806075,.732795,.380392,.645306,.861192,.719016,.505882,.783899,.91511,.705606,.631373,.858701,.944637,.6997,.756863,.931349,.973303,.698424,.882353,.966782,.987082,.777163,1,1,1,.85098]},{ColorSpace:"Lab",Name:"PuRd",RGBPoints:[-1,.286275,0,.415686,-.87451,.38273,.001968,.441276,-.74902,.479231,.003922,.466774,-.623529,.581592,.003922,.480554,-.498039,.683799,.00549,.494887,-.372549,.776317,.105882,.544098,-.247059,.867866,.206321,.592618,-.121569,.919047,.308681,.612303,.00392157,.968812,.411226,.632603,.129412,.974717,.519493,.671972,.254902,.980546,.626451,.71065,.380392,.984483,.701253,.732303,.505882,.988328,.77504,.755617,.631373,.990296,.828189,.812703,.756863,.992372,.880907,.869035,.882353,.996309,.926182,.912341,1,1,.968627,.952941]},{ColorSpace:"Lab",Name:"RdPu",RGBPoints:[-1,.403922,0,.121569,-.87451,.500377,0,.192434,-.74902,.596909,277e-6,.263037,-.623529,.703206,.035709,.300438,-.498039,.808612,.071296,.338854,-.372549,.857824,.116571,.441215,-.247059,.905513,.163552,.54293,-.121569,.889765,.281661,.617732,.00392157,.873156,.39897,.691611,.129412,.82985,.491488,.736886,.254902,.789081,.583237,.781853,.380392,.810734,.656071,.819254,.505882,.833126,.729181,.85684,.631373,.870527,.80792,.898178,.756863,.907605,.884398,.938331,.882353,.9391,.921799,.958016,1,.968627,.956863,.976471]},{ColorSpace:"Lab",Name:"Oranges",RGBPoints:[-1,.498039,.152941,.015686,-.87451,.57481,.182468,.013718,-.74902,.651765,.212042,.011734,-.623529,.752157,.247474,.007797,-.498039,.851719,.283368,.004475,-.372549,.898962,.348328,.039908,-.247059,.945652,.413426,.076401,-.121569,.969273,.484291,.157109,.00392157,.992157,.554971,.238185,.129412,.992157,.619931,.330704,.254902,.992157,.684967,.423837,.380392,.992157,.751895,.532103,.505882,.992249,.817716,.639354,.631373,.994218,.861023,.725967,.756863,.996186,.903576,.810965,.882353,.998155,.933103,.868051,1,1,.960784,.921569]},{ColorSpace:"Lab",Name:"Reds",RGBPoints:[-1,.403922,0,.05098,-.87451,.525967,.029527,.066728,-.74902,.647643,.058962,.082476,-.623529,.722445,.076678,.098224,-.498039,.797186,.095194,.114187,-.372549,.868051,.164091,.143714,-.247059,.937809,.233541,.173933,-.121569,.96143,.326059,.232987,.00392157,.984375,.418147,.292657,.129412,.986344,.496886,.371396,.254902,.988235,.575702,.450673,.380392,.988235,.656409,.543191,.505882,.98842,.736747,.635894,.631373,.992357,.809581,.732349,.756863,.996186,.880692,.826759,.882353,.998155,.92203,.885813,1,1,.960784,.941176]},{ColorSpace:"Lab",Name:"RdOr",RGBPoints:[-1,.498039,0,0,-.87451,.6004,0,0,-.74902,.702514,738e-6,477e-6,-.623529,.773379,.095225,.061499,-.498039,.843875,.189865,.12283,-.372549,.891119,.294195,.203537,-.247059,.937855,.397924,.283137,-.121569,.963445,.476663,.316601,.00392157,.988297,.555771,.351665,.129412,.990265,.646321,.436309,.254902,.992157,.735256,.519646,.380392,.992157,.784468,.570827,.505882,.992249,.833218,.623483,.631373,.994218,.872587,.706159,.756863,.996186,.911419,.788189,.882353,.998155,.940946,.859054,1,1,.968627,.92549]},{ColorSpace:"Lab",Name:"BrOrYl",RGBPoints:[-1,.4,.145098,.023529,-.87451,.500392,.174625,.019592,-.74902,.600784,.204291,.015656,-.623529,.701176,.251534,.011719,-.498039,.800984,.299146,.008397,-.372549,.863975,.370012,.043829,-.247059,.926321,.441107,.0794,-.121569,.961753,.521815,.120738,.00392157,.996078,.602645,.163122,.129412,.996078,.68729,.237924,.254902,.996078,.771011,.314879,.380392,.996078,.832034,.444798,.505882,.996171,.892042,.572595,.631373,.998139,.931411,.65724,.756863,1,.969489,.741669,.882353,1,.985236,.822376,1,1,1,.898039]},{ColorSpace:"Lab",Name:"RdOrYl",RGBPoints:[-1,.501961,0,.14902,-.87451,.622038,0,.14902,-.74902,.741761,4e-4,.148866,-.623529,.816563,.05158,.129181,-.498039,.890965,.10356,.110235,-.372549,.940177,.205921,.137793,-.247059,.988281,.308789,.165536,-.121569,.99025,.432803,.200969,.00392157,.992218,.555217,.236278,.129412,.994187,.628051,.267774,.254902,.996078,.701038,.301269,.380392,.996078,.777809,.383945,.505882,.996171,.852826,.466621,.631373,.998139,.892195,.549296,.756863,1,.931349,.632188,.882353,1,.966782,.7188,1,1,1,.8]},{ColorSpace:"Lab",Name:"CIELab_blue2red",RGBPoints:[-1,0,.6,.74902,1,.76863,.46667,.34118]},{ColorSpace:"Lab",Name:"blue2yellow",RGBPoints:[-1,0,0,1,0,.5,.5,.5,1,1,1,0]},{ColorSpace:"Lab",Name:"erdc_blue2gold",RGBPoints:[-1,.175119,.0438468,1,-.874016,.22383,.159771,.94557,-.748031,.27254,.233611,.891216,-.622047,.321251,.296526,.836857,-.496063,.369962,.354296,.782359,-.370079,.418672,.409139,.72754,-.244094,.467383,.462152,.672148,-.11811,.51609,.51396,.615825,.00787402,.572863,.55452,.559172,.133858,.630269,.593822,.517729,.259843,.689588,.624668,.47446,.385827,.745394,.656113,.428638,.511811,.798624,.688104,.379105,.637795,.849926,.720593,.323834,.76378,.899765,.753543,.258657,.889764,.948487,.78692,.171778,1,.990413,.816451,.00729848]},{ColorSpace:"Lab",Name:"erdc_blue2yellow",RGBPoints:[-1,.0830122,0,.495617,-.87451,.141973,.0551288,.57363,-.74902,.193048,.110258,.604561,-.623529,.234231,.165386,.57643,-.498039,.275413,.220515,.548299,-.372549,.316596,.275644,.520169,-.247059,.357778,.330773,.492038,-.121569,.398961,.385901,.463908,.00392157,.449929,.438487,.426815,.129412,.511572,.488299,.379944,.254902,.581222,.53603,.325741,.380392,.650871,.583761,.271538,.505882,.720521,.631493,.217335,.631373,.79017,.679224,.163132,.756863,.85982,.726955,.108929,.882353,.910254,.774159,.14112,1,.927513,.81759,.306289]},{ColorSpace:"Lab",Name:"erdc_cyan2orange",RGBPoints:[-1,.0471513,.213874,.414329,-.87451,.0674702,.256648,.439027,-.74902,.0959957,.299331,.462089,-.623529,.132428,.341872,.483212,-.498039,.188743,.38277,.500597,-.372549,.268511,.420229,.512179,-.247059,.352945,.455602,.519101,-.121569,.43893,.489368,.521538,.00392157,.522445,.522495,.522436,.129412,.600089,.555682,.53205,.254902,.67988,.587981,.539163,.380392,.761011,.619586,.544439,.505882,.84278,.650741,.548567,.631373,.910713,.687347,.557822,.756863,.952232,.734972,.577775,.882353,.975642,.789858,.604868,1,.990752,.843643,.632857]},{ColorSpace:"Lab",Name:"erdc_purple2green",RGBPoints:[-1,.235006,.0483128,.530899,-.87451,.302968,.108419,.552391,-.74902,.360241,.166059,.569502,-.623529,.406746,.226782,.579373,-.498039,.444073,.28964,.582094,-.372549,.473648,.353774,.577947,-.247059,.497636,.418154,.567911,-.121569,.519086,.481741,.553968,.00392157,.542884,.542914,.542875,.129412,.566303,.603989,.527499,.254902,.595218,.662965,.516857,.380392,.628641,.720701,.510673,.505882,.665373,.777849,.508165,.631373,.704182,.834921,.508303,.756863,.743846,.892328,.50999,.882353,.783158,.950422,.512181,1,.818617,1,.513888]},{ColorSpace:"Lab",Name:"erdc_purple2green_dark",RGBPoints:[-1,.107656,0,.428682,-.87451,.1924,0,.449799,-.74902,.255118,.0648939,.466726,-.623529,.304256,.133066,.476703,-.498039,.343202,.19716,.479793,-.372549,.373876,.260353,.476241,-.247059,.398497,.322872,.466953,-.121569,.420016,.384252,.453785,.00392157,.44319,.443216,.443186,.129412,.465553,.502139,.428233,.254902,.492959,.559151,.417591,.380392,.524654,.615092,.411016,.505882,.55959,.670583,.40779,.631373,.596614,.726102,.406948,.756863,.634544,.782032,.407439,.882353,.672183,.838703,.408237,1,.706131,.892759,.408452]},{ColorSpace:"Lab",Name:"coolwarm",RGBPoints:[-1,.229806,.298718,.753683,-.875,.303869,.406535,.844959,-.75,.383013,.509419,.917388,-.625,.466667,.604563,.968155,-.5,.552953,.688929,.995376,-.375,.639176,.7596,.998151,-.25,.722193,.813953,.976575,-.125,.798692,.849786,.931689,0,.865395,.86541,.865396,.125,.924128,.827385,.774508,.25,.958853,.769768,.678008,.375,.969954,.694267,.579375,.5,.958003,.602842,.481776,.625,.923945,.497309,.38797,.75,.869187,.378313,.300267,.875,.795632,.241284,.220526,1,.705673,.0155562,.150233]},{ColorSpace:"Lab",Name:"BuRd",RGBPoints:[-1,.019608,.188235,.380392,-.87451,.088504,.321107,.564937,-.74902,.163399,.444983,.697501,-.623529,.247059,.555709,.754095,-.498039,.420684,.676432,.818685,-.372549,.606459,.789773,.880277,-.247059,.761476,.868512,.924567,-.121569,.878047,.925721,.951942,.00392157,.969089,.966474,.964937,.129412,.983852,.897578,.846828,.254902,.982468,.800692,.706113,.380392,.960323,.66782,.536332,.505882,.894579,.503806,.399769,.631373,.81707,.33218,.281046,.756863,.728489,.155017,.197386,.882353,.576932,.055363,.14925,1,.403922,0,.121569]},{ColorSpace:"Lab",Name:"Spectral_lowBlue",RGBPoints:[-1,.368627,.309804,.635294,-.87451,.260361,.450058,.70173,-.74902,.248058,.591311,.717186,-.623529,.376009,.734025,.658132,-.498039,.537947,.814764,.64506,-.372549,.702345,.879585,.636678,-.247059,.84752,.938639,.607151,-.121569,.940408,.976163,.656055,.00392157,.999923,.997616,.745021,.129412,.997463,.921338,.61707,.254902,.995002,.824606,.499885,.380392,.992541,.701576,.39654,.505882,.973472,.547405,.318108,.631373,.937793,.398539,.270127,.756863,.861515,.282891,.299654,.882353,.746482,.144637,.288812,1,.619608,.003922,.258824]},{ColorSpace:"Lab",Name:"GnRP",RGBPoints:[-1,0,.266667,.105882,-.87451,.066436,.394617,.174779,-.74902,.168858,.524567,.25767,-.623529,.323875,.657439,.361015,-.498039,.504883,.772318,.506344,-.372549,.678431,.870127,.654902,-.247059,.803922,.921799,.780392,-.121569,.897116,.951942,.882814,.00392157,.967397,.965936,.967474,.129412,.928028,.879815,.930565,.254902,.866052,.780777,.882891,.380392,.77501,.665129,.821376,.505882,.675663,.537024,.737024,.631373,.57847,.396155,.645982,.756863,.492349,.223914,.547559,.882353,.375548,.096886,.423299,1,.25098,0,.294118]},{ColorSpace:"Lab",Name:"GYPi",RGBPoints:[-1,.152941,.392157,.098039,-.87451,.246444,.505344,.117724,-.74902,.351942,.614533,.161399,-.623529,.474971,.717878,.240138,-.498039,.611995,.811226,.392849,-.372549,.746328,.893118,.565321,-.247059,.859516,.94233,.747405,-.121569,.928105,.96386,.875663,.00392157,.969089,.966859,.968012,.129412,.983852,.910265,.948328,.254902,.979239,.833218,.914648,.380392,.949712,.729873,.862976,.505882,.905652,.58293,.763552,.631373,.85521,.410073,.652211,.756863,.793695,.183699,.531642,.882353,.683737,.063899,.420761,1,.556863,.003922,.321569]},{ColorSpace:"Lab",Name:"GnYlRd",RGBPoints:[-1,0,.407843,.215686,-.87451,.063975,.525952,.277201,-.74902,.177932,.633064,.332718,-.623529,.364937,.724106,.379469,-.498039,.527951,.797155,.40223,-.372549,.678431,.862822,.433449,-.247059,.803922,.916955,.514648,-.121569,.909419,.961861,.625067,.00392157,.999923,.997616,.745021,.129412,.997463,.921338,.61707,.254902,.995002,.824606,.499885,.380392,.992541,.701576,.39654,.505882,.973472,.547405,.318108,.631373,.939023,.389927,.245521,.756863,.867666,.239831,.176624,.882353,.762399,.110727,.151326,1,.647059,0,.14902]},{ColorSpace:"Lab",Name:"GBBr",RGBPoints:[-1,0,.235294,.188235,-.87451,.002461,.338639,.301423,-.74902,.055902,.448981,.417609,-.623529,.183852,.56955,.538178,-.498039,.357785,.700115,.660746,-.372549,.540177,.819531,.77624,-.247059,.714879,.890888,.864821,-.121569,.851134,.934564,.922645,.00392157,.960861,.959785,.95694,.129412,.963322,.927797,.83391,.254902,.939946,.868897,.68935,.380392,.883353,.775394,.517109,.505882,.808074,.625836,.324106,.631373,.717647,.476355,.15494,.756863,.592157,.358247,.06882,.882353,.458593,.26436,.031142,1,.329412,.188235,.019608]},{ColorSpace:"Lab",Name:"PuOr",RGBPoints:[-1,.498039,.231373,.031373,-.87451,.62599,.30273,.026451,-.74902,.746943,.387082,.037524,-.623529,.85767,.490427,.071972,-.498039,.936409,.617762,.236371,-.372549,.992695,.743099,.43291,-.247059,.995156,.841523,.63714,-.121569,.985313,.913802,.813687,.00392157,.966244,.966398,.967705,.129412,.889965,.89504,.938178,.254902,.806151,.804306,.894656,.380392,.712649,.688658,.833141,.505882,.594233,.554325,.744637,.631373,.474894,.404229,.652364,.756863,.366628,.217224,.563783,.882353,.266436,.089965,.434833,1,.176471,0,.294118]},{ColorSpace:"Lab",Name:"PRGn",RGBPoints:[-1,.25098,0,.294118,-.87451,.383852,.103345,.431911,-.74902,.497732,.234679,.55371,-.623529,.583852,.40692,.652134,-.498039,.681968,.545175,.742561,-.372549,.7807,.672357,.825221,-.247059,.871742,.788005,.886736,-.121569,.930488,.885198,.932872,.00392157,.966321,.968089,.965859,.129412,.892503,.950865,.877278,.254902,.796078,.91857,.772549,.380392,.670588,.866897,.647059,.505882,.493195,.765398,.496655,.631373,.314187,.649135,.354556,.756863,.15917,.516263,.251211,.882353,.062284,.386621,.170473,1,0,.266667,.105882]},{ColorSpace:"Lab",Name:"PiYG",RGBPoints:[-1,.556863,.003922,.321569,-.87451,.692195,.067897,.427374,-.74902,.797539,.197847,.539177,-.623529,.859054,.424221,.659746,-.498039,.908574,.592618,.770319,-.372549,.951557,.736332,.866205,-.247059,.981084,.839677,.917878,-.121569,.98293,.913802,.949558,.00392157,.96732,.968474,.965629,.129412,.92549,.963552,.869666,.254902,.852441,.939254,.736025,.380392,.739254,.890042,.553941,.505882,.60323,.805536,.382238,.631373,.467282,.711419,.235217,.756863,.344252,.608074,.156478,.882353,.2406,.49827,.116494,1,.152941,.392157,.098039]},{ColorSpace:"Lab",Name:"OrPu",RGBPoints:[-1,.176471,0,.294118,-.87451,.272434,.095963,.444214,-.74902,.373395,.228912,.56932,-.623529,.481661,.415917,.657901,-.498039,.601922,.562937,.750481,-.372549,.718493,.695886,.836986,-.247059,.811995,.811534,.898501,-.121569,.894733,.8995,.940023,.00392157,.969166,.966859,.963629,.129412,.98639,.910265,.803691,.254902,.995002,.835371,.624375,.380392,.992541,.736947,.420146,.505882,.931949,.609458,.224221,.631373,.85075,.483968,.069819,.756863,.740023,.380623,.035371,.882353,.617993,.29827,.026759,1,.498039,.231373,.031373]},{ColorSpace:"Lab",Name:"BrBG",RGBPoints:[-1,.329412,.188235,.019608,-.87451,.467205,.269435,.031911,-.74902,.6,.365629,.074202,-.623529,.72549,.483737,.160323,-.498039,.812995,.635832,.336409,-.372549,.88689,.781238,.527874,-.247059,.943483,.87474,.700115,-.121569,.963168,.929796,.841599,.00392157,.957247,.959938,.959554,.129412,.84406,.932872,.920185,.254902,.70396,.886428,.859285,.380392,.529258,.815071,.770704,.505882,.346251,.691811,.653057,.631373,.175855,.562015,.530642,.756863,.047905,.441446,.410073,.882353,.002307,.33218,.294348,1,0,.235294,.188235]},{ColorSpace:"Lab",Name:"GyRd",RGBPoints:[-1,.101961,.101961,.101961,-.87451,.227451,.227451,.227451,-.74902,.359939,.359939,.359939,-.623529,.502653,.502653,.502653,-.498039,.631373,.631373,.631373,-.372549,.749865,.749865,.749865,-.247059,.843368,.843368,.843368,-.121569,.926105,.926105,.926105,.00392157,.999846,.997232,.995694,.129412,.994925,.908651,.857901,.254902,.982468,.800692,.706113,.380392,.960323,.66782,.536332,.505882,.894579,.503806,.399769,.631373,.81707,.33218,.281046,.756863,.728489,.155017,.197386,.882353,.576932,.055363,.14925,1,.403922,0,.121569]},{ColorSpace:"Lab",Name:"erdc_divHi_purpleGreen",RGBPoints:[-1,.297553,0,.489074,-.87451,.40259,.151146,.567754,-.74902,.516038,.284843,.658231,-.623529,.629783,.423646,.750938,-.498039,.735198,.563697,.835956,-.372549,.82408,.695541,.903582,-.247059,.889091,.807454,.944862,-.121569,.92334,.886917,.951839,.00392157,.921045,.921084,.921003,.129412,.877324,.907455,.845381,.254902,.797649,.849713,.734695,.380392,.691646,.75964,.600532,.505882,.568981,.649159,.453807,.631373,.438945,.529756,.304259,.756863,.30973,.412001,.158303,.882353,.187078,.305111,.00251458,1,.101655,.220836,0]},{ColorSpace:"Lab",Name:"erdc_divHi_purpleGreen_dim",RGBPoints:[-1,.404088,.131038,.592767,-.87451,.486469,.230957,.651243,-.74902,.575165,.339335,.717723,-.623529,.662741,.454332,.784263,-.498039,.742071,.570213,.842918,-.372549,.806935,.678992,.886227,-.247059,.852219,.771315,.90763,-.121569,.873345,.837327,.901572,.00392157,.866783,.86682,.866745,.129412,.82839,.858225,.796812,.254902,.762578,.814287,.700202,.380392,.676429,.744229,.585735,.505882,.577033,.65732,.461526,.631373,.47128,.562476,.33476,.756863,.365461,.467957,.21076,.882353,.264758,.381138,.0878313,1,.182591,.312249,0]},{ColorSpace:"Lab",Name:"erdc_divLow_icePeach",RGBPoints:[-1,.480048,.817441,.998056,-.87451,.425898,.726921,.883187,-.74902,.366682,.629445,.761936,-.623529,.308756,.531002,.640217,-.498039,.258021,.43705,.523433,-.372549,.219244,.352381,.416348,-.247059,.195127,.281032,.322979,-.121569,.186286,.22627,.246525,.00392157,.192352,.19236,.192364,.129412,.255927,.214469,.191756,.254902,.340459,.254426,.206666,.380392,.444655,.309315,.234029,.505882,.565353,.376004,.270969,.631373,.697917,.450748,.314293,.756863,.836657,.529064,.360227,.882353,.972695,.614884,.413123,1,1,.705904,.472699]},{ColorSpace:"Lab",Name:"erdc_divLow_purpleGreen",RGBPoints:[-1,.956034,.666487,.952663,-.87451,.874457,.572698,.936352,-.74902,.753465,.488253,.909063,-.623529,.63309,.413507,.763833,-.498039,.514491,.345878,.620015,-.372549,.405008,.288141,.484376,-.247059,.311388,.241986,.363556,-.121569,.238722,.209044,.263449,.00392157,.192352,.192366,.192362,.129412,.200379,.233201,.168618,.254902,.230151,.291737,.165227,.380392,.279481,.366076,.178607,.505882,.344927,.453267,.205703,.631373,.421554,.549449,.242643,.756863,.503334,.649999,.284377,.882353,.583497,.749672,.324969,1,.650705,.837228,.356264]},{ColorSpace:"Lab",Name:"Haze_green",RGBPoints:[-1,1,.835294,.886275,-.87451,.937255,.756863,.870443,-.74902,.875817,.666376,.857807,-.623529,.778359,.583007,.808134,-.498039,.676253,.494118,.745098,-.372549,.561365,.390123,.682353,-.247059,.438344,.262745,.621496,-.121569,.321133,.141031,.558751,.00392157,.203922,.0217865,.495861,.129412,.265505,.129412,.433261,.254902,.311692,.255338,.37008,.380392,.356282,.377342,.310821,.505882,.39971,.488889,.258243,.631373,.442556,.604357,.205519,.756863,.48671,.71968,.152941,.882353,.529847,.830356,.100944,1,.572549,.933333,.054902]},{ColorSpace:"Lab",Name:"Haze_lime",RGBPoints:[-1,.704034,.784196,1,-.87451,.633111,.691418,.956078,-.74902,.564021,.600606,.912157,-.623529,.496827,.51189,.868235,-.498039,.43157,.425416,.824314,-.372549,.368248,.341347,.780392,-.247059,.306767,.259855,.736471,-.121569,.246862,.181069,.692549,.00392157,.191619,.109542,.648627,.129412,.257404,.194031,.604706,.254902,.321794,.278775,.560784,.380392,.387909,.364617,.516863,.505882,.456569,.451881,.472941,.631373,.527424,.540773,.42902,.756863,.599759,.631427,.385098,.882353,.673065,.723898,.341176,1,.742751,.812252,.3]},{ColorSpace:"RGB",Name:"Haze",RGBPoints:[-1,1,.835294,.996078,-.00392157,.023529,.141176,.498039,.00392157,.015686,.137255,.494118,1,.984314,.764706,0]},{ColorSpace:"Lab",Name:"Haze_cyan",RGBPoints:[-1,.956863,1,.835294,-.87451,.933188,.921714,.760784,-.74902,.870588,.803486,.671605,-.623529,.807843,.684096,.583297,-.498039,.745098,.569208,.494118,-.372549,.682353,.437763,.390123,-.247059,.621496,.288163,.262745,-.121569,.558751,.144517,.141031,.00392157,.495861,.0217865,.0413943,.129412,.433261,.137255,.129412,.254902,.37008,.263181,.255338,.380392,.306318,.381845,.372694,.505882,.243137,.503994,.494263,.631373,.180392,.629484,.619753,.756863,.117647,.754975,.747131,.882353,.054902,.876398,.866812,1,0,.988235,.976471]},{ColorSpace:"Lab",Name:"nic_Edge",RGBPoints:[-1,.191208,.191208,.191208,-.87451,.239484,.00545035,.614821,-.74902,.220593,.0617459,.863547,-.623529,.17509,.278988,.97794,-.498039,.143526,.576069,.998553,-.372549,.166456,.871883,.96594,-.247059,.376202,.993555,.981833,-.121569,.681996,.991297,.999239,.00392157,.954172,.952734,.94374,.129412,.999735,.99301,.662896,.254902,.979399,.991466,.357973,.380392,.968771,.854967,.162659,.505882,.999245,.556697,.144323,.631373,.973959,.26223,.177946,.756863,.852358,.0526707,.222974,.882353,.593889,.00912724,.238855,1,.191208,.191208,.191208]},{ColorSpace:"Lab",Name:"erdc_iceFire_H",RGBPoints:[-1,405432e-12,0,590122e-11,-.87451,0,.120401,.302675,-.74902,0,.216583,.524574,-.623529,.0552475,.345025,.6595,-.498039,.128047,.492588,.720288,-.372549,.188955,.641309,.792092,-.247059,.327673,.784935,.873434,-.121569,.60824,.892164,.935547,.00392157,.881371,.912178,.818099,.129412,.951407,.835621,.449279,.254902,.904481,.690489,0,.380392,.85407,.510864,0,.505882,.777093,.33018,88199e-8,.631373,.672862,.139087,.00269398,.756863,.508815,0,0,.882353,.299417,366289e-9,547829e-9,1,.0157519,.00332021,455569e-13]},{ColorSpace:"Lab",Name:"erdc_iceFire_L",RGBPoints:[-1,.870485,.913768,.832905,-.87451,.586919,.887865,.934003,-.74902,.31583,.776442,.867858,-.623529,.18302,.632034,.787722,-.498039,.117909,.484134,.713825,-.372549,.0507239,.335979,.654741,-.247059,0,.209874,.511832,-.121569,0,.114689,.28935,.00392157,.0157519,.00332021,455569e-13,.129412,.312914,0,0,.254902,.520865,0,0,.380392,.680105,.15255,.0025996,.505882,.785109,.339479,797922e-9,.631373,.857354,.522494,0,.756863,.910974,.699774,0,.882353,.951921,.842817,.478545,1,.881371,.912178,.818099]},{ColorSpace:"RGB",Name:"hsv",RGBPoints:[-1,1,0,0,-.666666,1,0,1,-.333333,0,0,1,0,0,1,1,.33333,0,1,0,.66666,1,1,0,1,1,0,0]},{ColorSpace:"Lab",Name:"hue_L60",RGBPoints:[-1,.964784,.400592,.349549,-.87451,.964915,.372498,.53785,-.74902,.892353,.401039,.759569,-.623529,.79263,.446956,.903017,-.498039,.682208,.49954,.966673,-.372549,.56392,.553082,.968836,-.247059,.442031,.606396,.901601,-.121569,.305499,.65701,.765784,.00392157,.197251,.687914,.620914,.129412,.193882,.701887,.472654,.254902,.249866,.706123,.320005,.380392,.35132,.697417,.202919,.505882,.498097,.669467,.125232,.631373,.637477,.626239,.107431,.756863,.762115,.56872,.155812,.882353,.889434,.481116,.240445,1,.964784,.400592,.349549]},{IndexedColors:[0,0,0,.8941176470588236,.1019607843137255,.1098039215686274,.2156862745098039,.4941176470588236,.7215686274509804,.3019607843137255,.6862745098039216,.2901960784313726,.596078431372549,.3058823529411765,.6392156862745098,1,.4980392156862745,0,.6509803921568628,.3372549019607843,.1568627450980392],Name:"Spectrum",NanColor:[.6509803921568628,.3372549019607843,.1568627450980392]},{IndexedColors:[.4745098039215686,.09019607843137255,.09019607843137255,.7098039215686275,.00392156862745098,.00392156862745098,.9372549019607843,.2784313725490196,.09803921568627451,.9764705882352941,.5137254901960784,.1411764705882353,1,.7058823529411765,0,1,.8980392156862745,.02352941176470588],Name:"Warm",NanColor:[1,.8980392156862745,.02352941176470588]},{IndexedColors:[.4588235294117647,.6941176470588235,.00392156862745098,.3450980392156863,.5019607843137255,.1607843137254902,.3137254901960784,.8431372549019608,.7490196078431373,.1098039215686274,.5843137254901961,.803921568627451,.2313725490196079,.407843137254902,.6705882352941176,.6039215686274509,.407843137254902,1,.3725490196078431,.2,.5019607843137255],Name:"Cool",NanColor:[.3725490196078431,.2,.5019607843137255]},{IndexedColors:[.2313725490196079,.407843137254902,.6705882352941176,.1098039215686274,.5843137254901961,.803921568627451,.3058823529411765,.8509803921568627,.9176470588235294,.4509803921568628,.6039215686274509,.8352941176470589,.2588235294117647,.2392156862745098,.6627450980392157,.3137254901960784,.3294117647058823,.5294117647058824,.06274509803921569,.1647058823529412,.3215686274509804],Name:"Blues",NanColor:[.06274509803921569,.1647058823529412,.3215686274509804]},{IndexedColors:[.1098039215686274,.5843137254901961,.803921568627451,.2313725490196079,.407843137254902,.6705882352941176,.4,.2431372549019608,.7176470588235294,.6352941176470588,.3294117647058823,.8117647058823529,.8705882352941177,.3803921568627451,.807843137254902,.8627450980392157,.3803921568627451,.5843137254901961,.2392156862745098,.06274509803921569,.3215686274509804],Name:"Wild Flower",NanColor:[.2392156862745098,.06274509803921569,.3215686274509804]},{IndexedColors:[.396078431372549,.4862745098039216,.2156862745098039,.4588235294117647,.6941176470588235,.00392156862745098,.6980392156862745,.7294117647058823,.1882352941176471,1,.8980392156862745,.02352941176470588,1,.7058823529411765,0,.9764705882352941,.5137254901960784,.1411764705882353],Name:"Citrus",NanColor:[.9764705882352941,.5137254901960784,.1411764705882353]},{IndexedColors:[.4980392156862745,.2313725490196079,.03137254901960784,.7019607843137254,.3450980392156863,.02352941176470588,.8784313725490196,.5098039215686274,.0784313725490196,.9921568627450981,.7215686274509804,.3882352941176471,.996078431372549,.8784313725490196,.7137254901960784,.9686274509803922,.9686274509803922,.9686274509803922,.8470588235294118,.8549019607843137,.9215686274509803,.6980392156862745,.6705882352941176,.8235294117647058,.5019607843137255,.4509803921568628,.6745098039215687,.3294117647058823,.1529411764705882,.5333333333333333,.1764705882352941,0,.2941176470588235],Name:"Brewer Diverging Purple-Orange (11)",NanColor:[.1764705882352941,0,.2941176470588235]},{IndexedColors:[.4980392156862745,.2313725490196079,.03137254901960784,.7019607843137254,.3450980392156863,.02352941176470588,.8784313725490196,.5098039215686274,.0784313725490196,.9921568627450981,.7215686274509804,.3882352941176471,.996078431372549,.8784313725490196,.7137254901960784,.8470588235294118,.8549019607843137,.9215686274509803,.6980392156862745,.6705882352941176,.8235294117647058,.5019607843137255,.4509803921568628,.6745098039215687,.3294117647058823,.1529411764705882,.5333333333333333,.1764705882352941,0,.2941176470588235],Name:"Brewer Diverging Purple-Orange (10)",NanColor:[.1764705882352941,0,.2941176470588235]},{IndexedColors:[.7019607843137254,.3450980392156863,.02352941176470588,.8784313725490196,.5098039215686274,.0784313725490196,.9921568627450981,.7215686274509804,.3882352941176471,.996078431372549,.8784313725490196,.7137254901960784,.9686274509803922,.9686274509803922,.9686274509803922,.8470588235294118,.8549019607843137,.9215686274509803,.6980392156862745,.6705882352941176,.8235294117647058,.5019607843137255,.4509803921568628,.6745098039215687,.3294117647058823,.1529411764705882,.5333333333333333],Name:"Brewer Diverging Purple-Orange (9)",NanColor:[.3294117647058823,.1529411764705882,.5333333333333333]},{IndexedColors:[.7019607843137254,.3450980392156863,.02352941176470588,.8784313725490196,.5098039215686274,.0784313725490196,.9921568627450981,.7215686274509804,.3882352941176471,.996078431372549,.8784313725490196,.7137254901960784,.8470588235294118,.8549019607843137,.9215686274509803,.6980392156862745,.6705882352941176,.8235294117647058,.5019607843137255,.4509803921568628,.6745098039215687,.3294117647058823,.1529411764705882,.5333333333333333],Name:"Brewer Diverging Purple-Orange (8)",NanColor:[.3294117647058823,.1529411764705882,.5333333333333333]},{IndexedColors:[.7019607843137254,.3450980392156863,.02352941176470588,.9450980392156862,.6392156862745098,.2509803921568627,.996078431372549,.8784313725490196,.7137254901960784,.9686274509803922,.9686274509803922,.9686274509803922,.8470588235294118,.8549019607843137,.9215686274509803,.6,.5568627450980392,.7647058823529411,.3294117647058823,.1529411764705882,.5333333333333333],Name:"Brewer Diverging Purple-Orange (7)",NanColor:[.3294117647058823,.1529411764705882,.5333333333333333]},{IndexedColors:[.7019607843137254,.3450980392156863,.02352941176470588,.9450980392156862,.6392156862745098,.2509803921568627,.996078431372549,.8784313725490196,.7137254901960784,.8470588235294118,.8549019607843137,.9215686274509803,.6,.5568627450980392,.7647058823529411,.3294117647058823,.1529411764705882,.5333333333333333],Name:"Brewer Diverging Purple-Orange (6)",NanColor:[.3294117647058823,.1529411764705882,.5333333333333333]},{IndexedColors:[.9019607843137255,.3803921568627451,.00392156862745098,.9921568627450981,.7215686274509804,.3882352941176471,.9686274509803922,.9686274509803922,.9686274509803922,.6980392156862745,.6705882352941176,.8235294117647058,.3686274509803922,.2352941176470588,.6],Name:"Brewer Diverging Purple-Orange (5)",NanColor:[.3686274509803922,.2352941176470588,.6]},{IndexedColors:[.9019607843137255,.3803921568627451,.00392156862745098,.9921568627450981,.7215686274509804,.3882352941176471,.6980392156862745,.6705882352941176,.8235294117647058,.3686274509803922,.2352941176470588,.6],Name:"Brewer Diverging Purple-Orange (4)",NanColor:[.3686274509803922,.2352941176470588,.6]},{IndexedColors:[.9450980392156862,.6392156862745098,.2509803921568627,.9686274509803922,.9686274509803922,.9686274509803922,.6,.5568627450980392,.7647058823529411],Name:"Brewer Diverging Purple-Orange (3)",NanColor:[.6,.5568627450980392,.7647058823529411]},{IndexedColors:[.6196078431372549,.00392156862745098,.2588235294117647,.8352941176470589,.2431372549019608,.3098039215686275,.9568627450980393,.4274509803921568,.2627450980392157,.9921568627450981,.6823529411764706,.3803921568627451,.996078431372549,.8784313725490196,.5450980392156862,1,1,.7490196078431373,.9019607843137255,.9607843137254902,.596078431372549,.6705882352941176,.8666666666666667,.6431372549019608,.4,.7607843137254902,.6470588235294118,.196078431372549,.5333333333333333,.7411764705882353,.3686274509803922,.3098039215686275,.6352941176470588],Name:"Brewer Diverging Spectral (11)",NanColor:[.3686274509803922,.3098039215686275,.6352941176470588]},{IndexedColors:[.6196078431372549,.00392156862745098,.2588235294117647,.8352941176470589,.2431372549019608,.3098039215686275,.9568627450980393,.4274509803921568,.2627450980392157,.9921568627450981,.6823529411764706,.3803921568627451,.996078431372549,.8784313725490196,.5450980392156862,.9019607843137255,.9607843137254902,.596078431372549,.6705882352941176,.8666666666666667,.6431372549019608,.4,.7607843137254902,.6470588235294118,.196078431372549,.5333333333333333,.7411764705882353,.3686274509803922,.3098039215686275,.6352941176470588],Name:"Brewer Diverging Spectral (10)",NanColor:[.3686274509803922,.3098039215686275,.6352941176470588]},{IndexedColors:[.8352941176470589,.2431372549019608,.3098039215686275,.9568627450980393,.4274509803921568,.2627450980392157,.9921568627450981,.6823529411764706,.3803921568627451,.996078431372549,.8784313725490196,.5450980392156862,1,1,.7490196078431373,.9019607843137255,.9607843137254902,.596078431372549,.6705882352941176,.8666666666666667,.6431372549019608,.4,.7607843137254902,.6470588235294118,.196078431372549,.5333333333333333,.7411764705882353],Name:"Brewer Diverging Spectral (9)",NanColor:[.196078431372549,.5333333333333333,.7411764705882353]},{IndexedColors:[.8352941176470589,.2431372549019608,.3098039215686275,.9568627450980393,.4274509803921568,.2627450980392157,.9921568627450981,.6823529411764706,.3803921568627451,.996078431372549,.8784313725490196,.5450980392156862,.9019607843137255,.9607843137254902,.596078431372549,.6705882352941176,.8666666666666667,.6431372549019608,.4,.7607843137254902,.6470588235294118,.196078431372549,.5333333333333333,.7411764705882353],Name:"Brewer Diverging Spectral (8)",NanColor:[.196078431372549,.5333333333333333,.7411764705882353]},{IndexedColors:[.8352941176470589,.2431372549019608,.3098039215686275,.9882352941176471,.5529411764705883,.3490196078431372,.996078431372549,.8784313725490196,.5450980392156862,1,1,.7490196078431373,.9019607843137255,.9607843137254902,.596078431372549,.6,.8352941176470589,.5803921568627451,.196078431372549,.5333333333333333,.7411764705882353],Name:"Brewer Diverging Spectral (7)",NanColor:[.196078431372549,.5333333333333333,.7411764705882353]},{IndexedColors:[.8352941176470589,.2431372549019608,.3098039215686275,.9882352941176471,.5529411764705883,.3490196078431372,.996078431372549,.8784313725490196,.5450980392156862,.9019607843137255,.9607843137254902,.596078431372549,.6,.8352941176470589,.5803921568627451,.196078431372549,.5333333333333333,.7411764705882353],Name:"Brewer Diverging Spectral (6)",NanColor:[.196078431372549,.5333333333333333,.7411764705882353]},{IndexedColors:[.8431372549019608,.09803921568627451,.1098039215686274,.9921568627450981,.6823529411764706,.3803921568627451,1,1,.7490196078431373,.6705882352941176,.8666666666666667,.6431372549019608,.1686274509803922,.5137254901960784,.7294117647058823],Name:"Brewer Diverging Spectral (5)",NanColor:[.1686274509803922,.5137254901960784,.7294117647058823]},{IndexedColors:[.8431372549019608,.09803921568627451,.1098039215686274,.9921568627450981,.6823529411764706,.3803921568627451,.6705882352941176,.8666666666666667,.6431372549019608,.1686274509803922,.5137254901960784,.7294117647058823],Name:"Brewer Diverging Spectral (4)",NanColor:[.1686274509803922,.5137254901960784,.7294117647058823]},{IndexedColors:[.9882352941176471,.5529411764705883,.3490196078431372,1,1,.7490196078431373,.6,.8352941176470589,.5803921568627451],Name:"Brewer Diverging Spectral (3)",NanColor:[.6,.8352941176470589,.5803921568627451]},{IndexedColors:[.3294117647058823,.1882352941176471,.0196078431372549,.5490196078431373,.3176470588235294,.0392156862745098,.7490196078431373,.5058823529411764,.1764705882352941,.8745098039215686,.7607843137254902,.4901960784313725,.9647058823529412,.9098039215686274,.7647058823529411,.9607843137254902,.9607843137254902,.9607843137254902,.7803921568627451,.9176470588235294,.8980392156862745,.5019607843137255,.803921568627451,.7568627450980392,.207843137254902,.592156862745098,.5607843137254902,.00392156862745098,.4,.3686274509803922,0,.2352941176470588,.1882352941176471],Name:"Brewer Diverging Brown-Blue-Green (11)",NanColor:[0,.2352941176470588,.1882352941176471]},{IndexedColors:[.3294117647058823,.1882352941176471,.0196078431372549,.5490196078431373,.3176470588235294,.0392156862745098,.7490196078431373,.5058823529411764,.1764705882352941,.8745098039215686,.7607843137254902,.4901960784313725,.9647058823529412,.9098039215686274,.7647058823529411,.7803921568627451,.9176470588235294,.8980392156862745,.5019607843137255,.803921568627451,.7568627450980392,.207843137254902,.592156862745098,.5607843137254902,.00392156862745098,.4,.3686274509803922,0,.2352941176470588,.1882352941176471],Name:"Brewer Diverging Brown-Blue-Green (10)",NanColor:[0,.2352941176470588,.1882352941176471]},{IndexedColors:[.5490196078431373,.3176470588235294,.0392156862745098,.7490196078431373,.5058823529411764,.1764705882352941,.8745098039215686,.7607843137254902,.4901960784313725,.9647058823529412,.9098039215686274,.7647058823529411,.9607843137254902,.9607843137254902,.9607843137254902,.7803921568627451,.9176470588235294,.8980392156862745,.5019607843137255,.803921568627451,.7568627450980392,.207843137254902,.592156862745098,.5607843137254902,.00392156862745098,.4,.3686274509803922],Name:"Brewer Diverging Brown-Blue-Green (9)",NanColor:[.00392156862745098,.4,.3686274509803922]},{IndexedColors:[.5490196078431373,.3176470588235294,.0392156862745098,.7490196078431373,.5058823529411764,.1764705882352941,.8745098039215686,.7607843137254902,.4901960784313725,.9647058823529412,.9098039215686274,.7647058823529411,.7803921568627451,.9176470588235294,.8980392156862745,.5019607843137255,.803921568627451,.7568627450980392,.207843137254902,.592156862745098,.5607843137254902,.00392156862745098,.4,.3686274509803922],Name:"Brewer Diverging Brown-Blue-Green (8)",NanColor:[.00392156862745098,.4,.3686274509803922]},{IndexedColors:[.5490196078431373,.3176470588235294,.0392156862745098,.8470588235294118,.7019607843137254,.396078431372549,.9647058823529412,.9098039215686274,.7647058823529411,.9607843137254902,.9607843137254902,.9607843137254902,.7803921568627451,.9176470588235294,.8980392156862745,.3529411764705883,.7058823529411765,.6745098039215687,.00392156862745098,.4,.3686274509803922],Name:"Brewer Diverging Brown-Blue-Green (7)",NanColor:[.00392156862745098,.4,.3686274509803922]},{IndexedColors:[.5490196078431373,.3176470588235294,.0392156862745098,.8470588235294118,.7019607843137254,.396078431372549,.9647058823529412,.9098039215686274,.7647058823529411,.7803921568627451,.9176470588235294,.8980392156862745,.3529411764705883,.7058823529411765,.6745098039215687,.00392156862745098,.4,.3686274509803922],Name:"Brewer Diverging Brown-Blue-Green (6)",NanColor:[.00392156862745098,.4,.3686274509803922]},{IndexedColors:[.6509803921568628,.3803921568627451,.1019607843137255,.8745098039215686,.7607843137254902,.4901960784313725,.9607843137254902,.9607843137254902,.9607843137254902,.5019607843137255,.803921568627451,.7568627450980392,.00392156862745098,.5215686274509804,.4431372549019608],Name:"Brewer Diverging Brown-Blue-Green (5)",NanColor:[.00392156862745098,.5215686274509804,.4431372549019608]},{IndexedColors:[.6509803921568628,.3803921568627451,.1019607843137255,.8745098039215686,.7607843137254902,.4901960784313725,.5019607843137255,.803921568627451,.7568627450980392,.00392156862745098,.5215686274509804,.4431372549019608],Name:"Brewer Diverging Brown-Blue-Green (4)",NanColor:[.00392156862745098,.5215686274509804,.4431372549019608]},{IndexedColors:[.8470588235294118,.7019607843137254,.396078431372549,.9607843137254902,.9607843137254902,.9607843137254902,.3529411764705883,.7058823529411765,.6745098039215687],Name:"Brewer Diverging Brown-Blue-Green (3)",NanColor:[.3529411764705883,.7058823529411765,.6745098039215687]},{IndexedColors:[.9686274509803922,.9882352941176471,.9921568627450981,.8980392156862745,.9607843137254902,.9764705882352941,.8,.9254901960784314,.9019607843137255,.6,.8470588235294118,.788235294117647,.4,.7607843137254902,.6431372549019608,.2549019607843137,.6823529411764706,.4627450980392157,.1372549019607843,.5450980392156862,.2705882352941176,0,.4274509803921568,.1725490196078431,0,.2666666666666667,.1058823529411765],Name:"Brewer Sequential Blue-Green (9)",NanColor:[0,.2666666666666667,.1058823529411765]},{IndexedColors:[.9686274509803922,.9882352941176471,.9921568627450981,.8980392156862745,.9607843137254902,.9764705882352941,.8,.9254901960784314,.9019607843137255,.6,.8470588235294118,.788235294117647,.4,.7607843137254902,.6431372549019608,.2549019607843137,.6823529411764706,.4627450980392157,.1372549019607843,.5450980392156862,.2705882352941176,0,.3450980392156863,.1411764705882353],Name:"Brewer Sequential Blue-Green (8)",NanColor:[0,.3450980392156863,.1411764705882353]},{IndexedColors:[.9294117647058824,.9725490196078431,.984313725490196,.8,.9254901960784314,.9019607843137255,.8,.9254901960784314,.9019607843137255,.4,.7607843137254902,.6431372549019608,.2549019607843137,.6823529411764706,.4627450980392157,.1372549019607843,.5450980392156862,.2705882352941176,0,.3450980392156863,.1411764705882353],Name:"Brewer Sequential Blue-Green (7)",NanColor:[0,.3450980392156863,.1411764705882353]},{IndexedColors:[.9294117647058824,.9725490196078431,.984313725490196,.8,.9254901960784314,.9019607843137255,.6,.8470588235294118,.788235294117647,.4,.7607843137254902,.6431372549019608,.1725490196078431,.6352941176470588,.3725490196078431,0,.4274509803921568,.1725490196078431],Name:"Brewer Sequential Blue-Green (6)",NanColor:[0,.4274509803921568,.1725490196078431]},{IndexedColors:[.9294117647058824,.9725490196078431,.984313725490196,.6980392156862745,.8862745098039215,.8862745098039215,.4,.7607843137254902,.6431372549019608,.1725490196078431,.6352941176470588,.3725490196078431,0,.4274509803921568,.1725490196078431],Name:"Brewer Sequential Blue-Green (5)",NanColor:[0,.4274509803921568,.1725490196078431]},{IndexedColors:[.9294117647058824,.9725490196078431,.984313725490196,.6980392156862745,.8862745098039215,.8862745098039215,.4,.7607843137254902,.6431372549019608,.1372549019607843,.5450980392156862,.2705882352941176],Name:"Brewer Sequential Blue-Green (4)",NanColor:[.1372549019607843,.5450980392156862,.2705882352941176]},{IndexedColors:[.8980392156862745,.9607843137254902,.9764705882352941,.6,.8470588235294118,.788235294117647,.1725490196078431,.6352941176470588,.3725490196078431],Name:"Brewer Sequential Blue-Green (3)",NanColor:[.1725490196078431,.6352941176470588,.3725490196078431]},{IndexedColors:[1,1,.8980392156862745,1,.9686274509803922,.7372549019607844,.996078431372549,.8901960784313725,.5686274509803921,.996078431372549,.7686274509803922,.3098039215686275,.996078431372549,.6,.1607843137254902,.9254901960784314,.4392156862745098,.0784313725490196,.8,.2980392156862745,.00784313725490196,.6,.203921568627451,.01568627450980392,.4,.1450980392156863,.02352941176470588],Name:"Brewer Sequential Yellow-Orange-Brown (9)",NanColor:[.4,.1450980392156863,.02352941176470588]},{IndexedColors:[1,1,.8980392156862745,1,.9686274509803922,.7372549019607844,.996078431372549,.8901960784313725,.5686274509803921,.996078431372549,.7686274509803922,.3098039215686275,.996078431372549,.6,.1607843137254902,.9254901960784314,.4392156862745098,.0784313725490196,.8,.2980392156862745,.00784313725490196,.5490196078431373,.1764705882352941,.01568627450980392],Name:"Brewer Sequential Yellow-Orange-Brown (8)",NanColor:[.5490196078431373,.1764705882352941,.01568627450980392]},{IndexedColors:[1,1,.8313725490196079,.996078431372549,.8901960784313725,.5686274509803921,.996078431372549,.7686274509803922,.3098039215686275,.996078431372549,.6,.1607843137254902,.9254901960784314,.4392156862745098,.0784313725490196,.8,.2980392156862745,.00784313725490196,.5490196078431373,.1764705882352941,.01568627450980392],Name:"Brewer Sequential Yellow-Orange-Brown (7)",NanColor:[.5490196078431373,.1764705882352941,.01568627450980392]},{IndexedColors:[1,1,.8313725490196079,.996078431372549,.8901960784313725,.5686274509803921,.996078431372549,.7686274509803922,.3098039215686275,.996078431372549,.6,.1607843137254902,.8509803921568627,.3725490196078431,.05490196078431372,.6,.203921568627451,.01568627450980392],Name:"Brewer Sequential Yellow-Orange-Brown (6)",NanColor:[.6,.203921568627451,.01568627450980392]},{IndexedColors:[1,1,.8313725490196079,.996078431372549,.8509803921568627,.5568627450980392,.996078431372549,.6,.1607843137254902,.8509803921568627,.3725490196078431,.05490196078431372,.6,.203921568627451,.01568627450980392],Name:"Brewer Sequential Yellow-Orange-Brown (5)",NanColor:[.6,.203921568627451,.01568627450980392]},{IndexedColors:[1,1,.8313725490196079,.996078431372549,.8509803921568627,.5568627450980392,.996078431372549,.6,.1607843137254902,.8,.2980392156862745,.00784313725490196],Name:"Brewer Sequential Yellow-Orange-Brown (4)",NanColor:[.8,.2980392156862745,.00784313725490196]},{IndexedColors:[1,.9686274509803922,.7372549019607844,.996078431372549,.7686274509803922,.3098039215686275,.8509803921568627,.3725490196078431,.05490196078431372],Name:"Brewer Sequential Yellow-Orange-Brown (3)",NanColor:[.8509803921568627,.3725490196078431,.05490196078431372]},{IndexedColors:[.9686274509803922,.9882352941176471,.9921568627450981,.8784313725490196,.9254901960784314,.9568627450980393,.7490196078431373,.8274509803921568,.9019607843137255,.6196078431372549,.7372549019607844,.8549019607843137,.5490196078431373,.5882352941176471,.7764705882352941,.5490196078431373,.4196078431372549,.6941176470588235,.5333333333333333,.2549019607843137,.615686274509804,.5058823529411764,.05882352941176471,.4862745098039216,.3019607843137255,0,.2941176470588235],Name:"Brewer Sequential Blue-Purple (9)",NanColor:[.3019607843137255,0,.2941176470588235]},{IndexedColors:[.9686274509803922,.9882352941176471,.9921568627450981,.8784313725490196,.9254901960784314,.9568627450980393,.7490196078431373,.8274509803921568,.9019607843137255,.6196078431372549,.7372549019607844,.8549019607843137,.5490196078431373,.5882352941176471,.7764705882352941,.5490196078431373,.4196078431372549,.6941176470588235,.5333333333333333,.2549019607843137,.615686274509804,.4313725490196079,.00392156862745098,.4196078431372549],Name:"Brewer Sequential Blue-Purple (8)",NanColor:[.4313725490196079,.00392156862745098,.4196078431372549]},{IndexedColors:[.9294117647058824,.9725490196078431,.984313725490196,.7490196078431373,.8274509803921568,.9019607843137255,.6196078431372549,.7372549019607844,.8549019607843137,.5490196078431373,.5882352941176471,.7764705882352941,.5490196078431373,.4196078431372549,.6941176470588235,.5333333333333333,.2549019607843137,.615686274509804,.4313725490196079,.00392156862745098,.4196078431372549],Name:"Brewer Sequential Blue-Purple (7)",NanColor:[.4313725490196079,.00392156862745098,.4196078431372549]},{IndexedColors:[.9294117647058824,.9725490196078431,.984313725490196,.7490196078431373,.8274509803921568,.9019607843137255,.6196078431372549,.7372549019607844,.8549019607843137,.5490196078431373,.5882352941176471,.7764705882352941,.5333333333333333,.3372549019607843,.6549019607843137,.5058823529411764,.05882352941176471,.4862745098039216],Name:"Brewer Sequential Blue-Purple (6)",NanColor:[.5058823529411764,.05882352941176471,.4862745098039216]},{IndexedColors:[.9294117647058824,.9725490196078431,.984313725490196,.7019607843137254,.803921568627451,.8901960784313725,.5490196078431373,.5882352941176471,.7764705882352941,.5333333333333333,.3372549019607843,.6549019607843137,.5058823529411764,.05882352941176471,.4862745098039216],Name:"Brewer Sequential Blue-Purple (5)",NanColor:[.5058823529411764,.05882352941176471,.4862745098039216]},{IndexedColors:[.9294117647058824,.9725490196078431,.984313725490196,.7019607843137254,.803921568627451,.8901960784313725,.5490196078431373,.5882352941176471,.7764705882352941,.5333333333333333,.2549019607843137,.615686274509804],Name:"Brewer Sequential Blue-Purple (4)",NanColor:[.5333333333333333,.2549019607843137,.615686274509804]},{IndexedColors:[.8784313725490196,.9254901960784314,.9568627450980393,.6196078431372549,.7372549019607844,.8549019607843137,.5333333333333333,.3372549019607843,.6549019607843137],Name:"Brewer Sequential Blue-Purple (3)",NanColor:[.5333333333333333,.3372549019607843,.6549019607843137]},{IndexedColors:[.4980392156862745,.788235294117647,.4980392156862745,.7450980392156863,.6823529411764706,.8313725490196079,.9921568627450981,.7529411764705882,.5254901960784314,1,1,.6,.2196078431372549,.4235294117647059,.6901960784313725,.9411764705882353,.00784313725490196,.4980392156862745,.7490196078431373,.3568627450980392,.09019607843137255,.4,.4,.4],Name:"Brewer Qualitative Accent",NanColor:[.4,.4,.4]},{IndexedColors:[.1058823529411765,.6196078431372549,.4666666666666667,.8509803921568627,.3725490196078431,.00784313725490196,.4588235294117647,.4392156862745098,.7019607843137254,.9058823529411765,.1607843137254902,.5411764705882353,.4,.6509803921568628,.1176470588235294,.9019607843137255,.6705882352941176,.00784313725490196,.6509803921568628,.4627450980392157,.1137254901960784,.4,.4,.4],Name:"Brewer Qualitative Dark2",NanColor:[.4,.4,.4]},{IndexedColors:[.4,.7607843137254902,.6470588235294118,.9882352941176471,.5529411764705883,.3843137254901961,.5529411764705883,.6274509803921569,.796078431372549,.9058823529411765,.5411764705882353,.7647058823529411,.6509803921568628,.8470588235294118,.3294117647058823,1,.8509803921568627,.1843137254901961,.8980392156862745,.7686274509803922,.5803921568627451,.7019607843137254,.7019607843137254,.7019607843137254],Name:"Brewer Qualitative Set2",NanColor:[.7019607843137254,.7019607843137254,.7019607843137254]},{IndexedColors:[.7019607843137254,.8862745098039215,.803921568627451,.9921568627450981,.803921568627451,.6745098039215687,.796078431372549,.8352941176470589,.9098039215686274,.9568627450980393,.792156862745098,.8941176470588236,.9019607843137255,.9607843137254902,.788235294117647,1,.9490196078431372,.6823529411764706,.9450980392156862,.8862745098039215,.8,.8,.8,.8],Name:"Brewer Qualitative Pastel2",NanColor:[.8,.8,.8]},{IndexedColors:[.984313725490196,.7058823529411765,.6823529411764706,.7019607843137254,.803921568627451,.8901960784313725,.8,.9215686274509803,.7725490196078432,.8705882352941177,.796078431372549,.8941176470588236,.996078431372549,.8509803921568627,.6509803921568628,1,1,.8,.8980392156862745,.8470588235294118,.7411764705882353,.9921568627450981,.8549019607843137,.9254901960784314,.9490196078431372,.9490196078431372,.9490196078431372],Name:"Brewer Qualitative Pastel1",NanColor:[.9490196078431372,.9490196078431372,.9490196078431372]},{IndexedColors:[.8941176470588236,.1019607843137255,.1098039215686274,.2156862745098039,.4941176470588236,.7215686274509804,.3019607843137255,.6862745098039216,.2901960784313726,.596078431372549,.3058823529411765,.6392156862745098,1,.4980392156862745,0,1,1,.2,.6509803921568628,.3372549019607843,.1568627450980392,.9686274509803922,.5058823529411764,.7490196078431373,.6,.6,.6],Name:"Brewer Qualitative Set1",NanColor:[.6,.6,.6]},{IndexedColors:[.6509803921568628,.807843137254902,.8901960784313725,.1215686274509804,.4705882352941176,.7058823529411765,.6980392156862745,.8745098039215686,.5411764705882353,.2,.6274509803921569,.1725490196078431,.984313725490196,.6039215686274509,.6,.8901960784313725,.1019607843137255,.1098039215686274,.9921568627450981,.7490196078431373,.4352941176470588,1,.4980392156862745,0,.792156862745098,.6980392156862745,.8392156862745098,.4156862745098039,.2392156862745098,.6039215686274509,1,1,.6],Name:"Brewer Qualitative Paired",NanColor:[1,1,.6]},{IndexedColors:[.5529411764705883,.8274509803921568,.7803921568627451,1,1,.7019607843137254,.7450980392156863,.7294117647058823,.8549019607843137,.984313725490196,.5019607843137255,.4470588235294118,.5019607843137255,.6941176470588235,.8274509803921568,.9921568627450981,.7058823529411765,.3843137254901961,.7019607843137254,.8705882352941177,.4117647058823529,.9882352941176471,.803921568627451,.8980392156862745,.8509803921568627,.8509803921568627,.8509803921568627,.7372549019607844,.5019607843137255,.7411764705882353,.8,.9215686274509803,.7725490196078432,1,.9294117647058824,.4352941176470588],Name:"Brewer Qualitative Set3",NanColor:[1,.9294117647058824,.4352941176470588]},{IndexedColors:[1,0,0,1,.862745,0,0,.695201,0],Name:"Traffic Lights",NanColor:[.803922,0,.803922]},{IndexedColors:[.908659,.604013,.581857,1,.862745,0,0,.695201,0],Name:"Traffic Lights For Deuteranopes",NanColor:[.803922,0,.803922]},{IndexedColors:[.4196078431372549,0,.07058823529411765,.9019607843137255,.9411764705882353,.0196078431372549,.01568627450980392,.6196078431372549,.00784313725490196],Name:"Traffic Lights For Deuteranopes 2",NanColor:[.803922,0,.803922]},{ColorSpace:"Lab",Creator:"Francesca Samsel",Name:"Muted Blue-Green",NanColor:[.25,0,0],RGBPoints:[0,.109804,.27451,.301961,.02,.129412,.309804,.341176,.05,.14902,.341176,.380392,.1,.188235,.403922,.458824,.15,.227451,.447059,.521569,.2,.290196,.494118,.588235,.25,.368627,.552941,.670588,.3,.458824,.619608,.74902,.35,.588235,.713725,.85098,.4,.72549,.815686,.941176,.45,.831373,.882353,.980392,.475,.909804,.933333,1,.5,.980392,.984314,1,.5,.996078,1,.94902,.5,1,1,.980392,.5,.980392,.984314,1,.525,.972549,.988235,.890196,.55,.917647,.960784,.835294,.6,.835294,.921569,.772549,.65,.768627,.901961,.737255,.7,.670588,.831373,.654902,.75,.576471,.760784,.584314,.8,.498039,.678431,.521569,.85,.392157,.560784,.427451,.9,.294118,.45098,.333333,.95,.211765,.34902,.254902,1,.152941,.278431,.196078]},{ColorSpace:"Lab",Creator:"Francesca Samsel",Name:"Green-Blue Asymmetric Divergent (62Blbc)",NanColor:[.25,0,0],RGBPoints:[0,.121569,.2,.145098,.05,.196078,.301961,.223529,.1,.258824,.4,.278431,.2,.341176,.54902,.341176,.25,.419608,.619608,.376471,.3,.545098,.701961,.392157,.35,.643137,.780392,.403922,.4,.729412,.819608,.45098,.45,.811765,.870588,.521569,.5,.898039,.909804,.564706,.55,.941176,.92549,.686275,.6,.960784,.94902,.776471,.64,1,1,1,.65,.890196,.988235,.972549,.7,.721569,.894118,.901961,.75,.631373,.823529,.839216,.8,.517647,.662745,.701961,.85,.384314,.494118,.54902,.9,.298039,.360784,.45098,.95,.223529,.25098,.34902,.99,.156863,.172549,.25098,1,.137255,.137255,.188235]},{ColorSpace:"Lab",Creator:"Francesca Samsel",Name:"Asymmtrical Earth Tones (6_21b)",NanColor:[.25,0,0],RGBPoints:[0,.141176,.14902,.2,.05,.215686,.258824,.321569,.1,.243137,.368627,.380392,.15,.27451,.439216,.4,.2,.32549,.501961,.384314,.25,.403922,.6,.419608,.3,.486275,.701961,.454902,.35,.556863,.74902,.494118,.4,.670588,.8,.545098,.5,.854902,.901961,.631373,.55,.92549,.941176,.694118,.6,.960784,.94902,.776471,.65,.988235,.968627,.909804,.7,.839216,.815686,.772549,.75,.701961,.662745,.615686,.8,.6,.529412,.478431,.85,.501961,.403922,.360784,.9,.439216,.313725,.290196,1,.301961,.164706,.176471]},{ColorSpace:"Lab",Creator:"Francesca Samsel",Name:"Yellow 15",NanColor:[.25,0,0],RGBPoints:[0,1,1,.988235,.002,1,1,.988235,.05,.984314,.988235,.843137,.1,.988235,.988235,.741176,.15,.980392,.968627,.654902,.2,.980392,.945098,.576471,.25,.968627,.905882,.486275,.3,.968627,.862745,.388235,.35,.960784,.803922,.286275,.4,.94902,.741176,.219608,.45,.941176,.678431,.14902,.5,.929412,.607843,.094118,.55,.921569,.545098,.054902,.6,.909804,.486275,.035294,.65,.890196,.411765,.019608,.7,.8,.305882,0,.75,.760784,.239216,0,.8,.678431,.180392,.011765,.85,.6,.121569,.023529,.9,.501961,.054902,.031373,.95,.4,.039216,.058824,1,.301961,.047059,.090196]},{ColorSpace:"Diverging",Name:"Magma (matplotlib)",NanColor:[0,1,0],Source:"https://github.com/BIDS/colormap/blob/master/colormaps.py",License:"CC0",Creator:"Nathaniel J. Smith & Stefan van der Walt",RGBPoints:[0,.001462,466e-6,.013866,.003922,.002258,.001295,.018331,.007843,.003279,.002305,.023708,.011765,.004512,.00349,.029965,.015686,.00595,.004843,.03713,.019608,.007588,.006356,.044973,.023529,.009426,.008022,.052844,.027451,.011465,.009828,.06075,.031373,.013708,.011771,.068667,.035294,.016156,.01384,.076603,.039216,.018815,.016026,.084584,.043137,.021692,.01832,.09261,.047059,.024792,.020715,.100676,.05098,.028123,.023201,.108787,.054902,.031696,.025765,.116965,.058824,.03552,.028397,.125209,.062745,.039608,.03109,.133515,.066667,.04383,.03383,.141886,.070588,.048062,.036607,.150327,.07451,.05232,.039407,.158841,.078431,.056615,.04216,.167446,.082353,.060949,.044794,.176129,.086275,.06533,.047318,.184892,.090196,.069764,.049726,.193735,.094118,.074257,.052017,.20266,.098039,.078815,.054184,.211667,.101961,.083446,.056225,.220755,.105882,.088155,.058133,.229922,.109804,.092949,.059904,.239164,.113725,.097833,.061531,.248477,.117647,.102815,.06301,.257854,.121569,.107899,.064335,.267289,.12549,.113094,.065492,.276784,.129412,.118405,.066479,.286321,.133333,.123833,.067295,.295879,.137255,.12938,.067935,.305443,.141176,.135053,.068391,.315,.145098,.140858,.068654,.324538,.14902,.146785,.068738,.334011,.152941,.152839,.068637,.343404,.156863,.159018,.068354,.352688,.160784,.165308,.067911,.361816,.164706,.171713,.067305,.370771,.168627,.178212,.066576,.379497,.172549,.184801,.065732,.387973,.176471,.19146,.064818,.396152,.180392,.198177,.063862,.404009,.184314,.204935,.062907,.411514,.188235,.211718,.061992,.418647,.192157,.218512,.061158,.425392,.196078,.225302,.060445,.431742,.2,.232077,.059889,.437695,.203922,.238826,.059517,.443256,.207843,.245543,.059352,.448436,.211765,.25222,.059415,.453248,.215686,.258857,.059706,.45771,.219608,.265447,.060237,.46184,.223529,.271994,.060994,.46566,.227451,.278493,.061978,.46919,.231373,.284951,.063168,.472451,.235294,.291366,.064553,.475462,.239216,.29774,.066117,.478243,.243137,.304081,.067835,.480812,.247059,.310382,.069702,.483186,.25098,.316654,.07169,.48538,.254902,.322899,.073782,.487408,.258824,.329114,.075972,.489287,.262745,.335308,.078236,.491024,.266667,.341482,.080564,.492631,.270588,.347636,.082946,.494121,.27451,.353773,.085373,.495501,.278431,.359898,.087831,.496778,.282353,.366012,.090314,.49796,.286275,.372116,.092816,.499053,.290196,.378211,.095332,.500067,.294118,.384299,.097855,.501002,.298039,.390384,.100379,.501864,.301961,.396467,.102902,.502658,.305882,.402548,.10542,.503386,.309804,.408629,.10793,.504052,.313725,.414709,.110431,.504662,.317647,.420791,.11292,.505215,.321569,.426877,.115395,.505714,.32549,.432967,.117855,.50616,.329412,.439062,.120298,.506555,.333333,.445163,.122724,.506901,.337255,.451271,.125132,.507198,.341176,.457386,.127522,.507448,.345098,.463508,.129893,.507652,.34902,.46964,.132245,.507809,.352941,.47578,.134577,.507921,.356863,.481929,.136891,.507989,.360784,.488088,.139186,.508011,.364706,.494258,.141462,.507988,.368627,.500438,.143719,.50792,.372549,.506629,.145958,.507806,.376471,.512831,.148179,.507648,.380392,.519045,.150383,.507443,.384314,.52527,.152569,.507192,.388235,.531507,.154739,.506895,.392157,.537755,.156894,.506551,.396078,.544015,.159033,.506159,.4,.550287,.161158,.505719,.403922,.556571,.163269,.50523,.407843,.562866,.165368,.504692,.411765,.569172,.167454,.504105,.415686,.57549,.16953,.503466,.419608,.581819,.171596,.502777,.423529,.588158,.173652,.502035,.427451,.594508,.175701,.501241,.431373,.600868,.177743,.500394,.435294,.607238,.179779,.499492,.439216,.613617,.181811,.498536,.443137,.620005,.18384,.497524,.447059,.626401,.185867,.496456,.45098,.632805,.187893,.495332,.454902,.639216,.189921,.49415,.458824,.645633,.191952,.49291,.462745,.652056,.193986,.491611,.466667,.658483,.196027,.490253,.470588,.664915,.198075,.488836,.47451,.671349,.200133,.487358,.478431,.677786,.202203,.485819,.482353,.684224,.204286,.484219,.486275,.690661,.206384,.482558,.490196,.697098,.208501,.480835,.494118,.703532,.210638,.479049,.498039,.709962,.212797,.477201,.501961,.716387,.214982,.47529,.505882,.722805,.217194,.473316,.509804,.729216,.219437,.471279,.513725,.735616,.221713,.46918,.517647,.742004,.224025,.467018,.521569,.748378,.226377,.464794,.52549,.754737,.228772,.462509,.529412,.761077,.231214,.460162,.533333,.767398,.233705,.457755,.537255,.773695,.236249,.455289,.541176,.779968,.238851,.452765,.545098,.786212,.241514,.450184,.54902,.792427,.244242,.447543,.552941,.798608,.24704,.444848,.556863,.804752,.249911,.442102,.560784,.810855,.252861,.439305,.564706,.816914,.255895,.436461,.568627,.822926,.259016,.433573,.572549,.828886,.262229,.430644,.576471,.834791,.26554,.427671,.580392,.840636,.268953,.424666,.584314,.846416,.272473,.421631,.588235,.852126,.276106,.418573,.592157,.857763,.279857,.415496,.596078,.86332,.283729,.412403,.6,.868793,.287728,.409303,.603922,.874176,.291859,.406205,.607843,.879464,.296125,.403118,.611765,.884651,.30053,.400047,.615686,.889731,.305079,.397002,.619608,.8947,.309773,.393995,.623529,.899552,.314616,.391037,.627451,.904281,.31961,.388137,.631373,.908884,.324755,.385308,.635294,.913354,.330052,.382563,.639216,.917689,.3355,.379915,.643137,.921884,.341098,.377376,.647059,.925937,.346844,.374959,.65098,.929845,.352734,.372677,.654902,.933606,.358764,.370541,.658824,.937221,.364929,.368567,.662745,.940687,.371224,.366762,.666667,.944006,.377643,.365136,.670588,.94718,.384178,.363701,.67451,.95021,.39082,.362468,.678431,.953099,.397563,.361438,.682353,.955849,.4044,.360619,.686275,.958464,.411324,.360014,.690196,.960949,.418323,.35963,.694118,.96331,.42539,.359469,.698039,.965549,.432519,.359529,.701961,.967671,.439703,.35981,.705882,.96968,.446936,.360311,.709804,.971582,.45421,.36103,.713725,.973381,.46152,.361965,.717647,.975082,.468861,.363111,.721569,.97669,.476226,.364466,.72549,.97821,.483612,.366025,.729412,.979645,.491014,.367783,.733333,.981,.498428,.369734,.737255,.982279,.505851,.371874,.741176,.983485,.51328,.374198,.745098,.984622,.520713,.376698,.74902,.985693,.528148,.379371,.752941,.9867,.535582,.38221,.756863,.987646,.543015,.38521,.760784,.988533,.550446,.388365,.764706,.989363,.557873,.391671,.768627,.990138,.565296,.395122,.772549,.990871,.572706,.398714,.776471,.991558,.580107,.402441,.780392,.992196,.587502,.406299,.784314,.992785,.594891,.410283,.788235,.993326,.602275,.41439,.792157,.993834,.609644,.418613,.796078,.994309,.616999,.42295,.8,.994738,.62435,.427397,.803922,.995122,.631696,.431951,.807843,.99548,.639027,.436607,.811765,.99581,.646344,.441361,.815686,.996096,.653659,.446213,.819608,.996341,.660969,.45116,.823529,.99658,.668256,.456192,.827451,.996775,.675541,.461314,.831373,.996925,.682828,.466526,.835294,.997077,.690088,.471811,.839216,.997186,.697349,.477182,.843137,.997254,.704611,.482635,.847059,.997325,.711848,.488154,.85098,.997351,.719089,.493755,.854902,.997351,.726324,.499428,.858824,.997341,.733545,.505167,.862745,.997285,.740772,.510983,.866667,.997228,.747981,.516859,.870588,.997138,.75519,.522806,.87451,.997019,.762398,.528821,.878431,.996898,.769591,.534892,.882353,.996727,.776795,.541039,.886275,.996571,.783977,.547233,.890196,.996369,.791167,.553499,.894118,.996162,.798348,.55982,.898039,.995932,.805527,.566202,.901961,.99568,.812706,.572645,.905882,.995424,.819875,.57914,.909804,.995131,.827052,.585701,.913725,.994851,.834213,.592307,.917647,.994524,.841387,.598983,.921569,.994222,.84854,.605696,.92549,.993866,.855711,.612482,.929412,.993545,.862859,.619299,.933333,.99317,.870024,.626189,.937255,.992831,.877168,.633109,.941176,.99244,.88433,.640099,.945098,.992089,.89147,.647116,.94902,.991688,.898627,.654202,.952941,.991332,.905763,.661309,.956863,.99093,.912915,.668481,.960784,.99057,.920049,.675675,.964706,.990175,.927196,.682926,.968627,.989815,.934329,.690198,.972549,.989434,.94147,.697519,.976471,.989077,.948604,.704863,.980392,.988717,.955742,.712242,.984314,.988367,.962878,.719649,.988235,.988033,.970012,.727077,.992157,.987691,.977154,.734536,.996078,.987387,.984288,.742002,1,.987053,.991438,.749504]},{ColorSpace:"Diverging",Name:"Inferno (matplotlib)",NanColor:[0,1,0],Source:"https://github.com/BIDS/colormap/blob/master/colormaps.py",License:"CC0",Creator:"Nathaniel J. Smith & Stefan van der Walt",RGBPoints:[0,.001462,466e-6,.013866,.003922,.002267,.00127,.01857,.007843,.003299,.002249,.024239,.011765,.004547,.003392,.030909,.015686,.006006,.004692,.038558,.019608,.007676,.006136,.046836,.023529,.009561,.007713,.055143,.027451,.011663,.009417,.06346,.031373,.013995,.011225,.071862,.035294,.016561,.013136,.080282,.039216,.019373,.015133,.088767,.043137,.022447,.017199,.097327,.047059,.025793,.019331,.10593,.05098,.029432,.021503,.114621,.054902,.033385,.023702,.123397,.058824,.037668,.025921,.132232,.062745,.042253,.028139,.141141,.066667,.046915,.030324,.150164,.070588,.051644,.032474,.159254,.07451,.056449,.034569,.168414,.078431,.06134,.03659,.177642,.082353,.066331,.038504,.186962,.086275,.071429,.040294,.196354,.090196,.076637,.041905,.205799,.094118,.081962,.043328,.215289,.098039,.087411,.044556,.224813,.101961,.09299,.045583,.234358,.105882,.098702,.046402,.243904,.109804,.104551,.047008,.25343,.113725,.110536,.047399,.262912,.117647,.116656,.047574,.272321,.121569,.122908,.047536,.281624,.12549,.129285,.047293,.290788,.129412,.135778,.046856,.299776,.133333,.142378,.046242,.308553,.137255,.149073,.045468,.317085,.141176,.15585,.044559,.325338,.145098,.162689,.043554,.333277,.14902,.169575,.042489,.340874,.152941,.176493,.041402,.348111,.156863,.183429,.040329,.354971,.160784,.190367,.039309,.361447,.164706,.197297,.0384,.367535,.168627,.204209,.037632,.373238,.172549,.211095,.03703,.378563,.176471,.217949,.036615,.383522,.180392,.224763,.036405,.388129,.184314,.231538,.036405,.3924,.188235,.238273,.036621,.396353,.192157,.244967,.037055,.400007,.196078,.25162,.037705,.403378,.2,.258234,.038571,.406485,.203922,.26481,.039647,.409345,.207843,.271347,.040922,.411976,.211765,.27785,.042353,.414392,.215686,.284321,.043933,.416608,.219608,.290763,.045644,.418637,.223529,.297178,.04747,.420491,.227451,.303568,.049396,.422182,.231373,.309935,.051407,.423721,.235294,.316282,.05349,.425116,.239216,.32261,.055634,.426377,.243137,.328921,.057827,.427511,.247059,.335217,.06006,.428524,.25098,.3415,.062325,.429425,.254902,.347771,.064616,.430217,.258824,.354032,.066925,.430906,.262745,.360284,.069247,.431497,.266667,.366529,.071579,.431994,.270588,.372768,.073915,.4324,.27451,.379001,.076253,.432719,.278431,.385228,.078591,.432955,.282353,.391453,.080927,.433109,.286275,.397674,.083257,.433183,.290196,.403894,.08558,.433179,.294118,.410113,.087896,.433098,.298039,.416331,.090203,.432943,.301961,.422549,.092501,.432714,.305882,.428768,.09479,.432412,.309804,.434987,.097069,.432039,.313725,.441207,.099338,.431594,.317647,.447428,.101597,.43108,.321569,.453651,.103848,.430498,.32549,.459875,.106089,.429846,.329412,.4661,.108322,.429125,.333333,.472328,.110547,.428334,.337255,.478558,.112764,.427475,.341176,.484789,.114974,.426548,.345098,.491022,.117179,.425552,.34902,.497257,.119379,.424488,.352941,.503493,.121575,.423356,.356863,.50973,.123769,.422156,.360784,.515967,.12596,.420887,.364706,.522206,.12815,.419549,.368627,.528444,.130341,.418142,.372549,.534683,.132534,.416667,.376471,.54092,.134729,.415123,.380392,.547157,.136929,.413511,.384314,.553392,.139134,.411829,.388235,.559624,.141346,.410078,.392157,.565854,.143567,.408258,.396078,.572081,.145797,.406369,.4,.578304,.148039,.404411,.403922,.584521,.150294,.402385,.407843,.590734,.152563,.40029,.411765,.59694,.154848,.398125,.415686,.603139,.157151,.395891,.419608,.60933,.159474,.393589,.423529,.615513,.161817,.391219,.427451,.621685,.164184,.388781,.431373,.627847,.166575,.386276,.435294,.633998,.168992,.383704,.439216,.640135,.171438,.381065,.443137,.64626,.173914,.378359,.447059,.652369,.176421,.375586,.45098,.658463,.178962,.372748,.454902,.66454,.181539,.369846,.458824,.670599,.184153,.366879,.462745,.676638,.186807,.363849,.466667,.682656,.189501,.360757,.470588,.688653,.192239,.357603,.47451,.694627,.195021,.354388,.478431,.700576,.197851,.351113,.482353,.7065,.200728,.347777,.486275,.712396,.203656,.344383,.490196,.718264,.206636,.340931,.494118,.724103,.20967,.337424,.498039,.729909,.212759,.333861,.501961,.735683,.215906,.330245,.505882,.741423,.219112,.326576,.509804,.747127,.222378,.322856,.513725,.752794,.225706,.319085,.517647,.758422,.229097,.315266,.521569,.76401,.232554,.311399,.52549,.769556,.236077,.307485,.529412,.775059,.239667,.303526,.533333,.780517,.243327,.299523,.537255,.785929,.247056,.295477,.541176,.791293,.250856,.29139,.545098,.796607,.254728,.287264,.54902,.801871,.258674,.283099,.552941,.807082,.262692,.278898,.556863,.812239,.266786,.274661,.560784,.817341,.270954,.27039,.564706,.822386,.275197,.266085,.568627,.827372,.279517,.26175,.572549,.832299,.283913,.257383,.576471,.837165,.288385,.252988,.580392,.841969,.292933,.248564,.584314,.846709,.297559,.244113,.588235,.851384,.30226,.239636,.592157,.855992,.307038,.235133,.596078,.860533,.311892,.230606,.6,.865006,.316822,.226055,.603922,.869409,.321827,.221482,.607843,.873741,.326906,.216886,.611765,.878001,.33206,.212268,.615686,.882188,.337287,.207628,.619608,.886302,.342586,.202968,.623529,.890341,.347957,.198286,.627451,.894305,.353399,.193584,.631373,.898192,.358911,.18886,.635294,.902003,.364492,.184116,.639216,.905735,.37014,.17935,.643137,.90939,.375856,.174563,.647059,.912966,.381636,.169755,.65098,.916462,.387481,.164924,.654902,.919879,.393389,.16007,.658824,.923215,.399359,.155193,.662745,.92647,.405389,.150292,.666667,.929644,.411479,.145367,.670588,.932737,.417627,.140417,.67451,.935747,.423831,.13544,.678431,.938675,.430091,.130438,.682353,.941521,.436405,.125409,.686275,.944285,.442772,.120354,.690196,.946965,.449191,.115272,.694118,.949562,.45566,.110164,.698039,.952075,.462178,.105031,.701961,.954506,.468744,.099874,.705882,.956852,.475356,.094695,.709804,.959114,.482014,.089499,.713725,.961293,.488716,.084289,.717647,.963387,.495462,.079073,.721569,.965397,.502249,.073859,.72549,.967322,.509078,.068659,.729412,.969163,.515946,.063488,.733333,.970919,.522853,.058367,.737255,.97259,.529798,.053324,.741176,.974176,.53678,.048392,.745098,.975677,.543798,.043618,.74902,.977092,.55085,.03905,.752941,.978422,.557937,.034931,.756863,.979666,.565057,.031409,.760784,.980824,.572209,.028508,.764706,.981895,.579392,.02625,.768627,.982881,.586606,.024661,.772549,.983779,.593849,.02377,.776471,.984591,.601122,.023606,.780392,.985315,.608422,.024202,.784314,.985952,.61575,.025592,.788235,.986502,.623105,.027814,.792157,.986964,.630485,.030908,.796078,.987337,.63789,.034916,.8,.987622,.64532,.039886,.803922,.987819,.652773,.045581,.807843,.987926,.66025,.05175,.811765,.987945,.667748,.058329,.815686,.987874,.675267,.065257,.819608,.987714,.682807,.072489,.823529,.987464,.690366,.07999,.827451,.987124,.697944,.087731,.831373,.986694,.70554,.095694,.835294,.986175,.713153,.103863,.839216,.985566,.720782,.112229,.843137,.984865,.728427,.120785,.847059,.984075,.736087,.129527,.85098,.983196,.743758,.138453,.854902,.982228,.751442,.147565,.858824,.981173,.759135,.156863,.862745,.980032,.766837,.166353,.866667,.978806,.774545,.176037,.870588,.977497,.782258,.185923,.87451,.976108,.789974,.196018,.878431,.974638,.797692,.206332,.882353,.973088,.805409,.216877,.886275,.971468,.813122,.227658,.890196,.969783,.820825,.238686,.894118,.968041,.828515,.249972,.898039,.966243,.836191,.261534,.901961,.964394,.843848,.273391,.905882,.962517,.851476,.285546,.909804,.960626,.859069,.29801,.913725,.95872,.866624,.31082,.917647,.956834,.874129,.323974,.921569,.954997,.881569,.337475,.92549,.953215,.888942,.351369,.929412,.951546,.896226,.365627,.933333,.950018,.903409,.380271,.937255,.948683,.910473,.395289,.941176,.947594,.917399,.410665,.945098,.946809,.924168,.426373,.94902,.946392,.930761,.442367,.952941,.946403,.937159,.458592,.956863,.946903,.943348,.47497,.960784,.947937,.949318,.491426,.964706,.949545,.955063,.50786,.968627,.95174,.960587,.524203,.972549,.954529,.965896,.540361,.976471,.957896,.971003,.556275,.980392,.961812,.975924,.571925,.984314,.966249,.980678,.587206,.988235,.971162,.985282,.602154,.992157,.976511,.989753,.61676,.996078,.982257,.994109,.631017,1,.988362,.998364,.644924]},{ColorSpace:"Diverging",Name:"Plasma (matplotlib)",NanColor:[0,1,0],Source:"https://github.com/BIDS/colormap/blob/master/colormaps.py",License:"CC0",Creator:"Nathaniel J. Smith & Stefan van der Walt",RGBPoints:[0,.050383,.029803,.527975,.003922,.063536,.028426,.533124,.007843,.075353,.027206,.538007,.011765,.086222,.026125,.542658,.015686,.096379,.025165,.547103,.019608,.10598,.024309,.551368,.023529,.115124,.023556,.555468,.027451,.123903,.022878,.559423,.031373,.132381,.022258,.56325,.035294,.140603,.021687,.566959,.039216,.148607,.021154,.570562,.043137,.156421,.020651,.574065,.047059,.16407,.020171,.577478,.05098,.171574,.019706,.580806,.054902,.17895,.019252,.584054,.058824,.186213,.018803,.587228,.062745,.193374,.018354,.59033,.066667,.200445,.017902,.593364,.070588,.207435,.017442,.596333,.07451,.21435,.016973,.599239,.078431,.221197,.016497,.602083,.082353,.227983,.016007,.604867,.086275,.234715,.015502,.607592,.090196,.241396,.014979,.610259,.094118,.248032,.014439,.612868,.098039,.254627,.013882,.615419,.101961,.261183,.013308,.617911,.105882,.267703,.012716,.620346,.109804,.274191,.012109,.622722,.113725,.280648,.011488,.625038,.117647,.287076,.010855,.627295,.121569,.293478,.010213,.62949,.12549,.299855,.009561,.631624,.129412,.30621,.008902,.633694,.133333,.312543,.008239,.6357,.137255,.318856,.007576,.63764,.141176,.32515,.006915,.639512,.145098,.331426,.006261,.641316,.14902,.337683,.005618,.643049,.152941,.343925,.004991,.64471,.156863,.35015,.004382,.646298,.160784,.356359,.003798,.64781,.164706,.362553,.003243,.649245,.168627,.368733,.002724,.650601,.172549,.374897,.002245,.651876,.176471,.381047,.001814,.653068,.180392,.387183,.001434,.654177,.184314,.393304,.001114,.655199,.188235,.399411,859e-6,.656133,.192157,.405503,678e-6,.656977,.196078,.41158,577e-6,.65773,.2,.417642,564e-6,.65839,.203922,.423689,646e-6,.658956,.207843,.429719,831e-6,.659425,.211765,.435734,.001127,.659797,.215686,.441732,.00154,.660069,.219608,.447714,.00208,.66024,.223529,.453677,.002755,.66031,.227451,.459623,.003574,.660277,.231373,.46555,.004545,.660139,.235294,.471457,.005678,.659897,.239216,.477344,.00698,.659549,.243137,.48321,.00846,.659095,.247059,.489055,.010127,.658534,.25098,.494877,.01199,.657865,.254902,.500678,.014055,.657088,.258824,.506454,.016333,.656202,.262745,.512206,.018833,.655209,.266667,.517933,.021563,.654109,.270588,.523633,.024532,.652901,.27451,.529306,.027747,.651586,.278431,.534952,.031217,.650165,.282353,.54057,.03495,.64864,.286275,.546157,.038954,.64701,.290196,.551715,.043136,.645277,.294118,.557243,.047331,.643443,.298039,.562738,.051545,.641509,.301961,.568201,.055778,.639477,.305882,.573632,.060028,.637349,.309804,.579029,.064296,.635126,.313725,.584391,.068579,.632812,.317647,.589719,.072878,.630408,.321569,.595011,.07719,.627917,.32549,.600266,.081516,.625342,.329412,.605485,.085854,.622686,.333333,.610667,.090204,.619951,.337255,.615812,.094564,.61714,.341176,.620919,.098934,.614257,.345098,.625987,.103312,.611305,.34902,.631017,.107699,.608287,.352941,.636008,.112092,.605205,.356863,.640959,.116492,.602065,.360784,.645872,.120898,.598867,.364706,.650746,.125309,.595617,.368627,.65558,.129725,.592317,.372549,.660374,.134144,.588971,.376471,.665129,.138566,.585582,.380392,.669845,.142992,.582154,.384314,.674522,.147419,.578688,.388235,.67916,.151848,.575189,.392157,.683758,.156278,.57166,.396078,.688318,.160709,.568103,.4,.69284,.165141,.564522,.403922,.697324,.169573,.560919,.407843,.701769,.174005,.557296,.411765,.706178,.178437,.553657,.415686,.710549,.182868,.550004,.419608,.714883,.187299,.546338,.423529,.719181,.191729,.542663,.427451,.723444,.196158,.538981,.431373,.72767,.200586,.535293,.435294,.731862,.205013,.531601,.439216,.736019,.209439,.527908,.443137,.740143,.213864,.524216,.447059,.744232,.218288,.520524,.45098,.748289,.222711,.516834,.454902,.752312,.227133,.513149,.458824,.756304,.231555,.509468,.462745,.760264,.235976,.505794,.466667,.764193,.240396,.502126,.470588,.76809,.244817,.498465,.47451,.771958,.249237,.494813,.478431,.775796,.253658,.491171,.482353,.779604,.258078,.487539,.486275,.783383,.2625,.483918,.490196,.787133,.266922,.480307,.494118,.790855,.271345,.476706,.498039,.794549,.27577,.473117,.501961,.798216,.280197,.469538,.505882,.801855,.284626,.465971,.509804,.805467,.289057,.462415,.513725,.809052,.293491,.45887,.517647,.812612,.297928,.455338,.521569,.816144,.302368,.451816,.52549,.819651,.306812,.448306,.529412,.823132,.311261,.444806,.533333,.826588,.315714,.441316,.537255,.830018,.320172,.437836,.541176,.833422,.324635,.434366,.545098,.836801,.329105,.430905,.54902,.840155,.33358,.427455,.552941,.843484,.338062,.424013,.556863,.846788,.342551,.420579,.560784,.850066,.347048,.417153,.564706,.853319,.351553,.413734,.568627,.856547,.356066,.410322,.572549,.85975,.360588,.406917,.576471,.862927,.365119,.403519,.580392,.866078,.36966,.400126,.584314,.869203,.374212,.396738,.588235,.872303,.378774,.393355,.592157,.875376,.383347,.389976,.596078,.878423,.387932,.3866,.6,.881443,.392529,.383229,.603922,.884436,.397139,.37986,.607843,.887402,.401762,.376494,.611765,.89034,.406398,.37313,.615686,.89325,.411048,.369768,.619608,.896131,.415712,.366407,.623529,.898984,.420392,.363047,.627451,.901807,.425087,.359688,.631373,.904601,.429797,.356329,.635294,.907365,.434524,.35297,.639216,.910098,.439268,.34961,.643137,.9128,.444029,.346251,.647059,.915471,.448807,.34289,.65098,.918109,.453603,.339529,.654902,.920714,.458417,.336166,.658824,.923287,.463251,.332801,.662745,.925825,.468103,.329435,.666667,.928329,.472975,.326067,.670588,.930798,.477867,.322697,.67451,.933232,.48278,.319325,.678431,.93563,.487712,.315952,.682353,.93799,.492667,.312575,.686275,.940313,.497642,.309197,.690196,.942598,.502639,.305816,.694118,.944844,.507658,.302433,.698039,.947051,.512699,.299049,.701961,.949217,.517763,.295662,.705882,.951344,.52285,.292275,.709804,.953428,.52796,.288883,.713725,.95547,.533093,.28549,.717647,.957469,.53825,.282096,.721569,.959424,.543431,.278701,.72549,.961336,.548636,.275305,.729412,.963203,.553865,.271909,.733333,.965024,.559118,.268513,.737255,.966798,.564396,.265118,.741176,.968526,.5697,.261721,.745098,.970205,.575028,.258325,.74902,.971835,.580382,.254931,.752941,.973416,.585761,.25154,.756863,.974947,.591165,.248151,.760784,.976428,.596595,.244767,.764706,.977856,.602051,.241387,.768627,.979233,.607532,.238013,.772549,.980556,.613039,.234646,.776471,.981826,.618572,.231287,.780392,.983041,.624131,.227937,.784314,.984199,.629718,.224595,.788235,.985301,.63533,.221265,.792157,.986345,.640969,.217948,.796078,.987332,.646633,.214648,.8,.98826,.652325,.211364,.803922,.989128,.658043,.2081,.807843,.989935,.663787,.204859,.811765,.990681,.669558,.201642,.815686,.991365,.675355,.198453,.819608,.991985,.681179,.195295,.823529,.992541,.68703,.19217,.827451,.993032,.692907,.189084,.831373,.993456,.69881,.186041,.835294,.993814,.704741,.183043,.839216,.994103,.710698,.180097,.843137,.994324,.716681,.177208,.847059,.994474,.722691,.174381,.85098,.994553,.728728,.171622,.854902,.994561,.734791,.168938,.858824,.994495,.74088,.166335,.862745,.994355,.746995,.163821,.866667,.994141,.753137,.161404,.870588,.993851,.759304,.159092,.87451,.993482,.765499,.156891,.878431,.993033,.77172,.154808,.882353,.992505,.777967,.152855,.886275,.991897,.784239,.151042,.890196,.991209,.790537,.149377,.894118,.990439,.796859,.14787,.898039,.989587,.803205,.146529,.901961,.988648,.809579,.145357,.905882,.987621,.815978,.144363,.909804,.986509,.822401,.143557,.913725,.985314,.828846,.142945,.917647,.984031,.835315,.142528,.921569,.982653,.841812,.142303,.92549,.98119,.848329,.142279,.929412,.979644,.854866,.142453,.933333,.977995,.861432,.142808,.937255,.976265,.868016,.143351,.941176,.974443,.874622,.144061,.945098,.97253,.88125,.144923,.94902,.970533,.887896,.145919,.952941,.968443,.894564,.147014,.956863,.966271,.901249,.14818,.960784,.964021,.90795,.14937,.964706,.961681,.914672,.15052,.968627,.959276,.921407,.151566,.972549,.956808,.928152,.152409,.976471,.954287,.934908,.152921,.980392,.951726,.941671,.152925,.984314,.949151,.948435,.152178,.988235,.946602,.95519,.150328,.992157,.944152,.961916,.146861,.996078,.941896,.96859,.140956,1,.940015,.975158,.131326]},{ColorSpace:"Diverging",Name:"Viridis (matplotlib)",NanColor:[1,0,0],Source:"https://github.com/BIDS/colormap/blob/master/colormaps.py",License:"CC0",Creator:"Eric Firing",RGBPoints:[0,.267004,.004874,.329415,.003922,.26851,.009605,.335427,.007843,.269944,.014625,.341379,.011765,.271305,.019942,.347269,.015686,.272594,.025563,.353093,.019608,.273809,.031497,.358853,.023529,.274952,.037752,.364543,.027451,.276022,.044167,.370164,.031373,.277018,.050344,.375715,.035294,.277941,.056324,.381191,.039216,.278791,.062145,.386592,.043137,.279566,.067836,.391917,.047059,.280267,.073417,.397163,.05098,.280894,.078907,.402329,.054902,.281446,.08432,.407414,.058824,.281924,.089666,.412415,.062745,.282327,.094955,.417331,.066667,.282656,.100196,.42216,.070588,.28291,.105393,.426902,.07451,.283091,.110553,.431554,.078431,.283197,.11568,.436115,.082353,.283229,.120777,.440584,.086275,.283187,.125848,.44496,.090196,.283072,.130895,.449241,.094118,.282884,.13592,.453427,.098039,.282623,.140926,.457517,.101961,.28229,.145912,.46151,.105882,.281887,.150881,.465405,.109804,.281412,.155834,.469201,.113725,.280868,.160771,.472899,.117647,.280255,.165693,.476498,.121569,.279574,.170599,.479997,.12549,.278826,.17549,.483397,.129412,.278012,.180367,.486697,.133333,.277134,.185228,.489898,.137255,.276194,.190074,.493001,.141176,.275191,.194905,.496005,.145098,.274128,.199721,.498911,.14902,.273006,.20452,.501721,.152941,.271828,.209303,.504434,.156863,.270595,.214069,.507052,.160784,.269308,.218818,.509577,.164706,.267968,.223549,.512008,.168627,.26658,.228262,.514349,.172549,.265145,.232956,.516599,.176471,.263663,.237631,.518762,.180392,.262138,.242286,.520837,.184314,.260571,.246922,.522828,.188235,.258965,.251537,.524736,.192157,.257322,.25613,.526563,.196078,.255645,.260703,.528312,.2,.253935,.265254,.529983,.203922,.252194,.269783,.531579,.207843,.250425,.27429,.533103,.211765,.248629,.278775,.534556,.215686,.246811,.283237,.535941,.219608,.244972,.287675,.53726,.223529,.243113,.292092,.538516,.227451,.241237,.296485,.539709,.231373,.239346,.300855,.540844,.235294,.237441,.305202,.541921,.239216,.235526,.309527,.542944,.243137,.233603,.313828,.543914,.247059,.231674,.318106,.544834,.25098,.229739,.322361,.545706,.254902,.227802,.326594,.546532,.258824,.225863,.330805,.547314,.262745,.223925,.334994,.548053,.266667,.221989,.339161,.548752,.270588,.220057,.343307,.549413,.27451,.21813,.347432,.550038,.278431,.21621,.351535,.550627,.282353,.214298,.355619,.551184,.286275,.212395,.359683,.55171,.290196,.210503,.363727,.552206,.294118,.208623,.367752,.552675,.298039,.206756,.371758,.553117,.301961,.204903,.375746,.553533,.305882,.203063,.379716,.553925,.309804,.201239,.38367,.554294,.313725,.19943,.387607,.554642,.317647,.197636,.391528,.554969,.321569,.19586,.395433,.555276,.32549,.1941,.399323,.555565,.329412,.192357,.403199,.555836,.333333,.190631,.407061,.556089,.337255,.188923,.41091,.556326,.341176,.187231,.414746,.556547,.345098,.185556,.41857,.556753,.34902,.183898,.422383,.556944,.352941,.182256,.426184,.55712,.356863,.180629,.429975,.557282,.360784,.179019,.433756,.55743,.364706,.177423,.437527,.557565,.368627,.175841,.44129,.557685,.372549,.174274,.445044,.557792,.376471,.172719,.448791,.557885,.380392,.171176,.45253,.557965,.384314,.169646,.456262,.55803,.388235,.168126,.459988,.558082,.392157,.166617,.463708,.558119,.396078,.165117,.467423,.558141,.4,.163625,.471133,.558148,.403922,.162142,.474838,.55814,.407843,.160665,.47854,.558115,.411765,.159194,.482237,.558073,.415686,.157729,.485932,.558013,.419608,.15627,.489624,.557936,.423529,.154815,.493313,.55784,.427451,.153364,.497,.557724,.431373,.151918,.500685,.557587,.435294,.150476,.504369,.55743,.439216,.149039,.508051,.55725,.443137,.147607,.511733,.557049,.447059,.14618,.515413,.556823,.45098,.144759,.519093,.556572,.454902,.143343,.522773,.556295,.458824,.141935,.526453,.555991,.462745,.140536,.530132,.555659,.466667,.139147,.533812,.555298,.470588,.13777,.537492,.554906,.47451,.136408,.541173,.554483,.478431,.135066,.544853,.554029,.482353,.133743,.548535,.553541,.486275,.132444,.552216,.553018,.490196,.131172,.555899,.552459,.494118,.129933,.559582,.551864,.498039,.128729,.563265,.551229,.501961,.127568,.566949,.550556,.505882,.126453,.570633,.549841,.509804,.125394,.574318,.549086,.513725,.124395,.578002,.548287,.517647,.123463,.581687,.547445,.521569,.122606,.585371,.546557,.52549,.121831,.589055,.545623,.529412,.121148,.592739,.544641,.533333,.120565,.596422,.543611,.537255,.120092,.600104,.54253,.541176,.119738,.603785,.5414,.545098,.119512,.607464,.540218,.54902,.119423,.611141,.538982,.552941,.119483,.614817,.537692,.556863,.119699,.61849,.536347,.560784,.120081,.622161,.534946,.564706,.120638,.625828,.533488,.568627,.12138,.629492,.531973,.572549,.122312,.633153,.530398,.576471,.123444,.636809,.528763,.580392,.12478,.640461,.527068,.584314,.126326,.644107,.525311,.588235,.128087,.647749,.523491,.592157,.130067,.651384,.521608,.596078,.132268,.655014,.519661,.6,.134692,.658636,.517649,.603922,.137339,.662252,.515571,.607843,.14021,.665859,.513427,.611765,.143303,.669459,.511215,.615686,.146616,.67305,.508936,.619608,.150148,.676631,.506589,.623529,.153894,.680203,.504172,.627451,.157851,.683765,.501686,.631373,.162016,.687316,.499129,.635294,.166383,.690856,.496502,.639216,.170948,.694384,.493803,.643137,.175707,.6979,.491033,.647059,.180653,.701402,.488189,.65098,.185783,.704891,.485273,.654902,.19109,.708366,.482284,.658824,.196571,.711827,.479221,.662745,.202219,.715272,.476084,.666667,.20803,.718701,.472873,.670588,.214,.722114,.469588,.67451,.220124,.725509,.466226,.678431,.226397,.728888,.462789,.682353,.232815,.732247,.459277,.686275,.239374,.735588,.455688,.690196,.24607,.73891,.452024,.694118,.252899,.742211,.448284,.698039,.259857,.745492,.444467,.701961,.266941,.748751,.440573,.705882,.274149,.751988,.436601,.709804,.281477,.755203,.432552,.713725,.288921,.758394,.428426,.717647,.296479,.761561,.424223,.721569,.304148,.764704,.419943,.72549,.311925,.767822,.415586,.729412,.319809,.770914,.411152,.733333,.327796,.77398,.40664,.737255,.335885,.777018,.402049,.741176,.344074,.780029,.397381,.745098,.35236,.783011,.392636,.74902,.360741,.785964,.387814,.752941,.369214,.788888,.382914,.756863,.377779,.791781,.377939,.760784,.386433,.794644,.372886,.764706,.395174,.797475,.367757,.768627,.404001,.800275,.362552,.772549,.412913,.803041,.357269,.776471,.421908,.805774,.35191,.780392,.430983,.808473,.346476,.784314,.440137,.811138,.340967,.788235,.449368,.813768,.335384,.792157,.458674,.816363,.329727,.796078,.468053,.818921,.323998,.8,.477504,.821444,.318195,.803922,.487026,.823929,.312321,.807843,.496615,.826376,.306377,.811765,.506271,.828786,.300362,.815686,.515992,.831158,.294279,.819608,.525776,.833491,.288127,.823529,.535621,.835785,.281908,.827451,.545524,.838039,.275626,.831373,.555484,.840254,.269281,.835294,.565498,.84243,.262877,.839216,.575563,.844566,.256415,.843137,.585678,.846661,.249897,.847059,.595839,.848717,.243329,.85098,.606045,.850733,.236712,.854902,.616293,.852709,.230052,.858824,.626579,.854645,.223353,.862745,.636902,.856542,.21662,.866667,.647257,.8584,.209861,.870588,.657642,.860219,.203082,.87451,.668054,.861999,.196293,.878431,.678489,.863742,.189503,.882353,.688944,.865448,.182725,.886275,.699415,.867117,.175971,.890196,.709898,.868751,.169257,.894118,.720391,.87035,.162603,.898039,.730889,.871916,.156029,.901961,.741388,.873449,.149561,.905882,.751884,.874951,.143228,.909804,.762373,.876424,.137064,.913725,.772852,.877868,.131109,.917647,.783315,.879285,.125405,.921569,.79376,.880678,.120005,.92549,.804182,.882046,.114965,.929412,.814576,.883393,.110347,.933333,.82494,.88472,.106217,.937255,.83527,.886029,.102646,.941176,.845561,.887322,.099702,.945098,.85581,.888601,.097452,.94902,.866013,.889868,.095953,.952941,.876168,.891125,.09525,.956863,.886271,.892374,.095374,.960784,.89632,.893616,.096335,.964706,.906311,.894855,.098125,.968627,.916242,.896091,.100717,.972549,.926106,.89733,.104071,.976471,.935904,.89857,.108131,.980392,.945636,.899815,.112838,.984314,.9553,.901065,.118128,.988235,.964894,.902323,.123941,.992157,.974417,.90359,.130215,.996078,.983868,.904867,.136897,1,.993248,.906157,.143936]},{ShowIndexedColorActiveValues:1,IndexedColors:[.07,.5,.7,1,1,1,.85,1,1,.8,.5,1,.76,1,0,1,.71,.71,.5,.5,.5,.05,.05,1,1,.05,.05,.7,1,1,.7,.89,.96,.67,.36,.95,.54,1,0,.75,.65,.65,.5,.6,.6,1,.5,0,1,1,.19,.12,.94,.12,.5,.82,.89,.56,.25,.83,.24,1,0,.9,.9,.9,.75,.76,.78,.65,.65,.67,.54,.6,.78,.61,.48,.78,.5,.48,.78,.44,.48,.78,.36,.48,.76,1,.48,.38,.49,.5,.69,.76,.56,.56,.4,.56,.56,.74,.5,.89,1,.63,0,.65,.16,.16,.36,.72,.82,.44,.18,.69,0,1,0,.58,1,1,.58,.88,.88,.45,.76,.79,.33,.71,.71,.23,.62,.62,.14,.56,.56,.04,.49,.55,0,.41,.52,.88,.88,1,1,.85,.56,.65,.46,.45,.4,.5,.5,.62,.39,.71,.83,.48,0,.58,0,.58,.26,.62,.69,.34,.09,.56,0,.79,0,.44,.83,1,1,1,.78,.85,1,.78,.78,1,.78,.64,1,.78,.56,1,.78,.38,1,.78,.27,1,.78,.19,1,.78,.12,1,.78,0,1,.61,0,.9,.46,0,.83,.32,0,.75,.22,0,.67,.14,.3,.76,1,.3,.65,1,.13,.58,.84,.15,.49,.67,.15,.4,.59,.09,.33,.53,.96,.93,.82,.8,.82,.12,.71,.71,.76,.65,.33,.3,.34,.35,.38,.62,.31,.71,.67,.36,0,.46,.31,.27,.26,.51,.59,.26,0,.4,0,.49,0,.44,.67,.98,0,.73,1,0,.63,1,0,.56,1,0,.5,1,0,.42,1,.33,.36,.95,.47,.36,.89,.54,.31,.89,.63,.21,.83,.7,.12,.83,.7,.12,.73,.7,.05,.65,.74,.05,.53,.78,0,.4,.8,0,.35,.82,0,.31,.85,0,.27,.88,0,.22,.9,0,.18,.91,0,.15,.92,0,.14,.93,0,.13,.94,0,.12,.95,0,.11,.96,0,.1,.97,0,.09,.98,0,.08,.99,0,.07,1,0,.06],Annotations:[0,"Xx",1,"H",2,"He",3,"Li",4,"Be",5,"B",6,"C",7,"N",8,"O",9,"F",10,"Ne",11,"Na",12,"Mg",13,"Al",14,"Si",15,"P",16,"S",17,"Cl",18,"Ar",19,"K",20,"Ca",21,"Sc",22,"Ti",23,"V",24,"Cr",25,"Mn",26,"Fe",27,"Co",28,"Ni",29,"Cu",30,"Zn",31,"Ga",32,"Ge",33,"As",34,"Se",35,"Br",36,"Kr",37,"Rb",38,"Sr",39,"Y",40,"Zr",41,"Nb",42,"Mo",43,"Tc",44,"Ru",45,"Rh",46,"Pd",47,"Ag",48,"Cd",49,"In",50,"Sn",51,"Sb",52,"Te",53,"I",54,"Xe",55,"Cs",56,"Ba",57,"La",58,"Ce",59,"Pr",60,"Nd",61,"Pm",62,"Sm",63,"Eu",64,"Gd",65,"Tb",66,"Dy",67,"Ho",68,"Er",69,"Tm",70,"Yb",71,"Lu",72,"Hf",73,"Ta",74,"W",75,"Re",76,"Os",77,"Ir",78,"Pt",79,"Au",80,"Hg",81,"Tl",82,"Pb",83,"Bi",84,"Po",85,"At",86,"Rn",87,"Fr",88,"Ra",89,"Ac",90,"Th",91,"Pa",92,"U",93,"Np",94,"Pu",95,"Am",96,"Cm",97,"Bk",98,"Cf",99,"Es",100,"Fm",101,"Md",102,"No",103,"Lr",104,"Rf",105,"Db",106,"Sg",107,"Bh",108,"Hs",109,"Mt",110,"Ds",111,"Rg",112,"Cn",113,"Uut",114,"Uuq",115,"Uup",116,"Uuh",117,"Uus",118,"Uuo"],Name:"BlueObeliskElements"}];const lm=Object.create(null);q2e.filter(t=>t.RGBPoints).filter(t=>t.ColorSpace!=="CIELAB").forEach(t=>{lm[t.Name]=t});const cm=Object.keys(lm);cm.sort();function X2e(t){return lm[t]}function Y2e(t){!t.RGBPoints||t.ColorSpace==="CIELAB"||(lm[t.Name]||(cm.push(t.Name),cm.sort()),lm[t.Name]=t)}function J2e(t){const e=cm.indexOf(t);e>-1&&cm.splice(e,1),delete lm[t]}var m2={addPreset:Y2e,removePresetByName:J2e,getPresetByName:X2e,rgbPresetNames:cm};const{vtkErrorMacro:Y5}=le;function Z2e(t,e){e.classHierarchy.push("vtkPiecewiseFunction"),t.getSize=()=>e.nodes.length,t.getType=()=>{let n,r=0,i=0;e.nodes.length>0&&(r=e.nodes[0].y);for(let a=1;a<e.nodes.length;a++){if(n=e.nodes[a].y,n!==r)if(n>r)switch(i){case 0:case 1:i=1;break;case 2:default:i=3;break}else switch(i){case 0:case 2:i=2;break;case 1:default:i=3;break}if(r=n,i===3)break}switch(i){case 0:return"Constant";case 1:return"NonDecreasing";case 2:return"NonIncreasing";case 3:default:return"Varied"}},t.getDataPointer=()=>{const n=e.nodes.length;if(e.function=null,n>0){e.function=[];for(let r=0;r<n;r++)e.function[2*r]=e.nodes[r].x,e.function[2*r+1]=e.nodes[r].y}return e.function},t.getFirstNonZeroValue=()=>{if(e.nodes.length===0)return 0;let n=1,r=0,i=0;for(;i<e.nodes.length;i++)if(e.nodes[i].y!==0){n=0;break}return n?r=Number.MAX_VALUE:i>0?r=e.nodes[i-1].x:e.clamping?r=-Number.MAX_VALUE:r=e.nodes[0].x,r},t.getNodeValue=(n,r)=>{const i=e.nodes.length;return n<0||n>=i?(Y5("Index out of range!"),-1):(r[0]=e.nodes[n].x,r[1]=e.nodes[n].y,r[2]=e.nodes[n].midpoint,r[3]=e.nodes[n].sharpness,1)},t.setNodeValue=(n,r)=>{const i=e.nodes.length;if(n<0||n>=i)return Y5("Index out of range!"),-1;const a=e.nodes[n].x;return e.nodes[n].x=r[0],e.nodes[n].y=r[1],e.nodes[n].midpoint=r[2],e.nodes[n].sharpness=r[3],a!==r[0]?t.sortAndUpdateRange():t.modified(),1},t.addPoint=(n,r)=>t.addPointLong(n,r,.5,0),t.addPointLong=(n,r,i,a)=>{if(i<0||i>1)return Y5("Midpoint outside range [0.0, 1.0]"),-1;if(a<0||a>1)return Y5("Sharpness outside range [0.0, 1.0]"),-1;e.allowDuplicateScalars||t.removePoint(n);const o={x:n,y:r,midpoint:i,sharpness:a};e.nodes.push(o),t.sortAndUpdateRange();let s;for(s=0;s<e.nodes.length&&e.nodes[s].x!==n;s++);return s<e.nodes.length?s:-1},t.setNodes=n=>{e.nodes!==n&&(e.nodes=n,t.sortAndUpdateRange())},t.sortAndUpdateRange=()=>{e.nodes.sort((r,i)=>r.x-i.x),t.updateRange()||t.modified()},t.updateRange=()=>{const n=e.range.slice(),r=e.nodes.length;return r?(e.range[0]=e.nodes[0].x,e.range[1]=e.nodes[r-1].x):(e.range[0]=0,e.range[1]=0),n[0]===e.range[0]&&n[1]===e.range[1]?!1:(t.modified(),!0)},t.removePoint=n=>{let r;for(r=0;r<e.nodes.length&&e.nodes[r].x!==n;r++);if(r>=e.nodes.length)return-1;const i=r;let a=!1;return e.nodes.splice(r,1),(r===0||r===e.nodes.length)&&(a=t.updateRange()),a||t.modified(),i},t.removeAllPoints=()=>{e.nodes=[],t.sortAndUpdateRange()},t.addSegment=(n,r,i,a)=>{t.sortAndUpdateRange();for(let o=0;o<e.nodes.length;)e.nodes[o].x>=n&&e.nodes[o].x<=i?e.nodes.splice(o,1):o++;t.addPoint(n,r,.5,0),t.addPoint(i,a,.5,0)},t.getValue=n=>{const r=[];return t.getTable(n,n,1,r),r[0]},t.adjustRange=n=>{if(n.length<2)return 0;const r=t.getRange();r[0]<n[0]?t.addPoint(n[0],t.getValue(n[0])):t.addPoint(n[0],t.getValue(r[0])),r[1]>n[1]?t.addPoint(n[1],t.getValue(n[1])):t.addPoint(n[1],t.getValue(r[1])),t.sortAndUpdateRange();for(let i=0;i<e.nodes.length;)e.nodes[i].x>=n[0]&&e.nodes[i].x<=n[1]?e.nodes.splice(i,1):++i;return t.sortAndUpdateRange(),1},t.estimateMinNumberOfSamples=(n,r)=>{const i=t.findMinimumXDistance();return Math.ceil((r-n)/i)},t.findMinimumXDistance=()=>{const n=e.nodes.length;if(n<2)return-1;let r=e.nodes[1].x-e.nodes[0].x;for(let i=0;i<n-1;i++){const a=e.nodes[i+1].x-e.nodes[i].x;a<r&&(r=a)}return r},t.getTable=function(n,r,i,a){let o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1,s,l=0;const c=e.nodes.length;let f=0;c!==0&&(f=e.nodes[c-1].y);let u=0,d=0,h=0,p=0,g=0,m=0,y=0;for(s=0;s<i;s++){const v=o*s;for(i>1?u=n+s/(i-1)*(r-n):u=.5*(n+r);l<c&&u>e.nodes[l].x;)l++,l<c&&(d=e.nodes[l-1].x,h=e.nodes[l].x,p=e.nodes[l-1].y,g=e.nodes[l].y,m=e.nodes[l-1].midpoint,y=e.nodes[l-1].sharpness,m<1e-5&&(m=1e-5),m>.99999&&(m=.99999));if(l>=c)a[v]=e.clamping?f:0;else if(l===0)a[v]=e.clamping?e.nodes[0].y:0;else{let x=(u-d)/(h-d);if(x<m?x=.5*x/m:x=.5+.5*(x-m)/(1-m),y>.99)if(x<.5){a[v]=p;continue}else{a[v]=g;continue}if(y<.01){a[v]=(1-x)*p+x*g;continue}x<.5?x=.5*(x*2)**(1+10*y):x>.5&&(x=1-.5*((1-x)*2)**(1+10*y));const w=x*x,S=w*x,T=2*S-3*w+1,_=-2*S+3*w,D=S-2*w+x,I=S-w,R=g-p,M=(1-y)*R;a[v]=T*p+_*g+D*M+I*M;const A=p<g?p:g,L=p>g?p:g;a[v]=a[v]<A?A:a[v],a[v]=a[v]>L?L:a[v]}}}}const Q2e={range:[0,0],clamping:!0,allowDuplicateScalars:!1};function ZH(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Q2e,n),le.obj(t,e),e.nodes=[],le.setGet(t,e,["allowDuplicateScalars","clamping"]),le.setArray(t,e,["range"],2),le.getArray(t,e,["range"]),Z2e(t,e)}const eye=le.newInstance(ZH,"vtkPiecewiseFunction");var Xh={newInstance:eye,extend:ZH},QH=1e-6,_s=typeof Float32Array<"u"?Float32Array:Array;function VT(t){return t>=0?Math.round(t):t%.5===0?Math.floor(t):Math.round(t)}function l3(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:QH;return Math.abs(t-e)<=n*Math.max(1,Math.abs(t),Math.abs(e))}function J5(t,e,n,r,i,a,o,s,l){var c=new _s(9);return c[0]=t,c[1]=e,c[2]=n,c[3]=r,c[4]=i,c[5]=a,c[6]=o,c[7]=s,c[8]=l,c}function qp(t){var e=t[0],n=t[1],r=t[2],i=t[3],a=t[4],o=t[5],s=t[6],l=t[7],c=t[8];return e*(c*a-o*l)+n*(-c*i+o*s)+r*(l*i-a*s)}function h0(){var t=new _s(16);return _s!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function sL(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function eK(t,e,n,r,i,a,o,s,l,c,f,u,d,h,p,g){var m=new _s(16);return m[0]=t,m[1]=e,m[2]=n,m[3]=r,m[4]=i,m[5]=a,m[6]=o,m[7]=s,m[8]=l,m[9]=c,m[10]=f,m[11]=u,m[12]=d,m[13]=h,m[14]=p,m[15]=g,m}function lL(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function cL(t,e){if(t===e){var n=e[1],r=e[2],i=e[3],a=e[6],o=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=a,t[11]=e[14],t[12]=i,t[13]=o,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function U9(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],s=e[5],l=e[6],c=e[7],f=e[8],u=e[9],d=e[10],h=e[11],p=e[12],g=e[13],m=e[14],y=e[15],v=n*s-r*o,x=n*l-i*o,w=n*c-a*o,S=r*l-i*s,T=r*c-a*s,_=i*c-a*l,D=f*g-u*p,I=f*m-d*p,R=f*y-h*p,M=u*m-d*g,A=u*y-h*g,L=d*y-h*m,P=v*L-x*A+w*M+S*R-T*I+_*D;return P?(P=1/P,t[0]=(s*L-l*A+c*M)*P,t[1]=(i*A-r*L-a*M)*P,t[2]=(g*_-m*T+y*S)*P,t[3]=(d*T-u*_-h*S)*P,t[4]=(l*R-o*L-c*I)*P,t[5]=(n*L-i*R+a*I)*P,t[6]=(m*w-p*_-y*x)*P,t[7]=(f*_-d*w+h*x)*P,t[8]=(o*A-s*R+c*D)*P,t[9]=(r*R-n*A-a*D)*P,t[10]=(p*T-g*w+y*v)*P,t[11]=(u*w-f*T-h*v)*P,t[12]=(s*I-o*M-l*D)*P,t[13]=(n*M-r*I+i*D)*P,t[14]=(g*x-p*S-m*v)*P,t[15]=(f*S-u*x+d*v)*P,t):null}function tK(t,e,n){var r=n[0],i=n[1],a=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*a,t[9]=e[9]*a,t[10]=e[10]*a,t[11]=e[11]*a,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function nK(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function tye(t,e,n){var r=n[0],i=n[1],a=n[2],o=Math.sqrt(r*r+i*i+a*a),s,l,c;return o<QH?null:(o=1/o,r*=o,i*=o,a*=o,s=Math.sin(e),l=Math.cos(e),c=1-l,t[0]=r*r*c+l,t[1]=i*r*c+a*s,t[2]=a*r*c-i*s,t[3]=0,t[4]=r*i*c-a*s,t[5]=i*i*c+l,t[6]=a*i*c+r*s,t[7]=0,t[8]=r*a*c+i*s,t[9]=i*a*c-r*s,t[10]=a*a*c+l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function nye(t,e,n,r,i,a,o){var s=1/(e-n),l=1/(r-i),c=1/(a-o);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+n)*s,t[13]=(i+r)*l,t[14]=(o+a)*c,t[15]=1,t}var rye=nye;function iye(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t}function ct(){var t=new _s(3);return _s!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function rK(t){var e=new _s(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function Ao(t){var e=t[0],n=t[1],r=t[2];return Math.sqrt(e*e+n*n+r*r)}function En(t,e,n){var r=new _s(3);return r[0]=t,r[1]=e,r[2]=n,r}function B9(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function c3(t,e,n,r){return t[0]=e,t[1]=n,t[2]=r,t}function Nl(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function Dr(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function aye(t,e){return t[0]=VT(e[0]),t[1]=VT(e[1]),t[2]=VT(e[2]),t}function Xs(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function Or(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t}function el(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return Math.sqrt(n*n+r*r+i*i)}function iK(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return n*n+r*r+i*i}function su(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function Ir(t,e){var n=e[0],r=e[1],i=e[2],a=n*n+r*r+i*i;return a>0&&(a=1/Math.sqrt(a)),t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a,t}function zt(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function dr(t,e,n){var r=e[0],i=e[1],a=e[2],o=n[0],s=n[1],l=n[2];return t[0]=i*l-a*s,t[1]=a*o-r*l,t[2]=r*s-i*o,t}function v2(t,e,n){var r=e[0],i=e[1],a=e[2],o=n[3]*r+n[7]*i+n[11]*a+n[15];return o=o||1,t[0]=(n[0]*r+n[4]*i+n[8]*a+n[12])/o,t[1]=(n[1]*r+n[5]*i+n[9]*a+n[13])/o,t[2]=(n[2]*r+n[6]*i+n[10]*a+n[14])/o,t}function aK(t,e){var n=t[0],r=t[1],i=t[2],a=e[0],o=e[1],s=e[2],l=Math.sqrt((n*n+r*r+i*i)*(a*a+o*o+s*s)),c=l&&zt(t,e)/l;return Math.acos(Math.min(Math.max(c,-1),1))}var ur=Dr,oye=iK,g6=Ao;(function(){var t=ct();return function(e,n,r,i,a,o){var s,l;for(n||(n=3),r||(r=0),i?l=Math.min(i*n+r,e.length):l=e.length,s=r;s<l;s+=n)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],a(t,t,o),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2];return e}})();function oK(){var t=new _s(4);return _s!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function FT(t,e,n,r){var i=new _s(4);return i[0]=t,i[1]=e,i[2]=n,i[3]=r,i}function uL(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function sye(t,e,n){var r=e[0],i=e[1],a=e[2],o=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*a+n[12]*o,t[1]=n[1]*r+n[5]*i+n[9]*a+n[13]*o,t[2]=n[2]*r+n[6]*i+n[10]*a+n[14]*o,t[3]=n[3]*r+n[7]*i+n[11]*a+n[15]*o,t}(function(){var t=oK();return function(e,n,r,i,a,o){var s,l;for(n||(n=4),r||(r=0),i?l=Math.min(i*n+r,e.length):l=e.length,s=r;s<l;s+=n)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],t[3]=e[s+3],a(t,t,o),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2],e[s+3]=t[3];return e}})();function Hn(){var t=new _s(2);return _s!=Float32Array&&(t[0]=0,t[1]=0),t}function fL(t,e){var n=new _s(2);return n[0]=t,n[1]=e,n}function Ol(t,e,n){return t[0]=e,t[1]=n,t}function jw(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function Ra(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t}function m6(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t}function mv(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t}function ei(t,e){var n=e[0]-t[0],r=e[1]-t[1];return Math.sqrt(n*n+r*r)}function Xd(t,e){var n=e[0]-t[0],r=e[1]-t[1];return n*n+r*r}function v6(t){var e=t[0],n=t[1];return Math.sqrt(e*e+n*n)}function Dh(t,e){var n=e[0],r=e[1],i=n*n+r*r;return i>0&&(i=1/Math.sqrt(i)),t[0]=e[0]*i,t[1]=e[1]*i,t}function uf(t,e){return t[0]*e[0]+t[1]*e[1]}function lye(t,e,n,r){var i=e[0]-n[0],a=e[1]-n[1],o=Math.sin(r),s=Math.cos(r);return t[0]=i*s-a*o+n[0],t[1]=i*o+a*s+n[1],t}var Yh=Ra,$9=ei;(function(){var t=Hn();return function(e,n,r,i,a,o){var s,l;for(n||(n=2),r||(r=0),i?l=Math.min(i*n+r,e.length):l=e.length,s=r;s<l;s+=n)t[0]=e[s],t[1]=e[s+1],a(t,t,o),e[s]=t[0],e[s+1]=t[1];return e}})();function mi(t){const e=t.indexOf(":");return t.substring(e+1)}function sK(t){let e=2166136261;for(let n=0;n<t.length;n++)e^=t.charCodeAt(n),e+=(e<<1)+(e<<4)+(e<<7)+(e<<8)+(e<<24);return(e>>>0).toString(36)}const cye=1073741824;class uye{constructor(){this._imageCache=new Map,this._volumeCache=new Map,this._imageIdsToVolumeIdCache=new Map,this._referencedImageIdToImageIdCache=new Map,this._geometryCache=new Map,this._imageCacheSize=0,this._maxCacheSize=3*cye,this._geometryCacheSize=0,this.setMaxCacheSize=e=>{if(!e||typeof e!="number"){const n=`New max cacheSize ${this._maxCacheSize} should be defined and should be a number.`;throw new Error(n)}this._maxCacheSize=e},this.isCacheable=e=>{const n=this.getBytesAvailable(),r=Array.from(this._imageCache.values()).reduce((a,o)=>o.sharedCacheKey?a:a+o.sizeInBytes,0);return n+r>=e},this.getMaxCacheSize=()=>this._maxCacheSize,this.getCacheSize=()=>this._imageCacheSize,this._decacheImage=(e,n=!1)=>{const r=this._imageCache.get(e);if(!r)return;if(r.sharedCacheKey&&!n)throw new Error("Cannot decache an image with a shared cache key. You need to manually decache the volume first.");const{imageLoadObject:i}=r;r.image?.referencedImageId&&this._referencedImageIdToImageIdCache.delete(r.image.referencedImageId),i?.cancelFn&&i.cancelFn(),i?.decache&&i.decache(),this._imageCache.delete(e)},this._decacheVolume=e=>{const n=this._volumeCache.get(e);if(!n)return;const{volumeLoadObject:r,volume:i}=n;i&&(i.cancelLoading&&i.cancelLoading(),i.imageData&&i.imageData.delete(),r.cancelFn&&r.cancelFn(),i.imageIds&&i.imageIds.forEach(a=>{const o=this._imageCache.get(a);o&&o.sharedCacheKey===e&&(o.sharedCacheKey=void 0)}),this._volumeCache.delete(e))},this.purgeCache=()=>{const e=this._imageCache.keys();for(this.purgeVolumeCache();;){const{value:n,done:r}=e.next();if(r)break;this.removeImageLoadObject(n,{force:!0}),Ct(St,vt.IMAGE_CACHE_IMAGE_REMOVED,{imageId:n})}},this.purgeVolumeCache=()=>{const e=this._volumeCache.keys();for(;;){const{value:n,done:r}=e.next();if(r)break;this.removeVolumeLoadObject(n),Ct(St,vt.VOLUME_CACHE_VOLUME_REMOVED,{volumeId:n})}},this.getVolumeLoadObject=e=>{if(e===void 0)throw new Error("getVolumeLoadObject: volumeId must not be undefined");const n=this._volumeCache.get(e);if(n)return n.timeStamp=Date.now(),n.volumeLoadObject},this.putGeometryLoadObject=(e,n)=>{if(e===void 0)throw new Error("putGeometryLoadObject: geometryId must not be undefined");if(n.promise===void 0)throw new Error("putGeometryLoadObject: geometryLoadObject.promise must not be undefined");if(this._geometryCache.has(e))throw new Error("putGeometryLoadObject: geometryId already present in geometryCache");if(n.cancelFn&&typeof n.cancelFn!="function")throw new Error("putGeometryLoadObject: geometryLoadObject.cancel must be a function");const r={loaded:!1,geometryId:e,geometryLoadObject:n,timeStamp:Date.now(),sizeInBytes:0};return this._geometryCache.set(e,r),n.promise.then(i=>{try{this._putGeometryCommon(e,i,r)}catch(a){throw console.debug(`Error in _putGeometryCommon for geometry ${e}:`,a),a}}).catch(i=>{throw console.debug(`Error caching geometry ${e}:`,i),this._geometryCache.delete(e),i})},this.getGeometry=e=>{if(e===void 0)throw new Error("getGeometry: geometryId must not be undefined");const n=this._geometryCache.get(e);if(n)return n.timeStamp=Date.now(),n.geometry},this.removeGeometryLoadObject=e=>{if(e===void 0)throw new Error("removeGeometryLoadObject: geometryId must not be undefined");const n=this._geometryCache.get(e);if(!n)throw new Error("removeGeometryLoadObject: geometryId was not present in geometryCache");this.decrementGeometryCacheSize(n.sizeInBytes);const r={geometry:n,geometryId:e};Ct(St,vt.GEOMETRY_CACHE_GEOMETRY_REMOVED,r),this._decacheGeometry(e)},this._decacheGeometry=e=>{const n=this._geometryCache.get(e);if(!n)return;const{geometryLoadObject:r}=n;r.cancelFn&&r.cancelFn(),r.decache&&r.decache(),this._geometryCache.delete(e)},this.incrementGeometryCacheSize=e=>{this._geometryCacheSize+=e},this.decrementGeometryCacheSize=e=>{this._geometryCacheSize-=e},this.getImageByReferencedImageId=e=>{const n=this._referencedImageIdToImageIdCache.get(e);if(n)return this._imageCache.get(n)?.image},this.getImage=(e,n=Cs.FAR_REPLICATE)=>{if(e===void 0)throw new Error("getImage: imageId must not be undefined");const r=this._imageCache.get(e);if(r&&(r.timeStamp=Date.now(),!(r.image?.imageQualityStatus<n)))return r.image},this.getVolume=(e,n=!1)=>{if(e===void 0)throw new Error("getVolume: volumeId must not be undefined");const r=this._volumeCache.get(e);return r?(r.timeStamp=Date.now(),r.volume):n?[...this._volumeCache.values()].find(i=>i.volumeId.includes(e))?.volume:void 0},this.getVolumes=()=>Array.from(this._volumeCache.values()).map(n=>n.volume),this.filterVolumesByReferenceId=e=>this.getVolumes().filter(r=>r.referencedVolumeId===e),this.removeImageLoadObject=(e,{force:n=!1}={})=>{if(e===void 0)throw new Error("removeImageLoadObject: imageId must not be undefined");const r=this._imageCache.get(e);if(!r)throw new Error("removeImageLoadObject: imageId was not present in imageCache");this._decacheImage(e,n),this.incrementImageCacheSize(-r.sizeInBytes);const i={image:r,imageId:e};Ct(St,vt.IMAGE_CACHE_IMAGE_REMOVED,i)},this.removeVolumeLoadObject=e=>{if(e===void 0)throw new Error("removeVolumeLoadObject: volumeId must not be undefined");const n=this._volumeCache.get(e);if(!n)throw new Error("removeVolumeLoadObject: volumeId was not present in volumeCache");const r={volume:n,volumeId:e};Ct(St,vt.VOLUME_CACHE_VOLUME_REMOVED,r),this._decacheVolume(e)},this.incrementImageCacheSize=e=>{this._imageCacheSize+=e},this.decrementImageCacheSize=e=>{this._imageCacheSize-=e},this.getGeometryLoadObject=e=>{if(e===void 0)throw new Error("getGeometryLoadObject: geometryId must not be undefined");const n=this._geometryCache.get(e);if(n)return n.timeStamp=Date.now(),n.geometryLoadObject}}generateVolumeId(e){const n=e.map(mi).sort();let r=2166136261;for(const i of n){const a=sK(i);for(let o=0;o<a.length;o++)r^=a.charCodeAt(o),r+=(r<<1)+(r<<4)+(r<<7)+(r<<8)+(r<<24)}return`volume-${(r>>>0).toString(36)}`}getImageIdsForVolumeId(e){return Array.from(this._imageIdsToVolumeIdCache.entries()).filter(([n,r])=>r===e).map(([n])=>n)}getBytesAvailable(){return this.getMaxCacheSize()-this.getCacheSize()}decacheIfNecessaryUntilBytesAvailable(e,n){let r=this.getBytesAvailable();if(r>=e)return r;const i=Array.from(this._imageCache.values()).filter(l=>!l.sharedCacheKey);function a(l,c){return l.timeStamp>c.timeStamp?1:l.timeStamp<c.timeStamp?-1:0}i.sort(a);const o=i.map(l=>l.imageId);let s=o;n&&(s=o.filter(l=>!n.includes(l)));for(const l of s)if(this.removeImageLoadObject(l),Ct(St,vt.IMAGE_CACHE_IMAGE_REMOVED,{imageId:l}),r=this.getBytesAvailable(),r>=e)return r;for(const l of o)if(this.removeImageLoadObject(l),Ct(St,vt.IMAGE_CACHE_IMAGE_REMOVED,{imageId:l}),r=this.getBytesAvailable(),r>=e)return r}_putImageCommon(e,n,r){if(!this._imageCache.has(e)){console.warn("The image was purged from the cache before it completed loading.");return}if(!n){console.warn("Image is undefined");return}if(n.sizeInBytes===void 0||Number.isNaN(n.sizeInBytes))throw new Error("_putImageCommon: image.sizeInBytes must not be undefined");if(n.sizeInBytes.toFixed===void 0)throw new Error("_putImageCommon: image.sizeInBytes is not a number");if(!this.isCacheable(n.sizeInBytes))throw new Error(vt.CACHE_SIZE_EXCEEDED);this.decacheIfNecessaryUntilBytesAvailable(n.sizeInBytes),r.loaded=!0,r.image=n,r.sizeInBytes=n.sizeInBytes,this.incrementImageCacheSize(r.sizeInBytes);const i={image:r};n.referencedImageId&&this._referencedImageIdToImageIdCache.set(n.referencedImageId,e),Ct(St,vt.IMAGE_CACHE_IMAGE_ADDED,i),r.sharedCacheKey=n.sharedCacheKey}async putImageLoadObject(e,n){if(e===void 0)throw console.error("putImageLoadObject: imageId must not be undefined"),new Error("putImageLoadObject: imageId must not be undefined");if(n.promise===void 0)throw console.error("putImageLoadObject: imageLoadObject.promise must not be undefined"),new Error("putImageLoadObject: imageLoadObject.promise must not be undefined");const r=this._imageCache.get(e);if(r?.imageLoadObject)throw console.warn(`putImageLoadObject: imageId ${e} already in cache`),new Error("putImageLoadObject: imageId already in cache");if(n.cancelFn&&typeof n.cancelFn!="function")throw console.error("putImageLoadObject: imageLoadObject.cancel must be a function"),new Error("putImageLoadObject: imageLoadObject.cancel must be a function");const i={...r,loaded:!1,imageId:e,sharedCacheKey:void 0,imageLoadObject:n,timeStamp:Date.now(),sizeInBytes:0};return this._imageCache.set(e,i),n.promise.then(a=>{try{this._putImageCommon(e,a,i)}catch(o){throw console.debug(`Error in _putImageCommon for image ${e}:`,o),o}}).catch(a=>{throw console.debug(`Error caching image ${e}:`,a),this._imageCache.delete(e),a})}putImageSync(e,n){if(e===void 0)throw new Error("putImageSync: imageId must not be undefined");if(this._imageCache.has(e))throw new Error("putImageSync: imageId already in cache");const r={loaded:!1,imageId:e,sharedCacheKey:void 0,imageLoadObject:{promise:Promise.resolve(n)},timeStamp:Date.now(),sizeInBytes:0};this._imageCache.set(e,r);try{this._putImageCommon(e,n,r)}catch(i){throw this._imageCache.delete(e),i}}getImageLoadObject(e){if(e===void 0)throw new Error("getImageLoadObject: imageId must not be undefined");const n=this._imageCache.get(e);if(n)return n.timeStamp=Date.now(),n.imageLoadObject}isLoaded(e){const n=this._imageCache.get(e);return n?n.loaded:!1}getVolumeContainingImageId(e){const n=Array.from(this._volumeCache.keys()),r=mi(e);for(const i of n){const a=this._volumeCache.get(i);if(!a)return;const{volume:o}=a;if(!o.imageIds.length)return;const s=o.getImageURIIndex(r);if(s>-1)return{volume:o,imageIdIndex:s}}}getCachedImageBasedOnImageURI(e){const n=mi(e),i=Array.from(this._imageCache.keys()).find(a=>mi(a)===n);if(i)return this._imageCache.get(i)}_putVolumeCommon(e,n,r){if(!this._volumeCache.get(e)){console.warn("The volume was purged from the cache before it completed loading.");return}r.loaded=!0,r.volume=n,n.imageIds?.forEach(a=>{const o=this._imageCache.get(a);o&&(o.sharedCacheKey=e)});const i={volume:r};Ct(St,vt.VOLUME_CACHE_VOLUME_ADDED,i)}putVolumeSync(e,n){if(e===void 0)throw new Error("putVolumeSync: volumeId must not be undefined");if(this._volumeCache.has(e))throw new Error("putVolumeSync: volumeId already in cache");const r={loaded:!1,volumeId:e,volumeLoadObject:{promise:Promise.resolve(n)},timeStamp:Date.now(),sizeInBytes:0};this._volumeCache.set(e,r);try{this._putVolumeCommon(e,n,r)}catch(i){throw this._volumeCache.delete(e),i}}async putVolumeLoadObject(e,n){if(e===void 0)throw new Error("putVolumeLoadObject: volumeId must not be undefined");if(n.promise===void 0)throw new Error("putVolumeLoadObject: volumeLoadObject.promise must not be undefined");if(this._volumeCache.has(e))throw new Error(`putVolumeLoadObject: volumeId:${e} already in cache`);if(n.cancelFn&&typeof n.cancelFn!="function")throw new Error("putVolumeLoadObject: volumeLoadObject.cancel must be a function");const r={loaded:!1,volumeId:e,volumeLoadObject:n,timeStamp:Date.now(),sizeInBytes:0};return this._volumeCache.set(e,r),n.promise.then(i=>{try{this._putVolumeCommon(e,i,r)}catch(a){throw console.error(`Error in _putVolumeCommon for volume ${e}:`,a),this._volumeCache.delete(e),a}}).catch(i=>{throw this._volumeCache.delete(e),i})}_putGeometryCommon(e,n,r){if(!this._geometryCache.get(e)){console.warn("The geometry was purged from the cache before it completed loading.");return}if(!n){console.warn("Geometry is undefined");return}if(n.sizeInBytes===void 0||Number.isNaN(n.sizeInBytes))throw new Error("_putGeometryCommon: geometry.sizeInBytes must not be undefined");if(n.sizeInBytes.toFixed===void 0)throw new Error("_putGeometryCommon: geometry.sizeInBytes is not a number");if(!this.isCacheable(n.sizeInBytes))throw new Error(vt.CACHE_SIZE_EXCEEDED);this.decacheIfNecessaryUntilBytesAvailable(n.sizeInBytes),r.loaded=!0,r.geometry=n,r.sizeInBytes=n.sizeInBytes,this.incrementGeometryCacheSize(r.sizeInBytes);const i={geometry:r};Ct(St,vt.GEOMETRY_CACHE_GEOMETRY_ADDED,i)}putGeometrySync(e,n){if(e===void 0)throw new Error("putGeometrySync: geometryId must not be undefined");if(this._geometryCache.has(e))throw new Error("putGeometrySync: geometryId already in cache");const r={loaded:!1,geometryId:e,geometryLoadObject:{promise:Promise.resolve(n)},timeStamp:Date.now(),sizeInBytes:0};this._geometryCache.set(e,r);try{this._putGeometryCommon(e,n,r)}catch(i){throw this._geometryCache.delete(e),i}}setPartialImage(e,n){const r=this._imageCache.get(e);if(!r){n&&this._imageCache.set(e,{image:n,imageId:e,loaded:!1,timeStamp:Date.now(),sizeInBytes:0});return}r.loaded&&(r.loaded=!1,r.imageLoadObject=null,this.incrementImageCacheSize(-r.sizeInBytes),r.sizeInBytes=0),r.image=n||r.image}getImageQuality(e){const n=this._imageCache.get(e)?.image;return n?n.imageQualityStatus||Cs.FULL_RESOLUTION:void 0}}const yt=new uye;function lK(t,e,n){return Math.abs(t-e)<=n}function fye(t,e,n=1e-5){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!lK(t[r],e[r],n))return!1;return!0}function dL(t){return typeof t=="number"}function hL(t){return t&&typeof t=="object"&&"length"in t&&typeof t.length=="number"&&t.length>0&&typeof t[0]=="number"}function fr(t,e,n=1e-5){return typeof t!=typeof e||t===null||e===null?!1:dL(t)&&dL(e)?lK(t,e,n):hL(t)&&hL(e)?fye(t,e,n):!1}const cK=t=>typeof t=="number"?-t:t?.map?t.map(cK):!t,y6=t=>typeof t=="number"?Math.abs(t):t?.map?t.map(y6):t,uK=(t,e,n=void 0)=>fr(t,cK(e),n),lb=(t,e,n=void 0)=>fr(y6(t),y6(e),n);function li(t){return Array.isArray(t)?li(t[0]):isFinite(t)&&!isNaN(t)}function uc(t){return Jo(t,"vtkVolume")||Jo(t,"vtkImageSlice")}function Jo(t,e){const n="isA"in t?t:t.actor;return n?!!n.isA(e):!1}const G9=new Map;function dye(t){t.name=t.name||t.Name,G9.set(t.name,t)}function y2(t){return G9.get(t)}function fK(){return Array.from(G9.keys())}function j9(t,e){const n=m2.rgbPresetNames.map(l=>m2.getPresetByName(l)),r=fK().map(l=>y2(l)),a=n.concat(r).find(l=>{const{RGBPoints:c}=l;if(c.length!==t.length)return!1;for(let f=0;f<c.length;f+=4)if(!fr(c.slice(f+1,f+4),t.slice(f+1,f+4)))return!1;return!0});if(!a)return null;const o=[];if(Jo(e,"vtkVolume")){const l=e.getProperty().getScalarOpacity(0).getDataPointer();if(!l)return{name:a.Name};for(let c=0;c<l.length;c+=2)o.push({value:l[c],opacity:l[c+1]})}return{name:a.Name,...Array.isArray(o)&&o.length>0&&{opacity:o},...typeof o=="number"&&{opacity:o}}}function hye(t){const{volumeActor:e,preset:n,opacity:r=.9,threshold:i=null,colorRange:a=[0,5]}=t;e.getMapper().setSampleDistance(1);const s=Lf.newInstance(),l=n||m2.getPresetByName("hsv");s.applyColorMap(l),s.setMappingRange(a[0],a[1]),e.getProperty().setRGBTransferFunction(0,s),z9(e,r,i)}function dK(t,e){const n=W9(t);z9(t,e,n)}function hK(t,e){const n=H9(t);z9(t,n,e)}function z9(t,e,n){const r=t.getMapper().getInputData().get("voxelManager");if(!r?.voxelManager)throw new Error("No voxel manager was found for the volume actor, or you cannot yet update opacity with a threshold using stacked images");const i=r.voxelManager.getRange(),a=Xh.newInstance();if(n!==null){const o=Math.abs(i[1]-i[0])*.001,s=Math.max(i[0],Math.min(i[1],n));a.addPoint(i[0],0),a.addPoint(s-o,0),a.addPoint(s,e),a.addPoint(i[1],e)}else a.addPoint(i[0],e),a.addPoint(i[1],e);t.getProperty().setScalarOpacity(0,a)}function W9(t){const e=t.getProperty().getScalarOpacity(0);if(!e)return null;const n=e.getDataPointer();if(!n||n.length<=4)return null;for(let r=0;r<n.length-2;r+=2){n[r];const i=n[r+1],a=n[r+2],o=n[r+3];if(i===0&&o>0)return a}return null}function H9(t){const e=t.getProperty().getScalarOpacity(0);if(!e)return 1;const n=e.getDataPointer();if(!n||n.length===0)return 1;let r=0;for(let i=1;i<n.length;i+=2)n[i]>r&&(r=n[i]);return r}const pye=Object.freeze(Object.defineProperty({__proto__:null,findMatchingColormap:j9,getColormap:y2,getColormapNames:fK,getMaxOpacity:H9,getThresholdValue:W9,registerColormap:dye,setColorMapTransferFunctionForVolumeActor:hye,updateOpacity:dK,updateThreshold:hK},Symbol.toStringTag,{value:"Module"}));function Lv(t){if(!t)return;const e=t.getSize();for(let n=0;n<e;n++){const r=[];t.getNodeValue(n,r),r[1]=1-r[1],r[2]=1-r[2],r[3]=1-r[3],t.setNodeValue(n,r)}}const x6=(t,e,n)=>e-n/4*Math.log((1-t)/t);function ry(t,e){const n=Math.abs(e-t)+1,r=(t+e+1)/2;return{windowWidth:n,windowCenter:r}}function Gg(t,e,n=oo.LINEAR){if(n===oo.LINEAR)return{lower:e-.5-(t-1)/2,upper:e-.5+(t-1)/2};if(n===oo.LINEAR_EXACT)return{lower:e-t/2,upper:e+t/2};if(n===oo.SAMPLED_SIGMOID){const r=x6(.01,e,t),i=x6(.99,e,t);return{lower:r,upper:i}}else throw new Error("Invalid VOI LUT function")}const gye=Object.freeze(Object.defineProperty({__proto__:null,toLowHighRange:Gg,toWindowLevel:ry},Symbol.toStringTag,{value:"Module"}));function K9(t,e=1024){const{windowWidth:n,windowCenter:r}=ry(t.lower,t.upper),a=Array.from({length:e},(s,l)=>(l+1)/(e+2)).flatMap(s=>[x6(s,r,n),s,s,s,.5,0]),o=Lf.newInstance();return o.buildFunctionFromArray(nn.newInstance({values:a,numberOfComponents:6})),o}function io(t,e){return t.worldToIndex(e).map(Math.round)}function cb(t,e){return t.worldToIndex(e)}function u3(t){const e=t.getSize(),n=[];for(let r=0;r<e;r++){const i=[];t.getNodeValue(r,i),n.push(i)}return n}function zw(t,e){e?.length&&(t.removeAllPoints(),e.forEach(n=>{t.addRGBPoint(...n)}))}const mye=Object.freeze(Object.defineProperty({__proto__:null,getTransferFunctionNodes:u3,setTransferFunctionNodes:zw},Symbol.toStringTag,{value:"Module"}));var ar=1e-6,Ha=typeof Float32Array<"u"?Float32Array:Array,vye=Math.PI/180;function yye(t){return t*vye}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});function q9(){var t=new Ha(9);return Ha!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function Ww(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}function xye(t){var e=new Ha(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function bye(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function wye(t,e,n,r,i,a,o,s,l){var c=new Ha(9);return c[0]=t,c[1]=e,c[2]=n,c[3]=r,c[4]=i,c[5]=a,c[6]=o,c[7]=s,c[8]=l,c}function pK(t,e,n,r,i,a,o,s,l,c){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=a,t[5]=o,t[6]=s,t[7]=l,t[8]=c,t}function Ll(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function X9(t,e){if(t===e){var n=e[1],r=e[2],i=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=r,t[7]=i}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function iy(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],s=e[5],l=e[6],c=e[7],f=e[8],u=f*o-s*c,d=-f*a+s*l,h=c*a-o*l,p=n*u+r*d+i*h;return p?(p=1/p,t[0]=u*p,t[1]=(-f*r+i*c)*p,t[2]=(s*r-i*o)*p,t[3]=d*p,t[4]=(f*n-i*l)*p,t[5]=(-s*n+i*a)*p,t[6]=h*p,t[7]=(-c*n+r*l)*p,t[8]=(o*n-r*a)*p,t):null}function Cye(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],s=e[5],l=e[6],c=e[7],f=e[8];return t[0]=o*f-s*c,t[1]=i*c-r*f,t[2]=r*s-i*o,t[3]=s*l-a*f,t[4]=n*f-i*l,t[5]=i*a-n*s,t[6]=a*c-o*l,t[7]=r*l-n*c,t[8]=n*o-r*a,t}function Sye(t){var e=t[0],n=t[1],r=t[2],i=t[3],a=t[4],o=t[5],s=t[6],l=t[7],c=t[8];return e*(c*a-o*l)+n*(-c*i+o*s)+r*(l*i-a*s)}function um(t,e,n){var r=e[0],i=e[1],a=e[2],o=e[3],s=e[4],l=e[5],c=e[6],f=e[7],u=e[8],d=n[0],h=n[1],p=n[2],g=n[3],m=n[4],y=n[5],v=n[6],x=n[7],w=n[8];return t[0]=d*r+h*o+p*c,t[1]=d*i+h*s+p*f,t[2]=d*a+h*l+p*u,t[3]=g*r+m*o+y*c,t[4]=g*i+m*s+y*f,t[5]=g*a+m*l+y*u,t[6]=v*r+x*o+w*c,t[7]=v*i+x*s+w*f,t[8]=v*a+x*l+w*u,t}function Tye(t,e,n){var r=e[0],i=e[1],a=e[2],o=e[3],s=e[4],l=e[5],c=e[6],f=e[7],u=e[8],d=n[0],h=n[1];return t[0]=r,t[1]=i,t[2]=a,t[3]=o,t[4]=s,t[5]=l,t[6]=d*r+h*o+c,t[7]=d*i+h*s+f,t[8]=d*a+h*l+u,t}function Eye(t,e,n){var r=e[0],i=e[1],a=e[2],o=e[3],s=e[4],l=e[5],c=e[6],f=e[7],u=e[8],d=Math.sin(n),h=Math.cos(n);return t[0]=h*r+d*o,t[1]=h*i+d*s,t[2]=h*a+d*l,t[3]=h*o-d*r,t[4]=h*s-d*i,t[5]=h*l-d*a,t[6]=c,t[7]=f,t[8]=u,t}function _ye(t,e,n){var r=n[0],i=n[1];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=i*e[3],t[4]=i*e[4],t[5]=i*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function Dye(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t}function Oye(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=-n,t[4]=r,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function Mye(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function Iye(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t}function Rye(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],o=n+n,s=r+r,l=i+i,c=n*o,f=r*o,u=r*s,d=i*o,h=i*s,p=i*l,g=a*o,m=a*s,y=a*l;return t[0]=1-u-p,t[3]=f-y,t[6]=d+m,t[1]=f+y,t[4]=1-c-p,t[7]=h-g,t[2]=d-m,t[5]=h+g,t[8]=1-c-u,t}function Aye(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],s=e[5],l=e[6],c=e[7],f=e[8],u=e[9],d=e[10],h=e[11],p=e[12],g=e[13],m=e[14],y=e[15],v=n*s-r*o,x=n*l-i*o,w=n*c-a*o,S=r*l-i*s,T=r*c-a*s,_=i*c-a*l,D=f*g-u*p,I=f*m-d*p,R=f*y-h*p,M=u*m-d*g,A=u*y-h*g,L=d*y-h*m,P=v*L-x*A+w*M+S*R-T*I+_*D;return P?(P=1/P,t[0]=(s*L-l*A+c*M)*P,t[1]=(l*R-o*L-c*I)*P,t[2]=(o*A-s*R+c*D)*P,t[3]=(i*A-r*L-a*M)*P,t[4]=(n*L-i*R+a*I)*P,t[5]=(r*R-n*A-a*D)*P,t[6]=(g*_-m*T+y*S)*P,t[7]=(m*w-p*_-y*x)*P,t[8]=(p*T-g*w+y*v)*P,t):null}function Pye(t,e,n){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/n,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}function Nye(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"}function Lye(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])}function kye(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t}function gK(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t}function Vye(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t}function Fye(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t}function Uye(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]}function Bye(t,e){var n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],s=t[5],l=t[6],c=t[7],f=t[8],u=e[0],d=e[1],h=e[2],p=e[3],g=e[4],m=e[5],y=e[6],v=e[7],x=e[8];return Math.abs(n-u)<=ar*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(r-d)<=ar*Math.max(1,Math.abs(r),Math.abs(d))&&Math.abs(i-h)<=ar*Math.max(1,Math.abs(i),Math.abs(h))&&Math.abs(a-p)<=ar*Math.max(1,Math.abs(a),Math.abs(p))&&Math.abs(o-g)<=ar*Math.max(1,Math.abs(o),Math.abs(g))&&Math.abs(s-m)<=ar*Math.max(1,Math.abs(s),Math.abs(m))&&Math.abs(l-y)<=ar*Math.max(1,Math.abs(l),Math.abs(y))&&Math.abs(c-v)<=ar*Math.max(1,Math.abs(c),Math.abs(v))&&Math.abs(f-x)<=ar*Math.max(1,Math.abs(f),Math.abs(x))}var $ye=um,Gye=gK;const jye=Object.freeze(Object.defineProperty({__proto__:null,add:kye,adjoint:Cye,clone:xye,copy:bye,create:q9,determinant:Sye,equals:Bye,exactEquals:Uye,frob:Lye,fromMat2d:Iye,fromMat4:Ww,fromQuat:Rye,fromRotation:Oye,fromScaling:Mye,fromTranslation:Dye,fromValues:wye,identity:Ll,invert:iy,mul:$ye,multiply:um,multiplyScalar:Vye,multiplyScalarAndAdd:Fye,normalFromMat4:Aye,projection:Pye,rotate:Eye,scale:_ye,set:pK,str:Nye,sub:Gye,subtract:gK,translate:Tye,transpose:X9},Symbol.toStringTag,{value:"Module"}));function Y9(){var t=new Ha(16);return Ha!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function zye(t){var e=new Ha(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Ei(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Wye(t,e,n,r,i,a,o,s,l,c,f,u,d,h,p,g){var m=new Ha(16);return m[0]=t,m[1]=e,m[2]=n,m[3]=r,m[4]=i,m[5]=a,m[6]=o,m[7]=s,m[8]=l,m[9]=c,m[10]=f,m[11]=u,m[12]=d,m[13]=h,m[14]=p,m[15]=g,m}function Hye(t,e,n,r,i,a,o,s,l,c,f,u,d,h,p,g,m){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=a,t[5]=o,t[6]=s,t[7]=l,t[8]=c,t[9]=f,t[10]=u,t[11]=d,t[12]=h,t[13]=p,t[14]=g,t[15]=m,t}function sn(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Gn(t,e){if(t===e){var n=e[1],r=e[2],i=e[3],a=e[6],o=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=a,t[11]=e[14],t[12]=i,t[13]=o,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function ba(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],s=e[5],l=e[6],c=e[7],f=e[8],u=e[9],d=e[10],h=e[11],p=e[12],g=e[13],m=e[14],y=e[15],v=n*s-r*o,x=n*l-i*o,w=n*c-a*o,S=r*l-i*s,T=r*c-a*s,_=i*c-a*l,D=f*g-u*p,I=f*m-d*p,R=f*y-h*p,M=u*m-d*g,A=u*y-h*g,L=d*y-h*m,P=v*L-x*A+w*M+S*R-T*I+_*D;return P?(P=1/P,t[0]=(s*L-l*A+c*M)*P,t[1]=(i*A-r*L-a*M)*P,t[2]=(g*_-m*T+y*S)*P,t[3]=(d*T-u*_-h*S)*P,t[4]=(l*R-o*L-c*I)*P,t[5]=(n*L-i*R+a*I)*P,t[6]=(m*w-p*_-y*x)*P,t[7]=(f*_-d*w+h*x)*P,t[8]=(o*A-s*R+c*D)*P,t[9]=(r*R-n*A-a*D)*P,t[10]=(p*T-g*w+y*v)*P,t[11]=(u*w-f*T-h*v)*P,t[12]=(s*I-o*M-l*D)*P,t[13]=(n*M-r*I+i*D)*P,t[14]=(g*x-p*S-m*v)*P,t[15]=(f*S-u*x+d*v)*P,t):null}function Kye(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],s=e[5],l=e[6],c=e[7],f=e[8],u=e[9],d=e[10],h=e[11],p=e[12],g=e[13],m=e[14],y=e[15];return t[0]=s*(d*y-h*m)-u*(l*y-c*m)+g*(l*h-c*d),t[1]=-(r*(d*y-h*m)-u*(i*y-a*m)+g*(i*h-a*d)),t[2]=r*(l*y-c*m)-s*(i*y-a*m)+g*(i*c-a*l),t[3]=-(r*(l*h-c*d)-s*(i*h-a*d)+u*(i*c-a*l)),t[4]=-(o*(d*y-h*m)-f*(l*y-c*m)+p*(l*h-c*d)),t[5]=n*(d*y-h*m)-f*(i*y-a*m)+p*(i*h-a*d),t[6]=-(n*(l*y-c*m)-o*(i*y-a*m)+p*(i*c-a*l)),t[7]=n*(l*h-c*d)-o*(i*h-a*d)+f*(i*c-a*l),t[8]=o*(u*y-h*g)-f*(s*y-c*g)+p*(s*h-c*u),t[9]=-(n*(u*y-h*g)-f*(r*y-a*g)+p*(r*h-a*u)),t[10]=n*(s*y-c*g)-o*(r*y-a*g)+p*(r*c-a*s),t[11]=-(n*(s*h-c*u)-o*(r*h-a*u)+f*(r*c-a*s)),t[12]=-(o*(u*m-d*g)-f*(s*m-l*g)+p*(s*d-l*u)),t[13]=n*(u*m-d*g)-f*(r*m-i*g)+p*(r*d-i*u),t[14]=-(n*(s*m-l*g)-o*(r*m-i*g)+p*(r*l-i*s)),t[15]=n*(s*d-l*u)-o*(r*d-i*u)+f*(r*l-i*s),t}function qye(t){var e=t[0],n=t[1],r=t[2],i=t[3],a=t[4],o=t[5],s=t[6],l=t[7],c=t[8],f=t[9],u=t[10],d=t[11],h=t[12],p=t[13],g=t[14],m=t[15],y=e*o-n*a,v=e*s-r*a,x=e*l-i*a,w=n*s-r*o,S=n*l-i*o,T=r*l-i*s,_=c*p-f*h,D=c*g-u*h,I=c*m-d*h,R=f*g-u*p,M=f*m-d*p,A=u*m-d*g;return y*A-v*M+x*R+w*I-S*D+T*_}function jn(t,e,n){var r=e[0],i=e[1],a=e[2],o=e[3],s=e[4],l=e[5],c=e[6],f=e[7],u=e[8],d=e[9],h=e[10],p=e[11],g=e[12],m=e[13],y=e[14],v=e[15],x=n[0],w=n[1],S=n[2],T=n[3];return t[0]=x*r+w*s+S*u+T*g,t[1]=x*i+w*l+S*d+T*m,t[2]=x*a+w*c+S*h+T*y,t[3]=x*o+w*f+S*p+T*v,x=n[4],w=n[5],S=n[6],T=n[7],t[4]=x*r+w*s+S*u+T*g,t[5]=x*i+w*l+S*d+T*m,t[6]=x*a+w*c+S*h+T*y,t[7]=x*o+w*f+S*p+T*v,x=n[8],w=n[9],S=n[10],T=n[11],t[8]=x*r+w*s+S*u+T*g,t[9]=x*i+w*l+S*d+T*m,t[10]=x*a+w*c+S*h+T*y,t[11]=x*o+w*f+S*p+T*v,x=n[12],w=n[13],S=n[14],T=n[15],t[12]=x*r+w*s+S*u+T*g,t[13]=x*i+w*l+S*d+T*m,t[14]=x*a+w*c+S*h+T*y,t[15]=x*o+w*f+S*p+T*v,t}function si(t,e,n){var r=n[0],i=n[1],a=n[2],o,s,l,c,f,u,d,h,p,g,m,y;return e===t?(t[12]=e[0]*r+e[4]*i+e[8]*a+e[12],t[13]=e[1]*r+e[5]*i+e[9]*a+e[13],t[14]=e[2]*r+e[6]*i+e[10]*a+e[14],t[15]=e[3]*r+e[7]*i+e[11]*a+e[15]):(o=e[0],s=e[1],l=e[2],c=e[3],f=e[4],u=e[5],d=e[6],h=e[7],p=e[8],g=e[9],m=e[10],y=e[11],t[0]=o,t[1]=s,t[2]=l,t[3]=c,t[4]=f,t[5]=u,t[6]=d,t[7]=h,t[8]=p,t[9]=g,t[10]=m,t[11]=y,t[12]=o*r+f*i+p*a+e[12],t[13]=s*r+u*i+g*a+e[13],t[14]=l*r+d*i+m*a+e[14],t[15]=c*r+h*i+y*a+e[15]),t}function p0(t,e,n){var r=n[0],i=n[1],a=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*a,t[9]=e[9]*a,t[10]=e[10]*a,t[11]=e[11]*a,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function rc(t,e,n,r){var i=r[0],a=r[1],o=r[2],s=Math.hypot(i,a,o),l,c,f,u,d,h,p,g,m,y,v,x,w,S,T,_,D,I,R,M,A,L,P,B;return s<ar?null:(s=1/s,i*=s,a*=s,o*=s,l=Math.sin(n),c=Math.cos(n),f=1-c,u=e[0],d=e[1],h=e[2],p=e[3],g=e[4],m=e[5],y=e[6],v=e[7],x=e[8],w=e[9],S=e[10],T=e[11],_=i*i*f+c,D=a*i*f+o*l,I=o*i*f-a*l,R=i*a*f-o*l,M=a*a*f+c,A=o*a*f+i*l,L=i*o*f+a*l,P=a*o*f-i*l,B=o*o*f+c,t[0]=u*_+g*D+x*I,t[1]=d*_+m*D+w*I,t[2]=h*_+y*D+S*I,t[3]=p*_+v*D+T*I,t[4]=u*R+g*M+x*A,t[5]=d*R+m*M+w*A,t[6]=h*R+y*M+S*A,t[7]=p*R+v*M+T*A,t[8]=u*L+g*P+x*B,t[9]=d*L+m*P+w*B,t[10]=h*L+y*P+S*B,t[11]=p*L+v*P+T*B,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function J9(t,e,n){var r=Math.sin(n),i=Math.cos(n),a=e[4],o=e[5],s=e[6],l=e[7],c=e[8],f=e[9],u=e[10],d=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=a*i+c*r,t[5]=o*i+f*r,t[6]=s*i+u*r,t[7]=l*i+d*r,t[8]=c*i-a*r,t[9]=f*i-o*r,t[10]=u*i-s*r,t[11]=d*i-l*r,t}function Z9(t,e,n){var r=Math.sin(n),i=Math.cos(n),a=e[0],o=e[1],s=e[2],l=e[3],c=e[8],f=e[9],u=e[10],d=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*i-c*r,t[1]=o*i-f*r,t[2]=s*i-u*r,t[3]=l*i-d*r,t[8]=a*r+c*i,t[9]=o*r+f*i,t[10]=s*r+u*i,t[11]=l*r+d*i,t}function Q9(t,e,n){var r=Math.sin(n),i=Math.cos(n),a=e[0],o=e[1],s=e[2],l=e[3],c=e[4],f=e[5],u=e[6],d=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*i+c*r,t[1]=o*i+f*r,t[2]=s*i+u*r,t[3]=l*i+d*r,t[4]=c*i-a*r,t[5]=f*i-o*r,t[6]=u*i-s*r,t[7]=d*i-l*r,t}function eD(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function tD(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function mK(t,e,n){var r=n[0],i=n[1],a=n[2],o=Math.hypot(r,i,a),s,l,c;return o<ar?null:(o=1/o,r*=o,i*=o,a*=o,s=Math.sin(e),l=Math.cos(e),c=1-l,t[0]=r*r*c+l,t[1]=i*r*c+a*s,t[2]=a*r*c-i*s,t[3]=0,t[4]=r*i*c-a*s,t[5]=i*i*c+l,t[6]=a*i*c+r*s,t[7]=0,t[8]=r*a*c+i*s,t[9]=i*a*c-r*s,t[10]=a*a*c+l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function Xye(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Yye(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Jye(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function vK(t,e,n){var r=e[0],i=e[1],a=e[2],o=e[3],s=r+r,l=i+i,c=a+a,f=r*s,u=r*l,d=r*c,h=i*l,p=i*c,g=a*c,m=o*s,y=o*l,v=o*c;return t[0]=1-(h+g),t[1]=u+v,t[2]=d-y,t[3]=0,t[4]=u-v,t[5]=1-(f+g),t[6]=p+m,t[7]=0,t[8]=d+y,t[9]=p-m,t[10]=1-(f+h),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function Zye(t,e){var n=new Ha(3),r=-e[0],i=-e[1],a=-e[2],o=e[3],s=e[4],l=e[5],c=e[6],f=e[7],u=r*r+i*i+a*a+o*o;return u>0?(n[0]=(s*o+f*r+l*a-c*i)*2/u,n[1]=(l*o+f*i+c*r-s*a)*2/u,n[2]=(c*o+f*a+s*i-l*r)*2/u):(n[0]=(s*o+f*r+l*a-c*i)*2,n[1]=(l*o+f*i+c*r-s*a)*2,n[2]=(c*o+f*a+s*i-l*r)*2),vK(t,e,n),t}function Qye(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function yK(t,e){var n=e[0],r=e[1],i=e[2],a=e[4],o=e[5],s=e[6],l=e[8],c=e[9],f=e[10];return t[0]=Math.hypot(n,r,i),t[1]=Math.hypot(a,o,s),t[2]=Math.hypot(l,c,f),t}function b6(t,e){var n=new Ha(3);yK(n,e);var r=1/n[0],i=1/n[1],a=1/n[2],o=e[0]*r,s=e[1]*i,l=e[2]*a,c=e[4]*r,f=e[5]*i,u=e[6]*a,d=e[8]*r,h=e[9]*i,p=e[10]*a,g=o+f+p,m=0;return g>0?(m=Math.sqrt(g+1)*2,t[3]=.25*m,t[0]=(u-h)/m,t[1]=(d-l)/m,t[2]=(s-c)/m):o>f&&o>p?(m=Math.sqrt(1+o-f-p)*2,t[3]=(u-h)/m,t[0]=.25*m,t[1]=(s+c)/m,t[2]=(d+l)/m):f>p?(m=Math.sqrt(1+f-o-p)*2,t[3]=(d-l)/m,t[0]=(s+c)/m,t[1]=.25*m,t[2]=(u+h)/m):(m=Math.sqrt(1+p-o-f)*2,t[3]=(s-c)/m,t[0]=(d+l)/m,t[1]=(u+h)/m,t[2]=.25*m),t}function xK(t,e,n,r){var i=e[0],a=e[1],o=e[2],s=e[3],l=i+i,c=a+a,f=o+o,u=i*l,d=i*c,h=i*f,p=a*c,g=a*f,m=o*f,y=s*l,v=s*c,x=s*f,w=r[0],S=r[1],T=r[2];return t[0]=(1-(p+m))*w,t[1]=(d+x)*w,t[2]=(h-v)*w,t[3]=0,t[4]=(d-x)*S,t[5]=(1-(u+m))*S,t[6]=(g+y)*S,t[7]=0,t[8]=(h+v)*T,t[9]=(g-y)*T,t[10]=(1-(u+p))*T,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function e5e(t,e,n,r,i){var a=e[0],o=e[1],s=e[2],l=e[3],c=a+a,f=o+o,u=s+s,d=a*c,h=a*f,p=a*u,g=o*f,m=o*u,y=s*u,v=l*c,x=l*f,w=l*u,S=r[0],T=r[1],_=r[2],D=i[0],I=i[1],R=i[2],M=(1-(g+y))*S,A=(h+w)*S,L=(p-x)*S,P=(h-w)*T,B=(1-(d+y))*T,U=(m+v)*T,G=(p+x)*_,F=(m-v)*_,$=(1-(d+g))*_;return t[0]=M,t[1]=A,t[2]=L,t[3]=0,t[4]=P,t[5]=B,t[6]=U,t[7]=0,t[8]=G,t[9]=F,t[10]=$,t[11]=0,t[12]=n[0]+D-(M*D+P*I+G*R),t[13]=n[1]+I-(A*D+B*I+F*R),t[14]=n[2]+R-(L*D+U*I+$*R),t[15]=1,t}function f3(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],o=n+n,s=r+r,l=i+i,c=n*o,f=r*o,u=r*s,d=i*o,h=i*s,p=i*l,g=a*o,m=a*s,y=a*l;return t[0]=1-u-p,t[1]=f+y,t[2]=d-m,t[3]=0,t[4]=f-y,t[5]=1-c-p,t[6]=h+g,t[7]=0,t[8]=d+m,t[9]=h-g,t[10]=1-c-u,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function t5e(t,e,n,r,i,a,o){var s=1/(n-e),l=1/(i-r),c=1/(a-o);return t[0]=a*2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a*2*l,t[6]=0,t[7]=0,t[8]=(n+e)*s,t[9]=(i+r)*l,t[10]=(o+a)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*a*2*c,t[15]=0,t}function bK(t,e,n,r,i){var a=1/Math.tan(e/2),o;return t[0]=a/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,i!=null&&i!==1/0?(o=1/(r-i),t[10]=(i+r)*o,t[14]=2*i*r*o):(t[10]=-1,t[14]=-2*r),t}var n5e=bK;function r5e(t,e,n,r,i){var a=1/Math.tan(e/2),o;return t[0]=a/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,i!=null&&i!==1/0?(o=1/(r-i),t[10]=i*o,t[14]=i*r*o):(t[10]=-1,t[14]=-r),t}function i5e(t,e,n,r){var i=Math.tan(e.upDegrees*Math.PI/180),a=Math.tan(e.downDegrees*Math.PI/180),o=Math.tan(e.leftDegrees*Math.PI/180),s=Math.tan(e.rightDegrees*Math.PI/180),l=2/(o+s),c=2/(i+a);return t[0]=l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=-((o-s)*l*.5),t[9]=(i-a)*c*.5,t[10]=r/(n-r),t[11]=-1,t[12]=0,t[13]=0,t[14]=r*n/(n-r),t[15]=0,t}function wK(t,e,n,r,i,a,o){var s=1/(e-n),l=1/(r-i),c=1/(a-o);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+n)*s,t[13]=(i+r)*l,t[14]=(o+a)*c,t[15]=1,t}var CK=wK;function a5e(t,e,n,r,i,a,o){var s=1/(e-n),l=1/(r-i),c=1/(a-o);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=c,t[11]=0,t[12]=(e+n)*s,t[13]=(i+r)*l,t[14]=a*c,t[15]=1,t}function SK(t,e,n,r){var i,a,o,s,l,c,f,u,d,h,p=e[0],g=e[1],m=e[2],y=r[0],v=r[1],x=r[2],w=n[0],S=n[1],T=n[2];return Math.abs(p-w)<ar&&Math.abs(g-S)<ar&&Math.abs(m-T)<ar?sn(t):(f=p-w,u=g-S,d=m-T,h=1/Math.hypot(f,u,d),f*=h,u*=h,d*=h,i=v*d-x*u,a=x*f-y*d,o=y*u-v*f,h=Math.hypot(i,a,o),h?(h=1/h,i*=h,a*=h,o*=h):(i=0,a=0,o=0),s=u*o-d*a,l=d*i-f*o,c=f*a-u*i,h=Math.hypot(s,l,c),h?(h=1/h,s*=h,l*=h,c*=h):(s=0,l=0,c=0),t[0]=i,t[1]=s,t[2]=f,t[3]=0,t[4]=a,t[5]=l,t[6]=u,t[7]=0,t[8]=o,t[9]=c,t[10]=d,t[11]=0,t[12]=-(i*p+a*g+o*m),t[13]=-(s*p+l*g+c*m),t[14]=-(f*p+u*g+d*m),t[15]=1,t)}function o5e(t,e,n,r){var i=e[0],a=e[1],o=e[2],s=r[0],l=r[1],c=r[2],f=i-n[0],u=a-n[1],d=o-n[2],h=f*f+u*u+d*d;h>0&&(h=1/Math.sqrt(h),f*=h,u*=h,d*=h);var p=l*d-c*u,g=c*f-s*d,m=s*u-l*f;return h=p*p+g*g+m*m,h>0&&(h=1/Math.sqrt(h),p*=h,g*=h,m*=h),t[0]=p,t[1]=g,t[2]=m,t[3]=0,t[4]=u*m-d*g,t[5]=d*p-f*m,t[6]=f*g-u*p,t[7]=0,t[8]=f,t[9]=u,t[10]=d,t[11]=0,t[12]=i,t[13]=a,t[14]=o,t[15]=1,t}function s5e(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function l5e(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}function c5e(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t}function TK(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t}function u5e(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t}function f5e(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t[9]=e[9]+n[9]*r,t[10]=e[10]+n[10]*r,t[11]=e[11]+n[11]*r,t[12]=e[12]+n[12]*r,t[13]=e[13]+n[13]*r,t[14]=e[14]+n[14]*r,t[15]=e[15]+n[15]*r,t}function d5e(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function h5e(t,e){var n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],s=t[5],l=t[6],c=t[7],f=t[8],u=t[9],d=t[10],h=t[11],p=t[12],g=t[13],m=t[14],y=t[15],v=e[0],x=e[1],w=e[2],S=e[3],T=e[4],_=e[5],D=e[6],I=e[7],R=e[8],M=e[9],A=e[10],L=e[11],P=e[12],B=e[13],U=e[14],G=e[15];return Math.abs(n-v)<=ar*Math.max(1,Math.abs(n),Math.abs(v))&&Math.abs(r-x)<=ar*Math.max(1,Math.abs(r),Math.abs(x))&&Math.abs(i-w)<=ar*Math.max(1,Math.abs(i),Math.abs(w))&&Math.abs(a-S)<=ar*Math.max(1,Math.abs(a),Math.abs(S))&&Math.abs(o-T)<=ar*Math.max(1,Math.abs(o),Math.abs(T))&&Math.abs(s-_)<=ar*Math.max(1,Math.abs(s),Math.abs(_))&&Math.abs(l-D)<=ar*Math.max(1,Math.abs(l),Math.abs(D))&&Math.abs(c-I)<=ar*Math.max(1,Math.abs(c),Math.abs(I))&&Math.abs(f-R)<=ar*Math.max(1,Math.abs(f),Math.abs(R))&&Math.abs(u-M)<=ar*Math.max(1,Math.abs(u),Math.abs(M))&&Math.abs(d-A)<=ar*Math.max(1,Math.abs(d),Math.abs(A))&&Math.abs(h-L)<=ar*Math.max(1,Math.abs(h),Math.abs(L))&&Math.abs(p-P)<=ar*Math.max(1,Math.abs(p),Math.abs(P))&&Math.abs(g-B)<=ar*Math.max(1,Math.abs(g),Math.abs(B))&&Math.abs(m-U)<=ar*Math.max(1,Math.abs(m),Math.abs(U))&&Math.abs(y-G)<=ar*Math.max(1,Math.abs(y),Math.abs(G))}var d3=jn,p5e=TK;const x2=Object.freeze(Object.defineProperty({__proto__:null,add:c5e,adjoint:Kye,clone:zye,copy:Ei,create:Y9,determinant:qye,equals:h5e,exactEquals:d5e,frob:l5e,fromQuat:f3,fromQuat2:Zye,fromRotation:mK,fromRotationTranslation:vK,fromRotationTranslationScale:xK,fromRotationTranslationScaleOrigin:e5e,fromScaling:tD,fromTranslation:eD,fromValues:Wye,fromXRotation:Xye,fromYRotation:Yye,fromZRotation:Jye,frustum:t5e,getRotation:b6,getScaling:yK,getTranslation:Qye,identity:sn,invert:ba,lookAt:SK,mul:d3,multiply:jn,multiplyScalar:u5e,multiplyScalarAndAdd:f5e,ortho:CK,orthoNO:wK,orthoZO:a5e,perspective:n5e,perspectiveFromFieldOfView:i5e,perspectiveNO:bK,perspectiveZO:r5e,rotate:rc,rotateX:J9,rotateY:Z9,rotateZ:Q9,scale:p0,set:Hye,str:s5e,sub:p5e,subtract:TK,targetTo:o5e,translate:si,transpose:Gn},Symbol.toStringTag,{value:"Module"}));function EK(){var t=new Ha(3);return Ha!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function jg(t){var e=t[0],n=t[1],r=t[2];return Math.hypot(e,n,r)}function pL(t,e,n){var r=new Ha(3);return r[0]=t,r[1]=e,r[2]=n,r}function Lr(t,e,n,r){return t[0]=e,t[1]=n,t[2]=r,t}function vv(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function Yd(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function g5e(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function m5e(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t}function sf(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function _K(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function mc(t,e){var n=e[0],r=e[1],i=e[2],a=n*n+r*r+i*i;return a>0&&(a=1/Math.sqrt(a)),t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a,t}function b2(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function zg(t,e,n){var r=e[0],i=e[1],a=e[2],o=n[0],s=n[1],l=n[2];return t[0]=i*l-a*s,t[1]=a*o-r*l,t[2]=r*s-i*o,t}function $n(t,e,n){var r=e[0],i=e[1],a=e[2],o=n[3]*r+n[7]*i+n[11]*a+n[15];return o=o||1,t[0]=(n[0]*r+n[4]*i+n[8]*a+n[12])/o,t[1]=(n[1]*r+n[5]*i+n[9]*a+n[13])/o,t[2]=(n[2]*r+n[6]*i+n[10]*a+n[14])/o,t}function ub(t,e,n){var r=e[0],i=e[1],a=e[2];return t[0]=r*n[0]+i*n[3]+a*n[6],t[1]=r*n[1]+i*n[4]+a*n[7],t[2]=r*n[2]+i*n[5]+a*n[8],t}function v5e(t){return t[0]=0,t[1]=0,t[2]=0,t}function gL(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function mL(t,e){var n=t[0],r=t[1],i=t[2],a=e[0],o=e[1],s=e[2];return Math.abs(n-a)<=ar*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(r-o)<=ar*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(i-s)<=ar*Math.max(1,Math.abs(i),Math.abs(s))}var w6=Yd,y5e=g5e,DK=jg;(function(){var t=EK();return function(e,n,r,i,a,o){var s,l;for(n||(n=3),r||(r=0),i?l=Math.min(i*n+r,e.length):l=e.length,s=r;s<l;s+=n)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],a(t,t,o),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2];return e}})();function x5e(){var t=new Ha(4);return Ha!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function b5e(t,e,n,r){var i=new Ha(4);return i[0]=t,i[1]=e,i[2]=n,i[3]=r,i}function vL(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t}function w5e(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],o=n*n+r*r+i*i+a*a;return o>0&&(o=1/Math.sqrt(o)),t[0]=n*o,t[1]=r*o,t[2]=i*o,t[3]=a*o,t}function Oh(t,e,n){var r=e[0],i=e[1],a=e[2],o=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*a+n[12]*o,t[1]=n[1]*r+n[5]*i+n[9]*a+n[13]*o,t[2]=n[2]*r+n[6]*i+n[10]*a+n[14]*o,t[3]=n[3]*r+n[7]*i+n[11]*a+n[15]*o,t}(function(){var t=x5e();return function(e,n,r,i,a,o){var s,l;for(n||(n=4),r||(r=0),i?l=Math.min(i*n+r,e.length):l=e.length,s=r;s<l;s+=n)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],t[3]=e[s+3],a(t,t,o),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2],e[s+3]=t[3];return e}})();function Jh(){var t=new Ha(4);return Ha!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function nD(t,e,n){n=n*.5;var r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t}function C5e(t,e){var n=Math.acos(e[3])*2,r=Math.sin(n/2);return r>ar?(t[0]=e[0]/r,t[1]=e[1]/r,t[2]=e[2]/r):(t[0]=1,t[1]=0,t[2]=0),n}function yL(t,e,n){var r=e[0],i=e[1],a=e[2],o=e[3],s=n[0],l=n[1],c=n[2],f=n[3];return t[0]=r*f+o*s+i*c-a*l,t[1]=i*f+o*l+a*s-r*c,t[2]=a*f+o*c+r*l-i*s,t[3]=o*f-r*s-i*l-a*c,t}function fb(t,e,n,r){var i=e[0],a=e[1],o=e[2],s=e[3],l=n[0],c=n[1],f=n[2],u=n[3],d,h,p,g,m;return h=i*l+a*c+o*f+s*u,h<0&&(h=-h,l=-l,c=-c,f=-f,u=-u),1-h>ar?(d=Math.acos(h),p=Math.sin(d),g=Math.sin((1-r)*d)/p,m=Math.sin(r*d)/p):(g=1-r,m=r),t[0]=g*i+m*l,t[1]=g*a+m*c,t[2]=g*o+m*f,t[3]=g*s+m*u,t}function S5e(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function T5e(t,e){var n=e[0]+e[4]+e[8],r;if(n>0)r=Math.sqrt(n+1),t[3]=.5*r,r=.5/r,t[0]=(e[5]-e[7])*r,t[1]=(e[6]-e[2])*r,t[2]=(e[1]-e[3])*r;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[i*3+i]&&(i=2);var a=(i+1)%3,o=(i+2)%3;r=Math.sqrt(e[i*3+i]-e[a*3+a]-e[o*3+o]+1),t[i]=.5*r,r=.5/r,t[3]=(e[a*3+o]-e[o*3+a])*r,t[a]=(e[a*3+i]+e[i*3+a])*r,t[o]=(e[o*3+i]+e[i*3+o])*r}return t}var xL=b5e,OK=w5e;(function(){var t=EK(),e=pL(1,0,0),n=pL(0,1,0);return function(r,i,a){var o=b2(i,a);return o<-.999999?(zg(t,e,i),DK(t)<1e-6&&zg(t,n,i),mc(t,t),nD(r,t,Math.PI),r):o>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(zg(t,i,a),r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=1+o,OK(r,r))}})();(function(){var t=Jh(),e=Jh();return function(n,r,i,a,o,s){return fb(t,r,o,s),fb(e,i,a,s),fb(n,t,e,2*s*(1-s)),n}})();(function(){var t=q9();return function(e,n,r,i){return t[0]=r[0],t[3]=r[1],t[6]=r[2],t[1]=i[0],t[4]=i[1],t[7]=i[2],t[2]=-n[0],t[5]=-n[1],t[8]=-n[2],OK(e,T5e(e,t))}})();function E5e(t,e){e.classHierarchy.push("vtkImplicitFunction"),t.functionValue=n=>{if(!e.transform)return t.evaluateFunction(n);const r=[];return e.transform.transformPoint(n,r),t.evaluateFunction(r)},t.evaluateFunction=n=>{le.vtkErrorMacro("not implemented")}}const _5e={};function MK(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,_5e,n),le.obj(t,e),le.setGet(t,e,["transform"]),E5e(t,e)}const D5e=le.newInstance(MK,"vtkImplicitFunction");var O5e={newInstance:D5e,extend:MK};const C6=1e-6,IK="coincide",RK="disjoint";function M5e(t,e,n){return t[0]*(n[0]-e[0])+t[1]*(n[1]-e[1])+t[2]*(n[2]-e[2])}function AK(t,e,n){const r=n[0]*(t[0]-e[0])+n[1]*(t[1]-e[1])+n[2]*(t[2]-e[2]);return Math.abs(r)}function PK(t,e,n,r){const i=[];Tf(t,e,i);const a=An(n,i);r[0]=t[0]-a*n[0],r[1]=t[1]-a*n[1],r[2]=t[2]-a*n[2]}function NK(t,e,n){const r=An(t,e);let i=An(e,e);return i===0&&(i=1),n[0]=t[0]-r*e[0]/i,n[1]=t[1]-r*e[1]/i,n[2]=t[2]-r*e[2]/i,n}function LK(t,e,n,r){const i=[];Tf(t,e,i);const a=An(n,i),o=An(n,n);o!==0?(r[0]=t[0]-a*n[0]/o,r[1]=t[1]-a*n[1]/o,r[2]=t[2]-a*n[2]/o):(r[0]=t[0],r[1]=t[1],r[2]=t[2])}function kK(t,e,n,r){const i={intersection:!1,betweenPoints:!1,t:Number.MAX_VALUE,x:[]},a=[],o=[];Tf(e,t,a),Tf(n,t,o);const s=An(r,o),l=An(r,a);let c,f;return l<0?c=-l:c=l,s<0?f=-s*C6:f=s*C6,c<=f||(i.t=s/l,i.x[0]=t[0]+i.t*a[0],i.x[1]=t[1]+i.t*a[1],i.x[2]=t[2]+i.t*a[2],i.intersection=!0,i.betweenPoints=i.t>=0&&i.t<=1),i}function VK(t,e,n,r){const i={intersection:!1,l0:[],l1:[],error:null},a=[];gu(e,r,a);const o=a.map(u=>Math.abs(u));if(o[0]+o[1]+o[2]<C6){const u=[];return Tf(t,n,u),An(e,u)===0?i.error=IK:i.error=RK,i}let s;o[0]>o[1]&&o[0]>o[2]?s="x":o[1]>o[2]?s="y":s="z";const l=[],c=-An(e,t),f=-An(r,n);switch(s){case"x":l[0]=0,l[1]=(f*e[2]-c*r[2])/a[0],l[2]=(c*r[1]-f*e[1])/a[0];break;case"y":l[0]=(c*r[2]-f*e[2])/a[1],l[1]=0,l[2]=(f*e[0]-c*r[0])/a[1];break;case"z":l[0]=(f*e[1]-c*r[1])/a[2],l[1]=(c*r[0]-f*e[0])/a[2],l[2]=0;break}return i.l0=l,a3(l,a,i.l1),i.intersection=!0,i}const I5e={evaluate:M5e,distanceToPlane:AK,projectPoint:PK,projectVector:NK,generalizedProjectPoint:LK,intersectWithLine:kK,intersectWithPlane:VK,DISJOINT:RK,COINCIDE:IK};function R5e(t,e){e.classHierarchy.push("vtkPlane"),t.distanceToPlane=n=>AK(n,e.origin,e.normal),t.projectPoint=(n,r)=>{PK(n,e.origin,e.normal,r)},t.projectVector=(n,r)=>NK(n,e.normal,r),t.push=n=>{if(n!==0)for(let r=0;r<3;r++)e.origin[r]+=n*e.normal[r]},t.generalizedProjectPoint=(n,r)=>{LK(n,e.origin,e.normal,r)},t.evaluateFunction=(n,r,i)=>Array.isArray(n)?e.normal[0]*(n[0]-e.origin[0])+e.normal[1]*(n[1]-e.origin[1])+e.normal[2]*(n[2]-e.origin[2]):e.normal[0]*(n-e.origin[0])+e.normal[1]*(r-e.origin[1])+e.normal[2]*(i-e.origin[2]),t.evaluateGradient=n=>[e.normal[0],e.normal[1],e.normal[2]],t.intersectWithLine=(n,r)=>kK(n,r,e.origin,e.normal),t.intersectWithPlane=(n,r)=>VK(n,r,e.origin,e.normal)}const A5e={normal:[0,0,1],origin:[0,0,0]};function FK(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,A5e,n),O5e.extend(t,e,n),le.setGetArray(t,e,["normal","origin"],3),R5e(t,e)}const P5e=le.newInstance(FK,"vtkPlane");var Do={newInstance:P5e,extend:FK,...I5e};const Hw=[Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE];function UK(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]}function kf(t){return t?.length>=6&&t[0]<=t[1]&&t[2]<=t[3]&&t[4]<=t[5]}function rD(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function iD(t){return rD(t,Hw)}function h3(t,e,n,r){const[i,a,o,s,l,c]=t;return t[0]=i<e?i:e,t[1]=a>e?a:e,t[2]=o<n?o:n,t[3]=s>n?s:n,t[4]=l<r?l:r,t[5]=c>r?c:r,t}function aD(t,e){if(e.length===0)return t;if(Array.isArray(e[0]))for(let n=0;n<e.length;++n)h3(t,...e[n]);else for(let n=0;n<e.length;n+=3)h3(t,...e.slice(n,n+3));return t}function BK(t,e,n,r,i,a,o){const[s,l,c,f,u,d]=t;return o===void 0?(t[0]=Math.min(e[0],s),t[1]=Math.max(e[1],l),t[2]=Math.min(e[2],c),t[3]=Math.max(e[3],f),t[4]=Math.min(e[4],u),t[5]=Math.max(e[5],d)):(t[0]=Math.min(e,s),t[1]=Math.max(n,l),t[2]=Math.min(r,c),t[3]=Math.max(i,f),t[4]=Math.min(a,u),t[5]=Math.max(o,d)),t}function $K(t,e,n,r){const[i,a,o,s,l,c]=t;return t[0]=e,t[1]=e>a?e:a,t[2]=n,t[3]=n>s?n:s,t[4]=r,t[5]=r>c?r:c,i!==e||o!==n||l!==r}function GK(t,e,n,r){const[i,a,o,s,l,c]=t;return t[0]=e<i?e:i,t[1]=e,t[2]=n<o?n:o,t[3]=n,t[4]=r<l?r:l,t[5]=r,a!==e||s!==n||c!==r}function jK(t,e){return t[0]-=e,t[1]+=e,t[2]-=e,t[3]+=e,t[4]-=e,t[5]+=e,t}function oD(t,e,n,r){return kf(t)?(e>=0?(t[0]*=e,t[1]*=e):(t[0]=e*t[1],t[1]=e*t[0]),n>=0?(t[2]*=n,t[3]*=n):(t[2]=n*t[3],t[3]=n*t[2]),r>=0?(t[4]*=r,t[5]*=r):(t[4]=r*t[5],t[5]=r*t[4]),!0):!1}function sD(t){return[.5*(t[0]+t[1]),.5*(t[2]+t[3]),.5*(t[4]+t[5])]}function N5e(t,e,n,r){if(!kf(t))return!1;const i=sD(t);return t[0]-=i[0],t[1]-=i[0],t[2]-=i[1],t[3]-=i[1],t[4]-=i[2],t[5]-=i[2],oD(t,e,n,r),t[0]+=i[0],t[1]+=i[0],t[2]+=i[1],t[3]+=i[1],t[4]+=i[2],t[5]+=i[2],!0}function kv(t,e){return t[e*2+1]-t[e*2]}function Kw(t){return[kv(t,0),kv(t,1),kv(t,2)]}function zK(t){return t.slice(0,2)}function WK(t){return t.slice(2,4)}function HK(t){return t.slice(4,6)}function KK(t){const e=Kw(t);return e[0]>e[1]?e[0]>e[2]?e[0]:e[2]:e[1]>e[2]?e[1]:e[2]}function qK(t){if(kf(t)){const e=Kw(t);return Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2])}return null}function lD(t){return[t[0],t[2],t[4]]}function cD(t){return[t[1],t[3],t[5]]}function Z5(t,e){return t<=0&&e>=0||t>=0&&e<=0}function uD(t,e){let n=0;for(let r=0;r<2;r++)for(let i=2;i<4;i++)for(let a=4;a<6;a++)e[n++]=[t[r],t[i],t[a]];return e}function XK(t,e,n){return e[0]=t[0],e[1]=t[2],e[2]=t[4],n[0]=t[1],n[1]=t[3],n[2]=t[5],e}function YK(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const r=uD(t,[]);for(let i=0;i<r.length;++i)$n(r[i],r[i],e);return iD(n),aD(n,r)}function JK(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return e[0]=.5*(t[1]-t[0]),e[1]=.5*(t[3]-t[2]),e[2]=.5*(t[5]-t[4]),e}function ZK(t,e,n,r){const i=[].concat(Hw),a=t.getData();for(let o=0;o<a.length;o+=3){const s=[a[o],a[o+1],a[o+2]],l=An(s,e);i[0]=Math.min(l,i[0]),i[1]=Math.max(l,i[1]);const c=An(s,n);i[2]=Math.min(c,i[2]),i[3]=Math.max(c,i[3]);const f=An(s,r);i[4]=Math.min(f,i[4]),i[5]=Math.max(f,i[5])}return i}function QK(t,e,n,r,i){let a=!0;const o=[];let s=0;const l=[],c=[0,0,0],f=0,u=1,d=2;for(let h=0;h<3;h++)e[h]<t[2*h]?(o[h]=u,c[h]=t[2*h],a=!1):e[h]>t[2*h+1]?(o[h]=f,c[h]=t[2*h+1],a=!1):o[h]=d;if(a)return r[0]=e[0],r[1]=e[1],r[2]=e[2],i[0]=0,1;for(let h=0;h<3;h++)o[h]!==d&&n[h]!==0?l[h]=(c[h]-e[h])/n[h]:l[h]=-1;for(let h=0;h<3;h++)l[s]<l[h]&&(s=h);if(l[s]>1||l[s]<0)return 0;i[0]=l[s];for(let h=0;h<3;h++)if(s!==h){if(r[h]=e[h]+l[s]*n[h],r[h]<t[2*h]||r[h]>t[2*h+1])return 0}else r[h]=c[h];return 1}function eq(t,e,n){const r=[];let i=0,a=1,o=1;for(let s=4;s<=5;++s){r[2]=t[s];for(let l=2;l<=3;++l){r[1]=t[l];for(let c=0;c<=1;++c)if(r[0]=t[c],i=Do.evaluate(n,e,r),o&&(a=i>=0?1:-1,o=0),i===0||a>0&&i<0||a<0&&i>0)return 1}}return 0}function tq(t,e){if(!(kf(t)&&kf(e)))return!1;const n=[0,0,0,0,0,0];let r;for(let i=0;i<3;i++)if(r=!1,e[i*2]>=t[i*2]&&e[i*2]<=t[i*2+1]?(r=!0,n[i*2]=e[i*2]):t[i*2]>=e[i*2]&&t[i*2]<=e[i*2+1]&&(r=!0,n[i*2]=t[i*2]),e[i*2+1]>=t[i*2]&&e[i*2+1]<=t[i*2+1]?(r=!0,n[i*2+1]=e[2*i+1]):t[i*2+1]>=e[i*2]&&t[i*2+1]<=e[i*2+1]&&(r=!0,n[i*2+1]=t[i*2+1]),!r)return!1;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],!0}function p3(t,e){if(!(kf(t)&&kf(e)))return!1;for(let n=0;n<3;n++)if(!(e[n*2]>=t[n*2]&&e[n*2]<=t[n*2+1])&&!(t[n*2]>=e[n*2]&&t[n*2]<=e[n*2+1])&&!(e[n*2+1]>=t[n*2]&&e[n*2+1]<=t[n*2+1])&&!(t[n*2+1]>=e[n*2]&&t[n*2+1]<=e[n*2+1]))return!1;return!0}function g3(t,e,n,r){return!(e<t[0]||e>t[1]||n<t[2]||n>t[3]||r<t[4]||r>t[5])}function L5e(t,e){return!(!p3(t,e)||!g3(t,...lD(e))||!g3(t,...cD(e)))}function nq(t,e,n){const r=[[0,1,2,3,4,5,6,7],[0,1,4,5,2,3,6,7],[0,2,4,6,1,3,5,7]],i=[0,0,0,0,0,0,0,0];let a=0;for(let u=0;u<2;u++)for(let d=2;d<4;d++)for(let h=4;h<6;h++){const p=[t[u],t[d],t[h]];i[a++]=Do.evaluate(n,e,p)}let o=2;for(;o--&&!(Z5(i[r[o][0]],i[r[o][4]])&&Z5(i[r[o][1]],i[r[o][5]])&&Z5(i[r[o][2]],i[r[o][6]])&&Z5(i[r[o][3]],i[r[o][7]])););if(o<0)return!1;const s=Math.sign(n[o]),l=Math.abs((t[o*2+1]-t[o*2])*n[o]);let c=s>0?1:0;for(let u=0;u<4;u++){if(l===0)continue;const d=Math.abs(i[r[o][u]])/l;s>0&&d<c&&(c=d),s<0&&d>c&&(c=d)}const f=(1-c)*t[o*2]+c*t[o*2+1];return s>0?t[o*2]=f:t[o*2+1]=f,!0}class k5e{constructor(e){this.bounds=e,this.bounds||(this.bounds=new Float64Array(Hw))}getBounds(){return this.bounds}equals(e){return UK(this.bounds,e)}isValid(){return kf(this.bounds)}setBounds(e){return rD(this.bounds,e)}reset(){return iD(this.bounds)}addPoint(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return h3(this.bounds,...n)}addPoints(e){return aD(this.bounds,e)}addBounds(e,n,r,i,a,o){return BK(this.bounds,e,n,r,i,a,o)}setMinPoint(e,n,r){return $K(this.bounds,e,n,r)}setMaxPoint(e,n,r){return GK(this.bounds,e,n,r)}inflate(e){return jK(this.bounds,e)}scale(e,n,r){return oD(this.bounds,e,n,r)}getCenter(){return sD(this.bounds)}getLength(e){return kv(this.bounds,e)}getLengths(){return Kw(this.bounds)}getMaxLength(){return KK(this.bounds)}getDiagonalLength(){return qK(this.bounds)}getMinPoint(){return lD(this.bounds)}getMaxPoint(){return cD(this.bounds)}getXRange(){return zK(this.bounds)}getYRange(){return WK(this.bounds)}getZRange(){return HK(this.bounds)}getCorners(e){return uD(this.bounds,e)}computeCornerPoints(e,n){return XK(this.bounds,e,n)}computeLocalBounds(e,n,r){return ZK(this.bounds,e,n,r)}transformBounds(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return YK(this.bounds,e,n)}computeScale3(e){return JK(this.bounds,e)}cutWithPlane(e,n){return nq(this.bounds,e,n)}intersectBox(e,n,r,i){return QK(this.bounds,e,n,r,i)}intersectPlane(e,n){return eq(this.bounds,e,n)}intersect(e){return tq(this.bounds,e)}intersects(e){return p3(this.bounds,e)}containsPoint(e,n,r){return g3(this.bounds,e,n,r)}contains(e){return p3(this.bounds,e)}}function V5e(t){const e=t&&t.bounds;return new k5e(e)}const F5e={equals:UK,isValid:kf,setBounds:rD,reset:iD,addPoint:h3,addPoints:aD,addBounds:BK,setMinPoint:$K,setMaxPoint:GK,inflate:jK,scale:oD,scaleAboutCenter:N5e,getCenter:sD,getLength:kv,getLengths:Kw,getMaxLength:KK,getDiagonalLength:qK,getMinPoint:lD,getMaxPoint:cD,getXRange:zK,getYRange:WK,getZRange:HK,getCorners:uD,computeCornerPoints:XK,computeLocalBounds:ZK,transformBounds:YK,computeScale3:JK,cutWithPlane:nq,intersectBox:QK,intersectPlane:eq,intersect:tq,intersects:p3,containsPoint:g3,contains:L5e,INIT_BOUNDS:Hw};var wr={newInstance:V5e,...F5e};const U5e={DISPLAY:0,WORLD:1};var rq={CoordinateSystem:U5e};const{CoordinateSystem:S6}=rq;function bL(t){return()=>le.vtkErrorMacro(`vtkProp::${t} - NOT IMPLEMENTED`)}function B5e(t,e){e.classHierarchy.push("vtkProp"),t.getMTime=()=>{let n=e.mtime;for(let r=0;r<e.textures.length;++r){const i=e.textures[r].getMTime();i>n&&(n=i)}return n},t.processSelectorPixelBuffers=(n,r)=>{},t.getNestedProps=()=>null,t.getActors=()=>[],t.getActors2D=()=>[],t.getVolumes=()=>[],t.pick=bL("pick"),t.hasKey=bL("hasKey"),t.getNestedVisibility=()=>e.visibility&&(!e._parentProp||e._parentProp.getNestedVisibility()),t.getNestedPickable=()=>e.pickable&&(!e._parentProp||e._parentProp.getNestedPickable()),t.getNestedDragable=()=>e.dragable&&(!e._parentProp||e._parentProp.getNestedDragable()),t.getRedrawMTime=()=>e.mtime,t.setEstimatedRenderTime=n=>{e.estimatedRenderTime=n,e.savedEstimatedRenderTime=n},t.restoreEstimatedRenderTime=()=>{e.estimatedRenderTime=e.savedEstimatedRenderTime},t.addEstimatedRenderTime=n=>{e.estimatedRenderTime+=n},t.setAllocatedRenderTime=n=>{e.allocatedRenderTime=n,e.savedEstimatedRenderTime=e.estimatedRenderTime,e.estimatedRenderTime=0},t.getSupportsSelection=()=>!1,t.getTextures=()=>e.textures,t.hasTexture=n=>e.textures.indexOf(n)!==-1,t.addTexture=n=>{n&&!t.hasTexture(n)&&(e.textures=e.textures.concat(n),t.modified())},t.removeTexture=n=>{const r=e.textures.filter(i=>i!==n);e.textures.length!==r.length&&(e.textures=r,t.modified())},t.removeAllTextures=()=>{e.textures=[],t.modified()},t.setCoordinateSystemToWorld=()=>t.setCoordinateSystem(S6.WORLD),t.setCoordinateSystemToDisplay=()=>t.setCoordinateSystem(S6.DISPLAY)}const $5e={allocatedRenderTime:10,coordinateSystem:S6.WORLD,dragable:!0,estimatedRenderTime:0,paths:null,pickable:!0,renderTimeMultiplier:1,savedEstimatedRenderTime:0,textures:[],useBounds:!0,visibility:!0};function iq(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,$5e,n),le.obj(t,e),le.get(t,e,["estimatedRenderTime","allocatedRenderTime"]),le.setGet(t,e,["_parentProp","coordinateSystem","dragable","pickable","renderTimeMultiplier","useBounds","visibility"]),le.moveToProtected(t,e,["parentProp"]),B5e(t,e)}const G5e=le.newInstance(iq,"vtkProp");var ay={newInstance:G5e,extend:iq,...rq};const j5e=1e-6;function z5e(t,e){e.classHierarchy.push("vtkProp3D"),t.addPosition=r=>{e.position=e.position.map((i,a)=>i+r[a]),t.modified()},t.getOrientationWXYZ=()=>{const r=Jh();b6(r,e.rotation);const i=new Float64Array(3),a=C5e(i,r);return[i3(a),i[0],i[1],i[2]]},t.getOrientationQuaternion=function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return b6(r,e.rotation)},t.rotateX=r=>{r!==0&&(J9(e.rotation,e.rotation,wi(r)),t.modified())},t.rotateY=r=>{r!==0&&(Z9(e.rotation,e.rotation,wi(r)),t.modified())},t.rotateZ=r=>{r!==0&&(Q9(e.rotation,e.rotation,wi(r)),t.modified())},t.rotateWXYZ=(r,i,a,o)=>{if(r===0||i===0&&a===0&&o===0)return;const s=wi(r),l=Jh();nD(l,[i,a,o],s);const c=new Float64Array(16);f3(c,l),jn(e.rotation,e.rotation,c),t.modified()},t.rotateQuaternion=r=>{if(Math.abs(r[3])>=1-j5e)return;const i=f3(new Float64Array(16),r);jn(e.rotation,e.rotation,i),t.modified()},t.setOrientation=(r,i,a)=>r===e.orientation[0]&&i===e.orientation[1]&&a===e.orientation[2]?!1:(e.orientation=[r,i,a],sn(e.rotation),t.rotateZ(a),t.rotateX(r),t.rotateY(i),t.modified(),!0),t.setUserMatrix=r=>ty(e.userMatrix,r)?!1:(Ei(e.userMatrix,r),t.modified(),!0),t.getMatrix=()=>(t.computeMatrix(),e.matrix),t.computeMatrix=()=>{if(t.getMTime()>e.matrixMTime.getMTime()){sn(e.matrix),e.userMatrix&&jn(e.matrix,e.matrix,e.userMatrix),si(e.matrix,e.matrix,e.origin),si(e.matrix,e.matrix,e.position),jn(e.matrix,e.matrix,e.rotation),p0(e.matrix,e.matrix,e.scale),si(e.matrix,e.matrix,[-e.origin[0],-e.origin[1],-e.origin[2]]),Gn(e.matrix,e.matrix),e.isIdentity=!0;for(let r=0;r<4;++r)for(let i=0;i<4;++i)(r===i?1:0)!==e.matrix[r+i*4]&&(e.isIdentity=!1);e.matrixMTime.modified()}},t.getCenter=()=>wr.getCenter(e.bounds),t.getLength=()=>wr.getLength(e.bounds),t.getXRange=()=>wr.getXRange(e.bounds),t.getYRange=()=>wr.getYRange(e.bounds),t.getZRange=()=>wr.getZRange(e.bounds),t.getUserMatrix=()=>e.userMatrix;function n(){t.computeMatrix()}t.onModified(n)}const W5e={origin:[0,0,0],position:[0,0,0],orientation:[0,0,0],rotation:null,scale:[1,1,1],bounds:[1,-1,1,-1,1,-1],userMatrix:null,userMatrixMTime:null,cachedProp3D:null,isIdentity:!0,matrixMTime:null};function aq(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,W5e,n),ay.extend(t,e,n),e.matrixMTime={},le.obj(e.matrixMTime),le.get(t,e,["bounds","isIdentity"]),le.getArray(t,e,["orientation"]),le.setGetArray(t,e,["origin","position","scale"],3),e.matrix=sn(new Float64Array(16)),e.rotation=sn(new Float64Array(16)),e.userMatrix=sn(new Float64Array(16)),e.transform=null,z5e(t,e)}const H5e=le.newInstance(aq,"vtkProp3D");var fD={newInstance:H5e,extend:aq};const T6={NEAREST:0,LINEAR:1,FAST_LINEAR:2},oq={FRACTIONAL:0,PROPORTIONAL:1},db={CUSTOM:0,ADDITIVE:1,COLORIZE:2};var sq={InterpolationType:T6,OpacityMode:oq,ColorMixPreset:db};const{InterpolationType:yv,OpacityMode:K5e}=sq,{vtkErrorMacro:UT}=le,hb=4;function q5e(t,e){e.classHierarchy.push("vtkVolumeProperty"),t.getMTime=()=>{let i=e.mtime,a;for(let o=0;o<hb;o++)e.componentData[o].colorChannels===1?e.componentData[o].grayTransferFunction&&(a=e.componentData[o].grayTransferFunction.getMTime(),i=i>a?i:a):e.componentData[o].colorChannels===3&&e.componentData[o].rGBTransferFunction&&(a=e.componentData[o].rGBTransferFunction.getMTime(),i=i>a?i:a),e.componentData[o].scalarOpacity&&(a=e.componentData[o].scalarOpacity.getMTime(),i=i>a?i:a),e.componentData[o].gradientOpacity&&(e.componentData[o].disableGradientOpacity||(a=e.componentData[o].gradientOpacity.getMTime(),i=i>a?i:a));return i},t.getColorChannels=i=>i<0||i>3?(UT("Bad index - must be between 0 and 3"),0):e.componentData[i].colorChannels,t.setGrayTransferFunction=function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,o=!1;return e.componentData[i].grayTransferFunction!==a&&(e.componentData[i].grayTransferFunction=a,o=!0),e.componentData[i].colorChannels!==1&&(e.componentData[i].colorChannels=1,o=!0),o&&t.modified(),o},t.getGrayTransferFunction=function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return e.componentData[i].grayTransferFunction===null&&(e.componentData[i].grayTransferFunction=Xh.newInstance(),e.componentData[i].grayTransferFunction.addPoint(0,0),e.componentData[i].grayTransferFunction.addPoint(1024,1),e.componentData[i].colorChannels!==1&&(e.componentData[i].colorChannels=1),t.modified()),e.componentData[i].grayTransferFunction},t.setRGBTransferFunction=function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,o=!1;return e.componentData[i].rGBTransferFunction!==a&&(e.componentData[i].rGBTransferFunction=a,o=!0),e.componentData[i].colorChannels!==3&&(e.componentData[i].colorChannels=3,o=!0),o&&t.modified(),o},t.getRGBTransferFunction=function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return e.componentData[i].rGBTransferFunction===null&&(e.componentData[i].rGBTransferFunction=Lf.newInstance(),e.componentData[i].rGBTransferFunction.addRGBPoint(0,0,0,0),e.componentData[i].rGBTransferFunction.addRGBPoint(1024,1,1,1),e.componentData[i].colorChannels!==3&&(e.componentData[i].colorChannels=3),t.modified()),e.componentData[i].rGBTransferFunction},t.setScalarOpacity=function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return e.componentData[i].scalarOpacity!==a?(e.componentData[i].scalarOpacity=a,t.modified(),!0):!1},t.getScalarOpacity=function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return e.componentData[i].scalarOpacity===null&&(e.componentData[i].scalarOpacity=Xh.newInstance(),e.componentData[i].scalarOpacity.addPoint(0,1),e.componentData[i].scalarOpacity.addPoint(1024,1),t.modified()),e.componentData[i].scalarOpacity},t.setComponentWeight=function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;if(i<0||i>=hb)return UT("Invalid index"),!1;const o=Math.min(1,Math.max(0,a));return e.componentData[i].componentWeight!==o?(e.componentData[i].componentWeight=o,t.modified(),!0):!1},t.getComponentWeight=function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return i<0||i>=hb?(UT("Invalid index"),0):e.componentData[i].componentWeight},t.setInterpolationTypeToNearest=()=>t.setInterpolationType(yv.NEAREST),t.setInterpolationTypeToLinear=()=>t.setInterpolationType(yv.LINEAR),t.setInterpolationTypeToFastLinear=()=>t.setInterpolationType(yv.FAST_LINEAR),t.getInterpolationTypeAsString=()=>le.enumToString(yv,e.interpolationType),["useGradientOpacity","scalarOpacityUnitDistance","gradientOpacityMinimumValue","gradientOpacityMinimumOpacity","gradientOpacityMaximumValue","gradientOpacityMaximumOpacity","opacityMode","forceNearestInterpolation"].forEach(i=>{const a=le.capitalize(i);t[`set${a}`]=(o,s)=>e.componentData[o][`${i}`]!==s?(e.componentData[o][`${i}`]=s,t.modified(),!0):!1}),["useGradientOpacity","scalarOpacityUnitDistance","gradientOpacityMinimumValue","gradientOpacityMinimumOpacity","gradientOpacityMaximumValue","gradientOpacityMaximumOpacity","opacityMode","forceNearestInterpolation"].forEach(i=>{const a=le.capitalize(i);t[`get${a}`]=o=>e.componentData[o][`${i}`]})}const X5e={colorMixPreset:null,independentComponents:!0,interpolationType:yv.FAST_LINEAR,shade:!1,ambient:.1,diffuse:.7,specular:.2,specularPower:10,useLabelOutline:!1,labelOutlineThickness:[1],labelOutlineOpacity:1};function Y5e(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(Object.assign(e,X5e,n),le.obj(t,e),!e.componentData){e.componentData=[];for(let r=0;r<hb;++r)e.componentData.push({colorChannels:1,grayTransferFunction:null,rGBTransferFunction:null,scalarOpacity:null,scalarOpacityUnitDistance:1,opacityMode:K5e.FRACTIONAL,gradientOpacityMinimumValue:0,gradientOpacityMinimumOpacity:0,gradientOpacityMaximumValue:1,gradientOpacityMaximumOpacity:1,useGradientOpacity:!1,componentWeight:1,forceNearestInterpolation:!1})}le.setGet(t,e,["colorMixPreset","independentComponents","interpolationType","shade","ambient","diffuse","specular","specularPower","useLabelOutline","labelOutlineOpacity"]),le.setGetArray(t,e,["labelOutlineThickness"]),q5e(t,e)}const J5e=le.newInstance(Y5e,"vtkVolumeProperty");var Z5e={newInstance:J5e,...sq};const{vtkDebugMacro:Q5e}=le;function exe(t,e){e.classHierarchy.push("vtkVolume"),t.getVolumes=()=>t,t.makeProperty=Z5e.newInstance,t.getProperty=()=>(e.property===null&&(e.property=t.makeProperty()),e.property),t.getBounds=()=>{if(e.mapper===null)return e.bounds;const n=e.mapper.getBounds();if(!n||n.length!==6)return n;if(n[0]>n[1])return e.mapperBounds=n.concat(),e.bounds=[1,-1,1,-1,1,-1],e.boundsMTime.modified(),n;const r=i=>i[0].map((a,o)=>i.map(s=>s[o]));if(!e.mapperBounds||!r([n,e.mapperBounds]).reduce((i,a)=>i&&a[0]===a[1],!0)||t.getMTime()>e.boundsMTime.getMTime()){Q5e("Recomputing bounds..."),e.mapperBounds=n.map(o=>o);const i=[];wr.getCorners(n,i),t.computeMatrix();const a=new Float64Array(16);Gn(a,e.matrix),i.forEach(o=>$n(o,o,a)),e.bounds[0]=e.bounds[2]=e.bounds[4]=Number.MAX_VALUE,e.bounds[1]=e.bounds[3]=e.bounds[5]=-Number.MAX_VALUE,e.bounds=e.bounds.map((o,s)=>s%2===0?i.reduce((l,c)=>l>c[s/2]?c[s/2]:l,o):i.reduce((l,c)=>l<c[(s-1)/2]?c[(s-1)/2]:l,o)),e.boundsMTime.modified()}return e.bounds},t.getMTime=()=>{let n=e.mtime;if(e.property!==null){const r=e.property.getMTime();n=r>n?r:n}return n},t.getRedrawMTime=()=>{let n=e.mtime;if(e.mapper!==null){let r=e.mapper.getMTime();n=r>n?r:n,e.mapper.getInput()!==null&&(e.mapper.getInputAlgorithm().update(),r=e.mapper.getInput().getMTime(),n=r>n?r:n)}return n}}const txe={mapper:null,property:null,bounds:[1,-1,1,-1,1,-1]};function lq(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,txe,n),fD.extend(t,e,n),e.boundsMTime={},le.obj(e.boundsMTime),le.set(t,e,["property"]),le.setGet(t,e,["mapper"]),le.getArray(t,e,["bounds"],6),exe(t,e)}const nxe=le.newInstance(lq,"vtkVolume");var rxe={newInstance:nxe,extend:lq};const{vtkErrorMacro:ixe}=le,axe=["Build","Render"];function oxe(t,e){e.classHierarchy.push("vtkViewNode"),t.build=r=>{},t.render=r=>{},t.traverse=r=>{const i=r.getTraverseOperation(),a=t[i];if(a){a(r);return}t.apply(r,!0);for(let o=0;o<e.children.length;o++)e.children[o].traverse(r);t.apply(r,!1)},t.apply=(r,i)=>{const a=t[r.getOperation()];a&&a(i,r)},t.getViewNodeFor=r=>{if(e.renderable===r)return t;for(let i=0;i<e.children.length;++i){const o=e.children[i].getViewNodeFor(r);if(o)return o}},t.getFirstAncestorOfType=r=>e._parent?e._parent.isA(r)?e._parent:e._parent.getFirstAncestorOfType(r):null,t.getLastAncestorOfType=r=>{if(!e._parent)return null;const i=e._parent.getLastAncestorOfType(r);return i||(e._parent.isA(r)?e._parent:null)},t.addMissingNode=r=>{if(!r)return;const i=e._renderableChildMap.get(r);if(i!==void 0)return i.setVisited(!0),i;const a=t.createViewNode(r);if(a)return a.setParent(t),a.setVisited(!0),e._renderableChildMap.set(r,a),e.children.push(a),a},t.addMissingNodes=r=>{if(!(!r||!r.length))for(let i=0;i<r.length;++i){const a=r[i];t.addMissingNode(a)}},t.addMissingChildren=r=>{if(!(!r||!r.length))for(let i=0;i<r.length;++i){const a=r[i];if(e.children.indexOf(a)===-1){a.setParent(t),e.children.push(a);const s=a.getRenderable();s&&e._renderableChildMap.set(s,a)}a.setVisited(!0)}},t.removeNode=r=>{const i=e.children.findIndex(o=>o===r);if(i<0)return!1;const a=r.getRenderable();return a&&e._renderableChildMap.delete(a),r.delete(),e.children.splice(i,1),!0},t.prepareNodes=()=>{for(let r=0;r<e.children.length;++r)e.children[r].setVisited(!1)},t.setVisited=r=>{e.visited=r},t.removeUnusedNodes=()=>{let r=0;for(let i=0;i<e.children.length;++i){const a=e.children[i];if(a.getVisited())e.children[r++]=a,a.setVisited(!1);else{const s=a.getRenderable();s&&e._renderableChildMap.delete(s),a.delete()}}e.children.length=r},t.createViewNode=r=>{if(!e.myFactory)return ixe("Cannot create view nodes without my own factory"),null;const i=e.myFactory.createNode(r);return i&&i.setRenderable(r),i};const n=t.delete;t.delete=()=>{for(let r=0;r<e.children.length;r++)e.children[r].delete();n()}}const sxe={renderable:null,myFactory:null,children:[],visited:!1};function cq(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,sxe,n),le.obj(t,e),le.event(t,e,"event"),e._renderableChildMap=new Map,le.get(t,e,["visited"]),le.setGet(t,e,["_parent","renderable","myFactory"]),le.getArray(t,e,["children"]),le.moveToProtected(t,e,["parent"]),oxe(t,e)}const lxe=le.newInstance(cq,"vtkViewNode");var Rr={newInstance:lxe,extend:cq,PASS_TYPES:axe};function cxe(t,e){e.overrides||(e.overrides={}),e.classHierarchy.push("vtkViewNodeFactory"),t.createNode=n=>{if(n.isDeleted())return null;let r=0,i=n.getClassName(r++),a=!1;const o=Object.keys(e.overrides);for(;i&&!a;)o.indexOf(i)!==-1?a=!0:i=n.getClassName(r++);if(!a)return null;const s=e.overrides[i]();return s.setMyFactory(t),s}}const uxe={};function uq(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,uxe,n),le.obj(t,e),cxe(t,e)}const fxe=le.newInstance(uq,"vtkViewNodeFactory");var dD={newInstance:fxe,extend:uq};const fq=Object.create(null);function sa(t,e){fq[t]=e}function dxe(t,e){e.classHierarchy.push("vtkOpenGLViewNodeFactory")}const hxe={};function dq(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,hxe,n),e.overrides=fq,dD.extend(t,e,n),dxe(t,e)}const pxe=le.newInstance(dq,"vtkOpenGLViewNodeFactory");var gxe={newInstance:pxe,extend:dq};function mxe(t,e){e.classHierarchy.push("vtkOpenGLCamera"),t.buildPass=n=>{n&&(e._openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e._openGLRenderWindow=e._openGLRenderer.getParent(),e.context=e._openGLRenderWindow.getContext())},t.opaquePass=n=>{if(n){const r=e._openGLRenderer.getTiledSizeAndOrigin();e.context.viewport(r.lowerLeftU,r.lowerLeftV,r.usize,r.vsize),e.context.scissor(r.lowerLeftU,r.lowerLeftV,r.usize,r.vsize)}},t.translucentPass=t.opaquePass,t.zBufferPass=t.opaquePass,t.opaqueZBufferPass=t.opaquePass,t.volumePass=t.opaquePass,t.getKeyMatrices=n=>{if(n!==e.lastRenderer||e._openGLRenderWindow.getMTime()>e.keyMatrixTime.getMTime()||t.getMTime()>e.keyMatrixTime.getMTime()||n.getMTime()>e.keyMatrixTime.getMTime()||e.renderable.getMTime()>e.keyMatrixTime.getMTime()){Ei(e.keyMatrices.wcvc,e.renderable.getViewMatrix()),Ww(e.keyMatrices.normalMatrix,e.keyMatrices.wcvc),iy(e.keyMatrices.normalMatrix,e.keyMatrices.normalMatrix),Gn(e.keyMatrices.wcvc,e.keyMatrices.wcvc);const r=e._openGLRenderer.getAspectRatio();Ei(e.keyMatrices.vcpc,e.renderable.getProjectionMatrix(r,-1,1)),Gn(e.keyMatrices.vcpc,e.keyMatrices.vcpc),jn(e.keyMatrices.wcpc,e.keyMatrices.vcpc,e.keyMatrices.wcvc),e.keyMatrixTime.modified(),e.lastRenderer=n}return e.keyMatrices}}const vxe={context:null,lastRenderer:null,keyMatrixTime:null,keyMatrices:null};function yxe(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,vxe,n),Rr.extend(t,e,n),e.keyMatrixTime={},$r(e.keyMatrixTime),e.keyMatrices={normalMatrix:new Float64Array(9),vcpc:new Float64Array(16),wcvc:new Float64Array(16),wcpc:new Float64Array(16)},Mi(t,e,["context","keyMatrixTime"]),mxe(t,e)}const hq=Zn(yxe);var xxe={newInstance:hq};sa("vtkCamera",hq);const{vtkDebugMacro:bxe}=po;function wxe(t,e){e.classHierarchy.push("vtkOpenGLRenderer"),t.buildPass=n=>{if(n){if(!e.renderable)return;t.updateLights(),t.prepareNodes(),t.addMissingNode(e.renderable.getActiveCamera()),t.addMissingNodes(e.renderable.getViewPropsWithNestedProps()),t.removeUnusedNodes()}},t.updateLights=()=>{let n=0;const r=e.renderable.getLightsByReference();for(let i=0;i<r.length;++i)r[i].getSwitch()>0&&n++;return n||(bxe("No lights are on, creating one."),e.renderable.createLight()),n},t.zBufferPass=n=>{if(n){let r=0;const i=e.context;e.renderable.getTransparent()||(e.context.clearColor(1,0,0,1),r|=i.COLOR_BUFFER_BIT),e.renderable.getPreserveDepthBuffer()||(i.clearDepth(1),r|=i.DEPTH_BUFFER_BIT,e.context.depthMask(!0));const a=t.getTiledSizeAndOrigin();i.enable(i.SCISSOR_TEST),i.scissor(a.lowerLeftU,a.lowerLeftV,a.usize,a.vsize),i.viewport(a.lowerLeftU,a.lowerLeftV,a.usize,a.vsize),i.colorMask(!0,!0,!0,!0),r&&i.clear(r),i.enable(i.DEPTH_TEST)}},t.opaqueZBufferPass=n=>t.zBufferPass(n),t.cameraPass=n=>{n&&t.clear()},t.getAspectRatio=()=>{const n=e._parent.getSizeByReference(),r=e.renderable.getViewportByReference();return n[0]*(r[2]-r[0])/((r[3]-r[1])*n[1])},t.getTiledSizeAndOrigin=()=>{const n=e.renderable.getViewportByReference(),r=[0,0,1,1],i=n[0]-r[0],a=n[1]-r[1],o=e._parent.normalizedDisplayToDisplay(i,a),s=Math.round(o[0]),l=Math.round(o[1]),c=n[2]-r[0],f=n[3]-r[1],u=e._parent.normalizedDisplayToDisplay(c,f);let d=Math.round(u[0])-s,h=Math.round(u[1])-l;return d<0&&(d=0),h<0&&(h=0),{usize:d,vsize:h,lowerLeftU:s,lowerLeftV:l}},t.clear=()=>{let n=0;const r=e.context;if(!e.renderable.getTransparent()){const a=e.renderable.getBackgroundByReference();r.clearColor(a[0],a[1],a[2],a[3]),n|=r.COLOR_BUFFER_BIT}e.renderable.getPreserveDepthBuffer()||(r.clearDepth(1),n|=r.DEPTH_BUFFER_BIT,r.depthMask(!0)),r.colorMask(!0,!0,!0,!0);const i=t.getTiledSizeAndOrigin();r.enable(r.SCISSOR_TEST),r.scissor(i.lowerLeftU,i.lowerLeftV,i.usize,i.vsize),r.viewport(i.lowerLeftU,i.lowerLeftV,i.usize,i.vsize),n&&r.clear(n),r.enable(r.DEPTH_TEST)},t.releaseGraphicsResources=()=>{e.selector!==null&&e.selector.releaseGraphicsResources(),e.renderable&&e.renderable.getViewProps().forEach(n=>{n.modified()})},t.setOpenGLRenderWindow=n=>{e._openGLRenderWindow!==n&&(t.releaseGraphicsResources(),e._openGLRenderWindow=n,e.context=null,n&&(e.context=e._openGLRenderWindow.getContext()))}}const Cxe={context:null,_openGLRenderWindow:null,selector:null};function Sxe(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Cxe,n),Rr.extend(t,e,n),Po(t,e,["shaderCache"]),Mi(t,e,["selector"]),Z2(t,e,["openGLRenderWindow"]),wxe(t,e)}const pq=Zn(Sxe,"vtkOpenGLRenderer");var Txe={newInstance:pq};sa("vtkRenderer",pq);function gq(t){let e=0;return t.filter((n,r)=>r===e?(e+=n+1,!0):!1)}function mq(t){let e=0;for(let n=0;n<t.length;)n+=t[n]+1,e++;return e}const Exe={extractCellSizes:gq,getNumberOfCells:mq};function _xe(t,e){e.classHierarchy.push("vtkCellArray");const n={...t};t.getNumberOfCells=r=>(e.numberOfCells!==void 0&&!r||(e.cellSizes?e.numberOfCells=e.cellSizes.length:e.numberOfCells=mq(t.getData())),e.numberOfCells),t.getCellSizes=r=>(e.cellSizes!==void 0&&!r||(e.cellSizes=gq(t.getData())),e.cellSizes),t.resize=r=>{const i=t.getNumberOfTuples();n.resize(r);const a=t.getNumberOfTuples();a<i&&(a===0?(e.numberOfCells=0,e.cellSizes=[]):(e.numberOfCells=void 0,e.cellSizes=void 0))},t.setData=r=>{n.setData(r,1),e.numberOfCells=void 0,e.cellSizes=void 0},t.getCell=r=>{let i=r;const a=e.values[i++];return e.values.subarray(i,i+a)},t.insertNextCell=r=>{const i=t.getNumberOfCells();return t.insertNextTuples([r.length,...r]),++e.numberOfCells,e.cellSizes!=null&&e.cellSizes.push(r.length),i}}function Dxe(t){return{empty:!0,numberOfComponents:1,dataType:Nn.UNSIGNED_INT,...t}}function vq(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};nn.extend(t,e,Dxe(n)),_xe(t,e)}const Oxe=le.newInstance(vq,"vtkCellArray");var Zh={newInstance:Oxe,extend:vq,...Exe};const{vtkErrorMacro:Mxe}=le,Ixe=[1,-1,1,-1,1,-1];function Rxe(t,e){e.classHierarchy.push("vtkPoints"),t.getNumberOfPoints=t.getNumberOfTuples,t.setNumberOfPoints=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:3;t.getNumberOfPoints()!==n&&(e.size=n*r,e.values=le.newTypedArray(e.dataType,e.size),t.setNumberOfComponents(r),t.modified())},t.setPoint=function(n){for(var r=arguments.length,i=new Array(r>1?r-1:0),a=1;a<r;a++)i[a-1]=arguments[a];t.setTuple(n,i)},t.getPoint=t.getTuple,t.findPoint=t.findTuple,t.insertNextPoint=(n,r,i)=>t.insertNextTuple([n,r,i]),t.getBounds=()=>{if(t.getNumberOfComponents()===3){const i=t.getRange(0);e.bounds[0]=i[0],e.bounds[1]=i[1];const a=t.getRange(1);e.bounds[2]=a[0],e.bounds[3]=a[1];const o=t.getRange(2);return e.bounds[4]=o[0],e.bounds[5]=o[1],e.bounds}if(t.getNumberOfComponents()!==2)return Mxe(`getBounds called on an array with components of
        ${t.getNumberOfComponents()}`),Ixe;const n=t.getRange(0);e.bounds[0]=n[0],e.bounds[1]=n[1];const r=t.getRange(1);return e.bounds[2]=r[0],e.bounds[3]=r[1],e.bounds[4]=0,e.bounds[5]=0,e.bounds},t.computeBounds=t.getBounds,t.setNumberOfComponents(e.numberOfComponents<2?3:e.numberOfComponents)}const Axe={empty:!0,numberOfComponents:3,dataType:Nn.FLOAT,bounds:[1,-1,1,-1,1,-1]};function yq(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Axe,n),nn.extend(t,e,n),Rxe(t,e)}const Pxe=le.newInstance(yq,"vtkPoints");var m3={newInstance:Pxe,extend:yq};function Nxe(t,e){e.classHierarchy.push("vtkCell"),t.initialize=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(r){e.pointsIds=r;let i=e.points.getData();i.length!==3*e.pointsIds.length&&(i=le.newTypedArray(n.getDataType(),3*e.pointsIds.length));const a=n.getData();e.pointsIds.forEach((o,s)=>{let l=3*o,c=3*s;i[c]=a[l],i[++c]=a[++l],i[++c]=a[++l]}),e.points.setData(i)}else{e.points=n,e.pointsIds=new Array(n.getNumberOfPoints());for(let i=n.getNumberOfPoints()-1;i>=0;--i)e.pointsIds[i]=i}},t.getBounds=()=>{const n=e.points.getNumberOfPoints(),r=[];if(n){e.points.getPoint(0,r),e.bounds[0]=r[0],e.bounds[1]=r[0],e.bounds[2]=r[1],e.bounds[3]=r[1],e.bounds[4]=r[2],e.bounds[5]=r[2];for(let i=1;i<n;i++)e.points.getPoint(i,r),e.bounds[0]=r[0]<e.bounds[0]?r[0]:e.bounds[0],e.bounds[1]=r[0]>e.bounds[1]?r[0]:e.bounds[1],e.bounds[2]=r[1]<e.bounds[2]?r[1]:e.bounds[2],e.bounds[3]=r[1]>e.bounds[3]?r[1]:e.bounds[3],e.bounds[4]=r[2]<e.bounds[4]?r[2]:e.bounds[4],e.bounds[5]=r[2]>e.bounds[5]?r[2]:e.bounds[5]}else Nm(e.bounds);return e.bounds},t.getLength2=()=>{t.getBounds();let n=0,r=0;for(let i=0;i<3;i++)r=e.bounds[2*i+1]-e.bounds[2*i],n+=r*r;return n},t.getParametricDistance=n=>{let r,i=0;for(let a=0;a<3;a++)n[a]<0?r=-n[a]:n[a]>1?r=n[a]-1:r=0,r>i&&(i=r);return i},t.getNumberOfPoints=()=>e.points.getNumberOfPoints(),t.deepCopy=n=>{n.initialize(e.points,e.pointsIds)},t.getCellDimension=()=>{},t.intersectWithLine=(n,r,i,a,o,s,l)=>{},t.evaluatePosition=(n,r,i,a,o,s)=>{le.vtkErrorMacro("vtkCell.evaluatePosition is not implemented.")}}const Lxe={bounds:[-1,-1,-1,-1,-1,-1],pointsIds:[]};function xq(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Lxe,n),le.obj(t,e),e.points||(e.points=m3.newInstance()),le.get(t,e,["points","pointsIds"]),Nxe(t,e)}const kxe=le.newInstance(xq,"vtkCell");var v3={newInstance:kxe,extend:xq};function Vxe(t,e){let n=e;for(e>=t.array.length&&(n+=t.array.length);n>t.array.length;)t.array.push({ncells:0,cells:null});t.array.length=n}function Fxe(t,e){e.classHierarchy.push("vtkCellLinks"),t.buildLinks=n=>{const r=n.getPoints().getNumberOfPoints(),i=n.getNumberOfCells(),a=new Uint32Array(r);if(n.isA("vtkPolyData")){for(let o=0;o<i;++o){const{cellPointIds:s}=n.getCellPoints(o);s.forEach(l=>{t.incrementLinkCount(l)})}t.allocateLinks(r),e.maxId=r-1;for(let o=0;o<i;++o){const{cellPointIds:s}=n.getCellPoints(o);s.forEach(l=>{t.insertCellReference(l,a[l]++,o)})}}else{for(let o=0;o<i;o++)v3.newInstance().getPointsIds().forEach(l=>{t.incrementLinkCount(l)});t.allocateLinks(r),e.maxId=r-1;for(let o=0;o<i;++o)v3.newInstance().getPointsIds().forEach(l=>{t.insertCellReference(l,a[l]++,o)})}},t.allocate=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e3;e.array=Array(n).fill().map(()=>({ncells:0,cells:null})),e.extend=r,e.maxId=-1},t.initialize=()=>{e.array=null},t.getLink=n=>e.array[n],t.getNcells=n=>e.array[n].ncells,t.getCells=n=>e.array[n].cells,t.insertNextPoint=n=>{e.array.push({ncells:n,cells:Array(n)}),++e.maxId},t.insertNextCellReference=(n,r)=>{e.array[n].cells[e.array[n].ncells++]=r},t.deletePoint=n=>{e.array[n].ncells=0,e.array[n].cells=null},t.removeCellReference=(n,r)=>{e.array[r].cells=e.array[r].cells.filter(i=>i!==n),e.array[r].ncells=e.array[r].cells.length},t.addCellReference=(n,r)=>{e.array[r].cells[e.array[r].ncells++]=n},t.resizeCellList=(n,r)=>{e.array[n].cells.length=r},t.squeeze=()=>{Vxe(e,e.maxId+1)},t.reset=()=>{e.maxId=-1},t.deepCopy=n=>{e.array=[...n.array],e.extend=n.extend,e.maxId=n.maxId},t.incrementLinkCount=n=>{++e.array[n].ncells},t.allocateLinks=n=>{for(let r=0;r<n;++r)e.array[r].cells=new Array(e.array[r].ncells)},t.insertCellReference=(n,r,i)=>{e.array[n].cells[r]=i}}const Uxe={array:null,maxId:0,extend:0};function bq(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Uxe,n),le.obj(t,e),Fxe(t,e)}const Bxe=le.newInstance(bq,"vtkCellLinks");var $xe={newInstance:Bxe,extend:bq};const Jr={VTK_EMPTY_CELL:0,VTK_VERTEX:1,VTK_POLY_VERTEX:2,VTK_LINE:3,VTK_POLY_LINE:4,VTK_TRIANGLE:5,VTK_TRIANGLE_STRIP:6,VTK_POLYGON:7,VTK_QUAD:9,VTK_QUADRATIC_EDGE:21,VTK_CONVEX_POINT_SET:41,VTK_POLYHEDRON:42},E6=["vtkEmptyCell","vtkVertex","vtkPolyVertex","vtkLine","vtkPolyLine","vtkTriangle","vtkTriangleStrip","vtkPolygon","vtkPixel","vtkQuad","vtkTetra","vtkVoxel","vtkHexahedron","vtkWedge","vtkPyramid","vtkPentagonalPrism","vtkHexagonalPrism","UnknownClass","UnknownClass","UnknownClass","UnknownClass","vtkQuadraticEdge","vtkQuadraticTriangle","vtkQuadraticQuad","vtkQuadraticTetra","vtkQuadraticHexahedron","vtkQuadraticWedge","vtkQuadraticPyramid","vtkBiQuadraticQuad","vtkTriQuadraticHexahedron","vtkQuadraticLinearQuad","vtkQuadraticLinearWedge","vtkBiQuadraticQuadraticWedge","vtkBiQuadraticQuadraticHexahedron","vtkBiQuadraticTriangle","vtkCubicLine","vtkQuadraticPolygon","UnknownClass","UnknownClass","UnknownClass","UnknownClass","vtkConvexPointSet","UnknownClass","UnknownClass","UnknownClass","UnknownClass","UnknownClass","UnknownClass","UnknownClass","UnknownClass","UnknownClass","vtkParametricCurve","vtkParametricSurface","vtkParametricTriSurface","vtkParametricQuadSurface","vtkParametricTetraRegion","vtkParametricHexRegion","UnknownClass","UnknownClass","UnknownClass","vtkHigherOrderEdge","vtkHigherOrderTriangle","vtkHigherOrderQuad","vtkHigherOrderPolygon","vtkHigherOrderTetrahedron","vtkHigherOrderWedge","vtkHigherOrderPyramid","vtkHigherOrderHexahedron"];function Gxe(t){return t<E6.length?E6[t]:"UnknownClass"}function jxe(t){return E6.findIndex(t)}function zxe(t){return t<Jr.VTK_QUADRATIC_EDGE||t===Jr.VTK_CONVEX_POINT_SET||t===Jr.VTK_POLYHEDRON}function Wxe(t){return t===Jr.VTK_TRIANGLE_STRIP||t===Jr.VTK_POLY_LINE||t===Jr.VTK_POLY_VERTEX}const Hxe={getClassNameFromTypeId:Gxe,getTypeIdFromClassName:jxe,isLinear:zxe,hasSubCells:Wxe};function Kxe(t,e){e.classHierarchy.push("vtkCellTypes"),t.allocate=function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:512,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e3;e.size=n>0?n:1,e.extend=r>0?r:1,e.maxId=-1,e.typeArray=new Uint8Array(n),e.locationArray=new Uint32Array(n)},t.insertCell=(n,r,i)=>{e.typeArray[n]=r,e.locationArray[n]=i,n>e.maxId&&(e.maxId=n)},t.insertNextCell=(n,r)=>(t.insertCell(++e.maxId,n,r),e.maxId),t.setCellTypes=(n,r,i)=>{e.size=n,e.typeArray=r,e.locationArray=i,e.maxId=n-1},t.getCellLocation=n=>e.locationArray[n],t.deleteCell=n=>{e.typeArray[n]=Jr.VTK_EMPTY_CELL},t.getNumberOfTypes=()=>e.maxId+1,t.isType=n=>{const r=t.getNumberOfTypes();for(let i=0;i<r;++i)if(n===t.getCellType(i))return!0;return!1},t.insertNextType=n=>t.insertNextCell(n,-1),t.getCellType=n=>e.typeArray[n],t.reset=()=>{e.maxId=-1},t.deepCopy=n=>{t.allocate(n.getSize(),n.getExtend()),e.typeArray.set(n.getTypeArray()),e.locationArray.set(n.getLocationArray()),e.maxId=n.getMaxId()}}const qxe={size:0,maxId:-1,extend:1e3};function wq(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,qxe,n),le.obj(t,e),le.get(t,e,["size","maxId","extend"]),le.getArray(t,e,["typeArray","locationArray"]),Kxe(t,e)}const Xxe=le.newInstance(wq,"vtkCellTypes");var Yxe={newInstance:Xxe,extend:wq,...Hxe};const Jxe={NO_INTERSECTION:0,YES_INTERSECTION:1,ON_LINE:2};var Cq={IntersectionState:Jxe};const{IntersectionState:pb}=Cq;function xg(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;const i={t:Number.MIN_VALUE,distance:0},a=[];let o;a[0]=n[0]-e[0],a[1]=n[1]-e[1],a[2]=n[2]-e[2];const s=a[0]*(t[0]-e[0])+a[1]*(t[1]-e[1])+a[2]*(t[2]-e[2]),l=An(a,a);let c=1e-5*s;return l!==0&&(i.t=s/l),c<0&&(c=-c),-c<l&&l<c||l<=0||i.t<0?o=e:i.t>1?o=n:(o=a,a[0]=e[0]+i.t*a[0],a[1]=e[1]+i.t*a[1],a[2]=e[2]+i.t*a[2]),r&&(r[0]=o[0],r[1]=o[1],r[2]=o[2]),i.distance=Hc(o,t),i}function Sq(t,e,n,r,i,a){const o=[],s=[],l=[];i[0]=0,a[0]=0,Tf(e,t,o),Tf(r,n,s),Tf(n,t,l);const c=[An(o,o),-An(o,s),-An(o,s),An(s,s)],f=[];if(f[0]=An(o,l),f[1]=-An(s,l),LH(c,f,2)===0){let u=Number.MAX_VALUE;const d=[t,e,n,r],h=[n,n,t,t],p=[r,r,e,e];a[0],a[0],i[0],i[0],i[0],i[0],a[0],a[0];let g;for(let m=0;m<4;m++)g=xg(d[m],h[m],p[m]),g.distance<u&&(u=g.distance,g.t);return pb.ON_LINE}return i[0]=f[0],a[0]=f[1],i[0]>=0&&i[0]<=1&&a[0]>=0&&a[0]<=1?pb.YES_INTERSECTION:pb.NO_INTERSECTION}const Zxe={distanceToLine:xg,intersection:Sq};function Qxe(t,e){e.classHierarchy.push("vtkLine");function n(r){return r>=0&&r<=1}t.getCellDimension=()=>1,t.intersectWithLine=(r,i,a,o,s)=>{const l={intersect:0,t:Number.MAX_VALUE,subId:0,betweenPoints:null};s[1]=0,s[2]=0;const c=[],f=[],u=[];e.points.getPoint(0,f),e.points.getPoint(1,u);const d=[],h=[],p=Sq(r,i,f,u,d,h);if(l.t=d[0],l.betweenPoints=n(l.t),s[0]=h[0],p===pb.YES_INTERSECTION){for(let g=0;g<3;g++)o[g]=f[g]+s[0]*(u[g]-f[g]),c[g]=r[g]+l.t*(i[g]-r[g]);if(Hc(o,c)<=a*a)return l.intersect=1,l}else{let g;if(l.t<0)return g=xg(r,f,u,o),g.distance<=a*a&&(l.t=0,l.intersect=1,l.betweenPoints=!0),l;if(l.t>1)return g=xg(i,f,u,o),g.distance<=a*a&&(l.t=1,l.intersect=1,l.betweenPoints=!0),l;if(s[0]<0)return s[0]=0,g=xg(f,r,i,o),l.t=g.t,g.distance<=a*a&&(l.intersect=1),l;if(s[0]>1)return s[0]=1,g=xg(u,r,i,o),l.t=g.t,g.distance<=a*a&&(l.intersect=1),l}return l},t.evaluateLocation=(r,i,a)=>{const o=[],s=[];e.points.getPoint(0,o),e.points.getPoint(1,s);for(let l=0;l<3;l++)i[l]=o[l]+r[0]*(s[l]-o[l]);a[0]=1-r[0],a[1]=r[0]},t.evaluateOrientation=(r,i,a)=>e.orientations?(fb(i,e.orientations[0],e.orientations[1],r[0]),a[0]=1-r[0],a[1]=r[0],!0):!1}const ebe={orientations:null};function Tq(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,ebe,n),v3.extend(t,e,n),le.setGet(t,e,["orientations"]),Qxe(t,e)}const tbe=le.newInstance(Tq,"vtkLine");var El={newInstance:tbe,extend:Tq,...Zxe,...Cq};const{vtkErrorMacro:wL,vtkWarningMacro:nbe}=le;function rbe(t,e){e.classHierarchy.push("vtkFieldData");const n=t.getState;e.arrays&&(e.arrays=e.arrays.map(r=>({data:hc(r.data)}))),t.initialize=()=>{t.initializeFields(),t.copyAllOn(),t.clearFieldFlags()},t.initializeFields=()=>{e.arrays=[],e.copyFieldFlags={},t.modified()},t.copyStructure=r=>{t.initializeFields(),e.copyFieldFlags=r.getCopyFieldFlags().map(i=>i),e.arrays=r.arrays().map(i=>({array:i}))},t.getNumberOfArrays=()=>e.arrays.length,t.getNumberOfActiveArrays=()=>e.arrays.length,t.addArray=r=>{const i=r.getName(),{array:a,index:o}=t.getArrayWithIndex(i);return a!=null?(e.arrays[o]={data:r},o):(e.arrays=[].concat(e.arrays,{data:r}),e.arrays.length-1)},t.removeAllArrays=()=>{e.arrays=[]},t.removeArray=r=>{const i=e.arrays.findIndex(a=>a.data.getName()===r);return t.removeArrayByIndex(i)},t.removeArrayByIndex=r=>r!==-1&&r<e.arrays.length?(e.arrays.splice(r,1),!0):!1,t.getArrays=()=>e.arrays.map(r=>r.data),t.getArray=r=>typeof r=="number"?t.getArrayByIndex(r):t.getArrayByName(r),t.getArrayByName=r=>e.arrays.reduce((i,a,o)=>a.data.getName()===r?a.data:i,null),t.getArrayWithIndex=r=>{const i=e.arrays.findIndex(a=>a.data.getName()===r);return{array:i!==-1?e.arrays[i].data:null,index:i}},t.getArrayByIndex=r=>r>=0&&r<e.arrays.length?e.arrays[r].data:null,t.hasArray=r=>t.getArrayWithIndex(r).index>=0,t.getArrayName=r=>{const i=e.arrays[r];return i?i.data.getName():""},t.getCopyFieldFlags=()=>e.copyFieldFlags,t.getFlag=r=>e.copyFieldFlags[r],t.passData=function(r){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1;r.getArrays().forEach(o=>{const s=t.getFlag(o.getName());if(s!==!1&&!(e.doCopyAllOff&&s!==!0)&&o){let l=t.getArrayByName(o.getName());if(l)if(o.getNumberOfComponents()===l.getNumberOfComponents())if(i>-1&&i<o.getNumberOfTuples()){const c=a>-1?a:i;l.insertTuple(c,o.getTuple(i))}else l.insertTuples(0,o.getTuples());else wL("Unhandled case in passData");else if(i<0||i>o.getNumberOfTuples())t.addArray(o),r.getAttributes(o).forEach(c=>{t.setAttribute(o,c)});else{const c=o.getNumberOfComponents();let f=o.getNumberOfValues();const u=a>-1?a:i;f<=u*c&&(f=(u+1)*c),l=nn.newInstance({name:o.getName(),dataType:o.getDataType(),numberOfComponents:c,values:le.newTypedArray(o.getDataType(),f),size:0}),l.insertTuple(u,o.getTuple(i)),t.addArray(l),r.getAttributes(o).forEach(d=>{t.setAttribute(l,d)})}}})},t.interpolateData=function(r){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:-1,s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:.5;r.getArrays().forEach(l=>{const c=t.getFlag(l.getName());if(c!==!1&&!(e.doCopyAllOff&&c!==!0)&&l){let f=t.getArrayByName(l.getName());if(f)if(l.getNumberOfComponents()===f.getNumberOfComponents())if(i>-1&&i<l.getNumberOfTuples()){const u=o>-1?o:i;f.interpolateTuple(u,l,i,l,a,s),nbe("Unexpected case in interpolateData")}else f.insertTuples(l.getTuples());else wL("Unhandled case in interpolateData");else if(i<0||a<0||i>l.getNumberOfTuples())t.addArray(l),r.getAttributes(l).forEach(u=>{t.setAttribute(l,u)});else{const u=l.getNumberOfComponents();let d=l.getNumberOfValues();const h=o>-1?o:i;d<=h*u&&(d=(h+1)*u),f=nn.newInstance({name:l.getName(),dataType:l.getDataType(),numberOfComponents:u,values:le.newTypedArray(l.getDataType(),d),size:0}),f.interpolateTuple(h,l,i,l,a,s),t.addArray(f),r.getAttributes(l).forEach(p=>{t.setAttribute(f,p)})}}})},t.copyFieldOn=r=>{e.copyFieldFlags[r]=!0},t.copyFieldOff=r=>{e.copyFieldFlags[r]=!1},t.copyAllOn=()=>{(!e.doCopyAllOn||e.doCopyAllOff)&&(e.doCopyAllOn=!0,e.doCopyAllOff=!1,t.modified())},t.copyAllOff=()=>{(e.doCopyAllOn||!e.doCopyAllOff)&&(e.doCopyAllOn=!1,e.doCopyAllOff=!0,t.modified())},t.clearFieldFlags=()=>{e.copyFieldFlags={}},t.deepCopy=r=>{e.arrays=r.getArrays().map(i=>{const a=i.newClone();return a.deepCopy(i),{data:a}})},t.copyFlags=r=>r.getCopyFieldFlags().map(i=>i),t.reset=()=>e.arrays.forEach(r=>r.data.reset()),t.getMTime=()=>e.arrays.reduce((r,i)=>i.data.getMTime()>r?i.data.getMTime():r,e.mtime),t.getNumberOfComponents=()=>e.arrays.reduce((r,i)=>r+i.data.getNumberOfComponents(),0),t.getNumberOfTuples=()=>e.arrays.length>0?e.arrays[0].getNumberOfTuples():0,t.getState=()=>{const r=n();return r&&(r.arrays=e.arrays.map(i=>({data:i.data.getState()}))),r}}const ibe={arrays:[],copyFieldFlags:[],doCopyAllOn:!0,doCopyAllOff:!1};function Eq(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,ibe,n),le.obj(t,e),rbe(t,e)}const abe=le.newInstance(Eq,"vtkFieldData");var obe={newInstance:abe,extend:Eq};const sbe={SCALARS:0,VECTORS:1,NORMALS:2,TCOORDS:3,TENSORS:4,GLOBALIDS:5,PEDIGREEIDS:6,EDGEFLAG:7,NUM_ATTRIBUTES:8},lbe={MAX:0,EXACT:1,NOLIMIT:2},cbe={DUPLICATECELL:1,HIGHCONNECTIVITYCELL:2,LOWCONNECTIVITYCELL:4,REFINEDCELL:8,EXTERIORCELL:16,HIDDENCELL:32},ube={DUPLICATEPOINT:1,HIDDENPOINT:2},fbe={COPYTUPLE:0,INTERPOLATE:1,PASSDATA:2,ALLCOPY:3},dbe="vtkGhostType",hbe={DEFAULT:0,SINGLE:1,DOUBLE:2};var _q={AttributeCopyOperations:fbe,AttributeLimitTypes:lbe,AttributeTypes:sbe,CellGhostTypes:cbe,DesiredOutputPrecision:hbe,PointGhostTypes:ube,ghostArrayName:dbe};const{AttributeTypes:pd,AttributeCopyOperations:z0}=_q,{vtkWarningMacro:Q5}=le;function pbe(t,e){const n=["Scalars","Vectors","Normals","TCoords","Tensors","GlobalIds","PedigreeIds"];function r(o){let s=n.find(l=>pd[l.toUpperCase()]===o||typeof o!="number"&&l.toLowerCase()===o.toLowerCase());return typeof s>"u"&&(s=null),s}e.classHierarchy.push("vtkDataSetAttributes");const i={...t};t.checkNumberOfComponents=o=>!0,t.setAttribute=(o,s)=>{const l=r(s);if(o&&l.toUpperCase()==="PEDIGREEIDS"&&!o.isA("vtkDataArray"))return Q5(`Cannot set attribute ${l}. The attribute must be a vtkDataArray.`),-1;if(o&&!t.checkNumberOfComponents(o,l))return Q5(`Cannot set attribute ${l}. Incorrect number of components.`),-1;let c=e[`active${l}`];if(c>=0&&c<e.arrays.length){if(e.arrays[c]===o)return c;t.removeArrayByIndex(c)}return o?(c=t.addArray(o),e[`active${l}`]=c):e[`active${l}`]=-1,t.modified(),e[`active${l}`]},t.getAttributes=o=>n.filter(s=>t[`get${s}`]()===o),t.setActiveAttributeByName=(o,s)=>t.setActiveAttributeByIndex(t.getArrayWithIndex(o).index,s),t.setActiveAttributeByIndex=(o,s)=>{const l=r(s);if(o>=0&&o<e.arrays.length){if(l.toUpperCase()!=="PEDIGREEIDS"){const c=t.getArrayByIndex(o);if(!c.isA("vtkDataArray"))return Q5(`Cannot set attribute ${l}. Only vtkDataArray subclasses can be set as active attributes.`),-1;if(!t.checkNumberOfComponents(c,l))return Q5(`Cannot set attribute ${l}. Incorrect number of components.`),-1}return e[`active${l}`]=o,t.modified(),o}return o===-1&&(e[`active${l}`]=o,t.modified()),-1},t.getActiveAttribute=o=>{const s=r(o);return t[`get${s}`]()},t.removeAllArrays=()=>{n.forEach(o=>{e[`active${o}`]=-1}),i.removeAllArrays()},t.removeArrayByIndex=o=>(o!==-1&&n.forEach(s=>{o===e[`active${s}`]?e[`active${s}`]=-1:o<e[`active${s}`]&&(e[`active${s}`]-=1)}),i.removeArrayByIndex(o)),n.forEach(o=>{const s=`active${o}`;t[`get${o}`]=()=>t.getArrayByIndex(e[s]),t[`set${o}`]=l=>t.setAttribute(l,o),t[`setActive${o}`]=l=>t.setActiveAttributeByIndex(t.getArrayWithIndex(l).index,o),t[`copy${o}Off`]=()=>{const l=o.toUpperCase();e.copyAttributeFlags[z0.PASSDATA][pd[l]]=!1},t[`copy${o}On`]=()=>{const l=o.toUpperCase();e.copyAttributeFlags[z0.PASSDATA][pd[l]]=!0}}),t.initializeAttributeCopyFlags=()=>{e.copyAttributeFlags=[],Object.keys(z0).filter(o=>o!=="ALLCOPY").forEach(o=>{e.copyAttributeFlags[z0[o]]=Object.keys(pd).filter(s=>s!=="NUM_ATTRIBUTES").reduce((s,l)=>(s[pd[l]]=!0,s),[])}),e.copyAttributeFlags[z0.COPYTUPLE][pd.GLOBALIDS]=!1,e.copyAttributeFlags[z0.INTERPOLATE][pd.GLOBALIDS]=!1,e.copyAttributeFlags[z0.COPYTUPLE][pd.PEDIGREEIDS]=!1},t.initialize=le.chain(t.initialize,t.initializeAttributeCopyFlags),e.dataArrays&&Object.keys(e.dataArrays).length&&Object.keys(e.dataArrays).forEach(o=>{!e.dataArrays[o].ref&&e.dataArrays[o].type==="vtkDataArray"&&t.addArray(nn.newInstance(e.dataArrays[o]))});const a=t.shallowCopy;t.shallowCopy=(o,s)=>{a(o,s),e.arrays=o.getArrays().map(l=>{const c=l.newClone();return c.shallowCopy(l,s),{data:c}})},t.initializeAttributeCopyFlags()}const gbe={activeScalars:-1,activeVectors:-1,activeTensors:-1,activeNormals:-1,activeTCoords:-1,activeGlobalIds:-1,activePedigreeIds:-1};function Dq(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,gbe,n),obe.extend(t,e,n),le.setGet(t,e,["activeScalars","activeNormals","activeTCoords","activeVectors","activeTensors","activeGlobalIds","activePedigreeIds"]),e.arrays||(e.arrays={}),pbe(t,e)}const mbe=le.newInstance(Dq,"vtkDataSetAttributes");var CL={newInstance:mbe,extend:Dq,..._q};const vbe={UNIFORM:0,DATA_OBJECT_FIELD:0,COORDINATE:1,POINT_DATA:1,POINT:2,POINT_FIELD_DATA:2,CELL:3,CELL_FIELD_DATA:3,VERTEX:4,VERTEX_FIELD_DATA:4,EDGE:5,EDGE_FIELD_DATA:5,ROW:6,ROW_DATA:6},ybe={FIELD_ASSOCIATION_POINTS:0,FIELD_ASSOCIATION_CELLS:1,FIELD_ASSOCIATION_NONE:2,FIELD_ASSOCIATION_POINTS_THEN_CELLS:3,FIELD_ASSOCIATION_VERTICES:4,FIELD_ASSOCIATION_EDGES:5,FIELD_ASSOCIATION_ROWS:6,NUMBER_OF_ASSOCIATIONS:7};var xbe={FieldDataTypes:vbe,FieldAssociations:ybe};const _6=["pointData","cellData","fieldData"];function bbe(t,e){e.classHierarchy.push("vtkDataSet"),_6.forEach(r=>{e[r]?e[r]=hc(e[r]):e[r]=CL.newInstance()});const n=t.shallowCopy;t.shallowCopy=function(r){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;n(r,i),_6.forEach(a=>{e[a]=CL.newInstance(),e[a].shallowCopy(r.getReferenceByName(a))})}}const wbe={};function Oq(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,wbe,n),le.obj(t,e),le.setGet(t,e,_6),bbe(t,e)}const Cbe=le.newInstance(Oq,"vtkDataSet");var Lm={newInstance:Cbe,extend:Oq,...xbe};function Sbe(t,e){e.classHierarchy.push("vtkPointSet"),e.points?e.points=hc(e.points):e.points=m3.newInstance(),t.getNumberOfPoints=()=>e.points.getNumberOfPoints(),t.getBounds=()=>e.points.getBounds(),t.computeBounds=()=>{t.getBounds()};const n=t.shallowCopy;t.shallowCopy=function(r){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;n(r,i),e.points=m3.newInstance(),e.points.shallowCopy(r.getPoints())}}const Tbe={};function Mq(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Tbe,n),Lm.extend(t,e,n),le.setGet(t,e,["points"]),Sbe(t,e)}const Ebe=le.newInstance(Mq,"vtkPointSet");var _be={newInstance:Ebe,extend:Mq};function hD(t,e,n,r){const i=n[0]-e[0],a=n[1]-e[1],o=n[2]-e[2],s=t[0]-e[0],l=t[1]-e[1],c=t[2]-e[2];r[0]=a*c-o*l,r[1]=o*s-i*c,r[2]=i*l-a*s}function y3(t,e,n,r){hD(t,e,n,r);const i=Math.sqrt(r[0]*r[0]+r[1]*r[1]+r[2]*r[2]);i!==0&&(r[0]/=i,r[1]/=i,r[2]/=i)}function Dbe(t,e,n,r,i,a){let o=arguments.length>6&&arguments[6]!==void 0?arguments[6]:1e-6,s=!1;const l=[],c=[],f=[],u=[],d=[];y3(t,e,n,u),y3(r,i,a,d);const h=-An(u,t),p=-An(d,r),g=[An(d,t)+p,An(d,e)+p,An(d,n)+p];if(g[0]*g[1]>o&&g[0]*g[2]>o)return{intersect:!1,coplanar:s,pt1:l,pt2:c,surfaceId:f};const m=[An(u,r)+h,An(u,i)+h,An(u,a)+h];if(m[0]*m[1]>o&&m[0]*m[2]>o)return{intersect:!1,coplanar:s,pt1:l,pt2:c,surfaceId:f};if(Math.abs(u[0]-d[0])<1e-9&&Math.abs(u[1]-d[1])<1e-9&&Math.abs(u[2]-d[2])<1e-9&&Math.abs(h-p)<1e-9)return s=!0,{intersect:!1,coplanar:s,pt1:l,pt2:c,surfaceId:f};const y=[t,e,n],v=[r,i,a],x=An(u,d),w=(h-p*x)/(x*x-1),S=(p-h*x)/(x*x-1),T=[w*u[0]+S*d[0],w*u[1]+S*d[1],w*u[2]+S*d[2]],_=gu(u,d,[]);qh(_);let D=0,I=0;const R=[],M=[];let A=50,L=50;for(let U=0;U<3;U++){const G=U,F=(U+1)%3,$=Do.intersectWithLine(y[G],y[F],r,d);$.intersection&&$.t>0-o&&$.t<1+o&&($.t<1+o&&$.t>1-o&&(A=D),R[D++]=An($.x,_)-An(T,_));const V=Do.intersectWithLine(v[G],v[F],t,u);V.intersection&&V.t>0-o&&V.t<1+o&&(V.t<1+o&&V.t>1-o&&(L=I),M[I++]=An(V.x,_)-An(T,_))}if(D>2){D--;const U=R[2];R[2]=R[A],R[A]=U}if(I>2){I--;const U=M[2];M[2]=M[L],M[L]=U}if(D!==2||I!==2)return{intersect:!1,coplanar:s,pt1:l,pt2:c,surfaceId:f};if(Number.isNaN(R[0])||Number.isNaN(R[1])||Number.isNaN(M[0])||Number.isNaN(M[1]))return{intersect:!1,coplanar:s,pt1:l,pt2:c,surfaceId:f};if(R[0]>R[1]){const U=R[1];R[1]=R[0],R[0]=U}if(M[0]>M[1]){const U=M[1];M[1]=M[0],M[0]=U}let P,B;return R[1]<M[0]||M[1]<R[0]?{intersect:!1,coplanar:s,pt1:l,pt2:c,surfaceId:f}:(R[0]<M[0]?R[1]<M[1]?(f[0]=2,f[1]=1,P=M[0],B=R[1]):(f[0]=2,f[1]=2,P=M[0],B=M[1]):R[1]<M[1]?(f[0]=1,f[1]=1,P=R[0],B=R[1]):(f[0]=1,f[1]=2,P=R[0],B=M[1]),o6(T,_,P,l),o6(T,_,B,c),{intersect:!0,coplanar:s,pt1:l,pt2:c,surfaceId:f})}const Obe={computeNormalDirection:hD,computeNormal:y3,intersectWithTriangle:Dbe};function Mbe(t,e){e.classHierarchy.push("vtkTriangle"),t.getCellDimension=()=>2,t.intersectWithLine=(n,r,i,a,o)=>{const s={subId:0,t:Number.MAX_VALUE,intersect:0,betweenPoints:!1};o[2]=0;const l=[],c=i*i,f=[],u=[],d=[];e.points.getPoint(0,f),e.points.getPoint(1,u),e.points.getPoint(2,d);const h=[],p=[];if(y3(f,u,d,h),h[0]!==0||h[1]!==0||h[2]!==0){const x=Do.intersectWithLine(n,r,f,h);if(s.betweenPoints=x.betweenPoints,s.t=x.t,a[0]=x.x[0],a[1]=x.x[1],a[2]=x.x[2],!x.intersection)return o[0]=0,o[1]=0,s.intersect=0,s;const w=t.evaluatePosition(a,l,o,p);if(w.evaluation>=0)return w.dist2<=c?(s.intersect=1,s):(s.intersect=w.evaluation,s)}const g=Hc(f,u),m=Hc(u,d),y=Hc(d,f);e.line||(e.line=El.newInstance()),g>m&&g>y?(e.line.getPoints().setPoint(0,f),e.line.getPoints().setPoint(1,u)):m>y&&m>g?(e.line.getPoints().setPoint(0,u),e.line.getPoints().setPoint(1,d)):(e.line.getPoints().setPoint(0,d),e.line.getPoints().setPoint(1,f));const v=e.line.intersectWithLine(n,r,i,a,o);if(s.betweenPoints=v.betweenPoints,s.t=v.t,v.intersect){const x=[],w=[],S=[];for(let T=0;T<3;T++)x[T]=f[T]-d[T],w[T]=u[T]-d[T],S[T]=a[T]-d[T];return o[0]=An(S,x)/y,o[1]=An(S,w)/m,s.intersect=1,s}return o[0]=0,o[1]=0,s.intersect=0,s},t.evaluatePosition=(n,r,i,a)=>{const o={subId:0,dist2:0,evaluation:-1};let s,l;const c=[],f=[],u=[],d=[];let h;const p=[],g=[],m=[];let y=0,v=0;const x=[];let w,S,T,_=[];const D=[],I=[],R=[];o.subId=0,i[2]=0,e.points.getPoint(1,c),e.points.getPoint(2,f),e.points.getPoint(0,u),hD(c,f,u,d),Do.generalizedProjectPoint(n,c,d,R);let M=0;for(s=0;s<3;s++)d[s]<0?h=-d[s]:h=d[s],h>M&&(M=h,v=s);for(l=0,s=0;s<3;s++)s!==v&&(x[l++]=s);for(s=0;s<2;s++)p[s]=R[x[s]]-u[x[s]],g[s]=c[x[s]]-u[x[s]],m[s]=f[x[s]]-u[x[s]];if(y=Si(g,m),y===0)return i[0]=0,i[1]=0,o.evaluation=-1,o;if(i[0]=Si(p,m)/y,i[1]=Si(g,p)/y,a[0]=1-(i[0]+i[1]),a[1]=i[0],a[2]=i[1],a[0]>=0&&a[0]<=1&&a[1]>=0&&a[1]<=1&&a[2]>=0&&a[2]<=1)r&&(o.dist2=Hc(R,n),r[0]=R[0],r[1]=R[1],r[2]=R[2]),o.evaluation=1;else{let A;if(r){if(a[1]<0&&a[2]<0)for(w=Hc(n,u),S=El.distanceToLine(n,c,u,A,D),T=El.distanceToLine(n,u,f,A,I),w<S?(o.dist2=w,_=u):(o.dist2=S,_=D),T<o.dist2&&(o.dist2=T,_=I),s=0;s<3;s++)r[s]=_[s];else if(a[2]<0&&a[0]<0)for(w=Hc(n,c),S=El.distanceToLine(n,c,u,A,D),T=El.distanceToLine(n,c,f,A,I),w<S?(o.dist2=w,_=c):(o.dist2=S,_=D),T<o.dist2&&(o.dist2=T,_=I),s=0;s<3;s++)r[s]=_[s];else if(a[1]<0&&a[0]<0)for(w=Hc(n,f),S=El.distanceToLine(n,f,u,A,D),T=El.distanceToLine(n,c,f,A,I),w<S?(o.dist2=w,_=f):(o.dist2=S,_=D),T<o.dist2&&(o.dist2=T,_=I),s=0;s<3;s++)r[s]=_[s];else if(a[0]<0){const L=El.distanceToLine(n,c,f,r);o.dist2=L.distance}else if(a[1]<0){const L=El.distanceToLine(n,f,u,r);o.dist2=L.distance}else if(a[2]<0){const L=El.distanceToLine(n,c,u,r);o.dist2=L.distance}}o.evaluation=0}return o},t.evaluateLocation=(n,r,i)=>{const a=[],o=[],s=[];e.points.getPoint(0,a),e.points.getPoint(1,o),e.points.getPoint(2,s);const l=1-n[0]-n[1];for(let c=0;c<3;c++)r[c]=a[c]*l+o[c]*n[0]+s[c]*n[1];i[0]=l,i[1]=n[0],i[2]=n[1]},t.getParametricDistance=n=>{let r,i=0;const a=[];a[0]=n[0],a[1]=n[1],a[2]=1-n[0]-n[1];for(let o=0;o<3;o++)a[o]<0?r=-a[o]:a[o]>1?r=a[o]-1:r=0,r>i&&(i=r);return i}}const Ibe={};function Iq(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Ibe,n),v3.extend(t,e,n),Mbe(t,e)}const Rbe=le.newInstance(Iq,"vtkTriangle");var Rq={newInstance:Rbe,extend:Iq,...Obe};const BT=["verts","lines","polys","strips"],{vtkWarningMacro:SL}=le,Abe={[Jr.VTK_LINE]:El,[Jr.VTK_POLY_LINE]:El,[Jr.VTK_TRIANGLE]:Rq};function Pbe(t,e){e.classHierarchy.push("vtkPolyData");function n(i){return i.replace(/(?:^\w|[A-Z]|\b\w)/g,a=>a.toUpperCase()).replace(/\s+/g,"")}BT.forEach(i=>{t[`getNumberOf${n(i)}`]=()=>e[i].getNumberOfCells(),e[i]?e[i]=hc(e[i]):e[i]=Zh.newInstance()}),t.getNumberOfCells=()=>BT.reduce((i,a)=>i+e[a].getNumberOfCells(),0);const r=t.shallowCopy;t.shallowCopy=function(i){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;r(i,a),BT.forEach(o=>{e[o]=Zh.newInstance(),e[o].shallowCopy(i.getReferenceByName(o))})},t.buildCells=()=>{const i=t.getNumberOfVerts(),a=t.getNumberOfLines(),o=t.getNumberOfPolys(),s=t.getNumberOfStrips(),l=i+a+o+s,c=new Uint8Array(l);let f=c;const u=new Uint32Array(l);let d=u;if(i){let h=0;e.verts.getCellSizes().forEach((p,g)=>{d[g]=h,f[g]=p>1?Jr.VTK_POLY_VERTEX:Jr.VTK_VERTEX,h+=p+1}),d=d.subarray(i),f=f.subarray(i)}if(a){let h=0;e.lines.getCellSizes().forEach((p,g)=>{d[g]=h,f[g]=p>2?Jr.VTK_POLY_LINE:Jr.VTK_LINE,p===1&&SL("Building VTK_LINE ",g," with only one point, but VTK_LINE needs at least two points. Check the input."),h+=p+1}),d=d.subarray(a),f=f.subarray(a)}if(o){let h=0;e.polys.getCellSizes().forEach((p,g)=>{switch(d[g]=h,p){case 3:f[g]=Jr.VTK_TRIANGLE;break;case 4:f[g]=Jr.VTK_QUAD;break;default:f[g]=Jr.VTK_POLYGON;break}p<3&&SL("Building VTK_TRIANGLE ",g," with less than three points, but VTK_TRIANGLE needs at least three points. Check the input."),h+=p+1}),d+=d.subarray(o),f+=f.subarray(o)}if(s){let h=0;f.fill(Jr.VTK_TRIANGLE_STRIP,0,s),e.strips.getCellSizes().forEach((p,g)=>{d[g]=h,h+=p+1})}e.cells=Yxe.newInstance(),e.cells.setCellTypes(l,c,u)},t.buildLinks=function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;e.cells===void 0&&t.buildCells(),e.links=$xe.newInstance(),i>0?e.links.allocate(i):e.links.allocate(t.getPoints().getNumberOfPoints()),e.links.buildLinks(t)},t.getCellType=i=>e.cells.getCellType(i),t.getCellPoints=i=>{const a=t.getCellType(i);let o=null;switch(a){case Jr.VTK_VERTEX:case Jr.VTK_POLY_VERTEX:o=e.verts;break;case Jr.VTK_LINE:case Jr.VTK_POLY_LINE:o=e.lines;break;case Jr.VTK_TRIANGLE:case Jr.VTK_QUAD:case Jr.VTK_POLYGON:o=e.polys;break;case Jr.VTK_TRIANGLE_STRIP:o=e.strips;break;default:return o=null,{type:0,cellPointIds:null}}const s=e.cells.getCellLocation(i),l=o.getCell(s);return{cellType:a,cellPointIds:l}},t.getPointCells=i=>e.links.getCells(i),t.getCellEdgeNeighbors=(i,a,o)=>{const s=e.links.getLink(a),l=e.links.getLink(o);return s.cells.filter(c=>c!==i&&l.cells.indexOf(c)!==-1)},t.getCell=function(i){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const o=t.getCellPoints(i),s=a||Abe[o.cellType].newInstance();return s.initialize(t.getPoints(),o.cellPointIds),s}}const Nbe={};function Aq(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Nbe,n),_be.extend(t,e,n),le.get(t,e,["cells","links"]),le.setGet(t,e,["verts","lines","polys","strips"]),Pbe(t,e)}const Lbe=le.newInstance(Aq,"vtkPolyData");var ra={newInstance:Lbe,extend:Aq};const{vtkErrorMacro:kbe}=le;class Vbe{constructor(){this.segmentMapping={},this.segments=[null],this.faces=[]}addSegment(e){const n=e[0],r=e[e.length-1];if(n===r||e.length<2)return;const i=this.segmentMapping[n],a=this.segmentMapping[r];if(i!==void 0&&a!==void 0)if(Math.abs(i)===Math.abs(a)){const o=i<a?a:i,s=this.segments[o];if(i>0)for(let l=1;l<e.length-1;l++)s.push(e[l]);else for(let l=1;l<e.length-1;l++)s.unshift(e[e.length-1-l]);this.faces.push(s),this.segments[o]=null,this.segmentMapping[n]=void 0,this.segmentMapping[r]=void 0}else{const o=Math.abs(i),s=Math.abs(a),l=this.segments[o],c=this.segments[s];this.segments[o]=null,this.segments[s]=null,this.segmentMapping[l[0]]=void 0,this.segmentMapping[c[0]]=void 0,this.segmentMapping[l[l.length-1]]=void 0,this.segmentMapping[c[c.length-1]]=void 0,this.addSegment(e),this.addSegment(l),this.addSegment(c)}else if(i!==void 0){if(i>0){const o=this.segments[i];for(let s=1;s<e.length;s++)o.push(e[s]);this.segmentMapping[r]=i}else{const o=this.segments[-i];this.segmentMapping[r]=i;for(let s=1;s<e.length;s++)o.unshift(e[s])}this.segmentMapping[n]=void 0}else if(a!==void 0){if(a>0){const o=this.segments[a];for(let s=1;s<e.length;s++)o.push(e[e.length-1-s]);this.segmentMapping[n]=a}else{const o=this.segments[-a];this.segmentMapping[n]=a;for(let s=1;s<e.length;s++)o.unshift(e[e.length-s-1])}this.segmentMapping[r]=void 0}else{const o=this.segments.length;this.segments.push(e),this.segmentMapping[n]=-o,this.segmentMapping[r]=o}}}function Fbe(t,e){e.classHierarchy.push("vtkClosedPolyLineToSurfaceFilter"),t.requestData=(n,r)=>{const i=n[0];if(!i){kbe("Invalid or missing input");return}const a=ra.newInstance();a.shallowCopy(i);const o=new Vbe,s=i.getLines().getData();let l=0;for(;l<s.length;){const d=s[l++],h=[];for(let p=0;p<d;p++)h.push(s[l+p]);o.addSegment(h),l+=d}const{faces:c}=o;let f=c.length;for(let d=0;d<c.length;d++)f+=c[d].length;const u=new Uint16Array(f);l=0;for(let d=0;d<c.length;d++){const h=c[d];u[l++]=h.length;for(let p=0;p<h.length;p++)u[l++]=h[p]}a.setPolys(Zh.newInstance({values:u,name:"faces"})),r[0]=a}}const Ube={};function Pq(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Ube,n),le.obj(t,e),le.algo(t,e,1,1),Fbe(t,e)}const Bbe=le.newInstance(Pq,"vtkClosedPolyLineToSurfaceFilter");var $be={newInstance:Bbe,extend:Pq};const{vtkErrorMacro:TL}=po;function Gbe(t){const e=t.getPolys().getData(),n=t.getStrips().getData(),r={cellSize:0,cell:[],done:!1,polyIdx:0,stripIdx:0,remainingStripLength:0,next(){if(r.polyIdx<e.length){r.cellSize=e[r.polyIdx];const i=r.polyIdx+1,a=i+r.cellSize;r.polyIdx=a;let o=0;for(let s=i;s<a;++s)r.cell[o++]=e[s]}else if(r.stripIdx<n.length){r.cellSize=3,r.remainingStripLength===0&&(r.remainingStripLength=n[r.stripIdx]-2,r.stripIdx+=3);const i=r.stripIdx-2,a=r.stripIdx+1;r.stripIdx++,r.remainingStripLength--;let o=0;for(let s=i;s<a;++s)r.cell[o++]=n[s]}else if(!r.done)r.done=!0;else throw new Error("Iterator is done")}};return r.next(),r}function jbe(t,e){e.classHierarchy.push("vtkCutter");const n={...t};t.getMTime=()=>{let i=n.getMTime();return e.cutFunction&&(i=Math.max(i,e.cutFunction.getMTime())),i};function r(i,a){const o=i.getPoints(),s=o.getData(),l=o.getNumberOfPoints(),c=[],f=[],u=[];(!e.cutScalars||e.cutScalars.length<l)&&(e.cutScalars=new Float32Array(l));let d=0,h=0;for(;d<s.length;)e.cutScalars[h++]=e.cutFunction.evaluateFunction(s[d++],s[d++],s[d++]);const p=[],g=new Array(3),m=new Array(3),y=[];for(const x=Gbe(i);!x.done;x.next()){if(x.cellSize<=2)continue;for(let D=0;D<x.cellSize;)y[D]=e.cutScalars[x.cell[D++]];const w=y[0]>0;let S=!0;for(let D=1;D<x.cell.length;D++)if(y[D]>0!==w){S=!1;break}if(S)continue;const T=[];for(let D=0;D<x.cellSize;D++){const I=D+1===x.cellSize?0:D+1,R=y[D]>0;if(y[I]>0===R)continue;let A=D,L=I,P=y[L]-y[A];P<=0&&(A=I,L=D,P*=-1);let B=0;P!==0&&(B=(e.cutValue-y[A])/P);const U=x.cell[A],G=x.cell[L];g[0]=s[U*3],g[1]=s[U*3+1],g[2]=s[U*3+2],m[0]=s[G*3],m[1]=s[G*3+1],m[2]=s[G*3+2];const F=[g[0]+B*(m[0]-g[0]),g[1]+B*(m[1]-g[1]),g[2]+B*(m[2]-g[2])];T.push({pointEdge1:U,pointEdge2:G,intersectedPoint:F,newPointID:-1})}for(let D=0;D<T.length;D++){const I=T[D];let R=!1;for(let M=0;M<p.length;M++){const A=p[M],L=I.pointEdge1===A.pointEdge1&&I.pointEdge2===A.pointEdge2,P=I.intersectedPoint[0]===A.intersectedPoint[0]&&I.intersectedPoint[1]===A.intersectedPoint[1]&&I.intersectedPoint[2]===A.intersectedPoint[2];if(L||P){R=!0,T[D].newPointID=p[M].newPointID;break}}R||(c.push(I.intersectedPoint[0]),c.push(I.intersectedPoint[1]),c.push(I.intersectedPoint[2]),T[D].newPointID=c.length/3-1,p.push(T[D]))}const _=T.length;_===2?f.push(_,T[0].newPointID,T[1].newPointID):_>2&&(u.push(_),T.forEach(D=>{u.push(D.newPointID)}))}a.getPoints().setData(Fw(o.getDataType(),c),3),f.length!==0&&a.getLines().setData(Uint16Array.from(f)),u.length!==0&&a.getPolys().setData(Uint16Array.from(u))}t.requestData=(i,a)=>{const o=i[0];if(!o){TL("Invalid or missing input");return}if(!e.cutFunction){TL("Missing cut function");return}const s=ra.newInstance();r(o,s),a[0]=s}}const zbe={cutFunction:null,cutScalars:null,cutValue:0};function Nq(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,zbe,n),$r(t,e),E9(t,e,1,1),Mi(t,e,["cutFunction","cutValue"]),jbe(t,e)}const Wbe=Zn(Nq,"vtkCutter");var Hbe={newInstance:Wbe,extend:Nq};const Ef={ARRAY_BUFFER:0,ELEMENT_ARRAY_BUFFER:1,TEXTURE_BUFFER:2};var Lq={ObjectType:Ef};const{ObjectType:gb}=Lq,Kbe={};function qbe(t,e){e.classHierarchy.push("vtkOpenGLBufferObject");function n(s){switch(s){case gb.ELEMENT_ARRAY_BUFFER:return e.context.ELEMENT_ARRAY_BUFFER;case gb.TEXTURE_BUFFER:if("TEXTURE_BUFFER"in e.context)return e.context.TEXTURE_BUFFER;case gb.ARRAY_BUFFER:default:return e.context.ARRAY_BUFFER}}let r=null,i=null,a=!0,o="";t.getType=()=>r,t.setType=s=>{r=s},t.getHandle=()=>i,t.isReady=()=>a===!1,t.generateBuffer=s=>{const l=n(s);return i===null&&(i=e.context.createBuffer(),r=s),n(r)===l},t.upload=(s,l)=>t.generateBuffer(l)?(e.context.bindBuffer(n(r),i),e.context.bufferData(n(r),s,e.context.STATIC_DRAW),e.allocatedGPUMemoryInBytes=s.length*s.BYTES_PER_ELEMENT,a=!1,!0):(o="Trying to upload array buffer to incompatible buffer.",!1),t.bind=()=>i?(e.context.bindBuffer(n(r),i),!0):!1,t.release=()=>i?(e.context.bindBuffer(n(r),null),!0):!1,t.releaseGraphicsResources=()=>{i!==null&&(e.context.bindBuffer(n(r),null),e.context.deleteBuffer(i),i=null,e.allocatedGPUMemoryInBytes=0)},t.setOpenGLRenderWindow=s=>{e._openGLRenderWindow!==s&&(t.releaseGraphicsResources(),e._openGLRenderWindow=s,e.context=null,s&&(e.context=e._openGLRenderWindow.getContext()))},t.getError=()=>o}const Xbe={objectType:gb.ARRAY_BUFFER,context:null,allocatedGPUMemoryInBytes:0};function kq(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Xbe,n),le.obj(t,e),le.get(t,e,["_openGLRenderWindow","allocatedGPUMemoryInBytes"]),le.moveToProtected(t,e,["openGLRenderWindow"]),qbe(t,e)}const Ybe=le.newInstance(kq);var Cf={newInstance:Ybe,extend:kq,...Kbe,...Lq};const Vq={FLAT:0,GOURAUD:1,PHONG:2},so={POINTS:0,WIREFRAME:1,SURFACE:2},Jbe=Vq;var Fq={Shading:Vq,Representation:so,Interpolation:Jbe};const{vtkErrorMacro:EL}=le;function Zbe(t,e){const n=new Float64Array(3);_K(n,e);const r=new Float64Array(16);return xK(r,Jh(),t,n),r}function Qbe(t,e){return t===null||e===null?!1:!(gL(t,[0,0,0])&&gL(e,[1,1,1]))}function e3e(t,e){e.classHierarchy.push("vtkOpenGLCellArrayBufferObject"),t.setType(Ef.ARRAY_BUFFER),t.createVBO=function(n,r,i,a){let o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null;if(!n.getData()||!n.getData().length)return e.elementCount=0,0;e.blockSize=3,e.vertexOffset=0,e.normalOffset=0,e.tCoordOffset=0,e.tCoordComponents=0,e.colorComponents=0,e.colorOffset=0,e.customData=[];const s=a.points.getData();let l=null,c=null,f=null;const u=a.colors?a.colors.getNumberOfComponents():0,d=a.tcoords?a.tcoords.getNumberOfComponents():0;a.normals&&(e.normalOffset=4*e.blockSize,e.blockSize+=3,l=a.normals.getData()),a.customAttributes&&a.customAttributes.forEach($=>{$&&(e.customData.push({data:$.getData(),offset:4*e.blockSize,components:$.getNumberOfComponents(),name:$.getName()}),e.blockSize+=$.getNumberOfComponents())}),a.tcoords&&(e.tCoordOffset=4*e.blockSize,e.tCoordComponents=d,e.blockSize+=d,c=a.tcoords.getData()),a.colors?(e.colorComponents=a.colors.getNumberOfComponents(),e.colorOffset=0,f=a.colors.getData(),e.colorBO||(e.colorBO=Cf.newInstance()),e.colorBO.setOpenGLRenderWindow(e._openGLRenderWindow)):e.colorBO=null,e.stride=4*e.blockSize;let h=0,p=0,g=0,m=0,y=0,v=0,x;const w={anythingToPoints($,V,X,Q){for(let re=0;re<$;++re)x(V[X+re],Q)},linesToWireframe($,V,X,Q){for(let re=0;re<$-1;++re)x(V[X+re],Q),x(V[X+re+1],Q)},polysToWireframe($,V,X,Q){if($>2)for(let re=0;re<$;++re)x(V[X+re],Q),x(V[X+(re+1)%$],Q)},stripsToWireframe($,V,X,Q){if($>2){for(let re=0;re<$-1;++re)x(V[X+re],Q),x(V[X+re+1],Q);for(let re=0;re<$-2;re++)x(V[X+re],Q),x(V[X+re+2],Q)}},polysToSurface($,V,X,Q){for(let re=0;re<$-2;re++)x(V[X+0],Q),x(V[X+re+1],Q),x(V[X+re+2],Q)},stripsToSurface($,V,X,Q){for(let re=0;re<$-2;re++)x(V[X+re],Q),x(V[X+re+1+re%2],Q),x(V[X+re+1+(re+1)%2],Q)}},S={anythingToPoints($,V){return $},linesToWireframe($,V){return $>1?($-1)*2:0},polysToWireframe($,V){return $>2?$*2:0},stripsToWireframe($,V){return $>2?$*4-6:0},polysToSurface($,V){return $>2?($-2)*3:0},stripsToSurface($,V,X){return $>2?($-2)*3:0}};let T=null,_=null;i===so.POINTS||r==="verts"?(T=w.anythingToPoints,_=S.anythingToPoints):i===so.WIREFRAME||r==="lines"?(T=w[`${r}ToWireframe`],_=S[`${r}ToWireframe`]):(T=w[`${r}ToSurface`],_=S[`${r}ToSurface`]);const D=n.getData(),I=D.length;let R=0;for(let $=0;$<I;)R+=_(D[$],D),$+=D[$]+1;let M=null;const A=new Float32Array(R*e.blockSize);f&&(M=new Uint8Array(R*4));let L=0,P=0,B=0,U=0;for(let $=0;$<3;++$){const V=a.points.getRange($),X=V[1]-V[0];B+=X*X;const Q=.5*(V[1]+V[0]);U+=Q*Q}if(B>0&&(Math.abs(U)/B>1e6||Math.abs(Math.log10(B))>3||B===0&&U>1e6)){const $=new Float64Array(3),V=new Float64Array(3);for(let X=0;X<3;++X){const Q=a.points.getRange(X),re=Q[1]-Q[0];$[X]=.5*(Q[1]+Q[0]),V[X]=re>0?1/re:1}t.setCoordShiftAndScale($,V)}else e.coordShiftAndScaleEnabled===!0&&t.setCoordShiftAndScale(null,null);if(o)if(!o.points&&!o.cells)o.points=new Int32Array(R),o.cells=new Int32Array(R);else{const $=new Int32Array(R+o.points.length);$.set(o.points),o.points=$;const V=new Int32Array(R+o.cells.length);V.set(o.cells),o.cells=V}let F=a.vertexOffset;x=function(V,X){if(o&&(o.points[F]=V,o.cells[F]=v+a.cellOffset),++F,h=V*3,e.coordShiftAndScaleEnabled?(A[L++]=(s[h++]-e.coordShift[0])*e.coordScale[0],A[L++]=(s[h++]-e.coordShift[1])*e.coordScale[1],A[L++]=(s[h++]-e.coordShift[2])*e.coordScale[2]):(A[L++]=s[h++],A[L++]=s[h++],A[L++]=s[h++]),l!==null&&(a.haveCellNormals?p=(v+a.cellOffset)*3:p=V*3,A[L++]=l[p++],A[L++]=l[p++],A[L++]=l[p++]),e.customData.forEach(Q=>{y=V*Q.components;for(let re=0;re<Q.components;++re)A[L++]=Q.data[y++]}),c!==null){a.useTCoordsPerCell?g=X*d:g=V*d;for(let Q=0;Q<d;++Q)A[L++]=c[g++]}f!==null&&(a.haveCellScalars?m=(v+a.cellOffset)*u:m=V*u,M[P++]=f[m++],M[P++]=f[m++],M[P++]=f[m++],M[P++]=u===4?f[m++]:255)};for(let $=0;$<I;$+=D[$]+1,v++)T(D[$],D,$+1,v+a.cellOffset);return e.elementCount=R,t.upload(A,Ef.ARRAY_BUFFER),e.colorBO&&(e.colorBOStride=4,e.colorBO.upload(M,Ef.ARRAY_BUFFER)),v},t.setCoordShiftAndScale=(n,r)=>{if(n!==null&&(n.constructor!==Float64Array||n.length!==3)){EL("Wrong type for coordShift, expected vec3 or null");return}if(r!==null&&(r.constructor!==Float64Array||r.length!==3)){EL("Wrong type for coordScale, expected vec3 or null");return}(e.coordShift===null||n===null||!mL(n,e.coordShift))&&(e.coordShift=n),(e.coordScale===null||r===null||!mL(r,e.coordScale))&&(e.coordScale=r),e.coordShiftAndScaleEnabled=Qbe(e.coordShift,e.coordScale),e.coordShiftAndScaleEnabled?e.inverseShiftAndScaleMatrix=Zbe(e.coordShift,e.coordScale):e.inverseShiftAndScaleMatrix=null}}const t3e={elementCount:0,stride:0,colorBOStride:0,vertexOffset:0,normalOffset:0,tCoordOffset:0,tCoordComponents:0,colorOffset:0,colorComponents:0,tcoordBO:null,customData:[],coordShift:null,coordScale:null,coordShiftAndScaleEnabled:!1,inverseShiftAndScaleMatrix:null};function Uq(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,t3e,n),Cf.extend(t,e,n),le.setGet(t,e,["colorBO","elementCount","stride","colorBOStride","vertexOffset","normalOffset","tCoordOffset","tCoordComponents","colorOffset","colorComponents","customData"]),le.get(t,e,["coordShift","coordScale","coordShiftAndScaleEnabled","inverseShiftAndScaleMatrix"]),e3e(t,e)}const n3e=le.newInstance(Uq);var r3e={newInstance:n3e,extend:Uq};const{vtkErrorMacro:i3e}=le;function a3e(t,e){e.classHierarchy.push("vtkShader"),t.compile=()=>{let n=e.context.VERTEX_SHADER;if(!e.source||!e.source.length||e.shaderType==="Unknown")return!1;switch(e.handle!==0&&(e.context.deleteShader(e.handle),e.handle=0),e.shaderType){case"Fragment":n=e.context.FRAGMENT_SHADER;break;case"Vertex":default:n=e.context.VERTEX_SHADER;break}if(e.handle=e.context.createShader(n),e.context.shaderSource(e.handle,e.source),e.context.compileShader(e.handle),!e.context.getShaderParameter(e.handle,e.context.COMPILE_STATUS)){const i=e.context.getShaderInfoLog(e.handle);return i3e(`Error compiling shader '${e.source}': ${i}`),e.context.deleteShader(e.handle),e.handle=0,!1}return!0},t.cleanup=()=>{e.shaderType==="Unknown"||e.handle===0||(e.context.deleteShader(e.handle),e.handle=0,e.dirty=!0)}}const o3e={shaderType:"Unknown",source:"",error:"",handle:0,dirty:!1,context:null};function Bq(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,o3e,n),le.obj(t,e),le.setGet(t,e,["shaderType","source","error","handle","context"]),a3e(t,e)}const s3e=le.newInstance(Bq,"vtkShader");var $T={newInstance:s3e,extend:Bq};const{vtkErrorMacro:Gc}=le;function l3e(t,e,n,r){const i=typeof n=="string"?n:n.join(`
`),a=r===!1?e:new RegExp(e,"g"),o=t.replace(a,i);return{replace:o!==i,result:o}}function c3e(t,e){e.classHierarchy.push("vtkShaderProgram"),t.compileShader=()=>e.vertexShader.compile()?e.fragmentShader.compile()?!t.attachShader(e.vertexShader)||!t.attachShader(e.fragmentShader)?(Gc(e.error),0):t.link()?(t.setCompiled(!0),1):(Gc(`Links failed: ${e.error}`),0):(Gc(e.fragmentShader.getSource().split(`
`).map((n,r)=>`${r}: ${n}`).join(`
`)),Gc(e.fragmentShader.getError()),0):(Gc(e.vertexShader.getSource().split(`
`).map((n,r)=>`${r}: ${n}`).join(`
`)),Gc(e.vertexShader.getError()),0),t.cleanup=()=>{e.shaderType==="Unknown"||e.handle===0||(t.release(),e.vertexShaderHandle!==0&&(e.context.detachShader(e.handle,e.vertexShaderHandle),e.vertexShaderHandle=0),e.fragmentShaderHandle!==0&&(e.context.detachShader(e.handle,e.fragmentShaderHandle),e.fragmentShaderHandle=0),e.context.deleteProgram(e.handle),e.handle=0,t.setCompiled(!1))},t.bind=()=>!e.linked&&!t.link()?!1:(e.context.useProgram(e.handle),t.setBound(!0),!0),t.isBound=()=>!!e.bound,t.release=()=>{e.context.useProgram(null),t.setBound(!1)},t.setContext=n=>{e.vertexShader.setContext(n),e.fragmentShader.setContext(n),e.geometryShader.setContext(n)},t.link=()=>{if(e.linked)return!0;if(e.handle===0)return e.error="Program has not been initialized, and/or does not have shaders.",!1;if(e.uniformLocs={},e.context.linkProgram(e.handle),!e.context.getProgramParameter(e.handle,e.context.LINK_STATUS)){const r=e.context.getProgramInfoLog(e.handle);return Gc(`Error linking shader ${r}`),e.handle=0,!1}return t.setLinked(!0),e.attributeLocs={},!0},t.setUniformMatrix=(n,r)=>{const i=t.findUniform(n);if(i===-1)return e.error=`Could not set uniform ${n} . No such uniform.`,!1;const a=new Float32Array(r);return e.context.uniformMatrix4fv(i,!1,a),!0},t.setUniformMatrix3x3=(n,r)=>{const i=t.findUniform(n);if(i===-1)return e.error=`Could not set uniform ${n} . No such uniform.`,!1;const a=new Float32Array(r);return e.context.uniformMatrix3fv(i,!1,a),!0},t.setUniformf=(n,r)=>{const i=t.findUniform(n);return i===-1?(e.error=`Could not set uniform ${n} . No such uniform.`,!1):(e.context.uniform1f(i,r),!0)},t.setUniformfv=(n,r)=>{const i=t.findUniform(n);return i===-1?(e.error=`Could not set uniform ${n} . No such uniform.`,!1):(e.context.uniform1fv(i,r),!0)},t.setUniformi=(n,r)=>{const i=t.findUniform(n);return i===-1?(e.error=`Could not set uniform ${n} . No such uniform.`,!1):(e.context.uniform1i(i,r),!0)},t.setUniformiv=(n,r)=>{const i=t.findUniform(n);return i===-1?(e.error=`Could not set uniform ${n} . No such uniform.`,!1):(e.context.uniform1iv(i,r),!0)},t.setUniform2f=(n,r,i)=>{const a=t.findUniform(n);if(a===-1)return e.error=`Could not set uniform ${n} . No such uniform.`,!1;if(i===void 0)throw new RangeError("Invalid number of values for array");return e.context.uniform2f(a,r,i),!0},t.setUniform2fv=(n,r)=>{const i=t.findUniform(n);return i===-1?(e.error=`Could not set uniform ${n} . No such uniform.`,!1):(e.context.uniform2fv(i,r),!0)},t.setUniform2i=(n,r,i)=>{const a=t.findUniform(n);if(a===-1)return e.error=`Could not set uniform ${n} . No such uniform.`,!1;if(i===void 0)throw new RangeError("Invalid number of values for array");return e.context.uniform2i(a,r,i),!0},t.setUniform2iv=(n,r)=>{const i=t.findUniform(n);return i===-1?(e.error=`Could not set uniform ${n} . No such uniform.`,!1):(e.context.uniform2iv(i,r),!0)},t.setUniform3f=(n,r,i,a)=>{const o=t.findUniform(n);if(o===-1)return e.error=`Could not set uniform ${n} . No such uniform.`,!1;if(a===void 0)throw new RangeError("Invalid number of values for array");return e.context.uniform3f(o,r,i,a),!0},t.setUniform3fArray=(n,r)=>{const i=t.findUniform(n);if(i===-1)return e.error=`Could not set uniform ${n} . No such uniform.`,!1;if(!Array.isArray(r)||r.length!==3)throw new RangeError("Invalid number of values for array");return e.context.uniform3f(i,r[0],r[1],r[2]),!0},t.setUniform3fv=(n,r)=>{const i=t.findUniform(n);return i===-1?(e.error=`Could not set uniform ${n} . No such uniform.`,!1):(e.context.uniform3fv(i,r),!0)},t.setUniform3i=function(n){const r=t.findUniform(n);if(r===-1)return e.error=`Could not set uniform ${n} . No such uniform.`,!1;for(var i=arguments.length,a=new Array(i>1?i-1:0),o=1;o<i;o++)a[o-1]=arguments[o];let s=a;if(s.length===1&&Array.isArray(s[0])&&(s=s[0]),s.length!==3)throw new RangeError("Invalid number of values for array");return e.context.uniform3i(r,s[0],s[1],s[2]),!0},t.setUniform3iv=(n,r)=>{const i=t.findUniform(n);return i===-1?(e.error=`Could not set uniform ${n} . No such uniform.`,!1):(e.context.uniform3iv(i,r),!0)},t.setUniform4f=function(n){const r=t.findUniform(n);if(r===-1)return e.error=`Could not set uniform ${n} . No such uniform.`,!1;for(var i=arguments.length,a=new Array(i>1?i-1:0),o=1;o<i;o++)a[o-1]=arguments[o];let s=a;if(s.length===1&&Array.isArray(s[0])&&(s=s[0]),s.length!==4)throw new RangeError("Invalid number of values for array");return e.context.uniform4f(r,s[0],s[1],s[2],s[3]),!0},t.setUniform4fv=(n,r)=>{const i=t.findUniform(n);return i===-1?(e.error=`Could not set uniform ${n} . No such uniform.`,!1):(e.context.uniform4fv(i,r),!0)},t.setUniform4i=function(n){const r=t.findUniform(n);if(r===-1)return e.error=`Could not set uniform ${n} . No such uniform.`,!1;for(var i=arguments.length,a=new Array(i>1?i-1:0),o=1;o<i;o++)a[o-1]=arguments[o];let s=a;if(s.length===1&&Array.isArray(s[0])&&(s=s[0]),s.length!==4)throw new RangeError("Invalid number of values for array");return e.context.uniform4i(r,s[0],s[1],s[2],s[3]),!0},t.setUniform4iv=(n,r)=>{const i=t.findUniform(n);return i===-1?(e.error=`Could not set uniform ${n} . No such uniform.`,!1):(e.context.uniform4iv(i,r),!0)},t.findUniform=n=>{if(!n||!e.linked)return-1;let r=e.uniformLocs[n];return r!==void 0?r:(r=e.context.getUniformLocation(e.handle,n),r===null?(e.error=`Uniform ${n} not found in current shader program.`,e.uniformLocs[n]=-1,-1):(e.uniformLocs[n]=r,r))},t.isUniformUsed=n=>{if(!n)return!1;let r=e.uniformLocs[n];return r!==void 0?r!==null:e.linked?(r=e.context.getUniformLocation(e.handle,n),e.uniformLocs[n]=r,r!==null):(Gc("attempt to find uniform when the shader program is not linked"),!1)},t.isAttributeUsed=n=>{if(!n)return!1;if(n in e.attributeLocs)return!0;if(!e.linked)return Gc("attempt to find uniform when the shader program is not linked"),!1;const r=e.context.getAttribLocation(e.handle,n);return r===-1?!1:(e.attributeLocs[n]=r,!0)},t.attachShader=n=>{if(n.getHandle()===0)return e.error="Shader object was not initialized, cannot attach it.",!1;if(n.getShaderType()==="Unknown")return e.error="Shader object is of type Unknown and cannot be used.",!1;if(e.handle===0){const r=e.context.createProgram();if(r===0)return e.error="Could not create shader program.",!1;e.handle=r,e.linked=!1}return n.getShaderType()==="Vertex"&&(e.vertexShaderHandle!==0&&e.context.detachShader(e.handle,e.vertexShaderHandle),e.vertexShaderHandle=n.getHandle()),n.getShaderType()==="Fragment"&&(e.fragmentShaderHandle!==0&&e.context.detachShader(e.handle,e.fragmentShaderHandle),e.fragmentShaderHandle=n.getHandle()),e.context.attachShader(e.handle,n.getHandle()),t.setLinked(!1),!0},t.detachShader=n=>{if(n.getHandle()===0)return e.error="shader object was not initialized, cannot attach it.",!1;if(n.getShaderType()==="Unknown")return e.error="Shader object is of type Unknown and cannot be used.",!1;switch(e.handle===0&&(e.error="This shader program has not been initialized yet."),n.getShaderType()){case"Vertex":return e.vertexShaderHandle!==n.getHandle()?(e.error="The supplied shader was not attached to this program.",!1):(e.context.detachShader(e.handle,n.getHandle()),e.vertexShaderHandle=0,e.linked=!1,!0);case"Fragment":return e.fragmentShaderHandle!==n.getHandle()?(e.error="The supplied shader was not attached to this program.",!1):(e.context.detachShader(e.handle,n.getHandle()),e.fragmentShaderHandle=0,e.linked=!1,!0);default:return!1}},t.setContext=n=>{e.context=n,e.vertexShader.setContext(n),e.fragmentShader.setContext(n),e.geometryShader.setContext(n)},t.setLastCameraMTime=n=>{e.lastCameraMTime=n}}const u3e={vertexShaderHandle:0,fragmentShaderHandle:0,geometryShaderHandle:0,vertexShader:null,fragmentShader:null,geometryShader:null,linked:!1,bound:!1,compiled:!1,error:"",handle:0,numberOfOutputs:0,attributesLocs:null,uniformLocs:null,md5Hash:0,context:null,lastCameraMTime:null};function $q(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,u3e,n),e.attributesLocs={},e.uniformLocs={},e.vertexShader=$T.newInstance(),e.vertexShader.setShaderType("Vertex"),e.fragmentShader=$T.newInstance(),e.fragmentShader.setShaderType("Fragment"),e.geometryShader=$T.newInstance(),e.geometryShader.setShaderType("Geometry"),le.obj(t,e),le.get(t,e,["lastCameraMTime"]),le.setGet(t,e,["error","handle","compiled","bound","md5Hash","vertexShader","fragmentShader","geometryShader","linked"]),c3e(t,e)}const f3e=le.newInstance($q,"vtkShaderProgram");var Be={newInstance:f3e,extend:$q,substitute:l3e};function d3e(t,e){e.classHierarchy.push("vtkOpenGLVertexArrayObject"),t.exposedMethod=()=>{},t.initialize=()=>{e.instancingExtension=null,e._openGLRenderWindow.getWebgl2()||(e.instancingExtension=e.context.getExtension("ANGLE_instanced_arrays")),!e.forceEmulation&&e._openGLRenderWindow&&e._openGLRenderWindow.getWebgl2()?(e.extension=null,e.supported=!0,e.handleVAO=e.context.createVertexArray()):(e.extension=e.context.getExtension("OES_vertex_array_object"),!e.forceEmulation&&e.extension?(e.supported=!0,e.handleVAO=e.extension.createVertexArrayOES()):e.supported=!1)},t.isReady=()=>e.handleVAO!==0||e.supported===!1,t.bind=()=>{if(t.isReady()||t.initialize(),t.isReady()&&e.supported)e.extension?e.extension.bindVertexArrayOES(e.handleVAO):e.context.bindVertexArray(e.handleVAO);else if(t.isReady()){const n=e.context;for(let r=0;r<e.buffers.length;++r){const i=e.buffers[r];e.context.bindBuffer(n.ARRAY_BUFFER,i.buffer);for(let a=0;a<i.attributes.length;++a){const o=i.attributes[a],s=o.isMatrix?o.size:1;for(let l=0;l<s;++l)n.enableVertexAttribArray(o.index+l),n.vertexAttribPointer(o.index+l,o.size,o.type,o.normalize,o.stride,o.offset+o.stride*l/o.size),o.divisor>0&&(e.instancingExtension?e.instancingExtension.vertexAttribDivisorANGLE(o.index+l,1):n.vertexAttribDivisor(o.index+l,1))}}}},t.release=()=>{if(t.isReady()&&e.supported)e.extension?e.extension.bindVertexArrayOES(null):e.context.bindVertexArray(null);else if(t.isReady()){const n=e.context;for(let r=0;r<e.buffers.length;++r){const i=e.buffers[r];e.context.bindBuffer(n.ARRAY_BUFFER,i.buffer);for(let a=0;a<i.attributes.length;++a){const o=i.attributes[a],s=o.isMatrix?o.size:1;for(let l=0;l<s;++l)n.enableVertexAttribArray(o.index+l),n.vertexAttribPointer(o.index+l,o.size,o.type,o.normalize,o.stride,o.offset+o.stride*l/o.size),o.divisor>0&&(e.instancingExtension?e.instancingExtension.vertexAttribDivisorANGLE(o.index+l,0):n.vertexAttribDivisor(o.index+l,0)),n.disableVertexAttribArray(o.index+l)}}}},t.shaderProgramChanged=()=>{t.release(),e.handleVAO&&(e.extension?e.extension.deleteVertexArrayOES(e.handleVAO):e.context.deleteVertexArray(e.handleVAO)),e.handleVAO=0,e.handleProgram=0},t.releaseGraphicsResources=()=>{t.shaderProgramChanged(),e.handleVAO&&(e.extension?e.extension.deleteVertexArrayOES(e.handleVAO):e.context.deleteVertexArray(e.handleVAO)),e.handleVAO=0,e.supported=!0,e.handleProgram=0},t.addAttributeArray=(n,r,i,a,o,s,l,c)=>t.addAttributeArrayWithDivisor(n,r,i,a,o,s,l,c,0,!1),t.addAttributeArrayWithDivisor=(n,r,i,a,o,s,l,c,f,u)=>{if(!n||!n.isBound()||r.getHandle()===0||r.getType()!==Ef.ARRAY_BUFFER||(e.handleProgram===0&&(e.handleProgram=n.getHandle()),t.isReady()||t.initialize(),!t.isReady()||e.handleProgram!==n.getHandle()))return!1;const d=e.context,h={};if(h.name=i,h.index=d.getAttribLocation(e.handleProgram,i),h.offset=a,h.stride=o,h.type=s,h.size=l,h.normalize=c,h.isMatrix=u,h.divisor=f,h.Index===-1)return!1;if(r.bind(),d.enableVertexAttribArray(h.index),d.vertexAttribPointer(h.index,h.size,h.type,h.normalize,h.stride,h.offset),f>0&&(e.instancingExtension?e.instancingExtension.vertexAttribDivisorANGLE(h.index,1):d.vertexAttribDivisor(h.index,1)),h.buffer=r.getHandle(),!e.supported){let p=!1;for(let g=0;g<e.buffers.length;++g){const m=e.buffers[g];if(m.buffer===h.buffer){p=!0;let y=!1;for(let v=0;v<m.attributes.length;++v)m.attributes[v].name===i&&(y=!0,m.attributes[v]=h);y||m.attributes.push(h)}}p||e.buffers.push({buffer:h.buffer,attributes:[h]})}return!0},t.addAttributeMatrixWithDivisor=(n,r,i,a,o,s,l,c,f)=>{const u=t.addAttributeArrayWithDivisor(n,r,i,a,o,s,l,c,f,!0);if(!u)return u;const d=e.context,h=d.getAttribLocation(e.handleProgram,i);for(let p=1;p<l;p++)d.enableVertexAttribArray(h+p),d.vertexAttribPointer(h+p,l,s,c,o,a+o*p/l),f>0&&(e.instancingExtension?e.instancingExtension.vertexAttribDivisorANGLE(h+p,1):d.vertexAttribDivisor(h+p,1));return!0},t.removeAttributeArray=n=>{if(!t.isReady()||e.handleProgram===0)return!1;if(!e.supported)for(let r=0;r<e.buffers.length;++r){const i=e.buffers[r];for(let a=0;a<i.attributes.length;++a)if(i.attributes[a].name===n)return i.attributes.splice(a,1),i.attributes.length||e.buffers.splice(r,1),!0}return!0},t.setOpenGLRenderWindow=n=>{e._openGLRenderWindow!==n&&(t.releaseGraphicsResources(),e._openGLRenderWindow=n,e.context=null,n&&(e.context=e._openGLRenderWindow.getContext()))}}const h3e={forceEmulation:!1,handleVAO:0,handleProgram:0,supported:!0,buffers:null,context:null};function Gq(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,h3e,n),e.buffers=[],le.obj(t,e),le.get(t,e,["supported"]),le.setGet(t,e,["forceEmulation"]),d3e(t,e)}const p3e=le.newInstance(Gq,"vtkOpenGLVertexArrayObject");var pD={newInstance:p3e,extend:Gq};const Cd={Start:0,Points:0,Lines:1,Tris:2,TriStrips:3,TrisEdges:4,TriStripsEdges:5,End:6};function g3e(t,e){e.classHierarchy.push("vtkOpenGLHelper"),t.setOpenGLRenderWindow=n=>{e.context=n.getContext(),e.program.setContext(e.context),e.VAO.setOpenGLRenderWindow(n),e.CABO.setOpenGLRenderWindow(n)},t.releaseGraphicsResources=n=>{e.VAO.releaseGraphicsResources(),e.CABO.releaseGraphicsResources(),e.CABO.setElementCount(0)},t.drawArrays=(n,r,i,a)=>{if(e.CABO.getElementCount()){const o=t.getOpenGLMode(i),s=t.haveWideLines(n,r),l=e.context,c=l.getParameter(l.DEPTH_WRITEMASK);e.pointPicking&&l.depthMask(!1),o===l.LINES&&s?(t.updateShaders(n,r,a),l.drawArraysInstanced(o,0,e.CABO.getElementCount(),2*Math.ceil(r.getProperty().getLineWidth()))):(l.lineWidth(r.getProperty().getLineWidth()),t.updateShaders(n,r,a),l.drawArrays(o,0,e.CABO.getElementCount()),l.lineWidth(1));const u=(o===l.POINTS?1:0)||(o===l.LINES?2:3);return e.pointPicking&&l.depthMask(c),e.CABO.getElementCount()/u}return 0},t.getOpenGLMode=n=>{if(e.pointPicking)return e.context.POINTS;const r=e.primitiveType;return n===so.POINTS||r===Cd.Points?e.context.POINTS:n===so.WIREFRAME||r===Cd.Lines||r===Cd.TrisEdges||r===Cd.TriStripsEdges?e.context.LINES:e.context.TRIANGLES},t.haveWideLines=(n,r)=>r.getProperty().getLineWidth()>1?!(e.CABO.getOpenGLRenderWindow()&&e.CABO.getOpenGLRenderWindow().getHardwareMaximumLineWidth()>=r.getProperty().getLineWidth()):!1,t.getNeedToRebuildShaders=(n,r,i)=>!!(i.getNeedToRebuildShaders(t,n,r)||t.getProgram()===0||t.getShaderSourceTime().getMTime()<i.getMTime()||t.getShaderSourceTime().getMTime()<r.getMTime()),t.updateShaders=(n,r,i)=>{if(t.getNeedToRebuildShaders(n,r,i)){const a={Vertex:null,Fragment:null,Geometry:null};i.buildShaders(a,n,r);const o=e.CABO.getOpenGLRenderWindow().getShaderCache().readyShaderProgramArray(a.Vertex,a.Fragment,a.Geometry);o!==t.getProgram()&&(t.setProgram(o),t.getVAO().releaseGraphicsResources()),t.getShaderSourceTime().modified()}else e.CABO.getOpenGLRenderWindow().getShaderCache().readyShaderProgram(t.getProgram());t.getVAO().bind(),i.setMapperShaderParameters(t,n,r),i.setPropertyShaderParameters(t,n,r),i.setCameraShaderParameters(t,n,r),i.setLightingShaderParameters(t,n,r),i.invokeShaderCallbacks(t,n,r)},t.setMapperShaderParameters=(n,r,i)=>{if(t.haveWideLines(n,r)){t.getProgram().setUniform2f("viewportSize",i.usize,i.vsize);const a=parseFloat(r.getProperty().getLineWidth()),o=a/2;t.getProgram().setUniformf("lineWidthStepSize",a/Math.ceil(a)),t.getProgram().setUniformf("halfLineWidth",o)}e.primitiveType===Cd.Points||r.getProperty().getRepresentation()===so.POINTS?t.getProgram().setUniformf("pointSize",r.getProperty().getPointSize()):e.pointPicking&&t.getProgram().setUniformf("pointSize",t.getPointPickingPrimitiveSize())},t.replaceShaderPositionVC=(n,r,i)=>{let a=n.Vertex;a=Be.substitute(a,"//VTK::PositionVC::Dec",["//VTK::PositionVC::Dec","uniform float pointSize;"]).result,a=Be.substitute(a,"//VTK::PositionVC::Impl",["//VTK::PositionVC::Impl","  gl_PointSize = pointSize;"],!1).result,t.getOpenGLMode(i.getProperty().getRepresentation())===e.context.LINES&&t.haveWideLines(r,i)&&(a=Be.substitute(a,"//VTK::PositionVC::Dec",["//VTK::PositionVC::Dec","uniform vec2 viewportSize;","uniform float lineWidthStepSize;","uniform float halfLineWidth;"]).result,a=Be.substitute(a,"//VTK::PositionVC::Impl",["//VTK::PositionVC::Impl"," if (halfLineWidth > 0.0)","   {","   float offset = float(gl_InstanceID / 2) * lineWidthStepSize - halfLineWidth;","   vec4 tmpPos = gl_Position;","   vec3 tmpPos2 = tmpPos.xyz / tmpPos.w;","   tmpPos2.x = tmpPos2.x + 2.0 * mod(float(gl_InstanceID), 2.0) * offset / viewportSize[0];","   tmpPos2.y = tmpPos2.y + 2.0 * mod(float(gl_InstanceID + 1), 2.0) * offset / viewportSize[1];","   gl_Position = vec4(tmpPos2.xyz * tmpPos.w, tmpPos.w);","   }"]).result),n.Vertex=a},t.getPointPickingPrimitiveSize=()=>e.primitiveType===Cd.Points?2:e.primitiveType===Cd.Lines?4:6,t.getAllocatedGPUMemoryInBytes=()=>t.getCABO().getAllocatedGPUMemoryInBytes()}const m3e={context:null,program:null,shaderSourceTime:null,VAO:null,attributeUpdateTime:null,CABO:null,primitiveType:0,pointPicking:!1};function jq(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,m3e,n),le.obj(t,e),e.shaderSourceTime={},le.obj(e.shaderSourceTime),e.attributeUpdateTime={},le.obj(e.attributeUpdateTime),le.setGet(t,e,["program","shaderSourceTime","VAO","attributeUpdateTime","CABO","primitiveType","pointPicking"]),e.program=Be.newInstance(),e.VAO=pD.newInstance(),e.CABO=r3e.newInstance(),g3e(t,e)}const v3e=le.newInstance(jq);var Tu={newInstance:v3e,extend:jq,primTypes:Cd};const y3e=t=>t,_L=1e-6;let zq=class{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.matrix=sn(new Float64Array(16)),this.tmp=new Float64Array(3),this.angleConv=e?yye:y3e}rotateFromDirections(e,n){const r=new Float64Array(3),i=new Float64Array(3),a=new Float64Array(16);Lr(r,e[0],e[1],e[2]),Lr(i,n[0],n[1],n[2]),mc(r,r),mc(i,i);const o=b2(r,i);return o>=1?this:(zg(this.tmp,r,i),jg(this.tmp)<_L&&(zg(this.tmp,[1,0,0],e),jg(this.tmp)<_L&&zg(this.tmp,[0,1,0],e)),mK(a,Math.acos(o),this.tmp),jn(this.matrix,this.matrix,a),this)}rotate(e,n){return Lr(this.tmp,...n),mc(this.tmp,this.tmp),rc(this.matrix,this.matrix,this.angleConv(e),this.tmp),this}rotateX(e){return J9(this.matrix,this.matrix,this.angleConv(e)),this}rotateY(e){return Z9(this.matrix,this.matrix,this.angleConv(e)),this}rotateZ(e){return Q9(this.matrix,this.matrix,this.angleConv(e)),this}translate(e,n,r){return Lr(this.tmp,e,n,r),si(this.matrix,this.matrix,this.tmp),this}scale(e,n,r){return Lr(this.tmp,e,n,r),p0(this.matrix,this.matrix,this.tmp),this}multiply(e){return jn(this.matrix,this.matrix,e),this}multiply3x3(e){return jn(this.matrix,this.matrix,[e[0],e[1],e[2],0,e[3],e[4],e[5],0,e[6],e[7],e[8],0,0,0,0,1]),this}invert(){return ba(this.matrix,this.matrix),this}identity(){return sn(this.matrix),this}apply(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1;if(ty(I9,this.matrix))return this;const i=r===-1?e.length:n+r*3;for(let a=n;a<i;a+=3)Lr(this.tmp,e[a],e[a+1],e[a+2]),$n(this.tmp,this.tmp,this.matrix),e[a]=this.tmp[0],e[a+1]=this.tmp[1],e[a+2]=this.tmp[2];return this}getMatrix(){return this.matrix}setMatrix(e){return e&&e.length===16&&Ei(this.matrix,e),this}};function x3e(){return new zq(!0)}function b3e(){return new zq(!1)}var Jd={buildFromDegree:x3e,buildFromRadian:b3e};const w3e=[2,0,1,2,2,3,2,4,5,2,6,7,2,0,2,2,1,3,2,4,6,2,5,7,2,0,4,2,1,5,2,2,6,2,3,7],C3e=[4,0,1,3,2,4,4,6,7,5,4,8,10,11,9,4,12,13,15,14,4,16,18,19,17,4,20,21,23,22];function S3e(t,e){e.classHierarchy.push("vtkCubeSource");function n(r,i){if(e.deleted)return;const a=ra.newInstance();i[0]=a;const o=24,s=le.newTypedArray(e.pointType,o*3);a.getPoints().setData(s,3);const l=le.newTypedArray(e.pointType,o*3),c=nn.newInstance({name:"Normals",values:l,numberOfComponents:3});a.getPointData().setNormals(c);let f=2;e.generate3DTextureCoordinates===!0&&(f=3);const u=le.newTypedArray(e.pointType,o*f),d=nn.newInstance({name:"TextureCoordinates",values:u,numberOfComponents:f});a.getPointData().setTCoords(d);const h=[0,0,0],p=[0,0,0],g=[0,0];let m=0;h[0]=-e.xLength/2,p[0]=-1,p[1]=0,p[2]=0;for(let y=0;y<2;y++){h[1]=-e.yLength/2;for(let v=0;v<2;v++){g[1]=h[1]+.5,h[2]=-e.zLength/2;for(let x=0;x<2;x++)g[0]=(h[2]+.5)*(1-2*y),s[m*3]=h[0],s[m*3+1]=h[1],s[m*3+2]=h[2],l[m*3]=p[0],l[m*3+1]=p[1],l[m*3+2]=p[2],f===2?(u[m*f]=g[0],u[m*f+1]=g[1]):(u[m*f]=2*y-1,u[m*f+1]=2*v-1,u[m*f+2]=2*x-1),m++,h[2]+=e.zLength;h[1]+=e.yLength}h[0]+=e.xLength,p[0]+=2}h[1]=-e.yLength/2,p[1]=-1,p[0]=0,p[2]=0;for(let y=0;y<2;y++){h[0]=-e.xLength/2;for(let v=0;v<2;v++){g[0]=(h[0]+.5)*(2*y-1),h[2]=-e.zLength/2;for(let x=0;x<2;x++)g[1]=(h[2]+.5)*-1,s[m*3]=h[0],s[m*3+1]=h[1],s[m*3+2]=h[2],l[m*3]=p[0],l[m*3+1]=p[1],l[m*3+2]=p[2],f===2?(u[m*f]=g[0],u[m*f+1]=g[1]):(u[m*f]=2*v-1,u[m*f+1]=2*y-1,u[m*f+2]=2*x-1),m++,h[2]+=e.zLength;h[0]+=e.xLength}h[1]+=e.yLength,p[1]+=2}h[2]=-e.zLength/2,p[2]=-1,p[0]=0,p[1]=0;for(let y=0;y<2;y++){h[1]=-e.yLength/2;for(let v=0;v<2;v++){g[1]=h[1]+.5,h[0]=-e.xLength/2;for(let x=0;x<2;x++)g[0]=(h[0]+.5)*(2*y-1),s[m*3]=h[0],s[m*3+1]=h[1],s[m*3+2]=h[2],l[m*3]=p[0],l[m*3+1]=p[1],l[m*3+2]=p[2],f===2?(u[m*f]=g[0],u[m*f+1]=g[1]):(u[m*f]=2*x-1,u[m*f+1]=2*v-1,u[m*f+2]=2*y-1),m++,h[0]+=e.xLength;h[1]+=e.yLength}h[2]+=e.zLength,p[2]+=2}if(e.rotations&&Jd.buildFromDegree().rotateX(e.rotations[0]).rotateY(e.rotations[1]).rotateZ(e.rotations[2]).apply(s).apply(l),e.center&&Jd.buildFromRadian().translate(...e.center).apply(s),e.matrix){Jd.buildFromRadian().setMatrix(e.matrix).apply(s);const y=[e.matrix[0],e.matrix[1],e.matrix[2],0,e.matrix[4],e.matrix[5],e.matrix[6],0,e.matrix[8],e.matrix[9],e.matrix[10],0,0,0,0,1];Jd.buildFromRadian().setMatrix(y).apply(l)}e.generateFaces?a.getPolys().deepCopy(e._polys):a.getPolys().initialize(),e.generateLines?(a.getLines().deepCopy(e._lineCells),a.getPointData().setNormals(null)):a.getLines().initialize(),a.modified()}t.setBounds=function(){let r=[];if(Array.isArray(arguments.length<=0?void 0:arguments[0]))r=arguments.length<=0?void 0:arguments[0];else for(let i=0;i<arguments.length;i++)r.push(i<0||arguments.length<=i?void 0:arguments[i]);r.length===6&&(t.setXLength(r[1]-r[0]),t.setYLength(r[3]-r[2]),t.setZLength(r[5]-r[4]),t.setCenter([(r[0]+r[1])/2,(r[2]+r[3])/2,(r[4]+r[5])/2]))},t.requestData=n}const T3e={xLength:1,yLength:1,zLength:1,pointType:"Float64Array",generate3DTextureCoordinates:!1,generateFaces:!0,generateLines:!1};function Wq(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,T3e,n),le.obj(t,e),le.setGet(t,e,["xLength","yLength","zLength","generate3DTextureCoordinates","generateFaces","generateLines"]),le.setGetArray(t,e,["center","rotations"],3),le.setGetArray(t,e,["matrix"],16),e._polys=Zh.newInstance({values:Uint16Array.from(C3e)}),e._lineCells=Zh.newInstance({values:Uint16Array.from(w3e)}),le.moveToProtected(t,e,["polys","lineCells"]),le.algo(t,e,0,1),S3e(t,e)}const E3e=le.newInstance(Wq,"vtkCubeSource");var _3e={newInstance:E3e,extend:Wq};const{vtkErrorMacro:DL}=le;function D3e(t,e){e.classHierarchy.push("vtkImageDataOutlineFilter");const n={...t};t.requestData=(r,i)=>{const a=r[0];if(!a||!a.isA("vtkImageData")){DL("Invalid or missing input");return}const o=a.getSpatialExtent();if(!o){DL("Unable to fetch spatial extents of input image.");return}e._cubeSource.setBounds(o),e._cubeSource.setMatrix(a.getIndexToWorld()),i[0]=e._cubeSource.getOutputData()},t.getMTime=()=>Math.max(n.getMTime(),e._cubeSource.getMTime()),t.setGenerateFaces=e._cubeSource.setGenerateFaces,t.setGenerateLines=e._cubeSource.setGenerateLines,t.getGenerateFaces=e._cubeSource.getGenerateFaces,t.getGenerateLines=e._cubeSource.getGenerateLines}const O3e={};function Hq(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,O3e,n),le.obj(t,e),le.algo(t,e,1,1),e._cubeSource=_3e.newInstance(),le.moveToProtected(t,e,["cubeSource","tmpOut"]),D3e(t,e)}const M3e=le.newInstance(Hq,"vtkImageDataOutlineFilter");var I3e={newInstance:M3e,extend:Hq};const w2={CLAMP_TO_EDGE:0,REPEAT:1,MIRRORED_REPEAT:2},on={NEAREST:0,LINEAR:1,NEAREST_MIPMAP_NEAREST:2,NEAREST_MIPMAP_LINEAR:3,LINEAR_MIPMAP_NEAREST:4,LINEAR_MIPMAP_LINEAR:5};var Kq={Wrap:w2,Filter:on};const qq=new Float32Array(1),R3e=new Int32Array(qq.buffer);function A3e(t){qq[0]=t;const e=R3e[0];let n=e>>16&32768,r=e>>12&2047;const i=e>>23&255;return i<103?n:i>142?(n|=31744,n|=(i===255?0:1)&&e&8388607,n):i<113?(r|=2048,n|=(r>>114-i)+(r>>113-i&1),n):(n|=i-112<<10|r>>1,n+=r&1,n)}function P3e(t){const e=(t&32768)>>15,n=(t&31744)>>10,r=t&1023;return n===0?(e?-1:1)*2**-14*(r/2**10):n===31?r?NaN:(e?-1:1)*(1/0):(e?-1:1)*2**(n-15)*(1+r/2**10)}var mh={fromHalf:P3e,toHalf:A3e};function N3e(){try{const r=new Int16Array([0,32767]),i=[1,1],a=document.createElement("canvas");a.width=4,a.height=4;const o=a.getContext("webgl2");if(!o)return!1;const s=o.getExtension("EXT_texture_norm16");if(!s)return!1;const l=`#version 300 es
    void main() {
      gl_PointSize = ${4 .toFixed(1)};
      gl_Position = vec4(0, 0, 0, 1);
    }
  `,c=`#version 300 es
    precision highp float;
    precision highp int;
    precision highp sampler2D;

    uniform sampler2D u_image;

    out vec4 color;

    void main() {
        vec4 intColor = texture(u_image, gl_PointCoord.xy);
        color = vec4(vec3(intColor.rrr), 1);
    }
    `,f=o.createShader(o.VERTEX_SHADER);if(o.shaderSource(f,l),o.compileShader(f),!o.getShaderParameter(f,o.COMPILE_STATUS))return!1;const u=o.createShader(o.FRAGMENT_SHADER);if(o.shaderSource(u,c),o.compileShader(u),!o.getShaderParameter(u,o.COMPILE_STATUS))return!1;const d=o.createProgram();if(o.attachShader(d,f),o.attachShader(d,u),o.linkProgram(d),!o.getProgramParameter(d,o.LINK_STATUS))return!1;const h=o.createTexture();o.bindTexture(o.TEXTURE_2D,h),o.texImage2D(o.TEXTURE_2D,0,s.R16_SNORM_EXT,2,1,0,o.RED,o.SHORT,r),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR),o.useProgram(d),o.drawArrays(o.POINTS,0,1);const p=new Uint8Array(4);o.readPixels(i[0],i[1],1,1,o.RGBA,o.UNSIGNED_BYTE,p);const[g,m,y]=p,v=o.getExtension("WEBGL_lose_context");return v&&v.loseContext(),g===m&&m===y&&g!==0}catch{return!1}}let GT;function L3e(){return GT===void 0&&(GT=N3e()),GT}const{Wrap:ff,Filter:Oa}=Kq,{VtkDataTypes:ir}=nn,{vtkDebugMacro:jT,vtkErrorMacro:Xp,vtkWarningMacro:OL}=po,{toHalf:k3e}=mh;function V3e(t,e){e.classHierarchy.push("vtkOpenGLTexture");function n(){return{internalFormat:e.internalFormat,format:e.format,openGLDataType:e.openGLDataType,width:e.width,height:e.height}}t.render=function(){let p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;if(p?e._openGLRenderWindow=p:(e._openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e._openGLRenderWindow=e._openGLRenderer.getLastAncestorOfType("vtkOpenGLRenderWindow")),e.context=e._openGLRenderWindow.getContext(),e.renderable.getInterpolate()?(e.generateMipmap?t.setMinificationFilter(Oa.LINEAR_MIPMAP_LINEAR):t.setMinificationFilter(Oa.LINEAR),t.setMagnificationFilter(Oa.LINEAR)):(t.setMinificationFilter(Oa.NEAREST),t.setMagnificationFilter(Oa.NEAREST)),e.renderable.getRepeat()&&(t.setWrapR(ff.REPEAT),t.setWrapS(ff.REPEAT),t.setWrapT(ff.REPEAT)),e.renderable.getInputData()&&e.renderable.setImage(null),!e.handle||e.renderable.getMTime()>e.textureBuildTime.getMTime()){if(e.renderable.getImage()!==null&&(e.renderable.getInterpolate()&&(e.generateMipmap=!0,t.setMinificationFilter(Oa.LINEAR_MIPMAP_LINEAR)),e.renderable.getImage()&&e.renderable.getImageLoaded()&&(t.create2DFromImage(e.renderable.getImage()),t.activate(),t.sendParameters(),e.textureBuildTime.modified())),e.renderable.getCanvas()!==null){e.renderable.getInterpolate()&&(e.generateMipmap=!0,t.setMinificationFilter(Oa.LINEAR_MIPMAP_LINEAR));const m=e.renderable.getCanvas();t.create2DFromRaw(m.width,m.height,4,ir.UNSIGNED_CHAR,m,!0),t.activate(),t.sendParameters(),e.textureBuildTime.modified()}if(e.renderable.getJsImageData()!==null){const m=e.renderable.getJsImageData();e.renderable.getInterpolate()&&(e.generateMipmap=!0,t.setMinificationFilter(Oa.LINEAR_MIPMAP_LINEAR)),t.create2DFromRaw(m.width,m.height,4,ir.UNSIGNED_CHAR,m.data,!0),t.activate(),t.sendParameters(),e.textureBuildTime.modified()}const g=e.renderable.getInputData(0);if(g&&g.getPointData().getScalars()){const m=g.getExtent(),y=g.getPointData().getScalars(),v=[];for(let x=0;x<e.renderable.getNumberOfInputPorts();++x){const w=e.renderable.getInputData(x),S=w?w.getPointData().getScalars().getData():null;S&&v.push(S)}e.renderable.getInterpolate()&&y.getNumberOfComponents()===4&&(e.generateMipmap=!0,t.setMinificationFilter(Oa.LINEAR_MIPMAP_LINEAR)),v.length%6===0?t.createCubeFromRaw(m[1]-m[0]+1,m[3]-m[2]+1,y.getNumberOfComponents(),y.getDataType(),v):t.create2DFromRaw(m[1]-m[0]+1,m[3]-m[2]+1,y.getNumberOfComponents(),y.getDataType(),y.getData()),t.activate(),t.sendParameters(),e.textureBuildTime.modified()}}e.handle&&t.activate()};const r=()=>{if(!((e.minificationFilter===Oa.LINEAR||e.magnificationFilter===Oa.LINEAR)&&!L3e()))return e.oglNorm16Ext};t.destroyTexture=()=>{t.deactivate(),e.context&&e.handle&&e.context.deleteTexture(e.handle),e._prevTexParams=null,e.handle=0,e.numberOfDimensions=0,e.target=0,e.components=0,e.width=0,e.height=0,e.depth=0,t.resetFormatAndType()},t.createTexture=()=>{e.handle||(e.handle=e.context.createTexture(),e.target&&(e.context.bindTexture(e.target,e.handle),e.context.texParameteri(e.target,e.context.TEXTURE_MIN_FILTER,t.getOpenGLFilterMode(e.minificationFilter)),e.context.texParameteri(e.target,e.context.TEXTURE_MAG_FILTER,t.getOpenGLFilterMode(e.magnificationFilter)),e.context.texParameteri(e.target,e.context.TEXTURE_WRAP_S,t.getOpenGLWrapMode(e.wrapS)),e.context.texParameteri(e.target,e.context.TEXTURE_WRAP_T,t.getOpenGLWrapMode(e.wrapT)),e._openGLRenderWindow.getWebgl2()&&e.context.texParameteri(e.target,e.context.TEXTURE_WRAP_R,t.getOpenGLWrapMode(e.wrapR)),e.context.bindTexture(e.target,null)))},t.getTextureUnit=()=>e._openGLRenderWindow?e._openGLRenderWindow.getTextureUnitForTexture(t):-1,t.activate=()=>{e._openGLRenderWindow.activateTexture(t),t.bind()},t.deactivate=()=>{e._openGLRenderWindow&&e._openGLRenderWindow.deactivateTexture(t)},t.releaseGraphicsResources=p=>{p&&e.handle&&(p.activateTexture(t),p.deactivateTexture(t),e.context.deleteTexture(e.handle),e._prevTexParams=null,e.handle=0,e.numberOfDimensions=0,e.target=0,e.internalFormat=0,e.format=0,e.openGLDataType=0,e.components=0,e.width=0,e.height=0,e.depth=0,e.allocatedGPUMemoryInBytes=0),e.shaderProgram&&(e.shaderProgram.releaseGraphicsResources(p),e.shaderProgram=null)},t.bind=()=>{e.context.bindTexture(e.target,e.handle),e.autoParameters&&t.getMTime()>e.sendParametersTime.getMTime()&&t.sendParameters()},t.isBound=()=>{let p=!1;if(e.context&&e.handle){let g=0;switch(e.target){case e.context.TEXTURE_2D:g=e.context.TEXTURE_BINDING_2D;break;default:OL("impossible case");break}p=e.context.getIntegerv(g)===e.handle}return p},t.sendParameters=()=>{e.context.texParameteri(e.target,e.context.TEXTURE_WRAP_S,t.getOpenGLWrapMode(e.wrapS)),e.context.texParameteri(e.target,e.context.TEXTURE_WRAP_T,t.getOpenGLWrapMode(e.wrapT)),e._openGLRenderWindow.getWebgl2()&&e.context.texParameteri(e.target,e.context.TEXTURE_WRAP_R,t.getOpenGLWrapMode(e.wrapR)),e.context.texParameteri(e.target,e.context.TEXTURE_MIN_FILTER,t.getOpenGLFilterMode(e.minificationFilter)),e.context.texParameteri(e.target,e.context.TEXTURE_MAG_FILTER,t.getOpenGLFilterMode(e.magnificationFilter)),e._openGLRenderWindow.getWebgl2()&&(e.context.texParameteri(e.target,e.context.TEXTURE_BASE_LEVEL,e.baseLevel),e.context.texParameteri(e.target,e.context.TEXTURE_MAX_LEVEL,e.maxLevel)),e.sendParametersTime.modified()},t.getInternalFormat=(p,g)=>(e._forceInternalFormat||(e.internalFormat=t.getDefaultInternalFormat(p,g)),e.internalFormat||jT(`Unable to find suitable internal format for T=${p} NC= ${g}`),[e.context.R32F,e.context.RG32F,e.context.RGB32F,e.context.RGBA32F].includes(e.internalFormat)&&!e.context.getExtension("OES_texture_float_linear")&&OL("Failed to load OES_texture_float_linear. Texture filtering is not available for *32F internal formats."),e.internalFormat),t.getDefaultInternalFormat=(p,g)=>{let m=0;return m=e._openGLRenderWindow.getDefaultTextureInternalFormat(p,g,r(),t.useHalfFloat()),m||(m||(jT("Unsupported internal texture type!"),jT(`Unable to find suitable internal format for T=${p} NC= ${g}`)),m)},t.useHalfFloat=()=>e.enableUseHalfFloat&&e.canUseHalfFloat,t.setInternalFormat=p=>{e._forceInternalFormat=!0,p!==e.internalFormat&&(e.internalFormat=p,t.modified())},t.getFormat=(p,g)=>(e.format=t.getDefaultFormat(p,g),e.format),t.getDefaultFormat=(p,g)=>{if(e._openGLRenderWindow.getWebgl2())switch(g){case 1:return e.context.RED;case 2:return e.context.RG;case 3:return e.context.RGB;case 4:return e.context.RGBA;default:return e.context.RGB}else switch(g){case 1:return e.context.LUMINANCE;case 2:return e.context.LUMINANCE_ALPHA;case 3:return e.context.RGB;case 4:return e.context.RGBA;default:return e.context.RGB}},t.resetFormatAndType=()=>{e._prevTexParams=null,e.format=0,e.internalFormat=0,e._forceInternalFormat=!1,e.openGLDataType=0},t.getDefaultDataType=p=>{const g=t.useHalfFloat();if(e._openGLRenderWindow.getWebgl2())switch(p){case ir.UNSIGNED_CHAR:return e.context.UNSIGNED_BYTE;case(r()&&!g&&ir.SHORT):return e.context.SHORT;case(r()&&!g&&ir.UNSIGNED_SHORT):return e.context.UNSIGNED_SHORT;case(g&&ir.SHORT):return e.context.HALF_FLOAT;case(g&&ir.UNSIGNED_SHORT):return e.context.HALF_FLOAT;case ir.FLOAT:case ir.VOID:default:return e.context.FLOAT}switch(p){case ir.UNSIGNED_CHAR:return e.context.UNSIGNED_BYTE;case ir.FLOAT:case ir.VOID:default:if(e.context.getExtension("OES_texture_float")&&e.context.getExtension("OES_texture_float_linear"))return e.context.FLOAT;{const m=e.context.getExtension("OES_texture_half_float");if(m&&e.context.getExtension("OES_texture_half_float_linear"))return m.HALF_FLOAT_OES}return e.context.UNSIGNED_BYTE}},t.getOpenGLDataType=function(p){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return(!e.openGLDataType||g)&&(e.openGLDataType=t.getDefaultDataType(p)),e.openGLDataType},t.getShiftAndScale=()=>{let p=0,g=1;switch(e.openGLDataType){case e.context.BYTE:g=127.5,p=g-128;break;case e.context.UNSIGNED_BYTE:g=255,p=0;break;case e.context.SHORT:g=32767.5,p=g-32768;break;case e.context.UNSIGNED_SHORT:g=65536,p=0;break;case e.context.INT:g=21474836475e-1,p=g-2147483648;break;case e.context.UNSIGNED_INT:g=4294967295,p=0;break;case e.context.FLOAT:}return{shift:p,scale:g}},t.getOpenGLFilterMode=p=>{switch(p){case Oa.NEAREST:return e.context.NEAREST;case Oa.LINEAR:return e.context.LINEAR;case Oa.NEAREST_MIPMAP_NEAREST:return e.context.NEAREST_MIPMAP_NEAREST;case Oa.NEAREST_MIPMAP_LINEAR:return e.context.NEAREST_MIPMAP_LINEAR;case Oa.LINEAR_MIPMAP_NEAREST:return e.context.LINEAR_MIPMAP_NEAREST;case Oa.LINEAR_MIPMAP_LINEAR:return e.context.LINEAR_MIPMAP_LINEAR;default:return e.context.NEAREST}},t.getOpenGLWrapMode=p=>{switch(p){case ff.CLAMP_TO_EDGE:return e.context.CLAMP_TO_EDGE;case ff.REPEAT:return e.context.REPEAT;case ff.MIRRORED_REPEAT:return e.context.MIRRORED_REPEAT;default:return e.context.CLAMP_TO_EDGE}};function i(p){const[g,m,y,v,x,w]=p;return[m-g+1,v-y+1,w-x+1]}function a(p){const[g,m,y]=i(p);return g*m*y}function o(p,g,m,y,v){const[x,w,S,T,_,D]=m,[I,R]=g,M=I*R;let A=v;for(let L=_;L<=D;L++){const P=L*M;for(let B=S;B<=T;B++){const U=P+B*I;for(let G=U+x,F=U+w;G<=F;G++,A++)y[A]=p[G]}}}function s(p,g){const y=(arguments.length>2&&arguments[2]!==void 0?arguments[2]:null)||p.constructor,v=g.reduce((T,_)=>T+a(_),0),x=new y(v),w=[e.width,e.height,e.depth];let S=0;return g.forEach(T=>{o(p,w,T,x,S),S+=a(T)}),x}t.updateArrayDataTypeForGL=function(p,g){let m=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,y=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[];const v=[];let x=e.width*e.height*e.components;m&&(x*=e.depth);const w=!!y.length;if(p!==ir.FLOAT&&e.openGLDataType===e.context.FLOAT)for(let T=0;T<g.length;T++)if(g[T])if(w)v.push(s(g[T],y,Float32Array));else{const _=g[T].length>x?g[T].subarray(0,x):g[T];v.push(new Float32Array(_))}else v.push(null);if(p!==ir.UNSIGNED_CHAR&&e.openGLDataType===e.context.UNSIGNED_BYTE)for(let T=0;T<g.length;T++)if(g[T])if(w)v.push(s(g[T],y,Uint8Array));else{const _=g[T].length>x?g[T].subarray(0,x):g[T];v.push(new Uint8Array(_))}else v.push(null);let S=!1;if(e._openGLRenderWindow.getWebgl2())S=e.openGLDataType===e.context.HALF_FLOAT;else{const T=e.context.getExtension("OES_texture_half_float");S=T&&e.openGLDataType===T.HALF_FLOAT_OES}if(S)for(let T=0;T<g.length;T++)if(g[T]){const _=w?s(g[T],y):g[T],D=new Uint16Array(w?_.length:x),I=D.length;for(let R=0;R<I;R++)D[R]=k3e(_[R]);v.push(D)}else v.push(null);if(v.length===0)for(let T=0;T<g.length;T++)v.push(w&&g[T]?s(g[T],y):g[T]);return v};function l(p){if(e._openGLRenderWindow.getWebgl2())return p;const g=[],m=e.width,y=e.height,v=e.components;if(p&&(!pv(m)||!pv(y))){const x=e.context.getExtension("OES_texture_half_float"),w=Dl(m),S=Dl(y),T=w*S*e.components;for(let _=0;_<p.length;_++)if(p[_]!==null){let D=null;const I=y/S,R=m/w;let M=!1;e.openGLDataType===e.context.FLOAT?D=new Float32Array(T):x&&e.openGLDataType===x.HALF_FLOAT_OES?(D=new Uint16Array(T),M=!0):D=new Uint8Array(T);for(let A=0;A<S;A++){const L=A*w*v,P=A*I;let B=Math.floor(P),U=Math.ceil(P);U>=y&&(U=y-1);const G=P-B,F=1-G;B=B*m*v,U=U*m*v;for(let $=0;$<w;$++){const V=$*v,X=$*R;let Q=Math.floor(X),re=Math.ceil(X);re>=m&&(re=m-1);const ye=X-Q;Q*=v,re*=v;for(let me=0;me<v;me++)M?D[L+V+me]=mh.toHalf(mh.fromHalf(p[_][B+Q+me])*F*(1-ye)+mh.fromHalf(p[_][B+re+me])*F*ye+mh.fromHalf(p[_][U+Q+me])*G*(1-ye)+mh.fromHalf(p[_][U+re+me])*G*ye):D[L+V+me]=p[_][B+Q+me]*F*(1-ye)+p[_][B+re+me]*F*ye+p[_][U+Q+me]*G*(1-ye)+p[_][U+re+me]*G*ye}}g.push(D),e.width=w,e.height=S}else g.push(null)}if(g.length===0)for(let x=0;x<p.length;x++)g.push(p[x]);return g}function c(p){return e._openGLRenderWindow?e.resizable||e.renderable?.getResizable()?!1:e._openGLRenderWindow.getWebgl2()?!(e._openGLRenderWindow.getGLInformations().RENDERER.value.match(/WebKit/gi)&&navigator.platform.match(/Mac/gi)&&r()&&(p===ir.UNSIGNED_SHORT||p===ir.SHORT)):!1:!1}t.create2DFromRaw=function(p,g,m,y,v){let x=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!1;if(t.getOpenGLDataType(y,!0),t.getInternalFormat(y,m),t.getFormat(y,m),!e.internalFormat||!e.format||!e.openGLDataType)return Xp("Failed to determine texture parameters."),!1;e.target=e.context.TEXTURE_2D,e.components=m,e.width=p,e.height=g,e.depth=1,e.numberOfDimensions=2,e._openGLRenderWindow.activateTexture(t),t.createTexture(),t.bind();const w=[v],S=t.updateArrayDataTypeForGL(y,w),T=l(S);return e.context.pixelStorei(e.context.UNPACK_FLIP_Y_WEBGL,x),e.context.pixelStorei(e.context.UNPACK_ALIGNMENT,1),c(y)?(e.context.texStorage2D(e.target,1,e.internalFormat,e.width,e.height),T[0]!=null&&e.context.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.openGLDataType,T[0])):e.context.texImage2D(e.target,0,e.internalFormat,e.width,e.height,0,e.format,e.openGLDataType,T[0]),e.generateMipmap&&e.context.generateMipmap(e.target),x&&e.context.pixelStorei(e.context.UNPACK_FLIP_Y_WEBGL,!1),e.allocatedGPUMemoryInBytes=e.width*e.height*e.depth*m*e._openGLRenderWindow.getDefaultTextureByteSize(y,r(),t.useHalfFloat()),t.deactivate(),!0},t.createCubeFromRaw=(p,g,m,y,v)=>{if(t.getOpenGLDataType(y),t.getInternalFormat(y,m),t.getFormat(y,m),!e.internalFormat||!e.format||!e.openGLDataType)return Xp("Failed to determine texture parameters."),!1;e.target=e.context.TEXTURE_CUBE_MAP,e.components=m,e.width=p,e.height=g,e.depth=1,e.numberOfDimensions=2,e._openGLRenderWindow.activateTexture(t),e.maxLevel=v.length/6-1,t.createTexture(),t.bind();const x=t.updateArrayDataTypeForGL(y,v),w=l(x),S=[];let T=e.width,_=e.height;for(let D=0;D<w.length;D++){D%6===0&&D!==0&&(T/=2,_/=2),S[D]=Am(y,_*T*e.components);for(let I=0;I<_;++I){const R=I*T*e.components,M=(_-I-1)*T*e.components;S[D].set(w[D].slice(M,M+T*e.components),R)}}e.context.pixelStorei(e.context.UNPACK_ALIGNMENT,1),c(y)&&e.context.texStorage2D(e.target,6,e.internalFormat,e.width,e.height);for(let D=0;D<6;D++){let I=0,R=e.width,M=e.height;for(;R>=1&&M>=1;){let A=null;I<=e.maxLevel&&(A=S[6*I+D]),c(y)?A!=null&&e.context.texSubImage2D(e.context.TEXTURE_CUBE_MAP_POSITIVE_X+D,I,0,0,R,M,e.format,e.openGLDataType,A):e.context.texImage2D(e.context.TEXTURE_CUBE_MAP_POSITIVE_X+D,I,e.internalFormat,R,M,0,e.format,e.openGLDataType,A),I++,R/=2,M/=2}}return e.allocatedGPUMemoryInBytes=e.width*e.height*e.depth*m*e._openGLRenderWindow.getDefaultTextureByteSize(y,r(),t.useHalfFloat()),t.deactivate(),!0},t.createDepthFromRaw=(p,g,m,y)=>(t.getOpenGLDataType(m),e.format=e.context.DEPTH_COMPONENT,e._openGLRenderWindow.getWebgl2()?m===ir.FLOAT?e.internalFormat=e.context.DEPTH_COMPONENT32F:e.internalFormat=e.context.DEPTH_COMPONENT16:e.internalFormat=e.context.DEPTH_COMPONENT,!e.internalFormat||!e.format||!e.openGLDataType?(Xp("Failed to determine texture parameters."),!1):(e.target=e.context.TEXTURE_2D,e.components=1,e.width=p,e.height=g,e.depth=1,e.numberOfDimensions=2,e._openGLRenderWindow.activateTexture(t),t.createTexture(),t.bind(),e.context.pixelStorei(e.context.UNPACK_ALIGNMENT,1),c(m)?(e.context.texStorage2D(e.target,1,e.internalFormat,e.width,e.height),y!=null&&e.context.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.openGLDataType,y)):e.context.texImage2D(e.target,0,e.internalFormat,e.width,e.height,0,e.format,e.openGLDataType,y),e.generateMipmap&&e.context.generateMipmap(e.target),e.allocatedGPUMemoryInBytes=e.width*e.height*e.depth*e.components*e._openGLRenderWindow.getDefaultTextureByteSize(m,r(),t.useHalfFloat()),t.deactivate(),!0)),t.create2DFromImage=p=>{if(t.getOpenGLDataType(ir.UNSIGNED_CHAR),t.getInternalFormat(ir.UNSIGNED_CHAR,4),t.getFormat(ir.UNSIGNED_CHAR,4),!e.internalFormat||!e.format||!e.openGLDataType)return Xp("Failed to determine texture parameters."),!1;e.target=e.context.TEXTURE_2D,e.components=4,e.depth=1,e.numberOfDimensions=2,e._openGLRenderWindow.activateTexture(t),t.createTexture(),t.bind(),e.context.pixelStorei(e.context.UNPACK_ALIGNMENT,1);const g=!e._openGLRenderWindow.getWebgl2()&&(!pv(p.width)||!pv(p.height)),m=document.createElement("canvas");m.width=g?Dl(p.width):p.width,m.height=g?Dl(p.height):p.height,e.width=m.width,e.height=m.height;const y=m.getContext("2d");y.translate(0,m.height),y.scale(1,-1),y.drawImage(p,0,0,p.width,p.height,0,0,m.width,m.height);const v=m;return c(ir.UNSIGNED_CHAR)?(e.context.texStorage2D(e.target,1,e.internalFormat,e.width,e.height),v!=null&&e.context.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.openGLDataType,v)):e.context.texImage2D(e.target,0,e.internalFormat,e.width,e.height,0,e.format,e.openGLDataType,v),e.generateMipmap&&e.context.generateMipmap(e.target),e.allocatedGPUMemoryInBytes=e.width*e.height*e.depth*e.components*e._openGLRenderWindow.getDefaultTextureByteSize(ir.UNSIGNED_CHAR,r(),t.useHalfFloat()),t.deactivate(),!0};function f(p,g,m){const y=new Array(m),v=new Array(m);for(let x=0;x<m;++x)y[x]=p[x],v[x]=g[x]-p[x]||1;return{scale:v,offset:y}}function u(p,g){for(let m=0;m<p.length;m++){const y=p[m],v=g[m]+y;if(y<-2048||y>2048||v<-2048||v>2048)return!1}return!0}function d(p,g,m,y){t.getOpenGLDataType(p);const v=u(g,m)||y;let x=!1;if(e._openGLRenderWindow.getWebgl2())x=e.openGLDataType===e.context.FLOAT&&e.context.getExtension("OES_texture_float_linear")===null&&v||e.openGLDataType===e.context.HALF_FLOAT;else{const w=e.context.getExtension("OES_texture_half_float");x=w&&e.openGLDataType===w.HALF_FLOAT_OES}e.canUseHalfFloat=x&&v}function h(p,g){const m=p.getNumberOfComponents(),y=p.getDataType(),v=p.getData(),x=new Array(m),w=new Array(m);for(let T=0;T<m;++T){const[_,D]=p.getRange(T);x[T]=_,w[T]=D}const S=f(x,w,m);return d(y,S.offset,S.scale,g),t.useHalfFloat()||t.getOpenGLDataType(y,!0),{numComps:m,dataType:y,data:v,scaleOffsets:S}}t.create2DFilterableFromRaw=function(p,g,m,y,v){let x=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!1,w=arguments.length>6&&arguments[6]!==void 0?arguments[6]:void 0;return t.create2DFilterableFromDataArray(p,g,nn.newInstance({numberOfComponents:m,dataType:y,values:v,ranges:w}),x)},t.create2DFilterableFromDataArray=function(p,g,m){let y=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const{numComps:v,dataType:x,data:w}=h(m,y);t.create2DFromRaw(p,g,v,x,w)},t.updateVolumeInfoForGL=(p,g)=>{let m=!1;const y=t.useHalfFloat();(!e.volumeInfo?.scale||!e.volumeInfo?.offset)&&(e.volumeInfo={scale:new Array(g),offset:new Array(g)});for(let v=0;v<g;++v)e.volumeInfo.scale[v]=1,e.volumeInfo.offset[v]=0;if(r()&&!y&&p===ir.SHORT){for(let v=0;v<g;++v)e.volumeInfo.scale[v]=32767;m=!0}if(r()&&!y&&p===ir.UNSIGNED_SHORT){for(let v=0;v<g;++v)e.volumeInfo.scale[v]=65535;m=!0}if(p===ir.UNSIGNED_CHAR){for(let v=0;v<g;++v)e.volumeInfo.scale[v]=255;m=!0}return(p===ir.FLOAT||y&&(p===ir.SHORT||p===ir.UNSIGNED_SHORT))&&(m=!0),m},t.create3DFromRaw=function(p,g,m,y,v,x){let w=arguments.length>6&&arguments[6]!==void 0?arguments[6]:[],S=v,T=x;if(!t.updateVolumeInfoForGL(S,y)&&T){const L=p*g*m,P=structuredClone(e.volumeInfo),B=new Float32Array(L*y);e.volumeInfo.offset=P.offset,e.volumeInfo.scale=P.scale;let U=0;const G=P.scale.map(F=>1/F);for(let F=0;F<L;F++)for(let $=0;$<y;$++)B[U]=(T[U]-P.offset[$])*G[$],U++;S=ir.FLOAT,T=B}if(t.getOpenGLDataType(S),t.getInternalFormat(S,y),t.getFormat(S,y),!e.internalFormat||!e.format||!e.openGLDataType)return Xp("Failed to determine texture parameters."),!1;e.target=e.context.TEXTURE_3D,e.components=y,e.width=p,e.height=g,e.depth=m,e.numberOfDimensions=3,e._openGLRenderWindow.activateTexture(t),t.createTexture(),t.bind();const _=w.length>0,D=!_||!w9(e._prevTexParams,n()),I=[T],M=t.updateArrayDataTypeForGL(S,I,!0,D?[]:w),A=l(M);if(e.context.pixelStorei(e.context.UNPACK_ALIGNMENT,1),D)c(S)?(e.context.texStorage3D(e.target,1,e.internalFormat,e.width,e.height,e.depth),A[0]!=null&&e.context.texSubImage3D(e.target,0,0,0,0,e.width,e.height,e.depth,e.format,e.openGLDataType,A[0])):e.context.texImage3D(e.target,0,e.internalFormat,e.width,e.height,e.depth,0,e.format,e.openGLDataType,A[0]),e._prevTexParams=n();else if(_){const L=A[0];let P=0;for(let B=0;B<w.length;B++){const U=w[B],G=i(U),F=a(U),$=new L.constructor(L.buffer,P,F);P+=$.byteLength,e.context.texSubImage3D(e.target,0,U[0],U[2],U[4],G[0],G[1],G[2],e.format,e.openGLDataType,$)}}return e.generateMipmap&&e.context.generateMipmap(e.target),e.allocatedGPUMemoryInBytes=e.width*e.height*e.depth*e.components*e._openGLRenderWindow.getDefaultTextureByteSize(S,r(),t.useHalfFloat()),t.deactivate(),!0},t.create3DFilterableFromRaw=function(p,g,m,y,v,x){let w=arguments.length>6&&arguments[6]!==void 0?arguments[6]:!1,S=arguments.length>7&&arguments[7]!==void 0?arguments[7]:void 0,T=arguments.length>8&&arguments[8]!==void 0?arguments[8]:[];return t.create3DFilterableFromDataArray(p,g,m,nn.newInstance({numberOfComponents:y,dataType:v,values:x,ranges:S}),w,T)},t.create3DFilterableFromDataArray=function(p,g,m,y){let v=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,x=arguments.length>5&&arguments[5]!==void 0?arguments[5]:[];const{numComps:w,dataType:S,data:T,scaleOffsets:_}=h(y,v),D=[],I=[];for(let Ce=0;Ce<w;++Ce)D[Ce]=0,I[Ce]=1;if(e.volumeInfo={scale:I,offset:D,dataComputedScale:_.scale,dataComputedOffset:_.offset,width:p,height:g,depth:m},e._openGLRenderWindow.getWebgl2())return t.create3DFromRaw(p,g,m,w,S,T,x);const R=p*g*m,M=structuredClone(_);let A=(Ce,we,Ae,De,q)=>{Ce[we]=Ae},L=ir.UNSIGNED_CHAR;if(S===ir.UNSIGNED_CHAR)for(let Ce=0;Ce<w;++Ce)M.offset[Ce]=0,M.scale[Ce]=255;else e.context.getExtension("OES_texture_float")&&e.context.getExtension("OES_texture_float_linear")?(L=ir.FLOAT,A=(Ce,we,Ae,De,q)=>{Ce[we]=(Ae-De)/q}):(L=ir.UNSIGNED_CHAR,A=(Ce,we,Ae,De,q)=>{Ce[we]=255*(Ae-De)/q});if(t.getOpenGLDataType(L),t.getInternalFormat(L,w),t.getFormat(L,w),!e.internalFormat||!e.format||!e.openGLDataType)return Xp("Failed to determine texture parameters."),!1;e.target=e.context.TEXTURE_2D,e.components=w,e.depth=1,e.numberOfDimensions=2;let P=e.context.getParameter(e.context.MAX_TEXTURE_SIZE);P>4096&&(L===ir.FLOAT||w>=3)&&(P=4096);let B=1,U=1;R>P*P&&(B=Math.ceil(Math.sqrt(R/(P*P))),U=B);let G=Math.sqrt(R)/B;G=Dl(G);const F=Math.floor(G*B/p),$=Math.ceil(m/F),V=Dl(g*$/U);e.width=G,e.height=V,e._openGLRenderWindow.activateTexture(t),t.createTexture(),t.bind(),e.volumeInfo.xreps=F,e.volumeInfo.yreps=$,e.volumeInfo.xstride=B,e.volumeInfo.ystride=U,e.volumeInfo.offset=M.offset,e.volumeInfo.scale=M.scale;let X;const Q=G*V*w;L===ir.FLOAT?X=new Float32Array(Q):X=new Uint8Array(Q);let re=0;const ye=Math.floor(p/B),me=Math.floor(g/U);for(let Ce=0;Ce<$;Ce++){const we=Math.min(F,m-Ce*F),Ae=w*(e.width-we*Math.floor(p/B));for(let De=0;De<me;De++){for(let q=0;q<we;q++){const k=w*((Ce*F+q)*p*g+U*De*p);for(let J=0;J<ye;J++)for(let Y=0;Y<w;Y++)A(X,re,T[k+B*J*w+Y],M.offset[Y],M.scale[Y]),re++}re+=Ae}}return e.context.pixelStorei(e.context.UNPACK_ALIGNMENT,1),c(L)?(e.context.texStorage2D(e.target,1,e.internalFormat,e.width,e.height),X!=null&&e.context.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.openGLDataType,X)):e.context.texImage2D(e.target,0,e.internalFormat,e.width,e.height,0,e.format,e.openGLDataType,X),t.deactivate(),!0},t.setOpenGLRenderWindow=p=>{e._openGLRenderWindow!==p&&(t.releaseGraphicsResources(),e._openGLRenderWindow=p,e.context=null,p&&(e.context=e._openGLRenderWindow.getContext()))},t.getMaximumTextureSize=p=>p&&p.isCurrent()?p.getIntegerv(p.MAX_TEXTURE_SIZE):-1,t.enableUseHalfFloat=p=>{e.enableUseHalfFloat=p}}const F3e={_openGLRenderWindow:null,_forceInternalFormat:!1,_prevTexParams:null,context:null,handle:0,sendParametersTime:null,textureBuildTime:null,numberOfDimensions:0,target:0,format:0,openGLDataType:0,components:0,width:0,height:0,depth:0,autoParameters:!0,wrapS:ff.CLAMP_TO_EDGE,wrapT:ff.CLAMP_TO_EDGE,wrapR:ff.CLAMP_TO_EDGE,minificationFilter:Oa.NEAREST,magnificationFilter:Oa.NEAREST,minLOD:-1e3,maxLOD:1e3,baseLevel:0,maxLevel:1e3,generateMipmap:!1,oglNorm16Ext:null,allocatedGPUMemoryInBytes:0,enableUseHalfFloat:!0,canUseHalfFloat:!1};function Xq(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,F3e,n),Rr.extend(t,e,n),e.sendParametersTime={},$r(e.sendParametersTime,{mtime:0}),e.textureBuildTime={},$r(e.textureBuildTime,{mtime:0}),J2(t,e,["format","openGLDataType"]),Mi(t,e,["keyMatrixTime","minificationFilter","magnificationFilter","wrapS","wrapT","wrapR","generateMipmap","oglNorm16Ext"]),Po(t,e,["width","height","volumeInfo","components","handle","target","allocatedGPUMemoryInBytes"]),Z2(t,e,["openGLRenderWindow"]),V3e(t,e)}const Yq=Zn(Xq,"vtkOpenGLTexture");var ti={newInstance:Yq,extend:Xq,...Kq};sa("vtkTexture",Yq);function U3e(t,e){t.replaceShaderCoincidentOffset=(n,r,i)=>{const a=t.getCoincidentParameters(r,i);if(a&&(a.factor!==0||a.offset!==0)){let o=n.Fragment;o=Be.substitute(o,"//VTK::Coincident::Dec",["uniform float cfactor;","uniform float coffset;"]).result,e.context.getExtension("EXT_frag_depth")&&(a.factor!==0?(o=Be.substitute(o,"//VTK::UniformFlow::Impl",["float cscale = length(vec2(dFdx(gl_FragCoord.z),dFdy(gl_FragCoord.z)));","//VTK::UniformFlow::Impl"],!1).result,o=Be.substitute(o,"//VTK::Depth::Impl","gl_FragDepthEXT = gl_FragCoord.z + cfactor*cscale + 0.000016*coffset;").result):o=Be.substitute(o,"//VTK::Depth::Impl","gl_FragDepthEXT = gl_FragCoord.z + 0.000016*coffset;").result),e._openGLRenderWindow.getWebgl2()&&(a.factor!==0?(o=Be.substitute(o,"//VTK::UniformFlow::Impl",["float cscale = length(vec2(dFdx(gl_FragCoord.z),dFdy(gl_FragCoord.z)));","//VTK::UniformFlow::Impl"],!1).result,o=Be.substitute(o,"//VTK::Depth::Impl","gl_FragDepth = gl_FragCoord.z + cfactor*cscale + 0.000016*coffset;").result):o=Be.substitute(o,"//VTK::Depth::Impl","gl_FragDepth = gl_FragCoord.z + 0.000016*coffset;").result),n.Fragment=o}}}function B3e(t,e){t.applyShaderReplacements=(n,r,i)=>{let a=null;if(r&&(a=r.ShaderReplacements),a)for(let o=0;o<a.length;o++){const s=a[o];if(i&&s.replaceFirst||!i&&!s.replaceFirst){const l=s.shaderType,c=n[l],f=Be.substitute(c,s.originalValue,s.replacementValue,s.replaceAll);n[l]=f.result}}},t.buildShaders=(n,r,i)=>{t.getReplacedShaderTemplate(n,r,i),e.lastRenderPassShaderReplacement=e.currentRenderPass?e.currentRenderPass.getShaderReplacement():null,e.lastRenderPassShaderReplacement&&e.lastRenderPassShaderReplacement(n);const a=e.renderable.getViewSpecificProperties().OpenGL;t.applyShaderReplacements(n,a,!0),t.replaceShaderValues(n,r,i),t.applyShaderReplacements(n,a)},t.getReplacedShaderTemplate=(n,r,i)=>{const a=e.renderable.getViewSpecificProperties().OpenGL;t.getShaderTemplate(n,r,i);let o=n.Vertex;if(a){const c=a.VertexShaderCode;c!==void 0&&c!==""&&(o=c)}n.Vertex=o;let s=n.Fragment;if(a){const c=a.FragmentShaderCode;c!==void 0&&c!==""&&(s=c)}n.Fragment=s;let l=n.Geometry;if(a){const c=a.GeometryShaderCode;c!==void 0&&(l=c)}n.Geometry=l}}var mu={implementReplaceShaderCoincidentOffset:U3e,implementBuildShadersWithReplacements:B3e};let gD;function $3e(t,e){e.classHierarchy.push("vtkAbstractTransform","vtkHomogeneousTransform","vtkTransform"),t.transformPoint=(n,r)=>($n(r,n,e.matrix),r),t.transformPoints=(n,r)=>{const i=new Float64Array(3),a=new Float64Array(3);for(let o=0;o<n.length;o+=3)i[0]=n[o],i[1]=n[o+1],i[2]=n[o+2],$n(a,i,e.matrix),r[o]=a[0],r[o+1]=a[1],r[o+2]=a[2];return r},t.preMultiply=()=>{t.setPreMultiplyFlag(!0)},t.postMultiply=()=>{t.setPreMultiplyFlag(!1)},t.transformMatrix=(n,r)=>(e.preMultiplyFlag?jn(r,e.matrix,n):jn(r,n,e.matrix),r),t.transformMatrices=(n,r)=>{const i=new Float64Array(16),a=new Float64Array(16),o=e.preMultiplyFlag?()=>jn(a,e.matrix,i):()=>jn(a,i,e.matrix);for(let s=0;s<n.length;s+=16){for(let l=0;l<16;++l)i[l]=n[s+l];o();for(let l=0;l<16;++l)r[s+l]=a[l]}return r},t.getInverse=()=>gD({matrix:Hs.invertMatrix(Array.from(e.matrix),[],4),preMultiplyFlag:e.preMultiplyFlag})}const G3e={preMultiplyFlag:!1,matrix:[...I9]};function Jq(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,G3e,n),le.obj(t,e),le.setGet(t,e,["preMultiplyFlag"]),le.setGetArray(t,e,["matrix"],16),$3e(t,e)}gD=le.newInstance(Jq,"vtkTransform");var j3e={newInstance:gD,extend:Jq};function vu(t,e,n){return t?`${t.getMTime()}-${e}-${n}`:"0"}function mD(t,e){return`${t.getMTime()}A${e.getMTime()}`}var z3e=`//VTK::System::Dec

/*=========================================================================

  Program:   Visualization Toolkit
  Module:    vtkImageResliceMapperVS.glsl

  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen
  All rights reserved.
  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.

     This software is distributed WITHOUT ANY WARRANTY; without even
     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
     PURPOSE.  See the above copyright notice for more information.

=========================================================================*/

// all variables that represent positions or directions have a suffix
// indicating the coordinate system they are in. The possible values are
// MC - Model coordinates
// WC - World coordinates
// VC - View coordinates
// DC - Display coordinates
// TC - Texture coordinates

// frag position in VC
//VTK::PositionVC::Dec

// Texture coordinates
//VTK::TCoord::Dec

// picking support
//VTK::Picking::Dec

// camera and actor matrix values
//VTK::Camera::Dec

void main()
{
  //VTK::PositionVC::Impl

  //VTK::TCoord::Impl

  //VTK::Picking::Impl
}
`,W3e=`//VTK::System::Dec

/*=========================================================================

  Program:   Visualization Toolkit
  Module:    vtkImageResliceMapperFS.glsl

  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen
  All rights reserved.
  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.

     This software is distributed WITHOUT ANY WARRANTY; without even
     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
     PURPOSE.  See the above copyright notice for more information.

=========================================================================*/
// Template for the gpu image mapper fragment shader

// VC position of this fragment
//VTK::PositionVC::Dec

// Texture coordinates
//VTK::TCoord::Dec

// picking support
//VTK::Picking::Dec

// handle coincident offsets
//VTK::Coincident::Dec

//VTK::ZBuffer::Dec

// the output of this shader
//VTK::Output::Dec

void main()
{
  // VC position of this fragment. This should not branch/return/discard.
  //VTK::PositionVC::Impl

  // Place any calls that require uniform flow (e.g. dFdx) here.
  //VTK::UniformFlow::Impl

  // Set gl_FragDepth here (gl_FragCoord.z by default)
  //VTK::Depth::Impl

  // Early depth peeling abort:
  //VTK::DepthPeeling::PreColor

  //VTK::TCoord::Impl

  if (gl_FragData[0].a <= 0.0)
    {
    discard;
    }

  //VTK::DepthPeeling::Impl

  //VTK::Picking::Impl

  // handle coincident offsets
  //VTK::Coincident::Impl

  //VTK::ZBuffer::Impl

  //VTK::RenderPassFragmentShader::Impl
}
`;const Vh={NEAREST:0,LINEAR:1};var H3e={InterpolationType:Vh};const Cc={Off:0,PolygonOffset:1};let D6=Cc.PolygonOffset,x3=Cc.Off;const K3e=["VTK_RESOLVE_OFF","VTK_RESOLVE_POLYGON_OFFSET"];function q3e(){return D6}function X3e(t){const e=D6===t;return D6=t,e}function Y3e(){return x3}function qw(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;const e=x3===t;return x3=t,e}function J3e(){return qw(Cc.Off)}function Z3e(){return qw(Cc.Off)}function Q3e(){return qw(Cc.PolygonOffset)}function ewe(){return K3e[x3]}var O6={Resolve:Cc,getResolveCoincidentTopologyAsString:ewe,getResolveCoincidentTopologyPolygonOffsetFaces:q3e,getResolveCoincidentTopology:Y3e,setResolveCoincidentTopology:qw,setResolveCoincidentTopologyPolygonOffsetFaces:X3e,setResolveCoincidentTopologyToDefault:J3e,setResolveCoincidentTopologyToOff:Z3e,setResolveCoincidentTopologyToPolygonOffset:Q3e};function Zq(t,e,n){n.forEach(r=>{t[`get${r.method}`]=()=>e[r.key],t[`set${r.method}`]=le.objectSetterMap.object(t,e,{name:r.key,params:["factor","offset"]})})}const vD=["Polygon","Line","Point"],twe={Polygon:{factor:2,offset:0},Line:{factor:1,offset:-1},Point:{factor:0,offset:-2}},nwe=()=>{},vh={modified:nwe};Zq(vh,twe,vD.map(t=>({key:t,method:`ResolveCoincidentTopology${t}OffsetParameters`})));function rwe(t,e){e.resolveCoincidentTopology===void 0&&(e.resolveCoincidentTopology=!1),le.setGet(t,e,["resolveCoincidentTopology"]),e.topologyOffset={Polygon:{factor:0,offset:0},Line:{factor:0,offset:0},Point:{factor:0,offset:0}},Object.keys(O6).forEach(n=>{t[n]=O6[n]}),Object.keys(vh).filter(n=>n!=="modified").forEach(n=>{t[n]=vh[n]}),Zq(t,e.topologyOffset,vD.map(n=>({key:n,method:`RelativeCoincidentTopology${n}OffsetParameters`}))),t.getCoincidentTopologyPolygonOffsetParameters=()=>{const n=vh.getResolveCoincidentTopologyPolygonOffsetParameters(),r=t.getRelativeCoincidentTopologyPolygonOffsetParameters();return{factor:n.factor+r.factor,offset:n.offset+r.offset}},t.getCoincidentTopologyLineOffsetParameters=()=>{const n=vh.getResolveCoincidentTopologyLineOffsetParameters(),r=t.getRelativeCoincidentTopologyLineOffsetParameters();return{factor:n.factor+r.factor,offset:n.offset+r.offset}},t.getCoincidentTopologyPointOffsetParameter=()=>{const n=vh.getResolveCoincidentTopologyPointOffsetParameters(),r=t.getRelativeCoincidentTopologyPointOffsetParameters();return{factor:n.factor+r.factor,offset:n.offset+r.offset}}}var Xw={implementCoincidentTopologyMethods:rwe,staticOffsetAPI:vh,otherStaticMethods:O6,CATEGORIES:vD,Resolve:Cc};const{vtkErrorMacro:W0}=po;function ML(t,e,n){return e.identity(n),t.reduce((r,i,a)=>a===0?i?e.copy(r,i):e.identity(r):i?e.multiply(r,r,i):r,n)}function iwe(t,e){e.classHierarchy.push("vtkOpenGLImageResliceMapper");function n(i){[e._scalars,e._colorTransferFunc,e._pwFunc].forEach(a=>i.unregisterGraphicsResourceUser(a,t))}t.buildPass=i=>{if(i){e.currentRenderPass=null,e._openGLImageSlice=t.getFirstAncestorOfType("vtkOpenGLImageSlice"),e._openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer");const a=e._openGLRenderer.getRenderable();e._openGLCamera=e._openGLRenderer.getViewNodeFor(a.getActiveCamera());const o=e._openGLRenderWindow;e._openGLRenderWindow=e._openGLRenderer.getLastAncestorOfType("vtkOpenGLRenderWindow"),o&&!o.isDeleted()&&o!==e._openGLRenderWindow&&n(o),e.context=e._openGLRenderWindow.getContext(),e.tris.setOpenGLRenderWindow(e._openGLRenderWindow)}},t.translucentPass=(i,a)=>{i&&(e.currentRenderPass=a,t.render())},t.zBufferPass=i=>{i&&(e.haveSeenDepthRequest=!0,e.renderDepth=!0,t.render(),e.renderDepth=!1)},t.opaqueZBufferPass=i=>t.zBufferPass(i),t.opaquePass=i=>{i&&t.render()},t.getCoincidentParameters=(i,a)=>e.renderable.getResolveCoincidentTopology()==Cc.PolygonOffset?e.renderable.getCoincidentTopologyPolygonOffsetParameters():null,t.render=()=>{const i=e._openGLImageSlice.getRenderable(),a=e._openGLRenderer.getRenderable();t.renderPiece(a,i)},t.renderPiece=(i,a)=>{if(t.invokeEvent({type:"StartEvent"}),e.renderable.update(),e.currentInput=e.renderable.getInputData(),!e.currentInput){W0("No input!");return}t.updateResliceGeometry(),t.renderPieceStart(i,a),t.renderPieceDraw(i,a),t.renderPieceFinish(i,a),t.invokeEvent({type:"EndEvent"})},t.renderPieceStart=(i,a)=>{t.updateBufferObjects(i,a),a.getProperty().getInterpolationType()===Vh.NEAREST?(e.openGLTexture.setMinificationFilter(on.NEAREST),e.openGLTexture.setMagnificationFilter(on.NEAREST),e.colorTexture.setMinificationFilter(on.NEAREST),e.colorTexture.setMagnificationFilter(on.NEAREST),e.pwfTexture.setMinificationFilter(on.NEAREST),e.pwfTexture.setMagnificationFilter(on.NEAREST)):(e.openGLTexture.setMinificationFilter(on.LINEAR),e.openGLTexture.setMagnificationFilter(on.LINEAR),e.colorTexture.setMinificationFilter(on.LINEAR),e.colorTexture.setMagnificationFilter(on.LINEAR),e.pwfTexture.setMinificationFilter(on.LINEAR),e.pwfTexture.setMagnificationFilter(on.LINEAR)),e.lastBoundBO=null},t.renderPieceDraw=(i,a)=>{const o=e.context;e.openGLTexture.activate(),e.colorTexture.activate(),e.pwfTexture.activate(),t.updateShaders(e.tris,i,a),o.drawArrays(o.TRIANGLES,0,e.tris.getCABO().getElementCount()),e.tris.getVAO().release(),e.openGLTexture.deactivate(),e.colorTexture.deactivate(),e.pwfTexture.deactivate()},t.renderPieceFinish=(i,a)=>{},t.updateBufferObjects=(i,a)=>{t.getNeedToRebuildBufferObjects(i,a)&&t.buildBufferObjects(i,a)},t.getNeedToRebuildBufferObjects=(i,a)=>e.VBOBuildTime.getMTime()<t.getMTime()||e.VBOBuildTime.getMTime()<a.getMTime()||e.VBOBuildTime.getMTime()<e.renderable.getMTime()||e.VBOBuildTime.getMTime()<a.getProperty().getMTime()||e.VBOBuildTime.getMTime()<e.currentInput.getMTime()||e.VBOBuildTime.getMTime()<e.resliceGeom.getMTime()||!e.openGLTexture?.getHandle()||!e.colorTexture?.getHandle()||!e.pwfTexture?.getHandle(),t.buildBufferObjects=(i,a)=>{const o=e.currentInput;if(!o)return;const s=o.getPointData()?.getScalars();if(!s)return;const l=s.getNumberOfComponents();let c=mD(o,s);const f=e._openGLRenderWindow.getGraphicsResourceForObject(s),u=!f?.oglObject?.getHandle()||f?.hash!==c,d=e.renderable.getUpdatedExtents(),h=!!d.length;if(u&&!h){e.openGLTexture=ti.newInstance(),e.openGLTexture.setOpenGLRenderWindow(e._openGLRenderWindow),e.openGLTexture.setOglNorm16Ext(e.context.getExtension("EXT_texture_norm16")),e.openGLTexture.resetFormatAndType();const I=o.getDimensions();e.openGLTexture.create3DFilterableFromDataArray(I[0],I[1],I[2],s,!1,d),e._openGLRenderWindow.setGraphicsResourceForObject(s,e.openGLTexture,c),s!==e._scalars&&(e._openGLRenderWindow.registerGraphicsResourceUser(s,t),e._openGLRenderWindow.unregisterGraphicsResourceUser(e._scalars,t)),e._scalars=s}else e.openGLTexture=f.oglObject;if(h){e.renderable.setUpdatedExtents([]);const I=o.getDimensions();e.openGLTexture.create3DFilterableFromDataArray(I[0],I[1],I[2],s,!1,d)}const p=a.getProperty(),g=p.getIndependentComponents(),m=g?l:1,y=g?2*m:1,v=p.getRGBTransferFunction();c=vu(v,g,m);const x=e._openGLRenderWindow.getGraphicsResourceForObject(v);if(!x?.oglObject?.getHandle()||x?.hash!==c){const R=1024*y*3,M=new Uint8ClampedArray(R);if(e.colorTexture=ti.newInstance(),e.colorTexture.setOpenGLRenderWindow(e._openGLRenderWindow),v){const A=new Float32Array(3072);for(let L=0;L<m;L++){const P=p.getRGBTransferFunction(L),B=P.getRange();if(P.getTable(B[0],B[1],1024,A,1),g)for(let U=0;U<1024*3;U++)M[L*1024*6+U]=255*A[U],M[L*1024*6+U+1024*3]=255*A[U];else for(let U=0;U<1024*3;U++)M[L*1024*6+U]=255*A[U]}e.colorTexture.resetFormatAndType(),e.colorTexture.create2DFromRaw(1024,y,3,Nn.UNSIGNED_CHAR,M)}else{for(let A=0;A<1024*3;++A)M[A]=255*A/(1023*3),M[A+1]=255*A/(1023*3),M[A+2]=255*A/(1023*3);e.colorTexture.resetFormatAndType(),e.colorTexture.create2DFromRaw(1024,1,3,Nn.UNSIGNED_CHAR,M)}v&&(e._openGLRenderWindow.setGraphicsResourceForObject(v,e.colorTexture,c),v!==e._colorTransferFunc&&(e._openGLRenderWindow.registerGraphicsResourceUser(v,t),e._openGLRenderWindow.unregisterGraphicsResourceUser(e._colorTransferFunc,t)),e._colorTransferFunc=v)}else e.colorTexture=x.oglObject;const S=p.getPiecewiseFunction();c=vu(S,g,m);const T=e._openGLRenderWindow.getGraphicsResourceForObject(S);if(!T?.oglObject?.getHandle()||T?.hash!==c){const R=1024*y,M=new Uint8ClampedArray(R);if(e.pwfTexture=ti.newInstance(),e.pwfTexture.setOpenGLRenderWindow(e._openGLRenderWindow),S){const A=new Float32Array(R),L=new Float32Array(1024);for(let P=0;P<m;++P){const B=p.getPiecewiseFunction(P);if(B===null)A.fill(1);else{const U=B.getRange();if(B.getTable(U[0],U[1],1024,L,1),g)for(let G=0;G<1024;G++)A[P*1024*2+G]=L[G],A[P*1024*2+G+1024]=L[G];else for(let G=0;G<1024;G++)A[P*1024*2+G]=L[G]}}e.pwfTexture.resetFormatAndType(),e.pwfTexture.create2DFromRaw(1024,y,1,Nn.FLOAT,A)}else M.fill(255),e.pwfTexture.resetFormatAndType(),e.pwfTexture.create2DFromRaw(1024,1,1,Nn.UNSIGNED_CHAR,M);S&&(e._openGLRenderWindow.setGraphicsResourceForObject(S,e.pwfTexture,c),S!==e._pwFunc&&(e._openGLRenderWindow.registerGraphicsResourceUser(S,t),e._openGLRenderWindow.unregisterGraphicsResourceUser(e._pwFunc,t)),e._pwFunc=S)}else e.pwfTexture=T.oglObject;const D=`${e.resliceGeom.getMTime()}A${e.renderable.getSlabThickness()}`;if(!e.tris.getCABO().getElementCount()||e.VBOBuildString!==D){const I=nn.newInstance({numberOfComponents:3,values:e.resliceGeom.getPoints().getData()});I.setName("points");const R=nn.newInstance({numberOfComponents:1,values:e.resliceGeom.getPolys().getData()}),M={points:I,cellOffset:0};if(e.renderable.getSlabThickness()>0){const A=e.resliceGeom.getPointData().getNormals();A?M.normals=A:W0("Slab mode requested without normals")}e.tris.getCABO().createVBO(R,"polys",so.SURFACE,M)}e.VBOBuildString=D,e.VBOBuildTime.modified()},t.updateShaders=(i,a,o)=>{if(e.lastBoundBO=i,t.getNeedToRebuildShaders(i,a,o)){const s={Vertex:null,Fragment:null,Geometry:null};t.buildShaders(s,a,o);const l=e._openGLRenderWindow.getShaderCache().readyShaderProgramArray(s.Vertex,s.Fragment,s.Geometry);l!==i.getProgram()&&(i.setProgram(l),i.getVAO().releaseGraphicsResources()),i.getShaderSourceTime().modified()}else e._openGLRenderWindow.getShaderCache().readyShaderProgram(i.getProgram());i.getVAO().bind(),t.setMapperShaderParameters(i,a,o),t.setCameraShaderParameters(i,a,o),t.setPropertyShaderParameters(i,a,o)},t.setMapperShaderParameters=(i,a,o)=>{const s=i.getProgram();if(i.getCABO().getElementCount()&&(e.VBOBuildTime.getMTime()>i.getAttributeUpdateTime().getMTime()||i.getShaderSourceTime().getMTime()>i.getAttributeUpdateTime().getMTime())){s.isUniformUsed("texture1")&&s.setUniformi("texture1",e.openGLTexture.getTextureUnit()),s.isAttributeUsed("vertexWC")&&(i.getVAO().addAttributeArray(s,i.getCABO(),"vertexWC",i.getCABO().getVertexOffset(),i.getCABO().getStride(),e.context.FLOAT,3,e.context.FALSE)||W0("Error setting vertexWC in shader VAO.")),s.isAttributeUsed("normalWC")&&(i.getVAO().addAttributeArray(s,i.getCABO(),"normalWC",i.getCABO().getNormalOffset(),i.getCABO().getStride(),e.context.FLOAT,3,e.context.FALSE)||W0("Error setting normalWC in shader VAO.")),s.isUniformUsed("slabThickness")&&s.setUniformf("slabThickness",e.renderable.getSlabThickness()),s.isUniformUsed("spacing")&&s.setUniform3fv("spacing",e.currentInput.getSpacing()),s.isUniformUsed("slabType")&&s.setUniformi("slabType",e.renderable.getSlabType()),s.isUniformUsed("slabType")&&s.setUniformi("slabType",e.renderable.getSlabType()),s.isUniformUsed("slabTrapezoid")&&s.setUniformi("slabTrapezoid",e.renderable.getSlabTrapezoidIntegration());const c=i.getCABO().getCoordShiftAndScaleEnabled()?i.getCABO().getInverseShiftAndScaleMatrix():null;if(s.isUniformUsed("WCTCMatrix")){const f=e.currentInput,u=f.getDimensions();Ei(e.tmpMat4,f.getIndexToWorld()),si(e.tmpMat4,e.tmpMat4,[-.5,-.5,-.5]),p0(e.tmpMat4,e.tmpMat4,u),ba(e.tmpMat4,e.tmpMat4),c&&jn(e.tmpMat4,e.tmpMat4,c),s.setUniformMatrix("WCTCMatrix",e.tmpMat4)}s.isUniformUsed("vboScaling")&&s.setUniform3fv("vboScaling",i.getCABO().getCoordScale()??[1,1,1]),i.getAttributeUpdateTime().modified()}if(e.haveSeenDepthRequest&&i.getProgram().setUniformi("depthRequest",e.renderDepth?1:0),i.getProgram().isUniformUsed("coffset")){const l=t.getCoincidentParameters(a,o);i.getProgram().setUniformf("coffset",l.offset),i.getProgram().isUniformUsed("cfactor")&&i.getProgram().setUniformf("cfactor",l.factor)}},t.setCameraShaderParameters=(i,a,o)=>{const s=e._openGLCamera.getKeyMatrices(a),l=e._openGLImageSlice.getKeyMatrices(),f=i.getCABO().getCoordShiftAndScaleEnabled()?i.getCABO().getInverseShiftAndScaleMatrix():null,u=i.getProgram();u.isUniformUsed("MCPCMatrix")&&(sn(e.tmpMat4),u.setUniformMatrix("MCPCMatrix",ML([s.wcpc,l.mcwc,f],x2,e.tmpMat4))),u.isUniformUsed("MCVCMatrix")&&(sn(e.tmpMat4),u.setUniformMatrix("MCVCMatrix",ML([s.wcvc,l.mcwc,f],x2,e.tmpMat4)))},t.setPropertyShaderParameters=(i,a,o)=>{const s=i.getProgram(),l=o.getProperty(),c=l.getOpacity();s.setUniformf("opacity",c);const f=e.openGLTexture.getComponents(),u=l.getIndependentComponents();if(u)for(let g=0;g<f;++g)s.setUniformf(`mix${g}`,l.getComponentWeight(g));const d=e.openGLTexture.getVolumeInfo();for(let g=0;g<f;g++){let m=l.getColorWindow(),y=l.getColorLevel();const v=u?g:0,x=l.getRGBTransferFunction(v);if(x&&l.getUseLookupTableScalarRange()){const T=x.getRange();m=T[1]-T[0],y=.5*(T[1]+T[0])}const w=d.scale[g]/m,S=(d.offset[g]-y)/m+.5;s.setUniformf(`cshift${g}`,S),s.setUniformf(`cscale${g}`,w)}const h=e.colorTexture.getTextureUnit();s.setUniformi("colorTexture1",h);for(let g=0;g<f;g++){let m=1,y=0;const v=u?g:0,x=l.getPiecewiseFunction(v);if(x){const w=x.getRange(),S=w[1]-w[0],T=.5*(w[0]+w[1]);m=d.scale[g]/S,y=(d.offset[g]-T)/S+.5}s.setUniformf(`pwfshift${g}`,y),s.setUniformf(`pwfscale${g}`,m)}const p=e.pwfTexture.getTextureUnit();s.setUniformi("pwfTexture1",p),s.setUniform4fv("backgroundColor",e.renderable.getBackgroundColor())},t.getNeedToRebuildShaders=(i,a,o)=>{const s=e.openGLTexture.getComponents(),l=o.getProperty().getIndependentComponents(),c=e.renderable.getSlabThickness(),f=e.renderable.getSlabType(),u=e.renderable.getSlabTrapezoidIntegration();let d=!1;return(!e.currentRenderPass&&e.lastRenderPassShaderReplacement||e.currentRenderPass&&e.currentRenderPass.getShaderReplacement()!==e.lastRenderPassShaderReplacement)&&(d=!0),d||e.lastHaveSeenDepthRequest!==e.haveSeenDepthRequest||i.getProgram()?.getHandle()===0||e.lastTextureComponents!==s||e.lastIndependentComponents!==l||e.lastSlabThickness!==c||e.lastSlabType!==f||e.lastSlabTrapezoidIntegration!==u?(e.lastHaveSeenDepthRequest=e.haveSeenDepthRequest,e.lastTextureComponents=s,e.lastIndependentComponents=l,e.lastSlabThickness=c,e.lastSlabType=f,e.lastSlabTrapezoidIntegration=u,!0):!1},t.getShaderTemplate=(i,a,o)=>{i.Vertex=z3e,i.Fragment=W3e,i.Geometry=""},t.replaceShaderValues=(i,a,o)=>{if(t.replaceShaderTCoord(i,a,o),t.replaceShaderPositionVC(i,a,o),e.haveSeenDepthRequest){let s=i.Fragment;s=Be.substitute(s,"//VTK::ZBuffer::Dec","uniform int depthRequest;").result,s=Be.substitute(s,"//VTK::ZBuffer::Impl",["if (depthRequest == 1) {","float iz = floor(gl_FragCoord.z*65535.0 + 0.1);","float rf = floor(iz/256.0)/255.0;","float gf = mod(iz,256.0)/255.0;","gl_FragData[0] = vec4(rf, gf, 0.0, 1.0); }"]).result,i.Fragment=s}t.replaceShaderCoincidentOffset(i,a,o)},t.replaceShaderTCoord=(i,a,o)=>{let s=i.Vertex;const l=i.Geometry;let c=i.Fragment;const f=["uniform mat4 WCTCMatrix;","out vec3 fragTexCoord;"],u=e.renderable.getSlabThickness();s=Be.substitute(s,"//VTK::TCoord::Dec",f).result;const d=["fragTexCoord = (WCTCMatrix * vertexWC).xyz;"];s=Be.substitute(s,"//VTK::TCoord::Impl",d).result;const h=e.openGLTexture.getComponents(),p=o.getProperty().getIndependentComponents();let g=["in vec3 fragTexCoord;","uniform highp sampler3D texture1;","uniform mat4 WCTCMatrix;","uniform float cshift0;","uniform float cscale0;","uniform float pwfshift0;","uniform float pwfscale0;","uniform sampler2D colorTexture1;","uniform sampler2D pwfTexture1;","uniform float opacity;","uniform vec4 backgroundColor;"];if(p){for(let y=1;y<h;y++)g=g.concat([`uniform float cshift${y};`,`uniform float cscale${y};`,`uniform float pwfshift${y};`,`uniform float pwfscale${y};`]);switch(h){case 1:g=g.concat(["uniform float mix0;","#define height0 0.5"]);break;case 2:g=g.concat(["uniform float mix0;","uniform float mix1;","#define height0 0.25","#define height1 0.75"]);break;case 3:g=g.concat(["uniform float mix0;","uniform float mix1;","uniform float mix2;","#define height0 0.17","#define height1 0.5","#define height2 0.83"]);break;case 4:g=g.concat(["uniform float mix0;","uniform float mix1;","uniform float mix2;","uniform float mix3;","#define height0 0.125","#define height1 0.375","#define height2 0.625","#define height3 0.875"]);break;default:W0("Unsupported number of independent coordinates.")}}u>0&&(g=g.concat(["uniform vec3 spacing;","uniform float slabThickness;","uniform int slabType;","uniform int slabTrapezoid;","uniform vec3 vboScaling;"]),g=g.concat(["vec4 compositeValue(vec4 currVal, vec4 valToComp, int trapezoid)","{","  vec4 retVal = vec4(1.0);","  if (slabType == 0) // min","  {","    retVal = min(currVal, valToComp);","  }","  else if (slabType == 1) // max","  {","    retVal = max(currVal, valToComp);","  }","  else if (slabType == 3) // sum","  {","    retVal = currVal + (trapezoid > 0 ? 0.5 * valToComp : valToComp); ","  }","  else // mean","  {","    retVal = currVal + (trapezoid > 0 ? 0.5 * valToComp : valToComp); ","  }","  return retVal;","}"])),c=Be.substitute(c,"//VTK::TCoord::Dec",g).result;let m=["if (any(greaterThan(fragTexCoord, vec3(1.0))) || any(lessThan(fragTexCoord, vec3(0.0))))","{","  // set the background color and exit","  gl_FragData[0] = backgroundColor;","  return;","}","vec4 tvalue = texture(texture1, fragTexCoord);"];if(u>0&&(m=m.concat(["// Get the first and last samples","int numSlices = 1;","float scaling = min(min(spacing.x, spacing.y), spacing.z) * 0.5;","vec3 normalxspacing = scaling * normalWCVSOutput;","float distTraveled = length(normalxspacing);","int trapezoid = 0;","while (distTraveled < slabThickness * 0.5)","{","  distTraveled += length(normalxspacing);","  float fnumSlices = float(numSlices);","  if (distTraveled > slabThickness * 0.5)","  {","    // Before stepping outside the slab, sample at the boundaries","    normalxspacing = normalWCVSOutput * slabThickness * 0.5 / fnumSlices;","    trapezoid = slabTrapezoid;","  }","  vec3 fragTCoordNeg = (WCTCMatrix * vec4(vertexWCVSOutput.xyz - fnumSlices * normalxspacing * vboScaling, 1.0)).xyz;","  if (!any(greaterThan(fragTCoordNeg, vec3(1.0))) && !any(lessThan(fragTCoordNeg, vec3(0.0))))","  {","    vec4 newVal = texture(texture1, fragTCoordNeg);","    tvalue = compositeValue(tvalue, newVal, trapezoid);","    numSlices += 1;","  }","  vec3 fragTCoordPos = (WCTCMatrix * vec4(vertexWCVSOutput.xyz + fnumSlices * normalxspacing * vboScaling, 1.0)).xyz;","  if (!any(greaterThan(fragTCoordNeg, vec3(1.0))) && !any(lessThan(fragTCoordNeg, vec3(0.0))))","  {","    vec4 newVal = texture(texture1, fragTCoordPos);","    tvalue = compositeValue(tvalue, newVal, trapezoid);","    numSlices += 1;","  }","}","// Finally, if slab type is *mean*, divide the sum by the numSlices","if (slabType == 2)","{","  tvalue = tvalue / float(numSlices);","}"])),p){const y=["r","g","b","a"];for(let v=0;v<h;++v)m=m.concat([`vec3 tcolor${v} = mix${v} * texture2D(colorTexture1, vec2(tvalue.${y[v]} * cscale${v} + cshift${v}, height${v})).rgb;`,`float compWeight${v} = mix${v} * texture2D(pwfTexture1, vec2(tvalue.${y[v]} * pwfscale${v} + pwfshift${v}, height${v})).r;`]);switch(h){case 1:m=m.concat(["gl_FragData[0] = vec4(tcolor0.rgb, compWeight0 * opacity);"]);break;case 2:m=m.concat(["float weightSum = compWeight0 + compWeight1;","gl_FragData[0] = vec4(vec3((tcolor0.rgb * (compWeight0 / weightSum)) + (tcolor1.rgb * (compWeight1 / weightSum))), opacity);"]);break;case 3:m=m.concat(["float weightSum = compWeight0 + compWeight1 + compWeight2;","gl_FragData[0] = vec4(vec3((tcolor0.rgb * (compWeight0 / weightSum)) + (tcolor1.rgb * (compWeight1 / weightSum)) + (tcolor2.rgb * (compWeight2 / weightSum))), opacity);"]);break;case 4:m=m.concat(["float weightSum = compWeight0 + compWeight1 + compWeight2 + compWeight3;","gl_FragData[0] = vec4(vec3((tcolor0.rgb * (compWeight0 / weightSum)) + (tcolor1.rgb * (compWeight1 / weightSum)) + (tcolor2.rgb * (compWeight2 / weightSum)) + (tcolor3.rgb * (compWeight3 / weightSum))), opacity);"]);break;default:W0("Unsupported number of independent coordinates.")}}else switch(h){case 1:m=m.concat(["// Dependent components","float intensity = tvalue.r;","vec3 tcolor = texture2D(colorTexture1, vec2(intensity * cscale0 + cshift0, 0.5)).rgb;","float scalarOpacity = texture2D(pwfTexture1, vec2(intensity * pwfscale0 + pwfshift0, 0.5)).r;","gl_FragData[0] = vec4(tcolor, scalarOpacity * opacity);"]);break;case 2:m=m.concat(["float intensity = tvalue.r*cscale0 + cshift0;","gl_FragData[0] = vec4(texture2D(colorTexture1, vec2(intensity, 0.5)).rgb, pwfscale0*tvalue.g + pwfshift0);"]);break;case 3:m=m.concat(["vec4 tcolor = cscale0*tvalue + cshift0;","gl_FragData[0] = vec4(texture2D(colorTexture1, vec2(tcolor.r,0.5)).r,","  texture2D(colorTexture1, vec2(tcolor.g,0.5)).r,","  texture2D(colorTexture1, vec2(tcolor.b,0.5)).r, opacity);"]);break;default:m=m.concat(["vec4 tcolor = cscale0*tvalue + cshift0;","gl_FragData[0] = vec4(texture2D(colorTexture1, vec2(tcolor.r,0.5)).r,","  texture2D(colorTexture1, vec2(tcolor.g,0.5)).r,","  texture2D(colorTexture1, vec2(tcolor.b,0.5)).r, tcolor.a);"])}c=Be.substitute(c,"//VTK::TCoord::Impl",m).result,i.Vertex=s,i.Fragment=c,i.Geometry=l},t.replaceShaderPositionVC=(i,a,o)=>{let s=i.Vertex;const l=i.Geometry;let c=i.Fragment;const f=e.renderable.getSlabThickness();let u=["attribute vec4 vertexWC;"];u=u.concat([`//${t.getMTime()}${e.resliceGeomUpdateString}`]),f>0&&(u=u.concat(["attribute vec3 normalWC;","varying vec3 normalWCVSOutput;","varying vec4 vertexWCVSOutput;"])),s=Be.substitute(s,"//VTK::PositionVC::Dec",u).result;let d=["gl_Position = MCPCMatrix * vertexWC;"];f>0&&(d=d.concat(["normalWCVSOutput = normalWC;","vertexWCVSOutput = vertexWC;"])),s=Be.substitute(s,"//VTK::PositionVC::Impl",d).result,s=Be.substitute(s,"//VTK::Camera::Dec",["uniform mat4 MCPCMatrix;","uniform mat4 MCVCMatrix;"]).result;let h=[];f>0&&(h=h.concat(["varying vec3 normalWCVSOutput;","varying vec4 vertexWCVSOutput;"])),c=Be.substitute(c,"//VTK::PositionVC::Dec",h).result,i.Vertex=s,i.Geometry=l,i.Fragment=c};function r(i){Hs.normalize(i);const a=[0,0,0];for(let o=0;o<3;++o){v5e(a),a[o]=1;const s=Hs.dot(i,a);if(s<-.999999||s>.999999)return[!0,o]}return[!1,2]}t.updateResliceGeometry=()=>{let i="";const a=e.currentInput,o=a?.getBounds();let s=!0,l=2;const c=e.renderable.getSlicePolyData(),f=e.renderable.getSlicePlane();if(c)i=i.concat(`PolyData${c.getMTime()}`);else if(f){i=i.concat(`Plane${f.getMTime()}`);const u=q9();a&&(i=i.concat(`Image${a.getMTime()}`),pK(u,...a.getDirection()),iy(u,u));const d=[...f.getNormal()];ub(d,d,u),[s,l]=r(d)}else{const u=Do.newInstance();u.setNormal(0,0,1);let d=[0,1,0,1,0,1];a&&(d=o),u.setOrigin(d[0],d[2],.5*(d[5]+d[4])),e.renderable.setSlicePlane(u),i=i.concat(`Plane${f?.getMTime()}`),a&&(i=i.concat(`Image${a.getMTime()}`))}if(!e.resliceGeom||e.resliceGeomUpdateString!==i){if(c)e.resliceGeom||(e.resliceGeom=ra.newInstance()),e.resliceGeom.getPoints().setData(c.getPoints().getData(),3),e.resliceGeom.getPolys().setData(c.getPolys().getData(),1),e.resliceGeom.getPointData().setNormals(c.getPointData().getNormals());else if(f)if(s){const u=new Float32Array(12),d=a.worldToIndex(f.getOrigin(),[0,0,0]),h=[(l+1)%3,(l+2)%3].sort(),p=a.getSpatialExtent();let g=0;for(let w=0;w<2;++w)for(let S=0;S<2;++S)u[g+l]=d[l],u[g+h[0]]=p[2*h[0]+S],u[g+h[1]]=p[2*h[1]+w],g+=3;e.transform.setMatrix(a.getIndexToWorld()),e.transform.transformPoints(u,u);const m=new Uint16Array(8);m[0]=3,m[1]=0,m[2]=1,m[3]=3,m[4]=3,m[5]=0,m[6]=3,m[7]=2;const y=f.getNormal();Hs.normalize(y);const v=new Float32Array(12);for(let w=0;w<4;++w)v[3*w]=y[0],v[3*w+1]=y[1],v[3*w+2]=y[2];e.resliceGeom||(e.resliceGeom=ra.newInstance()),e.resliceGeom.getPoints().setData(u,3),e.resliceGeom.getPolys().setData(m,1);const x=nn.newInstance({numberOfComponents:3,values:v,name:"Normals"});e.resliceGeom.getPointData().setNormals(x)}else{e.outlineFilter.setInputData(a),e.cutter.setInputConnection(e.outlineFilter.getOutputPort()),e.cutter.setCutFunction(f),e.lineToSurfaceFilter.setInputConnection(e.cutter.getOutputPort()),e.lineToSurfaceFilter.update(),e.resliceGeom||(e.resliceGeom=ra.newInstance());const u=e.lineToSurfaceFilter.getOutputData();e.resliceGeom.getPoints().setData(u.getPoints().getData(),3),e.resliceGeom.getPolys().setData(u.getPolys().getData(),1),e.resliceGeom.getPointData().setNormals(u.getPointData().getNormals());const d=f.getNormal(),h=e.resliceGeom.getNumberOfPoints();Hs.normalize(d);const p=new Float32Array(h*3);for(let m=0;m<h;++m)p[3*m]=d[0],p[3*m+1]=d[1],p[3*m+2]=d[2];const g=nn.newInstance({numberOfComponents:3,values:p,name:"Normals"});e.resliceGeom.getPointData().setNormals(g)}else W0("Something went wrong.","A default slice plane should have been created in the beginning of","updateResliceGeometry.");e.resliceGeomUpdateString=i,e.resliceGeom?.modified()}},t.setOpenGLTexture=i=>{i&&(e.openGLTexture=i,e._externalOpenGLTexture=!0)},t.delete=Q2(()=>{e._openGLRenderWindow&&n(e._openGLRenderWindow)},t.delete)}const awe={VBOBuildTime:{},VBOBuildString:null,haveSeenDepthRequest:!1,lastHaveSeenDepthRequest:!1,lastIndependentComponents:!1,lastTextureComponents:0,lastSlabThickness:0,lastSlabTrapezoidIntegration:0,lastSlabType:-1,openGLTexture:null,colorTextureString:null,pwfTextureString:null,resliceGeom:null,resliceGeomUpdateString:null,tris:null,colorTexture:null,pwfTexture:null,_externalOpenGLTexture:!1};function owe(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,awe,n),Rr.extend(t,e,n),mu.implementReplaceShaderCoincidentOffset(t,e,n),mu.implementBuildShadersWithReplacements(t,e,n),e.tris=Tu.newInstance(),e.openGLTexture=null,e.colorTexture=null,e.pwfTexture=null,e.VBOBuildTime={},$r(e.VBOBuildTime),e.tmpMat4=sn(new Float64Array(16)),e.outlineFilter=I3e.newInstance(),e.outlineFilter.setGenerateFaces(!0),e.outlineFilter.setGenerateLines(!1),e.cubePolyData=ra.newInstance(),e.cutter=Hbe.newInstance(),e.lineToSurfaceFilter=$be.newInstance(),e.transform=j3e.newInstance(),Po(t,e,["openGLTexture"]),iwe(t,e)}const swe=Zn(owe,"vtkOpenGLImageResliceMapper");sa("vtkImageResliceMapper",swe);const lwe={NONE:-1,I:0,J:1,K:2,X:3,Y:4,Z:5};var Yw={SlicingMode:lwe},yD=`//VTK::System::Dec

/*=========================================================================

  Program:   Visualization Toolkit
  Module:    vtkPolyDataVS.glsl

  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen
  All rights reserved.
  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.

     This software is distributed WITHOUT ANY WARRANTY; without even
     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
     PURPOSE.  See the above copyright notice for more information.

=========================================================================*/

attribute vec4 vertexMC;

// frag position in VC
//VTK::PositionVC::Dec

// optional normal declaration
//VTK::Normal::Dec

// extra lighting parameters
//VTK::Light::Dec

// Texture coordinates
//VTK::TCoord::Dec

// material property values
//VTK::Color::Dec

// clipping plane vars
//VTK::Clip::Dec

// camera and actor matrix values
//VTK::Camera::Dec

// Apple Bug
//VTK::PrimID::Dec

// picking support
//VTK::Picking::Dec

void main()
{
  //VTK::Color::Impl

  //VTK::Normal::Impl

  //VTK::TCoord::Impl

  //VTK::Clip::Impl

  //VTK::PrimID::Impl

  //VTK::PositionVC::Impl

  //VTK::Light::Impl

  //VTK::Picking::Impl
}
`,oy=`//VTK::System::Dec

/*=========================================================================

  Program:   Visualization Toolkit
  Module:    vtkPolyDataFS.glsl

  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen
  All rights reserved.
  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.

     This software is distributed WITHOUT ANY WARRANTY; without even
     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
     PURPOSE.  See the above copyright notice for more information.

=========================================================================*/
// Template for the polydata mappers fragment shader

uniform int PrimitiveIDOffset;

// VC position of this fragment
//VTK::PositionVC::Dec

// optional color passed in from the vertex shader, vertexColor
//VTK::Color::Dec

// optional surface normal declaration
//VTK::Normal::Dec

// extra lighting parameters
//VTK::Light::Dec

// define vtkImageLabelOutlineOn
//VTK::ImageLabelOutlineOn

// Texture coordinates
//VTK::TCoord::Dec

// picking support
//VTK::Picking::Dec

// Depth Peeling Support
//VTK::DepthPeeling::Dec

// clipping plane vars
//VTK::Clip::Dec

// label outline 
//VTK::LabelOutline::Dec

// the output of this shader
//VTK::Output::Dec

// Apple Bug
//VTK::PrimID::Dec

// handle coincident offsets
//VTK::Coincident::Dec

//VTK::ZBuffer::Dec

//VTK::LabelOutlineHelperFunction

void main()
{
  // VC position of this fragment. This should not branch/return/discard.
  //VTK::PositionVC::Impl

  // Place any calls that require uniform flow (e.g. dFdx) here.
  //VTK::UniformFlow::Impl

  // Set gl_FragDepth here (gl_FragCoord.z by default)
  //VTK::Depth::Impl

  // Early depth peeling abort:
  //VTK::DepthPeeling::PreColor

  // Apple Bug
  //VTK::PrimID::Impl

  //VTK::Clip::Impl

  //VTK::Color::Impl

  // Generate the normal if we are not passed in one
  //VTK::Normal::Impl

  //VTK::TCoord::Impl

  //VTK::Light::Impl

  if (gl_FragData[0].a <= 0.0)
    {
    discard;
    }

  //VTK::DepthPeeling::Impl

  //VTK::Picking::Impl

  // handle coincident offsets
  //VTK::Coincident::Impl

  //VTK::ZBuffer::Impl

  //VTK::RenderPassFragmentShader::Impl
}
`;const{vtkErrorMacro:Yp}=po,{SlicingMode:Bs}=Yw;function cwe(t){const e=t.split(`
`),n=[];for(let r=0;r<e.length;++r){const i=e[r].trim();i.length>0&&n.push(i)}return n}function uwe(t,e){e.classHierarchy.push("vtkOpenGLImageMapper");function n(r){e.openGLTexture.releaseGraphicsResources(r),[e._colorTransferFunc,e._pwFunc,e._labelOutlineThicknessArray].forEach(i=>r.unregisterGraphicsResourceUser(i,t))}t.buildPass=r=>{if(r){e.currentRenderPass=null,e.openGLImageSlice=t.getFirstAncestorOfType("vtkOpenGLImageSlice"),e._openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer");const i=e._openGLRenderWindow;e._openGLRenderWindow=e._openGLRenderer.getLastAncestorOfType("vtkOpenGLRenderWindow"),i&&!i.isDeleted()&&i!==e._openGLRenderWindow&&n(i),e.context=e._openGLRenderWindow.getContext(),e.tris.setOpenGLRenderWindow(e._openGLRenderWindow);const a=e._openGLRenderer.getRenderable();e.openGLCamera=e._openGLRenderer.getViewNodeFor(a.getActiveCamera()),e.renderable.isA("vtkImageMapper")&&e.renderable.getSliceAtFocalPoint()&&e.renderable.setSliceFromCamera(a.getActiveCamera())}},t.translucentPass=(r,i)=>{r&&(e.currentRenderPass=i,t.render())},t.zBufferPass=r=>{r&&(e.haveSeenDepthRequest=!0,e.renderDepth=!0,t.render(),e.renderDepth=!1)},t.opaqueZBufferPass=r=>t.zBufferPass(r),t.opaquePass=r=>{r&&t.render()},t.getCoincidentParameters=(r,i)=>e.renderable.getResolveCoincidentTopology()==Cc.PolygonOffset?e.renderable.getCoincidentTopologyPolygonOffsetParameters():null,t.render=()=>{const r=e.openGLImageSlice.getRenderable(),i=e._openGLRenderer.getRenderable();t.renderPiece(i,r)},t.getShaderTemplate=(r,i,a)=>{r.Vertex=yD,r.Fragment=oy,r.Geometry=""},t.replaceShaderValues=(r,i,a)=>{let o=r.Vertex,s=r.Fragment;o=Be.substitute(o,"//VTK::Camera::Dec",["uniform mat4 MCPCMatrix;"]).result,o=Be.substitute(o,"//VTK::PositionVC::Impl",["  gl_Position = MCPCMatrix * vertexMC;"]).result,o=Be.substitute(o,"//VTK::TCoord::Impl","tcoordVCVSOutput = tcoordMC;").result,o=Be.substitute(o,"//VTK::TCoord::Dec","attribute vec2 tcoordMC; varying vec2 tcoordVCVSOutput;").result;const l=e.openGLTexture.getComponents(),c=a.getProperty().getIndependentComponents();let f=["varying vec2 tcoordVCVSOutput;","uniform float cshift0;","uniform float cscale0;","uniform float pwfshift0;","uniform float pwfscale0;","uniform sampler2D texture1;","uniform sampler2D colorTexture1;","uniform sampler2D pwfTexture1;","uniform sampler2D labelOutlineTexture1;","uniform float opacity;","uniform float outlineOpacity;"];if(c){for(let d=1;d<l;d++)f=f.concat([`uniform float cshift${d};`,`uniform float cscale${d};`,`uniform float pwfshift${d};`,`uniform float pwfscale${d};`]);switch(l){case 1:f=f.concat(["uniform float mix0;","#define height0 0.5"]);break;case 2:f=f.concat(["uniform float mix0;","uniform float mix1;","#define height0 0.25","#define height1 0.75"]);break;case 3:f=f.concat(["uniform float mix0;","uniform float mix1;","uniform float mix2;","#define height0 0.17","#define height1 0.5","#define height2 0.83"]);break;case 4:f=f.concat(["uniform float mix0;","uniform float mix1;","uniform float mix2;","uniform float mix3;","#define height0 0.125","#define height1 0.375","#define height2 0.625","#define height3 0.875"]);break;default:Yp("Unsupported number of independent coordinates.")}}if(s=Be.substitute(s,"//VTK::TCoord::Dec",f).result,a.getProperty().getUseLabelOutline()===!0&&(s=Be.substitute(s,"//VTK::LabelOutline::Dec",["uniform int outlineThickness;","uniform float vpWidth;","uniform float vpHeight;","uniform float vpOffsetX;","uniform float vpOffsetY;","uniform mat4 PCWCMatrix;","uniform mat4 vWCtoIDX;","uniform ivec3 imageDimensions;","uniform int sliceAxis;"]).result,s=Be.substitute(s,"//VTK::ImageLabelOutlineOn","#define vtkImageLabelOutlineOn").result,s=Be.substitute(s,"//VTK::LabelOutlineHelperFunction",["#ifdef vtkImageLabelOutlineOn","vec3 fragCoordToIndexSpace(vec4 fragCoord) {","  vec4 pcPos = vec4(","    (fragCoord.x / vpWidth - vpOffsetX - 0.5) * 2.0,","    (fragCoord.y / vpHeight - vpOffsetY - 0.5) * 2.0,","    (fragCoord.z - 0.5) * 2.0,","    1.0);","","  vec4 worldCoord = PCWCMatrix * pcPos;","  vec4 vertex = (worldCoord/worldCoord.w);","","  vec3 index = (vWCtoIDX * vertex).xyz;","","  // half voxel fix for labelmapOutline","  return (index + vec3(0.5)) / vec3(imageDimensions);","}","vec2 getSliceCoords(vec3 coord, int axis) {","  if (axis == 0) return coord.yz;","  if (axis == 1) return coord.xz;","  if (axis == 2) return coord.xy;","}","#endif"]).result),c){const d=["r","g","b","a"];let h=["vec4 tvalue = texture2D(texture1, tcoordVCVSOutput);"];for(let p=0;p<l;p++)h=h.concat([`vec3 tcolor${p} = mix${p} * texture2D(colorTexture1, vec2(tvalue.${d[p]} * cscale${p} + cshift${p}, height${p})).rgb;`,`float compWeight${p} = mix${p} * texture2D(pwfTexture1, vec2(tvalue.${d[p]} * pwfscale${p} + pwfshift${p}, height${p})).r;`]);switch(l){case 1:h=h.concat(["gl_FragData[0] = vec4(tcolor0.rgb, opacity);"]);break;case 2:h=h.concat(["float weightSum = compWeight0 + compWeight1;","gl_FragData[0] = vec4(vec3((tcolor0.rgb * (compWeight0 / weightSum)) + (tcolor1.rgb * (compWeight1 / weightSum))), opacity);"]);break;case 3:h=h.concat(["float weightSum = compWeight0 + compWeight1 + compWeight2;","gl_FragData[0] = vec4(vec3((tcolor0.rgb * (compWeight0 / weightSum)) + (tcolor1.rgb * (compWeight1 / weightSum)) + (tcolor2.rgb * (compWeight2 / weightSum))), opacity);"]);break;case 4:h=h.concat(["float weightSum = compWeight0 + compWeight1 + compWeight2 + compWeight3;","gl_FragData[0] = vec4(vec3((tcolor0.rgb * (compWeight0 / weightSum)) + (tcolor1.rgb * (compWeight1 / weightSum)) + (tcolor2.rgb * (compWeight2 / weightSum)) + (tcolor3.rgb * (compWeight3 / weightSum))), opacity);"]);break;default:Yp("Unsupported number of independent coordinates.")}s=Be.substitute(s,"//VTK::TCoord::Impl",h).result}else switch(l){case 1:s=Be.substitute(s,"//VTK::TCoord::Impl",[...cwe(`
                #ifdef vtkImageLabelOutlineOn
                  vec3 centerPosIS = fragCoordToIndexSpace(gl_FragCoord);
                  float centerValue = texture2D(texture1, getSliceCoords(centerPosIS, sliceAxis)).r;
                  bool pixelOnBorder = false;
                  vec3 tColor = texture2D(colorTexture1, vec2(centerValue * cscale0 + cshift0, 0.5)).rgb;
                  float scalarOpacity = texture2D(pwfTexture1, vec2(centerValue * pwfscale0 + pwfshift0, 0.5)).r;
                  float opacityToUse = scalarOpacity * opacity;
                  int segmentIndex = int(centerValue * 255.0);
                  float textureCoordinate = float(segmentIndex - 1) / 1024.0;
                  float textureValue = texture2D(labelOutlineTexture1, vec2(textureCoordinate, 0.5)).r;
                  int actualThickness = int(textureValue * 255.0);

                  if (segmentIndex == 0){
                    gl_FragData[0] = vec4(0.0, 0.0, 0.0, 0.0);
                    return;
                  }

                  for (int i = -actualThickness; i <= actualThickness; i++) {
                    for (int j = -actualThickness; j <= actualThickness; j++) {
                      if (i == 0 || j == 0) {
                        continue;
                      }
                      vec4 neighborPixelCoord = vec4(gl_FragCoord.x + float(i),
                        gl_FragCoord.y + float(j),
                        gl_FragCoord.z, gl_FragCoord.w);
                      vec3 neighborPosIS = fragCoordToIndexSpace(neighborPixelCoord);
                      float value = texture2D(texture1, getSliceCoords(neighborPosIS, sliceAxis)).r;
                      if (value != centerValue) {
                        pixelOnBorder = true;
                        break;
                      }
                    }
                    if (pixelOnBorder == true) {
                      break;
                    }
                  }
                  if (pixelOnBorder == true) {
                    gl_FragData[0] = vec4(tColor, outlineOpacity);
                  }
                  else {
                    gl_FragData[0] = vec4(tColor, opacityToUse);
                  }
                #else
                  float intensity = texture2D(texture1, tcoordVCVSOutput).r;
                  vec3 tcolor = texture2D(colorTexture1, vec2(intensity * cscale0 + cshift0, 0.5)).rgb;
                  float scalarOpacity = texture2D(pwfTexture1, vec2(intensity * pwfscale0 + pwfshift0, 0.5)).r;
                  gl_FragData[0] = vec4(tcolor, scalarOpacity * opacity);
                #endif
                `)]).result;break;case 2:s=Be.substitute(s,"//VTK::TCoord::Impl",["vec4 tcolor = texture2D(texture1, tcoordVCVSOutput);","float intensity = tcolor.r*cscale0 + cshift0;","gl_FragData[0] = vec4(texture2D(colorTexture1, vec2(intensity, 0.5)).rgb, pwfscale0*tcolor.g + pwfshift0);"]).result;break;case 3:s=Be.substitute(s,"//VTK::TCoord::Impl",["vec4 tcolor = cscale0*texture2D(texture1, tcoordVCVSOutput.st) + cshift0;","gl_FragData[0] = vec4(texture2D(colorTexture1, vec2(tcolor.r,0.5)).r,","  texture2D(colorTexture1, vec2(tcolor.g,0.5)).r,","  texture2D(colorTexture1, vec2(tcolor.b,0.5)).r, opacity);"]).result;break;default:s=Be.substitute(s,"//VTK::TCoord::Impl",["vec4 tcolor = cscale0*texture2D(texture1, tcoordVCVSOutput.st) + cshift0;","gl_FragData[0] = vec4(texture2D(colorTexture1, vec2(tcolor.r,0.5)).r,","  texture2D(colorTexture1, vec2(tcolor.g,0.5)).r,","  texture2D(colorTexture1, vec2(tcolor.b,0.5)).r, tcolor.a);"]).result}e.haveSeenDepthRequest&&(s=Be.substitute(s,"//VTK::ZBuffer::Dec","uniform int depthRequest;").result,s=Be.substitute(s,"//VTK::ZBuffer::Impl",["if (depthRequest == 1) {","float iz = floor(gl_FragCoord.z*65535.0 + 0.1);","float rf = floor(iz/256.0)/255.0;","float gf = mod(iz,256.0)/255.0;","gl_FragData[0] = vec4(rf, gf, 0.0, 1.0); }"]).result),r.Vertex=o,r.Fragment=s,t.replaceShaderClip(r,i,a),t.replaceShaderCoincidentOffset(r,i,a)},t.replaceShaderClip=(r,i,a)=>{let o=r.Vertex,s=r.Fragment;if(e.renderable.getNumberOfClippingPlanes()){let l=e.renderable.getNumberOfClippingPlanes();l>6&&(Bn("OpenGL has a limit of 6 clipping planes"),l=6),o=Be.substitute(o,"//VTK::Clip::Dec",["uniform int numClipPlanes;","uniform vec4 clipPlanes[6];","varying float clipDistancesVSOutput[6];"]).result,o=Be.substitute(o,"//VTK::Clip::Impl",["for (int planeNum = 0; planeNum < 6; planeNum++)","    {","    if (planeNum >= numClipPlanes)","        {","        break;","        }","    clipDistancesVSOutput[planeNum] = dot(clipPlanes[planeNum], vertexMC);","    }"]).result,s=Be.substitute(s,"//VTK::Clip::Dec",["uniform int numClipPlanes;","varying float clipDistancesVSOutput[6];"]).result,s=Be.substitute(s,"//VTK::Clip::Impl",["for (int planeNum = 0; planeNum < 6; planeNum++)","    {","    if (planeNum >= numClipPlanes)","        {","        break;","        }","    if (clipDistancesVSOutput[planeNum] < 0.0) discard;","    }"]).result}r.Vertex=o,r.Fragment=s},t.getNeedToRebuildShaders=(r,i,a)=>{const o=e.openGLTexture.getComponents(),s=a.getProperty().getIndependentComponents();let l=!1;return(!e.currentRenderPass&&e.lastRenderPassShaderReplacement||e.currentRenderPass&&e.currentRenderPass.getShaderReplacement()!==e.lastRenderPassShaderReplacement)&&(l=!0),l||e.lastHaveSeenDepthRequest!==e.haveSeenDepthRequest||r.getProgram()?.getHandle()===0||e.lastTextureComponents!==o||e.lastIndependentComponents!==s?(e.lastHaveSeenDepthRequest=e.haveSeenDepthRequest,e.lastTextureComponents=o,e.lastIndependentComponents=s,!0):!1},t.updateShaders=(r,i,a)=>{if(e.lastBoundBO=r,t.getNeedToRebuildShaders(r,i,a)){const o={Vertex:null,Fragment:null,Geometry:null};t.buildShaders(o,i,a);const s=e._openGLRenderWindow.getShaderCache().readyShaderProgramArray(o.Vertex,o.Fragment,o.Geometry);s!==r.getProgram()&&(r.setProgram(s),r.getVAO().releaseGraphicsResources()),r.getShaderSourceTime().modified()}else e._openGLRenderWindow.getShaderCache().readyShaderProgram(r.getProgram());r.getVAO().bind(),t.setMapperShaderParameters(r,i,a),t.setCameraShaderParameters(r,i,a),t.setPropertyShaderParameters(r,i,a)},t.setMapperShaderParameters=(r,i,a)=>{r.getCABO().getElementCount()&&(e.VBOBuildTime>r.getAttributeUpdateTime().getMTime()||r.getShaderSourceTime().getMTime()>r.getAttributeUpdateTime().getMTime())&&(r.getProgram().isAttributeUsed("vertexMC")&&(r.getVAO().addAttributeArray(r.getProgram(),r.getCABO(),"vertexMC",r.getCABO().getVertexOffset(),r.getCABO().getStride(),e.context.FLOAT,3,e.context.FALSE)||Yp("Error setting vertexMC in shader VAO.")),r.getProgram().isAttributeUsed("tcoordMC")&&r.getCABO().getTCoordOffset()&&(r.getVAO().addAttributeArray(r.getProgram(),r.getCABO(),"tcoordMC",r.getCABO().getTCoordOffset(),r.getCABO().getStride(),e.context.FLOAT,r.getCABO().getTCoordComponents(),e.context.FALSE)||Yp("Error setting tcoordMC in shader VAO.")),r.getAttributeUpdateTime().modified());const o=e.openGLTexture.getTextureUnit();r.getProgram().setUniformi("texture1",o);const s=e.openGLTexture.getComponents(),l=a.getProperty().getIndependentComponents();if(l)for(let p=0;p<s;p++)r.getProgram().setUniformf(`mix${p}`,a.getProperty().getComponentWeight(p));const c=e.openGLTexture.getShiftAndScale();for(let p=0;p<s;p++){let g=a.getProperty().getColorWindow(),m=a.getProperty().getColorLevel();const y=l?p:0,v=a.getProperty().getRGBTransferFunction(y);if(v&&a.getProperty().getUseLookupTableScalarRange()){const S=v.getRange();g=S[1]-S[0],m=.5*(S[1]+S[0])}const x=c.scale/g,w=(c.shift-m)/g+.5;r.getProgram().setUniformf(`cshift${p}`,w),r.getProgram().setUniformf(`cscale${p}`,x)}for(let p=0;p<s;p++){let g=1,m=0;const y=l?p:0,v=a.getProperty().getPiecewiseFunction(y);if(v){const x=v.getRange(),w=x[1]-x[0],S=.5*(x[0]+x[1]);g=c.scale/w,m=(c.shift-S)/w+.5}r.getProgram().setUniformf(`pwfshift${p}`,m),r.getProgram().setUniformf(`pwfscale${p}`,g)}if(e.haveSeenDepthRequest&&r.getProgram().setUniformi("depthRequest",e.renderDepth?1:0),r.getProgram().isUniformUsed("coffset")){const p=t.getCoincidentParameters(i,a);r.getProgram().setUniformf("coffset",p.offset),r.getProgram().isUniformUsed("cfactor")&&r.getProgram().setUniformf("cfactor",p.factor)}const f=e.colorTexture.getTextureUnit();r.getProgram().setUniformi("colorTexture1",f);const u=e.pwfTexture.getTextureUnit();r.getProgram().setUniformi("pwfTexture1",u);const d=e.labelOutlineThicknessTexture.getTextureUnit();if(r.getProgram().setUniformi("labelOutlineTexture1",d),e.renderable.getNumberOfClippingPlanes()){let p=e.renderable.getNumberOfClippingPlanes();p>6&&(Bn("OpenGL has a limit of 6 clipping planes"),p=6);const m=r.getCABO().getCoordShiftAndScaleEnabled()?r.getCABO().getInverseShiftAndScaleMatrix():null,y=m?Ei(e.imagematinv,a.getMatrix()):a.getMatrix();m&&(Gn(y,y),jn(y,y,m),Gn(y,y)),Gn(e.imagemat,e.currentInput.getIndexToWorld()),jn(e.imagematinv,y,e.imagemat);const v=[];for(let x=0;x<p;x++){const w=[];e.renderable.getClippingPlaneInDataCoords(e.imagematinv,x,w);for(let S=0;S<4;S++)v.push(w[S])}r.getProgram().setUniformi("numClipPlanes",p),r.getProgram().setUniform4fv("clipPlanes",v)}if(a.getProperty().getUseLabelOutline()===!0){const p=a.getProperty().getLabelOutlineOpacity();r.getProgram().setUniformf("outlineOpacity",p)}},t.setCameraShaderParameters=(r,i,a)=>{const o=r.getProgram(),s=e.openGLImageSlice.getKeyMatrices(),l=e.currentInput,c=l.getIndexToWorld();jn(e.imagemat,s.mcwc,c);const f=e.openGLCamera.getKeyMatrices(i);if(jn(e.imagemat,f.wcpc,e.imagemat),r.getCABO().getCoordShiftAndScaleEnabled()){const d=r.getCABO().getInverseShiftAndScaleMatrix();jn(e.imagemat,e.imagemat,d)}if(o.setUniformMatrix("MCPCMatrix",e.imagemat),a.getProperty().getUseLabelOutline()===!0){const d=l.getWorldToIndex(),h=l.getDimensions();let p=e.renderable.getClosestIJKAxis().ijkMode;p===Bs.NONE&&(p=Bs.K),o.setUniform3i("imageDimensions",h[0],h[1],h[2]),o.setUniformi("sliceAxis",p),o.setUniformMatrix("vWCtoIDX",d);const g=e.openGLCamera.getKeyMatrices(i);ba(e.projectionToWorld,g.wcpc),e.openGLCamera.getKeyMatrices(i),o.setUniformMatrix("PCWCMatrix",e.projectionToWorld);const m=t.getRenderTargetSize();o.setUniformf("vpWidth",m[0]),o.setUniformf("vpHeight",m[1]);const y=t.getRenderTargetOffset();o.setUniformf("vpOffsetX",y[0]/m[0]),o.setUniformf("vpOffsetY",y[1]/m[1])}},t.setPropertyShaderParameters=(r,i,a)=>{const o=r.getProgram(),l=a.getProperty().getOpacity();o.setUniformf("opacity",l)},t.renderPieceStart=(r,i)=>{t.updateBufferObjects(r,i),e.lastBoundBO=null},t.renderPieceDraw=(r,i)=>{const a=e.context;e.openGLTexture.activate(),e.colorTexture.activate(),e.labelOutlineThicknessTexture.activate(),e.pwfTexture.activate(),e.tris.getCABO().getElementCount()&&(t.updateShaders(e.tris,r,i),a.drawArrays(a.TRIANGLES,0,e.tris.getCABO().getElementCount()),e.tris.getVAO().release()),e.openGLTexture.deactivate(),e.colorTexture.deactivate(),e.labelOutlineThicknessTexture.deactivate(),e.pwfTexture.deactivate()},t.renderPieceFinish=(r,i)=>{},t.renderPiece=(r,i)=>{if(t.invokeEvent({type:"StartEvent"}),e.renderable.update(),e.currentInput=e.renderable.getCurrentImage(),t.invokeEvent({type:"EndEvent"}),!e.currentInput){Yp("No input!");return}t.renderPieceStart(r,i),t.renderPieceDraw(r,i),t.renderPieceFinish(r,i)},t.computeBounds=(r,i)=>{if(!t.getInput()){Nm(e.bounds);return}e.bounds=t.getInput().getBounds()},t.updateBufferObjects=(r,i)=>{t.getNeedToRebuildBufferObjects(r,i)&&t.buildBufferObjects(r,i)},t.getNeedToRebuildBufferObjects=(r,i)=>e.VBOBuildTime.getMTime()<t.getMTime()||e.VBOBuildTime.getMTime()<i.getMTime()||e.VBOBuildTime.getMTime()<e.renderable.getMTime()||e.VBOBuildTime.getMTime()<i.getProperty().getMTime()||e.VBOBuildTime.getMTime()<e.currentInput.getMTime()||!e.openGLTexture?.getHandle()||!e.colorTexture?.getHandle()||!e.labelOutlineThicknessTexture?.getHandle()||!e.pwfTexture?.getHandle(),t.buildBufferObjects=(r,i)=>{const a=e.currentInput;if(!a)return;const o=a.getPointData()&&a.getPointData().getScalars();if(!o)return;const s=o.getDataType(),l=o.getNumberOfComponents(),c=i.getProperty(),f=c.getInterpolationType(),u=c.getIndependentComponents(),d=u?l:1,h=u?2*d:1,p=c.getRGBTransferFunction(),g=vu(p,u,d),m=e._openGLRenderWindow.getGraphicsResourceForObject(p);if(!m?.oglObject?.getHandle()||m?.hash!==g){e.colorTexture=ti.newInstance({resizable:!0}),e.colorTexture.setOpenGLRenderWindow(e._openGLRenderWindow);const A=1024,L=A*h*3,P=new Uint8ClampedArray(L);if(f===Vh.NEAREST?(e.colorTexture.setMinificationFilter(on.NEAREST),e.colorTexture.setMagnificationFilter(on.NEAREST)):(e.colorTexture.setMinificationFilter(on.LINEAR),e.colorTexture.setMagnificationFilter(on.LINEAR)),p){const B=new Float32Array(A*3);for(let U=0;U<d;U++){const G=c.getRGBTransferFunction(U),F=G.getRange();if(G.getTable(F[0],F[1],A,B,1),u)for(let $=0;$<A*3;$++)P[U*A*6+$]=255*B[$],P[U*A*6+$+A*3]=255*B[$];else for(let $=0;$<A*3;$++)P[U*A*6+$]=255*B[$]}e.colorTexture.resetFormatAndType(),e.colorTexture.create2DFromRaw(A,h,3,Nn.UNSIGNED_CHAR,P)}else{for(let B=0;B<A*3;++B)P[B]=255*B/((A-1)*3),P[B+1]=255*B/((A-1)*3),P[B+2]=255*B/((A-1)*3);e.colorTexture.create2DFromRaw(A,1,3,Nn.UNSIGNED_CHAR,P)}p&&(e._openGLRenderWindow.setGraphicsResourceForObject(p,e.colorTexture,g),p!==e._colorTransferFunc&&(e._openGLRenderWindow.registerGraphicsResourceUser(p,t),e._openGLRenderWindow.unregisterGraphicsResourceUser(e._colorTransferFunc,t)),e._colorTransferFunc=p)}else e.colorTexture=m.oglObject;const v=c.getPiecewiseFunction(),x=vu(v,u,d),w=e._openGLRenderWindow.getGraphicsResourceForObject(v);if(!w?.oglObject?.getHandle()||w?.hash!==x){const L=1024*h,P=new Uint8ClampedArray(L);if(e.pwfTexture=ti.newInstance({resizable:!0}),e.pwfTexture.setOpenGLRenderWindow(e._openGLRenderWindow),f===Vh.NEAREST?(e.pwfTexture.setMinificationFilter(on.NEAREST),e.pwfTexture.setMagnificationFilter(on.NEAREST)):(e.pwfTexture.setMinificationFilter(on.LINEAR),e.pwfTexture.setMagnificationFilter(on.LINEAR)),v){const B=new Float32Array(L),U=new Float32Array(1024);for(let G=0;G<d;++G){const F=c.getPiecewiseFunction(G);if(F===null)B.fill(1);else{const $=F.getRange();if(F.getTable($[0],$[1],1024,U,1),u)for(let V=0;V<1024;V++)B[G*1024*2+V]=U[V],B[G*1024*2+V+1024]=U[V];else for(let V=0;V<1024;V++)B[G*1024*2+V]=U[V]}}e.pwfTexture.resetFormatAndType(),e.pwfTexture.create2DFromRaw(1024,h,1,Nn.FLOAT,B)}else P.fill(255),e.pwfTexture.create2DFromRaw(1024,1,1,Nn.UNSIGNED_CHAR,P);v&&(e._openGLRenderWindow.setGraphicsResourceForObject(v,e.pwfTexture,x),v!==e._pwFunc&&(e._openGLRenderWindow.registerGraphicsResourceUser(v,t),e._openGLRenderWindow.unregisterGraphicsResourceUser(e._pwFunc,t)),e._pwFunc=v)}else e.pwfTexture=w.oglObject;t.updatelabelOutlineThicknessTexture(i);const{ijkMode:T}=e.renderable.getClosestIJKAxis();let _=e.renderable.getSlice();T!==e.renderable.getSlicingMode()&&(_=e.renderable.getSliceAtPosition(_));const D=e.renderable.isA("vtkImageArrayMapper")?e.renderable.getSubSlice():Math.round(_),I=a.getExtent();let R;T===Bs.I&&(R=D-I[0]),T===Bs.J&&(R=D-I[2]),(T===Bs.K||T===Bs.NONE)&&(R=D-I[4]);const M=`${_}A${a.getMTime()}A${o.getMTime()}B${t.getMTime()}C${e.renderable.getSlicingMode()}D${i.getProperty().getInterpolationType()}`;if(e.VBOBuildString!==M){const A=a.getDimensions();e.openGLTexture||(e.openGLTexture=ti.newInstance({resizable:!0})),e.openGLTexture.setOpenGLRenderWindow(e._openGLRenderWindow),e.openGLTexture.setOglNorm16Ext(e.context.getExtension("EXT_texture_norm16")),f===Vh.NEAREST?(new Set([1,3,4]).has(l)&&s===Nn.UNSIGNED_CHAR&&!u&&e.openGLTexture.setGenerateMipmap(!0),e.openGLTexture.setMinificationFilter(on.NEAREST),e.openGLTexture.setMagnificationFilter(on.NEAREST)):(l===4&&s===Nn.UNSIGNED_CHAR&&!u?(e.openGLTexture.setGenerateMipmap(!0),e.openGLTexture.setMinificationFilter(on.LINEAR_MIPMAP_LINEAR)):e.openGLTexture.setMinificationFilter(on.LINEAR),e.openGLTexture.setMagnificationFilter(on.LINEAR)),e.openGLTexture.setWrapS(w2.CLAMP_TO_EDGE),e.openGLTexture.setWrapT(w2.CLAMP_TO_EDGE);const L=A[0]*A[1]*l,P=new Float32Array(12),B=new Float32Array(8);for(let me=0;me<4;me++)B[me*2]=me%2?1:0,B[me*2+1]=me>1?1:0;const U=[Bs.X,Bs.Y,Bs.Z].includes(e.renderable.getSlicingMode())?_:D,G=a.getSpatialExtent(),F=o.getData();let $=null;if(T===Bs.I){$=new F.constructor(A[2]*A[1]*l);let me=0;for(let Ce=0;Ce<A[2];Ce++)for(let we=0;we<A[1];we++){let Ae=(R+we*A[0]+Ce*A[0]*A[1])*l;me=(Ce*A[1]+we)*l;const De=Ae+l;for(;Ae<De;)$[me++]=F[Ae++]}A[0]=A[1],A[1]=A[2],P[0]=U,P[1]=G[2],P[2]=G[4],P[3]=U,P[4]=G[3],P[5]=G[4],P[6]=U,P[7]=G[2],P[8]=G[5],P[9]=U,P[10]=G[3],P[11]=G[5]}else if(T===Bs.J){$=new F.constructor(A[2]*A[0]*l);let me=0;for(let Ce=0;Ce<A[2];Ce++)for(let we=0;we<A[0];we++){let Ae=(we+R*A[0]+Ce*A[0]*A[1])*l;me=(Ce*A[0]+we)*l;const De=Ae+l;for(;Ae<De;)$[me++]=F[Ae++]}A[1]=A[2],P[0]=G[0],P[1]=U,P[2]=G[4],P[3]=G[1],P[4]=U,P[5]=G[4],P[6]=G[0],P[7]=U,P[8]=G[5],P[9]=G[1],P[10]=U,P[11]=G[5]}else T===Bs.K||T===Bs.NONE?($=F.subarray(R*L,(R+1)*L),P[0]=G[0],P[1]=G[2],P[2]=U,P[3]=G[1],P[4]=G[2],P[5]=U,P[6]=G[0],P[7]=G[3],P[8]=U,P[9]=G[1],P[10]=G[3],P[11]=U):Yp("Reformat slicing not yet supported.");const V=o.getRanges();e.openGLTexture.resetFormatAndType(),e.openGLTexture.create2DFilterableFromRaw(A[0],A[1],l,o.getDataType(),$,e.renderable.getPreferSizeOverAccuracy?.(),V),e.openGLTexture.activate(),e.openGLTexture.sendParameters(),e.openGLTexture.deactivate();const X=nn.newInstance({numberOfComponents:3,values:P});X.setName("points");const Q=nn.newInstance({numberOfComponents:2,values:B});Q.setName("tcoords");const re=new Uint16Array(8);re[0]=3,re[1]=0,re[2]=1,re[3]=3,re[4]=3,re[5]=0,re[6]=3,re[7]=2;const ye=nn.newInstance({numberOfComponents:1,values:re});e.tris.getCABO().createVBO(ye,"polys",so.SURFACE,{points:X,tcoords:Q,cellOffset:0}),e.VBOBuildTime.modified(),e.VBOBuildString=M}},t.updatelabelOutlineThicknessTexture=r=>{const i=r.getProperty().getLabelOutlineThicknessByReference(),a=e._openGLRenderWindow.getGraphicsResourceForObject(i),o=`${i.join("-")}`;if(!a?.oglObject?.getHandle()||a?.hash!==o){const u=new Uint8Array(1024);for(let d=0;d<1024;++d){const h=typeof i[d]<"u"?i[d]:i[0];u[d]=h}e.labelOutlineThicknessTexture=ti.newInstance({resizable:!1}),e.labelOutlineThicknessTexture.setOpenGLRenderWindow(e._openGLRenderWindow),e.labelOutlineThicknessTexture.resetFormatAndType(),e.labelOutlineThicknessTexture.setMinificationFilter(on.NEAREST),e.labelOutlineThicknessTexture.setMagnificationFilter(on.NEAREST),e.labelOutlineThicknessTexture.create2DFromRaw(1024,1,1,Nn.UNSIGNED_CHAR,u),i&&(e._openGLRenderWindow.setGraphicsResourceForObject(i,e.labelOutlineThicknessTexture,o),i!==e._labelOutlineThicknessArray&&(e._openGLRenderWindow.registerGraphicsResourceUser(i,t),e._openGLRenderWindow.unregisterGraphicsResourceUser(e._labelOutlineThicknessArray,t)),e._labelOutlineThicknessArray=i)}else e.labelOutlineThicknessTexture=a.oglObject},t.getRenderTargetSize=()=>{if(e._useSmallViewport)return[e._smallViewportWidth,e._smallViewportHeight];const{usize:r,vsize:i}=e._openGLRenderer.getTiledSizeAndOrigin();return[r,i]},t.getRenderTargetOffset=()=>{const{lowerLeftU:r,lowerLeftV:i}=e._openGLRenderer.getTiledSizeAndOrigin();return[r,i]},t.delete=Q2(()=>{e._openGLRenderWindow&&n(e._openGLRenderWindow)},t.delete)}const fwe={VBOBuildTime:0,VBOBuildString:null,openGLTexture:null,tris:null,imagemat:null,imagematinv:null,colorTexture:null,pwfTexture:null,labelOutlineThicknessTexture:null,labelOutlineThicknessTextureString:null,lastHaveSeenDepthRequest:!1,haveSeenDepthRequest:!1,lastTextureComponents:0};function dwe(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,fwe,n),Rr.extend(t,e,n),mu.implementReplaceShaderCoincidentOffset(t,e,n),mu.implementBuildShadersWithReplacements(t,e,n),e.tris=Tu.newInstance(),e.imagemat=sn(new Float64Array(16)),e.imagematinv=sn(new Float64Array(16)),e.projectionToWorld=sn(new Float64Array(16)),e.idxToView=sn(new Float64Array(16)),e.idxNormalMatrix=Ll(new Float64Array(9)),e.modelToView=sn(new Float64Array(16)),e.projectionToView=sn(new Float64Array(16)),Mi(t,e,[]),e.VBOBuildTime={},$r(e.VBOBuildTime),uwe(t,e)}const Qq=Zn(dwe,"vtkOpenGLImageMapper");var hwe={newInstance:Qq};sa("vtkAbstractImageMapper",Qq);const H0={MAX:0,MIN:1,AVERAGE:2},{vtkErrorMacro:ex}=le;function pwe(t,e){e.classHierarchy.push("vtkOpenGLImageCPRMapper");function n(r){[e._scalars,e._colorTransferFunc,e._pwFunc].forEach(i=>r.unregisterGraphicsResourceUser(i,t))}t.buildPass=r=>{if(r){e.currentRenderPass=null,e.openGLImageSlice=t.getFirstAncestorOfType("vtkOpenGLImageSlice"),e._openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer");const i=e._openGLRenderWindow;e._openGLRenderWindow=e._openGLRenderer.getLastAncestorOfType("vtkOpenGLRenderWindow"),i&&!i.isDeleted()&&i!==e._openGLRenderWindow&&n(i),e.context=e._openGLRenderWindow.getContext(),e.openGLCamera=e._openGLRenderer.getViewNodeFor(e._openGLRenderer.getRenderable().getActiveCamera()),e.tris.setOpenGLRenderWindow(e._openGLRenderWindow)}},t.opaquePass=(r,i)=>{r&&(e.currentRenderPass=i,t.render())},t.opaqueZBufferPass=r=>{r&&(e.haveSeenDepthRequest=!0,e.renderDepth=!0,t.render(),e.renderDepth=!1)},t.getCoincidentParameters=(r,i)=>e.renderable.getResolveCoincidentTopology()===Cc.PolygonOffset?e.renderable.getCoincidentTopologyPolygonOffsetParameters():null,t.render=()=>{const r=e.openGLImageSlice.getRenderable(),i=e._openGLRenderer.getRenderable();t.renderPiece(i,r)},t.renderPiece=(r,i)=>{t.invokeEvent({type:"StartEvent"}),e.renderable.update(),t.invokeEvent({type:"EndEvent"}),e.renderable.preRenderCheck()&&(e.currentImageDataInput=e.renderable.getInputData(0),e.currentCenterlineInput=e.renderable.getOrientedCenterline(),t.renderPieceStart(r,i),t.renderPieceDraw(r,i),t.renderPieceFinish(r,i))},t.renderPieceStart=(r,i)=>{t.updateBufferObjects(r,i)},t.renderPieceDraw=(r,i)=>{const a=e.context;e.volumeTexture.activate(),e.colorTexture.activate(),e.pwfTexture.activate(),e.tris.getCABO().getElementCount()&&(t.updateShaders(e.tris,r,i),a.drawArrays(a.TRIANGLES,0,e.tris.getCABO().getElementCount()),e.tris.getVAO().release()),e.volumeTexture.deactivate(),e.colorTexture.deactivate(),e.pwfTexture.deactivate()},t.renderPieceFinish=(r,i)=>{},t.updateBufferObjects=(r,i)=>{t.getNeedToRebuildBufferObjects(r,i)&&t.buildBufferObjects(r,i),i.getProperty().getInterpolationType()===Vh.NEAREST?(e.volumeTexture.setMinificationFilter(on.NEAREST),e.volumeTexture.setMagnificationFilter(on.NEAREST),e.colorTexture.setMinificationFilter(on.NEAREST),e.colorTexture.setMagnificationFilter(on.NEAREST),e.pwfTexture.setMinificationFilter(on.NEAREST),e.pwfTexture.setMagnificationFilter(on.NEAREST)):(e.volumeTexture.setMinificationFilter(on.LINEAR),e.volumeTexture.setMagnificationFilter(on.LINEAR),e.colorTexture.setMinificationFilter(on.LINEAR),e.colorTexture.setMagnificationFilter(on.LINEAR),e.pwfTexture.setMinificationFilter(on.LINEAR),e.pwfTexture.setMagnificationFilter(on.LINEAR))},t.getNeedToRebuildBufferObjects=(r,i)=>{const a=e.VBOBuildTime.getMTime();return a<t.getMTime()||a<e.renderable.getMTime()||a<i.getMTime()||a<e.currentImageDataInput.getMTime()||a<e.currentCenterlineInput.getMTime()||!e.volumeTexture?.getHandle()},t.buildBufferObjects=(r,i)=>{const a=e.currentImageDataInput,o=e.currentCenterlineInput,s=a?.getPointData()?.getScalars();if(!s)return;const l=e._openGLRenderWindow.getGraphicsResourceForObject(s),c=mD(a,s),f=!l?.oglObject?.getHandle()||l?.hash!==c,u=e.renderable.getUpdatedExtents(),d=!!u.length;if(f){e.volumeTexture=ti.newInstance(),e.volumeTexture.setOpenGLRenderWindow(e._openGLRenderWindow);const R=a.getDimensions();e.volumeTexture.setOglNorm16Ext(e.context.getExtension("EXT_texture_norm16")),e.volumeTexture.resetFormatAndType(),e.volumeTexture.create3DFilterableFromDataArray(R[0],R[1],R[2],s,e.renderable.getPreferSizeOverAccuracy()),e._openGLRenderWindow.setGraphicsResourceForObject(s,e.volumeTexture,c),s!==e._scalars&&(e._openGLRenderWindow.registerGraphicsResourceUser(s,t),e._openGLRenderWindow.unregisterGraphicsResourceUser(e._scalars,t)),e._scalars=s}else e.volumeTexture=l.oglObject;if(d){e.renderable.setUpdatedExtents([]);const R=a.getDimensions();e.volumeTexture.create3DFilterableFromDataArray(R[0],R[1],R[2],s,!1,u)}const h=s.getNumberOfComponents(),p=i.getProperty(),g=p.getIndependentComponents(),m=g?h:1,y=g?2*m:1,v=p.getRGBTransferFunction(),x=vu(v,g,m),w=e._openGLRenderWindow.getGraphicsResourceForObject(v);if(!w?.oglObject?.getHandle()||w?.hash!==x){const M=1024*y*3,A=new Uint8ClampedArray(M);if(e.colorTexture=ti.newInstance(),e.colorTexture.setOpenGLRenderWindow(e._openGLRenderWindow),v){const L=new Float32Array(3072);for(let P=0;P<m;P++){const B=p.getRGBTransferFunction(P),U=B.getRange();if(B.getTable(U[0],U[1],1024,L,1),g)for(let G=0;G<1024*3;G++)A[P*1024*6+G]=255*L[G],A[P*1024*6+G+1024*3]=255*L[G];else for(let G=0;G<1024*3;G++)A[P*1024*6+G]=255*L[G]}e.colorTexture.resetFormatAndType(),e.colorTexture.create2DFromRaw(1024,y,3,Nn.UNSIGNED_CHAR,A)}else{for(let L=0;L<1024*3;++L)A[L]=255*L/(1023*3),A[L+1]=255*L/(1023*3),A[L+2]=255*L/(1023*3);e.colorTexture.resetFormatAndType(),e.colorTexture.create2DFromRaw(1024,1,3,Nn.UNSIGNED_CHAR,A)}v&&(e._openGLRenderWindow.setGraphicsResourceForObject(v,e.colorTexture,x),v!==e._colorTransferFunc&&(e._openGLRenderWindow.registerGraphicsResourceUser(v,t),e._openGLRenderWindow.unregisterGraphicsResourceUser(e._colorTransferFunc,t)),e._colorTransferFunc=v)}else e.colorTexture=w.oglObject;const T=p.getPiecewiseFunction(),_=vu(T,g,m),D=e._openGLRenderWindow.getGraphicsResourceForObject(T);if(!D?.oglObject?.getHandle()||D?.hash!==_){const M=1024*y,A=new Uint8ClampedArray(M);if(e.pwfTexture=ti.newInstance(),e.pwfTexture.setOpenGLRenderWindow(e._openGLRenderWindow),T){const L=new Float32Array(M),P=new Float32Array(1024);for(let B=0;B<m;++B){const U=p.getPiecewiseFunction(B);if(U===null)L.fill(1);else{const G=U.getRange();if(U.getTable(G[0],G[1],1024,P,1),g)for(let F=0;F<1024;F++)L[B*1024*2+F]=P[F],L[B*1024*2+F+1024]=P[F];else for(let F=0;F<1024;F++)L[B*1024*2+F]=P[F]}}e.pwfTexture.resetFormatAndType(),e.pwfTexture.create2DFromRaw(1024,y,1,Nn.FLOAT,L)}else A.fill(255),e.pwfTexture.resetFormatAndType(),e.pwfTexture.create2DFromRaw(1024,1,1,Nn.UNSIGNED_CHAR,A);T&&(e._openGLRenderWindow.setGraphicsResourceForObject(T,e.pwfTexture,_),T!==e._pwFunc&&(e._openGLRenderWindow.registerGraphicsResourceUser(T,t),e._openGLRenderWindow.unregisterGraphicsResourceUser(e._pwFunc,t)),e._pwFunc=T)}else e.pwfTexture=D.oglObject;if(e.VBOBuildTime.getMTime()<e.renderable.getMTime()||e.VBOBuildTime.getMTime()<o.getMTime()){const R=o.getNumberOfPoints(),M=R<=1?0:R-1,A=o.getDistancesToFirstPoint(),L=e.renderable.getHeight(),P=4*M,B=new Float32Array(3*P),U=e.renderable.getWidth();for(let Ae=0,De=0;Ae<M;++Ae)B.set([0,L-A[Ae],0],De),De+=3,B.set([U,L-A[Ae],0],De),De+=3,B.set([U,L-A[Ae+1],0],De),De+=3,B.set([0,L-A[Ae+1],0],De),De+=3;const G=nn.newInstance({numberOfComponents:3,values:B});G.setName("points");const F=new Uint16Array(5*M);for(let Ae=0,De=0,q=0;Ae<M;++Ae)F.set([4,q+3,q+2,q+1,q],De),De+=5,q+=4;const $=nn.newInstance({numberOfComponents:1,values:F}),V=o.getPoints(),X=new Float32Array(3*P),Q=new Array(3),re=new Array(3);for(let Ae=0,De=0;Ae<M;++Ae)V.getPoint(Ae,Q),V.getPoint(Ae+1,re),X.set(Q,De),De+=3,X.set(Q,De),De+=3,X.set(re,De),De+=3,X.set(re,De),De+=3;const ye=nn.newInstance({numberOfComponents:3,values:X,name:"centerlinePosition"}),me=new Float32Array(P);for(let Ae=0,De=0;Ae<M;++Ae)me.set([0,1,3,2],De),De+=4;const Ce=nn.newInstance({numberOfComponents:1,values:me,name:"quadIndex"}),we=[ye,Ce];if(!e.renderable.getUseUniformOrientation()){const Ae=e.renderable.getOrientedCenterline().getOrientations()??[],De=new Float32Array(4*P),q=new Float32Array(4*P);for(let Y=0;Y<M;++Y){const ie=Ae[Y],ue=Ae[Y+1];for(let fe=0;fe<4;++fe){const Fe=4*(fe+4*Y);De.set(ie,Fe),q.set(ue,Fe)}}const k=nn.newInstance({numberOfComponents:4,values:De,name:"centerlineTopOrientation"}),J=nn.newInstance({numberOfComponents:4,values:q,name:"centerlineBotOrientation"});we.push(k,J)}e.tris.getCABO().createVBO($,"polys",so.SURFACE,{points:G,customAttributes:we}),e.VBOBuildTime.modified()}},t.getNeedToRebuildShaders=(r,i,a)=>{const o=e.volumeTexture.getComponents(),s=a.getProperty().getIndependentComponents(),l=!!e.renderable.getCenterPoint(),c=e.renderable.getUseUniformOrientation(),f=e.renderable.isProjectionEnabled()&&e.renderable.getProjectionMode();return r.getProgram()===0||e.lastUseCenterPoint!==l||e.lastUseUniformOrientation!==c||e.lastProjectionMode!==f||e.lastHaveSeenDepthRequest!==e.haveSeenDepthRequest||e.lastTextureComponents!==o||e.lastIndependentComponents!==s?(e.lastUseCenterPoint=l,e.lastUseUniformOrientation=c,e.lastProjectionMode=f,e.lastHaveSeenDepthRequest=e.haveSeenDepthRequest,e.lastTextureComponents=o,e.lastIndependentComponents=s,!0):!1},t.buildShaders=(r,i,a)=>{t.getShaderTemplate(r,i,a),t.replaceShaderValues(r,i,a)},t.replaceShaderValues=(r,i,a)=>{let o=r.Vertex,s=r.Fragment;const l=["vec3 applyQuaternionToVec(vec4 q, vec3 v) {","  float uvx = q.y * v.z - q.z * v.y;","  float uvy = q.z * v.x - q.x * v.z;","  float uvz = q.x * v.y - q.y * v.x;","  float uuvx = q.y * uvz - q.z * uvy;","  float uuvy = q.z * uvx - q.x * uvz;","  float uuvz = q.x * uvy - q.y * uvx;","  float w2 = q.w * 2.0;","  uvx *= w2;","  uvy *= w2;","  uvz *= w2;","  uuvx *= 2.0;","  uuvy *= 2.0;","  uuvz *= 2.0;","  return vec3(v.x + uvx + uuvx, v.y + uvy + uuvy, v.z + uvz + uuvz);","}"];o=Be.substitute(o,"//VTK::Camera::Dec",["uniform mat4 MCPCMatrix;"]).result,o=Be.substitute(o,"//VTK::PositionVC::Impl",["  gl_Position = MCPCMatrix * vertexMC;"]).result;const c=["attribute vec3 centerlinePosition;","attribute float quadIndex;","uniform float width;","out vec2 quadOffsetVSOutput;","out vec3 centerlinePosVSOutput;"],f=e.renderable.isProjectionEnabled(),u=e.renderable.getUseUniformOrientation();u?(c.push("out vec3 samplingDirVSOutput;","uniform vec4 centerlineOrientation;","uniform vec3 tangentDirection;",...l),f&&c.push("out vec3 projectionDirVSOutput;","uniform vec3 bitangentDirection;")):c.push("out vec4 centerlineTopOrientationVSOutput;","out vec4 centerlineBotOrientationVSOutput;","attribute vec4 centerlineTopOrientation;","attribute vec4 centerlineBotOrientation;"),o=Be.substitute(o,"//VTK::Color::Dec",c).result;const d=["quadOffsetVSOutput = vec2(width * (mod(quadIndex, 2.0) == 0.0 ? -0.5 : 0.5), quadIndex > 1.0 ? 0.0 : 1.0);","centerlinePosVSOutput = centerlinePosition;"];u?(d.push("samplingDirVSOutput = applyQuaternionToVec(centerlineOrientation, tangentDirection);"),f&&d.push("projectionDirVSOutput = applyQuaternionToVec(centerlineOrientation, bitangentDirection);")):d.push("centerlineTopOrientationVSOutput = centerlineTopOrientation;","centerlineBotOrientationVSOutput = centerlineBotOrientation;"),o=Be.substitute(o,"//VTK::Color::Impl",d).result;const h=e.volumeTexture.getComponents(),p=a.getProperty().getIndependentComponents();let g=["uniform mat4 MCTCMatrix; // Model coordinates to texture coordinates","in vec2 quadOffsetVSOutput;","in vec3 centerlinePosVSOutput;","uniform highp sampler3D volumeTexture;","uniform sampler2D colorTexture1;","uniform sampler2D pwfTexture1;","uniform float opacity;","uniform vec4 backgroundColor;","uniform float cshift0;","uniform float cscale0;","uniform float pwfshift0;","uniform float pwfscale0;"];f&&g.push("uniform vec3 volumeSizeMC;","uniform int projectionSlabNumberOfSamples;","uniform float projectionConstantOffset;","uniform float projectionStepLength;"),u?(g.push("in vec3 samplingDirVSOutput;"),f&&g.push("in vec3 projectionDirVSOutput;")):(g.push("uniform vec3 tangentDirection;","in vec4 centerlineTopOrientationVSOutput;","in vec4 centerlineBotOrientationVSOutput;",...l),f&&g.push("uniform vec3 bitangentDirection;"));const m=e.renderable.getCenterPoint();if(m&&g.push("uniform vec3 globalCenterPoint;"),p){for(let v=1;v<h;v++)g=g.concat([`uniform float cshift${v};`,`uniform float cscale${v};`,`uniform float pwfshift${v};`,`uniform float pwfscale${v};`]);switch(h){case 1:g=g.concat(["uniform float mix0;","#define height0 0.5"]);break;case 2:g=g.concat(["uniform float mix0;","uniform float mix1;","#define height0 0.25","#define height1 0.75"]);break;case 3:g=g.concat(["uniform float mix0;","uniform float mix1;","uniform float mix2;","#define height0 0.17","#define height1 0.5","#define height2 0.83"]);break;case 4:g=g.concat(["uniform float mix0;","uniform float mix1;","uniform float mix2;","uniform float mix3;","#define height0 0.125","#define height1 0.375","#define height2 0.625","#define height3 0.875"]);break;default:ex("Unsupported number of independent coordinates.")}}s=Be.substitute(s,"//VTK::TCoord::Dec",g).result;let y=[];if(u?(y.push("vec3 samplingDirection = samplingDirVSOutput;"),f&&y.push("vec3 projectionDirection = projectionDirVSOutput;")):(y.push("vec4 q0 = centerlineBotOrientationVSOutput;","vec4 q1 = centerlineTopOrientationVSOutput;","float qCosAngle = dot(q0, q1);","vec4 interpolatedOrientation;","if (qCosAngle > 0.999 || qCosAngle < -0.999) {","  // Use LERP instead of SLERP when the two quaternions are close or opposite","  interpolatedOrientation = normalize(mix(q0, q1, quadOffsetVSOutput.y));","} else {","  float omega = acos(qCosAngle);","  interpolatedOrientation = normalize(sin((1.0 - quadOffsetVSOutput.y) * omega) * q0 + sin(quadOffsetVSOutput.y * omega) * q1);","}","vec3 samplingDirection = applyQuaternionToVec(interpolatedOrientation, tangentDirection);"),f&&y.push("vec3 projectionDirection = applyQuaternionToVec(interpolatedOrientation, bitangentDirection);")),m?y.push("float baseOffset = dot(samplingDirection, globalCenterPoint - centerlinePosVSOutput);","float horizontalOffset = quadOffsetVSOutput.x + baseOffset;"):y.push("float horizontalOffset = quadOffsetVSOutput.x;"),y.push("vec3 volumePosMC = centerlinePosVSOutput + horizontalOffset * samplingDirection;","vec3 volumePosTC = (MCTCMatrix * vec4(volumePosMC, 1.0)).xyz;","if (any(lessThan(volumePosTC, vec3(0.0))) || any(greaterThan(volumePosTC, vec3(1.0))))","{","  // set the background color and exit","  gl_FragData[0] = backgroundColor;","  return;","}"),f){const v=e.renderable.getProjectionMode();switch(v){case H0.MIN:y.push("const vec4 initialProjectionTextureValue = vec4(1.0);");break;case H0.MAX:case H0.AVERAGE:default:y.push("const vec4 initialProjectionTextureValue = vec4(0.0);");break}switch(y.push("vec3 projectionScaledDirection = projectionDirection / volumeSizeMC;","vec3 projectionStep = projectionStepLength * projectionScaledDirection;","vec3 projectionStartPosition = volumePosTC + projectionConstantOffset * projectionScaledDirection;","vec4 tvalue = initialProjectionTextureValue;","for (int projectionSampleIdx = 0; projectionSampleIdx < projectionSlabNumberOfSamples; ++projectionSampleIdx) {","  vec3 projectionSamplePosition = projectionStartPosition + float(projectionSampleIdx) * projectionStep;","  vec4 sampledTextureValue = texture(volumeTexture, projectionSamplePosition);"),v){case H0.MAX:y.push("  tvalue = max(tvalue, sampledTextureValue);");break;case H0.MIN:y.push("  tvalue = min(tvalue, sampledTextureValue);");break;case H0.AVERAGE:default:y.push("  tvalue = tvalue + sampledTextureValue;");break}y.push("}"),v===H0.AVERAGE&&y.push("tvalue = tvalue / float(projectionSlabNumberOfSamples);")}else y.push("vec4 tvalue = texture(volumeTexture, volumePosTC);");if(p){const v=["r","g","b","a"];for(let x=0;x<h;++x)y=y.concat([`vec3 tcolor${x} = mix${x} * texture2D(colorTexture1, vec2(tvalue.${v[x]} * cscale${x} + cshift${x}, height${x})).rgb;`,`float compWeight${x} = mix${x} * texture2D(pwfTexture1, vec2(tvalue.${v[x]} * pwfscale${x} + pwfshift${x}, height${x})).r;`]);switch(h){case 1:y=y.concat(["gl_FragData[0] = vec4(tcolor0.rgb, compWeight0 * opacity);"]);break;case 2:y=y.concat(["float weightSum = compWeight0 + compWeight1;","gl_FragData[0] = vec4(vec3((tcolor0.rgb * (compWeight0 / weightSum)) + (tcolor1.rgb * (compWeight1 / weightSum))), opacity);"]);break;case 3:y=y.concat(["float weightSum = compWeight0 + compWeight1 + compWeight2;","gl_FragData[0] = vec4(vec3((tcolor0.rgb * (compWeight0 / weightSum)) + (tcolor1.rgb * (compWeight1 / weightSum)) + (tcolor2.rgb * (compWeight2 / weightSum))), opacity);"]);break;case 4:y=y.concat(["float weightSum = compWeight0 + compWeight1 + compWeight2 + compWeight3;","gl_FragData[0] = vec4(vec3((tcolor0.rgb * (compWeight0 / weightSum)) + (tcolor1.rgb * (compWeight1 / weightSum)) + (tcolor2.rgb * (compWeight2 / weightSum)) + (tcolor3.rgb * (compWeight3 / weightSum))), opacity);"]);break;default:ex("Unsupported number of independent coordinates.")}}else switch(h){case 1:y=y.concat(["// Dependent components","float intensity = tvalue.r;","vec3 tcolor = texture2D(colorTexture1, vec2(intensity * cscale0 + cshift0, 0.5)).rgb;","float scalarOpacity = texture2D(pwfTexture1, vec2(intensity * pwfscale0 + pwfshift0, 0.5)).r;","gl_FragData[0] = vec4(tcolor, scalarOpacity * opacity);"]);break;case 2:y=y.concat(["float intensity = tvalue.r*cscale0 + cshift0;","gl_FragData[0] = vec4(texture2D(colorTexture1, vec2(intensity, 0.5)).rgb, pwfscale0*tvalue.g + pwfshift0);"]);break;case 3:y=y.concat(["vec4 tcolor = cscale0*tvalue + cshift0;","gl_FragData[0] = vec4(texture2D(colorTexture1, vec2(tcolor.r,0.5)).r,","  texture2D(colorTexture1, vec2(tcolor.g,0.5)).r,","  texture2D(colorTexture1, vec2(tcolor.b,0.5)).r, opacity);"]);break;default:y=y.concat(["vec4 tcolor = cscale0*tvalue + cshift0;","gl_FragData[0] = vec4(texture2D(colorTexture1, vec2(tcolor.r,0.5)).r,","  texture2D(colorTexture1, vec2(tcolor.g,0.5)).r,","  texture2D(colorTexture1, vec2(tcolor.b,0.5)).r, tcolor.a);"])}s=Be.substitute(s,"//VTK::TCoord::Impl",y).result,e.haveSeenDepthRequest&&(s=Be.substitute(s,"//VTK::ZBuffer::Dec","uniform int depthRequest;").result,s=Be.substitute(s,"//VTK::ZBuffer::Impl",["if (depthRequest == 1) {","float iz = floor(gl_FragCoord.z*65535.0 + 0.1);","float rf = floor(iz/256.0)/255.0;","float gf = mod(iz,256.0)/255.0;","gl_FragData[0] = vec4(rf, gf, 0.0, 1.0); }"]).result),r.Vertex=o,r.Fragment=s,t.replaceShaderClip(r,i,a),t.replaceShaderCoincidentOffset(r,i,a)},t.replaceShaderClip=(r,i,a)=>{let o=r.Vertex,s=r.Fragment;if(e.renderable.getNumberOfClippingPlanes()){let l=e.renderable.getNumberOfClippingPlanes();l>6&&(le.vtkErrorMacro("OpenGL has a limit of 6 clipping planes"),l=6),o=Be.substitute(o,"//VTK::Clip::Dec",["uniform int numClipPlanes;","uniform vec4 clipPlanes[6];","varying float clipDistancesVSOutput[6];"]).result,o=Be.substitute(o,"//VTK::Clip::Impl",["for (int planeNum = 0; planeNum < 6; planeNum++)","    {","    if (planeNum >= numClipPlanes)","        {","        break;","        }","    clipDistancesVSOutput[planeNum] = dot(clipPlanes[planeNum], vertexMC);","    }"]).result,s=Be.substitute(s,"//VTK::Clip::Dec",["uniform int numClipPlanes;","varying float clipDistancesVSOutput[6];"]).result,s=Be.substitute(s,"//VTK::Clip::Impl",["for (int planeNum = 0; planeNum < 6; planeNum++)","    {","    if (planeNum >= numClipPlanes)","        {","        break;","        }","    if (clipDistancesVSOutput[planeNum] < 0.0) discard;","    }"]).result}r.Vertex=o,r.Fragment=s},t.getShaderTemplate=(r,i,a)=>{r.Vertex=yD,r.Fragment=oy,r.Geometry=""},t.setMapperShaderParameters=(r,i,a)=>{const o=r.getProgram(),s=r.getCABO();s.getElementCount()&&(e.VBOBuildTime.getMTime()>r.getAttributeUpdateTime().getMTime()||r.getShaderSourceTime().getMTime()>r.getAttributeUpdateTime().getMTime())&&(o.isAttributeUsed("vertexMC")&&(r.getVAO().addAttributeArray(o,s,"vertexMC",s.getVertexOffset(),s.getStride(),e.context.FLOAT,3,e.context.FALSE)||ex("Error setting vertexMC in shader VAO.")),r.getCABO().getCustomData().forEach(h=>{h&&o.isAttributeUsed(h.name)&&!r.getVAO().addAttributeArray(o,s,h.name,h.offset,s.getStride(),e.context.FLOAT,h.components,e.context.FALSE)&&ex(`Error setting ${h.name} in shader VAO.`)}),r.getAttributeUpdateTime().modified());const l=e.volumeTexture.getTextureUnit();if(o.setUniformi("volumeTexture",l),o.setUniformf("width",e.renderable.getWidth()),r.getProgram().setUniform4fv("backgroundColor",e.renderable.getBackgroundColor()),o.isUniformUsed("tangentDirection")){const h=e.renderable.getTangentDirection();r.getProgram().setUniform3fArray("tangentDirection",h)}if(o.isUniformUsed("bitangentDirection")){const h=e.renderable.getBitangentDirection();r.getProgram().setUniform3fArray("bitangentDirection",h)}if(o.isUniformUsed("centerlineOrientation")){const h=e.renderable.getUniformOrientation();r.getProgram().setUniform4fv("centerlineOrientation",h)}if(o.isUniformUsed("globalCenterPoint")){const h=e.renderable.getCenterPoint();o.setUniform3fArray("globalCenterPoint",h)}if(e.renderable.isProjectionEnabled()){const h=e.currentImageDataInput,p=h.getSpacing(),g=h.getDimensions(),m=e.renderable.getProjectionSlabThickness(),y=e.renderable.getProjectionSlabNumberOfSamples(),v=y5e([],p,g);o.setUniform3fArray("volumeSizeMC",v),o.setUniformi("projectionSlabNumberOfSamples",y);const x=-.5*m;o.setUniformf("projectionConstantOffset",x);const w=m/(y-1);o.setUniformf("projectionStepLength",w)}const c=e.currentImageDataInput,f=c.getWorldToIndex(),u=tD(new Float32Array(16),_K([],c.getDimensions())),d=d3(u,u,f);if(o.setUniformMatrix("MCTCMatrix",d),e.haveSeenDepthRequest&&r.getProgram().setUniformi("depthRequest",e.renderDepth?1:0),e.renderable.getNumberOfClippingPlanes()){let h=e.renderable.getNumberOfClippingPlanes();h>6&&(le.vtkErrorMacro("OpenGL has a limit of 6 clipping planes"),h=6);const g=s.getCoordShiftAndScaleEnabled()?s.getInverseShiftAndScaleMatrix():null,m=g?Ei(e.imagematinv,a.getMatrix()):a.getMatrix();g&&(Gn(m,m),jn(m,m,g),Gn(m,m)),Gn(e.imagemat,e.currentImageDataInput.getIndexToWorld()),jn(e.imagematinv,m,e.imagemat);const y=[];for(let v=0;v<h;v++){const x=[];e.renderable.getClippingPlaneInDataCoords(e.imagematinv,v,x);for(let w=0;w<4;w++)y.push(x[w])}o.setUniformi("numClipPlanes",h),o.setUniform4fv("clipPlanes",y)}if(o.isUniformUsed("coffset")){const h=t.getCoincidentParameters(i,a);o.setUniformf("coffset",h.offset),o.isUniformUsed("cfactor")&&o.setUniformf("cfactor",h.factor)}},t.setCameraShaderParameters=(r,i,a)=>{const o=e.openGLImageSlice.getKeyMatrices().mcwc,s=e.openGLCamera.getKeyMatrices(i).wcpc;if(jn(e.imagemat,s,o),r.getCABO().getCoordShiftAndScaleEnabled()){const l=r.getCABO().getInverseShiftAndScaleMatrix();jn(e.imagemat,e.imagemat,l)}r.getProgram().setUniformMatrix("MCPCMatrix",e.imagemat)},t.setPropertyShaderParameters=(r,i,a)=>{const o=r.getProgram(),s=a.getProperty(),l=s.getOpacity();o.setUniformf("opacity",l);const c=e.volumeTexture.getComponents(),f=s.getIndependentComponents();if(f)for(let p=0;p<c;++p)o.setUniformf(`mix${p}`,s.getComponentWeight(p));const u=e.volumeTexture.getVolumeInfo();for(let p=0;p<c;p++){let g=s.getColorWindow(),m=s.getColorLevel();const y=f?p:0,v=s.getRGBTransferFunction(y);if(v&&s.getUseLookupTableScalarRange()){const S=v.getRange();g=S[1]-S[0],m=.5*(S[1]+S[0])}const x=u.scale[p]/g,w=(u.offset[p]-m)/g+.5;o.setUniformf(`cshift${p}`,w),o.setUniformf(`cscale${p}`,x)}const d=e.colorTexture.getTextureUnit();o.setUniformi("colorTexture1",d);for(let p=0;p<c;p++){let g=1,m=0;const y=f?p:0,v=s.getPiecewiseFunction(y);if(v){const x=v.getRange(),w=x[1]-x[0],S=.5*(x[0]+x[1]);g=u.scale[p]/w,m=(u.offset[p]-S)/w+.5}o.setUniformf(`pwfshift${p}`,m),o.setUniformf(`pwfscale${p}`,g)}const h=e.pwfTexture.getTextureUnit();o.setUniformi("pwfTexture1",h)},t.updateShaders=(r,i,a)=>{if(t.getNeedToRebuildShaders(r,i,a)){const o={Vertex:null,Fragment:null,Geometry:null};t.buildShaders(o,i,a);const s=e._openGLRenderWindow.getShaderCache().readyShaderProgramArray(o.Vertex,o.Fragment,o.Geometry);s!==r.getProgram()&&(r.setProgram(s),r.getVAO().releaseGraphicsResources()),r.getShaderSourceTime().modified()}else e._openGLRenderWindow.getShaderCache().readyShaderProgram(r.getProgram());r.getVAO().bind(),t.setMapperShaderParameters(r,i,a),t.setCameraShaderParameters(r,i,a),t.setPropertyShaderParameters(r,i,a)},t.delete=le.chain(()=>{e._openGLRenderWindow&&n(e._openGLRenderWindow)},t.delete)}const gwe={currentRenderPass:null,volumeTexture:null,colorTexture:null,pwfTexture:null,tris:null,lastHaveSeenDepthRequest:!1,haveSeenDepthRequest:!1,lastTextureComponents:0,lastIndependentComponents:0,imagemat:null,imagematinv:null};function mwe(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,gwe,n),Rr.extend(t,e,n),mu.implementReplaceShaderCoincidentOffset(t,e,n),le.algo(t,e,2,0),e.tris=Tu.newInstance(),e.volumeTexture=null,e.colorTexture=null,e.pwfTexture=null,e.imagemat=sn(new Float64Array(16)),e.imagematinv=sn(new Float64Array(16)),e.VBOBuildTime={},le.obj(e.VBOBuildTime,{mtime:0}),pwe(t,e)}const eX=le.newInstance(mwe,"vtkOpenGLImageCPRMapper"),vwe={};var ywe={newInstance:eX,...vwe};sa("vtkImageCPRMapper",eX);function xwe(t,e){e.classHierarchy.push("vtkOpenGLImageSlice"),t.buildPass=n=>{if(!(!e.renderable||!e.renderable.getVisibility())&&n){if(!e.renderable)return;e._openGLRenderWindow=t.getLastAncestorOfType("vtkOpenGLRenderWindow"),e._openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e.context=e._openGLRenderWindow.getContext(),t.prepareNodes(),t.addMissingNode(e.renderable.getMapper()),t.removeUnusedNodes()}},t.traverseZBufferPass=n=>{!e.renderable||!e.renderable.getNestedVisibility()||e._openGLRenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(n,!0),e.children.forEach(r=>{r.traverse(n)}),t.apply(n,!1))},t.traverseOpaqueZBufferPass=n=>t.traverseOpaquePass(n),t.traverseOpaquePass=n=>{!e.renderable||!e.renderable.getNestedVisibility()||!e.renderable.getIsOpaque()||e._openGLRenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(n,!0),e.children.forEach(r=>{r.traverse(n)}),t.apply(n,!1))},t.traverseTranslucentPass=n=>{!e.renderable||!e.renderable.getNestedVisibility()||e.renderable.getIsOpaque()||e._openGLRenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(n,!0),e.children.forEach(r=>{r.traverse(n)}),t.apply(n,!1))},t.queryPass=(n,r)=>{if(n){if(!e.renderable||!e.renderable.getVisibility())return;e.renderable.getIsOpaque()?r.incrementOpaqueActorCount():r.incrementTranslucentActorCount()}},t.zBufferPass=(n,r)=>t.opaquePass(n,r),t.opaqueZBufferPass=(n,r)=>t.opaquePass(n,r),t.opaquePass=(n,r)=>{n&&e.context.depthMask(!0)},t.translucentPass=(n,r)=>{e.context.depthMask(!n)},t.getKeyMatrices=()=>(e.renderable.getMTime()>e.keyMatrixTime.getMTime()&&(Ei(e.keyMatrices.mcwc,e.renderable.getMatrix()),Gn(e.keyMatrices.mcwc,e.keyMatrices.mcwc),e.keyMatrixTime.modified()),e.keyMatrices)}const bwe={context:null,keyMatrixTime:null,keyMatrices:null};function wwe(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,bwe,n),Rr.extend(t,e,n),e.keyMatrixTime={},$r(e.keyMatrixTime,{mtime:0}),e.keyMatrices={mcwc:sn(new Float64Array(16))},Mi(t,e,["context"]),xwe(t,e)}const tX=Zn(wwe,"vtkOpenGLImageSlice");var Cwe={newInstance:tX};sa("vtkImageSlice",tX);function Swe(t,e){e.classHierarchy.push("vtkOpenGLVolume"),t.buildPass=n=>{!e.renderable||!e.renderable.getVisibility()||n&&(e._openGLRenderWindow=t.getLastAncestorOfType("vtkOpenGLRenderWindow"),e._openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e.context=e._openGLRenderWindow.getContext(),t.prepareNodes(),t.addMissingNode(e.renderable.getMapper()),t.removeUnusedNodes())},t.queryPass=(n,r)=>{if(n){if(!e.renderable||!e.renderable.getVisibility())return;r.incrementVolumeCount()}},t.traverseVolumePass=n=>{!e.renderable||!e.renderable.getNestedVisibility()||e._openGLRenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(n,!0),e.children[0].traverse(n),t.apply(n,!1))},t.volumePass=n=>{!e.renderable||!e.renderable.getVisibility()||e.context.depthMask(!n)},t.getKeyMatrices=()=>(e.renderable.getMTime()>e.keyMatrixTime.getMTime()&&(e.renderable.computeMatrix(),Ei(e.MCWCMatrix,e.renderable.getMatrix()),Gn(e.MCWCMatrix,e.MCWCMatrix),e.renderable.getIsIdentity()?Ll(e.normalMatrix):(Ww(e.normalMatrix,e.MCWCMatrix),iy(e.normalMatrix,e.normalMatrix),X9(e.normalMatrix,e.normalMatrix)),e.keyMatrixTime.modified()),{mcwc:e.MCWCMatrix,normalMatrix:e.normalMatrix})}const Twe={};function Ewe(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Twe,n),Rr.extend(t,e,n),e.keyMatrixTime={},$r(e.keyMatrixTime,{mtime:0}),e.normalMatrix=new Float64Array(9),e.MCWCMatrix=new Float64Array(16),Mi(t,e,["context"]),Swe(t,e)}const nX=Zn(Ewe,"vtkOpenGLVolume");var _we={newInstance:nX};sa("vtkVolume",nX);function Dwe(t,e){e.classHierarchy.push("vtkFramebuffer"),t.getBothMode=()=>e.context.FRAMEBUFFER,t.saveCurrentBindingsAndBuffers=n=>{const r=typeof n<"u"?n:t.getBothMode();t.saveCurrentBindings(r),t.saveCurrentBuffers(r)},t.saveCurrentBindings=n=>{if(!e.context){Bn("you must set the OpenGLRenderWindow before calling saveCurrentBindings");return}const r=e.context;e.previousDrawBinding=r.getParameter(e.context.FRAMEBUFFER_BINDING),e.previousActiveFramebuffer=e._openGLRenderWindow.getActiveFramebuffer()},t.saveCurrentBuffers=n=>{},t.restorePreviousBindingsAndBuffers=n=>{const r=typeof n<"u"?n:t.getBothMode();t.restorePreviousBindings(r),t.restorePreviousBuffers(r)},t.restorePreviousBindings=n=>{if(!e.context){Bn("you must set the OpenGLRenderWindow before calling restorePreviousBindings");return}const r=e.context;r.bindFramebuffer(r.FRAMEBUFFER,e.previousDrawBinding),e._openGLRenderWindow.setActiveFramebuffer(e.previousActiveFramebuffer)},t.restorePreviousBuffers=n=>{},t.bind=function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;r===null&&(r=e.context.FRAMEBUFFER),e.context.bindFramebuffer(r,e.glFramebuffer);for(let i=0;i<e.colorBuffers.length;i++)e.colorBuffers[i].bind();e._openGLRenderWindow.setActiveFramebuffer(t)},t.create=(n,r)=>{if(!e.context){Bn("you must set the OpenGLRenderWindow before calling create");return}e.glFramebuffer=e.context.createFramebuffer(),e.glFramebuffer.width=n,e.glFramebuffer.height=r},t.setColorBuffer=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const i=e.context;if(!i){Bn("you must set the OpenGLRenderWindow before calling setColorBuffer");return}let a=i.COLOR_ATTACHMENT0;if(r>0)if(e._openGLRenderWindow.getWebgl2())a+=r;else{Bn("Using multiple framebuffer attachments requires WebGL 2");return}e.colorBuffers[r]=n,i.framebufferTexture2D(i.FRAMEBUFFER,a,i.TEXTURE_2D,n.getHandle(),0)},t.removeColorBuffer=function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;const r=e.context;if(!r){Bn("you must set the OpenGLRenderWindow before calling removeColorBuffer");return}let i=r.COLOR_ATTACHMENT0;if(n>0)if(e._openGLRenderWindow.getWebgl2())i+=n;else{Bn("Using multiple framebuffer attachments requires WebGL 2");return}r.framebufferTexture2D(r.FRAMEBUFFER,i,r.TEXTURE_2D,null,0),e.colorBuffers=e.colorBuffers.splice(n,1)},t.setDepthBuffer=n=>{if(!e.context){Bn("you must set the OpenGLRenderWindow before calling setDepthBuffer");return}if(e._openGLRenderWindow.getWebgl2()){const r=e.context;r.framebufferTexture2D(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.TEXTURE_2D,n.getHandle(),0)}else Bn("Attaching depth buffer textures to fbo requires WebGL 2")},t.removeDepthBuffer=()=>{if(!e.context){Bn("you must set the OpenGLRenderWindow before calling removeDepthBuffer");return}if(e._openGLRenderWindow.getWebgl2()){const n=e.context;n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,null,0)}else Bn("Attaching depth buffer textures to framebuffers requires WebGL 2")},t.getGLFramebuffer=()=>e.glFramebuffer,t.setOpenGLRenderWindow=n=>{e._openGLRenderWindow!==n&&(t.releaseGraphicsResources(),e._openGLRenderWindow=n,e.context=null,n&&(e.context=e._openGLRenderWindow.getContext()))},t.releaseGraphicsResources=()=>{e.glFramebuffer&&e.context.deleteFramebuffer(e.glFramebuffer)},t.getSize=()=>e.glFramebuffer==null?null:[e.glFramebuffer.width,e.glFramebuffer.height],t.populateFramebuffer=()=>{if(!e.context){Bn("you must set the OpenGLRenderWindow before calling populateFrameBuffer");return}t.bind();const n=e.context,r=ti.newInstance();r.setOpenGLRenderWindow(e._openGLRenderWindow),r.setMinificationFilter(on.LINEAR),r.setMagnificationFilter(on.LINEAR),r.create2DFromRaw(e.glFramebuffer.width,e.glFramebuffer.height,4,Nn.UNSIGNED_CHAR,null),t.setColorBuffer(r),e.depthTexture=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,e.depthTexture),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_COMPONENT16,e.glFramebuffer.width,e.glFramebuffer.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,e.depthTexture)},t.getColorTexture=()=>e.colorBuffers[0]}const Owe={glFramebuffer:null,colorBuffers:null,depthTexture:null,previousDrawBinding:0,previousReadBinding:0,previousDrawBuffer:0,previousReadBuffer:0,previousActiveFramebuffer:null};function rX(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Owe,n),$r(t,e),e.colorBuffers&&Bn("you cannot initialize colorBuffers through the constructor. You should call setColorBuffer() instead."),e.colorBuffers=[],Pm(t,e,["colorBuffers"]),Dwe(t,e)}const Mwe=Zn(rX,"vtkFramebuffer");var Jw={newInstance:Mwe,extend:rX},Iwe=`//VTK::System::Dec

/*=========================================================================

  Program:   Visualization Toolkit
  Module:    vtkPolyDataVS.glsl

  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen
  All rights reserved.
  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.

     This software is distributed WITHOUT ANY WARRANTY; without even
     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
     PURPOSE.  See the above copyright notice for more information.

=========================================================================*/

attribute vec4 vertexDC;

varying vec3 vertexVCVSOutput;
uniform mat4 PCVCMatrix;

uniform float dcxmin;
uniform float dcxmax;
uniform float dcymin;
uniform float dcymax;

void main()
{
  // dcsmall is the device coords reduced to the
  // x y area covered by the volume
  vec4 dcsmall = vec4(
    dcxmin + 0.5 * (vertexDC.x + 1.0) * (dcxmax - dcxmin),
    dcymin + 0.5 * (vertexDC.y + 1.0) * (dcymax - dcymin),
    vertexDC.z,
    vertexDC.w);
  vec4 vcpos = PCVCMatrix * dcsmall;
  vertexVCVSOutput = vcpos.xyz/vcpos.w;
  gl_Position = dcsmall;
}
`,Rwe=`//VTK::System::Dec

/*=========================================================================

  Program:   Visualization Toolkit
  Module:    vtkVolumeFS.glsl

  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen
  All rights reserved.
  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.

     This software is distributed WITHOUT ANY WARRANTY; without even
     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
     PURPOSE.  See the above copyright notice for more information.

=========================================================================*/
// Template for the volume mappers fragment shader

// the output of this shader
//VTK::Output::Dec

varying vec3 vertexVCVSOutput;

// first declare the settings from the mapper
// that impact the code paths in here

// always set vtkNumComponents 1,2,3,4
//VTK::NumComponents

// possibly define vtkTrilinearOn
//VTK::TrilinearOn

// possibly define UseIndependentComponents
//VTK::IndependentComponentsOn

// possibly define vtkCustomComponentsColorMix
//VTK::CustomComponentsColorMixOn

// possibly define any "proportional" components
//VTK::vtkProportionalComponents

// possibly define any components that are forced to nearest interpolation
//VTK::vtkForceNearestComponents

// Define the blend mode to use
#define vtkBlendMode //VTK::BlendMode

// Possibly define vtkImageLabelOutlineOn
//VTK::ImageLabelOutlineOn

// Possibly define vtkLabelEdgeProjectionOn
//VTK::LabelEdgeProjectionOn


#ifdef vtkImageLabelOutlineOn
  uniform float outlineOpacity;
  uniform float vpWidth;
  uniform float vpHeight;
  uniform float vpOffsetX;
  uniform float vpOffsetY;
  uniform mat4 PCWCMatrix;
  uniform mat4 vWCtoIDX;

  const int MAX_SEGMENT_INDEX = 256; // Define as per expected maximum
  // bool seenSegmentsByOriginalPos[MAX_SEGMENT_INDEX];
  #define MAX_SEGMENTS 256
  #define UINT_SIZE 32
  #define BITMASK_SIZE ((MAX_SEGMENTS + UINT_SIZE - 1) / UINT_SIZE)

  uint bitmask[BITMASK_SIZE];

  // Set the corresponding bit in the bitmask
  void setBit(int segmentIndex) {
    int index = segmentIndex / UINT_SIZE;
    int bitIndex = segmentIndex % UINT_SIZE;
    bitmask[index] |= 1u << bitIndex;
  }

  // Check if a bit is set in the bitmask
  bool isBitSet(int segmentIndex) {
    int index = segmentIndex / UINT_SIZE;
    int bitIndex = segmentIndex % UINT_SIZE;
    return ((bitmask[index] & (1u << bitIndex)) != 0u);
  }
#endif

// define vtkLightComplexity
//VTK::LightComplexity
#if vtkLightComplexity > 0
uniform float vSpecularPower;
uniform float vAmbient;
uniform float vDiffuse;
uniform float vSpecular;
//VTK::Light::Dec
#endif

//VTK::VolumeShadowOn
//VTK::SurfaceShadowOn
//VTK::localAmbientOcclusionOn
//VTK::LAO::Dec
//VTK::VolumeShadow::Dec

// define vtkComputeNormalFromOpacity
//VTK::vtkComputeNormalFromOpacity

// possibly define vtkGradientOpacityOn
//VTK::GradientOpacityOn
#ifdef vtkGradientOpacityOn
uniform float goscale0;
uniform float goshift0;
uniform float gomin0;
uniform float gomax0;
#ifdef UseIndependentComponents
#if vtkNumComponents > 1
uniform float goscale1;
uniform float goshift1;
uniform float gomin1;
uniform float gomax1;
#if vtkNumComponents > 2
uniform float goscale2;
uniform float goshift2;
uniform float gomin2;
uniform float gomax2;
#if vtkNumComponents > 3
uniform float goscale3;
uniform float goshift3;
uniform float gomin3;
uniform float gomax3;
#endif
#endif
#endif
#endif
#endif

// if you want to see the raw tiled
// data in webgl1 uncomment the following line
// #define debugtile

// camera values
uniform float camThick;
uniform float camNear;
uniform float camFar;
uniform int cameraParallel;

// values describing the volume geometry
uniform vec3 vOriginVC;
uniform vec3 vSpacing;
uniform ivec3 volumeDimensions; // 3d texture dimensions
uniform vec3 vPlaneNormal0;
uniform float vPlaneDistance0;
uniform vec3 vPlaneNormal1;
uniform float vPlaneDistance1;
uniform vec3 vPlaneNormal2;
uniform float vPlaneDistance2;
uniform vec3 vPlaneNormal3;
uniform float vPlaneDistance3;
uniform vec3 vPlaneNormal4;
uniform float vPlaneDistance4;
uniform vec3 vPlaneNormal5;
uniform float vPlaneDistance5;

//VTK::ClipPlane::Dec

// opacity and color textures
uniform sampler2D otexture;
uniform float oshift0;
uniform float oscale0;
uniform sampler2D ctexture;
uniform float cshift0;
uniform float cscale0;

#if vtkNumComponents >= 2
uniform float oshift1;
uniform float oscale1;
uniform float cshift1;
uniform float cscale1;
#endif
#if vtkNumComponents >= 3
uniform float oshift2;
uniform float oscale2;
uniform float cshift2;
uniform float cscale2;
#endif
#if vtkNumComponents >= 4
uniform float oshift3;
uniform float oscale3;
uniform float cshift3;
uniform float cscale3;
#endif

// jitter texture
uniform sampler2D jtexture;
uniform sampler2D ttexture;


// some 3D texture values
uniform float sampleDistance;
uniform vec3 vVCToIJK;
uniform vec3 volumeSpacings; // spacing in the world coorindates


// the heights defined below are the locations
// for the up to four components of the tfuns
// the tfuns have a height of 2XnumComps pixels so the
// values are computed to hit the middle of the two rows
// for that component
#ifdef UseIndependentComponents
#if vtkNumComponents == 1
uniform float mix0;
#define height0 0.5
#endif
#if vtkNumComponents == 2
uniform float mix0;
uniform float mix1;
#define height0 0.25
#define height1 0.75
#endif
#if vtkNumComponents == 3
uniform float mix0;
uniform float mix1;
uniform float mix2;
#define height0 0.17
#define height1 0.5
#define height2 0.83
#endif
#if vtkNumComponents == 4
uniform float mix0;
uniform float mix1;
uniform float mix2;
uniform float mix3;
#define height0 0.125
#define height1 0.375
#define height2 0.625
#define height3 0.875
#endif
#endif

uniform vec4 ipScalarRangeMin;
uniform vec4 ipScalarRangeMax;

// declaration for intermixed geometry
//VTK::ZBuffer::Dec

//=======================================================================
// global and custom variables (a temporary section before photorealistics rendering module is complete)
vec3 rayDirVC;
float sampleDistanceISVS;
float sampleDistanceIS;

#define SQRT3    1.7321
#define INV4PI   0.0796
#define EPSILON  0.001
#define PI       3.1415
#define PI2      9.8696

//=======================================================================
// Webgl2 specific version of functions
#if __VERSION__ == 300

uniform highp sampler3D texture1;

vec4 getTextureValue(vec3 pos)
{
  vec4 tmp = texture(texture1, pos);

  #if defined(vtkComponent0ForceNearest) || \\
      defined(vtkComponent1ForceNearest) || \\
      defined(vtkComponent2ForceNearest) || \\
      defined(vtkComponent3ForceNearest)
    vec3 nearestPos = (floor(pos * vec3(volumeDimensions)) + 0.5) / vec3(volumeDimensions);
    vec4 nearestValue = texture(texture1, nearestPos);
    #ifdef vtkComponent0ForceNearest
      tmp[0] = nearestValue[0];
    #endif
    #ifdef vtkComponent1ForceNearest
      tmp[1] = nearestValue[1];
    #endif
    #ifdef vtkComponent2ForceNearest
      tmp[2] = nearestValue[2];
    #endif
    #ifdef vtkComponent3ForceNearest
      tmp[3] = nearestValue[3];
    #endif
  #endif

  #ifndef UseIndependentComponents
    #if vtkNumComponents == 1
      tmp.a = tmp.r;
    #endif
    #if vtkNumComponents == 2
      tmp.a = tmp.g;
    #endif
    #if vtkNumComponents == 3
      tmp.a = length(tmp.rgb);
    #endif
  #endif

  return tmp;
}

//=======================================================================
// WebGL1 specific version of functions
#else

uniform sampler2D texture1;

uniform float texWidth;
uniform float texHeight;
uniform int xreps;
uniform int xstride;
uniform int ystride;

// if computing trilinear values from multiple z slices
#ifdef vtkTrilinearOn
vec4 getTextureValue(vec3 ijk)
{
  float zoff = 1.0/float(volumeDimensions.z);
  vec4 val1 = getOneTextureValue(ijk);
  vec4 val2 = getOneTextureValue(vec3(ijk.xy, ijk.z + zoff));

  float indexZ = float(volumeDimensions)*ijk.z;
  float zmix =  indexZ - floor(indexZ);

  return mix(val1, val2, zmix);
}

vec4 getOneTextureValue(vec3 ijk)
#else // nearest or fast linear
vec4 getTextureValue(vec3 ijk)
#endif
{
  vec3 tdims = vec3(volumeDimensions);

#ifdef debugtile
  vec2 tpos = vec2(ijk.x, ijk.y);
  vec4 tmp = texture2D(texture1, tpos);
  tmp.a = 1.0;

#else
  int z = int(ijk.z * tdims.z);
  int yz = z / xreps;
  int xz = z - yz*xreps;

  int tileWidth = volumeDimensions.x/xstride;
  int tileHeight = volumeDimensions.y/ystride;

  xz *= tileWidth;
  yz *= tileHeight;

  float ni = float(xz) + (ijk.x*float(tileWidth));
  float nj = float(yz) + (ijk.y*float(tileHeight));

  vec2 tpos = vec2(ni/texWidth, nj/texHeight);

  vec4 tmp = texture2D(texture1, tpos);

#if vtkNumComponents == 1
  tmp.a = tmp.r;
#endif
#if vtkNumComponents == 2
  tmp.g = tmp.a;
#endif
#if vtkNumComponents == 3
  tmp.a = length(tmp.rgb);
#endif
#endif

  return tmp;
}

// End of Webgl1 specific code
//=======================================================================
#endif

//=======================================================================
// transformation between VC and IS space

// convert vector position from idx to vc
#if (vtkLightComplexity > 0) || (defined vtkClippingPlanesOn)
vec3 IStoVC(vec3 posIS){
  vec3 posVC = posIS / vVCToIJK;
  return posVC.x * vPlaneNormal0 +
         posVC.y * vPlaneNormal2 +
         posVC.z * vPlaneNormal4 +
         vOriginVC;
}

// convert vector position from vc to idx
vec3 VCtoIS(vec3 posVC){
  posVC = posVC - vOriginVC;
  posVC = vec3(
    dot(posVC, vPlaneNormal0),
    dot(posVC, vPlaneNormal2),
    dot(posVC, vPlaneNormal4));
  return posVC * vVCToIJK;
}
#endif

//Rotate vector to view coordinate
#if (vtkLightComplexity > 0) || (defined vtkGradientOpacityOn)
void rotateToViewCoord(inout vec3 dirIS){
  dirIS.xyz =
    dirIS.x * vPlaneNormal0 +
    dirIS.y * vPlaneNormal2 +
    dirIS.z * vPlaneNormal4;
}

//Rotate vector to idx coordinate
vec3 rotateToIDX(vec3 dirVC){
  vec3 dirIS;
  dirIS.xyz = vec3(
    dot(dirVC, vPlaneNormal0),
    dot(dirVC, vPlaneNormal2),
    dot(dirVC, vPlaneNormal4));
  return dirIS;
}
#endif

//=======================================================================
// Given a normal compute the gradient opacity factors
float computeGradientOpacityFactor(
  float normalMag, float goscale, float goshift, float gomin, float gomax)
{
  return clamp(normalMag * goscale + goshift, gomin, gomax);
}

//=======================================================================
// compute the normal and gradient magnitude for a position, uses forward difference
#if (vtkLightComplexity > 0) || (defined vtkGradientOpacityOn)
  #ifdef vtkClippingPlanesOn
    void adjustClippedVoxelValues(vec3 pos, vec3 texPos[3], inout vec3 g1)
    {
      vec3 g1VC[3];
      for (int i = 0; i < 3; ++i)
      {
        g1VC[i] = IStoVC(texPos[i]);
      }
      vec3 posVC = IStoVC(pos);
      for (int i = 0; i < clip_numPlanes; ++i)
      {
        for (int j = 0; j < 3; ++j)
        {
          if(dot(vec3(vClipPlaneOrigins[i] - g1VC[j].xyz), vClipPlaneNormals[i]) > 0.0)
          {
            g1[j] = 0.0;
          }
        }
      }
    }
  #endif

  #ifdef vtkComputeNormalFromOpacity
    vec4 computeDensityNormal(vec3 opacityUCoords[2], float opactityTextureHeight, float gradientOpacity) {
      vec3 opacityG1, opacityG2;
      opacityG1.x = texture2D(otexture, vec2(opacityUCoords[0].x, opactityTextureHeight)).r;
      opacityG1.y = texture2D(otexture, vec2(opacityUCoords[0].y, opactityTextureHeight)).r;
      opacityG1.z = texture2D(otexture, vec2(opacityUCoords[0].z, opactityTextureHeight)).r;
      opacityG2.x = texture2D(otexture, vec2(opacityUCoords[1].x, opactityTextureHeight)).r;
      opacityG2.y = texture2D(otexture, vec2(opacityUCoords[1].y, opactityTextureHeight)).r;
      opacityG2.z = texture2D(otexture, vec2(opacityUCoords[1].z, opactityTextureHeight)).r;
      opacityG1.xyz *= gradientOpacity;
      opacityG2.xyz *= gradientOpacity;

      vec4 opacityG = vec4(opacityG1 - opacityG2, 1.0f);
      // divide by spacing
      opacityG.xyz /= vSpacing;
      opacityG.w = length(opacityG.xyz);
      // rotate to View Coords
      rotateToViewCoord(opacityG.xyz);
      if (!all(equal(opacityG.xyz, vec3(0.0)))) {
        return vec4(normalize(opacityG.xyz),opacityG.w);
      } else {
        return vec4(0.0);
      }
    }

    vec4 computeNormalForDensity(vec3 pos, vec3 tstep, out vec3 scalarInterp[2], const int opacityComponent)
    {
      vec3 xvec = vec3(tstep.x, 0.0, 0.0);
      vec3 yvec = vec3(0.0, tstep.y, 0.0);
      vec3 zvec = vec3(0.0, 0.0, tstep.z);
      vec3 texPosPVec[3];
      texPosPVec[0] = pos + xvec;
      texPosPVec[1] = pos + yvec;
      texPosPVec[2] = pos + zvec;
      vec3 texPosNVec[3];
      texPosNVec[0] = pos - xvec;
      texPosNVec[1] = pos - yvec;
      texPosNVec[2] = pos - zvec;
      vec3 g1, g2;

      scalarInterp[0].x = getTextureValue(texPosPVec[0])[opacityComponent];
      scalarInterp[0].y = getTextureValue(texPosPVec[1])[opacityComponent];
      scalarInterp[0].z = getTextureValue(texPosPVec[2])[opacityComponent];
      scalarInterp[1].x = getTextureValue(texPosNVec[0])[opacityComponent];
      scalarInterp[1].y = getTextureValue(texPosNVec[1])[opacityComponent];
      scalarInterp[1].z = getTextureValue(texPosNVec[2])[opacityComponent];

      #ifdef vtkClippingPlanesOn
        adjustClippedVoxelValues(pos, texPosPVec, scalarInterp[0]);
        adjustClippedVoxelValues(pos, texPosNVec, scalarInterp[1]);
      #endif
      vec4 result;
      result.x = scalarInterp[0].x - scalarInterp[1].x;
      result.y = scalarInterp[0].y - scalarInterp[1].y;
      result.z = scalarInterp[0].z - scalarInterp[1].z;
      // divide by spacing
      result.xyz /= vSpacing;
      result.w = length(result.xyz);
      // rotate to View Coords
      rotateToViewCoord(result.xyz);
      if (length(result.xyz) > 0.0) {
        return vec4(normalize(result.xyz),result.w);
      } else {
        return vec4(0.0);
      }
    }
  #endif

  // only works with dependent components
  vec4 computeNormal(vec3 pos, vec3 tstep)
  {
    vec3 xvec = vec3(tstep.x, 0.0, 0.0);
    vec3 yvec = vec3(0.0, tstep.y, 0.0);
    vec3 zvec = vec3(0.0, 0.0, tstep.z);
    vec3 texPosPVec[3];
    texPosPVec[0] = pos + xvec;
    texPosPVec[1] = pos + yvec;
    texPosPVec[2] = pos + zvec;
    vec3 texPosNVec[3];
    texPosNVec[0] = pos - xvec;
    texPosNVec[1] = pos - yvec;
    texPosNVec[2] = pos - zvec;
    vec3 g1, g2;
    g1.x = getTextureValue(texPosPVec[0]).a;
    g1.y = getTextureValue(texPosPVec[1]).a;
    g1.z = getTextureValue(texPosPVec[2]).a;
    g2.x = getTextureValue(texPosNVec[0]).a;
    g2.y = getTextureValue(texPosNVec[1]).a;
    g2.z = getTextureValue(texPosNVec[2]).a;
    #ifdef vtkClippingPlanesOn
      adjustClippedVoxelValues(pos, texPosPVec, g1);
      adjustClippedVoxelValues(pos, texPosNVec, g2);
    #endif
    vec4 result;
    result = vec4(g1 - g2, -1.0);
    // divide by spacing
    result.xyz /= vSpacing;
    result.w = length(result.xyz);
    if (result.w > 0.0){
      // rotate to View Coords
      rotateToViewCoord(result.xyz);
      return vec4(normalize(result.xyz),result.w);
    } else {
      return vec4(0.0);
    }
  }
#endif


#ifdef vtkImageLabelOutlineOn
  vec4 fragCoordToPCPos(vec4 fragCoord) {
    return vec4(
      (fragCoord.x / vpWidth - vpOffsetX - 0.5) * 2.0,
      (fragCoord.y / vpHeight - vpOffsetY - 0.5) * 2.0,
      (fragCoord.z - 0.5) * 2.0,
      1.0);
  }

  vec4 pcPosToWorldCoord(vec4 pcPos) {
    return PCWCMatrix * pcPos;
  }

  vec3 fragCoordToIndexSpace(vec4 fragCoord) {
    vec4 pcPos = fragCoordToPCPos(fragCoord);
    vec4 worldCoord = pcPosToWorldCoord(pcPos);
    vec4 vertex = (worldCoord / worldCoord.w);

    vec3 index = (vWCtoIDX * vertex).xyz;

    // half voxel fix for labelmapOutline
    return (index + vec3(0.5)) / vec3(volumeDimensions);
  }

  vec3 fragCoordToWorld(vec4 fragCoord) {
    vec4 pcPos = fragCoordToPCPos(fragCoord);
    vec4 worldCoord = pcPosToWorldCoord(pcPos);
    return worldCoord.xyz;
  }
#endif

//=======================================================================
// compute the normals and gradient magnitudes for a position
// for independent components
mat4 computeMat4Normal(vec3 pos, vec4 tValue, vec3 tstep)
{
  mat4 result;
  vec4 distX = getTextureValue(pos + vec3(tstep.x, 0.0, 0.0)) - tValue;
  vec4 distY = getTextureValue(pos + vec3(0.0, tstep.y, 0.0)) - tValue;
  vec4 distZ = getTextureValue(pos + vec3(0.0, 0.0, tstep.z)) - tValue;

  // divide by spacing
  distX /= vSpacing.x;
  distY /= vSpacing.y;
  distZ /= vSpacing.z;

  mat3 rot;
  rot[0] = vPlaneNormal0;
  rot[1] = vPlaneNormal2;
  rot[2] = vPlaneNormal4;

#if !defined(vtkComponent0Proportional)
  result[0].xyz = vec3(distX.r, distY.r, distZ.r);
  result[0].a = length(result[0].xyz);
  result[0].xyz *= rot;
  if (result[0].w > 0.0)
  {
    result[0].xyz /= result[0].w;
  }
#endif

// optionally compute the 2nd component
#if vtkNumComponents >= 2 && !defined(vtkComponent1Proportional)
  result[1].xyz = vec3(distX.g, distY.g, distZ.g);
  result[1].a = length(result[1].xyz);
  result[1].xyz *= rot;
  if (result[1].w > 0.0)
  {
    result[1].xyz /= result[1].w;
  }
#endif

// optionally compute the 3rd component
#if vtkNumComponents >= 3 && !defined(vtkComponent2Proportional)
  result[2].xyz = vec3(distX.b, distY.b, distZ.b);
  result[2].a = length(result[2].xyz);
  result[2].xyz *= rot;
  if (result[2].w > 0.0)
  {
    result[2].xyz /= result[2].w;
  }
#endif

// optionally compute the 4th component
#if vtkNumComponents >= 4 && !defined(vtkComponent3Proportional)
  result[3].xyz = vec3(distX.a, distY.a, distZ.a);
  result[3].a = length(result[3].xyz);
  result[3].xyz *= rot;
  if (result[3].w > 0.0)
  {
    result[3].xyz /= result[3].w;
  }
#endif

  return result;
}

//=======================================================================
// global shadow - secondary ray
#if defined(VolumeShadowOn) || defined(localAmbientOcclusionOn)
float random()
{
  float rand = fract(sin(dot(gl_FragCoord.xy,vec2(12.9898,78.233)))*43758.5453123);
  float jitter=texture2D(jtexture,gl_FragCoord.xy/32.).r;
  uint pcg_state = floatBitsToUint(jitter);
  uint state = pcg_state;
  pcg_state = pcg_state * uint(747796405) + uint(2891336453);
  uint word = ((state >> ((state >> uint(28)) + uint(4))) ^ state) * uint(277803737);
  return (float((((word >> uint(22)) ^ word) >> 1 ))/float(2147483647) + rand)/2.0;
}
#endif

#ifdef VolumeShadowOn
// henyey greenstein phase function
float phase_function(float cos_angle)
{
  // divide by 2.0 instead of 4pi to increase intensity
  return ((1.0-anisotropy2)/pow(1.0+anisotropy2-2.0*anisotropy*cos_angle, 1.5))/2.0;
}

// Computes the intersection between a ray and a box
struct Hit
{
  float tmin;
  float tmax;
};

struct Ray
{
  vec3 origin;
  vec3 dir;
  vec3 invDir;
};

bool BBoxIntersect(vec3 boundMin, vec3 boundMax, const Ray r, out Hit hit)
{
  vec3 tbot = r.invDir * (boundMin - r.origin);
  vec3 ttop = r.invDir * (boundMax - r.origin);
  vec3 tmin = min(ttop, tbot);
  vec3 tmax = max(ttop, tbot);
  vec2 t = max(tmin.xx, tmin.yz);
  float t0 = max(t.x, t.y);
  t = min(tmax.xx, tmax.yz);
  float t1 = min(t.x, t.y);
  hit.tmin = t0;
  hit.tmax = t1;
  return t1 > max(t0,0.0);
}

// As BBoxIntersect requires the inverse of the ray coords,
// this function is used to avoid numerical issues
void safe_0_vector(inout Ray ray)
{
  if(abs(ray.dir.x) < EPSILON) ray.dir.x = sign(ray.dir.x) * EPSILON;
  if(abs(ray.dir.y) < EPSILON) ray.dir.y = sign(ray.dir.y) * EPSILON;
  if(abs(ray.dir.z) < EPSILON) ray.dir.z = sign(ray.dir.z) * EPSILON;
}

float volume_shadow(vec3 posIS, vec3 lightDirNormIS)
{
  float shadow = 1.0;
  float opacity = 0.0;

  // modify sample distance with a random number between 1.5 and 3.0
  float sampleDistanceISVS_jitter = sampleDistanceISVS * mix(1.5, 3.0, random());
  float opacityPrev = texture2D(otexture, vec2(getTextureValue(posIS).r * oscale0 + oshift0, 0.5)).r;

  // in case the first sample near surface has a very tiled light ray, we need to offset start position
  posIS += sampleDistanceISVS_jitter * lightDirNormIS;

  // compute the start and end points for the ray
  Ray ray;
  Hit hit;
  ray.origin = posIS;
  ray.dir = lightDirNormIS;
  safe_0_vector(ray);
  ray.invDir = 1.0/ray.dir;

  if(!BBoxIntersect(vec3(0.0),vec3(1.0), ray, hit))
  {
    return 1.0;
  }
  float maxdist = hit.tmax;

  // interpolate shadow ray length between: 1 unit of sample distance in IS to SQRT3, based on globalIlluminationReach
  float maxgi = mix(sampleDistanceISVS_jitter,SQRT3,giReach);
  maxdist = min(maxdist,maxgi);
  if(maxdist < EPSILON) {
    return 1.0;
  }

  float current_dist = 0.0;
  float current_step = length(sampleDistanceISVS_jitter * lightDirNormIS);
  float clamped_step = 0.0;

  vec4 scalar = vec4(0.0);
  while(current_dist < maxdist)
  {
#ifdef vtkClippingPlanesOn
    vec3 posVC = IStoVC(posIS);
    for (int i = 0; i < clip_numPlanes; ++i)
    {
      if (dot(vec3(vClipPlaneOrigins[i] - posVC), vClipPlaneNormals[i]) > 0.0)
      {
        current_dist = maxdist;
      }
    }
#endif
    scalar = getTextureValue(posIS);
    opacity = texture2D(otexture, vec2(scalar.r * oscale0 + oshift0, 0.5)).r;
    #if defined(vtkGradientOpacityOn) && !defined(UseIndependentComponents)
      vec4 normal = computeNormal(posIS, vec3(1.0/vec3(volumeDimensions)));
      opacity *= computeGradientOpacityFactor(normal.w, goscale0, goshift0, gomin0, gomax0);
    #endif
    shadow *= 1.0 - opacity;

    // optimization: early termination
    if (shadow < EPSILON){
      return 0.0;
    }

    clamped_step = min(maxdist - current_dist, current_step);
    posIS += clamped_step * lightDirNormIS;
    current_dist += current_step;
  }

  return shadow;
}

vec3 applyShadowRay(vec3 tColor, vec3 posIS, vec3 viewDirectionVC)
{
  vec3 vertLight = vec3(0.0);
  vec3 secondary_contrib = vec3(0.0);
  // here we assume only positional light, no effect of cones
  for (int i = 0; i < lightNum; i++)
  {
    #if(vtkLightComplexity==3)
      if (lightPositional[i] == 1){
        vertLight = lightPositionVC[i] - IStoVC(posIS);
      }else{
        vertLight = - lightDirectionVC[i];
      }
    #else
      vertLight = - lightDirectionVC[i];
    #endif
    // here we assume achromatic light, only intensity
    float dDotL = dot(viewDirectionVC, normalize(vertLight));
    // isotropic scatter returns 0.5 instead of 1/4pi to increase intensity
    float phase_attenuation = 0.5;
    if (abs(anisotropy) > EPSILON){
      phase_attenuation = phase_function(dDotL);
    }
    float vol_shadow = volume_shadow(posIS, normalize(rotateToIDX(vertLight)));
    secondary_contrib += tColor * vDiffuse * lightColor[i] * vol_shadow * phase_attenuation;
    secondary_contrib += tColor * vAmbient;
  }
  return secondary_contrib;
}
#endif

//=======================================================================
// local ambient occlusion
#ifdef localAmbientOcclusionOn
vec3 sample_direction_uniform(int i)
{
  float rand = random() * 0.5;
  float theta = PI2 * (kernelSample[i][0] + rand);
  float phi = acos(2.0 * (kernelSample[i][1] + rand) -1.0) / 2.5;
  return normalize(vec3(cos(theta)*sin(phi), sin(theta)*sin(phi), cos(phi)));
}

// return a matrix that transform startDir into z axis; startDir should be normalized
mat3 zBaseRotationalMatrix(vec3 startDir){
  vec3 axis = cross(startDir, vec3(0.0,0.0,1.0));
  float cosA = startDir.z;
  float k = 1.0 / (1.0 + cosA);
  mat3 matrix = mat3((axis.x * axis.x * k) + cosA, (axis.y * axis.x * k) - axis.z, (axis.z * axis.x * k) + axis.y,
              (axis.x * axis.y * k) + axis.z, (axis.y * axis.y * k) + cosA, (axis.z * axis.y * k) - axis.x,
              (axis.x * axis.z * k) - axis.y, (axis.y * axis.z * k) + axis.x, (axis.z * axis.z * k) + cosA);
  return matrix;
}

float computeLAO(vec3 posIS, float op, vec3 lightDir, vec4 normal){
  // apply LAO only at selected locations, otherwise return full brightness
  if (normal.w > 0.0 && op > 0.05){
    float total_transmittance = 0.0;
    mat3 inverseRotateBasis = inverse(zBaseRotationalMatrix(normalize(-normal.xyz)));
    vec3 currPos, randomDirStep;
    float weight, transmittance, opacity;
    for (int i = 0; i < kernelSize; i++)
    {
      randomDirStep = inverseRotateBasis * sample_direction_uniform(i) * sampleDistanceIS;
      weight = 1.0 - dot(normalize(lightDir), normalize(randomDirStep));
      currPos = posIS;
      transmittance = 1.0;
      for (int j = 0; j < kernelRadius ; j++){
        currPos += randomDirStep;
        // check if it's at clipping plane, if so return full brightness
        if (all(greaterThan(currPos, vec3(EPSILON))) && all(lessThan(currPos,vec3(1.0-EPSILON)))){
          opacity = texture2D(otexture, vec2(getTextureValue(currPos).r * oscale0 + oshift0, 0.5)).r;
          #ifdef vtkGradientOpacityOn
             opacity *= computeGradientOpacityFactor(normal.w, goscale0, goshift0, gomin0, gomax0);
          #endif
          transmittance *= 1.0 - opacity;
        }
        else{
          break;
        }
      }
      total_transmittance += transmittance / float(kernelRadius) * weight;

      // early termination if fully translucent
      if (total_transmittance > 1.0 - EPSILON){
        return 1.0;
      }
    }
    // average transmittance and reduce variance
    return clamp(total_transmittance / float(kernelSize), 0.3, 1.0);
  } else {
    return 1.0;
  }
}
#endif

//=======================================================================
// surface light contribution
#if vtkLightComplexity > 0
  void applyLighting(inout vec3 tColor, vec4 normal)
  {
    vec3 diffuse = vec3(0.0, 0.0, 0.0);
    vec3 specular = vec3(0.0, 0.0, 0.0);
    float df, sf = 0.0;
    for (int i = 0; i < lightNum; i++){
        df = abs(dot(normal.rgb, -lightDirectionVC[i]));
        diffuse += df * lightColor[i];
        sf = pow( abs(dot(lightHalfAngleVC[i],normal.rgb)), vSpecularPower);
        specular += sf * lightColor[i];
    }
    tColor.rgb = tColor.rgb*(diffuse*vDiffuse + vAmbient) + specular*vSpecular;
  }
  #ifdef SurfaceShadowOn
  #if vtkLightComplexity < 3
    vec3 applyLightingDirectional(vec3 posIS, vec4 tColor, vec4 normal)
    {
      // everything in VC
      vec3 diffuse = vec3(0.0);
      vec3 specular = vec3(0.0);
      #ifdef localAmbientOcclusionOn
        vec3 ambient = vec3(0.0);
      #endif
      vec3 vertLightDirection;
      for (int i = 0; i < lightNum; i++){
        float ndotL,vdotR;
        vertLightDirection = lightDirectionVC[i];
        ndotL = dot(normal.xyz, vertLightDirection);
        if (ndotL < 0.0 && twoSidedLighting)
        {
          ndotL = -ndotL;
        }
        if (ndotL > 0.0)
        {
          diffuse += ndotL * lightColor[i];
          //specular
          vdotR = dot(-rayDirVC, normalize(2.0 * ndotL * -normal.xyz + vertLightDirection));
          if (vdotR > 0.0)
          {
            specular += pow(vdotR, vSpecularPower) * lightColor[i];
          }
        }
        #ifdef localAmbientOcclusionOn
            ambient += computeLAO(posIS, tColor.a, vertLightDirection, normal);
        #endif
      }
      #ifdef localAmbientOcclusionOn
        return tColor.rgb * (diffuse * vDiffuse + vAmbient * ambient) + specular*vSpecular;
      #else
        return tColor.rgb * (diffuse * vDiffuse + vAmbient) + specular*vSpecular;
      #endif
    }
  #else
    vec3 applyLightingPositional(vec3 posIS, vec4 tColor, vec4 normal, vec3 posVC)
    {
      // everything in VC
      vec3 diffuse = vec3(0.0);
      vec3 specular = vec3(0.0);
      #ifdef localAmbientOcclusionOn
        vec3 ambient = vec3(0.0);
      #endif
      vec3 vertLightDirection;
      for (int i = 0; i < lightNum; i++){
        float distance,attenuation,ndotL,vdotR;
        vec3 lightDir;
        if (lightPositional[i] == 1){
          lightDir = lightDirectionVC[i];
          vertLightDirection = posVC - lightPositionVC[i];
          distance = length(vertLightDirection);
          vertLightDirection = normalize(vertLightDirection);
          attenuation = 1.0 / (lightAttenuation[i].x
                              + lightAttenuation[i].y * distance
                              + lightAttenuation[i].z * distance * distance);
          // per OpenGL standard cone angle is 90 or less for a spot light
          if (lightConeAngle[i] <= 90.0){
            float coneDot = dot(vertLightDirection, lightDir);
            if (coneDot >= cos(radians(lightConeAngle[i]))){  // if inside cone
              attenuation = attenuation * pow(coneDot, lightExponent[i]);
            }
            else {
              attenuation = 0.0;
            }
          }
          ndotL = dot(normal.xyz, vertLightDirection);
          if (ndotL < 0.0 && twoSidedLighting)
          {
            ndotL = -ndotL;
          }
          if (ndotL > 0.0)
          {
            diffuse += ndotL * attenuation * lightColor[i];
            //specular
            vdotR = dot(-rayDirVC, normalize(2.0 * ndotL * -normal.xyz + vertLightDirection));
            if (vdotR > 0.0)
            {
              specular += pow(vdotR, vSpecularPower) * attenuation * lightColor[i];
            }
          }
          #ifdef localAmbientOcclusionOn
            ambient += computeLAO(posIS, tColor.a, vertLightDirection, normal);
          #endif
        } else {
          vertLightDirection = lightDirectionVC[i];
          ndotL = dot(normal.xyz, vertLightDirection);
          if (ndotL < 0.0 && twoSidedLighting)
          {
            ndotL = -ndotL;
          }
          if (ndotL > 0.0)
          {
            diffuse += ndotL * lightColor[i];
            //specular
            vdotR = dot(-rayDirVC, normalize(2.0 * ndotL * -normal.xyz + vertLightDirection));
            if (vdotR > 0.0)
            {
              specular += pow(vdotR, vSpecularPower) * lightColor[i];
            }
          }
          #ifdef localAmbientOcclusionOn
            ambient += computeLAO(posIS, tColor.a, vertLightDirection, normal);
          #endif
        }
      }
      #ifdef localAmbientOcclusionOn
        return tColor.rgb * (diffuse * vDiffuse + vAmbient * ambient) + specular*vSpecular;
      #else
        return tColor.rgb * (diffuse * vDiffuse + vAmbient) + specular*vSpecular;
      #endif
    }
  #endif
  #endif
#endif

// LAO of surface shadows and volume shadows only work with dependent components
vec3 applyAllLightning(vec3 tColor, float alpha, vec3 posIS, vec4 normalLight) {
  #if vtkLightComplexity > 0
    // surface shadows if needed
    #ifdef SurfaceShadowOn
      #if vtkLightComplexity < 3
        vec3 tColorS = applyLightingDirectional(posIS, vec4(tColor, alpha), normalLight);
      #else
        vec3 tColorS = applyLightingPositional(posIS, vec4(tColor, alpha), normalLight, IStoVC(posIS));
      #endif
    #endif

    // volume shadows if needed
    #ifdef VolumeShadowOn
      vec3 tColorVS = applyShadowRay(tColor, posIS, rayDirVC);
    #endif

    // merge
    #ifdef VolumeShadowOn
      #ifdef SurfaceShadowOn
        // surface shadows + volumetric shadows
        float vol_coef = volumetricScatteringBlending * (1.0 - alpha / 2.0) * (1.0 - atan(normalLight.w) * INV4PI);
        tColor = (1.0-vol_coef) * tColorS + vol_coef * tColorVS;
      #else
        // volumetric shadows only
        tColor = tColorVS;
      #endif
    #else
      #ifdef SurfaceShadowOn
        // surface shadows only
        tColor = tColorS;
      #else
        // no shadows
        applyLighting(tColor, normal3);
      #endif
    #endif
  #endif
  return tColor;
}

  
vec4 getColorForValue(vec4 tValue, vec3 posIS, vec3 tstep)
{

// If labeloutline and not the edge labelmap, since in the edge labelmap blend
// we need the underlying data to sample through
#if defined(vtkImageLabelOutlineOn) && !defined(vtkLabelEdgeProjectionOn)
  vec3 centerPosIS = fragCoordToIndexSpace(gl_FragCoord); // pos in texture space
  vec4 centerValue = getTextureValue(centerPosIS);
  bool pixelOnBorder = false;
  vec4 tColor = texture2D(ctexture, vec2(centerValue.r * cscale0 + cshift0, 0.5));

  // Get alpha of segment from opacity function.
  tColor.a = texture2D(otexture, vec2(centerValue.r * oscale0 + oshift0, 0.5)).r;

  int segmentIndex = int(centerValue.r * 255.0);
  
  // Use texture sampling for outlineThickness
  float textureCoordinate = float(segmentIndex - 1) / 1024.0;
  float textureValue = texture2D(ttexture, vec2(textureCoordinate, 0.5)).r;

  int actualThickness = int(textureValue * 255.0);


  // If it is the background (segment index 0), we should quickly bail out. 
  // Previously, this was determined by tColor.a, which was incorrect as it
  // prevented the outline from appearing when the fill is 0.
  if (segmentIndex == 0){
    return vec4(0, 0, 0, 0);
  }

  // Only perform outline check on fragments rendering voxels that aren't invisible.
  // Saves a bunch of needless checks on the background.
  // TODO define epsilon when building shader?
  for (int i = -actualThickness; i <= actualThickness; i++) {
    for (int j = -actualThickness; j <= actualThickness; j++) {
      if (i == 0 || j == 0) {
        continue;
      }

      vec4 neighborPixelCoord = vec4(gl_FragCoord.x + float(i),
        gl_FragCoord.y + float(j),
        gl_FragCoord.z, gl_FragCoord.w);

      vec3 neighborPosIS = fragCoordToIndexSpace(neighborPixelCoord);
      vec4 value = getTextureValue(neighborPosIS);

      // If any of my neighbours are not the same value as I
      // am, this means I am on the border of the segment.
      // We can break the loops
      if (any(notEqual(value, centerValue))) {
        pixelOnBorder = true;
        break;
      }
    }

    if (pixelOnBorder == true) {
      break;
    }
  }

  // If I am on the border, I am displayed at full opacity
  if (pixelOnBorder == true) {
    tColor.a = outlineOpacity;
  }

  return tColor;

#else
  // compute the normal and gradient magnitude if needed
  // We compute it as a vec4 if possible otherwise a mat4

  #ifdef UseIndependentComponents

    // sample textures
    vec3 tColor0 = texture2D(ctexture, vec2(tValue.r * cscale0 + cshift0, height0)).rgb;
    float pwfValue0 = texture2D(otexture, vec2(tValue.r * oscale0 + oshift0, height0)).r;

    #if vtkNumComponents > 1
      vec3 tColor1 = texture2D(ctexture, vec2(tValue.g * cscale1 + cshift1, height1)).rgb;
      float pwfValue1 = texture2D(otexture, vec2(tValue.g * oscale1 + oshift1, height1)).r;

      #if vtkNumComponents > 2
        vec3 tColor2 = texture2D(ctexture, vec2(tValue.b * cscale2 + cshift2, height2)).rgb;
        float pwfValue2 = texture2D(otexture, vec2(tValue.b * oscale2 + oshift2, height2)).r;

        #if vtkNumComponents > 3
          vec3 tColor3 = texture2D(ctexture, vec2(tValue.a * cscale3 + cshift3, height3)).rgb;
          float pwfValue3 = texture2D(otexture, vec2(tValue.a * oscale3 + oshift3, height3)).r;
        #endif
      #endif
    #endif

    #if !defined(vtkCustomComponentsColorMix)
      // default path for component color mix

      // compute the normal vectors as needed
      #if (vtkLightComplexity > 0) || defined(vtkGradientOpacityOn)
        mat4 normalMat = computeMat4Normal(posIS, tValue, tstep);
      #endif

      // compute gradient opacity factors as needed
      vec4 goFactor = vec4(1.0, 1.0 ,1.0 ,1.0);
      #if defined(vtkGradientOpacityOn)
        #if !defined(vtkComponent0Proportional)
          goFactor.x =
            computeGradientOpacityFactor(normalMat[0].a, goscale0, goshift0, gomin0, gomax0);
        #endif
        #if vtkNumComponents > 1
          #if !defined(vtkComponent1Proportional)
            goFactor.y =
              computeGradientOpacityFactor(normalMat[1].a, goscale1, goshift1, gomin1, gomax1);
          #endif
          #if vtkNumComponents > 2
            #if !defined(vtkComponent2Proportional)
              goFactor.z =
                computeGradientOpacityFactor(normalMat[2].a, goscale2, goshift2, gomin2, gomax2);
            #endif
            #if vtkNumComponents > 3
              #if !defined(vtkComponent3Proportional)
                goFactor.w =
                  computeGradientOpacityFactor(normalMat[3].a, goscale3, goshift3, gomin3, gomax3);
              #endif
            #endif
          #endif
        #endif
      #endif

      // process color and opacity for each component
      #if !defined(vtkComponent0Proportional)
        float alpha = goFactor.x*mix0*pwfValue0;
        #if vtkLightComplexity > 0
          applyLighting(tColor0, normalMat[0]);
        #endif
      #else
        tColor0 *= pwfValue0;
        float alpha = mix(pwfValue0, 1.0, (1.0 - mix0));
      #endif

      #if vtkNumComponents > 1
        #if !defined(vtkComponent1Proportional)
          alpha += goFactor.y*mix1*pwfValue1;
          #if vtkLightComplexity > 0
            applyLighting(tColor1, normalMat[1]);
          #endif
        #else
          tColor1 *= pwfValue1;
          alpha *= mix(pwfValue1, 1.0, (1.0 - mix1));
        #endif

        #if vtkNumComponents > 2
          #if !defined(vtkComponent2Proportional)
            alpha += goFactor.z*mix2*pwfValue2;
            #if vtkLightComplexity > 0
              applyLighting(tColor2, normalMat[2]);
            #endif
          #else
            tColor2 *= pwfValue2;
            alpha *= mix(pwfValue2, 1.0, (1.0 - mix2));
          #endif
        #endif

        #if vtkNumComponents > 3
          #if !defined(vtkComponent3Proportional)
            alpha += goFactor.w*mix3*pwfValue3;
            #if vtkLightComplexity > 0
              applyLighting(tColor3, normalMat[3]);
            #endif
          #else
            tColor3 *= pwfValue3;
            alpha *= mix(pwfValue3, 1.0, (1.0 - mix3));
          #endif
        #endif
      #endif

      // perform final independent blend
      vec3 tColor = mix0 * tColor0;
      #if vtkNumComponents > 1
        tColor += mix1 * tColor1;
        #if vtkNumComponents > 2
          tColor += mix2 * tColor2;
          #if vtkNumComponents > 3
            tColor += mix3 * tColor3;
          #endif
        #endif
      #endif

      return vec4(tColor, alpha);
    #else
      /*
       * Mix the color information from all the independent components to get a single rgba output
       * Gradient opactity factors and normals are not computed
       *
       * You can compute these using:
       * - computeMat4Normal: always available, compute normal only for non proportional components, used by default independent component mix
       * - computeDensityNormal & computeNormalForDensity: available if ((LightComplexity > 0) || GradientOpacityOn) && ComputeNormalFromOpacity),
       *                                                   used by dependent component color mix, see code for Additive preset in OpenGl/VolumeMapper
       * - computeGradientOpacityFactor: always available, used in a lot of places
       *
       * Using applyAllLightning() is advised for shading but some features don't work well with it (volume shadows, LAO)
       * mix0, mix1, ... are defined for each component that is used and correspond to the componentWeight
       */
      //VTK::CustomComponentsColorMix::Impl
    #endif
  #else
    // dependent components

    // compute normal if needed
    #if (vtkLightComplexity > 0) || defined(vtkGradientOpacityOn)
      // use component 3 of the opacity texture as getTextureValue() sets alpha to the opacity value
      #ifdef vtkComputeNormalFromOpacity
        vec3 scalarInterp[2];
        vec4 normal0 = computeNormalForDensity(posIS, tstep, scalarInterp, 3);
      #else
        vec4 normal0 = computeNormal(posIS, tstep);
      #endif
    #endif

    // compute gradient opacity factor enabled
    #if defined(vtkGradientOpacityOn)
      float gradientOpacity = computeGradientOpacityFactor(normal0.a, goscale0, goshift0, gomin0, gomax0);
    #else
      const float gradientOpacity = 1.0;
    #endif

    // get color and opacity
    #if vtkNumComponents == 1
      vec3 tColor = texture2D(ctexture, vec2(tValue.r * cscale0 + cshift0, 0.5)).rgb;
      float alpha = gradientOpacity*texture2D(otexture, vec2(tValue.r * oscale0 + oshift0, 0.5)).r;
      if (alpha < EPSILON){
        return vec4(0.0);
      }
    #endif
    #if vtkNumComponents == 2
      vec3 tColor = vec3(tValue.r * cscale0 + cshift0);
      float alpha = gradientOpacity*texture2D(otexture, vec2(tValue.a * oscale1 + oshift1, 0.5)).r;
    #endif
    #if vtkNumComponents == 3
      vec3 tColor;
      tColor.r = tValue.r * cscale0 + cshift0;
      tColor.g = tValue.g * cscale1 + cshift1;
      tColor.b = tValue.b * cscale2 + cshift2;
      float alpha = gradientOpacity*texture2D(otexture, vec2(tValue.a * oscale0 + oshift0, 0.5)).r;
    #endif
    #if vtkNumComponents == 4
      vec3 tColor;
      tColor.r = tValue.r * cscale0 + cshift0;
      tColor.g = tValue.g * cscale1 + cshift1;
      tColor.b = tValue.b * cscale2 + cshift2;
      float alpha = gradientOpacity*texture2D(otexture, vec2(tValue.a * oscale3 + oshift3, 0.5)).r;
    #endif

    // lighting
    #if (vtkLightComplexity > 0)
      #ifdef vtkComputeNormalFromOpacity
        vec4 normalLight;
        if (!all(equal(normal0, vec4(0.0)))) {
          scalarInterp[0] = scalarInterp[0] * oscale0 + oshift0;
          scalarInterp[1] = scalarInterp[1] * oscale0 + oshift0;
          normalLight = computeDensityNormal(scalarInterp, 0.5, gradientOpacity);
          if (all(equal(normalLight, vec4(0.0)))) {
            normalLight = normal0;
          }
        }
      #else
        vec4 normalLight = normal0;
      #endif
      tColor = applyAllLightning(tColor, alpha, posIS, normalLight);
    #endif

    return vec4(tColor, alpha);
  #endif // dependent
#endif
}

bool valueWithinScalarRange(vec4 val, vec4 min, vec4 max) {
  bool withinRange = false;
  #if vtkNumComponents == 1
    if (val.r >= min.r && val.r <= max.r) {
      withinRange = true;
    }
  #else
    #ifdef UseIndependentComponents
      #if vtkNumComponents == 2
        if (val.r >= min.r && val.r <= max.r &&
            val.g >= min.g && val.g <= max.g) {
          withinRange = true;
        }
      #else
        if (all(greaterThanEqual(val, ipScalarRangeMin)) &&
            all(lessThanEqual(val, ipScalarRangeMax))) {
          withinRange = true;
        }
      #endif
    #endif
  #endif
  return withinRange;
}

#if vtkBlendMode == 6 
bool checkOnEdgeForNeighbor(int i, int j, int s, vec3 stepIS) {
    vec4 neighborPixelCoord = vec4(gl_FragCoord.x + float(i), gl_FragCoord.y + float(j), gl_FragCoord.z, gl_FragCoord.w);
    vec3 originalNeighborPosIS = fragCoordToIndexSpace(neighborPixelCoord);

    bool justSawIt = false;

    vec3 neighborPosIS = originalNeighborPosIS;

    float stepsTraveled = 0.0;


    // float neighborValue;
    for (int k = 0; k < //VTK::MaximumSamplesValue /2 ; ++k) {
        ivec3 texCoord = ivec3(neighborPosIS * vec3(volumeDimensions));
        vec4 texValue = texelFetch(texture1, texCoord, 0);

        if (int(texValue.g) == s) {
            justSawIt = true;
            break;
        }
        neighborPosIS += stepIS;
    }

    if (justSawIt){
      return false;
    }

   
    neighborPosIS = originalNeighborPosIS;
    for (int k = 0; k < //VTK::MaximumSamplesValue /2 ; ++k) {
        ivec3 texCoord = ivec3(neighborPosIS * vec3(volumeDimensions));
        vec4 texValue = texelFetch(texture1, texCoord, 0);

        if (int(texValue.g) == s) {
            justSawIt = true;
            break;
        }
        neighborPosIS -= stepIS;
    }


    if (!justSawIt) {
        // onedge
        vec3 tColorSegment = texture2D(ctexture, vec2(float(s) * cscale1 + cshift1, height1)).rgb;
        float pwfValueSegment = texture2D(otexture, vec2(float(s) * oscale1 + oshift1, height1)).r;
        gl_FragData[0] = vec4(tColorSegment, pwfValueSegment);
        return true;
    }

    // not on edge
    return false;
}

#endif


//=======================================================================
// Apply the specified blend mode operation along the ray's path.
//
void applyBlend(vec3 posIS, vec3 endIS, vec3 tdims)
{
  vec3 tstep = 1.0/tdims;

  // start slightly inside and apply some jitter
  vec3 delta = endIS - posIS;
  vec3 stepIS = normalize(delta)*sampleDistanceIS;
  float raySteps = length(delta)/sampleDistanceIS;

  // Initialize arrays to false
  // avoid 0.0 jitter
  float jitter = 0.01 + 0.99*texture2D(jtexture, gl_FragCoord.xy/32.0).r;
  float stepsTraveled = jitter;

  // local vars for the loop
  vec4 color = vec4(0.0, 0.0, 0.0, 0.0);
  vec4 tValue;
  vec4 tColor;

  // if we have less than one step then pick the middle point
  // as our value
  // if (raySteps <= 1.0)
  // {
  //   posIS = (posIS + endIS)*0.5;
  // }

  // Perform initial step at the volume boundary
  // compute the scalar
  tValue = getTextureValue(posIS);
  
  #if vtkBlendMode == 6 
    if (raySteps <= 1.0)
    {
      gl_FragData[0] = getColorForValue(tValue, posIS, tstep);
      return;
    }

    vec4 value = tValue;
    posIS += (jitter*stepIS);
    vec3 maxPosIS = posIS; // Store the position of the max value
    int segmentIndex = int(value.g);
    bool originalPosHasSeenNonZero = false;

    uint bitmask = 0u;

    if (segmentIndex != 0) {
      // Tried using the segment index in an boolean array but reading 
      // from the array by dynamic indexing was horrondously slow
      // so use bit masking instead and assign 1 to the bit corresponding to the segment index
      // and later check if the bit is set via bit operations
      setBit(segmentIndex);
    }
    
    // Sample along the ray until MaximumSamplesValue,
    // ending slightly inside the total distance
    for (int i = 0; i < //VTK::MaximumSamplesValue ; ++i)
    {
      // If we have reached the last step, break
      if (stepsTraveled + 1.0 >= raySteps) { break; }

      // compute the scalar
      tValue = getTextureValue(posIS);
      segmentIndex = int(tValue.g);

      if (segmentIndex != 0) {
        originalPosHasSeenNonZero = true;
        setBit(segmentIndex);
      }

      if (tValue.r > value.r) {
        value =  tValue; // Update the max value
        maxPosIS = posIS; // Update the position where max occurred
      }

      // Otherwise, continue along the ray
      stepsTraveled++;
      posIS += stepIS;
    }

    // Perform the last step along the ray using the
    // residual distance
    posIS = endIS;
    tValue = getTextureValue(posIS);

    if (tValue.r > value.r) {
      value = tValue; // Update the max value
      maxPosIS = posIS; // Update the position where max occurred
    }  

    // If we have not seen any non-zero segments, we can return early
    // and grab color from the actual center value first component (image)
    if (!originalPosHasSeenNonZero) {
      gl_FragData[0] = getColorForValue(value, maxPosIS, tstep);
      return;
    }

    // probably we can make this configurable but for now we will use the same
    // sample distance as the original sample distance
    float neighborSampleDistanceIS = sampleDistanceIS;

    vec3 neighborRayStepsIS = stepIS;
    float neighborRaySteps = raySteps;
    bool shouldLookInAllNeighbors = false;

    float minVoxelSpacing = min(volumeSpacings[0], min(volumeSpacings[1], volumeSpacings[2]));
    vec4 base = vec4(gl_FragCoord.x, gl_FragCoord.y, gl_FragCoord.z, gl_FragCoord.w);

    vec4 baseXPlus = vec4(gl_FragCoord.x + 1.0, gl_FragCoord.y, gl_FragCoord.z, gl_FragCoord.w);
    vec4 baseYPlus = vec4(gl_FragCoord.x, gl_FragCoord.y + 1.0, gl_FragCoord.z, gl_FragCoord.w);

    vec3 baseWorld = fragCoordToWorld(base);
    vec3 baseXPlusWorld = fragCoordToWorld(baseXPlus);
    vec3 baseYPlusWorld = fragCoordToWorld(baseYPlus);

    float XPlusDiff = length(baseXPlusWorld - baseWorld);
    float YPlusDiff = length(baseYPlusWorld - baseWorld);

    float minFragSpacingWorld = min(XPlusDiff, YPlusDiff);

    for (int s = 1; s < MAX_SEGMENT_INDEX; s++) {
      // bail out quickly if the segment index has not 
      // been seen by the center segment
      if (!isBitSet(s)) {
       continue;
      }

      // Use texture sampling for outlineThickness so that we can have 
      // per segment thickness
      float textureCoordinate = float(s - 1) / 1024.0;
      float textureValue = texture2D(ttexture, vec2(textureCoordinate, 0.5)).r;

      int actualThickness = int(textureValue * 255.0);

      // check the extreme points in the neighborhood since there is a better
      // chance of finding the edge there, so that we can bail out 
      // faster if we find the edge
      bool onEdge =
          checkOnEdgeForNeighbor(-actualThickness, -actualThickness, s, stepIS) ||
          checkOnEdgeForNeighbor(actualThickness, actualThickness, s, stepIS) ||
          checkOnEdgeForNeighbor(actualThickness, -actualThickness, s, stepIS) ||
          checkOnEdgeForNeighbor(-actualThickness, +actualThickness, s, stepIS);

      if (onEdge) {
        return;
      }

      // since the next step is computationally expensive, we need to perform
      // some optimizations to avoid it if possible. One of the optimizations
      // is to check the whether the minimum of the voxel spacing is greater than 
      // the 2 * the thickness of the outline segment. If that is the case
      // then we can safely skip the next step since we can be sure that the
      // the previous 4 checks on the extreme points would caught the entirety 
      // of the all the fragments inside. i.e., this happens when we zoom out, 
      if (minVoxelSpacing > (2.0 * float(actualThickness) - 1.0) * minFragSpacingWorld) {
        continue;
      }
      
      // Loop through the rest, skipping the processed extremes and the center
      for (int i = -actualThickness; i <= actualThickness; i++) {
            for (int j = -actualThickness; j <= actualThickness; j++) {
                if (i == 0 && j == 0) continue; // Skip the center
                if (abs(i) == actualThickness && abs(j) == actualThickness) continue; // Skip corners
                if (checkOnEdgeForNeighbor(i, j, s, stepIS )) {
                    return;
                }
          }
      }
    }

    vec3 tColor0 = texture2D(ctexture, vec2(value.r * cscale0 + cshift0, height0)).rgb;
    float pwfValue0 = texture2D(otexture, vec2(value.r * oscale0 + oshift0, height0)).r;
    gl_FragData[0] = vec4(tColor0, pwfValue0);
  #endif
  #if vtkBlendMode == 0 // COMPOSITE_BLEND
    // now map through opacity and color
    tColor = getColorForValue(tValue, posIS, tstep);

    // handle very thin volumes
    if (raySteps <= 1.0)
    {
      tColor.a = 1.0 - pow(1.0 - tColor.a, raySteps);
      gl_FragData[0] = tColor;
      return;
    }

    tColor.a = 1.0 - pow(1.0 - tColor.a, jitter);
    color = vec4(tColor.rgb*tColor.a, tColor.a);
    posIS += (jitter*stepIS);

    for (int i = 0; i < //VTK::MaximumSamplesValue ; ++i)
    {
      if (stepsTraveled + 1.0 >= raySteps) { break; }

      // compute the scalar
      tValue = getTextureValue(posIS);

      // now map through opacity and color
      tColor = getColorForValue(tValue, posIS, tstep);

      float mix = (1.0 - color.a);

      // this line should not be needed but nvidia seems to not handle
      // the break correctly on windows/chrome 58 angle
      //mix = mix * sign(max(raySteps - stepsTraveled - 1.0, 0.0));

      color = color + vec4(tColor.rgb*tColor.a, tColor.a)*mix;
      stepsTraveled++;
      posIS += stepIS;
      if (color.a > 0.99) { color.a = 1.0; break; }
    }

    if (color.a < 0.99 && (raySteps - stepsTraveled) > 0.0)
    {
      posIS = endIS;

      // compute the scalar
      tValue = getTextureValue(posIS);

      // now map through opacity and color
      tColor = getColorForValue(tValue, posIS, tstep);
      tColor.a = 1.0 - pow(1.0 - tColor.a, raySteps - stepsTraveled);

      float mix = (1.0 - color.a);
      color = color + vec4(tColor.rgb*tColor.a, tColor.a)*mix;
    }

    gl_FragData[0] = vec4(color.rgb/color.a, color.a);
  #endif
  #if vtkBlendMode == 1 || vtkBlendMode == 2
    // MAXIMUM_INTENSITY_BLEND || MINIMUM_INTENSITY_BLEND
    // Find maximum/minimum intensity along the ray.

    // Define the operation we will use (min or max)
    #if vtkBlendMode == 1
    #define OP max
    #else
    #define OP min
    #endif

    // If the clipping range is shorter than the sample distance
    // we can skip the sampling loop along the ray.
    if (raySteps <= 1.0)
    {
      gl_FragData[0] = getColorForValue(tValue, posIS, tstep);
      return;
    }

    vec4 value = tValue;
    posIS += (jitter*stepIS);

    // Sample along the ray until MaximumSamplesValue,
    // ending slightly inside the total distance
    for (int i = 0; i < //VTK::MaximumSamplesValue ; ++i)
    {
      // If we have reached the last step, break
      if (stepsTraveled + 1.0 >= raySteps) { break; }

      // compute the scalar
      tValue = getTextureValue(posIS);

      // Update the maximum value if necessary
      value = OP(tValue, value);

      // Otherwise, continue along the ray
      stepsTraveled++;
      posIS += stepIS;
    }

    // Perform the last step along the ray using the
    // residual distance
    posIS = endIS;
    tValue = getTextureValue(posIS);
    value = OP(tValue, value);

    // Now map through opacity and color
    gl_FragData[0] = getColorForValue(value, posIS, tstep);
  #endif
  #if vtkBlendMode == 3 || vtkBlendMode == 4 //AVERAGE_INTENSITY_BLEND || ADDITIVE_BLEND
    vec4 sum = vec4(0.);

    if (valueWithinScalarRange(tValue, ipScalarRangeMin, ipScalarRangeMax)) {
      sum += tValue;
    }

    if (raySteps <= 1.0) {
      gl_FragData[0] = getColorForValue(sum, posIS, tstep);
      return;
    }

    posIS += (jitter*stepIS);

    // Sample along the ray until MaximumSamplesValue,
    // ending slightly inside the total distance
    for (int i = 0; i < //VTK::MaximumSamplesValue ; ++i)
    {
      // If we have reached the last step, break
      if (stepsTraveled + 1.0 >= raySteps) { break; }

      // compute the scalar
      tValue = getTextureValue(posIS);

      // One can control the scalar range by setting the AverageIPScalarRange to disregard scalar values, not in the range of interest, from the average computation.
      // Notes:
      // - We are comparing all values in the texture to see if any of them
      //   are outside of the scalar range. In the future we might want to allow
      //   scalar ranges for each component.
      if (valueWithinScalarRange(tValue, ipScalarRangeMin, ipScalarRangeMax)) {
        // Sum the values across each step in the path
        sum += tValue;
      }
      stepsTraveled++;
      posIS += stepIS;
    }

    // Perform the last step along the ray using the
    // residual distance
    posIS = endIS;

    // compute the scalar
    tValue = getTextureValue(posIS);

    // One can control the scalar range by setting the IPScalarRange to disregard scalar values, not in the range of interest, from the average computation
    if (valueWithinScalarRange(tValue, ipScalarRangeMin, ipScalarRangeMax)) {
      sum += tValue;

      stepsTraveled++;
    }

    #if vtkBlendMode == 3 // Average
      sum /= vec4(stepsTraveled, stepsTraveled, stepsTraveled, 1.0);
    #endif

    gl_FragData[0] = getColorForValue(sum, posIS, tstep);
  #endif
  #if vtkBlendMode == 5 // RADON
    float normalizedRayIntensity = 1.0;

    // handle very thin volumes
    if (raySteps <= 1.0)
    {
      tValue = getTextureValue(posIS);
      normalizedRayIntensity = normalizedRayIntensity - sampleDistance*texture2D(otexture, vec2(tValue.r * oscale0 + oshift0, 0.5)).r;
      gl_FragData[0] = texture2D(ctexture, vec2(normalizedRayIntensity, 0.5));
      return;
    }

    posIS += (jitter*stepIS);

    for (int i = 0; i < //VTK::MaximumSamplesValue ; ++i)
    {
      if (stepsTraveled + 1.0 >= raySteps) { break; }

      // compute the scalar value
      tValue = getTextureValue(posIS);

      // Convert scalar value to normalizedRayIntensity coefficient and accumulate normalizedRayIntensity
      normalizedRayIntensity = normalizedRayIntensity - sampleDistance*texture2D(otexture, vec2(tValue.r * oscale0 + oshift0, 0.5)).r;

      posIS += stepIS;
      stepsTraveled++;
    }

    // map normalizedRayIntensity to color
    gl_FragData[0] = texture2D(ctexture, vec2(normalizedRayIntensity , 0.5));

  #endif
}

//=======================================================================
// Compute a new start and end point for a given ray based
// on the provided bounded clipping plane (aka a rectangle)
void getRayPointIntersectionBounds(
  vec3 rayPos, vec3 rayDir,
  vec3 planeDir, float planeDist,
  inout vec2 tbounds, vec3 vPlaneX, vec3 vPlaneY,
  float vSize1, float vSize2)
{
  float result = dot(rayDir, planeDir);
  if (abs(result) < 1e-6)
  {
    return;
  }
  result = -1.0 * (dot(rayPos, planeDir) + planeDist) / result;
  vec3 xposVC = rayPos + rayDir*result;
  vec3 vxpos = xposVC - vOriginVC;
  vec2 vpos = vec2(
    dot(vxpos, vPlaneX),
    dot(vxpos, vPlaneY));

  // on some apple nvidia systems this does not work
  // if (vpos.x < 0.0 || vpos.x > vSize1 ||
  //     vpos.y < 0.0 || vpos.y > vSize2)
  // even just
  // if (vpos.x < 0.0 || vpos.y < 0.0)
  // fails
  // so instead we compute a value that represents in and out
  //and then compute the return using this value
  float xcheck = max(0.0, vpos.x * (vpos.x - vSize1)); //  0 means in bounds
  float check = sign(max(xcheck, vpos.y * (vpos.y - vSize2))); //  0 means in bounds, 1 = out

  tbounds = mix(
   vec2(min(tbounds.x, result), max(tbounds.y, result)), // in value
   tbounds, // out value
   check);  // 0 in 1 out
}

//=======================================================================
// given a
// - ray direction (rayDir)
// - starting point (vertexVCVSOutput)
// - bounding planes of the volume
// - optionally depth buffer values
// - far clipping plane
// compute the start/end distances of the ray we need to cast
vec2 computeRayDistances(vec3 rayDir, vec3 tdims)
{
  vec2 dists = vec2(100.0*camFar, -1.0);

  vec3 vSize = vSpacing*tdims;

  // all this is in View Coordinates
  getRayPointIntersectionBounds(vertexVCVSOutput, rayDir,
    vPlaneNormal0, vPlaneDistance0, dists, vPlaneNormal2, vPlaneNormal4,
    vSize.y, vSize.z);
  getRayPointIntersectionBounds(vertexVCVSOutput, rayDir,
    vPlaneNormal1, vPlaneDistance1, dists, vPlaneNormal2, vPlaneNormal4,
    vSize.y, vSize.z);
  getRayPointIntersectionBounds(vertexVCVSOutput, rayDir,
    vPlaneNormal2, vPlaneDistance2, dists, vPlaneNormal0, vPlaneNormal4,
    vSize.x, vSize.z);
  getRayPointIntersectionBounds(vertexVCVSOutput, rayDir,
    vPlaneNormal3, vPlaneDistance3, dists, vPlaneNormal0, vPlaneNormal4,
    vSize.x, vSize.z);
  getRayPointIntersectionBounds(vertexVCVSOutput, rayDir,
    vPlaneNormal4, vPlaneDistance4, dists, vPlaneNormal0, vPlaneNormal2,
    vSize.x, vSize.y);
  getRayPointIntersectionBounds(vertexVCVSOutput, rayDir,
    vPlaneNormal5, vPlaneDistance5, dists, vPlaneNormal0, vPlaneNormal2,
    vSize.x, vSize.y);

  //VTK::ClipPlane::Impl

  // do not go behind front clipping plane
  dists.x = max(0.0,dists.x);

  // do not go PAST far clipping plane
  float farDist = -camThick/rayDir.z;
  dists.y = min(farDist,dists.y);

  // Do not go past the zbuffer value if set
  // This is used for intermixing opaque geometry
  //VTK::ZBuffer::Impl

  return dists;
}

//=======================================================================
// Compute the index space starting position (pos) and end
// position
//
void computeIndexSpaceValues(out vec3 pos, out vec3 endPos, vec3 rayDir, vec2 dists)
{
  // compute starting and ending values in volume space
  pos = vertexVCVSOutput + dists.x*rayDir;
  pos = pos - vOriginVC;
  // convert to volume basis and origin
  pos = vec3(
    dot(pos, vPlaneNormal0),
    dot(pos, vPlaneNormal2),
    dot(pos, vPlaneNormal4));

  endPos = vertexVCVSOutput + dists.y*rayDir;
  endPos = endPos - vOriginVC;
  endPos = vec3(
    dot(endPos, vPlaneNormal0),
    dot(endPos, vPlaneNormal2),
    dot(endPos, vPlaneNormal4));

  float delta = length(endPos - pos);

  pos *= vVCToIJK;
  endPos *= vVCToIJK;

  float delta2 = length(endPos - pos);
  sampleDistanceIS = sampleDistance*delta2/delta;
  #ifdef VolumeShadowOn
    sampleDistanceISVS = sampleDistanceIS * volumeShadowSamplingDistFactor;
  #endif
}

void main()
{

  if (cameraParallel == 1)
  {
    // Camera is parallel, so the rayDir is just the direction of the camera.
    rayDirVC = vec3(0.0, 0.0, -1.0);
  } else {
    // camera is at 0,0,0 so rayDir for perspective is just the vc coord
    rayDirVC = normalize(vertexVCVSOutput);
  }

  vec3 tdims = vec3(volumeDimensions);

  // compute the start and end points for the ray
  vec2 rayStartEndDistancesVC = computeRayDistances(rayDirVC, tdims);

  // do we need to composite? aka does the ray have any length
  // If not, bail out early
  if (rayStartEndDistancesVC.y <= rayStartEndDistancesVC.x)
  {
    discard;
  }

  // IS = Index Space
  vec3 posIS;
  vec3 endIS;
  computeIndexSpaceValues(posIS, endIS, rayDirVC, rayStartEndDistancesVC);

  // Perform the blending operation along the ray
  applyBlend(posIS, endIS, tdims);
}
`;const{vtkWarningMacro:Awe,vtkErrorMacro:zT}=po;function Pwe(t){switch(t){case db.CUSTOM:return"//VTK::CustomColorMix";case db.ADDITIVE:return`
        // compute normals
        mat4 normalMat = computeMat4Normal(posIS, tValue, tstep);
        #if (vtkLightComplexity > 0) && defined(vtkComputeNormalFromOpacity)
          vec3 scalarInterp0[2];
          vec4 normalLight0 = computeNormalForDensity(posIS, tstep, scalarInterp0, 0);
          scalarInterp0[0] = scalarInterp0[0] * oscale0 + oshift0;
          scalarInterp0[1] = scalarInterp0[1] * oscale0 + oshift0;
          normalLight0 = computeDensityNormal(scalarInterp0, height0, 1.0);

          vec3 scalarInterp1[2];
          vec4 normalLight1 = computeNormalForDensity(posIS, tstep, scalarInterp1, 1);
          scalarInterp1[0] = scalarInterp1[0] * oscale1 + oshift1;
          scalarInterp1[1] = scalarInterp1[1] * oscale1 + oshift1;
          normalLight1 = computeDensityNormal(scalarInterp1, height1, 1.0);
        #else
          vec4 normalLight0 = normalMat[0];
          vec4 normalLight1 = normalMat[1];
        #endif

        // compute opacities
        float opacity0 = pwfValue0;
        float opacity1 = pwfValue1;
        #ifdef vtkGradientOpacityOn
          float gof0 = computeGradientOpacityFactor(normalMat[0].a, goscale0, goshift0, gomin0, gomax0);
          opacity0 *= gof0;
          float gof1 = computeGradientOpacityFactor(normalMat[1].a, goscale1, goshift1, gomin1, gomax1);
          opacity1 *= gof1;
        #endif
        float opacitySum = opacity0 + opacity1;
        if (opacitySum <= 0.0) {
          return vec4(0.0);
        }

        // mix the colors and opacities
        tColor0 = applyAllLightning(tColor0, opacity0, posIS, normalLight0);
        tColor1 = applyAllLightning(tColor1, opacity1, posIS, normalLight1);
        vec3 mixedColor = (opacity0 * tColor0 + opacity1 * tColor1) / opacitySum;
        return vec4(mixedColor, min(1.0, opacitySum));
`;case db.COLORIZE:return`
        // compute normals
        mat4 normalMat = computeMat4Normal(posIS, tValue, tstep);
        #if (vtkLightComplexity > 0) && defined(vtkComputeNormalFromOpacity)
          vec3 scalarInterp0[2];
          vec4 normalLight0 = computeNormalForDensity(posIS, tstep, scalarInterp0, 0);
          scalarInterp0[0] = scalarInterp0[0] * oscale0 + oshift0;
          scalarInterp0[1] = scalarInterp0[1] * oscale0 + oshift0;
          normalLight0 = computeDensityNormal(scalarInterp0, height0, 1.0);
        #else
          vec4 normalLight0 = normalMat[0];
        #endif

        // compute opacities
        float opacity0 = pwfValue0;
        #ifdef vtkGradientOpacityOn
          float gof0 = computeGradientOpacityFactor(normalMat[0].a, goscale0, goshift0, gomin0, gomax0);
          opacity0 *= gof0;
        #endif

        // mix the colors and opacities
        vec3 color = tColor0 * mix(vec3(1.0), tColor1, pwfValue1);
        color = applyAllLightning(color, opacity0, posIS, normalLight0);
        return vec4(color, opacity0);
`;default:return null}}function Nwe(t,e){e.classHierarchy.push("vtkOpenGLVolumeMapper");function n(i){[e._scalars,e._scalarOpacityFunc,e._colorTransferFunc,e._labelOutlineThicknessArray].forEach(a=>i.unregisterGraphicsResourceUser(a,t))}t.buildPass=()=>{e.zBufferTexture=null},t.zBufferPass=(i,a)=>{if(i){const o=a.getZBufferTexture();o!==e.zBufferTexture&&(e.zBufferTexture=o)}},t.opaqueZBufferPass=(i,a)=>t.zBufferPass(i,a),t.volumePass=(i,a)=>{if(i){const o=e._openGLRenderWindow;e._openGLRenderWindow=t.getLastAncestorOfType("vtkOpenGLRenderWindow"),o&&!o.isDeleted()&&o!==e._openGLRenderWindow&&n(o),e.context=e._openGLRenderWindow.getContext(),e.tris.setOpenGLRenderWindow(e._openGLRenderWindow),e.jitterTexture.setOpenGLRenderWindow(e._openGLRenderWindow),e.framebuffer.setOpenGLRenderWindow(e._openGLRenderWindow),e.openGLVolume=t.getFirstAncestorOfType("vtkOpenGLVolume");const s=e.openGLVolume.getRenderable();e._openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer");const l=e._openGLRenderer.getRenderable();e.openGLCamera=e._openGLRenderer.getViewNodeFor(l.getActiveCamera()),t.renderPiece(l,s)}},t.getShaderTemplate=(i,a,o)=>{i.Vertex=Iwe,i.Fragment=Rwe,i.Geometry=""},t.useIndependentComponents=i=>{const a=i.getIndependentComponents(),s=e.currentInput?.getPointData()?.getScalars()?.getNumberOfComponents(),l=i.getColorMixPreset();return a&&s>=2||!!l},t.replaceShaderValues=(i,a,o)=>{const s=o.getProperty();let l=i.Fragment;s.getInterpolationType()===T6.LINEAR&&(l=Be.substitute(l,"//VTK::TrilinearOn","#define vtkTrilinearOn").result),t.isLabelmapOutlineRequired(o)===!0&&(l=Be.substitute(l,"//VTK::ImageLabelOutlineOn","#define vtkImageLabelOutlineOn").result),e.renderable.getBlendMode()===Yx.LABELMAP_EDGE_PROJECTION_BLEND&&(l=Be.substitute(l,"//VTK::LabelEdgeProjectionOn","#define vtkLabelEdgeProjectionOn").result);const d=e.scalarTexture.getComponents();l=Be.substitute(l,"//VTK::NumComponents",`#define vtkNumComponents ${d}`).result;const h=t.useIndependentComponents(s);h&&(l=Be.substitute(l,"//VTK::IndependentComponentsOn","#define UseIndependentComponents").result);const p=[],g=[];for(let _=0;_<d;_++)s.getOpacityMode(_)===oq.PROPORTIONAL&&p.push(`#define vtkComponent${_}Proportional`),s.getForceNearestInterpolation(_)&&g.push(`#define vtkComponent${_}ForceNearest`);l=Be.substitute(l,"//VTK::vtkProportionalComponents",p.join(`
`)).result,l=Be.substitute(l,"//VTK::vtkForceNearestComponents",g.join(`
`)).result;const m=s.getColorMixPreset(),y=Pwe(m);y&&(l=Be.substitute(l,"//VTK::CustomComponentsColorMixOn","#define vtkCustomComponentsColorMix").result,l=Be.substitute(l,"//VTK::CustomComponentsColorMix::Impl",y).result);const v=e.currentInput.getSpatialExtent(),x=e.currentInput.getSpacing(),w=new Float64Array(3);Lr(w,(v[1]-v[0])*x[0],(v[3]-v[2])*x[1],(v[5]-v[4])*x[2]);const S=jg(w)/t.getCurrentSampleDistance(a);l=Be.substitute(l,"//VTK::MaximumSamplesValue",`${Math.ceil(S)}`).result,l=Be.substitute(l,"//VTK::LightComplexity",`#define vtkLightComplexity ${e.lightComplexity}`).result,e.lightComplexity>0&&(e.renderable.getVolumetricScatteringBlending()>0&&(l=Be.substitute(l,"//VTK::VolumeShadowOn","#define VolumeShadowOn").result),e.renderable.getVolumetricScatteringBlending()<1&&(l=Be.substitute(l,"//VTK::SurfaceShadowOn","#define SurfaceShadowOn").result),e.renderable.getLocalAmbientOcclusion()&&s.getAmbient()>0&&(l=Be.substitute(l,"//VTK::localAmbientOcclusionOn","#define localAmbientOcclusionOn").result));const T=h?d:1;e.gopacity=!1;for(let _=0;!e.gopacity&&_<T;++_)e.gopacity||=s.getUseGradientOpacity(_);e.gopacity&&(l=Be.substitute(l,"//VTK::GradientOpacityOn","#define vtkGradientOpacityOn").result),e.renderable.getComputeNormalFromOpacity()&&(l=Be.substitute(l,"//VTK::vtkComputeNormalFromOpacity","#define vtkComputeNormalFromOpacity").result),e.zBufferTexture!==null&&(l=Be.substitute(l,"//VTK::ZBuffer::Dec",["uniform sampler2D zBufferTexture;","uniform float vpZWidth;","uniform float vpZHeight;"]).result,l=Be.substitute(l,"//VTK::ZBuffer::Impl",["vec4 depthVec = texture2D(zBufferTexture, vec2(gl_FragCoord.x / vpZWidth, gl_FragCoord.y/vpZHeight));","float zdepth = (depthVec.r*256.0 + depthVec.g)/257.0;","zdepth = zdepth * 2.0 - 1.0;","if (cameraParallel == 0) {","zdepth = -2.0 * camFar * camNear / (zdepth*(camFar-camNear)-(camFar+camNear)) - camNear;}","else {",`zdepth = (zdepth + 1.0) * 0.5 * (camFar - camNear);}
`,"zdepth = -zdepth/rayDir.z;","dists.y = min(zdepth,dists.y);"]).result),l=Be.substitute(l,"//VTK::BlendMode",`${e.renderable.getBlendMode()}`).result,i.Fragment=l,t.replaceShaderLight(i,a,o),t.replaceShaderClippingPlane(i,a,o)},t.replaceShaderLight=(i,a,o)=>{if(e.lightComplexity===0)return;let s=i.Fragment,l=0;a.getLights().forEach(c=>{c.getSwitch()&&(l+=1)}),s=Be.substitute(s,"//VTK::Light::Dec",["uniform int lightNum;","uniform bool twoSidedLighting;",`uniform vec3 lightColor[${l}];`,`uniform vec3 lightDirectionVC[${l}]; // normalized`,`uniform vec3 lightHalfAngleVC[${l}];`,"//VTK::Light::Dec"],!1).result,e.lightComplexity===3&&(s=Be.substitute(s,"//VTK::Light::Dec",[`uniform vec3 lightPositionVC[${l}];`,`uniform vec3 lightAttenuation[${l}];`,`uniform float lightConeAngle[${l}];`,`uniform float lightExponent[${l}];`,`uniform int lightPositional[${l}];`],!1).result),e.renderable.getVolumetricScatteringBlending()>0&&(s=Be.substitute(s,"//VTK::VolumeShadow::Dec",["uniform float volumetricScatteringBlending;","uniform float giReach;","uniform float volumeShadowSamplingDistFactor;","uniform float anisotropy;","uniform float anisotropy2;"],!1).result),e.renderable.getLocalAmbientOcclusion()&&o.getProperty().getAmbient()>0&&(s=Be.substitute(s,"//VTK::LAO::Dec",["uniform int kernelRadius;",`uniform vec2 kernelSample[${e.renderable.getLAOKernelRadius()}];`,"uniform int kernelSize;"],!1).result),i.Fragment=s},t.replaceShaderClippingPlane=(i,a,o)=>{let s=i.Fragment;if(e.renderable.getClippingPlanes().length>0){const l=e.renderable.getClippingPlanes().length;s=Be.substitute(s,"//VTK::ClipPlane::Dec",["uniform vec3 vClipPlaneNormals[6];","uniform float vClipPlaneDistances[6];","uniform vec3 vClipPlaneOrigins[6];","uniform int clip_numPlanes;","//VTK::ClipPlane::Dec","#define vtkClippingPlanesOn"],!1).result,s=Be.substitute(s,"//VTK::ClipPlane::Impl",[`for(int i = 0; i < ${l}; i++) {`,"  float rayDirRatio = dot(rayDir, vClipPlaneNormals[i]);","  float equationResult = dot(vertexVCVSOutput, vClipPlaneNormals[i]) + vClipPlaneDistances[i];","  if (rayDirRatio == 0.0)","  {","    if (equationResult < 0.0) dists.x = dists.y;","    continue;","  }","  float result = -1.0 * equationResult / rayDirRatio;","  if (rayDirRatio < 0.0) dists.y = min(dists.y, result);","  else dists.x = max(dists.x, result);","}","//VTK::ClipPlane::Impl"],!1).result}i.Fragment=s};const r=(i,a)=>{let o=0;i.getProperty().getShade()&&e.renderable.getBlendMode()===Yx.COMPOSITE_BLEND&&(o=0,e.numberOfLights=0,a.forEach(s=>{s.getSwitch()>0&&(e.numberOfLights++,o===0&&(o=1)),o===1&&(e.numberOfLights>1||s.getIntensity()!==1||!s.lightTypeIsHeadLight())&&(o=2),o<3&&s.getPositional()&&(o=3)})),o!==e.lightComplexity&&(e.lightComplexity=o,t.modified())};t.getNeedToRebuildShaders=(i,a,o)=>{const s=o.getProperty();r(o,a.getLights());const l=e.scalarTexture.getComponents(),c=[],f=[];for(let y=0;y<l;y++)c.push(s.getOpacityMode(y)),f.push(s.getForceNearestInterpolation(y));const u=e.currentInput.getSpatialExtent(),d=e.currentInput.getSpacing(),h=new Float64Array(3);Lr(h,(u[1]-u[0])*d[0],(u[3]-u[2])*d[1],(u[5]-u[4])*d[2]);const p=jg(h)/t.getCurrentSampleDistance(a),g=!!e.zBufferTexture,m={iComps:s.getIndependentComponents(),colorMixPreset:s.getColorMixPreset(),interpolationType:s.getInterpolationType(),useLabelOutline:t.isLabelmapOutlineRequired(o),numComp:l,maxSamples:p,useGradientOpacity:s.getUseGradientOpacity(0),blendMode:e.renderable.getBlendMode(),hasZBufferTexture:g,opacityModes:c,forceNearestInterps:f};return i.getProgram()?.getHandle()===0||i.getShaderSourceTime().getMTime()<t.getMTime()||i.getShaderSourceTime().getMTime()<e.renderable.getMTime()||!e.previousState||!w9(e.previousState,m)?(e.previousState=m,!0):!1},t.updateShaders=(i,a,o)=>{if(t.getNeedToRebuildShaders(i,a,o)){const s={Vertex:null,Fragment:null,Geometry:null};t.buildShaders(s,a,o);const l=e._openGLRenderWindow.getShaderCache().readyShaderProgramArray(s.Vertex,s.Fragment,s.Geometry);l!==i.getProgram()&&(i.setProgram(l),i.getVAO().releaseGraphicsResources()),i.getShaderSourceTime().modified()}else e._openGLRenderWindow.getShaderCache().readyShaderProgram(i.getProgram());i.getVAO().bind(),t.setMapperShaderParameters(i,a,o),t.setCameraShaderParameters(i,a,o),t.setPropertyShaderParameters(i,a,o),t.getClippingPlaneShaderParameters(i,a,o)},t.setMapperShaderParameters=(i,a,o)=>{const s=i.getProgram();i.getCABO().getElementCount()&&(e.VBOBuildTime.getMTime()>i.getAttributeUpdateTime().getMTime()||i.getShaderSourceTime().getMTime()>i.getAttributeUpdateTime().getMTime())&&(s.isAttributeUsed("vertexDC")&&(i.getVAO().addAttributeArray(s,i.getCABO(),"vertexDC",i.getCABO().getVertexOffset(),i.getCABO().getStride(),e.context.FLOAT,3,e.context.FALSE)||zT("Error setting vertexDC in shader VAO.")),i.getAttributeUpdateTime().modified()),s.setUniformi("texture1",e.scalarTexture.getTextureUnit()),s.setUniformf("sampleDistance",t.getCurrentSampleDistance(a));const l=e.scalarTexture.getVolumeInfo(),c=e.renderable.getIpScalarRange();if(l?.dataComputedScale?.length){const f=[],u=[];for(let d=0;d<4;d++)f[d]=c[0]*l.dataComputedScale[d]+l.dataComputedOffset[d],u[d]=c[1]*l.dataComputedScale[d]+l.dataComputedOffset[d],f[d]=(f[d]-l.offset[d])/l.scale[d],u[d]=(u[d]-l.offset[d])/l.scale[d];s.setUniform4f("ipScalarRangeMin",f[0],f[1],f[2],f[3]),s.setUniform4f("ipScalarRangeMax",u[0],u[1],u[2],u[3])}if(e.zBufferTexture!==null){s.setUniformi("zBufferTexture",e.zBufferTexture.getTextureUnit());const f=e._useSmallViewport?[e._smallViewportWidth,e._smallViewportHeight]:e._openGLRenderWindow.getFramebufferSize();s.setUniformf("vpZWidth",f[0]),s.setUniformf("vpZHeight",f[1])}},t.setCameraShaderParameters=(i,a,o)=>{const s=e.openGLCamera.getKeyMatrices(a),l=e.openGLVolume.getKeyMatrices();jn(e.modelToView,s.wcvc,l.mcwc);const c=i.getProgram(),f=e.openGLCamera.getRenderable(),u=f.getClippingRange();c.setUniformf("camThick",u[1]-u[0]),c.setUniformf("camNear",u[0]),c.setUniformf("camFar",u[1]);const d=e.currentInput.getBounds(),h=e.currentInput.getDimensions(),p=new Float64Array(3),g=new Float64Array(3);let m=1,y=-1,v=1,x=-1;for(let U=0;U<8;++U){if(Lr(p,d[U%2],d[2+Math.floor(U/2)%2],d[4+Math.floor(U/4)]),$n(p,p,e.modelToView),!f.getParallelProjection()){mc(g,p);const G=-u[0]/p[2];sf(p,g,G)}$n(p,p,s.vcpc),m=Math.min(p[0],m),y=Math.max(p[0],y),v=Math.min(p[1],v),x=Math.max(p[1],x)}c.setUniformf("dcxmin",m),c.setUniformf("dcxmax",y),c.setUniformf("dcymin",v),c.setUniformf("dcymax",x),c.isUniformUsed("cameraParallel")&&c.setUniformi("cameraParallel",f.getParallelProjection());const w=e.currentInput.getSpatialExtent(),S=e.currentInput.getSpacing(),T=new Float64Array(3);Lr(T,(w[1]-w[0])*S[0],(w[3]-w[2])*S[1],(w[5]-w[4])*S[2]),c.setUniform3f("vSpacing",S[0],S[1],S[2]),Lr(p,w[0],w[2],w[4]),e.currentInput.indexToWorldVec3(p,p),$n(p,p,e.modelToView),c.setUniform3f("vOriginVC",p[0],p[1],p[2]);const _=e.currentInput.getIndexToWorld();jn(e.idxToView,e.modelToView,_),um(e.idxNormalMatrix,s.normalMatrix,l.normalMatrix),um(e.idxNormalMatrix,e.idxNormalMatrix,e.currentInput.getDirectionByReference());const D=jg(T)/t.getCurrentSampleDistance(a);D>e.renderable.getMaximumSamplesPerRay()&&Awe(`The number of steps required ${Math.ceil(D)} is larger than the
        specified maximum number of steps ${e.renderable.getMaximumSamplesPerRay()}.
        Please either change the
        volumeMapper sampleDistance or its maximum number of samples.`);const I=new Float64Array(3);if(Lr(I,1,1,1),m5e(I,I,T),c.setUniform3f("vVCToIJK",I[0],I[1],I[2]),c.setUniform3i("volumeDimensions",h[0],h[1],h[2]),c.setUniform3f("volumeSpacings",S[0],S[1],S[2]),!e._openGLRenderWindow.getWebgl2()){const U=e.scalarTexture.getVolumeInfo();c.setUniformf("texWidth",e.scalarTexture.getWidth()),c.setUniformf("texHeight",e.scalarTexture.getHeight()),c.setUniformi("xreps",U.xreps),c.setUniformi("xstride",U.xstride),c.setUniformi("ystride",U.ystride)}const R=new Float64Array(3),M=new Float64Array(3);for(let U=0;U<6;++U){switch(U){case 1:Lr(R,-1,0,0),Lr(M,w[0],w[2],w[4]);break;case 2:Lr(R,0,1,0),Lr(M,w[1],w[3],w[5]);break;case 3:Lr(R,0,-1,0),Lr(M,w[0],w[2],w[4]);break;case 4:Lr(R,0,0,1),Lr(M,w[1],w[3],w[5]);break;case 5:Lr(R,0,0,-1),Lr(M,w[0],w[2],w[4]);break;case 0:default:Lr(R,1,0,0),Lr(M,w[1],w[3],w[5]);break}ub(R,R,e.idxNormalMatrix),$n(M,M,e.idxToView);const G=-1*b2(M,R);c.setUniform3f(`vPlaneNormal${U}`,R[0],R[1],R[2]),c.setUniformf(`vPlaneDistance${U}`,G)}if(t.isLabelmapOutlineRequired(o)){const G=e.currentInput.getWorldToIndex();c.setUniformMatrix("vWCtoIDX",G);const F=a.getActiveCamera(),[$,V]=F.getClippingRange(),X=F.getDistance();F.setClippingRange(X,X+.1);const Q=e.openGLCamera.getKeyMatrices(a);ba(e.projectionToWorld,Q.wcpc),F.setClippingRange($,V),e.openGLCamera.getKeyMatrices(a),c.setUniformMatrix("PCWCMatrix",e.projectionToWorld);const re=t.getRenderTargetSize();c.setUniformf("vpWidth",re[0]),c.setUniformf("vpHeight",re[1]);const ye=t.getRenderTargetOffset();c.setUniformf("vpOffsetX",ye[0]/re[0]),c.setUniformf("vpOffsetY",ye[1]/re[1])}if(ba(e.projectionToView,s.vcpc),c.setUniformMatrix("PCVCMatrix",e.projectionToView),e.lightComplexity===0)return;let A=0;const L=[],P=[],B=[];if(a.getLights().forEach(U=>{if(U.getSwitch()>0){const F=U.getColor(),$=U.getIntensity();L[0+A*3]=F[0]*$,L[1+A*3]=F[1]*$,L[2+A*3]=F[2]*$;const V=U.getDirection();Lr(R,V[0],V[1],V[2]),ub(R,R,s.normalMatrix),mc(R,R),P[0+A*3]=R[0],P[1+A*3]=R[1],P[2+A*3]=R[2],B[0+A*3]=-.5*R[0],B[1+A*3]=-.5*R[1],B[2+A*3]=-.5*(R[2]-1),A++}}),c.setUniformi("twoSidedLighting",a.getTwoSidedLighting()),c.setUniformi("lightNum",A),c.setUniform3fv("lightColor",L),c.setUniform3fv("lightDirectionVC",P),c.setUniform3fv("lightHalfAngleVC",B),e.lightComplexity===3){A=0;const U=[],G=[],F=[],$=[],V=[];a.getLights().forEach(X=>{if(X.getSwitch()>0){const re=X.getAttenuationValues();G[0+A*3]=re[0],G[1+A*3]=re[1],G[2+A*3]=re[2],$[A]=X.getExponent(),F[A]=X.getConeAngle(),V[A]=X.getPositional();const ye=X.getTransformedPosition();$n(ye,ye,e.modelToView),U[0+A*3]=ye[0],U[1+A*3]=ye[1],U[2+A*3]=ye[2],A+=1}}),c.setUniform3fv("lightPositionVC",U),c.setUniform3fv("lightAttenuation",G),c.setUniformfv("lightConeAngle",F),c.setUniformfv("lightExponent",$),c.setUniformiv("lightPositional",V)}if(e.renderable.getVolumetricScatteringBlending()>0&&(c.setUniformf("giReach",e.renderable.getGlobalIlluminationReach()),c.setUniformf("volumetricScatteringBlending",e.renderable.getVolumetricScatteringBlending()),c.setUniformf("volumeShadowSamplingDistFactor",e.renderable.getVolumeShadowSamplingDistFactor()),c.setUniformf("anisotropy",e.renderable.getAnisotropy()),c.setUniformf("anisotropy2",e.renderable.getAnisotropy()**2)),e.renderable.getLocalAmbientOcclusion()&&o.getProperty().getAmbient()>0){const U=e.renderable.getLAOKernelSize();c.setUniformi("kernelSize",U);const G=[];for(let F=0;F<U;F++)G[F*2]=Math.random()*.5,G[F*2+1]=Math.random()*.5;c.setUniform2fv("kernelSample",G),c.setUniformi("kernelRadius",e.renderable.getLAOKernelRadius())}},t.setPropertyShaderParameters=(i,a,o)=>{const s=i.getProgram();s.setUniformi("ctexture",e.colorTexture.getTextureUnit()),s.setUniformi("otexture",e.opacityTexture.getTextureUnit()),s.setUniformi("jtexture",e.jitterTexture.getTextureUnit()),s.setUniformi("ttexture",e.labelOutlineThicknessTexture.getTextureUnit());const l=e.scalarTexture.getVolumeInfo(),c=o.getProperty(),f=e.scalarTexture.getComponents(),u=t.useIndependentComponents(c);if(u)for(let h=0;h<f;h++)s.setUniformf(`mix${h}`,o.getProperty().getComponentWeight(h));for(let h=0;h<f;h++){const p=u?h:0,g=l.scale[h],y=c.getScalarOpacity(p).getRange(),v=g/(y[1]-y[0]),x=(l.offset[h]-y[0])/(y[1]-y[0]);s.setUniformf(`oshift${h}`,x),s.setUniformf(`oscale${h}`,v);const S=c.getRGBTransferFunction(p).getRange(),T=(l.offset[h]-S[0])/(S[1]-S[0]),_=g/(S[1]-S[0]);s.setUniformf(`cshift${h}`,T),s.setUniformf(`cscale${h}`,_)}if(e.gopacity)if(u)for(let h=0;h<f;++h){const p=l.scale[h];if(c.getUseGradientOpacity(h)){const m=c.getGradientOpacityMinimumOpacity(h),y=c.getGradientOpacityMaximumOpacity(h);s.setUniformf(`gomin${h}`,m),s.setUniformf(`gomax${h}`,y);const v=[c.getGradientOpacityMinimumValue(h),c.getGradientOpacityMaximumValue(h)];s.setUniformf(`goscale${h}`,p*(y-m)/(v[1]-v[0])),s.setUniformf(`goshift${h}`,-v[0]*(y-m)/(v[1]-v[0])+m)}else s.setUniformf(`gomin${h}`,1),s.setUniformf(`gomax${h}`,1),s.setUniformf(`goscale${h}`,0),s.setUniformf(`goshift${h}`,1)}else{const h=l.scale[f-1],p=c.getGradientOpacityMinimumOpacity(0),g=c.getGradientOpacityMaximumOpacity(0);s.setUniformf("gomin0",p),s.setUniformf("gomax0",g);const m=[c.getGradientOpacityMinimumValue(0),c.getGradientOpacityMaximumValue(0)];s.setUniformf("goscale0",h*(g-p)/(m[1]-m[0])),s.setUniformf("goshift0",-m[0]*(g-p)/(m[1]-m[0])+p)}if(t.isLabelmapOutlineRequired(o)===!0){const h=o.getProperty().getLabelOutlineOpacity();s.setUniformf("outlineOpacity",h)}e.lightComplexity>0&&(s.setUniformf("vAmbient",c.getAmbient()),s.setUniformf("vDiffuse",c.getDiffuse()),s.setUniformf("vSpecular",c.getSpecular()),s.setUniformf("vSpecularPower",c.getSpecularPower()))},t.getClippingPlaneShaderParameters=(i,a,o)=>{if(e.renderable.getClippingPlanes().length>0){const s=e.openGLCamera.getKeyMatrices(a),l=[],c=[],f=[],u=e.renderable.getClippingPlanes(),d=u.length;for(let p=0;p<d;++p){const g=u[p].getNormal(),m=u[p].getOrigin();ub(g,g,s.normalMatrix),$n(m,m,s.wcvc);const y=-1*b2(m,g);l.push(g[0]),l.push(g[1]),l.push(g[2]),c.push(y),f.push(m[0]),f.push(m[1]),f.push(m[2])}const h=i.getProgram();h.setUniform3fv("vClipPlaneNormals",l),h.setUniformfv("vClipPlaneDistances",c),h.setUniform3fv("vClipPlaneOrigins",f),h.setUniformi("clip_numPlanes",d)}},t.delete=Q2(()=>{e._animationRateSubscription&&(e._animationRateSubscription.unsubscribe(),e._animationRateSubscription=null)},()=>{e._openGLRenderWindow&&n(e._openGLRenderWindow)},t.delete),t.getRenderTargetSize=()=>{if(e._useSmallViewport)return[e._smallViewportWidth,e._smallViewportHeight];const{usize:i,vsize:a}=e._openGLRenderer.getTiledSizeAndOrigin();return[i,a]},t.getRenderTargetOffset=()=>{const{lowerLeftU:i,lowerLeftV:a}=e._openGLRenderer.getTiledSizeAndOrigin();return[i,a]},t.getCurrentSampleDistance=i=>{const a=i.getVTKWindow().getInteractor(),o=e.renderable.getSampleDistance();if(a.isAnimating()){const s=e.renderable.getInteractionSampleDistanceFactor();return o*s}return o},t.renderPieceStart=(i,a)=>{const o=i.getVTKWindow().getInteractor();if(e._lastScale||(e._lastScale=e.renderable.getInitialInteractionScale()),e._useSmallViewport=!1,o.isAnimating()&&e._lastScale>1.5&&(e._useSmallViewport=!0),e._animationRateSubscription||(e._animationRateSubscription=o.onAnimationFrameRateUpdate(()=>{if(e.renderable.getAutoAdjustSampleDistances()){const l=o.getRecentAnimationFrameRate(),c=o.getDesiredUpdateRate()/l;(c>1.15||c<.85)&&(e._lastScale*=c),e._lastScale>400&&(e._lastScale=400),e._lastScale<1.5&&(e._lastScale=1.5)}else e._lastScale=e.renderable.getImageSampleDistance()*e.renderable.getImageSampleDistance()})),e._useSmallViewport){const l=e._openGLRenderWindow.getFramebufferSize(),c=1/Math.sqrt(e._lastScale);if(e._smallViewportWidth=Math.ceil(c*l[0]),e._smallViewportHeight=Math.ceil(c*l[1]),e._smallViewportHeight>l[1]&&(e._smallViewportHeight=l[1]),e._smallViewportWidth>l[0]&&(e._smallViewportWidth=l[0]),e.framebuffer.saveCurrentBindingsAndBuffers(),e.framebuffer.getGLFramebuffer()===null)e.framebuffer.create(l[0],l[1]),e.framebuffer.populateFramebuffer();else{const u=e.framebuffer.getSize();(!u||u[0]!==l[0]||u[1]!==l[1])&&(e.framebuffer.create(l[0],l[1]),e.framebuffer.populateFramebuffer())}e.framebuffer.bind();const f=e.context;f.clearColor(0,0,0,0),f.colorMask(!0,!0,!0,!0),f.clear(f.COLOR_BUFFER_BIT),f.viewport(0,0,e._smallViewportWidth,e._smallViewportHeight),e.fvp=[e._smallViewportWidth/l[0],e._smallViewportHeight/l[1]]}e.context.disable(e.context.DEPTH_TEST),t.updateBufferObjects(i,a),a.getProperty().getInterpolationType()===T6.NEAREST?(e.scalarTexture.setMinificationFilter(on.NEAREST),e.scalarTexture.setMagnificationFilter(on.NEAREST)):(e.scalarTexture.setMinificationFilter(on.LINEAR),e.scalarTexture.setMagnificationFilter(on.LINEAR)),e.zBufferTexture!==null&&e.zBufferTexture.activate()},t.renderPieceDraw=(i,a)=>{const o=e.context;e.scalarTexture.activate(),e.opacityTexture.activate(),e.labelOutlineThicknessTexture.activate(),e.colorTexture.activate(),e.jitterTexture.activate(),t.updateShaders(e.tris,i,a),o.drawArrays(o.TRIANGLES,0,e.tris.getCABO().getElementCount()),e.tris.getVAO().release(),e.scalarTexture.deactivate(),e.colorTexture.deactivate(),e.opacityTexture.deactivate(),e.labelOutlineThicknessTexture.deactivate(),e.jitterTexture.deactivate()},t.renderPieceFinish=(i,a)=>{if(e.zBufferTexture!==null&&e.zBufferTexture.deactivate(),e._useSmallViewport){if(e.framebuffer.restorePreviousBindingsAndBuffers(),e.copyShader===null){e.copyShader=e._openGLRenderWindow.getShaderCache().readyShaderProgramArray(["//VTK::System::Dec","attribute vec4 vertexDC;","uniform vec2 tfactor;","varying vec2 tcoord;","void main() { tcoord = vec2(vertexDC.x*0.5 + 0.5, vertexDC.y*0.5 + 0.5) * tfactor; gl_Position = vertexDC; }"].join(`
`),["//VTK::System::Dec","//VTK::Output::Dec","uniform sampler2D texture1;","varying vec2 tcoord;","void main() { gl_FragData[0] = texture2D(texture1,tcoord); }"].join(`
`),"");const c=e.copyShader;e.copyVAO=pD.newInstance(),e.copyVAO.setOpenGLRenderWindow(e._openGLRenderWindow),e.tris.getCABO().bind(),e.copyVAO.addAttributeArray(c,e.tris.getCABO(),"vertexDC",e.tris.getCABO().getVertexOffset(),e.tris.getCABO().getStride(),e.context.FLOAT,3,e.context.FALSE)||zT("Error setting vertexDC in copy shader VAO.")}else e._openGLRenderWindow.getShaderCache().readyShaderProgram(e.copyShader);const o=e._openGLRenderWindow.getFramebufferSize();e.context.viewport(0,0,o[0],o[1]);const s=e.framebuffer.getColorTexture();s.activate(),e.copyShader.setUniformi("texture",s.getTextureUnit()),e.copyShader.setUniform2f("tfactor",e.fvp[0],e.fvp[1]);const l=e.context;l.blendFuncSeparate(l.ONE,l.ONE_MINUS_SRC_ALPHA,l.ONE,l.ONE_MINUS_SRC_ALPHA),e.context.drawArrays(e.context.TRIANGLES,0,e.tris.getCABO().getElementCount()),s.deactivate(),l.blendFuncSeparate(l.SRC_ALPHA,l.ONE_MINUS_SRC_ALPHA,l.ONE,l.ONE_MINUS_SRC_ALPHA)}},t.renderPiece=(i,a)=>{if(t.invokeEvent({type:"StartEvent"}),e.renderable.update(),e.currentInput=e.renderable.getInputData(),t.invokeEvent({type:"EndEvent"}),!e.currentInput){zT("No input!");return}t.renderPieceStart(i,a),t.renderPieceDraw(i,a),t.renderPieceFinish(i,a)},t.computeBounds=(i,a)=>{if(!t.getInput()){Nm(e.Bounds);return}e.bounds=t.getInput().getBounds()},t.updateBufferObjects=(i,a)=>{t.getNeedToRebuildBufferObjects(i,a)&&t.buildBufferObjects(i,a)},t.getNeedToRebuildBufferObjects=(i,a)=>e.VBOBuildTime.getMTime()<t.getMTime()||e.VBOBuildTime.getMTime()<a.getMTime()||e.VBOBuildTime.getMTime()<e.renderable.getMTime()||e.VBOBuildTime.getMTime()<a.getProperty().getMTime()||e.VBOBuildTime.getMTime()<e.currentInput.getMTime()||!e.scalarTexture?.getHandle()||!e.colorTexture?.getHandle()||!e.labelOutlineThicknessTexture?.getHandle(),t.buildBufferObjects=(i,a)=>{const o=e.currentInput;if(!o)return;const s=o.getPointData()&&o.getPointData().getScalars();if(!s)return;const l=a.getProperty();if(!e.jitterTexture.getHandle()){const _=new Uint8Array(1024);for(let D=0;D<1024;++D)_[D]=255*Math.random();e.jitterTexture.setMinificationFilter(on.LINEAR),e.jitterTexture.setMagnificationFilter(on.LINEAR),e.jitterTexture.create2DFromRaw(32,32,1,Nn.UNSIGNED_CHAR,_)}const c=s.getNumberOfComponents(),f=t.useIndependentComponents(l),u=f?c:1,d=l.getScalarOpacity(),h=e._openGLRenderWindow.getGraphicsResourceForObject(d);let p=vu(d,f,u);if(!h?.oglObject||h.hash!==p){e.opacityTexture=ti.newInstance(),e.opacityTexture.setOpenGLRenderWindow(e._openGLRenderWindow);const _=1024,D=_*2*u,I=new Float32Array(D),R=new Float32Array(_);for(let M=0;M<u;++M){const A=l.getScalarOpacity(M),L=t.getCurrentSampleDistance(i)/l.getScalarOpacityUnitDistance(M),P=A.getRange();A.getTable(P[0],P[1],_,R,1);for(let B=0;B<_;++B)I[M*_*2+B]=1-(1-R[B])**L,I[M*_*2+B+_]=I[M*_*2+B]}if(e.opacityTexture.resetFormatAndType(),e.opacityTexture.setMinificationFilter(on.LINEAR),e.opacityTexture.setMagnificationFilter(on.LINEAR),e._openGLRenderWindow.getWebgl2()||e.context.getExtension("OES_texture_float")&&e.context.getExtension("OES_texture_float_linear"))e.opacityTexture.create2DFromRaw(_,2*u,1,Nn.FLOAT,I);else{const M=new Uint8ClampedArray(D);for(let A=0;A<D;++A)M[A]=255*I[A];e.opacityTexture.create2DFromRaw(_,2*u,1,Nn.UNSIGNED_CHAR,M)}d&&(e._openGLRenderWindow.setGraphicsResourceForObject(d,e.opacityTexture,p),d!==e._scalarOpacityFunc&&(e._openGLRenderWindow.registerGraphicsResourceUser(d,t),e._openGLRenderWindow.unregisterGraphicsResourceUser(e._scalarOpacityFunc,t)),e._scalarOpacityFunc=d)}else e.opacityTexture=h.oglObject;const m=l.getRGBTransferFunction();p=vu(m,f,u);const y=e._openGLRenderWindow.getGraphicsResourceForObject(m);if(!y?.oglObject?.getHandle()||y?.hash!==p){e.colorTexture=ti.newInstance(),e.colorTexture.setOpenGLRenderWindow(e._openGLRenderWindow);const _=1024,D=_*2*u*3,I=new Uint8ClampedArray(D),R=new Float32Array(_*3);for(let M=0;M<u;++M){const A=l.getRGBTransferFunction(M),L=A.getRange();A.getTable(L[0],L[1],_,R,1);for(let P=0;P<_*3;++P)I[M*_*6+P]=255*R[P],I[M*_*6+P+_*3]=255*R[P]}e.colorTexture.resetFormatAndType(),e.colorTexture.setMinificationFilter(on.LINEAR),e.colorTexture.setMagnificationFilter(on.LINEAR),e.colorTexture.create2DFromRaw(_,2*u,3,Nn.UNSIGNED_CHAR,I),m&&(e._openGLRenderWindow.setGraphicsResourceForObject(m,e.colorTexture,p),m!==e._colorTransferFunc&&(e._openGLRenderWindow.registerGraphicsResourceUser(m,t),e._openGLRenderWindow.unregisterGraphicsResourceUser(e._colorTransferFunc,t)),e._colorTransferFunc=m)}else e.colorTexture=y.oglObject;t.updateLabelOutlineThicknessTexture(a);const x=e._openGLRenderWindow.getGraphicsResourceForObject(s);p=mD(o,s);const w=!x?.oglObject?.getHandle()||x?.hash!==p,S=e.renderable.getUpdatedExtents(),T=!!S.length;if(w&&!T){e.scalarTexture=ti.newInstance(),e.scalarTexture.setOpenGLRenderWindow(e._openGLRenderWindow);const _=o.getDimensions();e.scalarTexture.setOglNorm16Ext(e.context.getExtension("EXT_texture_norm16")),e.scalarTexture.resetFormatAndType(),e.scalarTexture.create3DFilterableFromDataArray(_[0],_[1],_[2],s),s&&(e._openGLRenderWindow.setGraphicsResourceForObject(s,e.scalarTexture,p),s!==e._scalars&&(e._openGLRenderWindow.registerGraphicsResourceUser(s,t),e._openGLRenderWindow.unregisterGraphicsResourceUser(e._scalars,t)),e._scalars=s)}else e.scalarTexture=x.oglObject;if(T){e.renderable.setUpdatedExtents([]);const _=o.getDimensions();e.scalarTexture.create3DFilterableFromDataArray(_[0],_[1],_[2],s,!1,S)}if(!e.tris.getCABO().getElementCount()){const _=new Float32Array(12);for(let M=0;M<4;M++)_[M*3]=M%2*2-1,_[M*3+1]=M>1?1:-1,_[M*3+2]=-1;const D=new Uint16Array(8);D[0]=3,D[1]=0,D[2]=1,D[3]=3,D[4]=3,D[5]=0,D[6]=3,D[7]=2;const I=nn.newInstance({numberOfComponents:3,values:_});I.setName("points");const R=nn.newInstance({numberOfComponents:1,values:D});e.tris.getCABO().createVBO(R,"polys",so.SURFACE,{points:I,cellOffset:0})}e.VBOBuildTime.modified()},t.updateLabelOutlineThicknessTexture=i=>{const a=i.getProperty().getLabelOutlineThickness(),o=e._openGLRenderWindow.getGraphicsResourceForObject(a),s=`${a.join("-")}`;if(!o?.oglObject?.getHandle()||o?.hash!==s){e.labelOutlineThicknessTexture=ti.newInstance(),e.labelOutlineThicknessTexture.setOpenGLRenderWindow(e._openGLRenderWindow);const c=1024,f=1,u=c*f,d=new Uint8Array(u);for(let h=0;h<c;++h){const p=typeof a[h]<"u"?a[h]:a[0];d[h]=p}e.labelOutlineThicknessTexture.resetFormatAndType(),e.labelOutlineThicknessTexture.setMinificationFilter(on.NEAREST),e.labelOutlineThicknessTexture.setMagnificationFilter(on.NEAREST),e.labelOutlineThicknessTexture.create2DFromRaw(c,f,1,Nn.UNSIGNED_CHAR,d),a&&(e._openGLRenderWindow.setGraphicsResourceForObject(a,e.labelOutlineThicknessTexture,s),a!==e._labelOutlineThicknessArray&&(e._openGLRenderWindow.registerGraphicsResourceUser(a,t),e._openGLRenderWindow.unregisterGraphicsResourceUser(e._labelOutlineThicknessArray,t)),e._labelOutlineThicknessArray=a)}else e.labelOutlineThicknessTexture=o.oglObject},t.isLabelmapOutlineRequired=i=>{const a=i.getProperty(),o=e.renderable;return a.getUseLabelOutline()||o.getBlendMode()===Yx.LABELMAP_EDGE_PROJECTION_BLEND}}const Lwe={context:null,VBOBuildTime:null,scalarTexture:null,opacityTexture:null,opacityTextureString:null,colorTexture:null,colorTextureString:null,jitterTexture:null,labelOutlineThicknessTexture:null,labelOutlineThicknessTextureString:null,tris:null,framebuffer:null,copyShader:null,copyVAO:null,lastXYF:1,targetXYF:1,zBufferTexture:null,lastZBufferTexture:null,lightComplexity:0,fullViewportTime:1,idxToView:null,idxNormalMatrix:null,modelToView:null,projectionToView:null,avgWindowArea:0,avgFrameTime:0};function iX(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Lwe,n),Rr.extend(t,e,n),mu.implementBuildShadersWithReplacements(t,e,n),e.VBOBuildTime={},$r(e.VBOBuildTime,{mtime:0}),e.tris=Tu.newInstance(),e.jitterTexture=ti.newInstance(),e.jitterTexture.setWrapS(w2.REPEAT),e.jitterTexture.setWrapT(w2.REPEAT),e.framebuffer=Jw.newInstance(),e.idxToView=sn(new Float64Array(16)),e.idxNormalMatrix=Ll(new Float64Array(9)),e.modelToView=sn(new Float64Array(16)),e.projectionToView=sn(new Float64Array(16)),e.projectionToWorld=sn(new Float64Array(16)),Mi(t,e,["context"]),Nwe(t,e)}const aX=Zn(iX,"vtkOpenGLVolumeMapper");var oX={newInstance:aX,extend:iX};sa("vtkVolumeMapper",aX);const{vtkDebugMacro:kwe}=po;function Vwe(t,e){e.classHierarchy.push("vtkOpenGLPixelSpaceCallbackMapper"),t.opaquePass=(n,r)=>{e._openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e._openGLRenderWindow=e._openGLRenderer.getLastAncestorOfType("vtkOpenGLRenderWindow");const i=e._openGLRenderer.getAspectRatio(),a=e._openGLRenderer?e._openGLRenderer.getRenderable().getActiveCamera():null,o=e._openGLRenderer.getTiledSizeAndOrigin();let s=null;if(e.renderable.getUseZValues()){const l=r.getZBufferTexture(),c=Math.floor(l.getWidth()),f=Math.floor(l.getHeight()),u=e._openGLRenderWindow.getContext();l.bind();const d=r.getFramebuffer();d?d.saveCurrentBindingsAndBuffers():kwe("No framebuffer to save/restore");const h=u.createFramebuffer();u.bindFramebuffer(u.FRAMEBUFFER,h),u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,l.getHandle(),0),u.checkFramebufferStatus(u.FRAMEBUFFER)===u.FRAMEBUFFER_COMPLETE&&(s=new Uint8Array(c*f*4),u.viewport(0,0,c,f),u.readPixels(0,0,c,f,u.RGBA,u.UNSIGNED_BYTE,s)),d&&d.restorePreviousBindingsAndBuffers(),u.deleteFramebuffer(h)}e.renderable.invokeCallback(e.renderable.getInputData(),a,i,o,s)},t.queryPass=(n,r)=>{n&&e.renderable.getUseZValues()&&r.requestDepth()}}const Fwe={};function Uwe(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Fwe,n),Rr.extend(t,e,n),Vwe(t,e)}const sX=Zn(Uwe,"vtkOpenGLPixelSpaceCallbackMapper");var Bwe={newInstance:sX};sa("vtkPixelSpaceCallbackMapper",sX);const lX=Object.create(null);function Ul(t,e){lX[t]=e}function $we(t,e){e.classHierarchy.push("vtkWebGPUViewNodeFactory")}const Gwe={};function jwe(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Gwe,n),e.overrides=lX,dD.extend(t,e,n),$we(t,e)}le.newInstance(jwe,"vtkWebGPUViewNodeFactory");function zwe(t,e){e.classHierarchy.push("vtkWebGPUCamera"),t.getProjectionMatrix=(n,r,i,a)=>{if(sn(n),e.renderable.getParallelProjection()){const o=e.renderable.getParallelScale(),s=o*r,l=o,c=(a[0]-1)*s,f=(a[0]+1)*s,u=(a[1]-1)*l,d=(a[1]+1)*l,h=1/(f-c),p=1/(d-u);n[0]=2*h,n[5]=2*p,n[10]=1/(i[1]-i[0]),n[12]=(f+c)*h,n[13]=(d+u)*p,n[14]=i[1]/(i[1]-i[0])}else{const o=Math.tan(Math.PI*e.renderable.getViewAngle()/360);let s,l;e.renderable.getUseHorizontalViewAngle()===!0?(s=i[0]*o,l=i[0]*o/r):(s=i[0]*o*r,l=i[0]*o);const c=(a[0]-1)*s,f=(a[0]+1)*s,u=(a[1]-1)*l,d=(a[1]+1)*l;n[0]=2*i[0]/(f-c),n[5]=2*i[0]/(d-u),n[12]=(c+f)/(f-c),n[13]=(u+d)/(d-u),n[10]=0,n[14]=i[0],n[11]=-1,n[15]=0}},t.convertToOpenGLDepth=n=>{if(e.renderable.getParallelProjection())return 1-n;const r=e.renderable.getClippingRangeByReference();let i=-r[0]/n;return i=(r[0]+r[1])/(r[1]-r[0])+2*r[0]*r[1]/(i*(r[1]-r[0])),.5*i+.5},t.getKeyMatrices=n=>{const r=n.getRenderable(),i=n.getParent();if(Math.max(i.getMTime(),t.getMTime(),r.getMTime(),e.renderable.getMTime(),n.getStabilizedTime())>e.keyMatrixTime.getMTime()){const a=e.renderable.getViewMatrix();Ei(e.keyMatrices.normalMatrix,a),e.keyMatrices.normalMatrix[3]=0,e.keyMatrices.normalMatrix[7]=0,e.keyMatrices.normalMatrix[11]=0,ba(e.keyMatrices.normalMatrix,e.keyMatrices.normalMatrix),Gn(e.keyMatrices.wcvc,a);const o=n.getStabilizedCenterByReference();si(e.keyMatrices.scvc,e.keyMatrices.wcvc,o);const s=n.getAspectRatio(),l=e.renderable.getClippingRangeByReference();t.getProjectionMatrix(e.keyMatrices.vcpc,s,l,e.renderable.getWindowCenterByReference()),jn(e.keyMatrices.scpc,e.keyMatrices.vcpc,e.keyMatrices.scvc),ba(e.keyMatrices.pcsc,e.keyMatrices.scpc),e.keyMatrixTime.modified()}return e.keyMatrices}}const Wwe={keyMatrixTime:null,keyMatrices:null};function Hwe(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Wwe,n),Rr.extend(t,e,n),e.keyMatrixTime={},le.obj(e.keyMatrixTime),e.keyMatrices={normalMatrix:new Float64Array(16),vcpc:new Float64Array(16),pcsc:new Float64Array(16),wcvc:new Float64Array(16),scpc:new Float64Array(16),scvc:new Float64Array(16)},le.setGet(t,e,["keyMatrixTime"]),zwe(t,e)}const Kwe=le.newInstance(Hwe);Ul("vtkCamera",Kwe);function qwe(t,e){e.classHierarchy.push("vtkWebGPUBindGroup"),t.setBindables=n=>{if(e.bindables.length===n.length){let r=!0;for(let i=0;i<e.bindables.length;i++)e.bindables[i]!==n[i]&&(r=!1);if(r)return}e.bindables=n,t.modified()},t.getBindGroupLayout=n=>{const r=[];for(let i=0;i<e.bindables.length;i++){const a=e.bindables[i].getBindGroupLayoutEntry();a.binding=i,r.push(a)}return n.getBindGroupLayout({entries:r})},t.getBindGroup=n=>{let r=t.getMTime();for(let a=0;a<e.bindables.length;a++){const o=e.bindables[a].getBindGroupTime().getMTime();r=o>r?o:r}if(r<e.bindGroupTime.getMTime())return e.bindGroup;const i=[];for(let a=0;a<e.bindables.length;a++){const o=e.bindables[a].getBindGroupEntry();o.binding=a,i.push(o)}return e.bindGroup=n.getHandle().createBindGroup({layout:t.getBindGroupLayout(n),entries:i,label:e.label}),e.bindGroupTime.modified(),e.bindGroup},t.getShaderCode=n=>{const r=[],i=n.getBindGroupLayoutCount(e.label);for(let a=0;a<e.bindables.length;a++)r.push(e.bindables[a].getShaderCode(a,i));return r.join(`
`)}}const Xwe={device:null,handle:null,label:null};function cX(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Xwe,n),le.obj(t,e),e.bindables=[],e.bindGroupTime={},le.obj(e.bindGroupTime,{mtime:0}),le.get(t,e,["bindGroupTime","handle","sizeInBytes","usage"]),le.setGet(t,e,["label","device","arrayInformation"]),qwe(t,e)}const Ywe=le.newInstance(cX);var uX={newInstance:Ywe,extend:cX};function Jwe(t,e){e.classHierarchy.push("vtkWebGPUShaderModule"),t.initialize=(n,r)=>{e.device=n,e.handle=e.device.getHandle().createShaderModule({code:r.getCode()})}}const Zwe={device:null,handle:null};function fX(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Zwe,n),le.obj(t,e),le.get(t,e,["lastCameraMTime"]),le.setGet(t,e,["device","handle"]),Jwe(t,e)}const Qwe=le.newInstance(fX,"vtkWebGPUShaderModule");var eCe={newInstance:Qwe,extend:fX};function tCe(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0;const i=Array.isArray(n)?n.join(`
`):n;let a=!1;t.search(e)!==-1&&(a=!0);let o="";r&&(o="g");const s=new RegExp(e,o),l=t.replace(s,i);return{replace:a,result:l}}function nCe(t,e){e.classHierarchy.push("vtkWebGPUShaderCache"),t.getShaderModule=n=>{const r=n.getType(),i=n.getHash(),a=e._shaderModules.keys();for(let s=0;s<a.length;s++){const l=a[s];if(l.getHash()===i&&l.getType()===r)return e._shaderModules.get(l)}const o=eCe.newInstance();return o.initialize(e.device,n),e._shaderModules.set(n,o),o}}const rCe={shaderModules:null,device:null,window:null};function dX(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,rCe,n),e._shaderModules=new Map,le.obj(t,e),le.setGet(t,e,["device","window"]),nCe(t,e)}const iCe=le.newInstance(dX,"vtkWebGPUShaderCache");var _r={newInstance:iCe,extend:dX,substitute:tCe};function aCe(t,e){e.classHierarchy.push("vtkWebGPUPipeline"),t.getShaderDescriptions=()=>e.shaderDescriptions,t.initialize=(n,r)=>{e.pipelineDescription=e.renderEncoder.getPipelineSettings(),e.pipelineDescription.primitive.topology=e.topology,e.pipelineDescription.vertex=e.vertexState,e.pipelineDescription.label=r;const i=[];for(let a=0;a<e.layouts.length;a++)i.push(e.layouts[a].layout);e.pipelineLayout=n.getHandle().createPipelineLayout({bindGroupLayouts:i}),e.pipelineDescription.layout=e.pipelineLayout;for(let a=0;a<e.shaderDescriptions.length;a++){const o=e.shaderDescriptions[a],s=n.getShaderModule(o);o.getType()==="vertex"&&(e.pipelineDescription.vertex.module=s.getHandle(),e.pipelineDescription.vertex.entryPoint="main"),o.getType()==="fragment"&&(e.pipelineDescription.fragment.module=s.getHandle(),e.pipelineDescription.fragment.entryPoint="main")}e.handle=n.getHandle().createRenderPipeline(e.pipelineDescription)},t.getShaderDescription=n=>{for(let r=0;r<e.shaderDescriptions.length;r++)if(e.shaderDescriptions[r].getType()===n)return e.shaderDescriptions[r];return null},t.addBindGroupLayout=n=>{n&&e.layouts.push({layout:n.getBindGroupLayout(e.device),label:n.getLabel()})},t.getBindGroupLayout=n=>e.layouts[n].layout,t.getBindGroupLayoutCount=n=>{for(let r=0;r<e.layouts.length;r++)if(e.layouts[r].label===n)return r;return 0},t.bindVertexInput=(n,r)=>{r.bindBuffers(n)}}const oCe={handle:null,layouts:null,renderEncoder:null,shaderDescriptions:null,vertexState:null,topology:null,pipelineDescription:null};function hX(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,oCe,n),$r(t,e),e.layouts=[],e.shaderDescriptions=[],Po(t,e,["handle","pipelineDescription"]),Mi(t,e,["device","renderEncoder","topology","vertexState"]),aCe(t,e)}const sCe=Zn(hX,"vtkWebGPUPipeline");var lCe={newInstance:sCe,extend:hX};function cCe(t,e){e.classHierarchy.push("vtkWebGPUShaderDescription"),t.hasOutput=n=>e.outputNames.includes(n),t.addOutput=function(n,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0;e.outputTypes.push(n),e.outputNames.push(r),e.outputInterpolations.push(i)},t.addBuiltinOutput=(n,r)=>{e.builtinOutputTypes.push(n),e.builtinOutputNames.push(r)},t.addBuiltinInput=(n,r)=>{e.builtinInputTypes.push(n),e.builtinInputNames.push(r)},t.replaceShaderCode=(n,r)=>{const i=[];let a=[];if(r&&i.push(r.getShaderCode()),n||e.builtinInputNames.length){const o=[];if(o.push(`struct ${e.type}Input
{`),n){const s=n.getOutputNamesByReference(),l=n.getOutputTypesByReference(),c=n.getOutputInterpolationsByReference();for(let f=0;f<s.length;f++)c[f]!==void 0?o.push(`  @location(${f}) @interpolate(${c[f]}) ${s[f]} : ${l[f]},`):o.push(`  @location(${f}) ${s[f]} : ${l[f]},`)}for(let s=0;s<e.builtinInputNames.length;s++)o.push(`  ${e.builtinInputNames[s]} : ${e.builtinInputTypes[s]},`);o.length>1&&(o.push("};"),a=o,i[i.length-1]+=",",i.push(`input: ${e.type}Input`))}if(i.length&&(e.code=_r.substitute(e.code,"//VTK::IOStructs::Input",i).result),e.outputNames.length+e.builtinOutputNames.length){const o=[`struct ${e.type}Output
{`];for(let s=0;s<e.outputNames.length;s++)e.outputInterpolations[s]!==void 0?o.push(`  @location(${s}) @interpolate(${e.outputInterpolations[s]}) ${e.outputNames[s]} : ${e.outputTypes[s]},`):o.push(`  @location(${s}) ${e.outputNames[s]} : ${e.outputTypes[s]},`);for(let s=0;s<e.builtinOutputNames.length;s++)o.push(`  ${e.builtinOutputNames[s]} : ${e.builtinOutputTypes[s]},`);o.push("};"),a=a.concat(o),e.code=_r.substitute(e.code,"//VTK::IOStructs::Output",[`-> ${e.type}Output`]).result}e.code=_r.substitute(e.code,"//VTK::IOStructs::Dec",a).result}}const uCe={type:null,hash:null,code:null,outputNames:null,outputTypes:null};function pX(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,uCe,n),e.outputNames=[],e.outputTypes=[],e.outputInterpolations=[],e.builtinOutputNames=[],e.builtinOutputTypes=[],e.builtinInputNames=[],e.builtinInputTypes=[],le.obj(t,e),le.setGet(t,e,["type","hash","code"]),le.getArray(t,e,["outputTypes","outputNames","outputInterpolations"]),cCe(t,e)}const fCe=le.newInstance(pX,"vtkWebGPUShaderDescription");var IL={newInstance:fCe,extend:pX};const RL={r8unorm:{numComponents:1,nativeType:Uint8Array,stride:1,elementSize:1,sampleType:"float"},r8snorm:{numComponents:1,nativeType:Int8Array,stride:1,elementSize:1,sampleType:"float"},r8uint:{numComponents:1,nativeType:Uint8Array,stride:1,elementSize:1,sampleType:"uint"},r8sint:{numComponents:1,nativeType:Int8Array,stride:1,elementSize:1,sampleType:"sint"},r16uint:{numComponents:1,nativeType:Uint16Array,stride:2,elementSize:2,sampleType:"uint"},r16sint:{numComponents:1,nativeType:Int16Array,stride:2,elementSize:2,sampleType:"sint"},r16float:{numComponents:1,nativeType:Float32Array,stride:2,elementSize:2,sampleType:"float"},rg8unorm:{numComponents:2,nativeType:Uint8Array,stride:2,elementSize:1,sampleType:"float"},rg8snorm:{numComponents:2,nativeType:Int8Array,stride:2,elementSize:1,sampleType:"float"},rg8uint:{numComponents:2,nativeType:Uint8Array,stride:2,elementSize:1,sampleType:"uint"},rg8sint:{numComponents:2,nativeType:Int8Array,stride:2,elementSize:1,sampleType:"sint"},r32uint:{numComponents:1,nativeType:Uint32Array,stride:4,elementSize:4,sampleType:"uint"},r32sint:{numComponents:1,nativeType:Int32Array,stride:4,elementSize:4,sampleType:"sint"},r32float:{numComponents:1,nativeType:Float32Array,stride:4,elementSize:4,sampleType:"unfilterable-float"},rg16uint:{numComponents:2,nativeType:Uint16Array,stride:4,elementSize:2,sampleType:"uint"},rg16sint:{numComponents:2,nativeType:Int16Array,stride:4,elementSize:2,sampleType:"sint"},rg16float:{numComponents:2,nativeType:Float32Array,stride:4,elementSize:2,sampleType:"float"},rgba8unorm:{numComponents:4,nativeType:Uint8Array,stride:4,elementSize:1,sampleType:"float"},"rgba8unorm-srgb":{numComponents:4,nativeType:Uint8Array,stride:4,elementSize:1,sampleType:"float"},rgba8snorm:{numComponents:4,nativeType:Int8Array,stride:4,elementSize:1,sampleType:"float"},rgba8uint:{numComponents:4,nativeType:Uint8Array,stride:4,elementSize:1,sampleType:"uint"},rgba8sint:{numComponents:4,nativeType:Int8Array,stride:4,elementSize:1,sampleType:"sint"},bgra8unorm:{numComponents:4,nativeType:Uint8Array,stride:4,elementSize:1,sampleType:"float"},"bgra8unorm-srgb":{numComponents:4,nativeType:Uint8Array,stride:4,elementSize:1,sampleType:"float"},rgb9e5ufloat:{numComponents:4,nativeType:Uint32Array,stride:4,sampleType:"float"},rgb10a2unorm:{numComponents:4,nativeType:Uint32Array,stride:4,sampleType:"float"},rg11b10ufloat:{numComponents:4,nativeType:Float32Array,stride:4,sampleType:"float"},rg32uint:{numComponents:2,nativeType:Uint32Array,stride:8,elementSize:4,sampleType:"uint"},rg32sint:{numComponents:2,nativeType:Int32Array,stride:8,elementSize:4,sampleType:"sint"},rg32float:{numComponents:2,nativeType:Float32Array,stride:8,elementSize:4,sampleType:"unfilterable-float"},rgba16uint:{numComponents:4,nativeType:Uint16Array,stride:8,elementSize:2,sampleType:"uint"},rgba16sint:{numComponents:4,nativeType:Int16Array,stride:8,elementSize:2,sampleType:"sint"},rgba16float:{numComponents:4,nativeType:Float32Array,stride:8,elementSize:2,sampleType:"float"},rgba32uint:{numComponents:4,nativeType:Uint32Array,stride:16,elementSize:4,sampleType:"uint"},rgba32sint:{numComponents:4,nativeType:Int32Array,stride:16,elementSize:4,sampleType:"sint"},rgba32float:{numComponents:4,nativeType:Float32Array,stride:16,elementSize:4,sampleType:"unfilterable-float"},stencil8:{numComponents:1,nativeType:Uint8Array,stride:1,elementSize:1,sampleType:"uint"},depth16unorm:{numComponents:1,nativeType:Uint16Array,stride:2,elementSize:2,sampleType:"depth"},depth24plus:{numComponents:1,nativeType:Uint32Array,stride:4,elementSize:3,sampleType:"depth"},"depth24plus-stencil8":{numComponents:2,nativeType:Uint32Array,stride:4,sampleType:"mixed"},depth32float:{numComponents:1,nativeType:Float32Array,stride:4,elementSize:4,sampleType:"depth"}};function dCe(t){return!t||t.length<6?0:t in RL?RL[t]:(Bn(`unknown format ${t}`),null)}function hCe(t){if(!t||t.length<5)return 0;let e=1;t[t.length-2]==="x"&&(e=Number(t[t.length-1]));const n=e===1?t.length-1:t.length-3,r=Number(t[n]);if(Number.isNaN(r))return Bn(`unknown format ${t}`),0;const i=5-r/2;return e*i}function pCe(t){if(!t||t.length<5)return 0;let e=1;return t[t.length-2]==="x"&&(e=Number(t[t.length-1])),e}function gCe(t){if(!t||t.length<5)return 0;let e;if(t[0]==="f")e="Float";else if(t[0]==="s")e="Int";else if(t[0]==="u")e="Uint";else{Bn(`unknown format ${t}`);return}const n=t.split("x")[0],r=Number(n[n.length-1]);if(Number.isNaN(r)){Bn(`unknown format ${t}`);return}return e+=8*(5-r/2),e+="Array",e}function mCe(t){let e;if(t[0]==="f"||t[1]==="n")e="f32";else if(t[0]==="s"&&t[1]==="i")e="i32";else if(t[0]==="u"&&t[1]==="i")e="u32";else{Bn(`unknown format ${t}`);return}let n=1;return t[t.length-2]==="x"&&(n=Number(t[t.length-1])),n===4?`vec4<${e}>`:n===3?`vec3<${e}>`:n===2?`vec2<${e}>`:e}function vCe(t){if(!t)return 0;let e=1;return t.substring(0,3)==="vec"?e=Number(t[3]):t.substring(0,3)==="mat"&&(e=t[3]*t[5]),e*4}function yCe(t){if(t){if(t.includes("f32"))return"Float32Array";if(t.includes("i32"))return"Int32Array";if(t.includes("u32"))return"Uint32Array";Bn(`unknown format ${t}`)}}var ao={getDetailsFromTextureFormat:dCe,getByteStrideFromBufferFormat:hCe,getNumberOfComponentsFromBufferFormat:pCe,getNativeTypeFromBufferFormat:gCe,getShaderTypeFromBufferFormat:mCe,getByteStrideFromShaderFormat:vCe,getNativeTypeFromShaderFormat:yCe};function xCe(t,e){if(t===e)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!e.includes(t[n]))return!1;return!0}function bCe(t,e){e.classHierarchy.push("vtkWebGPUVertexInput"),t.addBuffer=function(n,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"vertex",a=r;Array.isArray(a)||(a=[a]);for(let o=0;o<e.inputs.length;o++)if(xCe(e.inputs[o].names,a)){if(e.inputs[o].buffer===n)return;e.inputs[o].buffer=n;return}e.inputs.push({buffer:n,stepMode:i,names:a}),e.inputs=e.inputs.sort((o,s)=>o.names[0]<s.names[0]?-1:o.names[0]>s.names[0]?1:0)},t.removeBufferIfPresent=n=>{for(let r=0;r<e.inputs.length;r++)e.inputs[r].names.includes(n)&&e.inputs.splice(r,1)},t.getBuffer=n=>{for(let r=0;r<e.inputs.length;r++)if(e.inputs[r].names.includes(n))return e.inputs[r].buffer;return null},t.hasAttribute=n=>{for(let r=0;r<e.inputs.length;r++)if(e.inputs[r].names.includes(n))return!0;return!1},t.getAttributeTime=n=>{for(let r=0;r<e.inputs.length;r++)if(e.inputs[r].names.includes(n))return e.inputs[r].buffer.getSourceTime();return 0},t.getShaderCode=()=>{let n="",r=0;for(let i=0;i<e.inputs.length;i++)for(let a=0;a<e.inputs[i].names.length;a++){const o=e.inputs[i].buffer.getArrayInformation()[a],s=ao.getShaderTypeFromBufferFormat(o.format);r>0&&(n+=`,
`),n=`${n}  @location(${r}) ${e.inputs[i].names[a]} : ${s}`,r++}return n},t.getVertexInputInformation=()=>{const n={};if(e.inputs.length){const r=[];let i=0;for(let a=0;a<e.inputs.length;a++){const o=e.inputs[a].buffer,s={arrayStride:o.getStrideInBytes(),stepMode:e.inputs[a].stepMode,attributes:[]},l=o.getArrayInformation();for(let c=0;c<e.inputs[a].names.length;c++)s.attributes.push({shaderLocation:i,offset:l[c].offset,format:l[c].format}),i++;r.push(s)}n.buffers=r}return n},t.bindBuffers=n=>{for(let r=0;r<e.inputs.length;r++)n.setVertexBuffer(r,e.inputs[r].buffer.getHandle());e.indexBuffer&&n.setIndexBuffer(e.indexBuffer.getHandle(),e.indexBuffer.getArrayInformation()[0].format)},t.getReady=()=>{},t.releaseGraphicsResources=()=>{e.created&&(e.inputs=[],e.bindingDescriptions=[],e.attributeDescriptions=[])}}const wCe={inputs:null,bindingDescriptions:!1,attributeDescriptions:null,indexBuffer:null};function gX(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,wCe,n),$r(t,e),e.bindingDescriptions=[],e.attributeDescriptions=[],e.inputs=[],Mi(t,e,["created","device","handle","indexBuffer"]),bCe(t,e)}const CCe=Zn(gX,"vtkWebGPUVertexInput");var SCe={newInstance:CCe,extend:gX};const TCe=`
//VTK::Renderer::Dec

//VTK::Color::Dec

//VTK::Normal::Dec

//VTK::TCoord::Dec

//VTK::Select::Dec

//VTK::Mapper::Dec

//VTK::IOStructs::Dec

@vertex
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var output : vertexOutput;

  // var vertex: vec4<f32> = vertexBC;

  //VTK::Color::Impl

  //VTK::Normal::Impl

  //VTK::TCoord::Impl

  //VTK::Select::Impl

  //VTK::Position::Impl

  return output;
}
`,ECe=`
//VTK::Renderer::Dec

//VTK::Color::Dec

//VTK::Normal::Dec

//VTK::TCoord::Dec

//VTK::Select::Dec

//VTK::RenderEncoder::Dec

//VTK::Mapper::Dec

//VTK::IOStructs::Dec

@fragment
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var output : fragmentOutput;

  //VTK::Color::Impl

  //VTK::Normal::Impl

  //VTK::Light::Impl

  //VTK::TCoord::Impl

  //VTK::Select::Impl

  // var computedColor:vec4<f32> = vec4<f32>(1.0,0.5,0.5,1.0);

  //VTK::RenderEncoder::Impl
  return output;
}
`;function _Ce(t,e){e.classHierarchy.push("vtkWebGPUSimpleMapper"),t.generateShaderDescriptions=(n,r,i)=>{const a=IL.newInstance({type:"vertex",hash:n,code:e.vertexShaderTemplate}),o=IL.newInstance({type:"fragment",hash:n,code:e.fragmentShaderTemplate}),s=r.getShaderDescriptions();s.push(a),s.push(o);const l=e.vertexShaderTemplate+e.fragmentShaderTemplate,c=new RegExp("//VTK::[^:]*::","g"),u=l.match(c).filter((d,h,p)=>p.indexOf(d)===h).map(d=>`replaceShader${d.substring(7,d.length-2)}`);for(let d=0;d<u.length;d++){const h=u[d];h!=="replaceShaderIOStructs"&&e.shaderReplacements.has(h)&&e.shaderReplacements.get(h)(n,r,i)}t.replaceShaderIOStructs(n,r,i)},t.replaceShaderIOStructs=(n,r,i)=>{const a=r.getShaderDescription("vertex");a.replaceShaderCode(null,i),r.getShaderDescription("fragment").replaceShaderCode(a)},t.replaceShaderRenderEncoder=(n,r,i)=>{e.renderEncoder.replaceShaderCode(r)},e.shaderReplacements.set("replaceShaderRenderEncoder",t.replaceShaderRenderEncoder),t.replaceShaderRenderer=(n,r,i)=>{if(!e.WebGPURenderer)return;const a=e.WebGPURenderer.getBindGroup().getShaderCode(r),o=r.getShaderDescription("vertex");let s=o.getCode();s=_r.substitute(s,"//VTK::Renderer::Dec",[a]).result,o.setCode(s);const l=r.getShaderDescription("fragment");s=l.getCode(),s=_r.substitute(s,"//VTK::Renderer::Dec",[a]).result,l.setCode(s)},e.shaderReplacements.set("replaceShaderRenderer",t.replaceShaderRenderer),t.replaceShaderMapper=(n,r,i)=>{const a=e.bindGroup.getShaderCode(r),o=r.getShaderDescription("vertex");let s=o.getCode();s=_r.substitute(s,"//VTK::Mapper::Dec",[a]).result,o.setCode(s);const l=r.getShaderDescription("fragment");l.addBuiltinInput("bool","@builtin(front_facing) frontFacing"),s=l.getCode(),s=_r.substitute(s,"//VTK::Mapper::Dec",[a]).result,l.setCode(s)},e.shaderReplacements.set("replaceShaderMapper",t.replaceShaderMapper),t.replaceShaderPosition=(n,r,i)=>{const a=r.getShaderDescription("vertex");a.addBuiltinOutput("vec4<f32>","@builtin(position) Position");let o=a.getCode();o=_r.substitute(o,"//VTK::Position::Impl",["    output.Position = rendererUBO.SCPCMatrix*vertexBC;"]).result,a.setCode(o)},e.shaderReplacements.set("replaceShaderPosition",t.replaceShaderPosition),t.replaceShaderTCoord=(n,r,i)=>{r.getShaderDescription("vertex").addOutput("vec2<f32>","tcoordVS")},e.shaderReplacements.set("replaceShaderTCoord",t.replaceShaderTCoord),t.addTextureView=n=>{e.textureViews.includes(n)||e.textureViews.push(n)},t.prepareToDraw=n=>{e.renderEncoder=n,t.updateInput(),t.updateBuffers(),t.updateBindings(),t.updatePipeline()},t.updateInput=()=>{},t.updateBuffers=()=>{},t.updateBindings=()=>{e.bindGroup.setBindables(t.getBindables())},t.computePipelineHash=()=>{},t.registerDrawCallback=n=>{n.registerDrawCallback(e.pipeline,t.draw)},t.prepareAndDraw=n=>{t.prepareToDraw(n),n.setPipeline(e.pipeline),t.draw(n)},t.draw=n=>{const r=n.getBoundPipeline();n.activateBindGroup(e.bindGroup),e.WebGPURenderer&&e.WebGPURenderer.bindUBO(n),r.bindVertexInput(n,e.vertexInput);const i=e.vertexInput.getIndexBuffer();i?n.drawIndexed(i.getIndexCount(),e.numberOfInstances,0,0,0):n.draw(e.numberOfVertices,e.numberOfInstances,0,0)},t.getBindables=()=>{const n=[...e.additionalBindables];e.UBO&&n.push(e.UBO),e.SSBO&&n.push(e.SSBO);for(let r=0;r<e.textureViews.length;r++){n.push(e.textureViews[r]);const i=e.textureViews[r].getSampler();i&&n.push(i)}return n},t.updatePipeline=()=>{t.computePipelineHash(),e.pipeline=e.device.getPipeline(e.pipelineHash),e.pipeline||(e.pipeline=lCe.newInstance(),e.pipeline.setDevice(e.device),e.WebGPURenderer&&e.pipeline.addBindGroupLayout(e.WebGPURenderer.getBindGroup()),e.pipeline.addBindGroupLayout(e.bindGroup),t.generateShaderDescriptions(e.pipelineHash,e.pipeline,e.vertexInput),e.pipeline.setTopology(e.topology),e.pipeline.setRenderEncoder(e.renderEncoder),e.pipeline.setVertexState(e.vertexInput.getVertexInputInformation()),e.device.createPipeline(e.pipelineHash,e.pipeline))}}const DCe={additionalBindables:void 0,bindGroup:null,device:null,fragmentShaderTemplate:null,numberOfInstances:1,numberOfVertices:0,pipelineHash:null,shaderReplacements:null,SSBO:null,textureViews:null,topology:"triangle-list",UBO:null,vertexShaderTemplate:null,WebGPURenderer:null};function mX(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,DCe,n),Rr.extend(t,e,n),e.textureViews=[],e.vertexInput=SCe.newInstance(),e.bindGroup=uX.newInstance({label:"mapperBG"}),e.additionalBindables=[],e.fragmentShaderTemplate=e.fragmentShaderTemplate||ECe,e.vertexShaderTemplate=e.vertexShaderTemplate||TCe,e.shaderReplacements=new Map,le.get(t,e,["pipeline","vertexInput"]),le.setGet(t,e,["additionalBindables","device","fragmentShaderTemplate","interpolate","numberOfInstances","numberOfVertices","pipelineHash","shaderReplacements","SSBO","textureViews","topology","UBO","vertexShaderTemplate","WebGPURenderer"]),_Ce(t,e)}const OCe=le.newInstance(mX,"vtkWebGPUSimpleMapper");var vX={newInstance:OCe,extend:mX};function MCe(t,e){e.classHierarchy.push("vtkWebGPUFullScreenQuad"),t.replaceShaderPosition=(n,r,i)=>{const a=r.getShaderDescription("vertex");a.addBuiltinOutput("vec4<f32>","@builtin(position) Position"),a.addOutput("vec4<f32>","vertexVC");let o=a.getCode();o=_r.substitute(o,"//VTK::Position::Impl",["output.tcoordVS = vec2<f32>(vertexBC.x * 0.5 + 0.5, 1.0 - vertexBC.y * 0.5 - 0.5);","output.Position = vec4<f32>(vertexBC, 1.0);","output.vertexVC = vec4<f32>(vertexBC, 1);"]).result,a.setCode(o)},e.shaderReplacements.set("replaceShaderPosition",t.replaceShaderPosition),t.updateBuffers=()=>{const n=e.device.getBufferManager().getFullScreenQuadBuffer();e.vertexInput.addBuffer(n,["vertexBC"]),e.numberOfVertices=6}}const ICe={};function yX(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,ICe,n),vX.extend(t,e,n),MCe(t,e)}const RCe=le.newInstance(yX,"vtkWebGPUFullScreenQuad");var M6={newInstance:RCe,extend:yX};const ACe={Verts:0,Lines:1,Triangles:2,Strips:3,LinesFromStrips:4,LinesFromTriangles:5,Points:6,UniformArray:7,PointArray:8,NormalsFromPoints:9,Texture:10,RawVertex:11,Storage:12,Index:13},PCe={Start:0,Points:0,Lines:1,Triangles:2,TriangleStrips:3,TriangleEdges:4,TriangleStripEdges:5,End:6};var sy={BufferUsage:ACe,PrimitiveTypes:PCe};const WT=["getMappedRange","mapAsync","unmap"];function NCe(t,e,n,r){const i=r.byteLength,a=t.createBuffer({size:i,usage:GPUBufferUsage.COPY_SRC,mappedAtCreation:!0}),o=a.getMappedRange(0,i);new Uint8Array(o).set(new Uint8Array(r)),a.unmap();const s=t.createCommandEncoder();s.copyBufferToBuffer(a,0,e,n,i);const l=s.finish();t.queue.submit([l]),a.destroy()}function LCe(t,e){e.classHierarchy.push("vtkWebGPUBuffer"),t.create=(n,r)=>{e.handle=e.device.getHandle().createBuffer({size:n,usage:r,label:e.label}),e.sizeInBytes=n,e.usage=r},t.write=n=>{NCe(e.device.getHandle(),e.handle,0,n.buffer)},t.createAndWrite=(n,r)=>{e.handle=e.device.getHandle().createBuffer({size:n.byteLength,usage:r,mappedAtCreation:!0,label:e.label}),e.sizeInBytes=n.byteLength,e.usage=r,new Uint8Array(e.handle.getMappedRange()).set(new Uint8Array(n.buffer)),e.handle.unmap()};for(let n=0;n<WT.length;n++)t[WT[n]]=function(){return e.handle[WT[n]](...arguments)}}const kCe={device:null,handle:null,sizeInBytes:0,strideInBytes:0,arrayInformation:null,usage:null,label:null,sourceTime:null};function xX(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,kCe,n),le.obj(t,e),le.get(t,e,["handle","sizeInBytes","usage"]),le.setGet(t,e,["strideInBytes","device","arrayInformation","label","sourceTime"]),LCe(t,e)}const VCe=le.newInstance(xX);var I6={newInstance:VCe,extend:xX,...sy};const{Representation:xv,Interpolation:bv}=Fq;function AL(t){return()=>le.vtkErrorMacro(`vtkProperty::${t} - NOT IMPLEMENTED`)}function FCe(t,e){e.classHierarchy.push("vtkProperty"),t.setColor=(n,r,i)=>{Array.isArray(n)?(e.color[0]!==n[0]||e.color[1]!==n[1]||e.color[2]!==n[2])&&(e.color[0]=n[0],e.color[1]=n[1],e.color[2]=n[2],t.modified()):(e.color[0]!==n||e.color[1]!==r||e.color[2]!==i)&&(e.color[0]=n,e.color[1]=r,e.color[2]=i,t.modified()),t.setDiffuseColor(e.color),t.setAmbientColor(e.color),t.setSpecularColor(e.color)},t.computeCompositeColor=AL("ComputeCompositeColor"),t.getColor=()=>{let n=0;e.ambient+e.diffuse+e.specular>0&&(n=1/(e.ambient+e.diffuse+e.specular));for(let r=0;r<3;r++)e.color[r]=n*(e.ambient*e.ambientColor[r]+e.diffuse*e.diffuseColor[r]+e.specular*e.specularColor[r]);return[].concat(e.color)},t.setSpecularPower=n=>{const r=1/Math.max(1,n);(e.roughness!==r||e.specularPower!==n)&&(e.specularPower=n,e.roughness=r,t.modified())},t.addShaderVariable=AL("AddShaderVariable"),t.setInterpolationToFlat=()=>t.setInterpolation(bv.FLAT),t.setInterpolationToGouraud=()=>t.setInterpolation(bv.GOURAUD),t.setInterpolationToPhong=()=>t.setInterpolation(bv.PHONG),t.getInterpolationAsString=()=>le.enumToString(bv,e.interpolation),t.setRepresentationToWireframe=()=>t.setRepresentation(xv.WIREFRAME),t.setRepresentationToSurface=()=>t.setRepresentation(xv.SURFACE),t.setRepresentationToPoints=()=>t.setRepresentation(xv.POINTS),t.getRepresentationAsString=()=>le.enumToString(xv,e.representation)}const UCe={color:[1,1,1],ambientColor:[1,1,1],diffuseColor:[1,1,1],specularColor:[1,1,1],edgeColor:[0,0,0],ambient:0,diffuse:1,metallic:0,roughness:.6,normalStrength:1,emission:1,baseIOR:1.45,specular:0,specularPower:1,opacity:1,interpolation:bv.GOURAUD,representation:xv.SURFACE,edgeVisibility:!1,backfaceCulling:!1,frontfaceCulling:!1,pointSize:1,lineWidth:1,lighting:!0,shading:!1,materialName:null};function bX(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,UCe,n),le.obj(t,e),le.setGet(t,e,["lighting","interpolation","ambient","diffuse","metallic","roughness","normalStrength","emission","baseIOR","specular","specularPower","opacity","edgeVisibility","lineWidth","pointSize","backfaceCulling","frontfaceCulling","representation","diffuseTexture","metallicTexture","roughnessTexture","normalTexture","ambientOcclusionTexture","emissionTexture"]),le.setGetArray(t,e,["ambientColor","specularColor","diffuseColor","edgeColor"],3),FCe(t,e)}const BCe=le.newInstance(bX,"vtkProperty");var up={newInstance:BCe,extend:bX,...Fq};const{Representation:PL}=up,{PrimitiveTypes:Md}=sy;class $Ce{constructor(){this.keys=new Uint32Array(10),this.values=new Uint32Array(10),this.count=0}clear(){this.count=0}has(e){for(let n=0;n<this.count;n++)if(this.keys[n]===e)return!0}get(e){for(let n=0;n<this.count;n++)if(this.keys[n]===e)return this.values[n]}set(e,n){this.count<9&&(this.keys[this.count]=e,this.values[this.count++]=n)}}function GCe(t){switch(t){case Md.Points:return"points";case Md.Lines:return"lines";case Md.Triangles:case Md.TriangleEdges:return"polys";case Md.TriangleStripEdges:case Md.TriangleStrips:return"strips";default:return""}}function tx(t,e,n){let r=t.pointIdToFlatId[e];return r<0&&(r=t.flatId,t.pointIdToFlatId[e]=r,t.flatIdToPointId[t.flatId]=e,t.flatIdToCellId[t.flatId]=n,t.flatId++),r}function jCe(t,e,n){const r=t.length;for(let o=0;o<r;o++){let s=t[o];if(n.cellProvokedMap.has(s)){n.ibo[n.iboId++]=n.cellProvokedMap.get(s);for(let l=o+1;l<o+r;l++){s=t[l%r];const c=tx(n,s,e);n.ibo[n.iboId++]=c}return}}for(let o=0;o<r;o++){let s=t[o];if(!n.provokedPointIds[s]){let l=tx(n,s,e);n.provokedPointIds[s]=1,n.cellProvokedMap.set(s,l),n.flatIdToCellId[l]=e,n.ibo[n.iboId++]=l;for(let c=o+1;c<o+r;c++)s=t[c%r],l=tx(n,s,e),n.ibo[n.iboId++]=l;return}}let i=t[0],a=n.flatId;n.cellProvokedMap.set(i,a),n.flatIdToPointId[n.flatId]=i,n.flatIdToCellId[n.flatId]=e,n.flatId++,n.ibo[n.iboId++]=a;for(let o=1;o<r;o++)i=t[o],a=tx(n,i,e),n.ibo[n.iboId++]=a}function zCe(t,e,n){const r=t.length;n.iboSize+=r;for(let i=0;i<r;i++){const a=t[i];if(n.cellProvokedMap.has(a))return}for(let i=0;i<r;i++){const a=t[i];if(!n.provokedPointIds[a]){n.provokedPointIds[a]=1,n.cellProvokedMap.set(a,1);return}}n.cellProvokedMap.set(t[0],1),n.extraPoints++}let lf;const NL=new Uint32Array(1),Cl=new Uint32Array(2),gd=new Uint32Array(3),HT={anythingToPoints(t,e,n,r,i){for(let a=0;a<t;++a)NL[0]=e[n+a],lf(NL,r,i)},linesToWireframe(t,e,n,r,i){for(let a=0;a<t-1;++a)Cl[0]=e[n+a],Cl[1]=e[n+a+1],lf(Cl,r,i)},polysToWireframe(t,e,n,r,i){if(t>2)for(let a=0;a<t;++a)Cl[0]=e[n+a],Cl[1]=e[n+(a+1)%t],lf(Cl,r,i)},stripsToWireframe(t,e,n,r,i){if(t>2){for(let a=0;a<t-1;++a)Cl[0]=e[n+a],Cl[1]=e[n+a+1],lf(Cl,r,i);for(let a=0;a<t-2;a++)Cl[0]=e[n+a],Cl[1]=e[n+a+2],lf(Cl,r,i)}},polysToSurface(t,e,n,r,i){for(let a=0;a<t-2;a++)gd[0]=e[n],gd[1]=e[n+a+1],gd[2]=e[n+a+2],lf(gd,r,i)},stripsToSurface(t,e,n,r,i){for(let a=0;a<t-2;a++)gd[0]=e[n+a],gd[1]=e[n+a+1+a%2],gd[2]=e[n+a+1+(a+1)%2],lf(gd,r,i)}};function WCe(t,e){e.classHierarchy.push("vtkWebGPUIndexBuffer"),t.buildIndexBuffer=n=>{const r=n.cells,i=n.primitiveType,a=n.representation,o=n.cellOffset,s=r.getData(),l=s.length,c=GCe(i),f=n.numberOfPoints,u={provokedPointIds:new Uint8Array(f),extraPoints:0,iboSize:0,flatId:0,iboId:0,cellProvokedMap:new $Ce};let d=null;a===PL.POINTS||i===Md.Points?d=HT.anythingToPoints:a===PL.WIREFRAME||i===Md.Lines?d=HT[`${c}ToWireframe`]:d=HT[`${c}ToSurface`],lf=zCe;let h=o||0;for(let p=0;p<l;)u.cellProvokedMap.clear(),d(s[p],s,p+1,h,u),p+=s[p]+1,h++;f<=65535?u.flatIdToPointId=new Uint16Array(f+u.extraPoints):u.flatIdToPointId=new Uint32Array(f+u.extraPoints),f+u.extraPoints<36863?u.pointIdToFlatId=new Int16Array(f):u.pointIdToFlatId=new Int32Array(f),f+u.extraPoints<=65535?(u.ibo=new Uint16Array(u.iboSize),n.format="uint16"):(u.ibo=new Uint32Array(u.iboSize),n.format="uint32"),h<=65535?u.flatIdToCellId=new Uint16Array(f+u.extraPoints):u.flatIdToCellId=new Uint32Array(f+u.extraPoints),u.pointIdToFlatId.fill(-1),u.provokedPointIds.fill(0),lf=jCe,h=o||0;for(let p=0;p<l;)u.cellProvokedMap.clear(),d(s[p],s,p+1,h,u),p+=s[p]+1,h++;delete u.provokedPointIds,delete u.pointIdToFlatId,n.nativeArray=u.ibo,e.flatIdToPointId=u.flatIdToPointId,e.flatIdToCellId=u.flatIdToCellId,e.flatSize=u.flatId,e.indexCount=u.iboId}}const HCe={flatIdToPointId:null,flatIdToCellId:null,flatSize:0,indexCount:0};function wX(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,HCe,n),I6.extend(t,e,n),le.setGet(t,e,["flatIdToPointId","flatIdToCellId","flatSize","indexCount"]),WCe(t,e)}const KCe=le.newInstance(wX);var qCe={newInstance:KCe,extend:wX,...sy};const{BufferUsage:md}=sy,{vtkErrorMacro:XCe}=po,{VtkDataTypes:K0}=nn,YCe={};function JCe(t){let e;switch(t.getDataType()){case K0.UNSIGNED_CHAR:e="uint8";break;case K0.FLOAT:e="float32";break;case K0.UNSIGNED_INT:e="uint32";break;case K0.INT:e="sint32";break;case K0.DOUBLE:e="float32";break;case K0.UNSIGNED_SHORT:e="uint16";break;case K0.SHORT:e="sin16";break;default:e="float32";break}switch(t.getNumberOfComponents()){case 2:e+="x2";break;case 3:e.includes("32")||XCe(`unsupported x3 type for ${e}`),e+="x3";break;case 4:e+="x4";break}return e}function LL(t,e,n,r,i){const a={},o=t.getFlatSize();if(!o)return a;let s=[0,0,0,0];i.shift&&(i.shift.length?s=i.shift:s.fill(i.shift));let l=[1,1,1,1];i.scale&&(i.scale.length?l=i.scale:l.fill(i.scale));const c=Object.prototype.hasOwnProperty.call(i,"packExtra")?i.packExtra:!1;let f,u=0;const d=n+(c?1:0),h=Am(r,o*d);let p=t.getFlatIdToPointId();i.cellData&&(p=t.getFlatIdToCellId()),n===1?f=function(m){h[u++]=l[0]*e[m]+s[0]}:n===2?f=function(m){h[u++]=l[0]*e[m]+s[0],h[u++]=l[1]*e[m+1]+s[1]}:n===3&&!c?f=function(m){h[u++]=l[0]*e[m]+s[0],h[u++]=l[1]*e[m+1]+s[1],h[u++]=l[2]*e[m+2]+s[2]}:n===3&&c?f=function(m){h[u++]=l[0]*e[m]+s[0],h[u++]=l[1]*e[m+1]+s[1],h[u++]=l[2]*e[m+2]+s[2],h[u++]=l[3]*1+s[3]}:n===4&&(f=function(m){h[u++]=l[0]*e[m]+s[0],h[u++]=l[1]*e[m+1]+s[1],h[u++]=l[2]*e[m+2]+s[2],h[u++]=l[3]*e[m+3]+s[3]});for(let g=0;g<o;g++){const m=n*p[g];f(m)}return a.nativeArray=h,a}function ZCe(t,e,n,r){const i=[t[r*3]-t[n*3],t[r*3+1]-t[n*3+1],t[r*3+2]-t[n*3+2]],a=[t[e*3]-t[n*3],t[e*3+1]-t[n*3+1],t[e*3+2]-t[n*3+2]],o=[];return gu(i,a,o),qh(o),o}function QCe(t,e){const n=e.getData(),r=t.getData();if(!r||!n)return null;const i=new Int8Array(t.getNumberOfCells()*4),a=r.length;let o=0;for(let s=0;s<a;){const l=ZCe(n,r[s+1],r[s+2],r[s+3]);i[o++]=127*l[0],i[o++]=127*l[1],i[o++]=127*l[2],i[o++]=127,s+=r[s]+1}return i}function e4e(t,e){e.classHierarchy.push("vtkWebGPUBufferManager");function n(r){r.dataArray&&!r.nativeArray&&(r.nativeArray=r.dataArray.getData());let i,a;if(r.usage===md.Index&&(i=qCe.newInstance({label:r.label}),i.setDevice(e.device),a=GPUBufferUsage.INDEX|GPUBufferUsage.COPY_DST,i.buildIndexBuffer(r),i.createAndWrite(r.nativeArray,a),i.setArrayInformation([{format:r.format}])),i||(i=I6.newInstance({label:r.label}),i.setDevice(e.device)),r.usage===md.UniformArray&&(a=GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST,i.createAndWrite(r.nativeArray,a)),r.usage===md.Storage&&(a=GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST,i.createAndWrite(r.nativeArray,a)),r.usage===md.Texture&&(a=GPUBufferUsage.COPY_SRC,i.createAndWrite(r.nativeArray,a)),r.usage===md.PointArray){a=GPUBufferUsage.VERTEX;const o=ao.getNativeTypeFromBufferFormat(r.format),s=LL(r.indexBuffer,r.dataArray.getData(),r.dataArray.getNumberOfComponents(),o,{packExtra:r.packExtra,shift:r.shift,scale:r.scale,cellData:r.cellData,cellOffset:r.cellOffset});i.createAndWrite(s.nativeArray,a),i.setStrideInBytes(ao.getByteStrideFromBufferFormat(r.format)),i.setArrayInformation([{offset:0,format:r.format,interpolation:r.cellData?"flat":"perspective"}])}if(r.usage===md.NormalsFromPoints){a=GPUBufferUsage.VERTEX;const o=ao.getNativeTypeFromBufferFormat(r.format),s=QCe(r.cells,r.dataArray),l=LL(r.indexBuffer,s,4,o,{cellData:!0});i.createAndWrite(l.nativeArray,a),i.setStrideInBytes(ao.getByteStrideFromBufferFormat(r.format)),i.setArrayInformation([{offset:0,format:r.format,interpolation:"flat"}])}return r.usage===md.RawVertex&&(a=GPUBufferUsage.VERTEX,i.createAndWrite(r.nativeArray,a),i.setStrideInBytes(ao.getByteStrideFromBufferFormat(r.format)),i.setArrayInformation([{offset:0,format:r.format}])),i.setSourceTime(r.time),i}t.hasBuffer=r=>e.device.hasCachedObject(r),t.getBuffer=r=>r.hash?e.device.getCachedObject(r.hash,n,r):n(r),t.getBufferForPointArray=(r,i)=>{const a=JCe(r),o={hash:`${r.getMTime()}I${i.getMTime()}${a}`,usage:md.PointArray,format:a,dataArray:r,indexBuffer:i};return t.getBuffer(o)},t.getFullScreenQuadBuffer=()=>{if(e.fullScreenQuadBuffer)return e.fullScreenQuadBuffer;e.fullScreenQuadBuffer=I6.newInstance(),e.fullScreenQuadBuffer.setDevice(e.device);const r=new Float32Array([-1,-1,0,1,-1,0,1,1,0,-1,-1,0,1,1,0,-1,1,0]);return e.fullScreenQuadBuffer.createAndWrite(r,GPUBufferUsage.VERTEX),e.fullScreenQuadBuffer.setStrideInBytes(12),e.fullScreenQuadBuffer.setArrayInformation([{offset:0,format:"float32x3"}]),e.fullScreenQuadBuffer}}const t4e={device:null,fullScreenQuadBuffer:null};function n4e(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,t4e,n),$r(t,e),Mi(t,e,["device"]),e4e(t,e)}Zn(n4e);var km={...YCe,...sy};const{BufferUsage:r4e}=km,{vtkErrorMacro:Jp}=le;function i4e(t,e){e.classHierarchy.push("vtkWebGPUStorageBuffer"),t.addEntry=(n,r)=>{if(e._bufferEntryNames.has(n)){Jp(`entry named ${n} already exists`);return}e._bufferEntryNames.set(n,e.bufferEntries.length);const i=ao.getByteStrideFromShaderFormat(r);e.bufferEntries.push({name:n,type:r,sizeInBytes:i,offset:e.sizeInBytes,nativeType:ao.getNativeTypeFromShaderFormat(r)}),e.sizeInBytes+=i},t.send=n=>{if(!e._buffer){const r={nativeArray:e.Float32Array,usage:r4e.Storage,label:e.label};e._buffer=n.getBufferManager().getBuffer(r),e.bindGroupTime.modified(),e._sendTime.modified();return}n.getHandle().queue.writeBuffer(e._buffer.getHandle(),0,e.arrayBuffer,0,e.sizeInBytes*e.numberOfInstances),e._sendTime.modified()},t.createView=n=>{n in e||(e.arrayBuffer||(e.arrayBuffer=new ArrayBuffer(e.sizeInBytes*e.numberOfInstances)),e[n]=le.newTypedArray(n,e.arrayBuffer))},t.setValue=(n,r,i)=>{const a=e._bufferEntryNames.get(n);if(a===void 0){Jp(`entry named ${n} not found in UBO`);return}const o=e.bufferEntries[a];t.createView(o.nativeType);const s=e[o.nativeType];s[(o.offset+r*e.sizeInBytes)/s.BYTES_PER_ELEMENT]=i},t.setArray=(n,r,i)=>{const a=e._bufferEntryNames.get(n);if(a===void 0){Jp(`entry named ${n} not found in UBO`);return}const o=e.bufferEntries[a];t.createView(o.nativeType);const s=e[o.nativeType],l=(o.offset+r*e.sizeInBytes)/s.BYTES_PER_ELEMENT;for(let c=0;c<i.length;c++)s[l+c]=i[c]},t.setAllInstancesFromArray=(n,r)=>{const i=e._bufferEntryNames.get(n);if(i===void 0){Jp(`entry named ${n} not found in UBO`);return}const a=e.bufferEntries[i];t.createView(a.nativeType);const o=e[a.nativeType],s=r.length/e.numberOfInstances;for(let l=0;l<e.numberOfInstances;l++){const c=(a.offset+l*e.sizeInBytes)/o.BYTES_PER_ELEMENT;for(let f=0;f<s;f++)o[c+f]=r[l*s+f]}},t.setAllInstancesFromArrayColorToFloat=(n,r)=>{const i=e._bufferEntryNames.get(n);if(i===void 0){Jp(`entry named ${n} not found in UBO`);return}const a=e.bufferEntries[i];t.createView(a.nativeType);const o=e[a.nativeType],s=r.length/e.numberOfInstances;for(let l=0;l<e.numberOfInstances;l++){const c=(a.offset+l*e.sizeInBytes)/o.BYTES_PER_ELEMENT;for(let f=0;f<s;f++)o[c+f]=r[l*s+f]/255}},t.setAllInstancesFromArray3x3To4x4=(n,r)=>{const i=e._bufferEntryNames.get(n);if(i===void 0){Jp(`entry named ${n} not found in UBO`);return}const a=e.bufferEntries[i];t.createView(a.nativeType);const o=e[a.nativeType],s=9;for(let l=0;l<e.numberOfInstances;l++){const c=(a.offset+l*e.sizeInBytes)/o.BYTES_PER_ELEMENT;for(let f=0;f<3;f++)for(let u=0;u<3;u++)o[c+f*4+u]=r[l*s+f*3+u]}},t.getSendTime=()=>e._sendTime.getMTime(),t.getShaderCode=(n,r)=>{const i=[`struct ${e.label}StructEntry
{`];for(let a=0;a<e.bufferEntries.length;a++){const o=e.bufferEntries[a];i.push(`  ${o.name}: ${o.type},`)}return i.push(`
};
struct ${e.label}Struct
{
  values: array<${e.label}StructEntry>,
};
@binding(${n}) @group(${r}) var<storage, read> ${e.label}: ${e.label}Struct;
`),i.join(`
`)},t.getBindGroupEntry=()=>({resource:{buffer:e._buffer.getHandle()}}),t.clearData=()=>{e.numberOfInstances=0,e.sizeInBytes=0,e.bufferEntries=[],e._bufferEntryNames=new Map,e._buffer=null,delete e.arrayBuffer,delete e.Float32Array}}const a4e={bufferEntries:null,bufferEntryNames:null,sizeInBytes:0,label:null,numberOfInstances:1};function CX(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,a4e,n),le.obj(t,e),e._bufferEntryNames=new Map,e.bufferEntries=[],e._sendTime={},le.obj(e._sendTime,{mtime:0}),e.bindGroupTime={},le.obj(e.bindGroupTime,{mtime:0}),e.bindGroupLayoutEntry=e.bindGroupLayoutEntry||{buffer:{type:"read-only-storage"}},le.get(t,e,["bindGroupTime"]),le.setGet(t,e,["device","bindGroupLayoutEntry","label","numberOfInstances","sizeInBytes"]),i4e(t,e)}const o4e=le.newInstance(CX,"vtkWebGPUStorageBuffer");var s4e={newInstance:o4e,extend:CX};const{BufferUsage:l4e}=km,{vtkErrorMacro:KT}=le;function c4e(t,e){e.classHierarchy.push("vtkWebGPUUniformBuffer"),t.addEntry=(n,r)=>{if(e._bufferEntryNames.has(n)){KT(`entry named ${n} already exists`);return}e.sortDirty=!0,e._bufferEntryNames.set(n,e.bufferEntries.length),e.bufferEntries.push({name:n,type:r,sizeInBytes:ao.getByteStrideFromShaderFormat(r),offset:-1,nativeType:ao.getNativeTypeFromShaderFormat(r),packed:!1})},t.sortBufferEntries=()=>{if(!e.sortDirty)return;let n=0;const r=[];let i=4;for(let a=0;a<e.bufferEntries.length;a++){const o=e.bufferEntries[a];o.sizeInBytes%16===0&&(i=Math.max(16,i)),o.sizeInBytes%8===0&&(i=Math.max(8,i))}for(let a=0;a<e.bufferEntries.length;a++){const o=e.bufferEntries[a];o.packed===!1&&o.sizeInBytes%16===0&&(o.packed=!0,o.offset=n,r.push(o),n+=o.sizeInBytes)}for(let a=0;a<e.bufferEntries.length;a++){const o=e.bufferEntries[a];if(o.packed===!1&&o.sizeInBytes===12)for(let s=0;s<e.bufferEntries.length;s++){const l=e.bufferEntries[s];if(l.packed===!1&&l.sizeInBytes===4){o.packed=!0,o.offset=n,r.push(o),n+=o.sizeInBytes,l.packed=!0,l.offset=n,r.push(l),n+=l.sizeInBytes;break}}}for(let a=0;a<e.bufferEntries.length;a++){const o=e.bufferEntries[a];if(!o.packed&&o.sizeInBytes%8===0)for(let s=a+1;s<e.bufferEntries.length;s++){const l=e.bufferEntries[s];if(!l.packed&&l.sizeInBytes%8===0){o.packed=!0,o.offset=n,r.push(o),n+=o.sizeInBytes,l.packed=!0,l.offset=n,r.push(l),n+=l.sizeInBytes;break}}}for(let a=0;a<e.bufferEntries.length;a++){const o=e.bufferEntries[a];if(!o.packed&&o.sizeInBytes%8===0){let s=!1;for(let l=0;!s&&l<e.bufferEntries.length;l++){const c=e.bufferEntries[l];if(!c.packed&&c.sizeInBytes===4)for(let f=l+1;f<e.bufferEntries.length;f++){const u=e.bufferEntries[f];if(!u.packed&&u.sizeInBytes===4){o.packed=!0,o.offset=n,r.push(o),n+=o.sizeInBytes,c.packed=!0,c.offset=n,r.push(c),n+=c.sizeInBytes,u.packed=!0,u.offset=n,r.push(u),n+=u.sizeInBytes,s=!0;break}}}}}for(let a=0;a<e.bufferEntries.length;a++){const o=e.bufferEntries[a];!o.packed&&o.sizeInBytes>4&&(o.packed=!0,o.offset=n,r.push(o),n+=o.sizeInBytes)}for(let a=0;a<e.bufferEntries.length;a++){const o=e.bufferEntries[a];o.packed||(o.packed=!0,o.offset=n,r.push(o),n+=o.sizeInBytes)}e.bufferEntries=r,e._bufferEntryNames.clear();for(let a=0;a<e.bufferEntries.length;a++)e._bufferEntryNames.set(e.bufferEntries[a].name,a);e.sizeInBytes=n,e.sizeInBytes=i*Math.ceil(e.sizeInBytes/i),e.sortDirty=!1},t.sendIfNeeded=n=>{if(!e.UBO){const r={nativeArray:e.Float32Array,usage:l4e.UniformArray,label:e.label};e.UBO=n.getBufferManager().getBuffer(r),e.bindGroupTime.modified(),e.sendDirty=!1}e.sendDirty&&(n.getHandle().queue.writeBuffer(e.UBO.getHandle(),0,e.arrayBuffer,0,e.sizeInBytes),e.sendDirty=!1),e.sendTime.modified()},t.createView=n=>{n in e||(e.arrayBuffer||(e.arrayBuffer=new ArrayBuffer(e.sizeInBytes)),e[n]=le.newTypedArray(n,e.arrayBuffer))},t.setValue=(n,r)=>{t.sortBufferEntries();const i=e._bufferEntryNames.get(n);if(i===void 0){KT(`entry named ${n} not found in UBO`);return}const a=e.bufferEntries[i];t.createView(a.nativeType);const o=e[a.nativeType];a.lastValue!==r&&(o[a.offset/o.BYTES_PER_ELEMENT]=r,e.sendDirty=!0),a.lastValue=r},t.setArray=(n,r)=>{t.sortBufferEntries();const i=e._bufferEntryNames.get(n);if(i===void 0){KT(`entry named ${n} not found in UBO`);return}const a=e.bufferEntries[i];t.createView(a.nativeType);const o=e[a.nativeType];let s=!1;for(let l=0;l<r.length;l++)(!a.lastValue||a.lastValue[l]!==r[l])&&(o[a.offset/o.BYTES_PER_ELEMENT+l]=r[l],s=!0);s&&(e.sendDirty=!0,a.lastValue=[...r])},t.getBindGroupEntry=()=>({resource:{buffer:e.UBO.getHandle()}}),t.getSendTime=()=>e.sendTime.getMTime(),t.getShaderCode=(n,r)=>{t.sortBufferEntries();const i=[`struct ${e.label}Struct
{`];for(let a=0;a<e.bufferEntries.length;a++){const o=e.bufferEntries[a];i.push(`  ${o.name}: ${o.type},`)}return i.push(`};
@binding(${n}) @group(${r}) var<uniform> ${e.label}: ${e.label}Struct;`),i.join(`
`)}}const u4e={bufferEntries:null,bufferEntryNames:null,sizeInBytes:0,label:null,bindGroupLayoutEntry:null,bindGroupEntry:null};function SX(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,u4e,n),le.obj(t,e),e._bufferEntryNames=new Map,e.bufferEntries=[],e.bindGroupLayoutEntry=e.bindGroupLayoutEntry||{buffer:{type:"uniform"}},e.sendTime={},le.obj(e.sendTime,{mtime:0}),e.bindGroupTime={},le.obj(e.bindGroupTime,{mtime:0}),e.sendDirty=!0,e.sortDirty=!0,le.get(t,e,["binding","bindGroupTime"]),le.setGet(t,e,["bindGroupLayoutEntry","device","label","sizeInBytes"]),c4e(t,e)}const f4e=le.newInstance(SX,"vtkWebGPUUniformBuffer");var Wg={newInstance:f4e,extend:SX};const{vtkDebugMacro:d4e}=po,kL=`
//VTK::Renderer::Dec

//VTK::Mapper::Dec

//VTK::TCoord::Dec

//VTK::RenderEncoder::Dec

//VTK::IOStructs::Dec

@fragment
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var output: fragmentOutput;

  var computedColor: vec4<f32> = mapperUBO.BackgroundColor;

  //VTK::RenderEncoder::Impl
  return output;
}
`,h4e=`
fn vecToRectCoord(dir: vec3<f32>) -> vec2<f32> {
  var tau: f32 = 6.28318530718;
  var pi: f32 = 3.14159265359;
  var out: vec2<f32> = vec2<f32>(0.0);

  out.x = atan2(dir.z, dir.x) / tau;
  out.x += 0.5;

  var phix: f32 = length(vec2(dir.x, dir.z));
  out.y = atan2(dir.y, phix) / pi + 0.5;

  return out;
}

//VTK::Renderer::Dec

//VTK::Mapper::Dec

//VTK::TCoord::Dec

//VTK::RenderEncoder::Dec

//VTK::IOStructs::Dec

@fragment
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var output: fragmentOutput;

  var tcoord: vec4<f32> = vec4<f32>(input.vertexVC.xy, -1, 1);
  var V: vec4<f32> = normalize(mapperUBO.FSQMatrix * tcoord); // vec2<f32>((input.tcoordVS.x - 0.5) * 2, -(input.tcoordVS.y - 0.5) * 2);
  // textureSampleLevel gets rid of some ugly artifacts
  var background = textureSampleLevel(EnvironmentTexture, EnvironmentTextureSampler, vecToRectCoord(V.xyz), 0.0);
  var computedColor: vec4<f32> = vec4<f32>(background.rgb, 1);

  //VTK::RenderEncoder::Impl
  return output;
}
`,nx=new Float64Array(16),VL=new Float64Array(16);function p4e(t){return t.getPositional()?t.getConeAngle()>=90?0:2:1}function g4e(t,e){e.classHierarchy.push("vtkWebGPURenderer"),t.buildPass=n=>{if(n){if(!e.renderable)return;e.camera=e.renderable.getActiveCamera(),t.updateLights(),t.prepareNodes(),t.addMissingNode(e.camera),t.addMissingNodes(e.renderable.getViewPropsWithNestedProps()),t.removeUnusedNodes(),e.webgpuCamera=t.getViewNodeFor(e.camera),t.updateStabilizedMatrix()}},t.updateStabilizedMatrix=()=>{const n=e.camera.getClippingRange(),r=e.camera.getPositionByReference(),i=e.camera.getDirectionOfProjectionByReference(),a=[],o=[];sf(o,i,.5*(n[0]+n[1])),vv(a,r,o),w6(o,a,e.stabilizedCenter),DK(o)/(n[1]-n[0])>e.recenterThreshold&&(e.stabilizedCenter=a,e.stabilizedTime.modified())},t.updateLights=()=>{let n=0;const r=e.renderable.getLightsByReference();for(let i=0;i<r.length;++i)r[i].getSwitch()>0&&n++;return n||(d4e("No lights are on, creating one."),e.renderable.createLight()),n},t.updateUBO=()=>{const n=e.UBO.getSendTime();if(e._parent.getMTime()>n||t.getMTime()>n||e.camera.getMTime()>n||e.renderable.getMTime()>n){const r=e.webgpuCamera.getKeyMatrices(t);e.UBO.setArray("WCVCMatrix",r.wcvc),e.UBO.setArray("SCPCMatrix",r.scpc),e.UBO.setArray("PCSCMatrix",r.pcsc),e.UBO.setArray("SCVCMatrix",r.scvc),e.UBO.setArray("VCPCMatrix",r.vcpc),e.UBO.setArray("WCVCNormals",r.normalMatrix),e.UBO.setValue("LightCount",e.renderable.getLights().length),e.UBO.setValue("MaxEnvironmentMipLevel",e.renderable.getEnvironmentTexture()?.getMipLevel()),e.UBO.setValue("BackgroundDiffuseStrength",e.renderable.getEnvironmentTextureDiffuseStrength()),e.UBO.setValue("BackgroundSpecularStrength",e.renderable.getEnvironmentTextureSpecularStrength());const i=t.getYInvertedTiledSizeAndOrigin();e.UBO.setArray("viewportSize",[i.usize,i.vsize]),e.UBO.setValue("cameraParallel",e.camera.getParallelProjection());const a=e._parent.getDevice();e.UBO.sendIfNeeded(a)}},t.updateSSBO=()=>{const n=e.renderable.getLights(),r=e.webgpuCamera.getKeyMatrices(t);let i=`${e.renderable.getMTime()}`;for(let a=0;a<n.length;a++)i+=n[a].getMTime();if(i!==e.lightTimeString){const a=new Float32Array(n.length*4),o=new Float32Array(n.length*4),s=new Float32Array(n.length*4),l=new Float32Array(n.length*4);for(let f=0;f<n.length;f++){const u=f*4,d=n[f].getPosition();$n(d,d,r.wcvc),a[u]=d[0],a[u+1]=d[1],a[u+2]=d[2],a[u+3]=0,o[u]=-n[f].getDirection()[0],o[u+1]=-n[f].getDirection()[1],o[u+2]=-n[f].getDirection()[2],o[u+3]=0,s[u]=n[f].getColor()[0],s[u+1]=n[f].getColor()[1],s[u+2]=n[f].getColor()[2],s[u+3]=n[f].getIntensity()*5,l[u]=p4e(n[f]),l[u+1]=Math.cos(wi(n[f].getConeAngle())),l[u+2]=Math.cos(wi(n[f].getConeAngle()+n[f].getConeFalloff())),l[u+3]=0}e.SSBO.clearData(),e.SSBO.setNumberOfInstances(n.length),e.SSBO.addEntry("LightPos","vec4<f32>"),e.SSBO.addEntry("LightDir","vec4<f32>"),e.SSBO.addEntry("LightColor","vec4<f32>"),e.SSBO.addEntry("LightData","vec4<f32>"),e.SSBO.setAllInstancesFromArray("LightPos",a),e.SSBO.setAllInstancesFromArray("LightDir",o),e.SSBO.setAllInstancesFromArray("LightColor",s),e.SSBO.setAllInstancesFromArray("LightData",l);const c=e._parent.getDevice();e.SSBO.send(c)}e.lightTimeString=i},t.scissorAndViewport=n=>{const r=t.getYInvertedTiledSizeAndOrigin();n.getHandle().setViewport(r.lowerLeftU,r.lowerLeftV,r.usize,r.vsize,0,1),n.getHandle().setScissorRect(r.lowerLeftU,r.lowerLeftV,r.usize,r.vsize)},t.bindUBO=n=>{n.activateBindGroup(e.bindGroup)},t.opaquePass=n=>{n?(e.renderEncoder.begin(e._parent.getCommandEncoder()),t.updateUBO(),t.updateSSBO()):(t.scissorAndViewport(e.renderEncoder),t.clear(),e.renderEncoder.end())},t.clear=()=>{if(e.renderable.getTransparent()||e.suppressClear)return;const n=e._parent.getDevice();if(!e.clearFSQ){e.clearFSQ=M6.newInstance(),e.clearFSQ.setDevice(n),e.clearFSQ.setPipelineHash("clearfsq"),e.clearFSQ.setFragmentShaderTemplate(kL);const a=Wg.newInstance({label:"mapperUBO"});a.addEntry("FSQMatrix","mat4x4<f32>"),a.addEntry("BackgroundColor","vec4<f32>"),e.clearFSQ.setUBO(a),e.backgroundTex=e.renderable.getEnvironmentTexture()}if(e.clearFSQ.getPipelineHash()!=="clearfsqwithtexture"&&e.renderable.getUseEnvironmentTextureAsBackground()&&e.backgroundTex?.getImageLoaded()){e.clearFSQ.setFragmentShaderTemplate(h4e);const a=Wg.newInstance({label:"mapperUBO"});a.addEntry("FSQMatrix","mat4x4<f32>"),a.addEntry("BackgroundColor","vec4<f32>"),e.clearFSQ.setUBO(a);const o=n.getTextureManager().getTextureForVTKTexture(e.backgroundTex);if(o.getReady()){const s=o.createView("EnvironmentTexture");e.clearFSQ.setTextureViews([s]),e.backgroundTexLoaded=!0;const l=e.backgroundTex.getInterpolate()?"linear":"nearest";s.addSampler(n,{addressModeU:"repeat",addressModeV:"clamp-to-edge",addressModeW:"repeat",minFilter:l,magFilter:l,mipmapFilter:"linear"})}e.clearFSQ.setPipelineHash("clearfsqwithtexture")}else if(e.clearFSQ.getPipelineHash()==="clearfsqwithtexture"&&!e.renderable.getUseEnvironmentTextureAsBackground()){e.clearFSQ=M6.newInstance(),e.clearFSQ.setDevice(n),e.clearFSQ.setPipelineHash("clearfsq"),e.clearFSQ.setFragmentShaderTemplate(kL);const a=Wg.newInstance({label:"mapperUBO"});a.addEntry("FSQMatrix","mat4x4<f32>"),a.addEntry("BackgroundColor","vec4<f32>"),e.clearFSQ.setUBO(a)}const r=e.webgpuCamera.getKeyMatrices(t),i=e.renderable.getBackgroundByReference();e.clearFSQ.getUBO().setArray("BackgroundColor",i),Gn(VL,r.normalMatrix),d3(nx,r.scvc,r.pcsc),d3(nx,VL,nx),e.clearFSQ.getUBO().setArray("FSQMatrix",nx),e.clearFSQ.getUBO().sendIfNeeded(n),e.clearFSQ.prepareAndDraw(e.renderEncoder)},t.translucentPass=n=>{n?e.renderEncoder.begin(e._parent.getCommandEncoder()):(t.scissorAndViewport(e.renderEncoder),e.renderEncoder.end())},t.volumeDepthRangePass=n=>{n?e.renderEncoder.begin(e._parent.getCommandEncoder()):(t.scissorAndViewport(e.renderEncoder),e.renderEncoder.end())},t.getAspectRatio=()=>{const n=e._parent.getSizeByReference(),r=e.renderable.getViewportByReference();return n[0]*(r[2]-r[0])/((r[3]-r[1])*n[1])},t.convertToOpenGLDepth=n=>e.webgpuCamera.convertToOpenGLDepth(n),t.getYInvertedTiledSizeAndOrigin=()=>{const n=t.getTiledSizeAndOrigin(),r=e._parent.getSizeByReference();return n.lowerLeftV=r[1]-n.vsize-n.lowerLeftV,n},t.getTiledSizeAndOrigin=()=>{const n=e.renderable.getViewportByReference(),r=[0,0,1,1],i=n[0]-r[0],a=n[1]-r[1],o=e._parent.normalizedDisplayToDisplay(i,a),s=Math.round(o[0]),l=Math.round(o[1]),c=n[2]-r[0],f=n[3]-r[1],u=e._parent.normalizedDisplayToDisplay(c,f);let d=Math.round(u[0])-s,h=Math.round(u[1])-l;return d<0&&(d=0),h<0&&(h=0),{usize:d,vsize:h,lowerLeftU:s,lowerLeftV:l}},t.getPropFromID=n=>{for(let r=0;r<e.children.length;r++)if((e.children[r].getPropID?e.children[r].getPropID():-1)===n)return e.children[r];return null},t.getStabilizedTime=()=>e.stabilizedTime.getMTime(),t.releaseGraphicsResources=()=>{e.selector!==null&&e.selector.releaseGraphicsResources()}}const m4e={bindGroup:null,selector:null,renderEncoder:null,recenterThreshold:20,suppressClear:!1,stabilizedCenter:[0,0,0]};function v4e(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,m4e,n),Rr.extend(t,e,n),e.UBO=Wg.newInstance({label:"rendererUBO"}),e.UBO.addEntry("WCVCMatrix","mat4x4<f32>"),e.UBO.addEntry("SCPCMatrix","mat4x4<f32>"),e.UBO.addEntry("PCSCMatrix","mat4x4<f32>"),e.UBO.addEntry("SCVCMatrix","mat4x4<f32>"),e.UBO.addEntry("VCPCMatrix","mat4x4<f32>"),e.UBO.addEntry("WCVCNormals","mat4x4<f32>"),e.UBO.addEntry("viewportSize","vec2<f32>"),e.UBO.addEntry("LightCount","i32"),e.UBO.addEntry("MaxEnvironmentMipLevel","f32"),e.UBO.addEntry("BackgroundDiffuseStrength","f32"),e.UBO.addEntry("BackgroundSpecularStrength","f32"),e.UBO.addEntry("cameraParallel","u32"),e.SSBO=s4e.newInstance({label:"rendererLightSSBO"}),e.lightTimeString="",e.bindGroup=uX.newInstance({label:"rendererBG"}),e.bindGroup.setBindables([e.UBO,e.SSBO]),e.tmpMat4=sn(new Float64Array(16)),e.stabilizedTime={},$r(e.stabilizedTime,{mtime:0}),Po(t,e,["bindGroup","stabilizedTime"]),Pm(t,e,["stabilizedCenter"]),Mi(t,e,["renderEncoder","selector","suppressClear","UBO"]),g4e(t,e)}const y4e=Zn(v4e,"vtkWebGPURenderer");Ul("vtkRenderer",y4e);function x4e(t,e){e.classHierarchy.push("vtkWebGPUSampler"),t.create=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e.device=n,e.options.addressModeU=r.addressModeU?r.addressModeU:"clamp-to-edge",e.options.addressModeV=r.addressModeV?r.addressModeV:"clamp-to-edge",e.options.addressModeW=r.addressModeW?r.addressModeW:"clamp-to-edge",e.options.magFilter=r.magFilter?r.magFilter:"nearest",e.options.minFilter=r.minFilter?r.minFilter:"nearest",e.options.mipmapFilter=r.mipmapFilter?r.mipmapFilter:"nearest",e.options.label=e.label,e.handle=e.device.getHandle().createSampler(e.options),e.bindGroupTime.modified()},t.getShaderCode=(n,r)=>`@binding(${n}) @group(${r}) var ${e.label}: sampler;`,t.getBindGroupEntry=()=>({resource:e.handle})}const b4e={device:null,handle:null,label:null,options:null};function TX(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,b4e,n),le.obj(t,e),e.options={},e.bindGroupLayoutEntry={visibility:GPUShaderStage.VERTEX|GPUShaderStage.FRAGMENT,sampler:{}},e.bindGroupTime={},le.obj(e.bindGroupTime,{mtime:0}),le.get(t,e,["bindGroupTime","handle","options"]),le.setGet(t,e,["bindGroupLayoutEntry","device","label"]),x4e(t,e)}const w4e=le.newInstance(TX);var EX={newInstance:w4e,extend:TX};const{SlicingMode:FL}=Yw,C4e=`
//VTK::Renderer::Dec

//VTK::Mapper::Dec

//VTK::TCoord::Dec

//VTK::Image::Dec

//VTK::RenderEncoder::Dec

//VTK::IOStructs::Dec

@fragment
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var output: fragmentOutput;

  //VTK::Image::Sample

  // var computedColor: vec4<f32> = vec4<f32>(1.0,0.7, 0.5, 1.0);

//VTK::RenderEncoder::Impl

  return output;
}
`;function S4e(t,e,n){if(e.apply(t)){const i=t.getIndependentComponents();return`${t.getMTime()}-${i}-${n}`}return"0"}const $s=new Float64Array(16),jc=new Float64Array(16),rx=new Float64Array(16),ef=new Float64Array(4),da=new Float64Array(4);function T4e(t,e){e.classHierarchy.push("vtkWebGPUImageMapper"),t.buildPass=i=>{if(i){e.WebGPUImageSlice=t.getFirstAncestorOfType("vtkWebGPUImageSlice"),e.WebGPURenderer=e.WebGPUImageSlice.getFirstAncestorOfType("vtkWebGPURenderer"),e.WebGPURenderWindow=e.WebGPURenderer.getParent(),e.device=e.WebGPURenderWindow.getDevice();const a=e.WebGPURenderer.getRenderable();e.renderable.getSliceAtFocalPoint()&&e.renderable.setSliceFromCamera(a.getActiveCamera())}},t.translucentPass=i=>{i&&t.render()},t.opaquePass=i=>{i&&t.render()},t.render=()=>{e.renderable.update(),e.currentInput=e.renderable.getInputData(),t.prepareToDraw(e.WebGPURenderer.getRenderEncoder()),e.renderEncoder.registerDrawCallback(e.pipeline,t.draw)},t.computePipelineHash=()=>{const i=e.currentInput.getExtent();i[0]===i[1]||i[2]===i[3]||i[4]===i[5]?(e.dimensions=2,e.pipelineHash="img2"):(e.dimensions=3,e.pipelineHash="img3")},t.updateUBO=()=>{const i=e.UBO.getSendTime(),a=e.WebGPUImageSlice.getRenderable(),o=a.getMapper();if(t.getMTime()>i||e.renderable.getMTime()>i||a.getProperty().getMTime()>i){const s=o.getInputData(),l=e.WebGPURenderer.getStabilizedCenterByReference();sn($s),si($s,$s,l);const c=a.getMatrix();Gn(jc,c),ba(jc,jc),jn($s,jc,$s);const f=s.getWorldToIndex();jn($s,f,$s),ba(rx,$s),eD(jc,[.5,.5,.5]),jn($s,jc,$s);const u=s.getDimensions();sn(jc),p0(jc,jc,[1/u[0],1/u[1],1/u[2]]),jn($s,jc,$s),e.UBO.setArray("SCTCMatrix",$s);const d=e.currentInput.getExtent(),{ijkMode:h}=e.renderable.getClosestIJKAxis();let p=e.renderable.getSlice();h!==e.renderable.getSlicingMode()&&(p=e.renderable.getSliceAtPosition(p));let g=2,m=0,y=1;h===FL.I?(g=0,m=1,y=2):h===FL.J&&(g=1,m=2,y=0),ef[g]=p,ef[m]=d[m*2]-.5,ef[y]=d[y*2]-.5,ef[3]=1,Oh(ef,ef,rx),e.UBO.setArray("Origin",ef),da[g]=p,da[m]=d[m*2+1]+.5,da[y]=d[y*2]-.5,da[3]=1,Oh(da,da,rx),vL(da,da,ef),da[3]=1,e.UBO.setArray("Axis1",da),da[g]=p,da[m]=d[m*2]-.5,da[y]=d[y*2+1]+.5,da[3]=1,Oh(da,da,rx),vL(da,da,ef),da[3]=1,e.UBO.setArray("Axis2",da);const v=[1,1,1,1],x=[0,0,0,0],w=e.textureViews[0],S=w.getTexture().getScale(),T=w.getTexture().getNumberOfComponents();for(let _=0;_<T;_++){let D=a.getProperty().getColorWindow(),I=a.getProperty().getColorLevel();const M=a.getProperty().getRGBTransferFunction(0);if(M){const A=M.getRange();D=A[1]-A[0],I=.5*(A[1]+A[0])}v[_]=S/D,x[_]=-I/D+.5}e.UBO.setArray("cScale",v),e.UBO.setArray("cShift",x),e.UBO.sendIfNeeded(e.device)}},t.updateLUTImage=()=>{const i=e.WebGPUImageSlice.getRenderable().getProperty();t.getTextureViews()[0].getTexture().getNumberOfComponents();const o=1,s=S4e(i,i.getRGBTransferFunction,o);if(e.colorTextureString!==s){e.numRows=o;const l=new Uint8ClampedArray(e.numRows*2*e.rowLength*4);let c=i.getRGBTransferFunction();if(c){const f=new Float32Array(e.rowLength*3);for(let u=0;u<o;u++){c=i.getRGBTransferFunction(u);const d=c.getRange();c.getTable(d[0],d[1],e.rowLength,f,1);for(let h=0;h<e.rowLength;h++){const p=u*e.rowLength*8+h*4;l[p]=255*f[h*3],l[p+1]=255*f[h*3+1],l[p+2]=255*f[h*3+2],l[p+3]=255;for(let g=0;g<4;g++)l[p+e.rowLength*4+g]=l[p+g]}}}else for(let f=0;f<e.rowLength;++f){const u=255*f/(e.rowLength-1);l[f*4]=u,l[f*4+1]=u,l[f*4+2]=u,l[f*4+3]=255;for(let d=0;d<4;d++)l[f*4+e.rowLength*4+d]=l[f*4+d]}{const f={nativeArray:l,width:e.rowLength,height:e.numRows*2,depth:1,format:"rgba8unorm"},d=e.device.getTextureManager().getTexture(f).createView("tfunTexture");e.textureViews[1]=d}e.colorTextureString=s}};const n=t.updateBuffers;t.updateBuffers=()=>{n();const i=e.device.getTextureManager().getTextureForImageData(e.currentInput),a=e.textureViews;if(!a[0]||a[0].getTexture()!==i){const l=i.createView("imgTexture");a[0]=l}t.updateLUTImage(),t.updateUBO();const s=e.WebGPUImageSlice.getRenderable().getProperty().getInterpolationType()===Vh.NEAREST?"nearest":"linear";(!e.clampSampler||s!==e.clampSampler.getOptions().minFilter)&&(e.clampSampler=EX.newInstance({label:"clampSampler"}),e.clampSampler.create(e.device,{minFilter:s,magFilter:s}),e.additionalBindables=[e.clampSampler])};const r=t.getShaderReplacements();t.replaceShaderPosition=(i,a,o)=>{const s=a.getShaderDescription("vertex");s.addBuiltinOutput("vec4<f32>","@builtin(position) Position");let l=s.getCode();const c=["var pos: vec4<f32> = mapperUBO.Origin +","   (vertexBC.x * 0.5 + 0.5) * mapperUBO.Axis1 + (vertexBC.y * 0.5 + 0.5) * mapperUBO.Axis2;","pos.w = 1.0;"];e.dimensions===2?c.push("var tcoord : vec2<f32> = (mapperUBO.SCTCMatrix * pos).xy;"):c.push("var tcoord : vec3<f32> = (mapperUBO.SCTCMatrix * pos).xyz;"),c.push("output.tcoordVS = tcoord;","output.Position = rendererUBO.SCPCMatrix * pos;"),l=_r.substitute(l,"//VTK::Position::Impl",c).result,s.setCode(l)},r.set("replaceShaderPosition",t.replaceShaderPosition),t.replaceShaderTCoord=(i,a,o)=>{const s=a.getShaderDescription("vertex");e.dimensions===2?s.addOutput("vec2<f32>","tcoordVS"):s.addOutput("vec3<f32>","tcoordVS")},r.set("replaceShaderTCoord",t.replaceShaderTCoord),t.replaceShaderImage=(i,a,o)=>{const s=a.getShaderDescription("fragment");let l=s.getCode();e.dimensions===3?l=_r.substitute(l,"//VTK::Image::Sample",["    var computedColor: vec4<f32> =","      textureSampleLevel(imgTexture, clampSampler, input.tcoordVS, 0.0);","//VTK::Image::Sample"]).result:l=_r.substitute(l,"//VTK::Image::Sample",["    var computedColor: vec4<f32> =","      textureSampleLevel(imgTexture, clampSampler, input.tcoordVS, 0.0);","//VTK::Image::Sample"]).result,l=_r.substitute(l,"//VTK::Image::Sample",["    var coord: vec2<f32> =","      vec2<f32>(computedColor.r * mapperUBO.cScale.r + mapperUBO.cShift.r, 0.5);","    computedColor = textureSampleLevel(tfunTexture, clampSampler, coord, 0.0);"]).result,s.setCode(l)},r.set("replaceShaderImage",t.replaceShaderImage)}const E4e={rowLength:1024};function _4e(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,E4e,n),M6.extend(t,e,n),t.setFragmentShaderTemplate(C4e),e.UBO=Wg.newInstance({label:"mapperUBO"}),e.UBO.addEntry("SCTCMatrix","mat4x4<f32>"),e.UBO.addEntry("Origin","vec4<f32>"),e.UBO.addEntry("Axis2","vec4<f32>"),e.UBO.addEntry("Axis1","vec4<f32>"),e.UBO.addEntry("cScale","vec4<f32>"),e.UBO.addEntry("cShift","vec4<f32>"),e.lutBuildTime={},$r(e.lutBuildTime,{mtime:0}),e.imagemat=sn(new Float64Array(16)),e.imagematinv=sn(new Float64Array(16)),e.VBOBuildTime={},$r(e.VBOBuildTime),T4e(t,e)}const D4e=Zn(_4e,"vtkWebGPUImageMapper");Ul("vtkImageMapper",D4e);function O4e(t,e){e.classHierarchy.push("vtkWebGPUImageSlice"),t.buildPass=n=>{if(!(!e.renderable||!e.renderable.getVisibility())&&n){if(!e.renderable)return;e.WebGPURenderer=t.getFirstAncestorOfType("vtkWebGPURenderer"),e.WebGPURenderWindow=e.WebGPURenderer.getFirstAncestorOfType("vtkWebGPURenderWindow"),e.propID===void 0&&(e.propID=e.WebGPURenderWindow.getUniquePropID()),t.prepareNodes(),t.addMissingNode(e.renderable.getMapper()),t.removeUnusedNodes()}},t.traverseOpaquePass=n=>{!e.renderable||!e.renderable.getNestedVisibility()||!e.renderable.getIsOpaque()||e.WebGPURenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(n,!0),e.children.forEach(r=>{r.traverse(n)}),t.apply(n,!1))},t.traverseTranslucentPass=n=>{!e.renderable||!e.renderable.getNestedVisibility()||e.renderable.getIsOpaque()||e.WebGPURenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(n,!0),e.children.forEach(r=>{r.traverse(n)}),t.apply(n,!1))},t.queryPass=(n,r)=>{if(n){if(!e.renderable||!e.renderable.getVisibility())return;e.renderable.getIsOpaque()?r.incrementOpaqueActorCount():r.incrementTranslucentActorCount()}},t.getBufferShift=n=>(t.getKeyMatrices(n),e.bufferShift),t.getKeyMatrices=n=>{if(Math.max(e.renderable.getMTime(),n.getStabilizedTime())>e.keyMatricesTime.getMTime()){e.renderable.computeMatrix();const r=e.renderable.getMatrix(),i=n.getStabilizedCenterByReference();e.bufferShift[0]=r[3]-i[0],e.bufferShift[1]=r[7]-i[1],e.bufferShift[2]=r[11]-i[2],Gn(e.keyMatrices.bcwc,r),e.renderable.getIsIdentity()?sn(e.keyMatrices.normalMatrix):(Ei(e.keyMatrices.normalMatrix,e.keyMatrices.bcwc),e.keyMatrices.normalMatrix[3]=0,e.keyMatrices.normalMatrix[7]=0,e.keyMatrices.normalMatrix[11]=0,ba(e.keyMatrices.normalMatrix,e.keyMatrices.normalMatrix),Gn(e.keyMatrices.normalMatrix,e.keyMatrices.normalMatrix)),si(e.keyMatrices.bcwc,e.keyMatrices.bcwc,[-e.bufferShift[0],-e.bufferShift[1],-e.bufferShift[2]]),si(e.keyMatrices.bcsc,e.keyMatrices.bcwc,[-i[0],-i[1],-i[2]]),e.keyMatricesTime.modified()}return e.keyMatrices}}const M4e={bufferShift:void 0,keyMatrixTime:null,keyMatrices:null,propID:void 0};function I4e(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,M4e,n),Rr.extend(t,e,n),e.keyMatricesTime={},$r(e.keyMatricesTime,{mtime:0}),e.keyMatrices={normalMatrix:new Float64Array(16),bcwc:new Float64Array(16),bcsc:new Float64Array(16)},e.keyMatrixTime={},$r(e.keyMatrixTime,{mtime:0}),e.keyMatrices={mcwc:sn(new Float64Array(16))},e.bufferShift=[0,0,0,0],Po(t,e,["propID","keyMatricesTime"]),O4e(t,e)}const R4e=Zn(I4e,"vtkWebGPUImageSlice");Ul("vtkImageSlice",R4e);function A4e(t,e){e.classHierarchy.push("vtkWebGPUVolume"),t.buildPass=i=>{!e.renderable||!e.renderable.getVisibility()||i&&(e.WebGPURenderer=t.getFirstAncestorOfType("vtkWebGPURenderer"),e.WebGPURenderWindow=e.WebGPURenderer.getFirstAncestorOfType("vtkWebGPURenderWindow"),e.propID===void 0&&(e.propID=e.WebGPURenderWindow.getUniquePropID()),e.renderable.getMapper().update())},t.queryPass=(i,a)=>{if(i){if(!e.renderable||!e.renderable.getVisibility())return;const o=e.renderable.getMapper().getBounds();if(!o||o.length!==6||o[0]>o[1])return;a.addVolume(t)}};const n=new Float64Array(3),r=new Float64Array(3);t.getBoundingCubePoints=(i,a)=>{const o=e.renderable.getMapper().getInputData();if(!o)return;const s=o.getExtent(),l=e.renderable.getMatrix();let c=0;for(let f=4;f<6;f++){n[2]=s[f];for(let u=2;u<4;u++){n[1]=s[u];for(let d=0;d<2;d++){n[0]=s[d],o.indexToWorld(n,r);let h=a+c*3;i[h++]=l[0]*r[0]+l[1]*r[1]+l[2]*r[2]+l[3],i[h++]=l[4]*r[0]+l[5]*r[1]+l[6]*r[2]+l[7],i[h++]=l[8]*r[0]+l[9]*r[1]+l[10]*r[2]+l[11],c++}}}},t.getKeyMatrices=i=>{if(Math.max(e.renderable.getMTime(),i.getStabilizedTime())>e.keyMatricesTime.getMTime()){e.renderable.computeMatrix();const a=e.renderable.getMatrix(),o=i.getStabilizedCenterByReference();Gn(e.keyMatrices.bcwc,a),si(e.keyMatrices.bcsc,e.keyMatrices.bcwc,[-o[0],-o[1],-o[2]]),e.keyMatricesTime.modified()}return e.keyMatrices}}const P4e={propID:void 0,keyMatricesTime:null};function N4e(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,P4e,n),Rr.extend(t,e,n),e.keyMatricesTime={},le.obj(e.keyMatricesTime,{mtime:0}),e.keyMatrices={bcwc:new Float64Array(16),bcsc:new Float64Array(16)},le.get(t,e,["propID","keyMatricesTime"]),A4e(t,e)}const L4e=le.newInstance(N4e,"vtkWebGPUVolume");Ul("vtkVolume",L4e);function k4e(t,e){e.classHierarchy.push("vtkWebGPUPixelSpaceCallbackMapper"),t.opaquePass=(n,r)=>{e.WebGPURenderer=t.getFirstAncestorOfType("vtkWebGPURenderer"),e.WebGPURenderWindow=e.WebGPURenderer.getParent();const i=e.WebGPURenderer.getAspectRatio(),a=e.WebGPURenderer?e.WebGPURenderer.getRenderable().getActiveCamera():null,o=e.WebGPURenderer.getTiledSizeAndOrigin(),s=null;e.renderable.getUseZValues(),e.renderable.invokeCallback(e.renderable.getInputData(),a,i,o,s)}}const V4e={};function F4e(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,V4e,n),Rr.extend(t,e,n),k4e(t,e)}const U4e=le.newInstance(F4e,"vtkWebGPUPixelSpaceCallbackMapper");Ul("vtkPixelSpaceCallbackMapper",U4e);const ic={UNCHANGED:0,SINGLE_POINT:1,X_LINE:2,Y_LINE:3,Z_LINE:4,XY_PLANE:5,YZ_PLANE:6,XZ_PLANE:7,XYZ_GRID:8,EMPTY:9};var _X={StructuredType:ic};const{StructuredType:tf}=_X;function B4e(t){let e=0;for(let n=0;n<3;++n)t[n*2]<t[n*2+1]&&e++;return t[0]>t[1]||t[2]>t[3]||t[4]>t[5]?tf.EMPTY:e===3?tf.XYZ_GRID:e===2?t[0]===t[1]?tf.YZ_PLANE:t[2]===t[3]?tf.XZ_PLANE:tf.XY_PLANE:e===1?t[0]<t[1]?tf.X_LINE:t[2]<t[3]?tf.Y_LINE:tf.Z_LINE:tf.SINGLE_POINT}var $4e={getDataDescriptionFromExtent:B4e,..._X};const{vtkErrorMacro:q0}=le;function G4e(t,e){e.classHierarchy.push("vtkImageData"),t.setExtent=function(){if(e.deleted)return q0("instance deleted - cannot call any method"),!1;for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];const a=r.length===1?r[0]:r;if(a.length!==6)return!1;const o=e.extent.some((s,l)=>s!==a[l]);return o&&(e.extent=a.slice(),e.dataDescription=$4e.getDataDescriptionFromExtent(e.extent),t.modified()),o},t.setDimensions=function(){let n,r,i;if(e.deleted){q0("instance deleted - cannot call any method");return}if(arguments.length===1){const a=arguments.length<=0?void 0:arguments[0];n=a[0],r=a[1],i=a[2]}else if(arguments.length===3)n=arguments.length<=0?void 0:arguments[0],r=arguments.length<=1?void 0:arguments[1],i=arguments.length<=2?void 0:arguments[2];else{q0("Bad dimension specification");return}t.setExtent(0,n-1,0,r-1,0,i-1)},t.getDimensions=()=>[e.extent[1]-e.extent[0]+1,e.extent[3]-e.extent[2]+1,e.extent[5]-e.extent[4]+1],t.getNumberOfCells=()=>{const n=t.getDimensions();let r=1;for(let i=0;i<3;i++){if(n[i]===0)return 0;n[i]>1&&(r*=n[i]-1)}return r},t.getNumberOfPoints=()=>{const n=t.getDimensions();return n[0]*n[1]*n[2]},t.getPoint=n=>{const r=t.getDimensions();if(r[0]===0||r[1]===0||r[2]===0)return q0("Requesting a point from an empty image."),null;const i=new Float64Array(3);switch(e.dataDescription){case ic.EMPTY:return null;case ic.SINGLE_POINT:break;case ic.X_LINE:i[0]=n;break;case ic.Y_LINE:i[1]=n;break;case ic.Z_LINE:i[2]=n;break;case ic.XY_PLANE:i[0]=n%r[0],i[1]=n/r[0];break;case ic.YZ_PLANE:i[1]=n%r[1],i[2]=n/r[1];break;case ic.XZ_PLANE:i[0]=n%r[0],i[2]=n/r[0];break;case ic.XYZ_GRID:i[0]=n%r[0],i[1]=n/r[0]%r[1],i[2]=n/(r[0]*r[1]);break;default:q0("Invalid dataDescription");break}const a=[0,0,0];return t.indexToWorld(i,a),a},t.getBounds=()=>t.extentToBounds(t.getSpatialExtent()),t.extentToBounds=n=>wr.transformBounds(n,e.indexToWorld),t.getSpatialExtent=()=>wr.inflate([...e.extent],.5),t.computeTransforms=()=>{eD(e.indexToWorld,e.origin),e.indexToWorld[0]=e.direction[0],e.indexToWorld[1]=e.direction[1],e.indexToWorld[2]=e.direction[2],e.indexToWorld[4]=e.direction[3],e.indexToWorld[5]=e.direction[4],e.indexToWorld[6]=e.direction[5],e.indexToWorld[8]=e.direction[6],e.indexToWorld[9]=e.direction[7],e.indexToWorld[10]=e.direction[8],p0(e.indexToWorld,e.indexToWorld,e.spacing),ba(e.worldToIndex,e.indexToWorld)},t.indexToWorld=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return $n(r,n,e.indexToWorld),r},t.indexToWorldVec3=t.indexToWorld,t.worldToIndex=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return $n(r,n,e.worldToIndex),r},t.worldToIndexVec3=t.worldToIndex,t.indexToWorldBounds=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return wr.transformBounds(n,e.indexToWorld,r)},t.worldToIndexBounds=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return wr.transformBounds(n,e.worldToIndex,r)},t.onModified(t.computeTransforms),t.computeTransforms(),t.getCenter=()=>wr.getCenter(t.getBounds()),t.computeHistogram=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const i=[0,0,0,0,0,0];t.worldToIndexBounds(n,i);const a=[0,0,0],o=[0,0,0];wr.computeCornerPoints(i,a,o),c6(a,a),c6(o,o);const s=t.getDimensions();f6(a,[0,0,0],[s[0]-1,s[1]-1,s[2]-1],a),f6(o,[0,0,0],[s[0]-1,s[1]-1,s[2]-1],o);const l=s[0],c=s[0]*s[1],f=t.getPointData().getScalars().getData();let u=-1/0,d=1/0,h=0,p=0,g=0;for(let x=a[2];x<=o[2];x++)for(let w=a[1];w<=o[1];w++){let S=a[0]+w*l+x*c;for(let T=a[0];T<=o[0];T++){if(!r||r([T,w,x],i)){const _=f[S];_>u&&(u=_),_<d&&(d=_),h+=_*_,p+=_,g+=1}++S}}const m=g>0?p/g:0,y=g?Math.abs(h/g-m*m):0,v=Math.sqrt(y);return{minimum:d,maximum:u,average:m,variance:y,sigma:v,count:g}},t.computeIncrements=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const i=[];let a=r;for(let o=0;o<3;++o)i[o]=a,a*=n[o*2+1]-n[o*2]+1;return i},t.computeOffsetIndex=n=>{let[r,i,a]=n;const o=t.getExtent(),s=t.getPointData().getScalars().getNumberOfComponents(),l=t.computeIncrements(o,s);return Math.floor((Math.round(r)-o[0])*l[0]+(Math.round(i)-o[2])*l[1]+(Math.round(a)-o[4])*l[2])},t.getOffsetIndexFromWorld=n=>{const r=t.getExtent(),i=t.worldToIndex(n);for(let a=0;a<3;++a)if(i[a]<r[a*2]||i[a]>r[a*2+1])return q0(`GetScalarPointer: Pixel ${i} is not in memory. Current extent = ${r}`),NaN;return t.computeOffsetIndex(i)},t.getScalarValueFromWorld=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const i=t.getPointData().getScalars().getNumberOfComponents();if(r<0||r>=i)return q0(`GetScalarPointer: Scalar Component ${r} is not within bounds. Current Scalar numberOfComponents: ${i}`),NaN;const a=t.getOffsetIndexFromWorld(n);return Number.isNaN(a)?a:t.getPointData().getScalars().getComponent(a,r)}}const j4e={direction:null,indexToWorld:null,worldToIndex:null,spacing:[1,1,1],origin:[0,0,0],extent:[0,-1,0,-1,0,-1],dataDescription:ic.EMPTY};function DX(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,j4e,n),Lm.extend(t,e,n),e.direction?Array.isArray(e.direction)&&(e.direction=new Float64Array(e.direction.slice(0,9))):e.direction=Ll(new Float64Array(9)),e.indexToWorld=new Float64Array(16),e.worldToIndex=new Float64Array(16),le.get(t,e,["indexToWorld","worldToIndex"]),le.setGetArray(t,e,["origin","spacing"],3),le.setGetArray(t,e,["direction"],9),le.getArray(t,e,["extent"],6),G4e(t,e)}const z4e=le.newInstance(DX,"vtkImageData");var Zw={newInstance:z4e,extend:DX};const UL=[[0,-1,0],[0,1,0],[0,0,-1],[0,0,1]],BL=[[0,-1,0],[0,1,0]],W4e=[[0,-1,0],[0,1,0],[0,0,-1]],H4e=[[0,-1,0],[0,1,0],[0,0,1]];var im;let dg=(im=class{static copyMap(e,n){for(const[r,i]of n.rows)e.rows.set(r,structuredClone(i))}constructor(e,n,r=1){this.rows=new Map,this.height=1,this.width=1,this.depth=1,this.jMultiple=1,this.kMultiple=1,this.numComps=1,this.pixelDataConstructor=Uint8Array,this.updateScalarData=function(i){i.fill(0);const a=(o,s,l)=>{const{start:c,end:f,value:u}=s;for(let d=c;d<f;d++)i[o+d]=u};this.forEach(a)},this.get=i=>{const a=i%this.jMultiple,o=(i-a)/this.jMultiple;return this.getRLE(a,o)?.value??this.defaultValue},this.getRun=(i,a)=>{const o=i+a*this.height;return this.rows.get(o)},this.set=(i,a)=>{if(a===void 0)return;const o=i%this.width,s=(i-o)/this.width,l=this.rows.get(s);if(!l){this.rows.set(s,[{start:o,end:o+1,value:a}]);return}const c=this.findIndex(l,o),f=l[c],u=l[c-1];if(!f){if(!u||u.value!==a||u.end!==o){l[c]={start:o,end:o+1,value:a};return}u.end++;return}const{start:d,end:h,value:p}=f;if(a===p&&o>=d)return;const g={start:o,end:o+1,value:a},m=o>d,y=m?c+1:c,v=m?f:u;let x=m?l[c+1]:f;if(v?.value===a&&v?.end===o){v.end++,x?.value===a&&x.start===o+1?(v.end=x.end,l.splice(c,1)):x?.start===o&&(x.start++,x.start===x.end&&(l.splice(c,1),x=l[c],x?.start===o+1&&x.value===a&&(v.end=x.end,l.splice(c,1))));return}if(x?.value===a&&x.start===o+1){x.start--,v?.end>o&&(v.end=o,v.end===v.start&&l.splice(c,1));return}if(x?.start===o&&x.end===o+1){x.value=a;const w=l[c+1];w?.start==o+1&&w.value===a&&(l.splice(c+1,1),x.end=w.end);return}o===x?.start&&x.start++,m&&h>o+1?l.splice(y,0,g,{start:o+1,end:v.end,value:v.value}):l.splice(y,0,g),v?.end>o&&(v.end=o)},this.width=e,this.height=n,this.depth=r,this.jMultiple=e,this.kMultiple=this.jMultiple*n}toIJK(e){const n=e%this.jMultiple,r=(e-n)/this.jMultiple%this.height,i=Math.floor(e/this.kMultiple);return[n,r,i]}toIndex([e,n,r]){return e+r*this.kMultiple+n*this.jMultiple}getRLE(e,n,r=0){const i=this.rows.get(n+r*this.height);if(!i)return;const a=this.findIndex(i,e),o=i[a];return e>=o?.start?o:void 0}has(e){const n=e%this.jMultiple,r=(e-n)/this.jMultiple;return this.getRLE(n,r)?.value!==void 0}delete(e){const n=e%this.width,r=(e-n)/this.width,i=this.rows.get(r);if(!i)return;const a=this.findIndex(i,n),o=i[a];if(!o||o.start>n)return;if(o.end===n+1){o.end--,o.start>=o.end&&(i.splice(a,1),i.length||this.rows.delete(r));return}if(o.start===n){o.start++;return}const s={value:o.value,start:n+1,end:o.end};o.end=n,i.splice(a+1,0,s)}findIndex(e,n){for(let r=0;r<e.length;r++){const{end:i}=e[r];if(n<i)return r}return e.length}forEach(e,n){const r=n?.rowModified;for(const[i,a]of this.rows){const o=r?[...a]:a;for(const s of o)e(i*this.width,s,a)}}forEachRow(e){for(const[n,r]of this.rows)e(n*this.width,r)}clear(){this.rows.clear()}keys(){return[...this.rows.keys()]}getPixelData(e=0,n){n?n.fill(0):n=new this.pixelDataConstructor(this.width*this.height*this.numComps);const{width:r,height:i,numComps:a}=this;for(let o=0;o<i;o++){const s=this.getRun(o,e);if(s)if(a===1)for(const l of s){const c=o*r,{start:f,end:u,value:d}=l;for(let h=f;h<u;h++)n[c+h]=d}else for(const l of s){const c=o*r*a,{start:f,end:u,value:d}=l;for(let h=f;h<u;h+=a)for(let p=0;p<a;p++)n[c+h+p]=d[p]}}return n}floodFill(e,n,r,i,a){const o=this.getRLE(e,n,r);if(!o)throw new Error(`Initial point ${e},${n},${r} isn't in the RLE`);const s=[[o,n,r]],l=o.value;if(l===i)throw new Error(`source (${l}) and destination (${i}) are identical`);return this.flood(s,l,i,a)}flood(e,n,r,i){let a=0;const{planar:o=!0,diagonals:s=!0,singlePlane:l=!1}=i||{},c={planar:o,diagonals:s,singlePlane:l};for(;e.length;){const f=e.pop(),[u]=f;if(u.value!==n)continue;u.value=r,a+=u.end-u.start;const d=this.findAdjacents(f,c).filter(h=>h&&h[0].value===n);e.push(...d)}return a}fillFrom(e,n){for(let r=n[2][0];r<=n[2][1];r++)for(let i=n[1][0];i<=n[1][1];i++){let a,o;for(let s=n[0][0];s<=n[0][1];s++){const l=e(s,i,r);if(l===void 0){a=void 0;continue}o||(o=[],this.rows.set(i+r*this.height,o)),a&&a.value!==l&&(a=void 0),a||(a={start:s,end:s,value:l},o.push(a)),a.end++}}}findAdjacents(e,{diagonals:n=!0,planar:r=!0,singlePlane:i=!1}){const[a,o,s,l]=e,{start:c,end:f}=a,u=c>0&&this.getRLE(c-1,o,s),d=f<this.width&&this.getRLE(f,o,s),h=n?[c>0?c-1:c,f<this.width?f+1:f]:[c,f],p=[];u&&p.push([u,o,s]),d&&p.push([d,o,s]);for(const g of l||(i?BL:UL)){const[,m,y]=g,v=m+o,x=y+s;if(v<0||v>=this.height||x<0||x>=this.depth)continue;const w=this.getRun(v,x);if(w)for(const S of w){const T=l||i&&BL||r&&y>0&&H4e||r&&y<0&&W4e||UL;S.end<=h[0]||S.start>=h[1]||p.push([S,v,x,T])}}return p}},im.getScalarData=function(e=Uint8ClampedArray){const n=new e(this.frameSize);return this.map.updateScalarData(n),n},im),mb=class wv{constructor(e={}){this._dimensions=3,this._length=0,this._byteSize=4,this.growSize=128;const{initialSize:n=1024,dimensions:r=3,growSize:i=128}=e,a=n*r;this.growSize=i,this.array=new ArrayBuffer(a*this._byteSize),this.data=new Float32Array(this.array),this._dimensions=r}forEach(e){for(let n=0;n<this._length;n++)e(this.getPoint(n),n)}get length(){return this._length}get dimensions(){return this._dimensions}get dimensionLength(){return this._length*this._dimensions}getPoint(e){if(e<0&&(e+=this._length),e<0||e>=this._length)return;const n=this._dimensions*e;return this.data.subarray(n,n+this._dimensions)}getPointArray(e){const n=[];if(e<0&&(e+=this._length),e<0||e>=this._length)return;const r=this._dimensions*e;for(let i=0;i<this._dimensions;i++)n.push(this.data[i+r]);return n}grow(e=1,n=this.growSize){if(this.dimensionLength+e*this._dimensions<=this.data.length)return;const r=this.data.length+n,i=new ArrayBuffer(r*this._dimensions*this._byteSize),a=new Float32Array(i);a.set(this.data),this.data=a,this.array=i}reverse(){const e=Math.floor(this._length/2);for(let n=0;n<e;n++){const r=n*this._dimensions,i=(this._length-1-n)*this._dimensions;for(let a=0;a<this._dimensions;a++){const o=this.data[r+a];this.data[r+a]=this.data[i+a],this.data[i+a]=o}}}getTypedArray(){return this.data}push(e){this.grow(1);const n=this.length*this._dimensions;for(let r=0;r<this._dimensions;r++)this.data[r+n]=e[r];this._length++}map(e){const n=[];for(let r=0;r<this._length;r++)n.push(e(this.getPoint(r),r));return n}get points(){return this.map(e=>e)}toXYZ(){const e={x:[],y:[]};this._dimensions>=3&&(e.z=[]);const{x:n,y:r,z:i}=e;return this.forEach(a=>{n.push(a[0]),r.push(a[1]),i&&i.push(a[2])}),e}static fromXYZ({x:e,y:n,z:r}){const i=wv.create3(e.length);let a=0;for(let o=0;o<e.length;o++)i.data[a++]=e[o],i.data[a++]=n[o],i.data[a++]=r?r[o]:0;return i._length=e.length,i}subselect(e=10,n=0){const r=new wv({initialSize:e,dimensions:this._dimensions});for(let i=0;i<e;i++){const a=(n+Math.floor(this.length*i/e))%this.length;r.push(this.getPoint(a))}return r}static create3(e=128,n){e=Math.max(e,n?.length||0);const r=new wv({initialSize:e,dimensions:3});return n&&n.forEach(i=>r.push(i)),r}static create2(e=128){return new wv({initialSize:e,dimensions:2})}};function OX(t){const e=ct(),n=t.getDimensions(),r=mb.create3(n[0]),i=mb.create3(n[1]),a=mb.create3(n[2]),o=t.getDirection(),s=o.slice(0,3),l=o.slice(3,6),c=o.slice(6,9),f=t.getSpacing(),[u,d,h]=f,p=t.indexToWorld([0,0,0]),g=En(s[0]*u,s[1]*u,s[2]*u),m=En(l[0]*d,l[1]*d,l[2]*d),y=En(c[0]*h,c[1]*h,c[2]*h),v=ct();for(let T=0;T<n[0];T++)r.push(Nl(v,p,Xs(v,g,T)));for(let T=0;T<n[1];T++)i.push(Xs(v,m,T));for(let T=0;T<n[2];T++)a.push(Xs(v,y,T));const x=r.getTypedArray(),w=i.getTypedArray(),S=a.getTypedArray();return(T,_=e)=>{const[D,I,R]=T,M=D*3,A=I*3,L=R*3;return _[0]=x[M]+w[A]+S[L],_[1]=x[M+1]+w[A+1]+S[L+1],_[2]=x[M+2]+w[A+2]+S[L+2],_}}function xD(t,e){const{pointInShapeFn:n,callback:r,boundsIJK:i,returnPoints:a=!1}=e;let o;if(t.getScalarData)o=t.getScalarData();else{const u=t.getPointData().getScalars();if(u)o=u.getData();else{const{voxelManager:d}=t.get("voxelManager")||{};d&&(o=d.getCompleteScalarDataArray())}}const s=t.getDimensions(),l=[[0,s[0]],[0,s[1]],[0,s[2]]],f=K4e({imageData:t,bounds:i||l,scalarData:o,pointInShapeFn:n,callback:r});return a?f:void 0}function K4e({imageData:t,bounds:e,scalarData:n,pointInShapeFn:r,callback:i}){const[[a,o],[s,l],[c,f]]=e,{numComps:u}=t,d=t.getDimensions(),h=OX(t),p=[0,0,0],g=u||n.length/d[2]/d[1]/d[0],m=d[0]*g,y=d[1]*m,v=[];for(let x=c;x<=f;x++){p[2]=x;const w=x*y;for(let S=s;S<=l;S++){p[1]=S;const T=w+S*m;for(let _=a;_<=o;_++){p[0]=_;const D=h(p);if(r(D,p)){const I=T+_*g;let R;g>2?R=[n[I],n[I+1],n[I+2]]:R=n[I],v.push({value:R,index:I,pointIJK:p,pointLPS:D.slice()}),i({value:R,index:I,pointIJK:p,pointLPS:D})}}}}return v}function q4e({voxelManager:t,bounds:e,imageData:n,pointInShapeFn:r,callback:i,returnPoints:a}){const[[o,s],[l,c],[f,u]]=e,d=OX(n),h=[0,0,0],p=[];for(let g=f;g<=u;g++){h[2]=g;for(let m=l;m<=c;m++){h[1]=m;for(let y=o;y<=s;y++){h[0]=y;const v=d(h);if(r(v,h)){const x=t.toIndex(h),w=t.getAtIndex(x);a&&p.push({value:w,index:x,pointIJK:[...h],pointLPS:v.slice()}),i?.({value:w,index:x,pointIJK:h,pointLPS:v})}}}}return p}const X4e=5*1024;let g0=class ha{get id(){return this._id}constructor(e,n){this.modifiedSlices=new Set,this.boundsIJK=[[1/0,-1/0],[1/0,-1/0],[1/0,-1/0]],this.scalarData=null,this._sliceDataCache=null,this.getAtIJK=(r,i,a)=>{const o=this.toIndex([r,i,a]);return this._get(o)},this.setAtIJK=(r,i,a,o)=>{const s=this.toIndex([r,i,a]),l=this._set(s,o);return l!==!1&&(this.modifiedSlices.add(a),ha.addBounds(this.boundsIJK,[r,i,a])),l},this.getAtIJKPoint=([r,i,a])=>this.getAtIJK(r,i,a),this.setAtIJKPoint=([r,i,a],o)=>{this.setAtIJK(r,i,a,o)},this.getAtIndex=r=>this._get(r),this.setAtIndex=(r,i)=>{const a=this._set(r,i);if(a!==!1){const o=this.toIJK(r);this.modifiedSlices.add(o[2]),ha.addBounds(this.boundsIJK,o)}return a},this.getMiddleSliceData=()=>{const r=Math.floor(this.dimensions[2]/2);return this.getSliceData({sliceIndex:r,slicePlane:2})},this.forEach=(r,i={})=>{const a=i.boundsIJK||this.getBoundsIJK(),o=i.isInObject||this.isInObject||(()=>!0),s=i.returnPoints||!1,l=i.imageData,c=Math.min(a[0][0],a[0][1]),f=Math.max(a[0][0],a[0][1]),u=Math.min(a[1][0],a[1][1]),d=Math.max(a[1][0],a[1][1]),h=Math.min(a[2][0],a[2][1]),p=Math.max(a[2][0],a[2][1]),g=[];if(l)return q4e({voxelManager:this,imageData:i.imageData,bounds:[[c,f],[u,d],[h,p]],pointInShapeFn:o,callback:r,returnPoints:s});if(this.map){if(this.map instanceof dg)return this.rleForEach(r,i);for(const m of this.map.keys()){const y=this.toIJK(m);if(!o(null,y))continue;const v=this._get(m);s&&g.push({value:v,index:m,pointIJK:y,pointLPS:null}),r({value:v,index:m,pointIJK:y,pointLPS:null})}return g}else{for(let m=h;m<=p;m++){const y=m*this.frameSize;for(let v=u;v<=d;v++){const x=y+v*this.width;for(let w=c,S=x+w;w<=f;w++,S++){const T=this.getAtIndex(S),_=[w,v,m];o(null,_)&&(s&&g.push({value:T,index:S,pointIJK:_,pointLPS:null}),r({value:T,index:S,pointIJK:[w,v,m],pointLPS:null}))}}}return g}},this.getSliceData=({sliceIndex:r,slicePlane:i})=>{const[a,o,s]=this.dimensions,l=a*o,c=r*l;let f;const u=this.getConstructor();function d(p){return typeof p=="function"}if(!d(u))return new Uint8Array(0);let h;switch(i){case 0:f=o*s,h=new u(f);for(let p=0;p<o;p++)for(let g=0;g<s;g++){const m=r+p*a+g*l;this.setSliceDataValue(h,p*s+g,this._get(m))}break;case 1:f=a*s,h=new u(f);for(let p=0;p<a;p++)for(let g=0;g<s;g++){const m=p+r*a+g*l;this.setSliceDataValue(h,p+g*a,this._get(m))}break;case 2:f=a*o,h=new u(f);for(let p=0;p<f;p++)this.setSliceDataValue(h,p,this._get(c+p));break;default:throw new Error("Oblique plane - todo - implement as ortho normal vector")}return h},this.dimensions=e,this.width=e[0],this.frameSize=this.width*e[1],this._get=n._get,this._set=n._set,this._id=n._id||"",this._getConstructor=n._getConstructor,this.numberOfComponents=this.numberOfComponents||1,this.scalarData=n.scalarData,this._getScalarData=n._getScalarData,this._updateScalarData=n._updateScalarData}getMinMax(){let e,n;const r=({value:i})=>{const a=Array.isArray(i);if(e===void 0&&(e=a?[...i]:i,n=a?[...i]:i),a)for(let o=0;o<i.length;o++)e[o]=Math.min(e[o],i[o]),n[o]=Math.max(n[o],i[o]);else e=Math.min(e,i),n=Math.max(n,i)};return this.forEach(r,{boundsIJK:this.getDefaultBounds()}),{min:e,max:n}}toIJK(e){return[e%this.width,Math.floor(e%this.frameSize/this.width),Math.floor(e/this.frameSize)]}toIndex(e){return e[0]+e[1]*this.width+e[2]*this.frameSize}getDefaultBounds(){return this.dimensions.map(e=>[0,e-1])}getBoundsIJK(){return this.boundsIJK[0][0]<this.dimensions[0]?this.boundsIJK:this.getDefaultBounds()}rleForEach(e,n){const r=n?.boundsIJK||this.getBoundsIJK(),{isWithinObject:i}=n||{},a=this.map;if(!a){console.warn("No map found, you need to use a map voxel manager to use rleForEach");return}a.defaultValue=void 0;for(let o=r[2][0];o<=r[2][1];o++)for(let s=r[1][0];s<=r[1][1];s++){const l=a.getRun(s,o);if(l)for(const c of l){const{start:f,end:u,value:d}=c,h=this.toIndex([0,s,o]);for(let p=f;p<u;p++){const g={value:d,index:h+p,pointIJK:[p,s,o]};i?.(g)!==!1&&e(g)}}}}getScalarData(e=!1){if(this.scalarData)return this._updateScalarData?.(this.scalarData),this.scalarData;if(this._getScalarData){const n=this._getScalarData();return e&&console.log("Not transient, should store value",n),n}throw new Error("No scalar data available")}setScalarData(e){this.scalarData=e}getScalarDataLength(){if(this.scalarData)return this.scalarData.length;if(this._getScalarDataLength)return this._getScalarDataLength();throw new Error("No scalar data available")}get sizeInBytes(){return this.getScalarDataLength()*this.bytePerVoxel}get bytePerVoxel(){return this.scalarData?this.scalarData.BYTES_PER_ELEMENT:this._get(0).BYTES_PER_ELEMENT}clearBounds(){this.boundsIJK.map(e=>{e[0]=1/0,e[1]=-1/0})}clear(){this.map?.clear(),this.clearBounds(),this.modifiedSlices.clear(),this.points?.clear()}getConstructor(){return this.scalarData?this.scalarData.constructor:this._getConstructor?this._getConstructor():(console.warn("No scalar data available or can be used to get the constructor"),Float32Array)}getArrayOfModifiedSlices(){return Array.from(this.modifiedSlices)}resetModifiedSlices(){this.modifiedSlices.clear()}setBounds(e){this.boundsIJK=e}static addBounds(e,n){e||(e=[[1/0,-1/0],[1/0,-1/0],[1/0,-1/0]]),e[0][0]=Math.min(n[0],e[0][0]),e[0][1]=Math.max(n[0],e[0][1]),e[1][0]=Math.min(n[1],e[1][0]),e[1][1]=Math.max(n[1],e[1][1]),e[2][0]=Math.min(n[2],e[2][0]),e[2][1]=Math.max(n[2],e[2][1])}addPoint(e){const n=Array.isArray(e)?e[0]+this.width*e[1]+this.frameSize*e[2]:e;this.points||(this.points=new Set),this.points.add(n)}getPoints(){return this.points?[...this.points].map(e=>this.toIJK(e)):[]}setSliceDataValue(e,n,r){if(Array.isArray(r))for(let i=0;i<r.length;i++)e[n*r.length+i]=this.toNumber(r[i]);else e[n]=this.toNumber(r)}toNumber(e){return typeof e=="number"?e:Array.isArray(e)&&e[0]||0}static _createRGBScalarVolumeVoxelManager({dimensions:e,scalarData:n,numberOfComponents:r=3,id:i}){const a=new ha(e,{_get:o=>(o*=r,[n[o++],n[o++],n[o++]]),_id:i||"_createRGBScalarVolumeVoxelManager",_set:(o,s)=>{o*=3;const l=!fr(n[o],s);return n[o++]=s[0],n[o++]=s[1],n[o++]=s[2],l},numberOfComponents:r,scalarData:n});return a.clear=()=>{n.fill(0)},a}static createImageVolumeVoxelManager({dimensions:e,imageIds:n,numberOfComponents:r=1,id:i}){const a=e[0]*e[1];function o(u){const d=Math.floor(u/a);if(d<0||d>=e[2])return{};const h=n[d];if(!h)return console.warn(`ImageId not found for sliceIndex: ${d}`),{pixelData:null,pixelIndex:null};const p=yt.getImage(h);if(!p)return console.warn(`Image not found for imageId: ${h}`),{pixelData:null,pixelIndex:null};const g=p.voxelManager,m=u%a;return{voxelManager:g,pixelIndex:m}}function s(u){const{voxelManager:d,pixelIndex:h}=o(u);return!d||h===null?null:d.getAtIndex(h)}function l(u,d){const{voxelManager:h,pixelIndex:p}=o(u);if(!h||p===null)return!1;const g=h.getAtIndex(p),m=!fr(d,g);return m&&(h.setAtIndex(p,d),!0)}const c=()=>{const{voxelManager:u,pixelIndex:d}=o(0);return!u||d===null?null:u.getConstructor()},f=new ha(e,{_get:s,_set:l,numberOfComponents:r,_getConstructor:c,_id:i||"createImageVolumeVoxelManager"});return f.getMiddleSliceData=()=>{const u=Math.floor(e[2]/2);return f.getSliceData({sliceIndex:u,slicePlane:2})},f.clear=()=>{for(const u of n)yt.getImage(u).voxelManager.clear()},f.getRange=()=>{let u=1/0,d=-1/0;for(const h of n){const p=yt.getImage(h);p&&(p.minPixelValue<u&&(u=p.minPixelValue),p.maxPixelValue>d&&(d=p.maxPixelValue))}return u===1/0&&d===-1/0?[0,0]:[u,d]},f._getScalarDataLength=()=>{const{voxelManager:u,pixelIndex:d}=o(0);return!u||d===null?0:u.getScalarDataLength()*e[2]},f.getCompleteScalarDataArray=()=>{const u=f._getConstructor();if(!u)return new Uint8Array(0);const d=f.getScalarDataLength(),h=new u(d),p=e[0]*e[1]*r;for(let g=0;g<e[2];g++){const{voxelManager:m,pixelIndex:y}=o(g*p/r);if(m&&y!==null){const v=g*p,x=m.getScalarData();if(r===1)h.set(x,v);else for(let w=0;w<x.length;w+=r)for(let S=0;S<r;S++)h[v+w+S]=x[w+S]}}return h},f.setCompleteScalarDataArray=u=>{const d=e[0]*e[1]*r,h=f._getConstructor();let p=1/0,g=-1/0;for(let m=0;m<e[2];m++){const{voxelManager:y}=o(m*d/r);if(y&&h){const v=m*d,x=v+d,w=new h(d);if(w.set(u.subarray(v,x)),y.scalarData)y.scalarData.set(w),y.modifiedSlices.add(m);else for(let _=0;_<d;_++)y.setAtIndex(_,w[_]);for(let _=0;_<w.length;_++){const D=w[_];p=Math.min(p,D),g=Math.max(g,D)}const S=n[m],T=yt.getImage(S);T&&(T.minPixelValue=p,T.maxPixelValue=g)}}for(let m=0;m<e[2];m++)f.modifiedSlices.add(m);f.boundsIJK=[[0,e[0]-1],[0,e[1]-1],[0,e[2]-1]]},f}static createScalarVolumeVoxelManager({dimensions:e,scalarData:n,numberOfComponents:r,id:i}){if(e.length!==3)throw new Error("Dimensions must be provided as [number, number, number] for [width, height, depth]");if(!r&&(r=n.length/e[0]/e[1]/e[2],r>4||r<1||r===2))throw new Error(`Number of components ${r} must be 1, 3 or 4`);return r>1?ha._createRGBScalarVolumeVoxelManager({dimensions:e,scalarData:n,numberOfComponents:r,id:i}):ha._createNumberVolumeVoxelManager({dimensions:e,scalarData:n,id:i})}static createScalarDynamicVolumeVoxelManager({imageIdGroups:e,dimensions:n,dimensionGroupNumber:r=1,timePoint:i=0,numberOfComponents:a=1,id:o}){let s=0;if(r!==void 0?s=r-1:i!==void 0&&(console.warn("Warning: timePoint parameter is deprecated. Please use dimensionGroupNumber instead. timePoint is zero-based while dimensionGroupNumber starts at 1."),s=i),!a){const f=yt.getImage(e[0][0]);if(!f)throw new Error("Unable to determine number of components: No image found");if(a=f.getPixelData().length/(n[0]*n[1]),a>4||a<1||a===2)throw new Error(`Number of components ${a} must be 1, 3 or 4`)}const l=e.map(f=>ha.createImageVolumeVoxelManager({dimensions:n,imageIds:f,numberOfComponents:a,id:o})),c=new ha(n,{_get:f=>l[s]._get(f),_set:(f,u)=>l[s]._set(f,u),numberOfComponents:a,_id:o||"createScalarDynamicVolumeVoxelManager"});return c.getScalarDataLength=()=>l[s].getScalarDataLength(),c.getConstructor=()=>l[s].getConstructor(),c.getRange=()=>l[s].getRange(),c.getMiddleSliceData=()=>l[s].getMiddleSliceData(),c.setTimePoint=f=>{console.warn("Warning: setTimePoint is deprecated. Please use setDimensionGroupNumber instead. Note that timePoint is zero-based while dimensionGroupNumber starts at 1."),c.setDimensionGroupNumber(f+1)},c.setDimensionGroupNumber=f=>{s=f-1,c._get=u=>l[s]._get(u),c._set=(u,d)=>l[s]._set(u,d)},c.getAtIndexAndTimePoint=(f,u)=>(console.warn("Warning: getAtIndexAndTimePoint is deprecated. Please use getAtIndexAndDimensionGroup instead. Note that timePoint is zero-based while dimensionGroupNumber starts at 1."),c.getAtIndexAndDimensionGroup(f,u+1)),c.getAtIndexAndDimensionGroup=(f,u)=>l[u-1]._get(f),c.getTimePointScalarData=f=>(console.warn("Warning: getTimePointScalarData is deprecated. Please use getDimensionGroupScalarData instead. Note that timePoint is zero-based while dimensionGroupNumber starts at 1."),c.getDimensionGroupScalarData(f+1)),c.getDimensionGroupScalarData=f=>l[f-1].getCompleteScalarDataArray(),c.getCurrentTimePointScalarData=()=>(console.warn("Warning: getCurrentTimePointScalarData is deprecated. Please use getCurrentDimensionGroupScalarData instead."),c.getCurrentDimensionGroupScalarData()),c.getCurrentDimensionGroupScalarData=()=>l[s].getCompleteScalarDataArray(),c.getCurrentTimePoint=()=>(console.warn("Warning: getCurrentTimePoint is deprecated. Please use getCurrentDimensionGroupNumber instead. Note that timePoint is zero-based while dimensionGroupNumber starts at 1."),s),c.getCurrentDimensionGroupNumber=()=>s+1,c}static createImageVoxelManager({width:e,height:n,scalarData:r,numberOfComponents:i=1,id:a}){const o=[e,n,1];if(!i&&(i=r.length/e/n,i>4||i<1||i===2))throw new Error(`Number of components ${i} must be 1, 3 or 4`);return i>1?ha._createRGBScalarVolumeVoxelManager({dimensions:o,scalarData:r,numberOfComponents:i,id:a}):ha._createNumberVolumeVoxelManager({dimensions:o,scalarData:r,id:a})}static _createNumberVolumeVoxelManager({dimensions:e,scalarData:n,id:r}){const i=new ha(e,{_get:a=>n[a],_set:(a,o)=>{const s=n[a]!==o;return n[a]=o,s},_getConstructor:()=>n.constructor,_id:r||"_createNumberVolumeVoxelManager"});return i.scalarData=n,i.clear=()=>{i.scalarData.fill(0)},i.getMiddleSliceData=()=>{const a=Math.floor(e[2]/2);return i.getSliceData({sliceIndex:a,slicePlane:2})},i}static createMapVoxelManager({dimension:e,id:n}){const r=new Map,i=new ha(e,{_get:r.get.bind(r),_set:(a,o)=>r.set(a,o)&&!0,_id:n||"createMapVoxelManager"});return i.map=r,i}static createHistoryVoxelManager(e,n){const r=new Map,{dimensions:i}=e,a=new ha(i,{_get:o=>r.get(o),_set:function(o,s){if(r.has(o))s===r.get(o)&&r.delete(o);else{const l=this.sourceVoxelManager.getAtIndex(o);if(l===s)return!1;r.set(o,l)}this.sourceVoxelManager.setAtIndex(o,s)},_id:n||"createHistoryVoxelManager"});return a.map=r,a.scalarData=e.scalarData,a.sourceVoxelManager=e,a}static createRLEHistoryVoxelManager(e,n){const{dimensions:r}=e,i=new dg(r[0],r[1],r[2]),a=new ha(r,{_get:o=>i.get(o),_set:function(o,s){const l=i.get(o);if(l===void 0){const c=this.sourceVoxelManager.getAtIndex(o);if(c===s||c===void 0&&s===0||s===null)return!1;i.set(o,c??0)}else(s===l||s===null)&&(i.delete(o),s=l);this.sourceVoxelManager.setAtIndex(o,s)},_getScalarData:dg.getScalarData,_updateScalarData:o=>(i.updateScalarData(o),o),_id:n||"createRLEHistoryVoxelManager"});return a.map=i,a.sourceVoxelManager=e,a}static createLazyVoxelManager({dimensions:e,planeFactory:n,id:r}){const i=new Map,[a,o]=e,s=a*o,l=new ha(e,{_get:c=>i.get(Math.floor(c/s))[c%s],_set:(c,f)=>{const u=Math.floor(c/s);let d=i.get(u);return d||(d=n(a,o),i.set(u,d)),d[c%s]=f,!0},_id:r||"createLazyVoxelManager"});return l.map=i,l}static createRLEVolumeVoxelManager({dimensions:e,id:n}){const[r,i,a]=e,o=new dg(r,i,a),s=new ha(e,{_get:l=>o.get(l),_set:(l,c)=>(o.set(l,c),!0),_getScalarData:dg.getScalarData,_updateScalarData:l=>(o.updateScalarData(l),l),_id:n||"createRLEVolumeVoxelManager"});return s.map=o,s.getPixelData=o.getPixelData.bind(o),s}static createRLEImageVoxelManager({dimensions:e,id:n}){const[r,i]=e;return ha.createRLEVolumeVoxelManager({dimensions:[r,i,1],id:n})}static addInstanceToImage(e){const{width:n,height:r}=e,i=e.voxelManager.getScalarData();if(i.length>=n*r){e.voxelManager=ha.createScalarVolumeVoxelManager({dimensions:[n,r,1],scalarData:i});return}e.voxelManager=ha.createRLEVolumeVoxelManager({dimensions:[n,r,1]}),e.getPixelData=e.voxelManager.getPixelData,e.sizeInBytes=X4e}};const Y4e="WebGL",b3=Object.create(null);function MX(t,e){b3[t]=e}function J4e(){return Object.keys(b3)}function IX(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return b3[t]&&b3[t](e)}function Z4e(t,e){e.classHierarchy.push("vtkRenderWindow"),t.addRenderer=n=>{t.hasRenderer(n)||(n.setRenderWindow(t),e.renderers.push(n),t.modified())},t.removeRenderer=n=>{e.renderers=e.renderers.filter(r=>r!==n),t.modified()},t.hasRenderer=n=>e.renderers.indexOf(n)!==-1,t.newAPISpecificView=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return IX(n||e.defaultViewAPI,r)},t.addView=n=>{t.hasView(n)||(n.setRenderable(t),e._views.push(n),t.modified())},t.removeView=n=>{e._views=e._views.filter(r=>r!==n),t.modified()},t.hasView=n=>e._views.indexOf(n)!==-1,t.preRender=()=>{e.renderers.forEach(n=>{n.isActiveCameraCreated()||n.resetCamera()})},t.render=()=>{t.preRender(),e.interactor?e.interactor.render():e._views.forEach(n=>n.traverseAllPasses())},t.getStatistics=()=>{const n={propCount:0,invisiblePropCount:0,gpuMemoryMB:0};return e._views.forEach(r=>{r.getGraphicsMemoryInfo&&(n.gpuMemoryMB+=r.getGraphicsMemoryInfo()/1e6)}),e.renderers.forEach(r=>{const i=r.getViewProps(),a=e._views[0].getViewNodeFor(r);i.forEach(o=>{if(o.getVisibility()){n.propCount+=1;const s=o.getMapper&&o.getMapper();if(s&&s.getPrimitiveCount){const l=a.getViewNodeFor(s);if(l){l.getAllocatedGPUMemoryInBytes&&(n.gpuMemoryMB+=l.getAllocatedGPUMemoryInBytes()/1e6);const c=s.getPrimitiveCount();Object.keys(c).forEach(f=>{n[f]||(n[f]=0),n[f]+=c[f]})}}}else n.invisiblePropCount+=1})}),n.str=Object.keys(n).map(r=>`${r}: ${n[r]}`).join(`
`),n},t.captureImages=function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"image/png",r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return le.setImmediate(t.render),e._views.map(i=>i.captureNextImage?i.captureNextImage(n,r):void 0).filter(i=>!!i)},t.addRenderWindow=n=>e.childRenderWindows.includes(n)?!1:(e.childRenderWindows.push(n),t.modified(),!0),t.removeRenderWindow=n=>{const r=e.childRenderWindows.findIndex(i=>i===n);return r<0?!1:(e.childRenderWindows.splice(r,1),t.modified(),!0)}}const Q4e={defaultViewAPI:Y4e,renderers:[],views:[],interactor:null,neverRendered:!0,numberOfLayers:1,childRenderWindows:[]};function RX(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Q4e,n),le.obj(t,e),le.setGet(t,e,["interactor","numberOfLayers","_views","defaultViewAPI"]),le.get(t,e,["neverRendered"]),le.getArray(t,e,["renderers","childRenderWindows"]),le.moveToProtected(t,e,["views"]),le.event(t,e,"completion"),Z4e(t,e)}const eSe=le.newInstance(RX,"vtkRenderWindow");var tSe={newInstance:eSe,extend:RX,registerViewConstructor:MX,listViewAPIs:J4e,newAPISpecificView:IX};function nSe(t,e){e.classHierarchy.push("vtkRenderPass"),t.getOperation=()=>e.currentOperation,t.setCurrentOperation=n=>{e.currentOperation=n,e.currentTraverseOperation=`traverse${le.capitalize(e.currentOperation)}`},t.getTraverseOperation=()=>e.currentTraverseOperation,t.traverse=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;e.deleted||(e._currentParent=r,e.preDelegateOperations.forEach(i=>{t.setCurrentOperation(i),n.traverse(t)}),e.delegates.forEach(i=>{i.traverse(n,t)}),e.postDelegateOperations.forEach(i=>{t.setCurrentOperation(i),n.traverse(t)}))}}const rSe={delegates:[],currentOperation:null,preDelegateOperations:[],postDelegateOperations:[],currentParent:null};function AX(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,rSe,n),le.obj(t,e),le.get(t,e,["currentOperation"]),le.setGet(t,e,["delegates","_currentParent","preDelegateOperations","postDelegateOperations"]),le.moveToProtected(t,e,["currentParent"]),nSe(t,e)}const iSe=le.newInstance(AX,"vtkRenderPass");var bD={newInstance:iSe,extend:AX};const{Representation:aSe}=up,{vtkErrorMacro:$L}=le;function oSe(t){const e=Be.substitute(t.Fragment,"//VTK::RenderPassFragmentShader::Impl",`
      float weight = gl_FragData[0].a * pow(max(1.1 - gl_FragCoord.z, 0.0), 2.0);
      gl_FragData[0] = vec4(gl_FragData[0].rgb*weight, gl_FragData[0].a);
      gl_FragData[1].r = weight;
    `,!1);t.Fragment=e.result}const sSe=`//VTK::System::Dec

in vec2 tcoord;

uniform sampler2D translucentRTexture;
uniform sampler2D translucentRGBATexture;

// the output of this shader
//VTK::Output::Dec

void main()
{
  vec4 t1Color = texture(translucentRGBATexture, tcoord);
  float t2Color = texture(translucentRTexture, tcoord).r;
  gl_FragData[0] = vec4(t1Color.rgb/max(t2Color,0.01), 1.0 - t1Color.a);
}
`;function lSe(t,e){e.classHierarchy.push("vtkOpenGLOrderIndependentTranslucentPass"),t.createVertexBuffer=()=>{const n=new Float32Array([-1,-1,-1,1,-1,-1,-1,1,-1,1,1,-1]),r=new Float32Array([0,0,1,0,0,1,1,1]),i=new Uint16Array([4,0,1,3,2]),a=nn.newInstance({numberOfComponents:3,values:n});a.setName("points");const o=nn.newInstance({numberOfComponents:2,values:r});o.setName("tcoords");const s=nn.newInstance({numberOfComponents:1,values:i});e.tris.getCABO().createVBO(s,"polys",aSe.SURFACE,{points:a,tcoords:o,cellOffset:0}),e.VBOBuildTime.modified()},t.createFramebuffer=n=>{const r=n.getSize(),i=n.getContext();e.framebuffer=Jw.newInstance(),e.framebuffer.setOpenGLRenderWindow(n),e.framebuffer.create(...r),e.framebuffer.saveCurrentBindingsAndBuffers(),e.framebuffer.bind(),e.translucentRGBATexture=ti.newInstance(),e.translucentRGBATexture.setInternalFormat(i.RGBA16F),e.translucentRGBATexture.setFormat(i.RGBA),e.translucentRGBATexture.setOpenGLDataType(i.HALF_FLOAT),e.translucentRGBATexture.setOpenGLRenderWindow(n),e.translucentRGBATexture.create2DFromRaw(r[0],r[1],4,"Float32Array",null),e.translucentRTexture=ti.newInstance(),e.translucentRTexture.setInternalFormat(i.R16F),e.translucentRTexture.setFormat(i.RED),e.translucentRTexture.setOpenGLDataType(i.HALF_FLOAT),e.translucentRTexture.setOpenGLRenderWindow(n),e.translucentRTexture.create2DFromRaw(r[0],r[1],1,"Float32Array",null),e.translucentZTexture=ti.newInstance(),e.translucentZTexture.setOpenGLRenderWindow(n),e.translucentZTexture.createDepthFromRaw(r[0],r[1],"Float32Array",null),e.framebuffer.setColorBuffer(e.translucentRGBATexture,0),e.framebuffer.setColorBuffer(e.translucentRTexture,1),e.framebuffer.setDepthBuffer(e.translucentZTexture)},t.createCopyShader=n=>{e.copyShader=n.getShaderCache().readyShaderProgramArray(["//VTK::System::Dec","attribute vec4 vertexDC;","attribute vec2 tcoordTC;","varying vec2 tcoord;","void main() { tcoord = tcoordTC; gl_Position = vertexDC; }"].join(`
`),sSe,"")},t.createVBO=n=>{const r=n.getContext();e.tris.setOpenGLRenderWindow(n),t.createVertexBuffer();const i=e.copyShader;e.tris.getCABO().bind(),e.copyVAO.addAttributeArray(i,e.tris.getCABO(),"vertexDC",e.tris.getCABO().getVertexOffset(),e.tris.getCABO().getStride(),r.FLOAT,3,r.FALSE)||$L("Error setting vertexDC in copy shader VAO."),e.copyVAO.addAttributeArray(i,e.tris.getCABO(),"tcoordTC",e.tris.getCABO().getTCoordOffset(),e.tris.getCABO().getStride(),r.FLOAT,2,r.FALSE)||$L("Error setting vertexDC in copy shader VAO.")},t.traverse=(n,r,i)=>{if(e.deleted)return;const a=n.getSize(),o=n.getContext();if(e._supported=!1,r.getSelector()||!o||!n.getWebgl2()||!o.getExtension("EXT_color_buffer_half_float")&&!o.getExtension("EXT_color_buffer_float")){t.setCurrentOperation("translucentPass"),r.traverse(t);return}if(e._supported=!0,e.framebuffer===null)t.createFramebuffer(n);else{const l=e.framebuffer.getSize();l===null||l[0]!==a[0]||l[1]!==a[1]?(e.framebuffer.releaseGraphicsResources(),e.translucentRGBATexture.releaseGraphicsResources(n),e.translucentRTexture.releaseGraphicsResources(n),e.translucentZTexture.releaseGraphicsResources(n),t.createFramebuffer(n)):(e.framebuffer.saveCurrentBindingsAndBuffers(),e.framebuffer.bind())}o.drawBuffers([o.COLOR_ATTACHMENT0]),o.clearBufferfv(o.COLOR,0,[0,0,0,0]),o.clearBufferfv(o.DEPTH,0,[1]),o.colorMask(!1,!1,!1,!1),i.getOpaqueActorCount()>0&&(i.setCurrentOperation("opaqueZBufferPass"),r.traverse(i)),o.colorMask(!0,!0,!0,!0),o.drawBuffers([o.COLOR_ATTACHMENT0,o.COLOR_ATTACHMENT1]),o.viewport(0,0,a[0],a[1]),o.scissor(0,0,a[0],a[1]),o.clearBufferfv(o.COLOR,0,[0,0,0,1]),o.clearBufferfv(o.COLOR,1,[0,0,0,0]),o.enable(o.DEPTH_TEST),o.enable(o.BLEND),o.blendFuncSeparate(o.ONE,o.ONE,o.ZERO,o.ONE_MINUS_SRC_ALPHA),t.setCurrentOperation("translucentPass"),r.traverse(t),o.drawBuffers([o.NONE]),e.framebuffer.restorePreviousBindingsAndBuffers(),e.copyShader===null?t.createCopyShader(n):n.getShaderCache().readyShaderProgram(e.copyShader),e.copyVAO||(e.copyVAO=pD.newInstance(),e.copyVAO.setOpenGLRenderWindow(n)),e.copyVAO.bind(),e.VBOBuildTime.getMTime()<t.getMTime()&&t.createVBO(n),o.blendFuncSeparate(o.SRC_ALPHA,o.ONE_MINUS_SRC_ALPHA,o.ONE,o.ONE_MINUS_SRC_ALPHA),o.depthMask(!1),o.depthFunc(o.ALWAYS),o.viewport(0,0,a[0],a[1]),o.scissor(0,0,a[0],a[1]),e.translucentRGBATexture.activate(),e.copyShader.setUniformi("translucentRGBATexture",e.translucentRGBATexture.getTextureUnit()),e.translucentRTexture.activate(),e.copyShader.setUniformi("translucentRTexture",e.translucentRTexture.getTextureUnit()),o.drawArrays(o.TRIANGLES,0,e.tris.getCABO().getElementCount()),o.depthMask(!0),o.depthFunc(o.LEQUAL),e.translucentRGBATexture.deactivate(),e.translucentRTexture.deactivate();const s=r.getTiledSizeAndOrigin();o.scissor(s.lowerLeftU,s.lowerLeftV,s.usize,s.vsize),o.viewport(s.lowerLeftU,s.lowerLeftV,s.usize,s.vsize)},t.getShaderReplacement=()=>e._supported?oSe:null,t.releaseGraphicsResources=n=>{e.framebuffer&&(e.framebuffer.releaseGraphicsResources(n),e.framebuffer=null),e.translucentRGBATexture&&(e.translucentRGBATexture.releaseGraphicsResources(n),e.translucentRGBATexture=null),e.translucentRTexture&&(e.translucentRTexture.releaseGraphicsResources(n),e.translucentRTexture=null),e.translucentZTexture&&(e.translucentZTexture.releaseGraphicsResources(n),e.translucentZTexture=null),e.copyVAO&&(e.copyVAO.releaseGraphicsResources(n),e.copyVAO=null),e.copyShader&&(e.copyShader.releaseGraphicsResources(n),e.copyShader=null),e.tris&&(e.tris.releaseGraphicsResources(n),e.tris=null),t.modified()}}const cSe={framebuffer:null,copyShader:null,tris:null};function PX(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,cSe,n),bD.extend(t,e,n),e.VBOBuildTime={},le.obj(e.VBOBuildTime,{mtime:0}),e.tris=Tu.newInstance(),le.get(t,e,["framebuffer"]),lSe(t,e)}const uSe=le.newInstance(PX,"vtkOpenGLOrderIndependentTranslucentPass");var fSe={newInstance:uSe,extend:PX};function dSe(t,e){e.classHierarchy.push("vtkForwardPass"),t.traverse=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(e.deleted)return;e._currentParent=r,t.setCurrentOperation("buildPass"),n.traverse(t);const i=n.getRenderable().getNumberOfLayers(),a=n.getRenderable().getRenderersByReference();for(let o=0;o<i;o++)for(let s=0;s<a.length;s++){const l=a[s],c=n.getViewNodeFor(l);if(l.getDraw()&&l.getLayer()===o){if(e.opaqueActorCount=0,e.translucentActorCount=0,e.volumeCount=0,e.overlayActorCount=0,t.setCurrentOperation("queryPass"),c.traverse(t),(e.opaqueActorCount>0||e.translucentActorCount>0)&&e.volumeCount>0||e.depthRequested){const f=n.getFramebufferSize();e.framebuffer===null&&(e.framebuffer=Jw.newInstance()),e.framebuffer.setOpenGLRenderWindow(n),e.framebuffer.saveCurrentBindingsAndBuffers();const u=e.framebuffer.getSize();(u===null||u[0]!==f[0]||u[1]!==f[1])&&(e.framebuffer.create(f[0],f[1]),e.framebuffer.populateFramebuffer()),e.framebuffer.bind(),t.setCurrentOperation("zBufferPass"),c.traverse(t),e.framebuffer.restorePreviousBindingsAndBuffers(),e.depthRequested=!1}t.setCurrentOperation("cameraPass"),c.traverse(t),e.opaqueActorCount>0&&(t.setCurrentOperation("opaquePass"),c.traverse(t)),e.translucentActorCount>0&&(e.translucentPass||(e.translucentPass=fSe.newInstance()),e.translucentPass.traverse(n,c,t)),e.volumeCount>0&&(t.setCurrentOperation("volumePass"),c.traverse(t)),e.overlayActorCount>0&&(t.setCurrentOperation("overlayPass"),c.traverse(t))}}},t.getZBufferTexture=()=>e.framebuffer?e.framebuffer.getColorTexture():null,t.requestDepth=()=>{e.depthRequested=!0},t.incrementOpaqueActorCount=()=>e.opaqueActorCount++,t.incrementTranslucentActorCount=()=>e.translucentActorCount++,t.incrementVolumeCount=()=>e.volumeCount++,t.incrementOverlayActorCount=()=>e.overlayActorCount++}const hSe={opaqueActorCount:0,translucentActorCount:0,volumeCount:0,overlayActorCount:0,framebuffer:null,depthRequested:!1};function NX(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,hSe,n),bD.extend(t,e,n),le.get(t,e,["framebuffer","opaqueActorCount","translucentActorCount","volumeCount"]),dSe(t,e)}const pSe=le.newInstance(NX,"vtkForwardPass");var gSe={newInstance:pSe,extend:NX};const Ho={MIN_KNOWN_PASS:0,ACTOR_PASS:0,COMPOSITE_INDEX_PASS:1,ID_LOW24:2,ID_HIGH24:3,MAX_KNOWN_PASS:3};var LX={PassTypes:Ho};const{FieldAssociations:mSe}=Lm;function vSe(t,e){e.classHierarchy.push("vtkHardwareSelector"),t.getSourceDataAsync=async(n,r,i,a,o)=>{},t.selectAsync=async(n,r,i,a,o)=>{const s=await t.getSourceDataAsync(n,r,i,a,o);return s?s.generateSelection(r,i,a,o):[]}}const ySe={fieldAssociation:mSe.FIELD_ASSOCIATION_CELLS,captureZValues:!1};function kX(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,ySe,n),le.obj(t,e),le.setGet(t,e,["fieldAssociation","captureZValues"]),vSe(t,e)}const xSe=le.newInstance(kX,"vtkHardwareSelector");var bSe={newInstance:xSe,extend:kX};const wSe={GLOBALIDS:0,PEDIGREEIDS:1,VALUES:2,INDICES:3,FRUSTUM:4,LOCATIONS:5,THRESHOLDS:6,BLOCKS:7,QUERY:8},CSe={CELL:0,POINT:1,FIELD:2,VERTEX:3,EDGE:4,ROW:5};var SSe={SelectionContent:wSe,SelectionField:CSe};function TSe(t,e){e.classHierarchy.push("vtkSelectionNode"),t.getBounds=()=>e.points.getBounds()}const ESe={contentType:-1,fieldType:-1,properties:null,selectionList:[]};function VX(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,ESe,n),le.obj(t,e),e.properties={},le.setGet(t,e,["contentType","fieldType","properties","selectionList"]),TSe(t,e)}const _Se=le.newInstance(VX,"vtkSelectionNode");var FX={newInstance:_Se,extend:VX,...SSe};const{PassTypes:Qi}=LX,{SelectionContent:DSe,SelectionField:GL}=FX,{FieldAssociations:Vv}=Lm,{vtkErrorMacro:UX}=le,zd=1;function BX(t){return`${t.propID} ${t.compositeID}`}function $X(t,e,n,r){if(!n)return 0;const i=(e*(r[2]-r[0]+1)+t)*4;return n[i+3]}function mf(t,e,n,r){if(!n)return 0;const i=(e*(r[2]-r[0]+1)+t)*4,a=n[i],o=n[i+1];return(n[i+2]*256+o)*256+a}function GX(t,e){let n=e;return n<<=24,n|=t,n}function OSe(t,e,n,r){{if(r[0]=e[0],r[1]=e[1],e[0]<t.area[0]||e[0]>t.area[2]||e[1]<t.area[1]||e[1]>t.area[3])return null;const i=[e[0]-t.area[0],e[1]-t.area[1]],a=mf(i[0],i[1],t.pixBuffer[Qi.ACTOR_PASS],t.area);if(a<=0||a-zd>=t.props.length)return null;const o={};o.valid=!0,o.propID=a-zd,o.prop=t.props[o.propID];let s=mf(i[0],i[1],t.pixBuffer[Qi.COMPOSITE_INDEX_PASS],t.area);if((s<0||s>16777215)&&(s=0),o.compositeID=s-zd,t.captureZValues){const f=(i[1]*(t.area[2]-t.area[0]+1)+i[0])*4;o.zValue=(256*t.zBuffer[f]+t.zBuffer[f+1])/65535,o.displayPosition=e}if(t.pixBuffer[Qi.ID_LOW24]&&$X(i[0],i[1],t.pixBuffer[Qi.ID_LOW24],t.area)===0)return o;const l=mf(i[0],i[1],t.pixBuffer[Qi.ID_LOW24],t.area),c=mf(i[0],i[1],t.pixBuffer[Qi.ID_HIGH24],t.area);return o.attributeID=GX(l,c),o}}function jX(t,e,n,r,i){const a=[];let o=0;return e.forEach((s,l)=>{const c=FX.newInstance();switch(c.setContentType(DSe.INDICES),t){case Vv.FIELD_ASSOCIATION_CELLS:c.setFieldType(GL.CELL);break;case Vv.FIELD_ASSOCIATION_POINTS:c.setFieldType(GL.POINT);break;default:UX("Unknown field association")}c.getProperties().propID=s.info.propID,c.getProperties().prop=s.info.prop,c.getProperties().compositeID=s.info.compositeID,c.getProperties().attributeID=s.info.attributeID,c.getProperties().pixelCount=s.pixelCount,n&&(c.getProperties().displayPosition=[s.info.displayPosition[0],s.info.displayPosition[1],s.info.zValue],c.getProperties().worldPosition=i.displayToWorld(s.info.displayPosition[0],s.info.displayPosition[1],s.info.zValue,r)),c.setSelectionList(s.attributeIDs),a[o]=c,o++}),a}function MSe(t,e,n,r,i){const a=Math.floor(e),o=Math.floor(n),s=Math.floor(r),l=Math.floor(i),c=new Map,f=[0,0];for(let u=o;u<=l;u++)for(let d=a;d<=s;d++){const p=OSe(t,[d,u],0,f);if(p&&p.valid){const g=BX(p);if(!c.has(g))c.set(g,{info:p,pixelCount:1,attributeIDs:[p.attributeID]});else{const m=c.get(g);m.pixelCount++,t.captureZValues&&p.zValue<m.info.zValue&&(m.info=p),m.attributeIDs.indexOf(p.attributeID)===-1&&m.attributeIDs.push(p.attributeID)}}}return jX(t.fieldAssociation,c,t.captureZValues,t.renderer,t.openGLRenderWindow)}function ISe(t,e){e.classHierarchy.push("vtkOpenGLHardwareSelector"),t.releasePixBuffers=()=>{e.rawPixBuffer=[],e.pixBuffer=[],e.zBuffer=null},t.beginSelection=()=>{e._openGLRenderer=e._openGLRenderWindow.getViewNodeFor(e._renderer),e.maxAttributeId=0;const r=e._openGLRenderWindow.getSize();if(!e.framebuffer)e.framebuffer=Jw.newInstance(),e.framebuffer.setOpenGLRenderWindow(e._openGLRenderWindow),e.framebuffer.saveCurrentBindingsAndBuffers(),e.framebuffer.create(r[0],r[1]),e.framebuffer.populateFramebuffer();else{e.framebuffer.setOpenGLRenderWindow(e._openGLRenderWindow),e.framebuffer.saveCurrentBindingsAndBuffers();const i=e.framebuffer.getSize();!i||i[0]!==r[0]||i[1]!==r[1]?(e.framebuffer.create(r[0],r[1]),e.framebuffer.populateFramebuffer()):e.framebuffer.bind()}if(e._openGLRenderer.clear(),e._openGLRenderer.setSelector(t),e.hitProps={},e.propPixels={},e.props=[],t.releasePixBuffers(),e.fieldAssociation===Vv.FIELD_ASSOCIATION_POINTS){const i=e._openGLRenderWindow.getContext(),a=i.isEnabled(i.BLEND);i.disable(i.BLEND),e._openGLRenderWindow.traverseAllPasses(),a&&i.enable(i.BLEND)}},t.endSelection=()=>{e.hitProps={},e._openGLRenderer.setSelector(null),e.framebuffer.restorePreviousBindingsAndBuffers()},t.preCapturePass=()=>{const r=e._openGLRenderWindow.getContext();e.originalBlending=r.isEnabled(r.BLEND),r.disable(r.BLEND)},t.postCapturePass=()=>{const r=e._openGLRenderWindow.getContext();e.originalBlending&&r.enable(r.BLEND)},t.select=()=>{let r=null;return t.captureBuffers()&&(r=t.generateSelection(e.area[0],e.area[1],e.area[2],e.area[3]),t.releasePixBuffers()),r},t.getSourceDataAsync=async(r,i,a,o,s)=>{if(e._renderer=r,i===void 0){const c=e._openGLRenderWindow.getSize();t.setArea(0,0,c[0]-1,c[1]-1)}else t.setArea(i,a,o,s);if(!t.captureBuffers())return!1;const l={area:[...e.area],pixBuffer:[...e.pixBuffer],captureZValues:e.captureZValues,zBuffer:e.zBuffer,props:[...e.props],fieldAssociation:e.fieldAssociation,renderer:r,openGLRenderWindow:e._openGLRenderWindow};return l.generateSelection=function(){for(var c=arguments.length,f=new Array(c),u=0;u<c;u++)f[u]=arguments[u];return MSe(l,...f)},l},t.captureBuffers=()=>{if(!e._renderer||!e._openGLRenderWindow)return UX("Renderer and view must be set before calling Select."),!1;e._openGLRenderer=e._openGLRenderWindow.getViewNodeFor(e._renderer),e._openGLRenderWindow.getRenderable().preRender(),t.invokeEvent({type:"StartEvent"}),e.originalBackground=e._renderer.getBackgroundByReference(),e._renderer.setBackground(0,0,0,0);const r=e._openGLRenderWindow.getRenderPasses();t.beginSelection();const i=[];for(e.currentPass=Qi.MIN_KNOWN_PASS;e.currentPass<=Qi.MAX_KNOWN_PASS;e.currentPass++)t.passRequired(e.currentPass)&&(t.preCapturePass(e.currentPass),e.captureZValues&&e.currentPass===Qi.ACTOR_PASS&&typeof r[0].requestDepth=="function"&&typeof r[0].getFramebuffer=="function"&&r[0].requestDepth(),e._openGLRenderWindow.traverseAllPasses(),t.postCapturePass(e.currentPass),t.savePixelBuffer(e.currentPass),i.push(e.currentPass));return i.forEach(a=>{e.currentPass=a,t.processPixelBuffers()}),e.currentPass=Qi.MAX_KNOWN_PASS,t.endSelection(),e._renderer.setBackground(e.originalBackground),t.invokeEvent({type:"EndEvent"}),!0},t.processPixelBuffers=()=>{e.props.forEach((r,i)=>{t.isPropHit(i)&&r.processSelectorPixelBuffers(t,e.propPixels[i])})},t.passRequired=r=>{if(r===Qi.ID_HIGH24){if(e.fieldAssociation===Vv.FIELD_ASSOCIATION_POINTS)return e.maximumPointId>16777215;if(e.fieldAssociation===Vv.FIELD_ASSOCIATION_CELLS)return e.maximumCellId>16777215}return!0},t.savePixelBuffer=r=>{if(e.pixBuffer[r]=e._openGLRenderWindow.getPixelData(e.area[0],e.area[1],e.area[2],e.area[3]),!e.rawPixBuffer[r]){const i=(e.area[2]-e.area[0]+1)*(e.area[3]-e.area[1]+1)*4;e.rawPixBuffer[r]=new Uint8Array(i),e.rawPixBuffer[r].set(e.pixBuffer[r])}if(r===Qi.ACTOR_PASS){if(e.captureZValues){const i=e._openGLRenderWindow.getRenderPasses();if(typeof i[0].requestDepth=="function"&&typeof i[0].getFramebuffer=="function"){const a=i[0].getFramebuffer();a.saveCurrentBindingsAndBuffers(),a.bind(),e.zBuffer=e._openGLRenderWindow.getPixelData(e.area[0],e.area[1],e.area[2],e.area[3]),a.restorePreviousBindingsAndBuffers()}}t.buildPropHitList(e.rawPixBuffer[r])}},t.buildPropHitList=r=>{let i=0;for(let a=0;a<=e.area[3]-e.area[1];a++)for(let o=0;o<=e.area[2]-e.area[0];o++){let s=mf(o,a,r,e.area);s>0&&(s--,s in e.hitProps||(e.hitProps[s]=!0,e.propPixels[s]=[]),e.propPixels[s].push(i*4)),++i}},t.renderProp=r=>{e.currentPass===Qi.ACTOR_PASS&&(t.setPropColorValueFromInt(e.props.length+zd),e.props.push(r))},t.renderCompositeIndex=r=>{e.currentPass===Qi.COMPOSITE_INDEX_PASS&&t.setPropColorValueFromInt(r+zd)},t.renderAttributeId=r=>{r<0||(e.maxAttributeId=r>e.maxAttributeId?r:e.maxAttributeId)},t.passTypeToString=r=>le.enumToString(Qi,r),t.isPropHit=r=>!!e.hitProps[r],t.setPropColorValueFromInt=r=>{e.propColorValue[0]=r%256/255,e.propColorValue[1]=Math.floor(r/256)%256/255,e.propColorValue[2]=Math.floor(r/65536)%256/255},t.getPixelInformation=(r,i,a)=>{const o=i<0?0:i;if(o===0){if(a[0]=r[0],a[1]=r[1],r[0]<e.area[0]||r[0]>e.area[2]||r[1]<e.area[1]||r[1]>e.area[3])return null;const f=[r[0]-e.area[0],r[1]-e.area[1]],u=mf(f[0],f[1],e.pixBuffer[Qi.ACTOR_PASS],e.area);if(u<=0||u-zd>=e.props.length)return null;const d={};d.valid=!0,d.propID=u-zd,d.prop=e.props[d.propID];let h=mf(f[0],f[1],e.pixBuffer[Qi.COMPOSITE_INDEX_PASS],e.area);if((h<0||h>16777215)&&(h=0),d.compositeID=h-zd,e.captureZValues){const m=(f[1]*(e.area[2]-e.area[0]+1)+f[0])*4;d.zValue=(256*e.zBuffer[m]+e.zBuffer[m+1])/65535,d.displayPosition=r}if(e.pixBuffer[Qi.ID_LOW24]&&$X(f[0],f[1],e.pixBuffer[Qi.ID_LOW24],e.area)===0)return d;const p=mf(f[0],f[1],e.pixBuffer[Qi.ID_LOW24],e.area),g=mf(f[0],f[1],e.pixBuffer[Qi.ID_HIGH24],e.area);return d.attributeID=GX(p,g),d}const s=[r[0],r[1]],l=[0,0];let c=t.getPixelInformation(r,0,a);if(c&&c.valid)return c;for(let f=1;f<o;++f){for(let u=s[1]>f?s[1]-f:0;u<=s[1]+f;++u)if(l[1]=u,s[0]>=f&&(l[0]=s[0]-f,c=t.getPixelInformation(l,0,a),c&&c.valid)||(l[0]=s[0]+f,c=t.getPixelInformation(l,0,a),c&&c.valid))return c;for(let u=s[0]>=f?s[0]-(f-1):0;u<=s[0]+(f-1);++u)if(l[0]=u,s[1]>=f&&(l[1]=s[1]-f,c=t.getPixelInformation(l,0,a),c&&c.valid)||(l[1]=s[1]+f,c=t.getPixelInformation(l,0,a),c&&c.valid))return c}return a[0]=r[0],a[1]=r[1],null},t.generateSelection=(r,i,a,o)=>{const s=Math.floor(r),l=Math.floor(i),c=Math.floor(a),f=Math.floor(o),u=new Map,d=[0,0];for(let h=l;h<=f;h++)for(let p=s;p<=c;p++){const g=[p,h],m=t.getPixelInformation(g,0,d);if(m&&m.valid){const y=BX(m);if(!u.has(y))u.set(y,{info:m,pixelCount:1,attributeIDs:[m.attributeID]});else{const v=u.get(y);v.pixelCount++,e.captureZValues&&m.zValue<v.info.zValue&&(v.info=m),v.attributeIDs.indexOf(m.attributeID)===-1&&v.attributeIDs.push(m.attributeID)}}}return jX(e.fieldAssociation,u,e.captureZValues,e._renderer,e._openGLRenderWindow)},t.getRawPixelBuffer=r=>e.rawPixBuffer[r],t.getPixelBuffer=r=>e.pixBuffer[r],t.attach=(r,i)=>{e._openGLRenderWindow=r,e._renderer=i};const n=t.setArea;t.setArea=function(){return n(...arguments)?(e.area[0]=Math.floor(e.area[0]),e.area[1]=Math.floor(e.area[1]),e.area[2]=Math.floor(e.area[2]),e.area[3]=Math.floor(e.area[3]),!0):!1}}const RSe={area:void 0,currentPass:-1,propColorValue:null,props:null,maximumPointId:0,maximumCellId:0,idOffset:1};function zX(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,RSe,n),bSe.extend(t,e,n),e.propColorValue=[0,0,0],e.props=[],e.area||(e.area=[0,0,0,0]),le.setGetArray(t,e,["area"],4),le.setGet(t,e,["_renderer","currentPass","_openGLRenderWindow","maximumPointId","maximumCellId"]),le.setGetArray(t,e,["propColorValue"],3),le.moveToProtected(t,e,["renderer","openGLRenderWindow"]),le.event(t,e,"event"),ISe(t,e)}const ASe=le.newInstance(zX,"vtkOpenGLHardwareSelector");var wD={newInstance:ASe,extend:zX,...LX},qT={exports:{}},jL;function PSe(){return jL||(jL=1,(function(t,e){(function(n){t.exports=n()})(function(n){var r=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function i(y,v){var x=y[0],w=y[1],S=y[2],T=y[3];x+=(w&S|~w&T)+v[0]-680876936|0,x=(x<<7|x>>>25)+w|0,T+=(x&w|~x&S)+v[1]-389564586|0,T=(T<<12|T>>>20)+x|0,S+=(T&x|~T&w)+v[2]+606105819|0,S=(S<<17|S>>>15)+T|0,w+=(S&T|~S&x)+v[3]-1044525330|0,w=(w<<22|w>>>10)+S|0,x+=(w&S|~w&T)+v[4]-176418897|0,x=(x<<7|x>>>25)+w|0,T+=(x&w|~x&S)+v[5]+1200080426|0,T=(T<<12|T>>>20)+x|0,S+=(T&x|~T&w)+v[6]-1473231341|0,S=(S<<17|S>>>15)+T|0,w+=(S&T|~S&x)+v[7]-45705983|0,w=(w<<22|w>>>10)+S|0,x+=(w&S|~w&T)+v[8]+1770035416|0,x=(x<<7|x>>>25)+w|0,T+=(x&w|~x&S)+v[9]-1958414417|0,T=(T<<12|T>>>20)+x|0,S+=(T&x|~T&w)+v[10]-42063|0,S=(S<<17|S>>>15)+T|0,w+=(S&T|~S&x)+v[11]-1990404162|0,w=(w<<22|w>>>10)+S|0,x+=(w&S|~w&T)+v[12]+1804603682|0,x=(x<<7|x>>>25)+w|0,T+=(x&w|~x&S)+v[13]-40341101|0,T=(T<<12|T>>>20)+x|0,S+=(T&x|~T&w)+v[14]-1502002290|0,S=(S<<17|S>>>15)+T|0,w+=(S&T|~S&x)+v[15]+1236535329|0,w=(w<<22|w>>>10)+S|0,x+=(w&T|S&~T)+v[1]-165796510|0,x=(x<<5|x>>>27)+w|0,T+=(x&S|w&~S)+v[6]-1069501632|0,T=(T<<9|T>>>23)+x|0,S+=(T&w|x&~w)+v[11]+643717713|0,S=(S<<14|S>>>18)+T|0,w+=(S&x|T&~x)+v[0]-373897302|0,w=(w<<20|w>>>12)+S|0,x+=(w&T|S&~T)+v[5]-701558691|0,x=(x<<5|x>>>27)+w|0,T+=(x&S|w&~S)+v[10]+38016083|0,T=(T<<9|T>>>23)+x|0,S+=(T&w|x&~w)+v[15]-660478335|0,S=(S<<14|S>>>18)+T|0,w+=(S&x|T&~x)+v[4]-405537848|0,w=(w<<20|w>>>12)+S|0,x+=(w&T|S&~T)+v[9]+568446438|0,x=(x<<5|x>>>27)+w|0,T+=(x&S|w&~S)+v[14]-1019803690|0,T=(T<<9|T>>>23)+x|0,S+=(T&w|x&~w)+v[3]-187363961|0,S=(S<<14|S>>>18)+T|0,w+=(S&x|T&~x)+v[8]+1163531501|0,w=(w<<20|w>>>12)+S|0,x+=(w&T|S&~T)+v[13]-1444681467|0,x=(x<<5|x>>>27)+w|0,T+=(x&S|w&~S)+v[2]-51403784|0,T=(T<<9|T>>>23)+x|0,S+=(T&w|x&~w)+v[7]+1735328473|0,S=(S<<14|S>>>18)+T|0,w+=(S&x|T&~x)+v[12]-1926607734|0,w=(w<<20|w>>>12)+S|0,x+=(w^S^T)+v[5]-378558|0,x=(x<<4|x>>>28)+w|0,T+=(x^w^S)+v[8]-2022574463|0,T=(T<<11|T>>>21)+x|0,S+=(T^x^w)+v[11]+1839030562|0,S=(S<<16|S>>>16)+T|0,w+=(S^T^x)+v[14]-35309556|0,w=(w<<23|w>>>9)+S|0,x+=(w^S^T)+v[1]-1530992060|0,x=(x<<4|x>>>28)+w|0,T+=(x^w^S)+v[4]+1272893353|0,T=(T<<11|T>>>21)+x|0,S+=(T^x^w)+v[7]-155497632|0,S=(S<<16|S>>>16)+T|0,w+=(S^T^x)+v[10]-1094730640|0,w=(w<<23|w>>>9)+S|0,x+=(w^S^T)+v[13]+681279174|0,x=(x<<4|x>>>28)+w|0,T+=(x^w^S)+v[0]-358537222|0,T=(T<<11|T>>>21)+x|0,S+=(T^x^w)+v[3]-722521979|0,S=(S<<16|S>>>16)+T|0,w+=(S^T^x)+v[6]+76029189|0,w=(w<<23|w>>>9)+S|0,x+=(w^S^T)+v[9]-640364487|0,x=(x<<4|x>>>28)+w|0,T+=(x^w^S)+v[12]-421815835|0,T=(T<<11|T>>>21)+x|0,S+=(T^x^w)+v[15]+530742520|0,S=(S<<16|S>>>16)+T|0,w+=(S^T^x)+v[2]-995338651|0,w=(w<<23|w>>>9)+S|0,x+=(S^(w|~T))+v[0]-198630844|0,x=(x<<6|x>>>26)+w|0,T+=(w^(x|~S))+v[7]+1126891415|0,T=(T<<10|T>>>22)+x|0,S+=(x^(T|~w))+v[14]-1416354905|0,S=(S<<15|S>>>17)+T|0,w+=(T^(S|~x))+v[5]-57434055|0,w=(w<<21|w>>>11)+S|0,x+=(S^(w|~T))+v[12]+1700485571|0,x=(x<<6|x>>>26)+w|0,T+=(w^(x|~S))+v[3]-1894986606|0,T=(T<<10|T>>>22)+x|0,S+=(x^(T|~w))+v[10]-1051523|0,S=(S<<15|S>>>17)+T|0,w+=(T^(S|~x))+v[1]-2054922799|0,w=(w<<21|w>>>11)+S|0,x+=(S^(w|~T))+v[8]+1873313359|0,x=(x<<6|x>>>26)+w|0,T+=(w^(x|~S))+v[15]-30611744|0,T=(T<<10|T>>>22)+x|0,S+=(x^(T|~w))+v[6]-1560198380|0,S=(S<<15|S>>>17)+T|0,w+=(T^(S|~x))+v[13]+1309151649|0,w=(w<<21|w>>>11)+S|0,x+=(S^(w|~T))+v[4]-145523070|0,x=(x<<6|x>>>26)+w|0,T+=(w^(x|~S))+v[11]-1120210379|0,T=(T<<10|T>>>22)+x|0,S+=(x^(T|~w))+v[2]+718787259|0,S=(S<<15|S>>>17)+T|0,w+=(T^(S|~x))+v[9]-343485551|0,w=(w<<21|w>>>11)+S|0,y[0]=x+y[0]|0,y[1]=w+y[1]|0,y[2]=S+y[2]|0,y[3]=T+y[3]|0}function a(y){var v=[],x;for(x=0;x<64;x+=4)v[x>>2]=y.charCodeAt(x)+(y.charCodeAt(x+1)<<8)+(y.charCodeAt(x+2)<<16)+(y.charCodeAt(x+3)<<24);return v}function o(y){var v=[],x;for(x=0;x<64;x+=4)v[x>>2]=y[x]+(y[x+1]<<8)+(y[x+2]<<16)+(y[x+3]<<24);return v}function s(y){var v=y.length,x=[1732584193,-271733879,-1732584194,271733878],w,S,T,_,D,I;for(w=64;w<=v;w+=64)i(x,a(y.substring(w-64,w)));for(y=y.substring(w-64),S=y.length,T=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],w=0;w<S;w+=1)T[w>>2]|=y.charCodeAt(w)<<(w%4<<3);if(T[w>>2]|=128<<(w%4<<3),w>55)for(i(x,T),w=0;w<16;w+=1)T[w]=0;return _=v*8,_=_.toString(16).match(/(.*?)(.{0,8})$/),D=parseInt(_[2],16),I=parseInt(_[1],16)||0,T[14]=D,T[15]=I,i(x,T),x}function l(y){var v=y.length,x=[1732584193,-271733879,-1732584194,271733878],w,S,T,_,D,I;for(w=64;w<=v;w+=64)i(x,o(y.subarray(w-64,w)));for(y=w-64<v?y.subarray(w-64):new Uint8Array(0),S=y.length,T=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],w=0;w<S;w+=1)T[w>>2]|=y[w]<<(w%4<<3);if(T[w>>2]|=128<<(w%4<<3),w>55)for(i(x,T),w=0;w<16;w+=1)T[w]=0;return _=v*8,_=_.toString(16).match(/(.*?)(.{0,8})$/),D=parseInt(_[2],16),I=parseInt(_[1],16)||0,T[14]=D,T[15]=I,i(x,T),x}function c(y){var v="",x;for(x=0;x<4;x+=1)v+=r[y>>x*8+4&15]+r[y>>x*8&15];return v}function f(y){var v;for(v=0;v<y.length;v+=1)y[v]=c(y[v]);return y.join("")}f(s("hello")),typeof ArrayBuffer<"u"&&!ArrayBuffer.prototype.slice&&(function(){function y(v,x){return v=v|0||0,v<0?Math.max(v+x,0):Math.min(v,x)}ArrayBuffer.prototype.slice=function(v,x){var w=this.byteLength,S=y(v,w),T=w,_,D,I,R;return x!==n&&(T=y(x,w)),S>T?new ArrayBuffer(0):(_=T-S,D=new ArrayBuffer(_),I=new Uint8Array(D),R=new Uint8Array(this,S,_),I.set(R),D)}})();function u(y){return/[\u0080-\uFFFF]/.test(y)&&(y=unescape(encodeURIComponent(y))),y}function d(y,v){var x=y.length,w=new ArrayBuffer(x),S=new Uint8Array(w),T;for(T=0;T<x;T+=1)S[T]=y.charCodeAt(T);return v?S:w}function h(y){return String.fromCharCode.apply(null,new Uint8Array(y))}function p(y,v,x){var w=new Uint8Array(y.byteLength+v.byteLength);return w.set(new Uint8Array(y)),w.set(new Uint8Array(v),y.byteLength),w}function g(y){var v=[],x=y.length,w;for(w=0;w<x-1;w+=2)v.push(parseInt(y.substr(w,2),16));return String.fromCharCode.apply(String,v)}function m(){this.reset()}return m.prototype.append=function(y){return this.appendBinary(u(y)),this},m.prototype.appendBinary=function(y){this._buff+=y,this._length+=y.length;var v=this._buff.length,x;for(x=64;x<=v;x+=64)i(this._hash,a(this._buff.substring(x-64,x)));return this._buff=this._buff.substring(x-64),this},m.prototype.end=function(y){var v=this._buff,x=v.length,w,S=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],T;for(w=0;w<x;w+=1)S[w>>2]|=v.charCodeAt(w)<<(w%4<<3);return this._finish(S,x),T=f(this._hash),y&&(T=g(T)),this.reset(),T},m.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},m.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash.slice()}},m.prototype.setState=function(y){return this._buff=y.buff,this._length=y.length,this._hash=y.hash,this},m.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},m.prototype._finish=function(y,v){var x=v,w,S,T;if(y[x>>2]|=128<<(x%4<<3),x>55)for(i(this._hash,y),x=0;x<16;x+=1)y[x]=0;w=this._length*8,w=w.toString(16).match(/(.*?)(.{0,8})$/),S=parseInt(w[2],16),T=parseInt(w[1],16)||0,y[14]=S,y[15]=T,i(this._hash,y)},m.hash=function(y,v){return m.hashBinary(u(y),v)},m.hashBinary=function(y,v){var x=s(y),w=f(x);return v?g(w):w},m.ArrayBuffer=function(){this.reset()},m.ArrayBuffer.prototype.append=function(y){var v=p(this._buff.buffer,y),x=v.length,w;for(this._length+=y.byteLength,w=64;w<=x;w+=64)i(this._hash,o(v.subarray(w-64,w)));return this._buff=w-64<x?new Uint8Array(v.buffer.slice(w-64)):new Uint8Array(0),this},m.ArrayBuffer.prototype.end=function(y){var v=this._buff,x=v.length,w=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],S,T;for(S=0;S<x;S+=1)w[S>>2]|=v[S]<<(S%4<<3);return this._finish(w,x),T=f(this._hash),y&&(T=g(T)),this.reset(),T},m.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},m.ArrayBuffer.prototype.getState=function(){var y=m.prototype.getState.call(this);return y.buff=h(y.buff),y},m.ArrayBuffer.prototype.setState=function(y){return y.buff=d(y.buff,!0),m.prototype.setState.call(this,y)},m.ArrayBuffer.prototype.destroy=m.prototype.destroy,m.ArrayBuffer.prototype._finish=m.prototype._finish,m.ArrayBuffer.hash=function(y,v){var x=l(new Uint8Array(y)),w=f(x);return v?g(w):w},m})})(qT)),qT.exports}var NSe=PSe();const LSe=tl(NSe),kSe=["lastShaderProgramBound","context","_openGLRenderWindow"];function VSe(t,e){e.classHierarchy.push("vtkShaderCache"),t.replaceShaderValues=(n,r,i)=>{let a=r;i.length>0&&(a=Be.substitute(a,"VSOut","GSOut").result);const o=e._openGLRenderWindow.getWebgl2();let s=`
`,l=`#version 100
`;o?l=`#version 300 es
#define attribute in
#define textureCube texture
#define texture2D texture
#define textureCubeLod textureLod
#define texture2DLod textureLod
`:(e.context.getExtension("OES_standard_derivatives"),e.context.getExtension("EXT_frag_depth")&&(s=`#extension GL_EXT_frag_depth : enable
`),e.context.getExtension("EXT_shader_texture_lod")&&(s+=`#extension GL_EXT_shader_texture_lod : enable
#define textureCubeLod textureCubeLodEXT
#define texture2DLod texture2DLodEXT`)),a=Be.substitute(a,"//VTK::System::Dec",[`${l}
`,o?"":`#extension GL_OES_standard_derivatives : enable
`,s,"#ifdef GL_FRAGMENT_PRECISION_HIGH","precision highp float;","precision highp int;","#else","precision mediump float;","precision mediump int;","#endif"]).result;let c=Be.substitute(n,"//VTK::System::Dec",[`${l}
`,"#ifdef GL_FRAGMENT_PRECISION_HIGH","precision highp float;","precision highp int;","#else","precision mediump float;","precision mediump int;","#endif"]).result;if(o){c=Be.substitute(c,"varying","out").result,a=Be.substitute(a,"varying","in").result;let u="",d=0;for(;a.includes(`gl_FragData[${d}]`);)a=Be.substitute(a,`gl_FragData\\[${d}\\]`,`fragOutput${d}`).result,u+=`layout(location = ${d}) out vec4 fragOutput${d};
`,d++;a=Be.substitute(a,"//VTK::Output::Dec",u).result}const f=Be.substitute(i,"//VTK::System::Dec",l).result;return{VSSource:c,FSSource:a,GSSource:f}},t.readyShaderProgramArray=(n,r,i)=>{const a=t.replaceShaderValues(n,r,i),o=t.getShaderProgram(a.VSSource,a.FSSource,a.GSSource);return t.readyShaderProgram(o)},t.readyShaderProgram=n=>!n||!n.getCompiled()&&!n.compileShader()||!t.bindShaderProgram(n)?null:n,t.getShaderProgram=(n,r,i)=>{const a=`${n}${r}${i}`,o=LSe.hash(a);if(!(o in e.shaderPrograms)){const s=Be.newInstance();return s.setContext(e.context),s.getVertexShader().setSource(n),s.getFragmentShader().setSource(r),i&&s.getGeometryShader().setSource(i),s.setMd5Hash(o),e.shaderPrograms[o]=s,s}return e.shaderPrograms[o]},t.releaseGraphicsResources=n=>{t.releaseCurrentShaderProgram(),Object.keys(e.shaderPrograms).map(r=>e.shaderPrograms[r]).forEach(r=>r.cleanup()),e.shaderPrograms={}},t.releaseCurrentShaderProgram=()=>{e.lastShaderProgramBound&&(e.lastShaderProgramBound.cleanup(),e.lastShaderProgramBound=null)},t.bindShaderProgram=n=>(e.lastShaderProgramBound===n||(e.lastShaderProgramBound&&e.lastShaderProgramBound.release(),n.bind(),e.lastShaderProgramBound=n),1)}const FSe={lastShaderProgramBound:null,shaderPrograms:null,context:null};function WX(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,FSe,n),e.shaderPrograms={},le.obj(t,e),le.setGet(t,e,kSe),le.moveToProtected(t,e,["openGLRenderWindow"]),VSe(t,e)}const USe=le.newInstance(WX,"vtkShaderCache");var BSe={newInstance:USe,extend:WX};const{vtkErrorMacro:$Se}=le;function GSe(t,e){e.classHierarchy.push("vtkOpenGLTextureUnitManager"),t.deleteTable=()=>{for(let n=0;n<e.numberOfTextureUnits;++n)e.textureUnits[n]===!0&&$Se("some texture units  were not properly released");e.textureUnits=[],e.numberOfTextureUnits=0},t.setContext=n=>{if(e.context!==n){if(e.context!==0&&t.deleteTable(),e.context=n,e.context){e.numberOfTextureUnits=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS);for(let r=0;r<e.numberOfTextureUnits;++r)e.textureUnits[r]=!1}t.modified()}},t.allocate=()=>{for(let n=0;n<e.numberOfTextureUnits;n++)if(!t.isAllocated(n))return e.textureUnits[n]=!0,n;return-1},t.allocateUnit=n=>t.isAllocated(n)?-1:(e.textureUnits[n]=!0,n),t.isAllocated=n=>e.textureUnits[n],t.free=n=>{e.textureUnits[n]=!1},t.freeAll=()=>{for(let n=0;n<e.numberOfTextureUnits;++n)e.textureUnits[n]=!1}}const jSe={context:null,numberOfTextureUnits:0,textureUnits:0};function HX(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,jSe,n),le.obj(t,e),e.textureUnits=[],le.get(t,e,["numberOfTextureUnits"]),le.setGet(t,e,["context"]),GSe(t,e)}const zSe=le.newInstance(HX,"vtkOpenGLTextureUnitManager");var WSe={newInstance:zSe,extend:HX};function HSe(t,e){e.classHierarchy.push("vtkRenderWindowViewNode"),t.getViewNodeFactory=()=>null,t.getAspectRatio=()=>e.size[0]/e.size[1],t.getAspectRatioForRenderer=n=>{const r=n.getViewportByReference();return e.size[0]*(r[2]-r[0])/((r[3]-r[1])*e.size[1])},t.isInViewport=(n,r,i)=>{const a=i.getViewportByReference(),o=t.getFramebufferSize();return a[0]*o[0]<=n&&a[2]*o[0]>=n&&a[1]*o[1]<=r&&a[3]*o[1]>=r},t.getViewportSize=n=>{const r=n.getViewportByReference(),i=t.getFramebufferSize();return[(r[2]-r[0])*i[0],(r[3]-r[1])*i[1]]},t.getViewportCenter=n=>{const r=t.getViewportSize(n);return[r[0]*.5,r[1]*.5]},t.displayToNormalizedDisplay=(n,r,i)=>{const a=t.getFramebufferSize();return[n/a[0],r/a[1],i]},t.normalizedDisplayToDisplay=(n,r,i)=>{const a=t.getFramebufferSize();return[n*a[0],r*a[1],i]},t.worldToView=(n,r,i,a)=>a.worldToView(n,r,i),t.viewToWorld=(n,r,i,a)=>a.viewToWorld(n,r,i),t.worldToDisplay=(n,r,i,a)=>{const o=a.worldToView(n,r,i),s=t.getViewportSize(a),l=a.viewToProjection(o[0],o[1],o[2],s[0]/s[1]),c=a.projectionToNormalizedDisplay(l[0],l[1],l[2]);return t.normalizedDisplayToDisplay(c[0],c[1],c[2])},t.displayToWorld=(n,r,i,a)=>{const o=t.displayToNormalizedDisplay(n,r,i),s=a.normalizedDisplayToProjection(o[0],o[1],o[2]),l=t.getViewportSize(a),c=a.projectionToView(s[0],s[1],s[2],l[0]/l[1]);return a.viewToWorld(c[0],c[1],c[2])},t.normalizedDisplayToViewport=(n,r,i,a)=>{let o=a.getViewportByReference();o=t.normalizedDisplayToDisplay(o[0],o[1],0);const s=t.normalizedDisplayToDisplay(n,r,i);return[s[0]-o[0]-.5,s[1]-o[1]-.5,i]},t.viewportToNormalizedViewport=(n,r,i,a)=>{const o=t.getViewportSize(a);return o&&o[0]!==0&&o[1]!==0?[n/(o[0]-1),r/(o[1]-1),i]:[n,r,i]},t.normalizedViewportToViewport=(n,r,i,a)=>{const o=t.getViewportSize(a);return[n*(o[0]-1),r*(o[1]-1),i]},t.displayToLocalDisplay=(n,r,i)=>{const a=t.getFramebufferSize();return[n,a[1]-r-1,i]},t.viewportToNormalizedDisplay=(n,r,i,a)=>{let o=a.getViewportByReference();o=t.normalizedDisplayToDisplay(o[0],o[1],0);const s=n+o[0]+.5,l=r+o[1]+.5;return t.displayToNormalizedDisplay(s,l,i)},t.getComputedDevicePixelRatio=()=>e.size[0]/t.getContainerSize()[0],t.getContainerSize=()=>{le.vtkErrorMacro("not implemented")},t.getPixelData=(n,r,i,a)=>{le.vtkErrorMacro("not implemented")},t.createSelector=()=>{le.vtkErrorMacro("not implemented")}}const KSe={size:void 0,selector:void 0};function KX(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,KSe,n),e.size||(e.size=[300,300]),le.getArray(t,e,["size"],2),le.get(t,e,["selector"]),Rr.extend(t,e,n),HSe(t,e)}const qSe=le.newInstance(KX,"vtkRenderWindowViewNode");var XSe={newInstance:qSe,extend:KX};const YSe="__getUnderlyingContext";function JSe(){const t=new Map,e={apply(i,a,o){return t.has(o[0])?t.get(o[0]):i.apply(a,o)}};function n(i){return{apply(a,o,s){return t.set(i,s[0]),a.apply(o,s)}}}const r=Object.create(null);return r.getParameter=(i,a,o,s)=>new Proxy(s.bind(i),e),r.depthMask=(i,a,o,s)=>new Proxy(s.bind(i),n(i.DEPTH_WRITEMASK)),{get(i,a,o){if(a===YSe)return()=>i;let s=Reflect.get(i,a,i);s instanceof Function&&(s=s.bind(i));const l=r[a];return l?l(i,a,o,s):s}}}const{vtkDebugMacro:zL,vtkErrorMacro:WL}=le,ZSe={position:"absolute",top:0,left:0,width:"100%",height:"100%"},QSe=["activateTexture","deactivateTexture","disableCullFace","enableCullFace","get3DContext","getActiveFramebuffer","getContext","getDefaultTextureByteSize","getDefaultTextureInternalFormat","getDefaultToWebgl2","getGLInformations","getGraphicsMemoryInfo","getGraphicsResourceForObject","getHardwareMaximumLineWidth","getPixelData","getShaderCache","getTextureUnitForTexture","getTextureUnitManager","getWebgl2","makeCurrent","releaseGraphicsResources","registerGraphicsResourceUser","unregisterGraphicsResourceUser","restoreContext","setActiveFramebuffer","setContext","setDefaultToWebgl2","setGraphicsResourceForObject"];function zo(t,e,n){const r=t.createFramebuffer(),i=t.createTexture();t.bindTexture(t.TEXTURE_2D,i),t.texImage2D(t.TEXTURE_2D,0,e,2,2,0,e,n,null),t.bindFramebuffer(t.FRAMEBUFFER,r),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,i,0);const a=t.checkFramebufferStatus(t.FRAMEBUFFER);return t.bindFramebuffer(t.FRAMEBUFFER,null),t.bindTexture(t.TEXTURE_2D,null),a===t.FRAMEBUFFER_COMPLETE}let w3=0;const Qw=[];function eTe(){w3++,Qw.forEach(t=>t(w3))}function tTe(){w3--,Qw.forEach(t=>t(w3))}function nTe(t){Qw.push(t)}function rTe(t){return Qw.pop()}function HL(t){t.preventDefault()}function iTe(t,e){e.classHierarchy.push("vtkOpenGLRenderWindow");let n;function r(){return n||(n=JSe()),n}t.getViewNodeFactory=()=>e.myFactory,e.canvas.addEventListener("webglcontextlost",HL,!1),e.canvas.addEventListener("webglcontextrestored",t.restoreContext,!1);const i=[0,0];function a(){e.renderable&&(e.size[0]!==i[0]||e.size[1]!==i[1])&&(i[0]=e.size[0],i[1]=e.size[1],e.canvas.setAttribute("width",e.size[0]),e.canvas.setAttribute("height",e.size[1])),e.viewStream&&e.viewStream.setSize(e.size[0],e.size[1]),e.canvas.style.display=e.useOffScreen?"none":"block",e.el&&(e.el.style.cursor=e.cursorVisibility?e.cursor:"none"),e.containerSize=null}t.onModified(a),t.buildPass=u=>{if(u){if(!e.renderable)return;t.prepareNodes(),t.addMissingNodes(e.renderable.getRenderersByReference()),t.addMissingNodes(e.renderable.getChildRenderWindowsByReference()),t.removeUnusedNodes(),t.initialize(),e.children.forEach(d=>{d.setOpenGLRenderWindow?.(t)})}},t.initialize=()=>{if(!e.initialized){if(e.rootOpenGLRenderWindow=t.getLastAncestorOfType("vtkOpenGLRenderWindow"),e.rootOpenGLRenderWindow)e.context2D=t.get2DContext();else{e.context=t.get3DContext(),t.resizeFromChildRenderWindows(),e.context&&eTe(),e.textureUnitManager=WSe.newInstance(),e.textureUnitManager.setContext(e.context),e.shaderCache.setContext(e.context);const u=e.context;u.blendFuncSeparate(u.SRC_ALPHA,u.ONE_MINUS_SRC_ALPHA,u.ONE,u.ONE_MINUS_SRC_ALPHA),u.depthFunc(u.LEQUAL),u.enable(u.BLEND)}e.initialized=!0}},t.makeCurrent=()=>{e.context.makeCurrent()},t.setContainer=u=>{e.el&&e.el!==u&&(e.canvas.parentNode!==e.el&&WL("Error: canvas parent node does not match container"),e.el.removeChild(e.canvas),e.el.contains(e.bgImage)&&e.el.removeChild(e.bgImage)),e.el!==u&&(e.el=u,e.el&&(e.el.appendChild(e.canvas),e.useBackgroundImage&&e.el.appendChild(e.bgImage)),t.modified())},t.getContainer=()=>e.el,t.getContainerSize=()=>{if(!e.containerSize&&e.el){const{width:u,height:d}=e.el.getBoundingClientRect();e.containerSize=[u,d]}return e.containerSize||e.size},t.getFramebufferSize=()=>e.activeFramebuffer?.getSize()||e.size,t.getPixelData=(u,d,h,p)=>{const g=new Uint8Array((h-u+1)*(p-d+1)*4);return e.context.readPixels(u,d,h-u+1,p-d+1,e.context.RGBA,e.context.UNSIGNED_BYTE,g),g},t.get3DContext=function(){let u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{preserveDrawingBuffer:!1,depth:!0,alpha:!0,powerPreference:"high-performance"},d=null;const h=typeof WebGL2RenderingContext<"u";return e.webgl2=!1,e.defaultToWebgl2&&h&&(d=e.canvas.getContext("webgl2",u),d&&(e.webgl2=!0,zL("using webgl2"))),d||(zL("using webgl1"),d=e.canvas.getContext("webgl",u)||e.canvas.getContext("experimental-webgl",u)),new Proxy(d,r())},t.get2DContext=function(){let u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e.canvas.getContext("2d",u)},t.restoreContext=()=>{const u=bD.newInstance();u.setCurrentOperation("Release"),u.traverse(t,null)},t.activateTexture=u=>{const d=e._textureResourceIds.get(u);if(d!==void 0){e.context.activeTexture(e.context.TEXTURE0+d);return}const h=t.getTextureUnitManager().allocate();if(h<0){WL("Hardware does not support the number of textures defined.");return}e._textureResourceIds.set(u,h),e.context.activeTexture(e.context.TEXTURE0+h)},t.deactivateTexture=u=>{const d=e._textureResourceIds.get(u);d!==void 0&&(t.getTextureUnitManager().free(d),e._textureResourceIds.delete(u))},t.getTextureUnitForTexture=u=>{const d=e._textureResourceIds.get(u);return d!==void 0?d:-1},t.getDefaultTextureByteSize=function(u){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(e.webgl2)switch(u){case Nn.CHAR:case Nn.SIGNED_CHAR:case Nn.UNSIGNED_CHAR:return 1;case d:case h:case Nn.UNSIGNED_SHORT:case Nn.SHORT:case Nn.VOID:return 2;default:return 4}return 1},t.getDefaultTextureInternalFormat=function(u,d){let h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,p=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(e.webgl2)switch(u){case Nn.UNSIGNED_CHAR:switch(d){case 1:return e.context.R8;case 2:return e.context.RG8;case 3:return e.context.RGB8;case 4:default:return e.context.RGBA8}case(h&&!p&&Nn.UNSIGNED_SHORT):switch(d){case 1:return h.R16_EXT;case 2:return h.RG16_EXT;case 3:return h.RGB16_EXT;case 4:default:return h.RGBA16_EXT}case(h&&!p&&Nn.SHORT):switch(d){case 1:return h.R16_SNORM_EXT;case 2:return h.RG16_SNORM_EXT;case 3:return h.RGB16_SNORM_EXT;case 4:default:return h.RGBA16_SNORM_EXT}case Nn.UNSIGNED_SHORT:case Nn.SHORT:case Nn.FLOAT:default:switch(d){case 1:return p?e.context.R16F:e.context.R32F;case 2:return p?e.context.RG16F:e.context.RG32F;case 3:return p?e.context.RGB16F:e.context.RGB32F;case 4:default:return p?e.context.RGBA16F:e.context.RGBA32F}}switch(d){case 1:return e.context.LUMINANCE;case 2:return e.context.LUMINANCE_ALPHA;case 3:return e.context.RGB;case 4:default:return e.context.RGBA}},t.setBackgroundImage=u=>{e.bgImage.src=u.src},t.setUseBackgroundImage=u=>{e.useBackgroundImage=u,e.useBackgroundImage&&!e.el.contains(e.bgImage)?e.el.appendChild(e.bgImage):!e.useBackgroundImage&&e.el.contains(e.bgImage)&&e.el.removeChild(e.bgImage)};function o(){let u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:e.imageFormat;const d=document.createElement("canvas"),h=d.getContext("2d");d.width=e.canvas.width,d.height=e.canvas.height,h.drawImage(e.canvas,0,0);const p=e.canvas.getBoundingClientRect();e.renderable.getRenderers().forEach(v=>{v.getViewProps().forEach(w=>{if(w.getContainer){const T=w.getContainer().getElementsByTagName("canvas");for(let _=0;_<T.length;_++){const D=T[_],I=D.getBoundingClientRect(),R=I.x-p.x,M=I.y-p.y;h.drawImage(D,R,M)}}})});const y=d.toDataURL(u);d.remove(),t.invokeImageReady(y)}t.captureNextImage=function(){let u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"image/png",{resetCamera:d=!1,size:h=null,scale:p=1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e.deleted)return null;e.imageFormat=u;const g=e.notifyStartCaptureImage;return e.notifyStartCaptureImage=!0,e._screenshot={size:h||p!==1?h||e.size.map(m=>m*p):null},new Promise((m,y)=>{const v=t.onImageReady(x=>{if(e._screenshot.size===null)e.notifyStartCaptureImage=g,v.unsubscribe(),e._screenshot.placeHolder&&(e.size=e._screenshot.originalSize,t.modified(),e._screenshot.cameras&&e._screenshot.cameras.forEach(w=>{let{restoreParamsFn:S,arg:T}=w;return S(T)}),t.traverseAllPasses(),e.el.removeChild(e._screenshot.placeHolder),e._screenshot.placeHolder.remove(),e._screenshot=null),m(x);else{const w=document.createElement("img");if(w.style=ZSe,w.src=x,e._screenshot.placeHolder=e.el.appendChild(w),e.canvas.style.display="none",e._screenshot.originalSize=e.size,e.size=e._screenshot.size,e.rootOpenGLRenderWindow?.resizeFromChildRenderWindows(),e._screenshot.size=null,t.modified(),d){const S=d!==!0;e._screenshot.cameras=e.renderable.getRenderers().map(T=>{const _=T.getActiveCamera(),D=_.get("focalPoint","position","parallelScale");return{resetCameraArgs:S?{renderer:T}:void 0,resetCameraFn:S?d:T.resetCamera,restoreParamsFn:_.set,arg:JSON.parse(JSON.stringify(D))}}),e._screenshot.cameras.forEach(T=>{let{resetCameraFn:_,resetCameraArgs:D}=T;return _(D)})}t.traverseAllPasses()}})})};let s;t.getHardwareMaximumLineWidth=()=>{if(s!=null)return s;const u=t.get3DContext(),d=u.getParameter(u.ALIASED_LINE_WIDTH_RANGE);return s=d[1],d[1]},t.getGLInformations=()=>{if(e._glInformation)return e._glInformation;const u=t.get3DContext(),d=u.getExtension("OES_texture_float"),h=u.getExtension("OES_texture_half_float"),p=u.getExtension("WEBGL_debug_renderer_info"),g=u.getExtension("WEBGL_draw_buffers"),m=u.getExtension("EXT_texture_filter_anisotropic")||u.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),y=[["Max Vertex Attributes","MAX_VERTEX_ATTRIBS",u.getParameter(u.MAX_VERTEX_ATTRIBS)],["Max Varying Vectors","MAX_VARYING_VECTORS",u.getParameter(u.MAX_VARYING_VECTORS)],["Max Vertex Uniform Vectors","MAX_VERTEX_UNIFORM_VECTORS",u.getParameter(u.MAX_VERTEX_UNIFORM_VECTORS)],["Max Fragment Uniform Vectors","MAX_FRAGMENT_UNIFORM_VECTORS",u.getParameter(u.MAX_FRAGMENT_UNIFORM_VECTORS)],["Max Fragment Texture Image Units","MAX_TEXTURE_IMAGE_UNITS",u.getParameter(u.MAX_TEXTURE_IMAGE_UNITS)],["Max Vertex Texture Image Units","MAX_VERTEX_TEXTURE_IMAGE_UNITS",u.getParameter(u.MAX_VERTEX_TEXTURE_IMAGE_UNITS)],["Max Combined Texture Image Units","MAX_COMBINED_TEXTURE_IMAGE_UNITS",u.getParameter(u.MAX_COMBINED_TEXTURE_IMAGE_UNITS)],["Max 2D Texture Size","MAX_TEXTURE_SIZE",u.getParameter(u.MAX_TEXTURE_SIZE)],["Max Cube Texture Size","MAX_CUBE_MAP_TEXTURE_SIZE",u.getParameter(u.MAX_CUBE_MAP_TEXTURE_SIZE)],["Max Texture Anisotropy","MAX_TEXTURE_MAX_ANISOTROPY_EXT",m&&u.getParameter(m.MAX_TEXTURE_MAX_ANISOTROPY_EXT)],["Point Size Range","ALIASED_POINT_SIZE_RANGE",u.getParameter(u.ALIASED_POINT_SIZE_RANGE).join(" - ")],["Line Width Range","ALIASED_LINE_WIDTH_RANGE",u.getParameter(u.ALIASED_LINE_WIDTH_RANGE).join(" - ")],["Max Viewport Dimensions","MAX_VIEWPORT_DIMS",u.getParameter(u.MAX_VIEWPORT_DIMS).join(" - ")],["Max Renderbuffer Size","MAX_RENDERBUFFER_SIZE",u.getParameter(u.MAX_RENDERBUFFER_SIZE)],["Framebuffer Red Bits","RED_BITS",u.getParameter(u.RED_BITS)],["Framebuffer Green Bits","GREEN_BITS",u.getParameter(u.GREEN_BITS)],["Framebuffer Blue Bits","BLUE_BITS",u.getParameter(u.BLUE_BITS)],["Framebuffer Alpha Bits","ALPHA_BITS",u.getParameter(u.ALPHA_BITS)],["Framebuffer Depth Bits","DEPTH_BITS",u.getParameter(u.DEPTH_BITS)],["Framebuffer Stencil Bits","STENCIL_BITS",u.getParameter(u.STENCIL_BITS)],["Framebuffer Subpixel Bits","SUBPIXEL_BITS",u.getParameter(u.SUBPIXEL_BITS)],["MSAA Samples","SAMPLES",u.getParameter(u.SAMPLES)],["MSAA Sample Buffers","SAMPLE_BUFFERS",u.getParameter(u.SAMPLE_BUFFERS)],["Supported Formats for UByte Render Targets     ","UNSIGNED_BYTE RENDER TARGET FORMATS",[d&&zo(u,u.RGBA,u.UNSIGNED_BYTE)?"RGBA":"",d&&zo(u,u.RGB,u.UNSIGNED_BYTE)?"RGB":"",d&&zo(u,u.LUMINANCE,u.UNSIGNED_BYTE)?"LUMINANCE":"",d&&zo(u,u.ALPHA,u.UNSIGNED_BYTE)?"ALPHA":"",d&&zo(u,u.LUMINANCE_ALPHA,u.UNSIGNED_BYTE)?"LUMINANCE_ALPHA":""].join(" ")],["Supported Formats for Half Float Render Targets","HALF FLOAT RENDER TARGET FORMATS",[h&&zo(u,u.RGBA,h.HALF_FLOAT_OES)?"RGBA":"",h&&zo(u,u.RGB,h.HALF_FLOAT_OES)?"RGB":"",h&&zo(u,u.LUMINANCE,h.HALF_FLOAT_OES)?"LUMINANCE":"",h&&zo(u,u.ALPHA,h.HALF_FLOAT_OES)?"ALPHA":"",h&&zo(u,u.LUMINANCE_ALPHA,h.HALF_FLOAT_OES)?"LUMINANCE_ALPHA":""].join(" ")],["Supported Formats for Full Float Render Targets","FLOAT RENDER TARGET FORMATS",[d&&zo(u,u.RGBA,u.FLOAT)?"RGBA":"",d&&zo(u,u.RGB,u.FLOAT)?"RGB":"",d&&zo(u,u.LUMINANCE,u.FLOAT)?"LUMINANCE":"",d&&zo(u,u.ALPHA,u.FLOAT)?"ALPHA":"",d&&zo(u,u.LUMINANCE_ALPHA,u.FLOAT)?"LUMINANCE_ALPHA":""].join(" ")],["Max Multiple Render Targets Buffers","MAX_DRAW_BUFFERS_WEBGL",g?u.getParameter(g.MAX_DRAW_BUFFERS_WEBGL):0],["High Float Precision in Vertex Shader","HIGH_FLOAT VERTEX_SHADER",[u.getShaderPrecisionFormat(u.VERTEX_SHADER,u.HIGH_FLOAT).precision," (-2<sup>",u.getShaderPrecisionFormat(u.VERTEX_SHADER,u.HIGH_FLOAT).rangeMin,"</sup> - 2<sup>",u.getShaderPrecisionFormat(u.VERTEX_SHADER,u.HIGH_FLOAT).rangeMax,"</sup>)"].join("")],["Medium Float Precision in Vertex Shader","MEDIUM_FLOAT VERTEX_SHADER",[u.getShaderPrecisionFormat(u.VERTEX_SHADER,u.MEDIUM_FLOAT).precision," (-2<sup>",u.getShaderPrecisionFormat(u.VERTEX_SHADER,u.MEDIUM_FLOAT).rangeMin,"</sup> - 2<sup>",u.getShaderPrecisionFormat(u.VERTEX_SHADER,u.MEDIUM_FLOAT).rangeMax,"</sup>)"].join("")],["Low Float Precision in Vertex Shader","LOW_FLOAT VERTEX_SHADER",[u.getShaderPrecisionFormat(u.VERTEX_SHADER,u.LOW_FLOAT).precision," (-2<sup>",u.getShaderPrecisionFormat(u.VERTEX_SHADER,u.LOW_FLOAT).rangeMin,"</sup> - 2<sup>",u.getShaderPrecisionFormat(u.VERTEX_SHADER,u.LOW_FLOAT).rangeMax,"</sup>)"].join("")],["High Float Precision in Fragment Shader","HIGH_FLOAT FRAGMENT_SHADER",[u.getShaderPrecisionFormat(u.FRAGMENT_SHADER,u.HIGH_FLOAT).precision," (-2<sup>",u.getShaderPrecisionFormat(u.FRAGMENT_SHADER,u.HIGH_FLOAT).rangeMin,"</sup> - 2<sup>",u.getShaderPrecisionFormat(u.FRAGMENT_SHADER,u.HIGH_FLOAT).rangeMax,"</sup>)"].join("")],["Medium Float Precision in Fragment Shader","MEDIUM_FLOAT FRAGMENT_SHADER",[u.getShaderPrecisionFormat(u.FRAGMENT_SHADER,u.MEDIUM_FLOAT).precision," (-2<sup>",u.getShaderPrecisionFormat(u.FRAGMENT_SHADER,u.MEDIUM_FLOAT).rangeMin,"</sup> - 2<sup>",u.getShaderPrecisionFormat(u.FRAGMENT_SHADER,u.MEDIUM_FLOAT).rangeMax,"</sup>)"].join("")],["Low Float Precision in Fragment Shader","LOW_FLOAT FRAGMENT_SHADER",[u.getShaderPrecisionFormat(u.FRAGMENT_SHADER,u.LOW_FLOAT).precision," (-2<sup>",u.getShaderPrecisionFormat(u.FRAGMENT_SHADER,u.LOW_FLOAT).rangeMin,"</sup> - 2<sup>",u.getShaderPrecisionFormat(u.FRAGMENT_SHADER,u.LOW_FLOAT).rangeMax,"</sup>)"].join("")],["High Int Precision in Vertex Shader","HIGH_INT VERTEX_SHADER",[u.getShaderPrecisionFormat(u.VERTEX_SHADER,u.HIGH_INT).precision," (-2<sup>",u.getShaderPrecisionFormat(u.VERTEX_SHADER,u.HIGH_INT).rangeMin,"</sup> - 2<sup>",u.getShaderPrecisionFormat(u.VERTEX_SHADER,u.HIGH_INT).rangeMax,"</sup>)"].join("")],["Medium Int Precision in Vertex Shader","MEDIUM_INT VERTEX_SHADER",[u.getShaderPrecisionFormat(u.VERTEX_SHADER,u.MEDIUM_INT).precision," (-2<sup>",u.getShaderPrecisionFormat(u.VERTEX_SHADER,u.MEDIUM_INT).rangeMin,"</sup> - 2<sup>",u.getShaderPrecisionFormat(u.VERTEX_SHADER,u.MEDIUM_INT).rangeMax,"</sup>)"].join("")],["Low Int Precision in Vertex Shader","LOW_INT VERTEX_SHADER",[u.getShaderPrecisionFormat(u.VERTEX_SHADER,u.LOW_INT).precision," (-2<sup>",u.getShaderPrecisionFormat(u.VERTEX_SHADER,u.LOW_INT).rangeMin,"</sup> - 2<sup>",u.getShaderPrecisionFormat(u.VERTEX_SHADER,u.LOW_INT).rangeMax,"</sup>)"].join("")],["High Int Precision in Fragment Shader","HIGH_INT FRAGMENT_SHADER",[u.getShaderPrecisionFormat(u.FRAGMENT_SHADER,u.HIGH_INT).precision," (-2<sup>",u.getShaderPrecisionFormat(u.FRAGMENT_SHADER,u.HIGH_INT).rangeMin,"</sup> - 2<sup>",u.getShaderPrecisionFormat(u.FRAGMENT_SHADER,u.HIGH_INT).rangeMax,"</sup>)"].join("")],["Medium Int Precision in Fragment Shader","MEDIUM_INT FRAGMENT_SHADER",[u.getShaderPrecisionFormat(u.FRAGMENT_SHADER,u.MEDIUM_INT).precision," (-2<sup>",u.getShaderPrecisionFormat(u.FRAGMENT_SHADER,u.MEDIUM_INT).rangeMin,"</sup> - 2<sup>",u.getShaderPrecisionFormat(u.FRAGMENT_SHADER,u.MEDIUM_INT).rangeMax,"</sup>)"].join("")],["Low Int Precision in Fragment Shader","LOW_INT FRAGMENT_SHADER",[u.getShaderPrecisionFormat(u.FRAGMENT_SHADER,u.LOW_INT).precision," (-2<sup>",u.getShaderPrecisionFormat(u.FRAGMENT_SHADER,u.LOW_INT).rangeMin,"</sup> - 2<sup>",u.getShaderPrecisionFormat(u.FRAGMENT_SHADER,u.LOW_INT).rangeMax,"</sup>)"].join("")],["Supported Extensions","EXTENSIONS",u.getSupportedExtensions().join("<br/>					    ")],["WebGL Renderer","RENDERER",u.getParameter(u.RENDERER)],["WebGL Vendor","VENDOR",u.getParameter(u.VENDOR)],["WebGL Version","VERSION",u.getParameter(u.VERSION)],["Shading Language Version","SHADING_LANGUAGE_VERSION",u.getParameter(u.SHADING_LANGUAGE_VERSION)],["Unmasked Renderer","UNMASKED_RENDERER",p&&u.getParameter(p.UNMASKED_RENDERER_WEBGL)],["Unmasked Vendor","UNMASKED_VENDOR",p&&u.getParameter(p.UNMASKED_VENDOR_WEBGL)],["WebGL Version","WEBGL_VERSION",e.webgl2?2:1]],v={};for(;y.length;){const[x,w,S]=y.pop();w&&(v[w]={label:x,value:S})}return e._glInformation=v,v},t.traverseAllPasses=()=>{if(e.renderPasses)for(let d=0;d<e.renderPasses.length;++d)e.renderPasses[d].traverse(t,null);t.copyParentContent(),e.notifyStartCaptureImage&&o();const u=e.renderable.getChildRenderWindowsByReference();for(let d=0;d<u.length;++d)t.getViewNodeFor(u[d])?.traverseAllPasses()},t.copyParentContent=()=>{const u=e.rootOpenGLRenderWindow;if(!u||!e.context2D||e.children.some(p=>!!p.getSelector?.()))return;const d=u.getCanvas(),h=e.canvas;e.context2D.drawImage(d,0,d.height-h.height,h.width,h.height,0,0,h.width,h.height)},t.resizeFromChildRenderWindows=()=>{const u=e.renderable.getChildRenderWindowsByReference();if(u.length>0){const d=[0,0];for(let h=0;h<u.length;++h){const p=t.getViewNodeFor(u[h])?.getSize();p&&(d[0]=p[0]>d[0]?p[0]:d[0],d[1]=p[1]>d[1]?p[1]:d[1])}t.setSize(...d)}},t.disableCullFace=()=>{e.cullFaceEnabled&&(e.context.disable(e.context.CULL_FACE),e.cullFaceEnabled=!1)},t.enableCullFace=()=>{e.cullFaceEnabled||(e.context.enable(e.context.CULL_FACE),e.cullFaceEnabled=!0)},t.setViewStream=u=>{if(e.viewStream===u)return!1;if(e.subscription&&(e.subscription.unsubscribe(),e.subscription=null),e.viewStream=u,e.viewStream){const d=e.renderable.getRenderers()[0];d.getBackgroundByReference()[3]=0,t.setUseBackgroundImage(!0),e.subscription=e.viewStream.onImageReady(h=>t.setBackgroundImage(h.image)),e.viewStream.setSize(e.size[0],e.size[1]),e.viewStream.invalidateCache(),e.viewStream.render(),t.modified()}return!0},t.createSelector=()=>{const u=wD.newInstance();return u.setOpenGLRenderWindow(t),u};function l(){e.canvas.removeEventListener("webglcontextlost",HL),e.canvas.removeEventListener("webglcontextrestored",t.restoreContext)}t.delete=le.chain(()=>{e.context&&tTe(),t.setContainer(),t.setViewStream()},l,t.delete),t.setActiveFramebuffer=u=>{e.activeFramebuffer=u};const c=t.setSize;t.setSize=(u,d)=>{const h=c(u,d);return h&&t.invokeWindowResizeEvent({width:u,height:d}),h},t.registerGraphicsResourceUser=(u,d)=>{e._graphicsResources.has(u)||t.setGraphicsResourceForObject(u,null,null),e._graphicsResources.get(u)?.users.add(d)},t.unregisterGraphicsResourceUser=(u,d)=>{const h=e._graphicsResources.get(u);h&&(h.users.delete(d),h.users.size||(h.oglObject?.releaseGraphicsResources(t),e._graphicsResources.delete(u)))},t.getGraphicsResourceForObject=u=>e._graphicsResources.get(u),t.setGraphicsResourceForObject=(u,d,h)=>{if(!u)return;const p=e._graphicsResources.get(u);p?.oglObject?.releaseGraphicsResources(t),e._graphicsResources.set(u,{coreObject:u,oglObject:d,hash:h,users:p?.users??new Set})},t.getGraphicsMemoryInfo=()=>{let u=0;return e._graphicsResources.forEach(d=>{let{oglObject:h}=d;u+=h.getAllocatedGPUMemoryInBytes()}),u},t.releaseGraphicsResources=()=>{e.shaderCache!==null&&e.shaderCache.releaseGraphicsResources(t),e._graphicsResources.forEach(u=>{let{oglObject:d}=u;d.releaseGraphicsResources(t)}),e._graphicsResources.clear(),e.textureUnitManager!==null&&e.textureUnitManager.freeAll(),e.renderable.getRenderersByReference().forEach(u=>{t.getViewNodeFor(u)?.releaseGraphicsResources()})};const f={...t};QSe.forEach(u=>{t[u]=function(){return e.rootOpenGLRenderWindow?e.rootOpenGLRenderWindow[u](...arguments):f[u](...arguments)}})}const aTe={cullFaceEnabled:!1,shaderCache:null,initialized:!1,context:null,context2D:null,canvas:null,cursorVisibility:!0,cursor:"pointer",textureUnitManager:null,textureResourceIds:null,containerSize:null,renderPasses:[],notifyStartCaptureImage:!1,webgl2:!1,defaultToWebgl2:!0,activeFramebuffer:null,imageFormat:"image/png",useOffScreen:!1,useBackgroundImage:!1};function qX(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,aTe,n),XSe.extend(t,e,n),e.canvas||(e.canvas=document.createElement("canvas"),e.canvas.style.width="100%"),e.selector||(e.selector=wD.newInstance(),e.selector.setOpenGLRenderWindow(t)),e.bgImage=new Image,e.bgImage.style.position="absolute",e.bgImage.style.left="0",e.bgImage.style.top="0",e.bgImage.style.width="100%",e.bgImage.style.height="100%",e.bgImage.style.zIndex="-1",e._textureResourceIds=new Map,e._graphicsResources=new Map,e._glInformation=null,e.myFactory=gxe.newInstance(),e.shaderCache=BSe.newInstance(),e.shaderCache.setOpenGLRenderWindow(t),e.renderPasses[0]=gSe.newInstance(),le.get(t,e,["shaderCache","textureUnitManager","webgl2","useBackgroundImage","activeFramebuffer","rootOpenGLRenderWindow"]),le.setGet(t,e,["initialized","context","context2D","canvas","renderPasses","notifyStartCaptureImage","defaultToWebgl2","cursor","useOffScreen"]),le.setGetArray(t,e,["size"],2),le.event(t,e,"imageReady"),le.event(t,e,"windowResizeEvent"),iTe(t,e)}const CD=le.newInstance(qX,"vtkOpenGLRenderWindow");MX("WebGL",CD);var oTe={newInstance:CD,extend:qX,pushMonitorGLContextCount:nTe,popMonitorGLContextCount:rTe};sa("vtkRenderWindow",CD);function sTe(t,e){e.classHierarchy.push("vtkOpenGLActor"),t.buildPass=n=>{if(n){e._openGLRenderWindow=t.getLastAncestorOfType("vtkOpenGLRenderWindow"),e._openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e.context=e._openGLRenderWindow.getContext(),t.prepareNodes(),t.addMissingNodes(e.renderable.getTextures()),t.addMissingNode(e.renderable.getMapper()),t.removeUnusedNodes(),e.ogltextures=null,e.activeTextures=null;for(let r=0;r<e.children.length;r++){const i=e.children[r];i.isA("vtkOpenGLTexture")?(e.ogltextures||(e.ogltextures=[]),e.ogltextures.push(i)):e.oglmapper=i}}},t.traverseZBufferPass=n=>{!e.renderable||!e.renderable.getNestedVisibility()||e._openGLRenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(n,!0),e.oglmapper.traverse(n),t.apply(n,!1))},t.traverseOpaqueZBufferPass=n=>t.traverseOpaquePass(n),t.traverseOpaquePass=n=>{!e.renderable||!e.renderable.getNestedVisibility()||!e.renderable.getIsOpaque()||e._openGLRenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(n,!0),e.oglmapper.traverse(n),t.apply(n,!1))},t.traverseTranslucentPass=n=>{!e.renderable||!e.renderable.getNestedVisibility()||e.renderable.getIsOpaque()||e._openGLRenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(n,!0),e.oglmapper.traverse(n),t.apply(n,!1))},t.activateTextures=()=>{if(e.ogltextures){e.activeTextures=[];for(let n=0;n<e.ogltextures.length;n++){const r=e.ogltextures[n];r.render(),r.getHandle()&&e.activeTextures.push(r)}}},t.queryPass=(n,r)=>{if(n){if(!e.renderable||!e.renderable.getVisibility())return;e.renderable.getIsOpaque()?r.incrementOpaqueActorCount():r.incrementTranslucentActorCount()}},t.zBufferPass=(n,r)=>t.opaquePass(n,r),t.opaqueZBufferPass=(n,r)=>t.opaquePass(n,r),t.opaquePass=(n,r)=>{if(n)e.context.depthMask(!0),t.activateTextures();else if(e.activeTextures)for(let i=0;i<e.activeTextures.length;i++)e.activeTextures[i].deactivate()},t.translucentPass=(n,r)=>{if(n)e.context.depthMask(e._openGLRenderer.getSelector()&&e.renderable.getNestedPickable()),t.activateTextures();else if(e.activeTextures)for(let i=0;i<e.activeTextures.length;i++)e.activeTextures[i].deactivate()},t.getKeyMatrices=()=>(e.renderable.getMTime()>e.keyMatrixTime.getMTime()&&(e.renderable.computeMatrix(),Ei(e.keyMatrices.mcwc,e.renderable.getMatrix()),Gn(e.keyMatrices.mcwc,e.keyMatrices.mcwc),e.renderable.getIsIdentity()?Ll(e.keyMatrices.normalMatrix):(Ww(e.keyMatrices.normalMatrix,e.keyMatrices.mcwc),iy(e.keyMatrices.normalMatrix,e.keyMatrices.normalMatrix),X9(e.keyMatrices.normalMatrix,e.keyMatrices.normalMatrix)),e.keyMatrixTime.modified()),e.keyMatrices)}const lTe={context:null,keyMatrixTime:null,keyMatrices:null,activeTextures:null};function cTe(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,lTe,n),Rr.extend(t,e,n),e.keyMatrixTime={},$r(e.keyMatrixTime,{mtime:0}),e.keyMatrices={normalMatrix:Ll(new Float64Array(9)),mcwc:sn(new Float64Array(16))},Mi(t,e,["context"]),Po(t,e,["activeTextures"]),sTe(t,e)}const XX=Zn(cTe);var uTe={newInstance:XX};sa("vtkActor",XX);function fTe(t,e){e.classHierarchy.push("vtkOpenGLActor2D"),t.buildPass=n=>{if(n){if(!e.renderable)return;e._openGLRenderWindow=t.getLastAncestorOfType("vtkOpenGLRenderWindow"),e._openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e.context=e._openGLRenderWindow.getContext(),t.prepareNodes(),t.addMissingNodes(e.renderable.getTextures()),t.addMissingNode(e.renderable.getMapper()),t.removeUnusedNodes(),e.ogltextures=null,e.activeTextures=null;for(let r=0;r<e.children.length;r++){const i=e.children[r];i.isA("vtkOpenGLTexture")?(e.ogltextures||(e.ogltextures=[]),e.ogltextures.push(i)):e.oglmapper=i}}},t.queryPass=(n,r)=>{if(n){if(!e.renderable||!e.renderable.getVisibility())return;r.incrementOverlayActorCount()}},t.traverseOpaquePass=n=>{!e.oglmapper||!e.renderable||!e.renderable.getNestedVisibility()||!e.renderable.getIsOpaque()||e._openGLRenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(n,!0),e.oglmapper.traverse(n),t.apply(n,!1))},t.traverseTranslucentPass=n=>{!e.oglmapper||!e.renderable||!e.renderable.getNestedVisibility()||e.renderable.getIsOpaque()||e._openGLRenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(n,!0),e.oglmapper.traverse(n),t.apply(n,!1))},t.traverseOverlayPass=n=>{!e.oglmapper||!e.renderable||!e.renderable.getNestedVisibility()||e._openGLRenderer.getSelector()&&!e.renderable.getNestedPickable||(t.apply(n,!0),e.oglmapper.traverse(n),t.apply(n,!1))},t.activateTextures=()=>{if(e.ogltextures){e.activeTextures=[];for(let n=0;n<e.ogltextures.length;n++){const r=e.ogltextures[n];r.render(),r.getHandle()&&e.activeTextures.push(r)}}},t.opaquePass=(n,r)=>{if(n)e.context.depthMask(!0),t.activateTextures();else if(e.activeTextures)for(let i=0;i<e.activeTextures.length;i++)e.activeTextures[i].deactivate()},t.translucentPass=(n,r)=>{if(n)e.context.depthMask(!1),t.activateTextures();else if(e.activeTextures)for(let i=0;i<e.activeTextures.length;i++)e.activeTextures[i].deactivate()},t.overlayPass=(n,r)=>{if(n)e.context.depthMask(!0),t.activateTextures();else if(e.activeTextures)for(let i=0;i<e.activeTextures.length;i++)e.activeTextures[i].deactivate()}}const dTe={context:null,activeTextures:null};function hTe(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,dTe,n),Rr.extend(t,e,n),Mi(t,e,["context"]),Po(t,e,["activeTextures"]),fTe(t,e)}const YX=Zn(hTe);var pTe={newInstance:YX};sa("vtkActor2D",YX);function gTe(t,e){e.classHierarchy.push("vtkAbstractMapper"),t.update=()=>{t.getInputData()},t.addClippingPlane=n=>n.isA("vtkPlane")?e.clippingPlanes.includes(n)?!1:(e.clippingPlanes.push(n),t.modified(),!0):!1,t.getNumberOfClippingPlanes=()=>e.clippingPlanes.length,t.removeAllClippingPlanes=()=>e.clippingPlanes.length===0?!1:(e.clippingPlanes.length=0,t.modified(),!0),t.removeClippingPlane=n=>{const r=e.clippingPlanes.indexOf(n);return r===-1?!1:(e.clippingPlanes.splice(r,1),t.modified(),!0)},t.getClippingPlanes=()=>e.clippingPlanes,t.setClippingPlanes=n=>{if(n)if(!Array.isArray(n))t.addClippingPlane(n);else{const r=n.length;for(let i=0;i<r&&i<6;i++)t.addClippingPlane(n[i])}},t.getClippingPlaneInDataCoords=(n,r,i)=>{const a=e.clippingPlanes,o=n;if(a){const s=a.length;if(r>=0&&r<s){const l=a[r],c=l.getNormal(),f=l.getOrigin(),u=c[0],d=c[1],h=c[2],p=-(u*f[0]+d*f[1]+h*f[2]);i[0]=u*o[0]+d*o[4]+h*o[8]+p*o[12],i[1]=u*o[1]+d*o[5]+h*o[9]+p*o[13],i[2]=u*o[2]+d*o[6]+h*o[10]+p*o[14],i[3]=u*o[3]+d*o[7]+h*o[11]+p*o[15];return}}le.vtkErrorMacro(`Clipping plane index ${r} is out of range.`)}}const mTe={clippingPlanes:[]};function vTe(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,mTe,n),le.obj(t,e),le.algo(t,e,1,0),e.clippingPlanes||(e.clippingPlanes=[]),gTe(t,e)}var JX={extend:vTe};function yTe(t,e){t.getBounds=()=>(le.vtkErrorMacro("vtkAbstractMapper3D.getBounds - NOT IMPLEMENTED"),d0()),t.getCenter=()=>{const n=t.getBounds();return e.center=wr.isValid(n)?wr.getCenter(n):null,e.center?.slice()},t.getLength=()=>{const n=t.getBounds();return wr.getDiagonalLength(n)}}const xTe=t=>({bounds:[...wr.INIT_BOUNDS],center:[0,0,0],viewSpecificProperties:{},...t});function bTe(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,xTe(n)),JX.extend(t,e,n),le.setGet(t,e,["viewSpecificProperties"]),yTe(t,e)}var SD={extend:bTe};const{vtkErrorMacro:KL}=le,qL=0,XL=1,XT=2;function wTe(t,e){e.classHierarchy.push("vtkLookupTable"),t.isOpaque=()=>{if(e.opaqueFlagBuildTime.getMTime()<t.getMTime()){let n=!0;e.nanColor[3]<1&&(n=0),e.useBelowRangeColor&&e.belowRangeColor[3]<1&&(n=0),e.useAboveRangeColor&&e.aboveRangeColor[3]<1&&(n=0);for(let r=3;r<e.table.length&&n;r+=4)e.table[r]<255&&(n=!1);e.opaqueFlag=n,e.opaqueFlagBuildTime.modified()}return e.opaqueFlag},t.usingLogScale=()=>!1,t.getNumberOfAvailableColors=()=>e.table.length/4-3,t.linearIndexLookup=(n,r)=>{let i=0;const a=Number(n);return a<r.range[0]?i=r.maxIndex+qL+1.5:a>r.range[1]?i=r.maxIndex+XL+1.5:(i=(a+r.shift)*r.scale,i=i<r.maxIndex?i:r.maxIndex),Math.floor(i)},t.linearLookup=(n,r,i)=>{let a=0;s3(n)?a=Math.floor(i.maxIndex+1.5+XT):a=t.linearIndexLookup(n,i);const o=4*a;return r.slice(o,o+4)},t.indexedLookupFunction=(n,r,i)=>{let a=t.getAnnotatedValueIndexInternal(n);a===-1&&(a=e.numberOfColors+XT);const o=4*a;return[r[o],r[o+1],r[o+2],r[o+3]]},t.lookupShiftAndScale=(n,r)=>{r.shift=-n[0],r.scale=Number.MAX_VALUE,n[1]>n[0]&&(r.scale=(r.maxIndex+1)/(n[1]-n[0]))},t.mapScalarsThroughTable=(n,r,i,a)=>{let o=t.linearLookup;e.indexedLookup&&(o=t.indexedLookupFunction);const s=t.getMappingRange(),l={maxIndex:t.getNumberOfColors()-1,range:s,shift:0,scale:0};t.lookupShiftAndScale(s,l);const c=t.getAlpha(),f=n.getNumberOfTuples(),u=n.getNumberOfComponents(),d=r.getData(),h=n.getData();if(c>=1){if(i===p6.RGBA)for(let p=0;p<f;p++){const g=o(h[p*u+a],e.table,l);d[p*4]=g[0],d[p*4+1]=g[1],d[p*4+2]=g[2],d[p*4+3]=g[3]}}else if(i===p6.RGBA)for(let p=0;p<f;p++){const g=o(h[p*u+a],e.table,l);d[p*4]=g[0],d[p*4+1]=g[1],d[p*4+2]=g[2],d[p*4+3]=Math.floor(g[3]*c+.5)}},t.forceBuild=()=>{let n=0,r=0,i=0,a=0;const o=e.numberOfColors-1;o&&(n=(e.hueRange[1]-e.hueRange[0])/o,r=(e.saturationRange[1]-e.saturationRange[0])/o,i=(e.valueRange[1]-e.valueRange[0])/o,a=(e.alphaRange[1]-e.alphaRange[0])/o),e.table.length=4*o+16;const s=[],l=[];for(let c=0;c<=o;c++)s[0]=e.hueRange[0]+c*n,s[1]=e.saturationRange[0]+c*r,s[2]=e.valueRange[0]+c*i,gh(s,l),l[3]=e.alphaRange[0]+c*a,e.table[c*4]=l[0]*255+.5,e.table[c*4+1]=l[1]*255+.5,e.table[c*4+2]=l[2]*255+.5,e.table[c*4+3]=l[3]*255+.5;t.buildSpecialColors(),e.buildTime.modified()},t.setTable=n=>{if(Array.isArray(n)){const i=n[0].length;e.numberOfColors=n.length;const a=4-i;let o=0;for(let s=0;s<e.numberOfColors;s++)e.table[s*4]=255,e.table[s*4+1]=255,e.table[s*4+2]=255,e.table[s*4+3]=255;for(let s=0;s<n.length;s++){const l=n[s];for(let c=0;c<i;c++)e.table[o++]=l[c];o+=a}return t.buildSpecialColors(),e.insertTime.modified(),t.modified(),!0}if(n.getNumberOfComponents()!==4)return KL("Expected 4 components for RGBA colors"),!1;if(n.getDataType()!==Nn.UNSIGNED_CHAR)return KL("Expected unsigned char values for RGBA colors"),!1;e.numberOfColors=n.getNumberOfTuples();const r=n.getData();e.table.length=r.length;for(let i=0;i<r.length;i++)e.table[i]=r[i];return t.buildSpecialColors(),e.insertTime.modified(),t.modified(),!0},t.buildSpecialColors=()=>{const{numberOfColors:n}=e,r=e.table;let i=(n+qL)*4;e.useBelowRangeColor||n===0?(r[i]=e.belowRangeColor[0]*255+.5,r[i+1]=e.belowRangeColor[1]*255+.5,r[i+2]=e.belowRangeColor[2]*255+.5,r[i+3]=e.belowRangeColor[3]*255+.5):(r[i]=r[0],r[i+1]=r[1],r[i+2]=r[2],r[i+3]=r[3]),i=(n+XL)*4,e.useAboveRangeColor||n===0?(r[i]=e.aboveRangeColor[0]*255+.5,r[i+1]=e.aboveRangeColor[1]*255+.5,r[i+2]=e.aboveRangeColor[2]*255+.5,r[i+3]=e.aboveRangeColor[3]*255+.5):(r[i]=r[4*(n-1)+0],r[i+1]=r[4*(n-1)+1],r[i+2]=r[4*(n-1)+2],r[i+3]=r[4*(n-1)+3]),i=(n+XT)*4,r[i]=e.nanColor[0]*255+.5,r[i+1]=e.nanColor[1]*255+.5,r[i+2]=e.nanColor[2]*255+.5,r[i+3]=e.nanColor[3]*255+.5},t.build=()=>{(e.table.length<1||t.getMTime()>e.buildTime.getMTime()&&e.insertTime.getMTime()<=e.buildTime.getMTime())&&t.forceBuild()},e.table.length>0&&(t.buildSpecialColors(),e.insertTime.modified())}const CTe={numberOfColors:256,hueRange:[0,.66667],saturationRange:[1,1],valueRange:[1,1],alphaRange:[1,1],nanColor:[.5,0,0,1],belowRangeColor:[0,0,0,1],aboveRangeColor:[1,1,1,1],useAboveRangeColor:!1,useBelowRangeColor:!1,alpha:1};function ZX(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,CTe,n),Gw.extend(t,e,n),e.table||(e.table=[]),e.buildTime={},le.obj(e.buildTime),e.opaqueFlagBuildTime={},le.obj(e.opaqueFlagBuildTime,{mtime:0}),e.insertTime={},le.obj(e.insertTime,{mtime:0}),le.get(t,e,["buildTime"]),le.setGet(t,e,["numberOfColors","useAboveRangeColor","useBelowRangeColor"]),le.setArray(t,e,["alphaRange","hueRange","saturationRange","valueRange"],2),le.setArray(t,e,["nanColor","belowRangeColor","aboveRangeColor"],4),le.getArray(t,e,["hueRange","saturationRange","valueRange","alphaRange","nanColor","belowRangeColor","aboveRangeColor"]),wTe(t,e)}const STe=le.newInstance(ZX,"vtkLookupTable");var C3={newInstance:STe,extend:ZX};const{FieldAssociations:YL}=Lm,{staticOffsetAPI:TTe,otherStaticMethods:ETe}=Xw,{ColorMode:ix,ScalarMode:X0,GetArray:YT}=$w,{VectorMode:_Te}=V9,{VtkDataTypes:DTe}=nn;function q1(t){return()=>le.vtkErrorMacro(`vtkMapper::${t} - NOT IMPLEMENTED`)}function OTe(t,e){const n=t[1]%2===0?1:-1;if(t[0]+=n,t[0]>=e[0]||t[0]<0){const r=t[2]%2===0?1:-1;t[0]-=n,t[1]+=r,(t[1]>=e[1]||t[1]<0)&&(t[1]-=r,t[2]++)}}function MTe(t,e){return t[0]+e[0]*(t[1]+e[1]*t[2])}function JL(t,e,n){const r=Math.floor(e),i=r%(2*n[0]);let a,o;i<n[0]?(t[0]=i,a=1,o=t[0]===n[0]-1):(t[0]=2*n[0]-1-i,a=-1,o=t[0]===0);const s=Math.floor(r/n[0]),l=s%(2*n[1]);let c,f;l<n[1]?(t[1]=l,c=1,f=t[1]===n[1]-1):(t[1]=2*n[1]-1-l,c=-1,f=t[1]===0),t[2]=Math.floor(s/n[1]);const u=e-r;o?f?t[2]+=u:t[1]+=c*u:t[0]+=a*u,t[0]=(t[0]+.5)/n[0],t[1]=(t[1]+.5)/n[1],t[2]=(t[2]+.5)/n[2]}const ZL=new WeakMap;function ITe(t,e,n,r,i,a,o){const s=new Array(arguments.length);for(let A=0;A<arguments.length;++A){const L=arguments[A];s[A]=L.getMTime?.()??L}const l=s.join("/"),c=ZL.get(t);if(c&&c.stringHash===l)return c.textureCoordinates;const f=(n[1]-n[0])/(r-1),[u,d]=[n[0]-f,n[1]+f],h=u-.5*f,p=1/(d-u+f),g=u,m=(r+1)/(d-u),y=t.getData(),v=t.getNumberOfTuples(),x=t.getNumberOfComponents(),w=e<0||e>=x,S=i[2]<=1?2:3,T=nn.newInstance({numberOfComponents:S,values:new Float32Array(v*S)}),_=T.getData(),D=[0,0,0];JL(D,r+2,i);let I=0,R=0;const M=[.5,.5,.5];for(let A=0;A<v;++A){let L;if(w){let P=0;for(let B=0;B<x;++B){const U=y[I+B];P+=U*U}L=Math.sqrt(P)}else L=y[I+e];if(I+=x,a&&(L=C3.applyLogScale(L,n,n)),s3(L))M[0]=D[0],M[1]=D[1],M[2]=D[2];else if(o){let P=(L-g)*m;P<1?P=0:P>r&&(P=r+1),JL(M,P,i)}else{M[1]=.49;const P=(L-h)*p;P>1e3?M[0]=1e3:P<-1e3?M[0]=-1e3:M[0]=P}for(let P=0;P<S;++P)_[R++]=M[P]}return ZL.set(t,{stringHash:l,textureCoordinates:T}),T}function RTe(t,e){e.classHierarchy.push("vtkMapper"),t.getBounds=()=>{const n=t.getInputData();return n?(e.static||t.update(),e.bounds=n.getBounds()):e.bounds=d0(),e.bounds},t.setForceCompileOnly=n=>{e.forceCompileOnly=n},t.setSelectionWebGLIdsToVTKIds=n=>{e.selectionWebGLIdsToVTKIds=n},t.createDefaultLookupTable=()=>{e.lookupTable=C3.newInstance()},t.getColorModeAsString=()=>le.enumToString(ix,e.colorMode),t.setColorModeToDefault=()=>t.setColorMode(0),t.setColorModeToMapScalars=()=>t.setColorMode(1),t.setColorModeToDirectScalars=()=>t.setColorMode(2),t.getScalarModeAsString=()=>le.enumToString(X0,e.scalarMode),t.setScalarModeToDefault=()=>t.setScalarMode(0),t.setScalarModeToUsePointData=()=>t.setScalarMode(1),t.setScalarModeToUseCellData=()=>t.setScalarMode(2),t.setScalarModeToUsePointFieldData=()=>t.setScalarMode(3),t.setScalarModeToUseCellFieldData=()=>t.setScalarMode(4),t.setScalarModeToUseFieldData=()=>t.setScalarMode(5),t.getAbstractScalars=(n,r,i,a,o)=>{if(!n||!e.scalarVisibility)return{scalars:null,cellFlag:!1};let s=null,l=!1;if(r===X0.DEFAULT)s=n.getPointData().getScalars(),s||(s=n.getCellData().getScalars(),l=!0);else if(r===X0.USE_POINT_DATA)s=n.getPointData().getScalars();else if(r===X0.USE_CELL_DATA)s=n.getCellData().getScalars(),l=!0;else if(r===X0.USE_POINT_FIELD_DATA){const c=n.getPointData();i===YT.BY_ID?s=c.getArrayByIndex(a):s=c.getArrayByName(o)}else if(r===X0.USE_CELL_FIELD_DATA){const c=n.getCellData();l=!0,i===YT.BY_ID?s=c.getArrayByIndex(a):s=c.getArrayByName(o)}else if(r===X0.USE_FIELD_DATA){const c=n.getFieldData();i===YT.BY_ID?s=c.getArrayByIndex(a):s=c.getArrayByName(o)}return{scalars:s,cellFlag:l}},t.mapScalars=(n,r)=>{const{scalars:i,cellFlag:a}=t.getAbstractScalars(n,e.scalarMode,e.arrayAccessMode,e.arrayId,e.colorByArrayName);if(e.areScalarsMappedFromCells=a,!i){e.colorCoordinates=null,e.colorTextureMap=null,e.colorMapColors=null;return}const o=`${t.getMTime()}${i.getMTime()}${r}`;if(e.colorBuildString!==o){if(e.useLookupTableScalarRange||t.getLookupTable().setRange(e.scalarRange[0],e.scalarRange[1]),t.canUseTextureMapForColoring(i,a))e.mapScalarsToTexture(i,a,r);else{e.colorCoordinates=null,e.colorTextureMap=null;const s=t.getLookupTable();s&&(s.build(),e.colorMapColors=s.mapScalars(i,e.colorMode,e.fieldDataTupleId))}e.colorBuildString=`${t.getMTime()}${i.getMTime()}${r}`}},e.mapScalarsToTexture=(n,r,i)=>{const a=e.lookupTable.getRange(),o=e.lookupTable.usingLogScale();o&&C3.getLogRange(a,a);const s=e.lookupTable.getAlpha();if(e.colorMapColors=null,e.colorTextureMap==null||t.getMTime()>e.colorTextureMap.getMTime()||e.lookupTable.getMTime()>e.colorTextureMap.getMTime()||e.lookupTable.getAlpha()!==i){e.lookupTable.setAlpha(i),e.colorTextureMap=null,e.lookupTable.build();const c=e.lookupTable.getNumberOfAvailableColors(),f=2048,u=f**3-3,h=4096-2,p=2,g=r?u:h;e.numberOfColorsInRange=Math.min(Math.max(c,p),g);const m=e.numberOfColorsInRange+3,y=e.numberOfColorsInRange+2,v=r?[Math.min(Math.ceil(m/f**0),f),Math.min(Math.ceil(m/f**1),f),Math.min(Math.ceil(m/f**2),f)]:[y,2,1],x=v[0]*v[1]*v[2],w=new Float64Array(x);w.fill(NaN);const S=e.numberOfColorsInRange,T=S+2,_=[0,0,0],D=a[0],I=a[1]-a[0];for(let A=0;A<T;++A){const L=MTe(_,v),P=D+I*(A-1)/(S-1);w[L]=o?10**P:P,OTe(_,v)}const R=nn.newInstance({numberOfComponents:1,values:w}),M=e.lookupTable.mapScalars(R,e.colorMode,0);e.colorTextureMap=Zw.newInstance(),e.colorTextureMap.setDimensions(v),e.colorTextureMap.getPointData().setScalars(M),e.lookupTable.setAlpha(s)}const l=e.lookupTable.getVectorMode()===_Te.MAGNITUDE&&n.getNumberOfComponents()>1?-1:e.lookupTable.getVectorComponent();e.colorCoordinates=ITe(n,l,a,e.numberOfColorsInRange,e.colorTextureMap.getDimensions(),o,r)},t.getIsOpaque=()=>{const n=t.getInputData(),i=t.getAbstractScalars(n,e.scalarMode,e.arrayAccessMode,e.arrayId,e.colorByArrayName).scalars;if(!e.scalarVisibility||i==null)return!0;const a=t.getLookupTable();return a?(a.build(),a.areScalarsOpaque(i,e.colorMode,-1)):!0},t.canUseTextureMapForColoring=(n,r)=>r&&e.colorMode!==ix.DIRECT_SCALARS?!0:!(!e.interpolateScalarsBeforeMapping||e.lookupTable&&e.lookupTable.getIndexedLookup()||!n||e.colorMode===ix.DEFAULT&&n.getDataType()===DTe.UNSIGNED_CHAR||e.colorMode===ix.DIRECT_SCALARS),t.clearColorArrays=()=>{e.colorMapColors=null,e.colorCoordinates=null,e.colorTextureMap=null},t.getLookupTable=()=>(e.lookupTable||t.createDefaultLookupTable(),e.lookupTable),t.getMTime=()=>{let n=e.mtime;if(e.lookupTable!==null){const r=e.lookupTable.getMTime();n=r>n?r:n}return n},t.getPrimitiveCount=()=>{const n=t.getInputData();return{points:n.getPoints().getNumberOfValues()/3,verts:n.getVerts().getNumberOfValues()-n.getVerts().getNumberOfCells(),lines:n.getLines().getNumberOfValues()-2*n.getLines().getNumberOfCells(),triangles:n.getPolys().getNumberOfValues()-3*n.getPolys().getNumberOfCells()}},t.acquireInvertibleLookupTable=q1("AcquireInvertibleLookupTable"),t.valueToColor=q1("ValueToColor"),t.colorToValue=q1("ColorToValue"),t.useInvertibleColorFor=q1("UseInvertibleColorFor"),t.clearInvertibleColor=q1("ClearInvertibleColor"),t.processSelectorPixelBuffers=(n,r)=>{if(!n||!e.selectionWebGLIdsToVTKIds||!e.populateSelectionSettings)return;const i=n.getRawPixelBuffer(Ho.ID_LOW24),a=n.getRawPixelBuffer(Ho.ID_HIGH24),o=n.getCurrentPass(),s=n.getFieldAssociation();let l=null;s===YL.FIELD_ASSOCIATION_POINTS?l=e.selectionWebGLIdsToVTKIds.points:s===YL.FIELD_ASSOCIATION_CELLS&&(l=e.selectionWebGLIdsToVTKIds.cells),l&&r.forEach(c=>{if(o===Ho.ID_LOW24){let f=0;a&&(f+=a[c],f*=256),f+=i[c+2],f*=256,f+=i[c+1],f*=256,f+=i[c];const u=l[f],d=n.getPixelBuffer(Ho.ID_LOW24);d[c]=u&255,d[c+1]=(u&65280)>>8,d[c+2]=(u&16711680)>>16}else if(o===Ho.ID_HIGH24&&a){let f=0;f+=a[c],f*=256,f+=i[c+2],f*=256,f+=i[c+1],f*=256,f+=i[c];const u=l[f],d=n.getPixelBuffer(Ho.ID_HIGH24);d[c]=(u&4278190080)>>24}})}}const ATe={colorMapColors:null,areScalarsMappedFromCells:!1,static:!1,lookupTable:null,scalarVisibility:!0,scalarRange:[0,1],useLookupTableScalarRange:!1,colorMode:0,scalarMode:0,arrayAccessMode:1,renderTime:0,colorByArrayName:null,fieldDataTupleId:-1,populateSelectionSettings:!0,selectionWebGLIdsToVTKIds:null,interpolateScalarsBeforeMapping:!1,colorCoordinates:null,colorTextureMap:null,numberOfColorsInRange:0,forceCompileOnly:0,useInvertibleColors:!1,invertibleScalars:null,customShaderAttributes:[]};function QX(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,ATe,n),SD.extend(t,e,n),le.get(t,e,["areScalarsMappedFromCells","colorCoordinates","colorMapColors","colorTextureMap","numberOfColorsInRange","selectionWebGLIdsToVTKIds"]),le.setGet(t,e,["colorByArrayName","arrayAccessMode","colorMode","fieldDataTupleId","interpolateScalarsBeforeMapping","lookupTable","populateSelectionSettings","renderTime","scalarMode","scalarVisibility","static","useLookupTableScalarRange","customShaderAttributes"]),le.setGetArray(t,e,["scalarRange"],2),Xw.implementCoincidentTopologyMethods(t,e),RTe(t,e)}const PTe=le.newInstance(QX,"vtkMapper");var gc={newInstance:PTe,extend:QX,...TTe,...ETe,...$w};const{FieldAssociations:JT}=Lm,{primTypes:Ma}=Tu,{Representation:Zp,Shading:QL}=up,{ScalarMode:ax}=gc,{Filter:ek,Wrap:tk}=ti,{vtkErrorMacro:Y0}=po,NTe={type:"StartEvent"},LTe={type:"EndEvent"},{CoordinateSystem:kTe}=ay;function VTe(t){const e=t.getSelector();return e?e.getCurrentPass():Ho.MIN_KNOWN_PASS-1}function FTe(t,e){e.classHierarchy.push("vtkOpenGLPolyDataMapper"),t.buildPass=r=>{r&&(e.currentRenderPass=null,e.openGLActor=t.getFirstAncestorOfType("vtkOpenGLActor"),e._openGLRenderer=e.openGLActor.getFirstAncestorOfType("vtkOpenGLRenderer"),e._openGLRenderWindow=e._openGLRenderer.getLastAncestorOfType("vtkOpenGLRenderWindow"),e.openGLCamera=e._openGLRenderer.getViewNodeFor(e._openGLRenderer.getRenderable().getActiveCamera()))},t.translucentPass=(r,i)=>{r&&(e.currentRenderPass=i,t.render())},t.zBufferPass=r=>{r&&(e.haveSeenDepthRequest=!0,e.renderDepth=!0,t.render(),e.renderDepth=!1)},t.opaqueZBufferPass=r=>t.zBufferPass(r),t.opaquePass=r=>{r&&t.render()},t.render=()=>{const r=e._openGLRenderWindow.getContext();if(e.context!==r){e.context=r;for(let o=Ma.Start;o<Ma.End;o++)e.primitives[o].setOpenGLRenderWindow(e._openGLRenderWindow)}const i=e.openGLActor.getRenderable(),a=e._openGLRenderer.getRenderable();t.renderPiece(a,i)},t.getShaderTemplate=(r,i,a)=>{r.Vertex=yD,r.Fragment=oy,r.Geometry=""},t.replaceShaderColor=(r,i,a)=>{let o=r.Vertex,s=r.Geometry,l=r.Fragment;const c=e.lastBoundBO.getReferenceByName("lastLightComplexity");let f=["uniform float ambient;","uniform float diffuse;","uniform float specular;","uniform float opacityUniform; // the fragment opacity","uniform vec3 ambientColorUniform;","uniform vec3 diffuseColorUniform;"];c&&(f=f.concat(["uniform vec3 specularColorUniform;","uniform float specularPowerUniform;"]));let u=["vec3 ambientColor;","  vec3 diffuseColor;","  float opacity;"];c&&(u=u.concat(["  vec3 specularColor;","  float specularPower;"])),u=u.concat(["  ambientColor = ambientColorUniform;","  diffuseColor = diffuseColorUniform;","  opacity = opacityUniform;"]),c&&(u=u.concat(["  specularColor = specularColorUniform;","  specularPower = specularPowerUniform;"])),e.lastBoundBO.getCABO().getColorComponents()!==0&&!e.drawingEdges&&(f=f.concat(["varying vec4 vertexColorVSOutput;"]),o=Be.substitute(o,"//VTK::Color::Dec",["attribute vec4 scalarColor;","varying vec4 vertexColorVSOutput;"]).result,o=Be.substitute(o,"//VTK::Color::Impl",["vertexColorVSOutput =  scalarColor;"]).result,s=Be.substitute(s,"//VTK::Color::Dec",["in vec4 vertexColorVSOutput[];","out vec4 vertexColorGSOutput;"]).result,s=Be.substitute(s,"//VTK::Color::Impl",["vertexColorGSOutput = vertexColorVSOutput[i];"]).result),e.lastBoundBO.getCABO().getColorComponents()!==0&&!e.drawingEdges?l=Be.substitute(l,"//VTK::Color::Impl",u.concat(["  diffuseColor = vertexColorVSOutput.rgb;","  ambientColor = vertexColorVSOutput.rgb;","  opacity = opacity*vertexColorVSOutput.a;"])).result:(e.renderable.getAreScalarsMappedFromCells()||e.renderable.getInterpolateScalarsBeforeMapping())&&e.renderable.getColorCoordinates()&&!e.drawingEdges?l=Be.substitute(l,"//VTK::Color::Impl",u.concat(["  vec4 texColor = texture2D(texture1, tcoordVCVSOutput.st);","  diffuseColor = texColor.rgb;","  ambientColor = texColor.rgb;","  opacity = opacity*texColor.a;"])).result:(a.getBackfaceProperty()&&!e.drawingEdges&&(f=f.concat(["uniform float opacityUniformBF; // the fragment opacity","uniform float ambientIntensityBF; // the material ambient","uniform float diffuseIntensityBF; // the material diffuse","uniform vec3 ambientColorUniformBF; // ambient material color","uniform vec3 diffuseColorUniformBF; // diffuse material color"]),c?(f=f.concat(["uniform float specularIntensityBF; // the material specular intensity","uniform vec3 specularColorUniformBF; // intensity weighted color","uniform float specularPowerUniformBF;"]),u=u.concat(["if (gl_FrontFacing == false) {","  ambientColor = ambientIntensityBF * ambientColorUniformBF;","  diffuseColor = diffuseIntensityBF * diffuseColorUniformBF;","  specularColor = specularIntensityBF * specularColorUniformBF;","  specularPower = specularPowerUniformBF;","  opacity = opacityUniformBF; }"])):u=u.concat(["if (gl_FrontFacing == false) {","  ambientColor = ambientIntensityBF * ambientColorUniformBF;","  diffuseColor = diffuseIntensityBF * diffuseColorUniformBF;","  opacity = opacityUniformBF; }"])),e.haveCellScalars&&!e.drawingEdges&&(f=f.concat(["uniform samplerBuffer texture1;"])),l=Be.substitute(l,"//VTK::Color::Impl",u).result),l=Be.substitute(l,"//VTK::Color::Dec",f).result,r.Vertex=o,r.Geometry=s,r.Fragment=l},t.replaceShaderLight=(r,i,a)=>{let o=r.Fragment;const s="",l=e.lastBoundBO.getReferenceByName("lastLightComplexity"),c=e.lastBoundBO.getReferenceByName("lastLightCount");let f=[];switch(l){case 0:o=Be.substitute(o,"//VTK::Light::Impl",["  gl_FragData[0] = vec4(ambientColor * ambient + diffuseColor * diffuse, opacity);","  //VTK::Light::Impl"],!1).result;break;case 1:o=Be.substitute(o,"//VTK::Light::Impl",["  float df = max(0.0, normalVCVSOutput.z);","  float sf = pow(df, specularPower);","  vec3 diffuseL = df * diffuseColor;","  vec3 specularL = sf * specularColor;","  gl_FragData[0] = vec4(ambientColor * ambient + diffuseL * diffuse + specularL * specular, opacity);","  //VTK::Light::Impl"],!1).result;break;case 2:for(let u=0;u<c;++u)f=f.concat([`uniform vec3 lightColor${u};`,`uniform vec3 lightDirectionVC${u}; // normalized`,`uniform vec3 lightHalfAngleVC${u}; // normalized`]);o=Be.substitute(o,"//VTK::Light::Dec",f).result,f=["vec3 diffuseL = vec3(0,0,0);","  vec3 specularL = vec3(0,0,0);","  float df;"];for(let u=0;u<c;++u)f=f.concat([`  df = max(0.0, dot(normalVCVSOutput, -lightDirectionVC${u}));`,`  diffuseL += ((df${s}) * lightColor${u});`,`  if (dot(normalVCVSOutput, lightDirectionVC${u}) < 0.0)`,"    {",`    float sf = sign(df)*pow(max(1e-5,
                                              dot(reflect(lightDirectionVC${u},normalVCVSOutput),
                                                  normalize(-vertexVC.xyz))),
                                         specularPower);`,`    specularL += (sf${s} * lightColor${u});`,"    }"]);f=f.concat(["  diffuseL = diffuseL * diffuseColor;","  specularL = specularL * specularColor;","  gl_FragData[0] = vec4(ambientColor * ambient + diffuseL * diffuse + specularL * specular, opacity);","  //VTK::Light::Impl"]),o=Be.substitute(o,"//VTK::Light::Impl",f,!1).result;break;case 3:for(let u=0;u<c;++u)f=f.concat([`uniform vec3 lightColor${u};`,`uniform vec3 lightDirectionVC${u}; // normalized`,`uniform vec3 lightHalfAngleVC${u}; // normalized`,`uniform vec3 lightPositionVC${u};`,`uniform vec3 lightAttenuation${u};`,`uniform float lightConeAngle${u};`,`uniform float lightExponent${u};`,`uniform int lightPositional${u};`]);o=Be.substitute(o,"//VTK::Light::Dec",f).result,f=["vec3 diffuseL = vec3(0,0,0);","  vec3 specularL = vec3(0,0,0);","  vec3 vertLightDirectionVC;","  float attenuation;","  float df;"];for(let u=0;u<c;++u)f=f.concat(["  attenuation = 1.0;",`  if (lightPositional${u} == 0)`,"    {",`      vertLightDirectionVC = lightDirectionVC${u};`,"    }","  else","    {",`    vertLightDirectionVC = vertexVC.xyz - lightPositionVC${u};`,"    float distanceVC = length(vertLightDirectionVC);","    vertLightDirectionVC = normalize(vertLightDirectionVC);","    attenuation = 1.0 /",`      (lightAttenuation${u}.x`,`       + lightAttenuation${u}.y * distanceVC`,`       + lightAttenuation${u}.z * distanceVC * distanceVC);`,"    // per OpenGL standard cone angle is 90 or less for a spot light",`    if (lightConeAngle${u} <= 90.0)`,"      {",`      float coneDot = dot(vertLightDirectionVC, lightDirectionVC${u});`,"      // if inside the cone",`      if (coneDot >= cos(radians(lightConeAngle${u})))`,"        {",`        attenuation = attenuation * pow(coneDot, lightExponent${u});`,"        }","      else","        {","        attenuation = 0.0;","        }","      }","    }","    df = max(0.0, attenuation*dot(normalVCVSOutput, -vertLightDirectionVC));",`    diffuseL += ((df${s}) * lightColor${u});`,"    if (dot(normalVCVSOutput, vertLightDirectionVC) < 0.0)","      {",`      float sf = sign(df)*attenuation*pow(max(1e-5,
                                                           dot(reflect(lightDirectionVC${u},
                                                                       normalVCVSOutput),
                                                               normalize(-vertexVC.xyz))),
                                                       specularPower);`,`    specularL += ((sf${s}) * lightColor${u});`,"    }"]);f=f.concat(["  diffuseL = diffuseL * diffuseColor;","  specularL = specularL * specularColor;","  gl_FragData[0] = vec4(ambientColor * ambient + diffuseL * diffuse + specularL * specular, opacity);","  //VTK::Light::Impl"]),o=Be.substitute(o,"//VTK::Light::Impl",f,!1).result;break;default:Y0("bad light complexity")}r.Fragment=o},t.replaceShaderNormal=(r,i,a)=>{if(e.lastBoundBO.getReferenceByName("lastLightComplexity")>0){let s=r.Vertex,l=r.Geometry,c=r.Fragment;e.lastBoundBO.getCABO().getNormalOffset()?(s=Be.substitute(s,"//VTK::Normal::Dec",["attribute vec3 normalMC;","uniform mat3 normalMatrix;","varying vec3 normalVCVSOutput;"]).result,s=Be.substitute(s,"//VTK::Normal::Impl",["normalVCVSOutput = normalMatrix * normalMC;"]).result,l=Be.substitute(l,"//VTK::Normal::Dec",["in vec3 normalVCVSOutput[];","out vec3 normalVCGSOutput;"]).result,l=Be.substitute(l,"//VTK::Normal::Impl",["normalVCGSOutput = normalVCVSOutput[i];"]).result,c=Be.substitute(c,"//VTK::Normal::Dec",["varying vec3 normalVCVSOutput;"]).result,c=Be.substitute(c,"//VTK::Normal::Impl",["vec3 normalVCVSOutput = normalize(normalVCVSOutput);","  if (gl_FrontFacing == false) { normalVCVSOutput = -normalVCVSOutput; }"]).result):e.haveCellNormals?(c=Be.substitute(c,"//VTK::Normal::Dec",["uniform mat3 normalMatrix;","uniform samplerBuffer textureN;"]).result,c=Be.substitute(c,"//VTK::Normal::Impl",["vec3 normalVCVSOutput = normalize(normalMatrix *","    texelFetchBuffer(textureN, gl_PrimitiveID + PrimitiveIDOffset).xyz);","  if (gl_FrontFacing == false) { normalVCVSOutput = -normalVCVSOutput; }"]).result):e.lastBoundBO.getOpenGLMode(a.getProperty().getRepresentation())===e.context.LINES?(c=Be.substitute(c,"//VTK::UniformFlow::Impl",["  vec3 fdx = dFdx(vertexVC.xyz);","  vec3 fdy = dFdy(vertexVC.xyz);","  //VTK::UniformFlow::Impl"]).result,c=Be.substitute(c,"//VTK::Normal::Impl",["vec3 normalVCVSOutput;","  if (abs(fdx.x) > 0.0)","    { fdx = normalize(fdx); normalVCVSOutput = normalize(cross(vec3(fdx.y, -fdx.x, 0.0), fdx)); }","  else { fdy = normalize(fdy); normalVCVSOutput = normalize(cross(vec3(fdy.y, -fdy.x, 0.0), fdy));}"]).result):(c=Be.substitute(c,"//VTK::Normal::Dec",["uniform int cameraParallel;"]).result,c=Be.substitute(c,"//VTK::UniformFlow::Impl",["  vec3 fdx = dFdx(vertexVC.xyz);","  vec3 fdy = dFdy(vertexVC.xyz);","  //VTK::UniformFlow::Impl"]).result,c=Be.substitute(c,"//VTK::Normal::Impl",["  fdx = normalize(fdx);","  fdy = normalize(fdy);","  vec3 normalVCVSOutput = normalize(cross(fdx,fdy));","  if (cameraParallel == 1 && normalVCVSOutput.z < 0.0) { normalVCVSOutput = -1.0*normalVCVSOutput; }","  if (cameraParallel == 0 && dot(normalVCVSOutput,vertexVC.xyz) > 0.0) { normalVCVSOutput = -1.0*normalVCVSOutput; }"]).result),r.Vertex=s,r.Geometry=l,r.Fragment=c}},t.replaceShaderPositionVC=(r,i,a)=>{e.lastBoundBO.replaceShaderPositionVC(r,i,a);let o=r.Vertex,s=r.Geometry,l=r.Fragment;e.lastBoundBO.getReferenceByName("lastLightComplexity")>0?(o=Be.substitute(o,"//VTK::PositionVC::Dec",["varying vec4 vertexVCVSOutput;"]).result,o=Be.substitute(o,"//VTK::PositionVC::Impl",["vertexVCVSOutput = MCVCMatrix * vertexMC;","  gl_Position = MCPCMatrix * vertexMC;"]).result,o=Be.substitute(o,"//VTK::Camera::Dec",["uniform mat4 MCPCMatrix;","uniform mat4 MCVCMatrix;"]).result,s=Be.substitute(s,"//VTK::PositionVC::Dec",["in vec4 vertexVCVSOutput[];","out vec4 vertexVCGSOutput;"]).result,s=Be.substitute(s,"//VTK::PositionVC::Impl",["vertexVCGSOutput = vertexVCVSOutput[i];"]).result,l=Be.substitute(l,"//VTK::PositionVC::Dec",["varying vec4 vertexVCVSOutput;"]).result,l=Be.substitute(l,"//VTK::PositionVC::Impl",["vec4 vertexVC = vertexVCVSOutput;"]).result):(o=Be.substitute(o,"//VTK::Camera::Dec",["uniform mat4 MCPCMatrix;"]).result,o=Be.substitute(o,"//VTK::PositionVC::Impl",["  gl_Position = MCPCMatrix * vertexMC;"]).result),r.Vertex=o,r.Geometry=s,r.Fragment=l},t.replaceShaderTCoord=(r,i,a)=>{if(e.lastBoundBO.getCABO().getTCoordOffset()){let o=r.Vertex,s=r.Geometry,l=r.Fragment;if(e.drawingEdges)return;o=Be.substitute(o,"//VTK::TCoord::Impl","tcoordVCVSOutput = tcoordMC;").result;const c=e.openGLActor.getActiveTextures();let f=2,u=2;if(c&&c.length>0&&(f=c[0].getComponents(),c[0].getTarget()===e.context.TEXTURE_CUBE_MAP&&(u=3)),e.renderable.getColorTextureMap()&&(f=e.renderable.getColorTextureMap().getPointData().getScalars().getNumberOfComponents(),u=2),u===2){if(o=Be.substitute(o,"//VTK::TCoord::Dec","attribute vec2 tcoordMC; varying vec2 tcoordVCVSOutput;").result,s=Be.substitute(s,"//VTK::TCoord::Dec",["in vec2 tcoordVCVSOutput[];","out vec2 tcoordVCGSOutput;"]).result,s=Be.substitute(s,"//VTK::TCoord::Impl","tcoordVCGSOutput = tcoordVCVSOutput[i];").result,l=Be.substitute(l,"//VTK::TCoord::Dec",["varying vec2 tcoordVCVSOutput;","uniform sampler2D texture1;"]).result,c&&c.length>=1)switch(f){case 1:l=Be.substitute(l,"//VTK::TCoord::Impl",["  vec4 tcolor = texture2D(texture1, tcoordVCVSOutput);","  ambientColor = ambientColor*tcolor.r;","  diffuseColor = diffuseColor*tcolor.r;"]).result;break;case 2:l=Be.substitute(l,"//VTK::TCoord::Impl",["  vec4 tcolor = texture2D(texture1, tcoordVCVSOutput);","  ambientColor = ambientColor*tcolor.r;","  diffuseColor = diffuseColor*tcolor.r;","  opacity = opacity * tcolor.g;"]).result;break;default:l=Be.substitute(l,"//VTK::TCoord::Impl",["  vec4 tcolor = texture2D(texture1, tcoordVCVSOutput);","  ambientColor = ambientColor*tcolor.rgb;","  diffuseColor = diffuseColor*tcolor.rgb;","  opacity = opacity * tcolor.a;"]).result}}else switch(o=Be.substitute(o,"//VTK::TCoord::Dec","attribute vec3 tcoordMC; varying vec3 tcoordVCVSOutput;").result,s=Be.substitute(s,"//VTK::TCoord::Dec",["in vec3 tcoordVCVSOutput[];","out vec3 tcoordVCGSOutput;"]).result,s=Be.substitute(s,"//VTK::TCoord::Impl","tcoordVCGSOutput = tcoordVCVSOutput[i];").result,l=Be.substitute(l,"//VTK::TCoord::Dec",["varying vec3 tcoordVCVSOutput;","uniform samplerCube texture1;"]).result,f){case 1:l=Be.substitute(l,"//VTK::TCoord::Impl",["  vec4 tcolor = textureCube(texture1, tcoordVCVSOutput);","  ambientColor = ambientColor*tcolor.r;","  diffuseColor = diffuseColor*tcolor.r;"]).result;break;case 2:l=Be.substitute(l,"//VTK::TCoord::Impl",["  vec4 tcolor = textureCube(texture1, tcoordVCVSOutput);","  ambientColor = ambientColor*tcolor.r;","  diffuseColor = diffuseColor*tcolor.r;","  opacity = opacity * tcolor.g;"]).result;break;default:l=Be.substitute(l,"//VTK::TCoord::Impl",["  vec4 tcolor = textureCube(texture1, tcoordVCVSOutput);","  ambientColor = ambientColor*tcolor.rgb;","  diffuseColor = diffuseColor*tcolor.rgb;","  opacity = opacity * tcolor.a;"]).result}r.Vertex=o,r.Geometry=s,r.Fragment=l}},t.replaceShaderClip=(r,i,a)=>{let o=r.Vertex,s=r.Fragment;if(e.renderable.getNumberOfClippingPlanes()){const l=e.renderable.getNumberOfClippingPlanes();o=Be.substitute(o,"//VTK::Clip::Dec",["uniform int numClipPlanes;",`uniform vec4 clipPlanes[${l}];`,`varying float clipDistancesVSOutput[${l}];`]).result,o=Be.substitute(o,"//VTK::Clip::Impl",[`for (int planeNum = 0; planeNum < ${l}; planeNum++)`,"    {","    if (planeNum >= numClipPlanes)","        {","        break;","        }","    clipDistancesVSOutput[planeNum] = dot(clipPlanes[planeNum], vertexMC);","    }"]).result,s=Be.substitute(s,"//VTK::Clip::Dec",["uniform int numClipPlanes;",`varying float clipDistancesVSOutput[${l}];`]).result,s=Be.substitute(s,"//VTK::Clip::Impl",[`for (int planeNum = 0; planeNum < ${l}; planeNum++)`,"    {","    if (planeNum >= numClipPlanes)","        {","        break;","        }","    if (clipDistancesVSOutput[planeNum] < 0.0) discard;","    }"]).result}r.Vertex=o,r.Fragment=s},t.getCoincidentParameters=(r,i)=>{let a={factor:0,offset:0};const o=i.getProperty();if(e.renderable.getResolveCoincidentTopology()==Cc.PolygonOffset||o.getEdgeVisibility()&&o.getRepresentation()===Zp.SURFACE){const l=e.lastBoundBO.getPrimitiveType();l===Ma.Points||o.getRepresentation()===Zp.POINTS?a=e.renderable.getCoincidentTopologyPointOffsetParameter():l===Ma.Lines||o.getRepresentation()===Zp.WIREFRAME?a=e.renderable.getCoincidentTopologyLineOffsetParameters():(l===Ma.Tris||l===Ma.TriStrips)&&(a=e.renderable.getCoincidentTopologyPolygonOffsetParameters()),(l===Ma.TrisEdges||l===Ma.TriStripsEdges)&&(a=e.renderable.getCoincidentTopologyPolygonOffsetParameters(),a.factor/=2,a.offset/=2)}const s=e._openGLRenderer.getSelector();return s&&s.getFieldAssociation()===JT.FIELD_ASSOCIATION_POINTS&&(a.offset-=2),a},t.replaceShaderPicking=(r,i,a)=>{let o=r.Fragment,s=r.Vertex;if(o=Be.substitute(o,"//VTK::Picking::Dec",["uniform int picking;","//VTK::Picking::Dec"]).result,!!e._openGLRenderer.getSelector()){switch((e.lastSelectionState===Ho.ID_LOW24||e.lastSelectionState===Ho.ID_HIGH24)&&(s=Be.substitute(s,"//VTK::Picking::Dec",[`flat out int vertexIDVSOutput;
`,`uniform int VertexIDOffset;
`]).result,s=Be.substitute(s,"//VTK::Picking::Impl",`  vertexIDVSOutput = gl_VertexID + VertexIDOffset;
`).result,o=Be.substitute(o,"//VTK::Picking::Dec",`flat in int vertexIDVSOutput;
`).result,o=Be.substitute(o,"//VTK::Picking::Impl",["  int idx = vertexIDVSOutput;","//VTK::Picking::Impl"]).result),e.lastSelectionState){case Ho.ID_LOW24:o=Be.substitute(o,"//VTK::Picking::Impl","  gl_FragData[0] = vec4(float(idx%256)/255.0, float((idx/256)%256)/255.0, float((idx/65536)%256)/255.0, 1.0);").result;break;case Ho.ID_HIGH24:o=Be.substitute(o,"//VTK::Picking::Impl","  gl_FragData[0] = vec4(float((idx/16777216)%256)/255.0, 0.0, 0.0, 1.0);").result;break;default:o=Be.substitute(o,"//VTK::Picking::Dec","uniform vec3 mapperIndex;").result,o=Be.substitute(o,"//VTK::Picking::Impl","  gl_FragData[0] = picking != 0 ? vec4(mapperIndex,1.0) : gl_FragData[0];").result}r.Fragment=o,r.Vertex=s}},t.replaceShaderValues=(r,i,a)=>{if(t.replaceShaderColor(r,i,a),t.replaceShaderNormal(r,i,a),t.replaceShaderLight(r,i,a),t.replaceShaderTCoord(r,i,a),t.replaceShaderPicking(r,i,a),t.replaceShaderClip(r,i,a),t.replaceShaderCoincidentOffset(r,i,a),t.replaceShaderPositionVC(r,i,a),e.haveSeenDepthRequest){let o=r.Fragment;o=Be.substitute(o,"//VTK::ZBuffer::Dec","uniform int depthRequest;").result,o=Be.substitute(o,"//VTK::ZBuffer::Impl",["if (depthRequest == 1) {","float iz = floor(gl_FragCoord.z*65535.0 + 0.1);","float rf = floor(iz/256.0)/255.0;","float gf = mod(iz,256.0)/255.0;","gl_FragData[0] = vec4(rf, gf, 0.0, 1.0); }"]).result,r.Fragment=o}},t.getNeedToRebuildShaders=(r,i,a)=>{let o=0,s=0;const l=r.getPrimitiveType(),c=e.currentInput;let f=!1;const u=c.getPointData().getNormals(),d=c.getCellData().getNormals(),h=a.getProperty().getInterpolation()===QL.FLAT,p=a.getProperty().getRepresentation(),g=r.getOpenGLMode(p,l);if((g===e.context.TRIANGLES||d&&!u||!h&&u||!h&&g===e.context.LINES)&&(f=!0),a.getProperty().getLighting()&&f){o=0;const x=i.getLightsByReference();for(let w=0;w<x.length;++w){const S=x[w];S.getSwitch()>0&&(s++,o===0&&(o=1)),o===1&&(s>1||S.getIntensity()!==1||!S.lightTypeIsHeadLight())&&(o=2),o<3&&S.getPositional()&&(o=3)}}let m=!1;const y=e.lastBoundBO.getReferenceByName("lastLightComplexity"),v=e.lastBoundBO.getReferenceByName("lastLightCount");return(y!==o||v!==s)&&(e.lastBoundBO.set({lastLightComplexity:o},!0),e.lastBoundBO.set({lastLightCount:s},!0),m=!0),(!e.currentRenderPass&&e.lastRenderPassShaderReplacement||e.currentRenderPass&&e.currentRenderPass.getShaderReplacement()!==e.lastRenderPassShaderReplacement)&&(m=!0),e.lastHaveSeenDepthRequest!==e.haveSeenDepthRequest||r.getShaderSourceTime().getMTime()<e.renderable.getMTime()||r.getShaderSourceTime().getMTime()<e.currentInput.getMTime()||r.getShaderSourceTime().getMTime()<e.selectionStateChanged.getMTime()||m?(e.lastHaveSeenDepthRequest=e.haveSeenDepthRequest,!0):!1},t.invokeShaderCallbacks=(r,i,a)=>{const o=e.renderable.getViewSpecificProperties().ShadersCallbacks;o&&o.forEach(s=>{s.callback(s.userData,r,i,a)})},t.setMapperShaderParameters=(r,i,a)=>{if(r.getProgram().isUniformUsed("PrimitiveIDOffset")&&r.getProgram().setUniformi("PrimitiveIDOffset",e.primitiveIDOffset),r.getProgram().isUniformUsed("VertexIDOffset")&&r.getProgram().setUniformi("VertexIDOffset",e.vertexIDOffset),r.getCABO().getElementCount()&&(e.VBOBuildTime.getMTime()>r.getAttributeUpdateTime().getMTime()||r.getShaderSourceTime().getMTime()>r.getAttributeUpdateTime().getMTime())){const l=e.lastBoundBO.getReferenceByName("lastLightComplexity");r.getProgram().isAttributeUsed("vertexMC")&&(r.getVAO().addAttributeArray(r.getProgram(),r.getCABO(),"vertexMC",r.getCABO().getVertexOffset(),r.getCABO().getStride(),e.context.FLOAT,3,!1)||Y0("Error setting vertexMC in shader VAO.")),r.getProgram().isAttributeUsed("normalMC")&&r.getCABO().getNormalOffset()&&l>0?r.getVAO().addAttributeArray(r.getProgram(),r.getCABO(),"normalMC",r.getCABO().getNormalOffset(),r.getCABO().getStride(),e.context.FLOAT,3,!1)||Y0("Error setting normalMC in shader VAO."):r.getVAO().removeAttributeArray("normalMC"),e.renderable.getCustomShaderAttributes().forEach((c,f)=>{r.getProgram().isAttributeUsed(`${c}MC`)&&(r.getVAO().addAttributeArray(r.getProgram(),r.getCABO(),`${c}MC`,r.getCABO().getCustomData()[f].offset,r.getCABO().getStride(),e.context.FLOAT,r.getCABO().getCustomData()[f].components,!1)||Y0(`Error setting ${c}MC in shader VAO.`))}),r.getProgram().isAttributeUsed("tcoordMC")&&r.getCABO().getTCoordOffset()?r.getVAO().addAttributeArray(r.getProgram(),r.getCABO(),"tcoordMC",r.getCABO().getTCoordOffset(),r.getCABO().getStride(),e.context.FLOAT,r.getCABO().getTCoordComponents(),!1)||Y0("Error setting tcoordMC in shader VAO."):r.getVAO().removeAttributeArray("tcoordMC"),r.getProgram().isAttributeUsed("scalarColor")&&r.getCABO().getColorComponents()?r.getVAO().addAttributeArray(r.getProgram(),r.getCABO().getColorBO(),"scalarColor",r.getCABO().getColorOffset(),r.getCABO().getColorBOStride(),e.context.UNSIGNED_BYTE,4,!0)||Y0("Error setting scalarColor in shader VAO."):r.getVAO().removeAttributeArray("scalarColor"),r.getAttributeUpdateTime().modified()}if(e.renderable.getNumberOfClippingPlanes()){const l=e.renderable.getNumberOfClippingPlanes(),c=[],u=r.getCABO().getCoordShiftAndScaleEnabled()?r.getCABO().getInverseShiftAndScaleMatrix():null,d=u?Ei(e.tmpMat4,a.getMatrix()):a.getMatrix();u&&(Gn(d,d),jn(d,d,u),Gn(d,d));for(let h=0;h<l;h++){const p=[];e.renderable.getClippingPlaneInDataCoords(d,h,p);for(let g=0;g<4;g++)c.push(p[g])}r.getProgram().setUniformi("numClipPlanes",l),r.getProgram().setUniform4fv("clipPlanes",c)}e.internalColorTexture&&r.getProgram().isUniformUsed("texture1")&&r.getProgram().setUniformi("texture1",e.internalColorTexture.getTextureUnit());const o=e.openGLActor.getActiveTextures();if(o)for(let l=0;l<o.length;++l){const f=o[l].getTextureUnit(),u=`texture${f+1}`;r.getProgram().isUniformUsed(u)&&r.getProgram().setUniformi(u,f)}if(e.haveSeenDepthRequest&&r.getProgram().setUniformi("depthRequest",e.renderDepth?1:0),r.getProgram().isUniformUsed("coffset")){const l=t.getCoincidentParameters(i,a);r.getProgram().setUniformf("coffset",l.offset),r.getProgram().isUniformUsed("cfactor")&&r.getProgram().setUniformf("cfactor",l.factor)}r.setMapperShaderParameters(i,a,e._openGLRenderer.getTiledSizeAndOrigin());const s=e._openGLRenderer.getSelector();r.getProgram().setUniform3fArray("mapperIndex",s?s.getPropColorValue():[0,0,0]),r.getProgram().setUniformi("picking",s?s.getCurrentPass()+1:0)},t.setLightingShaderParameters=(r,i,a)=>{const o=e.lastBoundBO.getReferenceByName("lastLightComplexity");if(o<2)return;const s=r.getProgram();let l=0;const c=i.getLightsByReference();for(let d=0;d<c.length;++d){const h=c[d];if(h.getSwitch()>0){const g=h.getColorByReference(),m=h.getIntensity();e.lightColor[0]=g[0]*m,e.lightColor[1]=g[1]*m,e.lightColor[2]=g[2]*m;const y=h.getDirection(),v=i.getActiveCamera().getViewMatrix(),x=[...y];h.lightTypeIsSceneLight()&&(x[0]=v[0]*y[0]+v[1]*y[1]+v[2]*y[2],x[1]=v[4]*y[0]+v[5]*y[1]+v[6]*y[2],x[2]=v[8]*y[0]+v[9]*y[1]+v[10]*y[2],qh(x)),e.lightDirection[0]=x[0],e.lightDirection[1]=x[1],e.lightDirection[2]=x[2],qh(e.lightDirection),s.setUniform3fArray(`lightColor${l}`,e.lightColor),s.setUniform3fArray(`lightDirectionVC${l}`,e.lightDirection),l++}}if(o<3)return;const u=i.getActiveCamera().getViewMatrix();Gn(u,u),l=0;for(let d=0;d<c.length;++d){const h=c[d];if(h.getSwitch()>0){const g=h.getTransformedPosition(),m=new Float64Array(3);$n(m,g,u),s.setUniform3fArray(`lightAttenuation${l}`,h.getAttenuationValuesByReference()),s.setUniformi(`lightPositional${l}`,h.getPositional()),s.setUniformf(`lightExponent${l}`,h.getExponent()),s.setUniformf(`lightConeAngle${l}`,h.getConeAngle()),s.setUniform3fArray(`lightPositionVC${l}`,[m[0],m[1],m[2]]),l++}}};function n(r,i,a){return i.identity(a),r.reduce((o,s,l)=>l===0?s?i.copy(o,s):i.identity(o):s?i.multiply(o,o,s):o,a)}t.setCameraShaderParameters=(r,i,a)=>{const o=r.getProgram(),s=e.openGLCamera.getKeyMatrices(i),l=i.getActiveCamera(),c=e.openGLCamera.getKeyMatrixTime().getMTime(),f=o.getLastCameraMTime(),d=r.getCABO().getCoordShiftAndScaleEnabled()?r.getCABO().getInverseShiftAndScaleMatrix():null,h=a.getIsIdentity(),p=h?{mcwc:null,normalMatrix:null}:e.openGLActor.getKeyMatrices();if(a.getCoordinateSystem()===kTe.DISPLAY){const g=e._openGLRenderer.getTiledSizeAndOrigin();sn(e.tmpMat4),e.tmpMat4[0]=2/g.usize,e.tmpMat4[12]=-1,e.tmpMat4[5]=2/g.vsize,e.tmpMat4[13]=-1,jn(e.tmpMat4,e.tmpMat4,d),o.setUniformMatrix("MCPCMatrix",e.tmpMat4)}else o.setUniformMatrix("MCPCMatrix",n([s.wcpc,p.mcwc,d],x2,e.tmpMat4));o.isUniformUsed("MCVCMatrix")&&o.setUniformMatrix("MCVCMatrix",n([s.wcvc,p.mcwc,d],x2,e.tmpMat4)),o.isUniformUsed("normalMatrix")&&o.setUniformMatrix3x3("normalMatrix",n([s.normalMatrix,p.normalMatrix],jye,e.tmpMat3)),f!==c&&(o.isUniformUsed("cameraParallel")&&o.setUniformi("cameraParallel",l.getParallelProjection()),o.setLastCameraMTime(c)),h||o.setLastCameraMTime(0)},t.setPropertyShaderParameters=(r,i,a)=>{const o=r.getProgram();let s=a.getProperty(),l=s.getOpacity(),c=e.drawingEdges?s.getEdgeColorByReference():s.getAmbientColorByReference(),f=e.drawingEdges?s.getEdgeColorByReference():s.getDiffuseColorByReference(),u=e.drawingEdges?1:s.getAmbient(),d=e.drawingEdges?0:s.getDiffuse(),h=e.drawingEdges?0:s.getSpecular();const p=s.getSpecularPower();o.setUniformf("opacityUniform",l),o.setUniform3fArray("ambientColorUniform",c),o.setUniform3fArray("diffuseColorUniform",f),o.setUniformf("ambient",u),o.setUniformf("diffuse",d);const g=e.lastBoundBO.getReferenceByName("lastLightComplexity");if(g<1)return;let m=s.getSpecularColorByReference();if(o.setUniform3fArray("specularColorUniform",m),o.setUniformf("specularPowerUniform",p),o.setUniformf("specular",h),o.isUniformUsed("ambientIntensityBF")){if(s=a.getBackfaceProperty(),l=s.getOpacity(),c=s.getAmbientColor(),u=s.getAmbient(),f=s.getDiffuseColor(),d=s.getDiffuse(),m=s.getSpecularColor(),h=s.getSpecular(),o.setUniformf("ambientIntensityBF",u),o.setUniformf("diffuseIntensityBF",d),o.setUniformf("opacityUniformBF",l),o.setUniform3fArray("ambientColorUniformBF",c),o.setUniform3fArray("diffuseColorUniformBF",f),g<1)return;o.setUniformf("specularIntensityBF",h),o.setUniform3fArray("specularColorUniformBF",m),o.setUniformf("specularPowerUniformBF",p)}},t.updateMaximumPointCellIds=(r,i)=>{const a=e._openGLRenderer.getSelector();if(!a)return;if(e.selectionWebGLIdsToVTKIds?.points?.length){const s=e.selectionWebGLIdsToVTKIds.points.length;a.setMaximumPointId(s-1)}if(e.selectionWebGLIdsToVTKIds?.cells?.length){const s=e.selectionWebGLIdsToVTKIds.cells.length;a.setMaximumCellId(s-1)}a.getFieldAssociation()===JT.FIELD_ASSOCIATION_POINTS&&(e.pointPicking=!0)},t.renderPieceStart=(r,i)=>{e.primitiveIDOffset=0,e.vertexIDOffset=0;const a=VTe(e._openGLRenderer);e.lastSelectionState!==a&&(e.selectionStateChanged.modified(),e.lastSelectionState=a),e._openGLRenderer.getSelector()&&e._openGLRenderer.getSelector().renderProp(i),t.updateBufferObjects(r,i),e.renderable.getColorTextureMap()&&e.internalColorTexture.activate(),e.lastBoundBO=null},t.renderPieceDraw=(r,i)=>{const a=i.getProperty().getRepresentation(),o=i.getProperty().getEdgeVisibility()&&a===Zp.SURFACE,s=e._openGLRenderer.getSelector(),l=s&&s.getFieldAssociation()===JT.FIELD_ASSOCIATION_POINTS&&(e.lastSelectionState===Ho.ID_LOW24||e.lastSelectionState===Ho.ID_HIGH24);for(let c=Ma.Start;c<Ma.End;c++)e.primitives[c].setPointPicking(l),e.primitives[c].getCABO().getElementCount()&&(e.drawingEdges=o&&(c===Ma.TrisEdges||c===Ma.TriStripsEdges),(!e.drawingEdges||!(e.renderDepth||e.lastSelectionState>=0))&&(e.lastBoundBO=e.primitives[c],e.primitiveIDOffset+=e.primitives[c].drawArrays(r,i,a,t),e.vertexIDOffset+=e.primitives[c].getCABO().getElementCount()))},t.renderPieceFinish=(r,i)=>{e.LastBoundBO&&e.LastBoundBO.getVAO().release(),e.renderable.getColorTextureMap()&&e.internalColorTexture.deactivate()},t.renderPiece=(r,i)=>{if(t.invokeEvent(NTe),e.renderable.getStatic()||e.renderable.update(),e.currentInput=e.renderable.getInputData(),t.invokeEvent(LTe),!e.currentInput){Y0("No input!");return}if(!e.currentInput.getPoints||!e.currentInput.getPoints().getNumberOfValues())return;const a=e.context,o=i.getProperty().getBackfaceCulling(),s=i.getProperty().getFrontfaceCulling();!o&&!s?e._openGLRenderWindow.disableCullFace():s?(e._openGLRenderWindow.enableCullFace(),a.cullFace(a.FRONT)):(e._openGLRenderWindow.enableCullFace(),a.cullFace(a.BACK)),t.renderPieceStart(r,i),t.renderPieceDraw(r,i),t.renderPieceFinish(r,i)},t.computeBounds=(r,i)=>{if(!t.getInput()){Nm(e.bounds);return}e.bounds=t.getInput().getBounds()},t.updateBufferObjects=(r,i)=>{t.getNeedToRebuildBufferObjects(r,i)&&t.buildBufferObjects(r,i),t.updateMaximumPointCellIds()},t.getNeedToRebuildBufferObjects=(r,i)=>{const a=e.VBOBuildTime.getMTime();return a<t.getMTime()||a<e.renderable.getMTime()||a<i.getMTime()||a<e.currentInput.getMTime()},t.buildBufferObjects=(r,i)=>{const a=e.currentInput;if(a===null)return;e.renderable.mapScalars(a,1);const o=e.renderable.getColorMapColors();e.haveCellScalars=!1;const s=e.renderable.getScalarMode();e.renderable.getScalarVisibility()&&(s===ax.USE_CELL_DATA||s===ax.USE_CELL_FIELD_DATA||s===ax.USE_FIELD_DATA||!a.getPointData().getScalars())&&s!==ax.USE_POINT_FIELD_DATA&&o&&(e.haveCellScalars=!0);let l=i.getProperty().getInterpolation()!==QL.FLAT?a.getPointData().getNormals():null;l===null&&a.getCellData().getNormals()&&(e.haveCellNormals=!0,l=a.getCellData().getNormals());const c=i.getProperty().getRepresentation();let f=a.getPointData().getTCoords();e.openGLActor.getActiveTextures()||(f=null);let u=!1;if(e.renderable.getColorCoordinates()){f=e.renderable.getColorCoordinates(),u=e.renderable.getAreScalarsMappedFromCells(),e.internalColorTexture||(e.internalColorTexture=ti.newInstance({resizable:!0}));const h=e.internalColorTexture;h.setMinificationFilter(ek.NEAREST),h.setMagnificationFilter(ek.NEAREST),h.setWrapS(tk.CLAMP_TO_EDGE),h.setWrapT(tk.CLAMP_TO_EDGE),h.setOpenGLRenderWindow(e._openGLRenderWindow);const p=e.renderable.getColorTextureMap(),g=p.getExtent(),m=p.getPointData().getScalars();h.create2DFromRaw(g[1]-g[0]+1,g[3]-g[2]+1,m.getNumberOfComponents(),m.getDataType(),m.getData()),h.activate(),h.sendParameters(),h.deactivate()}const d=`${a.getMTime()}A${c}B${a.getMTime()}C${l?l.getMTime():1}D${o?o.getMTime():1}E${i.getProperty().getEdgeVisibility()}F${f?f.getMTime():1}`;if(e.VBOBuildString!==d){const p={points:a.getPoints(),normals:l,tcoords:f,colors:o,cellOffset:0,vertexOffset:0,useTCoordsPerCell:u,haveCellScalars:e.haveCellScalars,haveCellNormals:e.haveCellNormals,customAttributes:e.renderable.getCustomShaderAttributes().map(y=>a.getPointData().getArrayByName(y))};e.renderable.getPopulateSelectionSettings()&&(e.selectionWebGLIdsToVTKIds={points:null,cells:null});const g=[{inRep:"verts",cells:a.getVerts()},{inRep:"lines",cells:a.getLines()},{inRep:"polys",cells:a.getPolys()},{inRep:"strips",cells:a.getStrips()},{inRep:"polys",cells:a.getPolys()},{inRep:"strips",cells:a.getStrips()}],m=i.getProperty().getEdgeVisibility()&&c===Zp.SURFACE;for(let y=Ma.Start;y<Ma.End;y++)y!==Ma.TrisEdges&&y!==Ma.TriStripsEdges?(p.cellOffset+=e.primitives[y].getCABO().createVBO(g[y].cells,g[y].inRep,c,p,e.selectionWebGLIdsToVTKIds),p.vertexOffset+=e.primitives[y].getCABO().getElementCount()):m?e.primitives[y].getCABO().createVBO(g[y].cells,g[y].inRep,Zp.WIREFRAME,{...p,tcoords:null,colors:null,haveCellScalars:!1,haveCellNormals:!1}):e.primitives[y].releaseGraphicsResources();e.renderable.getPopulateSelectionSettings()&&e.renderable.setSelectionWebGLIdsToVTKIds(e.selectionWebGLIdsToVTKIds),e.VBOBuildString=d}e.VBOBuildTime.modified()},t.getAllocatedGPUMemoryInBytes=()=>{let r=0;return e.primitives.forEach(i=>{r+=i.getAllocatedGPUMemoryInBytes()}),r}}const UTe={context:null,VBOBuildTime:0,VBOBuildString:null,primitives:null,primTypes:null,shaderRebuildString:null,tmpMat4:null,ambientColor:[],diffuseColor:[],specularColor:[],lightColor:[],lightDirection:[],lastHaveSeenDepthRequest:!1,haveSeenDepthRequest:!1,lastSelectionState:Ho.MIN_KNOWN_PASS-1,selectionStateChanged:null,selectionWebGLIdsToVTKIds:null,pointPicking:!1};function eY(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,UTe,n),Rr.extend(t,e,n),mu.implementReplaceShaderCoincidentOffset(t,e,n),mu.implementBuildShadersWithReplacements(t,e,n),e.primitives=[],e.primTypes=Ma,e.tmpMat3=Ll(new Float64Array(9)),e.tmpMat4=sn(new Float64Array(16));for(let r=Ma.Start;r<Ma.End;r++)e.primitives[r]=Tu.newInstance(),e.primitives[r].setPrimitiveType(r),e.primitives[r].set({lastLightComplexity:0,lastLightCount:0,lastSelectionPass:!1},!0);Mi(t,e,["context"]),e.VBOBuildTime={},$r(e.VBOBuildTime,{mtime:0}),e.selectionStateChanged={},$r(e.selectionStateChanged,{mtime:0}),FTe(t,e)}const tY=Zn(eY,"vtkOpenGLPolyDataMapper");var eC={newInstance:tY,extend:eY};sa("vtkMapper",tY);const{vtkErrorMacro:X1}=po,{Representation:BTe}=up,{ObjectType:ox}=Cf,{PassTypes:$Te}=wD,GTe={type:"StartEvent"},jTe={type:"EndEvent"};function zTe(t,e){e.classHierarchy.push("vtkOpenGLGlyph3DMapper");const n={...t};t.renderPiece=(r,i)=>{if(t.invokeEvent(GTe),e.renderable.getStatic()||e.renderable.update(),e.currentInput=e.renderable.getInputData(1),t.invokeEvent(jTe),!e.currentInput){X1("No input!");return}if(!e.currentInput.getPoints||!e.currentInput.getPoints().getNumberOfValues())return;const a=e.context;e._openGLRenderWindow.getWebgl2()?(e.hardwareSupport=!0,e.extension=null):e.extension||(e.extension=e.context.getExtension("ANGLE_instanced_arrays"),e.hardwareSupport=!!e.extension);const o=i.getProperty().getBackfaceCulling(),s=i.getProperty().getFrontfaceCulling();!o&&!s?e._openGLRenderWindow.disableCullFace():s?(e._openGLRenderWindow.enableCullFace(),a.cullFace(a.FRONT)):(e._openGLRenderWindow.enableCullFace(),a.cullFace(a.BACK)),t.renderPieceStart(r,i),t.renderPieceDraw(r,i),t.renderPieceFinish(r,i)},t.multiply4x4WithOffset=(r,i,a,o)=>{const s=i[0],l=i[1],c=i[2],f=i[3],u=i[4],d=i[5],h=i[6],p=i[7],g=i[8],m=i[9],y=i[10],v=i[11],x=i[12],w=i[13],S=i[14],T=i[15];let _=a[o],D=a[o+1],I=a[o+2],R=a[o+3];r[0]=_*s+D*u+I*g+R*x,r[1]=_*l+D*d+I*m+R*w,r[2]=_*c+D*h+I*y+R*S,r[3]=_*f+D*p+I*v+R*T,_=a[o+4],D=a[o+5],I=a[o+6],R=a[o+7],r[4]=_*s+D*u+I*g+R*x,r[5]=_*l+D*d+I*m+R*w,r[6]=_*c+D*h+I*y+R*S,r[7]=_*f+D*p+I*v+R*T,_=a[o+8],D=a[o+9],I=a[o+10],R=a[o+11],r[8]=_*s+D*u+I*g+R*x,r[9]=_*l+D*d+I*m+R*w,r[10]=_*c+D*h+I*y+R*S,r[11]=_*f+D*p+I*v+R*T,_=a[o+12],D=a[o+13],I=a[o+14],R=a[o+15],r[12]=_*s+D*u+I*g+R*x,r[13]=_*l+D*d+I*m+R*w,r[14]=_*c+D*h+I*y+R*S,r[15]=_*f+D*p+I*v+R*T},t.replaceShaderNormal=(r,i,a)=>{if(e.hardwareSupport&&e.lastBoundBO.getReferenceByName("lastLightComplexity")>0){let s=r.Vertex;e.lastBoundBO.getCABO().getNormalOffset()&&(s=Be.substitute(s,"//VTK::Normal::Dec",["attribute vec3 normalMC;","attribute mat3 gNormal;","uniform mat3 normalMatrix;","varying vec3 normalVCVSOutput;"]).result,s=Be.substitute(s,"//VTK::Normal::Impl",["normalVCVSOutput = normalMatrix * gNormal * normalMC;"]).result),r.Vertex=s}n.replaceShaderNormal(r,i,a)},t.replaceShaderColor=(r,i,a)=>{if(e.hardwareSupport&&e.renderable.getColorArray()){let o=r.Vertex,s=r.Geometry,l=r.Fragment;const c=e.lastBoundBO.getReferenceByName("lastLightComplexity");let f=["uniform float ambient;","uniform float diffuse;","uniform float specular;","uniform float opacityUniform; // the fragment opacity"];c&&(f=f.concat(["uniform vec3 specularColorUniform;","uniform float specularPowerUniform;"]));let u=["vec3 ambientColor;","  vec3 diffuseColor;","  float opacity;"];c&&(u=u.concat(["  vec3 specularColor;","  float specularPower;"])),u=u.concat(["  opacity = opacityUniform;"]),c&&(u=u.concat(["  specularColor = specularColorUniform;","  specularPower = specularPowerUniform;"])),e.drawingEdges||(f=f.concat(["varying vec4 vertexColorVSOutput;"]),o=Be.substitute(o,"//VTK::Color::Dec",["attribute vec4 gColor;","varying vec4 vertexColorVSOutput;"]).result,o=Be.substitute(o,"//VTK::Color::Impl",["vertexColorVSOutput = gColor;"]).result,s=Be.substitute(s,"//VTK::Color::Dec",["in vec4 vertexColorVSOutput[];","out vec4 vertexColorGSOutput;"]).result,s=Be.substitute(s,"//VTK::Color::Impl",["vertexColorGSOutput = vertexColorVSOutput[i];"]).result,u=u.concat(["  diffuseColor = vertexColorVSOutput.rgb;","  ambientColor = vertexColorVSOutput.rgb;","  opacity = opacity*vertexColorVSOutput.a;"])),l=Be.substitute(l,"//VTK::Color::Impl",u).result,l=Be.substitute(l,"//VTK::Color::Dec",f).result,r.Vertex=o,r.Geometry=s,r.Fragment=l}n.replaceShaderColor(r,i,a)},t.replaceShaderPositionVC=(r,i,a)=>{if(e.hardwareSupport){let o=r.Vertex;e.lastBoundBO.getReferenceByName("lastLightComplexity")>0?(o=Be.substitute(o,"//VTK::PositionVC::Impl",["vec4 gVertexMC = gMatrix * vertexMC;","vertexVCVSOutput = MCVCMatrix * gVertexMC;","  gl_Position = MCPCMatrix * gVertexMC;"]).result,o=Be.substitute(o,"//VTK::Camera::Dec",["attribute mat4 gMatrix;","uniform mat4 MCPCMatrix;","uniform mat4 MCVCMatrix;"]).result):(o=Be.substitute(o,"//VTK::Camera::Dec",["attribute mat4 gMatrix;","uniform mat4 MCPCMatrix;"]).result,o=Be.substitute(o,"//VTK::PositionVC::Impl",["vec4 gVertexMC = gMatrix * vertexMC;","  gl_Position = MCPCMatrix * gVertexMC;"]).result),r.Vertex=o}n.replaceShaderPositionVC(r,i,a)},t.replaceShaderPicking=(r,i,a)=>{if(e.hardwareSupport){let o=r.Fragment,s=r.Vertex;s=Be.substitute(s,"//VTK::Picking::Dec",["attribute vec3 mapperIndexVS;","varying vec3 mapperIndexVSOutput;"]).result,s=Be.substitute(s,"//VTK::Picking::Impl","  mapperIndexVSOutput = mapperIndexVS;").result,r.Vertex=s,o=Be.substitute(o,"//VTK::Picking::Dec",["varying vec3 mapperIndexVSOutput;","uniform vec3 mapperIndex;","uniform int picking;"]).result,o=Be.substitute(o,"//VTK::Picking::Impl",["  vec4 pickColor = picking == 2 ? vec4(mapperIndexVSOutput,1.0) : vec4(mapperIndex,1.0);","  gl_FragData[0] = picking != 0 ? pickColor : gl_FragData[0];"]).result,r.Fragment=o}else n.replaceShaderPicking(r,i,a)},t.updateGlyphShaderParameters=(r,i,a,o,s,l,c,f)=>{const u=a.getProgram();if(r){const d=e.normalMatrix,h=l,p=c*9,g=e.tmpMat3,m=d[0],y=d[1],v=d[2],x=d[3],w=d[4],S=d[5],T=d[6],_=d[7],D=d[8],I=h[p],R=h[p+1],M=h[p+2],A=h[p+3],L=h[p+4],P=h[p+5],B=h[p+6],U=h[p+7],G=h[p+8];g[0]=I*m+R*x+M*T,g[1]=I*y+R*w+M*_,g[2]=I*v+R*S+M*D,g[3]=A*m+L*x+P*T,g[4]=A*y+L*w+P*_,g[5]=A*v+L*S+P*D,g[6]=B*m+U*x+G*T,g[7]=B*y+U*w+G*_,g[8]=B*v+U*S+G*D,u.setUniformMatrix3x3("normalMatrix",e.tmpMat3)}if(t.multiply4x4WithOffset(e.tmpMat4,e.mcpcMatrix,s,c*16),u.setUniformMatrix("MCPCMatrix",e.tmpMat4),i&&(t.multiply4x4WithOffset(e.tmpMat4,e.mcvcMatrix,s,c*16),u.setUniformMatrix("MCVCMatrix",e.tmpMat4)),o){const d=o.getData();e.tmpColor[0]=d[c*4]/255,e.tmpColor[1]=d[c*4+1]/255,e.tmpColor[2]=d[c*4+2]/255,u.setUniform3fArray("ambientColorUniform",e.tmpColor),u.setUniform3fArray("diffuseColorUniform",e.tmpColor)}f&&u.setUniform3fArray("mapperIndex",f.getPropColorValue())},t.renderPieceDraw=(r,i)=>{const a=i.getProperty().getRepresentation(),o=e.context,s=i.getProperty().getEdgeVisibility()&&a===BTe.SURFACE,l=e.openGLCamera.getKeyMatrices(r),c=e.openGLActor.getKeyMatrices();um(e.normalMatrix,l.normalMatrix,c.normalMatrix),jn(e.mcpcMatrix,l.wcpc,c.mcwc),jn(e.mcvcMatrix,l.wcvc,c.mcwc);const f=e.renderable.getMatrixArray(),u=e.renderable.getNormalArray(),d=e.renderable.getColorArray(),h=f.length/16;let p=!1;e._openGLRenderer.getSelector()&&e._openGLRenderer.getSelector().getCurrentPass()===$Te.COMPOSITE_INDEX_PASS&&(p=!0);for(let g=e.primTypes.Start;g<e.primTypes.End;g++){const m=e.primitives[g].getCABO();if(m.getElementCount()){e.drawingEdges=s&&(g===e.primTypes.TrisEdges||g===e.primTypes.TriStripsEdges),e.lastBoundBO=e.primitives[g],e.primitives[g].updateShaders(r,i,t);const y=e.primitives[g].getProgram(),v=e.primitives[g].getOpenGLMode(a),x=y.isUniformUsed("normalMatrix"),w=y.isUniformUsed("MCVCMatrix");if(e.hardwareSupport)e.extension?e.extension.drawArraysInstancedANGLE(v,0,m.getElementCount(),h):o.drawArraysInstanced(v,0,m.getElementCount(),h);else for(let S=0;S<h;++S)p&&e._openGLRenderer.getSelector().renderCompositeIndex(S),t.updateGlyphShaderParameters(x,w,e.primitives[g],d,f,u,S,p?e._openGLRenderer.getSelector():null),o.drawArrays(v,0,m.getElementCount())}}},t.setMapperShaderParameters=(r,i,a)=>{if(r.getCABO().getElementCount()&&(e.glyphBOBuildTime.getMTime()>r.getAttributeUpdateTime().getMTime()||r.getShaderSourceTime().getMTime()>r.getAttributeUpdateTime().getMTime())){r.getProgram().isAttributeUsed("gMatrix")?r.getVAO().addAttributeMatrixWithDivisor(r.getProgram(),e.matrixBuffer,"gMatrix",0,64,e.context.FLOAT,4,!1,1)||X1("Error setting gMatrix in shader VAO."):r.getVAO().removeAttributeArray("gMatrix"),r.getProgram().isAttributeUsed("gNormal")?r.getVAO().addAttributeMatrixWithDivisor(r.getProgram(),e.normalBuffer,"gNormal",0,36,e.context.FLOAT,3,!1,1)||X1("Error setting gNormal in shader VAO."):r.getVAO().removeAttributeArray("gNormal"),r.getProgram().isAttributeUsed("gColor")?r.getVAO().addAttributeArrayWithDivisor(r.getProgram(),e.colorBuffer,"gColor",0,4,e.context.UNSIGNED_BYTE,4,!0,1,!1)||X1("Error setting gColor in shader VAO."):r.getVAO().removeAttributeArray("gColor"),r.getProgram().isAttributeUsed("mapperIndexVS")?r.getVAO().addAttributeArrayWithDivisor(r.getProgram(),e.pickBuffer,"mapperIndexVS",0,4,e.context.UNSIGNED_BYTE,4,!0,1,!1)||X1("Error setting mapperIndexVS in shader VAO."):r.getVAO().removeAttributeArray("mapperIndexVS"),n.setMapperShaderParameters(r,i,a),r.getAttributeUpdateTime().modified();return}n.setMapperShaderParameters(r,i,a)},t.getNeedToRebuildBufferObjects=(r,i)=>(e.renderable.buildArrays(),e.VBOBuildTime.getMTime()<e.renderable.getBuildTime().getMTime()?!0:n.getNeedToRebuildBufferObjects(r,i)),t.getNeedToRebuildShaders=(r,i,a)=>!!(n.getNeedToRebuildShaders(r,i,a)||r.getShaderSourceTime().getMTime()<e.renderable.getMTime()||r.getShaderSourceTime().getMTime()<e.currentInput.getMTime()),t.buildBufferObjects=(r,i)=>{if(e.hardwareSupport){const a=e.renderable.getMatrixArray(),o=e.renderable.getNormalArray(),s=e.renderable.getColorArray();if(e.matrixBuffer||(e.matrixBuffer=Cf.newInstance(),e.matrixBuffer.setOpenGLRenderWindow(e._openGLRenderWindow),e.normalBuffer=Cf.newInstance(),e.normalBuffer.setOpenGLRenderWindow(e._openGLRenderWindow),e.colorBuffer=Cf.newInstance(),e.colorBuffer.setOpenGLRenderWindow(e._openGLRenderWindow),e.pickBuffer=Cf.newInstance(),e.pickBuffer.setOpenGLRenderWindow(e._openGLRenderWindow)),e.renderable.getBuildTime().getMTime()>e.glyphBOBuildTime.getMTime()){e.matrixBuffer.upload(a,ox.ARRAY_BUFFER),e.normalBuffer.upload(o,ox.ARRAY_BUFFER),s?e.colorBuffer.upload(s.getData(),ox.ARRAY_BUFFER):e.colorBuffer.releaseGraphicsResources();const l=a.length/16,c=new Uint8Array(4*l);for(let f=0;f<l;++f){let u=f+1;const d=f*4;c[d]=u%256,u-=c[d],u/=256,c[d+1]=u%256,u-=c[d+1],u/=256,c[d+2]=u%256,c[d+3]=255}e.pickBuffer.upload(c,ox.ARRAY_BUFFER),e.glyphBOBuildTime.modified()}}return n.buildBufferObjects(r,i)}}const WTe={normalMatrix:null,mcpcMatrix:null,mcwcMatrix:null};function HTe(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,WTe,n),eC.extend(t,e,n),e.tmpMat3=Ll(new Float64Array(9)),e.normalMatrix=Ll(new Float64Array(9)),e.mcpcMatrix=sn(new Float64Array(16)),e.mcvcMatrix=sn(new Float64Array(16)),e.tmpColor=[],e.glyphBOBuildTime={},$r(e.glyphBOBuildTime,{mtime:0}),zTe(t,e)}const nY=Zn(HTe,"vtkOpenGLGlyph3DMapper");var KTe={newInstance:nY};sa("vtkGlyph3DMapper",nY);const{vtkErrorMacro:nk}=po;function qTe(t,e){e.classHierarchy.push("vtkOpenGLSkybox"),t.buildPass=n=>{if(n){e._openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e._openGLRenderWindow=e._openGLRenderer.getParent(),e.context=e._openGLRenderWindow.getContext(),e.tris.setOpenGLRenderWindow(e._openGLRenderWindow),e.openGLTexture.setOpenGLRenderWindow(e._openGLRenderWindow);const r=e._openGLRenderer.getRenderable();e.openGLCamera=e._openGLRenderer.getViewNodeFor(r.getActiveCamera())}},t.queryPass=(n,r)=>{if(n){if(!e.renderable||!e.renderable.getVisibility())return;r.incrementOpaqueActorCount()}},t.opaquePass=(n,r)=>{if(n&&!e._openGLRenderer.getSelector()){t.updateBufferObjects(),e.context.depthMask(!0),e._openGLRenderWindow.getShaderCache().readyShaderProgram(e.tris.getProgram()),e.openGLTexture.render(e._openGLRenderWindow);const i=e.openGLTexture.getTextureUnit();e.tris.getProgram().setUniformi("sbtexture",i);const a=e._openGLRenderer.getRenderable(),o=e.openGLCamera.getKeyMatrices(a),s=new Float64Array(16);if(ba(s,o.wcpc),e.tris.getProgram().setUniformMatrix("IMCPCMatrix",s),e.lastFormat==="box"){const l=a.getActiveCamera().getPosition();e.tris.getProgram().setUniform3f("camPos",l[0],l[1],l[2])}e.tris.getVAO().bind(),e.context.drawArrays(e.context.TRIANGLES,0,e.tris.getCABO().getElementCount()),e.tris.getVAO().release(),e.openGLTexture.deactivate()}},t.updateBufferObjects=()=>{if(!e.tris.getCABO().getElementCount()){const r=new Float32Array(12);for(let s=0;s<4;s++)r[s*3]=s%2*2-1,r[s*3+1]=s>1?1:-1,r[s*3+2]=1;const i=nn.newInstance({numberOfComponents:3,values:r});i.setName("points");const a=new Uint16Array(8);a[0]=3,a[1]=0,a[2]=1,a[3]=3,a[4]=3,a[5]=0,a[6]=3,a[7]=2;const o=nn.newInstance({numberOfComponents:1,values:a});e.tris.getCABO().createVBO(o,"polys",so.SURFACE,{points:i,cellOffset:0})}e.renderable.getFormat()!==e.lastFormat&&(e.lastFormat=e.renderable.getFormat(),e.lastFormat==="box"&&e.tris.setProgram(e._openGLRenderWindow.getShaderCache().readyShaderProgramArray(`//VTK::System::Dec
             attribute vec3 vertexMC;
             uniform mat4 IMCPCMatrix;
             varying vec3 TexCoords;
             void main () {
              gl_Position = vec4(vertexMC.xyz, 1.0);
              vec4 wpos = IMCPCMatrix * gl_Position;
              TexCoords = wpos.xyz/wpos.w;
             }`,`//VTK::System::Dec
             //VTK::Output::Dec
             varying vec3 TexCoords;
             uniform samplerCube sbtexture;
             uniform vec3 camPos;
             void main () {
               // skybox looks from inside out
               // which means we have to adjust
               // our tcoords. Otherwise text would
               // be flipped
               vec3 tc = normalize(TexCoords - camPos);
               if (abs(tc.z) < max(abs(tc.x),abs(tc.y)))
               {
                 tc = vec3(1.0, 1.0, -1.0) * tc;
               }
               else
               {
                 tc = vec3(-1.0, 1.0, 1.0) * tc;
               }
               gl_FragData[0] = textureCube(sbtexture, tc);
             }`,"")),e.lastFormat==="background"&&e.tris.setProgram(e._openGLRenderWindow.getShaderCache().readyShaderProgramArray(`//VTK::System::Dec
             attribute vec3 vertexMC;
             uniform mat4 IMCPCMatrix;
             varying vec2 TexCoords;
             void main () {
              gl_Position = vec4(vertexMC.xyz, 1.0);
              vec4 wpos = IMCPCMatrix * gl_Position;
              TexCoords = vec2(vertexMC.x, vertexMC.y)*0.5 + 0.5;
             }`,`//VTK::System::Dec
             //VTK::Output::Dec
             varying vec2 TexCoords;
             uniform sampler2D sbtexture;
             void main () {
               gl_FragData[0] = texture2D(sbtexture, TexCoords);
             }`,"")),e.tris.getShaderSourceTime().modified(),e.tris.getVAO().bind(),e.tris.getVAO().addAttributeArray(e.tris.getProgram(),e.tris.getCABO(),"vertexMC",e.tris.getCABO().getVertexOffset(),e.tris.getCABO().getStride(),e.context.FLOAT,3,e.context.FALSE)||nk("Error setting vertexMC in shader VAO."));const n=e.renderable.getTextures();n.length||nk("vtkSkybox requires a texture map"),e.openGLTexture.getRenderable()!==n[0]&&(e.openGLTexture.releaseGraphicsResources(e._openGLRenderWindow),e.openGLTexture.setRenderable(n[0]))}}const XTe={context:null};function YTe(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,XTe,n),Rr.extend(t,e,n),e.openGLTexture=ti.newInstance(),e.tris=Tu.newInstance(),e.keyMatrixTime={},$r(e.keyMatrixTime,{mtime:0}),e.keyMatrices={normalMatrix:Ll(new Float64Array(9)),mcwc:sn(new Float64Array(16))},Mi(t,e,["context"]),Po(t,e,["activeTextures"]),qTe(t,e)}const rY=Zn(YTe);var JTe={newInstance:rY};sa("vtkSkybox",rY);var ZTe=`//VTK::System::Dec

/*=========================================================================

  Program:   Visualization Toolkit
  Module:    vtkSphereMapperVS.glsl

  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen
  All rights reserved.
  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.

     This software is distributed WITHOUT ANY WARRANTY; without even
     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
     PURPOSE.  See the above copyright notice for more information.

=========================================================================*/
// this shader implements imposters in OpenGL for Spheres

attribute vec4 vertexMC;
attribute vec2 offsetMC;

// optional normal declaration
//VTK::Normal::Dec

//VTK::Picking::Dec

// Texture coordinates
//VTK::TCoord::Dec

uniform mat3 normalMatrix; // transform model coordinate directions to view coordinates

// material property values
//VTK::Color::Dec

// clipping plane vars
//VTK::Clip::Dec

// camera and actor matrix values
//VTK::Camera::Dec

varying vec4 vertexVCVSOutput;
varying float radiusVCVSOutput;
varying vec3 centerVCVSOutput;

uniform int cameraParallel;
uniform float scaleFactor;

void main()
{
  //VTK::Picking::Impl

  //VTK::Color::Impl

  //VTK::Normal::Impl

  //VTK::TCoord::Impl

  //VTK::Clip::Impl

  // compute the projected vertex position
  vec2 scaledOffsetMC = scaleFactor * offsetMC;
  vertexVCVSOutput = MCVCMatrix * vertexMC;
  centerVCVSOutput = vertexVCVSOutput.xyz;
  radiusVCVSOutput = length(scaledOffsetMC)*0.5;

  // make the triangle face the camera
  if (cameraParallel == 0)
    {
    vec3 dir = normalize(-vertexVCVSOutput.xyz);
    vec3 base2 = normalize(cross(dir,vec3(1.0,0.0,0.0)));
    vec3 base1 = cross(base2,dir);
    vertexVCVSOutput.xyz = vertexVCVSOutput.xyz + scaledOffsetMC.x*base1 + scaledOffsetMC.y*base2;
    }
  else
    {
    // add in the offset
    vertexVCVSOutput.xy = vertexVCVSOutput.xy + scaledOffsetMC;
    }

  gl_Position = VCPCMatrix * vertexVCVSOutput;
}
`;const{vtkErrorMacro:QTe}=po;function e8e(t,e){e.classHierarchy.push("vtkOpenGLSphereMapper");const n={...t};t.getShaderTemplate=(r,i,a)=>{r.Vertex=ZTe,r.Fragment=oy,r.Geometry=""},t.replaceShaderValues=(r,i,a)=>{let o=r.Vertex,s=r.Fragment;o=Be.substitute(o,"//VTK::Camera::Dec",[`uniform mat4 VCPCMatrix;
`,"uniform mat4 MCVCMatrix;"]).result,s=Be.substitute(s,"//VTK::PositionVC::Dec",["varying vec4 vertexVCVSOutput;"]).result,s=Be.substitute(s,"//VTK::PositionVC::Impl",[`vec4 vertexVC = vertexVCVSOutput;
`]).result;const l=[`uniform float invertedDepth;
`,`uniform int cameraParallel;
`,`varying float radiusVCVSOutput;
`,`varying vec3 centerVCVSOutput;
`,`uniform mat4 VCPCMatrix;
`];s=Be.substitute(s,"//VTK::Normal::Dec",l).result;let c="";e.context.getExtension("EXT_frag_depth")&&(c=`gl_FragDepthEXT = (pos.z / pos.w + 1.0) / 2.0;
`),e._openGLRenderWindow.getWebgl2()&&(c=`gl_FragDepth = (pos.z / pos.w + 1.0) / 2.0;
`),s=Be.substitute(s,"//VTK::Depth::Impl",[`  vec3 EyePos;
`,`  vec3 EyeDir;
`,`  if (cameraParallel != 0) {
`,`    EyePos = vec3(vertexVC.x, vertexVC.y, vertexVC.z + 3.0*radiusVCVSOutput);
`,`    EyeDir = vec3(0.0,0.0,-1.0); }
`,`  else {
`,`    EyeDir = vertexVC.xyz;
`,`    EyePos = vec3(0.0,0.0,0.0);
`,`    float lengthED = length(EyeDir);
`,`    EyeDir = normalize(EyeDir);
`,`    if (lengthED > radiusVCVSOutput*3.0) {
`,`      EyePos = vertexVC.xyz - EyeDir*3.0*radiusVCVSOutput; }
`,`    }
`,`  EyePos = EyePos - centerVCVSOutput;
`,`  EyePos = EyePos/radiusVCVSOutput;
`,`  float b = 2.0*dot(EyePos,EyeDir);
`,`  float c = dot(EyePos,EyePos) - 1.0;
`,`  float d = b*b - 4.0*c;
`,`  vec3 normalVCVSOutput = vec3(0.0,0.0,1.0);
`,`  if (d < 0.0) { discard; }
`,`  else {
`,`    float t = (-b - invertedDepth*sqrt(d))*0.5;
`,`    normalVCVSOutput = invertedDepth*normalize(EyePos + t*EyeDir);
`,`    vertexVC.xyz = normalVCVSOutput*radiusVCVSOutput + centerVCVSOutput;
`,`    }
`,`  vec4 pos = VCPCMatrix * vertexVC;
`,c]).result,s=Be.substitute(s,"//VTK::Normal::Impl","").result,e.haveSeenDepthRequest&&(s=Be.substitute(s,"//VTK::ZBuffer::Impl",["if (depthRequest == 1) {","float computedZ = (pos.z / pos.w + 1.0) / 2.0;","float iz = floor(computedZ * 65535.0 + 0.1);","float rf = floor(iz/256.0)/255.0;","float gf = mod(iz,256.0)/255.0;","gl_FragData[0] = vec4(rf, gf, 0.0, 1.0); }"]).result),r.Vertex=o,r.Fragment=s,n.replaceShaderValues(r,i,a)},t.setMapperShaderParameters=(r,i,a)=>{if(r.getCABO().getElementCount()&&(e.VBOBuildTime>r.getAttributeUpdateTime().getMTime()||r.getShaderSourceTime().getMTime()>r.getAttributeUpdateTime().getMTime())&&r.getProgram().isAttributeUsed("offsetMC")&&(r.getVAO().addAttributeArray(r.getProgram(),r.getCABO(),"offsetMC",12,r.getCABO().getStride(),e.context.FLOAT,2,!1)||QTe("Error setting 'offsetMC' in shader VAO.")),r.getProgram().isUniformUsed("invertedDepth")&&r.getProgram().setUniformf("invertedDepth",e.invert?-1:1),r.getProgram().isUniformUsed("scaleFactor")){const s=e.currentInput.getPointData();e.renderable.getScaleArray()!=null&&s.hasArray(e.renderable.getScaleArray())?r.getProgram().setUniformf("scaleFactor",e.renderable.getScaleFactor()):r.getProgram().setUniformf("scaleFactor",1)}n.setMapperShaderParameters(r,i,a)},t.setCameraShaderParameters=(r,i,a)=>{const o=r.getProgram(),s=i.getActiveCamera(),l=e.openGLCamera.getKeyMatrices(i);if(o.isUniformUsed("VCPCMatrix")&&o.setUniformMatrix("VCPCMatrix",l.vcpc),o.isUniformUsed("MCVCMatrix"))if(a.getIsIdentity())o.setUniformMatrix("MCVCMatrix",l.wcvc);else{const c=e.openGLActor.getKeyMatrices(),f=new Float64Array(16);jn(f,l.wcvc,c.mcwc),o.setUniformMatrix("MCVCMatrix",f)}o.isUniformUsed("cameraParallel")&&r.getProgram().setUniformi("cameraParallel",s.getParallelProjection())},t.getOpenGLMode=(r,i)=>e.context.TRIANGLES,t.buildBufferObjects=(r,i)=>{const a=e.currentInput;if(a===null)return;e.renderable.mapScalars(a,1);const o=e.renderable.getColorMapColors(),s=e.primitives[e.primTypes.Tris].getCABO(),l=a.getPointData(),c=a.getPoints(),f=c.getNumberOfPoints(),u=c.getData(),d=5;let h=null;e.renderable.getScaleArray()!=null&&l.hasArray(e.renderable.getScaleArray())&&(h=l.getArray(e.renderable.getScaleArray()).getData());let p=null,g=0,m=null;o?(g=o.getNumberOfComponents(),s.setColorOffset(0),s.setColorBOStride(4),p=o.getData(),m=new Uint8Array(3*f*4),s.getColorBO()||s.setColorBO(Cf.newInstance()),s.getColorBO().setOpenGLRenderWindow(e._openGLRenderWindow)):s.getColorBO()&&s.setColorBO(null),s.setColorComponents(g);const y=new Float32Array(d*f*3);s.setStride(d*4);const v=Math.cos(wi(30));let x=0,w=0,S=0,T=0;for(let _=0;_<f;++_){let D=e.renderable.getRadius();h&&(D=h[_]),x=_*3,y[S++]=u[x++],y[S++]=u[x++],y[S++]=u[x++],y[S++]=-2*D*v,y[S++]=-D,p&&(w=_*g,m[T++]=p[w],m[T++]=p[w+1],m[T++]=p[w+2],m[T++]=p[w+3]),x=_*3,y[S++]=u[x++],y[S++]=u[x++],y[S++]=u[x++],y[S++]=2*D*v,y[S++]=-D,p&&(m[T++]=p[w],m[T++]=p[w+1],m[T++]=p[w+2],m[T++]=p[w+3]),x=_*3,y[S++]=u[x++],y[S++]=u[x++],y[S++]=u[x++],y[S++]=0,y[S++]=2*D,p&&(m[T++]=p[w],m[T++]=p[w+1],m[T++]=p[w+2],m[T++]=p[w+3])}s.setElementCount(S/d),s.upload(y,Ef.ARRAY_BUFFER),o&&s.getColorBO().upload(m,Ef.ARRAY_BUFFER),e.VBOBuildTime.modified()}}const t8e={};function n8e(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,t8e,n),eC.extend(t,e,n),e8e(t,e)}const iY=Zn(n8e,"vtkOpenGLSphereMapper");var r8e={newInstance:iY};sa("vtkSphereMapper",iY);var i8e=`//VTK::System::Dec

/*=========================================================================

  Program:   Visualization Toolkit
  Module:    vtkStickMapperVS.glsl

  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen
  All rights reserved.
  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.

     This software is distributed WITHOUT ANY WARRANTY; without even
     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
     PURPOSE.  See the above copyright notice for more information.

=========================================================================*/
// this shader implements imposters in OpenGL for Sticks

attribute vec4 vertexMC;
attribute vec3 orientMC;
attribute vec4 offsetMC;
attribute float radiusMC;

// optional normal declaration
//VTK::Normal::Dec

//VTK::Picking::Dec

// Texture coordinates
//VTK::TCoord::Dec

uniform mat3 normalMatrix; // transform model coordinate directions to view coordinates

// material property values
//VTK::Color::Dec

// clipping plane vars
//VTK::Clip::Dec

// camera and actor matrix values
//VTK::Camera::Dec

varying vec4 vertexVCVSOutput;
varying float radiusVCVSOutput;
varying float lengthVCVSOutput;
varying vec3 centerVCVSOutput;
varying vec3 orientVCVSOutput;

uniform int cameraParallel;

void main()
{
  //VTK::Picking::Impl

  //VTK::Color::Impl

  //VTK::Normal::Impl

  //VTK::TCoord::Impl

  //VTK::Clip::Impl

  vertexVCVSOutput = MCVCMatrix * vertexMC;
  centerVCVSOutput = vertexVCVSOutput.xyz;
  radiusVCVSOutput = radiusMC;
  lengthVCVSOutput = length(orientMC);
  orientVCVSOutput = normalMatrix * normalize(orientMC);

  // make sure it is pointing out of the screen
  if (orientVCVSOutput.z < 0.0)
    {
    orientVCVSOutput = -orientVCVSOutput;
    }

  // make the basis
  vec3 xbase;
  vec3 ybase;
  vec3 dir = vec3(0.0,0.0,1.0);
  if (cameraParallel == 0)
    {
    dir = normalize(-vertexVCVSOutput.xyz);
    }
  if (abs(dot(dir,orientVCVSOutput)) == 1.0)
    {
    xbase = normalize(cross(vec3(0.0,1.0,0.0),orientVCVSOutput));
    ybase = cross(xbase,orientVCVSOutput);
    }
  else
    {
    xbase = normalize(cross(orientVCVSOutput,dir));
    ybase = cross(orientVCVSOutput,xbase);
    }

  vec3 offsets = offsetMC.xyz*2.0-1.0;
  vertexVCVSOutput.xyz = vertexVCVSOutput.xyz +
    radiusVCVSOutput*offsets.x*xbase +
    radiusVCVSOutput*offsets.y*ybase +
    0.5*lengthVCVSOutput*offsets.z*orientVCVSOutput;

  gl_Position = VCPCMatrix * vertexVCVSOutput;
}
`;const{vtkErrorMacro:sx}=po;function a8e(t,e){e.classHierarchy.push("vtkOpenGLStickMapper");const n={...t};t.getShaderTemplate=(r,i,a)=>{r.Vertex=i8e,r.Fragment=oy,r.Geometry=""},t.replaceShaderValues=(r,i,a)=>{let o=r.Vertex,s=r.Fragment;o=Be.substitute(o,"//VTK::Camera::Dec",[`uniform mat4 VCPCMatrix;
`,"uniform mat4 MCVCMatrix;"]).result,s=Be.substitute(s,"//VTK::PositionVC::Dec","varying vec4 vertexVCVSOutput;").result,s=Be.substitute(s,"//VTK::PositionVC::Impl",`  vec4 vertexVC = vertexVCVSOutput;
`).result;const l=[`uniform int cameraParallel;
`,`varying float radiusVCVSOutput;
`,`varying vec3 orientVCVSOutput;
`,`varying float lengthVCVSOutput;
`,`varying vec3 centerVCVSOutput;
`,`uniform mat4 VCPCMatrix;
`];s=Be.substitute(s,"//VTK::Normal::Dec",l).result;let c="";e.context.getExtension("EXT_frag_depth")&&(c=`  gl_FragDepthEXT = (pos.z / pos.w + 1.0) / 2.0;
`),e._openGLRenderWindow.getWebgl2()&&(c=`gl_FragDepth = (pos.z / pos.w + 1.0) / 2.0;
`),s=Be.substitute(s,"//VTK::Depth::Impl",[`  vec3 EyePos;
`,`  vec3 EyeDir;
`,`  if (cameraParallel != 0) {
`,`    EyePos = vec3(vertexVC.x, vertexVC.y, vertexVC.z + 3.0*radiusVCVSOutput);
`,`    EyeDir = vec3(0.0,0.0,-1.0); }
`,`  else {
`,`    EyeDir = vertexVC.xyz;
`,`    EyePos = vec3(0.0,0.0,0.0);
`,`    float lengthED = length(EyeDir);
`,`    EyeDir = normalize(EyeDir);
`,`    if (lengthED > radiusVCVSOutput*3.0) {
`,`      EyePos = vertexVC.xyz - EyeDir*3.0*radiusVCVSOutput; }
`,`    }
`,`  EyePos = EyePos - centerVCVSOutput;
`,`  vec3 base1;
`,`  if (abs(orientVCVSOutput.z) < 0.99) {
`,`    base1 = normalize(cross(orientVCVSOutput,vec3(0.0,0.0,1.0))); }
`,`  else {
`,`    base1 = normalize(cross(orientVCVSOutput,vec3(0.0,1.0,0.0))); }
`,`  vec3 base2 = cross(orientVCVSOutput,base1);
`,`  EyePos = vec3(dot(EyePos,base1),dot(EyePos,base2),dot(EyePos,orientVCVSOutput));
`,`  EyeDir = vec3(dot(EyeDir,base1),dot(EyeDir,base2),dot(EyeDir,orientVCVSOutput));
`,`  EyePos = EyePos/radiusVCVSOutput;
`,`  float a = EyeDir.x*EyeDir.x + EyeDir.y*EyeDir.y;
`,`  float b = 2.0*(EyePos.x*EyeDir.x + EyePos.y*EyeDir.y);
`,`  float c = EyePos.x*EyePos.x + EyePos.y*EyePos.y - 1.0;
`,`  float d = b*b - 4.0*a*c;
`,`  vec3 normalVCVSOutput = vec3(0.0,0.0,1.0);
`,`  if (d < 0.0) { discard; }
`,`  else {
`,`    float t =  (-b - sqrt(d))/(2.0*a);
`,`    float tz = EyePos.z + t*EyeDir.z;
`,`    vec3 iPoint = EyePos + t*EyeDir;
`,`    if (abs(iPoint.z)*radiusVCVSOutput > lengthVCVSOutput*0.5) {
`,`      float t2 = (-b + sqrt(d))/(2.0*a);
`,`      float tz2 = EyePos.z + t2*EyeDir.z;
`,`      if (tz2*radiusVCVSOutput > lengthVCVSOutput*0.5 || tz*radiusVCVSOutput < -0.5*lengthVCVSOutput) { discard; }
`,`      else {
`,`        normalVCVSOutput = orientVCVSOutput;
`,`        float t3 = (lengthVCVSOutput*0.5/radiusVCVSOutput - EyePos.z)/EyeDir.z;
`,`        iPoint = EyePos + t3*EyeDir;
`,`        vertexVC.xyz = radiusVCVSOutput*(iPoint.x*base1 + iPoint.y*base2 + iPoint.z*orientVCVSOutput) + centerVCVSOutput;
`,`        }
`,`      }
`,`    else {
`,`      normalVCVSOutput = iPoint.x*base1 + iPoint.y*base2;
`,`      vertexVC.xyz = radiusVCVSOutput*(normalVCVSOutput + iPoint.z*orientVCVSOutput) + centerVCVSOutput;
`,`      }
`,`    }
`,`  vec4 pos = VCPCMatrix * vertexVC;
`,c]).result,s=Be.substitute(s,"//VTK::Normal::Impl","").result,e.haveSeenDepthRequest&&(s=Be.substitute(s,"//VTK::ZBuffer::Impl",["if (depthRequest == 1) {","float computedZ = (pos.z / pos.w + 1.0) / 2.0;","float iz = floor(computedZ * 65535.0 + 0.1);","float rf = floor(iz/256.0)/255.0;","float gf = mod(iz,256.0)/255.0;","gl_FragData[0] = vec4(rf, gf, 0.0, 1.0); }"]).result),r.Vertex=o,r.Fragment=s,n.replaceShaderValues(r,i,a)},t.setMapperShaderParameters=(r,i,a)=>{r.getCABO().getElementCount()&&(e.VBOBuildTime>r.getAttributeUpdateTime().getMTime()||r.getShaderSourceTime().getMTime()>r.getAttributeUpdateTime().getMTime())&&(r.getProgram().isAttributeUsed("orientMC")&&(r.getVAO().addAttributeArray(r.getProgram(),r.getCABO(),"orientMC",12,r.getCABO().getStride(),e.context.FLOAT,3,!1)||sx("Error setting 'orientMC' in shader VAO.")),r.getProgram().isAttributeUsed("offsetMC")&&(r.getVAO().addAttributeArray(r.getProgram(),r.getCABO().getColorBO(),"offsetMC",0,r.getCABO().getColorBOStride(),e.context.UNSIGNED_BYTE,3,!0)||sx("Error setting 'offsetMC' in shader VAO.")),r.getProgram().isAttributeUsed("radiusMC")&&(r.getVAO().addAttributeArray(r.getProgram(),r.getCABO(),"radiusMC",24,r.getCABO().getStride(),e.context.FLOAT,1,!1)||sx("Error setting 'radiusMC' in shader VAO."))),n.setMapperShaderParameters(r,i,a)},t.setCameraShaderParameters=(r,i,a)=>{const o=r.getProgram(),s=i.getActiveCamera(),l=e.openGLCamera.getKeyMatrices(i);if(o.isUniformUsed("VCPCMatrix")&&o.setUniformMatrix("VCPCMatrix",l.vcpc),a.getIsIdentity())o.isUniformUsed("MCVCMatrix")&&o.setUniformMatrix("MCVCMatrix",l.wcvc),o.isUniformUsed("normalMatrix")&&o.setUniformMatrix3x3("normalMatrix",l.normalMatrix);else{const c=e.openGLActor.getKeyMatrices();if(o.isUniformUsed("MCVCMatrix")){const f=new Float64Array(16);jn(f,l.wcvc,c.mcwc),o.setUniformMatrix("MCVCMatrix",f)}if(o.isUniformUsed("normalMatrix")){const f=new Float64Array(9);um(f,l.normalMatrix,c.normalMatrix),o.setUniformMatrix3x3("normalMatrix",f)}}o.isUniformUsed("cameraParallel")&&r.getProgram().setUniformi("cameraParallel",s.getParallelProjection())},t.getOpenGLMode=(r,i)=>e.context.TRIANGLES,t.buildBufferObjects=(r,i)=>{const a=e.currentInput;if(a===null)return;e.renderable.mapScalars(a,1);const o=e.renderable.getColorMapColors(),s=e.primitives[e.primTypes.Tris].getCABO(),l=a.getPointData(),c=a.getPoints(),f=c.getNumberOfPoints(),u=c.getData();let d=3;d+=4;let h=null,p=0;s.setColorBOStride(4),s.getColorBO()||s.setColorBO(Cf.newInstance()),s.getColorBO().setOpenGLRenderWindow(e._openGLRenderWindow),o&&(p=o.getNumberOfComponents(),s.setColorOffset(4),h=o.getData(),s.setColorBOStride(8)),s.setColorComponents(p),s.setStride(d*4);const g=new Float32Array(d*f*12),m=new Uint8Array(12*f*(h?8:4));let y=null,v=null;e.renderable.getScaleArray()!=null&&l.hasArray(e.renderable.getScaleArray())&&(y=l.getArray(e.renderable.getScaleArray()).getData()),e.renderable.getOrientationArray()!=null&&l.hasArray(e.renderable.getOrientationArray())?v=l.getArray(e.renderable.getOrientationArray()).getData():sx([`Error setting orientationArray.
`,"You have to specify the stick orientation"]);const x=[0,1,3,0,3,2,2,3,5,2,5,4];let w=0,S=0,T=0,_=0;for(let D=0;D<f;++D){let I=e.renderable.getLength(),R=e.renderable.getRadius();y&&(I=y[D*2],R=y[D*2+1]);for(let M=0;M<x.length;++M)w=D*3,g[T++]=u[w++],g[T++]=u[w++],g[T++]=u[w++],w=D*3,g[T++]=v[w++]*I,g[T++]=v[w++]*I,g[T++]=v[w++]*I,g[T++]=R,m[_++]=255*(x[M]%2),m[_++]=x[M]>=4?255:0,m[_++]=x[M]>=2?255:0,m[_++]=255,S=D*p,h&&(m[_++]=h[S],m[_++]=h[S+1],m[_++]=h[S+2],m[_++]=h[S+3])}s.setElementCount(T/d),s.upload(g,Ef.ARRAY_BUFFER),s.getColorBO().upload(m,Ef.ARRAY_BUFFER),e.VBOBuildTime.modified()}}const o8e={};function s8e(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,o8e,n),eC.extend(t,e,n),a8e(t,e)}const aY=Zn(s8e,"vtkOpenGLStickMapper");var l8e={newInstance:aY};sa("vtkStickMapper",aY);function TD(t,e){switch(t){case"Float32Array":return Float32Array;case"Uint8Array":return Uint8Array;case"Uint32Array":return Uint32Array;case"Uint16Array":case"Int16Array":return e?(console.debug(`${t} is not supported for volume rendering, switching back to Float32Array`),Float32Array):t==="Uint16Array"?Uint16Array:Int16Array;default:if(t)throw new Error("TargetBuffer should be Float32Array, Uint8Array, Uint16Array, Int16Array, or Uint32Array");return Float32Array}}function ED(t,e,n={}){const{isVolumeBuffer:r=!1}=n,i=TD(t,r),a=i.BYTES_PER_ELEMENT;return{numBytes:e*a,TypedArrayConstructor:i}}function c8e(t,e){e.classHierarchy.push("vtkStreamingOpenGLVolumeMapper"),t.buildBufferObjects=(n,r)=>{const i=e.currentInput;if(!i)return;const a=r.getProperty();if(!e.jitterTexture.getHandle()){const g=new Uint8Array(1024);for(let m=0;m<1024;++m)g[m]=255*Math.random();e.jitterTexture.setMinificationFilter(on.LINEAR),e.jitterTexture.setMagnificationFilter(on.LINEAR),e.jitterTexture.create2DFromRaw(32,32,1,Nn.UNSIGNED_CHAR,g)}const{numberOfComponents:o}=i.get("numberOfComponents"),s=t.useIndependentComponents(a),l=a.getScalarOpacity(),c=e._openGLRenderWindow.getGraphicsResourceForObject(l);let f=vu(l,s,o);if(!c?.oglObject||c.hash!==f){e.opacityTexture=ti.newInstance(),e.opacityTexture.setOpenGLRenderWindow(e._openGLRenderWindow);const g=1024,m=g*2*o,y=new Float32Array(m),v=new Float32Array(g);for(let x=0;x<o;++x){const w=a.getScalarOpacity(x),S=t.getCurrentSampleDistance(n)/a.getScalarOpacityUnitDistance(x),T=w.getRange();w.getTable(T[0],T[1],g,v,1);for(let _=0;_<g;++_)y[x*g*2+_]=1-(1-v[_])**S,y[x*g*2+_+g]=y[x*g*2+_]}if(e.opacityTexture.resetFormatAndType(),e.opacityTexture.setMinificationFilter(on.LINEAR),e.opacityTexture.setMagnificationFilter(on.LINEAR),e._openGLRenderWindow.getWebgl2()&&e.context.getExtension("OES_texture_float")&&e.context.getExtension("OES_texture_float_linear"))e.opacityTexture.create2DFromRaw(g,2*o,1,Nn.FLOAT,y);else{const x=new Uint8ClampedArray(m);for(let w=0;w<m;++w)x[w]=255*y[w];e.opacityTexture.create2DFromRaw(g,2*o,1,Nn.UNSIGNED_CHAR,x)}l&&(e._openGLRenderWindow.setGraphicsResourceForObject(l,e.opacityTexture,f),l!==e._scalarOpacityFunc&&(e._openGLRenderWindow.registerGraphicsResourceUser(l,t),e._openGLRenderWindow.unregisterGraphicsResourceUser(e._scalarOpacityFunc,t)),e._scalarOpacityFunc=l)}else e.opacityTexture=c.oglObject;const d=a.getRGBTransferFunction();f=vu(d,s,o);const h=e._openGLRenderWindow.getGraphicsResourceForObject(d);if(!h?.oglObject?.getHandle()||h?.hash!==f){e.colorTexture=ti.newInstance(),e.colorTexture.setOpenGLRenderWindow(e._openGLRenderWindow);const g=1024,m=g*2*o*3,y=new Uint8ClampedArray(m),v=new Float32Array(g*3);for(let x=0;x<o;++x){const w=a.getRGBTransferFunction(x),S=w.getRange();w.getTable(S[0],S[1],g,v,1);for(let T=0;T<g*3;++T)y[x*g*6+T]=255*v[T],y[x*g*6+T+g*3]=255*v[T]}e.colorTexture.resetFormatAndType(),e.colorTexture.setMinificationFilter(on.LINEAR),e.colorTexture.setMagnificationFilter(on.LINEAR),e.colorTexture.create2DFromRaw(g,2*o,3,Nn.UNSIGNED_CHAR,y),d&&(e._openGLRenderWindow.setGraphicsResourceForObject(d,e.colorTexture,f),d!==e._colorTransferFunc&&(e._openGLRenderWindow.registerGraphicsResourceUser(d,t),e._openGLRenderWindow.unregisterGraphicsResourceUser(e._colorTransferFunc,t)),e._colorTransferFunc=d)}else e.colorTexture=h.oglObject;if(t.updateLabelOutlineThicknessTexture(r),f=`${i.getMTime()}-${e.scalarTexture.getMTime()}`,e.scalarTextureString!==f){const g=i.getDimensions();e.scalarTexture.setOpenGLRenderWindow(e._openGLRenderWindow),e.scalarTexture.enableUseHalfFloat(!1);const m=e.scalarTexture.getTextureParameters(),y=i.get("dataType").dataType;let v=!0;if(m?.dataType===y&&m?.width===g[0]&&m?.height===g[1]&&m?.depth===g[2]&&(v=!1),v){const x=e.context.getExtension("EXT_texture_norm16");e.scalarTexture.setOglNorm16Ext(O1e()?x:null),e.scalarTexture.resetFormatAndType(),e.scalarTexture.setTextureParameters({width:g[0],height:g[1],depth:g[2],numberOfComponents:o,dataType:y}),e.scalarTexture.create3DFromRaw(g[0],g[1],g[2],o,y,null),e.scalarTexture.update3DFromRaw()}else e.scalarTexture.deactivate(),e.scalarTexture.update3DFromRaw();e.scalarTextureString=f}if(!e.tris.getCABO().getElementCount()){const g=new Float32Array(12);for(let x=0;x<4;x++)g[x*3]=x%2*2-1,g[x*3+1]=x>1?1:-1,g[x*3+2]=-1;const m=new Uint16Array(8);m[0]=3,m[1]=0,m[2]=1,m[3]=3,m[4]=3,m[5]=0,m[6]=3,m[7]=2;const y=nn.newInstance({numberOfComponents:3,values:g});y.setName("points");const v=nn.newInstance({numberOfComponents:1,values:m});e.tris.getCABO().createVBO(v,"polys",so.SURFACE,{points:y,cellOffset:0})}e.VBOBuildTime.modified()},t.getNeedToRebuildBufferObjects=(n,r)=>e.VBOBuildTime.getMTime()<t.getMTime()||e.VBOBuildTime.getMTime()<r.getMTime()||e.VBOBuildTime.getMTime()<e.renderable.getMTime()||e.VBOBuildTime.getMTime()<r.getProperty().getMTime()||e.VBOBuildTime.getMTime()<e.currentInput.getMTime()||e.VBOBuildTime.getMTime()<e.scalarTexture?.getMTime()||e.VBOBuildTime.getMTime()<e.colorTexture?.getMTime()||e.VBOBuildTime.getMTime()<e.labelOutlineThicknessTexture?.getMTime()||!e.scalarTexture?.getHandle()||!e.colorTexture?.getHandle()||!e.labelOutlineThicknessTexture?.getHandle()}const u8e={};function f8e(t,e,n={}){Object.assign(e,u8e,n),oX.extend(t,e,n),e.scalarTexture=n.scalarTexture,e.previousState={},c8e(t,e)}const d8e=le.newInstance(f8e,"vtkStreamingOpenGLVolumeMapper"),h8e={newInstance:d8e},oY=Object.create(null);function za(t,e){oY[t]=e}function p8e(t,e){e.classHierarchy.push("vtkStreamingOpenGLViewNodeFactory"),t.createNode=n=>{if(n.isDeleted())return null;let r=0,i=n.getClassName(r++),a=!1;const o=Object.keys(e.overrides);for(;i&&!a;)o.includes(i)?a=!0:i=n.getClassName(r++);if(!a)return null;const s=e.getModelInitialValues(n),l=e.overrides[i](s);return l.setMyFactory(t),l},e.overrides=oY,e.getModelInitialValues=n=>{const r={};return n.getClassName()==="vtkSharedVolumeMapper"&&(r.scalarTexture=n.getScalarTexture()),r}}const g8e={};function sY(t,e,n={}){Object.assign(e,g8e,n),dD.extend(t,e,n),p8e(t,e),za("vtkActor",uTe.newInstance),za("vtkActor2D",pTe.newInstance),za("vtkCamera",xxe.newInstance),za("vtkGlyph3DMapper",KTe.newInstance),za("vtkImageMapper",hwe.newInstance),za("vtkImageCPRMapper",ywe.newInstance),za("vtkImageSlice",Cwe.newInstance),za("vtkMapper",eC.newInstance),za("vtkPixelSpaceCallbackMapper",Bwe.newInstance),za("vtkRenderer",Txe.newInstance),za("vtkSkybox",JTe.newInstance),za("vtkSphereMapper",r8e.newInstance),za("vtkStickMapper",l8e.newInstance),za("vtkTexture",ti.newInstance),za("vtkVolume",_we.newInstance),za("vtkVolumeMapper",oX.newInstance),za("vtkSharedVolumeMapper",h8e.newInstance)}const m8e=le.newInstance(sY,"vtkStreamingOpenGLViewNodeFactory"),v8e={newInstance:m8e,extend:sY};function y8e(t,e){e.classHierarchy.push("vtkStreamingOpenGLRenderWindow")}function lY(t,e,n={}){Object.assign(e,n),oTe.extend(t,e,n),e.myFactory=v8e.newInstance(),za("vtkRenderWindow",cY),y8e(t,e)}const cY=le.newInstance(lY,"vtkStreamingOpenGLRenderWindow"),x8e={newInstance:cY,extend:lY},{vtkDebugMacro:lx}=le;function b8e(t,e){e.classHierarchy.push("vtkCamera");const n=new Float64Array(3),r=new Float64Array([0,0,-1]),i=new Float64Array([0,1,0]),a=sn(new Float64Array(16)),o=sn(new Float64Array(16)),s=new Float64Array(3),l=new Float64Array(3),c=new Float64Array(3),f=sn(new Float64Array(16)),u=sn(new Float64Array(16)),d=new Float64Array(3),h=new Float64Array(3);function p(){e.viewPlaneNormal[0]=-e.directionOfProjection[0],e.viewPlaneNormal[1]=-e.directionOfProjection[1],e.viewPlaneNormal[2]=-e.directionOfProjection[2]}t.orthogonalizeViewUp=()=>{const g=t.getViewMatrix();e.viewUp[0]=g[4],e.viewUp[1]=g[5],e.viewUp[2]=g[6],t.modified()},t.setPosition=(g,m,y)=>{g===e.position[0]&&m===e.position[1]&&y===e.position[2]||(e.position[0]=g,e.position[1]=m,e.position[2]=y,t.computeDistance(),t.modified())},t.setFocalPoint=(g,m,y)=>{g===e.focalPoint[0]&&m===e.focalPoint[1]&&y===e.focalPoint[2]||(e.focalPoint[0]=g,e.focalPoint[1]=m,e.focalPoint[2]=y,t.computeDistance(),t.modified())},t.setDistance=g=>{if(e.distance===g)return;e.distance=g,e.distance<1e-20&&(e.distance=1e-20,lx("Distance is set to minimum."));const m=e.directionOfProjection;e.focalPoint[0]=e.position[0]+m[0]*e.distance,e.focalPoint[1]=e.position[1]+m[1]*e.distance,e.focalPoint[2]=e.position[2]+m[2]*e.distance,t.modified()},t.computeDistance=()=>{const g=e.focalPoint[0]-e.position[0],m=e.focalPoint[1]-e.position[1],y=e.focalPoint[2]-e.position[2];if(e.distance=Math.sqrt(g*g+m*m+y*y),e.distance<1e-20){e.distance=1e-20,lx("Distance is set to minimum.");const v=e.directionOfProjection;e.focalPoint[0]=e.position[0]+v[0]*e.distance,e.focalPoint[1]=e.position[1]+v[1]*e.distance,e.focalPoint[2]=e.position[2]+v[2]*e.distance}e.directionOfProjection[0]=g/e.distance,e.directionOfProjection[1]=m/e.distance,e.directionOfProjection[2]=y/e.distance,p()},t.dolly=g=>{if(g<=0)return;const m=e.distance/g;t.setPosition(e.focalPoint[0]-m*e.directionOfProjection[0],e.focalPoint[1]-m*e.directionOfProjection[1],e.focalPoint[2]-m*e.directionOfProjection[2])},t.roll=g=>{const m=e.position,y=e.focalPoint,v=e.viewUp,x=new Float64Array([v[0],v[1],v[2],0]);sn(f);const w=new Float64Array([y[0]-m[0],y[1]-m[1],y[2]-m[2]]);rc(f,f,wi(g),w),Oh(x,x,f),e.viewUp[0]=x[0],e.viewUp[1]=x[1],e.viewUp[2]=x[2],t.modified()},t.azimuth=g=>{const m=e.focalPoint;sn(u),si(u,u,m),rc(u,u,wi(g),e.viewUp),si(u,u,[-m[0],-m[1],-m[2]]),$n(d,e.position,u),t.setPosition(d[0],d[1],d[2])},t.yaw=g=>{const m=e.position;sn(u),si(u,u,m),rc(u,u,wi(g),e.viewUp),si(u,u,[-m[0],-m[1],-m[2]]),$n(h,e.focalPoint,u),t.setFocalPoint(h[0],h[1],h[2])},t.elevation=g=>{const m=e.focalPoint,y=t.getViewMatrix(),v=[-y[0],-y[1],-y[2]];sn(u),si(u,u,m),rc(u,u,wi(g),v),si(u,u,[-m[0],-m[1],-m[2]]),$n(d,e.position,u),t.setPosition(d[0],d[1],d[2])},t.pitch=g=>{const m=e.position,y=t.getViewMatrix(),v=[y[0],y[1],y[2]];sn(u),si(u,u,m),rc(u,u,wi(g),v),si(u,u,[-m[0],-m[1],-m[2]]),$n(h,e.focalPoint,u),t.setFocalPoint(...h)},t.zoom=g=>{g<=0||(e.parallelProjection?e.parallelScale/=g:e.viewAngle/=g,t.modified())},t.translate=(g,m,y)=>{const v=[g,m,y];a3(e.position,v,e.position),a3(e.focalPoint,v,e.focalPoint),t.computeDistance(),t.modified()},t.applyTransform=g=>{const m=[...e.viewUp,1],y=[],v=[],x=[];m[0]+=e.position[0],m[1]+=e.position[1],m[2]+=e.position[2],Oh(y,[...e.position,1],g),Oh(v,[...e.focalPoint,1],g),Oh(x,m,g),x[0]-=y[0],x[1]-=y[1],x[2]-=y[2],t.setPosition(...y.slice(0,3)),t.setFocalPoint(...v.slice(0,3)),t.setViewUp(...x.slice(0,3))},t.getThickness=()=>e.clippingRange[1]-e.clippingRange[0],t.setThickness=g=>{let m=g;m<1e-20&&(m=1e-20,lx("Thickness is set to minimum.")),t.setClippingRange(e.clippingRange[0],e.clippingRange[0]+m)},t.setThicknessFromFocalPoint=g=>{let m=g;m<1e-20&&(m=1e-20,lx("Thickness is set to minimum.")),t.setClippingRange(e.distance-m/2,e.distance+m/2)},t.setRoll=g=>{},t.getRoll=()=>{},t.setObliqueAngles=(g,m)=>{},t.getOrientation=()=>{},t.getOrientationWXYZ=()=>{},t.getFrustumPlanes=g=>{},t.getCameraLightTransformMatrix=g=>(Ei(g,e.cameraLightTransform),g),t.computeCameraLightTransform=()=>{Ei(a,t.getViewMatrix()),ba(a,a),tD(o,[e.distance,e.distance,e.distance]),jn(a,a,o),sn(e.cameraLightTransform),si(e.cameraLightTransform,a,[0,0,-1])},t.deepCopy=g=>{},t.physicalOrientationToWorldDirection=g=>{const m=xL(g[0],g[1],g[2],g[3]),y=Jh(),v=xL(0,0,1,0);return S5e(y,m),yL(v,m,v),yL(v,v,y),[v[0],v[1],v[2]]},t.getPhysicalToWorldMatrix=g=>{t.getWorldToPhysicalMatrix(g),ba(g,g)},t.getWorldToPhysicalMatrix=g=>{sn(g);const m=[3];gu(e.physicalViewNorth,e.physicalViewUp,m),g[0]=m[0],g[1]=m[1],g[2]=m[2],g[4]=e.physicalViewUp[0],g[5]=e.physicalViewUp[1],g[6]=e.physicalViewUp[2],g[8]=-e.physicalViewNorth[0],g[9]=-e.physicalViewNorth[1],g[10]=-e.physicalViewNorth[2],Gn(g,g),Lr(s,1/e.physicalScale,1/e.physicalScale,1/e.physicalScale),p0(g,g,s),si(g,g,e.physicalTranslation)},t.computeViewParametersFromViewMatrix=g=>{ba(a,g),$n(s,n,a),t.computeDistance();const m=e.distance;t.setPosition(s[0],s[1],s[2]),$n(l,r,a),Yd(l,l,s),mc(l,l),t.setDirectionOfProjection(l[0],l[1],l[2]),$n(c,i,a),Yd(c,c,s),mc(c,c),t.setViewUp(c[0],c[1],c[2]),t.setDistance(m)},t.computeViewParametersFromPhysicalMatrix=g=>{t.getWorldToPhysicalMatrix(a),jn(a,g,a),t.computeViewParametersFromViewMatrix(a)},t.setViewMatrix=g=>{e.viewMatrix=g,e.viewMatrix&&(Ei(a,e.viewMatrix),t.computeViewParametersFromViewMatrix(a),Gn(e.viewMatrix,e.viewMatrix))},t.getViewMatrix=()=>{if(e.viewMatrix)return e.viewMatrix;SK(a,e.position,e.focalPoint,e.viewUp),Gn(a,a);const g=new Float64Array(16);return Ei(g,a),g},t.setProjectionMatrix=g=>{e.projectionMatrix=g},t.getProjectionMatrix=(g,m,y)=>{const v=new Float64Array(16);if(sn(v),e.projectionMatrix){const S=1/e.physicalScale;return Lr(s,S,S,S),Ei(v,e.projectionMatrix),p0(v,v,s),Gn(v,v),v}sn(a);const x=e.clippingRange[1]-e.clippingRange[0],w=[e.clippingRange[0]+(m+1)*x/2,e.clippingRange[0]+(y+1)*x/2];if(e.parallelProjection){const S=e.parallelScale*g,T=e.parallelScale,_=(e.windowCenter[0]-1)*S,D=(e.windowCenter[0]+1)*S,I=(e.windowCenter[1]-1)*T,R=(e.windowCenter[1]+1)*T;CK(a,_,D,I,R,w[0],w[1]),Gn(a,a)}else{if(e.useOffAxisProjection)throw new Error("Off-Axis projection is not supported at this time");{const S=Math.tan(wi(e.viewAngle)/2);let T,_;e.useHorizontalViewAngle===!0?(T=e.clippingRange[0]*S,_=e.clippingRange[0]*S/g):(T=e.clippingRange[0]*S*g,_=e.clippingRange[0]*S);const D=(e.windowCenter[0]-1)*T,I=(e.windowCenter[0]+1)*T,R=(e.windowCenter[1]-1)*_,M=(e.windowCenter[1]+1)*_,A=w[0],L=w[1];a[0]=2*A/(I-D),a[5]=2*A/(M-R),a[2]=(D+I)/(I-D),a[6]=(R+M)/(M-R),a[10]=-(A+L)/(L-A),a[14]=-1,a[11]=-2*A*L/(L-A),a[15]=0}}return Ei(v,a),v},t.getCompositeProjectionMatrix=(g,m,y)=>{const v=t.getViewMatrix(),x=t.getProjectionMatrix(g,m,y);return jn(x,v,x),x},t.setDirectionOfProjection=(g,m,y)=>{if(e.directionOfProjection[0]===g&&e.directionOfProjection[1]===m&&e.directionOfProjection[2]===y)return;e.directionOfProjection[0]=g,e.directionOfProjection[1]=m,e.directionOfProjection[2]=y;const v=e.directionOfProjection;e.focalPoint[0]=e.position[0]+v[0]*e.distance,e.focalPoint[1]=e.position[1]+v[1]*e.distance,e.focalPoint[2]=e.position[2]+v[2]*e.distance,p()},t.setDeviceAngles=(g,m,y,v)=>{const x=[3];gu(e.physicalViewNorth,e.physicalViewUp,x);const w=sn(new Float64Array(16));rc(w,w,wi(g),e.physicalViewUp),rc(w,w,wi(m),x),rc(w,w,wi(y),e.physicalViewNorth),rc(w,w,wi(-v),e.physicalViewUp);const S=new Float64Array([-e.physicalViewUp[0],-e.physicalViewUp[1],-e.physicalViewUp[2]]),T=new Float64Array(e.physicalViewNorth);$n(S,S,w),$n(T,T,w),t.setDirectionOfProjection(S[0],S[1],S[2]),t.setViewUp(T[0],T[1],T[2]),t.modified()},t.setOrientationWXYZ=(g,m,y,v)=>{const x=sn(new Float64Array(16));if(g!==0&&(m!==0||y!==0||v!==0)){const T=wi(g),_=Jh();nD(_,[m,y,v],T),f3(x,_)}const w=new Float64Array(3);$n(w,[0,0,-1],x);const S=new Float64Array(3);$n(S,[0,1,0],x),t.setDirectionOfProjection(...w),t.setViewUp(...S),t.modified()},t.computeClippingRange=g=>{let m=null,y=null;m=e.viewPlaneNormal,y=e.position;const v=-m[0],x=-m[1],w=-m[2],S=-(v*y[0]+x*y[1]+w*y[2]),T=[v*g[0]+x*g[2]+w*g[4]+S,1e-18];for(let _=0;_<2;_++)for(let D=0;D<2;D++)for(let I=0;I<2;I++){const R=v*g[I]+x*g[2+D]+w*g[4+_]+S;T[0]=R<T[0]?R:T[0],T[1]=R>T[1]?R:T[1]}return T}}const w8e={position:[0,0,1],focalPoint:[0,0,0],viewUp:[0,1,0],directionOfProjection:[0,0,-1],parallelProjection:!1,useHorizontalViewAngle:!1,viewAngle:30,parallelScale:1,clippingRange:[.01,1000.01],windowCenter:[0,0],viewPlaneNormal:[0,0,1],useOffAxisProjection:!1,screenBottomLeft:[-.5,-.5,-.5],screenBottomRight:[.5,-.5,-.5],screenTopRight:[.5,.5,-.5],freezeFocalPoint:!1,projectionMatrix:null,viewMatrix:null,cameraLightTransform:Y9(),physicalTranslation:[0,0,0],physicalScale:1,physicalViewUp:[0,1,0],physicalViewNorth:[0,0,-1]};function uY(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,w8e,n),le.obj(t,e),le.get(t,e,["distance"]),le.setGet(t,e,["parallelProjection","useHorizontalViewAngle","viewAngle","parallelScale","useOffAxisProjection","freezeFocalPoint","physicalScale"]),le.getArray(t,e,["directionOfProjection","viewPlaneNormal","position","focalPoint"]),le.setGetArray(t,e,["clippingRange","windowCenter"],2),le.setGetArray(t,e,["viewUp","screenBottomLeft","screenBottomRight","screenTopRight","physicalTranslation","physicalViewUp","physicalViewNorth"],3),b8e(t,e)}const C8e=le.newInstance(uY,"vtkCamera");var _D={newInstance:C8e,extend:uY};function S8e(t,e){e.classHierarchy.push("vtkLight");const n=new Float64Array(3);t.getTransformedPosition=()=>(e.transformMatrix?$n(n,e.position,e.transformMatrix):Lr(n,e.position[0],e.position[1],e.position[2]),n),t.getTransformedFocalPoint=()=>(e.transformMatrix?$n(n,e.focalPoint,e.transformMatrix):Lr(n,e.focalPoint[0],e.focalPoint[1],e.focalPoint[2]),n),t.getDirection=()=>(e.directionMTime<e.mtime&&(w6(e.direction,e.focalPoint,e.position),qh(e.direction),e.directionMTime=e.mtime),e.direction),t.setDirection=r=>{const i=new Float64Array(3);w6(i,e.position,r),e.focalPoint=i},t.setDirectionAngle=(r,i)=>{const a=wi(r),o=wi(i);t.setPosition(Math.cos(a)*Math.sin(o),Math.sin(a),Math.cos(a)*Math.cos(o)),t.setFocalPoint(0,0,0),t.setPositional(0)},t.setLightTypeToHeadLight=()=>{t.setLightType("HeadLight")},t.setLightTypeToCameraLight=()=>{t.setLightType("CameraLight")},t.setLightTypeToSceneLight=()=>{t.setTransformMatrix(null),t.setLightType("SceneLight")},t.lightTypeIsHeadLight=()=>e.lightType==="HeadLight",t.lightTypeIsSceneLight=()=>e.lightType==="SceneLight",t.lightTypeIsCameraLight=()=>e.lightType==="CameraLight"}const T8e={switch:!0,intensity:1,color:[1,1,1],position:[0,0,1],focalPoint:[0,0,0],positional:!1,exponent:1,coneAngle:30,coneFalloff:5,attenuationValues:[1,0,0],transformMatrix:null,lightType:"SceneLight",shadowAttenuation:1,direction:[0,0,0],directionMTime:0};function E8e(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,T8e,n),le.obj(t,e),le.setGet(t,e,["intensity","switch","positional","exponent","coneAngle","coneFalloff","transformMatrix","lightType","shadowAttenuation","attenuationValues"]),le.setGetArray(t,e,["color","position","focalPoint","attenuationValues"],3),S8e(t,e)}const _8e=le.newInstance(E8e,"vtkLight");var D8e={newInstance:_8e};const{vtkErrorMacro:vb}=le;function O8e(t){return()=>vb(`vtkViewport::${t} - NOT IMPLEMENTED`)}function M8e(t,e){e.classHierarchy.push("vtkViewport"),t.getViewProps=()=>e.props,t.hasViewProp=r=>e.props.includes(r),t.addViewProp=r=>{r&&!t.hasViewProp(r)&&e.props.push(r)},t.removeViewProp=r=>{const i=e.props.filter(a=>a!==r);e.props.length!==i.length&&(e.props=i)},t.removeAllViewProps=()=>{e.props=[]};function n(r){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];i.push(r);const a=r.getNestedProps();if(a&&a.length)for(let o=0;o<a.length;o++)n(a[o],i);return i}t.getViewPropsWithNestedProps=()=>{const r=[];for(let i=0;i<e.props.length;i++)n(e.props[i],r);return r},t.addActor2D=t.addViewProp,t.removeActor2D=r=>{t.removeViewProp(r)},t.getActors2D=()=>(e.actors2D=[],e.props.forEach(r=>{e.actors2D=e.actors2D.concat(r.getActors2D())}),e.actors2D),t.displayToView=()=>vb("call displayToView on your view instead"),t.viewToDisplay=()=>vb("callviewtodisplay on your view instead"),t.getSize=()=>vb("call getSize on your View instead"),t.normalizedDisplayToProjection=(r,i,a)=>{const o=t.normalizedDisplayToNormalizedViewport(r,i,a);return t.normalizedViewportToProjection(o[0],o[1],o[2])},t.normalizedDisplayToNormalizedViewport=(r,i,a)=>{const o=[e.viewport[2]-e.viewport[0],e.viewport[3]-e.viewport[1]];return[(r-e.viewport[0])/o[0],(i-e.viewport[1])/o[1],a]},t.normalizedViewportToProjection=(r,i,a)=>[r*2-1,i*2-1,a*2-1],t.projectionToNormalizedDisplay=(r,i,a)=>{const o=t.projectionToNormalizedViewport(r,i,a);return t.normalizedViewportToNormalizedDisplay(o[0],o[1],o[2])},t.normalizedViewportToNormalizedDisplay=(r,i,a)=>{const o=[e.viewport[2]-e.viewport[0],e.viewport[3]-e.viewport[1]];return[r*o[0]+e.viewport[0],i*o[1]+e.viewport[1],a]},t.projectionToNormalizedViewport=(r,i,a)=>[(r+1)*.5,(i+1)*.5,(a+1)*.5],t.PickPropFrom=O8e("PickPropFrom")}const I8e={background:[0,0,0],background2:[.2,.2,.2],gradientBackground:!1,viewport:[0,0,1,1],aspect:[1,1],pixelAspect:[1,1],props:[],actors2D:[]};function fY(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,I8e,n),le.obj(t,e),le.event(t,e,"event"),le.setGetArray(t,e,["viewport"],4),le.setGetArray(t,e,["background","background2"],3),M8e(t,e)}const R8e=le.newInstance(fY,"vtkViewport");var A8e={newInstance:R8e,extend:fY};const{vtkDebugMacro:Y1,vtkErrorMacro:Sd,vtkWarningMacro:P8e}=po;function rk(t){return()=>Sd(`vtkRenderer::${t} - NOT IMPLEMENTED`)}function N8e(t,e){e.classHierarchy.push("vtkRenderer");const n={type:"ComputeVisiblePropBoundsEvent",renderer:t},r={type:"ResetCameraClippingRangeEvent",renderer:t},i={type:"ResetCameraEvent",renderer:t};t.updateCamera=()=>(e.activeCamera||(Y1("No cameras are on, creating one."),t.getActiveCameraAndResetIfCreated()),e.activeCamera.render(t),!0),t.updateLightsGeometryToFollowCamera=()=>{const a=t.getActiveCameraAndResetIfCreated();e.lights.forEach(o=>{o.lightTypeIsSceneLight()||(o.lightTypeIsHeadLight()?(o.setPositionFrom(a.getPositionByReference()),o.setFocalPointFrom(a.getFocalPointByReference()),o.modified(a.getMTime())):o.lightTypeIsCameraLight()?o.setTransformMatrix(a.getCameraLightTransformMatrix(Y9())):Sd("light has unknown light type",o.get()))})},t.updateLightGeometry=()=>e.lightFollowCamera?t.updateLightsGeometryToFollowCamera():!0,t.allocateTime=rk("allocateTime"),t.updateGeometry=rk("updateGeometry"),t.getVTKWindow=()=>e._renderWindow,t.setLayer=a=>{Y1(t.getClassName(),t,"setting Layer to ",a),e.layer!==a&&(e.layer=a,t.modified()),t.setPreserveColorBuffer(!!a)},t.setActiveCamera=a=>e.activeCamera===a?!1:(e.activeCamera=a,t.modified(),t.invokeEvent({type:"ActiveCameraEvent",camera:a}),!0),t.makeCamera=()=>{const a=_D.newInstance();return t.invokeEvent({type:"CreateCameraEvent",camera:a}),a},t.getActiveCamera=()=>(e.activeCamera||(e.activeCamera=t.makeCamera()),e.activeCamera),t.getActiveCameraAndResetIfCreated=()=>(e.activeCamera||(t.getActiveCamera(),t.resetCamera()),e.activeCamera),t.getActors=()=>(e.actors=[],e.props.forEach(a=>{e.actors=e.actors.concat(a.getActors())}),e.actors),t.addActor=t.addViewProp,t.removeActor=a=>{e.actors=e.actors.filter(o=>o!==a),t.removeViewProp(a),t.modified()},t.removeAllActors=()=>{t.getActors().forEach(o=>{t.removeViewProp(o)}),e.actors=[],t.modified()},t.getVolumes=()=>(e.volumes=[],e.props.forEach(a=>{e.volumes=e.volumes.concat(a.getVolumes())}),e.volumes),t.addVolume=t.addViewProp,t.removeVolume=a=>{e.volumes=e.volumes.filter(o=>o!==a),t.removeViewProp(a),t.modified()},t.removeAllVolumes=()=>{t.getVolumes().forEach(o=>{t.removeViewProp(o)}),e.volumes=[],t.modified()},t.hasLight=a=>e.lights.includes(a),t.addLight=a=>{a&&!t.hasLight(a)&&(e.lights.push(a),t.modified())},t.removeLight=a=>{e.lights=e.lights.filter(o=>o!==a),t.modified()},t.removeAllLights=()=>{e.lights=[],t.modified()},t.setLightCollection=a=>{e.lights=a,t.modified()},t.makeLight=D8e.newInstance,t.createLight=()=>{e.automaticLightCreation&&(e._createdLight&&(t.removeLight(e._createdLight),e._createdLight.delete(),e._createdLight=null),e._createdLight=t.makeLight(),t.addLight(e._createdLight),e._createdLight.setLightTypeToHeadLight(),e._createdLight.setPosition(t.getActiveCamera().getPosition()),e._createdLight.setFocalPoint(t.getActiveCamera().getFocalPoint()))},t.normalizedDisplayToWorld=(a,o,s,l)=>{let c=t.normalizedDisplayToProjection(a,o,s);return c=t.projectionToView(c[0],c[1],c[2],l),t.viewToWorld(c[0],c[1],c[2])},t.worldToNormalizedDisplay=(a,o,s,l)=>{let c=t.worldToView(a,o,s);return c=t.viewToProjection(c[0],c[1],c[2],l),t.projectionToNormalizedDisplay(c[0],c[1],c[2])},t.viewToWorld=(a,o,s)=>{if(e.activeCamera===null)return Sd("ViewToWorld: no active camera, cannot compute view to world, returning 0,0,0"),[0,0,0];const l=e.activeCamera.getViewMatrix();ba(l,l),Gn(l,l);const c=new Float64Array([a,o,s]);return $n(c,c,l),c},t.projectionToView=(a,o,s,l)=>{if(e.activeCamera===null)return Sd("ProjectionToView: no active camera, cannot compute projection to view, returning 0,0,0"),[0,0,0];const c=e.activeCamera.getProjectionMatrix(l,-1,1);ba(c,c),Gn(c,c);const f=new Float64Array([a,o,s]);return $n(f,f,c),f},t.worldToView=(a,o,s)=>{if(e.activeCamera===null)return Sd("WorldToView: no active camera, cannot compute view to world, returning 0,0,0"),[0,0,0];const l=e.activeCamera.getViewMatrix();Gn(l,l);const c=new Float64Array([a,o,s]);return $n(c,c,l),c},t.viewToProjection=(a,o,s,l)=>{if(e.activeCamera===null)return Sd("ViewToProjection: no active camera, cannot compute view to projection, returning 0,0,0"),[0,0,0];const c=e.activeCamera.getProjectionMatrix(l,-1,1);Gn(c,c);const f=new Float64Array([a,o,s]);return $n(f,f,c),f},t.computeVisiblePropBounds=()=>{e.allBounds[0]=wr.INIT_BOUNDS[0],e.allBounds[1]=wr.INIT_BOUNDS[1],e.allBounds[2]=wr.INIT_BOUNDS[2],e.allBounds[3]=wr.INIT_BOUNDS[3],e.allBounds[4]=wr.INIT_BOUNDS[4],e.allBounds[5]=wr.INIT_BOUNDS[5];let a=!0;t.invokeEvent(n);for(let o=0;o<e.props.length;++o){const s=e.props[o];if(s.getVisibility()&&s.getUseBounds()){const l=s.getBounds();l&&sb(l)&&(a=!1,l[0]<e.allBounds[0]&&(e.allBounds[0]=l[0]),l[1]>e.allBounds[1]&&(e.allBounds[1]=l[1]),l[2]<e.allBounds[2]&&(e.allBounds[2]=l[2]),l[3]>e.allBounds[3]&&(e.allBounds[3]=l[3]),l[4]<e.allBounds[4]&&(e.allBounds[4]=l[4]),l[5]>e.allBounds[5]&&(e.allBounds[5]=l[5]))}}return a&&(Nm(e.allBounds),Y1("Can't compute bounds, no 3D props are visible")),e.allBounds},t.resetCamera=function(){const o=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:null)||t.computeVisiblePropBounds(),s=[0,0,0];if(!sb(o))return Y1("Cannot reset camera!"),!1;let l=null;if(t.getActiveCamera())l=e.activeCamera.getViewPlaneNormal();else return Sd("Trying to reset non-existent camera"),!1;e.activeCamera.setViewAngle(30),s[0]=(o[0]+o[1])/2,s[1]=(o[2]+o[3])/2,s[2]=(o[4]+o[5])/2;let c=o[1]-o[0],f=o[3]-o[2],u=o[5]-o[4];c*=c,f*=f,u*=u;let d=c+f+u;d=d===0?1:d,d=Math.sqrt(d)*.5;const h=wi(e.activeCamera.getViewAngle()),p=d,g=d/Math.sin(h*.5),m=e.activeCamera.getViewUp();return Math.abs(An(m,l))>.999&&(P8e("Resetting view-up since view plane normal is parallel"),e.activeCamera.setViewUp(-m[2],m[0],m[1])),e.activeCamera.setFocalPoint(s[0],s[1],s[2]),e.activeCamera.setPosition(s[0]+g*l[0],s[1]+g*l[1],s[2]+g*l[2]),t.resetCameraClippingRange(o),e.activeCamera.setParallelScale(p),e.activeCamera.setPhysicalScale(d),e.activeCamera.setPhysicalTranslation(-s[0],-s[1],-s[2]),t.invokeEvent(i),!0},t.resetCameraClippingRange=function(){const o=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:null)||t.computeVisiblePropBounds();if(!sb(o))return Y1("Cannot reset camera clipping range!"),!1;if(t.getActiveCameraAndResetIfCreated(),!e.activeCamera)return Sd("Trying to reset clipping range of non-existent camera"),!1;const s=e.activeCamera.computeClippingRange(o);let l=0;if(e.activeCamera.getParallelProjection())l=.2*e.activeCamera.getParallelScale();else{const c=wi(e.activeCamera.getViewAngle());l=.2*Math.tan(c/2)*s[1]}return s[1]-s[0]<l&&(l=l-s[1]+s[0],s[1]+=l/2,s[0]-=l/2),s[0]<0&&(s[0]=0),s[0]=.99*s[0]-(s[1]-s[0])*e.clippingRangeExpansion,s[1]=1.01*s[1]+(s[1]-s[0])*e.clippingRangeExpansion,s[0]=s[0]>=s[1]?.01*s[1]:s[0],e.nearClippingPlaneTolerance||(e.nearClippingPlaneTolerance=.01),s[0]<e.nearClippingPlaneTolerance*s[1]&&(s[0]=e.nearClippingPlaneTolerance*s[1]),e.activeCamera.setClippingRange(s[0],s[1]),t.invokeEvent(r),!1},t.setRenderWindow=a=>{a!==e._renderWindow&&(e._vtkWindow=a,e._renderWindow=a)},t.visibleActorCount=()=>e.props.filter(a=>a.getVisibility()).length,t.visibleVolumeCount=t.visibleActorCount,t.getMTime=()=>{let a=e.mtime;const o=e.activeCamera?e.activeCamera.getMTime():0;o>a&&(a=o);const s=e._createdLight?e._createdLight.getMTime():0;return s>a&&(a=s),a},t.getTransparent=()=>!!e.preserveColorBuffer,t.isActiveCameraCreated=()=>!!e.activeCamera}const L8e={pickedProp:null,activeCamera:null,allBounds:[],ambient:[1,1,1],allocatedRenderTime:100,timeFactor:1,automaticLightCreation:!0,twoSidedLighting:!0,lastRenderTimeInSeconds:-1,renderWindow:null,lights:[],actors:[],volumes:[],lightFollowCamera:!0,numberOfPropsRendered:0,propArray:null,pathArray:null,layer:0,preserveColorBuffer:!1,preserveDepthBuffer:!1,computeVisiblePropBounds:d0(),interactive:!0,nearClippingPlaneTolerance:0,clippingRangeExpansion:.05,erase:!0,draw:!0,useShadows:!1,useDepthPeeling:!1,occlusionRatio:0,maximumNumberOfPeels:4,selector:null,delegate:null,texturedBackground:!1,backgroundTexture:null,environmentTexture:null,environmentTextureDiffuseStrength:1,environmentTextureSpecularStrength:1,useEnvironmentTextureAsBackground:!1,pass:0};function dY(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};for(Object.assign(e,L8e,n),A8e.extend(t,e,n),e.background||(e.background=[0,0,0,1]);e.background.length<3;)e.background.push(0);e.background.length===3&&e.background.push(1),Po(t,e,["_renderWindow","allocatedRenderTime","timeFactor","lastRenderTimeInSeconds","numberOfPropsRendered","lastRenderingUsedDepthPeeling","selector"]),Mi(t,e,["twoSidedLighting","lightFollowCamera","automaticLightCreation","erase","draw","nearClippingPlaneTolerance","clippingRangeExpansion","backingStore","interactive","layer","preserveColorBuffer","preserveDepthBuffer","useDepthPeeling","occlusionRatio","maximumNumberOfPeels","delegate","backgroundTexture","texturedBackground","environmentTexture","environmentTextureDiffuseStrength","environmentTextureSpecularStrength","useEnvironmentTextureAsBackground","useShadows","pass"]),Pm(t,e,["actors","volumes","lights"]),T9(t,e,["background"],4,1),Z2(t,e,["renderWindow"]),N8e(t,e)}const k8e=Zn(dY,"vtkRenderer");var V8e={newInstance:k8e,extend:dY};const F8e={Unknown:0,LeftController:1,RightController:2},U8e={Unknown:0,Trigger:1,TrackPad:2,Grip:3,Thumbstick:4,A:5,B:6,ApplicationMenu:7},B8e={Unknown:0,TouchpadX:1,TouchpadY:2,ThumbstickX:3,ThumbstickY:4};var hY={Device:F8e,Input:U8e,Axis:B8e};const{Device:cx,Input:ih}=hY,{vtkWarningMacro:ux,vtkErrorMacro:fx,normalizeWheel:$8e,vtkOnceErrorMacro:G8e}=le,Qp={ctrlKey:!1,altKey:!1,shiftKey:!1},ZT={"xr-standard":[ih.Trigger,ih.Grip,ih.TrackPad,ih.Thumbstick,ih.A,ih.B]},DD=["StartAnimation","Animation","EndAnimation","PointerEnter","PointerLeave","MouseEnter","MouseLeave","StartMouseMove","MouseMove","EndMouseMove","LeftButtonPress","LeftButtonRelease","MiddleButtonPress","MiddleButtonRelease","RightButtonPress","RightButtonRelease","KeyPress","KeyDown","KeyUp","StartMouseWheel","MouseWheel","EndMouseWheel","StartPinch","Pinch","EndPinch","StartPan","Pan","EndPan","StartRotate","Rotate","EndRotate","Button3D","Move3D","StartPointerLock","EndPointerLock","StartInteraction","Interaction","EndInteraction","AnimationFrameRateUpdate"];function J1(t){t.cancelable&&t.preventDefault()}function dx(t){const e=Object.create(null);return t.forEach(n=>{let{pointerId:r,position:i}=n;e[r]=i}),e}function j8e(t,e){e.classHierarchy.push("vtkRenderWindowInteractor");const n={...t},r=new Set,i=new Map;let a=1;t.start=()=>{!e.initialized&&(t.initialize(),!e.initialized)||t.startEventLoop()},t.setRenderWindow=g=>{fx("you want to call setView(view) instead of setRenderWindow on a vtk.js interactor")},t.setInteractorStyle=g=>{e.interactorStyle!==g&&(e.interactorStyle!=null&&e.interactorStyle.setInteractor(null),e.interactorStyle=g,e.interactorStyle!=null&&e.interactorStyle.getInteractor()!==t&&e.interactorStyle.setInteractor(t))},t.initialize=()=>{e.initialized=!0,t.enable(),t.render()},t.enable=()=>t.setEnabled(!0),t.disable=()=>t.setEnabled(!1),t.startEventLoop=()=>ux("empty event loop");function o(g,m){e._forcedRenderer||(e.currentRenderer=t.findPokedRenderer(g,m))}t.getCurrentRenderer=()=>(e.currentRenderer||o(0,0),e.currentRenderer);function s(g){const m=e._view.getCanvas(),y=m.getBoundingClientRect(),v=m.width/y.width,x=m.height/y.height,w={x:v*(g.clientX-y.left),y:x*(y.height-g.clientY+y.top),z:0};return(i.size<=1||!e.currentRenderer)&&o(w.x,w.y),w}const l=e._getScreenEventPositionFor||s;function c(g){return{controlKey:g.ctrlKey,altKey:g.altKey,shiftKey:g.shiftKey}}function f(g){const m=c(g);return{key:g.key,keyCode:g.charCode,...m}}function u(g){return g.pointerType||""}const d=()=>{if(e.container===null)return;const{container:g}=e;g.addEventListener("contextmenu",J1),g.addEventListener("wheel",t.handleWheel),g.addEventListener("DOMMouseScroll",t.handleWheel),g.addEventListener("pointerenter",t.handlePointerEnter),g.addEventListener("pointerleave",t.handlePointerLeave),g.addEventListener("pointermove",t.handlePointerMove,{passive:!1}),g.addEventListener("pointerdown",t.handlePointerDown,{passive:!1}),g.addEventListener("pointerup",t.handlePointerUp),g.addEventListener("pointercancel",t.handlePointerCancel),document.addEventListener("keypress",t.handleKeyPress),document.addEventListener("keydown",t.handleKeyDown),document.addEventListener("keyup",t.handleKeyUp),document.addEventListener("pointerlockchange",t.handlePointerLockChange),g.style.touchAction="none",g.style.userSelect="none",g.style.webkitTapHighlightColor="rgba(0,0,0,0)"};t.bindEvents=g=>{if(g===null)return;n.setContainer(g)&&d()};const h=()=>{clearTimeout(e.moveTimeoutID),clearTimeout(e.wheelTimeoutID),e.moveTimeoutID=0,e.wheelTimeoutID=0,a=1;const{container:g}=e;g&&(g.removeEventListener("contextmenu",J1),g.removeEventListener("wheel",t.handleWheel),g.removeEventListener("DOMMouseScroll",t.handleWheel),g.removeEventListener("pointerenter",t.handlePointerEnter),g.removeEventListener("pointerleave",t.handlePointerLeave),g.removeEventListener("pointermove",t.handlePointerMove,{passive:!1}),g.removeEventListener("pointerdown",t.handlePointerDown,{passive:!1}),g.removeEventListener("pointerup",t.handlePointerUp),g.removeEventListener("pointercancel",t.handlePointerCancel)),document.removeEventListener("keypress",t.handleKeyPress),document.removeEventListener("keydown",t.handleKeyDown),document.removeEventListener("keyup",t.handleKeyUp),document.removeEventListener("pointerlockchange",t.handlePointerLockChange),i.clear()};t.unbindEvents=()=>{h(),n.setContainer(null)},t.handleKeyPress=g=>{const m=f(g);t.keyPressEvent(m)},t.handleKeyDown=g=>{const m=f(g);t.keyDownEvent(m)},t.handleKeyUp=g=>{const m=f(g);t.keyUpEvent(m)},t.handlePointerEnter=g=>{const m={...c(g),position:l(g),deviceType:u(g)};t.pointerEnterEvent(m),m.deviceType==="mouse"&&t.mouseEnterEvent(m)},t.handlePointerLeave=g=>{const m={...c(g),position:l(g),deviceType:u(g)};t.pointerLeaveEvent(m),m.deviceType==="mouse"&&t.mouseLeaveEvent(m)},t.handlePointerDown=g=>{if(!(g.button>2||t.isPointerLocked()))switch(e.preventDefaultOnPointerDown&&J1(g),g.target.hasPointerCapture(g.pointerId)&&g.target.releasePointerCapture(g.pointerId),e.container.setPointerCapture(g.pointerId),i.has(g.pointerId)&&ux("[RenderWindowInteractor] duplicate pointerId detected"),i.set(g.pointerId,{pointerId:g.pointerId,position:l(g)}),g.pointerType){case"pen":case"touch":t.handleTouchStart(g);break;case"mouse":default:t.handleMouseDown(g);break}},t.handlePointerUp=g=>{if(i.has(g.pointerId))switch(e.preventDefaultOnPointerUp&&J1(g),i.delete(g.pointerId),e.container.releasePointerCapture(g.pointerId),g.pointerType){case"pen":case"touch":t.handleTouchEnd(g);break;case"mouse":default:t.handleMouseUp(g);break}},t.handlePointerCancel=g=>{if(i.has(g.pointerId))switch(i.delete(g.pointerId),g.pointerType){case"pen":case"touch":t.handleTouchEnd(g);break;case"mouse":default:t.handleMouseUp(g);break}},t.handlePointerMove=g=>{if(i.has(g.pointerId)){const m=i.get(g.pointerId);m.position=l(g)}switch(g.pointerType){case"pen":case"touch":t.handleTouchMove(g);break;case"mouse":default:t.handleMouseMove(g);break}},t.handleMouseDown=g=>{const m={...c(g),position:l(g),deviceType:u(g)};switch(g.button){case 0:t.leftButtonPressEvent(m);break;case 1:t.middleButtonPressEvent(m);break;case 2:t.rightButtonPressEvent(m);break;default:fx(`Unknown mouse button pressed: ${g.button}`);break}},t.requestPointerLock=()=>{e.container&&e.container.requestPointerLock()},t.exitPointerLock=()=>document.exitPointerLock?.(),t.isPointerLocked=()=>!!e.container&&document.pointerLockElement===e.container,t.handlePointerLockChange=()=>{t.isPointerLocked()?t.startPointerLockEvent():t.endPointerLockEvent()};function p(){e._view&&e.enabled&&e.enableRender&&(e.inRender=!0,e._view.traverseAllPasses(),e.inRender=!1),t.invokeRenderEvent()}t.requestAnimation=g=>{if(g===void 0){fx("undefined requester, can not start animating");return}if(r.has(g)){ux("requester is already registered for animating");return}r.add(g),!e.animationRequest&&r.size===1&&!e.xrAnimation&&(e._animationStartTime=Date.now(),e._animationFrameCount=0,e.animationRequest=requestAnimationFrame(t.handleAnimation),t.startAnimationEvent())},t.extendAnimation=g=>{const m=Date.now()+g;e._animationExtendedEnd=Math.max(e._animationExtendedEnd,m),!e.animationRequest&&r.size===0&&!e.xrAnimation&&(e._animationStartTime=Date.now(),e._animationFrameCount=0,e.animationRequest=requestAnimationFrame(t.handleAnimation),t.startAnimationEvent())},t.isAnimating=()=>e.xrAnimation||e.animationRequest!==null,t.cancelAnimation=function(g){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!r.has(g)){if(!m){const y=g&&g.getClassName?g.getClassName():g;ux(`${y} did not request an animation`)}return}r.delete(g),e.animationRequest&&r.size===0&&Date.now()>e._animationExtendedEnd&&(cancelAnimationFrame(e.animationRequest),e.animationRequest=null,t.endAnimationEvent(),t.render())},t.switchToXRAnimation=()=>{e.animationRequest&&(cancelAnimationFrame(e.animationRequest),e.animationRequest=null),e.xrAnimation=!0},t.returnFromXRAnimation=()=>{e.xrAnimation=!1,r.size!==0&&(e.recentAnimationFrameRate=10,e.animationRequest=requestAnimationFrame(t.handleAnimation))},t.updateXRGamepads=(g,m,y)=>{g.inputSources.forEach(v=>{const x=v.gripSpace==null?null:m.getPose(v.gripSpace,y),w=v.gripSpace==null?null:m.getPose(v.targetRaySpace,y),S=v.gamepad,T=v.handedness;if(S){S.index in e.lastGamepadValues||(e.lastGamepadValues[S.index]={left:{buttons:{}},right:{buttons:{}},none:{buttons:{}}});for(let _=0;_<S.buttons.length;++_)_ in e.lastGamepadValues[S.index][T].buttons||(e.lastGamepadValues[S.index][T].buttons[_]=!1),e.lastGamepadValues[S.index][T].buttons[_]!==S.buttons[_].pressed&&x!=null&&(t.button3DEvent({gamepad:S,position:x.transform.position,orientation:x.transform.orientation,targetPosition:w.transform.position,targetOrientation:w.transform.orientation,pressed:S.buttons[_].pressed,device:v.handedness==="left"?cx.LeftController:cx.RightController,input:ZT[S.mapping]&&ZT[S.mapping][_]?ZT[S.mapping][_]:ih.Trigger}),e.lastGamepadValues[S.index][T].buttons[_]=S.buttons[_].pressed),e.lastGamepadValues[S.index][T].buttons[_]&&x!=null&&t.move3DEvent({gamepad:S,position:x.transform.position,orientation:x.transform.orientation,targetPosition:w.transform.position,targetOrientation:w.transform.orientation,device:v.handedness==="left"?cx.LeftController:cx.RightController})}})},t.handleMouseMove=g=>{const m={...c(g),position:l(g),deviceType:u(g)};e.moveTimeoutID===0?t.startMouseMoveEvent(m):(t.mouseMoveEvent(m),clearTimeout(e.moveTimeoutID)),e.moveTimeoutID=setTimeout(()=>{t.endMouseMoveEvent(),e.moveTimeoutID=0},200)},t.handleAnimation=()=>{const g=Date.now();e._animationFrameCount++,g-e._animationStartTime>1e3&&e._animationFrameCount>1&&(e.recentAnimationFrameRate=1e3*(e._animationFrameCount-1)/(g-e._animationStartTime),e.lastFrameTime=1/e.recentAnimationFrameRate,t.animationFrameRateUpdateEvent(),e._animationStartTime=g,e._animationFrameCount=1),t.animationEvent(),p(),r.size>0||Date.now()<e._animationExtendedEnd?e.animationRequest=requestAnimationFrame(t.handleAnimation):(cancelAnimationFrame(e.animationRequest),e.animationRequest=null,t.endAnimationEvent(),t.render())},t.handleWheel=g=>{J1(g);const m={...$8e(g),...c(g),position:l(g),deviceType:u(g)};e.wheelTimeoutID===0&&(Math.abs(m.spinY)>=.3?a=Math.abs(m.spinY):a=1),m.spinY/=a,e.wheelTimeoutID===0?(t.startMouseWheelEvent(m),t.mouseWheelEvent(m)):(t.mouseWheelEvent(m),clearTimeout(e.wheelTimeoutID)),e.mouseScrollDebounceByPass?(t.extendAnimation(600),t.endMouseWheelEvent(),e.wheelTimeoutID=0):e.wheelTimeoutID=setTimeout(()=>{t.extendAnimation(600),t.endMouseWheelEvent(),e.wheelTimeoutID=0},200)},t.handleMouseUp=g=>{const m={...c(g),position:l(g),deviceType:u(g)};switch(g.button){case 0:t.leftButtonReleaseEvent(m);break;case 1:t.middleButtonReleaseEvent(m);break;case 2:t.rightButtonReleaseEvent(m);break;default:fx(`Unknown mouse button released: ${g.button}`);break}},t.handleTouchStart=g=>{const m=[...i.values()];if(e.recognizeGestures&&m.length>1){const y=dx(i);if(m.length===2){const v={...c(Qp),position:m[0].position,deviceType:u(g)};t.leftButtonReleaseEvent(v)}t.recognizeGesture("TouchStart",y)}else if(m.length===1){const y={...c(Qp),position:l(g),deviceType:u(g)};t.leftButtonPressEvent(y)}},t.handleTouchMove=g=>{const m=[...i.values()];if(e.recognizeGestures&&m.length>1){const y=dx(i);t.recognizeGesture("TouchMove",y)}else if(m.length===1){const y={...c(Qp),position:m[0].position,deviceType:u(g)};t.mouseMoveEvent(y)}},t.handleTouchEnd=g=>{const m=[...i.values()];if(e.recognizeGestures)if(m.length===0){const y={...c(Qp),position:l(g),deviceType:u(g)};t.leftButtonReleaseEvent(y)}else if(m.length===1){const y=dx(i);t.recognizeGesture("TouchEnd",y);const v={...c(Qp),position:m[0].position,deviceType:u(g)};t.leftButtonPressEvent(v)}else{const y=dx(i);t.recognizeGesture("TouchMove",y)}else if(m.length===1){const y={...c(Qp),position:m[0].position,deviceType:u(g)};t.leftButtonReleaseEvent(y)}},t.setView=g=>{e._view!==g&&(e._view=g,e._view.getRenderable().setInteractor(t),t.modified())},t.getFirstRenderer=()=>e._view?.getRenderable()?.getRenderersByReference()?.[0],t.findPokedRenderer=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(!e._view)return null;const y=e._view?.getRenderable()?.getRenderers();if(!y||y.length===0)return null;y.sort((T,_)=>T.getLayer()-_.getLayer());let v=null,x=null,w=null,S=y.length;for(;S--;){const T=y[S];if(e._view.isInViewport(g,m,T)&&T.getInteractive()){w=T;break}v===null&&T.getInteractive()&&(v=T),x===null&&e._view.isInViewport(g,m,T)&&(x=T)}return w===null&&(w=v),w===null&&(w=x),w==null&&(w=y[0]),w},t.render=()=>{!t.isAnimating()&&!e.inRender&&p()},DD.forEach(g=>{const m=g.charAt(0).toLowerCase()+g.slice(1);t[`${m}Event`]=y=>{if(!e.enabled)return;if(!t.getCurrentRenderer()){G8e(`
          Can not forward events without a current renderer on the interactor.
        `);return}const x={type:g,pokedRenderer:e.currentRenderer,firstRenderer:t.getFirstRenderer(),...y};t[`invoke${g}`](x)}}),t.recognizeGesture=(g,m)=>{if(Object.keys(m).length>2)return;if(e.startingEventPositions||(e.startingEventPositions={}),g==="TouchStart"){Object.keys(m).forEach(R=>{e.startingEventPositions[R]=m[R]}),e.currentGesture="Start";return}if(g==="TouchEnd"){e.currentGesture==="Pinch"&&(t.render(),t.endPinchEvent()),e.currentGesture==="Rotate"&&(t.render(),t.endRotateEvent()),e.currentGesture==="Pan"&&(t.render(),t.endPanEvent()),e.currentGesture="Start",e.startingEventPositions={};return}let y=0;const v=[],x=[];Object.keys(m).forEach(R=>{v[y]=m[R],x[y]=e.startingEventPositions[R],y++});const w=Math.sqrt((x[0].x-x[1].x)*(x[0].x-x[1].x)+(x[0].y-x[1].y)*(x[0].y-x[1].y)),S=Math.sqrt((v[0].x-v[1].x)*(v[0].x-v[1].x)+(v[0].y-v[1].y)*(v[0].y-v[1].y));let T=i3(Math.atan2(x[1].y-x[0].y,x[1].x-x[0].x)),_=i3(Math.atan2(v[1].y-v[0].y,v[1].x-v[0].x)),D=_-T;_=_+180>=360?_-180:_+180,T=T+180>=360?T-180:T+180,Math.abs(_-T)<Math.abs(D)&&(D=_-T);const I=[];if(I[0]=(v[0].x-x[0].x+v[1].x-x[1].x)/2,I[1]=(v[0].y-x[0].y+v[1].y-x[1].y)/2,g==="TouchMove")if(e.currentGesture==="Start"){let R=.01*Math.sqrt(e.container.clientWidth*e.container.clientWidth+e.container.clientHeight*e.container.clientHeight);R<15&&(R=15);const M=Math.abs(S-w),A=S*3.1415926*Math.abs(D)/360,L=Math.sqrt(I[0]*I[0]+I[1]*I[1]);if(M>R&&M>A&&M>L){e.currentGesture="Pinch";const P={scale:1,touches:m};t.startPinchEvent(P)}else if(A>R&&A>L){e.currentGesture="Rotate";const P={rotation:0,touches:m};t.startRotateEvent(P)}else if(L>R){e.currentGesture="Pan";const P={translation:[0,0],touches:m};t.startPanEvent(P)}}else{if(e.currentGesture==="Rotate"){const R={rotation:D,touches:m};t.rotateEvent(R)}if(e.currentGesture==="Pinch"){const R={scale:S/w,touches:m};t.pinchEvent(R)}if(e.currentGesture==="Pan"){const R={translation:I,touches:m};t.panEvent(R)}}},t.handleVisibilityChange=()=>{e._animationStartTime=Date.now(),e._animationFrameCount=0},t.setCurrentRenderer=g=>{e._forcedRenderer=!!g,e.currentRenderer=g},t.setContainer=g=>{h();const m=n.setContainer(g??null);return m&&d(),m},t.delete=()=>{for(;r.size;)t.cancelAnimation(r.values().next().value);typeof document.hidden<"u"&&document.removeEventListener("visibilitychange",t.handleVisibilityChange),e.container&&t.setContainer(null),n.delete()},typeof document.hidden<"u"&&document.addEventListener("visibilitychange",t.handleVisibilityChange,!1)}const z8e={renderWindow:null,interactorStyle:null,picker:null,pickingManager:null,initialized:!1,enabled:!1,enableRender:!0,currentRenderer:null,lightFollowCamera:!0,desiredUpdateRate:30,stillUpdateRate:2,container:null,recognizeGestures:!0,currentGesture:"Start",animationRequest:null,lastFrameTime:.1,recentAnimationFrameRate:10,wheelTimeoutID:0,moveTimeoutID:0,lastGamepadValues:{},preventDefaultOnPointerDown:!1,preventDefaultOnPointerUp:!1,mouseScrollDebounceByPass:!1};function pY(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,z8e,n),le.obj(t,e),e._animationExtendedEnd=0,le.event(t,e,"RenderEvent"),DD.forEach(r=>le.event(t,e,r)),le.get(t,e,["initialized","interactorStyle","lastFrameTime","recentAnimationFrameRate","_view"]),le.setGet(t,e,["container","lightFollowCamera","enabled","enableRender","recognizeGestures","desiredUpdateRate","stillUpdateRate","picker","preventDefaultOnPointerDown","preventDefaultOnPointerUp","mouseScrollDebounceByPass"]),le.moveToProtected(t,e,["view"]),j8e(t,e)}const W8e=le.newInstance(pY,"vtkRenderWindowInteractor");var H8e={newInstance:W8e,extend:pY,handledEvents:DD,...hY};const{vtkDebugMacro:K8e}=le;function q8e(t,e){e.classHierarchy.push("vtkActor");const n={...t};t.getActors=()=>[t],t.getIsOpaque=()=>{if(e.forceOpaque)return!0;if(e.forceTranslucent)return!1;e.property||t.getProperty();let r=e.property.getOpacity()>=1;return r=r&&(!e.texture||!e.texture.isTranslucent()),r=r&&(!e.mapper||e.mapper.getIsOpaque()),r},t.hasTranslucentPolygonalGeometry=()=>e.mapper===null?!1:(e.property===null&&t.setProperty(t.makeProperty()),!t.getIsOpaque()),t.makeProperty=up.newInstance,t.getProperty=()=>(e.property===null&&(e.property=t.makeProperty()),e.property),t.getBounds=()=>{if(e.mapper===null)return e.bounds;const r=e.mapper.getBounds();if(!r||r.length!==6)return r;if(r[0]>r[1])return e.mapperBounds=r.concat(),e.bounds=[1,-1,1,-1,1,-1],e.boundsMTime.modified(),r;if(!e.mapperBounds||r[0]!==e.mapperBounds[0]||r[1]!==e.mapperBounds[1]||r[2]!==e.mapperBounds[2]||r[3]!==e.mapperBounds[3]||r[4]!==e.mapperBounds[4]||r[5]!==e.mapperBounds[5]||t.getMTime()>e.boundsMTime.getMTime()){K8e("Recomputing bounds..."),e.mapperBounds=r.concat();const i=[];wr.getCorners(r,i),t.computeMatrix();const a=new Float64Array(16);Gn(a,e.matrix),i.forEach(o=>$n(o,o,a)),e.bounds[0]=e.bounds[2]=e.bounds[4]=Number.MAX_VALUE,e.bounds[1]=e.bounds[3]=e.bounds[5]=-Number.MAX_VALUE,e.bounds=e.bounds.map((o,s)=>s%2===0?i.reduce((l,c)=>l>c[s/2]?c[s/2]:l,o):i.reduce((l,c)=>l<c[(s-1)/2]?c[(s-1)/2]:l,o)),e.boundsMTime.modified()}return e.bounds},t.getMTime=()=>{let r=n.getMTime();if(e.property!==null){const i=e.property.getMTime();r=i>r?i:r}if(e.backfaceProperty!==null){const i=e.backfaceProperty.getMTime();r=i>r?i:r}return r},t.getRedrawMTime=()=>{let r=e.mtime;if(e.mapper!==null){let i=e.mapper.getMTime();r=i>r?i:r,e.mapper.getInput()!==null&&(e.mapper.getInputAlgorithm().update(),i=e.mapper.getInput().getMTime(),r=i>r?i:r)}return r},t.getSupportsSelection=()=>e.mapper?e.mapper.getSupportsSelection():!1,t.processSelectorPixelBuffers=(r,i)=>{e.mapper&&e.mapper.processSelectorPixelBuffers&&e.mapper.processSelectorPixelBuffers(r,i)}}const X8e={mapper:null,property:null,backfaceProperty:null,forceOpaque:!1,forceTranslucent:!1,bounds:[1,-1,1,-1,1,-1]};function gY(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,X8e,n),fD.extend(t,e,n),e.boundsMTime={},le.obj(e.boundsMTime),le.set(t,e,["property"]),le.setGet(t,e,["backfaceProperty","forceOpaque","forceTranslucent","mapper"]),q8e(t,e)}const Y8e=le.newInstance(gY,"vtkActor");var m0={newInstance:Y8e,extend:gY};function J8e(t,e){const n=t.invokeResize;delete t.invokeResize,e.renderWindow=tSe.newInstance(),e.rendererMap={},e.openGLRenderWindow=x8e.newInstance(),e.renderWindow.addView(e.openGLRenderWindow),e.interactor=H8e.newInstance(),e.interactor.setView(e.openGLRenderWindow),e.interactor.initialize(),t.addRenderer=({viewport:r,id:i,background:a})=>{const o=V8e.newInstance({viewport:r,background:a||e.background});e.renderWindow.addRenderer(o),e.rendererMap[i]=o},t.destroy=()=>{e.renderWindow.getInteractor().delete()},t.removeRenderer=r=>{const i=t.getRenderer(r);e.renderWindow.removeRenderer(i),i.delete(),delete e.rendererMap[r]},t.getRenderer=r=>e.rendererMap[r],t.getRenderers=()=>{const{rendererMap:r}=e;return Object.keys(r).map(a=>({id:a,renderer:r[a]}))},t.resize=()=>{if(e.container){const{width:r,height:i}=e.container;e.openGLRenderWindow.setSize(Math.floor(r),Math.floor(i)),n(),e.renderWindow.render()}},t.setContainer=r=>{e.container=r,e.openGLRenderWindow.setContainer(e.container)},t.delete=le.chain(t.setContainer,t.destroy,e.openGLRenderWindow.delete,t.delete),t.resize()}const Z8e={background:[0,0,0],container:null};function mY(t,e,n={}){Object.assign(e,Z8e,n),le.obj(t,e),le.get(t,e,["renderWindow","openGLRenderWindow","interactor","container"]),le.event(t,e,"resize"),J8e(t,e)}const Q8e=le.newInstance(mY),vY={newInstance:Q8e,extend:mY},{BlendMode:Td,FilterMode:Cv}=PW;function eEe(t,e,n,r,i){let a=null;return i?(a=i,a.removeAllPoints()):a=Xh.newInstance(),a.addPointLong(-1024,0,1,1),a.addPoint(t,e),a.addPoint(n,r),a}const tEe={createRadonTransferFunction:eEe};function nEe(t,e){e.classHierarchy.push("vtkVolumeMapper");const n={...t};t.getBounds=()=>{const r=t.getInputData();return r?(e.static||t.update(),e.bounds=r.getBounds()):e.bounds=d0(),e.bounds},t.update=()=>{t.getInputData()},t.setBlendModeToComposite=()=>{t.setBlendMode(Td.COMPOSITE_BLEND)},t.setBlendModeToMaximumIntensity=()=>{t.setBlendMode(Td.MAXIMUM_INTENSITY_BLEND)},t.setBlendModeToMinimumIntensity=()=>{t.setBlendMode(Td.MINIMUM_INTENSITY_BLEND)},t.setBlendModeToAverageIntensity=()=>{t.setBlendMode(Td.AVERAGE_INTENSITY_BLEND)},t.setBlendModeToAdditiveIntensity=()=>{t.setBlendMode(Td.ADDITIVE_INTENSITY_BLEND)},t.setBlendModeToRadonTransform=()=>{t.setBlendMode(Td.RADON_TRANSFORM_BLEND)},t.getBlendModeAsString=()=>le.enumToString(Td,e.blendMode),t.setAverageIPScalarRange=(r,i)=>{console.warn("setAverageIPScalarRange is deprecated use setIpScalarRange"),t.setIpScalarRange(r,i)},t.getFilterModeAsString=()=>le.enumToString(Cv,e.filterMode),t.setFilterModeToOff=()=>{t.setFilterMode(Cv.OFF)},t.setFilterModeToNormalized=()=>{t.setFilterMode(Cv.NORMALIZED)},t.setFilterModeToRaw=()=>{t.setFilterMode(Cv.RAW)},t.setGlobalIlluminationReach=r=>n.setGlobalIlluminationReach(pc(r,0,1)),t.setVolumetricScatteringBlending=r=>n.setVolumetricScatteringBlending(pc(r,0,1)),t.setVolumeShadowSamplingDistFactor=r=>n.setVolumeShadowSamplingDistFactor(r>=1?r:1),t.setAnisotropy=r=>n.setAnisotropy(pc(r,-.99,.99)),t.setLAOKernelSize=r=>n.setLAOKernelSize(P9(pc(r,1,32))),t.setLAOKernelRadius=r=>n.setLAOKernelRadius(r>=1?r:1)}const rEe=t=>({bounds:[1,-1,1,-1,1,-1],sampleDistance:1,imageSampleDistance:1,maximumSamplesPerRay:1e3,autoAdjustSampleDistances:!0,initialInteractionScale:1,interactionSampleDistanceFactor:1,blendMode:Td.COMPOSITE_BLEND,ipScalarRange:[-1e6,1e6],filterMode:Cv.OFF,preferSizeOverAccuracy:!1,computeNormalFromOpacity:!1,volumetricScatteringBlending:0,globalIlluminationReach:0,volumeShadowSamplingDistFactor:5,anisotropy:0,localAmbientOcclusion:!1,LAOKernelSize:15,LAOKernelRadius:7,updatedExtents:[],...t});function yY(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,rEe(n)),SD.extend(t,e,n),le.setGet(t,e,["sampleDistance","imageSampleDistance","maximumSamplesPerRay","autoAdjustSampleDistances","initialInteractionScale","interactionSampleDistanceFactor","blendMode","filterMode","preferSizeOverAccuracy","computeNormalFromOpacity","volumetricScatteringBlending","globalIlluminationReach","volumeShadowSamplingDistFactor","anisotropy","localAmbientOcclusion","LAOKernelSize","LAOKernelRadius","updatedExtents"]),le.setGetArray(t,e,["ipScalarRange"],2),le.event(t,e,"lightingActivated"),nEe(t,e)}const iEe=le.newInstance(yY,"vtkVolumeMapper");var xY={newInstance:iEe,extend:yY,...tEe};function aEe(t,e){e.classHierarchy.push("vtkSharedVolumeMapper");const n=t.delete;t.delete=()=>{e.scalarTexture=null,n()}}const oEe={scalarTexture:null};function bY(t,e,n={}){Object.assign(e,oEe,n),xY.extend(t,e,n),le.setGet(t,e,["scalarTexture"]),aEe(t,e)}const sEe=le.newInstance(bY,"vtkSharedVolumeMapper"),lEe={newInstance:sEe,extend:bY};function ik(t,e){const n=TD(e),r=new n(t.length);return r.set(t),r}function cEe(t,e){e.classHierarchy.push("vtkStreamingOpenGLTexture"),e.updatedFrames=[],e.volumeId=null;const n=t.create3DFilterableFromRaw;t.create3DFilterableFromRaw=(s,l,c,f,u,d,h)=>{e.inputDataType=u,e.inputNumComps=f,n(s,l,c,f,u,d,h)};const r=t.updateVolumeInfoForGL;t.updateVolumeInfoForGL=(s,l)=>{const c=r(s,l);return e.volumeInfo.dataComputedScale=[1],e.volumeInfo.dataComputedOffset=[0],c},t.update3DFromRaw=()=>{const{volumeId:s}=e;if(!s)return;const l=yt.getVolume(s);if(e._openGLRenderWindow.activateTexture(t),t.createTexture(),t.bind(),l.isDynamicVolume()){o();return}return t.hasUpdatedFrames()&&a()};const i=t.modified;t.setUpdatedFrame=s=>{e.updatedFrames[s]=!0,i()},t.modified=()=>{i();const s=yt.getVolume(e.volumeId);if(!s)return;const l=s.imageIds;for(let c=0;c<l.length;c++)e.updatedFrames[c]=!0};function a(){const s=yt.getVolume(e.volumeId),l=s.imageIds;for(let c=0;c<e.updatedFrames.length;c++)if(e.updatedFrames[c]){const f=yt.getImage(l[c]);if(!f)continue;let u=f.voxelManager.getScalarData();const d=e.context;s.dataType!==u.constructor.name&&(u=ik(u,s.dataType));const[h]=t.updateArrayDataTypeForGL(s.dataType,[u]);t.bind();const p=c;d.texSubImage3D(e.target,0,0,0,p,e.width,e.height,1,e.format,e.openGLDataType,h),t.deactivate(),e.updatedFrames[c]=null}return e.generateMipmap&&e.context.generateMipmap(e.target),t.deactivate(),!0}function o(){const s=yt.getVolume(e.volumeId),l=s.getCurrentDimensionGroupImageIds();if(!l.length)return!1;let c;for(let f=0;f<l.length;f++){const u=l[f],d=yt.getImage(u);let h;d?(h=d.voxelManager.getScalarData(),c=h.constructor):(c=TD(s.dataType,!0),h=new c(e.width*e.height));const p=e.context;s.dataType!==h.constructor.name&&(h=ik(h,s.dataType));const[g]=t.updateArrayDataTypeForGL(s.dataType,[h]);t.bind();let m=f;p.texSubImage3D(e.target,0,0,0,m,e.width,e.height,1,e.format,e.openGLDataType,g),t.deactivate()}return e.generateMipmap&&e.context.generateMipmap(e.target),t.deactivate(),!0}t.hasUpdatedFrames=()=>!e.updatedFrames.length||e.updatedFrames.some(s=>s),t.getUpdatedFrames=()=>e.updatedFrames,t.setVolumeId=s=>{e.volumeId=s},t.getVolumeId=()=>e.volumeId,t.setTextureParameters=({width:s,height:l,depth:c,numberOfComponents:f,dataType:u})=>{e.width??=s,e.height??=l,e.depth??=c,e.inputNumComps??=f,e.inputDataType??=u},t.getTextureParameters=()=>({width:e.width,height:e.height,depth:e.depth,numberOfComponents:e.inputNumComps,dataType:e.inputDataType})}const uEe={updatedFrames:[]};function wY(t,e,n={}){Object.assign(e,uEe,n),ti.extend(t,e,n),cEe(t,e)}const fEe=le.newInstance(wY,"vtkStreamingOpenGLTexture"),dEe={newInstance:fEe,extend:wY},hEe={isPerformingCoordinateTransformation:!1};function CY(t,e,n={}){Object.assign(e,hEe,n),_D.extend(t,e,n),le.setGet(t,e,["isPerformingCoordinateTransformation"]),gEe(t,e)}const pEe=le.newInstance(CY,"vtkSlabCamera");function gEe(t,e){e.classHierarchy.push("vtkSlabCamera");const n=lL(new Float64Array(16)),r=new Float64Array(3);t.getProjectionMatrix=(i,a,o)=>{const s=h0();if(e.projectionMatrix){const d=1/e.physicalScale;return c3(r,d,d,d),sL(s,e.projectionMatrix),tK(s,s,r),cL(s,s),s}lL(n);let l=e.clippingRange[0],c=e.clippingRange[1];e.isPerformingCoordinateTransformation&&(l=e.distance,c=e.distance+.1);const f=c-l,u=[l+(a+1)*f/2,l+(o+1)*f/2];if(e.parallelProjection){const d=e.parallelScale*i,h=e.parallelScale,p=(e.windowCenter[0]-1)*d,g=(e.windowCenter[0]+1)*d,m=(e.windowCenter[1]-1)*h,y=(e.windowCenter[1]+1)*h;rye(n,p,g,m,y,u[0],u[1]),cL(n,n)}else{if(e.useOffAxisProjection)throw new Error("Off-Axis projection is not supported at this time");{const d=Math.tan(Hs.radiansFromDegrees(e.viewAngle)/2);let h,p;e.useHorizontalViewAngle===!0?(h=l*d,p=l*d/i):(h=l*d*i,p=l*d);const g=(e.windowCenter[0]-1)*h,m=(e.windowCenter[0]+1)*h,y=(e.windowCenter[1]-1)*p,v=(e.windowCenter[1]+1)*p,x=u[0],w=u[1];n[0]=2*x/(m-g),n[5]=2*x/(v-y),n[2]=(g+m)/(m-g),n[6]=(y+v)/(v-y),n[10]=-(x+w)/(w-x),n[14]=-1,n[11]=-2*x*w/(w-x),n[15]=0}}return sL(s,n),s}}const mEe={newInstance:pEe,extend:CY};class Vm{constructor(e){this._imageIdsIndexMap=new Map,this._imageURIsIndexMap=new Map,this.cornerstoneImageMetaData=null,this.isPreScaled=!1,this.numTimePoints=null,this.numFrames=null;const{imageIds:n,scaling:r,dimensions:i,spacing:a,origin:o,direction:s,dataType:l,volumeId:c,referencedVolumeId:f,metadata:u,referencedImageIds:d,additionalDetails:h,voxelManager:p,numberOfComponents:g}=e;if(!l)throw new Error('Data type is required, please provide a data type as string such as "Uint8Array", "Float32Array", etc.');let{imageData:m}=e;this.suppressWarnings=!0,this.imageIds=n,this.volumeId=c,this.metadata=u,this.dimensions=i,this.spacing=a,this.origin=o,this.direction=s,this.dataType=l,this.vtkOpenGLTexture=dEe.newInstance(),this.vtkOpenGLTexture.setVolumeId(c),this.voxelManager=p??g0.createImageVolumeVoxelManager({dimensions:i,imageIds:n,numberOfComponents:g}),this.numVoxels=this.dimensions[0]*this.dimensions[1]*this.dimensions[2],m||(m=Zw.newInstance(),m.setDimensions(i),m.setSpacing(a),m.setDirection(s),m.setOrigin(o)),m.set({dataType:l,voxelManager:this.voxelManager,id:c,numberOfComponents:g||1},this.suppressWarnings),m.set({hasScalarVolume:!1},this.suppressWarnings),this.imageData=m,this.numFrames=this._getNumFrames(),this._reprocessImageIds(),r&&(this.scaling=r),f&&(this.referencedVolumeId=f),d&&(this.referencedImageIds=d),h&&(this.additionalDetails=h)}get sizeInBytes(){return this.voxelManager.sizeInBytes}get imageIds(){return this._imageIds}set imageIds(e){this._imageIds=e,this._reprocessImageIds()}_reprocessImageIds(){this._imageIdsIndexMap.clear(),this._imageURIsIndexMap.clear(),this._imageIds.forEach((e,n)=>{const r=mi(e);this._imageIdsIndexMap.set(e,n),this._imageURIsIndexMap.set(r,n)})}isDynamicVolume(){return this.numTimePoints>1}getImageIdIndex(e){return this._imageIdsIndexMap.get(e)}getImageIdByIndex(e){return this._imageIds[e]}getImageURIIndex(e){return this._imageURIsIndexMap.get(e)}load(e){}destroy(){this.imageData.delete(),this.imageData=null,this.voxelManager.clear(),this.vtkOpenGLTexture.releaseGraphicsResources(),this.vtkOpenGLTexture.delete()}invalidate(){for(let e=0;e<this.imageIds.length;e++)this.vtkOpenGLTexture.setUpdatedFrame(e);this.imageData.modified()}modified(){this.imageData.modified(),this.vtkOpenGLTexture.modified(),this.numFrames=this._getNumFrames()}removeFromCache(){yt.removeVolumeLoadObject(this.volumeId)}getScalarDataLength(){return this.voxelManager.getScalarDataLength()}_getNumFrames(){return this.isDynamicVolume()?this.numTimePoints:this.imageIds.length}imageIdIndexToFrameIndex(e){return e%this.numFrames}getCornerstoneImages(){const{imageIds:e}=this;return e.map(n=>yt.getImage(n))}}const lu=[];function Fm(t,e=0){let n;for(n=0;n<lu.length&&!(lu[n].priority<=e);n++);lu.splice(n,0,{priority:e,provider:t})}function vEe(t){for(let e=0;e<lu.length;e++)if(lu[e].provider===t){lu.splice(e,1);break}}function yEe(){for(;lu.length>0;)lu.pop()}function Ft(t,...e){for(let n=0;n<lu.length;n++){const r=lu[n].provider(t,...e);if(r!==void 0)return r}}const OD=Object.freeze(Object.defineProperty({__proto__:null,addProvider:Fm,get:Ft,removeAllProviders:yEe,removeProvider:vEe},Symbol.toStringTag,{value:"Module"}));let Z1={};const Zd={add:(t,e)=>{Zd.addRaw(t,{...e,metadata:structuredClone(e.metadata)})},addRaw:(t,e)=>{const n=e.type;Z1[t]||(Z1[t]={}),Z1[t][n]=e.metadata},get:(t,e)=>Z1[e]?.[t],clear:()=>{Z1={}}};Fm(Zd.get);const Qo=new b9("imageLoadPool");Qo.grabDelay=0;Qo.setMaxSimultaneousRequests(Dn.Interaction,1e3);Qo.setMaxSimultaneousRequests(Dn.Thumbnail,1e3);Qo.setMaxSimultaneousRequests(Dn.Prefetch,1e3);const S3={};let T3;function SY(t,e){const n=yt.getImageLoadObject(t);if(n)return ak(n.promise,t),n;const r=t.split(":")[0],i=S3[r]||T3;if(!i)throw new Error(`loadImageFromImageLoader: No image loader found for scheme '${r}'`);const a=i(t,e);return ak(a.promise,t),a}function ak(t,e){Promise.resolve(t).then(n=>{xEe(n),Ct(St,vt.IMAGE_LOADED,{image:n})}).catch(n=>{const r={imageId:e,error:n};Ct(St,vt.IMAGE_LOAD_FAILED,r)})}function xEe(t){if(!t.voxelManager){const{width:e,height:n,numberOfComponents:r}=t,i=g0.createImageVoxelManager({scalarData:t.getPixelData(),width:e,height:n,numberOfComponents:r});t.voxelManager=i,t.getPixelData=()=>i.getScalarData(),delete t.imageFrame.pixelData}}function TY(t,e={priority:0,requestType:"prefetch"}){if(t===void 0)throw new Error("loadImage: parameter imageId must not be undefined");return SY(t,e).promise}function v0(t,e={priority:0,requestType:"prefetch"}){if(t===void 0)throw new Error("loadAndCacheImage: parameter imageId must not be undefined");const n=SY(t,e);return yt.getImageLoadObject(t)||yt.putImageLoadObject(t,n),n.promise}function bEe(t,e={priority:0,requestType:"prefetch"}){if(!t||t.length===0)throw new Error("loadAndCacheImages: parameter imageIds must be list of image Ids");return t.map(r=>v0(r,e))}function MD(t,e={}){if(t===void 0)throw new Error("createAndCacheDerivedImage: parameter imageId must not be undefined");e.imageId===void 0&&(e.imageId=`derived:${or()}`);const{imageId:n,skipCreateBuffer:r,onCacheAdd:i,voxelRepresentation:a}=e,o=Ft("imagePlaneModule",t),s=o.rows*o.columns,{TypedArrayConstructor:l}=ED(e.targetBuffer?.type,s),c=new l(r?1:s),f=n,u=Ft("imagePlaneModule",t);Zd.add(f,{type:"imagePlaneModule",metadata:u});const d=Ft("generalSeriesModule",t);Zd.add(f,{type:"generalSeriesModule",metadata:d}),Zd.add(f,{type:"generalImageModule",metadata:{instanceNumber:e.instanceNumber}});const h=Ft("imagePixelModule",t);Zd.add(f,{type:"imagePixelModule",metadata:{...h,bitsAllocated:8,bitsStored:8,highBit:7,samplesPerPixel:1,pixelRepresentation:0}});const p=RD(n,{scalarData:c,onCacheAdd:i,skipCreateBuffer:r,targetBuffer:{type:c.constructor.name},voxelRepresentation:a,dimensions:[o.columns,o.rows],spacing:[o.columnPixelSpacing,o.rowPixelSpacing],origin:o.imagePositionPatient,direction:o.imageOrientationPatient,frameOfReferenceUID:o.frameOfReferenceUID,referencedImageId:t});return p.referencedImageId=t,yt.getImageLoadObject(n)||yt.putImageSync(n,p),p}function ID(t,e={}){if(t.length===0)throw new Error("createAndCacheDerivedImages: parameter imageIds must be list of image Ids");return t.map((r,i)=>{const a={imageId:e?.getDerivedImageId?.(r)||`derived:${or()}`,...e};return MD(r,{...a,instanceNumber:i+1})})}function RD(t,e){const{scalarData:n,origin:r,direction:i,targetBuffer:a,skipCreateBuffer:o,onCacheAdd:s,frameOfReferenceUID:l,voxelRepresentation:c,referencedImageId:f}=e,u=e.dimensions,d=e.spacing;if(!u||!d)throw new Error("createAndCacheLocalImage: dimensions and spacing are required");const h=u[0],p=u[1],g=d[0],m=d[1],y={frameOfReferenceUID:l,rows:p,columns:h,imageOrientationPatient:i??[1,0,0,0,1,0],rowCosines:i?i.slice(0,3):[1,0,0],columnCosines:i?i.slice(3,6):[0,1,0],imagePositionPatient:r??[0,0,0],pixelSpacing:[m,g],rowPixelSpacing:m,columnPixelSpacing:g},v=h*p,x=n.length/v;let w;if(n){if(!(n instanceof Uint8Array||n instanceof Float32Array||n instanceof Uint16Array||n instanceof Int16Array))throw new Error("createAndCacheLocalImage: scalarData must be of type Uint8Array, Uint16Array, Int16Array or Float32Array");w=n}else if(!o){const{TypedArrayConstructor:B}=ED(a?.type,v);w=new B(v)}let S,T,_;if(w instanceof Uint8Array)S=8,T=8,_=7;else if(w instanceof Uint16Array)S=16,T=16,_=15;else if(w instanceof Int16Array)S=16,T=16,_=15;else if(w instanceof Float32Array)S=32,T=32,_=31;else throw new Error("Unsupported scalarData type");const D={samplesPerPixel:1,photometricInterpretation:w.length>u[0]*u[1]?"RGB":"MONOCHROME2",rows:p,columns:h,bitsAllocated:S,bitsStored:T,highBit:_},I={imagePlaneModule:y,imagePixelModule:D};["imagePlaneModule","imagePixelModule"].forEach(B=>{Zd.add(t,{type:B,metadata:I[B]||{}})});const R=t,M=c===Jb.RLE&&g0.createRLEImageVoxelManager({dimensions:u,id:R})||g0.createImageVoxelManager({height:p,width:h,numberOfComponents:x,scalarData:w,id:R});let A=w[0],L=w[0];for(let B=1;B<w.length;B++)w[B]<A&&(A=w[B]),w[B]>L&&(L=w[B]);const P={imageId:t,intercept:0,windowCenter:0,windowWidth:0,color:D.photometricInterpretation==="RGB",numberOfComponents:D.samplesPerPixel,dataType:a?.type,slope:1,minPixelValue:A,maxPixelValue:L,rows:D.rows,columns:D.columns,getCanvas:void 0,height:D.rows,width:D.columns,rgba:void 0,columnPixelSpacing:y.columnPixelSpacing,rowPixelSpacing:y.rowPixelSpacing,FrameOfReferenceUID:y.frameOfReferenceUID,invert:!1,getPixelData:()=>M.getScalarData(),voxelManager:M,sizeInBytes:n.byteLength,referencedImageId:f};return s?.(P),yt.putImageSync(P.imageId,P),P}function EY(t){const e=({additionalDetails:r})=>r.imageId?r.imageId!==t:!0;Qo.filterRequests(e);const n=yt.getImageLoadObject(t);n&&n.cancelFn()}function wEe(t){t.forEach(e=>{EY(e)})}function CEe(){const t=Qo.getRequestPool();Object.keys(t).forEach(e=>{const n=t[e];Object.keys(n).forEach(r=>{const i=n[r].pop();if(!i)return;const a=i.additionalDetails,{imageId:o,volumeId:s}=a;let l;o?l=yt.getImageLoadObject(o):s&&(l=yt.getVolumeLoadObject(s)),l&&l.cancel()}),Qo.clearRequestStack(e)})}function Hg(t,e){S3[t]=e}function SEe(t){const e=T3;return T3=t,e}function TEe(){Object.keys(S3).forEach(t=>delete S3[t]),T3=void 0}function EEe(t,e={}){return ID(t,{...e,targetBuffer:{type:"Uint8Array"}})}function _Ee(t,e={}){return MD(t,{...e,targetBuffer:{type:"Uint8Array"}})}const DEe=Object.freeze(Object.defineProperty({__proto__:null,cancelLoadAll:CEe,cancelLoadImage:EY,cancelLoadImages:wEe,createAndCacheDerivedImage:MD,createAndCacheDerivedImages:ID,createAndCacheDerivedLabelmapImage:_Ee,createAndCacheDerivedLabelmapImages:EEe,createAndCacheLocalImage:RD,loadAndCacheImage:v0,loadAndCacheImages:bEe,loadImage:TY,registerImageLoader:Hg,registerUnknownImageLoader:SEe,unregisterAllImageLoaders:TEe},Symbol.toStringTag,{value:"Module"}));function _Y(t){const e=t[0],{pixelRepresentation:n,bitsAllocated:r,bitsStored:i,highBit:a,photometricInterpretation:o,samplesPerPixel:s}=Ft("imagePixelModule",e),l=[],c=Ft("voiLutModule",e);let f;if(c){const{windowWidth:v,windowCenter:x}=c;if(f=c?.voiLUTFunction,Array.isArray(v))for(let w=0;w<v.length;w++)l.push({windowWidth:v[w],windowCenter:x[w]});else l.push({windowWidth:v,windowCenter:x})}else l.push({windowWidth:void 0,windowCenter:void 0});const{modality:u,seriesInstanceUID:d}=Ft("generalSeriesModule",e),{imageOrientationPatient:h,pixelSpacing:p,frameOfReferenceUID:g,columns:m,rows:y}=Ft("imagePlaneModule",e);return{BitsAllocated:r,BitsStored:i,SamplesPerPixel:s,HighBit:a,PhotometricInterpretation:o,PixelRepresentation:n,Modality:u,ImageOrientationPatient:h,PixelSpacing:p,FrameOfReferenceUID:g,Columns:m,Rows:y,voiLut:l,VOILUTFunction:f,SeriesInstanceUID:d}}function DY(t){const{imagePositionPatient:e,imageOrientationPatient:n}=Ft("imagePlaneModule",t[0]),r=En(n[0],n[1],n[2]),i=En(n[3],n[4],n[5]),a=ct();dr(a,r,i);const o=En(e[0],e[1],e[2]),s=t[0].split(":")[0]==="wadouri";let l;function c(h){const{imagePositionPatient:p}=Ft("imagePlaneModule",h),g=ct(),m=En(p[0],p[1],p[2]);return ur(g,o,m),zt(g,a)}if(s){const h=[t[0],t[Math.floor(t.length/2)]];c(h[0]),c(h[1]);const p=Ft("imagePlaneModule",h[1]);if(!p)throw new Error("Incomplete metadata required for volume construction.");const g=ct(),m=En(p.imagePositionPatient[0],p.imagePositionPatient[1],p.imagePositionPatient[2]);ur(g,o,m);const y=zt(g,a);l=Math.abs(y)/Math.floor(t.length/2)}else{const h=t.map(g=>({distance:c(g),imageId:g}));h.sort((g,m)=>m.distance-g.distance);const p=h.length;l=Math.abs(h[p-1].distance-h[0].distance)/(p-1)}const{sliceThickness:f,spacingBetweenSlices:u}=Ft("imagePlaneModule",t[0]),{strictZSpacingForVolumeViewport:d}=Pf().rendering;return(l===0||isNaN(l))&&!d&&(u?(console.debug("Could not calculate spacing. Using spacingBetweenSlices"),l=u):f?(console.debug("Could not calculate spacing and no spacingBetweenSlices. Using sliceThickness"),l=f):(console.debug("Could not calculate spacing. The VolumeViewport visualization is compromised. Setting spacing to 1 to render"),l=1)),l}function AD(t,e){const{imagePositionPatient:n,imageOrientationPatient:r}=Ft("imagePlaneModule",t[0]);if(!e){const f=En(r[0],r[1],r[2]),u=En(r[3],r[4],r[5]);e=ct(),dr(e,f,u)}const i=t[0].split(":")[0]==="wadouri",a=DY(t);let o;function s(f){const{imagePositionPatient:u}=Ft("imagePlaneModule",f),d=ct();return ur(d,n,u),zt(d,e)}if(i){const f=[t[0],t[Math.floor(t.length/2)]];o=t;const u=s(f[0]),d=s(f[1]);u-d<0&&o.reverse()}else{const f=t.map(u=>({distance:s(u),imageId:u}));f.sort((u,d)=>d.distance-u.distance),o=f.map(u=>u.imageId)}const{imagePositionPatient:l}=Ft("imagePlaneModule",o[0]);return{zSpacing:a,origin:l,sortedImageIds:o}}function OY(t){const e=Ft("modalityLutModule",t)||{},n=Ft("generalSeriesModule",t)||{},{modality:r}=n,i={rescaleSlope:e.rescaleSlope||1,rescaleIntercept:e.rescaleIntercept??0,modality:r},a=Ft("scalingModule",t)||{};return{...i,...r==="PT"&&{suvbw:a.suvbw,suvbsa:a.suvbsa,suvlbm:a.suvlbm},...r==="RTDOSE"&&{doseGridScaling:a.DoseGridScaling,doseSummation:a.DoseSummation,doseType:a.DoseType,doseUnit:a.DoseUnit}}}const PD=t=>Object.values(t).some(n=>typeof n=="number"&&!Number.isInteger(n)),ok={Uint8Array:"Uint8Array",Int16Array:"Int16Array",Uint16Array:"Uint16Array",Float32Array:"Float32Array"};function tC(t,e){const n=_Y(t),{ImageOrientationPatient:r,PixelSpacing:i,Columns:a,Rows:o}=n,s=En(r[0],r[1],r[2]),l=En(r[3],r[4],r[5]),c=ct();dr(c,s,l);const{zSpacing:f,origin:u,sortedImageIds:d}=AD(t,c),h=t.length,p=[i[1],i[0],f],g=[a,o,h].map(y=>Math.floor(y)),m=[...s,...l,...c];return{dimensions:g,spacing:p,origin:u,dataType:OEe(d,n),direction:m,metadata:n,imageIds:d,volumeId:e,voxelManager:null,numberOfComponents:n.PhotometricInterpretation==="RGB"?3:1}}function OEe(t,e){const{BitsAllocated:n,PixelRepresentation:r}=e,i=r===1,a=MEe(t);if(a)return a;const[o,s,l]=[0,Math.floor(t.length/2),t.length-1],c=[o,s,l].map(h=>OY(t[h])),f=c.some(h=>h.rescaleIntercept<0||h.rescaleSlope<0),u=c.some(h=>PD(h)),d=Lw();switch(n){case 8:return"Uint8Array";case 16:return d&&u?"Float32Array":i||f?"Int16Array":!i&&!f?"Uint16Array":"Float32Array";case 24:return"Uint8Array";case 32:return"Float32Array";default:throw new Error(`Bits allocated of ${n} is not defined to generate scalarData for the volume.`)}}function MEe(t){const n=[0,Math.floor(t.length/2),t.length-1].map(i=>yt.getImage(t[i]));if(!n.every(Boolean))return null;const r=n[0].getPixelData().constructor.name;return n.every(i=>i.getPixelData().constructor.name===r)&&r in ok?ok[r]:null}let E3=class MY{constructor(e){this.name=e||"unknown"}static as(e){if(e.iterator)return e.iterator;const n=new MY("as iterator");return e.then(r=>{try{n.add(r,!0)}catch(i){n.reject(i)}},r=>{n.reject(r)}),n}add(e,n=!1){this.nextValue=e,this.done||=n,this.waiting&&(this.waiting.resolve(e),this.waiting=void 0)}resolve(){this.done=!0,this.waiting&&(this.waiting.resolve(this.nextValue),this.waiting=void 0)}reject(e){this.rejectReason=e,this.waiting?.reject(e)}getRecent(){if(this.rejectReason)throw this.rejectReason;return this.nextValue}async*[Symbol.asyncIterator](){for(;!this.done;){if(this.rejectReason)throw this.rejectReason;if(this.nextValue!==void 0&&(yield this.nextValue,this.done))break;this.waiting||(this.waiting={},this.waiting.promise=new Promise((e,n)=>{this.waiting.resolve=e,this.waiting.reject=n})),await this.waiting.promise}yield this.nextValue}async forEach(e,n){let r=0;try{for await(const i of this){const{done:a}=this;try{await e(i,a,r),r++}catch(o){if(!a){console.warn("Caught exception in intermediate value",o);continue}if(n)n(o,a);else throw o}}}catch(i){if(n)n(i,!0);else throw i}}generate(e,n){return e(this,this.reject.bind(this)).then(()=>{this.done||this.resolve()},r=>{this.reject(r),n?n(r):console.warn("Couldn't process because",r)})}async nextPromise(){for await(const e of this)if(e)return e;return this.nextValue}async donePromise(){for await(const e of this);return this.nextValue}getNextPromise(){const e=this.nextPromise();return e.iterator=this,e}getDonePromise(){const e=this.donePromise();return e.iterator=this,e}};const eg=new Map,sk="imageRetrieveConfiguration",fm={IMAGE_RETRIEVE_CONFIGURATION:sk,clear:()=>{eg.clear()},add:(t,e)=>{eg.set(t,e)},clone:()=>new Map(eg),restore:t=>{eg.clear(),t.forEach((e,n)=>{eg.set(n,e)})},get:(t,...e)=>{if(t===sk)return e.map(n=>eg.get(n)).find(n=>n!==void 0)}};Fm(fm.get.bind(fm));function nC(t){const e=Fl(),n=[];return e.forEach(r=>{const a=r.getVolumeViewports().filter(o=>o.hasVolumeId(t));n.push(...a)}),n}const R6=t=>{const e=IEe(t);e?.length&&e.forEach(({renderingEngine:n,viewportIds:r})=>{n.hasBeenDestroyed||n.renderViewports(r)})};function IEe(t){const e=Fl(),n=[];return e.forEach(r=>{const i=nC(t);i.length&&n.push({renderingEngine:r,viewportIds:i.map(a=>a.id)})}),n}const lk=[{id:"initialImages",retrieveType:"single"}],REe=[{id:"lossySequential",retrieveType:"singleFast"},{id:"finalSequential",retrieveType:"singleFinal"}],QT=[{offset:-1,imageQualityStatus:Cs.ADJACENT_REPLICATE},{offset:1,imageQualityStatus:Cs.ADJACENT_REPLICATE},{offset:2,imageQualityStatus:Cs.FAR_REPLICATE}],AEe=[{id:"initialImages",positions:[.5,0,-1],retrieveType:"default",requestType:Dn.Thumbnail,priority:5,nearbyFrames:QT},{id:"quarterThumb",decimate:4,offset:3,requestType:Dn.Thumbnail,retrieveType:"multipleFast",priority:6,nearbyFrames:QT},{id:"halfThumb",decimate:4,offset:1,priority:7,requestType:Dn.Thumbnail,retrieveType:"multipleFast",nearbyFrames:QT},{id:"quarterFull",decimate:4,offset:2,priority:8,requestType:Dn.Thumbnail,retrieveType:"multipleFinal"},{id:"halfFull",decimate:4,offset:0,priority:9,requestType:Dn.Thumbnail,retrieveType:"multipleFinal"},{id:"threeQuarterFull",decimate:4,offset:1,priority:10,requestType:Dn.Thumbnail,retrieveType:"multipleFinal"},{id:"finalFull",decimate:4,offset:3,priority:11,requestType:Dn.Thumbnail,retrieveType:"multipleFinal"},{id:"errorRetrieve"}];function IY(t,e,n=0){const r=[];for(let i=n;i<t.length;i+=e)r.push(i);return r}function PEe(t,e,n){if(e?.nearbyRequests?.length)for(const r of e.nearbyRequests)try{const{itemId:i,imageQualityStatus:a}=r,o=yt.getImageQuality(i);if(o!==void 0&&o>=a)continue;const s={...n,imageId:i,imageQualityStatus:a};yt.setPartialImage(i,s),t.successCallback(i,s)}catch(i){console.warn("Couldn't fill nearby item ",r.itemId,i)}}const Dg=class Dg{constructor(e){this.stages=e.stages||lk,this.retrieveOptions=e.retrieveOptions||{}}loadImages(e,n){return new NEe(this,e,n).loadImages()}};Dg.createProgressive=RY,Dg.interleavedRetrieveStages={stages:AEe},Dg.singleRetrieveStages={stages:lk},Dg.sequentialRetrieveStages={stages:REe};let C2=Dg;class NEe{constructor(e,n,r){this.outstandingRequests=0,this.stageStatusMap=new Map,this.displayedIterator=new E3("displayed"),this.stages=e.stages,this.retrieveOptions=e.retrieveOptions,this.imageIds=n,this.listener=r}async loadImages(){const e=this.createStageRequests();this.outstandingRequests=e.length;for(const n of e)this.addRequest(n);return this.outstandingRequests===0?Promise.resolve(null):this.displayedIterator.getDonePromise()}sendRequest(e,n){const{imageId:r,next:i}=e,a=(f,u)=>{this.listener.errorCallback(r,l||!i,f),u&&this.updateStageStatus(e.stage,f)},o=(n.loader||v0)(r,n),s=E3.as(o);let l=!1;return s.forEach(async(f,u)=>{const d=yt.getImageQuality(r);if(!f){console.warn("No image retrieved",r);return}const{imageQualityStatus:h}=f;if(l||=h===Cs.FULL_RESOLUTION,d!==void 0&&d>h){this.updateStageStatus(e.stage,null,!0);return}this.listener.successCallback(r,f),this.displayedIterator.add(f),u&&this.updateStageStatus(e.stage),PEe(this.listener,e,f)},a).finally(()=>{if(!l&&i)yt.setPartialImage(r),this.addRequest(i,n.streamingData);else{l||this.listener.errorCallback(r,!0,"Couldn't decode"),this.outstandingRequests--;for(let f=i;f;f=f.next)this.updateStageStatus(f.stage,null,!0)}this.outstandingRequests<=0&&this.displayedIterator.resolve()}),s.getDonePromise().catch(f=>null)}addRequest(e,n={}){const{imageId:r,stage:i}=e,a=this.listener.getLoaderImageOptions(r);if(!a)return;const{retrieveType:o="default"}=i,{retrieveOptions:s}=this,l=s[o]||s.default,c={...a,retrieveType:o,retrieveOptions:l,streamingData:n},f=i.priority??-5,u=i.requestType||Dn.Interaction,d={imageId:r};Qo.addRequest(this.sendRequest.bind(this,e,c),u,d,f)}updateStageStatus(e,n,r=!1){const{id:i}=e,a=this.stageStatusMap.get(i);if(a&&(a.imageLoadPendingCount--,n?a.imageLoadFailedCount++:r||a.totalImageCount++,!r&&!a.stageStartTime&&(a.stageStartTime=Date.now()),!a.imageLoadPendingCount)){const{imageLoadFailedCount:o,totalImageCount:s,stageStartTime:l=Date.now(),startTime:c}=a,f={stageId:i,numberOfFailures:o,numberOfImages:s,stageDurationInMS:l?Date.now()-l:null,startDurationInMS:Date.now()-c};Ct(St,vt.IMAGE_RETRIEVAL_STAGE,f),this.stageStatusMap.delete(i)}}createStageRequests(){const e=new Array,n=new Map,r=(i,a)=>{const o=a<0?this.imageIds.length+a:a<1?Math.floor((this.imageIds.length-1)*a):a,s=this.imageIds[o];if(!s)throw new Error(`No value found to add to requests at ${a}`);const l={imageId:s,stage:i,index:o,nearbyRequests:this.findNearbyRequests(o,i)};this.addStageStatus(i);const c=n.get(s);c?c.next=l:e.push(l),n.set(s,l)};for(const i of this.stages)(i.positions||IY(this.imageIds,i.decimate||1,i.offset??0)).forEach(o=>{r(i,o)});return e}findNearbyRequests(e,n){const r=new Array;if(!n.nearbyFrames)return r;for(const i of n.nearbyFrames){const a=e+i.offset;a<0||a>=this.imageIds.length||r.push({itemId:this.imageIds[a],imageQualityStatus:i.imageQualityStatus,index:a})}return r}addStageStatus(e){const{id:n}=e,r=this.stageStatusMap.get(n)||{stageId:n,startTime:Date.now(),stageStartTime:null,totalImageCount:0,imageLoadFailedCount:0,imageLoadPendingCount:0};return r.imageLoadPendingCount++,this.stageStatusMap.set(n,r),r}}function RY(t){return new C2(t)}const ck=Dn.Prefetch;class AY extends Vm{constructor(e,n){super(e),this.framesLoaded=0,this.framesProcessed=0,this.framesUpdated=0,this.autoRenderOnLoad=!0,this.cachedFrames=[],this.reRenderTarget=0,this.reRenderFraction=2,this.imagesLoader=this,this.cancelLoading=()=>{const{loadStatus:r}=this;if(!r||!r.loading)return;r.loading=!1,r.cancelled=!0,this.clearLoadCallbacks();const i=({additionalDetails:a})=>a.volumeId!==this.volumeId;Qo.filterRequests(i)},this.loadStatus=n.loadStatus}invalidateVolume(e){const{vtkOpenGLTexture:n}=this,{numFrames:r}=this;for(let i=0;i<r;i++)n.setUpdatedFrame(i);this.modified(),e&&R6(this.volumeId)}clearLoadCallbacks(){this.loadStatus.callbacks=[]}callLoadStatusCallback(e){const{framesUpdated:n,framesProcessed:r,totalNumFrames:i}=e,{volumeId:a,reRenderFraction:o,loadStatus:s,metadata:l}=this,{FrameOfReferenceUID:c}=l;if(this.autoRenderOnLoad&&(n>this.reRenderTarget||r===i)&&(this.reRenderTarget+=o,R6(a)),r===i){s.callbacks.forEach(u=>u(e));const f={FrameOfReferenceUID:c,volumeId:a};Ct(St,vt.IMAGE_VOLUME_LOADING_COMPLETED,f)}}updateTextureAndTriggerEvents(e,n,r=Cs.FULL_RESOLUTION){const i=this.imageIdIndexToFrameIndex(e),{cachedFrames:a,numFrames:o,totalNumFrames:s}=this,{FrameOfReferenceUID:l}=this.metadata;if(a[i]>r||a[i]===Cs.FULL_RESOLUTION)return;const f=r===Cs.FULL_RESOLUTION;a[e]=r,this.framesUpdated++,f&&(this.framesLoaded++,this.framesProcessed++);const u={FrameOfReferenceUID:l,volumeId:this.volumeId,numberOfFrames:o,framesProcessed:this.framesProcessed};Ct(St,vt.IMAGE_VOLUME_MODIFIED,u),f&&this.framesProcessed===this.totalNumFrames&&(this.loadStatus.loaded=!0,this.loadStatus.loading=!1),this.callLoadStatusCallback({success:!0,imageIdIndex:e,imageId:n,framesLoaded:this.framesLoaded,framesProcessed:this.framesProcessed,framesUpdated:this.framesUpdated,numFrames:o,totalNumFrames:s,complete:f,imageQualityStatus:r}),this.vtkOpenGLTexture.setUpdatedFrame(i),this.loadStatus.loaded&&(this.loadStatus.callbacks=[])}successCallback(e,n){const r=this.getImageIdIndex(e),{imageQualityStatus:i}=n;if(this.loadStatus.cancelled){console.warn("volume load cancelled, returning for imageIdIndex: ",r);return}this.updateTextureAndTriggerEvents(r,e,i),this.isDynamicVolume()&&this.checkDimensionGroupCompletion(r)}errorCallback(e,n,r){if(!n)return;const{totalNumFrames:i,numFrames:a}=this,o=this.getImageIdIndex(e);this.framesProcessed++,this.framesProcessed===i&&(this.loadStatus.loaded=!0,this.loadStatus.loading=!1),this.callLoadStatusCallback({success:!1,imageId:e,imageIdIndex:o,error:r,framesLoaded:this.framesLoaded,framesProcessed:this.framesProcessed,framesUpdated:this.framesUpdated,numFrames:a,totalNumFrames:i}),this.loadStatus.loaded&&(this.loadStatus.callbacks=[]);const s={error:r,imageIdIndex:o,imageId:e};Ct(St,vt.IMAGE_LOAD_ERROR,s)}load(e){const{imageIds:n,loadStatus:r,numFrames:i}=this,{transferSyntaxUID:a}=Ft("transferSyntax",n[0])||{},o=Ft(fm.IMAGE_RETRIEVE_CONFIGURATION,this.volumeId,a,"volume");if(this.imagesLoader=this.isDynamicVolume()?this:o?(o.create||C2.createProgressive)(o):this,r.loading===!0)return;const{loaded:s}=this.loadStatus,l=n.length;if(s){e&&e({success:!0,framesLoaded:l,framesProcessed:l,numFrames:i,totalNumFrames:l});return}e&&this.loadStatus.callbacks.push(e),this._prefetchImageIds()}getLoaderImageOptions(e){const{transferSyntaxUID:n}=Ft("transferSyntax",e)||{},r=Ft("imagePlaneModule",e)||{},{rows:i,columns:a}=r,o=this.getImageIdIndex(e),s=Ft("modalityLutModule",e)||{},l=Ft("generalSeriesModule",e)||{},c={rescaleSlope:s.rescaleSlope,rescaleIntercept:s.rescaleIntercept,modality:l.modality},f=c.modality;if(f==="PT"||f==="RTDOSE"){const p=Ft("scalingModule",e);p&&(this._addScalingToVolume(p),Object.assign(c,p))}const u=PD(c),d=Lw();if(this.isPreScaled=!0,c&&c.rescaleSlope!==void 0&&c.rescaleIntercept!==void 0){const{rescaleSlope:p,rescaleIntercept:g}=c;this.isPreScaled=typeof p=="number"&&typeof g=="number"}return!d&&u&&(this.isPreScaled=!1),{targetBuffer:{type:this.dataType,rows:i,columns:a},allowFloatRendering:d,preScale:{enabled:this.isPreScaled,scalingParameters:c},transferPixelData:!0,requestType:ck,transferSyntaxUID:n,additionalDetails:{imageId:e,imageIdIndex:o,volumeId:this.volumeId},retrieveOptions:void 0}}callLoadImage(e,n,r){const{cachedFrames:i}=this;if(i[n]===Cs.FULL_RESOLUTION)return;const a=s=>{const{image:l}=s.detail;l.imageId===e&&(this.vtkOpenGLTexture.setUpdatedFrame(n),St.removeEventListener(vt.IMAGE_CACHE_IMAGE_ADDED,a))};return St.addEventListener(vt.IMAGE_CACHE_IMAGE_ADDED,a),E3.as(v0(e,r)).forEach(s=>{this.successCallback(e,s)},this.errorCallback.bind(this,n,e))}getImageIdsRequests(e,n){this.totalNumFrames=this.imageIds.length;const r=2;return this.autoRenderOnLoad&&(this.reRenderFraction=this.totalNumFrames*(r/100),this.reRenderTarget=this.reRenderFraction),e.map(a=>{const o=this.getImageIdIndex(a),s=ck,l=n,c=this.getLoaderImageOptions(a),{retrieveOptions:f={}}=Ft(fm.IMAGE_RETRIEVE_CONFIGURATION,a,"volume")||{};return c.retrieveOptions={...c.retrieveOptions,...f.default||Object.values(f)?.[0]||{}},{callLoadImage:this.callLoadImage.bind(this),imageId:a,imageIdIndex:o,options:c,priority:l,requestType:s,additionalDetails:{volumeId:this.volumeId}}})}getImageLoadRequests(e){throw new Error("Abstract method")}getImageIdsToLoad(){throw new Error("Abstract method")}loadImages(){return this.loadStatus.loading=!0,this.getImageLoadRequests(5).reverse().forEach(n=>{if(!n)return;const{callLoadImage:r,imageId:i,imageIdIndex:a,options:o,priority:s,requestType:l,additionalDetails:c}=n;Qo.addRequest(r.bind(this,i,a,o),l,c,s)}),Promise.resolve(!0)}_prefetchImageIds(){this.loadStatus.loading=!0;const e=[...this.getImageIdsToLoad()];this.totalNumFrames=this.imageIds.length;const n=2;return this.autoRenderOnLoad&&(this.reRenderFraction=this.totalNumFrames*(n/100),this.reRenderTarget=this.reRenderFraction),this.imagesLoader.loadImages(e,this).catch(r=>{console.debug("progressive loading failed to complete",r)})}_addScalingToVolume(e){if(this.scaling)return;const{suvbw:n,suvlbm:r,suvbsa:i}=e,a={};r&&(a.suvbwToSuvlbm=r/n),i&&(a.suvbwToSuvbsa=i/n),n&&(a.suvbw=n),this.scaling={PT:a}}checkDimensionGroupCompletion(e){}}class PY extends AY{constructor(e,n){e.imageIds||(e.imageIds=n.imageIds),super(e,n),this.getImageIdsToLoad=()=>{const{imageIds:r}=this;return this.numFrames=r.length,r}}getScalarData(){return this.voxelManager.getScalarData()}getImageLoadRequests(e){const{imageIds:n}=this;return this.getImageIdsRequests(n,e)}}function NY(t,e){if(!e||!e.imageIds||!e.imageIds.length)throw new Error("ImageIds must be provided to create a streaming image volume");async function n(){if(e.imageIds[0].split(":")[0]==="wadouri"){const[p,g]=[Math.floor(e.imageIds.length/2),e.imageIds.length-1],m=[0,p,g];await Promise.all(m.map(y=>yt.isLoaded(e.imageIds[y])?Promise.resolve(!0):new Promise((v,x)=>{const w=e.imageIds[y];Qo.addRequest(async()=>{TY(w).then(()=>{console.log(`Prefetched imageId: ${w}`),v(!0)}).catch(S=>{x(S)})},Dn.Prefetch,{volumeId:t},1)}))).catch(console.error)}const i=tC(e.imageIds,t),{dimensions:a,spacing:o,origin:s,direction:l,metadata:c,imageIds:f,dataType:u,numberOfComponents:d}=i;return new PY({volumeId:t,metadata:c,dimensions:a,spacing:o,origin:s,direction:l,imageIds:f,dataType:u,numberOfComponents:d},{imageIds:f,loadStatus:{loaded:!1,loading:!1,cancelled:!1,cachedFrames:[],callbacks:[]}})}const r=n();return{promise:r,decache:()=>{r.then(i=>{i.destroy(),i=null})},cancel:()=>{r.then(i=>{i.cancelLoading()})}}}const ND={};let Kg=NY;function LY(t,e){const n=t.indexOf(":"),r=t.substring(0,n);let i=ND[r];if(i==null){if(Kg==null||typeof Kg!="function")throw new Error(`No volume loader for scheme ${r} has been registered`);i=Kg}const a=i(t,e);return a.promise.then(function(o){Ct(St,vt.VOLUME_LOADED,{volume:o})},function(o){const s={volumeId:t,error:o};Ct(St,vt.VOLUME_LOADED_FAILED,s)}),a}function LD(t,e={imageIds:[]}){if(t===void 0)throw new Error("loadVolume: parameter volumeId must not be undefined");let n=yt.getVolumeLoadObject(t);return n!==void 0?n.promise:(n=LY(t,e),n.promise.then(r=>r))}async function kD(t,e){if(t===void 0)throw new Error("createAndCacheVolume: parameter volumeId must not be undefined");let n=yt.getVolumeLoadObject(t);return n!==void 0||(n=LY(t,e),yt.putVolumeLoadObject(t,n)),n.promise}function kY(t,e){const n=yt.getVolume(t);if(!n)throw new Error(`Cannot created derived volume: Referenced volume with id ${t} does not exist.`);let{volumeId:r}=e;const{voxelRepresentation:i}=e;r===void 0&&(r=or());const{metadata:a,dimensions:o,spacing:s,origin:l,direction:c}=n,f=n.isDynamicVolume()?n.getCurrentDimensionGroupImageIds():n.imageIds??[],u=ID(f,{targetBuffer:e.targetBuffer,voxelRepresentation:i}),d=u[0].dataType,h=u.map(g=>g.imageId),p=new Vm({volumeId:r,dataType:d,metadata:structuredClone(a),dimensions:[o[0],o[1],o[2]],spacing:s,origin:l,direction:c,referencedVolumeId:t,imageIds:h,referencedImageIds:n.imageIds??[]});return yt.putVolumeSync(r,p),p}async function VY(t,e){if(e===void 0)throw new Error("createAndCacheVolumeFromImages: parameter imageIds must not be undefined");if(t===void 0)throw new Error("createAndCacheVolumeFromImages: parameter volumeId must not be undefined");const n=yt.getVolume(t);return n||(e.filter(a=>!yt.getImage(a)).length===0?rC(t,e):await kD(t,{imageIds:e}))}function rC(t,e){if(e===void 0)throw new Error("createAndCacheVolumeFromImagesSync: parameter imageIds must not be undefined");if(t===void 0)throw new Error("createAndCacheVolumeFromImagesSync: parameter volumeId must not be undefined");const n=yt.getVolume(t);if(n)return n;const r=tC(e,t),i=new Vm({volumeId:t,dataType:r.dataType,metadata:structuredClone(r.metadata),dimensions:r.dimensions,spacing:r.spacing,origin:r.origin,direction:r.direction,referencedVolumeId:r.referencedVolumeId,imageIds:r.imageIds,referencedImageIds:r.referencedImageIds});return yt.putVolumeSync(t,i),i}function VD(t,e={}){const{metadata:n,dimensions:r,spacing:i,origin:a,direction:o,scalarData:s,targetBuffer:l,preventCache:c=!1}=e,f=yt.getVolume(t);if(f)return f;const u=r[0]*r[1],d=s?s.constructor.name:l?.type??"Float32Array",h=u*r[2];let p;switch(d){case"Uint8Array":case"Int8Array":p=h;break;case"Uint16Array":case"Int16Array":p=h*2;break;case"Float32Array":p=h*4;break}if(!yt.isCacheable(p))throw new Error(`Cannot created derived volume: Volume with id ${t} is not cacheable.`);const m=[];for(let x=0;x<r[2];x++){const w=`${t}_slice_${x}`;m.push(w);const S=s.subarray(x*u,(x+1)*u);RD(w,{scalarData:S,dimensions:[r[0],r[1]],spacing:[i[0],i[1]],origin:a,direction:o,targetBuffer:{type:d}})}const y=new Vm({volumeId:t,metadata:structuredClone(n),dimensions:[r[0],r[1],r[2]],spacing:i,origin:a,direction:o,imageIds:m,dataType:d}),v=g0.createImageVolumeVoxelManager({imageIds:m,dimensions:r,numberOfComponents:1,id:t});return y.voxelManager=v,c||yt.putVolumeSync(t,y),y}function LEe(t,e){ND[t]=e}function FY(){return Object.keys(ND)}function kEe(t){const e=Kg;return Kg=t,e}function UY(){return Kg.name}function VEe(t,e={}){return kY(t,{...e,targetBuffer:{type:"Uint8Array",...e?.targetBuffer}})}function FEe(t,e,n=!1){return t.scalarData||(t.scalarData=new Uint8Array(t.dimensions[0]*t.dimensions[1]*t.dimensions[2])),VD(e,{...t,preventCache:n})}const UEe=Object.freeze(Object.defineProperty({__proto__:null,createAndCacheDerivedLabelmapVolume:VEe,createAndCacheDerivedVolume:kY,createAndCacheVolume:kD,createAndCacheVolumeFromImages:VY,createAndCacheVolumeFromImagesSync:rC,createLocalLabelmapVolume:FEe,createLocalVolume:VD,getUnknownVolumeLoaderSchema:UY,getVolumeLoaderSchemes:FY,loadVolume:LD,registerUnknownVolumeLoader:kEe,registerVolumeLoader:LEe},Symbol.toStringTag,{value:"Module"}));function BY(t,e){const n=lEe.newInstance();Pf().rendering.preferSizeOverAccuracy&&n.setPreferSizeOverAccuracy(!0),n.setInputData(t);const r=t.getSpacing(),a=(Pf().rendering?.volumeRendering?.sampleDistanceMultiplier||1)*(r[0]+r[1]+r[2])/6;return n.setMaximumSamplesPerRay(4e3),n.setSampleDistance(a),n.setScalarTexture(e),n}function $Y(t){const e=xY.newInstance();e.setBlendMode(t.getBlendMode());const n=t.getInputData(),{voxelManager:r}=n.get("voxelManager"),i=r.getCompleteScalarDataArray(),a=nn.newInstance({name:"Pixels",values:i});return n.getPointData().setScalars(a),e.setInputData(n),e.setMaximumSamplesPerRay(t.getMaximumSamplesPerRay()),e.setSampleDistance(t.getSampleDistance()),e}const BEe=0,$Ee=Dn.Prefetch;async function FD(t,e){let n=jEe(e);!n&&e.imageIds.length&&(n=await zEe(e),n=GEe(e,n)),!(n.lower===0&&n.upper===0||n.lower===void 0||n.upper===void 0)&&t.getProperty().getRGBTransferFunction(0).setMappingRange(n.lower,n.upper)}function GEe(t,e){const n=t.imageIds,r=Math.floor(n.length/2),i=n[r],a=Ft("generalSeriesModule",i)||{};return WEe(a.modality,t)?{lower:0,upper:5}:e}function jEe(t){const{imageIds:e,metadata:n}=t;let r;if(e?.length){const i=Math.floor(e.length/2),a=e[i],o=Ft("voiLutModule",a);if(o&&o.windowWidth&&o.windowCenter){o?.voiLUTFunction&&(r={},r.voiLUTFunction=o?.voiLUTFunction);const{windowWidth:s,windowCenter:l}=o,c=Array.isArray(s)?s[0]:s,f=Array.isArray(l)?l[0]:l;c!==0&&(r={windowWidth:c,windowCenter:f})}}else r=n.voiLut[0];if(r&&(r.windowWidth!==0||r.windowCenter!==0)){const{lower:i,upper:a}=Gg(Number(r.windowWidth),Number(r.windowCenter),r.voiLUTFunction);return{lower:i,upper:a}}}async function zEe(t){const{imageIds:e}=t,n=Math.floor(e.length/2),r=t.imageIds[n],i=Ft("generalSeriesModule",r)||{},{modality:a}=i,o=Ft("modalityLutModule",r)||{},s={rescaleSlope:o.rescaleSlope,rescaleIntercept:o.rescaleIntercept,modality:a};let l;if(a==="PT"){const h=Ft("scalingModule",r);h&&(l={...s,suvbw:h.suvbw})}const c={priority:BEe,requestType:$Ee,preScale:{scalingParameters:l}};let f=yt.getImage(r);t.referencedImageIds?.length||(f=await v0(r,{...c,ignoreCache:!0}));let{min:u,max:d}=f.voxelManager.getMinMax();return u?.length>1&&(u=Math.min(...u),d=Math.max(...d)),{lower:u,upper:d}}function WEe(t,e){return!(t!=="PT"||!e.isPreScaled||!e.scaling?.PT.suvbw)}async function _3(t,e,n,r=!1){const{volumeId:i,callback:a,blendMode:o}=t,s=await LD(i);if(!s)throw new Error(`imageVolume with id: ${s.volumeId} does not exist`);const{imageData:l,vtkOpenGLTexture:c}=s,f=BY(l,c);o&&f.setBlendMode(o);const u=rxe.newInstance();u.setMapper(f);const{numberOfComponents:d}=l.get("numberOfComponents");return u.getProperty().set({viewportId:n},!0),d===3&&u.getProperty().setIndependentComponents(!1),await FD(u,s),a&&a({volumeActor:u,volumeId:i}),r||HEe(e,n,u,i),u}function HEe(t,e,n,r){const i=n.getProperty().getRGBTransferFunction(0).getRange(),a={viewportId:e,range:{lower:i[0],upper:i[1]},volumeId:r};Ct(t,vt.VOI_MODIFIED,a)}function GY(t){const e=t.getMapper().getInputData(),n=e.extentToBounds(e.getExtent());return[[n[0],n[2],n[4]],[n[0],n[2],n[5]],[n[0],n[3],n[4]],[n[0],n[3],n[5]],[n[1],n[2],n[4]],[n[1],n[2],n[5]],[n[1],n[3],n[4]],[n[1],n[3],n[5]]]}const KEe=Qs*Qs,e8=t=>Math.abs(Math.abs(t)-1)<KEe,t8=(t,e)=>e8(t[e])||e8(t[e+1])||e8(t[e+2]),qEe=t=>t8(t,0)&&t8(t,3)&&t8(t,6);function iC(t,e,n){const r=t.getMapper().getInputData();let i;const a=r.getDirection();if(qEe(a))i=GY(t);else{const[u,d,h]=r.getDimensions();i=[[0,0,0],[u-1,0,0],[0,d-1,0],[u-1,d-1,0],[0,0,h-1],[u-1,0,h-1],[0,d-1,h-1],[u-1,d-1,h-1]].map(g=>r.indexToWorld(g))}const o=Jd.buildFromDegree().identity().rotateFromDirections(e,[1,0,0]);i.forEach(u=>o.apply(u));const s=[...n];o.apply(s);const l=s[0];let c=1/0,f=-1/0;for(let u=0;u<8;u++){const d=i[u][0];d>f&&(f=d),d<c&&(c=d)}return{min:c,max:f,current:l,actor:t,viewPlaneNormal:e,focalPoint:n}}function fp(t,e){const{direction:n,spacing:r}=t,i=n.slice(0,3),a=n.slice(3,6),o=n.slice(6,9),s=[zt(i,e),zt(a,e),zt(o,e)],l=ct();return c3(l,s[0]*r[0],s[1]*r[1],s[2]*r[2]),Ao(l)}const _0=t=>{const e="volumeId:",n=t.includes(e)?t.substring(e.length):t,r=n.indexOf("sliceIndex=");return r===-1?n:n.substring(0,r-1)},XEe=1+Qs,YEe=(t,e)=>e===t.substring(0,Math.min(t.length,e.length)),uk=t=>!!FY().find(e=>YEe(t.volumeId,e));function ly(t,e,n,r=!1){const{viewPlaneNormal:i}=e,a=t.getActors();if(!a.length)return{spacingInNormalDirection:null,imageVolume:null,actorUID:null};const o=a.map(c=>{const f=c.referencedId??c.uid;return yt.getVolume(f)}).filter(c=>!!c);if(n){const c=_0(n),f=o.findIndex(p=>c.includes(p.volumeId)),u=o[f],{uid:d}=a[f],h=fk(u,i,t,r);return{imageVolume:u,spacingInNormalDirection:h,actorUID:d}}if(!o.length)return{spacingInNormalDirection:null,imageVolume:null,actorUID:null};const s={spacingInNormalDirection:1/0,imageVolume:null,actorUID:null},l=o.find(uk);for(let c=0;c<o.length;c++){const f=o[c];if(l&&!uk(f))continue;const u=fk(f,i,t);u*XEe<s.spacingInNormalDirection&&(s.spacingInNormalDirection=u,s.imageVolume=f,s.actorUID=a[c].uid)}return s}function fk(t,e,n,r=!1){const{slabThickness:i}=n.getProperties();let a=i;return(!i||!r)&&(a=fp(t,e)),a}function D3(t){const e=t.getCamera(),{spacingInNormalDirection:n,imageVolume:r}=ly(t,e);if(!r)return;const{viewPlaneNormal:i,focalPoint:a}=e,o=t.getActors().find(p=>p.referencedId===r.volumeId||p.uid===r.volumeId);o||console.warn("No actor found for with actorUID of",r.volumeId);const s=o.actor,l=iC(s,i,a),{min:c,max:f,current:u}=l,d=Math.round((f-c)/n)+1;let h=(u-c)/(f-c)*d;return h=Math.floor(h),h>d-1?h=d-1:h<0&&(h=0),{numberOfSlices:d,imageIndex:h}}const bg={};function JEe(t){bg[t]!==void 0&&delete bg[t]}function ZEe(t){const{renderingEngineId:e,viewportId:n}=t.detail,i=$f(e).getViewport(n);if(!("setVolumes"in i))throw new Error("volumeNewImageEventDispatcher: viewport does not have setVolumes method");bg[i.id]===void 0&&(bg[i.id]=0);const a=D3(i);if(!a){console.warn(`volumeNewImageEventDispatcher: sliceData is undefined for viewport ${i.id}`);return}const{numberOfSlices:o,imageIndex:s}=a;if(bg[i.id]===s)return;bg[i.id]=s;const l={imageIndex:s,viewportId:n,renderingEngineId:e,numberOfSlices:o};Ct(i.element,vt.VOLUME_NEW_IMAGE,l)}function O3(t,e,n){const[r,i,a]=t,[o,s,l]=e,[c,f,u,d]=n,h=o-r,p=s-i,g=l-a,m=-1*(c*r+f*i+u*a-d)/(c*h+f*p+u*g),y=h*m+r,v=p*m+i,x=g*m+a;return[y,v,x]}function UD(t,e,n=!1){const[r,i,a]=t,o=r*e[0]+i*e[1]+a*e[2];if(n){const s=Math.sqrt(r*r+i*i+a*a);return[r/s,i/s,a/s,o/s]}return[r,i,a,o]}function QEe(t,e,n){const[r,i,a,o]=t,[s,l,c,f]=e,[u,d,h,p]=n,g=J5(r,s,u,i,l,d,a,c,h),m=J5(o,f,p,i,l,d,a,c,h),y=J5(r,s,u,o,f,p,a,c,h),v=J5(r,s,u,i,l,d,o,f,p),x=qp(m)/qp(g),w=qp(y)/qp(g),S=qp(v)/qp(g);return[x,w,S]}function BD(t,e,n=!1){const[r,i,a,o]=t,[s,l,c]=e,f=r*s+i*l+a*c-o,u=Math.abs(f)/Math.sqrt(r*r+i*i+a*a);return(n?Math.sign(f):1)*u}function e6e(t,e,n=Qs){return BD(e,t)<n}const t6e=Object.freeze(Object.defineProperty({__proto__:null,isPointOnPlane:e6e,linePlaneIntersection:O3,planeDistanceToPoint:BD,planeEquation:UD,threePlaneIntersection:QEe},Symbol.toStringTag,{value:"Module"}));function A6(t){return Array.isArray(t)?t.some(e=>Number.isNaN(e)):Number.isNaN(t)}function fc(t){if(t===null||typeof t!="object"||typeof t=="function"||typeof structuredClone=="function")return t;if(Array.isArray(t))return t.map(fc);{const e={};for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=fc(t[n]));return e}}const n6e=.95;function jY(t,e){if(!t?.length||!e.FrameOfReferenceUID)return;e.planeRestriction||={FrameOfReferenceUID:e.FrameOfReferenceUID,point:t[0],inPlaneVector1:null,inPlaneVector2:null};const{planeRestriction:n}=e;if(t.length===1)return n.inPlaneVector1=null,n.inPlaneVector2=null,n;const r=ur(ct(),t[0],t[Math.floor(t.length/2)]);Ir(r,r),n.inPlaneVector1=r,n.inPlaneVector2=null;const i=t.length;if(i>2)for(let a=Math.floor(i/3);a<i;a++){const o=ur(ct(),t[a],t[0]),s=Ao(o);if(!fr(s,0)&&zt(o,n.inPlaneVector1)<s*n6e)return Ir(o,o),n.inPlaneVector2=o,n}return n}const Kv=class Kv{constructor(e){this.insetImageMultiplier=1.1,this.flipHorizontal=!1,this.flipVertical=!1,this.viewportStatus=So.NO_DATA,this._suppressCameraModifiedEvents=!1,this.hasPixelSpacing=!0,this.getProperties=()=>({}),this.setRotation=n=>{},this.viewportWidgets=new Map,this.addWidget=(n,r)=>{this.viewportWidgets.set(n,r)},this.getWidget=n=>this.viewportWidgets.get(n),this.getWidgets=()=>Array.from(this.viewportWidgets.values()),this.removeWidgets=()=>{this.getWidgets().forEach(r=>{if(r.getEnabled()&&r.setEnabled(!1),r.getActor&&r.getRenderer){const i=r.getActor(),a=r.getRenderer();a&&i&&a.removeActor(i)}})},this.id=e.id,this.renderingEngineId=e.renderingEngineId,this.type=e.type,this.element=e.element,this.canvas=e.canvas,this.sx=e.sx,this.sy=e.sy,this.sWidth=e.sWidth,this.sHeight=e.sHeight,this._actors=new Map,this.element.setAttribute("data-viewport-uid",this.id),this.element.setAttribute("data-rendering-engine-uid",this.renderingEngineId),this.defaultOptions=fc(e.defaultOptions),this.suppressEvents=e.defaultOptions.suppressEvents?e.defaultOptions.suppressEvents:!1,this.options=fc(e.defaultOptions),this.isDisabled=!1}static get useCustomRenderingPipeline(){return!1}setRendered(){this.viewportStatus===So.NO_DATA||this.viewportStatus===So.LOADING||(this.viewportStatus=So.RENDERED)}setColorTransform(e,n){let r=null;if(!e&&!n)return;const i=n||[255,255,255],a=Math.max(...i),o=i.map(u=>a/u),{lower:s=0,upper:l=255}=e||{},c=(l-s+1)/255,f=s/255;return r=`url('data:image/svg+xml,      <svg xmlns="http://www.w3.org/2000/svg">        <filter id="colour" color-interpolation-filters="linearRGB">        <feColorMatrix type="matrix"         values="          ${o[0]*c} 0 0 0 ${f}           0 ${o[1]*c} 0 0 ${f}           0 0 ${o[2]*c} 0 ${f}           0 0 0 1 0" />        </filter>      </svg>#colour')`,r}getRenderingEngine(){return p2.get(this.renderingEngineId)}getRenderer(){const e=this.getRenderingEngine();if(!e||e.hasBeenDestroyed)throw new Error("Rendering engine has been destroyed");return e.offscreenMultiRenderWindow?.getRenderer(this.id)}render(){this.getRenderingEngine().renderViewport(this.id)}setOptions(e,n=!1){this.options=structuredClone(e),this.options?.displayArea&&this.setDisplayArea(this.options?.displayArea),n&&this.render()}reset(e=!1){this.options=structuredClone(this.defaultOptions),e&&this.render()}getSliceViewInfo(){throw new Error("Method not implemented.")}flip({flipHorizontal:e,flipVertical:n}){const r=this.getDefaultImageData();if(!r)return;const i=this.getCamera(),{viewPlaneNormal:a,viewUp:o,focalPoint:s,position:l}=i,c=dr(ct(),a,o);let f=B9(ct(),o);const u=su(ct(),a),d=el(l,s),p=r.getDimensions().map(S=>Math.floor(S/2)),g=[p[0],p[1],p[2]],m=r.indexToWorld(g,ct()),y=this._getFocalPointForResetCamera(m,i,{resetPan:!0,resetToCenter:!1}),v=Dr(ct(),s,y),x=Ao(v),w=S=>{const T=Xs(ct(),S,2*zt(v,S));return Dr(T,T,v),Ir(T,T),T};if(e){const S=w(f),T=Or(ct(),y,S,x),_=Or(ct(),T,u,d);this.setCamera({viewPlaneNormal:u,position:_,focalPoint:T}),this.flipHorizontal=!this.flipHorizontal}if(n){f=su(f,o);const S=w(c),T=Or(ct(),y,S,x),_=Or(ct(),T,u,d);this.setCamera({focalPoint:T,viewPlaneNormal:u,viewUp:f,position:_}),this.flipVertical=!this.flipVertical}this.render()}getDefaultImageData(){const e=this.getDefaultActor();if(e&&uc(e))return e.actor.getMapper().getInputData()}getDefaultActor(){return this.getActors()[0]}getActors(){return Array.from(this._actors.values())}getActorUIDs(){return Array.from(this._actors.keys())}getActor(e){return this._actors.get(e)}getImageActor(e){const n=this.getActors();let r=n[0];return e&&(r=n.find(a=>a.referencedId===e)),!r||!uc(r)?null:r.actor}getActorUIDByIndex(e){const n=this.getActors()[e];if(n)return n.uid}getActorByIndex(e){return this.getActors()[e]}setActors(e){const n=this.getActors();this.removeAllActors(),this.addActors(e,{resetCamera:!0}),Ct(this.element,vt.ACTORS_CHANGED,{viewportId:this.id,removedActors:n,addedActors:e,currentActors:e})}_removeActor(e){const n=this.getActor(e);if(!n){console.warn(`Actor ${e} does not exist in ${this.id}, can't remove`);return}return this.getRenderer().removeActor(n.actor),this._actors.delete(e),n}removeActors(e){const n=[];e.forEach(i=>{const a=this._removeActor(i);a&&n.push(a)});const r=this.getActors();Ct(this.element,vt.ACTORS_CHANGED,{viewportId:this.id,removedActors:n,addedActors:[],currentActors:r})}addActors(e,n={}){const{resetCamera:r=!1}=n,i=this.getRenderingEngine();if(!i||i.hasBeenDestroyed){console.warn("Viewport::addActors::Rendering engine has not been initialized or has been destroyed");return}e.forEach(s=>{this.addActor(s)});const a=this.getViewPresentation(),o=this.getViewReference();this.resetCamera(),r||(this.setViewReference(o),this.setViewPresentation(a)),Ct(this.element,vt.ACTORS_CHANGED,{viewportId:this.id,removedActors:[],addedActors:e,currentActors:this.getActors()})}addActor(e){const{uid:n,actor:r}=e,i=this.getRenderingEngine();if(!i||i.hasBeenDestroyed){console.warn(`Cannot add actor UID of ${n} Rendering Engine has been destroyed`);return}if(!n||!r)throw new Error("Actors should have uid and vtk Actor properties");if(this.getActor(n)){console.warn(`Actor ${n} already exists for this viewport`);return}this.getRenderer()?.addActor(r),this._actors.set(n,Object.assign({},e)),this.updateCameraClippingPlanesAndRange(),Ct(this.element,vt.ACTORS_CHANGED,{viewportId:this.id,removedActors:[],addedActors:[e],currentActors:this.getActors()})}removeAllActors(){const e=this.getActors();this.getRenderer()?.removeAllViewProps(),this._actors=new Map,Ct(this.element,vt.ACTORS_CHANGED,{viewportId:this.id,removedActors:e,addedActors:[],currentActors:[]})}resetCameraNoEvent(){const e=this._suppressCameraModifiedEvents;this._suppressCameraModifiedEvents=!0,this.resetCamera(),this._suppressCameraModifiedEvents=e}setCameraNoEvent(e){const n=this._suppressCameraModifiedEvents;this._suppressCameraModifiedEvents=!0,this.setCamera(e),this._suppressCameraModifiedEvents=n}_getViewImageDataIntersections(e,n,r){const i=r[0],a=r[1],o=r[2],s=i*n[0]+a*n[1]+o*n[2],l=e.getBounds(),c=this._getEdges(l),f=[];for(const u of c){const[[d,h,p],[g,m,y]]=u;if(i*(g-d)+a*(m-h)+o*(y-p)===0)continue;const v=O3([d,h,p],[g,m,y],[i,a,o,s]);this._isInBounds(v,l)&&f.push(v)}return f}setInterpolationType(e,n){}setDisplayArea(e,n=!1){if(!e)return;const{storeAsInitialCamera:r,type:i}=e;r&&(this.options.displayArea=e);const{_suppressCameraModifiedEvents:a}=this;if(this._suppressCameraModifiedEvents=!0,this.setCamera(this.fitToCanvasCamera),i==="SCALE"?this.setDisplayAreaScale(e):(this.setInterpolationType(this.getProperties()?.interpolationType??bf.LINEAR),this.setDisplayAreaFit(e)),r&&(this.initialCamera=this.getCamera()),this._suppressCameraModifiedEvents=a,!n&&!a){const o={viewportId:this.id,displayArea:e,storeAsInitialCamera:r};Ct(this.element,vt.DISPLAY_AREA_MODIFIED,o),this.setCamera(this.getCamera())}}setDisplayAreaScale(e){const{scale:n=1}=e,r=this.canvas,i=r.height,a=r.width;if(i<8||a<8)return;const l=this.getDefaultImageData().getSpacing()[1];this.setInterpolationType(bf.NEAREST),this.setCamera({parallelScale:i*l/(2*n)}),delete e.imageArea,this.setDisplayAreaFit(e);const{focalPoint:c,position:f,viewUp:u,viewPlaneNormal:d}=this.getCamera(),h=ct();if(r.height%2&&Or(h,h,u,n*.5*l),r.width%2){const p=dr(ct(),u,d);Or(h,h,p,n*.5*l)}!h[0]&&!h[1]&&!h[2]||this.setCamera({focalPoint:Nl(ct(),c,h),position:Nl(ct(),f,h)})}setDisplayAreaFit(e){const{imageArea:n,imageCanvasPoint:r}=e,i=window?.devicePixelRatio||1,a=this.getDefaultImageData();if(!a)return;const o=this.sWidth/i,s=this.sHeight/i,l=a.getDimensions(),c=this.worldToCanvas(a.indexToWorld([0,0,0])),f=this.worldToCanvas(a.indexToWorld([l[0],l[1],l[2]])),u=[Math.abs(f[0]-c[0]),Math.abs(f[1]-c[1])],[d,h]=u;let p=this.getZoom()/this.insetImageMultiplier;if(n){const[g,m]=n,y=Math.max(Math.abs(d/o),Math.abs(h/s)),v=Math.abs(g*d/o),x=Math.abs(m*h/s),w=this.getZoom(),S=this.getZoom(this.fitToCanvasCamera);p=(v>x?y/v:y/x)*w/S,this.setZoom(this.insetImageMultiplier*p,!1)}if(r){const{imagePoint:g,canvasPoint:m=g||[.5,.5]}=r,[y,v]=m,x=o*(y-.5),w=s*(v-.5),[S,T]=g||m,_=p,D=this.insetImageMultiplier*_*d*(.5-S),I=this.insetImageMultiplier*_*h*(.5-T),R=D+x,M=I+w,A=[R,M];jw(A,A,this.getPan()),this.setPan(A,!1)}}getDisplayArea(){return this.options?.displayArea}resetCamera(e){const{resetPan:n=!0,resetZoom:r=!0,resetToCenter:i=!0,storeAsInitialCamera:a=!0}=e||{},o=this.getRenderer();this.setCameraNoEvent({flipHorizontal:!1,flipVertical:!1});const s=this.getCamera();let l;const c=this.getDefaultActor();c&&uc(c)?l=c.actor.getMapper().getInputData().getBounds():l=o.computeVisiblePropBounds();const f=[0,0,0],u=this.getDefaultImageData();if(u){const P=u.getSpacing();l[0]=l[0]+P[0]/2,l[1]=l[1]-P[0]/2,l[2]=l[2]+P[1]/2,l[3]=l[3]-P[1]/2,l[4]=l[4]+P[2]/2,l[5]=l[5]-P[2]/2}const d=this.getVtkActiveCamera(),h=d.getViewPlaneNormal(),p=d.getViewUp();if(f[0]=(l[0]+l[1])/2,f[1]=(l[2]+l[3])/2,f[2]=(l[4]+l[5])/2,u){const B=u.getDimensions().map(G=>Math.floor(G/2)),U=[B[0],B[1],B[2]];u.indexToWorld(U,f)}const{widthWorld:g,heightWorld:m}=this._getWorldDistanceViewUpAndViewRight(l,p,h),y=[this.sWidth,this.sHeight],v=g/m,x=y[0]/y[1],w=v/x,S=w<1?this.insetImageMultiplier*m/2:this.insetImageMultiplier*m*w/2,T=Kv.boundsRadius(l)*(this.type===br.VOLUME_3D?10:1),_=this.insetImageMultiplier*T,D=Math.abs(Hs.dot(p,h))>.999?[-p[2],p[0],p[1]]:p,I=this._getFocalPointForResetCamera(f,s,{resetPan:n,resetToCenter:i}),R=[I[0]+_*h[0],I[1]+_*h[1],I[2]+_*h[2]];o.resetCameraClippingRange(l);const M=[-Ci.MAXIMUM_RAY_DISTANCE,Ci.MAXIMUM_RAY_DISTANCE];d.setPhysicalScale(T),d.setPhysicalTranslation(-I[0],-I[1],-I[2]),this.setCamera({parallelScale:r?S:s.parallelScale,focalPoint:I,position:R,viewAngle:90,viewUp:D,clippingRange:M});const A=this.getCamera();this.setFitToCanvasCamera(this.getCamera()),a&&this.setInitialCamera(A),r&&this.setZoom(1,a);const L={type:"ResetCameraEvent",renderer:o};return o.invokeEvent(L),this.triggerCameraModifiedEventIfNecessary(s,A),u&&this.options.displayArea&&r&&n&&i&&this.setDisplayArea(this.options.displayArea),!0}setInitialCamera(e){this.initialCamera=e}setFitToCanvasCamera(e){this.fitToCanvasCamera=e}getPan(e=this.initialCamera){if(!e)return[0,0];const r=this.getVtkActiveCamera().getFocalPoint(),i=this.canvasToWorld([0,0]),a=this.worldToCanvas(Dr([0,0,0],e.focalPoint,i)),o=this.worldToCanvas(Dr([0,0,0],r,i));return Ra([0,0],a,o)}getCurrentImageIdIndex(){throw new Error("Not implemented")}getSliceIndex(){throw new Error("Not implemented")}getImageData(){throw new Error("Not implemented")}getViewReferenceId(e){return null}setPan(e,n=!1){const r=this.getCamera(),{focalPoint:i,position:a}=r,o=this.canvasToWorld([0,0]),s=Ra([0,0],e,this.getPan());if(Math.abs(s[0])<1&&Math.abs(s[1])<1&&!n)return;const l=Dr(ct(),this.canvasToWorld(s),o),c=Dr(ct(),i,l),f=Dr(ct(),a,l);this.setCamera({...r,focalPoint:c,position:f},n)}getZoom(e=this.initialCamera){if(!e)return 1;const n=this.getVtkActiveCamera(),{parallelScale:r}=e;return r/n.getParallelScale()}setZoom(e,n=!1){const r=this.getCamera(),{parallelScale:i}=this.initialCamera,a=i/e;r.parallelScale===a&&!n||this.setCamera({...r,parallelScale:a},n)}_getFocalPointForViewPlaneReset(e){const{focalPoint:n,viewPlaneNormal:r}=this.getCamera(),i=this._getViewImageDataIntersections(e,n,r);let a=0,o=0,s=0;return i.forEach(([c,f,u])=>{a+=c,o+=f,s+=u}),[a/i.length,o/i.length,s/i.length]}getCanvas(){return this.canvas}getVtkActiveCamera(){const e=this.getRenderer();return e?e.getActiveCamera():(console.warn("No renderer found for the viewport"),null)}getCameraNoRotation(){const e=this.getVtkActiveCamera(),n=(s,l)=>s.some(c=>isNaN(c))?l:s,r=n([...e.getViewUp()],[0,1,0]),i=n([...e.getViewPlaneNormal()],[0,0,-1]),a=n([...e.getPosition()],[0,0,1]),o=n([...e.getFocalPoint()],[0,0,0]);return{viewUp:r,viewPlaneNormal:i,position:a,focalPoint:o,parallelProjection:e.getParallelProjection(),parallelScale:e.getParallelScale(),viewAngle:e.getViewAngle(),flipHorizontal:this.flipHorizontal,flipVertical:this.flipVertical}}getCamera(){return{...this.getCameraNoRotation(),rotation:this.getRotation()}}setCamera(e,n=!1){const r=this.getVtkActiveCamera(),i=this.getCamera(),a=Object.assign({},i,e),{viewUp:o,viewPlaneNormal:s,position:l,focalPoint:c,parallelScale:f,viewAngle:u,flipHorizontal:d,flipVertical:h,clippingRange:p}=e;if(d!==void 0){const y=d&&!this.flipHorizontal||!d&&this.flipHorizontal;y&&this.flip({flipHorizontal:y})}if(h!==void 0){const y=h&&!this.flipVertical||!h&&this.flipVertical;y&&this.flip({flipVertical:y})}o!==void 0&&r.setViewUp(o),s!==void 0&&r.setDirectionOfProjection(-s[0],-s[1],-s[2]),l!==void 0&&r.setPosition(...l),c!==void 0&&r.setFocalPoint(...c),f!==void 0&&r.setParallelScale(f),u!==void 0&&r.setViewAngle(u),p!==void 0&&r.setClippingRange(p);const g=i.focalPoint,m=i.viewUp;if(g&&c||m&&o){const y=r.getViewPlaneNormal(),v=r.getViewUp();let x=!1,w=!1;if(c){const S=[c[0]-g[0],c[1]-g[1],c[2]-g[2]];x=Math.abs(Hs.dot(S,y))>0}if(o&&(w=!fr(v,m)),x||w){const S=this.getDefaultActor();if(!S?.actor)return;Jo(S,"vtkActor")||this.updateClippingPlanesForActors(a),(Jo(S,"vtkImageSlice")||this.type===br.VOLUME_3D)&&this.getRenderer().resetCameraClippingRange()}}n&&this.setInitialCamera(a),this.triggerCameraModifiedEventIfNecessary(i,this.getCamera())}triggerCameraModifiedEventIfNecessary(e,n){if(!this._suppressCameraModifiedEvents&&!this.suppressEvents){const r={previousCamera:e,camera:n,element:this.element,viewportId:this.id,renderingEngineId:this.renderingEngineId};Ct(this.element,vt.CAMERA_MODIFIED,r)}}updateCameraClippingPlanesAndRange(){const e=this.getCamera();this.updateClippingPlanesForActors(e),this.getRenderer().resetCameraClippingRange()}async updateClippingPlanesForActors(e){this.getActors().map(r=>{if(!r.actor)return;const i=r.actor.getMapper();let a=r?.clippingFilter?r?.clippingFilter.getClippingPlanes():i.getClippingPlanes();a.length===0&&r?.clippingFilter&&(a=[Do.newInstance(),Do.newInstance()]);let o=Ci.MINIMUM_SLAB_THICKNESS;r.slabThickness&&(o=r.slabThickness);const{viewPlaneNormal:s,focalPoint:l}=e;this.setOrientationOfClippingPlanes(a,o,s,l),Ct(this.element,vt.CLIPPING_PLANES_UPDATED,{actorEntry:r,focalPoint:l,vtkPlanes:a,viewport:this})})}setOrientationOfClippingPlanes(e,n,r,i){if(e.length<2)return;const a=[r[0],r[1],r[2]];Hs.multiplyScalar(a,n),e[0].setNormal(r);const o=[0,0,0];Hs.subtract(i,a,o),e[0].setOrigin(o),e[1].setNormal(-r[0],-r[1],-r[2]);const s=[0,0,0];Hs.add(i,a,s),e[1].setOrigin(s)}getClippingPlanesForActor(e){if(e||(e=this.getDefaultActor()),!e.actor)throw new Error("Invalid actor entry: Actor is undefined");const n=e.actor.getMapper();let r=e?.clippingFilter?e?.clippingFilter.getClippingPlanes():n.getClippingPlanes();return r.length===0&&e?.clippingFilter&&(r=[Do.newInstance(),Do.newInstance()]),r}_getWorldDistanceViewUpAndViewRight(e,n,r){const i=this._getCorners(e),a=this._getCorners(e),o=dr(ct(),n,r);let s=Jd.buildFromDegree().identity().rotateFromDirections(n,[1,0,0]);i.forEach(d=>s.apply(d));let l=1/0,c=-1/0;for(let d=0;d<8;d++){const h=i[d][0];h>c&&(c=h),h<l&&(l=h)}s=Jd.buildFromDegree().identity().rotateFromDirections([o[0],o[1],o[2]],[1,0,0]),a.forEach(d=>s.apply(d));let f=1/0,u=-1/0;for(let d=0;d<8;d++){const h=a[d][0];h>u&&(u=h),h<f&&(f=h)}return{widthWorld:u-f,heightWorld:c-l}}getViewReference(e){const{focalPoint:n,viewPlaneNormal:r,viewUp:i}=this.getCamera(),a=this.getFrameOfReferenceUID(),o={FrameOfReferenceUID:a,cameraFocalPoint:n,viewPlaneNormal:r,viewUp:i,sliceIndex:e?.sliceIndex??this.getSliceIndex(),planeRestriction:{FrameOfReferenceUID:a,point:e?.points?.[0]||n,inPlaneVector1:i,inPlaneVector2:dr(ct(),i,r)}};return e?.points&&jY(e.points,o.planeRestriction),o}isPlaneViewable(e,n){if(e.FrameOfReferenceUID!==this.getFrameOfReferenceUID())return!1;const{focalPoint:r,viewPlaneNormal:i}=this.getCamera(),{point:a,inPlaneVector1:o,inPlaneVector2:s}=e;if(n?.withOrientation)return!0;if(o&&!fr(0,zt(i,o))||s&&!fr(0,zt(i,s)))return!1;if(n?.withNavigation)return!0;const l=ur(ct(),a,r);return fr(0,zt(l,i))}isReferenceViewable(e,n){if(e.planeRestriction)return this.isPlaneViewable(e.planeRestriction,n);if(e.FrameOfReferenceUID&&e.FrameOfReferenceUID!==this.getFrameOfReferenceUID())return!1;const{viewPlaneNormal:r}=e,i=this.getCamera();return r&&!fr(r,i.viewPlaneNormal)&&!fr(su(i.viewPlaneNormal,i.viewPlaneNormal),r)?n?.withOrientation:!0}getViewPresentation(e={rotation:!0,displayArea:!0,zoom:!0,pan:!0,flipHorizontal:!0,flipVertical:!0}){const n={},{rotation:r,displayArea:i,zoom:a,pan:o,flipHorizontal:s,flipVertical:l}=e;r&&(n.rotation=this.getRotation()),i&&(n.displayArea=this.getDisplayArea());const c=this.getZoom();return a&&(n.zoom=c),o&&(n.pan=this.getPan(),m6(n.pan,n.pan,1/c)),s&&(n.flipHorizontal=this.flipHorizontal),l&&(n.flipVertical=this.flipVertical),n}setViewReference(e){}setViewPresentation(e){if(!e)return;const{displayArea:n,zoom:r=this.getZoom(),pan:i,rotation:a,flipHorizontal:o=this.flipHorizontal,flipVertical:s=this.flipVertical}=e;n!==this.getDisplayArea()&&this.setDisplayArea(n),this.setZoom(r),i&&this.setPan(m6([0,0],i,r)),o!==void 0&&o!==this.flipHorizontal&&this.flip({flipHorizontal:o}),s!==void 0&&s!==this.flipVertical&&this.flip({flipVertical:s}),a>=0&&this.setRotation(a)}_getCorners(e){return[[e[0],e[2],e[4]],[e[0],e[2],e[5]],[e[0],e[3],e[4]],[e[0],e[3],e[5]],[e[1],e[2],e[4]],[e[1],e[2],e[5]],[e[1],e[3],e[4]],[e[1],e[3],e[5]]]}_getFocalPointForResetCamera(e,n,{resetPan:r=!0,resetToCenter:i=!0}){if(i&&r)return e;if(i&&!r)return A6(n.focalPoint)?e:n.focalPoint;if(!i&&r){const a=n,o=a.focalPoint,s=a.viewPlaneNormal,l=Dr(ct(),e,o),c=zt(l,s),f=Or(ct(),e,s,-1*c);return[f[0],f[1],f[2]]}if(!r&&!i)return A6(n.focalPoint)?e:n.focalPoint}_isInBounds(e,n){const[r,i,a,o,s,l]=n,[c,f,u]=e;return!(c<r||c>i||f<a||f>o||u<s||u>l)}_getEdges(e){const[n,r,i,a,o,s,l,c]=this._getCorners(e);return[[n,r],[n,o],[n,i],[r,a],[r,s],[i,a],[i,l],[a,c],[o,l],[o,s],[s,c],[l,c]]}static boundsRadius(e){const n=(e[1]-e[0])**2,r=(e[3]-e[2])**2,i=(e[5]-e[4])**2;return Math.sqrt(n+r+i||1)*.5}setDataIds(e,n){throw new Error("Unsupported operatoin setDataIds")}};Kv.CameraViewPresentation={rotation:!0,pan:!0,zoom:!0,displayArea:!0},Kv.TransferViewPresentation={windowLevel:!0,paletteLut:!0};let Qh=Kv;function zY(t,e,n=!1){const r=t.getCamera(),{focalPoint:i,viewPlaneNormal:a}=r,{spacingInNormalDirection:o,actorUID:s}=ly(t,r,e,n);if(!s)throw new Error(`Could not find image volume with id ${e} in the viewport`);const l=t.getActor(s);if(!l)return console.warn("No actor found for with actorUID of",s),null;const c=l.actor;return{sliceRange:iC(c,a,i),spacingInNormalDirection:o,camera:r}}function qg(t,e,n=!1){const{sliceRange:r,spacingInNormalDirection:i,camera:a}=zY(t,e,n),{min:o,max:s,current:l}=r,c=Math.round((s-o)/i),u=(l-o)/(s-o)*c,d=Math.round(u);return{numScrollSteps:c,currentStepIndex:d,sliceRangeInfo:{sliceRange:r,spacingInNormalDirection:i,camera:a}}}function Xg(t,e,n,r,i,a){const{min:o,max:s,current:l}=n,c=ct();ur(c,e,t);const f=Math.round((s-o)/i),d=(l-o)/(s-o)*f;let h=Math.round(d),p=[t[0]-r[0]*d*i,t[1]-r[1]*d*i,t[2]-r[2]*d*i];h+=a,h>f?h=f:h<0&&(h=0);const g=h*i;p=[p[0]+r[0]*g,p[1]+r[1]*g,p[2]+r[2]*g];const m=[p[0]+c[0],p[1]+c[1],p[2]+c[2]];return{newFocalPoint:p,newPosition:m}}function WY(t){let e=[];const[n,r]=t.getRange();t.getTable(n,r,1024,e),e=e.filter((h,p)=>p%3===0);const i=[...Array(1024).keys()].map((h,p)=>n+(r-n)/1023*p),a=e[256],o=Math.log((1-a)/a),s=i[256],l=e[256*3],c=Math.log((1-l)/l),f=i[256*3],u=Math.round(4*(f-s)/(o-c)),d=Math.round(s+u*o/4);return[Math.round(d-u/2),Math.round(d+u/2)]}function HY(t,e){const n=e.colorTransfer.split(" ").splice(1).map(parseFloat),{shiftRange:r}=r6e(n),i=r[0],a=r[1]-r[0],o=Lf.newInstance(),s=[];for(let w=0;w<n.length;w+=4){let S=n[w];const T=n[w+1],_=n[w+2],D=n[w+3];S=(S-i)/a,s.push([S,T,_,D])}i6e(s,r,o),t.getProperty().setRGBTransferFunction(0,o);const l=e.scalarOpacity.split(" ").splice(1).map(parseFloat),c=Xh.newInstance(),f=[];for(let w=0;w<l.length;w+=2){let S=l[w];const T=l[w+1];S=(S-i)/a,f.push([S,T])}a6e(f,r,c);const u=t.getProperty();u.setScalarOpacity(0,c);const[d,h,p,g]=e.gradientOpacity.split(" ").splice(1).map(parseFloat);u.setUseGradientOpacity(0,!0),u.setGradientOpacityMinimumValue(0,d),u.setGradientOpacityMinimumOpacity(0,h),u.setGradientOpacityMaximumValue(0,p),u.setGradientOpacityMaximumOpacity(0,g),e.interpolation==="1"&&u.setInterpolationTypeToFastLinear(),u.setShade(e.shade==="1");const m=parseFloat(e.ambient),y=parseFloat(e.diffuse),v=parseFloat(e.specular),x=parseFloat(e.specularPower);u.setAmbient(m),u.setDiffuse(y),u.setSpecular(v),u.setSpecularPower(x)}function r6e(t){let e=1/0,n=-1/0;for(let i=0;i<t.length;i+=4)e=Math.min(e,t[i]),n=Math.max(n,t[i]);const r=(n-e)/2;return{shiftRange:[-r,r],min:e,max:n}}function i6e(t,e,n){const r=e[1]-e[0],i=t.map(([a,o,s,l])=>[a*r+e[0],o,s,l]);return n.removeAllPoints(),i.forEach(([a,o,s,l])=>n.addRGBPoint(a,o,s,l)),i}function a6e(t,e,n){const r=e[1]-e[0],i=t.map(([a,o])=>[a*r+e[0],o]);return n.removeAllPoints(),i.forEach(([a,o])=>n.addPoint(a,o)),i}const{MPR_CAMERA_VALUES:Gs}=cp,{OrientationAxis:df}=nl;function KY(t,e,n,r){let i;switch(r){case df.AXIAL:case df.AXIAL_REFORMAT:i=Gs.axial;break;case df.SAGITTAL:case df.SAGITTAL_REFORMAT:i=Gs.sagittal;break;case df.CORONAL:case df.CORONAL_REFORMAT:i=Gs.coronal;break;default:i=Gs.axial;break}const a=Ir(ct(),t),o=Ir(ct(),e),s=Ir(ct(),n),l=[a,o,s],c=[En(i.viewRight[0],i.viewRight[1],i.viewRight[2]),En(i.viewUp[0],i.viewUp[1],i.viewUp[2]),En(i.viewPlaneNormal[0],i.viewPlaneNormal[1],i.viewPlaneNormal[2])],f=new Set,u=g=>{let m=0,y=-2,v=!1;l.forEach((w,S)=>{if(f.has(S))return;const T=zt(g,w),_=Math.abs(T);_>y&&(y=_,m=S,v=T<0)}),f.add(m);const x=rK(l[m]);return v&&su(x,x),x},d=u(c[0]),h=u(c[1]),p=u(c[2]);return{viewPlaneNormal:[p[0],p[1],p[2]],viewUp:[h[0],h[1],h[2]],viewRight:[d[0],d[1],d[2]]}}function qY(t,e){if(!t.getActors()?.length)return;t.type!==br.ORTHOGRAPHIC&&console.warn("Viewport should be a volume viewport");let n=t.getCurrentImageId();if(n||(n=t.getImageIds()?.[0]),!n)return;const{imageOrientationPatient:r}=Ft("imagePlaneModule",n),i=En(r[0],r[1],r[2]),a=En(r[3],r[4],r[5]),o=dr(ct(),i,a);let{orientation:s}=e||{};const{useViewportNormal:l}=e||{};let c=o;return l&&(c=t.getCamera().viewPlaneNormal),s||(s=o6e(c)),KY(i,a,o,s)}function o6e(t){const e=Ir(ct(),t),n=En(Gs.axial.viewPlaneNormal[0],Gs.axial.viewPlaneNormal[1],Gs.axial.viewPlaneNormal[2]),r=En(Gs.sagittal.viewPlaneNormal[0],Gs.sagittal.viewPlaneNormal[1],Gs.sagittal.viewPlaneNormal[2]),i=En(Gs.coronal.viewPlaneNormal[0],Gs.coronal.viewPlaneNormal[1],Gs.coronal.viewPlaneNormal[2]),a=Math.abs(zt(e,n)),o=Math.abs(zt(e,r)),s=Math.abs(zt(e,i));return a>=o&&a>=s?df.AXIAL:o>=s?df.SAGITTAL:df.CORONAL}function XY(){return Pf()?.rendering?.renderingEngineMode===Hh.ContextPool}class lo extends Qh{constructor(e){if(super(e),this.useCPURendering=!1,this.perVolumeIdDefaultProperties=new Map,this.viewportProperties={},this.volumeIds=new Set,this.setRotation=i=>{const a=this.getPan(this.fitToCanvasCamera),o=this.getPan(),s=this.getCamera(),l=Yh([0,0],a,o);this.setPan(l,!1);const{flipVertical:c}=this.getCamera(),f=c?su([0,0,0],this.initialViewUp):this.initialViewUp;this.setCameraNoEvent({viewUp:f}),this.rotateCamera(i);const u=this.getPan(),d=this.getPan(this.fitToCanvasCamera),h=Yh([0,0],u,d),p=jw([0,0],a,h);if(this.setPan(p,!1),this._suppressCameraModifiedEvents)return;const g=this.getCamera(),m={previousCamera:s,camera:g,element:this.element,viewportId:this.id,renderingEngineId:this.renderingEngineId};Ct(this.element,vt.CAMERA_MODIFIED,m)},this.getDefaultProperties=i=>{let a;return i!==void 0&&(a=this.perVolumeIdDefaultProperties.get(i)),a!==void 0?a:{...this.globalDefaultProperties}},this.getProperties=i=>{if(!this._getApplicableVolumeActor(i))return;const{colormap:o,VOILUTFunction:s,interpolationType:l,invert:c,slabThickness:f,preset:u}=this.viewportProperties;if(i||=this.getVolumeId(),!yt.getVolume(i))return null;const h=this.getActors().find(S=>S.referencedId===i);if(!h)return;const g=h.actor.getProperty().getRGBTransferFunction(0),[m,y]=this.viewportProperties?.VOILUTFunction==="SIGMOID"?WY(g):g.getRange(),v={lower:m,upper:y},x=this.getColormap(i);return{colormap:i&&x?x:o,voiRange:v,VOILUTFunction:s,interpolationType:l,invert:c,slabThickness:f,preset:u}},this.getColormap=i=>{const a=this._getApplicableVolumeActor(i);if(!a)return;const{volumeActor:o}=a,s=this._getOrCreateColorTransferFunction(i),{nodes:l}=s.getState(),c=l.reduce((h,p)=>(h.push(p.x,p.r,p.g,p.b),h),[]),f=j9(c,o)||{},u=W9(o),d=H9(o);return f.threshold=u,f.opacity=d,f},this.getRotation=()=>{const{viewUp:i,viewPlaneNormal:a,flipVertical:o}=this.getCameraNoRotation(),s=o?su([0,0,0],this.initialViewUp):this.initialViewUp;if(!s)return 0;const l=aK(s,i)*180/Math.PI,c=dr([0,0,0],s,i);return zt(c,a)>=0?l:(360-l)%360},this.getFrameOfReferenceUID=()=>this._FrameOfReferenceUID,this.canvasToWorldTiled=i=>{const a=this.getVtkActiveCamera();a.setIsPerformingCoordinateTransformation?.(!0);const o=this.getRenderer(),s=this.getVtkDisplayCoordsTiled(i),f=this.getRenderingEngine().offscreenMultiRenderWindow.getOpenGLRenderWindow().displayToWorld(s[0],s[1],s[2],o);return a.setIsPerformingCoordinateTransformation?.(!1),[f[0],f[1],f[2]]},this.canvasToWorldContextPool=i=>{const a=this.getVtkActiveCamera();a.setIsPerformingCoordinateTransformation?.(!0);const o=this.getRenderer(),s=window.devicePixelRatio||1,{width:l,height:c}=this.canvas,f=l/c,u=[i[0]*s,i[1]*s],d=[u[0]/l,1-u[1]/c,0],h=o.normalizedDisplayToProjection(d[0],d[1],d[2]),p=o.projectionToView(h[0],h[1],h[2],f),g=o.viewToWorld(p[0],p[1],p[2]);return a.setIsPerformingCoordinateTransformation?.(!1),[g[0],g[1],g[2]]},this.getVtkDisplayCoordsTiled=i=>{const a=window.devicePixelRatio||1,o=[i[0]*a,i[1]*a],c=this.getRenderingEngine().offscreenMultiRenderWindow.getOpenGLRenderWindow().getSize(),f=[o[0]+this.sx,o[1]+this.sy];return f[1]=c[1]-f[1],[f[0],f[1],0]},this.getVtkDisplayCoordsContextPool=i=>{const a=window.devicePixelRatio||1,o=[i[0]*a,i[1]*a],{height:s}=this.canvas,l=[o[0],s-o[1]];return[l[0],l[1],0]},this.worldToCanvasTiled=i=>{const a=this.getVtkActiveCamera();a.setIsPerformingCoordinateTransformation?.(!0);const o=this.getRenderer(),l=this.getRenderingEngine().offscreenMultiRenderWindow.getOpenGLRenderWindow(),c=l.getSize(),f=l.worldToDisplay(...i,o);f[1]=c[1]-f[1];const u=[f[0]-this.sx,f[1]-this.sy],d=window.devicePixelRatio||1,h=[u[0]/d,u[1]/d];return a.setIsPerformingCoordinateTransformation(!1),h},this.worldToCanvasContextPool=i=>{const a=this.getVtkActiveCamera();a.setIsPerformingCoordinateTransformation?.(!0);const o=this.getRenderer(),{width:s,height:l}=this.canvas,c=s/l,f=o.worldToView(i[0],i[1],i[2]),u=o.viewToProjection(f[0],f[1],f[2],c),d=o.projectionToNormalizedDisplay(u[0],u[1],u[2]),h=d[0]*s,p=(1-d[1])*l,g=window.devicePixelRatio||1,m=[h/g,p/g];return a.setIsPerformingCoordinateTransformation(!1),m},this.hasImageURI=i=>this.getActors().filter(o=>Jo(o,"vtkVolume")).some(({uid:o,referencedId:s})=>{const l=yt.getVolume(s||o);return l?.getImageIdIndex?l.getImageIdIndex(i)!==void 0||l.getImageURIIndex(i)!==void 0:!1}),this.getImageIds=i=>{const a=this._getApplicableVolumeActor(i);if(!a)throw new Error(`No actor found for the given volumeId: ${i}`);const o=a.volumeId,s=yt.getVolume(o);if(!s)throw new Error(`imageVolume with id: ${o} does not exist in cache`);return s.imageIds},this.renderingPipelineFunctions={worldToCanvas:{tiled:this.worldToCanvasTiled,contextPool:this.worldToCanvasContextPool},canvasToWorld:{tiled:this.canvasToWorldTiled,contextPool:this.canvasToWorldContextPool},getVtkDisplayCoords:{tiled:this.getVtkDisplayCoordsTiled,contextPool:this.getVtkDisplayCoordsContextPool},getRenderer:{tiled:this.getRendererTiled,contextPool:this.getRendererContextPool}},this.useCPURendering=Bg(),this.useCPURendering)throw new Error("VolumeViewports cannot be used whilst CPU Fallback Rendering is enabled.");this._configureRenderingPipeline();const n=this.getRenderer(),r=mEe.newInstance();switch(n.setActiveCamera(r),this.type){case br.ORTHOGRAPHIC:r.setParallelProjection(!0);break;case br.VOLUME_3D:r.setParallelProjection(!0);break;case br.PERSPECTIVE:r.setParallelProjection(!1);break;default:throw new Error(`Unrecognized viewport type: ${this.type}`)}this.initializeVolumeNewImageEventDispatcher()}static get useCustomRenderingPipeline(){return!1}getSliceViewInfo(){throw new Error("Method not implemented.")}applyViewOrientation(e,n=!0){const{viewPlaneNormal:r,viewUp:i}=this._getOrientationVectors(e)||{};if(!r||!i)return;const a=this.getVtkActiveCamera();a.setDirectionOfProjection(-r[0],-r[1],-r[2]),a.setViewUpFrom(i),this.initialViewUp=i,n&&this.resetCamera({resetOrientation:!1,resetRotation:!1})}initializeVolumeNewImageEventDispatcher(){const e=r.bind(this),n=i.bind(this);function r(a){const{viewportId:o}=a.detail;o!==this.id||this.isDisabled||!this.getImageData()||ZEe(a)}function i(a){const{viewportId:o}=a.detail;o===this.id&&(this.element.removeEventListener(vt.CAMERA_MODIFIED,e),St.removeEventListener(vt.ELEMENT_DISABLED,n),JEe(o))}this.element.removeEventListener(vt.CAMERA_MODIFIED,e),this.element.addEventListener(vt.CAMERA_MODIFIED,e),St.addEventListener(vt.ELEMENT_DISABLED,n)}setVOILUTFunction(e,n,r){Object.values(oo).includes(e)||(e=oo.LINEAR);const{voiRange:i}=this.getProperties();this.setVOI(i,n,r),this.viewportProperties.VOILUTFunction=e}setColormap(e,n,r){const i=this._getApplicableVolumeActor(n);if(!i)return;const{volumeActor:a}=i,o=Lf.newInstance();let s=y2(e.name);const{name:l}=e;if(s||(s=m2.getPresetByName(l)),!s)throw new Error(`Colormap ${e} not found`);const c=a.getProperty().getRGBTransferFunction(0).getRange();if(o.applyColorMap(s),o.setMappingRange(c[0],c[1]),a.getProperty().setRGBTransferFunction(0,o),this.viewportProperties.colormap=e,!r){const f=this.getColormap(n),u={viewportId:this.id,colormap:f,volumeId:n};Ct(this.element,vt.VOI_MODIFIED,u),Ct(this.element,vt.COLORMAP_MODIFIED,u)}}setOpacity(e,n){const r=this._getApplicableVolumeActor(n);if(!r)return;const{volumeActor:i}=r,a=Xh.newInstance();typeof e.opacity=="number"?dK(i,e.opacity):(e.opacity.forEach(({opacity:l,value:c})=>{a.addPoint(c,l)}),i.getProperty().setScalarOpacity(0,a)),this.viewportProperties.colormap||(this.viewportProperties.colormap={}),this.viewportProperties.colormap.opacity=e.opacity;const o=this.getColormap(n),s={viewportId:this.id,colormap:o,volumeId:n};Ct(this.element,vt.COLORMAP_MODIFIED,s)}setInvert(e,n,r){const i=this._getApplicableVolumeActor(n);if(!i)return;const a=i.volumeId,o=this._getOrCreateColorTransferFunction(a);if(Lv(o),this.viewportProperties.invert=e,!r){const s={...this.getVOIModifiedEventDetail(a),invertStateChanged:!0};Ct(this.element,vt.VOI_MODIFIED,s)}}getVOIModifiedEventDetail(e){const n=this._getApplicableVolumeActor(e);if(!n)throw new Error(`No actor found for the given volumeId: ${e}`);const a=n.volumeActor.getProperty().getRGBTransferFunction(0).getMappingRange(),o=this.getColormap(e),{VOILUTFunction:s,invert:l}=this.getProperties(e);return{viewportId:this.id,range:{lower:a[0],upper:a[1]},volumeId:n.volumeId,VOILUTFunction:s,colormap:o,invert:l}}_getOrCreateColorTransferFunction(e){const n=this._getApplicableVolumeActor(e);if(!n)return null;const{volumeActor:r}=n,i=r.getProperty().getRGBTransferFunction(0);if(i)return i;const a=Lf.newInstance();return r.getProperty().setRGBTransferFunction(0,a),a}setInterpolationType(e,n){const r=this._getApplicableVolumeActor(n);if(!r)return;const{volumeActor:i}=r;i.getProperty().setInterpolationType(e),this.viewportProperties.interpolationType=e}setVOI(e,n,r=!1){const i=this._getApplicableVolumeActor(n);if(!i)return;const{volumeActor:a}=i,o=i.volumeId,s=e;if(typeof s>"u")throw new Error("voiRangeToUse is undefined, need to implement this in the new volume model");const{VOILUTFunction:l}=this.getProperties(o);if(l===oo.SAMPLED_SIGMOID){const c=K9(s);a.getProperty().setRGBTransferFunction(0,c)}else{const{lower:c,upper:f}=s;a.getProperty().getRGBTransferFunction(0).setRange(c,f)}if(!r){const c={...this.getVOIModifiedEventDetail(o)};Ct(this.element,vt.VOI_MODIFIED,c)}this.viewportProperties.voiRange=s}rotateCamera(e){const n=e-this.getRotation();this.getVtkActiveCamera().roll(-n)}setDefaultProperties(e,n){n==null?this.globalDefaultProperties=e:this.perVolumeIdDefaultProperties.set(n,e)}clearDefaultProperties(e){e==null?(this.globalDefaultProperties={},this.resetProperties()):(this.perVolumeIdDefaultProperties.delete(e),this.resetToDefaultProperties(e))}getViewReference(e={}){const n=super.getViewReference(e),r=this.getVolumeId(e);if(e?.forFrameOfReference!==!1&&(n.volumeId=r),typeof e?.sliceIndex!="number")return n;const{viewPlaneNormal:i}=n,a=e?.sliceIndex-this.getSliceIndex(),{sliceRangeInfo:o}=qg(this,r,!0),{sliceRange:s,spacingInNormalDirection:l,camera:c}=o,{focalPoint:f,position:u}=c,{newFocalPoint:d}=Xg(f,u,s,i,l,a);return n.cameraFocalPoint=d,n}isReferenceViewable(e,n){if(!e.FrameOfReferenceUID||!super.isReferenceViewable(e,n))return!1;if(n?.withNavigation){const{referencedImageId:a}=e;return!a||this.hasImageURI(a)}const r=this.getSliceIndex(),{sliceIndex:i}=e;return Array.isArray(i)?i[0]<=r&&r<=i[1]:i===void 0||i===r}scroll(e=1){const n=this.getVolumeId(),{sliceRangeInfo:r}=qg(this,n,!0);if(!r)return;const{sliceRange:i,spacingInNormalDirection:a,camera:o}=r,{focalPoint:s,viewPlaneNormal:l,position:c}=o,{newFocalPoint:f,newPosition:u}=Xg(s,c,i,l,a,e);this.setCamera({focalPoint:f,position:u}),this.render()}setBestOrentation(e,n){if(!e&&!n)return;const{viewPlaneNormal:r}=this.getCamera();if(tg(r,n)&&tg(r,e))return;const i=this._getAcquisitionPlaneOrientation();if(tg(i.viewPlaneNormal,n)&&tg(i.viewPlaneNormal,e)){this.setOrientation(i);return}for(const o of Object.values(wf))if(tg(o.viewPlaneNormal,n)&&tg(o.viewPlaneNormal,e)){this.setOrientation(o);return}const a=dr(ct(),n||i.viewPlaneNormal,e);Ir(a,a),this.setOrientation({viewPlaneNormal:a})}setViewPlane(e){const{point:n,inPlaneVector1:r,inPlaneVector2:i,FrameOfReferenceUID:a}=e;this.setBestOrentation(r,i),this.setViewReference({FrameOfReferenceUID:a,cameraFocalPoint:n,viewPlaneNormal:this.getCamera().viewPlaneNormal})}setViewReference(e){if(!e)return;const n=this.getVolumeId(),{FrameOfReferenceUID:r,cameraFocalPoint:i,referencedImageId:a,planeRestriction:o,viewPlaneNormal:s,viewUp:l}=e;let{sliceIndex:c}=e;if(o&&!s)return this.setViewPlane(o);const{focalPoint:f,viewPlaneNormal:u,position:d}=this.getCamera(),h=uK(u,s),p=fr(u,s);if(typeof c=="number"&&n!==void 0&&e.volumeId===n&&(h||p)){const{currentStepIndex:g,sliceRangeInfo:m,numScrollSteps:y}=qg(this,n,!0),{sliceRange:v,spacingInNormalDirection:x}=m;h&&(c=y-c-1);const w=c-g,{newFocalPoint:S,newPosition:T}=Xg(f,d,v,u,x,w);this.setCamera({focalPoint:S,position:T})}else if(r===this.getFrameOfReferenceUID()){if(s&&!h&&!p){this.setOrientation({viewPlaneNormal:s,viewUp:l}),this.setViewReference(e);return}if(a&&this.isInAcquisitionPlane()){const g=Ft(Yo.IMAGE_PLANE,a),{imagePositionPatient:m}=g,{focalPoint:y}=this.getCamera(),v=Dr(ct(),y,m),x=zt(v,u),w=Or(ct(),y,[-u[0],-u[1],-u[2]],x);this.setCamera({focalPoint:w}),this.render();return}if(i){const g=Dr([0,0,0],i,f),m=s??u,y=zt(g,m);fr(y,0)||Xs(g,m,y);const v=Nl([0,0,0],f,g),x=Nl([0,0,0],d,g);this.setCamera({focalPoint:v,position:x})}}else throw new Error(`Incompatible view refs: ${r}!==${this.getFrameOfReferenceUID()}`)}setThreshold(e,n){const r=this._getApplicableVolumeActor(n);if(!r)return;const{volumeActor:i}=r;hK(i,e.threshold),this.viewportProperties.colormap||(this.viewportProperties.colormap={}),this.viewportProperties.colormap.threshold=e.threshold;const a=this.getColormap(n),o={viewportId:this.id,colormap:a,volumeId:n};Ct(this.element,vt.COLORMAP_MODIFIED,o)}setProperties({voiRange:e,VOILUTFunction:n,invert:r,colormap:i,preset:a,interpolationType:o,slabThickness:s,sampleDistanceMultiplier:l}={},c,f=!1){this.globalDefaultProperties==null&&this.setDefaultProperties({voiRange:e,VOILUTFunction:n,invert:r,colormap:i,preset:a,slabThickness:s}),r!==void 0&&this.viewportProperties.invert!==r&&this.setInvert(r,c,f),i?.name&&this.setColormap(i,c,f),i?.opacity!=null&&this.setOpacity(i,c),i?.threshold!=null&&this.setThreshold(i,c),e!==void 0&&this.setVOI(e,c,f),typeof o<"u"&&this.setInterpolationType(o),n!==void 0&&this.setVOILUTFunction(n,c,f),a!==void 0&&this.setPreset(a,c,f),s!==void 0&&this.setSlabThickness(s),l!==void 0&&this.setSampleDistanceMultiplier(l)}resetToDefaultProperties(e){const n=this.globalDefaultProperties;n.colormap?.name&&this.setColormap(n.colormap,e),n.colormap?.opacity!=null&&this.setOpacity(n.colormap,e),n.voiRange!==void 0&&this.setVOI(n.voiRange,e),n.VOILUTFunction!==void 0&&this.setVOILUTFunction(n.VOILUTFunction,e),n.invert!==void 0&&this.setInvert(n.invert,e),n.slabThickness!==void 0&&(this.setSlabThickness(n.slabThickness),this.viewportProperties.slabThickness=n.slabThickness),n.sampleDistanceMultiplier!==void 0&&this.setSampleDistanceMultiplier(n.sampleDistanceMultiplier),n.preset!==void 0&&this.setPreset(n.preset,e,!1),this.render()}setPreset(e,n,r){const i=this._getApplicableVolumeActor(n);if(!i)return;const{volumeActor:a}=i;let o=e;typeof o=="string"&&(o=LW.find(s=>s.name===e)),o&&(HY(a,o),this.viewportProperties.preset=o,this.render(),r||Ct(this.element,vt.PRESET_MODIFIED,{viewportId:this.id,volumeId:i.volumeId,actor:a,presetName:o.name}))}setSampleDistanceMultiplier(e){}async setVolumes(e,n=!1,r=!1){const i=e[0].volumeId,a=yt.getVolume(i);if(!a)throw new Error(`imageVolume with id: ${i} does not exist, you need to create/allocate the volume first`);const o=a.metadata.FrameOfReferenceUID;this._isValidVolumeInputArray(e,o),this._FrameOfReferenceUID=o,e.forEach(l=>{this._addVolumeId(l.volumeId)});const s=[];for(let l=0;l<e.length;l++){const{volumeId:c,actorUID:f,slabThickness:u,...d}=e[l],h=await _3(e[l],this.element,this.id,r),p=f||or();s.push({uid:p,actor:h,slabThickness:u,referencedId:c,...d})}this._setVolumeActors(s),this.viewportStatus=So.PRE_RENDER,this.initializeColorTransferFunction(e),Ct(this.element,vt.VOLUME_VIEWPORT_NEW_VOLUME,{viewportId:this.id,volumeActors:s}),n&&this.render()}async addVolumes(e,n=!1,r=!1){const i=yt.getVolume(e[0].volumeId);if(!i)throw new Error(`imageVolume with id: ${i.volumeId} does not exist`);const a=[];this._isValidVolumeInputArray(e,this._FrameOfReferenceUID),e.forEach(o=>{this._addVolumeId(o.volumeId)});for(let o=0;o<e.length;o++){const{volumeId:s,visibility:l,actorUID:c,slabThickness:f,...u}=e[o],d=await _3(e[o],this.element,this.id,r);l||d.setVisibility(!1);const h=c||or();a.push({uid:h,actor:d,slabThickness:f,referencedId:s,...u})}this.addActors(a),this.initializeColorTransferFunction(e),n&&this.render()}removeVolumeActors(e,n=!1){this.removeActors(e),n&&this.render()}setOrientation(e,n=!0){console.warn('Method "setOrientation" needs implementation')}initializeColorTransferFunction(e){const n=e[0].volumeId,r=this._getOrCreateColorTransferFunction(n);!this.initialTransferFunctionNodes&&r&&(this.initialTransferFunctionNodes=u3(r))}_getApplicableVolumeActor(e){const n=this.getActors();if(!n?.length)return;if(e){const i=n.find(a=>a.referencedId===e);return i?{volumeActor:i.actor,volumeId:e,actorUID:i.uid}:void 0}const r=n[0];return{volumeActor:r.actor,volumeId:r.referencedId,actorUID:r.uid}}async _isValidVolumeInputArray(e,n){const r=e.length;for(let i=1;i<r;i++){const a=yt.getVolume(e[i].volumeId);if(n!==a.metadata.FrameOfReferenceUID)throw new Error(`Volumes being added to viewport ${this.id} do not share the same FrameOfReferenceUID. This is not yet supported`)}return!0}getBounds(){return this.getRenderer().computeVisiblePropBounds()}flip(e){super.flip(e)}hasVolumeId(e){return this.volumeIds.has(e)}hasVolumeURI(e){for(const n of this.volumeIds)if(n.includes(e))return!0;return!1}getImageData(e){if(!this.getDefaultActor())return;e||=this.getVolumeId();const r=this.getActors()?.find(s=>s.referencedId===e);if(!Jo(r,"vtkVolume"))return;const i=r.actor,a=yt.getVolume(e),o=i.getMapper().getInputData();return{dimensions:o.getDimensions(),spacing:o.getSpacing(),origin:o.getOrigin(),direction:o.getDirection(),imageData:i.getMapper().getInputData(),metadata:{Modality:a?.metadata?.Modality,FrameOfReferenceUID:a?.metadata?.FrameOfReferenceUID},get scalarData(){return a?.voxelManager?.getScalarData()},scaling:a?.scaling,hasPixelSpacing:!0,voxelManager:a?.voxelManager}}setCameraClippingRange(){throw new Error("Method not implemented.")}getSliceIndex(){throw new Error("Method not implemented.")}setCamera(e,n){super.setCamera(e,n),this.setCameraClippingRange()}_setVolumeActors(e){for(let n=0;n<e.length;n++)this.viewportProperties.invert=!1;this.setActors(e)}getRendererContextPool(){return this.getRenderingEngine().getRenderer(this.id)}getRendererTiled(){const e=this.getRenderingEngine();if(!e||e.hasBeenDestroyed)throw new Error("Rendering engine has been destroyed");return e.offscreenMultiRenderWindow?.getRenderer(this.id)}_getViewUp(e){const{viewUp:n}=this.getCamera(),r=zt(n,e);if(fr(r,0))return n;if(lb(e[0],1))return[0,0,1];if(lb(e[1],1))return[0,0,1];if(lb(e[2],1))return[0,-1,0];const i=Or(ct(),n,e,-r);return Ir(i,i),i}_getOrientationVectors(e){if(typeof e=="object"){if(e.viewPlaneNormal)return{...e,viewUp:e.viewUp||this._getViewUp(e.viewPlaneNormal)};throw new Error("Invalid orientation object. It must contain viewPlaneNormal")}else if(typeof e=="string"){if(e==="acquisition")return this._getAcquisitionPlaneOrientation();if(e==="reformat"||e.includes("_reformat"))return qY(this,{useViewportNormal:!0});if(wf[e])return this.viewportProperties.orientation=e,wf[e]}throw new Error(`Invalid orientation: ${e}. Valid orientations are: ${Object.keys(wf).join(", ")}`)}_getAcquisitionPlaneOrientation(){if(!this.getDefaultActor())return;const n=this.getVolumeId(),r=yt.getVolume(n);if(!r)throw new Error(`imageVolume with id: ${n} does not exist in cache`);const{direction:i}=r,a=i.slice(6,9).map(s=>-s),o=i.slice(3,6).map(s=>-s);return{viewPlaneNormal:a,viewUp:o}}getSlabThickness(){const e=this.getActors();let n=Ci.MINIMUM_SLAB_THICKNESS;return e.forEach(r=>{r.slabThickness>n&&(n=r.slabThickness)}),n}getIntensityFromWorld(e){const n=this.getDefaultActor();if(!Jo(n,"vtkVolume"))return;const{actor:r}=n,i=r.getMapper().getInputData(),a=yt.getVolume(this.getVolumeId()),o=io(i,e);return a.voxelManager.getAtIJKPoint(o)}getVolumeId(e){const n=this.getActors();if(!n)return;if(!e?.volumeId){const i=n.find(a=>a.actor.getClassName()==="vtkVolume");return i?.referencedId||i?.uid}const r=n.find(i=>i.actor.getClassName()==="vtkVolume"&&i.referencedId===e?.volumeId);return r?.referencedId||r?.uid}getViewReferenceId(e={}){let{volumeId:n,sliceIndex:r}=e;if(!n){const c=this.getActors();if(!c)return;n=c.find(f=>f.actor.getClassName()==="vtkVolume")?.referencedId}const i=this.getSliceIndex();r??=i;const{viewPlaneNormal:a,focalPoint:o}=this.getCamera(),s=n.includes("?")?"&":"?",l=a.map(c=>c.toFixed(3)).join(",");return`volumeId:${n}${s}sliceIndex=${r}&viewPlaneNormal=${l}`}_addVolumeId(e){this.volumeIds.add(e)}getAllVolumeIds(){return Array.from(this.volumeIds)}_configureRenderingPipeline(){const e=XY();for(const n in this.renderingPipelineFunctions)if(Object.prototype.hasOwnProperty.call(this.renderingPipelineFunctions,n)){const r=this.renderingPipelineFunctions[n];this[n]=e?r.contextPool:r.tiled}}}function tg(t,e){return!e||fr(zt(t,e),0)}function s6e(t,e){e.classHierarchy.push("vtkAbstractImageMapper"),t.getIsOpaque=()=>!0,t.getCurrentImage=()=>null,t.getBoundsForSlice=()=>(le.vtkErrorMacro("vtkAbstractImageMapper.getBoundsForSlice - NOT IMPLEMENTED"),d0())}const l6e={slice:0,customDisplayExtent:[0,0,0,0,0,0],useCustomExtents:!1,backgroundColor:[0,0,0,1]};function c6e(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,l6e,n),SD.extend(t,e,n),le.setGet(t,e,["slice","useCustomExtents"]),le.setGetArray(t,e,["customDisplayExtent"],6),le.setGetArray(t,e,["backgroundColor"],4),s6e(t,e)}var u6e={extend:c6e};function YY(t,e,n){const r=n.getCurrentImage(),i=r.getExtent(),a=[i[0],i[2],i[4]],{ijkMode:o}=n.getClosestIJKAxis();let s=n.isA("vtkImageArrayMapper")?n.getSubSlice():n.getSlice();o!==n.getSlicingMode()&&(s=n.getSliceAtPosition(s)),a[o]+=s;const l=[0,0,0];r.indexToWorld(a,l),a[o]+=1;const c=[0,0,0];r.indexToWorld(a,c),c[0]-=l[0],c[1]-=l[1],c[2]-=l[2],mc(c,c);const f=Do.intersectWithLine(t,e,l,c);if(f.intersection){const u=f.x,d=[0,0,0];return r.worldToIndex(u,d),{t:f.t,absoluteIJK:d}}return null}function f6e(t,e,n){const r=YY(t,e,n);if(r){const a=n.getCurrentImage().getExtent(),o=[Math.round(r.absoluteIJK[0]),Math.round(r.absoluteIJK[1]),Math.round(r.absoluteIJK[2])];return o[0]<a[0]||o[0]>a[1]||o[1]<a[2]||o[1]>a[3]||o[2]<a[4]||o[2]>a[5]?null:{t:r.t,ijk:o}}return null}function d6e(t,e,n){const r=YY(t,e,n);if(r){const a=n.getCurrentImage().getExtent(),o=r.absoluteIJK,s=[Math.floor(o[0]),Math.floor(o[1]),Math.floor(o[2])];if(s[0]<a[0]||s[0]>a[1]-1||s[1]<a[2]||s[1]>a[3]-1||s[2]<a[4]||s[2]>(a[5]?a[5]-1:a[5]))return null;const l=[o[0]-s[0],o[1]-s[1],o[2]-s[2]];return{t:r.t,ijk:s,pCoords:l}}return null}const{staticOffsetAPI:h6e,otherStaticMethods:p6e}=Xw,{SlicingMode:rr}=Yw;function g6e(t,e){e.classHierarchy.push("vtkImageMapper"),t.getSliceAtPosition=r=>{const i=t.getCurrentImage();let a;if(r.length===3)a=r;else if(Number.isFinite(r)){const f=i.getBounds();switch(e.slicingMode){case rr.X:a=[r,(f[3]+f[2])/2,(f[5]+f[4])/2];break;case rr.Y:a=[(f[1]+f[0])/2,r,(f[5]+f[4])/2];break;case rr.Z:a=[(f[1]+f[0])/2,(f[3]+f[2])/2,r];break}}const o=[0,0,0];i.worldToIndex(a,o);const s=i.getExtent(),{ijkMode:l}=t.getClosestIJKAxis();let c=0;switch(l){case rr.I:c=pc(o[0],s[0],s[1]);break;case rr.J:c=pc(o[1],s[2],s[3]);break;case rr.K:c=pc(o[2],s[4],s[5]);break;default:return 0}return c},t.setSliceFromCamera=r=>{const i=r.getFocalPoint();switch(e.slicingMode){case rr.I:case rr.J:case rr.K:{const a=t.getSliceAtPosition(i);t.setSlice(a)}break;case rr.X:t.setSlice(i[0]);break;case rr.Y:t.setSlice(i[1]);break;case rr.Z:t.setSlice(i[2]);break}},t.setXSlice=r=>{t.setSlicingMode(rr.X),t.setSlice(r)},t.setYSlice=r=>{t.setSlicingMode(rr.Y),t.setSlice(r)},t.setZSlice=r=>{t.setSlicingMode(rr.Z),t.setSlice(r)},t.setISlice=r=>{t.setSlicingMode(rr.I),t.setSlice(r)},t.setJSlice=r=>{t.setSlicingMode(rr.J),t.setSlice(r)},t.setKSlice=r=>{t.setSlicingMode(rr.K),t.setSlice(r)},t.getSlicingModeNormal=()=>{const r=[0,0,0],i=t.getCurrentImage().getDirection();switch(e.slicingMode){case rr.X:r[0]=1;break;case rr.Y:r[1]=1;break;case rr.Z:r[2]=1;break;case rr.I:ab(i,[1,0,0],r);break;case rr.J:ab(i,[0,1,0],r);break;case rr.K:ab(i,[0,0,1],r);break}return r};function n(){let r;switch(e.slicingMode){case rr.X:r=0;break;case rr.Y:r=1;break;case rr.Z:r=2;break;default:e.closestIJKAxis={ijkMode:e.slicingMode,flip:!1};return}const i=t.getCurrentImage().getDirection(),a=GH(i);let o=0;for(;o<3&&a[r+3*o]===0;++o);const s=a[r+3*o]<0;e.closestIJKAxis={ijkMode:o,flip:s}}t.setSlicingMode=r=>{e.slicingMode!==r&&(e.slicingMode=r,t.getCurrentImage()&&n(),t.modified())},t.getClosestIJKAxis=()=>((e.closestIJKAxis===void 0||e.closestIJKAxis.ijkMode===rr.NONE)&&t.getCurrentImage()&&n(),e.closestIJKAxis),t.getBounds=()=>{const r=t.getCurrentImage();if(!r)return d0();if(!e.useCustomExtents)return r.getBounds();const i=e.customDisplayExtent.slice(),{ijkMode:a}=t.getClosestIJKAxis();let o=e.slice;switch(a!==e.slicingMode&&(o=t.getSliceAtPosition(e.slice)),a){case rr.I:i[0]=o,i[1]=o;break;case rr.J:i[2]=o,i[3]=o;break;case rr.K:i[4]=o,i[5]=o;break}return r.extentToBounds(i)},t.getBoundsForSlice=function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:e.slice,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const a=t.getCurrentImage();if(!a)return d0();const o=a.getSpatialExtent(),{ijkMode:s}=t.getClosestIJKAxis();let l=r;switch(s!==e.slicingMode&&(l=t.getSliceAtPosition(r)),s){case rr.I:o[0]=l-i,o[1]=l+i;break;case rr.J:o[2]=l-i,o[3]=l+i;break;case rr.K:o[4]=l-i,o[5]=l+i;break}return a.extentToBounds(o)},t.intersectWithLineForPointPicking=(r,i)=>f6e(r,i,t),t.intersectWithLineForCellPicking=(r,i)=>d6e(r,i,t),t.getCurrentImage=()=>t.getInputData()}const m6e={slicingMode:rr.NONE,closestIJKAxis:{ijkMode:rr.NONE,flip:!1},renderToRectangle:!1,sliceAtFocalPoint:!1,preferSizeOverAccuracy:!1};function JY(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,m6e,n),u6e.extend(t,e,n),le.get(t,e,["slicingMode"]),le.setGet(t,e,["closestIJKAxis","renderToRectangle","sliceAtFocalPoint","preferSizeOverAccuracy"]),Xw.implementCoincidentTopologyMethods(t,e),g6e(t,e)}const v6e=le.newInstance(JY,"vtkImageMapper");var y6e={newInstance:v6e,extend:JY,...h6e,...p6e,...Yw};const{InterpolationType:yb}=H3e,{vtkErrorMacro:dk}=le,xb=4;function x6e(t,e){e.classHierarchy.push("vtkImageProperty"),t.getMTime=()=>{let n=e.mtime,r;for(let i=0;i<xb;i++)e.componentData[i].rGBTransferFunction&&(r=e.componentData[i].rGBTransferFunction.getMTime(),n=n>r?n:r),e.componentData[i].piecewiseFunction&&(r=e.componentData[i].piecewiseFunction.getMTime(),n=n>r?n:r);return n},t.setRGBTransferFunction=function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=n,a=r;return Number.isInteger(n)||(a=n,i=0),e.componentData[i].rGBTransferFunction!==a?(e.componentData[i].rGBTransferFunction=a,t.modified(),!0):!1},t.getRGBTransferFunction=function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return e.componentData[n].rGBTransferFunction},t.setPiecewiseFunction=function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=n,a=r;return Number.isInteger(n)||(a=n,i=0),e.componentData[i].piecewiseFunction!==a?(e.componentData[i].piecewiseFunction=a,t.modified(),!0):!1},t.getPiecewiseFunction=function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return e.componentData[n].piecewiseFunction},t.setScalarOpacity=function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=n,a=r;return Number.isInteger(n)||(a=n,i=0),t.setPiecewiseFunction(i,a)},t.getScalarOpacity=function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return t.getPiecewiseFunction(n)},t.setComponentWeight=function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;if(n<0||n>=xb)return dk("Invalid index"),!1;const i=Math.min(1,Math.max(0,r));return e.componentData[n].componentWeight!==i?(e.componentData[n].componentWeight=i,t.modified(),!0):!1},t.getComponentWeight=function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return n<0||n>=xb?(dk("Invalid index"),0):e.componentData[n].componentWeight},t.setInterpolationTypeToNearest=()=>t.setInterpolationType(yb.NEAREST),t.setInterpolationTypeToLinear=()=>t.setInterpolationType(yb.LINEAR),t.getInterpolationTypeAsString=()=>le.enumToString(yb,e.interpolationType)}const b6e={independentComponents:!1,interpolationType:yb.LINEAR,colorWindow:255,colorLevel:127.5,ambient:1,diffuse:0,opacity:1,useLookupTableScalarRange:!1,useLabelOutline:!1,labelOutlineThickness:[1],labelOutlineOpacity:1};function w6e(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(Object.assign(e,b6e,n),le.obj(t,e),!e.componentData){e.componentData=[];for(let r=0;r<xb;r++)e.componentData.push({rGBTransferFunction:null,piecewiseFunction:null,componentWeight:1})}le.setGet(t,e,["independentComponents","interpolationType","colorWindow","colorLevel","ambient","diffuse","opacity","useLookupTableScalarRange","useLabelOutline","labelOutlineOpacity"]),le.setGetArray(t,e,["labelOutlineThickness"]),x6e(t,e)}const C6e=le.newInstance(w6e,"vtkImageProperty");var S6e={newInstance:C6e};const{vtkDebugMacro:T6e}=le;function E6e(t,e){e.classHierarchy.push("vtkImageSlice"),t.getActors=()=>t,t.getImages=()=>t,t.getIsOpaque=()=>{if(e.forceOpaque)return!0;if(e.forceTranslucent)return!1;e.property||t.getProperty();let n=e.property.getOpacity()>=1;return n=n&&(!e.mapper||e.mapper.getIsOpaque()),n},t.hasTranslucentPolygonalGeometry=()=>!1,t.makeProperty=S6e.newInstance,t.getProperty=()=>(e.property===null&&(e.property=t.makeProperty()),e.property),t.getBounds=()=>{if(e.mapper===null)return e.bounds;const n=e.mapper.getBounds();if(!n||n.length!==6)return n;if(n[0]>n[1])return e.mapperBounds=n.concat(),e.bounds=[1,-1,1,-1,1,-1],e.boundsMTime.modified(),n;const r=i=>i[0].map((a,o)=>i.map(s=>s[o]));if(!e.mapperBounds||!r([n,e.mapperBounds]).reduce((i,a)=>i&&a[0]===a[1],!0)||t.getMTime()>e.boundsMTime.getMTime()){T6e("Recomputing bounds..."),e.mapperBounds=n.map(a=>a),t.computeMatrix();const i=new Float64Array(16);Gn(i,e.matrix),wr.transformBounds(n,i,e.bounds),e.boundsMTime.modified()}return e.bounds},t.getBoundsForSlice=(n,r)=>{const i=e.mapper.getBoundsForSlice(n,r);if(!wr.isValid(i))return i;t.computeMatrix();const a=new Float64Array(16);return Gn(a,e.matrix),wr.transformBounds(i,a)},t.getMinXBound=()=>t.getBounds()[0],t.getMaxXBound=()=>t.getBounds()[1],t.getMinYBound=()=>t.getBounds()[2],t.getMaxYBound=()=>t.getBounds()[3],t.getMinZBound=()=>t.getBounds()[4],t.getMaxZBound=()=>t.getBounds()[5],t.getMTime=()=>{let n=e.mtime;if(e.property!==null){const r=e.property.getMTime();n=r>n?r:n}return n},t.getRedrawMTime=()=>{let n=e.mtime;if(e.mapper!==null){let r=e.mapper.getMTime();n=r>n?r:n,e.mapper.getInput()!==null&&(e.mapper.getInputAlgorithm().update(),r=e.mapper.getInput().getMTime(),n=r>n?r:n)}if(e.property!==null){let r=e.property.getMTime();n=r>n?r:n,e.property.getRGBTransferFunction()!==null&&(r=e.property.getRGBTransferFunction().getMTime(),n=r>n?r:n)}return n},t.getSupportsSelection=()=>e.mapper?e.mapper.getSupportsSelection():!1}const _6e={mapper:null,property:null,forceOpaque:!1,forceTranslucent:!1,bounds:[...wr.INIT_BOUNDS]};function ZY(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,_6e,n),fD.extend(t,e,n),e.boundsMTime={},le.obj(e.boundsMTime),le.set(t,e,["property"]),le.setGet(t,e,["mapper","forceOpaque","forceTranslucent"]),le.getArray(t,e,["bounds"],6),E6e(t,e)}const D6e=le.newInstance(ZY,"vtkImageSlice");var O6e={newInstance:D6e,extend:ZY};function M6e(t){return Object.values(oo).includes(t)?t:oo.LINEAR}function QY(t){const n={...Ft(Yo.IMAGE_PLANE,t)};return n.columnPixelSpacing||(n.columnPixelSpacing=1),n.rowPixelSpacing||(n.rowPixelSpacing=1),n.columnCosines||(n.columnCosines=[0,1,0]),n.rowCosines||(n.rowCosines=[1,0,0]),n.imagePositionPatient||(n.imagePositionPatient=[0,0,0]),n.imageOrientationPatient||(n.imageOrientationPatient=new Float32Array([1,0,0,0,1,0])),n}function eJ(t){const e=t.imageId,{pixelRepresentation:n,bitsAllocated:r,bitsStored:i,highBit:a,photometricInterpretation:o,samplesPerPixel:s}=Ft("imagePixelModule",e),{windowWidth:l,windowCenter:c,voiLUTFunction:f}=t,{modality:u}=Ft("generalSeriesModule",e),d=Ft("scalingModule",e),h=Ft(Yo.CALIBRATION,e),p=M6e(f),g=QY(e);return{calibration:h,scalingFactor:d,voiLUTFunction:p,modality:u,imagePlaneModule:g,imagePixelModule:{bitsAllocated:r,bitsStored:i,samplesPerPixel:s,highBit:a,photometricInterpretation:o,pixelRepresentation:n,windowWidth:l,windowCenter:c,modality:u,voiLUTFunction:p}}}function $D(t){const{imagePlaneModule:e,imagePixelModule:n,voiLUTFunction:r,modality:i,scalingFactor:a,calibration:o}=eJ(t);let{rowCosines:s,columnCosines:l}=e;(s==null||l==null)&&(s=[1,0,0],l=[0,1,0]);const c=En(s[0],s[1],s[2]),f=En(l[0],l[1],l[2]),u=ct();dr(u,c,f);let d=e.imagePositionPatient;d==null&&(d=[0,0,0]);const h=e.columnPixelSpacing||t.columnPixelSpacing,p=e.rowPixelSpacing||t.rowPixelSpacing,g=t.columns,m=t.rows,y=Qs,v=1;return!n.photometricInterpretation&&t.sizeInBytes===3*t.width*t.height&&(t.numberOfComponents=3),{numberOfComponents:t.numberOfComponents||I6e(n.photometricInterpretation),origin:d,direction:[...c,...f,...u],dimensions:[g,m,v],spacing:[h,p,y],numVoxels:g*m*v,imagePlaneModule:e,imagePixelModule:n,bitsAllocated:n.bitsAllocated,voiLUTFunction:r,modality:i,scalingFactor:a,calibration:o,scanAxisNormal:u}}function I6e(t){let e=1;return(t==="RGB"||t?.includes("YBR")||t==="PALETTE COLOR")&&(e=3),e}var bb={exports:{}},R6e=bb.exports,hk;function A6e(){return hk||(hk=1,(function(t){(function(e,n){t.exports?t.exports=n():e.log=n()})(R6e,function(){var e=function(){},n="undefined",r=typeof window!==n&&typeof window.navigator!==n&&/Trident\/|MSIE /.test(window.navigator.userAgent),i=["trace","debug","info","warn","error"],a={},o=null;function s(g,m){var y=g[m];if(typeof y.bind=="function")return y.bind(g);try{return Function.prototype.bind.call(y,g)}catch{return function(){return Function.prototype.apply.apply(y,[g,arguments])}}}function l(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function c(g){return g==="debug"&&(g="log"),typeof console===n?!1:g==="trace"&&r?l:console[g]!==void 0?s(console,g):console.log!==void 0?s(console,"log"):e}function f(){for(var g=this.getLevel(),m=0;m<i.length;m++){var y=i[m];this[y]=m<g?e:this.methodFactory(y,g,this.name)}if(this.log=this.debug,typeof console===n&&g<this.levels.SILENT)return"No console available for logging"}function u(g){return function(){typeof console!==n&&(f.call(this),this[g].apply(this,arguments))}}function d(g,m,y){return c(g)||u.apply(this,arguments)}function h(g,m){var y=this,v,x,w,S="loglevel";typeof g=="string"?S+=":"+g:typeof g=="symbol"&&(S=void 0);function T(M){var A=(i[M]||"silent").toUpperCase();if(!(typeof window===n||!S)){try{window.localStorage[S]=A;return}catch{}try{window.document.cookie=encodeURIComponent(S)+"="+A+";"}catch{}}}function _(){var M;if(!(typeof window===n||!S)){try{M=window.localStorage[S]}catch{}if(typeof M===n)try{var A=window.document.cookie,L=encodeURIComponent(S),P=A.indexOf(L+"=");P!==-1&&(M=/^([^;]+)/.exec(A.slice(P+L.length+1))[1])}catch{}return y.levels[M]===void 0&&(M=void 0),M}}function D(){if(!(typeof window===n||!S)){try{window.localStorage.removeItem(S)}catch{}try{window.document.cookie=encodeURIComponent(S)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}function I(M){var A=M;if(typeof A=="string"&&y.levels[A.toUpperCase()]!==void 0&&(A=y.levels[A.toUpperCase()]),typeof A=="number"&&A>=0&&A<=y.levels.SILENT)return A;throw new TypeError("log.setLevel() called with invalid level: "+M)}y.name=g,y.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},y.methodFactory=m||d,y.getLevel=function(){return w??x??v},y.setLevel=function(M,A){return w=I(M),A!==!1&&T(w),f.call(y)},y.setDefaultLevel=function(M){x=I(M),_()||y.setLevel(M,!1)},y.resetLevel=function(){w=null,D(),f.call(y)},y.enableAll=function(M){y.setLevel(y.levels.TRACE,M)},y.disableAll=function(M){y.setLevel(y.levels.SILENT,M)},y.rebuild=function(){if(o!==y&&(v=I(o.getLevel())),f.call(y),o===y)for(var M in a)a[M].rebuild()},v=I(o?o.getLevel():"WARN");var R=_();R!=null&&(w=I(R)),f.call(y)}o=new h,o.getLogger=function(m){if(typeof m!="symbol"&&typeof m!="string"||m==="")throw new TypeError("You must supply a name when creating a logger.");var y=a[m];return y||(y=a[m]=new h(m,o.methodFactory)),y};var p=typeof window!==n?window.log:void 0;return o.noConflict=function(){return typeof window!==n&&window.log===o&&(window.log=p),o},o.getLoggers=function(){return a},o.default=o,o})})(bb)),bb.exports}var P6e=A6e();const N6e=tl(P6e),tJ=N6e.noConflict();typeof window<"u"&&(window.log=tJ);function aC(t){const e=tJ.getLogger(t[0]);return e.getLogger=(...n)=>aC(`${t}.${n.join(".")}`),e}function GD(...t){return aC(t.join("."))}const Um=aC("cs3d"),jD=Um.getLogger("core"),L6e=Um.getLogger("tools"),k6e=Um.getLogger("dicomImageLoader"),V6e=Um.getLogger("ai"),F6e=Um.getLogger("examples"),U6e=GD("consistency","dicom"),B6e=GD("consistency","image"),$6e=Object.freeze(Object.defineProperty({__proto__:null,aiLog:V6e,coreLog:jD,cs3dLog:Um,dicomConsistencyLog:U6e,examplesLog:F6e,getLogger:GD,getRootLogger:aC,imageConsistencyLog:B6e,loaderLog:k6e,toolsLog:L6e},Symbol.toStringTag,{value:"Module"}));function nJ(t){const e=Lf.newInstance();let n=0,r=1024;return t.lower!==void 0&&t.upper!==void 0&&(n=t.lower,r=t.upper),e.addRGBPoint(n,0,0,0),e.addRGBPoint(r,1,1,1),e}function oC(t,e){const n=e.voxelManager.getScalarData();if(!t.getPointData)return;const r=t.getPointData().getScalars().getData();if(e.color&&e.rgba){const i=new Uint8Array(e.columns*e.rows*3);for(let a=0;a<e.columns*e.rows;a++)i[a*3]=n[a*4],i[a*3+1]=n[a*4+1],i[a*3+2]=n[a*4+2];e.rgba=!1,e.getPixelData=()=>i,r.set(i)}else r.set(n);t.modified()}function Vn(){return window.performance?performance.now():Date.now()}function G6e(t,e){return function(n){const r=((n-(e-.5))/(t-1)+.5)*255;return Math.min(Math.max(r,0),255)}}function j6e(t){const n=Math.max(...t.lut).toString(2).length-8,r=t.lut[0]>>n,i=t.lut[t.lut.length-1]>>n,a=t.firstValueMapped+t.lut.length-1;return function(o){return o<t.firstValueMapped?r:o>=a?i:t.lut[o-t.firstValueMapped]>>n}}function rJ(t,e,n){return n?j6e(n):G6e(t,e)}function z6e(t,e,n,r,i){const a=t.maxPixelValue,o=t.minPixelValue,s=Math.min(o,0);if(t.cachedLut===void 0){const f=a-s+1;t.cachedLut={},t.cachedLut.lutArray=new Uint8ClampedArray(f)}const l=t.cachedLut.lutArray,c=rJ(Array.isArray(e)?e[0]:e,Array.isArray(n)?n[0]:n,i);if(r)for(let f=o;f<=a;f++)l[f+-s]=255-c(f);else for(let f=o;f<=a;f++)l[f+-s]=c(f);return l}function W6e(t,e,n){let r=Vn();const i=t.voxelManager.getScalarData();t.stats.lastGetPixelDataTime=Vn()-r;const a=t.minPixelValue;let o=0,s=0;const l=i.length;if(r=Vn(),a<0)for(;s<l;)n[o++]=e[i[s++]+-a],n[o++]=e[i[s++]+-a],n[o++]=e[i[s++]+-a],n[o++]=255;else for(;s<l;)n[o++]=e[i[s++]],n[o++]=e[i[s++]],n[o++]=e[i[s++]],n[o++]=255;t.stats.lastStoredPixelDataToCanvasImageDataTime=Vn()-r}function H6e(t,e,n){let r=Vn();const i=t.getPixelData();t.stats.lastGetPixelDataTime=Vn()-r;const a=t.minPixelValue;let o=0,s=0;const l=i.length;if(r=Vn(),a<0)for(;s<l;)n[o++]=e[i[s++]+-a],n[o++]=e[i[s++]+-a],n[o++]=e[i[s++]+-a],n[o++]=i[s++];else for(;s<l;)n[o++]=e[i[s++]],n[o++]=e[i[s++]],n[o++]=e[i[s++]],n[o++]=i[s++];t.stats.lastStoredPixelDataToCanvasImageDataTime=Vn()-r}class Bm{constructor(){this.reset()}getMatrix(){return this.m}reset(){this.m=[1,0,0,1,0,0]}clone(){const e=new Bm;return e.m[0]=this.m[0],e.m[1]=this.m[1],e.m[2]=this.m[2],e.m[3]=this.m[3],e.m[4]=this.m[4],e.m[5]=this.m[5],e}multiply(e){const n=this.m[0]*e[0]+this.m[2]*e[1],r=this.m[1]*e[0]+this.m[3]*e[1],i=this.m[0]*e[2]+this.m[2]*e[3],a=this.m[1]*e[2]+this.m[3]*e[3],o=this.m[0]*e[4]+this.m[2]*e[5]+this.m[4],s=this.m[1]*e[4]+this.m[3]*e[5]+this.m[5];this.m[0]=n,this.m[1]=r,this.m[2]=i,this.m[3]=a,this.m[4]=o,this.m[5]=s}invert(){const e=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),n=this.m[3]*e,r=-this.m[1]*e,i=-this.m[2]*e,a=this.m[0]*e,o=e*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),s=e*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);this.m[0]=n,this.m[1]=r,this.m[2]=i,this.m[3]=a,this.m[4]=o,this.m[5]=s}rotate(e){const n=Math.cos(e),r=Math.sin(e),i=this.m[0]*n+this.m[2]*r,a=this.m[1]*n+this.m[3]*r,o=this.m[0]*-r+this.m[2]*n,s=this.m[1]*-r+this.m[3]*n;this.m[0]=i,this.m[1]=a,this.m[2]=o,this.m[3]=s}translate(e,n){this.m[4]+=this.m[0]*e+this.m[2]*n,this.m[5]+=this.m[1]*e+this.m[3]*n}scale(e,n){this.m[0]*=e,this.m[1]*=e,this.m[2]*=n,this.m[3]*=n}transformPoint(e){const n=e[0],r=e[1];return[n*this.m[0]+r*this.m[2]+this.m[4],n*this.m[1]+r*this.m[3]+this.m[5]]}}function S2(t,e){const n=new Bm;if(!t.viewport.displayedArea)return n;n.translate(t.canvas.width/2,t.canvas.height/2);const r=t.viewport.rotation;r!==0&&n.rotate(r*Math.PI/180);let i=t.viewport.scale,a=t.viewport.scale;const o=t.viewport.displayedArea.brhc.x-(t.viewport.displayedArea.tlhc.x-1),s=t.viewport.displayedArea.brhc.y-(t.viewport.displayedArea.tlhc.y-1);if(t.viewport.displayedArea.presentationSizeMode==="NONE")t.image.rowPixelSpacing<t.image.columnPixelSpacing?i*=t.image.columnPixelSpacing/t.image.rowPixelSpacing:t.image.columnPixelSpacing<t.image.rowPixelSpacing&&(a*=t.image.rowPixelSpacing/t.image.columnPixelSpacing);else if(i=t.viewport.displayedArea.columnPixelSpacing,a=t.viewport.displayedArea.rowPixelSpacing,t.viewport.displayedArea.presentationSizeMode==="SCALE TO FIT"){const l=t.canvas.height/(s*a),c=t.canvas.width/(o*i);i=a=Math.min(c,l),t.viewport.displayedArea.rowPixelSpacing<t.viewport.displayedArea.columnPixelSpacing?i*=t.viewport.displayedArea.columnPixelSpacing/t.viewport.displayedArea.rowPixelSpacing:t.viewport.displayedArea.columnPixelSpacing<t.viewport.displayedArea.rowPixelSpacing&&(a*=t.viewport.displayedArea.rowPixelSpacing/t.viewport.displayedArea.columnPixelSpacing)}return n.scale(i,a),r!==0&&n.rotate(-r*Math.PI/180),n.translate(t.viewport.translation.x,t.viewport.translation.y),r!==0&&n.rotate(r*Math.PI/180),t.viewport.hflip&&n.scale(-1,1),t.viewport.vflip&&n.scale(1,-1),n.translate(-o/2,-s/2),n}function zD(t,e,n){if(t===void 0)throw new Error("setToPixelCoordinateSystem: parameter enabledElement must not be undefined");if(e===void 0)throw new Error("setToPixelCoordinateSystem: parameter context must not be undefined");const i=S2(t).getMatrix();e.setTransform(i[0],i[1],i[2],i[3],i[4],i[5])}function WD(t,e){const n=t.renderingTools.lastRenderedImageId,r=t.renderingTools.lastRenderedViewport;return e.imageId!==n||!r||r.windowCenter!==t.viewport.voi.windowCenter||r.windowWidth!==t.viewport.voi.windowWidth||r.invert!==t.viewport.invert||r.rotation!==t.viewport.rotation||r.hflip!==t.viewport.hflip||r.vflip!==t.viewport.vflip||r.modalityLUT!==t.viewport.modalityLUT||r.voiLUT!==t.viewport.voiLUT||r.colormap!==t.viewport.colormap}function M3(t,e){const n=t.renderingTools.renderCanvas;n.width=e.width,n.height=e.height;const r=n.getContext("2d");r.fillStyle="white",r.fillRect(0,0,n.width,n.height);const i=r.getImageData(0,0,e.width,e.height);t.renderingTools.renderCanvasContext=r,t.renderingTools.renderCanvasData=i}function HD(t){const e=t.image.imageId,n=t.viewport,r=t.image.color;return t.renderingTools.lastRenderedImageId=e,t.renderingTools.lastRenderedIsColor=r,t.renderingTools.lastRenderedViewport={windowCenter:n.voi.windowCenter,windowWidth:n.voi.windowWidth,invert:n.invert,rotation:n.rotation,hflip:n.hflip,vflip:n.vflip,modalityLUT:n.modalityLUT,voiLUT:n.voiLUT,colormap:n.colormap},t.renderingTools}const iJ="viewport-element",aJ="cornerstone-canvas",Yg=1e-4;let P6;function cy(t,e=512,n=512){const r=P6?P6(e,n):document.createElement("canvas");return t&&(r.style.position="absolute",r.style.width="100%",r.style.height="100%",r.style.imageRendering="pixelated",r.classList.add(aJ),t.appendChild(r)),r}function oJ(t){const e=document.createElement("div");return e.style.position="relative",e.style.width="100%",e.style.height="100%",e.style.overflow="hidden",e.classList.add(iJ),t.appendChild(e),e}function K6e(t){P6=t}function Ys(t){const e=`canvas.${aJ}`,n=`div.${iJ}`,r=t.querySelector(n)||oJ(t),i=r.querySelector(e);if(i)return i;const a=cy(r),o=r.getBoundingClientRect(),s=window.devicePixelRatio||1,l=Math.ceil(o.width*s),c=Math.ceil(o.height*s);return a.width=l,a.height=c,a}function q6e(t,e){return t.cachedLut!==void 0&&t.cachedLut.windowCenter===e.voi.windowCenter&&t.cachedLut.windowWidth===e.voi.windowWidth&&t.cachedLut.invert===e.invert||(z6e(t,e.voi.windowWidth,e.voi.windowCenter,e.invert),t.cachedLut.windowWidth=e.voi.windowWidth,t.cachedLut.windowCenter=e.voi.windowCenter,t.cachedLut.invert=e.invert),t.cachedLut.lutArray}function X6e(t,e,n){const r=t.renderingTools.lastRenderedIsColor;(!t.renderingTools.renderCanvas||!r)&&(t.renderingTools.renderCanvas=cy(null,e.width,e.height));const i=t.renderingTools.renderCanvas,{windowWidth:a,windowCenter:o}=t.viewport.voi;if((a===256||a===255)&&(o===128||o===127)&&!t.viewport.invert&&e.getCanvas&&e.getCanvas())return e.getCanvas();if(!WD(t,e)&&!n)return i;(!t.renderingTools.renderCanvasContext||i.width!==e.width||i.height!==e.height)&&M3(t,e);let s=Vn();const l=q6e(e,t.viewport);e.stats=e.stats||{},e.stats.lastLutGenerateTime=Vn()-s;const c=t.renderingTools.renderCanvasData,f=t.renderingTools.renderCanvasContext;return e.rgba?H6e(e,l,c.data):W6e(e,l,c.data),s=Vn(),f.putImageData(c,0,0),e.stats.lastPutImageDataTime=Vn()-s,i}function Y6e(t,e){if(t===void 0)throw new Error("renderColorImage: enabledElement parameter must not be undefined");const n=t.image;if(n===void 0)throw new Error("renderColorImage: image must be loaded before it can be drawn");const r=t.canvas.getContext("2d");r.setTransform(1,0,0,1,0,0),r.fillStyle="black",r.fillRect(0,0,t.canvas.width,t.canvas.height),r.imageSmoothingEnabled=!t.viewport.pixelReplication,zD(t,r);const i=X6e(t,n,e),a=t.viewport.displayedArea.tlhc.x-1,o=t.viewport.displayedArea.tlhc.y-1,s=t.viewport.displayedArea.brhc.x-a,l=t.viewport.displayedArea.brhc.y-o;r.drawImage(i,a,o,s,l,0,0,s,l),t.renderingTools=HD(t)}function J6e(t,e,n){let r=Vn();const i=t.voxelManager.getScalarData();t.stats.lastGetPixelDataTime=Vn()-r;const a=i.length,o=t.minPixelValue;let s=3,l=0;if(r=Vn(),i instanceof Int16Array)if(o<0)for(;l<a;)n[s]=e[i[l++]+-o],s+=4;else for(;l<a;)n[s]=e[i[l++]],s+=4;else if(i instanceof Uint16Array)for(;l<a;)n[s]=e[i[l++]],s+=4;else if(o<0)for(;l<a;)n[s]=e[i[l++]+-o],s+=4;else for(;l<a;)n[s]=e[i[l++]],s+=4;t.stats.lastStoredPixelDataToCanvasImageDataTime=Vn()-r}function Z6e(t,e,n){let r=Vn();const i=t.voxelManager.getScalarData();t.stats.lastGetPixelDataTime=Vn()-r;const a=i.length;let o=3,s=0;for(r=Vn();s<a;)n[o]=e(i[s++]),o+=4;t.stats.lastStoredPixelDataToCanvasImageDataTime=Vn()-r}function Q6e(t,e,n){let r=Vn();const i=t.voxelManager.getScalarData();t.stats.lastGetPixelDataTime=Vn()-r;const a=i.length,o=t.minPixelValue;let s=0,l=0,c;if(r=Vn(),i instanceof Int16Array)if(o<0)for(;l<a;)c=e[i[l++]+-o],n[s++]=c,n[s++]=c,n[s++]=c,n[s++]=255;else for(;l<a;)c=e[i[l++]],n[s++]=c,n[s++]=c,n[s++]=c,n[s++]=255;else if(i instanceof Uint16Array)for(;l<a;)c=e[i[l++]],n[s++]=c,n[s++]=c,n[s++]=c,n[s++]=255;else if(o<0)for(;l<a;)c=e[i[l++]+-o],n[s++]=c,n[s++]=c,n[s++]=c,n[s++]=255;else for(;l<a;)c=e[i[l++]],n[s++]=c,n[s++]=c,n[s++]=c,n[s++]=255;t.stats.lastStoredPixelDataToCanvasImageDataTime=Vn()-r}function e_e(t,e){if(t_e(t))return;const n=e.maxPixelValue*e.slope+e.intercept,r=e.minPixelValue*e.slope+e.intercept,i=n-r,a=(n+r)/2;t.voi===void 0?t.voi={windowWidth:i,windowCenter:a,voiLUTFunction:e.voiLUTFunction}:(t.voi.windowWidth=i,t.voi.windowCenter=a)}function t_e(t){return t.voiLUT&&t.voiLUT.lut&&t.voiLUT.lut.length>0||t.voi.windowWidth!==void 0&&t.voi.windowCenter!==void 0}function pk(t,e){return!t&&!e?!0:!t||!e?!1:t.id===e.id}function n_e(t,e){return n=>n*t+e}function r_e(t){const e=t.lut[0],n=t.lut[t.lut.length-1],r=t.firstValueMapped+t.lut.length;return i=>i<t.firstValueMapped?e:i>=r?n:t.lut[i]}function i_e(t,e,n){return n?r_e(n):n_e(t,e)}function a_e(t,e,n,r,i,a){const o=t.maxPixelValue,s=t.minPixelValue,l=Math.min(s,0);if(t.cachedLut===void 0){const d=o-l+1;t.cachedLut={},t.cachedLut.lutArray=new Uint8ClampedArray(d)}const c=t.cachedLut.lutArray,f=i_e(t.slope,t.intercept,i),u=rJ(e,n,a);if(t.isPreScaled)if(r)for(let d=s;d<=o;d++)c[d+-l]=255-u(d);else for(let d=s;d<=o;d++)c[d+-l]=u(d);else if(r)for(let d=s;d<=o;d++)c[d+-l]=255-u(f(d));else for(let d=s;d<=o;d++)c[d+-l]=u(f(d));return c}function sJ(t,e,n){return t.cachedLut!==void 0&&t.cachedLut.windowCenter===e.voi.windowCenter&&t.cachedLut.windowWidth===e.voi.windowWidth&&pk(t.cachedLut.modalityLUT,e.modalityLUT)&&pk(t.cachedLut.voiLUT,e.voiLUT)&&t.cachedLut.invert===e.invert&&!n||(e_e(e,t),a_e(t,e.voi.windowWidth,e.voi.windowCenter,e.invert,e.modalityLUT,e.voiLUT),t.cachedLut.windowWidth=e.voi.windowWidth,t.cachedLut.windowCenter=e.voi.windowCenter,t.cachedLut.invert=e.invert,t.cachedLut.voiLUT=e.voiLUT,t.cachedLut.modalityLUT=e.modalityLUT),t.cachedLut.lutArray}function o_e(t,e,n,r=!0){const i=t.renderingTools.lastRenderedIsColor;(!t.renderingTools.renderCanvas||i)&&(t.renderingTools.renderCanvas=cy(null,e.width,e.height),M3(t,e));const a=t.renderingTools.renderCanvas;if(!WD(t,e)&&!n)return a;(a.width!==e.width||a.height!==e.height)&&M3(t,e),e.stats=e.stats||{};const o=t.renderingTools.renderCanvasData,s=t.renderingTools.renderCanvasContext;let l=Vn();e.stats.lastLutGenerateTime=Vn()-l;const{viewport:c}=t;if(c.modality==="PT"&&e.isPreScaled){const{windowWidth:f,windowCenter:u}=c.voi,d=u-f/2,g=255/(u+f/2-d);let m;c.invert?m=y=>255-(y-d)*g:m=y=>(y-d)*g,Z6e(e,m,o.data)}else{const f=sJ(e,c,n);r?J6e(e,f,o.data):Q6e(e,f,o.data)}return l=Vn(),s.putImageData(o,0,0),e.stats.lastPutImageDataTime=Vn()-l,a}function s_e(t,e){if(t===void 0)throw new Error("drawImage: enabledElement parameter must not be undefined");const n=t.image;if(n===void 0)throw new Error("drawImage: image must be loaded before it can be drawn");const r=t.canvas.getContext("2d");r.setTransform(1,0,0,1,0,0),r.fillStyle="black",r.fillRect(0,0,t.canvas.width,t.canvas.height),r.imageSmoothingEnabled=!t.viewport.pixelReplication,zD(t,r);const i=o_e(t,n,e),a=t.viewport.displayedArea.tlhc.x-1,o=t.viewport.displayedArea.tlhc.y-1,s=t.viewport.displayedArea.brhc.x-a,l=t.viewport.displayedArea.brhc.y-o;r.drawImage(i,a,o,s,l,0,0,s,l),t.renderingTools=HD(t)}const N6=0,L6=1,l_e=2;function c_e(t,e,n){if(t>1)throw new Error("HSVToRGB expects hue < 1");const r=[];if(e===0)return r[0]=n,r[1]=n,r[2]=n,r;const i=Math.floor(t*6),a=6*t-i,o=n*(1-e),s=n*(1-e*a),l=n*(1-e*(1-a));switch(i){case 0:case 6:r[0]=n,r[1]=l,r[2]=o;break;case 1:r[0]=s,r[1]=n,r[2]=o;break;case 2:r[0]=o,r[1]=n,r[2]=l;break;case 3:r[0]=o,r[1]=s,r[2]=n;break;case 4:r[0]=l,r[1]=o,r[2]=n;break;case 5:r[0]=n,r[1]=o,r[2]=s;break}return r}function u_e(t,e){let n;return t<e.Range[0]?n=e.MaxIndex+N6+1.5:t>e.Range[1]?n=e.MaxIndex+L6+1.5:n=(t+e.Shift)*e.Scale,Math.floor(n)}class KD{constructor(){this.NumberOfColors=256,this.Ramp="linear",this.TableRange=[0,255],this.HueRange=[0,.66667],this.SaturationRange=[1,1],this.ValueRange=[1,1],this.AlphaRange=[1,1],this.NaNColor=[128,0,0,255],this.BelowRangeColor=[0,0,0,255],this.UseBelowRangeColor=!0,this.AboveRangeColor=[255,255,255,255],this.UseAboveRangeColor=!0,this.InputRange=[0,255],this.Table=[]}setNumberOfTableValues(e){this.NumberOfColors=e}setRamp(e){this.Ramp=e}setTableRange(e,n){this.TableRange[0]=e,this.TableRange[1]=n}setHueRange(e,n){this.HueRange[0]=e,this.HueRange[1]=n}setSaturationRange(e,n){this.SaturationRange[0]=e,this.SaturationRange[1]=n}setValueRange(e,n){this.ValueRange[0]=e,this.ValueRange[1]=n}setRange(e,n){this.InputRange[0]=e,this.InputRange[1]=n}setAlphaRange(e,n){this.AlphaRange[0]=e,this.AlphaRange[1]=n}getColor(e){return this.mapValue(e)}build(e){if(this.Table.length>1&&!e)return;this.Table=[];const n=this.NumberOfColors-1;let r,i,a,o;n?(r=(this.HueRange[1]-this.HueRange[0])/n,i=(this.SaturationRange[1]-this.SaturationRange[0])/n,a=(this.ValueRange[1]-this.ValueRange[0])/n,o=(this.AlphaRange[1]-this.AlphaRange[0])/n):r=i=a=o=0;for(let s=0;s<=n;s++){const l=this.HueRange[0]+s*r,c=this.SaturationRange[0]+s*i,f=this.ValueRange[0]+s*a,u=this.AlphaRange[0]+s*o,d=c_e(l,c,f),h=[0,0,0,0];switch(this.Ramp){case"scurve":h[0]=Math.floor(127.5*(1+Math.cos((1-d[0])*Math.PI))),h[1]=Math.floor(127.5*(1+Math.cos((1-d[1])*Math.PI))),h[2]=Math.floor(127.5*(1+Math.cos((1-d[2])*Math.PI))),h[3]=Math.floor(u*255);break;case"linear":h[0]=Math.floor(d[0]*255+.5),h[1]=Math.floor(d[1]*255+.5),h[2]=Math.floor(d[2]*255+.5),h[3]=Math.floor(u*255+.5);break;case"sqrt":h[0]=Math.floor(Math.sqrt(d[0])*255+.5),h[1]=Math.floor(Math.sqrt(d[1])*255+.5),h[2]=Math.floor(Math.sqrt(d[2])*255+.5),h[3]=Math.floor(Math.sqrt(u)*255+.5);break;default:throw new Error(`Invalid Ramp value (${this.Ramp})`)}this.Table.push(h)}this.buildSpecialColors()}buildSpecialColors(){const e=this.NumberOfColors,n=e+N6,r=e+L6,i=e+l_e;this.UseBelowRangeColor||e===0?this.Table[n]=this.BelowRangeColor:this.Table[n]=this.Table[0],this.UseAboveRangeColor||e===0?this.Table[r]=this.AboveRangeColor:this.Table[r]=this.Table[e-1],this.Table[i]=this.NaNColor}mapValue(e){const n=this.getIndex(e);if(n<0)return this.NaNColor;if(n===0){if(this.UseBelowRangeColor&&e<this.TableRange[0])return this.BelowRangeColor}else if(n===this.NumberOfColors-1&&this.UseAboveRangeColor&&e>this.TableRange[1])return this.AboveRangeColor;return this.Table[n]}getIndex(e){const n={Range:[],MaxIndex:this.NumberOfColors-1,Shift:-this.TableRange[0],Scale:1};if(this.TableRange[1]<=this.TableRange[0]?n.Scale=Number.MAX_VALUE:n.Scale=n.MaxIndex/(this.TableRange[1]-this.TableRange[0]),n.Range[0]=this.TableRange[0],n.Range[1]=this.TableRange[1],isNaN(e))return-1;let r=u_e(e,n);return r===this.NumberOfColors+N6?r=0:r===this.NumberOfColors+L6&&(r=this.NumberOfColors-1),r}setTableValue(e,n,r,i,a){let o;if(typeof n=="number"&&r!==void 0&&i!==void 0&&a!==void 0)o=[n,r,i,a];else if(Array.isArray(n))o=n;else throw new Error("Invalid arguments for setTableValue");if(e<0)throw new Error(`Can't set the table value for negative index (${e})`);if(e>=this.NumberOfColors)throw new Error(`Index ${e} is greater than the number of colors ${this.NumberOfColors}`);this.Table[e]=o,(e===0||e===this.NumberOfColors-1)&&this.buildSpecialColors()}}const gk=[0,0,0,0];function f_e(t,e,n){n=n===null?100:n;const r=(e-t)/(n-1),i=[];for(;n-- >0;)i.push(t),t+=r;return i[i.length-1]=e,i}function d_e(t,e){let n=0,r=t.length-1;for(;n<=r;){const i=n+Math.floor((r-n)/2),a=t[i];if(a===e)return i;e<a?r=i-1:n=i+1}return n}function h_e(t,e){let n;const r=[],i=e.length;for(t.sort(function(a,o){return a-o}),n=0;n<i;n++)r[n]=d_e(t,e[n]);return r}function n8(t,e,n){let r;const i=[],a=[],o=[],s=[];for(n=n===null?1:n,r=0;r<e.length;r++){const f=e[r];i.push((t-1)*f[0]),a.push(f[1]),o.push(f[1])}const l=f_e(0,1,t);for(r=0;r<t;r++)l[r]=(t-1)*Math.pow(l[r],n);const c=h_e(i,l);for(r=1;r<t-1;r++){const f=c[r],u=(l[r]-i[f-1])/(i[f]-i[f-1]),d=a[f]-o[f-1];s[r]=u*d+o[f-1]}return s[0]=o[0],s[t-1]=a[e.length-1],s}function p_e(t,e,n){let r;const i=[];e=e===null?256:e,n=n===null?1:n;const a=n8(e,t.red,n),o=n8(e,t.green,n),s=n8(e,t.blue,n);for(r=0;r<e;r++){const l=Math.round(a[r]*255),c=Math.round(o[r]*255),f=Math.round(s[r]*255),u=[l,c,f,255];i.push(u)}return i}function g_e(t,e){let n=t6[t];return n||(n=t6[t]={name:"",colors:[]}),!n.colors&&n.segmentedData&&(n.colors=p_e(n.segmentedData,n.numColors,n.gamma)),{getId(){return t},getColorSchemeName(){return n.name},setColorSchemeName(i){n.name=i},getNumberOfColors(){return n.colors.length},setNumberOfColors(i){for(;n.colors.length<i;)n.colors.push(gk);n.colors.length=i},getColor(i){return this.isValidIndex(i)?n.colors[i]:gk},getColorRepeating(i){const a=n.colors.length;return i=a?i%a:0,this.getColor(i)},setColor(i,a){this.isValidIndex(i)&&(n.colors[i]=a)},addColor(i){n.colors.push(i)},insertColor(i,a){this.isValidIndex(i)&&n.colors.splice(i,1,a)},removeColor(i){this.isValidIndex(i)&&n.colors.splice(i,1)},clearColors(){n.colors=[]},buildLookupTable(i){if(!i)return;const a=n.colors.length;i.setNumberOfTableValues(a);for(let o=0;o<a;o++)i.setTableValue(o,n.colors[o])},createLookupTable(){const i=new KD;return this.buildLookupTable(i),i},isValidIndex(i){return i>=0&&i<n.colors.length}}}function m_e(t,e,n,r){let i=Vn();const a=t.voxelManager.getScalarData();t.stats.lastGetPixelDataTime=Vn()-i;const o=a.length,s=t.minPixelValue;let l=0,c=0,f,u,d;if(i=Vn(),n instanceof KD?d=n.Table:d=n,s<0)for(;c<o;)f=e[a[c++]+-s],u=d[f],r[l++]=u[0],r[l++]=u[1],r[l++]=u[2],r[l++]=u[3];else for(;c<o;)f=e[a[c++]],u=d[f],r[l++]=u[0],r[l++]=u[1],r[l++]=u[2],r[l++]=u[3];t.stats.lastStoredPixelDataToCanvasImageDataTime=Vn()-i}function v_e(t,e,n,r){let i=Vn();const a=t.voxelManager.getScalarData();t.stats.lastGetPixelDataTime=Vn()-i;const o=a.length,s=t.minPixelValue;let l=0,c=0,f,u,d;if(i=Vn(),n instanceof KD?d=n.Table:d=n,s<0)for(;c<o;)f=e(a[c++]+-s),u=d[f],r[l++]=u[0],r[l++]=u[1],r[l++]=u[2],r[l++]=u[3];else for(;c<o;)f=e(a[c++]),u=d[f],r[l++]=u[0],r[l++]=u[1],r[l++]=u[2],r[l++]=u[3];t.stats.lastStoredPixelDataToCanvasImageDataTime=Vn()-i}function k6(t,e,n){return Math.max(e,Math.min(n,t))}function y_e(t,e,n){t.renderingTools.renderCanvas||(t.renderingTools.renderCanvas=cy(null,e.width,e.height));const r=t.renderingTools.renderCanvas;let i=t.viewport.colormap||t.options.colormap;if(t.options&&t.options.colormap&&console.warn("enabledElement.options.colormap is deprecated. Use enabledElement.viewport.colormap instead"),i&&typeof i=="string"&&(i=g_e(i)),!i)throw new Error("renderPseudoColorImage: colormap not found.");const a=i.getId();if(!WD(t,e)&&!n&&t.renderingTools.colormapId===a)return r;(!t.renderingTools.renderCanvasContext||r.width!==e.width||r.height!==e.height)&&M3(t,e);let o=Vn();(!t.renderingTools.colorLUT||n||t.renderingTools.colormapId!==a)&&(i.setNumberOfColors(256),t.renderingTools.colorLUT=i.createLookupTable(),t.renderingTools.colormapId=a);const s=t.renderingTools.renderCanvasData,l=t.renderingTools.renderCanvasContext,{viewport:c}=t,f=t.renderingTools.colorLUT;if(c.modality==="PT"){const{windowWidth:u,windowCenter:d}=c.voi,h=d-u/2,m=255/(d+u/2-h);let y;c.invert?y=v=>k6(Math.floor(255-(v-h)*m),0,255):y=v=>k6(Math.floor((v-h)*m),0,255),v_e(e,y,f,s.data)}else{const u=sJ(e,t.viewport,n);e.stats=e.stats||{},e.stats.lastLutGenerateTime=Vn()-o,m_e(e,u,f,s.data)}return o=Vn(),l.putImageData(s,0,0),e.stats.lastPutImageDataTime=Vn()-o,r}function x_e(t,e){if(t===void 0)throw new Error("drawImage: enabledElement parameter must not be undefined");const n=t.image;if(n===void 0)throw new Error("drawImage: image must be loaded before it can be drawn");const r=t.canvas.getContext("2d");r.setTransform(1,0,0,1,0,0),r.fillStyle="black",r.fillRect(0,0,t.canvas.width,t.canvas.height),r.imageSmoothingEnabled=!t.viewport.pixelReplication,zD(t,r);const i=y_e(t,n,e),a=t.viewport.displayedArea.tlhc.x-1,o=t.viewport.displayedArea.tlhc.y-1,s=t.viewport.displayedArea.brhc.x-a,l=t.viewport.displayedArea.brhc.y-o;r.drawImage(i,a,o,s,l,0,0,s,l),t.renderingTools=HD(t)}function lJ(t,e){const n=t.image;if(!t.canvas||!t.image)return;const r=Vn();if(n.stats={lastGetPixelDataTime:-1,lastStoredPixelDataToCanvasImageDataTime:-1,lastPutImageDataTime:-1,lastRenderTime:-1,lastLutGenerateTime:-1},n){let a=n.render;a||(t.viewport.colormap?a=x_e:n.color?a=Y6e:a=s_e),a(t,e)}const i=Vn()-r;n.stats.lastRenderTime=i,t.invalid=!1,t.needsRedraw=!1}function cJ(t){return S2(t)}function hx(t,e){const n=cJ(t);return n.invert(),n.transformPoint(e)}const b_e={viewport:{}};function w_e(){return{tlhc:{x:1,y:1},brhc:{x:1,y:1},rowPixelSpacing:1,columnPixelSpacing:1,presentationSizeMode:"NONE"}}function C_e(){const t=w_e(),e={scale:1,translation:{x:0,y:0},voi:{windowWidth:void 0,windowCenter:void 0,voiLUTFunction:oo.LINEAR},invert:!1,pixelReplication:!1,rotation:0,hflip:!1,vflip:!1,modalityLUT:void 0,voiLUT:void 0,colormap:void 0,labelmap:!1,displayedArea:t};return Object.assign({},e,b_e.viewport)}function Fv(t,e){if(t==null)throw new Error(e)}function S_e(t){return!(t==null||t===0||t===180)}function uJ(t,e=null){return Fv(t,"getImageSize: parameter image must not be undefined"),Fv(t.width,"getImageSize: parameter image must have width"),Fv(t.height,"getImageSize: parameter image must have height"),S_e(e)?{height:t.width,width:t.height}:{width:t.width,height:t.height}}function qD(t,e,n=null){Fv(t,"getImageScale: parameter canvas must not be undefined"),Fv(e,"getImageScale: parameter image must not be undefined");const r=uJ(e,n),i=e.rowPixelSpacing||1,a=e.columnPixelSpacing||1;let o=1,s=1;i<a?s=a/i:o=i/a;const l=t.height/r.height/o,c=t.width/r.width/s;return{verticalScale:l,horizontalScale:c,scaleFactor:Math.min(c,l)}}function fJ(t,e,n,r){if(t===void 0)throw new Error("getDefaultViewport: parameter canvas must not be undefined");if(e===void 0)return C_e();const i=qD(t,e,0).scaleFactor;let a;return n==="PT"&&e.isPreScaled?a={windowWidth:5,windowCenter:2.5}:e.windowWidth!==void 0&&e.windowCenter!==void 0&&(a={windowWidth:Array.isArray(e.windowWidth)?e.windowWidth[0]:e.windowWidth,windowCenter:Array.isArray(e.windowCenter)?e.windowCenter[0]:e.windowCenter}),{scale:i,translation:{x:0,y:0},voi:a,invert:e.invert,pixelReplication:!1,rotation:0,hflip:!1,vflip:!1,modalityLUT:e.modalityLUT,modality:n,voiLUT:e.voiLUT,colormap:r!==void 0?r:e.colormap,displayedArea:{tlhc:{x:1,y:1},brhc:{x:e.columns,y:e.rows},rowPixelSpacing:e.rowPixelSpacing===void 0?1:e.rowPixelSpacing,columnPixelSpacing:e.columnPixelSpacing===void 0?1:e.columnPixelSpacing,presentationSizeMode:"NONE"}}}function mk(t,e){return cJ(t).transformPoint(e)}function T_e(t){const{image:e}=t;t.viewport.scale=qD(t.canvas,e,t.viewport.rotation).scaleFactor,t.viewport.translation.x=0,t.viewport.translation.y=0}function E_e(t){const{canvas:e}=t,{clientWidth:n,clientHeight:r}=e;(e.width!==n||e.height!==r)&&(e.width=n,e.height=r)}function __e(t,e,n){const r=t.viewport.scale,i=uJ(t.image,t.viewport.rotation),a=Math.round(i.width*r),o=Math.round(i.height*r),s=t.viewport.translation.x,l=t.viewport.translation.y;return a===e&&o<=n||a<=e&&o===n&&s===0&&l===0}function D_e(t,e,n){const r=t.viewport.scale,i=t.canvas.width,a=t.canvas.height,o=i/e,s=a/n,l=Math.sqrt(o*s);t.viewport.scale=l*r}function O_e(t,e=!1){const n=t.canvas.width,r=t.canvas.height;E_e(t),t.image!==void 0&&(e||__e(t,n,r)?T_e(t):D_e(t,n,r))}function M_e(t,e){const{hflip:n,vflip:r,rotation:i}=e;if(t.x*=n?-1:1,t.y*=r?-1:1,i!==0){const a=i*Math.PI/180,o=Math.cos(a),s=Math.sin(a),l=t.x*o-t.y*s,c=t.x*s+t.y*o;t.x=l,t.y=c}return t}function I_e(t,e=!0,n=!0){const{canvas:r,image:i,viewport:a}=t,o=qD(r,i,0).scaleFactor;a.vflip=!1,a.hflip=!1,e&&(a.translation.x=0,a.translation.y=0),n&&(a.displayedArea.tlhc.x=1,a.displayedArea.tlhc.y=1,a.displayedArea.brhc.x=i.columns,a.displayedArea.brhc.y=i.rows,a.scale=o)}const vk=jD.getLogger("utilities","getClosestImageId");function ep(t,e,n,r){const{direction:i,spacing:a,imageIds:o}=t,{ignoreSpacing:s=!1}=r||{};if(!o?.length)return;const l=i.slice(6,9),c=zt(l,n);if(Math.abs(c)<1-Qs)return;let f;s||(f=fp({direction:i,spacing:a},n)/2);let u,d=1/0;for(let h=0;h<o.length;h++){const p=o[h],g=Ft("imagePlaneModule",p);if(!g?.imagePositionPatient){vk.warn(`Missing imagePositionPatient for imageId: ${p}`);continue}const{imagePositionPatient:m}=g,y=ct();ur(y,e,m);const v=Math.abs(zt(y,n));s?v<d&&(d=v,u=p):v<f&&v<d&&(d=v,u=p)}return u===void 0&&vk.warn("No imageId found within the specified criteria (half spacing or absolute closest)."),u}function R_e(t,e){const n=zt(t,e),r=Xs(ct(),e,2*n);return ur(ct(),t,r)}function yk(t,e,n,r){let i=rK(t);if(n&&su(i,i),e){const a=dr(ct(),r,i);Ir(a,a),i=R_e(i,a)}return i}const xk=jD.getLogger("RenderingEngine","StackViewport");class aa extends Qh{constructor(e){super(e),this.imageIds=[],this.imageKeyToIndexMap=new Map,this.currentImageIdIndex=0,this.targetImageIdIndex=0,this.imagesLoader=this,this.globalDefaultProperties={},this.perImageIdDefaultProperties=new Map,this.voiUpdatedWithSetProperties=!1,this.invert=!1,this.initialInvert=!1,this.initialTransferFunctionNodes=null,this.stackInvalidated=!1,this._publishCalibratedEvent=!1,this.updateRenderingPipeline=()=>{this._configureRenderingPipeline()},this.resize=()=>{this.useCPURendering&&this._resizeCPU()},this._resizeCPU=()=>{this._cpuFallbackEnabledElement.viewport&&O_e(this._cpuFallbackEnabledElement)},this.getFrameOfReferenceUID=n=>this.getImagePlaneReferenceData(n)?.FrameOfReferenceUID,this.getCornerstoneImage=()=>this.csImage,this.createActorMapper=n=>{const r=y6e.newInstance();r.setInputData(n);const i=O6e.newInstance();i.setMapper(r);const{preferSizeOverAccuracy:a}=Pf().rendering;return a&&r.setPreferSizeOverAccuracy(!0),n.getPointData().getScalars().getNumberOfComponents()>1&&i.getProperty().setIndependentComponents(!1),i},this.getNumberOfSlices=()=>this.imageIds.length,this.getDefaultProperties=n=>{let r;return n!==void 0&&(r=this.perImageIdDefaultProperties.get(n)),r!==void 0?r:{...this.globalDefaultProperties}},this.getProperties=()=>{const{colormap:n,voiRange:r,VOILUTFunction:i,interpolationType:a,invert:o,voiUpdatedWithSetProperties:s}=this;return{colormap:n,voiRange:r,VOILUTFunction:i,interpolationType:a,invert:o,isComputedVOI:!s}},this.resetCameraForResize=()=>this.resetCamera({resetPan:!0,resetZoom:!0,resetToCenter:!0,suppressEvents:!0}),this.getRotationCPU=()=>{const{viewport:n}=this._cpuFallbackEnabledElement;return n.rotation},this.getRotationGPU=()=>{const{viewUp:n,viewPlaneNormal:r,flipVertical:i,flipHorizontal:a}=this.getCameraNoRotation(),o=yk(this.initialViewUp,a,i,r),l=aK(o,n)*180/Math.PI,c=dr(ct(),o,n);return zt(c,r)>=0?l:(360-l)%360},this.setRotation=n=>{const r=this.getCamera();if(this.useCPURendering?this.setRotationCPU(n):this.setRotationGPU(n),this._suppressCameraModifiedEvents)return;const i=this.getCamera(),a={previousCamera:r,camera:i,element:this.element,viewportId:this.id,renderingEngineId:this.renderingEngineId};Ct(this.element,vt.CAMERA_MODIFIED,a)},this.renderImageObject=n=>{this._setCSImage(n),(this.useCPURendering?this._updateToDisplayImageCPU:this._updateActorToDisplayImageId).call(this,n)},this._setCSImage=n=>{n.isPreScaled=n.preScale?.scaled,this.csImage=n},this.canvasToWorldCPU=(n,r=[0,0,0])=>{if(!this._cpuFallbackEnabledElement.image)return;const[i,a]=hx(this._cpuFallbackEnabledElement,n),{origin:o,spacing:s,direction:l}=this.getImageData(),c=l.slice(0,3),f=l.slice(3,6);return Or(r,o,c,i*s[0]),Or(r,r,f,a*s[1]),r},this.worldToCanvasCPU=n=>{const{spacing:r,direction:i,origin:a}=this.getImageData(),o=i.slice(0,3),s=i.slice(3,6),l=Dr(ct(),n,a),c=[zt(l,o)/r[0],zt(l,s)/r[1]];return mk(this._cpuFallbackEnabledElement,c)},this.canvasToWorldGPUContextPool=n=>{const r=this.getRenderer(),i=this.getVtkActiveCamera(),a=i.getClippingRange(),o=i.getDistance();i.setClippingRange(o,o+.1);const s=window.devicePixelRatio||1,{width:l,height:c}=this.canvas,f=l/c,u=[n[0]*s,n[1]*s],d=[u[0]/l,1-u[1]/c,0],h=r.normalizedDisplayToProjection(d[0],d[1],d[2]),p=r.projectionToView(h[0],h[1],h[2],f),g=r.viewToWorld(p[0],p[1],p[2]);return i.setClippingRange(a[0],a[1]),[g[0],g[1],g[2]]},this.canvasToWorldGPUTiled=n=>{const r=this.getRenderer(),i=this.getVtkActiveCamera(),a=i.getClippingRange(),o=i.getDistance();i.setClippingRange(o,o+.1);const l=this.getRenderingEngine().offscreenMultiRenderWindow.getOpenGLRenderWindow(),c=l.getSize(),f=window.devicePixelRatio||1,u=[n[0]*f,n[1]*f],d=[u[0]+this.sx,u[1]+this.sy];d[1]=c[1]-d[1];const h=l.displayToWorld(d[0],d[1],0,r);return i.setClippingRange(a[0],a[1]),[h[0],h[1],h[2]]},this.worldToCanvasGPUContextPool=n=>{const r=this.getRenderer(),i=this.getVtkActiveCamera(),a=i.getClippingRange(),o=i.getDistance();i.setClippingRange(o,o+.1);const s=window.devicePixelRatio||1,{width:l,height:c}=this.canvas,f=l/c,u=r.worldToView(n[0],n[1],n[2]),d=r.viewToProjection(u[0],u[1],u[2],f),h=r.projectionToNormalizedDisplay(d[0],d[1],d[2]),p=h[0]*l,g=(1-h[1])*c;return i.setClippingRange(a[0],a[1]),[p/s,g/s]},this.worldToCanvasGPUTiled=n=>{const r=this.getRenderer(),i=this.getVtkActiveCamera(),a=i.getClippingRange(),o=i.getDistance();i.setClippingRange(o,o+.1);const l=this.getRenderingEngine().offscreenMultiRenderWindow.getOpenGLRenderWindow(),c=l.getSize(),f=l.worldToDisplay(...n,r);f[1]=c[1]-f[1];const u=[f[0]-this.sx,f[1]-this.sy];i.setClippingRange(a[0],a[1]);const d=window.devicePixelRatio||1;return[u[0]/d,u[1]/d]},this.getCurrentImageIdIndex=()=>this.currentImageIdIndex,this.getSliceIndex=()=>this.currentImageIdIndex,this.getTargetImageIdIndex=()=>this.targetImageIdIndex,this.getImageIds=()=>this.imageIds,this.getCurrentImageId=(n=this.getCurrentImageIdIndex())=>this.imageIds[n],this.hasImageId=n=>this.imageKeyToIndexMap.has(n),this.hasImageURI=n=>this.imageKeyToIndexMap.has(n),this.customRenderViewportToCanvas=()=>{if(!this.useCPURendering)throw new Error("Custom cpu rendering pipeline should only be hit in CPU rendering mode");return this._cpuFallbackEnabledElement.image?(lJ(this._cpuFallbackEnabledElement,this.cpuRenderingInvalidated),this.cpuRenderingInvalidated=!1):this.fillWithBackgroundColor(),{canvas:this.canvas,element:this.element,viewportId:this.id,renderingEngineId:this.renderingEngineId,viewportStatus:this.viewportStatus}},this.renderingPipelineFunctions={getImageData:{cpu:this.getImageDataCPU,gpu:this.getImageDataGPU},setColormap:{cpu:this.setColormapCPU,gpu:this.setColormapGPU},getCamera:{cpu:this.getCameraCPU,gpu:super.getCamera},setCamera:{cpu:this.setCameraCPU,gpu:super.setCamera},getPan:{cpu:this.getPanCPU,gpu:super.getPan},setPan:{cpu:this.setPanCPU,gpu:super.setPan},getZoom:{cpu:this.getZoomCPU,gpu:super.getZoom},setZoom:{cpu:this.setZoomCPU,gpu:super.setZoom},setVOI:{cpu:this.setVOICPU,gpu:this.setVOIGPU},getRotation:{cpu:this.getRotationCPU,gpu:this.getRotationGPU},setInterpolationType:{cpu:this.setInterpolationTypeCPU,gpu:this.setInterpolationTypeGPU},setInvertColor:{cpu:this.setInvertColorCPU,gpu:this.setInvertColorGPU},resetCamera:{cpu:(n={})=>{const{resetPan:r=!0,resetZoom:i=!0}=n;return this.resetCameraCPU({resetPan:r,resetZoom:i}),!0},gpu:(n={})=>{const{resetPan:r=!0,resetZoom:i=!0}=n;return this.resetCameraGPU({resetPan:r,resetZoom:i}),!0}},canvasToWorld:{cpu:this.canvasToWorldCPU,gpu:{tiled:this.canvasToWorldGPUTiled,contextPool:this.canvasToWorldGPUContextPool}},worldToCanvas:{cpu:this.worldToCanvasCPU,gpu:{tiled:this.worldToCanvasGPUTiled,contextPool:this.worldToCanvasGPUContextPool}},getRenderer:{cpu:()=>this.getCPUFallbackError("getRenderer"),gpu:{tiled:this.getRendererTiled,contextPool:this.getRendererContextPool}},getDefaultActor:{cpu:()=>this.getCPUFallbackError("getDefaultActor"),gpu:super.getDefaultActor},getActors:{cpu:()=>this.getCPUFallbackError("getActors"),gpu:super.getActors},getActor:{cpu:()=>this.getCPUFallbackError("getActor"),gpu:super.getActor},setActors:{cpu:()=>this.getCPUFallbackError("setActors"),gpu:super.setActors},addActors:{cpu:()=>this.getCPUFallbackError("addActors"),gpu:super.addActors},addActor:{cpu:()=>this.getCPUFallbackError("addActor"),gpu:super.addActor},removeAllActors:{cpu:()=>this.getCPUFallbackError("removeAllActors"),gpu:super.removeAllActors},unsetColormap:{cpu:this.unsetColormapCPU,gpu:this.unsetColormapGPU}},this.scaling={},this.modality=null,this.useCPURendering=Bg(),this._configureRenderingPipeline(),this.useCPURendering?this._resetCPUFallbackElement():this._resetGPUViewport(),this.currentImageIdIndex=0,this.targetImageIdIndex=0,this.resetCamera(),this.initializeElementDisabledHandler()}setUseCPURendering(e){this.useCPURendering=e,this._configureRenderingPipeline(e)}static get useCustomRenderingPipeline(){return Bg()}_configureRenderingPipeline(e){const n=XY();this.useCPURendering=e??Bg();for(const r in this.renderingPipelineFunctions)if(Object.prototype.hasOwnProperty.call(this.renderingPipelineFunctions,r)){const i=this.renderingPipelineFunctions[r];this.useCPURendering?this[r]=i.cpu:typeof i.gpu=="object"&&i.gpu.tiled&&i.gpu.contextPool?this[r]=n?i.gpu.contextPool:i.gpu.tiled:this[r]=i.gpu}this.useCPURendering?this._resetCPUFallbackElement():this._resetGPUViewport()}_resetCPUFallbackElement(){this._cpuFallbackEnabledElement={canvas:this.canvas,renderingTools:{},transform:new Bm,viewport:{rotation:0}}}_resetGPUViewport(){const e=this.getRenderer(),n=_D.newInstance();e.setActiveCamera(n),this.initialViewUp=[0,-1,0],n.setDirectionOfProjection(-0,-0,1),n.setViewUp(...this.initialViewUp),n.setParallelProjection(!0),n.setThicknessFromFocalPoint(.1),n.setFreezeFocalPoint(!0)}initializeElementDisabledHandler(){St.addEventListener(vt.ELEMENT_DISABLED,function e(){clearTimeout(this.debouncedTimeout),St.removeEventListener(vt.ELEMENT_DISABLED,e)})}getImageDataGPU(){const e=this.getDefaultActor();if(!e||!uc(e))return;const{actor:n}=e,r=n.getMapper().getInputData(),i=this.csImage;return{dimensions:r.getDimensions(),spacing:r.getSpacing(),origin:r.getOrigin(),direction:r.getDirection(),get scalarData(){return i?.voxelManager.getScalarData()},imageData:n.getMapper().getInputData(),metadata:{Modality:this.modality,FrameOfReferenceUID:this.getFrameOfReferenceUID()},scaling:this.scaling,hasPixelSpacing:this.hasPixelSpacing,calibration:{...i?.calibration,...this.calibration},preScale:{...i?.preScale},voxelManager:i?.voxelManager}}getImageDataCPU(){const{metadata:e}=this._cpuFallbackEnabledElement;if(!e)return;const n=e.spacing,r=this.csImage;return{dimensions:e.dimensions,spacing:n,origin:e.origin,direction:e.direction,metadata:{Modality:this.modality,FrameOfReferenceUID:this.getFrameOfReferenceUID()},scaling:this.scaling,imageData:{getDirection:()=>e.direction,getDimensions:()=>e.dimensions,getScalarData:()=>this.cpuImagePixelData,getSpacing:()=>n,worldToIndex:i=>{const a=this.worldToCanvasCPU(i),o=hx(this._cpuFallbackEnabledElement,a);return[o[0],o[1],0]},indexToWorld:(i,a)=>{const o=mk(this._cpuFallbackEnabledElement,[i[0],i[1]]);return this.canvasToWorldCPU(o,a)}},scalarData:this.cpuImagePixelData,hasPixelSpacing:this.hasPixelSpacing,calibration:{...r?.calibration,...this.calibration},preScale:{...r?.preScale},voxelManager:r?.voxelManager}}calibrateIfNecessary(e,n){const r=Ft("calibratedPixelSpacing",e),i=this.calibration!==r,{scale:a}=r||{};return this.hasPixelSpacing=a>0||n.rowPixelSpacing>0,n.calibration=r,i&&(this.calibration=r,this._publishCalibratedEvent=!0,this._calibrationEvent={scale:a,calibration:r}),n}setDefaultProperties(e,n){n==null?this.globalDefaultProperties=e:(this.perImageIdDefaultProperties.set(n,e),this.getCurrentImageId()===n&&this.setProperties(e))}clearDefaultProperties(e){e==null?(this.globalDefaultProperties={},this.resetProperties()):(this.perImageIdDefaultProperties.delete(e),this.resetToDefaultProperties())}setProperties({colormap:e,voiRange:n,VOILUTFunction:r,invert:i,interpolationType:a}={},o=!1){this.viewportStatus=this.csImage?So.PRE_RENDER:So.LOADING,this.globalDefaultProperties={colormap:this.globalDefaultProperties.colormap??e,voiRange:this.globalDefaultProperties.voiRange??n,VOILUTFunction:this.globalDefaultProperties.VOILUTFunction??r,invert:this.globalDefaultProperties.invert??i,interpolationType:this.globalDefaultProperties.interpolationType??a},typeof e<"u"&&this.setColormap(e),typeof n<"u"&&this.setVOI(n,{suppressEvents:o,voiUpdatedWithSetProperties:!0}),typeof r<"u"&&this.setVOILUTFunction(r,o),typeof i<"u"&&this.setInvertColor(i),typeof a<"u"&&this.setInterpolationType(a)}resetProperties(){this.cpuRenderingInvalidated=!0,this.voiUpdatedWithSetProperties=!1,this.viewportStatus=So.PRE_RENDER,this.fillWithBackgroundColor(),this.useCPURendering&&(this._cpuFallbackEnabledElement.renderingTools={}),this._resetProperties(),this.render()}_resetProperties(){let e;if(this._isCurrentImagePTPrescaled()?e=this._getDefaultPTPrescaledVOIRange():e=this._getVOIRangeForCurrentImage(),this.setVOI(e),this.setInvertColor(this.initialInvert),this.setInterpolationType(bf.LINEAR),!this.useCPURendering){const n=this.getTransferFunction();zw(n,this.initialTransferFunctionNodes);const i=u3(n).reduce((s,l)=>(s.push(l[0],l[1],l[2],l[3]),s),[]),a=this.getDefaultActor(),o=j9(i,a.actor);this.setColormap(o)}}resetToDefaultProperties(){this.cpuRenderingInvalidated=!0,this.viewportStatus=So.PRE_RENDER,this.fillWithBackgroundColor(),this.useCPURendering&&(this._cpuFallbackEnabledElement.renderingTools={});const e=this.getCurrentImageId(),n=this.perImageIdDefaultProperties.get(e)||this.globalDefaultProperties;n.colormap?.name&&this.setColormap(n.colormap);let r;n.voiRange==null?r=this._getVOIRangeForCurrentImage():r=n.voiRange,this.setVOI(r),this.setInterpolationType(bf.LINEAR),this.setInvertColor(!1),this.render()}_getVOIFromCache(){let e;return this.voiUpdatedWithSetProperties?e=this.voiRange:this._isCurrentImagePTPrescaled()?e=this._getDefaultPTPrescaledVOIRange():e=this._getVOIRangeForCurrentImage()??this.voiRange,e}_setPropertiesFromCache(){const e=this._getVOIFromCache(),{interpolationType:n,invert:r}=this;this.setVOI(e),this.setInterpolationType(n),this.setInvertColor(r)}getCameraCPU(){const{metadata:e,viewport:n}=this._cpuFallbackEnabledElement;if(!e)return{};const{direction:r}=e,i=r.slice(6,9).map(u=>-u);let a=r.slice(3,6).map(u=>-u);if(n.rotation){const u=tye(h0(),n.rotation*Math.PI/180,i);a=v2(ct(),a,u)}const o=[this.element.clientWidth/2,this.element.clientHeight/2],s=this.canvasToWorld(o),l=this.canvasToWorld([0,0]),c=this.canvasToWorld([0,this.element.clientHeight]),f=el(l,c)/2;return{parallelProjection:!0,focalPoint:s,position:[0,0,0],parallelScale:f,scale:n.scale,viewPlaneNormal:[i[0],i[1],i[2]],viewUp:[a[0],a[1],a[2]],flipHorizontal:this.flipHorizontal,flipVertical:this.flipVertical}}setCameraCPU(e){const{viewport:n,image:r}=this._cpuFallbackEnabledElement,i=this.getCameraCPU(),{focalPoint:a,parallelScale:o,scale:s,flipHorizontal:l,flipVertical:c}=e,{clientHeight:f}=this.element;if(a){const d=this.worldToCanvasCPU(a),h=hx(this._cpuFallbackEnabledElement,d),p=this.worldToCanvasCPU(i.focalPoint),g=hx(this._cpuFallbackEnabledElement,p),m=Hn();Ra(m,fL(h[0],h[1]),fL(g[0],g[1]));const y=M_e({x:m[0],y:m[1]},n);n.translation.x-=y.x,n.translation.y-=y.y}if(o){const{rowPixelSpacing:d}=r,h=f*d*.5/o;n.scale=h,n.parallelScale=o}if(s){const{rowPixelSpacing:d}=r;n.scale=s,n.parallelScale=f*d*.5/s}(l!==void 0||c!==void 0)&&this.setFlipCPU({flipHorizontal:l,flipVertical:c}),this._cpuFallbackEnabledElement.transform=S2(this._cpuFallbackEnabledElement);const u={previousCamera:i,camera:this.getCamera(),element:this.element,viewportId:this.id,renderingEngineId:this.renderingEngineId};Ct(this.element,vt.CAMERA_MODIFIED,u)}getPanCPU(){const{viewport:e}=this._cpuFallbackEnabledElement;return[e.translation.x,e.translation.y]}setPanCPU(e){const n=this.getCameraCPU();this.setCameraCPU({...n,focalPoint:[...e.map(r=>-r),0]})}getZoomCPU(){const{viewport:e}=this._cpuFallbackEnabledElement;return e.scale}setZoomCPU(e){const n=this.getCameraCPU();this.setCameraCPU({...n,scale:e})}setFlipCPU({flipHorizontal:e,flipVertical:n}){const{viewport:r}=this._cpuFallbackEnabledElement;e!==void 0&&(r.hflip=e,this.flipHorizontal=r.hflip),n!==void 0&&(r.vflip=n,this.flipVertical=r.vflip)}setVOILUTFunction(e,n){if(this.useCPURendering)throw new Error("VOI LUT function is not supported in CPU rendering");const r=this._getValidVOILUTFunction(e);let i=!1;this.VOILUTFunction!==r&&(i=!0),this.VOILUTFunction=r;const{voiRange:a}=this.getProperties();this.setVOI(a,{suppressEvents:n,forceRecreateLUTFunction:i})}setRotationCPU(e){const{viewport:n}=this._cpuFallbackEnabledElement;n.rotation=e}setRotationGPU(e){const n=this.getPan(this.fitToCanvasCamera),r=this.getPan(),i=Yh([0,0],n,r);this.setPan(i,!1);const{flipVertical:a,flipHorizontal:o,viewPlaneNormal:s}=this.getCamera(),l=yk(this.initialViewUp,o,a,s);this.setCameraNoEvent({viewUp:l}),this.getVtkActiveCamera().roll(-e);const c=this.getPan(),f=this.getPan(this.fitToCanvasCamera),u=Yh([0,0],c,f),d=jw([0,0],n,u);this.setPan(d,!1)}setInterpolationTypeGPU(e){const n=this.getDefaultActor();if(!n||!uc(n))return;const{actor:r}=n;r.getProperty().setInterpolationType(e),this.interpolationType=e}setInterpolationTypeCPU(e){const{viewport:n}=this._cpuFallbackEnabledElement;n.pixelReplication=e!==bf.LINEAR,this.interpolationType=e}setInvertColorCPU(e){const{viewport:n}=this._cpuFallbackEnabledElement;n&&(n.invert=e,this.invert=e)}setInvertColorGPU(e){const n=this.getDefaultActor();if(n&&uc(n)){if(Jo(n,"vtkVolume")){const i=n.actor.getProperty().getRGBTransferFunction(0);(!this.invert&&e||this.invert&&!e)&&Lv(i),this.invert=e}else if(Jo(n,"vtkImageSlice")){const i=n.actor.getProperty().getRGBTransferFunction(0);(!this.invert&&e||this.invert&&!e)&&Lv(i),this.invert=e}}}setVOICPU(e,n={}){const{suppressEvents:r=!1}=n,{viewport:i,image:a}=this._cpuFallbackEnabledElement;if(!i||!a)return;if(typeof e>"u"){const{windowWidth:s,windowCenter:l}=a,c=Array.isArray(s)?s[0]:s,f=Array.isArray(l)?l[0]:l;i.voi={windowWidth:c,windowCenter:f,voiLUTFunction:a.voiLUTFunction};const{lower:u,upper:d}=Gg(c,f,a.voiLUTFunction);e={lower:u,upper:d}}else{const{lower:s,upper:l}=e,{windowCenter:c,windowWidth:f}=ry(s,l);i.voi||(i.voi={windowWidth:0,windowCenter:0,voiLUTFunction:a.voiLUTFunction}),i.voi.windowWidth=f,i.voi.windowCenter=c}this.voiRange=e;const o={viewportId:this.id,range:e};r||Ct(this.element,vt.VOI_MODIFIED,o)}getTransferFunction(){const e=this.getDefaultActor();return!e||!uc(e)?void 0:e.actor.getProperty().getRGBTransferFunction(0)}setVOIGPU(e,n={}){const{suppressEvents:r=!1,forceRecreateLUTFunction:i=!1,voiUpdatedWithSetProperties:a=!1}=n;if(e&&this.voiRange&&this.voiRange.lower===e.lower&&this.voiRange.upper===e.upper&&!i&&!this.stackInvalidated)return;const o=this.getDefaultActor();if(!o||!uc(o))return;const s=o.actor;let l=e;if(typeof l>"u"){const h=s.getMapper().getInputData().getPointData().getScalars().getRange();l={lower:h[0],upper:h[1]}}s.getProperty().setUseLookupTableScalarRange(!0);let c=s.getProperty().getRGBTransferFunction(0);const f=this.VOILUTFunction===oo.SAMPLED_SIGMOID;if((f||!c||i)&&(c=(f?K9:nJ)(l),this.invert&&Lv(c),s.getProperty().setRGBTransferFunction(0,c),this.initialTransferFunctionNodes=u3(c)),f||c.setRange(l.lower,l.upper),this.voiRange=l,this.voiUpdatedWithSetProperties||(this.voiUpdatedWithSetProperties=a),r)return;const u={viewportId:this.id,range:l,VOILUTFunction:this.VOILUTFunction};Ct(this.element,vt.VOI_MODIFIED,u)}_addScalingToViewport(e){if(this.scaling.PT)return;const{suvbw:n,suvlbm:r,suvbsa:i}=e,a={};r&&(a.suvbwToSuvlbm=r/n),i&&(a.suvbwToSuvbsa=i/n),this.scaling.PT=a}getImageDataMetadata(e){const n=e.imageId,r=$D(e),{numberOfComponents:i,origin:a,direction:o,dimensions:s,spacing:l,numVoxels:c,imagePixelModule:f,voiLUTFunction:u,modality:d,scalingFactor:h,calibration:p}=r;d==="PT"&&h&&this._addScalingToViewport(h),this.modality=d;const g=this._getValidVOILUTFunction(u);this.VOILUTFunction=g,this.calibration=p;let m=this._getImagePlaneModule(n);return this.useCPURendering||(m=this.calibrateIfNecessary(n,m)),{bitsAllocated:f.bitsAllocated,numberOfComponents:i,origin:a,direction:o,dimensions:s,spacing:l,numVoxels:c,imagePlaneModule:m,imagePixelModule:f}}matchImagesForOverlay(e,n){return(i=>{const a=Ft(Yo.IMAGE_PLANE,n),o=Ft(Yo.IMAGE_PLANE,i),s=a.imageOrientationPatient,l=o.imageOrientationPatient;if(s&&l){if(fr(a.imageOrientationPatient,o.imageOrientationPatient)){const f=a.imagePositionPatient,u=o.imagePositionPatient;if(f&&u&&fr(f,u)){const h=a.rows,p=a.columns,g=o.rows,m=o.columns;if(h===g&&p===m)return i}}}else{const c=a.rows,f=a.columns,u=o.rows,d=o.columns;if(c===u&&f===d)return i}})(e)}getImagePlaneReferenceData(e=this.getCurrentImageIdIndex()){const n=this.imageIds[e];if(!n)return;const r=Ft(Yo.IMAGE_PLANE,n);if(!r)return;const{imagePositionPatient:i,frameOfReferenceUID:a}=r;let{rowCosines:o,columnCosines:s}=r;o||=[1,0,0],s||=[0,1,0];const l=dr([0,0,0],s,o);return{FrameOfReferenceUID:a,viewPlaneNormal:l,cameraFocalPoint:i,referencedImageId:n,sliceIndex:e}}_getCameraOrientation(e){const n=e.slice(6,9).map(i=>-i),r=e.slice(3,6).map(i=>-i);return{viewPlaneNormal:[n[0],n[1],n[2]],viewUp:[r[0],r[1],r[2]]}}createVTKImageData({origin:e,direction:n,dimensions:r,spacing:i,numberOfComponents:a,pixelArray:o}){const s=new o.constructor(o.length),l=nn.newInstance({name:"Pixels",numberOfComponents:a,values:s}),c=Zw.newInstance();return c.setDimensions(r),c.setSpacing(i),c.setDirection(n),c.setOrigin(e),c.getPointData().setScalars(l),c}_createVTKImageData({origin:e,direction:n,dimensions:r,spacing:i,numberOfComponents:a,pixelArray:o}){try{this._imageData=this.createVTKImageData({origin:e,direction:n,dimensions:r,spacing:i,numberOfComponents:a,pixelArray:o})}catch(s){xk.error(s)}}async setStack(e,n=0){if(this._throwIfDestroyed(),this.imageIds=e,n>e.length)throw new Error("Current image index is greater than the number of images in the stack");this.imageKeyToIndexMap.clear(),e.forEach((o,s)=>{this.imageKeyToIndexMap.set(o,s),this.imageKeyToIndexMap.set(mi(o),s)}),this.currentImageIdIndex=n,this.targetImageIdIndex=n;const r=Ft(fm.IMAGE_RETRIEVE_CONFIGURATION,e[n],"stack");this.imagesLoader=r?(r.create||RY)(r):this,this.stackInvalidated=!0,this.flipVertical=!1,this.flipHorizontal=!1,this.voiRange=null,this.interpolationType=bf.LINEAR,this.invert=!1,this.viewportStatus=So.LOADING,this.fillWithBackgroundColor(),this.useCPURendering&&(this._cpuFallbackEnabledElement.renderingTools={},delete this._cpuFallbackEnabledElement.viewport.colormap);const i=await this._setImageIdIndex(n),a={imageIds:e,viewportId:this.id,element:this.element,currentImageIdIndex:n};return Ct(this.element,vt.VIEWPORT_NEW_IMAGE_SET,a),i}_throwIfDestroyed(){if(this.isDisabled)throw new Error("The stack viewport has been destroyed and is no longer usable. Renderings will not be performed. If you are using the same viewportId and have re-enabled the viewport, you need to grab the new viewport instance using renderingEngine.getViewport(viewportId), instead of using your lexical scoped reference to the viewport instance.")}_checkVTKImageDataMatchesCornerstoneImage(e,n){if(!n)return!1;const[r,i]=n.getSpacing(),[a,o]=n.getDimensions(),s=this._getImagePlaneModule(e.imageId),l=n.getDirection(),c=l.slice(0,3),f=l.slice(3,6),u=n.getPointData().getScalars().getDataType(),d=fr(r,e.columnPixelSpacing),h=fr(i,e.rowPixelSpacing),p=d||e.columnPixelSpacing===null&&r===1,g=h||e.rowPixelSpacing===null&&i===1,m=a===e.columns,y=o===e.rows,v=fr(s.rowCosines,c),x=fr(s.columnCosines,f),w=u===e.voxelManager.getScalarData().constructor.name;return p&&g&&m&&y&&v&&x&&w}_updateVTKImageDataFromCornerstoneImage(e){let r=this._getImagePlaneModule(e.imageId).imagePositionPatient;r==null&&(r=[0,0,0]),this._imageData.setOrigin(r);const i=this.getActor(this.id);i&&(i.referencedId=e.imageId),oC(this._imageData,e)}_loadAndDisplayImage(e,n){return this.useCPURendering?this._loadAndDisplayImageCPU(e,n):this._loadAndDisplayImageGPU(e,n)}_loadAndDisplayImageCPU(e,n){return new Promise((r,i)=>{function a(h,p,g){if(this.currentImageIdIndex!==p)return;const m=h.voxelManager.getScalarData(),y=h.preScale,v=y?.scalingParameters,x=y?.scaled&&v?.rescaleIntercept%1!==0||v?.rescaleSlope%1!==0;if(m instanceof Float32Array&&x){const S={min:h.minPixelValue,max:h.maxPixelValue},D=Math.abs(S.max-S.min)/65535,I=S.min,R=m.length,M=new Uint16Array(R);let A=65535,L=0;for(let P=0;P<R;P++){const B=Math.floor((m[P]-I)/D);M[P]=B,A=Math.min(A,B),L=Math.max(L,B)}h.minPixelValue=A,h.maxPixelValue=L,h.slope=D,h.intercept=I,h.voxelManager?h.voxelManager.getScalarData=()=>M:h.getPixelData=()=>M,h.preScale={...h.preScale,scaled:!1}}this._setCSImage(h),this.viewportStatus=So.PRE_RENDER;const w={image:h,imageId:g,imageIdIndex:p,viewportId:this.id,renderingEngineId:this.renderingEngineId};Ct(this.element,vt.STACK_NEW_IMAGE,w),this._updateToDisplayImageCPU(h),this.render(),this.currentImageIdIndex=p,r(g)}function o(h,p,g){const m={error:h,imageIdIndex:p,imageId:g};this.suppressEvents||Ct(St,vt.IMAGE_LOAD_ERROR,m),i(h)}function s(h,p,g){return v0(h,g).then(m=>{a.call(this,m,p,h)},m=>{o.call(this,m,p,h)})}const l=-5,c=Dn.Interaction,f={imageId:e,imageIdIndex:n},u={useRGBA:!0,requestType:c},d={imageId:e,imageIdIndex:n,viewportId:this.id,renderingEngineId:this.renderingEngineId};Ct(this.element,vt.PRE_STACK_NEW_IMAGE,d),Qo.addRequest(s.bind(this,e,n,u),c,f,l)})}successCallback(e,n){const r=this.imageIds.indexOf(e);if(this.currentImageIdIndex!==r)return;const i=this.csImage?.imageFrame,a=n?.imageFrame,o=i?.photometricInterpretation||this.csImage?.photometricInterpretation,s=a?.photometricInterpretation||n?.photometricInterpretation;o!==s&&(this.stackInvalidated=!0),this._setCSImage(n);const l={image:n,imageId:e,imageIdIndex:r,viewportId:this.id,renderingEngineId:this.renderingEngineId};this._updateActorToDisplayImageId(n),Ct(this.element,vt.STACK_NEW_IMAGE,l),this.render(),this.currentImageIdIndex=r}errorCallback(e,n,r){if(!n)return;const i=this.imageIds.indexOf(e),a={error:r,imageIdIndex:i,imageId:e};Ct(St,vt.IMAGE_LOAD_ERROR,a)}getLoaderImageOptions(e){const n=this.imageIds.indexOf(e),{transferSyntaxUID:r}=Ft("transferSyntax",e)||{};return{useRGBA:!1,transferSyntaxUID:r,priority:5,requestType:Dn.Interaction,additionalDetails:{imageId:e,imageIdIndex:n}}}async loadImages(e,n){const r=await Promise.allSettled(e.map(a=>{const o=this.getLoaderImageOptions(a);return v0(a,o).then(s=>(n.successCallback(a,s),a),s=>(n.errorCallback(a,!0,s),a))})),i=r.filter(a=>a.status==="rejected");if(i&&i.length){const a=new CustomEvent(vt.IMAGE_LOAD_ERROR,{detail:i,cancelable:!0});St.dispatchEvent(a)}return r}_loadAndDisplayImageGPU(e,n){if(!e){console.warn("No image id set yet to load");return}const r={imageId:e,imageIdIndex:n,viewportId:this.id,renderingEngineId:this.renderingEngineId};return Ct(this.element,vt.PRE_STACK_NEW_IMAGE,r),this.imagesLoader.loadImages([e],this).then(i=>e)}_updateToDisplayImageCPU(e){const n=this.getImageDataMetadata(e),r=fJ(this.canvas,e,this.modality,this._cpuFallbackEnabledElement.viewport.colormap),{windowCenter:i,windowWidth:a,voiLUTFunction:o}=r.voi;this.voiRange=Gg(a,i,o),this._cpuFallbackEnabledElement.image=e,this._cpuFallbackEnabledElement.metadata={...n},this.cpuImagePixelData=e.voxelManager.getScalarData();const s=Object.assign({},r,this._cpuFallbackEnabledElement.viewport);this._cpuFallbackEnabledElement.viewport=this.stackInvalidated?r:s,this.stackInvalidated=!1,this.cpuRenderingInvalidated=!0,this._cpuFallbackEnabledElement.transform=S2(this._cpuFallbackEnabledElement)}getSliceViewInfo(){throw new Error("Method not implemented.")}addImages(e){const n=[];e.forEach(r=>{const{imageId:i,...a}=r,o=yt.getImage(i),{origin:s,dimensions:l,direction:c,spacing:f,numberOfComponents:u}=this.getImageDataMetadata(o),d=this.createVTKImageData({origin:s,dimensions:l,direction:c,spacing:f,numberOfComponents:u,pixelArray:o.voxelManager.getScalarData()}),h=this.createActorMapper(d);h&&(n.push({uid:r.actorUID??or(),actor:h,referencedId:i,...a}),r.callback&&r.callback({imageActor:h,imageId:r.imageId}))}),this.addActors(n)}_updateActorToDisplayImageId(e){const n=this._checkVTKImageDataMatchesCornerstoneImage(e,this._imageData),r=this.getViewPresentation();if(n&&!this.stackInvalidated){this._updateVTKImageDataFromCornerstoneImage(e),this.resetCameraNoEvent(),this.setViewPresentation(r),this._setPropertiesFromCache(),this.stackActorReInitialized=!1;return}const{origin:i,direction:a,dimensions:o,spacing:s,numberOfComponents:l,imagePixelModule:c}=this.getImageDataMetadata(e),f=e.voxelManager.getScalarData();this._createVTKImageData({origin:i,direction:a,dimensions:o,spacing:s,numberOfComponents:l,pixelArray:f}),this._updateVTKImageDataFromCornerstoneImage(e);const u=this.createActorMapper(this._imageData),d=this.getActors();d.length&&d[0].uid===this.id?d[0].actor=u:d.unshift({uid:this.id,actor:u,referencedId:e.imageId}),this.setActors(d);const{viewPlaneNormal:h,viewUp:p}=this._getCameraOrientation(a),g=this.getCamera();this.setCameraNoEvent({viewUp:p,viewPlaneNormal:h}),this.initialViewUp=p,this.resetCameraNoEvent(),this.setViewPresentation(r),this.triggerCameraEvent(this.getCamera(),g);const m=c.photometricInterpretation==="MONOCHROME1";this.stackInvalidated=!0;const y=this._getInitialVOIRange(e);this.setVOI(y,{forceRecreateLUTFunction:!!m}),this.initialInvert=!!m,this.setInvertColor(this.invert||this.initialInvert),this.stackInvalidated=!1,this.stackActorReInitialized=!0,this._publishCalibratedEvent&&this.triggerCalibrationEvent()}_getInitialVOIRange(e){if(this.voiRange&&this.voiUpdatedWithSetProperties)return this.voiRange;const{windowCenter:n,windowWidth:r,voiLUTFunction:i}=e;let a=this._getVOIRangeFromWindowLevel(r,n,i);return a=this._getPTPreScaledRange()||a,a}_getPTPreScaledRange(){if(this._isCurrentImagePTPrescaled())return this._getDefaultPTPrescaledVOIRange()}_isCurrentImagePTPrescaled(){return!(this.modality!=="PT"||!this.csImage.isPreScaled||!this.csImage.preScale?.scalingParameters.suvbw)}_getDefaultPTPrescaledVOIRange(){return{lower:0,upper:5}}_getVOIRangeFromWindowLevel(e,n,r=oo.LINEAR){let i,a;if(typeof n=="number"&&typeof e=="number"?(i=n,a=e):Array.isArray(n)&&Array.isArray(e)&&(i=n[0],a=e[0]),i!==void 0&&a!==void 0)return Gg(a,i,r)}async _setImageIdIndex(e){if(e>=this.imageIds.length)throw new Error(`ImageIdIndex provided ${e} is invalid, the stack only has ${this.imageIds.length} elements`);this.currentImageIdIndex=e,this.hasPixelSpacing=!0,this.viewportStatus=So.PRE_RENDER;const n=await this._loadAndDisplayImage(this.imageIds[e],e);if(this.perImageIdDefaultProperties.size>=1){const r=this.perImageIdDefaultProperties.get(n);r!==void 0?this.setProperties(r):this.globalDefaultProperties!==void 0&&this.setProperties(this.globalDefaultProperties)}return n}resetCameraCPU({resetPan:e=!0,resetZoom:n=!0}){const{image:r}=this._cpuFallbackEnabledElement;if(!r)return;I_e(this._cpuFallbackEnabledElement,e,n);const{scale:i}=this._cpuFallbackEnabledElement.viewport,{clientWidth:a,clientHeight:o}=this.element,s=[a/2,o/2],l=this.canvasToWorldCPU(s);this.setCameraCPU({focalPoint:l,scale:i})}resetCameraGPU({resetPan:e,resetZoom:n}){return this.setCamera({flipHorizontal:!1,flipVertical:!1,viewUp:this.initialViewUp}),super.resetCamera({resetPan:e,resetZoom:n,resetToCenter:!0})}scroll(e,n=!0,r=!1){const i=this.imageIds;if(isNaN(this.targetImageIdIndex))return;const a=this.targetImageIdIndex,o=i.length;let s=a+e;r?s=(s+o)%o:s=Math.max(0,Math.min(o-1,s)),this.targetImageIdIndex=s;const l=i[s];yt.isLoaded(l)||!n?this.setImageIdIndex(s):(clearTimeout(this.debouncedTimeout),this.debouncedTimeout=window.setTimeout(()=>{this.setImageIdIndex(s)},40));const f={newImageIdIndex:s,imageId:l,direction:e};s!==a&&Ct(this.element,vt.STACK_VIEWPORT_SCROLL,f)}setImageIdIndex(e){if(this._throwIfDestroyed(),this.currentImageIdIndex===e)return Promise.resolve(this.getCurrentImageId());const n=this._setImageIdIndex(e);return this.targetImageIdIndex=e,n}calibrateSpacing(e){const n=this.getImageIds().indexOf(e);this.stackInvalidated=!0,this._loadAndDisplayImage(e,n)}triggerCameraEvent(e,n){const r={previousCamera:n,camera:e,element:this.element,viewportId:this.id,renderingEngineId:this.renderingEngineId};this.suppressEvents||Ct(this.element,vt.CAMERA_MODIFIED,r)}triggerCalibrationEvent(){const{imageData:e}=this.getImageData(),n={element:this.element,viewportId:this.id,renderingEngineId:this.renderingEngineId,imageId:this.getCurrentImageId(),imageData:e,worldToIndex:e.getWorldToIndex(),...this._calibrationEvent};this.suppressEvents||Ct(this.element,vt.IMAGE_SPACING_CALIBRATED,n),this._publishCalibratedEvent=!1}jumpToWorld(e){const n=this.getImageIds(),r=this.getImageData(),{direction:i,spacing:a}=r,o=ep({direction:i,spacing:a,imageIds:n},e,this.getCamera().viewPlaneNormal,{ignoreSpacing:!0}),s=n.indexOf(o);return s===-1?!1:(this.setImageIdIndex(s),this.render(),!0)}getRendererContextPool(){return this.getRenderingEngine().getRenderer(this.id)}getRendererTiled(){const e=this.getRenderingEngine();if(!e||e.hasBeenDestroyed)throw new Error("Rendering engine has been destroyed");return e.offscreenMultiRenderWindow?.getRenderer(this.id)}_getVOIRangeForCurrentImage(){const{windowCenter:e,windowWidth:n,voiLUTFunction:r}=this.csImage;return this._getVOIRangeFromWindowLevel(n,e,r)}_getValidVOILUTFunction(e){return Object.values(oo).includes(e)?e:oo.LINEAR}getSliceInfo(){const e=this.getSliceIndex(),{dimensions:n}=this.getImageData();return{width:n[0],height:n[1],sliceIndex:e,slicePlane:2}}isReferenceViewable(e,n={}){const r=this.getCurrentImageIdIndex(),i=this.imageIds[r];if(!i||!e)return!1;const{referencedImageId:a,multiSliceReference:o}=e;if(a){if(a===i)return!0;e.referencedImageURI||=mi(a);const{referencedImageURI:l}=e,c=this.imageKeyToIndexMap.get(l);if(n.asOverlay&&this.matchImagesForOverlay(i,a))return!0;if(c===void 0)return!1;if(n.withNavigation)return!0;const f=o&&this.imageKeyToIndexMap.get(o.referencedImageId);return r<=f&&r>=c}if(!super.isReferenceViewable(e,{...n,withOrientation:n?.asVolume}))return!1;if(e.volumeId||e.FrameOfReferenceUID)return n.asVolume;const{cameraFocalPoint:s}=e;if(n.asNearbyProjection&&s){const{spacing:l,direction:c,origin:f}=this.getImageData(),u=c.slice(6,9),d=fp({direction:c,spacing:l},u),h=Dr(ct(),s,f),p=zt(h,u),g=d/2;if(Math.abs(p)<=g)return!0}return!1}getViewReference(e={}){const{sliceIndex:n=this.getCurrentImageIdIndex()}=e,r=super.getViewReference(e),i=this.getCurrentImageId(n);if(i){if(r.referencedImageId=i,this.getCurrentImageIdIndex()!==n){const a=this.getImagePlaneReferenceData(n);if(!a)return;Object.assign(r,a)}return r}}setViewReference(e){if(!e?.referencedImageId){e?.sliceIndex!==void 0&&this.scroll(e.sliceIndex-this.targetImageIdIndex);return}const{referencedImageId:n}=e;e.referencedImageURI||=mi(n);const{referencedImageURI:r}=e,i=this.imageKeyToIndexMap.get(r);if(i===void 0){xk.error(`No image URI found for ${r}`);return}this.scroll(i-this.targetImageIdIndex)}getViewReferenceId(e={}){const{sliceIndex:n=this.currentImageIdIndex}=e;return`imageId:${this.imageIds[n]}`}getSliceIndexForImage(e){if(e){if(typeof e=="string")return this.imageKeyToIndexMap.get(e);if(e.referencedImageId)return this.imageKeyToIndexMap.get(e.referencedImageId)}}getCPUFallbackError(e){return new Error(`method ${e} cannot be used during CPU Fallback mode`)}fillWithBackgroundColor(){const e=this.getRenderingEngine();e&&e.fillCanvasWithBackgroundColor(this.canvas,this.options.background)}unsetColormapCPU(){delete this._cpuFallbackEnabledElement.viewport.colormap,this._cpuFallbackEnabledElement.renderingTools={},this.cpuRenderingInvalidated=!0,this.fillWithBackgroundColor(),this.render()}setColormapCPU(e){this.colormap=e;const n=y2(e.name);this._cpuFallbackEnabledElement.viewport.colormap=n,this._cpuFallbackEnabledElement.renderingTools={},this.fillWithBackgroundColor(),this.cpuRenderingInvalidated=!0,this.render();const r={viewportId:this.id,colormap:e};Ct(this.element,vt.COLORMAP_MODIFIED,r)}setColormapGPU(e){const i=this.getDefaultActor().actor.getProperty(),a=i.getRGBTransferFunction(),o=y2(e.name)||m2.getPresetByName(e.name);if(a)a.applyColorMap(o),a.setMappingRange(this.voiRange.lower,this.voiRange.upper),i.setRGBTransferFunction(0,a);else{const l=Lf.newInstance();l.applyColorMap(o),l.setMappingRange(this.voiRange.lower,this.voiRange.upper),i.setRGBTransferFunction(0,l)}this.colormap=e,this.render();const s={viewportId:this.id,colormap:e};Ct(this.element,vt.COLORMAP_MODIFIED,s)}unsetColormapGPU(){throw new Error("unsetColormapGPU not implemented.")}_getImagePlaneModule(e){const n=QY(e);return this.hasPixelSpacing=!n.usingDefaultValues||this.calibration?.scale>0||this.calibration?.rowPixelSpacing>0,this.calibration||=n.calibration,n}isInAcquisitionPlane(){return!0}}function Wd(t,e){const{imageData:n}=t.getImageData(),r=t.canvasToWorld(e);return io(n,r)}function dm(t,e){return t.indexToWorld(e)}function A_e(t,e){const{imageData:n}=t.getImageData(),r=dm(n,e);return t.worldToCanvas(r)}class oa extends lo{constructor(e){super(e),this._useAcquisitionPlaneForViewPlane=!1,this.getNumberOfSlices=()=>{const{numberOfSlices:r}=D3(this)||{};return r},this.resetCameraForResize=()=>this.resetCamera({resetPan:!0,resetZoom:!0,resetToCenter:!0,resetRotation:!1,suppressEvents:!0}),this.getCurrentImageIdIndex=(r,i=!0)=>{const{currentStepIndex:a}=qg(this,r||this.getVolumeId(),i);return a},this.getSliceIndex=()=>{const{imageIndex:r}=D3(this)||{};return r},this.getCurrentImageId=()=>{const r=this.getDefaultActor();if(!r||!Jo(r,"vtkVolume"))return;const i=yt.getVolume(this.getVolumeId());if(!i)return;const{viewPlaneNormal:a,focalPoint:o}=this.getCamera();return ep(i,o,a)},this.getSlicePlaneCoordinates=()=>{const r=this.getDefaultActor();if(!r?.actor)return console.warn("No image data found for calculating vtkPlanes."),[];const i=this.getVolumeId(),a=yt.getVolume(i),o=this.getCamera(),{focalPoint:s,position:l,viewPlaneNormal:c}=o,f=fp(a,c),u=iC(r.actor,c,s),d=Math.round((u.current-u.min)/f),h=Math.round((u.max-u.current)/f),p=this.getSliceIndex(),g=[];for(let m=-d;m<=h;m++){const{newFocalPoint:y}=Xg(s,l,u,c,f,m);g.push({sliceIndex:p+m,point:y})}return g};const{orientation:n}=this.options;if(n&&n!==n0.ACQUISITION){this.applyViewOrientation(n);return}this._useAcquisitionPlaneForViewPlane=!0}async setVolumes(e,n=!1,r=!1){const i=e[0].volumeId,a=yt.getVolume(i);if(!a)throw new Error(`imageVolume with id: ${i} does not exist`);return this._useAcquisitionPlaneForViewPlane?(this._setViewPlaneToAcquisitionPlane(a),this._useAcquisitionPlaneForViewPlane=!1):this.options.orientation&&typeof this.options.orientation=="string"&&this.options.orientation.includes("_reformat")&&this._setViewPlaneToReformatOrientation(this.options.orientation,a),super.setVolumes(e,n,r)}async addVolumes(e,n=!1,r=!1){const i=yt.getVolume(e[0].volumeId);if(!i)throw new Error(`imageVolume with id: ${i.volumeId} does not exist`);return this._useAcquisitionPlaneForViewPlane?(this._setViewPlaneToAcquisitionPlane(i),this._useAcquisitionPlaneForViewPlane=!1):this.options.orientation&&typeof this.options.orientation=="string"&&this.options.orientation.includes("_reformat")&&this._setViewPlaneToReformatOrientation(this.options.orientation,i),super.addVolumes(e,n,r)}jumpToWorld(e){const{focalPoint:n}=this.getCamera(),r=[0,0,0];ur(r,e,n);const i=this.getCamera(),a=i.viewPlaneNormal,o=zt(r,a),s=En(a[0],a[1],a[2]);if(Xs(s,s,o),Math.abs(s[0])>.001||Math.abs(s[1])>.001||Math.abs(s[2])>.001){const l=[0,0,0],c=[0,0,0];Nl(l,i.focalPoint,s),Nl(c,i.position,s),this.setCamera({focalPoint:l,position:c}),this.render()}return!0}setOrientation(e,n=!0){let r,i;if(typeof e=="string"){if(e===n0.ACQUISITION)({viewPlaneNormal:r,viewUp:i}=super._getAcquisitionPlaneOrientation());else if(e===n0.REFORMAT||e.includes("_reformat"))({viewPlaneNormal:r,viewUp:i}=qY(this,{useViewportNormal:!0}));else if(wf[e])({viewPlaneNormal:r,viewUp:i}=wf[e]);else throw new Error(`Invalid orientation: ${e}. Use Enums.OrientationAxis instead.`);this.setCamera({viewPlaneNormal:r,viewUp:i}),this.viewportProperties.orientation=e,this.resetCamera()}else({viewPlaneNormal:r,viewUp:i}=e),this.applyViewOrientation(e);n&&this.render()}setCameraClippingRange(){const e=this.getVtkActiveCamera();if(!e){console.warn("No active camera found");return}e.getParallelProjection()?e.setClippingRange(-Ci.MAXIMUM_RAY_DISTANCE,Ci.MAXIMUM_RAY_DISTANCE):e.setClippingRange(Ci.MINIMUM_SLAB_THICKNESS,Ci.MAXIMUM_RAY_DISTANCE)}_setViewPlaneToReformatOrientation(e,n){let r,i;if(n){const{direction:a}=n;({viewPlaneNormal:r,viewUp:i}=KY(a.slice(0,3),a.slice(3,6),a.slice(6,9),e))}else({viewPlaneNormal:r,viewUp:i}=this._getAcquisitionPlaneOrientation());this.setCamera({viewPlaneNormal:r,viewUp:i}),this.initialViewUp=i,this.resetCamera()}_setViewPlaneToAcquisitionPlane(e){let n,r;if(e){const{direction:i}=e;n=i.slice(6,9).map(a=>-a),r=i.slice(3,6).map(a=>-a)}else({viewPlaneNormal:n,viewUp:r}=this._getAcquisitionPlaneOrientation());this.setCamera({viewPlaneNormal:n,viewUp:r}),this.initialViewUp=r,this.resetCamera()}getBlendMode(e){const n=this.getActors(),r=e?.length>0?n.find(i=>e.includes(i.uid)):n[0];return r?.blendMode||r?.actor.getMapper().getBlendMode()}setBlendMode(e,n=[],r=!1){let i=this.getActors();n?.length>0&&(i=i.filter(a=>n.includes(a.uid))),i.forEach(a=>{const{actor:o}=a;o.getMapper().setBlendMode?.(e),a.blendMode=e}),r&&this.render()}resetCamera(e){const{resetPan:n=!0,resetZoom:r=!0,resetRotation:i=!0,resetToCenter:a=!0,suppressEvents:o=!1,resetOrientation:s=!0}=e||{},{orientation:l}=this.viewportProperties;l&&s&&this.applyViewOrientation(l,!1),super.resetCamera({resetPan:n,resetZoom:r,resetToCenter:a});const c=this.getVtkActiveCamera(),f=c.getViewPlaneNormal(),u=c.getFocalPoint();if(this.getActors().forEach(h=>{if(!h.actor)return;const p=h.actor.getMapper();if(p.getClippingPlanes().length===0&&!h?.clippingFilter){const m=Do.newInstance(),y=Do.newInstance(),v=[m,y];let x=Ci.MINIMUM_SLAB_THICKNESS;h.slabThickness&&(x=h.slabThickness),this.setOrientationOfClippingPlanes(v,x,f,u),p.addClippingPlane(m),p.addClippingPlane(y)}}),i&&wf[this.viewportProperties.orientation]!==void 0){const h=wf[this.viewportProperties.orientation];this.setCameraNoEvent({viewUp:h.viewUp,viewPlaneNormal:h.viewPlaneNormal})}if(!o){const h={viewportId:this.id,camera:this.getCamera(),renderingEngineId:this.renderingEngineId,element:this.element};Ct(this.element,vt.CAMERA_RESET,h)}return!0}setSlabThickness(e,n=[]){e<.1&&(e=.1);let r=this.getActors();n?.length>0&&(r=r.filter(a=>n.includes(a.uid))),r.forEach(a=>{Jo(a,"vtkVolume")&&(a.slabThickness=e)});const i=this.getCamera();this.updateClippingPlanesForActors(i),this.triggerCameraModifiedEventIfNecessary(i,i),this.viewportProperties.slabThickness=e}resetSlabThickness(){this.getActors().forEach(r=>{Jo(r,"vtkVolume")&&(r.slabThickness=Ci.MINIMUM_SLAB_THICKNESS)});const n=this.getCamera();this.updateClippingPlanesForActors(n),this.triggerCameraModifiedEventIfNecessary(n,n),this.viewportProperties.slabThickness=void 0}isInAcquisitionPlane(){const e=this.getImageData();if(!e)return!1;const{direction:n}=e,{viewPlaneNormal:r}=this.getCamera(),i=[n[6],n[7],n[8]];return Math.abs(zt(r,i))>.99}getSliceViewInfo(){const{width:e,height:n}=this.getCanvas(),r=Wd(this,[0,0]),i=Wd(this,[e-1,0]),a=Wd(this,[0,n-1]),o=ur(ct(),i,r),s=ur(ct(),a,r),l=dr(ct(),o,s);Ir(o,o),Ir(s,s),Ir(l,l);const{dimensions:c}=this.getImageData(),[f,u,d]=c,g=[[0,0,0],[f-1,0,0],[0,u-1,0],[f-1,u-1,0],[0,0,d-1],[f-1,0,d-1],[0,u-1,d-1],[f-1,u-1,d-1]].map(R=>A_e(this,R)).reduce((R,M)=>(R.minX=Math.min(R.minX,M[0]),R.minY=Math.min(R.minY,M[1]),R.maxX=Math.max(R.maxX,M[0]),R.maxY=Math.max(R.maxY,M[1]),R),{minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}),m=Wd(this,[g.minX,g.minY]),y=eK(o[0],o[1],o[2],0,s[0],s[1],s[2],0,l[0],l[1],l[2],0,m[0],m[1],m[2],1),v=Wd(this,[g.maxX,g.maxY]),x=ur(ct(),v,m),w=U9(h0(),y),{viewPlaneNormal:S}=this.getCamera();if(S.filter(R=>Math.abs(R)>Qs).length>1)throw new Error("getSliceInfo is not supported for oblique views");const _=S.findIndex(R=>Math.abs(R)>1-Qs);if(_===-1)throw new Error("Unable to determine slice axis");const D=zt(o,x)+1,I=zt(s,x)+1;return{sliceIndex:this.getSliceIndex(),width:D,height:I,slicePlane:_,sliceToIndexMatrix:y,indexToSliceMatrix:w}}getCurrentSlicePixelData(){const{voxelManager:e}=this.getImageData();return e.getSliceData(this.getSliceViewInfo())}getViewReference(e={}){const n=super.getViewReference(e);if(!n?.volumeId)return;const r=yt.getVolume(n.volumeId);return n.referencedImageId=ep(r,n.cameraFocalPoint,n.viewPlaneNormal),n}resetProperties(e){this._resetProperties(e)}_resetProperties(e){const n=e?this.getActor(e):this.getDefaultActor();if(!n)throw new Error(`No actor found for the given volumeId: ${e}`);n.slabThickness&&(n.slabThickness=Ci.MINIMUM_SLAB_THICKNESS,this.viewportProperties.slabThickness=void 0,this.updateClippingPlanesForActors(this.getCamera())),e||=this.getVolumeId();const r=yt.getVolume(e);if(!r)throw new Error(`imageVolume with id: ${e} does not exist in cache`);if(FD(n.actor,r),uc(n)){const c=n.actor.getProperty().getRGBTransferFunction(0);zw(c,this.initialTransferFunctionNodes)}const i={...super.getVOIModifiedEventDetail(e)};this.resetCamera({resetPan:!0,resetZoom:!0,resetToCenter:!0,resetCameraRotation:!0}),Ct(this.element,vt.VOI_MODIFIED,i)}getSlicesClippingPlanes(){const e=this.getSlicePlaneCoordinates(),{viewPlaneNormal:n}=this.getCamera(),r=Ci.MINIMUM_SLAB_THICKNESS;return e.map(({point:i,sliceIndex:a})=>{const o=[Do.newInstance(),Do.newInstance()];return this.setOrientationOfClippingPlanes(o,r,n,i),{sliceIndex:a,planes:o.map(s=>({normal:s.getNormal(),origin:s.getOrigin()}))}})}}class sC extends lo{constructor(e){super(e),this.setSampleDistanceMultiplier=a=>{this.getActors().forEach(s=>{if(Jo(s,"vtkVolume")){const c=s.actor.getMapper();if(c&&c.getInputData){const f=c.getInputData();if(f){const u=f.getSpacing();let p=(u[0]+u[1]+u[2])/6*(a||1);p!==void 0&&c.setSampleDistance&&(c.getSampleDistance(),c.setSampleDistance(p))}}}}),this.render()},this.getNumberOfSlices=()=>1,this.getRotation=()=>0,this.getCurrentImageIdIndex=()=>0,this.getCurrentImageId=()=>null,this.resetCameraForResize=()=>this.resetCamera({resetPan:!0,resetZoom:!0,resetToCenter:!0});const{parallelProjection:n,orientation:r}=this.options,i=this.getVtkActiveCamera();n!=null&&i.setParallelProjection(n),r&&r!==n0.ACQUISITION&&this.applyViewOrientation(r)}isInAcquisitionPlane(){return!1}resetCamera({resetPan:e=!0,resetZoom:n=!0,resetToCenter:r=!0}={}){super.resetCamera({resetPan:e,resetZoom:n,resetToCenter:r});const i=this.getVtkActiveCamera();return i.getParallelProjection()?i.setClippingRange(-Ci.MAXIMUM_RAY_DISTANCE,Ci.MAXIMUM_RAY_DISTANCE):i.setClippingRange(Ci.MINIMUM_SLAB_THICKNESS,Ci.MAXIMUM_RAY_DISTANCE),this.getRenderer().resetCameraClippingRange(),!0}setSlabThickness(e,n){return null}setBlendMode(e,n,r){return null}resetProperties(e){const n=e?this.getActor(e):this.getDefaultActor();if(!n)throw new Error(`No actor found for the given volumeId: ${e}`);n.slabThickness&&(n.slabThickness=Ci.MINIMUM_SLAB_THICKNESS,this.viewportProperties.slabThickness=void 0,this.updateClippingPlanesForActors(this.getCamera())),e||=this.getVolumeId();const r=yt.getVolume(e);if(!r)throw new Error(`imageVolume with id: ${e} does not exist in cache`);if(FD(n.actor,r),uc(n)){const i=n.actor.getProperty().getRGBTransferFunction(0);zw(i,this.initialTransferFunctionNodes)}this.setCamera(this.initialCamera),Ct(this.element,vt.VOI_MODIFIED,super.getVOIModifiedEventDetail(e))}getSliceIndex(){return null}setCamera(e){super.setCamera(e),this.getRenderer().resetCameraClippingRange(),this.render()}setCameraClippingRange(){const e=this.getVtkActiveCamera();e.getParallelProjection()?e.setClippingRange(-Ci.MAXIMUM_RAY_DISTANCE,Ci.MAXIMUM_RAY_DISTANCE):e.setClippingRange(Ci.MINIMUM_SLAB_THICKNESS,Ci.MAXIMUM_RAY_DISTANCE)}resetSlabThickness(){return null}}async function dJ(t,e,n,r=!1,i=!1){n.forEach(o=>{const s=t.getViewport(o);if(!s)throw new Error(`Viewport with Id ${o} does not exist`);if(!(s instanceof lo))throw new Error("setVolumesForViewports only supports VolumeViewport and VolumeViewport3D")});const a=n.map(async o=>{await t.getViewport(o).setVolumes(e,r,i)});await Promise.all(a)}async function hJ(t,e,n,r=!1,i=!1){for(const o of n){const s=t.getViewport(o);if(!s)throw new Error(`Viewport with Id ${o} does not exist`);if(!(s instanceof lo)){console.warn(`Viewport with Id ${o} is not a BaseVolumeViewport. Cannot add volume to this viewport.`);return}}const a=n.map(async o=>{await t.getViewport(o).addVolumes(e,r,i)});await Promise.all(a)}function pJ(t,e,n){for(const r of n){const i=t.getViewport(r);if(!i)throw new Error(`Viewport with Id ${r} does not exist`);if(!i.addImages){console.warn(`Viewport with Id ${r} does not have addImages. Cannot add image segmentation to this viewport.`);return}}n.forEach(r=>{t.getViewport(r).addImages(e)})}class P_e{constructor(e){this.opacity=.4,this.outlineOpacity=.4,this.transferFunction=[],this.actor=e}setRGBTransferFunction(e,n){this.transferFunction[e]=n}setScalarOpacity(e){}setInterpolationTypeToNearest(){}setUseLabelOutline(){}setLabelOutlineOpacity(e){this.outlineOpacity=e}setLabelOutlineThickness(){}getColor(e){const n=this.transferFunction[0],r=n.getRedValue(e),i=n.getGreenValue(e),a=n.getBlueValue(e);return[r,i,a,this.opacity]}}class N_e{constructor(e){this.actor=e}getInputData(){return this.actor.getImage()}}class L_e{constructor(e,n){this.canvasProperties=new P_e(this),this.visibility=!1,this.mapper=new N_e(this),this.className="CanvasActor",this.derivedImage=n,this.viewport=e}renderRLE(e,n,r){const{width:i,height:a}=this.image;let{canvas:o}=this;(!o||o.width!==i||o.height!==a)&&(this.canvas=o=new window.OffscreenCanvas(i,a));const s=o.getContext("2d"),l=s.createImageData(i,a),{data:c}=l;c.fill(0);const{map:f}=r;let u=1/0,d=1/0,h=-1/0,p=-1/0;for(let y=0;y<a;y++){const v=f.getRun(y,0);if(!v)continue;d=Math.min(d,y),p=Math.max(p,y);const x=y*i<<2;let w;for(const S of v){const{start:T,end:_,value:D}=S;if(D===0){w||=[],w.push(v.indexOf(S));continue}u=Math.min(u,T),h=Math.max(h,_);const I=this.canvasProperties.getColor(D).map(M=>M*255);let R=x+(T<<2);for(let M=T;M<_;M++)c[R++]=I[0],c[R++]=I[1],c[R++]=I[2],c[R++]=I[3]}}if(u>i)return;const g=h-u,m=p-d;s.putImageData(l,0,0,u-1,d-1,g+2,m+2),n.drawImage(o,u,d,g,m,u,d,g,m)}setMapper(e){this.mapper=e}render(e,n){if(!this.visibility)return;const r=this.image||this.getImage(),{width:i,height:a}=r,o=r.getScalarData();if(!o)return;const{voxelManager:s}=r;if(s&&s.map.getRun){this.renderRLE(e,n,s);return}let{canvas:l}=this;(!l||l.width!==i||l.height!==a)&&(this.canvas=l=new window.OffscreenCanvas(i,a));const c=l.getContext("2d"),f=c.createImageData(i,a),{data:u}=f;let d=0,h=0,p=1/0,g=1/0,m=-1/0,y=-1/0;for(let w=0;w<a;w++)for(let S=0;S<i;S++){const T=o[d++];if(T){p=Math.min(S,p),g=Math.min(w,g),m=Math.max(S,m),y=Math.max(w,y);const _=this.canvasProperties.getColor(T);u[h]=_[0]*255,u[h+1]=_[1]*255,u[h+2]=_[2]*255,u[h+3]=127}h+=4}if(p>i)return;const v=m-p+1,x=y-g+1;c.putImageData(f,0,0,p,g,v,x),n.drawImage(l,p,g,v,x,p,g,v,x)}getClassName(){return this.className}getProperty(){return this.canvasProperties}setVisibility(e){this.visibility=e}getMapper(){return this.mapper}isA(e){return e===this.className}getImage(){if(this.image)return this.image;this.image={...this.derivedImage};const e=this.viewport.getImageData();return Object.assign(this.image,{worldToIndex:n=>e.imageData.worldToIndex(n),indexToWorld:(n,r)=>e.imageData.indexToWorld(n,r),getDimensions:()=>e.dimensions,getScalarData:()=>this.derivedImage?.getPixelData(),getDirection:()=>e.direction,getSpacing:()=>e.spacing,setOrigin:()=>null,setDerivedImage:n=>{this.derivedImage=n,this.image=null},modified:()=>null}),this.image}}const J7=class J7{static imageIdToFrames(e){const n=e.match(this.frameRangeExtractor);if(!n||!n[2])return null;const r=n[2].split("-").map(i=>Number(i));return r.length===1?r[0]:r}static imageIdToFrameEnd(e){const n=this.imageIdToFrames(e);return Array.isArray(n)?n[1]:n}static imageIdToFrameStart(e){const n=this.imageIdToFrames(e);return Array.isArray(n)?n[0]:n}static framesToString(e){return Array.isArray(e)?`${e[0]}-${e[1]}`:String(e)}static framesToImageId(e,n){const r=e.match(this.frameRangeExtractor);if(!r||!r[2])return null;const i=this.framesToString(n);return e.replace(this.frameRangeExtractor,`${r[1]}${i}`)}};J7.frameRangeExtractor=/(\/frames\/|[&?]frameNumber=)([^/&?]*)/i;let Jg=J7;const qv=class qv extends Qh{constructor(e){super({...e,canvas:e.canvas||Ys(e.element)}),this.videoWidth=0,this.videoHeight=0,this.loop=!0,this.mute=!0,this.isPlaying=!1,this.scrollSpeed=1,this.playbackRate=1,this.frameRange=[0,0],this.fps=30,this.videoCamera={panWorld:[0,0],parallelScale:1},this.voiRange={lower:0,upper:255},this.getProperties=()=>({loop:this.videoElement.loop,muted:this.videoElement.muted,playbackRate:this.playbackRate,scrollSpeed:this.scrollSpeed,voiRange:{...this.voiRange}}),this.getMiddleSliceData=()=>{throw new Error("Method not implemented.")},this.useCustomRenderingPipeline=!0,this.resetCamera=()=>(this.refreshRenderValues(),this.canvasContext.fillRect(0,0,this.canvas.width,this.canvas.height),this.isPlaying||this.renderFrame(),!0),this.getNumberOfSlices=()=>{const n=Math.round(this.videoElement.duration*this.fps/this.scrollSpeed);return isNaN(n)?this.numberOfFrames:n},this.getFrameOfReferenceUID=()=>this.videoElement.src,this.resize=()=>{const n=this.canvas,{clientWidth:r,clientHeight:i}=n;(n.width!==r||n.height!==i)&&(n.width=r,n.height=i),this.refreshRenderValues(),this.isPlaying||this.renderFrame()},this.canvasToWorld=(n,r=[0,0,0])=>{const i=this.videoCamera.panWorld,a=this.getWorldToCanvasRatio(),o=[i[0]*a,i[1]*a],s=[n[0]-o[0],n[1]-o[1]];return r.splice(0,2,s[0]/a,s[1]/a),r},this.worldToCanvas=n=>{const r=this.videoCamera.panWorld,i=this.getWorldToCanvasRatio();return[(n[0]+r[0])*i,(n[1]+r[1])*i]},this.getRotation=()=>0,this.canvasToIndex=n=>{const r=this.getTransform();return r.invert(),r.transformPoint(n.map(i=>i*devicePixelRatio))},this.indexToCanvas=n=>this.getTransform().transformPoint(n).map(i=>i/devicePixelRatio),this.customRenderViewportToCanvas=()=>{this.renderFrame()},this.renderFrame=()=>{const n=window.devicePixelRatio||1,i=this.getTransform().getMatrix(),a=this.canvasContext;a.resetTransform(),a.clearRect(0,0,this.canvas.width,this.canvas.height),a.transform(i[0]/n,i[1]/n,i[2]/n,i[3]/n,i[4]/n,i[5]/n),a.drawImage(this.videoElement,0,0,this.videoWidth,this.videoHeight);for(const s of this.getActors())s.actor.render(this,this.canvasContext);this.canvasContext.resetTransform(),Ct(this.element,vt.STACK_NEW_IMAGE,{element:this.element,viewportId:this.id,viewport:this,renderingEngineId:this.renderingEngineId,time:this.videoElement.currentTime,duration:this.videoElement.duration}),Ct(this.element,vt.IMAGE_RENDERED,{element:this.element,viewportId:this.id,viewport:this,imageIndex:this.getCurrentImageIdIndex(),numberOfSlices:this.numberOfFrames,renderingEngineId:this.renderingEngineId,time:this.videoElement.currentTime,duration:this.videoElement.duration}),this.initialRender?.();const o=this.getFrameNumber();this.isPlaying&&(o<this.frameRange[0]?this.setFrameNumber(this.frameRange[0]):o>this.frameRange[1]&&(this.loop?this.setFrameNumber(this.frameRange[0]):this.pause()))},this.renderWhilstPlaying=()=>{this.renderFrame(),this.isPlaying&&requestAnimationFrame(this.renderWhilstPlaying)},this.canvasContext=this.canvas.getContext("2d"),this.renderingEngineId=e.renderingEngineId,this.element.setAttribute("data-viewport-uid",this.id),this.element.setAttribute("data-rendering-engine-uid",this.renderingEngineId),this.videoElement=document.createElement("video"),this.videoElement.muted=this.mute,this.videoElement.loop=this.loop,this.videoElement.autoplay=!0,this.videoElement.crossOrigin="anonymous",this.addEventListeners(),this.resize()}static get useCustomRenderingPipeline(){return!0}addEventListeners(){this.canvas.addEventListener(vt.ELEMENT_DISABLED,this.elementDisabledHandler)}removeEventListeners(){this.canvas.removeEventListener(vt.ELEMENT_DISABLED,this.elementDisabledHandler)}elementDisabledHandler(){this.removeEventListeners(),this.videoElement.remove()}getImageDataMetadata(e){const n=typeof e=="string"?e:e.imageId,r=Ft(Yo.IMAGE_PLANE,n);let i=r.rowCosines,a=r.columnCosines;(r.usingDefaultValues||i==null||a==null)&&(i=[1,0,0],a=[0,1,0]);const s=En(i[0],i[1],i[2]),l=En(a[0],a[1],a[2]),{rows:c,columns:f}=r,u=ct();dr(u,s,l);let d=r.imagePositionPatient;d==null&&(d=[0,0,0]);const h=r.columnPixelSpacing||1,p=r.rowPixelSpacing||1,g=r.columns,m=r.rows,y=1,v=1;return this.hasPixelSpacing=!!r.columnPixelSpacing,{bitsAllocated:8,numberOfComponents:3,origin:d,rows:c,columns:f,direction:[...s,...l,...u],dimensions:[g,m,v],spacing:[h,p,y],hasPixelSpacing:this.hasPixelSpacing,numVoxels:g*m*v,imagePlaneModule:r}}setDataIds(e,n){this.setVideo(e[0],(n.viewReference?.sliceIndex||0)+1)}setVideo(e,n){this.imageId=Array.isArray(e)?e[0]:e;const r=Ft(Yo.IMAGE_URL,e);if(!r?.rendered)throw new Error(`Video Image ID ${e} does not have a rendered video view`);const{rendered:i}=r,a=Ft(Yo.GENERAL_SERIES,e);this.modality=a?.Modality,this.metadata=this.getImageDataMetadata(e);let{cineRate:o,numberOfFrames:s}=Ft(Yo.CINE,e);return this.numberOfFrames=s,this.setVideoURL(i).then(()=>((!s||s===1)&&(s=Math.round(this.videoElement.duration*(o||30))),o||(o=Math.round(s/this.videoElement.duration)),this.fps=o,this.numberOfFrames=s,this.setFrameRange([1,s]),this.initialRender=()=>{this.initialRender=null,this.pause(),this.setFrameNumber(n||1)},new Promise(l=>{window.setTimeout(()=>{this.setFrameNumber(n||1),l(this)},25)})))}async setVideoURL(e){return new Promise(n=>{this.videoElement.src=e,this.videoElement.preload="auto";const r=()=>{this.videoWidth=this.videoElement.videoWidth,this.videoHeight=this.videoElement.videoHeight,this.videoElement.removeEventListener("loadedmetadata",r),this.refreshRenderValues(),n(!0)};this.videoElement.addEventListener("loadedmetadata",r)})}getImageIds(){const e=new Array(this.numberOfFrames),n=this.imageId.replace(/[0-9]+$/,"");for(let r=0;r<this.numberOfFrames;r++)e[r]=`${n}${r+1}`;return e}togglePlayPause(){return this.isPlaying?(this.pause(),!1):(this.play(),!0)}async play(){try{this.isPlaying||(this.isPlaying=!0,await this.videoElement.play(),this.renderWhilstPlaying())}catch{}}pause(){try{this.isPlaying=!1,this.videoElement.pause()}catch{}}async scroll(e=1){await this.pause();const n=this.videoElement,r=this.renderFrame,a=n.currentTime+e*this.scrollSpeed/this.fps;n.currentTime=a;const o=s=>{r(),n.removeEventListener("seeked",o)};n.addEventListener("seeked",o)}async start(){const e=this.videoElement,n=this.renderFrame;if(e.currentTime=0,e.paused){const r=i=>{n(),e.removeEventListener("seeked",r)};e.addEventListener("seeked",r)}}async end(){const e=this.videoElement,n=this.renderFrame;if(e.currentTime=e.duration,e.paused){const r=i=>{n(),e.removeEventListener("seeked",r)};e.addEventListener("seeked",r)}}async setTime(e){const n=this.videoElement,r=this.renderFrame;if(n.currentTime=e,n.paused){const i=a=>{r(),n.removeEventListener("seeked",i)};n.addEventListener("seeked",i)}}getSliceViewInfo(){throw new Error("Method not implemented.")}async setFrameNumber(e){this.setTime((e-1)/this.fps)}setFrameRange(e){if(!e){this.frameRange=[1,this.numberOfFrames];return}e.length!==2||e[0]===e[1]||(this.frameRange=[e[0],e[1]])}getSliceIndexForImage(e){if(e){if(typeof e=="string")return Jg.imageIdToFrameStart(e);if(e.referencedImageId)return Jg.imageIdToFrameStart(e.referencedImageId)}}getFrameRange(){return this.frameRange}setProperties(e){e.loop!==void 0&&(this.videoElement.loop=e.loop),e.muted!==void 0&&(this.videoElement.muted=e.muted),e.playbackRate!==void 0&&this.setPlaybackRate(e.playbackRate),e.scrollSpeed!==void 0&&this.setScrollSpeed(e.scrollSpeed),e.voiRange&&this.setVOI(e.voiRange)}setPlaybackRate(e=1){if(this.playbackRate=e,e<.0625){this.pause();return}this.videoElement&&(this.videoElement.playbackRate=e,this.play())}setScrollSpeed(e=1,n=h2.FRAME){this.scrollSpeed=n===h2.SECOND?e*this.fps:e}resetProperties(){this.setProperties({loop:!1,muted:!0,voiRange:{lower:0,upper:255}})}getScalarData(){if(this.scalarData?.frameNumber===this.getFrameNumber())return this.scalarData;if(!this.videoElement||!this.videoElement.videoWidth||!this.videoElement.videoHeight){console.debug("Video not ready yet, returning empty scalar data");const a=new Uint8ClampedArray;return a.getRange=()=>[0,255],a.frameNumber=-1,a}const e=document.createElement("canvas");e.width=this.videoElement.videoWidth,e.height=this.videoElement.videoHeight;const n=e.getContext("2d");n.drawImage(this.videoElement,0,0);const i=n.getImageData(0,0,e.width,e.height).data;return i.getRange=()=>[0,255],i.frameNumber=this.getFrameNumber(),this.scalarData=i,i}getImageData(){const{metadata:e}=this,n=e.spacing,r={getDirection:()=>e.direction,getDimensions:()=>e.dimensions,getRange:()=>[0,255],getScalarData:()=>this.getScalarData(),getSpacing:()=>e.spacing,worldToIndex:a=>{const o=this.worldToCanvas(a),s=this.canvasToIndex(o);return[s[0],s[1],0]},indexToWorld:(a,o)=>{const s=this.indexToCanvas([a[0],a[1]]);return this.canvasToWorld(s,o)}},i={dimensions:e.dimensions,spacing:n,origin:e.origin,direction:e.direction,metadata:{Modality:this.modality,FrameOfReferenceUID:e.FrameOfReferenceUID},getScalarData:()=>this.getScalarData(),scalarData:this.getScalarData(),imageData:r,voxelManager:{forEach:(a,o)=>xD(o.imageData,{pointInShapeFn:o.isInObject??(()=>!0),callback:a,boundsIJK:o.boundsIJK,returnPoints:o.returnPoints??!1})},hasPixelSpacing:this.hasPixelSpacing,calibration:this.calibration,preScale:{scaled:!1}};return Object.defineProperty(r,"scalarData",{get:()=>this.getScalarData(),enumerable:!0}),i}hasImageURI(e){const n=e.match(qv.frameRangeExtractor),r=n?e.substring(0,n.index):e;return this.imageId.includes(r)}setVOI(e){this.voiRange=e;const n=this.setColorTransform(e,this.averageWhite);this.canvas.style.filter=n}setWindowLevel(e=256,n=128){const r=n-e/2,i=n+e/2-1;this.setVOI({lower:r,upper:i}),this.setColorTransform({lower:r,upper:i},this.averageWhite)}setAverageWhite(e){this.averageWhite=e,this.setColorTransform(this.voiRange,e)}setCamera(e){const{parallelScale:n,focalPoint:r}=e;if(n&&(this.videoCamera.parallelScale=this.element.clientHeight/2/n),r!==void 0){const i=this.worldToCanvas(r),a=[this.element.clientWidth/2,this.element.clientHeight/2],o=[(i[0]-a[0])/this.videoCamera.parallelScale,(i[1]-a[1])/this.videoCamera.parallelScale];this.videoCamera.panWorld=[this.videoCamera.panWorld[0]-o[0],this.videoCamera.panWorld[1]-o[1]]}this.canvasContext.fillStyle="rgba(0,0,0,1)",this.canvasContext.fillRect(0,0,this.canvas.width,this.canvas.height),this.isPlaying||this.renderFrame()}getCurrentImageId(e=this.getCurrentImageIdIndex()){return this.imageId?.replace("/frames/1",`/frames/${e+1}`)}getViewReferenceId(e={}){const{sliceIndex:n}=e;return n===void 0?`videoId:${this.getCurrentImageId()}`:Array.isArray(n)?`videoId:${this.imageId.substring(0,this.imageId.length-1)}${n[0]+1}-${n[1]+1}`:`videoId:${this.imageId.replace("/frames/1",`/frames/${1+n}`)}`}isReferenceViewable(e,n={}){let{imageURI:r}=n;const{referencedImageId:i,sliceIndex:a,multiSliceReference:o}=e;if(!super.isReferenceViewable(e))return!1;const s=this.getCurrentImageId();if(!r){const d=s.indexOf(":");r=s.substring(d+1,s.length-1)}if(n.withNavigation)return!0;const l=this.getSliceIndex();if(o){const d=Jg.imageIdToFrameEnd(o.referencedImageId);return l>=a&&l<=d}if(a!==void 0)return l===a;if(!i)return!1;const c=i.match(qv.frameRangeExtractor);if(!c||!c[2])return!0;const f=c[2].split("-").map(d=>Number(d)),u=l+1;return f[0]<=u&&u<=(f[1]??f[0])}setViewReference(e){typeof e.sliceIndex=="number"?this.setFrameNumber(e.sliceIndex+1):Array.isArray(e.sliceIndex)&&this.setFrameRange(e.sliceIndex)}getViewReference(e){const n=e?.sliceIndex??(this.isPlaying?this.frameRange[0]:this.getCurrentImageIdIndex()),r=e?.rangeEndSliceIndex??(this.isPlaying?this.frameRange[1]-1:void 0),i=r>n?{sliceIndex:r,referencedImageId:this.getCurrentImageId(r)}:void 0;return{...super.getViewReference(e),referencedImageId:this.getViewReferenceId(e),sliceIndex:n,multiSliceReference:i}}getFrameNumber(){return 1+this.getCurrentImageIdIndex()}getCurrentImageIdIndex(){return Math.round(this.videoElement.currentTime*this.fps)}getSliceIndex(){return this.getCurrentImageIdIndex()/this.scrollSpeed}getCamera(){const{parallelScale:e}=this.videoCamera,n=[this.element.clientWidth/2,this.element.clientHeight/2];return{parallelProjection:!0,focalPoint:this.canvasToWorld(n),position:[0,0,0],viewUp:[0,-1,0],parallelScale:this.element.clientHeight/2/e,viewPlaneNormal:[0,0,1]}}getFrameRate(){return this.fps}getPan(){const e=this.videoCamera.panWorld;return[e[0],e[1]]}refreshRenderValues(){let e=this.canvas.offsetWidth/this.videoWidth;this.videoHeight*e>this.canvas.height&&(e=this.canvas.offsetHeight/this.videoHeight);const n=Math.floor(this.videoWidth*e),r=Math.floor(this.videoHeight*e),i=(this.canvas.offsetWidth-n)/2,a=(this.canvas.offsetHeight-r)/2,o=i/e,s=a/e;this.videoCamera.panWorld=[o,s],this.videoCamera.parallelScale=e}getWorldToCanvasRatio(){return this.videoCamera.parallelScale}getCanvasToWorldRatio(){return 1/this.videoCamera.parallelScale}getTransform(){const e=this.videoCamera.panWorld,n=window.devicePixelRatio||1,r=this.getWorldToCanvasRatio(),i=this.getCanvasToWorldRatio(),a=[this.canvas.offsetWidth/2,this.canvas.offsetHeight/2],o=[a[0]*i,a[1]*i],s=new Bm;return s.scale(n,n),s.translate(a[0],a[1]),s.scale(r,r),s.translate(e[0],e[1]),s.translate(-o[0],-o[1]),s}updateCameraClippingPlanesAndRange(){}addImages(e){const n=this.getActors();e.forEach(r=>{const{imageId:i,...a}=r,o=yt.getImage(i),s=this.createActorMapper(o),l=r.actorUID??or();s&&(n.push({uid:l,actor:s,referencedId:i,...a}),r.callback&&r.callback({imageActor:s,imageId:i}))}),this.setActors(n)}createActorMapper(e){return new L_e(this,e)}};qv.frameRangeExtractor=/(\/frames\/|[&?]frameNumber=)([^/&?]*)/i;let I3=qv;const k_e=`
.DicomMicroscopyViewer {
  --ol-partial-background-color: rgba(127, 127, 127, 0.7);
  --ol-foreground-color: #000000;
  --ol-subtle-foreground-color: #000;
  --ol-subtle-background-color: rgba(78, 78, 78, 0.5);
}

.DicomMicroscopyViewer .ol-box {
  box-sizing: border-box;
  border-radius: 2px;
  border: 1.5px solid var(--ol-background-color);
  background-color: var(--ol-partial-background-color);
}

.DicomMicroscopyViewer .ol-mouse-position {
  top: 8px;
  right: 8px;
  position: absolute;
}

.DicomMicroscopyViewer .ol-scale-line {
  background: var(--ol-partial-background-color);
  border-radius: 4px;
  bottom: 8px;
  left: 8px;
  padding: 2px;
  position: absolute;
}

.DicomMicroscopyViewer .ol-scale-line-inner {
  border: 1px solid var(--ol-subtle-foreground-color);
  border-top: none;
  color: var(--ol-foreground-color);
  font-size: 10px;
  text-align: center;
  margin: 1px;
  will-change: contents, width;
  transition: all 0.25s;
}

.DicomMicroscopyViewer .ol-scale-bar {
  position: absolute;
  bottom: 8px;
  left: 8px;
}

.DicomMicroscopyViewer .ol-scale-bar-inner {
  display: flex;
}

.DicomMicroscopyViewer .ol-scale-step-marker {
  width: 1px;
  height: 15px;
  background-color: var(--ol-foreground-color);
  float: right;
  z-index: 10;
}

.DicomMicroscopyViewer .ol-scale-step-text {
  position: absolute;
  bottom: -5px;
  font-size: 10px;
  z-index: 11;
  color: var(--ol-foreground-color);
  text-shadow:
    -1.5px 0 var(--ol-partial-background-color),
    0 1.5px var(--ol-partial-background-color),
    1.5px 0 var(--ol-partial-background-color),
    0 -1.5px var(--ol-partial-background-color);
}

.DicomMicroscopyViewer .ol-scale-text {
  position: absolute;
  font-size: 12px;
  text-align: center;
  bottom: 25px;
  color: var(--ol-foreground-color);
  text-shadow:
    -1.5px 0 var(--ol-partial-background-color),
    0 1.5px var(--ol-partial-background-color),
    1.5px 0 var(--ol-partial-background-color),
    0 -1.5px var(--ol-partial-background-color);
}

.DicomMicroscopyViewer .ol-scale-singlebar {
  position: relative;
  height: 10px;
  z-index: 9;
  box-sizing: border-box;
  border: 1px solid var(--ol-foreground-color);
}

.DicomMicroscopyViewer .ol-scale-singlebar-even {
  background-color: var(--ol-subtle-foreground-color);
}

.DicomMicroscopyViewer .ol-scale-singlebar-odd {
  background-color: var(--ol-background-color);
}

.DicomMicroscopyViewer .ol-unsupported {
  display: none;
}

.DicomMicroscopyViewer .ol-viewport,
.DicomMicroscopyViewer .ol-unselectable {
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -moz-user-select: none;
  user-select: none;
  -webkit-tap-highlight-color: transparent;
}

.DicomMicroscopyViewer .ol-viewport canvas {
  all: unset;
}

.DicomMicroscopyViewer .ol-selectable {
  -webkit-touch-callout: default;
  -webkit-user-select: text;
  -moz-user-select: text;
  user-select: text;
}

.DicomMicroscopyViewer .ol-grabbing {
  cursor: -webkit-grabbing;
  cursor: -moz-grabbing;
  cursor: grabbing;
}

.DicomMicroscopyViewer .ol-grab {
  cursor: move;
  cursor: -webkit-grab;
  cursor: -moz-grab;
  cursor: grab;
}

.DicomMicroscopyViewer .ol-control {
  position: absolute;
  background-color: var(--ol-subtle-background-color);
  border-radius: 4px;
}

.DicomMicroscopyViewer .ol-zoom {
  top: 0.5em;
  left: 0.5em;
}

.DicomMicroscopyViewer .ol-rotate {
  top: 0.5em;
  right: 0.5em;
  transition:
    opacity 0.25s linear,
    visibility 0s linear;
}

.DicomMicroscopyViewer .ol-rotate.ol-hidden {
  opacity: 0;
  visibility: hidden;
  transition:
    opacity 0.25s linear,
    visibility 0s linear 0.25s;
}

.DicomMicroscopyViewer .ol-zoom-extent {
  top: 4.643em;
  left: 0.5em;
}

.DicomMicroscopyViewer .ol-full-screen {
  right: 0.5em;
  top: 0.5em;
}

.DicomMicroscopyViewer .ol-control button {
  display: block;
  margin: 1px;
  padding: 0;
  color: var(--ol-subtle-foreground-color);
  font-weight: bold;
  text-decoration: none;
  font-size: inherit;
  text-align: center;
  height: 1.375em;
  width: 1.375em;
  line-height: 0.4em;
  background-color: var(--ol-background-color);
  border: none;
  border-radius: 2px;
}

.DicomMicroscopyViewer .ol-control button::-moz-focus-inner {
  border: none;
  padding: 0;
}

.DicomMicroscopyViewer .ol-zoom-extent button {
  line-height: 1.4em;
}

.DicomMicroscopyViewer .ol-compass {
  display: block;
  font-weight: normal;
  will-change: transform;
}

.DicomMicroscopyViewer .ol-touch .ol-control button {
  font-size: 1.5em;
}

.DicomMicroscopyViewer .ol-touch .ol-zoom-extent {
  top: 5.5em;
}

.DicomMicroscopyViewer .ol-control button:hover,
.DicomMicroscopyViewer .ol-control button:focus {
  text-decoration: none;
  outline: 1px solid var(--ol-subtle-foreground-color);
  color: var(--ol-foreground-color);
}

.DicomMicroscopyViewer .ol-zoom .ol-zoom-in {
  border-radius: 2px 2px 0 0;
}

.DicomMicroscopyViewer .ol-zoom .ol-zoom-out {
  border-radius: 0 0 2px 2px;
}

.DicomMicroscopyViewer .ol-attribution {
  text-align: right;
  bottom: 0.5em;
  right: 0.5em;
  max-width: calc(100% - 1.3em);
  display: flex;
  flex-flow: row-reverse;
  align-items: center;
}

.DicomMicroscopyViewer .ol-attribution a {
  color: var(--ol-subtle-foreground-color);
  text-decoration: none;
}

.DicomMicroscopyViewer .ol-attribution ul {
  margin: 0;
  padding: 1px 0.5em;
  color: var(--ol-foreground-color);
  text-shadow: 0 0 2px var(--ol-background-color);
  font-size: 12px;
}

.DicomMicroscopyViewer .ol-attribution li {
  display: inline;
  list-style: none;
}

.DicomMicroscopyViewer .ol-attribution li:not(:last-child):after {
  content: ' ';
}

.DicomMicroscopyViewer .ol-attribution img {
  max-height: 2em;
  max-width: inherit;
  vertical-align: middle;
}

.DicomMicroscopyViewer .ol-attribution button {
  flex-shrink: 0;
}

.DicomMicroscopyViewer .ol-attribution.ol-collapsed ul {
  display: none;
}

.DicomMicroscopyViewer .ol-attribution:not(.ol-collapsed) {
  background: var(--ol-partial-background-color);
}

.DicomMicroscopyViewer .ol-attribution.ol-uncollapsible {
  bottom: 0;
  right: 0;
  border-radius: 4px 0 0;
}

.DicomMicroscopyViewer .ol-attribution.ol-uncollapsible img {
  margin-top: -0.2em;
  max-height: 1.6em;
}

.DicomMicroscopyViewer .ol-attribution.ol-uncollapsible button {
  display: none;
}

.DicomMicroscopyViewer .ol-zoomslider {
  top: 4.5em;
  left: 0.5em;
  height: 200px;
}

.DicomMicroscopyViewer .ol-zoomslider button {
  position: relative;
  height: 10px;
}

.DicomMicroscopyViewer .ol-touch .ol-zoomslider {
  top: 5.5em;
}

.DicomMicroscopyViewer .ol-overviewmap {
  left: 0.5em;
  bottom: 0.5em;
}

.DicomMicroscopyViewer .ol-overviewmap.ol-uncollapsible {
  bottom: 0;
  left: 0;
  border-radius: 0 4px 0 0;
}

.DicomMicroscopyViewer .ol-overviewmap .ol-overviewmap-map,
.DicomMicroscopyViewer .ol-overviewmap button {
  display: block;
}

.DicomMicroscopyViewer .ol-overviewmap .ol-overviewmap-map {
  border: 1px solid var(--ol-subtle-foreground-color);
  height: 150px;
  width: 150px;
}

.DicomMicroscopyViewer .ol-overviewmap:not(.ol-collapsed) button {
  bottom: 0;
  left: 0;
  position: absolute;
}

.DicomMicroscopyViewer .ol-overviewmap.ol-collapsed .ol-overviewmap-map,
.DicomMicroscopyViewer .ol-overviewmap.ol-uncollapsible button {
  display: none;
}

.DicomMicroscopyViewer .ol-overviewmap:not(.ol-collapsed) {
  background: var(--ol-subtle-background-color);
}

.DicomMicroscopyViewer .ol-overviewmap-box {
  border: 0.5px dotted var(--ol-subtle-foreground-color);
}

.DicomMicroscopyViewer .ol-overviewmap .ol-overviewmap-box:hover {
  cursor: move;
}

@layout-header-background: #007ea3;
@primary-color: #007ea3;
@processing-color: #8cb8c6;
@success-color: #3f9c35;
@warning-color: #eeaf30;
@error-color: #96172e;
@font-size-base: 14px;

.DicomMicroscopyViewer .ol-tooltip {
  font-size: 16px !important;
}
`;let Q1=null;const V_e="postrender",Og=class Og extends Qh{constructor(e){super({...e,canvas:e.canvas||Ys(e.element)}),this.internalCamera={rotation:0,centerIndex:[0,0],extent:[0,-2,1,-1],xSpacing:1,ySpacing:1,resolution:1,zoom:1},this.voiRange={lower:0,upper:255},this.getProperties=()=>({voiRange:{...this.voiRange}}),this.resetCamera=()=>!0,this.getNumberOfSlices=()=>1,this.getFrameOfReferenceUID=()=>this.frameOfReferenceUID,this.resize=()=>{const r=this.canvas,{clientWidth:i,clientHeight:a}=r;(r.width!==i||r.height!==a)&&(r.width=i,r.height=a),this.refreshRenderValues()},this.canvasToWorld=r=>{if(!this.metadata)return;const i=this.canvasToIndex(r);return i[1]=-i[1],this.indexToWorld(i)},this.worldToCanvas=r=>{if(!this.metadata)return;const i=this.worldToIndex(r);return i[1]=-i[1],this.indexToCanvas([i[0],i[1],0])},this.postrender=()=>{this.refreshRenderValues(),Ct(this.element,vt.IMAGE_RENDERED,{element:this.element,viewportId:this.id,viewport:this,renderingEngineId:this.renderingEngineId})},this.getRotation=()=>0,this.canvasToIndex=r=>{const i=this.getTransform();i.invert();const a=i.transformPoint(r.map(o=>o*devicePixelRatio));return[a[0],a[1],0]},this.indexToCanvas=r=>this.getTransform().transformPoint([r[0],r[1]]).map(a=>a/devicePixelRatio),this.customRenderViewportToCanvas=()=>{},this.getImageIds=()=>[this.imageIds[0]],this.renderingEngineId=e.renderingEngineId,this.element.setAttribute("data-viewport-uid",this.id),this.element.setAttribute("data-rendering-engine-uid",this.renderingEngineId),this.element.style.position="relative",this.microscopyElement=document.createElement("div"),this.microscopyElement.setAttribute("class","DicomMicroscopyViewer"),this.microscopyElement.id=or(),this.microscopyElement.innerText="Initial",this.microscopyElement.style.background="grey",this.microscopyElement.style.width="100%",this.microscopyElement.style.height="100%",this.microscopyElement.style.position="absolute",this.microscopyElement.style.left="0",this.microscopyElement.style.top="0";const n=this.element.firstElementChild;n.insertBefore(this.microscopyElement,n.childNodes[1]),this.addEventListeners(),this.addWidget("DicomMicroscopyViewer",{getEnabled:()=>!!this.viewer,setEnabled:()=>{this.elementDisabledHandler()}}),this.resize()}static get useCustomRenderingPipeline(){return!0}addEventListeners(){this.canvas.addEventListener(vt.ELEMENT_DISABLED,this.elementDisabledHandler)}removeEventListeners(){this.canvas.removeEventListener(vt.ELEMENT_DISABLED,this.elementDisabledHandler)}elementDisabledHandler(){this.removeEventListeners(),this.viewer?.cleanup(),this.viewer=null,this.element.firstElementChild.removeChild(this.microscopyElement),this.microscopyElement=null}getImageDataMetadata(e=0){const n=this.metadataDicomweb.reduce((I,R)=>I?.NumberOfFrames<R.NumberOfFrames?R:I),{TotalPixelMatrixColumns:r,TotalPixelMatrixRows:i,ImageOrientationSlide:a,ImagedVolumeWidth:o,ImagedVolumeHeight:s,ImagedVolumeDepth:l}=n,c=Ft(Yo.IMAGE_PLANE,this.imageIds[e]);let f=a.slice(0,3),u=a.slice(3,6);(f==null||u==null)&&(f=[1,0,0],u=[0,1,0]);const d=En(f[0],f[1],f[2]),h=En(u[0],u[1],u[2]),p=ct();dr(p,d,h);const{XOffsetInSlideCoordinateSystem:g=0,YOffsetInSlideCoordinateSystem:m=0,ZOffsetInSlideCoordinateSystem:y=0}=n.TotalPixelMatrixOriginSequence?.[0]||{},v=[g,m,y],x=o/r,w=s/i,S=r,T=i,_=l,D=1;return this.hasPixelSpacing=!!(o&&s),{bitsAllocated:8,numberOfComponents:3,origin:v,direction:[...d,...h,...p],dimensions:[S,T,D],spacing:[x,w,_],hasPixelSpacing:this.hasPixelSpacing,numVoxels:S*T*D,imagePlaneModule:c}}async setFrameNumber(e){}setProperties(e){e.voiRange&&this.setVOI(e.voiRange)}resetProperties(){this.setProperties({voiRange:{lower:0,upper:255}})}setVOI(e){this.voiRange=e;const n=this.setColorTransform(e,this.averageWhite);this.map.getViewport().querySelectorAll(".ol-layers canvas").forEach(i=>{i.style.filter=n})}setAverageWhite(e){this.averageWhite=e,this.setColorTransform(this.voiRange,e)}getScalarData(){return null}computeTransforms(){const e=h0(),n=h0();return nK(e,this.metadata.origin),e[0]=this.metadata.direction[0],e[1]=this.metadata.direction[1],e[2]=this.metadata.direction[2],e[4]=this.metadata.direction[3],e[5]=this.metadata.direction[4],e[6]=this.metadata.direction[5],e[8]=this.metadata.direction[6],e[9]=this.metadata.direction[7],e[10]=this.metadata.direction[8],tK(e,e,this.metadata.spacing),U9(n,e),{indexToWorld:e,worldToIndex:n}}getImageData(){const{metadata:e}=this;if(!e)return null;const{spacing:n}=e,r={getDirection:()=>e.direction,getDimensions:()=>e.dimensions,getRange:()=>[0,255],getScalarData:()=>this.getScalarData(),getSpacing:()=>e.spacing,worldToIndex:a=>this.worldToIndex(a),indexToWorld:a=>this.indexToWorld(a)};return{dimensions:e.dimensions,spacing:n,numberOfComponents:3,origin:e.origin,direction:e.direction,metadata:{Modality:this.modality,FrameOfReferenceUID:this.frameOfReferenceUID},hasPixelSpacing:this.hasPixelSpacing,calibration:this.calibration,preScale:{scaled:!1},scalarData:this.getScalarData(),imageData:r}}hasImageURI(e){return!0}setCamera(e){const n=this.getCamera(),{parallelScale:r,focalPoint:i}=e,a=this.getView(),{xSpacing:o}=this.internalCamera;if(r){const l=this.element.clientHeight/r,c=1/o/l;a.setResolution(c)}if(i){const l=this.worldToCanvas(i),c=this.canvasToIndex(l);a.setCenter(c)}const s=this.getCamera();this.triggerCameraModifiedEventIfNecessary(n,s)}getCurrentImageId(){return this.imageIds[0]}getFrameNumber(){return 1}getCamera(){this.refreshRenderValues();const{resolution:e,xSpacing:n,centerIndex:r}=this.internalCamera,i=e*n,a=this.indexToCanvas([r[0],r[1],0]),o=this.canvasToWorld(a);return{parallelProjection:!0,focalPoint:o,position:o,viewUp:[0,-1,0],parallelScale:this.element.clientHeight*i,viewPlaneNormal:[0,0,1]}}worldToIndexWSI(e){if(!Q1)return;const n=this.viewer.getAffine(),r=Q1.applyInverseTransform({coordinate:[e[0],e[1]],affine:n});return[r[0],r[1]]}indexToWorldWSI(e){if(!Q1)return;const n=Q1.applyTransform({coordinate:[e[0],e[1]],affine:this.viewer.getAffine()});return[n[0],n[1],0]}worldToIndex(e){const{worldToIndex:n}=this.computeTransforms(),r=ct();return v2(r,e,n),r}indexToWorld(e){const{indexToWorld:n}=this.computeTransforms(),r=ct(),i=En(...e);return v2(r,i,n),[r[0],r[1],r[2]]}setDataIds(e,n){n?.miniNavigationOverlay!==!1&&Og.addMiniNavigationOverlayCss();const r=n?.webClient||Ft(Yo.WADO_WEB_CLIENT,e[0]);if(!r)throw new Error(`To use setDataIds on WSI data, you must provide metaData.webClient for ${e[0]}`);return this.setWSI(e,r)}async setWSI(e,n){this.microscopyElement.style.background="black",this.microscopyElement.innerText="Loading",this.imageIds=e;const r=await Og.getDicomMicroscopyViewer();Q1||=r.utils,this.frameOfReferenceUID=null;const i=this.imageIds.map(s=>{const l=n.getDICOMwebMetadata(s);Object.defineProperty(l,"isMultiframe",{value:l.isMultiframe,enumerable:!1}),Object.defineProperty(l,"frameNumber",{value:void 0,enumerable:!1});const c=l["00080008"]?.Value;c?.length===1&&(l["00080008"].Value=c[0].split("\\"));const f=l["00200052"]?.Value?.[0];return this.frameOfReferenceUID?f!==this.frameOfReferenceUID&&(l["00200052"].Value=[this.frameOfReferenceUID]):this.frameOfReferenceUID=f,l}),a=[];i.forEach(s=>{const l=new r.metadata.VLWholeSlideMicroscopyImage({metadata:s}),c=l.ImageType[2];c==="VOLUME"||c==="THUMBNAIL"?a.push(l):console.log("Unknown image type",l.ImageType)}),this.metadataDicomweb=a;const o=new r.viewer.VolumeImageViewer({client:n,metadata:a,controls:["overview","position"],retrieveRendered:!1,bindings:{}});o.render({container:this.microscopyElement}),this.metadata=this.getImageDataMetadata(),o.deactivateDragPanInteraction(),this.viewer=o,this.map=o.getMap(),this.map.on(V_e,this.postrender),this.resize(),this.microscopyElement.innerText="",Object.assign(this.microscopyElement.style,{"--ol-partial-background-color":"rgba(127, 127, 127, 0.7)","--ol-foreground-color":"#000000","--ol-subtle-foreground-color":"#000","--ol-subtle-background-color":"rgba(78, 78, 78, 0.5)",background:"none"})}scroll(e){const n=this.getCamera();this.setCamera({parallelScale:n.parallelScale*(1+.1*e)})}getSliceIndex(){return 0}getView(){if(!this.viewer)return;const e=this.viewer.getMap(),n=window;return n.map=e,n.viewer=this.viewer,n.view=e?.getView(),n.wsi=this,e?.getView()}refreshRenderValues(){const e=this.getView();if(!e)return;const n=e.getResolution();if(!n||n<Qs)return;const r=e.getCenter(),i=e.getProjection().getExtent(),a=e.getRotation(),o=e.getZoom(),{metadata:{spacing:[s,l]}}=this,c=1/n/s;Object.assign(this.internalCamera,{extent:i,centerIndex:r,worldToCanvasRatio:c,xSpacing:s,ySpacing:l,resolution:n,rotation:a,zoom:o})}getZoom(){return this.getView()?.getZoom()}setZoom(e){this.getView()?.setZoom(e)}getTransform(){this.refreshRenderValues();const{centerIndex:e,resolution:n,rotation:r}=this.internalCamera,i=[this.canvas.width/2,this.canvas.height/2],a=new Bm;return a.translate(i[0],i[1]),a.rotate(r),a.scale(1/n,-1/n),a.translate(-e[0],-e[1]),a}getViewReferenceId(){return`imageId:${this.getCurrentImageId()}`}getCurrentImageIdIndex(){return 0}static addMiniNavigationOverlayCss(){if(document.getElementById(this.overlayCssId))return;const e=document.createElement("style");e.innerText=k_e,e.setAttribute("id",this.overlayCssId),document.getElementsByTagName("head")[0].append(e)}};Og.getDicomMicroscopyViewer=async()=>YW("dicom-microscopy-viewer"),Og.overlayCssId="overlayCss";let R3=Og;const gJ={[br.ORTHOGRAPHIC]:oa,[br.PERSPECTIVE]:oa,[br.STACK]:aa,[br.VOLUME_3D]:sC,[br.VIDEO]:I3,[br.WHOLE_SLIDE]:R3};function nu(t){return gJ[t].useCustomRenderingPipeline}const ps={WIDTH:160,HEIGHT:96,TEXT_PADDING:3,TEXT_Y_OFFSET:2,GRAPH_Y_OFFSET:15,GRAPH_WIDTH:150,GRAPH_HEIGHT:70,FONT_SIZE:9,FONT_FAMILY:"Helvetica,Arial,sans-serif",GRAPH_ALPHA:.9},px={UPDATE_INTERVAL:1e3,MAX_MS_VALUE:200,MAX_FPS_VALUE:300,OVERLAY_STYLES:{position:"fixed",top:"0px",right:"0px",left:"auto",zIndex:"9999",cursor:"pointer",opacity:"0.9"}},r8={BYTES_TO_MB:1048576,MS_PER_SECOND:1e3},nf=[{name:"FPS",foregroundColor:"#0ff",backgroundColor:"#002"},{name:"MS",foregroundColor:"#0f0",backgroundColor:"#020"},{name:"MB",foregroundColor:"#f08",backgroundColor:"#201"}];class i8{constructor(e,n,r){this.minValue=1/0,this.maxValue=0,this.name=e,this.foregroundColor=n,this.backgroundColor=r,this.devicePixelRatio=Math.round(window.devicePixelRatio||1),this.dimensions=this.calculateDimensions(),this.dom=this.createCanvas(),this.context=this.initializeContext(),this.drawInitialPanel()}update(e,n){this.updateMinMax(e),this.clearTextArea(),this.drawText(e),this.scrollGraph(),this.drawNewValue(e,n)}calculateDimensions(){const e=this.devicePixelRatio;return{width:ps.WIDTH*e,height:ps.HEIGHT*e,textX:ps.TEXT_PADDING*e,textY:ps.TEXT_Y_OFFSET*e,graphX:ps.TEXT_PADDING*e,graphY:ps.GRAPH_Y_OFFSET*e,graphWidth:ps.GRAPH_WIDTH*e,graphHeight:ps.GRAPH_HEIGHT*e}}createCanvas(){const e=document.createElement("canvas");return e.width=this.dimensions.width,e.height=this.dimensions.height,e.style.cssText=`width:${ps.WIDTH}px;height:${ps.HEIGHT}px`,e}initializeContext(){const e=this.dom.getContext("2d");if(!e)throw new Error("Failed to get 2D context");return e.font=`bold ${ps.FONT_SIZE*this.devicePixelRatio}px ${ps.FONT_FAMILY}`,e.textBaseline="top",e}drawInitialPanel(){const{width:e,height:n,textX:r,textY:i,graphX:a,graphY:o,graphWidth:s,graphHeight:l}=this.dimensions;this.context.fillStyle=this.backgroundColor,this.context.fillRect(0,0,e,n),this.context.fillStyle=this.foregroundColor,this.context.fillText(this.name,r,i),this.context.fillRect(a,o,s,l),this.context.fillStyle=this.backgroundColor,this.context.globalAlpha=ps.GRAPH_ALPHA,this.context.fillRect(a,o,s,l),this.context.globalAlpha=1}updateMinMax(e){this.minValue=Math.min(this.minValue,e),this.maxValue=Math.max(this.maxValue,e)}clearTextArea(){const{width:e,graphY:n}=this.dimensions;this.context.fillStyle=this.backgroundColor,this.context.fillRect(0,0,e,n)}drawText(e){const{textX:n,textY:r}=this.dimensions,i=this.formatText(e);this.context.fillStyle=this.foregroundColor,this.context.fillText(i,n,r)}formatText(e){const n=Math.round(e),r=Math.round(this.minValue),i=Math.round(this.maxValue);return`${n} ${this.name} (${r}-${i})`}scrollGraph(){const{graphX:e,graphY:n,graphWidth:r,graphHeight:i}=this.dimensions,a=this.devicePixelRatio;this.context.drawImage(this.dom,e+a,n,r-a,i,e,n,r-a,i)}drawNewValue(e,n){const{graphX:r,graphY:i,graphWidth:a,graphHeight:o}=this.dimensions,s=this.devicePixelRatio,l=r+a-s;this.context.fillStyle=this.foregroundColor,this.context.fillRect(l,i,s,o);const c=Math.round((1-e/n)*o);this.context.fillStyle=this.backgroundColor,this.context.globalAlpha=ps.GRAPH_ALPHA,this.context.fillRect(l,i,s,c),this.context.globalAlpha=1}}var Wa;(function(t){t[t.FPS=0]="FPS",t[t.MS=1]="MS",t[t.MEMORY=2]="MEMORY"})(Wa||(Wa={}));var Qc;let F_e=(Qc=class{constructor(){this.dom=null,this.currentMode=0,this.startTime=0,this.lastUpdateTime=0,this.frameCount=0,this.panels=new Map,this.animationFrameId=null,this.isSetup=!1}static getInstance(){return Qc.instance||(Qc.instance=new Qc),Qc.instance}setup(){if(!this.isSetup)try{this.dom=this.createOverlayElement(),this.startTime=performance.now(),this.lastUpdateTime=this.startTime,this.initializePanels(),this.showPanel(Wa.FPS),this.applyOverlayStyles(),document.body.appendChild(this.dom),this.startLoop(),this.isSetup=!0}catch(e){console.warn("Failed to setup stats overlay:",e)}}cleanup(){this.stopLoop(),this.dom&&this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.dom=null,this.panels.clear(),this.isSetup=!1}showPanel(e){Array.from(this.dom.children).forEach((r,i)=>{r.style.display=i===e?"block":"none"}),this.currentMode=e}update(){this.startTime=this.updateStats()}createOverlayElement(){const e=document.createElement("div");return e.addEventListener("click",this.handleClick.bind(this),!1),e}applyOverlayStyles(){Object.assign(this.dom.style,px.OVERLAY_STYLES)}handleClick(e){e.preventDefault();const n=this.dom.children.length;this.showPanel((this.currentMode+1)%n)}initializePanels(){const e=new i8(nf[Wa.FPS].name,nf[Wa.FPS].foregroundColor,nf[Wa.FPS].backgroundColor);this.addPanel(Wa.FPS,e);const n=new i8(nf[Wa.MS].name,nf[Wa.MS].foregroundColor,nf[Wa.MS].backgroundColor);if(this.addPanel(Wa.MS,n),this.isMemoryAvailable()){const r=new i8(nf[Wa.MEMORY].name,nf[Wa.MEMORY].foregroundColor,nf[Wa.MEMORY].backgroundColor);this.addPanel(Wa.MEMORY,r)}}isMemoryAvailable(){return performance.memory!==void 0}addPanel(e,n){this.dom.appendChild(n.dom),this.panels.set(e,n)}startLoop(){const e=()=>{this.update(),this.animationFrameId=requestAnimationFrame(e)};this.animationFrameId=requestAnimationFrame(e)}stopLoop(){this.animationFrameId!==null&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=null)}updateStats(){this.frameCount++;const e=performance.now(),n=e-this.startTime,r=this.panels.get(Wa.MS);if(r&&r.update(n,px.MAX_MS_VALUE),e>=this.lastUpdateTime+px.UPDATE_INTERVAL){const i=this.frameCount*r8.MS_PER_SECOND/(e-this.lastUpdateTime),a=this.panels.get(Wa.FPS);a&&a.update(i,px.MAX_FPS_VALUE),this.lastUpdateTime=e,this.frameCount=0,this.updateMemoryPanel()}return e}updateMemoryPanel(){const e=this.panels.get(Wa.MEMORY);if(!e)return;const n=performance;if(n.memory){const r=n.memory.usedJSHeapSize/r8.BYTES_TO_MB,i=n.memory.jsHeapSizeLimit/r8.BYTES_TO_MB;e.update(r,i)}}},Qc.instance=null,Qc);const bk=F_e.getInstance(),A3=2;class XD{constructor(e){if(this._needsRender=new Set,this._animationFrameSet=!1,this._animationFrameHandle=null,this.renderFrameOfReference=r=>{const a=this._getViewportsAsArray().map(o=>{if(o.getFrameOfReferenceUID()===r)return o.id});this.renderViewports(a)},this.id=e||or(),this.useCPURendering=Bg(),p2.set(this),!XW())throw new Error("@cornerstonejs/core is not initialized, run init() first");this._viewports=new Map,this.hasBeenDestroyed=!1,Pf()?.debug?.statsOverlay&&bk.setup()}enableElement(e){const n=this._normalizeViewportInputEntry(e);this._throwIfDestroyed();const{element:r,viewportId:i}=n;if(!r)throw new Error("No element provided");this.getViewport(i)&&this.disableElement(i);const{type:o}=n,s=nu(o);!this.useCPURendering&&!s?this.enableVTKjsDrivenViewport(n):this.addCustomViewport(n);const l=Ys(r),{background:c}=n.defaultOptions;this.fillCanvasWithBackgroundColor(l,c)}disableElement(e){this._throwIfDestroyed();const n=this.getViewport(e);if(!n){console.warn(`viewport ${e} does not exist`);return}this._resetViewport(n),!nu(n.type)&&!this.useCPURendering&&this.offscreenMultiRenderWindow&&this.offscreenMultiRenderWindow.removeRenderer(e),this._removeViewport(e),n.isDisabled=!0,this._needsRender.delete(e),this.getViewports().length||this._clearAnimationFrame()}setViewports(e){const n=this._normalizeViewportInputEntries(e);this._throwIfDestroyed(),this._reset();const r=[],i=[];n.forEach(a=>{!this.useCPURendering&&!nu(a.type)?r.push(a):i.push(a)}),this.setVtkjsDrivenViewports(r),this.setCustomViewports(i),n.forEach(a=>{const o=Ys(a.element),{background:s}=a.defaultOptions;this.fillCanvasWithBackgroundColor(o,s)})}resize(e=!0,n=!0){this._throwIfDestroyed();const r=this._getViewportsAsArray(),i=[],a=[];r.forEach(o=>{nu(o.type)?a.push(o):i.push(o)}),i.length&&this._resizeVTKViewports(i,n,e),a.length&&this._resizeUsingCustomResizeHandler(a,n,e)}getViewport(e){return this._viewports?.get(e)}getViewports(){return this._throwIfDestroyed(),this._getViewportsAsArray()}getStackViewport(e){this._throwIfDestroyed();const n=this.getViewport(e);if(!n)throw new Error(`Viewport with Id ${e} does not exist`);if(!(n instanceof aa))throw new Error(`Viewport with Id ${e} is not a StackViewport.`);return n}getStackViewports(){return this._throwIfDestroyed(),this.getViewports().filter(n=>n instanceof aa)}getVolumeViewports(){this._throwIfDestroyed();const e=this.getViewports(),n=r=>r instanceof lo;return e.filter(n)}render(){const n=this.getViewports().map(r=>r.id);this._setViewportsToBeRenderedNextFrame(n)}renderViewports(e){this._setViewportsToBeRenderedNextFrame(e)}renderViewport(e){this._setViewportsToBeRenderedNextFrame([e])}destroy(){this.hasBeenDestroyed||(bk.cleanup(),this.useCPURendering||(this._getViewportsAsArray().forEach(n=>{this.offscreenMultiRenderWindow&&this.offscreenMultiRenderWindow.removeRenderer(n.id)}),this.offscreenMultiRenderWindow&&this.offscreenMultiRenderWindow.delete(),delete this.offscreenMultiRenderWindow),this._reset(),p2.delete(this.id),this.hasBeenDestroyed=!0)}fillCanvasWithBackgroundColor(e,n){const r=e.getContext("2d");let i;if(n){const a=n.map(o=>Math.floor(255*o));i=`rgb(${a[0]}, ${a[1]}, ${a[2]})`}else i="black";r.fillStyle=i,r.fillRect(0,0,e.width,e.height)}_normalizeViewportInputEntry(e){const{type:n,defaultOptions:r}=e;let i=r;return(!i||Object.keys(i).length===0)&&(i={background:[0,0,0],orientation:null,displayArea:null},n===br.ORTHOGRAPHIC&&(i={...i,orientation:n0.AXIAL})),{...e,defaultOptions:i}}_normalizeViewportInputEntries(e){const n=[];return e.forEach(r=>{n.push(this._normalizeViewportInputEntry(r))}),n}_resizeUsingCustomResizeHandler(e,n=!0,r=!0){e.forEach(i=>{typeof i.resize=="function"&&i.resize()}),e.forEach(i=>{const a=i.getCamera();i.resetCamera(),n&&i.setCamera(a)}),r&&this.render()}_removeViewport(e){if(!this.getViewport(e)){console.warn(`viewport ${e} does not exist`);return}this._viewports.delete(e)}addCustomViewport(e){const{element:n,viewportId:r,type:i,defaultOptions:a}=e;n.tabIndex=-1;const o=Ys(n),{clientWidth:s,clientHeight:l}=o;(o.width!==s||o.height!==l)&&(o.width=s,o.height=l);const c={id:r,renderingEngineId:this.id,element:n,type:i,canvas:o,sx:0,sy:0,sWidth:s,sHeight:l,defaultOptions:a||{}},f=gJ[i],u=new f(c);this._viewports.set(r,u);const d={element:n,viewportId:r,renderingEngineId:this.id};Ct(St,vt.ELEMENT_ENABLED,d)}getRenderer(e){return this.offscreenMultiRenderWindow.getRenderer(e)}getOffscreenMultiRenderWindow(e){if(this.useCPURendering)throw new Error("Offscreen multi render window is not available when using CPU rendering.");return this.offscreenMultiRenderWindow}setCustomViewports(e){e.forEach(n=>{this.addCustomViewport(n)})}_getViewportsAsArray(){return Array.from(this._viewports.values())}_setViewportsToBeRenderedNextFrame(e){e.forEach(n=>{this._needsRender.add(n)}),this._render()}_render(){this._needsRender.size>0&&!this._animationFrameSet&&(this._animationFrameHandle=window.requestAnimationFrame(this._renderFlaggedViewports),this._animationFrameSet=!0)}_resetViewport(e){const n=this.id,{element:r,canvas:i,id:a}=e,o={element:r,viewportId:a,renderingEngineId:n};e.removeWidgets(),Ct(St,vt.ELEMENT_DISABLED,o),r.removeAttribute("data-viewport-uid"),r.removeAttribute("data-rendering-engine-uid"),i.getContext("2d").clearRect(0,0,i.width,i.height)}_clearAnimationFrame(){window.cancelAnimationFrame(this._animationFrameHandle),this._needsRender.clear(),this._animationFrameSet=!1,this._animationFrameHandle=null}_reset(){this._getViewportsAsArray().forEach(n=>{this._resetViewport(n)}),this._clearAnimationFrame(),this._viewports=new Map}_throwIfDestroyed(){if(this.hasBeenDestroyed)throw new Error("this.destroy() has been manually called to free up memory, can not longer use this instance. Instead make a new one.")}}class YD extends XD{constructor(e){super(e),this._renderFlaggedViewports=()=>{this._throwIfDestroyed(),this.useCPURendering||this.performVtkDrawCall();const n=this._getViewportsAsArray(),r=[];for(let i=0;i<n.length;i++){const a=n[i];if(this._needsRender.has(a.id)){const o=this.renderViewportUsingCustomOrVtkPipeline(a);if(r.push(o),a.setRendered(),this._needsRender.delete(a.id),this._needsRender.size===0)break}}this._animationFrameSet=!1,this._animationFrameHandle=null,r.forEach(i=>{i?.element&&Ct(i.element,vt.IMAGE_RENDERED,i)})},this.useCPURendering||(this.offscreenMultiRenderWindow=vY.newInstance(),this.offScreenCanvasContainer=document.createElement("div"),this.offscreenMultiRenderWindow.setContainer(this.offScreenCanvasContainer))}enableVTKjsDrivenViewport(e){const r=this._getViewportsAsArray().filter(f=>nu(f.type)===!1),i=r.map(f=>f.canvas),a=Ys(e.element);i.push(a);const{offScreenCanvasWidth:o,offScreenCanvasHeight:s}=this._resizeOffScreenCanvas(i),l=this._resize(r,o,s),c={...e,canvas:a};this.addVtkjsDrivenViewport(c,{offScreenCanvasWidth:o,offScreenCanvasHeight:s,xOffset:l})}addVtkjsDrivenViewport(e,n){const{element:r,canvas:i,viewportId:a,type:o,defaultOptions:s}=e;r.tabIndex=-1;const{offScreenCanvasWidth:l,offScreenCanvasHeight:c,xOffset:f}=n,{sxStartDisplayCoords:u,syStartDisplayCoords:d,sxEndDisplayCoords:h,syEndDisplayCoords:p,sx:g,sy:m,sWidth:y,sHeight:v}=this._getViewportCoordsOnOffScreenCanvas(e,l,c,f);this.offscreenMultiRenderWindow.addRenderer({viewport:[u,d,h,p],id:a,background:s.background?s.background:[0,0,0]});const x={id:a,element:r,renderingEngineId:this.id,type:o,canvas:i,sx:g,sy:m,sWidth:y,sHeight:v,defaultOptions:s||{}};let w;if(o===br.STACK)w=new aa(x);else if(o===br.ORTHOGRAPHIC||o===br.PERSPECTIVE)w=new oa(x);else if(o===br.VOLUME_3D)w=new sC(x);else throw new Error(`Viewport Type ${o} is not supported`);this._viewports.set(a,w);const S={element:r,viewportId:a,renderingEngineId:this.id};w.suppressEvents||Ct(St,vt.ELEMENT_ENABLED,S)}setVtkjsDrivenViewports(e){if(e.length){const n=e.map(o=>Ys(o.element));n.forEach(o=>{const s=window.devicePixelRatio||1,l=o.getBoundingClientRect();o.width=l.width*s,o.height=l.height*s});const{offScreenCanvasWidth:r,offScreenCanvasHeight:i}=this._resizeOffScreenCanvas(n);let a=0;for(let o=0;o<e.length;o++){const s=e[o],l=n[o],c={...s,canvas:l};this.addVtkjsDrivenViewport(c,{offScreenCanvasWidth:r,offScreenCanvasHeight:i,xOffset:a}),a+=l.width}}}_resizeVTKViewports(e,n=!0,r=!0){const i=e.map(a=>Ys(a.element));if(i.forEach(a=>{const o=window.devicePixelRatio||1;a.width=a.clientWidth*o,a.height=a.clientHeight*o}),i.length){const{offScreenCanvasWidth:a,offScreenCanvasHeight:o}=this._resizeOffScreenCanvas(i);this._resize(e,a,o)}e.forEach(a=>{const o=a.getCamera(),s=a.getRotation(),{flipHorizontal:l}=o;a.resetCameraForResize();const c=a.getDisplayArea();n&&(c?(l&&a.setCamera({flipHorizontal:l}),s&&a.setViewPresentation({rotation:s})):a.setCamera(o))}),r&&this.render()}performVtkDrawCall(){const{offscreenMultiRenderWindow:e}=this,n=e.getRenderWindow(),r=e.getRenderers();if(r.length){for(let i=0;i<r.length;i++){const{renderer:a,id:o}=r[i];this._needsRender.has(o)?a.setDraw(!0):a.setDraw(!1)}n.render();for(let i=0;i<r.length;i++)r[i].renderer.setDraw(!1)}}renderViewportUsingCustomOrVtkPipeline(e){let n;if(e.sWidth<A3||e.sHeight<A3){console.warn("Viewport is too small",e.sWidth,e.sHeight);return}if(nu(e.type)===!0)n=e.customRenderViewportToCanvas();else{if(this.useCPURendering)throw new Error("GPU not available, and using a viewport with no custom render pipeline.");const{offscreenMultiRenderWindow:r}=this,o=r.getOpenGLRenderWindow().get3DContext().canvas;n=this._renderViewportFromVtkCanvasToOnscreenCanvas(e,o)}return n}_renderViewportFromVtkCanvasToOnscreenCanvas(e,n){const{element:r,canvas:i,sx:a,sy:o,sWidth:s,sHeight:l,id:c,renderingEngineId:f,suppressEvents:u}=e,{width:d,height:h}=i;return i.getContext("2d").drawImage(n,a,o,s,l,0,0,d,h),{element:r,suppressEvents:u,viewportId:c,renderingEngineId:f,viewportStatus:e.viewportStatus}}_resizeOffScreenCanvas(e){const{offScreenCanvasContainer:n,offscreenMultiRenderWindow:r}=this,i=Math.max(...e.map(o=>o.height));let a=0;return e.forEach(o=>{a+=o.width}),n.width=a,n.height=i,r.resize(),{offScreenCanvasWidth:a,offScreenCanvasHeight:i}}_resize(e,n,r){let i=0;for(let a=0;a<e.length;a++){const o=e[a],{sxStartDisplayCoords:s,syStartDisplayCoords:l,sxEndDisplayCoords:c,syEndDisplayCoords:f,sx:u,sy:d,sWidth:h,sHeight:p}=this._getViewportCoordsOnOffScreenCanvas(o,n,r,i);i+=o.canvas.width,o.sx=u,o.sy=d,o.sWidth=h,o.sHeight=p,this.offscreenMultiRenderWindow.getRenderer(o.id).setViewport(s,l,c,f)}return i}_getViewportCoordsOnOffScreenCanvas(e,n,r,i){const{canvas:a}=e,{width:o,height:s}=a,l=i,c=0,f=l/n,u=c+(r-s)/r,d=o/n,h=s/r;return{sxStartDisplayCoords:f,syStartDisplayCoords:u,sxEndDisplayCoords:f+d,syEndDisplayCoords:u+h,sx:l,sy:c,sWidth:o,sHeight:s}}}class U_e{constructor(e){this.contexts=[],this.offScreenCanvasContainers=[],this.viewportToContext=new Map;for(let n=0;n<e;n++){const r=vY.newInstance(),i=document.createElement("div");r.setContainer(i),this.contexts.push(r),this.offScreenCanvasContainers.push(i)}}getContextByIndex(e){return e>=0&&e<this.contexts.length?{context:this.contexts[e],container:this.offScreenCanvasContainers[e]}:null}assignViewportToContext(e,n){this.viewportToContext.set(e,n)}getContextIndexForViewport(e){return this.viewportToContext.get(e)}getAllContexts(){return this.contexts}getContextCount(){return this.contexts.length}destroy(){this.contexts.forEach(e=>{e.delete()}),this.contexts=[],this.offScreenCanvasContainers=[],this.viewportToContext.clear()}}class V6 extends XD{constructor(e){super(e),this._renderFlaggedViewports=()=>{this._throwIfDestroyed();const a=this._getViewportsAsArray().filter(s=>this._needsRender.has(s.id));if(a.length===0){this._animationFrameSet=!1,this._animationFrameHandle=null;return}const o=a.map(s=>{const l=this.renderViewportUsingCustomOrVtkPipeline(s);return s.setRendered(),this._needsRender.delete(s.id),l});this._animationFrameSet=!1,this._animationFrameHandle=null,o.forEach(s=>{s?.element&&Ct(s.element,vt.IMAGE_RENDERED,s)})};const{rendering:n}=Pf(),{webGlContextCount:r}=n;this.useCPURendering||(this.contextPool=new U_e(r))}enableVTKjsDrivenViewport(e){const i=this._getViewportsAsArray().filter(s=>nu(s.type)===!1).map(s=>s.canvas),a=Ys(e.element);i.push(a);const o={...e,canvas:a};this.addVtkjsDrivenViewport(o)}addVtkjsDrivenViewport(e){const{element:n,canvas:r,viewportId:i,type:a,defaultOptions:o}=e;n.tabIndex=-1;let s=0;if(a===br.STACK){const h=this.contextPool.getAllContexts();s=this._viewports.size%h.length}this.contextPool.assignViewportToContext(i,s);const l=this.contextPool.getContextByIndex(s),{context:c}=l;c.addRenderer({viewport:[0,0,1,1],id:i,background:o.background?o.background:[0,0,0]});const f={id:i,element:n,renderingEngineId:this.id,type:a,canvas:r,sx:0,sy:0,sWidth:r.width,sHeight:r.height,defaultOptions:o||{}};let u;if(a===br.STACK)u=new aa(f);else if(a===br.ORTHOGRAPHIC||a===br.PERSPECTIVE)u=new oa(f);else if(a===br.VOLUME_3D)u=new sC(f);else throw new Error(`Viewport Type ${a} is not supported`);this._viewports.set(i,u);const d={element:n,viewportId:i,renderingEngineId:this.id};u.suppressEvents||Ct(St,vt.ELEMENT_ENABLED,d)}setVtkjsDrivenViewports(e){if(e.length){const n=e.map(r=>Ys(r.element));n.forEach(r=>{const i=window.devicePixelRatio||1,a=r.getBoundingClientRect();r.width=a.width*i,r.height=a.height*i});for(let r=0;r<e.length;r++){const i=e[r],a=n[r],o={...i,canvas:a};this.addVtkjsDrivenViewport(o)}}}_resizeVTKViewports(e,n=!0,r=!0){const i=e.map(a=>Ys(a.element));i.forEach(a=>{const o=window.devicePixelRatio||1;a.width=a.clientWidth*o,a.height=a.clientHeight*o}),i.length&&this._resize(e),e.forEach(a=>{const o=a.getCamera(),s=a.getRotation(),{flipHorizontal:l}=o;a.resetCameraForResize();const c=a.getDisplayArea();n&&(c?(l&&a.setCamera({flipHorizontal:l}),s&&a.setViewPresentation({rotation:s})):a.setCamera(o))}),r&&this.render()}renderViewportUsingCustomOrVtkPipeline(e){if(nu(e.type))return e.customRenderViewportToCanvas();if(this.useCPURendering)throw new Error("GPU not available, and using a viewport with no custom render pipeline.");const n=this.contextPool.getContextIndexForViewport(e.id),r=this.contextPool.getContextByIndex(n),{context:i,container:a}=r;return this._renderViewportWithContext(e,i,a)}_renderViewportWithContext(e,n,r){if(e.sWidth<A3||e.sHeight<A3){console.warn("Viewport is too small",e.sWidth,e.sHeight);return}if(nu(e.type))return e.customRenderViewportToCanvas();if(this.useCPURendering)throw new Error("GPU not available, and using a viewport with no custom render pipeline.");n.getRenderer(e.id)||n.addRenderer({viewport:[0,0,1,1],id:e.id,background:e.defaultOptions?.background||[0,0,0]});const i=n.getRenderWindow();this._resizeOffScreenCanvasForViewport(e.canvas,r,n),n.getRenderer(e.id).setViewport(0,0,1,1);const o=n.getRenderers();o.forEach(({renderer:d,id:h})=>{d.setDraw(h===e.id)});const s=this.getWidgetRenderers();s.forEach((d,h)=>{h.setDraw(d===e.id)}),i.render(),o.forEach(({renderer:d})=>d.setDraw(!1)),s.forEach((d,h)=>{h.setDraw(!1)});const f=n.getOpenGLRenderWindow().get3DContext().canvas;return this._copyToOnscreenCanvas(e,f)}_renderViewportFromVtkCanvasToOnscreenCanvas(e,n){return this._copyToOnscreenCanvas(e,n)}_resizeOffScreenCanvasForViewport(e,n,r){const i=e.width,a=e.height;n.height===a&&n.width===i||(n.width=i,n.height=a,r.resize())}_copyToOnscreenCanvas(e,n){const{element:r,canvas:i,id:a,renderingEngineId:o,suppressEvents:s}=e,{width:l,height:c}=i;return i.getContext("2d").drawImage(n,0,0,l,c,0,0,l,c),{element:r,suppressEvents:s,viewportId:a,renderingEngineId:o,viewportStatus:e.viewportStatus}}_resize(e){for(const n of e){n.sx=0,n.sy=0,n.sWidth=n.canvas.width,n.sHeight=n.canvas.height;const r=this.contextPool.getContextIndexForViewport(n.id),i=this.contextPool.getContextByIndex(r),{context:a}=i;a.getRenderer(n.id).setViewport(0,0,1,1)}}getWidgetRenderers(){const e=this._getViewportsAsArray(),n=new Map;return e.forEach(r=>{(r.getWidgets?r.getWidgets():[]).forEach(a=>{const o=a.getRenderer?a.getRenderer():null;o&&n.set(o,r.id)})}),n}getRenderer(e){const n=this.contextPool?.getContextIndexForViewport(e),r=this.contextPool.getContextByIndex(n),{context:i}=r;return i.getRenderer(e)}disableElement(e){const n=this.getViewport(e);if(n&&(super.disableElement(e),!nu(n.type)&&!this.useCPURendering)){const r=this.contextPool.getContextIndexForViewport(e);if(r!==void 0){const i=this.contextPool.getContextByIndex(r);if(i){const{context:a}=i;a.removeRenderer(e)}}}}destroy(){this.contextPool&&this.contextPool.destroy(),super.destroy()}getOffscreenMultiRenderWindow(e){if(this.useCPURendering)throw new Error("Offscreen multi render window is not available when using CPU rendering.");const n=this.contextPool.getContextIndexForViewport(e);return this.contextPool.getContextByIndex(n).context}}class mJ{constructor(e){const r=Pf()?.rendering?.renderingEngineMode;switch(r){case Hh.Tiled:this._implementation=new YD(e);break;case Hh.ContextPool:this._implementation=new V6(e);break;default:console.warn(`RenderingEngine: Unknown rendering engine mode "${r}". Defaulting to Next rendering engine.`),this._implementation=new V6(e);break}}get id(){return this._implementation.id}enableElement(e){return this._implementation.enableElement(e)}disableElement(e){return this._implementation.disableElement(e)}setViewports(e){return this._implementation.setViewports(e)}resize(e=!0,n=!0){return this._implementation.resize(e,n)}getViewport(e){return this._implementation.getViewport(e)}getViewports(){return this._implementation.getViewports()}getStackViewport(e){return this._implementation.getStackViewport(e)}getStackViewports(){return this._implementation.getStackViewports()}getVolumeViewports(){return this._implementation.getVolumeViewports()}getRenderer(e){return this._implementation.getRenderer(e)}fillCanvasWithBackgroundColor(e,n){return this._implementation.fillCanvasWithBackgroundColor(e,n)}render(){return this._implementation.render()}renderViewports(e){return this._implementation.renderViewports(e)}renderViewport(e){return this._implementation.renderViewport(e)}destroy(){return this._implementation.destroy()}getOffscreenMultiRenderWindow(e){return this._implementation.getOffscreenMultiRenderWindow(e)}}const B_e="3.33.4";class vJ{constructor(e){this._color=[200,0,0],this.id=e.id,this._points=e.points,this._polys=e.polys,this._color=e.color??this._color,this.frameOfReferenceUID=e.frameOfReferenceUID,this._segmentIndex=e.segmentIndex,this.sizeInBytes=this._getSizeInBytes(),this._updateCentroid(),this._visible=!0}_getSizeInBytes(){return this._points.length*4+this._polys.length*4}_updateCentroid(){const e=this._points.length/3;let n=0,r=0,i=0;for(let a=0;a<this._points.length;a+=3)n+=this._points[a],r+=this._points[a+1],i+=this._points[a+2];this._centroid=[n/e,r/e,i/e]}get color(){return this._color}set color(e){this._color=e}get points(){return this._points}set points(e){this._points=e,this._updateCentroid()}get polys(){return this._polys}set polys(e){this._polys=e}get segmentIndex(){return this._segmentIndex}get visible(){return this._visible}set visible(e){this._visible=e}get centroid(){return this._centroid}get flatPointsArray(){return this._points}get totalNumberOfPoints(){return this._points.length/3}}function yJ(t){return new TextDecoder("latin1").decode(t)}function $_e(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;const r=yJ(t),i=e.exec(r);if(!i)return{text:r};const a=i.index+i[0].length,o=r.substring(0,a);let s=null;const l=n?n.exec(r):null;if(l){const c=r.substr(l.index);s={text:o+c,binaryBuffer:t.slice(a,l.index)}}else s={text:o,binaryBuffer:t.slice(a)};return s}var T2={arrayBufferToString:yJ,extractBinary:$_e};const JD={};function xJ(t){return!!JD[t]}function G_e(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"http",e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return JD[t](e)}function bJ(t,e){JD[t]=e}var uy={get:G_e,has:xJ,registerType:bJ};function wJ(){const t=new ArrayBuffer(4),e=new Uint8Array(t),n=new Uint32Array(t);return e[0]=161,e[1]=178,e[2]=195,e[3]=212,n[0]===3569595041?"LittleEndian":n[0]===2712847316?"BigEndian":null}const j_e=wJ();function z_e(t,e){if(e<2)return;const n=new Int8Array(t),r=n.length,i=[];for(let a=0;a<r;a+=e){for(let o=0;o<e;o++)i.push(n[a+o]);for(let o=0;o<e;o++)n[a+o]=i.pop()}}var a8={ENDIANNESS:j_e,getEndianness:wJ,swapBytes:z_e};const{vtkErrorMacro:CJ,vtkDebugMacro:W_e}=le,ZD=()=>(CJ("LiteHttpDataAccessHelper does not support compression. Need to register HttpDataAccessHelper instead."),Promise.reject(new Error("LiteHttpDataAccessHelper does not support compression. Need to register HttpDataAccessHelper instead.")));let hm=0;function lC(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=new XMLHttpRequest;return r.open(t,e,!0),n.headers&&Object.entries(n.headers).forEach(i=>{let[a,o]=i;return r.setRequestHeader(a,o)}),n.progressCallback&&r.addEventListener("progress",n.progressCallback),r}function H_e(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise((n,r)=>{const i=lC("GET",t,e);i.onreadystatechange=a=>{i.readyState===4&&(i.status===200||i.status===0?n(i.response):r({xhr:i,e:a}))},i.responseType="arraybuffer",i.send()})}function K_e(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return r&&r.compression?ZD():n.ref&&!n.ref.pending?new Promise((i,a)=>{const o=[e,n.ref.basepath,n.ref.id].join("/"),s=lC("GET",o,r);s.onreadystatechange=l=>{s.readyState===1&&(n.ref.pending=!0,++hm===1&&t?.invokeBusy&&t.invokeBusy(!0)),s.readyState===4&&(n.ref.pending=!1,s.status===200||s.status===0?(n.buffer=s.response,n.ref.encode==="JSON"?n.values=JSON.parse(n.buffer):(a8.ENDIANNESS!==n.ref.encode&&a8.ENDIANNESS&&(W_e(`Swap bytes of ${n.name}`),a8.swapBytes(n.buffer,zH[n.dataType])),n.values=le.newTypedArray(n.dataType,n.buffer)),n.values.length!==n.size&&CJ(`Error in FetchArray: ${n.name}, does not have the proper array size. Got ${n.values.length}, instead of ${n.size}`),delete n.ref,--hm===0&&t?.invokeBusy&&t.invokeBusy(!1),t?.modified&&t.modified(),i(n)):a({xhr:s,e:l}))},s.responseType=n.dataType!=="string"?"arraybuffer":"text",s.send()}):Promise.resolve(n)}function q_e(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return n&&n.compression?ZD():new Promise((r,i)=>{const a=lC("GET",e,n);a.onreadystatechange=o=>{a.readyState===1&&++hm===1&&t?.invokeBusy&&t.invokeBusy(!0),a.readyState===4&&(--hm===0&&t?.invokeBusy&&t.invokeBusy(!1),a.status===200||a.status===0?r(JSON.parse(a.responseText)):i({xhr:a,e:o}))},a.responseType="text",a.send()})}function X_e(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return n&&n.compression?ZD():new Promise((r,i)=>{const a=lC("GET",e,n);a.onreadystatechange=o=>{a.readyState===1&&++hm===1&&t?.invokeBusy&&t.invokeBusy(!0),a.readyState===4&&(--hm===0&&t?.invokeBusy&&t.invokeBusy(!1),a.status===200||a.status===0?r(a.responseText):i({xhr:a,e:o}))},a.responseType="text",a.send()})}function Y_e(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return new Promise((r,i)=>{const a=new Image;n.crossOrigin&&(a.crossOrigin=n.crossOrigin),a.onload=()=>r(a),a.onerror=i,a.src=e})}const J_e={fetchArray:K_e,fetchJSON:q_e,fetchText:X_e,fetchBinary:H_e,fetchImage:Y_e};xJ("http")||bJ("http",t=>J_e);const o8={ASCII:"ascii",BINARY_LITTLE_ENDIAN:"binary_little_endian"},wk={diffuse_red:"red",diffuse_green:"green",diffuse_blue:"blue"},SJ={patternHeader:/ply([\s\S]*)end_header\r?\n/,patternBody:/end_header\s([\s\S]*)$/};function Ck(t){let e="",n=0;const r=SJ.patternHeader.exec(t);r!==null&&(e=r[1],n=r[0].length);const i={comments:[],elements:[],headerLength:n},a=e.split(`
`);let o,s,l;for(let c=0;c<a.length;c++){let f=a[c];if(f=f.trim(),f!==""){let u;switch(l=f.split(/\s+/),s=l.shift(),f=l.join(" "),s){case"format":i.format=l[0],i.version=l[1];break;case"comment":i.comments.push(f);break;case"element":o!==void 0&&i.elements.push(o),o={},o.name=l[0],o.count=parseInt(l[1],10),o.properties=[];break;case"property":u={type:l[0]},u.type==="list"?(u.name=l[3],u.countType=l[1],u.itemType=l[2]):u.name=l[1],u.name in wk&&(u.name=wk[u.name]),o.properties.push(u);break;case"obj_info":i.objInfo=f;break;default:console.warn("unhandled",s,l);break}}}return o!==void 0&&i.elements.push(o),i}function Sk(t,e){const n=e.find(g=>g.name==="vertex"),r=e.find(g=>g.name==="face");let i=0,a=0;n&&(i=n.count),r&&(a=r.count);const o=new Float32Array(i*3),s=new Uint8Array(i*3),l=new Float32Array(i*2),c=new Float32Array(i*3),f=t.colors.length>0,u=t.uvs.length>0,d=t.normals.length>0,h=t.faceVertexUvs.length>0;for(let g=0;g<i;g++){let m=g*3+0,y=g*3+1;const v=g*3+2;o[m]=t.vertices[m],o[y]=t.vertices[y],o[v]=t.vertices[v],f&&(s[m]=t.colors[m],s[y]=t.colors[y],s[v]=t.colors[v]),u&&(m=g*2+0,y=g*2+1,l[m]=t.uvs[m],l[y]=t.uvs[y]),d&&(c[m]=t.normals[m],c[y]=t.normals[y],c[v]=t.normals[v])}if(!u&&h){let g=0,m=0;for(let y=0;y<a;++y){const v=t.indices[g++],x=t.faceVertexUvs[m++];if(x&&v*2===x.length)for(let w=0;w<v;++w){const S=t.indices[g++];l[S*2+0]=x[w*2+0],l[S*2+1]=x[w*2+1]}else g+=v}}const p=ra.newInstance();if(p.getPoints().setData(o,3),f&&p.getPointData().setScalars(nn.newInstance({numberOfComponents:3,values:s,name:"Scalars"})),u||h){const g=nn.newInstance({numberOfComponents:2,values:l,name:"TextureCoordinates"}),m=p.getPointData();m.addArray(g),m.setActiveTCoords(g.getName())}return d&&p.getPointData().setNormals(nn.newInstance({numberOfComponents:3,name:"Normals",values:c})),p.getPolys().setData(Uint32Array.from(t.indices)),p}function s8(t,e){let n;switch(e){case"char":case"uchar":case"short":case"ushort":case"int":case"uint":case"int8":case"uint8":case"int16":case"uint16":case"int32":case"uint32":n=parseInt(t,10);break;case"float":case"double":case"float32":case"float64":n=parseFloat(t);break;default:console.log("Unsupported type");break}return n}function Z_e(t,e){const n=e.split(/\s+/),r={};for(let i=0;i<t.length;i++)if(t[i].type==="list"){const a=[],o=s8(n.shift(),t[i].countType);for(let s=0;s<o;s++)a.push(s8(n.shift(),t[i].itemType));r[t[i].name]=a}else r[t[i].name]=s8(n.shift(),t[i].type);return r}function Tk(t,e,n){if(e==="vertex")t.vertices.push(n.x,n.y,n.z),"nx"in n&&"ny"in n&&"nz"in n&&t.normals.push(n.nx,n.ny,n.nz),"s"in n&&"t"in n?t.uvs.push(n.s,n.t):"u"in n&&"v"in n?t.uvs.push(n.u,n.v):"texture_u"in n&&"texture_v"in n&&t.uvs.push(n.texture_u,n.texture_v),"red"in n&&"green"in n&&"blue"in n&&t.colors.push(n.red,n.green,n.blue);else if(e==="face"){const r=n.vertex_indices||n.vertex_index,i=n.texcoord;r&&r.length>0&&(t.indices.push(r.length),r.forEach((a,o)=>{t.indices.push(a)})),t.faceVertexUvs.push(i)}}function l8(t,e,n,r){let i;switch(n){case"int8":case"char":i=[t.getInt8(e),1];break;case"uint8":case"uchar":i=[t.getUint8(e),1];break;case"int16":case"short":i=[t.getInt16(e,r),2];break;case"uint16":case"ushort":i=[t.getUint16(e,r),2];break;case"int32":case"int":i=[t.getInt32(e,r),4];break;case"uint32":case"uint":i=[t.getUint32(e,r),4];break;case"float32":case"float":i=[t.getFloat32(e,r),4];break;case"float64":case"double":i=[t.getFloat64(e,r),8];break;default:console.log("Unsupported type");break}return i}function Q_e(t,e,n,r){const i={};let a,o=0;for(let s=0;s<n.length;s++)if(n[s].type==="list"){const l=[];a=l8(t,e+o,n[s].countType,r);const c=a[0];o+=a[1];for(let f=0;f<c;f++)a=l8(t,e+o,n[s].itemType,r),l.push(a[0]),o+=a[1];i[n[s].name]=l}else a=l8(t,e+o,n[s].type,r),i[n[s].name]=a[0],o+=a[1];return[i,o]}function e9e(t,e){e.classHierarchy.push("vtkPLYReader"),e.dataAccessHelper||(e.dataAccessHelper=uy.get("http"));function n(r){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{compression:a,progressCallback:o}=e;return i.binary?e.dataAccessHelper.fetchBinary(r,{compression:a,progressCallback:o}):e.dataAccessHelper.fetchText(t,r,{compression:a,progressCallback:o})}t.setUrl=function(r){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{binary:!0};e.url=r;const a=r.split("/");return a.pop(),e.baseURL=a.join("/"),e.compression=i.compression,t.loadData({progressCallback:i.progressCallback,binary:!!i.binary})},t.loadData=function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const i=n(e.url,r);return i.then(t.parse),i},t.parse=r=>{typeof r=="string"?t.parseAsText(r):t.parseAsArrayBuffer(r)},t.parseAsArrayBuffer=r=>{if(!r)return;if(r!==e.parseData)t.modified();else return;const i=T2.arrayBufferToString(r),a=Ck(i);if(!(a.format!==o8.ASCII)){t.parseAsText(r);return}e.parseData=r;const s={indices:[],vertices:[],normals:[],uvs:[],faceVertexUvs:[],colors:[]},l=a.format===o8.BINARY_LITTLE_ENDIAN,c=r instanceof ArrayBuffer?r:r.buffer,f=new DataView(c,a.headerLength);let u,d=0;for(let p=0;p<a.elements.length;p++)for(let g=0;g<a.elements[p].count;g++){u=Q_e(f,d,a.elements[p].properties,l),d+=u[1];const m=u[0];Tk(s,a.elements[p].name,m)}const h=Sk(s,a.elements);e.output[0]=h},t.parseAsText=r=>{if(!r)return;if(r!==e.parseData)t.modified();else return;e.parseData=r;const i=T2.arrayBufferToString(r),a=Ck(i);if(a.format!==o8.ASCII){t.parseAsArrayBuffer(r);return}const s={indices:[],vertices:[],normals:[],uvs:[],faceVertexUvs:[],colors:[]},l=SJ.patternBody.exec(i);let c="";l!==null&&(c=l[1]);const f=c.split(`
`);let u=0,d=0;for(let p=0;p<f.length;p++){let g=f[p];if(g=g.trim(),g!==""){d>=a.elements[u].count&&(u++,d=0);const m=Z_e(a.elements[u].properties,g);Tk(s,a.elements[u].name,m),d++}}const h=Sk(s,a.elements);e.output[0]=h},t.requestData=(r,i)=>{t.parse(e.parseData)}}const t9e={};function TJ(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,t9e,n),le.obj(t,e),le.get(t,e,["url","baseURL"]),le.setGet(t,e,["dataAccessHelper"]),le.algo(t,e,0,1),e9e(t,e),e.compression||(e.compression=null),e.progressCallback||(e.progressCallback=null)}const n9e=le.newInstance(TJ,"vtkPLYReader");var r9e={extend:TJ,newInstance:n9e};const{vtkErrorMacro:c8}=le;function i9e(t){const n=t.split(" ").filter(i=>i.indexOf("=")>-1),r={};for(let i=0;i<n.length;++i){const o=n[i].split("=");o.length===2&&(r[o[0]]=o[1])}return r}function Ek(t,e){for(let n=0;n<t.length;n++)e.push(t[n])}function a9e(t,e,n,r,i){const a=t[e];if(a===void 0)return-1;if(a.indexOf("endfacet")!==-1||a.indexOf("facet")===-1)return e+1;let o=0,s=2;const l=n.length/3,c=a.split(/[ \t]+/).filter(f=>f).slice(-3).map(Number);for(Ek(c,i);t[e+s].indexOf("vertex")!==-1;){const u=t[e+s].split(/[ \t]+/).filter(d=>d).slice(-3).map(Number);Ek(u,n),o++,s++}r.push(o);for(let f=0;f<o;f++)r.push(l+f);for(;t[e+s]&&t[e+s].indexOf("endfacet")!==-1;)s++;return e+s+2}function o9e(t,e){e.classHierarchy.push("vtkSTLReader"),e.dataAccessHelper||(e.dataAccessHelper=uy.get("http"));function n(i){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const o=a.compression!==void 0?a.compression:e.compression,s=a.progressCallback!==void 0?a.progressCallback:e.progressCallback;return a.binary?e.dataAccessHelper.fetchBinary(i,{compression:o,progressCallback:s}):e.dataAccessHelper.fetchText(t,i,{compression:o,progressCallback:s})}function r(i){const a=e.output[0],o=a.getPoints().getData(),s=a.getPolys().getData();if(!o||!s){console.warn("No valid polydata.");return}const l=new Map,c=new Map;let f=0,u=!1;for(let g=0;g<o.length;g+=3){const m=(o[g]*10**i).toFixed(0),y=(o[g+1]*10**i).toFixed(0),v=(o[g+2]*10**i).toFixed(0),x=`${m},${y},${v}`;l.get(x)!==void 0?(c.set(g/3,l.get(x)),u=!0):(c.set(g/3,f),l.set(x,f),f++)}const d=new Float32Array(l.size*3),h=Array.from(l.keys());for(let g=0;g<h.length;g++){const m=h[g],y=l.get(m)*3,v=m.split(",").map(x=>+x*10**-i);d[y]=v[0],d[y+1]=v[1],d[y+2]=v[2]}const p=new Int32Array(s);for(let g=0;g<s.length;g+=4)p[g]=3,p[g+1]=c.get(s[g+1]),p[g+2]=c.get(s[g+2]),p[g+3]=c.get(s[g+3]);a.getPoints().setData(d),a.getPolys().setData(p),u&&t.modified()}t.setUrl=function(i){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{binary:!0};e.url=i;const o=i.split("/");return o.pop(),e.baseURL=o.join("/"),t.loadData(a)},t.loadData=function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const a=n(e.url,i);return a.then(t.parse),a},t.parse=i=>{typeof i=="string"?t.parseAsText(i):t.parseAsArrayBuffer(i)},t.parseAsArrayBuffer=i=>{if(!i)return;if(i!==e.parseData)t.modified();else return;e.parseData=i;let a=!1;if(a=84+new DataView(i,0,84).getUint32(80,!0)*50===i.byteLength,!a){t.parseAsText(T2.arrayBufferToString(i));return}const l=i.slice(0,80),c=T2.arrayBufferToString(l),f=i9e(c),u=new DataView(i,84),d=(i.byteLength-84)/50,h=new Float32Array(d*9),p=new Float32Array(d*3),g=new Uint32Array(d*4),m=new Uint16Array(d);let y=0;for(let w=0;w<d;w++){const S=w*50;p[w*3+0]=u.getFloat32(S+0,!0),p[w*3+1]=u.getFloat32(S+4,!0),p[w*3+2]=u.getFloat32(S+8,!0),h[w*9+0]=u.getFloat32(S+12,!0),h[w*9+1]=u.getFloat32(S+16,!0),h[w*9+2]=u.getFloat32(S+20,!0),h[w*9+3]=u.getFloat32(S+24,!0),h[w*9+4]=u.getFloat32(S+28,!0),h[w*9+5]=u.getFloat32(S+32,!0),h[w*9+6]=u.getFloat32(S+36,!0),h[w*9+7]=u.getFloat32(S+40,!0),h[w*9+8]=u.getFloat32(S+44,!0),g[y++]=3,g[y++]=w*3+0,g[y++]=w*3+1,g[y++]=w*3+2,m[w]=u.getUint16(S+48,!0)}const v="SPACE";if(v in f&&f[v]!=="LPS"){const w=f[v],S=new Float32Array(16);switch(S[15]=1,w[0]){case"L":S[0]=1;break;case"R":S[0]=-1;break;default:c8(`Can not convert STL file from ${w} to LPS space: permutations not supported. Use itk.js STL reader instead.`);return}switch(w[1]){case"P":S[5]=1;break;case"A":S[5]=-1;break;default:c8(`Can not convert STL file from ${w} to LPS space: permutations not supported. Use itk.js STL reader instead.`);return}switch(w[2]){case"S":S[10]=1;break;case"I":S[10]=-1;break;default:c8(`Can not convert STL file from ${w} to LPS space: permutations not supported. Use itk.js STL reader instead.`);return}Jd.buildFromDegree().setMatrix(S).apply(h).apply(p)}const x=ra.newInstance();x.getPoints().setData(h,3),x.getPolys().setData(g),x.getCellData().setScalars(nn.newInstance({name:"Attribute",values:m})),x.getCellData().setNormals(nn.newInstance({name:"Normals",values:p,numberOfComponents:3})),e.output[0]=x,e.removeDuplicateVertices>=0&&r(e.removeDuplicateVertices)},t.parseAsText=i=>{if(!i)return;if(i!==e.parseData)t.modified();else return;e.parseData=i;const a=i.split(`
`);let o=1;const s=[],l=[],c=[];for(;o!==-1;)o=a9e(a,o,s,l,c);const f=ra.newInstance();f.getPoints().setData(Float32Array.from(s),3),f.getPolys().setData(Uint32Array.from(l)),f.getCellData().setNormals(nn.newInstance({name:"Normals",values:Float32Array.from(c),numberOfComponents:3})),e.output[0]=f,e.removeDuplicateVertices>=0&&r(e.removeDuplicateVertices)},t.requestData=(i,a)=>{t.parse(e.parseData)}}const s9e={removeDuplicateVertices:-1};function EJ(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,s9e,n),le.obj(t,e),le.get(t,e,["url","baseURL"]),le.setGet(t,e,["dataAccessHelper","removeDuplicateVertices"]),le.algo(t,e,0,1),o9e(t,e),e.compression||(e.compression=null),e.progressCallback||(e.progressCallback=null)}const l9e=le.newInstance(EJ,"vtkSTLReader");var c9e={extend:EJ,newInstance:l9e},wb={exports:{}},u9e=wb.exports,_k;function f9e(){return _k||(_k=1,(function(t,e){(function(n,r){t.exports=r()})(u9e,(function(){return(function(n){var r={};function i(a){if(r[a])return r[a].exports;var o=r[a]={i:a,l:!1,exports:{}};return n[a].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=n,i.c=r,i.d=function(a,o,s){i.o(a,o)||Object.defineProperty(a,o,{enumerable:!0,get:s})},i.r=function(a){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},i.t=function(a,o){if(1&o&&(a=i(a)),8&o||4&o&&typeof a=="object"&&a&&a.__esModule)return a;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:a}),2&o&&typeof a!="string")for(var l in a)i.d(s,l,(function(c){return a[c]}).bind(null,l));return s},i.n=function(a){var o=a&&a.__esModule?function(){return a.default}:function(){return a};return i.d(o,"a",o),o},i.o=function(a,o){return Object.prototype.hasOwnProperty.call(a,o)},i.p="",i(i.s=184)})([function(n,r,i){function a(o){for(var s in o)r.hasOwnProperty(s)||(r[s]=o[s])}Object.defineProperty(r,"__esModule",{value:!0}),a(i(240)),a(i(251)),a(i(175)),a(i(107)),a(i(29)),a(i(73)),a(i(106)),a(i(30)),a(i(252)),a(i(52)),a(i(97)),a(i(253)),a(i(37)),a(i(51)),a(i(173)),a(i(176)),a(i(172)),a(i(108)),a(i(254)),a(i(255)),a(i(256)),a(i(72)),a(i(177)),a(i(105)),a(i(17)),a(i(257)),a(i(12)),a(i(174))},function(n,r,i){var a=this&&this.__values||function(x){var w=typeof Symbol=="function"&&Symbol.iterator,S=w&&x[w],T=0;if(S)return S.call(x);if(x&&typeof x.length=="number")return{next:function(){return x&&T>=x.length&&(x=void 0),{value:x&&x[T++],done:!x}}};throw new TypeError(w?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var o=i(212);r.FixedSizeSet=o.FixedSizeSet;var s=i(213);r.ObjectCache=s.ObjectCache;var l=i(214);r.CompareCache=l.CompareCache;var c=i(215);r.Lazy=c.Lazy;var f=i(216);function u(x,w,S){if(y(x))x.forEach((function(_,D){return w.call(S,D,_)}));else for(var T in x)x.hasOwnProperty(T)&&w.call(S,T,x[T])}function d(x){var w,S;if(h(x))return x;if(g(x)){var T=[];try{for(var _=a(x),D=_.next();!D.done;D=_.next()){var I=D.value;T.push(d(I))}}catch(A){w={error:A}}finally{try{D&&!D.done&&(S=_.return)&&S.call(_)}finally{if(w)throw w.error}}return T}if(p(x)){T={};for(var R in x)if(x.hasOwnProperty(R)){var M=x[R];T[R]=d(M)}return T}return x}function h(x){return!!x&&Object.prototype.toString.call(x)==="[object Function]"}function p(x){var w=typeof x;return!!x&&(w==="function"||w==="object")}function g(x){return Array.isArray(x)}function m(x){return x instanceof Set}function y(x){return x instanceof Map}function v(x){if(p(x)){var w=Object.getPrototypeOf(x),S=w.constructor;return w&&S&&typeof S=="function"&&S instanceof S&&Function.prototype.toString.call(S)===Function.prototype.toString.call(Object)}return!1}r.StringWalker=f.StringWalker,r.applyMixin=function(x,w){for(var S=[],T=2;T<arguments.length;T++)S[T-2]=arguments[T];Object.getOwnPropertyNames(w.prototype).forEach((function(_){if(_!=="constructor"){if(S.indexOf(_)!==-1){var D=Object.getOwnPropertyDescriptor(x.prototype,_);D&&Object.defineProperty(x.prototype,"_"+_,D)}var I=Object.getOwnPropertyDescriptor(w.prototype,_);I&&Object.defineProperty(x.prototype,_,I)}}))},r.applyDefaults=function x(w,S,T){T===void 0&&(T=!1);var _=d(w||{});return u(S,(function(D,I){v(I)?_[D]=x(_[D],I,T):(T||_[D]===void 0)&&(_[D]=I)})),_},r.forEachArray=function(x,w,S){x.forEach(w,S)},r.forEachObject=u,r.arrayLength=function(x){return m(x)?x.size:x.length},r.objectLength=function(x){return y(x)?x.size:Object.keys(x).length},r.getObjectValue=function(x,w){return y(x)?x.get(w):x[w]},r.removeObjectValue=function(x,w){y(x)?x.delete(w):delete x[w]},r.clone=d,r.isBoolean=function(x){return typeof x=="boolean"},r.isNumber=function(x){return typeof x=="number"},r.isString=function(x){return typeof x=="string"},r.isFunction=h,r.isObject=p,r.isArray=g,r.isSet=m,r.isMap=y,r.isEmpty=function(x){if(g(x))return!x.length;if(m(x)||y(x))return!x.size;if(p(x)){for(var w in x)if(x.hasOwnProperty(w))return!1;return!0}return!1},r.isPlainObject=v,r.isIterable=function(x){return x&&typeof x[Symbol.iterator]=="function"},r.getValue=function(x){return h(x.valueOf)?x.valueOf():x},r.utf8Encode=function(x){for(var w=new Uint8Array(4*x.length),S=0,T=0;T<x.length;T++){var _=x.charCodeAt(T);if(_<128)w[S++]=_;else{if(_<2048)w[S++]=_>>6|192;else{if(_>55295&&_<56320){if(++T>=x.length)throw new Error("Incomplete surrogate pair.");var D=x.charCodeAt(T);if(D<56320||D>57343)throw new Error("Invalid surrogate character.");_=65536+((1023&_)<<10)+(1023&D),w[S++]=_>>18|240,w[S++]=_>>12&63|128}else w[S++]=_>>12|224;w[S++]=_>>6&63|128}w[S++]=63&_|128}}return w.subarray(0,S)},r.utf8Decode=function(x){for(var w="",S=0;S<x.length;){var T=x[S++];if(T>127)if(T>191&&T<224){if(S>=x.length)throw new Error("Incomplete 2-byte sequence.");T=(31&T)<<6|63&x[S++]}else if(T>223&&T<240){if(S+1>=x.length)throw new Error("Incomplete 3-byte sequence.");T=(15&T)<<12|(63&x[S++])<<6|63&x[S++]}else{if(!(T>239&&T<248))throw new Error("Unknown multi-byte start.");if(S+2>=x.length)throw new Error("Incomplete 4-byte sequence.");T=(7&T)<<18|(63&x[S++])<<12|(63&x[S++])<<6|63&x[S++]}if(T<=65535)w+=String.fromCharCode(T);else{if(!(T<=1114111))throw new Error("Code point exceeds UTF-16 limit.");T-=65536,w+=String.fromCharCode(T>>10|55296),w+=String.fromCharCode(1023&T|56320)}}return w}},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),(function(a){a[a.Before=0]="Before",a[a.Equal=1]="Equal",a[a.After=2]="After"})(r.BoundaryPosition||(r.BoundaryPosition={})),(function(a){a[a.None=0]="None",a[a.Capturing=1]="Capturing",a[a.AtTarget=2]="AtTarget",a[a.Bubbling=3]="Bubbling"})(r.EventPhase||(r.EventPhase={})),(function(a){a[a.Element=1]="Element",a[a.Attribute=2]="Attribute",a[a.Text=3]="Text",a[a.CData=4]="CData",a[a.EntityReference=5]="EntityReference",a[a.Entity=6]="Entity",a[a.ProcessingInstruction=7]="ProcessingInstruction",a[a.Comment=8]="Comment",a[a.Document=9]="Document",a[a.DocumentType=10]="DocumentType",a[a.DocumentFragment=11]="DocumentFragment",a[a.Notation=12]="Notation"})(r.NodeType||(r.NodeType={})),(function(a){a[a.Disconnected=1]="Disconnected",a[a.Preceding=2]="Preceding",a[a.Following=4]="Following",a[a.Contains=8]="Contains",a[a.ContainedBy=16]="ContainedBy",a[a.ImplementationSpecific=32]="ImplementationSpecific"})(r.Position||(r.Position={})),(function(a){a[a.Accept=1]="Accept",a[a.Reject=2]="Reject",a[a.Skip=3]="Skip"})(r.FilterResult||(r.FilterResult={})),(function(a){a[a.All=4294967295]="All",a[a.Element=1]="Element",a[a.Attribute=2]="Attribute",a[a.Text=4]="Text",a[a.CDataSection=8]="CDataSection",a[a.EntityReference=16]="EntityReference",a[a.Entity=32]="Entity",a[a.ProcessingInstruction=64]="ProcessingInstruction",a[a.Comment=128]="Comment",a[a.Document=256]="Document",a[a.DocumentType=512]="DocumentType",a[a.DocumentFragment=1024]="DocumentFragment",a[a.Notation=2048]="Notation"})(r.WhatToShow||(r.WhatToShow={})),(function(a){a[a.StartToStart=0]="StartToStart",a[a.StartToEnd=1]="StartToEnd",a[a.EndToEnd=2]="EndToEnd",a[a.EndToStart=3]="EndToStart"})(r.HowToCompare||(r.HowToCompare={}))},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(241);r.Cast=a.Cast;var o=i(150);r.Guard=o.Guard;var s=i(242);r.EmptySet=s.EmptySet},function(n,r,i){var a=i(11),o=i(55).f,s=i(21),l=i(25),c=i(80),f=i(119),u=i(123);n.exports=function(d,h){var p,g,m,y,v,x=d.target,w=d.global,S=d.stat;if(p=w?a:S?a[x]||c(x,{}):(a[x]||{}).prototype)for(g in h){if(y=h[g],m=d.noTargetGet?(v=o(p,g))&&v.value:p[g],!u(w?g:x+(S?".":"#")+g,d.forced)&&m!==void 0){if(typeof y==typeof m)continue;f(y,m)}(d.sham||m&&m.sham)&&s(y,"sham",!0),l(p,g,y,d)}}},function(n,r,i){var a=i(11),o=i(81),s=i(14),l=i(58),c=i(86),f=i(124),u=o("wks"),d=a.Symbol,h=f?d:d&&d.withoutSetter||l;n.exports=function(p){return s(u,p)||(c&&s(d,p)?u[p]=d[p]:u[p]=h("Symbol."+p)),u[p]}},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(1),o=i(29),s=(function(){function l(){this._features={mutationObservers:!0,customElements:!0,slots:!0,steps:!0},this._window=null,this._compareCache=new a.CompareCache,this._rangeList=new a.FixedSizeSet}return l.prototype.setFeatures=function(c){if(c===void 0&&(c=!0),a.isObject(c))for(var f in c)this._features[f]=c[f]||!1;else for(var f in this._features)this._features[f]=c},Object.defineProperty(l.prototype,"features",{get:function(){return this._features},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"window",{get:function(){return this._window===null&&(this._window=o.create_window()),this._window},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"compareCache",{get:function(){return this._compareCache},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"rangeList",{get:function(){return this._rangeList},enumerable:!0,configurable:!0}),Object.defineProperty(l,"instance",{get:function(){return l._instance||(l._instance=new l),l._instance},enumerable:!0,configurable:!0}),l})();r.dom=s.instance},function(n,r,i){var a=this&&this.__importStar||function(v){if(v&&v.__esModule)return v;var x={};if(v!=null)for(var w in v)Object.hasOwnProperty.call(v,w)&&(x[w]=v[w]);return x.default=v,x};Object.defineProperty(r,"__esModule",{value:!0});var o=a(i(228));r.base64=o;var s=a(i(146));r.byte=s;var l=a(i(147));r.byteSequence=l;var c=a(i(96));r.codePoint=c;var f=a(i(232));r.json=f;var u=a(i(233));r.list=u;var d=a(i(234));r.map=d;var h=a(i(235));r.namespace=h;var p=a(i(236));r.queue=p;var g=a(i(237));r.set=g;var m=a(i(238));r.stack=m;var y=a(i(239));r.string=y},function(n,r){n.exports=function(i){try{return!!i()}catch{return!0}}},function(n,r,i){var a,o=this&&this.__extends||(a=function(F,$){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(V,X){V.__proto__=X}||function(V,X){for(var Q in X)X.hasOwnProperty(Q)&&(V[Q]=X[Q])})(F,$)},function(F,$){function V(){this.constructor=F}a(F,$),F.prototype=$===null?Object.create($):(V.prototype=$.prototype,new V)});Object.defineProperty(r,"__esModule",{value:!0});var s=(function(F){function $(V,X){X===void 0&&(X="");var Q=F.call(this,X)||this;return Q.name=V,Q}return o($,F),$})(Error);r.DOMException=s;var l=(function(F){function $(V){return V===void 0&&(V=""),F.call(this,"DOMStringSizeError",V)||this}return o($,F),$})(s);r.DOMStringSizeError=l;var c=(function(F){function $(V){return V===void 0&&(V=""),F.call(this,"WrongDocumentError","The object is in the wrong document. "+V)||this}return o($,F),$})(s);r.WrongDocumentError=c;var f=(function(F){function $(V){return V===void 0&&(V=""),F.call(this,"NoDataAllowedError",V)||this}return o($,F),$})(s);r.NoDataAllowedError=f;var u=(function(F){function $(V){return V===void 0&&(V=""),F.call(this,"NoModificationAllowedError","The object can not be modified. "+V)||this}return o($,F),$})(s);r.NoModificationAllowedError=u;var d=(function(F){function $(V){return V===void 0&&(V=""),F.call(this,"NotSupportedError","The operation is not supported. "+V)||this}return o($,F),$})(s);r.NotSupportedError=d;var h=(function(F){function $(V){return V===void 0&&(V=""),F.call(this,"InUseAttributeError",V)||this}return o($,F),$})(s);r.InUseAttributeError=h;var p=(function(F){function $(V){return V===void 0&&(V=""),F.call(this,"InvalidStateError","The object is in an invalid state. "+V)||this}return o($,F),$})(s);r.InvalidStateError=p;var g=(function(F){function $(V){return V===void 0&&(V=""),F.call(this,"InvalidModificationError","The object can not be modified in this way. "+V)||this}return o($,F),$})(s);r.InvalidModificationError=g;var m=(function(F){function $(V){return V===void 0&&(V=""),F.call(this,"NamespaceError","The operation is not allowed by Namespaces in XML. [XMLNS] "+V)||this}return o($,F),$})(s);r.NamespaceError=m;var y=(function(F){function $(V){return V===void 0&&(V=""),F.call(this,"InvalidAccessError","The object does not support the operation or argument. "+V)||this}return o($,F),$})(s);r.InvalidAccessError=y;var v=(function(F){function $(V){return V===void 0&&(V=""),F.call(this,"ValidationError",V)||this}return o($,F),$})(s);r.ValidationError=v;var x=(function(F){function $(V){return V===void 0&&(V=""),F.call(this,"TypeMismatchError",V)||this}return o($,F),$})(s);r.TypeMismatchError=x;var w=(function(F){function $(V){return V===void 0&&(V=""),F.call(this,"SecurityError","The operation is insecure. "+V)||this}return o($,F),$})(s);r.SecurityError=w;var S=(function(F){function $(V){return V===void 0&&(V=""),F.call(this,"NetworkError","A network error occurred. "+V)||this}return o($,F),$})(s);r.NetworkError=S;var T=(function(F){function $(V){return V===void 0&&(V=""),F.call(this,"AbortError","The operation was aborted. "+V)||this}return o($,F),$})(s);r.AbortError=T;var _=(function(F){function $(V){return V===void 0&&(V=""),F.call(this,"URLMismatchError","The given URL does not match another URL. "+V)||this}return o($,F),$})(s);r.URLMismatchError=_;var D=(function(F){function $(V){return V===void 0&&(V=""),F.call(this,"QuotaExceededError","The quota has been exceeded. "+V)||this}return o($,F),$})(s);r.QuotaExceededError=D;var I=(function(F){function $(V){return V===void 0&&(V=""),F.call(this,"TimeoutError","The operation timed out. "+V)||this}return o($,F),$})(s);r.TimeoutError=I;var R=(function(F){function $(V){return V===void 0&&(V=""),F.call(this,"InvalidNodeTypeError","The supplied node is incorrect or has an incorrect ancestor for this operation. "+V)||this}return o($,F),$})(s);r.InvalidNodeTypeError=R;var M=(function(F){function $(V){return V===void 0&&(V=""),F.call(this,"DataCloneError","The object can not be cloned. "+V)||this}return o($,F),$})(s);r.DataCloneError=M;var A=(function(F){function $(V){return V===void 0&&(V=""),F.call(this,"NotImplementedError","The DOM method is not implemented by this module. "+V)||this}return o($,F),$})(s);r.NotImplementedError=A;var L=(function(F){function $(V){return V===void 0&&(V=""),F.call(this,"HierarchyRequestError","The operation would yield an incorrect node tree. "+V)||this}return o($,F),$})(s);r.HierarchyRequestError=L;var P=(function(F){function $(V){return V===void 0&&(V=""),F.call(this,"NotFoundError","The object can not be found here. "+V)||this}return o($,F),$})(s);r.NotFoundError=P;var B=(function(F){function $(V){return V===void 0&&(V=""),F.call(this,"IndexSizeError","The index is not in the allowed range. "+V)||this}return o($,F),$})(s);r.IndexSizeError=B;var U=(function(F){function $(V){return V===void 0&&(V=""),F.call(this,"SyntaxError","The string did not match the expected pattern. "+V)||this}return o($,F),$})(s);r.SyntaxError=U;var G=(function(F){function $(V){return V===void 0&&(V=""),F.call(this,"InvalidCharacterError","The string contains invalid characters. "+V)||this}return o($,F),$})(s);r.InvalidCharacterError=G},function(n,r,i){var a=i(53),o=["kind","resolve","construct","instanceOf","predicate","represent","defaultStyle","styleAliases"],s=["scalar","sequence","mapping"];n.exports=function(l,c){var f,u;if(c=c||{},Object.keys(c).forEach((function(d){if(o.indexOf(d)===-1)throw new a('Unknown option "'+d+'" is met in definition of "'+l+'" YAML type.')})),this.tag=l,this.kind=c.kind||null,this.resolve=c.resolve||function(){return!0},this.construct=c.construct||function(d){return d},this.instanceOf=c.instanceOf||null,this.predicate=c.predicate||null,this.represent=c.represent||null,this.defaultStyle=c.defaultStyle||null,this.styleAliases=(f=c.styleAliases||null,u={},f!==null&&Object.keys(f).forEach((function(d){f[d].forEach((function(h){u[String(h)]=d}))})),u),s.indexOf(this.kind)===-1)throw new a('Unknown kind "'+this.kind+'" is specified for "'+l+'" YAML type.')}},function(n,r,i){(function(a){var o=function(s){return s&&s.Math==Math&&s};n.exports=o(typeof globalThis=="object"&&globalThis)||o(typeof window=="object"&&window)||o(typeof self=="object"&&self)||o(typeof a=="object"&&a)||Function("return this")()}).call(this,i(78))},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.idl_defineConst=function(a,o,s){Object.defineProperty(a,o,{writable:!1,enumerable:!0,configurable:!1,value:s})}},function(n,r){n.exports=function(i){return typeof i=="object"?i!==null:typeof i=="function"}},function(n,r){var i={}.hasOwnProperty;n.exports=function(a,o){return i.call(a,o)}},function(n,r,i){var a=i(16),o=i(115),s=i(18),l=i(56),c=Object.defineProperty;r.f=a?c:function(f,u,d){if(s(f),u=l(u,!0),s(d),o)try{return c(f,u,d)}catch{}if("get"in d||"set"in d)throw TypeError("Accessors not supported");return"value"in d&&(f[u]=d.value),f}},function(n,r,i){var a=i(8);n.exports=!a((function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}))},function(n,r,i){var a=this&&this.__values||function(x){var w=typeof Symbol=="function"&&Symbol.iterator,S=w&&x[w],T=0;if(S)return S.call(x);if(x&&typeof x.length=="number")return{next:function(){return x&&T>=x.length&&(x=void 0),{value:x&&x[T++],done:!x}}};throw new TypeError(w?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var o=i(3),s=i(2);function l(x,w,S){if(S===void 0&&(S=!1),S&&o.Guard.isElementNode(w)&&o.Guard.isShadowRoot(w.shadowRoot)&&w.shadowRoot._firstChild)return w.shadowRoot._firstChild;if(w._firstChild)return w._firstChild;if(w===x)return null;if(w._nextSibling)return w._nextSibling;for(var T=w._parent;T&&T!==x;){if(T._nextSibling)return T._nextSibling;T=T._parent}return null}function c(){var x;return(x={})[Symbol.iterator]=function(){return{next:function(){return{done:!0,value:null}}}},x}function f(x,w,S,T){w===void 0&&(w=!1),S===void 0&&(S=!1);for(var _=w?x:l(x,x,S);_&&T&&!T(_);)_=l(x,_,S);return _}function u(x,w,S,T,_){T===void 0&&(T=!1);for(var D=l(x,w,T);D&&_&&!_(D);)D=l(x,D,T);return D}function d(x,w,S,T){var _;return w===void 0&&(w=!1),S===void 0&&(S=!1),w||x._children.size!==0?((_={})[Symbol.iterator]=function(){var D=w?x:l(x,x,S);return{next:function(){for(;D&&T&&!T(D);)D=l(x,D,S);if(D===null)return{done:!0,value:null};var I={done:!1,value:D};return D=l(x,D,S),I}}},_):c()}function h(x,w,S){w===void 0&&(w=!1);for(var T=w?x:x._parent;T&&S&&!S(T);)T=T._parent;return T}function p(x,w,S,T){for(var _=w._parent;_&&T&&!T(_);)_=_._parent;return _}function g(x){return o.Guard.isDocumentTypeNode(x)?0:o.Guard.isCharacterDataNode(x)?x._data.length:x._children.size}function m(x,w){if(w===void 0&&(w=!1),w){var S=m(x,!1);return o.Guard.isShadowRoot(S)?m(S._host,!0):S}return x._parent?m(x._parent):x}function y(x,w,S,T){S===void 0&&(S=!1),T===void 0&&(T=!1);for(var _=S?x:T&&o.Guard.isShadowRoot(x)?x._host:x._parent;_!==null;){if(_===w)return!0;_=T&&o.Guard.isShadowRoot(_)?_._host:_._parent}return!1}function v(x){for(var w=m(x),S=0,T=f(w);T!==null;){if(S++,T===x)return S;T=u(w,T)}return-1}r.tree_getFirstDescendantNode=f,r.tree_getNextDescendantNode=u,r.tree_getDescendantNodes=d,r.tree_getDescendantElements=function(x,w,S,T){var _;return w===void 0&&(w=!1),S===void 0&&(S=!1),w||x._children.size!==0?((_={})[Symbol.iterator]=function(){var D=d(x,w,S,(function(R){return o.Guard.isElementNode(R)}))[Symbol.iterator](),I=D.next().value;return{next:function(){for(;I&&T&&!T(I);)I=D.next().value;if(I===null)return{done:!0,value:null};var R={done:!1,value:I};return I=D.next().value,R}}},_):c()},r.tree_getSiblingNodes=function(x,w,S){var T;return w===void 0&&(w=!1),x._parent&&x._parent._children.size!==0?((T={})[Symbol.iterator]=function(){var _=x._parent?x._parent._firstChild:null;return{next:function(){for(;_&&(S&&!S(_)||!w&&_===x);)_=_._nextSibling;if(_===null)return{done:!0,value:null};var D={done:!1,value:_};return _=_._nextSibling,D}}},T):c()},r.tree_getFirstAncestorNode=h,r.tree_getNextAncestorNode=p,r.tree_getAncestorNodes=function(x,w,S){var T;return w===void 0&&(w=!1),w||x._parent?((T={})[Symbol.iterator]=function(){var _=h(x,w,S);return{next:function(){if(_===null)return{done:!0,value:null};var D={done:!1,value:_};return _=p(0,_,w,S),D}}},T):c()},r.tree_getCommonAncestor=function(x,w){if(x===w)return x._parent;for(var S=[],T=[],_=h(x,!0);_!==null;)S.push(_),_=p(0,_);for(var D=h(w,!0);D!==null;)T.push(D),D=p(0,D);for(var I=S.length,R=T.length,M=null,A=Math.min(I,R);A>0;A--){var L=S[--I];if(L!==T[--R])break;M=L}return M},r.tree_getFollowingNode=function(x,w){if(w._firstChild)return w._firstChild;if(w._nextSibling)return w._nextSibling;for(;;){var S=w._parent;if(S===null||S===x)return null;if(S._nextSibling)return S._nextSibling;w=S}},r.tree_getPrecedingNode=function(x,w){return w===x?null:w._previousSibling?(w=w._previousSibling)._lastChild?w._lastChild:w:w._parent},r.tree_isConstrained=function x(w){var S,T,_,D,I,R;switch(w._nodeType){case s.NodeType.Document:var M=!1,A=!1;try{for(var L=a(w._children),P=L.next();!P.done;P=L.next())switch(P.value._nodeType){case s.NodeType.ProcessingInstruction:case s.NodeType.Comment:break;case s.NodeType.DocumentType:if(M||A)return!1;M=!0;break;case s.NodeType.Element:if(A)return!1;A=!0;break;default:return!1}}catch($){S={error:$}}finally{try{P&&!P.done&&(T=L.return)&&T.call(L)}finally{if(S)throw S.error}}break;case s.NodeType.DocumentFragment:case s.NodeType.Element:try{for(var B=a(w._children),U=B.next();!U.done;U=B.next())switch(U.value._nodeType){case s.NodeType.Element:case s.NodeType.Text:case s.NodeType.ProcessingInstruction:case s.NodeType.CData:case s.NodeType.Comment:break;default:return!1}}catch($){_={error:$}}finally{try{U&&!U.done&&(D=B.return)&&D.call(B)}finally{if(_)throw _.error}}break;case s.NodeType.DocumentType:case s.NodeType.Text:case s.NodeType.ProcessingInstruction:case s.NodeType.CData:case s.NodeType.Comment:return!w.hasChildNodes()}try{for(var G=a(w._children),F=G.next();!F.done;F=G.next())if(!x(F.value))return!1}catch($){I={error:$}}finally{try{F&&!F.done&&(R=G.return)&&R.call(G)}finally{if(I)throw I.error}}return!0},r.tree_nodeLength=g,r.tree_isEmpty=function(x){return g(x)===0},r.tree_rootNode=m,r.tree_isDescendantOf=function(x,w,S,T){S===void 0&&(S=!1),T===void 0&&(T=!1);for(var _=f(x,S,T);_!==null;){if(_===w)return!0;_=u(x,_,S,T)}return!1},r.tree_isAncestorOf=y,r.tree_isHostIncludingAncestorOf=function x(w,S,T){if(T===void 0&&(T=!1),y(w,S,T))return!0;var _=m(w);return!(!o.Guard.isDocumentFragmentNode(_)||_._host===null||!x(_._host,S,T))},r.tree_isSiblingOf=function(x,w,S){return S===void 0&&(S=!1),x!==w?x._parent!==null&&x._parent===w._parent:!!S},r.tree_isPreceding=function(x,w){var S=v(x),T=v(w);return S!==-1&&T!==-1&&m(x)===m(w)&&T<S},r.tree_isFollowing=function(x,w){var S=v(x),T=v(w);return S!==-1&&T!==-1&&m(x)===m(w)&&T>S},r.tree_isParentOf=function(x,w){return x._parent===w},r.tree_isChildOf=function(x,w){return w._parent===x},r.tree_previousSibling=function(x){return x._previousSibling},r.tree_nextSibling=function(x){return x._nextSibling},r.tree_firstChild=function(x){return x._firstChild},r.tree_lastChild=function(x){return x._lastChild},r.tree_treePosition=v,r.tree_index=function(x){for(var w=0;x._previousSibling!==null;)w++,x=x._previousSibling;return w},r.tree_retarget=function(x,w){for(;;){if(!x||!o.Guard.isNode(x))return x;var S=m(x);if(!o.Guard.isShadowRoot(S)||w&&o.Guard.isNode(w)&&y(S,w,!0,!0))return x;x=S.host}}},function(n,r,i){var a=i(13);n.exports=function(o){if(!a(o))throw TypeError(String(o)+" is not an object");return o}},function(n,r,i){var a=i(24),o=i(130),s=i(49),l=i(43),c=i(88),f=l.set,u=l.getterFor("Array Iterator");n.exports=c(Array,"Array",(function(d,h){f(this,{type:"Array Iterator",target:a(d),index:0,kind:h})}),(function(){var d=u(this),h=d.target,p=d.kind,g=d.index++;return!h||g>=h.length?(d.target=void 0,{value:void 0,done:!0}):p=="keys"?{value:g,done:!1}:p=="values"?{value:h[g],done:!1}:{value:[g,h[g]],done:!1}}),"values"),s.Arguments=s.Array,o("keys"),o("values"),o("entries")},function(n,r,i){var a=i(90),o=i(25),s=i(202);a||o(Object.prototype,"toString",s,{unsafe:!0})},function(n,r,i){var a=i(16),o=i(15),s=i(40);n.exports=a?function(l,c,f){return o.f(l,c,s(1,f))}:function(l,c,f){return l[c]=f,l}},function(n,r,i){var a=i(137).charAt,o=i(43),s=i(88),l=o.set,c=o.getterFor("String Iterator");s(String,"String",(function(f){l(this,{type:"String Iterator",string:String(f),index:0})}),(function(){var f,u=c(this),d=u.string,h=u.index;return h>=d.length?{value:void 0,done:!0}:(f=a(d,h),u.index+=f.length,{value:f,done:!1})}))},function(n,r,i){var a=i(11),o=i(203),s=i(19),l=i(21),c=i(5),f=c("iterator"),u=c("toStringTag"),d=s.values;for(var h in o){var p=a[h],g=p&&p.prototype;if(g){if(g[f]!==d)try{l(g,f,d)}catch{g[f]=d}if(g[u]||l(g,u,h),o[h]){for(var m in s)if(g[m]!==s[m])try{l(g,m,s[m])}catch{g[m]=s[m]}}}}},function(n,r,i){var a=i(41),o=i(35);n.exports=function(s){return a(o(s))}},function(n,r,i){var a=i(11),o=i(21),s=i(14),l=i(80),c=i(117),f=i(43),u=f.get,d=f.enforce,h=String(String).split("String");(n.exports=function(p,g,m,y){var v=!!y&&!!y.unsafe,x=!!y&&!!y.enumerable,w=!!y&&!!y.noTargetGet;typeof m=="function"&&(typeof g!="string"||s(m,"name")||o(m,"name",g),d(m).source=h.join(typeof g=="string"?g:"")),p!==a?(v?!w&&p[g]&&(x=!0):delete p[g],x?p[g]=m:o(p,g,m)):x?p[g]=m:l(g,m)})(Function.prototype,"toString",(function(){return typeof this=="function"&&u(this).source||c(this)}))},function(n,r,i){var a=i(47),o=Math.min;n.exports=function(s){return s>0?o(a(s),9007199254740991):0}},function(n,r,i){var a=i(35);n.exports=function(o){return Object(a(o))}},function(n,r,i){var a=i(16),o=i(8),s=i(14),l=Object.defineProperty,c={},f=function(u){throw u};n.exports=function(u,d){if(s(c,u))return c[u];d||(d={});var h=[][u],p=!!s(d,"ACCESSORS")&&d.ACCESSORS,g=s(d,0)?d[0]:f,m=s(d,1)?d[1]:void 0;return c[u]=!!h&&!o((function(){if(p&&!a)return!0;var y={length:-1};p?l(y,1,{enumerable:!0,get:f}):y[1]=1,h.call(y,g,m)}))}},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(148),o=i(149),s=i(151),l=i(98),c=i(153),f=i(154),u=i(155),d=i(99),h=i(100),p=i(156),g=i(157),m=i(101),y=i(158),v=i(159),x=i(160),w=i(161),S=i(162),T=i(163),_=i(164),D=i(165),I=i(166),R=i(167),M=i(168),A=i(169),L=i(170);r.create_domImplementation=function(P){return a.DOMImplementationImpl._create(P)},r.create_window=function(){return o.WindowImpl._create()},r.create_xmlDocument=function(){return new s.XMLDocumentImpl},r.create_document=function(){return new l.DocumentImpl},r.create_abortController=function(){return new c.AbortControllerImpl},r.create_abortSignal=function(){return f.AbortSignalImpl._create()},r.create_documentType=function(P,B,U,G){return u.DocumentTypeImpl._create(P,B,U,G)},r.create_element=function(P,B,U,G){return d.ElementImpl._create(P,B,U,G)},r.create_htmlElement=function(P,B,U,G){return d.ElementImpl._create(P,B,U,G)},r.create_htmlUnknownElement=function(P,B,U,G){return d.ElementImpl._create(P,B,U,G)},r.create_documentFragment=function(P){return h.DocumentFragmentImpl._create(P)},r.create_shadowRoot=function(P,B){return p.ShadowRootImpl._create(P,B)},r.create_attr=function(P,B){return g.AttrImpl._create(P,B)},r.create_text=function(P,B){return m.TextImpl._create(P,B)},r.create_cdataSection=function(P,B){return y.CDATASectionImpl._create(P,B)},r.create_comment=function(P,B){return v.CommentImpl._create(P,B)},r.create_processingInstruction=function(P,B,U){return x.ProcessingInstructionImpl._create(P,B,U)},r.create_htmlCollection=function(P,B){return B===void 0&&(B=function(){return!0}),w.HTMLCollectionImpl._create(P,B)},r.create_nodeList=function(P){return S.NodeListImpl._create(P)},r.create_nodeListStatic=function(P,B){return T.NodeListStaticImpl._create(P,B)},r.create_namedNodeMap=function(P){return _.NamedNodeMapImpl._create(P)},r.create_range=function(P,B){return D.RangeImpl._create(P,B)},r.create_nodeIterator=function(P,B,U){return I.NodeIteratorImpl._create(P,B,U)},r.create_treeWalker=function(P,B){return R.TreeWalkerImpl._create(P,B)},r.create_nodeFilter=function(){return M.NodeFilterImpl._create()},r.create_mutationRecord=function(P,B,U,G,F,$,V,X,Q){return A.MutationRecordImpl._create(P,B,U,G,F,$,V,X,Q)},r.create_domTokenList=function(P,B){return L.DOMTokenListImpl._create(P,B)}},function(n,r,i){var a=this&&this.__values||function(g){var m=typeof Symbol=="function"&&Symbol.iterator,y=m&&g[m],v=0;if(y)return y.call(g);if(g&&typeof g.length=="number")return{next:function(){return g&&v>=g.length&&(g=void 0),{value:g&&g[v++],done:!g}}};throw new TypeError(m?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var o=i(6),s=i(17),l=i(3),c=i(72),f=new Map;function u(g,m){if(m!==g._root&&s.tree_isAncestorOf(g._reference,m,!0)){if(g._pointerBeforeReference)for(;;){var y=s.tree_getFollowingNode(g._root,m);if(y!==null&&s.tree_isDescendantOf(g._root,y,!0)&&!s.tree_isDescendantOf(m,y,!0))return void(g._reference=y);if(y===null)return void(g._pointerBeforeReference=!1)}if(m._previousSibling===null)m._parent!==null&&(g._reference=m._parent);else{for(var v=m._previousSibling,x=s.tree_getFirstDescendantNode(m._previousSibling,!0,!1);x!==null;)x!==null&&(v=x),x=s.tree_getNextDescendantNode(m._previousSibling,x,!0,!1);g._reference=v}}}function d(g,m,y,v,x){if(l.Guard.isSlot(g)&&m==="name"&&x===null){if(v===y||v===null&&y===""||v===""&&y===null)return;g._name=v===null||v===""?"":v,c.shadowTree_assignSlotablesForATree(s.tree_rootNode(g))}}function h(g,m,y,v,x){if(l.Guard.isSlotable(g)&&m==="slot"&&x===null){if(v===y||v===null&&y===""||v===""&&y===null)return;g._name=v===null||v===""?"":v,c.shadowTree_isAssigned(g)&&c.shadowTree_assignSlotables(g._assignedSlot),c.shadowTree_assignASlot(g)}}function p(g,m,y,v){m==="id"&&v===null&&(g._uniqueIdentifier=y||void 0)}r.dom_runRemovingSteps=function(g,m){},r.dom_runCloningSteps=function(g,m,y,v){},r.dom_runAdoptingSteps=function(g,m){},r.dom_runAttributeChangeSteps=function(g,m,y,v,x){var w,S;o.dom.features.slots&&(h.call(g,g,m,y,v,x),d.call(g,g,m,y,v,x)),p.call(g,g,m,v,x);try{for(var T=a(g._attributeChangeSteps),_=T.next();!_.done;_=T.next())_.value.call(g,g,m,y,v,x)}catch(D){w={error:D}}finally{try{_&&!_.done&&(S=T.return)&&S.call(T)}finally{if(w)throw w.error}}},r.dom_runInsertionSteps=function(g){},r.dom_runNodeIteratorPreRemovingSteps=function(g,m){u.call(g,g,m)},r.dom_hasSupportedTokens=function(g){return f.has(g)},r.dom_getSupportedTokens=function(g){return f.get(g)||new Set},r.dom_runEventConstructingSteps=function(g){},r.dom_runChildTextContentChangeSteps=function(g){}},function(n,r,i){var a=i(4),o=i(11),s=i(46),l=i(44),c=i(16),f=i(86),u=i(124),d=i(8),h=i(14),p=i(59),g=i(13),m=i(18),y=i(27),v=i(24),x=i(56),w=i(40),S=i(60),T=i(61),_=i(82),D=i(190),I=i(85),R=i(55),M=i(15),A=i(79),L=i(21),P=i(25),B=i(81),U=i(57),G=i(45),F=i(58),$=i(5),V=i(125),X=i(126),Q=i(62),re=i(43),ye=i(36).forEach,me=U("hidden"),Ce=$("toPrimitive"),we=re.set,Ae=re.getterFor("Symbol"),De=Object.prototype,q=o.Symbol,k=s("JSON","stringify"),J=R.f,Y=M.f,ie=D.f,ue=A.f,fe=B("symbols"),Se=B("op-symbols"),Fe=B("string-to-symbol-registry"),Ke=B("symbol-to-string-registry"),He=B("wks"),pe=o.QObject,ge=!pe||!pe.prototype||!pe.prototype.findChild,Ie=c&&d((function(){return S(Y({},"a",{get:function(){return Y(this,"a",{value:7}).a}})).a!=7}))?function(ze,st,Qe){var _t=J(De,st);_t&&delete De[st],Y(ze,st,Qe),_t&&ze!==De&&Y(De,st,_t)}:Y,ve=function(ze,st){var Qe=fe[ze]=S(q.prototype);return we(Qe,{type:"Symbol",tag:ze,description:st}),c||(Qe.description=st),Qe},_e=u?function(ze){return typeof ze=="symbol"}:function(ze){return Object(ze)instanceof q},Pe=function(ze,st,Qe){ze===De&&Pe(Se,st,Qe),m(ze);var _t=x(st,!0);return m(Qe),h(fe,_t)?(Qe.enumerable?(h(ze,me)&&ze[me][_t]&&(ze[me][_t]=!1),Qe=S(Qe,{enumerable:w(0,!1)})):(h(ze,me)||Y(ze,me,w(1,{})),ze[me][_t]=!0),Ie(ze,_t,Qe)):Y(ze,_t,Qe)},ne=function(ze,st){m(ze);var Qe=v(st),_t=T(Qe).concat(Re(Qe));return ye(_t,(function(Le){c&&!Je.call(Qe,Le)||Pe(ze,Le,Qe[Le])})),ze},Je=function(ze){var st=x(ze,!0),Qe=ue.call(this,st);return!(this===De&&h(fe,st)&&!h(Se,st))&&(!(Qe||!h(this,st)||!h(fe,st)||h(this,me)&&this[me][st])||Qe)},$e=function(ze,st){var Qe=v(ze),_t=x(st,!0);if(Qe!==De||!h(fe,_t)||h(Se,_t)){var Le=J(Qe,_t);return!Le||!h(fe,_t)||h(Qe,me)&&Qe[me][_t]||(Le.enumerable=!0),Le}},ke=function(ze){var st=ie(v(ze)),Qe=[];return ye(st,(function(_t){h(fe,_t)||h(G,_t)||Qe.push(_t)})),Qe},Re=function(ze){var st=ze===De,Qe=ie(st?Se:v(ze)),_t=[];return ye(Qe,(function(Le){!h(fe,Le)||st&&!h(De,Le)||_t.push(fe[Le])})),_t};f||(P((q=function(){if(this instanceof q)throw TypeError("Symbol is not a constructor");var ze=arguments.length&&arguments[0]!==void 0?String(arguments[0]):void 0,st=F(ze),Qe=function(_t){this===De&&Qe.call(Se,_t),h(this,me)&&h(this[me],st)&&(this[me][st]=!1),Ie(this,st,w(1,_t))};return c&&ge&&Ie(De,st,{configurable:!0,set:Qe}),ve(st,ze)}).prototype,"toString",(function(){return Ae(this).tag})),P(q,"withoutSetter",(function(ze){return ve(F(ze),ze)})),A.f=Je,M.f=Pe,R.f=$e,_.f=D.f=ke,I.f=Re,V.f=function(ze){return ve($(ze),ze)},c&&(Y(q.prototype,"description",{configurable:!0,get:function(){return Ae(this).description}}),l||P(De,"propertyIsEnumerable",Je,{unsafe:!0}))),a({global:!0,wrap:!0,forced:!f,sham:!f},{Symbol:q}),ye(T(He),(function(ze){X(ze)})),a({target:"Symbol",stat:!0,forced:!f},{for:function(ze){var st=String(ze);if(h(Fe,st))return Fe[st];var Qe=q(st);return Fe[st]=Qe,Ke[Qe]=st,Qe},keyFor:function(ze){if(!_e(ze))throw TypeError(ze+" is not a symbol");if(h(Ke,ze))return Ke[ze]},useSetter:function(){ge=!0},useSimple:function(){ge=!1}}),a({target:"Object",stat:!0,forced:!f,sham:!c},{create:function(ze,st){return st===void 0?S(ze):ne(S(ze),st)},defineProperty:Pe,defineProperties:ne,getOwnPropertyDescriptor:$e}),a({target:"Object",stat:!0,forced:!f},{getOwnPropertyNames:ke,getOwnPropertySymbols:Re}),a({target:"Object",stat:!0,forced:d((function(){I.f(1)}))},{getOwnPropertySymbols:function(ze){return I.f(y(ze))}}),k&&a({target:"JSON",stat:!0,forced:!f||d((function(){var ze=q();return k([ze])!="[null]"||k({a:ze})!="{}"||k(Object(ze))!="{}"}))},{stringify:function(ze,st,Qe){for(var _t,Le=[ze],We=1;arguments.length>We;)Le.push(arguments[We++]);if(_t=st,(g(st)||ze!==void 0)&&!_e(ze))return p(st)||(st=function(xt,Ut){if(typeof _t=="function"&&(Ut=_t.call(this,xt,Ut)),!_e(Ut))return Ut}),Le[1]=st,k.apply(null,Le)}}),q.prototype[Ce]||L(q.prototype,Ce,q.prototype.valueOf),Q(q,"Symbol"),G[me]=!0},function(n,r,i){var a=i(4),o=i(16),s=i(11),l=i(14),c=i(13),f=i(15).f,u=i(119),d=s.Symbol;if(o&&typeof d=="function"&&(!("description"in d.prototype)||d().description!==void 0)){var h={},p=function(){var x=arguments.length<1||arguments[0]===void 0?void 0:String(arguments[0]),w=this instanceof p?new d(x):x===void 0?d():d(x);return x===""&&(h[w]=!0),w};u(p,d);var g=p.prototype=d.prototype;g.constructor=p;var m=g.toString,y=String(d("test"))=="Symbol(test)",v=/^Symbol\((.*)\)[^)]+$/;f(g,"description",{configurable:!0,get:function(){var x=c(this)?this.valueOf():this,w=m.call(x);if(l(h,x))return"";var S=y?w.slice(7,-1):w.replace(v,"$1");return S===""?void 0:S}}),a({global:!0,forced:!0},{Symbol:p})}},function(n,r,i){i(126)("iterator")},function(n,r,i){var a,o=this&&this.__extends||(a=function(y,v){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,w){x.__proto__=w}||function(x,w){for(var S in w)w.hasOwnProperty(S)&&(x[S]=w[S])})(y,v)},function(y,v){function x(){this.constructor=y}a(y,v),y.prototype=v===null?Object.create(v):(x.prototype=v.prototype,new x)}),s=this&&this.__values||function(y){var v=typeof Symbol=="function"&&Symbol.iterator,x=v&&y[v],w=0;if(x)return x.call(y);if(y&&typeof y.length=="number")return{next:function(){return y&&w>=y.length&&(y=void 0),{value:y&&y[w++],done:!y}}};throw new TypeError(v?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var l=i(6),c=i(2),f=i(70),u=i(3),d=i(9),h=i(0),p=i(152),g=i(12),m=(function(y){function v(){var x=y.call(this)||this;return x._parent=null,x._firstChild=null,x._lastChild=null,x._previousSibling=null,x._nextSibling=null,x}return o(v,y),Object.defineProperty(v.prototype,"_childNodes",{get:function(){return this.__childNodes||(this.__childNodes=h.create_nodeList(this))},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"_nodeDocument",{get:function(){return this._nodeDocumentOverride||l.dom.window._associatedDocument},set:function(x){this._nodeDocumentOverride=x},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"_registeredObserverList",{get:function(){return this.__registeredObserverList||(this.__registeredObserverList=[])},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"nodeType",{get:function(){return this._nodeType},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"nodeName",{get:function(){return u.Guard.isElementNode(this)?this._htmlUppercasedQualifiedName:u.Guard.isAttrNode(this)?this._qualifiedName:u.Guard.isExclusiveTextNode(this)?"#text":u.Guard.isCDATASectionNode(this)?"#cdata-section":u.Guard.isProcessingInstructionNode(this)?this._target:u.Guard.isCommentNode(this)?"#comment":u.Guard.isDocumentNode(this)?"#document":u.Guard.isDocumentTypeNode(this)?this._name:u.Guard.isDocumentFragmentNode(this)?"#document-fragment":""},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"baseURI",{get:function(){return p.urlSerializer(this._nodeDocument._URL)},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"isConnected",{get:function(){return u.Guard.isElementNode(this)&&h.shadowTree_isConnected(this)},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"ownerDocument",{get:function(){return this._nodeType===c.NodeType.Document?null:this._nodeDocument},enumerable:!0,configurable:!0}),v.prototype.getRootNode=function(x){return h.tree_rootNode(this,!!x&&x.composed)},Object.defineProperty(v.prototype,"parentNode",{get:function(){return this._nodeType===c.NodeType.Attribute?null:this._parent},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"parentElement",{get:function(){return this._parent&&u.Guard.isElementNode(this._parent)?this._parent:null},enumerable:!0,configurable:!0}),v.prototype.hasChildNodes=function(){return this._firstChild!==null},Object.defineProperty(v.prototype,"childNodes",{get:function(){return this._childNodes},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"firstChild",{get:function(){return this._firstChild},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"lastChild",{get:function(){return this._lastChild},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"previousSibling",{get:function(){return this._previousSibling},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"nextSibling",{get:function(){return this._nextSibling},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"nodeValue",{get:function(){return u.Guard.isAttrNode(this)?this._value:u.Guard.isCharacterDataNode(this)?this._data:null},set:function(x){x===null&&(x=""),u.Guard.isAttrNode(this)?h.attr_setAnExistingAttributeValue(this,x):u.Guard.isCharacterDataNode(this)&&h.characterData_replaceData(this,0,this._data.length,x)},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"textContent",{get:function(){return u.Guard.isDocumentFragmentNode(this)||u.Guard.isElementNode(this)?h.text_descendantTextContent(this):u.Guard.isAttrNode(this)?this._value:u.Guard.isCharacterDataNode(this)?this._data:null},set:function(x){x===null&&(x=""),u.Guard.isDocumentFragmentNode(this)||u.Guard.isElementNode(this)?h.node_stringReplaceAll(x,this):u.Guard.isAttrNode(this)?h.attr_setAnExistingAttributeValue(this,x):u.Guard.isCharacterDataNode(this)&&h.characterData_replaceData(this,0,h.tree_nodeLength(this),x)},enumerable:!0,configurable:!0}),v.prototype.normalize=function(){for(var x,w,S,T,_=[],D=h.tree_getFirstDescendantNode(this,!1,!1,(function(ye){return u.Guard.isExclusiveTextNode(ye)}));D!==null;)_.push(D),D=h.tree_getNextDescendantNode(this,D,!1,!1,(function(ye){return u.Guard.isExclusiveTextNode(ye)}));for(var I=0;I<_.length;I++){var R=_[I];if(R._parent!==null){var M=h.tree_nodeLength(R);if(M!==0){var A=[],L="";try{for(var P=(x=void 0,s(h.text_contiguousExclusiveTextNodes(R))),B=P.next();!B.done;B=P.next()){var U=B.value;A.push(U),L+=U._data}}catch(ye){x={error:ye}}finally{try{B&&!B.done&&(w=P.return)&&w.call(P)}finally{if(x)throw x.error}}if(h.characterData_replaceData(R,M,0,L),l.dom.rangeList.size!==0)for(var G=R._nextSibling;G!==null&&u.Guard.isExclusiveTextNode(G);){var F=G,$=h.tree_index(F);try{for(var V=(S=void 0,s(l.dom.rangeList)),X=V.next();!X.done;X=V.next()){var Q=X.value;Q._start[0]===F&&(Q._start[0]=R,Q._start[1]+=M),Q._end[0]===F&&(Q._end[0]=R,Q._end[1]+=M),Q._start[0]===F._parent&&Q._start[1]===$&&(Q._start[0]=R,Q._start[1]=M),Q._end[0]===F._parent&&Q._end[1]===$&&(Q._end[0]=R,Q._end[1]=M)}}catch(ye){S={error:ye}}finally{try{X&&!X.done&&(T=V.return)&&T.call(V)}finally{if(S)throw S.error}}M+=h.tree_nodeLength(G),G=G._nextSibling}for(var re=0;re<A.length;re++)(U=A[re])._parent!==null&&h.mutation_remove(U,U._parent)}else h.mutation_remove(R,R._parent)}}},v.prototype.cloneNode=function(x){if(x===void 0&&(x=!1),u.Guard.isShadowRoot(this))throw new d.NotSupportedError;return h.node_clone(this,null,x)},v.prototype.isEqualNode=function(x){return x===void 0&&(x=null),x!==null&&h.node_equals(this,x)},v.prototype.isSameNode=function(x){return x===void 0&&(x=null),this===x},v.prototype.compareDocumentPosition=function(x){if(x===this)return 0;var w=x,S=this,T=null,_=null;if(u.Guard.isAttrNode(w)&&(w=(T=w)._element),u.Guard.isAttrNode(S)&&(S=(_=S)._element,T&&w&&w===S))for(var D=0;D<S._attributeList.length;D++){var I=S._attributeList[D];if(h.node_equals(I,T))return c.Position.ImplementationSpecific|c.Position.Preceding;if(h.node_equals(I,_))return c.Position.ImplementationSpecific|c.Position.Following}return w===null||S===null||h.tree_rootNode(w)!==h.tree_rootNode(S)?c.Position.Disconnected|c.Position.ImplementationSpecific|(l.dom.compareCache.check(this,x)?c.Position.Preceding:c.Position.Following):!T&&h.tree_isAncestorOf(S,w)||_&&w===S?c.Position.Contains|c.Position.Preceding:!_&&h.tree_isDescendantOf(S,w)||T&&w===S?c.Position.ContainedBy|c.Position.Following:h.tree_isPreceding(S,w)?c.Position.Preceding:c.Position.Following},v.prototype.contains=function(x){return x!==null&&h.tree_isDescendantOf(this,x,!0)},v.prototype.lookupPrefix=function(x){return x?u.Guard.isElementNode(this)?h.node_locateANamespacePrefix(this,x):u.Guard.isDocumentNode(this)?this.documentElement===null?null:h.node_locateANamespacePrefix(this.documentElement,x):u.Guard.isDocumentTypeNode(this)||u.Guard.isDocumentFragmentNode(this)?null:u.Guard.isAttrNode(this)?this._element===null?null:h.node_locateANamespacePrefix(this._element,x):this._parent!==null&&u.Guard.isElementNode(this._parent)?h.node_locateANamespacePrefix(this._parent,x):null:null},v.prototype.lookupNamespaceURI=function(x){return h.node_locateANamespace(this,x||null)},v.prototype.isDefaultNamespace=function(x){return x||(x=null),h.node_locateANamespace(this,null)===x},v.prototype.insertBefore=function(x,w){return h.mutation_preInsert(x,this,w)},v.prototype.appendChild=function(x){return h.mutation_append(x,this)},v.prototype.replaceChild=function(x,w){return h.mutation_replace(w,x,this)},v.prototype.removeChild=function(x){return h.mutation_preRemove(x,this)},v.prototype._getTheParent=function(x){return u.Guard.isSlotable(this)&&h.shadowTree_isAssigned(this)?this._assignedSlot:this._parent},v.ELEMENT_NODE=1,v.ATTRIBUTE_NODE=2,v.TEXT_NODE=3,v.CDATA_SECTION_NODE=4,v.ENTITY_REFERENCE_NODE=5,v.ENTITY_NODE=6,v.PROCESSING_INSTRUCTION_NODE=7,v.COMMENT_NODE=8,v.DOCUMENT_NODE=9,v.DOCUMENT_TYPE_NODE=10,v.DOCUMENT_FRAGMENT_NODE=11,v.NOTATION_NODE=12,v.DOCUMENT_POSITION_DISCONNECTED=1,v.DOCUMENT_POSITION_PRECEDING=2,v.DOCUMENT_POSITION_FOLLOWING=4,v.DOCUMENT_POSITION_CONTAINS=8,v.DOCUMENT_POSITION_CONTAINED_BY=16,v.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC=32,v})(f.EventTargetImpl);r.NodeImpl=m,m.prototype._children=new u.EmptySet,g.idl_defineConst(m.prototype,"ELEMENT_NODE",1),g.idl_defineConst(m.prototype,"ATTRIBUTE_NODE",2),g.idl_defineConst(m.prototype,"TEXT_NODE",3),g.idl_defineConst(m.prototype,"CDATA_SECTION_NODE",4),g.idl_defineConst(m.prototype,"ENTITY_REFERENCE_NODE",5),g.idl_defineConst(m.prototype,"ENTITY_NODE",6),g.idl_defineConst(m.prototype,"PROCESSING_INSTRUCTION_NODE",7),g.idl_defineConst(m.prototype,"COMMENT_NODE",8),g.idl_defineConst(m.prototype,"DOCUMENT_NODE",9),g.idl_defineConst(m.prototype,"DOCUMENT_TYPE_NODE",10),g.idl_defineConst(m.prototype,"DOCUMENT_FRAGMENT_NODE",11),g.idl_defineConst(m.prototype,"NOTATION_NODE",12),g.idl_defineConst(m.prototype,"DOCUMENT_POSITION_DISCONNECTED",1),g.idl_defineConst(m.prototype,"DOCUMENT_POSITION_PRECEDING",2),g.idl_defineConst(m.prototype,"DOCUMENT_POSITION_FOLLOWING",4),g.idl_defineConst(m.prototype,"DOCUMENT_POSITION_CONTAINS",8),g.idl_defineConst(m.prototype,"DOCUMENT_POSITION_CONTAINED_BY",16),g.idl_defineConst(m.prototype,"DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC",32)},function(n,r){n.exports=function(i){if(i==null)throw TypeError("Can't call method on "+i);return i}},function(n,r,i){var a=i(87),o=i(41),s=i(27),l=i(26),c=i(128),f=[].push,u=function(d){var h=d==1,p=d==2,g=d==3,m=d==4,y=d==6,v=d==5||y;return function(x,w,S,T){for(var _,D,I=s(x),R=o(I),M=a(w,S,3),A=l(R.length),L=0,P=T||c,B=h?P(x,A):p?P(x,0):void 0;A>L;L++)if((v||L in R)&&(D=M(_=R[L],L,I),d)){if(h)B[L]=D;else if(D)switch(d){case 3:return!0;case 5:return _;case 6:return L;case 2:f.call(B,_)}else if(m)return!1}return y?-1:g||m?m:B}};n.exports={forEach:u(0),map:u(1),filter:u(2),some:u(3),every:u(4),find:u(5),findIndex:u(6)}},function(n,r,i){var a=this&&this.__values||function(I){var R=typeof Symbol=="function"&&Symbol.iterator,M=R&&I[R],A=0;if(M)return M.call(I);if(I&&typeof I.length=="number")return{next:function(){return I&&A>=I.length&&(I=void 0),{value:I&&I[A++],done:!I}}};throw new TypeError(R?"Object is not iterable.":"Symbol.iterator is not defined.")},o=this&&this.__read||function(I,R){var M=typeof Symbol=="function"&&I[Symbol.iterator];if(!M)return I;var A,L,P=M.call(I),B=[];try{for(;(R===void 0||R-- >0)&&!(A=P.next()).done;)B.push(A.value)}catch(U){L={error:U}}finally{try{A&&!A.done&&(M=P.return)&&M.call(P)}finally{if(L)throw L.error}}return B},s=this&&this.__spread||function(){for(var I=[],R=0;R<arguments.length;R++)I=I.concat(o(arguments[R]));return I};Object.defineProperty(r,"__esModule",{value:!0});var l=i(6),c=i(9),f=i(2),u=i(3),d=i(1),h=i(7),p=i(73),g=i(17),m=i(172),y=i(72),v=i(51),x=i(30),w=i(106);function S(I,R,M){var A,L,P,B,U,G,F,$,V=R._nodeType,X=I._nodeType,Q=M?M._nodeType:null;if(V!==f.NodeType.Document&&V!==f.NodeType.DocumentFragment&&V!==f.NodeType.Element)throw new c.HierarchyRequestError("Only document, document fragment and element nodes can contain child nodes. Parent node is "+R.nodeName+".");if(g.tree_isHostIncludingAncestorOf(R,I,!0))throw new c.HierarchyRequestError("The node to be inserted cannot be an inclusive ancestor of parent node. Node is "+I.nodeName+", parent node is "+R.nodeName+".");if(M!==null&&M._parent!==R)throw new c.NotFoundError("The reference child node cannot be found under parent node. Child node is "+M.nodeName+", parent node is "+R.nodeName+".");if(X!==f.NodeType.DocumentFragment&&X!==f.NodeType.DocumentType&&X!==f.NodeType.Element&&X!==f.NodeType.Text&&X!==f.NodeType.ProcessingInstruction&&X!==f.NodeType.CData&&X!==f.NodeType.Comment)throw new c.HierarchyRequestError("Only document fragment, document type, element, text, processing instruction, cdata section or comment nodes can be inserted. Node is "+I.nodeName+".");if(X===f.NodeType.Text&&V===f.NodeType.Document)throw new c.HierarchyRequestError("Cannot insert a text node as a child of a document node. Node is "+I.nodeName+".");if(X===f.NodeType.DocumentType&&V!==f.NodeType.Document)throw new c.HierarchyRequestError("A document type node can only be inserted under a document node. Parent node is "+R.nodeName+".");if(V===f.NodeType.Document){if(X===f.NodeType.DocumentFragment){var re=0;try{for(var ye=a(I._children),me=ye.next();!me.done;me=ye.next()){var Ce=me.value;if(Ce._nodeType===f.NodeType.Element)re++;else if(Ce._nodeType===f.NodeType.Text)throw new c.HierarchyRequestError("Cannot insert text a node as a child of a document node. Node is "+Ce.nodeName+".")}}catch(ue){A={error:ue}}finally{try{me&&!me.done&&(L=ye.return)&&L.call(ye)}finally{if(A)throw A.error}}if(re>1)throw new c.HierarchyRequestError("A document node can only have one document element node. Document fragment to be inserted has "+re+" element nodes.");if(re===1){try{for(var we=a(R._children),Ae=we.next();!Ae.done;Ae=we.next())if(Ae.value._nodeType===f.NodeType.Element)throw new c.HierarchyRequestError("The document node already has a document element node.")}catch(ue){P={error:ue}}finally{try{Ae&&!Ae.done&&(B=we.return)&&B.call(we)}finally{if(P)throw P.error}}if(M){if(Q===f.NodeType.DocumentType)throw new c.HierarchyRequestError("Cannot insert an element node before a document type node.");for(var De=M._nextSibling;De;){if(De._nodeType===f.NodeType.DocumentType)throw new c.HierarchyRequestError("Cannot insert an element node before a document type node.");De=De._nextSibling}}}}else if(X===f.NodeType.Element){try{for(var q=a(R._children),k=q.next();!k.done;k=q.next())if(k.value._nodeType===f.NodeType.Element)throw new c.HierarchyRequestError("Document already has a document element node. Node is "+I.nodeName+".")}catch(ue){U={error:ue}}finally{try{k&&!k.done&&(G=q.return)&&G.call(q)}finally{if(U)throw U.error}}if(M){if(Q===f.NodeType.DocumentType)throw new c.HierarchyRequestError("Cannot insert an element node before a document type node. Node is "+I.nodeName+".");for(De=M._nextSibling;De;){if(De._nodeType===f.NodeType.DocumentType)throw new c.HierarchyRequestError("Cannot insert an element node before a document type node. Node is "+I.nodeName+".");De=De._nextSibling}}}else if(X===f.NodeType.DocumentType){try{for(var J=a(R._children),Y=J.next();!Y.done;Y=J.next())if(Y.value._nodeType===f.NodeType.DocumentType)throw new c.HierarchyRequestError("Document already has a document type node. Node is "+I.nodeName+".")}catch(ue){F={error:ue}}finally{try{Y&&!Y.done&&($=J.return)&&$.call(J)}finally{if(F)throw F.error}}if(M)for(var ie=M._previousSibling;ie;){if(ie._nodeType===f.NodeType.Element)throw new c.HierarchyRequestError("Cannot insert a document type node before an element node. Node is "+I.nodeName+".");ie=ie._previousSibling}else for(ie=R._firstChild;ie;){if(ie._nodeType===f.NodeType.Element)throw new c.HierarchyRequestError("Cannot insert a document type node before an element node. Node is "+I.nodeName+".");ie=ie._nextSibling}}}}function T(I,R,M){S(I,R,M);var A=M;return A===I&&(A=I._nextSibling),w.document_adopt(I,R._nodeDocument),_(I,R,A),I}function _(I,R,M,A){var L,P;if(M!==null||I._nodeType===f.NodeType.DocumentFragment){var B=I._nodeType===f.NodeType.DocumentFragment?I._children.size:1;if(M!==null&&l.dom.rangeList.size!==0){var U=g.tree_index(M);try{for(var G=a(l.dom.rangeList),F=G.next();!F.done;F=G.next()){var $=F.value;$._start[0]===R&&$._start[1]>U&&($._start[1]+=B),$._end[0]===R&&$._end[1]>U&&($._end[1]+=B)}}catch(Ae){L={error:Ae}}finally{try{F&&!F.done&&(P=G.return)&&P.call(G)}finally{if(L)throw L.error}}}var V=I._nodeType===f.NodeType.DocumentFragment?new(Array.bind.apply(Array,s([void 0],I._children))):[I];if(I._nodeType===f.NodeType.DocumentFragment)for(;I._firstChild;)D(I._firstChild,I,!0);l.dom.features.mutationObservers&&I._nodeType===f.NodeType.DocumentFragment&&v.observer_queueTreeMutationRecord(I,[],V,null,null);for(var X=M?M._previousSibling:R._lastChild,Q=M===null?-1:g.tree_index(M),re=0;re<V.length;re++){var ye=V[re];if(u.Guard.isElementNode(ye)&&(u.Guard.isDocumentNode(R)&&(R._documentElement=ye),ye._nodeDocument._hasNamespaces||ye._namespace===null&&ye._namespacePrefix===null||(ye._nodeDocument._hasNamespaces=!0)),ye._parent=R,M===null?h.set.append(R._children,ye):(h.set.insert(R._children,ye,Q),Q++),R._firstChild===null)ye._previousSibling=null,ye._nextSibling=null,R._firstChild=ye,R._lastChild=ye;else{var me=M?M._previousSibling:R._lastChild,Ce=M||null;ye._previousSibling=me,ye._nextSibling=Ce,me&&(me._nextSibling=ye),Ce&&(Ce._previousSibling=ye),me||(R._firstChild=ye),Ce||(R._lastChild=ye)}l.dom.features.slots&&R._shadowRoot!==null&&u.Guard.isSlotable(ye)&&y.shadowTree_assignASlot(ye),l.dom.features.steps&&u.Guard.isTextNode(ye)&&x.dom_runChildTextContentChangeSteps(R),l.dom.features.slots&&u.Guard.isShadowRoot(g.tree_rootNode(R))&&u.Guard.isSlot(R)&&d.isEmpty(R._assignedNodes)&&y.shadowTree_signalASlotChange(R),l.dom.features.slots&&y.shadowTree_assignSlotablesForATree(g.tree_rootNode(ye));for(var we=g.tree_getFirstDescendantNode(ye,!0,!0);we!==null;)l.dom.features.steps&&x.dom_runInsertionSteps(we),l.dom.features.customElements&&u.Guard.isElementNode(we)&&y.shadowTree_isConnected(we)&&(u.Guard.isCustomElementNode(we)?p.customElement_enqueueACustomElementCallbackReaction(we,"connectedCallback",[]):p.customElement_tryToUpgrade(we)),we=g.tree_getNextDescendantNode(ye,we,!0,!0)}l.dom.features.mutationObservers&&(A||v.observer_queueTreeMutationRecord(R,V,[],X,M))}else(function(Ae,De,q){var k=De._lastChild;if(u.Guard.isElementNode(Ae)&&(u.Guard.isDocumentNode(De)&&(De._documentElement=Ae),Ae._nodeDocument._hasNamespaces||Ae._namespace===null&&Ae._namespacePrefix===null||(Ae._nodeDocument._hasNamespaces=!0)),Ae._parent=De,De._children.add(Ae),De._firstChild===null)Ae._previousSibling=null,Ae._nextSibling=null,De._firstChild=Ae,De._lastChild=Ae;else{var J=De._lastChild;Ae._previousSibling=J,Ae._nextSibling=null,J&&(J._nextSibling=Ae),J||(De._firstChild=Ae),De._lastChild=Ae}l.dom.features.slots&&De._shadowRoot!==null&&u.Guard.isSlotable(Ae)&&y.shadowTree_assignASlot(Ae),l.dom.features.steps&&u.Guard.isTextNode(Ae)&&x.dom_runChildTextContentChangeSteps(De),l.dom.features.slots&&u.Guard.isShadowRoot(g.tree_rootNode(De))&&u.Guard.isSlot(De)&&d.isEmpty(De._assignedNodes)&&y.shadowTree_signalASlotChange(De),l.dom.features.slots&&y.shadowTree_assignSlotablesForATree(g.tree_rootNode(Ae)),l.dom.features.steps&&x.dom_runInsertionSteps(Ae),l.dom.features.customElements&&u.Guard.isElementNode(Ae)&&y.shadowTree_isConnected(Ae)&&(u.Guard.isCustomElementNode(Ae)?p.customElement_enqueueACustomElementCallbackReaction(Ae,"connectedCallback",[]):p.customElement_tryToUpgrade(Ae)),l.dom.features.mutationObservers&&(q||v.observer_queueTreeMutationRecord(De,[Ae],[],k,null))})(I,R,A)}function D(I,R,M){var A,L,P,B,U,G,F,$;if(l.dom.rangeList.size!==0){var V=g.tree_index(I);try{for(var X=a(l.dom.rangeList),Q=X.next();!Q.done;Q=X.next()){var re=Q.value;g.tree_isDescendantOf(I,re._start[0],!0)&&(re._start=[R,V]),g.tree_isDescendantOf(I,re._end[0],!0)&&(re._end=[R,V]),re._start[0]===R&&re._start[1]>V&&re._start[1]--,re._end[0]===R&&re._end[1]>V&&re._end[1]--}}catch(Fe){A={error:Fe}}finally{try{Q&&!Q.done&&(L=X.return)&&L.call(X)}finally{if(A)throw A.error}}try{for(var ye=a(l.dom.rangeList),me=ye.next();!me.done;me=ye.next())(re=me.value)._start[0]===R&&re._start[1]>V&&(re._start[1]-=1),re._end[0]===R&&re._end[1]>V&&(re._end[1]-=1)}catch(Fe){P={error:Fe}}finally{try{me&&!me.done&&(B=ye.return)&&B.call(ye)}finally{if(P)throw P.error}}}if(l.dom.features.steps)try{for(var Ce=a(m.nodeIterator_iteratorList()),we=Ce.next();!we.done;we=Ce.next()){var Ae=we.value;Ae._root._nodeDocument===I._nodeDocument&&x.dom_runNodeIteratorPreRemovingSteps(Ae,I)}}catch(Fe){U={error:Fe}}finally{try{we&&!we.done&&(G=Ce.return)&&G.call(Ce)}finally{if(U)throw U.error}}var De=I._previousSibling,q=I._nextSibling;u.Guard.isDocumentNode(R)&&u.Guard.isElementNode(I)&&(R._documentElement=null),I._parent=null,R._children.delete(I);var k=I._previousSibling,J=I._nextSibling;I._previousSibling=null,I._nextSibling=null,k&&(k._nextSibling=J),J&&(J._previousSibling=k),k||(R._firstChild=J),J||(R._lastChild=k),l.dom.features.slots&&u.Guard.isSlotable(I)&&I._assignedSlot!==null&&y.shadowTree_isAssigned(I)&&y.shadowTree_assignSlotables(I._assignedSlot),l.dom.features.slots&&u.Guard.isShadowRoot(g.tree_rootNode(R))&&u.Guard.isSlot(R)&&d.isEmpty(R._assignedNodes)&&y.shadowTree_signalASlotChange(R),l.dom.features.slots&&g.tree_getFirstDescendantNode(I,!0,!1,(function(Fe){return u.Guard.isSlot(Fe)}))!==null&&(y.shadowTree_assignSlotablesForATree(g.tree_rootNode(R)),y.shadowTree_assignSlotablesForATree(I)),l.dom.features.steps&&x.dom_runRemovingSteps(I,R),l.dom.features.customElements&&u.Guard.isCustomElementNode(I)&&p.customElement_enqueueACustomElementCallbackReaction(I,"disconnectedCallback",[]);for(var Y=g.tree_getFirstDescendantNode(I,!1,!0);Y!==null;)l.dom.features.steps&&x.dom_runRemovingSteps(Y,I),l.dom.features.customElements&&u.Guard.isCustomElementNode(Y)&&p.customElement_enqueueACustomElementCallbackReaction(Y,"disconnectedCallback",[]),Y=g.tree_getNextDescendantNode(I,Y,!1,!0);if(l.dom.features.mutationObservers)for(var ie=g.tree_getFirstAncestorNode(R,!0);ie!==null;){try{for(var ue=(F=void 0,a(ie._registeredObserverList)),fe=ue.next();!fe.done;fe=ue.next()){var Se=fe.value;Se.options.subtree&&I._registeredObserverList.push({observer:Se.observer,options:Se.options,source:Se})}}catch(Fe){F={error:Fe}}finally{try{fe&&!fe.done&&($=ue.return)&&$.call(ue)}finally{if(F)throw F.error}}ie=g.tree_getNextAncestorNode(R,ie,!0)}l.dom.features.mutationObservers&&(M||v.observer_queueTreeMutationRecord(R,[],[I],De,q)),l.dom.features.steps&&u.Guard.isTextNode(I)&&x.dom_runChildTextContentChangeSteps(R)}r.mutation_ensurePreInsertionValidity=S,r.mutation_preInsert=T,r.mutation_insert=_,r.mutation_append=function(I,R){return T(I,R,null)},r.mutation_replace=function(I,R,M){var A,L,P,B,U,G,F,$;if(M._nodeType!==f.NodeType.Document&&M._nodeType!==f.NodeType.DocumentFragment&&M._nodeType!==f.NodeType.Element)throw new c.HierarchyRequestError("Only document, document fragment and element nodes can contain child nodes. Parent node is "+M.nodeName+".");if(g.tree_isHostIncludingAncestorOf(M,R,!0))throw new c.HierarchyRequestError("The node to be inserted cannot be an ancestor of parent node. Node is "+R.nodeName+", parent node is "+M.nodeName+".");if(I._parent!==M)throw new c.NotFoundError("The reference child node cannot be found under parent node. Child node is "+I.nodeName+", parent node is "+M.nodeName+".");if(R._nodeType!==f.NodeType.DocumentFragment&&R._nodeType!==f.NodeType.DocumentType&&R._nodeType!==f.NodeType.Element&&R._nodeType!==f.NodeType.Text&&R._nodeType!==f.NodeType.ProcessingInstruction&&R._nodeType!==f.NodeType.CData&&R._nodeType!==f.NodeType.Comment)throw new c.HierarchyRequestError("Only document fragment, document type, element, text, processing instruction, cdata section or comment nodes can be inserted. Node is "+R.nodeName+".");if(R._nodeType===f.NodeType.Text&&M._nodeType===f.NodeType.Document)throw new c.HierarchyRequestError("Cannot insert a text node as a child of a document node. Node is "+R.nodeName+".");if(R._nodeType===f.NodeType.DocumentType&&M._nodeType!==f.NodeType.Document)throw new c.HierarchyRequestError("A document type node can only be inserted under a document node. Parent node is "+M.nodeName+".");if(M._nodeType===f.NodeType.Document){if(R._nodeType===f.NodeType.DocumentFragment){var V=0;try{for(var X=a(R._children),Q=X.next();!Q.done;Q=X.next()){var re=Q.value;if(re._nodeType===f.NodeType.Element)V++;else if(re._nodeType===f.NodeType.Text)throw new c.HierarchyRequestError("Cannot insert text a node as a child of a document node. Node is "+re.nodeName+".")}}catch(Se){A={error:Se}}finally{try{Q&&!Q.done&&(L=X.return)&&L.call(X)}finally{if(A)throw A.error}}if(V>1)throw new c.HierarchyRequestError("A document node can only have one document element node. Document fragment to be inserted has "+V+" element nodes.");if(V===1){try{for(var ye=a(M._children),me=ye.next();!me.done;me=ye.next())if((k=me.value)._nodeType===f.NodeType.Element&&k!==I)throw new c.HierarchyRequestError("The document node already has a document element node.")}catch(Se){P={error:Se}}finally{try{me&&!me.done&&(B=ye.return)&&B.call(ye)}finally{if(P)throw P.error}}for(var Ce=I._nextSibling;Ce;){if(Ce._nodeType===f.NodeType.DocumentType)throw new c.HierarchyRequestError("Cannot insert an element node before a document type node.");Ce=Ce._nextSibling}}}else if(R._nodeType===f.NodeType.Element){try{for(var we=a(M._children),Ae=we.next();!Ae.done;Ae=we.next())if((k=Ae.value)._nodeType===f.NodeType.Element&&k!==I)throw new c.HierarchyRequestError("Document already has a document element node. Node is "+R.nodeName+".")}catch(Se){U={error:Se}}finally{try{Ae&&!Ae.done&&(G=we.return)&&G.call(we)}finally{if(U)throw U.error}}for(Ce=I._nextSibling;Ce;){if(Ce._nodeType===f.NodeType.DocumentType)throw new c.HierarchyRequestError("Cannot insert an element node before a document type node. Node is "+R.nodeName+".");Ce=Ce._nextSibling}}else if(R._nodeType===f.NodeType.DocumentType){try{for(var De=a(M._children),q=De.next();!q.done;q=De.next()){var k;if((k=q.value)._nodeType===f.NodeType.DocumentType&&k!==I)throw new c.HierarchyRequestError("Document already has a document type node. Node is "+R.nodeName+".")}}catch(Se){F={error:Se}}finally{try{q&&!q.done&&($=De.return)&&$.call(De)}finally{if(F)throw F.error}}for(var J=I._previousSibling;J;){if(J._nodeType===f.NodeType.Element)throw new c.HierarchyRequestError("Cannot insert a document type node before an element node. Node is "+R.nodeName+".");J=J._previousSibling}}}var Y=I._nextSibling;Y===R&&(Y=R._nextSibling);var ie=I._previousSibling;w.document_adopt(R,M._nodeDocument);var ue=[];I._parent!==null&&(ue.push(I),D(I,I._parent,!0));var fe=[];return R._nodeType===f.NodeType.DocumentFragment?fe=Array.from(R._children):fe.push(R),_(R,M,Y,!0),l.dom.features.mutationObservers&&v.observer_queueTreeMutationRecord(M,fe,ue,ie,Y),I},r.mutation_replaceAll=function(I,R){var M,A;I!==null&&w.document_adopt(I,R._nodeDocument);var L=Array.from(R._children),P=[];I&&I._nodeType===f.NodeType.DocumentFragment?P=Array.from(I._children):I!==null&&P.push(I);try{for(var B=a(L),U=B.next();!U.done;U=B.next())D(U.value,R,!0)}catch(G){M={error:G}}finally{try{U&&!U.done&&(A=B.return)&&A.call(B)}finally{if(M)throw M.error}}I!==null&&_(I,R,null,!0),l.dom.features.mutationObservers&&v.observer_queueTreeMutationRecord(R,P,L,null,null)},r.mutation_preRemove=function(I,R){if(I._parent!==R)throw new c.NotFoundError("The child node cannot be found under parent node. Child node is "+I.nodeName+", parent node is "+R.nodeName+".");return D(I,R),I},r.mutation_remove=D},function(n,r,i){function a(o){return o==null}n.exports.isNothing=a,n.exports.isObject=function(o){return typeof o=="object"&&o!==null},n.exports.toArray=function(o){return Array.isArray(o)?o:a(o)?[]:[o]},n.exports.repeat=function(o,s){var l,c="";for(l=0;l<s;l+=1)c+=o;return c},n.exports.isNegativeZero=function(o){return o===0&&Number.NEGATIVE_INFINITY===1/o},n.exports.extend=function(o,s){var l,c,f,u;if(s)for(l=0,c=(u=Object.keys(s)).length;l<c;l+=1)o[f=u[l]]=s[f];return o}},function(n,r,i){var a=i(38),o=i(53),s=i(10);function l(f,u,d){var h=[];return f.include.forEach((function(p){d=l(p,u,d)})),f[u].forEach((function(p){d.forEach((function(g,m){g.tag===p.tag&&g.kind===p.kind&&h.push(m)})),d.push(p)})),d.filter((function(p,g){return h.indexOf(g)===-1}))}function c(f){this.include=f.include||[],this.implicit=f.implicit||[],this.explicit=f.explicit||[],this.implicit.forEach((function(u){if(u.loadKind&&u.loadKind!=="scalar")throw new o("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.")})),this.compiledImplicit=l(this,"implicit",[]),this.compiledExplicit=l(this,"explicit",[]),this.compiledTypeMap=(function(){var u,d,h={scalar:{},sequence:{},mapping:{},fallback:{}};function p(g){h[g.kind][g.tag]=h.fallback[g.tag]=g}for(u=0,d=arguments.length;u<d;u+=1)arguments[u].forEach(p);return h})(this.compiledImplicit,this.compiledExplicit)}c.DEFAULT=null,c.create=function(){var f,u;switch(arguments.length){case 1:f=c.DEFAULT,u=arguments[0];break;case 2:f=arguments[0],u=arguments[1];break;default:throw new o("Wrong number of arguments for Schema.create function")}if(f=a.toArray(f),u=a.toArray(u),!f.every((function(d){return d instanceof c})))throw new o("Specified list of super schemas (or a single Schema object) contains a non-Schema object.");if(!u.every((function(d){return d instanceof s})))throw new o("Specified list of YAML types (or a single Type object) contains a non-Type object.");return new c({include:f,explicit:u})},n.exports=c},function(n,r){n.exports=function(i,a){return{enumerable:!(1&i),configurable:!(2&i),writable:!(4&i),value:a}}},function(n,r,i){var a=i(8),o=i(42),s="".split;n.exports=a((function(){return!Object("z").propertyIsEnumerable(0)}))?function(l){return o(l)=="String"?s.call(l,""):Object(l)}:Object},function(n,r){var i={}.toString;n.exports=function(a){return i.call(a).slice(8,-1)}},function(n,r,i){var a,o,s,l=i(186),c=i(11),f=i(13),u=i(21),d=i(14),h=i(57),p=i(45),g=c.WeakMap;if(l){var m=new g,y=m.get,v=m.has,x=m.set;a=function(S,T){return x.call(m,S,T),T},o=function(S){return y.call(m,S)||{}},s=function(S){return v.call(m,S)}}else{var w=h("state");p[w]=!0,a=function(S,T){return u(S,w,T),T},o=function(S){return d(S,w)?S[w]:{}},s=function(S){return d(S,w)}}n.exports={set:a,get:o,has:s,enforce:function(S){return s(S)?o(S):a(S,{})},getterFor:function(S){return function(T){var _;if(!f(T)||(_=o(T)).type!==S)throw TypeError("Incompatible receiver, "+S+" required");return _}}}},function(n,r){n.exports=!1},function(n,r){n.exports={}},function(n,r,i){var a=i(120),o=i(11),s=function(l){return typeof l=="function"?l:void 0};n.exports=function(l,c){return arguments.length<2?s(a[l])||s(o[l]):a[l]&&a[l][c]||o[l]&&o[l][c]}},function(n,r){var i=Math.ceil,a=Math.floor;n.exports=function(o){return isNaN(o=+o)?0:(o>0?a:i)(o)}},function(n,r,i){var a=i(8);n.exports=function(o,s){var l=[][o];return!!l&&a((function(){l.call(null,s||function(){throw 1},1)}))}},function(n,r){n.exports={}},function(n,r,i){i(31),i(32),i(33),i(220),i(64),i(19),i(65),i(20),i(68),i(66),i(92),i(144),i(22),i(94),i(23);var a=this&&this.__values||function(p){var g=typeof Symbol=="function"&&Symbol.iterator,m=g&&p[g],y=0;if(m)return m.call(p);if(p&&typeof p.length=="number")return{next:function(){return p&&y>=p.length&&(p=void 0),{value:p&&p[y++],done:!p}}};throw new TypeError(g?"Object is not iterable.":"Symbol.iterator is not defined.")},o=this&&this.__read||function(p,g){var m=typeof Symbol=="function"&&p[Symbol.iterator];if(!m)return p;var y,v,x=m.call(p),w=[];try{for(;(g===void 0||g-- >0)&&!(y=x.next()).done;)w.push(y.value)}catch(S){v={error:S}}finally{try{y&&!y.done&&(m=x.return)&&m.call(x)}finally{if(v)throw v.error}}return w},s=this&&this.__spread||function(){for(var p=[],g=0;g<arguments.length;g++)p=p.concat(o(arguments[g]));return p};Object.defineProperty(r,"__esModule",{value:!0});var l=i(2),c=i(69),f=i(95),u=i(7),d=i(0),h=(function(){function p(g){this.level=0,this._builderOptions=g}return p.prototype.declaration=function(g,m,y){},p.prototype.docType=function(g,m,y){},p.prototype.comment=function(g){},p.prototype.text=function(g){},p.prototype.instruction=function(g,m){},p.prototype.cdata=function(g){},p.prototype.openTagBegin=function(g){},p.prototype.openTagEnd=function(g,m,y){},p.prototype.closeTag=function(g){},p.prototype.attributes=function(g){var m,y;try{for(var v=a(g),x=v.next();!x.done;x=v.next()){var w=x.value;this.attribute(w[1]===null?w[2]:w[1]+":"+w[2],w[3])}}catch(S){m={error:S}}finally{try{x&&!x.done&&(y=v.return)&&y.call(v)}finally{if(m)throw m.error}}},p.prototype.attribute=function(g,m){},p.prototype.beginElement=function(g){},p.prototype.endElement=function(g){},p.prototype.serializeNode=function(g,m){var y=g._nodeDocument!==void 0&&g._nodeDocument._hasNamespaces;if(this.level=0,this.currentNode=g,y){var v=new f.NamespacePrefixMap;v.set("xml",u.namespace.XML),this._serializeNodeNS(g,null,v,{value:1},m)}else this._serializeNode(g,m)},p.prototype._serializeNodeNS=function(g,m,y,v,x){switch(this.currentNode=g,g.nodeType){case l.NodeType.Element:this._serializeElementNS(g,m,y,v,x);break;case l.NodeType.Document:this._serializeDocumentNS(g,m,y,v,x);break;case l.NodeType.Comment:this._serializeComment(g,x);break;case l.NodeType.Text:this._serializeText(g,x);break;case l.NodeType.DocumentFragment:this._serializeDocumentFragmentNS(g,m,y,v,x);break;case l.NodeType.DocumentType:this._serializeDocumentType(g,x);break;case l.NodeType.ProcessingInstruction:this._serializeProcessingInstruction(g,x);break;case l.NodeType.CData:this._serializeCData(g,x);break;default:throw new Error("Unknown node type: "+g.nodeType)}},p.prototype._serializeNode=function(g,m){switch(this.currentNode=g,g.nodeType){case l.NodeType.Element:this._serializeElement(g,m);break;case l.NodeType.Document:this._serializeDocument(g,m);break;case l.NodeType.Comment:this._serializeComment(g,m);break;case l.NodeType.Text:this._serializeText(g,m);break;case l.NodeType.DocumentFragment:this._serializeDocumentFragment(g,m);break;case l.NodeType.DocumentType:this._serializeDocumentType(g,m);break;case l.NodeType.ProcessingInstruction:this._serializeProcessingInstruction(g,m);break;case l.NodeType.CData:this._serializeCData(g,m);break;default:throw new Error("Unknown node type: "+g.nodeType)}},p.prototype._serializeElementNS=function(g,m,y,v,x){var w,S,T=[];if(x&&(g.localName.indexOf(":")!==-1||!d.xml_isName(g.localName)))throw new Error("Node local name contains invalid characters (well-formed required).");var _="",D=!1,I=!1,R=y.copy(),M={},A=this._recordNamespaceInformation(g,R,M),L=m,P=g.namespaceURI;if(L===P)A!==null&&(I=!0),_=P===u.namespace.XML?"xml:"+g.localName:g.localName,this.beginElement(_),this.openTagBegin(_);else{var B=g.prefix,U=null;if(B===null&&P===A||(U=R.get(B,P)),B==="xmlns"){if(x)throw new Error("An element cannot have the 'xmlns' prefix (well-formed required).");U=B}U!==null?(_=U+":"+g.localName,A!==null&&A!==u.namespace.XML&&(L=A||null),this.beginElement(_),this.openTagBegin(_)):B!==null?(B in M&&(B=this._generatePrefix(P,R,v)),R.set(B,P),_+=B+":"+g.localName,this.beginElement(_),this.openTagBegin(_),T.push([null,"xmlns",B,this._serializeAttributeValue(P,x)]),A!==null&&(L=A||null)):A===null||A!==null&&A!==P?(I=!0,_+=g.localName,L=P,this.beginElement(_),this.openTagBegin(_),T.push([null,null,"xmlns",this._serializeAttributeValue(P,x)])):(_+=g.localName,L=P,this.beginElement(_),this.openTagBegin(_))}T.push.apply(T,s(this._serializeAttributesNS(g,R,v,M,I,x))),this.attributes(T);var G=P===u.namespace.HTML;if(G&&g.childNodes.length===0&&p._VoidElementNames.has(g.localName)?(this.openTagEnd(_,!0,!0),this.endElement(_),D=!0):G||g.childNodes.length!==0?this.openTagEnd(_,!1,!1):(this.openTagEnd(_,!0,!1),this.endElement(_),D=!0),!D){if(!(G&&g.localName==="template"))try{for(var F=a(g.childNodes),$=F.next();!$.done;$=F.next()){var V=$.value;this.level++,this._serializeNodeNS(V,L,R,v,x),this.level--}}catch(X){w={error:X}}finally{try{$&&!$.done&&(S=F.return)&&S.call(F)}finally{if(w)throw w.error}}this.closeTag(_),this.endElement(_)}},p.prototype._serializeElement=function(g,m){var y,v;if(m&&(g.localName.indexOf(":")!==-1||!d.xml_isName(g.localName)))throw new Error("Node local name contains invalid characters (well-formed required).");var x=!1,w=g.localName;this.beginElement(w),this.openTagBegin(w);var S=this._serializeAttributes(g,m);if(this.attributes(S),g.hasChildNodes()?this.openTagEnd(w,!1,!1):(this.openTagEnd(w,!0,!1),this.endElement(w),x=!0),!x){try{for(var T=a(g._children),_=T.next();!_.done;_=T.next()){var D=_.value;this.level++,this._serializeNode(D,m),this.level--}}catch(I){y={error:I}}finally{try{_&&!_.done&&(v=T.return)&&v.call(T)}finally{if(y)throw y.error}}this.closeTag(w),this.endElement(w)}},p.prototype._serializeDocumentNS=function(g,m,y,v,x){var w,S;if(x&&g.documentElement===null)throw new Error("Missing document element (well-formed required).");try{for(var T=a(g.childNodes),_=T.next();!_.done;_=T.next()){var D=_.value;this._serializeNodeNS(D,m,y,v,x)}}catch(I){w={error:I}}finally{try{_&&!_.done&&(S=T.return)&&S.call(T)}finally{if(w)throw w.error}}},p.prototype._serializeDocument=function(g,m){var y,v;if(m&&g.documentElement===null)throw new Error("Missing document element (well-formed required).");try{for(var x=a(g._children),w=x.next();!w.done;w=x.next()){var S=w.value;this._serializeNode(S,m)}}catch(T){y={error:T}}finally{try{w&&!w.done&&(v=x.return)&&v.call(x)}finally{if(y)throw y.error}}},p.prototype._serializeComment=function(g,m){if(m&&(!d.xml_isLegalChar(g.data)||g.data.indexOf("--")!==-1||g.data.endsWith("-")))throw new Error("Comment data contains invalid characters (well-formed required).");this.comment(g.data)},p.prototype._serializeText=function(g,m){if(m&&!d.xml_isLegalChar(g.data))throw new Error("Text data contains invalid characters (well-formed required).");var y=g.data.replace(/(?!&([^&;]*);)&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");this.text(y)},p.prototype._serializeDocumentFragmentNS=function(g,m,y,v,x){var w,S;try{for(var T=a(g.childNodes),_=T.next();!_.done;_=T.next()){var D=_.value;this._serializeNodeNS(D,m,y,v,x)}}catch(I){w={error:I}}finally{try{_&&!_.done&&(S=T.return)&&S.call(T)}finally{if(w)throw w.error}}},p.prototype._serializeDocumentFragment=function(g,m){var y,v;try{for(var x=a(g._children),w=x.next();!w.done;w=x.next()){var S=w.value;this._serializeNode(S,m)}}catch(T){y={error:T}}finally{try{w&&!w.done&&(v=x.return)&&v.call(x)}finally{if(y)throw y.error}}},p.prototype._serializeDocumentType=function(g,m){if(m&&!d.xml_isPubidChar(g.publicId))throw new Error("DocType public identifier does not match PubidChar construct (well-formed required).");if(m&&(!d.xml_isLegalChar(g.systemId)||g.systemId.indexOf('"')!==-1&&g.systemId.indexOf("'")!==-1))throw new Error("DocType system identifier contains invalid characters (well-formed required).");this.docType(g.name,g.publicId,g.systemId)},p.prototype._serializeProcessingInstruction=function(g,m){if(m&&(g.target.indexOf(":")!==-1||/^xml$/i.test(g.target)))throw new Error("Processing instruction target contains invalid characters (well-formed required).");if(m&&(!d.xml_isLegalChar(g.data)||g.data.indexOf("?>")!==-1))throw new Error("Processing instruction data contains invalid characters (well-formed required).");this.instruction(g.target,g.data)},p.prototype._serializeCData=function(g,m){if(m&&g.data.indexOf("]]>")!==-1)throw new Error("CDATA contains invalid characters (well-formed required).");this.cdata(g.data)},p.prototype._serializeAttributesNS=function(g,m,y,v,x,w){var S,T,_=[],D=w?new c.LocalNameSet:void 0;try{for(var I=a(g.attributes),R=I.next();!R.done;R=I.next()){var M=R.value;if(w||x||M.namespaceURI!==null){if(w&&D&&D.has(M.namespaceURI,M.localName))throw new Error("Element contains duplicate attributes (well-formed required).");w&&D&&D.set(M.namespaceURI,M.localName);var A=M.namespaceURI,L=null;if(A!==null)if(L=m.get(M.prefix,A),A===u.namespace.XMLNS){if(M.value===u.namespace.XML||M.prefix===null&&x||M.prefix!==null&&(!(M.localName in v)||v[M.localName]!==M.value)&&m.has(M.localName,M.value))continue;if(w&&M.value===u.namespace.XMLNS)throw new Error("XMLNS namespace is reserved (well-formed required).");if(w&&M.value==="")throw new Error("Namespace prefix declarations cannot be used to undeclare a namespace (well-formed required).");M.prefix==="xmlns"&&(L="xmlns")}else L===null&&(L=M.prefix===null||m.hasPrefix(M.prefix)&&!m.has(M.prefix,A)?this._generatePrefix(A,m,y):M.prefix,_.push([null,"xmlns",L,this._serializeAttributeValue(A,w)]));if(w&&(M.localName.indexOf(":")!==-1||!d.xml_isName(M.localName)||M.localName==="xmlns"&&A===null))throw new Error("Attribute local name contains invalid characters (well-formed required).");_.push([A,L,M.localName,this._serializeAttributeValue(M.value,w)])}else _.push([null,null,M.localName,this._serializeAttributeValue(M.value,w)])}}catch(P){S={error:P}}finally{try{R&&!R.done&&(T=I.return)&&T.call(I)}finally{if(S)throw S.error}}return _},p.prototype._serializeAttributes=function(g,m){var y,v,x=[],w=m?{}:void 0;try{for(var S=a(g.attributes),T=S.next();!T.done;T=S.next()){var _=T.value;if(m){if(m&&w&&_.localName in w)throw new Error("Element contains duplicate attributes (well-formed required).");if(m&&w&&(w[_.localName]=!0),m&&(_.localName.indexOf(":")!==-1||!d.xml_isName(_.localName)))throw new Error("Attribute local name contains invalid characters (well-formed required).");x.push([null,null,_.localName,this._serializeAttributeValue(_.value,m)])}else x.push([null,null,_.localName,this._serializeAttributeValue(_.value,m)])}}catch(D){y={error:D}}finally{try{T&&!T.done&&(v=S.return)&&v.call(S)}finally{if(y)throw y.error}}return x},p.prototype._recordNamespaceInformation=function(g,m,y){var v,x,w=null;try{for(var S=a(g.attributes),T=S.next();!T.done;T=S.next()){var _=T.value,D=_.namespaceURI,I=_.prefix;if(D===u.namespace.XMLNS){if(I===null){w=_.value;continue}var R=_.localName,M=_.value;if(M===u.namespace.XML||(M===""&&(M=null),m.has(R,M)))continue;m.set(R,M),y[R]=M||""}}}catch(A){v={error:A}}finally{try{T&&!T.done&&(x=S.return)&&x.call(S)}finally{if(v)throw v.error}}return w},p.prototype._generatePrefix=function(g,m,y){var v="ns"+y.value.toString();return y.value++,m.set(v,g),v},p.prototype._serializeAttributeValue=function(g,m){if(m&&g!==null&&!d.xml_isLegalChar(g))throw new Error("Invalid characters in attribute value.");return g===null?"":g.replace(/(?!&([^&;]*);)&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},p._VoidElementNames=new Set(["area","base","basefont","bgsound","br","col","embed","frame","hr","img","input","keygen","link","menuitem","meta","param","source","track","wbr"]),p})();r.BaseWriter=h},function(n,r,i){var a=this&&this.__values||function(m){var y=typeof Symbol=="function"&&Symbol.iterator,v=y&&m[y],x=0;if(v)return v.call(m);if(m&&typeof m.length=="number")return{next:function(){return m&&x>=m.length&&(m=void 0),{value:m&&m[x++],done:!m}}};throw new TypeError(y?"Object is not iterable.":"Symbol.iterator is not defined.")},o=this&&this.__read||function(m,y){var v=typeof Symbol=="function"&&m[Symbol.iterator];if(!v)return m;var x,w,S=v.call(m),T=[];try{for(;(y===void 0||y-- >0)&&!(x=S.next()).done;)T.push(x.value)}catch(_){w={error:_}}finally{try{x&&!x.done&&(v=S.return)&&v.call(S)}finally{if(w)throw w.error}}return T};Object.defineProperty(r,"__esModule",{value:!0});var s=i(6),l=i(3),c=i(7),f=i(29),u=i(17),d=i(97);function h(){var m=s.dom.window;m._mutationObserverMicrotaskQueued||(m._mutationObserverMicrotaskQueued=!0,Promise.resolve().then((function(){p()})))}function p(){var m,y,v,x,w=s.dom.window;w._mutationObserverMicrotaskQueued=!1;var S=c.set.clone(w._mutationObservers),T=c.set.clone(w._signalSlots);c.set.empty(w._signalSlots);var _=function(L){var P=c.list.clone(L._recordQueue);c.list.empty(L._recordQueue);for(var B=0;B<L._nodeList.length;B++){var U=L._nodeList[B];c.list.remove(U._registeredObserverList,(function(G){return l.Guard.isTransientRegisteredObserver(G)&&G.observer===L}))}if(!c.list.isEmpty(P))try{L._callback.call(L,P,L)}catch{}};try{for(var D=a(S),I=D.next();!I.done;I=D.next())_(I.value)}catch(L){m={error:L}}finally{try{I&&!I.done&&(y=D.return)&&y.call(D)}finally{if(m)throw m.error}}if(s.dom.features.slots)try{for(var R=a(T),M=R.next();!M.done;M=R.next()){var A=M.value;d.event_fireAnEvent("slotchange",A,void 0,{bubbles:!0})}}catch(L){v={error:L}}finally{try{M&&!M.done&&(x=R.return)&&x.call(R)}finally{if(v)throw v.error}}}function g(m,y,v,x,w,S,T,_,D){for(var I,R,M=new Map,A=u.tree_getFirstAncestorNode(y,!0);A!==null;){for(var L=0;L<A._registeredObserverList.length;L++){var P=A._registeredObserverList[L],B=P.options;if((A===y||B.subtree)&&(m!=="attributes"||B.attributes)&&(m!=="attributes"||!B.attributeFilter||B.attributeFilter.indexOf(v||"")&&x===null)&&(m!=="characterData"||B.characterData)&&(m!=="childList"||B.childList)){var U=P.observer;M.has(U)||M.set(U,null),(m==="attributes"&&B.attributeOldValue||m==="characterData"&&B.characterDataOldValue)&&M.set(U,w)}}A=u.tree_getNextAncestorNode(y,A,!0)}try{for(var G=a(M),F=G.next();!F.done;F=G.next()){var $=o(F.value,2),V=$[0],X=$[1],Q=f.create_mutationRecord(m,y,f.create_nodeListStatic(y,S),f.create_nodeListStatic(y,T),_,D,v,x,X);V._recordQueue.push(Q)}}catch(re){I={error:re}}finally{try{F&&!F.done&&(R=G.return)&&R.call(G)}finally{if(I)throw I.error}}h()}r.observer_queueAMutationObserverMicrotask=h,r.observer_notifyMutationObservers=p,r.observer_queueMutationRecord=g,r.observer_queueTreeMutationRecord=function(m,y,v,x,w){g("childList",m,null,null,null,y,v,x,w)},r.observer_queueAttributeMutationRecord=function(m,y,v,x){g("attributes",m,y,v,x,[],[],null,null)}},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(6),o=i(7),s=i(3),l=i(9),c=i(29),f=i(73),u=i(51),d=i(30),h=i(37),p=i(106);function g(S,T,_){a.dom.features.mutationObservers&&u.observer_queueAttributeMutationRecord(T,S._localName,S._namespace,S._value),a.dom.features.customElements&&s.Guard.isCustomElementNode(T)&&f.customElement_enqueueACustomElementCallbackReaction(T,"attributeChangedCallback",[S._localName,S._value,_,S._namespace]),a.dom.features.steps&&d.dom_runAttributeChangeSteps(T,S._localName,S._value,_,S._namespace),S._value=_}function m(S,T){a.dom.features.mutationObservers&&u.observer_queueAttributeMutationRecord(T,S._localName,S._namespace,null),a.dom.features.customElements&&s.Guard.isCustomElementNode(T)&&f.customElement_enqueueACustomElementCallbackReaction(T,"attributeChangedCallback",[S._localName,null,S._value,S._namespace]),a.dom.features.steps&&d.dom_runAttributeChangeSteps(T,S._localName,null,S._value,S._namespace),T._attributeList._asArray().push(S),S._element=T,T._nodeDocument._hasNamespaces||S._namespace===null&&S._namespacePrefix===null&&S._localName!=="xmlns"||(T._nodeDocument._hasNamespaces=!0)}function y(S,T){a.dom.features.mutationObservers&&u.observer_queueAttributeMutationRecord(T,S._localName,S._namespace,S._value),a.dom.features.customElements&&s.Guard.isCustomElementNode(T)&&f.customElement_enqueueACustomElementCallbackReaction(T,"attributeChangedCallback",[S._localName,S._value,null,S._namespace]),a.dom.features.steps&&d.dom_runAttributeChangeSteps(T,S._localName,S._value,null,S._namespace);var _=T._attributeList._asArray().indexOf(S);T._attributeList._asArray().splice(_,1),S._element=null}function v(S,T,_){a.dom.features.mutationObservers&&u.observer_queueAttributeMutationRecord(_,S._localName,S._namespace,S._value),a.dom.features.customElements&&s.Guard.isCustomElementNode(_)&&f.customElement_enqueueACustomElementCallbackReaction(_,"attributeChangedCallback",[S._localName,S._value,T._value,S._namespace]),a.dom.features.steps&&d.dom_runAttributeChangeSteps(_,S._localName,S._value,T._value,S._namespace);var D=_._attributeList._asArray().indexOf(S);D!==-1&&(_._attributeList._asArray()[D]=T),S._element=null,T._element=_,_._nodeDocument._hasNamespaces||T._namespace===null&&T._namespacePrefix===null&&T._localName!=="xmlns"||(_._nodeDocument._hasNamespaces=!0)}function x(S,T){return T._namespace===o.namespace.HTML&&T._nodeDocument._type==="html"&&(S=S.toLowerCase()),T._attributeList._asArray().find((function(_){return _._qualifiedName===S}))||null}function w(S,T,_){var D=S||null;return _._attributeList._asArray().find((function(I){return I._namespace===D&&I._localName===T}))||null}r.element_has=function(S,T){return T._attributeList._asArray().indexOf(S)!==-1},r.element_change=g,r.element_append=m,r.element_remove=y,r.element_replace=v,r.element_getAnAttributeByName=x,r.element_getAnAttributeByNamespaceAndLocalName=w,r.element_getAnAttributeValue=function(S,T,_){_===void 0&&(_="");var D=w(_,T,S);return D===null?"":D._value},r.element_setAnAttribute=function(S,T){if(S._element!==null&&S._element!==T)throw new l.InUseAttributeError("This attribute already exists in the document: "+S._qualifiedName+" as a child of "+S._element._qualifiedName+".");var _=w(S._namespace||"",S._localName,T);return _===S?S:(_!==null?v(_,S,T):m(S,T),_)},r.element_setAnAttributeValue=function(S,T,_,D,I){D===void 0&&(D=null),I===void 0&&(I=null);var R=w(I||"",T,S);if(R===null){var M=c.create_attr(S._nodeDocument,T);return M._namespace=I,M._namespacePrefix=D,M._value=_,void m(M,S)}g(R,S,_)},r.element_removeAnAttributeByName=function(S,T){var _=x(S,T);return _!==null&&y(_,T),_},r.element_removeAnAttributeByNamespaceAndLocalName=function(S,T,_){var D=w(S,T,_);return D!==null&&y(D,_),D},r.element_createAnElement=function(S,T,_,D,I,R){D===void 0&&(D=null),I===void 0&&(I=null),R===void 0&&(R=!1);var M=null;if(!a.dom.features.customElements)return(M=c.create_element(S,T,_,D))._customElementState="uncustomized",M._customElementDefinition=null,M._is=I,M;var A=f.customElement_lookUpACustomElementDefinition(S,_,T,I);if(A!==null&&A.name!==A.localName)(M=new(p.document_elementInterface(T,o.namespace.HTML)))._localName=T,M._namespace=o.namespace.HTML,M._namespacePrefix=D,M._customElementState="undefined",M._customElementDefinition=null,M._is=I,M._nodeDocument=S,R?f.customElement_upgrade(A,M):f.customElement_enqueueACustomElementUpgradeReaction(M,A);else if(A!==null)if(R)try{var L=new A.constructor;if(console.assert(L._customElementState!==void 0),console.assert(L._customElementDefinition!==void 0),console.assert(L._namespace===o.namespace.HTML),L._attributeList.length!==0)throw new l.NotSupportedError("Custom element already has attributes.");if(L._children.size!==0)throw new l.NotSupportedError("Custom element already has child nodes.");if(L._parent!==null)throw new l.NotSupportedError("Custom element already has a parent node.");if(L._nodeDocument!==S)throw new l.NotSupportedError("Custom element is already in a document.");if(L._localName!==T)throw new l.NotSupportedError("Custom element has a different local name.");L._namespacePrefix=D,L._is=null}catch{(M=c.create_htmlUnknownElement(S,T,o.namespace.HTML,D))._customElementState="failed",M._customElementDefinition=null,M._is=null}else(M=c.create_htmlElement(S,T,o.namespace.HTML,D))._customElementState="undefined",M._customElementDefinition=null,M._is=null,f.customElement_enqueueACustomElementUpgradeReaction(M,A);else(M=new(p.document_elementInterface(T,_)))._localName=T,M._namespace=_,M._namespacePrefix=D,M._customElementState="uncustomized",M._customElementDefinition=null,M._is=I,M._nodeDocument=S,_!==o.namespace.HTML||I===null&&!f.customElement_isValidCustomElementName(T)||(M._customElementState="undefined");if(M===null)throw new Error("Unable to create element.");return M},r.element_insertAdjacent=function(S,T,_){switch(T.toLowerCase()){case"beforebegin":return S._parent===null?null:h.mutation_preInsert(_,S._parent,S);case"afterbegin":return h.mutation_preInsert(_,S,S._firstChild);case"beforeend":return h.mutation_preInsert(_,S,null);case"afterend":return S._parent===null?null:h.mutation_preInsert(_,S._parent,S._nextSibling);default:throw new l.SyntaxError(`Invalid 'where' argument. "beforebegin", "afterbegin", "beforeend" or "afterend" expected`)}}},function(n,r,i){function a(o,s){Error.call(this),this.name="YAMLException",this.reason=o,this.mark=s,this.message=(this.reason||"(unknown reason)")+(this.mark?" "+this.mark.toString():""),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack||""}a.prototype=Object.create(Error.prototype),a.prototype.constructor=a,a.prototype.toString=function(o){var s=this.name+": ";return s+=this.reason||"(unknown reason)",!o&&this.mark&&(s+=" "+this.mark.toString()),s},n.exports=a},function(n,r,i){var a=i(39);n.exports=new a({include:[i(181)],implicit:[i(293),i(294)],explicit:[i(295),i(296),i(297),i(298)]})},function(n,r,i){var a=i(16),o=i(79),s=i(40),l=i(24),c=i(56),f=i(14),u=i(115),d=Object.getOwnPropertyDescriptor;r.f=a?d:function(h,p){if(h=l(h),p=c(p,!0),u)try{return d(h,p)}catch{}if(f(h,p))return s(!o.f.call(h,p),h[p])}},function(n,r,i){var a=i(13);n.exports=function(o,s){if(!a(o))return o;var l,c;if(s&&typeof(l=o.toString)=="function"&&!a(c=l.call(o))||typeof(l=o.valueOf)=="function"&&!a(c=l.call(o))||!s&&typeof(l=o.toString)=="function"&&!a(c=l.call(o)))return c;throw TypeError("Can't convert object to primitive value")}},function(n,r,i){var a=i(81),o=i(58),s=a("keys");n.exports=function(l){return s[l]||(s[l]=o(l))}},function(n,r){var i=0,a=Math.random();n.exports=function(o){return"Symbol("+String(o===void 0?"":o)+")_"+(++i+a).toString(36)}},function(n,r,i){var a=i(42);n.exports=Array.isArray||function(o){return a(o)=="Array"}},function(n,r,i){var a,o=i(18),s=i(188),l=i(84),c=i(45),f=i(189),u=i(116),d=i(57),h=d("IE_PROTO"),p=function(){},g=function(y){return"<script>"+y+"<\/script>"},m=function(){try{a=document.domain&&new ActiveXObject("htmlfile")}catch{}var y,v;m=a?(function(w){w.write(g("")),w.close();var S=w.parentWindow.Object;return w=null,S})(a):((v=u("iframe")).style.display="none",f.appendChild(v),v.src="javascript:",(y=v.contentWindow.document).open(),y.write(g("document.F=Object")),y.close(),y.F);for(var x=l.length;x--;)delete m.prototype[l[x]];return m()};c[h]=!0,n.exports=Object.create||function(y,v){var x;return y!==null?(p.prototype=o(y),x=new p,p.prototype=null,x[h]=y):x=m(),v===void 0?x:s(x,v)}},function(n,r,i){var a=i(121),o=i(84);n.exports=Object.keys||function(s){return a(s,o)}},function(n,r,i){var a=i(15).f,o=i(14),s=i(5)("toStringTag");n.exports=function(l,c,f){l&&!o(l=f?l:l.prototype,s)&&a(l,s,{configurable:!0,value:c})}},function(n,r,i){var a=i(8),o=i(5),s=i(129),l=o("species");n.exports=function(c){return s>=51||!a((function(){var f=[];return(f.constructor={})[l]=function(){return{foo:1}},f[c](Boolean).foo!==1}))}},function(n,r,i){var a=i(4),o=i(122).indexOf,s=i(48),l=i(28),c=[].indexOf,f=!!c&&1/[1].indexOf(1,-0)<0,u=s("indexOf"),d=l("indexOf",{ACCESSORS:!0,1:0});a({target:"Array",proto:!0,forced:f||!u||!d},{indexOf:function(h){return f?c.apply(this,arguments)||0:o(this,h,arguments.length>1?arguments[1]:void 0)}})},function(n,r,i){var a=i(16),o=i(15).f,s=Function.prototype,l=s.toString,c=/^\s*function ([^ (]*)/;a&&!("name"in s)&&o(s,"name",{configurable:!0,get:function(){try{return l.call(this).match(c)[1]}catch{return""}}})},function(n,r,i){var a=i(25),o=i(18),s=i(8),l=i(136),c=RegExp.prototype,f=c.toString,u=s((function(){return f.call({source:"a",flags:"b"})!="/a/b"})),d=f.name!="toString";(u||d)&&a(RegExp.prototype,"toString",(function(){var h=o(this),p=String(h.source),g=h.flags;return"/"+p+"/"+String(g===void 0&&h instanceof RegExp&&!("flags"in c)?l.call(h):g)}),{unsafe:!0})},function(n,r,i){i(31),i(32),i(33),i(19),i(138),i(20),i(66),i(22),i(23);var a,o=this&&this.__extends||(a=function(u,d){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,p){h.__proto__=p}||function(h,p){for(var g in p)p.hasOwnProperty(g)&&(h[g]=p[g])})(u,d)},function(u,d){function h(){this.constructor=u}a(u,d),u.prototype=d===null?Object.create(d):(h.prototype=d.prototype,new h)}),s=this&&this.__values||function(u){var d=typeof Symbol=="function"&&Symbol.iterator,h=d&&u[d],p=0;if(h)return h.call(u);if(u&&typeof u.length=="number")return{next:function(){return u&&p>=u.length&&(u=void 0),{value:u&&u[p++],done:!u}}};throw new TypeError(d?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var l=i(1),c=i(2),f=(function(u){function d(h,p){var g=u.call(this,h)||this;return g._writerOptions=l.applyDefaults(p,{format:"object",wellFormed:!1,group:!1,verbose:!1}),g}return o(d,u),d.prototype.serialize=function(h){return this._currentList=[],this._currentIndex=0,this._listRegister=[this._currentList],this.serializeNode(h,this._writerOptions.wellFormed),this._process(this._currentList,this._writerOptions)},d.prototype._process=function(h,p){var g,m,y,v,x,w,S;if(h.length===0)return{};for(var T={},_=!1,D=0,I=0,R=0,M=0,A=0;A<h.length;A++){var L=h[A];switch(De=Object.keys(L)[0]){case"@":continue;case"#":D++;break;case"!":I++;break;case"?":R++;break;case"$":M++;break;default:T[De]?_=!0:T[De]=!0}}var P=this._getAttrKey(),B=this._getNodeKey(c.NodeType.Text),U=this._getNodeKey(c.NodeType.Comment),G=this._getNodeKey(c.NodeType.ProcessingInstruction),F=this._getNodeKey(c.NodeType.CData);if(D===1&&h.length===1&&l.isString(h[0]["#"]))return h[0]["#"];if(_){var $={};for(A=0;A<h.length;A++)if(L=h[A],(De=Object.keys(L)[0])==="@"){var V=L["@"];(q=Object.keys(V)).length===1?$[P+q[0]]=V[q[0]]:$[P]=L["@"]}var X=[];for(A=0;A<h.length;A++)switch(L=h[A],De=Object.keys(L)[0]){case"@":break;case"#":X.push(((g={})[B]=L["#"],g));break;case"!":X.push(((m={})[U]=L["!"],m));break;case"?":X.push(((y={})[G]=L["?"],y));break;case"$":X.push(((v={})[F]=L.$,v));break;default:if((J=L)[De].length!==0&&l.isArray(J[De][0])){for(var Q=[],re=J[De],ye=0;ye<re.length;ye++)Q.push(this._process(re[ye],p));X.push(((x={})[De]=Q,x))}else p.verbose?X.push(((w={})[De]=[this._process(J[De],p)],w)):X.push(((S={})[De]=this._process(J[De],p),S))}return $[B]=X,$}var me=1,Ce=1,we=1,Ae=1;for($={},A=0;A<h.length;A++){var De;switch(L=h[A],De=Object.keys(L)[0]){case"@":V=L["@"];var q=Object.keys(V);if(p.group&&q.length!==1)$[P]=V;else for(var k in V)$[P+k]=V[k];break;case"#":me=this._processSpecItem(L["#"],$,p.group,B,D,me);break;case"!":Ce=this._processSpecItem(L["!"],$,p.group,U,I,Ce);break;case"?":we=this._processSpecItem(L["?"],$,p.group,G,R,we);break;case"$":Ae=this._processSpecItem(L.$,$,p.group,F,M,Ae);break;default:var J;if((J=L)[De].length!==0&&l.isArray(J[De][0])){Q=[],re=J[De];for(var Y=0;Y<re.length;Y++)Q.push(this._process(re[Y],p));$[De]=Q}else p.verbose?$[De]=[this._process(J[De],p)]:$[De]=this._process(J[De],p)}}return $},d.prototype._processSpecItem=function(h,p,g,m,y,v){var x,w;if(!g&&l.isArray(h)&&y+h.length>2)try{for(var S=s(h),T=S.next();!T.done;T=S.next()){var _=T.value;p[m+(v++).toString()]=_}}catch(D){x={error:D}}finally{try{T&&!T.done&&(w=S.return)&&w.call(S)}finally{if(x)throw x.error}}else p[y>1?m+(v++).toString():m]=h;return v},d.prototype.beginElement=function(h){var p,g,m=[];if(this._currentList.length===0)this._currentList.push(((p={})[h]=m,p));else{var y=this._currentList[this._currentList.length-1];this._isElementNode(y,h)?y[h].length!==0&&l.isArray(y[h][0])?y[h].push(m):y[h]=[y[h],m]:this._currentList.push(((g={})[h]=m,g))}this._currentIndex++,this._listRegister.length>this._currentIndex?this._listRegister[this._currentIndex]=m:this._listRegister.push(m),this._currentList=m},d.prototype.endElement=function(){this._currentList=this._listRegister[--this._currentIndex]},d.prototype.attribute=function(h,p){var g,m;if(this._currentList.length===0)this._currentList.push({"@":(g={},g[h]=p,g)});else{var y=this._currentList[this._currentList.length-1];this._isAttrNode(y)?y["@"][h]=p:this._currentList.push({"@":(m={},m[h]=p,m)})}},d.prototype.comment=function(h){if(this._currentList.length===0)this._currentList.push({"!":h});else{var p=this._currentList[this._currentList.length-1];this._isCommentNode(p)?l.isArray(p["!"])?p["!"].push(h):p["!"]=[p["!"],h]:this._currentList.push({"!":h})}},d.prototype.text=function(h){if(this._currentList.length===0)this._currentList.push({"#":h});else{var p=this._currentList[this._currentList.length-1];this._isTextNode(p)?l.isArray(p["#"])?p["#"].push(h):p["#"]=[p["#"],h]:this._currentList.push({"#":h})}},d.prototype.instruction=function(h,p){var g=p===""?h:h+" "+p;if(this._currentList.length===0)this._currentList.push({"?":g});else{var m=this._currentList[this._currentList.length-1];this._isInstructionNode(m)?l.isArray(m["?"])?m["?"].push(g):m["?"]=[m["?"],g]:this._currentList.push({"?":g})}},d.prototype.cdata=function(h){if(this._currentList.length===0)this._currentList.push({$:h});else{var p=this._currentList[this._currentList.length-1];this._isCDATANode(p)?l.isArray(p.$)?p.$.push(h):p.$=[p.$,h]:this._currentList.push({$:h})}},d.prototype._isAttrNode=function(h){return"@"in h},d.prototype._isTextNode=function(h){return"#"in h},d.prototype._isCommentNode=function(h){return"!"in h},d.prototype._isInstructionNode=function(h){return"?"in h},d.prototype._isCDATANode=function(h){return"$"in h},d.prototype._isElementNode=function(h,p){return p in h},d.prototype._getAttrKey=function(){return this._builderOptions.convert.att},d.prototype._getNodeKey=function(h){switch(h){case c.NodeType.Comment:return this._builderOptions.convert.comment;case c.NodeType.Text:return this._builderOptions.convert.text;case c.NodeType.ProcessingInstruction:return this._builderOptions.convert.ins;case c.NodeType.CData:return this._builderOptions.convert.cdata;default:throw new Error("Invalid node type.")}},d})(i(50).BaseWriter);r.ObjectWriter=f},function(n,r,i){var a=i(4),o=i(93);a({target:"RegExp",proto:!0,forced:/./.exec!==o},{exec:o})},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=(function(){function o(){this._items={},this._nullItems={}}return o.prototype.set=function(s,l){s===null?this._nullItems[l]=!0:(this._items[s]||(this._items[s]={}),this._items[s][l]=!0)},o.prototype.has=function(s,l){return s===null?this._nullItems[l]===!0:!!this._items[s]&&this._items[s][l]===!0},o})();r.LocalNameSet=a},function(n,r,i){var a=this&&this.__read||function(f,u){var d=typeof Symbol=="function"&&f[Symbol.iterator];if(!d)return f;var h,p,g=d.call(f),m=[];try{for(;(u===void 0||u-- >0)&&!(h=g.next()).done;)m.push(h.value)}catch(y){p={error:y}}finally{try{h&&!h.done&&(d=g.return)&&d.call(g)}finally{if(p)throw p.error}}return m};Object.defineProperty(r,"__esModule",{value:!0});var o=i(9),s=i(3),l=i(0),c=(function(){function f(){}return Object.defineProperty(f.prototype,"_eventListenerList",{get:function(){return this.__eventListenerList||(this.__eventListenerList=[])},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"_eventHandlerMap",{get:function(){return this.__eventHandlerMap||(this.__eventHandlerMap={})},enumerable:!0,configurable:!0}),f.prototype.addEventListener=function(u,d,h){h===void 0&&(h={passive:!1,once:!1,capture:!1});var p,g=a(l.eventTarget_flattenMore(h),3),m=g[0],y=g[1],v=g[2];d&&(p=s.Guard.isEventListener(d)?d:{handleEvent:d},l.eventTarget_addEventListener(this,{type:u,callback:p,capture:m,passive:y,once:v,removed:!1}))},f.prototype.removeEventListener=function(u,d,h){h===void 0&&(h={capture:!1});var p=l.eventTarget_flatten(h);if(d)for(var g=0;g<this._eventListenerList.length;g++){var m=this._eventListenerList[g];if(m.type===u&&m.capture===p){if(s.Guard.isEventListener(d)&&m.callback===d){l.eventTarget_removeEventListener(this,m,g);break}if(d&&m.callback.handleEvent===d){l.eventTarget_removeEventListener(this,m,g);break}}}},f.prototype.dispatchEvent=function(u){if(u._dispatchFlag||!u._initializedFlag)throw new o.InvalidStateError;return u._isTrusted=!1,l.event_dispatch(u,this)},f.prototype._getTheParent=function(u){return null},f})();r.EventTargetImpl=c},function(n,r,i){var a,o=this&&this.__extends||(a=function(f,u){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,h){d.__proto__=h}||function(d,h){for(var p in h)h.hasOwnProperty(p)&&(d[p]=h[p])})(f,u)},function(f,u){function d(){this.constructor=f}a(f,u),f.prototype=u===null?Object.create(u):(d.prototype=u.prototype,new d)});Object.defineProperty(r,"__esModule",{value:!0});var s=i(34),l=i(0),c=(function(f){function u(d){var h=f.call(this)||this;return h._data=d,h}return o(u,f),Object.defineProperty(u.prototype,"data",{get:function(){return this._data},set:function(d){l.characterData_replaceData(this,0,this._data.length,d)},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"length",{get:function(){return this._data.length},enumerable:!0,configurable:!0}),u.prototype.substringData=function(d,h){return l.characterData_substringData(this,d,h)},u.prototype.appendData=function(d){return l.characterData_replaceData(this,this._data.length,0,d)},u.prototype.insertData=function(d,h){l.characterData_replaceData(this,d,0,h)},u.prototype.deleteData=function(d,h){l.characterData_replaceData(this,d,h,"")},u.prototype.replaceData=function(d,h,p){l.characterData_replaceData(this,d,h,p)},Object.defineProperty(u.prototype,"previousElementSibling",{get:function(){throw new Error("Mixin: NonDocumentTypeChildNode not implemented.")},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"nextElementSibling",{get:function(){throw new Error("Mixin: NonDocumentTypeChildNode not implemented.")},enumerable:!0,configurable:!0}),u.prototype.before=function(){for(var d=[],h=0;h<arguments.length;h++)d[h]=arguments[h];throw new Error("Mixin: ChildNode not implemented.")},u.prototype.after=function(){for(var d=[],h=0;h<arguments.length;h++)d[h]=arguments[h];throw new Error("Mixin: ChildNode not implemented.")},u.prototype.replaceWith=function(){for(var d=[],h=0;h<arguments.length;h++)d[h]=arguments[h];throw new Error("Mixin: ChildNode not implemented.")},u.prototype.remove=function(){throw new Error("Mixin: ChildNode not implemented.")},u})(s.NodeImpl);r.CharacterDataImpl=c},function(n,r,i){var a=this&&this.__values||function(y){var v=typeof Symbol=="function"&&Symbol.iterator,x=v&&y[v],w=0;if(x)return x.call(y);if(y&&typeof y.length=="number")return{next:function(){return y&&w>=y.length&&(y=void 0),{value:y&&y[w++],done:!y}}};throw new TypeError(v?"Object is not iterable.":"Symbol.iterator is not defined.")},o=this&&this.__read||function(y,v){var x=typeof Symbol=="function"&&y[Symbol.iterator];if(!x)return y;var w,S,T=x.call(y),_=[];try{for(;(v===void 0||v-- >0)&&!(w=T.next()).done;)_.push(w.value)}catch(D){S={error:D}}finally{try{w&&!w.done&&(x=T.return)&&x.call(T)}finally{if(S)throw S.error}}return _},s=this&&this.__spread||function(){for(var y=[],v=0;v<arguments.length;v++)y=y.concat(o(arguments[v]));return y};Object.defineProperty(r,"__esModule",{value:!0});var l=i(6),c=i(3),f=i(1),u=i(17),d=i(51);function h(y){l.dom.window._signalSlots.add(y),d.observer_queueAMutationObserverMicrotask()}function p(y,v){v===void 0&&(v=!1);var x=c.Cast.asNode(y)._parent;if(x===null)return null;var w=x._shadowRoot||null;if(w===null||v&&w._mode!=="open")return null;for(var S=u.tree_getFirstDescendantNode(w,!1,!0,(function(T){return c.Guard.isSlot(T)}));S!==null;){if(S._name===y._name)return S;S=u.tree_getNextDescendantNode(w,S,!1,!0,(function(T){return c.Guard.isSlot(T)}))}return null}function g(y){var v,x,w=[],S=u.tree_rootNode(y);if(!c.Guard.isShadowRoot(S))return w;var T=S._host;try{for(var _=a(T._children),D=_.next();!D.done;D=_.next()){var I=D.value;c.Guard.isSlotable(I)&&p(I)===y&&w.push(I)}}catch(R){v={error:R}}finally{try{D&&!D.done&&(x=_.return)&&x.call(_)}finally{if(v)throw v.error}}return w}function m(y){var v,x,w=g(y);if(w.length===y._assignedNodes.length){for(var S=!0,T=0;T<w.length;T++)if(w[T]!==y._assignedNodes[T]){S=!1;break}S||h(y)}y._assignedNodes=w;try{for(var _=a(w),D=_.next();!D.done;D=_.next())D.value._assignedSlot=y}catch(I){v={error:I}}finally{try{D&&!D.done&&(x=_.return)&&x.call(_)}finally{if(v)throw v.error}}}r.shadowTree_signalASlotChange=h,r.shadowTree_isConnected=function(y){return c.Guard.isDocumentNode(u.tree_rootNode(y,!0))},r.shadowTree_isAssigned=function(y){return y._assignedSlot!==null},r.shadowTree_findASlot=p,r.shadowTree_findSlotables=g,r.shadowTree_findFlattenedSlotables=function y(v){var x,w,S,T,_=[],D=u.tree_rootNode(v);if(!c.Guard.isShadowRoot(D))return _;var I=g(v);if(f.isEmpty(I))try{for(var R=a(v._children),M=R.next();!M.done;M=R.next()){var A=M.value;c.Guard.isSlotable(A)&&I.push(A)}}catch(G){x={error:G}}finally{try{M&&!M.done&&(w=R.return)&&w.call(R)}finally{if(x)throw x.error}}try{for(var L=a(I),P=L.next();!P.done;P=L.next()){var B=P.value;if(c.Guard.isSlot(B)&&c.Guard.isShadowRoot(u.tree_rootNode(B))){var U=y(B);_.push.apply(_,s(U))}else _.push(B)}}catch(G){S={error:G}}finally{try{P&&!P.done&&(T=L.return)&&T.call(L)}finally{if(S)throw S.error}}return _},r.shadowTree_assignSlotables=m,r.shadowTree_assignSlotablesForATree=function(y){for(var v=u.tree_getFirstDescendantNode(y,!0,!1,(function(x){return c.Guard.isSlot(x)}));v!==null;)m(v),v=u.tree_getNextDescendantNode(y,v,!0,!1,(function(x){return c.Guard.isSlot(x)}))},r.shadowTree_assignASlot=function(y){var v=p(y);v!==null&&m(v)}},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=/[a-z]([\0-\t\x2D\._a-z\xB7\xC0-\xD6\xD8-\xF6\xF8-\u037D\u037F-\u1FFF\u200C\u200D\u203F\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])*-([\0-\t\x2D\._a-z\xB7\xC0-\xD6\xD8-\xF6\xF8-\u037D\u037F-\u1FFF\u200C\u200D\u203F\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])*/,o=new Set(["annotation-xml","color-profile","font-face","font-face-src","font-face-uri","font-face-format","font-face-name","missing-glyph"]),s=new Set(["article","aside","blockquote","body","div","footer","h1","h2","h3","h4","h5","h6","header","main","nav","p","section","span"]),l=new Set(["area","base","basefont","bgsound","br","col","embed","frame","hr","img","input","keygen","link","menuitem","meta","param","source","track","wbr"]),c=new Set(["article","aside","blockquote","body","div","footer","h1","h2","h3","h4","h5","h6","header","main","nav","p","section","span"]);r.customElement_isValidCustomElementName=function(f){return!!a.test(f)&&!o.has(f)},r.customElement_isValidElementName=function(f){return s.has(f)},r.customElement_isVoidElementName=function(f){return l.has(f)},r.customElement_isValidShadowHostName=function(f){return c.has(f)},r.customElement_enqueueACustomElementUpgradeReaction=function(f,u){},r.customElement_enqueueACustomElementCallbackReaction=function(f,u,d){},r.customElement_upgrade=function(f,u){},r.customElement_tryToUpgrade=function(f){},r.customElement_lookUpACustomElementDefinition=function(f,u,d,h){return null}},function(n,r,i){i(4)({target:"String",proto:!0},{repeat:i(259)})},function(n,r,i){i(278),i(68),i(179),i(94),Object.defineProperty(r,"__esModule",{value:!0});var a=i(109),o=(function(){function s(l){this._builderOptions=l,l.parser&&Object.assign(this,l.parser)}return s.prototype._docType=function(l,c,f,u){return l.dtd({name:c,pubID:f,sysID:u})},s.prototype._comment=function(l,c){return l.com(c)},s.prototype._text=function(l,c){return l.txt(c)},s.prototype._instruction=function(l,c,f){return l.ins(c,f)},s.prototype._cdata=function(l,c){return l.dat(c)},s.prototype._element=function(l,c,f){return c===void 0?l.ele(f):l.ele(c,f)},s.prototype._attribute=function(l,c,f,u){return c===void 0?l.att(f,u):l.att(c,f,u)},s.prototype._sanitize=function(l){return a.sanitizeInput(l,this._builderOptions.invalidCharReplacement)},s.prototype._decodeText=function(l){return l==null?l:l.replace(/&(quot|amp|apos|lt|gt);/g,(function(c,f){return s._entityTable[f]})).replace(/&#(?:x([a-fA-F0-9]+)|([0-9]+));/g,(function(c,f,u){return String.fromCodePoint(parseInt(f||u,f?16:10))}))},s.prototype._decodeAttributeValue=function(l){return this._decodeText(l)},s.prototype.parse=function(l,c){return this._parse(l,c)},s.prototype.docType=function(l,c,f,u){return this._docType(l,c,f,u)},s.prototype.comment=function(l,c){return this._comment(l,c)},s.prototype.text=function(l,c){return this._text(l,c)},s.prototype.instruction=function(l,c,f){return this._instruction(l,c,f)},s.prototype.cdata=function(l,c){return this._cdata(l,c)},s.prototype.element=function(l,c,f){return this._element(l,c,f)},s.prototype.attribute=function(l,c,f,u){return this._attribute(l,c,f,u)},s.prototype.sanitize=function(l){return this._sanitize(l)},s._entityTable={lt:"<",gt:">",amp:"&",quot:'"',apos:"'"},s})();r.BaseReader=o},function(n,r,i){var a=i(39);n.exports=a.DEFAULT=new a({include:[i(54)],explicit:[i(299),i(300),i(301)]})},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(185);r.XMLBuilderImpl=a.XMLBuilderImpl;var o=i(304);r.XMLBuilderCBImpl=o.XMLBuilderCBImpl;var s=i(183);r.builder=s.builder,r.create=s.create,r.fragment=s.fragment,r.convert=s.convert;var l=i(309);r.createCB=l.createCB,r.fragmentCB=l.fragmentCB},function(n,r){var i;i=(function(){return this})();try{i=i||new Function("return this")()}catch{typeof window=="object"&&(i=window)}n.exports=i},function(n,r,i){var a={}.propertyIsEnumerable,o=Object.getOwnPropertyDescriptor,s=o&&!a.call({1:2},1);r.f=s?function(l){var c=o(this,l);return!!c&&c.enumerable}:a},function(n,r,i){var a=i(11),o=i(21);n.exports=function(s,l){try{o(a,s,l)}catch{a[s]=l}return l}},function(n,r,i){var a=i(44),o=i(118);(n.exports=function(s,l){return o[s]||(o[s]=l!==void 0?l:{})})("versions",[]).push({version:"3.6.5",mode:a?"pure":"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})},function(n,r,i){var a=i(121),o=i(84).concat("length","prototype");r.f=Object.getOwnPropertyNames||function(s){return a(s,o)}},function(n,r,i){var a=i(47),o=Math.max,s=Math.min;n.exports=function(l,c){var f=a(l);return f<0?o(f+c,0):s(f,c)}},function(n,r){n.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},function(n,r){r.f=Object.getOwnPropertySymbols},function(n,r,i){var a=i(8);n.exports=!!Object.getOwnPropertySymbols&&!a((function(){return!String(Symbol())}))},function(n,r,i){var a=i(127);n.exports=function(o,s,l){if(a(o),s===void 0)return o;switch(l){case 0:return function(){return o.call(s)};case 1:return function(c){return o.call(s,c)};case 2:return function(c,f){return o.call(s,c,f)};case 3:return function(c,f,u){return o.call(s,c,f,u)}}return function(){return o.apply(s,arguments)}}},function(n,r,i){var a=i(4),o=i(195),s=i(132),l=i(133),c=i(62),f=i(21),u=i(25),d=i(5),h=i(44),p=i(49),g=i(131),m=g.IteratorPrototype,y=g.BUGGY_SAFARI_ITERATORS,v=d("iterator"),x=function(){return this};n.exports=function(w,S,T,_,D,I,R){o(T,S,_);var M,A,L,P=function(X){if(X===D&&$)return $;if(!y&&X in G)return G[X];switch(X){case"keys":case"values":case"entries":return function(){return new T(this,X)}}return function(){return new T(this)}},B=S+" Iterator",U=!1,G=w.prototype,F=G[v]||G["@@iterator"]||D&&G[D],$=!y&&F||P(D),V=S=="Array"&&G.entries||F;if(V&&(M=s(V.call(new w)),m!==Object.prototype&&M.next&&(h||s(M)===m||(l?l(M,m):typeof M[v]!="function"&&f(M,v,x)),c(M,B,!0,!0),h&&(p[B]=x))),D=="values"&&F&&F.name!=="values"&&(U=!0,$=function(){return F.call(this)}),h&&!R||G[v]===$||f(G,v,$),p[S]=$,D)if(A={values:P("values"),keys:I?$:P("keys"),entries:P("entries")},R)for(L in A)(y||U||!(L in G))&&u(G,L,A[L]);else a({target:S,proto:!0,forced:y||U},A);return A}},function(n,r,i){var a=i(4),o=i(13),s=i(59),l=i(83),c=i(26),f=i(24),u=i(134),d=i(5),h=i(63),p=i(28),g=h("slice"),m=p("slice",{ACCESSORS:!0,0:0,1:2}),y=d("species"),v=[].slice,x=Math.max;a({target:"Array",proto:!0,forced:!g||!m},{slice:function(w,S){var T,_,D,I=f(this),R=c(I.length),M=l(w,R),A=l(S===void 0?R:S,R);if(s(I)&&(typeof(T=I.constructor)!="function"||T!==Array&&!s(T.prototype)?o(T)&&(T=T[y])===null&&(T=void 0):T=void 0,T===Array||T===void 0))return v.call(I,M,A);for(_=new(T===void 0?Array:T)(x(A-M,0)),D=0;M<A;M++,D++)M in I&&u(_,D,I[M]);return _.length=D,_}})},function(n,r,i){var a={};a[i(5)("toStringTag")]="z",n.exports=String(a)==="[object z]"},function(n,r,i){i(19),i(138),i(20),i(92),i(22),i(23),Object.defineProperty(r,"__esModule",{value:!0}),r.DefaultBuilderOptions={version:"1.0",encoding:void 0,standalone:void 0,keepNullNodes:!1,keepNullAttributes:!1,ignoreConverters:!1,convert:{att:"@",ins:"?",text:"#",cdata:"$",comment:"!"},defaultNamespace:{ele:void 0,att:void 0},namespaceAlias:{html:"http://www.w3.org/1999/xhtml",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",mathml:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink"},invalidCharReplacement:void 0,parser:void 0},r.XMLBuilderOptionKeys=new Set(Object.keys(r.DefaultBuilderOptions)),r.DefaultXMLBuilderCBOptions={format:"xml",wellFormed:!1,prettyPrint:!1,indent:"  ",newline:`
`,offset:0,width:0,allowEmptyTags:!1,spaceBeforeSlash:!1,keepNullNodes:!1,keepNullAttributes:!1,ignoreConverters:!1,convert:{att:"@",ins:"?",text:"#",cdata:"$",comment:"!"},defaultNamespace:{ele:void 0,att:void 0},namespaceAlias:{html:"http://www.w3.org/1999/xhtml",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",mathml:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink"}}},function(n,r,i){var a=i(139),o=i(143);n.exports=a("Set",(function(s){return function(){return s(this,arguments.length?arguments[0]:void 0)}}),o)},function(n,r,i){var a,o,s=i(136),l=i(221),c=RegExp.prototype.exec,f=String.prototype.replace,u=c,d=(a=/a/,o=/b*/g,c.call(a,"a"),c.call(o,"a"),a.lastIndex!==0||o.lastIndex!==0),h=l.UNSUPPORTED_Y||l.BROKEN_CARET,p=/()??/.exec("")[1]!==void 0;(d||p||h)&&(u=function(g){var m,y,v,x,w=this,S=h&&w.sticky,T=s.call(w),_=w.source,D=0,I=g;return S&&((T=T.replace("y","")).indexOf("g")===-1&&(T+="g"),I=String(g).slice(w.lastIndex),w.lastIndex>0&&(!w.multiline||w.multiline&&g[w.lastIndex-1]!==`
`)&&(_="(?: "+_+")",I=" "+I,D++),y=new RegExp("^(?:"+_+")",T)),p&&(y=new RegExp("^"+_+"$(?!\\s)",T)),d&&(m=w.lastIndex),v=c.call(S?y:w,I),S?v?(v.input=v.input.slice(D),v[0]=v[0].slice(D),v.index=w.lastIndex,w.lastIndex+=v[0].length):w.lastIndex=0:d&&v&&(w.lastIndex=w.global?v.index+v[0].length:m),p&&v&&v.length>1&&f.call(v[0],y,(function(){for(x=1;x<arguments.length-2;x++)arguments[x]===void 0&&(v[x]=void 0)})),v}),n.exports=u},function(n,r,i){var a=i(225),o=i(18),s=i(27),l=i(26),c=i(47),f=i(35),u=i(226),d=i(227),h=Math.max,p=Math.min,g=Math.floor,m=/\$([$&'`]|\d\d?|<[^>]*>)/g,y=/\$([$&'`]|\d\d?)/g;a("replace",2,(function(v,x,w,S){var T=S.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,_=S.REPLACE_KEEPS_$0,D=T?"$":"$0";return[function(R,M){var A=f(this),L=R?.[v];return L!==void 0?L.call(R,A,M):x.call(String(A),R,M)},function(R,M){if(!T&&_||typeof M=="string"&&M.indexOf(D)===-1){var A=w(x,R,this,M);if(A.done)return A.value}var L=o(R),P=String(this),B=typeof M=="function";B||(M=String(M));var U=L.global;if(U){var G=L.unicode;L.lastIndex=0}for(var F=[];;){var $=d(L,P);if($===null||(F.push($),!U))break;String($[0])===""&&(L.lastIndex=u(P,l(L.lastIndex),G))}for(var V,X="",Q=0,re=0;re<F.length;re++){$=F[re];for(var ye=String($[0]),me=h(p(c($.index),P.length),0),Ce=[],we=1;we<$.length;we++)Ce.push((V=$[we])===void 0?V:String(V));var Ae=$.groups;if(B){var De=[ye].concat(Ce,me,P);Ae!==void 0&&De.push(Ae);var q=String(M.apply(void 0,De))}else q=I(ye,P,me,Ce,Ae,M);me>=Q&&(X+=P.slice(Q,me)+q,Q=me+ye.length)}return X+P.slice(Q)}];function I(R,M,A,L,P,B){var U=A+R.length,G=L.length,F=y;return P!==void 0&&(P=s(P),F=m),x.call(B,F,(function($,V){var X;switch(V.charAt(0)){case"$":return"$";case"&":return R;case"`":return M.slice(0,A);case"'":return M.slice(U);case"<":X=P[V.slice(1,-1)];break;default:var Q=+V;if(Q===0)return $;if(Q>G){var re=g(Q/10);return re===0?$:re<=G?L[re-1]===void 0?V.charAt(1):L[re-1]+V.charAt(1):$}X=L[Q-1]}return X===void 0?"":X}))}}))},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=(function(){function o(){this._items={},this._nullItems=[]}return o.prototype.copy=function(){var s=new o;for(var l in this._items)s._items[l]=this._items[l].slice(0);return s._nullItems=this._nullItems.slice(0),s},o.prototype.get=function(s,l){var c=l===null?this._nullItems:this._items[l]||null;if(c===null)return null;for(var f=null,u=0;u<c.length;u++)if((f=c[u])===s)return f;return f},o.prototype.has=function(s,l){var c=l===null?this._nullItems:this._items[l]||null;return c!==null&&c.indexOf(s)!==-1},o.prototype.hasPrefix=function(s){if(this._nullItems.indexOf(s)!==-1)return!0;for(var l in this._items)if(this._items[l].indexOf(s)!==-1)return!0;return!1},o.prototype.set=function(s,l){var c=l===null?this._nullItems:this._items[l]||null;l!==null&&c===null?this._items[l]=[s]:c.push(s)},o})();r.NamespacePrefixMap=a},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.Surrogate=/[\uD800-\uDFFF]/,r.ScalarValue=/[\uD800-\uDFFF]/,r.NonCharacter=/[\uFDD0-\uFDEF\uFFFE\uFFFF]|[\uD83F\uD87F\uD8BF\uD8FF\uD93F\uD97F\uD9BF\uD9FF\uDA3F\uDA7F\uDABF\uDAFF\uDB3F\uDB7F\uDBBF\uDBFF][\uDFFE\uDFFF]/,r.ASCIICodePoint=/[\u0000-\u007F]/,r.ASCIITabOrNewLine=/[\t\n\r]/,r.ASCIIWhiteSpace=/[\t\n\f\r ]/,r.C0Control=/[\u0000-\u001F]/,r.C0ControlOrSpace=/[\u0000-\u001F ]/,r.Control=/[\u0000-\u001F\u007F-\u009F]/,r.ASCIIDigit=/[0-9]/,r.ASCIIUpperHexDigit=/[0-9A-F]/,r.ASCIILowerHexDigit=/[0-9a-f]/,r.ASCIIHexDigit=/[0-9A-Fa-f]/,r.ASCIIUpperAlpha=/[A-Z]/,r.ASCIILowerAlpha=/[a-z]/,r.ASCIIAlpha=/[A-Za-z]/,r.ASCIIAlphanumeric=/[0-9A-Za-z]/},function(n,r,i){var a=this&&this.__values||function(M){var A=typeof Symbol=="function"&&Symbol.iterator,L=A&&M[A],P=0;if(L)return L.call(M);if(M&&typeof M.length=="number")return{next:function(){return M&&P>=M.length&&(M=void 0),{value:M&&M[P++],done:!M}}};throw new TypeError(A?"Object is not iterable.":"Symbol.iterator is not defined.")},o=this&&this.__read||function(M,A){var L=typeof Symbol=="function"&&M[Symbol.iterator];if(!L)return M;var P,B,U=L.call(M),G=[];try{for(;(A===void 0||A-- >0)&&!(P=U.next()).done;)G.push(P.value)}catch(F){B={error:F}}finally{try{P&&!P.done&&(L=U.return)&&L.call(U)}finally{if(B)throw B.error}}return G},s=this&&this.__spread||function(){for(var M=[],A=0;A<arguments.length;A++)M=M.concat(o(arguments[A]));return M};Object.defineProperty(r,"__esModule",{value:!0});var l=i(6),c=i(2),f=i(3),u=i(171),d=i(104),h=i(9),p=i(17),g=i(72),m=i(30);function y(M,A){A===void 0&&(A=void 0),A===void 0&&(A=null);var L=v(M,A,new Date,{});return L._isTrusted=!0,L}function v(M,A,L,P){var B=new M("");return B._initializedFlag=!0,B._timeStamp=L.getTime(),Object.assign(B,P),l.dom.features.steps&&m.dom_runEventConstructingSteps(B),B}function x(M,A,L,P){var B,U,G,F;L===void 0&&(L=!1),P===void 0&&(P={value:!1});var $=!1;M._dispatchFlag=!0;var V=A;if(L){var X=A._associatedDocument;f.Guard.isDocumentNode(X)&&(V=X)}var Q=null,re=p.tree_retarget(M._relatedTarget,A);if(A!==re||A===M._relatedTarget){var ye=[];try{for(var me=a(M._touchTargetList),Ce=me.next();!Ce.done;Ce=me.next()){var we=Ce.value;ye.push(p.tree_retarget(we,A))}}catch(He){B={error:He}}finally{try{Ce&&!Ce.done&&(U=me.return)&&U.call(me)}finally{if(B)throw B.error}}w(M,A,V,re,ye,!1);var Ae=f.Guard.isMouseEvent(M)&&M._type==="click";Ae&&A._activationBehavior!==void 0&&(Q=A);for(var De=f.Guard.isSlotable(A)&&g.shadowTree_isAssigned(A)?A:null,q=!1,k=A._getTheParent(M);k!==null&&f.Guard.isNode(k);){if(De!==null){if(!f.Guard.isSlot(k))throw new Error("Parent node of a slotable should be a slot.");De=null;var J=p.tree_rootNode(k,!0);f.Guard.isShadowRoot(J)&&J._mode==="closed"&&(q=!0)}f.Guard.isSlotable(k)&&g.shadowTree_isAssigned(k)&&(De=k),re=p.tree_retarget(M._relatedTarget,k),ye=[];try{for(var Y=(G=void 0,a(M._touchTargetList)),ie=Y.next();!ie.done;ie=Y.next())we=ie.value,ye.push(p.tree_retarget(we,k))}catch(He){G={error:He}}finally{try{ie&&!ie.done&&(F=Y.return)&&F.call(Y)}finally{if(G)throw G.error}}f.Guard.isWindow(k)||f.Guard.isNode(k)&&f.Guard.isNode(A)&&p.tree_isAncestorOf(p.tree_rootNode(A,!0),k,!0,!0)?(Ae&&M._bubbles&&Q===null&&k._activationBehavior&&(Q=k),w(M,k,null,re,ye,q)):k===re?k=null:(A=k,Ae&&Q===null&&A._activationBehavior&&(Q=A),w(M,k,A,re,ye,q)),k!==null&&(k=k._getTheParent(M)),q=!1}for(var ue=null,fe=M._path,Se=fe.length-1;Se>=0;Se--)if((Ke=fe[Se]).shadowAdjustedTarget!==null){ue=Ke;break}if(ue!==null)if(f.Guard.isNode(ue.shadowAdjustedTarget)&&f.Guard.isShadowRoot(p.tree_rootNode(ue.shadowAdjustedTarget,!0)))$=!0;else if(f.Guard.isNode(ue.relatedTarget)&&f.Guard.isShadowRoot(p.tree_rootNode(ue.relatedTarget,!0)))$=!0;else for(var Fe=0;Fe<ue.touchTargetList.length;Fe++){var Ke=ue.touchTargetList[Fe];if(f.Guard.isNode(Ke)&&f.Guard.isShadowRoot(p.tree_rootNode(Ke,!0))){$=!0;break}}for(Q!==null&&Q._legacyPreActivationBehavior!==void 0&&Q._legacyPreActivationBehavior(M),Se=fe.length-1;Se>=0;Se--)(Ke=fe[Se]).shadowAdjustedTarget!==null?M._eventPhase=c.EventPhase.AtTarget:M._eventPhase=c.EventPhase.Capturing,S(Ke,M,"capturing",P);for(Se=0;Se<fe.length;Se++){if((Ke=fe[Se]).shadowAdjustedTarget!==null)M._eventPhase=c.EventPhase.AtTarget;else{if(!M._bubbles)continue;M._eventPhase=c.EventPhase.Bubbling}S(Ke,M,"bubbling",P)}}return M._eventPhase=c.EventPhase.None,M._currentTarget=null,M._path=[],M._dispatchFlag=!1,M._stopPropagationFlag=!1,M._stopImmediatePropagationFlag=!1,$&&(M._target=null,M._relatedTarget=null,M._touchTargetList=[]),Q!==null&&(M._canceledFlag||Q._activationBehavior===void 0?Q._legacyCanceledActivationBehavior!==void 0&&Q._legacyCanceledActivationBehavior(M):Q._activationBehavior(M)),!M._canceledFlag}function w(M,A,L,P,B,U){var G=!1;f.Guard.isNode(A)&&f.Guard.isShadowRoot(p.tree_rootNode(A))&&(G=!0);var F=!1;f.Guard.isShadowRoot(A)&&A._mode==="closed"&&(F=!0),M._path.push({invocationTarget:A,invocationTargetInShadowTree:G,shadowAdjustedTarget:L,relatedTarget:P,touchTargetList:B,rootOfClosedTree:F,slotInClosedTree:U})}function S(M,A,L,P){P===void 0&&(P={value:!1});for(var B=A._path,U=-1,G=0;G<B.length;G++)if(B[G]===M){U=G;break}if(U!==-1){var F=B[U];(F.shadowAdjustedTarget!==null||U>0&&(F=B[U-1]).shadowAdjustedTarget!==null)&&(A._target=F.shadowAdjustedTarget)}if(A._relatedTarget=M.relatedTarget,A._touchTargetList=M.touchTargetList,!A._stopPropagationFlag){A._currentTarget=M.invocationTarget;var $=A._currentTarget._eventListenerList,V=new(Array.bind.apply(Array,s([void 0],$)));if(!T(A,V,L,M,P)&&A._isTrusted){var X=A._type;X==="animationend"?A._type="webkitAnimationEnd":X==="animationiteration"?A._type="webkitAnimationIteration":X==="animationstart"?A._type="webkitAnimationStart":X==="transitionend"&&(A._type="webkitTransitionEnd"),T(A,V,L,M,P),A._type=X}}}function T(M,A,L,P,B){B===void 0&&(B={value:!1});for(var U=!1,G=0;G<A.length;G++){var F=A[G];if(!F.removed){if(M._type!==F.type||(U=!0,L==="capturing"&&!F.capture)||L==="bubbling"&&F.capture)continue;if(F.once&&M._currentTarget!==null){for(var $=M._currentTarget,V=-1,X=0;X<$._eventListenerList.length;X++)if($._eventListenerList[X]===F){V=X;break}V!==-1&&$._eventListenerList.splice(V,1)}var Q=void 0,re=void 0;f.Guard.isWindow(Q)&&(re=Q._currentEvent,P.invocationTargetInShadowTree===!1&&(Q._currentEvent=M)),F.passive&&(M._inPassiveListenerFlag=!0);try{F.callback.handleEvent.call(M._currentTarget,M)}catch{B.value=!0}if(F.passive&&(M._inPassiveListenerFlag=!1),f.Guard.isWindow(Q)&&(Q._currentEvent=re),M._stopImmediatePropagationFlag)return U}}return U}function _(M,A){return null}function D(M,A){return null}function I(M,A){}function R(M,A){}r.event_setTheCanceledFlag=function(M){M._cancelable&&!M._inPassiveListenerFlag&&(M._canceledFlag=!0)},r.event_initialize=function(M,A,L,P){M._initializedFlag=!0,M._stopPropagationFlag=!1,M._stopImmediatePropagationFlag=!1,M._canceledFlag=!1,M._isTrusted=!1,M._target=null,M._type=A,M._bubbles=L,M._cancelable=P},r.event_createAnEvent=y,r.event_innerEventCreationSteps=v,r.event_dispatch=x,r.event_appendToAnEventPath=w,r.event_invoke=S,r.event_innerInvoke=T,r.event_fireAnEvent=function(M,A,L,P,B){L===void 0&&(L=d.EventImpl);var U=y(L);if(U._type=M,P)for(var G in P)U[G]=P[G];return x(U,A,B)},r.event_createLegacyEvent=function(M){var A=null;switch(M.toLowerCase()){case"beforeunloadevent":case"compositionevent":break;case"customevent":A=u.CustomEventImpl;break;case"devicemotionevent":case"deviceorientationevent":case"dragevent":break;case"event":case"events":A=d.EventImpl}if(A===null)throw new h.NotSupportedError("Event constructor not found for interface "+M+".");var L=new A("");return L._type="",L._timeStamp=new Date().getTime(),L._isTrusted=!1,L._initializedFlag=!1,L},r.event_getterEventHandlerIDLAttribute=function(M,A){return null},r.event_setterEventHandlerIDLAttribute=function(M,A,L){},r.event_determineTheTargetOfAnEventHandler=_,r.event_getTheCurrentValueOfAnEventHandler=D,r.event_activateAnEventHandler=I,r.event_deactivateAnEventHandler=R},function(n,r,i){var a,o=this&&this.__extends||(a=function(w,S){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(T,_){T.__proto__=_}||function(T,_){for(var D in _)_.hasOwnProperty(D)&&(T[D]=_[D])})(w,S)},function(w,S){function T(){this.constructor=w}a(w,S),w.prototype=S===null?Object.create(S):(T.prototype=S.prototype,new T)}),s=this&&this.__values||function(w){var S=typeof Symbol=="function"&&Symbol.iterator,T=S&&w[S],_=0;if(T)return T.call(w);if(w&&typeof w.length=="number")return{next:function(){return w&&_>=w.length&&(w=void 0),{value:w&&w[_++],done:!w}}};throw new TypeError(S?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(w,S){var T=typeof Symbol=="function"&&w[Symbol.iterator];if(!T)return w;var _,D,I=T.call(w),R=[];try{for(;(S===void 0||S-- >0)&&!(_=I.next()).done;)R.push(_.value)}catch(M){D={error:M}}finally{try{_&&!_.done&&(T=I.return)&&T.call(I)}finally{if(D)throw D.error}}return R};Object.defineProperty(r,"__esModule",{value:!0});var c=i(6),f=i(2),u=i(9),d=i(34),h=i(3),p=i(1),g=i(7),m=i(152),y=i(0),v=i(12),x=(function(w){function S(){var T=w.call(this)||this;return T._children=new Set,T._encoding={name:"UTF-8",labels:["unicode-1-1-utf-8","utf-8","utf8"]},T._contentType="application/xml",T._URL={scheme:"about",username:"",password:"",host:null,port:null,path:["blank"],query:null,fragment:null,_cannotBeABaseURLFlag:!0,_blobURLEntry:null},T._origin=null,T._type="xml",T._mode="no-quirks",T._documentElement=null,T._hasNamespaces=!1,T._nodeDocumentOverwrite=null,T}return o(S,w),Object.defineProperty(S.prototype,"_nodeDocument",{get:function(){return this._nodeDocumentOverwrite||this},set:function(T){this._nodeDocumentOverwrite=T},enumerable:!0,configurable:!0}),Object.defineProperty(S.prototype,"implementation",{get:function(){return this._implementation||(this._implementation=y.create_domImplementation(this))},enumerable:!0,configurable:!0}),Object.defineProperty(S.prototype,"URL",{get:function(){return m.urlSerializer(this._URL)},enumerable:!0,configurable:!0}),Object.defineProperty(S.prototype,"documentURI",{get:function(){return this.URL},enumerable:!0,configurable:!0}),Object.defineProperty(S.prototype,"origin",{get:function(){return"null"},enumerable:!0,configurable:!0}),Object.defineProperty(S.prototype,"compatMode",{get:function(){return this._mode==="quirks"?"BackCompat":"CSS1Compat"},enumerable:!0,configurable:!0}),Object.defineProperty(S.prototype,"characterSet",{get:function(){return this._encoding.name},enumerable:!0,configurable:!0}),Object.defineProperty(S.prototype,"charset",{get:function(){return this._encoding.name},enumerable:!0,configurable:!0}),Object.defineProperty(S.prototype,"inputEncoding",{get:function(){return this._encoding.name},enumerable:!0,configurable:!0}),Object.defineProperty(S.prototype,"contentType",{get:function(){return this._contentType},enumerable:!0,configurable:!0}),Object.defineProperty(S.prototype,"doctype",{get:function(){var T,_;try{for(var D=s(this._children),I=D.next();!I.done;I=D.next()){var R=I.value;if(h.Guard.isDocumentTypeNode(R))return R}}catch(M){T={error:M}}finally{try{I&&!I.done&&(_=D.return)&&_.call(D)}finally{if(T)throw T.error}}return null},enumerable:!0,configurable:!0}),Object.defineProperty(S.prototype,"documentElement",{get:function(){return this._documentElement},enumerable:!0,configurable:!0}),S.prototype.getElementsByTagName=function(T){return y.node_listOfElementsWithQualifiedName(T,this)},S.prototype.getElementsByTagNameNS=function(T,_){return y.node_listOfElementsWithNamespace(T,_,this)},S.prototype.getElementsByClassName=function(T){return y.node_listOfElementsWithClassNames(T,this)},S.prototype.createElement=function(T,_){if(!y.xml_isName(T))throw new u.InvalidCharacterError;this._type==="html"&&(T=T.toLowerCase());var D=null;_!==void 0&&(D=p.isString(_)?_:_.is);var I=this._type==="html"||this._contentType==="application/xhtml+xml"?g.namespace.HTML:null;return y.element_createAnElement(this,T,I,null,D,!0)},S.prototype.createElementNS=function(T,_,D){return y.document_internalCreateElementNS(this,T,_,D)},S.prototype.createDocumentFragment=function(){return y.create_documentFragment(this)},S.prototype.createTextNode=function(T){return y.create_text(this,T)},S.prototype.createCDATASection=function(T){if(this._type==="html")throw new u.NotSupportedError;if(T.indexOf("]]>")!==-1)throw new u.InvalidCharacterError;return y.create_cdataSection(this,T)},S.prototype.createComment=function(T){return y.create_comment(this,T)},S.prototype.createProcessingInstruction=function(T,_){if(!y.xml_isName(T))throw new u.InvalidCharacterError;if(_.indexOf("?>")!==-1)throw new u.InvalidCharacterError;return y.create_processingInstruction(this,T,_)},S.prototype.importNode=function(T,_){if(_===void 0&&(_=!1),h.Guard.isDocumentNode(T)||h.Guard.isShadowRoot(T))throw new u.NotSupportedError;return y.node_clone(T,this,_)},S.prototype.adoptNode=function(T){if(h.Guard.isDocumentNode(T))throw new u.NotSupportedError;if(h.Guard.isShadowRoot(T))throw new u.HierarchyRequestError;return y.document_adopt(T,this),T},S.prototype.createAttribute=function(T){if(!y.xml_isName(T))throw new u.InvalidCharacterError;return this._type==="html"&&(T=T.toLowerCase()),y.create_attr(this,T)},S.prototype.createAttributeNS=function(T,_){var D=l(y.namespace_validateAndExtract(T,_),3),I=D[0],R=D[1],M=D[2],A=y.create_attr(this,M);return A._namespace=I,A._namespacePrefix=R,A},S.prototype.createEvent=function(T){return y.event_createLegacyEvent(T)},S.prototype.createRange=function(){var T=y.create_range();return T._start=[this,0],T._end=[this,0],T},S.prototype.createNodeIterator=function(T,_,D){_===void 0&&(_=f.WhatToShow.All),D===void 0&&(D=null);var I=y.create_nodeIterator(T,T,!0);return I._whatToShow=_,I._iteratorCollection=y.create_nodeList(T),p.isFunction(D)?(I._filter=y.create_nodeFilter(),I._filter.acceptNode=D):I._filter=D,I},S.prototype.createTreeWalker=function(T,_,D){_===void 0&&(_=f.WhatToShow.All),D===void 0&&(D=null);var I=y.create_treeWalker(T,T);return I._whatToShow=_,p.isFunction(D)?(I._filter=y.create_nodeFilter(),I._filter.acceptNode=D):I._filter=D,I},S.prototype._getTheParent=function(T){return T._type==="load"?null:c.dom.window},S.prototype.getElementById=function(T){throw new Error("Mixin: NonElementParentNode not implemented.")},Object.defineProperty(S.prototype,"children",{get:function(){throw new Error("Mixin: ParentNode not implemented.")},enumerable:!0,configurable:!0}),Object.defineProperty(S.prototype,"firstElementChild",{get:function(){throw new Error("Mixin: ParentNode not implemented.")},enumerable:!0,configurable:!0}),Object.defineProperty(S.prototype,"lastElementChild",{get:function(){throw new Error("Mixin: ParentNode not implemented.")},enumerable:!0,configurable:!0}),Object.defineProperty(S.prototype,"childElementCount",{get:function(){throw new Error("Mixin: ParentNode not implemented.")},enumerable:!0,configurable:!0}),S.prototype.prepend=function(){for(var T=[],_=0;_<arguments.length;_++)T[_]=arguments[_];throw new Error("Mixin: ParentNode not implemented.")},S.prototype.append=function(){for(var T=[],_=0;_<arguments.length;_++)T[_]=arguments[_];throw new Error("Mixin: ParentNode not implemented.")},S.prototype.querySelector=function(T){throw new Error("Mixin: ParentNode not implemented.")},S.prototype.querySelectorAll=function(T){throw new Error("Mixin: ParentNode not implemented.")},S})(d.NodeImpl);r.DocumentImpl=x,v.idl_defineConst(x.prototype,"_nodeType",f.NodeType.Document)},function(n,r,i){var a,o=this&&this.__extends||(a=function(m,y){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,x){v.__proto__=x}||function(v,x){for(var w in x)x.hasOwnProperty(w)&&(v[w]=x[w])})(m,y)},function(m,y){function v(){this.constructor=m}a(m,y),m.prototype=y===null?Object.create(y):(v.prototype=y.prototype,new v)}),s=this&&this.__values||function(m){var y=typeof Symbol=="function"&&Symbol.iterator,v=y&&m[y],x=0;if(v)return v.call(m);if(m&&typeof m.length=="number")return{next:function(){return m&&x>=m.length&&(m=void 0),{value:m&&m[x++],done:!m}}};throw new TypeError(y?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(m,y){var v=typeof Symbol=="function"&&m[Symbol.iterator];if(!v)return m;var x,w,S=v.call(m),T=[];try{for(;(y===void 0||y-- >0)&&!(x=S.next()).done;)T.push(x.value)}catch(_){w={error:_}}finally{try{x&&!x.done&&(v=S.return)&&v.call(S)}finally{if(w)throw w.error}}return T};Object.defineProperty(r,"__esModule",{value:!0});var c=i(2),f=i(34),u=i(9),d=i(7),h=i(0),p=i(12),g=(function(m){function y(){var v=m.call(this)||this;return v._children=new Set,v._namespace=null,v._namespacePrefix=null,v._localName="",v._customElementState="undefined",v._customElementDefinition=null,v._is=null,v._shadowRoot=null,v._attributeList=h.create_namedNodeMap(v),v._attributeChangeSteps=[],v._name="",v._assignedSlot=null,v}return o(y,m),Object.defineProperty(y.prototype,"namespaceURI",{get:function(){return this._namespace},enumerable:!0,configurable:!0}),Object.defineProperty(y.prototype,"prefix",{get:function(){return this._namespacePrefix},enumerable:!0,configurable:!0}),Object.defineProperty(y.prototype,"localName",{get:function(){return this._localName},enumerable:!0,configurable:!0}),Object.defineProperty(y.prototype,"tagName",{get:function(){return this._htmlUppercasedQualifiedName},enumerable:!0,configurable:!0}),Object.defineProperty(y.prototype,"id",{get:function(){return h.element_getAnAttributeValue(this,"id")},set:function(v){h.element_setAnAttributeValue(this,"id",v)},enumerable:!0,configurable:!0}),Object.defineProperty(y.prototype,"className",{get:function(){return h.element_getAnAttributeValue(this,"class")},set:function(v){h.element_setAnAttributeValue(this,"class",v)},enumerable:!0,configurable:!0}),Object.defineProperty(y.prototype,"classList",{get:function(){var v=h.element_getAnAttributeByName("class",this);return v===null&&(v=h.create_attr(this._nodeDocument,"class")),h.create_domTokenList(this,v)},enumerable:!0,configurable:!0}),Object.defineProperty(y.prototype,"slot",{get:function(){return h.element_getAnAttributeValue(this,"slot")},set:function(v){h.element_setAnAttributeValue(this,"slot",v)},enumerable:!0,configurable:!0}),y.prototype.hasAttributes=function(){return this._attributeList.length!==0},Object.defineProperty(y.prototype,"attributes",{get:function(){return this._attributeList},enumerable:!0,configurable:!0}),y.prototype.getAttributeNames=function(){var v,x,w=[];try{for(var S=s(this._attributeList),T=S.next();!T.done;T=S.next()){var _=T.value;w.push(_._qualifiedName)}}catch(D){v={error:D}}finally{try{T&&!T.done&&(x=S.return)&&x.call(S)}finally{if(v)throw v.error}}return w},y.prototype.getAttribute=function(v){var x=h.element_getAnAttributeByName(v,this);return x?x._value:null},y.prototype.getAttributeNS=function(v,x){var w=h.element_getAnAttributeByNamespaceAndLocalName(v,x,this);return w?w._value:null},y.prototype.setAttribute=function(v,x){if(!h.xml_isName(v))throw new u.InvalidCharacterError;this._namespace===d.namespace.HTML&&this._nodeDocument._type==="html"&&(v=v.toLowerCase());for(var w=null,S=0;S<this._attributeList.length;S++){var T=this._attributeList[S];if(T._qualifiedName===v){w=T;break}}if(w===null)return(w=h.create_attr(this._nodeDocument,v))._value=x,void h.element_append(w,this);h.element_change(w,this,x)},y.prototype.setAttributeNS=function(v,x,w){var S=l(h.namespace_validateAndExtract(v,x),3),T=S[0],_=S[1],D=S[2];h.element_setAnAttributeValue(this,D,w,_,T)},y.prototype.removeAttribute=function(v){h.element_removeAnAttributeByName(v,this)},y.prototype.removeAttributeNS=function(v,x){h.element_removeAnAttributeByNamespaceAndLocalName(v,x,this)},y.prototype.hasAttribute=function(v){this._namespace===d.namespace.HTML&&this._nodeDocument._type==="html"&&(v=v.toLowerCase());for(var x=0;x<this._attributeList.length;x++)if(this._attributeList[x]._qualifiedName===v)return!0;return!1},y.prototype.toggleAttribute=function(v,x){if(!h.xml_isName(v))throw new u.InvalidCharacterError;this._namespace===d.namespace.HTML&&this._nodeDocument._type==="html"&&(v=v.toLowerCase());for(var w=null,S=0;S<this._attributeList.length;S++){var T=this._attributeList[S];if(T._qualifiedName===v){w=T;break}}return w===null?(x===void 0||x===!0)&&((w=h.create_attr(this._nodeDocument,v))._value="",h.element_append(w,this),!0):x!==void 0&&x!==!1||(h.element_removeAnAttributeByName(v,this),!1)},y.prototype.hasAttributeNS=function(v,x){for(var w=v||null,S=0;S<this._attributeList.length;S++){var T=this._attributeList[S];if(T._namespace===w&&T._localName===x)return!0}return!1},y.prototype.getAttributeNode=function(v){return h.element_getAnAttributeByName(v,this)},y.prototype.getAttributeNodeNS=function(v,x){return h.element_getAnAttributeByNamespaceAndLocalName(v,x,this)},y.prototype.setAttributeNode=function(v){return h.element_setAnAttribute(v,this)},y.prototype.setAttributeNodeNS=function(v){return h.element_setAnAttribute(v,this)},y.prototype.removeAttributeNode=function(v){for(var x=!1,w=0;w<this._attributeList.length;w++)if(this._attributeList[w]===v){x=!0;break}if(!x)throw new u.NotFoundError;return h.element_remove(v,this),v},y.prototype.attachShadow=function(v){if(this._namespace!==d.namespace.HTML)throw new u.NotSupportedError;if(!h.customElement_isValidCustomElementName(this._localName)&&!h.customElement_isValidShadowHostName(this._localName))throw new u.NotSupportedError;if(h.customElement_isValidCustomElementName(this._localName)||this._is!==null){var x=h.customElement_lookUpACustomElementDefinition(this._nodeDocument,this._namespace,this._localName,this._is);if(x!==null&&x.disableShadow===!0)throw new u.NotSupportedError}if(this._shadowRoot!==null)throw new u.NotSupportedError;var w=h.create_shadowRoot(this._nodeDocument,this);return w._mode=v.mode,this._shadowRoot=w,w},Object.defineProperty(y.prototype,"shadowRoot",{get:function(){var v=this._shadowRoot;return v===null||v.mode==="closed"?null:v},enumerable:!0,configurable:!0}),y.prototype.closest=function(v){throw new u.NotImplementedError},y.prototype.matches=function(v){throw new u.NotImplementedError},y.prototype.webkitMatchesSelector=function(v){return this.matches(v)},y.prototype.getElementsByTagName=function(v){return h.node_listOfElementsWithQualifiedName(v,this)},y.prototype.getElementsByTagNameNS=function(v,x){return h.node_listOfElementsWithNamespace(v,x,this)},y.prototype.getElementsByClassName=function(v){return h.node_listOfElementsWithClassNames(v,this)},y.prototype.insertAdjacentElement=function(v,x){return h.element_insertAdjacent(this,v,x)},y.prototype.insertAdjacentText=function(v,x){var w=h.create_text(this._nodeDocument,x);h.element_insertAdjacent(this,v,w)},Object.defineProperty(y.prototype,"_qualifiedName",{get:function(){return this._namespacePrefix?this._namespacePrefix+":"+this._localName:this._localName},enumerable:!0,configurable:!0}),Object.defineProperty(y.prototype,"_htmlUppercasedQualifiedName",{get:function(){var v=this._qualifiedName;return this._namespace===d.namespace.HTML&&this._nodeDocument._type==="html"&&(v=v.toUpperCase()),v},enumerable:!0,configurable:!0}),Object.defineProperty(y.prototype,"children",{get:function(){throw new Error("Mixin: ParentNode not implemented.")},enumerable:!0,configurable:!0}),Object.defineProperty(y.prototype,"firstElementChild",{get:function(){throw new Error("Mixin: ParentNode not implemented.")},enumerable:!0,configurable:!0}),Object.defineProperty(y.prototype,"lastElementChild",{get:function(){throw new Error("Mixin: ParentNode not implemented.")},enumerable:!0,configurable:!0}),Object.defineProperty(y.prototype,"childElementCount",{get:function(){throw new Error("Mixin: ParentNode not implemented.")},enumerable:!0,configurable:!0}),y.prototype.prepend=function(){for(var v=[],x=0;x<arguments.length;x++)v[x]=arguments[x];throw new Error("Mixin: ParentNode not implemented.")},y.prototype.append=function(){for(var v=[],x=0;x<arguments.length;x++)v[x]=arguments[x];throw new Error("Mixin: ParentNode not implemented.")},y.prototype.querySelector=function(v){throw new Error("Mixin: ParentNode not implemented.")},y.prototype.querySelectorAll=function(v){throw new Error("Mixin: ParentNode not implemented.")},Object.defineProperty(y.prototype,"previousElementSibling",{get:function(){throw new Error("Mixin: NonDocumentTypeChildNode not implemented.")},enumerable:!0,configurable:!0}),Object.defineProperty(y.prototype,"nextElementSibling",{get:function(){throw new Error("Mixin: NonDocumentTypeChildNode not implemented.")},enumerable:!0,configurable:!0}),y.prototype.before=function(){for(var v=[],x=0;x<arguments.length;x++)v[x]=arguments[x];throw new Error("Mixin: ChildNode not implemented.")},y.prototype.after=function(){for(var v=[],x=0;x<arguments.length;x++)v[x]=arguments[x];throw new Error("Mixin: ChildNode not implemented.")},y.prototype.replaceWith=function(){for(var v=[],x=0;x<arguments.length;x++)v[x]=arguments[x];throw new Error("Mixin: ChildNode not implemented.")},y.prototype.remove=function(){throw new Error("Mixin: ChildNode not implemented.")},Object.defineProperty(y.prototype,"assignedSlot",{get:function(){throw new Error("Mixin: Slotable not implemented.")},enumerable:!0,configurable:!0}),y._create=function(v,x,w,S){w===void 0&&(w=null),S===void 0&&(S=null);var T=new y;return T._localName=x,T._namespace=w,T._namespacePrefix=S,T._nodeDocument=v,T},y})(f.NodeImpl);r.ElementImpl=g,p.idl_defineConst(g.prototype,"_nodeType",c.NodeType.Element)},function(n,r,i){var a,o=this&&this.__extends||(a=function(u,d){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,p){h.__proto__=p}||function(h,p){for(var g in p)p.hasOwnProperty(g)&&(h[g]=p[g])})(u,d)},function(u,d){function h(){this.constructor=u}a(u,d),u.prototype=d===null?Object.create(d):(h.prototype=d.prototype,new h)});Object.defineProperty(r,"__esModule",{value:!0});var s=i(2),l=i(34),c=i(12),f=(function(u){function d(h){h===void 0&&(h=null);var p=u.call(this)||this;return p._children=new Set,p._host=h,p}return o(d,u),d.prototype.getElementById=function(h){throw new Error("Mixin: NonElementParentNode not implemented.")},Object.defineProperty(d.prototype,"children",{get:function(){throw new Error("Mixin: ParentNode not implemented.")},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"firstElementChild",{get:function(){throw new Error("Mixin: ParentNode not implemented.")},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"lastElementChild",{get:function(){throw new Error("Mixin: ParentNode not implemented.")},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"childElementCount",{get:function(){throw new Error("Mixin: ParentNode not implemented.")},enumerable:!0,configurable:!0}),d.prototype.prepend=function(){for(var h=[],p=0;p<arguments.length;p++)h[p]=arguments[p];throw new Error("Mixin: ParentNode not implemented.")},d.prototype.append=function(){for(var h=[],p=0;p<arguments.length;p++)h[p]=arguments[p];throw new Error("Mixin: ParentNode not implemented.")},d.prototype.querySelector=function(h){throw new Error("Mixin: ParentNode not implemented.")},d.prototype.querySelectorAll=function(h){throw new Error("Mixin: ParentNode not implemented.")},d._create=function(h,p){p===void 0&&(p=null);var g=new d(p);return g._nodeDocument=h,g},d})(l.NodeImpl);r.DocumentFragmentImpl=f,c.idl_defineConst(f.prototype,"_nodeType",s.NodeType.DocumentFragment)},function(n,r,i){var a,o=this&&this.__extends||(a=function(h,p){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(g,m){g.__proto__=m}||function(g,m){for(var y in m)m.hasOwnProperty(y)&&(g[y]=m[y])})(h,p)},function(h,p){function g(){this.constructor=h}a(h,p),h.prototype=p===null?Object.create(p):(g.prototype=p.prototype,new g)}),s=this&&this.__values||function(h){var p=typeof Symbol=="function"&&Symbol.iterator,g=p&&h[p],m=0;if(g)return g.call(h);if(h&&typeof h.length=="number")return{next:function(){return h&&m>=h.length&&(h=void 0),{value:h&&h[m++],done:!h}}};throw new TypeError(p?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var l=i(2),c=i(71),f=i(0),u=i(12),d=(function(h){function p(g){g===void 0&&(g="");var m=h.call(this,g)||this;return m._name="",m._assignedSlot=null,m}return o(p,h),Object.defineProperty(p.prototype,"wholeText",{get:function(){var g,m,y="";try{for(var v=s(f.text_contiguousTextNodes(this,!0)),x=v.next();!x.done;x=v.next())y+=x.value._data}catch(w){g={error:w}}finally{try{x&&!x.done&&(m=v.return)&&m.call(v)}finally{if(g)throw g.error}}return y},enumerable:!0,configurable:!0}),p.prototype.splitText=function(g){return f.text_split(this,g)},Object.defineProperty(p.prototype,"assignedSlot",{get:function(){throw new Error("Mixin: Slotable not implemented.")},enumerable:!0,configurable:!0}),p._create=function(g,m){m===void 0&&(m="");var y=new p(m);return y._nodeDocument=g,y},p})(c.CharacterDataImpl);r.TextImpl=d,u.idl_defineConst(d.prototype,"_nodeType",l.NodeType.Text)},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=(function(){function o(){}return Object.defineProperty(o.prototype,"_startNode",{get:function(){return this._start[0]},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"_startOffset",{get:function(){return this._start[1]},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"_endNode",{get:function(){return this._end[0]},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"_endOffset",{get:function(){return this._end[1]},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"_collapsed",{get:function(){return this._start[0]===this._end[0]&&this._start[1]===this._end[1]},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"startContainer",{get:function(){return this._startNode},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"startOffset",{get:function(){return this._startOffset},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"endContainer",{get:function(){return this._endNode},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"endOffset",{get:function(){return this._endOffset},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"collapsed",{get:function(){return this._collapsed},enumerable:!0,configurable:!0}),o})();r.AbstractRangeImpl=a},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(2),o=(function(){function s(l){this._activeFlag=!1,this._root=l,this._whatToShow=a.WhatToShow.All,this._filter=null}return Object.defineProperty(s.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"whatToShow",{get:function(){return this._whatToShow},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"filter",{get:function(){return this._filter},enumerable:!0,configurable:!0}),s})();r.TraverserImpl=o},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(2),o=i(0),s=i(12),l=(function(){function c(f,u){this._target=null,this._relatedTarget=null,this._touchTargetList=[],this._path=[],this._currentTarget=null,this._eventPhase=a.EventPhase.None,this._stopPropagationFlag=!1,this._stopImmediatePropagationFlag=!1,this._canceledFlag=!1,this._inPassiveListenerFlag=!1,this._composedFlag=!1,this._initializedFlag=!1,this._dispatchFlag=!1,this._isTrusted=!1,this._bubbles=!1,this._cancelable=!1,this._type=f,u&&(this._bubbles=u.bubbles||!1,this._cancelable=u.cancelable||!1,this._composedFlag=u.composed||!1),this._initializedFlag=!0,this._timeStamp=new Date().getTime()}return Object.defineProperty(c.prototype,"type",{get:function(){return this._type},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"target",{get:function(){return this._target},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"srcElement",{get:function(){return this._target},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"currentTarget",{get:function(){return this._currentTarget},enumerable:!0,configurable:!0}),c.prototype.composedPath=function(){var f=[],u=this._path;if(u.length===0)return f;var d=this._currentTarget;if(d===null)throw new Error("Event currentTarget is null.");f.push(d);for(var h=0,p=0,g=u.length-1;g>=0;){if(u[g].rootOfClosedTree&&p++,u[g].invocationTarget===d){h=g;break}u[g].slotInClosedTree&&p--,g--}var m=p,y=p;for(g=h-1;g>=0;)u[g].rootOfClosedTree&&m++,m<=y&&f.unshift(u[g].invocationTarget),u[g].slotInClosedTree&&--m<y&&(y=m),g--;for(m=p,y=p,g=h+1;g<u.length;)u[g].slotInClosedTree&&m++,m<=y&&f.push(u[g].invocationTarget),u[g].rootOfClosedTree&&--m<y&&(y=m),g++;return f},Object.defineProperty(c.prototype,"eventPhase",{get:function(){return this._eventPhase},enumerable:!0,configurable:!0}),c.prototype.stopPropagation=function(){this._stopPropagationFlag=!0},Object.defineProperty(c.prototype,"cancelBubble",{get:function(){return this._stopPropagationFlag},set:function(f){f&&this.stopPropagation()},enumerable:!0,configurable:!0}),c.prototype.stopImmediatePropagation=function(){this._stopPropagationFlag=!0,this._stopImmediatePropagationFlag=!0},Object.defineProperty(c.prototype,"bubbles",{get:function(){return this._bubbles},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"cancelable",{get:function(){return this._cancelable},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"returnValue",{get:function(){return!this._canceledFlag},set:function(f){f||o.event_setTheCanceledFlag(this)},enumerable:!0,configurable:!0}),c.prototype.preventDefault=function(){o.event_setTheCanceledFlag(this)},Object.defineProperty(c.prototype,"defaultPrevented",{get:function(){return this._canceledFlag},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"composed",{get:function(){return this._composedFlag},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"isTrusted",{get:function(){return this._isTrusted},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"timeStamp",{get:function(){return this._timeStamp},enumerable:!0,configurable:!0}),c.prototype.initEvent=function(f,u,d){u===void 0&&(u=!1),d===void 0&&(d=!1),this._dispatchFlag||o.event_initialize(this,f,u,d)},c.NONE=0,c.CAPTURING_PHASE=1,c.AT_TARGET=2,c.BUBBLING_PHASE=3,c})();r.EventImpl=l,s.idl_defineConst(l.prototype,"NONE",0),s.idl_defineConst(l.prototype,"CAPTURING_PHASE",1),s.idl_defineConst(l.prototype,"AT_TARGET",2),s.idl_defineConst(l.prototype,"BUBBLING_PHASE",3)},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(2),o=i(9);r.traversal_filter=function(s,l){if(s._activeFlag)throw new o.InvalidStateError;var c=1<<l._nodeType-1;if((s.whatToShow&c)==0)return a.FilterResult.Skip;if(!s.filter)return a.FilterResult.Accept;s._activeFlag=!0;var f=a.FilterResult.Reject;try{f=s.filter.acceptNode(l)}catch(u){throw s._activeFlag=!1,u}return s._activeFlag=!1,f}},function(n,r,i){var a=this&&this.__read||function(y,v){var x=typeof Symbol=="function"&&y[Symbol.iterator];if(!x)return y;var w,S,T=x.call(y),_=[];try{for(;(v===void 0||v-- >0)&&!(w=T.next()).done;)_.push(w.value)}catch(D){S={error:D}}finally{try{w&&!w.done&&(x=T.return)&&x.call(T)}finally{if(S)throw S.error}}return _},o=this&&this.__values||function(y){var v=typeof Symbol=="function"&&Symbol.iterator,x=v&&y[v],w=0;if(x)return x.call(y);if(y&&typeof y.length=="number")return{next:function(){return y&&w>=y.length&&(y=void 0),{value:y&&y[w++],done:!y}}};throw new TypeError(v?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var s=i(6),l=i(3),c=i(1),f=i(99),u=i(73),d=i(17),h=i(173),p=i(30),g=i(52),m=i(37);r.document_elementInterface=function(y,v){return f.ElementImpl},r.document_internalCreateElementNS=function(y,v,x,w){var S=a(h.namespace_validateAndExtract(v,x),3),T=S[0],_=S[1],D=S[2],I=null;return w!==void 0&&(I=c.isString(w)?w:w.is),g.element_createAnElement(y,D,T,_,I,!0)},r.document_adopt=function(y,v){var x,w;if(y._nodeDocument!==v||y._parent!==null){var S=y._nodeDocument;if(y._parent&&m.mutation_remove(y,y._parent),v!==S)for(var T=d.tree_getFirstDescendantNode(y,!0,!0);T!==null;){if(T._nodeDocument=v,l.Guard.isElementNode(T))try{for(var _=(x=void 0,o(T._attributeList._asArray())),D=_.next();!D.done;D=_.next())D.value._nodeDocument=v}catch(I){x={error:I}}finally{try{D&&!D.done&&(w=_.return)&&w.call(_)}finally{if(x)throw x.error}}s.dom.features.customElements&&l.Guard.isElementNode(T)&&T._customElementState==="custom"&&u.customElement_enqueueACustomElementCallbackReaction(T,"adoptedCallback",[S,v]),s.dom.features.steps&&p.dom_runAdoptingSteps(T,S),T=d.tree_getNextDescendantNode(y,T,!0,!0)}}}},function(n,r,i){var a=this&&this.__values||function(d){var h=typeof Symbol=="function"&&Symbol.iterator,p=h&&d[h],g=0;if(p)return p.call(d);if(d&&typeof d.length=="number")return{next:function(){return d&&g>=d.length&&(d=void 0),{value:d&&d[g++],done:!d}}};throw new TypeError(h?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var o=i(6),s=i(3),l=i(9),c=i(17),f=i(51),u=i(30);r.characterData_replaceData=function(d,h,p,g){var m,y,v=c.tree_nodeLength(d);if(h>v)throw new l.IndexSizeError("Offset exceeds character data length. Offset: "+h+", Length: "+v+", Node is "+d.nodeName+".");h+p>v&&(p=v-h),o.dom.features.mutationObservers&&f.observer_queueMutationRecord("characterData",d,null,null,d._data,[],[],null,null);var x=d._data.substring(0,h)+g+d._data.substring(h+p);d._data=x;try{for(var w=a(o.dom.rangeList),S=w.next();!S.done;S=w.next()){var T=S.value;T._start[0]===d&&T._start[1]>h&&T._start[1]<=h+p&&(T._start[1]=h),T._end[0]===d&&T._end[1]>h&&T._end[1]<=h+p&&(T._end[1]=h),T._start[0]===d&&T._start[1]>h+p&&(T._start[1]+=g.length-p),T._end[0]===d&&T._end[1]>h+p&&(T._end[1]+=g.length-p)}}catch(_){m={error:_}}finally{try{S&&!S.done&&(y=w.return)&&y.call(w)}finally{if(m)throw m.error}}o.dom.features.steps&&s.Guard.isTextNode(d)&&d._parent!==null&&u.dom_runChildTextContentChangeSteps(d._parent)},r.characterData_substringData=function(d,h,p){var g=c.tree_nodeLength(d);if(h>g)throw new l.IndexSizeError("Offset exceeds character data length. Offset: "+h+", Length: "+g+", Node is "+d.nodeName+".");return h+p>g?d._data.substr(h):d._data.substr(h,p)}},function(n,r,i){var a=this&&this.__read||function(u,d){var h=typeof Symbol=="function"&&u[Symbol.iterator];if(!h)return u;var p,g,m=h.call(u),y=[];try{for(;(d===void 0||d-- >0)&&!(p=m.next()).done;)y.push(p.value)}catch(v){g={error:v}}finally{try{p&&!p.done&&(h=m.return)&&h.call(m)}finally{if(g)throw g.error}}return y},o=this&&this.__spread||function(){for(var u=[],d=0;d<arguments.length;d++)u=u.concat(a(arguments[d]));return u},s=this&&this.__values||function(u){var d=typeof Symbol=="function"&&Symbol.iterator,h=d&&u[d],p=0;if(h)return h.call(u);if(u&&typeof u.length=="number")return{next:function(){return u&&p>=u.length&&(u=void 0),{value:u&&u[p++],done:!u}}};throw new TypeError(d?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var l=i(7);function c(u){var d=l.string.splitAStringOnASCIIWhitespace(u);return new Set(d)}function f(u){return o(u).join(" ")}r.orderedSet_parse=c,r.orderedSet_serialize=f,r.orderedSet_sanitize=function(u){return f(c(u))},r.orderedSet_contains=function(u,d,h){var p,g,m,y;try{for(var v=s(d),x=v.next();!x.done;x=v.next()){var w=x.value,S=!1;try{for(var T=(m=void 0,s(u)),_=T.next();!_.done;_=T.next()){var D=_.value;if(h){if(D===w){S=!0;break}}else if(D.toUpperCase()===w.toUpperCase()){S=!0;break}}}catch(I){m={error:I}}finally{try{_&&!_.done&&(y=T.return)&&y.call(T)}finally{if(m)throw m.error}}if(!S)return!1}}catch(I){p={error:I}}finally{try{x&&!x.done&&(g=v.return)&&g.call(v)}finally{if(p)throw p.error}}return!0}},function(n,r,i){i(179),Object.defineProperty(r,"__esModule",{value:!0});var a=i(262),o=i(110),s=i(1);o.dom.setFeatures(!1),r.createDocument=function(){var l=new a.DOMImplementation().createDocument(null,"root",null);return l.documentElement&&l.removeChild(l.documentElement),l},r.sanitizeInput=function(l,c){if(l==null)return l;if(c===void 0)return l+"";var f="";l+="";for(var u=0;u<l.length;u++){var d=l.charCodeAt(u);if(d===9||d===10||d===13||d>=32&&d<=55295||d>=57344&&d<=65533)f+=l.charAt(u);else if(d>=55296&&d<=56319&&u<l.length-1){var h=l.charCodeAt(u+1);h>=56320&&h<=57343?(d=1024*(d-55296)+h-56320+65536,f+=String.fromCodePoint(d),u++):f+=s.isString(c)?c:c(l.charAt(u),u,l)}else f+=s.isString(c)?c:c(l.charAt(u),u,l)}return f}},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(1),o=i(153);r.AbortController=o.AbortControllerImpl;var s=i(154);r.AbortSignal=s.AbortSignalImpl;var l=i(102);r.AbstractRange=l.AbstractRangeImpl;var c=i(157);r.Attr=c.AttrImpl;var f=i(158);r.CDATASection=f.CDATASectionImpl;var u=i(71);r.CharacterData=u.CharacterDataImpl;var d=i(263),h=i(159);r.Comment=h.CommentImpl;var p=i(171);r.CustomEvent=p.CustomEventImpl;var g=i(100);r.DocumentFragment=g.DocumentFragmentImpl;var m=i(98);r.Document=m.DocumentImpl;var y=i(264),v=i(155);r.DocumentType=v.DocumentTypeImpl;var x=i(6);r.dom=x.dom;var w=i(148);r.DOMImplementation=w.DOMImplementationImpl;var S=i(170);r.DOMTokenList=S.DOMTokenListImpl;var T=i(99);r.Element=T.ElementImpl;var _=i(104);r.Event=_.EventImpl;var D=i(70);r.EventTarget=D.EventTargetImpl;var I=i(161);r.HTMLCollection=I.HTMLCollectionImpl;var R=i(265);r.MutationObserver=R.MutationObserverImpl;var M=i(169);r.MutationRecord=M.MutationRecordImpl;var A=i(164);r.NamedNodeMap=A.NamedNodeMapImpl;var L=i(168);r.NodeFilter=L.NodeFilterImpl;var P=i(34);r.Node=P.NodeImpl;var B=i(166);r.NodeIterator=B.NodeIteratorImpl;var U=i(162);r.NodeList=U.NodeListImpl;var G=i(163);r.NodeListStatic=G.NodeListStaticImpl;var F=i(266),$=i(267),V=i(268),X=i(160);r.ProcessingInstruction=X.ProcessingInstructionImpl;var Q=i(165);r.Range=Q.RangeImpl;var re=i(156);r.ShadowRoot=re.ShadowRootImpl;var ye=i(269),me=i(270);r.StaticRange=me.StaticRangeImpl;var Ce=i(101);r.Text=Ce.TextImpl;var we=i(103);r.Traverser=we.TraverserImpl;var Ae=i(167);r.TreeWalker=Ae.TreeWalkerImpl;var De=i(149);r.Window=De.WindowImpl;var q=i(151);r.XMLDocument=q.XMLDocumentImpl,a.applyMixin(T.ElementImpl,d.ChildNodeImpl),a.applyMixin(u.CharacterDataImpl,d.ChildNodeImpl),a.applyMixin(v.DocumentTypeImpl,d.ChildNodeImpl),a.applyMixin(m.DocumentImpl,y.DocumentOrShadowRootImpl),a.applyMixin(re.ShadowRootImpl,y.DocumentOrShadowRootImpl),a.applyMixin(T.ElementImpl,F.NonDocumentTypeChildNodeImpl),a.applyMixin(u.CharacterDataImpl,F.NonDocumentTypeChildNodeImpl),a.applyMixin(m.DocumentImpl,$.NonElementParentNodeImpl),a.applyMixin(g.DocumentFragmentImpl,$.NonElementParentNodeImpl),a.applyMixin(m.DocumentImpl,V.ParentNodeImpl),a.applyMixin(g.DocumentFragmentImpl,V.ParentNodeImpl),a.applyMixin(T.ElementImpl,V.ParentNodeImpl),a.applyMixin(Ce.TextImpl,ye.SlotableImpl),a.applyMixin(T.ElementImpl,ye.SlotableImpl)},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),(function(a){a[a.EOF=0]="EOF",a[a.Declaration=1]="Declaration",a[a.DocType=2]="DocType",a[a.Element=3]="Element",a[a.Text=4]="Text",a[a.CDATA=5]="CDATA",a[a.PI=6]="PI",a[a.Comment=7]="Comment",a[a.ClosingTag=8]="ClosingTag"})(r.TokenType||(r.TokenType={}))},function(n,r,i){i(64),i(20),i(66);var a,o=this&&this.__extends||(a=function(c,f){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,d){u.__proto__=d}||function(u,d){for(var h in d)d.hasOwnProperty(h)&&(u[h]=d[h])})(c,f)},function(c,f){function u(){this.constructor=c}a(c,f),c.prototype=f===null?Object.create(f):(u.prototype=f.prototype,new u)});Object.defineProperty(r,"__esModule",{value:!0});var s=i(1),l=(function(c){function f(){return c!==null&&c.apply(this,arguments)||this}return o(f,c),f.prototype._parse=function(u,d){var h=this,p=this._builderOptions,g=null;return s.isFunction(d)?g=this.parse(u,d.apply(this)):s.isArray(d)||s.isSet(d)?s.forEachArray(d,(function(m){return g=h.parse(u,m)}),this):s.isMap(d)||s.isObject(d)?s.forEachObject(d,(function(m,y){if(s.isFunction(y)&&(y=y.apply(h)),p.ignoreConverters||m.indexOf(p.convert.att)!==0)if(p.ignoreConverters||m.indexOf(p.convert.text)!==0)if(p.ignoreConverters||m.indexOf(p.convert.cdata)!==0)if(p.ignoreConverters||m.indexOf(p.convert.comment)!==0)if(p.ignoreConverters||m.indexOf(p.convert.ins)!==0){if(!((s.isArray(y)||s.isSet(y))&&s.isEmpty(y))){if((s.isMap(y)||s.isObject(y))&&s.isEmpty(y))g=h.element(u,void 0,h.sanitize(m))||g;else if(p.keepNullNodes||y!=null)if(s.isArray(y)||s.isSet(y))s.forEachArray(y,(function(T){var _={};_[m]=T,g=h.parse(u,_)}),h);else if(s.isMap(y)||s.isObject(y))(v=h.element(u,void 0,h.sanitize(m)))&&(g=v,h.parse(v,y));else if(y!=null&&y!==""){var v;(v=h.element(u,void 0,h.sanitize(m)))&&(g=v,h.text(v,h._decodeText(h.sanitize(y))))}else g=h.element(u,void 0,h.sanitize(m))||g}}else if(s.isString(y)){var x=y.indexOf(" "),w=x===-1?y:y.substr(0,x),S=x===-1?"":y.substr(x+1);g=h.instruction(u,h.sanitize(w),h.sanitize(S))||g}else s.isArray(y)||s.isSet(y)?s.forEachArray(y,(function(T){var _=T.indexOf(" "),D=_===-1?T:T.substr(0,_),I=_===-1?"":T.substr(_+1);g=h.instruction(u,h.sanitize(D),h.sanitize(I))||g}),h):s.forEachObject(y,(function(T,_){return g=h.instruction(u,h.sanitize(T),h.sanitize(_))||g}),h);else s.isArray(y)||s.isSet(y)?s.forEachArray(y,(function(T){return g=h.comment(u,h.sanitize(T))||g}),h):g=h.comment(u,h.sanitize(y))||g;else s.isArray(y)||s.isSet(y)?s.forEachArray(y,(function(T){return g=h.cdata(u,h.sanitize(T))||g}),h):g=h.cdata(u,h.sanitize(y))||g;else g=s.isMap(y)||s.isObject(y)?h.parse(u,y):h.text(u,h._decodeText(h.sanitize(y)))||g;else if(m===p.convert.att){if(s.isArray(y)||s.isSet(y))throw new Error("Invalid attribute: "+y.toString()+". "+u._debugInfo());s.forEachObject(y,(function(T,_){g=h.attribute(u,void 0,h.sanitize(T),h._decodeAttributeValue(h.sanitize(_)))||g}))}else g=h.attribute(u,void 0,h.sanitize(m.substr(p.convert.att.length)),h._decodeAttributeValue(h.sanitize(y)))||g}),this):(p.keepNullNodes||d!=null)&&(g=this.text(u,this._decodeText(this.sanitize(d)))||g),g||u},f})(i(75).BaseReader);r.ObjectReader=l},function(n,r,i){var a=i(39);n.exports=new a({explicit:[i(286),i(287),i(288)]})},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=function(o){this.level=0,this._builderOptions=o,this._writerOptions=o};r.BaseCBWriter=a},function(n,r,i){var a=i(16),o=i(8),s=i(116);n.exports=!a&&!o((function(){return Object.defineProperty(s("div"),"a",{get:function(){return 7}}).a!=7}))},function(n,r,i){var a=i(11),o=i(13),s=a.document,l=o(s)&&o(s.createElement);n.exports=function(c){return l?s.createElement(c):{}}},function(n,r,i){var a=i(118),o=Function.toString;typeof a.inspectSource!="function"&&(a.inspectSource=function(s){return o.call(s)}),n.exports=a.inspectSource},function(n,r,i){var a=i(11),o=i(80),s=a["__core-js_shared__"]||o("__core-js_shared__",{});n.exports=s},function(n,r,i){var a=i(14),o=i(187),s=i(55),l=i(15);n.exports=function(c,f){for(var u=o(f),d=l.f,h=s.f,p=0;p<u.length;p++){var g=u[p];a(c,g)||d(c,g,h(f,g))}}},function(n,r,i){var a=i(11);n.exports=a},function(n,r,i){var a=i(14),o=i(24),s=i(122).indexOf,l=i(45);n.exports=function(c,f){var u,d=o(c),h=0,p=[];for(u in d)!a(l,u)&&a(d,u)&&p.push(u);for(;f.length>h;)a(d,u=f[h++])&&(~s(p,u)||p.push(u));return p}},function(n,r,i){var a=i(24),o=i(26),s=i(83),l=function(c){return function(f,u,d){var h,p=a(f),g=o(p.length),m=s(d,g);if(c&&u!=u){for(;g>m;)if((h=p[m++])!=h)return!0}else for(;g>m;m++)if((c||m in p)&&p[m]===u)return c||m||0;return!c&&-1}};n.exports={includes:l(!0),indexOf:l(!1)}},function(n,r,i){var a=i(8),o=/#|\.prototype\./,s=function(d,h){var p=c[l(d)];return p==u||p!=f&&(typeof h=="function"?a(h):!!h)},l=s.normalize=function(d){return String(d).replace(o,".").toLowerCase()},c=s.data={},f=s.NATIVE="N",u=s.POLYFILL="P";n.exports=s},function(n,r,i){var a=i(86);n.exports=a&&!Symbol.sham&&typeof Symbol.iterator=="symbol"},function(n,r,i){var a=i(5);r.f=a},function(n,r,i){var a=i(120),o=i(14),s=i(125),l=i(15).f;n.exports=function(c){var f=a.Symbol||(a.Symbol={});o(f,c)||l(f,c,{value:s.f(c)})}},function(n,r){n.exports=function(i){if(typeof i!="function")throw TypeError(String(i)+" is not a function");return i}},function(n,r,i){var a=i(13),o=i(59),s=i(5)("species");n.exports=function(l,c){var f;return o(l)&&(typeof(f=l.constructor)!="function"||f!==Array&&!o(f.prototype)?a(f)&&(f=f[s])===null&&(f=void 0):f=void 0),new(f===void 0?Array:f)(c===0?0:c)}},function(n,r,i){var a,o,s=i(11),l=i(193),c=s.process,f=c&&c.versions,u=f&&f.v8;u?o=(a=u.split("."))[0]+a[1]:l&&(!(a=l.match(/Edge\/(\d+)/))||a[1]>=74)&&(a=l.match(/Chrome\/(\d+)/))&&(o=a[1]),n.exports=o&&+o},function(n,r,i){var a=i(5),o=i(60),s=i(15),l=a("unscopables"),c=Array.prototype;c[l]==null&&s.f(c,l,{configurable:!0,value:o(null)}),n.exports=function(f){c[l][f]=!0}},function(n,r,i){var a,o,s,l=i(132),c=i(21),f=i(14),u=i(5),d=i(44),h=u("iterator"),p=!1;[].keys&&("next"in(s=[].keys())?(o=l(l(s)))!==Object.prototype&&(a=o):p=!0),a==null&&(a={}),d||f(a,h)||c(a,h,(function(){return this})),n.exports={IteratorPrototype:a,BUGGY_SAFARI_ITERATORS:p}},function(n,r,i){var a=i(14),o=i(27),s=i(57),l=i(196),c=s("IE_PROTO"),f=Object.prototype;n.exports=l?Object.getPrototypeOf:function(u){return u=o(u),a(u,c)?u[c]:typeof u.constructor=="function"&&u instanceof u.constructor?u.constructor.prototype:u instanceof Object?f:null}},function(n,r,i){var a=i(18),o=i(197);n.exports=Object.setPrototypeOf||("__proto__"in{}?(function(){var s,l=!1,c={};try{(s=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(c,[]),l=c instanceof Array}catch{}return function(f,u){return a(f),o(u),l?s.call(f,u):f.__proto__=u,f}})():void 0)},function(n,r,i){var a=i(56),o=i(15),s=i(40);n.exports=function(l,c,f){var u=a(c);u in l?o.f(l,u,s(0,f)):l[u]=f}},function(n,r,i){var a=i(90),o=i(42),s=i(5)("toStringTag"),l=o((function(){return arguments})())=="Arguments";n.exports=a?o:function(c){var f,u,d;return c===void 0?"Undefined":c===null?"Null":typeof(u=(function(h,p){try{return h[p]}catch{}})(f=Object(c),s))=="string"?u:l?o(f):(d=o(f))=="Object"&&typeof f.callee=="function"?"Arguments":d}},function(n,r,i){var a=i(18);n.exports=function(){var o=a(this),s="";return o.global&&(s+="g"),o.ignoreCase&&(s+="i"),o.multiline&&(s+="m"),o.dotAll&&(s+="s"),o.unicode&&(s+="u"),o.sticky&&(s+="y"),s}},function(n,r,i){var a=i(47),o=i(35),s=function(l){return function(c,f){var u,d,h=String(o(c)),p=a(f),g=h.length;return p<0||p>=g?l?"":void 0:(u=h.charCodeAt(p))<55296||u>56319||p+1===g||(d=h.charCodeAt(p+1))<56320||d>57343?l?h.charAt(p):u:l?h.slice(p,p+2):d-56320+(u-55296<<10)+65536}};n.exports={codeAt:s(!1),charAt:s(!0)}},function(n,r,i){var a=i(4),o=i(27),s=i(61);a({target:"Object",stat:!0,forced:i(8)((function(){s(1)}))},{keys:function(l){return s(o(l))}})},function(n,r,i){var a=i(4),o=i(11),s=i(123),l=i(25),c=i(140),f=i(141),u=i(142),d=i(13),h=i(8),p=i(208),g=i(62),m=i(209);n.exports=function(y,v,x){var w=y.indexOf("Map")!==-1,S=y.indexOf("Weak")!==-1,T=w?"set":"add",_=o[y],D=_&&_.prototype,I=_,R={},M=function(G){var F=D[G];l(D,G,G=="add"?function($){return F.call(this,$===0?0:$),this}:G=="delete"?function($){return!(S&&!d($))&&F.call(this,$===0?0:$)}:G=="get"?function($){return S&&!d($)?void 0:F.call(this,$===0?0:$)}:G=="has"?function($){return!(S&&!d($))&&F.call(this,$===0?0:$)}:function($,V){return F.call(this,$===0?0:$,V),this})};if(s(y,typeof _!="function"||!(S||D.forEach&&!h((function(){new _().entries().next()})))))I=x.getConstructor(v,y,w,T),c.REQUIRED=!0;else if(s(y,!0)){var A=new I,L=A[T](S?{}:-0,1)!=A,P=h((function(){A.has(1)})),B=p((function(G){new _(G)})),U=!S&&h((function(){for(var G=new _,F=5;F--;)G[T](F,F);return!G.has(-0)}));B||((I=v((function(G,F){u(G,I,y);var $=m(new _,G,I);return F!=null&&f(F,$[T],$,w),$}))).prototype=D,D.constructor=I),(P||U)&&(M("delete"),M("has"),w&&M("get")),(U||L)&&M(T),S&&D.clear&&delete D.clear}return R[y]=I,a({global:!0,forced:I!=_},R),g(I,y),S||x.setStrong(I,y,w),I}},function(n,r,i){var a=i(45),o=i(13),s=i(14),l=i(15).f,c=i(58),f=i(204),u=c("meta"),d=0,h=Object.isExtensible||function(){return!0},p=function(m){l(m,u,{value:{objectID:"O"+ ++d,weakData:{}}})},g=n.exports={REQUIRED:!1,fastKey:function(m,y){if(!o(m))return typeof m=="symbol"?m:(typeof m=="string"?"S":"P")+m;if(!s(m,u)){if(!h(m))return"F";if(!y)return"E";p(m)}return m[u].objectID},getWeakData:function(m,y){if(!s(m,u)){if(!h(m))return!0;if(!y)return!1;p(m)}return m[u].weakData},onFreeze:function(m){return f&&g.REQUIRED&&h(m)&&!s(m,u)&&p(m),m}};a[u]=!0},function(n,r,i){var a=i(18),o=i(205),s=i(26),l=i(87),c=i(206),f=i(207),u=function(d,h){this.stopped=d,this.result=h};(n.exports=function(d,h,p,g,m){var y,v,x,w,S,T,_,D=l(h,p,g?2:1);if(m)y=d;else{if(typeof(v=c(d))!="function")throw TypeError("Target is not iterable");if(o(v)){for(x=0,w=s(d.length);w>x;x++)if((S=g?D(a(_=d[x])[0],_[1]):D(d[x]))&&S instanceof u)return S;return new u(!1)}y=v.call(d)}for(T=y.next;!(_=T.call(y)).done;)if(typeof(S=f(y,D,_.value,g))=="object"&&S&&S instanceof u)return S;return new u(!1)}).stop=function(d){return new u(!0,d)}},function(n,r){n.exports=function(i,a,o){if(!(i instanceof a))throw TypeError("Incorrect "+(o?o+" ":"")+"invocation");return i}},function(n,r,i){var a=i(15).f,o=i(60),s=i(210),l=i(87),c=i(142),f=i(141),u=i(88),d=i(211),h=i(16),p=i(140).fastKey,g=i(43),m=g.set,y=g.getterFor;n.exports={getConstructor:function(v,x,w,S){var T=v((function(R,M){c(R,T,x),m(R,{type:x,index:o(null),first:void 0,last:void 0,size:0}),h||(R.size=0),M!=null&&f(M,R[S],R,w)})),_=y(x),D=function(R,M,A){var L,P,B=_(R),U=I(R,M);return U?U.value=A:(B.last=U={index:P=p(M,!0),key:M,value:A,previous:L=B.last,next:void 0,removed:!1},B.first||(B.first=U),L&&(L.next=U),h?B.size++:R.size++,P!=="F"&&(B.index[P]=U)),R},I=function(R,M){var A,L=_(R),P=p(M);if(P!=="F")return L.index[P];for(A=L.first;A;A=A.next)if(A.key==M)return A};return s(T.prototype,{clear:function(){for(var R=_(this),M=R.index,A=R.first;A;)A.removed=!0,A.previous&&(A.previous=A.previous.next=void 0),delete M[A.index],A=A.next;R.first=R.last=void 0,h?R.size=0:this.size=0},delete:function(R){var M=_(this),A=I(this,R);if(A){var L=A.next,P=A.previous;delete M.index[A.index],A.removed=!0,P&&(P.next=L),L&&(L.previous=P),M.first==A&&(M.first=L),M.last==A&&(M.last=P),h?M.size--:this.size--}return!!A},forEach:function(R){for(var M,A=_(this),L=l(R,arguments.length>1?arguments[1]:void 0,3);M=M?M.next:A.first;)for(L(M.value,M.key,this);M&&M.removed;)M=M.previous},has:function(R){return!!I(this,R)}}),s(T.prototype,w?{get:function(R){var M=I(this,R);return M&&M.value},set:function(R,M){return D(this,R===0?0:R,M)}}:{add:function(R){return D(this,R=R===0?0:R,R)}}),h&&a(T.prototype,"size",{get:function(){return _(this).size}}),T},setStrong:function(v,x,w){var S=x+" Iterator",T=y(x),_=y(S);u(v,x,(function(D,I){m(this,{type:S,target:D,state:T(D),kind:I,last:void 0})}),(function(){for(var D=_(this),I=D.kind,R=D.last;R&&R.removed;)R=R.previous;return D.target&&(D.last=R=R?R.next:D.state.first)?I=="keys"?{value:R.key,done:!1}:I=="values"?{value:R.value,done:!1}:{value:[R.key,R.value],done:!1}:(D.target=void 0,{value:void 0,done:!0})}),w?"entries":"values",!w,!0),d(x)}}},function(n,r,i){var a,o=i(4),s=i(55).f,l=i(26),c=i(222),f=i(35),u=i(224),d=i(44),h="".endsWith,p=Math.min,g=u("endsWith");o({target:"String",proto:!0,forced:!!(d||g||(a=s(String.prototype,"endsWith"),!a||a.writable))&&!g},{endsWith:function(m){var y=String(f(this));c(m);var v=arguments.length>1?arguments[1]:void 0,x=l(y.length),w=v===void 0?x:p(l(v),x),S=String(m);return h?h.call(y,S,w):y.slice(w-S.length,w)===S}})},function(n,r,i){(function(a){/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <http://feross.org>
 * @license  MIT
 */var o=i(229),s=i(230),l=i(231);function c(){return u.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function f(q,k){if(c()<k)throw new RangeError("Invalid typed array length");return u.TYPED_ARRAY_SUPPORT?(q=new Uint8Array(k)).__proto__=u.prototype:(q===null&&(q=new u(k)),q.length=k),q}function u(q,k,J){if(!(u.TYPED_ARRAY_SUPPORT||this instanceof u))return new u(q,k,J);if(typeof q=="number"){if(typeof k=="string")throw new Error("If encoding is specified then the first argument must be a string");return p(this,q)}return d(this,q,k,J)}function d(q,k,J,Y){if(typeof k=="number")throw new TypeError('"value" argument must not be a number');return typeof ArrayBuffer<"u"&&k instanceof ArrayBuffer?(function(ie,ue,fe,Se){if(ue.byteLength,fe<0||ue.byteLength<fe)throw new RangeError("'offset' is out of bounds");if(ue.byteLength<fe+(Se||0))throw new RangeError("'length' is out of bounds");return ue=fe===void 0&&Se===void 0?new Uint8Array(ue):Se===void 0?new Uint8Array(ue,fe):new Uint8Array(ue,fe,Se),u.TYPED_ARRAY_SUPPORT?(ie=ue).__proto__=u.prototype:ie=g(ie,ue),ie})(q,k,J,Y):typeof k=="string"?(function(ie,ue,fe){if(typeof fe=="string"&&fe!==""||(fe="utf8"),!u.isEncoding(fe))throw new TypeError('"encoding" must be a valid string encoding');var Se=0|y(ue,fe),Fe=(ie=f(ie,Se)).write(ue,fe);return Fe!==Se&&(ie=ie.slice(0,Fe)),ie})(q,k,J):(function(ie,ue){if(u.isBuffer(ue)){var fe=0|m(ue.length);return(ie=f(ie,fe)).length===0||ue.copy(ie,0,0,fe),ie}if(ue){if(typeof ArrayBuffer<"u"&&ue.buffer instanceof ArrayBuffer||"length"in ue)return typeof ue.length!="number"||(Se=ue.length)!=Se?f(ie,0):g(ie,ue);if(ue.type==="Buffer"&&l(ue.data))return g(ie,ue.data)}var Se;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")})(q,k)}function h(q){if(typeof q!="number")throw new TypeError('"size" argument must be a number');if(q<0)throw new RangeError('"size" argument must not be negative')}function p(q,k){if(h(k),q=f(q,k<0?0:0|m(k)),!u.TYPED_ARRAY_SUPPORT)for(var J=0;J<k;++J)q[J]=0;return q}function g(q,k){var J=k.length<0?0:0|m(k.length);q=f(q,J);for(var Y=0;Y<J;Y+=1)q[Y]=255&k[Y];return q}function m(q){if(q>=c())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+c().toString(16)+" bytes");return 0|q}function y(q,k){if(u.isBuffer(q))return q.length;if(typeof ArrayBuffer<"u"&&typeof ArrayBuffer.isView=="function"&&(ArrayBuffer.isView(q)||q instanceof ArrayBuffer))return q.byteLength;typeof q!="string"&&(q=""+q);var J=q.length;if(J===0)return 0;for(var Y=!1;;)switch(k){case"ascii":case"latin1":case"binary":return J;case"utf8":case"utf-8":case void 0:return we(q).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*J;case"hex":return J>>>1;case"base64":return Ae(q).length;default:if(Y)return we(q).length;k=(""+k).toLowerCase(),Y=!0}}function v(q,k,J){var Y=!1;if((k===void 0||k<0)&&(k=0),k>this.length||((J===void 0||J>this.length)&&(J=this.length),J<=0)||(J>>>=0)<=(k>>>=0))return"";for(q||(q="utf8");;)switch(q){case"hex":return U(this,k,J);case"utf8":case"utf-8":return L(this,k,J);case"ascii":return P(this,k,J);case"latin1":case"binary":return B(this,k,J);case"base64":return A(this,k,J);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return G(this,k,J);default:if(Y)throw new TypeError("Unknown encoding: "+q);q=(q+"").toLowerCase(),Y=!0}}function x(q,k,J){var Y=q[k];q[k]=q[J],q[J]=Y}function w(q,k,J,Y,ie){if(q.length===0)return-1;if(typeof J=="string"?(Y=J,J=0):J>2147483647?J=2147483647:J<-2147483648&&(J=-2147483648),J=+J,isNaN(J)&&(J=ie?0:q.length-1),J<0&&(J=q.length+J),J>=q.length){if(ie)return-1;J=q.length-1}else if(J<0){if(!ie)return-1;J=0}if(typeof k=="string"&&(k=u.from(k,Y)),u.isBuffer(k))return k.length===0?-1:S(q,k,J,Y,ie);if(typeof k=="number")return k&=255,u.TYPED_ARRAY_SUPPORT&&typeof Uint8Array.prototype.indexOf=="function"?ie?Uint8Array.prototype.indexOf.call(q,k,J):Uint8Array.prototype.lastIndexOf.call(q,k,J):S(q,[k],J,Y,ie);throw new TypeError("val must be string, number or Buffer")}function S(q,k,J,Y,ie){var ue,fe=1,Se=q.length,Fe=k.length;if(Y!==void 0&&((Y=String(Y).toLowerCase())==="ucs2"||Y==="ucs-2"||Y==="utf16le"||Y==="utf-16le")){if(q.length<2||k.length<2)return-1;fe=2,Se/=2,Fe/=2,J/=2}function Ke(Ie,ve){return fe===1?Ie[ve]:Ie.readUInt16BE(ve*fe)}if(ie){var He=-1;for(ue=J;ue<Se;ue++)if(Ke(q,ue)===Ke(k,He===-1?0:ue-He)){if(He===-1&&(He=ue),ue-He+1===Fe)return He*fe}else He!==-1&&(ue-=ue-He),He=-1}else for(J+Fe>Se&&(J=Se-Fe),ue=J;ue>=0;ue--){for(var pe=!0,ge=0;ge<Fe;ge++)if(Ke(q,ue+ge)!==Ke(k,ge)){pe=!1;break}if(pe)return ue}return-1}function T(q,k,J,Y){J=Number(J)||0;var ie=q.length-J;Y?(Y=Number(Y))>ie&&(Y=ie):Y=ie;var ue=k.length;if(ue%2!=0)throw new TypeError("Invalid hex string");Y>ue/2&&(Y=ue/2);for(var fe=0;fe<Y;++fe){var Se=parseInt(k.substr(2*fe,2),16);if(isNaN(Se))return fe;q[J+fe]=Se}return fe}function _(q,k,J,Y){return De(we(k,q.length-J),q,J,Y)}function D(q,k,J,Y){return De((function(ie){for(var ue=[],fe=0;fe<ie.length;++fe)ue.push(255&ie.charCodeAt(fe));return ue})(k),q,J,Y)}function I(q,k,J,Y){return D(q,k,J,Y)}function R(q,k,J,Y){return De(Ae(k),q,J,Y)}function M(q,k,J,Y){return De((function(ie,ue){for(var fe,Se,Fe,Ke=[],He=0;He<ie.length&&!((ue-=2)<0);++He)fe=ie.charCodeAt(He),Se=fe>>8,Fe=fe%256,Ke.push(Fe),Ke.push(Se);return Ke})(k,q.length-J),q,J,Y)}function A(q,k,J){return k===0&&J===q.length?o.fromByteArray(q):o.fromByteArray(q.slice(k,J))}function L(q,k,J){J=Math.min(q.length,J);for(var Y=[],ie=k;ie<J;){var ue,fe,Se,Fe,Ke=q[ie],He=null,pe=Ke>239?4:Ke>223?3:Ke>191?2:1;if(ie+pe<=J)switch(pe){case 1:Ke<128&&(He=Ke);break;case 2:(192&(ue=q[ie+1]))==128&&(Fe=(31&Ke)<<6|63&ue)>127&&(He=Fe);break;case 3:ue=q[ie+1],fe=q[ie+2],(192&ue)==128&&(192&fe)==128&&(Fe=(15&Ke)<<12|(63&ue)<<6|63&fe)>2047&&(Fe<55296||Fe>57343)&&(He=Fe);break;case 4:ue=q[ie+1],fe=q[ie+2],Se=q[ie+3],(192&ue)==128&&(192&fe)==128&&(192&Se)==128&&(Fe=(15&Ke)<<18|(63&ue)<<12|(63&fe)<<6|63&Se)>65535&&Fe<1114112&&(He=Fe)}He===null?(He=65533,pe=1):He>65535&&(He-=65536,Y.push(He>>>10&1023|55296),He=56320|1023&He),Y.push(He),ie+=pe}return(function(ge){var Ie=ge.length;if(Ie<=4096)return String.fromCharCode.apply(String,ge);for(var ve="",_e=0;_e<Ie;)ve+=String.fromCharCode.apply(String,ge.slice(_e,_e+=4096));return ve})(Y)}r.Buffer=u,r.SlowBuffer=function(q){return+q!=q&&(q=0),u.alloc(+q)},r.INSPECT_MAX_BYTES=50,u.TYPED_ARRAY_SUPPORT=a.TYPED_ARRAY_SUPPORT!==void 0?a.TYPED_ARRAY_SUPPORT:(function(){try{var q=new Uint8Array(1);return q.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},q.foo()===42&&typeof q.subarray=="function"&&q.subarray(1,1).byteLength===0}catch{return!1}})(),r.kMaxLength=c(),u.poolSize=8192,u._augment=function(q){return q.__proto__=u.prototype,q},u.from=function(q,k,J){return d(null,q,k,J)},u.TYPED_ARRAY_SUPPORT&&(u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,typeof Symbol<"u"&&Symbol.species&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0})),u.alloc=function(q,k,J){return(function(Y,ie,ue,fe){return h(ie),ie<=0?f(Y,ie):ue!==void 0?typeof fe=="string"?f(Y,ie).fill(ue,fe):f(Y,ie).fill(ue):f(Y,ie)})(null,q,k,J)},u.allocUnsafe=function(q){return p(null,q)},u.allocUnsafeSlow=function(q){return p(null,q)},u.isBuffer=function(q){return!(q==null||!q._isBuffer)},u.compare=function(q,k){if(!u.isBuffer(q)||!u.isBuffer(k))throw new TypeError("Arguments must be Buffers");if(q===k)return 0;for(var J=q.length,Y=k.length,ie=0,ue=Math.min(J,Y);ie<ue;++ie)if(q[ie]!==k[ie]){J=q[ie],Y=k[ie];break}return J<Y?-1:Y<J?1:0},u.isEncoding=function(q){switch(String(q).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(q,k){if(!l(q))throw new TypeError('"list" argument must be an Array of Buffers');if(q.length===0)return u.alloc(0);var J;if(k===void 0)for(k=0,J=0;J<q.length;++J)k+=q[J].length;var Y=u.allocUnsafe(k),ie=0;for(J=0;J<q.length;++J){var ue=q[J];if(!u.isBuffer(ue))throw new TypeError('"list" argument must be an Array of Buffers');ue.copy(Y,ie),ie+=ue.length}return Y},u.byteLength=y,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var q=this.length;if(q%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var k=0;k<q;k+=2)x(this,k,k+1);return this},u.prototype.swap32=function(){var q=this.length;if(q%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var k=0;k<q;k+=4)x(this,k,k+3),x(this,k+1,k+2);return this},u.prototype.swap64=function(){var q=this.length;if(q%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var k=0;k<q;k+=8)x(this,k,k+7),x(this,k+1,k+6),x(this,k+2,k+5),x(this,k+3,k+4);return this},u.prototype.toString=function(){var q=0|this.length;return q===0?"":arguments.length===0?L(this,0,q):v.apply(this,arguments)},u.prototype.equals=function(q){if(!u.isBuffer(q))throw new TypeError("Argument must be a Buffer");return this===q||u.compare(this,q)===0},u.prototype.inspect=function(){var q="",k=r.INSPECT_MAX_BYTES;return this.length>0&&(q=this.toString("hex",0,k).match(/.{2}/g).join(" "),this.length>k&&(q+=" ... ")),"<Buffer "+q+">"},u.prototype.compare=function(q,k,J,Y,ie){if(!u.isBuffer(q))throw new TypeError("Argument must be a Buffer");if(k===void 0&&(k=0),J===void 0&&(J=q?q.length:0),Y===void 0&&(Y=0),ie===void 0&&(ie=this.length),k<0||J>q.length||Y<0||ie>this.length)throw new RangeError("out of range index");if(Y>=ie&&k>=J)return 0;if(Y>=ie)return-1;if(k>=J)return 1;if(this===q)return 0;for(var ue=(ie>>>=0)-(Y>>>=0),fe=(J>>>=0)-(k>>>=0),Se=Math.min(ue,fe),Fe=this.slice(Y,ie),Ke=q.slice(k,J),He=0;He<Se;++He)if(Fe[He]!==Ke[He]){ue=Fe[He],fe=Ke[He];break}return ue<fe?-1:fe<ue?1:0},u.prototype.includes=function(q,k,J){return this.indexOf(q,k,J)!==-1},u.prototype.indexOf=function(q,k,J){return w(this,q,k,J,!0)},u.prototype.lastIndexOf=function(q,k,J){return w(this,q,k,J,!1)},u.prototype.write=function(q,k,J,Y){if(k===void 0)Y="utf8",J=this.length,k=0;else if(J===void 0&&typeof k=="string")Y=k,J=this.length,k=0;else{if(!isFinite(k))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");k|=0,isFinite(J)?(J|=0,Y===void 0&&(Y="utf8")):(Y=J,J=void 0)}var ie=this.length-k;if((J===void 0||J>ie)&&(J=ie),q.length>0&&(J<0||k<0)||k>this.length)throw new RangeError("Attempt to write outside buffer bounds");Y||(Y="utf8");for(var ue=!1;;)switch(Y){case"hex":return T(this,q,k,J);case"utf8":case"utf-8":return _(this,q,k,J);case"ascii":return D(this,q,k,J);case"latin1":case"binary":return I(this,q,k,J);case"base64":return R(this,q,k,J);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return M(this,q,k,J);default:if(ue)throw new TypeError("Unknown encoding: "+Y);Y=(""+Y).toLowerCase(),ue=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function P(q,k,J){var Y="";J=Math.min(q.length,J);for(var ie=k;ie<J;++ie)Y+=String.fromCharCode(127&q[ie]);return Y}function B(q,k,J){var Y="";J=Math.min(q.length,J);for(var ie=k;ie<J;++ie)Y+=String.fromCharCode(q[ie]);return Y}function U(q,k,J){var Y=q.length;(!k||k<0)&&(k=0),(!J||J<0||J>Y)&&(J=Y);for(var ie="",ue=k;ue<J;++ue)ie+=Ce(q[ue]);return ie}function G(q,k,J){for(var Y=q.slice(k,J),ie="",ue=0;ue<Y.length;ue+=2)ie+=String.fromCharCode(Y[ue]+256*Y[ue+1]);return ie}function F(q,k,J){if(q%1!=0||q<0)throw new RangeError("offset is not uint");if(q+k>J)throw new RangeError("Trying to access beyond buffer length")}function $(q,k,J,Y,ie,ue){if(!u.isBuffer(q))throw new TypeError('"buffer" argument must be a Buffer instance');if(k>ie||k<ue)throw new RangeError('"value" argument is out of bounds');if(J+Y>q.length)throw new RangeError("Index out of range")}function V(q,k,J,Y){k<0&&(k=65535+k+1);for(var ie=0,ue=Math.min(q.length-J,2);ie<ue;++ie)q[J+ie]=(k&255<<8*(Y?ie:1-ie))>>>8*(Y?ie:1-ie)}function X(q,k,J,Y){k<0&&(k=4294967295+k+1);for(var ie=0,ue=Math.min(q.length-J,4);ie<ue;++ie)q[J+ie]=k>>>8*(Y?ie:3-ie)&255}function Q(q,k,J,Y,ie,ue){if(J+Y>q.length)throw new RangeError("Index out of range");if(J<0)throw new RangeError("Index out of range")}function re(q,k,J,Y,ie){return ie||Q(q,0,J,4),s.write(q,k,J,Y,23,4),J+4}function ye(q,k,J,Y,ie){return ie||Q(q,0,J,8),s.write(q,k,J,Y,52,8),J+8}u.prototype.slice=function(q,k){var J,Y=this.length;if((q=~~q)<0?(q+=Y)<0&&(q=0):q>Y&&(q=Y),(k=k===void 0?Y:~~k)<0?(k+=Y)<0&&(k=0):k>Y&&(k=Y),k<q&&(k=q),u.TYPED_ARRAY_SUPPORT)(J=this.subarray(q,k)).__proto__=u.prototype;else{var ie=k-q;J=new u(ie,void 0);for(var ue=0;ue<ie;++ue)J[ue]=this[ue+q]}return J},u.prototype.readUIntLE=function(q,k,J){q|=0,k|=0,J||F(q,k,this.length);for(var Y=this[q],ie=1,ue=0;++ue<k&&(ie*=256);)Y+=this[q+ue]*ie;return Y},u.prototype.readUIntBE=function(q,k,J){q|=0,k|=0,J||F(q,k,this.length);for(var Y=this[q+--k],ie=1;k>0&&(ie*=256);)Y+=this[q+--k]*ie;return Y},u.prototype.readUInt8=function(q,k){return k||F(q,1,this.length),this[q]},u.prototype.readUInt16LE=function(q,k){return k||F(q,2,this.length),this[q]|this[q+1]<<8},u.prototype.readUInt16BE=function(q,k){return k||F(q,2,this.length),this[q]<<8|this[q+1]},u.prototype.readUInt32LE=function(q,k){return k||F(q,4,this.length),(this[q]|this[q+1]<<8|this[q+2]<<16)+16777216*this[q+3]},u.prototype.readUInt32BE=function(q,k){return k||F(q,4,this.length),16777216*this[q]+(this[q+1]<<16|this[q+2]<<8|this[q+3])},u.prototype.readIntLE=function(q,k,J){q|=0,k|=0,J||F(q,k,this.length);for(var Y=this[q],ie=1,ue=0;++ue<k&&(ie*=256);)Y+=this[q+ue]*ie;return Y>=(ie*=128)&&(Y-=Math.pow(2,8*k)),Y},u.prototype.readIntBE=function(q,k,J){q|=0,k|=0,J||F(q,k,this.length);for(var Y=k,ie=1,ue=this[q+--Y];Y>0&&(ie*=256);)ue+=this[q+--Y]*ie;return ue>=(ie*=128)&&(ue-=Math.pow(2,8*k)),ue},u.prototype.readInt8=function(q,k){return k||F(q,1,this.length),128&this[q]?-1*(255-this[q]+1):this[q]},u.prototype.readInt16LE=function(q,k){k||F(q,2,this.length);var J=this[q]|this[q+1]<<8;return 32768&J?4294901760|J:J},u.prototype.readInt16BE=function(q,k){k||F(q,2,this.length);var J=this[q+1]|this[q]<<8;return 32768&J?4294901760|J:J},u.prototype.readInt32LE=function(q,k){return k||F(q,4,this.length),this[q]|this[q+1]<<8|this[q+2]<<16|this[q+3]<<24},u.prototype.readInt32BE=function(q,k){return k||F(q,4,this.length),this[q]<<24|this[q+1]<<16|this[q+2]<<8|this[q+3]},u.prototype.readFloatLE=function(q,k){return k||F(q,4,this.length),s.read(this,q,!0,23,4)},u.prototype.readFloatBE=function(q,k){return k||F(q,4,this.length),s.read(this,q,!1,23,4)},u.prototype.readDoubleLE=function(q,k){return k||F(q,8,this.length),s.read(this,q,!0,52,8)},u.prototype.readDoubleBE=function(q,k){return k||F(q,8,this.length),s.read(this,q,!1,52,8)},u.prototype.writeUIntLE=function(q,k,J,Y){q=+q,k|=0,J|=0,Y||$(this,q,k,J,Math.pow(2,8*J)-1,0);var ie=1,ue=0;for(this[k]=255&q;++ue<J&&(ie*=256);)this[k+ue]=q/ie&255;return k+J},u.prototype.writeUIntBE=function(q,k,J,Y){q=+q,k|=0,J|=0,Y||$(this,q,k,J,Math.pow(2,8*J)-1,0);var ie=J-1,ue=1;for(this[k+ie]=255&q;--ie>=0&&(ue*=256);)this[k+ie]=q/ue&255;return k+J},u.prototype.writeUInt8=function(q,k,J){return q=+q,k|=0,J||$(this,q,k,1,255,0),u.TYPED_ARRAY_SUPPORT||(q=Math.floor(q)),this[k]=255&q,k+1},u.prototype.writeUInt16LE=function(q,k,J){return q=+q,k|=0,J||$(this,q,k,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[k]=255&q,this[k+1]=q>>>8):V(this,q,k,!0),k+2},u.prototype.writeUInt16BE=function(q,k,J){return q=+q,k|=0,J||$(this,q,k,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[k]=q>>>8,this[k+1]=255&q):V(this,q,k,!1),k+2},u.prototype.writeUInt32LE=function(q,k,J){return q=+q,k|=0,J||$(this,q,k,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[k+3]=q>>>24,this[k+2]=q>>>16,this[k+1]=q>>>8,this[k]=255&q):X(this,q,k,!0),k+4},u.prototype.writeUInt32BE=function(q,k,J){return q=+q,k|=0,J||$(this,q,k,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[k]=q>>>24,this[k+1]=q>>>16,this[k+2]=q>>>8,this[k+3]=255&q):X(this,q,k,!1),k+4},u.prototype.writeIntLE=function(q,k,J,Y){if(q=+q,k|=0,!Y){var ie=Math.pow(2,8*J-1);$(this,q,k,J,ie-1,-ie)}var ue=0,fe=1,Se=0;for(this[k]=255&q;++ue<J&&(fe*=256);)q<0&&Se===0&&this[k+ue-1]!==0&&(Se=1),this[k+ue]=(q/fe>>0)-Se&255;return k+J},u.prototype.writeIntBE=function(q,k,J,Y){if(q=+q,k|=0,!Y){var ie=Math.pow(2,8*J-1);$(this,q,k,J,ie-1,-ie)}var ue=J-1,fe=1,Se=0;for(this[k+ue]=255&q;--ue>=0&&(fe*=256);)q<0&&Se===0&&this[k+ue+1]!==0&&(Se=1),this[k+ue]=(q/fe>>0)-Se&255;return k+J},u.prototype.writeInt8=function(q,k,J){return q=+q,k|=0,J||$(this,q,k,1,127,-128),u.TYPED_ARRAY_SUPPORT||(q=Math.floor(q)),q<0&&(q=255+q+1),this[k]=255&q,k+1},u.prototype.writeInt16LE=function(q,k,J){return q=+q,k|=0,J||$(this,q,k,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[k]=255&q,this[k+1]=q>>>8):V(this,q,k,!0),k+2},u.prototype.writeInt16BE=function(q,k,J){return q=+q,k|=0,J||$(this,q,k,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[k]=q>>>8,this[k+1]=255&q):V(this,q,k,!1),k+2},u.prototype.writeInt32LE=function(q,k,J){return q=+q,k|=0,J||$(this,q,k,4,2147483647,-2147483648),u.TYPED_ARRAY_SUPPORT?(this[k]=255&q,this[k+1]=q>>>8,this[k+2]=q>>>16,this[k+3]=q>>>24):X(this,q,k,!0),k+4},u.prototype.writeInt32BE=function(q,k,J){return q=+q,k|=0,J||$(this,q,k,4,2147483647,-2147483648),q<0&&(q=4294967295+q+1),u.TYPED_ARRAY_SUPPORT?(this[k]=q>>>24,this[k+1]=q>>>16,this[k+2]=q>>>8,this[k+3]=255&q):X(this,q,k,!1),k+4},u.prototype.writeFloatLE=function(q,k,J){return re(this,q,k,!0,J)},u.prototype.writeFloatBE=function(q,k,J){return re(this,q,k,!1,J)},u.prototype.writeDoubleLE=function(q,k,J){return ye(this,q,k,!0,J)},u.prototype.writeDoubleBE=function(q,k,J){return ye(this,q,k,!1,J)},u.prototype.copy=function(q,k,J,Y){if(J||(J=0),Y||Y===0||(Y=this.length),k>=q.length&&(k=q.length),k||(k=0),Y>0&&Y<J&&(Y=J),Y===J||q.length===0||this.length===0)return 0;if(k<0)throw new RangeError("targetStart out of bounds");if(J<0||J>=this.length)throw new RangeError("sourceStart out of bounds");if(Y<0)throw new RangeError("sourceEnd out of bounds");Y>this.length&&(Y=this.length),q.length-k<Y-J&&(Y=q.length-k+J);var ie,ue=Y-J;if(this===q&&J<k&&k<Y)for(ie=ue-1;ie>=0;--ie)q[ie+k]=this[ie+J];else if(ue<1e3||!u.TYPED_ARRAY_SUPPORT)for(ie=0;ie<ue;++ie)q[ie+k]=this[ie+J];else Uint8Array.prototype.set.call(q,this.subarray(J,J+ue),k);return ue},u.prototype.fill=function(q,k,J,Y){if(typeof q=="string"){if(typeof k=="string"?(Y=k,k=0,J=this.length):typeof J=="string"&&(Y=J,J=this.length),q.length===1){var ie=q.charCodeAt(0);ie<256&&(q=ie)}if(Y!==void 0&&typeof Y!="string")throw new TypeError("encoding must be a string");if(typeof Y=="string"&&!u.isEncoding(Y))throw new TypeError("Unknown encoding: "+Y)}else typeof q=="number"&&(q&=255);if(k<0||this.length<k||this.length<J)throw new RangeError("Out of range index");if(J<=k)return this;var ue;if(k>>>=0,J=J===void 0?this.length:J>>>0,q||(q=0),typeof q=="number")for(ue=k;ue<J;++ue)this[ue]=q;else{var fe=u.isBuffer(q)?q:we(new u(q,Y).toString()),Se=fe.length;for(ue=0;ue<J-k;++ue)this[ue+k]=fe[ue%Se]}return this};var me=/[^+\/0-9A-Za-z-_]/g;function Ce(q){return q<16?"0"+q.toString(16):q.toString(16)}function we(q,k){var J;k=k||1/0;for(var Y=q.length,ie=null,ue=[],fe=0;fe<Y;++fe){if((J=q.charCodeAt(fe))>55295&&J<57344){if(!ie){if(J>56319){(k-=3)>-1&&ue.push(239,191,189);continue}if(fe+1===Y){(k-=3)>-1&&ue.push(239,191,189);continue}ie=J;continue}if(J<56320){(k-=3)>-1&&ue.push(239,191,189),ie=J;continue}J=65536+(ie-55296<<10|J-56320)}else ie&&(k-=3)>-1&&ue.push(239,191,189);if(ie=null,J<128){if((k-=1)<0)break;ue.push(J)}else if(J<2048){if((k-=2)<0)break;ue.push(J>>6|192,63&J|128)}else if(J<65536){if((k-=3)<0)break;ue.push(J>>12|224,J>>6&63|128,63&J|128)}else{if(!(J<1114112))throw new Error("Invalid code point");if((k-=4)<0)break;ue.push(J>>18|240,J>>12&63|128,J>>6&63|128,63&J|128)}}return ue}function Ae(q){return o.toByteArray((function(k){if((k=(function(J){return J.trim?J.trim():J.replace(/^\s+|\s+$/g,"")})(k).replace(me,"")).length<2)return"";for(;k.length%4!=0;)k+="=";return k})(q))}function De(q,k,J,Y){for(var ie=0;ie<Y&&!(ie+J>=k.length||ie>=q.length);++ie)k[ie+J]=q[ie];return ie}}).call(this,i(78))},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.isASCIIByte=function(a){return a>=0&&a<=127}},function(n,r,i){var a=this&&this.__read||function(s,l){var c=typeof Symbol=="function"&&s[Symbol.iterator];if(!c)return s;var f,u,d=c.call(s),h=[];try{for(;(l===void 0||l-- >0)&&!(f=d.next()).done;)h.push(f.value)}catch(p){u={error:p}}finally{try{f&&!f.done&&(c=d.return)&&c.call(d)}finally{if(u)throw u.error}}return h},o=this&&this.__spread||function(){for(var s=[],l=0;l<arguments.length;l++)s=s.concat(a(arguments[l]));return s};Object.defineProperty(r,"__esModule",{value:!0}),r.length=function(s){return s.length},r.byteLowercase=function(s){for(var l=0;l<s.length;l++){var c=s[l];c>=65&&c<=90&&(s[l]=c+32)}},r.byteUppercase=function(s){for(var l=0;l<s.length;l++){var c=s[l];c>=97&&c<=122&&(s[l]=c-32)}},r.byteCaseInsensitiveMatch=function(s,l){if(s.length!==l.length)return!1;for(var c=0;c<s.length;c++){var f=s[c],u=l[c];if(f>=65&&f<=90&&(f+=32),u>=65&&u<=90&&(u+=32),f!==u)return!1}return!0},r.startsWith=function(s,l){for(var c=0;;){if(c>=s.length)return!1;if(c>=l.length)return!0;if(s[c]!==l[c])return!1;c++}},r.byteLessThan=function(s,l){for(var c=0;;){if(c>=s.length)return!1;if(c>=l.length)return!0;var f=s[c],u=l[c];if(f<u)return!0;if(f>u)return!1;c++}},r.isomorphicDecode=function(s){return String.fromCodePoint.apply(String,o(s))}},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(6),o=i(7),s=i(0),l=i(12),c=(function(){function f(u){this._associatedDocument=u||a.dom.window.document}return f.prototype.createDocumentType=function(u,d,h){return s.namespace_validate(u),s.create_documentType(this._associatedDocument,u,d,h)},f.prototype.createDocument=function(u,d,h){h===void 0&&(h=null);var p=s.create_xmlDocument(),g=null;return d&&(g=s.document_internalCreateElementNS(p,u,d)),h&&p.appendChild(h),g&&p.appendChild(g),p._origin=this._associatedDocument._origin,u===o.namespace.HTML?p._contentType="application/xhtml+xml":u===o.namespace.SVG?p._contentType="image/svg+xml":p._contentType="application/xml",p},f.prototype.createHTMLDocument=function(u){var d=s.create_document();d._type="html",d._contentType="text/html",d.appendChild(s.create_documentType(d,"html","",""));var h=s.element_createAnElement(d,"html",o.namespace.HTML);d.appendChild(h);var p=s.element_createAnElement(d,"head",o.namespace.HTML);if(h.appendChild(p),u!==void 0){var g=s.element_createAnElement(d,"title",o.namespace.HTML);p.appendChild(g);var m=s.create_text(d,u);g.appendChild(m)}var y=s.element_createAnElement(d,"body",o.namespace.HTML);return h.appendChild(y),d._origin=this._associatedDocument._origin,d},f.prototype.hasFeature=function(){return!0},f._create=function(u){return new f(u)},f})();r.DOMImplementationImpl=c,l.idl_defineConst(c.prototype,"_ID","@oozcitak/dom")},function(n,r,i){var a,o=this&&this.__extends||(a=function(u,d){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,p){h.__proto__=p}||function(h,p){for(var g in p)p.hasOwnProperty(g)&&(h[g]=p[g])})(u,d)},function(u,d){function h(){this.constructor=u}a(u,d),u.prototype=d===null?Object.create(d):(h.prototype=d.prototype,new h)});Object.defineProperty(r,"__esModule",{value:!0});var s=i(70),l=i(1),c=i(0),f=(function(u){function d(){var h=u.call(this)||this;return h._signalSlots=new Set,h._mutationObserverMicrotaskQueued=!1,h._mutationObservers=new Set,h._iteratorList=new l.FixedSizeSet,h._associatedDocument=c.create_document(),h}return o(d,u),Object.defineProperty(d.prototype,"document",{get:function(){return this._associatedDocument},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"event",{get:function(){return this._currentEvent},enumerable:!0,configurable:!0}),d._create=function(){return new d},d})(s.EventTargetImpl);r.WindowImpl=f},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(2),o=(function(){function s(){}return s.isNode=function(l){return!!l&&l._nodeType!==void 0},s.isDocumentNode=function(l){return s.isNode(l)&&l._nodeType===a.NodeType.Document},s.isDocumentTypeNode=function(l){return s.isNode(l)&&l._nodeType===a.NodeType.DocumentType},s.isDocumentFragmentNode=function(l){return s.isNode(l)&&l._nodeType===a.NodeType.DocumentFragment},s.isAttrNode=function(l){return s.isNode(l)&&l._nodeType===a.NodeType.Attribute},s.isCharacterDataNode=function(l){if(!s.isNode(l))return!1;var c=l._nodeType;return c===a.NodeType.Text||c===a.NodeType.ProcessingInstruction||c===a.NodeType.Comment||c===a.NodeType.CData},s.isTextNode=function(l){return s.isNode(l)&&(l._nodeType===a.NodeType.Text||l._nodeType===a.NodeType.CData)},s.isExclusiveTextNode=function(l){return s.isNode(l)&&l._nodeType===a.NodeType.Text},s.isCDATASectionNode=function(l){return s.isNode(l)&&l._nodeType===a.NodeType.CData},s.isCommentNode=function(l){return s.isNode(l)&&l._nodeType===a.NodeType.Comment},s.isProcessingInstructionNode=function(l){return s.isNode(l)&&l._nodeType===a.NodeType.ProcessingInstruction},s.isElementNode=function(l){return s.isNode(l)&&l._nodeType===a.NodeType.Element},s.isCustomElementNode=function(l){return s.isElementNode(l)&&l._customElementState==="custom"},s.isShadowRoot=function(l){return!!l&&l.host!==void 0},s.isMouseEvent=function(l){return!!l&&l.screenX!==void 0&&l.screenY!=null},s.isSlotable=function(l){return!!l&&l._name!==void 0&&l._assignedSlot!==void 0&&(s.isTextNode(l)||s.isElementNode(l))},s.isSlot=function(l){return!!l&&l._name!==void 0&&l._assignedNodes!==void 0&&s.isElementNode(l)},s.isWindow=function(l){return!!l&&l.navigator!==void 0},s.isEventListener=function(l){return!!l&&l.handleEvent!==void 0},s.isRegisteredObserver=function(l){return!!l&&l.observer!==void 0&&l.options!==void 0},s.isTransientRegisteredObserver=function(l){return!!l&&l.source!==void 0&&s.isRegisteredObserver(l)},s})();r.Guard=o},function(n,r,i){var a,o=this&&this.__extends||(a=function(l,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,u){f.__proto__=u}||function(f,u){for(var d in u)u.hasOwnProperty(d)&&(f[d]=u[d])})(l,c)},function(l,c){function f(){this.constructor=l}a(l,c),l.prototype=c===null?Object.create(c):(f.prototype=c.prototype,new f)});Object.defineProperty(r,"__esModule",{value:!0});var s=(function(l){function c(){return l.call(this)||this}return o(c,l),c})(i(98).DocumentImpl);r.XMLDocumentImpl=s},function(n,r,i){var a=this&&this.__values||function(Y){var ie=typeof Symbol=="function"&&Symbol.iterator,ue=ie&&Y[ie],fe=0;if(ue)return ue.call(Y);if(Y&&typeof Y.length=="number")return{next:function(){return Y&&fe>=Y.length&&(Y=void 0),{value:Y&&Y[fe++],done:!Y}}};throw new TypeError(ie?"Object is not iterable.":"Symbol.iterator is not defined.")},o=this&&this.__read||function(Y,ie){var ue=typeof Symbol=="function"&&Y[Symbol.iterator];if(!ue)return Y;var fe,Se,Fe=ue.call(Y),Ke=[];try{for(;(ie===void 0||ie-- >0)&&!(fe=Fe.next()).done;)Ke.push(fe.value)}catch(He){Se={error:He}}finally{try{fe&&!fe.done&&(ue=Fe.return)&&ue.call(Fe)}finally{if(Se)throw Se.error}}return Ke};Object.defineProperty(r,"__esModule",{value:!0});var s,l=i(1),c=i(243),f=i(7),u=i(244),d={ftp:21,file:null,http:80,https:443,ws:80,wss:443},h=/[\0-\x1F\x7F-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,p=/[ "<>`]|[\0-\x1F\x7F-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,g=/[ "<>`#?{}]|[\0-\x1F\x7F-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,m=/[ "<>`#?{}/:;=@\[\]\\\^\|]|[\0-\x1F\x7F-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,y=/[0-9A-Za-z!\$&-\/:;=\?@_~\xA0-\uD7FF\uE000-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uD83E\uD840-\uD87E\uD880-\uD8BE\uD8C0-\uD8FE\uD900-\uD93E\uD940-\uD97E\uD980-\uD9BE\uD9C0-\uD9FE\uDA00-\uDA3E\uDA40-\uDA7E\uDA80-\uDABE\uDAC0-\uDAFE\uDB00-\uDB3E\uDB40-\uDB7E\uDB80-\uDBBE\uDBC0-\uDBFE][\uDC00-\uDFFF]|[\uD83F\uD87F\uD8BF\uD8FF\uD93F\uD97F\uD9BF\uD9FF\uDA3F\uDA7F\uDABF\uDAFF\uDB3F\uDB7F\uDBBF\uDBFF][\uDC00-\uDFFD]/,v=/[\0\t\f\r #%/:?@\[\\\]]/;function x(Y){s!==void 0&&s.call(null,"Validation Error: "+Y)}function w(){return{scheme:"",username:"",password:"",host:null,port:null,path:[],query:null,fragment:null,_cannotBeABaseURLFlag:!1,_blobURLEntry:null}}function S(Y){return Y in d}function T(Y){return S(Y.scheme)}function _(Y){return d[Y]||null}function D(Y){return Y.username!==""||Y.password!==""}function I(Y,ie){var ue,fe;ie===void 0&&(ie=!1);var Se=Y.scheme+":";if(Y.host!==null?(Se+="//",D(Y)&&(Se+=Y.username,Y.password!==""&&(Se+=":"+Y.password),Se+="@"),Se+=R(Y.host),Y.port!==null&&(Se+=":"+Y.port)):Y.host===null&&Y.scheme==="file"&&(Se+="//"),Y._cannotBeABaseURLFlag)Se+=Y.path[0];else try{for(var Fe=a(Y.path),Ke=Fe.next();!Ke.done;Ke=Fe.next())Se+="/"+Ke.value}catch(He){ue={error:He}}finally{try{Ke&&!Ke.done&&(fe=Fe.return)&&fe.call(Fe)}finally{if(ue)throw ue.error}}return Y.query!==null&&(Se+="?"+Y.query),ie||Y.fragment===null||(Se+="#"+Y.fragment),Se}function R(Y){return l.isNumber(Y)?M(Y):l.isArray(Y)?"["+A(Y)+"]":Y}function M(Y){for(var ie="",ue=Y,fe=1;fe<=4;fe++)ie=(ue%256).toString()+ie,fe!==4&&(ie="."+ie),ue=Math.floor(ue/256);return ie}function A(Y){for(var ie="",ue=null,fe=-1,Se=0,Fe=0,Ke=0;Ke<8;Ke++)if(Y[Ke]===0){Se=1;for(var He=Ke+1;He<8&&Y[He]===0;He++)Se++;Se>Fe&&(Fe=Se,fe=Ke)}Fe>1&&(ue=fe);for(var pe=!1,ge=0;ge<8;ge++)pe&&Y[ge]===0||(pe&&(pe=!1),ue!==ge?(ie+=Y[ge].toString(16),ge!==7&&(ie+=":")):(ie+=ge===0?"::":":",pe=!0));return ie}function L(Y,ie,ue,fe,Se){var Fe,Ke,He,pe;if(fe===void 0){fe={scheme:"",username:"",password:"",host:null,port:null,path:[],query:null,fragment:null,_cannotBeABaseURLFlag:!1,_blobURLEntry:null};var ge=/^[\u0000-\u001F\u0020]+/,Ie=/[\u0000-\u001F\u0020]+$/;(ge.test(Y)||Ie.test(Y))&&x("Input string contains leading or trailing control characters or space."),Y=(Y=Y.replace(ge,"")).replace(Ie,"")}var ve=/[\u0009\u000A\u000D]/g;ve.test(Y)&&x("Input string contains tab or newline characters."),Y=Y.replace(ve,"");var _e=Se===void 0?c.ParserState.SchemeStart:Se;ie===void 0&&(ie=null);for(var Pe=ue===void 0||ue==="replacement"||ue==="UTF-16BE"||ue==="UTF-16LE"?"UTF-8":ue,ne="",Je=!1,$e=!1,ke=!1,Re=new l.StringWalker(Y);;){switch(_e){case c.ParserState.SchemeStart:if(f.codePoint.ASCIIAlpha.test(Re.c()))ne+=Re.c().toLowerCase(),_e=c.ParserState.Scheme;else{if(Se!==void 0)return x("Invalid scheme start character."),null;_e=c.ParserState.NoScheme,Re.pointer--}break;case c.ParserState.Scheme:if(f.codePoint.ASCIIAlphanumeric.test(Re.c())||Re.c()==="+"||Re.c()==="-"||Re.c()===".")ne+=Re.c().toLowerCase();else{if(Re.c()!==":"){if(Se===void 0){ne="",_e=c.ParserState.NoScheme,Re.pointer=0;continue}return x("Invalid input string."),null}if(Se!==void 0&&(S(fe.scheme)&&!S(ne)||!S(fe.scheme)&&S(ne)||(D(fe)||fe.port!==null)&&ne==="file"||fe.scheme==="file"&&(fe.host===""||fe.host===null)))return fe;if(fe.scheme=ne,Se!==void 0)return fe.port===_(fe.scheme)&&(fe.port=null),fe;ne="",fe.scheme==="file"?(Re.remaining().startsWith("//")||x("Invalid file URL scheme, '//' expected."),_e=c.ParserState.File):T(fe)&&ie!==null&&ie.scheme===fe.scheme?_e=c.ParserState.SpecialRelativeOrAuthority:T(fe)?_e=c.ParserState.SpecialAuthoritySlashes:Re.remaining().startsWith("/")?(_e=c.ParserState.PathOrAuthority,Re.pointer++):(fe._cannotBeABaseURLFlag=!0,fe.path.push(""),_e=c.ParserState.CannotBeABaseURLPath)}break;case c.ParserState.NoScheme:if(ie===null||ie._cannotBeABaseURLFlag&&Re.c()!=="#")return x("Invalid input string."),null;ie._cannotBeABaseURLFlag&&Re.c()==="#"?(fe.scheme=ie.scheme,fe.path=f.list.clone(ie.path),fe.query=ie.query,fe.fragment="",fe._cannotBeABaseURLFlag=!0,_e=c.ParserState.Fragment):ie.scheme!=="file"?(_e=c.ParserState.Relative,Re.pointer--):(_e=c.ParserState.File,Re.pointer--);break;case c.ParserState.SpecialRelativeOrAuthority:Re.c()==="/"&&Re.remaining().startsWith("/")?(_e=c.ParserState.SpecialAuthorityIgnoreSlashes,Re.pointer++):(x("Invalid input string."),_e=c.ParserState.Relative,Re.pointer--);break;case c.ParserState.PathOrAuthority:Re.c()==="/"?_e=c.ParserState.Authority:(_e=c.ParserState.Path,Re.pointer--);break;case c.ParserState.Relative:if(ie===null)throw new Error("Invalid parser state. Base URL is null.");switch(fe.scheme=ie.scheme,Re.c()){case"":fe.username=ie.username,fe.password=ie.password,fe.host=ie.host,fe.port=ie.port,fe.path=f.list.clone(ie.path),fe.query=ie.query;break;case"/":_e=c.ParserState.RelativeSlash;break;case"?":fe.username=ie.username,fe.password=ie.password,fe.host=ie.host,fe.port=ie.port,fe.path=f.list.clone(ie.path),fe.query="",_e=c.ParserState.Query;break;case"#":fe.username=ie.username,fe.password=ie.password,fe.host=ie.host,fe.port=ie.port,fe.path=f.list.clone(ie.path),fe.query=ie.query,fe.fragment="",_e=c.ParserState.Fragment;break;default:T(fe)&&Re.c()==="\\"?(x("Invalid input string."),_e=c.ParserState.RelativeSlash):(fe.username=ie.username,fe.password=ie.password,fe.host=ie.host,fe.port=ie.port,fe.path=f.list.clone(ie.path),fe.path.length!==0&&fe.path.splice(fe.path.length-1,1),_e=c.ParserState.Path,Re.pointer--)}break;case c.ParserState.RelativeSlash:if(!T(fe)||Re.c()!=="/"&&Re.c()!=="\\")if(Re.c()==="/")_e=c.ParserState.Authority;else{if(ie===null)throw new Error("Invalid parser state. Base URL is null.");fe.username=ie.username,fe.password=ie.password,fe.host=ie.host,fe.port=ie.port,_e=c.ParserState.Path,Re.pointer--}else Re.c()==="\\"&&x("Invalid input string."),_e=c.ParserState.SpecialAuthorityIgnoreSlashes;break;case c.ParserState.SpecialAuthoritySlashes:Re.c()==="/"&&Re.remaining().startsWith("/")?(_e=c.ParserState.SpecialAuthorityIgnoreSlashes,Re.pointer++):(x("Expected '//'."),_e=c.ParserState.SpecialAuthorityIgnoreSlashes,Re.pointer--);break;case c.ParserState.SpecialAuthorityIgnoreSlashes:Re.c()!=="/"&&Re.c()!=="\\"?(_e=c.ParserState.Authority,Re.pointer--):x("Unexpected '/' or '\\'.");break;case c.ParserState.Authority:if(Re.c()==="@"){x("Unexpected '@'."),Je&&(ne="%40"+ne),Je=!0;try{for(var ze=(Fe=void 0,a(ne)),st=ze.next();!st.done;st=ze.next()){var Qe=st.value;if(Qe!==":"||ke){var _t=De(Qe,m);ke?fe.password+=_t:fe.username+=_t}else ke=!0}}catch(dn){Fe={error:dn}}finally{try{st&&!st.done&&(Ke=ze.return)&&Ke.call(ze)}finally{if(Fe)throw Fe.error}}ne=""}else if(Re.c()===""||Re.c()==="/"||Re.c()==="?"||Re.c()==="#"||T(fe)&&Re.c()==="\\"){if(Je&&ne==="")return x("Invalid input string."),null;Re.pointer-=ne.length+1,ne="",_e=c.ParserState.Host}else ne+=Re.c();break;case c.ParserState.Host:case c.ParserState.Hostname:if(Se!==void 0&&fe.scheme==="file")Re.pointer--,_e=c.ParserState.FileHost;else if(Re.c()!==":"||$e)if(Re.c()===""||Re.c()==="/"||Re.c()==="?"||Re.c()==="#"||T(fe)&&Re.c()==="\\"){if(Re.pointer--,T(fe)&&ne==="")return x("Invalid input string."),null;if(Se!==void 0&&ne===""&&(D(fe)||fe.port!==null))return x("Invalid input string."),fe;if((We=V(ne,!T(fe)))===null)return null;if(fe.host=We,ne="",_e=c.ParserState.PathStart,Se!==void 0)return fe}else Re.c()==="["&&($e=!0),Re.c()==="]"&&($e=!1),ne+=Re.c();else{if(ne==="")return x("Invalid input string."),null;if((We=V(ne,!T(fe)))===null)return null;if(fe.host=We,ne="",_e=c.ParserState.Port,Se===c.ParserState.Hostname)return fe}break;case c.ParserState.Port:if(f.codePoint.ASCIIDigit.test(Re.c()))ne+=Re.c();else{if(!(Re.c()===""||Re.c()==="/"||Re.c()==="?"||Re.c()==="#"||T(fe)&&Re.c()==="\\"||Se))return x("Invalid input string."),null;if(ne!==""&&ne!==""){var Le=parseInt(ne,10);if(Le>Math.pow(2,16)-1)return x("Invalid port number."),null;fe.port=Le===_(fe.scheme)?null:Le,ne=""}if(Se!==void 0)return fe;_e=c.ParserState.PathStart,Re.pointer--}break;case c.ParserState.File:if(fe.scheme="file",Re.c()==="/"||Re.c()==="\\")Re.c()==="\\"&&x("Invalid input string."),_e=c.ParserState.FileSlash;else if(ie!==null&&ie.scheme==="file")switch(Re.c()){case"":fe.host=ie.host,fe.path=f.list.clone(ie.path),fe.query=ie.query;break;case"?":fe.host=ie.host,fe.path=f.list.clone(ie.path),fe.query="",_e=c.ParserState.Query;break;case"#":fe.host=ie.host,fe.path=f.list.clone(ie.path),fe.query=ie.query,fe.fragment="",_e=c.ParserState.Fragment;break;default:$(Re.substring())?x("Unexpected windows drive letter in input string."):(fe.host=ie.host,fe.path=f.list.clone(ie.path),U(fe)),_e=c.ParserState.Path,Re.pointer--}else _e=c.ParserState.Path,Re.pointer--;break;case c.ParserState.FileSlash:Re.c()==="/"||Re.c()==="\\"?(Re.c()==="\\"&&x("Invalid input string."),_e=c.ParserState.FileHost):(ie===null||ie.scheme!=="file"||$(Re.substring())||(G(ie.path[0])?fe.path.push(ie.path[0]):fe.host=ie.host),_e=c.ParserState.Path,Re.pointer--);break;case c.ParserState.FileHost:if(Re.c()===""||Re.c()==="/"||Re.c()==="\\"||Re.c()==="?"||Re.c()==="#")if(Re.pointer--,Se===void 0&&F(ne))x("Unexpected windows drive letter in input string."),_e=c.ParserState.Path;else if(ne===""){if(fe.host="",Se!==void 0)return fe;_e=c.ParserState.PathStart}else{var We;if((We=V(ne,!T(fe)))===null)return null;if(We==="localhost"&&(We=""),fe.host=We,Se!==void 0)return fe;ne="",_e=c.ParserState.PathStart}else ne+=Re.c();break;case c.ParserState.PathStart:T(fe)?(Re.c()==="\\"&&x("Invalid input string."),_e=c.ParserState.Path,Re.c()!=="/"&&Re.c()!=="\\"&&Re.pointer--):Se===void 0&&Re.c()==="?"?(fe.query="",_e=c.ParserState.Query):Se===void 0&&Re.c()==="#"?(fe.fragment="",_e=c.ParserState.Fragment):Re.c()!==""&&(_e=c.ParserState.Path,Re.c()!=="/"&&Re.pointer--);break;case c.ParserState.Path:if(Re.c()===""||Re.c()==="/"||T(fe)&&Re.c()==="\\"||Se===void 0&&(Re.c()==="?"||Re.c()==="#")){if(T(fe)&&Re.c()==="\\"&&x("Invalid input string."),B(ne))U(fe),Re.c()==="/"||T(fe)&&Re.c()==="\\"||fe.path.push("");else if(!P(ne)||Re.c()==="/"||T(fe)&&Re.c()==="\\"){if(!P(ne)){if(fe.scheme==="file"&&fe.path.length===0&&F(ne)){fe.host!==null&&fe.host!==""&&(x("Invalid input string."),fe.host="");var xt=Array.from(ne);ne=xt.slice(0,1)+":"+xt.slice(2)}fe.path.push(ne)}}else fe.path.push("");if(ne="",fe.scheme==="file"&&(Re.c()===""||Re.c()==="?"||Re.c()==="#"))for(;fe.path.length>1&&fe.path[0]==="";)x("Invalid input string."),fe.path.splice(0,1);Re.c()==="?"&&(fe.query="",_e=c.ParserState.Query),Re.c()==="#"&&(fe.fragment="",_e=c.ParserState.Fragment)}else y.test(Re.c())||Re.c()==="%"||x("Character is not a URL code point or a percent encoded character."),Re.c()!=="%"||/^[0-9a-fA-F][0-9a-fA-F]/.test(Re.remaining())||x("Percent encoded character must be followed by two hex digits."),ne+=De(Re.c(),g);break;case c.ParserState.CannotBeABaseURLPath:Re.c()==="?"?(fe.query="",_e=c.ParserState.Query):Re.c()==="#"?(fe.fragment="",_e=c.ParserState.Fragment):(Re.c()===""||y.test(Re.c())||Re.c()==="%"||x("Character is not a URL code point or a percent encoded character."),Re.c()!=="%"||/^[0-9a-fA-F][0-9a-fA-F]/.test(Re.remaining())||x("Percent encoded character must be followed by two hex digits."),Re.c()!==""&&(fe.path[0]+=De(Re.c(),h)));break;case c.ParserState.Query:if(Pe==="UTF-8"||T(fe)&&fe.scheme!=="ws"&&fe.scheme!=="wss"||(Pe="UTF-8"),Se===void 0&&Re.c()==="#")fe.fragment="",_e=c.ParserState.Fragment;else if(Re.c()!==""){if(y.test(Re.c())||Re.c()==="%"||x("Character is not a URL code point or a percent encoded character."),Re.c()!=="%"||/^[0-9a-fA-F][0-9a-fA-F]/.test(Re.remaining())||x("Percent encoded character must be followed by two hex digits."),Pe.toUpperCase()!=="UTF-8")throw new Error("Only UTF-8 encoding is supported.");var Ut=l.utf8Encode(Re.c());if(Ut.length>=3&&Ut[0]===38&&Ut[1]===35&&Ut[Ut.length-1]===59)Ut=Ut.subarray(2,Ut.length-1),fe.query+="%26%23"+f.byteSequence.isomorphicDecode(Ut)+"%3B";else try{for(var gn=(He=void 0,a(Ut)),tn=gn.next();!tn.done;tn=gn.next()){var Ht=tn.value;Ht<33||Ht>126||Ht===34||Ht===35||Ht===60||Ht===62||Ht===39&&T(fe)?fe.query+=Ce(Ht):fe.query+=String.fromCharCode(Ht)}}catch(dn){He={error:dn}}finally{try{tn&&!tn.done&&(pe=gn.return)&&pe.call(gn)}finally{if(He)throw He.error}}}break;case c.ParserState.Fragment:Re.c()===""||(Re.c()==="\0"?x("NULL character in input string."):(y.test(Re.c())||Re.c()==="%"||x("Unexpected character in fragment string."),Re.c()!=="%"||/^[A-Za-z0-9][A-Za-z0-9]/.test(Re.remaining())||x("Unexpected character in fragment string."),fe.fragment+=De(Re.c(),p)))}if(Re.eof)break;Re.pointer++}return fe}function P(Y){return Y==="."||Y.toLowerCase()==="%2e"}function B(Y){var ie=Y.toLowerCase();return ie===".."||ie===".%2e"||ie==="%2e."||ie==="%2e%2e"}function U(Y){var ie=Y.path;ie.length!==0&&(Y.scheme==="file"&&ie.length===1&&G(ie[0])||Y.path.splice(Y.path.length-1,1))}function G(Y){return Y.length>=2&&f.codePoint.ASCIIAlpha.test(Y[0])&&Y[1]===":"}function F(Y){return Y.length>=2&&f.codePoint.ASCIIAlpha.test(Y[0])&&(Y[1]===":"||Y[1]==="|")}function $(Y){return Y.length>=2&&F(Y)&&(Y.length===2||Y[2]==="/"||Y[2]==="\\"||Y[2]==="?"||Y[2]==="#")}function V(Y,ie){if(ie===void 0&&(ie=!1),Y.startsWith("["))return Y.endsWith("]")?re(Y.substring(1,Y.length-1)):(x("Expected ']' after '['."),null);if(ie)return ye(Y);var ue=J(l.utf8Decode(Ae(Y)));if(ue===null||v.test(ue))return x("Invalid domain."),null;var fe=Q(ue);return fe===null||l.isNumber(fe)?fe:ue}function X(Y,ie){ie===void 0&&(ie={value:!1});var ue=10;return Y.startsWith("0x")||Y.startsWith("0X")?(ie.value=!0,Y=Y.substr(2),ue=16):Y.length>=2&&Y[0]==="0"&&(ie.value=!0,Y=Y.substr(1),ue=8),Y===""?0:(ue===10?/^[0-9]+$/:ue===16?/^[0-9A-Fa-f]+$/:/^[0-7]+$/).test(Y)?parseInt(Y,ue):null}function Q(Y){var ie,ue,fe,Se,Fe={value:!1},Ke=Y.split(".");if(Ke[Ke.length-1]===""&&(Fe.value=!0,Ke.length>1&&Ke.pop()),Ke.length>4)return Y;var He=[];try{for(var pe=a(Ke),ge=pe.next();!ge.done;ge=pe.next()){var Ie=ge.value;if(Ie===""||($e=X(Ie,Fe))===null)return Y;He.push($e)}}catch(ke){ie={error:ke}}finally{try{ge&&!ge.done&&(ue=pe.return)&&ue.call(pe)}finally{if(ie)throw ie.error}}Fe.value&&x("Invalid IP v4 address.");for(var ve=0;ve<He.length;ve++)if(He[ve]>255&&(x("Invalid IP v4 address."),ve<He.length-1))return null;if(He[He.length-1]>=Math.pow(256,5-He.length))return x("Invalid IP v4 address."),null;var _e=He[He.length-1];He.pop();var Pe=0;try{for(var ne=a(He),Je=ne.next();!Je.done;Je=ne.next()){var $e;_e+=($e=Je.value)*Math.pow(256,3-Pe),Pe++}}catch(ke){fe={error:ke}}finally{try{Je&&!Je.done&&(Se=ne.return)&&Se.call(ne)}finally{if(fe)throw fe.error}}return _e}function re(Y){var ie,ue=[0,0,0,0,0,0,0,0],fe=0,Se=null,Fe=new l.StringWalker(Y);if(Fe.c()===":"){if(!Fe.remaining().startsWith(":"))return x("Invalid IP v6 address."),null;Fe.pointer+=2,Se=fe+=1}for(;Fe.c()!=="";){if(fe===8)return x("Invalid IP v6 address."),null;if(Fe.c()!==":"){for(var Ke=0,He=0;He<4&&f.codePoint.ASCIIHexDigit.test(Fe.c());)Ke=16*Ke+parseInt(Fe.c(),16),Fe.pointer++,He++;if(Fe.c()==="."){if(He===0||(Fe.pointer-=He,fe>6))return x("Invalid IP v6 address."),null;for(var pe=0;Fe.c()!=="";){var ge=null;if(pe>0){if(!(Fe.c()==="."&&pe<4))return x("Invalid IP v6 address."),null;Fe.pointer++}if(!f.codePoint.ASCIIDigit.test(Fe.c()))return x("Invalid IP v6 address."),null;for(;f.codePoint.ASCIIDigit.test(Fe.c());){var Ie=parseInt(Fe.c(),10);if(ge===null)ge=Ie;else{if(ge===0)return x("Invalid IP v6 address."),null;ge=10*ge+Ie}if(ge>255)return x("Invalid IP v6 address."),null;Fe.pointer++}if(ge===null)return x("Invalid IP v6 address."),null;ue[fe]=256*ue[fe]+ge,++pe!==2&&pe!==4||fe++}if(pe!==4)return x("Invalid IP v6 address."),null;break}if(Fe.c()===":"){if(Fe.pointer++,Fe.c()==="")return x("Invalid IP v6 address."),null}else if(Fe.c()!=="")return x("Invalid IP v6 address."),null;ue[fe]=Ke,fe++}else{if(Se!==null)return x("Invalid IP v6 address."),null;Fe.pointer++,Se=++fe}}if(Se!==null){var ve=fe-Se;for(fe=7;fe!==0&&ve>0;)ie=o([ue[Se+ve-1],ue[fe]],2),ue[fe]=ie[0],ue[Se+ve-1]=ie[1],fe--,ve--}else if(Se===null&&fe!==8)return x("Invalid IP v6 address."),null;return ue}function ye(Y){var ie,ue;if(/[\x00\t\f\r #/:?@\[\\\]]/.test(Y))return x("Invalid host string."),null;var fe="";try{for(var Se=a(Y),Fe=Se.next();!Fe.done;Fe=Se.next())fe+=De(Fe.value,h)}catch(Ke){ie={error:Ke}}finally{try{Fe&&!Fe.done&&(ue=Se.return)&&ue.call(Se)}finally{if(ie)throw ie.error}}return fe}function me(Y){return null}function Ce(Y){return"%"+("00"+Y.toString(16).toUpperCase()).slice(-2)}function we(Y){for(var ie=function(He){return He>=48&&He<=57||He>=65&&He<=70||He>=97&&He<=102},ue=new Uint8Array(Y.length),fe=0,Se=0;Se<Y.length;Se++){var Fe=Y[Se];if(Fe!==37)ue[fe]=Fe,fe++;else if(Fe===37&&Se>=Y.length-2)ue[fe]=Fe,fe++;else if(Fe!==37||ie(Y[Se+1])&&ie(Y[Se+2])){var Ke=parseInt(l.utf8Decode(Uint8Array.of(Y[Se+1],Y[Se+2])),16);ue[fe]=Ke,fe++,Se+=2}else ue[fe]=Fe,fe++}return ue.subarray(0,fe)}function Ae(Y){return we(l.utf8Encode(Y))}function De(Y,ie){var ue,fe;if(!ie.test(Y))return Y;var Se=l.utf8Encode(Y),Fe="";try{for(var Ke=a(Se),He=Ke.next();!He.done;He=Ke.next())Fe+=Ce(He.value)}catch(pe){ue={error:pe}}finally{try{He&&!He.done&&(fe=Ke.return)&&fe.call(Ke)}finally{if(ue)throw ue.error}}return Fe}function q(Y){var ie,ue,fe,Se,Fe=[],Ke=[];try{for(var He=a(Y),pe=He.next();!pe.done;pe=He.next()){var ge=pe.value;ge===38?(Fe.push(Uint8Array.from(Ke)),Ke=[]):Ke.push(ge)}}catch(st){ie={error:st}}finally{try{pe&&!pe.done&&(ue=He.return)&&ue.call(He)}finally{if(ie)throw ie.error}}Ke.length!==0&&Fe.push(Uint8Array.from(Ke));var Ie=[];try{for(var ve=a(Fe),_e=ve.next();!_e.done;_e=ve.next()){var Pe=_e.value;if(Pe.length!==0){for(var ne=Pe.indexOf(61),Je=ne!==-1?Pe.slice(0,ne):Pe,$e=ne!==-1?Pe.slice(ne+1):new Uint8Array,ke=0;ke<Je.length;ke++)Je[ke]===43&&(Je[ke]=32);for(ke=0;ke<$e.length;ke++)$e[ke]===43&&($e[ke]=32);var Re=l.utf8Decode(Je),ze=l.utf8Decode($e);Ie.push([Re,ze])}}}catch(st){fe={error:st}}finally{try{_e&&!_e.done&&(Se=ve.return)&&Se.call(ve)}finally{if(fe)throw fe.error}}return Ie}function k(Y){var ie,ue,fe="";try{for(var Se=a(Y),Fe=Se.next();!Fe.done;Fe=Se.next()){var Ke=Fe.value;fe+=Ke===32?"+":Ke===42||Ke===45||Ke===46||Ke>=48&&Ke<=57||Ke>=65&&Ke<=90||Ke===95||Ke>=97&&Ke<=122?String.fromCodePoint(Ke):Ce(Ke)}}catch(He){ie={error:He}}finally{try{Fe&&!Fe.done&&(ue=Se.return)&&ue.call(Se)}finally{if(ie)throw ie.error}}return fe}function J(Y,ie){var ue=u.domainToASCII(Y);return ue===""?(x("Invalid domain name."),null):ue}r.setValidationErrorCallback=function(Y){s=Y},r.newURL=w,r.isSpecialScheme=S,r.isSpecial=T,r.defaultPort=_,r.includesCredentials=D,r.cannotHaveAUsernamePasswordPort=function(Y){return Y.host===null||Y.host===""||Y._cannotBeABaseURLFlag||Y.scheme==="file"},r.urlSerializer=I,r.hostSerializer=R,r.iPv4Serializer=M,r.iPv6Serializer=A,r.urlParser=function(Y,ie,ue){var fe=L(Y,ie,ue);return fe===null?null:(fe.scheme!=="blob"||(fe._blobURLEntry=null),fe)},r.basicURLParser=L,r.setTheUsername=function(Y,ie){var ue,fe,Se="";try{for(var Fe=a(ie),Ke=Fe.next();!Ke.done;Ke=Fe.next())Se+=De(Ke.value,m)}catch(He){ue={error:He}}finally{try{Ke&&!Ke.done&&(fe=Fe.return)&&fe.call(Fe)}finally{if(ue)throw ue.error}}Y.username=Se},r.setThePassword=function(Y,ie){var ue,fe,Se="";try{for(var Fe=a(ie),Ke=Fe.next();!Ke.done;Ke=Fe.next())Se+=De(Ke.value,m)}catch(He){ue={error:He}}finally{try{Ke&&!Ke.done&&(fe=Fe.return)&&fe.call(Fe)}finally{if(ue)throw ue.error}}Y.password=Se},r.isSingleDotPathSegment=P,r.isDoubleDotPathSegment=B,r.shorten=U,r.isNormalizedWindowsDriveLetter=G,r.isWindowsDriveLetter=F,r.startsWithAWindowsDriveLetter=$,r.hostParser=V,r.iPv4NumberParser=X,r.iPv4Parser=Q,r.iPv6Parser=re,r.opaqueHostParser=ye,r.resolveABlobURL=me,r.percentEncode=Ce,r.percentDecode=we,r.stringPercentDecode=Ae,r.utf8PercentEncode=De,r.hostEquals=function(Y,ie){return Y===ie},r.urlEquals=function(Y,ie,ue){return ue===void 0&&(ue=!1),I(Y,ue)===I(ie,ue)},r.urlEncodedStringParser=function(Y){return q(l.utf8Encode(Y))},r.urlEncodedParser=q,r.urlEncodedByteSerializer=k,r.urlEncodedSerializer=function(Y,ie){var ue,fe;if((ie===void 0||ie==="replacement"||ie==="UTF-16BE"||ie==="UTF-16LE"?"UTF-8":ie).toUpperCase()!=="UTF-8")throw new Error("Only UTF-8 encoding is supported.");var Se="";try{for(var Fe=a(Y),Ke=Fe.next();!Ke.done;Ke=Fe.next()){var He=Ke.value,pe=k(l.utf8Encode(He[0])),ge=He[1];ge=k(l.utf8Encode(ge)),Se!==""&&(Se+="&"),Se+=pe+"="+ge}}catch(Ie){ue={error:Ie}}finally{try{Ke&&!Ke.done&&(fe=Fe.return)&&fe.call(Fe)}finally{if(ue)throw ue.error}}return Se},r.origin=function Y(ie){switch(ie.scheme){case"blob":ie._blobURLEntry;var ue=L(ie.path[0]);return ue===null?c.OpaqueOrigin:Y(ue);case"ftp":case"http":case"https":case"ws":case"wss":return[ie.scheme,ie.host===null?"":ie.host,ie.port,null];case"file":default:return c.OpaqueOrigin}},r.domainToASCII=J,r.domainToUnicode=function(Y,ie){var ue=u.domainToUnicode(Y);return ue===""&&x("Invalid domain name."),ue},r.asciiSerializationOfAnOrigin=function(Y){if(Y[0]===""&&Y[1]===""&&Y[2]===null&&Y[3]===null)return"null";var ie=Y[0]+"://"+R(Y[1]);return Y[2]!==null&&(ie+=":"+Y[2].toString()),ie}},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(0),o=(function(){function s(){this._signal=a.create_abortSignal()}return Object.defineProperty(s.prototype,"signal",{get:function(){return this._signal},enumerable:!0,configurable:!0}),s.prototype.abort=function(){a.abort_signalAbort(this._signal)},s})();r.AbortControllerImpl=o},function(n,r,i){var a,o=this&&this.__extends||(a=function(f,u){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,h){d.__proto__=h}||function(d,h){for(var p in h)h.hasOwnProperty(p)&&(d[p]=h[p])})(f,u)},function(f,u){function d(){this.constructor=f}a(f,u),f.prototype=u===null?Object.create(u):(d.prototype=u.prototype,new d)});Object.defineProperty(r,"__esModule",{value:!0});var s=i(70),l=i(0),c=(function(f){function u(){var d=f.call(this)||this;return d._abortedFlag=!1,d._abortAlgorithms=new Set,d}return o(u,f),Object.defineProperty(u.prototype,"aborted",{get:function(){return this._abortedFlag},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"onabort",{get:function(){return l.event_getterEventHandlerIDLAttribute(this,"onabort")},set:function(d){l.event_setterEventHandlerIDLAttribute(this,"onabort",d)},enumerable:!0,configurable:!0}),u._create=function(){return new u},u})(s.EventTargetImpl);r.AbortSignalImpl=c},function(n,r,i){var a,o=this&&this.__extends||(a=function(u,d){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,p){h.__proto__=p}||function(h,p){for(var g in p)p.hasOwnProperty(g)&&(h[g]=p[g])})(u,d)},function(u,d){function h(){this.constructor=u}a(u,d),u.prototype=d===null?Object.create(d):(h.prototype=d.prototype,new h)});Object.defineProperty(r,"__esModule",{value:!0});var s=i(2),l=i(34),c=i(12),f=(function(u){function d(h,p,g){var m=u.call(this)||this;return m._name="",m._publicId="",m._systemId="",m._name=h,m._publicId=p,m._systemId=g,m}return o(d,u),Object.defineProperty(d.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"publicId",{get:function(){return this._publicId},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"systemId",{get:function(){return this._systemId},enumerable:!0,configurable:!0}),d.prototype.before=function(){for(var h=[],p=0;p<arguments.length;p++)h[p]=arguments[p];throw new Error("Mixin: ChildNode not implemented.")},d.prototype.after=function(){for(var h=[],p=0;p<arguments.length;p++)h[p]=arguments[p];throw new Error("Mixin: ChildNode not implemented.")},d.prototype.replaceWith=function(){for(var h=[],p=0;p<arguments.length;p++)h[p]=arguments[p];throw new Error("Mixin: ChildNode not implemented.")},d.prototype.remove=function(){throw new Error("Mixin: ChildNode not implemented.")},d._create=function(h,p,g,m){g===void 0&&(g=""),m===void 0&&(m="");var y=new d(p,g,m);return y._nodeDocument=h,y},d})(l.NodeImpl);r.DocumentTypeImpl=f,c.idl_defineConst(f.prototype,"_nodeType",s.NodeType.DocumentType)},function(n,r,i){var a,o=this&&this.__extends||(a=function(u,d){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,p){h.__proto__=p}||function(h,p){for(var g in p)p.hasOwnProperty(g)&&(h[g]=p[g])})(u,d)},function(u,d){function h(){this.constructor=u}a(u,d),u.prototype=d===null?Object.create(d):(h.prototype=d.prototype,new h)});Object.defineProperty(r,"__esModule",{value:!0});var s=i(100),l=i(1),c=i(0),f=(function(u){function d(h,p){var g=u.call(this)||this;return g._host=h,g._mode=p,g}return o(d,u),Object.defineProperty(d.prototype,"mode",{get:function(){return this._mode},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"host",{get:function(){return this._host},enumerable:!0,configurable:!0}),d.prototype._getTheParent=function(h){return h._composedFlag||l.isEmpty(h._path)||c.tree_rootNode(h._path[0].invocationTarget)!==this?this._host:null},d._create=function(h,p){return new d(p,"closed")},d})(s.DocumentFragmentImpl);r.ShadowRootImpl=f},function(n,r,i){var a,o=this&&this.__extends||(a=function(d,h){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(p,g){p.__proto__=g}||function(p,g){for(var m in g)g.hasOwnProperty(m)&&(p[m]=g[m])})(d,h)},function(d,h){function p(){this.constructor=d}a(d,h),d.prototype=h===null?Object.create(h):(p.prototype=h.prototype,new p)});Object.defineProperty(r,"__esModule",{value:!0});var s=i(2),l=i(34),c=i(0),f=i(12),u=(function(d){function h(p){var g=d.call(this)||this;return g._namespace=null,g._namespacePrefix=null,g._element=null,g._value="",g._localName=p,g}return o(h,d),Object.defineProperty(h.prototype,"ownerElement",{get:function(){return this._element},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"namespaceURI",{get:function(){return this._namespace},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"prefix",{get:function(){return this._namespacePrefix},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"localName",{get:function(){return this._localName},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"name",{get:function(){return this._qualifiedName},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"value",{get:function(){return this._value},set:function(p){c.attr_setAnExistingAttributeValue(this,p)},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"_qualifiedName",{get:function(){return this._namespacePrefix!==null?this._namespacePrefix+":"+this._localName:this._localName},enumerable:!0,configurable:!0}),h._create=function(p,g){var m=new h(g);return m._nodeDocument=p,m},h})(l.NodeImpl);r.AttrImpl=u,f.idl_defineConst(u.prototype,"_nodeType",s.NodeType.Attribute),f.idl_defineConst(u.prototype,"specified",!0)},function(n,r,i){var a,o=this&&this.__extends||(a=function(u,d){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,p){h.__proto__=p}||function(h,p){for(var g in p)p.hasOwnProperty(g)&&(h[g]=p[g])})(u,d)},function(u,d){function h(){this.constructor=u}a(u,d),u.prototype=d===null?Object.create(d):(h.prototype=d.prototype,new h)});Object.defineProperty(r,"__esModule",{value:!0});var s=i(101),l=i(2),c=i(12),f=(function(u){function d(h){return u.call(this,h)||this}return o(d,u),d._create=function(h,p){p===void 0&&(p="");var g=new d(p);return g._nodeDocument=h,g},d})(s.TextImpl);r.CDATASectionImpl=f,c.idl_defineConst(f.prototype,"_nodeType",l.NodeType.CData)},function(n,r,i){var a,o=this&&this.__extends||(a=function(u,d){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,p){h.__proto__=p}||function(h,p){for(var g in p)p.hasOwnProperty(g)&&(h[g]=p[g])})(u,d)},function(u,d){function h(){this.constructor=u}a(u,d),u.prototype=d===null?Object.create(d):(h.prototype=d.prototype,new h)});Object.defineProperty(r,"__esModule",{value:!0});var s=i(2),l=i(71),c=i(12),f=(function(u){function d(h){return h===void 0&&(h=""),u.call(this,h)||this}return o(d,u),d._create=function(h,p){p===void 0&&(p="");var g=new d(p);return g._nodeDocument=h,g},d})(l.CharacterDataImpl);r.CommentImpl=f,c.idl_defineConst(f.prototype,"_nodeType",s.NodeType.Comment)},function(n,r,i){var a,o=this&&this.__extends||(a=function(u,d){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,p){h.__proto__=p}||function(h,p){for(var g in p)p.hasOwnProperty(g)&&(h[g]=p[g])})(u,d)},function(u,d){function h(){this.constructor=u}a(u,d),u.prototype=d===null?Object.create(d):(h.prototype=d.prototype,new h)});Object.defineProperty(r,"__esModule",{value:!0});var s=i(2),l=i(71),c=i(12),f=(function(u){function d(h,p){var g=u.call(this,p)||this;return g._target=h,g}return o(d,u),Object.defineProperty(d.prototype,"target",{get:function(){return this._target},enumerable:!0,configurable:!0}),d._create=function(h,p,g){var m=new d(p,g);return m._nodeDocument=h,m},d})(l.CharacterDataImpl);r.ProcessingInstructionImpl=f,c.idl_defineConst(f.prototype,"_nodeType",s.NodeType.ProcessingInstruction)},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(7),o=i(0),s=i(3),l=i(1),c=(function(){function f(u,d){return this._live=!0,this._root=u,this._filter=d,new Proxy(this,this)}return Object.defineProperty(f.prototype,"length",{get:function(){for(var u=this,d=0,h=o.tree_getFirstDescendantNode(this._root,!1,!1,(function(p){return s.Guard.isElementNode(p)&&u._filter(p)}));h!==null;)d++,h=o.tree_getNextDescendantNode(this._root,h,!1,!1,(function(p){return s.Guard.isElementNode(p)&&u._filter(p)}));return d},enumerable:!0,configurable:!0}),f.prototype.item=function(u){for(var d=this,h=0,p=o.tree_getFirstDescendantNode(this._root,!1,!1,(function(g){return s.Guard.isElementNode(g)&&d._filter(g)}));p!==null;){if(h===u)return p;h++,p=o.tree_getNextDescendantNode(this._root,p,!1,!1,(function(g){return s.Guard.isElementNode(g)&&d._filter(g)}))}return null},f.prototype.namedItem=function(u){var d=this;if(u==="")return null;for(var h=o.tree_getFirstDescendantNode(this._root,!1,!1,(function(m){return s.Guard.isElementNode(m)&&d._filter(m)}));h!=null;){if(h._uniqueIdentifier===u)return h;if(h._namespace===a.namespace.HTML)for(var p=0;p<h._attributeList.length;p++){var g=h._attributeList[p];if(g._localName==="name"&&g._namespace===null&&g._namespacePrefix===null&&g._value===u)return h}h=o.tree_getNextDescendantNode(this._root,h,!1,!1,(function(m){return s.Guard.isElementNode(m)&&d._filter(m)}))}return null},f.prototype[Symbol.iterator]=function(){var u=this._root,d=this._filter,h=o.tree_getFirstDescendantNode(u,!1,!1,(function(p){return s.Guard.isElementNode(p)&&d(p)}));return{next:function(){if(h===null)return{done:!0,value:null};var p={done:!1,value:h};return h=o.tree_getNextDescendantNode(u,h,!1,!1,(function(g){return s.Guard.isElementNode(g)&&d(g)})),p}}},f.prototype.get=function(u,d,h){if(!l.isString(d)||f.reservedNames.indexOf(d)!==-1)return Reflect.get(u,d,h);var p=Number(d);return isNaN(p)?u.namedItem(d)||void 0:u.item(p)||void 0},f.prototype.set=function(u,d,h,p){if(!l.isString(d)||f.reservedNames.indexOf(d)!==-1)return Reflect.set(u,d,h,p);var g=Number(d),m=isNaN(g)?u.namedItem(d)||void 0:u.item(g)||void 0;return!(!m||!m._parent)&&(o.mutation_replace(m,h,m._parent),!0)},f._create=function(u,d){return d===void 0&&(d=function(){return!0}),new f(u,d)},f.reservedNames=["_root","_live","_filter","length","item","namedItem","get","set"],f})();r.HTMLCollectionImpl=c},function(n,r,i){var a=this&&this.__values||function(f){var u=typeof Symbol=="function"&&Symbol.iterator,d=u&&f[u],h=0;if(d)return d.call(f);if(f&&typeof f.length=="number")return{next:function(){return f&&h>=f.length&&(f=void 0),{value:f&&f[h++],done:!f}}};throw new TypeError(u?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var o=i(6),s=i(1),l=i(0),c=(function(){function f(u){return this._live=!0,this._filter=null,this._length=0,this._root=u,new Proxy(this,this)}return Object.defineProperty(f.prototype,"length",{get:function(){return this._root._children.size},enumerable:!0,configurable:!0}),f.prototype.item=function(u){if(u<0||u>this.length-1)return null;if(u<this.length/2){for(var d=0,h=this._root._firstChild;h!==null&&d!==u;)h=h._nextSibling,d++;return h}for(d=this.length-1,h=this._root._lastChild;h!==null&&d!==u;)h=h._previousSibling,d--;return h},f.prototype.keys=function(){var u;return(u={})[Symbol.iterator]=(function(){var d=0;return{next:(function(){return d===this.length?{done:!0,value:null}:{done:!1,value:d++}}).bind(this)}}).bind(this),u},f.prototype.values=function(){var u;return(u={})[Symbol.iterator]=(function(){var d=this[Symbol.iterator]();return{next:function(){return d.next()}}}).bind(this),u},f.prototype.entries=function(){var u;return(u={})[Symbol.iterator]=(function(){var d=this[Symbol.iterator](),h=0;return{next:function(){var p=d.next();return p.done?{done:!0,value:null}:{done:!1,value:[h++,p.value]}}}}).bind(this),u},f.prototype[Symbol.iterator]=function(){return this._root._children[Symbol.iterator]()},f.prototype.forEach=function(u,d){var h,p;d===void 0&&(d=o.dom.window);var g=0;try{for(var m=a(this._root._children),y=m.next();!y.done;y=m.next()){var v=y.value;u.call(d,v,g++,this)}}catch(x){h={error:x}}finally{try{y&&!y.done&&(p=m.return)&&p.call(m)}finally{if(h)throw h.error}}},f.prototype.get=function(u,d,h){if(!s.isString(d))return Reflect.get(u,d,h);var p=Number(d);return isNaN(p)?Reflect.get(u,d,h):u.item(p)||void 0},f.prototype.set=function(u,d,h,p){if(!s.isString(d))return Reflect.set(u,d,h,p);var g=Number(d);if(isNaN(g))return Reflect.set(u,d,h,p);var m=u.item(g)||void 0;return!!m&&!!m._parent&&(l.mutation_replace(m,h,m._parent),!0)},f._create=function(u){return new f(u)},f})();r.NodeListImpl=c},function(n,r,i){var a=this&&this.__values||function(c){var f=typeof Symbol=="function"&&Symbol.iterator,u=f&&c[f],d=0;if(u)return u.call(c);if(c&&typeof c.length=="number")return{next:function(){return c&&d>=c.length&&(c=void 0),{value:c&&c[d++],done:!c}}};throw new TypeError(f?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var o=i(6),s=i(1),l=(function(){function c(f){return this._live=!1,this._items=[],this._length=0,this._root=f,this._items=[],this._filter=function(u){return!0},new Proxy(this,this)}return Object.defineProperty(c.prototype,"length",{get:function(){return this._items.length},enumerable:!0,configurable:!0}),c.prototype.item=function(f){return f<0||f>this.length-1?null:this._items[f]},c.prototype.keys=function(){var f;return(f={})[Symbol.iterator]=(function(){var u=0;return{next:(function(){return u===this.length?{done:!0,value:null}:{done:!1,value:u++}}).bind(this)}}).bind(this),f},c.prototype.values=function(){var f;return(f={})[Symbol.iterator]=(function(){var u=this[Symbol.iterator]();return{next:function(){return u.next()}}}).bind(this),f},c.prototype.entries=function(){var f;return(f={})[Symbol.iterator]=(function(){var u=this[Symbol.iterator](),d=0;return{next:function(){var h=u.next();return h.done?{done:!0,value:null}:{done:!1,value:[d++,h.value]}}}}).bind(this),f},c.prototype[Symbol.iterator]=function(){var f=this._items[Symbol.iterator]();return{next:function(){return f.next()}}},c.prototype.forEach=function(f,u){var d,h;u===void 0&&(u=o.dom.window);var p=0;try{for(var g=a(this._items),m=g.next();!m.done;m=g.next()){var y=m.value;f.call(u,y,p++,this)}}catch(v){d={error:v}}finally{try{m&&!m.done&&(h=g.return)&&h.call(g)}finally{if(d)throw d.error}}},c.prototype.get=function(f,u,d){if(!s.isString(u))return Reflect.get(f,u,d);var h=Number(u);return isNaN(h)?Reflect.get(f,u,d):f._items[h]||void 0},c.prototype.set=function(f,u,d,h){if(!s.isString(u))return Reflect.set(f,u,d,h);var p=Number(u);return isNaN(p)?Reflect.set(f,u,d,h):p>=0&&p<f._items.length&&(f._items[p]=d,!0)},c._create=function(f,u){var d=new c(f);return d._items=u,d},c})();r.NodeListStaticImpl=l},function(n,r,i){var a,o=this&&this.__extends||(a=function(f,u){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,h){d.__proto__=h}||function(d,h){for(var p in h)h.hasOwnProperty(p)&&(d[p]=h[p])})(f,u)},function(f,u){function d(){this.constructor=f}a(f,u),f.prototype=u===null?Object.create(u):(d.prototype=u.prototype,new d)});Object.defineProperty(r,"__esModule",{value:!0});var s=i(9),l=i(0),c=(function(f){function u(d){var h=f.call(this)||this;return h._element=d,Object.setPrototypeOf(h,u.prototype),h}return o(u,f),u.prototype._asArray=function(){return this},u.prototype.item=function(d){return this[d]||null},u.prototype.getNamedItem=function(d){return l.element_getAnAttributeByName(d,this._element)},u.prototype.getNamedItemNS=function(d,h){return l.element_getAnAttributeByNamespaceAndLocalName(d||"",h,this._element)},u.prototype.setNamedItem=function(d){return l.element_setAnAttribute(d,this._element)},u.prototype.setNamedItemNS=function(d){return l.element_setAnAttribute(d,this._element)},u.prototype.removeNamedItem=function(d){var h=l.element_removeAnAttributeByName(d,this._element);if(h===null)throw new s.NotFoundError;return h},u.prototype.removeNamedItemNS=function(d,h){var p=l.element_removeAnAttributeByNamespaceAndLocalName(d||"",h,this._element);if(p===null)throw new s.NotFoundError;return p},u._create=function(d){return new u(d)},u})(Array);r.NamedNodeMapImpl=c},function(n,r,i){var a,o=this&&this.__extends||(a=function(m,y){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,x){v.__proto__=x}||function(v,x){for(var w in x)x.hasOwnProperty(w)&&(v[w]=x[w])})(m,y)},function(m,y){function v(){this.constructor=m}a(m,y),m.prototype=y===null?Object.create(y):(v.prototype=y.prototype,new v)}),s=this&&this.__values||function(m){var y=typeof Symbol=="function"&&Symbol.iterator,v=y&&m[y],x=0;if(v)return v.call(m);if(m&&typeof m.length=="number")return{next:function(){return m&&x>=m.length&&(m=void 0),{value:m&&m[x++],done:!m}}};throw new TypeError(y?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var l=i(6),c=i(2),f=i(102),u=i(9),d=i(0),h=i(12),p=i(3),g=(function(m){function y(){var v=m.call(this)||this,x=l.dom.window._associatedDocument;return v._start=[x,0],v._end=[x,0],l.dom.rangeList.add(v),v}return o(y,m),Object.defineProperty(y.prototype,"commonAncestorContainer",{get:function(){for(var v=this._start[0];!d.tree_isAncestorOf(this._end[0],v,!0);){if(v._parent===null)throw new Error("Parent node  is null.");v=v._parent}return v},enumerable:!0,configurable:!0}),y.prototype.setStart=function(v,x){d.range_setTheStart(this,v,x)},y.prototype.setEnd=function(v,x){d.range_setTheEnd(this,v,x)},y.prototype.setStartBefore=function(v){var x=v._parent;if(x===null)throw new u.InvalidNodeTypeError;d.range_setTheStart(this,x,d.tree_index(v))},y.prototype.setStartAfter=function(v){var x=v._parent;if(x===null)throw new u.InvalidNodeTypeError;d.range_setTheStart(this,x,d.tree_index(v)+1)},y.prototype.setEndBefore=function(v){var x=v._parent;if(x===null)throw new u.InvalidNodeTypeError;d.range_setTheEnd(this,x,d.tree_index(v))},y.prototype.setEndAfter=function(v){var x=v._parent;if(x===null)throw new u.InvalidNodeTypeError;d.range_setTheEnd(this,x,d.tree_index(v)+1)},y.prototype.collapse=function(v){v?this._end=this._start:this._start=this._end},y.prototype.selectNode=function(v){d.range_select(v,this)},y.prototype.selectNodeContents=function(v){if(p.Guard.isDocumentTypeNode(v))throw new u.InvalidNodeTypeError;var x=d.tree_nodeLength(v);this._start=[v,0],this._end=[v,x]},y.prototype.compareBoundaryPoints=function(v,x){if(v!==c.HowToCompare.StartToStart&&v!==c.HowToCompare.StartToEnd&&v!==c.HowToCompare.EndToEnd&&v!==c.HowToCompare.EndToStart)throw new u.NotSupportedError;if(d.range_root(this)!==d.range_root(x))throw new u.WrongDocumentError;var w,S;switch(v){case c.HowToCompare.StartToStart:w=this._start,S=x._start;break;case c.HowToCompare.StartToEnd:w=this._end,S=x._start;break;case c.HowToCompare.EndToEnd:w=this._end,S=x._end;break;case c.HowToCompare.EndToStart:w=this._start,S=x._end;break;default:throw new u.NotSupportedError}var T=d.boundaryPoint_position(w,S);return T===c.BoundaryPosition.Before?-1:T===c.BoundaryPosition.After?1:0},y.prototype.deleteContents=function(){var v,x,w,S;if(!d.range_collapsed(this)){var T=this._startNode,_=this._startOffset,D=this._endNode,I=this._endOffset;if(T===D&&p.Guard.isCharacterDataNode(T))d.characterData_replaceData(T,_,I-_,"");else{var R,M,A=[];try{for(var L=s(d.range_getContainedNodes(this)),P=L.next();!P.done;P=L.next()){var B=($=P.value)._parent;B!==null&&d.range_isContained(B,this)||A.push($)}}catch(V){v={error:V}}finally{try{P&&!P.done&&(x=L.return)&&x.call(L)}finally{if(v)throw v.error}}if(d.tree_isAncestorOf(D,T,!0))R=T,M=_;else{for(var U=T;U._parent!==null&&!d.tree_isAncestorOf(D,U._parent,!0);)U=U._parent;if(U._parent===null)throw new Error("Parent node is null.");R=U._parent,M=d.tree_index(U)+1}p.Guard.isCharacterDataNode(T)&&d.characterData_replaceData(T,_,d.tree_nodeLength(T)-_,"");try{for(var G=s(A),F=G.next();!F.done;F=G.next()){var $;($=F.value)._parent&&d.mutation_remove($,$._parent)}}catch(V){w={error:V}}finally{try{F&&!F.done&&(S=G.return)&&S.call(G)}finally{if(w)throw w.error}}p.Guard.isCharacterDataNode(D)&&d.characterData_replaceData(D,0,I,""),this._start=[R,M],this._end=[R,M]}}},y.prototype.extractContents=function(){return d.range_extract(this)},y.prototype.cloneContents=function(){return d.range_cloneTheContents(this)},y.prototype.insertNode=function(v){return d.range_insert(v,this)},y.prototype.surroundContents=function(v){var x,w;try{for(var S=s(d.range_getPartiallyContainedNodes(this)),T=S.next();!T.done;T=S.next()){var _=T.value;if(!p.Guard.isTextNode(_))throw new u.InvalidStateError}}catch(I){x={error:I}}finally{try{T&&!T.done&&(w=S.return)&&w.call(S)}finally{if(x)throw x.error}}if(p.Guard.isDocumentNode(v)||p.Guard.isDocumentTypeNode(v)||p.Guard.isDocumentFragmentNode(v))throw new u.InvalidNodeTypeError;var D=d.range_extract(this);v._children.size!==0&&d.mutation_replaceAll(null,v),d.range_insert(v,this),d.mutation_append(D,v),d.range_select(v,this)},y.prototype.cloneRange=function(){return d.create_range(this._start,this._end)},y.prototype.detach=function(){l.dom.rangeList.delete(this)},y.prototype.isPointInRange=function(v,x){if(d.tree_rootNode(v)!==d.range_root(this))return!1;if(p.Guard.isDocumentTypeNode(v))throw new u.InvalidNodeTypeError;if(x>d.tree_nodeLength(v))throw new u.IndexSizeError;var w=[v,x];return d.boundaryPoint_position(w,this._start)!==c.BoundaryPosition.Before&&d.boundaryPoint_position(w,this._end)!==c.BoundaryPosition.After},y.prototype.comparePoint=function(v,x){if(d.tree_rootNode(v)!==d.range_root(this))throw new u.WrongDocumentError;if(p.Guard.isDocumentTypeNode(v))throw new u.InvalidNodeTypeError;if(x>d.tree_nodeLength(v))throw new u.IndexSizeError;var w=[v,x];return d.boundaryPoint_position(w,this._start)===c.BoundaryPosition.Before?-1:d.boundaryPoint_position(w,this._end)===c.BoundaryPosition.After?1:0},y.prototype.intersectsNode=function(v){if(d.tree_rootNode(v)!==d.range_root(this))return!1;var x=v._parent;if(x===null)return!0;var w=d.tree_index(v);return d.boundaryPoint_position([x,w],this._end)===c.BoundaryPosition.Before&&d.boundaryPoint_position([x,w+1],this._start)===c.BoundaryPosition.After},y.prototype.toString=function(){var v,x,w="";if(this._startNode===this._endNode&&p.Guard.isTextNode(this._startNode))return this._startNode._data.substring(this._startOffset,this._endOffset);p.Guard.isTextNode(this._startNode)&&(w+=this._startNode._data.substring(this._startOffset));try{for(var S=s(d.range_getContainedNodes(this)),T=S.next();!T.done;T=S.next()){var _=T.value;p.Guard.isTextNode(_)&&(w+=_._data)}}catch(D){v={error:D}}finally{try{T&&!T.done&&(x=S.return)&&x.call(S)}finally{if(v)throw v.error}}return p.Guard.isTextNode(this._endNode)&&(w+=this._endNode._data.substring(0,this._endOffset)),w},y._create=function(v,x){var w=new y;return v&&(w._start=v),x&&(w._end=x),w},y.START_TO_START=0,y.START_TO_END=1,y.END_TO_END=2,y.END_TO_START=3,y})(f.AbstractRangeImpl);r.RangeImpl=g,h.idl_defineConst(g.prototype,"START_TO_START",0),h.idl_defineConst(g.prototype,"START_TO_END",1),h.idl_defineConst(g.prototype,"END_TO_END",2),h.idl_defineConst(g.prototype,"END_TO_START",3)},function(n,r,i){var a,o=this&&this.__extends||(a=function(f,u){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,h){d.__proto__=h}||function(d,h){for(var p in h)h.hasOwnProperty(p)&&(d[p]=h[p])})(f,u)},function(f,u){function d(){this.constructor=f}a(f,u),f.prototype=u===null?Object.create(u):(d.prototype=u.prototype,new d)});Object.defineProperty(r,"__esModule",{value:!0});var s=i(103),l=i(0),c=(function(f){function u(d,h,p){var g=f.call(this,d)||this;return g._iteratorCollection=void 0,g._reference=h,g._pointerBeforeReference=p,l.nodeIterator_iteratorList().add(g),g}return o(u,f),Object.defineProperty(u.prototype,"referenceNode",{get:function(){return this._reference},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"pointerBeforeReferenceNode",{get:function(){return this._pointerBeforeReference},enumerable:!0,configurable:!0}),u.prototype.nextNode=function(){return l.nodeIterator_traverse(this,!0)},u.prototype.previousNode=function(){return l.nodeIterator_traverse(this,!1)},u.prototype.detach=function(){l.nodeIterator_iteratorList().delete(this)},u._create=function(d,h,p){return new u(d,h,p)},u})(s.TraverserImpl);r.NodeIteratorImpl=c},function(n,r,i){var a,o=this&&this.__extends||(a=function(u,d){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,p){h.__proto__=p}||function(h,p){for(var g in p)p.hasOwnProperty(g)&&(h[g]=p[g])})(u,d)},function(u,d){function h(){this.constructor=u}a(u,d),u.prototype=d===null?Object.create(d):(h.prototype=d.prototype,new h)});Object.defineProperty(r,"__esModule",{value:!0});var s=i(2),l=i(103),c=i(0),f=(function(u){function d(h,p){var g=u.call(this,h)||this;return g._current=p,g}return o(d,u),Object.defineProperty(d.prototype,"currentNode",{get:function(){return this._current},set:function(h){this._current=h},enumerable:!0,configurable:!0}),d.prototype.parentNode=function(){for(var h=this._current;h!==null&&h!==this._root;)if((h=h._parent)!==null&&c.traversal_filter(this,h)===s.FilterResult.Accept)return this._current=h,h;return null},d.prototype.firstChild=function(){return c.treeWalker_traverseChildren(this,!0)},d.prototype.lastChild=function(){return c.treeWalker_traverseChildren(this,!1)},d.prototype.nextSibling=function(){return c.treeWalker_traverseSiblings(this,!0)},d.prototype.previousNode=function(){for(var h=this._current;h!==this._root;){for(var p=h._previousSibling;p;){h=p;for(var g=c.traversal_filter(this,h);g!==s.FilterResult.Reject&&h._lastChild;)h=h._lastChild,g=c.traversal_filter(this,h);if(g===s.FilterResult.Accept)return this._current=h,h;p=h._previousSibling}if(h===this._root||h._parent===null)return null;if(h=h._parent,c.traversal_filter(this,h)===s.FilterResult.Accept)return this._current=h,h}return null},d.prototype.previousSibling=function(){return c.treeWalker_traverseSiblings(this,!1)},d.prototype.nextNode=function(){for(var h=this._current,p=s.FilterResult.Accept;;){for(;p!==s.FilterResult.Reject&&h._firstChild;)if(h=h._firstChild,(p=c.traversal_filter(this,h))===s.FilterResult.Accept)return this._current=h,h;for(var g=null,m=h;m!==null;){if(m===this._root)return null;if((g=m._nextSibling)!==null){h=g;break}m=m._parent}if((p=c.traversal_filter(this,h))===s.FilterResult.Accept)return this._current=h,h}},d._create=function(h,p){return new d(h,p)},d})(l.TraverserImpl);r.TreeWalkerImpl=f},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(2),o=i(12),s=(function(){function l(){}return l.prototype.acceptNode=function(c){return a.FilterResult.Accept},l._create=function(){return new l},l.FILTER_ACCEPT=1,l.FILTER_REJECT=2,l.FILTER_SKIP=3,l.SHOW_ALL=4294967295,l.SHOW_ELEMENT=1,l.SHOW_ATTRIBUTE=2,l.SHOW_TEXT=4,l.SHOW_CDATA_SECTION=8,l.SHOW_ENTITY_REFERENCE=16,l.SHOW_ENTITY=32,l.SHOW_PROCESSING_INSTRUCTION=64,l.SHOW_COMMENT=128,l.SHOW_DOCUMENT=256,l.SHOW_DOCUMENT_TYPE=512,l.SHOW_DOCUMENT_FRAGMENT=1024,l.SHOW_NOTATION=2048,l})();r.NodeFilterImpl=s,o.idl_defineConst(s.prototype,"FILTER_ACCEPT",1),o.idl_defineConst(s.prototype,"FILTER_REJECT",2),o.idl_defineConst(s.prototype,"FILTER_SKIP",3),o.idl_defineConst(s.prototype,"SHOW_ALL",4294967295),o.idl_defineConst(s.prototype,"SHOW_ELEMENT",1),o.idl_defineConst(s.prototype,"SHOW_ATTRIBUTE",2),o.idl_defineConst(s.prototype,"SHOW_TEXT",4),o.idl_defineConst(s.prototype,"SHOW_CDATA_SECTION",8),o.idl_defineConst(s.prototype,"SHOW_ENTITY_REFERENCE",16),o.idl_defineConst(s.prototype,"SHOW_ENTITY",32),o.idl_defineConst(s.prototype,"SHOW_PROCESSING_INSTRUCTION",64),o.idl_defineConst(s.prototype,"SHOW_COMMENT",128),o.idl_defineConst(s.prototype,"SHOW_DOCUMENT",256),o.idl_defineConst(s.prototype,"SHOW_DOCUMENT_TYPE",512),o.idl_defineConst(s.prototype,"SHOW_DOCUMENT_FRAGMENT",1024),o.idl_defineConst(s.prototype,"SHOW_NOTATION",2048)},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=(function(){function o(s,l,c,f,u,d,h,p,g){this._type=s,this._target=l,this._addedNodes=c,this._removedNodes=f,this._previousSibling=u,this._nextSibling=d,this._attributeName=h,this._attributeNamespace=p,this._oldValue=g}return Object.defineProperty(o.prototype,"type",{get:function(){return this._type},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"target",{get:function(){return this._target},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"addedNodes",{get:function(){return this._addedNodes},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"removedNodes",{get:function(){return this._removedNodes},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"previousSibling",{get:function(){return this._previousSibling},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"nextSibling",{get:function(){return this._nextSibling},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"attributeName",{get:function(){return this._attributeName},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"attributeNamespace",{get:function(){return this._attributeNamespace},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"oldValue",{get:function(){return this._oldValue},enumerable:!0,configurable:!0}),o._create=function(s,l,c,f,u,d,h,p,g){return new o(s,l,c,f,u,d,h,p,g)},o})();r.MutationRecordImpl=a},function(n,r,i){var a=this&&this.__values||function(u){var d=typeof Symbol=="function"&&Symbol.iterator,h=d&&u[d],p=0;if(h)return h.call(u);if(u&&typeof u.length=="number")return{next:function(){return u&&p>=u.length&&(u=void 0),{value:u&&u[p++],done:!u}}};throw new TypeError(d?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var o=i(6),s=i(9),l=i(7),c=i(0),f=(function(){function u(d,h){this._element=d,this._attribute=h,this._tokenSet=new Set;var p=h._localName,g=c.element_getAnAttributeValue(d,p),m=this;this._element._attributeChangeSteps.push((function(y,v,x,w,S){v===m._attribute._localName&&S===null&&(w?m._tokenSet=c.orderedSet_parse(w):m._tokenSet.clear())})),o.dom.features.steps&&c.dom_runAttributeChangeSteps(d,p,g,g,null)}return Object.defineProperty(u.prototype,"length",{get:function(){return this._tokenSet.size},enumerable:!0,configurable:!0}),u.prototype.item=function(d){var h,p,g=0;try{for(var m=a(this._tokenSet),y=m.next();!y.done;y=m.next()){var v=y.value;if(g===d)return v;g++}}catch(x){h={error:x}}finally{try{y&&!y.done&&(p=m.return)&&p.call(m)}finally{if(h)throw h.error}}return null},u.prototype.contains=function(d){return this._tokenSet.has(d)},u.prototype.add=function(){for(var d,h,p=[],g=0;g<arguments.length;g++)p[g]=arguments[g];try{for(var m=a(p),y=m.next();!y.done;y=m.next()){var v=y.value;if(v==="")throw new s.SyntaxError("Cannot add an empty token.");if(l.codePoint.ASCIIWhiteSpace.test(v))throw new s.InvalidCharacterError("Token cannot contain whitespace.");this._tokenSet.add(v)}}catch(x){d={error:x}}finally{try{y&&!y.done&&(h=m.return)&&h.call(m)}finally{if(d)throw d.error}}c.tokenList_updateSteps(this)},u.prototype.remove=function(){for(var d,h,p=[],g=0;g<arguments.length;g++)p[g]=arguments[g];try{for(var m=a(p),y=m.next();!y.done;y=m.next()){var v=y.value;if(v==="")throw new s.SyntaxError("Cannot remove an empty token.");if(l.codePoint.ASCIIWhiteSpace.test(v))throw new s.InvalidCharacterError("Token cannot contain whitespace.");this._tokenSet.delete(v)}}catch(x){d={error:x}}finally{try{y&&!y.done&&(h=m.return)&&h.call(m)}finally{if(d)throw d.error}}c.tokenList_updateSteps(this)},u.prototype.toggle=function(d,h){if(h===void 0&&(h=void 0),d==="")throw new s.SyntaxError("Cannot toggle an empty token.");if(l.codePoint.ASCIIWhiteSpace.test(d))throw new s.InvalidCharacterError("Token cannot contain whitespace.");return this._tokenSet.has(d)?h!==void 0&&h!==!1||(this._tokenSet.delete(d),c.tokenList_updateSteps(this),!1):(h===void 0||h===!0)&&(this._tokenSet.add(d),c.tokenList_updateSteps(this),!0)},u.prototype.replace=function(d,h){if(d===""||h==="")throw new s.SyntaxError("Cannot replace an empty token.");if(l.codePoint.ASCIIWhiteSpace.test(d)||l.codePoint.ASCIIWhiteSpace.test(h))throw new s.InvalidCharacterError("Token cannot contain whitespace.");return!!this._tokenSet.has(d)&&(l.set.replace(this._tokenSet,d,h),c.tokenList_updateSteps(this),!0)},u.prototype.supports=function(d){return c.tokenList_validationSteps(this,d)},Object.defineProperty(u.prototype,"value",{get:function(){return c.tokenList_serializeSteps(this)},set:function(d){c.element_setAnAttributeValue(this._element,this._attribute._localName,d)},enumerable:!0,configurable:!0}),u.prototype[Symbol.iterator]=function(){var d=this._tokenSet[Symbol.iterator]();return{next:function(){return d.next()}}},u._create=function(d,h){return new u(d,h)},u})();r.DOMTokenListImpl=f},function(n,r,i){var a,o=this&&this.__extends||(a=function(f,u){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,h){d.__proto__=h}||function(d,h){for(var p in h)h.hasOwnProperty(p)&&(d[p]=h[p])})(f,u)},function(f,u){function d(){this.constructor=f}a(f,u),f.prototype=u===null?Object.create(u):(d.prototype=u.prototype,new d)});Object.defineProperty(r,"__esModule",{value:!0});var s=i(104),l=i(0),c=(function(f){function u(d,h){var p=f.call(this,d,h)||this;return p._detail=null,p._detail=h&&h.detail||null,p}return o(u,f),Object.defineProperty(u.prototype,"detail",{get:function(){return this._detail},enumerable:!0,configurable:!0}),u.prototype.initCustomEvent=function(d,h,p,g){h===void 0&&(h=!1),p===void 0&&(p=!1),g===void 0&&(g=null),this._dispatchFlag||(l.event_initialize(this,d,h,p),this._detail=g)},u})(s.EventImpl);r.CustomEventImpl=c},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(6),o=i(2),s=i(105),l=i(17);r.nodeIterator_traverse=function(c,f){for(var u=c._reference,d=c._pointerBeforeReference;;){if(f)if(d)d=!1;else{var h=l.tree_getFollowingNode(c._root,u);if(!h)return null;u=h}else if(d){var p=l.tree_getPrecedingNode(c.root,u);if(!p)return null;u=p}else d=!0;if(s.traversal_filter(c,u)===o.FilterResult.Accept)break}return c._reference=u,c._pointerBeforeReference=d,u},r.nodeIterator_iteratorList=function(){return a.dom.window._iteratorList}},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(9),o=i(7),s=i(174);function l(c){if(!s.xml_isName(c))throw new a.InvalidCharacterError("Invalid XML name: "+c);if(!s.xml_isQName(c))throw new a.InvalidCharacterError("Invalid XML qualified name: "+c+".")}r.namespace_validate=l,r.namespace_validateAndExtract=function(c,f){c||(c=null),l(f);var u=f.split(":"),d=u.length===2?u[0]:null,h=u.length===2?u[1]:f;if(d&&c===null)throw new a.NamespaceError("Qualified name includes a prefix but the namespace is null.");if(d==="xml"&&c!==o.namespace.XML)throw new a.NamespaceError('Qualified name includes the "xml" prefix but the namespace is not the XML namespace.');if(c!==o.namespace.XMLNS&&(d==="xmlns"||f==="xmlns"))throw new a.NamespaceError('Qualified name includes the "xmlns" prefix but the namespace is not the XMLNS namespace.');if(c===o.namespace.XMLNS&&d!=="xmlns"&&f!=="xmlns")throw new a.NamespaceError('Qualified name does not include the "xmlns" prefix but the namespace is the XMLNS namespace.');return[c,d,h]},r.namespace_extractQName=function(c){l(c);var f=c.split(":");return[f.length===2?f[0]:null,f.length===2?f[1]:c]}},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.xml_isName=function(a){for(var o=0;o<a.length;o++){var s=a.charCodeAt(o);if(!(s>=97&&s<=122||s>=65&&s<=90||s===58||s===95||s>=192&&s<=214||s>=216&&s<=246||s>=248&&s<=767||s>=880&&s<=893||s>=895&&s<=8191||s>=8204&&s<=8205||s>=8304&&s<=8591||s>=11264&&s<=12271||s>=12289&&s<=55295||s>=63744&&s<=64975||s>=65008&&s<=65533)&&(o===0||!(s===45||s===46||s>=48&&s<=57||s===183||s>=768&&s<=879||s>=8255&&s<=8256))){if(s>=55296&&s<=56319&&o<a.length-1){var l=a.charCodeAt(o+1);if(l>=56320&&l<=57343&&(o++,(s=1024*(s-55296)+l-56320+65536)>=65536&&s<=983039))continue}return!1}}return!0},r.xml_isQName=function(a){for(var o=!1,s=0;s<a.length;s++){var l=a.charCodeAt(s);if(!(l>=97&&l<=122||l>=65&&l<=90||l===95||l>=192&&l<=214||l>=216&&l<=246||l>=248&&l<=767||l>=880&&l<=893||l>=895&&l<=8191||l>=8204&&l<=8205||l>=8304&&l<=8591||l>=11264&&l<=12271||l>=12289&&l<=55295||l>=63744&&l<=64975||l>=65008&&l<=65533)&&(s===0||!(l===45||l===46||l>=48&&l<=57||l===183||l>=768&&l<=879||l>=8255&&l<=8256))){if(s===0||l!==58){if(l>=55296&&l<=56319&&s<a.length-1){var c=a.charCodeAt(s+1);if(c>=56320&&c<=57343&&(s++,(l=1024*(l-55296)+c-56320+65536)>=65536&&l<=983039))continue}return!1}if(o||s===a.length-1)return!1;o=!0}}return!0},r.xml_isLegalChar=function(a){for(var o=0;o<a.length;o++){var s=a.charCodeAt(o);if(!(s===9||s===10||s===13||s>=32&&s<=55295||s>=57344&&s<=65533)){if(s>=55296&&s<=56319&&o<a.length-1){var l=a.charCodeAt(o+1);if(l>=56320&&l<=57343&&(o++,(s=1024*(s-55296)+l-56320+65536)>=65536&&s<=1114111))continue}return!1}}return!0},r.xml_isPubidChar=function(a){for(var o=0;o<a.length;o++){var s=a.charCodeAt(o);if(!(s>=97&&s<=122||s>=65&&s<=90||s>=39&&s<=59||s===32||s===13||s===10||s>=35&&s<=37||s===33||s===61||s===63||s===64||s===95))return!1}return!0}},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(2),o=i(17);r.boundaryPoint_position=function s(l,c){var f=l[0],u=l[1],d=c[0],h=c[1];if(console.assert(o.tree_rootNode(f)===o.tree_rootNode(d),"Boundary points must share the same root node."),f===d)return u===h?a.BoundaryPosition.Equal:u<h?a.BoundaryPosition.Before:a.BoundaryPosition.After;if(o.tree_isFollowing(d,f)){var p=s([d,h],[f,u]);if(p===a.BoundaryPosition.Before)return a.BoundaryPosition.After;if(p===a.BoundaryPosition.After)return a.BoundaryPosition.Before}if(o.tree_isAncestorOf(d,f)){for(var g=d;!o.tree_isChildOf(f,g);)g._parent!==null&&(g=g._parent);if(o.tree_index(g)<u)return a.BoundaryPosition.After}return a.BoundaryPosition.Before}},function(n,r,i){var a=this&&this.__values||function(p){var g=typeof Symbol=="function"&&Symbol.iterator,m=g&&p[g],y=0;if(m)return m.call(p);if(p&&typeof p.length=="number")return{next:function(){return p&&y>=p.length&&(p=void 0),{value:p&&p[y++],done:!p}}};throw new TypeError(g?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var o=i(6),s=i(3),l=i(7),c=i(29),f=i(108),u=i(30),d=i(37),h=i(52);r.node_stringReplaceAll=function(p,g){var m=null;p!==""&&(m=c.create_text(g._nodeDocument,p)),d.mutation_replaceAll(m,g)},r.node_clone=function p(g,m,y){var v,x,w,S,T;if(m===void 0&&(m=null),y===void 0&&(y=!1),m===null&&(m=g._nodeDocument),s.Guard.isElementNode(g)){T=h.element_createAnElement(m,g._localName,g._namespace,g._namespacePrefix,g._is,!1);try{for(var _=a(g._attributeList),D=_.next();!D.done;D=_.next()){var I=p(D.value,m);h.element_append(I,T)}}catch(B){v={error:B}}finally{try{D&&!D.done&&(x=_.return)&&x.call(_)}finally{if(v)throw v.error}}}else if(s.Guard.isDocumentNode(g)){var R=c.create_document();R._encoding=g._encoding,R._contentType=g._contentType,R._URL=g._URL,R._origin=g._origin,R._type=g._type,R._mode=g._mode,T=R}else if(s.Guard.isDocumentTypeNode(g))T=c.create_documentType(m,g._name,g._publicId,g._systemId);else if(s.Guard.isAttrNode(g)){var M=c.create_attr(m,g.localName);M._namespace=g._namespace,M._namespacePrefix=g._namespacePrefix,M._value=g._value,T=M}else T=s.Guard.isExclusiveTextNode(g)?c.create_text(m,g._data):s.Guard.isCDATASectionNode(g)?c.create_cdataSection(m,g._data):s.Guard.isCommentNode(g)?c.create_comment(m,g._data):s.Guard.isProcessingInstructionNode(g)?c.create_processingInstruction(m,g._target,g._data):s.Guard.isDocumentFragmentNode(g)?c.create_documentFragment(m):Object.create(g);if(s.Guard.isDocumentNode(T)?(T._nodeDocument=T,m=T):T._nodeDocument=m,o.dom.features.steps&&u.dom_runCloningSteps(T,g,m,y),y)try{for(var A=a(g._children),L=A.next();!L.done;L=A.next()){var P=p(L.value,m,!0);d.mutation_append(P,T)}}catch(B){w={error:B}}finally{try{L&&!L.done&&(S=A.return)&&S.call(A)}finally{if(w)throw w.error}}return T},r.node_equals=function p(g,m){var y,v,x,w;if(g._nodeType!==m._nodeType)return!1;if(s.Guard.isDocumentTypeNode(g)&&s.Guard.isDocumentTypeNode(m)){if(g._name!==m._name||g._publicId!==m._publicId||g._systemId!==m._systemId)return!1}else if(s.Guard.isElementNode(g)&&s.Guard.isElementNode(m)){if(g._namespace!==m._namespace||g._namespacePrefix!==m._namespacePrefix||g._localName!==m._localName||g._attributeList.length!==m._attributeList.length)return!1}else if(s.Guard.isAttrNode(g)&&s.Guard.isAttrNode(m)){if(g._namespace!==m._namespace||g._localName!==m._localName||g._value!==m._value)return!1}else if(s.Guard.isProcessingInstructionNode(g)&&s.Guard.isProcessingInstructionNode(m)){if(g._target!==m._target||g._data!==m._data)return!1}else if(s.Guard.isCharacterDataNode(g)&&s.Guard.isCharacterDataNode(m)&&g._data!==m._data)return!1;if(s.Guard.isElementNode(g)&&s.Guard.isElementNode(m)){var S={};try{for(var T=a(g._attributeList),_=T.next();!_.done;_=T.next())S[(R=_.value)._localName]=R}catch(U){y={error:U}}finally{try{_&&!_.done&&(v=T.return)&&v.call(T)}finally{if(y)throw y.error}}try{for(var D=a(m._attributeList),I=D.next();!I.done;I=D.next()){var R,M=I.value;if(!(R=S[M._localName])||!p(R,M))return!1}}catch(U){x={error:U}}finally{try{I&&!I.done&&(w=D.return)&&w.call(D)}finally{if(x)throw x.error}}}if(g._children.size!==m._children.size)return!1;for(var A=g._children[Symbol.iterator](),L=m._children[Symbol.iterator](),P=A.next(),B=L.next();!P.done&&!B.done;){if(!p(P.value,B.value))return!1;P=A.next(),B=L.next()}return!0},r.node_listOfElementsWithQualifiedName=function(p,g){return p==="*"?c.create_htmlCollection(g):g._nodeDocument._type==="html"?c.create_htmlCollection(g,(function(m){return m._namespace===l.namespace.HTML&&m._qualifiedName===p.toLowerCase()||m._namespace!==l.namespace.HTML&&m._qualifiedName===p})):c.create_htmlCollection(g,(function(m){return m._qualifiedName===p}))},r.node_listOfElementsWithNamespace=function(p,g,m){return p===""&&(p=null),p==="*"&&g==="*"?c.create_htmlCollection(m):p==="*"?c.create_htmlCollection(m,(function(y){return y._localName===g})):g==="*"?c.create_htmlCollection(m,(function(y){return y._namespace===p})):c.create_htmlCollection(m,(function(y){return y._localName===g&&y._namespace===p}))},r.node_listOfElementsWithClassNames=function(p,g){var m=f.orderedSet_parse(p);if(m.size===0)return c.create_htmlCollection(g,(function(){return!1}));var y=g._nodeDocument._mode!=="quirks";return c.create_htmlCollection(g,(function(v){var x=v.classList;return f.orderedSet_contains(x._tokenSet,m,y)}))},r.node_locateANamespacePrefix=function p(g,m){if(g._namespace===m&&g._namespacePrefix!==null)return g._namespacePrefix;for(var y=0;y<g._attributeList.length;y++){var v=g._attributeList[y];if(v._namespacePrefix==="xmlns"&&v._value===m)return v._localName}return g._parent&&s.Guard.isElementNode(g._parent)?p(g._parent,m):null},r.node_locateANamespace=function p(g,m){if(s.Guard.isElementNode(g)){if(g._namespace!==null&&g._namespacePrefix===m)return g._namespace;for(var y=0;y<g._attributeList.length;y++){var v=g._attributeList[y];if(v._namespace===l.namespace.XMLNS&&v._namespacePrefix==="xmlns"&&v._localName===m||m===null&&v._namespace===l.namespace.XMLNS&&v._namespacePrefix===null&&v._localName==="xmlns")return v._value||null}return g.parentElement===null?null:p(g.parentElement,m)}return s.Guard.isDocumentNode(g)?g.documentElement===null?null:p(g.documentElement,m):s.Guard.isDocumentTypeNode(g)||s.Guard.isDocumentFragmentNode(g)?null:s.Guard.isAttrNode(g)?g._element===null?null:p(g._element,m):g._parent&&s.Guard.isElementNode(g._parent)?p(g._parent,m):null}},function(n,r,i){var a=this&&this.__values||function(h){var p=typeof Symbol=="function"&&Symbol.iterator,g=p&&h[p],m=0;if(g)return g.call(h);if(h&&typeof h.length=="number")return{next:function(){return h&&m>=h.length&&(h=void 0),{value:h&&h[m++],done:!h}}};throw new TypeError(p?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var o=i(6),s=i(3),l=i(9),c=i(29),f=i(17),u=i(107),d=i(37);r.text_contiguousTextNodes=function(h,p){var g;return p===void 0&&(p=!1),(g={})[Symbol.iterator]=function(){for(var m=h;m&&s.Guard.isTextNode(m._previousSibling);)m=m._previousSibling;return{next:function(){if(m&&!p&&m===h&&(m=s.Guard.isTextNode(m._nextSibling)?m._nextSibling:null),m===null)return{done:!0,value:null};var y={done:!1,value:m};return m=s.Guard.isTextNode(m._nextSibling)?m._nextSibling:null,y}}},g},r.text_contiguousExclusiveTextNodes=function(h,p){var g;return p===void 0&&(p=!1),(g={})[Symbol.iterator]=function(){for(var m=h;m&&s.Guard.isExclusiveTextNode(m._previousSibling);)m=m._previousSibling;return{next:function(){if(m&&!p&&m===h&&(m=s.Guard.isExclusiveTextNode(m._nextSibling)?m._nextSibling:null),m===null)return{done:!0,value:null};var y={done:!1,value:m};return m=s.Guard.isExclusiveTextNode(m._nextSibling)?m._nextSibling:null,y}}},g},r.text_descendantTextContent=function(h){for(var p="",g=f.tree_getFirstDescendantNode(h,!1,!1,(function(m){return s.Guard.isTextNode(m)}));g!==null;)p+=g._data,g=f.tree_getNextDescendantNode(h,g,!1,!1,(function(m){return s.Guard.isTextNode(m)}));return p},r.text_split=function(h,p){var g,m,y=h._data.length;if(p>y)throw new l.IndexSizeError;var v=y-p,x=u.characterData_substringData(h,p,v),w=c.create_text(h._nodeDocument,x),S=h._parent;if(S!==null){d.mutation_insert(w,S,h._nextSibling);try{for(var T=a(o.dom.rangeList),_=T.next();!_.done;_=T.next()){var D=_.value;D._start[0]===h&&D._start[1]>p&&(D._start[0]=w,D._start[1]-=p),D._end[0]===h&&D._end[1]>p&&(D._end[0]=w,D._end[1]-=p);var I=f.tree_index(h);D._start[0]===S&&D._start[1]===I+1&&D._start[1]++,D._end[0]===S&&D._end[1]===I+1&&D._end[1]++}}catch(R){g={error:R}}finally{try{_&&!_.done&&(m=T.return)&&m.call(T)}finally{if(g)throw g.error}}}return u.characterData_replaceData(h,p,v,""),w}},function(n,r,i){var a=i(4),o=i(41),s=i(24),l=i(48),c=[].join,f=o!=Object,u=l("join",",");a({target:"Array",proto:!0,forced:f||!u},{join:function(d){return c.call(s(this),d===void 0?",":d)}})},function(n,r,i){var a=i(4),o=i(83),s=String.fromCharCode,l=String.fromCodePoint;a({target:"String",stat:!0,forced:!!l&&l.length!=1},{fromCodePoint:function(c){for(var f,u=[],d=arguments.length,h=0;d>h;){if(f=+arguments[h++],o(f,1114111)!==f)throw RangeError(f+" is not a valid code point");u.push(f<65536?s(f):s(55296+((f-=65536)>>10),f%1024+56320))}return u.join("")}})},function(n,r,i){var a=this&&this.__read||function(l,c){var f=typeof Symbol=="function"&&l[Symbol.iterator];if(!f)return l;var u,d,h=f.call(l),p=[];try{for(;(c===void 0||c-- >0)&&!(u=h.next()).done;)p.push(u.value)}catch(g){d={error:g}}finally{try{u&&!u.done&&(f=h.return)&&f.call(h)}finally{if(d)throw d.error}}return p};Object.defineProperty(r,"__esModule",{value:!0});var o=i(111),s=(function(){function l(c,f){this._options={skipWhitespaceOnlyText:!1},this.err={line:-1,col:-1,index:-1,str:""},this._str=c,this._index=0,this._length=c.length,f&&(this._options.skipWhitespaceOnlyText=f.skipWhitespaceOnlyText||!1)}return l.prototype.nextToken=function(){if(this.eof())return{type:o.TokenType.EOF};var c=this.skipIfStartsWith("<")?this.openBracket():this.text();return this._options.skipWhitespaceOnlyText&&c.type===o.TokenType.Text&&l.isWhiteSpaceToken(c)&&(c=this.nextToken()),c},l.prototype.openBracket=function(){return this.skipIfStartsWith("?")?this.skipIfStartsWith("xml")?l.isSpace(this._str[this._index])?this.declaration():(this.seek(-3),this.pi()):this.pi():this.skipIfStartsWith("!")?this.skipIfStartsWith("--")?this.comment():this.skipIfStartsWith("[CDATA[")?this.cdata():this.skipIfStartsWith("DOCTYPE")?this.doctype():void this.throwError("Invalid '!' in opening tag."):this.skipIfStartsWith("/")?this.closeTag():this.openTag()},l.prototype.declaration=function(){for(var c="",f="",u="";!this.eof();){if(this.skipSpace(),this.skipIfStartsWith("?>"))return{type:o.TokenType.Declaration,version:c,encoding:f,standalone:u};var d=a(this.attribute(),2),h=d[0],p=d[1];h==="version"?c=p:h==="encoding"?f=p:h==="standalone"?u=p:this.throwError("Invalid attribute name: "+h)}this.throwError("Missing declaration end symbol `?>`")},l.prototype.doctype=function(){var c="",f="";this.skipSpace();var u=this.takeUntil2("[",">",!0);return this.skipSpace(),this.skipIfStartsWith("PUBLIC")?(c=this.quotedString(),f=this.quotedString()):this.skipIfStartsWith("SYSTEM")&&(f=this.quotedString()),this.skipSpace(),this.skipIfStartsWith("[")&&(this.skipUntil("]"),this.skipIfStartsWith("]")||this.throwError("Missing end bracket of DTD internal subset")),this.skipSpace(),this.skipIfStartsWith(">")||this.throwError("Missing doctype end symbol `>`"),{type:o.TokenType.DocType,name:u,pubId:c,sysId:f}},l.prototype.pi=function(){var c=this.takeUntilStartsWith("?>",!0);if(this.eof()&&this.throwError("Missing processing instruction end symbol `?>`"),this.skipSpace(),this.skipIfStartsWith("?>"))return{type:o.TokenType.PI,target:c,data:""};var f=this.takeUntilStartsWith("?>");return this.eof()&&this.throwError("Missing processing instruction end symbol `?>`"),this.seek(2),{type:o.TokenType.PI,target:c,data:f}},l.prototype.text=function(){var c=this.takeUntil("<");return{type:o.TokenType.Text,data:c}},l.prototype.comment=function(){var c=this.takeUntilStartsWith("-->");return this.eof()&&this.throwError("Missing comment end symbol `-->`"),this.seek(3),{type:o.TokenType.Comment,data:c}},l.prototype.cdata=function(){var c=this.takeUntilStartsWith("]]>");return this.eof()&&this.throwError("Missing CDATA end symbol `]>`"),this.seek(3),{type:o.TokenType.CDATA,data:c}},l.prototype.openTag=function(){this.skipSpace();var c=this.takeUntil2(">","/",!0);if(this.skipSpace(),this.skipIfStartsWith(">"))return{type:o.TokenType.Element,name:c,attributes:[],selfClosing:!1};if(this.skipIfStartsWith("/>"))return{type:o.TokenType.Element,name:c,attributes:[],selfClosing:!0};for(var f=[];!this.eof();){if(this.skipSpace(),this.skipIfStartsWith(">"))return{type:o.TokenType.Element,name:c,attributes:f,selfClosing:!1};if(this.skipIfStartsWith("/>"))return{type:o.TokenType.Element,name:c,attributes:f,selfClosing:!0};var u=this.attribute();f.push(u)}this.throwError("Missing opening element tag end symbol `>`")},l.prototype.closeTag=function(){this.skipSpace();var c=this.takeUntil(">",!0);return this.skipSpace(),this.skipIfStartsWith(">")||this.throwError("Missing closing element tag end symbol `>`"),{type:o.TokenType.ClosingTag,name:c}},l.prototype.attribute=function(){this.skipSpace();var c=this.takeUntil("=",!0);return this.skipSpace(),this.skipIfStartsWith("=")||this.throwError("Missing equals sign before attribute value"),[c,this.quotedString()]},l.prototype.quotedString=function(){this.skipSpace();var c=this.take(1);l.isQuote(c)||this.throwError("Missing start quote character before quoted value");var f=this.takeUntil(c);return this.skipIfStartsWith(c)||this.throwError("Missing end quote character after quoted value"),f},l.prototype.eof=function(){return this._index>=this._length},l.prototype.skipIfStartsWith=function(c){var f=c.length;if(f===1)return this._str[this._index]===c&&(this._index++,!0);for(var u=0;u<f;u++)if(this._str[this._index+u]!==c[u])return!1;return this._index+=f,!0},l.prototype.seek=function(c){this._index+=c,this._index<0&&(this._index=0),this._index>this._length&&(this._index=this._length)},l.prototype.skipSpace=function(){for(;!this.eof()&&l.isSpace(this._str[this._index]);)this._index++},l.prototype.take=function(c){if(c===1)return this._str[this._index++];var f=this._index;return this.seek(c),this._str.slice(f,this._index)},l.prototype.takeUntil=function(c,f){f===void 0&&(f=!1);for(var u=this._index;this._index<this._length;){var d=this._str[this._index];if(d===c||f&&l.isSpace(d))break;this._index++}return this._str.slice(u,this._index)},l.prototype.takeUntil2=function(c,f,u){u===void 0&&(u=!1);for(var d=this._index;this._index<this._length;){var h=this._str[this._index];if(h===c||h===f||u&&l.isSpace(h))break;this._index++}return this._str.slice(d,this._index)},l.prototype.takeUntilStartsWith=function(c,f){f===void 0&&(f=!1);for(var u=this._index,d=c.length;this._index<this._length;){for(var h=!0,p=0;p<d;p++){var g=this._str[this._index+p],m=c[p];if(f&&l.isSpace(g))return this._str.slice(u,this._index);if(g!==m){this._index++,h=!1;break}}if(h)return this._str.slice(u,this._index)}return this._index=this._length,this._str.slice(u)},l.prototype.skipUntil=function(c){for(;this._index<this._length&&this._str[this._index]!==c;)this._index++},l.isWhiteSpaceToken=function(c){for(var f=c.data,u=0;u<f.length;u++){var d=f[u];if(d!==" "&&d!==`
`&&d!=="\r"&&d!=="	"&&d!=="\f")return!1}return!0},l.isSpace=function(c){return c===" "||c===`
`||c==="\r"||c==="	"},l.isQuote=function(c){return c==='"'||c==="'"},l.prototype.throwError=function(c){for(var f=/\r\n|\r|\n/g,u=null,d=0,h=0,p=this._str.length;(u=f.exec(this._str))!==null&&u!==null;)if(d++,u.index<this._index&&(h=f.lastIndex),u.index>this._index){p=u.index;break}throw this.err={line:d,col:this._index-h,index:this._index,str:this._str.substring(h,p)},new Error(c+`
Index: `+this.err.index+`
Ln: `+this.err.line+", Col: "+this.err.col+`
Input: `+this.err.str)},l.prototype[Symbol.iterator]=function(){return this._index=0,{next:(function(){var c=this.nextToken();return c.type===o.TokenType.EOF?{done:!0,value:null}:{done:!1,value:c}}).bind(this)}},l})();r.XMLStringLexer=s},function(n,r,i){var a=i(39);n.exports=new a({include:[i(182)]})},function(n,r,i){var a=i(39);n.exports=new a({include:[i(113)],implicit:[i(289),i(290),i(291),i(292)]})},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(91),o=i(1),s=i(3),l=i(77),c=i(109);function f(p,g){var m=d(p===void 0||u(p)?p:a.DefaultBuilderOptions),y=u(p)?g:p,v=c.createDocument();h(v,m);var x=new l.XMLBuilderImpl(v);return y!==void 0&&x.ele(y),x}function u(p){if(!o.isPlainObject(p))return!1;for(var g in p)if(p.hasOwnProperty(g)&&!a.XMLBuilderOptionKeys.has(g))return!1;return!0}function d(p){p===void 0&&(p={});var g=o.applyDefaults(p,a.DefaultBuilderOptions);if(g.convert.att.length===0||g.convert.ins.length===0||g.convert.text.length===0||g.convert.cdata.length===0||g.convert.comment.length===0)throw new Error("JS object converter strings cannot be zero length.");return g}function h(p,g,m){var y=p;y._xmlBuilderOptions=g,y._isFragment=m}r.builder=function(p,g){var m=d(u(p)?p:a.DefaultBuilderOptions),y=s.Guard.isNode(p)||o.isArray(p)?p:g;if(y===void 0)throw new Error("Invalid arguments.");if(o.isArray(y)){for(var v=[],x=0;x<y.length;x++){var w=new l.XMLBuilderImpl(y[x]);w.set(m),v.push(w)}return v}var S=new l.XMLBuilderImpl(y);return S.set(m),S},r.create=f,r.fragment=function(p,g){var m=d(p===void 0||u(p)?p:a.DefaultBuilderOptions),y=u(p)?g:p,v=c.createDocument();h(v,m,!0);var x=new l.XMLBuilderImpl(v.createDocumentFragment());return y!==void 0&&x.ele(y),x},r.convert=function(p,g,m){var y,v,x;return u(p)&&g!==void 0?(y=p,v=g,x=m):(y=a.DefaultBuilderOptions,v=p,x=g||void 0),f(y,v).end(x)}},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(77);r.builder=a.builder,r.create=a.create,r.fragment=a.fragment,r.convert=a.convert,r.createCB=a.createCB,r.fragmentCB=a.fragmentCB},function(n,r,i){i(31),i(32),i(33),i(191),i(192),i(194),i(64),i(19),i(198),i(199),i(89),i(201),i(65),i(20),i(66),i(22),i(23);var a=this&&this.__read||function(y,v){var x=typeof Symbol=="function"&&y[Symbol.iterator];if(!x)return y;var w,S,T=x.call(y),_=[];try{for(;(v===void 0||v-- >0)&&!(w=T.next()).done;)_.push(w.value)}catch(D){S={error:D}}finally{try{w&&!w.done&&(x=T.return)&&x.call(T)}finally{if(S)throw S.error}}return _},o=this&&this.__values||function(y){var v=typeof Symbol=="function"&&Symbol.iterator,x=v&&y[v],w=0;if(x)return x.call(y);if(y&&typeof y.length=="number")return{next:function(){return y&&w>=y.length&&(y=void 0),{value:y&&y[w++],done:!y}}};throw new TypeError(v?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var s=i(91),l=i(1),c=i(217),f=i(2),u=i(3),d=i(0),h=i(109),p=i(7),g=i(276),m=(function(){function y(v){this._domNode=v}return Object.defineProperty(y.prototype,"node",{get:function(){return this._domNode},enumerable:!0,configurable:!0}),Object.defineProperty(y.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0}),y.prototype.set=function(v){return this._options=l.applyDefaults(l.applyDefaults(this._options,v,!0),s.DefaultBuilderOptions),this},y.prototype.ele=function(v,x,w){var S,T,_,D,I,R;if(l.isObject(v))return new g.ObjectReader(this._options).parse(this,v);if(v!==null&&/^\s*</.test(v))return new g.XMLReader(this._options).parse(this,v);if(v!==null&&/^\s*[\{\[]/.test(v))return new g.JSONReader(this._options).parse(this,v);if(v!==null&&/^(\s*|(#.*)|(%.*))*---/.test(v))return new g.YAMLReader(this._options).parse(this,v);if((v===null||l.isString(v))&&l.isString(x))D=(S=a([v,x,w],3))[0],I=S[1],R=S[2];else{if(v===null)throw new Error("Element name cannot be null. "+this._debugInfo());D=(T=a([void 0,v,l.isObject(x)?x:void 0],3))[0],I=T[1],R=T[2]}if(R&&(R=l.getValue(R)),D=(_=a(this._extractNamespace(h.sanitizeInput(D,this._options.invalidCharReplacement),h.sanitizeInput(I,this._options.invalidCharReplacement),!0),2))[0],I=_[1],D===void 0){var M=a(d.namespace_extractQName(I),1)[0];D=this.node.lookupNamespaceURI(M)}var A=D!=null?this._doc.createElementNS(D,I):this._doc.createElement(I);this.node.appendChild(A);var L=new y(A),P=this._doc.doctype;if(A===this._doc.documentElement&&P!==null){var B=this._doc.implementation.createDocumentType(this._doc.documentElement.tagName,P.publicId,P.systemId);this._doc.replaceChild(B,P)}return R&&!l.isEmpty(R)&&L.att(R),L},y.prototype.remove=function(){var v=this.up();return v.node.removeChild(this.node),v},y.prototype.att=function(v,x,w){var S,T,_,D,I,R,M=this;if(l.isMap(v)||l.isObject(v))return l.forEachObject(v,(function(F,$){return M.att(F,$)}),this),this;if(v!=null&&(v=l.getValue(v+"")),x!=null&&(x=l.getValue(x+"")),w!=null&&(w=l.getValue(w+"")),v!==null&&!l.isString(v)||!l.isString(x)||w!==null&&!l.isString(w)){if(!l.isString(v)||x!=null&&!l.isString(x))throw new Error("Attribute name and value not specified. "+this._debugInfo());D=(T=a([void 0,v,x],3))[0],I=T[1],R=T[2]}else D=(S=a([v,x,w],3))[0],I=S[1],R=S[2];if(this._options.keepNullAttributes&&R==null)R="";else if(R==null)return this;if(!u.Guard.isElementNode(this.node))throw new Error("An attribute can only be assigned to an element node.");var A=this.node;D=(_=a(this._extractNamespace(D,I,!1),2))[0],I=_[1],I=h.sanitizeInput(I,this._options.invalidCharReplacement),D=h.sanitizeInput(D,this._options.invalidCharReplacement),R=h.sanitizeInput(R,this._options.invalidCharReplacement);var L=a(d.namespace_extractQName(I),2),P=L[0],B=L[1],U=a(d.namespace_extractQName(A.prefix?A.prefix+":"+A.localName:A.localName),1)[0],G=null;return P==="xmlns"?(D=p.namespace.XMLNS,A.namespaceURI===null&&U===B&&(G=R)):P===null&&B==="xmlns"&&U===null&&(D=p.namespace.XMLNS,G=R),G!==null&&(this._updateNamespace(G),A=this.node),D!==void 0?A.setAttributeNS(D,I,R):A.setAttribute(I,R),this},y.prototype.removeAtt=function(v,x){var w,S,T=this;if(!u.Guard.isElementNode(this.node))throw new Error("An attribute can only be removed from an element node.");if(v=l.getValue(v),x!==void 0&&(x=l.getValue(x)),v!==null&&x===void 0)S=v;else{if(v!==null&&!l.isString(v)||x===void 0)throw new Error("Attribute namespace must be a string. "+this._debugInfo());w=v,S=x}return l.isArray(S)||l.isSet(S)?l.forEachArray(S,(function(_){return w===void 0?T.removeAtt(_):T.removeAtt(w,_)}),this):w!==void 0?(S=h.sanitizeInput(S,this._options.invalidCharReplacement),w=h.sanitizeInput(w,this._options.invalidCharReplacement),this.node.removeAttributeNS(w,S)):(S=h.sanitizeInput(S,this._options.invalidCharReplacement),this.node.removeAttribute(S)),this},y.prototype.txt=function(v){if(v==null){if(!this._options.keepNullNodes)return this;v=""}var x=this._doc.createTextNode(h.sanitizeInput(v,this._options.invalidCharReplacement));return this.node.appendChild(x),this},y.prototype.com=function(v){if(v==null){if(!this._options.keepNullNodes)return this;v=""}var x=this._doc.createComment(h.sanitizeInput(v,this._options.invalidCharReplacement));return this.node.appendChild(x),this},y.prototype.dat=function(v){if(v==null){if(!this._options.keepNullNodes)return this;v=""}var x=this._doc.createCDATASection(h.sanitizeInput(v,this._options.invalidCharReplacement));return this.node.appendChild(x),this},y.prototype.ins=function(v,x){var w=this;if(x===void 0&&(x=""),x==null){if(!this._options.keepNullNodes)return this;x=""}if(l.isArray(v)||l.isSet(v))l.forEachArray(v,(function(T){var _=(T+="").indexOf(" "),D=_===-1?T:T.substr(0,_),I=_===-1?"":T.substr(_+1);w.ins(D,I)}),this);else if(l.isMap(v)||l.isObject(v))l.forEachObject(v,(function(T,_){return w.ins(T,_)}),this);else{var S=this._doc.createProcessingInstruction(h.sanitizeInput(v,this._options.invalidCharReplacement),h.sanitizeInput(x,this._options.invalidCharReplacement));this.node.appendChild(S)}return this},y.prototype.dec=function(v){return this._options.version=v.version||"1.0",this._options.encoding=v.encoding,this._options.standalone=v.standalone,this},y.prototype.dtd=function(v){var x=h.sanitizeInput(v&&v.name||(this._doc.documentElement?this._doc.documentElement.tagName:"ROOT"),this._options.invalidCharReplacement),w=h.sanitizeInput(v&&v.pubID||"",this._options.invalidCharReplacement),S=h.sanitizeInput(v&&v.sysID||"",this._options.invalidCharReplacement);if(this._doc.documentElement!==null&&x!==this._doc.documentElement.tagName)throw new Error("DocType name does not match document element name.");var T=this._doc.implementation.createDocumentType(x,w,S);return this._doc.doctype!==null?this._doc.replaceChild(T,this._doc.doctype):this._doc.insertBefore(T,this._doc.documentElement),this},y.prototype.import=function(v){var x,w,S=this._domNode,T=this._doc,_=v.node;if(u.Guard.isDocumentNode(_)){var D=_.documentElement;if(D===null)throw new Error("Imported document has no document element node. "+this._debugInfo());var I=T.importNode(D,!0);S.appendChild(I);var R=a(d.namespace_extractQName(I.prefix?I.prefix+":"+I.localName:I.localName),1)[0],M=S.lookupNamespaceURI(R);new y(I)._updateNamespace(M)}else if(u.Guard.isDocumentFragmentNode(_))try{for(var A=o(_.childNodes),L=A.next();!L.done;L=A.next()){var P=L.value;I=T.importNode(P,!0),S.appendChild(I),u.Guard.isElementNode(I)&&(R=a(d.namespace_extractQName(I.prefix?I.prefix+":"+I.localName:I.localName),1)[0],M=S.lookupNamespaceURI(R),new y(I)._updateNamespace(M))}}catch(B){x={error:B}}finally{try{L&&!L.done&&(w=A.return)&&w.call(A)}finally{if(x)throw x.error}}else I=T.importNode(_,!0),S.appendChild(I),u.Guard.isElementNode(I)&&(R=a(d.namespace_extractQName(I.prefix?I.prefix+":"+I.localName:I.localName),1)[0],M=S.lookupNamespaceURI(R),new y(I)._updateNamespace(M));return this},y.prototype.doc=function(){if(this._doc._isFragment){for(var v=this.node;v&&v.nodeType!==f.NodeType.DocumentFragment;)v=v.parentNode;if(v===null)throw new Error("Node has no parent node while searching for document fragment ancestor. "+this._debugInfo());return new y(v)}return new y(this._doc)},y.prototype.root=function(){var v=this._doc.documentElement;if(!v)throw new Error("Document root element is null. "+this._debugInfo());return new y(v)},y.prototype.up=function(){var v=this._domNode.parentNode;if(!v)throw new Error("Parent node is null. "+this._debugInfo());return new y(v)},y.prototype.prev=function(){var v=this._domNode.previousSibling;if(!v)throw new Error("Previous sibling node is null. "+this._debugInfo());return new y(v)},y.prototype.next=function(){var v=this._domNode.nextSibling;if(!v)throw new Error("Next sibling node is null. "+this._debugInfo());return new y(v)},y.prototype.first=function(){var v=this._domNode.firstChild;if(!v)throw new Error("First child node is null. "+this._debugInfo());return new y(v)},y.prototype.last=function(){var v=this._domNode.lastChild;if(!v)throw new Error("Last child node is null. "+this._debugInfo());return new y(v)},y.prototype.each=function(v,x,w,S){x===void 0&&(x=!1),w===void 0&&(w=!1);for(var T=this._getFirstDescendantNode(this._domNode,x,w);T[0];){var _=this._getNextDescendantNode(this._domNode,T[0],w,T[1],T[2]);v.call(S,new y(T[0]),T[1],T[2]),T=_}return this},y.prototype.map=function(v,x,w,S){x===void 0&&(x=!1),w===void 0&&(w=!1);var T=[];return this.each((function(_,D,I){return T.push(v.call(S,_,D,I))}),x,w),T},y.prototype.reduce=function(v,x,w,S,T){w===void 0&&(w=!1),S===void 0&&(S=!1);var _=x;return this.each((function(D,I,R){return _=v.call(T,_,D,I,R)}),w,S),_},y.prototype.find=function(v,x,w,S){x===void 0&&(x=!1),w===void 0&&(w=!1);for(var T=this._getFirstDescendantNode(this._domNode,x,w);T[0];){var _=new y(T[0]);if(v.call(S,_,T[1],T[2]))return _;T=this._getNextDescendantNode(this._domNode,T[0],w,T[1],T[2])}},y.prototype.filter=function(v,x,w,S){x===void 0&&(x=!1),w===void 0&&(w=!1);var T=[];return this.each((function(_,D,I){v.call(S,_,D,I)&&T.push(_)}),x,w),T},y.prototype.every=function(v,x,w,S){x===void 0&&(x=!1),w===void 0&&(w=!1);for(var T=this._getFirstDescendantNode(this._domNode,x,w);T[0];){var _=new y(T[0]);if(!v.call(S,_,T[1],T[2]))return!1;T=this._getNextDescendantNode(this._domNode,T[0],w,T[1],T[2])}return!0},y.prototype.some=function(v,x,w,S){x===void 0&&(x=!1),w===void 0&&(w=!1);for(var T=this._getFirstDescendantNode(this._domNode,x,w);T[0];){var _=new y(T[0]);if(v.call(S,_,T[1],T[2]))return!0;T=this._getNextDescendantNode(this._domNode,T[0],w,T[1],T[2])}return!1},y.prototype.toArray=function(v,x){v===void 0&&(v=!1),x===void 0&&(x=!1);var w=[];return this.each((function(S){return w.push(S)}),v,x),w},y.prototype.toString=function(v){return(v=v||{}).format===void 0&&(v.format="xml"),this._serialize(v)},y.prototype.toObject=function(v){return(v=v||{}).format===void 0&&(v.format="object"),this._serialize(v)},y.prototype.end=function(v){return(v=v||{}).format===void 0&&(v.format="xml"),this.doc()._serialize(v)},y.prototype._getFirstDescendantNode=function(v,x,w){return x?[this._domNode,0,0]:w?this._getNextDescendantNode(v,v,w,0,0):[this._domNode.firstChild,0,1]},y.prototype._getNextDescendantNode=function(v,x,w,S,T){if(!w)return v===x?[x.firstChild,0,T+1]:[x.nextSibling,S+1,T];if(x.firstChild)return[x.firstChild,0,T+1];if(x===v)return[null,-1,-1];if(x.nextSibling)return[x.nextSibling,S+1,T];for(var _=x.parentNode;_&&_!==v;){if(_.nextSibling)return[_.nextSibling,d.tree_index(_.nextSibling),T-1];_=_.parentNode,T--}return[null,-1,-1]},y.prototype._serialize=function(v){if(v.format==="xml")return new c.XMLWriter(this._options,v).serialize(this.node);if(v.format==="map")return new c.MapWriter(this._options,v).serialize(this.node);if(v.format==="object")return new c.ObjectWriter(this._options,v).serialize(this.node);if(v.format==="json")return new c.JSONWriter(this._options,v).serialize(this.node);if(v.format==="yaml")return new c.YAMLWriter(this._options,v).serialize(this.node);throw new Error("Invalid writer format: "+v.format+". "+this._debugInfo())},y.prototype._extractNamespace=function(v,x,w){var S=x.indexOf("@");if(S>0&&(v===void 0&&(v=x.slice(S+1)),x=x.slice(0,S)),v===void 0)v=w?this._options.defaultNamespace.ele:this._options.defaultNamespace.att;else if(v!==null&&v[0]==="@"){var T=v.slice(1);if((v=this._options.namespaceAlias[T])===void 0)throw new Error("Namespace alias `"+T+"` is not defined. "+this._debugInfo())}return[v,x]},y.prototype._updateNamespace=function(v){var x,w,S,T,_=this._domNode;if(u.Guard.isElementNode(_)&&v!==null&&_.namespaceURI!==v){var D=a(d.namespace_extractQName(_.prefix?_.prefix+":"+_.localName:_.localName),2),I=D[0],R=D[1],M=d.create_element(this._doc,R,v,I);try{for(var A=o(_.attributes),L=A.next();!L.done;L=A.next()){var P=L.value,B=P.prefix?P.prefix+":"+P.localName:P.localName,U=a(d.namespace_extractQName(B),1)[0],G=P.namespaceURI;G===null&&U!==null&&(G=_.lookupNamespaceURI(U)),G===null?M.setAttribute(B,P.value):M.setAttributeNS(G,B,P.value)}}catch(ye){x={error:ye}}finally{try{L&&!L.done&&(w=A.return)&&w.call(A)}finally{if(x)throw x.error}}var F=_.parentNode;if(F===null)throw new Error("Parent node is null."+this._debugInfo());F.replaceChild(M,_),this._domNode=M;try{for(var $=o(_.childNodes),V=$.next();!V.done;V=$.next()){var X=V.value.cloneNode(!0);if(M.appendChild(X),u.Guard.isElementNode(X)){var Q=a(d.namespace_extractQName(X.prefix?X.prefix+":"+X.localName:X.localName),1)[0],re=M.lookupNamespaceURI(Q);new y(X)._updateNamespace(re)}}}catch(ye){S={error:ye}}finally{try{V&&!V.done&&(T=$.return)&&T.call($)}finally{if(S)throw S.error}}}},Object.defineProperty(y.prototype,"_doc",{get:function(){var v=this.node;if(u.Guard.isDocumentNode(v))return v;var x=v.ownerDocument;if(!x)throw new Error("Owner document is null. "+this._debugInfo());return x},enumerable:!0,configurable:!0}),y.prototype._debugInfo=function(v){var x=this.node,w=x.parentNode;v=v||x.nodeName;var S=w?w.nodeName:"";return S?"node: <"+v+">, parent: <"+S+">":"node: <"+v+">"},Object.defineProperty(y.prototype,"_options",{get:function(){var v=this._doc;if(v._xmlBuilderOptions===void 0)throw new Error("Builder options is not set.");return v._xmlBuilderOptions},set:function(v){this._doc._xmlBuilderOptions=v},enumerable:!0,configurable:!0}),y})();r.XMLBuilderImpl=m},function(n,r,i){var a=i(11),o=i(117),s=a.WeakMap;n.exports=typeof s=="function"&&/native code/.test(o(s))},function(n,r,i){var a=i(46),o=i(82),s=i(85),l=i(18);n.exports=a("Reflect","ownKeys")||function(c){var f=o.f(l(c)),u=s.f;return u?f.concat(u(c)):f}},function(n,r,i){var a=i(16),o=i(15),s=i(18),l=i(61);n.exports=a?Object.defineProperties:function(c,f){s(c);for(var u,d=l(f),h=d.length,p=0;h>p;)o.f(c,u=d[p++],f[u]);return c}},function(n,r,i){var a=i(46);n.exports=a("document","documentElement")},function(n,r,i){var a=i(24),o=i(82).f,s={}.toString,l=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];n.exports.f=function(c){return l&&s.call(c)=="[object Window]"?(function(f){try{return o(f)}catch{return l.slice()}})(c):o(a(c))}},function(n,r,i){var a=i(4),o=i(36).every,s=i(48),l=i(28),c=s("every"),f=l("every");a({target:"Array",proto:!0,forced:!c||!f},{every:function(u){return o(this,u,arguments.length>1?arguments[1]:void 0)}})},function(n,r,i){var a=i(4),o=i(36).filter,s=i(63),l=i(28),c=s("filter"),f=l("filter");a({target:"Array",proto:!0,forced:!c||!f},{filter:function(u){return o(this,u,arguments.length>1?arguments[1]:void 0)}})},function(n,r,i){var a=i(46);n.exports=a("navigator","userAgent")||""},function(n,r,i){var a=i(4),o=i(36).find,s=i(130),l=i(28),c=!0,f=l("find");"find"in[]&&Array(1).find((function(){c=!1})),a({target:"Array",proto:!0,forced:c||!f},{find:function(u){return o(this,u,arguments.length>1?arguments[1]:void 0)}}),s("find")},function(n,r,i){var a=i(131).IteratorPrototype,o=i(60),s=i(40),l=i(62),c=i(49),f=function(){return this};n.exports=function(u,d,h){var p=d+" Iterator";return u.prototype=o(a,{next:s(1,h)}),l(u,p,!1,!0),c[p]=f,u}},function(n,r,i){var a=i(8);n.exports=!a((function(){function o(){}return o.prototype.constructor=null,Object.getPrototypeOf(new o)!==o.prototype}))},function(n,r,i){var a=i(13);n.exports=function(o){if(!a(o)&&o!==null)throw TypeError("Can't set "+String(o)+" as a prototype");return o}},function(n,r,i){var a=i(4),o=i(36).map,s=i(63),l=i(28),c=s("map"),f=l("map");a({target:"Array",proto:!0,forced:!c||!f},{map:function(u){return o(this,u,arguments.length>1?arguments[1]:void 0)}})},function(n,r,i){var a=i(4),o=i(200).left,s=i(48),l=i(28),c=s("reduce"),f=l("reduce",{1:0});a({target:"Array",proto:!0,forced:!c||!f},{reduce:function(u){return o(this,u,arguments.length,arguments.length>1?arguments[1]:void 0)}})},function(n,r,i){var a=i(127),o=i(27),s=i(41),l=i(26),c=function(f){return function(u,d,h,p){a(d);var g=o(u),m=s(g),y=l(g.length),v=f?y-1:0,x=f?-1:1;if(h<2)for(;;){if(v in m){p=m[v],v+=x;break}if(v+=x,f?v<0:y<=v)throw TypeError("Reduce of empty array with no initial value")}for(;f?v>=0:y>v;v+=x)v in m&&(p=d(p,m[v],v,g));return p}};n.exports={left:c(!1),right:c(!0)}},function(n,r,i){var a=i(4),o=i(36).some,s=i(48),l=i(28),c=s("some"),f=l("some");a({target:"Array",proto:!0,forced:!c||!f},{some:function(u){return o(this,u,arguments.length>1?arguments[1]:void 0)}})},function(n,r,i){var a=i(90),o=i(135);n.exports=a?{}.toString:function(){return"[object "+o(this)+"]"}},function(n,r){n.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},function(n,r,i){var a=i(8);n.exports=!a((function(){return Object.isExtensible(Object.preventExtensions({}))}))},function(n,r,i){var a=i(5),o=i(49),s=a("iterator"),l=Array.prototype;n.exports=function(c){return c!==void 0&&(o.Array===c||l[s]===c)}},function(n,r,i){var a=i(135),o=i(49),s=i(5)("iterator");n.exports=function(l){if(l!=null)return l[s]||l["@@iterator"]||o[a(l)]}},function(n,r,i){var a=i(18);n.exports=function(o,s,l,c){try{return c?s(a(l)[0],l[1]):s(l)}catch(u){var f=o.return;throw f!==void 0&&a(f.call(o)),u}}},function(n,r,i){var a=i(5)("iterator"),o=!1;try{var s=0,l={next:function(){return{done:!!s++}},return:function(){o=!0}};l[a]=function(){return this},Array.from(l,(function(){throw 2}))}catch{}n.exports=function(c,f){if(!f&&!o)return!1;var u=!1;try{var d={};d[a]=function(){return{next:function(){return{done:u=!0}}}},c(d)}catch{}return u}},function(n,r,i){var a=i(13),o=i(133);n.exports=function(s,l,c){var f,u;return o&&typeof(f=l.constructor)=="function"&&f!==c&&a(u=f.prototype)&&u!==c.prototype&&o(s,u),s}},function(n,r,i){var a=i(25);n.exports=function(o,s,l){for(var c in s)a(o,c,s[c],l);return o}},function(n,r,i){var a=i(46),o=i(15),s=i(5),l=i(16),c=s("species");n.exports=function(f){var u=a(f),d=o.f;l&&u&&!u[c]&&d(u,c,{configurable:!0,get:function(){return this}})}},function(n,r,i){var a=this&&this.__generator||function(l,c){var f,u,d,h,p={label:0,sent:function(){if(1&d[0])throw d[1];return d[1]},trys:[],ops:[]};return h={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(h[Symbol.iterator]=function(){return this}),h;function g(m){return function(y){return(function(v){if(f)throw new TypeError("Generator is already executing.");for(;p;)try{if(f=1,u&&(d=2&v[0]?u.return:v[0]?u.throw||((d=u.return)&&d.call(u),0):u.next)&&!(d=d.call(u,v[1])).done)return d;switch(u=0,d&&(v=[2&v[0],d.value]),v[0]){case 0:case 1:d=v;break;case 4:return p.label++,{value:v[1],done:!1};case 5:p.label++,u=v[1],v=[0];continue;case 7:v=p.ops.pop(),p.trys.pop();continue;default:if(d=p.trys,!((d=d.length>0&&d[d.length-1])||v[0]!==6&&v[0]!==2)){p=0;continue}if(v[0]===3&&(!d||v[1]>d[0]&&v[1]<d[3])){p.label=v[1];break}if(v[0]===6&&p.label<d[1]){p.label=d[1],d=v;break}if(d&&p.label<d[2]){p.label=d[2],p.ops.push(v);break}d[2]&&p.ops.pop(),p.trys.pop();continue}v=c.call(l,p)}catch(x){v=[6,x],u=0}finally{f=d=0}if(5&v[0])throw v[1];return{value:v[0]?v[1]:void 0,done:!0}})([m,y])}}},o=this&&this.__values||function(l){var c=typeof Symbol=="function"&&Symbol.iterator,f=c&&l[c],u=0;if(f)return f.call(l);if(l&&typeof l.length=="number")return{next:function(){return l&&u>=l.length&&(l=void 0),{value:l&&l[u++],done:!l}}};throw new TypeError(c?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var s=(function(){function l(c){c===void 0&&(c=1e3),this._items=new Set,this._limit=c}return l.prototype.add=function(c){if(this._items.add(c),this._items.size>this._limit){var f=this._items.values().next();f.done||this._items.delete(f.value)}return this},l.prototype.delete=function(c){return this._items.delete(c)},l.prototype.has=function(c){return this._items.has(c)},l.prototype.clear=function(){this._items.clear()},Object.defineProperty(l.prototype,"size",{get:function(){return this._items.size},enumerable:!0,configurable:!0}),l.prototype.forEach=function(c,f){var u=this;this._items.forEach((function(d){return c.call(f,d,d,u)}))},l.prototype.keys=function(){return a(this,(function(c){switch(c.label){case 0:return[5,o(this._items.keys())];case 1:return c.sent(),[2]}}))},l.prototype.values=function(){return a(this,(function(c){switch(c.label){case 0:return[5,o(this._items.values())];case 1:return c.sent(),[2]}}))},l.prototype.entries=function(){return a(this,(function(c){switch(c.label){case 0:return[5,o(this._items.entries())];case 1:return c.sent(),[2]}}))},l.prototype[Symbol.iterator]=function(){return a(this,(function(c){switch(c.label){case 0:return[5,o(this._items)];case 1:return c.sent(),[2]}}))},Object.defineProperty(l.prototype,Symbol.toStringTag,{get:function(){return"FixedSizeSet"},enumerable:!0,configurable:!0}),l})();r.FixedSizeSet=s},function(n,r,i){var a=this&&this.__generator||function(l,c){var f,u,d,h,p={label:0,sent:function(){if(1&d[0])throw d[1];return d[1]},trys:[],ops:[]};return h={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(h[Symbol.iterator]=function(){return this}),h;function g(m){return function(y){return(function(v){if(f)throw new TypeError("Generator is already executing.");for(;p;)try{if(f=1,u&&(d=2&v[0]?u.return:v[0]?u.throw||((d=u.return)&&d.call(u),0):u.next)&&!(d=d.call(u,v[1])).done)return d;switch(u=0,d&&(v=[2&v[0],d.value]),v[0]){case 0:case 1:d=v;break;case 4:return p.label++,{value:v[1],done:!1};case 5:p.label++,u=v[1],v=[0];continue;case 7:v=p.ops.pop(),p.trys.pop();continue;default:if(d=p.trys,!((d=d.length>0&&d[d.length-1])||v[0]!==6&&v[0]!==2)){p=0;continue}if(v[0]===3&&(!d||v[1]>d[0]&&v[1]<d[3])){p.label=v[1];break}if(v[0]===6&&p.label<d[1]){p.label=d[1],d=v;break}if(d&&p.label<d[2]){p.label=d[2],p.ops.push(v);break}d[2]&&p.ops.pop(),p.trys.pop();continue}v=c.call(l,p)}catch(x){v=[6,x],u=0}finally{f=d=0}if(5&v[0])throw v[1];return{value:v[0]?v[1]:void 0,done:!0}})([m,y])}}},o=this&&this.__values||function(l){var c=typeof Symbol=="function"&&Symbol.iterator,f=c&&l[c],u=0;if(f)return f.call(l);if(l&&typeof l.length=="number")return{next:function(){return l&&u>=l.length&&(l=void 0),{value:l&&l[u++],done:!l}}};throw new TypeError(c?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var s=(function(){function l(c){c===void 0&&(c=1e3),this._items=new Map,this._limit=c}return l.prototype.get=function(c){return this._items.get(c)},l.prototype.set=function(c,f){if(this._items.set(c,f),this._items.size>this._limit){var u=this._items.keys().next();u.done||this._items.delete(u.value)}},l.prototype.delete=function(c){return this._items.delete(c)},l.prototype.has=function(c){return this._items.has(c)},l.prototype.clear=function(){this._items.clear()},Object.defineProperty(l.prototype,"size",{get:function(){return this._items.size},enumerable:!0,configurable:!0}),l.prototype.forEach=function(c,f){this._items.forEach((function(u,d){return c.call(f,d,u)}))},l.prototype.keys=function(){return a(this,(function(c){switch(c.label){case 0:return[5,o(this._items.keys())];case 1:return c.sent(),[2]}}))},l.prototype.values=function(){return a(this,(function(c){switch(c.label){case 0:return[5,o(this._items.values())];case 1:return c.sent(),[2]}}))},l.prototype.entries=function(){return a(this,(function(c){switch(c.label){case 0:return[5,o(this._items.entries())];case 1:return c.sent(),[2]}}))},l.prototype[Symbol.iterator]=function(){return a(this,(function(c){switch(c.label){case 0:return[5,o(this._items)];case 1:return c.sent(),[2]}}))},Object.defineProperty(l.prototype,Symbol.toStringTag,{get:function(){return"ObjectCache"},enumerable:!0,configurable:!0}),l})();r.ObjectCache=s},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=(function(){function o(s){s===void 0&&(s=1e3),this._items=new Map,this._limit=s}return o.prototype.check=function(s,l){if(this._items.get(s)===l)return!0;if(this._items.get(l)===s)return!1;var c=Math.random()<.5;if(c?this._items.set(s,l):this._items.set(l,s),this._items.size>this._limit){var f=this._items.keys().next();f.done||this._items.delete(f.value)}return c},o})();r.CompareCache=a},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=(function(){function o(s){this._initialized=!1,this._value=void 0,this._initFunc=s}return Object.defineProperty(o.prototype,"value",{get:function(){return this._initialized||(this._value=this._initFunc(),this._initialized=!0),this._value},enumerable:!0,configurable:!0}),o})();r.Lazy=a},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=(function(){function o(s){this._pointer=0,this._chars=Array.from(s),this._length=this._chars.length}return Object.defineProperty(o.prototype,"eof",{get:function(){return this._pointer>=this._length},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"length",{get:function(){return this._length},enumerable:!0,configurable:!0}),o.prototype.codePoint=function(){if(this._codePoint===void 0)if(this.eof)this._codePoint=-1;else{var s=this._chars[this._pointer].codePointAt(0);this._codePoint=s!==void 0?s:-1}return this._codePoint},o.prototype.c=function(){return this._c===void 0&&(this._c=this.eof?"":this._chars[this._pointer]),this._c},o.prototype.remaining=function(){return this._remaining===void 0&&(this._remaining=this.eof?"":this._chars.slice(this._pointer+1).join("")),this._remaining},o.prototype.substring=function(){return this._substring===void 0&&(this._substring=this.eof?"":this._chars.slice(this._pointer).join("")),this._substring},Object.defineProperty(o.prototype,"pointer",{get:function(){return this._pointer},set:function(s){s!==this._pointer&&(this._pointer=s,this._codePoint=void 0,this._c=void 0,this._remaining=void 0,this._substring=void 0)},enumerable:!0,configurable:!0}),o})();r.StringWalker=a},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(218);r.MapWriter=a.MapWriter;var o=i(258);r.XMLWriter=o.XMLWriter;var s=i(67);r.ObjectWriter=s.ObjectWriter;var l=i(260);r.JSONWriter=l.JSONWriter;var c=i(261);r.YAMLWriter=c.YAMLWriter},function(n,r,i){i(19),i(219),i(20),i(22),i(23);var a,o=this&&this.__extends||(a=function(f,u){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,h){d.__proto__=h}||function(d,h){for(var p in h)h.hasOwnProperty(p)&&(d[p]=h[p])})(f,u)},function(f,u){function d(){this.constructor=f}a(f,u),f.prototype=u===null?Object.create(u):(d.prototype=u.prototype,new d)});Object.defineProperty(r,"__esModule",{value:!0});var s=i(1),l=i(67),c=(function(f){function u(d,h){var p=f.call(this,d)||this;return p._writerOptions=s.applyDefaults(h,{format:"map",wellFormed:!1,group:!1,verbose:!1}),p}return o(u,f),u.prototype.serialize=function(d){var h=s.applyDefaults(this._writerOptions,{format:"object",wellFormed:!1,verbose:!1}),p=new l.ObjectWriter(this._builderOptions,h).serialize(d);return this._convertObject(p)},u.prototype._convertObject=function(d){if(s.isArray(d)){for(var h=0;h<d.length;h++)d[h]=this._convertObject(d[h]);return d}if(s.isObject(d)){var p=new Map;for(var g in d)p.set(g,this._convertObject(d[g]));return p}return d},u})(i(50).BaseWriter);r.MapWriter=c},function(n,r,i){var a=i(139),o=i(143);n.exports=a("Map",(function(s){return function(){return s(this,arguments.length?arguments[0]:void 0)}}),o)},function(n,r,i){var a=i(4),o=i(8),s=i(59),l=i(13),c=i(27),f=i(26),u=i(134),d=i(128),h=i(63),p=i(5),g=i(129),m=p("isConcatSpreadable"),y=g>=51||!o((function(){var w=[];return w[m]=!1,w.concat()[0]!==w})),v=h("concat"),x=function(w){if(!l(w))return!1;var S=w[m];return S!==void 0?!!S:s(w)};a({target:"Array",proto:!0,forced:!y||!v},{concat:function(w){var S,T,_,D,I,R=c(this),M=d(R,0),A=0;for(S=-1,_=arguments.length;S<_;S++)if(x(I=S===-1?R:arguments[S])){if(A+(D=f(I.length))>9007199254740991)throw TypeError("Maximum allowed index exceeded");for(T=0;T<D;T++,A++)T in I&&u(M,A,I[T])}else{if(A>=9007199254740991)throw TypeError("Maximum allowed index exceeded");u(M,A++,I)}return M.length=A,M}})},function(n,r,i){var a=i(8);function o(s,l){return RegExp(s,l)}r.UNSUPPORTED_Y=a((function(){var s=o("a","y");return s.lastIndex=2,s.exec("abcd")!=null})),r.BROKEN_CARET=a((function(){var s=o("^r","gy");return s.lastIndex=2,s.exec("str")!=null}))},function(n,r,i){var a=i(223);n.exports=function(o){if(a(o))throw TypeError("The method doesn't accept regular expressions");return o}},function(n,r,i){var a=i(13),o=i(42),s=i(5)("match");n.exports=function(l){var c;return a(l)&&((c=l[s])!==void 0?!!c:o(l)=="RegExp")}},function(n,r,i){var a=i(5)("match");n.exports=function(o){var s=/./;try{"/./"[o](s)}catch{try{return s[a]=!1,"/./"[o](s)}catch{}}return!1}},function(n,r,i){i(68);var a=i(25),o=i(8),s=i(5),l=i(93),c=i(21),f=s("species"),u=!o((function(){var m=/./;return m.exec=function(){var y=[];return y.groups={a:"7"},y},"".replace(m,"$<a>")!=="7"})),d="a".replace(/./,"$0")==="$0",h=s("replace"),p=!!/./[h]&&/./[h]("a","$0")==="",g=!o((function(){var m=/(?:)/,y=m.exec;m.exec=function(){return y.apply(this,arguments)};var v="ab".split(m);return v.length!==2||v[0]!=="a"||v[1]!=="b"}));n.exports=function(m,y,v,x){var w=s(m),S=!o((function(){var M={};return M[w]=function(){return 7},""[m](M)!=7})),T=S&&!o((function(){var M=!1,A=/a/;return m==="split"&&((A={}).constructor={},A.constructor[f]=function(){return A},A.flags="",A[w]=/./[w]),A.exec=function(){return M=!0,null},A[w](""),!M}));if(!S||!T||m==="replace"&&(!u||!d||p)||m==="split"&&!g){var _=/./[w],D=v(w,""[m],(function(M,A,L,P,B){return A.exec===l?S&&!B?{done:!0,value:_.call(A,L,P)}:{done:!0,value:M.call(L,A,P)}:{done:!1}}),{REPLACE_KEEPS_$0:d,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:p}),I=D[0],R=D[1];a(String.prototype,m,I),a(RegExp.prototype,w,y==2?function(M,A){return R.call(M,this,A)}:function(M){return R.call(M,this)})}x&&c(RegExp.prototype[w],"sham",!0)}},function(n,r,i){var a=i(137).charAt;n.exports=function(o,s,l){return s+(l?a(o,s).length:1)}},function(n,r,i){var a=i(42),o=i(93);n.exports=function(s,l){var c=s.exec;if(typeof c=="function"){var f=c.call(s,l);if(typeof f!="object")throw TypeError("RegExp exec method returned something other than an Object or null");return f}if(a(s)!=="RegExp")throw TypeError("RegExp#exec called on incompatible receiver");return o.call(s,l)}},function(n,r,i){(function(a){Object.defineProperty(r,"__esModule",{value:!0});var o=i(96);r.forgivingBase64Encode=function(s){return a.from(s).toString("base64")},r.forgivingBase64Decode=function(s){return s===""?"":((s=s.replace(o.ASCIIWhiteSpace,"")).length%4==0&&(s.endsWith("==")?s=s.substr(0,s.length-2):s.endsWith("=")&&(s=s.substr(0,s.length-1))),s.length%4==1?null:/[0-9A-Za-z+/]/.test(s)?a.from(s,"base64").toString("utf8"):null)}}).call(this,i(145).Buffer)},function(n,r,i){r.byteLength=function(h){var p=u(h),g=p[0],m=p[1];return 3*(g+m)/4-m},r.toByteArray=function(h){var p,g,m=u(h),y=m[0],v=m[1],x=new s((function(T,_,D){return 3*(_+D)/4-D})(0,y,v)),w=0,S=v>0?y-4:y;for(g=0;g<S;g+=4)p=o[h.charCodeAt(g)]<<18|o[h.charCodeAt(g+1)]<<12|o[h.charCodeAt(g+2)]<<6|o[h.charCodeAt(g+3)],x[w++]=p>>16&255,x[w++]=p>>8&255,x[w++]=255&p;return v===2&&(p=o[h.charCodeAt(g)]<<2|o[h.charCodeAt(g+1)]>>4,x[w++]=255&p),v===1&&(p=o[h.charCodeAt(g)]<<10|o[h.charCodeAt(g+1)]<<4|o[h.charCodeAt(g+2)]>>2,x[w++]=p>>8&255,x[w++]=255&p),x},r.fromByteArray=function(h){for(var p,g=h.length,m=g%3,y=[],v=0,x=g-m;v<x;v+=16383)y.push(d(h,v,v+16383>x?x:v+16383));return m===1?(p=h[g-1],y.push(a[p>>2]+a[p<<4&63]+"==")):m===2&&(p=(h[g-2]<<8)+h[g-1],y.push(a[p>>10]+a[p>>4&63]+a[p<<2&63]+"=")),y.join("")};for(var a=[],o=[],s=typeof Uint8Array<"u"?Uint8Array:Array,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",c=0,f=l.length;c<f;++c)a[c]=l[c],o[l.charCodeAt(c)]=c;function u(h){var p=h.length;if(p%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var g=h.indexOf("=");return g===-1&&(g=p),[g,g===p?0:4-g%4]}function d(h,p,g){for(var m,y,v=[],x=p;x<g;x+=3)m=(h[x]<<16&16711680)+(h[x+1]<<8&65280)+(255&h[x+2]),v.push(a[(y=m)>>18&63]+a[y>>12&63]+a[y>>6&63]+a[63&y]);return v.join("")}o[45]=62,o[95]=63},function(n,r){r.read=function(i,a,o,s,l){var c,f,u=8*l-s-1,d=(1<<u)-1,h=d>>1,p=-7,g=o?l-1:0,m=o?-1:1,y=i[a+g];for(g+=m,c=y&(1<<-p)-1,y>>=-p,p+=u;p>0;c=256*c+i[a+g],g+=m,p-=8);for(f=c&(1<<-p)-1,c>>=-p,p+=s;p>0;f=256*f+i[a+g],g+=m,p-=8);if(c===0)c=1-h;else{if(c===d)return f?NaN:1/0*(y?-1:1);f+=Math.pow(2,s),c-=h}return(y?-1:1)*f*Math.pow(2,c-s)},r.write=function(i,a,o,s,l,c){var f,u,d,h=8*c-l-1,p=(1<<h)-1,g=p>>1,m=l===23?Math.pow(2,-24)-Math.pow(2,-77):0,y=s?0:c-1,v=s?1:-1,x=a<0||a===0&&1/a<0?1:0;for(a=Math.abs(a),isNaN(a)||a===1/0?(u=isNaN(a)?1:0,f=p):(f=Math.floor(Math.log(a)/Math.LN2),a*(d=Math.pow(2,-f))<1&&(f--,d*=2),(a+=f+g>=1?m/d:m*Math.pow(2,1-g))*d>=2&&(f++,d/=2),f+g>=p?(u=0,f=p):f+g>=1?(u=(a*d-1)*Math.pow(2,l),f+=g):(u=a*Math.pow(2,g-1)*Math.pow(2,l),f=0));l>=8;i[o+y]=255&u,y+=v,u/=256,l-=8);for(f=f<<l|u,h+=l;h>0;i[o+y]=255&f,y+=v,f/=256,h-=8);i[o+y-v]|=128*x}},function(n,r){var i={}.toString;n.exports=Array.isArray||function(a){return i.call(a)=="[object Array]"}},function(n,r,i){var a=this&&this.__values||function(l){var c=typeof Symbol=="function"&&Symbol.iterator,f=c&&l[c],u=0;if(f)return f.call(l);if(l&&typeof l.length=="number")return{next:function(){return l&&u>=l.length&&(l=void 0),{value:l&&l[u++],done:!l}}};throw new TypeError(c?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var o=i(1);function s(l){var c,f;if(l===null||o.isString(l)||o.isNumber(l))return l;if(o.isArray(l)){var u=new Array;try{for(var d=a(l),h=d.next();!h.done;h=d.next()){var p=h.value;u.push(s(p))}}catch(y){c={error:y}}finally{try{h&&!h.done&&(f=d.return)&&f.call(d)}finally{if(c)throw c.error}}return u}if(o.isObject(l)){u=new Map;for(var g in l)if(l.hasOwnProperty(g)){var m=l[g];u.set(g,s(m))}return u}return l}r.parseJSONFromBytes=function(l){var c=o.utf8Decode(l);return JSON.parse.call(void 0,c)},r.serializeJSONToBytes=function(l){var c=JSON.stringify.call(void 0,l);return o.utf8Encode(c)},r.parseJSONIntoInfraValues=function(l){return s(JSON.parse.call(void 0,l))},r.convertAJSONDerivedJavaScriptValueToAnInfraValue=s},function(n,r,i){var a=this&&this.__generator||function(f,u){var d,h,p,g,m={label:0,sent:function(){if(1&p[0])throw p[1];return p[1]},trys:[],ops:[]};return g={next:y(0),throw:y(1),return:y(2)},typeof Symbol=="function"&&(g[Symbol.iterator]=function(){return this}),g;function y(v){return function(x){return(function(w){if(d)throw new TypeError("Generator is already executing.");for(;m;)try{if(d=1,h&&(p=2&w[0]?h.return:w[0]?h.throw||((p=h.return)&&p.call(h),0):h.next)&&!(p=p.call(h,w[1])).done)return p;switch(h=0,p&&(w=[2&w[0],p.value]),w[0]){case 0:case 1:p=w;break;case 4:return m.label++,{value:w[1],done:!1};case 5:m.label++,h=w[1],w=[0];continue;case 7:w=m.ops.pop(),m.trys.pop();continue;default:if(p=m.trys,!((p=p.length>0&&p[p.length-1])||w[0]!==6&&w[0]!==2)){m=0;continue}if(w[0]===3&&(!p||w[1]>p[0]&&w[1]<p[3])){m.label=w[1];break}if(w[0]===6&&m.label<p[1]){m.label=p[1],p=w;break}if(p&&m.label<p[2]){m.label=p[2],m.ops.push(w);break}p[2]&&m.ops.pop(),m.trys.pop();continue}w=u.call(f,m)}catch(S){w=[6,S],h=0}finally{d=p=0}if(5&w[0])throw w[1];return{value:w[0]?w[1]:void 0,done:!0}})([v,x])}}},o=this&&this.__read||function(f,u){var d=typeof Symbol=="function"&&f[Symbol.iterator];if(!d)return f;var h,p,g=d.call(f),m=[];try{for(;(u===void 0||u-- >0)&&!(h=g.next()).done;)m.push(h.value)}catch(y){p={error:y}}finally{try{h&&!h.done&&(d=g.return)&&d.call(g)}finally{if(p)throw p.error}}return m},s=this&&this.__spread||function(){for(var f=[],u=0;u<arguments.length;u++)f=f.concat(o(arguments[u]));return f},l=this&&this.__values||function(f){var u=typeof Symbol=="function"&&Symbol.iterator,d=u&&f[u],h=0;if(d)return d.call(f);if(f&&typeof f.length=="number")return{next:function(){return f&&h>=f.length&&(f=void 0),{value:f&&f[h++],done:!f}}};throw new TypeError(u?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var c=i(1);r.append=function(f,u){f.push(u)},r.extend=function(f,u){f.push.apply(f,s(u))},r.prepend=function(f,u){f.unshift(u)},r.replace=function(f,u,d){var h,p,g=0;try{for(var m=l(f),y=m.next();!y.done;y=m.next()){var v=y.value;if(c.isFunction(u))u.call(null,v)&&(f[g]=d);else if(v===u)return void(f[g]=d);g++}}catch(x){h={error:x}}finally{try{y&&!y.done&&(p=m.return)&&p.call(m)}finally{if(h)throw h.error}}},r.insert=function(f,u,d){f.splice(d,0,u)},r.remove=function(f,u){for(var d=f.length;d--;){var h=f[d];if(c.isFunction(u))u.call(null,h)&&f.splice(d,1);else if(h===u)return void f.splice(d,1)}},r.empty=function(f){f.length=0},r.contains=function(f,u){var d,h;try{for(var p=l(f),g=p.next();!g.done;g=p.next()){var m=g.value;if(c.isFunction(u)){if(u.call(null,m))return!0}else if(m===u)return!0}}catch(y){d={error:y}}finally{try{g&&!g.done&&(h=p.return)&&h.call(p)}finally{if(d)throw d.error}}return!1},r.size=function(f,u){var d,h;if(u===void 0)return f.length;var p=0;try{for(var g=l(f),m=g.next();!m.done;m=g.next()){var y=m.value;u.call(null,y)&&p++}}catch(v){d={error:v}}finally{try{m&&!m.done&&(h=g.return)&&h.call(g)}finally{if(d)throw d.error}}return p},r.isEmpty=function(f){return f.length===0},r.forEach=function(f,u){var d,h,p,g,m,y;return a(this,(function(v){switch(v.label){case 0:return u!==void 0?[3,2]:[5,l(f)];case 1:return v.sent(),[3,9];case 2:v.trys.push([2,7,8,9]),d=l(f),h=d.next(),v.label=3;case 3:return h.done?[3,6]:(p=h.value,u.call(null,p)?[4,p]:[3,5]);case 4:v.sent(),v.label=5;case 5:return h=d.next(),[3,3];case 6:return[3,9];case 7:return g=v.sent(),m={error:g},[3,9];case 8:try{h&&!h.done&&(y=d.return)&&y.call(d)}finally{if(m)throw m.error}return[7];case 9:return[2]}}))},r.clone=function(f){return new(Array.bind.apply(Array,s([void 0],f)))},r.sortInAscendingOrder=function(f,u){return f.sort((function(d,h){return u.call(null,d,h)?-1:1}))},r.sortInDescendingOrder=function(f,u){return f.sort((function(d,h){return u.call(null,d,h)?1:-1}))}},function(n,r,i){var a=this&&this.__generator||function(f,u){var d,h,p,g,m={label:0,sent:function(){if(1&p[0])throw p[1];return p[1]},trys:[],ops:[]};return g={next:y(0),throw:y(1),return:y(2)},typeof Symbol=="function"&&(g[Symbol.iterator]=function(){return this}),g;function y(v){return function(x){return(function(w){if(d)throw new TypeError("Generator is already executing.");for(;m;)try{if(d=1,h&&(p=2&w[0]?h.return:w[0]?h.throw||((p=h.return)&&p.call(h),0):h.next)&&!(p=p.call(h,w[1])).done)return p;switch(h=0,p&&(w=[2&w[0],p.value]),w[0]){case 0:case 1:p=w;break;case 4:return m.label++,{value:w[1],done:!1};case 5:m.label++,h=w[1],w=[0];continue;case 7:w=m.ops.pop(),m.trys.pop();continue;default:if(p=m.trys,!((p=p.length>0&&p[p.length-1])||w[0]!==6&&w[0]!==2)){m=0;continue}if(w[0]===3&&(!p||w[1]>p[0]&&w[1]<p[3])){m.label=w[1];break}if(w[0]===6&&m.label<p[1]){m.label=p[1],p=w;break}if(p&&m.label<p[2]){m.label=p[2],m.ops.push(w);break}p[2]&&m.ops.pop(),m.trys.pop();continue}w=u.call(f,m)}catch(S){w=[6,S],h=0}finally{d=p=0}if(5&w[0])throw w[1];return{value:w[0]?w[1]:void 0,done:!0}})([v,x])}}},o=this&&this.__values||function(f){var u=typeof Symbol=="function"&&Symbol.iterator,d=u&&f[u],h=0;if(d)return d.call(f);if(f&&typeof f.length=="number")return{next:function(){return f&&h>=f.length&&(f=void 0),{value:f&&f[h++],done:!f}}};throw new TypeError(u?"Object is not iterable.":"Symbol.iterator is not defined.")},s=this&&this.__read||function(f,u){var d=typeof Symbol=="function"&&f[Symbol.iterator];if(!d)return f;var h,p,g=d.call(f),m=[];try{for(;(u===void 0||u-- >0)&&!(h=g.next()).done;)m.push(h.value)}catch(y){p={error:y}}finally{try{h&&!h.done&&(d=g.return)&&d.call(g)}finally{if(p)throw p.error}}return m},l=this&&this.__spread||function(){for(var f=[],u=0;u<arguments.length;u++)f=f.concat(s(arguments[u]));return f};Object.defineProperty(r,"__esModule",{value:!0});var c=i(1);r.get=function(f,u){return f.get(u)},r.set=function(f,u,d){f.set(u,d)},r.remove=function(f,u){var d,h,p,g;if(c.isFunction(u)){var m=[];try{for(var y=o(f),v=y.next();!v.done;v=y.next()){var x=v.value;u.call(null,x)&&m.push(x[0])}}catch(_){d={error:_}}finally{try{v&&!v.done&&(h=y.return)&&h.call(y)}finally{if(d)throw d.error}}try{for(var w=o(m),S=w.next();!S.done;S=w.next()){var T=S.value;f.delete(T)}}catch(_){p={error:_}}finally{try{S&&!S.done&&(g=w.return)&&g.call(w)}finally{if(p)throw p.error}}}else f.delete(u)},r.contains=function(f,u){var d,h;if(c.isFunction(u)){try{for(var p=o(f),g=p.next();!g.done;g=p.next()){var m=g.value;if(u.call(null,m))return!0}}catch(y){d={error:y}}finally{try{g&&!g.done&&(h=p.return)&&h.call(p)}finally{if(d)throw d.error}}return!1}return f.has(u)},r.keys=function(f){return new Set(f.keys())},r.values=function(f){return l(f.values())},r.size=function(f,u){var d,h;if(u===void 0)return f.size;var p=0;try{for(var g=o(f),m=g.next();!m.done;m=g.next()){var y=m.value;u.call(null,y)&&p++}}catch(v){d={error:v}}finally{try{m&&!m.done&&(h=g.return)&&h.call(g)}finally{if(d)throw d.error}}return p},r.isEmpty=function(f){return f.size===0},r.forEach=function(f,u){var d,h,p,g,m,y;return a(this,(function(v){switch(v.label){case 0:return u!==void 0?[3,2]:[5,o(f)];case 1:return v.sent(),[3,9];case 2:v.trys.push([2,7,8,9]),d=o(f),h=d.next(),v.label=3;case 3:return h.done?[3,6]:(p=h.value,u.call(null,p)?[4,p]:[3,5]);case 4:v.sent(),v.label=5;case 5:return h=d.next(),[3,3];case 6:return[3,9];case 7:return g=v.sent(),m={error:g},[3,9];case 8:try{h&&!h.done&&(y=d.return)&&y.call(d)}finally{if(m)throw m.error}return[7];case 9:return[2]}}))},r.clone=function(f){return new Map(f)},r.sortInAscendingOrder=function(f,u){var d=new(Array.bind.apply(Array,l([void 0],f)));return d.sort((function(h,p){return u.call(null,h,p)?-1:1})),new Map(d)},r.sortInDescendingOrder=function(f,u){var d=new(Array.bind.apply(Array,l([void 0],f)));return d.sort((function(h,p){return u.call(null,h,p)?1:-1})),new Map(d)}},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.HTML="http://www.w3.org/1999/xhtml",r.XML="http://www.w3.org/XML/1998/namespace",r.XMLNS="http://www.w3.org/2000/xmlns/",r.MathML="http://www.w3.org/1998/Math/MathML",r.SVG="http://www.w3.org/2000/svg",r.XLink="http://www.w3.org/1999/xlink"},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.enqueue=function(a,o){a.push(o)},r.dequeue=function(a){return a.shift()||null}},function(n,r,i){var a=this&&this.__generator||function(u,d){var h,p,g,m,y={label:0,sent:function(){if(1&g[0])throw g[1];return g[1]},trys:[],ops:[]};return m={next:v(0),throw:v(1),return:v(2)},typeof Symbol=="function"&&(m[Symbol.iterator]=function(){return this}),m;function v(x){return function(w){return(function(S){if(h)throw new TypeError("Generator is already executing.");for(;y;)try{if(h=1,p&&(g=2&S[0]?p.return:S[0]?p.throw||((g=p.return)&&g.call(p),0):p.next)&&!(g=g.call(p,S[1])).done)return g;switch(p=0,g&&(S=[2&S[0],g.value]),S[0]){case 0:case 1:g=S;break;case 4:return y.label++,{value:S[1],done:!1};case 5:y.label++,p=S[1],S=[0];continue;case 7:S=y.ops.pop(),y.trys.pop();continue;default:if(g=y.trys,!((g=g.length>0&&g[g.length-1])||S[0]!==6&&S[0]!==2)){y=0;continue}if(S[0]===3&&(!g||S[1]>g[0]&&S[1]<g[3])){y.label=S[1];break}if(S[0]===6&&y.label<g[1]){y.label=g[1],g=S;break}if(g&&y.label<g[2]){y.label=g[2],y.ops.push(S);break}g[2]&&y.ops.pop(),y.trys.pop();continue}S=d.call(u,y)}catch(T){S=[6,T],p=0}finally{h=g=0}if(5&S[0])throw S[1];return{value:S[0]?S[1]:void 0,done:!0}})([x,w])}}},o=this&&this.__values||function(u){var d=typeof Symbol=="function"&&Symbol.iterator,h=d&&u[d],p=0;if(h)return h.call(u);if(u&&typeof u.length=="number")return{next:function(){return u&&p>=u.length&&(u=void 0),{value:u&&u[p++],done:!u}}};throw new TypeError(d?"Object is not iterable.":"Symbol.iterator is not defined.")},s=this&&this.__read||function(u,d){var h=typeof Symbol=="function"&&u[Symbol.iterator];if(!h)return u;var p,g,m=h.call(u),y=[];try{for(;(d===void 0||d-- >0)&&!(p=m.next()).done;)y.push(p.value)}catch(v){g={error:v}}finally{try{p&&!p.done&&(h=m.return)&&h.call(m)}finally{if(g)throw g.error}}return y},l=this&&this.__spread||function(){for(var u=[],d=0;d<arguments.length;d++)u=u.concat(s(arguments[d]));return u};Object.defineProperty(r,"__esModule",{value:!0});var c=i(1);function f(u,d){var h,p;try{for(var g=o(u),m=g.next();!m.done;m=g.next()){var y=m.value;if(!d.has(y))return!1}}catch(v){h={error:v}}finally{try{m&&!m.done&&(p=g.return)&&p.call(g)}finally{if(h)throw h.error}}return!0}r.append=function(u,d){u.add(d)},r.extend=function(u,d){d.forEach(u.add,u)},r.prepend=function(u,d){var h=new Set(u);u.clear(),u.add(d),h.forEach(u.add,u)},r.replace=function(u,d,h){var p,g,m=new Set;try{for(var y=o(u),v=y.next();!v.done;v=y.next()){var x=v.value;c.isFunction(d)?d.call(null,x)?m.add(h):m.add(x):x===d?m.add(h):m.add(x)}}catch(w){p={error:w}}finally{try{v&&!v.done&&(g=y.return)&&g.call(y)}finally{if(p)throw p.error}}u.clear(),m.forEach(u.add,u)},r.insert=function(u,d,h){var p,g,m=new Set,y=0;try{for(var v=o(u),x=v.next();!x.done;x=v.next()){var w=x.value;y===h&&m.add(d),m.add(w),y++}}catch(S){p={error:S}}finally{try{x&&!x.done&&(g=v.return)&&g.call(v)}finally{if(p)throw p.error}}u.clear(),m.forEach(u.add,u)},r.remove=function(u,d){var h,p,g,m;if(c.isFunction(d)){var y=[];try{for(var v=o(u),x=v.next();!x.done;x=v.next()){var w=x.value;d.call(null,w)&&y.push(w)}}catch(D){h={error:D}}finally{try{x&&!x.done&&(p=v.return)&&p.call(v)}finally{if(h)throw h.error}}try{for(var S=o(y),T=S.next();!T.done;T=S.next()){var _=T.value;u.delete(_)}}catch(D){g={error:D}}finally{try{T&&!T.done&&(m=S.return)&&m.call(S)}finally{if(g)throw g.error}}}else u.delete(d)},r.empty=function(u){u.clear()},r.contains=function(u,d){var h,p;if(!c.isFunction(d))return u.has(d);try{for(var g=o(u),m=g.next();!m.done;m=g.next()){var y=m.value;if(d.call(null,y))return!0}}catch(v){h={error:v}}finally{try{m&&!m.done&&(p=g.return)&&p.call(g)}finally{if(h)throw h.error}}return!1},r.size=function(u,d){var h,p;if(d===void 0)return u.size;var g=0;try{for(var m=o(u),y=m.next();!y.done;y=m.next()){var v=y.value;d.call(null,v)&&g++}}catch(x){h={error:x}}finally{try{y&&!y.done&&(p=m.return)&&p.call(m)}finally{if(h)throw h.error}}return g},r.isEmpty=function(u){return u.size===0},r.forEach=function(u,d){var h,p,g,m,y,v;return a(this,(function(x){switch(x.label){case 0:return d!==void 0?[3,2]:[5,o(u)];case 1:return x.sent(),[3,9];case 2:x.trys.push([2,7,8,9]),h=o(u),p=h.next(),x.label=3;case 3:return p.done?[3,6]:(g=p.value,d.call(null,g)?[4,g]:[3,5]);case 4:x.sent(),x.label=5;case 5:return p=h.next(),[3,3];case 6:return[3,9];case 7:return m=x.sent(),y={error:m},[3,9];case 8:try{p&&!p.done&&(v=h.return)&&v.call(h)}finally{if(y)throw y.error}return[7];case 9:return[2]}}))},r.clone=function(u){return new Set(u)},r.sortInAscendingOrder=function(u,d){var h=new(Array.bind.apply(Array,l([void 0],u)));return h.sort((function(p,g){return d.call(null,p,g)?-1:1})),new Set(h)},r.sortInDescendingOrder=function(u,d){var h=new(Array.bind.apply(Array,l([void 0],u)));return h.sort((function(p,g){return d.call(null,p,g)?1:-1})),new Set(h)},r.isSubsetOf=f,r.isSupersetOf=function(u,d){return f(d,u)},r.intersection=function(u,d){var h,p,g=new Set;try{for(var m=o(u),y=m.next();!y.done;y=m.next()){var v=y.value;d.has(v)&&g.add(v)}}catch(x){h={error:x}}finally{try{y&&!y.done&&(p=m.return)&&p.call(m)}finally{if(h)throw h.error}}return g},r.union=function(u,d){var h=new Set(u);return d.forEach(h.add,h),h},r.range=function(u,d){for(var h=new Set,p=u;p<=d;p++)h.add(p);return h}},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.push=function(a,o){a.push(o)},r.pop=function(a){return a.pop()||null}},function(n,r,i){var a=this&&this.__values||function(y){var v=typeof Symbol=="function"&&Symbol.iterator,x=v&&y[v],w=0;if(x)return x.call(y);if(y&&typeof y.length=="number")return{next:function(){return y&&w>=y.length&&(y=void 0),{value:y&&y[w++],done:!y}}};throw new TypeError(v?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var o=i(96),s=i(147),l=i(146),c=i(1);function f(y,v){for(var x=0;;){var w=x<y.length?y.charCodeAt(x):null,S=x<v.length?v.charCodeAt(x):null;if(w===null)return!0;if(w!==S)return!1;x++}}function u(y){var v,x,w=Array.from(y),S=new Uint8Array(w.length),T=0;try{for(var _=a(y),D=_.next();!D.done;D=_.next()){var I=D.value.codePointAt(0);console.assert(I!==void 0&&I<=255,"isomorphicEncode requires string bytes to be less than or equal to 0x00FF."),I!==void 0&&I<=255&&(S[T++]=I)}}catch(R){v={error:R}}finally{try{D&&!D.done&&(x=_.return)&&x.call(_)}finally{if(v)throw v.error}}return S}function d(y){return/^[\u0000-\u007F]*$/.test(y)}function h(y){var v,x,w="";try{for(var S=a(y),T=S.next();!T.done;T=S.next()){var _=T.value,D=_.codePointAt(0);w+=D!==void 0&&D>=65&&D<=90?String.fromCodePoint(D+32):_}}catch(I){v={error:I}}finally{try{T&&!T.done&&(x=S.return)&&x.call(S)}finally{if(v)throw v.error}}return w}function p(y){return y.replace(/^[\t\n\f\r ]+/,"").replace(/[\t\n\f\r ]+$/,"")}function g(y,v,x){if(!c.isArray(v))return g(y,Array.from(v),x);for(var w="";x.position<v.length&&y.call(null,v[x.position]);)w+=v[x.position],x.position++;return w}function m(y,v){g((function(x){return o.ASCIIWhiteSpace.test(x)}),y,v)}r.isCodeUnitPrefix=f,r.isCodeUnitLessThan=function(y,v){if(f(v,y))return!1;if(f(y,v))return!0;for(var x=0;x<Math.min(y.length,v.length);x++){var w=y.charCodeAt(x),S=v.charCodeAt(x);if(w!==S)return w<S}return!1},r.isomorphicEncode=u,r.isASCIIString=d,r.asciiLowercase=h,r.asciiUppercase=function(y){var v,x,w="";try{for(var S=a(y),T=S.next();!T.done;T=S.next()){var _=T.value,D=_.codePointAt(0);w+=D!==void 0&&D>=97&&D<=122?String.fromCodePoint(D-32):_}}catch(I){v={error:I}}finally{try{T&&!T.done&&(x=S.return)&&x.call(S)}finally{if(v)throw v.error}}return w},r.asciiCaseInsensitiveMatch=function(y,v){return h(y)===h(v)},r.asciiEncode=function(y){return console.assert(d(y),"asciiEncode requires an ASCII string."),u(y)},r.asciiDecode=function(y){var v,x;try{for(var w=a(y),S=w.next();!S.done;S=w.next()){var T=S.value;console.assert(l.isASCIIByte(T),"asciiDecode requires an ASCII byte sequence.")}}catch(_){v={error:_}}finally{try{S&&!S.done&&(x=w.return)&&x.call(w)}finally{if(v)throw v.error}}return s.isomorphicDecode(y)},r.stripNewlines=function(y){return y.replace(/[\n\r]/g,"")},r.normalizeNewlines=function(y){return y.replace(/\r\n/g,`
`).replace(/\r/g,`
`)},r.stripLeadingAndTrailingASCIIWhitespace=p,r.stripAndCollapseASCIIWhitespace=function(y){return p(y.replace(/[\t\n\f\r ]{2,}/g," "))},r.collectASequenceOfCodePoints=g,r.skipASCIIWhitespace=m,r.strictlySplit=function y(v,x){if(!c.isArray(v))return y(Array.from(v),x);var w={position:0},S=[],T=g((function(_){return x!==_}),v,w);for(S.push(T);w.position<v.length;)console.assert(v[w.position]===x,"strictlySplit found no delimiter in input string."),w.position++,T=g((function(_){return x!==_}),v,w),S.push(T);return S},r.splitAStringOnASCIIWhitespace=function y(v){if(!c.isArray(v))return y(Array.from(v));var x={position:0},w=[];for(m(v,x);x.position<v.length;){var S=g((function(T){return!o.ASCIIWhiteSpace.test(T)}),v,x);w.push(S),m(v,x)}return w},r.splitAStringOnCommas=function y(v){if(!c.isArray(v))return y(Array.from(v));for(var x={position:0},w=[];x.position<v.length;){var S=g((function(T){return T!==","}),v,x);w.push(p(S)),x.position<v.length&&(console.assert(v[x.position]===",","splitAStringOnCommas found no delimiter in input string."),x.position++)}return w},r.concatenate=function(y,v){return v===void 0&&(v=""),y.length===0?"":y.join(v)}},function(n,r,i){var a=this&&this.__values||function(s){var l=typeof Symbol=="function"&&Symbol.iterator,c=l&&s[l],f=0;if(c)return c.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&f>=s.length&&(s=void 0),{value:s&&s[f++],done:!s}}};throw new TypeError(l?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var o=i(97);r.abort_add=function(s,l){l._abortedFlag||l._abortAlgorithms.add(s)},r.abort_remove=function(s,l){l._abortAlgorithms.delete(s)},r.abort_signalAbort=function(s){var l,c;if(!s._abortedFlag){s._abortedFlag=!0;try{for(var f=a(s._abortAlgorithms),u=f.next();!u.done;u=f.next())u.value.call(s)}catch(d){l={error:d}}finally{try{u&&!u.done&&(c=f.return)&&c.call(f)}finally{if(l)throw l.error}}s._abortAlgorithms.clear(),o.event_fireAnEvent("abort",s)}}},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(150),o=(function(){function s(){}return s.asNode=function(l){if(a.Guard.isNode(l))return l;throw new Error("Invalid object. Node expected.")},s})();r.Cast=o},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=(function(){function s(){}return Object.defineProperty(s.prototype,"size",{get:function(){return 0},enumerable:!0,configurable:!0}),s.prototype.add=function(l){throw new Error("Cannot add to an empty set.")},s.prototype.clear=function(){},s.prototype.delete=function(l){return!1},s.prototype.forEach=function(l,c){},s.prototype.has=function(l){return!1},s.prototype[Symbol.iterator]=function(){return new o},s.prototype.entries=function(){return new o},s.prototype.keys=function(){return new o},s.prototype.values=function(){return new o},Object.defineProperty(s.prototype,Symbol.toStringTag,{get:function(){return"EmptySet"},enumerable:!0,configurable:!0}),s})();r.EmptySet=a;var o=(function(){function s(){}return s.prototype[Symbol.iterator]=function(){return this},s.prototype.next=function(){return{done:!0,value:null}},s})()},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),(function(a){a[a.SchemeStart=0]="SchemeStart",a[a.Scheme=1]="Scheme",a[a.NoScheme=2]="NoScheme",a[a.SpecialRelativeOrAuthority=3]="SpecialRelativeOrAuthority",a[a.PathOrAuthority=4]="PathOrAuthority",a[a.Relative=5]="Relative",a[a.RelativeSlash=6]="RelativeSlash",a[a.SpecialAuthoritySlashes=7]="SpecialAuthoritySlashes",a[a.SpecialAuthorityIgnoreSlashes=8]="SpecialAuthorityIgnoreSlashes",a[a.Authority=9]="Authority",a[a.Host=10]="Host",a[a.Hostname=11]="Hostname",a[a.Port=12]="Port",a[a.File=13]="File",a[a.FileSlash=14]="FileSlash",a[a.FileHost=15]="FileHost",a[a.PathStart=16]="PathStart",a[a.Path=17]="Path",a[a.CannotBeABaseURLPath=18]="CannotBeABaseURLPath",a[a.Query=19]="Query",a[a.Fragment=20]="Fragment"})(r.ParserState||(r.ParserState={})),r.OpaqueOrigin=["","",null,null]},function(n,r,i){var a=i(245),o=i(247);function s(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}r.parse=S,r.resolve=function(T,_){return S(T,!1,!0).resolve(_)},r.resolveObject=function(T,_){return T?S(T,!1,!0).resolveObject(_):_},r.format=function(T){return o.isString(T)&&(T=S(T)),T instanceof s?T.format():s.prototype.format.call(T)},r.Url=s;var l=/^([a-z0-9.+-]+:)/i,c=/:[0-9]*$/,f=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,u=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r",`
`,"	"]),d=["'"].concat(u),h=["%","/","?",";","#"].concat(d),p=["/","?","#"],g=/^[+a-z0-9A-Z_-]{0,63}$/,m=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,y={javascript:!0,"javascript:":!0},v={javascript:!0,"javascript:":!0},x={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},w=i(248);function S(T,_,D){if(T&&o.isObject(T)&&T instanceof s)return T;var I=new s;return I.parse(T,_,D),I}s.prototype.parse=function(T,_,D){if(!o.isString(T))throw new TypeError("Parameter 'url' must be a string, not "+typeof T);var I=T.indexOf("?"),R=I!==-1&&I<T.indexOf("#")?"?":"#",M=T.split(R);M[0]=M[0].replace(/\\/g,"/");var A=T=M.join(R);if(A=A.trim(),!D&&T.split("#").length===1){var L=f.exec(A);if(L)return this.path=A,this.href=A,this.pathname=L[1],L[2]?(this.search=L[2],this.query=_?w.parse(this.search.substr(1)):this.search.substr(1)):_&&(this.search="",this.query={}),this}var P=l.exec(A);if(P){var B=(P=P[0]).toLowerCase();this.protocol=B,A=A.substr(P.length)}if(D||P||A.match(/^\/\/[^@\/]+@[^@\/]+/)){var U=A.substr(0,2)==="//";!U||P&&v[P]||(A=A.substr(2),this.slashes=!0)}if(!v[P]&&(U||P&&!x[P])){for(var G,F,$=-1,V=0;V<p.length;V++)(X=A.indexOf(p[V]))!==-1&&($===-1||X<$)&&($=X);for((F=$===-1?A.lastIndexOf("@"):A.lastIndexOf("@",$))!==-1&&(G=A.slice(0,F),A=A.slice(F+1),this.auth=decodeURIComponent(G)),$=-1,V=0;V<h.length;V++){var X;(X=A.indexOf(h[V]))!==-1&&($===-1||X<$)&&($=X)}$===-1&&($=A.length),this.host=A.slice(0,$),A=A.slice($),this.parseHost(),this.hostname=this.hostname||"";var Q=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!Q)for(var re=this.hostname.split(/\./),ye=(V=0,re.length);V<ye;V++){var me=re[V];if(me&&!me.match(g)){for(var Ce="",we=0,Ae=me.length;we<Ae;we++)me.charCodeAt(we)>127?Ce+="x":Ce+=me[we];if(!Ce.match(g)){var De=re.slice(0,V),q=re.slice(V+1),k=me.match(m);k&&(De.push(k[1]),q.unshift(k[2])),q.length&&(A="/"+q.join(".")+A),this.hostname=De.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),Q||(this.hostname=a.toASCII(this.hostname));var J=this.port?":"+this.port:"",Y=this.hostname||"";this.host=Y+J,this.href+=this.host,Q&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),A[0]!=="/"&&(A="/"+A))}if(!y[B])for(V=0,ye=d.length;V<ye;V++){var ie=d[V];if(A.indexOf(ie)!==-1){var ue=encodeURIComponent(ie);ue===ie&&(ue=escape(ie)),A=A.split(ie).join(ue)}}var fe=A.indexOf("#");fe!==-1&&(this.hash=A.substr(fe),A=A.slice(0,fe));var Se=A.indexOf("?");if(Se!==-1?(this.search=A.substr(Se),this.query=A.substr(Se+1),_&&(this.query=w.parse(this.query)),A=A.slice(0,Se)):_&&(this.search="",this.query={}),A&&(this.pathname=A),x[B]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){J=this.pathname||"";var Fe=this.search||"";this.path=J+Fe}return this.href=this.format(),this},s.prototype.format=function(){var T=this.auth||"";T&&(T=(T=encodeURIComponent(T)).replace(/%3A/i,":"),T+="@");var _=this.protocol||"",D=this.pathname||"",I=this.hash||"",R=!1,M="";this.host?R=T+this.host:this.hostname&&(R=T+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(R+=":"+this.port)),this.query&&o.isObject(this.query)&&Object.keys(this.query).length&&(M=w.stringify(this.query));var A=this.search||M&&"?"+M||"";return _&&_.substr(-1)!==":"&&(_+=":"),this.slashes||(!_||x[_])&&R!==!1?(R="//"+(R||""),D&&D.charAt(0)!=="/"&&(D="/"+D)):R||(R=""),I&&I.charAt(0)!=="#"&&(I="#"+I),A&&A.charAt(0)!=="?"&&(A="?"+A),_+R+(D=D.replace(/[?#]/g,(function(L){return encodeURIComponent(L)})))+(A=A.replace("#","%23"))+I},s.prototype.resolve=function(T){return this.resolveObject(S(T,!1,!0)).format()},s.prototype.resolveObject=function(T){if(o.isString(T)){var _=new s;_.parse(T,!1,!0),T=_}for(var D=new s,I=Object.keys(this),R=0;R<I.length;R++){var M=I[R];D[M]=this[M]}if(D.hash=T.hash,T.href==="")return D.href=D.format(),D;if(T.slashes&&!T.protocol){for(var A=Object.keys(T),L=0;L<A.length;L++){var P=A[L];P!=="protocol"&&(D[P]=T[P])}return x[D.protocol]&&D.hostname&&!D.pathname&&(D.path=D.pathname="/"),D.href=D.format(),D}if(T.protocol&&T.protocol!==D.protocol){if(!x[T.protocol]){for(var B=Object.keys(T),U=0;U<B.length;U++){var G=B[U];D[G]=T[G]}return D.href=D.format(),D}if(D.protocol=T.protocol,T.host||v[T.protocol])D.pathname=T.pathname;else{for(var F=(T.pathname||"").split("/");F.length&&!(T.host=F.shift()););T.host||(T.host=""),T.hostname||(T.hostname=""),F[0]!==""&&F.unshift(""),F.length<2&&F.unshift(""),D.pathname=F.join("/")}if(D.search=T.search,D.query=T.query,D.host=T.host||"",D.auth=T.auth,D.hostname=T.hostname||T.host,D.port=T.port,D.pathname||D.search){var $=D.pathname||"",V=D.search||"";D.path=$+V}return D.slashes=D.slashes||T.slashes,D.href=D.format(),D}var X=D.pathname&&D.pathname.charAt(0)==="/",Q=T.host||T.pathname&&T.pathname.charAt(0)==="/",re=Q||X||D.host&&T.pathname,ye=re,me=D.pathname&&D.pathname.split("/")||[],Ce=(F=T.pathname&&T.pathname.split("/")||[],D.protocol&&!x[D.protocol]);if(Ce&&(D.hostname="",D.port=null,D.host&&(me[0]===""?me[0]=D.host:me.unshift(D.host)),D.host="",T.protocol&&(T.hostname=null,T.port=null,T.host&&(F[0]===""?F[0]=T.host:F.unshift(T.host)),T.host=null),re=re&&(F[0]===""||me[0]==="")),Q)D.host=T.host||T.host===""?T.host:D.host,D.hostname=T.hostname||T.hostname===""?T.hostname:D.hostname,D.search=T.search,D.query=T.query,me=F;else if(F.length)me||(me=[]),me.pop(),me=me.concat(F),D.search=T.search,D.query=T.query;else if(!o.isNullOrUndefined(T.search))return Ce&&(D.hostname=D.host=me.shift(),(k=!!(D.host&&D.host.indexOf("@")>0)&&D.host.split("@"))&&(D.auth=k.shift(),D.host=D.hostname=k.shift())),D.search=T.search,D.query=T.query,o.isNull(D.pathname)&&o.isNull(D.search)||(D.path=(D.pathname?D.pathname:"")+(D.search?D.search:"")),D.href=D.format(),D;if(!me.length)return D.pathname=null,D.search?D.path="/"+D.search:D.path=null,D.href=D.format(),D;for(var we=me.slice(-1)[0],Ae=(D.host||T.host||me.length>1)&&(we==="."||we==="..")||we==="",De=0,q=me.length;q>=0;q--)(we=me[q])==="."?me.splice(q,1):we===".."?(me.splice(q,1),De++):De&&(me.splice(q,1),De--);if(!re&&!ye)for(;De--;De)me.unshift("..");!re||me[0]===""||me[0]&&me[0].charAt(0)==="/"||me.unshift(""),Ae&&me.join("/").substr(-1)!=="/"&&me.push("");var k,J=me[0]===""||me[0]&&me[0].charAt(0)==="/";return Ce&&(D.hostname=D.host=J?"":me.length?me.shift():"",(k=!!(D.host&&D.host.indexOf("@")>0)&&D.host.split("@"))&&(D.auth=k.shift(),D.host=D.hostname=k.shift())),(re=re||D.host&&me.length)&&!J&&me.unshift(""),me.length?D.pathname=me.join("/"):(D.pathname=null,D.path=null),o.isNull(D.pathname)&&o.isNull(D.search)||(D.path=(D.pathname?D.pathname:"")+(D.search?D.search:"")),D.auth=T.auth||D.auth,D.slashes=D.slashes||T.slashes,D.href=D.format(),D},s.prototype.parseHost=function(){var T=this.host,_=c.exec(T);_&&((_=_[0])!==":"&&(this.port=_.substr(1)),T=T.substr(0,T.length-_.length)),T&&(this.hostname=T)}},function(n,r,i){(function(a,o){var s;/*! https://mths.be/punycode v1.4.1 by @mathias */(function(l){r&&r.nodeType,a&&a.nodeType;var c=typeof o=="object"&&o;c.global!==c&&c.window!==c&&c.self;var f,u=2147483647,d=/^xn--/,h=/[^\x20-\x7E]/,p=/[\x2E\u3002\uFF0E\uFF61]/g,g={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},m=Math.floor,y=String.fromCharCode;function v(M){throw new RangeError(g[M])}function x(M,A){for(var L=M.length,P=[];L--;)P[L]=A(M[L]);return P}function w(M,A){var L=M.split("@"),P="";return L.length>1&&(P=L[0]+"@",M=L[1]),P+x((M=M.replace(p,".")).split("."),A).join(".")}function S(M){for(var A,L,P=[],B=0,U=M.length;B<U;)(A=M.charCodeAt(B++))>=55296&&A<=56319&&B<U?(64512&(L=M.charCodeAt(B++)))==56320?P.push(((1023&A)<<10)+(1023&L)+65536):(P.push(A),B--):P.push(A);return P}function T(M){return x(M,(function(A){var L="";return A>65535&&(L+=y((A-=65536)>>>10&1023|55296),A=56320|1023&A),L+=y(A)})).join("")}function _(M,A){return M+22+75*(M<26)-((A!=0)<<5)}function D(M,A,L){var P=0;for(M=L?m(M/700):M>>1,M+=m(M/A);M>455;P+=36)M=m(M/35);return m(P+36*M/(M+38))}function I(M){var A,L,P,B,U,G,F,$,V,X,Q,re=[],ye=M.length,me=0,Ce=128,we=72;for((L=M.lastIndexOf("-"))<0&&(L=0),P=0;P<L;++P)M.charCodeAt(P)>=128&&v("not-basic"),re.push(M.charCodeAt(P));for(B=L>0?L+1:0;B<ye;){for(U=me,G=1,F=36;B>=ye&&v("invalid-input"),(($=(Q=M.charCodeAt(B++))-48<10?Q-22:Q-65<26?Q-65:Q-97<26?Q-97:36)>=36||$>m((u-me)/G))&&v("overflow"),me+=$*G,!($<(V=F<=we?1:F>=we+26?26:F-we));F+=36)G>m(u/(X=36-V))&&v("overflow"),G*=X;we=D(me-U,A=re.length+1,U==0),m(me/A)>u-Ce&&v("overflow"),Ce+=m(me/A),me%=A,re.splice(me++,0,Ce)}return T(re)}function R(M){var A,L,P,B,U,G,F,$,V,X,Q,re,ye,me,Ce,we=[];for(re=(M=S(M)).length,A=128,L=0,U=72,G=0;G<re;++G)(Q=M[G])<128&&we.push(y(Q));for(P=B=we.length,B&&we.push("-");P<re;){for(F=u,G=0;G<re;++G)(Q=M[G])>=A&&Q<F&&(F=Q);for(F-A>m((u-L)/(ye=P+1))&&v("overflow"),L+=(F-A)*ye,A=F,G=0;G<re;++G)if((Q=M[G])<A&&++L>u&&v("overflow"),Q==A){for($=L,V=36;!($<(X=V<=U?1:V>=U+26?26:V-U));V+=36)Ce=$-X,me=36-X,we.push(y(_(X+Ce%me,0))),$=m(Ce/me);we.push(y(_($,0))),U=D(L,ye,P==B),L=0,++P}++L,++A}return we.join("")}f={version:"1.4.1",ucs2:{decode:S,encode:T},decode:I,encode:R,toASCII:function(M){return w(M,(function(A){return h.test(A)?"xn--"+R(A):A}))},toUnicode:function(M){return w(M,(function(A){return d.test(A)?I(A.slice(4).toLowerCase()):A}))}},(s=(function(){return f}).call(r,i,r,a))===void 0||(a.exports=s)})()}).call(this,i(246)(n),i(78))},function(n,r){n.exports=function(i){return i.webpackPolyfill||(i.deprecate=function(){},i.paths=[],i.children||(i.children=[]),Object.defineProperty(i,"loaded",{enumerable:!0,get:function(){return i.l}}),Object.defineProperty(i,"id",{enumerable:!0,get:function(){return i.i}}),i.webpackPolyfill=1),i}},function(n,r,i){n.exports={isString:function(a){return typeof a=="string"},isObject:function(a){return typeof a=="object"&&a!==null},isNull:function(a){return a===null},isNullOrUndefined:function(a){return a==null}}},function(n,r,i){r.decode=r.parse=i(249),r.encode=r.stringify=i(250)},function(n,r,i){function a(s,l){return Object.prototype.hasOwnProperty.call(s,l)}n.exports=function(s,l,c,f){l=l||"&",c=c||"=";var u={};if(typeof s!="string"||s.length===0)return u;var d=/\+/g;s=s.split(l);var h=1e3;f&&typeof f.maxKeys=="number"&&(h=f.maxKeys);var p=s.length;h>0&&p>h&&(p=h);for(var g=0;g<p;++g){var m,y,v,x,w=s[g].replace(d,"%20"),S=w.indexOf(c);S>=0?(m=w.substr(0,S),y=w.substr(S+1)):(m=w,y=""),v=decodeURIComponent(m),x=decodeURIComponent(y),a(u,v)?o(u[v])?u[v].push(x):u[v]=[u[v],x]:u[v]=x}return u};var o=Array.isArray||function(s){return Object.prototype.toString.call(s)==="[object Array]"}},function(n,r,i){var a=function(c){switch(typeof c){case"string":return c;case"boolean":return c?"true":"false";case"number":return isFinite(c)?c:"";default:return""}};n.exports=function(c,f,u,d){return f=f||"&",u=u||"=",c===null&&(c=void 0),typeof c=="object"?s(l(c),(function(h){var p=encodeURIComponent(a(h))+u;return o(c[h])?s(c[h],(function(g){return p+encodeURIComponent(a(g))})).join(f):p+encodeURIComponent(a(c[h]))})).join(f):d?encodeURIComponent(a(d))+u+encodeURIComponent(a(c)):""};var o=Array.isArray||function(c){return Object.prototype.toString.call(c)==="[object Array]"};function s(c,f){if(c.map)return c.map(f);for(var u=[],d=0;d<c.length;d++)u.push(f(c[d],d));return u}var l=Object.keys||function(c){var f=[];for(var u in c)Object.prototype.hasOwnProperty.call(c,u)&&f.push(u);return f}},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(52);r.attr_setAnExistingAttributeValue=function(o,s){o._element===null?o._value=s:a.element_change(o,o._element,s)}},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(108),o=i(30),s=i(52);r.tokenList_validationSteps=function(l,c){if(!o.dom_hasSupportedTokens(l._attribute._localName))throw new TypeError("There are no supported tokens defined for attribute name: '"+l._attribute._localName+"'.");return o.dom_getSupportedTokens(l._attribute._localName).has(c.toLowerCase())},r.tokenList_updateSteps=function(l){(l._element.hasAttribute(l._attribute._localName)||l._tokenSet.size!==0)&&s.element_setAnAttributeValue(l._element,l._attribute._localName,a.orderedSet_serialize(l._tokenSet))},r.tokenList_serializeSteps=function(l){return s.element_getAnAttributeValue(l._element,l._attribute._localName)}},function(n,r,i){var a=this&&this.__values||function(l){var c=typeof Symbol=="function"&&Symbol.iterator,f=c&&l[c],u=0;if(f)return f.call(l);if(l&&typeof l.length=="number")return{next:function(){return l&&u>=l.length&&(l=void 0),{value:l&&l[u++],done:!l}}};throw new TypeError(c?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var o=i(1);function s(l){return o.isBoolean(l)?l:l.capture||!1}r.eventTarget_flatten=s,r.eventTarget_flattenMore=function(l){var c=s(l),f=!1,u=!1;return o.isBoolean(l)||(f=l.once||!1,u=l.passive||!1),[c,u,f]},r.eventTarget_addEventListener=function(l,c){if(c.callback!==null){for(var f=0;f<l._eventListenerList.length;f++){var u=l._eventListenerList[f];if(u.type===c.type&&u.callback.handleEvent===c.callback.handleEvent&&u.capture===c.capture)return}l._eventListenerList.push(c)}},r.eventTarget_removeEventListener=function(l,c,f){c.removed=!0,l._eventListenerList.splice(f,1)},r.eventTarget_removeAllEventListeners=function(l){var c,f;try{for(var u=a(l._eventListenerList),d=u.next();!d.done;d=u.next())d.value.removed=!0}catch(h){c={error:h}}finally{try{d&&!d.done&&(f=u.return)&&f.call(u)}finally{if(c)throw c.error}}l._eventListenerList.length=0}},function(n,r,i){var a=this&&this.__values||function(l){var c=typeof Symbol=="function"&&Symbol.iterator,f=c&&l[c],u=0;if(f)return f.call(l);if(l&&typeof l.length=="number")return{next:function(){return l&&u>=l.length&&(l=void 0),{value:l&&l[u++],done:!l}}};throw new TypeError(c?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var o=i(1),s=i(29);r.parentNode_convertNodesIntoANode=function(l,c){for(var f,u,d=null,h=0;h<l.length;h++){var p=l[h];if(o.isString(p)){var g=s.create_text(c,p);l[h]=g}}if(l.length===1)d=l[0];else{var m=d=s.create_documentFragment(c);try{for(var y=a(l),v=y.next();!v.done;v=y.next())p=v.value,m.appendChild(p)}catch(x){f={error:x}}finally{try{v&&!v.done&&(u=y.return)&&u.call(y)}finally{if(f)throw f.error}}}return d}},function(n,r,i){var a=this&&this.__values||function(_){var D=typeof Symbol=="function"&&Symbol.iterator,I=D&&_[D],R=0;if(I)return I.call(_);if(_&&typeof _.length=="number")return{next:function(){return _&&R>=_.length&&(_=void 0),{value:_&&_[R++],done:!_}}};throw new TypeError(D?"Object is not iterable.":"Symbol.iterator is not defined.")},o=this&&this.__read||function(_,D){var I=typeof Symbol=="function"&&_[Symbol.iterator];if(!I)return _;var R,M,A=I.call(_),L=[];try{for(;(D===void 0||D-- >0)&&!(R=A.next()).done;)L.push(R.value)}catch(P){M={error:P}}finally{try{R&&!R.done&&(I=A.return)&&I.call(A)}finally{if(M)throw M.error}}return L},s=this&&this.__spread||function(){for(var _=[],D=0;D<arguments.length;D++)_=_.concat(o(arguments[D]));return _};Object.defineProperty(r,"__esModule",{value:!0});var l=i(2),c=i(9),f=i(3),u=i(29),d=i(17),h=i(175),p=i(107),g=i(176),m=i(37),y=i(177);function v(_){return _._startNode===_._endNode&&_._startOffset===_._endOffset}function x(_){return d.tree_rootNode(_._startNode)}function w(_,D){return d.tree_rootNode(_)===x(D)&&h.boundaryPoint_position([_,0],D._start)===l.BoundaryPosition.After&&h.boundaryPoint_position([_,d.tree_nodeLength(_)],D._end)===l.BoundaryPosition.Before}function S(_,D){var I=d.tree_isAncestorOf(D._startNode,_,!0),R=d.tree_isAncestorOf(D._endNode,_,!0);return I&&!R||!I&&R}function T(_){var D,I,R,M,A,L,P=u.create_documentFragment(_._startNode._nodeDocument);if(v(_))return P;var B=_._startNode,U=_._startOffset,G=_._endNode,F=_._endOffset;if(B===G&&f.Guard.isCharacterDataNode(B))return(Y=g.node_clone(B))._data=p.characterData_substringData(B,U,F-U),m.mutation_append(Y,P),p.characterData_replaceData(B,U,F-U,""),P;for(var $=B;!d.tree_isAncestorOf(G,$,!0);){if($._parent===null)throw new Error("Parent node  is null.");$=$._parent}var V=null;if(!d.tree_isAncestorOf(G,B,!0))try{for(var X=a($._children),Q=X.next();!Q.done;Q=X.next())if(S(Ce=Q.value,_)){V=Ce;break}}catch(Fe){D={error:Fe}}finally{try{Q&&!Q.done&&(I=X.return)&&I.call(X)}finally{if(D)throw D.error}}var re=null;if(!d.tree_isAncestorOf(B,G,!0))for(var ye=s($._children),me=ye.length-1;me>0;me--){var Ce;if(S(Ce=ye[me],_)){re=Ce;break}}var we,Ae,De=[];try{for(var q=a($._children),k=q.next();!k.done;k=q.next())if(w(Se=k.value,_)){if(f.Guard.isDocumentTypeNode(Se))throw new c.HierarchyRequestError;De.push(Se)}}catch(Fe){R={error:Fe}}finally{try{k&&!k.done&&(M=q.return)&&M.call(q)}finally{if(R)throw R.error}}if(d.tree_isAncestorOf(G,B,!0))we=B,Ae=U;else{for(var J=B;J._parent!==null&&!d.tree_isAncestorOf(G,J._parent);)J=J._parent;if(J._parent===null)throw new Error("Parent node is null.");we=J._parent,Ae=1+d.tree_index(J)}if(f.Guard.isCharacterDataNode(V))(Y=g.node_clone(B))._data=p.characterData_substringData(B,U,d.tree_nodeLength(B)-U),m.mutation_append(Y,P),p.characterData_replaceData(B,U,d.tree_nodeLength(B)-U,"");else if(V!==null){var Y=g.node_clone(V);m.mutation_append(Y,P);var ie=T(u.create_range([B,U],[V,d.tree_nodeLength(V)]));m.mutation_append(ie,Y)}try{for(var ue=a(De),fe=ue.next();!fe.done;fe=ue.next()){var Se=fe.value;m.mutation_append(Se,P)}}catch(Fe){A={error:Fe}}finally{try{fe&&!fe.done&&(L=ue.return)&&L.call(ue)}finally{if(A)throw A.error}}return f.Guard.isCharacterDataNode(re)?((Y=g.node_clone(G))._data=p.characterData_substringData(G,0,F),m.mutation_append(Y,P),p.characterData_replaceData(G,0,F,"")):re!==null&&(Y=g.node_clone(re),m.mutation_append(Y,P),ie=T(u.create_range([re,0],[G,F])),m.mutation_append(ie,Y)),_._start=[we,Ae],_._end=[we,Ae],P}r.range_collapsed=v,r.range_root=x,r.range_isContained=w,r.range_isPartiallyContained=S,r.range_setTheStart=function(_,D,I){if(f.Guard.isDocumentTypeNode(D))throw new c.InvalidNodeTypeError;if(I>d.tree_nodeLength(D))throw new c.IndexSizeError;var R=[D,I];x(_)===d.tree_rootNode(D)&&h.boundaryPoint_position(R,_._end)!==l.BoundaryPosition.After||(_._end=R),_._start=R},r.range_setTheEnd=function(_,D,I){if(f.Guard.isDocumentTypeNode(D))throw new c.InvalidNodeTypeError;if(I>d.tree_nodeLength(D))throw new c.IndexSizeError;var R=[D,I];x(_)===d.tree_rootNode(D)&&h.boundaryPoint_position(R,_._start)!==l.BoundaryPosition.Before||(_._start=R),_._end=R},r.range_select=function(_,D){var I=_._parent;if(I===null)throw new c.InvalidNodeTypeError;var R=d.tree_index(_);D._start=[I,R],D._end=[I,R+1]},r.range_extract=T,r.range_cloneTheContents=function _(D){var I,R,M,A,L,P,B=u.create_documentFragment(D._startNode._nodeDocument);if(v(D))return B;var U=D._startNode,G=D._startOffset,F=D._endNode,$=D._endOffset;U===F&&f.Guard.isCharacterDataNode(U)&&((k=g.node_clone(U))._data=p.characterData_substringData(U,G,$-G),m.mutation_append(k,B));for(var V=U;!d.tree_isAncestorOf(F,V,!0);){if(V._parent===null)throw new Error("Parent node  is null.");V=V._parent}var X=null;if(!d.tree_isAncestorOf(F,U,!0))try{for(var Q=a(V._children),re=Q.next();!re.done;re=Q.next())if(S(we=re.value,D)){X=we;break}}catch(fe){I={error:fe}}finally{try{re&&!re.done&&(R=Q.return)&&R.call(Q)}finally{if(I)throw I.error}}var ye=null;if(!d.tree_isAncestorOf(U,F,!0))for(var me=s(V._children),Ce=me.length-1;Ce>0;Ce--){var we;if(S(we=me[Ce],D)){ye=we;break}}var Ae=[];try{for(var De=a(V._children),q=De.next();!q.done;q=De.next())if(w(ue=q.value,D)){if(f.Guard.isDocumentTypeNode(ue))throw new c.HierarchyRequestError;Ae.push(ue)}}catch(fe){M={error:fe}}finally{try{q&&!q.done&&(A=De.return)&&A.call(De)}finally{if(M)throw M.error}}if(f.Guard.isCharacterDataNode(X))(k=g.node_clone(U))._data=p.characterData_substringData(U,G,d.tree_nodeLength(U)-G),m.mutation_append(k,B);else if(X!==null){var k=g.node_clone(X);m.mutation_append(k,B);var J=_(u.create_range([U,G],[X,d.tree_nodeLength(X)]));m.mutation_append(J,k)}try{for(var Y=a(Ae),ie=Y.next();!ie.done;ie=Y.next()){var ue=ie.value,k=g.node_clone(ue);m.mutation_append(k,B)}}catch(fe){L={error:fe}}finally{try{ie&&!ie.done&&(P=Y.return)&&P.call(Y)}finally{if(L)throw L.error}}return f.Guard.isCharacterDataNode(ye)?((k=g.node_clone(F))._data=p.characterData_substringData(F,0,$),m.mutation_append(k,B)):ye!==null&&(k=g.node_clone(ye),B.append(k),J=T(u.create_range([ye,0],[F,$])),m.mutation_append(J,k)),B},r.range_insert=function(_,D){var I,R;if(f.Guard.isProcessingInstructionNode(D._startNode)||f.Guard.isCommentNode(D._startNode)||f.Guard.isTextNode(D._startNode)&&D._startNode._parent===null||D._startNode===_)throw new c.HierarchyRequestError;var M,A=null;if(f.Guard.isTextNode(D._startNode))A=D._startNode;else{var L=0;try{for(var P=a(D._startNode._children),B=P.next();!B.done;B=P.next()){var U=B.value;if(L===D._startOffset){A=U;break}L++}}catch(F){I={error:F}}finally{try{B&&!B.done&&(R=P.return)&&R.call(P)}finally{if(I)throw I.error}}}if(A===null)M=D._startNode;else{if(A._parent===null)throw new Error("Parent node is null.");M=A._parent}m.mutation_ensurePreInsertionValidity(_,M,A),f.Guard.isTextNode(D._startNode)&&(A=y.text_split(D._startNode,D._startOffset)),_===A&&(A=_._nextSibling),_._parent!==null&&m.mutation_remove(_,_._parent);var G=A===null?d.tree_nodeLength(M):d.tree_index(A);f.Guard.isDocumentFragmentNode(_)?G+=d.tree_nodeLength(_):G++,m.mutation_preInsert(_,M,A),v(D)&&(D._end=[M,G])},r.range_getContainedNodes=function(_){var D;return(D={})[Symbol.iterator]=function(){var I=_.commonAncestorContainer,R=d.tree_getFirstDescendantNode(I);return{next:function(){for(;R&&!w(R,_);)R=d.tree_getNextDescendantNode(I,R);if(R===null)return{done:!0,value:null};var M={done:!1,value:R};return R=d.tree_getNextDescendantNode(I,R),M}}},D},r.range_getPartiallyContainedNodes=function(_){var D;return(D={})[Symbol.iterator]=function(){var I=_.commonAncestorContainer,R=d.tree_getFirstDescendantNode(I);return{next:function(){for(;R&&!S(R,_);)R=d.tree_getNextDescendantNode(I,R);if(R===null)return{done:!0,value:null};var M={done:!1,value:R};return R=d.tree_getNextDescendantNode(I,R),M}}},D}},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(9);r.selectors_scopeMatchASelectorsString=function(o,s){throw new a.NotSupportedError}},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(2),o=i(105);r.treeWalker_traverseChildren=function(s,l){for(var c=l?s._current._firstChild:s._current._lastChild;c!==null;){var f=o.traversal_filter(s,c);if(f===a.FilterResult.Accept)return s._current=c,c;if(f===a.FilterResult.Skip){var u=l?c._firstChild:c._lastChild;if(u!==null){c=u;continue}}for(;c!==null;){var d=l?c._nextSibling:c._previousSibling;if(d!==null){c=d;break}var h=c._parent;if(h===null||h===s._root||h===s._current)return null;c=h}}return null},r.treeWalker_traverseSiblings=function(s,l){var c=s._current;if(c===s._root)return null;for(;;){for(var f=l?c._nextSibling:c._previousSibling;f!==null;){c=f;var u=o.traversal_filter(s,c);if(u===a.FilterResult.Accept)return s._current=c,c;f=l?c._firstChild:c._lastChild,u!==a.FilterResult.Reject&&f!==null||(f=l?c._nextSibling:c._previousSibling)}if((c=c._parent)===null||c===s._root||o.traversal_filter(s,c)===a.FilterResult.Accept)return null}}},function(n,r,i){i(89),i(74);var a,o=this&&this.__extends||(a=function(d,h){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(p,g){p.__proto__=g}||function(p,g){for(var m in g)g.hasOwnProperty(m)&&(p[m]=g[m])})(d,h)},function(d,h){function p(){this.constructor=d}a(d,h),d.prototype=h===null?Object.create(h):(p.prototype=h.prototype,new p)});Object.defineProperty(r,"__esModule",{value:!0});var s=i(1),l=i(2),c=i(50),f=i(3),u=(function(d){function h(p,g){var m=d.call(this,p)||this;return m._indentation={},m._lengthToLastNewline=0,m._writerOptions=s.applyDefaults(g,{wellFormed:!1,headless:!1,prettyPrint:!1,indent:"  ",newline:`
`,offset:0,width:0,allowEmptyTags:!1,indentTextOnlyNodes:!1,spaceBeforeSlash:!1}),m}return o(h,d),h.prototype.serialize=function(p){return this._refs={suppressPretty:!1,emptyNode:!1,markup:""},p.nodeType!==l.NodeType.Document||this._writerOptions.headless||this.declaration(this._builderOptions.version,this._builderOptions.encoding,this._builderOptions.standalone),this.serializeNode(p,this._writerOptions.wellFormed),this._writerOptions.prettyPrint&&this._refs.markup.slice(-this._writerOptions.newline.length)===this._writerOptions.newline&&(this._refs.markup=this._refs.markup.slice(0,-this._writerOptions.newline.length)),this._refs.markup},h.prototype.declaration=function(p,g,m){this._beginLine(),this._refs.markup+='<?xml version="'+p+'"',g!==void 0&&(this._refs.markup+=' encoding="'+g+'"'),m!==void 0&&(this._refs.markup+=' standalone="'+(m?"yes":"no")+'"'),this._refs.markup+="?>",this._endLine()},h.prototype.docType=function(p,g,m){this._beginLine(),this._refs.markup+=g&&m?"<!DOCTYPE "+p+' PUBLIC "'+g+'" "'+m+'">':g?"<!DOCTYPE "+p+' PUBLIC "'+g+'">':m?"<!DOCTYPE "+p+' SYSTEM "'+m+'">':"<!DOCTYPE "+p+">",this._endLine()},h.prototype.openTagBegin=function(p){this._beginLine(),this._refs.markup+="<"+p},h.prototype.openTagEnd=function(p,g,m){if(this._refs.suppressPretty=!1,this._refs.emptyNode=!1,this._writerOptions.prettyPrint&&!g&&!m){for(var y=!0,v=!0,x=this.currentNode.firstChild,w=0,S=0;x;){if(f.Guard.isExclusiveTextNode(x))S++;else{if(!f.Guard.isCDATASectionNode(x)){y=!1,v=!1;break}w++}x.data!==""&&(v=!1),x=x.nextSibling}this._refs.suppressPretty=!this._writerOptions.indentTextOnlyNodes&&y&&(w<=1&&S===0||w===0),this._refs.emptyNode=v}(m||g||this._refs.emptyNode)&&this._writerOptions.allowEmptyTags?this._refs.markup+="></"+p+">":this._refs.markup+=m?" />":g||this._refs.emptyNode?this._writerOptions.spaceBeforeSlash?" />":"/>":">",this._endLine()},h.prototype.closeTag=function(p){this._refs.emptyNode||(this._beginLine(),this._refs.markup+="</"+p+">"),this._refs.suppressPretty=!1,this._refs.emptyNode=!1,this._endLine()},h.prototype.attribute=function(p,g){var m=p+'="'+g+'"';this._writerOptions.prettyPrint&&this._writerOptions.width>0&&this._refs.markup.length-this._lengthToLastNewline+1+m.length>this._writerOptions.width?(this._endLine(),this._beginLine(),this._refs.markup+=this._indent(1)+m):this._refs.markup+=" "+m},h.prototype.text=function(p){p!==""&&(this._beginLine(),this._refs.markup+=p,this._endLine())},h.prototype.cdata=function(p){p!==""&&(this._beginLine(),this._refs.markup+="<![CDATA["+p+"]]>",this._endLine())},h.prototype.comment=function(p){this._beginLine(),this._refs.markup+="<!--"+p+"-->",this._endLine()},h.prototype.instruction=function(p,g){this._beginLine(),this._refs.markup+="<?"+(g===""?p:p+" "+g)+"?>",this._endLine()},h.prototype._beginLine=function(){this._writerOptions.prettyPrint&&!this._refs.suppressPretty&&(this._refs.markup+=this._indent(this._writerOptions.offset+this.level))},h.prototype._endLine=function(){this._writerOptions.prettyPrint&&!this._refs.suppressPretty&&(this._refs.markup+=this._writerOptions.newline,this._lengthToLastNewline=this._refs.markup.length)},h.prototype._indent=function(p){if(p<=0)return"";if(this._indentation[p]!==void 0)return this._indentation[p];var g=this._writerOptions.indent.repeat(p);return this._indentation[p]=g,g},h})(c.BaseWriter);r.XMLWriter=u},function(n,r,i){var a=i(47),o=i(35);n.exports="".repeat||function(s){var l=String(o(this)),c="",f=a(s);if(f<0||f==1/0)throw RangeError("Wrong number of repetitions");for(;f>0;(f>>>=1)&&(l+=l))1&f&&(c+=l);return c}},function(n,r,i){i(31),i(32),i(33),i(19),i(178),i(20),i(22),i(23);var a,o=this&&this.__extends||(a=function(u,d){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,p){h.__proto__=p}||function(h,p){for(var g in p)p.hasOwnProperty(g)&&(h[g]=p[g])})(u,d)},function(u,d){function h(){this.constructor=u}a(u,d),u.prototype=d===null?Object.create(d):(h.prototype=d.prototype,new h)}),s=this&&this.__values||function(u){var d=typeof Symbol=="function"&&Symbol.iterator,h=d&&u[d],p=0;if(h)return h.call(u);if(u&&typeof u.length=="number")return{next:function(){return u&&p>=u.length&&(u=void 0),{value:u&&u[p++],done:!u}}};throw new TypeError(d?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var l=i(67),c=i(1),f=(function(u){function d(h,p){var g=u.call(this,h)||this;return g._writerOptions=c.applyDefaults(p,{wellFormed:!1,prettyPrint:!1,indent:"  ",newline:`
`,offset:0,group:!1,verbose:!1}),g}return o(d,u),d.prototype.serialize=function(h){var p=c.applyDefaults(this._writerOptions,{format:"object",wellFormed:!1}),g=new l.ObjectWriter(this._builderOptions,p).serialize(h);return this._beginLine(this._writerOptions,0)+this._convertObject(g,this._writerOptions)},d.prototype._convertObject=function(h,p,g){var m,y,v=this;g===void 0&&(g=0);var x="",w=this._isLeafNode(h);if(c.isArray(h)){x+="[";var S=h.length,T=0;try{for(var _=s(h),D=_.next();!D.done;D=_.next()){var I=D.value;x+=this._endLine(p,g+1)+this._beginLine(p,g+1)+this._convertObject(I,p,g+1),T<S-1&&(x+=","),T++}}catch(A){m={error:A}}finally{try{D&&!D.done&&(y=_.return)&&y.call(_)}finally{if(m)throw m.error}}x+=this._endLine(p,g)+this._beginLine(p,g),x+="]"}else if(c.isObject(h)){x+="{";var R=c.objectLength(h),M=0;c.forEachObject(h,(function(A,L){w&&p.prettyPrint?x+=" ":x+=v._endLine(p,g+1)+v._beginLine(p,g+1),x+=v._key(A),p.prettyPrint&&(x+=" "),x+=v._convertObject(L,p,g+1),M<R-1&&(x+=","),M++}),this),w&&p.prettyPrint?x+=" ":x+=this._endLine(p,g)+this._beginLine(p,g),x+="}"}else x+=this._val(h);return x},d.prototype._beginLine=function(h,p){if(!h.prettyPrint)return"";var g=h.offset+p+1;return g>0?new Array(g).join(h.indent):""},d.prototype._endLine=function(h,p){return h.prettyPrint?h.newline:""},d.prototype._key=function(h){return'"'+h+'":'},d.prototype._val=function(h){return JSON.stringify(h)},d.prototype._isLeafNode=function(h){return this._descendantCount(h)<=1},d.prototype._descendantCount=function(h,p){var g=this;return p===void 0&&(p=0),c.isArray(h)?c.forEachArray(h,(function(m){return p+=g._descendantCount(m,p)}),this):c.isObject(h)?c.forEachObject(h,(function(m,y){return p+=g._descendantCount(y,p)}),this):p++,p},d})(i(50).BaseWriter);r.JSONWriter=f},function(n,r,i){i(31),i(32),i(33),i(19),i(178),i(89),i(20),i(22),i(23);var a,o=this&&this.__extends||(a=function(u,d){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,p){h.__proto__=p}||function(h,p){for(var g in p)p.hasOwnProperty(g)&&(h[g]=p[g])})(u,d)},function(u,d){function h(){this.constructor=u}a(u,d),u.prototype=d===null?Object.create(d):(h.prototype=d.prototype,new h)}),s=this&&this.__values||function(u){var d=typeof Symbol=="function"&&Symbol.iterator,h=d&&u[d],p=0;if(h)return h.call(u);if(u&&typeof u.length=="number")return{next:function(){return u&&p>=u.length&&(u=void 0),{value:u&&u[p++],done:!u}}};throw new TypeError(d?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var l=i(67),c=i(1),f=(function(u){function d(h,p){var g=u.call(this,h)||this;if(g._writerOptions=c.applyDefaults(p,{wellFormed:!1,indent:"  ",newline:`
`,offset:0,group:!1,verbose:!1}),g._writerOptions.indent.length<2)throw new Error("YAML indententation string must be at least two characters long.");if(g._writerOptions.offset<0)throw new Error("YAML offset should be zero or a positive number.");return g}return o(d,u),d.prototype.serialize=function(h){var p=c.applyDefaults(this._writerOptions,{format:"object",wellFormed:!1}),g=new l.ObjectWriter(this._builderOptions,p).serialize(h),m=this._beginLine(this._writerOptions,0)+"---"+this._endLine(this._writerOptions)+this._convertObject(g,this._writerOptions,0);return m.slice(-this._writerOptions.newline.length)===this._writerOptions.newline&&(m=m.slice(0,-this._writerOptions.newline.length)),m},d.prototype._convertObject=function(h,p,g,m){var y,v,x=this;m===void 0&&(m=!1);var w="";if(c.isArray(h))try{for(var S=s(h),T=S.next();!T.done;T=S.next()){var _=T.value;w+=this._beginLine(p,g,!0),c.isObject(_)?c.isEmpty(_)?w+='""'+this._endLine(p):w+=this._convertObject(_,p,g,!0):w+=this._val(_)+this._endLine(p)}}catch(D){y={error:D}}finally{try{T&&!T.done&&(v=S.return)&&v.call(S)}finally{if(y)throw y.error}}else c.forEachObject(h,(function(D,I){m?(w+=x._key(D),m=!1):w+=x._beginLine(p,g)+x._key(D),c.isObject(I)?c.isEmpty(I)?w+=' ""'+x._endLine(p):w+=x._endLine(p)+x._convertObject(I,p,g+1):w+=" "+x._val(I)+x._endLine(p)}),this);return w},d.prototype._beginLine=function(h,p,g){g===void 0&&(g=!1);var m=h.offset+p+1,y=new Array(m).join(h.indent);return g?y.substr(0,y.length-2)+"-"+y.substr(-1,1):y},d.prototype._endLine=function(h){return h.newline},d.prototype._key=function(h){return'"'+h+'":'},d.prototype._val=function(h){return JSON.stringify(h)},d})(i(50).BaseWriter);r.YAMLWriter=f},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),i(110).dom.setFeatures(!0);var a=i(110);r.DOMImplementation=a.DOMImplementation;var o=i(271);r.DOMParser=o.DOMParser;var s=i(274);r.XMLSerializer=s.XMLSerializer},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(3),o=i(0),s=(function(){function l(){}return l.prototype.before=function(){for(var c=[],f=0;f<arguments.length;f++)c[f]=arguments[f];var u=a.Cast.asNode(this),d=u._parent;if(d!==null){for(var h=u._previousSibling,p=!0;p&&h;){p=!1;for(var g=0;g<c.length;g++){var m=c[g];if(m===h){h=h._previousSibling,p=!0;break}}}var y=o.parentNode_convertNodesIntoANode(c,u._nodeDocument);h=h===null?d._firstChild:h._nextSibling,o.mutation_preInsert(y,d,h)}},l.prototype.after=function(){for(var c=[],f=0;f<arguments.length;f++)c[f]=arguments[f];var u=a.Cast.asNode(this),d=u._parent;if(d){for(var h=u._nextSibling,p=!0;p&&h;){p=!1;for(var g=0;g<c.length;g++){var m=c[g];if(m===h){h=h._nextSibling,p=!0;break}}}var y=o.parentNode_convertNodesIntoANode(c,u._nodeDocument);o.mutation_preInsert(y,d,h)}},l.prototype.replaceWith=function(){for(var c=[],f=0;f<arguments.length;f++)c[f]=arguments[f];var u=a.Cast.asNode(this),d=u._parent;if(d){for(var h=u._nextSibling,p=!0;p&&h;){p=!1;for(var g=0;g<c.length;g++){var m=c[g];if(m===h){h=h._nextSibling,p=!0;break}}}var y=o.parentNode_convertNodesIntoANode(c,u._nodeDocument);u._parent===d?o.mutation_replace(u,y,d):o.mutation_preInsert(y,d,h)}},l.prototype.remove=function(){var c=a.Cast.asNode(this),f=c._parent;f&&o.mutation_remove(c,f)},l})();r.ChildNodeImpl=s},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=function(){};r.DocumentOrShadowRootImpl=a},function(n,r,i){var a=this&&this.__values||function(f){var u=typeof Symbol=="function"&&Symbol.iterator,d=u&&f[u],h=0;if(d)return d.call(f);if(f&&typeof f.length=="number")return{next:function(){return f&&h>=f.length&&(f=void 0),{value:f&&f[h++],done:!f}}};throw new TypeError(u?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var o=i(6),s=i(3),l=i(7),c=(function(){function f(u){this._nodeList=[],this._recordQueue=[],this._callback=u;var d=o.dom.window;l.set.append(d._mutationObservers,this)}return f.prototype.observe=function(u,d){var h,p;if((d=d||{childList:!1,subtree:!1}).attributeOldValue===void 0&&d.attributeFilter===void 0||d.attributes!==void 0||(d.attributes=!0),d.characterDataOldValue!==void 0&&d.characterData===void 0&&(d.characterData=!0),!d.childList&&!d.attributes&&!d.characterData)throw new TypeError;if(d.attributeOldValue&&!d.attributes)throw new TypeError;if(d.attributeFilter!==void 0&&!d.attributes)throw new TypeError;if(d.characterDataOldValue&&!d.characterData)throw new TypeError;var g=!1,m=d,y=function(S){var T,_;if(S.observer===v){g=!0;try{for(var D=(T=void 0,a(v._nodeList)),I=D.next();!I.done;I=D.next()){var R=I.value;l.list.remove(R._registeredObserverList,(function(M){return s.Guard.isTransientRegisteredObserver(M)&&M.source===S}))}}catch(M){T={error:M}}finally{try{I&&!I.done&&(_=D.return)&&_.call(D)}finally{if(T)throw T.error}}S.options=m}},v=this;try{for(var x=a(u._registeredObserverList),w=x.next();!w.done;w=x.next())y(w.value)}catch(S){h={error:S}}finally{try{w&&!w.done&&(p=x.return)&&p.call(x)}finally{if(h)throw h.error}}g||(u._registeredObserverList.push({observer:this,options:d}),this._nodeList.push(u))},f.prototype.disconnect=function(){var u,d,h=this;try{for(var p=a(this._nodeList),g=p.next();!g.done;g=p.next()){var m=g.value;l.list.remove(m._registeredObserverList,(function(y){return y.observer===h}))}}catch(y){u={error:y}}finally{try{g&&!g.done&&(d=p.return)&&d.call(p)}finally{if(u)throw u.error}}this._recordQueue=[]},f.prototype.takeRecords=function(){var u=this._recordQueue;return this._recordQueue=[],u},f})();r.MutationObserverImpl=c},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(3),o=(function(){function s(){}return Object.defineProperty(s.prototype,"previousElementSibling",{get:function(){for(var l=a.Cast.asNode(this)._previousSibling;l;){if(a.Guard.isElementNode(l))return l;l=l._previousSibling}return null},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"nextElementSibling",{get:function(){for(var l=a.Cast.asNode(this)._nextSibling;l;){if(a.Guard.isElementNode(l))return l;l=l._nextSibling}return null},enumerable:!0,configurable:!0}),s})();r.NonDocumentTypeChildNodeImpl=o},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(3),o=i(0),s=(function(){function l(){}return l.prototype.getElementById=function(c){for(var f=o.tree_getFirstDescendantNode(a.Cast.asNode(this),!1,!1,(function(u){return a.Guard.isElementNode(u)}));f!==null;){if(f._uniqueIdentifier===c)return f;f=o.tree_getNextDescendantNode(a.Cast.asNode(this),f,!1,!1,(function(u){return a.Guard.isElementNode(u)}))}return null},l})();r.NonElementParentNodeImpl=s},function(n,r,i){var a=this&&this.__values||function(c){var f=typeof Symbol=="function"&&Symbol.iterator,u=f&&c[f],d=0;if(u)return u.call(c);if(c&&typeof c.length=="number")return{next:function(){return c&&d>=c.length&&(c=void 0),{value:c&&c[d++],done:!c}}};throw new TypeError(f?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var o=i(3),s=i(0),l=(function(){function c(){}return Object.defineProperty(c.prototype,"children",{get:function(){return s.create_htmlCollection(o.Cast.asNode(this))},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"firstElementChild",{get:function(){for(var f=o.Cast.asNode(this)._firstChild;f;){if(o.Guard.isElementNode(f))return f;f=f._nextSibling}return null},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"lastElementChild",{get:function(){for(var f=o.Cast.asNode(this)._lastChild;f;){if(o.Guard.isElementNode(f))return f;f=f._previousSibling}return null},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"childElementCount",{get:function(){var f,u,d=0;try{for(var h=a(o.Cast.asNode(this)._children),p=h.next();!p.done;p=h.next()){var g=p.value;o.Guard.isElementNode(g)&&d++}}catch(m){f={error:m}}finally{try{p&&!p.done&&(u=h.return)&&u.call(h)}finally{if(f)throw f.error}}return d},enumerable:!0,configurable:!0}),c.prototype.prepend=function(){for(var f=[],u=0;u<arguments.length;u++)f[u]=arguments[u];var d=o.Cast.asNode(this),h=s.parentNode_convertNodesIntoANode(f,d._nodeDocument);s.mutation_preInsert(h,d,d._firstChild)},c.prototype.append=function(){for(var f=[],u=0;u<arguments.length;u++)f[u]=arguments[u];var d=o.Cast.asNode(this),h=s.parentNode_convertNodesIntoANode(f,d._nodeDocument);s.mutation_append(h,d)},c.prototype.querySelector=function(f){var u=o.Cast.asNode(this),d=s.selectors_scopeMatchASelectorsString(f,u);return d.length===0?null:d[0]},c.prototype.querySelectorAll=function(f){var u=o.Cast.asNode(this),d=s.selectors_scopeMatchASelectorsString(f,u);return s.create_nodeListStatic(u,d)},c})();r.ParentNodeImpl=l},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(0),o=(function(){function s(){}return Object.defineProperty(s.prototype,"_name",{get:function(){return this.__name||""},set:function(l){this.__name=l},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"_assignedSlot",{get:function(){return this.__assignedSlot||null},set:function(l){this.__assignedSlot=l},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"assignedSlot",{get:function(){return a.shadowTree_findASlot(this,!0)},enumerable:!0,configurable:!0}),s})();r.SlotableImpl=o},function(n,r,i){var a,o=this&&this.__extends||(a=function(u,d){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,p){h.__proto__=p}||function(h,p){for(var g in p)p.hasOwnProperty(g)&&(h[g]=p[g])})(u,d)},function(u,d){function h(){this.constructor=u}a(u,d),u.prototype=d===null?Object.create(d):(h.prototype=d.prototype,new h)});Object.defineProperty(r,"__esModule",{value:!0});var s=i(102),l=i(9),c=i(3),f=(function(u){function d(h){var p=u.call(this)||this;if(c.Guard.isDocumentTypeNode(h.startContainer)||c.Guard.isAttrNode(h.startContainer)||c.Guard.isDocumentTypeNode(h.endContainer)||c.Guard.isAttrNode(h.endContainer))throw new l.InvalidNodeTypeError;return p._start=[h.startContainer,h.startOffset],p._end=[h.endContainer,h.endOffset],p}return o(d,u),d})(s.AbstractRangeImpl);r.StaticRangeImpl=f},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(272);r.DOMParser=a.DOMParserImpl},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(0),o=i(273),s=(function(){function l(){}return l.prototype.parseFromString=function(c,f){if(f==="text/html")throw new Error("HTML parser not implemented.");try{return(u=new o.XMLParserImpl().parse(c))._contentType=f,u}catch(g){var u,d="http://www.mozilla.org/newlayout/xml/parsererror.xml",h=(u=a.create_xmlDocument()).createElementNS(d,"parsererror"),p=u.createElementNS(d,"error");return p.setAttribute("message",g.message),h.appendChild(p),u.appendChild(h),u}},l})();r.DOMParserImpl=s},function(n,r,i){var a=this&&this.__read||function(h,p){var g=typeof Symbol=="function"&&h[Symbol.iterator];if(!g)return h;var m,y,v=g.call(h),x=[];try{for(;(p===void 0||p-- >0)&&!(m=v.next()).done;)x.push(m.value)}catch(w){y={error:w}}finally{try{m&&!m.done&&(g=v.return)&&g.call(v)}finally{if(y)throw y.error}}return x},o=this&&this.__values||function(h){var p=typeof Symbol=="function"&&Symbol.iterator,g=p&&h[p],m=0;if(g)return g.call(h);if(h&&typeof h.length=="number")return{next:function(){return h&&m>=h.length&&(h=void 0),{value:h&&h[m++],done:!h}}};throw new TypeError(p?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var s=i(180),l=i(111),c=i(7),f=i(0),u=i(69),d=(function(){function h(){}return h.prototype.parse=function(p){for(var g,m,y,v,x=new s.XMLStringLexer(p,{skipWhitespaceOnlyText:!0}),w=f.create_document(),S=w,T=x.nextToken();T.type!==l.TokenType.EOF;){switch(T.type){case l.TokenType.Declaration:var _=T;if(_.version!=="1.0")throw new Error("Invalid xml version: "+_.version);break;case l.TokenType.DocType:var D=T;if(!f.xml_isPubidChar(D.pubId))throw new Error("DocType public identifier does not match PubidChar construct.");if(!f.xml_isLegalChar(D.sysId)||D.sysId.indexOf('"')!==-1&&D.sysId.indexOf("'")!==-1)throw new Error("DocType system identifier contains invalid characters.");S.appendChild(w.implementation.createDocumentType(D.name,D.pubId,D.sysId));break;case l.TokenType.CDATA:var I=T;if(!f.xml_isLegalChar(I.data)||I.data.indexOf("]]>")!==-1)throw new Error("CDATA contains invalid characters.");S.appendChild(w.createCDATASection(I.data));break;case l.TokenType.Comment:var R=T;if(!f.xml_isLegalChar(R.data)||R.data.indexOf("--")!==-1||R.data.endsWith("-"))throw new Error("Comment data contains invalid characters.");S.appendChild(w.createComment(R.data));break;case l.TokenType.PI:var M=T;if(M.target.indexOf(":")!==-1||/^xml$/i.test(M.target))throw new Error("Processing instruction target contains invalid characters.");if(!f.xml_isLegalChar(M.data)||M.data.indexOf("?>")!==-1)throw new Error("Processing instruction data contains invalid characters.");S.appendChild(w.createProcessingInstruction(M.target,M.data));break;case l.TokenType.Text:var A=T;if(!f.xml_isLegalChar(A.data))throw new Error("Text data contains invalid characters.");S.appendChild(w.createTextNode(this._decodeText(A.data)));break;case l.TokenType.Element:var L=T,P=a(f.namespace_extractQName(L.name),2),B=P[0],U=P[1];if(U.indexOf(":")!==-1||!f.xml_isName(U))throw new Error("Node local name contains invalid characters.");if(B==="xmlns")throw new Error("An element cannot have the 'xmlns' prefix.");var G=S.lookupNamespaceURI(B),F={};try{for(var $=(g=void 0,o(L.attributes)),V=$.next();!V.done;V=$.next()){var X=a(V.value,2),Q=X[0],re=X[1];if(Q==="xmlns")G=re;else{var ye=a(f.namespace_extractQName(Q),2),me=ye[0],Ce=ye[1];me==="xmlns"&&(Ce===B&&(G=re),F[Ce]=re)}}}catch(ie){g={error:ie}}finally{try{V&&!V.done&&(m=$.return)&&m.call($)}finally{if(g)throw g.error}}var we=G!==null?w.createElementNS(G,L.name):w.createElement(L.name);S.appendChild(we);var Ae=new u.LocalNameSet;try{for(var De=(y=void 0,o(L.attributes)),q=De.next();!q.done;q=De.next()){var k=a(q.value,2),J=(Q=k[0],re=k[1],a(f.namespace_extractQName(Q),2)),Y=(me=J[0],Ce=J[1],null);if(me==="xmlns"||me===null&&Ce==="xmlns"?Y=c.namespace.XMLNS:(Y=we.lookupNamespaceURI(me))!==null&&we.isDefaultNamespace(Y)?Y=null:Y===null&&me!==null&&(Y=F[me]||null),Ae.has(Y,Ce))throw new Error("Element contains duplicate attributes.");if(Ae.set(Y,Ce),Y===c.namespace.XMLNS&&re===c.namespace.XMLNS)throw new Error("XMLNS namespace is reserved.");if(Ce.indexOf(":")!==-1||!f.xml_isName(Ce))throw new Error("Attribute local name contains invalid characters.");if(me==="xmlns"&&re==="")throw new Error("Empty XML namespace is not allowed.");Y!==null?we.setAttributeNS(Y,Q,this._decodeAttributeValue(re)):we.setAttribute(Q,this._decodeAttributeValue(re))}}catch(ie){y={error:ie}}finally{try{q&&!q.done&&(v=De.return)&&v.call(De)}finally{if(y)throw y.error}}L.selfClosing||(S=we);break;case l.TokenType.ClosingTag:if(T.name!==S.nodeName)throw new Error("Closing tag name does not match opening tag name.");S._parent&&(S=S._parent)}T=x.nextToken()}return w},h.prototype._decodeText=function(p){return p==null?p:p.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")},h.prototype._decodeAttributeValue=function(p){return p==null?p:p.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")},h})();r.XMLParserImpl=d},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(275);r.XMLSerializer=a.XMLSerializerImpl},function(n,r,i){var a=this&&this.__values||function(h){var p=typeof Symbol=="function"&&Symbol.iterator,g=p&&h[p],m=0;if(g)return g.call(h);if(h&&typeof h.length=="number")return{next:function(){return h&&m>=h.length&&(h=void 0),{value:h&&h[m++],done:!h}}};throw new TypeError(p?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var o=i(2),s=i(69),l=i(95),c=i(9),f=i(7),u=i(0),d=(function(){function h(){}return h.prototype.serializeToString=function(p){return this._xmlSerialization(p,!1)},h.prototype._xmlSerialization=function(p,g){if(p._nodeDocument===void 0||p._nodeDocument._hasNamespaces){var m=new l.NamespacePrefixMap;m.set("xml",f.namespace.XML);try{return this._serializeNodeNS(p,null,m,{value:1},g)}catch{throw new c.InvalidStateError}}else try{return this._serializeNode(p,g)}catch{throw new c.InvalidStateError}},h.prototype._serializeNodeNS=function(p,g,m,y,v){switch(p.nodeType){case o.NodeType.Element:return this._serializeElementNS(p,g,m,y,v);case o.NodeType.Document:return this._serializeDocumentNS(p,g,m,y,v);case o.NodeType.Comment:return this._serializeComment(p,v);case o.NodeType.Text:return this._serializeText(p,v);case o.NodeType.DocumentFragment:return this._serializeDocumentFragmentNS(p,g,m,y,v);case o.NodeType.DocumentType:return this._serializeDocumentType(p,v);case o.NodeType.ProcessingInstruction:return this._serializeProcessingInstruction(p,v);case o.NodeType.CData:return this._serializeCData(p,v);default:throw new Error("Unknown node type: "+p.nodeType)}},h.prototype._serializeNode=function(p,g){switch(p.nodeType){case o.NodeType.Element:return this._serializeElement(p,g);case o.NodeType.Document:return this._serializeDocument(p,g);case o.NodeType.Comment:return this._serializeComment(p,g);case o.NodeType.Text:return this._serializeText(p,g);case o.NodeType.DocumentFragment:return this._serializeDocumentFragment(p,g);case o.NodeType.DocumentType:return this._serializeDocumentType(p,g);case o.NodeType.ProcessingInstruction:return this._serializeProcessingInstruction(p,g);case o.NodeType.CData:return this._serializeCData(p,g);default:throw new Error("Unknown node type: "+p.nodeType)}},h.prototype._serializeElementNS=function(p,g,m,y,v){var x,w;if(v&&(p.localName.indexOf(":")!==-1||!u.xml_isName(p.localName)))throw new Error("Node local name contains invalid characters (well-formed required).");var S="<",T="",_=!1,D=!1,I=m.copy(),R={},M=this._recordNamespaceInformation(p,I,R),A=g,L=p.namespaceURI;if(A===L)M!==null&&(D=!0),S+=T=L===f.namespace.XML?"xml:"+p.localName:p.localName;else{var P=p.prefix,B=null;if(P===null&&L===M||(B=I.get(P,L)),P==="xmlns"){if(v)throw new Error("An element cannot have the 'xmlns' prefix (well-formed required).");B=P}B!==null?(T=B+":"+p.localName,M!==null&&M!==f.namespace.XML&&(A=M||null),S+=T):P!==null?(P in R&&(P=this._generatePrefix(L,I,y)),I.set(P,L),S+=T+=P+":"+p.localName,S+=" xmlns:"+P+'="'+this._serializeAttributeValue(L,v)+'"',M!==null&&(A=M||null)):M===null||M!==null&&M!==L?(D=!0,A=L,S+=T+=p.localName,S+=' xmlns="'+this._serializeAttributeValue(L,v)+'"'):(A=L,S+=T+=p.localName)}S+=this._serializeAttributesNS(p,I,y,R,D,v);var U=L===f.namespace.HTML;if(U&&p.childNodes.length===0&&h._VoidElementNames.has(p.localName)?(S+=" /",_=!0):U||p.childNodes.length!==0||(S+="/",_=!0),S+=">",_)return S;if(!(U&&p.localName==="template"))try{for(var G=a(p._children||p.childNodes),F=G.next();!F.done;F=G.next()){var $=F.value;S+=this._serializeNodeNS($,A,I,y,v)}}catch(V){x={error:V}}finally{try{F&&!F.done&&(w=G.return)&&w.call(G)}finally{if(x)throw x.error}}return S+="</"+T+">"},h.prototype._serializeDocumentNS=function(p,g,m,y,v){var x,w;if(v&&p.documentElement===null)throw new Error("Missing document element (well-formed required).");var S="";try{for(var T=a(p._children||p.childNodes),_=T.next();!_.done;_=T.next()){var D=_.value;S+=this._serializeNodeNS(D,g,m,y,v)}}catch(I){x={error:I}}finally{try{_&&!_.done&&(w=T.return)&&w.call(T)}finally{if(x)throw x.error}}return S},h.prototype._serializeComment=function(p,g){if(g&&(!u.xml_isLegalChar(p.data)||p.data.indexOf("--")!==-1||p.data.endsWith("-")))throw new Error("Comment data contains invalid characters (well-formed required).");return"<!--"+p.data+"-->"},h.prototype._serializeText=function(p,g){if(g&&!u.xml_isLegalChar(p.data))throw new Error("Text data contains invalid characters (well-formed required).");for(var m="",y=0;y<p.data.length;y++){var v=p.data[y];m+=v==="&"?"&amp;":v==="<"?"&lt;":v===">"?"&gt;":v}return m},h.prototype._serializeDocumentFragmentNS=function(p,g,m,y,v){var x,w,S="";try{for(var T=a(p._children||p.childNodes),_=T.next();!_.done;_=T.next()){var D=_.value;S+=this._serializeNodeNS(D,g,m,y,v)}}catch(I){x={error:I}}finally{try{_&&!_.done&&(w=T.return)&&w.call(T)}finally{if(x)throw x.error}}return S},h.prototype._serializeDocumentType=function(p,g){if(g&&!u.xml_isPubidChar(p.publicId))throw new Error("DocType public identifier does not match PubidChar construct (well-formed required).");if(g&&(!u.xml_isLegalChar(p.systemId)||p.systemId.indexOf('"')!==-1&&p.systemId.indexOf("'")!==-1))throw new Error("DocType system identifier contains invalid characters (well-formed required).");return p.publicId&&p.systemId?"<!DOCTYPE "+p.name+' PUBLIC "'+p.publicId+'" "'+p.systemId+'">':p.publicId?"<!DOCTYPE "+p.name+' PUBLIC "'+p.publicId+'">':p.systemId?"<!DOCTYPE "+p.name+' SYSTEM "'+p.systemId+'">':"<!DOCTYPE "+p.name+">"},h.prototype._serializeProcessingInstruction=function(p,g){if(g&&(p.target.indexOf(":")!==-1||/^xml$/i.test(p.target)))throw new Error("Processing instruction target contains invalid characters (well-formed required).");if(g&&(!u.xml_isLegalChar(p.data)||p.data.indexOf("?>")!==-1))throw new Error("Processing instruction data contains invalid characters (well-formed required).");return"<?"+(p.data===""?p.target:p.target+" "+p.data)+"?>"},h.prototype._serializeCData=function(p,g){if(g&&p.data.indexOf("]]>")!==-1)throw new Error("CDATA contains invalid characters (well-formed required).");return"<![CDATA["+p.data+"]]>"},h.prototype._serializeAttributesNS=function(p,g,m,y,v,x){var w,S,T="",_=x?new s.LocalNameSet:void 0;try{for(var D=a(p.attributes),I=D.next();!I.done;I=D.next()){var R=I.value;if(v||x||R.namespaceURI!==null){if(x&&_&&_.has(R.namespaceURI,R.localName))throw new Error("Element contains duplicate attributes (well-formed required).");x&&_&&_.set(R.namespaceURI,R.localName);var M=R.namespaceURI,A=null;if(M!==null)if(A=g.get(R.prefix,M),M===f.namespace.XMLNS){if(R.value===f.namespace.XML||R.prefix===null&&v||R.prefix!==null&&(!(R.localName in y)||y[R.localName]!==R.value)&&g.has(R.localName,R.value))continue;if(x&&R.value===f.namespace.XMLNS)throw new Error("XMLNS namespace is reserved (well-formed required).");if(x&&R.value==="")throw new Error("Namespace prefix declarations cannot be used to undeclare a namespace (well-formed required).");R.prefix==="xmlns"&&(A="xmlns")}else A===null&&(T+=" xmlns:"+(A=R.prefix===null||g.hasPrefix(R.prefix)&&!g.has(R.prefix,M)?this._generatePrefix(M,g,m):R.prefix)+'="'+this._serializeAttributeValue(M,x)+'"');if(T+=" ",A!==null&&(T+=A+":"),x&&(R.localName.indexOf(":")!==-1||!u.xml_isName(R.localName)||R.localName==="xmlns"&&M===null))throw new Error("Attribute local name contains invalid characters (well-formed required).");T+=R.localName+'="'+this._serializeAttributeValue(R.value,x)+'"'}else T+=" "+R.localName+'="'+this._serializeAttributeValue(R.value,x)+'"'}}catch(L){w={error:L}}finally{try{I&&!I.done&&(S=D.return)&&S.call(D)}finally{if(w)throw w.error}}return T},h.prototype._recordNamespaceInformation=function(p,g,m){var y,v,x=null;try{for(var w=a(p.attributes),S=w.next();!S.done;S=w.next()){var T=S.value,_=T.namespaceURI,D=T.prefix;if(_===f.namespace.XMLNS){if(D===null){x=T.value;continue}var I=T.localName,R=T.value;if(R===f.namespace.XML||(R===""&&(R=null),g.has(I,R)))continue;g.set(I,R),m[I]=R||""}}}catch(M){y={error:M}}finally{try{S&&!S.done&&(v=w.return)&&v.call(w)}finally{if(y)throw y.error}}return x},h.prototype._generatePrefix=function(p,g,m){var y="ns"+m.value;return m.value++,g.set(y,p),y},h.prototype._serializeAttributeValue=function(p,g){if(g&&p!==null&&!u.xml_isLegalChar(p))throw new Error("Invalid characters in attribute value.");if(p===null)return"";for(var m="",y=0;y<p.length;y++){var v=p[y];m+=v==='"'?"&quot;":v==="&"?"&amp;":v==="<"?"&lt;":v===">"?"&gt;":v}return m},h.prototype._serializeElement=function(p,g){var m,y;if(g&&(p.localName.indexOf(":")!==-1||!u.xml_isName(p.localName)))throw new Error("Node local name contains invalid characters (well-formed required).");var v=!1,x=p.localName,w="<"+x;if(w+=this._serializeAttributes(p,g),p._children.size===0&&(w+="/",v=!0),w+=">",v)return w;try{for(var S=a(p._children),T=S.next();!T.done;T=S.next()){var _=T.value;w+=this._serializeNode(_,g)}}catch(D){m={error:D}}finally{try{T&&!T.done&&(y=S.return)&&y.call(S)}finally{if(m)throw m.error}}return w+="</"+x+">"},h.prototype._serializeDocument=function(p,g){var m,y;if(g&&p.documentElement===null)throw new Error("Missing document element (well-formed required).");var v="";try{for(var x=a(p._children),w=x.next();!w.done;w=x.next()){var S=w.value;v+=this._serializeNode(S,g)}}catch(T){m={error:T}}finally{try{w&&!w.done&&(y=x.return)&&y.call(x)}finally{if(m)throw m.error}}return v},h.prototype._serializeDocumentFragment=function(p,g){var m,y,v="";try{for(var x=a(p._children),w=x.next();!w.done;w=x.next()){var S=w.value;v+=this._serializeNode(S,g)}}catch(T){m={error:T}}finally{try{w&&!w.done&&(y=x.return)&&y.call(x)}finally{if(m)throw m.error}}return v},h.prototype._serializeAttributes=function(p,g){var m,y,v="",x=g?{}:void 0;try{for(var w=a(p.attributes),S=w.next();!S.done;S=w.next()){var T=S.value;if(g&&x&&T.localName in x)throw new Error("Element contains duplicate attributes (well-formed required).");if(g&&x&&(x[T.localName]=!0),g&&(T.localName.indexOf(":")!==-1||!u.xml_isName(T.localName)))throw new Error("Attribute local name contains invalid characters (well-formed required).");v+=" "+T.localName+'="'+this._serializeAttributeValue(T.value,g)+'"'}}catch(_){m={error:_}}finally{try{S&&!S.done&&(y=w.return)&&y.call(w)}finally{if(m)throw m.error}}return v},h._VoidElementNames=new Set(["area","base","basefont","bgsound","br","col","embed","frame","hr","img","input","keygen","link","menuitem","meta","param","source","track","wbr"]),h})();r.XMLSerializerImpl=d},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(277);r.XMLReader=a.XMLReader;var o=i(112);r.ObjectReader=o.ObjectReader;var s=i(280);r.JSONReader=s.JSONReader;var l=i(281);r.YAMLReader=l.YAMLReader},function(n,r,i){i(31),i(32),i(33),i(19),i(65),i(20),i(22),i(23);var a,o=this&&this.__extends||(a=function(p,g){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,y){m.__proto__=y}||function(m,y){for(var v in y)y.hasOwnProperty(v)&&(m[v]=y[v])})(p,g)},function(p,g){function m(){this.constructor=p}a(p,g),p.prototype=g===null?Object.create(g):(m.prototype=g.prototype,new m)}),s=this&&this.__read||function(p,g){var m=typeof Symbol=="function"&&p[Symbol.iterator];if(!m)return p;var y,v,x=m.call(p),w=[];try{for(;(g===void 0||g-- >0)&&!(y=x.next()).done;)w.push(y.value)}catch(S){v={error:S}}finally{try{y&&!y.done&&(m=x.return)&&m.call(x)}finally{if(v)throw v.error}}return w},l=this&&this.__values||function(p){var g=typeof Symbol=="function"&&Symbol.iterator,m=g&&p[g],y=0;if(m)return m.call(p);if(p&&typeof p.length=="number")return{next:function(){return p&&y>=p.length&&(p=void 0),{value:p&&p[y++],done:!p}}};throw new TypeError(g?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var c=i(180),f=i(111),u=i(7),d=i(0),h=(function(p){function g(){return p!==null&&p.apply(this,arguments)||this}return o(g,p),g.prototype._parse=function(m,y){for(var v,x,w,S,T=new c.XMLStringLexer(y,{skipWhitespaceOnlyText:!0}),_=m,D=m,I=T.nextToken();I.type!==f.TokenType.EOF;){switch(I.type){case f.TokenType.Declaration:var R=I,M=this.sanitize(R.version);if(M!=="1.0")throw new Error("Invalid xml version: "+M);var A={version:M};R.encoding&&(A.encoding=this.sanitize(R.encoding)),R.standalone&&(A.standalone=this.sanitize(R.standalone)==="yes"),D.set(A);break;case f.TokenType.DocType:var L=I;D=this.docType(D,this.sanitize(L.name),this.sanitize(L.pubId),this.sanitize(L.sysId))||D;break;case f.TokenType.CDATA:var P=I;D=this.cdata(D,this.sanitize(P.data))||D;break;case f.TokenType.Comment:var B=I;D=this.comment(D,this.sanitize(B.data))||D;break;case f.TokenType.PI:var U=I;D=this.instruction(D,this.sanitize(U.target),this.sanitize(U.data))||D;break;case f.TokenType.Text:var G=I;D=this.text(D,this._decodeText(this.sanitize(G.data)))||D;break;case f.TokenType.Element:var F=I,$=this.sanitize(F.name),V=s(d.namespace_extractQName($),1)[0],X=D.node.lookupNamespaceURI(V),Q={};try{for(var re=(v=void 0,l(F.attributes)),ye=re.next();!ye.done;ye=re.next()){var me=s(ye.value,2),Ce=me[0],we=me[1];if(Ce=this.sanitize(Ce),we=this.sanitize(we),Ce==="xmlns")X=we;else{var Ae=s(d.namespace_extractQName(Ce),2),De=Ae[0],q=Ae[1];De==="xmlns"&&(q===V&&(X=we),Q[q]=we)}}}catch(Se){v={error:Se}}finally{try{ye&&!ye.done&&(x=re.return)&&x.call(re)}finally{if(v)throw v.error}}var k=X!==null?this.element(D,X,$):this.element(D,void 0,$);if(k===void 0)break;D.node===m.node&&(_=k);try{for(var J=(w=void 0,l(F.attributes)),Y=J.next();!Y.done;Y=J.next()){var ie=s(Y.value,2);Ce=ie[0],we=ie[1],Ce=this.sanitize(Ce),we=this.sanitize(we);var ue=s(d.namespace_extractQName(Ce),2),fe=(De=ue[0],q=ue[1],null);De==="xmlns"||De===null&&q==="xmlns"?fe=u.namespace.XMLNS:(fe=k.node.lookupNamespaceURI(De))!==null&&k.node.isDefaultNamespace(fe)?fe=null:fe===null&&De!==null&&(fe=Q[De]||null),fe!==null?this.attribute(k,fe,Ce,this._decodeAttributeValue(we)):this.attribute(k,void 0,Ce,this._decodeAttributeValue(we))}}catch(Se){w={error:Se}}finally{try{Y&&!Y.done&&(S=J.return)&&S.call(J)}finally{if(w)throw w.error}}F.selfClosing||(D=k);break;case f.TokenType.ClosingTag:D.node.parentNode&&(D=D.up())}I=T.nextToken()}return _},g})(i(75).BaseReader);r.XMLReader=h},function(n,r,i){var a=i(4),o=i(279);a({target:"Object",stat:!0,forced:Object.assign!==o},{assign:o})},function(n,r,i){var a=i(16),o=i(8),s=i(61),l=i(85),c=i(79),f=i(27),u=i(41),d=Object.assign,h=Object.defineProperty;n.exports=!d||o((function(){if(a&&d({b:1},d(h({},"a",{enumerable:!0,get:function(){h(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var p={},g={},m=Symbol();return p[m]=7,"abcdefghijklmnopqrst".split("").forEach((function(y){g[y]=y})),d({},p)[m]!=7||s(d({},g)).join("")!="abcdefghijklmnopqrst"}))?function(p,g){for(var m=f(p),y=arguments.length,v=1,x=l.f,w=c.f;y>v;)for(var S,T=u(arguments[v++]),_=x?s(T).concat(x(T)):s(T),D=_.length,I=0;D>I;)S=_[I++],a&&!w.call(T,S)||(m[S]=T[S]);return m}:d},function(n,r,i){var a,o=this&&this.__extends||(a=function(c,f){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,d){u.__proto__=d}||function(u,d){for(var h in d)d.hasOwnProperty(h)&&(u[h]=d[h])})(c,f)},function(c,f){function u(){this.constructor=c}a(c,f),c.prototype=f===null?Object.create(f):(u.prototype=f.prototype,new u)});Object.defineProperty(r,"__esModule",{value:!0});var s=i(112),l=(function(c){function f(){return c!==null&&c.apply(this,arguments)||this}return o(f,c),f.prototype._parse=function(u,d){return new s.ObjectReader(this._builderOptions).parse(u,JSON.parse(d))},f})(i(75).BaseReader);r.JSONReader=l},function(n,r,i){var a,o=this&&this.__extends||(a=function(u,d){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,p){h.__proto__=p}||function(h,p){for(var g in p)p.hasOwnProperty(g)&&(h[g]=p[g])})(u,d)},function(u,d){function h(){this.constructor=u}a(u,d),u.prototype=d===null?Object.create(d):(h.prototype=d.prototype,new h)});Object.defineProperty(r,"__esModule",{value:!0});var s=i(112),l=i(75),c=i(282),f=(function(u){function d(){return u!==null&&u.apply(this,arguments)||this}return o(d,u),d.prototype._parse=function(h,p){var g=c.safeLoad(p);if(g===void 0)throw new Error("Unable to parse YAML document.");return new s.ObjectReader(this._builderOptions).parse(h,g)},d})(l.BaseReader);r.YAMLReader=f},function(n,r,i){var a=i(283);n.exports=a},function(n,r,i){var a=i(284),o=i(303);function s(l){return function(){throw new Error("Function "+l+" is deprecated and cannot be used.")}}n.exports.Type=i(10),n.exports.Schema=i(39),n.exports.FAILSAFE_SCHEMA=i(113),n.exports.JSON_SCHEMA=i(182),n.exports.CORE_SCHEMA=i(181),n.exports.DEFAULT_SAFE_SCHEMA=i(54),n.exports.DEFAULT_FULL_SCHEMA=i(76),n.exports.load=a.load,n.exports.loadAll=a.loadAll,n.exports.safeLoad=a.safeLoad,n.exports.safeLoadAll=a.safeLoadAll,n.exports.dump=o.dump,n.exports.safeDump=o.safeDump,n.exports.YAMLException=i(53),n.exports.MINIMAL_SCHEMA=i(113),n.exports.SAFE_SCHEMA=i(54),n.exports.DEFAULT_SCHEMA=i(76),n.exports.scan=s("scan"),n.exports.parse=s("parse"),n.exports.compose=s("compose"),n.exports.addConstructor=s("addConstructor")},function(n,r,i){var a=i(38),o=i(53),s=i(285),l=i(54),c=i(76),f=Object.prototype.hasOwnProperty,u=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,d=/[\x85\u2028\u2029]/,h=/[,\[\]\{\}]/,p=/^(?:!|!!|![a-z\-]+!)$/i,g=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function m(k){return Object.prototype.toString.call(k)}function y(k){return k===10||k===13}function v(k){return k===9||k===32}function x(k){return k===9||k===32||k===10||k===13}function w(k){return k===44||k===91||k===93||k===123||k===125}function S(k){var J;return 48<=k&&k<=57?k-48:97<=(J=32|k)&&J<=102?J-97+10:-1}function T(k){return k===48?"\0":k===97?"\x07":k===98?"\b":k===116||k===9?"	":k===110?`
`:k===118?"\v":k===102?"\f":k===114?"\r":k===101?"\x1B":k===32?" ":k===34?'"':k===47?"/":k===92?"\\":k===78?"":k===95?" ":k===76?"\u2028":k===80?"\u2029":""}function _(k){return k<=65535?String.fromCharCode(k):String.fromCharCode(55296+(k-65536>>10),56320+(k-65536&1023))}for(var D=new Array(256),I=new Array(256),R=0;R<256;R++)D[R]=T(R)?1:0,I[R]=T(R);function M(k,J){this.input=k,this.filename=J.filename||null,this.schema=J.schema||c,this.onWarning=J.onWarning||null,this.legacy=J.legacy||!1,this.json=J.json||!1,this.listener=J.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=k.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.documents=[]}function A(k,J){return new o(J,new s(k.filename,k.input,k.position,k.line,k.position-k.lineStart))}function L(k,J){throw A(k,J)}function P(k,J){k.onWarning&&k.onWarning.call(null,A(k,J))}var B={YAML:function(k,J,Y){var ie,ue,fe;k.version!==null&&L(k,"duplication of %YAML directive"),Y.length!==1&&L(k,"YAML directive accepts exactly one argument"),(ie=/^([0-9]+)\.([0-9]+)$/.exec(Y[0]))===null&&L(k,"ill-formed argument of the YAML directive"),ue=parseInt(ie[1],10),fe=parseInt(ie[2],10),ue!==1&&L(k,"unacceptable YAML version of the document"),k.version=Y[0],k.checkLineBreaks=fe<2,fe!==1&&fe!==2&&P(k,"unsupported YAML version of the document")},TAG:function(k,J,Y){var ie,ue;Y.length!==2&&L(k,"TAG directive accepts exactly two arguments"),ie=Y[0],ue=Y[1],p.test(ie)||L(k,"ill-formed tag handle (first argument) of the TAG directive"),f.call(k.tagMap,ie)&&L(k,'there is a previously declared suffix for "'+ie+'" tag handle'),g.test(ue)||L(k,"ill-formed tag prefix (second argument) of the TAG directive"),k.tagMap[ie]=ue}};function U(k,J,Y,ie){var ue,fe,Se,Fe;if(J<Y){if(Fe=k.input.slice(J,Y),ie)for(ue=0,fe=Fe.length;ue<fe;ue+=1)(Se=Fe.charCodeAt(ue))===9||32<=Se&&Se<=1114111||L(k,"expected valid JSON character");else u.test(Fe)&&L(k,"the stream contains non-printable characters");k.result+=Fe}}function G(k,J,Y,ie){var ue,fe,Se,Fe;for(a.isObject(Y)||L(k,"cannot merge mappings; the provided source object is unacceptable"),Se=0,Fe=(ue=Object.keys(Y)).length;Se<Fe;Se+=1)fe=ue[Se],f.call(J,fe)||(J[fe]=Y[fe],ie[fe]=!0)}function F(k,J,Y,ie,ue,fe,Se,Fe){var Ke,He;if(Array.isArray(ue))for(Ke=0,He=(ue=Array.prototype.slice.call(ue)).length;Ke<He;Ke+=1)Array.isArray(ue[Ke])&&L(k,"nested arrays are not supported inside keys"),typeof ue=="object"&&m(ue[Ke])==="[object Object]"&&(ue[Ke]="[object Object]");if(typeof ue=="object"&&m(ue)==="[object Object]"&&(ue="[object Object]"),ue=String(ue),J===null&&(J={}),ie==="tag:yaml.org,2002:merge")if(Array.isArray(fe))for(Ke=0,He=fe.length;Ke<He;Ke+=1)G(k,J,fe[Ke],Y);else G(k,J,fe,Y);else k.json||f.call(Y,ue)||!f.call(J,ue)||(k.line=Se||k.line,k.position=Fe||k.position,L(k,"duplicated mapping key")),J[ue]=fe,delete Y[ue];return J}function $(k){var J;(J=k.input.charCodeAt(k.position))===10?k.position++:J===13?(k.position++,k.input.charCodeAt(k.position)===10&&k.position++):L(k,"a line break is expected"),k.line+=1,k.lineStart=k.position}function V(k,J,Y){for(var ie=0,ue=k.input.charCodeAt(k.position);ue!==0;){for(;v(ue);)ue=k.input.charCodeAt(++k.position);if(J&&ue===35)do ue=k.input.charCodeAt(++k.position);while(ue!==10&&ue!==13&&ue!==0);if(!y(ue))break;for($(k),ue=k.input.charCodeAt(k.position),ie++,k.lineIndent=0;ue===32;)k.lineIndent++,ue=k.input.charCodeAt(++k.position)}return Y!==-1&&ie!==0&&k.lineIndent<Y&&P(k,"deficient indentation"),ie}function X(k){var J,Y=k.position;return!((J=k.input.charCodeAt(Y))!==45&&J!==46||J!==k.input.charCodeAt(Y+1)||J!==k.input.charCodeAt(Y+2)||(Y+=3,(J=k.input.charCodeAt(Y))!==0&&!x(J)))}function Q(k,J){J===1?k.result+=" ":J>1&&(k.result+=a.repeat(`
`,J-1))}function re(k,J){var Y,ie,ue=k.tag,fe=k.anchor,Se=[],Fe=!1;for(k.anchor!==null&&(k.anchorMap[k.anchor]=Se),ie=k.input.charCodeAt(k.position);ie!==0&&ie===45&&x(k.input.charCodeAt(k.position+1));)if(Fe=!0,k.position++,V(k,!0,-1)&&k.lineIndent<=J)Se.push(null),ie=k.input.charCodeAt(k.position);else if(Y=k.line,Ce(k,J,3,!1,!0),Se.push(k.result),V(k,!0,-1),ie=k.input.charCodeAt(k.position),(k.line===Y||k.lineIndent>J)&&ie!==0)L(k,"bad indentation of a sequence entry");else if(k.lineIndent<J)break;return!!Fe&&(k.tag=ue,k.anchor=fe,k.kind="sequence",k.result=Se,!0)}function ye(k){var J,Y,ie,ue,fe=!1,Se=!1;if((ue=k.input.charCodeAt(k.position))!==33)return!1;if(k.tag!==null&&L(k,"duplication of a tag property"),(ue=k.input.charCodeAt(++k.position))===60?(fe=!0,ue=k.input.charCodeAt(++k.position)):ue===33?(Se=!0,Y="!!",ue=k.input.charCodeAt(++k.position)):Y="!",J=k.position,fe){do ue=k.input.charCodeAt(++k.position);while(ue!==0&&ue!==62);k.position<k.length?(ie=k.input.slice(J,k.position),ue=k.input.charCodeAt(++k.position)):L(k,"unexpected end of the stream within a verbatim tag")}else{for(;ue!==0&&!x(ue);)ue===33&&(Se?L(k,"tag suffix cannot contain exclamation marks"):(Y=k.input.slice(J-1,k.position+1),p.test(Y)||L(k,"named tag handle cannot contain such characters"),Se=!0,J=k.position+1)),ue=k.input.charCodeAt(++k.position);ie=k.input.slice(J,k.position),h.test(ie)&&L(k,"tag suffix cannot contain flow indicator characters")}return ie&&!g.test(ie)&&L(k,"tag name cannot contain such characters: "+ie),fe?k.tag=ie:f.call(k.tagMap,Y)?k.tag=k.tagMap[Y]+ie:Y==="!"?k.tag="!"+ie:Y==="!!"?k.tag="tag:yaml.org,2002:"+ie:L(k,'undeclared tag handle "'+Y+'"'),!0}function me(k){var J,Y;if((Y=k.input.charCodeAt(k.position))!==38)return!1;for(k.anchor!==null&&L(k,"duplication of an anchor property"),Y=k.input.charCodeAt(++k.position),J=k.position;Y!==0&&!x(Y)&&!w(Y);)Y=k.input.charCodeAt(++k.position);return k.position===J&&L(k,"name of an anchor node must contain at least one character"),k.anchor=k.input.slice(J,k.position),!0}function Ce(k,J,Y,ie,ue){var fe,Se,Fe,Ke,He,pe,ge,Ie,ve=1,_e=!1,Pe=!1;if(k.listener!==null&&k.listener("open",k),k.tag=null,k.anchor=null,k.kind=null,k.result=null,fe=Se=Fe=Y===4||Y===3,ie&&V(k,!0,-1)&&(_e=!0,k.lineIndent>J?ve=1:k.lineIndent===J?ve=0:k.lineIndent<J&&(ve=-1)),ve===1)for(;ye(k)||me(k);)V(k,!0,-1)?(_e=!0,Fe=fe,k.lineIndent>J?ve=1:k.lineIndent===J?ve=0:k.lineIndent<J&&(ve=-1)):Fe=!1;if(Fe&&(Fe=_e||ue),ve!==1&&Y!==4||(ge=Y===1||Y===2?J:J+1,Ie=k.position-k.lineStart,ve===1?Fe&&(re(k,Ie)||(function(ne,Je,$e){var ke,Re,ze,st,Qe,_t=ne.tag,Le=ne.anchor,We={},xt={},Ut=null,gn=null,tn=null,Ht=!1,dn=!1;for(ne.anchor!==null&&(ne.anchorMap[ne.anchor]=We),Qe=ne.input.charCodeAt(ne.position);Qe!==0;){if(ke=ne.input.charCodeAt(ne.position+1),ze=ne.line,st=ne.position,Qe!==63&&Qe!==58||!x(ke)){if(!Ce(ne,$e,2,!1,!0))break;if(ne.line===ze){for(Qe=ne.input.charCodeAt(ne.position);v(Qe);)Qe=ne.input.charCodeAt(++ne.position);if(Qe===58)x(Qe=ne.input.charCodeAt(++ne.position))||L(ne,"a whitespace character is expected after the key-value separator within a block mapping"),Ht&&(F(ne,We,xt,Ut,gn,null),Ut=gn=tn=null),dn=!0,Ht=!1,Re=!1,Ut=ne.tag,gn=ne.result;else{if(!dn)return ne.tag=_t,ne.anchor=Le,!0;L(ne,"can not read an implicit mapping pair; a colon is missed")}}else{if(!dn)return ne.tag=_t,ne.anchor=Le,!0;L(ne,"can not read a block mapping entry; a multiline key may not be an implicit key")}}else Qe===63?(Ht&&(F(ne,We,xt,Ut,gn,null),Ut=gn=tn=null),dn=!0,Ht=!0,Re=!0):Ht?(Ht=!1,Re=!0):L(ne,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),ne.position+=1,Qe=ke;if((ne.line===ze||ne.lineIndent>Je)&&(Ce(ne,Je,4,!0,Re)&&(Ht?gn=ne.result:tn=ne.result),Ht||(F(ne,We,xt,Ut,gn,tn,ze,st),Ut=gn=tn=null),V(ne,!0,-1),Qe=ne.input.charCodeAt(ne.position)),ne.lineIndent>Je&&Qe!==0)L(ne,"bad indentation of a mapping entry");else if(ne.lineIndent<Je)break}return Ht&&F(ne,We,xt,Ut,gn,null),dn&&(ne.tag=_t,ne.anchor=Le,ne.kind="mapping",ne.result=We),dn})(k,Ie,ge))||(function(ne,Je){var $e,ke,Re,ze,st,Qe,_t,Le,We,xt,Ut=!0,gn=ne.tag,tn=ne.anchor,Ht={};if((xt=ne.input.charCodeAt(ne.position))===91)Re=93,Qe=!1,ke=[];else{if(xt!==123)return!1;Re=125,Qe=!0,ke={}}for(ne.anchor!==null&&(ne.anchorMap[ne.anchor]=ke),xt=ne.input.charCodeAt(++ne.position);xt!==0;){if(V(ne,!0,Je),(xt=ne.input.charCodeAt(ne.position))===Re)return ne.position++,ne.tag=gn,ne.anchor=tn,ne.kind=Qe?"mapping":"sequence",ne.result=ke,!0;Ut||L(ne,"missed comma between flow collection entries"),We=null,ze=st=!1,xt===63&&x(ne.input.charCodeAt(ne.position+1))&&(ze=st=!0,ne.position++,V(ne,!0,Je)),$e=ne.line,Ce(ne,Je,1,!1,!0),Le=ne.tag,_t=ne.result,V(ne,!0,Je),xt=ne.input.charCodeAt(ne.position),!st&&ne.line!==$e||xt!==58||(ze=!0,xt=ne.input.charCodeAt(++ne.position),V(ne,!0,Je),Ce(ne,Je,1,!1,!0),We=ne.result),Qe?F(ne,ke,Ht,Le,_t,We):ze?ke.push(F(ne,null,Ht,Le,_t,We)):ke.push(_t),V(ne,!0,Je),(xt=ne.input.charCodeAt(ne.position))===44?(Ut=!0,xt=ne.input.charCodeAt(++ne.position)):Ut=!1}L(ne,"unexpected end of the stream within a flow collection")})(k,ge)?Pe=!0:(Se&&(function(ne,Je){var $e,ke,Re,ze,st,Qe=1,_t=!1,Le=!1,We=Je,xt=0,Ut=!1;if((ze=ne.input.charCodeAt(ne.position))===124)ke=!1;else{if(ze!==62)return!1;ke=!0}for(ne.kind="scalar",ne.result="";ze!==0;)if((ze=ne.input.charCodeAt(++ne.position))===43||ze===45)Qe===1?Qe=ze===43?3:2:L(ne,"repeat of a chomping mode identifier");else{if(!((Re=48<=(st=ze)&&st<=57?st-48:-1)>=0))break;Re===0?L(ne,"bad explicit indentation width of a block scalar; it cannot be less than one"):Le?L(ne,"repeat of an indentation width identifier"):(We=Je+Re-1,Le=!0)}if(v(ze)){do ze=ne.input.charCodeAt(++ne.position);while(v(ze));if(ze===35)do ze=ne.input.charCodeAt(++ne.position);while(!y(ze)&&ze!==0)}for(;ze!==0;){for($(ne),ne.lineIndent=0,ze=ne.input.charCodeAt(ne.position);(!Le||ne.lineIndent<We)&&ze===32;)ne.lineIndent++,ze=ne.input.charCodeAt(++ne.position);if(!Le&&ne.lineIndent>We&&(We=ne.lineIndent),y(ze))xt++;else{if(ne.lineIndent<We){Qe===3?ne.result+=a.repeat(`
`,_t?1+xt:xt):Qe===1&&_t&&(ne.result+=`
`);break}for(ke?v(ze)?(Ut=!0,ne.result+=a.repeat(`
`,_t?1+xt:xt)):Ut?(Ut=!1,ne.result+=a.repeat(`
`,xt+1)):xt===0?_t&&(ne.result+=" "):ne.result+=a.repeat(`
`,xt):ne.result+=a.repeat(`
`,_t?1+xt:xt),_t=!0,Le=!0,xt=0,$e=ne.position;!y(ze)&&ze!==0;)ze=ne.input.charCodeAt(++ne.position);U(ne,$e,ne.position,!1)}}return!0})(k,ge)||(function(ne,Je){var $e,ke,Re;if(($e=ne.input.charCodeAt(ne.position))!==39)return!1;for(ne.kind="scalar",ne.result="",ne.position++,ke=Re=ne.position;($e=ne.input.charCodeAt(ne.position))!==0;)if($e===39){if(U(ne,ke,ne.position,!0),($e=ne.input.charCodeAt(++ne.position))!==39)return!0;ke=ne.position,ne.position++,Re=ne.position}else y($e)?(U(ne,ke,Re,!0),Q(ne,V(ne,!1,Je)),ke=Re=ne.position):ne.position===ne.lineStart&&X(ne)?L(ne,"unexpected end of the document within a single quoted scalar"):(ne.position++,Re=ne.position);L(ne,"unexpected end of the stream within a single quoted scalar")})(k,ge)||(function(ne,Je){var $e,ke,Re,ze,st,Qe,_t;if((Qe=ne.input.charCodeAt(ne.position))!==34)return!1;for(ne.kind="scalar",ne.result="",ne.position++,$e=ke=ne.position;(Qe=ne.input.charCodeAt(ne.position))!==0;){if(Qe===34)return U(ne,$e,ne.position,!0),ne.position++,!0;if(Qe===92){if(U(ne,$e,ne.position,!0),y(Qe=ne.input.charCodeAt(++ne.position)))V(ne,!1,Je);else if(Qe<256&&D[Qe])ne.result+=I[Qe],ne.position++;else if((st=(_t=Qe)===120?2:_t===117?4:_t===85?8:0)>0){for(Re=st,ze=0;Re>0;Re--)(st=S(Qe=ne.input.charCodeAt(++ne.position)))>=0?ze=(ze<<4)+st:L(ne,"expected hexadecimal character");ne.result+=_(ze),ne.position++}else L(ne,"unknown escape sequence");$e=ke=ne.position}else y(Qe)?(U(ne,$e,ke,!0),Q(ne,V(ne,!1,Je)),$e=ke=ne.position):ne.position===ne.lineStart&&X(ne)?L(ne,"unexpected end of the document within a double quoted scalar"):(ne.position++,ke=ne.position)}L(ne,"unexpected end of the stream within a double quoted scalar")})(k,ge)?Pe=!0:(function(ne){var Je,$e,ke;if((ke=ne.input.charCodeAt(ne.position))!==42)return!1;for(ke=ne.input.charCodeAt(++ne.position),Je=ne.position;ke!==0&&!x(ke)&&!w(ke);)ke=ne.input.charCodeAt(++ne.position);return ne.position===Je&&L(ne,"name of an alias node must contain at least one character"),$e=ne.input.slice(Je,ne.position),ne.anchorMap.hasOwnProperty($e)||L(ne,'unidentified alias "'+$e+'"'),ne.result=ne.anchorMap[$e],V(ne,!0,-1),!0})(k)?(Pe=!0,k.tag===null&&k.anchor===null||L(k,"alias node should not have any properties")):(function(ne,Je,$e){var ke,Re,ze,st,Qe,_t,Le,We,xt=ne.kind,Ut=ne.result;if(x(We=ne.input.charCodeAt(ne.position))||w(We)||We===35||We===38||We===42||We===33||We===124||We===62||We===39||We===34||We===37||We===64||We===96||(We===63||We===45)&&(x(ke=ne.input.charCodeAt(ne.position+1))||$e&&w(ke)))return!1;for(ne.kind="scalar",ne.result="",Re=ze=ne.position,st=!1;We!==0;){if(We===58){if(x(ke=ne.input.charCodeAt(ne.position+1))||$e&&w(ke))break}else if(We===35){if(x(ne.input.charCodeAt(ne.position-1)))break}else{if(ne.position===ne.lineStart&&X(ne)||$e&&w(We))break;if(y(We)){if(Qe=ne.line,_t=ne.lineStart,Le=ne.lineIndent,V(ne,!1,-1),ne.lineIndent>=Je){st=!0,We=ne.input.charCodeAt(ne.position);continue}ne.position=ze,ne.line=Qe,ne.lineStart=_t,ne.lineIndent=Le;break}}st&&(U(ne,Re,ze,!1),Q(ne,ne.line-Qe),Re=ze=ne.position,st=!1),v(We)||(ze=ne.position+1),We=ne.input.charCodeAt(++ne.position)}return U(ne,Re,ze,!1),!!ne.result||(ne.kind=xt,ne.result=Ut,!1)})(k,ge,Y===1)&&(Pe=!0,k.tag===null&&(k.tag="?")),k.anchor!==null&&(k.anchorMap[k.anchor]=k.result)):ve===0&&(Pe=Fe&&re(k,Ie))),k.tag!==null&&k.tag!=="!")if(k.tag==="?"){for(k.result!==null&&k.kind!=="scalar"&&L(k,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+k.kind+'"'),Ke=0,He=k.implicitTypes.length;Ke<He;Ke+=1)if((pe=k.implicitTypes[Ke]).resolve(k.result)){k.result=pe.construct(k.result),k.tag=pe.tag,k.anchor!==null&&(k.anchorMap[k.anchor]=k.result);break}}else f.call(k.typeMap[k.kind||"fallback"],k.tag)?(pe=k.typeMap[k.kind||"fallback"][k.tag],k.result!==null&&pe.kind!==k.kind&&L(k,"unacceptable node kind for !<"+k.tag+'> tag; it should be "'+pe.kind+'", not "'+k.kind+'"'),pe.resolve(k.result)?(k.result=pe.construct(k.result),k.anchor!==null&&(k.anchorMap[k.anchor]=k.result)):L(k,"cannot resolve a node with !<"+k.tag+"> explicit tag")):L(k,"unknown tag !<"+k.tag+">");return k.listener!==null&&k.listener("close",k),k.tag!==null||k.anchor!==null||Pe}function we(k){var J,Y,ie,ue,fe=k.position,Se=!1;for(k.version=null,k.checkLineBreaks=k.legacy,k.tagMap={},k.anchorMap={};(ue=k.input.charCodeAt(k.position))!==0&&(V(k,!0,-1),ue=k.input.charCodeAt(k.position),!(k.lineIndent>0||ue!==37));){for(Se=!0,ue=k.input.charCodeAt(++k.position),J=k.position;ue!==0&&!x(ue);)ue=k.input.charCodeAt(++k.position);for(ie=[],(Y=k.input.slice(J,k.position)).length<1&&L(k,"directive name must not be less than one character in length");ue!==0;){for(;v(ue);)ue=k.input.charCodeAt(++k.position);if(ue===35){do ue=k.input.charCodeAt(++k.position);while(ue!==0&&!y(ue));break}if(y(ue))break;for(J=k.position;ue!==0&&!x(ue);)ue=k.input.charCodeAt(++k.position);ie.push(k.input.slice(J,k.position))}ue!==0&&$(k),f.call(B,Y)?B[Y](k,Y,ie):P(k,'unknown document directive "'+Y+'"')}V(k,!0,-1),k.lineIndent===0&&k.input.charCodeAt(k.position)===45&&k.input.charCodeAt(k.position+1)===45&&k.input.charCodeAt(k.position+2)===45?(k.position+=3,V(k,!0,-1)):Se&&L(k,"directives end mark is expected"),Ce(k,k.lineIndent-1,4,!1,!0),V(k,!0,-1),k.checkLineBreaks&&d.test(k.input.slice(fe,k.position))&&P(k,"non-ASCII line breaks are interpreted as content"),k.documents.push(k.result),k.position===k.lineStart&&X(k)?k.input.charCodeAt(k.position)===46&&(k.position+=3,V(k,!0,-1)):k.position<k.length-1&&L(k,"end of the stream or a document separator is expected")}function Ae(k,J){J=J||{},(k=String(k)).length!==0&&(k.charCodeAt(k.length-1)!==10&&k.charCodeAt(k.length-1)!==13&&(k+=`
`),k.charCodeAt(0)===65279&&(k=k.slice(1)));var Y=new M(k,J),ie=k.indexOf("\0");for(ie!==-1&&(Y.position=ie,L(Y,"null byte is not allowed in input")),Y.input+="\0";Y.input.charCodeAt(Y.position)===32;)Y.lineIndent+=1,Y.position+=1;for(;Y.position<Y.length-1;)we(Y);return Y.documents}function De(k,J,Y){J!==null&&typeof J=="object"&&Y===void 0&&(Y=J,J=null);var ie=Ae(k,Y);if(typeof J!="function")return ie;for(var ue=0,fe=ie.length;ue<fe;ue+=1)J(ie[ue])}function q(k,J){var Y=Ae(k,J);if(Y.length!==0){if(Y.length===1)return Y[0];throw new o("expected a single document in the stream, but found more")}}n.exports.loadAll=De,n.exports.load=q,n.exports.safeLoadAll=function(k,J,Y){return typeof J=="object"&&J!==null&&Y===void 0&&(Y=J,J=null),De(k,J,a.extend({schema:l},Y))},n.exports.safeLoad=function(k,J){return q(k,a.extend({schema:l},J))}},function(n,r,i){var a=i(38);function o(s,l,c,f,u){this.name=s,this.buffer=l,this.position=c,this.line=f,this.column=u}o.prototype.getSnippet=function(s,l){var c,f,u,d,h;if(!this.buffer)return null;for(s=s||4,l=l||75,c="",f=this.position;f>0&&`\0\r
\u2028\u2029`.indexOf(this.buffer.charAt(f-1))===-1;)if(f-=1,this.position-f>l/2-1){c=" ... ",f+=5;break}for(u="",d=this.position;d<this.buffer.length&&`\0\r
\u2028\u2029`.indexOf(this.buffer.charAt(d))===-1;)if((d+=1)-this.position>l/2-1){u=" ... ",d-=5;break}return h=this.buffer.slice(f,d),a.repeat(" ",s)+c+h+u+`
`+a.repeat(" ",s+this.position-f+c.length)+"^"},o.prototype.toString=function(s){var l,c="";return this.name&&(c+='in "'+this.name+'" '),c+="at line "+(this.line+1)+", column "+(this.column+1),s||(l=this.getSnippet())&&(c+=`:
`+l),c},n.exports=o},function(n,r,i){var a=i(10);n.exports=new a("tag:yaml.org,2002:str",{kind:"scalar",construct:function(o){return o!==null?o:""}})},function(n,r,i){var a=i(10);n.exports=new a("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(o){return o!==null?o:[]}})},function(n,r,i){var a=i(10);n.exports=new a("tag:yaml.org,2002:map",{kind:"mapping",construct:function(o){return o!==null?o:{}}})},function(n,r,i){var a=i(10);n.exports=new a("tag:yaml.org,2002:null",{kind:"scalar",resolve:function(o){if(o===null)return!0;var s=o.length;return s===1&&o==="~"||s===4&&(o==="null"||o==="Null"||o==="NULL")},construct:function(){return null},predicate:function(o){return o===null},represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"}},defaultStyle:"lowercase"})},function(n,r,i){var a=i(10);n.exports=new a("tag:yaml.org,2002:bool",{kind:"scalar",resolve:function(o){if(o===null)return!1;var s=o.length;return s===4&&(o==="true"||o==="True"||o==="TRUE")||s===5&&(o==="false"||o==="False"||o==="FALSE")},construct:function(o){return o==="true"||o==="True"||o==="TRUE"},predicate:function(o){return Object.prototype.toString.call(o)==="[object Boolean]"},represent:{lowercase:function(o){return o?"true":"false"},uppercase:function(o){return o?"TRUE":"FALSE"},camelcase:function(o){return o?"True":"False"}},defaultStyle:"lowercase"})},function(n,r,i){var a=i(38),o=i(10);function s(c){return 48<=c&&c<=55}function l(c){return 48<=c&&c<=57}n.exports=new o("tag:yaml.org,2002:int",{kind:"scalar",resolve:function(c){if(c===null)return!1;var f,u,d=c.length,h=0,p=!1;if(!d)return!1;if((f=c[h])!=="-"&&f!=="+"||(f=c[++h]),f==="0"){if(h+1===d)return!0;if((f=c[++h])==="b"){for(h++;h<d;h++)if((f=c[h])!=="_"){if(f!=="0"&&f!=="1")return!1;p=!0}return p&&f!=="_"}if(f==="x"){for(h++;h<d;h++)if((f=c[h])!=="_"){if(!(48<=(u=c.charCodeAt(h))&&u<=57||65<=u&&u<=70||97<=u&&u<=102))return!1;p=!0}return p&&f!=="_"}for(;h<d;h++)if((f=c[h])!=="_"){if(!s(c.charCodeAt(h)))return!1;p=!0}return p&&f!=="_"}if(f==="_")return!1;for(;h<d;h++)if((f=c[h])!=="_"){if(f===":")break;if(!l(c.charCodeAt(h)))return!1;p=!0}return!(!p||f==="_")&&(f!==":"||/^(:[0-5]?[0-9])+$/.test(c.slice(h)))},construct:function(c){var f,u,d=c,h=1,p=[];return d.indexOf("_")!==-1&&(d=d.replace(/_/g,"")),(f=d[0])!=="-"&&f!=="+"||(f==="-"&&(h=-1),f=(d=d.slice(1))[0]),d==="0"?0:f==="0"?d[1]==="b"?h*parseInt(d.slice(2),2):d[1]==="x"?h*parseInt(d,16):h*parseInt(d,8):d.indexOf(":")!==-1?(d.split(":").forEach((function(g){p.unshift(parseInt(g,10))})),d=0,u=1,p.forEach((function(g){d+=g*u,u*=60})),h*d):h*parseInt(d,10)},predicate:function(c){return Object.prototype.toString.call(c)==="[object Number]"&&c%1==0&&!a.isNegativeZero(c)},represent:{binary:function(c){return c>=0?"0b"+c.toString(2):"-0b"+c.toString(2).slice(1)},octal:function(c){return c>=0?"0"+c.toString(8):"-0"+c.toString(8).slice(1)},decimal:function(c){return c.toString(10)},hexadecimal:function(c){return c>=0?"0x"+c.toString(16).toUpperCase():"-0x"+c.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}})},function(n,r,i){var a=i(38),o=i(10),s=new RegExp("^(?:[-+]?(?:0|[1-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+\\.[0-9_]*|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$"),l=/^[-+]?[0-9]+e/;n.exports=new o("tag:yaml.org,2002:float",{kind:"scalar",resolve:function(c){return c!==null&&!(!s.test(c)||c[c.length-1]==="_")},construct:function(c){var f,u,d,h;return u=(f=c.replace(/_/g,"").toLowerCase())[0]==="-"?-1:1,h=[],"+-".indexOf(f[0])>=0&&(f=f.slice(1)),f===".inf"?u===1?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:f===".nan"?NaN:f.indexOf(":")>=0?(f.split(":").forEach((function(p){h.unshift(parseFloat(p,10))})),f=0,d=1,h.forEach((function(p){f+=p*d,d*=60})),u*f):u*parseFloat(f,10)},predicate:function(c){return Object.prototype.toString.call(c)==="[object Number]"&&(c%1!=0||a.isNegativeZero(c))},represent:function(c,f){var u;if(isNaN(c))switch(f){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===c)switch(f){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===c)switch(f){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(a.isNegativeZero(c))return"-0.0";return u=c.toString(10),l.test(u)?u.replace("e",".e"):u},defaultStyle:"lowercase"})},function(n,r,i){var a=i(10),o=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),s=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");n.exports=new a("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:function(l){return l!==null&&(o.exec(l)!==null||s.exec(l)!==null)},construct:function(l){var c,f,u,d,h,p,g,m,y=0,v=null;if((c=o.exec(l))===null&&(c=s.exec(l)),c===null)throw new Error("Date resolve error");if(f=+c[1],u=+c[2]-1,d=+c[3],!c[4])return new Date(Date.UTC(f,u,d));if(h=+c[4],p=+c[5],g=+c[6],c[7]){for(y=c[7].slice(0,3);y.length<3;)y+="0";y=+y}return c[9]&&(v=6e4*(60*+c[10]+ +(c[11]||0)),c[9]==="-"&&(v=-v)),m=new Date(Date.UTC(f,u,d,h,p,g,y)),v&&m.setTime(m.getTime()-v),m},instanceOf:Date,represent:function(l){return l.toISOString()}})},function(n,r,i){var a=i(10);n.exports=new a("tag:yaml.org,2002:merge",{kind:"scalar",resolve:function(o){return o==="<<"||o===null}})},function(n,r,i){var a;try{a=i(145).Buffer}catch{}var o=i(10),s=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=
\r`;n.exports=new o("tag:yaml.org,2002:binary",{kind:"scalar",resolve:function(l){if(l===null)return!1;var c,f,u=0,d=l.length,h=s;for(f=0;f<d;f++)if(!((c=h.indexOf(l.charAt(f)))>64)){if(c<0)return!1;u+=6}return u%8==0},construct:function(l){var c,f,u=l.replace(/[\r\n=]/g,""),d=u.length,h=s,p=0,g=[];for(c=0;c<d;c++)c%4==0&&c&&(g.push(p>>16&255),g.push(p>>8&255),g.push(255&p)),p=p<<6|h.indexOf(u.charAt(c));return(f=d%4*6)===0?(g.push(p>>16&255),g.push(p>>8&255),g.push(255&p)):f===18?(g.push(p>>10&255),g.push(p>>2&255)):f===12&&g.push(p>>4&255),a?a.from?a.from(g):new a(g):g},predicate:function(l){return a&&a.isBuffer(l)},represent:function(l){var c,f,u="",d=0,h=l.length,p=s;for(c=0;c<h;c++)c%3==0&&c&&(u+=p[d>>18&63],u+=p[d>>12&63],u+=p[d>>6&63],u+=p[63&d]),d=(d<<8)+l[c];return(f=h%3)===0?(u+=p[d>>18&63],u+=p[d>>12&63],u+=p[d>>6&63],u+=p[63&d]):f===2?(u+=p[d>>10&63],u+=p[d>>4&63],u+=p[d<<2&63],u+=p[64]):f===1&&(u+=p[d>>2&63],u+=p[d<<4&63],u+=p[64],u+=p[64]),u}})},function(n,r,i){var a=i(10),o=Object.prototype.hasOwnProperty,s=Object.prototype.toString;n.exports=new a("tag:yaml.org,2002:omap",{kind:"sequence",resolve:function(l){if(l===null)return!0;var c,f,u,d,h,p=[],g=l;for(c=0,f=g.length;c<f;c+=1){if(u=g[c],h=!1,s.call(u)!=="[object Object]")return!1;for(d in u)if(o.call(u,d)){if(h)return!1;h=!0}if(!h||p.indexOf(d)!==-1)return!1;p.push(d)}return!0},construct:function(l){return l!==null?l:[]}})},function(n,r,i){var a=i(10),o=Object.prototype.toString;n.exports=new a("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:function(s){if(s===null)return!0;var l,c,f,u,d,h=s;for(d=new Array(h.length),l=0,c=h.length;l<c;l+=1){if(f=h[l],o.call(f)!=="[object Object]"||(u=Object.keys(f)).length!==1)return!1;d[l]=[u[0],f[u[0]]]}return!0},construct:function(s){if(s===null)return[];var l,c,f,u,d,h=s;for(d=new Array(h.length),l=0,c=h.length;l<c;l+=1)f=h[l],u=Object.keys(f),d[l]=[u[0],f[u[0]]];return d}})},function(n,r,i){var a=i(10),o=Object.prototype.hasOwnProperty;n.exports=new a("tag:yaml.org,2002:set",{kind:"mapping",resolve:function(s){if(s===null)return!0;var l,c=s;for(l in c)if(o.call(c,l)&&c[l]!==null)return!1;return!0},construct:function(s){return s!==null?s:{}}})},function(n,r,i){var a=i(10);n.exports=new a("tag:yaml.org,2002:js/undefined",{kind:"scalar",resolve:function(){return!0},construct:function(){},predicate:function(o){return o===void 0},represent:function(){return""}})},function(n,r,i){var a=i(10);n.exports=new a("tag:yaml.org,2002:js/regexp",{kind:"scalar",resolve:function(o){if(o===null||o.length===0)return!1;var s=o,l=/\/([gim]*)$/.exec(o),c="";return!(s[0]==="/"&&(l&&(c=l[1]),c.length>3||s[s.length-c.length-1]!=="/"))},construct:function(o){var s=o,l=/\/([gim]*)$/.exec(o),c="";return s[0]==="/"&&(l&&(c=l[1]),s=s.slice(1,s.length-c.length-1)),new RegExp(s,c)},predicate:function(o){return Object.prototype.toString.call(o)==="[object RegExp]"},represent:function(o){var s="/"+o.source+"/";return o.global&&(s+="g"),o.multiline&&(s+="m"),o.ignoreCase&&(s+="i"),s}})},function(n,r,i){var a;try{a=i(302)}catch{typeof window<"u"&&(a=window.esprima)}var o=i(10);n.exports=new o("tag:yaml.org,2002:js/function",{kind:"scalar",resolve:function(s){if(s===null)return!1;try{var l="("+s+")",c=a.parse(l,{range:!0});return c.type==="Program"&&c.body.length===1&&c.body[0].type==="ExpressionStatement"&&(c.body[0].expression.type==="ArrowFunctionExpression"||c.body[0].expression.type==="FunctionExpression")}catch{return!1}},construct:function(s){var l,c="("+s+")",f=a.parse(c,{range:!0}),u=[];if(f.type!=="Program"||f.body.length!==1||f.body[0].type!=="ExpressionStatement"||f.body[0].expression.type!=="ArrowFunctionExpression"&&f.body[0].expression.type!=="FunctionExpression")throw new Error("Failed to resolve function");return f.body[0].expression.params.forEach((function(d){u.push(d.name)})),l=f.body[0].expression.body.range,f.body[0].expression.body.type==="BlockStatement"?new Function(u,c.slice(l[0]+1,l[1]-1)):new Function(u,"return "+c.slice(l[0],l[1]))},predicate:function(s){return Object.prototype.toString.call(s)==="[object Function]"},represent:function(s){return s.toString()}})},function(n,r,i){var a;a=function(){return(function(o){var s={};function l(c){if(s[c])return s[c].exports;var f=s[c]={exports:{},id:c,loaded:!1};return o[c].call(f.exports,f,f.exports,l),f.loaded=!0,f.exports}return l.m=o,l.c=s,l.p="",l(0)})([function(o,s,l){Object.defineProperty(s,"__esModule",{value:!0});var c=l(1),f=l(3),u=l(8),d=l(15);function h(g,m,y){var v=null,x=function(R,M){y&&y(R,M),v&&v.visit(R,M)},w=typeof y=="function"?x:null,S=!1;if(m){S=typeof m.comment=="boolean"&&m.comment;var T=typeof m.attachComment=="boolean"&&m.attachComment;(S||T)&&((v=new c.CommentHandler).attach=T,m.comment=!0,w=x)}var _,D=!1;m&&typeof m.sourceType=="string"&&(D=m.sourceType==="module"),_=m&&typeof m.jsx=="boolean"&&m.jsx?new f.JSXParser(g,m,w):new u.Parser(g,m,w);var I=D?_.parseModule():_.parseScript();return S&&v&&(I.comments=v.comments),_.config.tokens&&(I.tokens=_.tokens),_.config.tolerant&&(I.errors=_.errorHandler.errors),I}s.parse=h,s.parseModule=function(g,m,y){var v=m||{};return v.sourceType="module",h(g,v,y)},s.parseScript=function(g,m,y){var v=m||{};return v.sourceType="script",h(g,v,y)},s.tokenize=function(g,m,y){var v,x=new d.Tokenizer(g,m);v=[];try{for(;;){var w=x.getNextToken();if(!w)break;y&&(w=y(w)),v.push(w)}}catch(S){x.errorHandler.tolerate(S)}return x.errorHandler.tolerant&&(v.errors=x.errors()),v};var p=l(2);s.Syntax=p.Syntax,s.version="4.0.1"},function(o,s,l){Object.defineProperty(s,"__esModule",{value:!0});var c=l(2),f=(function(){function u(){this.attach=!1,this.comments=[],this.stack=[],this.leading=[],this.trailing=[]}return u.prototype.insertInnerComments=function(d,h){if(d.type===c.Syntax.BlockStatement&&d.body.length===0){for(var p=[],g=this.leading.length-1;g>=0;--g){var m=this.leading[g];h.end.offset>=m.start&&(p.unshift(m.comment),this.leading.splice(g,1),this.trailing.splice(g,1))}p.length&&(d.innerComments=p)}},u.prototype.findTrailingComments=function(d){var h=[];if(this.trailing.length>0){for(var p=this.trailing.length-1;p>=0;--p){var g=this.trailing[p];g.start>=d.end.offset&&h.unshift(g.comment)}return this.trailing.length=0,h}var m=this.stack[this.stack.length-1];if(m&&m.node.trailingComments){var y=m.node.trailingComments[0];y&&y.range[0]>=d.end.offset&&(h=m.node.trailingComments,delete m.node.trailingComments)}return h},u.prototype.findLeadingComments=function(d){for(var h,p=[];this.stack.length>0&&(y=this.stack[this.stack.length-1])&&y.start>=d.start.offset;)h=y.node,this.stack.pop();if(h){for(var g=(h.leadingComments?h.leadingComments.length:0)-1;g>=0;--g){var m=h.leadingComments[g];m.range[1]<=d.start.offset&&(p.unshift(m),h.leadingComments.splice(g,1))}return h.leadingComments&&h.leadingComments.length===0&&delete h.leadingComments,p}for(g=this.leading.length-1;g>=0;--g){var y;(y=this.leading[g]).start<=d.start.offset&&(p.unshift(y.comment),this.leading.splice(g,1))}return p},u.prototype.visitNode=function(d,h){if(!(d.type===c.Syntax.Program&&d.body.length>0)){this.insertInnerComments(d,h);var p=this.findTrailingComments(h),g=this.findLeadingComments(h);g.length>0&&(d.leadingComments=g),p.length>0&&(d.trailingComments=p),this.stack.push({node:d,start:h.start.offset})}},u.prototype.visitComment=function(d,h){var p=d.type[0]==="L"?"Line":"Block",g={type:p,value:d.value};if(d.range&&(g.range=d.range),d.loc&&(g.loc=d.loc),this.comments.push(g),this.attach){var m={comment:{type:p,value:d.value,range:[h.start.offset,h.end.offset]},start:h.start.offset};d.loc&&(m.comment.loc=d.loc),d.type=p,this.leading.push(m),this.trailing.push(m)}},u.prototype.visit=function(d,h){d.type==="LineComment"||d.type==="BlockComment"?this.visitComment(d,h):this.attach&&this.visitNode(d,h)},u})();s.CommentHandler=f},function(o,s){Object.defineProperty(s,"__esModule",{value:!0}),s.Syntax={AssignmentExpression:"AssignmentExpression",AssignmentPattern:"AssignmentPattern",ArrayExpression:"ArrayExpression",ArrayPattern:"ArrayPattern",ArrowFunctionExpression:"ArrowFunctionExpression",AwaitExpression:"AwaitExpression",BlockStatement:"BlockStatement",BinaryExpression:"BinaryExpression",BreakStatement:"BreakStatement",CallExpression:"CallExpression",CatchClause:"CatchClause",ClassBody:"ClassBody",ClassDeclaration:"ClassDeclaration",ClassExpression:"ClassExpression",ConditionalExpression:"ConditionalExpression",ContinueStatement:"ContinueStatement",DoWhileStatement:"DoWhileStatement",DebuggerStatement:"DebuggerStatement",EmptyStatement:"EmptyStatement",ExportAllDeclaration:"ExportAllDeclaration",ExportDefaultDeclaration:"ExportDefaultDeclaration",ExportNamedDeclaration:"ExportNamedDeclaration",ExportSpecifier:"ExportSpecifier",ExpressionStatement:"ExpressionStatement",ForStatement:"ForStatement",ForOfStatement:"ForOfStatement",ForInStatement:"ForInStatement",FunctionDeclaration:"FunctionDeclaration",FunctionExpression:"FunctionExpression",Identifier:"Identifier",IfStatement:"IfStatement",ImportDeclaration:"ImportDeclaration",ImportDefaultSpecifier:"ImportDefaultSpecifier",ImportNamespaceSpecifier:"ImportNamespaceSpecifier",ImportSpecifier:"ImportSpecifier",Literal:"Literal",LabeledStatement:"LabeledStatement",LogicalExpression:"LogicalExpression",MemberExpression:"MemberExpression",MetaProperty:"MetaProperty",MethodDefinition:"MethodDefinition",NewExpression:"NewExpression",ObjectExpression:"ObjectExpression",ObjectPattern:"ObjectPattern",Program:"Program",Property:"Property",RestElement:"RestElement",ReturnStatement:"ReturnStatement",SequenceExpression:"SequenceExpression",SpreadElement:"SpreadElement",Super:"Super",SwitchCase:"SwitchCase",SwitchStatement:"SwitchStatement",TaggedTemplateExpression:"TaggedTemplateExpression",TemplateElement:"TemplateElement",TemplateLiteral:"TemplateLiteral",ThisExpression:"ThisExpression",ThrowStatement:"ThrowStatement",TryStatement:"TryStatement",UnaryExpression:"UnaryExpression",UpdateExpression:"UpdateExpression",VariableDeclaration:"VariableDeclaration",VariableDeclarator:"VariableDeclarator",WhileStatement:"WhileStatement",WithStatement:"WithStatement",YieldExpression:"YieldExpression"}},function(o,s,l){var c,f=this&&this.__extends||(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(w,S){w.__proto__=S}||function(w,S){for(var T in S)S.hasOwnProperty(T)&&(w[T]=S[T])},function(w,S){function T(){this.constructor=w}c(w,S),w.prototype=S===null?Object.create(S):(T.prototype=S.prototype,new T)});Object.defineProperty(s,"__esModule",{value:!0});var u=l(4),d=l(5),h=l(6),p=l(7),g=l(8),m=l(13),y=l(14);function v(w){var S;switch(w.type){case h.JSXSyntax.JSXIdentifier:S=w.name;break;case h.JSXSyntax.JSXNamespacedName:var T=w;S=v(T.namespace)+":"+v(T.name);break;case h.JSXSyntax.JSXMemberExpression:var _=w;S=v(_.object)+"."+v(_.property)}return S}m.TokenName[100]="JSXIdentifier",m.TokenName[101]="JSXText";var x=(function(w){function S(T,_,D){return w.call(this,T,_,D)||this}return f(S,w),S.prototype.parsePrimaryExpression=function(){return this.match("<")?this.parseJSXRoot():w.prototype.parsePrimaryExpression.call(this)},S.prototype.startJSX=function(){this.scanner.index=this.startMarker.index,this.scanner.lineNumber=this.startMarker.line,this.scanner.lineStart=this.startMarker.index-this.startMarker.column},S.prototype.finishJSX=function(){this.nextToken()},S.prototype.reenterJSX=function(){this.startJSX(),this.expectJSX("}"),this.config.tokens&&this.tokens.pop()},S.prototype.createJSXNode=function(){return this.collectComments(),{index:this.scanner.index,line:this.scanner.lineNumber,column:this.scanner.index-this.scanner.lineStart}},S.prototype.createJSXChildNode=function(){return{index:this.scanner.index,line:this.scanner.lineNumber,column:this.scanner.index-this.scanner.lineStart}},S.prototype.scanXHTMLEntity=function(T){for(var _="&",D=!0,I=!1,R=!1,M=!1;!this.scanner.eof()&&D&&!I;){var A=this.scanner.source[this.scanner.index];if(A===T)break;if(I=A===";",_+=A,++this.scanner.index,!I)switch(_.length){case 2:R=A==="#";break;case 3:R&&(D=(M=A==="x")||u.Character.isDecimalDigit(A.charCodeAt(0)),R=R&&!M);break;default:D=(D=D&&!(R&&!u.Character.isDecimalDigit(A.charCodeAt(0))))&&!(M&&!u.Character.isHexDigit(A.charCodeAt(0)))}}if(D&&I&&_.length>2){var L=_.substr(1,_.length-2);R&&L.length>1?_=String.fromCharCode(parseInt(L.substr(1),10)):M&&L.length>2?_=String.fromCharCode(parseInt("0"+L.substr(1),16)):R||M||!y.XHTMLEntities[L]||(_=y.XHTMLEntities[L])}return _},S.prototype.lexJSX=function(){var T=this.scanner.source.charCodeAt(this.scanner.index);if(T===60||T===62||T===47||T===58||T===61||T===123||T===125)return{type:7,value:A=this.scanner.source[this.scanner.index++],lineNumber:this.scanner.lineNumber,lineStart:this.scanner.lineStart,start:this.scanner.index-1,end:this.scanner.index};if(T===34||T===39){for(var _=this.scanner.index,D=this.scanner.source[this.scanner.index++],I="";!this.scanner.eof()&&(L=this.scanner.source[this.scanner.index++])!==D;)I+=L==="&"?this.scanXHTMLEntity(D):L;return{type:8,value:I,lineNumber:this.scanner.lineNumber,lineStart:this.scanner.lineStart,start:_,end:this.scanner.index}}if(T===46){var R=this.scanner.source.charCodeAt(this.scanner.index+1),M=this.scanner.source.charCodeAt(this.scanner.index+2),A=R===46&&M===46?"...":".";return _=this.scanner.index,this.scanner.index+=A.length,{type:7,value:A,lineNumber:this.scanner.lineNumber,lineStart:this.scanner.lineStart,start:_,end:this.scanner.index}}if(T===96)return{type:10,value:"",lineNumber:this.scanner.lineNumber,lineStart:this.scanner.lineStart,start:this.scanner.index,end:this.scanner.index};if(u.Character.isIdentifierStart(T)&&T!==92){for(_=this.scanner.index,++this.scanner.index;!this.scanner.eof();){var L=this.scanner.source.charCodeAt(this.scanner.index);if(u.Character.isIdentifierPart(L)&&L!==92)++this.scanner.index;else{if(L!==45)break;++this.scanner.index}}return{type:100,value:this.scanner.source.slice(_,this.scanner.index),lineNumber:this.scanner.lineNumber,lineStart:this.scanner.lineStart,start:_,end:this.scanner.index}}return this.scanner.lex()},S.prototype.nextJSXToken=function(){this.collectComments(),this.startMarker.index=this.scanner.index,this.startMarker.line=this.scanner.lineNumber,this.startMarker.column=this.scanner.index-this.scanner.lineStart;var T=this.lexJSX();return this.lastMarker.index=this.scanner.index,this.lastMarker.line=this.scanner.lineNumber,this.lastMarker.column=this.scanner.index-this.scanner.lineStart,this.config.tokens&&this.tokens.push(this.convertToken(T)),T},S.prototype.nextJSXText=function(){this.startMarker.index=this.scanner.index,this.startMarker.line=this.scanner.lineNumber,this.startMarker.column=this.scanner.index-this.scanner.lineStart;for(var T=this.scanner.index,_="";!this.scanner.eof();){var D=this.scanner.source[this.scanner.index];if(D==="{"||D==="<")break;++this.scanner.index,_+=D,u.Character.isLineTerminator(D.charCodeAt(0))&&(++this.scanner.lineNumber,D==="\r"&&this.scanner.source[this.scanner.index]===`
`&&++this.scanner.index,this.scanner.lineStart=this.scanner.index)}this.lastMarker.index=this.scanner.index,this.lastMarker.line=this.scanner.lineNumber,this.lastMarker.column=this.scanner.index-this.scanner.lineStart;var I={type:101,value:_,lineNumber:this.scanner.lineNumber,lineStart:this.scanner.lineStart,start:T,end:this.scanner.index};return _.length>0&&this.config.tokens&&this.tokens.push(this.convertToken(I)),I},S.prototype.peekJSXToken=function(){var T=this.scanner.saveState();this.scanner.scanComments();var _=this.lexJSX();return this.scanner.restoreState(T),_},S.prototype.expectJSX=function(T){var _=this.nextJSXToken();_.type===7&&_.value===T||this.throwUnexpectedToken(_)},S.prototype.matchJSX=function(T){var _=this.peekJSXToken();return _.type===7&&_.value===T},S.prototype.parseJSXIdentifier=function(){var T=this.createJSXNode(),_=this.nextJSXToken();return _.type!==100&&this.throwUnexpectedToken(_),this.finalize(T,new d.JSXIdentifier(_.value))},S.prototype.parseJSXElementName=function(){var T=this.createJSXNode(),_=this.parseJSXIdentifier();if(this.matchJSX(":")){var D=_;this.expectJSX(":");var I=this.parseJSXIdentifier();_=this.finalize(T,new d.JSXNamespacedName(D,I))}else if(this.matchJSX("."))for(;this.matchJSX(".");){var R=_;this.expectJSX(".");var M=this.parseJSXIdentifier();_=this.finalize(T,new d.JSXMemberExpression(R,M))}return _},S.prototype.parseJSXAttributeName=function(){var T,_=this.createJSXNode(),D=this.parseJSXIdentifier();if(this.matchJSX(":")){var I=D;this.expectJSX(":");var R=this.parseJSXIdentifier();T=this.finalize(_,new d.JSXNamespacedName(I,R))}else T=D;return T},S.prototype.parseJSXStringLiteralAttribute=function(){var T=this.createJSXNode(),_=this.nextJSXToken();_.type!==8&&this.throwUnexpectedToken(_);var D=this.getTokenRaw(_);return this.finalize(T,new p.Literal(_.value,D))},S.prototype.parseJSXExpressionAttribute=function(){var T=this.createJSXNode();this.expectJSX("{"),this.finishJSX(),this.match("}")&&this.tolerateError("JSX attributes must only be assigned a non-empty expression");var _=this.parseAssignmentExpression();return this.reenterJSX(),this.finalize(T,new d.JSXExpressionContainer(_))},S.prototype.parseJSXAttributeValue=function(){return this.matchJSX("{")?this.parseJSXExpressionAttribute():this.matchJSX("<")?this.parseJSXElement():this.parseJSXStringLiteralAttribute()},S.prototype.parseJSXNameValueAttribute=function(){var T=this.createJSXNode(),_=this.parseJSXAttributeName(),D=null;return this.matchJSX("=")&&(this.expectJSX("="),D=this.parseJSXAttributeValue()),this.finalize(T,new d.JSXAttribute(_,D))},S.prototype.parseJSXSpreadAttribute=function(){var T=this.createJSXNode();this.expectJSX("{"),this.expectJSX("..."),this.finishJSX();var _=this.parseAssignmentExpression();return this.reenterJSX(),this.finalize(T,new d.JSXSpreadAttribute(_))},S.prototype.parseJSXAttributes=function(){for(var T=[];!this.matchJSX("/")&&!this.matchJSX(">");){var _=this.matchJSX("{")?this.parseJSXSpreadAttribute():this.parseJSXNameValueAttribute();T.push(_)}return T},S.prototype.parseJSXOpeningElement=function(){var T=this.createJSXNode();this.expectJSX("<");var _=this.parseJSXElementName(),D=this.parseJSXAttributes(),I=this.matchJSX("/");return I&&this.expectJSX("/"),this.expectJSX(">"),this.finalize(T,new d.JSXOpeningElement(_,I,D))},S.prototype.parseJSXBoundaryElement=function(){var T=this.createJSXNode();if(this.expectJSX("<"),this.matchJSX("/")){this.expectJSX("/");var _=this.parseJSXElementName();return this.expectJSX(">"),this.finalize(T,new d.JSXClosingElement(_))}var D=this.parseJSXElementName(),I=this.parseJSXAttributes(),R=this.matchJSX("/");return R&&this.expectJSX("/"),this.expectJSX(">"),this.finalize(T,new d.JSXOpeningElement(D,R,I))},S.prototype.parseJSXEmptyExpression=function(){var T=this.createJSXChildNode();return this.collectComments(),this.lastMarker.index=this.scanner.index,this.lastMarker.line=this.scanner.lineNumber,this.lastMarker.column=this.scanner.index-this.scanner.lineStart,this.finalize(T,new d.JSXEmptyExpression)},S.prototype.parseJSXExpressionContainer=function(){var T,_=this.createJSXNode();return this.expectJSX("{"),this.matchJSX("}")?(T=this.parseJSXEmptyExpression(),this.expectJSX("}")):(this.finishJSX(),T=this.parseAssignmentExpression(),this.reenterJSX()),this.finalize(_,new d.JSXExpressionContainer(T))},S.prototype.parseJSXChildren=function(){for(var T=[];!this.scanner.eof();){var _=this.createJSXChildNode(),D=this.nextJSXText();if(D.start<D.end){var I=this.getTokenRaw(D),R=this.finalize(_,new d.JSXText(D.value,I));T.push(R)}if(this.scanner.source[this.scanner.index]!=="{")break;var M=this.parseJSXExpressionContainer();T.push(M)}return T},S.prototype.parseComplexJSXElement=function(T){for(var _=[];!this.scanner.eof();){T.children=T.children.concat(this.parseJSXChildren());var D=this.createJSXChildNode(),I=this.parseJSXBoundaryElement();if(I.type===h.JSXSyntax.JSXOpeningElement){var R=I;if(R.selfClosing){var M=this.finalize(D,new d.JSXElement(R,[],null));T.children.push(M)}else _.push(T),T={node:D,opening:R,closing:null,children:[]}}if(I.type===h.JSXSyntax.JSXClosingElement){T.closing=I;var A=v(T.opening.name);if(A!==v(T.closing.name)&&this.tolerateError("Expected corresponding JSX closing tag for %0",A),!(_.length>0))break;M=this.finalize(T.node,new d.JSXElement(T.opening,T.children,T.closing)),(T=_[_.length-1]).children.push(M),_.pop()}}return T},S.prototype.parseJSXElement=function(){var T=this.createJSXNode(),_=this.parseJSXOpeningElement(),D=[],I=null;if(!_.selfClosing){var R=this.parseComplexJSXElement({node:T,opening:_,closing:I,children:D});D=R.children,I=R.closing}return this.finalize(T,new d.JSXElement(_,D,I))},S.prototype.parseJSXRoot=function(){this.config.tokens&&this.tokens.pop(),this.startJSX();var T=this.parseJSXElement();return this.finishJSX(),T},S.prototype.isStartOfExpression=function(){return w.prototype.isStartOfExpression.call(this)||this.match("<")},S})(g.Parser);s.JSXParser=x},function(o,s){Object.defineProperty(s,"__esModule",{value:!0});var l={NonAsciiIdentifierStart:/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0-\u08B4\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309B-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AD\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF30-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC03-\uDC37\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDF00-\uDF19]|\uD806[\uDCA0-\uDCDF\uDCFF\uDEC0-\uDEF8]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50\uDF93-\uDF9F]|\uD82C[\uDC00\uDC01]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD83A[\uDC00-\uDCC4]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1]|\uD87E[\uDC00-\uDE1D]/,NonAsciiIdentifierPart:/[\xAA\xB5\xB7\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05F0-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u0800-\u082D\u0840-\u085B\u08A0-\u08B4\u08E3-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C03\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C60-\u0C63\u0C66-\u0C6F\u0C81-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1\u0CF2\u0D01-\u0D03\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D57\u0D5F-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D82\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB9\u0EBB-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1369-\u1371\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u1820-\u1877\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1B00-\u1B4B\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1CD0-\u1CD2\u1CD4-\u1CF6\u1CF8\u1CF9\u1D00-\u1DF5\u1DFC-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u200C\u200D\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AD\uA7B0-\uA7B7\uA7F7-\uA827\uA840-\uA873\uA880-\uA8C4\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA8FD\uA900-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDDFD\uDE80-\uDE9C\uDEA0-\uDED0\uDEE0\uDF00-\uDF1F\uDF30-\uDF4A\uDF50-\uDF7A\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00-\uDE03\uDE05\uDE06\uDE0C-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE38-\uDE3A\uDE3F\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE6\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC00-\uDC46\uDC66-\uDC6F\uDC7F-\uDCBA\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD00-\uDD34\uDD36-\uDD3F\uDD50-\uDD73\uDD76\uDD80-\uDDC4\uDDCA-\uDDCC\uDDD0-\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE37\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEEA\uDEF0-\uDEF9\uDF00-\uDF03\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3C-\uDF44\uDF47\uDF48\uDF4B-\uDF4D\uDF50\uDF57\uDF5D-\uDF63\uDF66-\uDF6C\uDF70-\uDF74]|\uD805[\uDC80-\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDB5\uDDB8-\uDDC0\uDDD8-\uDDDD\uDE00-\uDE40\uDE44\uDE50-\uDE59\uDE80-\uDEB7\uDEC0-\uDEC9\uDF00-\uDF19\uDF1D-\uDF2B\uDF30-\uDF39]|\uD806[\uDCA0-\uDCE9\uDCFF\uDEC0-\uDEF8]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDED0-\uDEED\uDEF0-\uDEF4\uDF00-\uDF36\uDF40-\uDF43\uDF50-\uDF59\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50-\uDF7E\uDF8F-\uDF9F]|\uD82C[\uDC00\uDC01]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99\uDC9D\uDC9E]|\uD834[\uDD65-\uDD69\uDD6D-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE9B-\uDE9F\uDEA1-\uDEAF]|\uD83A[\uDC00-\uDCC4\uDCD0-\uDCD6]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1]|\uD87E[\uDC00-\uDE1D]|\uDB40[\uDD00-\uDDEF]/};s.Character={fromCodePoint:function(c){return c<65536?String.fromCharCode(c):String.fromCharCode(55296+(c-65536>>10))+String.fromCharCode(56320+(c-65536&1023))},isWhiteSpace:function(c){return c===32||c===9||c===11||c===12||c===160||c>=5760&&[5760,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(c)>=0},isLineTerminator:function(c){return c===10||c===13||c===8232||c===8233},isIdentifierStart:function(c){return c===36||c===95||c>=65&&c<=90||c>=97&&c<=122||c===92||c>=128&&l.NonAsciiIdentifierStart.test(s.Character.fromCodePoint(c))},isIdentifierPart:function(c){return c===36||c===95||c>=65&&c<=90||c>=97&&c<=122||c>=48&&c<=57||c===92||c>=128&&l.NonAsciiIdentifierPart.test(s.Character.fromCodePoint(c))},isDecimalDigit:function(c){return c>=48&&c<=57},isHexDigit:function(c){return c>=48&&c<=57||c>=65&&c<=70||c>=97&&c<=102},isOctalDigit:function(c){return c>=48&&c<=55}}},function(o,s,l){Object.defineProperty(s,"__esModule",{value:!0});var c=l(6),f=function(S){this.type=c.JSXSyntax.JSXClosingElement,this.name=S};s.JSXClosingElement=f;var u=function(S,T,_){this.type=c.JSXSyntax.JSXElement,this.openingElement=S,this.children=T,this.closingElement=_};s.JSXElement=u;var d=function(){this.type=c.JSXSyntax.JSXEmptyExpression};s.JSXEmptyExpression=d;var h=function(S){this.type=c.JSXSyntax.JSXExpressionContainer,this.expression=S};s.JSXExpressionContainer=h;var p=function(S){this.type=c.JSXSyntax.JSXIdentifier,this.name=S};s.JSXIdentifier=p;var g=function(S,T){this.type=c.JSXSyntax.JSXMemberExpression,this.object=S,this.property=T};s.JSXMemberExpression=g;var m=function(S,T){this.type=c.JSXSyntax.JSXAttribute,this.name=S,this.value=T};s.JSXAttribute=m;var y=function(S,T){this.type=c.JSXSyntax.JSXNamespacedName,this.namespace=S,this.name=T};s.JSXNamespacedName=y;var v=function(S,T,_){this.type=c.JSXSyntax.JSXOpeningElement,this.name=S,this.selfClosing=T,this.attributes=_};s.JSXOpeningElement=v;var x=function(S){this.type=c.JSXSyntax.JSXSpreadAttribute,this.argument=S};s.JSXSpreadAttribute=x;var w=function(S,T){this.type=c.JSXSyntax.JSXText,this.value=S,this.raw=T};s.JSXText=w},function(o,s){Object.defineProperty(s,"__esModule",{value:!0}),s.JSXSyntax={JSXAttribute:"JSXAttribute",JSXClosingElement:"JSXClosingElement",JSXElement:"JSXElement",JSXEmptyExpression:"JSXEmptyExpression",JSXExpressionContainer:"JSXExpressionContainer",JSXIdentifier:"JSXIdentifier",JSXMemberExpression:"JSXMemberExpression",JSXNamespacedName:"JSXNamespacedName",JSXOpeningElement:"JSXOpeningElement",JSXSpreadAttribute:"JSXSpreadAttribute",JSXText:"JSXText"}},function(o,s,l){Object.defineProperty(s,"__esModule",{value:!0});var c=l(2),f=function(qe){this.type=c.Syntax.ArrayExpression,this.elements=qe};s.ArrayExpression=f;var u=function(qe){this.type=c.Syntax.ArrayPattern,this.elements=qe};s.ArrayPattern=u;var d=function(qe,Dt,Rt){this.type=c.Syntax.ArrowFunctionExpression,this.id=null,this.params=qe,this.body=Dt,this.generator=!1,this.expression=Rt,this.async=!1};s.ArrowFunctionExpression=d;var h=function(qe,Dt,Rt){this.type=c.Syntax.AssignmentExpression,this.operator=qe,this.left=Dt,this.right=Rt};s.AssignmentExpression=h;var p=function(qe,Dt){this.type=c.Syntax.AssignmentPattern,this.left=qe,this.right=Dt};s.AssignmentPattern=p;var g=function(qe,Dt,Rt){this.type=c.Syntax.ArrowFunctionExpression,this.id=null,this.params=qe,this.body=Dt,this.generator=!1,this.expression=Rt,this.async=!0};s.AsyncArrowFunctionExpression=g;var m=function(qe,Dt,Rt){this.type=c.Syntax.FunctionDeclaration,this.id=qe,this.params=Dt,this.body=Rt,this.generator=!1,this.expression=!1,this.async=!0};s.AsyncFunctionDeclaration=m;var y=function(qe,Dt,Rt){this.type=c.Syntax.FunctionExpression,this.id=qe,this.params=Dt,this.body=Rt,this.generator=!1,this.expression=!1,this.async=!0};s.AsyncFunctionExpression=y;var v=function(qe){this.type=c.Syntax.AwaitExpression,this.argument=qe};s.AwaitExpression=v;var x=function(qe,Dt,Rt){var Bt=qe==="||"||qe==="&&";this.type=Bt?c.Syntax.LogicalExpression:c.Syntax.BinaryExpression,this.operator=qe,this.left=Dt,this.right=Rt};s.BinaryExpression=x;var w=function(qe){this.type=c.Syntax.BlockStatement,this.body=qe};s.BlockStatement=w;var S=function(qe){this.type=c.Syntax.BreakStatement,this.label=qe};s.BreakStatement=S;var T=function(qe,Dt){this.type=c.Syntax.CallExpression,this.callee=qe,this.arguments=Dt};s.CallExpression=T;var _=function(qe,Dt){this.type=c.Syntax.CatchClause,this.param=qe,this.body=Dt};s.CatchClause=_;var D=function(qe){this.type=c.Syntax.ClassBody,this.body=qe};s.ClassBody=D;var I=function(qe,Dt,Rt){this.type=c.Syntax.ClassDeclaration,this.id=qe,this.superClass=Dt,this.body=Rt};s.ClassDeclaration=I;var R=function(qe,Dt,Rt){this.type=c.Syntax.ClassExpression,this.id=qe,this.superClass=Dt,this.body=Rt};s.ClassExpression=R;var M=function(qe,Dt){this.type=c.Syntax.MemberExpression,this.computed=!0,this.object=qe,this.property=Dt};s.ComputedMemberExpression=M;var A=function(qe,Dt,Rt){this.type=c.Syntax.ConditionalExpression,this.test=qe,this.consequent=Dt,this.alternate=Rt};s.ConditionalExpression=A;var L=function(qe){this.type=c.Syntax.ContinueStatement,this.label=qe};s.ContinueStatement=L;var P=function(){this.type=c.Syntax.DebuggerStatement};s.DebuggerStatement=P;var B=function(qe,Dt){this.type=c.Syntax.ExpressionStatement,this.expression=qe,this.directive=Dt};s.Directive=B;var U=function(qe,Dt){this.type=c.Syntax.DoWhileStatement,this.body=qe,this.test=Dt};s.DoWhileStatement=U;var G=function(){this.type=c.Syntax.EmptyStatement};s.EmptyStatement=G;var F=function(qe){this.type=c.Syntax.ExportAllDeclaration,this.source=qe};s.ExportAllDeclaration=F;var $=function(qe){this.type=c.Syntax.ExportDefaultDeclaration,this.declaration=qe};s.ExportDefaultDeclaration=$;var V=function(qe,Dt,Rt){this.type=c.Syntax.ExportNamedDeclaration,this.declaration=qe,this.specifiers=Dt,this.source=Rt};s.ExportNamedDeclaration=V;var X=function(qe,Dt){this.type=c.Syntax.ExportSpecifier,this.exported=Dt,this.local=qe};s.ExportSpecifier=X;var Q=function(qe){this.type=c.Syntax.ExpressionStatement,this.expression=qe};s.ExpressionStatement=Q;var re=function(qe,Dt,Rt){this.type=c.Syntax.ForInStatement,this.left=qe,this.right=Dt,this.body=Rt,this.each=!1};s.ForInStatement=re;var ye=function(qe,Dt,Rt){this.type=c.Syntax.ForOfStatement,this.left=qe,this.right=Dt,this.body=Rt};s.ForOfStatement=ye;var me=function(qe,Dt,Rt,Bt){this.type=c.Syntax.ForStatement,this.init=qe,this.test=Dt,this.update=Rt,this.body=Bt};s.ForStatement=me;var Ce=function(qe,Dt,Rt,Bt){this.type=c.Syntax.FunctionDeclaration,this.id=qe,this.params=Dt,this.body=Rt,this.generator=Bt,this.expression=!1,this.async=!1};s.FunctionDeclaration=Ce;var we=function(qe,Dt,Rt,Bt){this.type=c.Syntax.FunctionExpression,this.id=qe,this.params=Dt,this.body=Rt,this.generator=Bt,this.expression=!1,this.async=!1};s.FunctionExpression=we;var Ae=function(qe){this.type=c.Syntax.Identifier,this.name=qe};s.Identifier=Ae;var De=function(qe,Dt,Rt){this.type=c.Syntax.IfStatement,this.test=qe,this.consequent=Dt,this.alternate=Rt};s.IfStatement=De;var q=function(qe,Dt){this.type=c.Syntax.ImportDeclaration,this.specifiers=qe,this.source=Dt};s.ImportDeclaration=q;var k=function(qe){this.type=c.Syntax.ImportDefaultSpecifier,this.local=qe};s.ImportDefaultSpecifier=k;var J=function(qe){this.type=c.Syntax.ImportNamespaceSpecifier,this.local=qe};s.ImportNamespaceSpecifier=J;var Y=function(qe,Dt){this.type=c.Syntax.ImportSpecifier,this.local=qe,this.imported=Dt};s.ImportSpecifier=Y;var ie=function(qe,Dt){this.type=c.Syntax.LabeledStatement,this.label=qe,this.body=Dt};s.LabeledStatement=ie;var ue=function(qe,Dt){this.type=c.Syntax.Literal,this.value=qe,this.raw=Dt};s.Literal=ue;var fe=function(qe,Dt){this.type=c.Syntax.MetaProperty,this.meta=qe,this.property=Dt};s.MetaProperty=fe;var Se=function(qe,Dt,Rt,Bt,On){this.type=c.Syntax.MethodDefinition,this.key=qe,this.computed=Dt,this.value=Rt,this.kind=Bt,this.static=On};s.MethodDefinition=Se;var Fe=function(qe){this.type=c.Syntax.Program,this.body=qe,this.sourceType="module"};s.Module=Fe;var Ke=function(qe,Dt){this.type=c.Syntax.NewExpression,this.callee=qe,this.arguments=Dt};s.NewExpression=Ke;var He=function(qe){this.type=c.Syntax.ObjectExpression,this.properties=qe};s.ObjectExpression=He;var pe=function(qe){this.type=c.Syntax.ObjectPattern,this.properties=qe};s.ObjectPattern=pe;var ge=function(qe,Dt,Rt,Bt,On,$t){this.type=c.Syntax.Property,this.key=Dt,this.computed=Rt,this.value=Bt,this.kind=qe,this.method=On,this.shorthand=$t};s.Property=ge;var Ie=function(qe,Dt,Rt,Bt){this.type=c.Syntax.Literal,this.value=qe,this.raw=Dt,this.regex={pattern:Rt,flags:Bt}};s.RegexLiteral=Ie;var ve=function(qe){this.type=c.Syntax.RestElement,this.argument=qe};s.RestElement=ve;var _e=function(qe){this.type=c.Syntax.ReturnStatement,this.argument=qe};s.ReturnStatement=_e;var Pe=function(qe){this.type=c.Syntax.Program,this.body=qe,this.sourceType="script"};s.Script=Pe;var ne=function(qe){this.type=c.Syntax.SequenceExpression,this.expressions=qe};s.SequenceExpression=ne;var Je=function(qe){this.type=c.Syntax.SpreadElement,this.argument=qe};s.SpreadElement=Je;var $e=function(qe,Dt){this.type=c.Syntax.MemberExpression,this.computed=!1,this.object=qe,this.property=Dt};s.StaticMemberExpression=$e;var ke=function(){this.type=c.Syntax.Super};s.Super=ke;var Re=function(qe,Dt){this.type=c.Syntax.SwitchCase,this.test=qe,this.consequent=Dt};s.SwitchCase=Re;var ze=function(qe,Dt){this.type=c.Syntax.SwitchStatement,this.discriminant=qe,this.cases=Dt};s.SwitchStatement=ze;var st=function(qe,Dt){this.type=c.Syntax.TaggedTemplateExpression,this.tag=qe,this.quasi=Dt};s.TaggedTemplateExpression=st;var Qe=function(qe,Dt){this.type=c.Syntax.TemplateElement,this.value=qe,this.tail=Dt};s.TemplateElement=Qe;var _t=function(qe,Dt){this.type=c.Syntax.TemplateLiteral,this.quasis=qe,this.expressions=Dt};s.TemplateLiteral=_t;var Le=function(){this.type=c.Syntax.ThisExpression};s.ThisExpression=Le;var We=function(qe){this.type=c.Syntax.ThrowStatement,this.argument=qe};s.ThrowStatement=We;var xt=function(qe,Dt,Rt){this.type=c.Syntax.TryStatement,this.block=qe,this.handler=Dt,this.finalizer=Rt};s.TryStatement=xt;var Ut=function(qe,Dt){this.type=c.Syntax.UnaryExpression,this.operator=qe,this.argument=Dt,this.prefix=!0};s.UnaryExpression=Ut;var gn=function(qe,Dt,Rt){this.type=c.Syntax.UpdateExpression,this.operator=qe,this.argument=Dt,this.prefix=Rt};s.UpdateExpression=gn;var tn=function(qe,Dt){this.type=c.Syntax.VariableDeclaration,this.declarations=qe,this.kind=Dt};s.VariableDeclaration=tn;var Ht=function(qe,Dt){this.type=c.Syntax.VariableDeclarator,this.id=qe,this.init=Dt};s.VariableDeclarator=Ht;var dn=function(qe,Dt){this.type=c.Syntax.WhileStatement,this.test=qe,this.body=Dt};s.WhileStatement=dn;var sr=function(qe,Dt){this.type=c.Syntax.WithStatement,this.object=qe,this.body=Dt};s.WithStatement=sr;var Qn=function(qe,Dt){this.type=c.Syntax.YieldExpression,this.argument=qe,this.delegate=Dt};s.YieldExpression=Qn},function(o,s,l){Object.defineProperty(s,"__esModule",{value:!0});var c=l(9),f=l(10),u=l(11),d=l(7),h=l(12),p=l(2),g=l(13),m=(function(){function y(v,x,w){x===void 0&&(x={}),this.config={range:typeof x.range=="boolean"&&x.range,loc:typeof x.loc=="boolean"&&x.loc,source:null,tokens:typeof x.tokens=="boolean"&&x.tokens,comment:typeof x.comment=="boolean"&&x.comment,tolerant:typeof x.tolerant=="boolean"&&x.tolerant},this.config.loc&&x.source&&x.source!==null&&(this.config.source=String(x.source)),this.delegate=w,this.errorHandler=new f.ErrorHandler,this.errorHandler.tolerant=this.config.tolerant,this.scanner=new h.Scanner(v,this.errorHandler),this.scanner.trackComment=this.config.comment,this.operatorPrecedence={")":0,";":0,",":0,"=":0,"]":0,"||":1,"&&":2,"|":3,"^":4,"&":5,"==":6,"!=":6,"===":6,"!==":6,"<":7,">":7,"<=":7,">=":7,"<<":8,">>":8,">>>":8,"+":9,"-":9,"*":11,"/":11,"%":11},this.lookahead={type:2,value:"",lineNumber:this.scanner.lineNumber,lineStart:0,start:0,end:0},this.hasLineTerminator=!1,this.context={isModule:!1,await:!1,allowIn:!0,allowStrictDirective:!0,allowYield:!0,firstCoverInitializedNameError:null,isAssignmentTarget:!1,isBindingElement:!1,inFunctionBody:!1,inIteration:!1,inSwitch:!1,labelSet:{},strict:!1},this.tokens=[],this.startMarker={index:0,line:this.scanner.lineNumber,column:0},this.lastMarker={index:0,line:this.scanner.lineNumber,column:0},this.nextToken(),this.lastMarker={index:this.scanner.index,line:this.scanner.lineNumber,column:this.scanner.index-this.scanner.lineStart}}return y.prototype.throwError=function(v){for(var x=[],w=1;w<arguments.length;w++)x[w-1]=arguments[w];var S=Array.prototype.slice.call(arguments,1),T=v.replace(/%(\d)/g,(function(R,M){return c.assert(M<S.length,"Message reference must be in range"),S[M]})),_=this.lastMarker.index,D=this.lastMarker.line,I=this.lastMarker.column+1;throw this.errorHandler.createError(_,D,I,T)},y.prototype.tolerateError=function(v){for(var x=[],w=1;w<arguments.length;w++)x[w-1]=arguments[w];var S=Array.prototype.slice.call(arguments,1),T=v.replace(/%(\d)/g,(function(R,M){return c.assert(M<S.length,"Message reference must be in range"),S[M]})),_=this.lastMarker.index,D=this.scanner.lineNumber,I=this.lastMarker.column+1;this.errorHandler.tolerateError(_,D,I,T)},y.prototype.unexpectedTokenError=function(v,x){var w,S=x||u.Messages.UnexpectedToken;if(v?(x||(S=v.type===2?u.Messages.UnexpectedEOS:v.type===3?u.Messages.UnexpectedIdentifier:v.type===6?u.Messages.UnexpectedNumber:v.type===8?u.Messages.UnexpectedString:v.type===10?u.Messages.UnexpectedTemplate:u.Messages.UnexpectedToken,v.type===4&&(this.scanner.isFutureReservedWord(v.value)?S=u.Messages.UnexpectedReserved:this.context.strict&&this.scanner.isStrictModeReservedWord(v.value)&&(S=u.Messages.StrictReservedWord))),w=v.value):w="ILLEGAL",S=S.replace("%0",w),v&&typeof v.lineNumber=="number"){var T=v.start,_=v.lineNumber,D=this.lastMarker.index-this.lastMarker.column,I=v.start-D+1;return this.errorHandler.createError(T,_,I,S)}return T=this.lastMarker.index,_=this.lastMarker.line,I=this.lastMarker.column+1,this.errorHandler.createError(T,_,I,S)},y.prototype.throwUnexpectedToken=function(v,x){throw this.unexpectedTokenError(v,x)},y.prototype.tolerateUnexpectedToken=function(v,x){this.errorHandler.tolerate(this.unexpectedTokenError(v,x))},y.prototype.collectComments=function(){if(this.config.comment){var v=this.scanner.scanComments();if(v.length>0&&this.delegate)for(var x=0;x<v.length;++x){var w=v[x],S=void 0;S={type:w.multiLine?"BlockComment":"LineComment",value:this.scanner.source.slice(w.slice[0],w.slice[1])},this.config.range&&(S.range=w.range),this.config.loc&&(S.loc=w.loc);var T={start:{line:w.loc.start.line,column:w.loc.start.column,offset:w.range[0]},end:{line:w.loc.end.line,column:w.loc.end.column,offset:w.range[1]}};this.delegate(S,T)}}else this.scanner.scanComments()},y.prototype.getTokenRaw=function(v){return this.scanner.source.slice(v.start,v.end)},y.prototype.convertToken=function(v){var x={type:g.TokenName[v.type],value:this.getTokenRaw(v)};if(this.config.range&&(x.range=[v.start,v.end]),this.config.loc&&(x.loc={start:{line:this.startMarker.line,column:this.startMarker.column},end:{line:this.scanner.lineNumber,column:this.scanner.index-this.scanner.lineStart}}),v.type===9){var w=v.pattern,S=v.flags;x.regex={pattern:w,flags:S}}return x},y.prototype.nextToken=function(){var v=this.lookahead;this.lastMarker.index=this.scanner.index,this.lastMarker.line=this.scanner.lineNumber,this.lastMarker.column=this.scanner.index-this.scanner.lineStart,this.collectComments(),this.scanner.index!==this.startMarker.index&&(this.startMarker.index=this.scanner.index,this.startMarker.line=this.scanner.lineNumber,this.startMarker.column=this.scanner.index-this.scanner.lineStart);var x=this.scanner.lex();return this.hasLineTerminator=v.lineNumber!==x.lineNumber,x&&this.context.strict&&x.type===3&&this.scanner.isStrictModeReservedWord(x.value)&&(x.type=4),this.lookahead=x,this.config.tokens&&x.type!==2&&this.tokens.push(this.convertToken(x)),v},y.prototype.nextRegexToken=function(){this.collectComments();var v=this.scanner.scanRegExp();return this.config.tokens&&(this.tokens.pop(),this.tokens.push(this.convertToken(v))),this.lookahead=v,this.nextToken(),v},y.prototype.createNode=function(){return{index:this.startMarker.index,line:this.startMarker.line,column:this.startMarker.column}},y.prototype.startNode=function(v,x){x===void 0&&(x=0);var w=v.start-v.lineStart,S=v.lineNumber;return w<0&&(w+=x,S--),{index:v.start,line:S,column:w}},y.prototype.finalize=function(v,x){if(this.config.range&&(x.range=[v.index,this.lastMarker.index]),this.config.loc&&(x.loc={start:{line:v.line,column:v.column},end:{line:this.lastMarker.line,column:this.lastMarker.column}},this.config.source&&(x.loc.source=this.config.source)),this.delegate){var w={start:{line:v.line,column:v.column,offset:v.index},end:{line:this.lastMarker.line,column:this.lastMarker.column,offset:this.lastMarker.index}};this.delegate(x,w)}return x},y.prototype.expect=function(v){var x=this.nextToken();x.type===7&&x.value===v||this.throwUnexpectedToken(x)},y.prototype.expectCommaSeparator=function(){if(this.config.tolerant){var v=this.lookahead;v.type===7&&v.value===","?this.nextToken():v.type===7&&v.value===";"?(this.nextToken(),this.tolerateUnexpectedToken(v)):this.tolerateUnexpectedToken(v,u.Messages.UnexpectedToken)}else this.expect(",")},y.prototype.expectKeyword=function(v){var x=this.nextToken();x.type===4&&x.value===v||this.throwUnexpectedToken(x)},y.prototype.match=function(v){return this.lookahead.type===7&&this.lookahead.value===v},y.prototype.matchKeyword=function(v){return this.lookahead.type===4&&this.lookahead.value===v},y.prototype.matchContextualKeyword=function(v){return this.lookahead.type===3&&this.lookahead.value===v},y.prototype.matchAssign=function(){if(this.lookahead.type!==7)return!1;var v=this.lookahead.value;return v==="="||v==="*="||v==="**="||v==="/="||v==="%="||v==="+="||v==="-="||v==="<<="||v===">>="||v===">>>="||v==="&="||v==="^="||v==="|="},y.prototype.isolateCoverGrammar=function(v){var x=this.context.isBindingElement,w=this.context.isAssignmentTarget,S=this.context.firstCoverInitializedNameError;this.context.isBindingElement=!0,this.context.isAssignmentTarget=!0,this.context.firstCoverInitializedNameError=null;var T=v.call(this);return this.context.firstCoverInitializedNameError!==null&&this.throwUnexpectedToken(this.context.firstCoverInitializedNameError),this.context.isBindingElement=x,this.context.isAssignmentTarget=w,this.context.firstCoverInitializedNameError=S,T},y.prototype.inheritCoverGrammar=function(v){var x=this.context.isBindingElement,w=this.context.isAssignmentTarget,S=this.context.firstCoverInitializedNameError;this.context.isBindingElement=!0,this.context.isAssignmentTarget=!0,this.context.firstCoverInitializedNameError=null;var T=v.call(this);return this.context.isBindingElement=this.context.isBindingElement&&x,this.context.isAssignmentTarget=this.context.isAssignmentTarget&&w,this.context.firstCoverInitializedNameError=S||this.context.firstCoverInitializedNameError,T},y.prototype.consumeSemicolon=function(){this.match(";")?this.nextToken():this.hasLineTerminator||(this.lookahead.type===2||this.match("}")||this.throwUnexpectedToken(this.lookahead),this.lastMarker.index=this.startMarker.index,this.lastMarker.line=this.startMarker.line,this.lastMarker.column=this.startMarker.column)},y.prototype.parsePrimaryExpression=function(){var v,x,w,S=this.createNode();switch(this.lookahead.type){case 3:(this.context.isModule||this.context.await)&&this.lookahead.value==="await"&&this.tolerateUnexpectedToken(this.lookahead),v=this.matchAsyncFunction()?this.parseFunctionExpression():this.finalize(S,new d.Identifier(this.nextToken().value));break;case 6:case 8:this.context.strict&&this.lookahead.octal&&this.tolerateUnexpectedToken(this.lookahead,u.Messages.StrictOctalLiteral),this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1,x=this.nextToken(),w=this.getTokenRaw(x),v=this.finalize(S,new d.Literal(x.value,w));break;case 1:this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1,x=this.nextToken(),w=this.getTokenRaw(x),v=this.finalize(S,new d.Literal(x.value==="true",w));break;case 5:this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1,x=this.nextToken(),w=this.getTokenRaw(x),v=this.finalize(S,new d.Literal(null,w));break;case 10:v=this.parseTemplateLiteral();break;case 7:switch(this.lookahead.value){case"(":this.context.isBindingElement=!1,v=this.inheritCoverGrammar(this.parseGroupExpression);break;case"[":v=this.inheritCoverGrammar(this.parseArrayInitializer);break;case"{":v=this.inheritCoverGrammar(this.parseObjectInitializer);break;case"/":case"/=":this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1,this.scanner.index=this.startMarker.index,x=this.nextRegexToken(),w=this.getTokenRaw(x),v=this.finalize(S,new d.RegexLiteral(x.regex,w,x.pattern,x.flags));break;default:v=this.throwUnexpectedToken(this.nextToken())}break;case 4:!this.context.strict&&this.context.allowYield&&this.matchKeyword("yield")?v=this.parseIdentifierName():!this.context.strict&&this.matchKeyword("let")?v=this.finalize(S,new d.Identifier(this.nextToken().value)):(this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1,this.matchKeyword("function")?v=this.parseFunctionExpression():this.matchKeyword("this")?(this.nextToken(),v=this.finalize(S,new d.ThisExpression)):v=this.matchKeyword("class")?this.parseClassExpression():this.throwUnexpectedToken(this.nextToken()));break;default:v=this.throwUnexpectedToken(this.nextToken())}return v},y.prototype.parseSpreadElement=function(){var v=this.createNode();this.expect("...");var x=this.inheritCoverGrammar(this.parseAssignmentExpression);return this.finalize(v,new d.SpreadElement(x))},y.prototype.parseArrayInitializer=function(){var v=this.createNode(),x=[];for(this.expect("[");!this.match("]");)if(this.match(","))this.nextToken(),x.push(null);else if(this.match("...")){var w=this.parseSpreadElement();this.match("]")||(this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1,this.expect(",")),x.push(w)}else x.push(this.inheritCoverGrammar(this.parseAssignmentExpression)),this.match("]")||this.expect(",");return this.expect("]"),this.finalize(v,new d.ArrayExpression(x))},y.prototype.parsePropertyMethod=function(v){this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1;var x=this.context.strict,w=this.context.allowStrictDirective;this.context.allowStrictDirective=v.simple;var S=this.isolateCoverGrammar(this.parseFunctionSourceElements);return this.context.strict&&v.firstRestricted&&this.tolerateUnexpectedToken(v.firstRestricted,v.message),this.context.strict&&v.stricted&&this.tolerateUnexpectedToken(v.stricted,v.message),this.context.strict=x,this.context.allowStrictDirective=w,S},y.prototype.parsePropertyMethodFunction=function(){var v=this.createNode(),x=this.context.allowYield;this.context.allowYield=!0;var w=this.parseFormalParameters(),S=this.parsePropertyMethod(w);return this.context.allowYield=x,this.finalize(v,new d.FunctionExpression(null,w.params,S,!1))},y.prototype.parsePropertyMethodAsyncFunction=function(){var v=this.createNode(),x=this.context.allowYield,w=this.context.await;this.context.allowYield=!1,this.context.await=!0;var S=this.parseFormalParameters(),T=this.parsePropertyMethod(S);return this.context.allowYield=x,this.context.await=w,this.finalize(v,new d.AsyncFunctionExpression(null,S.params,T))},y.prototype.parseObjectPropertyKey=function(){var v,x=this.createNode(),w=this.nextToken();switch(w.type){case 8:case 6:this.context.strict&&w.octal&&this.tolerateUnexpectedToken(w,u.Messages.StrictOctalLiteral);var S=this.getTokenRaw(w);v=this.finalize(x,new d.Literal(w.value,S));break;case 3:case 1:case 5:case 4:v=this.finalize(x,new d.Identifier(w.value));break;case 7:w.value==="["?(v=this.isolateCoverGrammar(this.parseAssignmentExpression),this.expect("]")):v=this.throwUnexpectedToken(w);break;default:v=this.throwUnexpectedToken(w)}return v},y.prototype.isPropertyKey=function(v,x){return v.type===p.Syntax.Identifier&&v.name===x||v.type===p.Syntax.Literal&&v.value===x},y.prototype.parseObjectProperty=function(v){var x,w=this.createNode(),S=this.lookahead,T=null,_=null,D=!1,I=!1,R=!1,M=!1;if(S.type===3){var A=S.value;this.nextToken(),D=this.match("["),T=(M=!(this.hasLineTerminator||A!=="async"||this.match(":")||this.match("(")||this.match("*")||this.match(",")))?this.parseObjectPropertyKey():this.finalize(w,new d.Identifier(A))}else this.match("*")?this.nextToken():(D=this.match("["),T=this.parseObjectPropertyKey());var L=this.qualifiedPropertyName(this.lookahead);if(S.type===3&&!M&&S.value==="get"&&L)x="get",D=this.match("["),T=this.parseObjectPropertyKey(),this.context.allowYield=!1,_=this.parseGetterMethod();else if(S.type===3&&!M&&S.value==="set"&&L)x="set",D=this.match("["),T=this.parseObjectPropertyKey(),_=this.parseSetterMethod();else if(S.type===7&&S.value==="*"&&L)x="init",D=this.match("["),T=this.parseObjectPropertyKey(),_=this.parseGeneratorMethod(),I=!0;else if(T||this.throwUnexpectedToken(this.lookahead),x="init",this.match(":")&&!M)!D&&this.isPropertyKey(T,"__proto__")&&(v.value&&this.tolerateError(u.Messages.DuplicateProtoProperty),v.value=!0),this.nextToken(),_=this.inheritCoverGrammar(this.parseAssignmentExpression);else if(this.match("("))_=M?this.parsePropertyMethodAsyncFunction():this.parsePropertyMethodFunction(),I=!0;else if(S.type===3)if(A=this.finalize(w,new d.Identifier(S.value)),this.match("=")){this.context.firstCoverInitializedNameError=this.lookahead,this.nextToken(),R=!0;var P=this.isolateCoverGrammar(this.parseAssignmentExpression);_=this.finalize(w,new d.AssignmentPattern(A,P))}else R=!0,_=A;else this.throwUnexpectedToken(this.nextToken());return this.finalize(w,new d.Property(x,T,D,_,I,R))},y.prototype.parseObjectInitializer=function(){var v=this.createNode();this.expect("{");for(var x=[],w={value:!1};!this.match("}");)x.push(this.parseObjectProperty(w)),this.match("}")||this.expectCommaSeparator();return this.expect("}"),this.finalize(v,new d.ObjectExpression(x))},y.prototype.parseTemplateHead=function(){c.assert(this.lookahead.head,"Template literal must start with a template head");var v=this.createNode(),x=this.nextToken(),w=x.value,S=x.cooked;return this.finalize(v,new d.TemplateElement({raw:w,cooked:S},x.tail))},y.prototype.parseTemplateElement=function(){this.lookahead.type!==10&&this.throwUnexpectedToken();var v=this.createNode(),x=this.nextToken(),w=x.value,S=x.cooked;return this.finalize(v,new d.TemplateElement({raw:w,cooked:S},x.tail))},y.prototype.parseTemplateLiteral=function(){var v=this.createNode(),x=[],w=[],S=this.parseTemplateHead();for(w.push(S);!S.tail;)x.push(this.parseExpression()),S=this.parseTemplateElement(),w.push(S);return this.finalize(v,new d.TemplateLiteral(w,x))},y.prototype.reinterpretExpressionAsPattern=function(v){switch(v.type){case p.Syntax.Identifier:case p.Syntax.MemberExpression:case p.Syntax.RestElement:case p.Syntax.AssignmentPattern:break;case p.Syntax.SpreadElement:v.type=p.Syntax.RestElement,this.reinterpretExpressionAsPattern(v.argument);break;case p.Syntax.ArrayExpression:v.type=p.Syntax.ArrayPattern;for(var x=0;x<v.elements.length;x++)v.elements[x]!==null&&this.reinterpretExpressionAsPattern(v.elements[x]);break;case p.Syntax.ObjectExpression:for(v.type=p.Syntax.ObjectPattern,x=0;x<v.properties.length;x++)this.reinterpretExpressionAsPattern(v.properties[x].value);break;case p.Syntax.AssignmentExpression:v.type=p.Syntax.AssignmentPattern,delete v.operator,this.reinterpretExpressionAsPattern(v.left)}},y.prototype.parseGroupExpression=function(){var v;if(this.expect("("),this.match(")"))this.nextToken(),this.match("=>")||this.expect("=>"),v={type:"ArrowParameterPlaceHolder",params:[],async:!1};else{var x=this.lookahead,w=[];if(this.match("..."))v=this.parseRestElement(w),this.expect(")"),this.match("=>")||this.expect("=>"),v={type:"ArrowParameterPlaceHolder",params:[v],async:!1};else{var S=!1;if(this.context.isBindingElement=!0,v=this.inheritCoverGrammar(this.parseAssignmentExpression),this.match(",")){var T=[];for(this.context.isAssignmentTarget=!1,T.push(v);this.lookahead.type!==2&&this.match(",");){if(this.nextToken(),this.match(")")){this.nextToken();for(var _=0;_<T.length;_++)this.reinterpretExpressionAsPattern(T[_]);S=!0,v={type:"ArrowParameterPlaceHolder",params:T,async:!1}}else if(this.match("...")){for(this.context.isBindingElement||this.throwUnexpectedToken(this.lookahead),T.push(this.parseRestElement(w)),this.expect(")"),this.match("=>")||this.expect("=>"),this.context.isBindingElement=!1,_=0;_<T.length;_++)this.reinterpretExpressionAsPattern(T[_]);S=!0,v={type:"ArrowParameterPlaceHolder",params:T,async:!1}}else T.push(this.inheritCoverGrammar(this.parseAssignmentExpression));if(S)break}S||(v=this.finalize(this.startNode(x),new d.SequenceExpression(T)))}if(!S){if(this.expect(")"),this.match("=>")&&(v.type===p.Syntax.Identifier&&v.name==="yield"&&(S=!0,v={type:"ArrowParameterPlaceHolder",params:[v],async:!1}),!S)){if(this.context.isBindingElement||this.throwUnexpectedToken(this.lookahead),v.type===p.Syntax.SequenceExpression)for(_=0;_<v.expressions.length;_++)this.reinterpretExpressionAsPattern(v.expressions[_]);else this.reinterpretExpressionAsPattern(v);v={type:"ArrowParameterPlaceHolder",params:v.type===p.Syntax.SequenceExpression?v.expressions:[v],async:!1}}this.context.isBindingElement=!1}}}return v},y.prototype.parseArguments=function(){this.expect("(");var v=[];if(!this.match(")"))for(;;){var x=this.match("...")?this.parseSpreadElement():this.isolateCoverGrammar(this.parseAssignmentExpression);if(v.push(x),this.match(")")||(this.expectCommaSeparator(),this.match(")")))break}return this.expect(")"),v},y.prototype.isIdentifierName=function(v){return v.type===3||v.type===4||v.type===1||v.type===5},y.prototype.parseIdentifierName=function(){var v=this.createNode(),x=this.nextToken();return this.isIdentifierName(x)||this.throwUnexpectedToken(x),this.finalize(v,new d.Identifier(x.value))},y.prototype.parseNewExpression=function(){var v,x=this.createNode(),w=this.parseIdentifierName();if(c.assert(w.name==="new","New expression must start with `new`"),this.match("."))if(this.nextToken(),this.lookahead.type===3&&this.context.inFunctionBody&&this.lookahead.value==="target"){var S=this.parseIdentifierName();v=new d.MetaProperty(w,S)}else this.throwUnexpectedToken(this.lookahead);else{var T=this.isolateCoverGrammar(this.parseLeftHandSideExpression),_=this.match("(")?this.parseArguments():[];v=new d.NewExpression(T,_),this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1}return this.finalize(x,v)},y.prototype.parseAsyncArgument=function(){var v=this.parseAssignmentExpression();return this.context.firstCoverInitializedNameError=null,v},y.prototype.parseAsyncArguments=function(){this.expect("(");var v=[];if(!this.match(")"))for(;;){var x=this.match("...")?this.parseSpreadElement():this.isolateCoverGrammar(this.parseAsyncArgument);if(v.push(x),this.match(")")||(this.expectCommaSeparator(),this.match(")")))break}return this.expect(")"),v},y.prototype.parseLeftHandSideExpressionAllowCall=function(){var v,x=this.lookahead,w=this.matchContextualKeyword("async"),S=this.context.allowIn;for(this.context.allowIn=!0,this.matchKeyword("super")&&this.context.inFunctionBody?(v=this.createNode(),this.nextToken(),v=this.finalize(v,new d.Super),this.match("(")||this.match(".")||this.match("[")||this.throwUnexpectedToken(this.lookahead)):v=this.inheritCoverGrammar(this.matchKeyword("new")?this.parseNewExpression:this.parsePrimaryExpression);;)if(this.match(".")){this.context.isBindingElement=!1,this.context.isAssignmentTarget=!0,this.expect(".");var T=this.parseIdentifierName();v=this.finalize(this.startNode(x),new d.StaticMemberExpression(v,T))}else if(this.match("(")){var _=w&&x.lineNumber===this.lookahead.lineNumber;this.context.isBindingElement=!1,this.context.isAssignmentTarget=!1;var D=_?this.parseAsyncArguments():this.parseArguments();if(v=this.finalize(this.startNode(x),new d.CallExpression(v,D)),_&&this.match("=>")){for(var I=0;I<D.length;++I)this.reinterpretExpressionAsPattern(D[I]);v={type:"ArrowParameterPlaceHolder",params:D,async:!0}}}else if(this.match("["))this.context.isBindingElement=!1,this.context.isAssignmentTarget=!0,this.expect("["),T=this.isolateCoverGrammar(this.parseExpression),this.expect("]"),v=this.finalize(this.startNode(x),new d.ComputedMemberExpression(v,T));else{if(this.lookahead.type!==10||!this.lookahead.head)break;var R=this.parseTemplateLiteral();v=this.finalize(this.startNode(x),new d.TaggedTemplateExpression(v,R))}return this.context.allowIn=S,v},y.prototype.parseSuper=function(){var v=this.createNode();return this.expectKeyword("super"),this.match("[")||this.match(".")||this.throwUnexpectedToken(this.lookahead),this.finalize(v,new d.Super)},y.prototype.parseLeftHandSideExpression=function(){c.assert(this.context.allowIn,"callee of new expression always allow in keyword.");for(var v=this.startNode(this.lookahead),x=this.matchKeyword("super")&&this.context.inFunctionBody?this.parseSuper():this.inheritCoverGrammar(this.matchKeyword("new")?this.parseNewExpression:this.parsePrimaryExpression);;)if(this.match("[")){this.context.isBindingElement=!1,this.context.isAssignmentTarget=!0,this.expect("[");var w=this.isolateCoverGrammar(this.parseExpression);this.expect("]"),x=this.finalize(v,new d.ComputedMemberExpression(x,w))}else if(this.match("."))this.context.isBindingElement=!1,this.context.isAssignmentTarget=!0,this.expect("."),w=this.parseIdentifierName(),x=this.finalize(v,new d.StaticMemberExpression(x,w));else{if(this.lookahead.type!==10||!this.lookahead.head)break;var S=this.parseTemplateLiteral();x=this.finalize(v,new d.TaggedTemplateExpression(x,S))}return x},y.prototype.parseUpdateExpression=function(){var v,x=this.lookahead;if(this.match("++")||this.match("--")){var w=this.startNode(x),S=this.nextToken();v=this.inheritCoverGrammar(this.parseUnaryExpression),this.context.strict&&v.type===p.Syntax.Identifier&&this.scanner.isRestrictedWord(v.name)&&this.tolerateError(u.Messages.StrictLHSPrefix),this.context.isAssignmentTarget||this.tolerateError(u.Messages.InvalidLHSInAssignment);var T=!0;v=this.finalize(w,new d.UpdateExpression(S.value,v,T)),this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1}else if(v=this.inheritCoverGrammar(this.parseLeftHandSideExpressionAllowCall),!this.hasLineTerminator&&this.lookahead.type===7&&(this.match("++")||this.match("--"))){this.context.strict&&v.type===p.Syntax.Identifier&&this.scanner.isRestrictedWord(v.name)&&this.tolerateError(u.Messages.StrictLHSPostfix),this.context.isAssignmentTarget||this.tolerateError(u.Messages.InvalidLHSInAssignment),this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1;var _=this.nextToken().value;T=!1,v=this.finalize(this.startNode(x),new d.UpdateExpression(_,v,T))}return v},y.prototype.parseAwaitExpression=function(){var v=this.createNode();this.nextToken();var x=this.parseUnaryExpression();return this.finalize(v,new d.AwaitExpression(x))},y.prototype.parseUnaryExpression=function(){var v;if(this.match("+")||this.match("-")||this.match("~")||this.match("!")||this.matchKeyword("delete")||this.matchKeyword("void")||this.matchKeyword("typeof")){var x=this.startNode(this.lookahead),w=this.nextToken();v=this.inheritCoverGrammar(this.parseUnaryExpression),v=this.finalize(x,new d.UnaryExpression(w.value,v)),this.context.strict&&v.operator==="delete"&&v.argument.type===p.Syntax.Identifier&&this.tolerateError(u.Messages.StrictDelete),this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1}else v=this.context.await&&this.matchContextualKeyword("await")?this.parseAwaitExpression():this.parseUpdateExpression();return v},y.prototype.parseExponentiationExpression=function(){var v=this.lookahead,x=this.inheritCoverGrammar(this.parseUnaryExpression);if(x.type!==p.Syntax.UnaryExpression&&this.match("**")){this.nextToken(),this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1;var w=x,S=this.isolateCoverGrammar(this.parseExponentiationExpression);x=this.finalize(this.startNode(v),new d.BinaryExpression("**",w,S))}return x},y.prototype.binaryPrecedence=function(v){var x=v.value;return v.type===7?this.operatorPrecedence[x]||0:v.type===4&&(x==="instanceof"||this.context.allowIn&&x==="in")?7:0},y.prototype.parseBinaryExpression=function(){var v=this.lookahead,x=this.inheritCoverGrammar(this.parseExponentiationExpression),w=this.lookahead,S=this.binaryPrecedence(w);if(S>0){this.nextToken(),this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1;for(var T=[v,this.lookahead],_=x,D=this.isolateCoverGrammar(this.parseExponentiationExpression),I=[_,w.value,D],R=[S];!((S=this.binaryPrecedence(this.lookahead))<=0);){for(;I.length>2&&S<=R[R.length-1];){D=I.pop();var M=I.pop();R.pop(),_=I.pop(),T.pop();var A=this.startNode(T[T.length-1]);I.push(this.finalize(A,new d.BinaryExpression(M,_,D)))}I.push(this.nextToken().value),R.push(S),T.push(this.lookahead),I.push(this.isolateCoverGrammar(this.parseExponentiationExpression))}var L=I.length-1;x=I[L];for(var P=T.pop();L>1;){var B=T.pop(),U=P&&P.lineStart;A=this.startNode(B,U),M=I[L-1],x=this.finalize(A,new d.BinaryExpression(M,I[L-2],x)),L-=2,P=B}}return x},y.prototype.parseConditionalExpression=function(){var v=this.lookahead,x=this.inheritCoverGrammar(this.parseBinaryExpression);if(this.match("?")){this.nextToken();var w=this.context.allowIn;this.context.allowIn=!0;var S=this.isolateCoverGrammar(this.parseAssignmentExpression);this.context.allowIn=w,this.expect(":");var T=this.isolateCoverGrammar(this.parseAssignmentExpression);x=this.finalize(this.startNode(v),new d.ConditionalExpression(x,S,T)),this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1}return x},y.prototype.checkPatternParam=function(v,x){switch(x.type){case p.Syntax.Identifier:this.validateParam(v,x,x.name);break;case p.Syntax.RestElement:this.checkPatternParam(v,x.argument);break;case p.Syntax.AssignmentPattern:this.checkPatternParam(v,x.left);break;case p.Syntax.ArrayPattern:for(var w=0;w<x.elements.length;w++)x.elements[w]!==null&&this.checkPatternParam(v,x.elements[w]);break;case p.Syntax.ObjectPattern:for(w=0;w<x.properties.length;w++)this.checkPatternParam(v,x.properties[w].value)}v.simple=v.simple&&x instanceof d.Identifier},y.prototype.reinterpretAsCoverFormalsList=function(v){var x,w=[v],S=!1;switch(v.type){case p.Syntax.Identifier:break;case"ArrowParameterPlaceHolder":w=v.params,S=v.async;break;default:return null}x={simple:!0,paramSet:{}};for(var T=0;T<w.length;++T)(_=w[T]).type===p.Syntax.AssignmentPattern?_.right.type===p.Syntax.YieldExpression&&(_.right.argument&&this.throwUnexpectedToken(this.lookahead),_.right.type=p.Syntax.Identifier,_.right.name="yield",delete _.right.argument,delete _.right.delegate):S&&_.type===p.Syntax.Identifier&&_.name==="await"&&this.throwUnexpectedToken(this.lookahead),this.checkPatternParam(x,_),w[T]=_;if(this.context.strict||!this.context.allowYield)for(T=0;T<w.length;++T){var _;(_=w[T]).type===p.Syntax.YieldExpression&&this.throwUnexpectedToken(this.lookahead)}if(x.message===u.Messages.StrictParamDupe){var D=this.context.strict?x.stricted:x.firstRestricted;this.throwUnexpectedToken(D,x.message)}return{simple:x.simple,params:w,stricted:x.stricted,firstRestricted:x.firstRestricted,message:x.message}},y.prototype.parseAssignmentExpression=function(){var v;if(!this.context.allowYield&&this.matchKeyword("yield"))v=this.parseYieldExpression();else{var x=this.lookahead,w=x;if(v=this.parseConditionalExpression(),w.type===3&&w.lineNumber===this.lookahead.lineNumber&&w.value==="async"&&(this.lookahead.type===3||this.matchKeyword("yield"))){var S=this.parsePrimaryExpression();this.reinterpretExpressionAsPattern(S),v={type:"ArrowParameterPlaceHolder",params:[S],async:!0}}if(v.type==="ArrowParameterPlaceHolder"||this.match("=>")){this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1;var T=v.async,_=this.reinterpretAsCoverFormalsList(v);if(_){this.hasLineTerminator&&this.tolerateUnexpectedToken(this.lookahead),this.context.firstCoverInitializedNameError=null;var D=this.context.strict,I=this.context.allowStrictDirective;this.context.allowStrictDirective=_.simple;var R=this.context.allowYield,M=this.context.await;this.context.allowYield=!0,this.context.await=T;var A=this.startNode(x);this.expect("=>");var L=void 0;if(this.match("{")){var P=this.context.allowIn;this.context.allowIn=!0,L=this.parseFunctionSourceElements(),this.context.allowIn=P}else L=this.isolateCoverGrammar(this.parseAssignmentExpression);var B=L.type!==p.Syntax.BlockStatement;this.context.strict&&_.firstRestricted&&this.throwUnexpectedToken(_.firstRestricted,_.message),this.context.strict&&_.stricted&&this.tolerateUnexpectedToken(_.stricted,_.message),v=T?this.finalize(A,new d.AsyncArrowFunctionExpression(_.params,L,B)):this.finalize(A,new d.ArrowFunctionExpression(_.params,L,B)),this.context.strict=D,this.context.allowStrictDirective=I,this.context.allowYield=R,this.context.await=M}}else if(this.matchAssign()){if(this.context.isAssignmentTarget||this.tolerateError(u.Messages.InvalidLHSInAssignment),this.context.strict&&v.type===p.Syntax.Identifier){var U=v;this.scanner.isRestrictedWord(U.name)&&this.tolerateUnexpectedToken(w,u.Messages.StrictLHSAssignment),this.scanner.isStrictModeReservedWord(U.name)&&this.tolerateUnexpectedToken(w,u.Messages.StrictReservedWord)}this.match("=")?this.reinterpretExpressionAsPattern(v):(this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1);var G=(w=this.nextToken()).value,F=this.isolateCoverGrammar(this.parseAssignmentExpression);v=this.finalize(this.startNode(x),new d.AssignmentExpression(G,v,F)),this.context.firstCoverInitializedNameError=null}}return v},y.prototype.parseExpression=function(){var v=this.lookahead,x=this.isolateCoverGrammar(this.parseAssignmentExpression);if(this.match(",")){var w=[];for(w.push(x);this.lookahead.type!==2&&this.match(",");)this.nextToken(),w.push(this.isolateCoverGrammar(this.parseAssignmentExpression));x=this.finalize(this.startNode(v),new d.SequenceExpression(w))}return x},y.prototype.parseStatementListItem=function(){var v;if(this.context.isAssignmentTarget=!0,this.context.isBindingElement=!0,this.lookahead.type===4)switch(this.lookahead.value){case"export":this.context.isModule||this.tolerateUnexpectedToken(this.lookahead,u.Messages.IllegalExportDeclaration),v=this.parseExportDeclaration();break;case"import":this.context.isModule||this.tolerateUnexpectedToken(this.lookahead,u.Messages.IllegalImportDeclaration),v=this.parseImportDeclaration();break;case"const":v=this.parseLexicalDeclaration({inFor:!1});break;case"function":v=this.parseFunctionDeclaration();break;case"class":v=this.parseClassDeclaration();break;case"let":v=this.isLexicalDeclaration()?this.parseLexicalDeclaration({inFor:!1}):this.parseStatement();break;default:v=this.parseStatement()}else v=this.parseStatement();return v},y.prototype.parseBlock=function(){var v=this.createNode();this.expect("{");for(var x=[];!this.match("}");)x.push(this.parseStatementListItem());return this.expect("}"),this.finalize(v,new d.BlockStatement(x))},y.prototype.parseLexicalBinding=function(v,x){var w=this.createNode(),S=this.parsePattern([],v);this.context.strict&&S.type===p.Syntax.Identifier&&this.scanner.isRestrictedWord(S.name)&&this.tolerateError(u.Messages.StrictVarName);var T=null;return v==="const"?this.matchKeyword("in")||this.matchContextualKeyword("of")||(this.match("=")?(this.nextToken(),T=this.isolateCoverGrammar(this.parseAssignmentExpression)):this.throwError(u.Messages.DeclarationMissingInitializer,"const")):(!x.inFor&&S.type!==p.Syntax.Identifier||this.match("="))&&(this.expect("="),T=this.isolateCoverGrammar(this.parseAssignmentExpression)),this.finalize(w,new d.VariableDeclarator(S,T))},y.prototype.parseBindingList=function(v,x){for(var w=[this.parseLexicalBinding(v,x)];this.match(",");)this.nextToken(),w.push(this.parseLexicalBinding(v,x));return w},y.prototype.isLexicalDeclaration=function(){var v=this.scanner.saveState();this.scanner.scanComments();var x=this.scanner.lex();return this.scanner.restoreState(v),x.type===3||x.type===7&&x.value==="["||x.type===7&&x.value==="{"||x.type===4&&x.value==="let"||x.type===4&&x.value==="yield"},y.prototype.parseLexicalDeclaration=function(v){var x=this.createNode(),w=this.nextToken().value;c.assert(w==="let"||w==="const","Lexical declaration must be either let or const");var S=this.parseBindingList(w,v);return this.consumeSemicolon(),this.finalize(x,new d.VariableDeclaration(S,w))},y.prototype.parseBindingRestElement=function(v,x){var w=this.createNode();this.expect("...");var S=this.parsePattern(v,x);return this.finalize(w,new d.RestElement(S))},y.prototype.parseArrayPattern=function(v,x){var w=this.createNode();this.expect("[");for(var S=[];!this.match("]");)if(this.match(","))this.nextToken(),S.push(null);else{if(this.match("...")){S.push(this.parseBindingRestElement(v,x));break}S.push(this.parsePatternWithDefault(v,x)),this.match("]")||this.expect(",")}return this.expect("]"),this.finalize(w,new d.ArrayPattern(S))},y.prototype.parsePropertyPattern=function(v,x){var w,S,T=this.createNode(),_=!1,D=!1;if(this.lookahead.type===3){var I=this.lookahead;w=this.parseVariableIdentifier();var R=this.finalize(T,new d.Identifier(I.value));if(this.match("=")){v.push(I),D=!0,this.nextToken();var M=this.parseAssignmentExpression();S=this.finalize(this.startNode(I),new d.AssignmentPattern(R,M))}else this.match(":")?(this.expect(":"),S=this.parsePatternWithDefault(v,x)):(v.push(I),D=!0,S=R)}else _=this.match("["),w=this.parseObjectPropertyKey(),this.expect(":"),S=this.parsePatternWithDefault(v,x);return this.finalize(T,new d.Property("init",w,_,S,!1,D))},y.prototype.parseObjectPattern=function(v,x){var w=this.createNode(),S=[];for(this.expect("{");!this.match("}");)S.push(this.parsePropertyPattern(v,x)),this.match("}")||this.expect(",");return this.expect("}"),this.finalize(w,new d.ObjectPattern(S))},y.prototype.parsePattern=function(v,x){var w;return this.match("[")?w=this.parseArrayPattern(v,x):this.match("{")?w=this.parseObjectPattern(v,x):(!this.matchKeyword("let")||x!=="const"&&x!=="let"||this.tolerateUnexpectedToken(this.lookahead,u.Messages.LetInLexicalBinding),v.push(this.lookahead),w=this.parseVariableIdentifier(x)),w},y.prototype.parsePatternWithDefault=function(v,x){var w=this.lookahead,S=this.parsePattern(v,x);if(this.match("=")){this.nextToken();var T=this.context.allowYield;this.context.allowYield=!0;var _=this.isolateCoverGrammar(this.parseAssignmentExpression);this.context.allowYield=T,S=this.finalize(this.startNode(w),new d.AssignmentPattern(S,_))}return S},y.prototype.parseVariableIdentifier=function(v){var x=this.createNode(),w=this.nextToken();return w.type===4&&w.value==="yield"?this.context.strict?this.tolerateUnexpectedToken(w,u.Messages.StrictReservedWord):this.context.allowYield||this.throwUnexpectedToken(w):w.type!==3?this.context.strict&&w.type===4&&this.scanner.isStrictModeReservedWord(w.value)?this.tolerateUnexpectedToken(w,u.Messages.StrictReservedWord):(this.context.strict||w.value!=="let"||v!=="var")&&this.throwUnexpectedToken(w):(this.context.isModule||this.context.await)&&w.type===3&&w.value==="await"&&this.tolerateUnexpectedToken(w),this.finalize(x,new d.Identifier(w.value))},y.prototype.parseVariableDeclaration=function(v){var x=this.createNode(),w=this.parsePattern([],"var");this.context.strict&&w.type===p.Syntax.Identifier&&this.scanner.isRestrictedWord(w.name)&&this.tolerateError(u.Messages.StrictVarName);var S=null;return this.match("=")?(this.nextToken(),S=this.isolateCoverGrammar(this.parseAssignmentExpression)):w.type===p.Syntax.Identifier||v.inFor||this.expect("="),this.finalize(x,new d.VariableDeclarator(w,S))},y.prototype.parseVariableDeclarationList=function(v){var x={inFor:v.inFor},w=[];for(w.push(this.parseVariableDeclaration(x));this.match(",");)this.nextToken(),w.push(this.parseVariableDeclaration(x));return w},y.prototype.parseVariableStatement=function(){var v=this.createNode();this.expectKeyword("var");var x=this.parseVariableDeclarationList({inFor:!1});return this.consumeSemicolon(),this.finalize(v,new d.VariableDeclaration(x,"var"))},y.prototype.parseEmptyStatement=function(){var v=this.createNode();return this.expect(";"),this.finalize(v,new d.EmptyStatement)},y.prototype.parseExpressionStatement=function(){var v=this.createNode(),x=this.parseExpression();return this.consumeSemicolon(),this.finalize(v,new d.ExpressionStatement(x))},y.prototype.parseIfClause=function(){return this.context.strict&&this.matchKeyword("function")&&this.tolerateError(u.Messages.StrictFunction),this.parseStatement()},y.prototype.parseIfStatement=function(){var v,x=this.createNode(),w=null;this.expectKeyword("if"),this.expect("(");var S=this.parseExpression();return!this.match(")")&&this.config.tolerant?(this.tolerateUnexpectedToken(this.nextToken()),v=this.finalize(this.createNode(),new d.EmptyStatement)):(this.expect(")"),v=this.parseIfClause(),this.matchKeyword("else")&&(this.nextToken(),w=this.parseIfClause())),this.finalize(x,new d.IfStatement(S,v,w))},y.prototype.parseDoWhileStatement=function(){var v=this.createNode();this.expectKeyword("do");var x=this.context.inIteration;this.context.inIteration=!0;var w=this.parseStatement();this.context.inIteration=x,this.expectKeyword("while"),this.expect("(");var S=this.parseExpression();return!this.match(")")&&this.config.tolerant?this.tolerateUnexpectedToken(this.nextToken()):(this.expect(")"),this.match(";")&&this.nextToken()),this.finalize(v,new d.DoWhileStatement(w,S))},y.prototype.parseWhileStatement=function(){var v,x=this.createNode();this.expectKeyword("while"),this.expect("(");var w=this.parseExpression();if(!this.match(")")&&this.config.tolerant)this.tolerateUnexpectedToken(this.nextToken()),v=this.finalize(this.createNode(),new d.EmptyStatement);else{this.expect(")");var S=this.context.inIteration;this.context.inIteration=!0,v=this.parseStatement(),this.context.inIteration=S}return this.finalize(x,new d.WhileStatement(w,v))},y.prototype.parseForStatement=function(){var v,x,w,S=null,T=null,_=null,D=!0,I=this.createNode();if(this.expectKeyword("for"),this.expect("("),this.match(";"))this.nextToken();else if(this.matchKeyword("var")){S=this.createNode(),this.nextToken();var R=this.context.allowIn;this.context.allowIn=!1;var M=this.parseVariableDeclarationList({inFor:!0});if(this.context.allowIn=R,M.length===1&&this.matchKeyword("in")){var A=M[0];A.init&&(A.id.type===p.Syntax.ArrayPattern||A.id.type===p.Syntax.ObjectPattern||this.context.strict)&&this.tolerateError(u.Messages.ForInOfLoopInitializer,"for-in"),S=this.finalize(S,new d.VariableDeclaration(M,"var")),this.nextToken(),v=S,x=this.parseExpression(),S=null}else M.length===1&&M[0].init===null&&this.matchContextualKeyword("of")?(S=this.finalize(S,new d.VariableDeclaration(M,"var")),this.nextToken(),v=S,x=this.parseAssignmentExpression(),S=null,D=!1):(S=this.finalize(S,new d.VariableDeclaration(M,"var")),this.expect(";"))}else if(this.matchKeyword("const")||this.matchKeyword("let")){S=this.createNode();var L=this.nextToken().value;this.context.strict||this.lookahead.value!=="in"?(R=this.context.allowIn,this.context.allowIn=!1,M=this.parseBindingList(L,{inFor:!0}),this.context.allowIn=R,M.length===1&&M[0].init===null&&this.matchKeyword("in")?(S=this.finalize(S,new d.VariableDeclaration(M,L)),this.nextToken(),v=S,x=this.parseExpression(),S=null):M.length===1&&M[0].init===null&&this.matchContextualKeyword("of")?(S=this.finalize(S,new d.VariableDeclaration(M,L)),this.nextToken(),v=S,x=this.parseAssignmentExpression(),S=null,D=!1):(this.consumeSemicolon(),S=this.finalize(S,new d.VariableDeclaration(M,L)))):(S=this.finalize(S,new d.Identifier(L)),this.nextToken(),v=S,x=this.parseExpression(),S=null)}else{var P=this.lookahead;if(R=this.context.allowIn,this.context.allowIn=!1,S=this.inheritCoverGrammar(this.parseAssignmentExpression),this.context.allowIn=R,this.matchKeyword("in"))this.context.isAssignmentTarget&&S.type!==p.Syntax.AssignmentExpression||this.tolerateError(u.Messages.InvalidLHSInForIn),this.nextToken(),this.reinterpretExpressionAsPattern(S),v=S,x=this.parseExpression(),S=null;else if(this.matchContextualKeyword("of"))this.context.isAssignmentTarget&&S.type!==p.Syntax.AssignmentExpression||this.tolerateError(u.Messages.InvalidLHSInForLoop),this.nextToken(),this.reinterpretExpressionAsPattern(S),v=S,x=this.parseAssignmentExpression(),S=null,D=!1;else{if(this.match(",")){for(var B=[S];this.match(",");)this.nextToken(),B.push(this.isolateCoverGrammar(this.parseAssignmentExpression));S=this.finalize(this.startNode(P),new d.SequenceExpression(B))}this.expect(";")}}if(v===void 0&&(this.match(";")||(T=this.parseExpression()),this.expect(";"),this.match(")")||(_=this.parseExpression())),!this.match(")")&&this.config.tolerant)this.tolerateUnexpectedToken(this.nextToken()),w=this.finalize(this.createNode(),new d.EmptyStatement);else{this.expect(")");var U=this.context.inIteration;this.context.inIteration=!0,w=this.isolateCoverGrammar(this.parseStatement),this.context.inIteration=U}return v===void 0?this.finalize(I,new d.ForStatement(S,T,_,w)):D?this.finalize(I,new d.ForInStatement(v,x,w)):this.finalize(I,new d.ForOfStatement(v,x,w))},y.prototype.parseContinueStatement=function(){var v=this.createNode();this.expectKeyword("continue");var x=null;if(this.lookahead.type===3&&!this.hasLineTerminator){var w=this.parseVariableIdentifier();x=w;var S="$"+w.name;Object.prototype.hasOwnProperty.call(this.context.labelSet,S)||this.throwError(u.Messages.UnknownLabel,w.name)}return this.consumeSemicolon(),x!==null||this.context.inIteration||this.throwError(u.Messages.IllegalContinue),this.finalize(v,new d.ContinueStatement(x))},y.prototype.parseBreakStatement=function(){var v=this.createNode();this.expectKeyword("break");var x=null;if(this.lookahead.type===3&&!this.hasLineTerminator){var w=this.parseVariableIdentifier(),S="$"+w.name;Object.prototype.hasOwnProperty.call(this.context.labelSet,S)||this.throwError(u.Messages.UnknownLabel,w.name),x=w}return this.consumeSemicolon(),x!==null||this.context.inIteration||this.context.inSwitch||this.throwError(u.Messages.IllegalBreak),this.finalize(v,new d.BreakStatement(x))},y.prototype.parseReturnStatement=function(){this.context.inFunctionBody||this.tolerateError(u.Messages.IllegalReturn);var v=this.createNode();this.expectKeyword("return");var x=(this.match(";")||this.match("}")||this.hasLineTerminator||this.lookahead.type===2)&&this.lookahead.type!==8&&this.lookahead.type!==10?null:this.parseExpression();return this.consumeSemicolon(),this.finalize(v,new d.ReturnStatement(x))},y.prototype.parseWithStatement=function(){this.context.strict&&this.tolerateError(u.Messages.StrictModeWith);var v,x=this.createNode();this.expectKeyword("with"),this.expect("(");var w=this.parseExpression();return!this.match(")")&&this.config.tolerant?(this.tolerateUnexpectedToken(this.nextToken()),v=this.finalize(this.createNode(),new d.EmptyStatement)):(this.expect(")"),v=this.parseStatement()),this.finalize(x,new d.WithStatement(w,v))},y.prototype.parseSwitchCase=function(){var v,x=this.createNode();this.matchKeyword("default")?(this.nextToken(),v=null):(this.expectKeyword("case"),v=this.parseExpression()),this.expect(":");for(var w=[];!(this.match("}")||this.matchKeyword("default")||this.matchKeyword("case"));)w.push(this.parseStatementListItem());return this.finalize(x,new d.SwitchCase(v,w))},y.prototype.parseSwitchStatement=function(){var v=this.createNode();this.expectKeyword("switch"),this.expect("(");var x=this.parseExpression();this.expect(")");var w=this.context.inSwitch;this.context.inSwitch=!0;var S=[],T=!1;for(this.expect("{");!this.match("}");){var _=this.parseSwitchCase();_.test===null&&(T&&this.throwError(u.Messages.MultipleDefaultsInSwitch),T=!0),S.push(_)}return this.expect("}"),this.context.inSwitch=w,this.finalize(v,new d.SwitchStatement(x,S))},y.prototype.parseLabelledStatement=function(){var v,x=this.createNode(),w=this.parseExpression();if(w.type===p.Syntax.Identifier&&this.match(":")){this.nextToken();var S=w,T="$"+S.name;Object.prototype.hasOwnProperty.call(this.context.labelSet,T)&&this.throwError(u.Messages.Redeclaration,"Label",S.name),this.context.labelSet[T]=!0;var _=void 0;if(this.matchKeyword("class"))this.tolerateUnexpectedToken(this.lookahead),_=this.parseClassDeclaration();else if(this.matchKeyword("function")){var D=this.lookahead,I=this.parseFunctionDeclaration();this.context.strict?this.tolerateUnexpectedToken(D,u.Messages.StrictFunction):I.generator&&this.tolerateUnexpectedToken(D,u.Messages.GeneratorInLegacyContext),_=I}else _=this.parseStatement();delete this.context.labelSet[T],v=new d.LabeledStatement(S,_)}else this.consumeSemicolon(),v=new d.ExpressionStatement(w);return this.finalize(x,v)},y.prototype.parseThrowStatement=function(){var v=this.createNode();this.expectKeyword("throw"),this.hasLineTerminator&&this.throwError(u.Messages.NewlineAfterThrow);var x=this.parseExpression();return this.consumeSemicolon(),this.finalize(v,new d.ThrowStatement(x))},y.prototype.parseCatchClause=function(){var v=this.createNode();this.expectKeyword("catch"),this.expect("("),this.match(")")&&this.throwUnexpectedToken(this.lookahead);for(var x=[],w=this.parsePattern(x),S={},T=0;T<x.length;T++){var _="$"+x[T].value;Object.prototype.hasOwnProperty.call(S,_)&&this.tolerateError(u.Messages.DuplicateBinding,x[T].value),S[_]=!0}this.context.strict&&w.type===p.Syntax.Identifier&&this.scanner.isRestrictedWord(w.name)&&this.tolerateError(u.Messages.StrictCatchVariable),this.expect(")");var D=this.parseBlock();return this.finalize(v,new d.CatchClause(w,D))},y.prototype.parseFinallyClause=function(){return this.expectKeyword("finally"),this.parseBlock()},y.prototype.parseTryStatement=function(){var v=this.createNode();this.expectKeyword("try");var x=this.parseBlock(),w=this.matchKeyword("catch")?this.parseCatchClause():null,S=this.matchKeyword("finally")?this.parseFinallyClause():null;return w||S||this.throwError(u.Messages.NoCatchOrFinally),this.finalize(v,new d.TryStatement(x,w,S))},y.prototype.parseDebuggerStatement=function(){var v=this.createNode();return this.expectKeyword("debugger"),this.consumeSemicolon(),this.finalize(v,new d.DebuggerStatement)},y.prototype.parseStatement=function(){var v;switch(this.lookahead.type){case 1:case 5:case 6:case 8:case 10:case 9:v=this.parseExpressionStatement();break;case 7:var x=this.lookahead.value;v=x==="{"?this.parseBlock():x==="("?this.parseExpressionStatement():x===";"?this.parseEmptyStatement():this.parseExpressionStatement();break;case 3:v=this.matchAsyncFunction()?this.parseFunctionDeclaration():this.parseLabelledStatement();break;case 4:switch(this.lookahead.value){case"break":v=this.parseBreakStatement();break;case"continue":v=this.parseContinueStatement();break;case"debugger":v=this.parseDebuggerStatement();break;case"do":v=this.parseDoWhileStatement();break;case"for":v=this.parseForStatement();break;case"function":v=this.parseFunctionDeclaration();break;case"if":v=this.parseIfStatement();break;case"return":v=this.parseReturnStatement();break;case"switch":v=this.parseSwitchStatement();break;case"throw":v=this.parseThrowStatement();break;case"try":v=this.parseTryStatement();break;case"var":v=this.parseVariableStatement();break;case"while":v=this.parseWhileStatement();break;case"with":v=this.parseWithStatement();break;default:v=this.parseExpressionStatement()}break;default:v=this.throwUnexpectedToken(this.lookahead)}return v},y.prototype.parseFunctionSourceElements=function(){var v=this.createNode();this.expect("{");var x=this.parseDirectivePrologues(),w=this.context.labelSet,S=this.context.inIteration,T=this.context.inSwitch,_=this.context.inFunctionBody;for(this.context.labelSet={},this.context.inIteration=!1,this.context.inSwitch=!1,this.context.inFunctionBody=!0;this.lookahead.type!==2&&!this.match("}");)x.push(this.parseStatementListItem());return this.expect("}"),this.context.labelSet=w,this.context.inIteration=S,this.context.inSwitch=T,this.context.inFunctionBody=_,this.finalize(v,new d.BlockStatement(x))},y.prototype.validateParam=function(v,x,w){var S="$"+w;this.context.strict?(this.scanner.isRestrictedWord(w)&&(v.stricted=x,v.message=u.Messages.StrictParamName),Object.prototype.hasOwnProperty.call(v.paramSet,S)&&(v.stricted=x,v.message=u.Messages.StrictParamDupe)):v.firstRestricted||(this.scanner.isRestrictedWord(w)?(v.firstRestricted=x,v.message=u.Messages.StrictParamName):this.scanner.isStrictModeReservedWord(w)?(v.firstRestricted=x,v.message=u.Messages.StrictReservedWord):Object.prototype.hasOwnProperty.call(v.paramSet,S)&&(v.stricted=x,v.message=u.Messages.StrictParamDupe)),typeof Object.defineProperty=="function"?Object.defineProperty(v.paramSet,S,{value:!0,enumerable:!0,writable:!0,configurable:!0}):v.paramSet[S]=!0},y.prototype.parseRestElement=function(v){var x=this.createNode();this.expect("...");var w=this.parsePattern(v);return this.match("=")&&this.throwError(u.Messages.DefaultRestParameter),this.match(")")||this.throwError(u.Messages.ParameterAfterRestParameter),this.finalize(x,new d.RestElement(w))},y.prototype.parseFormalParameter=function(v){for(var x=[],w=this.match("...")?this.parseRestElement(x):this.parsePatternWithDefault(x),S=0;S<x.length;S++)this.validateParam(v,x[S],x[S].value);v.simple=v.simple&&w instanceof d.Identifier,v.params.push(w)},y.prototype.parseFormalParameters=function(v){var x;if(x={simple:!0,params:[],firstRestricted:v},this.expect("("),!this.match(")"))for(x.paramSet={};this.lookahead.type!==2&&(this.parseFormalParameter(x),!this.match(")"))&&(this.expect(","),!this.match(")")););return this.expect(")"),{simple:x.simple,params:x.params,stricted:x.stricted,firstRestricted:x.firstRestricted,message:x.message}},y.prototype.matchAsyncFunction=function(){var v=this.matchContextualKeyword("async");if(v){var x=this.scanner.saveState();this.scanner.scanComments();var w=this.scanner.lex();this.scanner.restoreState(x),v=x.lineNumber===w.lineNumber&&w.type===4&&w.value==="function"}return v},y.prototype.parseFunctionDeclaration=function(v){var x=this.createNode(),w=this.matchContextualKeyword("async");w&&this.nextToken(),this.expectKeyword("function");var S,T=!w&&this.match("*");T&&this.nextToken();var _=null,D=null;if(!v||!this.match("(")){var I=this.lookahead;_=this.parseVariableIdentifier(),this.context.strict?this.scanner.isRestrictedWord(I.value)&&this.tolerateUnexpectedToken(I,u.Messages.StrictFunctionName):this.scanner.isRestrictedWord(I.value)?(D=I,S=u.Messages.StrictFunctionName):this.scanner.isStrictModeReservedWord(I.value)&&(D=I,S=u.Messages.StrictReservedWord)}var R=this.context.await,M=this.context.allowYield;this.context.await=w,this.context.allowYield=!T;var A=this.parseFormalParameters(D),L=A.params,P=A.stricted;D=A.firstRestricted,A.message&&(S=A.message);var B=this.context.strict,U=this.context.allowStrictDirective;this.context.allowStrictDirective=A.simple;var G=this.parseFunctionSourceElements();return this.context.strict&&D&&this.throwUnexpectedToken(D,S),this.context.strict&&P&&this.tolerateUnexpectedToken(P,S),this.context.strict=B,this.context.allowStrictDirective=U,this.context.await=R,this.context.allowYield=M,w?this.finalize(x,new d.AsyncFunctionDeclaration(_,L,G)):this.finalize(x,new d.FunctionDeclaration(_,L,G,T))},y.prototype.parseFunctionExpression=function(){var v=this.createNode(),x=this.matchContextualKeyword("async");x&&this.nextToken(),this.expectKeyword("function");var w,S=!x&&this.match("*");S&&this.nextToken();var T,_=null,D=this.context.await,I=this.context.allowYield;if(this.context.await=x,this.context.allowYield=!S,!this.match("(")){var R=this.lookahead;_=this.context.strict||S||!this.matchKeyword("yield")?this.parseVariableIdentifier():this.parseIdentifierName(),this.context.strict?this.scanner.isRestrictedWord(R.value)&&this.tolerateUnexpectedToken(R,u.Messages.StrictFunctionName):this.scanner.isRestrictedWord(R.value)?(T=R,w=u.Messages.StrictFunctionName):this.scanner.isStrictModeReservedWord(R.value)&&(T=R,w=u.Messages.StrictReservedWord)}var M=this.parseFormalParameters(T),A=M.params,L=M.stricted;T=M.firstRestricted,M.message&&(w=M.message);var P=this.context.strict,B=this.context.allowStrictDirective;this.context.allowStrictDirective=M.simple;var U=this.parseFunctionSourceElements();return this.context.strict&&T&&this.throwUnexpectedToken(T,w),this.context.strict&&L&&this.tolerateUnexpectedToken(L,w),this.context.strict=P,this.context.allowStrictDirective=B,this.context.await=D,this.context.allowYield=I,x?this.finalize(v,new d.AsyncFunctionExpression(_,A,U)):this.finalize(v,new d.FunctionExpression(_,A,U,S))},y.prototype.parseDirective=function(){var v=this.lookahead,x=this.createNode(),w=this.parseExpression(),S=w.type===p.Syntax.Literal?this.getTokenRaw(v).slice(1,-1):null;return this.consumeSemicolon(),this.finalize(x,S?new d.Directive(w,S):new d.ExpressionStatement(w))},y.prototype.parseDirectivePrologues=function(){for(var v=null,x=[];;){var w=this.lookahead;if(w.type!==8)break;var S=this.parseDirective();x.push(S);var T=S.directive;if(typeof T!="string")break;T==="use strict"?(this.context.strict=!0,v&&this.tolerateUnexpectedToken(v,u.Messages.StrictOctalLiteral),this.context.allowStrictDirective||this.tolerateUnexpectedToken(w,u.Messages.IllegalLanguageModeDirective)):!v&&w.octal&&(v=w)}return x},y.prototype.qualifiedPropertyName=function(v){switch(v.type){case 3:case 8:case 1:case 5:case 6:case 4:return!0;case 7:return v.value==="["}return!1},y.prototype.parseGetterMethod=function(){var v=this.createNode(),x=this.context.allowYield;this.context.allowYield=!0;var w=this.parseFormalParameters();w.params.length>0&&this.tolerateError(u.Messages.BadGetterArity);var S=this.parsePropertyMethod(w);return this.context.allowYield=x,this.finalize(v,new d.FunctionExpression(null,w.params,S,!1))},y.prototype.parseSetterMethod=function(){var v=this.createNode(),x=this.context.allowYield;this.context.allowYield=!0;var w=this.parseFormalParameters();w.params.length!==1?this.tolerateError(u.Messages.BadSetterArity):w.params[0]instanceof d.RestElement&&this.tolerateError(u.Messages.BadSetterRestParameter);var S=this.parsePropertyMethod(w);return this.context.allowYield=x,this.finalize(v,new d.FunctionExpression(null,w.params,S,!1))},y.prototype.parseGeneratorMethod=function(){var v=this.createNode(),x=this.context.allowYield;this.context.allowYield=!0;var w=this.parseFormalParameters();this.context.allowYield=!1;var S=this.parsePropertyMethod(w);return this.context.allowYield=x,this.finalize(v,new d.FunctionExpression(null,w.params,S,!0))},y.prototype.isStartOfExpression=function(){var v=!0,x=this.lookahead.value;switch(this.lookahead.type){case 7:v=x==="["||x==="("||x==="{"||x==="+"||x==="-"||x==="!"||x==="~"||x==="++"||x==="--"||x==="/"||x==="/=";break;case 4:v=x==="class"||x==="delete"||x==="function"||x==="let"||x==="new"||x==="super"||x==="this"||x==="typeof"||x==="void"||x==="yield"}return v},y.prototype.parseYieldExpression=function(){var v=this.createNode();this.expectKeyword("yield");var x=null,w=!1;if(!this.hasLineTerminator){var S=this.context.allowYield;this.context.allowYield=!1,(w=this.match("*"))?(this.nextToken(),x=this.parseAssignmentExpression()):this.isStartOfExpression()&&(x=this.parseAssignmentExpression()),this.context.allowYield=S}return this.finalize(v,new d.YieldExpression(x,w))},y.prototype.parseClassElement=function(v){var x=this.lookahead,w=this.createNode(),S="",T=null,_=null,D=!1,I=!1,R=!1,M=!1;if(this.match("*"))this.nextToken();else if(D=this.match("["),(T=this.parseObjectPropertyKey()).name==="static"&&(this.qualifiedPropertyName(this.lookahead)||this.match("*"))&&(x=this.lookahead,R=!0,D=this.match("["),this.match("*")?this.nextToken():T=this.parseObjectPropertyKey()),x.type===3&&!this.hasLineTerminator&&x.value==="async"){var A=this.lookahead.value;A!==":"&&A!=="("&&A!=="*"&&(M=!0,x=this.lookahead,T=this.parseObjectPropertyKey(),x.type===3&&x.value==="constructor"&&this.tolerateUnexpectedToken(x,u.Messages.ConstructorIsAsync))}var L=this.qualifiedPropertyName(this.lookahead);return x.type===3?x.value==="get"&&L?(S="get",D=this.match("["),T=this.parseObjectPropertyKey(),this.context.allowYield=!1,_=this.parseGetterMethod()):x.value==="set"&&L&&(S="set",D=this.match("["),T=this.parseObjectPropertyKey(),_=this.parseSetterMethod()):x.type===7&&x.value==="*"&&L&&(S="init",D=this.match("["),T=this.parseObjectPropertyKey(),_=this.parseGeneratorMethod(),I=!0),!S&&T&&this.match("(")&&(S="init",_=M?this.parsePropertyMethodAsyncFunction():this.parsePropertyMethodFunction(),I=!0),S||this.throwUnexpectedToken(this.lookahead),S==="init"&&(S="method"),D||(R&&this.isPropertyKey(T,"prototype")&&this.throwUnexpectedToken(x,u.Messages.StaticPrototype),!R&&this.isPropertyKey(T,"constructor")&&((S!=="method"||!I||_&&_.generator)&&this.throwUnexpectedToken(x,u.Messages.ConstructorSpecialMethod),v.value?this.throwUnexpectedToken(x,u.Messages.DuplicateConstructor):v.value=!0,S="constructor")),this.finalize(w,new d.MethodDefinition(T,D,_,S,R))},y.prototype.parseClassElementList=function(){var v=[],x={value:!1};for(this.expect("{");!this.match("}");)this.match(";")?this.nextToken():v.push(this.parseClassElement(x));return this.expect("}"),v},y.prototype.parseClassBody=function(){var v=this.createNode(),x=this.parseClassElementList();return this.finalize(v,new d.ClassBody(x))},y.prototype.parseClassDeclaration=function(v){var x=this.createNode(),w=this.context.strict;this.context.strict=!0,this.expectKeyword("class");var S=v&&this.lookahead.type!==3?null:this.parseVariableIdentifier(),T=null;this.matchKeyword("extends")&&(this.nextToken(),T=this.isolateCoverGrammar(this.parseLeftHandSideExpressionAllowCall));var _=this.parseClassBody();return this.context.strict=w,this.finalize(x,new d.ClassDeclaration(S,T,_))},y.prototype.parseClassExpression=function(){var v=this.createNode(),x=this.context.strict;this.context.strict=!0,this.expectKeyword("class");var w=this.lookahead.type===3?this.parseVariableIdentifier():null,S=null;this.matchKeyword("extends")&&(this.nextToken(),S=this.isolateCoverGrammar(this.parseLeftHandSideExpressionAllowCall));var T=this.parseClassBody();return this.context.strict=x,this.finalize(v,new d.ClassExpression(w,S,T))},y.prototype.parseModule=function(){this.context.strict=!0,this.context.isModule=!0,this.scanner.isModule=!0;for(var v=this.createNode(),x=this.parseDirectivePrologues();this.lookahead.type!==2;)x.push(this.parseStatementListItem());return this.finalize(v,new d.Module(x))},y.prototype.parseScript=function(){for(var v=this.createNode(),x=this.parseDirectivePrologues();this.lookahead.type!==2;)x.push(this.parseStatementListItem());return this.finalize(v,new d.Script(x))},y.prototype.parseModuleSpecifier=function(){var v=this.createNode();this.lookahead.type!==8&&this.throwError(u.Messages.InvalidModuleSpecifier);var x=this.nextToken(),w=this.getTokenRaw(x);return this.finalize(v,new d.Literal(x.value,w))},y.prototype.parseImportSpecifier=function(){var v,x,w=this.createNode();return this.lookahead.type===3?(x=v=this.parseVariableIdentifier(),this.matchContextualKeyword("as")&&(this.nextToken(),x=this.parseVariableIdentifier())):(x=v=this.parseIdentifierName(),this.matchContextualKeyword("as")?(this.nextToken(),x=this.parseVariableIdentifier()):this.throwUnexpectedToken(this.nextToken())),this.finalize(w,new d.ImportSpecifier(x,v))},y.prototype.parseNamedImports=function(){this.expect("{");for(var v=[];!this.match("}");)v.push(this.parseImportSpecifier()),this.match("}")||this.expect(",");return this.expect("}"),v},y.prototype.parseImportDefaultSpecifier=function(){var v=this.createNode(),x=this.parseIdentifierName();return this.finalize(v,new d.ImportDefaultSpecifier(x))},y.prototype.parseImportNamespaceSpecifier=function(){var v=this.createNode();this.expect("*"),this.matchContextualKeyword("as")||this.throwError(u.Messages.NoAsAfterImportNamespace),this.nextToken();var x=this.parseIdentifierName();return this.finalize(v,new d.ImportNamespaceSpecifier(x))},y.prototype.parseImportDeclaration=function(){this.context.inFunctionBody&&this.throwError(u.Messages.IllegalImportDeclaration);var v,x=this.createNode();this.expectKeyword("import");var w=[];if(this.lookahead.type===8)v=this.parseModuleSpecifier();else{if(this.match("{")?w=w.concat(this.parseNamedImports()):this.match("*")?w.push(this.parseImportNamespaceSpecifier()):this.isIdentifierName(this.lookahead)&&!this.matchKeyword("default")?(w.push(this.parseImportDefaultSpecifier()),this.match(",")&&(this.nextToken(),this.match("*")?w.push(this.parseImportNamespaceSpecifier()):this.match("{")?w=w.concat(this.parseNamedImports()):this.throwUnexpectedToken(this.lookahead))):this.throwUnexpectedToken(this.nextToken()),!this.matchContextualKeyword("from")){var S=this.lookahead.value?u.Messages.UnexpectedToken:u.Messages.MissingFromClause;this.throwError(S,this.lookahead.value)}this.nextToken(),v=this.parseModuleSpecifier()}return this.consumeSemicolon(),this.finalize(x,new d.ImportDeclaration(w,v))},y.prototype.parseExportSpecifier=function(){var v=this.createNode(),x=this.parseIdentifierName(),w=x;return this.matchContextualKeyword("as")&&(this.nextToken(),w=this.parseIdentifierName()),this.finalize(v,new d.ExportSpecifier(x,w))},y.prototype.parseExportDeclaration=function(){this.context.inFunctionBody&&this.throwError(u.Messages.IllegalExportDeclaration);var v,x=this.createNode();if(this.expectKeyword("export"),this.matchKeyword("default"))if(this.nextToken(),this.matchKeyword("function")){var w=this.parseFunctionDeclaration(!0);v=this.finalize(x,new d.ExportDefaultDeclaration(w))}else this.matchKeyword("class")?(w=this.parseClassDeclaration(!0),v=this.finalize(x,new d.ExportDefaultDeclaration(w))):this.matchContextualKeyword("async")?(w=this.matchAsyncFunction()?this.parseFunctionDeclaration(!0):this.parseAssignmentExpression(),v=this.finalize(x,new d.ExportDefaultDeclaration(w))):(this.matchContextualKeyword("from")&&this.throwError(u.Messages.UnexpectedToken,this.lookahead.value),w=this.match("{")?this.parseObjectInitializer():this.match("[")?this.parseArrayInitializer():this.parseAssignmentExpression(),this.consumeSemicolon(),v=this.finalize(x,new d.ExportDefaultDeclaration(w)));else if(this.match("*")){if(this.nextToken(),!this.matchContextualKeyword("from")){var S=this.lookahead.value?u.Messages.UnexpectedToken:u.Messages.MissingFromClause;this.throwError(S,this.lookahead.value)}this.nextToken();var T=this.parseModuleSpecifier();this.consumeSemicolon(),v=this.finalize(x,new d.ExportAllDeclaration(T))}else if(this.lookahead.type===4){switch(w=void 0,this.lookahead.value){case"let":case"const":w=this.parseLexicalDeclaration({inFor:!1});break;case"var":case"class":case"function":w=this.parseStatementListItem();break;default:this.throwUnexpectedToken(this.lookahead)}v=this.finalize(x,new d.ExportNamedDeclaration(w,[],null))}else if(this.matchAsyncFunction())w=this.parseFunctionDeclaration(),v=this.finalize(x,new d.ExportNamedDeclaration(w,[],null));else{var _=[],D=null,I=!1;for(this.expect("{");!this.match("}");)I=I||this.matchKeyword("default"),_.push(this.parseExportSpecifier()),this.match("}")||this.expect(",");this.expect("}"),this.matchContextualKeyword("from")?(this.nextToken(),D=this.parseModuleSpecifier(),this.consumeSemicolon()):I?(S=this.lookahead.value?u.Messages.UnexpectedToken:u.Messages.MissingFromClause,this.throwError(S,this.lookahead.value)):this.consumeSemicolon(),v=this.finalize(x,new d.ExportNamedDeclaration(null,_,D))}return v},y})();s.Parser=m},function(o,s){Object.defineProperty(s,"__esModule",{value:!0}),s.assert=function(l,c){if(!l)throw new Error("ASSERT: "+c)}},function(o,s){Object.defineProperty(s,"__esModule",{value:!0});var l=(function(){function c(){this.errors=[],this.tolerant=!1}return c.prototype.recordError=function(f){this.errors.push(f)},c.prototype.tolerate=function(f){if(!this.tolerant)throw f;this.recordError(f)},c.prototype.constructError=function(f,u){var d=new Error(f);try{throw d}catch(h){Object.create&&Object.defineProperty&&(d=Object.create(h),Object.defineProperty(d,"column",{value:u}))}return d},c.prototype.createError=function(f,u,d,h){var p="Line "+u+": "+h,g=this.constructError(p,d);return g.index=f,g.lineNumber=u,g.description=h,g},c.prototype.throwError=function(f,u,d,h){throw this.createError(f,u,d,h)},c.prototype.tolerateError=function(f,u,d,h){var p=this.createError(f,u,d,h);if(!this.tolerant)throw p;this.recordError(p)},c})();s.ErrorHandler=l},function(o,s){Object.defineProperty(s,"__esModule",{value:!0}),s.Messages={BadGetterArity:"Getter must not have any formal parameters",BadSetterArity:"Setter must have exactly one formal parameter",BadSetterRestParameter:"Setter function argument must not be a rest parameter",ConstructorIsAsync:"Class constructor may not be an async method",ConstructorSpecialMethod:"Class constructor may not be an accessor",DeclarationMissingInitializer:"Missing initializer in %0 declaration",DefaultRestParameter:"Unexpected token =",DuplicateBinding:"Duplicate binding %0",DuplicateConstructor:"A class may only have one constructor",DuplicateProtoProperty:"Duplicate __proto__ fields are not allowed in object literals",ForInOfLoopInitializer:"%0 loop variable declaration may not have an initializer",GeneratorInLegacyContext:"Generator declarations are not allowed in legacy contexts",IllegalBreak:"Illegal break statement",IllegalContinue:"Illegal continue statement",IllegalExportDeclaration:"Unexpected token",IllegalImportDeclaration:"Unexpected token",IllegalLanguageModeDirective:"Illegal 'use strict' directive in function with non-simple parameter list",IllegalReturn:"Illegal return statement",InvalidEscapedReservedWord:"Keyword must not contain escaped characters",InvalidHexEscapeSequence:"Invalid hexadecimal escape sequence",InvalidLHSInAssignment:"Invalid left-hand side in assignment",InvalidLHSInForIn:"Invalid left-hand side in for-in",InvalidLHSInForLoop:"Invalid left-hand side in for-loop",InvalidModuleSpecifier:"Unexpected token",InvalidRegExp:"Invalid regular expression",LetInLexicalBinding:"let is disallowed as a lexically bound name",MissingFromClause:"Unexpected token",MultipleDefaultsInSwitch:"More than one default clause in switch statement",NewlineAfterThrow:"Illegal newline after throw",NoAsAfterImportNamespace:"Unexpected token",NoCatchOrFinally:"Missing catch or finally after try",ParameterAfterRestParameter:"Rest parameter must be last formal parameter",Redeclaration:"%0 '%1' has already been declared",StaticPrototype:"Classes may not have static property named prototype",StrictCatchVariable:"Catch variable may not be eval or arguments in strict mode",StrictDelete:"Delete of an unqualified identifier in strict mode.",StrictFunction:"In strict mode code, functions can only be declared at top level or inside a block",StrictFunctionName:"Function name may not be eval or arguments in strict mode",StrictLHSAssignment:"Assignment to eval or arguments is not allowed in strict mode",StrictLHSPostfix:"Postfix increment/decrement may not have eval or arguments operand in strict mode",StrictLHSPrefix:"Prefix increment/decrement may not have eval or arguments operand in strict mode",StrictModeWith:"Strict mode code may not include a with statement",StrictOctalLiteral:"Octal literals are not allowed in strict mode.",StrictParamDupe:"Strict mode function may not have duplicate parameter names",StrictParamName:"Parameter name eval or arguments is not allowed in strict mode",StrictReservedWord:"Use of future reserved word in strict mode",StrictVarName:"Variable name may not be eval or arguments in strict mode",TemplateOctalLiteral:"Octal literals are not allowed in template strings.",UnexpectedEOS:"Unexpected end of input",UnexpectedIdentifier:"Unexpected identifier",UnexpectedNumber:"Unexpected number",UnexpectedReserved:"Unexpected reserved word",UnexpectedString:"Unexpected string",UnexpectedTemplate:"Unexpected quasi %0",UnexpectedToken:"Unexpected token %0",UnexpectedTokenIllegal:"Unexpected token ILLEGAL",UnknownLabel:"Undefined label '%0'",UnterminatedRegExp:"Invalid regular expression: missing /"}},function(o,s,l){Object.defineProperty(s,"__esModule",{value:!0});var c=l(9),f=l(4),u=l(11);function d(g){return"0123456789abcdef".indexOf(g.toLowerCase())}function h(g){return"01234567".indexOf(g)}var p=(function(){function g(m,y){this.source=m,this.errorHandler=y,this.trackComment=!1,this.isModule=!1,this.length=m.length,this.index=0,this.lineNumber=m.length>0?1:0,this.lineStart=0,this.curlyStack=[]}return g.prototype.saveState=function(){return{index:this.index,lineNumber:this.lineNumber,lineStart:this.lineStart}},g.prototype.restoreState=function(m){this.index=m.index,this.lineNumber=m.lineNumber,this.lineStart=m.lineStart},g.prototype.eof=function(){return this.index>=this.length},g.prototype.throwUnexpectedToken=function(m){return m===void 0&&(m=u.Messages.UnexpectedTokenIllegal),this.errorHandler.throwError(this.index,this.lineNumber,this.index-this.lineStart+1,m)},g.prototype.tolerateUnexpectedToken=function(m){m===void 0&&(m=u.Messages.UnexpectedTokenIllegal),this.errorHandler.tolerateError(this.index,this.lineNumber,this.index-this.lineStart+1,m)},g.prototype.skipSingleLineComment=function(m){var y,v,x=[];for(this.trackComment&&(x=[],y=this.index-m,v={start:{line:this.lineNumber,column:this.index-this.lineStart-m},end:{}});!this.eof();){var w=this.source.charCodeAt(this.index);if(++this.index,f.Character.isLineTerminator(w)){if(this.trackComment){v.end={line:this.lineNumber,column:this.index-this.lineStart-1};var S={multiLine:!1,slice:[y+m,this.index-1],range:[y,this.index-1],loc:v};x.push(S)}return w===13&&this.source.charCodeAt(this.index)===10&&++this.index,++this.lineNumber,this.lineStart=this.index,x}}return this.trackComment&&(v.end={line:this.lineNumber,column:this.index-this.lineStart},S={multiLine:!1,slice:[y+m,this.index],range:[y,this.index],loc:v},x.push(S)),x},g.prototype.skipMultiLineComment=function(){var m,y,v=[];for(this.trackComment&&(v=[],m=this.index-2,y={start:{line:this.lineNumber,column:this.index-this.lineStart-2},end:{}});!this.eof();){var x=this.source.charCodeAt(this.index);if(f.Character.isLineTerminator(x))x===13&&this.source.charCodeAt(this.index+1)===10&&++this.index,++this.lineNumber,++this.index,this.lineStart=this.index;else if(x===42){if(this.source.charCodeAt(this.index+1)===47){if(this.index+=2,this.trackComment){y.end={line:this.lineNumber,column:this.index-this.lineStart};var w={multiLine:!0,slice:[m+2,this.index-2],range:[m,this.index],loc:y};v.push(w)}return v}++this.index}else++this.index}return this.trackComment&&(y.end={line:this.lineNumber,column:this.index-this.lineStart},w={multiLine:!0,slice:[m+2,this.index],range:[m,this.index],loc:y},v.push(w)),this.tolerateUnexpectedToken(),v},g.prototype.scanComments=function(){var m;this.trackComment&&(m=[]);for(var y=this.index===0;!this.eof();){var v=this.source.charCodeAt(this.index);if(f.Character.isWhiteSpace(v))++this.index;else if(f.Character.isLineTerminator(v))++this.index,v===13&&this.source.charCodeAt(this.index)===10&&++this.index,++this.lineNumber,this.lineStart=this.index,y=!0;else if(v===47)if((v=this.source.charCodeAt(this.index+1))===47){this.index+=2;var x=this.skipSingleLineComment(2);this.trackComment&&(m=m.concat(x)),y=!0}else{if(v!==42)break;this.index+=2,x=this.skipMultiLineComment(),this.trackComment&&(m=m.concat(x))}else if(y&&v===45){if(this.source.charCodeAt(this.index+1)!==45||this.source.charCodeAt(this.index+2)!==62)break;this.index+=3,x=this.skipSingleLineComment(3),this.trackComment&&(m=m.concat(x))}else{if(v!==60||this.isModule||this.source.slice(this.index+1,this.index+4)!=="!--")break;this.index+=4,x=this.skipSingleLineComment(4),this.trackComment&&(m=m.concat(x))}}return m},g.prototype.isFutureReservedWord=function(m){switch(m){case"enum":case"export":case"import":case"super":return!0;default:return!1}},g.prototype.isStrictModeReservedWord=function(m){switch(m){case"implements":case"interface":case"package":case"private":case"protected":case"public":case"static":case"yield":case"let":return!0;default:return!1}},g.prototype.isRestrictedWord=function(m){return m==="eval"||m==="arguments"},g.prototype.isKeyword=function(m){switch(m.length){case 2:return m==="if"||m==="in"||m==="do";case 3:return m==="var"||m==="for"||m==="new"||m==="try"||m==="let";case 4:return m==="this"||m==="else"||m==="case"||m==="void"||m==="with"||m==="enum";case 5:return m==="while"||m==="break"||m==="catch"||m==="throw"||m==="const"||m==="yield"||m==="class"||m==="super";case 6:return m==="return"||m==="typeof"||m==="delete"||m==="switch"||m==="export"||m==="import";case 7:return m==="default"||m==="finally"||m==="extends";case 8:return m==="function"||m==="continue"||m==="debugger";case 10:return m==="instanceof";default:return!1}},g.prototype.codePointAt=function(m){var y=this.source.charCodeAt(m);if(y>=55296&&y<=56319){var v=this.source.charCodeAt(m+1);v>=56320&&v<=57343&&(y=1024*(y-55296)+v-56320+65536)}return y},g.prototype.scanHexEscape=function(m){for(var y=m==="u"?4:2,v=0,x=0;x<y;++x){if(this.eof()||!f.Character.isHexDigit(this.source.charCodeAt(this.index)))return null;v=16*v+d(this.source[this.index++])}return String.fromCharCode(v)},g.prototype.scanUnicodeCodePointEscape=function(){var m=this.source[this.index],y=0;for(m==="}"&&this.throwUnexpectedToken();!this.eof()&&(m=this.source[this.index++],f.Character.isHexDigit(m.charCodeAt(0)));)y=16*y+d(m);return(y>1114111||m!=="}")&&this.throwUnexpectedToken(),f.Character.fromCodePoint(y)},g.prototype.getIdentifier=function(){for(var m=this.index++;!this.eof();){var y=this.source.charCodeAt(this.index);if(y===92)return this.index=m,this.getComplexIdentifier();if(y>=55296&&y<57343)return this.index=m,this.getComplexIdentifier();if(!f.Character.isIdentifierPart(y))break;++this.index}return this.source.slice(m,this.index)},g.prototype.getComplexIdentifier=function(){var m,y=this.codePointAt(this.index),v=f.Character.fromCodePoint(y);for(this.index+=v.length,y===92&&(this.source.charCodeAt(this.index)!==117&&this.throwUnexpectedToken(),++this.index,this.source[this.index]==="{"?(++this.index,m=this.scanUnicodeCodePointEscape()):(m=this.scanHexEscape("u"))!==null&&m!=="\\"&&f.Character.isIdentifierStart(m.charCodeAt(0))||this.throwUnexpectedToken(),v=m);!this.eof()&&(y=this.codePointAt(this.index),f.Character.isIdentifierPart(y));)v+=m=f.Character.fromCodePoint(y),this.index+=m.length,y===92&&(v=v.substr(0,v.length-1),this.source.charCodeAt(this.index)!==117&&this.throwUnexpectedToken(),++this.index,this.source[this.index]==="{"?(++this.index,m=this.scanUnicodeCodePointEscape()):(m=this.scanHexEscape("u"))!==null&&m!=="\\"&&f.Character.isIdentifierPart(m.charCodeAt(0))||this.throwUnexpectedToken(),v+=m);return v},g.prototype.octalToDecimal=function(m){var y=m!=="0",v=h(m);return!this.eof()&&f.Character.isOctalDigit(this.source.charCodeAt(this.index))&&(y=!0,v=8*v+h(this.source[this.index++]),"0123".indexOf(m)>=0&&!this.eof()&&f.Character.isOctalDigit(this.source.charCodeAt(this.index))&&(v=8*v+h(this.source[this.index++]))),{code:v,octal:y}},g.prototype.scanIdentifier=function(){var m,y=this.index,v=this.source.charCodeAt(y)===92?this.getComplexIdentifier():this.getIdentifier();if((m=v.length===1?3:this.isKeyword(v)?4:v==="null"?5:v==="true"||v==="false"?1:3)!=3&&y+v.length!==this.index){var x=this.index;this.index=y,this.tolerateUnexpectedToken(u.Messages.InvalidEscapedReservedWord),this.index=x}return{type:m,value:v,lineNumber:this.lineNumber,lineStart:this.lineStart,start:y,end:this.index}},g.prototype.scanPunctuator=function(){var m=this.index,y=this.source[this.index];switch(y){case"(":case"{":y==="{"&&this.curlyStack.push("{"),++this.index;break;case".":++this.index,this.source[this.index]==="."&&this.source[this.index+1]==="."&&(this.index+=2,y="...");break;case"}":++this.index,this.curlyStack.pop();break;case")":case";":case",":case"[":case"]":case":":case"?":case"~":++this.index;break;default:(y=this.source.substr(this.index,4))===">>>="?this.index+=4:(y=y.substr(0,3))==="==="||y==="!=="||y===">>>"||y==="<<="||y===">>="||y==="**="?this.index+=3:(y=y.substr(0,2))==="&&"||y==="||"||y==="=="||y==="!="||y==="+="||y==="-="||y==="*="||y==="/="||y==="++"||y==="--"||y==="<<"||y===">>"||y==="&="||y==="|="||y==="^="||y==="%="||y==="<="||y===">="||y==="=>"||y==="**"?this.index+=2:(y=this.source[this.index],"<>=!+-*%&|^/".indexOf(y)>=0&&++this.index)}return this.index===m&&this.throwUnexpectedToken(),{type:7,value:y,lineNumber:this.lineNumber,lineStart:this.lineStart,start:m,end:this.index}},g.prototype.scanHexLiteral=function(m){for(var y="";!this.eof()&&f.Character.isHexDigit(this.source.charCodeAt(this.index));)y+=this.source[this.index++];return y.length===0&&this.throwUnexpectedToken(),f.Character.isIdentifierStart(this.source.charCodeAt(this.index))&&this.throwUnexpectedToken(),{type:6,value:parseInt("0x"+y,16),lineNumber:this.lineNumber,lineStart:this.lineStart,start:m,end:this.index}},g.prototype.scanBinaryLiteral=function(m){for(var y,v="";!this.eof()&&((y=this.source[this.index])==="0"||y==="1");)v+=this.source[this.index++];return v.length===0&&this.throwUnexpectedToken(),this.eof()||(y=this.source.charCodeAt(this.index),(f.Character.isIdentifierStart(y)||f.Character.isDecimalDigit(y))&&this.throwUnexpectedToken()),{type:6,value:parseInt(v,2),lineNumber:this.lineNumber,lineStart:this.lineStart,start:m,end:this.index}},g.prototype.scanOctalLiteral=function(m,y){var v="",x=!1;for(f.Character.isOctalDigit(m.charCodeAt(0))?(x=!0,v="0"+this.source[this.index++]):++this.index;!this.eof()&&f.Character.isOctalDigit(this.source.charCodeAt(this.index));)v+=this.source[this.index++];return x||v.length!==0||this.throwUnexpectedToken(),(f.Character.isIdentifierStart(this.source.charCodeAt(this.index))||f.Character.isDecimalDigit(this.source.charCodeAt(this.index)))&&this.throwUnexpectedToken(),{type:6,value:parseInt(v,8),octal:x,lineNumber:this.lineNumber,lineStart:this.lineStart,start:y,end:this.index}},g.prototype.isImplicitOctalLiteral=function(){for(var m=this.index+1;m<this.length;++m){var y=this.source[m];if(y==="8"||y==="9")return!1;if(!f.Character.isOctalDigit(y.charCodeAt(0)))return!0}return!0},g.prototype.scanNumericLiteral=function(){var m=this.index,y=this.source[m];c.assert(f.Character.isDecimalDigit(y.charCodeAt(0))||y===".","Numeric literal must start with a decimal digit or a decimal point");var v="";if(y!=="."){if(v=this.source[this.index++],y=this.source[this.index],v==="0"){if(y==="x"||y==="X")return++this.index,this.scanHexLiteral(m);if(y==="b"||y==="B")return++this.index,this.scanBinaryLiteral(m);if(y==="o"||y==="O")return this.scanOctalLiteral(y,m);if(y&&f.Character.isOctalDigit(y.charCodeAt(0))&&this.isImplicitOctalLiteral())return this.scanOctalLiteral(y,m)}for(;f.Character.isDecimalDigit(this.source.charCodeAt(this.index));)v+=this.source[this.index++];y=this.source[this.index]}if(y==="."){for(v+=this.source[this.index++];f.Character.isDecimalDigit(this.source.charCodeAt(this.index));)v+=this.source[this.index++];y=this.source[this.index]}if(y==="e"||y==="E")if(v+=this.source[this.index++],(y=this.source[this.index])!=="+"&&y!=="-"||(v+=this.source[this.index++]),f.Character.isDecimalDigit(this.source.charCodeAt(this.index)))for(;f.Character.isDecimalDigit(this.source.charCodeAt(this.index));)v+=this.source[this.index++];else this.throwUnexpectedToken();return f.Character.isIdentifierStart(this.source.charCodeAt(this.index))&&this.throwUnexpectedToken(),{type:6,value:parseFloat(v),lineNumber:this.lineNumber,lineStart:this.lineStart,start:m,end:this.index}},g.prototype.scanStringLiteral=function(){var m=this.index,y=this.source[m];c.assert(y==="'"||y==='"',"String literal must starts with a quote"),++this.index;for(var v=!1,x="";!this.eof();){var w=this.source[this.index++];if(w===y){y="";break}if(w==="\\")if((w=this.source[this.index++])&&f.Character.isLineTerminator(w.charCodeAt(0)))++this.lineNumber,w==="\r"&&this.source[this.index]===`
`&&++this.index,this.lineStart=this.index;else switch(w){case"u":if(this.source[this.index]==="{")++this.index,x+=this.scanUnicodeCodePointEscape();else{var S=this.scanHexEscape(w);S===null&&this.throwUnexpectedToken(),x+=S}break;case"x":var T=this.scanHexEscape(w);T===null&&this.throwUnexpectedToken(u.Messages.InvalidHexEscapeSequence),x+=T;break;case"n":x+=`
`;break;case"r":x+="\r";break;case"t":x+="	";break;case"b":x+="\b";break;case"f":x+="\f";break;case"v":x+="\v";break;case"8":case"9":x+=w,this.tolerateUnexpectedToken();break;default:if(w&&f.Character.isOctalDigit(w.charCodeAt(0))){var _=this.octalToDecimal(w);v=_.octal||v,x+=String.fromCharCode(_.code)}else x+=w}else{if(f.Character.isLineTerminator(w.charCodeAt(0)))break;x+=w}}return y!==""&&(this.index=m,this.throwUnexpectedToken()),{type:8,value:x,octal:v,lineNumber:this.lineNumber,lineStart:this.lineStart,start:m,end:this.index}},g.prototype.scanTemplate=function(){var m="",y=!1,v=this.index,x=this.source[v]==="`",w=!1,S=2;for(++this.index;!this.eof();){var T=this.source[this.index++];if(T==="`"){S=1,w=!0,y=!0;break}if(T==="$"){if(this.source[this.index]==="{"){this.curlyStack.push("${"),++this.index,y=!0;break}m+=T}else if(T==="\\")if(T=this.source[this.index++],f.Character.isLineTerminator(T.charCodeAt(0)))++this.lineNumber,T==="\r"&&this.source[this.index]===`
`&&++this.index,this.lineStart=this.index;else switch(T){case"n":m+=`
`;break;case"r":m+="\r";break;case"t":m+="	";break;case"u":if(this.source[this.index]==="{")++this.index,m+=this.scanUnicodeCodePointEscape();else{var _=this.index,D=this.scanHexEscape(T);D!==null?m+=D:(this.index=_,m+=T)}break;case"x":var I=this.scanHexEscape(T);I===null&&this.throwUnexpectedToken(u.Messages.InvalidHexEscapeSequence),m+=I;break;case"b":m+="\b";break;case"f":m+="\f";break;case"v":m+="\v";break;default:T==="0"?(f.Character.isDecimalDigit(this.source.charCodeAt(this.index))&&this.throwUnexpectedToken(u.Messages.TemplateOctalLiteral),m+="\0"):f.Character.isOctalDigit(T.charCodeAt(0))?this.throwUnexpectedToken(u.Messages.TemplateOctalLiteral):m+=T}else f.Character.isLineTerminator(T.charCodeAt(0))?(++this.lineNumber,T==="\r"&&this.source[this.index]===`
`&&++this.index,this.lineStart=this.index,m+=`
`):m+=T}return y||this.throwUnexpectedToken(),x||this.curlyStack.pop(),{type:10,value:this.source.slice(v+1,this.index-S),cooked:m,head:x,tail:w,lineNumber:this.lineNumber,lineStart:this.lineStart,start:v,end:this.index}},g.prototype.testRegExp=function(m,y){var v=m,x=this;y.indexOf("u")>=0&&(v=v.replace(/\\u\{([0-9a-fA-F]+)\}|\\u([a-fA-F0-9]{4})/g,(function(w,S,T){var _=parseInt(S||T,16);return _>1114111&&x.throwUnexpectedToken(u.Messages.InvalidRegExp),_<=65535?String.fromCharCode(_):"￿"})).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"￿"));try{RegExp(v)}catch{this.throwUnexpectedToken(u.Messages.InvalidRegExp)}try{return new RegExp(m,y)}catch{return null}},g.prototype.scanRegExpBody=function(){var m=this.source[this.index];c.assert(m==="/","Regular expression literal must start with a slash");for(var y=this.source[this.index++],v=!1,x=!1;!this.eof();)if(y+=m=this.source[this.index++],m==="\\")m=this.source[this.index++],f.Character.isLineTerminator(m.charCodeAt(0))&&this.throwUnexpectedToken(u.Messages.UnterminatedRegExp),y+=m;else if(f.Character.isLineTerminator(m.charCodeAt(0)))this.throwUnexpectedToken(u.Messages.UnterminatedRegExp);else if(v)m==="]"&&(v=!1);else{if(m==="/"){x=!0;break}m==="["&&(v=!0)}return x||this.throwUnexpectedToken(u.Messages.UnterminatedRegExp),y.substr(1,y.length-2)},g.prototype.scanRegExpFlags=function(){for(var m="";!this.eof();){var y=this.source[this.index];if(!f.Character.isIdentifierPart(y.charCodeAt(0)))break;if(++this.index,y!=="\\"||this.eof())m+=y;else if((y=this.source[this.index])==="u"){++this.index;var v=this.index,x=this.scanHexEscape("u");if(x!==null)for(m+=x;v<this.index;++v)this.source[v];else this.index=v,m+="u";this.tolerateUnexpectedToken()}else this.tolerateUnexpectedToken()}return m},g.prototype.scanRegExp=function(){var m=this.index,y=this.scanRegExpBody(),v=this.scanRegExpFlags();return{type:9,value:"",pattern:y,flags:v,regex:this.testRegExp(y,v),lineNumber:this.lineNumber,lineStart:this.lineStart,start:m,end:this.index}},g.prototype.lex=function(){if(this.eof())return{type:2,value:"",lineNumber:this.lineNumber,lineStart:this.lineStart,start:this.index,end:this.index};var m=this.source.charCodeAt(this.index);return f.Character.isIdentifierStart(m)?this.scanIdentifier():m===40||m===41||m===59?this.scanPunctuator():m===39||m===34?this.scanStringLiteral():m===46?f.Character.isDecimalDigit(this.source.charCodeAt(this.index+1))?this.scanNumericLiteral():this.scanPunctuator():f.Character.isDecimalDigit(m)?this.scanNumericLiteral():m===96||m===125&&this.curlyStack[this.curlyStack.length-1]==="${"?this.scanTemplate():m>=55296&&m<57343&&f.Character.isIdentifierStart(this.codePointAt(this.index))?this.scanIdentifier():this.scanPunctuator()},g})();s.Scanner=p},function(o,s){Object.defineProperty(s,"__esModule",{value:!0}),s.TokenName={},s.TokenName[1]="Boolean",s.TokenName[2]="<end>",s.TokenName[3]="Identifier",s.TokenName[4]="Keyword",s.TokenName[5]="Null",s.TokenName[6]="Numeric",s.TokenName[7]="Punctuator",s.TokenName[8]="String",s.TokenName[9]="RegularExpression",s.TokenName[10]="Template"},function(o,s){Object.defineProperty(s,"__esModule",{value:!0}),s.XHTMLEntities={quot:'"',amp:"&",apos:"'",gt:">",nbsp:" ",iexcl:"¡",cent:"¢",pound:"£",curren:"¤",yen:"¥",brvbar:"¦",sect:"§",uml:"¨",copy:"©",ordf:"ª",laquo:"«",not:"¬",shy:"­",reg:"®",macr:"¯",deg:"°",plusmn:"±",sup2:"²",sup3:"³",acute:"´",micro:"µ",para:"¶",middot:"·",cedil:"¸",sup1:"¹",ordm:"º",raquo:"»",frac14:"¼",frac12:"½",frac34:"¾",iquest:"¿",Agrave:"À",Aacute:"Á",Acirc:"Â",Atilde:"Ã",Auml:"Ä",Aring:"Å",AElig:"Æ",Ccedil:"Ç",Egrave:"È",Eacute:"É",Ecirc:"Ê",Euml:"Ë",Igrave:"Ì",Iacute:"Í",Icirc:"Î",Iuml:"Ï",ETH:"Ð",Ntilde:"Ñ",Ograve:"Ò",Oacute:"Ó",Ocirc:"Ô",Otilde:"Õ",Ouml:"Ö",times:"×",Oslash:"Ø",Ugrave:"Ù",Uacute:"Ú",Ucirc:"Û",Uuml:"Ü",Yacute:"Ý",THORN:"Þ",szlig:"ß",agrave:"à",aacute:"á",acirc:"â",atilde:"ã",auml:"ä",aring:"å",aelig:"æ",ccedil:"ç",egrave:"è",eacute:"é",ecirc:"ê",euml:"ë",igrave:"ì",iacute:"í",icirc:"î",iuml:"ï",eth:"ð",ntilde:"ñ",ograve:"ò",oacute:"ó",ocirc:"ô",otilde:"õ",ouml:"ö",divide:"÷",oslash:"ø",ugrave:"ù",uacute:"ú",ucirc:"û",uuml:"ü",yacute:"ý",thorn:"þ",yuml:"ÿ",OElig:"Œ",oelig:"œ",Scaron:"Š",scaron:"š",Yuml:"Ÿ",fnof:"ƒ",circ:"ˆ",tilde:"˜",Alpha:"Α",Beta:"Β",Gamma:"Γ",Delta:"Δ",Epsilon:"Ε",Zeta:"Ζ",Eta:"Η",Theta:"Θ",Iota:"Ι",Kappa:"Κ",Lambda:"Λ",Mu:"Μ",Nu:"Ν",Xi:"Ξ",Omicron:"Ο",Pi:"Π",Rho:"Ρ",Sigma:"Σ",Tau:"Τ",Upsilon:"Υ",Phi:"Φ",Chi:"Χ",Psi:"Ψ",Omega:"Ω",alpha:"α",beta:"β",gamma:"γ",delta:"δ",epsilon:"ε",zeta:"ζ",eta:"η",theta:"θ",iota:"ι",kappa:"κ",lambda:"λ",mu:"μ",nu:"ν",xi:"ξ",omicron:"ο",pi:"π",rho:"ρ",sigmaf:"ς",sigma:"σ",tau:"τ",upsilon:"υ",phi:"φ",chi:"χ",psi:"ψ",omega:"ω",thetasym:"ϑ",upsih:"ϒ",piv:"ϖ",ensp:" ",emsp:" ",thinsp:" ",zwnj:"‌",zwj:"‍",lrm:"‎",rlm:"‏",ndash:"–",mdash:"—",lsquo:"‘",rsquo:"’",sbquo:"‚",ldquo:"“",rdquo:"”",bdquo:"„",dagger:"†",Dagger:"‡",bull:"•",hellip:"…",permil:"‰",prime:"′",Prime:"″",lsaquo:"‹",rsaquo:"›",oline:"‾",frasl:"⁄",euro:"€",image:"ℑ",weierp:"℘",real:"ℜ",trade:"™",alefsym:"ℵ",larr:"←",uarr:"↑",rarr:"→",darr:"↓",harr:"↔",crarr:"↵",lArr:"⇐",uArr:"⇑",rArr:"⇒",dArr:"⇓",hArr:"⇔",forall:"∀",part:"∂",exist:"∃",empty:"∅",nabla:"∇",isin:"∈",notin:"∉",ni:"∋",prod:"∏",sum:"∑",minus:"−",lowast:"∗",radic:"√",prop:"∝",infin:"∞",ang:"∠",and:"∧",or:"∨",cap:"∩",cup:"∪",int:"∫",there4:"∴",sim:"∼",cong:"≅",asymp:"≈",ne:"≠",equiv:"≡",le:"≤",ge:"≥",sub:"⊂",sup:"⊃",nsub:"⊄",sube:"⊆",supe:"⊇",oplus:"⊕",otimes:"⊗",perp:"⊥",sdot:"⋅",lceil:"⌈",rceil:"⌉",lfloor:"⌊",rfloor:"⌋",loz:"◊",spades:"♠",clubs:"♣",hearts:"♥",diams:"♦",lang:"⟨",rang:"⟩"}},function(o,s,l){Object.defineProperty(s,"__esModule",{value:!0});var c=l(10),f=l(12),u=l(13),d=(function(){function p(){this.values=[],this.curly=this.paren=-1}return p.prototype.beforeFunctionExpression=function(g){return["(","{","[","in","typeof","instanceof","new","return","case","delete","throw","void","=","+=","-=","*=","**=","/=","%=","<<=",">>=",">>>=","&=","|=","^=",",","+","-","*","**","/","%","++","--","<<",">>",">>>","&","|","^","!","~","&&","||","?",":","===","==",">=","<=","<",">","!=","!=="].indexOf(g)>=0},p.prototype.isRegexStart=function(){var g=this.values[this.values.length-1],m=g!==null;switch(g){case"this":case"]":m=!1;break;case")":var y=this.values[this.paren-1];m=y==="if"||y==="while"||y==="for"||y==="with";break;case"}":if(m=!1,this.values[this.curly-3]==="function")m=!!(v=this.values[this.curly-4])&&!this.beforeFunctionExpression(v);else if(this.values[this.curly-4]==="function"){var v;m=!(v=this.values[this.curly-5])||!this.beforeFunctionExpression(v)}}return m},p.prototype.push=function(g){g.type===7||g.type===4?(g.value==="{"?this.curly=this.values.length:g.value==="("&&(this.paren=this.values.length),this.values.push(g.value)):this.values.push(null)},p})(),h=(function(){function p(g,m){this.errorHandler=new c.ErrorHandler,this.errorHandler.tolerant=!!m&&typeof m.tolerant=="boolean"&&m.tolerant,this.scanner=new f.Scanner(g,this.errorHandler),this.scanner.trackComment=!!m&&typeof m.comment=="boolean"&&m.comment,this.trackRange=!!m&&typeof m.range=="boolean"&&m.range,this.trackLoc=!!m&&typeof m.loc=="boolean"&&m.loc,this.buffer=[],this.reader=new d}return p.prototype.errors=function(){return this.errorHandler.errors},p.prototype.getNextToken=function(){if(this.buffer.length===0){var g=this.scanner.scanComments();if(this.scanner.trackComment)for(var m=0;m<g.length;++m){var y=g[m],v=this.scanner.source.slice(y.slice[0],y.slice[1]),x={type:y.multiLine?"BlockComment":"LineComment",value:v};this.trackRange&&(x.range=y.range),this.trackLoc&&(x.loc=y.loc),this.buffer.push(x)}if(!this.scanner.eof()){var w=void 0;this.trackLoc&&(w={start:{line:this.scanner.lineNumber,column:this.scanner.index-this.scanner.lineStart},end:{}});var S=this.scanner.source[this.scanner.index]==="/"&&this.reader.isRegexStart()?this.scanner.scanRegExp():this.scanner.lex();this.reader.push(S);var T={type:u.TokenName[S.type],value:this.scanner.source.slice(S.start,S.end)};if(this.trackRange&&(T.range=[S.start,S.end]),this.trackLoc&&(w.end={line:this.scanner.lineNumber,column:this.scanner.index-this.scanner.lineStart},T.loc=w),S.type===9){var _=S.pattern,D=S.flags;T.regex={pattern:_,flags:D}}this.buffer.push(T)}}return this.buffer.shift()},p})();s.Tokenizer=h}])},n.exports=a()},function(n,r,i){var a=i(38),o=i(53),s=i(76),l=i(54),c=Object.prototype.toString,f=Object.prototype.hasOwnProperty,u={0:"\\0",7:"\\a",8:"\\b",9:"\\t",10:"\\n",11:"\\v",12:"\\f",13:"\\r",27:"\\e",34:'\\"',92:"\\\\",133:"\\N",160:"\\_",8232:"\\L",8233:"\\P"},d=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"];function h(P){var B,U,G;if(B=P.toString(16).toUpperCase(),P<=255)U="x",G=2;else if(P<=65535)U="u",G=4;else{if(!(P<=4294967295))throw new o("code point within a string may not be greater than 0xFFFFFFFF");U="U",G=8}return"\\"+U+a.repeat("0",G-B.length)+B}function p(P){this.schema=P.schema||s,this.indent=Math.max(1,P.indent||2),this.noArrayIndent=P.noArrayIndent||!1,this.skipInvalid=P.skipInvalid||!1,this.flowLevel=a.isNothing(P.flowLevel)?-1:P.flowLevel,this.styleMap=(function(B,U){var G,F,$,V,X,Q,re;if(U===null)return{};for(G={},$=0,V=(F=Object.keys(U)).length;$<V;$+=1)X=F[$],Q=String(U[X]),X.slice(0,2)==="!!"&&(X="tag:yaml.org,2002:"+X.slice(2)),(re=B.compiledTypeMap.fallback[X])&&f.call(re.styleAliases,Q)&&(Q=re.styleAliases[Q]),G[X]=Q;return G})(this.schema,P.styles||null),this.sortKeys=P.sortKeys||!1,this.lineWidth=P.lineWidth||80,this.noRefs=P.noRefs||!1,this.noCompatMode=P.noCompatMode||!1,this.condenseFlow=P.condenseFlow||!1,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}function g(P,B){for(var U,G=a.repeat(" ",B),F=0,$=-1,V="",X=P.length;F<X;)($=P.indexOf(`
`,F))===-1?(U=P.slice(F),F=X):(U=P.slice(F,$+1),F=$+1),U.length&&U!==`
`&&(V+=G),V+=U;return V}function m(P,B){return`
`+a.repeat(" ",P.indent*B)}function y(P){return P===32||P===9}function v(P){return 32<=P&&P<=126||161<=P&&P<=55295&&P!==8232&&P!==8233||57344<=P&&P<=65533&&P!==65279||65536<=P&&P<=1114111}function x(P,B){return v(P)&&P!==65279&&P!==44&&P!==91&&P!==93&&P!==123&&P!==125&&P!==58&&(P!==35||B&&(function(U){return v(U)&&!y(U)&&U!==65279&&U!==13&&U!==10})(B))}function w(P){return/^\n* /.test(P)}function S(P,B,U,G,F){var $,V,X,Q,re=!1,ye=!1,me=G!==-1,Ce=-1,we=v(Q=P.charCodeAt(0))&&Q!==65279&&!y(Q)&&Q!==45&&Q!==63&&Q!==58&&Q!==44&&Q!==91&&Q!==93&&Q!==123&&Q!==125&&Q!==35&&Q!==38&&Q!==42&&Q!==33&&Q!==124&&Q!==61&&Q!==62&&Q!==39&&Q!==34&&Q!==37&&Q!==64&&Q!==96&&!y(P.charCodeAt(P.length-1));if(B)for($=0;$<P.length;$++){if(!v(V=P.charCodeAt($)))return 5;X=$>0?P.charCodeAt($-1):null,we=we&&x(V,X)}else{for($=0;$<P.length;$++){if((V=P.charCodeAt($))===10)re=!0,me&&(ye=ye||$-Ce-1>G&&P[Ce+1]!==" ",Ce=$);else if(!v(V))return 5;X=$>0?P.charCodeAt($-1):null,we=we&&x(V,X)}ye=ye||me&&$-Ce-1>G&&P[Ce+1]!==" "}return re||ye?U>9&&w(P)?5:ye?4:3:we&&!F(P)?1:2}function T(P,B,U,G){P.dump=(function(){if(B.length===0)return"''";if(!P.noCompatMode&&d.indexOf(B)!==-1)return"'"+B+"'";var F=P.indent*Math.max(1,U),$=P.lineWidth===-1?-1:Math.max(Math.min(P.lineWidth,40),P.lineWidth-F),V=G||P.flowLevel>-1&&U>=P.flowLevel;switch(S(B,V,P.indent,$,(function(X){return(function(Q,re){var ye,me;for(ye=0,me=Q.implicitTypes.length;ye<me;ye+=1)if(Q.implicitTypes[ye].resolve(re))return!0;return!1})(P,X)}))){case 1:return B;case 2:return"'"+B.replace(/'/g,"''")+"'";case 3:return"|"+_(B,P.indent)+D(g(B,F));case 4:return">"+_(B,P.indent)+D(g((function(X,Q){for(var re,ye,me=/(\n+)([^\n]*)/g,Ce=(Ae=X.indexOf(`
`),Ae=Ae!==-1?Ae:X.length,me.lastIndex=Ae,I(X.slice(0,Ae),Q)),we=X[0]===`
`||X[0]===" ",Ae;ye=me.exec(X);){var De=ye[1],q=ye[2];re=q[0]===" ",Ce+=De+(we||re||q===""?"":`
`)+I(q,Q),we=re}return Ce})(B,$),F));case 5:return'"'+(function(X){for(var Q,re,ye,me="",Ce=0;Ce<X.length;Ce++)(Q=X.charCodeAt(Ce))>=55296&&Q<=56319&&(re=X.charCodeAt(Ce+1))>=56320&&re<=57343?(me+=h(1024*(Q-55296)+re-56320+65536),Ce++):(ye=u[Q],me+=!ye&&v(Q)?X[Ce]:ye||h(Q));return me})(B)+'"';default:throw new o("impossible error: invalid scalar style")}})()}function _(P,B){var U=w(P)?String(B):"",G=P[P.length-1]===`
`;return U+(G&&(P[P.length-2]===`
`||P===`
`)?"+":G?"":"-")+`
`}function D(P){return P[P.length-1]===`
`?P.slice(0,-1):P}function I(P,B){if(P===""||P[0]===" ")return P;for(var U,G,F=/ [^ ]/g,$=0,V=0,X=0,Q="";U=F.exec(P);)(X=U.index)-$>B&&(G=V>$?V:X,Q+=`
`+P.slice($,G),$=G+1),V=X;return Q+=`
`,P.length-$>B&&V>$?Q+=P.slice($,V)+`
`+P.slice(V+1):Q+=P.slice($),Q.slice(1)}function R(P,B,U){var G,F,$,V,X,Q;for($=0,V=(F=U?P.explicitTypes:P.implicitTypes).length;$<V;$+=1)if(((X=F[$]).instanceOf||X.predicate)&&(!X.instanceOf||typeof B=="object"&&B instanceof X.instanceOf)&&(!X.predicate||X.predicate(B))){if(P.tag=U?X.tag:"?",X.represent){if(Q=P.styleMap[X.tag]||X.defaultStyle,c.call(X.represent)==="[object Function]")G=X.represent(B,Q);else{if(!f.call(X.represent,Q))throw new o("!<"+X.tag+'> tag resolver accepts not "'+Q+'" style');G=X.represent[Q](B,Q)}P.dump=G}return!0}return!1}function M(P,B,U,G,F,$){P.tag=null,P.dump=U,R(P,U,!1)||R(P,U,!0);var V=c.call(P.dump);G&&(G=P.flowLevel<0||P.flowLevel>B);var X,Q,re=V==="[object Object]"||V==="[object Array]";if(re&&(Q=(X=P.duplicates.indexOf(U))!==-1),(P.tag!==null&&P.tag!=="?"||Q||P.indent!==2&&B>0)&&(F=!1),Q&&P.usedDuplicates[X])P.dump="*ref_"+X;else{if(re&&Q&&!P.usedDuplicates[X]&&(P.usedDuplicates[X]=!0),V==="[object Object]")G&&Object.keys(P.dump).length!==0?((function(me,Ce,we,Ae){var De,q,k,J,Y,ie,ue="",fe=me.tag,Se=Object.keys(we);if(me.sortKeys===!0)Se.sort();else if(typeof me.sortKeys=="function")Se.sort(me.sortKeys);else if(me.sortKeys)throw new o("sortKeys must be a boolean or a function");for(De=0,q=Se.length;De<q;De+=1)ie="",Ae&&De===0||(ie+=m(me,Ce)),J=we[k=Se[De]],M(me,Ce+1,k,!0,!0,!0)&&((Y=me.tag!==null&&me.tag!=="?"||me.dump&&me.dump.length>1024)&&(me.dump&&me.dump.charCodeAt(0)===10?ie+="?":ie+="? "),ie+=me.dump,Y&&(ie+=m(me,Ce)),M(me,Ce+1,J,!0,Y)&&(me.dump&&me.dump.charCodeAt(0)===10?ie+=":":ie+=": ",ue+=ie+=me.dump));me.tag=fe,me.dump=ue||"{}"})(P,B,P.dump,F),Q&&(P.dump="&ref_"+X+P.dump)):((function(me,Ce,we){var Ae,De,q,k,J,Y="",ie=me.tag,ue=Object.keys(we);for(Ae=0,De=ue.length;Ae<De;Ae+=1)J="",Ae!==0&&(J+=", "),me.condenseFlow&&(J+='"'),k=we[q=ue[Ae]],M(me,Ce,q,!1,!1)&&(me.dump.length>1024&&(J+="? "),J+=me.dump+(me.condenseFlow?'"':"")+":"+(me.condenseFlow?"":" "),M(me,Ce,k,!1,!1)&&(Y+=J+=me.dump));me.tag=ie,me.dump="{"+Y+"}"})(P,B,P.dump),Q&&(P.dump="&ref_"+X+" "+P.dump));else if(V==="[object Array]"){var ye=P.noArrayIndent&&B>0?B-1:B;G&&P.dump.length!==0?((function(me,Ce,we,Ae){var De,q,k="",J=me.tag;for(De=0,q=we.length;De<q;De+=1)M(me,Ce+1,we[De],!0,!0)&&(Ae&&De===0||(k+=m(me,Ce)),me.dump&&me.dump.charCodeAt(0)===10?k+="-":k+="- ",k+=me.dump);me.tag=J,me.dump=k||"[]"})(P,ye,P.dump,F),Q&&(P.dump="&ref_"+X+P.dump)):((function(me,Ce,we){var Ae,De,q="",k=me.tag;for(Ae=0,De=we.length;Ae<De;Ae+=1)M(me,Ce,we[Ae],!1,!1)&&(Ae!==0&&(q+=","+(me.condenseFlow?"":" ")),q+=me.dump);me.tag=k,me.dump="["+q+"]"})(P,ye,P.dump),Q&&(P.dump="&ref_"+X+" "+P.dump))}else{if(V!=="[object String]"){if(P.skipInvalid)return!1;throw new o("unacceptable kind of an object to dump "+V)}P.tag!=="?"&&T(P,P.dump,B,$)}P.tag!==null&&P.tag!=="?"&&(P.dump="!<"+P.tag+"> "+P.dump)}return!0}function A(P,B){var U,G,F=[],$=[];for((function V(X,Q,re){var ye,me,Ce;if(X!==null&&typeof X=="object")if((me=Q.indexOf(X))!==-1)re.indexOf(me)===-1&&re.push(me);else if(Q.push(X),Array.isArray(X))for(me=0,Ce=X.length;me<Ce;me+=1)V(X[me],Q,re);else for(ye=Object.keys(X),me=0,Ce=ye.length;me<Ce;me+=1)V(X[ye[me]],Q,re)})(P,F,$),U=0,G=$.length;U<G;U+=1)B.duplicates.push(F[$[U]]);B.usedDuplicates=new Array(G)}function L(P,B){var U=new p(B=B||{});return U.noRefs||A(P,U),M(U,0,P,!0,!0)?U.dump+`
`:""}n.exports.dump=L,n.exports.safeDump=function(P,B){return L(P,a.extend({schema:l},B))}},function(n,r,i){i(31),i(32),i(33),i(64),i(19),i(65),i(20),i(68),i(92),i(144),i(22),i(94),i(23);var a,o=this&&this.__extends||(a=function(S,T){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(_,D){_.__proto__=D}||function(_,D){for(var I in D)D.hasOwnProperty(I)&&(_[I]=D[I])})(S,T)},function(S,T){function _(){this.constructor=S}a(S,T),S.prototype=T===null?Object.create(T):(_.prototype=T.prototype,new _)}),s=this&&this.__values||function(S){var T=typeof Symbol=="function"&&Symbol.iterator,_=T&&S[T],D=0;if(_)return _.call(S);if(S&&typeof S.length=="number")return{next:function(){return S&&D>=S.length&&(S=void 0),{value:S&&S[D++],done:!S}}};throw new TypeError(T?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(S,T){var _=typeof Symbol=="function"&&S[Symbol.iterator];if(!_)return S;var D,I,R=_.call(S),M=[];try{for(;(T===void 0||T-- >0)&&!(D=R.next()).done;)M.push(D.value)}catch(A){I={error:A}}finally{try{D&&!D.done&&(_=R.return)&&_.call(R)}finally{if(I)throw I.error}}return M};Object.defineProperty(r,"__esModule",{value:!0});var c=i(91),f=i(1),u=i(183),d=i(0),h=i(7),p=i(95),g=i(69),m=i(3),y=i(305),v=i(306),x=i(307),w=(function(S){function T(_,D){D===void 0&&(D=!1);var I=S.call(this)||this;return I._hasDeclaration=!1,I._docTypeName="",I._hasDocumentElement=!1,I._currentElementSerialized=!1,I._openTags=[],I._ended=!1,I._fragment=D,I._options=f.applyDefaults(_||{},c.DefaultXMLBuilderCBOptions),I._builderOptions={defaultNamespace:I._options.defaultNamespace,namespaceAlias:I._options.namespaceAlias},I._options.format==="json"?I._writer=new v.JSONCBWriter(I._options):I._options.format==="yaml"?I._writer=new x.YAMLCBWriter(I._options):I._writer=new y.XMLCBWriter(I._options),I._options.data!==void 0&&I.on("data",I._options.data),I._options.end!==void 0&&I.on("end",I._options.end),I._options.error!==void 0&&I.on("error",I._options.error),I._prefixMap=new p.NamespacePrefixMap,I._prefixMap.set("xml",h.namespace.XML),I._prefixIndex={value:1},I._push(I._writer.frontMatter()),I}return o(T,S),T.prototype.ele=function(_,D,I){var R,M;if(f.isObject(_)||f.isString(_)&&(/^\s*</.test(_)||/^\s*[\{\[]/.test(_)||/^(\s*|(#.*)|(%.*))*---/.test(_))){var A=u.fragment().set(this._options);try{A.ele(_)}catch(U){return this.emit("error",U),this}try{for(var L=s(A.node.childNodes),P=L.next();!P.done;P=L.next()){var B=P.value;this._fromNode(B)}}catch(U){R={error:U}}finally{try{P&&!P.done&&(M=L.return)&&M.call(L)}finally{if(R)throw R.error}}return this}if(this._serializeOpenTag(!0),!this._fragment&&this._hasDocumentElement&&this._writer.level===0)return this.emit("error",new Error("Document cannot have multiple document element nodes.")),this;try{this._currentElement=u.fragment(this._builderOptions).ele(_,D,I)}catch(U){return this.emit("error",U),this}return this._fragment||this._hasDocumentElement||this._docTypeName===""||this._currentElement.node._qualifiedName===this._docTypeName?(this._currentElementSerialized=!1,this._fragment||(this._hasDocumentElement=!0),this):(this.emit("error",new Error("Document element name does not match DocType declaration name.")),this)},T.prototype.att=function(_,D,I){if(this._currentElement===void 0)return this.emit("error",new Error("Cannot insert an attribute node as child of a document node.")),this;try{this._currentElement.att(_,D,I)}catch(R){return this.emit("error",R),this}return this},T.prototype.com=function(_){var D;this._serializeOpenTag(!0);try{D=u.fragment(this._builderOptions).com(_).first().node}catch(I){return this.emit("error",I),this}return!this._options.wellFormed||d.xml_isLegalChar(D.data)&&D.data.indexOf("--")===-1&&!D.data.endsWith("-")?(this._push(this._writer.comment(D.data)),this):(this.emit("error",new Error("Comment data contains invalid characters (well-formed required).")),this)},T.prototype.txt=function(_){if(!this._fragment&&this._currentElement===void 0)return this.emit("error",new Error("Cannot insert a text node as child of a document node.")),this;var D;this._serializeOpenTag(!0);try{D=u.fragment(this._builderOptions).txt(_).first().node}catch(R){return this.emit("error",R),this}if(this._options.wellFormed&&!d.xml_isLegalChar(D.data))return this.emit("error",new Error("Text data contains invalid characters (well-formed required).")),this;var I=D.data.replace(/(?!&(lt|gt|amp|apos|quot);)&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");return this._push(this._writer.text(I)),this},T.prototype.ins=function(_,D){var I;D===void 0&&(D=""),this._serializeOpenTag(!0);try{I=u.fragment(this._builderOptions).ins(_,D).first().node}catch(R){return this.emit("error",R),this}return this._options.wellFormed&&(I.target.indexOf(":")!==-1||/^xml$/i.test(I.target))?(this.emit("error",new Error("Processing instruction target contains invalid characters (well-formed required).")),this):this._options.wellFormed&&!d.xml_isLegalChar(I.data)?(this.emit("error",Error("Processing instruction data contains invalid characters (well-formed required).")),this):(this._push(this._writer.instruction(I.target,I.data)),this)},T.prototype.dat=function(_){var D;this._serializeOpenTag(!0);try{D=u.fragment(this._builderOptions).dat(_).first().node}catch(I){return this.emit("error",I),this}return this._push(this._writer.cdata(D.data)),this},T.prototype.dec=function(_){return _===void 0&&(_={version:"1.0"}),this._fragment?(this.emit("error",Error("Cannot insert an XML declaration into a document fragment.")),this):this._hasDeclaration?(this.emit("error",Error("XML declaration is already inserted.")),this):(this._push(this._writer.declaration(_.version||"1.0",_.encoding,_.standalone)),this._hasDeclaration=!0,this)},T.prototype.dtd=function(_){if(this._fragment)return this.emit("error",Error("Cannot insert a DocType declaration into a document fragment.")),this;if(this._docTypeName!=="")return this.emit("error",new Error("DocType declaration is already inserted.")),this;if(this._hasDocumentElement)return this.emit("error",new Error("Cannot insert DocType declaration after document element.")),this;var D;try{D=u.create().dtd(_).first().node}catch(I){return this.emit("error",I),this}return this._options.wellFormed&&!d.xml_isPubidChar(D.publicId)?(this.emit("error",new Error("DocType public identifier does not match PubidChar construct (well-formed required).")),this):this._options.wellFormed&&(!d.xml_isLegalChar(D.systemId)||D.systemId.indexOf('"')!==-1&&D.systemId.indexOf("'")!==-1)?(this.emit("error",new Error("DocType system identifier contains invalid characters (well-formed required).")),this):(this._docTypeName=_.name,this._push(this._writer.docType(_.name,D.publicId,D.systemId)),this)},T.prototype.import=function(_){var D,I,R=u.fragment().set(this._options);try{R.import(_)}catch(P){return this.emit("error",P),this}try{for(var M=s(R.node.childNodes),A=M.next();!A.done;A=M.next()){var L=A.value;this._fromNode(L)}}catch(P){D={error:P}}finally{try{A&&!A.done&&(I=M.return)&&I.call(M)}finally{if(D)throw D.error}}return this},T.prototype.up=function(){return this._serializeOpenTag(!1),this._serializeCloseTag(),this},T.prototype.end=function(){for(this._serializeOpenTag(!1);this._openTags.length>0;)this._serializeCloseTag();return this._push(null),this},T.prototype._serializeOpenTag=function(_){if(!this._currentElementSerialized&&this._currentElement!==void 0){var D=this._currentElement.node;if(!this._options.wellFormed||D.localName.indexOf(":")===-1&&d.xml_isName(D.localName)){var I="",R=!1,M=this._prefixMap.copy(),A={},L=this._recordNamespaceInformation(D,M,A),P=this._openTags.length===0?null:this._openTags[this._openTags.length-1][1],B=D.namespaceURI;if(B===null&&(B=P),P===B)L!==null&&(R=!0),I=B===h.namespace.XML?"xml:"+D.localName:D.localName,this._writer.beginElement(I),this._push(this._writer.openTagBegin(I));else{var U=D.prefix,G=null;if(U===null&&B===L||(G=M.get(U,B)),U==="xmlns"){if(this._options.wellFormed)return void this.emit("error",new Error("An element cannot have the 'xmlns' prefix (well-formed required)."));G=U}G!==null?(I=G+":"+D.localName,L!==null&&L!==h.namespace.XML&&(P=L||null),this._writer.beginElement(I),this._push(this._writer.openTagBegin(I))):U!==null?(U in A&&(U=this._generatePrefix(B,M,this._prefixIndex)),M.set(U,B),I+=U+":"+D.localName,this._writer.beginElement(I),this._push(this._writer.openTagBegin(I)),this._push(this._writer.attribute("xmlns:"+U,this._serializeAttributeValue(B,this._options.wellFormed))),L!==null&&(P=L||null)):L===null||L!==null&&L!==B?(R=!0,I+=D.localName,P=B,this._writer.beginElement(I),this._push(this._writer.openTagBegin(I)),this._push(this._writer.attribute("xmlns",this._serializeAttributeValue(B,this._options.wellFormed)))):(I+=D.localName,P=B,this._writer.beginElement(I),this._push(this._writer.openTagBegin(I)))}this._serializeAttributes(D,M,this._prefixIndex,A,R,this._options.wellFormed);var F=B===h.namespace.HTML;F&&!_&&T._VoidElementNames.has(D.localName)?(this._push(this._writer.openTagEnd(I,!0,!0)),this._writer.endElement(I)):F||_?this._push(this._writer.openTagEnd(I,!1,!1)):(this._push(this._writer.openTagEnd(I,!0,!1)),this._writer.endElement(I)),this._currentElementSerialized=!0,this._openTags.push([I,P,this._prefixMap,_]),this._isPrefixMapModified(this._prefixMap,M)&&(this._prefixMap=M),this._writer.level++}else this.emit("error",new Error("Node local name contains invalid characters (well-formed required)."))}},T.prototype._serializeCloseTag=function(){this._writer.level--;var _=this._openTags.pop();if(_!==void 0){var D=l(_,4),I=D[0],R=(D[1],D[2]),M=D[3];this._prefixMap=R,M&&(this._push(this._writer.closeTag(I)),this._writer.endElement(I))}else this.emit("error",new Error("Last element is undefined."))},T.prototype._push=function(_){_===null?(this._ended=!0,this.emit("end")):this._ended?this.emit("error",new Error("Cannot push to ended stream.")):_.length!==0&&(this._writer.hasData=!0,this.emit("data",_,this._writer.level))},T.prototype._fromNode=function(_){var D,I,R,M;if(m.Guard.isElementNode(_)){var A=_.prefix?_.prefix+":"+_.localName:_.localName;_.namespaceURI!==null?this.ele(_.namespaceURI,A):this.ele(A);try{for(var L=s(_.attributes),P=L.next();!P.done;P=L.next()){var B=P.value,U=B.prefix?B.prefix+":"+B.localName:B.localName;B.namespaceURI!==null?this.att(B.namespaceURI,U,B.value):this.att(U,B.value)}}catch(V){D={error:V}}finally{try{P&&!P.done&&(I=L.return)&&I.call(L)}finally{if(D)throw D.error}}try{for(var G=s(_.childNodes),F=G.next();!F.done;F=G.next()){var $=F.value;this._fromNode($)}}catch(V){R={error:V}}finally{try{F&&!F.done&&(M=G.return)&&M.call(G)}finally{if(R)throw R.error}}this.up()}else m.Guard.isExclusiveTextNode(_)&&_.data?this.txt(_.data):m.Guard.isCommentNode(_)?this.com(_.data):m.Guard.isCDATASectionNode(_)?this.dat(_.data):m.Guard.isProcessingInstructionNode(_)&&this.ins(_.target,_.data)},T.prototype._serializeAttributes=function(_,D,I,R,M,A){var L,P,B=A?new g.LocalNameSet:void 0;try{for(var U=s(_.attributes),G=U.next();!G.done;G=U.next()){var F=G.value;if(A||M||F.namespaceURI!==null){if(A&&B&&B.has(F.namespaceURI,F.localName))return void this.emit("error",new Error("Element contains duplicate attributes (well-formed required)."));A&&B&&B.set(F.namespaceURI,F.localName);var $=F.namespaceURI,V=null;if($!==null)if(V=D.get(F.prefix,$),$===h.namespace.XMLNS){if(F.value===h.namespace.XML||F.prefix===null&&M||F.prefix!==null&&(!(F.localName in R)||R[F.localName]!==F.value)&&D.has(F.localName,F.value))continue;if(A&&F.value===h.namespace.XMLNS)return void this.emit("error",new Error("XMLNS namespace is reserved (well-formed required)."));if(A&&F.value==="")return void this.emit("error",new Error("Namespace prefix declarations cannot be used to undeclare a namespace (well-formed required)."));F.prefix==="xmlns"&&(V="xmlns")}else V===null&&(V=F.prefix===null||D.hasPrefix(F.prefix)&&!D.has(F.prefix,$)?this._generatePrefix($,D,I):F.prefix,this._push(this._writer.attribute("xmlns:"+V,this._serializeAttributeValue($,this._options.wellFormed))));if(A&&(F.localName.indexOf(":")!==-1||!d.xml_isName(F.localName)||F.localName==="xmlns"&&$===null))return void this.emit("error",new Error("Attribute local name contains invalid characters (well-formed required)."));this._push(this._writer.attribute((V!==null?V+":":"")+F.localName,this._serializeAttributeValue(F.value,this._options.wellFormed)))}else this._push(this._writer.attribute(F.localName,this._serializeAttributeValue(F.value,this._options.wellFormed)))}}catch(X){L={error:X}}finally{try{G&&!G.done&&(P=U.return)&&P.call(U)}finally{if(L)throw L.error}}},T.prototype._serializeAttributeValue=function(_,D){return D&&_!==null&&!d.xml_isLegalChar(_)?(this.emit("error",new Error("Invalid characters in attribute value.")),""):_===null?"":_.replace(/(?!&(lt|gt|amp|apos|quot);)&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},T.prototype._recordNamespaceInformation=function(_,D,I){var R,M,A=null;try{for(var L=s(_.attributes),P=L.next();!P.done;P=L.next()){var B=P.value,U=B.namespaceURI,G=B.prefix;if(U===h.namespace.XMLNS){if(G===null){A=B.value;continue}var F=B.localName,$=B.value;if($===h.namespace.XML||($===""&&($=null),D.has(F,$)))continue;D.set(F,$),I[F]=$||""}}}catch(V){R={error:V}}finally{try{P&&!P.done&&(M=L.return)&&M.call(L)}finally{if(R)throw R.error}}return A},T.prototype._generatePrefix=function(_,D,I){var R="ns"+I.value;return I.value++,D.set(R,_),R},T.prototype._isPrefixMapModified=function(_,D){var I=_._items,R=D._items,M=_._nullItems,A=D._nullItems;for(var L in R){var P=I[L];if(P===void 0)return!0;var B=R[L];if(P.length!==B.length)return!0;for(var U=0;U<P.length;U++)if(P[U]!==B[U])return!0}if(M.length!==A.length)return!0;for(U=0;U<M.length;U++)if(M[U]!==A[U])return!0;return!1},T._VoidElementNames=new Set(["area","base","basefont","bgsound","br","col","embed","frame","hr","img","input","keygen","link","menuitem","meta","param","source","track","wbr"]),T})(i(308).EventEmitter);r.XMLBuilderCBImpl=w},function(n,r,i){i(74);var a,o=this&&this.__extends||(a=function(l,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,u){f.__proto__=u}||function(f,u){for(var d in u)u.hasOwnProperty(d)&&(f[d]=u[d])})(l,c)},function(l,c){function f(){this.constructor=l}a(l,c),l.prototype=c===null?Object.create(c):(f.prototype=c.prototype,new f)});Object.defineProperty(r,"__esModule",{value:!0});var s=(function(l){function c(f){var u=l.call(this,f)||this;return u._lineLength=0,u}return o(c,l),c.prototype.frontMatter=function(){return""},c.prototype.declaration=function(f,u,d){var h=this._beginLine()+"<?xml";return h+=' version="'+f+'"',u!==void 0&&(h+=' encoding="'+u+'"'),d!==void 0&&(h+=' standalone="'+(d?"yes":"no")+'"'),h+="?>"},c.prototype.docType=function(f,u,d){var h=this._beginLine();return h+=u&&d?"<!DOCTYPE "+f+' PUBLIC "'+u+'" "'+d+'">':u?"<!DOCTYPE "+f+' PUBLIC "'+u+'">':d?"<!DOCTYPE "+f+' SYSTEM "'+d+'">':"<!DOCTYPE "+f+">"},c.prototype.comment=function(f){return this._beginLine()+"<!--"+f+"-->"},c.prototype.text=function(f){return this._beginLine()+f},c.prototype.instruction=function(f,u){return u?this._beginLine()+"<?"+f+" "+u+"?>":this._beginLine()+"<?"+f+"?>"},c.prototype.cdata=function(f){return this._beginLine()+"<![CDATA["+f+"]]>"},c.prototype.openTagBegin=function(f){return this._lineLength+=1+f.length,this._beginLine()+"<"+f},c.prototype.openTagEnd=function(f,u,d){return d?" />":u?this._writerOptions.allowEmptyTags?"></"+f+">":this._writerOptions.spaceBeforeSlash?" />":"/>":">"},c.prototype.closeTag=function(f){return this._beginLine()+"</"+f+">"},c.prototype.attribute=function(f,u){var d=f+'="'+u+'"';return this._writerOptions.prettyPrint&&this._writerOptions.width>0&&this._lineLength+1+d.length>this._writerOptions.width?(d=this._beginLine()+this._indent(1)+d,this._lineLength=d.length,d):(this._lineLength+=1+d.length," "+d)},c.prototype.beginElement=function(f){},c.prototype.endElement=function(f){},c.prototype._beginLine=function(){if(this._writerOptions.prettyPrint){var f=(this.hasData?this._writerOptions.newline:"")+this._indent(this._writerOptions.offset+this.level);return this._lineLength=f.length,f}return""},c.prototype._indent=function(f){return f<=0?"":this._writerOptions.indent.repeat(f)},c})(i(114).BaseCBWriter);r.XMLCBWriter=s},function(n,r,i){i(74);var a,o=this&&this.__extends||(a=function(l,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,u){f.__proto__=u}||function(f,u){for(var d in u)u.hasOwnProperty(d)&&(f[d]=u[d])})(l,c)},function(l,c){function f(){this.constructor=l}a(l,c),l.prototype=c===null?Object.create(c):(f.prototype=c.prototype,new f)});Object.defineProperty(r,"__esModule",{value:!0});var s=(function(l){function c(f){var u=l.call(this,f)||this;return u._hasChildren=[],u._additionalLevel=0,u}return o(c,l),c.prototype.frontMatter=function(){return""},c.prototype.declaration=function(f,u,d){return""},c.prototype.docType=function(f,u,d){return""},c.prototype.comment=function(f){return this._comma()+this._beginLine()+"{"+this._sep()+this._key(this._builderOptions.convert.comment)+this._sep()+this._val(f)+this._sep()+"}"},c.prototype.text=function(f){return this._comma()+this._beginLine()+"{"+this._sep()+this._key(this._builderOptions.convert.text)+this._sep()+this._val(f)+this._sep()+"}"},c.prototype.instruction=function(f,u){return this._comma()+this._beginLine()+"{"+this._sep()+this._key(this._builderOptions.convert.ins)+this._sep()+this._val(u?f+" "+u:f)+this._sep()+"}"},c.prototype.cdata=function(f){return this._comma()+this._beginLine()+"{"+this._sep()+this._key(this._builderOptions.convert.cdata)+this._sep()+this._val(f)+this._sep()+"}"},c.prototype.attribute=function(f,u){return this._comma()+this._beginLine(1)+"{"+this._sep()+this._key(this._builderOptions.convert.att+f)+this._sep()+this._val(u)+this._sep()+"}"},c.prototype.openTagBegin=function(f){var u=this._comma()+this._beginLine()+"{"+this._sep()+this._key(f)+this._sep()+"{";return this._additionalLevel++,this.hasData=!0,u+=this._beginLine()+this._key(this._builderOptions.convert.text)+this._sep()+"[",this._hasChildren.push(!1),u},c.prototype.openTagEnd=function(f,u,d){if(u){var h=this._sep()+"]";return this._additionalLevel--,h+=this._beginLine()+"}"+this._sep()+"}"}return""},c.prototype.closeTag=function(f){var u=this._beginLine()+"]";return this._additionalLevel--,u+=this._beginLine()+"}"+this._sep()+"}"},c.prototype.beginElement=function(f){},c.prototype.endElement=function(f){this._hasChildren.pop()},c.prototype._beginLine=function(f){return f===void 0&&(f=0),this._writerOptions.prettyPrint?(this.hasData?this._writerOptions.newline:"")+this._indent(this._writerOptions.offset+this.level+f):""},c.prototype._indent=function(f){return f+this._additionalLevel<=0?"":this._writerOptions.indent.repeat(f+this._additionalLevel)},c.prototype._comma=function(){var f=this._hasChildren[this._hasChildren.length-1]?",":"";return this._hasChildren.length>0&&(this._hasChildren[this._hasChildren.length-1]=!0),f},c.prototype._sep=function(){return this._writerOptions.prettyPrint?" ":""},c.prototype._key=function(f){return'"'+f+'":'},c.prototype._val=function(f){return JSON.stringify(f)},c})(i(114).BaseCBWriter);r.JSONCBWriter=s},function(n,r,i){i(74);var a,o=this&&this.__extends||(a=function(l,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,u){f.__proto__=u}||function(f,u){for(var d in u)u.hasOwnProperty(d)&&(f[d]=u[d])})(l,c)},function(l,c){function f(){this.constructor=l}a(l,c),l.prototype=c===null?Object.create(c):(f.prototype=c.prototype,new f)});Object.defineProperty(r,"__esModule",{value:!0});var s=(function(l){function c(f){var u=l.call(this,f)||this;if(u._rootWritten=!1,u._additionalLevel=0,f.indent.length<2)throw new Error("YAML indententation string must be at least two characters long.");if(f.offset<0)throw new Error("YAML offset should be zero or a positive number.");return u}return o(c,l),c.prototype.frontMatter=function(){return this._beginLine()+"---"},c.prototype.declaration=function(f,u,d){return""},c.prototype.docType=function(f,u,d){return""},c.prototype.comment=function(f){return this._beginLine()+this._key(this._builderOptions.convert.comment)+" "+this._val(f)},c.prototype.text=function(f){return this._beginLine()+this._key(this._builderOptions.convert.text)+" "+this._val(f)},c.prototype.instruction=function(f,u){return this._beginLine()+this._key(this._builderOptions.convert.ins)+" "+this._val(u?f+" "+u:f)},c.prototype.cdata=function(f){return this._beginLine()+this._key(this._builderOptions.convert.cdata)+" "+this._val(f)},c.prototype.attribute=function(f,u){this._additionalLevel++;var d=this._beginLine()+this._key(this._builderOptions.convert.att+f)+" "+this._val(u);return this._additionalLevel--,d},c.prototype.openTagBegin=function(f){var u=this._beginLine()+this._key(f);return this._rootWritten||(this._rootWritten=!0),this.hasData=!0,this._additionalLevel++,u+=this._beginLine(!0)+this._key(this._builderOptions.convert.text)},c.prototype.openTagEnd=function(f,u,d){return u?" "+this._val(""):""},c.prototype.closeTag=function(f){return this._additionalLevel--,""},c.prototype.beginElement=function(f){},c.prototype.endElement=function(f){},c.prototype._beginLine=function(f){return f===void 0&&(f=!1),(this.hasData?this._writerOptions.newline:"")+this._indent(this._writerOptions.offset+this.level,f)},c.prototype._indent=function(f,u){if(f+this._additionalLevel<=0)return"";var d=this._writerOptions.indent.repeat(f+this._additionalLevel);return!u&&this._rootWritten?d.substr(0,d.length-2)+"-"+d.substr(-1,1):d},c.prototype._key=function(f){return'"'+f+'":'},c.prototype._val=function(f){return JSON.stringify(f)},c})(i(114).BaseCBWriter);r.YAMLCBWriter=s},function(n,r,i){var a,o=typeof Reflect=="object"?Reflect:null,s=o&&typeof o.apply=="function"?o.apply:function(x,w,S){return Function.prototype.apply.call(x,w,S)};a=o&&typeof o.ownKeys=="function"?o.ownKeys:Object.getOwnPropertySymbols?function(x){return Object.getOwnPropertyNames(x).concat(Object.getOwnPropertySymbols(x))}:function(x){return Object.getOwnPropertyNames(x)};var l=Number.isNaN||function(x){return x!=x};function c(){c.init.call(this)}n.exports=c,c.EventEmitter=c,c.prototype._events=void 0,c.prototype._eventsCount=0,c.prototype._maxListeners=void 0;var f=10;function u(x){if(typeof x!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof x)}function d(x){return x._maxListeners===void 0?c.defaultMaxListeners:x._maxListeners}function h(x,w,S,T){var _,D,I,R;if(u(S),(D=x._events)===void 0?(D=x._events=Object.create(null),x._eventsCount=0):(D.newListener!==void 0&&(x.emit("newListener",w,S.listener?S.listener:S),D=x._events),I=D[w]),I===void 0)I=D[w]=S,++x._eventsCount;else if(typeof I=="function"?I=D[w]=T?[S,I]:[I,S]:T?I.unshift(S):I.push(S),(_=d(x))>0&&I.length>_&&!I.warned){I.warned=!0;var M=new Error("Possible EventEmitter memory leak detected. "+I.length+" "+String(w)+" listeners added. Use emitter.setMaxListeners() to increase limit");M.name="MaxListenersExceededWarning",M.emitter=x,M.type=w,M.count=I.length,R=M,console&&console.warn&&console.warn(R)}return x}function p(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function g(x,w,S){var T={fired:!1,wrapFn:void 0,target:x,type:w,listener:S},_=p.bind(T);return _.listener=S,T.wrapFn=_,_}function m(x,w,S){var T=x._events;if(T===void 0)return[];var _=T[w];return _===void 0?[]:typeof _=="function"?S?[_.listener||_]:[_]:S?(function(D){for(var I=new Array(D.length),R=0;R<I.length;++R)I[R]=D[R].listener||D[R];return I})(_):v(_,_.length)}function y(x){var w=this._events;if(w!==void 0){var S=w[x];if(typeof S=="function")return 1;if(S!==void 0)return S.length}return 0}function v(x,w){for(var S=new Array(w),T=0;T<w;++T)S[T]=x[T];return S}Object.defineProperty(c,"defaultMaxListeners",{enumerable:!0,get:function(){return f},set:function(x){if(typeof x!="number"||x<0||l(x))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+x+".");f=x}}),c.init=function(){this._events!==void 0&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},c.prototype.setMaxListeners=function(x){if(typeof x!="number"||x<0||l(x))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+x+".");return this._maxListeners=x,this},c.prototype.getMaxListeners=function(){return d(this)},c.prototype.emit=function(x){for(var w=[],S=1;S<arguments.length;S++)w.push(arguments[S]);var T=x==="error",_=this._events;if(_!==void 0)T=T&&_.error===void 0;else if(!T)return!1;if(T){var D;if(w.length>0&&(D=w[0]),D instanceof Error)throw D;var I=new Error("Unhandled error."+(D?" ("+D.message+")":""));throw I.context=D,I}var R=_[x];if(R===void 0)return!1;if(typeof R=="function")s(R,this,w);else{var M=R.length,A=v(R,M);for(S=0;S<M;++S)s(A[S],this,w)}return!0},c.prototype.addListener=function(x,w){return h(this,x,w,!1)},c.prototype.on=c.prototype.addListener,c.prototype.prependListener=function(x,w){return h(this,x,w,!0)},c.prototype.once=function(x,w){return u(w),this.on(x,g(this,x,w)),this},c.prototype.prependOnceListener=function(x,w){return u(w),this.prependListener(x,g(this,x,w)),this},c.prototype.removeListener=function(x,w){var S,T,_,D,I;if(u(w),(T=this._events)===void 0)return this;if((S=T[x])===void 0)return this;if(S===w||S.listener===w)--this._eventsCount==0?this._events=Object.create(null):(delete T[x],T.removeListener&&this.emit("removeListener",x,S.listener||w));else if(typeof S!="function"){for(_=-1,D=S.length-1;D>=0;D--)if(S[D]===w||S[D].listener===w){I=S[D].listener,_=D;break}if(_<0)return this;_===0?S.shift():(function(R,M){for(;M+1<R.length;M++)R[M]=R[M+1];R.pop()})(S,_),S.length===1&&(T[x]=S[0]),T.removeListener!==void 0&&this.emit("removeListener",x,I||w)}return this},c.prototype.off=c.prototype.removeListener,c.prototype.removeAllListeners=function(x){var w,S,T;if((S=this._events)===void 0)return this;if(S.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):S[x]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete S[x]),this;if(arguments.length===0){var _,D=Object.keys(S);for(T=0;T<D.length;++T)(_=D[T])!=="removeListener"&&this.removeAllListeners(_);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(typeof(w=S[x])=="function")this.removeListener(x,w);else if(w!==void 0)for(T=w.length-1;T>=0;T--)this.removeListener(x,w[T]);return this},c.prototype.listeners=function(x){return m(this,x,!0)},c.prototype.rawListeners=function(x){return m(this,x,!1)},c.listenerCount=function(x,w){return typeof x.listenerCount=="function"?x.listenerCount(w):y.call(x,w)},c.prototype.listenerCount=y,c.prototype.eventNames=function(){return this._eventsCount>0?a(this._events):[]}},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(77);r.createCB=function(o){return new a.XMLBuilderCBImpl(o)},r.fragmentCB=function(o){return new a.XMLBuilderCBImpl(o,!0)}}])}))})(wb)),wb.exports}var d9e=f9e(),Ks=Uint8Array,Mh=Uint16Array,_J=Uint32Array,DJ=new Ks([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),OJ=new Ks([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),h9e=new Ks([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),MJ=function(t,e){for(var n=new Mh(31),r=0;r<31;++r)n[r]=e+=1<<t[r-1];for(var i=new _J(n[30]),r=1;r<30;++r)for(var a=n[r];a<n[r+1];++a)i[a]=a-n[r]<<5|r;return[n,i]},IJ=MJ(DJ,2),RJ=IJ[0],p9e=IJ[1];RJ[28]=258,p9e[258]=28;var g9e=MJ(OJ,0),m9e=g9e[0],F6=new Mh(32768);for(var ci=0;ci<32768;++ci){var vd=(ci&43690)>>>1|(ci&21845)<<1;vd=(vd&52428)>>>2|(vd&13107)<<2,vd=(vd&61680)>>>4|(vd&3855)<<4,F6[ci]=((vd&65280)>>>8|(vd&255)<<8)>>>1}var Uv=(function(t,e,n){for(var r=t.length,i=0,a=new Mh(e);i<r;++i)t[i]&&++a[t[i]-1];var o=new Mh(e);for(i=0;i<e;++i)o[i]=o[i-1]+a[i-1]<<1;var s;if(n){s=new Mh(1<<e);var l=15-e;for(i=0;i<r;++i)if(t[i])for(var c=i<<4|t[i],f=e-t[i],u=o[t[i]-1]++<<f,d=u|(1<<f)-1;u<=d;++u)s[F6[u]>>>l]=c}else for(s=new Mh(r),i=0;i<r;++i)t[i]&&(s[i]=F6[o[t[i]-1]++]>>>15-t[i]);return s}),fy=new Ks(288);for(var ci=0;ci<144;++ci)fy[ci]=8;for(var ci=144;ci<256;++ci)fy[ci]=9;for(var ci=256;ci<280;++ci)fy[ci]=7;for(var ci=280;ci<288;++ci)fy[ci]=8;var AJ=new Ks(32);for(var ci=0;ci<32;++ci)AJ[ci]=5;var v9e=Uv(fy,9,1),y9e=Uv(AJ,5,1),u8=function(t){for(var e=t[0],n=1;n<t.length;++n)t[n]>e&&(e=t[n]);return e},ec=function(t,e,n){var r=e/8|0;return(t[r]|t[r+1]<<8)>>(e&7)&n},f8=function(t,e){var n=e/8|0;return(t[n]|t[n+1]<<8|t[n+2]<<16)>>(e&7)},x9e=function(t){return(t+7)/8|0},b9e=function(t,e,n){(n==null||n>t.length)&&(n=t.length);var r=new(t.BYTES_PER_ELEMENT==2?Mh:t.BYTES_PER_ELEMENT==4?_J:Ks)(n-e);return r.set(t.subarray(e,n)),r},w9e=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],lc=function(t,e,n){var r=new Error(e||w9e[t]);if(r.code=t,Error.captureStackTrace&&Error.captureStackTrace(r,lc),!n)throw r;return r},QD=function(t,e,n){var r=t.length;if(!r||n&&n.f&&!n.l)return e||new Ks(0);var i=!e||n,a=!n||n.i;n||(n={}),e||(e=new Ks(r*3));var o=function(Ce){var we=e.length;if(Ce>we){var Ae=new Ks(Math.max(we*2,Ce));Ae.set(e),e=Ae}},s=n.f||0,l=n.p||0,c=n.b||0,f=n.l,u=n.d,d=n.m,h=n.n,p=r*8;do{if(!f){s=ec(t,l,1);var g=ec(t,l+1,3);if(l+=3,g)if(g==1)f=v9e,u=y9e,d=9,h=5;else if(g==2){var x=ec(t,l,31)+257,w=ec(t,l+10,15)+4,S=x+ec(t,l+5,31)+1;l+=14;for(var T=new Ks(S),_=new Ks(19),D=0;D<w;++D)_[h9e[D]]=ec(t,l+D*3,7);l+=w*3;for(var I=u8(_),R=(1<<I)-1,M=Uv(_,I,1),D=0;D<S;){var A=M[ec(t,l,R)];l+=A&15;var m=A>>>4;if(m<16)T[D++]=m;else{var L=0,P=0;for(m==16?(P=3+ec(t,l,3),l+=2,L=T[D-1]):m==17?(P=3+ec(t,l,7),l+=3):m==18&&(P=11+ec(t,l,127),l+=7);P--;)T[D++]=L}}var B=T.subarray(0,x),U=T.subarray(x);d=u8(B),h=u8(U),f=Uv(B,d,1),u=Uv(U,h,1)}else lc(1);else{var m=x9e(l)+4,y=t[m-4]|t[m-3]<<8,v=m+y;if(v>r){a&&lc(0);break}i&&o(c+y),e.set(t.subarray(m,v),c),n.b=c+=y,n.p=l=v*8,n.f=s;continue}if(l>p){a&&lc(0);break}}i&&o(c+131072);for(var G=(1<<d)-1,F=(1<<h)-1,$=l;;$=l){var L=f[f8(t,l)&G],V=L>>>4;if(l+=L&15,l>p){a&&lc(0);break}if(L||lc(2),V<256)e[c++]=V;else if(V==256){$=l,f=null;break}else{var X=V-254;if(V>264){var D=V-257,Q=DJ[D];X=ec(t,l,(1<<Q)-1)+RJ[D],l+=Q}var re=u[f8(t,l)&F],ye=re>>>4;re||lc(3),l+=re&15;var U=m9e[ye];if(ye>3){var Q=OJ[ye];U+=f8(t,l)&(1<<Q)-1,l+=Q}if(l>p){a&&lc(0);break}i&&o(c+131072);for(var me=c+X;c<me;c+=4)e[c]=e[c-U],e[c+1]=e[c+1-U],e[c+2]=e[c+2-U],e[c+3]=e[c+3-U];c=me}}n.l=f,n.p=$,n.b=c,n.f=s,f&&(s=1,n.m=d,n.d=u,n.n=h)}while(!s);return c==e.length?e:b9e(e,0,c)},C9e=new Ks(0),S9e=function(t){(t[0]!=31||t[1]!=139||t[2]!=8)&&lc(6,"invalid gzip data");var e=t[3],n=10;e&4&&(n+=t[10]|(t[11]<<8)+2);for(var r=(e>>3&1)+(e>>4&1);r>0;r-=!t[n++]);return n+(e&2)},T9e=function(t){var e=t.length;return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0},E9e=function(t){((t[0]&15)!=8||t[0]>>>4>7||(t[0]<<8|t[1])%31)&&lc(6,"invalid zlib data"),t[1]&32&&lc(6,"invalid zlib data: preset dictionaries not supported")};function _9e(t,e){return QD(t,e)}function D9e(t,e){return QD(t.subarray(S9e(t),-8),new Ks(T9e(t)))}function O9e(t,e){return QD((E9e(t),t.subarray(2,-4)),e)}function M9e(t,e){return t[0]==31&&t[1]==139&&t[2]==8?D9e(t):(t[0]&15)!=8||t[0]>>4>7||(t[0]<<8|t[1])%31?_9e(t,e):O9e(t,e)}var I9e=typeof TextDecoder<"u"&&new TextDecoder,R9e=0;try{I9e.decode(C9e,{stream:!0}),R9e=1}catch{}const js=[];js[45]=62;js[95]=63;const wg="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(let t=0;t<wg.length;t++)js[wg.charCodeAt(t)]=t;function Wc(t){return js[t.charCodeAt(0)]!==void 0}function A9e(t){const e=t.length,n=[];let r=null;for(let i=0;i<e;i++)Wc(t[i])?(r||(r={start:i,count:0}),r.count++,r.end=i):t[i]==="="&&r&&(n.push(r),r=null);return r&&n.push(r),n}function P9e(t,e,n,r){const{start:i,count:a}=e,o=a%4,s=Math.floor(a/4);let l=i,c=null,f=n;for(let u=0;u<s;u++){for(;!Wc(t[l]);)l++;for(c=js[t.charCodeAt(l++)]<<18;!Wc(t[l]);)l++;for(c|=js[t.charCodeAt(l++)]<<12;!Wc(t[l]);)l++;for(c|=js[t.charCodeAt(l++)]<<6;!Wc(t[l]);)l++;c|=js[t.charCodeAt(l++)],r[f++]=c>>16&255,r[f++]=c>>8&255,r[f++]=c&255}switch(o){case 3:for(;!Wc(t[l]);)l++;for(c=js[t.charCodeAt(l++)]<<10;!Wc(t[l]);)l++;for(c|=js[t.charCodeAt(l++)]<<4;!Wc(t[l]);)l++;c|=js[t.charCodeAt(l++)]>>2,r[f++]=c>>8&255,r[f++]=c&255;break;case 2:for(;!Wc(t[l]);)l++;for(c=js[t.charCodeAt(l++)]<<2;!Wc(t[l]);)l++;c|=js[t.charCodeAt(l++)]>>4,r[f++]=c&255;break;case 1:throw new Error("BASE64: remain 1 should not happen")}return f}function N9e(t){const e=A9e(t),n=e[e.length-1].end+1,r=(4-n%4)%4,i=(n+r)*3/4-r,a=new ArrayBuffer(i),o=new Uint8Array(a);let s=0;for(let l=0;l<e.length;l++)s+=P9e(t,e[l],s,o),s+=(4-e[l].count%4)%4;return a}function Dk(t,e,n){const r=(t<<16)+(e<<8)+n;return wg[r>>18]+wg[r>>12&63]+wg[r>>6&63]+wg[r&63]}function L9e(t){const e=new Uint8Array(t),n=t.byteLength%3,r=t.byteLength-n,i=Array(r/3);for(let a=0;a<i.length;a++){const o=a*3;i[a]=Dk(e[o],e[o+1],e[o+2])}if(n>0){const a=Dk(e[r],e[r+1]||0,e[r+2]||0);n===1?i.push(`${a.substr(0,2)}==`):n===2&&i.push(`${a.substr(0,3)}=`)}return i.join("")}var e7={toArrayBuffer:N9e,fromArrayBuffer:L9e};function k9e(t,e){e.classHierarchy.push("vtkStringArray"),t.getComponent=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return e.values[n*e.numberOfComponents+r]},t.setComponent=(n,r,i)=>{i!==e.values[n*e.numberOfComponents+r]&&(e.values[n*e.numberOfComponents+r]=i,t.modified())},t.getData=()=>e.values,t.getTuple=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const i=e.numberOfComponents||1;r.length&&(r.length=i);const a=n*i;for(let o=0;o<i;o++)r[o]=e.values[a+o];return r},t.getTupleLocation=function(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:1)*e.numberOfComponents},t.getNumberOfComponents=()=>e.numberOfComponents,t.getNumberOfValues=()=>e.values.length,t.getNumberOfTuples=()=>e.values.length/e.numberOfComponents,t.getDataType=()=>e.dataType,t.newClone=()=>NJ({name:e.name,numberOfComponents:e.numberOfComponents,empty:!0}),t.getName=()=>(e.name||t.setName(`vtkStringArray${t.getMTime()}`),e.name),t.setData=(n,r)=>{e.values=n,e.size=n.length,r&&(e.numberOfComponents=r),e.size%e.numberOfComponents!==0&&(e.numberOfComponents=1),t.modified()}}const V9e={name:"",numberOfComponents:1,size:0,dataType:"string"};function PJ(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(Object.assign(e,V9e,n),!e.empty&&!e.values&&!e.size)throw new TypeError("Cannot create vtkStringArray object without: size > 0, values");e.values?Array.isArray(e.values)&&(e.values=[...e.values]):e.values=[],e.values&&(e.size=e.values.length),le.obj(t,e),le.set(t,e,["name"]),k9e(t,e)}const NJ=le.newInstance(PJ,"vtkStringArray");var F9e={newInstance:NJ,extend:PJ};function U9e(t,e){return[...t.getElementsByTagName(e)]}function Ok(t,e){return U9e(t,e)[0]}function B9e(t){return d9e.create(t)}function $9e(t){const e=/^\s*<AppendedData\s+encoding="raw">\s*_/m,n=/\n\s*<\/AppendedData>/m;return T2.extractBinary(t,e,n)}const Qd={Int8:Int8Array,UInt8:Uint8Array,Int16:Int16Array,UInt16:Uint16Array,Int32:Int32Array,UInt32:Uint32Array,Int64:Int32Array,UInt64:Uint32Array,Float32:Float32Array,Float64:Float64Array},E2={Int8:1,UInt8:1,Int16:2,UInt16:2,Int32:4,UInt32:4,Int64:8,UInt64:8,Float32:4,Float64:8};function U6(t){const e=t.length-1;return t.filter((n,r)=>r<e&&r%2===0)}function B6(t,e,n){if(!["UInt64","UInt32"].includes(n))throw new Error(`Cannot handle a header type of ${n}`);let r=Qd[n],i=Qd[e],a=!1;n==="UInt64"&&(r=Qd.UInt32),/^U?Int64$/.test(e)&&(a=!0,i=Qd[e.replace("64","32")]);const{byteOffset:o}=t,s=E2[e],l=E2[n];let c;o%l===0?c=new r(t.buffer,o,1):c=new r(t.buffer.slice(o,o+l));const f=Number(c[0]);let u,d=f/s;a&&(d*=2);const h=o+l;return h%s===0?u=new i(t.buffer,h,d):u=new i(t.buffer.slice(h,h+f)),a&&(u=U6(u)),u}function G9e(t,e){if(e==="UInt64"){let c=new Uint32Array(t.buffer,0,6);const f=c[0],u=c[2],d=c[4],h=[8,f,u,d];c=new Uint32Array(t.buffer,24,f*2);for(let p=0;p<f;p++)h.push(c[p*2]);return h}let n=new Uint32Array(t.buffer,0,3);const r=4,i=n[0],a=n[1],o=n[2],s=[r,i,a,o];n=new Uint32Array(t.buffer,12,i);for(let l=0;l<i;l++)s.push(n[l]);return s}function j9e(t,e){const[n]=t;return(t.length-1)*n}function z9e(t,e){const n=M9e(t);e.uint8.set(n,e.offset),e.offset+=n.length}function t7(t,e){const n=G9e(t,e),r=n[1],i=n[2],a=n[3];let o=0;r>0&&(a===0?o=r*i:o=(r-1)*i+a);const s=new ArrayBuffer(o),l={offset:0,uint8:new Uint8Array(s)};let c=j9e(n);for(;c<t.length&&t[c]!==120;)c++;for(let f=0;f<r;f++){const u=n[4+f],d=new Uint8Array(t.buffer,c,u);z9e(d,l),c+=u}return l.uint8}function _2(t,e,n,r,i,a){const o=e.getAttribute("type"),s=e.getAttribute("Name"),l=e.getAttribute("format"),c=Number(e.getAttribute("NumberOfComponents")||"1");let f=null;if(l==="ascii"){f=new Qd[o](t*c);let u=0;e.firstChild.nodeValue.split(/[\\t \\n]+/).forEach(d=>{d.trim().length&&(f[u++]=Number(d))})}else if(l==="binary"){const u=new Uint8Array(e7.toArrayBuffer(e.firstChild.nodeValue.trim()));if(n==="vtkZLibDataCompressor"){const d=t7(u,i);f=new Qd[o](d.buffer),/^U?Int64$/.test(o)&&(f=U6(f))}else f=new Qd[o](u.buffer,E2[i]),o.indexOf("Int64")!==-1&&(f=U6(f))}else if(l==="appended"){const u=Number(e.getAttribute("offset"));f=B6(new Uint8Array(a,u),o,i)}else console.error("Format not supported",l);return{name:s,values:f,numberOfComponents:c}}function d8(t){return new TextDecoder().decode(t).split("\0").slice(0,-1)}function W9e(t,e,n,r,i){const a=t.getAttribute("Name"),o=t.getAttribute("format"),s=Number(t.getAttribute("NumberOfComponents")||"1"),c=Number(t.getAttribute("NumberOfTuples")||"1")*s,f=[];if(o==="ascii"){const u=t.firstChild.nodeValue.trim().split(/\s+/);let d=0;const h=[];for(;f.length<c;){const p=Number(u[d++]);p===0?(f.push(h.join("")),h.length=0):h.push(String.fromCharCode(p))}}else if(o==="binary"){const u=new Uint8Array(e7.toArrayBuffer(t.firstChild.nodeValue.trim()));if(e==="vtkZLibDataCompressor"){const d=t7(u,r);f.push(...d8(d))}else{const d=B6(u,"UInt8",r);f.push(...d8(d))}}else if(o==="appended"){const u=Number(t.getAttribute("offset")),d=B6(new Uint8Array(i,u),"UInt8",r);f.push(...d8(d))}else le.vtkErrorMacro(`Format not supported: ${o}`);return{name:a,values:f,numberOfComponents:s}}function H9e(t,e,n,r,i,a){const o={},s=e.getElementsByTagName("DataArray");for(let p=0;p<s.length;p++){const g=s[p];o[g.getAttribute("Name")]=g}const l=_2(t,o.offsets,n,r,i,a).values,c=l[l.length-1],f=_2(c,o.connectivity,n,r,i,a).values,u=new Uint32Array(t+c);let d=0,h=0;return l.forEach(p=>{const g=p-h;u[d++]=g;for(let m=0;m<g;m++)u[d++]=f[h+m];h=p}),u}function K9e(t,e,n,r,i,a,o){if(e){const s=["Scalars","Vectors","Normals","Tensors","TCoords"],l={};s.forEach(u=>{const d=e.getAttribute(u);d&&(l[d]=n[`set${u}`])});const c=e.getElementsByTagName("DataArray"),f=c.length;for(let u=0;u<f;u++){const d=c[u],h=nn.newInstance(_2(t,d,r,i,a,o)),p=h.getName();(l[p]||n.addArray)(h)}}}function q9e(t,e,n,r,i){const a=[...t.getElementsByTagName("DataArray")].map(s=>nn.newInstance(_2(Number(s.getAttribute("NumberOfTuples")),s,e,n,r,i))),o=[...t.getElementsByTagName("Array")].filter(s=>s.getAttribute("type")==="String").map(s=>F9e.newInstance(W9e(s,e,n,r,i)));return[...a,...o]}function X9e(t,e){e.classHierarchy.push("vtkXMLReader"),e.dataAccessHelper||(e.dataAccessHelper=uy.get("http"));function n(r){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return e.dataAccessHelper.fetchBinary(r,i)}t.setUrl=function(r){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e.url=r;const a=r.split("/");return a.pop(),e.baseURL=a.join("/"),t.loadData(i)},t.loadData=function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return n(e.url,r).then(t.parseAsArrayBuffer)},t.parseAsArrayBuffer=r=>{if(!r)return!1;if(r!==e.rawDataBuffer)t.modified();else return!0;const{text:i,binaryBuffer:a}=$9e(r);e.rawDataBuffer=r,e.binaryBuffer=a;const s=B9e(i).root(),l=s.node,c=l.getAttribute("type"),f=l.getAttribute("compressor"),u=l.getAttribute("byte_order"),d=l.getAttribute("header_type")||"UInt32";if(f&&f!=="vtkZLibDataCompressor")return console.error("Invalid compressor",f),!1;if(u&&u!=="LittleEndian")return console.error("Only LittleEndian encoding is supported"),!1;if(c!==e.dataType)return console.error("Invalid data type",c,"expecting",e.dataType),!1;if(Ok(l,"AppendedData")){const g=Ok(l,"AppendedData"),m=g.getAttribute("encoding"),y=s.filter(_=>{const{node:D}=_;return D.nodeType===Node.ELEMENT_NODE&&D.getAttribute("format")==="appended"&&D.hasAttribute("offset")},!1,!0).map(_=>({node:_.node,offset:Number(_.node.getAttribute("offset"))}));y.sort((_,D)=>_.offset-D.offset);let v=e.binaryBuffer;m==="base64"&&(v=g.textContent.trim().substr(1));const x=[];for(let _=0;_<y.length;++_){const D=y[_].offset;let I=0;_===y.length-1?I=v.length||v.byteLength:I=y[_+1].offset,m==="base64"?x.push(new Uint8Array(e7.toArrayBuffer(v.substring(D,I)))):x.push(new Uint8Array(v.slice(D,I)))}if(f==="vtkZLibDataCompressor")for(let _=0;_<x.length;++_){const D=x[_],I=t7(D,d),R=new Uint8Array(I.length+E2[d]);new Qd[d](R.buffer,0,1)[0]=I.length,R.set(I,E2[d]),x[_]=R}const w=x.reduce((_,D)=>_+D.length,0),S=new ArrayBuffer(w),T=new Uint8Array(S);for(let _=0,D=0;_<x.length;++_)y[_].node.setAttribute("offset",D),T.set(x[_],D),D+=x[_].length;if(e.binaryBuffer=S,!e.binaryBuffer)return console.error("Processing appended data format: requires binaryBuffer to parse"),!1}t.parseXML(l,c,f,u,d);const p=l.getElementsByTagName(c)[0].getElementsByTagName("FieldData")[0];if(p){const g=q9e(p,f,u,d,e.binaryBuffer);for(let m=0;m<e.output.length;m++){const y=e.output[m].getFieldData();for(let v=0;v<g.length;v++)y.addArray(g[v])}}return!0},t.requestData=(r,i)=>{t.parseAsArrayBuffer(e.rawDataBuffer)}}const Y9e={};function J9e(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Y9e,n),le.obj(t,e),le.get(t,e,["url","baseURL"]),le.setGet(t,e,["dataAccessHelper"]),le.algo(t,e,0,1),X9e(t,e)}var D2={extend:J9e,processDataArray:_2,processFieldData:K9e,processCells:H9e};function Z9e(t,e,n,r,i,a,o){const s=Number(n.getAttribute(`NumberOf${e}`));if(s>0){const l=n.getElementsByTagName(e)[0].getElementsByTagName("DataArray")[0],{values:c,numberOfComponents:f}=D2.processDataArray(s,l,r,i,a,o);t[`get${e}`]().setData(c,f)}return s}function Q9e(t,e,n,r,i,a,o){const s=Number(n.getAttribute(`NumberOf${e}`));if(s>0){const l=D2.processCells(s,n.getElementsByTagName(e)[0],r,i,a,o);t[`get${e}`]().setData(l)}return s}function eDe(t,e){e.classHierarchy.push("vtkXMLPolyDataReader"),t.parseXML=(n,r,i,a,o)=>{const l=n.getElementsByTagName(e.dataType)[0].getElementsByTagName("Piece"),c=l.length;for(let f=0;f<c;f++){const u=ra.newInstance(),d=l[f],h=Z9e(u,"Points",d,i,a,o,e.binaryBuffer);let p=0;["Verts","Lines","Strips","Polys"].forEach(g=>{p+=Q9e(u,g,d,i,a,o,e.binaryBuffer)}),D2.processFieldData(h,d.getElementsByTagName("PointData")[0],u.getPointData(),i,a,o,e.binaryBuffer),D2.processFieldData(p,d.getElementsByTagName("CellData")[0],u.getCellData(),i,a,o,e.binaryBuffer),e.output[f]=u}}}const tDe={dataType:"PolyData"};function LJ(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,tDe,n),D2.extend(t,e,n),eDe(t,e)}const nDe=le.newInstance(LJ,"vtkXMLPolyDataReader");var rDe={newInstance:nDe,extend:LJ};const Mn={};function h8(t,e,n,r,i){for(let a=0;a<i;a++)n[r+a]=t[e+a]}function iDe(t){Mn.splitOn=t,Mn.pieces=[],Mn.v=[],Mn.vt=[],Mn.vn=[],Mn.f=[[]],Mn.size=0}function aDe(t){const e=t.split("/").map(a=>Number(a));let n=e[0]-1;n=n<0?n+1+Mn.v.length/3:n;let r=e[1]?e[1]-1:n;r=r<0?r+1+Mn.vt.length/2:r;let i=e[2]?e[2]-1:n;return i=i<0?i+1+Mn.vn.length/3:i,[n,r,i]}function oDe(t){if(t[0]==="#")return;const e=t.split(/[ \t]+/);if(e[0]===Mn.splitOn)e.shift(),Mn.pieces.push(e.join(" ").trim()),Mn.f.push([]),Mn.size++;else if(e[0]==="v")Mn.v.push(Number(e[1])),Mn.v.push(Number(e[2])),Mn.v.push(Number(e[3]));else if(e[0]==="vt")Mn.vt.push(Number(e[1])),Mn.vt.push(Number(e[2]));else if(e[0]==="vn")Mn.vn.push(Number(e[1])),Mn.vn.push(Number(e[2])),Mn.vn.push(Number(e[3]));else if(e[0]==="f"){Mn.size===0&&Mn.size++;const n=Mn.f[Mn.size-1];e.shift();const r=e.filter(a=>a.length>0&&a!=="\r"),i=r.length;n.push(i);for(let a=0;a<i;a++)n.push(aDe(r[a]))}}function sDe(t){const e=!!Mn.vt.length,n=!!Mn.vn.length;if(t.splitMode){t.numberOfOutputs=Mn.size;for(let r=0;r<Mn.size;r++){const i=Mn.f[r],a=i.length,o=Mn.v.length/3,s={};let l;if(t.trackDuplicates){const m=[];let y=0;for(let x=0;x<a;){const w=i[x++];for(let S=0;S<w;S++){const[T,_,D]=i[x++],I=`${T}/${_}/${D}`;s[I]===void 0&&(m[T]===void 0?m[T]=[I]:(m[T].push(I),++y),s[I]=T)}}l=new Uint16Array(o+y);let v=0;for(let x=0;x<m.length;++x){const w=m[x]?m[x].length:0;l[x]=w>1?o+v:x;for(let S=1;S<w;++S){const T=o+v++;l[T]=x,s[m[x][S]]=T}}}const c={},f=ra.newInstance({name:Mn.pieces[r]}),u=[],d=[],h=[],p=[];let g=0;for(;g<a;){const m=i[g];p.push(m);for(let y=0;y<m;y++){const[v,x,w]=i[g+y+1],S=`${v}/${x}/${w}`;if(c[S]===void 0){const T=t.trackDuplicates?s[S]:u.length/3;c[S]=T,h8(Mn.v,v*3,u,T*3,3),e&&h8(Mn.vt,x*2,d,T*2,2),n&&h8(Mn.vn,w*3,h,T*3,3)}p.push(c[S])}g+=m+1}if(f.getPoints().setData(Float32Array.from(u),3),t.trackDuplicates){const m=nn.newInstance({name:"Duplicates",values:l});f.getPointData().addArray(m)}if(f.getPolys().setData(Uint32Array.from(p)),e){const m=nn.newInstance({numberOfComponents:2,values:Float32Array.from(d),name:"TextureCoordinates"});f.getPointData().setTCoords(m)}if(n){const m=nn.newInstance({numberOfComponents:3,values:Float32Array.from(h),name:"Normals"});f.getPointData().setNormals(m)}t.output[r]=f}}else{t.numberOfOutputs=1;const r=ra.newInstance();if(r.getPoints().setData(Float32Array.from(Mn.v),3),e&&Mn.v.length/3===Mn.vt.length/2){const l=nn.newInstance({numberOfComponents:2,values:Float32Array.from(Mn.vt),name:"TextureCoordinates"});r.getPointData().setTCoords(l)}if(n&&Mn.v.length===Mn.vn.length){const l=nn.newInstance({numberOfComponents:3,values:Float32Array.from(Mn.vn),name:"Normals"});r.getPointData().setNormals(l)}const i=[],a=Mn.f[0],o=a.length;let s=0;for(;s<o;){const l=a[s];i.push(l);for(let c=0;c<l;c++){const[f]=a[s+c+1];i.push(f)}s+=l+1}r.getPolys().setData(Uint32Array.from(i)),t.output[0]=r}}function lDe(t,e){const n=[],r=t.getPointData().getArrayByName("Duplicates");if(r==null)return n;const i=r.getData(),a=Math.min(e,i[e]);n.push(a);let o=i[a];if(o!==a)for(;o<i.length&&i[o]===a;)n.push(o++);return n}const cDe={getPointDuplicateIds:lDe};function uDe(t,e){e.classHierarchy.push("vtkOBJReader"),e.dataAccessHelper||(e.dataAccessHelper=uy.get("http"));function n(r){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return e.dataAccessHelper.fetchText(t,r,i)}t.setUrl=function(r){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(r.indexOf(".obj")===-1&&!i.fullpath)e.baseURL=r,e.url=`${r}/index.obj`;else{e.url=r;const a=r.split("/");a.pop(),e.baseURL=a.join("/")}return t.loadData(i)},t.loadData=function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return n(e.url,r).then(i=>t.isDeleted()?!1:t.parseAsText(i))},t.parseAsText=r=>(r&&(r!==e.parseData&&t.modified(),e.parseData=r,e.numberOfOutputs=0,iDe(e.splitMode),r.split(`
`).forEach(oDe),sDe(e)),!0),t.requestData=(r,i)=>{t.parseAsText(e.parseData)},t.isBusy=()=>!!e.requestCount,t.getNumberOfOutputPorts=()=>e.numberOfOutputs}const fDe={numberOfOutputs:1,requestCount:0,splitMode:null,trackDuplicates:!1};function kJ(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,fDe,n),le.obj(t,e),le.get(t,e,["url","baseURL"]),le.setGet(t,e,["dataAccessHelper","splitMode","trackDuplicates"]),le.algo(t,e,0,1),le.event(t,e,"busy"),uDe(t,e)}const dDe=le.newInstance(kJ,"vtkOBJReader");var hDe={newInstance:dDe,extend:kJ,...cDe};function pDe(t,e){e.classHierarchy.push("vtkPolyDataNormals"),t.vtkPolyDataNormalsExecute=(n,r,i)=>{if(!i)return null;const a=new Float32Array(i.length),o=new Float32Array(3*n);let s=0,l=0;const c=r.length,f=[0,0,0],u=[0,0,0];for(let d=0;d<c;d+=l+1)if(l=r[d],!(l<3)){for(let h=1;h<=3;++h)f[h-1]=3*r[d+h];if(Rq.computeNormal(i.slice(f[0],f[0]+3),i.slice(f[1],f[1]+3),i.slice(f[2],f[2]+3),u),o[s++]=u[0],o[s++]=u[1],o[s++]=u[2],e.computePointNormals)for(let h=1;h<=l;++h){let p=3*r[d+h];a[p]+=u[0],a[++p]+=u[1],a[++p]+=u[2]}}if(e.computePointNormals){const d=[0,0,0];for(let h=0;h<i.length;)d[0]=a[h],d[1]=a[h+1],d[2]=a[h+2],Hs.normalize(d),a[h++]=d[0],a[h++]=d[1],a[h++]=d[2]}return[o,a]},t.requestData=(n,r)=>{if(!t.getNumberOfInputPorts())return;const a=n[0];if(!a)return;const o=ra.newInstance();o.setPoints(a.getPoints()),o.setVerts(a.getVerts()),o.setLines(a.getLines()),o.setPolys(a.getPolys()),o.setStrips(a.getStrips()),o.getPointData().passData(a.getPointData()),o.getCellData().passData(a.getCellData()),o.getFieldData().passData(a.getFieldData());const[s,l]=t.vtkPolyDataNormalsExecute(a.getNumberOfPolys(),a.getPolys().getData(),a.getPoints().getData());if(e.computePointNormals){const c=nn.newInstance({numberOfComponents:3,name:"Normals",values:l});o.getPointData().setNormals(c)}if(e.computeCellNormals){const c=nn.newInstance({numberOfComponents:3,name:"Normals",values:s});o.getCellData().setNormals(c)}r[0]=o}}function gDe(t){return{computeCellNormals:!1,computePointNormals:!0,...t}}function VJ(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,gDe(n)),le.obj(t,e),le.algo(t,e,1,1),le.setGet(t,e,["computeCellNormals","computePointNormals"]),pDe(t,e)}const mDe=le.newInstance(VJ,"vtkPolyDataNormals");var vDe={newInstance:mDe,extend:VJ};class yDe{constructor(e){this._color=[255,255,255],this._actors=[],this.id=e.id,this._color=e.color??this._color,this._format=e.format;const n=new TextDecoder,r=vDe.newInstance(),i=a=>{const o=m0.newInstance();o.setMapper(a);const s=up.newInstance();return s.setColor(this._color[0]/255,this._color[1]/255,this._color[2]/255),o.setProperty(s),o};if(this._format===qs.PLY){const a=gc.newInstance(),o=r9e.newInstance();o.parseAsArrayBuffer(e.arrayBuffer),a.setInputConnection(o.getOutputPort()),this._actors.push(i(a))}else if(this._format===qs.STL){const a=gc.newInstance(),o=c9e.newInstance();o.parseAsArrayBuffer(e.arrayBuffer),r.setInputConnection(o.getOutputPort()),a.setInputConnection(r.getOutputPort()),this._actors.push(i(a))}else if(this._format===qs.OBJ){const a=hDe.newInstance({splitMode:e.materialUrl?"usemtl":null});a.parseAsText(n.decode(e.arrayBuffer));const o=a.getNumberOfOutputPorts();for(let s=0;s<o;s++){const l=a.getOutputData(s),c=gc.newInstance();c.setInputData(l),this._actors.push(i(c))}}else if(this._format===qs.VTP){const a=gc.newInstance(),o=rDe.newInstance();o.parseAsArrayBuffer(e.arrayBuffer),a.setInputConnection(o.getOutputPort()),this._actors.push(i(a))}this.sizeInBytes=this._getSizeInBytes()}_getSizeInBytes(){let e=0;for(let n=0;n<this._actors.length;n++){const a=this._actors[n].getMapper().getInputData(),o=a.getPoints(),s=a.getPolys(),l=o.getData().length,c=s.getData().length;e+=l*4+c*4}return e}get defaultActor(){return this._actors[0]}get actors(){return this._actors}get color(){return this._color}get format(){return this._format}}var ac;(function(t){t[t.None=0]="None",t[t.Capture=1]="Capture",t[t.Bubble=2]="Bubble"})(ac||(ac={}));class cC{constructor(e){this._eventListeners=new Map,this._children=new Map,this._target=e}get isEmpty(){return this._eventListeners.size===0&&this._children.size===0}addEventListener(e,n,r){const i=e.indexOf(".");if(i!==-1){const o=e.substring(0,i);let s=this._children.get(o);s||(s=new cC(this._target),this._children.set(o,s)),e=e.substring(i+1),s.addEventListener(e,n,r)}else this._addEventListener(e,n,r)}removeEventListener(e,n,r){const i=e.indexOf(".");if(i!==-1){const o=e.substring(0,i),s=this._children.get(o);if(!s)return;e=e.substring(i+1),s.removeEventListener(e,n,r),s.isEmpty&&this._children.delete(o)}else this._removeEventListener(e,n,r)}reset(){Array.from(this._children.entries()).forEach(([e,n])=>{if(n.reset(),n.isEmpty)this._children.delete(e);else throw new Error("Child is not empty and cannot be removed")}),this._unregisterAllEvents()}_addEventListener(e,n,r){let i=this._eventListeners.get(e);i||(i=new Map,this._eventListeners.set(e,i));const o=r?.capture??!1?ac.Capture:ac.Bubble,s=i.get(n)??ac.None;if(s&o){console.warn("A listener is already registered for this phase");return}i.set(n,s|o),this._target.addEventListener(e,n,r)}_removeEventListener(e,n,r){const a=r?.capture??!1?ac.Capture:ac.Bubble,o=this._eventListeners.get(e);if(!o)return;(n?[n]:Array.from(o.keys())).forEach(l=>{const c=o.get(l)??ac.None;if(!!!(c&a))return;this._target.removeEventListener(e,l,r);const u=c^a;u===ac.None?o.delete(l):o.set(l,u)}),o.size||this._eventListeners.delete(e)}_unregisterAllListeners(e,n){Array.from(n.entries()).forEach(([r,i])=>{const a=ac.Capture;for(let o=a;i;o<<=1){if(!(i&o))continue;const s=o===ac.Capture;this.removeEventListener(e,r,{capture:s}),i^=o}})}_unregisterAllEvents(){Array.from(this._eventListeners.entries()).forEach(([e,n])=>{this._unregisterAllListeners(e,n)})}}class xDe{constructor(){this._targetsEventListeners=new Map}addEventListener(e,n,r,i){let a=this._targetsEventListeners.get(e);a||(a=new cC(e),this._targetsEventListeners.set(e,a)),a.addEventListener(n,r,i)}removeEventListener(e,n,r,i){const a=this._targetsEventListeners.get(e);a&&(a.removeEventListener(n,r,i),a.isEmpty&&this._targetsEventListeners.delete(e))}reset(){Array.from(this._targetsEventListeners.entries()).forEach(([e,n])=>{n.reset(),this._targetsEventListeners.delete(e)})}}const bDe=Object.freeze(Object.defineProperty({__proto__:null,MultiTargetEventListenerManager:xDe,TargetEventListeners:cC},Symbol.toStringTag,{value:"Module"}));function wDe(t,e){const n=t.getSize();for(let r=0;r<n;r++){const i=[];t.getNodeValue(r,i),i[1]=i[1]*e,i[2]=i[2]*e,i[3]=i[3]*e,t.setNodeValue(r,i)}}function CDe(t){let e=t[0],n=t[0],r;const i=t.length;for(let a=1;a<i;a++)r=t[a],e=Math.min(e,r),n=Math.max(n,r);return{min:e,max:n}}const SDe=Symbol("LastRuntimeId"),TDe={},EDe=4294967295,_De="-";function FJ(t,e,n){return DDe(t!==null&&typeof t=="object"?t:TDe,SDe,(typeof n=="number"&&n>0?n:EDe)>>>0).join(typeof e=="string"?e:_De)}function DDe(t,e,n){let r=t[e];r instanceof Array||(r=[0],Object.defineProperty(t,e,{value:r}));for(let i=!0,a=0;i&&a<r.length;++a){let o=r[a]|0;o<n?(i=!1,o=o+1):(o=0,a+1===r.length&&r.push(0)),r[a]=o}return r}const Mk={},ODe={add:(t,e)=>{const n=mi(t);Mk[n]=e},get:(t,e)=>{if(t==="calibratedPixelSpacing"){const n=mi(e);return Mk[n]}}};function MDe(t,e,n=1e-5){return Math.abs(t[0]+e[0])<n&&Math.abs(t[1]+e[1])<n&&Math.abs(t[2]+e[2])<n}function xa(t,e){return!(t[0]<0||t[0]>=e[0]||t[1]<0||t[1]>=e[1]||t[2]<0||t[2]>=e[2])}function IDe(t,e){let n;e?n=[$f(e)]:n=Fl();const r=[];return n.forEach(i=>{const a=t.getActors(),o=i.getVolumeViewports();for(const s of o){const l=s.getActors();if(l.length!==a.length)continue;a.every(({uid:f})=>l.find(u=>f===u.uid))&&r.push(s)}}),r}const UJ=t=>t.preScale.scaled&&t.preScale.scalingParameters.suvbw;function BJ(t,e,n=void 0,r="_thumbnails",i={displayArea:{imageArea:[1,1]}}){if(!t||!(t instanceof HTMLCanvasElement))throw new Error("canvas element is required");const a=!e.imageId,o=!a&&e,s=a&&e,c=`renderGPUViewport-${o.imageId||s.volumeId}`,f=document.createElement("div"),u=window.devicePixelRatio||1;i.displayArea||(i.displayArea={imageArea:[1,1]});const d=t.width,h=t.height;f.style.width=`${d/u+Yg}px`,f.style.height=`${h/u+Yg}px`,f.style.visibility="hidden",f.style.position="absolute",document.body.appendChild(f);const p=c.split(":").join("-");f.setAttribute("viewport-id-for-remove",p);const g=Ys(f),m=$f(r)||new YD(r);let y=m.getViewport(c);if(!y){const v={viewportId:c,type:a?br.ORTHOGRAPHIC:br.STACK,element:f,defaultOptions:{...i,suppressEvents:!0}};m.enableElement(v),y=m.getViewport(c)}return new Promise(v=>{let x=!1,{viewReference:w}=i;const S=T=>{if(x)return;if(w){const P=w;w=null,y.setViewReference(P),y.render();return}t.getContext("2d").drawImage(g,0,0,g.width,g.height,0,0,t.width,t.height);const D=y.canvasToWorld([0,0]),I=y.canvasToWorld([g.width/u,0]),R=y.canvasToWorld([0,g.height/u]),M=ur([0,0,0],y.canvasToWorld([1/u,0]),D),A=ur([0,0,0],y.canvasToWorld([0,1/u]),D),L=1;x=!0,f.removeEventListener(vt.IMAGE_RENDERED,S),setTimeout(()=>{m.disableElement(c),document.querySelectorAll(`[viewport-id-for-remove="${p}"]`).forEach(B=>{B.remove()})},0),v({origin:D,bottomLeft:R,topRight:I,thicknessMm:L,rightVector:M,downVector:A})};f.addEventListener(vt.IMAGE_RENDERED,S),a?y.setVolumes([s],!1,!0):y.renderImageObject(e),y.resetCamera(),n==="PT"&&!UJ(o)&&y.setProperties({voiRange:{lower:o.minPixelValue,upper:o.maxPixelValue}}),y.render()})}function $J(t,e,n,r,i){if(e.volumeId)throw new Error("Unsupported volume rendering for CPU");const o=e,s=fJ(t,o,n),l={canvas:t,viewport:s,image:o,renderingTools:{}};l.transform=S2(l);const c=!0;return new Promise((f,u)=>{lJ(l,c),f(null)})}function RDe(t){const{canvas:e,imageId:n,viewReference:r,requestType:i=Dn.Thumbnail,priority:a=-5,renderingEngineId:o="_thumbnails",useCPURendering:s=!1,thumbnail:l=!1,imageAspect:c=!1,viewportOptions:f}=t,u=r?.volumeId,d=u&&!n,h=r&&f?{...f,viewReference:r}:f,p=s?$J:BJ;return new Promise((g,m)=>{function y(S,T){const{modality:_}=Ft("generalSeriesModule",T)||{},D=!d&&S,I=d&&S;D&&(D.isPreScaled=D.isPreScaled||D.preScale?.scaled),l&&(e.height=256,e.width=256),c&&D&&(e.width=D&&e.height*D.width/D.height),e.style.width=`${e.width/devicePixelRatio}px`,e.style.height=`${e.height/devicePixelRatio}px`,I&&s&&m(new Error("CPU rendering of volume not supported")),p(e,S,_,o,h).then(g)}function v(S,T){console.error(S,T),m(S)}function x(S,T,_){return v0(S,_).then(D=>{y.call(this,D,S)},D=>{v.call(this,D,S)})}const w={useRGBA:!!s,requestType:i};if(u){const S=yt.getVolume(u);S||m(new Error(`Volume id ${u} not found in cache`));const T=S.imageIds[0];y(S,T)}else Qo.addRequest(x.bind(null,n,null,w),i,{imageId:n},a)})}function $6(t){return Array.isArray(t)?t:[t]}const Ik={HISTORY_UNDO:"CORNERSTONE_TOOLS_HISTORY_UNDO",HISTORY_REDO:"CORNERSTONE_TOOLS_HISTORY_REDO"};class GJ{constructor(e="Tools",n=50){this.position=-1,this.redoAvailable=0,this.undoAvailable=0,this.ring=new Array,this.isRecordingGrouped=!1,this.label=e,this._size=n}get size(){return this._size}set size(e){this.ring=new Array(e),this._size=e,this.position=-1,this.redoAvailable=0,this.undoAvailable=0}get canUndo(){return this.undoAvailable>0}get canRedo(){return this.redoAvailable>0}undo(e=1){for(;e>0&&this.undoAvailable>0;){const n=this.ring[this.position];for(const r of $6(n).reverse())r.restoreMemo(!0),this.dispatchHistoryEvent({item:r,isUndo:!0});e--,this.redoAvailable++,this.undoAvailable--,this.position=(this.position-1+this.size)%this.size}}undoIf(e){return this.undoAvailable>0&&e(this.ring[this.position])?(this.undo(),!0):!1}dispatchHistoryEvent({item:e,isUndo:n}){e.id&&St.dispatchEvent(new CustomEvent(n?Ik.HISTORY_UNDO:Ik.HISTORY_REDO,{detail:{isUndo:n,id:e.id,operationType:e.operationType||"annotation",memo:e}}))}redo(e=1){for(;e>0&&this.redoAvailable>0;){const n=(this.position+1)%this.size,r=this.ring[n];for(const i of $6(r).reverse())i.restoreMemo(!1),this.dispatchHistoryEvent({item:i,isUndo:!1});e--,this.position=n,this.undoAvailable++,this.redoAvailable--}}initializeGroupItem(){this.redoAvailable=0,this.undoAvailable<this._size&&this.undoAvailable++,this.position=(this.position+1)%this._size,this.ring[this.position]=[]}startGroupRecording(){this.isRecordingGrouped=!0,this.initializeGroupItem()}rollbackUnusedGroupItem(){this.ring[this.position]=void 0,this.position=(this.position-1)%this._size,this.undoAvailable--}endGroupRecording(){this.isRecordingGrouped=!1;const e=this.ring[this.position];Array.isArray(e)&&e.length===0&&this.rollbackUnusedGroupItem()}pushGrouped(e){const n=this.ring[this.position];if(Array.isArray(n))return n.push(e),e;throw new Error("Last item should be an array for grouped memos.")}push(e){if(!e)return;const n=e.restoreMemo?e:e.createMemo?.();if(n)return this.isRecordingGrouped?this.pushGrouped(n):(this.redoAvailable=0,this.undoAvailable<this._size&&this.undoAvailable++,this.position=(this.position+1)%this._size,this.ring[this.position]=n,n)}}const jJ=new GJ,n7=Object.freeze(Object.defineProperty({__proto__:null,DefaultHistoryMemo:jJ,HistoryMemo:GJ},Symbol.toStringTag,{value:"Module"}));function ADe(t,e){const n=Ft("imagePlaneModule",t);if(!n)throw new Error(`No imagePlaneModule found for imageId: ${t}`);const{columnCosines:r,rowCosines:i,imagePositionPatient:a}=n;let{columnPixelSpacing:o,rowPixelSpacing:s}=n;o||=1,s||=1;const l=ct();Or(l,a,r,-o/2),Or(l,l,i,-s/2);const c=ct();ur(c,e,l);const f=zt(c,i),u=zt(c,r);return[f/s,u/o]}function PDe(t,e){const n=Ft("imagePlaneModule",t);if(!n)throw new Error(`No imagePlaneModule found for imageId: ${t}`);const{columnCosines:r,rowCosines:i,imagePositionPatient:a}=n;let{columnPixelSpacing:o,rowPixelSpacing:s}=n;o||=1,s||=1;const l=ct();return Or(l,a,i,s*(e[0]-.5)),Or(l,l,r,o*(e[1]-.5)),Array.from(l)}function P3(t){const e=Fl(),n=[];return e.forEach(r=>{r.getViewports().forEach(a=>{a.hasImageURI(t)&&n.push(a)})}),n}function zJ(t,e){const n=NDe(t,e);return n?n.index:null}function NDe(t,e){const n=e.getImageIds(),r=e.getCurrentImageIdIndex();if(n.length===0)return null;const i=l=>{const c=LDe(l);if(!c)return null;const f=UD(c.planeNormal,c.imagePositionPatient);return BD(f,t)},a={distance:i(n[r])??1/0,index:r},o=n.slice(r+1);for(let l=0;l<o.length;l++){const c=o[l],f=i(c);if(f!==null)if(f<=a.distance)a.distance=f,a.index=l+r+1;else break}const s=n.slice(0,r);for(let l=s.length-1;l>=0;l--){const c=s[l],f=i(c);if(!(f===null||f===a.distance))if(f<a.distance)a.distance=f,a.index=l;else break}return a.distance===1/0?null:a}function LDe(t){const e=Ft("imagePlaneModule",t);if(!e||!(e.rowCosines instanceof Array&&e.rowCosines.length===3)||!(e.columnCosines instanceof Array&&e.columnCosines.length===3)||!(e.imagePositionPatient instanceof Array&&e.imagePositionPatient.length===3))return null;const{rowCosines:n,columnCosines:r,imagePositionPatient:i}=e,a=c3(ct(),...n),o=c3(ct(),...r),s=dr(ct(),a,o);return{rowCosines:n,columnCosines:r,imagePositionPatient:i,planeNormal:s}}function WJ(t){const{width:e,height:n}=t.getCanvas(),{sliceToIndexMatrix:r,indexToSliceMatrix:i}=t.getSliceViewInfo(),a=Wd(t,[0,0]),o=Wd(t,[e-1,0]),s=Wd(t,[0,n-1]),l=ur(ct(),o,a),c=ur(ct(),s,a),f=dr(ct(),l,c);Ir(l,l),Ir(c,c),Ir(f,f);const u=Math.max(Math.abs(l[0]),Math.abs(l[1]),Math.abs(l[2])),d=Math.max(Math.abs(c[0]),Math.abs(c[1]),Math.abs(c[2]));if(!l3(1,u)||!l3(1,d))throw new Error("Livewire is not available for rotate/oblique viewports");const{voxelManager:h}=t.getImageData(),p=t.getSliceViewInfo(),g=h.getSliceData(p);return{width:p.width,height:p.height,scalarData:g,sliceToIndexMatrix:r,indexToSliceMatrix:i}}const J0={},N3={add:(t,e)=>{const[n,r]=t,i=`${n}_${r}`;J0[i]||(J0[i]={}),J0[i]=e},get:(t,e,n)=>{if(t!=="spatialRegistrationModule")return;const r=`${e}_${n}`;if(J0[r])return J0[r];const i=`${n}_${e}`;if(J0[i])return U9(h0(),J0[i])}};Fm(N3.get.bind(N3));const kDe=.05;function VDe(t,e){const n=t.getSliceIndex(),r=e.getSliceIndex(),i=Ft("imagePlaneModule",n.toString()),a=Ft("imagePlaneModule",r.toString());if(!i||!a){console.log("Viewport spatial registration requires image plane module");return}const{imageOrientationPatient:o}=a;if(!i.imageOrientationPatient.every((d,h)=>Math.abs(d-o[h])<kDe)){console.log("Viewport spatial registration only supported for same orientation (hence translation only) for now",i?.imageOrientationPatient,a?.imageOrientationPatient);return}const l=i.imagePositionPatient,c=a.imagePositionPatient,f=Dr(ct(),l,c),u=nK(h0(),f);N3.add([t.id,e.id],u)}function FDe(t){const{imageData:e,dimensions:n}=t.getImageData()||{};if(!e||!n)return[];const{canvas:r}=t,i=window.devicePixelRatio,a=[0,0],o=[r.width/i,0],s=[r.width/i,r.height/i],l=[0,r.height/i],c=t.canvasToWorld(a),f=t.canvasToWorld(o),u=t.canvasToWorld(s),d=t.canvasToWorld(l),h=e.worldToIndex(c),p=e.worldToIndex(f),g=e.worldToIndex(u),m=e.worldToIndex(d);return UDe({dimensions:n,imageData:e,topLeftImage:h,topRightImage:p,bottomRightImage:g,bottomLeftImage:m,topLeftWorld:c,topRightWorld:f,bottomRightWorld:u,bottomLeftWorld:d})}function UDe({dimensions:t,imageData:e,topLeftImage:n,topRightImage:r,bottomRightImage:i,bottomLeftImage:a,topLeftWorld:o,topRightWorld:s,bottomRightWorld:l,bottomLeftWorld:c}){const f=gx(n,t)?o:e.indexToWorld([0,0,0]),u=gx(r,t)?s:e.indexToWorld([t[0]-1,0,0]),d=gx(i,t)?l:e.indexToWorld([t[0]-1,t[1]-1,0]),h=gx(a,t)?c:e.indexToWorld([0,t[1]-1,0]);return[f,u,h,d]}function gx(t,e){return t[0]>0||t[0]<e[0]-1||t[1]>0||t[1]<e[1]-1||t[2]>0||t[2]<e[2]-1}function et(t){if(!t)return;const{viewportUid:e,renderingEngineUid:n}=t.dataset;return $m(e,n)}function $m(t,e){if(!e||!t)return;const n=$f(e);if(!n||n.hasBeenDestroyed)return;const r=n.getViewport(t);if(!r)return;const i=r.getFrameOfReferenceUID();return{viewport:r,renderingEngine:n,viewportId:t,renderingEngineId:e,FrameOfReferenceUID:i}}function mr(t){const e=Fl();for(let n=0;n<e.length;n++){const r=e[n];if(r.getViewport(t))return $m(t,r.id)}}function HJ(){const t=[];return Fl().forEach(n=>{n.getViewports().forEach(({element:i})=>{t.push(et(i))})}),t}function BDe(t){const e=et(t);if(!e)return;const{viewport:n}=e;if(!(n instanceof aa))throw new Error(`An image can only be fetched for a stack viewport and not for a viewport of type: ${n.type}`);return n.getCornerstoneImage()}function Gm(t){if(t.length<=1)return!1;const e=t[0],{modality:n,seriesInstanceUID:r}=Ft("generalSeriesModule",e),{imageOrientationPatient:i,pixelSpacing:a,frameOfReferenceUID:o,columns:s,rows:l,usingDefaultValues:c}=Ft("imagePlaneModule",e);if(c)return!1;const f={modality:n,imageOrientationPatient:i,pixelSpacing:a,columns:s,rows:l,seriesInstanceUID:r};let u=!0;for(let d=0;d<t.length;d++){const h=t[d],{modality:p,seriesInstanceUID:g}=Ft("generalSeriesModule",h),{imageOrientationPatient:m,pixelSpacing:y,columns:v,rows:x}=Ft("imagePlaneModule",h);if(g!==f.seriesInstanceUID){u=!1;break}if(p!==f.modality){u=!1;break}if(v!==f.columns){u=!1;break}if(x!==f.rows){u=!1;break}if(!fr(m,f.imageOrientationPatient)){u=!1;break}if(!fr(y,f.pixelSpacing)){u=!1;break}}return u}const $De=new Set(["1.2.840.10008.1.2.4.100","1.2.840.10008.1.2.4.100.1","1.2.840.10008.1.2.4.101","1.2.840.10008.1.2.4.101.1","1.2.840.10008.1.2.4.102","1.2.840.10008.1.2.4.102.1","1.2.840.10008.1.2.4.103","1.2.840.10008.1.2.4.103.1","1.2.840.10008.1.2.4.104","1.2.840.10008.1.2.4.104.1","1.2.840.10008.1.2.4.105","1.2.840.10008.1.2.4.105.1","1.2.840.10008.1.2.4.106","1.2.840.10008.1.2.4.106.1","1.2.840.10008.1.2.4.107","1.2.840.10008.1.2.4.108"]);function KJ(t){return t?(Array.isArray(t)?t:[t]).find(n=>$De.has(n)):!1}async function GDe({viewport:t,options:e={}}){const n=t.getRenderingEngine();let r=e.volumeId||`${or()}`;r.split(":").length===0&&(r=`${UY()}:${r}`);const{id:i,element:a}=t,o=e.viewportId||i,s=t.getImageIds(),l=t.getViewPresentation(),c=t.getViewReference();n.enableElement({viewportId:o,type:br.ORTHOGRAPHIC,element:a,defaultOptions:{background:e.background,orientation:e.orientation}}),(await kD(r,{imageIds:s})).load();const u=n.getViewport(o);await dJ(n,[{volumeId:r}],[o]);const d=()=>{u.render(),a.removeEventListener(vt.VOLUME_VIEWPORT_NEW_VOLUME,d)};return(()=>{a.addEventListener(vt.VOLUME_VIEWPORT_NEW_VOLUME,d)})(),u.setViewPresentation(l),u.setViewReference(c),u.render(),u}async function jDe({viewport:t,options:e}){const n=t,{id:r,element:i}=n,a=t.getRenderingEngine(),{background:o}=e,s=e.viewportId||r,l=yt.getVolume(n.getVolumeId());if(!(l instanceof Vm))throw new Error("Currently, you cannot decache a volume that is not an ImageVolume. So, unfortunately, volumes such as nifti  (which are basic Volume, without imageIds) cannot be decached.");const c={viewportId:s,type:br.STACK,element:i,defaultOptions:{background:o}},f=n.getViewReference();a.enableElement(c);const u=a.getViewport(s);return await u.setStack(l.imageIds),u.setViewReference(f),u.render(),u}function kn(t,e=2){if(Array.isArray(t))return t.map(i=>kn(i,e)).join(", ");if(t==null||t==="")return"NaN";t=Number(t);const n=Math.abs(t);if(n<1e-4)return`${t}`;const r=n>=100?e-2:n>=10?e-1:n>=1?e:n>=.1?e+1:n>=.01?e+2:n>=.001?e+3:e+4;return t.toFixed(r)}function Cb(t){return Math.round(t/Qs)*Qs}function qJ(t,e,n){const r=t.length===e*n*4,i=t.length===e*n*3;if(r||i){const a=new Float32Array(e*n);let o=0,s=0;const l=r?4:3;for(let c=0;c<e;c++)for(let f=0;f<n;f++){const u=t[o],d=t[o+1],h=t[o+2];a[s]=(u+d+h)/3,o+=l,s++}return a}else return t}function zDe(t){if(t instanceof oa)return yt.getVolume(t.getVolumeId()).imageIds;if(t.getImageIds)return t.getImageIds()}function r7(t,e){const n=[...t];return e>=n.length?(Rk(n),n):(Rk(n),n.slice(0,e))}function Rk(t){for(let e=t.length-1;e>0;e--){const n=Math.floor(Math.random()*(e+1));[t[e],t[n]]=[t[n],t[e]]}}function p8(t){const e=t.toString(16);return e.length==1?"0"+e:e}function WDe(t,e,n){return"#"+p8(t)+p8(e)+p8(n)}function HDe(t){const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null}const KDe=Object.freeze(Object.defineProperty({__proto__:null,hexToRgb:HDe,rgbToHex:WDe},Symbol.toStringTag,{value:"Module"}));function XJ(t,e){if(t===e)return!0;if(t==null||e==null)return!1;try{return JSON.stringify(t)===JSON.stringify(e)}catch(n){return console.debug("Error in JSON.stringify during deep comparison:",n),t===e}}function qDe(t,e,n){if(!n)throw new Error("getVolume is required, use the utilities export instead ");if(t.modality)return t.modality;if(t.setVolumes)return e=e??t.getVolumeId(),!e||!n?void 0:n(e).metadata.Modality;throw new Error("Invalid viewport type")}const XDe=(t,e)=>t.reduce((n,r)=>((n[r[e]]=n[r[e]]||[]).push(r),n),{});function YDe(t){const e=t.map(o=>{const{imagePositionPatient:s}=Ft("imagePlaneModule",o)||{};return{imageId:o,imagePositionPatient:s}});if(!e.every(o=>o.imagePositionPatient))return null;const n=XDe(e,"imagePositionPatient"),r=Object.keys(n),i=n[r[0]].length;return i===1||!r.every(o=>n[o].length===i)?null:n}function JDe(t,e){const n={};let r=[];const i=Object.keys(t);for(let a=0;a<i.length;a++){const o=new Set,s=t[i[a]];for(let l=0;l<s.length;l++){const c=e(s[l].imageId)||0;if(n[c]=n[c]||[],n[c].push({imageId:s[l].imageId}),o.add(c),o.size-1<l)return}if(a==0)r=Array.from(o);else if(!t7e(r,o))return}return n}function ev(t,e){const n=Ft(e,t);try{return parseFloat(n)}catch{return}}function ZDe(t){const e=Ft("20011003",t);try{const{InlineBinary:n}=e;if(n){const r=atob(n),i=new ArrayBuffer(r.length),a=new DataView(i);for(let o=0;o<r.length;o++)a.setUint8(o,r.charCodeAt(o));return new Float32Array(i)[0]}return parseFloat(e)}catch{return}}function QDe(t){let e=Ft("0019100c",t)||Ft("0019100C",t);try{const{InlineBinary:n}=e;return n&&(e=atob(n)),parseFloat(e)}catch{return}}function e7e(t){let e=Ft("00431039",t);try{const{InlineBinary:n}=e;return n&&(e=atob(n).split("//")),parseFloat(e[0])%1e5}catch{return}}function t7e(t,e){if(t.length!=e.size)return!1;for(let n=0;n<t.length;n++)if(!e.has(t[n]))return!1;return!0}function n7e(t){const e=Ft("petImageModule",t);return e?e.frameReferenceTime:0}function i7(t){const e=YDe(t);if(!e)return{imageIdGroups:[t],splittingTag:null};const n=["TemporalPositionIdentifier","DiffusionBValue","TriggerTime","EchoTime","EchoNumber","PhilipsPrivateBValue","SiemensPrivateBValue","GEPrivateBValue","PetFrameReferenceTime"],r=[i=>ev(i,n[0]),i=>ev(i,n[1]),i=>ev(i,n[2]),i=>ev(i,n[3]),i=>ev(i,n[4]),ZDe,QDe,e7e,n7e];for(let i=0;i<r.length;i++){const a=JDe(e,r[i]);if(a)return{imageIdGroups:Object.keys(a).map(Number.parseFloat).sort((l,c)=>l-c).map(l=>a[l].map(c=>c.imageId)),splittingTag:n[i]}}return{imageIdGroups:[t],splittingTag:null}}function r7e(t){const{imageIdGroups:e,splittingTag:n}=i7(t);return{isDynamicVolume:e.length>1,timePoints:e,splittingTag:n}}function i7e(t,e){const n=t.length,{rescaleSlope:r,rescaleIntercept:i,suvbw:a}=e;if(e.modality==="PT"&&typeof a=="number")for(let o=0;o<n;o++)t[o]=a*(t[o]*r+i);else for(let o=0;o<n;o++)t[o]=t[o]*r+i;return t}function YJ(t,e,n){return Math.min(Math.max(e,t),n)}function JJ(t,e){if(!et(t.element))throw new Error("Scroll::Viewport is not enabled (it might be disabled)");if(t instanceof aa&&t.getImageIds().length===0)throw new Error("Scroll::Stack Viewport has no images");const{volumeId:r,delta:i,scrollSlabs:a}=e;if(t instanceof oa)a7e(t,r,i,a);else{const o=t.getCurrentImageIdIndex();if(o+i>t.getImageIds().length-1||o+i<0){const s={imageIdIndex:o,direction:i};Ct(St,vt.STACK_SCROLL_OUT_OF_BOUNDS,s)}t.scroll(i,e.debounceLoading,e.loop)}}function a7e(t,e,n,r=!1){const i=r,{numScrollSteps:a,currentStepIndex:o,sliceRangeInfo:s}=qg(t,e,i);if(!s)return;const{sliceRange:l,spacingInNormalDirection:c,camera:f}=s,{focalPoint:u,viewPlaneNormal:d,position:h}=f,{newFocalPoint:p,newPosition:g}=Xg(u,h,l,d,c,n);t.setCamera({focalPoint:p,position:g}),t.render();const m=o+n,y={volumeId:e,viewport:t,delta:n,desiredStepIndex:m,currentStepIndex:o,numScrollSteps:a,currentImageId:t.getCurrentImageId()};(m>a||m<0)&&t.getCurrentImageId()?Ct(St,vt.VOLUME_VIEWPORT_SCROLL_OUT_OF_BOUNDS,y):Ct(St,vt.VOLUME_VIEWPORT_SCROLL,y)}async function o7e(t,e={}){const{imageIndex:n,debounceLoading:r,volumeId:i}=e,a=et(t);if(!a)throw new Error("Element has been disabled");const{viewport:o}=a,{imageIndex:s,numberOfSlices:l}=s7e(o,r),f=l7e(l,n)-s;JJ(o,{delta:f,debounceLoading:r,volumeId:i})}function s7e(t,e){return t instanceof aa?{numberOfSlices:t.getImageIds().length,imageIndex:e?t.getTargetImageIdIndex():t.getCurrentImageIdIndex()}:{numberOfSlices:t.getNumberOfSlices(),imageIndex:t.getSliceIndex()}}function l7e(t,e){const n=t-1;return YJ(e,0,n)}function c7e(t,e,n={}){const r=yt.getVolume(t);if(!r)throw new Error(`Referenced volume with id ${t} does not exist.`);const{metadata:i,spacing:a,direction:o,dimensions:s}=r,{minX:l,maxX:c,minY:f,maxY:u,minZ:d,maxZ:h}=e,p=[Math.min(l,c),Math.min(f,u),Math.min(d,h)],g=dm(r.imageData,p),m=[Math.abs(c-l)+1,Math.abs(u-f)+1,Math.abs(h-d)+1],{targetBuffer:y}=n,v={metadata:i,dimensions:m,spacing:a,origin:g,direction:o,targetBuffer:y,scalarData:y?.type==="Float32Array"?new Float32Array(m[0]*m[1]*m[2]):void 0},x=VD(or(),v),w=x.voxelManager.getCompleteScalarDataArray(),S=m[0]*m[1],T=s[0]*s[1],_=r.voxelManager.getCompleteScalarDataArray();for(let D=0;D<m[2];D++)for(let I=0;I<m[1];I++){const R=dm(x.imageData,[0,I,D]),M=io(r.imageData,R),A=M[2]*T+M[1]*s[0]+M[0],L=_.slice(A,A+m[0]),P=D*S+I*m[0];w.set(L,P)}return x.voxelManager.setCompleteScalarDataArray(w),x}function u7e(t,e){const{viewUp:n,viewPlaneNormal:r}=e,i=cb(t,[0,0,0]),a=su(ct(),n),o=su(ct(),r),s=dr(ct(),a,o),l=ur(ct(),cb(t,a),i),c=ur(ct(),cb(t,o),i);Ir(l,l),Ir(c,c);const f=dr(ct(),l,c);return{worldVecRowDir:s,worldVecColDir:a,worldVecSliceDir:o,ijkVecRowDir:f,ijkVecColDir:l,ijkVecSliceDir:c}}function f7e(t,e,n,r){const[i,a,o]=e,s=i*a;let l=0,c=0,f=0;const[u,d,h]=n.map(Math.round);for(let y=h-r;y<=h+r;y++)if(!(y<0||y>=o)){for(let v=d-r;v<=d+r;v++)if(!(v<0||v>=a))for(let x=u-r;x<=u+r;x++){if(x<0||x>=i)continue;const w=y*s+v*i+x,S=t[w];l+=S,c+=S*S,f++}}if(f===0){const y=h*s+d*i+u;return y>=0&&y<t.length?{mean:t[y],stdDev:0,count:1}:{mean:0,stdDev:0,count:0}}const p=l/f,g=c/f-p*p,m=Math.sqrt(Math.max(0,g));return{mean:p,stdDev:m,count:f}}const d7e=new Set(["1.2.840.10008.5.1.4.1.1.1","1.2.840.10008.5.1.4.1.1.1.1","1.2.840.10008.5.1.4.1.1.1.1.1","1.2.840.10008.5.1.4.1.1.1.2","1.2.840.10008.5.1.4.1.1.1.2.1","1.2.840.10008.5.1.4.1.1.1.3","1.2.840.10008.5.1.4.1.1.1.3.1","1.2.840.10008.5.1.4.1.1.12.1","1.2.840.10008.5.1.4.1.1.12.1.1","1.2.840.10008.5.1.4.1.1.12.2","1.2.840.10008.5.1.4.1.1.12.2.1","1.2.840.10008.5.1.4.1.1.12.3"]);function h7e(t){const{PixelSpacing:e,ImagerPixelSpacing:n,EstimatedRadiographicMagnificationFactor:r,PixelSpacingCalibrationType:i,PixelSpacingCalibrationDescription:a}=t,o=!0;return n?e?fr(e,n)?{PixelSpacing:e,type:Kc.PROJECTION,isProjection:o}:i||a?{PixelSpacing:e,type:Kc.CALIBRATED,isProjection:o,PixelSpacingCalibrationType:i,PixelSpacingCalibrationDescription:a}:{PixelSpacing:e,type:Kc.UNKNOWN,isProjection:o}:r?{PixelSpacing:n.map(l=>l/r),type:Kc.ERMF,isProjection:o}:(console.warn("EstimatedRadiographicMagnificationFactor was not present. Unable to correct ImagerPixelSpacing."),{PixelSpacing:n,type:Kc.PROJECTION,isProjection:o}):{PixelSpacing:e,type:Kc.UNKNOWN,isProjection:o}}function p7e(t){const{SequenceOfUltrasoundRegions:e}=t,n=Array.isArray(e);if(n&&e.length>1){console.warn("Sequence of Ultrasound Regions > one entry. This is not yet implemented, all measurements will be shown in pixels.");return}const{PhysicalDeltaX:r,PhysicalDeltaY:i}=n?e[0]:e;return{PixelSpacing:[Math.abs(r)*10,Math.abs(i)*10]}}function g7e(t){const{PixelSpacing:e,SOPClassUID:n,SequenceOfUltrasoundRegions:r}=t;return r?p7e(t):d7e.has(n)?h7e(t):{PixelSpacing:e,type:Kc.NOT_APPLICABLE,isProjection:!1}}const m7e=(t,e)=>qDe(t,e,yt.getVolume),Hr=Object.freeze(Object.defineProperty({__proto__:null,FrameRange:Jg,HistoryMemo:n7,PointsManager:mb,ProgressiveIterator:E3,RLEVoxelMap:dg,VoxelManager:g0,actorIsA:Jo,applyPreset:HY,asArray:$6,autoLoad:R6,buildMetadata:eJ,calculateNeighborhoodStats:f7e,calculateSpacingBetweenImageIds:DY,calculateViewportsSpatialRegistration:VDe,calibratedPixelSpacingMetadataProvider:ODe,clamp:k6,clip:YJ,color:KDe,colormap:pye,convertStackToVolumeViewport:GDe,convertToGrayscale:qJ,convertVolumeToStackViewport:jDe,createLinearRGBTransferFunction:nJ,createSigmoidRGBTransferFunction:K9,createSubVolume:c7e,decimate:IY,deepClone:fc,deepEqual:XJ,deepMerge:Mo,eventListener:bDe,fnv1aHash:sK,generateVolumePropsFromImageIds:tC,genericMetadataProvider:Zd,getBufferConfiguration:ED,getClosestImageId:ep,getClosestStackImageIndexForPoint:zJ,getCurrentVolumeViewportSlice:WJ,getDynamicVolumeInfo:r7e,getImageDataMetadata:$D,getImageLegacy:BDe,getImageSliceDataForVolumeViewport:D3,getMinMax:CDe,getPixelSpacingInformation:g7e,getRandomSampleFromArray:r7,getRuntimeId:FJ,getScalingParameters:OY,getSliceRange:iC,getSpacingInNormalDirection:fp,getTargetVolumeAndSpacingInNormalDir:ly,getViewportImageCornersInWorld:FDe,getViewportImageIds:zDe,getViewportModality:m7e,getViewportsWithImageURI:P3,getViewportsWithVolumeId:nC,getVoiFromSigmoidRGBTransferFunction:WY,getVolumeActorCorners:GY,getVolumeDirectionVectors:u7e,getVolumeId:_0,getVolumeSliceRangeInfo:zY,getVolumeViewportScrollInfo:qg,getVolumeViewportsContainingSameVolumes:IDe,hasFloatScalingParameters:PD,hasNaNValues:A6,imageIdToURI:mi,imageRetrieveMetadataProvider:fm,imageToWorldCoords:PDe,indexWithinDimensions:xa,invertRgbTransferFunction:Lv,isEqual:fr,isEqualAbs:lb,isEqualNegative:uK,isImageActor:uc,isNumber:li,isOpposite:MDe,isPTPrescaledWithSUV:UJ,isValidVolume:Gm,isVideoTransferSyntax:KJ,jumpToSlice:o7e,loadImageToCanvas:RDe,logger:$6e,makeVolumeMetadata:_Y,planar:t6e,pointInShapeCallback:xD,renderToCanvasCPU:$J,renderToCanvasGPU:BJ,roundNumber:kn,roundToPrecision:Cb,scaleArray:i7e,scaleRgbTransferFunction:wDe,scroll:JJ,snapFocalPointToSlice:Xg,sortImageIdsAndGetSpacing:AD,spatialRegistrationMetadataProvider:N3,splitImageIdsBy4DTags:i7,transferFunctionUtils:mye,transformIndexToWorld:dm,transformWorldToIndex:io,transformWorldToIndexContinuous:cb,triggerEvent:Ct,updatePlaneRestriction:jY,updateVTKImageDataWithCornerstoneImage:oC,uuidv4:or,windowLevel:gye,worldToImageCoords:ADe},Symbol.toStringTag,{value:"Module"}));class ZJ extends AY{constructor(e,n){super(e,n),this._dimensionGroupNumber=1,this._loadedDimensionGroups=new Set,this._getImageIdRequests=(a,o)=>this.getImageIdsRequests(a,o),this.getImageLoadRequests=a=>{const o=this.getImageIdsToLoad();return this._getImageIdRequests(o,a)};const{imageIdGroups:r,splittingTag:i}=e;this._splittingTag=i,this._imageIdGroups=r,this.numDimensionGroups=this._imageIdGroups.length,this.numTimePoints=this.numDimensionGroups}_getImageIdsToLoad(){const e=this._imageIdGroups,n=this._dimensionGroupNumber-1,r=[...e[n]];let i=n-1,a=n+1;for(;i>=0||a<e.length;)i>=0&&r.push(...e[i--]),a<e.length&&r.push(...e[a++]);return r}getImageIdsToLoad(){return this._getImageIdsToLoad()}get dimensionGroupNumber(){return this._dimensionGroupNumber}set timePointIndex(e){console.warn("Warning: timePointIndex is deprecated. Please use dimensionGroupNumber instead. Note that timePointIndex is zero-based while dimensionGroupNumber starts at 1."),this.dimensionGroupNumber=e+1}set dimensionGroupNumber(e){this._dimensionGroupNumber!==e&&(this._dimensionGroupNumber=e,this.voxelManager.setDimensionGroupNumber(e),this.invalidateVolume(!0),Ct(St,vt.DYNAMIC_VOLUME_DIMENSION_GROUP_CHANGED,{volumeId:this.volumeId,dimensionGroupNumber:e,numDimensionGroups:this.numDimensionGroups,imageIdGroupIndex:e-1,numImageIdGroups:this.numDimensionGroups,splittingTag:this.splittingTag}),Ct(St,vt.DYNAMIC_VOLUME_TIME_POINT_INDEX_CHANGED,{volumeId:this.volumeId,timePointIndex:e-1,numTimePoints:this.numDimensionGroups,imageIdGroupIndex:e-1,numImageIdGroups:this.numDimensionGroups,splittingTag:this.splittingTag}))}get timePointIndex(){return console.warn("Warning: timePointIndex is deprecated. Please use dimensionGroupNumber instead. Note that timePointIndex is zero-based while dimensionGroupNumber starts at 1."),this._dimensionGroupNumber-1}scroll(e){const n=this._dimensionGroupNumber+e;n<1?this.dimensionGroupNumber=this.numDimensionGroups:n>this.numDimensionGroups?this.dimensionGroupNumber=1:this.dimensionGroupNumber=n}getCurrentDimensionGroupImageIds(){return this._imageIdGroups[this._dimensionGroupNumber-1]}getCurrentTimePointImageIds(){return console.warn("Warning: getCurrentTimePointImageIds is deprecated. Please use getCurrentDimensionGroupImageIds instead."),this.getCurrentDimensionGroupImageIds()}flatImageIdIndexToTimePointIndex(e){return console.warn("Warning: flatImageIdIndexToTimePointIndex is deprecated. Please use flatImageIdIndexToDimensionGroupNumber instead."),this.flatImageIdIndexToDimensionGroupNumber(e)-1}flatImageIdIndexToDimensionGroupNumber(e){return Math.floor(e/this._imageIdGroups[0].length)+1}flatImageIdIndexToImageIdIndex(e){return e%this._imageIdGroups[0].length}get splittingTag(){return this._splittingTag}isTimePointLoaded(e){return console.warn("Warning: isTimePointLoaded is deprecated. Please use isDimensionGroupLoaded instead. Note that timePointIndex is zero-based while dimensionGroupNumber starts at 1."),this.isDimensionGroupLoaded(e+1)}isDimensionGroupLoaded(e){return this._loadedDimensionGroups.has(e)}markDimensionGroupAsLoaded(e){this._loadedDimensionGroups.add(e),Ct(St,vt.DYNAMIC_VOLUME_DIMENSION_GROUP_LOADED,{volumeId:this.volumeId,dimensionGroupNumber:e}),Ct(St,vt.DYNAMIC_VOLUME_TIME_POINT_LOADED,{volumeId:this.volumeId,timePointIndex:e-1})}checkTimePointCompletion(e){console.warn("Warning: checkTimePointCompletion is deprecated. Please use checkDimensionGroupCompletion instead."),this.checkDimensionGroupCompletion(e)}checkDimensionGroupCompletion(e){const n=this.flatImageIdIndexToDimensionGroupNumber(e);this._imageIdGroups[n-1].every(a=>{const o=this.getImageIdIndex(a);return this.cachedFrames[o]===Cs.FULL_RESOLUTION})&&!this.isDimensionGroupLoaded(n)&&this.markDimensionGroupAsLoaded(n)}}const jm=new b9("imageRetrievalPool");jm.setMaxSimultaneousRequests(Dn.Interaction,200);jm.setMaxSimultaneousRequests(Dn.Thumbnail,200);jm.setMaxSimultaneousRequests(Dn.Prefetch,200);jm.grabDelay=0;const Ak=Symbol("DefaultSettings"),Pk=Symbol("RuntimeSettings"),Nk=Symbol("ObjectSettingsMap"),rf=Symbol("Dictionary");class Yr{constructor(e){const n=Object.create(e instanceof Yr&&rf in e?e[rf]:null);Object.seal(Object.defineProperty(this,rf,{value:n}))}set(e,n){return L3(this[rf],e,n,null)}get(e){return x7e(this[rf],e)}unset(e){return v7e(this[rf],e+"")}forEach(e){Lk(this[rf],e)}extend(){return new Yr(this)}import(e){QJ(e)&&Object.keys(e).forEach(n=>{L3(this[rf],n,e[n],null)})}dump(){const e={};return Lk(this[rf],(n,r)=>{typeof r<"u"&&eZ(e,n,r)}),e}static assert(e){return e instanceof Yr?e:Yr.getRuntimeSettings()}static getDefaultSettings(e=null){let n=Yr[Ak];if(n instanceof Yr||(n=new Yr,Yr[Ak]=n),e){const r={};return n.forEach(i=>{if(i.startsWith(e)){const a=i.split(`${e}.`)[1];r[a]=n.get(i)}}),r}return n}static getRuntimeSettings(){let e=Yr[Pk];return e instanceof Yr||(e=new Yr(Yr.getDefaultSettings()),Yr[Pk]=e),e}static getObjectSettings(e,n){let r=null;if(e instanceof Yr)r=e;else if(typeof e=="object"&&e!==null){let i=Yr[Nk];i instanceof WeakMap||(i=new WeakMap,Yr[Nk]=i),r=i.get(e),r instanceof Yr||(r=new Yr(Yr.assert(Yr.getObjectSettings(n))),i.set(e,r))}return r}static extendRuntimeSettings(){return Yr.getRuntimeSettings().extend()}}function v7e(t,e){if(e.endsWith(".")){let n=0;const r=e,i=r.slice(0,-1),a=i.length===0;for(const o in t)Object.prototype.hasOwnProperty.call(t,o)&&(a||o.startsWith(r)||o===i)&&(delete t[o],++n);return n>0}return delete t[e]}function Lk(t,e){for(const n in t)e(n,t[n])}function y7e(t,e,n,r){let i;if(r.has(n))return L3(t,e,null,r);r.add(n),i=0;for(const a in n)if(Object.prototype.hasOwnProperty.call(n,a)){const o=a.length===0?e:`${e}.${a}`;L3(t,o,n[a],r)||++i}return r.delete(n),i===0}function L3(t,e,n,r){return b7e(e)?QJ(n)?y7e(t,e,n,r instanceof WeakSet?r:new WeakSet):(t[e]=n,!0):!1}function x7e(t,e){return t[e]}function b7e(t){let e,n,r;if(typeof t!="string"||(e=t.length-1)<0)return!1;for(r=-1;(n=t.indexOf(".",r+1))>=0;){if(n-r<2||n===e)return!1;r=n}return!0}function QJ(t){if(typeof t=="object"&&t!==null){const e=Object.getPrototypeOf(t);if(e===Object.prototype||e===null)return!0}return!1}function eZ(t,e,n){const r=e.indexOf(".");if(r>=0){const i=e.slice(0,r);let a=t[i];if(typeof a!="object"||a===null){const o=a;a={},typeof o<"u"&&(a[""]=o),t[i]=a}eZ(a,e.slice(r+1,e.length),n)}else t[e]=n}Yr.getDefaultSettings().set("useCursors",!0);function Sb(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function w7e(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function tZ(t){let e,n,r;t.length!==2?(e=Sb,n=(s,l)=>Sb(t(s),l),r=(s,l)=>t(s)-l):(e=t===Sb||t===w7e?t:C7e,n=t,r=t);function i(s,l,c=0,f=s.length){if(c<f){if(e(l,l)!==0)return f;do{const u=c+f>>>1;n(s[u],l)<0?c=u+1:f=u}while(c<f)}return c}function a(s,l,c=0,f=s.length){if(c<f){if(e(l,l)!==0)return f;do{const u=c+f>>>1;n(s[u],l)<=0?c=u+1:f=u}while(c<f)}return c}function o(s,l,c=0,f=s.length){const u=i(s,l,c,f-1);return u>c&&r(s[u-1],l)>-r(s[u],l)?u-1:u}return{left:i,center:o,right:a}}function C7e(){return 0}function S7e(t){return t===null?NaN:+t}const T7e=tZ(Sb),E7e=T7e.right;tZ(S7e).center;const _7e=Math.sqrt(50),D7e=Math.sqrt(10),O7e=Math.sqrt(2);function k3(t,e,n){const r=(e-t)/Math.max(0,n),i=Math.floor(Math.log10(r)),a=r/Math.pow(10,i),o=a>=_7e?10:a>=D7e?5:a>=O7e?2:1;let s,l,c;return i<0?(c=Math.pow(10,-i)/o,s=Math.round(t*c),l=Math.round(e*c),s/c<t&&++s,l/c>e&&--l,c=-c):(c=Math.pow(10,i)*o,s=Math.round(t/c),l=Math.round(e/c),s*c<t&&++s,l*c>e&&--l),l<s&&.5<=n&&n<2?k3(t,e,n*2):[s,l,c]}function M7e(t,e,n){if(e=+e,t=+t,n=+n,!(n>0))return[];if(t===e)return[t];const r=e<t,[i,a,o]=r?k3(e,t,n):k3(t,e,n);if(!(a>=i))return[];const s=a-i+1,l=new Array(s);if(r)if(o<0)for(let c=0;c<s;++c)l[c]=(a-c)/-o;else for(let c=0;c<s;++c)l[c]=(a-c)*o;else if(o<0)for(let c=0;c<s;++c)l[c]=(i+c)/-o;else for(let c=0;c<s;++c)l[c]=(i+c)*o;return l}function G6(t,e,n){return e=+e,t=+t,n=+n,k3(t,e,n)[2]}function I7e(t,e,n){e=+e,t=+t,n=+n;const r=e<t,i=r?G6(e,t,n):G6(t,e,n);return(r?-1:1)*(i<0?1/-i:i)}function R7e(t,e){let n;if(e===void 0)for(const r of t)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of t)(i=e(i,++r,t))!=null&&(n>i||n===void 0&&i>=i)&&(n=i)}return n}function A7e(t){if(!(a=t.length))return[];for(var e=-1,n=R7e(t,P7e),r=new Array(n);++e<n;)for(var i=-1,a,o=r[e]=new Array(a);++i<a;)o[i]=t[i][e];return r}function P7e(t){return t.length}function kk(){return A7e(arguments)}function N7e(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function a7(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function nZ(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function dy(){}var O2=.7,V3=1/O2,Zg="\\s*([+-]?\\d+)\\s*",M2="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",cu="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",L7e=/^#([0-9a-f]{3,8})$/,k7e=new RegExp(`^rgb\\(${Zg},${Zg},${Zg}\\)$`),V7e=new RegExp(`^rgb\\(${cu},${cu},${cu}\\)$`),F7e=new RegExp(`^rgba\\(${Zg},${Zg},${Zg},${M2}\\)$`),U7e=new RegExp(`^rgba\\(${cu},${cu},${cu},${M2}\\)$`),B7e=new RegExp(`^hsl\\(${M2},${cu},${cu}\\)$`),$7e=new RegExp(`^hsla\\(${M2},${cu},${cu},${M2}\\)$`),Vk={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};a7(dy,I2,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Fk,formatHex:Fk,formatHex8:G7e,formatHsl:j7e,formatRgb:Uk,toString:Uk});function Fk(){return this.rgb().formatHex()}function G7e(){return this.rgb().formatHex8()}function j7e(){return rZ(this).formatHsl()}function Uk(){return this.rgb().formatRgb()}function I2(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=L7e.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?Bk(e):n===3?new Ss(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?mx(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?mx(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=k7e.exec(t))?new Ss(e[1],e[2],e[3],1):(e=V7e.exec(t))?new Ss(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=F7e.exec(t))?mx(e[1],e[2],e[3],e[4]):(e=U7e.exec(t))?mx(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=B7e.exec(t))?jk(e[1],e[2]/100,e[3]/100,1):(e=$7e.exec(t))?jk(e[1],e[2]/100,e[3]/100,e[4]):Vk.hasOwnProperty(t)?Bk(Vk[t]):t==="transparent"?new Ss(NaN,NaN,NaN,0):null}function Bk(t){return new Ss(t>>16&255,t>>8&255,t&255,1)}function mx(t,e,n,r){return r<=0&&(t=e=n=NaN),new Ss(t,e,n,r)}function z7e(t){return t instanceof dy||(t=I2(t)),t?(t=t.rgb(),new Ss(t.r,t.g,t.b,t.opacity)):new Ss}function j6(t,e,n,r){return arguments.length===1?z7e(t):new Ss(t,e,n,r??1)}function Ss(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}a7(Ss,j6,nZ(dy,{brighter(t){return t=t==null?V3:Math.pow(V3,t),new Ss(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?O2:Math.pow(O2,t),new Ss(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Ss(Fh(this.r),Fh(this.g),Fh(this.b),F3(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:$k,formatHex:$k,formatHex8:W7e,formatRgb:Gk,toString:Gk}));function $k(){return`#${Ih(this.r)}${Ih(this.g)}${Ih(this.b)}`}function W7e(){return`#${Ih(this.r)}${Ih(this.g)}${Ih(this.b)}${Ih((isNaN(this.opacity)?1:this.opacity)*255)}`}function Gk(){const t=F3(this.opacity);return`${t===1?"rgb(":"rgba("}${Fh(this.r)}, ${Fh(this.g)}, ${Fh(this.b)}${t===1?")":`, ${t})`}`}function F3(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Fh(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Ih(t){return t=Fh(t),(t<16?"0":"")+t.toString(16)}function jk(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new dc(t,e,n,r)}function rZ(t){if(t instanceof dc)return new dc(t.h,t.s,t.l,t.opacity);if(t instanceof dy||(t=I2(t)),!t)return new dc;if(t instanceof dc)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),a=Math.max(e,n,r),o=NaN,s=a-i,l=(a+i)/2;return s?(e===a?o=(n-r)/s+(n<r)*6:n===a?o=(r-e)/s+2:o=(e-n)/s+4,s/=l<.5?a+i:2-a-i,o*=60):s=l>0&&l<1?0:o,new dc(o,s,l,t.opacity)}function H7e(t,e,n,r){return arguments.length===1?rZ(t):new dc(t,e,n,r??1)}function dc(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}a7(dc,H7e,nZ(dy,{brighter(t){return t=t==null?V3:Math.pow(V3,t),new dc(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?O2:Math.pow(O2,t),new dc(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new Ss(g8(t>=240?t-240:t+120,i,r),g8(t,i,r),g8(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new dc(zk(this.h),vx(this.s),vx(this.l),F3(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=F3(this.opacity);return`${t===1?"hsl(":"hsla("}${zk(this.h)}, ${vx(this.s)*100}%, ${vx(this.l)*100}%${t===1?")":`, ${t})`}`}}));function zk(t){return t=(t||0)%360,t<0?t+360:t}function vx(t){return Math.max(0,Math.min(1,t||0))}function g8(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}function K7e(t,e,n,r,i){var a=t*t,o=a*t;return((1-3*t+3*a-o)*e+(4-6*a+3*o)*n+(1+3*t+3*a-3*o)*r+o*i)/6}function m8(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),i=t[r],a=t[r+1],o=r>0?t[r-1]:2*i-a,s=r<e-1?t[r+2]:2*a-i;return K7e((n-r/e)*e,o,i,a,s)}}const o7=t=>()=>t;function q7e(t,e){return function(n){return t+n*e}}function X7e(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function Y7e(t){return(t=+t)==1?iZ:function(e,n){return n-e?X7e(e,n,t):o7(isNaN(e)?n:e)}}function iZ(t,e){var n=e-t;return n?q7e(t,n):o7(isNaN(t)?e:t)}const Wk=(function t(e){var n=Y7e(e);function r(i,a){var o=n((i=j6(i)).r,(a=j6(a)).r),s=n(i.g,a.g),l=n(i.b,a.b),c=iZ(i.opacity,a.opacity);return function(f){return i.r=o(f),i.g=s(f),i.b=l(f),i.opacity=c(f),i+""}}return r.gamma=t,r})(1);function J7e(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,r=e.slice(),i;return function(a){for(i=0;i<n;++i)r[i]=t[i]*(1-a)+e[i]*a;return r}}function Z7e(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Q7e(t,e){var n=e?e.length:0,r=t?Math.min(n,t.length):0,i=new Array(r),a=new Array(n),o;for(o=0;o<r;++o)i[o]=s7(t[o],e[o]);for(;o<n;++o)a[o]=e[o];return function(s){for(o=0;o<r;++o)a[o]=i[o](s);return a}}function eOe(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function U3(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function tOe(t,e){var n={},r={},i;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(i in e)i in t?n[i]=s7(t[i],e[i]):r[i]=e[i];return function(a){for(i in n)r[i]=n[i](a);return r}}var z6=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,v8=new RegExp(z6.source,"g");function nOe(t){return function(){return t}}function rOe(t){return function(e){return t(e)+""}}function iOe(t,e){var n=z6.lastIndex=v8.lastIndex=0,r,i,a,o=-1,s=[],l=[];for(t=t+"",e=e+"";(r=z6.exec(t))&&(i=v8.exec(e));)(a=i.index)>n&&(a=e.slice(n,a),s[o]?s[o]+=a:s[++o]=a),(r=r[0])===(i=i[0])?s[o]?s[o]+=i:s[++o]=i:(s[++o]=null,l.push({i:o,x:U3(r,i)})),n=v8.lastIndex;return n<e.length&&(a=e.slice(n),s[o]?s[o]+=a:s[++o]=a),s.length<2?l[0]?rOe(l[0].x):nOe(e):(e=l.length,function(c){for(var f=0,u;f<e;++f)s[(u=l[f]).i]=u.x(c);return s.join("")})}function s7(t,e){var n=typeof e,r;return e==null||n==="boolean"?o7(e):(n==="number"?U3:n==="string"?(r=I2(e))?(e=r,Wk):iOe:e instanceof I2?Wk:e instanceof Date?eOe:Z7e(e)?J7e:Array.isArray(e)?Q7e:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?tOe:U3)(t,e)}function aOe(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}function tv(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t(r/(e-1));return n}function oOe(t){return function(){return t}}function sOe(t){return+t}var Hk=[0,1];function Cg(t){return t}function W6(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:oOe(isNaN(e)?NaN:.5)}function lOe(t,e){var n;return t>e&&(n=t,t=e,e=n),function(r){return Math.max(t,Math.min(e,r))}}function cOe(t,e,n){var r=t[0],i=t[1],a=e[0],o=e[1];return i<r?(r=W6(i,r),a=n(o,a)):(r=W6(r,i),a=n(a,o)),function(s){return a(r(s))}}function uOe(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),a=new Array(r),o=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<r;)i[o]=W6(t[o],t[o+1]),a[o]=n(e[o],e[o+1]);return function(s){var l=E7e(t,s,1,r)-1;return a[l](i[l](s))}}function fOe(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function dOe(){var t=Hk,e=Hk,n=s7,r,i,a,o=Cg,s,l,c;function f(){var d=Math.min(t.length,e.length);return o!==Cg&&(o=lOe(t[0],t[d-1])),s=d>2?uOe:cOe,l=c=null,u}function u(d){return d==null||isNaN(d=+d)?a:(l||(l=s(t.map(r),e,n)))(r(o(d)))}return u.invert=function(d){return o(i((c||(c=s(e,t.map(r),U3)))(d)))},u.domain=function(d){return arguments.length?(t=Array.from(d,sOe),f()):t.slice()},u.range=function(d){return arguments.length?(e=Array.from(d),f()):e.slice()},u.rangeRound=function(d){return e=Array.from(d),n=aOe,f()},u.clamp=function(d){return arguments.length?(o=d?!0:Cg,f()):o!==Cg},u.interpolate=function(d){return arguments.length?(n=d,f()):n},u.unknown=function(d){return arguments.length?(a=d,u):a},function(d,h){return r=d,i=h,f()}}function hOe(){return dOe()(Cg,Cg)}function pOe(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function B3(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function pm(t){return t=B3(Math.abs(t)),t?t[1]:NaN}function gOe(t,e){return function(n,r){for(var i=n.length,a=[],o=0,s=t[0],l=0;i>0&&s>0&&(l+s+1>r&&(s=Math.max(1,r-l)),a.push(n.substring(i-=s,i+s)),!((l+=s+1)>r));)s=t[o=(o+1)%t.length];return a.reverse().join(e)}}function mOe(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var vOe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function $3(t){if(!(e=vOe.exec(t)))throw new Error("invalid format: "+t);var e;return new l7({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}$3.prototype=l7.prototype;function l7(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}l7.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function yOe(t){e:for(var e=t.length,n=1,r=-1,i;n<e;++n)switch(t[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+t[n])break e;r>0&&(r=0);break}return r>0?t.slice(0,r)+t.slice(i+1):t}var aZ;function xOe(t,e){var n=B3(t,e);if(!n)return t+"";var r=n[0],i=n[1],a=i-(aZ=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,o=r.length;return a===o?r:a>o?r+new Array(a-o+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+B3(t,Math.max(0,e+a-1))[0]}function Kk(t,e){var n=B3(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const qk={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:pOe,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>Kk(t*100,e),r:Kk,s:xOe,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function Xk(t){return t}var Yk=Array.prototype.map,Jk=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function bOe(t){var e=t.grouping===void 0||t.thousands===void 0?Xk:gOe(Yk.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",r=t.currency===void 0?"":t.currency[1]+"",i=t.decimal===void 0?".":t.decimal+"",a=t.numerals===void 0?Xk:mOe(Yk.call(t.numerals,String)),o=t.percent===void 0?"%":t.percent+"",s=t.minus===void 0?"−":t.minus+"",l=t.nan===void 0?"NaN":t.nan+"";function c(u){u=$3(u);var d=u.fill,h=u.align,p=u.sign,g=u.symbol,m=u.zero,y=u.width,v=u.comma,x=u.precision,w=u.trim,S=u.type;S==="n"?(v=!0,S="g"):qk[S]||(x===void 0&&(x=12),w=!0,S="g"),(m||d==="0"&&h==="=")&&(m=!0,d="0",h="=");var T=g==="$"?n:g==="#"&&/[boxX]/.test(S)?"0"+S.toLowerCase():"",_=g==="$"?r:/[%p]/.test(S)?o:"",D=qk[S],I=/[defgprs%]/.test(S);x=x===void 0?6:/[gprs]/.test(S)?Math.max(1,Math.min(21,x)):Math.max(0,Math.min(20,x));function R(M){var A=T,L=_,P,B,U;if(S==="c")L=D(M)+L,M="";else{M=+M;var G=M<0||1/M<0;if(M=isNaN(M)?l:D(Math.abs(M),x),w&&(M=yOe(M)),G&&+M==0&&p!=="+"&&(G=!1),A=(G?p==="("?p:s:p==="-"||p==="("?"":p)+A,L=(S==="s"?Jk[8+aZ/3]:"")+L+(G&&p==="("?")":""),I){for(P=-1,B=M.length;++P<B;)if(U=M.charCodeAt(P),48>U||U>57){L=(U===46?i+M.slice(P+1):M.slice(P))+L,M=M.slice(0,P);break}}}v&&!m&&(M=e(M,1/0));var F=A.length+M.length+L.length,$=F<y?new Array(y-F+1).join(d):"";switch(v&&m&&(M=e($+M,$.length?y-L.length:1/0),$=""),h){case"<":M=A+M+L+$;break;case"=":M=A+$+M+L;break;case"^":M=$.slice(0,F=$.length>>1)+A+M+L+$.slice(F);break;default:M=$+A+M+L;break}return a(M)}return R.toString=function(){return u+""},R}function f(u,d){var h=c((u=$3(u),u.type="f",u)),p=Math.max(-8,Math.min(8,Math.floor(pm(d)/3)))*3,g=Math.pow(10,-p),m=Jk[8+p/3];return function(y){return h(g*y)+m}}return{format:c,formatPrefix:f}}var yx,oZ,sZ;wOe({thousands:",",grouping:[3],currency:["$",""]});function wOe(t){return yx=bOe(t),oZ=yx.format,sZ=yx.formatPrefix,yx}function COe(t){return Math.max(0,-pm(Math.abs(t)))}function SOe(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(pm(e)/3)))*3-pm(Math.abs(t)))}function TOe(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,pm(e)-pm(t))+1}function EOe(t,e,n,r){var i=I7e(t,e,n),a;switch(r=$3(r??",f"),r.type){case"s":{var o=Math.max(Math.abs(t),Math.abs(e));return r.precision==null&&!isNaN(a=SOe(i,o))&&(r.precision=a),sZ(r,o)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(a=TOe(i,Math.max(Math.abs(t),Math.abs(e))))&&(r.precision=a-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(a=COe(i))&&(r.precision=a-(r.type==="%")*2);break}}return oZ(r)}function _Oe(t){var e=t.domain;return t.ticks=function(n){var r=e();return M7e(r[0],r[r.length-1],n??10)},t.tickFormat=function(n,r){var i=e();return EOe(i[0],i[i.length-1],n??10,r)},t.nice=function(n){n==null&&(n=10);var r=e(),i=0,a=r.length-1,o=r[i],s=r[a],l,c,f=10;for(s<o&&(c=o,o=s,s=c,c=i,i=a,a=c);f-- >0;){if(c=G6(o,s,n),c===l)return r[i]=o,r[a]=s,e(r);if(c>0)o=Math.floor(o/c)*c,s=Math.ceil(s/c)*c;else if(c<0)o=Math.ceil(o*c)/c,s=Math.floor(s*c)/c;else break;l=c}return t},t}function c7(){var t=hOe();return t.copy=function(){return fOe(t,c7())},N7e.apply(t,arguments),_Oe(t)}function DOe(t,e){e.classHierarchy.push("vtkTexture"),t.imageLoaded=()=>{e.image.removeEventListener("load",t.imageLoaded),e.imageLoaded=!0,t.modified()},t.setJsImageData=n=>{e.jsImageData!==n&&(n!==null&&(t.setInputData(null),t.setInputConnection(null),e.image=null,e.canvas=null),e.jsImageData=n,e.imageLoaded=!0,t.modified())},t.setCanvas=n=>{e.canvas!==n&&(n!==null&&(t.setInputData(null),t.setInputConnection(null),e.image=null,e.jsImageData=null),e.canvas=n,t.modified())},t.setImage=n=>{e.image!==n&&(n!==null&&(t.setInputData(null),t.setInputConnection(null),e.canvas=null,e.jsImageData=null),e.image=n,e.imageLoaded=!1,n.complete?t.imageLoaded():n.addEventListener("load",t.imageLoaded),t.modified())},t.getDimensionality=()=>{let n=0,r=0,i=1;if(t.getInputData()){const o=t.getInputData();n=o.getDimensions()[0],r=o.getDimensions()[1],i=o.getDimensions()[2]}return e.jsImageData&&(n=e.jsImageData.width,r=e.jsImageData.height),e.canvas&&(n=e.canvas.width,r=e.canvas.height),e.image&&(n=e.image.width,r=e.image.height),(n>1)+(r>1)+(i>1)},t.getInputAsJsImageData=()=>{if(!e.imageLoaded||t.getInputData())return null;if(e.jsImageData)return e.jsImageData();if(e.canvas)return e.canvas.getContext("2d").getImageData(0,0,e.canvas.width,e.canvas.height);if(e.image){const n=document.createElement("canvas");n.width=e.image.width,n.height=e.image.height;const r=n.getContext("2d");return r.translate(0,n.height),r.scale(1,-1),r.drawImage(e.image,0,0,e.image.width,e.image.height),r.getImageData(0,0,n.width,n.height)}return null}}const OOe=(t,e,n,r)=>{const i=[1,2,1],a=4,o=i,s=a,l=t.length/(e*n);let c=e,f=n,u=t;const d=[u];for(let h=0;h<r;h++){const p=[...u];c/=2,f/=2,u=new Uint8ClampedArray(c*f*l);const g=l*c;let m=0;for(let v=0;v<u.length;v+=l){v%g===0&&(m+=2*l*c);for(let x=0;x<l;x++){let w=p[m+x];w+=p[m+l+x],w+=p[m-2*g+x],w+=p[m-2*g+l+x],w/=4,u[v+x]=w}m+=2*l}let y=[...u];for(let v=0;v<u.length;v+=l)for(let x=0;x<l;x++){let w=-(o.length-1)/2,S=s,T=0;for(let _=0;_<o.length;_++){let D=v+x+w*l;const I=D%g-(v+x)%g;I>l&&(D+=g),I<-l&&(D-=g),y[D]?T+=y[D]*o[_]:S-=o[_],w+=1}u[v+x]=T/S}y=[...u];for(let v=0;v<u.length;v+=l)for(let x=0;x<l;x++){let w=-(o.length-1)/2,S=s,T=0;for(let _=0;_<o.length;_++){const D=v+x+w*g;y[D]?T+=y[D]*o[_]:S-=o[_],w+=1}u[v+x]=T/S}d.push(u)}return d},MOe={image:null,canvas:null,jsImageData:null,imageLoaded:!1,repeat:!1,interpolate:!1,edgeClamp:!1,mipLevel:0,resizable:!1};function lZ(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,MOe,n),le.obj(t,e),le.algo(t,e,6,0),le.get(t,e,["canvas","image","jsImageData","imageLoaded","resizable"]),le.setGet(t,e,["repeat","edgeClamp","interpolate","mipLevel"]),DOe(t,e)}const IOe=le.newInstance(lZ,"vtkTexture"),ROe={generateMipmaps:OOe};var zm={newInstance:IOe,extend:lZ,...ROe};const AOe=[[-1,0,0],[1,0,0],[0,-1,0],[0,1,0],[0,0,-1],[0,0,1]],Zk=[[8,7,11,3],[9,1,10,5],[4,9,0,8],[2,11,6,10],[0,3,2,1],[4,5,6,7]],xx=[[0,1],[1,3],[2,3],[0,2],[4,5],[5,7],[6,7],[4,6],[0,4],[1,5],[3,7],[2,6]],Qk=[0,1,0,1,0,1,0,1,2,2,2,2],pi=[[1,2],[1,2],[0,2],[0,2],[0,1],[0,1]],_n=new Float64Array(3),bx=new Float64Array(3),Er=new Float64Array(3),yh=new Float64Array(3),Z0=new Float64Array(3),wx=new Float64Array(3),y8=new Float64Array(16);function x8(t,e){t.strokeStyle=e.strokeColor,t.lineWidth=e.strokeSize,t.fillStyle=e.fontColor,t.font=`${e.fontStyle} ${e.fontSize}px ${e.fontFamily}`}function cZ(t){const e=[],n=[];for(let r=0;r<3;r++){const i=c7().domain([t[r*2],t[r*2+1]]);e[r]=i.ticks(5);const a=i.tickFormat(5);n[r]=e[r].map(a)}return{ticks:e,tickStrings:n}}function POe(t,e){e.classHierarchy.push("vtkCubeAxesActorHelper"),t.setRenderable=n=>{e.renderable!==n&&(e.renderable=n,e.tmActor.addTexture(e.renderable.getTmTexture()),e.tmActor.setProperty(n.getProperty()),e.tmActor.setParentProp(n),t.modified())},t.createPolyDataForOneLabel=(n,r,i,a,o,s,l)=>{const c=e.renderable.get_tmAtlas().get(n);if(!c)return;const f=e.renderable.getTextPolyData().getPoints().getData(),u=e.lastSize;_n[0]=f[r*3],_n[1]=f[r*3+1],_n[2]=f[r*3+2],$n(Er,_n,i),Er[0]+=.1,$n(bx,Er,a),Yd(Z0,bx,_n),Er[0]-=.1,Er[1]+=.1,$n(bx,Er,a),Yd(wx,bx,_n);for(let p=0;p<3;p++)Z0[p]/=.5*.1*u[0],wx[p]/=.5*.1*u[1];let d=l.ptIdx,h=l.cellIdx;_n[0]=f[r*3],_n[1]=f[r*3+1],_n[2]=f[r*3+2],o[0]<-.5?sf(Er,Z0,o[0]*s-c.width):o[0]>.5?sf(Er,Z0,o[0]*s):sf(Er,Z0,o[0]*s-c.width/2),vv(_n,_n,Er),sf(Er,wx,o[1]*s-c.height/2),vv(_n,_n,Er),l.points[d*3]=_n[0],l.points[d*3+1]=_n[1],l.points[d*3+2]=_n[2],l.tcoords[d*2]=c.tcoords[0],l.tcoords[d*2+1]=c.tcoords[1],d++,sf(Er,Z0,c.width),vv(_n,_n,Er),l.points[d*3]=_n[0],l.points[d*3+1]=_n[1],l.points[d*3+2]=_n[2],l.tcoords[d*2]=c.tcoords[2],l.tcoords[d*2+1]=c.tcoords[3],d++,sf(Er,wx,c.height),vv(_n,_n,Er),l.points[d*3]=_n[0],l.points[d*3+1]=_n[1],l.points[d*3+2]=_n[2],l.tcoords[d*2]=c.tcoords[4],l.tcoords[d*2+1]=c.tcoords[5],d++,sf(Er,Z0,c.width),Yd(_n,_n,Er),l.points[d*3]=_n[0],l.points[d*3+1]=_n[1],l.points[d*3+2]=_n[2],l.tcoords[d*2]=c.tcoords[6],l.tcoords[d*2+1]=c.tcoords[7],d++,l.polys[h*4]=3,l.polys[h*4+1]=d-4,l.polys[h*4+2]=d-3,l.polys[h*4+3]=d-2,h++,l.polys[h*4]=3,l.polys[h*4+1]=d-4,l.polys[h*4+2]=d-2,l.polys[h*4+3]=d-1,l.ptIdx+=4,l.cellIdx+=2},t.updateTexturePolyData=()=>{const n=e.camera.getCompositeProjectionMatrix(e.lastAspectRatio,-1,1);Gn(n,n);const r=e.renderable.getTextValues().length,i=r*4,a=r*2,o=new Float64Array(i*3),s=new Uint16Array(a*4),l=new Float32Array(i*2);ba(y8,n);const c={ptIdx:0,cellIdx:0,polys:s,points:o,tcoords:l};let f=0,u=0,d=0;const h=e.renderable.getTextPolyData().getPoints().getData(),p=e.renderable.getTextValues();for(;f<h.length/3;){_n[0]=h[f*3],_n[1]=h[f*3+1],_n[2]=h[f*3+2],$n(Er,_n,n),_n[0]=h[f*3+3],_n[1]=h[f*3+4],_n[2]=h[f*3+5],$n(yh,_n,n),Yd(Er,Er,yh);const m=[Er[0],Er[1]];DH(m),t.createPolyDataForOneLabel(p[u],f,n,y8,m,e.renderable.getAxisTitlePixelOffset(),c),f+=2,u++;for(let y=0;y<e.renderable.getTickCounts()[d];y++)t.createPolyDataForOneLabel(p[u],f,n,y8,m,e.renderable.getTickLabelPixelOffset(),c),f++,u++;d++}const g=nn.newInstance({numberOfComponents:2,values:l,name:"TextureCoordinates"});e.tmPolyData.getPointData().setTCoords(g),e.tmPolyData.getPoints().setData(o,3),e.tmPolyData.getPoints().modified(),e.tmPolyData.getPolys().setData(s,1),e.tmPolyData.getPolys().modified(),e.tmPolyData.modified()},t.updateAPISpecificData=(n,r,i)=>{(e.lastSize[0]!==n[0]||e.lastSize[1]!==n[1])&&(e.lastSize[0]=n[0],e.lastSize[1]=n[1],e.lastAspectRatio=n[0]/n[1],e.forceUpdate=!0),e.camera=r,t.updateTexturePolyData()}}const NOe=le.newInstance(function(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{renderable:null};Object.assign(e,{},n),le.obj(t,e),e.tmPolyData=ra.newInstance(),e.tmMapper=gc.newInstance(),e.tmMapper.setInputData(e.tmPolyData),e.tmActor=m0.newInstance({parentProp:t}),e.tmActor.setMapper(e.tmMapper),le.setGet(t,e,["renderable"]),le.get(t,e,["lastSize","lastAspectRatio","axisTextStyle","tickTextStyle","tmActor","ticks"]),e.forceUpdate=!1,e.lastRedrawTime={},le.obj(e.lastRedrawTime,{mtime:0}),e.lastRebuildTime={},le.obj(e.lastRebuildTime,{mtime:0}),e.lastSize=[-1,-1],e.lastTickBounds=[],POe(t,e)},"vtkCubeAxesActorHelper");function LOe(t,e){e.classHierarchy.push("vtkCubeAxesActor"),t.setCamera=r=>{e.camera!==r&&(e.cameraModifiedSub&&(e.cameraModifiedSub.unsubscribe(),e.cameraModifiedSub=null),e.camera=r,r&&(e.cameraModifiedSub=r.onModified(t.update)),t.update(),t.modified())},t.computeFacesToDraw=()=>{const r=e.camera.getViewMatrix();Gn(r,r);let i=!1;const a=wr.getDiagonalLength(e.dataBounds),o=Math.sin(e.faceVisibilityAngle*Math.PI/180);for(let s=0;s<6;s++){let l=!1;const c=Math.floor(s/2),f=(c+1)%3,u=(c+2)%3;e.dataBounds[f*2]!==e.dataBounds[f*2+1]&&e.dataBounds[u*2]!==e.dataBounds[u*2+1]&&(_n[c]=e.dataBounds[s]-.1*a*AOe[s][c],_n[f]=.5*(e.dataBounds[f*2]+e.dataBounds[f*2+1]),_n[u]=.5*(e.dataBounds[u*2]+e.dataBounds[u*2+1]),$n(Er,_n,r),_n[c]=e.dataBounds[s],$n(yh,_n,r),Yd(Er,yh,Er),mc(Er,Er),l=Er[2]>o,e.camera.getParallelProjection()||(mc(yh,yh),l=b2(yh,Er)>o)),l!==e.lastFacesToDraw[s]&&(e.lastFacesToDraw[s]=l,i=!0)}return i},t.updatePolyData=(r,i,a)=>{let o=0,s=0;o+=8;let l=0;for(let h=0;h<12;h++)i[h]>0&&l++;if(s+=l,e.gridLines)for(let h=0;h<6;h++)r[h]&&(o+=a[pi[h][0]].length*2+a[pi[h][1]].length*2,s+=a[pi[h][0]].length+a[pi[h][1]].length);const c=new Float64Array(o*3),f=new Uint32Array(s*3);let u=0,d=0;for(let h=0;h<2;h++)for(let p=0;p<2;p++)for(let g=0;g<2;g++)c[u*3]=e.dataBounds[g],c[u*3+1]=e.dataBounds[2+p],c[u*3+2]=e.dataBounds[4+h],u++;for(let h=0;h<12;h++)i[h]>0&&(f[d*3]=2,f[d*3+1]=xx[h][0],f[d*3+2]=xx[h][1],d++);if(e.gridLines){for(let h=0;h<6;h++)if(r[h]){const p=Math.floor(h/2);let g=a[pi[h][0]];for(let m=0;m<g.length;m++)c[u*3+p]=e.dataBounds[h],c[u*3+pi[h][0]]=g[m],c[u*3+pi[h][1]]=e.dataBounds[pi[h][1]*2],u++,c[u*3+p]=e.dataBounds[h],c[u*3+pi[h][0]]=g[m],c[u*3+pi[h][1]]=e.dataBounds[pi[h][1]*2+1],u++,f[d*3]=2,f[d*3+1]=u-2,f[d*3+2]=u-1,d++;g=a[pi[h][1]];for(let m=0;m<g.length;m++)c[u*3+p]=e.dataBounds[h],c[u*3+pi[h][1]]=g[m],c[u*3+pi[h][0]]=e.dataBounds[pi[h][0]*2],u++,c[u*3+p]=e.dataBounds[h],c[u*3+pi[h][1]]=g[m],c[u*3+pi[h][0]]=e.dataBounds[pi[h][0]*2+1],u++,f[d*3]=2,f[d*3+1]=u-2,f[d*3+2]=u-1,d++}}e.polyData.getPoints().setData(c,3),e.polyData.getPoints().modified(),e.polyData.getLines().setData(f,1),e.polyData.getLines().modified(),e.polyData.modified()},t.updateTextData=(r,i,a,o)=>{let s=0;for(let h=0;h<12;h++)i[h]===1&&(s+=2,s+=a[Qk[h]].length);const l=e.polyData.getPoints().getData(),c=new Float64Array(s*3);let f=0,u=0,d=0;for(let h=0;h<6;h++)if(r[h])for(let p=0;p<4;p++){const g=Zk[h][p];if(i[g]===1){const m=Qk[g],y=xx[g][0]*3,v=xx[g][1]*3;c[f*3]=.5*(l[y]+l[v]),c[f*3+1]=.5*(l[y+1]+l[v+1]),c[f*3+2]=.5*(l[y+2]+l[v+2]),f++;const x=Math.floor(h/2);c[f*3+x]=e.dataBounds[h],c[f*3+pi[h][0]]=.5*(e.dataBounds[pi[h][0]*2]+e.dataBounds[pi[h][0]*2+1]),c[f*3+pi[h][1]]=.5*(e.dataBounds[pi[h][1]*2]+e.dataBounds[pi[h][1]*2+1]),f++,e.textValues[u]=e.axisLabels[m],u++;const w=(m+1)%3,S=(m+2)%3,T=a[m],_=o[m];e.tickCounts[d]=T.length;for(let D=0;D<T.length;D++)c[f*3+m]=T[D],c[f*3+w]=l[y+w],c[f*3+S]=l[y+S],f++,e.textValues[u]=_[D],u++;d++}}e.textPolyData.getPoints().setData(c,3),e.textPolyData.modified()},t.update=()=>{if(!e.camera)return;const r=t.computeFacesToDraw(),i=e.lastFacesToDraw;let a=!1;for(let o=0;o<6;o++)e.dataBounds[o]!==e.lastTickBounds[o]&&(a=!0,e.lastTickBounds[o]=e.dataBounds[o]);if(r||a||e.forceUpdate){const o=new Array(12).fill(0);for(let l=0;l<6;l++)if(i[l])for(let c=0;c<4;c++)o[Zk[l][c]]++;const s=e.generateTicks(e.dataBounds);t.updatePolyData(i,o,s.ticks),t.updateTextData(i,o,s.ticks,s.tickStrings),(a||e.forceUpdate)&&t.updateTextureAtlas(s.tickStrings)}e.forceUpdate=!1},t.updateTextureAtlas=r=>{e.tmContext.textBaseline="bottom",e.tmContext.textAlign="left",e._tmAtlas.clear();let i=0,a=1;for(let o=0;o<3;o++){if(!e._tmAtlas.has(e.axisLabels[o])){x8(e.tmContext,e.axisTextStyle);const s=e.tmContext.measureText(e.axisLabels[o]),l={height:s.actualBoundingBoxAscent+2,startingHeight:a,width:s.width+2,textStyle:e.axisTextStyle};e._tmAtlas.set(e.axisLabels[o],l),a+=l.height,i<l.width&&(i=l.width)}x8(e.tmContext,e.tickTextStyle);for(let s=0;s<r[o].length;s++)if(!e._tmAtlas.has(r[o][s])){const l=e.tmContext.measureText(r[o][s]),c={height:l.actualBoundingBoxAscent+2,startingHeight:a,width:l.width+2,textStyle:e.tickTextStyle};e._tmAtlas.set(r[o][s],c),a+=c.height,i<c.width&&(i=c.width)}}i=Dl(i),a=Dl(a),e._tmAtlas.forEach(o=>{o.tcoords=[0,(a-o.startingHeight-o.height)/a,o.width/i,(a-o.startingHeight-o.height)/a,o.width/i,(a-o.startingHeight)/a,0,(a-o.startingHeight)/a]}),e.tmCanvas.width=i,e.tmCanvas.height=a,e.tmContext.textBaseline="bottom",e.tmContext.textAlign="left",e.tmContext.clearRect(0,0,i,a),e._tmAtlas.forEach((o,s)=>{x8(e.tmContext,o.textStyle),e.tmContext.fillText(s,1,o.startingHeight+o.height-1)}),e.tmTexture.setCanvas(e.tmCanvas),e.tmTexture.modified()},t.onModified(()=>{e.forceUpdate=!0,t.update()}),t.setTickTextStyle=r=>{e.tickTextStyle={...e.tickTextStyle,...r},t.modified()},t.setAxisTextStyle=r=>{e.axisTextStyle={...e.axisTextStyle,...r},t.modified()},t.get_tmAtlas=()=>e._tmAtlas,t.getBounds=()=>(t.update(),wr.setBounds(e.bounds,e.gridActor.getBounds()),wr.scaleAboutCenter(e.bounds,e.boundsScaleFactor,e.boundsScaleFactor,e.boundsScaleFactor),e.bounds);const n=le.chain(t.setProperty,e.gridActor.setProperty);t.setProperty=r=>n(r)[0]}function kOe(t,e,n){return{boundsScaleFactor:1.3,camera:null,dataBounds:[...wr.INIT_BOUNDS],faceVisibilityAngle:8,gridLines:!0,axisLabels:null,axisTitlePixelOffset:35,tickLabelPixelOffset:12,generateTicks:cZ,...n,axisTextStyle:{fontColor:"white",fontStyle:"normal",fontSize:18,fontFamily:"serif",...n?.axisTextStyle},tickTextStyle:{fontColor:"white",fontStyle:"normal",fontSize:14,fontFamily:"serif",...n?.tickTextStyle}}}function uZ(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};m0.extend(t,e,kOe(t,e,n)),e.lastFacesToDraw=[!1,!1,!1,!1,!1,!1],e.axisLabels=["X-Axis","Y-Axis","Z-Axis"],e.tickCounts=[],e.textValues=[],e.lastTickBounds=[],e.tmCanvas=document.createElement("canvas"),e.tmContext=e.tmCanvas.getContext("2d"),e._tmAtlas=new Map,e.tmTexture=zm.newInstance({resizable:!0}),e.tmTexture.setInterpolate(!1),t.getProperty().setDiffuse(0),t.getProperty().setAmbient(1),e.gridMapper=gc.newInstance(),e.polyData=ra.newInstance(),e.gridMapper.setInputData(e.polyData),e.gridActor=m0.newInstance(),e.gridActor.setMapper(e.gridMapper),e.gridActor.setProperty(t.getProperty()),e.gridActor.setParentProp(t),e.textPolyData=ra.newInstance(),le.setGet(t,e,["axisTitlePixelOffset","boundsScaleFactor","faceVisibilityAngle","gridLines","tickLabelPixelOffset","generateTicks"]),le.setGetArray(t,e,["dataBounds"],6),le.setGetArray(t,e,["axisLabels"],3),le.get(t,e,["axisTextStyle","tickTextStyle","camera","tmTexture","textValues","textPolyData","tickCounts","gridActor"]),LOe(t,e)}const VOe=le.newInstance(uZ,"vtkCubeAxesActor");var fZ={newInstance:VOe,extend:uZ,newCubeAxesActorHelper:NOe,defaultGenerateTicks:cZ};function FOe(t,e){e.classHierarchy.push("vtkOpenGLCubeAxesActor"),t.buildPass=n=>{n&&(e._openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e._openGLRenderWindow=e._openGLRenderer.getParent(),e.CubeAxesActorHelper.getRenderable()||e.CubeAxesActorHelper.setRenderable(e.renderable),t.prepareNodes(),t.addMissingNode(e.CubeAxesActorHelper.getTmActor()),t.addMissingNode(e.renderable.getGridActor()),t.removeUnusedNodes())},t.opaquePass=(n,r)=>{if(n){const i=e._openGLRenderer?e._openGLRenderer.getRenderable().getActiveCamera():null,a=e._openGLRenderer.getTiledSizeAndOrigin();e.CubeAxesActorHelper.updateAPISpecificData([a.usize,a.vsize],i,e._openGLRenderWindow.getRenderable())}}}const UOe={};function BOe(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,UOe,n),Rr.extend(t,e,n),e.CubeAxesActorHelper=fZ.newCubeAxesActorHelper(),FOe(t,e)}const $Oe=Zn(BOe,"vtkOpenGLCubeAxesActor");sa("vtkCubeAxesActor",$Oe);const{ColorMode:GOe,ScalarMode:Q0,GetArray:b8}=$w;function jOe(t,e){e.classHierarchy.push("vtkMapper2D"),t.createDefaultLookupTable=()=>{e.lookupTable=C3.newInstance()},t.getColorModeAsString=()=>le.enumToString(GOe,e.colorMode),t.setColorModeToDefault=()=>t.setColorMode(0),t.setColorModeToMapScalars=()=>t.setColorMode(1),t.setColorModeToDirectScalars=()=>t.setColorMode(2),t.getScalarModeAsString=()=>le.enumToString(Q0,e.scalarMode),t.setScalarModeToDefault=()=>t.setScalarMode(0),t.setScalarModeToUsePointData=()=>t.setScalarMode(1),t.setScalarModeToUseCellData=()=>t.setScalarMode(2),t.setScalarModeToUsePointFieldData=()=>t.setScalarMode(3),t.setScalarModeToUseCellFieldData=()=>t.setScalarMode(4),t.setScalarModeToUseFieldData=()=>t.setScalarMode(5),t.getAbstractScalars=(n,r,i,a,o)=>{if(!n||!e.scalarVisibility)return{scalars:null,cellFLag:!1};let s=null,l=!1;if(r===Q0.DEFAULT)s=n.getPointData().getScalars(),s||(s=n.getCellData().getScalars(),l=!0);else if(r===Q0.USE_POINT_DATA)s=n.getPointData().getScalars();else if(r===Q0.USE_CELL_DATA)s=n.getCellData().getScalars(),l=!0;else if(r===Q0.USE_POINT_FIELD_DATA){const c=n.getPointData();i===b8.BY_ID?s=c.getArrayByIndex(a):s=c.getArrayByName(o)}else if(r===Q0.USE_CELL_FIELD_DATA){const c=n.getCellData();l=!0,i===b8.BY_ID?s=c.getArrayByIndex(a):s=c.getArrayByName(o)}else if(r===Q0.USE_FIELD_DATA){const c=n.getFieldData();i===b8.BY_ID?s=c.getArrayByIndex(a):s=c.getArrayByName(o)}return{scalars:s,cellFlag:l}},t.getLookupTable=()=>(e.lookupTable||t.createDefaultLookupTable(),e.lookupTable),t.getMTime=()=>{let n=e.mtime;if(e.lookupTable!==null){const r=e.lookupTable.getMTime();n=r>n?r:n}return n},t.mapScalars=(n,r)=>{const i=t.getAbstractScalars(n,e.scalarMode,e.arrayAccessMode,e.arrayId,e.colorByArrayName).scalars;if(!i){e.colorMapColors=null;return}const a=`${t.getMTime()}${i.getMTime()}${r}`;if(e.colorBuildString===a)return;e.useLookupTableScalarRange||t.getLookupTable().setRange(e.scalarRange[0],e.scalarRange[1]);const o=t.getLookupTable();o&&(o.build(),e.colorMapColors=o.mapScalars(i,e.colorMode,e.fieldDataTupleId)),e.colorBuildString=`${t.getMTime()}${i.getMTime()}${r}`},t.getPrimitiveCount=()=>{const n=t.getInputData();return{points:n.getPoints().getNumberOfValues()/3,verts:n.getVerts().getNumberOfValues()-n.getVerts().getNumberOfCells(),lines:n.getLines().getNumberOfValues()-2*n.getLines().getNumberOfCells(),triangles:n.getPolys().getNumberOfValues()-3*n.getPolys().getNumberOfCells()}}}const zOe={static:!1,lookupTable:null,scalarVisibility:!1,scalarRange:[0,1],useLookupTableScalarRange:!1,colorMode:0,scalarMode:0,arrayAccessMode:1,renderTime:0,colorByArrayName:null,transformCoordinate:null,viewSpecificProperties:null,customShaderAttributes:[]};function WOe(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,zOe,n),JX.extend(t,e,n),le.get(t,e,["colorMapColors"]),le.setGet(t,e,["arrayAccessMode","colorByArrayName","colorMode","lookupTable","renderTime","scalarMode","scalarVisibility","static","transformCoordinate","useLookupTableScalarRange","viewSpecificProperties","customShaderAttributes"]),le.setGetArray(t,e,["scalarRange"],2),e.viewSpecificProperties||(e.viewSpecificProperties={}),jOe(t,e)}le.newInstance(WOe,"vtkMapper2D");var HOe={},KOe=`//VTK::System::Dec

/*=========================================================================

  Program:   Visualization Toolkit
  Module:    vtkPolyData2DFS.glsl

  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen
  All rights reserved.
  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.

     This software is distributed WITHOUT ANY WARRANTY; without even
     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
     PURPOSE.  See the above copyright notice for more information.

=========================================================================*/

uniform int PrimitiveIDOffset;

// Texture coordinates
//VTK::TCoord::Dec

// Scalar coloring
//VTK::Color::Dec

// Depth Peeling
//VTK::DepthPeeling::Dec

// picking support
//VTK::Picking::Dec

// the output of this shader
//VTK::Output::Dec

// Apple Bug
//VTK::PrimID::Dec

void main()
{
  // Apple Bug
  //VTK::PrimID::Impl

  //VTK::Color::Impl
  //VTK::TCoord::Impl

  //VTK::DepthPeeling::Impl
  //VTK::Picking::Impl

  if (gl_FragData[0].a <= 0.0)
    {
    discard;
    }
}
`,qOe=`//VTK::System::Dec

/*=========================================================================

  Program:   Visualization Toolkit
  Module:    vtkPolyData2DVS.glsl

  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen
  All rights reserved.
  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.

     This software is distributed WITHOUT ANY WARRANTY; without even
     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
     PURPOSE.  See the above copyright notice for more information.

=========================================================================*/

// all variables that represent positions or directions have a suffix
// indicating the coordinate system they are in. The possible values are
// MC - Model Coordinates
// WC - WC world coordinates
// VC - View Coordinates
// DC - Display Coordinates

in vec4 vertexWC;

// frag position in VC
//VTK::PositionVC::Dec

// material property values
//VTK::Color::Dec

// Texture coordinates
//VTK::TCoord::Dec

// Apple Bug
//VTK::PrimID::Dec

uniform mat4 WCVCMatrix;  // World to view matrix

void main()
{
  // Apple Bug
  //VTK::PrimID::Impl

  gl_Position = WCVCMatrix*vertexWC;

  //VTK::TCoord::Impl

  //VTK::Color::Impl

  //VTK::PositionVC::Impl
}
`;const dZ={BACKGROUND:0,FOREGROUND:1};var hZ={DisplayLocation:dZ};const{primTypes:oc}=Tu,{ScalarMode:Cx}=HOe,{vtkErrorMacro:Sx}=po,XOe={type:"StartEvent"},YOe={type:"EndEvent"};function JOe(t,e){e.classHierarchy.push("vtkOpenGLPolyDataMapper2D"),t.buildPass=r=>{r&&(e.openGLActor2D=t.getFirstAncestorOfType("vtkOpenGLActor2D"),e._openGLRenderer=e.openGLActor2D.getFirstAncestorOfType("vtkOpenGLRenderer"),e._openGLRenderWindow=e._openGLRenderer.getLastAncestorOfType("vtkOpenGLRenderWindow"),e.openGLCamera=e._openGLRenderer.getViewNodeFor(e._openGLRenderer.getRenderable().getActiveCamera()))},t.overlayPass=r=>{r&&t.render()},t.getShaderTemplate=(r,i,a)=>{r.Vertex=qOe,r.Fragment=KOe,r.Geometry=""},t.render=()=>{const r=e._openGLRenderWindow.getContext();if(e.context!==r){e.context=r;for(let o=oc.Start;o<oc.End;o++)e.primitives[o].setOpenGLRenderWindow(e._openGLRenderWindow)}const i=e.openGLActor2D.getRenderable(),a=e._openGLRenderer.getRenderable();t.renderPiece(a,i)},t.renderPiece=(r,i)=>{if(t.invokeEvent(XOe),e.renderable.getStatic()||e.renderable.update(),e.currentInput=e.renderable.getInputData(),t.invokeEvent(YOe),!e.currentInput){Sx("No input!");return}!e.currentInput.getPoints||!e.currentInput.getPoints().getNumberOfValues()||(t.renderPieceStart(r,i),t.renderPieceDraw(r,i),t.renderPieceFinish(r,i))},t.renderPieceStart=(r,i)=>{if(e.primitiveIDOffset=0,e._openGLRenderer.getSelector())switch(e._openGLRenderer.getSelector().getCurrentPass()){default:e._openGLRenderer.getSelector().renderProp(i)}t.updateBufferObjects(r,i),e.lastBoundBO=null},t.getNeedToRebuildShaders=(r,i,a)=>r.getShaderSourceTime().getMTime()<e.renderable.getMTime()||r.getShaderSourceTime().getMTime()<e.currentInput.getMTime(),t.updateBufferObjects=(r,i)=>{t.getNeedToRebuildBufferObjects(r,i)&&t.buildBufferObjects(r,i)},t.getNeedToRebuildBufferObjects=(r,i)=>{const a=e.VBOBuildTime.getMTime();return!!(a<t.getMTime()||a<e._openGLRenderWindow.getMTime()||a<e.renderable.getMTime()||a<i.getMTime()||a<e.currentInput.getMTime()||e.renderable.getTransformCoordinate()&&a<r.getMTime())},t.buildBufferObjects=(r,i)=>{const a=e.currentInput;if(a===null)return;e.renderable.mapScalars(a,i.getProperty().getOpacity());const o=e.renderable.getColorMapColors();e.haveCellScalars=!1;const s=e.renderable.getScalarMode();e.renderable.getScalarVisibility()&&(s===Cx.USE_CELL_DATA||s===Cx.USE_CELL_FIELD_DATA||s===Cx.USE_FIELD_DATA||!a.getPointData().getScalars())&&s!==Cx.USE_POINT_FIELD_DATA&&o&&(e.haveCellScalars=!0);const l=i.getProperty().getRepresentation();let c=a.getPointData().getTCoords();e.openGLActor2D.getActiveTextures()||(c=null);const f=e.renderable.getTransformCoordinate(),d=r.getRenderWindow().getViews()[0].getViewportSize(r),h=`${a.getMTime()}A${l}B${a.getMTime()}C${o?o.getMTime():1}D${c?c.getMTime():1}E${f?r.getMTime():1}F${d}`;if(e.VBOBuildString!==h){let p=a.getPoints();if(f){const m=m3.newInstance(),y=p.getNumberOfPoints();m.setNumberOfPoints(y);const v=[];for(let x=0;x<y;++x){p.getPoint(x,v),f.setValue(v);const w=f.getComputedDoubleViewportValue(r);m.setPoint(x,w[0],w[1],0)}p=m}const g={points:p,tcoords:c,colors:o,cellOffset:0,haveCellScalars:e.haveCellSCalars,customAttributes:e.renderable.getCustomShaderAttributes().map(m=>a.getPointData().getArrayByName(m))};g.cellOffset+=e.primitives[oc.Points].getCABO().createVBO(a.getVerts(),"verts",l,g),g.cellOffset+=e.primitives[oc.Lines].getCABO().createVBO(a.getLines(),"lines",l,g),g.cellOffset+=e.primitives[oc.Tris].getCABO().createVBO(a.getPolys(),"polys",l,g),g.cellOffset+=e.primitives[oc.TriStrips].getCABO().createVBO(a.getStrips(),"strips",l,g),e.VBOBuildTime.modified(),e.VBOBuildString=h}},t.renderPieceDraw=(r,i)=>{const a=i.getProperty().getRepresentation();e.context.depthMask(!0);for(let s=oc.Start;s<oc.End;s++)e.primitives[s].getCABO().getElementCount()&&(e.lastBoundBO=e.primitives[s],e.primitiveIDOffset+=e.primitives[s].drawArrays(r,i,a,t))},t.renderPieceFinish=(r,i)=>{e.lastBoundBO&&e.lastBoundBO.getVAO().release()},t.replaceShaderValues=(r,i,a)=>{t.replaceShaderColor(r,i,a),t.replaceShaderTCoord(r,i,a),t.replaceShaderPicking(r,i,a),t.replaceShaderPositionVC(r,i,a)},t.replaceShaderColor=(r,i,a)=>{let o=r.Vertex,s=r.Geometry,l=r.Fragment;e.haveCellScalars&&(l=Be.substitute(l,"//VTK::Color::Dec",["uniform samplerBuffer texture1;"]).result,l=Be.substitute(l,"//VTK::Color::Impl",["gl_FragData[0] = texelFetchBuffer(texture1, gl_PrimitiveID + PrimitiveIDOffset);"]).result),e.lastBoundBO.getCABO().getColorComponents()!==0?(o=Be.substitute(o,"//VTK::Color::Dec",["in vec4 diffuseColor;","out vec4 fcolorVSOutput;"]).result,o=Be.substitute(o,"//VTK::Color::Impl",["fcolorVSOutput = diffuseColor;"]).result,s=Be.substitute(s,"//VTK::Color::Dec",[`in vec4 fcolorVSOutput[];
`,"out vec4 fcolorGSOutput;"]).result,s=Be.substitute(s,"//VTK::Color::Impl",["fcolorGSOutput = fcolorVSOutput[i];"]).result,l=Be.substitute(l,"//VTK::Color::Dec",["in vec4 fcolorVSOutput;"]).result,l=Be.substitute(l,"//VTK::Color::Impl",["gl_FragData[0] = fcolorVSOutput;"]).result):(l=Be.substitute(l,"//VTK::Color::Dec",["uniform vec4 diffuseColor;"]).result,l=Be.substitute(l,"//VTK::Color::Impl",["gl_FragData[0] = diffuseColor;"]).result),r.Vertex=o,r.Geometry=s,r.Fragment=l},t.replaceShaderTCoord=(r,i,a)=>{if(e.lastBoundBO.getCABO().getTCoordOffset()){let o=r.Vertex,s=r.Geometry,l=r.Fragment;const c=e.lastBoundBO.getCABO().getTCoordComponents();c===1?(o=Be.substitute(o,"//VTK::TCoord::Dec",["in float tcoordMC;","out float tcoordVCVSOutput;"]).result,o=Be.substitute(o,"//VTK::TCoord::Impl",["tcoordVCVSOutput = tcoordMC;"]).result,s=Be.substitute(s,"//VTK::TCoord::Dec",[`in float tcoordVCVSOutput[];
`,"out float tcoordVCGSOutput;"]).result,s=Be.substitute(s,["//VTK::TCoord::Impl","tcoordVCGSOutput = tcoordVCVSOutput[i];"]).result,l=Be.substitute(l,"//VTK::TCoord::Dec",["in float tcoordVCVSOutput;","uniform sampler2D texture1;"]).result,l=Be.substitute(l,"//VTK::TCoord::Impl",["gl_FragData[0] = gl_FragData[0]*texture2D(texture1, vec2(tcoordVCVSOutput,0));"]).result):c===2&&(o=Be.substitute(o,"//VTK::TCoord::Dec",["in vec2 tcoordMC;","out vec2 tcoordVCVSOutput;"]).result,o=Be.substitute(o,"//VTK::TCoord::Impl",["tcoordVCVSOutput = tcoordMC;"]).result,s=Be.substitute(s,"//VTK::TCoord::Dec",[`in vec2 tcoordVCVSOutput[];
`,"out vec2 tcoordVCGSOutput;"]).result,s=Be.substitute(s,"//VTK::TCoord::Impl",["tcoordVCGSOutput = tcoordVCVSOutput[i];"]).result,l=Be.substitute(l,"//VTK::TCoord::Dec",["in vec2 tcoordVCVSOutput;","uniform sampler2D texture1;"]).result,l=Be.substitute(l,"//VTK::TCoord::Impl",["gl_FragData[0] = gl_FragData[0]*texture2D(texture1, tcoordVCVSOutput.st);"]).result),e.haveCellScalars&&(s=Be.substitute(s,"//VTK::PrimID::Impl",["gl_PrimitiveID = gl_PrimitiveIDIn;"]).result),r.Vertex=o,r.Geometry=s,r.Fragment=l}},t.replaceShaderPicking=(r,i,a)=>{let o=r.Fragment;o=Be.substitute(o,"//VTK::Picking::Dec",["uniform vec3 mapperIndex;","uniform int picking;"]).result,o=Be.substitute(o,"//VTK::Picking::Impl","  gl_FragData[0] = picking != 0 ? vec4(mapperIndex,1.0) : gl_FragData[0];").result,r.Fragment=o},t.replaceShaderPositionVC=(r,i,a)=>{e.lastBoundBO.replaceShaderPositionVC(r,i,a)},t.invokeShaderCallbacks=(r,i,a)=>{const o=e.renderable.getViewSpecificProperties().ShadersCallbacks;o&&o.forEach(s=>{s.callback(s.userData,r,i,a)})},t.setMapperShaderParameters=(r,i,a)=>{if(r.getProgram().isUniformUsed("PrimitiveIDOffset")&&r.getProgram().setUniformi("PrimitiveIDOffset",e.primitiveIDOffset),r.getProgram().isAttributeUsed("vertexWC")&&(r.getVAO().addAttributeArray(r.getProgram(),r.getCABO(),"vertexWC",r.getCABO().getVertexOffset(),r.getCABO().getStride(),e.context.FLOAT,3,!1)||Sx("Error setting vertexWC in shader VAO.")),r.getCABO().getElementCount()&&(e.VBOBuildTime.getMTime()>r.getAttributeUpdateTime().getMTime()||r.getShaderSourceTime().getMTime()>r.getAttributeUpdateTime().getMTime())){e.renderable.getCustomShaderAttributes().forEach((l,c)=>{r.getProgram().isAttributeUsed(`${l}MC`)&&(r.getVAO().addAttributeArray(r.getProgram(),r.getCABO(),`${l}MC`,r.getCABO().getCustomData()[c].offset,r.getCABO().getStride(),e.context.FLOAT,r.getCABO().getCustomData()[c].components,!1)||Sx(`Error setting ${l}MC in shader VAO.`))}),r.getProgram().isAttributeUsed("tcoordMC")&&r.getCABO().getTCoordOffset()?r.getVAO().addAttributeArray(r.getProgram(),r.getCABO(),"tcoordMC",r.getCABO().getTCoordOffset(),r.getCABO().getStride(),e.context.FLOAT,r.getCABO().getTCoordComponents(),!1)||Sx("Error setting tcoordMC in shader VAO."):r.getVAO().removeAttributeArray("tcoordMC"),e.internalColorTexture&&r.getProgram().isUniformUsed("texture1")&&r.getProgram().setUniformi("texture1",e.internalColorTexture.getTextureUnit());const o=e.openGLActor2D.getActiveTextures();if(o)for(let l=0;l<o.length;++l){const f=o[l].getTextureUnit(),u=`texture${f+1}`;r.getProgram().isUniformUsed(u)&&r.getProgram().setUniformi(u,f)}r.setMapperShaderParameters(i,a,e._openGLRenderer.getTiledSizeAndOrigin());const s=e._openGLRenderer.getSelector();r.getProgram().setUniform3fArray("mapperIndex",s?s.getPropColorValue():[0,0,0]),r.getProgram().setUniformi("picking",s?s.getCurrentPass()+1:0)}},t.setPropertyShaderParameters=(r,i,a)=>{const o=e.renderable.getColorMapColors();if(!o||o.getNumberOfComponents()===0){const s=r.getProgram(),l=a.getProperty(),c=l.getOpacity(),f=l.getColor(),u=[f[0],f[1],f[2],c];s.setUniform4f("diffuseColor",u)}},t.setLightingShaderParameters=(r,i,a)=>{};function n(r,i,a){return i.identity(a),r.reduce((o,s,l)=>l===0?s?i.copy(o,s):i.identity(o):s?i.multiply(o,o,s):o,a)}t.setCameraShaderParameters=(r,i,a)=>{const o=r.getProgram(),l=r.getCABO().getCoordShiftAndScaleEnabled()?r.getCABO().getInverseShiftAndScaleMatrix():null,f=i.getRenderWindow().getViews()[0].getViewportSize(i),u=i.getViewport(),d=a.getActualPositionCoordinate().getComputedDoubleViewportValue(i),h=[0,0,1,1],p=[0,0,1,1];if(p[0]=u[0]>=h[0]?u[0]:h[0],p[1]=u[1]>=h[1]?u[1]:h[1],p[2]=u[2]<=h[2]?u[2]:h[2],p[3]=u[3]<=h[3]?u[3]:h[3],p[0]>=p[2]||p[1]>=p[3])return;f[0]=hv(f[0]*(p[2]-p[0])/(u[2]-u[0])),f[1]=hv(f[1]*(p[3]-p[1])/(u[3]-u[1]));const g=e._openGLRenderer.getParent().getSize(),m=hv(d[0]-(p[0]-u[0])*g[0]),y=hv(d[1]-(p[1]-u[1])*g[1]),v=-m;let x=-m+f[0];const w=-y;let S=-y+f[1];v===x&&(x=v+1),w===S&&(S=w+1);const T=sn(new Float64Array(16));T[0]=2/(x-v),T[5]=2/(S-w),T[3]=-1*(x+v)/(x-v),T[7]=-1*(S+w)/(S-w),T[10]=0,T[11]=a.getProperty().getDisplayLocation()===dZ.FOREGROUND?-1:1,T[15]=1,Gn(T,T),o.setUniformMatrix("WCVCMatrix",n([T,l],x2,e.tmpMat4))},t.getAllocatedGPUMemoryInBytes=()=>{let r=0;return e.primitives.forEach(i=>{r+=i.getAllocatedGPUMemoryInBytes()}),r}}const ZOe={context:null,VBOBuildTime:0,VBOBuildString:null,primitives:null,primTypes:null,shaderRebuildString:null};function QOe(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,ZOe,n),Rr.extend(t,e,n),mu.implementReplaceShaderCoincidentOffset(t,e,n),mu.implementBuildShadersWithReplacements(t,e,n),e.primitives=[],e.primTypes=oc,e.tmpMat4=sn(new Float64Array(16));for(let r=oc.Start;r<oc.End;r++)e.primitives[r]=Tu.newInstance(),e.primitives[r].setPrimitiveType(r),e.primitives[r].set({lastLightComplexity:0,lastLightCount:0,lastSelectionPass:!1},!0);Mi(t,e,["context"]),e.VBOBuildTime={},$r(e.VBOBuildTime,{mtime:0}),JOe(t,e)}const eMe=Zn(QOe,"vtkOpenGLPolyDataMapper2D");sa("vtkMapper2D",eMe);const{VectorMode:tMe}=Gw;function w8(t,e){t.strokeStyle=e.strokeColor,t.lineWidth=e.strokeSize,t.fillStyle=e.fontColor,t.font=`${e.fontStyle} ${e.fontSize}px ${e.fontFamily}`}function pZ(t,e){return n=>{const r=n.getLastSize(),i=(r[0]/700)**.8,a=(r[1]/700)**.8,o=Math.min(i,a),s=n.getAxisTextStyle(),l=n.getTickTextStyle();Object.assign(s,e.axisTextStyle),Object.assign(l,e.tickTextStyle),s.fontSize=Math.max(24*o,12),n.getLastAspectRatio()>1?l.fontSize=Math.max(20*o,10):l.fontSize=Math.max(16*o,10);const c=n.updateTextureAtlas();n.setTopTitle(!1);const f=n.getBoxSizeByReference();if(n.getLastAspectRatio()>1)n.setTickLabelPixelOffset(.3*l.fontSize),c.titleWidth<=c.tickWidth+n.getTickLabelPixelOffset()+.8*l.fontSize?(n.setTopTitle(!0),n.setAxisTitlePixelOffset(.2*l.fontSize),f[0]=2*(c.tickWidth+n.getTickLabelPixelOffset()+.8*l.fontSize)/r[0],n.setBoxPosition([.98-f[0],-.92])):(n.setAxisTitlePixelOffset(.2*l.fontSize),f[0]=2*(c.titleHeight+n.getAxisTitlePixelOffset()+c.tickWidth+n.getTickLabelPixelOffset()+.8*l.fontSize)/r[0],n.setBoxPosition([.99-f[0],-.92])),f[1]=Math.max(1.2,Math.min(1.84/a,1.84));else{n.setAxisTitlePixelOffset(1.2*l.fontSize),n.setTickLabelPixelOffset(.1*l.fontSize);const u=2*(.8*l.fontSize+c.titleHeight+n.getAxisTitlePixelOffset())/r[1],d=2*c.tickWidth/r[0];f[0]=Math.min(1.9,Math.max(1.4,1.4*d*(n.getTicks().length+3))),f[1]=u,n.setBoxPosition([-.5*f[0],-.97])}n.recomputeBarSegments(c)}}function gZ(t,e){return n=>{const r=n.getLastTickBounds(),i=c7().domain([r[0],r[1]]),a=i.ticks(5),o=i.tickFormat(5);n.setTicks(a),n.setTickStrings(a.map(o))}}function nMe(t,e){e.classHierarchy.push("vtkScalarBarActorHelper"),t.setRenderable=i=>{e.renderable!==i&&(e.renderable=i,e.barActor.setProperty(i.getProperty()),e.barActor.setParentProp(i),e.barActor.setCoordinateSystemToDisplay(),e.tmActor.setProperty(i.getProperty()),e.tmActor.setParentProp(i),e.tmActor.setCoordinateSystemToDisplay(),e.generateTicks=i.generateTicks,e.axisTextStyle={...i.getAxisTextStyle()},e.tickTextStyle={...i.getTickTextStyle()},t.modified())},t.updateAPISpecificData=(i,a,o)=>{(e.lastSize[0]!==i[0]||e.lastSize[1]!==i[1])&&(e.lastSize[0]=i[0],e.lastSize[1]=i[1],e.lastAspectRatio=i[0]/i[1],e.forceUpdate=!0);const s=e.renderable.getScalarsToColors();if(!(!s||!e.renderable.getVisibility())&&(e.barMapper.setLookupTable(s),e.camera=a,e.renderWindow=o,e.forceUpdate||Math.max(s.getMTime(),t.getMTime(),e.renderable.getMTime())>e.lastRebuildTime.getMTime())){const l=s.getMappingRange();if(e.lastTickBounds=[...l],e.renderable.getGenerateTicks()(t),e.renderable.getAutomated())e.renderable.getAutoLayout()(t);else{e.axisTextStyle={...e.renderable.getAxisTextStyle()},e.tickTextStyle={...e.renderable.getTickTextStyle()},e.barPosition=[...e.renderable.getBarPosition()],e.barSize=[...e.renderable.getBarSize()],e.boxPosition=[...e.renderable.getBoxPosition()],e.boxSize=[...e.renderable.getBoxSize()],e.axisTitlePixelOffset=e.renderable.getAxisTitlePixelOffset(),e.tickLabelPixelOffset=e.renderable.getTickLabelPixelOffset();const c=t.updateTextureAtlas();t.recomputeBarSegments(c)}t.updatePolyDataForLabels(),t.updatePolyDataForBarSegments(),e.lastRebuildTime.modified(),e.forceUpdate=!1}},t.updateTextureAtlas=()=>{e.tmContext.textBaseline="bottom",e.tmContext.textAlign="left";const i={},a=new Map;let o=0,s=1;w8(e.tmContext,e.axisTextStyle);let l=e.tmContext.measureText(e.renderable.getAxisLabel()),c={height:l.actualBoundingBoxAscent+2,startingHeight:s,width:l.width+2,textStyle:e.axisTextStyle};a.set(e.renderable.getAxisLabel(),c),s+=c.height,o=c.width,i.titleWidth=c.width,i.titleHeight=c.height,i.tickWidth=0,i.tickHeight=0,w8(e.tmContext,e.tickTextStyle);const f=[...t.getTickStrings(),"NaN","Below","Above"];for(let u=0;u<f.length;u++)a.has(f[u])||(l=e.tmContext.measureText(f[u]),c={height:l.actualBoundingBoxAscent+2,startingHeight:s,width:l.width+2,textStyle:e.tickTextStyle},a.set(f[u],c),s+=c.height,o<c.width&&(o=c.width),i.tickWidth<c.width&&(i.tickWidth=c.width),i.tickHeight<c.height&&(i.tickHeight=c.height));return o=Dl(o),s=Dl(s),a.forEach(u=>{u.tcoords=[0,(s-u.startingHeight-u.height)/s,u.width/o,(s-u.startingHeight-u.height)/s,u.width/o,(s-u.startingHeight)/s,0,(s-u.startingHeight)/s]}),e.tmCanvas.width=o,e.tmCanvas.height=s,e.tmContext.textBaseline="bottom",e.tmContext.textAlign="left",e.tmContext.clearRect(0,0,o,s),a.forEach((u,d)=>{w8(e.tmContext,u.textStyle),e.tmContext.fillText(d,1,u.startingHeight+u.height-1)}),e.tmTexture.setCanvas(e.tmCanvas),e.tmTexture.modified(),e._tmAtlas=a,i},t.computeBarSize=i=>{e.vertical=e.boxSize[1]>e.boxSize[0];const a=2*i.tickHeight/e.lastSize[1],o=[1,1];if(e.vertical){const s=2*(i.tickWidth+e.tickLabelPixelOffset)/e.lastSize[0];if(e.topTitle){const l=2*(i.titleHeight+e.axisTitlePixelOffset)/e.lastSize[1];e.barSize[0]=e.boxSize[0]-s,e.barSize[1]=e.boxSize[1]-l}else{const l=2*(i.titleHeight+e.axisTitlePixelOffset)/e.lastSize[0];e.barSize[0]=e.boxSize[0]-l-s,e.barSize[1]=e.boxSize[1]}e.barPosition[0]=e.boxPosition[0]+s,e.barPosition[1]=e.boxPosition[1],o[1]=a}else{const s=(2*i.tickWidth-8)/e.lastSize[0],l=2*(i.titleHeight+e.axisTitlePixelOffset)/e.lastSize[1];e.barSize[0]=e.boxSize[0],e.barPosition[0]=e.boxPosition[0],e.barSize[1]=e.boxSize[1]-l,e.barPosition[1]=e.boxPosition[1],o[0]=s}return o},t.recomputeBarSegments=i=>{const a=t.computeBarSize(i);e.barSegments=[];const o=[0,0],s=e.vertical?1:0,l=e.vertical?.01:.02;function c(d,h){e.barSegments.push({corners:[[...o],[o[0]+a[0],o[1]],[o[0]+a[0],o[1]+a[1]],[o[0],o[1]+a[1]]],scalars:h,title:d}),o[s]+=a[s]+l}e.renderable.getDrawNanAnnotation()&&e.renderable.getScalarsToColors().getNanColor()&&c("NaN",[NaN,NaN,NaN,NaN]),e.renderable.getDrawBelowRangeSwatch()&&e.renderable.getScalarsToColors().getUseBelowRangeColor?.()&&c("Below",[-.1,-.1,-.1,-.1]);const f=e.renderable.getScalarsToColors().getUseAboveRangeColor?.();o[s]+=l;const u=a[s];a[s]=f?1-2*l-a[s]-o[s]:1-l-o[s],c("ticks",e.vertical?[0,0,.995,.995]:[0,.995,.995,0]),e.renderable.getDrawAboveRangeSwatch()&&f&&(a[s]=u,o[s]+=l,c("Above",[1.1,1.1,1.1,1.1]))};const n=new Float64Array(3);t.createPolyDataForOneLabel=(i,a,o,s,l,c)=>{const f=e._tmAtlas.get(i);if(!f)return;let u=c.ptIdx,d=c.cellIdx;n[0]=(.5*a[0]+.5)*e.lastSize[0],n[1]=(.5*a[1]+.5)*e.lastSize[1],n[2]=a[2],n[0]+=l[0],n[1]+=l[1];const h=[],p=s==="vertical"?[1,0]:[0,1];s==="vertical"?(h[0]=f.width,h[1]=-f.height,o[0]==="middle"?n[1]-=f.width/2:o[0]==="right"&&(n[1]-=f.width),o[1]==="middle"?n[0]+=f.height/2:o[1]==="top"&&(n[0]+=f.height)):(h[0]=f.width,h[1]=f.height,o[0]==="middle"?n[0]-=f.width/2:o[0]==="right"&&(n[0]-=f.width),o[1]==="middle"?n[1]-=f.height/2:o[1]==="top"&&(n[1]-=f.height)),c.points[u*3]=n[0],c.points[u*3+1]=n[1],c.points[u*3+2]=n[2],c.tcoords[u*2]=f.tcoords[0],c.tcoords[u*2+1]=f.tcoords[1],u++,n[p[0]]+=h[0],c.points[u*3]=n[0],c.points[u*3+1]=n[1],c.points[u*3+2]=n[2],c.tcoords[u*2]=f.tcoords[2],c.tcoords[u*2+1]=f.tcoords[3],u++,n[p[1]]+=h[1],c.points[u*3]=n[0],c.points[u*3+1]=n[1],c.points[u*3+2]=n[2],c.tcoords[u*2]=f.tcoords[4],c.tcoords[u*2+1]=f.tcoords[5],u++,n[p[0]]-=h[0],c.points[u*3]=n[0],c.points[u*3+1]=n[1],c.points[u*3+2]=n[2],c.tcoords[u*2]=f.tcoords[6],c.tcoords[u*2+1]=f.tcoords[7],u++,c.polys[d*4]=3,c.polys[d*4+1]=u-4,c.polys[d*4+2]=u-3,c.polys[d*4+3]=u-2,d++,c.polys[d*4]=3,c.polys[d*4+1]=u-4,c.polys[d*4+2]=u-2,c.polys[d*4+3]=u-1,c.ptIdx+=4,c.cellIdx+=2};const r=new Float64Array(3);t.updatePolyDataForLabels=()=>{const i=t.getTickStrings().length+e.barSegments.length,a=i*4,o=i*2,s=new Float64Array(a*3),l=new Uint16Array(o*4),c=new Float32Array(a*2),f={ptIdx:0,cellIdx:0,polys:l,points:s,tcoords:c},u=e.vertical?0:1,d=e.vertical?1:0;r[2]=-.99;const h=e.vertical?["right","middle"]:["middle","bottom"];let p=[0,1];const g=[0,0];e.vertical?(g[0]=-e.tickLabelPixelOffset,e.topTitle?(r[0]=e.boxPosition[0]+.5*e.boxSize[0],r[1]=e.barPosition[1]+e.barSize[1],t.createPolyDataForOneLabel(e.renderable.getAxisLabel(),r,["middle","bottom"],"horizontal",[0,e.axisTitlePixelOffset],f)):(r[0]=e.barPosition[0]+e.barSize[0],r[1]=e.barPosition[1]+.5*e.barSize[1],t.createPolyDataForOneLabel(e.renderable.getAxisLabel(),r,["middle","top"],"vertical",[e.axisTitlePixelOffset,0],f)),p=[-1,0]):(g[1]=e.tickLabelPixelOffset,r[0]=e.barPosition[0]+.5*e.barSize[0],r[1]=e.barPosition[1]+e.barSize[1],t.createPolyDataForOneLabel(e.renderable.getAxisLabel(),r,["middle","bottom"],"horizontal",[0,e.axisTitlePixelOffset],f)),r[u]=e.barPosition[u]+(.5*p[u]+.5)*e.barSize[u],r[d]=e.barPosition[d]+e.barSize[d]*.5;let m=null;for(let T=0;T<e.barSegments.length;T++){const _=e.barSegments[T];_.title==="ticks"?m=_:(r[d]=e.barPosition[d]+.5*e.barSize[d]*(_.corners[2][d]+_.corners[0][d]),t.createPolyDataForOneLabel(_.title,r,h,"horizontal",g,f))}const y=e.barPosition[d]+e.barSize[d]*m.corners[0][d],v=e.barSize[d]*(m.corners[2][d]-m.corners[0][d]),x=t.getTicks(),w=t.getTickStrings();for(let T=0;T<x.length;T++){const _=(x[T]-e.lastTickBounds[0])/(e.lastTickBounds[1]-e.lastTickBounds[0]);r[d]=y+v*_,t.createPolyDataForOneLabel(w[T],r,h,"horizontal",g,f)}const S=nn.newInstance({numberOfComponents:2,values:c,name:"TextureCoordinates"});e.tmPolyData.getPointData().setTCoords(S),e.tmPolyData.getPoints().setData(s,3),e.tmPolyData.getPoints().modified(),e.tmPolyData.getPolys().setData(l,1),e.tmPolyData.getPolys().modified(),e.tmPolyData.modified()},t.updatePolyDataForBarSegments=()=>{const i=e.renderable.getScalarsToColors();let a=0;e.renderable.getDrawNanAnnotation()&&i.getNanColor()&&(a+=1),e.renderable.getDrawBelowRangeSwatch()&&i.getUseBelowRangeColor?.()&&(a+=1),e.renderable.getDrawAboveRangeSwatch()&&i.getUseAboveRangeColor?.()&&(a+=1);const o=4*(1+a),s=o;let l=1;i.getVectorMode()===tMe.COMPONENT&&(l=i.getVectorComponent()+1);const c=new Float64Array(o*3),f=new Uint16Array(s*5),u=new Float32Array(o*l);let d=0,h=0;for(let g=0;g<e.barSegments.length;g++){const m=e.barSegments[g];for(let y=0;y<4;y++){r[0]=e.barPosition[0]+m.corners[y][0]*e.barSize[0],r[1]=e.barPosition[1]+m.corners[y][1]*e.barSize[1],c[d*3]=(.5*r[0]+.5)*e.lastSize[0],c[d*3+1]=(.5*r[1]+.5)*e.lastSize[1],c[d*3+2]=r[2];for(let v=0;v<l;v++)u[d*l+v]=e.lastTickBounds[0]+m.scalars[y]*(e.lastTickBounds[1]-e.lastTickBounds[0]);d++}f[h*5]=4,f[h*5+1]=d-4,f[h*5+2]=d-3,f[h*5+3]=d-2,f[h*5+4]=d-1,h++}const p=nn.newInstance({numberOfComponents:l,values:u,name:"Scalars"});e.polyData.getPointData().setScalars(p),e.polyData.getPoints().setData(c,3),e.polyData.getPoints().modified(),e.polyData.getPolys().setData(f,1),e.polyData.getPolys().modified(),e.polyData.modified()}}const rMe=le.newInstance(function(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{renderable:null};Object.assign(e,{},n),le.obj(t,e),le.setGet(t,e,["axisTitlePixelOffset","tickLabelPixelOffset","renderable","topTitle","ticks","tickStrings"]),le.get(t,e,["lastSize","lastAspectRatio","lastTickBounds","axisTextStyle","tickTextStyle","barActor","tmActor"]),le.getArray(t,e,["boxPosition","boxSize"]),le.setArray(t,e,["boxPosition","boxSize"],2),e.forceUpdate=!1,e.lastRebuildTime={},le.obj(e.lastRebuildTime,{mtime:0}),e.lastSize=[-1,-1],e.tmCanvas=document.createElement("canvas"),e.tmContext=e.tmCanvas.getContext("2d"),e._tmAtlas=new Map,e.barMapper=gc.newInstance(),e.barMapper.setInterpolateScalarsBeforeMapping(!0),e.barMapper.setUseLookupTableScalarRange(!0),e.polyData=ra.newInstance(),e.barMapper.setInputData(e.polyData),e.barActor=m0.newInstance(),e.barActor.setMapper(e.barMapper),e.tmPolyData=ra.newInstance(),e.tmMapper=gc.newInstance(),e.tmMapper.setInputData(e.tmPolyData),e.tmTexture=zm.newInstance({resizable:!0}),e.tmTexture.setInterpolate(!1),e.tmActor=m0.newInstance({parentProp:t}),e.tmActor.setMapper(e.tmMapper),e.tmActor.addTexture(e.tmTexture),e.barPosition=[0,0],e.barSize=[0,0],e.boxPosition=[.88,-.92],e.boxSize=[.1,1.1],e.lastTickBounds=[],nMe(t,e)},"vtkScalarBarActorHelper");function iMe(t,e){e.classHierarchy.push("vtkScalarBarActor"),t.setTickTextStyle=n=>{e.tickTextStyle={...e.tickTextStyle,...n},t.modified()},t.setAxisTextStyle=n=>{e.axisTextStyle={...e.axisTextStyle,...n},t.modified()},t.resetAutoLayoutToDefault=()=>{t.setAutoLayout(pZ(t,e))},t.resetGenerateTicksToDefault=()=>{t.setGenerateTicks(gZ())}}function aMe(t){return{automated:!0,autoLayout:null,axisLabel:"Scalar Value",barPosition:[0,0],barSize:[0,0],boxPosition:[.88,-.92],boxSize:[.1,1.1],scalarToColors:null,axisTitlePixelOffset:36,axisTextStyle:{fontColor:"white",fontStyle:"normal",fontSize:18,fontFamily:"serif"},tickLabelPixelOffset:14,tickTextStyle:{fontColor:"white",fontStyle:"normal",fontSize:14,fontFamily:"serif"},generateTicks:null,drawNanAnnotation:!0,drawBelowRangeSwatch:!0,drawAboveRangeSwatch:!0,...t}}function mZ(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,aMe(n)),e.autoLayout||(e.autoLayout=pZ(t,e)),e.generateTicks||(e.generateTicks=gZ()),m0.extend(t,e,n),t.getProperty().setDiffuse(0),t.getProperty().setAmbient(1),le.setGet(t,e,["automated","autoLayout","axisTitlePixelOffset","axisLabel","scalarsToColors","tickLabelPixelOffset","generateTicks","drawNanAnnotation","drawBelowRangeSwatch","drawAboveRangeSwatch"]),le.get(t,e,["axisTextStyle","tickTextStyle"]),le.getArray(t,e,["barPosition","barSize","boxPosition","boxSize"]),le.setArray(t,e,["barPosition","barSize","boxPosition","boxSize"],2),iMe(t,e)}const oMe=le.newInstance(mZ,"vtkScalarBarActor");var vZ={newInstance:oMe,extend:mZ,newScalarBarActorHelper:rMe};function sMe(t,e){e.classHierarchy.push("vtkOpenGLScalarBarActor"),t.buildPass=n=>{n&&(e._openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e._openGLRenderWindow=e._openGLRenderer.getParent(),e.scalarBarActorHelper.getRenderable()||e.scalarBarActorHelper.setRenderable(e.renderable),t.prepareNodes(),t.addMissingNode(e.scalarBarActorHelper.getBarActor()),t.addMissingNode(e.scalarBarActorHelper.getTmActor()),t.removeUnusedNodes())},t.opaquePass=(n,r)=>{if(n){const i=e._openGLRenderer?e._openGLRenderer.getRenderable().getActiveCamera():null,a=e._openGLRenderer.getTiledSizeAndOrigin();e.scalarBarActorHelper.updateAPISpecificData([a.usize,a.vsize],i,e._openGLRenderWindow.getRenderable())}}}const lMe={};function cMe(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,lMe,n),Rr.extend(t,e,n),e.scalarBarActorHelper=vZ.newScalarBarActorHelper(),sMe(t,e)}const uMe=Zn(cMe,"vtkOpenGLScalarBarActor");sa("vtkScalarBarActor",uMe);const{CoordinateSystem:eV}=ay;function fMe(t,e){e.classHierarchy.push("vtkWebGPUActor"),t.buildPass=n=>{n&&(e.WebGPURenderer=t.getFirstAncestorOfType("vtkWebGPURenderer"),e.WebGPURenderWindow=e.WebGPURenderer.getFirstAncestorOfType("vtkWebGPURenderWindow"),e.propID===void 0&&(e.propID=e.WebGPURenderWindow.getUniquePropID()),t.prepareNodes(),t.addMissingNode(e.renderable.getMapper()),t.removeUnusedNodes())},t.traverseOpaquePass=n=>{!e.renderable||!e.renderable.getNestedVisibility()||!e.renderable.getIsOpaque()||e.WebGPURenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(n,!0),e.children[0]&&e.children[0].traverse(n),t.apply(n,!1))},t.traverseTranslucentPass=n=>{!e.renderable||!e.renderable.getNestedVisibility()||e.renderable.getIsOpaque()||e.WebGPURenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(n,!0),e.children[0]&&e.children[0].traverse(n),t.apply(n,!1))},t.queryPass=(n,r)=>{if(n){if(!e.renderable||!e.renderable.getVisibility())return;e.renderable.getIsOpaque()?r.incrementOpaqueActorCount():r.incrementTranslucentActorCount()}},t.getBufferShift=n=>(t.getKeyMatrices(n),e.bufferShift),t.getKeyMatrices=n=>{if(Math.max(e.renderable.getMTime(),n.getStabilizedTime())>e.keyMatricesTime.getMTime()){e.renderable.computeMatrix();const r=e.renderable.getMatrix();e.bufferShift[0]=r[3],e.bufferShift[1]=r[7],e.bufferShift[2]=r[11];const i=n.getStabilizedCenterByReference();e.renderable.getCoordinateSystem()===eV.WORLD&&(e.bufferShift[0]-=i[0],e.bufferShift[1]-=i[1],e.bufferShift[2]-=i[2]),Gn(e.keyMatrices.bcwc,r),e.renderable.getIsIdentity()?sn(e.keyMatrices.normalMatrix):(Ei(e.keyMatrices.normalMatrix,e.keyMatrices.bcwc),e.keyMatrices.normalMatrix[3]=0,e.keyMatrices.normalMatrix[7]=0,e.keyMatrices.normalMatrix[11]=0,ba(e.keyMatrices.normalMatrix,e.keyMatrices.normalMatrix),Gn(e.keyMatrices.normalMatrix,e.keyMatrices.normalMatrix)),si(e.keyMatrices.bcwc,e.keyMatrices.bcwc,[-e.bufferShift[0],-e.bufferShift[1],-e.bufferShift[2]]),e.renderable.getCoordinateSystem()===eV.WORLD?si(e.keyMatrices.bcsc,e.keyMatrices.bcwc,[-i[0],-i[1],-i[2]]):Ei(e.keyMatrices.bcsc,e.keyMatrices.bcwc),e.keyMatricesTime.modified()}return e.keyMatrices}}const dMe={keyMatricesTime:null,keyMatrices:null,propID:void 0,bufferShift:void 0};function hMe(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,dMe,n),Rr.extend(t,e,n),e.keyMatricesTime={},le.obj(e.keyMatricesTime,{mtime:0}),e.keyMatrices={normalMatrix:new Float64Array(16),bcwc:new Float64Array(16),bcsc:new Float64Array(16)},le.get(t,e,["propID","keyMatricesTime"]),e.bufferShift=[0,0,0,0],fMe(t,e)}const pMe=le.newInstance(hMe);Ul("vtkActor",pMe);const{CoordinateSystem:tV}=ay;function gMe(t,e){e.classHierarchy.push("vtkWebGPUActor2D"),t.buildPass=n=>{n&&(e.WebGPURenderer=t.getFirstAncestorOfType("vtkWebGPURenderer"),e.WebGPURenderWindow=e.WebGPURenderer.getFirstAncestorOfType("vtkWebGPURenderWindow"),e.propID===void 0&&(e.propID=e.WebGPURenderWindow.getUniquePropID()),t.prepareNodes(),t.addMissingNode(e.renderable.getMapper()),t.removeUnusedNodes())},t.traverseOpaquePass=n=>{!e.renderable||!e.renderable.getNestedVisibility()||!e.renderable.getIsOpaque()||e.WebGPURenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(n,!0),e.children[0]&&e.children[0].traverse(n),t.apply(n,!1))},t.traverseTranslucentPass=n=>{!e.renderable||!e.renderable.getNestedVisibility()||e.renderable.getIsOpaque()||e.WebGPURenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(n,!0),e.children[0]&&e.children[0].traverse(n),t.apply(n,!1))},t.queryPass=(n,r)=>{if(n){if(!e.renderable||!e.renderable.getVisibility())return;e.renderable.getIsOpaque()?r.incrementOpaqueActorCount():r.incrementTranslucentActorCount()}},t.getBufferShift=n=>(t.getKeyMatrices(n),e.bufferShift),t.getKeyMatrices=n=>{if(Math.max(e.renderable.getMTime(),n.getStabilizedTime())>e.keyMatricesTime.getMTime()){e.bufferShift[0]=0,e.bufferShift[1]=0,e.bufferShift[2]=0;const r=n.getStabilizedCenterByReference();e.renderable.getCoordinateSystem()===tV.WORLD&&(e.bufferShift[0]-=r[0],e.bufferShift[1]-=r[1],e.bufferShift[2]-=r[2]),sn(e.keyMatrices.bcwc),sn(e.keyMatrices.normalMatrix),si(e.keyMatrices.bcwc,e.keyMatrices.bcwc,[-e.bufferShift[0],-e.bufferShift[1],-e.bufferShift[2]]),e.renderable.getCoordinateSystem()===tV.WORLD?si(e.keyMatrices.bcsc,e.keyMatrices.bcwc,[-r[0],-r[1],-r[2]]):Ei(e.keyMatrices.bcsc,e.keyMatrices.bcwc),e.keyMatricesTime.modified()}return e.keyMatrices}}const mMe={keyMatricesTime:null,keyMatrices:null,propID:void 0,bufferShift:void 0};function vMe(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,mMe,n),Rr.extend(t,e,n),e.keyMatricesTime={},le.obj(e.keyMatricesTime,{mtime:0}),e.keyMatrices={normalMatrix:new Float64Array(16),bcwc:new Float64Array(16),bcsc:new Float64Array(16)},le.get(t,e,["propID","keyMatricesTime"]),e.bufferShift=[0,0,0,0],gMe(t,e)}const yMe=le.newInstance(vMe);Ul("vtkActor2D",yMe);function xMe(t,e){e.classHierarchy.push("vtkWebGPUCubeAxesActor"),t.buildPass=n=>{n&&(e.WebGPURenderer=t.getFirstAncestorOfType("vtkWebGPURenderer"),e.WebGPURenderWindow=e.WebGPURenderer.getParent(),e.CubeAxesActorHelper.getRenderable()||e.CubeAxesActorHelper.setRenderable(e.renderable),t.prepareNodes(),t.addMissingNode(e.CubeAxesActorHelper.getTmActor()),t.addMissingNode(e.renderable.getGridActor()),t.removeUnusedNodes())},t.opaquePass=(n,r)=>{if(n){const i=e.WebGPURenderer?e.WebGPURenderer.getRenderable().getActiveCamera():null,a=e.WebGPURenderer.getTiledSizeAndOrigin();e.CubeAxesActorHelper.updateAPISpecificData([a.usize,a.vsize],i,e.WebGPURenderWindow.getRenderable())}}}const bMe={};function wMe(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,bMe,n),Rr.extend(t,e,n),e.CubeAxesActorHelper=fZ.newCubeAxesActorHelper(),xMe(t,e)}const CMe=Zn(wMe,"vtkWebGPUCubeAxesActor");Ul("vtkCubeAxesActor",CMe);const{DisplayLocation:H6}=hZ;function SMe(t,e){e.classHierarchy.push("vtkProperty2D"),t.setDisplayLocationToBackground=()=>t.setDisplayLocation(H6.BACKGROUND),t.setDisplayLocationToForeground=()=>t.setDisplayLocation(H6.FOREGROUND),t.setRepresentationToWireframe=()=>t.setRepresentation(so.WIREFRAME),t.setRepresentationToSurface=()=>t.setRepresentation(so.SURFACE),t.setRepresentationToPoints=()=>t.setRepresentation(so.POINTS),t.getRepresentationAsString=()=>le.enumToString(so,e.representation)}const TMe={color:[1,1,1],opacity:1,pointSize:1,lineWidth:1,representation:so.SURFACE,displayLocation:H6.FOREGROUND};function EMe(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,TMe,n),le.obj(t,e),le.setGet(t,e,["opacity","lineWidth","pointSize","displayLocation","representation"]),le.setGetArray(t,e,["color"],3),SMe(t,e)}le.newInstance(EMe,"vtkProperty2D");var _Me={...hZ};const{BufferUsage:ja,PrimitiveTypes:Wo}=km,{Representation:Tx}=up,{ScalarMode:Ex}=gc,{CoordinateSystem:DMe}=ay,{DisplayLocation:OMe}=_Me,MMe=`
//VTK::Renderer::Dec

//VTK::Color::Dec

//VTK::Normal::Dec

//VTK::TCoord::Dec

//VTK::Select::Dec

//VTK::Mapper::Dec

//VTK::IOStructs::Dec

@vertex
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var output : vertexOutput;

  var vertex: vec4<f32> = vertexBC;

  //VTK::Color::Impl

  //VTK::Normal::Impl

  //VTK::TCoord::Impl

  //VTK::Select::Impl

  //VTK::Position::Impl

  return output;
}
`,IMe=`
struct PBRData {
  diffuse: vec3<f32>,
  specular: vec3<f32>,
}

// Dot product with the max already in it
fn mdot(a: vec3<f32>, b: vec3<f32>) -> f32 {
  return max(0.0, dot(a, b));
}
// Dot product with a max in it that does not allow for negative values
// Physically based rendering is accurate as long as normals are accurate,
// however this is pretty often not the case. In order to prevent negative
// values from ruining light calculations and creating zones of zero light,
// this remapping is used, which smoothly clamps the dot product between
// zero and one while still maintaining a good amount of accuracy.
fn cdot(a: vec3<f32>, b: vec3<f32>) -> f32 {
  var d: f32 = max(0.0, dot(a, b));
  d = pow((d + 1.0) / 2.0, 2.6);
  return d;
}

// Lambertian diffuse model
fn lambertDiffuse(base: vec3<f32>, N: vec3<f32>, L: vec3<f32>) -> vec3<f32> {
  var pi: f32 = 3.14159265359; 
  var NdotL: f32 = mdot(N, L);
  NdotL = pow(NdotL, 1.5);
  return (base/pi)*NdotL;
}

// Yasuhiro Fujii improvement on the Oren-Nayar model
// https://mimosa-pudica.net/improved-oren-nayar.html
// p is surface color, o is roughness
fn fujiiOrenNayar(p: vec3<f32>, o: f32, N: vec3<f32>, L: vec3<f32>, V: vec3<f32>) -> vec3<f32> {
  var invpi: f32 = 0.31830988618; // 1/pi

  var o2 = o*o;
  var NdotL: f32 = mdot(N, L);
  NdotL = pow(NdotL, 1.5); // Less physically accurate, but hides the "seams" between lights better

  var NdotV: f32 = mdot(N, V);
  var LdotV: f32 = mdot(L, V);

  var s: f32 = LdotV - NdotL*NdotV;
  var t: f32 = mix(1.0, max(NdotL, NdotV), step(0.0, s)); // Mix with step is the equivalent of an if statement
  var A: vec3<f32> = 0.5*(o2 / (o2 + 0.33)) + 0.17*p*(o2 / (o2 + 0.13));
  A = invpi*(1 - A);
  var B: f32 = 0.45*(o2 / (o2 + 0.09));
  B = invpi*B;

  return p*NdotL*(A + B*(s/t));
}

// Fresnel portion of BRDF (IOR only, simplified)
fn schlickFresnelIOR(V: vec3<f32>, N: vec3<f32>, ior: f32, k: f32) -> f32 {
  var NdotV: f32 = mdot(V, N);
  var F0: f32 = (pow((ior - 1.0), 2.0) + k*k) / (pow((ior + 1.0), 2.0) + k*k); // This takes into account the roughness, which the other one does not
  return F0 + (1.0 - F0) * pow((1.0-NdotV), 5.0);
}

// Fresnel portion of BRDF (Color ior, better)
fn schlickFresnelRGB(V: vec3<f32>, N: vec3<f32>, F0: vec3<f32>) -> vec3<f32> {
  var NdotV: f32 = mdot(V, N);
  return F0 + (1.0 - F0) * pow((1-NdotV), 5.0);
}

// Normal portion of BRDF
// https://learnopengl.com/PBR/Theory
// Trowbridge-Reitz GGX functions: normal, halfway, roughness^2
fn trGGX(N: vec3<f32>, H: vec3<f32>, a: f32) -> f32 {
  var pi: f32 = 3.14159265359; 

  var a2: f32 = a*a;
  var NdotH = mdot(N, H);
  var NdotH2 = NdotH*NdotH;
  
  var denom: f32 = NdotH2 * (a2 - 1.0) + 1.0;

  return a2 / max((pi*denom*denom), 0.000001);
}

// A VERY bad approximation of anisotropy. Real anisotropic calculations require tangent and bitangent
fn anisotrophicTrGGX(N: vec3<f32>, H: vec3<f32>, O: vec3<f32>, s: f32, a: f32) -> f32 {
  var Op: vec3<f32> = (rendererUBO.WCVCNormals * vec4<f32>(normalize(O) * s, 0.)).xyz;

  var ggx1: f32 = trGGX(N + Op*s, H, a);
  var ggx2: f32 = trGGX(N - Op*s, H, a);
  return (0.5 * ggx1 + 0.5 * ggx2);
}

// Geometry portion of BRDF
fn schlickGGX(N: vec3<f32>, X: vec3<f32>, k: f32) -> f32 {
  var NdotX = cdot(N, X);
  return NdotX / max(0.000001, (NdotX*(1.0-k) + k));
}

fn smithSurfaceRoughness(N: vec3<f32>, V: vec3<f32>, L: vec3<f32>, k: f32) -> f32 {
  var ggx1: f32 = min(1.0, schlickGGX(N, V, k));
  var ggx2: f32 = min(1.0, schlickGGX(N, L, k));
  return ggx1*ggx2;
}

// BRDF Combination
fn cookTorrance(D: f32, F: f32, G: f32, N: vec3<f32>, V: vec3<f32>, L: vec3<f32>) -> f32 {
  var num: f32 = D*F*G;
  var denom: f32 = 4*cdot(V, N)*cdot(L, N);

  return num / max(denom, 0.000001);
}

// Different lighting calculations for different light sources
fn calcDirectionalLight(N: vec3<f32>, V: vec3<f32>, ior: f32, roughness: f32, metallic: f32, direction: vec3<f32>, color: vec3<f32>, base: vec3<f32>) -> PBRData {  
  var L: vec3<f32> = normalize(direction); // Light Vector
  var H: vec3<f32> = normalize(L + V); // Halfway Vector

  var alpha = roughness*roughness;
  var k: f32 = alpha*alpha / 2;

  var D: f32 = trGGX(N, H, alpha); // Distribution
  // var F: f32 = schlickFresnelIOR(V, N, ior, k); // Fresnel
  var G: f32 = smithSurfaceRoughness(N, V, L, k); // Geometry

  var brdf: f32 = cookTorrance(D, 1.0, G, N, V, L); // Fresnel term is replaced with 1 because it is added later
  var incoming: vec3<f32> = color;
  var angle: f32 = mdot(L, N);
  angle = pow(angle, 1.5);

  var specular: vec3<f32> = brdf*incoming*angle;
  // Oren-Nayar gives a clay-like effect when fully rough which some people may not want, so it might be better to give a separate
  // control property for the diffuse vs specular roughness
  var diffuse: vec3<f32> = incoming*fujiiOrenNayar(base, roughness, N, L, V); 
  // Stores the specular and diffuse separately to allow for finer post processing
  var out = PBRData(diffuse, specular);
  
  return out; // Returns angle along with color of light so the final color can be multiplied by angle as well (creates black areas)
}

// TODO: find some way to reduce the number of arguments going in here
fn calcPointLight(N: vec3<f32>, V: vec3<f32>, fragPos: vec3<f32>, ior: f32, roughness: f32, metallic: f32, position: vec3<f32>, color: vec3<f32>, base: vec3<f32>) -> PBRData {
  var L: vec3<f32> = normalize(position - fragPos); // Light Vector
  var H: vec3<f32> = normalize(L + V); // Halfway Vector
  var dist = distance(position, fragPos);

  var alpha = roughness*roughness;
  var k: f32 = alpha*alpha / 2.0; // could also be pow(alpha + 1.0, 2) / 8

  var D: f32 = trGGX(N, H, alpha); // Distribution
  // var F: f32 = schlickFresnelIOR(V, N, ior, k); // Fresnel
  var G: f32 = smithSurfaceRoughness(N, V, L, k); // Geometry

  var brdf: f32 = cookTorrance(D, 1.0, G, N, V, L);
  var incoming: vec3<f32> = color * (1.0 / (dist*dist));
  var angle: f32 = mdot(L, N);
  angle = pow(angle, 1.5); // Smoothing factor makes it less accurate, but reduces ugly "seams" bewteen light sources

  var specular: vec3<f32> = brdf*incoming*angle;
  var diffuse: vec3<f32> = incoming*fujiiOrenNayar(base, roughness, N, L, V);

  // Stores the specular and diffuse separately to allow for finer post processing
  // Could also be done (propably more properly) with a struct
  var out = PBRData(diffuse, specular);
  
  return out; // Returns angle along with color of light so the final color can be multiplied by angle as well (creates black areas)
}

// For a reason unknown to me, spheres dont seem to behave propperly with head-on spot lights
fn calcSpotLight(N: vec3<f32>, V: vec3<f32>, fragPos: vec3<f32>, ior: f32, roughness: f32, metallic: f32, position: vec3<f32>, direction: vec3<f32>, cones: vec2<f32>, color: vec3<f32>, base: vec3<f32>) -> PBRData {
  var L: vec3<f32> = normalize(position - fragPos);
  var H: vec3<f32> = normalize(L + V); // Halfway Vector
  var dist = distance(position, fragPos);

  var alpha = roughness*roughness;
  var k: f32 = alpha*alpha / 2.0; // could also be pow(alpha + 1.0, 2) / 8

  var D: f32 = trGGX(N, H, alpha); // Distribution
  // var F: f32 = schlickFresnelIOR(V, N, ior, k); // Fresnel
  var G: f32 = smithSurfaceRoughness(N, V, L, k); // Geometry

  var brdf: f32 = cookTorrance(D, 1.0, G, N, V, L);
  
  // Cones.x is the inner phi and cones.y is the outer phi
  var theta: f32 = mdot(normalize(direction), L);
  var epsilon: f32 = cones.x - cones.y;
  var intensity: f32 = (theta - cones.y) / epsilon;
  intensity = clamp(intensity, 0.0, 1.0);
  intensity /= dist*dist;

  var incoming: vec3<f32> = color * intensity;

  var angle: f32 = mdot(L, N);
  angle = pow(angle, 1.5); // Smoothing factor makes it less accurate, but reduces ugly "seams" bewteen light sources

  var specular: vec3<f32> = brdf*incoming*angle;
  var diffuse: vec3<f32> = incoming*fujiiOrenNayar(base, roughness, N, L, V);

  // Stores the specular and diffuse separately to allow for finer post processing
  // Could also be done (propably more properly) with a struct
  var out = PBRData(diffuse, specular);
  
  return out; // Returns angle along with color of light so the final color can be multiplied by angle as well (creates black areas)
}

// Environment mapping stuff
// Takes in a vector and converts it to an equivalent coordinate in a rectilinear texture. Should be replaced with cubemaps at some point
fn vecToRectCoord(dir: vec3<f32>) -> vec2<f32> {
  var tau: f32 = 6.28318530718;
  var pi: f32 = 3.14159265359;
  var out: vec2<f32> = vec2<f32>(0.0);

  out.x = atan2(dir.z, dir.x) / tau;
  out.x += 0.5;

  var phix: f32 = length(vec2(dir.x, dir.z));
  out.y = atan2(dir.y, phix) / pi + 0.5;

  return out;
}

//VTK::Renderer::Dec

//VTK::Color::Dec

//VTK::TCoord::Dec

// optional surface normal declaration
//VTK::Normal::Dec

//VTK::Select::Dec

//VTK::RenderEncoder::Dec

//VTK::Mapper::Dec

//VTK::IOStructs::Dec

@fragment
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var output : fragmentOutput;

  // Temporary ambient, diffuse, and opacity
  var ambientColor: vec4<f32> = mapperUBO.AmbientColor;
  var diffuseColor: vec4<f32> = mapperUBO.DiffuseColor;
  var opacity: f32 = mapperUBO.Opacity;

  // This should be declared somewhere else
  var _diffuseMap: vec4<f32> = vec4<f32>(1.0);
  var _roughnessMap: vec4<f32> = vec4<f32>(1.0);
  var _metallicMap: vec4<f32> = vec4<f32>(1.0);
  var _normalMap: vec4<f32> = vec4<f32>(0.0, 0.0, 1.0, 0.0); // normal map was setting off the normal vector detection in fragment
  var _ambientOcclusionMap: vec4<f32> = vec4<f32>(1.);
  var _emissionMap: vec4<f32> = vec4<f32>(0.);

  //VTK::Color::Impl

  //VTK::TCoord::Impl

  //VTK::Normal::Impl

  var computedColor: vec4<f32> = vec4<f32>(diffuseColor.rgb, 1.0);

  //VTK::Light::Impl

  //VTK::Select::Impl

  if (computedColor.a == 0.0) { discard; };

  //VTK::Position::Impl

  //VTK::RenderEncoder::Impl

  return output;
}
`;function nV(t){return t.indexOf("edge")>=0}function RMe(t,e){e.classHierarchy.push("vtkWebGPUCellArrayMapper"),t.buildPass=n=>{n&&(e.is2D?(e.WebGPUActor=t.getFirstAncestorOfType("vtkWebGPUActor2D"),e.forceZValue=!0):(e.WebGPUActor=t.getFirstAncestorOfType("vtkWebGPUActor"),e.forceZValue=!1),e.coordinateSystem=e.WebGPUActor.getRenderable().getCoordinateSystem(),e.useRendererMatrix=e.coordinateSystem!==DMe.DISPLAY,e.WebGPURenderer=e.WebGPUActor.getFirstAncestorOfType("vtkWebGPURenderer"),e.WebGPURenderWindow=e.WebGPURenderer.getParent(),e.device=e.WebGPURenderWindow.getDevice())},t.translucentPass=n=>{n&&(t.prepareToDraw(e.WebGPURenderer.getRenderEncoder()),e.renderEncoder.registerDrawCallback(e.pipeline,t.draw))},t.opaquePass=n=>{n&&(t.prepareToDraw(e.WebGPURenderer.getRenderEncoder()),e.renderEncoder.registerDrawCallback(e.pipeline,t.draw))},t.updateUBO=()=>{const r=e.WebGPUActor.getRenderable().getProperty(),i=e.UBO.getSendTime();if(t.getMTime()>i||r.getMTime()>i||e.renderable.getMTime()>i){const a=e.WebGPUActor.getKeyMatrices(e.WebGPURenderer);if(e.UBO.setArray("BCWCMatrix",a.bcwc),e.UBO.setArray("BCSCMatrix",a.bcsc),e.UBO.setArray("MCWCNormals",a.normalMatrix),e.is2D){e.UBO.setValue("ZValue",e.WebGPUActor.getRenderable().getProperty().getDisplayLocation()===OMe.FOREGROUND?1:0);const l=r.getColorByReference();e.UBO.setValue("AmbientIntensity",1),e.UBO.setArray("DiffuseColor",[l[0],l[1],l[2],1]),e.UBO.setValue("DiffuseIntensity",0),e.UBO.setValue("SpecularIntensity",0)}else{let l=r.getAmbientColorByReference();e.UBO.setValue("AmbientIntensity",r.getAmbient()),e.UBO.setArray("AmbientColor",[l[0],l[1],l[2],1]),e.UBO.setValue("DiffuseIntensity",r.getDiffuse()),l=r.getDiffuseColorByReference(),e.UBO.setArray("DiffuseColor",[l[0],l[1],l[2],1]),e.UBO.setValue("Roughness",r.getRoughness()),e.UBO.setValue("BaseIOR",r.getBaseIOR()),e.UBO.setValue("Metallic",r.getMetallic()),e.UBO.setValue("NormalStrength",r.getNormalStrength()),e.UBO.setValue("Emission",r.getEmission()),e.UBO.setValue("SpecularIntensity",r.getSpecular()),l=r.getSpecularColorByReference(),e.UBO.setArray("SpecularColor",[l[0],l[1],l[2],1])}const o=r.getEdgeColorByReference?.();o&&e.UBO.setArray("EdgeColor",[o[0],o[1],o[2],1]),e.UBO.setValue("LineWidth",r.getLineWidth()),e.UBO.setValue("Opacity",r.getOpacity()),e.UBO.setValue("PropID",e.WebGPUActor.getPropID());const s=e.WebGPURenderWindow.getDevice();e.UBO.sendIfNeeded(s)}},t.haveWideLines=()=>{const n=e.WebGPUActor.getRenderable(),r=n.getProperty().getRepresentation();return n.getProperty().getLineWidth()<=1||e.primitiveType===Wo.Verts?!1:e.primitiveType===Wo.Triangles||e.primitiveType===Wo.TriangleStrips?r===Tx.WIREFRAME:!0},t.replaceShaderPosition=(n,r,i)=>{const a=r.getShaderDescription("vertex");a.addBuiltinOutput("vec4<f32>","@builtin(position) Position"),a.hasOutput("vertexVC")||a.addOutput("vec4<f32>","vertexVC");let o=a.getCode();e.useRendererMatrix?(o=_r.substitute(o,"//VTK::Position::Impl",["    var pCoord: vec4<f32> = rendererUBO.SCPCMatrix*mapperUBO.BCSCMatrix*vertexBC;","    output.vertexVC = rendererUBO.SCVCMatrix * mapperUBO.BCSCMatrix * vec4<f32>(vertexBC.xyz, 1.0);","//VTK::Position::Impl"]).result,e.forceZValue&&(o=_r.substitute(o,"//VTK::Position::Impl",["pCoord = vec4<f32>(pCoord.xyz/pCoord.w, 1.0);","pCoord.z = mapperUBO.ZValue;","//VTK::Position::Impl"]).result)):(o=_r.substitute(o,"//VTK::Position::Impl",["    var pCoord: vec4<f32> = mapperUBO.BCSCMatrix*vertexBC;","    pCoord.x = 2.0* pCoord.x / rendererUBO.viewportSize.x - 1.0;","    pCoord.y = 2.0* pCoord.y / rendererUBO.viewportSize.y - 1.0;","    pCoord.z = 0.5 - 0.5 * pCoord.z;","//VTK::Position::Impl"]).result,e.forceZValue&&(o=_r.substitute(o,"//VTK::Position::Impl",["    pCoord.z = mapperUBO.ZValue;","//VTK::Position::Impl"]).result)),t.haveWideLines()&&(a.addBuiltinInput("u32","@builtin(instance_index) instanceIndex"),o=_r.substitute(o,"//VTK::Position::Impl",["    var tmpPos: vec4<f32> = pCoord;","    var numSteps: f32 = ceil(mapperUBO.LineWidth - 1.0);","    var offset: f32 = (mapperUBO.LineWidth - 1.0) * (f32(input.instanceIndex / 2u) - numSteps/2.0) / numSteps;","    var tmpPos2: vec3<f32> = tmpPos.xyz / tmpPos.w;","    tmpPos2.x = tmpPos2.x + 2.0 * (f32(input.instanceIndex) % 2.0) * offset / rendererUBO.viewportSize.x;","    tmpPos2.y = tmpPos2.y + 2.0 * (f32(input.instanceIndex + 1u) % 2.0) * offset / rendererUBO.viewportSize.y;","    tmpPos2.z = min(1.0, tmpPos2.z + 0.00001);","    pCoord = vec4<f32>(tmpPos2.xyz * tmpPos.w, tmpPos.w);","//VTK::Position::Impl"]).result),o=_r.substitute(o,"//VTK::Position::Impl",["    output.Position = pCoord;"]).result,a.setCode(o)},e.shaderReplacements.set("replaceShaderPosition",t.replaceShaderPosition),t.replaceShaderNormal=(n,r,i)=>{const a=i.getBuffer("normalMC"),o=e.WebGPUActor.getRenderable();if(a){const s=r.getShaderDescription("vertex");s.hasOutput("normalVC")||s.addOutput("vec3<f32>","normalVC",a.getArrayInformation()[0].interpolation),s.hasOutput("tangentVC")||s.addOutput("vec3<f32>","tangentVC",a.getArrayInformation()[0].interpolation),s.hasOutput("bitangentVC")||s.addOutput("vec3<f32>","bitangentVC",a.getArrayInformation()[0].interpolation);let l=s.getCode();l=_r.substitute(l,"//VTK::Normal::Impl",["  output.normalVC = normalize((rendererUBO.WCVCNormals * mapperUBO.MCWCNormals * normalMC).xyz);","  var c1: vec3<f32> = cross(output.normalVC, vec3<f32>(0, 0, 1));","  var c2: vec3<f32> = cross(output.normalVC, vec3<f32>(0, 1, 0));","  var tangent: vec3<f32> = mix(c1, c2, distance(c1, c2));","  output.tangentVC = normalize(tangent);","  output.bitangentVC = normalize(cross(output.normalVC, tangent));"]).result,s.setCode(l);const c=r.getShaderDescription("fragment");l=c.getCode(),o.getProperty().getNormalTexture()?l=_r.substitute(l,"//VTK::Normal::Impl",["  var normal: vec3<f32> = input.normalVC;","  if (!input.frontFacing) { normal = -normal; }","  var tangent: vec3<f32> = input.tangentVC;","  var bitangent: vec3<f32> = input.bitangentVC;","  var TCVCMatrix: mat3x3<f32> = mat3x3<f32>(","    tangent.x, bitangent.x, normal.x,","    tangent.y, bitangent.y, normal.y,","    tangent.z, bitangent.z, normal.z,","  );","  var mappedNormal: vec3<f32> = TCVCMatrix * (_normalMap.xyz * 2 - 1);","  normal = mix(normal, mappedNormal, mapperUBO.NormalStrength);","  normal = normalize(normal);"]).result:l=_r.substitute(l,"//VTK::Normal::Impl",["  var normal: vec3<f32> = input.normalVC;","  if (!input.frontFacing) { normal = -normal; }","  normal = normalize(normal);"]).result,c.setCode(l)}},e.shaderReplacements.set("replaceShaderNormal",t.replaceShaderNormal),t.replaceShaderLight=(n,r,i)=>{if(n.includes("sel"))return;const a=r.getShaderDescription("vertex");a.hasOutput("vertexVC")||a.addOutput("vec4<f32>","vertexVC");const o=e.WebGPURenderer.getRenderable(),s=r.getShaderDescription("fragment");let l=s.getCode();if(l.includes("var normal:")&&e.useRendererMatrix&&!nV(n)&&!e.is2D&&!n.includes("sel")){const c=["  var pi: f32 = 3.14159265359;","  var fragPos: vec3<f32> = vec3<f32>(input.vertexVC.xyz);","  var V: vec3<f32> = mix(normalize(-fragPos), vec3<f32>(0, 0, 1), f32(rendererUBO.cameraParallel)); // View Vector","  var baseColor: vec3<f32> = _diffuseMap.rgb * diffuseColor.rgb;","  var roughness: f32 = max(0.000001, mapperUBO.Roughness * _roughnessMap.r);","  var metallic: f32 = mapperUBO.Metallic * _metallicMap.r;","  var alpha: f32 = roughness*roughness;","  var ior: f32 = mapperUBO.BaseIOR;","  var k: f32 = alpha*alpha / 2;","  var diffuse: vec3<f32> = vec3<f32>(0.);","  var specular: vec3<f32> = vec3<f32>(0.);","  var emission: vec3<f32> = _emissionMap.rgb * mapperUBO.Emission;","  {","    var i: i32 = 0;","    loop {","      if !(i < rendererUBO.LightCount) { break; }","      switch (i32(rendererLightSSBO.values[i].LightData.x)) {","         // Point Light","         case 0 {","           var color: vec3<f32> = rendererLightSSBO.values[i].LightColor.rgb * rendererLightSSBO.values[i].LightColor.w;","           var pos: vec3<f32> = (rendererLightSSBO.values[i].LightPos).xyz;","           var calculated: PBRData = calcPointLight(normal, V, fragPos, ior, roughness, metallic, pos, color, baseColor);","           diffuse += max(vec3<f32>(0), calculated.diffuse);","           specular += max(vec3<f32>(0), calculated.specular);","          }","         // Directional light","         case 1 {","           var dir: vec3<f32> = (rendererUBO.WCVCNormals * vec4<f32>(normalize(rendererLightSSBO.values[i].LightDir.xyz), 0.)).xyz;","           dir = normalize(dir);","           var color: vec3<f32> = rendererLightSSBO.values[i].LightColor.rgb * rendererLightSSBO.values[i].LightColor.w;","           var calculated: PBRData = calcDirectionalLight(normal, V, ior, roughness, metallic, dir, color, baseColor); // diffuseColor.rgb needs to be fixed with a more dynamic diffuse color","           diffuse += max(vec3<f32>(0), calculated.diffuse);","           specular += max(vec3<f32>(0), calculated.specular);","         }","         // Spot Light","         case 2 {","           var color: vec3<f32> = rendererLightSSBO.values[i].LightColor.rgb * rendererLightSSBO.values[i].LightColor.w;","           var pos: vec3<f32> = (rendererLightSSBO.values[i].LightPos).xyz;","           var dir: vec3<f32> = (rendererUBO.WCVCNormals * vec4<f32>(normalize(rendererLightSSBO.values[i].LightDir.xyz), 0.)).xyz;","           dir = normalize(dir);","           var cones: vec2<f32> = vec2<f32>(rendererLightSSBO.values[i].LightData.y, rendererLightSSBO.values[i].LightData.z);","           var calculated: PBRData = calcSpotLight(normal, V, fragPos, ior, roughness, metallic, pos, dir, cones, color, baseColor);","           diffuse += max(vec3<f32>(0), calculated.diffuse);","           specular += max(vec3<f32>(0), calculated.specular);","         }","         default { continue; }","       }","      continuing { i++; }","    }","  }","  var fresnel: f32 = schlickFresnelIOR(V, normal, ior, k); // Fresnel","  fresnel = min(1.0, fresnel);","  // This could be controlled with its own variable (that isnt base color) for better artistic control","  var fresnelMetallic: vec3<f32> = schlickFresnelRGB(V, normal, baseColor); // Fresnel for metal, takes color into account","  var kS: vec3<f32> = mix(vec3<f32>(fresnel), fresnelMetallic, metallic);","  kS = min(vec3<f32>(1.0), kS);","  var kD: vec3<f32> = (1.0 - kS) * (1.0 - metallic);","  var PBR: vec3<f32> = mapperUBO.DiffuseIntensity*kD*diffuse + kS*specular;","  PBR += emission;","  computedColor = vec4<f32>(PBR, mapperUBO.Opacity);"];o.getEnvironmentTexture()?.getImageLoaded()&&c.push("  // To get diffuse IBL, the texture is sampled with normals in worldspace","  var diffuseIBLCoords: vec3<f32> = (transpose(rendererUBO.WCVCNormals) * vec4<f32>(normal, 1.)).xyz;","  var diffuseCoords: vec2<f32> = vecToRectCoord(diffuseIBLCoords);","  // To get specular IBL, the texture is sampled as the worldspace reflection between the normal and view vectors","  // Reflections are first calculated in viewspace, then converted to worldspace to sample the environment","  var VreflN: vec3<f32> = normalize(reflect(-V, normal));","  var reflectionIBLCoords = (transpose(rendererUBO.WCVCNormals) * vec4<f32>(VreflN, 1.)).xyz;","  var specularCoords: vec2<f32> = vecToRectCoord(reflectionIBLCoords);","  var diffuseIBL = textureSampleLevel(EnvironmentTexture, EnvironmentTextureSampler, diffuseCoords, rendererUBO.MaxEnvironmentMipLevel);","  var level = roughness * rendererUBO.MaxEnvironmentMipLevel;","  var specularIBL = textureSampleLevel(EnvironmentTexture, EnvironmentTextureSampler, specularCoords, level);","  var specularIBLContribution: vec3<f32> = specularIBL.rgb*rendererUBO.BackgroundSpecularStrength;","  computedColor += vec4<f32>(specularIBLContribution*kS, 0);","  var diffuseIBLContribution: vec3<f32> = diffuseIBL.rgb*rendererUBO.BackgroundDiffuseStrength;","  diffuseIBLContribution *= baseColor * _ambientOcclusionMap.rgb;","  computedColor += vec4<f32>(diffuseIBLContribution*kD, 0);"),l=_r.substitute(l,"//VTK::Light::Impl",c).result,s.setCode(l)}else l=_r.substitute(l,"//VTK::Light::Impl",["  var diffuse: vec3<f32> = diffuseColor.rgb;","  var specular: vec3<f32> = mapperUBO.SpecularColor.rgb * mapperUBO.SpecularColor.a;","  computedColor = vec4<f32>(diffuse * _diffuseMap.rgb, mapperUBO.Opacity);"]).result,s.setCode(l)},e.shaderReplacements.set("replaceShaderLight",t.replaceShaderLight),t.replaceShaderColor=(n,r,i)=>{if(nV(n)){const c=r.getShaderDescription("fragment");let f=c.getCode();f=_r.substitute(f,"//VTK::Color::Impl",["ambientColor = mapperUBO.EdgeColor;","diffuseColor = mapperUBO.EdgeColor;"]).result,c.setCode(f);return}const a=i.getBuffer("colorVI");if(!a)return;const o=r.getShaderDescription("vertex");o.addOutput("vec4<f32>","color",a.getArrayInformation()[0].interpolation);let s=o.getCode();s=_r.substitute(s,"//VTK::Color::Impl",["  output.color = colorVI;"]).result,o.setCode(s);const l=r.getShaderDescription("fragment");s=l.getCode(),s=_r.substitute(s,"//VTK::Color::Impl",["ambientColor = input.color;","diffuseColor = input.color;","opacity = mapperUBO.Opacity * input.color.a;"]).result,l.setCode(s)},e.shaderReplacements.set("replaceShaderColor",t.replaceShaderColor),t.replaceShaderTCoord=(n,r,i)=>{if(!i.hasAttribute("tcoord"))return;const a=r.getShaderDescription("vertex"),o=i.getBuffer("tcoord"),s=ao.getNumberOfComponentsFromBufferFormat(o.getArrayInformation()[0].format);let l=a.getCode();a.addOutput(`vec${s}<f32>`,"tcoordVS"),l=_r.substitute(l,"//VTK::TCoord::Impl",["  output.tcoordVS = tcoord;"]).result,a.setCode(l);const c=r.getShaderDescription("fragment");l=c.getCode();const f=e.WebGPUActor.getRenderable(),u=h=>h?h.getDimensionality()===s:!1,d=[];(f.getProperty().getDiffuseTexture?.()?.getImageLoaded()||f.getTextures()[0]||e.colorTexture)&&(u(f.getProperty().getDiffuseTexture?.())||u(f.getTextures()[0])||u(e.colorTexture))&&d.push("_diffuseMap = textureSample(DiffuseTexture, DiffuseTextureSampler, input.tcoordVS);"),f.getProperty().getRoughnessTexture?.()?.getImageLoaded()&&u(f.getProperty().getRoughnessTexture())&&d.push("_roughnessMap = textureSample(RoughnessTexture, RoughnessTextureSampler, input.tcoordVS);"),f.getProperty().getMetallicTexture?.()?.getImageLoaded()&&u(f.getProperty().getMetallicTexture())&&d.push("_metallicMap = textureSample(MetallicTexture, MetallicTextureSampler, input.tcoordVS);"),f.getProperty().getNormalTexture?.()?.getImageLoaded()&&u(f.getProperty().getNormalTexture())&&d.push("_normalMap = textureSample(NormalTexture, NormalTextureSampler, input.tcoordVS);"),f.getProperty().getAmbientOcclusionTexture?.()?.getImageLoaded()&&u(f.getProperty().getAmbientOcclusionTexture())&&d.push("_ambientOcclusionMap = textureSample(AmbientOcclusionTexture, AmbientOcclusionTextureSampler, input.tcoordVS);"),f.getProperty().getEmissionTexture?.()?.getImageLoaded()&&u(f.getProperty().getEmissionTexture())&&d.push("_emissionMap = textureSample(EmissionTexture, EmissionTextureSampler, input.tcoordVS);"),l=_r.substitute(l,"//VTK::TCoord::Impl",d).result,c.setCode(l)},e.shaderReplacements.set("replaceShaderTCoord",t.replaceShaderTCoord),t.replaceShaderSelect=(n,r,i)=>{if(n.includes("sel")){const a=r.getShaderDescription("fragment");let o=a.getCode();o=_r.substitute(o,"//VTK::Select::Impl",["  var compositeID: u32 = 0u;"]).result,a.setCode(o)}},e.shaderReplacements.set("replaceShaderSelect",t.replaceShaderSelect),t.getUsage=(n,r)=>n===Tx.POINTS||r===Wo.Points?ja.Verts:r===Wo.Lines?ja.Lines:n===Tx.WIREFRAME?r===Wo.Triangles?ja.LinesFromTriangles:ja.LinesFromStrips:r===Wo.Triangles?ja.Triangles:r===Wo.TriangleStrips?ja.Strips:r===Wo.TriangleEdges?ja.LinesFromTriangles:ja.LinesFromStrips,t.getHashFromUsage=n=>`pt${n}`,t.getTopologyFromUsage=n=>{switch(n){case ja.Triangles:return"triangle-list";case ja.Verts:return"point-list";case ja.Lines:default:return"line-list"}},t.buildVertexInput=()=>{const n=e.currentInput,r=e.cellArray,i=e.primitiveType;let o=e.WebGPUActor.getRenderable().getProperty().getRepresentation();const s=e.WebGPURenderWindow.getDevice();let l=!1;i===Wo.TriangleEdges&&(l=!0,o=Tx.WIREFRAME);const c=e.vertexInput,f=n.getPoints();let u;if(r){const g={hash:`R${o}P${i}${r.getMTime()}`,usage:ja.Index,cells:r,numberOfPoints:f.getNumberOfPoints(),primitiveType:i,representation:o};u=s.getBufferManager().getBuffer(g),c.setIndexBuffer(u)}else c.setIndexBuffer(null);if(f){const g=e.WebGPUActor.getBufferShift(e.WebGPURenderer),m={hash:`${f.getMTime()}I${u.getMTime()}${g.join()}float32x4`,usage:ja.PointArray,format:"float32x4",dataArray:f,indexBuffer:u,shift:g,packExtra:!0},y=s.getBufferManager().getBuffer(m);c.addBuffer(y,["vertexBC"])}else c.removeBufferIfPresent("vertexBC");const d=t.getUsage(o,i);if(e._usesCellNormals=!1,!e.is2D&&(d===ja.Triangles||d===ja.Strips)){const g=n.getPointData().getNormals(),m={format:"snorm8x4",indexBuffer:u,packExtra:!0,shift:0,scale:127};if(g){m.hash=`${g.getMTime()}I${u.getMTime()}snorm8x4`,m.dataArray=g,m.usage=ja.PointArray;const y=s.getBufferManager().getBuffer(m);c.addBuffer(y,["normalMC"])}else if(i===Wo.Triangles){e._usesCellNormals=!0,m.hash=`PFN${f.getMTime()}I${u.getMTime()}snorm8x4`,m.dataArray=f,m.cells=r,m.usage=ja.NormalsFromPoints;const y=s.getBufferManager().getBuffer(m);c.addBuffer(y,["normalMC"])}else c.removeBufferIfPresent("normalMC")}else c.removeBufferIfPresent("normalMC");let h=!1;if(e.renderable.getScalarVisibility()){const g=e.renderable.getColorMapColors();if(g&&!l){const m=e.renderable.getScalarMode();let y=!1;(m===Ex.USE_CELL_DATA||m===Ex.USE_CELL_FIELD_DATA||m===Ex.USE_FIELD_DATA||!n.getPointData().getScalars())&&m!==Ex.USE_POINT_FIELD_DATA&&g&&(y=!0);const v={usage:ja.PointArray,format:"unorm8x4",hash:`${y}${g.getMTime()}I${u.getMTime()}unorm8x4`,dataArray:g,indexBuffer:u,cellData:y,cellOffset:0},x=s.getBufferManager().getBuffer(v);c.addBuffer(x,["colorVI"]),h=!0}}h||c.removeBufferIfPresent("colorVI");let p=null;if(e.renderable.getInterpolateScalarsBeforeMapping?.()&&e.renderable.getColorCoordinates()?p=e.renderable.getColorCoordinates():p=n.getPointData().getTCoords(),p&&!l){const g=s.getBufferManager().getBufferForPointArray(p,c.getIndexBuffer());c.addBuffer(g,["tcoord"])}else c.removeBufferIfPresent("tcoord")},t.updateTextures=()=>{const n=[],r=[],i=e.renderable.getColorTextureMap?.();i&&(e.colorTexture||(e.colorTexture=zm.newInstance({label:"polyDataColor"})),e.colorTexture.setInputData(i),r.push(["Diffuse",e.colorTexture]));const a=e.WebGPUActor.getRenderable(),o=e.WebGPURenderer.getRenderable(),s=[];if(a.getProperty().getDiffuseTexture?.()){const l=["Diffuse",a.getProperty().getDiffuseTexture()];s.push(l)}if(a.getTextures()[0]){const l=["Diffuse",a.getTextures()[0]];s.push(l)}if(e.colorTexture){const l=["Diffuse",e.colorTexture];s.push(l)}if(a.getProperty().getRoughnessTexture?.()){const l=["Roughness",a.getProperty().getRoughnessTexture()];s.push(l)}if(a.getProperty().getMetallicTexture?.()){const l=["Metallic",a.getProperty().getMetallicTexture()];s.push(l)}if(a.getProperty().getNormalTexture?.()){const l=["Normal",a.getProperty().getNormalTexture()];s.push(l)}if(a.getProperty().getAmbientOcclusionTexture?.()){const l=["AmbientOcclusion",a.getProperty().getAmbientOcclusionTexture()];s.push(l)}if(a.getProperty().getEmissionTexture?.()){const l=["Emission",a.getProperty().getEmissionTexture()];s.push(l)}if(o.getEnvironmentTexture?.()){const l=["Environment",o.getEnvironmentTexture()];s.push(l)}for(let l=0;l<s.length;l++)(s[l][1].getInputData()||s[l][1].getJsImageData()||s[l][1].getCanvas())&&r.push(s[l]),s[l][1].getImage()&&s[l][1].getImageLoaded()&&r.push(s[l]);for(let l=0;l<r.length;l++){const c=r[l][1],f=r[l][0],u=e.device.getTextureManager().getTextureForVTKTexture(c);if(u.getReady()){let d=!1;for(let h=0;h<e.textures.length;h++)e.textures[h]===u&&(d=!0,n[h]=!0);if(!d){n[e.textures.length]=!0;const h=u.createView(`${f}Texture`);e.textures.push(u),e.textureViews.push(h);const p=c.getInterpolate()?"linear":"nearest";let g=null;!g&&c.getEdgeClamp()&&c.getRepeat()&&(g="mirror-repeat"),!g&&c.getEdgeClamp()&&(g="clamp-to-edge"),!g&&c.getRepeat()&&(g="repeat"),f!=="Environment"?h.addSampler(e.device,{addressModeU:g,addressModeV:g,addressModeW:g,minFilter:p,magFilter:p}):h.addSampler(e.device,{addressModeU:"repeat",addressModeV:"clamp-to-edge",addressModeW:"repeat",minFilter:p,magFilter:p,mipmapFilter:"linear"})}}}for(let l=e.textures.length-1;l>=0;l--)n[l]||(e.textures.splice(l,1),e.textureViews.splice(l,1))},t.computePipelineHash=()=>{let n=`pd${e.useRendererMatrix?"r":""}${e.forceZValue?"z":""}`;if(e.primitiveType===Wo.TriangleEdges||e.primitiveType===Wo.TriangleStripEdges)n+="edge";else{if(e.vertexInput.hasAttribute("normalMC")&&(n+="n"),e.vertexInput.hasAttribute("colorVI")&&(n+="c"),e.vertexInput.hasAttribute("tcoord")){const i=e.vertexInput.getBuffer("tcoord"),a=ao.getNumberOfComponentsFromBufferFormat(i.getArrayInformation()[0].format);n+=`t${a}`}e.textures.length&&(n+=`tx${e.textures.length}`)}e._usesCellNormals&&(n+="cn"),e.SSBO&&(n+="ssbo");const r=t.getHashFromUsage(e.usage);n+=r,n+=e.renderEncoder.getPipelineHash(),e.pipelineHash=n},t.updateBuffers=()=>{e.primitiveType!==Wo.TriangleEdges&&e.primitiveType!==Wo.TriangleStripEdges&&t.updateTextures();const n=e.WebGPUActor.getRenderable(),r=n.getProperty().getRepresentation();e.usage=t.getUsage(r,e.primitiveType),t.buildVertexInput();const i=e.vertexInput.getBuffer("vertexBC");if(t.setNumberOfVertices(i.getSizeInBytes()/i.getStrideInBytes()),t.setTopology(t.getTopologyFromUsage(e.usage)),t.updateUBO(),t.haveWideLines()){const a=n.getProperty();t.setNumberOfInstances(Math.ceil(a.getLineWidth()*2))}else t.setNumberOfInstances(1)}}const AMe={is2D:!1,cellArray:null,currentInput:null,cellOffset:0,primitiveType:0,colorTexture:null,renderEncoder:null,textures:null};function yZ(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,AMe,n),vX.extend(t,e,n),e.fragmentShaderTemplate=IMe,e.vertexShaderTemplate=MMe,e._tmpMat3=Ll(new Float64Array(9)),e._tmpMat4=sn(new Float64Array(16)),e.UBO=Wg.newInstance({label:"mapperUBO"}),e.UBO.addEntry("BCWCMatrix","mat4x4<f32>"),e.UBO.addEntry("BCSCMatrix","mat4x4<f32>"),e.UBO.addEntry("MCWCNormals","mat4x4<f32>"),e.UBO.addEntry("AmbientColor","vec4<f32>"),e.UBO.addEntry("DiffuseColor","vec4<f32>"),e.UBO.addEntry("EdgeColor","vec4<f32>"),e.UBO.addEntry("SpecularColor","vec4<f32>"),e.UBO.addEntry("AmbientIntensity","f32"),e.UBO.addEntry("DiffuseIntensity","f32"),e.UBO.addEntry("Roughness","f32"),e.UBO.addEntry("Metallic","f32"),e.UBO.addEntry("Ambient","f32"),e.UBO.addEntry("Normal","f32"),e.UBO.addEntry("Emission","f32"),e.UBO.addEntry("NormalStrength","f32"),e.UBO.addEntry("BaseIOR","f32"),e.UBO.addEntry("SpecularIntensity","f32"),e.UBO.addEntry("LineWidth","f32"),e.UBO.addEntry("Opacity","f32"),e.UBO.addEntry("ZValue","f32"),e.UBO.addEntry("PropID","u32"),e.UBO.addEntry("ClipNear","f32"),e.UBO.addEntry("ClipFar","f32"),e.UBO.addEntry("Time","u32"),Mi(t,e,["cellArray","currentInput","cellOffset","is2D","primitiveType","renderEncoder"]),e.textures=[],RMe(t,e)}const PMe=Zn(yZ,"vtkWebGPUCellArrayMapper");var xZ={newInstance:PMe,extend:yZ};const{PrimitiveTypes:_x}=km;function NMe(t,e){e.classHierarchy.push("vtkWebGPUPolyDataMapper"),t.createCellArrayMapper=()=>xZ.newInstance(),t.buildPass=n=>{if(n){e.WebGPUActor=t.getFirstAncestorOfType("vtkWebGPUActor"),e.renderable.getStatic()||e.renderable.update();const r=e.renderable.getInputData();e.renderable.mapScalars(r,1),t.updateCellArrayMappers(r)}},t.updateCellArrayMappers=n=>{const r=[n.getVerts(),n.getLines(),n.getPolys(),n.getStrips()],i=[];let a=0;for(let o=_x.Points;o<=_x.Triangles;o++)if(r[o].getNumberOfValues()>0){e.primitives[o]||(e.primitives[o]=t.createCellArrayMapper());const s=e.primitives[o];s.setCellArray(r[o]),s.setCurrentInput(n),s.setCellOffset(a),s.setPrimitiveType(o),s.setRenderable(e.renderable),a+=r[o].getNumberOfCells(),i.push(s)}else e.primitives[o]=null;if(e.WebGPUActor.getRenderable().getProperty().getEdgeVisibility())for(let o=_x.TriangleEdges;o<=_x.TriangleStripEdges;o++)if(r[o-2].getNumberOfValues()>0){e.primitives[o]||(e.primitives[o]=t.createCellArrayMapper());const s=e.primitives[o];s.setCellArray(r[o-2]),s.setCurrentInput(n),s.setCellOffset(e.primitives[o-2].getCellOffset()),s.setPrimitiveType(o),s.setRenderable(e.renderable),i.push(s)}else e.primitives[o]=null;t.prepareNodes(),t.addMissingChildren(i),t.removeUnusedNodes()}}const LMe={primitives:null};function kMe(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,LMe,n),Rr.extend(t,e,n),e.primitives=[],NMe(t,e)}const VMe=Zn(kMe,"vtkWebGPUPolyDataMapper");Ul("vtkMapper",VMe);const{PrimitiveTypes:rV}=km;function FMe(t,e){e.classHierarchy.push("vtkWebGPUPolyDataMapper2D"),t.createCellArrayMapper=()=>xZ.newInstance(),t.buildPass=n=>{if(n){e.WebGPUActor=t.getFirstAncestorOfType("vtkWebGPUActor2D"),e.renderable.getStatic()||e.renderable.update();const r=e.renderable.getInputData();e.renderable.mapScalars(r,1),t.updateCellArrayMappers(r)}},t.updateCellArrayMappers=n=>{const r=[n.getVerts(),n.getLines(),n.getPolys(),n.getStrips()],i=[];let a=0;for(let o=rV.Points;o<=rV.Triangles;o++)if(r[o].getNumberOfValues()>0){e.primitives[o]||(e.primitives[o]=t.createCellArrayMapper());const s=e.primitives[o];s.setCellArray(r[o]),s.setCurrentInput(n),s.setCellOffset(a),s.setPrimitiveType(o),s.setRenderable(e.renderable),s.setIs2D(!0),a+=r[o].getNumberOfCells(),i.push(s)}else e.primitives[o]=null;t.prepareNodes(),t.addMissingChildren(i),t.removeUnusedNodes()}}function UMe(t){return{primitives:[],...t}}function BMe(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,UMe(n)),Rr.extend(t,e,n),e.primitives=[],FMe(t,e)}const $Me=Zn(BMe,"vtkWebGPUPolyDataMapper2D");Ul("vtkMapper2D",$Me);function GMe(t,e){e.classHierarchy.push("vtkWebGPUScalarBarActor"),t.buildPass=n=>{n&&(e.WebGPURenderer=t.getFirstAncestorOfType("vtkWebGPURenderer"),e.WebGPURenderWindow=e.WebGPURenderer.getParent(),e.scalarBarActorHelper.getRenderable()||e.scalarBarActorHelper.setRenderable(e.renderable),t.prepareNodes(),t.addMissingNode(e.scalarBarActorHelper.getBarActor()),t.addMissingNode(e.scalarBarActorHelper.getTmActor()),t.removeUnusedNodes())},t.opaquePass=(n,r)=>{if(n){const i=e.WebGPURenderer?e.WebGPURenderer.getRenderable().getActiveCamera():null,a=e.WebGPURenderer.getTiledSizeAndOrigin();e.scalarBarActorHelper.updateAPISpecificData([a.usize,a.vsize],i,e.WebGPURenderWindow.getRenderable())}}}const jMe={};function zMe(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,jMe,n),Rr.extend(t,e,n),e.scalarBarActorHelper=vZ.newScalarBarActorHelper(),GMe(t,e)}const WMe=Zn(zMe,"vtkWebGPUScalarBarActor");Ul("vtkScalarBarActor",WMe);function HMe(t,e){e.classHierarchy.push("vtkWebGPUTextureView"),t.create=(n,r)=>{e.texture=n,e.options=r,e.options.dimension=e.options.dimension||"2d",e.options.label=e.label,e.textureHandle=n.getHandle(),e.handle=e.textureHandle.createView(e.options),e.bindGroupLayoutEntry.texture.viewDimension=e.options.dimension;const i=ao.getDetailsFromTextureFormat(e.texture.getFormat());e.bindGroupLayoutEntry.texture.sampleType=i.sampleType},t.createFromTextureHandle=(n,r)=>{e.texture=null,e.options=r,e.options.dimension=e.options.dimension||"2d",e.options.label=e.label,e.textureHandle=n,e.handle=e.textureHandle.createView(e.options),e.bindGroupLayoutEntry.texture.viewDimension=e.options.dimension;const i=ao.getDetailsFromTextureFormat(r.format);e.bindGroupLayoutEntry.texture.sampleType=i.sampleType,e.bindGroupTime.modified()},t.getBindGroupEntry=()=>({resource:t.getHandle()}),t.getShaderCode=(n,r)=>{let i="f32";e.bindGroupLayoutEntry.texture.sampleType==="sint"?i="i32":e.bindGroupLayoutEntry.texture.sampleType==="uint"&&(i="u32");let a=`@binding(${n}) @group(${r}) var ${e.label}: texture_${e.options.dimension}<${i}>;`;return e.bindGroupLayoutEntry.texture.sampleType==="depth"&&(a=`@binding(${n}) @group(${r}) var ${e.label}: texture_depth_${e.options.dimension};`),a},t.addSampler=(n,r)=>{const i=EX.newInstance({label:`${e.label}Sampler`});i.create(n,r),t.setSampler(i)},t.getBindGroupTime=()=>(e.texture&&e.texture.getHandle()!==e.textureHandle&&(e.textureHandle=e.texture.getHandle(),e.handle=e.textureHandle.createView(e.options),e.bindGroupTime.modified()),e.bindGroupTime),t.getHandle=()=>(e.texture&&e.texture.getHandle()!==e.textureHandle&&(e.textureHandle=e.texture.getHandle(),e.handle=e.textureHandle.createView(e.options),e.bindGroupTime.modified()),e.handle)}const KMe={texture:null,handle:null,sampler:null,label:null};function bZ(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,KMe,n),le.obj(t,e),e.bindGroupLayoutEntry={visibility:GPUShaderStage.VERTEX|GPUShaderStage.FRAGMENT,texture:{sampleType:"float",viewDimension:"2d"}},e.bindGroupTime={},le.obj(e.bindGroupTime,{mtime:0}),le.get(t,e,["bindGroupTime","texture"]),le.setGet(t,e,["bindGroupLayoutEntry","label","sampler"]),HMe(t,e)}const qMe=le.newInstance(bZ);var XMe={newInstance:qMe,extend:bZ};const{BufferUsage:iV}=km;function YMe(t,e){e.classHierarchy.push("vtkWebGPUTexture"),t.create=(n,r)=>{e.device=n,e.width=r.width,e.height=r.height,e.depth=r.depth?r.depth:1;const i=e.depth===1?"2d":"3d";e.format=r.format?r.format:"rgba8unorm",e.mipLevel=r.mipLevel?r.mipLevel:0,e.usage=r.usage?r.usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST,e.handle=e.device.getHandle().createTexture({size:[e.width,e.height,e.depth],format:e.format,usage:e.usage,label:e.label,dimension:i,mipLevelCount:e.mipLevel+1})},t.assignFromHandle=(n,r,i)=>{e.device=n,e.handle=r,e.width=i.width,e.height=i.height,e.depth=i.depth?i.depth:1,e.format=i.format?i.format:"rgba8unorm",e.usage=i.usage?i.usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST},t.writeImageData=n=>{let r=[];if(n.canvas){e.device.getHandle().queue.copyExternalImageToTexture({source:n.canvas,flipY:n.flip},{texture:e.handle,premultipliedAlpha:!0},[e.width,e.height,e.depth]),e.ready=!0;return}n.jsImageData&&!n.nativeArray&&(n.width=n.jsImageData.width,n.height=n.jsImageData.height,n.depth=1,n.format="rgba8unorm",n.flip=!0,n.nativeArray=n.jsImageData.data);const i=ao.getDetailsFromTextureFormat(e.format);let a=e.width*i.stride;const o=(l,c,f)=>{const u=l.length/(c*f)*l.BYTES_PER_ELEMENT,d=i.elementSize===2&&i.sampleType==="float";if(d||u%256){const h=l,p=u/h.BYTES_PER_ELEMENT,g=i.elementSize,m=256*Math.floor((p*g+255)/256),y=m/g,v=le.newTypedArray(d?"Uint16Array":h.constructor.name,y*c*f);for(let x=0;x<c*f;x++)if(d)for(let w=0;w<p;w++)v[x*y+w]=mh.toHalf(h[x*p+w]);else v.set(h.subarray(x*p,(x+1)*p),x*y);return[v,m]}return[l,u]};if(n.nativeArray&&(r=n.nativeArray),n.image){const l=document.createElement("canvas");l.width=n.image.width,l.height=n.image.height;const c=l.getContext("2d");c.translate(0,l.height),c.scale(1,-1),c.drawImage(n.image,0,0,n.image.width,n.image.height,0,0,l.width,l.height),r=c.getImageData(0,0,n.image.width,n.image.height).data}const s=e.device.createCommandEncoder();if(t.getDimensionality()!==3){const l=zm.generateMipmaps(r,e.width,e.height,e.mipLevel);let c=e.width,f=e.height;for(let u=0;u<=e.mipLevel;u++){const d=o(l[u],f,1);a=d[1];const h={dataArray:n.dataArray?n.dataArray:null,nativeArray:d[0],usage:iV.Texture},p=e.device.getBufferManager().getBuffer(h);s.copyBufferToTexture({buffer:p.getHandle(),offset:0,bytesPerRow:a,rowsPerImage:f},{texture:e.handle,mipLevel:u},[c,f,1]),c/=2,f/=2}e.device.submitCommandEncoder(s),e.ready=!0}else{const l=o(r,e.height,e.depth);a=l[1];const c={dataArray:n.dataArray?n.dataArray:null,usage:iV.Texture};c.nativeArray=l[0];const f=e.device.getBufferManager().getBuffer(c);s.copyBufferToTexture({buffer:f.getHandle(),offset:0,bytesPerRow:a,rowsPerImage:e.height},{texture:e.handle},[e.width,e.height,e.depth]),e.device.submitCommandEncoder(s),e.ready=!0}},t.getScale=()=>{const n=ao.getDetailsFromTextureFormat(e.format);return n.elementSize===2&&n.sampleType==="float"?1:255},t.getNumberOfComponents=()=>ao.getDetailsFromTextureFormat(e.format).numComponents,t.getDimensionality=()=>{let n=0;return e.width>1&&n++,e.height>1&&n++,e.depth>1&&n++,n},t.resizeToMatch=n=>{(n.getWidth()!==e.width||n.getHeight()!==e.height||n.getDepth()!==e.depth)&&(e.width=n.getWidth(),e.height=n.getHeight(),e.depth=n.getDepth(),e.handle=e.device.getHandle().createTexture({size:[e.width,e.height,e.depth],format:e.format,usage:e.usage,label:e.label}))},t.resize=function(n,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;(n!==e.width||r!==e.height||i!==e.depth)&&(e.width=n,e.height=r,e.depth=i,e.handle=e.device.getHandle().createTexture({size:[e.width,e.height,e.depth],format:e.format,usage:e.usage,label:e.label}))},t.createView=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};r.dimension||(r.dimension=e.depth===1?"2d":"3d");const i=XMe.newInstance({label:n});return i.create(t,r),i}}const JMe={device:null,handle:null,buffer:null,ready:!1,label:null};function ZMe(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,JMe,n),le.obj(t,e),le.get(t,e,["handle","ready","width","height","depth","format","usage"]),le.setGet(t,e,["device","label"]),YMe(t,e)}le.newInstance(ZMe);function QMe(t){if(!t||t.data.length===0)throw new Error("Invalid contour set data, see publicContourSetData type for more info");if(!t.id)throw new Error("Invalid contour set data, each contour set must have an id");if(!t.data||!Array.isArray(t.data))throw new Error("Invalid contour set data, each contour set must have an array of contours");t.data.forEach(e=>{if(!e.points||!Array.isArray(e.points))throw new Error("Invalid contour set data, each contour must have an array of points");e.points.forEach(n=>{if(!n||!Array.isArray(n)||n.length!==3)throw new Error("Invalid contour set data, each point must be an array of length 3")})})}class aV{constructor(e){const{points:n,type:r}=e.data;this.id=e.id,this._points=n,this._type=r,this._color=e.color,this._segmentIndex=e.segmentIndex,this.sizeInBytes=this._getSizeInBytes()}_getSizeInBytes(){return this._points.length*3}get points(){return this._points}set points(e){this._points=e}get color(){return this._color}set color(e){this._color=e}get type(){return this._type}set type(e){this._type=e}get segmentIndex(){return this._segmentIndex}set segmentIndex(e){this._segmentIndex=e}get flatPointsArray(){return this._points.map(e=>[...e]).flat()}}class eIe{constructor(e){this._color=[200,0,0],this.id=e.id,this._contours=[],this._color=e.color??this._color,this.frameOfReferenceUID=e.frameOfReferenceUID,this._segmentIndex=e.segmentIndex,this._createEachContour(e.data),this.sizeInBytes=this._getSizeInBytes()}_createEachContour(e){e.forEach(n=>{const{points:r,type:i,color:a}=n,o=new aV({id:`${this.id}-segment-${this._segmentIndex}`,data:{points:r,type:i,segmentIndex:this._segmentIndex,color:a??this._color},segmentIndex:this._segmentIndex,color:a??this._color});this._contours.push(o)}),this._updateContourSetCentroid()}_updateContourSetCentroid(){const e=this.totalNumberOfPoints,n=this.flatPointsArray,r=n.reduce((o,s)=>[o[0]+s[0],o[1]+s[1],o[2]+s[2]],[0,0,0]),i=[r[0]/e,r[1]/e,r[2]/e],a=n.reduce((o,s)=>{const l=this._getDistance(i,s),c=this._getDistance(i,o);return l<c?s:o},n[0]);this._centroid=a}_getSizeInBytes(){return this._contours.reduce((e,n)=>e+n.sizeInBytes,0)}_getDistance(e,n){return Math.sqrt((e[0]-n[0])**2+(e[1]-n[1])**2+(e[2]-n[2])**2)}get centroid(){return this._centroid}get segmentIndex(){return this._segmentIndex}get color(){return this._color}set color(e){this._color=e,this._contours.forEach(n=>{n instanceof aV&&(n.color=e)})}get contours(){return this._contours}get flatPointsArray(){return this._contours.flatMap(e=>e.points)}get numberOfContours(){return this._contours.length}get totalNumberOfPoints(){return this._contours.reduce((e,n)=>e+n.points.length,0)}get numberOfPointsArray(){return this._contours.map(e=>e.points.length)}getPointsInContour(e){return this._contours[e].points}getNumberOfPointsInAContour(e){return this.getPointsInContour(e).length}}function tIe(t,e){QMe(e);const n=new eIe({id:e.id,data:e.data,color:e.color,frameOfReferenceUID:e.frameOfReferenceUID,segmentIndex:e.segmentIndex??1});return{id:t,type:ou.CONTOUR,data:n,sizeInBytes:n.sizeInBytes}}function nIe(t){if(!t.id)throw new Error("Surface must have an id");if(t.points?.length===0)throw new Error("Surface must have non-empty points array");if(t.polys?.length===0)throw new Error("Surface must have non-empty polys array");if(!t.frameOfReferenceUID)throw new Error("Surface must have a frameOfReferenceUID")}function rIe(t,e){nIe(e);const n=new vJ({id:e.id,points:e.points,polys:e.polys,color:e.color,frameOfReferenceUID:e.frameOfReferenceUID,segmentIndex:e.segmentIndex??1});return{id:t,type:ou.SURFACE,data:n,sizeInBytes:n.sizeInBytes}}function iIe(t){if(!t.id)throw new Error("Mesh must have an id");if(!t.arrayBuffer)throw new Error("Mesh must have an arrayBuffer");if(!(t.format in qs))throw new Error(`Mesh format must be one of the following: ${Object.values(qs).join(", ")}`)}function aIe(t,e){e.classHierarchy.push("vtkMTLReader");function n(){e.requestCount--,e.requestCount===0&&t.invokeBusy(!1)}function r(a){if(a[0]==="#"||a.length===0)return;const o=a.split(/[ \t]+/).map(s=>s.trim()).filter(s=>s.length);if(o[0]==="newmtl")o.shift(),e.currentMaterial=o.join(" ").trim();else if(e.currentMaterial){if(o.length<2)return;if(e.materials[e.currentMaterial]||(e.materials[e.currentMaterial]={}),e.materials[e.currentMaterial][o[0]]=o.slice(1),o[0]==="map_Kd"){const s=new Image;s.onload=()=>setTimeout(n,0),s.src=[e.baseURL,o[1]].join("/"),e.materials[e.currentMaterial].image=s,e.requestCount++}}}e.dataAccessHelper||(e.dataAccessHelper=uy.get("http"));function i(a,o){return e.dataAccessHelper.fetchText(t,a,o)}t.setUrl=function(a){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(a.indexOf(".mtl")===-1&&!o.fullpath)e.baseURL=a,e.url=`${a}/index.mtl`;else{e.url=a;const s=a.split("/");s.pop(),e.baseURL=s.join("/")}return t.loadData(o)},t.loadData=a=>new Promise((o,s)=>{i(e.url,a).then(l=>{t.parseAsText(l),o()},l=>{s()})}),t.parseAsText=a=>{t.modified(),e.materials={},a.split(`
`).forEach(r)},t.isBusy=()=>!!e.requestCount,t.getMaterialNames=()=>Object.keys(e.materials),t.getMaterial=a=>e.materials[a],t.listImages=()=>Object.keys(e.materials).map(a=>e.materials[a].map_Kd).filter(a=>!!a).map(a=>a[0].trim()),t.setImageSrc=(a,o)=>new Promise((s,l)=>{const c=Object.keys(e.materials).find(u=>e.materials[u].map_Kd&&e.materials[u].map_Kd[0].trim()===a.trim()),f=e.materials[c];f&&f.image?(f.image.src=o,f.image.onload=()=>setTimeout(s,0)):s()}),t.applyMaterialToActor=(a,o)=>{const s=e.materials[a];if(s&&o){const l=[1,1,1],c={ambientColor:s.Ka?s.Ka.map(u=>Number(u)):l,specularColor:s.Ks?s.Ks.map(u=>Number(u)):l,diffuseColor:s.Kd?s.Kd.map(u=>Number(u)):l,opacity:s.d?Number(s.d):1,specularPower:s.Ns?Number(s.Ns):1},f=Number(s.illum||2);if(["ambient","diffuse","specular"].forEach((u,d)=>{c[u]=d<=f?1:0}),s.image){const u=zm.newInstance({interpolate:e.interpolateTextures});u.setImage(s.image),o.addTexture(u)}o.getProperty().set(c)}}}const oIe={numberOfOutputs:1,requestCount:0,materials:{},interpolateTextures:!0};function wZ(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,oIe,n),$r(t,e),Po(t,e,["url","baseURL"]),Mi(t,e,["dataAccessHelper","interpolateTextures","splitGroup"]),D9(t,e,"busy"),aIe(t,e)}const sIe=Zn(wZ,"vtkMTLReader");var lIe={newInstance:sIe,extend:wZ};function CZ(t,e){iIe(e);const n=new yDe({...e}),r={id:t,type:ou.MESH,data:n,sizeInBytes:n.sizeInBytes};switch(e.format){case qs.PLY:if(e.materialUrl){const i=new Image;return new Promise((a,o)=>{i.onload=()=>{try{const s=zm.newInstance();s.setInterpolate(!0),s.setImage(i),n.defaultActor.addTexture(s),a(r)}catch(s){o(s)}},i.onerror=s=>o(s),i.src=e.materialUrl})}return Promise.resolve(r);case qs.OBJ:if(e.materialUrl){const i=lIe.newInstance();return i.setUrl(e.materialUrl).then(()=>{for(let a=0;a<n.actors.length;a++){const o=n.actors[a],s=o.getMapper();if(s){const l=s.getInputData();if(l){const c=l.get("name").name;i.applyMaterialToActor(c,o)}}}return r}).catch(a=>{throw new Error(`Failed to load material: ${a}`)})}return Promise.resolve(r);case qs.STL:case qs.VTP:return Promise.resolve(r);default:return Promise.reject(new Error(`Unsupported format: ${e.format}`))}}function cIe({url:t,signal:e,onload:n,loaderOptions:r}){return new Promise((i,a)=>{const o=new XMLHttpRequest;o.open("GET",t,!0);const s={},l=r.beforeSend(o,s),c=Object.assign({},s,l);o.responseType="arraybuffer",Object.keys(c).forEach(function(h){c[h]!==null&&o.setRequestHeader(h,c[h])});const f=function(h){n&&typeof n=="function"&&n(),e&&e.removeEventListener("abort",u),i(o.response)},u=()=>{o.abort(),o.removeEventListener("load",f),a(new Error("Request aborted"))};o.addEventListener("load",f);const d=(h,p)=>{const g={url:t,loaded:h,total:p};Ct(St,vt.GEOMETRY_LOAD_PROGRESS,{data:g})};o.onprogress=function(h){d(h.loaded,h.total)},e&&e.aborted?(o.abort(),a(new Error("Request aborted"))):e&&e.addEventListener("abort",u),o.send()})}function SZ(t,e,n){return{promise:new Promise((i,a)=>{uIe(t,e,n).then(i).catch(a)}),cancelFn:void 0,decache:()=>{}}}async function uIe(t,e,n){const i=t.split(":").slice(1).join(":"),a=await cIe({url:i,loaderOptions:n});if(!e||!("geometryData"in e))throw new Error("Mesh must have a geometryData");return CZ(i,{...e.geometryData,arrayBuffer:a})}let G3={beforeSend(t){}};function fIe(t){G3=Object.assign(G3,t)}function dIe(){return G3}const TZ={};let Bv;function EZ(t,e){const n=t.indexOf(":"),r=t.substring(0,n);let i=TZ[r];if(i==null){if(Bv==null||typeof Bv!="function")throw new Error(`No geometry loader for scheme ${r} has been registered`);i=Bv}const a=i(t,e,G3);return a.promise.then(function(o){Ct(St,vt.GEOMETRY_LOADED,{geometry:o})},function(o){const s={geometryId:t,error:o};Ct(St,vt.GEOMETRY_LOADED_FAILED,s)}),a}function hIe(t,e){if(t===void 0)throw new Error("loadGeometry: parameter geometryId must not be undefined");let n=yt.getGeometryLoadObject(t);return n!==void 0||(n=EZ(t,e)),n.promise}async function pIe(t,e){if(t===void 0)throw new Error("createAndCacheGeometry: parameter geometryId must not be undefined");let n=yt.getGeometryLoadObject(t);return n!==void 0||(n=EZ(t,e),await yt.putGeometryLoadObject(t,n)),n.promise}function gIe(t,e){if(t===void 0)throw new Error("createAndCacheGeometry: parameter geometryId must not be undefined");let n=yt.getGeometry(t);if(n)return n;if(e.type===ou.CONTOUR)n=tIe(t,e.geometryData);else if(e.type===ou.SURFACE)n=rIe(t,e.geometryData);else if(e.type===ou.MESH)CZ(t,e.geometryData).then(r=>{n=r});else throw new Error(`Unknown geometry type: ${e.type}`);return yt.putGeometrySync(t,n),n}function _Z(t,e){TZ[t]=e}function mIe(t){const e=Bv;return Bv=t,e}_Z("mesh",SZ);const vIe=Object.freeze(Object.defineProperty({__proto__:null,createAndCacheGeometry:gIe,getOptions:dIe,loadAndCacheGeometry:pIe,loadGeometry:hIe,registerGeometryLoader:_Z,registerUnknownGeometryLoader:mIe,setOptions:fIe},Symbol.toStringTag,{value:"Module"}));function yIe(t,e){if(!e||!e.imageIds||!e.imageIds.length)throw new Error("ImageIds must be provided to create a 4D streaming image volume");const{imageIds:n}=e,{splittingTag:r,imageIdGroups:i}=i7(n),a=Math.floor(i.length/2),o=tC(i[a],t),{metadata:s,dimensions:l,spacing:c,direction:f,sizeInBytes:u,origin:d,numberOfComponents:h,dataType:p}=o,g=f.slice(6,9),m=i.map(w=>AD(w,g).sortedImageIds),y=m.flat(),v=g0.createScalarDynamicVolumeVoxelManager({dimensions:l,imageIdGroups:m,dimensionGroupNumber:1,numberOfComponents:h});let x=new ZJ({volumeId:t,metadata:s,dimensions:l,spacing:c,origin:d,direction:f,sizeInBytes:u,imageIds:y,imageIdGroups:m,splittingTag:r,voxelManager:v,numberOfComponents:h,dataType:p},{imageIds:y,loadStatus:{loaded:!1,loading:!1,cancelled:!1,cachedFrames:[],callbacks:[]}});return{promise:Promise.resolve(x),decache:()=>{x.destroy(),x=null},cancel:()=>{x.cancelLoading()}}}const xIe=Object.freeze(Object.defineProperty({__proto__:null,BaseRenderingEngine:XD,BaseVolumeViewport:lo,CONSTANTS:cp,ContextPoolRenderingEngine:V6,EPSILON:Yg,EVENTS:vt,Enums:nl,ImageVolume:Vm,ProgressiveRetrieveImages:C2,RenderingEngine:mJ,Settings:Yr,StackViewport:aa,StreamingDynamicImageVolume:ZJ,StreamingImageVolume:PY,Surface:vJ,TiledRenderingEngine:YD,VideoViewport:I3,Viewport:Qh,VolumeViewport:oa,VolumeViewport3D:sC,WSIViewport:R3,addImageSlicesToViewports:pJ,addVolumesToViewports:hJ,cache:yt,canRenderFloatTextures:Lw,convertMapperToNotSharedMapper:$Y,cornerstoneMeshLoader:SZ,cornerstoneStreamingDynamicImageVolumeLoader:yIe,cornerstoneStreamingImageVolumeLoader:NY,createCanvas:cy,createViewportElement:oJ,createVolumeActor:_3,createVolumeMapper:BY,eventTarget:St,geometryLoader:vIe,getConfiguration:Pf,getEnabledElement:et,getEnabledElementByIds:$m,getEnabledElementByViewportId:mr,getEnabledElements:HJ,getOrCreateCanvas:Ys,getRenderingEngine:$f,getRenderingEngines:Fl,getShouldUseCPURendering:Bg,getWebWorkerManager:Rm,imageLoadPoolManager:Qo,imageLoader:DEe,imageRetrievalPoolManager:jm,init:qW,isCornerstoneInitialized:XW,metaData:OD,peerImport:YW,registerImageLoader:Hg,requestPoolManager:Qo,resetInitialization:A1e,resetUseCPURendering:R1e,setCanvasCreator:K6e,setConfiguration:P1e,setPreferSizeOverAccuracy:I1e,setUseCPURendering:M1e,setVolumesForViewports:dJ,triggerEvent:Ct,utilities:Hr,version:B_e,volumeLoader:UEe},Symbol.toStringTag,{value:"Module"}));var yu;(function(t){t[t.Primary=1]="Primary",t[t.Secondary=2]="Secondary",t[t.Primary_And_Secondary=3]="Primary_And_Secondary",t[t.Auxiliary=4]="Auxiliary",t[t.Primary_And_Auxiliary=5]="Primary_And_Auxiliary",t[t.Secondary_And_Auxiliary=6]="Secondary_And_Auxiliary",t[t.Primary_And_Secondary_And_Auxiliary=7]="Primary_And_Secondary_And_Auxiliary",t[t.Fourth_Button=8]="Fourth_Button",t[t.Fifth_Button=16]="Fifth_Button",t[t.Wheel=524288]="Wheel",t[t.Wheel_Primary=524289]="Wheel_Primary"})(yu||(yu={}));var Ia;(function(t){t[t.Shift=16]="Shift",t[t.Ctrl=17]="Ctrl",t[t.Alt=18]="Alt",t[t.Meta=91]="Meta",t[t.ShiftCtrl=1617]="ShiftCtrl",t[t.ShiftAlt=1618]="ShiftAlt",t[t.ShiftMeta=1691]="ShiftMeta",t[t.CtrlAlt=1718]="CtrlAlt",t[t.CtrlMeta=1791]="CtrlMeta",t[t.AltMeta=1891]="AltMeta"})(Ia||(Ia={}));var vr;(function(t){t.Active="Active",t.Passive="Passive",t.Enabled="Enabled",t.Disabled="Disabled"})(vr||(vr={}));var vf;(function(t){t.Default="",t.Highlighted="Highlighted",t.Selected="Selected",t.Locked="Locked",t.AutoGenerated="AutoGenerated"})(vf||(vf={}));var ee;(function(t){t.TOOL_ACTIVATED="CORNERSTONE_TOOLS_TOOL_ACTIVATED",t.TOOLGROUP_VIEWPORT_ADDED="CORNERSTONE_TOOLS_TOOLGROUP_VIEWPORT_ADDED",t.TOOLGROUP_VIEWPORT_REMOVED="CORNERSTONE_TOOLS_TOOLGROUP_VIEWPORT_REMOVED",t.TOOL_MODE_CHANGED="CORNERSTONE_TOOLS_TOOL_MODE_CHANGED",t.CROSSHAIR_TOOL_CENTER_CHANGED="CORNERSTONE_TOOLS_CROSSHAIR_TOOL_CENTER_CHANGED",t.VOLUMECROPPINGCONTROL_TOOL_CHANGED="CORNERSTONE_TOOLS_VOLUMECROPPINGCONTROL_TOOL_CHANGED",t.VOLUMECROPPING_TOOL_CHANGED="CORNERSTONE_TOOLS_VOLUMECROPPING_TOOL_CHANGED",t.ANNOTATION_ADDED="CORNERSTONE_TOOLS_ANNOTATION_ADDED",t.ANNOTATION_COMPLETED="CORNERSTONE_TOOLS_ANNOTATION_COMPLETED",t.ANNOTATION_MODIFIED="CORNERSTONE_TOOLS_ANNOTATION_MODIFIED",t.ANNOTATION_REMOVED="CORNERSTONE_TOOLS_ANNOTATION_REMOVED",t.ANNOTATION_SELECTION_CHANGE="CORNERSTONE_TOOLS_ANNOTATION_SELECTION_CHANGE",t.ANNOTATION_LOCK_CHANGE="CORNERSTONE_TOOLS_ANNOTATION_LOCK_CHANGE",t.ANNOTATION_VISIBILITY_CHANGE="CORNERSTONE_TOOLS_ANNOTATION_VISIBILITY_CHANGE",t.ANNOTATION_RENDERED="CORNERSTONE_TOOLS_ANNOTATION_RENDERED",t.ANNOTATION_CUT_MERGE_PROCESS_COMPLETED="CORNERSTONE_TOOLS_ANNOTATION_CUT_MERGE_PROCESS_COMPLETED",t.ANNOTATION_INTERPOLATION_PROCESS_COMPLETED="CORNERSTONE_TOOLS_ANNOTATION_INTERPOLATION_PROCESS_COMPLETED",t.INTERPOLATED_ANNOTATIONS_REMOVED="CORNERSTONE_TOOLS_INTERPOLATED_ANNOTATIONS_REMOVED",t.SEGMENTATION_MODIFIED="CORNERSTONE_TOOLS_SEGMENTATION_MODIFIED",t.SEGMENTATION_RENDERED="CORNERSTONE_TOOLS_SEGMENTATION_RENDERED",t.SEGMENTATION_REPRESENTATION_ADDED="CORNERSTONE_TOOLS_SEGMENTATION_REPRESENTATION_ADDED",t.SEGMENTATION_ADDED="CORNERSTONE_TOOLS_SEGMENTATION_ADDED",t.SEGMENTATION_REPRESENTATION_MODIFIED="CORNERSTONE_TOOLS_SEGMENTATION_REPRESENTATION_MODIFIED",t.SEGMENTATION_REMOVED="CORNERSTONE_TOOLS_SEGMENTATION_REMOVED",t.SEGMENTATION_REPRESENTATION_REMOVED="CORNERSTONE_TOOLS_SEGMENTATION_REPRESENTATION_REMOVED",t.SEGMENTATION_DATA_MODIFIED="CORNERSTONE_TOOLS_SEGMENTATION_DATA_MODIFIED",t.HISTORY_UNDO="CORNERSTONE_TOOLS_HISTORY_UNDO",t.HISTORY_REDO="CORNERSTONE_TOOLS_HISTORY_REDO",t.KEY_DOWN="CORNERSTONE_TOOLS_KEY_DOWN",t.KEY_UP="CORNERSTONE_TOOLS_KEY_UP",t.MOUSE_DOWN="CORNERSTONE_TOOLS_MOUSE_DOWN",t.MOUSE_UP="CORNERSTONE_TOOLS_MOUSE_UP",t.MOUSE_DOWN_ACTIVATE="CORNERSTONE_TOOLS_MOUSE_DOWN_ACTIVATE",t.MOUSE_DRAG="CORNERSTONE_TOOLS_MOUSE_DRAG",t.MOUSE_MOVE="CORNERSTONE_TOOLS_MOUSE_MOVE",t.MOUSE_CLICK="CORNERSTONE_TOOLS_MOUSE_CLICK",t.MOUSE_DOUBLE_CLICK="CORNERSTONE_TOOLS_MOUSE_DOUBLE_CLICK",t.MOUSE_WHEEL="CORNERSTONE_TOOLS_MOUSE_WHEEL",t.TOUCH_START="CORNERSTONE_TOOLS_TOUCH_START",t.TOUCH_START_ACTIVATE="CORNERSTONE_TOOLS_TOUCH_START_ACTIVATE",t.TOUCH_PRESS="CORNERSTONE_TOOLS_TOUCH_PRESS",t.TOUCH_DRAG="CORNERSTONE_TOOLS_TOUCH_DRAG",t.TOUCH_END="CORNERSTONE_TOOLS_TOUCH_END",t.TOUCH_TAP="CORNERSTONE_TOOLS_TAP",t.TOUCH_SWIPE="CORNERSTONE_TOOLS_SWIPE"})(ee||(ee={}));var pn;(function(t){t.Labelmap="Labelmap",t.Contour="Contour",t.Surface="Surface"})(pn||(pn={}));var Rh;(function(t){t.UP="UP",t.DOWN="DOWN",t.LEFT="LEFT",t.RIGHT="RIGHT"})(Rh||(Rh={}));var jt;(function(t){t.OnInteractionStart="onInteractionStart",t.OnInteractionEnd="onInteractionEnd",t.Preview="preview",t.RejectPreview="rejectPreview",t.AcceptPreview="acceptPreview",t.Fill="fill",t.Interpolate="interpolate",t.StrategyFunction="strategyFunction",t.CreateIsInThreshold="createIsInThreshold",t.Initialize="initialize",t.INTERNAL_setValue="setValue",t.AddPreview="addPreview",t.ComputeInnerCircleRadius="computeInnerCircleRadius",t.GetStatistics="getStatistics",t.EnsureImageVolumeFor3DManipulation="ensureImageVolumeFor3DManipulation",t.EnsureSegmentationVolumeFor3DManipulation="ensureSegmentationVolumeFor3DManipulation"})(jt||(jt={}));var wn;(function(t){t.Interaction="Interaction",t.HandlesUpdated="HandlesUpdated",t.StatsUpdated="StatsUpdated",t.InitialSetup="InitialSetup",t.Completed="Completed",t.InterpolationUpdated="InterpolationUpdated",t.History="History",t.MetadataReferenceModified="MetadataReferenceModified",t.LabelChange="LabelChange"})(wn||(wn={}));var tp;(function(t){t.POLYSEG_CONTOUR_TO_LABELMAP="Converting Contour to Labelmap",t.POLYSEG_SURFACE_TO_LABELMAP="Converting Surfaces to Labelmap",t.POLYSEG_CONTOUR_TO_SURFACE="Converting Contour to Surface",t.POLYSEG_LABELMAP_TO_SURFACE="Converting Labelmap to Surface",t.SURFACE_CLIPPING="Clipping Surfaces",t.COMPUTE_STATISTICS="Computing Statistics",t.INTERPOLATE_LABELMAP="Interpolating Labelmap",t.COMPUTE_LARGEST_BIDIRECTIONAL="Computing Largest Bidirectional",t.GENERATE_CONTOUR_SETS="Generating Contour Sets"})(tp||(tp={}));const bIe=Object.freeze(Object.defineProperty({__proto__:null,AnnotationStyleStates:vf,ChangeTypes:wn,Events:ee,get KeyboardBindings(){return Ia},get MouseBindings(){return yu},SegmentationRepresentations:pn,StrategyCallbacks:jt,get Swipe(){return Rh},ToolModes:vr,WorkerTypes:tp},Symbol.toStringTag,{value:"Module"}));let wIe={},Mt={isInteractingWithTool:!1,isMultiPartToolActive:!1,tools:{},toolGroups:[],synchronizers:[],svgNodeCache:wIe,enabledElements:[]};var C8,oV;function CIe(){if(oV)return C8;oV=1;var t="Expected a function",e="__lodash_hash_undefined__",n="[object Function]",r="[object GeneratorFunction]",i="[object Symbol]",a=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,o=/^\w*$/,s=/^\./,l=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,c=/[\\^$.*+?()[\]{}|]/g,f=/\\(\\)?/g,u=/^\[object .+?Constructor\]$/,d=typeof gf=="object"&&gf&&gf.Object===Object&&gf,h=typeof self=="object"&&self&&self.Object===Object&&self,p=d||h||Function("return this")();function g(Le,We){return Le?.[We]}function m(Le){var We=!1;if(Le!=null&&typeof Le.toString!="function")try{We=!!(Le+"")}catch{}return We}var y=Array.prototype,v=Function.prototype,x=Object.prototype,w=p["__core-js_shared__"],S=(function(){var Le=/[^.]+$/.exec(w&&w.keys&&w.keys.IE_PROTO||"");return Le?"Symbol(src)_1."+Le:""})(),T=v.toString,_=x.hasOwnProperty,D=x.toString,I=RegExp("^"+T.call(_).replace(c,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),R=p.Symbol,M=y.splice,A=He(p,"Map"),L=He(Object,"create"),P=R?R.prototype:void 0,B=P?P.toString:void 0;function U(Le){var We=-1,xt=Le?Le.length:0;for(this.clear();++We<xt;){var Ut=Le[We];this.set(Ut[0],Ut[1])}}function G(){this.__data__=L?L(null):{}}function F(Le){return this.has(Le)&&delete this.__data__[Le]}function $(Le){var We=this.__data__;if(L){var xt=We[Le];return xt===e?void 0:xt}return _.call(We,Le)?We[Le]:void 0}function V(Le){var We=this.__data__;return L?We[Le]!==void 0:_.call(We,Le)}function X(Le,We){var xt=this.__data__;return xt[Le]=L&&We===void 0?e:We,this}U.prototype.clear=G,U.prototype.delete=F,U.prototype.get=$,U.prototype.has=V,U.prototype.set=X;function Q(Le){var We=-1,xt=Le?Le.length:0;for(this.clear();++We<xt;){var Ut=Le[We];this.set(Ut[0],Ut[1])}}function re(){this.__data__=[]}function ye(Le){var We=this.__data__,xt=ie(We,Le);if(xt<0)return!1;var Ut=We.length-1;return xt==Ut?We.pop():M.call(We,xt,1),!0}function me(Le){var We=this.__data__,xt=ie(We,Le);return xt<0?void 0:We[xt][1]}function Ce(Le){return ie(this.__data__,Le)>-1}function we(Le,We){var xt=this.__data__,Ut=ie(xt,Le);return Ut<0?xt.push([Le,We]):xt[Ut][1]=We,this}Q.prototype.clear=re,Q.prototype.delete=ye,Q.prototype.get=me,Q.prototype.has=Ce,Q.prototype.set=we;function Ae(Le){var We=-1,xt=Le?Le.length:0;for(this.clear();++We<xt;){var Ut=Le[We];this.set(Ut[0],Ut[1])}}function De(){this.__data__={hash:new U,map:new(A||Q),string:new U}}function q(Le){return Ke(this,Le).delete(Le)}function k(Le){return Ke(this,Le).get(Le)}function J(Le){return Ke(this,Le).has(Le)}function Y(Le,We){return Ke(this,Le).set(Le,We),this}Ae.prototype.clear=De,Ae.prototype.delete=q,Ae.prototype.get=k,Ae.prototype.has=J,Ae.prototype.set=Y;function ie(Le,We){for(var xt=Le.length;xt--;)if(Je(Le[xt][0],We))return xt;return-1}function ue(Le,We){We=pe(We,Le)?[We]:Fe(We);for(var xt=0,Ut=We.length;Le!=null&&xt<Ut;)Le=Le[_e(We[xt++])];return xt&&xt==Ut?Le:void 0}function fe(Le){if(!Re(Le)||Ie(Le))return!1;var We=ke(Le)||m(Le)?I:u;return We.test(Pe(Le))}function Se(Le){if(typeof Le=="string")return Le;if(st(Le))return B?B.call(Le):"";var We=Le+"";return We=="0"&&1/Le==-1/0?"-0":We}function Fe(Le){return $e(Le)?Le:ve(Le)}function Ke(Le,We){var xt=Le.__data__;return ge(We)?xt[typeof We=="string"?"string":"hash"]:xt.map}function He(Le,We){var xt=g(Le,We);return fe(xt)?xt:void 0}function pe(Le,We){if($e(Le))return!1;var xt=typeof Le;return xt=="number"||xt=="symbol"||xt=="boolean"||Le==null||st(Le)?!0:o.test(Le)||!a.test(Le)||We!=null&&Le in Object(We)}function ge(Le){var We=typeof Le;return We=="string"||We=="number"||We=="symbol"||We=="boolean"?Le!=="__proto__":Le===null}function Ie(Le){return!!S&&S in Le}var ve=ne(function(Le){Le=Qe(Le);var We=[];return s.test(Le)&&We.push(""),Le.replace(l,function(xt,Ut,gn,tn){We.push(gn?tn.replace(f,"$1"):Ut||xt)}),We});function _e(Le){if(typeof Le=="string"||st(Le))return Le;var We=Le+"";return We=="0"&&1/Le==-1/0?"-0":We}function Pe(Le){if(Le!=null){try{return T.call(Le)}catch{}try{return Le+""}catch{}}return""}function ne(Le,We){if(typeof Le!="function"||We&&typeof We!="function")throw new TypeError(t);var xt=function(){var Ut=arguments,gn=We?We.apply(this,Ut):Ut[0],tn=xt.cache;if(tn.has(gn))return tn.get(gn);var Ht=Le.apply(this,Ut);return xt.cache=tn.set(gn,Ht),Ht};return xt.cache=new(ne.Cache||Ae),xt}ne.Cache=Ae;function Je(Le,We){return Le===We||Le!==Le&&We!==We}var $e=Array.isArray;function ke(Le){var We=Re(Le)?D.call(Le):"";return We==n||We==r}function Re(Le){var We=typeof Le;return!!Le&&(We=="object"||We=="function")}function ze(Le){return!!Le&&typeof Le=="object"}function st(Le){return typeof Le=="symbol"||ze(Le)&&D.call(Le)==i}function Qe(Le){return Le==null?"":Se(Le)}function _t(Le,We,xt){var Ut=Le==null?void 0:ue(Le,We);return Ut===void 0?xt:Ut}return C8=_t,C8}var SIe=CIe();const TIe=tl(SIe),sV=Symbol("DefinedCursors"),DZ=new Set(["alias","all-scroll","auto","cell","col-resize","context-menu","copy","crosshair","default","e-resize","ew-resize","grab","grabbing","help","move","ne-resize","nesw-resize","no-drop","none","not-allowed","n-resize","ns-resize","nw-resize","nwse-resize","pointer","progress","row-resize","se-resize","s-resize","sw-resize","text","vertical-text","wait","w-resize","zoom-in","zoom-out"]);class Ws{constructor(e,n){this.name=e+"",this.fallback=n}getName(){return this.name+""}addFallbackStyleProperty(e){const{fallback:n}=this;return n instanceof Ws?`${e}, ${n.getStyleProperty()}`:e+""}getStyleProperty(){return this.addFallbackStyleProperty(this.name)+""}static getDefinedCursor(e){const n=lV(Ws,sV);let r=n.get(e);if(r instanceof Ws)return r;if(DZ.has(e))return r=new Ws(e),n.set(e,r),r}static setDefinedCursor(e,n){return n instanceof Ws?(lV(Ws,sV).set(e,n),!0):!1}}function lV(t,e){let n=t[e];return n instanceof Map||(n=new Map,Object.defineProperty(t,e,{value:n})),n}const EIe=DZ.values(),_Ie="image-cursor";class j3 extends Ws{constructor(e,n,r,i,a){super(i||j3.getUniqueInstanceName(_Ie),a),this.url=e,this.x=Number(n)||0,this.y=Number(r)||0}getStyleProperty(){const{url:e,x:n,y:r}=this;let i=`url('${e}')`;return n>=0&&r>=0&&(n>0||r>0)&&(i+=` ${n} ${r}`),this.addFallbackStyleProperty(i)}static getUniqueInstanceName(e){return`${e}-${FJ(j3)}`}}const tr={iconContent:"",iconSize:16,viewBox:{x:16,y:16},mousePoint:{x:8,y:8},mousePointerGroupString:`
    <path stroke="{{color}}" d="M8 16L8 0"></path>
    <path stroke="{{color}}" d="M16 8L0 8"></path>
  `},gs={x:127,y:60},ng=`
<rect fill="{{color}}" x="80.19" y="25.03" width="47.14" height="15.85"/>
`,yd=`
<rect fill="{{color}}" x="80.19" y="25.03" width="47.14" height="15.85"/>
<rect fill="{{color}}" x="95.84" y="9.38" width="15.85" height="47.14"/>
`,Dx='<path fill="{{color}}" d="M82.89,10a12.09,12.09,0,0,0-16.8-2.5l-27.5,20.4-8.5-6.3a2.93,2.93,0,0,1-1.1-3,14.66,14.66,0,0,0,.1-6.6,14.08,14.08,0,1,0-6.5,15.2,2.87,2.87,0,0,1,3.2.2l8.2,6.1-8.2,6.1a2.87,2.87,0,0,1-3.2.2,14.16,14.16,0,1,0,6.7,14.4,14,14,0,0,0-.3-5.8,2.93,2.93,0,0,1,1.1-3l8.5-6.3,27.5,20.4A11.91,11.91,0,0,0,82.89,57l-31.7-23.5ZM15.29,21a5.9,5.9,0,1,1,5.9-5.9A5.91,5.91,0,0,1,15.29,21Zm0,36.8a5.9,5.9,0,1,1,5.9-5.9A5.91,5.91,0,0,1,15.29,57.77Zm28.3-21.5a2.8,2.8,0,1,1,2.8-2.8A2.8,2.8,0,0,1,43.59,36.27Z" transform="translate(-1.17 -0.96)"/>',rg='<path fill="{{color}}" d="M8.86,2.25V66.08H72.69V2.25H8.86ZM65.28,58.67h-49v-49h49v49Z" transform="translate(-8.86 -2.25)"/>',Ox='<path fill="{{color}}" d="M40.77,2.25A31.92,31.92,0,1,0,72.69,34.16,31.92,31.92,0,0,0,40.77,2.25Zm0,57.63A25.71,25.71,0,1,1,66.48,34.16,25.71,25.71,0,0,1,40.77,59.87Z" transform="translate(-8.86 -2.25)"/>',OZ={Angle:nr(tr,{name:"Angle",iconContent:`<path fill="{{color}}" d="M1203 544q0 13-10 23l-393 393 393 393q10 10 10 23t-10 23l-50
    50q-10 10-23 10t-23-10l-466-466q-10-10-10-23t10-23l466-466q10-10 23-10t23
    10l50 50q10 10 10 23z" />`,viewBox:{x:1792,y:1792}}),ArrowAnnotate:nr(tr,{name:"ArrowAnnotate",iconContent:`<g id="arrowAnnotate-group" fill="none" stroke-width="1" stroke="{{color}}" stroke-linecap="round" stroke-linejoin="round">
    <path id="arrowAnnotate-arrow" d="M23,7 l-15,15 M7,17 l0,6 6,0" stroke-width="2" />
  </g>`,viewBox:{x:24,y:24}}),Bidirectional:nr(tr,{name:"Bidirectional",iconContent:`<g fill="{{color}}" stroke-width="3" stroke="{{color}}">
    <path d="M27.63 3.21L3.12 28.81"></path>
    <path d="M27.63 15.75L15.27 4.43"></path>
    <path d="M16.5 4.28C16.5 4.96 15.95 5.51 15.27 5.51C14.59 5.51 14.03 4.96 14.03 4.28C14.03 3.59 14.59 3.04 15.27 3.04C15.95 3.04 16.5 3.59 16.5 4.28Z" ></path>
    <path d="M28.87 3.19C28.87 3.87 28.31 4.43 27.63 4.43C26.95 4.43 26.4 3.87 26.4 3.19C26.4 2.51 26.95 1.95 27.63 1.95C28.31 1.95 28.87 2.51 28.87 3.19Z"></path>
    <path d="M28.87 15.75C28.87 16.43 28.31 16.99 27.63 16.99C26.95 16.99 26.4 16.43 26.4 15.75C26.4 15.07 26.95 14.51 27.63 14.51C28.31 14.51 28.87 15.07 28.87 15.75Z"></path>
    <path d="M4.73 28.44C4.73 29.12 4.17 29.68 3.49 29.68C2.81 29.68 2.25 29.12 2.25 28.44C2.25 27.76 2.81 27.2 3.49 27.2C4.17 27.2 4.73 27.76 4.73 28.44Z"></path>
  </g>`,viewBox:{x:48,y:48}}),CobbAngle:nr(tr,{name:"CobbAngle",iconContent:`<g stroke="{{color}}" stroke-width="3">
    <path d="M28.59 2.34L3.82 12.32"></path>
    <path d="M28.59 29.66L3.82 19.68"></path>
    <path stroke-dasharray="2" fill-opacity="0" d="M12.37
      23.06C12.67 22.36 12.85 21.93 12.92 21.76C14.6 17.8 14.68 13.35 13.15
      9.33C13.11 9.24 13.02 9 12.88 8.63">
    </path>
  </g>`,viewBox:{x:32,y:32}}),CircleROI:nr(tr,{name:"CircleROI",iconContent:'<circle stroke="{{color}}" fill="none" stroke-width="3" cx="16" cy="16" r="14" />',viewBox:{x:32,y:32}}),EllipticalROI:nr(tr,{name:"EllipticalROI",iconContent:`<path stroke="{{color}}" fill="none" stroke-width="3" d="M30.74 15.76C30.74 20.99 24.14 25.23 16
    25.23C7.86 25.23 1.26 20.99 1.26 15.76C1.26 10.54 7.86 6.3 16 6.3C24.14
    6.3 30.74 10.54 30.74 15.76Z" />`,viewBox:{x:32,y:32}}),FreehandROI:nr(tr,{name:"FreehandROI",iconContent:`<g fill="{{color}}" stroke="{{color}}" stroke-width="2">
    <ellipse ry="1" rx="1" id="svg_3" cy="4.240343" cx="14.306499"/>
    <line id="svg_4" y2="3.58462" x2="12.242186" y1="3.997482" x1="13.432202"/>
    <line id="svg_5" y2="3.268901" x2="10.857882" y1="3.608906" x1="12.387902"/>
    <line id="svg_6" y2="3.147471" x2="9.740724" y1="3.293187" x1="10.955026"/>
    <line id="svg_7" y2="3.147471" x2="8.089274" y1="3.196043" x1="9.983585"/>
    <line id="svg_8" y2="3.268901" x2="6.874972" y1="3.123185" x1="8.307848"/>
    <line id="svg_9" y2="3.657478" x2="5.587812" y1="3.220329" x1="7.020688"/>
    <line id="svg_10" y2="4.046054" x2="4.737801" y1="3.560334" x1="5.854959"/>
    <line id="svg_11" y2="4.337487" x2="4.300652" y1="3.997482" x1="4.834945"/>
    <line id="svg_12" y2="4.726063" x2="3.88779" y1="4.191771" x1="4.470655"/>
    <line id="svg_15" y2="5.3575" x2="3.377783" y1="4.604633" x1="3.960648"/>
    <line id="svg_16" y2="6.183226" x2="2.916348" y1="5.138926" x1="3.547785"/>
    <line id="svg_17" y2="6.960379" x2="2.770632" y1="5.867507" x1="3.037779"/>
    <line id="svg_18" y2="7.713246" x2="2.673488" y1="6.741804" x1="2.819204"/>
    <line id="svg_19" y2="8.684687" x2="2.697774" y1="7.616102" x1="2.673488"/>
    <line id="svg_20" y2="9.753273" x2="2.892062" y1="8.611829" x1="2.697774"/>
    <line id="svg_21" y2="10.724714" x2="3.134923" y1="9.534698" x1="2.84349"/>
    <line id="svg_23" y2="11.647583" x2="3.596357" y1="10.578998" x1="3.086351"/>
    <line id="svg_25" y2="12.521881" x2="4.276366" y1="11.501867" x1="3.499213"/>
    <line id="svg_26" y2="13.930471" x2="5.830673" y1="12.376165" x1="4.13065"/>
    <line id="svg_28" y2="14.707624" x2="7.263549" y1="13.881899" x1="5.733528"/>
    <line id="svg_29" y2="15.339061" x2="8.963571" y1="14.61048" x1="7.06926"/>
    <line id="svg_30" y2="15.581921" x2="10.882168" y1="15.314775" x1="8.817855"/>
    <line id="svg_31" y2="15.460491" x2="12.023612" y1="15.581921" x1="10.785024"/>
    <line id="svg_33" y2="15.120487" x2="13.092197" y1="15.484777" x1="11.877895"/>
    <line id="svg_34" y2="14.586194" x2="13.86935" y1="15.217631" x1="12.897909"/>
    <line id="svg_35" y2="13.833327" x2="14.597931" y1="14.756196" x1="13.699348"/>
    <line id="svg_37" y2="12.716169" x2="15.180796" y1="13.881899" x1="14.549359"/>
    <line id="svg_39" y2="11.429009" x2="15.520801" y1="12.813313" x1="15.15651"/>
    <ellipse ry="1" rx="1" id="svg_40" cy="10.967574" cx="15.520801"/>
  </g>`,viewBox:{x:18,y:18}}),FreehandROISculptor:nr(tr,{name:"FreehandROISculptor",iconContent:`<g id="icon-freehand-sculpt" fill="none" stroke-width="1.5" stroke="{{color}}" stroke-linecap="round" stroke-linejoin="round">
    <line id="svg_1" y2="2.559367" x2="10.184807" y1="4.467781" x1="8.81711"/>
    <line id="svg_4" y2="1.493836" x2="11.727442" y1="2.766112" x1="10.089386"/>
    <line id="svg_7" y2="1.080346" x2="13.047428" y1="1.748291" x1="11.345759"/>
    <line id="svg_8" y2="1.000829" x2="14.351511" y1="1.112153" x1="12.77707"/>
    <line id="svg_9" y2="1.350705" x2="15.242104" y1="0.905408" x1="13.969828"/>
    <line id="svg_10" y2="2.098167" x2="15.862339" y1="1.14396" x1="14.955842"/>
    <line id="svg_11" y2="3.195505" x2="16.41896" y1="1.939133" x1="15.766918"/>
    <line id="svg_12" y2="4.292843" x2="16.530284" y1="2.925147" x1="16.387153"/>
    <line id="svg_16" y2="5.644637" x2="16.196311" y1="3.831643" x1="16.593898"/>
    <line id="svg_18" y2="7.266789" x2="15.623787" y1="5.19934" x1="16.275829"/>
    <line id="svg_19" y2="10.813258" x2="14.526449" y1="6.726071" x1="15.766918"/>
    <line id="svg_20" y2="5.056209" x2="8.085552" y1="4.181519" x1="8.976145"/>
    <line id="svg_23" y2="5.326568" x2="7.481221" y1="4.78585" x1="8.403621"/>
    <line id="svg_24" y2="5.565119" x2="6.749662" y1="5.294761" x1="7.624352"/>
    <line id="svg_25" y2="5.994512" x2="5.429675" y1="5.533312" x1="6.956407"/>
    <line id="svg_27" y2="6.551133" x2="4.284627" y1="5.962706" x1="5.572807"/>
    <line id="svg_28" y2="7.584858" x2="3.044158" y1="6.392099" x1="4.427758"/>
    <line id="svg_29" y2="8.84123" x2="2.185372" y1="7.489437" x1="3.219096"/>
    <line id="svg_31" y2="10.606513" x2="1.644654" y1="8.602678" x1="2.280792"/>
    <line id="svg_32" y2="13.214679" x2="1.48562" y1="10.352058" x1="1.724171"/>
    <line id="svg_33" y2="14.375631" x2="1.676461" y1="12.992031" x1="1.453813"/>
    <line id="svg_34" y2="15.298031" x2="2.264889" y1="14.152983" x1="1.517427"/>
    <line id="svg_35" y2="16.172721" x2="3.521261" y1="14.948155" x1="1.915013"/>
    <line id="svg_36" y2="16.824762" x2="5.207027" y1="15.997783" x1="3.28271"/>
    <line id="svg_38" y2="17.063314" x2="7.035924" y1="16.745245" x1="4.968475"/>
    <line id="svg_39" y2="16.888376" x2="9.278311" y1="17.047411" x1="6.733758"/>
    <line id="svg_40" y2="16.284045" x2="10.661911" y1="16.983797" x1="8.992048"/>
    <line id="svg_41" y2="15.313934" x2="11.647925" y1="16.395369" x1="10.455166"/>
    <line id="svg_44" y2="13.898527" x2="12.82478" y1="15.425259" x1="11.504794"/>
    <line id="svg_45" y2="12.037824" x2="14.144766" y1="14.312017" x1="12.522614"/>
    <line id="svg_47" y2="10.59061" x2="14.605966" y1="12.228665" x1="13.953925"/>
    <ellipse ry="1" rx="1" id="svg_48" cy="3.982726" cx="13.460918"/>
  </g>`,viewBox:{x:18,y:18}}),Length:nr(tr,{name:"Length",iconContent:`<g id="length-group" fill="none" stroke-width="1" stroke="{{color}}" stroke-linecap="round" stroke-linejoin="round">
    <path id="length-dashes" d="m22.5,6 -16.5,16.5" stroke-width="3" stroke-dasharray="0.6666,5" />
  </g>`,viewBox:{x:24,y:24}}),Height:nr(tr,{name:"Height",iconContent:'<path d="m 6 22 l 8.5 0 v -16 h 8" stroke-width="3" fill="none" stroke="{{color}}" />',viewBox:{x:24,y:24}}),Probe:nr(tr,{name:"Probe",iconContent:`<path fill="{{color}}" d="M1152 896q0 106-75 181t-181 75-181-75-75-181 75-181 181-75 181 75
    75 181zm-256-544q-148 0-273 73t-198 198-73 273 73 273 198 198 273 73 273-73
    198-198 73-273-73-273-198-198-273-73zm768 544q0 209-103 385.5t-279.5
    279.5-385.5 103-385.5-103-279.5-279.5-103-385.5 103-385.5 279.5-279.5
    385.5-103 385.5 103 279.5 279.5 103 385.5z" />`,viewBox:{x:1792,y:1792}}),RectangleROI:nr(tr,{name:"RectangleROI",iconContent:`<path fill="{{color}}" d="M1312 256h-832q-66 0-113 47t-47 113v832q0 66 47
    113t113 47h832q66 0 113-47t47-113v-832q0-66-47-113t-113-47zm288 160v832q0
    119-84.5 203.5t-203.5 84.5h-832q-119 0-203.5-84.5t-84.5-203.5v-832q0-119
    84.5-203.5t203.5-84.5h832q119 0 203.5 84.5t84.5 203.5z" />`,viewBox:{x:1792,y:1792}}),Label:nr(tr,{name:"Label",iconContent:`<path fill="{{color}}" d="M789 559l-170 450q33 0 136.5 2t160.5 2q19 0
    57-2-87-253-184-452zm-725 1105l2-79q23-7 56-12.5t57-10.5 49.5-14.5 44.5-29
    31-50.5l237-616 280-724h128q8 14 11 21l205 480q33 78 106 257.5t114 274.5q15
    34 58 144.5t72 168.5q20 45 35 57 19 15 88 29.5t84 20.5q6 38 6 57 0 5-.5
    13.5t-.5 12.5q-63 0-190-8t-191-8q-76 0-215 7t-178 8q0-43 4-78l131-28q1 0
    12.5-2.5t15.5-3.5 14.5-4.5 15-6.5 11-8 9-11
    2.5-14q0-16-31-96.5t-72-177.5-42-100l-450-2q-26 58-76.5 195.5t-50.5 162.5q0
    22 14 37.5t43.5 24.5 48.5 13.5 57 8.5 41 4q1 19 1 58 0 9-2 27-58
    0-174.5-10t-174.5-10q-8 0-26.5 4t-21.5 4q-80 14-188 14z" />`,viewBox:{x:1792,y:1792}}),Crosshairs:nr(tr,{name:"Crosshairs",iconContent:`<path fill="{{color}}" d="M1325 1024h-109q-26 0-45-19t-19-45v-128q0-26
    19-45t45-19h109q-32-108-112.5-188.5t-188.5-112.5v109q0 26-19 45t-45
    19h-128q-26 0-45-19t-19-45v-109q-108 32-188.5 112.5t-112.5 188.5h109q26
    0 45 19t19 45v128q0 26-19 45t-45 19h-109q32 108 112.5 188.5t188.5
    112.5v-109q0-26 19-45t45-19h128q26 0 45 19t19 45v109q108-32
    188.5-112.5t112.5-188.5zm339-192v128q0 26-19 45t-45 19h-143q-37 161-154.5
    278.5t-278.5 154.5v143q0 26-19 45t-45 19h-128q-26
    0-45-19t-19-45v-143q-161-37-278.5-154.5t-154.5-278.5h-143q-26
    0-45-19t-19-45v-128q0-26 19-45t45-19h143q37-161
    154.5-278.5t278.5-154.5v-143q0-26 19-45t45-19h128q26 0 45 19t19 45v143q161
    37 278.5 154.5t154.5 278.5h143q26 0 45 19t19 45z" />`,viewBox:{x:1792,y:1792}}),Eraser:nr(tr,{name:"Eraser",iconContent:`<path transform="translate(0,1792) scale(1,-1)" fill="{{color}}" d="M960 1408l336-384h-768l-336 384h768zm1013-1077q15
    34 9.5 71.5t-30.5 65.5l-896 1024q-38 44-96 44h-768q-38
    0-69.5-20.5t-47.5-54.5q-15-34-9.5-71.5t30.5-65.5l896-1024q38-44 96-44h768q38
    0 69.5 20.5t47.5 54.5z" />`,viewBox:{x:2048,y:1792}}),Magnify:nr(tr,{name:"Magnify",iconContent:`<path fill="{{color}}" d="M508.5 481.6l-129-129c-2.3-2.3-5.3-3.5-8.5-3.5h-10.3C395
    312 416 262.5 416 208 416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c54.5
    0 104-21 141.1-55.2V371c0 3.2 1.3 6.2 3.5 8.5l129 129c4.7 4.7 12.3 4.7 17
    0l9.9-9.9c4.7-4.7 4.7-12.3 0-17zM208 384c-97.3 0-176-78.7-176-176S110.7 32 208
    32s176 78.7 176 176-78.7 176-176 176z" />`,viewBox:{x:512,y:512}}),Pan:nr(tr,{name:"Pan",iconContent:`<path fill="{{color}}" d="M1411 541l-355 355 355 355 144-144q29-31 70-14 39 17
    39 59v448q0 26-19 45t-45 19h-448q-42 0-59-40-17-39 14-69l144-144-355-355-355
    355 144 144q31 30 14 69-17 40-59 40h-448q-26 0-45-19t-19-45v-448q0-42 40-59
    39-17 69 14l144 144 355-355-355-355-144 144q-19 19-45 19-12
    0-24-5-40-17-40-59v-448q0-26 19-45t45-19h448q42 0 59 40 17 39-14 69l-144
    144 355 355 355-355-144-144q-31-30-14-69 17-40 59-40h448q26 0 45 19t19
    45v448q0 42-39 59-13 5-25 5-26 0-45-19z" />`,viewBox:{x:1792,y:1792}}),Rotate:nr(tr,{name:"Rotate",iconContent:`<path fill="{{color}}" d="M1664 256v448q0 26-19 45t-45 19h-448q-42 0-59-40-17-39
    14-69l138-138q-148-137-349-137-104 0-198.5 40.5t-163.5 109.5-109.5
    163.5-40.5 198.5 40.5 198.5 109.5 163.5 163.5 109.5 198.5 40.5q119 0
    225-52t179-147q7-10 23-12 15 0 25 9l137 138q9 8 9.5 20.5t-7.5 22.5q-109
    132-264 204.5t-327 72.5q-156 0-298-61t-245-164-164-245-61-298 61-298
    164-245 245-164 298-61q147 0 284.5 55.5t244.5 156.5l130-129q29-31 70-14
    39 17 39 59z" />`,viewBox:{x:1792,y:1792}}),StackScroll:nr(tr,{name:"StackScroll",iconContent:`<path fill="{{color}}" d="M24 21v2c0 0.547-0.453 1-1 1h-22c-0.547
    0-1-0.453-1-1v-2c0-0.547 0.453-1 1-1h22c0.547 0 1 0.453 1 1zM24 13v2c0
    0.547-0.453 1-1 1h-22c-0.547 0-1-0.453-1-1v-2c0-0.547 0.453-1 1-1h22c0.547
    0 1 0.453 1 1zM24 5v2c0 0.547-0.453 1-1 1h-22c-0.547
    0-1-0.453-1-1v-2c0-0.547 0.453-1 1-1h22c0.547 0 1 0.453 1 1z" />`,viewBox:{x:24,y:28}}),WindowLevelRegion:nr(tr,{name:"WindowLevelRegion",iconContent:`<path fill="{{color}}" d="M1664 416v960q0 119-84.5 203.5t-203.5 84.5h-960q-119
    0-203.5-84.5t-84.5-203.5v-960q0-119 84.5-203.5t203.5-84.5h960q119 0 203.5
    84.5t84.5 203.5z" />`,viewBox:{x:1792,y:1792}}),WindowLevel:nr(tr,{name:"WindowLevel",iconContent:`
    <path fill="{{color}}" d="M14.5,3.5 a1 1 0 0 1 -11,11 Z" stroke="none" opacity="0.8" />
    <circle cx="9" cy="9" r="8" fill="none" stroke-width="2" stroke="{{color}}" />`,viewBox:{x:18,y:18}}),Zoom:nr(tr,{name:"Zoom",iconContent:`
  <path fill="{{color}}" d="M508.5 481.6l-129-129c-2.3-2.3-5.3-3.5-8.5-3.5h-10.3C395
    312 416 262.5 416 208 416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c54.5
    0 104-21 141.1-55.2V371c0 3.2 1.3 6.2 3.5 8.5l129 129c4.7 4.7 12.3 4.7 17
    0l9.9-9.9c4.7-4.7 4.7-12.3 0-17zM208 384c-97.3 0-176-78.7-176-176S110.7 32 208
    32s176 78.7 176 176-78.7 176-176 176z" />
  <path fill="{{color}}" transform="scale(0.22,0.22) translate(1400,0)" d="M1216
    320q0 26-19 45t-45 19h-128v1024h128q26 0 45 19t19 45-19 45l-256 256q-19
    19-45 19t-45-19l-256-256q-19-19-19-45t19-45 45-19h128v-1024h-128q-26
    0-45-19t-19-45 19-45l256-256q19-19 45-19t45 19l256 256q19 19 19 45z" />`,viewBox:{x:640,y:512}}),SegmentationFreeHandEraseInside:nr(tr,{name:"SegmentationFreeHandEraseInside",iconContent:`${Dx} ${ng}`,viewBox:gs}),SegmentationFreeHandFillInside:nr(tr,{name:"SegmentationFreeHandFillInside",iconContent:`${Dx} ${yd}`,viewBox:gs}),SegmentationFreeHandEraseOutside:nr(tr,{name:"SegmentationFreeHandEraseOutside",iconContent:`${Dx} ${ng}`,viewBox:gs}),SegmentationFreeHandFillOutside:nr(tr,{name:"SegmentationFreeHandFillOutside",iconContent:`${Dx} ${yd}`,viewBox:gs}),SegmentationRectangleEraseInside:nr(tr,{name:"SegmentationRectangleEraseInside",iconContent:`${rg} ${ng}`,viewBox:gs}),RectangleScissor:nr(tr,{name:"RectangleScissor",iconContent:`${rg} ${yd}`,viewBox:gs}),"RectangleScissor.FILL_INSIDE":nr(tr,{name:"RectangleScissor.FILL_INSIDE",iconContent:`${rg} ${yd}`,viewBox:gs}),"RectangleScissor.FILL_OUTSIDE":nr(tr,{name:"RectangleScissor.FILL_OUTSIDE",iconContent:`${rg} ${yd}`,viewBox:gs}),"RectangleScissor.ERASE_OUTSIDE":nr(tr,{name:"RectangleScissor.ERASE_OUTSIDE",iconContent:`${rg} ${ng}`,viewBox:gs}),"RectangleScissor.ERASE_INSIDE":nr(tr,{name:"RectangleScissor.ERASE_INSIDE",iconContent:`${rg} ${ng}`,viewBox:gs}),CircleScissor:nr(tr,{name:"CircleScissor",iconContent:`${Ox} ${yd}`,viewBox:gs}),"CircleScissor.FILL_INSIDE":nr(tr,{name:"CircleScissor.FILL_INSIDE",iconContent:`${Ox} ${yd}`,viewBox:gs}),"CircleScissor.ERASE_OUTSIDE":nr(tr,{name:"CircleScissor.ERASE_OUTSIDE",iconContent:`${Ox} ${ng}`,viewBox:gs}),"CircleScissor.FILL_OUTSIDE":nr(tr,{name:"CircleScissor.FILL_OUTSIDE",iconContent:`${Ox} ${yd}`,viewBox:gs})};function nr(t,e){return Object.assign(Object.create(t),{...e,name:e.name||t.name})}function DIe(t){return OZ[t]}const OIe=Object.keys(OZ);class MIe{constructor(){const e={color:"rgb(255, 255, 0)",colorHighlighted:"rgb(0, 255, 0)",colorSelected:"rgb(0, 220, 0)",colorLocked:"rgb(209, 193, 90)",lineWidth:"1",lineDash:"",shadow:!0,textBoxVisibility:!0,textBoxFontFamily:"Helvetica Neue, Helvetica, Arial, sans-serif",textBoxFontSize:"14px",textBoxColor:"rgb(255, 255, 0)",textBoxColorHighlighted:"rgb(0, 255, 0)",textBoxColorSelected:"rgb(0, 255, 0)",textBoxColorLocked:"rgb(209, 193, 90)",textBoxBackground:"",textBoxLinkLineWidth:"1",textBoxLinkLineDash:"2,3",textBoxShadow:!0,markerSize:"10",angleArcLineDash:""};this._initializeConfig(e)}getAnnotationToolStyles(e){return this.config.annotations&&this.config.annotations[e]}getViewportToolStyles(e){return this.config.viewports&&this.config.viewports[e]}getToolGroupToolStyles(e){return this.config.toolGroups&&this.config.toolGroups[e]}getDefaultToolStyles(){return this.config.default}setAnnotationStyles(e,n){let r=this.config.annotations;r||(this.config={...this.config,annotations:{}},r=this.config.annotations),r[e]=n}setViewportToolStyles(e,n){let r=this.config.viewports;r||(this.config={...this.config,viewports:{}},r=this.config.viewports),r[e]=n}setToolGroupToolStyles(e,n){let r=this.config.toolGroups;r||(this.config={...this.config,toolGroups:{}},r=this.config.toolGroups),r[e]=n}setDefaultToolStyles(e){this.config.default=e}getStyleProperty(e,n){const{annotationUID:r,viewportId:i,toolGroupId:a,toolName:o}=n;return this._getToolStyle(e,r,i,a,o)}_getToolStyle(e,n,r,i,a){if(n){const s=this.getAnnotationToolStyles(n);if(s&&s[e]!==void 0)return s[e]}if(r){const s=this.getViewportToolStyles(r);if(s){if(s[a]&&s[a][e]!==void 0)return s[a][e];if(s.global&&s.global[e]!==void 0)return s.global[e]}}if(i){const s=this.getToolGroupToolStyles(i);if(s){if(s[a]&&s[a][e]!==void 0)return s[a][e];if(s.global&&s.global[e]!==void 0)return s.global[e]}}const o=this.getDefaultToolStyles();if(o[a]&&o[a][e]!==void 0)return o[a][e];if(o.global&&o.global[e]!==void 0)return o.global[e]}_initializeConfig(e){const n={};for(const r in e)n[r]=e[r];this.config={default:{global:n}}}}const Tb=new MIe;function IIe(t,e,n){const r=[`${t}`];return e&&r.push(`${r[0]}${e}`),n&&r.push(`${r[r.length-1]}${n}`),r}function MZ(t,e,n,r){const i=IIe(t,n,r);for(let a=i.length-1;a>=0;--a){const o=Tb.getStyleProperty(i[a],e);if(o!==void 0)return o}}const RIe="color",AIe=vf.Highlighted,PIe=vr.Active;class Eb extends j3{constructor(e,n,r,i,a){super(e,n,r,i,a)}static getDefinedCursor(e,n=!1,r){r||(r=MZ(RIe,{},AIe,PIe));const i=NIe(e,n,r);let a=super.getDefinedCursor(i);if(!a){const o=DIe(e);o&&(a=LIe(o,i,n,r,super.getDefinedCursor("default")),super.setDefinedCursor(i,a))}return a}}function IZ(t,e){const n=Object(e),r=Object.prototype.hasOwnProperty.bind(n);return(t+"").replace(/\{\{(\w+)\}\}/g,(i,a)=>r(a)?n[a]+"":"")}function NIe(t,e,n){return`${e?"pointer":"cursor"}:${t}/${n}`}function LIe(t,e,n,r,i){const{x:a,y:o}=t.mousePoint;return new Eb(kIe(t,n,{color:r}),a,o,e,i)}function kIe(t,e,n){const r=VIe(t,e,n);return`${URL.createObjectURL(r)}#${t.name||"unknown"}-${e?"pointer":"cursor"}`}function VIe(t,e,n){const r=(e?UIe:FIe)(t,n);return new Blob([r],{type:"image/svg+xml"})}function FIe(t,e){const{iconContent:n,iconSize:r,viewBox:i}=t,a=`
    <svg data-icon="cursor" role="img" xmlns="http://www.w3.org/2000/svg"
      width="${r}" height="${r}" viewBox="0 0
      ${i.x} ${i.y}">
      ${n}
    </svg>`;return IZ(a,e)}function UIe(t,e){const{iconContent:n,iconSize:r,viewBox:i,mousePointerGroupString:a}=t,o=r/Math.max(i.x,i.y,1),s=16+r,l=`
    <svg data-icon="cursor" role="img" xmlns="http://www.w3.org/2000/svg"
      width="${s}" height="${s}" viewBox="0 0 ${s} ${s}">
      <g>${a}</g>
      <g transform="translate(16, 16) scale(${o})">${n}</g>
    </svg>`;return IZ(l,e)}const cV=Symbol("ElementCursorsMap");function BIe(t,e){R2(t)[0]=e,u7(t,e)}function u7(t,e){const n=R2(t);n[1]=n[0],n[0]=e,t.style.cursor=(e instanceof Ws?e:Ws.getDefinedCursor("auto")).getStyleProperty()}function Kn(t){u7(t,R2(t)[1])}function Rn(t){u7(t,Ws.getDefinedCursor("none"))}function R2(t){let e=R2[cV];e instanceof WeakMap||(e=new WeakMap,Object.defineProperty(R2,cV,{value:e}));let n=e.get(t);return n||(n=[null,null],e.set(t,n)),n}[...OIe,...EIe];function np(t){return Mt.toolGroups.find(e=>e.id===t)}const{Active:nv,Passive:S8,Enabled:T8,Disabled:E8}=vr,$Ie=[{mouseButton:yu.Primary}];class f7{constructor(e){this.viewportsInfo=[],this.toolOptions={},this.currentActivePrimaryToolName=null,this.prevActivePrimaryToolName=null,this.restoreToolOptions={},this._toolInstances={},this.id=e}getViewportIds(){return this.viewportsInfo.map(({viewportId:e})=>e)}getViewportsInfo(){return this.viewportsInfo.slice()}getToolInstance(e){const n=this._toolInstances[e];if(!n){console.warn(`'${e}' is not registered with this toolGroup (${this.id}).`);return}return n}getToolInstances(){return this._toolInstances}hasTool(e){return!!this._toolInstances[e]}addTool(e,n={}){const r=Mt.tools[e],i=typeof e<"u"&&e!=="",a=this.toolOptions[e];if(!i){console.warn("Tool with configuration did not produce a toolName: ",n);return}if(!r){console.warn(`'${e}' is not registered with the library. You need to use cornerstoneTools.addTool to register it.`);return}if(a){console.warn(`'${e}' is already registered for ToolGroup ${this.id}.`);return}const{toolClass:o}=r,s={name:e,toolGroupId:this.id,configuration:n},l=new o(s);this._toolInstances[e]=l}addToolInstance(e,n,r={}){let i=Mt.tools[e]?.toolClass;if(!i){const a=Mt.tools[n].toolClass;class o extends a{}o.toolName=e,i=o,Mt.tools[e]={toolClass:o}}this.addTool(i.toolName,r)}addViewport(e,n){if(typeof e!="string")throw new Error("viewportId must be defined and be a string");const r=this._findRenderingEngine(e,n);this.viewportsInfo.some(({viewportId:o})=>o===e)||this.viewportsInfo.push({viewportId:e,renderingEngineId:r});const i=this.getActivePrimaryMouseButtonTool();this.setViewportsCursorByToolName(i);const a={toolGroupId:this.id,viewportId:e,renderingEngineId:r};Ct(St,ee.TOOLGROUP_VIEWPORT_ADDED,a)}removeViewports(e,n){const r=[];if(this.viewportsInfo.forEach((a,o)=>{let s=!1;a.renderingEngineId===e&&(s=!0,n&&a.viewportId!==n&&(s=!1)),s&&r.push(o)}),r.length)for(let a=r.length-1;a>=0;a--)this.viewportsInfo.splice(r[a],1);const i={toolGroupId:this.id,viewportId:n,renderingEngineId:e};Ct(St,ee.TOOLGROUP_VIEWPORT_REMOVED,i)}setActiveStrategy(e,n){const r=this._toolInstances[e];if(r===void 0){console.warn(`Tool ${e} not added to toolGroup, can't set tool configuration.`);return}r.setActiveStrategy(n)}setToolMode(e,n,r={}){if(!e){console.warn("setToolMode: toolName must be defined");return}if(n===vr.Active){this.setToolActive(e,r||this.restoreToolOptions[e]);return}if(n===vr.Passive){this.setToolPassive(e);return}if(n===vr.Enabled){this.setToolEnabled(e);return}if(n===vr.Disabled){this.setToolDisabled(e);return}console.warn("setToolMode: mode must be defined")}setToolActive(e,n={}){const r=this._toolInstances[e];if(r===void 0){console.warn(`Tool ${e} not added to toolGroup, can't set tool mode.`);return}if(!r){console.warn(`'${e}' instance ${r} is not registered with this toolGroup, can't set tool mode.`);return}const i=this.toolOptions[e]?this.toolOptions[e].bindings:[],a=n.bindings?n.bindings:[],s={bindings:[...i,...a].reduce((c,f)=>{const u=f.numTouchPoints!==void 0,d=f.mouseButton!==void 0;return!c.some(h=>_8(h,f))&&(u||d)&&c.push(f),c},[]),mode:nv};if(this.toolOptions[e]=s,this._toolInstances[e].mode=nv,this._hasMousePrimaryButtonBinding(n))this.setViewportsCursorByToolName(e);else if(!this.getActivePrimaryMouseButtonTool()){const f=Ws.getDefinedCursor("default");this._setCursorForViewports(f)}this._hasMousePrimaryButtonBinding(n)&&(this.prevActivePrimaryToolName===null?this.prevActivePrimaryToolName=e:this.prevActivePrimaryToolName=this.currentActivePrimaryToolName,this.currentActivePrimaryToolName=e),typeof r.onSetToolActive=="function"&&r.onSetToolActive(),this._renderViewports();const l={toolGroupId:this.id,toolName:e,toolBindingsOptions:n};Ct(St,ee.TOOL_ACTIVATED,l),this._triggerToolModeChangedEvent(e,nv,n)}setToolPassive(e,n){const r=this._toolInstances[e];if(r===void 0){console.warn(`Tool ${e} not added to toolGroup, can't set tool mode.`);return}const i=this.getToolOptions(e),a=Object.assign({bindings:i?i.bindings:[]},i,{mode:S8}),o=Array.isArray(n?.removeAllBindings)?n.removeAllBindings:this.getDefaultPrimaryBindings();a.bindings=a.bindings.filter(l=>n?.removeAllBindings!==!0&&!o.some(c=>_8(l,c)));let s=S8;a.bindings.length!==0&&(s=nv,a.mode=s),this.toolOptions[e]=a,r.mode=s,typeof r.onSetToolPassive=="function"&&r.onSetToolPassive(),this._renderViewports(),this._triggerToolModeChangedEvent(e,S8)}setToolEnabled(e){const n=this._toolInstances[e];if(n===void 0){console.warn(`Tool ${e} not added to toolGroup, can't set tool mode.`);return}const r={bindings:[],mode:T8};this.toolOptions[e]=r,n.mode=T8,typeof n.onSetToolEnabled=="function"&&n.onSetToolEnabled(),this._renderViewports(),this._triggerToolModeChangedEvent(e,T8)}setToolDisabled(e){const n=this._toolInstances[e];if(n===void 0){console.warn(`Tool ${e} not added to toolGroup, can't set tool mode.`);return}const r={bindings:[],mode:E8};this.restoreToolOptions[e]=this.toolOptions[e],this.toolOptions[e]=r,n.mode=E8,typeof n.onSetToolDisabled=="function"&&n.onSetToolDisabled(),this._renderViewports(),this._triggerToolModeChangedEvent(e,E8)}getToolOptions(e){const n=this.toolOptions[e];if(n!==void 0)return n}getActivePrimaryMouseButtonTool(){return Object.keys(this.toolOptions).find(e=>{const n=this.toolOptions[e];return n.mode===nv&&this._hasMousePrimaryButtonBinding(n)})}setViewportsCursorByToolName(e,n){const r=this._getCursor(e,n);this._setCursorForViewports(r)}_getCursor(e,n){let r,i;return n&&(r=`${e}.${n}`,i=Eb.getDefinedCursor(r,!0),i)||(r=`${e}`,i=Eb.getDefinedCursor(r,!0),i)||(r=e,i=Eb.getDefinedCursor(r,!0),i)?i:Ws.getDefinedCursor("default")}_setCursorForViewports(e){Yr.getRuntimeSettings().get("useCursors")&&this.viewportsInfo.forEach(({renderingEngineId:r,viewportId:i})=>{const a=$m(i,r);if(!a)return;const{viewport:o}=a;BIe(o.element,e)})}setToolConfiguration(e,n,r){const i=this._toolInstances[e];if(i===void 0)return console.warn(`Tool ${e} not present, can't set tool configuration.`),!1;let a;return r?a=n:a=Object.assign(i.configuration,n),i.configuration=a,typeof i.onSetToolConfiguration=="function"&&i.onSetToolConfiguration(),this._renderViewports(),!0}getDefaultMousePrimary(){return yu.Primary}getDefaultPrimaryBindings(){return $Ie}getToolConfiguration(e,n){if(this._toolInstances[e]===void 0){console.warn(`Tool ${e} not present, can't set tool configuration.`);return}const r=TIe(this._toolInstances[e].configuration,n)||this._toolInstances[e].configuration;return fc(r)}getPrevActivePrimaryToolName(){return this.prevActivePrimaryToolName}setActivePrimaryTool(e){const n=this.getCurrentActivePrimaryToolName();this.setToolDisabled(n),this.setToolActive(e,{bindings:[{mouseButton:yu.Primary}]})}getCurrentActivePrimaryToolName(){return this.currentActivePrimaryToolName}clone(e,n=null){let r=np(e);return r?(console.debug(`ToolGroup ${e} already exists`),r):(r=new f7(e),Mt.toolGroups.push(r),n=n??(()=>!0),Object.keys(this._toolInstances).filter(n).forEach(i=>{const a=this._toolInstances[i],o=this.toolOptions[i],s=a.mode;r.addTool(i),r.setToolMode(i,s,{bindings:o.bindings??[]})}),r)}_hasMousePrimaryButtonBinding(e){const n=this.getDefaultPrimaryBindings();return e?.bindings?.some(r=>n.some(i=>_8(r,i)))}_renderViewports(){this.viewportsInfo.forEach(({renderingEngineId:e,viewportId:n})=>{$f(e).renderViewport(n)})}_triggerToolModeChangedEvent(e,n,r){const i={toolGroupId:this.id,toolName:e,mode:n,toolBindingsOptions:r};Ct(St,ee.TOOL_MODE_CHANGED,i)}_findRenderingEngine(e,n){const r=Fl();if(r?.length===0)throw new Error("No rendering engines found.");if(n)return n;const i=r.filter(a=>a.getViewport(e));if(i.length===0){if(r.length===1)return r[0].id;throw new Error("No rendering engines found that contain the viewport with the same viewportId, you must specify a renderingEngineId.")}if(i.length>1)throw new Error("Multiple rendering engines found that contain the viewport with the same viewportId, you must specify a renderingEngineId.");return i[0].id}}function _8(t,e){return t.mouseButton!==e.mouseButton||t.numTouchPoints!==e.numTouchPoints?!1:t.modifierKey===e.modifierKey}function GIe(t){if(Mt.toolGroups.some(r=>r.id===t)){console.warn(`'${t}' already exists.`);return}const n=new f7(t);return Mt.toolGroups.push(n),n}function uV(t){const e=Mt.toolGroups.findIndex(n=>n.id===t);e>-1&&Mt.toolGroups.splice(e,1)}function qa(t,e){e||(e=Fl().find(r=>r.getViewports().find(i=>i.id===t))?.id);const n=Mt.toolGroups.filter(r=>r.viewportsInfo.some(i=>i.renderingEngineId===e&&(!i.viewportId||i.viewportId===t)));if(n.length){if(n.length>1)throw new Error(`Multiple tool groups found for renderingEngineId: ${e} and viewportId: ${t}. You should only
      have one tool group per viewport in a renderingEngine.`);return n[0]}}const jIe=[vr.Active,vr.Passive,vr.Enabled];function zIe(t){return Mt.toolGroups.filter(({toolOptions:e})=>{const n=Object.keys(e);for(let r=0;r<n.length;r++)if(t===n[r]&&e[t]&&jIe.includes(e[t].mode))return!0;return!1})}function RZ(t,e){const n=et(e),{renderingEngine:r,viewportId:i}=n,a=ee.ANNOTATION_ADDED,o={annotation:t,viewportId:i,renderingEngineId:r.id};Ct(St,a,o)}function AZ(t){const{toolName:e}=t.metadata,n=zIe(e);if(!n.length)return;const r=[];n.forEach(o=>{o.viewportsInfo.forEach(s=>{const{renderingEngineId:l,viewportId:c}=s,{FrameOfReferenceUID:f}=$m(c,l);t.metadata.FrameOfReferenceUID===f&&r.push(s)})});const i=ee.ANNOTATION_ADDED,a={annotation:t};if(!r.length){Ct(St,i,a);return}r.forEach(({renderingEngineId:o,viewportId:s})=>{a.viewportId=s,a.renderingEngineId=o,Ct(St,i,a)})}function uC(t){const e=ee.ANNOTATION_REMOVED;Ct(St,e,t)}function Fn(t,e,n=wn.HandlesUpdated){const r=e&&et(e),{viewportId:i,renderingEngineId:a}=r||{},o=ee.ANNOTATION_MODIFIED;Ct(St,o,{annotation:t,viewportId:i,renderingEngineId:a,changeType:n})}function Wr(t){PZ({annotation:t})}function fC(t,e=!1){PZ({annotation:t,contourHoleProcessingEnabled:e})}function PZ(t){const e=ee.ANNOTATION_COMPLETED;Ct(St,e,t)}const WIe=Object.freeze(Object.defineProperty({__proto__:null,triggerAnnotationAddedForElement:RZ,triggerAnnotationAddedForFOR:AZ,triggerAnnotationCompleted:Wr,triggerAnnotationModified:Fn,triggerAnnotationRemoved:uC,triggerContourAnnotationCompleted:fC},Symbol.toStringTag,{value:"Module"}));let NZ;function Eu(){return NZ}function d7(t){NZ=t}function Wi(t,e){const n=Eu(),r=n.getGroupKey(e);return n.getAnnotations(r,t)}function co(t){return Eu().getAnnotation(t)}function dC(){return Eu().getAllAnnotations()}function hC(t){const{annotationUID:e,parentAnnotationUID:n}=t;if(!n)return;const r=co(n),i=r.childAnnotationUIDs.indexOf(e);r.childAnnotationUIDs.splice(i,1),t.parentAnnotationUID=void 0}function hy(t,e){const{annotationUID:n}=t,{annotationUID:r}=e;hC(e),t.childAnnotationUIDs||(t.childAnnotationUIDs=[]),!t.childAnnotationUIDs.includes(r)&&(t.childAnnotationUIDs.push(r),e.parentAnnotationUID=n)}function LZ(t){return t.parentAnnotationUID?co(t.parentAnnotationUID):void 0}function py(t){return t.childAnnotationUIDs?.map(e=>co(e))??[]}function hr(t,e){t.annotationUID||(t.annotationUID=or());const n=Eu();if(e instanceof HTMLDivElement){const r=n.getGroupKey(e);n.addAnnotation(t,r),RZ(t,e)}else n.addAnnotation(t,void 0),AZ(t);return t.annotationUID}function HIe(t,e){const n=Eu(),r=n.getGroupKey(e);return n.getNumberOfAnnotations(r,t)}function Cr(t){if(!t)return;const e=Eu(),n=e.getAnnotation(t);n&&(n.childAnnotationUIDs?.forEach(r=>Cr(r)),e.removeAnnotation(t),uC({annotation:n,annotationManagerUID:e.uid}))}function KIe(){const t=Eu(),e=t.removeAllAnnotations();for(const n of e)uC({annotation:n,annotationManagerUID:t.uid})}function qIe(t,e){const n=Eu(),r=n.getGroupKey(e),i=n.removeAnnotations(r,t);for(const a of i)uC({annotation:a,annotationManagerUID:n.uid})}function kZ(t){let e=t;for(;e;)e.invalidated=!0,e=e.parentAnnotationUID?co(e.parentAnnotationUID):void 0}const XIe=Object.freeze(Object.defineProperty({__proto__:null,addAnnotation:hr,addChildAnnotation:hy,clearParentAnnotation:hC,getAllAnnotations:dC,getAnnotation:co,getAnnotationManager:Eu,getAnnotations:Wi,getChildAnnotations:py,getNumberOfAnnotations:HIe,getParentAnnotation:LZ,invalidateAnnotation:kZ,removeAllAnnotations:KIe,removeAnnotation:Cr,removeAnnotations:qIe,setAnnotationManager:d7},Symbol.toStringTag,{value:"Module"}));function Xr(t){const e=t.toolName;if(!e)throw new Error(`No Tool Found for the ToolClass ${t.name}`);Mt.tools[e]||(Mt.tools[e]={toolClass:t})}function pC(t){return!!(t&&Mt.tools[t])}function dp(t,e){const n=e||t.currentTarget,{viewport:r}=et(n)||{};if(!r)return;const i=ZIe(t),a=JIe(t),o=YIe(n,a),s=r.canvasToWorld(o);return{page:a,client:i,canvas:o,world:s}}function YIe(t,e){const n=t.getBoundingClientRect();return[e[0]-n.left-window.pageXOffset,e[1]-n.top-window.pageYOffset]}function JIe(t){return[t.pageX,t.pageY]}function ZIe(t){return[t.clientX,t.clientY]}function VZ(t){const e=t.currentTarget,{viewportId:n,renderingEngineId:r}=et(e),i=dp(t,e),a={page:[0,0],client:[0,0],canvas:[0,0],world:[0,0,0]},o={event:t,eventName:ee.MOUSE_DOUBLE_CLICK,viewportId:n,renderingEngineId:r,camera:{},element:e,startPoints:i,lastPoints:i,currentPoints:i,deltaPoints:a};!Ct(e,ee.MOUSE_DOUBLE_CLICK,o)&&(t.stopImmediatePropagation(),t.preventDefault())}const fV=ee.MOUSE_MOVE;function gy(t){const e=t.currentTarget,n=et(e);if(!n)return;const{renderingEngineId:r,viewportId:i}=n,a=dp(t);!Ct(e,fV,{renderingEngineId:r,viewportId:i,camera:{},element:e,currentPoints:a,eventName:fV,event:t})&&(t.stopImmediatePropagation(),t.preventDefault())}const{MOUSE_DOWN:dV,MOUSE_DOWN_ACTIVATE:QIe,MOUSE_CLICK:eRe,MOUSE_UP:tRe,MOUSE_DRAG:hV}=ee,nRe=400,rRe=150,iRe=3,aRe={mouseButton:void 0,element:null,renderingEngineId:void 0,viewportId:void 0,isClickEvent:!0,clickDelay:200,preventClickTimeout:null,startPoints:{page:[0,0],client:[0,0],canvas:[0,0],world:[0,0,0]},lastPoints:{page:[0,0],client:[0,0],canvas:[0,0],world:[0,0,0]}};let yn={mouseButton:void 0,renderingEngineId:void 0,viewportId:void 0,isClickEvent:!0,clickDelay:200,element:null,preventClickTimeout:null,startPoints:{page:[0,0],client:[0,0],canvas:[0,0],world:[0,0,0]},lastPoints:{page:[0,0],client:[0,0],canvas:[0,0],world:[0,0,0]}};const ya={doubleClickTimeout:null,mouseDownEvent:null,mouseUpEvent:null,ignoreDoubleClick:!1};function FZ(t){if(ya.doubleClickTimeout){if(t.buttons===ya.mouseDownEvent.buttons)return;ya.mouseDownEvent=t,z3();return}ya.doubleClickTimeout=setTimeout(z3,t.buttons===1?nRe:rRe),ya.mouseDownEvent=t,ya.ignoreDoubleClick=!1,yn.element=t.currentTarget,yn.mouseButton=t.buttons;const e=et(yn.element),{renderingEngineId:n,viewportId:r}=e;yn.renderingEngineId=n,yn.viewportId=r,yn.preventClickTimeout=setTimeout(sRe,yn.clickDelay),yn.element.removeEventListener("mousemove",gy);const i=dp(t,yn.element);yn.startPoints=r0(i),yn.lastPoints=r0(i),document.addEventListener("mouseup",h7),document.addEventListener("mousemove",UZ)}function oRe(t){const e=gC(yn.startPoints,yn.startPoints),n={event:t,eventName:dV,element:yn.element,mouseButton:yn.mouseButton,renderingEngineId:yn.renderingEngineId,viewportId:yn.viewportId,camera:{},startPoints:yn.startPoints,lastPoints:yn.startPoints,currentPoints:yn.startPoints,deltaPoints:e};yn.lastPoints=r0(n.lastPoints),Ct(n.element,dV,n)&&Ct(n.element,QIe,n)}function UZ(t){if(!et(yn.element)?.viewport)return;const n=dp(t,yn.element),r=jZ(yn.element,yn.lastPoints),i=gC(n,r);if(ya.doubleClickTimeout)if($Z(i.canvas))z3();else return;const a={event:t,eventName:hV,mouseButton:yn.mouseButton,renderingEngineId:yn.renderingEngineId,viewportId:yn.viewportId,camera:{},element:yn.element,startPoints:r0(yn.startPoints),lastPoints:r0(r),currentPoints:n,deltaPoints:i};!Ct(yn.element,hV,a)&&(t.stopImmediatePropagation(),t.preventDefault()),yn.lastPoints=r0(n)}function h7(t){if(clearTimeout(yn.preventClickTimeout),ya.doubleClickTimeout)ya.mouseUpEvent?K6():(ya.mouseUpEvent=t,yn.element.addEventListener("mousemove",BZ));else{const e=yn.isClickEvent?eRe:tRe,n=dp(t,yn.element),r=gC(n,yn.lastPoints),i={event:t,eventName:e,mouseButton:yn.mouseButton,element:yn.element,renderingEngineId:yn.renderingEngineId,viewportId:yn.viewportId,camera:{},startPoints:r0(yn.startPoints),lastPoints:r0(yn.lastPoints),currentPoints:n,deltaPoints:r};Ct(i.element,e,i),K6()}document.removeEventListener("mousemove",UZ)}function BZ(t){const e=dp(t,yn.element),n=jZ(yn.element,yn.lastPoints),r=gC(e,n);$Z(r.canvas)&&(z3(),gy(t))}function $Z(t){return Math.abs(t[0])+Math.abs(t[1])>iRe}function sRe(){yn.isClickEvent=!1}function z3(){ya.ignoreDoubleClick=!0;const t=ya.mouseDownEvent,e=ya.mouseUpEvent;GZ(),oRe(t),e&&h7(e)}function GZ(){ya.doubleClickTimeout&&(clearTimeout(ya.doubleClickTimeout),ya.doubleClickTimeout=null),ya.mouseDownEvent=null,ya.mouseUpEvent=null}function K6(){document.removeEventListener("mouseup",h7),yn.element?.removeEventListener("mousemove",BZ),yn.element?.addEventListener("mousemove",gy),GZ(),yn=JSON.parse(JSON.stringify(aRe))}function r0(t){return JSON.parse(JSON.stringify(t))}function jZ(t,e){const{viewport:n}=et(t)||{};if(!n)return e;const r=n.canvasToWorld(e.canvas);return{page:e.page,client:e.client,canvas:e.canvas,world:r}}function gC(t,e){return!t||!e?{page:[0,0],client:[0,0],canvas:[0,0],world:[0,0,0]}:{page:D8(t.page,e.page),client:D8(t.client,e.client),canvas:D8(t.canvas,e.canvas),world:lRe(t.world,e.world)}}function D8(t,e){return[t[0]-e[0],t[1]-e[1]]}function lRe(t,e){return[t[0]-e[0],t[1]-e[1],t[2]-e[2]]}function cRe(){return yn.mouseButton}function zZ(t){ya.ignoreDoubleClick?(ya.ignoreDoubleClick=!1,t.stopImmediatePropagation(),t.preventDefault()):K6()}function WZ(t){t.removeEventListener("dblclick",VZ),t.removeEventListener("mousedown",FZ),t.removeEventListener("mousemove",gy),t.removeEventListener("dblclick",zZ,{capture:!0})}function uRe(t){WZ(t),t.addEventListener("dblclick",VZ),t.addEventListener("mousedown",FZ),t.addEventListener("mousemove",gy),t.addEventListener("dblclick",zZ,{capture:!0})}const HZ={enable:uRe,disable:WZ},fRe=2e3,gm={mouse:0,touch:1};let pV,gV;function KZ(t,e){const n=Date.now();if(t!==pV){if(n-gV<=fRe)return e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),!1;pV=t}gV=n}const qZ=KZ.bind(null,gm.mouse),XZ=KZ.bind(null,gm.touch);function mV(t,e,n){const r=n?qZ:XZ;e.forEach(function(i){t.addEventListener(i,r,{passive:!1})})}function vV(t,e,n){const r=n?qZ:XZ;e.forEach(function(i){t.removeEventListener(i,r)})}const YZ=["mousedown","mouseup","mousemove"],JZ=["touchstart","touchend"];function ZZ(t){vV(t,YZ,gm.mouse),vV(t,JZ,gm.touch)}function dRe(t){ZZ(t),mV(t,YZ,gm.mouse),mV(t,JZ,gm.touch)}const QZ={enable:dRe,disable:ZZ};function mC(t,e){const n=e||t.currentTarget,r=t.type==="touchend"?t.changedTouches:t.touches;return Object.keys(r).map(i=>{const a=gRe(r[i]),o=pRe(r[i]),s=hRe(n,o),{viewport:l}=et(n),c=l.canvasToWorld(s);return{page:o,client:a,canvas:s,world:c,touch:{identifier:i,radiusX:r[i].radiusX,radiusY:r[i].radiusY,force:r[i].force,rotationAngle:r[i].rotationAngle}}})}function hRe(t,e){const n=t.getBoundingClientRect();return[e[0]-n.left-window.pageXOffset,e[1]-n.top-window.pageYOffset]}function pRe(t){return[t.pageX,t.pageY]}function gRe(t){return[t.clientX,t.clientY]}function q6(t,e){const n=W3(t),r=W3(e);return{page:O8(n.page,r.page),client:O8(n.client,r.client),canvas:O8(n.canvas,r.canvas),world:mRe(n.world,r.world)}}function eQ(t,e){const n=W3(t),r=W3(e);return{page:Qg(n.page,r.page),client:Qg(n.client,r.client),canvas:Qg(n.canvas,r.canvas),world:tQ(n.world,r.world)}}function X6(t,e){const n=xV(t),r=xV(e);return{page:n.page-r.page,client:n.client-r.client,canvas:n.canvas-r.canvas,world:n.world-r.world}}function _f(t){return JSON.parse(JSON.stringify(t))}function yV(t){return JSON.parse(JSON.stringify(t))}function W3(t){return t.reduce((e,n)=>({page:[e.page[0]+n.page[0]/t.length,e.page[1]+n.page[1]/t.length],client:[e.client[0]+n.client[0]/t.length,e.client[1]+n.client[1]/t.length],canvas:[e.canvas[0]+n.canvas[0]/t.length,e.canvas[1]+n.canvas[1]/t.length],world:[e.world[0]+n.world[0]/t.length,e.world[1]+n.world[1]/t.length,e.world[2]+n.world[2]/t.length]}),{page:[0,0],client:[0,0],canvas:[0,0],world:[0,0,0]})}function uu(t){return t.reduce((e,n)=>({page:[e.page[0]+n.page[0]/t.length,e.page[1]+n.page[1]/t.length],client:[e.client[0]+n.client[0]/t.length,e.client[1]+n.client[1]/t.length],canvas:[e.canvas[0]+n.canvas[0]/t.length,e.canvas[1]+n.canvas[1]/t.length],world:[e.world[0]+n.world[0]/t.length,e.world[1]+n.world[1]/t.length,e.world[2]+n.world[2]/t.length],touch:{identifier:null,radiusX:e.touch.radiusX+n.touch.radiusX/t.length,radiusY:e.touch.radiusY+n.touch.radiusY/t.length,force:e.touch.force+n.touch.force/t.length,rotationAngle:e.touch.rotationAngle+n.touch.rotationAngle/t.length}}),{page:[0,0],client:[0,0],canvas:[0,0],world:[0,0,0],touch:{identifier:null,radiusX:0,radiusY:0,force:0,rotationAngle:0}})}function O8(t,e){return[t[0]-e[0],t[1]-e[1]]}function mRe(t,e){return[t[0]-e[0],t[1]-e[1],t[2]-e[2]]}function xV(t){const e=[];for(let n=0;n<t.length;n++)for(let r=0;r<t.length;r++)n<r&&e.push({page:Qg(t[n].page,t[r].page),client:Qg(t[n].client,t[r].client),canvas:Qg(t[n].canvas,t[r].canvas),world:tQ(t[n].world,t[r].world)});return e.reduce((n,r)=>({page:n.page+r.page/e.length,client:n.client+r.client/e.length,canvas:n.canvas+r.canvas/e.length,world:n.world+r.world/e.length}),{page:0,client:0,canvas:0,world:0})}function Qg(t,e){return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2))}function tQ(t,e){return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2)+Math.pow(t[2]-e[2],2))}Yr.getRuntimeSettings();const{TOUCH_START:bV,TOUCH_START_ACTIVATE:vRe,TOUCH_PRESS:wV,TOUCH_DRAG:CV,TOUCH_END:SV,TOUCH_TAP:TV,TOUCH_SWIPE:M8}=ee,A2={page:[0,0],client:[0,0],canvas:[0,0],world:[0,0,0]},H3={page:0,client:0,canvas:0,world:0},nQ={renderingEngineId:void 0,viewportId:void 0,element:null,startPointsList:[{...A2,touch:null}],lastPointsList:[{...A2,touch:null}],isTouchStart:!1,startTime:null,pressTimeout:null,pressDelay:700,pressMaxDistance:5,accumulatedDistance:H3,swipeDistanceThreshold:48,swiped:!1,swipeToleranceMs:300},rQ={renderingEngineId:void 0,viewportId:void 0,element:null,startPointsList:[{...A2,touch:null}],taps:0,tapTimeout:null,tapMaxDistance:24,tapToleranceMs:300};let qt=JSON.parse(JSON.stringify(nQ)),$i=JSON.parse(JSON.stringify(rQ));function y0(t,e,n){return Ct(t,e,n)}function iQ(t){qt.element=t.currentTarget;const e=et(qt.element),{renderingEngineId:n,viewportId:r}=e;qt.renderingEngineId=n,qt.viewportId=r,!qt.isTouchStart&&(clearTimeout(qt.pressTimeout),qt.pressTimeout=setTimeout(()=>yRe(t),qt.pressDelay),xRe(t),document.addEventListener("touchmove",aQ),document.addEventListener("touchend",oQ))}function yRe(t){if(qt.accumulatedDistance.canvas>qt.pressMaxDistance)return;const n={event:t,eventName:wV,renderingEngineId:qt.renderingEngineId,viewportId:qt.viewportId,camera:{},element:qt.element,startPointsList:_f(qt.startPointsList),lastPointsList:_f(qt.lastPointsList),startPoints:yV(uu(qt.startPointsList)),lastPoints:yV(uu(qt.lastPointsList))};y0(n.element,wV,n)}function xRe(t){qt.isTouchStart=!0,qt.startTime=new Date;const e=mC(t,qt.element),n=uu(e),r=A2,i=H3,a={event:t,eventName:bV,element:qt.element,renderingEngineId:qt.renderingEngineId,viewportId:qt.viewportId,camera:{},startPointsList:e,lastPointsList:e,currentPointsList:e,startPoints:n,lastPoints:n,currentPoints:n,deltaPoints:r,deltaDistance:i};qt.startPointsList=_f(a.startPointsList),qt.lastPointsList=_f(a.lastPointsList),y0(a.element,bV,a)&&y0(a.element,vRe,a)}function aQ(t){const e=mC(t,qt.element),n=sQ(qt.element,qt.lastPointsList),r=e.length===n.length?q6(e,n):A2,i=e.length===n.length?X6(e,n):H3,a=e.length===n.length?eQ(e,qt.lastPointsList):H3;qt.accumulatedDistance={page:qt.accumulatedDistance.page+a.page,client:qt.accumulatedDistance.client+a.client,canvas:qt.accumulatedDistance.canvas+a.canvas,world:qt.accumulatedDistance.world+a.world};const o={event:t,eventName:CV,renderingEngineId:qt.renderingEngineId,viewportId:qt.viewportId,camera:{},element:qt.element,startPoints:uu(qt.startPointsList),lastPoints:uu(n),currentPoints:uu(e),startPointsList:_f(qt.startPointsList),lastPointsList:_f(n),currentPointsList:e,deltaPoints:r,deltaDistance:i};y0(qt.element,CV,o),wRe(t,r),qt.lastPointsList=_f(e)}function oQ(t){clearTimeout(qt.pressTimeout);const e=mC(t,qt.element),n=sQ(qt.element,qt.lastPointsList),r=e.length===n.length?q6(e,n):q6(e,e),i=e.length===n.length?X6(e,n):X6(e,e),a={event:t,eventName:SV,element:qt.element,renderingEngineId:qt.renderingEngineId,viewportId:qt.viewportId,camera:{},startPointsList:_f(qt.startPointsList),lastPointsList:_f(n),currentPointsList:e,startPoints:uu(qt.startPointsList),lastPoints:uu(n),currentPoints:uu(e),deltaPoints:r,deltaDistance:i};y0(a.element,SV,a),bRe(t),qt=JSON.parse(JSON.stringify(nQ)),document.removeEventListener("touchmove",aQ),document.removeEventListener("touchend",oQ)}function bRe(t){const e=new Date().getTime(),n=qt.startTime.getTime();if(e-n>$i.tapToleranceMs||($i.taps===0&&($i.element=qt.element,$i.renderingEngineId=qt.renderingEngineId,$i.viewportId=qt.viewportId,$i.startPointsList=qt.startPointsList),$i.taps>0&&!($i.element==qt.element&&$i.renderingEngineId==qt.renderingEngineId&&$i.viewportId==qt.viewportId)))return;const r=mC(t,$i.element);eQ(r,$i.startPointsList).canvas>$i.tapMaxDistance||(clearTimeout($i.tapTimeout),$i.taps+=1,$i.tapTimeout=setTimeout(()=>{const a={event:t,eventName:TV,element:$i.element,renderingEngineId:$i.renderingEngineId,viewportId:$i.viewportId,camera:{},currentPointsList:r,currentPoints:uu(r),taps:$i.taps};y0(a.element,TV,a),$i=JSON.parse(JSON.stringify(rQ))},$i.tapToleranceMs))}function wRe(t,e){const n=new Date().getTime(),r=qt.startTime.getTime();if(qt.swiped||n-r>qt.swipeToleranceMs)return;const[i,a]=e.canvas,o={event:t,eventName:M8,renderingEngineId:qt.renderingEngineId,viewportId:qt.viewportId,camera:{},element:qt.element,swipe:null};Math.abs(i)>qt.swipeDistanceThreshold&&(o.swipe=i>0?Rh.RIGHT:Rh.LEFT,y0(o.element,M8,o),qt.swiped=!0),Math.abs(a)>qt.swipeDistanceThreshold&&(o.swipe=a>0?Rh.DOWN:Rh.UP,y0(o.element,M8,o),qt.swiped=!0)}function sQ(t,e){const{viewport:n}=et(t);return e.map(r=>{const i=n.canvasToWorld(r.canvas);return{page:r.page,client:r.client,canvas:r.canvas,world:i,touch:r.touch}})}function lQ(t){QZ.disable(t),t.removeEventListener("touchstart",iQ)}function CRe(t){lQ(t),QZ.enable(t),t.addEventListener("touchstart",iQ,{passive:!1})}const cQ={enable:CRe,disable:lQ},EV=10,_V=40,DV=800;function SRe(t){let e=0,n=0,r=0,i=0;return"detail"in t&&(n=t.detail),"wheelDelta"in t&&(n=-t.wheelDelta/120),"wheelDeltaY"in t&&(n=-t.wheelDeltaY/120),"wheelDeltaX"in t&&(e=-t.wheelDeltaX/120),r=e*EV,i=n*EV,"deltaY"in t&&(i=t.deltaY),"deltaX"in t&&(r=t.deltaX),(r||i)&&t.deltaMode&&(t.deltaMode===1?(r*=_V,i*=_V):(r*=DV,i*=DV)),r&&!e&&(e=r<1?-1:1),i&&!n&&(n=i<1?-1:1),{spinX:e,spinY:n,pixelX:r,pixelY:i}}function uQ(t){const e=t.currentTarget,n=et(e),{renderingEngineId:r,viewportId:i}=n;if(t.deltaY>-1&&t.deltaY<1)return;t.preventDefault();const{spinX:a,spinY:o,pixelX:s,pixelY:l}=SRe(t),c=o<0?-1:1,f={event:t,eventName:ee.MOUSE_WHEEL,renderingEngineId:r,viewportId:i,element:e,camera:{},detail:t,wheel:{spinX:a,spinY:o,pixelX:s,pixelY:l,direction:c},points:dp(t)};Ct(e,ee.MOUSE_WHEEL,f)}function TRe(t){fQ(t),t.addEventListener("wheel",uQ,{passive:!1})}function fQ(t){t.removeEventListener("wheel",uQ)}const dQ={enable:TRe,disable:fQ},ERe={renderingEngineId:void 0,viewportId:void 0,key:void 0,keyCode:void 0,element:null};let ta={renderingEngineId:void 0,viewportId:void 0,key:void 0,keyCode:void 0,element:null};function vC(t){ta.element=t.currentTarget;const e=et(ta.element),{renderingEngineId:n,viewportId:r}=e;ta.renderingEngineId=n,ta.viewportId=r,ta.key=t.key,ta.keyCode=t.keyCode,t.preventDefault();const i={renderingEngineId:ta.renderingEngineId,viewportId:ta.viewportId,element:ta.element,key:ta.key,keyCode:ta.keyCode};Ct(i.element,ee.KEY_DOWN,i),document.addEventListener("keyup",hQ),document.addEventListener("visibilitychange",p7),ta.element.removeEventListener("keydown",vC)}function p7(){document.removeEventListener("visibilitychange",p7),document.visibilityState==="hidden"&&pQ()}function hQ(t){const e={renderingEngineId:ta.renderingEngineId,viewportId:ta.viewportId,element:ta.element,key:ta.key,keyCode:ta.keyCode};document.removeEventListener("keyup",hQ),document.removeEventListener("visibilitychange",p7),ta.element.addEventListener("keydown",vC),ta=structuredClone(ERe),Ct(e.element,ee.KEY_UP,e)}function _Re(){return ta.keyCode}function pQ(){ta.keyCode=void 0}function DRe(t){gQ(t),t.addEventListener("keydown",vC)}function gQ(t){t.removeEventListener("keydown",vC)}const Wm={enable:DRe,disable:gQ,getModifierKey:_Re},{EPSILON:ig}=cp;function ORe(t,e,n=!1){let r=1/0,i=n?-1/0:0,a=1/0,o=n?-1/0:0,s=1/0,l=n?-1/0:0;const c=t[0]?.length===3;for(let f=0;f<t.length;f++){const u=t[f];r=Math.min(u[0],r),i=Math.max(u[0],i),a=Math.min(u[1],a),o=Math.max(u[1],o),c&&(s=Math.min(u[2]??s,s),l=Math.max(u[2]??l,l))}return e?(r=Math.max(n?e[0]+ig:0,r),i=Math.min(n?e[0]-ig:e[0]-1,i),a=Math.max(n?e[1]+ig:0,a),o=Math.min(n?e[1]-ig:e[1]-1,o),c&&e.length===3&&(s=Math.max(n?e[2]+ig:0,s),l=Math.min(n?e[2]-ig:e[2]-1,l))):n||(r=Math.max(0,r),i=Math.min(1/0,i),a=Math.max(0,a),o=Math.min(1/0,o),c&&(s=Math.max(0,s),l=Math.min(1/0,l))),c?[[r,i],[a,o],[s,l]]:[[r,i],[a,o],null]}function g7(t,e){return ORe(t,e,!1)}const m7=new Map,MRe=t=>{const e=m7.get(t);e&&(e.isDirty=!0)},IRe=t=>{const e=m7.get(t);return e&&!e.isDirty?e.indices:null},RRe=(t,e)=>{m7.set(t,{indices:e,isDirty:!1})};function Gf(t,e,n){const r={segmentationId:t,modifiedSlicesToUse:e,segmentIndex:n};MRe(t),Ct(St,ee.SEGMENTATION_DATA_MODIFIED,r)}function Hm(t){const e={segmentationId:t};Ct(St,ee.SEGMENTATION_MODIFIED,e)}function ARe(t){const e={segmentationId:t};Ct(St,ee.SEGMENTATION_REMOVED,e)}function Sv(t,e,n){const r={segmentationId:e,type:n,viewportId:t};Ct(St,ee.SEGMENTATION_REPRESENTATION_MODIFIED,r)}function OV(t,e,n){const r={viewportId:t,segmentationId:e,type:n};Ct(St,ee.SEGMENTATION_REPRESENTATION_REMOVED,r)}const PRe={renderOutline:!0,outlineWidthAutoGenerated:3,outlineWidth:1,outlineWidthInactive:1,outlineOpacity:1,outlineOpacityInactive:.85,outlineDash:void 0,outlineDashInactive:void 0,outlineDashAutoGenerated:"5,3",activeSegmentOutlineWidthDelta:0,renderFill:!0,fillAlpha:.5,fillAlphaInactive:.3,fillAlphaAutoGenerated:.3};function NRe(){return PRe}const LRe={renderOutline:!0,renderOutlineInactive:!0,outlineWidth:3,outlineWidthInactive:2,activeSegmentOutlineWidthDelta:0,renderFill:!0,renderFillInactive:!0,fillAlpha:.5,fillAlphaInactive:.4,outlineOpacity:1,outlineOpacityInactive:.85};function kRe(){return LRe}class VRe{constructor(){this.config={global:{},segmentations:{},viewportsStyle:{}}}setStyle(e,n){const{viewportId:r,segmentationId:i,type:a,segmentIndex:o}=e,s=this.getStyle(e);let l;if(!r&&!i?l={...s,...n}:l=this.copyActiveToInactiveIfNotProvided({...s,...n},a),!a)throw new Error("Type is required to set a style");if(r){this.config.viewportsStyle[r]||(this.config.viewportsStyle[r]={renderInactiveSegmentations:!1,representations:{}});const c=this.config.viewportsStyle[r].representations;if(i){c[i]||(c[i]={}),c[i][a]||(c[i][a]={});const f=c[i][a];o!==void 0?(f.perSegment||(f.perSegment={}),f.perSegment[o]=l):f.allSegments=l}else{const f="__allSegmentations__";c[f]||(c[f]={}),c[f][a]||(c[f][a]={}),c[f][a].allSegments=l}}else if(i){this.config.segmentations[i]||(this.config.segmentations[i]={}),this.config.segmentations[i][a]||(this.config.segmentations[i][a]={});const c=this.config.segmentations[i][a];o!==void 0?(c.perSegment||(c.perSegment={}),c.perSegment[o]=l):c.allSegments=l}else this.config.global[a]=l}copyActiveToInactiveIfNotProvided(e,n){const r={...e};if(n===pn.Labelmap){const i=r;i.renderOutlineInactive??=i.renderOutline,i.outlineWidthInactive??=i.outlineWidth,i.renderFillInactive??=i.renderFill,i.fillAlphaInactive??=i.fillAlpha,i.outlineOpacityInactive??=i.outlineOpacity}else if(n===pn.Contour){const i=r;i.outlineWidthInactive??=i.outlineWidth,i.outlineOpacityInactive??=i.outlineOpacity,i.outlineDashInactive??=i.outlineDash,i.renderOutlineInactive??=i.renderOutline,i.renderFillInactive??=i.renderFill,i.fillAlphaInactive??=i.fillAlpha}return r}getStyle(e){const{viewportId:n,segmentationId:r,type:i,segmentIndex:a}=e;let o=this.getDefaultStyle(i);if(this.config.global[i]&&(o={...o,...this.config.global[i]}),this.config.segmentations[r]?.[i]&&(o={...o,...this.config.segmentations[r][i].allSegments},a!==void 0&&this.config.segmentations[r][i].perSegment?.[a]&&(o={...o,...this.config.segmentations[r][i].perSegment[a]})),n&&this.config.viewportsStyle[n]){this.config.viewportsStyle[n].renderInactiveSegmentations;const s="__allSegmentations__";this.config.viewportsStyle[n].representations[s]?.[i]&&(o={...o,...this.config.viewportsStyle[n].representations[s][i].allSegments}),r&&this.config.viewportsStyle[n].representations[r]?.[i]&&(o={...o,...this.config.viewportsStyle[n].representations[r][i].allSegments},a!==void 0&&this.config.viewportsStyle[n].representations[r][i].perSegment?.[a]&&(o={...o,...this.config.viewportsStyle[n].representations[r][i].perSegment[a]}))}return o}getRenderInactiveSegmentations(e){return this.config.viewportsStyle[e]?.renderInactiveSegmentations}setRenderInactiveSegmentations(e,n){this.config.viewportsStyle[e]||(this.config.viewportsStyle[e]={renderInactiveSegmentations:!1,representations:{}}),this.config.viewportsStyle[e].renderInactiveSegmentations=n}getDefaultStyle(e){switch(e){case pn.Labelmap:return kRe();case pn.Contour:return NRe();case pn.Surface:return{};default:throw new Error(`Unknown representation type: ${e}`)}}clearSegmentationStyle(e){this.config.segmentations[e]&&delete this.config.segmentations[e]}clearAllSegmentationStyles(){this.config.segmentations={}}clearViewportStyle(e){this.config.viewportsStyle[e]&&delete this.config.viewportsStyle[e]}clearAllViewportStyles(){for(const e in this.config.viewportsStyle){const r=this.config.viewportsStyle[e].renderInactiveSegmentations;this.config.viewportsStyle[e]={renderInactiveSegmentations:r,representations:{}}}}resetToGlobalStyle(){this.clearAllSegmentationStyles(),this.clearAllViewportStyles()}hasCustomStyle(e){const{type:n}=e,r=this.getStyle(e),i=this.getDefaultStyle(n);return!XJ(r,i)}}const em=new VRe;function FRe(t){const e={segmentationId:t};Ct(St,ee.SEGMENTATION_ADDED,e)}const MV={colorLUT:[],segmentations:[],viewportSegRepresentations:{}};class URe{constructor(e){this._stackLabelmapImageIdReferenceMap=new Map,this._labelmapImageIdReferenceMap=new Map,e||=or(),this.state=Object.freeze(fc(MV)),this.uid=e}getState(){return this.state}updateState(e){const n=fc(this.state);e(n),this.state=Object.freeze(n)}getColorLUT(e){return this.state.colorLUT[e]}getNextColorLUTIndex(){return this.state.colorLUT.length}resetState(){this._stackLabelmapImageIdReferenceMap.clear(),this._labelmapImageIdReferenceMap.clear(),this.state=Object.freeze(fc(MV))}getSegmentation(e){return this.state.segmentations.find(n=>n.segmentationId===e)}updateSegmentation(e,n){this.updateState(r=>{const i=r.segmentations.find(a=>a.segmentationId===e);if(!i){console.warn(`Segmentation with id ${e} not found. Update aborted.`);return}Object.assign(i,n)}),Hm(e)}addSegmentation(e){if(this.getSegmentation(e.segmentationId))throw new Error(`Segmentation with id ${e.segmentationId} already exists`);this.updateState(n=>{const r=fc(e);if(r.representationData.Labelmap&&"volumeId"in r.representationData.Labelmap&&!("imageIds"in r.representationData.Labelmap)){const i=this.getLabelmapImageIds(r.representationData);r.representationData.Labelmap.imageIds=i}n.segmentations.push(r)}),FRe(e.segmentationId)}removeSegmentation(e){this.updateState(n=>{const r=n.segmentations.filter(i=>i.segmentationId!==e);n.segmentations.splice(0,n.segmentations.length,...r)}),ARe(e)}addSegmentationRepresentation(e,n,r,i){if(!mr(e))return;if(this.getSegmentationRepresentations(e,{type:r,segmentationId:n}).length>0){console.debug("A segmentation representation of type",r,"already exists in viewport",e,"for segmentation",n);return}this.updateState(s=>{s.viewportSegRepresentations[e]||(s.viewportSegRepresentations[e]=[],em.setRenderInactiveSegmentations(e,!0)),r!==pn.Labelmap?this.addDefaultSegmentationRepresentation(s,e,n,r,i):this.addLabelmapRepresentation(s,e,n,i)}),Sv(e,n,r)}addDefaultSegmentationRepresentation(e,n,r,i,a){const o=e.segmentations.find(l=>l.segmentationId===r);if(!o)return;const s={};Object.keys(o.segments).forEach(l=>{s[Number(l)]={visible:!0}}),e.viewportSegRepresentations[n].push({segmentationId:r,type:i,active:!0,visible:!0,colorLUTIndex:a?.colorLUTIndex||0,segments:s,config:{...IV(i),...a}}),this._setActiveSegmentation(e,n,r)}addLabelmapRepresentation(e,n,r,i=IV(pn.Labelmap)){if(!mr(n))return;const o=this.getSegmentation(r);if(!o)return;const{representationData:s}=o;if(!s.Labelmap)return this.addDefaultSegmentationRepresentation(e,n,r,pn.Labelmap,i);this.processLabelmapRepresentationAddition(n,r),this.addDefaultSegmentationRepresentation(e,n,r,pn.Labelmap,i)}async processLabelmapRepresentationAddition(e,n){const r=mr(e);if(!r)return;const i=this.getSegmentation(n);if(!i)return;const a=r.viewport instanceof lo,{representationData:o}=i,s="volumeId"in o.Labelmap;r.viewport,!a&&!s&&this.updateLabelmapSegmentationImageReferences(e,i.segmentationId)}_updateLabelmapSegmentationReferences(e,n,r,i){const a=n.getCurrentImageId();let o=!1;for(const s of r)n.isReferenceViewable({referencedImageId:s},{asOverlay:!0})&&(o=!0,this._stackLabelmapImageIdReferenceMap.get(e).set(a,s),this._updateLabelmapImageIdReferenceMap({segmentationId:e,referenceImageId:a,labelmapImageId:s}));return i&&i(n,e,r),o?this._stackLabelmapImageIdReferenceMap.get(e).get(a):void 0}updateLabelmapSegmentationImageReferences(e,n){const r=this.getSegmentation(n);if(!r)return;this._stackLabelmapImageIdReferenceMap.has(n)||this._stackLabelmapImageIdReferenceMap.set(n,new Map);const{representationData:i}=r;if(!i.Labelmap)return;const a=this.getLabelmapImageIds(i),s=mr(e).viewport;return this._updateLabelmapSegmentationReferences(n,s,a,null)}_updateAllLabelmapSegmentationImageReferences(e,n){const r=this.getSegmentation(n);if(!r)return;this._stackLabelmapImageIdReferenceMap.has(n)||this._stackLabelmapImageIdReferenceMap.set(n,new Map);const{representationData:i}=r;if(!i.Labelmap)return;const a=this.getLabelmapImageIds(i),s=mr(e).viewport;this._updateLabelmapSegmentationReferences(n,s,a,(l,c,f)=>{l.getImageIds().forEach((d,h)=>{for(const p of f)l.isReferenceViewable({referencedImageId:p,sliceIndex:h},{asOverlay:!0,withNavigation:!0})&&(this._stackLabelmapImageIdReferenceMap.get(c).set(d,p),this._updateLabelmapImageIdReferenceMap({segmentationId:c,referenceImageId:d,labelmapImageId:p}))})})}getLabelmapImageIds(e){const n=e.Labelmap;let r;if(n.imageIds)r=n.imageIds;else if(!r&&n.volumeId){const i=n.volumeId;r=yt.getVolume(i).imageIds}return r}getLabelmapImageIdsForImageId(e,n){const r=this._generateMapKey({segmentationId:n,referenceImageId:e});return this._labelmapImageIdReferenceMap.get(r)}getCurrentLabelmapImageIdsForViewport(e,n){const r=mr(e);if(!r)return;const a=r.viewport.getCurrentImageId();return this.getLabelmapImageIdsForImageId(a,n)}getCurrentLabelmapImageIdForViewport(e,n){const r=mr(e);if(!r||!this._stackLabelmapImageIdReferenceMap.has(n))return;const a=r.viewport.getCurrentImageId();return this._stackLabelmapImageIdReferenceMap.get(n).get(a)}getStackSegmentationImageIdsForViewport(e,n){if(!this.getSegmentation(n))return[];this._updateAllLabelmapSegmentationImageReferences(e,n);const{viewport:i}=mr(e),a=i.getImageIds(),o=this._stackLabelmapImageIdReferenceMap.get(n);return a.map(s=>o.get(s))}removeSegmentationRepresentationsInternal(e,n){const r=[];return this.updateState(i=>{if(!i.viewportSegRepresentations[e])return;const a=i.viewportSegRepresentations[e];let o=!1;if(!n||Object.values(n).every(s=>s===void 0))r.push(...a),delete i.viewportSegRepresentations[e];else{const{segmentationId:s,type:l}=n;i.viewportSegRepresentations[e]=a.filter(c=>{const f=s&&l&&c.segmentationId===s&&c.type===l||s&&!l&&c.segmentationId===s||!s&&l&&c.type===l;return f&&(r.push(c),c.active&&(o=!0)),!f}),i.viewportSegRepresentations[e].length===0?delete i.viewportSegRepresentations[e]:o&&(i.viewportSegRepresentations[e][0].active=!0)}}),r}removeSegmentationRepresentations(e,n){const r=this.removeSegmentationRepresentationsInternal(e,n);r.forEach(a=>{OV(e,a.segmentationId,a.type)});const i=this.getSegmentationRepresentations(e);return i.length>0&&i[0].active&&Sv(e,i[0].segmentationId,i[0].type),r}removeSegmentationRepresentation(e,n,r){const i=this.removeSegmentationRepresentationsInternal(e,n);return r||i.forEach(({segmentationId:a,type:o})=>{OV(e,a,o)}),i}_updateLabelmapImageIdReferenceMap({segmentationId:e,referenceImageId:n,labelmapImageId:r}){const i=this._generateMapKey({segmentationId:e,referenceImageId:n});if(!this._labelmapImageIdReferenceMap.has(i)){this._labelmapImageIdReferenceMap.set(i,[r]);return}const a=this._labelmapImageIdReferenceMap.get(i),o=Array.from(new Set([...a,r]));this._labelmapImageIdReferenceMap.set(i,o)}_setActiveSegmentation(e,n,r){const i=e.viewportSegRepresentations[n];i&&i.forEach(a=>{a.active=a.segmentationId===r})}setActiveSegmentation(e,n){this.updateState(r=>{const i=r.viewportSegRepresentations[e];i&&i.forEach(a=>{a.active=a.segmentationId===n})}),Sv(e,n)}getActiveSegmentation(e){if(!this.state.viewportSegRepresentations[e])return;const n=this.state.viewportSegRepresentations[e].find(r=>r.active);if(n)return this.getSegmentation(n.segmentationId)}getSegmentationRepresentations(e,n={}){const r=this.state.viewportSegRepresentations[e];return r?!n.type&&!n.segmentationId?r:r.filter(i=>{const a=n.type?i.type===n.type:!0,o=n.segmentationId?i.segmentationId===n.segmentationId:!0;return a&&o}):[]}getSegmentationRepresentation(e,n){return this.getSegmentationRepresentations(e,n)[0]}getSegmentationRepresentationVisibility(e,n){return this.getSegmentationRepresentation(e,n)?.visible}setSegmentationRepresentationVisibility(e,n,r){this.updateState(i=>{const a=this.getSegmentationRepresentations(e,n);a&&a.forEach(o=>{o.visible=r,Object.entries(o.segments).forEach(([s,l])=>{l.visible=r})})}),Sv(e,n.segmentationId,n.type)}addColorLUT(e,n){this.updateState(r=>{r.colorLUT[n]&&console.warn("Color LUT table already exists, overwriting"),r.colorLUT[n]=fc(e)})}removeColorLUT(e){this.updateState(n=>{delete n.colorLUT[e]})}_getStackIdForImageIds(e){return e.map(n=>n.slice(-Math.round(n.length*.15))).join("_")}getAllViewportSegmentationRepresentations(){return Object.entries(this.state.viewportSegRepresentations).map(([e,n])=>({viewportId:e,representations:n}))}getSegmentationRepresentationsBySegmentationId(e){const n=[];return Object.entries(this.state.viewportSegRepresentations).forEach(([r,i])=>{const a=i.filter(o=>o.segmentationId===e);a.length>0&&n.push({viewportId:r,representations:a})}),n}_generateMapKey({segmentationId:e,referenceImageId:n}){return`${e}-${n}`}}function IV(t){const e=Lf.newInstance(),n=Xh.newInstance();return n.addPoint(0,0),t===pn.Labelmap?{cfun:e,ofun:n}:{}}const Ds=new URe("DEFAULT");function i0(t,e={}){return Ds.getSegmentationRepresentations(t,e)}function BRe(t,e){const n=Ds;if(!e.segmentationId||!e.type)throw new Error("getSegmentationRepresentation: No segmentationId or type provided, you need to provide at least one of them");return n.getSegmentationRepresentations(t,e)?.[0]}function $Re(t,e){const n=et(t),{viewport:r}=n,a=r.getActors().filter(o=>o.representationUID&&typeof o.representationUID=="string"&&o.representationUID.startsWith(e));r.removeActors(a.map(o=>o.uid))}function mQ(t,e,n){const r=mr(t);if(!r)return;const{renderingEngine:i,viewport:a}=r;if(!i||!a)return;const s=a.getActors().filter(n);return s.length>0?s[0]:void 0}function GRe(t,e){const n=mr(t);if(!n)return;const{renderingEngine:r,viewport:i}=n;if(!r||!i)return;const o=i.getActors().filter(e);return o.length>0?o:void 0}function jRe(t,e){return vQ(t,e)?.uid}function $v(t,e){return GRe(t,n=>n.representationUID?.startsWith(`${e}-${pn.Labelmap}`))}function vQ(t,e){return mQ(t,e,n=>n.representationUID?.startsWith(`${e}-${pn.Labelmap}`))}function zRe(t,e,n){return mQ(t,e,r=>r.representationUID===yQ(e,n))}function yQ(t,e){return`${t}-${pn.Surface}-${e}`}function WRe(t,e,n){const r=et(t),{viewport:i}=r,o=zRe(i.id,n,e.segmentIndex)?.actor,s=e.visible;if(o){if(o.setVisibility(s),!s)return;const y=o.getMapper(),v=y.getInputData(),x=e.points,w=e.polys,S=v.getPoints().getData(),T=v.getPolys().getData();if(x.length===S.length&&w.length===T.length)return;const _=ra.newInstance();_.getPoints().setData(x,3);const D=Zh.newInstance({values:Float32Array.from(w)});_.setPolys(D),y.setInputData(_),y.modified(),i.getRenderer().resetCameraClippingRange();return}const l=e.points,c=e.polys,f=e.color,u=ra.newInstance();u.getPoints().setData(l,3);const d=Zh.newInstance({values:Float32Array.from(c)});u.setPolys(d);const h=gc.newInstance({});let p;h.setInputData(u);const g=m0.newInstance();g.setMapper(h),g.getProperty().setColor(f[0]/255,f[1]/255,f[2]/255),g.getProperty().setLineWidth(2);const m=yQ(n,e.segmentIndex);i.addActor({uid:or(),actor:g,clippingFilter:p,representationUID:m}),i.resetCamera(),i.getRenderer().resetCameraClippingRange(),i.render()}function Ki(t){return Ds.getSegmentation(t)}function v7(t){return Ds.getColorLUT(t)}let K3={};function HRe(){return K3}function KRe(t){K3=t}let RV=!1;function Df(){if(!K3.addons?.polySeg)return console.warn("PolySeg add-on not configured. This will prevent automatic conversion between segmentation representations (labelmap, contour, surface). To enable these features, install @cornerstonejs/polymorphic-segmentation and register it during initialization: cornerstoneTools.init({ addons: { polySeg } })."),null;const t=K3.addons.polySeg;return RV||(t.init(),RV=!0),t}function qRe({segmentationId:t,type:e,data:n}){const r=Ki(t);if(!r)throw new Error(`Segmentation ${t} not found`);switch(r.representationData[e]&&console.warn(`Representation data of type ${e} already exists for segmentation ${t}, overwriting it.`),e){case pn.Labelmap:n&&(r.representationData[e]=n);break;case pn.Contour:n&&(r.representationData[e]=n);break;case pn.Surface:n&&(r.representationData[e]=n);break;default:throw new Error(`Invalid representation type ${e}`)}}function xQ(t){const e=typeof t;return t!==null&&(e==="object"||e==="function")}function yC(t,e,n){let r,i,a,o,s,l,c=0,f=!1,u=!1,d=!0;const h=!e&&e!==0&&typeof window.requestAnimationFrame=="function";if(typeof t!="function")throw new TypeError("Expected a function");e=Number(e)||0,xQ(n)&&(f=!!n.leading,u="maxWait"in n,a=u?Math.max(Number(n.maxWait)||0,e):a,d="trailing"in n?!!n.trailing:d);function p(R){const M=r,A=i;return r=i=void 0,c=R,o=t.apply(A,M),o}function g(R,M){return h?window.requestAnimationFrame(R):setTimeout(R,M)}function m(R){if(h)return window.cancelAnimationFrame(R);clearTimeout(R)}function y(R){return c=R,s=g(w,e),f?p(R):o}function v(R){const M=R-l,A=R-c,L=e-M;return u?Math.min(L,a-A):L}function x(R){const M=R-l,A=R-c;return l===void 0||M>=e||M<0||u&&A>=a}function w(){const R=Date.now();if(x(R))return S(R);s=g(w,v(R))}function S(R){return s=void 0,d&&r?p(R):(r=i=void 0,o)}function T(){s!==void 0&&m(s),c=0,r=l=i=s=void 0}function _(){return s===void 0?o:S(Date.now())}function D(){return s!==void 0}function I(...R){const M=Date.now(),A=x(M);if(r=R,i=this,l=M,A){if(s===void 0)return y(l);if(u)return s=g(w,e),p(l)}return s===void 0&&(s=g(w,e)),o}return I.cancel=T,I.flush=_,I.pending=D,I}const _b=new Map;async function y7(t,e,n,r,i){const a=await n();qRe({segmentationId:t,type:e,data:a}),i?.(),_b.has(t)||_b.set(t,[]);const o=_b.get(t);return o.includes(e)||o.push(e),XRe(r),Hm(t),a}function XRe(t){const e=n=>{YRe(n,t)};t._debouncedUpdateFunction=e,St.removeEventListener(ee.SEGMENTATION_DATA_MODIFIED,t._debouncedUpdateFunction),St.addEventListener(ee.SEGMENTATION_DATA_MODIFIED,t._debouncedUpdateFunction)}const YRe=yC((t,e)=>{const n=t.detail.segmentationId,r=_b.get(n);!r||!r.length||(e(n),r.length&&Hm(n))},300);function x7(t,e){const n=BRe(t,e);return n?Object.entries(n.segments).reduce((i,[a,o])=>(o.visible||i.add(Number(a)),i),new Set):new Set}function JRe(t,e,n=!1){const r=mr(t);if(!r)return;const{viewport:i}=r;$Re(i.element,e),n&&i.render()}async function ZRe(t,e){const{segmentationId:n,type:r}=e,i=Ki(n);if(!i)return;let a=i.representationData[pn.Surface];if(!a&&Df()?.canComputeRequestedRepresentation(n,pn.Surface)){const c=Df();if(a=await y7(n,pn.Surface,()=>c.computeSurfaceData(n,{viewport:t}),()=>c.updateSurfaceData(n,{viewport:t})),!a)throw new Error(`No Surface data found for segmentationId ${n} even we tried to compute it`)}else!a&&!Df()&&console.debug(`No surface data found for segmentationId ${n} and PolySeg add-on is not configured. Unable to convert from other representations to surface. Please register PolySeg using cornerstoneTools.init({ addons: { polySeg } }) to enable automatic conversion.`);if(!a){console.warn(`No Surface data found for segmentationId ${n}. Skipping render.`);return}const{geometryIds:o}=a;o?.size||console.warn(`No Surfaces found for segmentationId ${n}. Skipping render.`);const{colorLUTIndex:s}=e,l=v7(s);o.forEach(c=>{const f=yt.getGeometry(c);if(!f?.data){console.warn(`No Surfaces found for geometryId ${c}. Skipping render.`);return}const{segmentIndex:u}=f.data,h=x7(t.id,{segmentationId:n,type:r}).has(u),p=f.data,g=l[u];p.color=g.slice(0,3),p.visible=!h,WRe(t.element,p,n)}),t.render()}const QRe={render:ZRe,removeRepresentation:JRe};function eAe(t,e,n){const r=t.getImageIds();if(!r||!r.length)return;const i=r.map(a=>{const{imagePositionPatient:o}=Ft("imagePlaneModule",a),s=tAe(e,o,n);return{imageId:a,distance:s}});return i.sort((a,o)=>a.distance-o.distance),i[0].imageId}function tAe(t,e,n){const r=ct();ur(r,t,e);const i=zt(r,n);return Math.abs(i)}function nAe(t,e){const{segmentation:n}=t.data,{segmentation:r}=e.data;return n.segmentationId===r.segmentationId&&n.segmentIndex===r.segmentIndex}class rAe{constructor(e){this.getGroupKey=n=>{if(typeof n=="string")return n;const i=et(n);if(!i)throw new Error("Element not enabled, you must have an enabled element if you are not providing a FrameOfReferenceUID");return i.FrameOfReferenceUID},this._imageVolumeModifiedHandler=n=>{const r=n.detail,{FrameOfReferenceUID:i}=r,o=this.annotations[i];o&&Object.keys(o).forEach(s=>{o[s].forEach(c=>{c.invalidated!==void 0&&(c.invalidated=!0)})})},this.getFramesOfReference=()=>Object.keys(this.annotations),this.getAnnotations=(n,r)=>{const i=this.annotations;return i[n]?r?i[n][r]?i[n][r]:[]:i[n]:[]},this.getAnnotation=n=>{const r=this.annotations;for(const i in r){const a=r[i];for(const o in a){const s=a[o];for(const l of s)if(n===l.annotationUID)return l}}},this.getNumberOfAnnotations=(n,r)=>{const i=this.getAnnotations(n,r);if(!i.length)return 0;if(r)return i.length;let a=0;for(const o in i)a+=i[o].length;return a},this.addAnnotation=(n,r)=>{const{metadata:i}=n,{FrameOfReferenceUID:a,toolName:o}=i;r=r||a;const s=this.annotations;let l=s[r];l||(s[r]={},l=s[r]);let c=l[o];c||(l[o]=[],c=l[o]),this.preprocessingFn&&(n=this.preprocessingFn(n)),c.push(n)},this.removeAnnotation=n=>{const{annotations:r}=this;for(const i in r){const a=r[i];for(const o in a){const s=a[o],l=s.findIndex(c=>c.annotationUID===n);l!==-1&&(s.splice(l,1),s.length===0&&delete a[o])}Object.keys(a).length===0&&delete r[i]}},this.removeAnnotations=(n,r)=>{const i=this.annotations,a=[];if(!i[n])return a;if(r){const o=i[n][r];for(const s of o)this.removeAnnotation(s.annotationUID),a.push(s)}else for(const o in i[n]){const s=i[n][o];for(const l of s)this.removeAnnotation(l.annotationUID),a.push(l)}return a},this.saveAnnotations=(n,r)=>{const i=this.annotations;if(n&&r){const a=i[n];if(!a)return;const o=a[r];return structuredClone(o)}else if(n){const a=i[n];return structuredClone(a)}return structuredClone(i)},this.restoreAnnotations=(n,r,i)=>{const a=this.annotations;if(r&&i){let o=a[r];o||(a[r]={},o=a[r]),o[i]=n}else r?a[r]=n:this.annotations=structuredClone(n)},this.getAllAnnotations=()=>Object.values(this.annotations).map(n=>Object.values(n)).flat(2),this.getNumberOfAllAnnotations=()=>{let n=0;const r=this.annotations;for(const i in r){const a=r[i];for(const o in a){const s=a[o];n+=s.length}}return n},this.removeAllAnnotations=()=>{const n=[];for(const r of this.getAllAnnotations())this.removeAnnotation(r.annotationUID),n.push(r);return n},e||(e=or()),this.annotations={},this.uid=e,St.addEventListener(vt.IMAGE_VOLUME_MODIFIED,this._imageVolumeModifiedHandler)}setPreprocessingFn(e){this.preprocessingFn=e}}const iAe=new rAe("DEFAULT"),Db=new Set;function aAe(t,e=!0){const n=sAe();t&&(e?lAe(t,Db,n):cAe(t,Db,n)),uAe(n,Db)}function uo(t){return Db.has(t)}function oAe(t){const e=uo(t);return aAe(t,e),e}function sAe(){return Object.freeze({added:[],removed:[],locked:[]})}function lAe(t,e,n){if(!e.has(t)){e.add(t),n.added.push(t);const r=co(t);r&&(r.isLocked=!0)}}function cAe(t,e,n){if(e.delete(t)){n.removed.push(t);const r=co(t);r&&(r.isLocked=!1)}}function uAe(t,e){(t.added.length>0||t.removed.length>0)&&(e.forEach(n=>void t.locked.push(n)),Ct(St,ee.ANNOTATION_LOCK_CHANGE,t))}const e0=new Set;function fu(t,e=!0,n=!1){e?fAe(t,n):bQ(t)}function fAe(t,e=!1){const n=wQ();if(!e){CQ(e0,n);const r=co(t);r&&(r.isSelected=!0)}if(t&&!e0.has(t)){e0.add(t),n.added.push(t);const r=co(t);r&&(r.isSelected=!0)}SQ(n,e0)}function bQ(t){const e=wQ();if(t){if(e0.delete(t)){e.removed.push(t);const n=co(t);n.isSelected=!1}}else CQ(e0,e);SQ(e,e0)}function xC(t){return e0.has(t)}function wQ(){return Object.freeze({added:[],removed:[],selection:[]})}function CQ(t,e){t.forEach(n=>{if(t.delete(n)){e.removed.push(n);const r=co(n);r&&(r.isSelected=!1)}})}function SQ(t,e){(t.added.length>0||t.removed.length>0)&&(e.forEach(n=>void t.selection.push(n)),Ct(St,ee.ANNOTATION_SELECTION_CHANGE,t))}const dAe=t=>(t.data||(t.data={}),t.data.handles||(t.data.handles={}),t.data.handles.textBox||(t.data.handles.textBox={}),t),hAe=t=>(t.data||(t.data={}),t.data.cachedStats||(t.data.cachedStats={}),t),P2=new Set;function pAe(t,e=!0){const n=gAe();t&&(e?mAe(t,P2,n):vAe(t,P2,n)),yAe(n)}function fo(t){if(co(t))return!P2.has(t)}function gAe(){return Object.freeze({lastVisible:[],lastHidden:[],hidden:[]})}function mAe(t,e,n){if(e.delete(t)){n.lastVisible.push(t);const r=co(t);r.isVisible=!0}}function vAe(t,e,n){if(!e.has(t)){e.add(t),xC(t)&&bQ(t),n.lastHidden.push(t);const r=co(t);r.isVisible=!1}}function yAe(t){(t.lastHidden.length>0||t.lastVisible.length>0)&&(P2.forEach(e=>void t.hidden.push(e)),Ct(St,ee.ANNOTATION_VISIBILITY_CHANGE,t))}function xAe(t){const e=!P2.has(t);return pAe(t,e),e}const b7=iAe,bAe=t=>{t=dAe(t),t=hAe(t);const e=t.annotationUID,n=oAe(e);t.isLocked=n;const r=xAe(e);return t.isVisible=r,t};b7.setPreprocessingFn(bAe);d7(b7);function wAe(){d7(b7)}function x0(t){if(!t.data.segmentation)throw new Error("removeContourSegmentationAnnotation: annotation does not have a segmentation data");const{segmentationId:e,segmentIndex:n}=t.data.segmentation,r=Ki(e),{annotationUIDsMap:i}=r?.representationData.Contour||{},a=i?.get(n);a&&(a.delete(t.annotationUID),a.size||i.delete(n))}function b0(t){if(t.parentAnnotationUID)return;if(!t.data.segmentation)throw new Error("addContourSegmentationAnnotation: annotation does not have a segmentation data");const{segmentationId:e,segmentIndex:n}=t.data.segmentation,r=Ki(e);r.representationData.Contour||(r.representationData.Contour={annotationUIDsMap:new Map});let{annotationUIDsMap:i}=r.representationData.Contour;i||(i=new Map);let a=i?.get(n);a||(a=new Set,i.set(n,a)),i.set(n,a.add(t.annotationUID))}const CAe="PlanarFreehandContourSegmentationTool";function SAe(t){const{polyline:e}=t.data?.contour||{};if(!e||e.length<3){console.warn("Skipping creation of new annotation due to invalid polyline:",e);return}Cr(t.annotationUID),x0(t);const n=e[0],r=e[e.length-1],i={metadata:{...t.metadata,toolName:CAe,originalToolName:t.metadata.originalToolName||t.metadata.toolName},data:{cachedStats:{},handles:{points:[n,r],textBox:t.data.handles.textBox?{...t.data.handles.textBox}:void 0},contour:{...t.data.contour},spline:t.data.spline,segmentation:{...t.data.segmentation}},annotationUID:or(),highlighted:!0,invalidated:!0,isLocked:!1,isVisible:void 0,interpolationUID:t.interpolationUID,interpolationCompleted:t.interpolationCompleted};return hr(i,t.metadata.FrameOfReferenceUID),b0(i),i}function bC(t){const r=Ds.getState().viewportSegRepresentations;return Object.entries(r).filter(([,a])=>a.some(o=>o.segmentationId===t)).map(([a])=>a)}var Zo;(function(t){t[t.CounterClockwise=-1]="CounterClockwise",t[t.Unknown=0]="Unknown",t[t.Clockwise=1]="Clockwise"})(Zo||(Zo={}));function TAe(t,e){return t.minX<=e.maxX&&t.maxX>=e.minX&&t.minY<=e.maxY&&t.maxY>=e.minY}function AV(t,e){const n=t.maxX-t.minX,r=t.maxY-t.minY,i=[n,r],a=[t.minX+n/2,t.minY+r/2],o=[Math.abs(e[0]-a[0]),Math.abs(e[1]-a[1])],s=o[0]-i[0]*.5,l=o[1]-i[1]*.5;if(s>0&&l>0)return s*s+l*l;const c=Math.max(s,0)+Math.max(l,0);return c*c}class EAe{}const{PointsManager:_Ae}=Hr;function Y6(t){return{max:[-1/0],min:[1/0],sum:[0],count:0,maxIJK:null,maxLPS:null,minIJK:null,minLPS:null,runMean:[0],m2:[0],m3:[0],m4:[0],allValues:[[]],pointsInShape:t?_Ae.create3(1024):null,sumLPS:[0,0,0]}}function DAe(t,e,n=null,r=null){Array.isArray(e)&&e.length>1&&t.max.length===1&&(t.max.push(t.max[0],t.max[0]),t.min.push(t.min[0],t.min[0]),t.sum.push(t.sum[0],t.sum[0]),t.runMean.push(0,0),t.m2.push(t.m2[0],t.m2[0]),t.m3.push(t.m3[0],t.m3[0]),t.m4.push(t.m4[0],t.m4[0]),t.allValues.push([],[])),t?.pointsInShape&&n&&t.pointsInShape.push(n);const i=Array.isArray(e)?e:[e];t.count+=1,n&&(t.sumLPS[0]+=n[0],t.sumLPS[1]+=n[1],t.sumLPS[2]+=n[2]),t.max.forEach((a,o)=>{const s=i[o];t.allValues[o].push(s);const l=t.count,c=s-t.runMean[o],f=c/l,u=c*f*(l-1);t.sum[o]+=s,t.runMean[o]+=f,t.m4[o]+=u*f*f*(l*l-3*l+3)+6*f*f*t.m2[o]-4*f*t.m3[o],t.m3[o]+=u*f*(l-2)-3*f*t.m2[o],t.m2[o]+=u,s<t.min[o]&&(t.min[o]=s,o===0&&(t.minIJK=r?[...r]:null,t.minLPS=n?[...n]:null)),s>t.max[o]&&(t.max[o]=s,o===0&&(t.maxIJK=r?[...r]:null,t.maxLPS=n?[...n]:null))})}function OAe(t){if(t.length===0)return 0;const e=[...t].sort((r,i)=>r-i),n=Math.floor(e.length/2);return e.length%2===0?(e[n-1]+e[n])/2:e[n]}function MAe(t,e){const n=t.sum.map(u=>u/t.count),r=t.m2.map(u=>Math.sqrt(u/t.count)),i=t.sumLPS.map(u=>u/t.count),a=t.m3.map((u,d)=>{const h=t.m2[d]/t.count;return h===0?0:u/(t.count*Math.pow(h,1.5))}),o=t.m4.map((u,d)=>{const h=t.m2[d]/t.count;return h===0?0:u/(t.count*h*h)-3}),s=t.allValues.map(u=>OAe(u)),l={max:{name:"max",label:"Max Pixel",value:t.max.length===1?t.max[0]:t.max,unit:e,pointIJK:t.maxIJK?[...t.maxIJK]:null,pointLPS:t.maxLPS?[...t.maxLPS]:null},min:{name:"min",label:"Min Pixel",value:t.min.length===1?t.min[0]:t.min,unit:e,pointIJK:t.minIJK?[...t.minIJK]:null,pointLPS:t.minLPS?[...t.minLPS]:null},mean:{name:"mean",label:"Mean Pixel",value:n.length===1?n[0]:n,unit:e},stdDev:{name:"stdDev",label:"Standard Deviation",value:r.length===1?r[0]:r,unit:e},count:{name:"count",label:"Voxel Count",value:t.count,unit:null},median:{name:"median",label:"Median",value:s.length===1?s[0]:s,unit:e},skewness:{name:"skewness",label:"Skewness",value:a.length===1?a[0]:a,unit:null},kurtosis:{name:"kurtosis",label:"Kurtosis",value:o.length===1?o[0]:o,unit:null},maxLPS:{name:"maxLPS",label:"Max LPS",value:t.maxLPS?Array.from(t.maxLPS):null,unit:null},minLPS:{name:"minLPS",label:"Min LPS",value:t.minLPS?Array.from(t.minLPS):null,unit:null},pointsInShape:t.pointsInShape,center:{name:"center",label:"Center",value:i?[...i]:null,unit:null},array:[]};l.array.push(l.min,l.max,l.mean,l.stdDev,l.median,l.skewness,l.kurtosis,l.count,l.maxLPS,l.minLPS),l.center.value&&l.array.push(l.center);const c=t.pointsInShape!==null,f=Y6(c);return t.max=f.max,t.min=f.min,t.sum=f.sum,t.count=f.count,t.maxIJK=f.maxIJK,t.maxLPS=f.maxLPS,t.minIJK=f.minIJK,t.minLPS=f.minLPS,t.runMean=f.runMean,t.m2=f.m2,t.m3=f.m3,t.m4=f.m4,t.allValues=f.allValues,t.pointsInShape=f.pointsInShape,t.sumLPS=f.sumLPS,l}const xh=class xh extends EAe{static statsInit(e){e.storePointData||(this.state.pointsInShape=null),this.state=Y6(e.storePointData)}};xh.state=Y6(!0),xh.statsCallback=({value:e,pointLPS:n=null,pointIJK:r=null})=>{DAe(xh.state,e,n,r)},xh.getStatistics=e=>MAe(xh.state,e?.unit);let w0=xh;function C0(t,e){if(t.length!==e.length)throw Error("Both points should have the same dimensionality");const[n,r,i=0]=t,[a,o,s=0]=e,l=a-n,c=o-r,f=s-i;return l*l+c*c+f*f}function hp(t,e){return Math.sqrt(C0(t,e))}function PV(t,e){const[n,r]=t,[i,a]=e,o=2*i-n,s=2*a-r;return[o,s]}function Gv(t){const[e,n]=t;return hp(e,n)}function NV(t){const[e,n]=t,r=hp(e,n),i=[e[0]-r,e[1]-r],a=[e[0]+r,e[1]+r];return[i,a]}function TQ(t,e,n={}){return n.precalculated||IAe(t,n),n.precalculated(e)}const IAe=(t,e={})=>{const{xRadius:n,yRadius:r,zRadius:i}=t;(e.invXRadiusSq===void 0||e.invYRadiusSq===void 0||e.invZRadiusSq===void 0)&&(e.invXRadiusSq=n!==0?1/n**2:0,e.invYRadiusSq=r!==0?1/r**2:0,e.invZRadiusSq=i!==0?1/i**2:0);const{invXRadiusSq:a,invYRadiusSq:o,invZRadiusSq:s}=e,{center:l}=t,[c,f,u]=l;return e.precalculated=d=>{const h=d[0]-c;let p=h*h*a;if(p>1)return!1;const g=d[1]-f;if(p+=g*g*o,p>1)return!1;const m=d[2]-u;return p+=m*m*s,p<=1},e};function LV(t){const[e,n,r,i]=t,a=[r[0],n[1]],o=[i[0],e[1]];return[a,o]}function J6(t,e,n){let r;const i=C0(t,e);if(t[0]===e[0]&&t[1]===e[1]&&(r=t),!r){const a=((n[0]-t[0])*(e[0]-t[0])+(n[1]-t[1])*(e[1]-t[1]))/i;a<0?r=t:a>1?r=e:r=[t[0]+a*(e[0]-t[0]),t[1]+a*(e[1]-t[1])]}return{point:[...r],distanceSquared:C0(n,r)}}function wC(t,e,n){return J6(t,e,n).distanceSquared}function Il(t,e,n){if(t.length!==2||e.length!==2||n.length!==2)throw Error("lineStart, lineEnd, and point should have 2 elements of [x, y]");return Math.sqrt(wC(t,e,n))}function Mx(t){return typeof t=="number"?t?t<0?-1:1:t===t?0:NaN:NaN}function kV(t,e,n,r,i=!1){const[a,o]=t,[s,l]=e,[c,f]=n,[u,d]=r;if(i){const A=(a-s)*(f-d)-(o-l)*(c-u);if(Math.abs(A)<1e-10)return;const L=((a-c)*(f-d)-(o-f)*(c-u))/A,P=a+L*(s-a),B=o+L*(l-o);return[P,B]}const h=l-o,p=a-s,g=s*o-a*l,m=h*c+p*f+g,y=h*u+p*d+g;if(m!==0&&y!==0&&Mx(m)===Mx(y))return;const v=d-f,x=c-u,w=u*f-c*d,S=v*a+x*o+w,T=v*s+x*l+w;if(S!==0&&T!==0&&Mx(S)===Mx(T))return;const _=h*x-v*p;let D;D=p*w-x*g;const I=D/_;D=v*g-h*w;const R=D/_;return[I,R]}const rv=.01;function I8(t,e,n){const r=t[0]<=e[0]?t[0]:e[0],i=t[0]>=e[0]?t[0]:e[0],a=t[1]<=e[1]?t[1]:e[1],o=t[1]>=e[1]?t[1]:e[1];if(!(n[0]>=r-rv&&n[0]<=i+rv&&n[1]>=a-rv&&n[1]<=o+rv))return!1;const l=(e[1]-t[1])*(n[0]-e[0])-(e[0]-t[0])*(n[1]-e[1]);return(l>=0?l:-l)<=rv}function EQ(t){if(t.length<3)return!1;const e=t.length,n=t[0],r=t[e-1],i=C0(n,r);return l3(0,i)}function qo(t,e,n={closed:void 0}){if(t.length<3)return!1;const r=t.length;let i=0;const{closed:a,holes:o}=n;if(o?.length){for(const c of o)if(qo(c,e))return!1}const s=!(a===void 0?EQ(t):a),l=t.length-(s?1:2);for(let c=0;c<=l;c++){const f=t[c],u=c===r-1?0:c+1,d=t[u],h=f[0]>=d[0]?f[0]:d[0],p=f[1]>=d[1]?f[1]:d[1],g=f[1]<=d[1]?f[1]:d[1];if(e[0]<=h&&e[1]>=g&&e[1]<p){let v=f[0]===d[0];if(!v){const x=(e[1]-f[1])*(d[0]-f[0])/(d[1]-f[1])+f[0];v=e[0]<=x}i+=v?1:0}}return!!(i%2)}function my(t,e){for(let n=0,r=e.length;n<r;n++)if(!qo(t,e[n]))return!1;return!0}function mm(t,e){let n=t;const r=e?.numDimensions||2,i=r===3;if(!Array.isArray(t[0])){const u=t,d=u.length/r;n=new Array(u.length/r);for(let h=0,p=d;h<p;h++)n[h]=[u[h*r],u[h*r+1]],i&&n[h].push(u[h*r+2])}let a=1/0,o=1/0,s=-1/0,l=-1/0,c=1/0,f=-1/0;n=n;for(let u=0,d=n.length;u<d;u++){const[h,p,g]=n[u];a=a<h?a:h,o=o<p?o:p,s=s>h?s:h,l=l>p?l:p,i&&(c=c<g?c:g,f=f>g?f:g)}return i?{minX:a,maxX:s,minY:o,maxY:l,minZ:c,maxZ:f}:{minX:a,maxX:s,minY:o,maxY:l}}function vy(t){const e=t.length;let n=0,r=e-1;for(let i=0;i<e;i++)n+=(t[r][0]+t[i][0])*(t[r][1]-t[i][1]),r=i;return Math.abs(n/2)}function a0(t){if(t.length<3)return 0;const e=t[0];let n=0;for(let r=0,i=t.length;r<i;r++){const a=t[r],o=r===i-1?0:r+1,s=t[o],l=a[0]-e[0],c=a[1]-e[1],f=s[0]-e[0],u=s[1]-e[1];n+=l*u-c*f}return n*=.5,n}function Ob(t){return a0(t)>=0?1:-1}function RAe(t){const e=ct(),n=t[0];for(let r=0,i=t.length;r<i;r++){const a=t[r],o=r===i-1?0:r+1,s=t[o],l=a[0]-n[0],c=a[1]-n[1],f=a[2]-n[2],u=s[0]-n[0],d=s[1]-n[1],h=s[2]-n[2];e[0]+=c*h-f*d,e[1]+=f*u-l*h,e[2]+=l*d-c*u}return Xs(e,e,.5),e}function AAe(t){const e=RAe(t);return Ir(e,e)}function Z6(t){const e=a0(t);return[0,0,e/Math.abs(e)]}const ma=1e-7;function R8(t,e){return t[0]*e[1]-t[1]*e[0]}function Ti(t,e){return fr(t,e,ma)}function _Q(t,e,n,r){const i=Ra(Hn(),e,t),a=Ra(Hn(),r,n),o=R8(i,a),s=Ra(Hn(),n,t),l=R8(s,i);if(Math.abs(o)<ma){if(Math.abs(l)<ma){const u=uf(i,i),d=uf(a,a);if(u<ma||d<ma)return Ti(t,n)||Ti(t,r)?t:Ti(e,n)||Ti(e,r)?e:null;const h=uf(Ra(Hn(),n,t),i)/u,p=uf(Ra(Hn(),r,t),i)/u,g=uf(Ra(Hn(),t,n),a)/d,m=uf(Ra(Hn(),e,n),a)/d,y=v=>v>=-ma&&v<=1+ma;if(y(h)){const v=mv(Hn(),t,i,h);if(Ti(n,v))return n}if(y(p)){const v=mv(Hn(),t,i,p);if(Ti(r,v))return r}if(y(g)){const v=mv(Hn(),n,a,g);if(Ti(t,v))return t}if(y(m)){const v=mv(Hn(),n,a,m);if(Ti(e,v))return e}}return null}const c=R8(s,a)/o,f=l/o;return c>=-ma&&c<=1+ma&&f>=-ma&&f<=1+ma?[t[0]+c*i[0],t[1]+c*i[1]]:null}var yf;(function(t){t[t.Vertex=0]="Vertex",t[t.Intersection=1]="Intersection"})(yf||(yf={}));var wo;(function(t){t[t.Entering=0]="Entering",t[t.Exiting=1]="Exiting",t[t.Unknown=2]="Unknown"})(wo||(wo={}));function DQ(t,e){if(t.length!==e.length)return!1;const n=t.length;if(n===0)return!0;let r=!0;for(let a=0;a<n;a++)if(!Ti(t[a],e[a])){r=!1;break}if(r)return!0;let i=!0;for(let a=0;a<n;a++)if(!Ti(t[a],e[n-1-a])){i=!1;break}if(i)return!0;for(let a=1;a<n;a++){let o=!0;for(let l=0;l<n;l++)if(!Ti(t[l],e[(l+a)%n])){o=!1;break}if(o)return!0;let s=!0;for(let l=0;l<n;l++)if(!Ti(t[l],e[(n-1-l+a)%n])){s=!1;break}if(s)return!0}return!1}function w7(t,e){if(t.length<3)return[];if(e.length<3)return[t.slice()];const n=e.slice();if(DQ(t,e))return[];const r=a0(t),i=a0(n);Math.sign(r)===Math.sign(i)&&Math.abs(i)>ma&&n.reverse();const a=[];for(let f=0;f<t.length;f++){const u=t[f],d=t[(f+1)%t.length];for(let h=0;h<n.length;h++){const p=n[h],g=n[(h+1)%n.length],m=_Q(u,d,p,g);if(m){const y=Math.sqrt(Xd(u,d)),v=Math.sqrt(Xd(p,g));a.push({coord:m,seg1Idx:f,seg2Idx:h,alpha1:y<ma?0:Math.sqrt(Xd(u,m))/y,alpha2:v<ma?0:Math.sqrt(Xd(p,m))/v})}}}const o=(f,u,d)=>{const h=[];let p=0;for(let m=0;m<f.length;m++){const y=f[m];h.push({id:`${u}_v${p++}`,coordinates:y,type:yf.Vertex,originalPolyIndex:u,originalVertexIndex:m,next:null,prev:null,isIntersection:!1,visited:!1});const v=d.filter(x=>(u===0?x.seg1Idx:x.seg2Idx)===m).sort((x,w)=>(u===0?x.alpha1:x.alpha2)-(u===0?w.alpha1:w.alpha2));for(const x of v){if(h.length>0&&Ti(h[h.length-1].coordinates,x.coord)){h[h.length-1].isIntersection||(h[h.length-1].isIntersection=!0,h[h.length-1].intersectionInfo=x,h[h.length-1].alpha=u===0?x.alpha1:x.alpha2);continue}h.push({id:`${u}_i${p++}`,coordinates:x.coord,type:yf.Intersection,originalPolyIndex:u,next:null,prev:null,isIntersection:!0,visited:!1,alpha:u===0?x.alpha1:x.alpha2,intersectionInfo:x})}}const g=[];if(h.length>0){g.push(h[0]);for(let m=1;m<h.length;m++)Ti(h[m].coordinates,g[g.length-1].coordinates)?h[m].isIntersection&&(g[g.length-1].isIntersection=!0,g[g.length-1].intersectionInfo=h[m].intersectionInfo,g[g.length-1].alpha=h[m].alpha):g.push(h[m])}if(g.length>0)for(let m=0;m<g.length;m++)g[m].next=g[(m+1)%g.length],g[m].prev=g[(m-1+g.length)%g.length];return g},s=o(t,0,a),l=o(n,1,a);s.forEach(f=>{if(f.isIntersection){const u=f.intersectionInfo,d=l.find(h=>h.isIntersection&&Ti(h.coordinates,f.coordinates)&&h.intersectionInfo.seg1Idx===u.seg1Idx&&h.intersectionInfo.seg2Idx===u.seg2Idx);if(d){f.partnerNode=d,d.partnerNode=f;const h=f.prev.coordinates,p=f.coordinates,g=d.next.coordinates;Ra(Hn(),p,h),Ra(Hn(),g,p);const m=[(f.prev.coordinates[0]+f.coordinates[0])/2,(f.prev.coordinates[1]+f.coordinates[1])/2];qo(e,m)?f.intersectionDir=wo.Exiting:f.intersectionDir=wo.Entering}else f.isIntersection=!1}}),s.forEach(f=>delete f.intersectionInfo),l.forEach(f=>delete f.intersectionInfo);const c=[];for(let f=0;f<s.length;f++){const u=s[f];if(u.visited||u.isIntersection||qo(e,u.coordinates))continue;const d=[];let h=u,p=!0,g=0;const m=(s.length+l.length)*2;do{if(g++>m){console.warn("Subtraction: Max iterations reached, possible infinite loop.");break}h.visited=!0,(d.length===0||!Ti(d[d.length-1],h.coordinates))&&d.push(h.coordinates),h.isIntersection&&(p?h.intersectionDir===wo.Entering&&h.partnerNode&&(h=h.partnerNode,p=!1):h.partnerNode?(h=h.partnerNode,p=!0):console.warn("Subtraction: Intersection on source without partner.")),h=h.next}while(h!==u||!p);d.length>=3&&(Ti(d[0],d[d.length-1])&&d.pop(),d.length>=3&&c.push(d))}return c}function PAe(t,e){if(t.length<3||e.length<3)return[];let n=e.slice();const r=a0(t),i=a0(n);if(Math.abs(r)<ma||Math.abs(i)<ma)return[];r<0&&(t=t.slice().reverse()),i<0&&(n=n.slice().reverse());const a=n,o=[];for(let u=0;u<t.length;u++){const d=t[u],h=t[(u+1)%t.length];for(let p=0;p<n.length;p++){const g=n[p],m=n[(p+1)%n.length],y=_Q(d,h,g,m);if(y){const v=Math.sqrt(Xd(d,h)),x=Math.sqrt(Xd(g,m));o.push({coord:[...y],seg1Idx:u,seg2Idx:p,alpha1:v<ma?0:Math.sqrt(Xd(d,y))/v,alpha2:x<ma?0:Math.sqrt(Xd(g,y))/x})}}}if(o.length===0)return qo(a,t[0])&&t.every(u=>qo(a,u))?[[...t.map(u=>[...u])]]:qo(t,n[0])&&n.every(u=>qo(t,u))?[[...n.map(u=>[...u])]]:[];const s=(u,d,h)=>{const p=[];let g=0;for(let y=0;y<u.length;y++){const v=u[y];p.push({id:`${d}_v${g++}`,coordinates:[...v],type:yf.Vertex,originalPolyIndex:d,originalVertexIndex:y,next:null,prev:null,isIntersection:!1,visited:!1,processedInPath:!1,intersectionDir:wo.Unknown});const x=h.filter(w=>(d===0?w.seg1Idx:w.seg2Idx)===y).sort((w,S)=>(d===0?w.alpha1:w.alpha2)-(d===0?S.alpha1:S.alpha2));for(const w of x){if(p.length>0&&Ti(p[p.length-1].coordinates,w.coord)){const S=p[p.length-1];S.isIntersection||(S.isIntersection=!0,S.intersectionInfo=w,S.alpha=d===0?w.alpha1:w.alpha2,S.type=yf.Intersection);continue}p.push({id:`${d}_i${g++}`,coordinates:[...w.coord],type:yf.Intersection,originalPolyIndex:d,next:null,prev:null,isIntersection:!0,visited:!1,processedInPath:!1,alpha:d===0?w.alpha1:w.alpha2,intersectionInfo:w,intersectionDir:wo.Unknown})}}const m=[];if(p.length>0){m.push(p[0]);for(let y=1;y<p.length;y++)if(!Ti(p[y].coordinates,m[m.length-1].coordinates))m.push(p[y]);else{const v=m[m.length-1];p[y].isIntersection&&p[y].intersectionInfo&&(v.isIntersection=!0,v.intersectionInfo=p[y].intersectionInfo,v.alpha=p[y].alpha,v.type=yf.Intersection)}}if(m.length>1&&Ti(m[0].coordinates,m[m.length-1].coordinates)){const y=m[0],v=m.pop();v.isIntersection&&!y.isIntersection&&v.intersectionInfo&&(y.isIntersection=!0,y.intersectionInfo=v.intersectionInfo,y.alpha=v.alpha,y.type=yf.Intersection)}if(m.length>0)for(let y=0;y<m.length;y++)m[y].next=m[(y+1)%m.length],m[y].prev=m[(y-1+m.length)%m.length];return m},l=s(t,0,o),c=s(n,1,o);if(l.length===0||c.length===0)return[];l.forEach(u=>{if(u.isIntersection&&u.intersectionInfo){const d=u.intersectionInfo,h=c.find(p=>p.isIntersection&&p.intersectionInfo&&Ti(p.coordinates,u.coordinates)&&p.intersectionInfo.seg1Idx===d.seg1Idx&&p.intersectionInfo.seg2Idx===d.seg2Idx);if(h){u.partnerNode=h,h.partnerNode=u;const p=Ra(Hn(),u.coordinates,u.prev.coordinates),g=Ra(Hn(),h.next.coordinates,h.coordinates),m=p[0]*g[1]-p[1]*g[0];if(m>ma)u.intersectionDir=wo.Entering,h.intersectionDir=wo.Exiting;else if(m<-ma)u.intersectionDir=wo.Exiting,h.intersectionDir=wo.Entering;else{const y=[(u.prev.coordinates[0]+u.coordinates[0])/2,(u.prev.coordinates[1]+u.coordinates[1])/2];qo(a,y)?(u.intersectionDir=wo.Exiting,h.intersectionDir=wo.Entering):(u.intersectionDir=wo.Entering,h.intersectionDir=wo.Exiting)}}else u.isIntersection=!1,u.intersectionInfo=void 0}});const f=[];for(const u of l){if(!u.isIntersection||u.visited||u.intersectionDir!==wo.Entering)continue;let d=[],h=u,p=!0;const g=u;let m=0;const y=(l.length+c.length)*2;l.forEach(v=>v.processedInPath=!1),c.forEach(v=>v.processedInPath=!1);do{if(m++>y){console.warn("Intersection: Max iterations in path tracing.",g.id,h.id),d=[];break}if(h.processedInPath&&h!==g){console.warn("Intersection: Path processing loop detected, discarding path segment.",g.id,h.id),d=[];break}h.processedInPath=!0,h.visited=!0,(d.length===0||!Ti(d[d.length-1],h.coordinates))&&d.push([...h.coordinates]);let v=!1;h.isIntersection&&h.partnerNode&&(p?(h=h.partnerNode,p=!1,v=!0):(h=h.partnerNode,p=!0,v=!0)),h=h.next}while(h!==g||p&&h.originalPolyIndex!==0||!p&&h.originalPolyIndex!==1);if(m>y||d.length===0||d.length>0&&Ti(d[0],d[d.length-1])&&d.pop(),d.length>=3){const v=a0(d);(r>0&&v<0||r<0&&v>0)&&d.reverse(),f.push(d.map(x=>[...x]))}}return f}function C7(t,e,n,r){let i=!1;const a=t[0]<e[0]?t[0]:e[0],o=t[1]<e[1]?t[1]:e[1],s=t[0]>e[0]?t[0]:e[0],l=t[1]>e[1]?t[1]:e[1],c=n[0]<r[0]?n[0]:r[0],f=n[1]<r[1]?n[1]:r[1],u=n[0]>r[0]?n[0]:r[0],d=n[1]>r[1]?n[1]:r[1];if(a>u||s<c||o>d||l<f)return!1;const h=[Ix(t,e,n),Ix(t,e,r),Ix(n,r,t),Ix(n,r,e)];return h[0]!==h[1]&&h[2]!==h[3]?!0:((h[0]===0&&Rx(t,n,e)||h[1]===0&&Rx(t,r,e)||h[2]===0&&Rx(n,t,r)||h[3]===0&&Rx(n,e,r))&&(i=!0),i)}function Ix(t,e,n){const r=(e[1]-t[1])*(n[0]-e[0])-(e[0]-t[0])*(n[1]-e[1]);return r===0?0:r>0?1:2}function Rx(t,e,n){return e[0]<=Math.max(t[0],n[0])&&e[0]>=Math.min(t[0],n[0])&&e[1]<=Math.max(t[1],n[1])&&e[1]>=Math.min(t[1],n[1])}function S7(t,e,n,r=!0){const i=[],a=t.length,o=a-(r?1:2);for(let s=0;s<=o;s++){const l=t[s],c=s===a-1?0:s+1,f=t[c];C7(e,n,l,f)&&i.push([s,c])}return i}function OQ(t,e,n,r=!0){let i,a;r?(a=t.length-1,i=0):(a=0,i=1);for(let o=i;o<t.length;o++){const s=t[a],l=t[o];if(C7(e,n,s,l))return[a,o];a=o}}function T7(t,e){for(let n=0,r=t.length;n<r;n++){const i=t[n],a=n===r-1?0:n+1,o=t[a];if(OQ(e,i,o)?.length===2)return!0}return!1}const NAe=.01;function MQ(t,e,n,r){const i=[e[0]-t[0],e[1]-t[1]],a=[r[0]-n[0],r[1]-n[1]],o=a[1]*i[0]-a[0]*i[1];if((o>=0?o:-o)<NAe){const p=[t[0]<e[0]?t[0]:e[0],t[0]>e[0]?t[0]:e[0],t[1]<e[1]?t[1]:e[1],t[1]>e[1]?t[1]:e[1]],g=[n[0]<r[0]?n[0]:r[0],n[0]>r[0]?n[0]:r[0],n[1]<r[1]?n[1]:r[1],n[1]>r[1]?n[1]:r[1]];if(!(p[0]<=g[1]&&p[1]>=g[0]&&p[2]<=g[3]&&p[3]>=g[2])||!(I8(t,e,n)||I8(t,e,r)||I8(n,r,t)))return;const v=p[0]>g[0]?p[0]:g[0],x=p[1]<g[1]?p[1]:g[1],w=p[2]>g[2]?p[2]:g[2],S=p[3]<g[3]?p[3]:g[3],T=(v+x)*.5,_=(w+S)*.5;return[T,_]}let l=t[1]-n[1],c=t[0]-n[0];const f=a[0]*l-a[1]*c,u=i[0]*l-i[1]*c;l=f/o,c=u/o;const d=t[0]+l*i[0],h=t[1]+l*i[1];return[d,h]}var Uh;(function(t){t[t.Vertex=0]="Vertex",t[t.Intersection=1]="Intersection"})(Uh||(Uh={}));var Bh;(function(t){t[t.Outside=-1]="Outside",t[t.Edge=0]="Edge",t[t.Inside=1]="Inside"})(Bh||(Bh={}));var Sg;(function(t){t[t.Exiting=-1]="Exiting",t[t.Unknown=0]="Unknown",t[t.Entering=1]="Entering"})(Sg||(Sg={}));function VV(t){for(let e=0,n=t.length;e<n;e++){const r=t[e];r.next||(r.next=t[e===n-1?0:e+1])}}function LAe(t,e){const n=[],r=[],i=new Map;let o=qo(e,t[0])?Sg.Exiting:Sg.Entering;for(let s=0,l=t.length;s<l;s++){const c=t[s],f=qo(e,c),u={type:Uh.Vertex,coordinates:c,position:f?Bh.Inside:Bh.Outside,visited:!1,next:null};n.push(u);const d=t[s===l-1?0:s+1],h=S7(e,c,d).map(p=>{const g=p[0],m=e[p[0]],y=e[p[1]],v=MQ(c,d,m,y),x=C0(c,v);return{sourceLineSegmentId:g,coordinate:v,targetStartPointDistSquared:x}});h.sort((p,g)=>p.targetStartPointDistSquared-g.targetStartPointDistSquared),h.forEach(p=>{const{sourceLineSegmentId:g,coordinate:m}=p,y={type:Uh.Intersection,coordinates:m,position:Bh.Edge,direction:o,visited:!1,next:null},v={...y,direction:Sg.Unknown,cloned:!0};o===Sg.Entering?y.next=v:v.next=y;let x=i.get(g);x||(x=[],i.set(g,x)),n.push(y),x.push(v),o*=-1})}for(let s=0,l=e.length;s<l;s++){const c=s,f=e[s],u={type:Uh.Vertex,coordinates:f,visited:!1,next:null};r.push(u);const d=i.get(c);d?.length&&d.map(h=>({intersectionPoint:h,lineSegStartDistSquared:C0(f,h.coordinates)})).sort((h,p)=>h.lineSegStartDistSquared-p.lineSegStartDistSquared).map(({intersectionPoint:h})=>h).forEach(h=>r.push(h))}return VV(n),VV(r),{targetPolylinePoints:n,sourcePolylinePoints:r}}function kAe(t){for(let e=0,n=t.length;e<n;e++){const r=t[e];if(!r.visited&&r.position===Bh.Outside&&r.type===Uh.Vertex)return r}for(let e=0,n=t.length;e<n;e++){const r=t[e];if(!r.visited&&r.position===Bh.Outside)return r}}function E7(t,e){const n=Z6(t),r=Z6(e),i=zt(r,n);if(l3(1,i)||(e=e.slice().reverse()),!T7(e,t)&&my(e,t))return e.slice();const{targetPolylinePoints:s}=LAe(t,e),l=kAe(s);if(!l)return t.slice();const c=[l.coordinates];let f=l.next,u=0;const d=t.length+e.length+1e3;for(;f!==l&&u<d;){if(u++,f.type===Uh.Intersection&&f.cloned){f=f.next;continue}if(c.push(f.coordinates),f=f.next,!f){console.warn("Broken linked list detected in mergePolylines, breaking loop");break}}return u>=d&&console.warn("Maximum iterations reached in mergePolylines, possible infinite loop detected"),c}const VAe=.1;function IQ(t,e=VAe){const n=t.length;if(n<3)return t;const r=e*e,i=[[0,n-1]],a=new Array(n).fill(!1);let o=2;for(a[0]=!0,a[n-1]=!0;i.length;){const[l,c]=i.pop();if(c-l===1)continue;const f=t[l],u=t[c];let d=-1/0,h=-1;for(let p=l+1;p<c;p++){const g=t[p],m=wC(f,u,g);m>d&&(d=m,h=p)}d<r||(a[h]=!0,o++,i.push([h,c]),i.push([l,h]))}const s=new Array(o);for(let l=0,c=0;l<n;l++)a[l]&&(s[c++]=t[l]);return s}function RQ(t,e,n,r=!0){const i=[],a=S7(t,e,n,r);for(let o=0;o<a.length;o++){const s=t[a[o][0]],l=t[a[o][1]],c=MQ(e,n,s,l);i.push(c)}return i}function FAe(t,e,n,r=!0){let i,a;r?(a=t.length-1,i=0):(a=0,i=1);const o=[];for(let f=i;f<t.length;f++){const u=t[a],d=t[f];C7(e,n,u,d)&&o.push([a,f]),a=f}if(o.length===0)return;const s=[];o.forEach(f=>{const u=[t[f[0]],t[f[1]]],d=[(u[0][0]+u[1][0])/2,(u[0][1]+u[1][1])/2];s.push(ei(d,e))});const l=Math.min(...s),c=s.indexOf(l);return{segment:o[c],distance:l}}const ag=.001,UAe=(t,e)=>{let n,r,i;if(t instanceof aa){const o=t.getImageData();if(!o)return;r=o.direction.slice(0,3),i=o.direction.slice(3,6),n=o.spacing}else{const o=t.getImageData(),{direction:s,spacing:l}=o,{viewPlaneNormal:c,viewUp:f}=t.getCamera(),u=s.slice(0,3),d=s.slice(3,6),h=s.slice(6,9),p=ct();dr(p,f,c);const g=Math.abs(zt(p,u)),m=Math.abs(zt(p,d)),y=Math.abs(zt(p,h));let v;if(Math.abs(1-g)<ag)v=l[0],r=u;else if(Math.abs(1-m)<ag)v=l[1],r=d;else if(Math.abs(1-y)<ag)v=l[2],r=h;else throw new Error("No support yet for oblique plane planar contours");const x=Math.abs(zt(f,u)),w=Math.abs(zt(f,d)),S=Math.abs(zt(f,h));let T;if(Math.abs(1-x)<ag)T=l[0],i=u;else if(Math.abs(1-w)<ag)T=l[1],i=d;else if(Math.abs(1-S)<ag)T=l[2],i=h;else throw new Error("No support yet for oblique plane planar contours");n=[v,T]}return{spacing:[n[0]/e,n[1]/e],xDir:r,yDir:i}},BAe=(t,e,n)=>$9(t,e)<n,$Ae=(t,e,n,r)=>{const{xDir:i,yDir:a,spacing:o}=r,s=et(t),{viewport:l}=s;if(!e.length)return e.push(n),console.log(">>>>> !canvasPoints. :: RETURN"),1;const c=l.canvasToWorld(e[e.length-1]),f=l.canvasToWorld(n),u=ct();Dr(u,f,c);const d=Math.abs(zt(u,i)),h=Math.abs(zt(u,a)),p=Math.max(Math.floor(d/o[0]),Math.floor(h/o[0]));if(p>1){const g=e[e.length-1],m=$9(g,n),y=Hn();Ra(y,n,g),Ol(y,y[0]/m,y[1]/m);const v=m/p;for(let x=1;x<=p;x++)e.push([g[0]+v*y[0]*x,g[1]+v*y[1]*x])}else e.push(n);return p},GAe=(t,e,n,r)=>{const i=[t[0]-e[0],t[1]-e[1]],a=[n[0]-e[0],n[1]-e[1]],o=i[0]*a[0]+i[1]*a[1];if(o<0)return!1;const s=Math.sqrt(a[0]*a[0]+a[1]*a[1]);if(s===0)return!1;const l=o/s,c=[a[0]/s,a[1]/s],f=[c[0]*l,c[1]*l],u=[e[0]+f[0],e[1]+f[1]];return!(ei(t,u)>r||ei(e,u)>ei(e,n))},jAe=1e-6;function AQ(t){let e;const n=r7(t,50);for(let o=0;o<3;o++)if(n.every((s,l,c)=>Math.abs(s[o]-c[0][o])<jAe)){e=o;break}if(e===void 0)throw new Error("Cannot find a shared dimension index for polyline, probably oblique plane");const r=[],i=(e+1)%3,a=(e+2)%3;for(let o=0;o<t.length;o++)r.push([t[o][i],t[o][a]]);return{sharedDimensionIndex:e,projectedPolyline:r}}function PQ(t,e,n={}){const{sharedDimensionIndex:r,projectedPolyline:i}=AQ(e),{holes:a}=n,o=[];if(a)for(let l=0;l<a.length;l++){const c=a[l],f=[];for(let u=0;u<c.length;u++)f.push([c[u][(r+1)%3],c[u][(r+2)%3]]);o.push(f)}const s=[t[(r+1)%3],t[(r+2)%3]];return qo(i,s,{holes:o})}function zAe(t){if(t.length<3)return t.slice();const e=t.map(a=>[a[0],a[1]]).sort((a,o)=>a[0]===o[0]?a[1]-o[1]:a[0]-o[0]);function n(a,o,s){return(o[0]-a[0])*(s[1]-a[1])-(o[1]-a[1])*(s[0]-a[0])}const r=[];for(const a of e){for(;r.length>=2&&n(r[r.length-2],r[r.length-1],a)<=0;)r.pop();r.push(a)}const i=[];for(let a=e.length-1;a>=0;a--){const o=e[a];for(;i.length>=2&&n(i[i.length-2],i[i.length-1],o)<=0;)i.pop();i.push(o)}return r.pop(),i.pop(),r.concat(i)}const pp=Object.freeze(Object.defineProperty({__proto__:null,addCanvasPointsToArray:$Ae,arePolylinesIdentical:DQ,containsPoint:qo,containsPoints:my,convexHull:zAe,decimate:IQ,getAABB:mm,getArea:vy,getClosestLineSegmentIntersection:FAe,getFirstLineSegmentIntersectionIndexes:OQ,getLineSegmentIntersectionsCoordinates:RQ,getLineSegmentIntersectionsIndexes:S7,getNormal2:Z6,getNormal3:AAe,getSignedArea:a0,getSubPixelSpacingAndXYDirections:UAe,getWindingDirection:Ob,intersectPolyline:T7,intersectPolylines:PAe,isClosed:EQ,isPointInsidePolyline3D:PQ,mergePolylines:E7,pointCanProjectOnLine:GAe,pointsAreWithinCloseContourProximity:BAe,projectTo2D:AQ,subtractPolylines:w7},Symbol.toStringTag,{value:"Module"}));function WAe(t,e,n,r){const i=[t,e],a=[t+n,e],o=[t+n,e],s=[t+n,e+r],l=[t+n,e+r],c=[t,e+r],f=[t,e+r];return{top:[i,a],right:[o,s],bottom:[l,c],left:[f,[t,e]]}}function HAe(t,e){if(t.length!==4||e.length!==2)throw Error("rectangle:[left, top, width, height] or point: [x,y] not defined correctly");const[n,r,i,a]=t;let o=655535;const s=WAe(n,r,i,a);return Object.keys(s).forEach(l=>{const[c,f]=s[l],u=Il(c,f,e);u<o&&(o=u)}),o}function FV(t,e){let n=[0,0],r=Number.MAX_SAFE_INTEGER;return t.forEach(function(i){const a=KAe(e,i);a<r&&(r=a,n=[...i])}),n}function KAe(t,e){const[n,r]=t,[i,a]=e;return Math.sqrt(Math.pow(n-i,2)+Math.pow(r-a,2))}function qAe(t,e){const[n,r]=t,[i,a]=e,o=ur(ct(),r,n),s=ur(ct(),i,a),l=zt(o,s),c=Ao(o),f=Ao(s),u=l/(c*f);return Math.acos(u)*180/Math.PI}function XAe(t,e){const[n,r]=t,[i,a]=e,o=Yh(Hn(),r,n),s=Yh(Hn(),i,a),l=uf(o,s),c=v6(o),f=v6(s),u=l/(c*f);return Math.acos(u)*(180/Math.PI)}function Mb(t,e){return t[0].length===3?qAe(t,e):XAe(t,e)}function _u(t,e,n,r){const{canvasToWorld:i,worldToCanvas:a}=n,{data:o}=t,{targetWindingDirection:s}=e;let{points:l}=e,c=Ob(l);r?.decimate?.enabled&&(l=IQ(e.points,r?.decimate?.epsilon));let{closed:f}=e;const u=l.length,d=new Array(u);Ob(l);const h=LZ(t);if(f===void 0){let p=!1;if(l.length>3){const g=C0(l[0],l[u-1]);p=fr(0,g)}f=p}if(r?.updateWindingDirection!==!1){let p=h?h.data.contour.windingDirection*-1:s;p===void 0&&(p=c),p!==c&&l.reverse();const g=(o.handles?.points??[]).map(a);g.length>2&&Ob(g)!==p&&o.handles.points.reverse(),c=p}for(let p=0;p<u;p++)d[p]=i(l[p]);o.contour.polyline=d,o.contour.closed=f,o.contour.windingDirection=c,kZ(t)}const YAe="viewport-element";function JAe(t){const e=et(t),{viewportId:n,renderingEngineId:r}=e,i=`${n}:${r}`,a=ZAe(t);return Object.keys(Mt.svgNodeCache[i]).forEach(o=>{Mt.svgNodeCache[i][o].touched=!1}),{svgLayerElement:a,svgNodeCacheForCanvas:Mt.svgNodeCache,getSvgNode:QAe.bind(this,i),appendNode:ePe.bind(this,a,i),setNodeTouched:tPe.bind(this,i),clearUntouched:nPe.bind(this,a,i)}}function ZAe(t){const e=`.${YAe}`;return t.querySelector(e)?.querySelector(":scope > .svg-layer")}function QAe(t,e){if(Mt.svgNodeCache[t]&&Mt.svgNodeCache[t][e])return Mt.svgNodeCache[t][e].domRef}function ePe(t,e,n,r){if(!Mt.svgNodeCache[e])return null;Mt.svgNodeCache[e][r]={touched:!0,domRef:n},t.appendChild(n)}function tPe(t,e){Mt.svgNodeCache[t]&&Mt.svgNodeCache[t][e]&&(Mt.svgNodeCache[t][e].touched=!0)}function nPe(t,e){Mt.svgNodeCache[e]&&Object.keys(Mt.svgNodeCache[e]).forEach(n=>{const r=Mt.svgNodeCache[e][n];!r.touched&&r.domRef&&(t.removeChild(r.domRef),delete Mt.svgNodeCache[e][n])})}function rPe(t,e){const n=JAe(t);e(n),n.clearUntouched()}function D0(t,e,n){return`${t}::${e}::${n}`}function xu(t,e){Object.keys(t).forEach(n=>{const r=e.getAttribute(n),i=t[n];i===void 0||i===""?e.removeAttribute(n):r!==i&&e.setAttribute(n,i)})}function gp(t,e){Object.keys(t).forEach(n=>{const r=t[n];r!==void 0&&r!==""&&e.setAttribute(n,r)})}function S0(t,e,n,r,i,a={},o=""){const{color:s,fill:l,width:c,lineWidth:f,lineDash:u,fillOpacity:d,strokeOpacity:h}=Object.assign({color:"rgb(0, 255, 0)",fill:"transparent",width:"2",lineDash:void 0,lineWidth:void 0,strokeOpacity:1,fillOpacity:1},a),p=f||c,g="http://www.w3.org/2000/svg",m=D0(e,"circle",n),y=t.getSvgNode(m),v={cx:`${r[0]}`,cy:`${r[1]}`,r:`${i}`,stroke:s,fill:l,"stroke-width":p,"stroke-dasharray":u,"fill-opacity":d,"stroke-opacity":h};if(y)xu(v,y),t.setNodeTouched(m);else{const x=document.createElementNS(g,"circle");o!==""&&x.setAttribute("data-id",o),gp(v,x),t.appendNode(x,m)}}function iPe(t,e,n,r,i={},a=""){const{color:o,width:s,lineWidth:l,lineDash:c}=Object.assign({color:"rgb(0, 255, 0)",width:"2",lineWidth:void 0,lineDash:void 0},i),f=l||s,u="http://www.w3.org/2000/svg",d=D0(e,"ellipse",n),h=t.getSvgNode(d),[p,g,m,y]=r,v=Math.hypot(m[0]-y[0],m[1]-y[1]),x=Math.hypot(g[0]-p[0],g[1]-p[1]),w=Math.atan2(m[1]-y[1],m[0]-y[0])*180/Math.PI,S=[(m[0]+y[0])/2,(g[1]+p[1])/2],T=v/2,_=x/2,D={cx:`${S[0]}`,cy:`${S[1]}`,rx:`${T}`,ry:`${_}`,stroke:o,fill:"transparent",transform:`rotate(${w} ${S[0]} ${S[1]})`,"stroke-width":f,"stroke-dasharray":c};if(h)xu(D,h),t.setNodeTouched(d);else{const I=document.createElementNS(u,"ellipse");a!==""&&I.setAttribute("data-id",a),gp(D,I),t.appendNode(I,d)}}function Q6(t,e,n,r,i={},a){const{color:o,handleRadius:s,width:l,lineWidth:c,fill:f,type:u,opacity:d}=Object.assign({color:"rgb(0, 255, 0)",handleRadius:"6",width:"2",lineWidth:void 0,fill:"transparent",type:"circle",opacity:1},i),h=c||l,p="http://www.w3.org/2000/svg",g=D0(e,"handle",`hg-${n}-index-${a}`);let m;if(u==="circle")m={cx:`${r[0]}`,cy:`${r[1]}`,r:s,stroke:o,fill:f,"stroke-width":h,opacity:d};else if(u==="rect"){const x=parseFloat(s)*1.5,w=r[0]-x*.5,S=r[1]-x*.5;m={x:`${w}`,y:`${S}`,width:`${x}`,height:`${x}`,stroke:o,fill:f,"stroke-width":h,rx:`${x*.1}`,opacity:d}}else throw new Error(`Unsupported handle type: ${u}`);const y=t.getSvgNode(g);if(y)xu(m,y),t.setNodeTouched(g);else{const v=document.createElementNS(p,u);gp(m,v),t.appendNode(v,g)}}function ho(t,e,n,r,i={}){r.forEach((a,o)=>{Q6(t,e,n,a,i,o)})}function Aa(t,e,n,r,i,a={},o=""){if(isNaN(r[0])||isNaN(r[1])||isNaN(i[0])||isNaN(i[1]))return;const{color:s="rgb(0, 255, 0)",width:l=10,lineWidth:c,lineDash:f,markerStartId:u=null,markerEndId:d=null,shadow:h=!1,strokeOpacity:p=1}=a,g=c||l,m="http://www.w3.org/2000/svg",y=D0(e,"line",n),v=t.getSvgNode(y),x=t.svgLayerElement.id,w=h?`filter:url(#shadow-${x});`:"",S={x1:`${r[0]}`,y1:`${r[1]}`,x2:`${i[0]}`,y2:`${i[1]}`,stroke:s,style:w,"stroke-width":g,"stroke-dasharray":f,"marker-start":u?`url(#${u})`:"","marker-end":d?`url(#${d})`:"","stroke-opacity":p};if(v)xu(S,v),t.setNodeTouched(y);else{const T=document.createElementNS(m,"line");o!==""&&T.setAttribute("data-id",o),gp(S,T),t.appendNode(T,y)}}function Of(t,e,n,r,i){if(r.length<2)return;const{color:a="rgb(0, 255, 0)",width:o=10,fillColor:s="none",fillOpacity:l=0,lineWidth:c,lineDash:f,closePath:u=!1,markerStartId:d=null,markerEndId:h=null}=i,p=c||o,g="http://www.w3.org/2000/svg",m=D0(e,"polyline",n),y=t.getSvgNode(m);let v="";for(const w of r)v+=`${w[0].toFixed(1)}, ${w[1].toFixed(1)} `;if(u){const w=r[0];v+=`${w[0]}, ${w[1]}`}const x={points:v,stroke:a,fill:s,"fill-opacity":l,"stroke-width":p,"stroke-dasharray":f,"marker-start":d?`url(#${d})`:"","marker-end":h?`url(#${h})`:""};if(y)xu(x,y),t.setNodeTouched(m);else{const w=document.createElementNS(g,"polyline");gp(x,w),t.appendNode(w,m)}}function $h(t,e,n,r,i){const o=r.length&&r[0].length&&Array.isArray(r[0][0])?r:[r],{color:s="rgb(0, 255, 0)",width:l=10,fillColor:c="none",fillOpacity:f=0,lineWidth:u,lineDash:d,closePath:h=!1}=i,p=u||l,g="http://www.w3.org/2000/svg",m=D0(e,"path",n),y=t.getSvgNode(m);let v="";for(let w=0,S=o.length;w<S;w++){const T=o[w],_=T.length;if(!(_<2)){for(let D=0;D<_;D++){const I=T[D];v+=`${D?"L":"M"} ${I[0].toFixed(1)}, ${I[1].toFixed(1)} `}h&&(v+="Z ")}}if(!v)return;const x={d:v,stroke:s,fill:c,"fill-opacity":f,"stroke-width":p,"stroke-dasharray":d};if(y)xu(x,y),t.setNodeTouched(m);else{const w=document.createElementNS(g,"path");gp(x,w),t.appendNode(w,m)}}function N2(t,e,n,r,i,a={}){const o=Object.assign({fontFamily:"Helvetica, Arial, sans-serif",fontSize:"14px",color:"rgb(255, 255, 0)",background:"",padding:25,centerX:!1,centerY:!0},a);return aPe(t,e,n,r,i,o)}function aPe(t,e,n,r=[""],i,a){const{padding:o,color:s,fontFamily:l,fontSize:c,background:f}=a;let u;const[d,h]=[i[0]+o,i[1]+o],p="http://www.w3.org/2000/svg",g=D0(e,"text",n),m=t.getSvgNode(g);if(m){const y=m.querySelector("text"),v=Array.from(y.children);for(let S=0;S<v.length;S++){const T=v[S],_=r[S]||"";T.textContent=_}if(r.length>v.length){for(let S=0;S<r.length-v.length;S++){const T=r[S+v.length],_=UV(T);y.appendChild(_)}m.appendChild(y),t.appendNode(m,g)}const x={fill:s,"font-size":c,"font-family":l},w={transform:`translate(${d} ${h})`};xu(x,y),xu(w,m),m.setAttribute("data-annotation-uid",e),u=BV(m,f),t.setNodeTouched(g)}else{const y=document.createElementNS(p,"g");y.setAttribute("data-annotation-uid",e),y.setAttribute("transform",`translate(${d} ${h})`);const v=oPe(t,a);for(let x=0;x<r.length;x++){const w=r[x],S=UV(w);v.appendChild(S)}y.appendChild(v),t.appendNode(y,g),u=BV(y,f)}return Object.assign({},u,{x:d,y:h,height:u.height+o,width:u.width+o})}function oPe(t,e){const{color:n,fontFamily:r,fontSize:i}=e,o=document.createElementNS("http://www.w3.org/2000/svg","text"),s="user-select: none; pointer-events: none; -webkit-tap-highlight-color:  rgba(255, 255, 255, 0);",l=`filter:url(#shadow-${t.svgLayerElement.id});`,c=`${s}${l}`;return o.setAttribute("x","0"),o.setAttribute("y","0"),o.setAttribute("fill",n),o.setAttribute("font-family",r),o.setAttribute("font-size",i),o.setAttribute("style",c),o.setAttribute("pointer-events","visible"),o}function UV(t){const n=document.createElementNS("http://www.w3.org/2000/svg","tspan");return n.setAttribute("x","0"),n.setAttribute("dy","1.2em"),n.textContent=t,n}function BV(t,e){let n=t.querySelector("rect.background");if(!e)return n&&t.removeChild(n),t.getBBox();n||(n=document.createElementNS("http://www.w3.org/2000/svg","rect"),n.setAttribute("class","background"),t.insertBefore(n,t.firstChild));const r=t.getBBox(),i={x:`${r.x}`,y:`${r.y}`,width:`${r.width}`,height:`${r.height}`,fill:e};return xu(i,n),r}function sPe(t,e,n,r,i,a,o={}){const s=r.length>0?FV(r,i):i,l=lPe(a),c=FV(l,s),f=Object.assign({color:"rgb(255, 255, 0)",lineWidth:"1",lineDash:"2,3"},o);Aa(t,e,`link-${n}`,s,c,f)}function lPe(t){const{x:e,y:n,height:r,width:i}=t,a=i/2,o=r/2,s=[e+a,n],l=[e,n+o],c=[e+a,n+r],f=[e+i,n+o];return[s,l,c,f]}function rl(t,e,n,r,i,a,o,s={}){const l=Object.assign({handleRadius:"6",centering:{x:!1,y:!0}},s),c=N2(t,e,n,r,i,l);return sPe(t,e,n,a,i,c,l),c}function NQ(t,e,n,r,i={},a=""){const{color:o,width:s,lineWidth:l,lineDash:c}=Object.assign({color:"rgb(0, 255, 0)",width:"2",lineWidth:void 0,lineDash:void 0},i),f=l||s,u="http://www.w3.org/2000/svg",d=D0(e,"rect",n),h=t.getSvgNode(d),[p,g,m,y]=r,v=Math.hypot(p[0]-g[0],p[1]-g[1]),x=Math.hypot(p[0]-m[0],p[1]-m[1]),w=[(y[0]+p[0])/2,(y[1]+p[1])/2],S=[(m[0]+p[0])/2,(m[1]+p[1])/2],T=Math.atan2(w[1]-S[1],w[0]-S[0])*180/Math.PI,_={x:`${w[0]-v/2}`,y:`${w[1]-x/2}`,width:`${v}`,height:`${x}`,stroke:o,fill:"transparent",transform:`rotate(${T} ${w[0]} ${w[1]})`,"stroke-width":f,"stroke-dasharray":c};if(h)xu(_,h),t.setNodeTouched(d);else{const D=document.createElementNS(u,"rect");a!==""&&D.setAttribute("data-id",a),gp(_,D),t.appendNode(D,d)}}function _7(t,e,n,r,i,a={},o=""){const s=[r[0],r[1]],l=[i[0],r[1]],c=[r[0],i[1]],f=[i[0],i[1]];NQ(t,e,n,[s,l,c,f],a,o)}const $V="http://www.w3.org/2000/svg";function GV(t,e,n,r,i,a={}){if(isNaN(r[0])||isNaN(r[1])||isNaN(i[0])||isNaN(i[1]))return;const{viaMarker:o=!1,color:s="rgb(0, 255, 0)",markerSize:l=10}=a;if(!o){cPe(t,e,n,r,i,a);return}const c=t.svgLayerElement.id,u=`${`arrow-${e}`}-${c}`,d=t.svgLayerElement.querySelector("defs");let h=d.querySelector(`#${u}`);if(h){h.setAttribute("markerWidth",`${l}`),h.setAttribute("markerHeight",`${l}`);const p=h.querySelector("path");p&&p.setAttribute("fill",s)}else{h=document.createElementNS($V,"marker"),h.setAttribute("id",u),h.setAttribute("viewBox","0 0 10 10"),h.setAttribute("refX","8"),h.setAttribute("refY","5"),h.setAttribute("markerWidth",`${l}`),h.setAttribute("markerHeight",`${l}`),h.setAttribute("orient","auto");const p=document.createElementNS($V,"path");p.setAttribute("d","M 0 0 L 10 5 L 0 10 z"),p.setAttribute("fill",s),h.appendChild(p),d.appendChild(h)}a.markerEndId=u,Aa(t,e,n,r,i,a)}function cPe(t,e,n,r,i,a={}){const{color:o="rgb(0, 255, 0)",width:s=2,lineWidth:l,lineDash:c}=a,f=10,u=Math.atan2(i[1]-r[1],i[0]-r[0]),d={start:[i[0]-f*Math.cos(u-Math.PI/7),i[1]-f*Math.sin(u-Math.PI/7)],end:i},h={start:[i[0]-f*Math.cos(u+Math.PI/7),i[1]-f*Math.sin(u+Math.PI/7)],end:i};Aa(t,e,n,r,i,{color:o,width:s,lineWidth:l,lineDash:c}),Aa(t,e,"2",d.start,d.end,{color:o,width:s,lineWidth:l,lineDash:c}),Aa(t,e,"3",h.start,h.end,{color:o,width:s,lineWidth:l,lineDash:c})}function uPe(t,e){const n=et(t),{renderingEngineId:r,viewportId:i}=n,a=qa(i,r);if(!a)return[];const o=[],s=Object.keys(a.toolOptions);for(let l=0;l<s.length;l++){const c=s[l],f=a.toolOptions[c];if(f&&e.includes(f.mode)){const u=a.getToolInstance(c);o.push(u)}}return o}const{Active:fPe,Passive:dPe,Enabled:hPe}=vr;class pPe{constructor(){this._needsRender=new Set,this._animationFrameSet=!1,this._animationFrameHandle=null,this._renderFlaggedViewports=()=>{this._throwIfDestroyed();const e=Array.from(this._viewportElements.values());for(let n=0;n<e.length;n++){const r=e[n];if(this._needsRender.has(r)&&(this._triggerRender(r),this._needsRender.delete(r),this._needsRender.size===0))break}this._animationFrameSet=!1,this._animationFrameHandle=null,this._render()},this._viewportElements=new Map}addViewportElement(e,n){this._viewportElements.set(e,n)}removeViewportElement(e,n){this._viewportElements.delete(e),this._needsRender.delete(n),this._reset()}renderViewport(e){this._setViewportsToBeRenderedNextFrame([e])}_throwIfDestroyed(){if(this.hasBeenDestroyed)throw new Error("this.destroy() has been manually called to free up memory, can not longer use this instance. Instead make a new one.")}_setAllViewportsToBeRenderedNextFrame(){[...this._viewportElements.values()].forEach(n=>{this._needsRender.add(n)}),this._renderFlaggedViewports()}_setViewportsToBeRenderedNextFrame(e){const n=[...this._viewportElements.values()];e.forEach(r=>{n.indexOf(r)!==-1&&this._needsRender.add(r)}),this._render()}_render(){this._needsRender.size>0&&this._animationFrameSet===!1&&(this._animationFrameHandle=window.requestAnimationFrame(this._renderFlaggedViewports),this._animationFrameSet=!0)}_triggerRender(e){const n=et(e);if(!n)return;if(!$f(n.renderingEngineId)){console.warn("rendering Engine has been destroyed");return}const i=uPe(e,[fPe,dPe,hPe]),{renderingEngineId:a,viewportId:o}=n,s={element:e,renderingEngineId:a,viewportId:o};rPe(e,l=>{let c=!1;const f=u=>{if(u.renderAnnotation){const d=u.renderAnnotation(n,l);c=c||d}};i.forEach(f),c&&Ct(e,ee.ANNOTATION_RENDERED,{...s})})}_reset(){window.cancelAnimationFrame(this._animationFrameHandle),this._needsRender.clear(),this._animationFrameSet=!1,this._animationFrameHandle=null,this._setAllViewportsToBeRenderedNextFrame()}}const D7=new pPe;function yy(t){D7.renderViewport(t)}function ut(t){t.length&&t.forEach(e=>{const n=mr(e);if(!n){console.warn(`Viewport not available for ${e}`);return}const{viewport:r}=n;if(!r){console.warn(`Viewport not available for ${e}`);return}const i=r.element;yy(i)})}function gPe(t,e){const n=t.length,r=[];for(let i=0;i<n;i++){const a=t[i];a.getFrameOfReferenceUID()===e&&r.push(a)}return r}const{Active:mPe,Passive:vPe,Enabled:yPe}=vr;function xPe(t,e){const n=t.length,r=[];for(let i=0;i<n;i++){const a=t[i],o=qa(a.id,a.renderingEngineId);if(!o)continue;bPe(o,e)&&r.push(a)}return r}function bPe(t,e){const{toolOptions:n}=t,r=n[e];if(!r)return!1;const i=r.mode;return i===mPe||i===vPe||i===yPe}function wPe(t,e,n=.999){return t.filter(r=>{const i=r.getCamera();return Math.abs(zt(i.viewPlaneNormal,e.viewPlaneNormal))>n})}function fn(t,e,n=!0){const r=et(t),{renderingEngine:i,FrameOfReferenceUID:a}=r;let o=i.getViewports();o=gPe(o,a),o=xPe(o,e);const s=i.getViewport(r.viewportId);return n&&(o=wPe(o,s.getCamera())),o.map(c=>c.id)}const q3="PlanarFreehandContourSegmentationTool";function O7(t,e){const n=t.length,r=new Array(n);for(let i=0;i<n;i++)r[i]=e.worldToCanvas(t[i]);return r}function CPe(t,e){return py(e).map(n=>{const r=n,i=O7(r.data.contour.polyline,t);return{annotation:r,polyline:i}})}function LQ(t,e,n){hy(e,n),x0(n);const{contour:r}=n.data,i=O7(r.polyline,t);_u(n,{points:i,closed:r.closed,targetWindingDirection:e.data.contour.windingDirection===Zo.Clockwise?Zo.CounterClockwise:Zo.Clockwise},t);const{element:a}=t;kQ(t,[e,n])}function SPe(t,e,n,r,i){if(!pC(q3)){console.warn(`${q3} is not registered in cornerstone. Cannot combine polylines.`);return}const a=i[0],o=qo(n,a),s=CPe(t,e),l=new Set(s),c=new Map,f=(v,x)=>{let w=c.get(v);w||(w=[],c.set(v,w)),w.push(x),l.delete(x)},u=[];if(o){const v=E7(n,i);u.push(v),Array.from(l.keys()).forEach(x=>f(v,x))}else w7(n,i).forEach(x=>{u.push(x),Array.from(l.keys()).forEach(w=>{my(x,w.polyline)&&f(x,w)})});Array.from(c.values()).forEach(v=>v.forEach(x=>hC(x.annotation)));const{element:d}=t,{metadata:h,data:p}=e,{handles:g,segmentation:m}=p,{textBox:y}=g;Cr(r.annotationUID),Cr(e.annotationUID),x0(r),x0(e);for(let v=0;v<u.length;v++){const x=u[v];if(!x||x.length<3){console.warn("Skipping creation of new annotation due to invalid polyline:",x);continue}const w=TPe(t,e,x);hr(w,d),b0(w),Fn(w,t.element),c.get(x)?.forEach(S=>hy(w,S.annotation))}kQ(t,[e,r])}function TPe(t,e,n){const r=t.canvasToWorld(n[0]),i=t.canvasToWorld(n[n.length-1]),a={metadata:{...e.metadata,toolName:q3,originalToolName:e.metadata.originalToolName||e.metadata.toolName},data:{cachedStats:{},handles:{points:[r,i],textBox:e.data.handles.textBox?{...e.data.handles.textBox}:void 0},contour:{polyline:[],closed:!0},spline:e.data.spline,segmentation:{...e.data.segmentation}},annotationUID:or(),highlighted:!0,invalidated:!0,isLocked:!1,isVisible:void 0,interpolationUID:e.interpolationUID,interpolationCompleted:e.interpolationCompleted};return _u(a,{points:n,closed:!0,targetWindingDirection:Zo.Clockwise},t),a}function kQ(t,e){const{element:n}=t,r=new Set([q3]);e.forEach(i=>{r.add(i.metadata.toolName)});for(const i of r.values())if(pC(i)){const a=fn(n,i);ut(a)}}function CC(t){return!!t.data?.segmentation}function EPe(t,e,n){const r=[],i=mm(e);for(let a=0;a<n.length;a++){const o=n[a],s=_Pe(o.data.contour.polyline,t),l=mm(s);if(!TAe(i,l))continue;const f=T7(e,s),u=!f&&my(s,e);(f||u)&&r.push({targetAnnotation:o,targetPolyline:s,isContourHole:u})}return r}function _Pe(t,e){const n=t.length,r=new Array(n);for(let i=0;i<n;i++)r[i]=e.worldToCanvas(t[i]);return r}const X3="PlanarFreehandContourSegmentationTool";function DPe(t,e,n,r){const i=r.filter(o=>o.isContourHole),a=r.filter(o=>!o.isContourHole);if(i.length>0){const o=i[0];APe(t,o.targetAnnotation,e),VQ(t,[e,o.targetAnnotation]);return}if(a.length!==0){if(!pC(X3)){console.warn(`${X3} is not registered in cornerstone. Cannot process multiple intersections.`);return}OPe(t,e,n,a)}}function OPe(t,e,n,r){const{element:i}=t,a=[e],o=[],s=[];r.forEach(({targetAnnotation:d})=>{const h=RPe(t,d);s.push(...h),a.push(d)});const l=n[0];if(r.some(({targetPolyline:d})=>qo(d,l))){let d=n;r.forEach(({targetPolyline:h})=>{d=E7(d,h)}),o.push(d)}else r.forEach(({targetPolyline:d})=>{const h=w7(d,n);o.push(...h)});a.forEach(d=>{Cr(d.annotationUID),x0(d)}),s.forEach(d=>hC(d.annotation));const f=r[0].targetAnnotation,u=[];o.forEach(d=>{if(!d||d.length<3){console.warn("Skipping creation of new annotation due to invalid polyline:",d);return}const h=MPe(t,f,d);hr(h,i),b0(h),Fn(h,t.element),u.push(h)}),IPe(t,s,u),VQ(t,a)}function MPe(t,e,n){const r=t.canvasToWorld(n[0]),i=t.canvasToWorld(n[n.length-1]),a={metadata:{...e.metadata,toolName:X3,originalToolName:e.metadata.originalToolName||e.metadata.toolName},data:{cachedStats:{},handles:{points:[r,i],textBox:e.data.handles.textBox?{...e.data.handles.textBox}:void 0},contour:{polyline:[],closed:!0},spline:e.data.spline,segmentation:{...e.data.segmentation}},annotationUID:or(),highlighted:!0,invalidated:!0,isLocked:!1,isVisible:void 0,interpolationUID:e.interpolationUID,interpolationCompleted:e.interpolationCompleted};return _u(a,{points:n,closed:!0,targetWindingDirection:Zo.Clockwise},t),a}function IPe(t,e,n){e.forEach(r=>{const i=n.find(a=>{const o=M7(a.data.contour.polyline,t);return my(o,r.polyline)});i&&hy(i,r.annotation)})}function RPe(t,e){return py(e).map(n=>{const r=n,i=M7(r.data.contour.polyline,t);return{annotation:r,polyline:i}})}function APe(t,e,n){hy(e,n),x0(n);const{contour:r}=n.data,i=M7(r.polyline,t);_u(n,{points:i,closed:r.closed,targetWindingDirection:e.data.contour.windingDirection===Zo.Clockwise?Zo.CounterClockwise:Zo.Clockwise},t)}function M7(t,e){const n=t.length,r=new Array(n);for(let i=0;i<n;i++)r[i]=e.worldToCanvas(t[i]);return r}function VQ(t,e){const{element:n}=t,r=new Set([X3]);e.forEach(i=>{r.add(i.metadata.toolName)});for(const i of r.values())if(pC(i)){const a=fn(n,i);ut(a)}}const{isEqual:jV}=Hr;function FQ(t){const{metadata:e}=t;return HJ().filter(n=>{if(n.FrameOfReferenceUID===e.FrameOfReferenceUID){const r=n.viewport,{viewPlaneNormal:i,viewUp:a}=r.getCamera();return jV(i,e.viewPlaneNormal)&&(!e.viewUp||jV(a,e.viewUp))}}).map(n=>n.viewport)}function PPe(t){if(!t)throw new Error(`No contours found for geometryId ${t.id}`);const e=t.id;if(t.type!==ou.CONTOUR)throw new Error(`Geometry type ${t.type} not supported for rendering.`);if(!t.data){console.warn(`No contours found for geometryId ${e}. Skipping render.`);return}}function NPe(t,e,n,r){n.size?t.render():LPe(t,e,r)}function LPe(t,e,n){const{segmentationId:r}=n,i=new Map;e.forEach(a=>{const o=yt.getGeometry(a);if(!o){console.warn(`No geometry found for geometryId ${a}. Skipping render.`);return}const s=o.data.segmentIndex;PPe(o);const l=em.getStyle({viewportId:t.id,segmentationId:r,type:pn.Contour,segmentIndex:s}),c=o.data,f=t.getCamera().viewPlaneNormal;c.contours.forEach(u=>{const{points:d,color:h,id:p}=u,g=eAe(t,d[0],f),m={annotationUID:or(),data:{contour:{closed:!0,polyline:d},segmentation:{segmentationId:r,segmentIndex:s,color:h,id:p},handles:{}},handles:{},highlighted:!1,autoGenerated:!1,invalidated:!1,isLocked:!0,isVisible:!0,metadata:{referencedImageId:g,toolName:"PlanarFreehandContourSegmentationTool",FrameOfReferenceUID:t.getFrameOfReferenceUID(),viewPlaneNormal:t.getCamera().viewPlaneNormal}},y=t.element;hr(m,y),b0(m)}),l&&i.set(s,l)}),t.render()}function kPe(t,e,n=!1){const r=Ki(e),{annotationUIDsMap:i}=r.representationData.Contour;i.forEach(a=>{a.forEach(o=>{Cr(o)})})}function VPe(t){const e=IRe(t);if(e)return e;const n=Ki(t);if(!n)throw new Error(`No segmentation found for segmentationId ${t}`);let r;if(n.representationData.Labelmap)r=FPe(n,t);else if(n.representationData.Contour)r=$Pe(n);else if(n.representationData.Surface)r=GPe(n);else throw new Error(`Unsupported segmentation type: ${n.representationData}`);return RRe(t,r),r}function FPe(t,e){const n=t.representationData[pn.Labelmap],r=new Set;return n.imageIds?BPe(r,n.imageIds):UPe(r,e),Array.from(r).map(Number).sort((i,a)=>i-a)}function UPe(t,e){yt.getVolume(e).voxelManager.forEach(({value:r})=>{r!==0&&t.add(r)})}function BPe(t,e){e.forEach(n=>{yt.getImage(n).voxelManager.getScalarData().forEach(a=>{a!==0&&t.add(a)})})}function $Pe(t){const{annotationUIDsMap:e,geometryIds:n}=t.representationData.Contour||{};if(!n)throw new Error(`No geometryIds found for segmentationId ${t.segmentationId}`);const r=new Set([...e.keys()]);return n.forEach(i=>{const a=yt.getGeometry(i);r.add(a.data.segmentIndex)}),Array.from(r).sort((i,a)=>i-a)}function GPe(t){const e=t.representationData.Surface?.geometryIds??[];return Array.from(e.keys()).map(Number).sort((n,r)=>n-r)}const og=new Map,zV=new Map;function jPe(t,e,n=!1){const r=mr(t);if(!r)return;const{viewport:i}=r;kPe(t,e),n&&i.render()}async function zPe(t,e){const{segmentationId:n}=e,r=Ki(n);if(!r)return;let i=r.representationData[pn.Contour];const a=Df();if(!i&&Df()?.canComputeRequestedRepresentation(n,pn.Contour)&&!og.get(t.id)?(og.set(t.id,!0),i=await y7(n,pn.Contour,()=>a.computeContourData(n,{viewport:t}),()=>{}),og.set(t.id,!1)):!i&&!Df()&&console.debug(`No contour data found for segmentationId ${n} and PolySeg add-on is not configured. Unable to convert from other representations to contour. Please register PolySeg using cornerstoneTools.init({ addons: { polySeg } }) to enable automatic conversion.`),!i||!i.geometryIds?.length)return;let o=!1;const s=t.getCamera().viewPlaneNormal;i.annotationUIDsMap&&(o=!HPe(i.annotationUIDsMap,s)),i.geometryIds.length>0&&(o=!WPe(i.geometryIds,s));const l=zV.get(t.id)||new Set;if(o&&!og.get(t.id)&&!l.has(n)&&t.viewportStatus===So.RENDERED){og.set(t.id,!0);const c=VPe(n),u=(await a.computeSurfaceData(n,{segmentIndices:c,viewport:t})).geometryIds,d=[];for(const m of u.values()){const v=yt.getGeometry(m).data;d.push({points:v.points,polys:v.polys,segmentIndex:v.segmentIndex,id:v.segmentIndex})}const h=await a.clipAndCacheSurfacesForViewport(d,t),p=a.extractContourData(h),g=a.createAndAddContourSegmentationsFromClippedSurfaces(p,t,n);i.annotationUIDsMap=new Map([...i.annotationUIDsMap,...g]),l.add(n),zV.set(t.id,l),og.set(t.id,!1)}NPe(t,i.geometryIds,i.annotationUIDsMap,e)}function WPe(t,e){let n=null,r=null;for(const u of t){const d=yt.getGeometry(u);if(!d)continue;const h=d.data;if(h.contours?.[0]?.points?.length>=3){n=d,r=h;break}}if(!n||!r)return!1;const a=r.contours[0].points,o=a[0],s=a[1],l=a[2];let c=dr(ct(),ur(ct(),s,o),ur(ct(),l,o));c=Ir(ct(),c);const f=zt(c,e);return Math.abs(f)>.9}function HPe(t,e){const n=Array.from(t.values()).flat().map(i=>Array.from(i)).flat(),r=r7(n,3);for(const i of r){const a=co(i);if(a?.metadata){if(!a.metadata.viewPlaneNormal)continue;const o=a.metadata.viewPlaneNormal,s=Math.abs(e[0]*o[0]+e[1]*o[1]+e[2]*o[2]);if(Math.abs(s-1)>.01)return!1}}return!0}const KPe={render:zPe,removeRepresentation:jPe};function SC(t,e){return vm(t,e)[0]}function vm(t,e){return Ds.getCurrentLabelmapImageIdsForViewport(t,e)}const WV=new Map,qPe=({cfun:t,ofun:e,actor:n})=>{n.getProperty().setRGBTransferFunction(1,t),n.getProperty().setScalarOpacity(1,e)};async function XPe({viewport:t,volumeInputs:e,segmentationId:n}){const r=t.getDefaultActor(),{actor:i}=r,{uid:a,callback:o}=r,s=t.getVolumeId();if(WV.get(a)?.added)return{uid:a,actor:i};const l=e,c=yt.getVolume(l[0].volumeId);if(!c)throw new Error(`imageVolume with id: ${c.volumeId} does not exist`);const{volumeId:f}=l[0],u=await LD(f);if(!u)throw new Error(`segImageVolume with id: ${u.volumeId} does not exist`);const h=u.voxelManager.getCompleteScalarDataArray(),{imageData:p}=u,g=yt.getVolume(s),y=g.voxelManager.getCompleteScalarDataArray(),v=2,x=new Float32Array(v*g.voxelManager.getScalarDataLength()),w=p.getDimensions();for(let I=0;I<w[2];++I)for(let R=0;R<w[1];++R)for(let M=0;M<w[0];++M){const A=M+w[0]*(R+w[1]*I);x[A*v+0]=y[A],x[A*v+1]=h[A]}t.removeActors([a]);const S=i.getMapper(),T=$Y(S);i.setMapper(T),T.setBlendMode(t0.LABELMAP_EDGE_PROJECTION_BLEND);const _=T.getInputData().getPointData().getArray(0);_.setData(x),_.setNumberOfComponents(2),i.getProperty().setColorMixPreset(1),i.getProperty().setForceNearestInterpolation(1,!0),i.getProperty().setIndependentComponents(!0),t.addActor({actor:i,uid:a,callback:o,referencedId:s,representationUID:`${n}-${pn.Labelmap}`}),WV.set(a,{added:!0,segmentationRepresentationUID:`${n}`,originalBlendMode:t.getBlendMode()}),i.set({preLoad:qPe});function D(I){const{segmentationId:R}=I.detail,{representationData:M}=Ki(R),{volumeId:A}=M.Labelmap;if(A!==u.volumeId)return;const P=yt.getVolume(A).voxelManager,B=T.getInputData(),U=B.getPointData().getArray(0),G=U.getData(),F=2,$=p.getDimensions(),V=Array.from({length:$[2]},(X,Q)=>Q);for(const X of V)for(let Q=0;Q<$[1];++Q)for(let re=0;re<$[0];++re){const ye=re+$[0]*(Q+$[1]*X);G[ye*F+1]=P.getAtIndex(ye)}U.setData(G),B.modified(),t.render()}return St.addEventListenerDebounced(ee.SEGMENTATION_DATA_MODIFIED,D,200),St.addEventListener(ee.SEGMENTATION_REPRESENTATION_REMOVED,async I=>{St.removeEventListener(ee.SEGMENTATION_DATA_MODIFIED,D);const R=t.getActor(a),{element:M,id:A}=t;t.removeActors([a]);const L=await _3({volumeId:a,blendMode:t0.MAXIMUM_INTENSITY_BLEND,callback:({volumeActor:P})=>{R.callback&&R.callback({volumeActor:P,volumeId:f})}},M,A);t.addActor({actor:L,uid:a}),t.render()}),{uid:a,actor:i}}const{uuidv4:UQ}=Hr;async function YPe(t,e,n,r){const i=et(t),{renderingEngine:a,viewport:o}=i,{id:s}=o,l=!0,c=!1,f=!0;if(o instanceof lo){const d=JPe(e,n);yt.getVolume(d)||await ZPe(e);let h=r?.blendMode??t0.MAXIMUM_INTENSITY_BLEND,p=h===t0.LABELMAP_EDGE_PROJECTION_BLEND;if(p){const m=o.getVolumeId(),y=yt.getVolume(m),x=yt.getVolume(d).dimensions,w=y.dimensions;(x[0]!==w[0]||x[1]!==w[1]||x[2]!==w[2])&&(p=!1,h=t0.MAXIMUM_INTENSITY_BLEND,console.debug("Dimensions mismatch - falling back to regular volume addition"))}const g=[{volumeId:d,visibility:l,representationUID:`${n}-${pn.Labelmap}`,useIndependentComponents:p,blendMode:h}];if(!g[0].useIndependentComponents)await hJ(a,g,[s],c,f);else return await XPe({viewport:o,volumeInputs:g,segmentationId:n})}else{const d=vm(o.id,n).map(h=>({imageId:h,representationUID:`${n}-${pn.Labelmap}-${h}`}));pJ(a,d,[s])}Gf(n)}function JPe(t,e){let{volumeId:n}=t;if(!n){n=UQ();const r=Ki(e);r.representationData.Labelmap={...r.representationData.Labelmap,volumeId:n},t.volumeId=n,Hm(e)}return n}async function ZPe(t){const e=t;if(!(e.imageIds.length>0))throw new Error("cannot create labelmap, no imageIds found for the volume labelmap");return await VY(t.volumeId||UQ(),e.imageIds)}function QPe(t,e){const n=et(t),{viewport:r}=n;r.removeActors([jRe(r.id,e)])}function L2(t){return Ds.getActiveSegmentation(t)}function TC(t){return L2(t)}function bu(t){const e=Ki(t);if(e){const n=Object.keys(e.segments).find(r=>e.segments[r].active);return n?Number(n):void 0}}const A8=255,jv=new Map;let P8=!1;function eNe(t,e,n=!1){const r=mr(t);if(jv.forEach((a,o)=>{o.includes(e)&&jv.delete(o)}),!r)return;const{viewport:i}=r;QPe(i.element,e),n&&i.render()}async function tNe(t,e){const{segmentationId:n,config:r}=e,i=Ki(n);if(!i){console.warn("No segmentation found for segmentationId: ",n);return}let a=i.representationData[pn.Labelmap],o=$v(t.id,n);if(!a&&Df()?.canComputeRequestedRepresentation(n,pn.Labelmap)&&!P8){P8=!0;const s=Df();if(a=await y7(n,pn.Labelmap,()=>s.computeLabelmapData(n,{viewport:t}),()=>null,()=>{Ds.processLabelmapRepresentationAddition(t.id,n),setTimeout(()=>{Gf(n)},0)}),!a)throw new Error(`No labelmap data found for segmentationId ${n}.`);P8=!1}else!a&&!Df()&&console.debug(`No labelmap data found for segmentationId ${n} and PolySeg add-on is not configured. Unable to convert from other representations to labelmap. Please register PolySeg using cornerstoneTools.init({ addons: { polySeg } }) to enable automatic conversion.`);if(a){if(t instanceof oa)o?.length||await KV(t,a,n,r),o=$v(t.id,n);else{if(!vm(t.id,n)?.length)return;o||await KV(t,a,n,r),o=$v(t.id,n)}if(o?.length)for(const s of o)nNe(t.id,s,e)}}function nNe(t,e,n){const{segmentationId:r}=n,{cfun:i,ofun:a}=n.config,{colorLUTIndex:o}=n,l=TC(t)?.segmentationId===r,c=em.getStyle({viewportId:t,type:pn.Labelmap,segmentationId:r}),f=em.getRenderInactiveSegmentations(t),u=v7(o),d=Math.min(256,u.length),{outlineWidth:h,renderOutline:p,outlineOpacity:g,activeSegmentOutlineWidthDelta:m}=HV(c,l),y=x7(t,{segmentationId:r,type:pn.Labelmap});for(let S=0;S<d;S++){const T=S,_=u[T],I=em.getStyle({viewportId:t,type:pn.Labelmap,segmentationId:r,segmentIndex:T}),{fillAlpha:R,outlineWidth:M,renderFill:A,renderOutline:L}=HV(c,l,I),{forceOpacityUpdate:P,forceColorUpdate:B}=rNe(t,r,T,{fillAlpha:R,renderFill:A,renderOutline:L,segmentColor:_,outlineWidth:M,segmentsHidden:y,cfun:i,ofun:a});if(B&&i.addRGBPoint(T,_[0]/A8,_[1]/A8,_[2]/A8),P)if(A){const U=y.has(T)?0:_[3]/255*R;a.removePoint(T),a.addPointLong(T,U,.5,1)}else a.addPointLong(T,.01,.5,1)}a.setClamping(!1);const v=e.actor,{preLoad:x}=v.get?.("preLoad")||{preLoad:null};if(x?x({cfun:i,ofun:a,actor:v}):(v.getProperty().setRGBTransferFunction(0,i),v.getProperty().setScalarOpacity(0,a),v.getProperty().setInterpolationTypeToNearest()),p){v.getProperty().setUseLabelOutline(p),v.getProperty().setLabelOutlineOpacity(g);const S=bu(n.segmentationId),T=new Array(d-1);for(let _=1;_<d;_++){if(y.has(_)){T[_-1]=0;continue}T[_-1]=_===S?h+m:h}v.getProperty().setLabelOutlineThickness(T),v.modified(),v.getProperty().modified(),v.getMapper().modified()}else v.getProperty().setLabelOutlineThickness(new Array(d-1).fill(0));const w=l||f;v.setVisibility(w)}function HV(t,e,n){const i={...t,...n||{}},a=e?i.fillAlpha:i.fillAlphaInactive,o=e?i.outlineWidth:i.outlineWidthInactive,s=e?i.renderFill:i.renderFillInactive,l=e?i.renderOutline:i.renderOutlineInactive,c=e?i.outlineOpacity:i.outlineOpacityInactive,f=i.activeSegmentOutlineWidthDelta;return{fillAlpha:a,outlineWidth:o,renderFill:s,renderOutline:l,outlineOpacity:c,activeSegmentOutlineWidthDelta:f}}function rNe(t,e,n,{fillAlpha:r,renderFill:i,renderOutline:a,segmentColor:o,outlineWidth:s,segmentsHidden:l,cfun:c,ofun:f}){const u=`${t}-${e}-${n}`,d=jv.get(u);if(!d)return jv.set(u,{fillAlpha:r,renderFill:i,renderOutline:a,outlineWidth:s,segmentColor:o.slice(),segmentsHidden:new Set(l),cfunMTime:c.getMTime(),ofunMTime:f.getMTime()}),{forceOpacityUpdate:!0,forceColorUpdate:!0};const{fillAlpha:h,renderFill:p,renderOutline:g,outlineWidth:m,segmentColor:y,segmentsHidden:v,cfunMTime:x,ofunMTime:w}=d,S=y[0]!==o[0]||y[1]!==o[1]||y[2]!==o[2],T=y[3]!==o[3]||h!==r||p!==i||g!==a||m!==s||v!==l;return(T||S)&&jv.set(u,{fillAlpha:r,renderFill:i,renderOutline:a,outlineWidth:s,segmentColor:o.slice(),segmentsHidden:new Set(l),cfunMTime:c.getMTime(),ofunMTime:f.getMTime()}),{forceOpacityUpdate:T,forceColorUpdate:S}}async function KV(t,e,n,r){return await YPe(t.element,e,n,r)||void 0}const iNe={render:tNe,removeRepresentation:eNe},{DefaultHistoryMemo:sg}=n7,Xv=class Xv{constructor(e,n){const r=Xv.mergeDefaultProps(Xv.defaults,n),i=Mo(r,e),{configuration:a={},supportedInteractionTypes:o,toolGroupId:s}=i;this.toolGroupId=s,this.supportedInteractionTypes=o||[],this.configuration=Object.assign({},a),this.mode=vr.Disabled}static mergeDefaultProps(e={},n){return n?Mo(e,n):e}get toolName(){return this.getToolName()}getToolName(){return this.constructor.toolName}applyActiveStrategy(e,n){const{strategies:r,activeStrategy:i}=this.configuration;return r[i]?.call(this,e,n)}applyActiveStrategyCallback(e,n,r,...i){const{strategies:a,activeStrategy:o}=this.configuration;if(!a[o])throw new Error(`applyActiveStrategyCallback: active strategy ${o} not found, check tool configuration or spellings`);return a[o][r]?.call(this,e,n,...i)}setConfiguration(e){this.configuration=Mo(this.configuration,e)}setActiveStrategy(e){this.setConfiguration({activeStrategy:e})}getTargetImageData(e){if(e.startsWith("imageId:")){const n=e.split("imageId:")[1],r=mi(n);let i=P3(r);return!i||!i.length||(i=i.filter(a=>a.getCurrentImageId()===n),!i||!i.length)?void 0:i[0].getImageData()}else if(e.startsWith("volumeId:")){const n=_0(e),r=nC(n);return!r||!r.length?void 0:r[0].getImageData()}else if(e.startsWith("videoId:")){const n=mi(e),r=P3(n);return!r||!r.length?void 0:r[0].getImageData()}else throw new Error('getTargetIdImage: targetId must start with "imageId:" or "volumeId:"')}getTargetId(e){const n=e.getViewReferenceId?.();if(n)return n;throw new Error("getTargetId: viewport must have a getViewReferenceId method")}undo(){this.doneEditMemo(),sg.undo()}redo(){sg.redo()}static createZoomPanMemo(e){const n={pan:e.getPan(),zoom:e.getZoom()},r={restoreMemo:()=>{const i=e.getPan(),a=e.getZoom();e.setZoom(n.zoom),e.setPan(n.pan),e.render(),n.pan=i,n.zoom=a}};return sg.push(r),r}doneEditMemo(){this.memo?.commitMemo?.()&&sg.push(this.memo),this.memo=null}static startGroupRecording(){sg.startGroupRecording()}static endGroupRecording(){sg.endGroupRecording()}};Xv.defaults={configuration:{strategies:{},defaultStrategy:void 0,activeStrategy:void 0,strategyOptions:{}}};let Vf=Xv;Vf.toolName="BaseTool";const{isEqual:N8}=Hr,{EPSILON:aNe}=cp,oNe=1-aNe;function sNe(t,e,n){const{viewPlaneNormal:r}=e,i=t.filter(l=>{const{planeRestriction:c,referencedImageId:f}=l.metadata;let{viewPlaneNormal:u}=l.metadata;if(c){const{inPlaneVector1:h,inPlaneVector2:p}=c;return!(h&&!N8(0,zt(r,h))||p&&!N8(0,zt(r,p)))}if(!l.metadata.referencedImageId&&!u&&l.metadata.FrameOfReferenceUID){for(const h of l.data.handles.points){const p=ur(ct(),h,e.focalPoint),g=zt(p,r);if(!N8(g,0))return!1}return l.metadata.viewPlaneNormal=r,l.metadata.cameraFocalPoint=e.focalPoint,!0}if(!u&&f){const{imageOrientationPatient:h}=Ft("imagePlaneModule",f),p=En(h[0],h[1],h[2]),g=En(h[3],h[4],h[5]);u=ct(),dr(u,p,g),l.metadata.viewPlaneNormal=u}const d=Math.abs(zt(r,u))>oNe;return u&&d});if(!i.length)return[];const a=n/2,{focalPoint:o}=e,s=[];for(const l of i){const c=l.data,f=c.handles.points[0]||c.contour?.polyline[0];if(!l.isVisible)continue;const u=ct();if(!f){s.push(l);continue}ur(u,o,f);const d=zt(u,r);Math.abs(d)<a&&s.push(l)}return s}function I7(t,e,n={}){if(t instanceof oa){const r=t.getCamera(),{spacingInNormalDirection:i}=ly(t,r);return sNe(e,r,i)}if(t instanceof aa){const r=t.getCurrentImageId();if(!r)return[];const i=r.indexOf(":");n.imageURI=r.substring(i+1)}return e.filter(r=>r.isVisible?r.data.isCanvasAnnotation?!0:t.isReferenceViewable(r.metadata,n):!1)}function lNe(t){if(t){if(t.data&&t.highlighted)return vf.Highlighted;if(xC(t.annotationUID))return vf.Selected;if(uo(t.annotationUID))return vf.Locked;if(t.data&&t.autoGenerated)return vf.AutoGenerated}return vf.Default}class R7 extends Vf{constructor(){super(...arguments),this.onImageSpacingCalibrated=e=>{const{element:n,imageId:r}=e.detail,i=mi(r),a=Eu();a.getFramesOfReference().forEach(s=>{const c=a.getAnnotations(s)[this.getToolName()];!c||!c.length||(c.forEach(f=>{if(!f.metadata?.referencedImageId)return;mi(f.metadata.referencedImageId)===i&&(f.invalidated=!0,f.data.cachedStats={})}),yy(n))})}}filterInteractableAnnotationsForElement(e,n){if(!n?.length)return[];const r=et(e),{viewport:i}=r;return I7(i,n)}createAnnotation(e){const n=e.detail,{currentPoints:r,element:i}=n,{world:a}=r,o=et(i),{viewport:s}=o,l=s.getCamera(),{viewPlaneNormal:c,viewUp:f,position:u}=l,d=this.getReferencedImageId(s,a,c,f),h=s.getViewReference({points:[a]});return{highlighted:!0,invalidated:!0,metadata:{toolName:this.getToolName(),...h,referencedImageId:d,viewUp:f,cameraPosition:u},data:{cachedStats:{},handles:{points:[],activeHandleIndex:null,textBox:{hasMoved:!1,worldPosition:[0,0,0],worldBoundingBox:{topLeft:[0,0,0],topRight:[0,0,0],bottomLeft:[0,0,0],bottomRight:[0,0,0]}}}}}}getReferencedImageId(e,n,r,i){const a=this.getTargetId(e);let o=a.split(/^[a-zA-Z]+:/)[1];if(e instanceof lo){const s=_0(a),l=yt.getVolume(s);o=ep(l,n,r)}return o}getStyle(e,n,r){return MZ(e,n,lNe(r),this.mode)}}R7.toolName="AnnotationDisplayTool";const{DefaultHistoryMemo:cNe}=n7,{PointsManager:uNe}=Hr;class na extends R7{static createAnnotation(...e){let n={annotationUID:null,highlighted:!0,invalidated:!0,metadata:{toolName:this.toolName},data:{text:"",handles:{points:new Array,textBox:{hasMoved:!1,worldPosition:[0,0,0],worldBoundingBox:{topLeft:[0,0,0],topRight:[0,0,0],bottomLeft:[0,0,0],bottomRight:[0,0,0]}}},label:""}};for(const r of e)n=Mo(n,r);return n}static createAnnotationForViewport(e,...n){return this.createAnnotation({metadata:e.getViewReference()},...n)}static createAndAddAnnotation(e,...n){const r=this.createAnnotationForViewport(e,...n);hr(r,e.element),Fn(r,e.element)}constructor(e,n){super(e,n),this.mouseMoveCallback=(r,i)=>{if(!i)return!1;const{element:a,currentPoints:o}=r.detail,s=o.canvas;let l=!1;for(const c of i){if(uo(c.annotationUID)||!fo(c.annotationUID))continue;const{data:f}=c,u=f.handles?f.handles.activeHandleIndex:void 0,d=this._imagePointNearToolOrHandle(a,c,s,6),h=d&&!c.highlighted,p=!d&&c.highlighted;h||p?(c.highlighted=!c.highlighted,l=!0):f.handles&&f.handles.activeHandleIndex!==u&&(l=!0)}return l},this.isSuvScaled=na.isSuvScaled,e.configuration?.getTextLines&&(this.configuration.getTextLines=e.configuration.getTextLines),e.configuration?.statsCalculator&&(this.configuration.statsCalculator=e.configuration.statsCalculator)}getHandleNearImagePoint(e,n,r,i){const a=et(e),{viewport:o}=a,{data:s}=n,{isCanvasAnnotation:l}=s,{points:c,textBox:f}=s.handles;if(f){const{worldBoundingBox:u}=f;if(u){const d={topLeft:o.worldToCanvas(u.topLeft),topRight:o.worldToCanvas(u.topRight),bottomLeft:o.worldToCanvas(u.bottomLeft),bottomRight:o.worldToCanvas(u.bottomRight)};if(r[0]>=d.topLeft[0]&&r[0]<=d.bottomRight[0]&&r[1]>=d.topLeft[1]&&r[1]<=d.bottomRight[1])return s.handles.activeHandleIndex=null,f}}for(let u=0;u<c?.length;u++){const d=c[u],h=l?d.slice(0,2):o.worldToCanvas(d);if(ei(r,h)<i===!0)return s.handles.activeHandleIndex=u,d}s.handles.activeHandleIndex=null}getLinkedTextBoxStyle(e,n){return{visibility:this.getStyle("textBoxVisibility",e,n),fontFamily:this.getStyle("textBoxFontFamily",e,n),fontSize:this.getStyle("textBoxFontSize",e,n),color:this.getStyle("textBoxColor",e,n),shadow:this.getStyle("textBoxShadow",e,n),background:this.getStyle("textBoxBackground",e,n),lineWidth:this.getStyle("textBoxLinkLineWidth",e,n),lineDash:this.getStyle("textBoxLinkLineDash",e,n)}}static isSuvScaled(e,n,r){if(e instanceof lo){const a=_0(n);return yt.getVolume(a)?.scaling?.PT!==void 0}return typeof(r&&Ft("scalingModule",r))?.suvbw=="number"}getAnnotationStyle(e){const{annotation:n,styleSpecifier:r}=e,i=g=>this.getStyle(g,r,n),{annotationUID:a}=n,o=fo(a),s=uo(a),l=i("lineWidth"),c=i("lineDash"),f=i("angleArcLineDash"),u=i("color"),d=i("markerSize"),h=i("shadow"),p=this.getLinkedTextBoxStyle(r,n);return{visibility:o,locked:s,color:u,lineWidth:l,lineDash:c,lineOpacity:1,fillColor:u,fillOpacity:0,shadow:h,textbox:p,markerSize:d,angleArcLineDash:f}}_imagePointNearToolOrHandle(e,n,r,i){if(this.getHandleNearImagePoint(e,n,r,i)||this.isPointNearTool(e,n,r,i,"mouse"))return!0}static createAnnotationState(e,n){const{data:r,annotationUID:i}=e,a={...r,cachedStats:{}};delete a.contour,delete a.spline;const o={annotationUID:i,data:structuredClone(a),deleting:n},s=r.contour;return s&&(o.data.contour={...s,polyline:null,pointsManager:uNe.create3(s.polyline.length,s.polyline)}),o}static createAnnotationMemo(e,n,r){if(!n)return;const{newAnnotation:i,deleting:a=i?!1:void 0}=r||{},{annotationUID:o}=n,s=na.createAnnotationState(n,a),l={restoreMemo:()=>{const c=na.createAnnotationState(n,a),{viewport:f}=et(e)||{};if(f?.setViewReference(n.metadata),s.deleting===!0){if(s.deleting=!1,Object.assign(n.data,s.data),n.data.contour){const d=n.data;d.contour.polyline=s.data.contour.pointsManager.points,delete s.data.contour.pointsManager,d.segmentation&&b0(n)}s.data=c.data,hr(n,e),fu(n.annotationUID,!0),f?.render();return}if(s.deleting===!1){s.deleting=!0,s.data=c.data,fu(n.annotationUID),Cr(n.annotationUID),f?.render();return}const u=co(o);if(!u){console.warn("No current annotation");return}Object.assign(u.data,s.data),u.data.contour&&(u.data.contour.polyline=s.data.contour.pointsManager.points),s.data=c.data,u.invalidated=!0,Fn(u,e,wn.History)},id:o,operationType:"annotation"};return cNe.push(l),l}createMemo(e,n,r){this.memo||=na.createAnnotationMemo(e,n,r)}static hydrateBase(e,n,r,i={}){if(!n)return null;const{viewport:a}=n,o=a.getFrameOfReferenceUID(),s=a.getCamera(),l=i.viewplaneNormal??s.viewPlaneNormal,c=i.viewUp??s.viewUp,f=i.toolInstance||new e;let u,d=l,h=c;if(i.referencedImageId)u=i.referencedImageId,d=void 0,h=void 0;else if(a instanceof aa){const p=zJ(r[0],a);p!==void 0&&(u=a.getImageIds()[p])}else if(a instanceof lo)u=f.getReferencedImageId(a,r[0],l,c);else throw new Error("Unsupported viewport type");return{FrameOfReferenceUID:o,referencedImageId:u,viewPlaneNormal:d,viewUp:h,instance:f,viewport:a}}}na.toolName="AnnotationTool";const{CalibrationTypes:eh}=nl,th="px",Ax="voxels",BQ=[1,2,3,4],fNe=["3,3","4,7"],dNe=["4,3","4,7"],e_={0:"px",1:"percent",2:"dB",3:"cm",4:"seconds",5:"hertz",6:"dB/seconds",7:"cm/sec",8:"cm²",9:"cm²/s",12:"degrees"},hNe=.001,iv="²",vc=(t,e)=>{const{calibration:n,hasPixelSpacing:r}=t;let i=r?"mm":th;const a=r?"mm³":Ax;let o=i+iv,s=1,l="";if(!n||!n.type&&!n.sequenceOfUltrasoundRegions)return{unit:i,areaUnit:o,scale:s,volumeUnit:a};if(n.type===eh.UNCALIBRATED)return{unit:th,areaUnit:th+iv,scale:s,volumeUnit:Ax};if(n.sequenceOfUltrasoundRegions){let f,u;if(Array.isArray(e)&&e.length===2)[f,u]=e;else if(typeof e=="function"){const y=e();f=y[0],u=y[1]}let d=n.sequenceOfUltrasoundRegions.filter(y=>f[0]>=y.regionLocationMinX0&&f[0]<=y.regionLocationMaxX1&&f[1]>=y.regionLocationMinY0&&f[1]<=y.regionLocationMaxY1&&u[0]>=y.regionLocationMinX0&&u[0]<=y.regionLocationMaxX1&&u[1]>=y.regionLocationMinY0&&u[1]<=y.regionLocationMaxY1);if(!d?.length)return{unit:i,areaUnit:o,scale:s,volumeUnit:a};if(d=d.filter(y=>BQ.includes(y.regionDataType)&&fNe.includes(`${y.physicalUnitsXDirection},${y.physicalUnitsYDirection}`)),!d.length)return{unit:th,areaUnit:th+iv,scale:s,volumeUnit:Ax};const h=d[0],p=Math.abs(h.physicalDeltaX),g=Math.abs(h.physicalDeltaY);if(fr(p,g,hNe))s=1/p,l="US Region",i=e_[h.physicalUnitsXDirection]||"unknown",o=i+iv;else return{unit:th,areaUnit:th+iv,scale:s,volumeUnit:Ax}}else n.scale&&(s=n.scale);return[eh.ERMF,eh.USER,eh.ERROR,eh.PROJECTION,eh.CALIBRATED,eh.UNKNOWN].includes(n?.type)&&(l=n.type),{unit:i+(l?` ${l}`:""),areaUnit:o+(l?` ${l}`:""),scale:s,volumeUnit:a+(l?` ${l}`:"")}},t_=(t,e)=>{const[n]=e,{calibration:r}=t;let i=["raw"],a=[null],o="";if(!r||!r.type&&!r.sequenceOfUltrasoundRegions)return{units:i,values:a};if(r.sequenceOfUltrasoundRegions){const s=r.sequenceOfUltrasoundRegions.filter(g=>BQ.includes(g.regionDataType)&&dNe.includes(`${g.physicalUnitsXDirection},${g.physicalUnitsYDirection}`));if(!s?.length)return{units:i,values:a};const l=s.find(g=>n[0]>=g.regionLocationMinX0&&n[0]<=g.regionLocationMaxX1&&n[1]>=g.regionLocationMinY0&&n[1]<=g.regionLocationMaxY1);if(!l)return{units:i,values:a};const{referencePixelX0:c=0,referencePixelY0:f=0}=l,{physicalDeltaX:u,physicalDeltaY:d}=l,h=(n[1]-l.regionLocationMinY0-f)*d,p=(n[0]-l.regionLocationMinX0-c)*u;o="US Region",a=[p,h],i=[e_[l.physicalUnitsXDirection],e_[l.physicalUnitsYDirection]]}return{units:i,values:a,calibrationType:o}},pNe=t=>t.calibration?.aspect||1;function $Q(t,e,n,r){const i=ct();dr(i,e,t);const a=En(...n),o=En(...r),s=ct();Dr(s,a,o);const l=Ao(s);if(l<1e-4)return{worldWidth:0,worldHeight:0};const c=zt(s,i)/(l*Ao(i)),u=Math.sqrt(1-c*c)*l,d=c*l;return{worldWidth:u,worldHeight:d}}function GQ(t,e,n,r){const i=ct();dr(i,e,t);const a=En(...n),o=En(...r),s=ct();Dr(s,a,o);const l=Ao(s);if(l<1e-4)return{worldWidth:0,worldHeight:0};const c=zt(s,i)/(l*Ao(i)),u=Math.sqrt(1-c*c)*l,d=c*l;return{worldWidth:u,worldHeight:d}}const{EPSILON:gNe}=cp,mNe=1-gNe;function vNe(t,e){const{viewPlaneNormal:n}=e,r=t.filter(i=>{let a=i.metadata.viewPlaneNormal;if(!a){const{referencedImageId:s}=i.metadata,{imageOrientationPatient:l}=Ft("imagePlaneModule",s),c=En(l[0],l[1],l[2]),f=En(l[3],l[4],l[5]);a=ct(),dr(a,c,f),i.metadata.viewPlaneNormal=a}const o=Math.abs(zt(n,a))>mNe;return a&&o});return r.length?r:[]}function Bl(t,e,n){let r=!0,i=!0;if(typeof t!="function")throw new TypeError("Expected a function");return xQ(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),yC(t,e,{leading:r,trailing:i,maxWait:e})}function yNe(t){return t[0]?.length===3}function xNe(t,e){if(!e||e.length===0||e.length===t.length)return t;const n=e[e.length-1]-e[0]+1,r=m8(e.map(a=>t[a][0])),i=m8(e.map(a=>t[a][1]));if(yNe(t)){const a=m8(e.map(o=>t[o][2]));return kk(tv(r,n),tv(i,n),tv(a,n))}else return kk(tv(r,n),tv(i,n))}function bNe(t,e){const n=[],[r,i]=e,a=i-r+1,o=Math.floor(a/t);let s=0,l=Math.round((a-1)/(o-1)*s)+r;for(;l<=i;)n.push(l),s++,l=Math.round((a-1)/(o-1)*s)+r;return n}function wNe(t,e,n,r){const i=n-e+1,a=Math.floor(r/100*i)??1,o=Math.floor(i/a)??1;if(isNaN(i)||!i||!o||i/o<2)return t;const s=Math.max(0,e),l=Math.min(t.length-1,n),c=t.slice(0,s),f=t.slice(l+1,t.length),u=bNe(o,[s,l]),d=xNe(t,u);return[...c,...d,...f]}function EC(t,e){return e?.autoGenerated?!1:t?.smoothing?.smoothOnAdd===!0||t?.smoothing?.smoothOnEdit===!0}function CNe(t,e){return hp(t,e)<.001}function SNe(t,e){return hp(t,e)===0}function TNe(t,e){for(let n=0;n<t.length;n++)for(let r=0;r<e.length;r++)if(SNe(t[n],e[r]))return[n,r]}function Tg(t,e,n){return(t+e+n)%e}function qV(t,e,n,r){const[,i,a]=t,[,o,s]=e,l=a.length,c=s.length;let f=t[0],u=e[0];if(!a[f]||!s[u]||!a[i]||!s[o])return[void 0,void 0];for(;f!==i&&u!==o;){if(n(s[u],a[f]))return[f,u];f=Tg(f,l,r),u=Tg(u,c,r)}return[void 0,void 0]}function ENe(t,e){const[n,r]=TNe(t,e)||[],i=(l,c)=>CNe(l,c)===!1,[a,o]=qV([Tg(n,t.length,1),n,t],[Tg(r,e.length,1),r,e],i,1),[s]=qV([Tg(a,t.length,-1),a,t],[Tg(o,e.length,-1),o,e],i,-1);return[a,s]}function _C(t,e,n){const{interpolation:r,smoothing:i}=t,a=e;if(r){const{knotsRatioPercentageOnAdd:o,knotsRatioPercentageOnEdit:s,smoothOnAdd:l=!1,smoothOnEdit:c=!1}=i,f=n?s:o;if(n?c:l){const[d,h]=n?ENe(e,n):[0,e.length-1];return!e[d]||!e[h]?e:wNe(e,d,h,f)}}return a}const Km=t=>{if(t.shiftKey)return t.ctrlKey?Ia.ShiftCtrl:t.altKey?Ia.ShiftAlt:t.metaKey?Ia.ShiftMeta:Ia.Shift;if(t.ctrlKey)return t.altKey?Ia.CtrlAlt:t.metaKey?Ia.CtrlMeta:Ia.Ctrl;if(t.altKey)return t.metaKey&&Ia.AltMeta||Ia.Alt;if(t.metaKey)return Ia.Meta};function A7(t,e){const n=t[0],r=t[t.length-1],i=Hn();Ol(i,r[0]-n[0],r[1]-n[1]),Dh(i,i);const a=Hn(),o=Hn();Ol(a,-i[1],i[0]),Ol(o,i[1],-i[0]);const s=[(n[0]+r[0])/2,(n[1]+r[1])/2],l={dist:0,index:null};for(let u=0;u<t.length;u++){const d=t[u],h=$9(d,s);h>l.dist&&(l.dist=h,l.index=u)}return[t[l.index],s].map(e.canvasToWorld)}function _Ne(t,e){const{viewport:n}=t,r=e.data.contour.polyline.map(n.worldToCanvas);return A7(r,n)}const{addCanvasPointsToArray:P7,pointsAreWithinCloseContourProximity:jQ,getFirstLineSegmentIntersectionIndexes:zQ,getSubPixelSpacingAndXYDirections:DNe}=pp;function ONe(t,e,n){this.isDrawing=!0;const r=t.detail,{currentPoints:i,element:a}=r,o=i.canvas,s=et(a),{viewport:l}=s,c=Km(t.detail.event)===this.configuration.contourHoleAdditionModifierKey,{spacing:f,xDir:u,yDir:d}=DNe(l,this.configuration.subPixelResolution)||{};!f||!u||!d||(this.drawData={canvasPoints:[o],polylineIndex:0,contourHoleProcessingEnabled:c,newAnnotation:!0},this.commonData={annotation:e,viewportIdsToRender:n,spacing:f,xDir:u,yDir:d,movingTextBox:!1},Mt.isInteractingWithTool=!0,a.addEventListener(ee.MOUSE_UP,this.mouseUpDrawCallback),a.addEventListener(ee.MOUSE_DRAG,this.mouseDragDrawCallback),a.addEventListener(ee.MOUSE_CLICK,this.mouseUpDrawCallback),a.addEventListener(ee.TOUCH_END,this.mouseUpDrawCallback),a.addEventListener(ee.TOUCH_DRAG,this.mouseDragDrawCallback),a.addEventListener(ee.TOUCH_TAP,this.mouseUpDrawCallback),Rn(a))}function MNe(t){Mt.isInteractingWithTool=!1,t.removeEventListener(ee.MOUSE_UP,this.mouseUpDrawCallback),t.removeEventListener(ee.MOUSE_DRAG,this.mouseDragDrawCallback),t.removeEventListener(ee.MOUSE_CLICK,this.mouseUpDrawCallback),t.removeEventListener(ee.TOUCH_END,this.mouseUpDrawCallback),t.removeEventListener(ee.TOUCH_DRAG,this.mouseDragDrawCallback),t.removeEventListener(ee.TOUCH_TAP,this.mouseUpDrawCallback),Kn(t)}function INe(t){const e=t.detail,{currentPoints:n,element:r}=e,i=n.world,a=n.canvas,o=et(r),{viewport:s}=o,{annotation:l,viewportIdsToRender:c,xDir:f,yDir:u,spacing:d,movingTextBox:h}=this.commonData,{polylineIndex:p,canvasPoints:g,newAnnotation:m}=this.drawData;this.createMemo(r,l,{newAnnotation:m});const y=g[g.length-1],v=s.canvasToWorld(y),x=ct();Dr(x,i,v);const w=Math.abs(zt(x,f)),S=Math.abs(zt(x,u));if(!(w<=d[0]&&S<=d[1])){if(h){this.isDrawing=!1;const{deltaPoints:T}=e,_=T.world,{textBox:D}=l.data.handles,{worldPosition:I}=D;I[0]+=_[0],I[1]+=_[1],I[2]+=_[2],D.hasMoved=!0}else{const T=this.findCrossingIndexDuringCreate(t);if(T!==void 0)this.applyCreateOnCross(t,T);else{const _=P7(r,g,a,this.commonData);this.drawData.polylineIndex=p+_}l.invalidated=!0}ut(c),l.invalidated&&Fn(l,r,wn.HandlesUpdated)}}function RNe(t){const{allowOpenContours:e}=this.configuration,{canvasPoints:n,contourHoleProcessingEnabled:r}=this.drawData,i=n[0],a=n[n.length-1],o=t.detail,{element:s}=o;this.doneEditMemo(),this.drawData.newAnnotation=!1,e&&!jQ(i,a,this.configuration.closeContourProximity)?this.completeDrawOpenContour(s,{contourHoleProcessingEnabled:r}):this.completeDrawClosedContour(s,{contourHoleProcessingEnabled:r})}function ANe(t,e){this.removeCrossedLinesOnCompleteDraw();const{canvasPoints:n}=this.drawData,{contourHoleProcessingEnabled:r,minPointsToSave:i}=e??{};if(i&&n.length<i||this.haltDrawing(t,n))return!1;const{annotation:a,viewportIdsToRender:o}=this.commonData,s=et(t),{viewport:l,renderingEngine:c}=s;P7(t,n,n[0],this.commonData),n.pop();const f=EC(this.configuration,a)?_C(this.configuration,n):n;this.updateContourPolyline(a,{points:f,closed:!0,targetWindingDirection:Zo.Clockwise},l);const{textBox:u}=a.data.handles;return u?.hasMoved||fC(a,r),this.isDrawing=!1,this.drawData=void 0,this.commonData=void 0,ut(o),this.deactivateDraw(t),!0}function PNe(){const{canvasPoints:t}=this.drawData,e=t.length,n=[t[0],t[e-1]],r=t.slice(0,-1).slice(1),i=zQ(r,n[0],n[1],!1);if(i){const a=i[1];a===1?this.drawData.canvasPoints=t.splice(1):this.drawData.canvasPoints=t.splice(0,a)}}function NNe(t,e){const{canvasPoints:n}=this.drawData,{contourHoleProcessingEnabled:r}=e??{};if(this.haltDrawing(t,n))return!1;const{annotation:i,viewportIdsToRender:a}=this.commonData,o=et(t),{viewport:s,renderingEngine:l}=o,c=EC(this.configuration,i)?_C(this.configuration,n):n;this.updateContourPolyline(i,{points:c,closed:!1},s);const{textBox:f}=i.data.handles,u=i.data.contour.polyline;return i.data.handles.points=[u[0],u[u.length-1]],i.data.isOpenUShapeContour&&(i.data.openUShapeContourVectorToPeak=A7(n,s)),f.hasMoved||fC(i,r),this.isDrawing=!1,this.drawData=void 0,this.commonData=void 0,ut(a),this.deactivateDraw(t),!0}function LNe(t){const e=t.detail,{currentPoints:n,lastPoints:r}=e,i=n.canvas,a=r.canvas,{canvasPoints:o}=this.drawData,s=o.slice(0,-1),l=zQ(s,i,a,!1);return l===void 0?void 0:l[0]}function kNe(t,e){const n=t.detail,{element:r}=n,{canvasPoints:i,contourHoleProcessingEnabled:a}=this.drawData,{annotation:o,viewportIdsToRender:s}=this.commonData;P7(r,i,i[e],this.commonData),i.pop();const l=i.slice(e),c=vy(l);if(fr(c,0)){i.splice(e+1);return}i.splice(0,e);const f={contourHoleProcessingEnabled:a,minPointsToSave:3};this.completeDrawClosedContour(r,f)&&this.activateClosedContourEdit(t,o,s)}function VNe(t){const{allowOpenContours:e}=this.configuration,{canvasPoints:n,contourHoleProcessingEnabled:r}=this.drawData,i=n[0],a=n[n.length-1];e&&!jQ(i,a,this.configuration.closeContourProximity)?this.completeDrawOpenContour(t,{contourHoleProcessingEnabled:r}):this.completeDrawClosedContour(t,{contourHoleProcessingEnabled:r})}function FNe(t,e){const n=Math.max(e*3,3);return t.length<n}function UNe(t,e){const{subPixelResolution:n}=this.configuration;if(FNe(e,n)){const{annotation:r,viewportIdsToRender:i}=this.commonData,a=et(t),{renderingEngine:o}=a;return Cr(r.annotationUID),this.isDrawing=!1,this.drawData=void 0,this.commonData=void 0,ut(i),this.deactivateDraw(t),!0}return!1}function BNe(t){t.activateDraw=ONe.bind(t),t.deactivateDraw=MNe.bind(t),t.applyCreateOnCross=kNe.bind(t),t.findCrossingIndexDuringCreate=LNe.bind(t),t.completeDrawOpenContour=NNe.bind(t),t.removeCrossedLinesOnCompleteDraw=PNe.bind(t),t.mouseDragDrawCallback=INe.bind(t),t.mouseUpDrawCallback=RNe.bind(t),t.completeDrawClosedContour=ANe.bind(t),t.cancelDrawing=VNe.bind(t),t.haltDrawing=UNe.bind(t)}const{addCanvasPointsToArray:$Ne,getFirstLineSegmentIntersectionIndexes:rp}=pp;function GNe(t,e){const n=t.detail,{element:r,currentPoints:i,lastPoints:a}=n,o=i.canvas,s=a.canvas,{editCanvasPoints:l,prevCanvasPoints:c}=this.editData,f=rp(c,o,s,e);if(f)this.editData.startCrossingIndex=f[0],this.removePointsUpUntilFirstCrossing(e);else if(c.length>=2)if(l.length>this.configuration.checkCanvasEditFallbackProximity){const u=l[0],d=[];for(let g=0;g<c.length;g++){const m=c[g],y=ei(m,u);d.push({distance:y,index:g})}d.sort((g,m)=>g.distance-m.distance);const h=[d[0],d[1]],p=Math.min(h[0].index,h[1].index);this.editData.startCrossingIndex=p}else{const u=Hn();Ra(u,l[1],l[0]),Dh(u,u);const d=6,h=[l[0][0]-u[0]*d,l[0][1]-u[1]*d],p=rp(c,h,l[0],e);if(p){const g=[h];$Ne(r,g,l[0],this.commonData),l.unshift(...g),this.removePointsUpUntilFirstCrossing(e),this.editData.editIndex=l.length-1,this.editData.startCrossingIndex=p[0]}}}function jNe(t){const{editCanvasPoints:e,prevCanvasPoints:n}=this.editData;let r=0;for(let i=0;i<e.length-1;i++){const a=[e[i],e[i+1]],o=!!rp(n,a[0],a[1],t);if(r++,o)break}e.splice(0,r),this.editData.editIndex=e.length-1}function zNe(t,e){const n=t.detail,{currentPoints:r,lastPoints:i}=n,a=r.canvas,o=i.canvas,{prevCanvasPoints:s}=this.editData;return!!rp(s,a,o,e)}function WNe(t){const{prevCanvasPoints:e,editCanvasPoints:n}=this.editData;for(let r=n.length-1;r>0;r--){const i=[n[r],n[r-1]],a=!!rp(e,i[0],i[1],t);if(n.pop(),a)break}}function HNe(){const{editCanvasPoints:t,prevCanvasPoints:e,startCrossingIndex:n}=this.editData;if(n===void 0)return;const r=t[t.length-1],i=[];for(let o=0;o<e.length;o++){const s=e[o],l=ei(s,r);i.push({distance:l,index:o})}i.sort((o,s)=>o.distance-s.distance);const a=t.slice(0,-1);for(let o=0;o<i.length;o++){const{index:s}=i[o],l=e[s],c=t[t.length-1];if(!rp(a,l,c,!1))return s}return-1}function KNe(t){const e=t.detail,{currentPoints:n,lastPoints:r}=e,i=n.canvas,a=r.canvas,{editCanvasPoints:o}=this.editData,s=o.slice(0,-2),l=rp(s,i,a,!1);if(!l)return;const c=l[0],f=o.length-c;for(let u=0;u<f;u++)o.pop()}function qNe(t){t.checkForFirstCrossing=GNe.bind(t),t.removePointsUpUntilFirstCrossing=jNe.bind(t),t.checkForSecondCrossing=zNe.bind(t),t.findSnapIndex=HNe.bind(t),t.removePointsAfterSecondCrossing=WNe.bind(t),t.checkAndRemoveCrossesOnEditLine=KNe.bind(t)}const{getSubPixelSpacingAndXYDirections:XNe,addCanvasPointsToArray:WQ,getArea:XV}=pp;function YNe(t,e,n){this.isEditingClosed=!0;const r=t.detail,{currentPoints:i,element:a}=r,o=i.canvas,s=et(a);if(!s)return;const{viewport:l}=s,c=e.data.contour.polyline.map(l.worldToCanvas),{spacing:f,xDir:u,yDir:d}=XNe(l,this.configuration.subPixelResolution);this.editData={prevCanvasPoints:c,editCanvasPoints:[o],startCrossingIndex:void 0,editIndex:0,annotation:e},this.commonData={annotation:e,viewportIdsToRender:n,spacing:f,xDir:u,yDir:d,movingTextBox:!1},Mt.isInteractingWithTool=!0,a.addEventListener(ee.MOUSE_UP,this.mouseUpClosedContourEditCallback),a.addEventListener(ee.MOUSE_DRAG,this.mouseDragClosedContourEditCallback),a.addEventListener(ee.MOUSE_CLICK,this.mouseUpClosedContourEditCallback),a.addEventListener(ee.TOUCH_END,this.mouseUpClosedContourEditCallback),a.addEventListener(ee.TOUCH_DRAG,this.mouseDragClosedContourEditCallback),a.addEventListener(ee.TOUCH_TAP,this.mouseUpClosedContourEditCallback),Rn(a)}function JNe(t){Mt.isInteractingWithTool=!1,t.removeEventListener(ee.MOUSE_UP,this.mouseUpClosedContourEditCallback),t.removeEventListener(ee.MOUSE_DRAG,this.mouseDragClosedContourEditCallback),t.removeEventListener(ee.MOUSE_CLICK,this.mouseUpClosedContourEditCallback),t.removeEventListener(ee.TOUCH_END,this.mouseUpClosedContourEditCallback),t.removeEventListener(ee.TOUCH_DRAG,this.mouseDragClosedContourEditCallback),t.removeEventListener(ee.TOUCH_TAP,this.mouseUpClosedContourEditCallback),Kn(t)}function ZNe(t){const e=t.detail,{currentPoints:n,element:r}=e,i=n.world,a=n.canvas,o=et(r),{viewport:s}=o,{viewportIdsToRender:l,xDir:c,yDir:f,spacing:u}=this.commonData,{editIndex:d,editCanvasPoints:h,startCrossingIndex:p,annotation:g}=this.editData;this.createMemo(r,g);const m=h[h.length-1],y=s.canvasToWorld(m),v=ct();Dr(v,i,y);const x=Math.abs(zt(v,c)),w=Math.abs(zt(v,f));if(x<=u[0]&&w<=u[1])return;p!==void 0&&this.checkAndRemoveCrossesOnEditLine(t);const S=WQ(r,h,a,this.commonData),T=d+S;if(this.editData.editIndex=T,p===void 0&&h.length>1&&this.checkForFirstCrossing(t,!0),this.editData.snapIndex=this.findSnapIndex(),this.editData.snapIndex===-1){this.finishEditAndStartNewEdit(t);return}this.editData.fusedCanvasPoints=this.fuseEditPointsWithClosedContour(t),p!==void 0&&this.checkForSecondCrossing(t,!0)&&(this.removePointsAfterSecondCrossing(!0),this.finishEditAndStartNewEdit(t)),ut(l)}function QNe(t){const e=t.detail,{element:n}=e,r=et(n),{viewport:i,renderingEngine:a}=r,{annotation:o,viewportIdsToRender:s}=this.commonData,{fusedCanvasPoints:l,editCanvasPoints:c}=this.editData;_u(o,{points:l,closed:!0,targetWindingDirection:Zo.Clockwise},i),o.autoGenerated&&(o.autoGenerated=!1),Fn(o,n);const f=c.pop();this.editData={prevCanvasPoints:l,editCanvasPoints:[f],startCrossingIndex:void 0,editIndex:0,snapIndex:void 0,annotation:o},ut(s)}function eLe(t){const{prevCanvasPoints:e,editCanvasPoints:n,startCrossingIndex:r,snapIndex:i}=this.editData;if(r===void 0||i===void 0)return;const a=t.detail,{element:o}=a,s=[...n];WQ(o,s,e[i],this.commonData),s.length>n.length&&s.pop();let l,c;r>i?(l=i,c=r):(l=r,c=i);const f=ei(e[l],s[0]),u=ei(e[l],s[s.length-1]),d=ei(e[c],s[0]),h=ei(e[c],s[s.length-1]),p=[];for(let S=0;S<l;S++){const T=e[S];p.push([T[0],T[1]])}let g=f+h,m=u+d;if(g<m)for(let S=0;S<s.length;S++){const T=s[S];p.push([T[0],T[1]])}else for(let S=s.length-1;S>=0;S--){const T=s[S];p.push([T[0],T[1]])}for(let S=c;S<e.length;S++){const T=e[S];p.push([T[0],T[1]])}const y=[];for(let S=l;S<c;S++){const T=e[S];y.push([T[0],T[1]])}if(g=d+u,m=h+f,g<m)for(let S=0;S<s.length;S++){const T=s[S];y.push([T[0],T[1]])}else for(let S=s.length-1;S>=0;S--){const T=s[S];y.push([T[0],T[1]])}const v=XV(p),x=XV(y);return v>x?p:y}function tLe(t){const e=t.detail,{element:n}=e;this.completeClosedContourEdit(n)}function nLe(t){const e=et(t),{viewport:n}=e,{annotation:r,viewportIdsToRender:i}=this.commonData;this.doneEditMemo();const{fusedCanvasPoints:a,prevCanvasPoints:o}=this.editData;if(a){const s=EC(this.configuration,r)?_C(this.configuration,a,o):a,l=this.configuration?.decimate||{};_u(r,{points:s,closed:!0,targetWindingDirection:Zo.Clockwise},n,{decimate:{enabled:!!l.enabled,epsilon:l.epsilon}}),r.autoGenerated&&(r.autoGenerated=!1),Fn(r,t)}this.isEditingClosed=!1,this.editData=void 0,this.commonData=void 0,ut(i),this.deactivateClosedContourEdit(t)}function rLe(t){this.completeClosedContourEdit(t)}function iLe(t){t.activateClosedContourEdit=YNe.bind(t),t.deactivateClosedContourEdit=JNe.bind(t),t.mouseDragClosedContourEditCallback=ZNe.bind(t),t.mouseUpClosedContourEditCallback=tLe.bind(t),t.finishEditAndStartNewEdit=QNe.bind(t),t.fuseEditPointsWithClosedContour=eLe.bind(t),t.cancelClosedContourEdit=rLe.bind(t),t.completeClosedContourEdit=nLe.bind(t)}const{addCanvasPointsToArray:HQ,getSubPixelSpacingAndXYDirections:aLe}=pp;function oLe(t,e,n){this.isEditingOpen=!0;const r=t.detail,{currentPoints:i,element:a}=r,o=i.canvas,s=et(a),{viewport:l}=s;this.doneEditMemo();const c=e.data.contour.polyline.map(l.worldToCanvas),{spacing:f,xDir:u,yDir:d}=aLe(l,this.configuration.subPixelResolution);this.editData={prevCanvasPoints:c,editCanvasPoints:[o],startCrossingIndex:void 0,editIndex:0},this.commonData={annotation:e,viewportIdsToRender:n,spacing:f,xDir:u,yDir:d,movingTextBox:!1},Mt.isInteractingWithTool=!0,a.addEventListener(ee.MOUSE_UP,this.mouseUpOpenContourEditCallback),a.addEventListener(ee.MOUSE_DRAG,this.mouseDragOpenContourEditCallback),a.addEventListener(ee.MOUSE_CLICK,this.mouseUpOpenContourEditCallback),a.addEventListener(ee.TOUCH_END,this.mouseUpOpenContourEditCallback),a.addEventListener(ee.TOUCH_DRAG,this.mouseDragOpenContourEditCallback),a.addEventListener(ee.TOUCH_TAP,this.mouseUpOpenContourEditCallback),Rn(a)}function sLe(t){Mt.isInteractingWithTool=!1,t.removeEventListener(ee.MOUSE_UP,this.mouseUpOpenContourEditCallback),t.removeEventListener(ee.MOUSE_DRAG,this.mouseDragOpenContourEditCallback),t.removeEventListener(ee.MOUSE_CLICK,this.mouseUpOpenContourEditCallback),t.removeEventListener(ee.TOUCH_END,this.mouseUpOpenContourEditCallback),t.removeEventListener(ee.TOUCH_DRAG,this.mouseDragOpenContourEditCallback),t.removeEventListener(ee.TOUCH_TAP,this.mouseUpOpenContourEditCallback),Kn(t)}function lLe(t){const e=t.detail,{currentPoints:n,element:r}=e,i=n.world,a=n.canvas,o=et(r),{viewport:s}=o,{viewportIdsToRender:l,xDir:c,yDir:f,spacing:u}=this.commonData,{editIndex:d,editCanvasPoints:h,startCrossingIndex:p}=this.editData,g=h[h.length-1],m=s.canvasToWorld(g),y=ct();this.createMemo(r,this.commonData.annotation),Dr(y,i,m);const v=Math.abs(zt(y,c)),x=Math.abs(zt(y,f));if(v<=u[0]&&x<=u[1])return;p!==void 0&&this.checkAndRemoveCrossesOnEditLine(t);const w=HQ(r,h,a,this.commonData),S=d+w;this.editData.editIndex=S,p===void 0&&h.length>1&&this.checkForFirstCrossing(t,!1),this.editData.snapIndex=this.findSnapIndex(),this.editData.fusedCanvasPoints=this.fuseEditPointsWithOpenContour(t),p!==void 0&&this.checkForSecondCrossing(t,!1)?(this.removePointsAfterSecondCrossing(!1),this.finishEditOpenOnSecondCrossing(t)):this.checkIfShouldOverwriteAnEnd(t)&&this.openContourEditOverwriteEnd(t),ut(l)}function cLe(t){const e=t.detail,{element:n}=e,r=et(n),{viewport:i}=r,{annotation:a,viewportIdsToRender:o}=this.commonData,s=this.fuseEditPointsForOpenContourEndEdit();_u(a,{points:s,closed:!1},i);const l=a.data.contour.polyline;a.data.handles.points=[l[0],l[l.length-1]],a.data.handles.activeHandleIndex=1,Fn(a,n),this.isEditingOpen=!1,this.editData=void 0,this.commonData=void 0,this.doneEditMemo(),this.deactivateOpenContourEdit(n),this.activateOpenContourEndEdit(t,a,o,null)}function uLe(t){const e=t.detail,{currentPoints:n,lastPoints:r}=e,i=n.canvas,a=r.canvas,{snapIndex:o,prevCanvasPoints:s,startCrossingIndex:l}=this.editData;if(l===void 0||o===void 0)return!1;if(o===-1)return!0;if(o!==0&&o!==s.length-1)return!1;const c=i,f=a,u=s[o],d=Hn(),h=Hn();Ol(d,c[0]-f[0],c[1]-f[1]),Ol(h,c[0]-u[0],c[1]-u[1]);const p=uf(d,h),g=Math.sqrt(d[0]*d[0]+d[1]*d[1]),m=Math.sqrt(h[0]*h[0]+h[1]*h[1]);return Math.acos(p/(g*m))<Math.PI/2}function fLe(){const{snapIndex:t,prevCanvasPoints:e,editCanvasPoints:n,startCrossingIndex:r}=this.editData,i=[];if(t===0)for(let s=e.length-1;s>=r;s--){const l=e[s];i.push([l[0],l[1]])}else for(let s=0;s<r;s++){const l=e[s];i.push([l[0],l[1]])}const a=ei(e[r],n[0]),o=ei(e[r],n[n.length-1]);if(a<o)for(let s=0;s<n.length;s++){const l=n[s];i.push([l[0],l[1]])}else for(let s=n.length-1;s>=0;s--){const l=n[s];i.push([l[0],l[1]])}return i}function dLe(t){const{prevCanvasPoints:e,editCanvasPoints:n,startCrossingIndex:r,snapIndex:i}=this.editData;if(r===void 0||i===void 0)return;const a=t.detail,{element:o}=a,s=[...n];HQ(o,s,e[i],this.commonData),s.length>n.length&&s.pop();let l,c;r>i?(l=i,c=r):(l=r,c=i);const f=ei(e[l],s[0]),u=ei(e[l],s[s.length-1]),d=ei(e[c],s[0]),h=ei(e[c],s[s.length-1]),p=[];for(let y=0;y<l;y++){const v=e[y];p.push([v[0],v[1]])}const g=f+h,m=u+d;if(g<m)for(let y=0;y<s.length;y++){const v=s[y];p.push([v[0],v[1]])}else for(let y=s.length-1;y>=0;y--){const v=s[y];p.push([v[0],v[1]])}for(let y=c;y<e.length;y++){const v=e[y];p.push([v[0],v[1]])}return p}function hLe(t){const e=t.detail,{element:n}=e,r=et(n),{viewport:i,renderingEngine:a}=r,{annotation:o,viewportIdsToRender:s}=this.commonData,{fusedCanvasPoints:l,editCanvasPoints:c}=this.editData;_u(o,{points:l,closed:!1},i);const f=o.data.contour.polyline;o.data.handles.points=[f[0],f[f.length-1]],Fn(o,n);const u=c.pop();this.editData={prevCanvasPoints:l,editCanvasPoints:[u],startCrossingIndex:void 0,editIndex:0},ut(s)}function pLe(t){const e=t.detail,{element:n}=e;this.completeOpenContourEdit(n)}function gLe(t){const e=et(t),{viewport:n}=e,{annotation:r,viewportIdsToRender:i}=this.commonData;this.doneEditMemo();const{fusedCanvasPoints:a,prevCanvasPoints:o}=this.editData;if(a){const s=EC(this.configuration)?_C(this.configuration,a,o):a,l=this.configuration?.decimate||{};_u(r,{points:s,closed:!1},n,{decimate:{enabled:!!l.enabled,epsilon:l.epsilon}});const c=r.data.contour.polyline;r.data.handles.points=[c[0],c[c.length-1]],r.data.isOpenUShapeContour&&(r.data.openUShapeContourVectorToPeak=A7(a,n)),Fn(r,t)}this.isEditingOpen=!1,this.editData=void 0,this.commonData=void 0,ut(i),this.deactivateOpenContourEdit(t)}function mLe(t){this.completeOpenContourEdit(t)}function vLe(t){t.activateOpenContourEdit=oLe.bind(t),t.deactivateOpenContourEdit=sLe.bind(t),t.mouseDragOpenContourEditCallback=lLe.bind(t),t.mouseUpOpenContourEditCallback=pLe.bind(t),t.fuseEditPointsWithOpenContour=dLe.bind(t),t.finishEditOpenOnSecondCrossing=hLe.bind(t),t.checkIfShouldOverwriteAnEnd=uLe.bind(t),t.fuseEditPointsForOpenContourEndEdit=fLe.bind(t),t.openContourEditOverwriteEnd=cLe.bind(t),t.cancelOpenContourEdit=mLe.bind(t),t.completeOpenContourEdit=gLe.bind(t)}const{getSubPixelSpacingAndXYDirections:yLe}=pp;function xLe(t,e,n,r){this.isDrawing=!0;const i=t.detail,{element:a}=i,o=et(a),{viewport:s}=o,{spacing:l,xDir:c,yDir:f}=yLe(s,this.configuration.subPixelResolution),u=e.data.contour.polyline.map(s.worldToCanvas);e.data.handles.activeHandleIndex===0&&u.reverse();let h=!1;r?.worldPosition&&(h=!0),this.drawData={canvasPoints:u,polylineIndex:u.length-1},this.commonData={annotation:e,viewportIdsToRender:n,spacing:l,xDir:c,yDir:f,movingTextBox:h},Mt.isInteractingWithTool=!0,a.addEventListener(ee.MOUSE_UP,this.mouseUpDrawCallback),a.addEventListener(ee.MOUSE_DRAG,this.mouseDragDrawCallback),a.addEventListener(ee.MOUSE_CLICK,this.mouseUpDrawCallback),a.addEventListener(ee.TOUCH_END,this.mouseUpDrawCallback),a.addEventListener(ee.TOUCH_DRAG,this.mouseDragDrawCallback),a.addEventListener(ee.TOUCH_TAP,this.mouseUpDrawCallback),Rn(a)}function bLe(t){t.activateOpenContourEndEdit=xLe.bind(t)}function wLe(t){return(t.childAnnotationUIDs??[]).map(n=>co(n).data.contour.polyline)}function DC(t,e){const n=wLe(t),r=[];return n.forEach(i=>{const a=i.length,o=new Array(a);for(let s=0;s<a;s++)o[s]=e.worldToCanvas(i[s]);r.push(o)}),r}const{pointsAreWithinCloseContourProximity:CLe}=pp;function SLe(t,e){const n={toolGroupId:this.toolGroupId,toolName:this.getToolName(),viewportId:t.viewport.id,annotationUID:e.annotationUID},{lineWidth:r,lineDash:i,color:a,fillColor:o,fillOpacity:s}=this.getAnnotationStyle({annotation:e,styleSpecifier:n}),{closed:l}=e.data.contour;return{color:a,width:r,lineDash:i,fillColor:o,fillOpacity:s,closePath:l}}function TLe(t,e,n){t?.viewport?.getImageData()&&(n.data.contour.closed?this.renderClosedContour(t,e,n):n.data.isOpenUShapeContour?(ELe(t,n),this.renderOpenUShapedContour(t,e,n)):this.renderOpenContour(t,e,n))}function ELe(t,e){e.data.openUShapeContourVectorToPeak||(e.data.openUShapeContourVectorToPeak=_Ne(t,e))}function _Le(t,e,n){if(n.parentAnnotationUID)return;const{viewport:r}=t,i=this._getRenderingOptions(t,n),a=n.data.contour.polyline.map(c=>r.worldToCanvas(c)),o=DC(n,r),s=[a,...o];$h(e,n.annotationUID,"1",s,i)}function DLe(t,e,n){const{viewport:r}=t,i=this._getRenderingOptions(t,n),a=n.data.contour.polyline.map(l=>r.worldToCanvas(l));Of(e,n.annotationUID,"1",a,i);const s=n.data.handles.activeHandleIndex;if(this.configuration.alwaysRenderOpenContourHandles?.enabled===!0){const l=this.configuration.alwaysRenderOpenContourHandles.radius,c="0",f=[a[0],a[a.length-1]];s===0?f.shift():s===1&&f.pop(),ho(e,n.annotationUID,c,f,{color:i.color,handleRadius:l})}if(s!==null){const c=s===0?0:a.length-1,f=a[c];ho(e,n.annotationUID,"1",[f],{color:i.color})}}function OLe(t,e,n){const{viewport:r}=t,{openUShapeContourVectorToPeak:i}=n.data,{polyline:a}=n.data.contour;if(this.renderOpenContour(t,e,n),!i)return;const o=r.worldToCanvas(a[0]),s=r.worldToCanvas(a[a.length-1]),l=[r.worldToCanvas(i[0]),r.worldToCanvas(i[1])],c=this._getRenderingOptions(t,n);Of(e,n.annotationUID,"first-to-last",[o,s],{color:c.color,width:c.width,closePath:!1,lineDash:"2,2"}),Of(e,n.annotationUID,"midpoint-to-open-contour",[l[0],l[1]],{color:c.color,width:c.width,closePath:!1,lineDash:"2,2"})}function MLe(t,e,n){const r=this._getRenderingOptions(t,n),{allowOpenContours:i}=this.configuration,{canvasPoints:a}=this.drawData;if(r.closePath=!1,Of(e,n.annotationUID,"1",a,r),i){const o=a[0],s=a[a.length-1];CLe(o,s,this.configuration.closeContourProximity)?Of(e,n.annotationUID,"2",[s,o],r):ho(e,n.annotationUID,"0",[o],{color:r.color,handleRadius:2})}}function ILe(t,e,n){const{viewport:r}=t,{fusedCanvasPoints:i}=this.editData;if(i===void 0){this.renderClosedContour(t,e,n);return}const a=DC(n,r),o=[i,...a],s=this._getRenderingOptions(t,n),l="preview-1";n.parentAnnotationUID&&s.fillOpacity&&(s.fillOpacity=0),$h(e,n.annotationUID,l,o,s)}function RLe(t,e,n){const{fusedCanvasPoints:r}=this.editData;if(r===void 0){this.renderOpenContour(t,e,n);return}const i=this._getRenderingOptions(t,n);Of(e,n.annotationUID,"preview-1",r,i)}function ALe(t,e,n){if(n.parentAnnotationUID)return;const{viewport:r}=t,i=this._getRenderingOptions(t,n),a=n.data.contour.polyline.map(p=>r.worldToCanvas(p)),o=DC(n,r),s="1",l=a[0],c=6,f=100,u=[];for(let p=0;p<f;p++){const g=p/f*2*Math.PI,m=l[0]+c*Math.cos(g),y=l[1]+c*Math.sin(g);u.push([m,y])}const d=[[l[0]-c*2,l[1]],[l[0]+c*2,l[1]],[l[0],l[1]-c*2],[l[0],l[1]+c*2]];$h(e,n.annotationUID,s+"-crosshair_v",[d[0],d[1]],i),$h(e,n.annotationUID,s+"-crosshair_h",[d[2],d[3]],i);const h=[u,...o];$h(e,n.annotationUID,s,h,i)}function PLe(t){t.renderContour=TLe.bind(t),t.renderClosedContour=_Le.bind(t),t.renderOpenContour=DLe.bind(t),t.renderPointContourWithMarker=ALe.bind(t),t.renderOpenUShapedContour=OLe.bind(t),t.renderContourBeingDrawn=MLe.bind(t),t.renderClosedContourBeingEdited=ILe.bind(t),t.renderOpenContourBeingEdited=RLe.bind(t),t._getRenderingOptions=SLe.bind(t)}function Du(t){const e=NLe(t),n=(e.top[1]+e.bottom[1])/2;return[e.right[0],n]}function NLe(t){const e=[t[0],t[1]].sort(o),n=[t[0],t[1]].sort(s),r=e[e.length-1],i=n[0],a=n[n.length-1];return{top:i,bottom:a,right:r};function o(l,c){return l[0]<c[0]?-1:1}function s(l,c){return l[1]<c[1]?-1:1}}function qm(t,e){if(t instanceof lo){const n=_0(e),r=yt.getVolume(n);return!!r?.scaling&&Object.keys(r.scaling).length>0}else if(t instanceof aa){const{preScale:n}=t.getImageData()||{};return!!n?.scaled}else return!1}function YV(t,e){let n=0;for(let r=0;r<t.length-1;r++){const i=t[r],a=t[r+1];n+=Math.sqrt(Math.pow(a[0]-i[0],2)+Math.pow(a[1]-i[1],2))}if(e){const r=t[0],i=t[t.length-1];n+=Math.sqrt(Math.pow(i[0]-r[0],2)+Math.pow(i[1]-r[1],2))}return n}class LLe extends na{constructor(e,n){super(e,n)}renderAnnotation(e,n){let r=!1;const{viewport:i}=e,{element:a}=i;if(!i.getRenderingEngine())return console.warn("Rendering Engine has been destroyed"),r;let o=Wi(this.getToolName(),a);if(!o?.length||(o=this.filterInteractableAnnotationsForElement(a,o),!o?.length))return r;const s=this.getTargetId(i),l={toolGroupId:this.toolGroupId,toolName:this.getToolName(),viewportId:e.viewport.id};for(let c=0;c<o.length;c++){const f=o[c];l.annotationUID=f.annotationUID;const u=this.getAnnotationStyle({annotation:f,styleSpecifier:l});if(!u.visibility)continue;const d=this.renderAnnotationInstance({enabledElement:e,targetId:s,annotation:f,annotationStyle:u,svgDrawingHelper:n});r||=d,f.invalidated=!1}return r}createAnnotation(e){const n=super.createAnnotation(e);return Object.assign(n.data,{contour:{polyline:[],closed:!1}}),Object.assign(n,{interpolationUID:"",autoGenerated:!1}),n}addAnnotation(e,n){return hr(e,n)}cancelAnnotation(e){}moveAnnotation(e,n){const{points:r}=e.data.handles;for(let i=0,a=r.length;i<a;i++){const o=r[i];o[0]+=n[0],o[1]+=n[1],o[2]+=n[2]}e.invalidated=!0,py(e).forEach(i=>this.moveAnnotation(i,n))}updateContourPolyline(e,n,r,i){const a=this.configuration?.decimate||{};_u(e,n,r,{decimate:{enabled:!!a.enabled,epsilon:a.epsilon},updateWindingDirection:i?.updateWindingDirection})}getPolylinePoints(e){return e.data.contour?.polyline??e.data.polyline}renderAnnotationInstance(e){const{enabledElement:n,annotationStyle:r,svgDrawingHelper:i}=e,a=e.annotation;if(a.parentAnnotationUID)return;const{annotationUID:o}=a,{viewport:s}=n,{worldToCanvas:l}=s,c=this.getPolylinePoints(a).map(y=>l(y)),{lineWidth:f,lineDash:u,color:d,fillColor:h,fillOpacity:p}=r,g=DC(a,s),m=[c,...g];return $h(i,o,"contourPolyline",m,{color:d,lineDash:u,lineWidth:Math.max(.1,f),fillColor:h,fillOpacity:p}),!0}}const bs={...XIe,...WIe,resetAnnotationManager:wAe},JV="PlanarFreehandContourSegmentationTool";function N7(t,e=[]){const{viewport:n,sliceData:r,annotation:i}=t,a=new Map,{toolName:o,originalToolName:s}=i.metadata,l=s||o,c=(Wi(l,n.element)||[]).filter(f=>!f.metadata.originalToolName||f.metadata.originalToolName===l);if(l!==JV){const f=Wi(JV,n.element);f?.length&&f.forEach(u=>{const{metadata:d}=u;d.originalToolName===l&&d.originalToolName!==d.toolName&&c.push(u)})}if(!c?.length)return a;for(let f=0;f<r.numberOfSlices;f++){const u=c.filter(h=>h.metadata.sliceIndex===f);if(!u?.length)continue;const d=u.filter(h=>e.every(p=>{const m=(p.parentKey?p.parentKey(h):h)?.[p.key];return Array.isArray(m)?m.every((y,v)=>y===p.value[v]):m===p.value}));d.length&&a.set(f,d)}return a}function kLe(t,e){const n=N7(t,e),r=[];if(!n?.size)return r;for(const i of n.values())i.forEach(a=>{r.push(a)});return r}function KQ(t,e,n){const r=Mo({data:{},metadata:{}},n);return Object.assign(r,{highlighted:!1,invalidated:!0,autoGenerated:!0,annotationUID:void 0,cachedStats:{},childAnnotationUIDs:[],parentAnnotationUID:void 0}),Object.assign(r.data,{handles:{points:e.points||e||[],interpolationSources:e.sources,activeHandleIndex:null,textBox:{hasMoved:!1,worldPosition:[0,0,0],worldBoundingBox:{topLeft:[0,0,0],topRight:[0,0,0],bottomLeft:[0,0,0],bottomRight:[0,0,0]}}},contour:{...n.data.contour,polyline:t}}),r}function VLe(t,e){const n=N7(e,[{key:"interpolationUID",value:e.interpolationUID}]),r=FLe(n);if(!r){console.warn("No annotations found to interpolate",n);return}const i=ULe(n,t.annotationUID),a=[];for(let o=r[0]+1;o<r[1];o++)if(BLe(n,o)){const s=GLe(o,r,n);(s?.[0]===i||s?.[1]===i)&&$Le(s,a,o)}return{interpolationData:n,interpolationList:a}}function FLe(t){let e=1/0,n=-1/0,r=!1;for(const[i,a]of t.entries())a.length&&(e=Math.min(i,e),n=Math.max(i,n),r=!0);if(r)return[e,n]}function ULe(t,e){for(const[n,r]of t)for(let i=0;i<r.length;i++)if(r[i].annotationUID===e)return n}function BLe(t,e){const n=t.get(e);return!n?.length||n.length===1&&n[0].autoGenerated}function $Le(t,e,n){const[r]=t;e[r]||={pair:t,list:[]},e[r].list.push(n)}function GLe(t,e,n){const r=[];let i=!0;for(let a=t-1;a>=e[0];a--){const o=n.get(a);if(o?.length){if(o[0].autoGenerated)continue;o.length>1&&(i=!1),r.push(a);break}}if(!(!i||!r.length)){for(let a=t+1;a<=e[1];a++){const o=n.get(a);if(o?.length){if(o[0].autoGenerated)continue;o.length>1&&(i=!1),r.push(a);break}}if(!(!i||r.length<2))return r}}const{PointsManager:ZV}=Hr;function jLe(t,e=12){const n=ZV.create3(e);n.sources=[];const{sources:r}=n,{length:i,sources:a=[]}=t,o=5;if(i<o*3)return t.subselect(e);const s=Math.floor(Math.max(2*i/e,o*2));a.forEach(()=>r.push(ZV.create3(e)));const l=zLe(t,o),c=WLe(l,e),f=[];if(c?.length>2){let u=-1;const d=s/3;c.forEach(g=>{const[m,,y]=g,v=Math.ceil((m+y)/2);y-u<d||(v-m>2*d?(lg(f,u,m,s,i),u=lg(f,m,v,s,i)):u=lg(f,u,v,s,i),y-u>d&&(u=lg(f,u,y,s,i)))});const h=f[0];n_(h+i-u,i)>2*d&&lg(f,u,h-d,s,i)}else{const u=Math.floor(i/e);lg(f,-1,i-u,u,i)}return f.forEach(u=>{const d=t.getPointArray(u);n.push(d),a.forEach((h,p)=>r[p].push(h.getPoint(u)))}),n}function zLe(t,e=6){const{length:n}=t,r=ct(),i=ct(),a=new Float32Array(n);for(let o=0;o<n;o++){const s=t.getPoint(o),l=t.getPoint(o-e),c=t.getPoint((o+e)%n);ur(r,s,l),ur(i,c,s);const f=zt(r,i)/(g6(r)*g6(i));a[o]=f}return a}function WLe(t,e){const{max:n,deviation:r}=HLe(t),{length:i}=t;if(r<.01||i<e*3)return[];const a=[];let o=null,s,l=0;for(let c=0;c<i;c++){const f=t[c];f<n-r?o?(o[2]=c,f<s&&(s=f,l=c),o[1]=l):(s=f,l=c,o=[c,c,c]):o&&(a.push(o),o=null)}return o&&(a[0][0]===0?a[0][0]=o[0]:(o[1]=l,o[2]=i-1,a.push(o))),a}function lg(t,e,n,r,i){n<e&&(n+=i);const a=n-e,o=Math.ceil(a/r);if(o<=0)return t[t.length-1]!==n&&t.push(n_(n,i)),n;for(let s=1;s<=o;s++){const l=n_(e+s*a/o,i);t.push(l)}return t[t.length-1]}function n_(t,e){return(Math.round(t)+e)%e}function HLe(t){const{length:e}=t;let n=0,r=1/0,i=-1/0,a=0;for(let s=0;s<e;s++){const l=t[s];n+=l,r=Math.min(r,l),i=Math.max(i,l)}const o=n/e;for(let s=0;s<e;s++){const l=t[s]-o;a+=l*l}return{mean:o,max:i,min:r,sumSq:a,deviation:Math.sqrt(a/e)}}function KLe(t){const{parentAnnotationUID:e,annotationUID:n}=t;if(!e)return t.interpolationUID;const r=bs.getAnnotation(e),{interpolationUID:i}=r,a=r.childAnnotationUIDs.indexOf(n);return t.interpolationUID=`${i}-${a}`,t.interpolationUID}const{PointsManager:av}=Hr,QV=.2;function Ib(t){if(!t.annotation)return;const{isInterpolationUpdate:e,annotation:n}=t;queueMicrotask(()=>{try{e&&(n.isInterpolationUpdate=!0,n.autoGenerated=!1),qLe(t)}finally{e&&(n.autoGenerated=!0)}})}function qLe(t){const{annotation:e}=t;KLe(e);const{interpolationData:n,interpolationList:r}=VLe(e,t)||{};if(!n||!r)return;const i={toolName:e.metadata.toolName,toolType:e.metadata.toolName,viewport:t.viewport};for(let c=0;c<r.length;c++)r[c]&&XLe(r[c].list,r[c].pair,n,i);const{id:a,renderingEngineId:o,element:s}=t.viewport,l={annotation:e,element:s,viewportId:a,renderingEngineId:o};r.length&&Ct(t.viewport.element,ee.ANNOTATION_INTERPOLATION_PROCESS_COMPLETED,l)}function XLe(t,e,n,r){const i=n.get(e[0])[0],a=n.get(e[1])[0],o=oF(i.data.contour.polyline),s=oF(a.data.contour.polyline),{c1Interp:l,c2Interp:c}=eke(o,s);l.kIndex=e[0],c.kIndex=e[1],t.forEach(function(f){YLe(l,c,f,e,n,o.x.length>s.x.length,r)})}function YLe(t,e,n,r,i,a,o){const[s,l]=r,c=(n-s)/(l-s),f=i.get(s)[0],u=i.get(l)[0],d=QLe(t,e,c,a),h=c>.5?u:f,p=jLe(d);i.has(n)?ZLe(d,p,n,h,o):JLe(d,p,n,h,o)}function JLe(t,e,n,r,i){const a=t.points,{viewport:o}=i,s=KQ(a,e,r),l=o.getViewReference({sliceIndex:n});if(!l)throw new Error(`Can't find slice ${n}`);Object.assign(s.metadata,l),bs.addAnnotation(s,o.element),r.onInterpolationComplete?.(s,r);const{parentAnnotationUID:c}=r;if(c){const f=bs.getAnnotation(c),u=qQ(f,n,i);LQ(o,u,s)}}function qQ(t,e,n){const{viewport:r}=n,i=bs.getAnnotations(t.metadata.toolName,r.element);for(let a=0;a<i.length;a++){const o=i[a];if(o.interpolationUID===t.interpolationUID&&o.metadata.sliceIndex===e)return o}}function ZLe(t,e,n,r,i){const a=qQ(r,n,i),o=t.points,s=KQ(o,e,a);Object.assign(a,{metadata:s.metadata,data:s.data})}function QLe(t,e,n,r){const i=r?t.I:e.I,a=av.fromXYZ(t),o=av.fromXYZ(e),{length:s}=a,l=av.create3(s),c=ct(),f=ct(),u=av.create3(s);u.kIndex=t.kIndex;const d=av.create3(s);d.kIndex=e.kIndex;for(let h=0;h<t.x.length;h++)if(i[h]){const p=a.getPoint(h),g=o.getPoint(h);u.push(p),d.push(g),ur(c,g,p),l.push(Or(f,p,c,n))}return l.sources=[u,d],l}function eke(t,e){const n=aF(t),r=aF(e),i=Math.max(Math.ceil(n[n.length-1]/QV),Math.ceil(r[r.length-1]/QV)),a=iF(n),o=iF(r),s=i+e.x.length,l=i+t.x.length,c=rF(s,a),f=rF(l,o),u=nF(s-2,t.x.length),d=nF(l-2,e.x.length),h=tF(c,u),p=tF(f,d),g=eF(t,h),m=eF(e,p);return nke(g,m),tke(g,m)}function tke(t,e){const n={x:[],y:[],z:[],I:[]},r={x:[],y:[],z:[],I:[]};for(let i=0;i<t.x.length;i++)(t.I[i]||e.I[i])&&(n.x.push(t.x[i]),n.y.push(t.y[i]),n.z.push(t.z[i]),n.I.push(t.I[i]),r.x.push(e.x[i]),r.y.push(e.y[i]),r.z.push(e.z[i]),r.I.push(e.I[i]));return{c1Interp:n,c2Interp:r}}function nke(t,e){const n=t.x.length,r={startingNode:0,totalSquaredXYLengths:1/0};for(let a=0;a<n;a++){let o=a,s=0;for(let l=0;l<n;l++)s+=(t.x[o]-e.x[l])**2+(t.y[o]-e.y[l])**2+(t.z[o]-e.z[l])**2,o++,o===n&&(o=0);s<r.totalSquaredXYLengths&&(r.totalSquaredXYLengths=s,r.startingNode=a)}const i=r.startingNode;Px(t.x,i),Px(t.y,i),Px(t.z,i),Px(t.I,i)}function Px(t,e){e-=t.length*Math.floor(e/t.length);const n=t.splice(0,e);return t.push(...n),t}function eF(t,e){const n={x:[],y:[],z:[],I:[]};for(let r=0;r<t.x.length-1;r++){n.x.push(t.x[r]),n.y.push(t.y[r]),n.z.push(t.z[r]),n.I.push(!0);const i=(t.x[r+1]-t.x[r])/(e[r]+1),a=(t.y[r+1]-t.y[r])/(e[r]+1),o=(t.z[r+1]-t.z[r])/(e[r]+1);for(let s=0;s<e[r]-1;s++)n.x.push(n.x[n.x.length-1]+i),n.y.push(n.y[n.y.length-1]+a),n.z.push(n.z[n.z.length-1]+o),n.I.push(!1)}return n}function tF(t,e){const n=[];for(let o=0;o<t.length;++o)n[o]=o;n.sort(function(o,s){return t[o]<t[s]?-1:1});const r=[];for(let o=0;o<e.length;o++)r.push(e[n[o]]);const i=r.reduce(function(o,s,l){return s&&o.push(l),o},[]),a=[];for(let o=0;o<i.length-1;o++)a.push(i[o+1]-i[o]);return a}function nF(t,e){const n=new Array(t+e);return n.fill(!1,0,t),n.fill(!0,t,t+e),n}function rF(t,e){const n=1/(t-1),r=[n];for(let i=1;i<t-2;i++)r.push(r[r.length-1]+n);return r.concat(e)}function iF(t){const e=[];for(let n=0;n<t.length;n++)e.push(t[n]/t[t.length-1]);return e}function aF(t){const e=[0];for(let n=1;n<t.x.length;n++){const r=Math.sqrt((t.x[n]-t.x[n-1])**2+(t.y[n]-t.y[n-1])**2+(t.z[n]-t.z[n-1])**2);e.push(e[n-1]+r)}return e}function oF(t){const e={x:[],y:[],z:[]};for(let n=0;n<t.length;n++)e.x[n]=t[n][0],e.y[n]=t[n][1],e.z[n]=t[n][2];return e.x.push(e.x[0]),e.y.push(e.y[0]),e.z.push(e.z[0]),e}function sF(t){const{annotation:e}=t,n=N7(t,[{key:"interpolationUID",value:t.interpolationUID}]),r=e.metadata.sliceIndex;let i=-1,a=t.sliceData.numberOfSlices;for(const[s,l]of n.entries())s===r||!l.find(f=>!f.autoGenerated)||(s<r?i=Math.max(s,i):a=Math.min(s,a));const o=[];for(const[s,l]of n.entries())s<=i||s>=a||s===r||l.forEach(c=>{c.autoGenerated&&(bs.removeAnnotation(c.annotationUID),o.push(c))});if(o.length){const s={annotations:o,element:t.viewport.element,viewportId:t.viewport.id,renderingEngineId:t.viewport.getRenderingEngine().id};Ct(t.viewport.element,ee.INTERPOLATED_ANNOTATIONS_REMOVED,s)}if(i>=0&&a<t.sliceData.numberOfSlices){const s=n.get(a)[0],l={viewport:t.viewport,sliceData:{numberOfSlices:t.sliceData.numberOfSlices,imageIndex:s.metadata.sliceIndex},annotation:s,interpolationUID:s.interpolationUID};Ib(l)}}function L8(t){const e=FQ(t);return e.length?e[0]:void 0}const{uuidv4:rke}=Hr,ike=[wn.HandlesUpdated,wn.InterpolationUpdated],_l=class _l{static addTool(e){this.toolNames.includes(e)||this.toolNames.push(e)}static acceptAutoGenerated(e,n={}){const{toolNames:r,segmentationId:i,segmentIndex:a,sliceIndex:o}=n;for(const s of r||_l.toolNames){const l=bs.getAnnotations(s,e);if(l?.length)for(const c of l){const{interpolationUID:f,data:u,autoGenerated:d,metadata:h}=c;f&&(c.interpolationCompleted=!0),d&&(a&&a!==u.segmentation.segmentIndex||o!==void 0&&h&&o!==h.sliceIndex||i&&i!==u.segmentation.segmentationId||(b0(c),c.autoGenerated=!1))}}}};_l.toolNames=[],_l.handleAnnotationCompleted=e=>{const n=e.detail.annotation;if(!n?.metadata)return;const{toolName:r,originalToolName:i}=n.metadata;if(!_l.toolNames.includes(r)&&!_l.toolNames.includes(i))return;const a=L8(n);if(!a){console.warn("Unable to find viewport for",n);return}const o=k8(a),s={viewport:a,sliceData:o,annotation:n,interpolationUID:n.interpolationUID},l=!!n.interpolationUID;if(n.autoGenerated=!1,l){sF(s),Ib(s);return}const c=[{key:"segmentIndex",value:n.data.segmentation.segmentIndex,parentKey:h=>h.data.segmentation},{key:"viewPlaneNormal",value:n.metadata.viewPlaneNormal,parentKey:h=>h.metadata},{key:"viewUp",value:n.metadata.viewUp,parentKey:h=>h.metadata}];let f=kLe(s,c);const{sliceIndex:u}=n.metadata,d=new Set;f.forEach(h=>{if(h.interpolationCompleted||h.metadata.sliceIndex===u){const{interpolationUID:p}=h;d.add(p)}}),f=f.filter(h=>!d.has(h.interpolationUID)),n.interpolationUID=f[0]?.interpolationUID||rke(),s.interpolationUID=n.interpolationUID,Ib(s)},_l.handleAnnotationUpdate=e=>{const n=e.detail.annotation,{changeType:r=wn.HandlesUpdated}=e.detail;if(!n?.metadata)return;const{toolName:i,originalToolName:a}=n.metadata;if(!_l.toolNames.includes(i)&&!_l.toolNames.includes(a)||!ike.includes(r))return;const o=L8(n);if(!o){console.warn("Unable to find matching viewport for annotation interpolation",n);return}n.autoGenerated&&(b0(n),n.autoGenerated=!1);const s=k8(o),l={viewport:o,sliceData:s,annotation:n,interpolationUID:n.interpolationUID,isInterpolationUpdate:r===wn.InterpolationUpdated};Ib(l)},_l.handleAnnotationDelete=e=>{const n=e.detail.annotation;if(!n?.metadata)return;const{toolName:r}=n.metadata;if(!_l.toolNames.includes(r)||n.autoGenerated)return;const i=L8(n);if(!i){console.warn("No viewport, can't delete interpolated results",n);return}const a=k8(i),o={viewport:i,sliceData:a,annotation:n,interpolationUID:n.interpolationUID};n.autoGenerated=!1,sF(o)};let Mf=_l;function k8(t){return{numberOfSlices:t.getNumberOfSlices(),imageIndex:t.getCurrentImageIdIndex()}}function ake(t){t.forEach(e=>{const n=np(e);if(!n){console.warn(`ToolGroup not available for ${e}`);return}n.getViewportsInfo().forEach(i=>{const{renderingEngineId:a,viewportId:o}=i,s=$f(a);if(!s){console.warn(`RenderingEngine not available for ${a}`);return}const l=s.getViewport(o);yy(l.element)})})}function xy(t){const e=Ki(t);if(!e)throw new Error(`No segmentation state found for ${t}`);const{segments:n}=e;return Object.keys(n).filter(i=>n[i].locked).map(i=>parseInt(i))}function oke(){return Ds.getNextColorLUTIndex()}const r_=[[0,0,0,0],[221,84,84,255],[77,228,121,255],[166,70,235,255],[189,180,116,255],[109,182,196,255],[204,101,157,255],[123,211,94,255],[93,87,218,255],[225,128,80,255],[73,232,172,255],[181,119,186,255],[176,193,112,255],[105,153,200,255],[208,97,120,255],[90,215,101,255],[135,83,222,255],[229,178,76,255],[122,183,181,255],[190,115,171,255],[149,197,108,255],[100,118,205,255],[212,108,93,255],[86,219,141,255],[183,79,226,255],[233,233,72,255],[118,167,187,255],[194,111,146,255],[116,201,104,255],[115,96,209,255],[216,147,89,255],[82,223,188,255],[230,75,224,255],[163,184,121,255],[114,143,191,255],[198,107,114,255],[99,206,122,255],[153,92,213,255],[220,192,85,255],[78,215,227,255],[234,71,173,255],[141,188,117,255],[110,113,195,255],[202,128,103,255],[95,210,157,255],[195,88,217,255],[206,224,81,255],[74,166,231,255],[185,120,139,255],[113,192,113,255],[133,106,199,255],[207,162,98,255],[91,214,198,255],[221,84,198,255],[159,228,77,255],[70,111,235,255],[189,119,116,255],[109,196,138,255],[165,101,204,255],[211,201,94,255],[87,191,218,255],[225,80,153,255],[106,232,73,255],[124,119,186,255],[193,142,112,255],[105,200,168,255],[203,97,208,255],[184,215,90,255],[83,147,222,255],[229,76,101,255],[122,183,130,255],[146,115,190,255],[197,171,108,255],[100,205,205,255],[212,93,177,255],[141,219,86,255],[79,97,226,255],[233,99,72,255],[118,187,150,255],[173,111,194,255],[197,201,104,255],[96,171,209,255],[216,89,137,255],[94,223,82,255],[107,75,230,255],[184,153,121,255],[114,191,175,255],[198,107,191,255],[166,206,99,255],[92,132,213,255],[220,85,91,255],[78,227,115,255],[159,71,234,255],[188,176,117,255],[110,185,195,255],[202,103,161,255],[129,210,95,255],[88,88,217,255],[224,123,81,255],[74,231,166,255],[177,120,185,255],[179,192,113,255],[106,156,199,255],[207,98,125,255],[91,214,96,255],[130,84,221,255],[228,171,77,255],[70,235,221,255],[189,116,174,255],[153,196,109,255],[101,123,204,255],[211,104,94,255],[87,218,136,255],[177,80,225,255],[232,225,73,255],[119,169,186,255],[193,112,149,255],[121,200,105,255],[111,97,208,255],[215,142,90,255],[83,222,181,255],[229,76,229,255],[165,183,122,255],[115,146,190,255],[197,108,119,255],[100,205,118,255],[148,93,212,255],[219,186,86,255],[79,220,226,255],[233,72,179,255],[144,187,118,255],[111,118,194,255],[201,124,104,255],[96,209,153,255],[189,89,216,255],[211,223,82,255],[75,172,230,255],[184,121,142,255],[117,191,114,255],[130,107,198,255],[206,157,99,255],[92,213,193,255],[220,85,203,255],[165,227,78,255],[71,118,234,255],[188,117,117,255],[110,195,135,255],[161,103,202,255],[210,195,95,255],[88,195,217,255],[224,81,158,255],[113,231,74,255],[123,120,185,255],[192,139,113,255],[106,199,164,255],[198,98,207,255],[188,214,91,255],[84,153,221,255],[228,77,108,255],[70,235,84,255],[143,116,189,255],[196,167,109,255],[101,204,199,255],[211,94,182,255],[147,218,87,255],[80,104,225,255],[232,93,73,255],[119,186,147,255],[170,112,193,255],[200,200,105,255],[97,175,208,255],[215,90,142,255],[100,222,83,255],[101,76,229,255],[183,150,122,255],[115,190,171,255],[197,108,194,255],[170,205,100,255],[93,138,212,255],[219,86,97,255],[79,226,110,255],[153,72,233,255],[187,173,118,255],[111,187,194,255],[201,104,165,255],[134,209,96,255],[89,95,216,255],[223,117,82,255],[75,230,159,255],[174,121,184,255],[182,191,114,255],[107,160,198,255],[206,99,130,255],[92,213,92,255],[124,85,220,255],[227,165,78,255],[71,234,214,255],[188,117,176,255],[156,195,110,255],[103,128,202,255],[210,100,95,255],[88,217,131,255],[170,81,224,255],[231,218,74,255],[120,172,185,255],[192,113,153,255],[125,199,106,255],[107,98,207,255],[214,137,91,255],[84,221,175,255],[222,77,228,255],[194,235,70,255],[116,149,189,255],[196,109,123,255],[101,204,114,255],[143,94,211,255],[218,180,87,255],[80,225,225,255],[232,73,186,255],[147,186,119,255],[112,122,193,255],[200,121,105,255],[97,208,148,255],[184,90,215,255],[216,222,83,255],[76,178,229,255],[183,122,145,255],[121,190,115,255],[126,108,197,255],[205,153,100,255],[93,212,187,255],[219,86,208,255],[171,226,79,255],[72,126,233,255],[187,118,121,255],[111,194,132,255],[157,104,201,255],[209,190,96,255],[89,200,216,255],[223,82,164,255],[120,230,75,255],[121,121,184,255],[191,136,114,255],[107,198,160,255],[192,99,206,255],[193,213,92,255],[85,158,220,255],[227,78,115,255],[71,234,78,255],[141,117,188,255],[195,163,110,255],[103,202,194,255],[210,95,186,255],[153,217,88,255],[81,111,224,255]];function V8(t,e){const n=Ds,r=e??oke();let i=[...t];if(fr(i[0],[0,0,0,0])||(console.warn("addColorLUT: [0, 0, 0, 0] color is not provided for the background color (segmentIndex =0), automatically adding it"),i=[[0,0,0,0],...i]),i=i.map(a=>a.length===3?[a[0],a[1],a[2],255]:a),i.length<255){const a=r_.slice(i.length);i=[...i,...a]}return n.addColorLUT(i,r),r}function ip(t,e,n){const r=i0(t,{segmentationId:e});if(!r||r.length===0)return null;const i=r[0],{colorLUTIndex:a}=i,o=v7(a);let s=o[n];if(!s){if(typeof n!="number")return console.warn(`Can't create colour for LUT index ${n}`),null;s=o[n]=[0,0,0,0]}return s}function ske(t,e,n,r){const i=ip(t,e,n);for(let a=0;a<r.length;a++)i[a]=r[a];Sv(t,e)}function lke(t,e){return Ds.getSegmentationRepresentationVisibility(t,e)}function cke({segmentationId:t,segmentIndex:e,viewportId:n,autoGenerated:r=!1}){const i=ip(n,t,e),a=lke(n,{segmentationId:t,type:pn.Contour}),s=L2(n)?.segmentationId===t,c=em.getStyle({viewportId:n,segmentationId:t,type:pn.Contour,segmentIndex:e});let f=1,u,d=1,h=0;r?(f=c.outlineWidthAutoGenerated??f,u=c.outlineDashAutoGenerated??u,d=c.outlineOpacity??d,h=c.fillAlphaAutoGenerated??h):s?(f=c.outlineWidth??f,u=c.outlineDash??u,d=c.outlineOpacity??d,h=c.fillAlpha??h):(f=c.outlineWidthInactive??f,u=c.outlineDashInactive??u,d=c.outlineOpacityInactive??d,h=c.fillAlphaInactive??h),bu(t)===e&&(f+=c.activeSegmentOutlineWidthDelta),f=c.renderOutline?f:0,h=c.renderFill?h:0;const p=`rgba(${i[0]}, ${i[1]}, ${i[2]}, ${d})`,g=`rgb(${i[0]}, ${i[1]}, ${i[2]})`,y=!x7(n,{segmentationId:t,type:pn.Contour}).has(e);return{color:p,fillColor:g,lineWidth:f,fillOpacity:h,lineDash:u,textbox:{color:p},visibility:a&&y}}const Z7=class Z7 extends LLe{constructor(e,n){super(e,n),this.configuration.interpolation?.enabled&&Mf.addTool(this.getToolName())}isContourSegmentationTool(){return!0}createAnnotation(e){const n=e.detail,{element:r}=n,i=et(r);if(!i)return;const{viewport:a}=i,o=super.createAnnotation(e);if(!this.isContourSegmentationTool())return o;const s=L2(a.id);if(!s)throw new Error("No active segmentation detected, create one before using scissors tool");if(!s.representationData.Contour)throw new Error("A contour segmentation must be active");const{segmentationId:l}=s,c=bu(l);return Mo(o,{data:{segmentation:{segmentationId:l,segmentIndex:c}}})}addAnnotation(e,n){const r=super.addAnnotation(e,n);return this.isContourSegmentationTool()&&b0(e),r}cancelAnnotation(e){this.isContourSegmentationTool()&&x0(e),super.cancelAnnotation(e)}getAnnotationStyle(e){const n=super.getAnnotationStyle(e);if(!this.isContourSegmentationTool())return n;const r=this._getContourSegmentationStyle(e);return Mo(n,r)}renderAnnotationInstance(e){const{annotation:n}=e,{invalidated:r}=n,i=super.renderAnnotationInstance(e);if(r&&this.isContourSegmentationTool()){const{segmentationId:a}=n.data.segmentation;Gf(a);const s=bC(a).map(l=>qa(l).id);ake(s)}return i}_getContourSegmentationStyle(e){const n=e.annotation,{segmentationId:r,segmentIndex:i}=n.data.segmentation,{viewportId:a}=e.styleSpecifier,o=i0(a,{segmentationId:r});if(!o?.length)return{};o.length>1?o.find(m=>m.segmentationId===r&&m.type===pn.Contour):o[0];const{autoGenerated:s}=n,c=xy(r).includes(i),{color:f,fillColor:u,lineWidth:d,fillOpacity:h,lineDash:p,visibility:g}=cke({segmentationId:r,segmentIndex:i,viewportId:a,autoGenerated:s});return{color:f,fillColor:u,lineWidth:d,fillOpacity:h,lineDash:p,textbox:{color:f},visibility:g,locked:c}}};Z7.PreviewSegmentIndex=255;let k2=Z7;function uke(t,e){const n=Ft("generalSeriesModule",t);return mp(n.modality,t,e)}function mp(t,e,n){return t==="CT"?"HU":t==="PT"?fke(e,n):""}function fke(t,e){return e.isPreScaled?e.isSuvScaled?"SUV":Ft("generalSeriesModule",t)?.modality==="PT"?Ft("petSeriesModule",t)?.units||"unitless":"unknown":"raw"}const{pointCanProjectOnLine:lF}=pp,{EPSILON:dke}=cp,hke=1-dke,Q7=class Q7 extends k2{constructor(e={},n={supportedInteractionTypes:["Mouse","Touch"],configuration:{storePointData:!1,shadow:!0,preventHandleOutsideImage:!1,contourHoleAdditionModifierKey:Ia.Shift,alwaysRenderOpenContourHandles:{enabled:!1,radius:2},allowOpenContours:!0,closeContourProximity:10,checkCanvasEditFallbackProximity:6,makeClockWise:!0,subPixelResolution:4,smoothing:{smoothOnAdd:!1,smoothOnEdit:!1,knotsRatioPercentageOnAdd:40,knotsRatioPercentageOnEdit:40},interpolation:{enabled:!1,onInterpolationComplete:null},decimate:{enabled:!1,epsilon:.1},displayOnePointAsCrosshairs:!1,calculateStats:!0,getTextLines:pke,statsCalculator:w0}}){super(e,n),this.isDrawing=!1,this.isEditingClosed=!1,this.isEditingOpen=!1,this.addNewAnnotation=r=>{const i=r.detail,{element:a}=i,o=this.createAnnotation(r);this.addAnnotation(o,a);const s=fn(a,this.getToolName());return this.activateDraw(r,o,s),r.preventDefault(),ut(s),o},this.handleSelectedCallback=(r,i,a)=>{const o=r.detail,{element:s}=o,l=fn(s,this.getToolName());this.activateOpenContourEndEdit(r,i,l,a)},this.toolSelectedCallback=(r,i)=>{const a=r.detail,{element:o}=a,s=fn(o,this.getToolName());i.data.contour.closed?this.activateClosedContourEdit(r,i,s):this.activateOpenContourEdit(r,i,s),r.preventDefault()},this.isPointNearTool=(r,i,a,o)=>{const s=et(r),{viewport:l}=s,{polyline:c}=i.data.contour;let f=l.worldToCanvas(c[0]);for(let h=1;h<c.length;h++){const p=f,g=l.worldToCanvas(c[h]);if(lF(a,p,g,o))return!0;f=g}if(!i.data.contour.closed)return!1;const u=l.worldToCanvas(c[0]),d=l.worldToCanvas(c[c.length-1]);return lF(a,u,d,o)},this.cancel=r=>{const i=this.isDrawing,a=this.isEditingOpen,o=this.isEditingClosed;i?this.cancelDrawing(r):a?this.cancelOpenContourEdit(r):o&&this.cancelClosedContourEdit(r)},this._calculateCachedStats=(r,i,a,o)=>{const{data:s}=r,{cachedStats:l}=s,{polyline:c,closed:f}=s.contour,u=Object.keys(l);for(let h=0;h<u.length;h++){const p=u[h],g=this.getTargetImageData(p);if(!g)continue;const{imageData:m,metadata:y}=g,v=c.map(A=>i.worldToCanvas(A)),x={isPreScaled:qm(i,p),isSuvScaled:this.isSuvScaled(i,p,r.metadata.referencedImageId)},w=mp(y.Modality,r.metadata.referencedImageId,x),S=vc(g,()=>{const A=s.contour.polyline,L=A.length,P=new Array(L);for(let re=0;re<L;re++)P[re]=i.worldToCanvas(A[re]);const{maxX:B,maxY:U,minX:G,minY:F}=mm(P),$=i.canvasToWorld([G,F]),V=io(m,$),X=i.canvasToWorld([B,U]),Q=io(m,X);return[V,Q]}),T=v[0],_=i.canvasToWorld(T),D=i.canvasToWorld([T[0]+1,T[1]]),I=i.canvasToWorld([T[0],T[1]+1]),R=el(_,D),M=el(_,I);f?this.updateClosedCachedStats({targetId:p,viewport:i,canvasCoordinates:v,points:c,imageData:m,metadata:y,cachedStats:l,modalityUnit:w,calibratedScale:S,deltaInX:R,deltaInY:M}):this.updateOpenCachedStats({metadata:y,canvasCoordinates:v,targetId:p,cachedStats:l,modalityUnit:w,calibratedScale:S,deltaInX:R,deltaInY:M})}const d=r.invalidated;return r.invalidated=!1,d&&Fn(r,o.viewport.element,wn.StatsUpdated),l},this._renderStats=(r,i,a,o)=>{const{data:s}=r,l=this.getTargetId(i),c={toolGroupId:this.toolGroupId,toolName:this.getToolName(),viewportId:a.viewport.id,annotationUID:r.annotationUID},f=this.getLinkedTextBoxStyle(c,r);if(!f.visibility)return;const u=this.configuration.getTextLines(s,l);if(!u||u.length===0)return;const d=s.contour.polyline.map(w=>i.worldToCanvas(w));if(!s.handles.textBox.hasMoved){const w=Du(d);s.handles.textBox.worldPosition=i.canvasToWorld(w)}const h=i.worldToCanvas(s.handles.textBox.worldPosition),g=rl(o,r.annotationUID??"","1",u,h,d,{},f),{x:m,y,width:v,height:x}=g;s.handles.textBox.worldBoundingBox={topLeft:i.canvasToWorld([m,y]),topRight:i.canvasToWorld([m+v,y]),bottomLeft:i.canvasToWorld([m,y+x]),bottomRight:i.canvasToWorld([m+v,y+x])}},BNe(this),qNe(this),iLe(this),vLe(this),bLe(this),PLe(this),this._throttledCalculateCachedStats=Bl(this._calculateCachedStats,100,{trailing:!0})}filterInteractableAnnotationsForElement(e,n){if(!n||!n.length)return;const r=et(e),{viewport:i}=r;let a;if(i instanceof oa){const o=i.getCamera(),{spacingInNormalDirection:s}=ly(i,o);a=this.filterAnnotationsWithinSlice(n,o,s)}else a=I7(i,n);return a}filterAnnotationsWithinSlice(e,n,r){const{viewPlaneNormal:i}=n,a=e.filter(c=>{let f=c.metadata.viewPlaneNormal;if(!c.metadata.referencedImageId&&!f&&c.metadata.FrameOfReferenceUID){for(const d of c.data.contour.polyline){const h=ur(ct(),d,n.focalPoint),p=zt(h,n.viewPlaneNormal);if(!fr(p,0))return!1}return c.metadata.viewPlaneNormal=n.viewPlaneNormal,c.metadata.cameraFocalPoint=n.focalPoint,!0}if(!f){const{referencedImageId:d}=c.metadata,{imageOrientationPatient:h}=Ft("imagePlaneModule",d),p=En(h[0],h[1],h[2]),g=En(h[3],h[4],h[5]);f=ct(),dr(f,p,g),c.metadata.viewPlaneNormal=f}const u=Math.abs(zt(i,f))>hke;return f&&u});if(!a.length)return[];const o=r/2,{focalPoint:s}=n,l=[];for(const c of a){const u=c.data.contour.polyline[0];if(!c.isVisible)continue;const d=ct();ur(d,s,u);const h=zt(d,i);Math.abs(h)<o&&l.push(c)}return l}isContourSegmentationTool(){return!1}createAnnotation(e){const n=e.detail.currentPoints.world,r=super.createAnnotation(e),i=o=>{o.data.handles.points.length=0};return Mo(r,{data:{contour:{polyline:[[...n]]},label:"",cachedStats:{}},onInterpolationComplete:i})}getAnnotationStyle(e){return super.getAnnotationStyle(e)}renderAnnotationInstance(e){const{enabledElement:n,targetId:r,svgDrawingHelper:i}=e,a=e.annotation;let o=!1;const{viewport:s,renderingEngine:l}=n,c=this.isDrawing,f=this.isEditingOpen,u=this.isEditingClosed;if(!(c||f||u))this.configuration.displayOnePointAsCrosshairs&&a.data.contour.polyline.length===1?this.renderPointContourWithMarker(n,i,a):this.renderContour(n,i,a);else{const d=this.commonData.annotation.annotationUID;if(a.annotationUID===d)if(c)this.renderContourBeingDrawn(n,i,a);else if(u)this.renderClosedContourBeingEdited(n,i,a);else if(f)this.renderOpenContourBeingEdited(n,i,a);else throw new Error(`Unknown ${this.getToolName()} annotation rendering state`);else this.configuration.displayOnePointAsCrosshairs&&a.data.contour.polyline.length===1?this.renderPointContourWithMarker(n,i,a):this.renderContour(n,i,a);o=!0}if(this.configuration.calculateStats)return this._calculateStatsIfActive(a,r,s,l,n),this._renderStats(a,s,n,i),o}_calculateStatsIfActive(e,n,r,i,a){const o=this.commonData?.annotation.annotationUID;if(!(e.annotationUID===o&&!this.commonData?.movingTextBox)&&!this.commonData?.movingTextBox){const{data:s}=e;s.cachedStats[n]?.unit?e.invalidated&&this._throttledCalculateCachedStats(e,r,i,a):(s.cachedStats[n]={Modality:null,area:null,max:null,mean:null,stdDev:null,areaUnit:null,unit:null},this._calculateCachedStats(e,r,i,a))}}updateClosedCachedStats({viewport:e,points:n,imageData:r,metadata:i,cachedStats:a,targetId:o,modalityUnit:s,canvasCoordinates:l,calibratedScale:c,deltaInX:f,deltaInY:u}){const{scale:d,areaUnit:h,unit:p}=c,{voxelManager:g}=e.getImageData(),m=io(r,n[0]);m[0]=Math.floor(m[0]),m[1]=Math.floor(m[1]),m[2]=Math.floor(m[2]);let y=m[0],v=m[0],x=m[1],w=m[1],S=m[2],T=m[2];for(let X=1;X<n.length;X++){const Q=io(r,n[X]);Q[0]=Math.floor(Q[0]),Q[1]=Math.floor(Q[1]),Q[2]=Math.floor(Q[2]),y=Math.min(y,Q[0]),v=Math.max(v,Q[0]),x=Math.min(x,Q[1]),w=Math.max(w,Q[1]),S=Math.min(S,Q[2]),T=Math.max(T,Q[2])}const _=io(r,n[1]);_[0]=Math.floor(_[0]),_[1]=Math.floor(_[1]),_[2]=Math.floor(_[2]);let D=vy(l)/d/d;D*=f*u;let I=YV(l,closed)/d;I*=Math.sqrt(Math.pow(f,2)+Math.pow(u,2));const R=.01*(v-y),M=.01*(w-x),A=.01*(T-S);y=Math.floor(y-R),v=Math.ceil(v+R),x=Math.floor(x-M),w=Math.ceil(w+M),S=Math.floor(S-A),T=Math.ceil(T+A);const L=[[y,v],[x,w],[S,T]],P=r.indexToWorld([v,w,T]),B=e.worldToCanvas(P);let U=0,G=[],F=0,$;g&&($=g.forEach(this.configuration.statsCalculator.statsCallback,{imageData:r,isInObject:(X,Q)=>{let re=!0;const ye=e.worldToCanvas(X);return ye[1]!=U&&(F=0,U=ye[1],G=RQ(l,ye,[B[0],ye[1]]),G.sort((function(me){return function(Ce,we){return Ce[me]===we[me]?0:Ce[me]<we[me]?-1:1}})(0))),G.length&&ye[0]>G[0][0]&&(G.shift(),F++),F%2===0&&(re=!1),re},boundsIJK:L,returnPoints:this.configuration.storePointData}));const V=this.configuration.statsCalculator.getStatistics();a[o]={Modality:i.Modality,area:D,perimeter:I,mean:V.mean?.value,max:V.max?.value,min:V.min?.value,stdDev:V.stdDev?.value,statsArray:V.array,pointsInShape:$,areaUnit:h,modalityUnit:s,unit:p}}updateOpenCachedStats({targetId:e,metadata:n,canvasCoordinates:r,cachedStats:i,modalityUnit:a,calibratedScale:o,deltaInX:s,deltaInY:l}){const{scale:c,unit:f}=o;let u=YV(r,closed)/c;u*=Math.sqrt(Math.pow(s,2)+Math.pow(l,2)),i[e]={Modality:n.Modality,length:u,modalityUnit:a,unit:f}}};Q7.toolName="PlanarFreehandROI";let hf=Q7;function pke(t,e){const n=t.cachedStats[e],{area:r,mean:i,stdDev:a,length:o,perimeter:s,max:l,min:c,isEmptyArea:f,unit:u,areaUnit:d,modalityUnit:h}=n||{},p=[];if(li(r)){const g=f?"Area: Oblique not supported":`Area: ${kn(r)} ${d}`;p.push(g)}return li(i)&&p.push(`Mean: ${kn(i)} ${h}`),li(l)&&p.push(`Max: ${kn(l)} ${h}`),li(c)&&p.push(`Min: ${kn(c)} ${h}`),li(a)&&p.push(`Std Dev: ${kn(a)} ${h}`),li(s)&&p.push(`Perimeter: ${kn(s)} ${u}`),li(o)&&p.push(`${kn(o)} ${u}`),p}const eO=class eO extends hf{constructor(e){const n=Mo({configuration:{calculateStats:!1,allowOpenContours:!1}},e);super(n)}isContourSegmentationTool(){return!0}renderAnnotationInstance(e){const n=e.annotation,{invalidated:r}=n,i=super.renderAnnotationInstance(e);if(r){const{segmentationId:a}=n.data.segmentation;Gf(a)}return i}};eO.toolName="PlanarFreehandContourSegmentationTool";let Y3=eO;const gke={[pn.Labelmap]:iNe,[pn.Contour]:KPe,[pn.Surface]:QRe},Nx=Y3.toolName;class mke{constructor(){this._needsRender=new Set,this._pendingRenderQueue=[],this._animationFrameSet=!1,this._animationFrameHandle=null,this._getAllViewports=()=>Fl().flatMap(n=>n.getViewports()),this._renderFlaggedSegmentations=()=>{if(this._throwIfDestroyed(),Array.from(this._needsRender).forEach(n=>{this._triggerRender(n)}),this._needsRender.clear(),this._animationFrameSet=!1,this._animationFrameHandle=null,this._pendingRenderQueue.length>0){const n=this._pendingRenderQueue.shift();n&&n.length>0&&this._setViewportsToBeRenderedNextFrame(n)}}}renderSegmentationsForViewport(e){const n=e?[e]:this._getViewportIdsForSegmentation();this._setViewportsToBeRenderedNextFrame(n)}renderSegmentation(e){const n=this._getViewportIdsForSegmentation(e);this._setViewportsToBeRenderedNextFrame(n)}_getViewportIdsForSegmentation(e){const n=this._getAllViewports(),r=[];for(const i of n){const a=i.id;e?i0(a,{segmentationId:e})?.length>0&&r.push(a):i0(a)?.length>0&&r.push(a)}return r}_throwIfDestroyed(){if(this.hasBeenDestroyed)throw new Error("this.destroy() has been manually called to free up memory, can not longer use this instance. Instead make a new one.")}_setViewportsToBeRenderedNextFrame(e){if(this._animationFrameSet){this._pendingRenderQueue.push(e);return}e.forEach(n=>{this._needsRender.add(n)}),this._render()}_render(){this._needsRender.size>0&&this._animationFrameSet===!1&&(this._animationFrameHandle=window.requestAnimationFrame(this._renderFlaggedSegmentations),this._animationFrameSet=!0)}_triggerRender(e){const n=i0(e);if(!n?.length)return;const{viewport:r}=mr(e)||{};if(!r)return;const i=[],a=n.map(o=>{o.type===pn.Contour&&this._addPlanarFreeHandToolIfAbsent(r);const s=gke[o.type];try{const l=s.render(r,o);i.push(l)}catch(l){console.error(l)}return Promise.resolve({segmentationId:o.segmentationId,type:o.type})});Promise.allSettled(a).then(o=>{const s=o.filter(f=>f.status==="fulfilled").map(f=>f.value);function l(f){const{element:u,viewportId:d}=f.detail;u.removeEventListener(vt.IMAGE_RENDERED,l),s.forEach(h=>{const p={viewportId:d,segmentationId:h.segmentationId,type:h.type};Ct(St,ee.SEGMENTATION_RENDERED,{...p})})}r.element.addEventListener(vt.IMAGE_RENDERED,l),r.render()})}_addPlanarFreeHandToolIfAbsent(e){Nx in Mt.tools||Xr(Y3);const n=qa(e.id);n.hasTool(Nx)||(n.addTool(Nx),n.setToolPassive(Nx))}}function XQ(t){JQ.renderSegmentationsForViewport(t)}function YQ(t){JQ.renderSegmentation(t)}const JQ=new mke;function vke({modifiedSlicesToUse:t,representationData:e,type:n}){const r=yt.getVolume(e[n].volumeId);if(!r){console.warn("segmentation not found in cache");return}const{imageData:i,vtkOpenGLTexture:a}=r;let o;if(t?.length>0)o=t;else{const s=i.getDimensions()[2];o=[...Array(s).keys()]}o.forEach(s=>{a.setUpdatedFrame(s)}),i.modified()}function yke({viewportIds:t,segmentationId:e}){t.forEach(n=>{let r=i0(n,{segmentationId:e});r=r.filter(i=>i.type===pn.Labelmap),r.forEach(i=>{if(i.segmentationId!==e)return;const a=mr(n);if(!a)return;const{viewport:o}=a;if(o instanceof oa)return;const s=$v(n,e);s?.length&&s.forEach((l,c)=>{const f=l.actor.getMapper().getInputData(),u=vm(n,e),d=yt.getImage(u[c]);f.modified(),oC(f,d)})})})}const xke=function(t){const{segmentationId:e,modifiedSlicesToUse:n}=t.detail,{representationData:r}=Ki(e),i=bC(e),a=i.some(l=>{const{viewport:c}=mr(l);return c instanceof oa}),o=i.some(l=>{const{viewport:c}=mr(l);return c instanceof aa}),s=a&&o;i.forEach(l=>{const{viewport:c}=mr(l);c instanceof oa&&vke({modifiedSlicesToUse:s?[]:n,representationData:r,type:pn.Labelmap}),c instanceof aa&&yke({viewportIds:i,segmentationId:e})})},ZQ=function(t){const{segmentationId:e}=t.detail,{representationData:n}=Ki(e);n.Labelmap&&xke(t),YQ(e)},QQ=function(t){const{segmentationId:e}=t.detail;YQ(e)};function bke(t,e){return Ds.updateLabelmapSegmentationImageReferences(t,e)}const wke=function(t){if(!t)return;const e=et(t);if(!e)return;const{viewport:n}=e;n instanceof lo||(t.addEventListener(vt.PRE_STACK_NEW_IMAGE,V2),t.addEventListener(vt.IMAGE_RENDERED,V2))},Cke=function(t){t.removeEventListener(vt.PRE_STACK_NEW_IMAGE,V2),t.removeEventListener(vt.IMAGE_RENDERED,V2)};function V2(t){const e=t.detail,{viewportId:n,renderingEngineId:r}=e,{viewport:i}=$m(n,r),a=i0(n);if(!a?.length)return;const o=a.filter(c=>c.type===pn.Labelmap),s=i.getActors();o.forEach(c=>{const{segmentationId:f}=c;bke(n,f)});const l=o.flatMap(c=>$v(n,c.segmentationId)).filter(c=>c!==void 0);l.length&&(l.forEach(c=>{o.find(u=>vm(n,u.segmentationId)?.includes(c.referencedId))||i.removeActors([c.uid])}),o.forEach(c=>{const{segmentationId:f}=c,u=i.getCurrentImageId(),d=vm(n,f);if(!d)return;let h=!1;const p=g=>{const m=yt.getImage(g);if(!m){console.warn("No derived image found in the cache for segmentation representation",c);return}const y=s.find(v=>v.referencedId===g);if(y){const v=y.actor.getMapper().getInputData();v.setDerivedImage?v.setDerivedImage(m):oC(v,m)}else{const{dimensions:v,spacing:x,direction:w}=i.getImageDataMetadata(m),S=yt.getImage(u)||{imageId:u},{origin:T}=i.getImageDataMetadata(S),_=T,D=m.voxelManager.getConstructor(),I=m.voxelManager.getScalarData(),R=nn.newInstance({name:"Pixels",numberOfComponents:1,values:new D(I)}),M=Zw.newInstance();M.setDimensions(v[0],v[1],1),M.setSpacing(x),M.setDirection(w),M.setOrigin(_),M.getPointData().setScalars(R),M.modified(),i.addImages([{imageId:g,representationUID:`${f}-${pn.Labelmap}-${m.imageId}`,callback:({imageActor:A})=>{A.getMapper().setInputData(M)}}]),h=!0;return}};d.forEach(p),h&&XQ(n),i.render(),t.type===vt.IMAGE_RENDERED&&i.element.removeEventListener(vt.IMAGE_RENDERED,V2)}))}const eee={enable:wke,disable:Cke};async function Ske(t){const e=t.detail.annotation;if(!CC(e))return;const n=Eke(e),r=_ke(n,e);if(!r.length){Ct(St,ee.ANNOTATION_CUT_MERGE_PROCESS_COMPLETED,{element:n.element,sourceAnnotation:e});return}const i=O7(e.data.contour.polyline,n),a=EPe(n,i,r);if(!a.length){Ct(St,ee.ANNOTATION_CUT_MERGE_PROCESS_COMPLETED,{element:n.element,sourceAnnotation:e});return}if(a.length>1){DPe(n,e,i,a);return}const{targetAnnotation:o,targetPolyline:s,isContourHole:l}=a[0];if(l){const{contourHoleProcessingEnabled:c=!1}=t.detail;if(!c)return;LQ(n,o,e)}else SPe(n,o,s,e,i)}function Tke(t,e=!1){const n="PlanarFreehandContourSegmentationTool",r=qa(t.id,t.renderingEngineId);let i;return r?r.hasTool(n)?r.getToolOptions(n)||(i=`Tool ${n} must be in active/passive state in ${r.id} toolGroup`):i=`Tool ${n} not added to ${r.id} toolGroup`:i=`ToolGroup not found for viewport ${t.id}`,i&&!e&&console.warn(i),!i}function Eke(t){const e=FQ(t);return e.find(r=>Tke(r,!0))??e[0]}function _ke(t,e){const{annotationUID:n}=e;return dC().filter(i=>i.annotationUID&&i.annotationUID!==n&&CC(i)&&nAe(i,e)&&t.isReferenceViewable(i.metadata))}function Dke(t){const e=t.detail.annotation;x0(e)}function tee(t){const e=t.detail.annotation;CC(e)&&Ske(t)}function J3(t){if(!t.detail.removed.length)return;Fl().forEach(r=>{const a=r.getViewports().map(o=>o.id);ut(a)})}function nee(t){const{viewportId:e}=t.detail;ut([e])}function Oke(t){const e=t.detail.annotation;CC(e)&&Dke(t)}const ree=function(t){yy(t.detail.element)},Mke=function(t){t.addEventListener(vt.IMAGE_RENDERED,ree)},Ike=function(t){t.removeEventListener(vt.IMAGE_RENDERED,ree)},iee={enable:Mke,disable:Ike},{Active:Rke}=vr;function Xm(t,e,n){if(Mt.isInteractingWithTool)return!1;const{renderingEngineId:r,viewportId:i}=n.detail,a=qa(i,r);if(!a)return!1;let o;const s=Object.keys(a.toolOptions);for(let l=0;l<s.length;l++){const c=s[l],f=a.toolOptions[c],u=a.getToolInstance(c);if(f.mode===Rke&&typeof u[e]=="function"){o=a.getToolInstance(c);break}}o&&o[e](n)}const aee=Xm.bind(null,"Mouse","mouseClickCallback"),oee=Xm.bind(null,"Mouse","doubleClickCallback");function see(t,e,n,r="mouse"){const i=r==="touch"?36:6,a=[];return e.forEach(({tool:o,annotations:s})=>{for(const l of s){if(l.isLocked||!l.isVisible)continue;const c=o.getHandleNearImagePoint(t,l,n,i);if(c){a.push({tool:o,annotation:l,handle:c});break}}}),a}function OC(t,e){const n=[];for(let r=0;r<e.length;r++){const i=e[r];if(!i){console.warn("undefined tool in filterToolsWithAnnotationsForElement");continue}let a=Wi(i.constructor.toolName,t);a?.length&&(typeof i.filterInteractableAnnotationsForElement=="function"&&(a=i.filterInteractableAnnotationsForElement(t,a)),a?.length>0&&n.push({tool:i,annotations:a}))}return n}function L7(t,e,n,r="mouse"){const i=r==="touch"?36:6,a=[];return e.forEach(({tool:o,annotations:s})=>{for(const l of s){if(l.isLocked||!l.isVisible)continue;if(o.isPointNearTool(t,l,n,i,r)){a.push({tool:o,annotation:l});break}}}),a}const{Active:Ake}=vr;function MC(t){const{renderingEngineId:e,viewportId:n,event:r}=t.detail,i=Km(r)||Wm.getModifierKey(),a=qa(n,e);if(!a)return null;const o=Object.keys(a.toolOptions),s=a.getDefaultMousePrimary(),l=t.detail.buttons??r?.buttons??s;for(let c=0;c<o.length;c++){const f=o[c],u=a.toolOptions[f],d=u.bindings.length&&u.bindings.some(h=>h.mouseButton===l&&h.modifierKey===i);if(u.mode===Ake&&d)return a.getToolInstance(f)}}function ym(t,e,n){const{renderingEngineId:r,viewportId:i}=t.detail,a=qa(i,r);if(!a)return[];const o=[],s=Object.keys(a.toolOptions);for(let l=0;l<s.length;l++){const c=s[l],f=a.toolOptions[c],u=n!=null&&f.bindings.length&&f.bindings.some(d=>d.mouseButton===n);if(e.includes(f.mode)&&(!n||u)){const d=a.getToolInstance(c);o.push(d)}}return o}function Pke(t,e){const n=new Map,{renderingEngineId:r,viewportId:i}=t.detail,a=qa(i,r);if(!a)return n;const o=Object.keys(a.toolOptions),s=a.getDefaultMousePrimary(),l=t.detail.event,c=l?.buttons??s,f=Km(l)||Wm.getModifierKey();for(let u=0;u<o.length;u++){const d=o[u],h=a.getToolInstance(d),p=h.configuration?.actions??{},g=Object.values(p);if(!g?.length||!e.includes(h.mode))continue;const m=g.find(y=>y.bindings?.length&&y.bindings.some(v=>v.mouseButton===c&&v.modifierKey===f));m&&n.set(h,m)}return n}const{Active:Nke,Passive:Lke}=vr;function kke(t){if(Mt.isInteractingWithTool)return!1;const e=t.detail,{element:n}=e,r=et(n),{canvas:i}=e.currentPoints;if(!r)return!1;const a=Pke(t,[Nke,Lke]),o=Array.from(a.keys()),s=OC(n,o),l=L7(n,s,i);if(l.length>0){const{tool:c,annotation:f}=l[0],u=a.get(c);return(typeof u.method=="string"?c[u.method]:u.method).call(c,t,f),!0}return!1}const{Active:Vke,Passive:Fke}=vr;function lee(t){if(Mt.isInteractingWithTool)return;const e=MC(t);if(e&&typeof e.preMouseDownCallback=="function"&&e.preMouseDownCallback(t))return;const n=t.detail.event.buttons===1,r=ym(t,[Vke],t.detail.event.buttons),i=n?ym(t,[Fke]):void 0,a=[...r||[],...i||[]];if(kke(t))return;const s=t.detail,{element:l}=s,c=OC(l,a),f=s.currentPoints.canvas,u=see(l,c,f,"mouse"),d=!!t.detail.event.shiftKey;if(u.length>0){const{tool:p,annotation:g,handle:m}=cF(u);uF(g.annotationUID,d),p.handleSelectedCallback(t,g,m,"Mouse");return}const h=L7(l,c,f,"mouse");if(h.length>0){const{tool:p,annotation:g}=cF(h);uF(g.annotationUID,d),p.toolSelectedCallback(t,g,"Mouse",f);return}e&&typeof e.postMouseDownCallback=="function"&&e.postMouseDownCallback(t)}function cF(t){if(t.length>1){const e=t.find(n=>{const r=!uo(n.annotation.annotationUID),i=fo(n.annotation.annotationUID);return r&&i});if(e)return e}return t[0]}function uF(t,e=!1){e?xC(t)?fu(t,!1):fu(t,!0,!0):fu(t,!0,!1)}function cee(t){if(Mt.isInteractingWithTool)return;const e=MC(t);if(e&&e.addNewAnnotation){const n=e.addNewAnnotation(t,"mouse");fu(n.annotationUID)}}function uee(t){if(Mt.isInteractingWithTool)return;const e=MC(t);!e||typeof e.mouseDragCallback!="function"||e.mouseDragCallback(t)}const{Active:Uke,Passive:Bke}=vr;function fee(t){if(Mt.isInteractingWithTool||Mt.isMultiPartToolActive)return;const e=ym(t,[Uke,Bke]),n=t.detail,{element:r}=n,i=OC(r,e),a=e.filter(s=>!i.some(c=>c.tool.getToolName()===s.getToolName()));let o=!1;for(const{tool:s,annotations:l}of i)typeof s.mouseMoveCallback=="function"&&(o=s.mouseMoveCallback(t,l)||o);a.forEach(s=>{typeof s.mouseMoveCallback=="function"&&s.mouseMoveCallback(t)}),o===!0&&yy(r)}const dee=Xm.bind(null,"Mouse","mouseUpCallback");function hee(t){if(Mt.isInteractingWithTool)return;t.detail.buttons=yu.Wheel|(t.detail.event.buttons||0);const e=MC(t);if(e)return e.mouseWheelCallback(t)}const $ke=function(t){t.addEventListener(ee.MOUSE_CLICK,aee),t.addEventListener(ee.MOUSE_DOWN,lee),t.addEventListener(ee.MOUSE_DOWN_ACTIVATE,cee),t.addEventListener(ee.MOUSE_DOUBLE_CLICK,oee),t.addEventListener(ee.MOUSE_DRAG,uee),t.addEventListener(ee.MOUSE_MOVE,fee),t.addEventListener(ee.MOUSE_UP,dee),t.addEventListener(ee.MOUSE_WHEEL,hee)},Gke=function(t){t.removeEventListener(ee.MOUSE_CLICK,aee),t.removeEventListener(ee.MOUSE_DOWN,lee),t.removeEventListener(ee.MOUSE_DOWN_ACTIVATE,cee),t.removeEventListener(ee.MOUSE_DOUBLE_CLICK,oee),t.removeEventListener(ee.MOUSE_DRAG,uee),t.removeEventListener(ee.MOUSE_MOVE,fee),t.removeEventListener(ee.MOUSE_UP,dee),t.removeEventListener(ee.MOUSE_WHEEL,hee)},pee={enable:$ke,disable:Gke},{Active:jke}=vr;function gee(t){const{renderingEngineId:e,viewportId:n}=t.detail,r=cRe(),i=Wm.getModifierKey(),a=qa(n,e);if(!a)return null;const o=Object.keys(a.toolOptions),s=a.getDefaultMousePrimary();for(let l=0;l<o.length;l++){const c=o[l],f=a.toolOptions[c];if(f.mode!==jke)continue;if(f.bindings.length&&f.bindings.some(d=>d.mouseButton===(r??s)&&d.modifierKey===i))return a.getToolInstance(c)}}function zke(t,e){const n=new Map,{renderingEngineId:r,viewportId:i}=t.detail,a=qa(i,r);if(!a)return n;const o=Object.keys(a.toolOptions),s=t.detail.key;for(let l=0;l<o.length;l++){const c=o[l],f=a.getToolInstance(c),u=f.configuration?.actions;if(!u)continue;const d=Object.values(u);if(!d?.length||!e.includes(f.mode))continue;const h=d.find(p=>p.bindings?.some(g=>g.key===s));h&&n.set(f,h)}return n}function mee(t){const e=gee(t);if(e){const{renderingEngineId:r,viewportId:i}=t.detail,a=qa(i,r),o=e.getToolName();Object.keys(a.toolOptions).includes(o)&&a.setViewportsCursorByToolName(o)}const n=zke(t,[vr.Active]);if(n?.size){const{element:r}=t.detail;for(const[i,a]of[...n.entries()])(typeof a.method=="function"?a.method:i[a.method]).call(i,r,a,t)}}function vee(t){const e=gee(t);if(!e)return;const{renderingEngineId:n,viewportId:r}=t.detail,i=qa(r,n);pQ();const a=e.getToolName();Object.keys(i.toolOptions).includes(a)&&i.setViewportsCursorByToolName(a)}const Wke=function(t){t.addEventListener(ee.KEY_DOWN,mee),t.addEventListener(ee.KEY_UP,vee)},Hke=function(t){t.removeEventListener(ee.KEY_DOWN,mee),t.removeEventListener(ee.KEY_UP,vee)},yee={enable:Wke,disable:Hke},{Active:Kke,Passive:qke,Enabled:Xke}=vr,xee=function(t){ym(t,[Kke,qke,Xke]).forEach(n=>{n.onCameraModified&&n.onCameraModified(t)})},Yke=function(t){t.addEventListener(vt.CAMERA_MODIFIED,xee)},Jke=function(t){t.removeEventListener(vt.CAMERA_MODIFIED,xee)},bee={enable:Yke,disable:Jke},{Active:Zke,Passive:Qke,Enabled:eVe}=vr,wee=function(t){ym(t,[Zke,Qke,eVe]).forEach(n=>{n.onImageSpacingCalibrated&&n.onImageSpacingCalibrated(t)})},tVe=function(t){t.addEventListener(vt.IMAGE_SPACING_CALIBRATED,wee)},nVe=function(t){t.removeEventListener(vt.IMAGE_SPACING_CALIBRATED,wee)},Cee={enable:tVe,disable:nVe},{Active:rVe}=vr;function k7(t){const{renderingEngineId:e,viewportId:n}=t.detail,r=t.detail.event,i=qa(n,e);if(!i)return null;const a=Object.keys(i.toolOptions),o=Object.keys(r.touches).length,s=Km(r)||Wm.getModifierKey(),l=i.getDefaultMousePrimary();for(let c=0;c<a.length;c++){const f=a[c],u=i.toolOptions[f],d=u.bindings.length&&u.bindings.some(h=>(h.numTouchPoints===o||o===1&&h.mouseButton===l)&&h.modifierKey===s);if(u.mode===rVe&&d)return i.getToolInstance(f)}}function fF(t,e,n){const{renderingEngineId:r,viewportId:i}=t.detail,a=qa(i,r);if(!a)return[];const o=[],s=Object.keys(a.toolOptions);for(let l=0;l<s.length;l++){const c=s[l],f=a.toolOptions[c],u=n!=null&&f.bindings.length&&f.bindings.some(d=>d.numTouchPoints===n);if(e.includes(f.mode)&&(!n||u)){const d=a.getToolInstance(c);o.push(d)}}return o}const{Active:iVe,Passive:aVe}=vr;function See(t){if(Mt.isInteractingWithTool)return;const e=k7(t);if(e&&typeof e.preTouchStartCallback=="function"&&e.preTouchStartCallback(t))return;const n=Object.keys(t.detail.event.touches).length===1,r=fF(t,[iVe],Object.keys(t.detail.event.touches).length),i=n?fF(t,[aVe]):void 0,a=[...r||[],...i||[],e],o=t.detail,{element:s}=o,l=OC(s,a),c=o.currentPoints.canvas,f=see(s,l,c,"touch"),u=!1;if(f.length>0){const{tool:h,annotation:p,handle:g}=dF(f);hF(p.annotationUID,u),h.handleSelectedCallback(t,p,g,"Touch");return}const d=L7(s,l,c,"touch");if(d.length>0){const{tool:h,annotation:p}=dF(d);hF(p.annotationUID,u),h.toolSelectedCallback(t,p,"Touch",c);return}e&&typeof e.postTouchStartCallback=="function"&&e.postTouchStartCallback(t)}function dF(t){return t.length>1&&t.find(e=>!uo(e.annotation.annotationUID)&&fo(e.annotation.annotationUID))||t[0]}function hF(t,e=!1){e?xC(t)?fu(t,!1):fu(t,!0,!0):fu(t,!0,!1)}function Tee(t){if(Mt.isInteractingWithTool)return;const e=k7(t);if(e&&e.addNewAnnotation){const n=e.addNewAnnotation(t,"touch");fu(n.annotationUID)}}function Eee(t){if(Mt.isInteractingWithTool)return;const e=k7(t);!e||typeof e.touchDragCallback!="function"||e.touchDragCallback(t)}const _ee=Xm.bind(null,"Touch","touchEndCallback"),oVe=Xm.bind(null,"Touch","touchTapCallback"),Dee=Xm.bind(null,"Touch","touchPressCallback"),sVe=function(t){t.addEventListener(ee.TOUCH_START,See),t.addEventListener(ee.TOUCH_START_ACTIVATE,Tee),t.addEventListener(ee.TOUCH_DRAG,Eee),t.addEventListener(ee.TOUCH_END,_ee),t.addEventListener(ee.TOUCH_TAP,oVe),t.addEventListener(ee.TOUCH_PRESS,Dee)},lVe=function(t){t.removeEventListener(ee.TOUCH_START,See),t.removeEventListener(ee.TOUCH_START_ACTIVATE,Tee),t.removeEventListener(ee.TOUCH_DRAG,Eee),t.removeEventListener(ee.TOUCH_END,_ee),t.removeEventListener(ee.TOUCH_PRESS,Dee)},Oee={enable:sVe,disable:lVe},cVe=function(){St.addEventListener(ee.ANNOTATION_COMPLETED,Mf.handleAnnotationCompleted),St.addEventListener(ee.ANNOTATION_MODIFIED,Mf.handleAnnotationUpdate),St.addEventListener(ee.ANNOTATION_REMOVED,Mf.handleAnnotationDelete)},uVe=function(){St.removeEventListener(ee.ANNOTATION_COMPLETED,Mf.handleAnnotationCompleted),St.removeEventListener(ee.ANNOTATION_MODIFIED,Mf.handleAnnotationUpdate),St.removeEventListener(ee.ANNOTATION_REMOVED,Mf.handleAnnotationDelete)},Mee={enable:cVe,disable:uVe},{Active:fVe,Passive:dVe,Enabled:hVe}=vr,Iee=function(t){ym(t,[fVe,dVe,hVe]).forEach(n=>{n.onResetCamera&&n.onResetCamera(t)})},pVe=function(t){t.addEventListener(vt.CAMERA_RESET,Iee)},gVe=function(t){t.removeEventListener(vt.CAMERA_RESET,Iee)},Ree={enable:pVe,disable:gVe};function Aee(t){const{element:e,viewportId:n}=t.detail,r=mVe(n);vVe(e),yVe(r,e),D7.addViewportElement(n,e),HZ.enable(e),dQ.enable(e),cQ.enable(e),Wm.enable(e),eee.enable(e),iee.enable(e),bee.enable(e),Cee.enable(e),Ree.enable(e),pee.enable(e),yee.enable(e),Oee.enable(e),Mt.enabledElements.push(e)}function mVe(t){const e="http://www.w3.org/2000/svg",n=document.createElementNS(e,"svg"),r=`svg-layer-${t}`;n.classList.add("svg-layer"),n.setAttribute("id",r),n.setAttribute("xmlns","http://www.w3.org/2000/svg"),n.style.width="100%",n.style.height="100%",n.style.pointerEvents="none",n.style.position="absolute";const i=document.createElementNS(e,"defs"),a=document.createElementNS(e,"filter"),o=document.createElementNS(e,"feOffset"),s=document.createElementNS(e,"feColorMatrix"),l=document.createElementNS(e,"feBlend");return a.setAttribute("id",`shadow-${r}`),a.setAttribute("filterUnits","userSpaceOnUse"),o.setAttribute("result","offOut"),o.setAttribute("in","SourceGraphic"),o.setAttribute("dx","0.5"),o.setAttribute("dy","0.5"),s.setAttribute("result","matrixOut"),s.setAttribute("in","offOut"),s.setAttribute("in2","matrix"),s.setAttribute("values","0.2 0 0 0 0 0 0.2 0 0 0 0 0 0.2 0 0 0 0 0 1 0"),l.setAttribute("in","SourceGraphic"),l.setAttribute("in2","matrixOut"),l.setAttribute("mode","normal"),a.appendChild(o),a.appendChild(s),a.appendChild(l),i.appendChild(a),n.appendChild(i),n}function vVe(t){const{viewportUid:e,renderingEngineUid:n}=t.dataset,r=`${e}:${n}`;Mt.svgNodeCache[r]={}}function yVe(t,e){e.querySelector("div.viewport-element").appendChild(t)}function xVe(t,e){const n=[];if(!e&&!t)throw new Error("At least one of renderingEngineId or viewportId should be given");for(let r=0;r<Mt.synchronizers.length;r++){const i=Mt.synchronizers[r],a=!i.isDisabled(),o=i.hasSourceViewport(e,t),s=i.hasTargetViewport(e,t);a&&(o||s)&&n.push(i)}return n}const bVe="viewport-element";function Pee(t){const{element:e,viewportId:n}=t.detail;SVe(e),TVe(e),D7.removeViewportElement(n,e),HZ.disable(e),dQ.disable(e),cQ.disable(e),Wm.disable(e),eee.disable(e),iee.disable(e),bee.disable(e),Cee.disable(e),Ree.disable(e),pee.disable(e),yee.disable(e),Oee.disable(e),wVe(e),CVe(e),EVe(e)}const wVe=t=>{const e=et(t);if(!e)return;xVe(e.viewportId,e.renderingEngineId).forEach(r=>{r.remove(e)})},CVe=t=>{const e=et(t);if(!e)return;const{renderingEngineId:n,viewportId:r}=e,i=qa(r,n);i&&i.removeViewports(n,r)};function SVe(t){const{viewportUid:e,renderingEngineUid:n}=t.dataset,r=`${e}:${n}`;delete Mt.svgNodeCache[r]}function TVe(t){const e=t.querySelector(`div.${bVe}`),n=e.querySelector("svg");n&&e.removeChild(n)}const EVe=function(t){const e=Mt.enabledElements.findIndex(n=>n===t);e>-1&&Mt.enabledElements.splice(e,1)},Z3=function(t){const{viewportId:e}=t.detail;XQ(e)};let pF=!1;function _Ve(t={}){pF||(KRe(t),DVe(),MVe(),pF=!0)}function DVe(){OVe();const t=vt.ELEMENT_ENABLED,e=vt.ELEMENT_DISABLED;St.addEventListener(t,Aee),St.addEventListener(e,Pee),Mee.enable()}function OVe(){const t=vt.ELEMENT_ENABLED,e=vt.ELEMENT_DISABLED;St.removeEventListener(t,Aee),St.removeEventListener(e,Pee),Mee.disable()}function MVe(){IVe(),St.addEventListener(ee.ANNOTATION_COMPLETED,tee),St.addEventListener(ee.ANNOTATION_MODIFIED,nee),St.addEventListener(ee.ANNOTATION_SELECTION_CHANGE,J3),St.addEventListener(ee.ANNOTATION_SELECTION_CHANGE,J3),St.addEventListener(ee.ANNOTATION_REMOVED,Oke),St.addEventListener(ee.SEGMENTATION_MODIFIED,QQ),St.addEventListener(ee.SEGMENTATION_DATA_MODIFIED,ZQ),St.addEventListener(ee.SEGMENTATION_REPRESENTATION_MODIFIED,Z3),St.addEventListener(ee.SEGMENTATION_REPRESENTATION_ADDED,Z3)}function IVe(){St.removeEventListener(ee.ANNOTATION_COMPLETED,tee),St.removeEventListener(ee.ANNOTATION_MODIFIED,nee),St.removeEventListener(ee.ANNOTATION_SELECTION_CHANGE,J3),St.removeEventListener(ee.ANNOTATION_SELECTION_CHANGE,J3),St.removeEventListener(ee.SEGMENTATION_MODIFIED,QQ),St.removeEventListener(ee.SEGMENTATION_DATA_MODIFIED,ZQ),St.removeEventListener(ee.SEGMENTATION_REPRESENTATION_MODIFIED,Z3),St.removeEventListener(ee.SEGMENTATION_REPRESENTATION_ADDED,Z3)}const{transformWorldToIndex:F8}=Hr;function RVe(t,e,n){const[r,i]=t,a=En((r[0]+i[0])/2,(r[1]+i[1])/2,(r[2]+i[2])/2),o=el(r,i)/2,{boundsIJK:s,topLeftWorld:l,bottomRightWorld:c}=PVe(e,n,t,a,o);return{boundsIJK:s,centerWorld:a,radiusWorld:o,topLeftWorld:l,bottomRightWorld:c}}function AVe(t,e,n){if(!n)throw new Error("viewport is required in order to calculate the sphere bounds");const r=n.getCamera(),i=En(r.viewUp[0],r.viewUp[1],r.viewUp[2]),a=En(r.viewPlaneNormal[0],r.viewPlaneNormal[1],r.viewPlaneNormal[2]),o=ct();dr(o,i,a);const s={row:o,normal:a,column:su(ct(),i)};return RVe(t,e,s)}function PVe(t,e,n,r,i){const a=t.getDimensions(),{row:o,column:s,normal:l}=e,c=ct(),f=ct();Or(c,r,l,i),Or(f,r,l,-i),Or(c,c,s,-i),Or(f,f,s,i),Or(c,c,o,-i),Or(f,f,o,i);const u=F8(t,c),d=F8(t,f),h=n.map(g=>F8(t,g));return{boundsIJK:g7([u,d,...h],a),topLeftWorld:c,bottomRightWorld:f}}let gF=!1;function NVe(){if(gF)return;gF=!0;const t=()=>new Worker(new URL("/assets/computeWorker-DVcDvZFV.js",import.meta.url),{name:"compute",type:"module"}),e=Rm(),i={maxWorkerInstances:1,autoTerminateOnIdle:HRe().computeWorker?.autoTerminateOnIdle??{enabled:!0,idleTimeThreshold:2e3}};e.registerWorker("compute",t,i)}function LVe(t){const e=yt.getVolume(t);if(!e)return null;const n=e.referencedVolumeId;let r;if(n)r=yt.getVolume(n);else{const i=e.imageIds,o=yt.getImage(i[0]).referencedImageId;r=yt.getVolumeContainingImageId(o)?.volume}return r}function kVe({operationData:t}){const{volumeId:e}=t;if(!e){const l=new CustomEvent(vt.ERROR_EVENT,{detail:{type:"Segmentation",message:"No volume id found for the segmentation"},cancelable:!0});return St.dispatchEvent(l),null}const n=yt.getVolume(e),r=LVe(e);if(!n||!r)return null;const{imageData:i}=n,{voxelManager:a}=n,{voxelManager:o,imageData:s}=r;return{segmentationImageData:i,segmentationVoxelManager:a,segmentationScalarData:null,imageScalarData:null,imageVoxelManager:o,imageData:s}}function VVe({operationData:t,viewport:e,strategy:n}){const{segmentationId:r}=t;let i,a,o,s,l,c;if(n.ensureSegmentationVolumeFor3DManipulation)n.ensureSegmentationVolumeFor3DManipulation({operationData:t,viewport:e}),a=t.segmentationVoxelManager,i=t.segmentationImageData,o=null;else{const f=SC(e.id,r);if(!f)return null;const u=vQ(e.id,r);if(!u)return null;const d=yt.getImage(f);i=u.actor.getMapper().getInputData(),a=d.voxelManager;const h=t.imageId,p=yt.getImage(h);if(!p)return null;o=p.getPixelData?.()}if(n.ensureImageVolumeFor3DManipulation)n.ensureImageVolumeFor3DManipulation({operationData:t,viewport:e}),l=t.imageVoxelManager,s=t.imageScalarData,c=t.imageData;else{const f=e.getCurrentImageId();if(!f)return null;const u=yt.getImage(f);c=u?null:e.getImageData(),s=u?.getPixelData()||c.getScalarData(),l=u?.voxelManager}return{segmentationImageData:i,segmentationScalarData:o,imageScalarData:s,segmentationVoxelManager:a,imageVoxelManager:l,imageData:c}}function V7({operationData:t,viewport:e,strategy:n}){return t?"volumeId"in t&&t.volumeId!=null||"referencedVolumeId"in t&&t.referencedVolumeId!=null?kVe({operationData:t}):VVe({operationData:t,viewport:e,strategy:n}):null}function FVe(t){const{representationData:e}=Ki(t);let{volumeId:n}=e.Labelmap,r;if(n&&(r=yt.getVolume(n),r))return r;const{imageIds:i}=e.Labelmap;if(n=yt.generateVolumeId(i),!(!i||i.length===1||!Gm(i)))return r=rC(n,i),r}const Nee={[jt.EnsureSegmentationVolumeFor3DManipulation]:t=>{const{operationData:e,viewport:n}=t,{segmentationId:r,imageIds:i}=e,a=n?n.getImageIds():i.map(l=>yt.getImage(l).referencedImageId);if(!Gm(a))throw new Error("Volume is not reconstructable for sphere manipulation");const s=FVe(r);s&&(e.segmentationVoxelManager=s.voxelManager,e.segmentationImageData=s.imageData)}};function UVe(t){if(!t||t.length<=1||!Gm(t))return;const n=yt.generateVolumeId(t);let r=yt.getVolume(n);return r||(r=rC(n,t),r)}const Lee={[jt.EnsureImageVolumeFor3DManipulation]:t=>{const{operationData:e,viewport:n}=t;let r;if(n){if(r=n.getImageIds(),!Gm(r))throw new Error("Volume is not reconstructable for sphere manipulation")}else r=Ki(e.segmentationId).representationData.Labelmap.imageIds.map(s=>yt.getImage(s).referencedImageId);const i=UVe(r);if(!i)throw new Error("Failed to create or get image volume");e.imageVoxelManager=i.voxelManager,e.imageData=i.imageData}},Q3=(t,e)=>{Ct(St,vt.WEB_WORKER_PROGRESS,{progress:e,type:t})},BVe=(t,e)=>{const n=Ki(t),{representationData:r}=n,{Labelmap:i}=r;if(!i)return console.debug("No labelmap found for segmentation",t),null;const a=i.volumeId,o=i.imageIds,s={segmentationId:t,volumeId:a,imageIds:o};let l=!1;if(o){const f=o.map(u=>yt.getImage(u).referencedImageId);l=Gm(f)}let c=e;return c?Array.isArray(c)||(c=[c,255]):c=[bu(t)],{operationData:s,segVolumeId:a,segImageIds:o,reconstructableVolume:l,indices:c}},$Ve=t=>V7({operationData:t,strategy:{ensureSegmentationVolumeFor3DManipulation:Nee.ensureSegmentationVolumeFor3DManipulation,ensureImageVolumeFor3DManipulation:Lee.ensureImageVolumeFor3DManipulation}}),GVe=t=>{const e=[],n=[];for(const r of t){const i=yt.getImage(r),a=i.getPixelData(),{origin:o,direction:s,spacing:l,dimensions:c}=$D(i);e.push({scalarData:a,dimensions:c,spacing:l,origin:o,direction:s});const f=i.referencedImageId;if(f){const u=yt.getImage(f);if(!u)continue;const d=u.getPixelData(),h=u.voxelManager,p=[u.rowPixelSpacing,u.columnPixelSpacing];n.push({scalarData:d,dimensions:h?h.dimensions:[u.columns,u.rows,1],spacing:p})}}return{segmentationInfo:e,imageInfo:n}},jVe=(t,e)=>{let n;if(t){const s=yt.getVolume(t).imageIds,l=yt.getImage(s[0]);l&&(n=l.referencedImageId)}else e?.length&&(n=yt.getImage(e[0]).referencedImageId);const r=yt.getImage(n),i=Ft("scalingModule",n),a={isPreScaled:!!r?.preScale?.scaled,isSuvScaled:typeof i?.suvbw=="number"};return{refImageId:n,modalityUnitOptions:a}},{isEqual:zVe}=Hr;function mF(t,e){const{polyline:n}=t.data.contour,{points:r}=t.data.handles,{length:i}=r;if(e===i)return n.length;if(e<0&&(e=(e+i)%i),e===0)return 0;const a=r[e],o=n.findIndex(l=>zVe(a,l));if(o!==-1)return o;let s=1/0;return n.reduce((l,c,f)=>{const u=iK(c,a);return u<s?(s=u,f):l},-1)}const{transformWorldToIndex:vF}=Hr,Mg=class Mg extends na{constructor(e={},n={supportedInteractionTypes:["Mouse","Touch"],configuration:{storePointData:!1,shadow:!0,preventHandleOutsideImage:!1,calculateStats:!0,getTextLines:WVe,statsCalculator:w0}}){super(e,n),this.addNewAnnotation=r=>{const i=r.detail,{currentPoints:a,element:o}=i,s=a.world,l=et(o),{viewport:c}=l;this.isDrawing=!0;const f=this.constructor.createAnnotationForViewport(c,{data:{handles:{points:[[...s],[...s],[...s],[...s]],textBox:{hasMoved:!1,worldPosition:[0,0,0],worldBoundingBox:{topLeft:[0,0,0],topRight:[0,0,0],bottomLeft:[0,0,0],bottomRight:[0,0,0]}}},cachedStats:{}}});hr(f,o);const u=fn(o,this.getToolName());return this.editData={annotation:f,viewportIdsToRender:u,handleIndex:3,movingTextBox:!1,newAnnotation:!0,hasMoved:!1},this._activateDraw(o),Rn(o),r.preventDefault(),ut(u),f},this.isPointNearTool=(r,i,a,o)=>{const s=et(r),{viewport:l}=s,{data:c}=i,{points:f}=c.handles,u=l.worldToCanvas(f[0]),d=l.worldToCanvas(f[3]),h=this._getRectangleImageCoordinates([u,d]),p=[a[0],a[1]],{left:g,top:m,width:y,height:v}=h;return HAe([g,m,y,v],p)<=o},this.toolSelectedCallback=(r,i)=>{const a=r.detail,{element:o}=a;i.highlighted=!0;const s=fn(o,this.getToolName());this.editData={annotation:i,viewportIdsToRender:s,movingTextBox:!1},this._activateModify(o),Rn(o);const l=et(o),{renderingEngine:c}=l;ut(s),r.preventDefault()},this.handleSelectedCallback=(r,i,a)=>{const o=r.detail,{element:s}=o,{data:l}=i;i.highlighted=!0;let c=!1,f;a.worldPosition?c=!0:f=l.handles.points.findIndex(p=>p===a);const u=fn(s,this.getToolName());this.editData={annotation:i,viewportIdsToRender:u,handleIndex:f,movingTextBox:c},this._activateModify(s),Rn(s);const d=et(s),{renderingEngine:h}=d;ut(u),r.preventDefault()},this._endCallback=r=>{const i=r.detail,{element:a}=i,{annotation:o,viewportIdsToRender:s,newAnnotation:l,hasMoved:c}=this.editData,{data:f}=o;l&&!c||(f.handles.activeHandleIndex=null,this._deactivateModify(a),this._deactivateDraw(a),Kn(a),this.doneEditMemo(),this.editData=null,this.isDrawing=!1,this.isHandleOutsideImage&&this.configuration.preventHandleOutsideImage&&Cr(o.annotationUID),ut(s),l&&Wr(o))},this._dragCallback=r=>{this.isDrawing=!0;const i=r.detail,{element:a}=i,{annotation:o,viewportIdsToRender:s,handleIndex:l,movingTextBox:c,newAnnotation:f}=this.editData;this.createMemo(a,o,{newAnnotation:f});const{data:u}=o;if(c){const{deltaPoints:d}=i,h=d.world,{textBox:p}=u.handles,{worldPosition:g}=p;g[0]+=h[0],g[1]+=h[1],g[2]+=h[2],p.hasMoved=!0}else if(l===void 0){const{deltaPoints:d}=i,h=d.world,{points:p}=u.handles;p.forEach(g=>{g[0]+=h[0],g[1]+=h[1],g[2]+=h[2]}),o.invalidated=!0}else{const{currentPoints:d}=i,h=et(a),{worldToCanvas:p,canvasToWorld:g}=h.viewport,m=d.world,{points:y}=u.handles;y[l]=[...m];let v,x,w,S,T,_,D,I;switch(l){case 0:case 3:v=p(y[0]),S=p(y[3]),x=[S[0],v[1]],w=[v[0],S[1]],_=g(x),D=g(w),y[1]=_,y[2]=D;break;case 1:case 2:x=p(y[1]),w=p(y[2]),v=[w[0],x[1]],S=[x[0],w[1]],T=g(v),I=g(S),y[0]=T,y[3]=I;break}o.invalidated=!0}this.editData.hasMoved=!0,et(a),ut(s),o.invalidated&&Fn(o,a,wn.HandlesUpdated)},this.cancel=r=>{if(this.isDrawing){this.isDrawing=!1,this._deactivateDraw(r),this._deactivateModify(r),Kn(r);const{annotation:i,viewportIdsToRender:a,newAnnotation:o}=this.editData,{data:s}=i;return i.highlighted=!1,s.handles.activeHandleIndex=null,ut(a),o&&Wr(i),this.editData=null,i.annotationUID}},this._activateDraw=r=>{Mt.isInteractingWithTool=!0,r.addEventListener(ee.MOUSE_UP,this._endCallback),r.addEventListener(ee.MOUSE_DRAG,this._dragCallback),r.addEventListener(ee.MOUSE_MOVE,this._dragCallback),r.addEventListener(ee.MOUSE_CLICK,this._endCallback),r.addEventListener(ee.TOUCH_END,this._endCallback),r.addEventListener(ee.TOUCH_DRAG,this._dragCallback),r.addEventListener(ee.TOUCH_TAP,this._endCallback)},this._deactivateDraw=r=>{Mt.isInteractingWithTool=!1,r.removeEventListener(ee.MOUSE_UP,this._endCallback),r.removeEventListener(ee.MOUSE_DRAG,this._dragCallback),r.removeEventListener(ee.MOUSE_MOVE,this._dragCallback),r.removeEventListener(ee.MOUSE_CLICK,this._endCallback),r.removeEventListener(ee.TOUCH_END,this._endCallback),r.removeEventListener(ee.TOUCH_DRAG,this._dragCallback),r.removeEventListener(ee.TOUCH_TAP,this._endCallback)},this._activateModify=r=>{Mt.isInteractingWithTool=!0,r.addEventListener(ee.MOUSE_UP,this._endCallback),r.addEventListener(ee.MOUSE_DRAG,this._dragCallback),r.addEventListener(ee.MOUSE_CLICK,this._endCallback),r.addEventListener(ee.TOUCH_END,this._endCallback),r.addEventListener(ee.TOUCH_DRAG,this._dragCallback),r.addEventListener(ee.TOUCH_TAP,this._endCallback)},this._deactivateModify=r=>{Mt.isInteractingWithTool=!1,r.removeEventListener(ee.MOUSE_UP,this._endCallback),r.removeEventListener(ee.MOUSE_DRAG,this._dragCallback),r.removeEventListener(ee.MOUSE_CLICK,this._endCallback),r.removeEventListener(ee.TOUCH_END,this._endCallback),r.removeEventListener(ee.TOUCH_DRAG,this._dragCallback),r.removeEventListener(ee.TOUCH_TAP,this._endCallback)},this.renderAnnotation=(r,i)=>{let a=!1;const{viewport:o}=r,{element:s}=o;let l=Wi(this.getToolName(),s);if(!l?.length||(l=this.filterInteractableAnnotationsForElement(s,l),!l?.length))return a;const c=this.getTargetId(o),f=o.getRenderingEngine(),u={toolGroupId:this.toolGroupId,toolName:this.getToolName(),viewportId:r.viewport.id};for(let d=0;d<l.length;d++){const h=l[d],{annotationUID:p,data:g}=h,{points:m,activeHandleIndex:y}=g.handles,v=m.map(V=>o.worldToCanvas(V));u.annotationUID=p;const{color:x,lineWidth:w,lineDash:S}=this.getAnnotationStyle({annotation:h,styleSpecifier:u}),{viewPlaneNormal:T,viewUp:_}=o.getCamera();if(!g.cachedStats[c]||g.cachedStats[c].areaUnit==null)g.cachedStats[c]={Modality:null,area:null,max:null,mean:null,stdDev:null,areaUnit:null},this._calculateCachedStats(h,T,_,f,r);else if(h.invalidated&&(this._throttledCalculateCachedStats(h,T,_,f,r),o instanceof oa)){const{referencedImageId:V}=h.metadata;for(const X in g.cachedStats)X.startsWith("imageId")&&f.getStackViewports().find(ye=>{const me=mi(V),Ce=ye.hasImageURI(me),we=mi(ye.getCurrentImageId());return Ce&&we!==me})&&delete g.cachedStats[X]}if(!o.getRenderingEngine())return console.warn("Rendering Engine has been destroyed"),a;let D;if(!fo(p))continue;!uo(p)&&!this.editData&&y!==null&&y!==void 0&&(D=[v[y]]),D&&ho(i,p,"0",D,{color:x});const I=`${p}-rect`;NQ(i,p,"0",v,{color:x,lineDash:S,lineWidth:w},I),a=!0;const M=this.getLinkedTextBoxStyle(u,h);if(!M.visibility){g.handles.textBox={hasMoved:!1,worldPosition:[0,0,0],worldBoundingBox:{topLeft:[0,0,0],topRight:[0,0,0],bottomLeft:[0,0,0],bottomRight:[0,0,0]}};continue}const A=this.configuration.getTextLines(g,c);if(!A||A.length===0)continue;if(!g.handles.textBox.hasMoved){const V=Du(v);g.handles.textBox.worldPosition=o.canvasToWorld(V)}const L=o.worldToCanvas(g.handles.textBox.worldPosition),B=rl(i,p,"1",A,L,v,{},M),{x:U,y:G,width:F,height:$}=B;g.handles.textBox.worldBoundingBox={topLeft:o.canvasToWorld([U,G]),topRight:o.canvasToWorld([U+F,G]),bottomLeft:o.canvasToWorld([U,G+$]),bottomRight:o.canvasToWorld([U+F,G+$])}}return a},this._getRectangleImageCoordinates=r=>{const[i,a]=r;return{left:Math.min(i[0],a[0]),top:Math.min(i[1],a[1]),width:Math.abs(i[0]-a[0]),height:Math.abs(i[1]-a[1])}},this._calculateCachedStats=(r,i,a,o,s)=>{if(!this.configuration.calculateStats)return;const{data:l}=r,{viewport:c}=s,{element:f}=c,u=l.handles.points[0],d=l.handles.points[3],{cachedStats:h}=l,p=Object.keys(h);for(let m=0;m<p.length;m++){const y=p[m],v=this.getTargetImageData(y);if(!v)continue;const{dimensions:x,imageData:w,metadata:S,voxelManager:T}=v,_=vF(w,u);_[0]=Math.floor(_[0]),_[1]=Math.floor(_[1]),_[2]=Math.floor(_[2]);const D=vF(w,d);if(D[0]=Math.floor(D[0]),D[1]=Math.floor(D[1]),D[2]=Math.floor(D[2]),this._isInsideVolume(_,D,x)){this.isHandleOutsideImage=!1;const I=Math.min(_[0],D[0]),R=Math.max(_[0],D[0]),M=Math.min(_[1],D[1]),A=Math.max(_[1],D[1]),L=Math.min(_[2],D[2]),P=Math.max(_[2],D[2]),B=[[I,R],[M,A],[L,P]],{worldWidth:U,worldHeight:G}=$Q(i,a,u,d),F=[_,D],{scale:$,areaUnit:V}=vc(v,F),X=Math.abs(U*G)/($*$),Q={isPreScaled:qm(c,y),isSuvScaled:this.isSuvScaled(c,y,r.metadata.referencedImageId)},re=mp(S.Modality,r.metadata.referencedImageId,Q);let ye;T&&(ye=T.forEach(this.configuration.statsCalculator.statsCallback,{boundsIJK:B,imageData:w,returnPoints:this.configuration.storePointData}));const me=this.configuration.statsCalculator.getStatistics();h[y]={Modality:S.Modality,area:X,mean:me.mean?.value,stdDev:me.stdDev?.value,max:me.max?.value,min:me.min?.value,statsArray:me.array,pointsInShape:ye,areaUnit:V,modalityUnit:re}}else this.isHandleOutsideImage=!0,h[y]={Modality:S.Modality}}const g=r.invalidated;return r.invalidated=!1,g&&Fn(r,f,wn.StatsUpdated),h},this._isInsideVolume=(r,i,a)=>xa(r,a)&&xa(i,a),this._throttledCalculateCachedStats=Bl(this._calculateCachedStats,100,{trailing:!0})}};Mg.toolName="RectangleROI",Mg.hydrate=(e,n,r)=>{const i=mr(e);if(!i)return;const{FrameOfReferenceUID:a,referencedImageId:o,viewPlaneNormal:s,instance:l,viewport:c}=Mg.hydrateBase(Mg,i,n,r),{toolInstance:f,...u}=r||{},d={annotationUID:r?.annotationUID||or(),data:{handles:{points:n,activeHandleIndex:null},label:"",cachedStats:{}},highlighted:!1,autoGenerated:!1,invalidated:!1,isLocked:!1,isVisible:!0,metadata:{toolName:l.getToolName(),viewPlaneNormal:s,FrameOfReferenceUID:a,referencedImageId:o,...u}};hr(d,c.element),ut([c.id])};let qc=Mg;function WVe(t,e){const n=t.cachedStats[e],{area:r,mean:i,max:a,stdDev:o,areaUnit:s,modalityUnit:l,min:c}=n;if(i==null)return;const f=[];return li(r)&&f.push(`Area: ${kn(r)} ${s}`),li(i)&&f.push(`Mean: ${kn(i)} ${l}`),li(a)&&f.push(`Max: ${kn(a)} ${l}`),li(c)&&f.push(`Max: ${kn(c)} ${l}`),li(o)&&f.push(`Std Dev: ${kn(o)} ${l}`),f}const{transformWorldToIndex:ov}=Hr;class ah extends qc{constructor(e={},n={configuration:{storePointData:!1,numSlicesToPropagate:10,calculatePointsInsideVolume:!0,getTextLines:HVe,statsCalculator:w0,showTextBox:!1,throttleTimeout:100}}){super(e,n),this.addNewAnnotation=r=>{const i=r.detail,{currentPoints:a,element:o}=i,s=a.world,l=et(o),{viewport:c,renderingEngine:f}=l;this.isDrawing=!0;const u=c.getCamera(),{viewPlaneNormal:d,viewUp:h}=u;let p,g,m;if(c instanceof aa)throw new Error("Stack Viewport Not implemented");{const _=this.getTargetId(c);m=_0(_),g=yt.getVolume(m),p=ep(g,s,d)}const y=fp(g,d),v=this._getStartCoordinate(s,d),x=this._getEndCoordinate(s,y,d),w=c.getFrameOfReferenceUID(),S={highlighted:!0,invalidated:!0,metadata:{viewPlaneNormal:[...d],enabledElement:l,viewUp:[...h],FrameOfReferenceUID:w,referencedImageId:p,toolName:this.getToolName(),volumeId:m,spacingInNormal:y},data:{label:"",startCoordinate:v,endCoordinate:x,cachedStats:{pointsInVolume:[],projectionPoints:[],projectionPointsImageIds:[p],statistics:[]},handles:{textBox:{hasMoved:!1,worldPosition:[0,0,0],worldBoundingBox:{topLeft:[0,0,0],topRight:[0,0,0],bottomLeft:[0,0,0],bottomRight:[0,0,0]}},points:[[...s],[...s],[...s],[...s]],activeHandleIndex:null},labelmapUID:null}};this._computeProjectionPoints(S,g),hr(S,o);const T=fn(o,this.getToolName());return this.editData={annotation:S,viewportIdsToRender:T,handleIndex:3,newAnnotation:!0,hasMoved:!1},this._activateDraw(o),Rn(o),r.preventDefault(),ut(T),S},this._endCallback=r=>{const i=r.detail,{element:a}=i,{annotation:o,viewportIdsToRender:s,newAnnotation:l,hasMoved:c}=this.editData,{data:f}=o;if(l&&!c)return;f.handles.activeHandleIndex=null,this._deactivateModify(a),this._deactivateDraw(a),Kn(a);const u=et(a);this.editData=null,this.isDrawing=!1,this.isHandleOutsideImage&&this.configuration.preventHandleOutsideImage&&Cr(o.annotationUID);const d=this.getTargetId(u.viewport),h=yt.getVolume(d.split(/volumeId:|\?/)[1]);this._computePointsInsideVolume(o,d,h,u),ut(s),l?Wr(o):Fn(o,a)},this.renderAnnotation=(r,i)=>{let a=!1;const{viewport:o}=r;let s=Wi(this.getToolName(),o.element);if(!s?.length)return a;s=vNe(s,o.getCamera());const l={toolGroupId:this.toolGroupId,toolName:this.getToolName(),viewportId:r.viewport.id};for(let c=0;c<s.length;c++){const f=s[c],{annotationUID:u,data:d,metadata:h}=f,{startCoordinate:p,endCoordinate:g}=d,{points:m,activeHandleIndex:y}=d.handles,v=m.map(F=>o.worldToCanvas(F));l.annotationUID=u;const x=this.getStyle("lineWidth",l,f),w=this.getStyle("lineDash",l,f),S=this.getStyle("color",l,f),T=o.getCamera().focalPoint,_=o.getCamera().viewPlaneNormal;let D=p,I=g;if(Array.isArray(p)){D=this._getCoordinateForViewplaneNormal(D,_);const F=this._getIndexOfCoordinatesForViewplaneNormal(_);d.handles.points.forEach($=>{$[F]=D}),d.startCoordinate=D}Array.isArray(g)&&(I=this._getCoordinateForViewplaneNormal(I,_),d.endCoordinate=I,d.endCoordinate=I);const R=Cb(D),M=Cb(I),A=this._getCoordinateForViewplaneNormal(T,_),L=Cb(A);if(L<Math.min(R,M)||L>Math.max(R,M))continue;f.invalidated&&this._throttledCalculateCachedStats(f,r);let P=!1;if((L===R||L===M)&&(P=!0),!o.getRenderingEngine())return console.warn("Rendering Engine has been destroyed"),a;let B;if(!fo(u))continue;!uo(u)&&!this.editData&&y!==null&&P&&(B=[v[y]]),B&&ho(i,u,"0",B,{color:S});let U=w;if(P||(U=2),_7(i,u,"0",v[0],v[3],{color:S,lineDash:U,lineWidth:x}),a=!0,this.configuration.showTextBox){const F=this.getLinkedTextBoxStyle(l,f);if(!F.visibility){d.handles.textBox={hasMoved:!1,worldPosition:[0,0,0],worldBoundingBox:{topLeft:[0,0,0],topRight:[0,0,0],bottomLeft:[0,0,0],bottomRight:[0,0,0]}};continue}const $=this.configuration.getTextLines(d,{metadata:h});if(!$||$.length===0)continue;if(!d.handles.textBox.hasMoved){const we=Du(v);d.handles.textBox.worldPosition=o.canvasToWorld(we)}const V=o.worldToCanvas(d.handles.textBox.worldPosition),Q=rl(i,u,"1",$,V,v,{},F),{x:re,y:ye,width:me,height:Ce}=Q;d.handles.textBox.worldBoundingBox={topLeft:o.canvasToWorld([re,ye]),topRight:o.canvasToWorld([re+me,ye]),bottomLeft:o.canvasToWorld([re,ye+Ce]),bottomRight:o.canvasToWorld([re+me,ye+Ce])}}}return a},this.configuration.calculatePointsInsideVolume?this._throttledCalculateCachedStats=Bl(this._calculateCachedStatsTool,this.configuration.throttleTimeout,{trailing:!0}):this._throttledCalculateCachedStats=yC(this._calculateCachedStatsTool,this.configuration.throttleTimeout)}_computeProjectionPoints(e,n){const{data:r,metadata:i}=e,{viewPlaneNormal:a,spacingInNormal:o}=i,{imageData:s}=n,{startCoordinate:l,endCoordinate:c}=r,{points:f}=r.handles,u=ov(s,f[0]),d=ov(s,f[0]),h=ct();s.indexToWorldVec3(u,h);const p=ct();s.indexToWorldVec3(d,p);const g=this._getIndexOfCoordinatesForViewplaneNormal(a);g==2?(h[2]=l,p[2]=c):g==0?(h[0]=l,p[0]=c):g==1&&(h[1]=l,p[1]=c);const m=ct();Dr(m,p,h);const y=Ao(m);Ir(m,m);const v=[];for(let x=0;x<y;x+=o)v.push(f.map(w=>{const S=ct();return Or(S,w,m,x),Array.from(S)}));r.cachedStats.projectionPoints=v}_computePointsInsideVolume(e,n,r,i){const{data:a,metadata:o}=e,{viewPlaneNormal:s,viewUp:l}=o,{viewport:c}=i,f=a.cachedStats.projectionPoints,u=[[]],d=this.getTargetImageData(n),h=a.handles.points[0],p=a.handles.points[3],{worldWidth:g,worldHeight:m}=$Q(s,l,h,p),y=vc(d,a.habdles),v=Math.abs(g*m)/(y.scale*y.scale),x={isPreScaled:qm(c,n),isSuvScaled:this.isSuvScaled(c,n,e.metadata.referencedImageId)},w=mp(o.Modality,e.metadata.referencedImageId,x);for(let T=0;T<f.length;T++){if(!r)continue;const _=f[T][0],{dimensions:D,imageData:I,voxelManager:R}=r,M=ov(I,h),A=ov(I,_),L=this._getIndexOfCoordinatesForViewplaneNormal(s);M[0]=Math.floor(M[0]),M[1]=Math.floor(M[1]),M[2]=Math.floor(M[2]),M[L]=A[L];const P=ov(I,p);if(P[0]=Math.floor(P[0]),P[1]=Math.floor(P[1]),P[2]=Math.floor(P[2]),P[L]=A[L],this._isInsideVolume(M,P,D)){this.isHandleOutsideImage=!1;const B=Math.min(M[0],P[0]),U=Math.max(M[0],P[0]),G=Math.min(M[1],P[1]),F=Math.max(M[1],P[1]),$=Math.min(M[2],P[2]),V=Math.max(M[2],P[2]),X=[[B,U],[G,F],[$,V]],Q=R.forEach(this.configuration.statsCalculator.statsCallback,{boundsIJK:X,imageData:I,returnPoints:this.configuration.storePointData});u.push(Q)}}const S=this.configuration.statsCalculator.getStatistics();a.cachedStats.pointsInVolume=u,a.cachedStats.statistics={Modality:o.Modality,area:v,mean:S.mean?.value,stdDev:S.stdDev?.value,max:S.max?.value,statsArray:S.array,areaUnit:y.areaUnit,modalityUnit:w}}_calculateCachedStatsTool(e,n){const r=e.data,{viewport:i}=n,{cachedStats:a}=r,o=this.getTargetId(i),s=yt.getVolume(o.split(/volumeId:|\?/)[1]);return this._computeProjectionPoints(e,s),this._computePointsInsideVolume(e,o,s,n),e.invalidated=!1,Fn(e,i.element),a}_getStartCoordinate(e,n){const r=e;return this._getCoordinateForViewplaneNormal(r,n)}_getEndCoordinate(e,n,r){const i=this.configuration.numSlicesToPropagate,a=ct();return Or(a,e,r,i*n),this._getCoordinateForViewplaneNormal(a,r)}_getIndexOfCoordinatesForViewplaneNormal(e){const n=[Math.abs(e[0]),Math.abs(e[1]),Math.abs(e[2])];return n.indexOf(Math.max(...n))}_getCoordinateForViewplaneNormal(e,n){const r=this._getIndexOfCoordinatesForViewplaneNormal(n);return e[r]}}function HVe(t,e={}){const n=t.cachedStats.statistics,{area:r,mean:i,max:a,stdDev:o,areaUnit:s,modalityUnit:l}=n;if(i===void 0)return;const c=[];return c.push(`Area: ${kn(r)} ${s}`),c.push(`Mean: ${kn(i)} ${l}`),c.push(`Max: ${kn(a)} ${l}`),c.push(`Std Dev: ${kn(o)} ${l}`),c}ah.toolName="RectangleROIStartEndThreshold";class oh extends qc{constructor(e={},n={supportedInteractionTypes:["Mouse","Touch"],configuration:{shadow:!0,preventHandleOutsideImage:!1}}){super(e,n),this.addNewAnnotation=r=>{const i=r.detail,{currentPoints:a,element:o}=i,s=a.world,l=et(o),{viewport:c,renderingEngine:f}=l;this.isDrawing=!0;const u=c.getCamera(),{viewPlaneNormal:d,viewUp:h}=u,p=this.getTargetId(c);let g,m;if(c instanceof aa)g=p.split("imageId:")[1];else{m=_0(p);const w=yt.getVolume(m);g=ep(w,s,d)}const y=c.getFrameOfReferenceUID(),v={highlighted:!0,invalidated:!0,metadata:{viewPlaneNormal:[...d],enabledElement:l,viewUp:[...h],FrameOfReferenceUID:y,referencedImageId:g,toolName:this.getToolName(),volumeId:m},data:{label:"",handles:{textBox:{hasMoved:!1,worldPosition:null,worldBoundingBox:null},points:[[...s],[...s],[...s],[...s]],activeHandleIndex:null},segmentationId:null}};hr(v,o);const x=fn(o,this.getToolName());return this.editData={annotation:v,viewportIdsToRender:x,handleIndex:3,newAnnotation:!0,hasMoved:!1},this._activateDraw(o),Rn(o),r.preventDefault(),ut(x),v},this.renderAnnotation=(r,i)=>{let a=!1;const{viewport:o}=r,{element:s}=o;let l=Wi(this.getToolName(),s);if(!l?.length||(l=this.filterInteractableAnnotationsForElement(s,l),!l?.length))return a;const c={toolGroupId:this.toolGroupId,toolName:this.getToolName(),viewportId:r.viewport.id};for(let f=0;f<l.length;f++){const u=l[f],{annotationUID:d,data:h}=u,{points:p,activeHandleIndex:g}=h.handles,m=p.map(T=>o.worldToCanvas(T));c.annotationUID=d;const y=this.getStyle("lineWidth",c,u),v=this.getStyle("lineDash",c,u),x=this.getStyle("color",c,u);if(!o.getRenderingEngine())return console.warn("Rendering Engine has been destroyed"),a;Fn(u,s);let w;if(!fo(d))continue;!uo(d)&&!this.editData&&g!==null&&(w=[m[g]]),w&&ho(i,d,"0",w,{color:x}),_7(i,d,"0",m[0],m[3],{color:x,lineDash:v,lineWidth:y}),a=!0}return a}}}oh.toolName="RectangleROIThreshold";const KVe={[jt.OnInteractionStart]:t=>{const{segmentIndex:e,previewSegmentIndex:n,segmentationVoxelManager:r,centerIJK:i,viewPlaneNormal:a,segmentationImageData:o,configuration:s}=t;if(!s?.useCenterSegmentIndex)return;let l=!1,c=!1;const f=[...r.getBoundsIJK()];Math.abs(a[0])>.8?f[0]=[i[0],i[0]]:Math.abs(a[1])>.8?f[1]=[i[1],i[1]]:Math.abs(a[2])>.8&&(f[2]=[i[2],i[2]]);const u=({value:h})=>{l||=h===e,c||=h===n};if(r.forEach(u,{imageData:o,isInObject:t.isInObject,boundsIJK:f}),!l&&!c){t.centerSegmentIndexInfo.segmentIndex=null;return}const d=r.getAtIJKPoint(i);t.centerSegmentIndexInfo.segmentIndex=d,t.centerSegmentIndexInfo.hasSegmentIndex=l,t.centerSegmentIndexInfo.hasPreviewIndex=c}},qVe={[jt.Initialize]:t=>{const{operationName:e,centerIJK:n,segmentationVoxelManager:r,imageVoxelManager:i,configuration:a,segmentIndex:o,viewport:s}=t;if(!a?.threshold?.isDynamic||!n||!o||e===jt.RejectPreview||e===jt.OnInteractionEnd)return;const l=r.getBoundsIJK(),{range:c,dynamicRadius:f=0}=a.threshold,u=c?0:f,{viewPlaneNormal:d}=s.getCamera(),h=l.map((y,v)=>{const[x,w]=y;return[Math.max(x,n[v]-u),Math.min(w,n[v]+u)]});Math.abs(d[0])>.8?h[0]=[n[0],n[0]]:Math.abs(d[1])>.8?h[1]=[n[1],n[1]]:Math.abs(d[2])>.8&&(h[2]=[n[2],n[2]]);const p=c||[1/0,-1/0],g=u*u,m=({value:y,pointIJK:v})=>{if(oye(n,v)>g)return;const w=Array.isArray(y)?g6(y):y;p[0]=Math.min(w,p[0]),p[1]=Math.max(w,p[1])};i.forEach(m,{boundsIJK:h}),a.threshold.range=p},[jt.OnInteractionStart]:t=>{const{configuration:e}=t;e?.threshold?.isDynamic&&(e.threshold.range=null)},[jt.ComputeInnerCircleRadius]:t=>{const{configuration:e,viewport:n}=t,{dynamicRadius:r=0,isDynamic:i}=e.threshold;if(!i){e.threshold.dynamicRadiusInCanvas=0;return}if(r===0)return;const a=n.getImageData();if(!a)return;const{spacing:o}=a,s=[n.element.clientWidth/2,n.element.clientHeight/2],l=r*o[0],f=n.canvasToWorld(s).map(h=>h+l),u=n.worldToCanvas(f),d=Math.abs(s[0]-u[0]);e.threshold.dynamicRadiusInCanvas||(e.threshold.dynamicRadiusInCanvas=0),e.threshold.dynamicRadiusInCanvas=3+d}},XVe={[jt.Initialize]:t=>{t.segmentIndex=0}},{isEqual:U8}=Hr,yF={toIJK:t=>t,fromIJK:t=>t,type:"acquistion"},YVe={toIJK:([t,e,n])=>[n,t,e],fromIJK:([t,e,n])=>[e,n,t],type:"jk"},JVe={toIJK:([t,e,n])=>[t,n,e],fromIJK:([t,e,n])=>[t,n,e],type:"ik"};function ZVe(t,e){if(!(t instanceof lo))return{...yF,boundsIJKPrime:e};const{viewPlaneNormal:n}=t.getCamera(),r=U8(Math.abs(n[0]),1)&&YVe||U8(Math.abs(n[1]),1)&&JVe||U8(Math.abs(n[2]),1)&&yF;return r?{...r,boundsIJKPrime:r.fromIJK(e)}:{toIJK:null,boundsIJKPrime:null,fromIJK:null,error:`Only mappings orthogonal to acquisition plane are permitted, but requested ${n}`}}const{RLEVoxelMap:QVe,VoxelManager:eFe}=Hr,tFe=65535;var no;(function(t){t[t.SEGMENT=-1]="SEGMENT",t[t.ISLAND=-2]="ISLAND",t[t.INTERIOR=-3]="INTERIOR",t[t.EXTERIOR=-4]="EXTERIOR",t[t.INTERIOR_SMALL=-5]="INTERIOR_SMALL",t[t.INTERIOR_TEST=-6]="INTERIOR_TEST"})(no||(no={}));class ew{constructor(e){this.fillInternalEdge=!1,this.maxInternalRemove=128,this.maxInternalRemove=e?.maxInternalRemove??this.maxInternalRemove,this.fillInternalEdge=e?.fillInternalEdge??this.fillInternalEdge}initialize(e,n,r){const i=!!n.sourceVoxelManager,a=i?n.sourceVoxelManager:n,o=i?n:eFe.createRLEHistoryVoxelManager(a),{segmentIndex:s=1,previewSegmentIndex:l=1}=r,c=r.points||a.getPoints();if(!c?.length)return;const f=a.getBoundsIJK().map((w,S)=>[Math.min(w[0],...c.map(T=>T[S])),Math.max(w[1],...c.map(T=>T[S]))]);if(f.find(w=>w[0]<0||w[1]>tFe))return;const{toIJK:u,fromIJK:d,boundsIJKPrime:h,error:p}=ZVe(e,f);if(p){console.warn("Not performing island removal for planes not orthogonal to acquisition plane",p);return}const[g,m,y]=d(a.dimensions),v=new QVe(g,m,y),x=(w,S,T)=>{const _=a.toIndex(u([w,S,T])),D=a.getAtIndex(_);if(D===l||D===s)return no.SEGMENT};return v.fillFrom(x,h),v.normalizer={toIJK:u,fromIJK:d,boundsIJKPrime:h},this.segmentSet=v,this.previewVoxelManager=o,this.segmentIndex=s,this.previewSegmentIndex=l??s,this.selectedPoints=c,!0}floodFillSegmentIsland(){const{selectedPoints:e,segmentSet:n}=this;let r=0;const{fromIJK:i}=n.normalizer;return e.forEach(a=>{const o=i(a),s=n.toIndex(o),[l,c,f]=o;n.get(s)===no.SEGMENT&&(r+=n.floodFill(l,c,f,no.ISLAND))}),r}removeExternalIslands(){const{previewVoxelManager:e,segmentSet:n}=this,{toIJK:r}=n.normalizer,i=(a,o)=>{const[,s,l]=n.toIJK(a);if(o.value!==no.ISLAND)for(let c=o.start;c<o.end;c++){const f=r([c,s,l]),u=e.getAtIJKPoint(f);e.setAtIJKPoint(f,u===void 0?0:null)}};n.forEach(i,{rowModified:!0})}removeInternalIslands(){const{segmentSet:e,previewVoxelManager:n,previewSegmentIndex:r}=this,{height:i,normalizer:a,width:o}=e,{toIJK:s}=a;return e.forEachRow((l,c)=>{let f;for(const u of[...c])if(u.value===no.ISLAND){if(!f){if(this.fillInternalEdge&&u.start>0)for(let d=0;d<u.start;d++)e.set(l+d,no.INTERIOR);f=u;continue}for(let d=f.end;d<u.start;d++)e.set(l+d,no.INTERIOR);f=u}if(this.fillInternalEdge&&f?.end<o)for(let u=f.end;u<o;u++)e.set(l+u,no.INTERIOR)}),e.forEach((l,c)=>{if(c.value!==no.INTERIOR)return;const[,f,u]=e.toIJK(l),d=f>0?e.getRun(f-1,u):null,h=f+1<i?e.getRun(f+1,u):null,p=f===i-1,g=f===0,m=ew.covers(c,d)||g&&this.fillInternalEdge,y=ew.covers(c,h)||p&&this.fillInternalEdge;c.end-c.start>2&&(!m||!y)&&e.floodFill(c.start,f,u,no.EXTERIOR,{singlePlane:!0})}),e.forEach((l,c)=>{if(c.value!==no.INTERIOR)return;const[,f,u]=e.toIJK(l),p=e.floodFill(c.start,f,u,no.INTERIOR_TEST)>this.maxInternalRemove?no.EXTERIOR:no.INTERIOR_SMALL;e.floodFill(c.start,f,u,p)}),e.forEach((l,c)=>{if(c.value===no.INTERIOR_SMALL)for(let f=c.start;f<c.end;f++){const u=s(e.toIJK(l+f));n.setAtIJKPoint(u,r)}}),n.getArrayOfModifiedSlices()}static covers(e,n){if(!n)return!1;let{start:r}=e;const{end:i}=e;for(const a of n)if(r>=a.start&&r<a.end&&(r=a.end,r>=i))return!0;return!1}}const nFe={[jt.OnInteractionEnd]:t=>{const{previewSegmentIndex:e,segmentIndex:n,viewport:r,segmentationVoxelManager:i,activeStrategy:a,memo:o}=t;if(a!=="THRESHOLD_INSIDE_SPHERE_WITH_ISLAND_REMOVAL"||n===null)return;const s=new ew,l=o?.voxelManager||i;if(!s.initialize(r,l,{previewSegmentIndex:e,segmentIndex:n}))return;s.floodFillSegmentIsland(),s.removeExternalIslands(),s.removeInternalIslands();const c=l.getArrayOfModifiedSlices();c&&Gf(t.segmentationId,c,e)}},rFe={[jt.Preview]:function(t){const{previewSegmentIndex:e,configuration:n,enabledElement:r}=t;if(!e||!n)return;this.onInteractionStart?.(r,t);const i=this.fill(r,t);return i&&this.onInteractionEnd?.(r,t),i},[jt.Initialize]:t=>{const{segmentIndex:e,previewColor:n,previewSegmentIndex:r}=t;if(t.modified=!1,r==null||e==null)return;bC(t.segmentationId)?.forEach(a=>{ske(a,t.segmentationId,r,n)}),t.modified=!0},[jt.AcceptPreview]:t=>{const{previewSegmentIndex:e,segmentationVoxelManager:n,memo:r,segmentIndex:i,centerSegmentIndexInfo:a}=t||{},{changedIndices:o}=a||{},s=r,l=({index:c})=>{const f=n.getAtIndex(c);o?.length>0?o.includes(c)&&s.voxelManager.setAtIndex(c,0):f===e&&s.voxelManager.setAtIndex(c,i)};n.forEach(l),Gf(t.segmentationId,n.getArrayOfModifiedSlices(),i),t.centerSegmentIndexInfo.changedIndices=[]},[jt.RejectPreview]:t=>{t&&jJ.undoIf(e=>{const n=e;if(!n?.voxelManager)return!1;const{segmentationVoxelManager:r}=n;let i=!1;const a=({value:o})=>{o===t.previewSegmentIndex&&(i=!0)};return r.forEach(a),i})}},iFe={[jt.Fill]:t=>{const{segmentsLocked:e,segmentationImageData:n,segmentationVoxelManager:r,brushStrategy:i,centerIJK:a}=t,o=i.createIsInThreshold?.(t),{setValue:s}=i,l=o?c=>{const{value:f,index:u}=c;e.includes(f)||!o(u)||s(t,c)}:c=>s(t,c);r.forEach(l,{imageData:n,isInObject:t.isInObject,boundsIJK:t.isInObjectBoundsIJK}),r.addPoint(a)}};function aFe({operationData:t,existingValue:e,index:n}){const{previewSegmentIndex:r,memo:i,centerSegmentIndexInfo:a,previewOnHover:o,segmentIndex:s}=t,{hasPreviewIndex:l,hasSegmentIndex:c,segmentIndex:f}=a;if(f===0&&c&&l){if(e===s||o)return;if(e===r){i.voxelManager.setAtIndex(n,0);return}return}if(f===0&&c&&!l){if(e===0||e!==s)return;i.voxelManager.setAtIndex(n,r),a.changedIndices.push(n);return}if(f===0&&!c&&l){if(e===s||o)return;if(e===r){i.voxelManager.setAtIndex(n,0);return}return}if(f===0&&!c&&!l){if(e===s)return;if(e===r){i.voxelManager.setAtIndex(n,r);return}return}if(f===r&&c&&l){if(e===s)return;i.voxelManager.setAtIndex(n,r);return}if(f===r&&!c&&l){if(e===s)return;i.voxelManager.setAtIndex(n,r);return}if(f===s&&c&&l){if(e===s)return;i.voxelManager.setAtIndex(n,r);return}if(f===s&&c&&!l){if(e===s)return;i.voxelManager.setAtIndex(n,r);return}}const oFe={[jt.INTERNAL_setValue]:(t,{value:e,index:n})=>{const{segmentsLocked:r,previewSegmentIndex:i,memo:a,segmentationVoxelManager:o,centerSegmentIndexInfo:s,segmentIndex:l}=t,c=o.getAtIndex(n);if(!r.includes(e)&&!(!s&&c===l)&&!(s?.segmentIndex!==0&&c===l)){if(s?.segmentIndex===null){a.voxelManager.setAtIndex(n,i??l);return}if(!i){let f=l;s&&(f=s.segmentIndex),a.voxelManager.setAtIndex(n,f);return}aFe({operationData:t,existingValue:c,index:n})}}},sFe={[jt.CreateIsInThreshold]:t=>{const{imageVoxelManager:e,segmentIndex:n,configuration:r}=t;if(!(!r||!n))return i=>{const a=e.getAtIndex(i),o=Array.isArray(a)?Ao(a):a,{threshold:s}=r||{};return s?.range?.length?s.range[0]<=o&&o<=s.range[1]:!0}}},xF=10;function bF(){return{maxIJKs:[]}}function lFe(t,e){const{value:n}=e,{maxIJKs:r}=t,i=r.length;if(typeof n!="number"||i>=xF&&n<r[0].value)return;const a={value:e.value,pointLPS:e.pointLPS?[e.pointLPS[0],e.pointLPS[1],e.pointLPS[2]]:void 0,pointIJK:e.pointIJK?[e.pointIJK[0],e.pointIJK[1],e.pointIJK[2]]:void 0};if(!i||n>=r[i-1].value)r.push(a);else for(let o=0;o<i;o++)if(n<=r[o].value){r.splice(o,0,a);break}i>=xF&&r.splice(0,1)}function cFe(t,e,n){const{spacing:r,calibration:i}=n,{volumeUnit:a}=vc({calibration:i,hasPixelSpacing:!0},[]),o=r?r[0]*r[1]*r[2]:1;return e.volume={value:Array.isArray(e.count.value)?e.count.value.map(s=>s*o):e.count.value*o,unit:a,name:"volume",label:"Volume"},e.maxIJKs=t.maxIJKs.filter(s=>s.pointIJK!==void 0),e.array.push(e.volume),t.maxIJKs=[],e}const tO=class tO extends w0{static statsInit(e){super.statsInit(e),this.volumetricState=bF()}static statsCallback(e){super.statsCallback(e),lFe(this.volumetricState,e)}static getStatistics(e){const n={...e,unit:e?.unit||"none",calibration:e?.calibration,hasPixelSpacing:e?.hasPixelSpacing},r=super.getStatistics(n);return cFe(this.volumetricState,r,n)}};tO.volumetricState=bF();let tm=tO;const uFe=Math.pow(3*1e3/(4*Math.PI),1/3);async function fFe({segmentationId:t,segmentIndices:e,mode:n="collective"}){NVe(),Q3(tp.COMPUTE_STATISTICS,0);const r=BVe(t,e);if(!r)return;const{operationData:i,segVolumeId:a,segImageIds:o,reconstructableVolume:s,indices:l}=r,{refImageId:c,modalityUnitOptions:f}=jVe(a,o),u=uke(c,f);return s?await dFe({operationData:i,indices:l,unit:u,mode:n}):await hFe({segImageIds:o,indices:l,unit:u,mode:n})}async function dFe({operationData:t,indices:e,unit:n,mode:r}){const i=$Ve(t),{segmentationVoxelManager:a,imageVoxelManager:o,segmentationImageData:s,imageData:l}=i;if(!a||!s)return;const c=s.getSpacing(),{boundsIJK:f}=a;if(!f)return tm.getStatistics({spacing:c});const d={scalarData:a.getCompleteScalarDataArray(),dimensions:s.getDimensions(),spacing:s.getSpacing(),origin:s.getOrigin(),direction:s.getDirection()},h={scalarData:o.getCompleteScalarDataArray(),dimensions:l.getDimensions(),spacing:l.getSpacing(),origin:l.getOrigin(),direction:l.getDirection()};if(!h.scalarData?.length)return;const p=await Rm().executeTask("compute","calculateSegmentsStatisticsVolume",{segmentationInfo:d,imageInfo:h,indices:e,unit:n,mode:r});if(Q3(tp.COMPUTE_STATISTICS,100),r==="collective")return tw({stats:p,unit:n,spacing:c,segmentationImageData:s,imageVoxelManager:o});{const g={};return Object.entries(p).forEach(([m,y])=>{g[m]=tw({stats:y,unit:n,spacing:c,segmentationImageData:s,imageVoxelManager:o})}),g}}const B8=(t,e)=>{if(!t.array)return;const n=t.array.findIndex(r=>r.name===e.name);n!==-1?t.array[n]=e:t.array.push(e)},tw=({stats:t,unit:e,spacing:n,segmentationImageData:r,imageVoxelManager:i})=>{if(t.mean.unit=e,t.max.unit=e,t.min.unit=e,e!=="SUV")return t;const a=n.map(o=>Math.max(1,Math.round(1.1*uFe/o)));for(const o of t.maxIJKs){const s=pFe(o,a,r,i,n);if(!s)continue;const{mean:l}=s;(!t.peakValue||t.peakValue.value<=l.value)&&(t.peakValue={name:"peakValue",label:"Peak Value",value:l.value,unit:e},t.peakPoint={name:"peakLPS",label:"Peak SUV Point",value:o.pointLPS?[...o.pointLPS]:null,unit:null},B8(t,t.peakValue),B8(t,t.peakPoint))}if(t.volume&&t.mean){const o=t.volume.value,s=t.mean.value;t.lesionGlycolysis={name:"lesionGlycolysis",label:"Lesion Glycolysis",value:o*s,unit:`${t.volume.unit}·${e}`},B8(t,t.lesionGlycolysis)}return t};async function hFe({segImageIds:t,indices:e,unit:n,mode:r}){Q3(tp.COMPUTE_STATISTICS,0);const{segmentationInfo:i,imageInfo:a}=GVe(t),o=await Rm().executeTask("compute","calculateSegmentsStatisticsStack",{segmentationInfo:i,imageInfo:a,indices:e,mode:r});Q3(tp.COMPUTE_STATISTICS,100);const s=i[0].spacing,l=i[0],c=a[0].voxelManager;if(r==="collective")return tw({stats:o,unit:n,spacing:s,segmentationImageData:l,imageVoxelManager:c});{const f={};return Object.entries(o).forEach(([u,d])=>{f[u]=tw({stats:d,unit:n,spacing:s,segmentationImageData:l,imageVoxelManager:c})}),f}}function pFe(t,e,n,r,i){const{pointIJK:a,pointLPS:o}=t;if(!a)return;const s=a.map((f,u)=>[f-e[u],f+e[u]]),l=(f,u)=>{const d=(u[0]-a[0])/e[0],h=(u[1]-a[1])/e[1],p=(u[2]-a[2])/e[2];return d*d+h*h+p*p<=1},c=({pointIJK:f,pointLPS:u})=>{const d=r.getAtIJKPoint(f);d!==void 0&&tm.statsCallback({value:d,pointLPS:u,pointIJK:f})};return tm.statsInit({storePointData:!1}),xD(n,{pointInShapeFn:l,callback:c,boundsIJK:s}),tm.getStatistics({spacing:i})}const gFe={[jt.GetStatistics]:function(t,e,n){const{indices:r}=n,{segmentationId:i,viewport:a}=e;fFe({segmentationId:i,segmentIndices:r})}},In={determineSegmentIndex:KVe,dynamicThreshold:qVe,erase:XVe,islandRemoval:nFe,preview:rFe,regionFill:iFe,setValue:oFe,threshold:sFe,labelmapStatistics:gFe,ensureSegmentationVolumeFor3DManipulation:Nee,ensureImageVolumeFor3DManipulation:Lee},bh=class bh{constructor(e,...n){this._initialize=[],this._fill=[],this._onInteractionStart=[],this.fill=(r,i)=>{const a=this.initialize(r,i,jt.Fill);if(!a)return;this._fill.forEach(l=>l(a));const{segmentationVoxelManager:o,segmentIndex:s}=a;return Gf(a.segmentationId,o.getArrayOfModifiedSlices(),s),a},this.onInteractionStart=(r,i)=>{const a=this.initialize(r,i);a&&this._onInteractionStart.forEach(o=>o.call(this,a))},this.addPreview=(r,i)=>{const a=this.initialize(r,i,jt.AddPreview);if(a)return a},this.configurationName=e,this.compositions=n,n.forEach(r=>{const i=typeof r=="function"?r():r;if(i)for(const a in i){if(!bh.childFunctions[a])throw new Error(`Didn't find ${a} as a brush strategy`);bh.childFunctions[a](this,i[a])}}),this.strategyFunction=(r,i)=>this.fill(r,i);for(const r of Object.keys(bh.childFunctions))this.strategyFunction[r]=this[r]}initialize(e,n,r){const{viewport:i}=e,a=V7({operationData:n,viewport:i,strategy:this});if(!a)return null;const{imageVoxelManager:o,segmentationVoxelManager:s,segmentationImageData:l}=a,c=n.createMemo(n.segmentationId,s),f={operationName:r,...n,segmentIndex:n.segmentIndex,enabledElement:e,imageVoxelManager:o,segmentationVoxelManager:s,segmentationImageData:l,viewport:i,centerWorld:null,isInObject:null,isInObjectBoundsIJK:null,brushStrategy:this,memo:c};return this._initialize.forEach(u=>u(f)),f}};bh.COMPOSITIONS=In,bh.childFunctions={[jt.OnInteractionStart]:tc(jt.OnInteractionStart,jt.Initialize),[jt.OnInteractionEnd]:tc(jt.OnInteractionEnd,jt.Initialize),[jt.Fill]:tc(jt.Fill),[jt.Initialize]:tc(jt.Initialize),[jt.CreateIsInThreshold]:Lx(jt.CreateIsInThreshold),[jt.Interpolate]:tc(jt.Interpolate,jt.Initialize),[jt.AcceptPreview]:tc(jt.AcceptPreview,jt.Initialize),[jt.RejectPreview]:tc(jt.RejectPreview,jt.Initialize),[jt.INTERNAL_setValue]:Lx(jt.INTERNAL_setValue),[jt.Preview]:Lx(jt.Preview,!1),[jt.ComputeInnerCircleRadius]:tc(jt.ComputeInnerCircleRadius),[jt.EnsureSegmentationVolumeFor3DManipulation]:tc(jt.EnsureSegmentationVolumeFor3DManipulation),[jt.EnsureImageVolumeFor3DManipulation]:tc(jt.EnsureImageVolumeFor3DManipulation),[jt.AddPreview]:tc(jt.AddPreview),[jt.GetStatistics]:Lx(jt.GetStatistics),compositions:null};let yc=bh;function tc(t,e){const n=`_${t}`;return(r,i)=>{r[n]||=[],r[n].push(i),r[t]||=e?(a,o,...s)=>{const l=r[e](a,o,t);let c;return r[n].forEach(f=>{const u=f.call(r,l,...s);c||=u}),c}:(a,...o)=>{r[n].forEach(s=>s.call(r,a,...o))}}}function Lx(t,e=!0){return(n,r)=>{if(n[t])throw new Error(`The singleton method ${t} already exists`);n[t]=e?r:(i,a,...o)=>(a.enabledElement=i,r.call(n,a,...o))}}function mFe(t,e){const{center:n,radius:r}=t,i=t.radius2||r*r;return(e[0]-n[0])*(e[0]-n[0])+(e[1]-n[1])*(e[1]-n[1])+(e[2]-n[2])*(e[2]-n[2])<=i}const{transformWorldToIndex:wF,isEqual:vFe}=Hr;function kee(t){const[e,n,r,i]=t,a=[r[0],n[1]],o=[i[0],e[1]],s=[r[0],e[1]],l=[i[0],n[1]];return[a,o,s,l]}const Vee={[jt.Initialize]:t=>{const{points:e,viewport:n,segmentationImageData:r}=t;if(!e)return;const i=ct();e.length>=2?(Nl(i,e[0],e[1]),Xs(i,i,.5)):B9(i,e[0]),t.centerWorld=i,t.centerIJK=wF(r,i);const a=e.map(f=>n.worldToCanvas(f)),s=kee(a).map(f=>n.canvasToWorld(f)),l=e.map(f=>wF(r,f)),c=g7(l,r.getDimensions());t.isInObject=Fee(s),t.isInObjectBoundsIJK=c}};function Fee(t=[]){if(!t||t.length!==4)throw new Error("createPointInEllipse: cornersInWorld must have 4 points");const[e,n,r,i]=t,a=ct();Nl(a,e,n),Xs(a,a,.5);const o=ct();Dr(o,i,e);const s=Ao(o)/2;Ir(o,o);const l=ct();Dr(l,r,e);const c=Ao(l)/2;Ir(l,l);const f=ct();if(dr(f,o,l),Ir(f,f),vFe(s,c)){const u=s,d={center:a,radius:u,radius2:u*u};return h=>mFe(d,h)}return u=>{const d=ct();Dr(d,u,a);const h=zt(d,f),p=ct();Or(p,d,f,-h);const g=ct(),m=ct();Dr(m,a,e),Dr(g,p,m);const y=zt(g,o),v=zt(g,l);return y*y/(s*s)+v*v/(c*c)<=1}}const Uee=new yc("Circle",In.regionFill,In.setValue,Vee,In.determineSegmentIndex,In.preview,In.labelmapStatistics),yFe=new yc("CircleThreshold",In.regionFill,In.setValue,Vee,In.determineSegmentIndex,In.dynamicThreshold,In.threshold,In.preview,In.islandRemoval,In.labelmapStatistics),F7=Uee.strategyFunction,xFe=yFe.strategyFunction,{transformWorldToIndex:bFe}=Hr,wFe={[jt.Initialize]:t=>{const{points:e,viewport:n,segmentationImageData:r}=t;if(!e)return;const i=ct();e.length>=2?(Nl(i,e[0],e[1]),Xs(i,i,.5)):B9(i,e[0]),t.centerWorld=i,t.centerIJK=bFe(r,i);const{boundsIJK:a}=AVe(e.slice(0,2),r,n),o=e.map(c=>n.worldToCanvas(c)),l=kee(o).map(c=>n.canvasToWorld(c));t.isInObjectBoundsIJK=a,t.isInObject=Fee(l)}},IC=new yc("Sphere",In.regionFill,In.setValue,wFe,In.determineSegmentIndex,In.preview,In.labelmapStatistics,In.ensureSegmentationVolumeFor3DManipulation),Bee=IC.strategyFunction,CFe=new yc("SphereThreshold",...IC.compositions,In.dynamicThreshold,In.threshold,In.ensureSegmentationVolumeFor3DManipulation,In.ensureImageVolumeFor3DManipulation),SFe=new yc("SphereThreshold",...IC.compositions,In.dynamicThreshold,In.threshold,In.islandRemoval,In.ensureSegmentationVolumeFor3DManipulation,In.ensureImageVolumeFor3DManipulation),TFe=CFe.strategyFunction,EFe=SFe.strategyFunction,_Fe=new yc("EraseSphere",In.erase,...IC.compositions),$ee=_Fe.strategyFunction,DFe=new yc("EraseCircle",In.erase,...Uee.compositions),Gee=DFe.strategyFunction,{VoxelManager:i_,RLEVoxelMap:OFe}=Hr;function CF(t,e){return IFe(t,e)}function MFe(t){const{segmentationVoxelManager:e,undoVoxelManager:n,redoVoxelManager:r}=this,i=t===!1?r:n;i.forEach(({value:o,pointIJK:s})=>{e.setAtIJKPoint(s,o)});const a=i.getArrayOfModifiedSlices();Gf(this.segmentationId,a)}function IFe(t,e){const n=i_.createRLEHistoryVoxelManager(e);return{segmentationId:t,restoreMemo:MFe,commitMemo:RFe,segmentationVoxelManager:e,voxelManager:n,id:or(),operationType:"labelmap"}}function RFe(){if(this.redoVoxelManager)return!0;if(!this.voxelManager.modifiedSlices.size)return!1;const{segmentationVoxelManager:t}=this,e=i_.createRLEHistoryVoxelManager(t);OFe.copyMap(e.map,this.voxelManager.map);for(const r of this.voxelManager.modifiedSlices.keys())e.modifiedSlices.add(r);this.undoVoxelManager=e;const n=i_.createRLEVolumeVoxelManager({dimensions:this.segmentationVoxelManager.dimensions});return this.redoVoxelManager=n,e.forEach(({index:r,pointIJK:i,value:a})=>{const o=t.getAtIJKPoint(i);o!==a&&n.setAtIndex(r,o)}),!0}const{transformWorldToIndex:jee}=Hr,zee={[jt.Initialize]:t=>{const{points:e,viewport:n,segmentationImageData:r}=t;if(!e)return;const i=En(0,0,0);e.forEach(s=>{Nl(i,i,s)}),Xs(i,i,1/e.length),t.centerWorld=i,t.centerIJK=jee(r,i);const{boundsIJK:a,pointInShapeFn:o}=AFe(n,e,r);t.isInObject=o,t.isInObjectBoundsIJK=a}};function AFe(t,e,n){let r=e.map(x=>jee(n,x));r=r.map(x=>x.map(w=>Math.round(w)));const i=g7(r,n.getDimensions()),[a,o,s,l]=e,c=ct(),f=ct();Dr(c,o,a),Dr(f,l,a);const u=Ao(c),d=Ao(f);Ir(c,c),Ir(f,f);const h=ct();dr(h,c,f),Ir(h,h);const p=n.getDirection(),g=n.getSpacing(),{viewPlaneNormal:m}=t.getCamera(),y=fp({direction:p,spacing:g},m);return{boundsIJK:i,pointInShapeFn:x=>{const w=ct();Dr(w,x,a);const S=zt(w,c),T=zt(w,f),_=Math.abs(zt(w,h));return S>=-y&&S<=u+y&&T>=-y&&T<=d+y&&_<=y}}}const PFe=new yc("Rectangle",In.regionFill,In.setValue,zee,In.determineSegmentIndex,In.preview,In.labelmapStatistics),NFe=new yc("RectangleThreshold",In.regionFill,In.setValue,zee,In.determineSegmentIndex,In.dynamicThreshold,In.threshold,In.preview,In.islandRemoval,In.labelmapStatistics),Wee=PFe.strategyFunction;NFe.strategyFunction;const Yv=class Yv extends Vf{constructor(e,n){super(e,n),this.memoMap=new Map,this.acceptedMemoIds=new Map,this.centerSegmentIndexInfo={segmentIndex:null,hasSegmentIndex:!1,hasPreviewIndex:!1,changedIndices:[]}}_historyRedoHandler(e){const{id:n,operationType:r}=e.detail;if(r==="labelmap"){if(this.acceptedMemoIds.has(n)){this._hoverData=null;const i=this.acceptedMemoIds.get(n),a=i?.element,o=this.getOperationData(a);o.segmentIndex=i?.segmentIndex,a&&this.applyActiveStrategyCallback(et(a),o,jt.AcceptPreview)}this._previewData.isDrag=!0}}get _previewData(){return Yv.previewData}hasPreviewData(){return!!this._previewData.preview}shouldResolvePreviewRequests(){return(this.mode==="Active"||this.mode==="Enabled")&&this.hasPreviewData()}createMemo(e,n){const r=n.id;if(this.memo&&this.memo.segmentationVoxelManager===n)return this.memo;let i=this.memoMap.get(r);return i?i.redoVoxelManager&&(i=CF(e,n),this.memoMap.set(r,i)):(i=CF(e,n),this.memoMap.set(r,i)),this.memo=i,i}createEditData(e){const n=et(e),{viewport:r}=n,i=L2(r.id);if(!i){const c=new CustomEvent(vt.ERROR_EVENT,{detail:{type:"Segmentation",message:"No active segmentation detected, create a segmentation representation before using the brush tool"},cancelable:!0});return St.dispatchEvent(c),null}const{segmentationId:a}=i,o=xy(a),{representationData:s}=Ki(a);return this.getEditData({viewport:r,representationData:s,segmentsLocked:o,segmentationId:a})}getEditData({viewport:e,representationData:n,segmentsLocked:r,segmentationId:i}){if(e instanceof lo){const{volumeId:a}=n[pn.Labelmap],o=e.getActors();if(e instanceof aa){const u=new CustomEvent(vt.ERROR_EVENT,{detail:{type:"Segmentation",message:"Cannot perform brush operation on the selected viewport"},cancelable:!0});return St.dispatchEvent(u),null}const l=o.map(u=>yt.getVolume(u.referencedId)),c=yt.getVolume(a),f=l.find(u=>fr(u.dimensions,c.dimensions))?.volumeId||l[0]?.volumeId;return{volumeId:a,referencedVolumeId:this.configuration.threshold?.volumeId??f,segmentsLocked:r}}else{const a=SC(e.id,i);return a?{imageId:a,segmentsLocked:r}:void 0}}createHoverData(e,n){const r=et(e),{viewport:i}=r,a=i.getCamera(),{viewPlaneNormal:o,viewUp:s}=a,l=[i.id],{segmentIndex:c,segmentationId:f,segmentColor:u}=this.getActiveSegmentationData(i)||{};return{brushCursor:{metadata:{viewPlaneNormal:[...o],viewUp:[...s],FrameOfReferenceUID:i.getFrameOfReferenceUID(),referencedImageId:"",toolName:this.getToolName(),segmentColor:u},data:{}},centerCanvas:n,segmentIndex:c,viewport:i,segmentationId:f,segmentColor:u,viewportIdsToRender:l}}getActiveSegmentationData(e){const n=e.id,r=L2(n);if(!r)return;const{segmentationId:i}=r,a=bu(i);if(!a)return;const o=ip(n,i,a);return{segmentIndex:a,segmentationId:i,segmentColor:o}}getOperationData(e){const n=this._editData||this.createEditData(e),{segmentIndex:r,segmentationId:i,brushCursor:a}=this._hoverData||this.createHoverData(e),{data:o,metadata:s={}}=a||{},{viewPlaneNormal:l,viewUp:c}=s,f=this.configuration.preview?.previewColors?.[r],{viewport:u}=et(e),d=ip(u.id,i,r);if(!f&&!d)return;let h=null,p=null;return this.configuration.preview?.enabled&&(h=f||LFe(...d),p=255),{...n,points:o?.handles?.points,segmentIndex:r,viewPlaneNormal:l,previewOnHover:!this._previewData.isDrag,toolGroupId:this.toolGroupId,segmentationId:i,viewUp:c,centerSegmentIndexInfo:this.centerSegmentIndexInfo,activeStrategy:this.configuration.activeStrategy,configuration:this.configuration,previewColor:h,previewSegmentIndex:p,createMemo:this.createMemo.bind(this)}}addPreview(e=this._previewData.element,n){const{_previewData:r}=this,i=n?.acceptReject;i===!0?this.acceptPreview(e):i===!1&&this.rejectPreview(e);const a=et(e),o=this.applyActiveStrategyCallback(a,this.getOperationData(e),jt.AddPreview);return r.isDrag=!0,o?.modified&&(r.preview=o,r.element=e),o}rejectPreview(e=this._previewData.element){if(!e)return;this.doneEditMemo();const n=et(e);this.applyActiveStrategyCallback(n,this.getOperationData(e),jt.RejectPreview),this._previewData.preview=null,this._previewData.isDrag=!1}acceptPreview(e=this._previewData.element){if(!e)return;const n=this.getOperationData(e);this.memo&&this.memo.id&&this.acceptedMemoIds.set(this.memo.id,{element:e,segmentIndex:n.segmentIndex});const r=et(e);this.applyActiveStrategyCallback(r,n,jt.AcceptPreview),this.doneEditMemo(),this._previewData.preview=null,this._previewData.isDrag=!1}static viewportContoursToLabelmap(e,n){const r=n?.removeContours??!0,i=dC(),a=I7(e,i);if(!a?.length)return;const o=a.filter(m=>m.data.contour?.polyline?.length);if(!o.length)return;const l=new Yv({},{configuration:{strategies:{FILL_INSIDE_CIRCLE:F7},activeStrategy:"FILL_INSIDE_CIRCLE"}}).addPreview(e.element),{memo:c,segmentationId:f}=l,u=c?.voxelManager,d=u.sourceVoxelManager||u,{dimensions:h}=u,p=e.getDefaultActor().actor.getMapper().getInputData();for(const m of o){const y=[[1/0,-1/0],[1/0,-1/0],[1/0,-1/0]],{polyline:v}=m.data.contour;for(const M of v)p.worldToIndex(M).forEach((L,P)=>{y[P][0]=Math.min(y[P][0],L),y[P][1]=Math.max(y[P][1],L)});y.forEach((M,A)=>{M[0]=Math.round(Math.max(0,M[0])),M[1]=Math.round(Math.min(h[A]-1,M[1]))});const x=bu(f),w=m.data.handles?.[0]||v[0],S=p.worldToIndex(w).map(Math.round),T=d.getAtIJKPoint(S)||0;let _=!1,D=!1;for(const M of v){const A=p.worldToIndex(M).map(Math.round),L=d.getAtIJKPoint(A);L===T?_=!0:L>=0&&(D=!0)}const R=_&&D?T:T===0?x:0;for(let M=y[0][0];M<=y[0][1];M++)for(let A=y[1][0];A<=y[1][1];A++)for(let L=y[2][0];L<=y[2][1];L++){const P=p.indexToWorld([M,A,L]);PQ(P,v)&&u.setAtIJK(M,A,L,R)}r&&Cr(m.annotationUID)}const g=u.getArrayOfModifiedSlices();Gf(f,g)}};Yv.previewData={preview:null,element:null,timerStart:0,timer:null,startPoint:[NaN,NaN],isDrag:!1};let xm=Yv;function LFe(t,e,n,r,i=.4){return[Math.round(t+(255-t)*i),Math.round(e+(255-e)*i),Math.round(n+(255-n)*i),r]}class Hee extends xm{constructor(e={},n={supportedInteractionTypes:["Mouse","Touch"],configuration:{strategies:{FILL_INSIDE_CIRCLE:F7,ERASE_INSIDE_CIRCLE:Gee,FILL_INSIDE_SPHERE:Bee,ERASE_INSIDE_SPHERE:$ee,THRESHOLD_INSIDE_CIRCLE:xFe,THRESHOLD_INSIDE_SPHERE:TFe,THRESHOLD_INSIDE_SPHERE_WITH_ISLAND_REMOVAL:EFe},defaultStrategy:"FILL_INSIDE_CIRCLE",activeStrategy:"FILL_INSIDE_CIRCLE",brushSize:25,useCenterSegmentIndex:!1,preview:{enabled:!1,previewColors:{0:[255,255,255,128]},previewTimeMs:250,previewMoveDistance:8,dragMoveDistance:4,dragTimeMs:500},actions:{[jt.AcceptPreview]:{method:jt.AcceptPreview,bindings:[{key:"Enter"}]},[jt.RejectPreview]:{method:jt.RejectPreview,bindings:[{key:"Escape"}]},[jt.Interpolate]:{method:jt.Interpolate,bindings:[{key:"i"}],configuration:{useBallStructuringElement:!0,noUseDistanceTransform:!0,noUseExtrapolation:!0}},interpolateExtrapolation:{method:jt.Interpolate,bindings:[{key:"e"}],configuration:{}}}}}){super(e,n),this.onSetToolPassive=r=>{this.disableCursor()},this.onSetToolEnabled=()=>{this.disableCursor()},this.onSetToolDisabled=r=>{this.disableCursor()},this.preMouseDownCallback=r=>{const i=r.detail,{element:a}=i,o=et(a);this._editData=this.createEditData(a),this._activateDraw(a),Rn(a),r.preventDefault(),this._previewData.isDrag=!1,this._previewData.timerStart=Date.now();const s=this._hoverData||this.createHoverData(a);ut(s.viewportIdsToRender);const l=this.getOperationData(a);return this.applyActiveStrategyCallback(o,l,jt.OnInteractionStart),!0},this.mouseMoveCallback=r=>{if(this.mode===vr.Active){if(this.updateCursor(r),!this.configuration.preview.enabled)return;const{previewTimeMs:i,previewMoveDistance:a,dragMoveDistance:o}=this.configuration.preview,{currentPoints:s,element:l}=r.detail,{canvas:c}=s,{startPoint:f,timer:u,timerStart:d,isDrag:h}=this._previewData;if(h)return;const p=ei(c,f),g=Date.now()-d;if((p>a||g>i&&p>o)&&(u&&(window.clearTimeout(u),this._previewData.timer=null),h||this.rejectPreview(l)),!this._previewData.timer){const m=window.setTimeout(this.previewCallback,250);Object.assign(this._previewData,{timerStart:Date.now(),timer:m,startPoint:c,element:l})}}},this.previewCallback=()=>{if(this._previewData.isDrag){this._previewData.timer=null;return}this._previewData.timer=null;const r=this.getOperationData(this._previewData.element),i=et(this._previewData.element);if(!i)return;const{viewport:a}=i,o=this.configuration.activeStrategy,s=V7({operationData:r,viewport:a,strategy:o});if(!r)return;const l=this.createMemo(r.segmentationId,s.segmentationVoxelManager);this._previewData.preview=this.applyActiveStrategyCallback(et(this._previewData.element),{...r,...s,memo:l},jt.Preview)},this._dragCallback=r=>{const i=r.detail,{element:a,currentPoints:o}=i,s=et(a);this.updateCursor(r);const{viewportIdsToRender:l}=this._hoverData;ut(l);const c=ei(o.canvas,this._previewData.startPoint),{dragTimeMs:f,dragMoveDistance:u}=this.configuration.preview;!this._previewData.isDrag&&Date.now()-this._previewData.timerStart<f&&c<u||(this._previewData.timer&&(window.clearTimeout(this._previewData.timer),this._previewData.timer=null),this._previewData.preview=this.applyActiveStrategy(s,this.getOperationData(a)),this._previewData.element=a,this._previewData.timerStart=Date.now()+f,this._previewData.isDrag=!0,this._previewData.startPoint=o.canvas)},this._endCallback=r=>{const i=r.detail,{element:a}=i,o=et(a),s=this.getOperationData(a);!this._previewData.preview&&!this._previewData.isDrag&&this.applyActiveStrategy(o,s),this.doneEditMemo(),this._deactivateDraw(a),Kn(a),this.updateCursor(r),this._editData=null,this.applyActiveStrategyCallback(o,s,jt.OnInteractionEnd),this._previewData.isDrag||this.acceptPreview(a)},this._activateDraw=r=>{r.addEventListener(ee.MOUSE_UP,this._endCallback),r.addEventListener(ee.MOUSE_DRAG,this._dragCallback),r.addEventListener(ee.MOUSE_CLICK,this._endCallback)},this._deactivateDraw=r=>{r.removeEventListener(ee.MOUSE_UP,this._endCallback),r.removeEventListener(ee.MOUSE_DRAG,this._dragCallback),r.removeEventListener(ee.MOUSE_CLICK,this._endCallback)}}disableCursor(){this._hoverData=void 0,this.rejectPreview()}updateCursor(e){const n=e.detail,{element:r}=n,{currentPoints:i}=n,a=i.canvas;this._hoverData=this.createHoverData(r,a),this._calculateCursor(r,a),this._hoverData&&ut(this._hoverData.viewportIdsToRender)}_calculateCursor(e,n){const r=et(e),{viewport:i}=r,{canvasToWorld:a}=i,o=i.getCamera(),{brushSize:s}=this.configuration,l=En(o.viewUp[0],o.viewUp[1],o.viewUp[2]),c=En(o.viewPlaneNormal[0],o.viewPlaneNormal[1],o.viewPlaneNormal[2]),f=ct();dr(f,l,c);const u=a([n[0],n[1]]),d=ct(),h=ct(),p=ct(),g=ct();for(let w=0;w<=2;w++)d[w]=u[w]-l[w]*s,h[w]=u[w]+l[w]*s,p[w]=u[w]-f[w]*s,g[w]=u[w]+f[w]*s;if(!this._hoverData)return;const{brushCursor:m}=this._hoverData,{data:y}=m;y.handles===void 0&&(y.handles={}),y.handles.points=[d,h,p,g];const v=this.configuration.activeStrategy,x=this.configuration.strategies[v];typeof x?.computeInnerCircleRadius=="function"&&x.computeInnerCircleRadius({configuration:this.configuration,viewport:i}),y.invalidated=!1}getStatistics(e,n){if(!e)return;const r=et(e);return this.applyActiveStrategyCallback(r,this.getOperationData(e),jt.GetStatistics,n)}rejectPreview(e=this._previewData.element){if(!e)return;this.doneEditMemo();const n=et(e);n&&(this.applyActiveStrategyCallback(n,this.getOperationData(e),jt.RejectPreview),this._previewData.preview=null,this._previewData.isDrag=!1)}acceptPreview(e=this._previewData.element){e&&super.acceptPreview(e)}interpolate(e,n){if(!e)return;const r=et(e);this._previewData.preview=this.applyActiveStrategyCallback(r,this.getOperationData(e),jt.Interpolate,n.configuration),this._previewData.isDrag=!0}invalidateBrushCursor(){if(this._hoverData===void 0)return;const{data:e}=this._hoverData.brushCursor,{viewport:n}=this._hoverData;e.invalidated=!0;const{segmentColor:r}=this.getActiveSegmentationData(n)||{};this._hoverData.brushCursor.metadata.segmentColor=r}renderAnnotation(e,n){if(!this._hoverData)return;const{viewport:r}=e;if(!this._hoverData.viewportIdsToRender.includes(r.id))return;const a=this._hoverData.brushCursor;if(a.data.invalidated===!0){const{centerCanvas:v}=this._hoverData,{element:x}=r;this._calculateCursor(x,v)}const o=a.metadata;if(!o)return;const s=o.brushCursorUID,l=a.data,{points:c}=l.handles,f=c.map(v=>r.worldToCanvas(v)),u=f[0],d=f[1],h=[Math.floor((u[0]+d[0])/2),Math.floor((u[1]+d[1])/2)],p=Math.abs(u[1]-Math.floor((u[1]+d[1])/2)),g=`rgb(${o.segmentColor?.slice(0,3)||[0,0,0]})`;if(!r.getRenderingEngine()){console.warn("Rendering Engine has been destroyed");return}S0(n,s,"0",h,p,{color:g,lineDash:this.centerSegmentIndexInfo.segmentIndex===0?[1,2]:null});const{dynamicRadiusInCanvas:y}=this.configuration?.threshold||{dynamicRadiusInCanvas:0};y&&S0(n,s,"1",h,y,{color:g})}}Hee.toolName="Brush";function kFe(t,e){const n=np(t);if(n===void 0)return[];const r=n._toolInstances;return Object.keys(r).length?Object.values(r).filter(a=>a instanceof Hee):[]}const{transformWorldToIndex:kx}=Hr,Ig=class Ig extends na{constructor(e={},n={supportedInteractionTypes:["Mouse","Touch"],configuration:{preventHandleOutsideImage:!1,getTextLines:VFe}}){super(e,n),this.isPointNearTool=(r,i,a,o)=>{const s=et(r),{viewport:l}=s,{data:c}=i,{points:f}=c.handles;let u=l.worldToCanvas(f[0]),d=l.worldToCanvas(f[1]),h={start:{x:u[0],y:u[1]},end:{x:d[0],y:d[1]}},p=Il([h.start.x,h.start.y],[h.end.x,h.end.y],[a[0],a[1]]);return p<=o||(u=l.worldToCanvas(f[2]),d=l.worldToCanvas(f[3]),h={start:{x:u[0],y:u[1]},end:{x:d[0],y:d[1]}},p=Il([h.start.x,h.start.y],[h.end.x,h.end.y],[a[0],a[1]]),p<=o)},this.toolSelectedCallback=(r,i)=>{const a=r.detail,{element:o}=a;i.highlighted=!0;const s=fn(o,this.getToolName());this.editData={annotation:i,viewportIdsToRender:s,movingTextBox:!1},this._activateModify(o);const l=et(o),{renderingEngine:c}=l;ut(s),Rn(o),r.preventDefault()},this.handleSelectedCallback=(r,i,a)=>{const o=r.detail,{element:s}=o,l=i.data;i.highlighted=!0;let c=!1,f;a.worldPosition?c=!0:f=l.handles.points.findIndex(p=>p===a);const u=fn(s,this.getToolName());Rn(s),this.editData={annotation:i,viewportIdsToRender:u,handleIndex:f,movingTextBox:c},this._activateModify(s);const d=et(s),{renderingEngine:h}=d;ut(u),r.preventDefault()},this._endCallback=r=>{const i=r.detail,{element:a}=i,{annotation:o,viewportIdsToRender:s,newAnnotation:l,hasMoved:c}=this.editData,{data:f}=o;if(l&&!c)return;this.doneEditMemo(),f.handles.activeHandleIndex=null,this._deactivateModify(a),this._deactivateDraw(a),Kn(a);const{renderingEngine:u}=et(a);if(this.editData.handleIndex!==void 0){const{points:d}=f.handles,h=el(d[0],d[1]);if(el(d[2],d[3])>h){const g=[[...d[2]],[...d[3]]],m=[...d[0]],y=[...d[1]],v=Hn();Ol(v,g[1][0]-g[0][0],g[1][1]-g[1][0]);const x=Hn();Ol(x,-v[1],v[0]);const w=Hn();Ol(w,y[0]-m[0],y[1]-m[0]);let S;uf(w,x)>0?S=[m,y]:S=[y,m],f.handles.points=[g[0],g[1],S[0],S[1]]}}this.isHandleOutsideImage&&this.configuration.preventHandleOutsideImage&&Cr(o.annotationUID),ut(s),l&&Wr(o),this.editData=null,this.isDrawing=!1},this._dragDrawCallback=r=>{this.isDrawing=!0;const i=r.detail,{currentPoints:a,element:o}=i,s=et(o),{viewport:l}=s,{worldToCanvas:c}=l,{annotation:f,viewportIdsToRender:u,handleIndex:d,newAnnotation:h}=this.editData;this.createMemo(o,f,{newAnnotation:h});const{data:p}=f,g=a.world;p.handles.points[d]=[...g];const m=p.handles.points.map(c),y={longLineSegment:{start:{x:m[0][0],y:m[0][1]},end:{x:m[1][0],y:m[1][1]}},shortLineSegment:{start:{x:m[2][0],y:m[2][1]},end:{x:m[3][0],y:m[3][1]}}},x=ei(m[0],m[1])/3,w=y.longLineSegment.start.x-y.longLineSegment.end.x,S=y.longLineSegment.start.y-y.longLineSegment.end.y,T=Math.sqrt(w*w+S*S),_=w/T,D=S/T,I=(y.longLineSegment.start.x+y.longLineSegment.end.x)/2,R=(y.longLineSegment.start.y+y.longLineSegment.end.y)/2,M=I+x*D,A=R-x*_,L=I-x*D,P=R+x*_;p.handles.points[2]=l.canvasToWorld([M,A]),p.handles.points[3]=l.canvasToWorld([L,P]),f.invalidated=!0,ut(u),Fn(f,o,wn.HandlesUpdated),this.editData.hasMoved=!0},this._dragModifyCallback=r=>{this.isDrawing=!0;const i=r.detail,{element:a}=i,{annotation:o,viewportIdsToRender:s,handleIndex:l,movingTextBox:c,newAnnotation:f}=this.editData;this.createMemo(a,o,{newAnnotation:f});const{data:u}=o;if(c){const{deltaPoints:d}=i,h=d.world,{textBox:p}=u.handles,{worldPosition:g}=p;g[0]+=h[0],g[1]+=h[1],g[2]+=h[2],p.hasMoved=!0}else if(l===void 0){const{deltaPoints:d}=i,h=d.world;u.handles.points.forEach(g=>{g[0]+=h[0],g[1]+=h[1],g[2]+=h[2]}),o.invalidated=!0}else this._dragModifyHandle(r),o.invalidated=!0;ut(s),o.invalidated&&Fn(o,a,wn.HandlesUpdated)},this._dragModifyHandle=r=>{const i=r.detail,{currentPoints:a,element:o}=i,s=et(o),{viewport:l}=s,{annotation:c,handleIndex:f}=this.editData,{data:u}=c,d=a.world,h=[l.worldToCanvas(u.handles.points[0]),l.worldToCanvas(u.handles.points[1]),l.worldToCanvas(u.handles.points[2]),l.worldToCanvas(u.handles.points[3])],p={start:{x:h[0][0],y:h[0][1]},end:{x:h[1][0],y:h[1][1]}},g={start:{x:h[2][0],y:h[2][1]},end:{x:h[3][0],y:h[3][1]}},m=[...d],y=l.worldToCanvas(m);if(f===0||f===1){const x=h[f===0?1:0],w=Ol(Hn(),y[0]-x[0],y[1]-x[1]),S=Ol(Hn(),h[f][0]-x[0],h[f][1]-x[1]);Dh(w,w),Dh(S,S);const T={start:{x:x[0],y:x[1]},end:{x:y[0],y:y[1]}};if(this._movingLongAxisWouldPutItThroughShortAxis(T,g))return;const _=x,D=this._getSignedAngle(S,w);let I=h[2][0],R=h[2][1],M=h[3][0],A=h[3][1];I-=_[0],R-=_[1],M-=_[0],A-=_[1];const L=I*Math.cos(D)-R*Math.sin(D),P=I*Math.sin(D)+R*Math.cos(D),B=M*Math.cos(D)-A*Math.sin(D),U=M*Math.sin(D)+A*Math.cos(D);I=L+_[0],R=P+_[1],M=B+_[0],A=U+_[1];const G=l.canvasToWorld([I,R]),F=l.canvasToWorld([M,A]);u.handles.points[f]=m,u.handles.points[2]=G,u.handles.points[3]=F}else{const v=f===2?3:2,x={longLineSegment:{start:p.start,end:p.end},shortLineSegment:{start:g.start,end:g.end}},w=Ra(Hn(),[x.longLineSegment.end.x,x.longLineSegment.end.y],[x.longLineSegment.start.x,x.longLineSegment.start.y]),S=Dh(Hn(),w),T=Ra(Hn(),[y[0],y[1]],[h[f][0],h[f][1]]),_=v6(T),D=this._getSignedAngle(S,T),I=Math.cos(D)*_,R=mv(Hn(),[h[v][0],h[v][1]],S,I);if(this._movingLongAxisWouldPutItThroughShortAxis({start:{x:y[0],y:y[1]},end:{x:R[0],y:R[1]}},{start:{x:x.longLineSegment.start.x,y:x.longLineSegment.start.y},end:{x:x.longLineSegment.end.x,y:x.longLineSegment.end.y}})||!kV([y[0],y[1]],[R[0],R[1]],[p.start.x,p.start.y],[p.end.x,p.end.y]))return;u.handles.points[v]=l.canvasToWorld(R),u.handles.points[f]=m}},this.cancel=r=>{if(this.isDrawing){this.isDrawing=!1,this._deactivateDraw(r),this._deactivateModify(r),Kn(r);const{annotation:i,viewportIdsToRender:a,newAnnotation:o}=this.editData,{data:s}=i;return i.highlighted=!1,s.handles.activeHandleIndex=null,ut(a),o&&Wr(i),this.editData=null,i.annotationUID}},this._activateDraw=r=>{Mt.isInteractingWithTool=!0,r.addEventListener(ee.MOUSE_UP,this._endCallback),r.addEventListener(ee.MOUSE_DRAG,this._dragDrawCallback),r.addEventListener(ee.MOUSE_MOVE,this._dragDrawCallback),r.addEventListener(ee.MOUSE_CLICK,this._endCallback),r.addEventListener(ee.TOUCH_TAP,this._endCallback),r.addEventListener(ee.TOUCH_END,this._endCallback),r.addEventListener(ee.TOUCH_DRAG,this._dragDrawCallback)},this._deactivateDraw=r=>{Mt.isInteractingWithTool=!1,r.removeEventListener(ee.MOUSE_UP,this._endCallback),r.removeEventListener(ee.MOUSE_DRAG,this._dragDrawCallback),r.removeEventListener(ee.MOUSE_MOVE,this._dragDrawCallback),r.removeEventListener(ee.MOUSE_CLICK,this._endCallback),r.removeEventListener(ee.TOUCH_TAP,this._endCallback),r.removeEventListener(ee.TOUCH_END,this._endCallback),r.removeEventListener(ee.TOUCH_DRAG,this._dragDrawCallback)},this._activateModify=r=>{Mt.isInteractingWithTool=!0,r.addEventListener(ee.MOUSE_UP,this._endCallback),r.addEventListener(ee.MOUSE_DRAG,this._dragModifyCallback),r.addEventListener(ee.MOUSE_CLICK,this._endCallback),r.addEventListener(ee.TOUCH_END,this._endCallback),r.addEventListener(ee.TOUCH_DRAG,this._dragModifyCallback),r.addEventListener(ee.TOUCH_TAP,this._endCallback)},this._deactivateModify=r=>{Mt.isInteractingWithTool=!1,r.removeEventListener(ee.MOUSE_UP,this._endCallback),r.removeEventListener(ee.MOUSE_DRAG,this._dragModifyCallback),r.removeEventListener(ee.MOUSE_CLICK,this._endCallback),r.removeEventListener(ee.TOUCH_END,this._endCallback),r.removeEventListener(ee.TOUCH_DRAG,this._dragModifyCallback),r.removeEventListener(ee.TOUCH_TAP,this._endCallback)},this.renderAnnotation=(r,i)=>{let a=!0;const{viewport:o}=r,{element:s}=o;let l=Wi(this.getToolName(),s);if(!l?.length||(l=this.filterInteractableAnnotationsForElement(s,l),!l?.length))return a;const c=this.getTargetId(o),f=o.getRenderingEngine(),u={toolGroupId:this.toolGroupId,toolName:this.getToolName(),viewportId:r.viewport.id};for(let d=0;d<l.length;d++){const h=l[d],{annotationUID:p,data:g}=h,{points:m,activeHandleIndex:y}=g.handles,v=m.map(Q=>o.worldToCanvas(Q));u.annotationUID=p;const{color:x,lineWidth:w,lineDash:S,shadow:T}=this.getAnnotationStyle({annotation:h,styleSpecifier:u});if(!g.cachedStats[c]||g.cachedStats[c].unit==null?(g.cachedStats[c]={length:null,width:null,unit:null},this._calculateCachedStats(h,f,r)):h.invalidated&&this._throttledCalculateCachedStats(h,f,r),!o.getRenderingEngine())return console.warn("Rendering Engine has been destroyed"),a;let _;if(!fo(p))continue;!uo(p)&&!this.editData&&y!==null&&(_=[v[y]]),_&&ho(i,p,"0",_,{color:x});const D=`${p}-line-1`,I=`${p}-line-2`;Aa(i,p,"0",v[0],v[1],{color:x,lineDash:S,lineWidth:w,shadow:T},D),Aa(i,p,"1",v[2],v[3],{color:x,lineDash:S,lineWidth:w,shadow:T},I),a=!0;const A=this.getLinkedTextBoxStyle(u,h);if(!A.visibility){g.handles.textBox={hasMoved:!1,worldPosition:[0,0,0],worldBoundingBox:{topLeft:[0,0,0],topRight:[0,0,0],bottomLeft:[0,0,0],bottomRight:[0,0,0]}};continue}const L=this.configuration.getTextLines(g,c);if(!L||L.length===0)continue;let P;g.handles.textBox.hasMoved||(P=Du(v),g.handles.textBox.worldPosition=o.canvasToWorld(P));const B=o.worldToCanvas(g.handles.textBox.worldPosition),G=rl(i,p,"1",L,B,v,{},A),{x:F,y:$,width:V,height:X}=G;g.handles.textBox.worldBoundingBox={topLeft:o.canvasToWorld([F,$]),topRight:o.canvasToWorld([F+V,$]),bottomLeft:o.canvasToWorld([F,$+X]),bottomRight:o.canvasToWorld([F+V,$+X])}}return a},this._movingLongAxisWouldPutItThroughShortAxis=(r,i)=>{const a=Hn();Ol(a,i.end.x-i.start.x,i.end.y-i.start.y),Dh(a,a);const o={start:{x:i.start.x-a[0]*10,y:i.start.y-a[1]*10},end:{x:i.end.x+a[0]*10,y:i.end.y+a[1]*10}};return!kV([o.start.x,o.start.y],[o.end.x,o.end.y],[r.start.x,r.start.y],[r.end.x,r.end.y])},this._calculateCachedStats=(r,i,a)=>{const{data:o}=r,{element:s}=a.viewport,l=o.handles.points[0],c=o.handles.points[1],f=o.handles.points[2],u=o.handles.points[3],{cachedStats:d}=o,h=Object.keys(d);for(let g=0;g<h.length;g++){const m=h[g],y=this.getTargetImageData(m);if(!y)continue;const{imageData:v,dimensions:x}=y,w=kx(v,l),S=kx(v,c),T=kx(v,f),_=kx(v,u),D=[w,S],I=[T,_],{scale:R,unit:M}=vc(y,D),{scale:A,unit:L}=vc(y,I),P=this._calculateLength(l,c)/R,B=this._calculateLength(f,u)/A,U=P>B?P:B,G=P>B?B:P,F=P>B?M:L,$=P>B?L:M;this._isInsideVolume(w,S,T,_,x)?this.isHandleOutsideImage=!1:this.isHandleOutsideImage=!0,d[m]={length:U,width:G,unit:F,widthUnit:$}}const p=r.invalidated;return r.invalidated=!1,p&&Fn(r,s,wn.StatsUpdated),d},this._isInsideVolume=(r,i,a,o,s)=>xa(r,s)&&xa(i,s)&&xa(a,s)&&xa(o,s),this._getSignedAngle=(r,i)=>Math.atan2(r[0]*i[1]-r[1]*i[0],r[0]*i[0]+r[1]*i[1]),this._throttledCalculateCachedStats=Bl(this._calculateCachedStats,100,{trailing:!0})}addNewAnnotation(e){const n=e.detail,{currentPoints:r,element:i}=n,a=r.world,o=et(i),{viewport:s,renderingEngine:l}=o;this.isDrawing=!0;const c=s.getCamera(),{viewPlaneNormal:f,viewUp:u}=c,d=this.getReferencedImageId(s,a,f,u),h=s.getFrameOfReferenceUID(),p={highlighted:!0,invalidated:!0,metadata:{toolName:this.getToolName(),viewPlaneNormal:[...f],viewUp:[...u],FrameOfReferenceUID:h,referencedImageId:d,...s.getViewReference({points:[a]})},data:{handles:{points:[[...a],[...a],[...a],[...a]],textBox:{hasMoved:!1,worldPosition:[0,0,0],worldBoundingBox:{topLeft:[0,0,0],topRight:[0,0,0],bottomLeft:[0,0,0],bottomRight:[0,0,0]}},activeHandleIndex:null},label:"",cachedStats:{}}};hr(p,i);const g=fn(i,this.getToolName());return this.editData={annotation:p,viewportIdsToRender:g,handleIndex:1,movingTextBox:!1,newAnnotation:!0,hasMoved:!1},this._activateDraw(i),Rn(i),e.preventDefault(),ut(g),p}_calculateLength(e,n){const r=e[0]-n[0],i=e[1]-n[1],a=e[2]-n[2];return Math.sqrt(r*r+i*i+a*a)}};Ig.toolName="Bidirectional",Ig.hydrate=(e,n,r)=>{const i=mr(e);if(!i)return;const{FrameOfReferenceUID:a,referencedImageId:o,viewPlaneNormal:s,instance:l,viewport:c}=Ig.hydrateBase(Ig,i,n[0],r),[f,u]=n,[d,h]=f,[p,g]=u,m=[d,h,p,g],{toolInstance:y,...v}=r||{},x={annotationUID:r?.annotationUID||or(),data:{handles:{points:m,activeHandleIndex:null,textBox:{hasMoved:!1,worldPosition:[0,0,0],worldBoundingBox:{topLeft:[0,0,0],topRight:[0,0,0],bottomLeft:[0,0,0],bottomRight:[0,0,0]}}},cachedStats:{}},highlighted:!1,autoGenerated:!1,invalidated:!1,isLocked:!1,isVisible:!0,metadata:{toolName:l.getToolName(),viewPlaneNormal:s,FrameOfReferenceUID:a,referencedImageId:o,...v}};return hr(x,c.element),ut([c.id]),x};let Id=Ig;function VFe(t,e){const{cachedStats:n,label:r}=t,{length:i,width:a,unit:o}=n[e],s=[];return r&&s.push(r),i===void 0||s.push(`L: ${kn(i)} ${o||o}`,`W: ${kn(a)} ${o}`),s}function FFe(t){const e=np(t);if(e===void 0)return;kFe(t).forEach(o=>{o.invalidateBrushCursor()});const r=e.getViewportsInfo();if(!Object.keys(r).map(o=>r[o]).length)return;const a=e.getViewportIds();ut(a)}function UFe(t,e){const n=Ki(t);typeof e=="string"&&(console.warn("segmentIndex is a string, converting to number"),e=Number(e)),Object.values(n.segments).forEach(i=>{i.active=!1}),n.segments[e]||(n.segments[e]={segmentIndex:e,label:"",locked:!1,cachedStats:{},active:!1}),n.segments[e].active!==!0&&(n.segments[e].active=!0,Hm(t));const r=bC(t);r.forEach(i=>{i0(i,{segmentationId:t}).forEach(o=>{o.segments[e]||(o.segments[e]={visible:!0})})}),r.forEach(i=>{const a=qa(i);FFe(a.id)})}function BFe(t,e){const{segmentationId:n,config:r}=e,i={colorLUTIndex:$Fe(r),...r};if(Ds.addSegmentationRepresentation(t,n,e.type,i),!bu(n)){const a=Ds.getSegmentation(n);if(a){const o=Object.keys(a.segments);if(o.length>0){const s=o.map(l=>Number(l)).sort()[0];UFe(n,s)}}}e.type===pn.Contour&&ut([t]),Hm(n)}function $Fe(t){const{colorLUTOrIndex:e}=t||{};return e===void 0?V8(JSON.parse(JSON.stringify(r_))):typeof e=="number"?e:Array.isArray(e)&&e.every(r=>Array.isArray(r)&&r.length===4)?V8(e):V8(JSON.parse(JSON.stringify(r_)))}function GFe(t,e){e.map(n=>BFe(t,n))}function jFe(t,e,n){t.data.label=n,Fn(t,e,wn.LabelChange)}class zFe{constructor(e){this._controlPoints=[],this._invalidated=!1,this._length=0,this._controlPoints=[],this._resolution=e?.resolution??20,this._fixedResolution=e?.fixedResolution??!1,this._closed=e?.closed??!1,this._invalidated=!0}get controlPoints(){return this._controlPoints}get numControlPoints(){return this._controlPoints.length}get resolution(){return this._resolution}set resolution(e){this._fixedResolution||this._resolution===e||(this._resolution=e,this.invalidated=!0)}get fixedResolution(){return this._fixedResolution}get closed(){return this._closed}set closed(e){this._closed!==e&&(this._closed=e,this.invalidated=!0)}get aabb(){return this._update(),this._aabb}get length(){return this._update(),this._length}get invalidated(){return this._invalidated}set invalidated(e){this._invalidated=e}hasTangentPoints(){return!1}addControlPoint(e){this._controlPoints.push([e[0],e[1]]),this.invalidated=!0}addControlPoints(e){e.forEach(n=>this.addControlPoint(n))}addControlPointAtU(e){const n=this._getLineSegmentAt(e),{start:r,end:i}=n.points,a=Math.floor(e),o=this._curveSegments[a],s=e-Math.floor(a),l=[r[0]+s*(i[0]-r[0]),r[1]+s*(i[1]-r[1])],c=this._controlPoints.indexOf(o.controlPoints.p1)+1;return this._controlPoints.splice(c,0,l),this.invalidated=!0,{index:c,point:l}}deleteControlPointByIndex(e){const n=this._closed?3:1;return e>=0&&e<this._controlPoints.length&&this._controlPoints.length>n?(this._controlPoints.splice(e,1),this.invalidated=!0,!0):!1}clearControlPoints(){this._controlPoints=[],this.invalidated=!0}setControlPoints(e){this.clearControlPoints(),this.addControlPoints(e)}updateControlPoint(e,n){if(e<0||e>=this._controlPoints.length)throw new Error("Index out of bounds");this._controlPoints[e]=[...n],this.invalidated=!0}getControlPoints(){return this._controlPoints.map(e=>[e[0],e[1]])}getClosestControlPoint(e){const n=this._controlPoints;let r=1/0,i=-1;for(let a=0,o=n.length;a<o;a++){const s=n[a],l=e[0]-s[0],c=e[1]-s[1],f=l*l+c*c;f<r&&(r=f,i=a)}return{index:i,point:i===-1?void 0:[...n[i]],distance:Math.sqrt(r)}}getClosestControlPointWithinDistance(e,n){const r=this.getClosestControlPoint(e);return r.distance<=n?r:void 0}getClosestPoint(e){this._update();const n=this._getCurveSegmmentsDistanceSquaredInfo(e);if(!n.length)return;n.sort((u,d)=>u.distanceSquared-d.distanceSquared);let r,i=-1,a=1/0,o,s;for(let u=0;u<n.length;u++){const d=n[u];if(d.distanceSquared>a)continue;const{curveSegmentIndex:h,curveSegment:p}=d,{lineSegments:g}=p;for(let m=0;m<g.length;m++){const y=g[m],{point:v,distanceSquared:x}=J6(y.points.start,y.points.end,e);x<a&&(s=y,i=h,o=d.curveSegment,r=v,a=x)}}const c=(s.previousLineSegmentsLength+hp(s.points.start,r))/o.length,f=i+c;return{point:r,uValue:f,distance:Math.sqrt(a)}}getClosestPointOnControlPointLines(e){const n=[...this._controlPoints];if(this._closed&&n.push(this._controlPoints[0]),!n.length)return;let r,i=1/0,a=n[0];for(let o=1,s=n.length;o<s;o++){const l=n[o],{point:c,distanceSquared:f}=J6(a,l,e);f<i&&(r=c,i=f),a=l}return{point:r,distance:Math.sqrt(i)}}getPolylinePoints(){return this._update(),this._convertCurveSegmentsToPolyline(this._curveSegments)}getPreviewPolylinePoints(e,n){if(this._closed)return[];this._update();const i=this.getClosestControlPointWithinDistance(e,n)?.index===0,a=this.getPreviewCurveSegments(e,i);return a?.length?this._convertCurveSegmentsToPolyline(a):[]}isPointNearCurve(e,n){this._update();const r=this._getCurveSegmmentsWithinDistance(e,n),i=n*n;for(let a=0;a<r.length;a++){const{lineSegments:o}=r[a];for(let s=0;s<o.length;s++){const l=o[s];if(wC(l.points.start,l.points.end,e)<=i)return!0}}return!1}containsPoint(e){if(this._update(),this._controlPoints.length<3)return!1;const r=[...this._curveSegments],i=this._getClosingCurveSegmentWithStraightLineSegment();i&&r.push(i);let a=0;for(let o=0;o<r.length;o++){const s=r[o],{aabb:l}=s;if(!(e[0]<=l.maxX&&e[1]>=l.minY&&e[1]<l.maxY))continue;const{lineSegments:f}=s;for(let u=0;u<f.length;u++){const d=f[u],{aabb:h}=d;if(e[0]<=h.maxX&&e[1]>=h.minY&&e[1]<h.maxY){const{start:g,end:m}=d.points,y=g[0]===m[0],v=(e[1]-g[1])*(m[0]-g[0])/(m[1]-g[1])+g[0];a+=y||e[0]<=v?1:0}}}return a%2===1}_update(){if(!this._invalidated)return;const e=this.getSplineCurves();let n=0,r=1/0,i=1/0,a=-1/0,o=-1/0;for(let s=0,l=e.length;s<l;s++){const{aabb:c,length:f}=e[s];r=r<=c.minX?r:c.minX,i=i<=c.minY?i:c.minY,a=a>=c.maxX?a:c.maxX,o=o>=c.maxY?o:c.maxY,n+=f}this._curveSegments=e,this._aabb={minX:r,minY:i,maxX:a,maxY:o},this._length=n,this._invalidated=!1}_convertCurveSegmentsToPolyline(e){this._update();const n=[];return e.forEach(({lineSegments:r},i)=>{r.forEach((a,o)=>{i===0&&o===0&&n.push([...a.points.start]),n.push([...a.points.end])})}),n}_getCurveSegmmentsDistanceSquaredInfo(e){this._update();const n=[],{_curveSegments:r}=this;for(let i=0;i<r.length;i++){const a=r[i],o=AV(a.aabb,e);n.push({curveSegmentIndex:i,curveSegment:a,distanceSquared:o})}return n}_getCurveSegmmentsWithinDistance(e,n){this._update();const r=n*n;if(AV(this.aabb,e)>r)return[];const i=this._getCurveSegmmentsDistanceSquaredInfo(e),a=[];for(let o=0,s=i.length;o<s;o++){const{curveSegment:l,distanceSquared:c}=i[o];c<=r&&a.push(l)}return a}_getLineSegmentAt(e){this._update();const n=Math.floor(e),r=e-n,i=this._curveSegments[n],{lineSegments:a}=i,o=i.length*r;for(let s=0;s<a.length;s++){const l=a[s],c=l.previousLineSegmentsLength+l.length;if(o>=l.previousLineSegmentsLength&&o<=c)return l}}_getClosingCurveSegmentWithStraightLineSegment(){if(this.closed)return;const e=this._controlPoints,n=e[0],r=e[e.length-1],i={points:{start:[...n],end:[...r]},aabb:{minX:Math.min(n[0],r[0]),minY:Math.min(n[1],r[1]),maxX:Math.max(n[0],r[0]),maxY:Math.max(n[1],r[1])}};return{aabb:{minX:i.aabb.minX,minY:i.aabb.minY,maxX:i.aabb.maxX,maxY:i.aabb.maxY},lineSegments:[i]}}}const WFe=1e-8;class Kee extends zFe{getPreviewCurveSegments(e,n){const r=this._getNumCurveSegments()+1,i=Math.max(0,r-2),a=n?r:r-1,o=this.getTransformMatrix(),s=[...this.controlPoints],l=[];n||s.push(e);for(let c=i;c<=a;c++){const f=this._getCurveSegment(c,o,s,n);l.push(f)}return l}getSplineCurves(){const e=this._getNumCurveSegments(),n=new Array(e);if(e<=0)return[];const r=this.getTransformMatrix();let i=0;for(let a=0;a<e;a++){const o=this._getCurveSegment(a,r);o.previousCurveSegmentsLength=i,n[a]=o,i+=o.length}return n}_getNumCurveSegments(e=this.controlPoints,n=this.closed){return n?e.length:Math.max(0,e.length-1)}_getPoint(e,n,r=this.controlPoints,i=this.closed){const a=this._getNumCurveSegments(r,i),o=Math.floor(e);let s=o%a;const l=e-o;if(s<0||s>=a)if(this.closed)s=(a+s)%a;else return;const{p0:f,p1:u,p2:d,p3:h}=this._getCurveSegmentPoints(s,r,i),p=l*l,g=p*l,m=FT(1,l,p,g),y=sye(oK(),m,n);return[uL(y,FT(f[0],u[0],d[0],h[0])),uL(y,FT(f[1],u[1],d[1],h[1]))]}_getCurveSegmentPoints(e,n=this.controlPoints,r=this.closed){const i=this._getNumCurveSegments(n,r),a=e,o=a-1,s=r?(a+1)%i:a+1,l=s+1,c=n[a],f=n[s];let u,d;return o>=0?u=n[o]:u=r?n[n.length-1]:PV(f,c),l<n.length?d=n[l]:d=r?n[0]:PV(c,f),{p0:u,p1:c,p2:f,p3:d}}_getLineSegments(e,n,r=this.controlPoints,i=this.closed){const a=this._getNumCurveSegments(r,i),o=this.resolution+1,s=1/o,l=e;let c=l+1;!i&&e===a-1&&(c-=WFe);const f=[];let u,d,h=0;for(let p=0,g=l;p<=o;p++,g+=s){g=g>c?c:g;const m=this._getPoint(g,n,r,i);if(!p){u=m;continue}d=m;const y=d[0]-u[0],v=d[1]-u[1],x=Math.sqrt(y**2+v**2),w={minX:u[0]<=d[0]?u[0]:d[0],maxX:u[0]>=d[0]?u[0]:d[0],minY:u[1]<=d[1]?u[1]:d[1],maxY:u[1]>=d[1]?u[1]:d[1]};f.push({points:{start:u,end:d},aabb:w,length:x,previousLineSegmentsLength:h}),u=d,h+=x}return f}_getCurveSegment(e,n=this.getTransformMatrix(),r=this.controlPoints,i=this.closed){const{p0:a,p1:o,p2:s,p3:l}=this._getCurveSegmentPoints(e,r,i),c=this._getLineSegments(e,n,r,i);let f=0,u=1/0,d=1/0,h=-1/0,p=-1/0;return c.forEach(({aabb:g,length:m})=>{u=Math.min(u,g.minX),d=Math.min(d,g.minY),h=Math.max(h,g.maxX),p=Math.max(p,g.maxY),f+=m}),{controlPoints:{p0:a,p1:o,p2:s,p3:l},aabb:{minX:u,minY:d,maxX:h,maxY:p},length:f,previousCurveSegmentsLength:0,lineSegments:c}}}const HFe=iye(h0(),eK(1,4,1,0,-3,0,3,0,3,-6,3,0,-1,3,-3,1),1/6);class KFe extends Kee{getTransformMatrix(){return HFe}}class nw extends Kee{constructor(e){super(e),this._scale=e?.scale??.5,this._fixedScale=e?.fixedScale??!1}get scale(){return this._scale}set scale(e){this._fixedScale||this._scale===e||(this._scale=e,this.invalidated=!0)}get fixedScale(){return this._fixedScale}getTransformMatrix(){const{scale:e}=this,n=2*e;return[0,1,0,0,-e,0,e,0,n,e-3,3-n,-e,-e,2-e,e-2,e]}}class qFe extends nw{constructor(){super({scale:.5,fixedScale:!0})}}class XFe extends nw{constructor(){super({resolution:0,fixedResolution:!0,scale:0,fixedScale:!0})}}class Ed extends Vf{constructor(e={},n={supportedInteractionTypes:["Mouse","Touch"]}){super(e,n)}touchDragCallback(e){this._dragCallback(e)}mouseDragCallback(e){this._dragCallback(e)}_dragCallback(e){const{element:n,deltaPoints:r}=e.detail,i=et(n),a=r.world;if(a[0]===0&&a[1]===0&&a[2]===0)return;const o=i.viewport.getCamera(),{focalPoint:s,position:l}=o,c=[l[0]-a[0],l[1]-a[1],l[2]-a[2]],f=[s[0]-a[0],s[1]-a[1],s[2]-a[2]];i.viewport.setCamera({focalPoint:f,position:c}),i.viewport.render()}}Ed.toolName="Pan";const $8=4,YFe=1024,JFe="PT";class _d extends Vf{constructor(e={},n={supportedInteractionTypes:["Mouse","Touch"]}){super(e,n),this._getImageDynamicRangeFromMiddleSlice=(r,i)=>{const a=Math.floor(i[2]/2),o=i[0]*i[1];let s,l;r instanceof Float32Array?(s=4,l=Float32Array):r instanceof Uint8Array?(s=1,l=Uint8Array):r instanceof Uint16Array?(s=2,l=Uint16Array):r instanceof Int16Array&&(s=2,l=Int16Array);const c=r.buffer,f=a*o*s,u=new l(c,f,o),{max:d,min:h}=this._getMinMax(u,o);return d-h}}touchDragCallback(e){this.mouseDragCallback(e)}mouseDragCallback(e){const{element:n,deltaPoints:r}=e.detail,i=et(n),{viewport:a}=i;let o,s,l,c,f,u,d=!1;const h=a.getProperties();if(a instanceof oa){o=a.getVolumeId(),u=nC(o),{lower:s,upper:l}=h.voiRange;const p=yt.getVolume(o);if(!p)throw new Error("Volume not found "+o);c=p.metadata.Modality,d=p.scaling&&Object.keys(p.scaling).length>0}else if(h.voiRange){c=a.modality,{lower:s,upper:l}=h.voiRange;const{preScale:p={scaled:!1}}=a.getImageData?.()||{};d=p.scaled&&p.scalingParameters?.suvbw!==void 0}else throw new Error("Viewport is not a valid type");if(c===JFe&&d?f=this.getPTScaledNewRange({deltaPointsCanvas:r.canvas,lower:s,upper:l,clientHeight:n.clientHeight,isPreScaled:d,viewport:a,volumeId:o}):f=this.getNewRange({viewport:a,deltaPointsCanvas:r.canvas,volumeId:o,lower:s,upper:l}),!(f.lower>=f.upper)&&(a.setProperties({voiRange:f}),a.render(),a instanceof oa)){u.forEach(p=>{a!==p&&p.render()});return}}getPTScaledNewRange({deltaPointsCanvas:e,lower:n,upper:r,clientHeight:i,viewport:a,volumeId:o,isPreScaled:s}){let l=$8;s?l=5/i:l=this._getMultiplierFromDynamicRange(a,o)||$8;const f=e[1]*l;return r-=f,r=s?Math.max(r,.1):r,{lower:n,upper:r}}getNewRange({viewport:e,deltaPointsCanvas:n,volumeId:r,lower:i,upper:a}){const o=this._getMultiplierFromDynamicRange(e,r)||$8,s=n[0]*o,l=n[1]*o;let{windowWidth:c,windowCenter:f}=ry(i,a);c+=s,f+=l,c=Math.max(c,1);const u=e.getProperties().VOILUTFunction;return Gg(c,f,u)}_getMultiplierFromDynamicRange(e,n){let r;if(n){const a=yt.getVolume(n),{voxelManager:o}=e.getImageData(),l=o.getMiddleSliceData().reduce((u,d)=>[Math.min(u[0],d),Math.max(u[1],d)],[1/0,-1/0]),c=a?.metadata?.BitsStored,f=c?2**c:1/0;r=Math.min(l[1]-l[0],f)}else r=this._getImageDynamicRangeFromViewport(e);const i=r/YFe;return i>1?Math.round(i):i}_getImageDynamicRangeFromViewport(e){const{imageData:n,voxelManager:r}=e.getImageData();if(r?.getRange){const s=r.getRange();return s[1]-s[0]}const i=n.getDimensions();if(n.getRange){const s=n.getRange();return s[1]-s[0]}let a;if(n.getScalarData?a=n.getScalarData():a=n.getPointData().getScalars().getData(),i[2]!==1)return this._getImageDynamicRangeFromMiddleSlice(a,i);let o;if(a.getRange)o=a.getRange();else{const{min:s,max:l}=this._getMinMax(a,a.length);o=[s,l]}return o[1]-o[0]}_getMinMax(e,n){let r=1/0,i=-1/0;for(let a=0;a<n;a++){const o=e[a];o<r&&(r=o),o>i&&(i=o)}return{max:i,min:r}}}_d.toolName="WindowLevel";class Dd extends Vf{constructor(e={},n={supportedInteractionTypes:["Mouse","Touch"],configuration:{zoomToCenter:!1,minZoomScale:.001,maxZoomScale:3e3,pinchToZoom:!0,pan:!0,invert:!1}}){super(e,n),this.preMouseDownCallback=r=>{const i=r.detail,{element:a,currentPoints:o}=i,s=o.world,c=et(a).viewport.getCamera(),{focalPoint:f}=c;this.initialMousePosWorld=s;let u=En(f[0]-s[0],f[1]-s[1],f[2]-s[2]);return u=Ir(ct(),u),this.dirVec=u,!1},this.preTouchStartCallback=r=>{if(!this.configuration.pinchToZoom)return this.preMouseDownCallback(r)},this._dragParallelProjection=(r,i,a,o=!1)=>{const{element:s,deltaPoints:l}=r.detail,c=o?r.detail.deltaDistance.canvas:l.canvas[1],f=[s.clientWidth,s.clientHeight],{parallelScale:u,focalPoint:d,position:h}=a,p=5/f[1],g=c*p*(this.configuration.invert?-1:1),m=(1-g)*u;let y=d,v=h;if(!this.configuration.zoomToCenter){const _=el(d,this.initialMousePosWorld);v=Or(ct(),h,this.dirVec,-_*g),y=Or(ct(),d,this.dirVec,-_*g)}const x=i.getImageData();let w=[1,1,1],S=m,T=!1;if(x){w=x.spacing;const{dimensions:_}=x,D=_[0]*w[0],I=_[1]*w[1],R=f[0]/f[1],M=i.options?.displayArea,A=M?.imageArea?.[0]??1.1,L=M?.imageArea?.[1]??1.1,P=D*A,B=I*L,U=P/B;let G;U>R?G=P/R*.5:G=B*.5;const{minZoomScale:F,maxZoomScale:$}=this.configuration,V=G/$,X=G/F;m<V?(S=V,T=!0):m>X&&(S=X,T=!0)}i.setCamera({parallelScale:S,focalPoint:T?d:y,position:T?h:v})},this._dragPerspectiveProjection=(r,i,a,o=!1)=>{const{element:s,deltaPoints:l}=r.detail,c=o?r.detail.deltaDistance.canvas:l.canvas[1],f=[s.clientWidth,s.clientHeight],{position:u,focalPoint:d,viewPlaneNormal:h}=a,p=Hs.distance2BetweenPoints(u,d),g=Math.sqrt(p)/f[1],m=[-h[0],-h[1],-h[2]],y=this.configuration.invert?c/g:c*g;let v=y*m[0];u[0]+=v,d[0]+=v,v=y*m[1],u[1]+=v,d[1]+=v,v=y*m[2],u[2]+=v,d[2]+=v,i.setCamera({position:u,focalPoint:d})},this.initialMousePosWorld=[0,0,0],this.dirVec=[0,0,0],this.configuration.pinchToZoom?this.touchDragCallback=this._pinchCallback.bind(this):this.touchDragCallback=this._dragCallback.bind(this),this.mouseDragCallback=this._dragCallback.bind(this)}mouseWheelCallback(e){this._zoom(e)}_pinchCallback(e){if(e.detail.currentPointsList.length>1){const{element:r,currentPoints:i}=e.detail,a=et(r),{viewport:o}=a,s=o.getCamera(),l=i.world,{focalPoint:c}=s;this.initialMousePosWorld=l;let f=En(c[0]-l[0],c[1]-l[1],c[2]-l[2]);f=Ir(ct(),f),this.dirVec=f,s.parallelProjection?this._dragParallelProjection(e,o,s,!0):this._dragPerspectiveProjection(e,o,s,!0),o.render()}this.configuration.pan&&this._panCallback(e)}_dragCallback(e){const{element:n}=e.detail,r=et(n),{viewport:i}=r,a=i.getCamera();a.parallelProjection?this._dragParallelProjection(e,i,a):this._dragPerspectiveProjection(e,i,a),i.render()}_zoom(e){const{element:n,points:r}=e.detail,i=et(n),{viewport:a}=i;a.getCamera();const s=e.detail.wheel.direction,l={detail:{element:n,eventName:ee.MOUSE_WHEEL,renderingEngineId:i.renderingEngineId,viewportId:a.id,camera:{},deltaPoints:{page:r.page,client:r.client,world:r.world,canvas:[0,-s*5]},startPoints:r,lastPoints:r,currentPoints:r}};a.type===br.STACK&&this.preMouseDownCallback(l),this._dragCallback(l)}_panCallback(e){const{element:n,deltaPoints:r}=e.detail,i=et(n),a=r.world,o=i.viewport.getCamera(),{focalPoint:s,position:l}=o,c=[l[0]-a[0],l[1]-a[1],l[2]-a[2]],f=[s[0]-a[0],s[1]-a[1],s[2]-a[2]];i.viewport.setCamera({focalPoint:f,position:c}),i.viewport.render()}}Dd.toolName="Zoom";const Vx="magnify-viewport";class sh extends Vf{constructor(e={},n={supportedInteractionTypes:["Mouse","Touch"],configuration:{magnifySize:10,magnifyWidth:250,magnifyHeight:250}}){super(e,n),this._hasBeenRemoved=!1,this.preMouseDownCallback=r=>{const i=r.detail,{element:a,currentPoints:o}=i,s=et(a),{viewport:l,renderingEngine:c}=s;if(!(l instanceof aa))throw new Error("MagnifyTool only works on StackViewports");const f=this._getReferencedImageId(l);if(!f)throw new Error("MagnifyTool: No referenced image id found, reconstructed planes not supported yet");const u=fn(a,this.getToolName());return this.editData={referencedImageId:f,viewportIdsToRender:u,enabledElement:s,renderingEngine:c,currentPoints:o},this._createMagnificationViewport(),this._activateDraw(a),Rn(a),r.preventDefault(),ut(u),!0},this.preTouchStartCallback=r=>{this.preMouseDownCallback(r)},this._createMagnificationViewport=()=>{const{enabledElement:r,referencedImageId:i,viewportIdsToRender:a,renderingEngine:o,currentPoints:s}=this.editData,{viewport:l}=r,{element:c}=l,f=l.getProperties(),{rotation:u}=l.getViewPresentation(),{canvas:d,world:h}=s;let p;if(p=c.querySelector(".magnifyTool"),p===null){const m=document.createElement("div");m.classList.add("magnifyTool"),m.style.display="block",m.style.width=`${this.configuration.magnifyWidth}px`,m.style.height=`${this.configuration.magnifyHeight}px`,m.style.position="absolute",p=m,c.querySelector(".viewport-element").appendChild(m);const v={viewportId:Vx,type:br.STACK,element:p};o.enableElement(v)}p.style.top=`${d[1]-this.configuration.magnifyHeight/2}px`,p.style.left=`${d[0]-this.configuration.magnifyWidth/2}px`;const g=o.getViewport(Vx);g.setStack([i]).then(()=>{if(this._hasBeenRemoved)return;g.setProperties(f),g.setViewPresentation({rotation:u});const{parallelScale:m}=l.getCamera(),{focalPoint:y,position:v,viewPlaneNormal:x}=g.getCamera(),w=Math.sqrt(Math.pow(y[0]-v[0],2)+Math.pow(y[1]-v[1],2)+Math.pow(y[2]-v[2],2)),S=[h[0],h[1],h[2]],T=[S[0]+w*x[0],S[1]+w*x[1],S[2]+w*x[2]];g.setCamera({parallelScale:m*(1/this.configuration.magnifySize),focalPoint:S,position:T}),g.render()}),p.style.display="block",ut(a)},this._dragCallback=r=>{const i=r.detail,{deltaPoints:a,element:o,currentPoints:s}=i,l=a.world,c=s.canvas,f=et(o),{renderingEngine:u}=f,d=u.getViewport(Vx),h=o.querySelector(".magnifyTool");if(!h)return;h.style.top=`${c[1]-this.configuration.magnifyHeight/2}px`,h.style.left=`${c[0]-this.configuration.magnifyWidth/2}px`;const{focalPoint:p,position:g}=d.getCamera(),m=[g[0]+l[0],g[1]+l[1],g[2]+l[2]],y=[p[0]+l[0],p[1]+l[1],p[2]+l[2]];d.setCamera({focalPoint:y,position:m}),d.render()},this._dragEndCallback=r=>{const{element:i}=r.detail,a=et(i),{renderingEngine:o}=a;o.disableElement(Vx);const s=i.querySelector(".viewport-element"),l=s.querySelector(".magnifyTool");s.removeChild(l),this._deactivateDraw(i),Kn(i),this._hasBeenRemoved=!0},this._activateDraw=r=>{Mt.isInteractingWithTool=!0,this._hasBeenRemoved=!1,r.addEventListener(ee.MOUSE_UP,this._dragEndCallback),r.addEventListener(ee.MOUSE_DRAG,this._dragCallback),r.addEventListener(ee.MOUSE_CLICK,this._dragEndCallback),r.addEventListener(ee.TOUCH_END,this._dragEndCallback),r.addEventListener(ee.TOUCH_DRAG,this._dragCallback)},this._deactivateDraw=r=>{Mt.isInteractingWithTool=!1,r.removeEventListener(ee.MOUSE_UP,this._dragEndCallback),r.removeEventListener(ee.MOUSE_DRAG,this._dragCallback),r.removeEventListener(ee.MOUSE_CLICK,this._dragEndCallback),r.removeEventListener(ee.TOUCH_END,this._dragEndCallback),r.removeEventListener(ee.TOUCH_DRAG,this._dragCallback)}}_getReferencedImageId(e){const n=this.getTargetId(e);let r;return e instanceof aa&&(r=n.split("imageId:")[1]),r}}sh.toolName="Magnify";const ZFe="advancedMagnifyTool",QFe=125,{Events:xd}=nl,SF=t=>t.uid!==t.referencedId;var a_;(function(t){t.ShowZoomFactorsList="showZoomFactorsList"})(a_||(a_={}));const eUe="AdvancedMagnify",tUe=1-Qs,nO=class nO extends na{constructor(e={},n={supportedInteractionTypes:["Mouse","Touch"],configuration:{shadow:!0,magnifyingGlass:{radius:125,zoomFactor:3,zoomFactorList:[1.5,2,2.5,3,3.5,4,4.5,5],autoPan:{enabled:!0,padding:10}},actions:{showZoomFactorsList:{method:"showZoomFactorsList",bindings:[{mouseButton:yu.Secondary,modifierKey:Ia.Shift}]}}}}){super(e,n),this.addNewAnnotation=r=>{const i=r.detail,{currentPoints:a,element:o}=i,s=et(o),{viewport:l,renderingEngine:c}=s,f=a.world,u=a.canvas,{magnifyingGlass:d}=this.configuration,{radius:h,zoomFactor:p,autoPan:g}=d,m=this._getCanvasHandlePoints(u,h),y=l.getCamera(),{viewPlaneNormal:v,viewUp:x}=y,w=this.getReferencedImageId(l,f,v,x),S=or(),T=or(),_=l.getFrameOfReferenceUID(),D={annotationUID:S,highlighted:!0,invalidated:!0,metadata:{toolName:this.getToolName(),viewPlaneNormal:[...v],viewUp:[...x],FrameOfReferenceUID:_,referencedImageId:w},data:{sourceViewportId:l.id,magnifyViewportId:T,zoomFactor:p,isCanvasAnnotation:!0,handles:{points:m,activeHandleIndex:null}}};this.magnifyViewportManager.createViewport(D,{magnifyViewportId:T,sourceEnabledElement:s,position:u,radius:h,zoomFactor:p,autoPan:{enabled:g.enabled,padding:g.padding,callback:R=>{const M=D.data.handles.points,{canvas:A}=R.delta;for(let L=0,P=M.length;L<P;L++){const B=M[L];B[0]+=A[0],B[1]+=A[1],D.invalidated=!0}}}}),hr(D,o);const I=fn(o,this.getToolName());return r.preventDefault(),ut(I),D},this.onSetToolDisabled=()=>{this.magnifyViewportManager.dispose(),dC().forEach(i=>{i.metadata.toolName===this.getToolName()&&Cr(i.annotationUID)})},this.isPointNearTool=(r,i,a,o)=>{const{data:s}=i,{points:l}=s.handles,c=l,f=c[0],u=c[2],d=c[3],h=Math.abs(u[1]-f[1])*.5,p=[d[0]+h,f[1]+h],g=Gv([p,a]);return Math.abs(g-h)<o*2},this.toolSelectedCallback=(r,i)=>{const a=r.detail,{element:o}=a;i.highlighted=!0;const s=fn(o,this.getToolName());this.editData={annotation:i,viewportIdsToRender:s},Rn(o),this._activateModify(o),ut(s),r.preventDefault()},this.handleSelectedCallback=(r,i,a)=>{const o=r.detail,{element:s}=o,{data:l}=i;i.highlighted=!0;const{points:c}=l.handles,f=c.findIndex(d=>d===a),u=fn(s,this.getToolName());this.editData={annotation:i,viewportIdsToRender:u,handleIndex:f},this._activateModify(s),Rn(s),ut(u),r.preventDefault()},this._endCallback=r=>{const i=r.detail,{element:a}=i,{annotation:o,viewportIdsToRender:s,newAnnotation:l}=this.editData,{data:c}=o;c.handles.activeHandleIndex=null,this._deactivateModify(a),Kn(a),this.editData=null,this.isDrawing=!1,ut(s),l&&Wr(o)},this._dragDrawCallback=r=>{this.isDrawing=!0;const i=r.detail,{deltaPoints:a}=i,o=a?.canvas??[0,0,0],{annotation:s,viewportIdsToRender:l}=this.editData,{points:c}=s.data.handles;c.forEach(f=>{f[0]+=o[0],f[1]+=o[1]}),s.invalidated=!0,this.editData.hasMoved=!0,ut(l)},this._dragModifyCallback=r=>{this.isDrawing=!0;const i=r.detail,{element:a}=i,{annotation:o,viewportIdsToRender:s,handleIndex:l}=this.editData,{data:c}=o;if(l===void 0){const{deltaPoints:f}=i,u=f.canvas;c.handles.points.forEach(h=>{h[0]+=u[0],h[1]+=u[1]}),o.invalidated=!0}else this._dragHandle(r),o.invalidated=!0;ut(s)},this._dragHandle=r=>{const i=r.detail,{annotation:a}=this.editData,{data:o}=a,{points:s}=o.handles,l=s,c=l[0],f=l[2],u=l[3],d=Math.abs(f[1]-c[1])*.5,h=[u[0]+d,c[1]+d],{currentPoints:p}=i,g=p.canvas,m=Gv([h,g]),y=this._getCanvasHandlePoints(h,m);s[0]=y[0],s[1]=y[1],s[2]=y[2],s[3]=y[3]},this.cancel=r=>{if(!this.isDrawing)return;this.isDrawing=!1,this._deactivateModify(r),Kn(r);const{annotation:i,viewportIdsToRender:a,newAnnotation:o}=this.editData,{data:s}=i;return i.highlighted=!1,s.handles.activeHandleIndex=null,ut(a),o&&Wr(i),this.editData=null,i.annotationUID},this._activateModify=r=>{Mt.isInteractingWithTool=!0,r.addEventListener(ee.MOUSE_UP,this._endCallback),r.addEventListener(ee.MOUSE_DRAG,this._dragModifyCallback),r.addEventListener(ee.MOUSE_CLICK,this._endCallback),r.addEventListener(ee.TOUCH_END,this._endCallback),r.addEventListener(ee.TOUCH_DRAG,this._dragModifyCallback),r.addEventListener(ee.TOUCH_TAP,this._endCallback)},this._deactivateModify=r=>{Mt.isInteractingWithTool=!1,r.removeEventListener(ee.MOUSE_UP,this._endCallback),r.removeEventListener(ee.MOUSE_DRAG,this._dragModifyCallback),r.removeEventListener(ee.MOUSE_CLICK,this._endCallback),r.removeEventListener(ee.TOUCH_END,this._endCallback),r.removeEventListener(ee.TOUCH_DRAG,this._dragModifyCallback),r.removeEventListener(ee.TOUCH_TAP,this._endCallback)},this.renderAnnotation=(r,i)=>{let a=!1;const{viewport:o}=r,{element:s}=o;let l=Wi(this.getToolName(),s);if(!l?.length)return a;l=l?.filter(u=>u.data.sourceViewportId===o.id);const c=this.filterInteractableAnnotationsForElement(s,l);if(!c?.length)return a;const f={toolGroupId:this.toolGroupId,toolName:this.getToolName(),viewportId:r.viewport.id};for(let u=0;u<c.length;u++){const d=c[u],{annotationUID:h,data:p}=d,{magnifyViewportId:g,zoomFactor:m,handles:y}=p,{points:v,activeHandleIndex:x}=y;f.annotationUID=h,this.getStyle("lineWidth",f,d),this.getStyle("lineDash",f,d);const w=this.getStyle("color",f,d),S=v,T=S[0],_=S[2],D=S[3],I=Math.abs(_[1]-T[1])*.5,R=[D[0]+I,T[1]+I];if(!o.getRenderingEngine())return console.warn("Rendering Engine has been destroyed"),a;let M;if(!fo(h))continue;!uo(h)&&!this.editData&&x!==null&&(M=[S[x]]),M&&ho(i,h,"0",M,{color:w});const A=`${h}-advancedMagnify`;S0(i,h,"0",R,I,{color:w,lineWidth:5},A);const P=this.magnifyViewportManager.getViewport(g);P.position=R,P.radius=I,P.zoomFactor=m,P.update(),a=!0}return a},this._getCanvasHandlePoints=(r,i)=>[[r[0],r[1]-i,0],[r[0]+i,r[1],0],[r[0],r[1]+i,0],[r[0]-i,r[1],0]],this.magnifyViewportManager=Eg.getInstance()}showZoomFactorsList(e,n){const{element:r,currentPoints:i}=e.detail,a=et(r),{viewport:o}=a,{canvas:s}=i,l=r.querySelector(":scope .viewport-element"),c=n.data.zoomFactor,f=()=>u.parentElement.removeChild(u),u=this._getZoomFactorsListDropdown(c,d=>{d!==void 0&&(n.data.zoomFactor=Number.parseFloat(d),n.invalidated=!0),f(),o.render()});Object.assign(u.style,{left:`${s[0]}px`,top:`${s[1]}px`}),l.appendChild(u),u.focus()}_getZoomFactorsListDropdown(e,n){const{zoomFactorList:r}=this.configuration.magnifyingGlass,i=document.createElement("select");return i.size=5,Object.assign(i.style,{width:"50px",position:"absolute"}),["mousedown","mouseup","mousemove","click"].forEach(a=>{i.addEventListener(a,o=>o.stopPropagation())}),i.addEventListener("change",a=>{a.stopPropagation(),n(i.value)}),i.addEventListener("keydown",a=>{((a.keyCode??a.which===27)||a.key?.toLowerCase()==="escape")&&(a.stopPropagation(),n())}),r.forEach(a=>{const o=document.createElement("option");o.label=a,o.title=`Zoom factor ${a.toFixed(1)}`,o.value=a,o.defaultSelected=a===e,i.add(o)}),i}};nO.Actions=a_;let Xc=nO;class Eg{constructor(){this.createViewport=(e,n)=>{const{magnifyViewportId:r,sourceEnabledElement:i,position:a,radius:o,zoomFactor:s,autoPan:l}=n,{viewport:c}=i,{element:f}=c,u=new nUe({magnifyViewportId:r,sourceEnabledElement:i,radius:o,position:a,zoomFactor:s,autoPan:l});return this._addSourceElementEventListener(f),this._magnifyViewportsMap.set(u.viewportId,{annotation:e,magnifyViewport:u,magnifyViewportInfo:n}),u},this._annotationRemovedCallback=e=>{const{annotation:n}=e.detail;n.metadata.toolName===eUe&&this.destroyViewport(n.data.magnifyViewportId)},this._newStackImageCallback=e=>{const{viewportId:n,imageId:r}=e.detail,i=this._getMagnifyViewportsMapEntriesBySourceViewportId(n),{viewport:a}=mr(n);a.stackActorReInitialized&&this._reset(n),i.forEach(({annotation:o})=>{o.metadata.referencedImageId=r,o.invalidated=!0})},this._newVolumeImageCallback=e=>{const{renderingEngineId:n,viewportId:r}=e.detail,a=$f(n).getViewport(r),{viewPlaneNormal:o}=a.getCamera();this._getMagnifyViewportsMapEntriesBySourceViewportId(r).forEach(({annotation:l})=>{const{viewPlaneNormal:c}=l.metadata;if(!(Math.abs(zt(c,o))>tUe))return;const{handles:u}=l.data,d=a.canvasToWorld([0,0]),h=ur(ct(),d,u.points[0]),p=zt(h,o),g=Xs(ct(),o,p);for(let m=0,y=u.points.length;m<y;m++){const v=u.points[m];v[0]+=g[0],v[1]+=g[1],v[2]+=g[2]}l.invalidated=!0})},this._magnifyViewportsMap=new Map,this._initialize()}static getInstance(){return Eg._singleton=Eg._singleton??new Eg,Eg._singleton}getViewport(e){return this._magnifyViewportsMap.get(e)?.magnifyViewport}dispose(){this._removeEventListeners(),this._destroyViewports()}destroyViewport(e){const n=this._magnifyViewportsMap.get(e);if(n){const{magnifyViewport:r}=n,{viewport:i}=r.sourceEnabledElement,{element:a}=i;this._removeSourceElementEventListener(a),r.dispose(),this._magnifyViewportsMap.delete(e)}}_destroyViewports(){Array.from(this._magnifyViewportsMap.keys()).forEach(n=>this.destroyViewport(n))}_getMagnifyViewportsMapEntriesBySourceViewportId(e){return Array.from(this._magnifyViewportsMap.values()).filter(({magnifyViewport:r})=>{const{viewport:i}=r.sourceEnabledElement;return i.id===e})}_reset(e){this._getMagnifyViewportsMapEntriesBySourceViewportId(e).forEach(({magnifyViewport:r,annotation:i,magnifyViewportInfo:a})=>{this.destroyViewport(r.viewportId);const o=mr(e);this.createViewport(i,{...a,sourceEnabledElement:{...o}})})}_addEventListeners(){St.addEventListener(ee.ANNOTATION_REMOVED,this._annotationRemovedCallback)}_removeEventListeners(){St.removeEventListener(ee.ANNOTATION_REMOVED,this._annotationRemovedCallback)}_addSourceElementEventListener(e){e.addEventListener(xd.STACK_NEW_IMAGE,this._newStackImageCallback);const n=i=>{const{viewportId:a}=i.detail;this._reset(a)};e.addEventListener(xd.VIEWPORT_NEW_IMAGE_SET,n);const r=i=>{const{viewportId:a}=i.detail;this._reset(a)};e.addEventListener(xd.VOLUME_VIEWPORT_NEW_VOLUME,r),e.addEventListener(xd.VOLUME_NEW_IMAGE,this._newVolumeImageCallback),e.newStackHandler=n,e.newVolumeHandler=r}_removeSourceElementEventListener(e){e.removeEventListener(xd.STACK_NEW_IMAGE,this._newStackImageCallback),e.removeEventListener(xd.VOLUME_NEW_IMAGE,this._newVolumeImageCallback),e.removeEventListener(xd.VIEWPORT_NEW_IMAGE_SET,e.newStackHandler),e.removeEventListener(xd.VOLUME_VIEWPORT_NEW_VOLUME,e.newVolumeHandler),delete e.newStackHandler,delete e.newVolumeHandler}_initialize(){this._addEventListeners()}}class nUe{constructor({magnifyViewportId:e,sourceEnabledElement:n,radius:r=QFe,position:i=[0,0],zoomFactor:a,autoPan:o}){this._enabledElement=null,this._sourceToolGroup=null,this._magnifyToolGroup=null,this._isViewportReady=!1,this._radius=0,this._resized=!1,this._canAutoPan=!1,this._viewportId=e??or(),this._sourceEnabledElement=n,this._autoPan=o,this.radius=r,this.position=i,this.zoomFactor=a,this.visible=!0,this._browserMouseDownCallback=this._browserMouseDownCallback.bind(this),this._browserMouseUpCallback=this._browserMouseUpCallback.bind(this),this._handleToolModeChanged=this._handleToolModeChanged.bind(this),this._mouseDragCallback=this._mouseDragCallback.bind(this),this._resizeViewportAsync=yC(this._resizeViewport.bind(this),1),this._initialize()}get sourceEnabledElement(){return this._sourceEnabledElement}get viewportId(){return this._viewportId}get radius(){return this._radius}set radius(e){Math.abs(this._radius-e)>1e-5&&(this._radius=e,this._resized=!0)}update(){const{radius:e,position:n,visible:r}=this,{viewport:i}=this._enabledElement,{element:a}=i,o=2*e,[s,l]=n;this._resized&&(this._resizeViewportAsync(),this._resized=!1),Object.assign(a.style,{display:r?"block":"hidden",width:`${o}px`,height:`${o}px`,left:`${-e}px`,top:`${-e}px`,transform:`translate(${s}px, ${l}px)`}),this._isViewportReady&&(this._syncViewports(),i.render())}dispose(){const{viewport:e}=this._enabledElement,{element:n}=e,r=e.getRenderingEngine();this._removeEventListeners(n),r.disableElement(e.id),n.parentNode&&n.parentNode.removeChild(n)}_handleToolModeChanged(e){const{_magnifyToolGroup:n}=this,{toolGroupId:r,toolName:i,mode:a,toolBindingsOptions:o}=e.detail;if(this._sourceToolGroup?.id===r)switch(a){case vr.Active:n.setToolActive(i,o);break;case vr.Passive:n.setToolPassive(i);break;case vr.Enabled:n.setToolEnabled(i);break;case vr.Disabled:n.setToolDisabled(i);break;default:throw new Error(`Unknow tool mode (${a})`)}}_inheritBorderRadius(e){const n=e.querySelector(".viewport-element"),r=e.querySelector(".cornerstone-canvas");n.style.borderRadius="inherit",r.style.borderRadius="inherit"}_createViewportNode(){const e=document.createElement("div"),{radius:n}=this,r=n*2;return e.classList.add(ZFe),Object.assign(e.style,{display:"block",width:`${r}px`,height:`${r}px`,position:"absolute",overflow:"hidden",borderRadius:"50%",boxSizing:"border-box",left:`${-n}px`,top:`${-n}px`,transform:"translate(-1000px, -1000px)"}),e}_convertZoomFactorToParallelScale(e,n,r){const{parallelScale:i}=e.getCamera(),a=n.canvas.offsetWidth/e.canvas.offsetWidth;return i*(1/r)*a}_isStackViewport(e){return"setStack"in e}_isVolumeViewport(e){return"addVolumes"in e}_cloneToolGroups(e,n){const r=e.getActors(),i=`${n.id}-toolGroup`,a=qa(e.id,e.renderingEngineId),o=a.clone(i,s=>{const l=a.getToolInstance(s);return l instanceof na&&!(l instanceof Xc)});return o.addViewport(n.id,n.renderingEngineId),r.filter(SF).forEach(s=>{GFe(this.viewportId,[{segmentationId:s.referencedId,type:pn.Labelmap}])}),{sourceToolGroup:a,magnifyToolGroup:o}}_cloneStack(e,n){const r=e.getImageIds();n.setStack(r).then(()=>{this._isViewportReady=!0,this.update()})}_cloneVolumes(e,n){const i=e.getActors().filter(a=>!SF(a)).map(a=>({volumeId:a.uid}));return n.setVolumes(i).then(()=>{this._isViewportReady=!0,this.update()}),n}_cloneViewport(e,n){const{viewportId:r}=this,i=e.getRenderingEngine(),{options:a}=e,o={element:n,viewportId:r,type:e.type,defaultOptions:{...a}};i.enableElement(o);const s=i.getViewport(r);this._isStackViewport(e)?this._cloneStack(e,s):this._isVolumeViewport(e)&&this._cloneVolumes(e,s),this._inheritBorderRadius(n);const l=this._cloneToolGroups(e,s);this._sourceToolGroup=l.sourceToolGroup,this._magnifyToolGroup=l.magnifyToolGroup}_cancelMouseEventCallback(e){e.stopPropagation(),e.preventDefault()}_browserMouseUpCallback(e){const{element:n}=this._enabledElement.viewport;document.removeEventListener("mouseup",this._browserMouseUpCallback),n.addEventListener("mouseup",this._cancelMouseEventCallback),n.addEventListener("mousemove",this._cancelMouseEventCallback)}_browserMouseDownCallback(e){const{element:n}=this._enabledElement.viewport;this._canAutoPan=!!e.target?.closest(".advancedMagnifyTool"),document.addEventListener("mouseup",this._browserMouseUpCallback),n.removeEventListener("mouseup",this._cancelMouseEventCallback),n.removeEventListener("mousemove",this._cancelMouseEventCallback)}_mouseDragCallback(e){if(!Mt.isInteractingWithTool)return;const{_autoPan:n}=this;if(!n.enabled||!this._canAutoPan)return;const{currentPoints:r}=e.detail,{viewport:i}=this._enabledElement,{canvasToWorld:a}=i,{canvas:o}=r,{radius:s}=this,l=[s,s],c=hp(l,o),f=s-n.padding;if(c<=f)return;const u=c-f,d=Yh(Hn(),o,l);Dh(d,d),m6(d,d,u);const h=jw(Hn(),this.position,d),p=a(this.position),g=a(h),m=ur(ct(),g,p),y={points:{currentPosition:{canvas:this.position,world:p},newPosition:{canvas:h,world:g}},delta:{canvas:d,world:m}};n.callback(y)}_addBrowserEventListeners(e){document.addEventListener("mousedown",this._browserMouseDownCallback,!0),e.addEventListener("mousedown",this._cancelMouseEventCallback),e.addEventListener("mouseup",this._cancelMouseEventCallback),e.addEventListener("mousemove",this._cancelMouseEventCallback),e.addEventListener("dblclick",this._cancelMouseEventCallback)}_removeBrowserEventListeners(e){document.removeEventListener("mousedown",this._browserMouseDownCallback,!0),document.removeEventListener("mouseup",this._browserMouseUpCallback),e.removeEventListener("mousedown",this._cancelMouseEventCallback),e.removeEventListener("mouseup",this._cancelMouseEventCallback),e.removeEventListener("mousemove",this._cancelMouseEventCallback),e.removeEventListener("dblclick",this._cancelMouseEventCallback)}_addEventListeners(e){St.addEventListener(ee.TOOL_MODE_CHANGED,this._handleToolModeChanged),e.addEventListener(ee.MOUSE_MOVE,this._mouseDragCallback),e.addEventListener(ee.MOUSE_DRAG,this._mouseDragCallback),this._addBrowserEventListeners(e)}_removeEventListeners(e){St.removeEventListener(ee.TOOL_MODE_CHANGED,this._handleToolModeChanged),e.addEventListener(ee.MOUSE_MOVE,this._mouseDragCallback),e.addEventListener(ee.MOUSE_DRAG,this._mouseDragCallback),this._removeBrowserEventListeners(e)}_initialize(){const{_sourceEnabledElement:e}=this,{viewport:n}=e,{canvas:r}=n,i=this._createViewportNode();r.parentNode.appendChild(i),this._addEventListeners(i),this._cloneViewport(n,i),this._enabledElement=et(i)}_syncViewportsCameras(e,n){const r=e.canvasToWorld(this.position),i=this._convertZoomFactorToParallelScale(e,n,this.zoomFactor),{focalPoint:a,position:o,viewPlaneNormal:s}=n.getCamera(),l=Math.sqrt(Math.pow(a[0]-o[0],2)+Math.pow(a[1]-o[1],2)+Math.pow(a[2]-o[2],2)),c=[r[0],r[1],r[2]],f=[c[0]+l*s[0],c[1]+l*s[1],c[2]+l*s[2]];n.setCamera({parallelScale:i,focalPoint:c,position:f})}_syncStackViewports(e,n){n.setImageIdIndex(e.getCurrentImageIdIndex())}_syncViewports(){const{viewport:e}=this._sourceEnabledElement,{viewport:n}=this._enabledElement,r=e.getProperties();n.getImageData()&&(n.setProperties(r),this._syncViewportsCameras(e,n),this._isStackViewport(e)&&this._syncStackViewports(e,n),this._syncViewportsCameras(e,n),n.render())}_resizeViewport(){const{viewport:e}=this._enabledElement;e.getRenderingEngine().resize()}}Xc.toolName="AdvancedMagnify";const{EPSILON:TF}=cp;class lh extends R7{constructor(e={},n={supportedInteractionTypes:["Mouse","Touch"],configuration:{sourceImageIds:[]}}){super(e,n),this.onSetToolEnabled=()=>{this._init()},this.onSetToolActive=()=>{this._init()},this._init=()=>{const r=this.configuration.sourceImageIds;if(!r?.length){console.warn("OverlayGridTool: No sourceImageIds provided in configuration");return}const i=Ft("imagePlaneModule",r[0]);if(!i){console.warn("OverlayGridTool: No imagePlaneModule found for sourceImageIds");return}const{frameOfReferenceUID:a}=i,o=np(this.toolGroupId).viewportsInfo;if(!o?.length){console.warn("OverlayGridTool: No viewports found");return}if(!Wi(this.getToolName(),a)?.length){const l=r.map(f=>this.calculateImageIdPointSets(f)),c={highlighted:!0,invalidated:!0,metadata:{toolName:this.getToolName(),FrameOfReferenceUID:a,referencedImageId:null},data:{viewportData:new Map,pointSets:l}};hr(c,a)}ut(o.map(({viewportId:l})=>l))},this.calculateImageIdPointSets=r=>{const{imagePositionPatient:i,rows:a,columns:o,rowCosines:s,columnCosines:l,rowPixelSpacing:c,columnPixelSpacing:f}=Ft("imagePlaneModule",r),u=[...i],d=[...i],h=[...i],p=[...i];return Or(d,i,l,o*f),Or(h,i,s,a*c),Or(p,h,l,o*f),{pointSet1:[u,h,d,p],pointSet2:[u,d,h,p]}},this.renderAnnotation=(r,i)=>{const a=this.configuration.sourceImageIds;let o=!1;if(!a?.length)return o;const{viewport:s,FrameOfReferenceUID:l}=r;if(s.getImageIds().length<2)return o;const f=Wi(this.getToolName(),l);if(!f?.length)return o;const u=f[0],{annotationUID:d}=u,{focalPoint:h,viewPlaneNormal:p}=s.getCamera(),g={toolGroupId:this.toolGroupId,toolName:this.getToolName(),viewportId:r.viewport.id},m=this.getImageIdNormal(a[0]);if(this.isParallel(p,m))return o;const y=UD(p,h),v=u.data.pointSets,x=u.data.viewportData;for(let w=0;w<a.length;w++){const{pointSet1:S,pointSet2:T}=v[w],_=x.get(s.id)||this.initializeViewportData(x,s.id);if(!_.pointSetsToUse[w]){let G=S,F=Dr(ct(),S[0],S[1]);F=Ir(ct(),F),this.isPerpendicular(F,p)&&(G=T),_.pointSetsToUse[w]=G,_.lineStartsWorld[w]=O3(G[0],G[1],y),_.lineEndsWorld[w]=O3(G[2],G[3],y)}const D=_.lineStartsWorld[w],I=_.lineEndsWorld[w];g.annotationUID=d;const R=this.getStyle("lineWidth",g,u),M=this.getStyle("lineDash",g,u),A=this.getStyle("color",g,u),L=this.getStyle("shadow",g,u),P=[D,I].map(G=>s.worldToCanvas(G)),B=`${d}-line`,U=`${w}`;Aa(i,d,U,P[0],P[1],{color:A,width:R,lineDash:M,shadow:L},B)}return o=!0,o},this.initializeViewportData=(r,i)=>(r.set(i,{pointSetsToUse:[],lineStartsWorld:[],lineEndsWorld:[]}),r.get(i)),this.isPerpendicular=(r,i)=>{const a=zt(r,i);return Math.abs(a)<TF}}isParallel(e,n){return Math.abs(zt(e,n))>1-TF}getImageIdNormal(e){const{imageOrientationPatient:n}=Ft("imagePlaneModule",e),r=En(n[0],n[1],n[2]),i=En(n[3],n[4],n[5]);return dr(ct(),r,i)}}lh.toolName="OverlayGrid";const Jv=class Jv extends na{constructor(e={},n={supportedInteractionTypes:["Mouse","Touch"],configuration:{shadow:!0,getTextCallback:rUe,changeTextCallback:iUe,preventHandleOutsideImage:!1}}){super(e,n),this.isPointNearTool=(r,i,a,o)=>{const s=et(r),{viewport:l}=s,{annotationUID:c}=i,f=i.data.handles.points[0],u=l.worldToCanvas(f);if(ei(a,u)<o)return!0;const h=r.querySelector("svg");if(!h)return!1;const p=h.querySelector(`g[data-annotation-uid="${c}"]`);if(!p)return!1;const g=p,m=g.getBBox(),y=g.getAttribute("transform");let v=0,x=0;if(y){const _=y.match(/translate\(([-\d.]+)\s+([-\d.]+)\)/);_&&(v=parseFloat(_[1]),x=parseFloat(_[2]))}const w=m.x+v,S=m.y+x;return a[0]>=w&&a[0]<=w+m.width&&a[1]>=S&&a[1]<=S+m.height},this.addNewAnnotation=r=>{const i=r.detail,{currentPoints:a,element:o}=i,s=a.world,l=et(o),{viewport:c}=l;Rn(o),this.isDrawing=!0;const f=c.getCamera(),{viewPlaneNormal:u,viewUp:d}=f,h=this.getReferencedImageId(c,s,u,d),p=c.getFrameOfReferenceUID(),g={annotationUID:null,highlighted:!0,invalidated:!0,metadata:{toolName:this.getToolName(),viewPlaneNormal:[...u],viewUp:[...d],FrameOfReferenceUID:p,referencedImageId:h,...c.getViewReference({points:[s]})},data:{text:"",handles:{points:[[...s],[...s]]},label:""}};hr(g,o);const m=fn(o,this.getToolName());return this.editData={annotation:g,newAnnotation:!0,viewportIdsToRender:m,offset:[0,0,0]},r.preventDefault(),ut(m),this.configuration.getTextCallback(y=>{if(!y){Cr(g.annotationUID),ut(m),this.isDrawing=!1;return}Kn(o),g.data.text=y,Wr(g),ut(m)}),this.createMemo(o,g,{newAnnotation:!0}),g},this.toolSelectedCallback=(r,i)=>{const a=r.detail,{element:o,currentPoints:s}=a;i.highlighted=!0;const l=fn(o,this.getToolName());let c=[0,0,0];if(s&&s.world){const f=s.world,u=i.data.handles.points[0];c=[u[0]-f[0],u[1]-f[1],u[2]-f[2]]}this.editData={annotation:i,viewportIdsToRender:l,offset:c},this._activateModify(o),Rn(o),ut(l),r.preventDefault()},this._endCallback=r=>{const i=r.detail,{element:a}=i,{annotation:o,viewportIdsToRender:s,newAnnotation:l}=this.editData;this._deactivateDraw(a),this._deactivateModify(a),Kn(a),l&&this.createMemo(a,o,{newAnnotation:l}),this.editData=null,this.isDrawing=!1,this.doneEditMemo(),this.isHandleOutsideImage&&this.configuration.preventHandleOutsideImage&&Cr(o.annotationUID),ut(s),l&&Wr(o)},this._dragCallback=r=>{const i=r.detail,{currentPoints:a,element:o}=i,s=a.world,{annotation:l,viewportIdsToRender:c,offset:f}=this.editData;f?l.data.handles.points[0]=[s[0]+f[0],s[1]+f[1],s[2]+f[2]]:l.data.handles.points[0]=[...s],l.invalidated=!0,ut(c),Fn(l,o,wn.LabelChange)},this.cancel=r=>{if(this.isDrawing){this.isDrawing=!1,this._deactivateModify(r),Kn(r);const{annotation:i,viewportIdsToRender:a,newAnnotation:o}=this.editData,{data:s}=i;return i.highlighted=!1,s.handles.activeHandleIndex=null,ut(a),o&&Wr(i),this.editData=null,i.annotationUID}},this._activateModify=r=>{Mt.isInteractingWithTool=!0,r.addEventListener(ee.MOUSE_UP,this._endCallback),r.addEventListener(ee.MOUSE_DRAG,this._dragCallback),r.addEventListener(ee.MOUSE_CLICK,this._endCallback),r.addEventListener(ee.TOUCH_TAP,this._endCallback),r.addEventListener(ee.TOUCH_END,this._endCallback),r.addEventListener(ee.TOUCH_DRAG,this._dragCallback)},this._deactivateModify=r=>{Mt.isInteractingWithTool=!1,r.removeEventListener(ee.MOUSE_UP,this._endCallback),r.removeEventListener(ee.MOUSE_DRAG,this._dragCallback),r.removeEventListener(ee.MOUSE_CLICK,this._endCallback),r.removeEventListener(ee.TOUCH_TAP,this._endCallback),r.removeEventListener(ee.TOUCH_DRAG,this._dragCallback),r.removeEventListener(ee.TOUCH_END,this._endCallback)},this._activateDraw=r=>{Mt.isInteractingWithTool=!0,r.addEventListener(ee.MOUSE_UP,this._endCallback),r.addEventListener(ee.MOUSE_DRAG,this._dragCallback),r.addEventListener(ee.MOUSE_MOVE,this._dragCallback),r.addEventListener(ee.MOUSE_CLICK,this._endCallback),r.addEventListener(ee.TOUCH_TAP,this._endCallback),r.addEventListener(ee.TOUCH_END,this._endCallback),r.addEventListener(ee.TOUCH_DRAG,this._dragCallback)},this._deactivateDraw=r=>{Mt.isInteractingWithTool=!1,r.removeEventListener(ee.MOUSE_UP,this._endCallback),r.removeEventListener(ee.MOUSE_DRAG,this._dragCallback),r.removeEventListener(ee.MOUSE_MOVE,this._dragCallback),r.removeEventListener(ee.MOUSE_CLICK,this._endCallback),r.removeEventListener(ee.TOUCH_TAP,this._endCallback),r.removeEventListener(ee.TOUCH_END,this._endCallback),r.removeEventListener(ee.TOUCH_DRAG,this._dragCallback)},this.renderAnnotation=(r,i)=>{let a=!1;const{viewport:o}=r,{element:s}=o;let l=Wi(this.getToolName(),s);if(!l?.length)return a;l=this.filterInteractableAnnotationsForElement(s,l);const c={toolGroupId:this.toolGroupId,toolName:this.getToolName(),viewportId:r.viewport.id};for(let f=0;f<l.length;f++){const u=l[f],{annotationUID:d,data:h}=u,p=h.handles.points[0];c.annotationUID=d;const g=o.worldToCanvas(p);if(a=!0,!o.getRenderingEngine())return console.warn("Rendering Engine has been destroyed"),a;if(!fo(d)||!h.text)continue;const m=this.getLinkedTextBoxStyle(c,u);N2(i,d,"1",[h.text],g,{...m,padding:0})}return a}}handleSelectedCallback(e,n,r,i){}_doneChangingTextCallback(e,n,r){n.data.text=r;const i=fn(e,this.getToolName());ut(i),Fn(n,e)}_isInsideVolume(e,n,r){return xa(e,r)&&xa(n,r)}};Jv.toolName="Label",Jv.hydrate=(e,n,r,i)=>{const a=mr(e);if(!a)return;const{viewport:o}=a,s=o.getFrameOfReferenceUID(),{viewPlaneNormal:l,viewUp:c}=o.getCamera(),f=new Jv,u=f.getReferencedImageId(o,n,l,c),d={annotationUID:i?.annotationUID||or(),data:{text:r,handles:{points:[n]}},highlighted:!1,autoGenerated:!1,invalidated:!1,isLocked:!1,isVisible:!0,metadata:{toolName:f.getToolName(),viewPlaneNormal:l,FrameOfReferenceUID:s,referencedImageId:u,...i}};hr(d,o.element),ut([o.id])};let pf=Jv;function rUe(t){return t(prompt("Enter your annotation:"))}function iUe(t,e,n){return n(prompt("Enter your annotation:"))}pf.toolName="Label";const{transformWorldToIndex:EF}=Hr,Rg=class Rg extends na{constructor(e={},n={supportedInteractionTypes:["Mouse","Touch"],configuration:{preventHandleOutsideImage:!1,getTextLines:aUe,actions:{undo:{method:"undo",bindings:[{key:"z"}]},redo:{method:"redo",bindings:[{key:"y"}]}}}}){super(e,n),this.addNewAnnotation=r=>{const i=r.detail,{currentPoints:a,element:o}=i,s=a.world,l=et(o),{viewport:c}=l;Rn(o),this.isDrawing=!0;const{viewPlaneNormal:f,viewUp:u,position:d}=c.getCamera(),h=this.getReferencedImageId(c,s,f,u),p={highlighted:!0,invalidated:!0,metadata:{...c.getViewReference({points:[s]}),toolName:this.getToolName(),referencedImageId:h,viewUp:u,cameraPosition:d},data:{handles:{points:[[...s],[...s]],activeHandleIndex:null,textBox:{hasMoved:!1,worldPosition:[0,0,0],worldBoundingBox:{topLeft:[0,0,0],topRight:[0,0,0],bottomLeft:[0,0,0],bottomRight:[0,0,0]}}},label:"",cachedStats:{}}};hr(p,o);const g=fn(o,this.getToolName());return this.editData={annotation:p,viewportIdsToRender:g,handleIndex:1,movingTextBox:!1,newAnnotation:!0,hasMoved:!1},this._activateDraw(o),r.preventDefault(),ut(g),p},this.isPointNearTool=(r,i,a,o)=>{const s=et(r),{viewport:l}=s,{data:c}=i,[f,u]=c.handles.points,d=l.worldToCanvas(f),h=l.worldToCanvas(u),p={start:{x:d[0],y:d[1]},end:{x:h[0],y:h[1]}};return Il([p.start.x,p.start.y],[p.end.x,p.end.y],[a[0],a[1]])<=o},this.toolSelectedCallback=(r,i)=>{const a=r.detail,{element:o}=a;i.highlighted=!0;const s=fn(o,this.getToolName());this.editData={annotation:i,viewportIdsToRender:s,movingTextBox:!1},this._activateModify(o),Rn(o),ut(s),r.preventDefault()},this._endCallback=r=>{const i=r.detail,{element:a}=i,{annotation:o,viewportIdsToRender:s,newAnnotation:l,hasMoved:c}=this.editData,{data:f}=o;l&&!c||(f.handles.activeHandleIndex=null,this._deactivateModify(a),this._deactivateDraw(a),Kn(a),this.isHandleOutsideImage&&this.configuration.preventHandleOutsideImage&&Cr(o.annotationUID),ut(s),this.doneEditMemo(),l&&Wr(o),this.editData=null,this.isDrawing=!1)},this._dragCallback=r=>{this.isDrawing=!0;const i=r.detail,{element:a}=i,{annotation:o,viewportIdsToRender:s,handleIndex:l,movingTextBox:c,newAnnotation:f}=this.editData,{data:u}=o;if(this.createMemo(a,o,{newAnnotation:f}),c){const{deltaPoints:d}=i,h=d.world,{textBox:p}=u.handles,{worldPosition:g}=p;g[0]+=h[0],g[1]+=h[1],g[2]+=h[2],p.hasMoved=!0}else if(l===void 0){const{deltaPoints:d}=i,h=d.world;u.handles.points.forEach(g=>{g[0]+=h[0],g[1]+=h[1],g[2]+=h[2]}),o.invalidated=!0}else{const{currentPoints:d}=i,h=d.world;u.handles.points[l]=[...h],o.invalidated=!0}this.editData.hasMoved=!0,ut(s),o.invalidated&&Fn(o,a,wn.HandlesUpdated)},this.cancel=r=>{if(this.isDrawing){this.isDrawing=!1,this._deactivateDraw(r),this._deactivateModify(r),Kn(r);const{annotation:i,viewportIdsToRender:a,newAnnotation:o}=this.editData,{data:s}=i;return i.highlighted=!1,s.handles.activeHandleIndex=null,ut(a),o&&Wr(i),this.editData=null,i.annotationUID}},this._activateModify=r=>{Mt.isInteractingWithTool=!0,r.addEventListener(ee.MOUSE_UP,this._endCallback),r.addEventListener(ee.MOUSE_DRAG,this._dragCallback),r.addEventListener(ee.MOUSE_CLICK,this._endCallback),r.addEventListener(ee.TOUCH_END,this._endCallback),r.addEventListener(ee.TOUCH_DRAG,this._dragCallback),r.addEventListener(ee.TOUCH_TAP,this._endCallback)},this._deactivateModify=r=>{Mt.isInteractingWithTool=!1,r.removeEventListener(ee.MOUSE_UP,this._endCallback),r.removeEventListener(ee.MOUSE_DRAG,this._dragCallback),r.removeEventListener(ee.MOUSE_CLICK,this._endCallback),r.removeEventListener(ee.TOUCH_END,this._endCallback),r.removeEventListener(ee.TOUCH_DRAG,this._dragCallback),r.removeEventListener(ee.TOUCH_TAP,this._endCallback)},this._activateDraw=r=>{Mt.isInteractingWithTool=!0,r.addEventListener(ee.MOUSE_UP,this._endCallback),r.addEventListener(ee.MOUSE_DRAG,this._dragCallback),r.addEventListener(ee.MOUSE_MOVE,this._dragCallback),r.addEventListener(ee.MOUSE_CLICK,this._endCallback),r.addEventListener(ee.TOUCH_END,this._endCallback),r.addEventListener(ee.TOUCH_DRAG,this._dragCallback),r.addEventListener(ee.TOUCH_TAP,this._endCallback)},this._deactivateDraw=r=>{Mt.isInteractingWithTool=!1,r.removeEventListener(ee.MOUSE_UP,this._endCallback),r.removeEventListener(ee.MOUSE_DRAG,this._dragCallback),r.removeEventListener(ee.MOUSE_MOVE,this._dragCallback),r.removeEventListener(ee.MOUSE_CLICK,this._endCallback),r.removeEventListener(ee.TOUCH_END,this._endCallback),r.removeEventListener(ee.TOUCH_DRAG,this._dragCallback),r.removeEventListener(ee.TOUCH_TAP,this._endCallback)},this.renderAnnotation=(r,i)=>{let a=!1;const{viewport:o}=r,{element:s}=o;let l=Wi(this.getToolName(),s);if(!l?.length||(l=this.filterInteractableAnnotationsForElement(s,l),!l?.length))return a;const c=this.getTargetId(o),f=o.getRenderingEngine(),u={toolGroupId:this.toolGroupId,toolName:this.getToolName(),viewportId:r.viewport.id};for(let d=0;d<l.length;d++){const h=l[d],{annotationUID:p,data:g}=h,{points:m,activeHandleIndex:y}=g.handles;u.annotationUID=p;const{color:v,lineWidth:x,lineDash:w,shadow:S}=this.getAnnotationStyle({annotation:h,styleSpecifier:u}),T=m.map($=>o.worldToCanvas($));if(!g.cachedStats[c]||g.cachedStats[c].unit==null?(g.cachedStats[c]={length:null,unit:null},this._calculateCachedStats(h,f,r)):h.invalidated&&this._throttledCalculateCachedStats(h,f,r),!o.getRenderingEngine())return console.warn("Rendering Engine has been destroyed"),a;let _;if(!fo(p))continue;!uo(p)&&!this.editData&&y!==null&&(_=[T[y]]),_&&ho(i,p,"0",T,{color:v,lineDash:w,lineWidth:x});const D=`${p}-line`;if(Aa(i,p,"1",T[0],T[1],{color:v,width:x,lineDash:w,shadow:S},D),a=!0,!o.getRenderingEngine())return console.warn("Rendering Engine has been destroyed"),a;const R=this.getLinkedTextBoxStyle(u,h);if(!R.visibility){g.handles.textBox={hasMoved:!1,worldPosition:[0,0,0],worldBoundingBox:{topLeft:[0,0,0],topRight:[0,0,0],bottomLeft:[0,0,0],bottomRight:[0,0,0]}};continue}const M=this.configuration.getTextLines(g,c);if(!g.handles.textBox.hasMoved){const $=Du(T);g.handles.textBox.worldPosition=o.canvasToWorld($)}const A=o.worldToCanvas(g.handles.textBox.worldPosition),P=rl(i,p,"1",M,A,T,{},R),{x:B,y:U,width:G,height:F}=P;g.handles.textBox.worldBoundingBox={topLeft:o.canvasToWorld([B,U]),topRight:o.canvasToWorld([B+G,U]),bottomLeft:o.canvasToWorld([B,U+F]),bottomRight:o.canvasToWorld([B+G,U+F])}}return a},this._throttledCalculateCachedStats=Bl(this._calculateCachedStats,100,{trailing:!0})}handleSelectedCallback(e,n,r){const i=e.detail,{element:a}=i,{data:o}=n;n.highlighted=!0;let s=!1,l;r.worldPosition?s=!0:l=o.handles.points.findIndex(f=>f===r);const c=fn(a,this.getToolName());this.editData={annotation:n,viewportIdsToRender:c,handleIndex:l,movingTextBox:s},this._activateModify(a),Rn(a),ut(c),e.preventDefault()}_calculateLength(e,n){const r=e[0]-n[0],i=e[1]-n[1],a=e[2]-n[2];return Math.sqrt(r*r+i*i+a*a)}_calculateCachedStats(e,n,r){const i=e.data,{element:a}=r.viewport,o=i.handles.points[0],s=i.handles.points[1],{cachedStats:l}=i,c=Object.keys(l);for(let u=0;u<c.length;u++){const d=c[u],h=this.getTargetImageData(d);if(!h)continue;const{imageData:p,dimensions:g}=h,m=EF(p,o),y=EF(p,s),v=[m,y],{scale:x,unit:w}=vc(h,v),S=this._calculateLength(o,s)/x;this._isInsideVolume(m,y,g)?this.isHandleOutsideImage=!1:this.isHandleOutsideImage=!0,l[d]={length:S,unit:w}}const f=e.invalidated;return e.invalidated=!1,f&&Fn(e,a,wn.StatsUpdated),l}_isInsideVolume(e,n,r){return xa(e,r)&&xa(n,r)}};Rg.toolName="Length",Rg.hydrate=(e,n,r)=>{const i=mr(e);if(!i)return;const{FrameOfReferenceUID:a,referencedImageId:o,viewPlaneNormal:s,instance:l,viewport:c}=Rg.hydrateBase(Rg,i,n,r),{toolInstance:f,...u}=r||{},d={annotationUID:r?.annotationUID||or(),data:{handles:{points:n}},highlighted:!1,autoGenerated:!1,invalidated:!1,isLocked:!1,isVisible:!0,metadata:{toolName:l.getToolName(),viewPlaneNormal:s,FrameOfReferenceUID:a,referencedImageId:o,...u}};hr(d,c.element),ut([c.id])};let Rd=Rg;function aUe(t,e){const n=t.cachedStats[e],{length:r,unit:i}=n;return r==null||isNaN(r)?void 0:[`${kn(r)} ${i}`]}const{transformWorldToIndex:oUe}=Hr,$d=class $d extends na{constructor(e={},n){super(e,na.mergeDefaultProps($d.probeDefaults,n)),this.addNewAnnotation=r=>{const i=r.detail,{currentPoints:a,element:o}=i,s=a.world,l=et(o),{viewport:c}=l;this.isDrawing=!0;const f=this.constructor.createAnnotationForViewport(c,{data:{handles:{points:[[...s]]}}});hr(f,o);const u=fn(o,this.getToolName());return this.editData={annotation:f,newAnnotation:!0,viewportIdsToRender:u},this._activateModify(o),Rn(o),r.preventDefault(),ut(u),f},this._endCallback=r=>{const i=r.detail,{element:a}=i,{annotation:o,viewportIdsToRender:s,newAnnotation:l}=this.editData,{viewportId:c,renderingEngine:f}=et(a);this.eventDispatchDetail={viewportId:c,renderingEngineId:f.id},this._deactivateModify(a),Kn(a),l&&this.createMemo(a,o,{newAnnotation:l}),this.editData=null,this.isDrawing=!1,this.doneEditMemo(),this.isHandleOutsideImage&&this.configuration.preventHandleOutsideImage&&Cr(o.annotationUID),ut(s),l&&Wr(o)},this._dragCallback=r=>{this.isDrawing=!0;const i=r.detail,{currentPoints:a,element:o}=i,s=a.world,{annotation:l,viewportIdsToRender:c,newAnnotation:f}=this.editData,{data:u}=l;this.createMemo(o,l,{newAnnotation:f}),u.handles.points[0]=[...s],l.invalidated=!0,ut(c)},this.cancel=r=>{if(this.isDrawing){this.isDrawing=!1,this._deactivateModify(r),Kn(r);const{annotation:i,viewportIdsToRender:a,newAnnotation:o}=this.editData,{data:s}=i;return i.highlighted=!1,s.handles.activeHandleIndex=null,ut(a),o&&Wr(i),this.editData=null,i.annotationUID}},this._activateModify=r=>{Mt.isInteractingWithTool=!0,r.addEventListener(ee.MOUSE_UP,this._endCallback),r.addEventListener(ee.MOUSE_DRAG,this._dragCallback),r.addEventListener(ee.MOUSE_CLICK,this._endCallback),r.addEventListener(ee.TOUCH_END,this._endCallback),r.addEventListener(ee.TOUCH_DRAG,this._dragCallback),r.addEventListener(ee.TOUCH_TAP,this._endCallback)},this._deactivateModify=r=>{Mt.isInteractingWithTool=!1,r.removeEventListener(ee.MOUSE_UP,this._endCallback),r.removeEventListener(ee.MOUSE_DRAG,this._dragCallback),r.removeEventListener(ee.MOUSE_CLICK,this._endCallback),r.removeEventListener(ee.TOUCH_END,this._endCallback),r.removeEventListener(ee.TOUCH_DRAG,this._dragCallback),r.removeEventListener(ee.TOUCH_TAP,this._endCallback)},this.renderAnnotation=(r,i)=>{let a=!1;const{viewport:o}=r,{element:s}=o;let l=Wi(this.getToolName(),s);if(!l?.length||(l=this.filterInteractableAnnotationsForElement(s,l),!l?.length))return a;const c=this.getTargetId(o),f=o.getRenderingEngine(),u={toolGroupId:this.toolGroupId,toolName:this.getToolName(),viewportId:r.viewport.id};for(let d=0;d<l.length;d++){const h=l[d],p=h.annotationUID,g=h.data,m=g.handles.points[0],y=o.worldToCanvas(m);u.annotationUID=p;const{color:v,lineWidth:x}=this.getAnnotationStyle({annotation:h,styleSpecifier:u});if(g.cachedStats||(g.cachedStats={}),!g.cachedStats[c]||g.cachedStats[c].value===null)g.cachedStats[c]={Modality:null,index:null,value:null},this._calculateCachedStats(h,f,r,wn.StatsUpdated);else if(h.invalidated&&(this._calculateCachedStats(h,f,r),o instanceof oa)){const{referencedImageId:_}=h.metadata;for(const D in g.cachedStats)D.startsWith("imageId")&&f.getStackViewports().find(M=>{const A=mi(_),L=M.hasImageURI(A),P=mi(M.getCurrentImageId());return L&&P!==A})&&delete g.cachedStats[D]}if(!o.getRenderingEngine())return console.warn("Rendering Engine has been destroyed"),a;if(!fo(p))continue;ho(i,p,"0",[y],{color:v,lineWidth:x,handleRadius:this.configuration.handleRadius}),a=!0;const S=this.getLinkedTextBoxStyle(u,h);if(!S.visibility)continue;const T=this.configuration.getTextLines(g,c);if(T){const _=[y[0]+this.configuration.textCanvasOffset.x,y[1]+this.configuration.textCanvasOffset.y];N2(i,p,"0",T,[_[0],_[1]],S)}}return a}}isPointNearTool(e,n,r,i){const a=et(e),{viewport:o}=a,{data:s}=n,l=s.handles.points[0],c=o.worldToCanvas(l);return ei(r,c)<i}toolSelectedCallback(){}getHandleNearImagePoint(e,n,r,i){const a=et(e),{viewport:o}=a,{data:s}=n,l=s.handles.points[0],c=o.worldToCanvas(l);if(ei(r,c)<i===!0)return l}handleSelectedCallback(e,n){const r=e.detail,{element:i}=r;n.highlighted=!0;const a=fn(i,this.getToolName());this.editData={annotation:n,viewportIdsToRender:a},this._activateModify(i),Rn(i),ut(a),e.preventDefault()}_calculateCachedStats(e,n,r,i=wn.StatsUpdated){const a=e.data,{renderingEngineId:o,viewport:s}=r,{element:l}=s,c=a.handles.points[0],{cachedStats:f}=a,u=Object.keys(f);for(let h=0;h<u.length;h++){const p=u[h],g={isPreScaled:qm(s,p),isSuvScaled:this.isSuvScaled(s,p,e.metadata.referencedImageId)},m=this.getTargetImageData(p);if(!m)continue;const{dimensions:y,imageData:v,metadata:x,voxelManager:w}=m,S=x.Modality;let T=oUe(v,c);if(T=aye(T,T),xa(T,y)){this.isHandleOutsideImage=!1;let _=w.getAtIJKPoint(T);if(p.startsWith("imageId:")){const I=p.split("imageId:")[1],R=mi(I),A=P3(R)[0];T[2]=A.getCurrentImageIdIndex()}let D;if(S==="US"){const I=t_(m,[T]),R=I.values.every(M=>M!==null);_=R?I.values:_,D=R?I.units:"raw"}else D=mp(S,e.metadata.referencedImageId,g);f[p]={index:T,value:_,Modality:S,modalityUnit:D},e.invalidated=!0}else this.isHandleOutsideImage=!0,f[p]={index:T,Modality:S}}const d=e.invalidated;return e.invalidated=!1,d&&Fn(e,l,i),f}};$d.toolName="Probe",$d.probeDefaults={supportedInteractionTypes:["Mouse","Touch"],configuration:{shadow:!0,preventHandleOutsideImage:!1,getTextLines:sUe,handleRadius:"6",textCanvasOffset:{x:6,y:-6}}},$d.hydrate=(e,n,r)=>{const i=mr(e);if(!i)return;const{FrameOfReferenceUID:a,referencedImageId:o,viewPlaneNormal:s,viewUp:l,instance:c,viewport:f}=$d.hydrateBase($d,i,n,r),{toolInstance:u,...d}=r||{},h={annotationUID:r?.annotationUID||or(),data:{handles:{points:n}},highlighted:!1,autoGenerated:!1,invalidated:!1,isLocked:!1,isVisible:!0,metadata:{toolName:c.getToolName(),viewPlaneNormal:s,FrameOfReferenceUID:a,referencedImageId:o,...d}};hr(h,f.element),ut([f.id])};let Ad=$d;function sUe(t,e){const n=t.cachedStats[e],{index:r,value:i,modalityUnit:a}=n;if(i===void 0||!r)return;const o=[];if(o.push(`(${r[0]}, ${r[1]}, ${r[2]})`),i instanceof Array&&a instanceof Array)for(let s=0;s<i.length;s++)o.push(`${kn(i[s])} ${a[s]}`);else o.push(`${kn(i)} ${a}`);return o}const{transformWorldToIndex:_F}=Hr,Ag=class Ag extends na{constructor(e={},n={supportedInteractionTypes:["Mouse","Touch"],configuration:{shadow:!0,preventHandleOutsideImage:!1,storePointData:!1,centerPointRadius:0,calculateStats:!0,getTextLines:lUe,statsCalculator:w0}}){super(e,n),this.isHandleOutsideImage=!1,this.addNewAnnotation=r=>{const i=r.detail,{currentPoints:a,element:o}=i,s=a.world;a.canvas;const l=et(o),{viewport:c,renderingEngine:f}=l;this.isDrawing=!0;const u=c.getCamera(),{viewPlaneNormal:d,viewUp:h}=u,p=this.getReferencedImageId(c,s,d,h),g=c.getFrameOfReferenceUID(),m={highlighted:!0,invalidated:!0,metadata:{toolName:this.getToolName(),viewPlaneNormal:[...d],viewUp:[...h],FrameOfReferenceUID:g,referencedImageId:p,...c.getViewReference({points:[s]})},data:{label:"",handles:{textBox:{hasMoved:!1,worldPosition:[0,0,0],worldBoundingBox:{topLeft:[0,0,0],topRight:[0,0,0],bottomLeft:[0,0,0],bottomRight:[0,0,0]}},points:[[...s],[...s],[...s],[...s]],activeHandleIndex:null},cachedStats:{},initialRotation:c.getRotation()}};hr(m,o);const y=fn(o,this.getToolName());return this.editData={annotation:m,viewportIdsToRender:y,centerWorld:s,newAnnotation:!0,hasMoved:!1},this._activateDraw(o),Rn(o),r.preventDefault(),ut(y),m},this.isPointNearTool=(r,i,a,o)=>{const s=et(r),{viewport:l}=s,{data:c}=i,{points:f}=c.handles,u=f.map(D=>l.worldToCanvas(D)),[d,h,p,g]=u,m=Math.hypot(p[0]-g[0],p[1]-g[1]),y=Math.hypot(h[0]-d[0],h[1]-d[1]),v=Math.atan2(p[1]-g[1],p[0]-g[0]),x=[(p[0]+g[0])/2,(h[1]+d[1])/2],w={center:x,xRadius:(m-o)/2,yRadius:(y-o)/2,angle:v},S={center:x,xRadius:(m+o)/2,yRadius:(y+o)/2,angle:v},T=this._pointInEllipseCanvas(w,a);return!!(this._pointInEllipseCanvas(S,a)&&!T)},this.toolSelectedCallback=(r,i)=>{const a=r.detail,{element:o}=a;i.highlighted=!0;const s=fn(o,this.getToolName());this.editData={annotation:i,viewportIdsToRender:s,movingTextBox:!1},Rn(o),this._activateModify(o);const l=et(o),{renderingEngine:c}=l;ut(s),r.preventDefault()},this.handleSelectedCallback=(r,i,a)=>{const o=r.detail,{element:s}=o,{data:l}=i;i.highlighted=!0;let c=!1,f,u,d,h,p,g;if(a.worldPosition)c=!0;else{const{points:y}=l.handles,{viewport:v}=et(s),{worldToCanvas:x,canvasToWorld:w}=v;f=y.findIndex(T=>T===a);const S=y.map(x);g=S[f],h=Math.abs(S[2][0]-S[3][0]),p=Math.abs(S[0][1]-S[1][1]),u=[(S[2][0]+S[3][0])/2,(S[0][1]+S[1][1])/2],d=w(u)}const m=fn(s,this.getToolName());this.editData={annotation:i,viewportIdsToRender:m,handleIndex:f,canvasWidth:h,canvasHeight:p,centerWorld:d,originalHandleCanvas:g,movingTextBox:c},this._activateModify(s),Rn(s),ut(m),r.preventDefault()},this._endCallback=r=>{const i=r.detail,{element:a}=i,{annotation:o,viewportIdsToRender:s,newAnnotation:l,hasMoved:c}=this.editData,{data:f}=o;l&&!c||(this.doneEditMemo(),o.highlighted=!1,f.handles.activeHandleIndex=null,this._deactivateModify(a),this._deactivateDraw(a),Kn(a),this.editData=null,this.isDrawing=!1,this.isHandleOutsideImage&&this.configuration.preventHandleOutsideImage&&Cr(o.annotationUID),ut(s),l&&Wr(o))},this._dragDrawCallback=r=>{this.isDrawing=!0;const i=r.detail,{element:a}=i,{currentPoints:o}=i,s=o.canvas,l=et(a),{viewport:c}=l,{canvasToWorld:f}=c,{annotation:u,viewportIdsToRender:d,centerWorld:h,newAnnotation:p}=this.editData;this.createMemo(a,u,{newAnnotation:p});const g=c.worldToCanvas(h),{data:m}=u,y=Math.abs(s[0]-g[0]),v=Math.abs(s[1]-g[1]),x=[g[0],g[1]-v],w=[g[0],g[1]+v],S=[g[0]-y,g[1]],T=[g[0]+y,g[1]];m.handles.points=[f(x),f(w),f(S),f(T)],u.invalidated=!0,this.editData.hasMoved=!0,ut(d),Fn(u,a,wn.HandlesUpdated)},this._dragModifyCallback=r=>{this.isDrawing=!0;const i=r.detail,{element:a}=i,{annotation:o,viewportIdsToRender:s,handleIndex:l,movingTextBox:c,newAnnotation:f}=this.editData;this.createMemo(a,o,{newAnnotation:f});const{data:u}=o;if(c){const{deltaPoints:p}=i,g=p.world,{textBox:m}=u.handles,{worldPosition:y}=m;y[0]+=g[0],y[1]+=g[1],y[2]+=g[2],m.hasMoved=!0}else if(l===void 0){const{deltaPoints:p}=i,g=p.world;u.handles.points.forEach(y=>{y[0]+=g[0],y[1]+=g[1],y[2]+=g[2]}),o.invalidated=!0}else this._dragHandle(r),o.invalidated=!0;const d=et(a),{renderingEngine:h}=d;ut(s),o.invalidated&&Fn(o,a,wn.HandlesUpdated)},this._dragHandle=r=>{const i=r.detail,{element:a}=i,{viewport:o}=et(a),{canvasToWorld:s,worldToCanvas:l}=o,{annotation:c,canvasWidth:f,canvasHeight:u,handleIndex:d,centerWorld:h,originalHandleCanvas:p}=this.editData,g=o.worldToCanvas(h),{data:m}=c,{points:y}=m.handles,{currentPoints:v}=i,x=v.canvas;if(d===0||d===1){const w=Math.abs(x[1]-g[1]),S=[g[0],g[1]-w],T=[g[0],g[1]+w];y[0]=s(S),y[1]=s(T);const _=x[0]-p[0],D=f/2+_,I=[g[0]-D,g[1]],R=[g[0]+D,g[1]];y[2]=s(I),y[3]=s(R)}else{const w=Math.abs(x[0]-g[0]),S=[g[0]-w,g[1]],T=[g[0]+w,g[1]];y[2]=s(S),y[3]=s(T);const _=x[1]-p[1],D=u/2+_,I=[g[0],g[1]-D],R=[g[0],g[1]+D];y[0]=s(I),y[1]=s(R)}},this.cancel=r=>{if(this.isDrawing){this.isDrawing=!1,this._deactivateDraw(r),this._deactivateModify(r),Kn(r);const{annotation:i,viewportIdsToRender:a,newAnnotation:o}=this.editData,{data:s}=i;return i.highlighted=!1,s.handles.activeHandleIndex=null,ut(a),o&&Wr(i),this.editData=null,i.annotationUID}},this._activateModify=r=>{Mt.isInteractingWithTool=!0,r.addEventListener(ee.MOUSE_UP,this._endCallback),r.addEventListener(ee.MOUSE_DRAG,this._dragModifyCallback),r.addEventListener(ee.MOUSE_CLICK,this._endCallback),r.addEventListener(ee.TOUCH_END,this._endCallback),r.addEventListener(ee.TOUCH_DRAG,this._dragModifyCallback),r.addEventListener(ee.TOUCH_TAP,this._endCallback)},this._deactivateModify=r=>{Mt.isInteractingWithTool=!1,r.removeEventListener(ee.MOUSE_UP,this._endCallback),r.removeEventListener(ee.MOUSE_DRAG,this._dragModifyCallback),r.removeEventListener(ee.MOUSE_CLICK,this._endCallback),r.removeEventListener(ee.TOUCH_END,this._endCallback),r.removeEventListener(ee.TOUCH_DRAG,this._dragModifyCallback),r.removeEventListener(ee.TOUCH_TAP,this._endCallback)},this._activateDraw=r=>{Mt.isInteractingWithTool=!0,r.addEventListener(ee.MOUSE_UP,this._endCallback),r.addEventListener(ee.MOUSE_DRAG,this._dragDrawCallback),r.addEventListener(ee.MOUSE_MOVE,this._dragDrawCallback),r.addEventListener(ee.MOUSE_CLICK,this._endCallback),r.addEventListener(ee.TOUCH_END,this._endCallback),r.addEventListener(ee.TOUCH_DRAG,this._dragDrawCallback),r.addEventListener(ee.TOUCH_TAP,this._endCallback)},this._deactivateDraw=r=>{Mt.isInteractingWithTool=!1,r.removeEventListener(ee.MOUSE_UP,this._endCallback),r.removeEventListener(ee.MOUSE_DRAG,this._dragDrawCallback),r.removeEventListener(ee.MOUSE_MOVE,this._dragDrawCallback),r.removeEventListener(ee.MOUSE_CLICK,this._endCallback),r.removeEventListener(ee.TOUCH_END,this._endCallback),r.removeEventListener(ee.TOUCH_DRAG,this._dragDrawCallback),r.removeEventListener(ee.TOUCH_TAP,this._endCallback)},this.renderAnnotation=(r,i)=>{let a=!1;const{viewport:o}=r,{element:s}=o;let l=Wi(this.getToolName(),s);if(!l?.length||(l=this.filterInteractableAnnotationsForElement(s,l),!l?.length))return a;const c=this.getTargetId(o),f=o.getRenderingEngine(),u={toolGroupId:this.toolGroupId,toolName:this.getToolName(),viewportId:r.viewport.id};for(let d=0;d<l.length;d++){const h=l[d],{annotationUID:p,data:g}=h,{handles:m}=g,{points:y,activeHandleIndex:v}=m;u.annotationUID=p;const{color:x,lineWidth:w,lineDash:S}=this.getAnnotationStyle({annotation:h,styleSpecifier:u}),T=y.map(Q=>o.worldToCanvas(Q)),_=LV(T),{centerPointRadius:D}=this.configuration;if(!g.cachedStats[c]||g.cachedStats[c].areaUnit==null)g.cachedStats[c]={Modality:null,area:null,max:null,mean:null,stdDev:null,areaUnit:null},this._calculateCachedStats(h,o,f);else if(h.invalidated&&(this._throttledCalculateCachedStats(h,o,f,r),o instanceof oa)){const{referencedImageId:Q}=h.metadata;for(const re in g.cachedStats)re.startsWith("imageId")&&f.getStackViewports().find(Ce=>{const we=mi(Q),Ae=Ce.hasImageURI(we),De=mi(Ce.getCurrentImageId());return Ae&&De!==we})&&delete g.cachedStats[re]}if(!o.getRenderingEngine())return console.warn("Rendering Engine has been destroyed"),a;let I;if(!fo(p))continue;!uo(p)&&!this.editData&&v!==null&&(I=[T[v]]),I&&ho(i,p,"0",I,{color:x});const R=`${p}-ellipse`,M="0";if(iPe(i,p,M,T,{color:x,lineDash:S,lineWidth:w},R),D>0&&Math.min(Math.abs(_[0][0]-_[1][0])/2,Math.abs(_[0][1]-_[1][1])/2)>3*D){const re=this._getCanvasEllipseCenter(T);S0(i,p,`${M}-center`,re,D,{color:x,lineDash:S,lineWidth:w})}a=!0;const A=this.getLinkedTextBoxStyle(u,h);if(!A.visibility){g.handles.textBox={hasMoved:!1,worldPosition:[0,0,0],worldBoundingBox:{topLeft:[0,0,0],topRight:[0,0,0],bottomLeft:[0,0,0],bottomRight:[0,0,0]}};continue}const L=this.configuration.getTextLines(g,c);if(!L||L.length===0)continue;let P;g.handles.textBox.hasMoved||(P=Du(_),g.handles.textBox.worldPosition=o.canvasToWorld(P));const B=o.worldToCanvas(g.handles.textBox.worldPosition),G=rl(i,p,"1",L,B,T,{},A),{x:F,y:$,width:V,height:X}=G;g.handles.textBox.worldBoundingBox={topLeft:o.canvasToWorld([F,$]),topRight:o.canvasToWorld([F+V,$]),bottomLeft:o.canvasToWorld([F,$+X]),bottomRight:o.canvasToWorld([F+V,$+X])}}return a},this._calculateCachedStats=(r,i,a)=>{if(!this.configuration.calculateStats)return;const o=r.data,{element:s}=i,{points:l}=o.handles,c=l.map(S=>i.worldToCanvas(S)),{viewPlaneNormal:f,viewUp:u}=i.getCamera(),[d,h]=LV(c),p=i.canvasToWorld(d),g=i.canvasToWorld(h),{cachedStats:m}=o,y=Object.keys(m),v=p,x=g;for(let S=0;S<y.length;S++){const T=y[S],_=this.getTargetImageData(T);if(!_)continue;const{dimensions:D,imageData:I,metadata:R,voxelManager:M}=_,A=_F(I,v);A[0]=Math.floor(A[0]),A[1]=Math.floor(A[1]),A[2]=Math.floor(A[2]);const L=_F(I,x);L[0]=Math.floor(L[0]),L[1]=Math.floor(L[1]),L[2]=Math.floor(L[2]),this.isHandleOutsideImage=!this._isInsideVolume(A,L,D);const P=Math.min(A[0],L[0]),B=Math.max(A[0],L[0]),U=Math.min(A[1],L[1]),G=Math.max(A[1],L[1]),F=Math.min(A[2],L[2]),$=Math.max(A[2],L[2]),V=[[P,B],[U,G],[F,$]],Q={center:[(p[0]+g[0])/2,(p[1]+g[1])/2,(p[2]+g[2])/2],xRadius:Math.abs(p[0]-g[0])/2,yRadius:Math.abs(p[1]-g[1])/2,zRadius:Math.abs(p[2]-g[2])/2},{worldWidth:re,worldHeight:ye}=GQ(f,u,v,x),me=re===0&&ye===0,Ce=[A,L],{scale:we,areaUnit:Ae}=vc(_,Ce),De=Math.abs(Math.PI*(re/2)*(ye/2))/we/we,q={isPreScaled:qm(i,T),isSuvScaled:this.isSuvScaled(i,T,r.metadata.referencedImageId)},k=mp(R.Modality,r.metadata.referencedImageId,q);let J;M&&M.forEach(this.configuration.statsCalculator.statsCallback,{boundsIJK:V,imageData:I,isInObject:ie=>TQ(Q,ie,{fast:!0}),returnPoints:this.configuration.storePointData});const Y=this.configuration.statsCalculator.getStatistics();m[T]={Modality:R.Modality,area:De,mean:Y.mean?.value,max:Y.max?.value,min:Y.min?.value,stdDev:Y.stdDev?.value,statsArray:Y.array,pointsInShape:J,isEmptyArea:me,areaUnit:Ae,modalityUnit:k}}const w=r.invalidated;return r.invalidated=!1,w&&Fn(r,s,wn.StatsUpdated),m},this._isInsideVolume=(r,i,a)=>xa(r,a)&&xa(i,a),this._throttledCalculateCachedStats=Bl(this._calculateCachedStats,100,{trailing:!0})}_pointInEllipseCanvas(e,n){const{xRadius:r,yRadius:i,center:a,angle:o}=e,s=lye(Hn(),n,a,-o);if(r<=0||i<=0)return!1;const l=[s[0]-a[0],s[1]-a[1]];return l[0]*l[0]/(r*r)+l[1]*l[1]/(i*i)<=1}_getCanvasEllipseCenter(e){const[n,r,i,a]=e,o=[i[0],r[1]],s=[a[0],n[1]];return[(o[0]+s[0])/2,(o[1]+s[1])/2]}};Ag.toolName="EllipticalROI",Ag.hydrate=(e,n,r)=>{const i=mr(e);if(!i)return;const{FrameOfReferenceUID:a,referencedImageId:o,viewPlaneNormal:s,instance:l,viewport:c}=Ag.hydrateBase(Ag,i,n,r),{toolInstance:f,...u}=r||{},d={annotationUID:r?.annotationUID||or(),data:{handles:{points:n,activeHandleIndex:null},label:"",cachedStats:{}},highlighted:!1,autoGenerated:!1,invalidated:!1,isLocked:!1,isVisible:!0,metadata:{toolName:l.getToolName(),viewPlaneNormal:s,FrameOfReferenceUID:a,referencedImageId:o,...u}};hr(d,c.element),ut([c.id])};let Pd=Ag;function lUe(t,e){const n=t.cachedStats[e],{area:r,mean:i,stdDev:a,max:o,isEmptyArea:s,areaUnit:l,modalityUnit:c,min:f}=n,u=[];if(li(r)){const d=s?"Area: Oblique not supported":`Area: ${kn(r)} ${l}`;u.push(d)}return li(i)&&u.push(`Mean: ${kn(i)} ${c}`),li(o)&&u.push(`Max: ${kn(o)} ${c}`),li(f)&&u.push(`Min: ${kn(f)} ${c}`),li(a)&&u.push(`Std Dev: ${kn(a)} ${c}`),u}const{transformWorldToIndex:DF}=Hr,Pg=class Pg extends na{constructor(e={},n={supportedInteractionTypes:["Mouse","Touch"],configuration:{shadow:!0,preventHandleOutsideImage:!1,storePointData:!1,centerPointRadius:0,calculateStats:!0,getTextLines:cUe,statsCalculator:w0,simplified:!0}}){super(e,n),this.isHandleOutsideImage=!1,this.addNewAnnotation=r=>{const i=r.detail,{currentPoints:a,element:o}=i,s=a.world,l=et(o),{viewport:c}=l;this.isDrawing=!0;const f=c.getCamera(),{viewPlaneNormal:u,viewUp:d}=f,h=this.getReferencedImageId(c,s,u,d),p=c.getFrameOfReferenceUID();let g;this.configuration.simplified?g=[[...s],[...s]]:g=[[...s],[...s],[...s],[...s],[...s]];const m={highlighted:!0,invalidated:!0,metadata:{toolName:this.getToolName(),viewPlaneNormal:[...u],viewUp:[...d],FrameOfReferenceUID:p,referencedImageId:h,...c.getViewReference({points:[s]})},data:{label:"",handles:{textBox:{hasMoved:!1,worldPosition:[0,0,0],worldBoundingBox:{topLeft:[0,0,0],topRight:[0,0,0],bottomLeft:[0,0,0],bottomRight:[0,0,0]}},points:g,activeHandleIndex:null},cachedStats:{}}};hr(m,o);const y=fn(o,this.getToolName());return this.editData={annotation:m,viewportIdsToRender:y,newAnnotation:!0,hasMoved:!1},this._activateDraw(o),Rn(o),r.preventDefault(),ut(y),m},this.isPointNearTool=(r,i,a,o)=>{const s=et(r),{viewport:l}=s,{points:c}=i.data.handles,f=c.map(p=>l.worldToCanvas(p)),u=f[0],d=Gv([u,f[1]]),h=Gv([u,a]);return Math.abs(h-d)<o/2},this.toolSelectedCallback=(r,i)=>{const a=r.detail,{element:o}=a;i.highlighted=!0;const s=fn(o,this.getToolName());this.editData={annotation:i,viewportIdsToRender:s,movingTextBox:!1},Rn(o),this._activateModify(o),ut(s),r.preventDefault()},this.handleSelectedCallback=(r,i,a)=>{const o=r.detail,{element:s}=o,{data:l}=i;i.highlighted=!0;let c=!1,f;if(a.worldPosition)c=!0;else{const{points:d}=l.handles;f=d.findIndex(h=>h===a)}const u=fn(s,this.getToolName());this.editData={annotation:i,viewportIdsToRender:u,handleIndex:f,movingTextBox:c},this._activateModify(s),Rn(s),ut(u),r.preventDefault()},this._endCallback=r=>{const i=r.detail,{element:a}=i,{annotation:o,viewportIdsToRender:s,newAnnotation:l,hasMoved:c}=this.editData,{data:f}=o;l&&!c||(this.doneEditMemo(),o.highlighted=!1,f.handles.activeHandleIndex=null,this._deactivateModify(a),this._deactivateDraw(a),Kn(a),this.editData=null,this.isDrawing=!1,this.isHandleOutsideImage&&this.configuration.preventHandleOutsideImage&&Cr(o.annotationUID),ut(s),l&&Wr(o))},this._dragDrawCallback=r=>{this.isDrawing=!0;const i=r.detail,{element:a,currentPoints:o}=i,{world:s,canvas:l}=o,c=et(a),{viewport:f}=c,{canvasToWorld:u}=f,{annotation:d,viewportIdsToRender:h,newAnnotation:p}=this.editData;this.createMemo(a,d,{newAnnotation:p});const{data:g}=d,m=g.handles.points[0],y=f.worldToCanvas(m);if(this.configuration.simplified)g.handles.points[1]=s;else{const v=ei(y,l);g.handles.points[0]=[...m],g.handles.points[1]=u([y[0],y[1]-v]),g.handles.points[2]=u([y[0],y[1]+v]),g.handles.points[3]=u([y[0]-v,y[1]]),g.handles.points[4]=u([y[0]+v,y[1]])}d.invalidated=!0,this.editData.hasMoved=!0,ut(h),Fn(d,a,wn.HandlesUpdated)},this._dragModifyCallback=r=>{this.isDrawing=!0;const i=r.detail,{element:a}=i,{annotation:o,viewportIdsToRender:s,handleIndex:l,movingTextBox:c,newAnnotation:f}=this.editData;this.createMemo(a,o,{newAnnotation:f});const{data:u}=o;if(c){const{deltaPoints:d}=i,h=d.world,{textBox:p}=u.handles,{worldPosition:g}=p;g[0]+=h[0],g[1]+=h[1],g[2]+=h[2],p.hasMoved=!0}else if(l===void 0){const{deltaPoints:d}=i,h=d.world;u.handles.points.forEach(g=>{g[0]+=h[0],g[1]+=h[1],g[2]+=h[2]}),o.invalidated=!0}else this._dragHandle(r),o.invalidated=!0;ut(s),o.invalidated&&Fn(o,a,wn.HandlesUpdated)},this._dragHandle=r=>{const i=r.detail,{element:a}=i,o=et(a),{canvasToWorld:s,worldToCanvas:l}=o.viewport,{annotation:c,handleIndex:f}=this.editData,{data:u}=c,{points:d}=u.handles,{currentPoints:h,deltaPoints:p}=i;if(f===0){const g=p.world;d.forEach(m=>{Nl(m,m,g)})}else{const g=d[0],m=l(g),y=h.canvas,v=ei(m,y);d[1]=s([m[0],m[1]-v]),d[2]=s([m[0],m[1]+v]),d[3]=s([m[0]-v,m[1]]),d[4]=s([m[0]+v,m[1]])}c.invalidated=!0},this.cancel=r=>{if(this.isDrawing){this.isDrawing=!1,this._deactivateDraw(r),this._deactivateModify(r),Kn(r);const{annotation:i,viewportIdsToRender:a,newAnnotation:o}=this.editData;return i.highlighted=!1,i.data.handles.activeHandleIndex=null,ut(a),o&&Wr(i),this.editData=null,i.annotationUID}},this._activateModify=r=>{Mt.isInteractingWithTool=!0,r.addEventListener(ee.MOUSE_UP,this._endCallback),r.addEventListener(ee.MOUSE_DRAG,this._dragModifyCallback),r.addEventListener(ee.MOUSE_CLICK,this._endCallback),r.addEventListener(ee.TOUCH_END,this._endCallback),r.addEventListener(ee.TOUCH_DRAG,this._dragModifyCallback),r.addEventListener(ee.TOUCH_TAP,this._endCallback)},this._deactivateModify=r=>{Mt.isInteractingWithTool=!1,r.removeEventListener(ee.MOUSE_UP,this._endCallback),r.removeEventListener(ee.MOUSE_DRAG,this._dragModifyCallback),r.removeEventListener(ee.MOUSE_CLICK,this._endCallback),r.removeEventListener(ee.TOUCH_END,this._endCallback),r.removeEventListener(ee.TOUCH_DRAG,this._dragModifyCallback),r.removeEventListener(ee.TOUCH_TAP,this._endCallback)},this._activateDraw=r=>{Mt.isInteractingWithTool=!0,r.addEventListener(ee.MOUSE_UP,this._endCallback),r.addEventListener(ee.MOUSE_DRAG,this._dragDrawCallback),r.addEventListener(ee.MOUSE_MOVE,this._dragDrawCallback),r.addEventListener(ee.MOUSE_CLICK,this._endCallback),r.addEventListener(ee.TOUCH_END,this._endCallback),r.addEventListener(ee.TOUCH_DRAG,this._dragDrawCallback),r.addEventListener(ee.TOUCH_TAP,this._endCallback)},this._deactivateDraw=r=>{Mt.isInteractingWithTool=!1,r.removeEventListener(ee.MOUSE_UP,this._endCallback),r.removeEventListener(ee.MOUSE_DRAG,this._dragDrawCallback),r.removeEventListener(ee.MOUSE_MOVE,this._dragDrawCallback),r.removeEventListener(ee.MOUSE_CLICK,this._endCallback),r.removeEventListener(ee.TOUCH_END,this._endCallback),r.removeEventListener(ee.TOUCH_DRAG,this._dragDrawCallback),r.removeEventListener(ee.TOUCH_TAP,this._endCallback)},this.renderAnnotation=(r,i)=>{let a=!1;const{viewport:o}=r,{element:s}=o;let l=Wi(this.getToolName(),s);if(!l?.length||(l=this.filterInteractableAnnotationsForElement(s,l),!l?.length))return a;const c=this.getTargetId(o),f=o.getRenderingEngine(),u={toolGroupId:this.toolGroupId,toolName:this.getToolName(),viewportId:r.viewport.id};for(let d=0;d<l.length;d++){const h=l[d],{annotationUID:p,data:g}=h,{handles:m}=g,{points:y,activeHandleIndex:v}=m;u.annotationUID=p;const{color:x,lineWidth:w,lineDash:S}=this.getAnnotationStyle({annotation:h,styleSpecifier:u}),T=y.map(P=>o.worldToCanvas(P)),_=T[0],D=Gv([_,T[1]]),I=NV([_,T[1]]),{centerPointRadius:R}=this.configuration;if(!g.cachedStats[c]||g.cachedStats[c].areaUnit==null)g.cachedStats[c]={Modality:null,area:null,max:null,mean:null,stdDev:null,areaUnit:null,radius:null,radiusUnit:null,perimeter:null},this._calculateCachedStats(h,o,f,r);else if(h.invalidated&&(this._throttledCalculateCachedStats(h,o,f,r),o instanceof oa)){const{referencedImageId:P}=h.metadata;for(const B in g.cachedStats)B.startsWith("imageId")&&f.getStackViewports().find(F=>{const $=mi(P),V=F.hasImageURI($),X=mi(F.getCurrentImageId());return V&&X!==$})&&delete g.cachedStats[B]}if(!o.getRenderingEngine())return console.warn("Rendering Engine has been destroyed"),a;let M;if(!fo(p))continue;!uo(p)&&!this.editData&&v!==null&&(this.configuration.simplified?M=[T[v]]:M=T),M&&ho(i,p,"0",M,{color:x});const A=`${p}-circle`,L="0";if(S0(i,p,L,_,D,{color:x,lineDash:S,lineWidth:w},A),R>0&&D>3*R&&S0(i,p,`${L}-center`,_,R,{color:x,lineDash:S,lineWidth:w}),a=!0,this.configuration.calculateStats){const P=this.getLinkedTextBoxStyle(u,h);if(!P.visibility){g.handles.textBox={hasMoved:!1,worldPosition:[0,0,0],worldBoundingBox:{topLeft:[0,0,0],topRight:[0,0,0],bottomLeft:[0,0,0],bottomRight:[0,0,0]}};continue}const B=this.configuration.getTextLines(g,c);if(!B||B.length===0)continue;let U;g.handles.textBox.hasMoved||(U=Du(I),g.handles.textBox.worldPosition=o.canvasToWorld(U));const G=o.worldToCanvas(g.handles.textBox.worldPosition),$=rl(i,p,"1",B,G,[_,T[1]],{},P),{x:V,y:X,width:Q,height:re}=$;g.handles.textBox.worldBoundingBox={topLeft:o.canvasToWorld([V,X]),topRight:o.canvasToWorld([V+Q,X]),bottomLeft:o.canvasToWorld([V,X+re]),bottomRight:o.canvasToWorld([V+Q,X+re])}}}return a},this._calculateCachedStats=(r,i,a,o)=>{if(!this.configuration.calculateStats)return;const s=r.data,{element:l}=i,c=r.invalidated,{points:f}=s.handles,u=f.map(D=>i.worldToCanvas(D)),d=u[0],h=u[1],{viewPlaneNormal:p,viewUp:g}=i.getCamera(),[m,y]=NV([d,h]),v=i.canvasToWorld(m),x=i.canvasToWorld(y),{cachedStats:w}=s,S=Object.keys(w),T=v,_=x;for(let D=0;D<S.length;D++){const I=S[D],R=this.getTargetImageData(I);if(!R)continue;const{dimensions:M,imageData:A,metadata:L,voxelManager:P}=R,B=DF(A,T);B[0]=Math.floor(B[0]),B[1]=Math.floor(B[1]),B[2]=Math.floor(B[2]);const U=DF(A,_);if(U[0]=Math.floor(U[0]),U[1]=Math.floor(U[1]),U[2]=Math.floor(U[2]),this._isInsideVolume(B,U,M)){const G=Math.min(B[0],U[0]),F=Math.max(B[0],U[0]),$=Math.min(B[1],U[1]),V=Math.max(B[1],U[1]),X=Math.min(B[2],U[2]),Q=Math.max(B[2],U[2]),re=[[G,F],[$,V],[X,Q]],ye=f[0],me=Math.abs(v[0]-x[0])/2,Ce=Math.abs(v[1]-x[1])/2,we=Math.abs(v[2]-x[2])/2,Ae={center:ye,xRadius:me<Yg/2?0:me,yRadius:Ce<Yg/2?0:Ce,zRadius:we<Yg/2?0:we},{worldWidth:De,worldHeight:q}=GQ(p,g,T,_),k=De===0&&q===0,J=[B,U],{scale:Y,unit:ie,areaUnit:ue}=vc(R,J),fe=pNe(R),Se=Math.abs(Math.PI*(De/Y/2)*(q/fe/Y/2)),Fe={isPreScaled:qm(i,I),isSuvScaled:this.isSuvScaled(i,I,r.metadata.referencedImageId)},Ke=mp(L.Modality,r.metadata.referencedImageId,Fe);let He;P&&(He=P.forEach(this.configuration.statsCalculator.statsCallback,{isInObject:ge=>TQ(Ae,ge,{fast:!0}),boundsIJK:re,imageData:A,returnPoints:this.configuration.storePointData}));const pe=this.configuration.statsCalculator.getStatistics();w[I]={Modality:L.Modality,area:Se,mean:pe.mean?.value,max:pe.max?.value,min:pe.min?.value,pointsInShape:He,stdDev:pe.stdDev?.value,statsArray:pe.array,isEmptyArea:k,areaUnit:ue,radius:De/2/Y,radiusUnit:ie,perimeter:2*Math.PI*(De/2)/Y,modalityUnit:Ke}}else this.isHandleOutsideImage=!0,w[I]={Modality:L.Modality}}return r.invalidated=!1,c&&Fn(r,l,wn.StatsUpdated),w},this._isInsideVolume=(r,i,a)=>xa(r,a)&&xa(i,a),this._throttledCalculateCachedStats=Bl(this._calculateCachedStats,100,{trailing:!0})}};Pg.toolName="CircleROI",Pg.hydrate=(e,n,r)=>{const i=mr(e);if(!i)return;const{FrameOfReferenceUID:a,referencedImageId:o,viewPlaneNormal:s,instance:l,viewport:c}=Pg.hydrateBase(Pg,i,n,r),{toolInstance:f,...u}=r||{},d={annotationUID:r?.annotationUID||or(),data:{handles:{points:n,textBox:{hasMoved:!1,worldPosition:[0,0,0],worldBoundingBox:{topLeft:[0,0,0],topRight:[0,0,0],bottomLeft:[0,0,0],bottomRight:[0,0,0]}},activeHandleIndex:null},label:"",cachedStats:{}},highlighted:!1,autoGenerated:!1,invalidated:!1,isLocked:!1,isVisible:!0,metadata:{toolName:l.getToolName(),viewPlaneNormal:s,FrameOfReferenceUID:a,referencedImageId:o,...u}};hr(d,c.element),ut([c.id])};let Nd=Pg;function cUe(t,e){const n=t.cachedStats[e],{radius:r,radiusUnit:i,area:a,mean:o,stdDev:s,max:l,min:c,isEmptyArea:f,areaUnit:u,modalityUnit:d}=n,h=[];if(li(r)){const p=f?"Radius: Oblique not supported":`Radius: ${kn(r)} ${i}`;h.push(p)}if(li(a)){const p=f?"Area: Oblique not supported":`Area: ${kn(a)} ${u}`;h.push(p)}return li(o)&&h.push(`Mean: ${kn(o)} ${d}`),li(l)&&h.push(`Max: ${kn(l)} ${d}`),li(c)&&h.push(`Min: ${kn(c)} ${d}`),li(s)&&h.push(`Std Dev: ${kn(s)} ${d}`),h}const OF=3,MF=10,uUe={resolution:20,controlPointAdditionDistance:6,controlPointDeletionDistance:6,showControlPointsConnectors:!1,controlPointAdditionEnabled:!0,controlPointDeletionEnabled:!0};var cf;(function(t){t.Cardinal="CARDINAL",t.Linear="LINEAR",t.CatmullRom="CATMULLROM",t.BSpline="BSPLINE"})(cf||(cf={}));var zv;(function(t){t.AddControlPoint="addControlPoint",t.DeleteControlPoint="deleteControlPoint"})(zv||(zv={}));const fUe=["CatmullRomSplineROI","LinearSplineROI","BSplineROI","CardinalSplineROI"],Gd=class Gd extends k2{constructor(e={},n={supportedInteractionTypes:["Mouse","Touch"],configuration:{preventHandleOutsideImage:!1,calculateStats:!0,simplifiedSpline:!1,getTextLines:dUe,contourHoleAdditionModifierKey:Ia.Shift,decimate:{enabled:!1,epsilon:.1},spline:{configuration:{[cf.Cardinal]:{Class:nw,scale:.5},[cf.CatmullRom]:{Class:qFe},[cf.Linear]:{Class:XFe},[cf.BSpline]:{Class:KFe,controlPointAdditionEnabled:!1,controlPointDeletionEnabled:!1,showControlPointsConnectors:!0}},type:cf.CatmullRom,drawPreviewEnabled:!0,enableTwoPointPreview:!1,lastControlPointDeletionKeys:["Backspace","Delete"]},actions:{[zv.AddControlPoint]:{method:"addControlPointCallback",bindings:[{mouseButton:yu.Primary,modifierKey:Ia.Shift}]},[zv.DeleteControlPoint]:{method:"deleteControlPointCallback",bindings:[{mouseButton:yu.Primary,modifierKey:Ia.Ctrl}]}}}}){super(e,n),this.splineToolNames=["CatmullRomSplineROI","LinearSplineROI","BSplineROI","CardinalSplineROI"],this.isHandleOutsideImage=!1,this.fireChangeOnUpdate=null,this.isPointNearTool=(r,i,a,o)=>{const{instance:s}=i.data.spline;return s.isPointNearCurve(a,o)},this.toolSelectedCallback=(r,i)=>{const a=r.detail,{element:o}=a;i.highlighted=!0;const s=fn(o,this.getToolName());this.editData={annotation:i,viewportIdsToRender:s,movingTextBox:!1},this._activateModify(o),ut(s),r.preventDefault()},this.handleSelectedCallback=(r,i,a)=>{const o=r.detail,{element:s}=o,{data:l}=i;i.highlighted=!0;let c=!1,f;if(a.worldPosition)c=!0;else{const{points:d}=l.handles;f=d.findIndex(h=>h===a)}const u=fn(s,this.getToolName());this.editData={annotation:i,viewportIdsToRender:u,handleIndex:f,movingTextBox:c},this._activateModify(s),ut(u),r.preventDefault()},this._endCallback=r=>{const i=r.detail,{element:a}=i,{annotation:o,viewportIdsToRender:s,newAnnotation:l,contourHoleProcessingEnabled:c}=this.editData,{data:f}=o;o.autoGenerated=!1,f.handles.activeHandleIndex=null,this._deactivateModify(a),this._deactivateDraw(a),Kn(a);const u=et(a),d=this.getTargetImageData(this.getTargetId(u.viewport)),{imageData:h,dimensions:p}=d;this.isHandleOutsideImage=f.handles.points.map(m=>io(h,m)).some(m=>!xa(m,p)),this.isHandleOutsideImage&&this.configuration.preventHandleOutsideImage&&Cr(o.annotationUID);const g=l?wn.Completed:wn.HandlesUpdated;this.fireChangeOnUpdate?(this.fireChangeOnUpdate.annotationUID=o.annotationUID,this.fireChangeOnUpdate.changeType=g):this.fireChangeOnUpdate={annotationUID:o.annotationUID,changeType:g,contourHoleProcessingEnabled:c},ut(s),this.doneEditMemo(),this.editData=null,this.isDrawing=!1},this._keyDownCallback=r=>{const i=r.detail,{element:a}=i,o=i.key??"",{lastControlPointDeletionKeys:s}=this.configuration.spline;if(!s.includes(o))return;const{annotation:c}=this.editData,{data:f}=c;if(f.handles.points.length===OF){this.cancel(a);return}else{const u=f.handles.points.length-1;this._deleteControlPointByIndex(a,c,u)}r.preventDefault()},this._mouseMoveCallback=r=>{const{drawPreviewEnabled:i}=this.configuration.spline;if(!i)return;const{element:a}=r.detail,{renderingEngine:o}=et(a),s=fn(a,this.getToolName());this.editData.lastCanvasPoint=r.detail.currentPoints.canvas,ut(s),r.preventDefault()},this._mouseDownCallback=r=>{const i=r.type===ee.MOUSE_DOUBLE_CLICK,{annotation:a,viewportIdsToRender:o}=this.editData,{data:s}=a;if(s.contour.closed)return;this.doneEditMemo();const l=r.detail,{currentPoints:c,element:f}=l,{canvas:u,world:d}=c;let h=s.handles.points.length>=2&&i,p=!0;if(s.handles.points.length&&this.createMemo(f,a,{newAnnotation:s.handles.points.length===1}),s.handles.points.length>=3){this.createMemo(f,a);const{instance:g}=s.spline;g.getClosestControlPointWithinDistance(u,MF)?.index===0&&(p=!1,h=!0)}p&&s.handles.points.push(d),s.contour.closed=s.contour.closed||h,a.invalidated=!0,ut(o),s.contour.closed&&this._endCallback(r),r.preventDefault()},this._dragCallback=r=>{this.isDrawing=!0;const i=r.detail,{element:a}=i,{annotation:o,viewportIdsToRender:s,handleIndex:l,movingTextBox:c,newAnnotation:f}=this.editData,{data:u}=o;if(this.createMemo(a,o,{newAnnotation:f}),c){const{deltaPoints:p}=i,g=p.world,{textBox:m}=u.handles,{worldPosition:y}=m;y[0]+=g[0],y[1]+=g[1],y[2]+=g[2],m.hasMoved=!0}else if(l===void 0){const{deltaPoints:p}=i,g=p.world;this.moveAnnotation(o,g)}else{const{currentPoints:p}=i,g=p.world;u.handles.points[l]=[...g],o.invalidated=!0}this.editData.hasMoved=!0;const d=et(a),{renderingEngine:h}=d;ut(s)},this.triggerAnnotationCompleted=(r,i)=>{const a=ee.ANNOTATION_COMPLETED,o={annotation:r,changeType:wn.Completed,contourHoleProcessingEnabled:i};Ct(St,a,o)},this.triggerAnnotationModified=(r,i,a=wn.StatsUpdated)=>{const{viewportId:o,renderingEngineId:s}=i,l=ee.ANNOTATION_MODIFIED;Ct(St,l,{annotation:r,viewportId:o,renderingEngineId:s,changeType:a})},this.triggerChangeEvent=(r,i,a=wn.StatsUpdated,o)=>{a===wn.Completed?this.triggerAnnotationCompleted(r,o):this.triggerAnnotationModified(r,i,a)},this._activateModify=r=>{Mt.isInteractingWithTool=!0,r.addEventListener(ee.MOUSE_UP,this._endCallback),r.addEventListener(ee.MOUSE_DRAG,this._dragCallback),r.addEventListener(ee.MOUSE_CLICK,this._endCallback),r.addEventListener(ee.TOUCH_END,this._endCallback),r.addEventListener(ee.TOUCH_DRAG,this._dragCallback),r.addEventListener(ee.TOUCH_TAP,this._endCallback)},this._deactivateModify=r=>{Mt.isInteractingWithTool=!1,r.removeEventListener(ee.MOUSE_UP,this._endCallback),r.removeEventListener(ee.MOUSE_DRAG,this._dragCallback),r.removeEventListener(ee.MOUSE_CLICK,this._endCallback),r.removeEventListener(ee.TOUCH_END,this._endCallback),r.removeEventListener(ee.TOUCH_DRAG,this._dragCallback),r.removeEventListener(ee.TOUCH_TAP,this._endCallback)},this._activateDraw=r=>{Mt.isInteractingWithTool=!0,r.addEventListener(ee.KEY_DOWN,this._keyDownCallback),r.addEventListener(ee.MOUSE_MOVE,this._mouseMoveCallback),r.addEventListener(ee.MOUSE_DOWN,this._mouseDownCallback),r.addEventListener(ee.MOUSE_DOUBLE_CLICK,this._mouseDownCallback),r.addEventListener(ee.TOUCH_TAP,this._mouseDownCallback)},this._deactivateDraw=r=>{Mt.isInteractingWithTool=!1,r.removeEventListener(ee.KEY_DOWN,this._keyDownCallback),r.removeEventListener(ee.MOUSE_MOVE,this._mouseMoveCallback),r.removeEventListener(ee.MOUSE_DOWN,this._mouseDownCallback),r.removeEventListener(ee.MOUSE_DOUBLE_CLICK,this._mouseDownCallback),r.removeEventListener(ee.TOUCH_TAP,this._mouseDownCallback)},this._renderStats=(r,i,a,o)=>{const s=r.data,l=this.getTargetId(i);if(!s.spline.instance.closed||!o.visibility)return;const c=this.configuration.getTextLines(s,l);if(!c||c.length===0)return;const f=s.handles.points.map(v=>i.worldToCanvas(v));if(!s.handles.textBox.hasMoved){const v=Du(f);s.handles.textBox.worldPosition=i.canvasToWorld(v)}const u=i.worldToCanvas(s.handles.textBox.worldPosition),h=rl(a,r.annotationUID??"","textBox",c,u,f,{},o),{x:p,y:g,width:m,height:y}=h;s.handles.textBox.worldBoundingBox={topLeft:i.canvasToWorld([p,g]),topRight:i.canvasToWorld([p+m,g]),bottomLeft:i.canvasToWorld([p,g+y]),bottomRight:i.canvasToWorld([p+m,g+y])}},this.addControlPointCallback=(r,i)=>{const{data:a}=i,o=a.spline.type,s=this._getSplineConfig(o),l=s.controlPointAdditionDistance;if(s.controlPointAdditionEnabled===!1)return;const c=r.detail,{element:f}=c,u=et(f),{renderingEngine:d,viewport:h}=u,{canvasToWorld:p}=h,{instance:g}=a.spline,m=r.detail.currentPoints.canvas,y=g.getClosestPoint(m);if(y.distance>l)return;const{index:v,point:x}=g.addControlPointAtU(y.uValue);a.handles.points.splice(v,0,p(x)),i.invalidated=!0;const w=fn(f,this.getToolName());ut(w)},this.deleteControlPointCallback=(r,i)=>{const a=i.data.spline.type,o=this._getSplineConfig(a),s=o.controlPointDeletionDistance;if(o.controlPointDeletionEnabled===!1)return;const l=r.detail,{element:c,currentPoints:f}=l,{canvas:u}=f,{instance:d}=i.data.spline,h=d.getClosestControlPointWithinDistance(u,s);h&&this._deleteControlPointByIndex(c,i,h.index)},this._calculateCachedStats=(r,i)=>{if(!this.configuration.calculateStats)return;const a=r.data;if(!a.contour.closed)return;const o=et(i);if(!o)return;const{viewport:s}=o,{cachedStats:l}=a,{polyline:c}=a.contour,f=Object.keys(l);for(let d=0;d<f.length;d++){const h=f[d],p=this.getTargetImageData(h);if(!p)continue;const{metadata:g}=p,m=c.map(M=>s.worldToCanvas(M)),y=m[0],v=s.canvasToWorld(y),x=s.canvasToWorld([y[0]+1,y[1]]),w=s.canvasToWorld([y[0],y[1]+1]),S=el(v,x),T=el(v,w),{imageData:_}=p,{scale:D,areaUnit:I}=vc(p,()=>{const{maxX:M,maxY:A,minX:L,minY:P}=mm(m),B=s.canvasToWorld([L,P]),U=io(_,B),G=s.canvasToWorld([M,A]),F=io(_,G);return[U,F]});let R=vy(m)/D/D;R*=S*T,l[h]={Modality:g.Modality,area:R,areaUnit:I}}const u=r.invalidated;return r.invalidated=!1,u&&this.triggerAnnotationModified(r,o,wn.StatsUpdated),l},this._throttledCalculateCachedStats=Bl(this._calculateCachedStats,100,{trailing:!0}),this.annotationCompletedBinded=this.annotationCompleted.bind(this)}annotationCompleted(e){const{sourceAnnotation:n}=e.detail;!this.splineToolNames.includes(n?.metadata?.toolName)||!this.configuration.simplifiedSpline||!this.isContourSegmentationTool()||SAe(n)}initializeListeners(){St.addEventListener(ee.ANNOTATION_COMPLETED,this.annotationCompletedBinded)}removeListeners(){St.removeEventListener(ee.ANNOTATION_COMPLETED,this.annotationCompletedBinded)}onSetToolEnabled(){this.initializeListeners()}onSetToolActive(){this.initializeListeners()}onSetToolDisabled(){this.removeListeners()}addNewAnnotation(e){const n=e.detail,{currentPoints:r,element:i}=n,{canvas:a}=r,o=Km(e.detail.event)===this.configuration.contourHoleAdditionModifierKey,s=et(i),{renderingEngine:l}=s,c=this.createAnnotation(e);this.isDrawing=!0,this.addAnnotation(c,i);const f=fn(i,this.getToolName());return this.editData={annotation:c,viewportIdsToRender:f,movingTextBox:!1,newAnnotation:!0,hasMoved:!1,lastCanvasPoint:a,contourHoleProcessingEnabled:o},this._activateDraw(i),e.preventDefault(),ut(f),c}cancel(e){if(!this.isDrawing)return;this.isDrawing=!1,this._deactivateDraw(e),this._deactivateModify(e),Kn(e);const{annotation:n,viewportIdsToRender:r,newAnnotation:i}=this.editData;i&&Cr(n.annotationUID),super.cancelAnnotation(n);const a=et(e),{renderingEngine:o}=a;return ut(r),this.editData=null,n.annotationUID}isContourSegmentationTool(){return!1}renderAnnotationInstance(e){const{enabledElement:n,targetId:r,svgDrawingHelper:i,annotationStyle:a}=e,{viewport:o}=n,{worldToCanvas:s}=o,{element:l}=o,c=e.annotation,{annotationUID:f,data:u,highlighted:d}=c,{handles:h}=u,{points:p,activeHandleIndex:g}=h,m=this.editData?.newAnnotation,{lineWidth:y,lineDash:v,color:x,locked:w}=a,S=p.map(P=>s(P)),{drawPreviewEnabled:T}=this.configuration.spline,_=c.data.spline.type,D=this._getSplineConfig(_),I=c.data.spline.instance,R=py(c);if(R.findIndex(P=>!P)!==-1)throw new Error(`Can't find annotation for child ${c.childAnnotationUIDs.join()}`);[c,...R].filter(P=>this._isSplineROIAnnotation(P)).forEach(P=>{const U=this._updateSplineInstance(l,P).getPolylinePoints();this.updateContourPolyline(P,{points:U,closed:u.contour.closed,targetWindingDirection:Zo.Clockwise},o,{updateWindingDirection:u.contour.closed})}),super.renderAnnotationInstance(e),!u.cachedStats[r]||u.cachedStats[r].areaUnit==null?(u.cachedStats[r]={Modality:null,area:null,areaUnit:null},this._calculateCachedStats(c,l)):c.invalidated&&this._throttledCalculateCachedStats(c,l);let L;if(!w&&!this.editData&&g!==null&&(L=[S[g]]),(L||m||d)&&ho(i,f,"0",S,{color:x,lineWidth:y,handleRadius:"3"}),T&&I.numControlPoints>=1&&this.editData?.lastCanvasPoint&&!I.closed){const{lastCanvasPoint:P}=this.editData,{enableTwoPointPreview:B}=this.configuration.spline;if(I.numControlPoints===1&&B){const G=[S[0],P];Of(i,f,"previewSplineChange",G,{color:"#9EA0CA",lineDash:v,lineWidth:1})}else if(I.numControlPoints>1){const U=I.getPreviewPolylinePoints(P,MF);Of(i,f,"previewSplineChange",U,{color:"#9EA0CA",lineDash:v,lineWidth:1})}}if(D.showControlPointsConnectors){const P=[...S];I.closed&&P.push(S[0]),Of(i,f,"controlPointsConnectors",P,{color:"rgba(255, 255, 255, 0.5)",lineWidth:1})}return this._renderStats(c,o,i,a.textbox),this.fireChangeOnUpdate?.annotationUID===f&&(this.triggerChangeEvent(c,n,this.fireChangeOnUpdate.changeType,this.fireChangeOnUpdate.contourHoleProcessingEnabled),this.fireChangeOnUpdate=null),c.invalidated=!1,!0}createInterpolatedSplineControl(e){if(e.data.handles.points?.length)return;const{polyline:n}=e.data.contour;if(!n||!n.length)return;e.data.handles.points=[];const{points:r}=e.data.handles,i=Math.max(10,Math.floor(n.length/20));for(let a=0;a<n.length-i;a+=i)r.push(n[a]);r.push(n[n.length-1])}isSplineAnnotation(e){return fUe.includes(e?.metadata?.toolName)}createSplineObjectFromType(e,n){const r=this._getSplineConfig(n),i=new r.Class;e.data.spline={type:r.type,instance:i,resolution:r.resolution}}createAnnotation(e){const n=super.createAnnotation(e),{world:r}=e.detail.currentPoints,{type:i}=this.configuration.spline,a=this._getSplineConfig(i),o=new a.Class,s=()=>({type:a.type,instance:o,resolution:a.resolution});let l;return this.configuration.interpolation?.enabled&&(l=c=>{c.data.spline||=s(),this.createInterpolatedSplineControl(c)}),Mo(n,{data:{handles:{points:[[...r]]},spline:s(),cachedStats:{}},onInterpolationComplete:l})}_deleteControlPointByIndex(e,n,r){const i=et(e),{points:a}=n.data.handles;a.length===3?Cr(n.annotationUID):a.splice(r,1);const{renderingEngine:o}=i,s=fn(e,this.getToolName());n.invalidated=!0,ut(s)}_isSplineROIAnnotation(e){return!!e.data?.spline}_getSplineConfig(e){const{configuration:n}=this,r=n.spline.configuration;return Object.assign({type:e},uUe,r[e])}_updateSplineInstance(e,n){const r=et(e),{viewport:i}=r,{worldToCanvas:a}=i,{data:o}=n,{type:s,instance:l}=n.data.spline,c=this._getSplineConfig(s),u=o.handles.points.map(a),d=c.resolution!==void 0?parseInt(c.resolution):void 0,h=c.scale!==void 0?parseFloat(c.scale):void 0;return l.setControlPoints(u),l.closed=!!o.contour.closed,!l.fixedResolution&&d!==void 0&&l.resolution!==d&&(l.resolution=d,n.invalidated=!0),l instanceof nw&&!l.fixedScale&&h!==void 0&&l.scale!==h&&(l.scale=h,n.invalidated=!0),l}};Gd.toolName="SplineROI",Gd.SplineTypes=cf,Gd.Actions=zv,Gd.hydrate=(e,n,r)=>{const i=mr(e);if(!i)return;if(n.length<OF){console.warn("Spline requires at least 3 control points");return}const{FrameOfReferenceUID:a,referencedImageId:o,viewPlaneNormal:s,viewUp:l,instance:c,viewport:f}=Gd.hydrateBase(Gd,i,n,r),u=r?.splineType||cf.CatmullRom,h=c._getSplineConfig(u).Class,p=new h,{toolInstance:g,...m}=r||{},y={annotationUID:r?.annotationUID||or(),data:{handles:{points:n},label:"",cachedStats:{},spline:{type:u,instance:p},contour:{closed:!0}},highlighted:!1,autoGenerated:!1,invalidated:!0,isLocked:!1,isVisible:!0,metadata:{toolName:c.getToolName(),viewPlaneNormal:s,FrameOfReferenceUID:a,referencedImageId:o,...m}};hr(y,f.element),ut([f.id])};let Ld=Gd;function dUe(t,e){const n=t.cachedStats[e],{area:r,isEmptyArea:i,areaUnit:a}=n,o=[];if(r){const s=i?"Area: Oblique not supported":`Area: ${kn(r)} ${a}`;o.push(s)}return o}class hUe{constructor({numBits:e,getPriority:n,areEqual:r}){this._bucketCount=1<<e,this._mask=this._bucketCount-1,this._size=0,this._currentBucketIndex=0,this._buckets=this._buildArray(this._bucketCount),this._getPriority=typeof n<"u"?n:i=>i,this._areEqual=typeof r=="function"?r:(i,a)=>i===a}push(e){const n=this._getBucketIndex(e),r=this._buckets[n],i={value:e,next:r};this._buckets[n]=i,this._size++}pop(){if(this._size===0)throw new Error("Cannot pop because the queue is empty.");for(;this._buckets[this._currentBucketIndex]===null;)this._currentBucketIndex=(this._currentBucketIndex+1)%this._bucketCount;const e=this._buckets[this._currentBucketIndex];return this._buckets[this._currentBucketIndex]=e.next,this._size--,e.value}remove(e){if(!e)return!1;const n=this._getBucketIndex(e),r=this._buckets[n];let i=r,a;for(;i!==null&&!this._areEqual(e,i.value);)a=i,i=i.next;return i===null?!1:(i===r?this._buckets[n]=i.next:a.next=i.next,this._size--,!0)}isEmpty(){return this._size===0}_getBucketIndex(e){return this._getPriority(e)&this._mask}_buildArray(e){const n=new Array(e);return n.fill(null),n}}const G8=4294967295,pUe=2/(3*Math.PI);class rw{constructor(e,n,r){this._getPointIndex=(a,o)=>{const{width:s}=this;return a*s+o},this._getPointCoordinate=a=>{const o=a%this.width,s=Math.floor(a/this.width);return[o,s]},this._getPointCost=a=>Math.round(this.searchGranularity*this.costs[a]);const i=e.length;this.searchGranularityBits=8,this.searchGranularity=1<<this.searchGranularityBits,this.width=n,this.height=r,this.grayscalePixelData=e,this.laplace=null,this.gradXNew=null,this.gradYNew=null,this.laplace=this._computeLaplace(),this.gradMagnitude=this._computeGradient(),this.gradXNew=this._computeGradientX(),this.gradYNew=this._computeGradientY(),this.visited=new Array(i),this.parents=new Uint32Array(i),this.costs=new Float32Array(i)}startSearch(e){const n=this._getPointIndex(e[1],e[0]);this.startPoint=null,this.visited.fill(!1),this.parents.fill(G8),this.costs.fill(1/0),this.priorityQueueNew=new hUe({numBits:this.searchGranularityBits,getPriority:this._getPointCost}),this.startPoint=e,this.costs[n]=0,this.priorityQueueNew.push(n)}findMinNearby(e,n=2){const[r,i]=e,{costs:a}=this,o=[Math.max(0,r-n),Math.min(r+n+1,this.width)],s=[Math.max(0,i-n),Math.min(i+n+1,this.height)];let l=a[this._getPointIndex(i,r)]*.8,c=e;for(let f=o[0];f<o[1];f++)for(let u=s[0];u<s[1];u++){const d=1-(Math.abs(f-e[0])+Math.abs(u-e[1]))/n/2,p=a[this._getPointIndex(u,f)]*.8+d*.2;p<l&&(c=[f,u],l=p)}return c}findPathToPoint(e){if(!this.startPoint)throw new Error("There is no search in progress");const{startPoint:n,_getPointIndex:r,_getPointCoordinate:i}=this,a=r(n[1],n[0]),o=r(e[1],e[0]),{visited:s,parents:l,costs:c,priorityQueueNew:f}=this;if(o===a)return[];for(;!f.isEmpty()&&l[o]===G8;){const h=f.pop();if(s[h])continue;const p=i(h),g=this._getNeighborPoints(p);s[h]=!0;for(let m=0,y=g.length;m<y;m++){const v=g[m],x=r(v[1],v[0]),w=this._getWeightedDistance(p,v),S=c[h]+w;S<c[x]&&(c[x]!==1/0&&f.remove(x),c[x]=S,l[x]=h,f.push(x))}}const u=[];let d=o;for(;d!==G8;)u.push(i(d)),d=l[d];return u.reverse()}_getDeltaX(e,n){const{grayscalePixelData:r,width:i}=this;let a=this._getPointIndex(n,e);return e+1===i&&a--,r[a+1]-r[a]}_getDeltaY(e,n){const{grayscalePixelData:r,width:i,height:a}=this;let o=this._getPointIndex(n,e);return n+1===a&&(o-=i),r[o]-r[o+i]}_getGradientMagnitude(e,n){const r=this._getDeltaX(e,n),i=this._getDeltaY(e,n);return Math.sqrt(r*r+i*i)}_getLaplace(e,n){const{grayscalePixelData:r,_getPointIndex:i}=this,a=r[i(n-2,e)],o=r[i(n-1,e-1)],s=r[i(n-1,e)],l=r[i(n-1,e+1)],c=r[i(n,e-2)],f=r[i(n,e-1)],u=r[i(n,e)],d=r[i(n,e+1)],h=r[i(n,e+2)],p=r[i(n+1,e-1)],g=r[i(n+1,e)],m=r[i(n+1,e+1)],y=r[i(n+2,e)];let v=a;return v+=o+2*s+l,v+=c+2*f-16*u+2*d+h,v+=p+2*g+m,v+=y,v}_computeGradient(){const{width:e,height:n}=this,r=new Float32Array(e*n);let i=0,a=0,o=0,s=0;for(s=0;s<n-1;s++){for(o=0;o<e-1;o++)r[i]=this._getGradientMagnitude(o,s),a=Math.max(r[i],a),i++;r[i]=r[i-1],i++}for(let l=r.length;i<l;i++)r[i]=r[i-e];for(let l=0,c=r.length;l<c;l++)r[l]=1-r[l]/a;return r}_computeLaplace(){const{width:e,height:n,_getPointIndex:r}=this,i=new Float32Array(e*n);i.fill(1,0,r(2,0));for(let a=2;a<n-2;a++){i[r(a,0)]=1,i[r(a,1)]=1;for(let o=2;o<e-2;o++)i[r(a,o)]=this._getLaplace(o,a)>.33?0:1;i[r(a,e-2)]=1,i[r(a,e-1)]=1}return i.fill(1,r(n-2,0)),i}_computeGradientX(){const{width:e,height:n}=this,r=new Float32Array(e*n);let i=0;for(let a=0;a<n;a++)for(let o=0;o<e;o++)r[i++]=this._getDeltaX(o,a);return r}_computeGradientY(){const{width:e,height:n}=this,r=new Float32Array(e*n);let i=0;for(let a=0;a<n;a++)for(let o=0;o<e;o++)r[i++]=this._getDeltaY(o,a);return r}_getGradientUnitVector(e,n){const{gradXNew:r,gradYNew:i,_getPointIndex:a}=this,o=r[a(n,e)],s=i[a(n,e)];let l=Math.sqrt(o*o+s*s);return l=Math.max(l,1e-100),[o/l,s/l]}_getGradientDirection(e,n,r,i){const a=this._getGradientUnitVector(e,n),o=this._getGradientUnitVector(r,i);let s=a[1]*(r-e)-a[0]*(i-n),l=o[1]*(r-e)-o[0]*(i-n);s<0&&(s=-s,l=-l),e!==r&&n!==i&&(s*=Math.SQRT1_2,l*=Math.SQRT1_2),l=Math.min(Math.max(l,-1),1);const c=pUe*(Math.acos(Math.min(s,1))+Math.acos(l));return isNaN(c)||!isFinite(c)?(console.warn("Found non-direction:",e,n,r,i,s,l,c),1):c}getCost(e,n){return this._getWeightedDistance(e,n)}_getWeightedDistance(e,n){const{_getPointIndex:r,width:i,height:a}=this,[o,s]=e,[l,c]=n;if(l<0||l>=i||c<0||c>=a)return 1;if(o<0||s<0||o>=i||s>=a)return 0;const f=r(c,l);let u=this.gradMagnitude[f];(o===l||s===c)&&(u*=Math.SQRT1_2);const d=this.laplace[f],h=this._getGradientDirection(o,s,l,c);return .43*u+.43*d+.11*h}_getNeighborPoints(e){const{width:n,height:r}=this,i=[],a=Math.max(e[0]-1,0),o=Math.max(e[1]-1,0),s=Math.min(e[0]+1,n-1),l=Math.min(e[1]+1,r-1);for(let c=o;c<=l;c++)for(let f=a;f<=s;f++)(f!==e[0]||c!==e[1])&&i.push([f,c]);return i}static createInstanceFromRawPixelData(e,n,r,i){const a=e.length,o=new Float32Array(a),{lower:s,upper:l}=i,c=l-s;for(let f=0,u=e.length;f<u;f++)o[f]=Math.max(0,Math.min(1,(e[f]-s)/c));return new rw(o,n,r)}}class bd{constructor(e,n){this.pointArray=e?e.slice():[],this._controlPointIndexes=n?n.slice():[]}getPoint(e){return this.pointArray[e]}getLastPoint(){return this.pointArray[this.pointArray.length-1]}isControlPoint(e){const n=this.pointArray.indexOf(e);if(n!==-1)return this._controlPointIndexes.indexOf(n)!==-1;throw new Error("Error: isControlPoint called with not in list point.")}addPoint(e){this.pointArray.push(e)}addControlPoint(e){const n=this.pointArray.indexOf(e);if(n!==-1)this._controlPointIndexes.push(n);else throw new Error("Cannot mark a non registered point as control point.")}getControlPoints(){return this._controlPointIndexes.map(e=>this.pointArray[e])}getNumControlPoints(){return this._controlPointIndexes.length}removeLastControlPoint(){this._controlPointIndexes.length&&this._controlPointIndexes.pop()}getLastControlPoint(){if(this._controlPointIndexes.length)return this.pointArray[this._controlPointIndexes[this._controlPointIndexes.length-1]]}removeLastPoints(e){this.pointArray.splice(this.pointArray.length-e,e)}addPoints(e){this.pointArray=this.pointArray.concat(e)}prependPath(e){const n=e.pointArray.length,r=[];this.pointArray=e.pointArray.concat(this.pointArray);for(let i=0;i<this._controlPointIndexes.length;++i)r[i]=this._controlPointIndexes[i]+n;this._controlPointIndexes=e._controlPointIndexes.concat(r)}appendPath(e){this.addPoints(e.pointArray),e._controlPointIndexes.forEach(n=>this._controlPointIndexes.push(n))}}const gUe=10**2,rO=class rO extends k2{constructor(e={},n={supportedInteractionTypes:["Mouse","Touch"],configuration:{getTextLines:mUe,calculateStats:!0,preventHandleOutsideImage:!1,contourHoleAdditionModifierKey:Ia.Shift,snapHandleNearby:2,interpolation:{enabled:!1,nearestEdge:2,showInterpolationPolyline:!1},decimate:{enabled:!1,epsilon:.1},actions:{cancelInProgress:{method:"cancelInProgress",bindings:[{key:"Escape"}]}}}}){super(e,n),this.isHandleOutsideImage=!1,this.isPointNearTool=(r,i,a,o)=>{const s=et(r),{viewport:l}=s,c=o*o,f=i.data.contour.polyline.map(d=>l.worldToCanvas(d));let u=f[f.length-1];for(let d=0;d<f.length;d++){const h=f[d];if(wC(u,h,a)<=c)return!0;u=h}return!1},this.toolSelectedCallback=(r,i)=>{const a=r.detail,{element:o}=a;i.highlighted=!0;const s=fn(o,this.getToolName());this.editData={annotation:i,viewportIdsToRender:s,movingTextBox:!1};const l=et(o),{renderingEngine:c}=l;this._activateModify(o),ut(s),r.preventDefault()},this.handleSelectedCallback=(r,i,a)=>{const o=r.detail,{element:s}=o,{data:l}=i;i.highlighted=!0;let c=!1,f;if(a.worldPosition)c=!0;else{const{points:p}=l.handles;f=p.findIndex(g=>g===a)}const u=fn(s,this.getToolName());this.editData={annotation:i,viewportIdsToRender:u,handleIndex:f,movingTextBox:c},this._activateModify(s);const d=et(s),{renderingEngine:h}=d;ut(u),r.preventDefault()},this._endCallback=(r,i=!1)=>{const a=r.detail,{element:o}=a,{annotation:s,viewportIdsToRender:l,newAnnotation:c,contourHoleProcessingEnabled:f}=this.editData,{data:u}=s;this.doneEditMemo(),u.handles.activeHandleIndex=null,this._deactivateModify(o),this._deactivateDraw(o),Kn(o);const d=et(o);if(this.isHandleOutsideImage&&this.configuration.preventHandleOutsideImage||i){Cr(s.annotationUID),this.clearEditData(),ut(l);return}ut(l);const h=c?wn.Completed:wn.HandlesUpdated;this.triggerChangeEvent(s,d,h,f),this.clearEditData()},this.triggerChangeEvent=(r,i,a=wn.StatsUpdated,o=!1)=>{a===wn.Completed?fC(r,o):Fn(r,i.viewport.element,a)},this._mouseDownCallback=r=>{const i=r.type===ee.MOUSE_DOUBLE_CLICK,{annotation:a,viewportIdsToRender:o,worldToSlice:s,sliceToWorld:l,newAnnotation:c}=this.editData;if(this.editData.closed)return;const f=r.detail,{element:u}=f,{currentPoints:d}=f,{canvas:h,world:p}=d;let g=p;const m=et(u),{viewport:y,renderingEngine:v}=m,x=this.editData.currentPath.getControlPoints();let w=x.length>=2&&i;if(this.doneEditMemo(),this.createMemo(u,a,{newAnnotation:c&&x.length===1}),x.length>=2){const _={index:-1,distSquared:1/0};for(let D=0,I=x.length;D<I;D++){const R=x[D],M=l(R),A=y.worldToCanvas(M),L=C0(h,A);L<=gUe&&L<_.distSquared&&(_.distSquared=L,_.index=D)}_.index===0&&(w=!0)}const{snapHandleNearby:S}=this.configuration;if(S&&!this.editData.closed){const _=new bd,D=this.scissors.findMinNearby(s(p),1),I=this.scissors.findPathToPoint(D);_.addPoints(I),_.prependPath(this.editData.confirmedPath),g=l(D),this.editData.currentPath=_}this.editData.closed=this.editData.closed||w,this.editData.confirmedPath=this.editData.currentPath;const T=this.editData.currentPath.getLastPoint();this.editData.confirmedPath.addControlPoint(T),a.data.handles.points.push(l(T)),this.scissors.startSearch(s(g)),a.invalidated=!0,ut(o),this.editData.closed&&(this.updateAnnotation(this.editData.confirmedPath),this._endCallback(r)),r.preventDefault()},this._mouseMoveCallback=r=>{const{element:i,currentPoints:a}=r.detail,{world:o,canvas:s}=a,{renderingEngine:l}=et(i),c=fn(i,this.getToolName());this.editData.lastCanvasPoint=s;const{width:f,height:u}=this.scissors,{worldToSlice:d}=this.editData,h=d(o);if(h[0]<0||h[1]<0||h[0]>=f||h[1]>=u)return;const p=this.scissors.findPathToPoint(h),g=new bd;g.addPoints(p),g.prependPath(this.editData.confirmedPath),this.editData.currentPath=g,ut(c),r.preventDefault()},this._dragCallback=r=>{this.isDrawing=!0;const i=r.detail,{element:a}=i,{annotation:o,viewportIdsToRender:s,movingTextBox:l,handleIndex:c,newAnnotation:f}=this.editData;this.createMemo(a,o,{newAnnotation:f});const{data:u}=o;if(l){const{deltaPoints:p}=i,g=p.world,{textBox:m}=u.handles,{worldPosition:y}=m;y[0]+=g[0],y[1]+=g[1],y[2]+=g[2],m.hasMoved=!0}else if(c===void 0)console.warn("Drag annotation not implemented");else{const{currentPoints:p}=i,g=p.world;this.editHandle(g,a,o,c)}this.editData.hasMoved=!0;const d=et(a),{renderingEngine:h}=d;ut(s)},this.cancel=r=>{if(!this.isDrawing)return;this.isDrawing=!1,this._deactivateDraw(r),this._deactivateModify(r),Kn(r);const{annotation:i,viewportIdsToRender:a,newAnnotation:o}=this.editData;return o&&Cr(i.annotationUID),ut(a),this.doneEditMemo(),this.scissors=null,i.annotationUID},this._activateModify=r=>{Mt.isInteractingWithTool=!0,r.addEventListener(ee.MOUSE_UP,this._endCallback),r.addEventListener(ee.MOUSE_DRAG,this._dragCallback),r.addEventListener(ee.MOUSE_CLICK,this._endCallback),r.addEventListener(ee.TOUCH_END,this._endCallback),r.addEventListener(ee.TOUCH_DRAG,this._dragCallback),r.addEventListener(ee.TOUCH_TAP,this._endCallback)},this._deactivateModify=r=>{Mt.isInteractingWithTool=!1,r.removeEventListener(ee.MOUSE_UP,this._endCallback),r.removeEventListener(ee.MOUSE_DRAG,this._dragCallback),r.removeEventListener(ee.MOUSE_CLICK,this._endCallback),r.removeEventListener(ee.TOUCH_END,this._endCallback),r.removeEventListener(ee.TOUCH_DRAG,this._dragCallback),r.removeEventListener(ee.TOUCH_TAP,this._endCallback)},this._activateDraw=r=>{Mt.isInteractingWithTool=!0,r.addEventListener(ee.MOUSE_MOVE,this._mouseMoveCallback),r.addEventListener(ee.MOUSE_DOWN,this._mouseDownCallback),r.addEventListener(ee.MOUSE_DOUBLE_CLICK,this._mouseDownCallback),r.addEventListener(ee.TOUCH_TAP,this._mouseDownCallback)},this._deactivateDraw=r=>{Mt.isInteractingWithTool=!1,r.removeEventListener(ee.MOUSE_MOVE,this._mouseMoveCallback),r.removeEventListener(ee.MOUSE_DOWN,this._mouseDownCallback),r.removeEventListener(ee.MOUSE_DOUBLE_CLICK,this._mouseDownCallback),r.removeEventListener(ee.TOUCH_TAP,this._mouseDownCallback)},this._calculateCachedStats=(r,i)=>{if(!this.configuration.calculateStats)return;const a=r.data;if(!a.contour.closed)return;const o=et(i),{viewport:s,renderingEngine:l}=o,{cachedStats:c}=a,{polyline:f}=a.contour,u=Object.keys(c);for(let h=0;h<u.length;h++){const p=u[h],g=this.getTargetImageData(p);if(!g)continue;const{metadata:m}=g,y=f.map(A=>s.worldToCanvas(A)),v=y[0],x=s.canvasToWorld(v),w=s.canvasToWorld([v[0]+1,v[1]]),S=s.canvasToWorld([v[0],v[1]+1]),T=el(x,w),_=el(x,S),{imageData:D}=g,{scale:I,areaUnit:R}=vc(g,()=>{const{maxX:A,maxY:L,minX:P,minY:B}=mm(y),U=s.canvasToWorld([P,B]),G=io(D,U),F=s.canvasToWorld([A,L]),$=io(D,F);return[G,$]});let M=vy(y)/I/I;M*=T*_,c[p]={Modality:m.Modality,area:M,areaUnit:R}}const d=r.invalidated;return r.invalidated=!1,d&&this.triggerAnnotationModified(r,o,wn.StatsUpdated),c},this._renderStats=(r,i,a,o)=>{const s=r.data,l=this.getTargetId(i);if(!s.contour.closed||!o.visibility)return;const c=this.configuration.getTextLines(s,l);if(!c||c.length===0)return;const f=s.handles.points.map(v=>i.worldToCanvas(v));if(!s.handles.textBox.hasMoved){const v=Du(f);s.handles.textBox.worldPosition=i.canvasToWorld(v)}const u=i.worldToCanvas(s.handles.textBox.worldPosition),h=rl(a,r.annotationUID??"","textBox",c,u,f,{},o),{x:p,y:g,width:m,height:y}=h;s.handles.textBox.worldBoundingBox={topLeft:i.canvasToWorld([p,g]),topRight:i.canvasToWorld([p+m,g]),bottomLeft:i.canvasToWorld([p,g+y]),bottomRight:i.canvasToWorld([p+m,g+y])}},this.triggerAnnotationModified=(r,i,a=wn.StatsUpdated)=>{const{viewportId:o,renderingEngineId:s}=i,l=ee.ANNOTATION_MODIFIED;Ct(St,l,{annotation:r,viewportId:o,renderingEngineId:s,changeType:a})},this._throttledCalculateCachedStats=Bl(this._calculateCachedStats,100,{trailing:!0})}setupBaseEditData(e,n,r,i,a){const o=et(n),{viewport:s}=o;this.isDrawing=!0;const l=s.getImageData(),{imageData:c}=l;let f,u,d,h,p;if(!(s instanceof oa))d=l.dimensions[0],h=l.dimensions[1],f=_=>{const D=io(c,_);return[D[0],D[1]]},u=_=>dm(c,[_[0],_[1],0]),p=l.scalarData;else if(s instanceof oa){const _=WJ(s),{sliceToIndexMatrix:D,indexToSliceMatrix:I}=_;f=R=>{const M=io(c,R),A=v2([0,0,0],M,I);return[A[0],A[1]]},u=R=>{const M=v2([0,0,0],[R[0],R[1],0],D);return dm(c,M)},p=_.scalarData,d=_.width,h=_.height}else throw new Error("Viewport not supported");p=qJ(p,d,h);const{voiRange:g}=s.getProperties(),m=f(e);this.scissors=rw.createInstanceFromRawPixelData(p,d,h,g),i&&(this.scissorsNext=rw.createInstanceFromRawPixelData(p,d,h,g),this.scissorsNext.startSearch(f(i))),this.scissors.startSearch(m);const y=!i,v=new bd,x=new bd,w=y?void 0:new bd;v.addPoint(m),v.addControlPoint(m);const S=fn(n,this.getToolName()),T=s.worldToCanvas(e);this.editData={annotation:r,viewportIdsToRender:S,newAnnotation:y,hasMoved:!1,lastCanvasPoint:T,confirmedPath:v,currentPath:x,confirmedPathNext:w,closed:!1,handleIndex:this.editData?.handleIndex??r.handles?.activeHandleIndex,worldToSlice:f,sliceToWorld:u,contourHoleProcessingEnabled:a}}addNewAnnotation(e){const n=e.detail,{currentPoints:r,element:i}=n,{world:a}=r,o=this.createAnnotation(e),s=Km(e.detail.event)===this.configuration.contourHoleAdditionModifierKey;return this.setupBaseEditData(a,i,o,void 0,s),this.addAnnotation(o,i),this._activateDraw(i),e.preventDefault(),ut(this.editData.viewportIdsToRender),o}clearEditData(){this.editData=null,this.scissors=null,this.scissorsNext=null,this.isDrawing=!1}editHandle(e,n,r,i){const{data:a}=r,{points:o}=a.handles,{length:s}=o,l=o[(i-1+s)%s],c=o[(i+1)%s];if(!this.editData?.confirmedPathNext){this.setupBaseEditData(l,n,r,c);const{polyline:x}=a.contour,w=new bd,S=new bd,{worldToSlice:T}=this.editData,_=mF(r,i-1),D=mF(r,i+1);if(D===-1||_===-1)throw new Error(`Can't find handle index ${D===-1&&c} ${_===-1&&l}`);i===0?S.addPoints(x.slice(D+1,_).map(T)):(w.addPoints(x.slice(0,_+1).map(T)),S.addPoints(x.slice(D,x.length).map(T))),this.editData.confirmedPath=w,this.editData.confirmedPathNext=S}const{editData:f,scissors:u}=this,{worldToSlice:d,sliceToWorld:h}=f,{activeHandleIndex:p}=a.handles;if(p==null)a.handles.activeHandleIndex=i;else if(p!==i)throw new Error(`Trying to edit a different handle than the one currently being edited ${i}!==${a.handles.activeHandleIndex}`);const g=d(e);if(g[0]<0||g[0]>=u.width||g[1]<0||g[1]>=u.height)return;o[i]=h(g);const m=u.findPathToPoint(g),y=this.scissorsNext.findPathToPoint(g),v=new bd;v.prependPath(f.confirmedPath),i!==0&&v.addPoints(m),v.addPoints(y.reverse()),v.appendPath(f.confirmedPathNext),i===0&&v.addPoints(m),f.currentPath=v,r.invalidated=!0,f.hasMoved=!0,f.closed=!0}renderAnnotation(e,n){return this.updateAnnotation(this.editData?.currentPath),super.renderAnnotation(e,n)}isContourSegmentationTool(){return!1}createAnnotation(e){const n=super.createAnnotation(e),{world:r}=e.detail.currentPoints;return Mo(n,{data:{handles:{points:[[...r]]}}})}cancelInProgress(e,n,r){if(!this.editData){this.undo();return}this._endCallback(r,!0)}renderAnnotationInstance(e){const{annotation:n,enabledElement:r,svgDrawingHelper:i,annotationStyle:a,targetId:o}=e,{viewport:s}=r,{element:l}=s,{worldToCanvas:c}=s,{annotationUID:f,data:u,highlighted:d}=n,{handles:h}=u,p=this.editData?.newAnnotation,{lineWidth:g,lineDash:m,color:y}=a;if(d||p&&n.annotationUID===this.editData?.annotation?.annotationUID){const x=h.points.map(c);ho(i,f,"0",x,{color:y,lineDash:m,lineWidth:g})}return super.renderAnnotationInstance(e),!u.cachedStats[o]||u.cachedStats[o]?.areaUnit===null?(u.cachedStats[o]={Modality:null,area:null,areaUnit:null},this._calculateCachedStats(n,l)):n.invalidated&&this._throttledCalculateCachedStats(n,l),this._renderStats(n,s,i,a.textbox),!0}updateAnnotation(e){if(!this.editData||!e)return;const{annotation:n,sliceToWorld:r,worldToSlice:i,closed:a,newAnnotation:o}=this.editData;let{pointArray:s}=e;s.length>1&&(s=[...s,s[0]]);const l=o&&a?Zo.Clockwise:void 0;this.updateContourPolyline(n,{points:s,closed:a,targetWindingDirection:l},{canvasToWorld:r,worldToCanvas:i})}};rO.toolName="LivewireContour";let kd=rO;function mUe(t,e){const n=t.cachedStats[e],{area:r,areaUnit:i}=n,a=[];if(r){const o=`Area: ${kn(r)} ${i}`;a.push(o)}return a}const Ng=class Ng extends na{constructor(e={},n={supportedInteractionTypes:["Mouse","Touch"],configuration:{shadow:!0,getTextCallback:vUe,changeTextCallback:yUe,preventHandleOutsideImage:!1,arrowFirst:!0,arrowHeadStyle:"legacy"}}){super(e,n),this.addNewAnnotation=r=>{const i=r.detail,{currentPoints:a,element:o}=i,s=a.world,l=et(o),{viewport:c,renderingEngine:f}=l;Rn(o),this.isDrawing=!0;const u=c.getCamera(),{viewPlaneNormal:d,viewUp:h}=u,p=this.getReferencedImageId(c,s,d,h),{arrowFirst:g}=this.configuration,m=c.getFrameOfReferenceUID(),y={highlighted:!0,invalidated:!0,metadata:{toolName:this.getToolName(),viewPlaneNormal:[...d],viewUp:[...h],FrameOfReferenceUID:m,referencedImageId:p,...c.getViewReference({points:[s]})},data:{text:"",handles:{points:[[...s],[...s]],activeHandleIndex:null,arrowFirst:g,textBox:{hasMoved:!1,worldPosition:[0,0,0],worldBoundingBox:{topLeft:[0,0,0],topRight:[0,0,0],bottomLeft:[0,0,0],bottomRight:[0,0,0]}}},label:""}};hr(y,o);const v=fn(o,this.getToolName());return this.editData={annotation:y,viewportIdsToRender:v,handleIndex:1,movingTextBox:!1,newAnnotation:!0,hasMoved:!1},this._activateDraw(o),r.preventDefault(),ut(v),y},this.isPointNearTool=(r,i,a,o)=>{const s=et(r),{viewport:l}=s,{data:c}=i,[f,u]=c.handles.points,d=l.worldToCanvas(f),h=l.worldToCanvas(u),p={start:{x:d[0],y:d[1]},end:{x:h[0],y:h[1]}};return Il([p.start.x,p.start.y],[p.end.x,p.end.y],[a[0],a[1]])<=o},this.toolSelectedCallback=(r,i)=>{const a=r.detail,{element:o}=a;i.highlighted=!0;const s=fn(o,this.getToolName());this.editData={annotation:i,viewportIdsToRender:s,movingTextBox:!1},this._activateModify(o),Rn(o);const l=et(o),{renderingEngine:c}=l;ut(s),r.preventDefault()},this._endCallback=r=>{const i=r.detail,{element:a}=i,{annotation:o,viewportIdsToRender:s,newAnnotation:l,hasMoved:c,movingTextBox:f}=this.editData,{data:u}=o;l&&!c||(u.handles.activeHandleIndex=null,this._deactivateModify(a),this._deactivateDraw(a),Kn(a),this.isHandleOutsideImage&&this.configuration.preventHandleOutsideImage&&Cr(o.annotationUID),l?this.configuration.getTextCallback(d=>{if(!d){Cr(o.annotationUID),ut(s),this.editData=null,this.isDrawing=!1;return}o.data.text=d,Fn(o,a,wn.HandlesUpdated),Wr(o),this.createMemo(a,o,{newAnnotation:!!this.memo}),jFe(o,a,d),ut(s)}):f||Fn(o,a,wn.HandlesUpdated),this.doneEditMemo(),this.editData=null,this.isDrawing=!1)},this._dragCallback=r=>{this.isDrawing=!0;const i=r.detail,{element:a}=i,{annotation:o,viewportIdsToRender:s,handleIndex:l,movingTextBox:c,newAnnotation:f}=this.editData;this.createMemo(a,o,{newAnnotation:f});const{data:u}=o;if(c){const{deltaPoints:d}=i,h=d.world,{textBox:p}=u.handles,{worldPosition:g}=p;g[0]+=h[0],g[1]+=h[1],g[2]+=h[2],p.hasMoved=!0}else if(l===void 0){const{deltaPoints:d}=i,h=d.world;u.handles.points.forEach(g=>{g[0]+=h[0],g[1]+=h[1],g[2]+=h[2]}),o.invalidated=!0}else{const{currentPoints:d}=i,h=d.world;u.handles.points[l]=[...h],o.invalidated=!0}this.editData.hasMoved=!0,ut(s),o.invalidated&&Fn(o,a,wn.HandlesUpdated)},this.touchTapCallback=r=>{r.detail.taps==2&&this.doubleClickCallback(r)},this.doubleClickCallback=r=>{const i=r.detail,{element:a}=i;let o=Wi(this.getToolName(),a);if(o=this.filterInteractableAnnotationsForElement(a,o),!o?.length)return;const s=o.find(c=>this.isPointNearTool(a,c,i.currentPoints.canvas,6));if(!s)return;const l=s;this.configuration.changeTextCallback(s,r.detail,this._doneChangingTextCallback.bind(this,a,l)),this.editData=null,this.isDrawing=!1,r.stopImmediatePropagation(),r.preventDefault()},this.cancel=r=>{if(this.isDrawing){this.isDrawing=!1,this._deactivateDraw(r),this._deactivateModify(r),Kn(r);const{annotation:i,viewportIdsToRender:a,newAnnotation:o}=this.editData,{data:s}=i;return i.highlighted=!1,s.handles.activeHandleIndex=null,ut(a),o&&Wr(i),this.editData=null,i.annotationUID}},this._activateModify=r=>{Mt.isInteractingWithTool=!0,r.addEventListener(ee.MOUSE_UP,this._endCallback),r.addEventListener(ee.MOUSE_DRAG,this._dragCallback),r.addEventListener(ee.MOUSE_CLICK,this._endCallback),r.addEventListener(ee.TOUCH_TAP,this._endCallback),r.addEventListener(ee.TOUCH_END,this._endCallback),r.addEventListener(ee.TOUCH_DRAG,this._dragCallback)},this._deactivateModify=r=>{Mt.isInteractingWithTool=!1,r.removeEventListener(ee.MOUSE_UP,this._endCallback),r.removeEventListener(ee.MOUSE_DRAG,this._dragCallback),r.removeEventListener(ee.MOUSE_CLICK,this._endCallback),r.removeEventListener(ee.TOUCH_TAP,this._endCallback),r.removeEventListener(ee.TOUCH_DRAG,this._dragCallback),r.removeEventListener(ee.TOUCH_END,this._endCallback)},this._activateDraw=r=>{Mt.isInteractingWithTool=!0,r.addEventListener(ee.MOUSE_UP,this._endCallback),r.addEventListener(ee.MOUSE_DRAG,this._dragCallback),r.addEventListener(ee.MOUSE_MOVE,this._dragCallback),r.addEventListener(ee.MOUSE_CLICK,this._endCallback),r.addEventListener(ee.TOUCH_TAP,this._endCallback),r.addEventListener(ee.TOUCH_END,this._endCallback),r.addEventListener(ee.TOUCH_DRAG,this._dragCallback)},this._deactivateDraw=r=>{Mt.isInteractingWithTool=!1,r.removeEventListener(ee.MOUSE_UP,this._endCallback),r.removeEventListener(ee.MOUSE_DRAG,this._dragCallback),r.removeEventListener(ee.MOUSE_MOVE,this._dragCallback),r.removeEventListener(ee.MOUSE_CLICK,this._endCallback),r.removeEventListener(ee.TOUCH_TAP,this._endCallback),r.removeEventListener(ee.TOUCH_END,this._endCallback),r.removeEventListener(ee.TOUCH_DRAG,this._dragCallback)},this.renderAnnotation=(r,i)=>{let a=!1;const{viewport:o}=r,{element:s}=o;let l=Wi(this.getToolName(),s);if(!l?.length||(l=this.filterInteractableAnnotationsForElement(s,l),!l?.length))return a;const c={toolGroupId:this.toolGroupId,toolName:this.getToolName(),viewportId:r.viewport.id};for(let f=0;f<l.length;f++){const u=l[f],{annotationUID:d,data:h}=u,{handles:p,text:g}=h,{points:m,activeHandleIndex:y}=p;c.annotationUID=d;const{color:v,lineWidth:x,lineDash:w,markerSize:S}=this.getAnnotationStyle({annotation:u,styleSpecifier:c}),T=m.map(G=>o.worldToCanvas(G));let _;if(!uo(d)&&!this.editData&&y!==null&&(_=[T[y]]),!o.getRenderingEngine())return console.warn("Rendering Engine has been destroyed"),a;if(!fo(d))continue;_&&ho(i,d,"0",T,{color:v,lineWidth:x});const D="1";if(this.configuration.arrowFirst?GV(i,d,D,T[1],T[0],{color:v,width:x,lineDash:w,viaMarker:this.configuration.arrowHeadStyle!=="legacy",markerSize:S}):GV(i,d,D,T[0],T[1],{color:v,width:x,lineDash:w,viaMarker:this.configuration.arrowHeadStyle!=="legacy",markerSize:S}),a=!0,!g)continue;const I=this.getLinkedTextBoxStyle(c,u);if(!I.visibility){h.handles.textBox={hasMoved:!1,worldPosition:[0,0,0],worldBoundingBox:{topLeft:[0,0,0],topRight:[0,0,0],bottomLeft:[0,0,0],bottomRight:[0,0,0]}};continue}if(!h.handles.textBox.hasMoved){const G=T[1];h.handles.textBox.worldPosition=o.canvasToWorld(G)}const R=o.worldToCanvas(h.handles.textBox.worldPosition),A=rl(i,d,"1",[g],R,T,{},I),{x:L,y:P,width:B,height:U}=A;h.handles.textBox.worldBoundingBox={topLeft:o.canvasToWorld([L,P]),topRight:o.canvasToWorld([L+B,P]),bottomLeft:o.canvasToWorld([L,P+U]),bottomRight:o.canvasToWorld([L+B,P+U])}}return a}}handleSelectedCallback(e,n,r){const i=e.detail,{element:a}=i,{data:o}=n;n.highlighted=!0;let s=!1,l;r.worldPosition?s=!0:l=o.handles.points.findIndex(d=>d===r);const c=fn(a,this.getToolName());this.editData={annotation:n,viewportIdsToRender:c,handleIndex:l,movingTextBox:s},this._activateModify(a),Rn(a);const f=et(a),{renderingEngine:u}=f;ut(c),e.preventDefault()}_doneChangingTextCallback(e,n,r){n.data.text=r,et(e);const i=fn(e,this.getToolName());ut(i),Fn(n,e)}_isInsideVolume(e,n,r){return xa(e,r)&&xa(n,r)}};Ng.toolName="ArrowAnnotate",Ng.hydrate=(e,n,r,i)=>{const a=mr(e);if(!a)return;const{FrameOfReferenceUID:o,referencedImageId:s,viewPlaneNormal:l,instance:c,viewport:f}=Ng.hydrateBase(Ng,a,n,i),{toolInstance:u,...d}=i||{},h={annotationUID:i?.annotationUID||or(),data:{text:r||"",handles:{points:n}},highlighted:!1,autoGenerated:!1,invalidated:!1,isLocked:!1,isVisible:!0,metadata:{toolName:c.getToolName(),viewPlaneNormal:l,FrameOfReferenceUID:o,referencedImageId:s,...d}};hr(h,f.element),ut([f.id])};let Vd=Ng;function vUe(t){return t(prompt("Enter your annotation:"))}function yUe(t,e,n){return n(prompt("Enter your annotation:"))}const Lg=class Lg extends na{constructor(e={},n={supportedInteractionTypes:["Mouse","Touch"],configuration:{shadow:!0,showAngleArc:!1,arcOffset:5,preventHandleOutsideImage:!1,getTextLines:xUe}}){super(e,n),this.addNewAnnotation=r=>{if(this.angleStartedNotYetCompleted)return;this.angleStartedNotYetCompleted=!0;const i=r.detail,{currentPoints:a,element:o}=i,s=a.world,l=et(o),{viewport:c,renderingEngine:f}=l;Rn(o),this.isDrawing=!0;const u=c.getCamera(),{viewPlaneNormal:d,viewUp:h}=u,p=this.getReferencedImageId(c,s,d,h),g=c.getFrameOfReferenceUID(),m={highlighted:!0,invalidated:!0,metadata:{toolName:this.getToolName(),viewPlaneNormal:[...d],viewUp:[...h],FrameOfReferenceUID:g,referencedImageId:p,...c.getViewReference({points:[s]})},data:{handles:{points:[[...s],[...s]],activeHandleIndex:null,textBox:{hasMoved:!1,worldPosition:[0,0,0],worldBoundingBox:{topLeft:[0,0,0],topRight:[0,0,0],bottomLeft:[0,0,0],bottomRight:[0,0,0]}}},label:"",cachedStats:{}}};hr(m,o);const y=fn(o,this.getToolName());return this.editData={annotation:m,viewportIdsToRender:y,handleIndex:1,movingTextBox:!1,newAnnotation:!0,hasMoved:!1},this._activateDraw(o),r.preventDefault(),ut(y),m},this.isPointNearTool=(r,i,a,o)=>{const s=et(r),{viewport:l}=s,{data:c}=i,[f,u,d]=c.handles.points,h=l.worldToCanvas(f),p=l.worldToCanvas(u),g={start:{x:h[0],y:h[1]},end:{x:p[0],y:p[1]}};if(Il([g.start.x,g.start.y],[g.end.x,g.end.y],[a[0],a[1]])<=o)return!0;if(!d)return!1;const y=l.worldToCanvas(d),v={start:{x:p[0],y:p[1]},end:{x:y[0],y:y[1]}};return Il([v.start.x,v.start.y],[v.end.x,v.end.y],[a[0],a[1]])<=o},this.toolSelectedCallback=(r,i)=>{const a=r.detail,{element:o}=a;i.highlighted=!0;const s=fn(o,this.getToolName());this.editData={annotation:i,viewportIdsToRender:s,movingTextBox:!1},this._activateModify(o),Rn(o);const l=et(o),{renderingEngine:c}=l;ut(s),r.preventDefault()},this._endCallback=r=>{const i=r.detail,{element:a}=i,{annotation:o,viewportIdsToRender:s,newAnnotation:l,hasMoved:c}=this.editData,{data:f}=o;if(l&&!c)return;if(this.angleStartedNotYetCompleted&&f.handles.points.length===2){this.editData.handleIndex=2;return}this.angleStartedNotYetCompleted=!1,f.handles.activeHandleIndex=null,this._deactivateModify(a),this._deactivateDraw(a),Kn(a);const u=et(a),{renderingEngine:d}=u;this.isHandleOutsideImage&&this.configuration.preventHandleOutsideImage&&Cr(o.annotationUID),ut(s),this.doneEditMemo(),l&&Wr(o),this.editData=null,this.isDrawing=!1},this._dragCallback=r=>{this.isDrawing=!0;const i=r.detail,{element:a}=i,{annotation:o,viewportIdsToRender:s,handleIndex:l,movingTextBox:c,newAnnotation:f}=this.editData,{data:u}=o;if(this.createMemo(a,o,{newAnnotation:f}),c){const{deltaPoints:p}=i,g=p.world,{textBox:m}=u.handles,{worldPosition:y}=m;y[0]+=g[0],y[1]+=g[1],y[2]+=g[2],m.hasMoved=!0}else if(l===void 0){const{deltaPoints:p}=i,g=p.world;u.handles.points.forEach(y=>{y[0]+=g[0],y[1]+=g[1],y[2]+=g[2]}),o.invalidated=!0}else{const{currentPoints:p}=i,g=p.world;u.handles.points[l]=[...g],o.invalidated=!0}this.editData.hasMoved=!0;const d=et(a),{renderingEngine:h}=d;ut(s),o.invalidated&&Fn(o,a,wn.HandlesUpdated)},this.cancel=r=>{if(this.isDrawing){this.isDrawing=!1,this._deactivateDraw(r),this._deactivateModify(r),Kn(r);const{annotation:i,viewportIdsToRender:a,newAnnotation:o}=this.editData,{data:s}=i;return i.highlighted=!1,s.handles.activeHandleIndex=null,ut(a),o&&Wr(i),this.editData=null,this.angleStartedNotYetCompleted=!1,i.annotationUID}},this._activateModify=r=>{Mt.isInteractingWithTool=!0,r.addEventListener(ee.MOUSE_UP,this._endCallback),r.addEventListener(ee.MOUSE_DRAG,this._dragCallback),r.addEventListener(ee.MOUSE_CLICK,this._endCallback),r.addEventListener(ee.TOUCH_TAP,this._endCallback),r.addEventListener(ee.TOUCH_END,this._endCallback),r.addEventListener(ee.TOUCH_DRAG,this._dragCallback)},this._deactivateModify=r=>{Mt.isInteractingWithTool=!1,r.removeEventListener(ee.MOUSE_UP,this._endCallback),r.removeEventListener(ee.MOUSE_DRAG,this._dragCallback),r.removeEventListener(ee.MOUSE_CLICK,this._endCallback),r.removeEventListener(ee.TOUCH_TAP,this._endCallback),r.removeEventListener(ee.TOUCH_END,this._endCallback),r.removeEventListener(ee.TOUCH_DRAG,this._dragCallback)},this._activateDraw=r=>{Mt.isInteractingWithTool=!0,r.addEventListener(ee.MOUSE_UP,this._endCallback),r.addEventListener(ee.MOUSE_DRAG,this._dragCallback),r.addEventListener(ee.MOUSE_MOVE,this._dragCallback),r.addEventListener(ee.MOUSE_CLICK,this._endCallback),r.addEventListener(ee.TOUCH_TAP,this._endCallback),r.addEventListener(ee.TOUCH_END,this._endCallback),r.addEventListener(ee.TOUCH_DRAG,this._dragCallback)},this._deactivateDraw=r=>{Mt.isInteractingWithTool=!1,r.removeEventListener(ee.MOUSE_UP,this._endCallback),r.removeEventListener(ee.MOUSE_DRAG,this._dragCallback),r.removeEventListener(ee.MOUSE_MOVE,this._dragCallback),r.removeEventListener(ee.MOUSE_CLICK,this._endCallback),r.removeEventListener(ee.TOUCH_TAP,this._endCallback),r.removeEventListener(ee.TOUCH_END,this._endCallback),r.removeEventListener(ee.TOUCH_DRAG,this._dragCallback)},this.renderAnnotation=(r,i)=>{let a=!1;const{viewport:o}=r,{element:s}=o;let l=Wi(this.getToolName(),s);if(!l?.length||(l=this.filterInteractableAnnotationsForElement(s,l),!l?.length))return a;const c=this.getTargetId(o),f=o.getRenderingEngine(),u={toolGroupId:this.toolGroupId,toolName:this.getToolName(),viewportId:r.viewport.id};for(let d=0;d<l.length;d++){const h=l[d],{annotationUID:p,data:g}=h,{points:m,activeHandleIndex:y}=g.handles;u.annotationUID=p;const{color:v,lineWidth:x,lineDash:w,angleArcLineDash:S}=this.getAnnotationStyle({annotation:h,styleSpecifier:u}),T=m.map(F=>o.worldToCanvas(F));!g.cachedStats[c]||g.cachedStats[c].angle==null?(g.cachedStats[c]={angle:null},this._calculateCachedStats(h,f,r)):h.invalidated&&this._throttledCalculateCachedStats(h,f,r);let _;if(!uo(h.annotationUID)&&!this.editData&&y!==null&&(_=[T[y]]),!o.getRenderingEngine())return console.warn("Rendering Engine has been destroyed"),a;if(!fo(p))continue;_&&ho(i,p,"0",T,{color:v,lineDash:w,lineWidth:x});let D="1";if(Aa(i,p,D,T[0],T[1],{color:v,width:x,lineDash:w}),a=!0,T.length!==3)return a;if(D="2",Aa(i,p,D,T[1],T[2],{color:v,width:x,lineDash:w}),this.configuration.showAngleArc){const F=T[1],$=this.configuration.arcOffset,V=Math.min(Il([F[0],F[1]],[T[0][0],T[0][1]],[T[2][0],T[2][1]]),Il([F[0],F[1]],[T[2][0],T[2][1]],[T[0][0],T[0][1]]))/$,X=[];let Q=Math.atan2(T[0][1]-F[1],T[0][0]-F[0]),re=Math.atan2(T[2][1]-F[1],T[2][0]-F[0]);if(re<Q&&(re+=2*Math.PI),re-Q>Math.PI){const Ce=Q;Q=re,re=Ce+2*Math.PI}const me=32;for(let Ce=0;Ce<=me;Ce++){const we=Q+Ce/me*(re-Q);X.push([F[0]+V*Math.cos(we),F[1]+V*Math.sin(we)])}$h(i,p,"3",X,{color:v,width:x,lineDash:S})}if(!g.cachedStats[c]?.angle)continue;const I=this.getLinkedTextBoxStyle(u,h);if(!I.visibility){g.handles.textBox={hasMoved:!1,worldPosition:[0,0,0],worldBoundingBox:{topLeft:[0,0,0],topRight:[0,0,0],bottomLeft:[0,0,0],bottomRight:[0,0,0]}};continue}const R=this.configuration.getTextLines(g,c);if(!g.handles.textBox.hasMoved){const F=T[1];g.handles.textBox.worldPosition=o.canvasToWorld(F)}const M=o.worldToCanvas(g.handles.textBox.worldPosition),L=rl(i,p,"1",R,M,T,{},I),{x:P,y:B,width:U,height:G}=L;g.handles.textBox.worldBoundingBox={topLeft:o.canvasToWorld([P,B]),topRight:o.canvasToWorld([P+U,B]),bottomLeft:o.canvasToWorld([P,B+G]),bottomRight:o.canvasToWorld([P+U,B+G])}}return a},this._throttledCalculateCachedStats=Bl(this._calculateCachedStats,100,{trailing:!0})}handleSelectedCallback(e,n,r){const i=e.detail,{element:a}=i,{data:o}=n;n.highlighted=!0;let s=!1,l;r.worldPosition?s=!0:l=o.handles.points.findIndex(d=>d===r);const c=fn(a,this.getToolName());this.editData={annotation:n,viewportIdsToRender:c,handleIndex:l,movingTextBox:s},this._activateModify(a),Rn(a);const f=et(a),{renderingEngine:u}=f;ut(c),e.preventDefault()}_calculateCachedStats(e,n,r){const i=e.data,{element:a}=r.viewport;if(i.handles.points.length!==3)return;const o=i.handles.points[0],s=i.handles.points[1],l=i.handles.points[2],{cachedStats:c}=i,f=Object.keys(c);for(let d=0;d<f.length;d++){const h=f[d],p=Mb([o,s],[s,l]),{dimensions:g,imageData:m}=this.getTargetImageData(h);this.isHandleOutsideImage=[o,s,l].map(y=>io(m,y)).some(y=>!xa(y,g)),c[h]={angle:isNaN(p)?"Incomplete Angle":p}}const u=e.invalidated;return e.invalidated=!1,u&&Fn(e,a,wn.StatsUpdated),c}};Lg.toolName="Angle",Lg.hydrate=(e,n,r)=>{const i=mr(e);if(!i)return;const{FrameOfReferenceUID:a,referencedImageId:o,viewPlaneNormal:s,instance:l,viewport:c}=Lg.hydrateBase(Lg,i,n,r),{toolInstance:f,...u}=r||{},d={annotationUID:r?.annotationUID||or(),data:{handles:{points:n}},highlighted:!1,autoGenerated:!1,invalidated:!1,isLocked:!1,isVisible:!0,metadata:{toolName:l.getToolName(),viewPlaneNormal:s,FrameOfReferenceUID:a,referencedImageId:o,...u}};hr(d,c.element),ut([c.id])};let Fd=Lg;function xUe(t,e){const n=t.cachedStats[e],{angle:r}=n;return r===void 0?void 0:isNaN(r)?[`${r}`]:[`${kn(r)} °`]}const bUe=(...t)=>{const e=t[0].length===2?[0,0]:[0,0,0],n=t.length;for(const r of t)e[0]+=r[0]/n,e[1]+=r[1]/n,e.length===3&&(e[2]+=r[2]/n);return e},af=bUe,iO=class iO extends na{constructor(e={},n={supportedInteractionTypes:["Mouse","Touch"],configuration:{shadow:!0,preventHandleOutsideImage:!1,getTextLines:wUe,showArcLines:!1}}){super(e,n),this.addNewAnnotation=r=>{if(this.angleStartedNotYetCompleted)return;this.angleStartedNotYetCompleted=!0;const i=r.detail,{currentPoints:a,element:o}=i,s=a.world,l=et(o),{viewport:c,renderingEngine:f}=l;Rn(o),this.isDrawing=!0;const u=c.getCamera(),{viewPlaneNormal:d,viewUp:h}=u,p=this.getReferencedImageId(c,s,d,h),g=c.getFrameOfReferenceUID(),m={highlighted:!0,invalidated:!0,metadata:{toolName:this.getToolName(),viewPlaneNormal:[...d],viewUp:[...h],FrameOfReferenceUID:g,referencedImageId:p,...c.getViewReference({points:[s]})},data:{handles:{points:[[...s],[...s]],activeHandleIndex:null,textBox:{hasMoved:!1,worldPosition:[0,0,0],worldBoundingBox:{topLeft:[0,0,0],topRight:[0,0,0],bottomLeft:[0,0,0],bottomRight:[0,0,0]}}},label:"",cachedStats:{}}};hr(m,o);const y=fn(o,this.getToolName());return this.editData={annotation:m,viewportIdsToRender:y,handleIndex:1,movingTextBox:!1,newAnnotation:!0,hasMoved:!1},this._activateDraw(o),r.preventDefault(),ut(y),m},this.isPointNearTool=(r,i,a,o)=>{const s=et(r),{viewport:l}=s,{data:c}=i,{distanceToPoint:f,distanceToPoint2:u}=this.distanceToLines({viewport:l,points:c.handles.points,canvasCoords:a,proximity:o});return f<=o||u<=o},this.toolSelectedCallback=(r,i,a,o,s=6)=>{const l=r.detail,{element:c}=l;i.highlighted=!0;const f=fn(c,this.getToolName()),u=et(c),{renderingEngine:d,viewport:h}=u,{isNearFirstLine:p,isNearSecondLine:g}=this.distanceToLines({viewport:h,points:i.data.handles.points,canvasCoords:o,proximity:s});this.editData={annotation:i,viewportIdsToRender:f,movingTextBox:!1,isNearFirstLine:p,isNearSecondLine:g},this._activateModify(c),Rn(c),ut(f),r.preventDefault()},this._endCallback=r=>{const i=r.detail,{element:a}=i,{annotation:o,viewportIdsToRender:s,newAnnotation:l,hasMoved:c}=this.editData,{data:f}=o;if(l&&!c)return;if(this.doneEditMemo(),this.angleStartedNotYetCompleted&&f.handles.points.length<4){Kn(a),this.editData.handleIndex=f.handles.points.length;return}this.angleStartedNotYetCompleted=!1,f.handles.activeHandleIndex=null,this._deactivateModify(a),this._deactivateDraw(a),Kn(a);const u=et(a),{renderingEngine:d}=u;this.isHandleOutsideImage&&this.configuration.preventHandleOutsideImage&&Cr(o.annotationUID),ut(s),l&&Wr(o),this.editData=null,this.isDrawing=!1},this._mouseDownCallback=r=>{const{annotation:i,handleIndex:a}=this.editData,o=r.detail,{element:s,currentPoints:l}=o,c=l.world,{data:f}=i;if(a===1){f.handles.points[1]=c,this.editData.hasMoved=f.handles.points[1][0]!==f.handles.points[0][0]||f.handles.points[1][1]!==f.handles.points[0][0];return}if(a===3){f.handles.points[3]=c,this.editData.hasMoved=f.handles.points[3][0]!==f.handles.points[2][0]||f.handles.points[3][1]!==f.handles.points[2][0],this.angleStartedNotYetCompleted=!1;return}this.editData.hasMoved=!1,Rn(s),f.handles.points[2]=f.handles.points[3]=c,this.editData.handleIndex=f.handles.points.length-1},this._dragCallback=r=>{this.isDrawing=!0;const i=r.detail,{element:a}=i,{annotation:o,viewportIdsToRender:s,handleIndex:l,movingTextBox:c,isNearFirstLine:f,isNearSecondLine:u,newAnnotation:d}=this.editData;this.createMemo(a,o,{newAnnotation:d});const{data:h}=o;if(c){const{deltaPoints:m}=i,y=m.world,{textBox:v}=h.handles,{worldPosition:x}=v;x[0]+=y[0],x[1]+=y[1],x[2]+=y[2],v.hasMoved=!0}else if(l===void 0&&(f||u)){const{deltaPoints:m}=i,y=m.world,v=h.handles.points;f?[v[0],v[1]].forEach(w=>{w[0]+=y[0],w[1]+=y[1],w[2]+=y[2]}):u&&[v[2],v[3]].forEach(w=>{w[0]+=y[0],w[1]+=y[1],w[2]+=y[2]}),o.invalidated=!0}else{const{currentPoints:m}=i,y=m.world;h.handles.points[l]=[...y],o.invalidated=!0}this.editData.hasMoved=!0;const p=et(a),{renderingEngine:g}=p;ut(s),o.invalidated&&Fn(o,a,wn.HandlesUpdated)},this.cancel=r=>{if(!this.isDrawing)return;this.isDrawing=!1,this._deactivateDraw(r),this._deactivateModify(r),Kn(r);const{annotation:i,viewportIdsToRender:a,newAnnotation:o}=this.editData,{data:s}=i;s.handles.points.length<4&&Cr(i.annotationUID),i.highlighted=!1,s.handles.activeHandleIndex=null;const l=et(r),{renderingEngine:c}=l;return ut(a),o&&Wr(i),this.editData=null,this.angleStartedNotYetCompleted=!1,i.annotationUID},this._activateModify=r=>{Mt.isInteractingWithTool=!0,r.addEventListener(ee.MOUSE_UP,this._endCallback),r.addEventListener(ee.MOUSE_DRAG,this._dragCallback),r.addEventListener(ee.MOUSE_CLICK,this._endCallback),r.addEventListener(ee.TOUCH_END,this._endCallback),r.addEventListener(ee.TOUCH_DRAG,this._dragCallback),r.addEventListener(ee.TOUCH_START,this._mouseDownCallback),r.addEventListener(ee.TOUCH_TAP,this._endCallback)},this._deactivateModify=r=>{Mt.isInteractingWithTool=!1,r.removeEventListener(ee.MOUSE_UP,this._endCallback),r.removeEventListener(ee.MOUSE_DRAG,this._dragCallback),r.removeEventListener(ee.MOUSE_CLICK,this._endCallback),r.removeEventListener(ee.TOUCH_END,this._endCallback),r.removeEventListener(ee.TOUCH_DRAG,this._dragCallback),r.removeEventListener(ee.TOUCH_START,this._mouseDownCallback),r.removeEventListener(ee.TOUCH_TAP,this._endCallback)},this._activateDraw=r=>{Mt.isInteractingWithTool=!0,r.addEventListener(ee.MOUSE_UP,this._endCallback),r.addEventListener(ee.MOUSE_DRAG,this._dragCallback),r.addEventListener(ee.MOUSE_MOVE,this._dragCallback),r.addEventListener(ee.MOUSE_CLICK,this._endCallback),r.addEventListener(ee.MOUSE_DOWN,this._mouseDownCallback),r.addEventListener(ee.TOUCH_END,this._endCallback),r.addEventListener(ee.TOUCH_DRAG,this._dragCallback),r.addEventListener(ee.TOUCH_START,this._mouseDownCallback),r.addEventListener(ee.TOUCH_TAP,this._endCallback)},this._deactivateDraw=r=>{Mt.isInteractingWithTool=!1,r.removeEventListener(ee.MOUSE_UP,this._endCallback),r.removeEventListener(ee.MOUSE_DRAG,this._dragCallback),r.removeEventListener(ee.MOUSE_MOVE,this._dragCallback),r.removeEventListener(ee.MOUSE_CLICK,this._endCallback),r.removeEventListener(ee.MOUSE_DOWN,this._mouseDownCallback),r.removeEventListener(ee.TOUCH_END,this._endCallback),r.removeEventListener(ee.TOUCH_DRAG,this._dragCallback),r.removeEventListener(ee.TOUCH_START,this._mouseDownCallback),r.removeEventListener(ee.TOUCH_TAP,this._endCallback)},this.renderAnnotation=(r,i)=>{let a=!1;const{viewport:o}=r,{element:s}=o;let l=Wi(this.getToolName(),s);if(!l?.length||(l=this.filterInteractableAnnotationsForElement(s,l),!l?.length))return a;const c=this.getTargetId(o),f=o.getRenderingEngine(),u={toolGroupId:this.toolGroupId,toolName:this.getToolName(),viewportId:r.viewport.id};for(let d=0;d<l.length;d++){const h=l[d],{annotationUID:p,data:g}=h,{points:m,activeHandleIndex:y}=g.handles;u.annotationUID=p;const{color:v,lineWidth:x,lineDash:w}=this.getAnnotationStyle({annotation:h,styleSpecifier:u}),S=m.map(we=>o.worldToCanvas(we));!g.cachedStats[c]||g.cachedStats[c].angle==null?(g.cachedStats[c]={angle:null,arc1Angle:null,arc2Angle:null,points:{world:{arc1Start:null,arc1End:null,arc2Start:null,arc2End:null,arc1Angle:null,arc2Angle:null},canvas:{arc1Start:null,arc1End:null,arc2Start:null,arc2End:null,arc1Angle:null,arc2Angle:null}}},this._calculateCachedStats(h,f,r)):h.invalidated&&this._throttledCalculateCachedStats(h,f,r);let T;if(!uo(p)&&!this.editData&&y!==null&&(T=[S[y]]),!o.getRenderingEngine())return console.warn("Rendering Engine has been destroyed"),a;if(!fo(p))continue;T&&ho(i,p,"0",S,{color:v,lineDash:w,lineWidth:x});const _=[S[0],S[1]],D=[S[2],S[3]];let I="line1";if(Aa(i,p,I,_[0],_[1],{color:v,width:x,lineDash:w}),a=!0,S.length<4)return a;I="line2",Aa(i,p,I,D[0],D[1],{color:v,width:x,lineDash:w}),I="linkLine";const R=af(_[0],_[1]),M=af(D[0],D[1]);Aa(i,p,I,R,M,{color:v,lineWidth:"1",lineDash:"1,4"});const{arc1Start:A,arc1End:L,arc2End:P,arc2Start:B}=g.cachedStats[c].points.canvas,{arc1Angle:U,arc2Angle:G}=g.cachedStats[c];if(this.configuration.showArcLines&&(I="arc1",Aa(i,p,I,A,L,{color:v,lineWidth:"1"}),I="arc2",Aa(i,p,I,B,P,{color:v,lineWidth:"1"})),!g.cachedStats[c]?.angle)continue;const F=this.getLinkedTextBoxStyle(u,h);if(!F.visibility){g.handles.textBox={hasMoved:!1,worldPosition:[0,0,0],worldBoundingBox:{topLeft:[0,0,0],topRight:[0,0,0],bottomLeft:[0,0,0],bottomRight:[0,0,0]}};continue}const $=this.configuration.getTextLines(g,c);if(!g.handles.textBox.hasMoved){const we=Du(S);g.handles.textBox.worldPosition=o.canvasToWorld(we)}const V=o.worldToCanvas(g.handles.textBox.worldPosition),Q=rl(i,p,"cobbAngleText",$,V,S,{},F),{x:re,y:ye,width:me,height:Ce}=Q;if(g.handles.textBox.worldBoundingBox={topLeft:o.canvasToWorld([re,ye]),topRight:o.canvasToWorld([re+me,ye]),bottomLeft:o.canvasToWorld([re,ye+Ce]),bottomRight:o.canvasToWorld([re+me,ye+Ce])},this.configuration.showArcLines){const we="arcAngle1",Ae=[`${U.toFixed(2)} °`],De=af(A,L);N2(i,p,we,Ae,De,{...F,padding:3});const q="arcAngle2",k=[`${G.toFixed(2)} °`],J=af(B,P);N2(i,p,q,k,J,{...F,padding:3})}}return a},this.distanceToLines=({viewport:r,points:i,canvasCoords:a,proximity:o})=>{const[s,l,c,f]=i,u=r.worldToCanvas(s),d=r.worldToCanvas(l),h=r.worldToCanvas(c),p=r.worldToCanvas(f),g={start:{x:u[0],y:u[1]},end:{x:d[0],y:d[1]}},m={start:{x:h[0],y:h[1]},end:{x:p[0],y:p[1]}},y=Il([g.start.x,g.start.y],[g.end.x,g.end.y],[a[0],a[1]]),v=Il([m.start.x,m.start.y],[m.end.x,m.end.y],[a[0],a[1]]);let x=!1,w=!1;return y<=o?x=!0:v<=o&&(w=!0),{distanceToPoint:y,distanceToPoint2:v,isNearFirstLine:x,isNearSecondLine:w}},this.getArcsStartEndPoints=({firstLine:r,secondLine:i,mid1:a,mid2:o})=>{const s=[a,o],l=Mb(r,s),c=Mb(i,s),f=l>90?1:0,u=c>90?0:1,d=af(s[0],s[1]),h=Math.sqrt((s[1][0]-s[0][0])**2+(s[1][1]-s[0][1])**2),p=.1,g=af(r[0],r[1]),m=af(i[0],i[1]),y=[r[f][0]-g[0],r[f][1]-g[1]],v=Math.sqrt(y[0]**2+y[1]**2),x=[y[0]/v,y[1]/v],w=[g[0]+x[0]*h*p,g[1]+x[1]*h*p],S=[d[0]-a[0],d[1]-a[1]],T=Math.sqrt(S[0]**2+S[1]**2),_=[S[0]/T,S[1]/T],D=[a[0]+_[0]*h*p,a[1]+_[1]*h*p],I=[i[u][0]-m[0],i[u][1]-m[1]],R=Math.sqrt(I[0]**2+I[1]**2),M=[I[0]/R,I[1]/R],A=[m[0]+M[0]*h*p,m[1]+M[1]*h*p],L=[d[0]-o[0],d[1]-o[1]],P=Math.sqrt(L[0]**2+L[1]**2),B=[L[0]/P,L[1]/P],U=[o[0]+B[0]*h*p,o[1]+B[1]*h*p];return{arc1Start:w,arc1End:D,arc2Start:A,arc2End:U,arc1Angle:l>90?180-l:l,arc2Angle:c>90?180-c:c}},this._throttledCalculateCachedStats=Bl(this._calculateCachedStats,25,{trailing:!0})}handleSelectedCallback(e,n,r,i="mouse"){const a=e.detail,{element:o}=a,{data:s}=n;n.highlighted=!0;let l=!1,c;r.worldPosition?l=!0:c=s.handles.points.findIndex(u=>u===r);const f=fn(o,this.getToolName());this.editData={annotation:n,viewportIdsToRender:f,handleIndex:c,movingTextBox:l},this._activateModify(o),Rn(o),ut(f),e.preventDefault()}_calculateCachedStats(e,n,r){const i=e.data;if(i.handles.points.length!==4)return;const a=[null,null],o=[null,null];let s=Number.MAX_VALUE;for(let D=0;D<2;D+=1)for(let I=2;I<4;I+=1){const R=el(i.handles.points[D],i.handles.points[I]);R<s&&(s=R,a[1]=i.handles.points[D],a[0]=i.handles.points[(D+1)%2],o[0]=i.handles.points[I],o[1]=i.handles.points[2+(I-1)%2])}const{viewport:l}=r,{element:c}=l,f=i.handles.points.map(D=>l.worldToCanvas(D)),u=[f[0],f[1]],d=[f[2],f[3]],h=af(u[0],u[1]),p=af(d[0],d[1]),{arc1Start:g,arc1End:m,arc2End:y,arc2Start:v,arc1Angle:x,arc2Angle:w}=this.getArcsStartEndPoints({firstLine:u,secondLine:d,mid1:h,mid2:p}),{cachedStats:S}=i,T=Object.keys(S);for(let D=0;D<T.length;D++){const I=T[D];S[I]={angle:Mb(a,o),arc1Angle:x,arc2Angle:w,points:{canvas:{arc1Start:g,arc1End:m,arc2End:y,arc2Start:v},world:{arc1Start:l.canvasToWorld(g),arc1End:l.canvasToWorld(m),arc2End:l.canvasToWorld(y),arc2Start:l.canvasToWorld(v)}}}}const _=e.invalidated;return e.invalidated=!1,_&&Fn(e,c,wn.StatsUpdated),S}};iO.toolName="CobbAngle";let Ud=iO;function wUe(t,e){const n=t.cachedStats[e],{angle:r}=n;return r===void 0?void 0:[`${r.toFixed(2)} °`]}const{transformWorldToIndex:IF}=Hr,aO=class aO extends na{constructor(e={},n={supportedInteractionTypes:["Mouse","Touch"],configuration:{shadow:!0,preventHandleOutsideImage:!1,getTextLines:CUe,displayBothAxesDistances:!1}}){super(e,n),this.addNewAnnotation=r=>{if(this.startedDrawing)return;this.startedDrawing=!0;const i=r.detail,{currentPoints:a,element:o}=i,s=a.world,l=et(o),{viewport:c,renderingEngine:f}=l;if(!(c instanceof aa))throw new Error("UltrasoundDirectionalTool can only be used on a StackViewport");Rn(o),this.isDrawing=!0;const u=c.getCamera(),{viewPlaneNormal:d,viewUp:h}=u,p=this.getReferencedImageId(c,s,d,h),g=c.getFrameOfReferenceUID(),m={highlighted:!0,invalidated:!0,metadata:{toolName:this.getToolName(),viewPlaneNormal:[...d],viewUp:[...h],FrameOfReferenceUID:g,referencedImageId:p},data:{handles:{points:[[...s],[...s]],activeHandleIndex:null,textBox:{hasMoved:!1,worldPosition:[0,0,0],worldBoundingBox:{topLeft:[0,0,0],topRight:[0,0,0],bottomLeft:[0,0,0],bottomRight:[0,0,0]}}},label:"",cachedStats:{}}};hr(m,o);const y=fn(o,this.getToolName());return this.editData={annotation:m,viewportIdsToRender:y,handleIndex:1,movingTextBox:!1,newAnnotation:!0,hasMoved:!1},this._activateDraw(o),r.preventDefault(),ut(y),m},this.isPointNearTool=(r,i,a,o)=>{const s=et(r),{viewport:l}=s,{data:c}=i,[f,u]=c.handles.points,d=l.worldToCanvas(f),h=l.worldToCanvas(u),p={start:{x:d[0],y:d[1]},end:{x:h[0],y:h[1]}};return Il([p.start.x,p.start.y],[p.end.x,p.end.y],[a[0],a[1]])<=o},this._endCallback=r=>{const i=r.detail,{element:a}=i,{annotation:o,viewportIdsToRender:s,newAnnotation:l,hasMoved:c}=this.editData,{data:f}=o;if(l&&!c)return;if(this.startedDrawing&&f.handles.points.length===1){this.editData.handleIndex=1;return}this.startedDrawing=!1,f.handles.activeHandleIndex=null,this._deactivateModify(a),this._deactivateDraw(a),Kn(a);const u=et(a),{renderingEngine:d}=u;this.isHandleOutsideImage&&this.configuration.preventHandleOutsideImage&&Cr(o.annotationUID),ut(s),l&&Wr(o),this.editData=null,this.isDrawing=!1},this._dragCallback=r=>{this.isDrawing=!0;const i=r.detail,{element:a}=i,{annotation:o,viewportIdsToRender:s,handleIndex:l,movingTextBox:c}=this.editData,{data:f}=o;if(c){const{deltaPoints:h}=i,p=h.world,{textBox:g}=f.handles,{worldPosition:m}=g;m[0]+=p[0],m[1]+=p[1],m[2]+=p[2],g.hasMoved=!0}else if(l===void 0){const{deltaPoints:h}=i,p=h.world;f.handles.points.forEach(m=>{m[0]+=p[0],m[1]+=p[1],m[2]+=p[2]}),o.invalidated=!0}else{const{currentPoints:h}=i,p=h.world;f.handles.points[l]=[...p],o.invalidated=!0}this.editData.hasMoved=!0;const u=et(a),{renderingEngine:d}=u;ut(s)},this.cancel=r=>{if(this.isDrawing){this.isDrawing=!1,this._deactivateDraw(r),this._deactivateModify(r),Kn(r);const{annotation:i,viewportIdsToRender:a,newAnnotation:o}=this.editData,{data:s}=i;return i.highlighted=!1,s.handles.activeHandleIndex=null,ut(a),o&&Wr(i),this.editData=null,this.startedDrawing=!1,i.annotationUID}},this._activateModify=r=>{Mt.isInteractingWithTool=!0,r.addEventListener(ee.MOUSE_UP,this._endCallback),r.addEventListener(ee.MOUSE_DRAG,this._dragCallback),r.addEventListener(ee.MOUSE_CLICK,this._endCallback),r.addEventListener(ee.TOUCH_TAP,this._endCallback),r.addEventListener(ee.TOUCH_END,this._endCallback),r.addEventListener(ee.TOUCH_DRAG,this._dragCallback)},this._deactivateModify=r=>{Mt.isInteractingWithTool=!1,r.removeEventListener(ee.MOUSE_UP,this._endCallback),r.removeEventListener(ee.MOUSE_DRAG,this._dragCallback),r.removeEventListener(ee.MOUSE_CLICK,this._endCallback),r.removeEventListener(ee.TOUCH_TAP,this._endCallback),r.removeEventListener(ee.TOUCH_END,this._endCallback),r.removeEventListener(ee.TOUCH_DRAG,this._dragCallback)},this._activateDraw=r=>{Mt.isInteractingWithTool=!0,r.addEventListener(ee.MOUSE_UP,this._endCallback),r.addEventListener(ee.MOUSE_DRAG,this._dragCallback),r.addEventListener(ee.MOUSE_MOVE,this._dragCallback),r.addEventListener(ee.MOUSE_CLICK,this._endCallback),r.addEventListener(ee.TOUCH_TAP,this._endCallback),r.addEventListener(ee.TOUCH_END,this._endCallback),r.addEventListener(ee.TOUCH_DRAG,this._dragCallback)},this._deactivateDraw=r=>{Mt.isInteractingWithTool=!1,r.removeEventListener(ee.MOUSE_UP,this._endCallback),r.removeEventListener(ee.MOUSE_DRAG,this._dragCallback),r.removeEventListener(ee.MOUSE_MOVE,this._dragCallback),r.removeEventListener(ee.MOUSE_CLICK,this._endCallback),r.removeEventListener(ee.TOUCH_TAP,this._endCallback),r.removeEventListener(ee.TOUCH_END,this._endCallback),r.removeEventListener(ee.TOUCH_DRAG,this._dragCallback)},this.renderAnnotation=(r,i)=>{let a=!1;const{viewport:o}=r,{element:s}=o;let l=Wi(this.getToolName(),s);if(!l?.length||(l=this.filterInteractableAnnotationsForElement(s,l),!l?.length))return a;const c=this.getTargetId(o),f=o.getRenderingEngine(),u={toolGroupId:this.toolGroupId,toolName:this.getToolName(),viewportId:r.viewport.id};for(let d=0;d<l.length;d++){const h=l[d],{annotationUID:p,data:g}=h,{points:m}=g.handles;u.annotationUID=p;const y=this.getStyle("color",u,h),v=m.map(P=>o.worldToCanvas(P));if(!g.cachedStats[c]||g.cachedStats[c].xValues==null?(g.cachedStats[c]={xValues:[0,0],yValues:[0,0],isHorizontal:!1,units:[""],isUnitless:!1},this._calculateCachedStats(h,f,r)):h.invalidated&&this._throttledCalculateCachedStats(h,f,r),!o.getRenderingEngine())return console.warn("Rendering Engine has been destroyed"),a;let x="0";if(Q6(i,p,x,v[0],{color:y},0),a=!0,v.length!==2)return a;if(x="1",Q6(i,p,x,v[1],{color:y},1),g.cachedStats[c].isUnitless){const P=`${p}-line-1`;Aa(i,p,"1",v[0],v[1],{color:y,width:1,shadow:this.configuration.shadow},P)}else{const P=v[0],B=v[1],U=B[1]-P[1],G=B[0]-P[0],F=g.cachedStats[c].isHorizontal;let $=[0,0];F?$=[P[0]+G,P[1]]:$=[P[0],P[1]+U];let V=`${p}-line-1`,X="1";Aa(i,p,X,v[0],$,{color:y,width:1,shadow:this.configuration.shadow},V),V=`${p}-line-2`,X="2",Aa(i,p,X,v[1],$,{color:y,width:1,lineDash:[1,1],shadow:this.configuration.shadow},V)}const S=this.getLinkedTextBoxStyle(u,h);if(!S.visibility){g.handles.textBox={hasMoved:!1,worldPosition:[0,0,0],worldBoundingBox:{topLeft:[0,0,0],topRight:[0,0,0],bottomLeft:[0,0,0],bottomRight:[0,0,0]}};continue}const T=this.configuration.getTextLines(g,c,this.configuration);if(!g.handles.textBox.hasMoved){const P=v[1];g.handles.textBox.worldPosition=o.canvasToWorld(P)}const _=o.worldToCanvas(g.handles.textBox.worldPosition),I=rl(i,p,"1",T,_,v,{},S),{x:R,y:M,width:A,height:L}=I;g.handles.textBox.worldBoundingBox={topLeft:o.canvasToWorld([R,M]),topRight:o.canvasToWorld([R+A,M]),bottomLeft:o.canvasToWorld([R,M+L]),bottomRight:o.canvasToWorld([R+A,M+L])}}return a},this._throttledCalculateCachedStats=Bl(this._calculateCachedStats,100,{trailing:!0})}toolSelectedCallback(e,n,r,i){}handleSelectedCallback(e,n,r){const i=e.detail,{element:a}=i,{data:o}=n;n.highlighted=!0;const s=fn(a,this.getToolName());let l;r.worldPosition||(l=o.handles.points.findIndex(u=>u===r)),this.editData={handleIndex:l,annotation:n,viewportIdsToRender:s},this._activateModify(a),Rn(a);const c=et(a),{renderingEngine:f}=c;ut(s),e.preventDefault()}_calculateCachedStats(e,n,r){const i=e.data,{element:a}=r.viewport;if(i.handles.points.length!==2)return;const{cachedStats:o}=i,s=Object.keys(o);for(let c=0;c<s.length;c++){const f=s[c],u=this.getTargetImageData(f);if(!u)continue;const{imageData:d}=u,h=i.handles.points[0],p=i.handles.points[1],g=IF(d,h),m=IF(d,p),{values:y,units:v}=t_(u,[g]),{values:x,units:w}=t_(u,[m]);let S,T,_,D,I=!1;if(v[0]!==w[0]||v[1]!==w[1]||v[0]==="raw"&&w[0]==="raw"){const R=hp(h,p);S=[R,0],T=[R,0],_=["px"],I=!0}else{const R=r.viewport.worldToCanvas(h),M=r.viewport.worldToCanvas(p),A=M[1]-R[1],L=M[0]-R[0];D=Math.abs(L)>Math.abs(A),S=[y[0],x[0]],T=[y[1],x[1]],_=[v[0],v[1]]}o[f]={xValues:S,yValues:T,isHorizontal:D,units:_,isUnitless:I}}const l=e.invalidated;return e.invalidated=!1,l&&Fn(e,a,wn.StatsUpdated),o}};aO.toolName="UltrasoundDirectionalTool";let Bd=aO;function CUe(t,e,n){const r=t.cachedStats[e],{xValues:i,yValues:a,units:o,isUnitless:s,isHorizontal:l}=r;if(s)return[`${kn(i[0])} px`];if(n.displayBothAxesDistances){const c=Math.abs(i[1]-i[0]),f=Math.abs(a[1]-a[0]);return[`${kn(c)} ${o[0]}`,`${kn(f)} ${o[1]}`]}if(l){const c=Math.abs(i[1]-i[0]);return[`${kn(c)} ${o[0]}`]}else{const c=Math.abs(a[1]-a[0]);return[`${kn(c)} ${o[1]}`]}}function SUe(t,e,n=!0){const r=Object.assign({},e,{segmentIndex:0});Wee(t,r)}function TUe(t,e){SUe(t,e,!0)}class ch extends xm{constructor(e={},n={supportedInteractionTypes:["Mouse","Touch"],configuration:{strategies:{FILL_INSIDE:Wee,ERASE_INSIDE:TUe},defaultStrategy:"FILL_INSIDE",activeStrategy:"FILL_INSIDE"}}){super(e,n),this.preMouseDownCallback=r=>{if(this.isDrawing===!0)return;const i=r.detail,{currentPoints:a,element:o}=i,s=a.world,l=et(o),{viewport:c}=l;this.isDrawing=!0;const f=c.getCamera(),{viewPlaneNormal:u,viewUp:d}=f,h=TC(c.id);if(!h)throw new Error("No active segmentation detected, create one before using scissors tool");const{segmentationId:p}=h,g=bu(p),m=xy(p),y=ip(c.id,p,g),{representationData:v}=Ki(p),x=v[pn.Labelmap],w={highlighted:!0,invalidated:!0,metadata:{viewPlaneNormal:[...u],viewUp:[...d],FrameOfReferenceUID:c.getFrameOfReferenceUID(),referencedImageId:"",toolName:this.getToolName(),segmentColor:y},data:{handles:{points:[[...s],[...s],[...s],[...s]],activeHandleIndex:null}}},S=fn(o,this.getToolName());if(this.editData={annotation:w,segmentIndex:g,segmentationId:p,segmentsLocked:m,segmentColor:y,viewportIdsToRender:S,handleIndex:3,movingTextBox:!1,newAnnotation:!0,hasMoved:!1,volumeId:null,referencedVolumeId:null,imageId:null},c instanceof lo){const{volumeId:T}=x,_=yt.getVolume(T);this.editData={...this.editData,volumeId:T,referencedVolumeId:_.referencedVolumeId}}else{const T=SC(c.id,p);this.editData={...this.editData,imageId:T}}return this._activateDraw(o),Rn(o),r.preventDefault(),ut(S),!0},this._dragCallback=r=>{this.isDrawing=!0;const i=r.detail,{element:a}=i,{annotation:o,viewportIdsToRender:s,handleIndex:l}=this.editData,{data:c}=o,{currentPoints:f}=i,u=et(a),{worldToCanvas:d,canvasToWorld:h}=u.viewport,p=f.world,{points:g}=c.handles;g[l]=[...p];let m,y,v,x,w,S,T,_;switch(l){case 0:case 3:m=d(g[0]),x=d(g[3]),y=[x[0],m[1]],v=[m[0],x[1]],S=h(y),T=h(v),g[1]=S,g[2]=T;break;case 1:case 2:y=d(g[1]),v=d(g[2]),m=[v[0],y[1]],x=[y[0],v[1]],w=h(m),_=h(x),g[0]=w,g[3]=_;break}o.invalidated=!0,this.editData.hasMoved=!0,ut(s)},this._endCallback=r=>{const i=r.detail,{element:a}=i,{annotation:o,newAnnotation:s,hasMoved:l}=this.editData,{data:c}=o;if(s&&!l)return;c.handles.activeHandleIndex=null,this._deactivateDraw(a),Kn(a);const f=et(a),u={...this.editData,points:c.handles.points,createMemo:this.createMemo.bind(this)};this.editData=null,this.isDrawing=!1,this.applyActiveStrategy(f,u),this.doneEditMemo()},this._activateDraw=r=>{r.addEventListener(ee.MOUSE_UP,this._endCallback),r.addEventListener(ee.MOUSE_DRAG,this._dragCallback),r.addEventListener(ee.MOUSE_MOVE,this._dragCallback),r.addEventListener(ee.MOUSE_CLICK,this._endCallback),r.addEventListener(ee.TOUCH_END,this._endCallback),r.addEventListener(ee.TOUCH_DRAG,this._dragCallback),r.addEventListener(ee.TOUCH_TAP,this._endCallback)},this._deactivateDraw=r=>{r.removeEventListener(ee.MOUSE_UP,this._endCallback),r.removeEventListener(ee.MOUSE_DRAG,this._dragCallback),r.removeEventListener(ee.MOUSE_MOVE,this._dragCallback),r.removeEventListener(ee.MOUSE_CLICK,this._endCallback),r.removeEventListener(ee.TOUCH_TAP,this._endCallback),r.removeEventListener(ee.TOUCH_END,this._endCallback),r.removeEventListener(ee.TOUCH_DRAG,this._dragCallback)},this.renderAnnotation=(r,i)=>{let a=!1;if(!this.editData)return a;const{viewport:o}=r,{annotation:s}=this.editData,l=s.metadata,c=s.annotationUID,f=s.data,{points:u}=f.handles,d=u.map(g=>o.worldToCanvas(g)),h=`rgb(${l.segmentColor.slice(0,3)})`;return o.getRenderingEngine()?(_7(i,c,"0",d[0],d[3],{color:h}),a=!0,a):(console.warn("Rendering Engine has been destroyed"),a)}}}ch.toolName="RectangleScissor";class uh extends xm{constructor(e={},n={supportedInteractionTypes:["Mouse","Touch"],configuration:{strategies:{FILL_INSIDE:F7,ERASE_INSIDE:Gee},defaultStrategy:"FILL_INSIDE",activeStrategy:"FILL_INSIDE"}}){super(e,n),this.preMouseDownCallback=r=>{if(this.isDrawing===!0)return;const i=r.detail,{currentPoints:a,element:o}=i,s=a.world,l=a.canvas,c=et(o),{viewport:f}=c;this.isDrawing=!0;const u=f.getCamera(),{viewPlaneNormal:d,viewUp:h}=u,p=TC(f.id);if(!p)throw new Error("No active segmentation detected, create one before using scissors tool");const{segmentationId:g}=p,m=bu(g),y=xy(g),v=ip(f.id,g,m),{representationData:x}=Ki(g),w=x.Labelmap;if(!w)throw new Error("No labelmap data found for the active segmentation, create one before using scissors tool");const S={invalidated:!0,highlighted:!0,metadata:{viewPlaneNormal:[...d],viewUp:[...h],FrameOfReferenceUID:f.getFrameOfReferenceUID(),referencedImageId:"",toolName:this.getToolName(),segmentColor:v},data:{handles:{points:[[...s],[...s],[...s],[...s]],activeHandleIndex:null},isDrawing:!0,cachedStats:{}}},T=[f.id];if(this.editData={annotation:S,centerCanvas:l,segmentIndex:m,segmentationId:g,segmentsLocked:y,segmentColor:v,viewportIdsToRender:T,handleIndex:3,movingTextBox:!1,newAnnotation:!0,hasMoved:!1,volumeId:null,referencedVolumeId:null,imageId:null},f instanceof lo){const{volumeId:_}=w,D=yt.getVolume(_);this.editData={...this.editData,volumeId:_,referencedVolumeId:D.referencedVolumeId}}else{const _=SC(f.id,g);this.editData={...this.editData,imageId:_}}return this._activateDraw(o),Rn(o),r.preventDefault(),ut(T),!0},this._dragCallback=r=>{this.isDrawing=!0;const i=r.detail,{element:a}=i,{currentPoints:o}=i,s=o.canvas,l=et(a),{renderingEngine:c,viewport:f}=l,{canvasToWorld:u}=f,{annotation:d,viewportIdsToRender:h,centerCanvas:p}=this.editData,{data:g}=d,m=Math.abs(s[0]-p[0]),y=Math.abs(s[1]-p[1]),v=Math.sqrt(m*m+y*y),x=[p[0],p[1]+v],w=[p[0],p[1]-v],S=[p[0]-v,p[1]],T=[p[0]+v,p[1]];g.handles.points=[u(x),u(w),u(S),u(T)],d.invalidated=!0,this.editData.hasMoved=!0,ut(h)},this._endCallback=r=>{const i=r.detail,{element:a}=i,{annotation:o,newAnnotation:s,hasMoved:l}=this.editData,{data:c}=o,{viewPlaneNormal:f,viewUp:u}=o.metadata;if(s&&!l)return;c.handles.activeHandleIndex=null,this._deactivateDraw(a),Kn(a);const d=et(a),h={...this.editData,points:c.handles.points,viewPlaneNormal:f,viewUp:u,createMemo:this.createMemo.bind(this)};this.editData=null,this.isDrawing=!1,this.applyActiveStrategy(d,h),this.doneEditMemo()},this._activateDraw=r=>{r.addEventListener(ee.MOUSE_UP,this._endCallback),r.addEventListener(ee.MOUSE_DRAG,this._dragCallback),r.addEventListener(ee.MOUSE_CLICK,this._endCallback),r.addEventListener(ee.MOUSE_MOVE,this._dragCallback),r.addEventListener(ee.TOUCH_TAP,this._endCallback),r.addEventListener(ee.TOUCH_DRAG,this._dragCallback),r.addEventListener(ee.TOUCH_END,this._endCallback)},this._deactivateDraw=r=>{r.removeEventListener(ee.MOUSE_UP,this._endCallback),r.removeEventListener(ee.MOUSE_DRAG,this._dragCallback),r.removeEventListener(ee.MOUSE_CLICK,this._endCallback),r.removeEventListener(ee.MOUSE_MOVE,this._dragCallback),r.removeEventListener(ee.TOUCH_END,this._endCallback),r.removeEventListener(ee.TOUCH_DRAG,this._dragCallback),r.removeEventListener(ee.TOUCH_TAP,this._endCallback)},this.renderAnnotation=(r,i)=>{let a=!1;if(!this.editData)return a;const{viewport:o}=r,{viewportIdsToRender:s}=this.editData;if(!s.includes(o.id))return a;const{annotation:l}=this.editData,c=l.metadata,f=l.annotationUID,u=l.data,{points:d}=u.handles,h=d.map(w=>o.worldToCanvas(w)),p=h[0],g=h[1],m=[Math.floor((p[0]+g[0])/2),Math.floor((p[1]+g[1])/2)],y=Math.abs(p[1]-Math.floor((p[1]+g[1])/2)),v=`rgb(${c.segmentColor.slice(0,3)})`;return o.getRenderingEngine()?(S0(i,f,"0",m,y,{color:v}),a=!0,a):(console.warn("Rendering Engine has been destroyed"),a)}}}uh.toolName="CircleScissor";class fh extends xm{constructor(e={},n={supportedInteractionTypes:["Mouse","Touch"],configuration:{strategies:{FILL_INSIDE:Bee,ERASE_INSIDE:$ee},defaultStrategy:"FILL_INSIDE",activeStrategy:"FILL_INSIDE"}}){super(e,n),this.preMouseDownCallback=r=>{if(this.isDrawing===!0)return;this.doneEditMemo();const i=r.detail,{currentPoints:a,element:o}=i,s=a.world,l=a.canvas,c=et(o),{viewport:f}=c;this.isDrawing=!0;const u=f.getCamera(),{viewPlaneNormal:d,viewUp:h}=u,p=TC(f.id);if(!p)throw new Error("No active segmentation detected, create one before using scissors tool");const{segmentationId:g}=p,m=bu(g),y=xy(g),v=ip(f.id,g,m);this.isDrawing=!0;const x={metadata:{viewPlaneNormal:[...d],viewUp:[...h],FrameOfReferenceUID:f.getFrameOfReferenceUID(),referencedImageId:"",toolName:this.getToolName(),segmentColor:v},data:{invalidated:!0,handles:{points:[[...s],[...s],[...s],[...s]],activeHandleIndex:null},cachedStats:{},highlighted:!0}},w=[f.id];this.editData={annotation:x,centerCanvas:l,segmentIndex:m,segmentationId:g,segmentsLocked:y,segmentColor:v,toolGroupId:this.toolGroupId,viewportIdsToRender:w,handleIndex:3,movingTextBox:!1,newAnnotation:!0,hasMoved:!1,volumeId:null,referencedVolumeId:null,imageId:null};const{representationData:S}=Ki(g),T=this.getEditData({viewport:f,representationData:S,segmentsLocked:y,segmentationId:g});return this.editData={...this.editData,...T},this._activateDraw(o),Rn(o),r.preventDefault(),ut(w),!0},this._dragCallback=r=>{this.isDrawing=!0;const i=r.detail,{element:a}=i,{currentPoints:o}=i,s=o.canvas,l=et(a),{renderingEngine:c,viewport:f}=l,{canvasToWorld:u}=f,{annotation:d,viewportIdsToRender:h,centerCanvas:p}=this.editData,{data:g}=d,m=Math.abs(s[0]-p[0]),y=Math.abs(s[1]-p[1]),v=Math.sqrt(m*m+y*y),x=[p[0],p[1]+v],w=[p[0],p[1]-v],S=[p[0]-v,p[1]],T=[p[0]+v,p[1]];g.handles.points=[u(x),u(w),u(S),u(T)],d.invalidated=!0,this.editData.hasMoved=!0,ut(h)},this._endCallback=r=>{const i=r.detail,{element:a}=i,{annotation:o,newAnnotation:s,hasMoved:l,segmentIndex:c,segmentsLocked:f}=this.editData,{data:u}=o,{viewPlaneNormal:d,viewUp:h}=o.metadata;if(s&&!l)return;o.highlighted=!1,u.handles.activeHandleIndex=null,this._deactivateDraw(a),Kn(a);const p=et(a),g={...this.editData,points:u.handles.points,segmentIndex:c,segmentsLocked:f,viewPlaneNormal:d,viewUp:h,createMemo:this.createMemo.bind(this)};this.editData=null,this.isDrawing=!1,this.applyActiveStrategy(p,g),this.doneEditMemo()},this._activateDraw=r=>{r.addEventListener(ee.MOUSE_UP,this._endCallback),r.addEventListener(ee.MOUSE_DRAG,this._dragCallback),r.addEventListener(ee.MOUSE_CLICK,this._endCallback),r.addEventListener(ee.MOUSE_MOVE,this._dragCallback),r.addEventListener(ee.TOUCH_END,this._endCallback),r.addEventListener(ee.TOUCH_TAP,this._endCallback),r.addEventListener(ee.TOUCH_DRAG,this._dragCallback)},this._deactivateDraw=r=>{r.removeEventListener(ee.MOUSE_UP,this._endCallback),r.removeEventListener(ee.MOUSE_DRAG,this._dragCallback),r.removeEventListener(ee.MOUSE_CLICK,this._endCallback),r.removeEventListener(ee.MOUSE_MOVE,this._dragCallback),r.removeEventListener(ee.TOUCH_END,this._endCallback),r.removeEventListener(ee.TOUCH_DRAG,this._dragCallback),r.removeEventListener(ee.TOUCH_TAP,this._endCallback)},this.renderAnnotation=(r,i)=>{let a=!1;if(!this.editData)return a;const{viewport:o}=r,{viewportIdsToRender:s}=this.editData;if(!s.includes(o.id))return a;const{annotation:l}=this.editData,c=l.metadata,f=l.annotationUID,u=l.data,{points:d}=u.handles,h=d.map(w=>o.worldToCanvas(w)),p=h[0],g=h[1],m=[Math.floor((p[0]+g[0])/2),Math.floor((p[1]+g[1])/2)],y=Math.abs(p[1]-Math.floor((p[1]+g[1])/2)),v=`rgb(${c.segmentColor.slice(0,3)})`;return o.getRenderingEngine()?(S0(i,f,"0",m,y,{color:v}),a=!0,a):(console.warn("Rendering Engine has been destroyed"),a)}}}fh.toolName="SphereScissor";function qee(t,e,n){if(t===void 0)throw new Error("decodeRGB: rgbBuffer must be defined");if(t.length%3!==0)throw new Error(`decodeRGB: rgbBuffer length ${t.length} must be divisible by 3`);const r=t.length/3;let i=0,a=0;if(n){for(let o=0;o<r;o++)e[a++]=t[i++],e[a++]=t[i++],e[a++]=t[i++],e[a++]=255;return}e.set(t)}function Xee(t,e,n){if(t===void 0)throw new Error("decodeRGB: rgbBuffer must be defined");if(t.length%3!==0)throw new Error(`decodeRGB: rgbBuffer length ${t.length} must be divisible by 3`);const r=t.length/3;let i=0,a=0,o=r,s=r*2;if(n)for(let l=0;l<r;l++)e[i++]=t[a++],e[i++]=t[o++],e[i++]=t[s++],e[i++]=255;else for(let l=0;l<r;l++)e[i++]=t[a++],e[i++]=t[o++],e[i++]=t[s++]}function Yee(t,e,n){if(t===void 0)throw new Error("convertYBRFullByPixel: ybrBuffer must be defined");if(t.length%3!==0)throw new Error(`convertYBRFullByPixel: ybrBuffer length ${t.length} must be divisible by 3`);const r=t.length/3;let i=0,a=0;if(n){for(let o=0;o<r;o++){const s=t[i++],l=t[i++],c=t[i++];e[a++]=s+1.402*(c-128),e[a++]=s-.34414*(l-128)-.71414*(c-128),e[a++]=s+1.772*(l-128),e[a++]=255}return}for(let o=0;o<r;o++){const s=t[i++],l=t[i++],c=t[i++];e[a++]=s+1.402*(c-128),e[a++]=s-.34414*(l-128)-.71414*(c-128),e[a++]=s+1.772*(l-128)}}function Jee(t,e,n){if(t===void 0)throw new Error("convertYBRFullByPlane: ybrBuffer must be defined");if(t.length%3!==0)throw new Error(`convertYBRFullByPlane: ybrBuffer length ${t.length} must be divisible by 3`);const r=t.length/3;let i=0,a=0,o=r,s=r*2;if(n){for(let l=0;l<r;l++){const c=t[a++],f=t[o++],u=t[s++];e[i++]=c+1.402*(u-128),e[i++]=c-.34414*(f-128)-.71414*(u-128),e[i++]=c+1.772*(f-128),e[i++]=255}return}for(let l=0;l<r;l++){const c=t[a++],f=t[o++],u=t[s++];e[i++]=c+1.402*(u-128),e[i++]=c-.34414*(f-128)-.71414*(u-128),e[i++]=c+1.772*(f-128)}}function EUe(t,e,n){if(t===void 0)throw new Error("convertYBRFull422ByPixel: ybrBuffer must be defined");if(t.length%2!==0)throw new Error(`convertYBRFull422ByPixel: ybrBuffer length ${t.length} must be divisible by 2`);const r=t.length/2;let i=0,a=0;if(n){for(let o=0;o<r;o+=2){const s=t[i++],l=t[i++],c=t[i++],f=t[i++];e[a++]=s+1.402*(f-128),e[a++]=s-.34414*(c-128)-.71414*(f-128),e[a++]=s+1.772*(c-128),e[a++]=255,e[a++]=l+1.402*(f-128),e[a++]=l-.34414*(c-128)-.71414*(f-128),e[a++]=l+1.772*(c-128),e[a++]=255}return}for(let o=0;o<r;o+=2){const s=t[i++],l=t[i++],c=t[i++],f=t[i++];e[a++]=s+1.402*(f-128),e[a++]=s-.34414*(c-128)-.71414*(f-128),e[a++]=s+1.772*(c-128),e[a++]=l+1.402*(f-128),e[a++]=l-.34414*(c-128)-.71414*(f-128),e[a++]=l+1.772*(c-128)}}function j8(t,e){const n=t.length,r=new Uint8ClampedArray(n);for(let i=0;i<n;++i)r[i]=t[i]>>e;return r}function z8(t,e,n){const r=t[`${e}PaletteColorLookupTableData`];if(r)return Promise.resolve(r);const i=Ft("imagePixelModule",t.imageId);return i&&typeof i.then=="function"?i.then(a=>a?a[`${e}PaletteColorLookupTableData`]:n):Promise.resolve(i?i[`${e}PaletteColorLookupTableData`]:n)}function Zee(t,e,n){const r=t.columns*t.rows,i=t.pixelData;Promise.all([z8(t,"red",null),z8(t,"green",null),z8(t,"blue",null)]).then(([a,o,s])=>{if(!a||!o||!s)throw new Error("The image does not have a complete color palette. R, G, and B palette data are required.");const l=a.length;let c=0,f=0;const u=t.redPaletteColorLookupTableDescriptor[1],d=t.redPaletteColorLookupTableDescriptor[2]===8?0:8,h=j8(a,d),p=j8(o,d),g=j8(s,d);if(n){for(let m=0;m<r;++m){let y=i[c++];y<u?y=0:y>u+l-1?y=l-1:y-=u,e[f++]=h[y],e[f++]=p[y],e[f++]=g[y],e[f++]=255}return}for(let m=0;m<r;++m){let y=i[c++];y<u?y=0:y>u+l-1?y=l-1:y-=u,e[f++]=h[y],e[f++]=p[y],e[f++]=g[y]}})}function W8(t,e){if(!(!t.elements[e]||t.elements[e].length!==6))return[t.uint16(e,0),t.uint16(e,1),t.uint16(e,2)]}function H8(t,e,n){const r=[],i=t.elements[e];for(let a=0;a<n[0];a++)n[2]===16?r[a]=t.uint16(e,a):r[a]=t.byteArray[a+i.dataOffset];return r}function _Ue(t,e){e.redPaletteColorLookupTableDescriptor=W8(t,"x00281101"),e.greenPaletteColorLookupTableDescriptor=W8(t,"x00281102"),e.bluePaletteColorLookupTableDescriptor=W8(t,"x00281103"),e.redPaletteColorLookupTableDescriptor[0]===0&&(e.redPaletteColorLookupTableDescriptor[0]=65536,e.greenPaletteColorLookupTableDescriptor[0]=65536,e.bluePaletteColorLookupTableDescriptor[0]=65536);const n=e.redPaletteColorLookupTableDescriptor[0],i=t.elements.x00281201.length===n?8:16;e.redPaletteColorLookupTableDescriptor[2]!==i&&(e.redPaletteColorLookupTableDescriptor[2]=i,e.greenPaletteColorLookupTableDescriptor[2]=i,e.bluePaletteColorLookupTableDescriptor[2]=i),e.redPaletteColorLookupTableData=H8(t,"x00281201",e.redPaletteColorLookupTableDescriptor),e.greenPaletteColorLookupTableData=H8(t,"x00281202",e.greenPaletteColorLookupTableDescriptor),e.bluePaletteColorLookupTableData=H8(t,"x00281203",e.bluePaletteColorLookupTableDescriptor)}function DUe(t,e){t.uint16("x00280103")===0?(e.smallestPixelValue=t.uint16("x00280106"),e.largestPixelValue=t.uint16("x00280107")):(e.smallestPixelValue=t.int16("x00280106"),e.largestPixelValue=t.int16("x00280107"))}function Qee(t){const e={samplesPerPixel:t.uint16("x00280002"),photometricInterpretation:t.string("x00280004"),rows:t.uint16("x00280010"),columns:t.uint16("x00280011"),bitsAllocated:t.uint16("x00280100"),bitsStored:t.uint16("x00280101"),highBit:t.uint16("x00280102"),pixelRepresentation:t.uint16("x00280103"),planarConfiguration:t.uint16("x00280006"),pixelAspectRatio:t.string("x00280034")};return DUe(t,e),e.photometricInterpretation==="PALETTE COLOR"&&t.elements.x00281101&&_Ue(t,e),e}function OUe(t,e){let n=e.uint16("x00283002",0);n===0&&(n=65535);let r=0;t===0?r=e.uint16("x00283002",1):r=e.int16("x00283002",1);const i=e.uint16("x00283002",2),a={id:"1",firstValueMapped:r,numBitsPerEntry:i,lut:[]};for(let o=0;o<n;o++)t===0?a.lut[o]=e.uint16("x00283006",o):a.lut[o]=e.int16("x00283006",o);return a}function o_(t,e){if(!e||!e.items||!e.items.length)return;const n=[];for(let r=0;r<e.items.length;r++){const i=e.items[r].dataSet,a=OUe(t,i);a&&n.push(a)}return n}function MUe(t){const e=t.uint16("x00280103"),n=t.uint16("x00280101");return e===0?0:-1<<n-1}function ete(t){const e=t.string("x00080016");if(e==="1.2.840.10008.5.1.4.1.1.2"||e==="1.2.840.10008.5.1.4.1.1.2.1")return 1;const n=t.floatString("x00281052"),r=t.floatString("x00281053");return n!==void 0&&r!==void 0?MUe(t)*r+n<0?1:0:t.elements.x00283000&&t.elements.x00283000.length>0?0:t.uint16("x00280103")}function xc(t,e,n){const r=[],i=t.string(e);if(!i)return;const a=i.split("\\");if(!(n&&a.length<n)){for(let o=0;o<a.length;o++)r.push(parseFloat(a[o]));return r}}var Rb={exports:{}};function tte(t){return t}function nte(t){return t}const IUe={inflateRawSync:tte,inflateRaw:nte},RUe=Object.freeze(Object.defineProperty({__proto__:null,default:IUe,inflateRaw:nte,inflateRawSync:tte},Symbol.toStringTag,{value:"Module"})),AUe=nU(RUe);/*! dicom-parser - 1.8.12 - 2023-02-20 | (c) 2017 Chris Hafey | https://github.com/cornerstonejs/dicomParser */var PUe=Rb.exports,RF;function NUe(){return RF||(RF=1,(function(t,e){(function(n,r){t.exports=r(AUe)})(PUe,function(n){return i=[function(o,s){o.exports=n},function(o,s,l){l.r(s),l.d(s,"isStringVr",function(){return f}),l.d(s,"isPrivateTag",function(){return u}),l.d(s,"parsePN",function(){return d}),l.d(s,"parseTM",function(){return h}),l.d(s,"parseDA",function(){return g}),l.d(s,"explicitElementToString",function(){return m}),l.d(s,"explicitDataSetToJS",function(){return y}),l.d(s,"createJPEGBasicOffsetTable",function(){return w}),l.d(s,"parseDicomDataSetExplicit",function(){return Q}),l.d(s,"parseDicomDataSetImplicit",function(){return re}),l.d(s,"readFixedString",function(){return D}),l.d(s,"alloc",function(){return ye}),l.d(s,"version",function(){return me}),l.d(s,"bigEndianByteArrayParser",function(){return Ce}),l.d(s,"ByteStream",function(){return De}),l.d(s,"sharedCopy",function(){return we}),l.d(s,"DataSet",function(){return M}),l.d(s,"findAndSetUNElementLength",function(){return _}),l.d(s,"findEndOfEncapsulatedElement",function(){return T}),l.d(s,"findItemDelimitationItemAndSetElementLength",function(){return A}),l.d(s,"littleEndianByteArrayParser",function(){return q}),l.d(s,"parseDicom",function(){return Y}),l.d(s,"readDicomElementExplicit",function(){return X}),l.d(s,"readDicomElementImplicit",function(){return P}),l.d(s,"readEncapsulatedImageFrame",function(){return Fe}),l.d(s,"readEncapsulatedPixelData",function(){return He}),l.d(s,"readEncapsulatedPixelDataFromFragments",function(){return ue}),l.d(s,"readPart10Header",function(){return k}),l.d(s,"readSequenceItemsExplicit",function(){return $}),l.d(s,"readSequenceItemsImplicit",function(){return G}),l.d(s,"readSequenceItem",function(){return B}),l.d(s,"readTag",function(){return S});var c={AE:!0,AS:!0,AT:!1,CS:!0,DA:!0,DS:!0,DT:!0,FL:!1,FD:!1,IS:!0,LO:!0,LT:!0,OB:!1,OD:!1,OF:!1,OW:!1,PN:!0,SH:!0,SL:!1,SQ:!1,SS:!1,ST:!0,TM:!0,UI:!0,UL:!1,UN:void 0,UR:!0,US:!1,UT:!0},f=function(pe){return c[pe]},u=function(pe){if(pe=parseInt(pe[4],16),isNaN(pe))throw"dicomParser.isPrivateTag: cannot parse last character of group";return pe%2==1},d=function(pe){if(pe!==void 0)return pe=pe.split("^"),{familyName:pe[0],givenName:pe[1],middleName:pe[2],prefix:pe[3],suffix:pe[4]}};function h(pe,ge){if(2<=pe.length){var Ie=parseInt(pe.substring(0,2),10),ve=4<=pe.length?parseInt(pe.substring(2,4),10):void 0,_e=6<=pe.length?parseInt(pe.substring(4,6),10):void 0,Pe=8<=pe.length?pe.substring(7,13):void 0,Pe=Pe?parseInt(Pe,10)*Math.pow(10,6-Pe.length):void 0;if(ge&&(isNaN(Ie)||ve!==void 0&&isNaN(ve)||_e!==void 0&&isNaN(_e)||Pe!==void 0&&isNaN(Pe)||Ie<0||23<Ie||ve&&(ve<0||59<ve)||_e&&(_e<0||59<_e)||Pe&&(Pe<0||999999<Pe)))throw"invalid TM '".concat(pe,"'");return{hours:Ie,minutes:ve,seconds:_e,fractionalSeconds:Pe}}if(ge)throw"invalid TM '".concat(pe,"'")}function p(pe,ge,Ie){return!isNaN(Ie)&&0<ge&&ge<=12&&0<pe&&pe<=(function(ve,_e){switch(ve){case 2:return _e%4==0&&_e%100||_e%400==0?29:28;case 9:case 4:case 6:case 11:return 30;default:return 31}})(ge,Ie)}function g(pe,ge){if(pe&&pe.length===8){var Ie=parseInt(pe.substring(0,4),10),ve=parseInt(pe.substring(4,6),10),_e=parseInt(pe.substring(6,8),10);if(ge&&p(_e,ve,Ie)!==!0)throw"invalid DA '".concat(pe,"'");return{year:Ie,month:ve,day:_e}}if(ge)throw"invalid DA '".concat(pe,"'")}function m(pe,ge){if(pe===void 0||ge===void 0)throw"dicomParser.explicitElementToString: missing required parameters";if(ge.vr===void 0)throw"dicomParser.explicitElementToString: cannot convert implicit element to string";var Ie,ve=ge.vr,_e=ge.tag;function Pe(Je,$e){for(var ke="",Re=0;Re<Je;Re++)Re!==0&&(ke+="/"),ke+=$e.call(pe,_e,Re).toString();return ke}if(f(ve)===!0)Ie=pe.string(_e);else{if(ve==="AT"){var ne=pe.uint32(_e);return ne===void 0?void 0:"x".concat((ne=ne<0?4294967295+ne+1:ne).toString(16).toUpperCase())}ve==="US"?Ie=Pe(ge.length/2,pe.uint16):ve==="SS"?Ie=Pe(ge.length/2,pe.int16):ve==="UL"?Ie=Pe(ge.length/4,pe.uint32):ve==="SL"?Ie=Pe(ge.length/4,pe.int32):ve==="FD"?Ie=Pe(ge.length/8,pe.double):ve==="FL"&&(Ie=Pe(ge.length/4,pe.float))}return Ie}function y(pe,ge){if(pe===void 0)throw"dicomParser.explicitDataSetToJS: missing required parameter dataSet";ge=ge||{omitPrivateAttibutes:!0,maxElementLength:128};var Ie,ve={};for(Ie in pe.elements){var _e=pe.elements[Ie];if(ge.omitPrivateAttibutes!==!0||!u(Ie))if(_e.items){for(var Pe=[],ne=0;ne<_e.items.length;ne++)Pe.push(y(_e.items[ne].dataSet,ge));ve[Ie]=Pe}else{var Je=void 0;_e.length<ge.maxElementLength&&(Je=m(pe,_e)),ve[Ie]=Je!==void 0?Je:{dataOffset:_e.dataOffset,length:_e.length}}}return ve}function v(pe,ge){return pe.byteArray[ge]===255&&pe.byteArray[ge+1]===217}function x(pe,ge,Ie){for(var ve,_e,Pe=Ie;Pe<ge.fragments.length;Pe++)if(ve=pe,_e=Pe,_e=ge.fragments[_e],!(!v(ve,_e.position+_e.length-2)&&!v(ve,_e.position+_e.length-3)))return Pe}function w(pe,ge,Ie){if(pe===void 0)throw"dicomParser.createJPEGBasicOffsetTable: missing required parameter dataSet";if(ge===void 0)throw"dicomParser.createJPEGBasicOffsetTable: missing required parameter pixelDataElement";if(ge.tag!=="x7fe00010")throw"dicomParser.createJPEGBasicOffsetTable: parameter 'pixelDataElement' refers to non pixel data tag (expected tag = x7fe00010'";if(ge.encapsulatedPixelData!==!0||ge.hadUndefinedLength!==!0||ge.basicOffsetTable===void 0||ge.fragments===void 0||ge.fragments.length<=0)throw"dicomParser.createJPEGBasicOffsetTable: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(Ie&&Ie.length<=0)throw"dicomParser.createJPEGBasicOffsetTable: parameter 'fragments' must not be zero length";Ie=Ie||ge.fragments;for(var ve=[],_e=0;;){ve.push(ge.fragments[_e].offset);var Pe=x(pe,ge,_e);if(Pe===void 0||Pe===ge.fragments.length-1)return ve;_e=Pe+1}}function S(Ie){if(Ie===void 0)throw"dicomParser.readTag: missing required parameter 'byteStream'";var ge=256*Ie.readUint16()*256,Ie=Ie.readUint16();return"x".concat("00000000".concat((ge+Ie).toString(16)).substr(-8))}function T(pe,ge,Ie){if(pe===void 0)throw"dicomParser.findEndOfEncapsulatedElement: missing required parameter 'byteStream'";if(ge===void 0)throw"dicomParser.findEndOfEncapsulatedElement: missing required parameter 'element'";if(ge.encapsulatedPixelData=!0,ge.basicOffsetTable=[],ge.fragments=[],S(pe)!=="xfffee000")throw"dicomParser.findEndOfEncapsulatedElement: basic offset table not found";for(var ve=pe.readUint32()/4,_e=0;_e<ve;_e++){var Pe=pe.readUint32();ge.basicOffsetTable.push(Pe)}for(var ne=pe.position;pe.position<pe.byteArray.length;){var Je=S(pe),$e=pe.readUint32();if(Je==="xfffee0dd")return pe.seek($e),void(ge.length=pe.position-ge.dataOffset);if(Je!=="xfffee000")return Ie&&Ie.push("unexpected tag ".concat(Je," while searching for end of pixel data element with undefined length")),$e>pe.byteArray.length-pe.position&&($e=pe.byteArray.length-pe.position),ge.fragments.push({offset:pe.position-ne-8,position:pe.position,length:$e}),pe.seek($e),void(ge.length=pe.position-ge.dataOffset);ge.fragments.push({offset:pe.position-ne-8,position:pe.position,length:$e}),pe.seek($e)}Ie&&Ie.push("pixel data element ".concat(ge.tag," missing sequence delimiter tag xfffee0dd"))}function _(pe,ge){if(pe===void 0)throw"dicomParser.findAndSetUNElementLength: missing required parameter 'byteStream'";for(var Ie=pe.byteArray.length-8;pe.position<=Ie;)if(pe.readUint16()===65534){var ve=pe.readUint16();if(ve===57565)return pe.readUint32()!==0&&pe.warnings("encountered non zero length following item delimiter at position ".concat(pe.position-4," while reading element of undefined length with tag ").concat(ge.tag)),void(ge.length=pe.position-ge.dataOffset)}ge.length=pe.byteArray.length-ge.dataOffset,pe.seek(pe.byteArray.length-pe.position)}function D(pe,ge,Ie){if(Ie<0)throw"dicomParser.readFixedString - length cannot be less than 0";if(ge+Ie>pe.length)throw"dicomParser.readFixedString: attempt to read past end of buffer";for(var ve,_e="",Pe=0;Pe<Ie;Pe++){if((ve=pe[ge+Pe])===0)return ge+=Ie,_e;_e+=String.fromCharCode(ve)}return _e}function I(pe,ge){for(var Ie=0;Ie<ge.length;Ie++){var ve=ge[Ie];ve.enumerable=ve.enumerable||!1,ve.configurable=!0,"value"in ve&&(ve.writable=!0),Object.defineProperty(pe,ve.key,ve)}}function R(pe,ge){return pe.parser!==void 0?pe.parser:ge}var M=(function(){function pe(ve,_e,Pe){(function(ne,Je){if(!(ne instanceof Je))throw new TypeError("Cannot call a class as a function")})(this,pe),this.byteArrayParser=ve,this.byteArray=_e,this.elements=Pe}var ge,Ie;return ge=pe,(Ie=[{key:"uint16",value:function(ve,_e){if(ve=this.elements[ve],_e=_e!==void 0?_e:0,ve&&ve.length!==0)return R(ve,this.byteArrayParser).readUint16(this.byteArray,ve.dataOffset+2*_e)}},{key:"int16",value:function(ve,_e){if(ve=this.elements[ve],_e=_e!==void 0?_e:0,ve&&ve.length!==0)return R(ve,this.byteArrayParser).readInt16(this.byteArray,ve.dataOffset+2*_e)}},{key:"uint32",value:function(ve,_e){if(ve=this.elements[ve],_e=_e!==void 0?_e:0,ve&&ve.length!==0)return R(ve,this.byteArrayParser).readUint32(this.byteArray,ve.dataOffset+4*_e)}},{key:"int32",value:function(ve,_e){if(ve=this.elements[ve],_e=_e!==void 0?_e:0,ve&&ve.length!==0)return R(ve,this.byteArrayParser).readInt32(this.byteArray,ve.dataOffset+4*_e)}},{key:"float",value:function(ve,_e){if(ve=this.elements[ve],_e=_e!==void 0?_e:0,ve&&ve.length!==0)return R(ve,this.byteArrayParser).readFloat(this.byteArray,ve.dataOffset+4*_e)}},{key:"double",value:function(ve,_e){if(ve=this.elements[ve],_e=_e!==void 0?_e:0,ve&&ve.length!==0)return R(ve,this.byteArrayParser).readDouble(this.byteArray,ve.dataOffset+8*_e)}},{key:"numStringValues",value:function(ve){if(ve=this.elements[ve],ve&&0<ve.length)return ve=D(this.byteArray,ve.dataOffset,ve.length).match(/\\/g),ve===null?1:ve.length+1}},{key:"string",value:function(ve,_e){if(ve=this.elements[ve],ve&&ve.Value)return ve.Value;if(ve&&0<ve.length)return ve=D(this.byteArray,ve.dataOffset,ve.length),0<=_e?ve.split("\\")[_e].trim():ve.trim()}},{key:"text",value:function(ve,_e){if(ve=this.elements[ve],ve&&0<ve.length)return ve=D(this.byteArray,ve.dataOffset,ve.length),0<=_e?ve.split("\\")[_e].replace(/ +$/,""):ve.replace(/ +$/,"")}},{key:"floatString",value:function(ve,_e){var Pe=this.elements[ve];if(Pe&&0<Pe.length&&(_e=this.string(ve,_e=_e!==void 0?_e:0),_e!==void 0))return parseFloat(_e)}},{key:"intString",value:function(ve,_e){var Pe=this.elements[ve];if(Pe&&0<Pe.length&&(_e=this.string(ve,_e=_e!==void 0?_e:0),_e!==void 0))return parseInt(_e)}},{key:"attributeTag",value:function(ve){var _e=this.elements[ve];if(_e&&_e.length===4){var Pe=R(_e,this.byteArrayParser).readUint16,ve=this.byteArray,_e=_e.dataOffset;return"x".concat("00000000".concat((256*Pe(ve,_e)*256+Pe(ve,_e+2)).toString(16)).substr(-8))}}}])&&I(ge.prototype,Ie),Object.defineProperty(ge,"prototype",{writable:!1}),pe})();function A(pe,ge){if(pe===void 0)throw"dicomParser.readDicomElementImplicit: missing required parameter 'byteStream'";for(var Ie=pe.byteArray.length-8;pe.position<=Ie;)if(pe.readUint16()===65534){var ve=pe.readUint16();if(ve===57357)return pe.readUint32()!==0&&pe.warnings("encountered non zero length following item delimiter at position ".concat(pe.position-4," while reading element of undefined length with tag ").concat(ge.tag)),void(ge.length=pe.position-ge.dataOffset)}ge.length=pe.byteArray.length-ge.dataOffset,pe.seek(pe.byteArray.length-pe.position)}var L=function(pe,ge){return pe.vr!==void 0?pe.vr==="SQ":ge.position+4<=ge.byteArray.length?(pe=S(ge),ge.seek(-4),pe==="xfffee000"||pe==="xfffee0dd"):(ge.warnings.push("eof encountered before finding sequence item tag or sequence delimiter tag in peeking to determine VR"),!1)};function P(pe,ge,Ie){if(pe===void 0)throw"dicomParser.readDicomElementImplicit: missing required parameter 'byteStream'";var ve=S(pe),ve={tag:ve,vr:Ie!==void 0?Ie(ve):void 0,length:pe.readUint32(),dataOffset:pe.position};return ve.length===4294967295&&(ve.hadUndefinedLength=!0),ve.tag===ge||(!L(ve,pe)||u(ve.tag)&&!ve.hadUndefinedLength?ve.hadUndefinedLength?A(pe,ve):pe.seek(ve.length):(G(pe,ve,Ie),u(ve.tag)&&(ve.items=void 0))),ve}function B(pe){if(pe===void 0)throw"dicomParser.readSequenceItem: missing required parameter 'byteStream'";var ge={tag:S(pe),length:pe.readUint32(),dataOffset:pe.position};if(ge.tag!=="xfffee000")throw"dicomParser.readSequenceItem: item tag (FFFE,E000) not found at offset ".concat(pe.position);return ge}function U(pe,ge){var Ie=B(pe);return Ie.length===4294967295?(Ie.hadUndefinedLength=!0,Ie.dataSet=(function(ve,_e){for(var Pe={};ve.position<ve.byteArray.length;){var ne=P(ve,void 0,_e);if((Pe[ne.tag]=ne).tag==="xfffee00d")return new M(ve.byteArrayParser,ve.byteArray,Pe)}return ve.warnings.push("eof encountered before finding sequence item delimiter in sequence item of undefined length"),new M(ve.byteArrayParser,ve.byteArray,Pe)})(pe,ge),Ie.length=pe.position-Ie.dataOffset):(Ie.dataSet=new M(pe.byteArrayParser,pe.byteArray,{}),re(Ie.dataSet,pe,pe.position+Ie.length,{vrCallback:ge})),Ie}function G(pe,ge,Ie){if(pe===void 0)throw"dicomParser.readSequenceItemsImplicit: missing required parameter 'byteStream'";if(ge===void 0)throw"dicomParser.readSequenceItemsImplicit: missing required parameter 'element'";ge.items=[],(ge.length===4294967295?function(ve,_e,Pe){for(;ve.position+4<=ve.byteArray.length;){var ne=S(ve);if(ve.seek(-4),ne==="xfffee0dd")return _e.length=ve.position-_e.dataOffset,ve.seek(8);ne=U(ve,Pe),_e.items.push(ne)}ve.warnings.push("eof encountered before finding sequence delimiter in sequence of undefined length"),_e.length=ve.byteArray.length-_e.dataOffset}:function(ve,_e,Pe){for(var ne=_e.dataOffset+_e.length;ve.position<ne;){var Je=U(ve,Pe);_e.items.push(Je)}})(pe,ge,Ie)}function F(pe,ge){var Ie=B(pe);return Ie.length===4294967295?(Ie.hadUndefinedLength=!0,Ie.dataSet=(function(ve,_e){for(var Pe={};ve.position<ve.byteArray.length;){var ne=X(ve,_e);if((Pe[ne.tag]=ne).tag==="xfffee00d")return new M(ve.byteArrayParser,ve.byteArray,Pe)}return _e.push("eof encountered before finding item delimiter tag while reading sequence item of undefined length"),new M(ve.byteArrayParser,ve.byteArray,Pe)})(pe,ge),Ie.length=pe.position-Ie.dataOffset):(Ie.dataSet=new M(pe.byteArrayParser,pe.byteArray,{}),Q(Ie.dataSet,pe,pe.position+Ie.length)),Ie}function $(pe,ge,Ie){if(pe===void 0)throw"dicomParser.readSequenceItemsExplicit: missing required parameter 'byteStream'";if(ge===void 0)throw"dicomParser.readSequenceItemsExplicit: missing required parameter 'element'";ge.items=[],(ge.length===4294967295?function(ve,_e,Pe){for(;ve.position+4<=ve.byteArray.length;){var ne=S(ve);if(ve.seek(-4),ne==="xfffee0dd")return _e.length=ve.position-_e.dataOffset,ve.seek(8);ne=F(ve,Pe),_e.items.push(ne)}Pe.push("eof encountered before finding sequence delimitation tag while reading sequence of undefined length"),_e.length=ve.position-_e.dataOffset}:function(ve,_e,Pe){for(var ne=_e.dataOffset+_e.length;ve.position<ne;){var Je=F(ve,Pe);_e.items.push(Je)}})(pe,ge,Ie)}var V=function(pe){return pe==="OB"||pe==="OD"||pe==="OL"||pe==="OW"||pe==="SQ"||pe==="OF"||pe==="UC"||pe==="UR"||pe==="UT"||pe==="UN"?4:2};function X(pe,ge,Ie){if(pe===void 0)throw"dicomParser.readDicomElementExplicit: missing required parameter 'byteStream'";var ve={tag:S(pe),vr:pe.readFixedString(2)};return V(ve.vr)===2?ve.length=pe.readUint16():(pe.seek(2),ve.length=pe.readUint32()),ve.dataOffset=pe.position,ve.length===4294967295&&(ve.hadUndefinedLength=!0),ve.tag===Ie||(ve.vr==="SQ"?$(pe,ve,ge):ve.length===4294967295?ve.tag==="x7fe00010"?T(pe,ve,ge):(ve.vr==="UN"?G:A)(pe,ve):pe.seek(ve.length)),ve}function Q(pe,ge,Ie){var ve=3<arguments.length&&arguments[3]!==void 0?arguments[3]:{};if(Ie=Ie===void 0?ge.byteArray.length:Ie,ge===void 0)throw"dicomParser.parseDicomDataSetExplicit: missing required parameter 'byteStream'";if(Ie<ge.position||Ie>ge.byteArray.length)throw"dicomParser.parseDicomDataSetExplicit: invalid value for parameter 'maxP osition'";for(var _e=pe.elements;ge.position<Ie;){var Pe=X(ge,pe.warnings,ve.untilTag);if((_e[Pe.tag]=Pe).tag===ve.untilTag)return}if(ge.position>Ie)throw"dicomParser:parseDicomDataSetExplicit: buffer overrun"}function re(pe,ge,Ie){var ve=3<arguments.length&&arguments[3]!==void 0?arguments[3]:{};if(Ie=Ie===void 0?pe.byteArray.length:Ie,ge===void 0)throw"dicomParser.parseDicomDataSetImplicit: missing required parameter 'byteStream'";if(Ie<ge.position||Ie>ge.byteArray.length)throw"dicomParser.parseDicomDataSetImplicit: invalid value for parameter 'maxPosition'";for(var _e=pe.elements;ge.position<Ie;){var Pe=P(ge,ve.untilTag,ve.vrCallback);if((_e[Pe.tag]=Pe).tag===ve.untilTag)return}}function ye(pe,ge){if(typeof Buffer<"u"&&pe instanceof Buffer)return Buffer.alloc(ge);if(pe instanceof Uint8Array)return new Uint8Array(ge);throw"dicomParser.alloc: unknown type for byteArray"}var me="1.8.12",Ce={readUint16:function(pe,ge){if(ge<0)throw"bigEndianByteArrayParser.readUint16: position cannot be less than 0";if(ge+2>pe.length)throw"bigEndianByteArrayParser.readUint16: attempt to read past end of buffer";return(pe[ge]<<8)+pe[ge+1]},readInt16:function(pe,ge){if(ge<0)throw"bigEndianByteArrayParser.readInt16: position cannot be less than 0";if(ge+2>pe.length)throw"bigEndianByteArrayParser.readInt16: attempt to read past end of buffer";return ge=(pe[ge]<<8)+pe[ge+1],ge=32768&ge?ge-65535-1:ge},readUint32:function(pe,ge){if(ge<0)throw"bigEndianByteArrayParser.readUint32: position cannot be less than 0";if(ge+4>pe.length)throw"bigEndianByteArrayParser.readUint32: attempt to read past end of buffer";return 256*(256*(256*pe[ge]+pe[ge+1])+pe[ge+2])+pe[ge+3]},readInt32:function(pe,ge){if(ge<0)throw"bigEndianByteArrayParser.readInt32: position cannot be less than 0";if(ge+4>pe.length)throw"bigEndianByteArrayParser.readInt32: attempt to read past end of buffer";return(pe[ge]<<24)+(pe[ge+1]<<16)+(pe[ge+2]<<8)+pe[ge+3]},readFloat:function(pe,ge){if(ge<0)throw"bigEndianByteArrayParser.readFloat: position cannot be less than 0";if(ge+4>pe.length)throw"bigEndianByteArrayParser.readFloat: attempt to read past end of buffer";var Ie=new Uint8Array(4);return Ie[3]=pe[ge],Ie[2]=pe[ge+1],Ie[1]=pe[ge+2],Ie[0]=pe[ge+3],new Float32Array(Ie.buffer)[0]},readDouble:function(pe,ge){if(ge<0)throw"bigEndianByteArrayParser.readDouble: position cannot be less than 0";if(ge+8>pe.length)throw"bigEndianByteArrayParser.readDouble: attempt to read past end of buffer";var Ie=new Uint8Array(8);return Ie[7]=pe[ge],Ie[6]=pe[ge+1],Ie[5]=pe[ge+2],Ie[4]=pe[ge+3],Ie[3]=pe[ge+4],Ie[2]=pe[ge+5],Ie[1]=pe[ge+6],Ie[0]=pe[ge+7],new Float64Array(Ie.buffer)[0]}};function we(pe,ge,Ie){if(typeof Buffer<"u"&&pe instanceof Buffer)return pe.slice(ge,ge+Ie);if(pe instanceof Uint8Array)return new Uint8Array(pe.buffer,pe.byteOffset+ge,Ie);throw"dicomParser.from: unknown type for byteArray"}function Ae(pe,ge){for(var Ie=0;Ie<ge.length;Ie++){var ve=ge[Ie];ve.enumerable=ve.enumerable||!1,ve.configurable=!0,"value"in ve&&(ve.writable=!0),Object.defineProperty(pe,ve.key,ve)}}var De=(function(){function pe(ve,_e,Pe){if((function(ne,Je){if(!(ne instanceof Je))throw new TypeError("Cannot call a class as a function")})(this,pe),ve===void 0)throw"dicomParser.ByteStream: missing required parameter 'byteArrayParser'";if(_e===void 0)throw"dicomParser.ByteStream: missing required parameter 'byteArray'";if(!(_e instanceof Uint8Array)&&(typeof Buffer>"u"||!(_e instanceof Buffer)))throw"dicomParser.ByteStream: parameter byteArray is not of type Uint8Array or Buffer";if(Pe<0)throw"dicomParser.ByteStream: parameter 'position' cannot be less than 0";if(Pe>=_e.length)throw"dicomParser.ByteStream: parameter 'position' cannot be greater than or equal to 'byteArray' length";this.byteArrayParser=ve,this.byteArray=_e,this.position=Pe||0,this.warnings=[]}var ge,Ie;return ge=pe,(Ie=[{key:"seek",value:function(ve){if(this.position+ve<0)throw"dicomParser.ByteStream.prototype.seek: cannot seek to position < 0";this.position+=ve}},{key:"readByteStream",value:function(ve){if(this.position+ve>this.byteArray.length)throw"dicomParser.ByteStream.prototype.readByteStream: readByteStream - buffer overread";var _e=we(this.byteArray,this.position,ve);return this.position+=ve,new pe(this.byteArrayParser,_e)}},{key:"getSize",value:function(){return this.byteArray.length}},{key:"readUint16",value:function(){var ve=this.byteArrayParser.readUint16(this.byteArray,this.position);return this.position+=2,ve}},{key:"readUint32",value:function(){var ve=this.byteArrayParser.readUint32(this.byteArray,this.position);return this.position+=4,ve}},{key:"readFixedString",value:function(ve){var _e=D(this.byteArray,this.position,ve);return this.position+=ve,_e}}])&&Ae(ge.prototype,Ie),Object.defineProperty(ge,"prototype",{writable:!1}),pe})(),q={readUint16:function(pe,ge){if(ge<0)throw"littleEndianByteArrayParser.readUint16: position cannot be less than 0";if(ge+2>pe.length)throw"littleEndianByteArrayParser.readUint16: attempt to read past end of buffer";return pe[ge]+256*pe[ge+1]},readInt16:function(pe,ge){if(ge<0)throw"littleEndianByteArrayParser.readInt16: position cannot be less than 0";if(ge+2>pe.length)throw"littleEndianByteArrayParser.readInt16: attempt to read past end of buffer";return ge=pe[ge]+(pe[ge+1]<<8),ge=32768&ge?ge-65535-1:ge},readUint32:function(pe,ge){if(ge<0)throw"littleEndianByteArrayParser.readUint32: position cannot be less than 0";if(ge+4>pe.length)throw"littleEndianByteArrayParser.readUint32: attempt to read past end of buffer";return pe[ge]+256*pe[ge+1]+256*pe[ge+2]*256+256*pe[ge+3]*256*256},readInt32:function(pe,ge){if(ge<0)throw"littleEndianByteArrayParser.readInt32: position cannot be less than 0";if(ge+4>pe.length)throw"littleEndianByteArrayParser.readInt32: attempt to read past end of buffer";return pe[ge]+(pe[ge+1]<<8)+(pe[ge+2]<<16)+(pe[ge+3]<<24)},readFloat:function(pe,ge){if(ge<0)throw"littleEndianByteArrayParser.readFloat: position cannot be less than 0";if(ge+4>pe.length)throw"littleEndianByteArrayParser.readFloat: attempt to read past end of buffer";var Ie=new Uint8Array(4);return Ie[0]=pe[ge],Ie[1]=pe[ge+1],Ie[2]=pe[ge+2],Ie[3]=pe[ge+3],new Float32Array(Ie.buffer)[0]},readDouble:function(pe,ge){if(ge<0)throw"littleEndianByteArrayParser.readDouble: position cannot be less than 0";if(ge+8>pe.length)throw"littleEndianByteArrayParser.readDouble: attempt to read past end of buffer";var Ie=new Uint8Array(8);return Ie[0]=pe[ge],Ie[1]=pe[ge+1],Ie[2]=pe[ge+2],Ie[3]=pe[ge+3],Ie[4]=pe[ge+4],Ie[5]=pe[ge+5],Ie[6]=pe[ge+6],Ie[7]=pe[ge+7],new Float64Array(Ie.buffer)[0]}};function k(pe){var ge=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};if(pe===void 0)throw"dicomParser.readPart10Header: missing required parameter 'byteArray'";var Ie=ge.TransferSyntaxUID,ve=new De(q,pe);return(function(){var _e=(function(){if(ve.getSize()<=132&&Ie)return!1;if(ve.seek(128),ve.readFixedString(4)==="DICM")return!0;if(!(ge||{}).TransferSyntaxUID)throw"dicomParser.readPart10Header: DICM prefix not found at location 132 - this is not a valid DICOM P10 file.";return ve.seek(0),!1})(),Pe=[],ne={};if(!_e)return ve.position=0,{elements:{x00020010:{tag:"x00020010",vr:"UI",Value:Ie}},warnings:Pe};for(;ve.position<ve.byteArray.length;){var Je=ve.position,$e=X(ve,Pe);if("x0002ffff"<$e.tag){ve.position=Je;break}$e.parser=q,ne[$e.tag]=$e}return(_e=new M(ve.byteArrayParser,ve.byteArray,ne)).warnings=ve.warnings,_e.position=ve.position,_e})()}var J="1.2.840.10008.1.2.2";function Y(pe){var ge=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};if(pe===void 0)throw new Error("dicomParser.parseDicom: missing required parameter 'byteArray'");var Ie,ve=function(Pe){if(Pe.elements.x00020010===void 0)throw new Error("dicomParser.parseDicom: missing required meta header attribute 0002,0010");return Pe=Pe.elements.x00020010,Pe&&Pe.Value||D(pe,Pe.dataOffset,Pe.length)};function _e($e){var Je=ve($e),ne=Je!=="1.2.840.10008.1.2",Je=(function(ke,Re){var ze=Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]";if(ke!=="1.2.840.10008.1.2.1.99")return new De(ke===J?Ce:q,pe,Re);if(ge&&ge.inflater)return ke=ge.inflater(pe,Re),new De(q,ke,0);if(ze==!0){var st=l(0),Qe=we(pe,Re,pe.length-Re),st=st.inflateRawSync(Qe),Qe=ye(pe,st.length+Re);return pe.copy(Qe,0,0,Re),st.copy(Qe,Re),new De(q,Qe,0)}if(typeof pako>"u")throw"dicomParser.parseDicom: no inflater available to handle deflate transfer syntax";return st=pe.slice(Re),Qe=pako.inflateRaw(st),(st=ye(pe,Qe.length+Re)).set(pe.slice(0,Re),0),st.set(Qe,Re),new De(q,st,0)})(Je,$e.position),$e=new M(Je.byteArrayParser,Je.byteArray,{});$e.warnings=Je.warnings;try{(ne?Q:re)($e,Je,Je.byteArray.length,ge)}catch(ke){throw{exception:ke,dataSet:$e}}return $e}return(function(Pe,ne){for(var Je in Pe.elements)Pe.elements.hasOwnProperty(Je)&&(ne.elements[Je]=Pe.elements[Je]);return Pe.warnings!==void 0&&(ne.warnings=Pe.warnings.concat(ne.warnings)),ne})(Ie=k(pe,ge),_e(Ie))}var ie=function(pe,ge,Ie){for(var ve=0,_e=ge;_e<ge+Ie;_e++)ve+=pe[_e].length;return ve};function ue(pe,ne,Ie,ve,_e){if(_e=_e||ne.fragments,pe===void 0)throw"dicomParser.readEncapsulatedPixelDataFromFragments: missing required parameter 'dataSet'";if(ne===void 0)throw"dicomParser.readEncapsulatedPixelDataFromFragments: missing required parameter 'pixelDataElement'";if(Ie===void 0)throw"dicomParser.readEncapsulatedPixelDataFromFragments: missing required parameter 'startFragmentIndex'";if((ve=ve||1)===void 0)throw"dicomParser.readEncapsulatedPixelDataFromFragments: missing required parameter 'numFragments'";if(ne.tag!=="x7fe00010")throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'pixelDataElement' refers to non pixel data tag (expected tag = x7fe00010";if(ne.encapsulatedPixelData!==!0||ne.hadUndefinedLength!==!0||ne.basicOffsetTable===void 0||ne.fragments===void 0||ne.fragments.length<=0)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(Ie<0)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'startFragmentIndex' must be >= 0";if(Ie>=ne.fragments.length)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'startFragmentIndex' must be < number of fragments";if(ve<1)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'numFragments' must be > 0";if(Ie+ve>ne.fragments.length)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'startFragment' + 'numFragments' < number of fragments";var Pe=new De(pe.byteArrayParser,pe.byteArray,ne.dataOffset),ne=B(Pe);if(ne.tag!=="xfffee000")throw"dicomParser.readEncapsulatedPixelData: missing basic offset table xfffee000";Pe.seek(ne.length);var Je=Pe.position;if(ve===1)return we(Pe.byteArray,Je+_e[Ie].offset+8,_e[Ie].length);for(var ne=ie(_e,Ie,ve),$e=ye(Pe.byteArray,ne),ke=0,Re=Ie;Re<Ie+ve;Re++)for(var ze=Je+_e[Re].offset+8,st=0;st<_e[Re].length;st++)$e[ke++]=Pe.byteArray[ze++];return $e}var fe=function(pe,ge){for(var Ie=0;Ie<pe.length;Ie++)if(pe[Ie].offset===ge)return Ie},Se=function(pe,ge,Ie,ve){if(pe===ge.length-1)return Ie.length-ve;for(var _e=ge[pe+1],Pe=ve+1;Pe<Ie.length;Pe++)if(Ie[Pe].offset===_e)return Pe-ve;throw"dicomParser.calculateNumberOfFragmentsForFrame: could not find fragment with offset matching basic offset table"};function Fe(pe,ge,Ie,ve,_e){if(ve=ve||ge.basicOffsetTable,_e=_e||ge.fragments,pe===void 0)throw"dicomParser.readEncapsulatedImageFrame: missing required parameter 'dataSet'";if(ge===void 0)throw"dicomParser.readEncapsulatedImageFrame: missing required parameter 'pixelDataElement'";if(Ie===void 0)throw"dicomParser.readEncapsulatedImageFrame: missing required parameter 'frameIndex'";if(ve===void 0)throw"dicomParser.readEncapsulatedImageFrame: parameter 'pixelDataElement' does not have basicOffsetTable";if(ge.tag!=="x7fe00010")throw"dicomParser.readEncapsulatedImageFrame: parameter 'pixelDataElement' refers to non pixel data tag (expected tag = x7fe00010)";if(ge.encapsulatedPixelData!==!0)throw"dicomParser.readEncapsulatedImageFrame: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(ge.hadUndefinedLength!==!0)throw"dicomParser.readEncapsulatedImageFrame: parameter 'pixelDataElement' refers to pixel data element that does not have undefined length";if(ge.fragments===void 0)throw"dicomParser.readEncapsulatedImageFrame: parameter 'pixelDataElement' refers to pixel data element that does not have fragments";if(ve.length===0)throw"dicomParser.readEncapsulatedImageFrame: basicOffsetTable has zero entries";if(Ie<0)throw"dicomParser.readEncapsulatedImageFrame: parameter 'frameIndex' must be >= 0";if(Ie>=ve.length)throw"dicomParser.readEncapsulatedImageFrame: parameter 'frameIndex' must be < basicOffsetTable.length";var Pe=ve[Ie],Pe=fe(_e,Pe);if(Pe===void 0)throw"dicomParser.readEncapsulatedImageFrame: unable to find fragment that matches basic offset table entry";return ue(pe,ge,Pe,Se(Ie,ve,_e,Pe),_e)}var Ke=!1;function He(pe,ge,Ie){if(Ke||(Ke=!0,console&&console.log&&console.log("WARNING: dicomParser.readEncapsulatedPixelData() has been deprecated")),pe===void 0)throw"dicomParser.readEncapsulatedPixelData: missing required parameter 'dataSet'";if(ge===void 0)throw"dicomParser.readEncapsulatedPixelData: missing required parameter 'element'";if(Ie===void 0)throw"dicomParser.readEncapsulatedPixelData: missing required parameter 'frame'";if(ge.tag!=="x7fe00010")throw"dicomParser.readEncapsulatedPixelData: parameter 'element' refers to non pixel data tag (expected tag = x7fe00010)";if(ge.encapsulatedPixelData!==!0||ge.hadUndefinedLength!==!0||ge.basicOffsetTable===void 0||ge.fragments===void 0)throw"dicomParser.readEncapsulatedPixelData: parameter 'element' refers to pixel data element that does not have encapsulated pixel data";if(Ie<0)throw"dicomParser.readEncapsulatedPixelData: parameter 'frame' must be >= 0";return ge.basicOffsetTable.length!==0?Fe(pe,ge,Ie):ue(pe,ge,0,ge.fragments.length)}s.default={isStringVr:f,isPrivateTag:u,parsePN:d,parseTM:h,parseDA:g,explicitElementToString:m,explicitDataSetToJS:y,createJPEGBasicOffsetTable:w,parseDicomDataSetExplicit:Q,parseDicomDataSetImplicit:re,readFixedString:D,alloc:ye,version:me,bigEndianByteArrayParser:Ce,ByteStream:De,sharedCopy:we,DataSet:M,findAndSetUNElementLength:_,findEndOfEncapsulatedElement:T,findItemDelimitationItemAndSetElementLength:A,littleEndianByteArrayParser:q,parseDicom:Y,readDicomElementExplicit:X,readDicomElementImplicit:P,readEncapsulatedImageFrame:Fe,readEncapsulatedPixelData:He,readEncapsulatedPixelDataFromFragments:ue,readPart10Header:k,readSequenceItemsExplicit:$,readSequenceItemsImplicit:G,readSequenceItem:B,readTag:S,LEI:"1.2.840.10008.1.2",LEE:"1.2.840.10008.1.2.1"}}],a={},r.m=i,r.c=a,r.d=function(o,s,l){r.o(o,s)||Object.defineProperty(o,s,{enumerable:!0,get:l})},r.r=function(o){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})},r.t=function(o,s){if(1&s&&(o=r(o)),8&s||4&s&&typeof o=="object"&&o&&o.__esModule)return o;var l=Object.create(null);if(r.r(l),Object.defineProperty(l,"default",{enumerable:!0,value:o}),2&s&&typeof o!="string")for(var c in o)r.d(l,c,(function(f){return o[f]}).bind(null,c));return l},r.n=function(o){var s=o&&o.__esModule?function(){return o.default}:function(){return o};return r.d(s,"a",s),s},r.o=function(o,s){return Object.prototype.hasOwnProperty.call(o,s)},r.p="",r(r.s=1);function r(o){if(a[o])return a[o].exports;var s=a[o]={i:o,l:!1,exports:{}};return i[o].call(s.exports,s,s.exports,r),s.l=!0,s.exports}var i,a})})(Rb)),Rb.exports}var gi=NUe();const LUe=tl(gi),kUe=ere({__proto__:null,default:LUe},[gi]);function by(t){const e=t.indexOf(":");let n=t.substring(e+1);const r=n.indexOf("frame=");let i;if(r!==-1){const s=n.substring(r+6);i=parseInt(s,10),n=n.substring(0,r-1)}const a=t.substring(0,e),o=i!==void 0?i-1:void 0;return{scheme:a,url:n,frame:i,pixelDataFrame:o}}let s_={open(t,e){t.open("get",e,!0)},beforeSend(){},beforeProcessing(t){return Promise.resolve(t.response)},imageCreated(){},strict:!1};function rte(t){s_=Object.assign(s_,t)}function wy(){return s_}function RC(t,e,n={},r={}){const i=wy(),a=l=>{if(typeof i.errorInterceptor=="function"){const c=new Error("request failed");c.request=l,c.response=l.response,c.status=l.status,i.errorInterceptor(c)}},o=new XMLHttpRequest,s=new Promise((l,c)=>{i.open(o,t,n,r);const f=i.beforeSend(o,e,n,r);o.responseType="arraybuffer";const u=Object.assign({},n,f);Object.keys(u).forEach(function(d){u[d]!==null&&(d==="Accept"&&t.indexOf("accept=")!==-1||o.setRequestHeader(d,u[d]))}),r.deferred={resolve:l,reject:c},r.url=t,r.imageId=e,o.onloadstart=function(d){i.onloadstart&&i.onloadstart(d,r),Ct(St,"cornerstoneimageloadstart",{url:t,imageId:e})},o.onloadend=function(d){i.onloadend&&i.onloadend(d,r),Ct(St,"cornerstoneimageloadend",{url:t,imageId:e})},o.onreadystatechange=function(d){i.onreadystatechange&&i.onreadystatechange(d,r),o.readyState===4&&(o.status===200||o.status===206?i.beforeProcessing(o).then(l).catch(()=>{a(o),c(o)}):(a(o),c(o)))},o.onprogress=function(d){const h=d.loaded;let p,g;d.lengthComputable&&(p=d.total,g=Math.round(h/p*100)),Ct(St,"cornerstoneimageloadprogress",{url:t,imageId:e,loaded:h,total:p,percentComplete:g}),i.onprogress&&i.onprogress(d,r)},o.onerror=function(){a(o),c(o)},o.onabort=function(){a(o),c(o)},o.send()});return s.xhr=o,s}function VUe(t,e,n){if(n+t.length>e.length)return!1;let r=n;for(let i=0;i<t.length;i++)if(t[i]!==e[r++])return!1;return!0}function FUe(t){const e=new Uint8Array(t.length);for(let n=0,r=t.length;n<r;n++)e[n]=t.charCodeAt(n);return e}function l_(t,e,n){n=n||0;const r=FUe(e);for(let i=n;i<t.length;i++)if(r[0]===t[i]&&VUe(r,t,i))return i;return-1}const{ImageQualityStatus:AF}=nl;function U7(t,e,n){n||={};const r=new Uint8Array(e),i=!!n?.isPartial;if(t.indexOf("multipart")===-1)return{contentType:t,imageQualityStatus:i?AF.SUBRESOLUTION:AF.FULL_RESOLUTION,pixelData:r};let{tokenIndex:a,responseHeaders:o,boundary:s,multipartContentType:l}=n;if(a||=l_(r,`\r
\r
`),a===-1)throw new Error("invalid response - no multipart mime header");if(!s&&(o=$Ue(r,0,a).split(`\r
`),s=UUe(o),!s))throw new Error("invalid response - no boundary marker");const c=a+4,f=l_(r,s,c);if(f===-1&&!i)throw new Error("invalid response - terminating boundary not found");return l||=BUe(o),n.tokenIndex=a,n.boundary=s,n.responseHeaders=o,n.multipartContentType=l,n.isPartial=f===-1,{contentType:l,extractDone:!i||f!==-1,tokenIndex:a,responseHeaders:o,boundary:s,multipartContentType:l,pixelData:e.slice(c,f-2)}}function UUe(t){for(let e=0;e<t.length;e++)if(t[e].substr(0,2)==="--")return t[e]}function BUe(t){for(let e=0;e<t.length;e++)if(t[e].substr(0,13)==="Content-Type:")return t[e].substr(13).trim()}function $Ue(t,e,n){e=e||0,n=n||t.length-e;let r="";for(let i=e;i<e+n;i++)r+=String.fromCharCode(t[i]);return r}const{ImageQualityStatus:PF}=nl;function B7(t,e=!0){return e?t.imageQualityStatus??PF.FULL_RESOLUTION:PF.SUBRESOLUTION}const{ProgressiveIterator:GUe}=Hr;function ite(t,e,n={},r={}){const i=wy(),{retrieveOptions:a={},streamingData:o={}}=r,s=a.minChunkSize||128*1024,l=f=>{if(typeof i.errorInterceptor=="function"){const u=new Error("request failed");i.errorInterceptor(u)}},c=new GUe("streamRequest");return c.generate(async(f,u)=>{const d=i.beforeSend?.(null,t,n,{}),h=Object.assign({},n,d);Object.keys(h).forEach(function(p){h[p]===null&&(h[p]=void 0),p==="Accept"&&t.indexOf("accept=")!==-1&&(h[p]=void 0)});try{const p=await fetch(t,{headers:h,signal:void 0});if(p.status!==200)throw new Error(`Couldn't retrieve ${t} got status ${p.status}`);const g=p.body.getReader(),m=p.headers,y=m.get("content-type"),v=Number(m.get("Content-Length"));let x=!1,w=o.encodedData,S=o.lastSize||0;for(o.isPartial=!0;!x;){const{done:T,value:_}=await g.read();if(w=jUe(w,_),!w){if(x)throw new Error(`Done but no image frame available ${e}`);continue}if(x=T||w.byteLength===v,!x&&w.length<S+s)continue;S=w.length,o.isPartial=!T;const D=U7(y,w,o),I=B7(a,x),R={url:t,imageId:e,...D,percentComplete:T?100:D.pixelData?.length*100/v,imageQualityStatus:I,done:x};f.add(R,x)}}catch(p){l(),console.error(p),u(p)}}),c.getNextPromise()}function jUe(t,e){if(!t)return e;if(!e)return t;const n=new Uint8Array(t.length+e.length);return n.set(t,0),n.set(e,t.length),n}const zUe={xhrRequest:RC,streamRequest:ite,setOptions:rte,getOptions:wy};function WUe(t){const e=t.elements.x7fe00010.fragments,n=t.byteArray.length;for(const r of e){const{position:i,length:a}=r;a>n-i&&(console.log(`Truncated fragment, changing fragment length from ${r.length} to ${n-i}`),r.length=n-i)}return t}function HUe(t){let e=gi.parseDicom(t,{untilTag:"x7fe00010"});e.elements.x7fe00010||console.warn("Pixel data not found!");let n;try{n=gi.parseDicom(t)}catch(r){console.error(r),console.log("pixel data dataset:",r.dataSet),n=r.dataSet}return e.elements.x7fe00010=n.elements.x7fe00010,e=WUe(e),e}async function ate(t,e,n){const r=HUe(t),{uri:i,imageId:a,fileTotalLength:o}=n;return r.fetchMore=async function(s){const l=Object.assign({uri:i,imageId:a,fetchedLength:t.length,lengthToFetch:o-t.length},s),{fetchedLength:c,lengthToFetch:f}=l,{arrayBuffer:u}=await e(i,a,{byteRange:`${c}-${c+f}`}),d=new Uint8Array(u),h=new Uint8Array(r.byteArray.length+d.length);return h.set(r.byteArray),h.set(d,r.byteArray.length),ate(h,e,n)},r}function KUe(t,e){if(!t)return;const{NumberOfFrames:n,PerFrameFunctionalGroupsSequence:r,SharedFunctionalGroupsSequence:i}=ste(t);if(r||n>1){const{shared:a,perFrame:o}=ote(r,i,e);return{NumberOfFrames:n,PerFrameFunctionalInformation:o,SharedFunctionalInformation:a}}return{NumberOfFrames:n}}function ote(t,e,n){const r={};(e?Object.values(e.items[0].dataSet.elements):[]).map(a=>r[a.tag]=a);const i={};return(t?Object.values(t.items[n-1].dataSet.elements):[]).map(a=>i[a.tag]=a),{shared:r,perFrame:i}}function ste(t){if(!t)return;const{elements:e,...n}=t,{x52009230:r,x52009229:i,...a}=e;return{NumberOfFrames:t.intString("x00280008"),PerFrameFunctionalGroupsSequence:r,SharedFunctionalGroupsSequence:i,otherElements:a,otherAttributtes:n}}function qUe(t,e){if(!e)return;const{NumberOfFrames:n,PerFrameFunctionalGroupsSequence:r,SharedFunctionalGroupsSequence:i,otherElements:a}=ste(e);if(r||n>1){const{shared:o,perFrame:s}=ote(r,i,t),l={elements:{...a,...o,...s}},c=Object.create(e);return Object.assign(c,l)}return e}let Pa={};const XUe=()=>{Pa={}};function $7(t){if(Pa[t])return Pa[t]}function YUe(t){const e=$7(t);return lte(e)}function lte(t){if(!t)return!1;const e=t.intString("x00280008");return e&&e>1}function JUe(t){return t.indexOf("&frame=")}function ZUe(t){const e=JUe(t),n=e===-1?t:t.slice(0,e),r=parseInt(t.slice(e+7),10)||1;let i;return Pa[n]?i=Pa[n].dataSet:i=void 0,{dataSet:i,frame:r}}function QUe(t){const e=[],n=$7(t);if(lte(n)){const r=n.intString("x00280008");for(let i=1;i<=r;i++)e.push(`${t}&frame=${i}`)}else e.push(t);return e}const cte={_get:$7,generateMultiframeWADOURIs:QUe,retrieveMultiframeDataset:ZUe,isMultiframeDataset:YUe};let bm=0,dh={};function eBe(t){return Pa[t]!==void 0}function tBe(t){let e;if(t.includes("&frame=")){const{frame:n,dataSet:r}=cte.retrieveMultiframeDataset(t);e=qUe(n,r)}else Pa[t]&&(e=Pa[t].dataSet);return e}function nBe(t,e){const n=Pa[t];if(!n){console.error(`No loaded dataSet for uri ${t}`);return}bm-=n.dataSet.byteArray.length,n.dataSet=e,bm+=e.byteArray.length,Ct(St,"datasetscachechanged",{uri:t,action:"updated",cacheInfo:AC()})}function rBe(t,e=RC,n){if(Pa[t])return new Promise(a=>{Pa[t].cacheCount++,a(Pa[t].dataSet)});if(dh[t])return dh[t].cacheCount++,dh[t];const r=e(t,n),i=new Promise((a,o)=>{r.then(async function(s){const l={isPartialContent:!1,fileTotalLength:null};if(!(s instanceof ArrayBuffer)){if(!s.arrayBuffer)return o(new Error("If not returning ArrayBuffer, must return object with `arrayBuffer` parameter"));l.isPartialContent=s.flags.isPartialContent,l.fileTotalLength=s.flags.fileTotalLength,s=s.arrayBuffer}const c=new Uint8Array(s);let f;try{l.isPartialContent?f=await ate(c,e,{uri:t,imageId:n,fileTotalLength:l.fileTotalLength}):f=gi.parseDicom(c)}catch(u){return o(u)}Pa[t]={dataSet:f,cacheCount:i.cacheCount},bm+=f.byteArray.length,a(f),Ct(St,"datasetscachechanged",{uri:t,action:"loaded",cacheInfo:AC()})},o).then(()=>{delete dh[t]},()=>{delete dh[t]})});return i.cacheCount=1,dh[t]=i,i}function iBe(t){Pa[t]&&(Pa[t].cacheCount--,Pa[t].cacheCount===0&&(bm-=Pa[t].dataSet.byteArray.length,delete Pa[t],Ct(St,"datasetscachechanged",{uri:t,action:"unloaded",cacheInfo:AC()})))}function AC(){return{cacheSizeInBytes:bm,numberOfDataSetsCached:Object.keys(Pa).length}}function aBe(){XUe(),dh={},bm=0}const nm={isLoaded:eBe,load:rBe,unload:iBe,getInfo:AC,purge:aBe,get:tBe,update:nBe};function oBe(t){const e=[];for(let n=0;n<=30;n+=2){let r=`x60${n.toString(16)}`;r.length===4&&(r=`x600${n.toString(16)}`);const i=t.elements[`${r}3000`];if(!i)continue;const a=[];for(let o=0;o<i.length;o++)for(let s=0;s<8;s++){const l=t.byteArray[i.dataOffset+o];a[o*8+s]=l>>s&1}e.push({rows:t.uint16(`${r}0010`),columns:t.uint16(`${r}0011`),type:t.string(`${r}0040`),x:t.int16(`${r}0050`,1)-1,y:t.int16(`${r}0050`,0)-1,pixelData:a,description:t.string(`${r}0022`),label:t.string(`${r}1500`),roiArea:t.string(`${r}1301`),roiMean:t.string(`${r}1302`),roiStandardDeviation:t.string(`${r}1303`)})}return{overlays:e}}function Ym(t){return t==="RECON TOMO"||t==="RECON GATED TOMO"}function G7(t,e){const n=t.string("x00080008");if(n){const r=n.split("\\");if(r.length>e)return r[e]}}function sBe(t){let e;if(t.string("x00080060")?.includes("NM")){const r=G7(t,2);r&&Ym(r)&&t.elements.x00540022&&(e=xc(t.elements.x00540022.items[0].dataSet,"x00200037",6))}return e}function lBe(t){let e;if(t.string("x00080060")?.includes("NM")){const r=G7(t,2);r&&Ym(r)&&t.elements.x00540022&&(e=xc(t.elements.x00540022.items[0].dataSet,"x00200032",3))}return e}function NF(t){let e=xc(t,"x00200037",6);return!e&&t.elements.x00209116&&(e=xc(t.elements.x00209116.items[0].dataSet,"x00200037",6)),e||(e=sBe(t)),e}function LF(t){let e=xc(t,"x00200032",3);return!e&&t.elements.x00209113&&(e=xc(t.elements.x00209113.items[0].dataSet,"x00200032",3)),e||(e=lBe(t)),e}function kF(t){let e=xc(t,"x00280030",2);return!e&&t.elements.x00289110&&(e=xc(t.elements.x00289110.items[0].dataSet,"x00280030",2)),e}function VF(t){let e;return t.elements.x00180050?e=t.floatString("x00180050"):t.elements.x00289110&&t.elements.x00289110.items.length&&t.elements.x00289110.items[0].dataSet.elements.x00180050&&(e=t.elements.x00289110.items[0].dataSet.floatString("x00180050")),e}function ute(t,e,n){const r={};for(const i of n)try{const a=e(i,t);if(a){const o={};for(const s in a)if(s in a){const l=cBe(s);o[l]=a[s]}Object.assign(r,o)}}catch(a){console.error(`Error retrieving ${i} data:`,a)}return r}const cBe=t=>t.charAt(0).toUpperCase()+t.slice(1),fte=["multiframeModule","generalSeriesModule","patientStudyModule","imagePlaneModule","nmMultiframeGeometryModule","imagePixelModule","modalityLutModule","voiLutModule","sopCommonModule","petIsotopeModule","overlayPlaneModule","transferSyntax","petSeriesModule","petImageModule"];function FF(t){const e=t.elements.x00186011;return!e||!e.items?[]:e.items.map(r=>{const i=r.dataSet.double("x0018602c"),a=r.dataSet.double("x0018602e"),o=r.dataSet.uint16("x00186024"),s=r.dataSet.uint16("x00186026"),l=r.dataSet.uint16("x0018601a"),c=r.dataSet.uint16("x0018601e"),f=r.dataSet.uint16("x00186018"),u=r.dataSet.uint16("x0018601c"),d=r.dataSet.int32("x00186020")||null,h=r.dataSet.int32("x00186022")||null,p=r.dataSet.uint16("x0018602a"),g=r.dataSet.uint16("x00186028"),m=r.dataSet.uint16("x00186012"),y=r.dataSet.uint16("x00186014"),v=r.dataSet.uint16("x00186016"),x=r.dataSet.uint16("x00186030");return{regionLocationMinY0:l,regionLocationMaxY1:c,regionLocationMinX0:f,regionLocationMaxX1:u,referencePixelX0:d,referencePixelY0:h,physicalDeltaX:i,physicalDeltaY:a,physicalUnitsXDirection:o,physicalUnitsYDirection:s,referencePhysicalPixelValueY:p,referencePhysicalPixelValueX:g,regionSpatialFormat:m,regionDataType:y,regionFlags:v,transducerFrequency:x}})}function j7(t,e){const{MetadataModules:n}=nl;if(Array.isArray(e))return;const r=by(e);if(t===n.MULTIFRAME){const o=cte.retrieveMultiframeDataset(r.url);return o.dataSet?KUe(o.dataSet,o.frame):void 0}let i=r.url;r.frame&&(i=`${i}&frame=${r.frame}`);const a=nm.get(i);if(a)return dte(t,e,a)}function dte(t,e,n){const{MetadataModules:r}=nl;if(t===r.GENERAL_STUDY)return{studyDescription:n.string("x00081030"),studyDate:gi.parseDA(n.string("x00080020")),studyTime:gi.parseTM(n.string("x00080030")||""),accessionNumber:n.string("x00080050")};if(t===r.GENERAL_SERIES)return{modality:n.string("x00080060"),seriesInstanceUID:n.string("x0020000e"),seriesDescription:n.string("x0008103e"),seriesNumber:n.intString("x00200011"),studyInstanceUID:n.string("x0020000d"),seriesDate:gi.parseDA(n.string("x00080021")),seriesTime:gi.parseTM(n.string("x00080031")||""),acquisitionDate:gi.parseDA(n.string("x00080022")),acquisitionTime:gi.parseTM(n.string("x00080032")||"")};if(t===r.GENERAL_IMAGE)return{sopInstanceUID:n.string("x00080018"),instanceNumber:n.intString("x00200013"),lossyImageCompression:n.string("x00282110"),lossyImageCompressionRatio:n.floatString("x00282112"),lossyImageCompressionMethod:n.string("x00282114")};if(t===r.PATIENT)return{patientID:n.string("x00100020"),patientName:n.string("x00100010")};if(t===r.PATIENT_STUDY)return{patientAge:n.intString("x00101010"),patientSize:n.floatString("x00101020"),patientSex:n.string("x00100040"),patientWeight:n.floatString("x00101030")};if(t===r.NM_MULTIFRAME_GEOMETRY){const i=n.string("x00080060"),a=G7(n,2);return{modality:i,imageType:n.string("x00080008"),imageSubType:a,imageOrientationPatient:NF(n),imagePositionPatient:LF(n),sliceThickness:VF(n),pixelSpacing:kF(n),numberOfFrames:n.uint16("x00280008"),isNMReconstructable:Ym(a)&&i.includes("NM")}}if(t===r.IMAGE_PLANE){const i=NF(n),a=LF(n),o=kF(n),s=VF(n);let l=null,c=null;o&&(c=o[0],l=o[1]);let f=null,u=null;return i&&(f=[parseFloat(i[0]),parseFloat(i[1]),parseFloat(i[2])],u=[parseFloat(i[3]),parseFloat(i[4]),parseFloat(i[5])]),{frameOfReferenceUID:n.string("x00200052"),rows:n.uint16("x00280010"),columns:n.uint16("x00280011"),imageOrientationPatient:i,rowCosines:f,columnCosines:u,imagePositionPatient:a,sliceThickness:s,sliceLocation:n.floatString("x00201041"),pixelSpacing:o,rowPixelSpacing:c,columnPixelSpacing:l}}if(t===r.CINE)return{frameTime:n.floatString("x00181063")};if(t===r.IMAGE_PIXEL)return Qee(n);if(t===r.VOI_LUT){const i=ete(n);return{windowCenter:xc(n,"x00281050",1),windowWidth:xc(n,"x00281051",1),voiLUTSequence:o_(i,n.elements.x00283010),voiLUTFunction:n.string("x00281056")}}if(t===r.MODALITY_LUT)return{rescaleIntercept:n.floatString("x00281052"),rescaleSlope:n.floatString("x00281053"),rescaleType:n.string("x00281054"),modalityLUTSequence:o_(n.uint16("x00280103"),n.elements.x00283000)};if(t===r.SOP_COMMON)return{sopClassUID:n.string("x00080016"),sopInstanceUID:n.string("x00080018")};if(t===r.PET_ISOTOPE){const i=n.elements.x00540016;if(i===void 0)return;const a=i.items[0].dataSet;return{radiopharmaceuticalInfo:{radiopharmaceuticalStartTime:gi.parseTM(a.string("x00181072")||""),radionuclideTotalDose:a.floatString("x00181074"),radionuclideHalfLife:a.floatString("x00181075")}}}if(t===r.OVERLAY_PLANE)return oBe(n);if(t==="transferSyntax"){let i;try{i=n.string("x00020010")}catch{}return{transferSyntaxUID:i}}if(t===r.PET_SERIES)return{correctedImage:n.string("x00280051"),units:n.string("x00541001"),decayCorrection:n.string("x00541102")};if(t===r.PET_IMAGE)return{frameReferenceTime:n.floatString(n.string("x00541300")||""),actualFrameDuration:n.intString(n.string("x00181242"))};if(t===r.ULTRASOUND_ENHANCED_REGION)return FF(n);if(t===r.CALIBRATION&&n.string("x00080060")==="US")return{sequenceOfUltrasoundRegions:FF(n)};if(t==="instance")return ute(e,j7,fte)}let PC=[];function uBe(t){return`dicomfile:${PC.push(t)-1}`}function fBe(t){return PC[t]}function dBe(t){PC[t]=void 0}function hBe(){PC=[]}const hte={add:uBe,get:fBe,remove:dBe,purge:hBe};function pBe(t){const e=t.intString("x00280008"),n=t.elements.x7fe00010;return e!==n.fragments.length}function pte(t,e){if(t.elements.x7fe00010&&t.elements.x7fe00010.basicOffsetTable.length)return gi.readEncapsulatedImageFrame(t,t.elements.x7fe00010,e);if(pBe(t)){const c=gi.createJPEGBasicOffsetTable(t,t.elements.x7fe00010);return gi.readEncapsulatedImageFrame(t,t.elements.x7fe00010,e,c)}const n=t.elements.x7fe00010.fragments,r=new gi.ByteStream(t.byteArrayParser,t.byteArray,t.elements.x7fe00010.dataOffset),i=gi.readSequenceItem(r);if(i.tag!=="xfffee000")throw"dicomParser.readEncapsulatedPixelData: missing basic offset table xfffee000";r.seek(i.length);const a=r.position;if(e+1>n.length)throw"dicomParser.readEncapsulatedPixelData: frame exceeds number of fragments";const s=a+n[e].offset+8,l=n[e].length;return new Uint8Array(r.byteArray.buffer.slice(r.byteArray.byteOffset+s,r.byteArray.byteOffset+s+l))}function gBe(t,e){return t&1<<e}function gte(t,e,n){const r=new Uint8Array(n);for(let i=0;i<n;i++){const a=Math.floor(i/8),o=t[a+e],s=i%8;r[i]=gBe(o,s)?1:0}return r}function mte(t,e){const n=t.elements.x7fe00010||t.elements.x7fe00008,r=t.uint16("x00280100"),i=t.uint16("x00280010"),a=t.uint16("x00280011");let o=t.uint16("x00280002");t.string("x00280004")==="YBR_FULL_422"&&(o=2,console.warn(`Using SamplesPerPixel of 2 for YBR_FULL_422 photometric interpretation.
      See http://dicom.nema.org/medical/dicom/current/output/chtml/part03/sect_C.7.6.3.html for more information.`));const l=n.dataOffset,c=i*a*o;let f;if(r===8){if(f=l+e*c,f>=t.byteArray.length)throw new Error("frame exceeds size of pixelData");return new Uint8Array(t.byteArray.buffer.slice(f,f+c))}else if(r===16){if(f=l+e*c*2,f>=t.byteArray.length)throw new Error("frame exceeds size of pixelData");return new Uint8Array(t.byteArray.buffer.slice(f,f+c*2))}else if(r===1){if(f=l+e*c*.125,f>=t.byteArray.length)throw new Error("frame exceeds size of pixelData");return gte(t.byteArray,f,c)}else if(r===32){if(f=l+e*c*4,f>=t.byteArray.length)throw new Error("frame exceeds size of pixelData");return new Uint8Array(t.byteArray.buffer.slice(f,f+c*4))}throw new Error("unsupported pixel format")}function vte(t){const e=by(t),n=parseInt(e.url,10),r=hte.get(n);return new Promise((i,a)=>{const o=new FileReader;o.onload=s=>{const l=s.target.result;i(l)},o.onerror=a,o.readAsArrayBuffer(r)})}function z7(t,e=0){const n=t.elements.x7fe00010||t.elements.x7fe00008;return n?n.encapsulatedPixelData?pte(t,e):mte(t,e):null}function NC(t){let e=t[0],n=t[0],r;const i=t.length;for(let a=1;a<i;a++)r=t[a],e=Math.min(e,r),n=Math.max(n,r);return{min:e,max:n}}function K8(t,e,n){t.planarConfiguration===0?qee(t.pixelData,e,n):Xee(t.pixelData,e,n)}function mBe(t,e,n){t.planarConfiguration===0?Yee(t.pixelData,e,n):Jee(t.pixelData,e,n)}function yte(t,e,n){if(t.photometricInterpretation==="RGB")K8(t,e,n);else if(t.photometricInterpretation==="YBR_RCT")K8(t,e,n);else if(t.photometricInterpretation==="YBR_ICT")K8(t,e,n);else if(t.photometricInterpretation==="PALETTE COLOR")Zee(t,e,n);else if(t.photometricInterpretation==="YBR_FULL_422")EUe(t.pixelData,e,n);else if(t.photometricInterpretation==="YBR_FULL")mBe(t,e,n);else throw new Error(`No color space conversion for photometric interpretation ${t.photometricInterpretation}`)}function vBe(t){if(t===void 0)return!1;const{rows:e,columns:n,photometricInterpretation:r,pixelDataLength:i,planarConfiguration:a}=t;return i===4*n*e?!1:r==="PALETTE COLOR"?!0:r.endsWith("420")?i===(3*Math.ceil(n/2)+Math.floor(n/2))*e:r.endsWith("422")?i===(3*Math.ceil(n/2)+Math.floor(n/2))*Math.ceil(e/2)+Math.floor(e/2)*n:r!=="RGB"||a===1}function yBe(t){return xBe(String.fromCharCode.apply(null,Array.prototype.slice.apply(new Uint8Array(t))))}function xBe(t){let e;try{return decodeURIComponent(escape(t))}catch(n){if(e=n,e instanceof URIError)return t;throw e}}function xte(t,e,n){const r=new Date().getTime(),i=new Blob([e],{type:"image/jpeg"});return new Promise((a,o)=>{const s=new FileReader;s.readAsBinaryString===void 0?s.readAsArrayBuffer(i):s.readAsBinaryString(i),s.onload=function(){const l=new Image;l.onload=function(){n.height=l.height,n.width=l.width,t.rows=l.height,t.columns=l.width;const c=n.getContext("2d");c.drawImage(this,0,0);const f=c.getImageData(0,0,l.width,l.height),u=new Date().getTime();t.pixelData=new Uint8Array(f.data.buffer),t.imageData=f,t.decodeTimeInMS=u-r;const d=NC(t.pixelData);t.smallestPixelValue=d.min,t.largestPixelValue=d.max,t.pixelDataLength=t.pixelData.length,a(t)},l.onerror=function(c){o(c)},s.readAsBinaryString===void 0?l.src=`data:image/jpeg;base64,${window.btoa(yBe(s.result))}`:l.src=`data:image/jpeg;base64,${window.btoa(s.result)}`},s.onerror=l=>{o(l)}})}function ms(t,e,n,r,i){const a={...r};delete a.loader,delete a.streamingData;const o=Rm(),s=a.priority||void 0;return a.transferPixelData&&n.buffer,o.executeTask("dicomImageLoader","decodeTask",{imageFrame:t,transferSyntax:e,pixelData:n,options:a,decodeConfig:i},{priority:s,requestType:a?.requestType})}function bBe(t,e,n,r,i={},a){switch(e){case"1.2.840.10008.1.2":return ms(t,e,n,i,a);case"1.2.840.10008.1.2.1":return ms(t,e,n,i,a);case"1.2.840.10008.1.2.2":return ms(t,e,n,i,a);case"1.2.840.10008.1.2.1.99":return ms(t,e,n,i,a);case"1.2.840.10008.1.2.5":return ms(t,e,n,i,a);case"1.2.840.10008.1.2.4.50":return t.bitsAllocated===8&&(t.samplesPerPixel===3||t.samplesPerPixel===4)?xte(t,n,r):ms(t,e,n,i,a);case"1.2.840.10008.1.2.4.51":return ms(t,e,n,i,a);case"1.2.840.10008.1.2.4.57":return ms(t,e,n,i,a);case"1.2.840.10008.1.2.4.70":return ms(t,e,n,i,a);case"1.2.840.10008.1.2.4.80":return ms(t,e,n,i,a);case"1.2.840.10008.1.2.4.81":return ms(t,e,n,i,a);case"1.2.840.10008.1.2.4.90":return ms(t,e,n,i,a);case"1.2.840.10008.1.2.4.91":return ms(t,e,n,i,a);case"3.2.840.10008.1.2.4.96":case"1.2.840.10008.1.2.4.201":case"1.2.840.10008.1.2.4.202":case"1.2.840.10008.1.2.4.203":return ms(t,e,n,i,a)}return Promise.reject(new Error(`No decoder for transfer syntax ${e}`))}function bte(t){const e=Ft("imagePixelModule",t);return{samplesPerPixel:e.samplesPerPixel,photometricInterpretation:e.photometricInterpretation,planarConfiguration:e.planarConfiguration,rows:e.rows,columns:e.columns,bitsAllocated:e.bitsAllocated,bitsStored:e.bitsStored,pixelRepresentation:e.pixelRepresentation,smallestPixelValue:e.smallestPixelValue,largestPixelValue:e.largestPixelValue,redPaletteColorLookupTableDescriptor:e.redPaletteColorLookupTableDescriptor,greenPaletteColorLookupTableDescriptor:e.greenPaletteColorLookupTableDescriptor,bluePaletteColorLookupTableDescriptor:e.bluePaletteColorLookupTableDescriptor,redPaletteColorLookupTableData:e.redPaletteColorLookupTableData,greenPaletteColorLookupTableData:e.greenPaletteColorLookupTableData,bluePaletteColorLookupTableData:e.bluePaletteColorLookupTableData,pixelData:void 0,imageId:t}}function wBe(t,e){const n=t.get("modalityLutModule",e)||{},r=t.get("generalSeriesModule",e)||{},{modality:i}=r,a={rescaleSlope:n.rescaleSlope,rescaleIntercept:n.rescaleIntercept,modality:i},o=t.get("scalingModule",e)||{};return{...a,...i==="PT"&&{suvbw:o.suvbw},...i==="RTDOSE"&&{doseGridScaling:o.DoseGridScaling,doseSummation:o.DoseSummation,doseType:o.DoseType,doseUnit:o.DoseUnit}}}function W7(t){return t==="RGB"||t==="PALETTE COLOR"||t==="YBR_FULL"||t==="YBR_FULL_422"||t==="YBR_PARTIAL_422"||t==="YBR_PARTIAL_420"||t==="YBR_RCT"||t==="YBR_ICT"}function CBe(t,e){const n=t.length/4;let r=0,i=0;for(let a=0;a<n;a++)e[i++]=t[r++],e[i++]=t[r++],e[i++]=t[r++],r++;return e}function SBe(t){return t!=="1.2.840.10008.5.1.4.1.1.12.1"&&t!=="1.2.840.10008.5.1.4.1.1.12.2.1"}function H7(t,e){let n;return Number.isInteger(t)&&Number.isInteger(e)&&(t>=0?e<=255?n=Uint8Array:e<=65535?n=Uint16Array:e<=4294967295&&(n=Uint32Array):t>=-128&&e<=127?n=Int8Array:t>=-32768&&e<=32767&&(n=Int16Array)),n||Float32Array}function TBe(t,e,n){return H7(t,e)===n}function EBe(t){const e=t.smallestPixelValue,n=t.largestPixelValue,r=H7(e,n);if(r){const i=new r(t.pixelData);t.pixelData=i}else throw new Error("Could not apply a typed array to the pixel data")}let UF="";function LC(t,e,n,r={}){const i=r.useRGBA;if(r.preScale={enabled:r.preScale&&r.preScale.enabled!==void 0?r.preScale.enabled:!0},!e?.length)return Promise.reject(new Error("The pixel data is missing"));const{MetadataModules:a}=nl,o=document.createElement("canvas"),s=bte(t);if(s.decodeLevel=r.decodeLevel,r.allowFloatRendering=Lw(),r.preScale.enabled){const u=wBe(OD,t);u&&(r.preScale={...r.preScale,scalingParameters:u})}const{decodeConfig:l}=wy();Object.keys(s).forEach(u=>{(typeof s[u]=="function"||s[u]instanceof Promise)&&delete s[u]});const c=bBe(s,n,e,o,r,l),f=W7(s.photometricInterpretation);return new Promise((u,d)=>{c.then(function(h){let p=!1;if(r.targetBuffer&&r.targetBuffer.type&&!f){const{arrayBuffer:I,type:R,offset:M=0,length:A}=r.targetBuffer,L=h.pixelDataLength,P=M,B=A??L-P,U={Uint8Array,Uint16Array,Int16Array,Float32Array,Uint32Array};if(B!==h.pixelDataLength)throw new Error(`target array for image does not have the same length (${B}) as the decoded image length (${h.pixelDataLength}).`);const G=U[R],F=I?new G(I,P,B):new G(h.pixelData);if(B!==h.pixelDataLength)throw new Error("target array for image does not have the same length as the decoded image length.");h.pixelData=F,p=!0}p||EBe(h);const g=Ft(a.IMAGE_PLANE,t)||{},m=Ft(a.VOI_LUT,t)||{},y=Ft(a.MODALITY_LUT,t)||{},v=Ft(a.SOP_COMMON,t)||{},x=Ft(a.CALIBRATION,t)||{},{rows:w,columns:S}=h;if(f){if(vBe(h)){o.height=h.rows,o.width=h.columns;let M=o.getContext("2d").createImageData(h.columns,h.rows);i||(M={...M,data:new Uint8ClampedArray(3*h.columns*h.rows)}),yte(h,M.data,i),h.imageData=M,h.pixelData=M.data,h.pixelDataLength=M.data.length}else if(!i&&h.pixelDataLength===4*w*S){const R=new Uint8Array(h.pixelData.length/4*3);h.pixelData=CBe(h.pixelData,R),h.pixelDataLength=h.pixelData.length}const I=NC(h.pixelData);h.smallestPixelValue=I.min,h.largestPixelValue=I.max}let T=h.samplesPerPixel;h.photometricInterpretation==="PALETTE COLOR"&&(T=i?4:3);const _=g0.createImageVoxelManager({scalarData:h.pixelData,width:h.columns,height:h.rows,numberOfComponents:T}),D={imageId:t,dataType:h.pixelData.constructor.name,color:f,calibration:x,columnPixelSpacing:g.columnPixelSpacing,columns:h.columns,height:h.rows,preScale:h.preScale,intercept:y.rescaleIntercept?y.rescaleIntercept:0,slope:y.rescaleSlope?y.rescaleSlope:1,invert:h.photometricInterpretation==="MONOCHROME1",minPixelValue:h.smallestPixelValue,maxPixelValue:h.largestPixelValue,rowPixelSpacing:g.rowPixelSpacing,rows:h.rows,sizeInBytes:h.pixelData.byteLength,width:h.columns,windowCenter:m.windowCenter?m.windowCenter[0]:void 0,windowWidth:m.windowWidth?m.windowWidth[0]:void 0,voiLUTFunction:m.voiLUTFunction?m.voiLUTFunction:void 0,decodeTimeInMS:h.decodeTimeInMS,floatPixelData:void 0,imageFrame:h,voxelManager:_,rgba:f&&i,getPixelData:()=>h.pixelData,getCanvas:void 0,numberOfComponents:T};if(D.color&&(D.getCanvas=function(){if(UF===t)return o;const I=D.columns,R=D.rows;o.height=R,o.width=I;const M=o.getContext("2d"),A=M.createImageData(I,R),L=h.pixelData;if(L.length===I*R*4)for(let P=0;P<L.length;P++)A.data[P]=L[P];else if(L.length===I*R*3){let P=0;for(let B=0;B<L.length;B+=3)A.data[P++]=L[B],A.data[P++]=L[B+1],A.data[P++]=L[B+2],A.data[P++]=255}return h.pixelData=A.data,h.pixelDataLength=A.data.length,h.imageData=A,M.putImageData(h.imageData,0,0),UF=t,o}),y.modalityLUTSequence&&y.modalityLUTSequence.length>0&&SBe(v.sopClassUID)&&(D.modalityLUT=y.modalityLUTSequence[0]),m.voiLUTSequence&&m.voiLUTSequence.length>0&&(D.voiLUT=m.voiLUTSequence[0]),D.color&&(D.windowWidth=256,D.windowCenter=128),D.windowCenter===void 0||D.windowWidth===void 0){const I=ry(D.imageFrame.smallestPixelValue,D.imageFrame.largestPixelValue);D.windowWidth=I.windowWidth,D.windowCenter=I.windowCenter}u(D)},d)})}const{ImageQualityStatus:wte}=nl;function _Be(t,e){t.decache=function(){const n=by(e);nm.unload(n.url)}}function Cte(t,e,n=0,r,i,a){const o=new Date().getTime(),s={cancelFn:void 0,promise:void 0};return s.promise=new Promise((l,c)=>{t.then(f=>{const u=z7(f,n),d=f.string("x00020010"),h=new Date().getTime(),p=LC(e,u,d,i);_Be(s,e),p.then(g=>{g=g,g.data=f,g.sharedCacheKey=r;const m=new Date().getTime();g.loadTimeInMS=h-o,g.totalTimeInMS=m-o,g.imageQualityStatus=wte.FULL_RESOLUTION,a!==void 0&&a.imageDoneCallback!==void 0&&a.imageDoneCallback(g),l(g)},function(g){c({error:g,dataSet:f})})},function(f){c({error:f})})}),s}function DBe(t,e,n=0,r,i){const a=new Date().getTime();return{promise:new Promise((s,l)=>{const c=new Date().getTime();let f;try{const u=z7(t,n),d=t.string("x00020010");f=LC(e,u,d,i)}catch(u){l({error:u,dataSet:t});return}f.then(u=>{u=u,u.data=t;const d=new Date().getTime();u.loadTimeInMS=c-a,u.totalTimeInMS=d-a,u.imageQualityStatus=wte.FULL_RESOLUTION,s(u)},l)}),cancelFn:void 0}}function Ste(t){if(t==="dicomweb"||t==="wadouri")return RC;if(t==="dicomfile")return vte}function Ab(t,e={}){const n=by(t);e=Object.assign({},e),delete e.loader;const r=Ste(n.scheme);if(nm.isLoaded(n.url)){const a=nm.get(n.url,r,t);return DBe(a,t,n.pixelDataFrame,n.url,e)}const i=nm.load(n.url,r,t);return Cte(i,t,n.frame,n.url,e)}function Tte(){Hg("dicomweb",Ab),Hg("wadouri",Ab),Hg("dicomfile",Ab),Fm(j7)}const OBe={getImagePixelModule:Qee,getLUTs:o_,getModalityLUTOutputPixelRepresentation:ete,getNumberValues:xc,metaDataProvider:j7,metadataForDataset:dte},MBe={metaData:OBe,dataSetCacheManager:nm,fileManager:hte,getEncapsulatedImageFrame:pte,getUncompressedImageFrame:mte,loadFileRequest:vte,loadImageFromPromise:Cte,getLoaderForScheme:Ste,getPixelData:z7,loadImage:Ab,parseImageId:by,unpackBinaryFrame:gte,register:Tte};function bn(t,e,n){return e=e||0,!t||!t.Value||Array.isArray(t.Value)&&t.Value.length<=e?n:t.Value[e]}function IBe(t,e,n){const r=bn(t,e,n);if(r!==void 0)return parseFloat(String(r))}function cr(t,e){const n=bn(t,e);if(n!==void 0)return parseFloat(n)}function Co(t,e){if(!t||!t.Value||!Array.isArray(t.Value)||e&&t.Value.length<e)return;const n=[];for(let r=0;r<t.Value.length;r++)n.push(parseFloat(t.Value[r]));return n}function RBe(t){const e=[];for(let n=0;n<=30;n+=2){let r=`x60${n.toString(16)}`;r.length===4&&(r=`x600${n.toString(16)}`);const i=bn(t[`${r}3000`]);if(!i)continue;const a=[];for(let o=0;o<i.length;o++)for(let s=0;s<8;s++){const l=t.Value[i.dataOffset+o];a[o*8+s]=l>>s&1}e.push({rows:cr(t[`${r}0010`]),columns:cr(t[`${r}0011`]),type:bn(t[`${r}0040`]),x:cr(t[`${r}0050`],1)-1,y:cr(t[`${r}0050`],0)-1,pixelData:a,description:bn(t[`${r}0022`]),label:bn(t[`${r}1500`]),roiArea:bn(t[`${r}1301`]),roiMean:bn(t[`${r}1302`]),roiStandardDeviation:bn(t[`${r}1303`])})}return{overlays:e}}function kC(t){const e=t.indexOf(":");return t.substring(e+1)}function rm(t,e=!0){return t&&t.Value?t.Value[0]&&e?t.Value[0]:t.Value:t}function Ete(t,e,n){const r=(e?Object.values(e[0]):[]).map(a=>a.Value?.[0]).filter(a=>a!==void 0&&typeof a=="object"),i=(t?Object.values(t[n-1]):[]).map(a=>a.Value?.[0]).filter(a=>a!==void 0&&typeof a=="object");return{shared:r,perFrame:i}}function _te(t){let{52009230:e,52009229:n,"00280008":r,...i}=t;return e=rm(e,!1),n=rm(n,!1),r=rm(r),{PerFrameFunctionalGroupsSequence:e,SharedFunctionalGroupsSequence:n,NumberOfFrames:r,rest:i}}function ABe(t,e){const{PerFrameFunctionalGroupsSequence:n,SharedFunctionalGroupsSequence:r,NumberOfFrames:i,rest:a}=_te(e);if(n||i>1){const{shared:o,perFrame:s}=Ete(n,r,t),l=Object.assign(e,{frameNumber:t});return[...o,...s].forEach(c=>{Object.entries(c).forEach(([f,u])=>{l[f]=u})}),Object.assign(a,{"00280008":i},l)}return e}let Cy=[],iw={};function Dte(t){const e=t.indexOf("/frames/")+8,n=t.slice(0,e),r=parseInt(t.slice(e),10);return{metadata:Cy[`${n}1`],frame:r}}function PBe(t){const e=kC(t);return Dte(e)}function NBe(t){if(t[52009230]!==void 0||t[52009229]!==void 0)return!0;const e=bn(t["00280008"]);return e&&e>1}function LBe(t,e){const n=kC(t);Object.defineProperty(e,"isMultiframe",{value:NBe(e),enumerable:!1}),Cy[n]=e}function kBe(t){const e=kC(t),n=Cy[e];if(n&&!n?.isMultiframe)return n;const r=iw[e];if(r)return r;const i=Dte(e);if(!i||!i.metadata)return;const{metadata:a,frame:o}=i;if(a){const s=ABe(o,a);return iw[e]=s,s}}function VBe(t){const e=kC(t);Cy[e]=void 0,iw[e]=void 0}function FBe(){Cy=[],iw={}}const K7={add:LBe,get:kBe,remove:VBe,purge:FBe};function Ote(t){return bn(t["00080060"]).includes("NM")}function q7(t,e){const n=rm(t["00080008"],!1);if(n)return n[e]}function UBe(t){let e;const n=q7(t,2);if(n&&Ym(n)){const r=rm(t["00540022"]);r&&(e=Co(r["00200037"],6))}return e}function BBe(t){let e;const n=q7(t,2);if(n&&Ym(n)){const r=rm(t["00540022"]);r&&(e=Co(r["00200032"],3))}return e}function BF(t){let e=Co(t["00200037"],6);return!e&&Ote(t)&&(e=UBe(t)),e}function $F(t){let e=Co(t["00200032"],3);return!e&&Ote(t)&&(e=BBe(t)),e}function bo(t,e){const n=Co(t[e]);return n?n[0]:null}function $Be(t){return t?.Value?.length?Array.isArray(t.Value)?t.Value:typeof t.Value=="object"?(console.warn("Warning: Value should be an array, but an object was found. Encapsulating the object in an array."),[t.Value]):[]:[]}function GF(t){const e=$Be(t["00186011"]);return!e||!e.length?null:e.map(r=>{const i=bo(r,"0018602C"),a=bo(r,"0018602E"),o=bo(r,"00186024"),s=bo(r,"00186026"),l=bo(r,"0018601A"),c=bo(r,"0018601E"),f=bo(r,"00186018"),u=bo(r,"0018601C"),d=bo(r,"00186020"),h=bo(r,"00186022"),p=bo(r,"0018602A"),g=bo(r,"00186028"),m=bo(r,"00186012"),y=bo(r,"00186014"),v=bo(r,"00186016"),x=bo(r,"00186030");return{regionLocationMinY0:l,regionLocationMaxY1:c,regionLocationMinX0:f,regionLocationMaxX1:u,referencePixelX0:d,referencePixelY0:h,physicalDeltaX:i,physicalDeltaY:a,physicalUnitsXDirection:o,physicalUnitsYDirection:s,referencePhysicalPixelValueY:p,referencePhysicalPixelValueX:g,regionSpatialFormat:m,regionDataType:y,regionFlags:v,transducerFrequency:x}})}function X7(t,e){const{MetadataModules:n}=nl;if(t===n.MULTIFRAME){const{metadata:i,frame:a}=PBe(e);if(!i)return;const{PerFrameFunctionalGroupsSequence:o,SharedFunctionalGroupsSequence:s,NumberOfFrames:l}=_te(i);if(o||l>1){const{shared:c,perFrame:f}=Ete(o,s,a);return{NumberOfFrames:l,PerFrameFunctionalInformation:f,SharedFunctionalInformation:c}}return{NumberOfFrames:l}}const r=K7.get(e);if(r){if(t===n.GENERAL_STUDY)return{studyDescription:bn(r["00081030"]),studyDate:gi.parseDA(bn(r["00080020"])),studyTime:gi.parseTM(bn(r["00080030"],0,"")),accessionNumber:bn(r["00080050"])};if(t===n.GENERAL_SERIES)return{modality:bn(r["00080060"]),seriesInstanceUID:bn(r["0020000E"]),seriesDescription:bn(r["0008103E"]),seriesNumber:cr(r["00200011"]),studyInstanceUID:bn(r["0020000D"]),seriesDate:gi.parseDA(bn(r["00080021"])),seriesTime:gi.parseTM(bn(r["00080031"],0,"")),acquisitionDate:gi.parseDA(bn(r["00080022"])),acquisitionTime:gi.parseTM(bn(r["00080032"],0,""))};if(t===n.GENERAL_IMAGE)return{sopInstanceUID:bn(r["00080018"]),instanceNumber:cr(r["00200013"]),lossyImageCompression:bn(r["00282110"]),lossyImageCompressionRatio:cr(r["00282112"]),lossyImageCompressionMethod:bn(r["00282114"])};if(t===n.PATIENT)return{patientID:bn(r["00100020"]),patientName:bn(r["00100010"])};if(t===n.PATIENT_STUDY)return{patientAge:cr(r["00101010"]),patientSize:cr(r["00101020"]),patientSex:bn(r["00100040"]),patientWeight:cr(r["00101030"])};if(t===n.NM_MULTIFRAME_GEOMETRY){const i=bn(r["00080060"]),a=q7(r,2);return{modality:i,imageType:bn(r["00080008"]),imageSubType:a,imageOrientationPatient:BF(r),imagePositionPatient:$F(r),sliceThickness:cr(r["00180050"]),spacingBetweenSlices:cr(r["00180088"]),pixelSpacing:Co(r["00280030"],2),numberOfFrames:cr(r["00280008"]),isNMReconstructable:Ym(a)&&i.includes("NM")}}if(t===n.IMAGE_PLANE){let i=BF(r),a=$F(r);const o=Co(r["00280030"],2);let s=null,l=null,c=null,f=null,u=!1;return o?(l=o[0],s=o[1]):(u=!0,l=1,s=1),i?(c=[parseFloat(i[0]),parseFloat(i[1]),parseFloat(i[2])],f=[parseFloat(i[3]),parseFloat(i[4]),parseFloat(i[5])]):(c=[1,0,0],f=[0,1,0],u=!0,i=[...c,...f]),a||(a=[0,0,0],u=!0),{frameOfReferenceUID:bn(r["00200052"]),rows:cr(r["00280010"]),columns:cr(r["00280011"]),imageOrientationPatient:i,rowCosines:c,columnCosines:f,imagePositionPatient:a,sliceThickness:cr(r["00180050"]),sliceLocation:cr(r["00201041"]),pixelSpacing:o,rowPixelSpacing:l,columnPixelSpacing:s,usingDefaultValues:u}}if(t===n.ULTRASOUND_ENHANCED_REGION)return GF(r);if(t===n.CALIBRATION&&bn(r["00080060"])==="US")return{sequenceOfUltrasoundRegions:GF(r)};if(t===n.IMAGE_URL)return GBe(e,r);if(t===n.CINE)return jBe(e,r);if(t===n.IMAGE_PIXEL)return{samplesPerPixel:cr(r["00280002"]),photometricInterpretation:bn(r["00280004"]),rows:cr(r["00280010"]),columns:cr(r["00280011"]),bitsAllocated:cr(r["00280100"]),bitsStored:cr(r["00280101"]),highBit:bn(r["00280102"]),pixelRepresentation:cr(r["00280103"]),planarConfiguration:cr(r["00280006"]),pixelAspectRatio:bn(r["00280034"]),smallestPixelValue:cr(r["00280106"]),largestPixelValue:cr(r["00280107"]),redPaletteColorLookupTableDescriptor:Co(r["00281101"]),greenPaletteColorLookupTableDescriptor:Co(r["00281102"]),bluePaletteColorLookupTableDescriptor:Co(r["00281103"]),redPaletteColorLookupTableData:Co(r["00281201"]),greenPaletteColorLookupTableData:Co(r["00281202"]),bluePaletteColorLookupTableData:Co(r["00281203"])};if(t===n.VOI_LUT)return{windowCenter:Co(r["00281050"],1),windowWidth:Co(r["00281051"],1),voiLUTFunction:bn(r["00281056"])};if(t===n.MODALITY_LUT)return{rescaleIntercept:cr(r["00281052"]),rescaleSlope:cr(r["00281053"]),rescaleType:bn(r["00281054"])};if(t===n.SOP_COMMON)return{sopClassUID:bn(r["00080016"]),sopInstanceUID:bn(r["00080018"])};if(t===n.PET_ISOTOPE){const i=bn(r["00540016"]);return i===void 0?void 0:{radiopharmaceuticalInfo:{radiopharmaceuticalStartTime:gi.parseTM(bn(i["00181072"],0,"")),radiopharmaceuticalStartDateTime:bn(i["00181078"],0,""),radionuclideTotalDose:cr(i["00181074"]),radionuclideHalfLife:cr(i["00181075"])}}}if(t===n.OVERLAY_PLANE)return RBe(r);if(t==="transferSyntax")return Mte(e,r);if(t===n.PET_SERIES)return{correctedImage:bn(r["00280051"]),units:bn(r["00541001"]),decayCorrection:bn(r["00541102"])};if(t===n.PET_IMAGE)return{frameReferenceTime:cr(r["00541300"]),actualFrameDuration:cr(r["00181242"])};if(t==="instance")return ute(e,X7,fte)}}function GBe(t,e){const{transferSyntaxUID:n}=Mte(t,e),r=KJ(n),i=t.substring(7),a=i.replace("/frames/","/thumbnail/");let o=i.replace("/frames/","/rendered/");return r&&(o=o.replace("/rendered/1","/rendered")),{isVideo:r,rendered:o,thumbnail:a}}function jBe(t,e){return{cineRate:bn(e["00180040"]),numberOfFrames:cr(e["00280008"])}}function Mte(t,e){return{transferSyntaxUID:bn(e["00020010"])||bn(e["00083002"])}}function zBe(t,e,n={},r={}){const i=wy(),{retrieveOptions:a={},streamingData:o}=r,s=o.chunkSize||HBe(e,a,"chunkSize")||65536,l=f=>{if(typeof i.errorInterceptor=="function"){const u=new Error("request failed");i.errorInterceptor(u)}else console.warn("rangeRequest:Caught",f)};return new Promise(async(f,u)=>{const d=Object.assign({},n);Object.keys(d).forEach(function(h){(d[h]===null||d[h]===void 0)&&delete d[h]});try{o.encodedData||(o.chunkSize=s,o.rangesFetched=0);const h=KBe(o,a),{encodedData:p,responseHeaders:g}=await WBe(t,d,h,o),m=g.get("content-type"),{totalBytes:y}=o,v=y===p.byteLength,x=U7(m,p,{isPartial:!0}),w=B7(a,v||x.extractDone===!0);f({...x,imageQualityStatus:w,percentComplete:x.extractDone?100:s*100/y})}catch(h){l(h),console.error(h),u(h)}})}async function WBe(t,e,n,r){n&&(e=Object.assign(e,{Range:`bytes=${n[0]}-${n[1]}`}));let{encodedData:i}=r;if(n[1]&&i?.byteLength>n[1])return r;const a=await fetch(t,{headers:e,signal:void 0}),o=await a.arrayBuffer(),s=new Uint8Array(o),{status:l}=a;let c;i?(c=new Uint8Array(i.length+s.length),c.set(i,0),c.set(s,i.length),r.rangesFetched=1):(c=new Uint8Array(s.length),c.set(s,0),r.rangesFetched++),r.encodedData=i=c,r.responseHeaders=a.headers;const f=a.headers.get("Content-Range");return f?r.totalBytes=Number(f.split("/")[1]):l!==206||!n?r.totalBytes=i?.byteLength:n[1]===""||i?.length<n[1]?r.totalBytes=i.byteLength:r.totalBytes=Number.MAX_SAFE_INTEGER,r}function HBe(t,e,n){const r=e[n];if(typeof r!="function")return r;const i=K7.get(t);return r(i,t)}function KBe(t,e){const{totalBytes:n,encodedData:r,chunkSize:i=65536}=t,{rangeIndex:a=0}=e;return a===-1&&(!n||!r)?[0,""]:a===-1||r?.byteLength>n-i?[r?.byteLength||0,""]:[r?.byteLength||0,i*(a+1)-1]}function Y7(t,e,n="application/octet-stream",r){const{streamingData:i,retrieveOptions:a={}}=r||{},o={Accept:n};let s=a.urlArguments?`${t}${t.indexOf("?")===-1?"?":"&"}${a.urlArguments}`:t;if(a.framesPath&&(s=s.replace("/frames/",a.framesPath)),i?.url!==s&&(r.streamingData={url:s}),a.rangeIndex!==void 0)return zBe(s,e,o,r);if(a.streaming)return ite(s,e,o,r);const l=RC(s,e,o),{xhr:c}=l;return l.then(function(f){const u=c.getResponseHeader("Content-Type")||"application/octet-stream",d=U7(u,new Uint8Array(f));return d.imageQualityStatus=B7(a,!0),d})}const{ProgressiveIterator:jF}=Hr,{ImageQualityStatus:zF}=nl,qBe=new Set(["3.2.840.10008.1.2.4.96","1.2.840.10008.1.2.4.202","1.2.840.10008.1.2.4.203"]);function XBe(t){const e="1.2.840.10008.1.2";if(!t)return e;const n=t.split(";"),r={};n.forEach(a=>{const o=a.split("=");if(o.length!==2)return;const s=o[1].trim().replace(/"/g,"");r[o[0].trim()]=s});const i={"image/jpeg":"1.2.840.10008.1.2.4.50","image/x-dicom-rle":"1.2.840.10008.1.2.5","image/x-jls":"1.2.840.10008.1.2.4.80","image/jls":"1.2.840.10008.1.2.4.80","image/jll":"1.2.840.10008.1.2.4.70","image/jp2":"1.2.840.10008.1.2.4.90","image/jpx":"1.2.840.10008.1.2.4.92","image/jphc":"3.2.840.10008.1.2.4.96","image/jxl":"1.2.840.10008.1.2.4.140"};return r["transfer-syntax"]?r["transfer-syntax"]:t&&!Object.keys(r).length&&i[t]?i[t]:r.type&&i[r.type]?i[r.type]:i[t]?i[t]:e}function YBe(){return jm}const JBe="multipart/related; type=application/octet-stream; transfer-syntax=*";function Ite(t,e={}){const n=YBe(),r=new Date().getTime(),i=new jF("decompress");async function a(f,u,d){i.generate(async h=>{const p=jF.as(Y7(f,u,d,e));let g=10;for await(const m of p){const{pixelData:y,imageQualityStatus:v=zF.FULL_RESOLUTION,percentComplete:x,done:w=!0,extractDone:S=!0}=m,T=XBe(m.contentType);if(!S&&!qBe.has(T))continue;const _=m.decodeLevel??(v===zF.FULL_RESOLUTION?0:ZBe(x,e.retrieveOptions?.decodeLevel));if(!(!w&&g<=_))try{const D={...e,decodeLevel:_},I=await LC(u,y,T,D),R=new Date().getTime();I.loadTimeInMS=R-r,I.transferSyntaxUID=T,I.imageQualityStatus=v,h.add(I,w),g=_}catch(D){if(S)throw console.warn("Couldn't decode",D),D}}})}const o=e.requestType||Dn.Interaction,s=e.additionalDetails||{imageId:t},l=e.priority===void 0?5:e.priority,c=t.substring(7);return n.addRequest(a.bind(this,c,t,JBe),o,s,l),{promise:i.getDonePromise(),cancelFn:void 0}}function ZBe(t,e=4){const n=t/100-.02;return n>1/4?Math.min(e,0):n>1/16?Math.min(e,1):n>1/64?Math.min(e,2):Math.min(e,3)}function Rte(){Hg("wadors",Ite),Fm(X7)}const QBe={getNumberString:IBe,getNumberValue:cr,getNumberValues:Co,getValue:bn,metaDataProvider:X7},e$e={metaData:QBe,findIndexOfString:l_,getPixelData:Y7,loadImage:Ite,metaDataManager:K7,register:Rte};function t$e(){Rte(),Tte()}const n$e=()=>new Worker(new URL("/assets/decodeImageFrameWorker-CfQCdrMB.js",import.meta.url),{type:"module"});function Ate(t={}){rte(t),t$e();const e=Rm(),n=t?.maxWebWorkers||r$e();e.registerWorker("dicomImageLoader",n$e,{maxWorkerInstances:n})}function r$e(){return typeof navigator<"u"&&navigator.hardwareConcurrency?Math.max(1,Math.floor(navigator.hardwareConcurrency/2)):1}function i$e(t,e){if(e=e||t.transferSyntax,t.bitsAllocated===8&&e==="1.2.840.10008.1.2.4.50"&&(t.samplesPerPixel===3||t.samplesPerPixel===4))return!0}const a$e={IMPLICIT_VR_LITTLE_ENDIAN:"1.2.840.10008.1.2",EXPLICIT_VR_LITTLE_ENDIAN:"1.2.840.10008.1.2.1",DEFLATED_EXPLICIT_VR_LITTLE_ENDIAN:"1.2.840.10008.1.2.1.99",EXPLICIT_VR_BIG_ENDIAN:"1.2.840.10008.1.2.2",JPEG_BASELINE_PROCESS_1:"1.2.840.10008.1.2.4.50",JPEG_EXTENDED_PROCESS_2_4:"1.2.840.10008.1.2.4.51",JPEG_EXTENDED_PROCESSES_3_5:"1.2.840.10008.1.2.4.52",JPEG_SPECTRAL_SELECTION_NONHIERARCHICAL_PROCESSES_6_8:"1.2.840.10008.1.2.4.53",JPEG_SPECTRAL_SELECTION_NONHIERARCHICAL_PROCESSES_7_9:"1.2.840.10008.1.2.4.54",JPEG_FULL_PROGRESSION_NONHIERARCHICAL_PROCESSES_10_12:"1.2.840.10008.1.2.4.55",JPEG_FULL_PROGRESSION_NONHIERARCHICAL_PROCESSES_11_13:"1.2.840.10008.1.2.4.56",JPEG_LOSSLESS_NONHIERARCHICAL_PROCESS_14:"1.2.840.10008.1.2.4.57",JPEG_LOSSLESS_NONHIERARCHICAL_PROCESS_15:"1.2.840.10008.1.2.4.58",JPEG_EXTENDED_HIERARCHICAL_PROCESSES_16_18:"1.2.840.10008.1.2.4.59",JPEG_EXTENDED_HIERARCHICAL_PROCESSES_17_19:"1.2.840.10008.1.2.4.60",JPEG_SPECTRAL_SELECTION_HIERARCHICAL_PROCESSES_20_22:"1.2.840.10008.1.2.4.61",JPEG_SPECTRAL_SELECTION_HIERARCHICAL_PROCESSES_21_23:"1.2.840.10008.1.2.4.62",JPEG_FULL_PROGRESSION_HIERARCHICAL_PROCESSES_24_26:"1.2.840.10008.1.2.4.63",JPEG_FULL_PROGRESSION_HIERARCHICAL_PROCESSES_25_27:"1.2.840.10008.1.2.4.64",JPEG_LOSSLESS_NONHIERARCHICAL_PROCESS_28:"1.2.840.10008.1.2.4.65",JPEG_LOSSLESS_NONHIERARCHICAL_PROCESS_29:"1.2.840.10008.1.2.4.66",JPEG_LOSSLESS_NONHIERARCHICAL_FIRST_ORDER_PREDICTION_PROCESS_14:"1.2.840.10008.1.2.4.70",JPEG_LS_LOSSLESS_IMAGE_COMPRESSION:"1.2.840.10008.1.2.4.80",JPEG_LS_LOSSY_NEAR_LOSSLESS_IMAGE_COMPRESSION:"1.2.840.10008.1.2.4.81",JPEG_2000_IMAGE_COMPRESSION_LOSSLESS_ONLY:"1.2.840.10008.1.2.4.90",JPEG_2000_IMAGE_COMPRESSION:"1.2.840.10008.1.2.4.91",JPEG_2000_PART_2_MULTICOMPONENT_IMAGE_COMPRESSION_LOSSLESS_ONLY:"1.2.840.10008.1.2.4.92",JPEG_2000_PART_2_MULTICOMPONENT_IMAGE_COMPRESSION:"1.2.840.10008.1.2.4.93",JPIP_REFERENCED:"1.2.840.10008.1.2.4.94",JPIP_REFERENCED_DEFLATE:"1.2.840.10008.1.2.4.95",MPEG2_MAIN_PROFILE_MAIN_LEVEL:"1.2.840.10008.1.2.4.100",MPEG4_AVC_H264_HIGH_PROFILE_LEVEL_4_1:"1.2.840.10008.1.2.4.101",MPEG4_AVC_H264_BD_COMPATIBLE_HIGH_PROFILE_LEVEL_4_1:"1.2.840.10008.1.2.4.102",MPEG4_AVC_H264_HIGH_PROFILE_FOR_2D_VIDEO:"1.2.840.10008.1.2.4.103",MPEG4_AVC_H264_HIGH_PROFILE_FOR_3D_VIDEO:"1.2.840.10008.1.2.4.104",JPIP_LOSSLESS:"1.2.840.10008.1.2.4.96",JPIP_PART2_MULTICOMPONENT_IMAGE_COMPRESSION:"1.2.840.10008.1.2.4.97",RFC_2557_MIME_ENCAPSULATION:"1.2.840.10008.1.2.6.1",JPEG_XR_IMAGE_COMPRESSION:"1.2.840.10008.1.2.6.2",JPEG_2000_IMAGE_COMPRESSION_LOSSLESS_ONLY_RETIRED:"1.2.840.10008.1.2.4.90R",JPEG_2000_IMAGE_COMPRESSION_RETIRED:"1.2.840.10008.1.2.4.91R",JPEG_2000_PART_2_MULTICOMPONENT_IMAGE_COMPRESSION_LOSSLESS_ONLY_RETIRED:"1.2.840.10008.1.2.4.92R",JPEG_2000_PART_2_MULTICOMPONENT_IMAGE_COMPRESSION_RETIRED:"1.2.840.10008.1.2.4.93R"},o$e=Object.freeze(Object.defineProperty({__proto__:null,transferSyntaxes:a$e},Symbol.toStringTag,{value:"Module"}));function s$e(t,e){const{rows:n,columns:r,data:i}=t,{rows:a,columns:o,data:s}=e,l=[],c=[],f=[];for(let u=0;u<o;u++){const d=u*(r-1)/(o-1);l[u]=Math.floor(d),c[u]=Math.min(l[u]+1,r-1),f[u]=d-l[u]}for(let u=0;u<a;u++){const d=u*(n-1)/(a-1),h=Math.floor(d)*r,p=Math.min(h+r,(n-1)*r),g=d-Math.floor(d),m=1-g,y=u*o;for(let v=0;v<o;v++){const x=i[h+l[v]],w=i[h+c[v]],S=i[p+l[v]],T=i[p+c[v]],_=1-f[v];s[y+v]=(x*_+w*f[v])*m+(S*_+T*f[v])*g}}return s}function l$e(t,e){const{rows:n,columns:r,pixelData:i,samplesPerPixel:a=1}=t,{rows:o,columns:s,pixelData:l}=e,c=[];for(let f=0;f<s;f++){const u=f*(r-1)/(s-1);c[f]=Math.floor(u)*a}for(let f=0;f<o;f++){const u=f*(n-1)/(o-1),d=Math.floor(u)*r*a,h=f*s;for(let p=0;p<s;p++)for(let g=0;g<a;g++)l[h+p+g]=i[d+c[p]+g]}return l}async function WF(t,e){let n=e.buffer,r=e.byteOffset;const i=e.length;if(t.bitsAllocated===16)r%2&&(n=n.slice(r),r=0),t.pixelRepresentation===0?t.pixelData=new Uint16Array(n,r,i/2):t.pixelData=new Int16Array(n,r,i/2);else if(t.bitsAllocated===8||t.bitsAllocated===1)t.pixelData=e;else if(t.bitsAllocated===32){if(r%2&&(n=n.slice(r),r=0),t.floatPixelData||t.doubleFloatPixelData)throw new Error("Float pixel data is not supported for parsing into ImageFrame");t.pixelRepresentation===0?t.pixelData=new Uint32Array(n,r,i/4):t.pixelRepresentation===1?t.pixelData=new Int32Array(n,r,i/4):t.pixelData=new Float32Array(n,r,i/4)}return t}function c$e(t){return(t&255)<<8|t>>8&255}async function u$e(t,e){if(t.bitsAllocated===16){let n=e.buffer,r=e.byteOffset;const i=e.length;r%2&&(n=n.slice(r),r=0),t.pixelRepresentation===0?t.pixelData=new Uint16Array(n,r,i/2):t.pixelData=new Int16Array(n,r,i/2);for(let a=0;a<t.pixelData.length;a++)t.pixelData[a]=c$e(t.pixelData[a])}else t.bitsAllocated===8&&(t.pixelData=e);return t}async function f$e(t,e){if(t.bitsAllocated===8)return t.planarConfiguration?h$e(t,e):d$e(t,e);if(t.bitsAllocated===16)return p$e(t,e);throw new Error("unsupported pixel format for RLE")}function d$e(t,e){const n=e,r=t.rows*t.columns,i=new ArrayBuffer(r*t.samplesPerPixel),a=new DataView(n.buffer,n.byteOffset),o=new Int8Array(n.buffer,n.byteOffset),s=new Int8Array(i);let l=0;const c=a.getInt32(0,!0);for(let f=0;f<c;++f){l=f;let u=a.getInt32((f+1)*4,!0),d=a.getInt32((f+2)*4,!0);d===0&&(d=n.length);const h=r*c;for(;u<d;){const p=o[u++];if(p>=0&&p<=127)for(let g=0;g<p+1&&l<h;++g)s[l]=o[u++],l+=t.samplesPerPixel;else if(p<=-1&&p>=-127){const g=o[u++];for(let m=0;m<-p+1&&l<h;++m)s[l]=g,l+=t.samplesPerPixel}}}return t.pixelData=new Uint8Array(i),t}function h$e(t,e){const n=e,r=t.rows*t.columns,i=new ArrayBuffer(r*t.samplesPerPixel),a=new DataView(n.buffer,n.byteOffset),o=new Int8Array(n.buffer,n.byteOffset),s=new Int8Array(i);let l=0;const c=a.getInt32(0,!0);for(let f=0;f<c;++f){l=f*r;let u=a.getInt32((f+1)*4,!0),d=a.getInt32((f+2)*4,!0);d===0&&(d=n.length);const h=r*c;for(;u<d;){const p=o[u++];if(p>=0&&p<=127)for(let g=0;g<p+1&&l<h;++g)s[l]=o[u++],l++;else if(p<=-1&&p>=-127){const g=o[u++];for(let m=0;m<-p+1&&l<h;++m)s[l]=g,l++}}}return t.pixelData=new Uint8Array(i),t}function p$e(t,e){const n=e,r=t.rows*t.columns,i=new ArrayBuffer(r*t.samplesPerPixel*2),a=new DataView(n.buffer,n.byteOffset),o=new Int8Array(n.buffer,n.byteOffset),s=new Int8Array(i),l=a.getInt32(0,!0);for(let c=0;c<l;++c){let f=0;const u=c===0?1:0;let d=a.getInt32((c+1)*4,!0),h=a.getInt32((c+2)*4,!0);for(h===0&&(h=n.length);d<h;){const p=o[d++];if(p>=0&&p<=127)for(let g=0;g<p+1&&f<r;++g)s[f*2+u]=o[d++],f++;else if(p<=-1&&p>=-127){const g=o[d++];for(let m=0;m<-p+1&&f<r;++m)s[f*2+u]=g,f++}}}return t.pixelRepresentation===0?t.pixelData=new Uint16Array(i):t.pixelData=new Int16Array(i),t}var q8={exports:{}},HF;function g$e(){return HF||(HF=1,(function(t,e){var n=(()=>{var r=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename<"u"&&(r=r||__filename),(function(i){i=i||{};var a=typeof i<"u"?i:{},o,s;a.ready=new Promise(function(W,K){o=W,s=K});var l=Object.assign({},a),c="./this.program",f=(W,K)=>{throw K},u=typeof window=="object",d=typeof importScripts=="function",h=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",p="";function g(W){return a.locateFile?a.locateFile(W,p):p+W}var m,y,v;if(h){var x=Nf,w=Nf;d?p=w.dirname(p)+"/":p=__dirname+"/",m=(W,K)=>(W=ve(W)?new URL(W):w.normalize(W),x.readFileSync(W,K?void 0:"utf8")),v=W=>{var K=m(W,!0);return K.buffer||(K=new Uint8Array(K)),K},y=(W,K,ae)=>{W=ve(W)?new URL(W):w.normalize(W),x.readFile(W,function(be,Ee){be?ae(be):K(Ee.buffer)})},process.argv.length>1&&(c=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2),process.on("uncaughtException",function(W){if(!(W instanceof $e))throw W}),process.on("unhandledRejection",function(W){throw W}),f=(W,K)=>{throw process.exitCode=W,K},a.inspect=function(){return"[Emscripten Module object]"}}else(u||d)&&(d?p=self.location.href:typeof document<"u"&&document.currentScript&&(p=document.currentScript.src),r&&(p=r),p.indexOf("blob:")!==0?p=p.substr(0,p.replace(/[?#].*/,"").lastIndexOf("/")+1):p="",m=W=>{var K=new XMLHttpRequest;return K.open("GET",W,!1),K.send(null),K.responseText},d&&(v=W=>{var K=new XMLHttpRequest;return K.open("GET",W,!1),K.responseType="arraybuffer",K.send(null),new Uint8Array(K.response)}),y=(W,K,ae)=>{var be=new XMLHttpRequest;be.open("GET",W,!0),be.responseType="arraybuffer",be.onload=()=>{if(be.status==200||be.status==0&&be.response){K(be.response);return}ae()},be.onerror=ae,be.send(null)});var S=a.print||console.log.bind(console),T=a.printErr||console.warn.bind(console);Object.assign(a,l),l=null,a.arguments&&a.arguments,a.thisProgram&&(c=a.thisProgram),a.quit&&(f=a.quit);var _;a.wasmBinary&&(_=a.wasmBinary),a.noExitRuntime,typeof WebAssembly!="object"&&pe("no native wasm support detected");var D,I=!1;function R(W,K){W||pe(K)}var M=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function A(W,K,ae){for(var be=K+ae,Ee=K;W[Ee]&&!(Ee>=be);)++Ee;if(Ee-K>16&&W.buffer&&M)return M.decode(W.subarray(K,Ee));for(var Me="";K<Ee;){var Ne=W[K++];if(!(Ne&128)){Me+=String.fromCharCode(Ne);continue}var Ue=W[K++]&63;if((Ne&224)==192){Me+=String.fromCharCode((Ne&31)<<6|Ue);continue}var Ze=W[K++]&63;if((Ne&240)==224?Ne=(Ne&15)<<12|Ue<<6|Ze:Ne=(Ne&7)<<18|Ue<<12|Ze<<6|W[K++]&63,Ne<65536)Me+=String.fromCharCode(Ne);else{var ht=Ne-65536;Me+=String.fromCharCode(55296|ht>>10,56320|ht&1023)}}return Me}function L(W,K){return W?A($,W,K):""}function P(W,K,ae,be){if(!(be>0))return 0;for(var Ee=ae,Me=ae+be-1,Ne=0;Ne<W.length;++Ne){var Ue=W.charCodeAt(Ne);if(Ue>=55296&&Ue<=57343){var Ze=W.charCodeAt(++Ne);Ue=65536+((Ue&1023)<<10)|Ze&1023}if(Ue<=127){if(ae>=Me)break;K[ae++]=Ue}else if(Ue<=2047){if(ae+1>=Me)break;K[ae++]=192|Ue>>6,K[ae++]=128|Ue&63}else if(Ue<=65535){if(ae+2>=Me)break;K[ae++]=224|Ue>>12,K[ae++]=128|Ue>>6&63,K[ae++]=128|Ue&63}else{if(ae+3>=Me)break;K[ae++]=240|Ue>>18,K[ae++]=128|Ue>>12&63,K[ae++]=128|Ue>>6&63,K[ae++]=128|Ue&63}}return K[ae]=0,ae-Ee}function B(W,K,ae){return P(W,$,K,ae)}function U(W){for(var K=0,ae=0;ae<W.length;++ae){var be=W.charCodeAt(ae);be<=127?K++:be<=2047?K+=2:be>=55296&&be<=57343?(K+=4,++ae):K+=3}return K}var G,F,$,V,X,Q,re,ye,me;function Ce(W){G=W,a.HEAP8=F=new Int8Array(W),a.HEAP16=V=new Int16Array(W),a.HEAP32=Q=new Int32Array(W),a.HEAPU8=$=new Uint8Array(W),a.HEAPU16=X=new Uint16Array(W),a.HEAPU32=re=new Uint32Array(W),a.HEAPF32=ye=new Float32Array(W),a.HEAPF64=me=new Float64Array(W)}a.INITIAL_MEMORY;var we,Ae=[],De=[],q=[];function k(){if(a.preRun)for(typeof a.preRun=="function"&&(a.preRun=[a.preRun]);a.preRun.length;)ie(a.preRun.shift());ke(Ae)}function J(){ke(De)}function Y(){if(a.postRun)for(typeof a.postRun=="function"&&(a.postRun=[a.postRun]);a.postRun.length;)fe(a.postRun.shift());ke(q)}function ie(W){Ae.unshift(W)}function ue(W){De.unshift(W)}function fe(W){q.unshift(W)}var Se=0,Fe=null;function Ke(W){Se++,a.monitorRunDependencies&&a.monitorRunDependencies(Se)}function He(W){if(Se--,a.monitorRunDependencies&&a.monitorRunDependencies(Se),Se==0&&Fe){var K=Fe;Fe=null,K()}}function pe(W){a.onAbort&&a.onAbort(W),W="Aborted("+W+")",T(W),I=!0,W+=". Build with -sASSERTIONS for more info.";var K=new WebAssembly.RuntimeError(W);throw s(K),K}var ge="data:application/octet-stream;base64,";function Ie(W){return W.startsWith(ge)}function ve(W){return W.startsWith("file://")}var _e;_e="libjpegturbowasm_decode.wasm",Ie(_e)||(_e=g(_e));function Pe(W){try{if(W==_e&&_)return new Uint8Array(_);if(v)return v(W);throw"both async and sync fetching of the wasm failed"}catch(K){pe(K)}}function ne(){if(!_&&(u||d)){if(typeof fetch=="function"&&!ve(_e))return fetch(_e,{credentials:"same-origin"}).then(function(W){if(!W.ok)throw"failed to load wasm binary file at '"+_e+"'";return W.arrayBuffer()}).catch(function(){return Pe(_e)});if(y)return new Promise(function(W,K){y(_e,function(ae){W(new Uint8Array(ae))},K)})}return Promise.resolve().then(function(){return Pe(_e)})}function Je(){var W={a:lt};function K(Ne,Ue){var Ze=Ne.exports;a.asm=Ze,D=a.asm.K,Ce(D.buffer),we=a.asm.M,ue(a.asm.L),He()}Ke();function ae(Ne){K(Ne.instance)}function be(Ne){return ne().then(function(Ue){return WebAssembly.instantiate(Ue,W)}).then(function(Ue){return Ue}).then(Ne,function(Ue){T("failed to asynchronously prepare wasm: "+Ue),pe(Ue)})}function Ee(){return!_&&typeof WebAssembly.instantiateStreaming=="function"&&!Ie(_e)&&!ve(_e)&&!h&&typeof fetch=="function"?fetch(_e,{credentials:"same-origin"}).then(function(Ne){var Ue=WebAssembly.instantiateStreaming(Ne,W);return Ue.then(ae,function(Ze){return T("wasm streaming compile failed: "+Ze),T("falling back to ArrayBuffer instantiation"),be(ae)})}):be(ae)}if(a.instantiateWasm)try{var Me=a.instantiateWasm(W,K);return Me}catch(Ne){T("Module.instantiateWasm callback failed with error: "+Ne),s(Ne)}return Ee().catch(s),{}}function $e(W){this.name="ExitStatus",this.message="Program terminated with exit("+W+")",this.status=W}function ke(W){for(;W.length>0;)W.shift()(a)}function Re(W){this.excPtr=W,this.ptr=W-24,this.set_type=function(K){re[this.ptr+4>>2]=K},this.get_type=function(){return re[this.ptr+4>>2]},this.set_destructor=function(K){re[this.ptr+8>>2]=K},this.get_destructor=function(){return re[this.ptr+8>>2]},this.set_refcount=function(K){Q[this.ptr>>2]=K},this.set_caught=function(K){K=K?1:0,F[this.ptr+12>>0]=K},this.get_caught=function(){return F[this.ptr+12>>0]!=0},this.set_rethrown=function(K){K=K?1:0,F[this.ptr+13>>0]=K},this.get_rethrown=function(){return F[this.ptr+13>>0]!=0},this.init=function(K,ae){this.set_adjusted_ptr(0),this.set_type(K),this.set_destructor(ae),this.set_refcount(0),this.set_caught(!1),this.set_rethrown(!1)},this.add_ref=function(){var K=Q[this.ptr>>2];Q[this.ptr>>2]=K+1},this.release_ref=function(){var K=Q[this.ptr>>2];return Q[this.ptr>>2]=K-1,K===1},this.set_adjusted_ptr=function(K){re[this.ptr+16>>2]=K},this.get_adjusted_ptr=function(){return re[this.ptr+16>>2]},this.get_exception_ptr=function(){var K=Te(this.get_type());if(K)return re[this.excPtr>>2];var ae=this.get_adjusted_ptr();return ae!==0?ae:this.excPtr}}function ze(W,K,ae){var be=new Re(W);throw be.init(K,ae),W}var st={};function Qe(W){for(;W.length;){var K=W.pop(),ae=W.pop();ae(K)}}function _t(W){return this.fromWireType(Q[W>>2])}var Le={},We={},xt={},Ut=48,gn=57;function tn(W){if(W===void 0)return"_unknown";W=W.replace(/[^a-zA-Z0-9_]/g,"$");var K=W.charCodeAt(0);return K>=Ut&&K<=gn?"_"+W:W}function Ht(W,K){return W=tn(W),new Function("body","return function "+W+`() {
    "use strict";    return body.apply(this, arguments);
};
`)(K)}function dn(W,K){var ae=Ht(K,function(be){this.name=K,this.message=be;var Ee=new Error(be).stack;Ee!==void 0&&(this.stack=this.toString()+`
`+Ee.replace(/^Error(:[^\n]*)?\n/,""))});return ae.prototype=Object.create(W.prototype),ae.prototype.constructor=ae,ae.prototype.toString=function(){return this.message===void 0?this.name:this.name+": "+this.message},ae}var sr=void 0;function Qn(W){throw new sr(W)}function qe(W,K,ae){W.forEach(function(Ue){xt[Ue]=K});function be(Ue){var Ze=ae(Ue);Ze.length!==W.length&&Qn("Mismatched type converter count");for(var ht=0;ht<W.length;++ht)yr(W[ht],Ze[ht])}var Ee=new Array(K.length),Me=[],Ne=0;K.forEach((Ue,Ze)=>{We.hasOwnProperty(Ue)?Ee[Ze]=We[Ue]:(Me.push(Ue),Le.hasOwnProperty(Ue)||(Le[Ue]=[]),Le[Ue].push(()=>{Ee[Ze]=We[Ue],++Ne,Ne===Me.length&&be(Ee)}))}),Me.length===0&&be(Ee)}function Dt(W){var K=st[W];delete st[W];var ae=K.rawConstructor,be=K.rawDestructor,Ee=K.fields,Me=Ee.map(Ne=>Ne.getterReturnType).concat(Ee.map(Ne=>Ne.setterArgumentType));qe([W],Me,Ne=>{var Ue={};return Ee.forEach((Ze,ht)=>{var Pt=Ze.fieldName,Wt=Ne[ht],Gt=Ze.getter,hn=Ze.getterContext,mn=Ne[ht+Ee.length],er=Ze.setter,Ar=Ze.setterContext;Ue[Pt]={read:Gr=>Wt.fromWireType(Gt(hn,Gr)),write:(Gr,Yl)=>{var Go=[];er(Ar,Gr,mn.toWireType(Go,Yl)),Qe(Go)}}}),[{name:K.name,fromWireType:function(Ze){var ht={};for(var Pt in Ue)ht[Pt]=Ue[Pt].read(Ze);return be(Ze),ht},toWireType:function(Ze,ht){for(var Pt in Ue)if(!(Pt in ht))throw new TypeError('Missing field:  "'+Pt+'"');var Wt=ae();for(Pt in Ue)Ue[Pt].write(Wt,ht[Pt]);return Ze!==null&&Ze.push(be,Wt),Wt},argPackAdvance:8,readValueFromPointer:_t,destructorFunction:be}]})}function Rt(W,K,ae,be,Ee){}function Bt(W){switch(W){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+W)}}function On(){for(var W=new Array(256),K=0;K<256;++K)W[K]=String.fromCharCode(K);$t=W}var $t=void 0;function Xt(W){for(var K="",ae=W;$[ae];)K+=$t[$[ae++]];return K}var Lt=void 0;function Qt(W){throw new Lt(W)}function yr(W,K,ae={}){if(!("argPackAdvance"in K))throw new TypeError("registerType registeredInstance requires argPackAdvance");var be=K.name;if(W||Qt('type "'+be+'" must have a positive integer typeid pointer'),We.hasOwnProperty(W)){if(ae.ignoreDuplicateRegistrations)return;Qt("Cannot register type '"+be+"' twice")}if(We[W]=K,delete xt[W],Le.hasOwnProperty(W)){var Ee=Le[W];delete Le[W],Ee.forEach(Me=>Me())}}function kr(W,K,ae,be,Ee){var Me=Bt(ae);K=Xt(K),yr(W,{name:K,fromWireType:function(Ne){return!!Ne},toWireType:function(Ne,Ue){return Ue?be:Ee},argPackAdvance:8,readValueFromPointer:function(Ne){var Ue;if(ae===1)Ue=F;else if(ae===2)Ue=V;else if(ae===4)Ue=Q;else throw new TypeError("Unknown boolean type size: "+K);return this.fromWireType(Ue[Ne>>Me])},destructorFunction:null})}function ni(W){if(!(this instanceof ka)||!(W instanceof ka))return!1;for(var K=this.$$.ptrType.registeredClass,ae=this.$$.ptr,be=W.$$.ptrType.registeredClass,Ee=W.$$.ptr;K.baseClass;)ae=K.upcast(ae),K=K.baseClass;for(;be.baseClass;)Ee=be.upcast(Ee),be=be.baseClass;return K===be&&ae===Ee}function Ii(W){return{count:W.count,deleteScheduled:W.deleteScheduled,preservePointerOnDelete:W.preservePointerOnDelete,ptr:W.ptr,ptrType:W.ptrType,smartPtr:W.smartPtr,smartPtrType:W.smartPtrType}}function fi(W){function K(ae){return ae.$$.ptrType.registeredClass.name}Qt(K(W)+" instance already deleted")}var Ri=!1;function rn(W){}function Xn(W){W.smartPtr?W.smartPtrType.rawDestructor(W.smartPtr):W.ptrType.registeredClass.rawDestructor(W.ptr)}function vi(W){W.count.value-=1;var K=W.count.value===0;K&&Xn(W)}function an(W,K,ae){if(K===ae)return W;if(ae.baseClass===void 0)return null;var be=an(W,K,ae.baseClass);return be===null?null:ae.downcast(be)}var ri={};function ts(){return Object.keys(Ni).length}function ii(){var W=[];for(var K in Ni)Ni.hasOwnProperty(K)&&W.push(Ni[K]);return W}var Ai=[];function wa(){for(;Ai.length;){var W=Ai.pop();W.$$.deleteScheduled=!1,W.delete()}}var Pi=void 0;function Os(W){Pi=W,Ai.length&&Pi&&Pi(wa)}function No(){a.getInheritedInstanceCount=ts,a.getLiveInheritedInstances=ii,a.flushPendingDeletes=wa,a.setDelayFunction=Os}var Ni={};function Lo(W,K){for(K===void 0&&Qt("ptr should not be undefined");W.baseClass;)K=W.upcast(K),W=W.baseClass;return K}function At(W,K){return K=Lo(W,K),Ni[K]}function Li(W,K){(!K.ptrType||!K.ptr)&&Qn("makeClassHandle requires ptr and ptrType");var ae=!!K.smartPtrType,be=!!K.smartPtr;return ae!==be&&Qn("Both smartPtrType and smartPtr must be specified"),K.count={value:1},di(Object.create(W,{$$:{value:K}}))}function Xa(W){var K=this.getPointee(W);if(!K)return this.destructor(W),null;var ae=At(this.registeredClass,K);if(ae!==void 0){if(ae.$$.count.value===0)return ae.$$.ptr=K,ae.$$.smartPtr=W,ae.clone();var be=ae.clone();return this.destructor(W),be}function Ee(){return this.isSmartPointer?Li(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:K,smartPtrType:this,smartPtr:W}):Li(this.registeredClass.instancePrototype,{ptrType:this,ptr:W})}var Me=this.registeredClass.getActualType(K),Ne=ri[Me];if(!Ne)return Ee.call(this);var Ue;this.isConst?Ue=Ne.constPointerType:Ue=Ne.pointerType;var Ze=an(K,this.registeredClass,Ue.registeredClass);return Ze===null?Ee.call(this):this.isSmartPointer?Li(Ue.registeredClass.instancePrototype,{ptrType:Ue,ptr:Ze,smartPtrType:this,smartPtr:W}):Li(Ue.registeredClass.instancePrototype,{ptrType:Ue,ptr:Ze})}function di(W){return typeof FinalizationRegistry>"u"?(di=K=>K,W):(Ri=new FinalizationRegistry(K=>{vi(K.$$)}),di=K=>{var ae=K.$$,be=!!ae.smartPtr;if(be){var Ee={$$:ae};Ri.register(K,Ee,K)}return K},rn=K=>Ri.unregister(K),di(W))}function Ms(){if(this.$$.ptr||fi(this),this.$$.preservePointerOnDelete)return this.$$.count.value+=1,this;var W=di(Object.create(Object.getPrototypeOf(this),{$$:{value:Ii(this.$$)}}));return W.$$.count.value+=1,W.$$.deleteScheduled=!1,W}function ko(){this.$$.ptr||fi(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&Qt("Object already scheduled for deletion"),rn(this),vi(this.$$),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)}function go(){return!this.$$.ptr}function $l(){return this.$$.ptr||fi(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&Qt("Object already scheduled for deletion"),Ai.push(this),Ai.length===1&&Pi&&Pi(wa),this.$$.deleteScheduled=!0,this}function pr(){ka.prototype.isAliasOf=ni,ka.prototype.clone=Ms,ka.prototype.delete=ko,ka.prototype.isDeleted=go,ka.prototype.deleteLater=$l}function ka(){}function il(W,K,ae){if(W[K].overloadTable===void 0){var be=W[K];W[K]=function(){return W[K].overloadTable.hasOwnProperty(arguments.length)||Qt("Function '"+ae+"' called with an invalid number of arguments ("+arguments.length+") - expects one of ("+W[K].overloadTable+")!"),W[K].overloadTable[arguments.length].apply(this,arguments)},W[K].overloadTable=[],W[K].overloadTable[be.argCount]=be}}function Vo(W,K,ae){a.hasOwnProperty(W)?(Qt("Cannot register public name '"+W+"' twice"),il(a,W,W),a.hasOwnProperty(ae)&&Qt("Cannot register multiple overloads of a function with the same number of arguments ("+ae+")!"),a[W].overloadTable[ae]=K):a[W]=K}function al(W,K,ae,be,Ee,Me,Ne,Ue){this.name=W,this.constructor=K,this.instancePrototype=ae,this.rawDestructor=be,this.baseClass=Ee,this.getActualType=Me,this.upcast=Ne,this.downcast=Ue,this.pureVirtualFunctions=[]}function Va(W,K,ae){for(;K!==ae;)K.upcast||Qt("Expected null or instance of "+ae.name+", got an instance of "+K.name),W=K.upcast(W),K=K.baseClass;return W}function Ou(W,K){if(K===null)return this.isReference&&Qt("null is not a valid "+this.name),0;K.$$||Qt('Cannot pass "'+vo(K)+'" as a '+this.name),K.$$.ptr||Qt("Cannot pass deleted object as a pointer of type "+this.name);var ae=K.$$.ptrType.registeredClass,be=Va(K.$$.ptr,ae,this.registeredClass);return be}function la(W,K){var ae;if(K===null)return this.isReference&&Qt("null is not a valid "+this.name),this.isSmartPointer?(ae=this.rawConstructor(),W!==null&&W.push(this.rawDestructor,ae),ae):0;K.$$||Qt('Cannot pass "'+vo(K)+'" as a '+this.name),K.$$.ptr||Qt("Cannot pass deleted object as a pointer of type "+this.name),!this.isConst&&K.$$.ptrType.isConst&&Qt("Cannot convert argument of type "+(K.$$.smartPtrType?K.$$.smartPtrType.name:K.$$.ptrType.name)+" to parameter type "+this.name);var be=K.$$.ptrType.registeredClass;if(ae=Va(K.$$.ptr,be,this.registeredClass),this.isSmartPointer)switch(K.$$.smartPtr===void 0&&Qt("Passing raw pointer to smart pointer is illegal"),this.sharingPolicy){case 0:K.$$.smartPtrType===this?ae=K.$$.smartPtr:Qt("Cannot convert argument of type "+(K.$$.smartPtrType?K.$$.smartPtrType.name:K.$$.ptrType.name)+" to parameter type "+this.name);break;case 1:ae=K.$$.smartPtr;break;case 2:if(K.$$.smartPtrType===this)ae=K.$$.smartPtr;else{var Ee=K.clone();ae=this.rawShare(ae,Ja.toHandle(function(){Ee.delete()})),W!==null&&W.push(this.rawDestructor,ae)}break;default:Qt("Unsupporting sharing policy")}return ae}function Gl(W,K){if(K===null)return this.isReference&&Qt("null is not a valid "+this.name),0;K.$$||Qt('Cannot pass "'+vo(K)+'" as a '+this.name),K.$$.ptr||Qt("Cannot pass deleted object as a pointer of type "+this.name),K.$$.ptrType.isConst&&Qt("Cannot convert argument of type "+K.$$.ptrType.name+" to parameter type "+this.name);var ae=K.$$.ptrType.registeredClass,be=Va(K.$$.ptr,ae,this.registeredClass);return be}function Sc(W){return this.rawGetPointee&&(W=this.rawGetPointee(W)),W}function Ca(W){this.rawDestructor&&this.rawDestructor(W)}function ki(W){W!==null&&W.delete()}function Sa(){Vi.prototype.getPointee=Sc,Vi.prototype.destructor=Ca,Vi.prototype.argPackAdvance=8,Vi.prototype.readValueFromPointer=_t,Vi.prototype.deleteObject=ki,Vi.prototype.fromWireType=Xa}function Vi(W,K,ae,be,Ee,Me,Ne,Ue,Ze,ht,Pt){this.name=W,this.registeredClass=K,this.isReference=ae,this.isConst=be,this.isSmartPointer=Ee,this.pointeeType=Me,this.sharingPolicy=Ne,this.rawGetPointee=Ue,this.rawConstructor=Ze,this.rawShare=ht,this.rawDestructor=Pt,!Ee&&K.baseClass===void 0?be?(this.toWireType=Ou,this.destructorFunction=null):(this.toWireType=Gl,this.destructorFunction=null):this.toWireType=la}function Fo(W,K,ae){a.hasOwnProperty(W)||Qn("Replacing nonexistant public symbol"),a[W].overloadTable!==void 0&&ae!==void 0||(a[W]=K,a[W].argCount=ae)}function ns(W,K,ae){var be=a["dynCall_"+W];return ae&&ae.length?be.apply(null,[K].concat(ae)):be.call(null,K)}var rs=[];function Kr(W){var K=rs[W];return K||(W>=rs.length&&(rs.length=W+1),rs[W]=K=we.get(W)),K}function ol(W,K,ae){if(W.includes("j"))return ns(W,K,ae);var be=Kr(K).apply(null,ae);return be}function Ta(W,K){var ae=[];return function(){return ae.length=0,Object.assign(ae,arguments),ol(W,K,ae)}}function Fi(W,K){W=Xt(W);function ae(){return W.includes("j")?Ta(W,K):Kr(K)}var be=ae();return typeof be!="function"&&Qt("unknown function pointer with signature "+W+": "+K),be}var is=void 0;function mo(W){var K=Kt(W),ae=Xt(K);return kt(K),ae}function qi(W,K){var ae=[],be={};function Ee(Me){if(!be[Me]&&!We[Me]){if(xt[Me]){xt[Me].forEach(Ee);return}ae.push(Me),be[Me]=!0}}throw K.forEach(Ee),new is(W+": "+ae.map(mo).join([", "]))}function Fa(W,K,ae,be,Ee,Me,Ne,Ue,Ze,ht,Pt,Wt,Gt){Pt=Xt(Pt),Me=Fi(Ee,Me),Ue&&(Ue=Fi(Ne,Ue)),ht&&(ht=Fi(Ze,ht)),Gt=Fi(Wt,Gt);var hn=tn(Pt);Vo(hn,function(){qi("Cannot construct "+Pt+" due to unbound types",[be])}),qe([W,K,ae],be?[be]:[],function(mn){mn=mn[0];var er,Ar;be?(er=mn.registeredClass,Ar=er.instancePrototype):Ar=ka.prototype;var Gr=Ht(hn,function(){if(Object.getPrototypeOf(this)!==Yl)throw new Lt("Use 'new' to construct "+Pt);if(Go.constructor_body===void 0)throw new Lt(Pt+" has no accessible constructor");var Zm=Go.constructor_body[arguments.length];if(Zm===void 0)throw new Lt("Tried to invoke ctor of "+Pt+" with invalid number of parameters ("+arguments.length+") - expected ("+Object.keys(Go.constructor_body).toString()+") parameters instead!");return Zm.apply(this,arguments)}),Yl=Object.create(Ar,{constructor:{value:Gr}});Gr.prototype=Yl;var Go=new al(Pt,Gr,Yl,Gt,er,Me,Ue,ht),hl=new Vi(Pt,Go,!0,!1,!1),jf=new Vi(Pt+"*",Go,!1,!1,!1),Jm=new Vi(Pt+" const*",Go,!1,!0,!1);return ri[W]={pointerType:jf,constPointerType:Jm},Fo(hn,Gr),[hl,jf,Jm]})}function Uo(W,K){for(var ae=[],be=0;be<W;be++)ae.push(re[K+be*4>>2]);return ae}function jl(W,K){if(!(W instanceof Function))throw new TypeError("new_ called with constructor type "+typeof W+" which is not a function");var ae=Ht(W.name||"unknownFunctionName",function(){});ae.prototype=W.prototype;var be=new ae,Ee=W.apply(be,K);return Ee instanceof Object?Ee:be}function as(W,K,ae,be,Ee){var Me=K.length;Me<2&&Qt("argTypes array size mismatch! Must at least get return value and 'this' types!");for(var Ne=K[1]!==null&&ae!==null,Ue=!1,Ze=1;Ze<K.length;++Ze)if(K[Ze]!==null&&K[Ze].destructorFunction===void 0){Ue=!0;break}for(var ht=K[0].name!=="void",Pt="",Wt="",Ze=0;Ze<Me-2;++Ze)Pt+=(Ze!==0?", ":"")+"arg"+Ze,Wt+=(Ze!==0?", ":"")+"arg"+Ze+"Wired";var Gt="return function "+tn(W)+"("+Pt+`) {
if (arguments.length !== `+(Me-2)+`) {
throwBindingError('function `+W+" called with ' + arguments.length + ' arguments, expected "+(Me-2)+` args!');
}
`;Ue&&(Gt+=`var destructors = [];
`);var hn=Ue?"destructors":"null",mn=["throwBindingError","invoker","fn","runDestructors","retType","classParam"],er=[Qt,be,Ee,Qe,K[0],K[1]];Ne&&(Gt+="var thisWired = classParam.toWireType("+hn+`, this);
`);for(var Ze=0;Ze<Me-2;++Ze)Gt+="var arg"+Ze+"Wired = argType"+Ze+".toWireType("+hn+", arg"+Ze+"); // "+K[Ze+2].name+`
`,mn.push("argType"+Ze),er.push(K[Ze+2]);if(Ne&&(Wt="thisWired"+(Wt.length>0?", ":"")+Wt),Gt+=(ht?"var rv = ":"")+"invoker(fn"+(Wt.length>0?", ":"")+Wt+`);
`,Ue)Gt+=`runDestructors(destructors);
`;else for(var Ze=Ne?1:2;Ze<K.length;++Ze){var Ar=Ze===1?"thisWired":"arg"+(Ze-2)+"Wired";K[Ze].destructorFunction!==null&&(Gt+=Ar+"_dtor("+Ar+"); // "+K[Ze].name+`
`,mn.push(Ar+"_dtor"),er.push(K[Ze].destructorFunction))}ht&&(Gt+=`var ret = retType.fromWireType(rv);
return ret;
`),Gt+=`}
`,mn.push(Gt);var Gr=jl(Function,mn).apply(null,er);return Gr}function Sr(W,K,ae,be,Ee,Me){R(K>0);var Ne=Uo(K,ae);Ee=Fi(be,Ee),qe([],[W],function(Ue){Ue=Ue[0];var Ze="constructor "+Ue.name;if(Ue.registeredClass.constructor_body===void 0&&(Ue.registeredClass.constructor_body=[]),Ue.registeredClass.constructor_body[K-1]!==void 0)throw new Lt("Cannot register multiple constructors with identical number of parameters ("+(K-1)+") for class '"+Ue.name+"'! Overload resolution is currently only performed using the parameter count, not actual type info!");return Ue.registeredClass.constructor_body[K-1]=()=>{qi("Cannot construct "+Ue.name+" due to unbound types",Ne)},qe([],Ne,function(ht){return ht.splice(1,0,null),Ue.registeredClass.constructor_body[K-1]=as(Ze,ht,null,Ee,Me),[]}),[]})}function Ya(W,K,ae,be,Ee,Me,Ne,Ue){var Ze=Uo(ae,be);K=Xt(K),Me=Fi(Ee,Me),qe([],[W],function(ht){ht=ht[0];var Pt=ht.name+"."+K;K.startsWith("@@")&&(K=Symbol[K.substring(2)]),Ue&&ht.registeredClass.pureVirtualFunctions.push(K);function Wt(){qi("Cannot call "+Pt+" due to unbound types",Ze)}var Gt=ht.registeredClass.instancePrototype,hn=Gt[K];return hn===void 0||hn.overloadTable===void 0&&hn.className!==ht.name&&hn.argCount===ae-2?(Wt.argCount=ae-2,Wt.className=ht.name,Gt[K]=Wt):(il(Gt,K,Pt),Gt[K].overloadTable[ae-2]=Wt),qe([],Ze,function(mn){var er=as(Pt,mn,ht,Me,Ne);return Gt[K].overloadTable===void 0?(er.argCount=ae-2,Gt[K]=er):Gt[K].overloadTable[ae-2]=er,[]}),[]})}var Tr=[],ai=[{},{value:void 0},{value:null},{value:!0},{value:!1}];function os(W){W>4&&--ai[W].refcount===0&&(ai[W]=void 0,Tr.push(W))}function oi(){for(var W=0,K=5;K<ai.length;++K)ai[K]!==void 0&&++W;return W}function zl(){for(var W=5;W<ai.length;++W)if(ai[W]!==void 0)return ai[W];return null}function yi(){a.count_emval_handles=oi,a.get_first_emval=zl}var Ja={toValue:W=>(W||Qt("Cannot use deleted val. handle = "+W),ai[W].value),toHandle:W=>{switch(W){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:{var K=Tr.length?Tr.pop():ai.length;return ai[K]={refcount:1,value:W},K}}}};function ss(W,K){K=Xt(K),yr(W,{name:K,fromWireType:function(ae){var be=Ja.toValue(ae);return os(ae),be},toWireType:function(ae,be){return Ja.toHandle(be)},argPackAdvance:8,readValueFromPointer:_t,destructorFunction:null})}function vo(W){if(W===null)return"null";var K=typeof W;return K==="object"||K==="array"||K==="function"?W.toString():""+W}function ca(W,K){switch(K){case 2:return function(ae){return this.fromWireType(ye[ae>>2])};case 3:return function(ae){return this.fromWireType(me[ae>>3])};default:throw new TypeError("Unknown float type: "+W)}}function xi(W,K,ae){var be=Bt(ae);K=Xt(K),yr(W,{name:K,fromWireType:function(Ee){return Ee},toWireType:function(Ee,Me){return Me},argPackAdvance:8,readValueFromPointer:ca(K,be),destructorFunction:null})}function Bo(W,K,ae){switch(K){case 0:return ae?function(Ee){return F[Ee]}:function(Ee){return $[Ee]};case 1:return ae?function(Ee){return V[Ee>>1]}:function(Ee){return X[Ee>>1]};case 2:return ae?function(Ee){return Q[Ee>>2]}:function(Ee){return re[Ee>>2]};default:throw new TypeError("Unknown integer type: "+W)}}function sl(W,K,ae,be,Ee){K=Xt(K);var Me=Bt(ae),Ne=Wt=>Wt;if(be===0){var Ue=32-8*ae;Ne=Wt=>Wt<<Ue>>>Ue}var Ze=K.includes("unsigned"),ht=(Wt,Gt)=>{},Pt;Ze?Pt=function(Wt,Gt){return ht(Gt,this.name),Gt>>>0}:Pt=function(Wt,Gt){return ht(Gt,this.name),Gt},yr(W,{name:K,fromWireType:Ne,toWireType:Pt,argPackAdvance:8,readValueFromPointer:Bo(K,Me,be!==0),destructorFunction:null})}function ls(W,K,ae){var be=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],Ee=be[K];function Me(Ne){Ne=Ne>>2;var Ue=re,Ze=Ue[Ne],ht=Ue[Ne+1];return new Ee(G,ht,Ze)}ae=Xt(ae),yr(W,{name:ae,fromWireType:Me,argPackAdvance:8,readValueFromPointer:Me},{ignoreDuplicateRegistrations:!0})}function Is(W,K){K=Xt(K);var ae=K==="std::string";yr(W,{name:K,fromWireType:function(be){var Ee=re[be>>2],Me=be+4,Ne;if(ae)for(var Ue=Me,Ze=0;Ze<=Ee;++Ze){var ht=Me+Ze;if(Ze==Ee||$[ht]==0){var Pt=ht-Ue,Wt=L(Ue,Pt);Ne===void 0?Ne=Wt:(Ne+="\0",Ne+=Wt),Ue=ht+1}}else{for(var Gt=new Array(Ee),Ze=0;Ze<Ee;++Ze)Gt[Ze]=String.fromCharCode($[Me+Ze]);Ne=Gt.join("")}return kt(be),Ne},toWireType:function(be,Ee){Ee instanceof ArrayBuffer&&(Ee=new Uint8Array(Ee));var Me,Ne=typeof Ee=="string";Ne||Ee instanceof Uint8Array||Ee instanceof Uint8ClampedArray||Ee instanceof Int8Array||Qt("Cannot pass non-string to std::string"),ae&&Ne?Me=U(Ee):Me=Ee.length;var Ue=bt(4+Me+1),Ze=Ue+4;if(re[Ue>>2]=Me,ae&&Ne)B(Ee,Ze,Me+1);else if(Ne)for(var ht=0;ht<Me;++ht){var Pt=Ee.charCodeAt(ht);Pt>255&&(kt(Ze),Qt("String has UTF-16 code units that do not fit in 8 bits")),$[Ze+ht]=Pt}else for(var ht=0;ht<Me;++ht)$[Ze+ht]=Ee[ht];return be!==null&&be.push(kt,Ue),Ue},argPackAdvance:8,readValueFromPointer:_t,destructorFunction:function(be){kt(be)}})}var ll=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0;function Rs(W,K){for(var ae=W,be=ae>>1,Ee=be+K/2;!(be>=Ee)&&X[be];)++be;if(ae=be<<1,ae-W>32&&ll)return ll.decode($.subarray(W,ae));for(var Me="",Ne=0;!(Ne>=K/2);++Ne){var Ue=V[W+Ne*2>>1];if(Ue==0)break;Me+=String.fromCharCode(Ue)}return Me}function As(W,K,ae){if(ae===void 0&&(ae=2147483647),ae<2)return 0;ae-=2;for(var be=K,Ee=ae<W.length*2?ae/2:W.length,Me=0;Me<Ee;++Me){var Ne=W.charCodeAt(Me);V[K>>1]=Ne,K+=2}return V[K>>1]=0,K-be}function cl(W){return W.length*2}function Tc(W,K){for(var ae=0,be="";!(ae>=K/4);){var Ee=Q[W+ae*4>>2];if(Ee==0)break;if(++ae,Ee>=65536){var Me=Ee-65536;be+=String.fromCharCode(55296|Me>>10,56320|Me&1023)}else be+=String.fromCharCode(Ee)}return be}function Mu(W,K,ae){if(ae===void 0&&(ae=2147483647),ae<4)return 0;for(var be=K,Ee=be+ae-4,Me=0;Me<W.length;++Me){var Ne=W.charCodeAt(Me);if(Ne>=55296&&Ne<=57343){var Ue=W.charCodeAt(++Me);Ne=65536+((Ne&1023)<<10)|Ue&1023}if(Q[K>>2]=Ne,K+=4,K+4>Ee)break}return Q[K>>2]=0,K-be}function Iu(W){for(var K=0,ae=0;ae<W.length;++ae){var be=W.charCodeAt(ae);be>=55296&&be<=57343&&++ae,K+=4}return K}function Ru(W,K,ae){ae=Xt(ae);var be,Ee,Me,Ne,Ue;K===2?(be=Rs,Ee=As,Ne=cl,Me=()=>X,Ue=1):K===4&&(be=Tc,Ee=Mu,Ne=Iu,Me=()=>re,Ue=2),yr(W,{name:ae,fromWireType:function(Ze){for(var ht=re[Ze>>2],Pt=Me(),Wt,Gt=Ze+4,hn=0;hn<=ht;++hn){var mn=Ze+4+hn*K;if(hn==ht||Pt[mn>>Ue]==0){var er=mn-Gt,Ar=be(Gt,er);Wt===void 0?Wt=Ar:(Wt+="\0",Wt+=Ar),Gt=mn+K}}return kt(Ze),Wt},toWireType:function(Ze,ht){typeof ht!="string"&&Qt("Cannot pass non-string to C++ string type "+ae);var Pt=Ne(ht),Wt=bt(4+Pt+K);return re[Wt>>2]=Pt>>Ue,Ee(ht,Wt+4,Pt+K),Ze!==null&&Ze.push(kt,Wt),Wt},argPackAdvance:8,readValueFromPointer:_t,destructorFunction:function(Ze){kt(Ze)}})}function Wl(W,K,ae,be,Ee,Me){st[W]={name:Xt(K),rawConstructor:Fi(ae,be),rawDestructor:Fi(Ee,Me),fields:[]}}function Ec(W,K,ae,be,Ee,Me,Ne,Ue,Ze,ht){st[W].fields.push({fieldName:Xt(K),getterReturnType:ae,getter:Fi(be,Ee),getterContext:Me,setterArgumentType:Ne,setter:Fi(Ue,Ze),setterContext:ht})}function Au(W,K){K=Xt(K),yr(W,{isVoid:!0,name:K,argPackAdvance:0,fromWireType:function(){},toWireType:function(ae,be){}})}function _c(){throw 1/0}var Dc={};function Pu(W){var K=Dc[W];return K===void 0?Xt(W):K}function ul(){return typeof globalThis=="object"?globalThis:(function(){return Function})()("return this")()}function Oc(W){return W===0?Ja.toHandle(ul()):(W=Pu(W),Ja.toHandle(ul()[W]))}function Mc(W){W>4&&(ai[W].refcount+=1)}function Hl(W,K){var ae=We[W];return ae===void 0&&Qt(K+" has unknown type "+mo(W)),ae}function Nu(W){for(var K="",ae=0;ae<W;++ae)K+=(ae!==0?", ":"")+"arg"+ae;for(var be=()=>re,Ee="return function emval_allocator_"+W+`(constructor, argTypes, args) {
  var HEAPU32 = getMemory();
`,ae=0;ae<W;++ae)Ee+="var argType"+ae+" = requireRegisteredType(HEAPU32[((argTypes)>>2)], 'parameter "+ae+`');
var arg`+ae+" = argType"+ae+`.readValueFromPointer(args);
args += argType`+ae+`['argPackAdvance'];
argTypes += 4;
`;return Ee+="var obj = new constructor("+K+`);
return valueToHandle(obj);
}
`,new Function("requireRegisteredType","Module","valueToHandle","getMemory",Ee)(Hl,a,Ja.toHandle,be)}var fl={};function Lu(W,K,ae,be){W=Ja.toValue(W);var Ee=fl[K];return Ee||(Ee=Nu(K),fl[K]=Ee),Ee(W,ae,be)}function Ic(W,K){W=Hl(W,"_emval_take_value");var ae=W.readValueFromPointer(K);return Ja.toHandle(ae)}function ku(){pe("")}function Rc(W,K,ae){$.copyWithin(W,K,K+ae)}function Vu(){return 2147483648}function Fu(W){try{return D.grow(W-G.byteLength+65535>>>16),Ce(D.buffer),1}catch{}}function Kl(W){var K=$.length;W=W>>>0;var ae=Vu();if(W>ae)return!1;let be=(Ze,ht)=>Ze+(ht-Ze%ht)%ht;for(var Ee=1;Ee<=4;Ee*=2){var Me=K*(1+.2/Ee);Me=Math.min(Me,W+100663296);var Ne=Math.min(ae,be(Math.max(W,Me),65536)),Ue=Fu(Ne);if(Ue)return!0}return!1}var ql={};function $o(){return c||"./this.program"}function cs(){if(!cs.strings){var W=(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",K={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:W,_:$o()};for(var ae in ql)ql[ae]===void 0?delete K[ae]:K[ae]=ql[ae];var be=[];for(var ae in K)be.push(ae+"="+K[ae]);cs.strings=be}return cs.strings}function Za(W,K,ae){for(var be=0;be<W.length;++be)F[K++>>0]=W.charCodeAt(be);F[K>>0]=0}function Ac(W,K){var ae=0;return cs().forEach(function(be,Ee){var Me=K+ae;re[W+Ee*4>>2]=Me,Za(be,Me),ae+=be.length+1}),0}function Pc(W,K){var ae=cs();re[W>>2]=ae.length;var be=0;return ae.forEach(function(Ee){be+=Ee.length+1}),re[K>>2]=be,0}function Ps(W){f(W,new $e(W))}function us(W,K){Ps(W)}var dl=us;function Xl(W){return 52}function de(W,K,ae,be,Ee){return 70}var he=[null,[],[]];function Oe(W,K){var ae=he[W];K===0||K===10?((W===1?S:T)(A(ae,0)),ae.length=0):ae.push(K)}function Ye(W,K,ae,be){for(var Ee=0,Me=0;Me<ae;Me++){var Ne=re[K>>2],Ue=re[K+4>>2];K+=8;for(var Ze=0;Ze<Ue;Ze++)Oe(W,$[Ne+Ze]);Ee+=Ue}return re[be>>2]=Ee,0}function at(W){var K=a["_"+W];return K}function gt(W,K){F.set(W,K)}function mt(W,K,ae,be,Ee){var Me={string:mn=>{var er=0;if(mn!=null&&mn!==0){var Ar=(mn.length<<2)+1;er=oe(Ar),B(mn,er,Ar)}return er},array:mn=>{var er=oe(mn.length);return gt(mn,er),er}};function Ne(mn){return K==="string"?L(mn):K==="boolean"?!!mn:mn}var Ue=at(W),Ze=[],ht=0;if(be)for(var Pt=0;Pt<be.length;Pt++){var Wt=Me[ae[Pt]];Wt?(ht===0&&(ht=un()),Ze[Pt]=Wt(be[Pt])):Ze[Pt]=be[Pt]}var Gt=Ue.apply(null,Ze);function hn(mn){return ht!==0&&se(ht),Ne(mn)}return Gt=hn(Gt),Gt}sr=a.InternalError=dn(Error,"InternalError"),On(),Lt=a.BindingError=dn(Error,"BindingError"),pr(),No(),Sa(),is=a.UnboundTypeError=dn(Error,"UnboundTypeError"),yi();var lt={g:ze,A:Dt,w:Rt,F:kr,u:Fa,t:Sr,c:Ya,E:ss,m:xi,b:sl,a:ls,l:Is,h:Ru,J:Wl,d:Ec,G:Au,x:_c,i:os,r:Oc,p:Mc,q:Lu,s:Ic,j:ku,D:Rc,y:Kl,z:Ac,B:Pc,I:dl,C:Xl,v:de,k:Ye,o:rt,n:dt,H:pt,f:Ge,e:Tt};Je(),a.___wasm_call_ctors=function(){return(a.___wasm_call_ctors=a.asm.L).apply(null,arguments)};var bt=a._malloc=function(){return(bt=a._malloc=a.asm.N).apply(null,arguments)},kt=a._free=function(){return(kt=a._free=a.asm.O).apply(null,arguments)},Kt=a.___getTypeName=function(){return(Kt=a.___getTypeName=a.asm.P).apply(null,arguments)};a.__embind_initialize_bindings=function(){return(a.__embind_initialize_bindings=a.asm.Q).apply(null,arguments)};var en=a._setThrew=function(){return(en=a._setThrew=a.asm.R).apply(null,arguments)},un=a.stackSave=function(){return(un=a.stackSave=a.asm.S).apply(null,arguments)},se=a.stackRestore=function(){return(se=a.stackRestore=a.asm.T).apply(null,arguments)},oe=a.stackAlloc=function(){return(oe=a.stackAlloc=a.asm.U).apply(null,arguments)},Te=a.___cxa_is_pointer_type=function(){return(Te=a.___cxa_is_pointer_type=a.asm.V).apply(null,arguments)};a.dynCall_jiji=function(){return(a.dynCall_jiji=a.asm.W).apply(null,arguments)};function Ge(W,K){var ae=un();try{Kr(W)(K)}catch(be){if(se(ae),be!==be+0)throw be;en(1,0)}}function rt(W,K){var ae=un();try{return Kr(W)(K)}catch(be){if(se(ae),be!==be+0)throw be;en(1,0)}}function Tt(W,K,ae,be){var Ee=un();try{Kr(W)(K,ae,be)}catch(Me){if(se(Ee),Me!==Me+0)throw Me;en(1,0)}}function pt(W,K,ae,be){var Ee=un();try{return Kr(W)(K,ae,be)}catch(Me){if(se(Ee),Me!==Me+0)throw Me;en(1,0)}}function dt(W,K,ae){var be=un();try{return Kr(W)(K,ae)}catch(Ee){if(se(be),Ee!==Ee+0)throw Ee;en(1,0)}}a.ccall=mt;var Z;Fe=function W(){Z||te(),Z||(Fe=W)};function te(W){if(Se>0||(k(),Se>0))return;function K(){Z||(Z=!0,a.calledRun=!0,!I&&(J(),o(a),a.onRuntimeInitialized&&a.onRuntimeInitialized(),Y()))}a.setStatus?(a.setStatus("Running..."),setTimeout(function(){setTimeout(function(){a.setStatus("")},1),K()},1)):K()}if(a.preInit)for(typeof a.preInit=="function"&&(a.preInit=[a.preInit]);a.preInit.length>0;)a.preInit.pop()();return te(),i.ready})})();t.exports=n})(q8)),q8.exports}var m$e=g$e();const v$e=tl(m$e),y$e=new URL("/assets/libjpegturbowasm_decode-daqMmuVl.wasm",import.meta.url),Pb={codec:void 0,decoder:void 0};function x$e(){if(Pb.codec)return Promise.resolve();const t=v$e({locateFile:e=>e.endsWith(".wasm")?y$e.toString():e});return new Promise((e,n)=>{t.then(r=>{Pb.codec=r,Pb.decoder=new r.JPEGDecoder,e()},n)})}async function b$e(t,e){await x$e();const n=Pb.decoder;n.getEncodedBuffer(t.length).set(t),n.decode();const i=n.getFrameInfo(),a=n.getDecodedBuffer(),o={columns:i.width,rows:i.height,bitsPerPixel:i.bitsPerSample,signed:e.signed,bytesPerPixel:e.bytesPerPixel,componentsPerPixel:i.componentCount},s=w$e(i,a),l={frameInfo:i};return{...e,pixelData:s,imageInfo:o,encodeOptions:l,...l,...o}}function w$e(t,e){return t.isSigned?new Int8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}const Wv={JpegImage:void 0,decodeConfig:{}};function C$e(t){return Wv.decodeConfig=t,Wv.JpegImage?Promise.resolve():new Promise((e,n)=>{Cm(()=>import("./jpeg-B-x1txLf.js"),[]).then(r=>{Wv.JpegImage=r.default,e()}).catch(n)})}async function S$e(t,e){if(await C$e(),typeof Wv.JpegImage>"u")throw new Error("No JPEG Baseline decoder loaded");const n=new Wv.JpegImage;if(n.parse(e),n.colorTransform=!1,t.bitsAllocated===8)return t.pixelData=n.getData(t.columns,t.rows),t;if(t.bitsAllocated===16)return t.pixelData=n.getData16(t.columns,t.rows),t}const Hv={DecoderClass:void 0,decodeConfig:{}};function T$e(t){return Hv.decodeConfig=t,Hv.DecoderClass?Promise.resolve():new Promise((e,n)=>{Cm(async()=>{const{Decoder:r}=await import("./lossless-CyYqoyFe.js");return{Decoder:r}},[]).then(({Decoder:r})=>{Hv.DecoderClass=r,e()},n)})}async function KF(t,e){if(await T$e(),typeof Hv.DecoderClass>"u")throw new Error("No JPEG Lossless decoder loaded");const n=new Hv.DecoderClass,r=t.bitsAllocated<=8?1:2,i=e.buffer,a=n.decode(i,e.byteOffset,e.length,r);return t.pixelRepresentation===0?t.bitsAllocated===16?(t.pixelData=new Uint16Array(a.buffer),t):(t.pixelData=new Uint8Array(a.buffer),t):(t.pixelData=new Int16Array(a.buffer),t)}var X8={exports:{}},qF;function E$e(){return qF||(qF=1,(function(t,e){var n=(()=>{var r=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename<"u"&&(r=r||__filename),(function(i){i=i||{};var a=typeof i<"u"?i:{},o,s;a.ready=new Promise(function(de,he){o=de,s=he});var l=Object.assign({},a),c=typeof window=="object",f=typeof importScripts=="function",u=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",d="";function h(de){return a.locateFile?a.locateFile(de,d):d+de}var p,g,m;if(u){var y=Nf,v=Nf;f?d=v.dirname(d)+"/":d=__dirname+"/",p=(de,he)=>(de=pe(de)?new URL(de):v.normalize(de),y.readFileSync(de,he?void 0:"utf8")),m=de=>{var he=p(de,!0);return he.buffer||(he=new Uint8Array(he)),he},g=(de,he,Oe)=>{de=pe(de)?new URL(de):v.normalize(de),y.readFile(de,function(Ye,at){Ye?Oe(Ye):he(at.buffer)})},process.argv.length>1&&process.argv[1].replace(/\\/g,"/"),process.argv.slice(2),process.on("uncaughtException",function(de){if(!(de instanceof Pe))throw de}),process.on("unhandledRejection",function(de){throw de}),a.inspect=function(){return"[Emscripten Module object]"}}else(c||f)&&(f?d=self.location.href:typeof document<"u"&&document.currentScript&&(d=document.currentScript.src),r&&(d=r),d.indexOf("blob:")!==0?d=d.substr(0,d.replace(/[?#].*/,"").lastIndexOf("/")+1):d="",p=de=>{var he=new XMLHttpRequest;return he.open("GET",de,!1),he.send(null),he.responseText},f&&(m=de=>{var he=new XMLHttpRequest;return he.open("GET",de,!1),he.responseType="arraybuffer",he.send(null),new Uint8Array(he.response)}),g=(de,he,Oe)=>{var Ye=new XMLHttpRequest;Ye.open("GET",de,!0),Ye.responseType="arraybuffer",Ye.onload=()=>{if(Ye.status==200||Ye.status==0&&Ye.response){he(Ye.response);return}Oe()},Ye.onerror=Oe,Ye.send(null)});a.print||console.log.bind(console);var x=a.printErr||console.warn.bind(console);Object.assign(a,l),l=null,a.arguments&&a.arguments,a.thisProgram&&a.thisProgram,a.quit&&a.quit;var w;a.wasmBinary&&(w=a.wasmBinary),a.noExitRuntime,typeof WebAssembly!="object"&&Fe("no native wasm support detected");var S,T=!1;function _(de,he){de||Fe(he)}var D=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function I(de,he,Oe){for(var Ye=he+Oe,at=he;de[at]&&!(at>=Ye);)++at;if(at-he>16&&de.buffer&&D)return D.decode(de.subarray(he,at));for(var gt="";he<at;){var mt=de[he++];if(!(mt&128)){gt+=String.fromCharCode(mt);continue}var lt=de[he++]&63;if((mt&224)==192){gt+=String.fromCharCode((mt&31)<<6|lt);continue}var bt=de[he++]&63;if((mt&240)==224?mt=(mt&15)<<12|lt<<6|bt:mt=(mt&7)<<18|lt<<12|bt<<6|de[he++]&63,mt<65536)gt+=String.fromCharCode(mt);else{var kt=mt-65536;gt+=String.fromCharCode(55296|kt>>10,56320|kt&1023)}}return gt}function R(de,he){return de?I(U,de,he):""}function M(de,he,Oe,Ye){if(!(Ye>0))return 0;for(var at=Oe,gt=Oe+Ye-1,mt=0;mt<de.length;++mt){var lt=de.charCodeAt(mt);if(lt>=55296&&lt<=57343){var bt=de.charCodeAt(++mt);lt=65536+((lt&1023)<<10)|bt&1023}if(lt<=127){if(Oe>=gt)break;he[Oe++]=lt}else if(lt<=2047){if(Oe+1>=gt)break;he[Oe++]=192|lt>>6,he[Oe++]=128|lt&63}else if(lt<=65535){if(Oe+2>=gt)break;he[Oe++]=224|lt>>12,he[Oe++]=128|lt>>6&63,he[Oe++]=128|lt&63}else{if(Oe+3>=gt)break;he[Oe++]=240|lt>>18,he[Oe++]=128|lt>>12&63,he[Oe++]=128|lt>>6&63,he[Oe++]=128|lt&63}}return he[Oe]=0,Oe-at}function A(de,he,Oe){return M(de,U,he,Oe)}function L(de){for(var he=0,Oe=0;Oe<de.length;++Oe){var Ye=de.charCodeAt(Oe);Ye<=127?he++:Ye<=2047?he+=2:Ye>=55296&&Ye<=57343?(he+=4,++Oe):he+=3}return he}var P,B,U,G,F,$,V,X,Q;function re(de){P=de,a.HEAP8=B=new Int8Array(de),a.HEAP16=G=new Int16Array(de),a.HEAP32=$=new Int32Array(de),a.HEAPU8=U=new Uint8Array(de),a.HEAPU16=F=new Uint16Array(de),a.HEAPU32=V=new Uint32Array(de),a.HEAPF32=X=new Float32Array(de),a.HEAPF64=Q=new Float64Array(de)}a.INITIAL_MEMORY;var ye,me=[],Ce=[],we=[];function Ae(){if(a.preRun)for(typeof a.preRun=="function"&&(a.preRun=[a.preRun]);a.preRun.length;)k(a.preRun.shift());ne(me)}function De(){ne(Ce)}function q(){if(a.postRun)for(typeof a.postRun=="function"&&(a.postRun=[a.postRun]);a.postRun.length;)Y(a.postRun.shift());ne(we)}function k(de){me.unshift(de)}function J(de){Ce.unshift(de)}function Y(de){we.unshift(de)}var ie=0,ue=null;function fe(de){ie++,a.monitorRunDependencies&&a.monitorRunDependencies(ie)}function Se(de){if(ie--,a.monitorRunDependencies&&a.monitorRunDependencies(ie),ie==0&&ue){var he=ue;ue=null,he()}}function Fe(de){a.onAbort&&a.onAbort(de),de="Aborted("+de+")",x(de),T=!0,de+=". Build with -sASSERTIONS for more info.";var he=new WebAssembly.RuntimeError(de);throw s(he),he}var Ke="data:application/octet-stream;base64,";function He(de){return de.startsWith(Ke)}function pe(de){return de.startsWith("file://")}var ge;ge="charlswasm_decode.wasm",He(ge)||(ge=h(ge));function Ie(de){try{if(de==ge&&w)return new Uint8Array(w);if(m)return m(de);throw"both async and sync fetching of the wasm failed"}catch(he){Fe(he)}}function ve(){if(!w&&(c||f)){if(typeof fetch=="function"&&!pe(ge))return fetch(ge,{credentials:"same-origin"}).then(function(de){if(!de.ok)throw"failed to load wasm binary file at '"+ge+"'";return de.arrayBuffer()}).catch(function(){return Ie(ge)});if(g)return new Promise(function(de,he){g(ge,function(Oe){de(new Uint8Array(Oe))},he)})}return Promise.resolve().then(function(){return Ie(ge)})}function _e(){var de={a:ql};function he(mt,lt){var bt=mt.exports;a.asm=bt,S=a.asm.z,re(S.buffer),ye=a.asm.C,J(a.asm.A),Se()}fe();function Oe(mt){he(mt.instance)}function Ye(mt){return ve().then(function(lt){return WebAssembly.instantiate(lt,de)}).then(function(lt){return lt}).then(mt,function(lt){x("failed to asynchronously prepare wasm: "+lt),Fe(lt)})}function at(){return!w&&typeof WebAssembly.instantiateStreaming=="function"&&!He(ge)&&!pe(ge)&&!u&&typeof fetch=="function"?fetch(ge,{credentials:"same-origin"}).then(function(mt){var lt=WebAssembly.instantiateStreaming(mt,de);return lt.then(Oe,function(bt){return x("wasm streaming compile failed: "+bt),x("falling back to ArrayBuffer instantiation"),Ye(Oe)})}):Ye(Oe)}if(a.instantiateWasm)try{var gt=a.instantiateWasm(de,he);return gt}catch(mt){x("Module.instantiateWasm callback failed with error: "+mt),s(mt)}return at().catch(s),{}}function Pe(de){this.name="ExitStatus",this.message="Program terminated with exit("+de+")",this.status=de}function ne(de){for(;de.length>0;)de.shift()(a)}function Je(de){this.excPtr=de,this.ptr=de-24,this.set_type=function(he){V[this.ptr+4>>2]=he},this.get_type=function(){return V[this.ptr+4>>2]},this.set_destructor=function(he){V[this.ptr+8>>2]=he},this.get_destructor=function(){return V[this.ptr+8>>2]},this.set_refcount=function(he){$[this.ptr>>2]=he},this.set_caught=function(he){he=he?1:0,B[this.ptr+12>>0]=he},this.get_caught=function(){return B[this.ptr+12>>0]!=0},this.set_rethrown=function(he){he=he?1:0,B[this.ptr+13>>0]=he},this.get_rethrown=function(){return B[this.ptr+13>>0]!=0},this.init=function(he,Oe){this.set_adjusted_ptr(0),this.set_type(he),this.set_destructor(Oe),this.set_refcount(0),this.set_caught(!1),this.set_rethrown(!1)},this.add_ref=function(){var he=$[this.ptr>>2];$[this.ptr>>2]=he+1},this.release_ref=function(){var he=$[this.ptr>>2];return $[this.ptr>>2]=he-1,he===1},this.set_adjusted_ptr=function(he){V[this.ptr+16>>2]=he},this.get_adjusted_ptr=function(){return V[this.ptr+16>>2]},this.get_exception_ptr=function(){var he=us(this.get_type());if(he)return V[this.excPtr>>2];var Oe=this.get_adjusted_ptr();return Oe!==0?Oe:this.excPtr}}function $e(de,he,Oe){var Ye=new Je(de);throw Ye.init(he,Oe),de}var ke={};function Re(de){for(;de.length;){var he=de.pop(),Oe=de.pop();Oe(he)}}function ze(de){return this.fromWireType($[de>>2])}var st={},Qe={},_t={},Le=48,We=57;function xt(de){if(de===void 0)return"_unknown";de=de.replace(/[^a-zA-Z0-9_]/g,"$");var he=de.charCodeAt(0);return he>=Le&&he<=We?"_"+de:de}function Ut(de,he){return de=xt(de),new Function("body","return function "+de+`() {
    "use strict";    return body.apply(this, arguments);
};
`)(he)}function gn(de,he){var Oe=Ut(he,function(Ye){this.name=he,this.message=Ye;var at=new Error(Ye).stack;at!==void 0&&(this.stack=this.toString()+`
`+at.replace(/^Error(:[^\n]*)?\n/,""))});return Oe.prototype=Object.create(de.prototype),Oe.prototype.constructor=Oe,Oe.prototype.toString=function(){return this.message===void 0?this.name:this.name+": "+this.message},Oe}var tn=void 0;function Ht(de){throw new tn(de)}function dn(de,he,Oe){de.forEach(function(lt){_t[lt]=he});function Ye(lt){var bt=Oe(lt);bt.length!==de.length&&Ht("Mismatched type converter count");for(var kt=0;kt<de.length;++kt)Xt(de[kt],bt[kt])}var at=new Array(he.length),gt=[],mt=0;he.forEach((lt,bt)=>{Qe.hasOwnProperty(lt)?at[bt]=Qe[lt]:(gt.push(lt),st.hasOwnProperty(lt)||(st[lt]=[]),st[lt].push(()=>{at[bt]=Qe[lt],++mt,mt===gt.length&&Ye(at)}))}),gt.length===0&&Ye(at)}function sr(de){var he=ke[de];delete ke[de];var Oe=he.rawConstructor,Ye=he.rawDestructor,at=he.fields,gt=at.map(mt=>mt.getterReturnType).concat(at.map(mt=>mt.setterArgumentType));dn([de],gt,mt=>{var lt={};return at.forEach((bt,kt)=>{var Kt=bt.fieldName,en=mt[kt],un=bt.getter,se=bt.getterContext,oe=mt[kt+at.length],Te=bt.setter,Ge=bt.setterContext;lt[Kt]={read:rt=>en.fromWireType(un(se,rt)),write:(rt,Tt)=>{var pt=[];Te(Ge,rt,oe.toWireType(pt,Tt)),Re(pt)}}}),[{name:he.name,fromWireType:function(bt){var kt={};for(var Kt in lt)kt[Kt]=lt[Kt].read(bt);return Ye(bt),kt},toWireType:function(bt,kt){for(var Kt in lt)if(!(Kt in kt))throw new TypeError('Missing field:  "'+Kt+'"');var en=Oe();for(Kt in lt)lt[Kt].write(en,kt[Kt]);return bt!==null&&bt.push(Ye,en),en},argPackAdvance:8,readValueFromPointer:ze,destructorFunction:Ye}]})}function Qn(de,he,Oe,Ye,at){}function qe(de){switch(de){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+de)}}function Dt(){for(var de=new Array(256),he=0;he<256;++he)de[he]=String.fromCharCode(he);Rt=de}var Rt=void 0;function Bt(de){for(var he="",Oe=de;U[Oe];)he+=Rt[U[Oe++]];return he}var On=void 0;function $t(de){throw new On(de)}function Xt(de,he,Oe={}){if(!("argPackAdvance"in he))throw new TypeError("registerType registeredInstance requires argPackAdvance");var Ye=he.name;if(de||$t('type "'+Ye+'" must have a positive integer typeid pointer'),Qe.hasOwnProperty(de)){if(Oe.ignoreDuplicateRegistrations)return;$t("Cannot register type '"+Ye+"' twice")}if(Qe[de]=he,delete _t[de],st.hasOwnProperty(de)){var at=st[de];delete st[de],at.forEach(gt=>gt())}}function Lt(de,he,Oe,Ye,at){var gt=qe(Oe);he=Bt(he),Xt(de,{name:he,fromWireType:function(mt){return!!mt},toWireType:function(mt,lt){return lt?Ye:at},argPackAdvance:8,readValueFromPointer:function(mt){var lt;if(Oe===1)lt=B;else if(Oe===2)lt=G;else if(Oe===4)lt=$;else throw new TypeError("Unknown boolean type size: "+he);return this.fromWireType(lt[mt>>gt])},destructorFunction:null})}function Qt(de){if(!(this instanceof go)||!(de instanceof go))return!1;for(var he=this.$$.ptrType.registeredClass,Oe=this.$$.ptr,Ye=de.$$.ptrType.registeredClass,at=de.$$.ptr;he.baseClass;)Oe=he.upcast(Oe),he=he.baseClass;for(;Ye.baseClass;)at=Ye.upcast(at),Ye=Ye.baseClass;return he===Ye&&Oe===at}function yr(de){return{count:de.count,deleteScheduled:de.deleteScheduled,preservePointerOnDelete:de.preservePointerOnDelete,ptr:de.ptr,ptrType:de.ptrType,smartPtr:de.smartPtr,smartPtrType:de.smartPtrType}}function kr(de){function he(Oe){return Oe.$$.ptrType.registeredClass.name}$t(he(de)+" instance already deleted")}var ni=!1;function Ii(de){}function fi(de){de.smartPtr?de.smartPtrType.rawDestructor(de.smartPtr):de.ptrType.registeredClass.rawDestructor(de.ptr)}function Ri(de){de.count.value-=1;var he=de.count.value===0;he&&fi(de)}function rn(de,he,Oe){if(he===Oe)return de;if(Oe.baseClass===void 0)return null;var Ye=rn(de,he,Oe.baseClass);return Ye===null?null:Oe.downcast(Ye)}var Xn={};function vi(){return Object.keys(Pi).length}function an(){var de=[];for(var he in Pi)Pi.hasOwnProperty(he)&&de.push(Pi[he]);return de}var ri=[];function ts(){for(;ri.length;){var de=ri.pop();de.$$.deleteScheduled=!1,de.delete()}}var ii=void 0;function Ai(de){ii=de,ri.length&&ii&&ii(ts)}function wa(){a.getInheritedInstanceCount=vi,a.getLiveInheritedInstances=an,a.flushPendingDeletes=ts,a.setDelayFunction=Ai}var Pi={};function Os(de,he){for(he===void 0&&$t("ptr should not be undefined");de.baseClass;)he=de.upcast(he),de=de.baseClass;return he}function No(de,he){return he=Os(de,he),Pi[he]}function Ni(de,he){(!he.ptrType||!he.ptr)&&Ht("makeClassHandle requires ptr and ptrType");var Oe=!!he.smartPtrType,Ye=!!he.smartPtr;return Oe!==Ye&&Ht("Both smartPtrType and smartPtr must be specified"),he.count={value:1},At(Object.create(de,{$$:{value:he}}))}function Lo(de){var he=this.getPointee(de);if(!he)return this.destructor(de),null;var Oe=No(this.registeredClass,he);if(Oe!==void 0){if(Oe.$$.count.value===0)return Oe.$$.ptr=he,Oe.$$.smartPtr=de,Oe.clone();var Ye=Oe.clone();return this.destructor(de),Ye}function at(){return this.isSmartPointer?Ni(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:he,smartPtrType:this,smartPtr:de}):Ni(this.registeredClass.instancePrototype,{ptrType:this,ptr:de})}var gt=this.registeredClass.getActualType(he),mt=Xn[gt];if(!mt)return at.call(this);var lt;this.isConst?lt=mt.constPointerType:lt=mt.pointerType;var bt=rn(he,this.registeredClass,lt.registeredClass);return bt===null?at.call(this):this.isSmartPointer?Ni(lt.registeredClass.instancePrototype,{ptrType:lt,ptr:bt,smartPtrType:this,smartPtr:de}):Ni(lt.registeredClass.instancePrototype,{ptrType:lt,ptr:bt})}function At(de){return typeof FinalizationRegistry>"u"?(At=he=>he,de):(ni=new FinalizationRegistry(he=>{Ri(he.$$)}),At=he=>{var Oe=he.$$,Ye=!!Oe.smartPtr;if(Ye){var at={$$:Oe};ni.register(he,at,he)}return he},Ii=he=>ni.unregister(he),At(de))}function Li(){if(this.$$.ptr||kr(this),this.$$.preservePointerOnDelete)return this.$$.count.value+=1,this;var de=At(Object.create(Object.getPrototypeOf(this),{$$:{value:yr(this.$$)}}));return de.$$.count.value+=1,de.$$.deleteScheduled=!1,de}function Xa(){this.$$.ptr||kr(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&$t("Object already scheduled for deletion"),Ii(this),Ri(this.$$),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)}function di(){return!this.$$.ptr}function Ms(){return this.$$.ptr||kr(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&$t("Object already scheduled for deletion"),ri.push(this),ri.length===1&&ii&&ii(ts),this.$$.deleteScheduled=!0,this}function ko(){go.prototype.isAliasOf=Qt,go.prototype.clone=Li,go.prototype.delete=Xa,go.prototype.isDeleted=di,go.prototype.deleteLater=Ms}function go(){}function $l(de,he,Oe){if(de[he].overloadTable===void 0){var Ye=de[he];de[he]=function(){return de[he].overloadTable.hasOwnProperty(arguments.length)||$t("Function '"+Oe+"' called with an invalid number of arguments ("+arguments.length+") - expects one of ("+de[he].overloadTable+")!"),de[he].overloadTable[arguments.length].apply(this,arguments)},de[he].overloadTable=[],de[he].overloadTable[Ye.argCount]=Ye}}function pr(de,he,Oe){a.hasOwnProperty(de)?((Oe===void 0||a[de].overloadTable!==void 0&&a[de].overloadTable[Oe]!==void 0)&&$t("Cannot register public name '"+de+"' twice"),$l(a,de,de),a.hasOwnProperty(Oe)&&$t("Cannot register multiple overloads of a function with the same number of arguments ("+Oe+")!"),a[de].overloadTable[Oe]=he):(a[de]=he,Oe!==void 0&&(a[de].numArguments=Oe))}function ka(de,he,Oe,Ye,at,gt,mt,lt){this.name=de,this.constructor=he,this.instancePrototype=Oe,this.rawDestructor=Ye,this.baseClass=at,this.getActualType=gt,this.upcast=mt,this.downcast=lt,this.pureVirtualFunctions=[]}function il(de,he,Oe){for(;he!==Oe;)he.upcast||$t("Expected null or instance of "+Oe.name+", got an instance of "+he.name),de=he.upcast(de),he=he.baseClass;return de}function Vo(de,he){if(he===null)return this.isReference&&$t("null is not a valid "+this.name),0;he.$$||$t('Cannot pass "'+yi(he)+'" as a '+this.name),he.$$.ptr||$t("Cannot pass deleted object as a pointer of type "+this.name);var Oe=he.$$.ptrType.registeredClass,Ye=il(he.$$.ptr,Oe,this.registeredClass);return Ye}function al(de,he){var Oe;if(he===null)return this.isReference&&$t("null is not a valid "+this.name),this.isSmartPointer?(Oe=this.rawConstructor(),de!==null&&de.push(this.rawDestructor,Oe),Oe):0;he.$$||$t('Cannot pass "'+yi(he)+'" as a '+this.name),he.$$.ptr||$t("Cannot pass deleted object as a pointer of type "+this.name),!this.isConst&&he.$$.ptrType.isConst&&$t("Cannot convert argument of type "+(he.$$.smartPtrType?he.$$.smartPtrType.name:he.$$.ptrType.name)+" to parameter type "+this.name);var Ye=he.$$.ptrType.registeredClass;if(Oe=il(he.$$.ptr,Ye,this.registeredClass),this.isSmartPointer)switch(he.$$.smartPtr===void 0&&$t("Passing raw pointer to smart pointer is illegal"),this.sharingPolicy){case 0:he.$$.smartPtrType===this?Oe=he.$$.smartPtr:$t("Cannot convert argument of type "+(he.$$.smartPtrType?he.$$.smartPtrType.name:he.$$.ptrType.name)+" to parameter type "+this.name);break;case 1:Oe=he.$$.smartPtr;break;case 2:if(he.$$.smartPtrType===this)Oe=he.$$.smartPtr;else{var at=he.clone();Oe=this.rawShare(Oe,oi.toHandle(function(){at.delete()})),de!==null&&de.push(this.rawDestructor,Oe)}break;default:$t("Unsupporting sharing policy")}return Oe}function Va(de,he){if(he===null)return this.isReference&&$t("null is not a valid "+this.name),0;he.$$||$t('Cannot pass "'+yi(he)+'" as a '+this.name),he.$$.ptr||$t("Cannot pass deleted object as a pointer of type "+this.name),he.$$.ptrType.isConst&&$t("Cannot convert argument of type "+he.$$.ptrType.name+" to parameter type "+this.name);var Oe=he.$$.ptrType.registeredClass,Ye=il(he.$$.ptr,Oe,this.registeredClass);return Ye}function Ou(de){return this.rawGetPointee&&(de=this.rawGetPointee(de)),de}function la(de){this.rawDestructor&&this.rawDestructor(de)}function Gl(de){de!==null&&de.delete()}function Sc(){Ca.prototype.getPointee=Ou,Ca.prototype.destructor=la,Ca.prototype.argPackAdvance=8,Ca.prototype.readValueFromPointer=ze,Ca.prototype.deleteObject=Gl,Ca.prototype.fromWireType=Lo}function Ca(de,he,Oe,Ye,at,gt,mt,lt,bt,kt,Kt){this.name=de,this.registeredClass=he,this.isReference=Oe,this.isConst=Ye,this.isSmartPointer=at,this.pointeeType=gt,this.sharingPolicy=mt,this.rawGetPointee=lt,this.rawConstructor=bt,this.rawShare=kt,this.rawDestructor=Kt,!at&&he.baseClass===void 0?Ye?(this.toWireType=Vo,this.destructorFunction=null):(this.toWireType=Va,this.destructorFunction=null):this.toWireType=al}function ki(de,he,Oe){a.hasOwnProperty(de)||Ht("Replacing nonexistant public symbol"),a[de].overloadTable!==void 0&&Oe!==void 0?a[de].overloadTable[Oe]=he:(a[de]=he,a[de].argCount=Oe)}function Sa(de,he,Oe){var Ye=a["dynCall_"+de];return Oe&&Oe.length?Ye.apply(null,[he].concat(Oe)):Ye.call(null,he)}var Vi=[];function Fo(de){var he=Vi[de];return he||(de>=Vi.length&&(Vi.length=de+1),Vi[de]=he=ye.get(de)),he}function ns(de,he,Oe){if(de.includes("j"))return Sa(de,he,Oe);var Ye=Fo(he).apply(null,Oe);return Ye}function rs(de,he){var Oe=[];return function(){return Oe.length=0,Object.assign(Oe,arguments),ns(de,he,Oe)}}function Kr(de,he){de=Bt(de);function Oe(){return de.includes("j")?rs(de,he):Fo(he)}var Ye=Oe();return typeof Ye!="function"&&$t("unknown function pointer with signature "+de+": "+he),Ye}var ol=void 0;function Ta(de){var he=cs(de),Oe=Bt(he);return Za(he),Oe}function Fi(de,he){var Oe=[],Ye={};function at(gt){if(!Ye[gt]&&!Qe[gt]){if(_t[gt]){_t[gt].forEach(at);return}Oe.push(gt),Ye[gt]=!0}}throw he.forEach(at),new ol(de+": "+Oe.map(Ta).join([", "]))}function is(de,he,Oe,Ye,at,gt,mt,lt,bt,kt,Kt,en,un){Kt=Bt(Kt),gt=Kr(at,gt),lt&&(lt=Kr(mt,lt)),kt&&(kt=Kr(bt,kt)),un=Kr(en,un);var se=xt(Kt);pr(se,function(){Fi("Cannot construct "+Kt+" due to unbound types",[Ye])}),dn([de,he,Oe],Ye?[Ye]:[],function(oe){oe=oe[0];var Te,Ge;Ye?(Te=oe.registeredClass,Ge=Te.instancePrototype):Ge=go.prototype;var rt=Ut(se,function(){if(Object.getPrototypeOf(this)!==Tt)throw new On("Use 'new' to construct "+Kt);if(pt.constructor_body===void 0)throw new On(Kt+" has no accessible constructor");var W=pt.constructor_body[arguments.length];if(W===void 0)throw new On("Tried to invoke ctor of "+Kt+" with invalid number of parameters ("+arguments.length+") - expected ("+Object.keys(pt.constructor_body).toString()+") parameters instead!");return W.apply(this,arguments)}),Tt=Object.create(Ge,{constructor:{value:rt}});rt.prototype=Tt;var pt=new ka(Kt,rt,Tt,un,Te,gt,lt,kt),dt=new Ca(Kt,pt,!0,!1,!1),Z=new Ca(Kt+"*",pt,!1,!1,!1),te=new Ca(Kt+" const*",pt,!1,!0,!1);return Xn[de]={pointerType:Z,constPointerType:te},ki(se,rt),[dt,Z,te]})}function mo(de,he){for(var Oe=[],Ye=0;Ye<de;Ye++)Oe.push(V[he+Ye*4>>2]);return Oe}function qi(de,he){if(!(de instanceof Function))throw new TypeError("new_ called with constructor type "+typeof de+" which is not a function");var Oe=Ut(de.name||"unknownFunctionName",function(){});Oe.prototype=de.prototype;var Ye=new Oe,at=de.apply(Ye,he);return at instanceof Object?at:Ye}function Fa(de,he,Oe,Ye,at){var gt=he.length;gt<2&&$t("argTypes array size mismatch! Must at least get return value and 'this' types!");for(var mt=he[1]!==null&&Oe!==null,lt=!1,bt=1;bt<he.length;++bt)if(he[bt]!==null&&he[bt].destructorFunction===void 0){lt=!0;break}for(var kt=he[0].name!=="void",Kt="",en="",bt=0;bt<gt-2;++bt)Kt+=(bt!==0?", ":"")+"arg"+bt,en+=(bt!==0?", ":"")+"arg"+bt+"Wired";var un="return function "+xt(de)+"("+Kt+`) {
if (arguments.length !== `+(gt-2)+`) {
throwBindingError('function `+de+" called with ' + arguments.length + ' arguments, expected "+(gt-2)+` args!');
}
`;lt&&(un+=`var destructors = [];
`);var se=lt?"destructors":"null",oe=["throwBindingError","invoker","fn","runDestructors","retType","classParam"],Te=[$t,Ye,at,Re,he[0],he[1]];mt&&(un+="var thisWired = classParam.toWireType("+se+`, this);
`);for(var bt=0;bt<gt-2;++bt)un+="var arg"+bt+"Wired = argType"+bt+".toWireType("+se+", arg"+bt+"); // "+he[bt+2].name+`
`,oe.push("argType"+bt),Te.push(he[bt+2]);if(mt&&(en="thisWired"+(en.length>0?", ":"")+en),un+=(kt?"var rv = ":"")+"invoker(fn"+(en.length>0?", ":"")+en+`);
`,lt)un+=`runDestructors(destructors);
`;else for(var bt=mt?1:2;bt<he.length;++bt){var Ge=bt===1?"thisWired":"arg"+(bt-2)+"Wired";he[bt].destructorFunction!==null&&(un+=Ge+"_dtor("+Ge+"); // "+he[bt].name+`
`,oe.push(Ge+"_dtor"),Te.push(he[bt].destructorFunction))}kt&&(un+=`var ret = retType.fromWireType(rv);
return ret;
`),un+=`}
`,oe.push(un);var rt=qi(Function,oe).apply(null,Te);return rt}function Uo(de,he,Oe,Ye,at,gt){_(he>0);var mt=mo(he,Oe);at=Kr(Ye,at),dn([],[de],function(lt){lt=lt[0];var bt="constructor "+lt.name;if(lt.registeredClass.constructor_body===void 0&&(lt.registeredClass.constructor_body=[]),lt.registeredClass.constructor_body[he-1]!==void 0)throw new On("Cannot register multiple constructors with identical number of parameters ("+(he-1)+") for class '"+lt.name+"'! Overload resolution is currently only performed using the parameter count, not actual type info!");return lt.registeredClass.constructor_body[he-1]=()=>{Fi("Cannot construct "+lt.name+" due to unbound types",mt)},dn([],mt,function(kt){return kt.splice(1,0,null),lt.registeredClass.constructor_body[he-1]=Fa(bt,kt,null,at,gt),[]}),[]})}function jl(de,he,Oe,Ye,at,gt,mt,lt){var bt=mo(Oe,Ye);he=Bt(he),gt=Kr(at,gt),dn([],[de],function(kt){kt=kt[0];var Kt=kt.name+"."+he;he.startsWith("@@")&&(he=Symbol[he.substring(2)]),lt&&kt.registeredClass.pureVirtualFunctions.push(he);function en(){Fi("Cannot call "+Kt+" due to unbound types",bt)}var un=kt.registeredClass.instancePrototype,se=un[he];return se===void 0||se.overloadTable===void 0&&se.className!==kt.name&&se.argCount===Oe-2?(en.argCount=Oe-2,en.className=kt.name,un[he]=en):($l(un,he,Kt),un[he].overloadTable[Oe-2]=en),dn([],bt,function(oe){var Te=Fa(Kt,oe,kt,gt,mt);return un[he].overloadTable===void 0?(Te.argCount=Oe-2,un[he]=Te):un[he].overloadTable[Oe-2]=Te,[]}),[]})}var as=[],Sr=[{},{value:void 0},{value:null},{value:!0},{value:!1}];function Ya(de){de>4&&--Sr[de].refcount===0&&(Sr[de]=void 0,as.push(de))}function Tr(){for(var de=0,he=5;he<Sr.length;++he)Sr[he]!==void 0&&++de;return de}function ai(){for(var de=5;de<Sr.length;++de)if(Sr[de]!==void 0)return Sr[de];return null}function os(){a.count_emval_handles=Tr,a.get_first_emval=ai}var oi={toValue:de=>(de||$t("Cannot use deleted val. handle = "+de),Sr[de].value),toHandle:de=>{switch(de){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:{var he=as.length?as.pop():Sr.length;return Sr[he]={refcount:1,value:de},he}}}};function zl(de,he){he=Bt(he),Xt(de,{name:he,fromWireType:function(Oe){var Ye=oi.toValue(Oe);return Ya(Oe),Ye},toWireType:function(Oe,Ye){return oi.toHandle(Ye)},argPackAdvance:8,readValueFromPointer:ze,destructorFunction:null})}function yi(de){if(de===null)return"null";var he=typeof de;return he==="object"||he==="array"||he==="function"?de.toString():""+de}function Ja(de,he){switch(he){case 2:return function(Oe){return this.fromWireType(X[Oe>>2])};case 3:return function(Oe){return this.fromWireType(Q[Oe>>3])};default:throw new TypeError("Unknown float type: "+de)}}function ss(de,he,Oe){var Ye=qe(Oe);he=Bt(he),Xt(de,{name:he,fromWireType:function(at){return at},toWireType:function(at,gt){return gt},argPackAdvance:8,readValueFromPointer:Ja(he,Ye),destructorFunction:null})}function vo(de,he,Oe,Ye,at,gt){var mt=mo(he,Oe);de=Bt(de),at=Kr(Ye,at),pr(de,function(){Fi("Cannot call "+de+" due to unbound types",mt)},he-1),dn([],mt,function(lt){var bt=[lt[0],null].concat(lt.slice(1));return ki(de,Fa(de,bt,null,at,gt),he-1),[]})}function ca(de,he,Oe){switch(he){case 0:return Oe?function(at){return B[at]}:function(at){return U[at]};case 1:return Oe?function(at){return G[at>>1]}:function(at){return F[at>>1]};case 2:return Oe?function(at){return $[at>>2]}:function(at){return V[at>>2]};default:throw new TypeError("Unknown integer type: "+de)}}function xi(de,he,Oe,Ye,at){he=Bt(he);var gt=qe(Oe),mt=en=>en;if(Ye===0){var lt=32-8*Oe;mt=en=>en<<lt>>>lt}var bt=he.includes("unsigned"),kt=(en,un)=>{},Kt;bt?Kt=function(en,un){return kt(un,this.name),un>>>0}:Kt=function(en,un){return kt(un,this.name),un},Xt(de,{name:he,fromWireType:mt,toWireType:Kt,argPackAdvance:8,readValueFromPointer:ca(he,gt,Ye!==0),destructorFunction:null})}function Bo(de,he,Oe){var Ye=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],at=Ye[he];function gt(mt){mt=mt>>2;var lt=V,bt=lt[mt],kt=lt[mt+1];return new at(P,kt,bt)}Oe=Bt(Oe),Xt(de,{name:Oe,fromWireType:gt,argPackAdvance:8,readValueFromPointer:gt},{ignoreDuplicateRegistrations:!0})}function sl(de,he){he=Bt(he);var Oe=he==="std::string";Xt(de,{name:he,fromWireType:function(Ye){var at=V[Ye>>2],gt=Ye+4,mt;if(Oe)for(var lt=gt,bt=0;bt<=at;++bt){var kt=gt+bt;if(bt==at||U[kt]==0){var Kt=kt-lt,en=R(lt,Kt);mt===void 0?mt=en:(mt+="\0",mt+=en),lt=kt+1}}else{for(var un=new Array(at),bt=0;bt<at;++bt)un[bt]=String.fromCharCode(U[gt+bt]);mt=un.join("")}return Za(Ye),mt},toWireType:function(Ye,at){at instanceof ArrayBuffer&&(at=new Uint8Array(at));var gt,mt=typeof at=="string";mt||at instanceof Uint8Array||at instanceof Uint8ClampedArray||at instanceof Int8Array||$t("Cannot pass non-string to std::string"),Oe&&mt?gt=L(at):gt=at.length;var lt=$o(4+gt+1),bt=lt+4;if(V[lt>>2]=gt,Oe&&mt)A(at,bt,gt+1);else if(mt)for(var kt=0;kt<gt;++kt){var Kt=at.charCodeAt(kt);Kt>255&&(Za(bt),$t("String has UTF-16 code units that do not fit in 8 bits")),U[bt+kt]=Kt}else for(var kt=0;kt<gt;++kt)U[bt+kt]=at[kt];return Ye!==null&&Ye.push(Za,lt),lt},argPackAdvance:8,readValueFromPointer:ze,destructorFunction:function(Ye){Za(Ye)}})}var ls=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0;function Is(de,he){for(var Oe=de,Ye=Oe>>1,at=Ye+he/2;!(Ye>=at)&&F[Ye];)++Ye;if(Oe=Ye<<1,Oe-de>32&&ls)return ls.decode(U.subarray(de,Oe));for(var gt="",mt=0;!(mt>=he/2);++mt){var lt=G[de+mt*2>>1];if(lt==0)break;gt+=String.fromCharCode(lt)}return gt}function ll(de,he,Oe){if(Oe===void 0&&(Oe=2147483647),Oe<2)return 0;Oe-=2;for(var Ye=he,at=Oe<de.length*2?Oe/2:de.length,gt=0;gt<at;++gt){var mt=de.charCodeAt(gt);G[he>>1]=mt,he+=2}return G[he>>1]=0,he-Ye}function Rs(de){return de.length*2}function As(de,he){for(var Oe=0,Ye="";!(Oe>=he/4);){var at=$[de+Oe*4>>2];if(at==0)break;if(++Oe,at>=65536){var gt=at-65536;Ye+=String.fromCharCode(55296|gt>>10,56320|gt&1023)}else Ye+=String.fromCharCode(at)}return Ye}function cl(de,he,Oe){if(Oe===void 0&&(Oe=2147483647),Oe<4)return 0;for(var Ye=he,at=Ye+Oe-4,gt=0;gt<de.length;++gt){var mt=de.charCodeAt(gt);if(mt>=55296&&mt<=57343){var lt=de.charCodeAt(++gt);mt=65536+((mt&1023)<<10)|lt&1023}if($[he>>2]=mt,he+=4,he+4>at)break}return $[he>>2]=0,he-Ye}function Tc(de){for(var he=0,Oe=0;Oe<de.length;++Oe){var Ye=de.charCodeAt(Oe);Ye>=55296&&Ye<=57343&&++Oe,he+=4}return he}function Mu(de,he,Oe){Oe=Bt(Oe);var Ye,at,gt,mt,lt;he===2?(Ye=Is,at=ll,mt=Rs,gt=()=>F,lt=1):he===4&&(Ye=As,at=cl,mt=Tc,gt=()=>V,lt=2),Xt(de,{name:Oe,fromWireType:function(bt){for(var kt=V[bt>>2],Kt=gt(),en,un=bt+4,se=0;se<=kt;++se){var oe=bt+4+se*he;if(se==kt||Kt[oe>>lt]==0){var Te=oe-un,Ge=Ye(un,Te);en===void 0?en=Ge:(en+="\0",en+=Ge),un=oe+he}}return Za(bt),en},toWireType:function(bt,kt){typeof kt!="string"&&$t("Cannot pass non-string to C++ string type "+Oe);var Kt=mt(kt),en=$o(4+Kt+he);return V[en>>2]=Kt>>lt,at(kt,en+4,Kt+he),bt!==null&&bt.push(Za,en),en},argPackAdvance:8,readValueFromPointer:ze,destructorFunction:function(bt){Za(bt)}})}function Iu(de,he,Oe,Ye,at,gt){ke[de]={name:Bt(he),rawConstructor:Kr(Oe,Ye),rawDestructor:Kr(at,gt),fields:[]}}function Ru(de,he,Oe,Ye,at,gt,mt,lt,bt,kt){ke[de].fields.push({fieldName:Bt(he),getterReturnType:Oe,getter:Kr(Ye,at),getterContext:gt,setterArgumentType:mt,setter:Kr(lt,bt),setterContext:kt})}function Wl(de,he){he=Bt(he),Xt(de,{isVoid:!0,name:he,argPackAdvance:0,fromWireType:function(){},toWireType:function(Oe,Ye){}})}var Ec={};function Au(de){var he=Ec[de];return he===void 0?Bt(de):he}function _c(){return typeof globalThis=="object"?globalThis:(function(){return Function})()("return this")()}function Dc(de){return de===0?oi.toHandle(_c()):(de=Au(de),oi.toHandle(_c()[de]))}function Pu(de){de>4&&(Sr[de].refcount+=1)}function ul(de,he){var Oe=Qe[de];return Oe===void 0&&$t(he+" has unknown type "+Ta(de)),Oe}function Oc(de){for(var he="",Oe=0;Oe<de;++Oe)he+=(Oe!==0?", ":"")+"arg"+Oe;for(var Ye=()=>V,at="return function emval_allocator_"+de+`(constructor, argTypes, args) {
  var HEAPU32 = getMemory();
`,Oe=0;Oe<de;++Oe)at+="var argType"+Oe+" = requireRegisteredType(HEAPU32[((argTypes)>>2)], 'parameter "+Oe+`');
var arg`+Oe+" = argType"+Oe+`.readValueFromPointer(args);
args += argType`+Oe+`['argPackAdvance'];
argTypes += 4;
`;return at+="var obj = new constructor("+he+`);
return valueToHandle(obj);
}
`,new Function("requireRegisteredType","Module","valueToHandle","getMemory",at)(ul,a,oi.toHandle,Ye)}var Mc={};function Hl(de,he,Oe,Ye){de=oi.toValue(de);var at=Mc[he];return at||(at=Oc(he),Mc[he]=at),at(de,Oe,Ye)}function Nu(de,he){de=ul(de,"_emval_take_value");var Oe=de.readValueFromPointer(he);return oi.toHandle(Oe)}function fl(){Fe("")}function Lu(de,he,Oe){U.copyWithin(de,he,he+Oe)}function Ic(){return 2147483648}function ku(de){try{return S.grow(de-P.byteLength+65535>>>16),re(S.buffer),1}catch{}}function Rc(de){var he=U.length;de=de>>>0;var Oe=Ic();if(de>Oe)return!1;let Ye=(bt,kt)=>bt+(kt-bt%kt)%kt;for(var at=1;at<=4;at*=2){var gt=he*(1+.2/at);gt=Math.min(gt,de+100663296);var mt=Math.min(Oe,Ye(Math.max(de,gt),65536)),lt=ku(mt);if(lt)return!0}return!1}function Vu(de){var he=a["_"+de];return he}function Fu(de,he){B.set(de,he)}function Kl(de,he,Oe,Ye,at){var gt={string:oe=>{var Te=0;if(oe!=null&&oe!==0){var Ge=(oe.length<<2)+1;Te=Ps(Ge),A(oe,Te,Ge)}return Te},array:oe=>{var Te=Ps(oe.length);return Fu(oe,Te),Te}};function mt(oe){return he==="string"?R(oe):he==="boolean"?!!oe:oe}var lt=Vu(de),bt=[],kt=0;if(Ye)for(var Kt=0;Kt<Ye.length;Kt++){var en=gt[Oe[Kt]];en?(kt===0&&(kt=Ac()),bt[Kt]=en(Ye[Kt])):bt[Kt]=Ye[Kt]}var un=lt.apply(null,bt);function se(oe){return kt!==0&&Pc(kt),mt(oe)}return un=se(un),un}tn=a.InternalError=gn(Error,"InternalError"),Dt(),On=a.BindingError=gn(Error,"BindingError"),ko(),wa(),Sc(),ol=a.UnboundTypeError=gn(Error,"UnboundTypeError"),os();var ql={h:$e,q:sr,r:Qn,w:Lt,p:is,o:Uo,c:jl,v:zl,k:ss,e:vo,b:xi,a:Bo,j:sl,g:Mu,u:Iu,d:Ru,x:Wl,i:Ya,m:Dc,l:Pu,y:Hl,n:Nu,f:fl,t:Lu,s:Rc};_e(),a.___wasm_call_ctors=function(){return(a.___wasm_call_ctors=a.asm.A).apply(null,arguments)};var $o=a._malloc=function(){return($o=a._malloc=a.asm.B).apply(null,arguments)},cs=a.___getTypeName=function(){return(cs=a.___getTypeName=a.asm.D).apply(null,arguments)};a.__embind_initialize_bindings=function(){return(a.__embind_initialize_bindings=a.asm.E).apply(null,arguments)};var Za=a._free=function(){return(Za=a._free=a.asm.F).apply(null,arguments)},Ac=a.stackSave=function(){return(Ac=a.stackSave=a.asm.G).apply(null,arguments)},Pc=a.stackRestore=function(){return(Pc=a.stackRestore=a.asm.H).apply(null,arguments)},Ps=a.stackAlloc=function(){return(Ps=a.stackAlloc=a.asm.I).apply(null,arguments)},us=a.___cxa_is_pointer_type=function(){return(us=a.___cxa_is_pointer_type=a.asm.J).apply(null,arguments)};a.ccall=Kl;var dl;ue=function de(){dl||Xl(),dl||(ue=de)};function Xl(de){if(ie>0||(Ae(),ie>0))return;function he(){dl||(dl=!0,a.calledRun=!0,!T&&(De(),o(a),a.onRuntimeInitialized&&a.onRuntimeInitialized(),q()))}a.setStatus?(a.setStatus("Running..."),setTimeout(function(){setTimeout(function(){a.setStatus("")},1),he()},1)):he()}if(a.preInit)for(typeof a.preInit=="function"&&(a.preInit=[a.preInit]);a.preInit.length>0;)a.preInit.pop()();return Xl(),i.ready})})();t.exports=n})(X8)),X8.exports}var _$e=E$e();const D$e=tl(_$e),O$e=new URL("/assets/charlswasm_decode-484ovEoR.wasm",import.meta.url),_g={codec:void 0,decoder:void 0,decodeConfig:{}};function M$e(t){return typeof t=="number"?_g.codec.getExceptionMessage(t):t}function I$e(t){if(_g.decodeConfig=t,_g.codec)return Promise.resolve();const e=D$e({locateFile:n=>n.endsWith(".wasm")?O$e.toString():n});return new Promise((n,r)=>{e.then(i=>{_g.codec=i,_g.decoder=new i.JpegLSDecoder,n()},r)})}async function XF(t,e){try{await I$e();const n=_g.decoder;n.getEncodedBuffer(t.length).set(t),n.decode();const i=n.getFrameInfo(),a=n.getInterleaveMode(),o=n.getNearLossless(),s=n.getDecodedBuffer(),l={columns:i.width,rows:i.height,bitsPerPixel:i.bitsPerSample,signed:e.signed,bytesPerPixel:e.bytesPerPixel,componentsPerPixel:i.componentCount},c=R$e(i,s,e.signed),f={nearLossless:o,interleaveMode:a,frameInfo:i};return{...e,pixelData:c,imageInfo:l,encodeOptions:f,...f,...l}}catch(n){throw M$e(n)}}function R$e(t,e,n){return t.bitsPerSample>8?n?new Int16Array(e.buffer,e.byteOffset,e.byteLength/2):new Uint16Array(e.buffer,e.byteOffset,e.byteLength/2):n?new Int8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}var Y8={exports:{}},YF;function A$e(){return YF||(YF=1,(function(t,e){var n=(()=>{var r=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename<"u"&&(r=r||__filename),(function(i){i=i||{};var a=typeof i<"u"?i:{},o,s;a.ready=new Promise(function(se,oe){o=se,s=oe});var l=Object.assign({},a),c="./this.program",f=typeof window=="object",u=typeof importScripts=="function",d=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",h="";function p(se){return a.locateFile?a.locateFile(se,h):h+se}var g,m,y;if(d){var v=Nf,x=Nf;u?h=x.dirname(h)+"/":h=__dirname+"/",g=(se,oe)=>(se=Ie(se)?new URL(se):x.normalize(se),v.readFileSync(se,oe?void 0:"utf8")),y=se=>{var oe=g(se,!0);return oe.buffer||(oe=new Uint8Array(oe)),oe},m=(se,oe,Te)=>{se=Ie(se)?new URL(se):x.normalize(se),v.readFile(se,function(Ge,rt){Ge?Te(Ge):oe(rt.buffer)})},process.argv.length>1&&(c=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2),process.on("uncaughtException",function(se){if(!(se instanceof Je))throw se}),process.on("unhandledRejection",function(se){throw se}),a.inspect=function(){return"[Emscripten Module object]"}}else(f||u)&&(u?h=self.location.href:typeof document<"u"&&document.currentScript&&(h=document.currentScript.src),r&&(h=r),h.indexOf("blob:")!==0?h=h.substr(0,h.replace(/[?#].*/,"").lastIndexOf("/")+1):h="",g=se=>{var oe=new XMLHttpRequest;return oe.open("GET",se,!1),oe.send(null),oe.responseText},u&&(y=se=>{var oe=new XMLHttpRequest;return oe.open("GET",se,!1),oe.responseType="arraybuffer",oe.send(null),new Uint8Array(oe.response)}),m=(se,oe,Te)=>{var Ge=new XMLHttpRequest;Ge.open("GET",se,!0),Ge.responseType="arraybuffer",Ge.onload=()=>{if(Ge.status==200||Ge.status==0&&Ge.response){oe(Ge.response);return}Te()},Ge.onerror=Te,Ge.send(null)});var w=a.print||console.log.bind(console),S=a.printErr||console.warn.bind(console);Object.assign(a,l),l=null,a.arguments&&a.arguments,a.thisProgram&&(c=a.thisProgram),a.quit&&a.quit;var T;a.wasmBinary&&(T=a.wasmBinary),a.noExitRuntime,typeof WebAssembly!="object"&&He("no native wasm support detected");var _,D=!1;function I(se,oe){se||He(oe)}var R=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function M(se,oe,Te){for(var Ge=oe+Te,rt=oe;se[rt]&&!(rt>=Ge);)++rt;if(rt-oe>16&&se.buffer&&R)return R.decode(se.subarray(oe,rt));for(var Tt="";oe<rt;){var pt=se[oe++];if(!(pt&128)){Tt+=String.fromCharCode(pt);continue}var dt=se[oe++]&63;if((pt&224)==192){Tt+=String.fromCharCode((pt&31)<<6|dt);continue}var Z=se[oe++]&63;if((pt&240)==224?pt=(pt&15)<<12|dt<<6|Z:pt=(pt&7)<<18|dt<<12|Z<<6|se[oe++]&63,pt<65536)Tt+=String.fromCharCode(pt);else{var te=pt-65536;Tt+=String.fromCharCode(55296|te>>10,56320|te&1023)}}return Tt}function A(se,oe){return se?M(F,se,oe):""}function L(se,oe,Te,Ge){if(!(Ge>0))return 0;for(var rt=Te,Tt=Te+Ge-1,pt=0;pt<se.length;++pt){var dt=se.charCodeAt(pt);if(dt>=55296&&dt<=57343){var Z=se.charCodeAt(++pt);dt=65536+((dt&1023)<<10)|Z&1023}if(dt<=127){if(Te>=Tt)break;oe[Te++]=dt}else if(dt<=2047){if(Te+1>=Tt)break;oe[Te++]=192|dt>>6,oe[Te++]=128|dt&63}else if(dt<=65535){if(Te+2>=Tt)break;oe[Te++]=224|dt>>12,oe[Te++]=128|dt>>6&63,oe[Te++]=128|dt&63}else{if(Te+3>=Tt)break;oe[Te++]=240|dt>>18,oe[Te++]=128|dt>>12&63,oe[Te++]=128|dt>>6&63,oe[Te++]=128|dt&63}}return oe[Te]=0,Te-rt}function P(se,oe,Te){return L(se,F,oe,Te)}function B(se){for(var oe=0,Te=0;Te<se.length;++Te){var Ge=se.charCodeAt(Te);Ge<=127?oe++:Ge<=2047?oe+=2:Ge>=55296&&Ge<=57343?(oe+=4,++Te):oe+=3}return oe}var U,G,F,$,V,X,Q,re,ye;function me(se){U=se,a.HEAP8=G=new Int8Array(se),a.HEAP16=$=new Int16Array(se),a.HEAP32=X=new Int32Array(se),a.HEAPU8=F=new Uint8Array(se),a.HEAPU16=V=new Uint16Array(se),a.HEAPU32=Q=new Uint32Array(se),a.HEAPF32=re=new Float32Array(se),a.HEAPF64=ye=new Float64Array(se)}a.INITIAL_MEMORY;var Ce,we=[],Ae=[],De=[];function q(){if(a.preRun)for(typeof a.preRun=="function"&&(a.preRun=[a.preRun]);a.preRun.length;)Y(a.preRun.shift());$e(we)}function k(){$e(Ae)}function J(){if(a.postRun)for(typeof a.postRun=="function"&&(a.postRun=[a.postRun]);a.postRun.length;)ue(a.postRun.shift());$e(De)}function Y(se){we.unshift(se)}function ie(se){Ae.unshift(se)}function ue(se){De.unshift(se)}var fe=0,Se=null;function Fe(se){fe++,a.monitorRunDependencies&&a.monitorRunDependencies(fe)}function Ke(se){if(fe--,a.monitorRunDependencies&&a.monitorRunDependencies(fe),fe==0&&Se){var oe=Se;Se=null,oe()}}function He(se){a.onAbort&&a.onAbort(se),se="Aborted("+se+")",S(se),D=!0,se+=". Build with -sASSERTIONS for more info.";var oe=new WebAssembly.RuntimeError(se);throw s(oe),oe}var pe="data:application/octet-stream;base64,";function ge(se){return se.startsWith(pe)}function Ie(se){return se.startsWith("file://")}var ve;ve="openjpegwasm_decode.wasm",ge(ve)||(ve=p(ve));function _e(se){try{if(se==ve&&T)return new Uint8Array(T);if(y)return y(se);throw"both async and sync fetching of the wasm failed"}catch(oe){He(oe)}}function Pe(){if(!T&&(f||u)){if(typeof fetch=="function"&&!Ie(ve))return fetch(ve,{credentials:"same-origin"}).then(function(se){if(!se.ok)throw"failed to load wasm binary file at '"+ve+"'";return se.arrayBuffer()}).catch(function(){return _e(ve)});if(m)return new Promise(function(se,oe){m(ve,function(Te){se(new Uint8Array(Te))},oe)})}return Promise.resolve().then(function(){return _e(ve)})}function ne(){var se={a:Ye};function oe(pt,dt){var Z=pt.exports;a.asm=Z,_=a.asm.E,me(_.buffer),Ce=a.asm.G,ie(a.asm.F),Ke()}Fe();function Te(pt){oe(pt.instance)}function Ge(pt){return Pe().then(function(dt){return WebAssembly.instantiate(dt,se)}).then(function(dt){return dt}).then(pt,function(dt){S("failed to asynchronously prepare wasm: "+dt),He(dt)})}function rt(){return!T&&typeof WebAssembly.instantiateStreaming=="function"&&!ge(ve)&&!Ie(ve)&&!d&&typeof fetch=="function"?fetch(ve,{credentials:"same-origin"}).then(function(pt){var dt=WebAssembly.instantiateStreaming(pt,se);return dt.then(Te,function(Z){return S("wasm streaming compile failed: "+Z),S("falling back to ArrayBuffer instantiation"),Ge(Te)})}):Ge(Te)}if(a.instantiateWasm)try{var Tt=a.instantiateWasm(se,oe);return Tt}catch(pt){S("Module.instantiateWasm callback failed with error: "+pt),s(pt)}return rt().catch(s),{}}function Je(se){this.name="ExitStatus",this.message="Program terminated with exit("+se+")",this.status=se}function $e(se){for(;se.length>0;)se.shift()(a)}function ke(se){this.excPtr=se,this.ptr=se-24,this.set_type=function(oe){Q[this.ptr+4>>2]=oe},this.get_type=function(){return Q[this.ptr+4>>2]},this.set_destructor=function(oe){Q[this.ptr+8>>2]=oe},this.get_destructor=function(){return Q[this.ptr+8>>2]},this.set_refcount=function(oe){X[this.ptr>>2]=oe},this.set_caught=function(oe){oe=oe?1:0,G[this.ptr+12>>0]=oe},this.get_caught=function(){return G[this.ptr+12>>0]!=0},this.set_rethrown=function(oe){oe=oe?1:0,G[this.ptr+13>>0]=oe},this.get_rethrown=function(){return G[this.ptr+13>>0]!=0},this.init=function(oe,Te){this.set_adjusted_ptr(0),this.set_type(oe),this.set_destructor(Te),this.set_refcount(0),this.set_caught(!1),this.set_rethrown(!1)},this.add_ref=function(){var oe=X[this.ptr>>2];X[this.ptr>>2]=oe+1},this.release_ref=function(){var oe=X[this.ptr>>2];return X[this.ptr>>2]=oe-1,oe===1},this.set_adjusted_ptr=function(oe){Q[this.ptr+16>>2]=oe},this.get_adjusted_ptr=function(){return Q[this.ptr+16>>2]},this.get_exception_ptr=function(){var oe=Kt(this.get_type());if(oe)return Q[this.excPtr>>2];var Te=this.get_adjusted_ptr();return Te!==0?Te:this.excPtr}}function Re(se,oe,Te){var Ge=new ke(se);throw Ge.init(oe,Te),se}var ze={};function st(se){for(;se.length;){var oe=se.pop(),Te=se.pop();Te(oe)}}function Qe(se){return this.fromWireType(X[se>>2])}var _t={},Le={},We={},xt=48,Ut=57;function gn(se){if(se===void 0)return"_unknown";se=se.replace(/[^a-zA-Z0-9_]/g,"$");var oe=se.charCodeAt(0);return oe>=xt&&oe<=Ut?"_"+se:se}function tn(se,oe){return se=gn(se),new Function("body","return function "+se+`() {
    "use strict";    return body.apply(this, arguments);
};
`)(oe)}function Ht(se,oe){var Te=tn(oe,function(Ge){this.name=oe,this.message=Ge;var rt=new Error(Ge).stack;rt!==void 0&&(this.stack=this.toString()+`
`+rt.replace(/^Error(:[^\n]*)?\n/,""))});return Te.prototype=Object.create(se.prototype),Te.prototype.constructor=Te,Te.prototype.toString=function(){return this.message===void 0?this.name:this.name+": "+this.message},Te}var dn=void 0;function sr(se){throw new dn(se)}function Qn(se,oe,Te){se.forEach(function(dt){We[dt]=oe});function Ge(dt){var Z=Te(dt);Z.length!==se.length&&sr("Mismatched type converter count");for(var te=0;te<se.length;++te)Qt(se[te],Z[te])}var rt=new Array(oe.length),Tt=[],pt=0;oe.forEach((dt,Z)=>{Le.hasOwnProperty(dt)?rt[Z]=Le[dt]:(Tt.push(dt),_t.hasOwnProperty(dt)||(_t[dt]=[]),_t[dt].push(()=>{rt[Z]=Le[dt],++pt,pt===Tt.length&&Ge(rt)}))}),Tt.length===0&&Ge(rt)}function qe(se){var oe=ze[se];delete ze[se];var Te=oe.rawConstructor,Ge=oe.rawDestructor,rt=oe.fields,Tt=rt.map(pt=>pt.getterReturnType).concat(rt.map(pt=>pt.setterArgumentType));Qn([se],Tt,pt=>{var dt={};return rt.forEach((Z,te)=>{var W=Z.fieldName,K=pt[te],ae=Z.getter,be=Z.getterContext,Ee=pt[te+rt.length],Me=Z.setter,Ne=Z.setterContext;dt[W]={read:Ue=>K.fromWireType(ae(be,Ue)),write:(Ue,Ze)=>{var ht=[];Me(Ne,Ue,Ee.toWireType(ht,Ze)),st(ht)}}}),[{name:oe.name,fromWireType:function(Z){var te={};for(var W in dt)te[W]=dt[W].read(Z);return Ge(Z),te},toWireType:function(Z,te){for(var W in dt)if(!(W in te))throw new TypeError('Missing field:  "'+W+'"');var K=Te();for(W in dt)dt[W].write(K,te[W]);return Z!==null&&Z.push(Ge,K),K},argPackAdvance:8,readValueFromPointer:Qe,destructorFunction:Ge}]})}function Dt(se,oe,Te,Ge,rt){}function Rt(se){switch(se){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+se)}}function Bt(){for(var se=new Array(256),oe=0;oe<256;++oe)se[oe]=String.fromCharCode(oe);On=se}var On=void 0;function $t(se){for(var oe="",Te=se;F[Te];)oe+=On[F[Te++]];return oe}var Xt=void 0;function Lt(se){throw new Xt(se)}function Qt(se,oe,Te={}){if(!("argPackAdvance"in oe))throw new TypeError("registerType registeredInstance requires argPackAdvance");var Ge=oe.name;if(se||Lt('type "'+Ge+'" must have a positive integer typeid pointer'),Le.hasOwnProperty(se)){if(Te.ignoreDuplicateRegistrations)return;Lt("Cannot register type '"+Ge+"' twice")}if(Le[se]=oe,delete We[se],_t.hasOwnProperty(se)){var rt=_t[se];delete _t[se],rt.forEach(Tt=>Tt())}}function yr(se,oe,Te,Ge,rt){var Tt=Rt(Te);oe=$t(oe),Qt(se,{name:oe,fromWireType:function(pt){return!!pt},toWireType:function(pt,dt){return dt?Ge:rt},argPackAdvance:8,readValueFromPointer:function(pt){var dt;if(Te===1)dt=G;else if(Te===2)dt=$;else if(Te===4)dt=X;else throw new TypeError("Unknown boolean type size: "+oe);return this.fromWireType(dt[pt>>Tt])},destructorFunction:null})}function kr(se){if(!(this instanceof pr)||!(se instanceof pr))return!1;for(var oe=this.$$.ptrType.registeredClass,Te=this.$$.ptr,Ge=se.$$.ptrType.registeredClass,rt=se.$$.ptr;oe.baseClass;)Te=oe.upcast(Te),oe=oe.baseClass;for(;Ge.baseClass;)rt=Ge.upcast(rt),Ge=Ge.baseClass;return oe===Ge&&Te===rt}function ni(se){return{count:se.count,deleteScheduled:se.deleteScheduled,preservePointerOnDelete:se.preservePointerOnDelete,ptr:se.ptr,ptrType:se.ptrType,smartPtr:se.smartPtr,smartPtrType:se.smartPtrType}}function Ii(se){function oe(Te){return Te.$$.ptrType.registeredClass.name}Lt(oe(se)+" instance already deleted")}var fi=!1;function Ri(se){}function rn(se){se.smartPtr?se.smartPtrType.rawDestructor(se.smartPtr):se.ptrType.registeredClass.rawDestructor(se.ptr)}function Xn(se){se.count.value-=1;var oe=se.count.value===0;oe&&rn(se)}function vi(se,oe,Te){if(oe===Te)return se;if(Te.baseClass===void 0)return null;var Ge=vi(se,oe,Te.baseClass);return Ge===null?null:Te.downcast(Ge)}var an={};function ri(){return Object.keys(No).length}function ts(){var se=[];for(var oe in No)No.hasOwnProperty(oe)&&se.push(No[oe]);return se}var ii=[];function Ai(){for(;ii.length;){var se=ii.pop();se.$$.deleteScheduled=!1,se.delete()}}var wa=void 0;function Pi(se){wa=se,ii.length&&wa&&wa(Ai)}function Os(){a.getInheritedInstanceCount=ri,a.getLiveInheritedInstances=ts,a.flushPendingDeletes=Ai,a.setDelayFunction=Pi}var No={};function Ni(se,oe){for(oe===void 0&&Lt("ptr should not be undefined");se.baseClass;)oe=se.upcast(oe),se=se.baseClass;return oe}function Lo(se,oe){return oe=Ni(se,oe),No[oe]}function At(se,oe){(!oe.ptrType||!oe.ptr)&&sr("makeClassHandle requires ptr and ptrType");var Te=!!oe.smartPtrType,Ge=!!oe.smartPtr;return Te!==Ge&&sr("Both smartPtrType and smartPtr must be specified"),oe.count={value:1},Xa(Object.create(se,{$$:{value:oe}}))}function Li(se){var oe=this.getPointee(se);if(!oe)return this.destructor(se),null;var Te=Lo(this.registeredClass,oe);if(Te!==void 0){if(Te.$$.count.value===0)return Te.$$.ptr=oe,Te.$$.smartPtr=se,Te.clone();var Ge=Te.clone();return this.destructor(se),Ge}function rt(){return this.isSmartPointer?At(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:oe,smartPtrType:this,smartPtr:se}):At(this.registeredClass.instancePrototype,{ptrType:this,ptr:se})}var Tt=this.registeredClass.getActualType(oe),pt=an[Tt];if(!pt)return rt.call(this);var dt;this.isConst?dt=pt.constPointerType:dt=pt.pointerType;var Z=vi(oe,this.registeredClass,dt.registeredClass);return Z===null?rt.call(this):this.isSmartPointer?At(dt.registeredClass.instancePrototype,{ptrType:dt,ptr:Z,smartPtrType:this,smartPtr:se}):At(dt.registeredClass.instancePrototype,{ptrType:dt,ptr:Z})}function Xa(se){return typeof FinalizationRegistry>"u"?(Xa=oe=>oe,se):(fi=new FinalizationRegistry(oe=>{Xn(oe.$$)}),Xa=oe=>{var Te=oe.$$,Ge=!!Te.smartPtr;if(Ge){var rt={$$:Te};fi.register(oe,rt,oe)}return oe},Ri=oe=>fi.unregister(oe),Xa(se))}function di(){if(this.$$.ptr||Ii(this),this.$$.preservePointerOnDelete)return this.$$.count.value+=1,this;var se=Xa(Object.create(Object.getPrototypeOf(this),{$$:{value:ni(this.$$)}}));return se.$$.count.value+=1,se.$$.deleteScheduled=!1,se}function Ms(){this.$$.ptr||Ii(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&Lt("Object already scheduled for deletion"),Ri(this),Xn(this.$$),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)}function ko(){return!this.$$.ptr}function go(){return this.$$.ptr||Ii(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&Lt("Object already scheduled for deletion"),ii.push(this),ii.length===1&&wa&&wa(Ai),this.$$.deleteScheduled=!0,this}function $l(){pr.prototype.isAliasOf=kr,pr.prototype.clone=di,pr.prototype.delete=Ms,pr.prototype.isDeleted=ko,pr.prototype.deleteLater=go}function pr(){}function ka(se,oe,Te){if(se[oe].overloadTable===void 0){var Ge=se[oe];se[oe]=function(){return se[oe].overloadTable.hasOwnProperty(arguments.length)||Lt("Function '"+Te+"' called with an invalid number of arguments ("+arguments.length+") - expects one of ("+se[oe].overloadTable+")!"),se[oe].overloadTable[arguments.length].apply(this,arguments)},se[oe].overloadTable=[],se[oe].overloadTable[Ge.argCount]=Ge}}function il(se,oe,Te){a.hasOwnProperty(se)?(Lt("Cannot register public name '"+se+"' twice"),ka(a,se,se),a.hasOwnProperty(Te)&&Lt("Cannot register multiple overloads of a function with the same number of arguments ("+Te+")!"),a[se].overloadTable[Te]=oe):a[se]=oe}function Vo(se,oe,Te,Ge,rt,Tt,pt,dt){this.name=se,this.constructor=oe,this.instancePrototype=Te,this.rawDestructor=Ge,this.baseClass=rt,this.getActualType=Tt,this.upcast=pt,this.downcast=dt,this.pureVirtualFunctions=[]}function al(se,oe,Te){for(;oe!==Te;)oe.upcast||Lt("Expected null or instance of "+Te.name+", got an instance of "+oe.name),se=oe.upcast(se),oe=oe.baseClass;return se}function Va(se,oe){if(oe===null)return this.isReference&&Lt("null is not a valid "+this.name),0;oe.$$||Lt('Cannot pass "'+ss(oe)+'" as a '+this.name),oe.$$.ptr||Lt("Cannot pass deleted object as a pointer of type "+this.name);var Te=oe.$$.ptrType.registeredClass,Ge=al(oe.$$.ptr,Te,this.registeredClass);return Ge}function Ou(se,oe){var Te;if(oe===null)return this.isReference&&Lt("null is not a valid "+this.name),this.isSmartPointer?(Te=this.rawConstructor(),se!==null&&se.push(this.rawDestructor,Te),Te):0;oe.$$||Lt('Cannot pass "'+ss(oe)+'" as a '+this.name),oe.$$.ptr||Lt("Cannot pass deleted object as a pointer of type "+this.name),!this.isConst&&oe.$$.ptrType.isConst&&Lt("Cannot convert argument of type "+(oe.$$.smartPtrType?oe.$$.smartPtrType.name:oe.$$.ptrType.name)+" to parameter type "+this.name);var Ge=oe.$$.ptrType.registeredClass;if(Te=al(oe.$$.ptr,Ge,this.registeredClass),this.isSmartPointer)switch(oe.$$.smartPtr===void 0&&Lt("Passing raw pointer to smart pointer is illegal"),this.sharingPolicy){case 0:oe.$$.smartPtrType===this?Te=oe.$$.smartPtr:Lt("Cannot convert argument of type "+(oe.$$.smartPtrType?oe.$$.smartPtrType.name:oe.$$.ptrType.name)+" to parameter type "+this.name);break;case 1:Te=oe.$$.smartPtr;break;case 2:if(oe.$$.smartPtrType===this)Te=oe.$$.smartPtr;else{var rt=oe.clone();Te=this.rawShare(Te,yi.toHandle(function(){rt.delete()})),se!==null&&se.push(this.rawDestructor,Te)}break;default:Lt("Unsupporting sharing policy")}return Te}function la(se,oe){if(oe===null)return this.isReference&&Lt("null is not a valid "+this.name),0;oe.$$||Lt('Cannot pass "'+ss(oe)+'" as a '+this.name),oe.$$.ptr||Lt("Cannot pass deleted object as a pointer of type "+this.name),oe.$$.ptrType.isConst&&Lt("Cannot convert argument of type "+oe.$$.ptrType.name+" to parameter type "+this.name);var Te=oe.$$.ptrType.registeredClass,Ge=al(oe.$$.ptr,Te,this.registeredClass);return Ge}function Gl(se){return this.rawGetPointee&&(se=this.rawGetPointee(se)),se}function Sc(se){this.rawDestructor&&this.rawDestructor(se)}function Ca(se){se!==null&&se.delete()}function ki(){Sa.prototype.getPointee=Gl,Sa.prototype.destructor=Sc,Sa.prototype.argPackAdvance=8,Sa.prototype.readValueFromPointer=Qe,Sa.prototype.deleteObject=Ca,Sa.prototype.fromWireType=Li}function Sa(se,oe,Te,Ge,rt,Tt,pt,dt,Z,te,W){this.name=se,this.registeredClass=oe,this.isReference=Te,this.isConst=Ge,this.isSmartPointer=rt,this.pointeeType=Tt,this.sharingPolicy=pt,this.rawGetPointee=dt,this.rawConstructor=Z,this.rawShare=te,this.rawDestructor=W,!rt&&oe.baseClass===void 0?Ge?(this.toWireType=Va,this.destructorFunction=null):(this.toWireType=la,this.destructorFunction=null):this.toWireType=Ou}function Vi(se,oe,Te){a.hasOwnProperty(se)||sr("Replacing nonexistant public symbol"),a[se].overloadTable!==void 0&&Te!==void 0||(a[se]=oe,a[se].argCount=Te)}function Fo(se,oe,Te){var Ge=a["dynCall_"+se];return Te&&Te.length?Ge.apply(null,[oe].concat(Te)):Ge.call(null,oe)}var ns=[];function rs(se){var oe=ns[se];return oe||(se>=ns.length&&(ns.length=se+1),ns[se]=oe=Ce.get(se)),oe}function Kr(se,oe,Te){if(se.includes("j"))return Fo(se,oe,Te);var Ge=rs(oe).apply(null,Te);return Ge}function ol(se,oe){var Te=[];return function(){return Te.length=0,Object.assign(Te,arguments),Kr(se,oe,Te)}}function Ta(se,oe){se=$t(se);function Te(){return se.includes("j")?ol(se,oe):rs(oe)}var Ge=Te();return typeof Ge!="function"&&Lt("unknown function pointer with signature "+se+": "+oe),Ge}var Fi=void 0;function is(se){var oe=mt(se),Te=$t(oe);return gt(oe),Te}function mo(se,oe){var Te=[],Ge={};function rt(Tt){if(!Ge[Tt]&&!Le[Tt]){if(We[Tt]){We[Tt].forEach(rt);return}Te.push(Tt),Ge[Tt]=!0}}throw oe.forEach(rt),new Fi(se+": "+Te.map(is).join([", "]))}function qi(se,oe,Te,Ge,rt,Tt,pt,dt,Z,te,W,K,ae){W=$t(W),Tt=Ta(rt,Tt),dt&&(dt=Ta(pt,dt)),te&&(te=Ta(Z,te)),ae=Ta(K,ae);var be=gn(W);il(be,function(){mo("Cannot construct "+W+" due to unbound types",[Ge])}),Qn([se,oe,Te],Ge?[Ge]:[],function(Ee){Ee=Ee[0];var Me,Ne;Ge?(Me=Ee.registeredClass,Ne=Me.instancePrototype):Ne=pr.prototype;var Ue=tn(be,function(){if(Object.getPrototypeOf(this)!==Ze)throw new Xt("Use 'new' to construct "+W);if(ht.constructor_body===void 0)throw new Xt(W+" has no accessible constructor");var hn=ht.constructor_body[arguments.length];if(hn===void 0)throw new Xt("Tried to invoke ctor of "+W+" with invalid number of parameters ("+arguments.length+") - expected ("+Object.keys(ht.constructor_body).toString()+") parameters instead!");return hn.apply(this,arguments)}),Ze=Object.create(Ne,{constructor:{value:Ue}});Ue.prototype=Ze;var ht=new Vo(W,Ue,Ze,ae,Me,Tt,dt,te),Pt=new Sa(W,ht,!0,!1,!1),Wt=new Sa(W+"*",ht,!1,!1,!1),Gt=new Sa(W+" const*",ht,!1,!0,!1);return an[se]={pointerType:Wt,constPointerType:Gt},Vi(be,Ue),[Pt,Wt,Gt]})}function Fa(se,oe){for(var Te=[],Ge=0;Ge<se;Ge++)Te.push(Q[oe+Ge*4>>2]);return Te}function Uo(se,oe){if(!(se instanceof Function))throw new TypeError("new_ called with constructor type "+typeof se+" which is not a function");var Te=tn(se.name||"unknownFunctionName",function(){});Te.prototype=se.prototype;var Ge=new Te,rt=se.apply(Ge,oe);return rt instanceof Object?rt:Ge}function jl(se,oe,Te,Ge,rt){var Tt=oe.length;Tt<2&&Lt("argTypes array size mismatch! Must at least get return value and 'this' types!");for(var pt=oe[1]!==null&&Te!==null,dt=!1,Z=1;Z<oe.length;++Z)if(oe[Z]!==null&&oe[Z].destructorFunction===void 0){dt=!0;break}for(var te=oe[0].name!=="void",W="",K="",Z=0;Z<Tt-2;++Z)W+=(Z!==0?", ":"")+"arg"+Z,K+=(Z!==0?", ":"")+"arg"+Z+"Wired";var ae="return function "+gn(se)+"("+W+`) {
if (arguments.length !== `+(Tt-2)+`) {
throwBindingError('function `+se+" called with ' + arguments.length + ' arguments, expected "+(Tt-2)+` args!');
}
`;dt&&(ae+=`var destructors = [];
`);var be=dt?"destructors":"null",Ee=["throwBindingError","invoker","fn","runDestructors","retType","classParam"],Me=[Lt,Ge,rt,st,oe[0],oe[1]];pt&&(ae+="var thisWired = classParam.toWireType("+be+`, this);
`);for(var Z=0;Z<Tt-2;++Z)ae+="var arg"+Z+"Wired = argType"+Z+".toWireType("+be+", arg"+Z+"); // "+oe[Z+2].name+`
`,Ee.push("argType"+Z),Me.push(oe[Z+2]);if(pt&&(K="thisWired"+(K.length>0?", ":"")+K),ae+=(te?"var rv = ":"")+"invoker(fn"+(K.length>0?", ":"")+K+`);
`,dt)ae+=`runDestructors(destructors);
`;else for(var Z=pt?1:2;Z<oe.length;++Z){var Ne=Z===1?"thisWired":"arg"+(Z-2)+"Wired";oe[Z].destructorFunction!==null&&(ae+=Ne+"_dtor("+Ne+"); // "+oe[Z].name+`
`,Ee.push(Ne+"_dtor"),Me.push(oe[Z].destructorFunction))}te&&(ae+=`var ret = retType.fromWireType(rv);
return ret;
`),ae+=`}
`,Ee.push(ae);var Ue=Uo(Function,Ee).apply(null,Me);return Ue}function as(se,oe,Te,Ge,rt,Tt){I(oe>0);var pt=Fa(oe,Te);rt=Ta(Ge,rt),Qn([],[se],function(dt){dt=dt[0];var Z="constructor "+dt.name;if(dt.registeredClass.constructor_body===void 0&&(dt.registeredClass.constructor_body=[]),dt.registeredClass.constructor_body[oe-1]!==void 0)throw new Xt("Cannot register multiple constructors with identical number of parameters ("+(oe-1)+") for class '"+dt.name+"'! Overload resolution is currently only performed using the parameter count, not actual type info!");return dt.registeredClass.constructor_body[oe-1]=()=>{mo("Cannot construct "+dt.name+" due to unbound types",pt)},Qn([],pt,function(te){return te.splice(1,0,null),dt.registeredClass.constructor_body[oe-1]=jl(Z,te,null,rt,Tt),[]}),[]})}function Sr(se,oe,Te,Ge,rt,Tt,pt,dt){var Z=Fa(Te,Ge);oe=$t(oe),Tt=Ta(rt,Tt),Qn([],[se],function(te){te=te[0];var W=te.name+"."+oe;oe.startsWith("@@")&&(oe=Symbol[oe.substring(2)]),dt&&te.registeredClass.pureVirtualFunctions.push(oe);function K(){mo("Cannot call "+W+" due to unbound types",Z)}var ae=te.registeredClass.instancePrototype,be=ae[oe];return be===void 0||be.overloadTable===void 0&&be.className!==te.name&&be.argCount===Te-2?(K.argCount=Te-2,K.className=te.name,ae[oe]=K):(ka(ae,oe,W),ae[oe].overloadTable[Te-2]=K),Qn([],Z,function(Ee){var Me=jl(W,Ee,te,Tt,pt);return ae[oe].overloadTable===void 0?(Me.argCount=Te-2,ae[oe]=Me):ae[oe].overloadTable[Te-2]=Me,[]}),[]})}var Ya=[],Tr=[{},{value:void 0},{value:null},{value:!0},{value:!1}];function ai(se){se>4&&--Tr[se].refcount===0&&(Tr[se]=void 0,Ya.push(se))}function os(){for(var se=0,oe=5;oe<Tr.length;++oe)Tr[oe]!==void 0&&++se;return se}function oi(){for(var se=5;se<Tr.length;++se)if(Tr[se]!==void 0)return Tr[se];return null}function zl(){a.count_emval_handles=os,a.get_first_emval=oi}var yi={toValue:se=>(se||Lt("Cannot use deleted val. handle = "+se),Tr[se].value),toHandle:se=>{switch(se){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:{var oe=Ya.length?Ya.pop():Tr.length;return Tr[oe]={refcount:1,value:se},oe}}}};function Ja(se,oe){oe=$t(oe),Qt(se,{name:oe,fromWireType:function(Te){var Ge=yi.toValue(Te);return ai(Te),Ge},toWireType:function(Te,Ge){return yi.toHandle(Ge)},argPackAdvance:8,readValueFromPointer:Qe,destructorFunction:null})}function ss(se){if(se===null)return"null";var oe=typeof se;return oe==="object"||oe==="array"||oe==="function"?se.toString():""+se}function vo(se,oe){switch(oe){case 2:return function(Te){return this.fromWireType(re[Te>>2])};case 3:return function(Te){return this.fromWireType(ye[Te>>3])};default:throw new TypeError("Unknown float type: "+se)}}function ca(se,oe,Te){var Ge=Rt(Te);oe=$t(oe),Qt(se,{name:oe,fromWireType:function(rt){return rt},toWireType:function(rt,Tt){return Tt},argPackAdvance:8,readValueFromPointer:vo(oe,Ge),destructorFunction:null})}function xi(se,oe,Te){switch(oe){case 0:return Te?function(rt){return G[rt]}:function(rt){return F[rt]};case 1:return Te?function(rt){return $[rt>>1]}:function(rt){return V[rt>>1]};case 2:return Te?function(rt){return X[rt>>2]}:function(rt){return Q[rt>>2]};default:throw new TypeError("Unknown integer type: "+se)}}function Bo(se,oe,Te,Ge,rt){oe=$t(oe);var Tt=Rt(Te),pt=K=>K;if(Ge===0){var dt=32-8*Te;pt=K=>K<<dt>>>dt}var Z=oe.includes("unsigned"),te=(K,ae)=>{},W;Z?W=function(K,ae){return te(ae,this.name),ae>>>0}:W=function(K,ae){return te(ae,this.name),ae},Qt(se,{name:oe,fromWireType:pt,toWireType:W,argPackAdvance:8,readValueFromPointer:xi(oe,Tt,Ge!==0),destructorFunction:null})}function sl(se,oe,Te){var Ge=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],rt=Ge[oe];function Tt(pt){pt=pt>>2;var dt=Q,Z=dt[pt],te=dt[pt+1];return new rt(U,te,Z)}Te=$t(Te),Qt(se,{name:Te,fromWireType:Tt,argPackAdvance:8,readValueFromPointer:Tt},{ignoreDuplicateRegistrations:!0})}function ls(se,oe){oe=$t(oe);var Te=oe==="std::string";Qt(se,{name:oe,fromWireType:function(Ge){var rt=Q[Ge>>2],Tt=Ge+4,pt;if(Te)for(var dt=Tt,Z=0;Z<=rt;++Z){var te=Tt+Z;if(Z==rt||F[te]==0){var W=te-dt,K=A(dt,W);pt===void 0?pt=K:(pt+="\0",pt+=K),dt=te+1}}else{for(var ae=new Array(rt),Z=0;Z<rt;++Z)ae[Z]=String.fromCharCode(F[Tt+Z]);pt=ae.join("")}return gt(Ge),pt},toWireType:function(Ge,rt){rt instanceof ArrayBuffer&&(rt=new Uint8Array(rt));var Tt,pt=typeof rt=="string";pt||rt instanceof Uint8Array||rt instanceof Uint8ClampedArray||rt instanceof Int8Array||Lt("Cannot pass non-string to std::string"),Te&&pt?Tt=B(rt):Tt=rt.length;var dt=at(4+Tt+1),Z=dt+4;if(Q[dt>>2]=Tt,Te&&pt)P(rt,Z,Tt+1);else if(pt)for(var te=0;te<Tt;++te){var W=rt.charCodeAt(te);W>255&&(gt(Z),Lt("String has UTF-16 code units that do not fit in 8 bits")),F[Z+te]=W}else for(var te=0;te<Tt;++te)F[Z+te]=rt[te];return Ge!==null&&Ge.push(gt,dt),dt},argPackAdvance:8,readValueFromPointer:Qe,destructorFunction:function(Ge){gt(Ge)}})}var Is=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0;function ll(se,oe){for(var Te=se,Ge=Te>>1,rt=Ge+oe/2;!(Ge>=rt)&&V[Ge];)++Ge;if(Te=Ge<<1,Te-se>32&&Is)return Is.decode(F.subarray(se,Te));for(var Tt="",pt=0;!(pt>=oe/2);++pt){var dt=$[se+pt*2>>1];if(dt==0)break;Tt+=String.fromCharCode(dt)}return Tt}function Rs(se,oe,Te){if(Te===void 0&&(Te=2147483647),Te<2)return 0;Te-=2;for(var Ge=oe,rt=Te<se.length*2?Te/2:se.length,Tt=0;Tt<rt;++Tt){var pt=se.charCodeAt(Tt);$[oe>>1]=pt,oe+=2}return $[oe>>1]=0,oe-Ge}function As(se){return se.length*2}function cl(se,oe){for(var Te=0,Ge="";!(Te>=oe/4);){var rt=X[se+Te*4>>2];if(rt==0)break;if(++Te,rt>=65536){var Tt=rt-65536;Ge+=String.fromCharCode(55296|Tt>>10,56320|Tt&1023)}else Ge+=String.fromCharCode(rt)}return Ge}function Tc(se,oe,Te){if(Te===void 0&&(Te=2147483647),Te<4)return 0;for(var Ge=oe,rt=Ge+Te-4,Tt=0;Tt<se.length;++Tt){var pt=se.charCodeAt(Tt);if(pt>=55296&&pt<=57343){var dt=se.charCodeAt(++Tt);pt=65536+((pt&1023)<<10)|dt&1023}if(X[oe>>2]=pt,oe+=4,oe+4>rt)break}return X[oe>>2]=0,oe-Ge}function Mu(se){for(var oe=0,Te=0;Te<se.length;++Te){var Ge=se.charCodeAt(Te);Ge>=55296&&Ge<=57343&&++Te,oe+=4}return oe}function Iu(se,oe,Te){Te=$t(Te);var Ge,rt,Tt,pt,dt;oe===2?(Ge=ll,rt=Rs,pt=As,Tt=()=>V,dt=1):oe===4&&(Ge=cl,rt=Tc,pt=Mu,Tt=()=>Q,dt=2),Qt(se,{name:Te,fromWireType:function(Z){for(var te=Q[Z>>2],W=Tt(),K,ae=Z+4,be=0;be<=te;++be){var Ee=Z+4+be*oe;if(be==te||W[Ee>>dt]==0){var Me=Ee-ae,Ne=Ge(ae,Me);K===void 0?K=Ne:(K+="\0",K+=Ne),ae=Ee+oe}}return gt(Z),K},toWireType:function(Z,te){typeof te!="string"&&Lt("Cannot pass non-string to C++ string type "+Te);var W=pt(te),K=at(4+W+oe);return Q[K>>2]=W>>dt,rt(te,K+4,W+oe),Z!==null&&Z.push(gt,K),K},argPackAdvance:8,readValueFromPointer:Qe,destructorFunction:function(Z){gt(Z)}})}function Ru(se,oe,Te,Ge,rt,Tt){ze[se]={name:$t(oe),rawConstructor:Ta(Te,Ge),rawDestructor:Ta(rt,Tt),fields:[]}}function Wl(se,oe,Te,Ge,rt,Tt,pt,dt,Z,te){ze[se].fields.push({fieldName:$t(oe),getterReturnType:Te,getter:Ta(Ge,rt),getterContext:Tt,setterArgumentType:pt,setter:Ta(dt,Z),setterContext:te})}function Ec(se,oe){oe=$t(oe),Qt(se,{isVoid:!0,name:oe,argPackAdvance:0,fromWireType:function(){},toWireType:function(Te,Ge){}})}var Au={};function _c(se){var oe=Au[se];return oe===void 0?$t(se):oe}function Dc(){return typeof globalThis=="object"?globalThis:(function(){return Function})()("return this")()}function Pu(se){return se===0?yi.toHandle(Dc()):(se=_c(se),yi.toHandle(Dc()[se]))}function ul(se){se>4&&(Tr[se].refcount+=1)}function Oc(se,oe){var Te=Le[se];return Te===void 0&&Lt(oe+" has unknown type "+is(se)),Te}function Mc(se){for(var oe="",Te=0;Te<se;++Te)oe+=(Te!==0?", ":"")+"arg"+Te;for(var Ge=()=>Q,rt="return function emval_allocator_"+se+`(constructor, argTypes, args) {
  var HEAPU32 = getMemory();
`,Te=0;Te<se;++Te)rt+="var argType"+Te+" = requireRegisteredType(HEAPU32[((argTypes)>>2)], 'parameter "+Te+`');
var arg`+Te+" = argType"+Te+`.readValueFromPointer(args);
args += argType`+Te+`['argPackAdvance'];
argTypes += 4;
`;return rt+="var obj = new constructor("+oe+`);
return valueToHandle(obj);
}
`,new Function("requireRegisteredType","Module","valueToHandle","getMemory",rt)(Oc,a,yi.toHandle,Ge)}var Hl={};function Nu(se,oe,Te,Ge){se=yi.toValue(se);var rt=Hl[oe];return rt||(rt=Mc(oe),Hl[oe]=rt),rt(se,Te,Ge)}function fl(se,oe){se=Oc(se,"_emval_take_value");var Te=se.readValueFromPointer(oe);return yi.toHandle(Te)}function Lu(){He("")}function Ic(){return 2147483648}function ku(){return Ic()}function Rc(se,oe,Te){F.copyWithin(se,oe,oe+Te)}function Vu(se){try{return _.grow(se-U.byteLength+65535>>>16),me(_.buffer),1}catch{}}function Fu(se){var oe=F.length;se=se>>>0;var Te=Ic();if(se>Te)return!1;let Ge=(Z,te)=>Z+(te-Z%te)%te;for(var rt=1;rt<=4;rt*=2){var Tt=oe*(1+.2/rt);Tt=Math.min(Tt,se+100663296);var pt=Math.min(Te,Ge(Math.max(se,Tt),65536)),dt=Vu(pt);if(dt)return!0}return!1}var Kl={};function ql(){return c||"./this.program"}function $o(){if(!$o.strings){var se=(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",oe={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:se,_:ql()};for(var Te in Kl)Kl[Te]===void 0?delete oe[Te]:oe[Te]=Kl[Te];var Ge=[];for(var Te in oe)Ge.push(Te+"="+oe[Te]);$o.strings=Ge}return $o.strings}function cs(se,oe,Te){for(var Ge=0;Ge<se.length;++Ge)G[oe++>>0]=se.charCodeAt(Ge);G[oe>>0]=0}function Za(se,oe){var Te=0;return $o().forEach(function(Ge,rt){var Tt=oe+Te;Q[se+rt*4>>2]=Tt,cs(Ge,Tt),Te+=Ge.length+1}),0}function Ac(se,oe){var Te=$o();Q[se>>2]=Te.length;var Ge=0;return Te.forEach(function(rt){Ge+=rt.length+1}),Q[oe>>2]=Ge,0}function Pc(se){return 52}function Ps(se,oe,Te,Ge,rt){return 70}var us=[null,[],[]];function dl(se,oe){var Te=us[se];oe===0||oe===10?((se===1?w:S)(M(Te,0)),Te.length=0):Te.push(oe)}function Xl(se,oe,Te,Ge){for(var rt=0,Tt=0;Tt<Te;Tt++){var pt=Q[oe>>2],dt=Q[oe+4>>2];oe+=8;for(var Z=0;Z<dt;Z++)dl(se,F[pt+Z]);rt+=dt}return Q[Ge>>2]=rt,0}function de(se){var oe=a["_"+se];return oe}function he(se,oe){G.set(se,oe)}function Oe(se,oe,Te,Ge,rt){var Tt={string:Ee=>{var Me=0;if(Ee!=null&&Ee!==0){var Ne=(Ee.length<<2)+1;Me=kt(Ne),P(Ee,Me,Ne)}return Me},array:Ee=>{var Me=kt(Ee.length);return he(Ee,Me),Me}};function pt(Ee){return oe==="string"?A(Ee):oe==="boolean"?!!Ee:Ee}var dt=de(se),Z=[],te=0;if(Ge)for(var W=0;W<Ge.length;W++){var K=Tt[Te[W]];K?(te===0&&(te=lt()),Z[W]=K(Ge[W])):Z[W]=Ge[W]}var ae=dt.apply(null,Z);function be(Ee){return te!==0&&bt(te),pt(Ee)}return ae=be(ae),ae}dn=a.InternalError=Ht(Error,"InternalError"),Bt(),Xt=a.BindingError=Ht(Error,"BindingError"),$l(),Os(),ki(),Fi=a.UnboundTypeError=Ht(Error,"UnboundTypeError"),zl();var Ye={D:Re,e:qe,t:Dt,B:yr,r:qi,q:as,b:Sr,A:Ja,l:ca,d:Bo,a:sl,k:ls,f:Iu,g:Ru,c:Wl,C:Ec,h:ai,o:Pu,m:ul,n:Nu,p:fl,i:Lu,v:ku,z:Rc,u:Fu,w:Za,x:Ac,y:Pc,s:Ps,j:Xl};ne(),a.___wasm_call_ctors=function(){return(a.___wasm_call_ctors=a.asm.F).apply(null,arguments)};var at=a._malloc=function(){return(at=a._malloc=a.asm.H).apply(null,arguments)},gt=a._free=function(){return(gt=a._free=a.asm.I).apply(null,arguments)},mt=a.___getTypeName=function(){return(mt=a.___getTypeName=a.asm.J).apply(null,arguments)};a.__embind_initialize_bindings=function(){return(a.__embind_initialize_bindings=a.asm.K).apply(null,arguments)};var lt=a.stackSave=function(){return(lt=a.stackSave=a.asm.L).apply(null,arguments)},bt=a.stackRestore=function(){return(bt=a.stackRestore=a.asm.M).apply(null,arguments)},kt=a.stackAlloc=function(){return(kt=a.stackAlloc=a.asm.N).apply(null,arguments)},Kt=a.___cxa_is_pointer_type=function(){return(Kt=a.___cxa_is_pointer_type=a.asm.O).apply(null,arguments)};a.dynCall_iji=function(){return(a.dynCall_iji=a.asm.P).apply(null,arguments)},a.dynCall_jji=function(){return(a.dynCall_jji=a.asm.Q).apply(null,arguments)},a.dynCall_iiji=function(){return(a.dynCall_iiji=a.asm.R).apply(null,arguments)},a.dynCall_jiji=function(){return(a.dynCall_jiji=a.asm.S).apply(null,arguments)},a.ccall=Oe;var en;Se=function se(){en||un(),en||(Se=se)};function un(se){if(fe>0||(q(),fe>0))return;function oe(){en||(en=!0,a.calledRun=!0,!D&&(k(),o(a),a.onRuntimeInitialized&&a.onRuntimeInitialized(),J()))}a.setStatus?(a.setStatus("Running..."),setTimeout(function(){setTimeout(function(){a.setStatus("")},1),oe()},1)):oe()}if(a.preInit)for(typeof a.preInit=="function"&&(a.preInit=[a.preInit]);a.preInit.length>0;)a.preInit.pop()();return un(),i.ready})})();t.exports=n})(Y8)),Y8.exports}var P$e=A$e();const N$e=tl(P$e),L$e=new URL("/assets/openjpegwasm_decode-C4nnCcr6.wasm",import.meta.url),Tv={codec:void 0,decoder:void 0,decodeConfig:{}};function k$e(t){if(Tv.decodeConfig=t,Tv.codec)return Promise.resolve();const e=N$e({locateFile:n=>n.endsWith(".wasm")?L$e.toString():n});return new Promise((n,r)=>{e.then(i=>{Tv.codec=i,Tv.decoder=new i.J2KDecoder,n()},r)})}async function JF(t,e){await k$e();const n=Tv.decoder,r=n.getEncodedBuffer(t.length);r.set(t),n.decode();const i=n.getFrameInfo(),a=n.getDecodedBuffer();new Uint8Array(a.length).set(a);const s=`x: ${n.getImageOffset().x}, y: ${n.getImageOffset().y}`,l=n.getNumDecompositions(),c=n.getNumLayers(),f=["unknown","LRCP","RLCP","RPCL","PCRL","CPRL"][n.getProgressionOrder()+1],u=n.getIsReversible(),d=`${n.getBlockDimensions().width} x ${n.getBlockDimensions().height}`,h=`${n.getTileSize().width} x ${n.getTileSize().height}`,p=`${n.getTileOffset().x}, ${n.getTileOffset().y}`,g=n.getColorSpace(),m=`${a.length.toLocaleString()} bytes`,y=`${(a.length/r.length).toFixed(2)}:1`,v={columns:i.width,rows:i.height,bitsPerPixel:i.bitsPerSample,signed:i.isSigned,bytesPerPixel:e.bytesPerPixel,componentsPerPixel:i.componentCount},x=V$e(i,a),w={imageOffset:s,numDecompositions:l,numLayers:c,progessionOrder:f,reversible:u,blockDimensions:d,tileSize:h,tileOffset:p,colorTransform:g,decodedSize:m,compressionRatio:y};return{...e,pixelData:x,imageInfo:v,encodeOptions:w,...w,...v}}function V$e(t,e){return t.bitsPerSample>8?t.isSigned?new Int16Array(e.buffer,e.byteOffset,e.byteLength/2):new Uint16Array(e.buffer,e.byteOffset,e.byteLength/2):t.isSigned?new Int8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}var J8={exports:{}},ZF;function F$e(){return ZF||(ZF=1,(function(t,e){var n=(()=>{var r=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename<"u"&&(r=r||__filename),(function(a){a=a||{};var a=typeof a<"u"?a:{},o,s;a.ready=new Promise(function(Z,te){o=Z,s=te});var l=Object.assign({},a),c=typeof window=="object",f=typeof importScripts=="function",u=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",d="";function h(Z){return a.locateFile?a.locateFile(Z,d):d+Z}var p,g,m;if(u){var y=Nf,v=Nf;f?d=v.dirname(d)+"/":d=__dirname+"/",p=(Z,te)=>(Z=ge(Z)?new URL(Z):v.normalize(Z),y.readFileSync(Z,te?void 0:"utf8")),m=Z=>{var te=p(Z,!0);return te.buffer||(te=new Uint8Array(te)),te},g=(Z,te,W)=>{Z=ge(Z)?new URL(Z):v.normalize(Z),y.readFile(Z,function(K,ae){K?W(K):te(ae.buffer)})},process.argv.length>1&&process.argv[1].replace(/\\/g,"/"),process.argv.slice(2),process.on("uncaughtException",function(Z){if(!(Z instanceof ne))throw Z}),process.on("unhandledRejection",function(Z){throw Z}),a.inspect=function(){return"[Emscripten Module object]"}}else(c||f)&&(f?d=self.location.href:typeof document<"u"&&document.currentScript&&(d=document.currentScript.src),r&&(d=r),d.indexOf("blob:")!==0?d=d.substr(0,d.replace(/[?#].*/,"").lastIndexOf("/")+1):d="",p=Z=>{var te=new XMLHttpRequest;return te.open("GET",Z,!1),te.send(null),te.responseText},f&&(m=Z=>{var te=new XMLHttpRequest;return te.open("GET",Z,!1),te.responseType="arraybuffer",te.send(null),new Uint8Array(te.response)}),g=(Z,te,W)=>{var K=new XMLHttpRequest;K.open("GET",Z,!0),K.responseType="arraybuffer",K.onload=()=>{if(K.status==200||K.status==0&&K.response){te(K.response);return}W()},K.onerror=W,K.send(null)});var x=a.print||console.log.bind(console),w=a.printErr||console.warn.bind(console);Object.assign(a,l),l=null,a.arguments&&a.arguments,a.thisProgram&&a.thisProgram,a.quit&&a.quit;var S;a.wasmBinary&&(S=a.wasmBinary),a.noExitRuntime,typeof WebAssembly!="object"&&Ke("no native wasm support detected");var T,_=!1;function D(Z,te){Z||Ke(te)}var I=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function R(Z,te,W){for(var K=te+W,ae=te;Z[ae]&&!(ae>=K);)++ae;if(ae-te>16&&Z.buffer&&I)return I.decode(Z.subarray(te,ae));for(var be="";te<ae;){var Ee=Z[te++];if(!(Ee&128)){be+=String.fromCharCode(Ee);continue}var Me=Z[te++]&63;if((Ee&224)==192){be+=String.fromCharCode((Ee&31)<<6|Me);continue}var Ne=Z[te++]&63;if((Ee&240)==224?Ee=(Ee&15)<<12|Me<<6|Ne:Ee=(Ee&7)<<18|Me<<12|Ne<<6|Z[te++]&63,Ee<65536)be+=String.fromCharCode(Ee);else{var Ue=Ee-65536;be+=String.fromCharCode(55296|Ue>>10,56320|Ue&1023)}}return be}function M(Z,te){return Z?R(G,Z,te):""}function A(Z,te,W,K){if(!(K>0))return 0;for(var ae=W,be=W+K-1,Ee=0;Ee<Z.length;++Ee){var Me=Z.charCodeAt(Ee);if(Me>=55296&&Me<=57343){var Ne=Z.charCodeAt(++Ee);Me=65536+((Me&1023)<<10)|Ne&1023}if(Me<=127){if(W>=be)break;te[W++]=Me}else if(Me<=2047){if(W+1>=be)break;te[W++]=192|Me>>6,te[W++]=128|Me&63}else if(Me<=65535){if(W+2>=be)break;te[W++]=224|Me>>12,te[W++]=128|Me>>6&63,te[W++]=128|Me&63}else{if(W+3>=be)break;te[W++]=240|Me>>18,te[W++]=128|Me>>12&63,te[W++]=128|Me>>6&63,te[W++]=128|Me&63}}return te[W]=0,W-ae}function L(Z,te,W){return A(Z,G,te,W)}function P(Z){for(var te=0,W=0;W<Z.length;++W){var K=Z.charCodeAt(W);K<=127?te++:K<=2047?te+=2:K>=55296&&K<=57343?(te+=4,++W):te+=3}return te}var B,U,G,F,$,V,X,Q,re;function ye(Z){B=Z,a.HEAP8=U=new Int8Array(Z),a.HEAP16=F=new Int16Array(Z),a.HEAP32=V=new Int32Array(Z),a.HEAPU8=G=new Uint8Array(Z),a.HEAPU16=$=new Uint16Array(Z),a.HEAPU32=X=new Uint32Array(Z),a.HEAPF32=Q=new Float32Array(Z),a.HEAPF64=re=new Float64Array(Z)}a.INITIAL_MEMORY;var me,Ce=[],we=[],Ae=[];function De(){if(a.preRun)for(typeof a.preRun=="function"&&(a.preRun=[a.preRun]);a.preRun.length;)J(a.preRun.shift());Je(Ce)}function q(){Je(we)}function k(){if(a.postRun)for(typeof a.postRun=="function"&&(a.postRun=[a.postRun]);a.postRun.length;)ie(a.postRun.shift());Je(Ae)}function J(Z){Ce.unshift(Z)}function Y(Z){we.unshift(Z)}function ie(Z){Ae.unshift(Z)}var ue=0,fe=null;function Se(Z){ue++,a.monitorRunDependencies&&a.monitorRunDependencies(ue)}function Fe(Z){if(ue--,a.monitorRunDependencies&&a.monitorRunDependencies(ue),ue==0&&fe){var te=fe;fe=null,te()}}function Ke(Z){a.onAbort&&a.onAbort(Z),Z="Aborted("+Z+")",w(Z),_=!0,Z+=". Build with -sASSERTIONS for more info.";var te=new WebAssembly.RuntimeError(Z);throw s(te),te}var He="data:application/octet-stream;base64,";function pe(Z){return Z.startsWith(He)}function ge(Z){return Z.startsWith("file://")}var Ie;Ie="openjphjs.wasm",pe(Ie)||(Ie=h(Ie));function ve(Z){try{if(Z==Ie&&S)return new Uint8Array(S);if(m)return m(Z);throw"both async and sync fetching of the wasm failed"}catch(te){Ke(te)}}function _e(){if(!S&&(c||f)){if(typeof fetch=="function"&&!ge(Ie))return fetch(Ie,{credentials:"same-origin"}).then(function(Z){if(!Z.ok)throw"failed to load wasm binary file at '"+Ie+"'";return Z.arrayBuffer()}).catch(function(){return ve(Ie)});if(g)return new Promise(function(Z,te){g(Ie,function(W){Z(new Uint8Array(W))},te)})}return Promise.resolve().then(function(){return ve(Ie)})}function Pe(){var Z={env:de,wasi_snapshot_preview1:de};function te(Ee,Me){var Ne=Ee.exports;a.asm=Ne,T=a.asm.memory,ye(T.buffer),me=a.asm.__indirect_function_table,Y(a.asm.__wasm_call_ctors),Fe()}Se();function W(Ee){te(Ee.instance)}function K(Ee){return _e().then(function(Me){return WebAssembly.instantiate(Me,Z)}).then(function(Me){return Me}).then(Ee,function(Me){w("failed to asynchronously prepare wasm: "+Me),Ke(Me)})}function ae(){return!S&&typeof WebAssembly.instantiateStreaming=="function"&&!pe(Ie)&&!ge(Ie)&&!u&&typeof fetch=="function"?fetch(Ie,{credentials:"same-origin"}).then(function(Ee){var Me=WebAssembly.instantiateStreaming(Ee,Z);return Me.then(W,function(Ne){return w("wasm streaming compile failed: "+Ne),w("falling back to ArrayBuffer instantiation"),K(W)})}):K(W)}if(a.instantiateWasm)try{var be=a.instantiateWasm(Z,te);return be}catch(Ee){w("Module.instantiateWasm callback failed with error: "+Ee),s(Ee)}return ae().catch(s),{}}function ne(Z){this.name="ExitStatus",this.message="Program terminated with exit("+Z+")",this.status=Z}function Je(Z){for(;Z.length>0;)Z.shift()(a)}function $e(Z,te,W,K){Ke("Assertion failed: "+M(Z)+", at: "+[te?M(te):"unknown filename",W,K?M(K):"unknown function"])}var ke=[];function Re(Z){Z.add_ref()}function ze(Z){var te=new xt(Z);return te.get_caught()||te.set_caught(!0),te.set_rethrown(!1),ke.push(te),Re(te),te.get_exception_ptr()}var st=0,Qe=[];function _t(Z){var te=Qe[Z];return te||(Z>=Qe.length&&(Qe.length=Z+1),Qe[Z]=te=me.get(Z)),te}function Le(Z){if(Z.release_ref()&&!Z.get_rethrown()){var te=Z.get_destructor();te&&_t(te)(Z.excPtr),Ye(Z.excPtr)}}function We(){_setThrew(0);var Z=ke.pop();Le(Z),st=0}function xt(Z){this.excPtr=Z,this.ptr=Z-24,this.set_type=function(te){X[this.ptr+4>>2]=te},this.get_type=function(){return X[this.ptr+4>>2]},this.set_destructor=function(te){X[this.ptr+8>>2]=te},this.get_destructor=function(){return X[this.ptr+8>>2]},this.set_refcount=function(te){V[this.ptr>>2]=te},this.set_caught=function(te){te=te?1:0,U[this.ptr+12>>0]=te},this.get_caught=function(){return U[this.ptr+12>>0]!=0},this.set_rethrown=function(te){te=te?1:0,U[this.ptr+13>>0]=te},this.get_rethrown=function(){return U[this.ptr+13>>0]!=0},this.init=function(te,W){this.set_adjusted_ptr(0),this.set_type(te),this.set_destructor(W),this.set_refcount(0),this.set_caught(!1),this.set_rethrown(!1)},this.add_ref=function(){var te=V[this.ptr>>2];V[this.ptr>>2]=te+1},this.release_ref=function(){var te=V[this.ptr>>2];return V[this.ptr>>2]=te-1,te===1},this.set_adjusted_ptr=function(te){X[this.ptr+16>>2]=te},this.get_adjusted_ptr=function(){return X[this.ptr+16>>2]},this.get_exception_ptr=function(){var te=Kt(this.get_type());if(te)return X[this.excPtr>>2];var W=this.get_adjusted_ptr();return W!==0?W:this.excPtr}}function Ut(Z){throw st||(st=Z),Z}function gn(){var Z=st;if(!Z)return gt(0),0;var te=new xt(Z);te.set_adjusted_ptr(Z);var W=te.get_type();if(!W)return gt(0),Z;for(var K=0;K<arguments.length;K++){var ae=arguments[K];if(ae===0||ae===W)break;var be=te.ptr+16;if(kt(ae,W,be))return gt(ae),Z}return gt(W),Z}function tn(){var Z=st;if(!Z)return gt(0),0;var te=new xt(Z);te.set_adjusted_ptr(Z);var W=te.get_type();if(!W)return gt(0),Z;for(var K=0;K<arguments.length;K++){var ae=arguments[K];if(ae===0||ae===W)break;var be=te.ptr+16;if(kt(ae,W,be))return gt(ae),Z}return gt(W),Z}function Ht(Z,te,W){var K=new xt(Z);throw K.init(te,W),st=Z,Z}var dn={};function sr(Z){for(;Z.length;){var te=Z.pop(),W=Z.pop();W(te)}}function Qn(Z){return this.fromWireType(V[Z>>2])}var qe={},Dt={},Rt={},Bt=48,On=57;function $t(Z){if(Z===void 0)return"_unknown";Z=Z.replace(/[^a-zA-Z0-9_]/g,"$");var te=Z.charCodeAt(0);return te>=Bt&&te<=On?"_"+Z:Z}function Xt(Z,te){return Z=$t(Z),new Function("body","return function "+Z+`() {
    "use strict";    return body.apply(this, arguments);
};
`)(te)}function Lt(Z,te){var W=Xt(te,function(K){this.name=te,this.message=K;var ae=new Error(K).stack;ae!==void 0&&(this.stack=this.toString()+`
`+ae.replace(/^Error(:[^\n]*)?\n/,""))});return W.prototype=Object.create(Z.prototype),W.prototype.constructor=W,W.prototype.toString=function(){return this.message===void 0?this.name:this.name+": "+this.message},W}var Qt=void 0;function yr(Z){throw new Qt(Z)}function kr(Z,te,W){Z.forEach(function(Me){Rt[Me]=te});function K(Me){var Ne=W(Me);Ne.length!==Z.length&&yr("Mismatched type converter count");for(var Ue=0;Ue<Z.length;++Ue)ri(Z[Ue],Ne[Ue])}var ae=new Array(te.length),be=[],Ee=0;te.forEach((Me,Ne)=>{Dt.hasOwnProperty(Me)?ae[Ne]=Dt[Me]:(be.push(Me),qe.hasOwnProperty(Me)||(qe[Me]=[]),qe[Me].push(()=>{ae[Ne]=Dt[Me],++Ee,Ee===be.length&&K(ae)}))}),be.length===0&&K(ae)}function ni(Z){var te=dn[Z];delete dn[Z];var W=te.rawConstructor,K=te.rawDestructor,ae=te.fields,be=ae.map(Ee=>Ee.getterReturnType).concat(ae.map(Ee=>Ee.setterArgumentType));kr([Z],be,Ee=>{var Me={};return ae.forEach((Ne,Ue)=>{var Ze=Ne.fieldName,ht=Ee[Ue],Pt=Ne.getter,Wt=Ne.getterContext,Gt=Ee[Ue+ae.length],hn=Ne.setter,mn=Ne.setterContext;Me[Ze]={read:er=>ht.fromWireType(Pt(Wt,er)),write:(er,Ar)=>{var Gr=[];hn(mn,er,Gt.toWireType(Gr,Ar)),sr(Gr)}}}),[{name:te.name,fromWireType:function(Ne){var Ue={};for(var Ze in Me)Ue[Ze]=Me[Ze].read(Ne);return K(Ne),Ue},toWireType:function(Ne,Ue){for(var Ze in Me)if(!(Ze in Ue))throw new TypeError('Missing field:  "'+Ze+'"');var ht=W();for(Ze in Me)Me[Ze].write(ht,Ue[Ze]);return Ne!==null&&Ne.push(K,ht),ht},argPackAdvance:8,readValueFromPointer:Qn,destructorFunction:K}]})}function Ii(Z,te,W,K,ae){}function fi(Z){switch(Z){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+Z)}}function Ri(){for(var Z=new Array(256),te=0;te<256;++te)Z[te]=String.fromCharCode(te);rn=Z}var rn=void 0;function Xn(Z){for(var te="",W=Z;G[W];)te+=rn[G[W++]];return te}var vi=void 0;function an(Z){throw new vi(Z)}function ri(Z,te,W={}){if(!("argPackAdvance"in te))throw new TypeError("registerType registeredInstance requires argPackAdvance");var K=te.name;if(Z||an('type "'+K+'" must have a positive integer typeid pointer'),Dt.hasOwnProperty(Z)){if(W.ignoreDuplicateRegistrations)return;an("Cannot register type '"+K+"' twice")}if(Dt[Z]=te,delete Rt[Z],qe.hasOwnProperty(Z)){var ae=qe[Z];delete qe[Z],ae.forEach(be=>be())}}function ts(Z,te,W,K,ae){var be=fi(W);te=Xn(te),ri(Z,{name:te,fromWireType:function(Ee){return!!Ee},toWireType:function(Ee,Me){return Me?K:ae},argPackAdvance:8,readValueFromPointer:function(Ee){var Me;if(W===1)Me=U;else if(W===2)Me=F;else if(W===4)Me=V;else throw new TypeError("Unknown boolean type size: "+te);return this.fromWireType(Me[Ee>>be])},destructorFunction:null})}function ii(Z){if(!(this instanceof ki)||!(Z instanceof ki))return!1;for(var te=this.$$.ptrType.registeredClass,W=this.$$.ptr,K=Z.$$.ptrType.registeredClass,ae=Z.$$.ptr;te.baseClass;)W=te.upcast(W),te=te.baseClass;for(;K.baseClass;)ae=K.upcast(ae),K=K.baseClass;return te===K&&W===ae}function Ai(Z){return{count:Z.count,deleteScheduled:Z.deleteScheduled,preservePointerOnDelete:Z.preservePointerOnDelete,ptr:Z.ptr,ptrType:Z.ptrType,smartPtr:Z.smartPtr,smartPtrType:Z.smartPtrType}}function wa(Z){function te(W){return W.$$.ptrType.registeredClass.name}an(te(Z)+" instance already deleted")}var Pi=!1;function Os(Z){}function No(Z){Z.smartPtr?Z.smartPtrType.rawDestructor(Z.smartPtr):Z.ptrType.registeredClass.rawDestructor(Z.ptr)}function Ni(Z){Z.count.value-=1;var te=Z.count.value===0;te&&No(Z)}function Lo(Z,te,W){if(te===W)return Z;if(W.baseClass===void 0)return null;var K=Lo(Z,te,W.baseClass);return K===null?null:W.downcast(K)}var At={};function Li(){return Object.keys(pr).length}function Xa(){var Z=[];for(var te in pr)pr.hasOwnProperty(te)&&Z.push(pr[te]);return Z}var di=[];function Ms(){for(;di.length;){var Z=di.pop();Z.$$.deleteScheduled=!1,Z.delete()}}var ko=void 0;function go(Z){ko=Z,di.length&&ko&&ko(Ms)}function $l(){a.getInheritedInstanceCount=Li,a.getLiveInheritedInstances=Xa,a.flushPendingDeletes=Ms,a.setDelayFunction=go}var pr={};function ka(Z,te){for(te===void 0&&an("ptr should not be undefined");Z.baseClass;)te=Z.upcast(te),Z=Z.baseClass;return te}function il(Z,te){return te=ka(Z,te),pr[te]}function Vo(Z,te){(!te.ptrType||!te.ptr)&&yr("makeClassHandle requires ptr and ptrType");var W=!!te.smartPtrType,K=!!te.smartPtr;return W!==K&&yr("Both smartPtrType and smartPtr must be specified"),te.count={value:1},Va(Object.create(Z,{$$:{value:te}}))}function al(Z){var te=this.getPointee(Z);if(!te)return this.destructor(Z),null;var W=il(this.registeredClass,te);if(W!==void 0){if(W.$$.count.value===0)return W.$$.ptr=te,W.$$.smartPtr=Z,W.clone();var K=W.clone();return this.destructor(Z),K}function ae(){return this.isSmartPointer?Vo(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:te,smartPtrType:this,smartPtr:Z}):Vo(this.registeredClass.instancePrototype,{ptrType:this,ptr:Z})}var be=this.registeredClass.getActualType(te),Ee=At[be];if(!Ee)return ae.call(this);var Me;this.isConst?Me=Ee.constPointerType:Me=Ee.pointerType;var Ne=Lo(te,this.registeredClass,Me.registeredClass);return Ne===null?ae.call(this):this.isSmartPointer?Vo(Me.registeredClass.instancePrototype,{ptrType:Me,ptr:Ne,smartPtrType:this,smartPtr:Z}):Vo(Me.registeredClass.instancePrototype,{ptrType:Me,ptr:Ne})}function Va(Z){return typeof FinalizationRegistry>"u"?(Va=te=>te,Z):(Pi=new FinalizationRegistry(te=>{Ni(te.$$)}),Va=te=>{var W=te.$$,K=!!W.smartPtr;if(K){var ae={$$:W};Pi.register(te,ae,te)}return te},Os=te=>Pi.unregister(te),Va(Z))}function Ou(){if(this.$$.ptr||wa(this),this.$$.preservePointerOnDelete)return this.$$.count.value+=1,this;var Z=Va(Object.create(Object.getPrototypeOf(this),{$$:{value:Ai(this.$$)}}));return Z.$$.count.value+=1,Z.$$.deleteScheduled=!1,Z}function la(){this.$$.ptr||wa(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&an("Object already scheduled for deletion"),Os(this),Ni(this.$$),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)}function Gl(){return!this.$$.ptr}function Sc(){return this.$$.ptr||wa(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&an("Object already scheduled for deletion"),di.push(this),di.length===1&&ko&&ko(Ms),this.$$.deleteScheduled=!0,this}function Ca(){ki.prototype.isAliasOf=ii,ki.prototype.clone=Ou,ki.prototype.delete=la,ki.prototype.isDeleted=Gl,ki.prototype.deleteLater=Sc}function ki(){}function Sa(Z,te,W){if(Z[te].overloadTable===void 0){var K=Z[te];Z[te]=function(){return Z[te].overloadTable.hasOwnProperty(arguments.length)||an("Function '"+W+"' called with an invalid number of arguments ("+arguments.length+") - expects one of ("+Z[te].overloadTable+")!"),Z[te].overloadTable[arguments.length].apply(this,arguments)},Z[te].overloadTable=[],Z[te].overloadTable[K.argCount]=K}}function Vi(Z,te,W){a.hasOwnProperty(Z)?((W===void 0||a[Z].overloadTable!==void 0&&a[Z].overloadTable[W]!==void 0)&&an("Cannot register public name '"+Z+"' twice"),Sa(a,Z,Z),a.hasOwnProperty(W)&&an("Cannot register multiple overloads of a function with the same number of arguments ("+W+")!"),a[Z].overloadTable[W]=te):(a[Z]=te,W!==void 0&&(a[Z].numArguments=W))}function Fo(Z,te,W,K,ae,be,Ee,Me){this.name=Z,this.constructor=te,this.instancePrototype=W,this.rawDestructor=K,this.baseClass=ae,this.getActualType=be,this.upcast=Ee,this.downcast=Me,this.pureVirtualFunctions=[]}function ns(Z,te,W){for(;te!==W;)te.upcast||an("Expected null or instance of "+W.name+", got an instance of "+te.name),Z=te.upcast(Z),te=te.baseClass;return Z}function rs(Z,te){if(te===null)return this.isReference&&an("null is not a valid "+this.name),0;te.$$||an('Cannot pass "'+Rs(te)+'" as a '+this.name),te.$$.ptr||an("Cannot pass deleted object as a pointer of type "+this.name);var W=te.$$.ptrType.registeredClass,K=ns(te.$$.ptr,W,this.registeredClass);return K}function Kr(Z,te){var W;if(te===null)return this.isReference&&an("null is not a valid "+this.name),this.isSmartPointer?(W=this.rawConstructor(),Z!==null&&Z.push(this.rawDestructor,W),W):0;te.$$||an('Cannot pass "'+Rs(te)+'" as a '+this.name),te.$$.ptr||an("Cannot pass deleted object as a pointer of type "+this.name),!this.isConst&&te.$$.ptrType.isConst&&an("Cannot convert argument of type "+(te.$$.smartPtrType?te.$$.smartPtrType.name:te.$$.ptrType.name)+" to parameter type "+this.name);var K=te.$$.ptrType.registeredClass;if(W=ns(te.$$.ptr,K,this.registeredClass),this.isSmartPointer)switch(te.$$.smartPtr===void 0&&an("Passing raw pointer to smart pointer is illegal"),this.sharingPolicy){case 0:te.$$.smartPtrType===this?W=te.$$.smartPtr:an("Cannot convert argument of type "+(te.$$.smartPtrType?te.$$.smartPtrType.name:te.$$.ptrType.name)+" to parameter type "+this.name);break;case 1:W=te.$$.smartPtr;break;case 2:if(te.$$.smartPtrType===this)W=te.$$.smartPtr;else{var ae=te.clone();W=this.rawShare(W,Is.toHandle(function(){ae.delete()})),Z!==null&&Z.push(this.rawDestructor,W)}break;default:an("Unsupporting sharing policy")}return W}function ol(Z,te){if(te===null)return this.isReference&&an("null is not a valid "+this.name),0;te.$$||an('Cannot pass "'+Rs(te)+'" as a '+this.name),te.$$.ptr||an("Cannot pass deleted object as a pointer of type "+this.name),te.$$.ptrType.isConst&&an("Cannot convert argument of type "+te.$$.ptrType.name+" to parameter type "+this.name);var W=te.$$.ptrType.registeredClass,K=ns(te.$$.ptr,W,this.registeredClass);return K}function Ta(Z){return this.rawGetPointee&&(Z=this.rawGetPointee(Z)),Z}function Fi(Z){this.rawDestructor&&this.rawDestructor(Z)}function is(Z){Z!==null&&Z.delete()}function mo(){qi.prototype.getPointee=Ta,qi.prototype.destructor=Fi,qi.prototype.argPackAdvance=8,qi.prototype.readValueFromPointer=Qn,qi.prototype.deleteObject=is,qi.prototype.fromWireType=al}function qi(Z,te,W,K,ae,be,Ee,Me,Ne,Ue,Ze){this.name=Z,this.registeredClass=te,this.isReference=W,this.isConst=K,this.isSmartPointer=ae,this.pointeeType=be,this.sharingPolicy=Ee,this.rawGetPointee=Me,this.rawConstructor=Ne,this.rawShare=Ue,this.rawDestructor=Ze,!ae&&te.baseClass===void 0?K?(this.toWireType=rs,this.destructorFunction=null):(this.toWireType=ol,this.destructorFunction=null):this.toWireType=Kr}function Fa(Z,te,W){a.hasOwnProperty(Z)||yr("Replacing nonexistant public symbol"),a[Z].overloadTable!==void 0&&W!==void 0?a[Z].overloadTable[W]=te:(a[Z]=te,a[Z].argCount=W)}function Uo(Z,te,W){var K=a["dynCall_"+Z];return W&&W.length?K.apply(null,[te].concat(W)):K.call(null,te)}function jl(Z,te,W){if(Z.includes("j"))return Uo(Z,te,W);var K=_t(te).apply(null,W);return K}function as(Z,te){var W=[];return function(){return W.length=0,Object.assign(W,arguments),jl(Z,te,W)}}function Sr(Z,te){Z=Xn(Z);function W(){return Z.includes("j")?as(Z,te):_t(te)}var K=W();return typeof K!="function"&&an("unknown function pointer with signature "+Z+": "+te),K}var Ya=void 0;function Tr(Z){var te=at(Z),W=Xn(te);return Oe(te),W}function ai(Z,te){var W=[],K={};function ae(be){if(!K[be]&&!Dt[be]){if(Rt[be]){Rt[be].forEach(ae);return}W.push(be),K[be]=!0}}throw te.forEach(ae),new Ya(Z+": "+W.map(Tr).join([", "]))}function os(Z,te,W,K,ae,be,Ee,Me,Ne,Ue,Ze,ht,Pt){Ze=Xn(Ze),be=Sr(ae,be),Me&&(Me=Sr(Ee,Me)),Ue&&(Ue=Sr(Ne,Ue)),Pt=Sr(ht,Pt);var Wt=$t(Ze);Vi(Wt,function(){ai("Cannot construct "+Ze+" due to unbound types",[K])}),kr([Z,te,W],K?[K]:[],function(Gt){Gt=Gt[0];var hn,mn;K?(hn=Gt.registeredClass,mn=hn.instancePrototype):mn=ki.prototype;var er=Xt(Wt,function(){if(Object.getPrototypeOf(this)!==Ar)throw new vi("Use 'new' to construct "+Ze);if(Gr.constructor_body===void 0)throw new vi(Ze+" has no accessible constructor");var jf=Gr.constructor_body[arguments.length];if(jf===void 0)throw new vi("Tried to invoke ctor of "+Ze+" with invalid number of parameters ("+arguments.length+") - expected ("+Object.keys(Gr.constructor_body).toString()+") parameters instead!");return jf.apply(this,arguments)}),Ar=Object.create(mn,{constructor:{value:er}});er.prototype=Ar;var Gr=new Fo(Ze,er,Ar,Pt,hn,be,Me,Ue),Yl=new qi(Ze,Gr,!0,!1,!1),Go=new qi(Ze+"*",Gr,!1,!1,!1),hl=new qi(Ze+" const*",Gr,!1,!0,!1);return At[Z]={pointerType:Go,constPointerType:hl},Fa(Wt,er),[Yl,Go,hl]})}function oi(Z,te){for(var W=[],K=0;K<Z;K++)W.push(X[te+K*4>>2]);return W}function zl(Z,te){if(!(Z instanceof Function))throw new TypeError("new_ called with constructor type "+typeof Z+" which is not a function");var W=Xt(Z.name||"unknownFunctionName",function(){});W.prototype=Z.prototype;var K=new W,ae=Z.apply(K,te);return ae instanceof Object?ae:K}function yi(Z,te,W,K,ae){var be=te.length;be<2&&an("argTypes array size mismatch! Must at least get return value and 'this' types!");for(var Ee=te[1]!==null&&W!==null,Me=!1,Ne=1;Ne<te.length;++Ne)if(te[Ne]!==null&&te[Ne].destructorFunction===void 0){Me=!0;break}for(var Ue=te[0].name!=="void",Ze="",ht="",Ne=0;Ne<be-2;++Ne)Ze+=(Ne!==0?", ":"")+"arg"+Ne,ht+=(Ne!==0?", ":"")+"arg"+Ne+"Wired";var Pt="return function "+$t(Z)+"("+Ze+`) {
if (arguments.length !== `+(be-2)+`) {
throwBindingError('function `+Z+" called with ' + arguments.length + ' arguments, expected "+(be-2)+` args!');
}
`;Me&&(Pt+=`var destructors = [];
`);var Wt=Me?"destructors":"null",Gt=["throwBindingError","invoker","fn","runDestructors","retType","classParam"],hn=[an,K,ae,sr,te[0],te[1]];Ee&&(Pt+="var thisWired = classParam.toWireType("+Wt+`, this);
`);for(var Ne=0;Ne<be-2;++Ne)Pt+="var arg"+Ne+"Wired = argType"+Ne+".toWireType("+Wt+", arg"+Ne+"); // "+te[Ne+2].name+`
`,Gt.push("argType"+Ne),hn.push(te[Ne+2]);if(Ee&&(ht="thisWired"+(ht.length>0?", ":"")+ht),Pt+=(Ue?"var rv = ":"")+"invoker(fn"+(ht.length>0?", ":"")+ht+`);
`,Me)Pt+=`runDestructors(destructors);
`;else for(var Ne=Ee?1:2;Ne<te.length;++Ne){var mn=Ne===1?"thisWired":"arg"+(Ne-2)+"Wired";te[Ne].destructorFunction!==null&&(Pt+=mn+"_dtor("+mn+"); // "+te[Ne].name+`
`,Gt.push(mn+"_dtor"),hn.push(te[Ne].destructorFunction))}Ue&&(Pt+=`var ret = retType.fromWireType(rv);
return ret;
`),Pt+=`}
`,Gt.push(Pt);var er=zl(Function,Gt).apply(null,hn);return er}function Ja(Z,te,W,K,ae,be){D(te>0);var Ee=oi(te,W);ae=Sr(K,ae),kr([],[Z],function(Me){Me=Me[0];var Ne="constructor "+Me.name;if(Me.registeredClass.constructor_body===void 0&&(Me.registeredClass.constructor_body=[]),Me.registeredClass.constructor_body[te-1]!==void 0)throw new vi("Cannot register multiple constructors with identical number of parameters ("+(te-1)+") for class '"+Me.name+"'! Overload resolution is currently only performed using the parameter count, not actual type info!");return Me.registeredClass.constructor_body[te-1]=()=>{ai("Cannot construct "+Me.name+" due to unbound types",Ee)},kr([],Ee,function(Ue){return Ue.splice(1,0,null),Me.registeredClass.constructor_body[te-1]=yi(Ne,Ue,null,ae,be),[]}),[]})}function ss(Z,te,W,K,ae,be,Ee,Me){var Ne=oi(W,K);te=Xn(te),be=Sr(ae,be),kr([],[Z],function(Ue){Ue=Ue[0];var Ze=Ue.name+"."+te;te.startsWith("@@")&&(te=Symbol[te.substring(2)]),Me&&Ue.registeredClass.pureVirtualFunctions.push(te);function ht(){ai("Cannot call "+Ze+" due to unbound types",Ne)}var Pt=Ue.registeredClass.instancePrototype,Wt=Pt[te];return Wt===void 0||Wt.overloadTable===void 0&&Wt.className!==Ue.name&&Wt.argCount===W-2?(ht.argCount=W-2,ht.className=Ue.name,Pt[te]=ht):(Sa(Pt,te,Ze),Pt[te].overloadTable[W-2]=ht),kr([],Ne,function(Gt){var hn=yi(Ze,Gt,Ue,be,Ee);return Pt[te].overloadTable===void 0?(hn.argCount=W-2,Pt[te]=hn):Pt[te].overloadTable[W-2]=hn,[]}),[]})}var vo=[],ca=[{},{value:void 0},{value:null},{value:!0},{value:!1}];function xi(Z){Z>4&&--ca[Z].refcount===0&&(ca[Z]=void 0,vo.push(Z))}function Bo(){for(var Z=0,te=5;te<ca.length;++te)ca[te]!==void 0&&++Z;return Z}function sl(){for(var Z=5;Z<ca.length;++Z)if(ca[Z]!==void 0)return ca[Z];return null}function ls(){a.count_emval_handles=Bo,a.get_first_emval=sl}var Is={toValue:Z=>(Z||an("Cannot use deleted val. handle = "+Z),ca[Z].value),toHandle:Z=>{switch(Z){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:{var te=vo.length?vo.pop():ca.length;return ca[te]={refcount:1,value:Z},te}}}};function ll(Z,te){te=Xn(te),ri(Z,{name:te,fromWireType:function(W){var K=Is.toValue(W);return xi(W),K},toWireType:function(W,K){return Is.toHandle(K)},argPackAdvance:8,readValueFromPointer:Qn,destructorFunction:null})}function Rs(Z){if(Z===null)return"null";var te=typeof Z;return te==="object"||te==="array"||te==="function"?Z.toString():""+Z}function As(Z,te){switch(te){case 2:return function(W){return this.fromWireType(Q[W>>2])};case 3:return function(W){return this.fromWireType(re[W>>3])};default:throw new TypeError("Unknown float type: "+Z)}}function cl(Z,te,W){var K=fi(W);te=Xn(te),ri(Z,{name:te,fromWireType:function(ae){return ae},toWireType:function(ae,be){return be},argPackAdvance:8,readValueFromPointer:As(te,K),destructorFunction:null})}function Tc(Z,te,W,K,ae,be){var Ee=oi(te,W);Z=Xn(Z),ae=Sr(K,ae),Vi(Z,function(){ai("Cannot call "+Z+" due to unbound types",Ee)},te-1),kr([],Ee,function(Me){var Ne=[Me[0],null].concat(Me.slice(1));return Fa(Z,yi(Z,Ne,null,ae,be),te-1),[]})}function Mu(Z,te,W){switch(te){case 0:return W?function(ae){return U[ae]}:function(ae){return G[ae]};case 1:return W?function(ae){return F[ae>>1]}:function(ae){return $[ae>>1]};case 2:return W?function(ae){return V[ae>>2]}:function(ae){return X[ae>>2]};default:throw new TypeError("Unknown integer type: "+Z)}}function Iu(Z,te,W,K,ae){te=Xn(te);var be=fi(W),Ee=ht=>ht;if(K===0){var Me=32-8*W;Ee=ht=>ht<<Me>>>Me}var Ne=te.includes("unsigned"),Ue=(ht,Pt)=>{},Ze;Ne?Ze=function(ht,Pt){return Ue(Pt,this.name),Pt>>>0}:Ze=function(ht,Pt){return Ue(Pt,this.name),Pt},ri(Z,{name:te,fromWireType:Ee,toWireType:Ze,argPackAdvance:8,readValueFromPointer:Mu(te,be,K!==0),destructorFunction:null})}function Ru(Z,te,W){var K=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],ae=K[te];function be(Ee){Ee=Ee>>2;var Me=X,Ne=Me[Ee],Ue=Me[Ee+1];return new ae(B,Ue,Ne)}W=Xn(W),ri(Z,{name:W,fromWireType:be,argPackAdvance:8,readValueFromPointer:be},{ignoreDuplicateRegistrations:!0})}function Wl(Z,te){te=Xn(te);var W=te==="std::string";ri(Z,{name:te,fromWireType:function(K){var ae=X[K>>2],be=K+4,Ee;if(W)for(var Me=be,Ne=0;Ne<=ae;++Ne){var Ue=be+Ne;if(Ne==ae||G[Ue]==0){var Ze=Ue-Me,ht=M(Me,Ze);Ee===void 0?Ee=ht:(Ee+="\0",Ee+=ht),Me=Ue+1}}else{for(var Pt=new Array(ae),Ne=0;Ne<ae;++Ne)Pt[Ne]=String.fromCharCode(G[be+Ne]);Ee=Pt.join("")}return Oe(K),Ee},toWireType:function(K,ae){ae instanceof ArrayBuffer&&(ae=new Uint8Array(ae));var be,Ee=typeof ae=="string";Ee||ae instanceof Uint8Array||ae instanceof Uint8ClampedArray||ae instanceof Int8Array||an("Cannot pass non-string to std::string"),W&&Ee?be=P(ae):be=ae.length;var Me=he(4+be+1),Ne=Me+4;if(X[Me>>2]=be,W&&Ee)L(ae,Ne,be+1);else if(Ee)for(var Ue=0;Ue<be;++Ue){var Ze=ae.charCodeAt(Ue);Ze>255&&(Oe(Ne),an("String has UTF-16 code units that do not fit in 8 bits")),G[Ne+Ue]=Ze}else for(var Ue=0;Ue<be;++Ue)G[Ne+Ue]=ae[Ue];return K!==null&&K.push(Oe,Me),Me},argPackAdvance:8,readValueFromPointer:Qn,destructorFunction:function(K){Oe(K)}})}var Ec=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0;function Au(Z,te){for(var W=Z,K=W>>1,ae=K+te/2;!(K>=ae)&&$[K];)++K;if(W=K<<1,W-Z>32&&Ec)return Ec.decode(G.subarray(Z,W));for(var be="",Ee=0;!(Ee>=te/2);++Ee){var Me=F[Z+Ee*2>>1];if(Me==0)break;be+=String.fromCharCode(Me)}return be}function _c(Z,te,W){if(W===void 0&&(W=2147483647),W<2)return 0;W-=2;for(var K=te,ae=W<Z.length*2?W/2:Z.length,be=0;be<ae;++be){var Ee=Z.charCodeAt(be);F[te>>1]=Ee,te+=2}return F[te>>1]=0,te-K}function Dc(Z){return Z.length*2}function Pu(Z,te){for(var W=0,K="";!(W>=te/4);){var ae=V[Z+W*4>>2];if(ae==0)break;if(++W,ae>=65536){var be=ae-65536;K+=String.fromCharCode(55296|be>>10,56320|be&1023)}else K+=String.fromCharCode(ae)}return K}function ul(Z,te,W){if(W===void 0&&(W=2147483647),W<4)return 0;for(var K=te,ae=K+W-4,be=0;be<Z.length;++be){var Ee=Z.charCodeAt(be);if(Ee>=55296&&Ee<=57343){var Me=Z.charCodeAt(++be);Ee=65536+((Ee&1023)<<10)|Me&1023}if(V[te>>2]=Ee,te+=4,te+4>ae)break}return V[te>>2]=0,te-K}function Oc(Z){for(var te=0,W=0;W<Z.length;++W){var K=Z.charCodeAt(W);K>=55296&&K<=57343&&++W,te+=4}return te}function Mc(Z,te,W){W=Xn(W);var K,ae,be,Ee,Me;te===2?(K=Au,ae=_c,Ee=Dc,be=()=>$,Me=1):te===4&&(K=Pu,ae=ul,Ee=Oc,be=()=>X,Me=2),ri(Z,{name:W,fromWireType:function(Ne){for(var Ue=X[Ne>>2],Ze=be(),ht,Pt=Ne+4,Wt=0;Wt<=Ue;++Wt){var Gt=Ne+4+Wt*te;if(Wt==Ue||Ze[Gt>>Me]==0){var hn=Gt-Pt,mn=K(Pt,hn);ht===void 0?ht=mn:(ht+="\0",ht+=mn),Pt=Gt+te}}return Oe(Ne),ht},toWireType:function(Ne,Ue){typeof Ue!="string"&&an("Cannot pass non-string to C++ string type "+W);var Ze=Ee(Ue),ht=he(4+Ze+te);return X[ht>>2]=Ze>>Me,ae(Ue,ht+4,Ze+te),Ne!==null&&Ne.push(Oe,ht),ht},argPackAdvance:8,readValueFromPointer:Qn,destructorFunction:function(Ne){Oe(Ne)}})}function Hl(Z,te,W,K,ae,be){dn[Z]={name:Xn(te),rawConstructor:Sr(W,K),rawDestructor:Sr(ae,be),fields:[]}}function Nu(Z,te,W,K,ae,be,Ee,Me,Ne,Ue){dn[Z].fields.push({fieldName:Xn(te),getterReturnType:W,getter:Sr(K,ae),getterContext:be,setterArgumentType:Ee,setter:Sr(Me,Ne),setterContext:Ue})}function fl(Z,te){te=Xn(te),ri(Z,{isVoid:!0,name:te,argPackAdvance:0,fromWireType:function(){},toWireType:function(W,K){}})}function Lu(Z){Z>4&&(ca[Z].refcount+=1)}function Ic(Z,te){var W=Dt[Z];return W===void 0&&an(te+" has unknown type "+Tr(Z)),W}function ku(Z,te){Z=Ic(Z,"_emval_take_value");var W=Z.readValueFromPointer(te);return Is.toHandle(W)}function Rc(){Ke("")}function Vu(Z,te,W){G.copyWithin(Z,te,te+W)}function Fu(){return 2147483648}function Kl(Z){try{return T.grow(Z-B.byteLength+65535>>>16),ye(T.buffer),1}catch{}}function ql(Z){var te=G.length;Z=Z>>>0;var W=Fu();if(Z>W)return!1;let K=(Ne,Ue)=>Ne+(Ue-Ne%Ue)%Ue;for(var ae=1;ae<=4;ae*=2){var be=te*(1+.2/ae);be=Math.min(be,Z+100663296);var Ee=Math.min(W,K(Math.max(Z,be),65536)),Me=Kl(Ee);if(Me)return!0}return!1}function $o(Z){return 52}function cs(Z,te,W,K,ae){return 70}var Za=[null,[],[]];function Ac(Z,te){var W=Za[Z];te===0||te===10?((Z===1?x:w)(R(W,0)),W.length=0):W.push(te)}function Pc(Z,te,W,K){for(var ae=0,be=0;be<W;be++){var Ee=X[te>>2],Me=X[te+4>>2];te+=8;for(var Ne=0;Ne<Me;Ne++)Ac(Z,G[Ee+Ne]);ae+=Me}return X[K>>2]=ae,0}function Ps(Z){return Z}function us(Z){var te=a["_"+Z];return te}function dl(Z,te){U.set(Z,te)}function Xl(Z,te,W,K,ae){var be={string:Gt=>{var hn=0;if(Gt!=null&&Gt!==0){var mn=(Gt.length<<2)+1;hn=bt(mn),L(Gt,hn,mn)}return hn},array:Gt=>{var hn=bt(Gt.length);return dl(Gt,hn),hn}};function Ee(Gt){return te==="string"?M(Gt):te==="boolean"?!!Gt:Gt}var Me=us(Z),Ne=[],Ue=0;if(K)for(var Ze=0;Ze<K.length;Ze++){var ht=be[W[Ze]];ht?(Ue===0&&(Ue=mt()),Ne[Ze]=ht(K[Ze])):Ne[Ze]=K[Ze]}var Pt=Me.apply(null,Ne);function Wt(Gt){return Ue!==0&&lt(Ue),Ee(Gt)}return Pt=Wt(Pt),Pt}Qt=a.InternalError=Lt(Error,"InternalError"),Ri(),vi=a.BindingError=Lt(Error,"BindingError"),Ca(),$l(),mo(),Ya=a.UnboundTypeError=Lt(Error,"UnboundTypeError"),ls();var de={__assert_fail:$e,__cxa_begin_catch:ze,__cxa_end_catch:We,__cxa_find_matching_catch_2:gn,__cxa_find_matching_catch_3:tn,__cxa_throw:Ht,__resumeException:Ut,_embind_finalize_value_object:ni,_embind_register_bigint:Ii,_embind_register_bool:ts,_embind_register_class:os,_embind_register_class_constructor:Ja,_embind_register_class_function:ss,_embind_register_emval:ll,_embind_register_float:cl,_embind_register_function:Tc,_embind_register_integer:Iu,_embind_register_memory_view:Ru,_embind_register_std_string:Wl,_embind_register_std_wstring:Mc,_embind_register_value_object:Hl,_embind_register_value_object_field:Nu,_embind_register_void:fl,_emval_decref:xi,_emval_incref:Lu,_emval_take_value:ku,abort:Rc,emscripten_memcpy_big:Vu,emscripten_resize_heap:ql,fd_close:$o,fd_seek:cs,fd_write:Pc,invoke_i:Ge,invoke_ii:en,invoke_iii:Tt,invoke_iiii:Te,invoke_v:oe,invoke_vi:un,invoke_viiii:se,invoke_viiiiii:rt,llvm_eh_typeid_for:Ps};Pe(),a.___wasm_call_ctors=function(){return(a.___wasm_call_ctors=a.asm.__wasm_call_ctors).apply(null,arguments)};var he=a._malloc=function(){return(he=a._malloc=a.asm.malloc).apply(null,arguments)},Oe=a._free=function(){return(Oe=a._free=a.asm.free).apply(null,arguments)},Ye=a.___cxa_free_exception=function(){return(Ye=a.___cxa_free_exception=a.asm.__cxa_free_exception).apply(null,arguments)},at=a.___getTypeName=function(){return(at=a.___getTypeName=a.asm.__getTypeName).apply(null,arguments)};a.__embind_initialize_bindings=function(){return(a.__embind_initialize_bindings=a.asm._embind_initialize_bindings).apply(null,arguments)},a.___errno_location=function(){return(a.___errno_location=a.asm.__errno_location).apply(null,arguments)};var gt=a.setTempRet0=function(){return(gt=a.setTempRet0=a.asm.setTempRet0).apply(null,arguments)},mt=a.stackSave=function(){return(mt=a.stackSave=a.asm.stackSave).apply(null,arguments)},lt=a.stackRestore=function(){return(lt=a.stackRestore=a.asm.stackRestore).apply(null,arguments)},bt=a.stackAlloc=function(){return(bt=a.stackAlloc=a.asm.stackAlloc).apply(null,arguments)},kt=a.___cxa_can_catch=function(){return(kt=a.___cxa_can_catch=a.asm.__cxa_can_catch).apply(null,arguments)},Kt=a.___cxa_is_pointer_type=function(){return(Kt=a.___cxa_is_pointer_type=a.asm.__cxa_is_pointer_type).apply(null,arguments)};a.dynCall_ji=function(){return(a.dynCall_ji=a.asm.dynCall_ji).apply(null,arguments)},a.dynCall_iiji=function(){return(a.dynCall_iiji=a.asm.dynCall_iiji).apply(null,arguments)},a.dynCall_jiji=function(){return(a.dynCall_jiji=a.asm.dynCall_jiji).apply(null,arguments)};function en(Z,te){var W=mt();try{return _t(Z)(te)}catch(K){if(lt(W),K!==K+0)throw K;_setThrew(1,0)}}function un(Z,te){var W=mt();try{_t(Z)(te)}catch(K){if(lt(W),K!==K+0)throw K;_setThrew(1,0)}}function se(Z,te,W,K,ae){var be=mt();try{_t(Z)(te,W,K,ae)}catch(Ee){if(lt(be),Ee!==Ee+0)throw Ee;_setThrew(1,0)}}function oe(Z){var te=mt();try{_t(Z)()}catch(W){if(lt(te),W!==W+0)throw W;_setThrew(1,0)}}function Te(Z,te,W,K){var ae=mt();try{return _t(Z)(te,W,K)}catch(be){if(lt(ae),be!==be+0)throw be;_setThrew(1,0)}}function Ge(Z){var te=mt();try{return _t(Z)()}catch(W){if(lt(te),W!==W+0)throw W;_setThrew(1,0)}}function rt(Z,te,W,K,ae,be,Ee){var Me=mt();try{_t(Z)(te,W,K,ae,be,Ee)}catch(Ne){if(lt(Me),Ne!==Ne+0)throw Ne;_setThrew(1,0)}}function Tt(Z,te,W){var K=mt();try{return _t(Z)(te,W)}catch(ae){if(lt(K),ae!==ae+0)throw ae;_setThrew(1,0)}}a.ccall=Xl;var pt;fe=function Z(){pt||dt(),pt||(fe=Z)};function dt(Z){if(ue>0||(De(),ue>0))return;function te(){pt||(pt=!0,a.calledRun=!0,!_&&(q(),o(a),a.onRuntimeInitialized&&a.onRuntimeInitialized(),k()))}a.setStatus?(a.setStatus("Running..."),setTimeout(function(){setTimeout(function(){a.setStatus("")},1),te()},1)):te()}if(a.preInit)for(typeof a.preInit=="function"&&(a.preInit=[a.preInit]);a.preInit.length>0;)a.preInit.pop()();return dt(),a.ready})})();t.exports=n})(J8)),J8.exports}var U$e=F$e();const B$e=tl(U$e),$$e=new URL("/assets/openjphjs-C-BUUy4a.wasm",import.meta.url),Ev={codec:void 0,decoder:void 0,decodeConfig:{}};function G$e(t,e,n){const r={width:e,height:n};for(;t>0;)r.width=Math.ceil(r.width/2),r.height=Math.ceil(r.height/2),t--;return r}function j$e(t){if(Ev.decodeConfig=t,Ev.codec)return Promise.resolve();const e=B$e({locateFile:n=>n.endsWith(".wasm")?$$e.toString():n});return new Promise((n,r)=>{e.then(i=>{Ev.codec=i,Ev.decoder=new i.HTJ2KDecoder,n()},r)})}async function z$e(t,e){await j$e();const n=new Ev.codec.HTJ2KDecoder,r=n.getEncodedBuffer(t.length);r.set(t);const i=e.decodeLevel||0;n.decodeSubResolution(i);const a=n.getFrameInfo();if(e.decodeLevel>0){const{width:I,height:R}=G$e(e.decodeLevel,a.width,a.height);a.width=I,a.height=R}const o=n.getDecodedBuffer();new Uint8Array(o.length).set(o);const l=`x: ${n.getImageOffset().x}, y: ${n.getImageOffset().y}`,c=n.getNumDecompositions(),f=n.getNumLayers(),u=["unknown","LRCP","RLCP","RPCL","PCRL","CPRL"][n.getProgressionOrder()+1],d=n.getIsReversible(),h=`${n.getBlockDimensions().width} x ${n.getBlockDimensions().height}`,p=`${n.getTileSize().width} x ${n.getTileSize().height}`,g=`${n.getTileOffset().x}, ${n.getTileOffset().y}`,m=`${o.length.toLocaleString()} bytes`,y=`${(o.length/r.length).toFixed(2)}:1`,v={columns:a.width,rows:a.height,bitsPerPixel:a.bitsPerSample,signed:a.isSigned,bytesPerPixel:e.bytesPerPixel,componentsPerPixel:a.componentCount};let x=W$e(a,o);const{buffer:w,byteOffset:S,byteLength:T}=x,_=w.slice(S,S+T);x=new x.constructor(_);const D={imageOffset:l,numDecompositions:c,numLayers:f,progessionOrder:u,reversible:d,blockDimensions:h,tileSize:p,tileOffset:g,decodedSize:m,compressionRatio:y};return{...e,pixelData:x,imageInfo:v,encodeOptions:D,...D,...v}}function W$e(t,e){return t.bitsPerSample>8?t.isSigned?new Int16Array(e.buffer,e.byteOffset,e.byteLength/2):new Uint16Array(e.buffer,e.byteOffset,e.byteLength/2):t.isSigned?new Int8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}function H$e(t,e){const n=t.length,{rescaleSlope:r,rescaleIntercept:i,suvbw:a,doseGridScaling:o}=e;if(e.modality==="PT"&&typeof a=="number"&&!isNaN(a))for(let s=0;s<n;s++)t[s]=a*(t[s]*r+i);else if(e.modality==="RTDOSE"&&typeof o=="number"&&!isNaN(o))for(let s=0;s<n;s++)t[s]=t[s]*o;else for(let s=0;s<n;s++)t[s]=t[s]*r+i;return!0}const K$e={bilinear:s$e,replicate:l$e},QF={Uint8Array,Uint16Array,Int16Array,Float32Array,Uint32Array};function q$e(t,e,n,r){const i=t.pixelRepresentation!==void 0&&t.pixelRepresentation===1,a=i&&t.bitsStored!==void 0?32-t.bitsStored:void 0;if(i&&a!==void 0)for(let v=0;v<t.pixelData.length;v++)t.pixelData[v]=t.pixelData[v]<<a>>a;let o=t.pixelData;t.pixelDataLength=t.pixelData.length;const{min:s,max:l}=NC(t.pixelData),c=typeof e.allowFloatRendering<"u"?e.allowFloatRendering:!0;let f=W7(t.photometricInterpretation)&&e.targetBuffer?.offset===void 0;const d=e.preScale?.enabled&&Object.values(e.preScale.scalingParameters).some(v=>typeof v=="number"&&!Number.isInteger(v)),h=!e.preScale.enabled||!c&&d,p=e.targetBuffer?.type;if(p&&e.preScale.enabled&&!h){const v=e.preScale.scalingParameters,x=c_(s,l,v);f=!TBe(x.min,x.max,QF[p])}p&&!f?o=Y$e(e,t,QF,o):e.preScale.enabled&&!h?o=J$e(e,s,l,t):o=Pte(s,l,t);let g=s,m=l;if(e.preScale.enabled&&!h){const v=e.preScale.scalingParameters;if(Nte(v),X$e(v)){H$e(o,v),t.preScale={...e.preScale,scaled:!0};const w=c_(s,l,v);g=w.min,m=w.max}}else h&&(t.preScale={enabled:!0,scaled:!1},g=s,m=l);t.pixelData=o,t.smallestPixelValue=g,t.largestPixelValue=m;const y=new Date().getTime();return t.decodeTimeInMS=y-n,t}function X$e(t){const{rescaleSlope:e,rescaleIntercept:n,modality:r,doseGridScaling:i,suvbw:a}=t;return typeof e=="number"&&typeof n=="number"||r==="RTDOSE"&&typeof i=="number"||r==="PT"&&typeof a=="number"}function Y$e(t,e,n,r){const{arrayBuffer:i,type:a,offset:o=0,length:s,rows:l}=t.targetBuffer,c=n[a];if(!c)throw new Error(`target array ${a} is not supported, or doesn't exist.`);l&&l!=e.rows&&Q$e(e,t.targetBuffer,c);const f=e.pixelDataLength,u=o,d=s??f-u,h=e.pixelData;if(d!==h.length)throw new Error(`target array for image does not have the same length (${d}) as the decoded image length (${h.length}).`);const p=i?new c(i,u,d):new c(d);return p.set(h,0),r=p,r}function J$e(t,e,n,r){const i=t.preScale.scalingParameters;Nte(i);const a=c_(e,n,i);return Pte(a.min,a.max,r)}function Pte(t,e,n){const r=H7(t,e),i=new r(n.pixelData.length);return i.set(n.pixelData,0),i}function c_(t,e,n){const{rescaleSlope:r,rescaleIntercept:i,modality:a,doseGridScaling:o,suvbw:s}=n;return a==="PT"&&typeof s=="number"&&!isNaN(s)?{min:s*(t*r+i),max:s*(e*r+i)}:a==="RTDOSE"&&typeof o=="number"&&!isNaN(o)?{min:t*o,max:e*o}:typeof r=="number"&&typeof i=="number"?{min:r*t+i,max:r*e+i}:{min:t,max:e}}function Nte(t){if(!t)throw new Error("options.preScale.scalingParameters must be defined if preScale.enabled is true, and scalingParameters cannot be derived from the metadata providers.")}function Z$e(t,e,n){const{samplesPerPixel:r}=t,{rows:i,columns:a}=e,o=i*a*r,s=new n(o),l=s.byteLength/o;return{pixelData:s,rows:i,columns:a,frameInfo:{...t.frameInfo,rows:i,columns:a},imageInfo:{...t.imageInfo,rows:i,columns:a,bytesPerPixel:l}}}function Q$e(t,e,n){const r=Z$e(t,e,n),{scalingType:i="replicate"}=e;return K$e[i](t,r),Object.assign(t,r),t.pixelDataLength=t.pixelData.length,t}async function Lte(t,e,n,r,i,a){const o=new Date().getTime();let s=null,l;switch(e){case"1.2.840.10008.1.2":case"1.2.840.10008.1.2.1":s=WF(t,n);break;case"1.2.840.10008.1.2.2":s=u$e(t,n);break;case"1.2.840.10008.1.2.1.99":s=WF(t,n);break;case"1.2.840.10008.1.2.5":s=f$e(t,n);break;case"1.2.840.10008.1.2.4.50":l={...t},s=b$e(n,l);break;case"1.2.840.10008.1.2.4.51":s=S$e(t,n);break;case"1.2.840.10008.1.2.4.57":s=KF(t,n);break;case"1.2.840.10008.1.2.4.70":s=KF(t,n);break;case"1.2.840.10008.1.2.4.80":l={signed:t.pixelRepresentation===1,bytesPerPixel:t.bitsAllocated<=8?1:2,...t},s=XF(n,l);break;case"1.2.840.10008.1.2.4.81":l={signed:t.pixelRepresentation===1,bytesPerPixel:t.bitsAllocated<=8?1:2,...t},s=XF(n,l);break;case"1.2.840.10008.1.2.4.90":l={...t},s=JF(n,l);break;case"1.2.840.10008.1.2.4.91":l={...t},s=JF(n,l);break;case"3.2.840.10008.1.2.4.96":case"1.2.840.10008.1.2.4.201":case"1.2.840.10008.1.2.4.202":case"1.2.840.10008.1.2.4.203":l={...t},s=z$e(n,l);break;default:throw new Error(`no decoder for transfer syntax ${e}`)}if(!s)throw new Error("decodePromise not defined");const c=await s,f=q$e(c,i,o);return a?.(f),f}const eGe={decodeTask({imageFrame:t,transferSyntax:e,decodeConfig:n,options:r,pixelData:i,callbackFn:a}){return Lte(t,e,i,n,r,a)}};x9(eGe);const of={constants:o$e,convertRGBColorByPixel:qee,convertRGBColorByPlane:Xee,convertYBRFullByPixel:Yee,convertYBRFullByPlane:Jee,convertPALETTECOLOR:Zee,wadouri:MBe,wadors:e$e,init:Ate,convertColorSpace:yte,createImage:LC,decodeJPEGBaseline8BitColor:xte,getImageFrame:bte,getPixelData:Y7,getMinMax:NC,isColorImage:W7,isJPEGBaseline8BitColor:i$e,internal:zUe,decodeImageFrame:Lte},tGe=async t=>(await Ko.post("/admin/original-data/store",t)).data,nGe=async t=>(await Ko.get(`/admin/original-data/detail?original_id=${t}`)).data,rGe=async t=>(await Ko.post("/student/copy",t)).data,iGe=async t=>(await Ko.get(`/student/copy/detail?user_copy_id=${t}`)).data;async function eU(t,e){try{if(!e)return console.warn("渲染引擎未提供，无法获取元数据"),null;const n=e.getViewport("CT_SAGITTAL_STACK");if(!n)return console.warn("无法获取视口"),null;const r=n.getImageData?.();if(!r)return console.warn("无法获取图像数据"),null;const i=r?.rows||r?.height||0,a=r?.columns||r?.width||0,o=l=>{try{return OD&&Ft?Ft("dicom",t,l):n.metadata&&n.metadata[l]?n.metadata[l]:r&&r[l]?r[l]:null}catch(c){return console.warn(`获取标签 ${l} 失败:`,c),null}};return{rows:i,columns:a,pixelSpacing:o("00180050"),sliceThickness:o("00180050"),windowWidth:o("00281051"),windowCenter:o("00281050"),bitsAllocated:o("00280100"),bitsStored:o("00280101"),highBit:o("00280102"),samplesPerPixel:o("00280002"),photometricInterpretation:o("00280004"),modality:o("00080060"),studyDate:o("00080020"),seriesDate:o("00080021"),acquisitionDate:o("00080022")}}catch(n){return console.error("获取 DICOM 元数据失败:",n),null}}function aGe({title:t,isInitialized:e,isLoading:n,hasData:r,onBack:i,onReload:a,onConsoleEditData:o,onClearData:s,onCopyData:l}){const{userInfo:c}=Bf(),f=Su().pathname,u=H.useMemo(()=>f.includes("original"),[f]);return j.jsx("div",{className:"bg-gray-800 text-white px-4 pt-4 flex-shrink-0",children:j.jsxs("div",{className:"flex items-center justify-between mb-3",children:[j.jsxs("div",{className:"flex items-center gap-3",children:[j.jsx(zr,{onClick:i,className:"bg-gray-600 hover:bg-gray-700 text-white",size:"sm",children:"← 返回列表"}),j.jsx("h1",{className:"text-xl font-bold",children:t})]}),j.jsxs("div",{className:"flex items-center gap-2",children:[c?.role===3&&u&&j.jsx("div",{className:"flex items-center gap-2",children:j.jsx(zr,{onClick:l,size:"sm",variant:"solid",color:"success",className:"font-medium text-white px-4 py-2 rounded-lg shadow-md transition-all duration-200 transform",startContent:n?j.jsx("div",{className:"w-4 h-4 border-2 border-current border-t-transparent rounded-full animate-spin"}):j.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:j.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),children:"拷贝数据"})}),(c?.role===1||c?.role===2||!u&&c?.role===3)&&o&&j.jsx(zr,{onClick:o,disabled:!r,size:"sm",variant:"solid",color:r?"success":"default",className:"font-medium px-4 py-2 rounded-lg shadow-md transition-all duration-200 transform text-white",startContent:j.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:j.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"})}),children:"保存数据"}),(c?.role===1||c?.role===2||!u&&c?.role===3)&&s&&j.jsx(zr,{onClick:s,disabled:!r,size:"sm",variant:"solid",color:r?"danger":"default",className:"font-medium px-4 py-2 rounded-lg shadow-md transition-all duration-200 transform text-white",startContent:j.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:j.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m2 0h10M9 7V4h6v3M10 11v6m4-6v6"})}),children:"清空数据"}),j.jsx(zr,{onClick:a,disabled:!e||n||!r,size:"sm",variant:"solid",color:e&&r?"primary":"default",className:"font-medium px-4 py-2 rounded-lg shadow-md transition-all duration-200 transform",startContent:n?j.jsx("div",{className:"w-4 h-4 border-2 border-current border-t-transparent rounded-full animate-spin"}):j.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:j.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),children:n?"加载中...":"重新加载"})]})]})})}const oGe=t=>{switch(t){case"WindowLevel":return"窗位/窗宽";case"Pan":return"平移";case"Zoom":return"缩放";case"Length":return"测量长度";case"RectangleROI":return"矩形标注";case"EllipticalROI":return"椭圆标注";case"CircleROI":return"圆形标注";case"FreehandROI":return"自由画线";case"ArrowAnnotate":return"箭头标注";case"Probe":return"探针";case"Angle":return"角度测量";case"Bidirectional":return"双向测量";case"PlanarFreehandROI":return"平面自由绘制";case"CobbAngle":return"Cobb角度测量";case"RectangleROIStartEndThreshold":return"矩形阈值标注";case"RectangleROIThreshold":return"矩形阈值工具";case"SplineROI":return"样条线标注";case"LivewireContour":return"活线轮廓";case"Magnify":return"放大镜";case"ReferenceLines":return"参考线";case"OverlayGrid":return"网格覆盖";case"Crosshairs":return"十字线";case"ScaleOverlay":return"比例尺";case"AdvancedMagnify":return"高级放大镜";case"UltrasoundDirectional":return"超声方向工具";case"RectangleScissors":return"矩形剪切";case"CircleScissors":return"圆形剪切";case"SphereScissors":return"球形剪切";case"Label":return"文字标注";case"DeleteAnnotation":return"删除标注";default:return t}},sGe=t=>{switch(t){case"WindowLevel":return"拖动鼠标调节亮度和对比度";case"Pan":return"拖动鼠标移动图像";case"Zoom":return"拖动鼠标缩放图像";case"Length":return"点击两点测量距离";case"RectangleROI":return"拖动画出矩形区域";case"EllipticalROI":return"拖动画出椭圆区域";case"CircleROI":return"拖动画出圆形区域";case"FreehandROI":return"拖动鼠标自由画线";case"ArrowAnnotate":return"点击两点放置箭头标注";case"Probe":return"点击查看像素值";case"Angle":return"点击三点测量角度";case"Bidirectional":return"拖动测量两个方向的距离";case"PlanarFreehandROI":return"拖动鼠标平面自由绘制";case"CobbAngle":return"测量Cobb角，常用于脊柱弯曲分析";case"RectangleROIStartEndThreshold":return"画矩形区域并设置阈值范围";case"RectangleROIThreshold":return"矩形阈值分割工具";case"SplineROI":return"绘制样条曲线区域";case"LivewireContour":return"智能边缘检测轮廓绘制";case"Magnify":return"点击显示局部放大镜";case"ReferenceLines":return"显示切面参考线";case"OverlayGrid":return"显示网格覆盖层";case"Crosshairs":return"显示十字线定位";case"ScaleOverlay":return"显示比例尺标记";case"AdvancedMagnify":return"高级放大镜功能";case"UltrasoundDirectional":return"超声图像方向标注";case"RectangleScissors":return"矩形区域剪切工具";case"CircleScissors":return"圆形区域剪切工具";case"SphereScissors":return"球形区域剪切工具";case"Label":return"点击插入文字标注";case"DeleteAnnotation":return"删除当前选中的标注";default:return"选择工具进行操作"}};function lGe({isInitialized:t,activeTool:e,onSwitch:n,annotationColor:r,onColorChange:i}){if(!t)return null;const a=({name:o,label:s})=>j.jsx("button",{onClick:()=>n(o),className:`px-2 py-1 text-xs rounded transition-all cursor-pointer ${e===o?"bg-blue-600 text-white":"bg-gray-600 text-gray-200"}`,children:s});return j.jsxs("div",{className:"space-y-2 bg-gray-800 px-2",children:[j.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[j.jsx("span",{className:"text-xs font-medium text-blue-300 mr-1",children:"基本:"}),j.jsx(a,{name:"WindowLevel",label:"🌅 窗位"}),j.jsx(a,{name:"Pan",label:"✋ 平移"}),j.jsx(a,{name:"Zoom",label:"🔍 缩放"}),j.jsx(a,{name:"Probe",label:"🔎 探针"}),j.jsx("span",{className:"text-xs font-medium text-green-300 mr-1 ml-3",children:"测量:"}),j.jsx(a,{name:"Length",label:"📏 长度"}),j.jsx(a,{name:"Angle",label:"📐 角度"}),j.jsx(a,{name:"Bidirectional",label:"↔️ 双向"}),j.jsx("span",{className:"text-xs font-medium text-purple-300 mr-1 ml-3",children:"标注:"}),j.jsx(a,{name:"RectangleROI",label:"▭ 矩形"}),j.jsx(a,{name:"EllipticalROI",label:"⚬ 椭圆"}),j.jsx(a,{name:"CircleROI",label:"◯ 圆形"}),j.jsx(a,{name:"PlanarFreehandROI",label:"🎨 绘制"}),j.jsx(a,{name:"ArrowAnnotate",label:"➡️ 箭头"}),j.jsx(a,{name:"Label",label:"📝 文字"}),j.jsx("span",{className:"text-xs font-medium text-red-300 mr-1 ml-3",children:"操作:"}),j.jsx(a,{name:"DeleteAnnotation",label:"🗑️ 删除"}),j.jsx("span",{className:"text-yellow-300 text-xs mr-1 ml-3",children:"颜色:"}),j.jsxs("div",{className:"flex items-center gap-2",children:[j.jsx("input",{type:"color",value:r,onChange:o=>i(o.target.value),className:"w-8 h-8 rounded border-2 border-gray-400 cursor-pointer",title:"选择标注颜色"}),j.jsx("button",{onClick:()=>i("#ff0000"),className:"px-2 py-1 text-xs rounded bg-red-600 text-white hover:bg-red-700 transition-all",title:"测试红色",children:"🔴 红"}),j.jsx("button",{onClick:()=>i("#00ff00"),className:"px-2 py-1 text-xs rounded bg-green-600 text-white hover:bg-green-700 transition-all",title:"测试绿色",children:"🟢 绿"})]})]}),j.jsxs("div",{className:"text-xs text-gray-300 py-1 rounded",children:[j.jsx("span",{className:"text-yellow-300",children:"当前:"})," ",j.jsx("span",{className:"font-medium",children:oGe(e)}),j.jsx("span",{className:"mx-1 text-gray-500",children:"|"}),j.jsx("span",{className:"text-blue-300",children:sGe(e)})]})]})}function cGe({error:t,dataLoading:e,isInitialized:n}){return j.jsxs(j.Fragment,{children:[t&&j.jsxs("div",{className:"p-3 bg-red-100 text-red-800 border-b border-red-300",children:["错误: ",t]}),e&&j.jsx("div",{className:"p-3 bg-blue-100 text-blue-800 border-b border-blue-300",children:"正在加载数据..."}),!n&&j.jsx("div",{className:"p-3 bg-cyan-100 text-cyan-800 border-b border-cyan-300",children:"正在初始化 Cornerstone..."})]})}function uGe({elementRef:t,isLoading:e,isInitialized:n,hasData:r,showSwitchHint:i,children:a}){return j.jsx("div",{className:"flex-1 relative overflow-hidden ",children:j.jsxs("div",{ref:t,className:"w-full h-full bg-black",style:{minHeight:"400px"},children:[!e&&n&&r&&j.jsxs(j.Fragment,{children:[j.jsx("div",{className:"absolute top-1 left-4 text-gray-400 text-sm bg-black bg-opacity-50 px-2 py-1 rounded z-10",children:"图像将自动加载，或点击按钮重新加载"}),i&&j.jsx("div",{className:"absolute top-1 right-4 text-gray-400 text-sm bg-black bg-opacity-50 px-2 py-1 rounded z-10",children:"使用 ← → 键切换图像"})]}),!r&&!e&&j.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-gray-500",children:j.jsxs("div",{className:"text-center",children:[j.jsx("div",{className:"text-2xl mb-2",children:"📁"}),j.jsx("div",{children:"数据加载失败"})]})}),e&&j.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-gray-500",children:j.jsxs("div",{className:"text-center",children:[j.jsx("div",{className:"text-2xl mb-2",children:"🔄"}),j.jsx("div",{children:"正在加载数据..."})]})}),a]})})}function fGe({visible:t,isLoading:e,imageCount:n,currentIndex:r,expanded:i,onToggleExpanded:a,onPrev:o,onNext:s,onJump:l}){return t?j.jsxs("div",{className:"fixed bottom-4 left-4 z-50",children:[j.jsx("div",{className:"mb-2",children:j.jsxs(zr,{size:"sm",onClick:a,className:"bg-gray-800 bg-opacity-90 backdrop-blur-sm hover:bg-gray-700 text-white border border-gray-600 shadow-lg",children:[i?"🔽":"🖼️"," ",r+1,"/",n]})}),i&&j.jsxs("div",{className:"bg-gray-800 w-[320px] bg-opacity-95 backdrop-blur-sm border border-gray-600 rounded-lg shadow-xl p-4 min-w-72",children:[j.jsxs("div",{className:"flex items-center justify-between mb-3",children:[j.jsx("span",{className:"text-sm font-medium text-orange-300",children:"图像切换:"}),j.jsxs("div",{className:"flex items-center gap-1",children:[j.jsx(zr,{size:"sm",onClick:o,disabled:n<=1||e,className:"bg-gray-600 hover:bg-gray-500 text-white min-w-unit-8 h-8",children:"◀"}),j.jsxs("span",{className:"text-sm text-gray-300 px-3 min-w-16 text-center",children:[r+1," / ",n]}),j.jsx(zr,{size:"sm",onClick:s,disabled:n<=1||e,className:"bg-gray-600 hover:bg-gray-500 text-white min-w-unit-8 h-8",children:"▶"})]})]}),n>2&&j.jsxs("div",{children:[j.jsx("div",{className:"text-xs text-gray-400 mb-2",children:"快速跳转:"}),j.jsx("div",{className:"flex gap-1 overflow-x-auto pb-2 max-w-64",children:Array.from({length:n}).map((c,f)=>j.jsx("button",{onClick:()=>l(f),disabled:e,className:`
                          flex-shrink-0 w-8 h-6 text-xs rounded transition-all
                          ${f===r?"bg-orange-600 text-white":"bg-gray-600 text-gray-300 hover:bg-gray-500"}
                          ${e?"opacity-50 cursor-not-allowed":""}
                        `,children:f+1},f))})]}),j.jsx("div",{className:"mt-3 pt-3 border-t border-gray-600",children:j.jsx("div",{className:"text-xs text-gray-500",children:"💡 快捷键: ← → 切换图像"})})]})]}):null}const{ViewportType:dGe}=nl,{MouseBindings:cg}=bIe;function tU(){const{id:t}=hU(),e=bc(),{userInfo:n}=Bf(),r=Su().pathname,i=H.useRef(null),[a,o]=H.useState(!1),[s,l]=H.useState(!0),[c,f]=H.useState(null),[u,d]=H.useState(!1),[h,p]=H.useState("WindowLevel"),[g,m]=H.useState(null),[y,v]=H.useState(0),[x,w]=H.useState([]),[S,T]=H.useState(!0),[_,D]=H.useState(null),[I,R]=H.useState(0),[M,A]=H.useState(1),[L,P]=H.useState(0),[B,U]=H.useState(0),[G,F]=H.useState([]),[$,V]=H.useState("#00ff00"),X=H.useRef(null),Q=H.useRef(null),re=H.useRef(0),ye=H.useRef(null),me=H.useRef(0),Ce=H.useRef(null),we=H.useMemo(()=>r.includes("original"),[r]),Ae=H.useCallback(async()=>{try{let Pe=bs.getAllAnnotations()||[],Je=JSON.parse(JSON.stringify(Pe)).map(ke=>{if(JSON.stringify(ke.data.cachedStats)!=="{}"){let Re=Object.keys(ke.data.cachedStats)[0].split("?")[0],ze=Object.values(ke.data.cachedStats)[0],st={[Re]:ze};ke.data.cachedStats=st}ke.metadata.referencedImageId=ke.metadata.referencedImageId.split("?")[0];try{const Re=ke?.metadata?.toolName||ke?.toolName;let ze=Tb.getStyleProperty("color",{annotationUID:ke.annotationUID,toolName:Re});ze||(ze=pe($)),ke.data={...ke.data||{},style:{...ke.data?.style,color:ze}}}catch{}return ke});const $e=JSON.stringify(Je);if(console.log("🚀 ~ printAnnotations ~ annotationsAll:",Je),we){const ke=await zme(g.original_id,$e);ke.success?Vt({color:"success",description:"标注保存成功"}):Vt({color:"danger",description:ke.message||"保存失败"})}else{const ke=await Wme(g.user_copy_id,$e);ke.success?Vt({color:"success",description:"标注保存成功"}):Vt({color:"danger",description:ke.message||"保存失败"})}}catch(Pe){console.warn("导出标注数据失败",Pe),Vt({color:"danger",description:"导出失败"})}},[x,g]),De=H.useCallback(()=>{try{bs.removeAllAnnotations(),F([]);const Pe=X.current;Pe&&Pe.getViewport("CT_SAGITTAL_STACK")?.render?.(),Vt({color:"success",description:"已清空所有标注"})}catch(Pe){console.warn("清空标注失败",Pe),Vt({color:"danger",description:"清空失败"})}},[]);H.useEffect(()=>{const Pe=ne=>{const{annotation:Je}=ne.detail||{};try{Tb.setAnnotationStyles(Je.annotationUID,{color:$})}catch($e){console.warn("设置新标注颜色失败",$e)}};return St.addEventListener(ee.ANNOTATION_ADDED,Pe),()=>{St.removeEventListener(ee.ANNOTATION_ADDED,Pe)}},[$]);const q=H.useCallback(async Pe=>{if(!(a||!X.current||!x[Pe]))try{o(!0);const ne=X.current,Je=ne.getViewport("CT_SAGITTAL_STACK");if(Je&&typeof Je.setStack=="function"){await Je.setStack([x[Pe]]),typeof Je.resetCamera=="function"&&Je.resetCamera();try{const $e=Je?.getCamera?.(),ke=$e?.parallelScale;typeof ke=="number"&&ke>0&&(Ce.current=ke,Je?.setCamera?.({...$e}))}catch{}ne.render(),v(Pe);try{const $e=await eU(x[Pe],ne);D($e)}catch($e){console.warn("获取 DICOM 元数据失败:",$e),D(null)}setTimeout(()=>{He()},50),console.log(`已切换到第 ${Pe+1} 张图像`)}}catch(ne){console.error("切换图像失败:",ne),f("切换图像失败: "+ne.message)}finally{o(!1)}},[x,a]),k=H.useCallback(()=>{if(a||x.length<=1)return;const Pe=y>0?y-1:x.length-1;q(Pe)},[y,x.length,a,q]),J=H.useCallback(()=>{if(a||x.length<=1)return;const Pe=y<x.length-1?y+1:0;q(Pe)},[y,x.length,a,q]);H.useEffect(()=>{(async()=>{if(!t){Vt({color:"danger",description:"数据ID无效"}),e("/list");return}l(!0);try{const ne=we?await nGe(Number(t)):await iGe(Number(t));if(ne.success&&ne.data){m(ne.data);let Je=ne.data.last_annotation?.annotation||ne.data?.original_data?.last_annotation?.annotation;if(Je)try{const ke=JSON.parse(Je);console.log("🚀解析保存的标注数据:",ke),F(ke)}catch(ke){console.warn("解析保存的标注数据失败:",ke)}const $e=ne.data.files||ne.data.original_data?.files;if($e&&$e.length>0){const ke=$e.map(Re=>`wadouri:${Re.fresh_url}`);w(ke),v(0)}}else Vt({color:"danger",description:ne.message||"加载数据失败"}),e("/list")}catch(ne){console.error("加载数据错误:",ne),Vt({color:"danger",description:"加载数据失败"}),e("/list")}finally{l(!1)}})()},[t,e]),H.useEffect(()=>((async()=>{try{await qW(),of.external||(of.external={}),of.external.cornerstone=xIe,of.external.dicomParser=kUe,Ate();try{of?.wadouri?.register&&of.wadouri.register()}catch(ne){console.warn("注册 wadouri 加载器时出错（可忽略）",ne)}try{of?.internal?.setOptions&&of.internal.setOptions({onloadstart:(ne,Je)=>{},onprogress:(ne,Je)=>{},onreadystatechange:(ne,Je)=>{const $e=ne?.target},onloadend:(ne,Je)=>{},beforeProcessing:ne=>Promise.resolve(ne.response),errorInterceptor:ne=>{console.error("请求错误",ne)}})}catch(ne){console.warn("设置 dicomImageLoader 调试选项失败（可忽略）",ne)}try{of.configure({useWebWorkers:!1})}catch(ne){console.warn("配置 dicomImageLoader 失败（可忽略）",ne)}await _Ve(),Xr(Ed),Xr(_d),Xr(Dd),Xr(Rd),Xr(qc),Xr(Pd),Xr(Nd),Xr(Vd),Xr(Ad),Xr(Fd),Xr(Id),Xr(hf),Xr(Ud),Xr(ah),Xr(oh),Xr(Ld),Xr(kd),Xr(sh),Xr(lh),Xr(Xc),Xr(Bd),Xr(ch),Xr(uh),Xr(fh),Xr(pf),d(!0),console.log("Cornerstone 初始化成功")}catch(ne){console.error("Cornerstone 初始化失败:",ne),f("初始化失败: "+ne.message)}})(),()=>{try{X.current&&(X.current.destroy(),X.current=null);const ne="STACK_TOOL_GROUP_ID";try{np(ne)&&uV(ne)}catch(Je){console.warn("清理工具组时出错（可忽略）:",Je)}}catch(ne){console.warn("组件清理时出错（可忽略）:",ne)}}),[]);const Y=H.useCallback(()=>{if(!Q.current)return;const Pe=h;if(!(!Pe||Pe==="DeleteAnnotation"))try{const ne=Q.current,Je=Re=>{try{ne.setToolPassive(Re.toolName)}catch{}};[_d,Ed,Dd,Rd,qc,Pd,Nd,Vd,Ad,Fd,Id,hf,Ud,ah,oh,Ld,kd,sh,lh,Xc,Bd,ch,uh,fh,pf].forEach(Je);const $e=[{mouseButton:cg.Primary}],ke=(Re,ze)=>{try{ne.setToolActive(Re.toolName,{bindings:ze})}catch{}};switch(Pe){case"WindowLevel":ke(_d,$e);break;case"Pan":ke(Ed,$e);break;case"Zoom":ke(Dd,$e);break;case"Length":ke(Rd,$e);break;case"RectangleROI":ke(qc,$e);break;case"EllipticalROI":ke(Pd,$e);break;case"CircleROI":ke(Nd,$e);break;case"ArrowAnnotate":ke(Vd,$e);break;case"Probe":ke(Ad,$e);break;case"Angle":ke(Fd,$e);break;case"Bidirectional":ke(Id,$e);break;case"PlanarFreehandROI":ke(hf,$e);break;case"CobbAngle":ke(Ud,$e);break;case"RectangleROIStartEndThreshold":ke(ah,$e);break;case"RectangleROIThreshold":ke(oh,$e);break;case"SplineROI":ke(Ld,$e);break;case"LivewireContour":ke(kd,$e);break;case"Magnify":ke(sh,$e);break;case"OverlayGrid":ke(lh,$e);break;case"AdvancedMagnify":ke(Xc,$e);break;case"UltrasoundDirectional":ke(Bd,$e);break;case"RectangleScissors":ke(ch,$e);break;case"CircleScissors":ke(uh,$e);break;case"SphereScissors":ke(fh,$e);break;case"Label":ke(pf,$e);break}try{X.current?.render?.()}catch{}}catch(ne){console.warn("重新应用工具失败",ne)}},[h]),ie=H.useCallback(async()=>{if(!u||!i.current||!g)return;o(!0),f(null);const Pe=++re.current;try{const ne=i.current;if(X.current){try{X.current.destroy()}catch(Le){console.warn("清理渲染引擎时出错（可忽略）:",Le)}X.current=null}const Je="myRenderingEngine",$e=new mJ(Je);X.current=$e;const ke="CT_SAGITTAL_STACK",Re={viewportId:ke,type:dGe.STACK,element:ne,defaultOptions:{background:[0,0,0]}};$e.enableElement(Re),setTimeout(()=>{try{if(Pe!==re.current)return;$e.resize(!0);const Le=$e.getViewport(ke);Le&&typeof Le.resetCamera=="function"&&Le.resetCamera(),$e.render()}catch(Le){console.warn("调整渲染引擎尺寸失败:",Le)}},50);const ze=$e.getViewport(ke),st="STACK_TOOL_GROUP_ID";let Qe;try{Qe=np(st),Qe&&uV(st)}catch{console.log("工具组不存在，将创建新的")}Qe=GIe(st),Q.current=Qe,Qe.addTool(_d.toolName),Qe.addTool(Ed.toolName),Qe.addTool(Dd.toolName),Qe.addTool(Rd.toolName),Qe.addTool(qc.toolName),Qe.addTool(Pd.toolName),Qe.addTool(Nd.toolName),Qe.addTool(Vd.toolName),Qe.addTool(Ad.toolName),Qe.addTool(Fd.toolName),Qe.addTool(Id.toolName),Qe.addTool(hf.toolName),Qe.addTool(Ud.toolName),Qe.addTool(ah.toolName),Qe.addTool(oh.toolName),Qe.addTool(Ld.toolName),Qe.addTool(kd.toolName),Qe.addTool(sh.toolName),Qe.addTool(lh.toolName),Qe.addTool(Xc.toolName),Qe.addTool(Bd.toolName),Qe.addTool(ch.toolName),Qe.addTool(uh.toolName),Qe.addTool(fh.toolName),Qe.addTool(pf.toolName),Qe.setToolActive(_d.toolName,{bindings:[{mouseButton:cg.Primary}]}),Qe.setToolActive(Ed.toolName,{bindings:[{mouseButton:cg.Auxiliary}]}),Qe.setToolActive(Dd.toolName,{bindings:[{mouseButton:cg.Secondary}]}),Qe.addViewport(ke,Je);let _t=[];if(x.length>0)_t=[x[y]];else if(g.files&&g.files.length>0){const Le=g.files.map(We=>`wadouri:${We.fresh_url}`);w(Le),_t=[Le[0]]}else _t=["wadouri:/3.dcm"];if(Pe!==re.current)return;await ze.setStack(_t),typeof ze.resetCamera=="function"&&ze.resetCamera();try{const Le=ze?.getCamera?.(),We=Le?.parallelScale;typeof We=="number"&&We>0&&(Ce.current=We,ze?.setCamera?.({...Le}))}catch{}if(Pe!==re.current)return;$e.render(),Y();try{const We=ze?.getCamera?.()?.parallelScale;typeof We=="number"&&We>0&&(Ce.current=We,A(1))}catch{}try{ye.current?.();const Le=$e,We=ze,xt=()=>{const tn=We?.getScale?.();if(typeof tn=="number"&&tn>0)return tn;const dn=We?.getCamera?.()?.parallelScale,sr=Ce.current;return typeof dn=="number"&&dn>0&&typeof sr=="number"&&sr>0?sr/dn:1},Ut=()=>{const tn=performance.now();if(me.current){const qe=tn-me.current;qe>0&&R(1e3/qe)}me.current=tn;const Ht=xt();!Number.isNaN(Ht)&&Number.isFinite(Ht)&&A(Ht);const dn=We?.getViewportOptions?.(),sr=dn?.voi?.windowWidth,Qn=dn?.voi?.windowCenter;typeof sr=="number"&&P(sr),typeof Qn=="number"&&U(Qn)},gn=()=>{const tn=xt();!Number.isNaN(tn)&&Number.isFinite(tn)&&A(tn)};try{const tn=vt||{},Ht=tn.VIEWPORT_RENDERED||"rendered",dn=tn.CAMERA_MODIFIED||"cameraModified",sr=tn.VOI_MODIFIED||"voiModified";We?.addEventListener?.(Ht,Ut),We?.addEventListener?.(dn,gn),We?.addEventListener?.(sr,Ut),Ut(),ye.current=()=>{try{We?.removeEventListener?.(Ht,Ut),We?.removeEventListener?.(dn,gn),We?.removeEventListener?.(sr,Ut)}catch{}}}catch{}}catch(Le){console.warn("绑定视口监听失败（可忽略）",Le)}try{if(_t.length>0){const Le=await eU(_t[0],$e);D(Le)}}catch(Le){console.warn("获取初始 DICOM 元数据失败:",Le),D(null)}G.length>0&&(console.log("🚀开始恢复标注数据..."),Ke(G),F([]))}catch(ne){console.error("加载 DICOM 文件失败:",ne),f("加载失败: "+ne.message)}finally{Pe===re.current&&o(!1)}},[u,g,x,y,Y]),ue=H.useCallback(Pe=>{if(Q.current)try{const ne=Q.current;if(Pe==="DeleteAnnotation"){fe();return}const Je=Re=>{try{ne.setToolPassive(Re.toolName)}catch{}};[_d,Ed,Dd,Rd,qc,Pd,Nd,Vd,Ad,Fd,Id,hf,Ud,ah,oh,Ld,kd,sh,lh,Xc,Bd,ch,uh,fh,pf].forEach(Je);const $e=[{mouseButton:cg.Primary}],ke=(Re,ze)=>{try{ne.setToolActive(Re.toolName,{bindings:ze})}catch{}};switch(Pe){case"WindowLevel":ke(_d,$e);break;case"Pan":ke(Ed,$e);break;case"Zoom":ke(Dd,$e);break;case"Length":ke(Rd,$e);break;case"RectangleROI":ke(qc,$e);break;case"EllipticalROI":ke(Pd,$e);break;case"CircleROI":ke(Nd,$e);break;case"ArrowAnnotate":ke(Vd,$e);break;case"Probe":ke(Ad,$e);break;case"Angle":ke(Fd,$e);break;case"Bidirectional":ke(Id,$e);break;case"PlanarFreehandROI":ke(hf,$e);break;case"CobbAngle":ke(Ud,$e);break;case"RectangleROIStartEndThreshold":ke(ah,$e);break;case"RectangleROIThreshold":ke(oh,$e);break;case"SplineROI":ke(Ld,$e);break;case"LivewireContour":ke(kd,$e);break;case"Magnify":ke(sh,$e);break;case"OverlayGrid":ke(lh,$e);break;case"AdvancedMagnify":ke(Xc,$e);break;case"UltrasoundDirectional":ke(Bd,$e);break;case"RectangleScissors":ke(ch,$e);break;case"CircleScissors":ke(uh,$e);break;case"SphereScissors":ke(fh,$e);break;case"Label":ke(pf,$e);break}p(Pe);try{X.current?.render?.()}catch{}console.log(`已切换到工具: ${Pe}`)}catch(ne){console.error("切换工具失败:",ne)}},[]),fe=H.useCallback(()=>{try{const Pe=bs;if(!Pe){Vt({color:"danger",description:"标注模块不可用"});return}let ne;try{ne=Pe.getSelectedAnnotation?.()?.annotationUID}catch{}if(!ne){let Je=[];const $e=Pe.getAllAnnotations?.();Array.isArray($e)?Je=$e.flat?$e.flat(2):$e:$e&&typeof $e=="object"&&Object.values($e).forEach(ze=>{Array.isArray(ze)&&Je.push(...ze)}),ne=Je.find(Re=>Re?.isSelected||Re?.isHighlighted||Re?.highlighted||Re?.selection?.isSelected)?.annotationUID}if(!ne){Vt({color:"warning",description:"请先选中要删除的标注"});return}Fe(ne)}catch(Pe){console.error("删除标注失败:",Pe),Vt({color:"danger",description:"删除标注失败"})}},[]),Se=H.useCallback(Pe=>{V(Pe)},[]),Fe=H.useCallback(Pe=>{try{bs?.removeAnnotation?(bs.removeAnnotation(Pe),console.log("标注已删除:",Pe),X.current&&X.current.render()):(console.warn("无法删除标注，API 不可用"),Vt({color:"danger",description:"删除标注失败"}))}catch(ne){console.error("删除标注失败:",ne),Vt({color:"danger",description:"删除标注失败"})}},[]),Ke=Pe=>{const ne=g.files||g.original_data?.files;try{let Je=ne.map(ke=>({name:ke.file_name,url:ke.fresh_url}));console.log("🚀恢复标注数据:",Je),Pe.map(ke=>(Je.map(Re=>{if(ke.metadata.referencedImageId.includes(Re.name)&&(ke.metadata.referencedImageId=`wadouri:${Re.url}`,JSON.stringify(ke.data.cachedStats)!=="{}")){let ze=Object.values(ke.data.cachedStats)[0];ke.data.cachedStats={[`imageId:wadouri:${Re.url}`]:ze}}}),ke)).forEach(ke=>{try{ke.metadata||(ke.metadata={toolName:ke.toolName||"Length",FrameOfReferenceUID:"default"}),ke.metadata.FrameOfReferenceUID||(ke.metadata.FrameOfReferenceUID="default"),ke.metadata.toolName||(ke.metadata.toolName=ke.toolName||"Length"),ke.data||(ke.data={points:ke.points||[],measurements:ke.measurements||{}}),console.log("🚀添加标注:",ke);const Re=bs.addAnnotation(ke,i.current);if(console.log(`🚀标注 ${Re} 已添加到状态`),i.current)try{bs.triggerAnnotationAddedForElement(ke,i.current),console.log("🚀已触发标注添加事件到元素")}catch(ze){console.warn("🚀触发标注添加事件失败:",ze)}try{const ze=ke?.data?.style?.color;ze&&Re&&(console.log("🚀 ~ data.forEach ~ savedColor:",ze),Tb.setAnnotationStyles(Re,{color:ze}))}catch{}console.log("🚀添加标注成功:",ke.annotationUID)}catch(Re){console.warn("🚀添加单个标注失败:",Re,ke)}}),X.current&&setTimeout(()=>{try{const ke=Q.current;if(ke){const ze=h;ze&&ze!=="DeleteAnnotation"&&ke.setToolActive(ze,{bindings:[{mouseButton:cg.Primary}]})}const Re=X.current.getViewport("CT_SAGITTAL_STACK");Re&&Re.render(),X.current.render(),console.log("🚀标注恢复完成，已强制重新渲染"),setTimeout(()=>{const ze=bs.getAllAnnotations();console.log("🚀恢复后的所有标注:",ze)},200)}catch(ke){console.warn("强制渲染失败:",ke)}},100)}catch(Je){console.error("🚀恢复标注数据失败:",Je)}},He=H.useCallback(()=>{if(X.current)try{const ne=X.current.getViewport("CT_SAGITTAL_STACK");if(ne){let Je;const $e=ne?.getScale?.();if(typeof $e=="number"&&$e>0)Je=$e;else{const ze=ne?.getCamera?.()?.parallelScale,st=Ce.current;typeof ze=="number"&&ze>0&&typeof st=="number"&&st>0&&(Je=st/ze)}typeof Je=="number"&&Number.isFinite(Je)&&A(Je);const ke=ne?.getViewportOptions?.();ke&&(typeof ke.voi?.windowWidth=="number"&&P(ke.voi.windowWidth),typeof ke.voi?.windowCenter=="number"&&U(ke.voi.windowCenter))}}catch(Pe){console.warn("更新监控参数失败:",Pe)}},[]);H.useEffect(()=>{u&&g&&!s&&setTimeout(()=>{re.current++,ie()},100)},[u,g,s,ie]),H.useEffect(()=>{const Pe=Je=>{if(!(a||x.length<=1))switch(Je.key){case"ArrowLeft":Je.preventDefault(),k();break;case"ArrowRight":Je.preventDefault(),J();break}},ne=Je=>{(Je.key==="Delete"||Je.key==="Backspace")&&(Je.preventDefault(),fe())};return window.addEventListener("keydown",Pe),window.addEventListener("keydown",ne),()=>{window.removeEventListener("keydown",Pe),window.removeEventListener("keydown",ne)}},[x.length,k,J,fe]);function pe(Pe){const ne=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(Pe);return ne?`rgb(${parseInt(ne[1],16)}, ${parseInt(ne[2],16)}, ${parseInt(ne[3],16)})`:Pe}H.useEffect(()=>{const Pe=()=>{if(X.current&&i.current)try{setTimeout(()=>{const ne=X.current;ne&&(ne.resize(!0),ne.render())},100)}catch(ne){console.warn("调整视口尺寸失败:",ne)}};return window.addEventListener("resize",Pe),u&&setTimeout(Pe,200),()=>{window.removeEventListener("resize",Pe)}},[u]),H.useEffect(()=>{if(!u||!X.current)return;const Pe=setInterval(()=>{He()},100);return()=>clearInterval(Pe)},[u,He]),H.useEffect(()=>{Q.current&&u&&Se($)},[$,u,Se]);const[ge,Ie]=H.useState({copy:!1,delete:!1}),ve=Pe=>"name"in Pe?Pe.name:"copy_name"in Pe?Pe.copy_name:"未知数据",_e=async()=>{if(!n?.user_id){Vt({color:"danger",description:"用户信息错误，请重新登录"});return}Ie(Pe=>({...Pe,copy:!0}));try{const Pe=await rGe({original_id:g.original_id,copy_name:`${ve(g)} - 复制`});Pe.success?Vt({color:"success",description:"复制成功！数据已添加到您的账户"}):Od.handleApiError(new Error(Pe.message),"复制失败")}catch(Pe){Od.handleApiError(Pe,"复制失败")}finally{Ie(Pe=>({...Pe,copy:!1}))}};return j.jsxs("div",{className:"h-screen flex flex-col",children:[j.jsx(aGe,{title:s?"DICOM 图像查看器":g?.name||g?.copy_name||"DICOM 图像查看器",isInitialized:!!u,isLoading:!!a,hasData:!!g,onBack:()=>e("/list"),onReload:ie,onCopyData:_e,onConsoleEditData:Ae,onClearData:De}),j.jsx(lGe,{isInitialized:!!u,activeTool:h,onSwitch:ue,annotationColor:$,onColorChange:Se}),j.jsx(cGe,{error:c,dataLoading:s,isInitialized:u}),j.jsx(uGe,{elementRef:i,isLoading:a,isInitialized:u,hasData:!!g,showSwitchHint:x.length>1}),j.jsx(fGe,{visible:!!g,isLoading:a,imageCount:x.length,currentIndex:y,expanded:S,onToggleExpanded:()=>T(!S),onPrev:k,onNext:J,onJump:Pe=>q(Pe),currentFileName:g?.files?.[y]?.file_name||g?.original_data?.files?.[y]?.file_name,currentFile:g?.files?.[y]||g?.original_data?.files?.[y],dicomMetadata:_}),j.jsx(Yme,{currentImageIndex:y+1,totalImages:x.length,frameRate:I,zoom:M,windowWidth:L,windowCenter:B,isVisible:!!g&&u})]})}const hGe=()=>{const t=bc(),{setAccessToken:e}=Bf(),[n,r]=H.useState(""),[i,a]=H.useState(""),[o,s]=H.useState(!1),l=f=>{f.key==="Enter"&&!o&&c()},c=async()=>{if(!n||!i){Vt({color:"danger",description:"请输入邮箱和密码"});return}s(!0);try{const f=await Ope({email:n,password:i});f.success&&f.data?.access_token?(Vt({color:"success",description:"登录成功"}),e(f.data.access_token),t("/list")):Vt({color:"danger",description:f.message})}catch{Vt({color:"danger",description:"登录失败，请重试"})}finally{s(!1)}};return j.jsxs("div",{className:"space-y-6",children:[j.jsxs("div",{children:[j.jsx("div",{className:"block text-sm font-medium text-white mb-2",children:"用户"}),j.jsx("input",{type:"email",value:n,onChange:f=>r(f.target.value),onKeyPress:l,className:"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"请输入用户",disabled:o})]}),j.jsxs("div",{children:[j.jsx("div",{className:"block text-sm font-medium text-white mb-2",children:"密码"}),j.jsx("input",{type:"password",value:i,onChange:f=>a(f.target.value),onKeyPress:l,className:"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"请输入密码",disabled:o})]}),j.jsx("div",{onClick:c,className:`flex items-center cursor-pointer justify-center w-full font-medium py-3 px-4 rounded-lg transition-colors duration-200 ${o?"bg-gray-600 text-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 text-white"}`,children:o?"登录中...":"登录"})]})},pGe=async t=>(await Ko.post("/register/check-email",t)).data,gGe=async t=>(await Ko.post("/register/send-code",t)).data,mGe=async t=>(await Ko.post("/register/verify-code",t)).data,vGe=async t=>(await Ko.post("/register/submit",t)).data,yGe=({onRegisterSuccess:t})=>{const[e,n]=H.useState(1),[r,i]=H.useState(""),[a,o]=H.useState(""),[s,l]=H.useState(!1),[c,f]=H.useState(!1),[u,d]=H.useState(!1),[h,p]=H.useState(""),[g,m]=H.useState(0),[y,v]=H.useState(""),[x,w]=H.useState(""),[S,T]=H.useState(""),[_,D]=H.useState(!1);H.useEffect(()=>{let B;return g>0&&(B=setTimeout(()=>{m(g-1)},1e3)),()=>{B&&clearTimeout(B)}},[g]);const I=B=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(B),R=async()=>{if(!I(r)){Vt({color:"danger",description:"请输入有效的邮箱地址"});return}f(!0);try{const B=await pGe({email:r});if(B.success&&B.data?.exists){Vt({color:"danger",description:"该邮箱已被注册，请使用其他邮箱"}),f(!1);return}const U=await gGe({email:r,name:y||"User",password:x||"temp123"});U.success?(Vt({color:"success",description:U.data?.message||"验证码已发送"}),l(!0),m(60)):Vt({color:"danger",description:U.message||"发送验证码失败"})}catch{Vt({color:"danger",description:"发送验证码失败，请重试"})}finally{f(!1)}},M=async()=>{if(!a||a.length!==6){Vt({color:"danger",description:"请输入6位验证码"});return}d(!0);try{const B=await mGe({email:r,code:a});B.success&&(B.data?.verification_token||B.data?.verified)?(Vt({color:"success",description:B.message||"邮箱验证成功"}),p(B.data?.verification_token||`verified_${r}`),n(2)):Vt({color:"danger",description:B.message||"验证码错误"})}catch{Vt({color:"danger",description:"验证失败，请重试"})}finally{d(!1)}},A=async()=>{if(!y||y.length<3){Vt({color:"danger",description:"用户名至少需要3个字符"});return}if(!x||x.length<6){Vt({color:"danger",description:"密码至少需要6个字符"});return}if(x!==S){Vt({color:"danger",description:"两次输入的密码不一致"});return}D(!0);try{const B=await vGe({email:r,username:y,password:x,password_confirmation:S,code:a});B.success?(Vt({color:"success",description:"注册成功，请登录"}),n(1),i(""),o(""),l(!1),m(0),p(""),v(""),w(""),T(""),t()):Vt({color:"danger",description:B.message||"注册失败"})}catch{Vt({color:"danger",description:"注册失败，请重试"})}finally{D(!1)}},L=B=>{B.key==="Enter"&&(e===1?s?M():R():A())},P=()=>{n(1),l(!1),o(""),m(0),p("")};return j.jsxs("div",{className:"space-y-6",children:[j.jsx("div",{className:"flex items-center justify-center mb-6",children:j.jsxs("div",{className:"flex items-center space-x-4",children:[j.jsx("div",{className:`flex items-center justify-center w-8 h-8 rounded-full text-sm font-medium ${e===1?"bg-blue-600 text-white":"bg-green-600 text-white"}`,children:"1"}),j.jsx("div",{className:"w-16 h-0.5 bg-gray-600"}),j.jsx("div",{className:`flex items-center justify-center w-8 h-8 rounded-full text-sm font-medium ${e===2?"bg-blue-600 text-white":"bg-gray-600 text-gray-400"}`,children:"2"})]})}),j.jsxs("div",{className:"text-center",children:[j.jsx("h3",{className:"text-lg font-medium text-white",children:e===1?"邮箱验证":"设置用户信息"}),j.jsx("p",{className:"text-sm text-gray-400 mt-1",children:e===1?"请输入邮箱地址并验证":"请设置您的用户名和密码"})]}),e===1?j.jsxs(j.Fragment,{children:[j.jsxs("div",{children:[j.jsx("div",{className:"block text-sm font-medium text-white mb-2",children:"邮箱"}),j.jsxs("div",{className:"flex space-x-2",children:[j.jsx("input",{type:"email",value:r,onChange:B=>i(B.target.value),onKeyPress:L,className:"flex-1 px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"请输入邮箱地址",disabled:c||s}),j.jsx("div",{onClick:s?void 0:R,className:`px-4 py-3 rounded-lg font-medium transition-colors duration-200 whitespace-nowrap ${c?"bg-gray-600 text-gray-400 cursor-not-allowed":s?"bg-green-600 text-white cursor-default":"bg-blue-600 hover:bg-blue-700 text-white cursor-pointer"}`,children:c?"发送中...":s?"已发送":"获取验证码"})]})]}),s&&j.jsxs("div",{children:[j.jsx("div",{className:"block text-sm font-medium text-white mb-2",children:"验证码"}),j.jsx("input",{type:"text",value:a,onChange:B=>o(B.target.value.replace(/\D/g,"").slice(0,6)),onKeyPress:L,className:"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-center text-lg tracking-widest",placeholder:"请输入6位验证码",maxLength:6,disabled:u})]}),s&&j.jsxs("div",{className:"flex space-x-3",children:[j.jsx("div",{onClick:()=>{g===0&&(l(!1),o(""),R())},className:`flex-1 flex items-center justify-center py-3 px-4 font-medium rounded-lg transition-colors duration-200 ${g>0?"bg-gray-600 text-gray-400 cursor-not-allowed":"bg-gray-600 hover:bg-gray-700 text-white cursor-pointer"}`,children:g>0?`重新发送(${g}s)`:"重新发送"}),j.jsx("div",{onClick:M,className:`flex-1 flex items-center justify-center font-medium py-3 px-4 rounded-lg transition-colors duration-200 ${u?"bg-gray-600 text-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 text-white cursor-pointer"}`,children:u?"验证中...":"验证"})]})]}):j.jsxs(j.Fragment,{children:[j.jsxs("div",{children:[j.jsx("div",{className:"block text-sm font-medium text-white mb-2",children:"用户名"}),j.jsx("input",{type:"text",value:y,onChange:B=>v(B.target.value),onKeyPress:L,className:"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"请输入用户名（至少3个字符）",disabled:_})]}),j.jsxs("div",{children:[j.jsx("div",{className:"block text-sm font-medium text-white mb-2",children:"密码"}),j.jsx("input",{type:"password",value:x,onChange:B=>w(B.target.value),onKeyPress:L,className:"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"请输入密码（至少6个字符）",disabled:_})]}),j.jsxs("div",{children:[j.jsx("div",{className:"block text-sm font-medium text-white mb-2",children:"确认密码"}),j.jsx("input",{type:"password",value:S,onChange:B=>T(B.target.value),onKeyPress:L,className:"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"请再次输入密码",disabled:_})]}),j.jsxs("div",{className:"flex space-x-3",children:[j.jsx("div",{onClick:P,className:"flex-1 flex items-center justify-center py-3 px-4 bg-gray-600 hover:bg-gray-700 text-white font-medium rounded-lg cursor-pointer transition-colors duration-200",children:"返回上一步"}),j.jsx("div",{onClick:A,className:`flex-1 flex items-center justify-center font-medium py-3 px-4 rounded-lg transition-colors duration-200 ${_?"bg-gray-600 text-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 text-white cursor-pointer"}`,children:_?"注册中...":"完成注册"})]})]})]})};function xGe(){const[t,e]=H.useState(!1),n=()=>{e(!1)};return j.jsx("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center",children:j.jsxs("div",{className:"max-w-xl w-full mx-auto p-8",children:[j.jsx("div",{className:"text-center mb-4",children:j.jsx("h1",{className:"text-3xl font-bold text-white",children:"智慧诊疗 v1.5"})}),j.jsxs("div",{className:"bg-gray-800 rounded-lg p-6",children:[j.jsxs("div",{className:"flex mb-6",children:[j.jsx("button",{onClick:()=>e(!1),className:`flex-1 py-2 px-4 cursor-pointer text-sm font-medium rounded-l-lg transition-colors ${t?"bg-gray-700 text-gray-300 hover:bg-gray-600":"bg-blue-600 text-white"}`,children:"登录"}),j.jsx("button",{onClick:()=>e(!0),className:`flex-1 py-2 px-4 cursor-pointer text-sm font-medium rounded-r-lg transition-colors ${t?"bg-blue-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,children:"注册"})]}),t?j.jsx(yGe,{onRegisterSuccess:n}):j.jsx(hGe,{})]})]})})}const bGe=()=>{const t=bc(),{userInfo:e}=Bf();return H.useEffect(()=>{e&&e?.role!==1&&(Vt({color:"danger",description:"您没有权限访问管理端"}),t("/list"))},[e,t]),{isAdmin:e?.role===1,userInfo:e}},wGe=({students:t,loading:e,onRoleChange:n,onResetPassword:r})=>{const i=o=>{switch(o){case 1:return"bg-red-500 text-white";case 2:return"bg-blue-500 text-white";case 3:return"bg-green-500 text-white";default:return"bg-gray-500 text-white"}},a=o=>{switch(o){case 1:return"管理员";case 2:return"老师";case 3:return"学生";default:return"未知"}};return e?j.jsx("div",{className:"p-6 text-center",children:j.jsx("div",{className:"text-gray-500",children:"加载中..."})}):j.jsxs("div",{className:"overflow-x-auto",children:[j.jsxs("table",{className:"w-full",children:[j.jsx("thead",{className:"bg-gray-50",children:j.jsxs("tr",{children:[j.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"用户信息"}),j.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"邮箱"}),j.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"角色"}),j.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"创建时间"}),j.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"操作"})]})}),j.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t?.map(o=>j.jsxs("tr",{className:"hover:bg-gray-50",children:[j.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:j.jsxs("div",{className:"flex items-center",children:[j.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center",children:j.jsx("span",{className:"text-white text-sm font-semibold",children:o.username.charAt(0)})}),j.jsxs("div",{className:"ml-4",children:[j.jsx("div",{className:"text-sm font-medium text-gray-900",children:o.username}),j.jsxs("div",{className:"text-sm text-gray-500",children:["ID: ",o.user_id]})]})]})}),j.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:j.jsx("div",{className:"text-sm text-gray-900",children:o.email})}),j.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:j.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${i(o.role)}`,children:a(o.role)})}),j.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(o.created_at).toLocaleDateString()}),j.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:j.jsxs("div",{className:"flex items-center space-x-2",children:[j.jsx("button",{onClick:()=>n?.(o.user_id,2),className:"px-3 py-1 bg-blue-500 text-white text-xs rounded-md hover:bg-blue-600 transition-colors",children:"设为老师"}),j.jsx("button",{onClick:()=>r?.(o.user_id),className:"px-3 py-1 bg-yellow-500 text-white text-xs rounded-md hover:bg-yellow-600 transition-colors",children:"重置密码"})]})})]},o.user_id))})]}),(!t||t.length===0)&&j.jsx("div",{className:"p-6 text-center text-gray-500",children:"暂无学生用户"})]})},CGe=()=>{const{isAdmin:t}=bGe(),[e,n]=H.useState([]),[r,i]=H.useState(!0),[a,o]=H.useState(""),[s,l]=H.useState("all"),[c,f]=H.useState(1),[u]=H.useState(10),[d,h]=H.useState(0),[p,g]=H.useState(0);if(!t)return j.jsx("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:j.jsx("div",{className:"text-center",children:j.jsx("div",{className:"text-gray-500",children:"检查权限中..."})})});const m=async(S=a,T=s,_=c)=>{i(!0);try{const D={page:_,per_page:u};S&&(D.keyword=S);const I=await Jme(D);console.log("API Response:",I),I.success&&I.data?(n(I.data.list||[]),h(I.data.pagination.total||0),g(I.data.pagination.last_page||0),f(I.data.pagination.current_page||1)):(n([]),h(0),g(0),Vt({color:"danger",description:I.message||"获取学生用户列表失败"}))}catch{n([]),h(0),g(0),Vt({color:"danger",description:"网络错误，请重试"})}finally{i(!1)}},y=S=>{o(S),f(1)},v=S=>{f(S)},x=async(S,T)=>{try{const _=await Zme(S,T);_.success?(Vt({color:"success",description:`用户 ${_.data.username} 的角色已从 ${_.data.old_role_name} 修改为 ${_.data.new_role_name}`}),m()):Vt({color:"danger",description:_.message||"权限更新失败"})}catch{Vt({color:"danger",description:"网络错误，请重试"})}},w=async S=>{if(confirm(`确定要重置用户 ID: ${S} 的密码吗？`))try{const T=await Qme(S);T.success?(Vt({color:"success",description:"密码重置成功"}),alert(`用户 ${T.data.username} (${T.data.email}) 的密码已重置为: ${T.data.new_password}`)):Vt({color:"danger",description:T.message||"密码重置失败"})}catch{Vt({color:"danger",description:"密码重置失败，请重试"})}};return H.useEffect(()=>{const S=setTimeout(()=>{m(a,s,c)},300);return()=>clearTimeout(S)},[a,s,c]),j.jsx("div",{className:"min-h-screen bg-gray-100 p-6",children:j.jsxs("div",{className:"max-w-7xl mx-auto",children:[j.jsx("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:j.jsx("div",{className:"flex flex-col md:flex-row gap-4",children:j.jsxs("div",{className:"flex-1",children:[j.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"搜索用户"}),j.jsx("input",{type:"text",value:a,onChange:S=>y(S.target.value),className:"w-full px-4 outline-none py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"输入关键词搜索用户..."})]})})}),j.jsxs("div",{className:"bg-white rounded-lg shadow",children:[j.jsx("div",{className:"p-6 border-b border-gray-200",children:j.jsxs("h2",{className:"text-lg font-semibold text-gray-800",children:["学生用户列表 (",d,")"]})}),j.jsx(wGe,{students:e,loading:r,onRoleChange:x,onResetPassword:w}),!r&&j.jsx("div",{className:"flex flex-col sm:flex-row justify-center items-center px-6 py-5 border-t border-gray-200",children:j.jsx(Nw,{total:p,page:c,onChange:v,showControls:!0,size:"md",color:"primary",variant:"flat",radius:"md",classNames:{wrapper:"gap-4 overflow-visible h-12",item:"w-12 h-12 text-base cursor-pointer",cursor:"w-12 h-12 text-base cursor-pointer",prev:"w-12 h-12 text-base cursor-pointer",next:"w-12 h-12 text-base cursor-pointer",ellipsis:"w-12 h-12 text-base cursor-pointer"}})})]})]})})};function SGe(){const t=bc(),{userInfo:e,canUpload:n}=lp(),r=H.useRef(null),[i,a]=H.useState(""),[o,s]=H.useState("1"),[l,c]=H.useState([]),[f,u]=H.useState(""),[d,h]=H.useState([]),[p,g]=H.useState(!1),[m,y]=H.useState(!1),[v,x]=H.useState(null),w=async()=>{try{const F=await e1e();F.success?x(!0):(x(!1),Vt({color:"warning",description:F.message||"OSS连接异常"}))}catch{x(!1),Vt({color:"danger",description:"OSS连接检查失败"})}};H.useEffect(()=>{n&&(console.log("canUpload",n),w())},[n]);const S=F=>{if(!F)return;const $=Array.from(F).filter(Q=>Q.name.toLowerCase().endsWith(".dcm")||Q.name.toLowerCase().endsWith(".dicom"));if($.length===0){Vt({color:"warning",description:"请选择有效的 DICOM 文件（.dcm 或 .dicom 格式）"});return}const V=$.filter(Q=>Q.size>10*1024*1024);if(V.length>0){Vt({color:"danger",description:`以下文件超过1MB限制：${V.map(Q=>Q.name).join(", ")}`});return}const X=$.map(Q=>({file:Q,id:`${Date.now()}-${Math.random()}`,status:"pending"}));h(Q=>[...Q,...X]),X.forEach(Q=>M(Q))},T=F=>{F.preventDefault(),F.stopPropagation(),F.type==="dragenter"||F.type==="dragover"?y(!0):F.type==="dragleave"&&y(!1)},_=F=>{F.preventDefault(),F.stopPropagation(),y(!1),F.dataTransfer.files&&F.dataTransfer.files[0]&&S(F.dataTransfer.files)},D=[{key:"1",label:"X光影像"},{key:"2",label:"CT"},{key:"3",label:"MRI"},{key:"4",label:"超声"},{key:"5",label:"PET"},{key:"6",label:"病理图像"}],I=()=>{f.trim()&&!l.includes(f.trim())&&l.length<3&&(c([...l,f.trim()]),u(""))},R=F=>{c(l.filter($=>$!==F))},M=async F=>{h($=>$.map(V=>V.id===F.id?{...V,status:"uploading"}:V));try{const $=await t1e(F.file);if($.success)h(V=>V.map(X=>X.id===F.id?{...X,status:"success",uploadedUrl:$.file_url,uploadedData:$}:X));else throw new Error("上传失败")}catch($){h(V=>V.map(X=>X.id===F.id?{...X,status:"error"}:X)),Vt({color:"danger",description:`文件 ${F.file.name} 上传失败: ${$ instanceof Error?$.message:"未知错误"}`})}},A=async()=>{if(!i.trim()){Vt({color:"danger",description:"请输入数据集名称"});return}if(!o){Vt({color:"danger",description:"请选择大分类"});return}if(d.length===0){Vt({color:"danger",description:"请选择要上传的文件"});return}if(d.filter(V=>V.status==="uploading").length>0){Vt({color:"warning",description:"有文件正在上传中，请等待上传完成"});return}if(d.filter(V=>V.status==="error").length>0){Vt({color:"danger",description:"有文件上传失败，请重新上传或删除失败的文件"});return}if(!e?.user_id){Vt({color:"danger",description:"用户信息错误，请重新登录"});return}v===!1&&Vt({color:"warning",description:"OSS连接异常，但仍可尝试提交"}),g(!0);try{const V=d.filter(me=>me.status==="success");if(V.length===0){Vt({color:"danger",description:"没有成功上传的文件"});return}if(V.filter(me=>!me.uploadedData).length>0){Vt({color:"danger",description:"有文件上传数据不完整，请重新上传"});return}const Q=Number(o),re={name:i,category:Q,remark:l.join(","),files:V.map(me=>({file_name:me.uploadedData.file_name,file_path:me.uploadedData.file_path,file_url:me.uploadedData.file_url,file_size:me.uploadedData.file_size,original_annotation:""}))};console.log("🚀 ~ handleSubmit ~ str:",re);const ye=await tGe(re);ye.success?(Vt({color:"success",description:"数据集创建成功！已可供学生使用"}),setTimeout(()=>{t("/list")},2e3)):Vt({color:"danger",description:ye.message||"数据集创建失败"})}catch(V){console.error("提交错误:",V),Vt({color:"danger",description:"网络错误，请重试"})}finally{g(!1)}},L=F=>{p||h($=>$.filter(V=>V.id!==F))},P=()=>{p||h([])},B=F=>{if(F===0)return"0 Bytes";const $=1024,V=["Bytes","KB","MB","GB"],X=Math.floor(Math.log(F)/Math.log($));return parseFloat((F/Math.pow($,X)).toFixed(2))+" "+V[X]},U=F=>{switch(F){case"pending":return"default";case"uploading":return"primary";case"success":return"success";case"error":return"danger";default:return"default"}},G=F=>{switch(F){case"pending":return"等待上传";case"uploading":return"上传中";case"success":return"上传成功";case"error":return"上传失败";default:return"未知状态"}};return j.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 p-4 sm:p-6",children:j.jsxs("div",{className:"max-w-6xl mx-auto",children:[j.jsxs("div",{className:"mb-8",children:[j.jsxs("div",{className:"text-center mb-8",children:[j.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full mb-4",children:j.jsx("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:j.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})})}),j.jsx("h1",{className:"text-4xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent mb-3",children:"上传 DICOM 数据集"})]}),j.jsx(Zc,{className:"mb-8 shadow-lg border-0 bg-white/80 backdrop-blur-sm",children:j.jsx(Jc,{className:"py-4",children:j.jsxs("div",{className:"flex items-center justify-between",children:[j.jsx("div",{className:"flex items-center space-x-4",children:j.jsxs("div",{className:"flex items-center space-x-3",children:[j.jsx("div",{className:`w-4 h-4 rounded-full shadow-sm ${v===!0?"bg-green-500 animate-pulse":v===!1?"bg-red-500":"bg-yellow-500 animate-pulse"}`}),j.jsxs("span",{className:"text-sm font-semibold text-gray-700",children:["OSS存储状态：",v===!0&&j.jsx("span",{className:"text-green-600 ml-2 font-medium",children:"✓ 连接正常"}),v===!1&&j.jsx("span",{className:"text-red-600 ml-2 font-medium",children:"✗ 连接异常"}),v===null&&j.jsx("span",{className:"text-yellow-600 ml-2 font-medium",children:"⏳ 检查中..."})]})]})}),j.jsx(zr,{size:"sm",variant:"flat",color:"primary",onClick:w,isLoading:v===null,className:"shadow-md hover:shadow-lg transition-all duration-200","aria-label":"重新检测OSS连接状态",children:"重新检测"})]})})})]}),j.jsxs("div",{className:"grid gap-8 lg:grid-cols-2",children:[j.jsx("div",{className:"space-y-6",children:j.jsxs(Zc,{className:"shadow-lg border-0 bg-white/90 backdrop-blur-sm hover:shadow-xl transition-all duration-300",children:[j.jsx(YE,{className:"pb-4",children:j.jsxs("div",{className:"flex items-center space-x-3",children:[j.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-purple-600 rounded-lg flex items-center justify-center",children:j.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:j.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),j.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"数据集信息"})]})}),j.jsxs(Jc,{className:"space-y-6",children:[j.jsxs("div",{className:"space-y-2",children:[j.jsxs("label",{className:"text-sm font-medium text-gray-700",htmlFor:"dataset-name",children:["数据集名称 ",j.jsx("span",{className:"text-red-500",children:"*"})]}),j.jsx(d2,{id:"dataset-name",placeholder:"请输入数据集名称，例如：胸部CT影像-案例01",value:i,onValueChange:a,variant:"bordered","aria-label":"数据集名称"}),j.jsx("p",{className:"text-xs text-gray-500",children:"给您的数据集起一个清晰、描述性的名称"})]}),j.jsxs("div",{className:"space-y-2",children:[j.jsxs("label",{className:"text-sm font-medium text-gray-700",htmlFor:"image-type",children:["医学影像类型 ",j.jsx("span",{className:"text-red-500",children:"*"})]}),j.jsx(RW,{id:"image-type",placeholder:"请选择医学影像类型",selectedKeys:o?[o]:[],onSelectionChange:F=>{const $=Array.from(F)[0];s($||"")},variant:"bordered","aria-label":"医学影像类型",classNames:{trigger:"min-h-12",value:"text-foreground"},children:D.map(F=>j.jsx(DW,{children:F.label},F.key))}),j.jsx("p",{className:"text-xs text-gray-500",children:"选择此数据集的医学影像类型"})]}),j.jsx("div",{className:"space-y-3",children:j.jsxs("div",{className:"space-y-2",children:[j.jsxs("label",{className:"text-sm font-medium text-gray-700",htmlFor:"tag-input",children:["添加标签 ",j.jsx("span",{className:"text-gray-400",children:"(可选)"})]}),j.jsxs("div",{className:"flex items-center space-x-2",children:[j.jsx(d2,{id:"tag-input",placeholder:"输入标签名称",value:f,onValueChange:u,onKeyDown:F=>{F.key==="Enter"&&(F.preventDefault(),I())},variant:"bordered",className:"flex-1","aria-label":"添加标签"}),j.jsx(zr,{size:"lg",color:"primary",variant:"flat",onClick:I,isDisabled:!f.trim()||l.length>=3,"aria-label":"添加标签到列表",children:"添加"})]}),j.jsxs("p",{className:"text-xs text-gray-500",children:["最多可添加3个标签，当前已添加",l.length,"个 (可选)"]})]})}),l.length>0&&j.jsx("div",{className:"flex flex-wrap gap-2",children:l.map(F=>j.jsx(f2,{color:"primary",variant:"flat",onClose:()=>R(F),children:F},F))})]})]})}),j.jsx("div",{className:"space-y-6",children:j.jsxs(Zc,{className:"shadow-lg border-0 bg-white/90 backdrop-blur-sm hover:shadow-xl transition-all duration-300",children:[j.jsx(YE,{className:"pb-4",children:j.jsxs("div",{className:"flex justify-between items-center w-full",children:[j.jsxs("div",{className:"flex items-center space-x-3",children:[j.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-green-500 to-blue-600 rounded-lg flex items-center justify-center",children:j.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:j.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})})}),j.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"文件上传"})]}),d.length>0&&j.jsx(zr,{size:"sm",color:"danger",variant:"flat",onClick:P,isDisabled:p,className:"shadow-md hover:shadow-lg transition-all duration-200","aria-label":"清空所有已选择的文件",children:"清空所有文件"})]})}),j.jsxs(Jc,{children:[j.jsx("div",{className:`border-2 border-dashed rounded-xl p-8 text-center transition-all duration-300 ${m?"border-blue-500 bg-blue-50 shadow-lg scale-105":d.length===0?"border-gray-300 hover:border-blue-400 hover:bg-blue-50/50":"border-gray-200 bg-gray-50"}`,onDragEnter:T,onDragLeave:T,onDragOver:T,onDrop:_,children:j.jsxs("div",{className:"space-y-6",children:[j.jsx("div",{className:`mx-auto w-20 h-20 rounded-full flex items-center justify-center transition-all duration-300 ${m?"bg-gradient-to-r from-blue-500 to-purple-600 scale-110":"bg-gradient-to-r from-gray-100 to-gray-200"}`,children:j.jsx("svg",{className:`w-10 h-10 transition-all duration-300 ${m?"text-white":"text-gray-400"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:j.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})})}),j.jsxs("div",{children:[j.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-3",children:m?"放开以选择文件":"选择 DICOM 文件"}),j.jsxs("p",{className:"text-gray-600 mb-6 leading-relaxed",children:["支持"," ",j.jsx("span",{className:"font-semibold text-blue-600",children:".dcm"})," ","和"," ",j.jsx("span",{className:"font-semibold text-blue-600",children:".dicom"})," ","格式",j.jsx("br",{}),"可选择多个文件，单个文件大小不超过 10MB"]}),j.jsx(zr,{color:"primary",size:"lg",onClick:()=>r.current?.click(),isDisabled:p,className:"shadow-lg hover:shadow-xl transition-all duration-200 bg-gradient-to-r from-blue-500 to-purple-600","aria-label":"选择DICOM文件上传",startContent:j.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:j.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),children:"选择文件"}),j.jsx("p",{className:"text-sm text-gray-500 mt-4 font-medium",children:"💡 或拖拽文件到此区域"})]})]})}),j.jsx("input",{ref:r,type:"file",multiple:!0,accept:".dcm,.dicom",onChange:F=>S(F.target.files),className:"hidden","aria-label":"选择DICOM文件上传"}),d.length>0&&j.jsxs("div",{className:"mt-8",children:[j.jsxs("div",{className:"flex justify-between items-center mb-6",children:[j.jsxs("div",{className:"flex items-center space-x-3",children:[j.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-green-500 to-blue-600 rounded-lg flex items-center justify-center",children:j.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:j.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),j.jsxs("h3",{className:"text-lg font-bold text-gray-800",children:["已选择的文件 (",d.length,")"]})]}),j.jsxs("div",{className:"text-sm font-semibold text-gray-600 bg-gray-100 px-3 py-1 rounded-full",children:["总大小:"," ",B(d.reduce((F,$)=>F+$.file.size,0))]})]}),j.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:d.map(F=>j.jsx(Zc,{className:"border border-gray-200 shadow-sm hover:shadow-md transition-all duration-200 bg-white/80 backdrop-blur-sm",children:j.jsx(Jc,{className:"p-2",children:j.jsxs("div",{className:"flex items-center justify-between",children:[j.jsxs("div",{className:"flex-1 min-w-0",children:[j.jsxs("div",{className:"flex items-center space-x-3",children:[j.jsx("div",{className:"w-6 h-6 bg-primary-100 rounded-md flex items-center justify-center",children:j.jsx("svg",{className:"w-3 h-3 text-primary-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:j.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),j.jsxs("div",{children:[j.jsx("p",{className:"text-xs font-medium text-gray-900 truncate",children:F.file.name}),j.jsx("p",{className:"text-xs text-gray-500",children:B(F.file.size)})]})]}),F.status==="uploading"&&j.jsx("div",{className:"mt-1",children:j.jsxs("div",{className:"flex items-center space-x-1",children:[j.jsx("div",{className:"w-3 h-3 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"}),j.jsx("span",{className:"text-xs text-blue-600",children:"上传中..."})]})})]}),j.jsxs("div",{className:"flex items-center space-x-1",children:[j.jsx(f2,{color:U(F.status),size:"sm",variant:"flat",children:G(F.status)}),F.status==="pending"&&j.jsx(zr,{size:"sm",color:"danger",variant:"light",onClick:()=>L(F.id),isDisabled:p,isIconOnly:!0,"aria-label":`删除文件 ${F.file.name}`,children:j.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:j.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}),F.status==="error"&&j.jsxs("div",{className:"flex space-x-0.5",children:[j.jsx(zr,{size:"sm",color:"primary",variant:"flat",onClick:()=>M(F),isDisabled:p,isIconOnly:!0,"aria-label":`重新上传文件 ${F.file.name}`,children:j.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:j.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),j.jsx(zr,{size:"sm",color:"danger",variant:"light",onClick:()=>L(F.id),isDisabled:p,isIconOnly:!0,"aria-label":`删除文件 ${F.file.name}`,children:j.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:j.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]})]})})},F.id))})]})]})]})})]}),j.jsx(Zc,{className:"mt-8 shadow-xl border-0 bg-white/90 backdrop-blur-sm",children:j.jsx(Jc,{className:"p-6",children:j.jsxs("div",{className:"flex flex-col space-y-6",children:[p&&j.jsx("div",{className:"p-6 bg-gradient-to-r from-blue-50 to-purple-50 border border-blue-200 rounded-xl shadow-lg",children:j.jsxs("div",{className:"flex items-center space-x-4",children:[j.jsx("div",{className:"w-6 h-6 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"}),j.jsxs("div",{children:[j.jsx("p",{className:"text-sm font-bold text-blue-800",children:"🚀 正在创建数据集，请不要关闭页面..."}),j.jsx("p",{className:"text-xs text-blue-600 mt-2",children:"创建完成后您可以在列表中查看，学生也可以访问此数据集"})]})]})}),v===!1&&!p&&j.jsx("div",{className:"p-6 bg-gradient-to-r from-yellow-50 to-orange-50 border border-yellow-200 rounded-xl shadow-lg",children:j.jsxs("div",{className:"flex items-center space-x-4",children:[j.jsx("div",{className:"w-10 h-10 bg-yellow-100 rounded-full flex items-center justify-center",children:j.jsx("svg",{className:"w-5 h-5 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:j.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),j.jsxs("div",{children:[j.jsx("p",{className:"text-sm font-bold text-yellow-800",children:"⚠️ OSS连接异常，但仍可尝试创建数据集"}),j.jsx("p",{className:"text-xs text-yellow-600 mt-2",children:"请检查网络连接或联系管理员"})]})]})}),j.jsxs("div",{className:"flex justify-between items-center",children:[j.jsx(zr,{color:"default",variant:"flat",onClick:()=>t("/list"),isDisabled:p,className:"shadow-md hover:shadow-lg transition-all duration-200","aria-label":"返回数据集列表页面",children:"← 返回列表"}),j.jsx(zr,{color:"primary",size:"lg",onClick:A,isLoading:p,isDisabled:!i.trim()||!o||d.length===0||p||d.length>0&&d[0].status==="uploading"||d.length>0&&d[0].status==="error",className:"shadow-lg hover:shadow-xl transition-all duration-200 bg-gradient-to-r from-blue-500 to-purple-600","aria-label":p?"正在创建数据集":"创建数据集",startContent:!p&&j.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:j.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),children:p?"🚀 创建中...":"✨ 创建数据集"})]})]})})})]})})}function TGe(){const t=bc(),{id:e}=hU(),{hasTeacherPermission:n}=lp(),{userInfo:r}=Bf(),[i,a]=H.useState(null),[o,s]=H.useState(!0),[l,c]=H.useState(!1),[f,u]=H.useState(""),[d,h]=H.useState(""),[p,g]=H.useState([]),[m,y]=H.useState("");H.useEffect(()=>{if(!n){Vt({color:"danger",description:"您没有权限访问此页面"}),t("/list");return}},[n,t]);const v=[{key:"1",label:"X光影像"},{key:"2",label:"CT"},{key:"3",label:"MRI"},{key:"4",label:"超声"},{key:"5",label:"PET"},{key:"6",label:"病理图像"}];H.useEffect(()=>{(async()=>{if(!e){Vt({color:"danger",description:"数据ID无效"}),t("/list");return}s(!0);try{const _=await Ume(Number(e));if(_.success&&_.data){const D=_.data;a(D),u(D.name),h(D.category?.toString()||"1");const I=D.remark?D.remark.split(",").filter(R=>R.trim()):[];g(I)}else Vt({color:"danger",description:_.message||"加载数据失败"}),t("/list")}catch(_){console.error("加载数据错误:",_),Vt({color:"danger",description:"加载数据失败"}),t("/list")}finally{s(!1)}})()},[e,t]);const x=()=>{m.trim()&&!p.includes(m.trim())&&p.length<3&&(g([...p,m.trim()]),y(""))},w=T=>{g(p.filter(_=>_!==T))},S=async()=>{if(!f.trim()){Vt({color:"danger",description:"请输入数据集名称"});return}if(!d){Vt({color:"danger",description:"请选择分类"});return}if(!e||!r){Vt({color:"danger",description:"缺少必要参数"});return}c(!0);try{const T=Number(d),_=await Bme(Number(e),{name:f.trim(),category:T,remark:p.join(",")});_.success?(Vt({color:"success",description:"保存成功"}),t("/list")):Vt({color:"danger",description:_.message||"保存失败"})}catch(T){console.error("保存错误:",T),Vt({color:"danger",description:"保存失败，请重试"})}finally{c(!1)}};return o?j.jsx("div",{className:"container mx-auto px-4 py-8",children:j.jsx("div",{className:"flex justify-center items-center h-64",children:j.jsx("div",{className:"text-gray-500",children:"加载中..."})})}):i?j.jsx("div",{className:"container mx-auto px-4 py-8",children:j.jsx("div",{className:"max-w-2xl mx-auto",children:j.jsxs(Zc,{children:[j.jsx(YE,{className:"pb-4",children:j.jsx("div",{className:"w-full",children:j.jsx("h1",{className:"text-2xl font-bold",children:"编辑数据集"})})}),j.jsxs(Jc,{className:"space-y-6",children:[j.jsxs("div",{children:[j.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"数据集名称"}),j.jsx(d2,{value:f,onChange:T=>u(T.target.value),placeholder:"请输入数据集名称",disabled:l})]}),j.jsxs("div",{children:[j.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"文件信息"}),j.jsx("div",{className:"p-3 bg-gray-50 rounded-lg border",children:j.jsxs("div",{className:"flex items-center space-x-2",children:[j.jsx("svg",{className:"w-5 h-5 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:j.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),j.jsxs("span",{className:"text-gray-700",children:["包含"," ",j.jsx("span",{className:"font-semibold text-blue-600",children:i.files?.length||0})," ","个文件"]})]})})]}),j.jsxs("div",{children:[j.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"大分类"}),j.jsx(RW,{selectedKeys:d?[d]:[],onSelectionChange:T=>{const _=Array.from(T)[0];h(_||"")},placeholder:"请选择分类",disabled:l,children:v.map(T=>j.jsx(DW,{children:T.label},T.key))})]}),j.jsxs("div",{children:[j.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"标签 (最多3个)"}),p.length>0&&j.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:p.map((T,_)=>j.jsx(f2,{color:"secondary",variant:"flat",onClose:()=>w(T),size:"sm",children:T},_))}),p.length<3&&j.jsxs("div",{className:"flex space-x-2",children:[j.jsx(d2,{value:m,onChange:T=>y(T.target.value),onKeyPress:T=>{T.key==="Enter"&&x()},placeholder:"输入标签并按回车",disabled:l,className:"flex-1"}),j.jsx(zr,{color:"secondary",variant:"flat",onClick:x,disabled:!m.trim()||l,children:"添加"})]})]}),j.jsxs("div",{className:"flex justify-end space-x-4 pt-4",children:[j.jsx(zr,{color:"default",variant:"flat",onClick:()=>t("/list"),disabled:l,children:"取消"}),j.jsx(zr,{color:"primary",isLoading:l,onClick:S,children:"保存修改"})]})]})]})})}):j.jsx("div",{className:"container mx-auto px-4 py-8",children:j.jsx("div",{className:"flex justify-center items-center h-64",children:j.jsx("div",{className:"text-gray-500",children:"数据不存在"})})})}const Fx=({children:t})=>{const{isAuthenticated:e,getUserInfo:n,accessToken:r,userInfo:i}=Bf(),a=bc();return H.useEffect(()=>{const o=r||localStorage.getItem("access_token");if(o&&!i&&n(),!o){a("/",{replace:!0});return}},[r,i,n,a]),e()?j.jsx(j.Fragment,{children:t}):null},EGe=[{path:"/",element:j.jsx(xGe,{})},{path:"/list",element:j.jsx(Fx,{children:j.jsx(Hp,{children:j.jsx(i1e,{})})})},{path:"/detail/:id",element:j.jsx(Hp,{children:j.jsx(tU,{})})},{path:"/original/:id",element:j.jsx(Hp,{children:j.jsx(tU,{})})},{path:"/admin",element:j.jsx(Fx,{children:j.jsx(Hp,{children:j.jsx(CGe,{})})})},{path:"/upload",element:j.jsx(Fx,{children:j.jsx(Hp,{children:j.jsx(SGe,{})})})},{path:"/edit/:id",element:j.jsx(Fx,{children:j.jsx(Hp,{children:j.jsx(TGe,{})})})}];class _Ge{constructor(){this.listeners=[]}subscribe(e){return this.listeners.push(e),()=>{const n=this.listeners.indexOf(e);n>-1&&this.listeners.splice(n,1)}}navigate(e){this.listeners.forEach(n=>n(e))}}const DGe=new _Ge,OGe=({children:t})=>{const e=bc();return H.useEffect(()=>DGe.subscribe(r=>{e(r)}),[e]),j.jsx(j.Fragment,{children:t})};function MGe(){return j.jsx(wie,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:j.jsx(OGe,{children:j.jsx(IGe,{})})})}const IGe=()=>{const{getUserInfo:t,accessToken:e,userInfo:n}=Bf();return H.useEffect(()=>{(e||localStorage.getItem("access_token"))&&!n&&t()},[t,e,n]),j.jsx(RGe,{})},RGe=()=>Ure(EGe);cre.createRoot(document.getElementById("root")).render(j.jsx(H.StrictMode,{children:j.jsxs(Ufe,{children:[j.jsx(F0e,{placement:"top-center"}),j.jsx(MGe,{})]})}));export{yE as $,ru as A,dse as B,TB as C,G_ as D,E_ as E,Rl as F,_5 as G,Nue as H,Cue as I,bw as J,Pue as K,xce as L,Fse as M,hse as N,Lle as O,qle as P,H as Q,t2 as R,ZU as S,Woe as T,lse as U,xw as V,S_ as W,__ as X,i2 as Y,i$ as Z,Ble as _,$R as a,iB as a$,cce as a0,Jle as a1,_i as a2,Noe as a3,zoe as a4,EB as a5,jle as a6,Zi as a7,Wse as a8,Kle as a9,Xo as aA,ole as aB,C_ as aC,Lue as aD,kue as aE,jx as aF,kGe as aG,UB as aH,Ub as aI,ule as aJ,hle as aK,JB as aL,e2 as aM,ZB as aN,Hce as aO,Qse as aP,Kce as aQ,pA as aR,Dce as aS,T_ as aT,PGe as aU,XU as aV,YU as aW,JU as aX,j2 as aY,O_ as aZ,iu as a_,Wle as aa,$le as ab,zce as ac,c$ as ad,Fb as ae,Joe as af,G2 as ag,s2 as ah,Dle as ai,KS as aj,hu as ak,tle as al,Mle as am,fse as an,l$ as ao,XB as ap,j as aq,ile as ar,Cw as as,AGe as at,ww as au,_m as av,sle as aw,Gh as ax,Ov as ay,bce as az,lB as b,wh as b$,M_ as b0,rB as b1,nB as b2,I_ as b3,oB as b4,aB as b5,z2 as b6,noe as b7,sB as b8,roe as b9,nc as bA,Use as bB,Bse as bC,zse as bD,VB as bE,j_ as bF,lE as bG,cE as bH,ese as bI,sse as bJ,OB as bK,vB as bL,LR as bM,kS as bN,L_ as bO,mB as bP,Aoe as bQ,Ioe as bR,kb as bS,rE as bT,Ooe as bU,cse as bV,pa as bW,nE as bX,hg as bY,Eoe as bZ,NS as b_,eB as ba,tB as bb,Sse as bc,NGe as bd,mse as be,DB as bf,Ese as bg,R_ as bh,A_ as bi,hE as bj,aE as bk,Koe as bl,Dv as bm,k_ as bn,Vb as bo,Lse as bp,U_ as bq,ase as br,Hoe as bs,cv as bt,wse as bu,yB as bv,cB as bw,LGe as bx,ws as by,LB as bz,Af as c,r2 as c0,u0 as c1,IB as c2,zR as c3,Ase as c4,RB as c5,Rse as c6,n2 as c7,Sm as c8,D5 as c9,wd as ca,au as cb,AR as cc,moe as cd,voe as ce,MB as cf,AB as cg,Kse as ch,PS as ci,c0 as d,Em as e,ui as f,PB as g,NB as h,ioe as i,ose as j,FB as k,Yc as l,D_ as m,$_ as n,ro as o,Sn as p,Ah as q,kse as r,SB as s,Tm as t,RR as u,joe as v,KR as w,om as x,_o as y,B_ as z};
